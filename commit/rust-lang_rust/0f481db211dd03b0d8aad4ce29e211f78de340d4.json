{"sha": "0f481db211dd03b0d8aad4ce29e211f78de340d4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBmNDgxZGIyMTFkZDAzYjBkOGFhZDRjZTI5ZTIxMWY3OGRlMzQwZDQ=", "commit": {"author": {"name": "Kevin Ballard", "email": "kevin@sb.org", "date": "2014-05-24T04:41:59Z"}, "committer": {"name": "Kevin Ballard", "email": "kevin@sb.org", "date": "2014-06-18T17:51:27Z"}, "message": "Fix spans for doc comments", "tree": {"sha": "0b78eaa8279f0950800bd3a47c2c7506657f1e6c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0b78eaa8279f0950800bd3a47c2c7506657f1e6c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0f481db211dd03b0d8aad4ce29e211f78de340d4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0f481db211dd03b0d8aad4ce29e211f78de340d4", "html_url": "https://github.com/rust-lang/rust/commit/0f481db211dd03b0d8aad4ce29e211f78de340d4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0f481db211dd03b0d8aad4ce29e211f78de340d4/comments", "author": {"login": "lilyball", "id": 714, "node_id": "MDQ6VXNlcjcxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lilyball", "html_url": "https://github.com/lilyball", "followers_url": "https://api.github.com/users/lilyball/followers", "following_url": "https://api.github.com/users/lilyball/following{/other_user}", "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}", "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions", "organizations_url": "https://api.github.com/users/lilyball/orgs", "repos_url": "https://api.github.com/users/lilyball/repos", "events_url": "https://api.github.com/users/lilyball/events{/privacy}", "received_events_url": "https://api.github.com/users/lilyball/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lilyball", "id": 714, "node_id": "MDQ6VXNlcjcxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lilyball", "html_url": "https://github.com/lilyball", "followers_url": "https://api.github.com/users/lilyball/followers", "following_url": "https://api.github.com/users/lilyball/following{/other_user}", "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}", "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions", "organizations_url": "https://api.github.com/users/lilyball/orgs", "repos_url": "https://api.github.com/users/lilyball/repos", "events_url": "https://api.github.com/users/lilyball/events{/privacy}", "received_events_url": "https://api.github.com/users/lilyball/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "78cb2f5bc0244edeb0f7f042c81f16931c437d27", "url": "https://api.github.com/repos/rust-lang/rust/commits/78cb2f5bc0244edeb0f7f042c81f16931c437d27", "html_url": "https://github.com/rust-lang/rust/commit/78cb2f5bc0244edeb0f7f042c81f16931c437d27"}], "stats": {"total": 6, "additions": 3, "deletions": 3}, "files": [{"sha": "4ea47eb0a3db983bd18d84121e88e913464d2e7c", "filename": "src/libsyntax/parse/lexer/mod.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/0f481db211dd03b0d8aad4ce29e211f78de340d4/src%2Flibsyntax%2Fparse%2Flexer%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0f481db211dd03b0d8aad4ce29e211f78de340d4/src%2Flibsyntax%2Fparse%2Flexer%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Flexer%2Fmod.rs?ref=0f481db211dd03b0d8aad4ce29e211f78de340d4", "patch": "@@ -304,7 +304,7 @@ impl<'a> StringReader<'a> {\n                             if !is_line_non_doc_comment(string) {\n                                 Some(TokenAndSpan{\n                                     tok: token::DOC_COMMENT(str_to_ident(string)),\n-                                    sp: codemap::mk_sp(start_bpos, self.pos)\n+                                    sp: codemap::mk_sp(start_bpos, self.last_pos)\n                                 })\n                             } else {\n                                 None\n@@ -358,7 +358,7 @@ impl<'a> StringReader<'a> {\n     fn consume_block_comment(&mut self) -> Option<TokenAndSpan> {\n         // block comments starting with \"/**\" or \"/*!\" are doc-comments\n         let is_doc_comment = self.curr_is('*') || self.curr_is('!');\n-        let start_bpos = self.pos - BytePos(if is_doc_comment {3} else {2});\n+        let start_bpos = self.last_pos - BytePos(2);\n \n         let mut level: int = 1;\n         while level > 0 {\n@@ -389,7 +389,7 @@ impl<'a> StringReader<'a> {\n                 if !is_block_non_doc_comment(string) {\n                     Some(TokenAndSpan{\n                             tok: token::DOC_COMMENT(str_to_ident(string)),\n-                            sp: codemap::mk_sp(start_bpos, self.pos)\n+                            sp: codemap::mk_sp(start_bpos, self.last_pos)\n                         })\n                 } else {\n                     None"}]}