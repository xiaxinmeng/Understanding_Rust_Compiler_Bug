{"sha": "97d0bc3f044a2f105ec760f78da800a1e44c8f05", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk3ZDBiYzNmMDQ0YTJmMTA1ZWM3NjBmNzhkYTgwMGExZTQ0YzhmMDU=", "commit": {"author": {"name": "NODA, Kai", "email": "nodakai@gmail.com", "date": "2018-06-26T19:23:14Z"}, "committer": {"name": "NODA, Kai", "email": "nodakai@gmail.com", "date": "2018-07-10T14:50:20Z"}, "message": "bootstrap: our best to achieve atomic rename on Win32\n\nThis is a tricky operation to implement on Win32; see\nhttps://ci.appveyor.com/project/nodakai/python-win-behavior\n\nSigned-off-by: NODA, Kai <nodakai@gmail.com>", "tree": {"sha": "3fa90c60879fa14c8f7e0c6b9e7eadc5bcaf24e4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3fa90c60879fa14c8f7e0c6b9e7eadc5bcaf24e4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/97d0bc3f044a2f105ec760f78da800a1e44c8f05", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJGBAABCgAwFiEEvRZ2+uz7foVLF3BQRCRPONk8a34FAltEx64SHG5vZGFrYWlA\nZ21haWwuY29tAAoJEEQkTzjZPGt+ZAwP/jQFxJpu+8Bnrov/xh5E++cpE3ejMHpe\nxcEZH29ijD3YLxoxNKhcZByvo+pVu676lSJyICzErqlTpfQiwYyGMPcKKdYxOw/y\nd1SVzF5D+XmZKjYFR5dSaQ0o+1QKqzIbzikiQGHStG0Mcrs4uQhz+39bQrdTwrXd\n7pE54GPDYtndDlXxRQPyRSlPNH/FuCdlW6bjgh7VNmseo1qb4tohE8dQ94d2NBf2\n7SyMcq7i8h3PSgnt7UMmTN4ine79usAhXc9koONmuzxPuTZ88Q4zLVllFXbjksLJ\nA472CzYMSRf4Qf3psLDHW8bgD1A1IX3kTZqf4qbcvPytaooy1lOv8KloSAugk2jI\nheMEIVVL9TlkTVJ9wWHkgGf3FDOJCj3zmVIPZuhZ5iH2PCHoSd8gxIkOyodewXTY\n12rFc4sk6Pheaiolnjd7ulJWhVetXi2PJAZIwPvVMNFzJtKXMuNVzoWXRHHl+CJZ\nCZ+AaEFcx2nJtys1kZHf3T3CNJR4QCFk+pE4JTJuYTZ7sewG7EhS8zLBhhBqfE1/\nUHzBZF3ZVm8726STmPPh8/DHYAodhXlGuaUlnhFqrQmvZkl6kI4LMjC9Tk4DhFOS\nydwDEgfATBQkD0MBJsav4HWkee5M4JJZGbk31Fudi/9z+AqyELaLbuTGJb5iTpFK\nk77m90zTlI54\n=5wEn\n-----END PGP SIGNATURE-----", "payload": "tree 3fa90c60879fa14c8f7e0c6b9e7eadc5bcaf24e4\nparent bcb8a06ef7929417f09ed5055692d8afc59b3c70\nauthor NODA, Kai <nodakai@gmail.com> 1530040994 +0800\ncommitter NODA, Kai <nodakai@gmail.com> 1531234220 +0800\n\nbootstrap: our best to achieve atomic rename on Win32\n\nThis is a tricky operation to implement on Win32; see\nhttps://ci.appveyor.com/project/nodakai/python-win-behavior\n\nSigned-off-by: NODA, Kai <nodakai@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/97d0bc3f044a2f105ec760f78da800a1e44c8f05", "html_url": "https://github.com/rust-lang/rust/commit/97d0bc3f044a2f105ec760f78da800a1e44c8f05", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/97d0bc3f044a2f105ec760f78da800a1e44c8f05/comments", "author": {"login": "nodakai", "id": 90726, "node_id": "MDQ6VXNlcjkwNzI2", "avatar_url": "https://avatars.githubusercontent.com/u/90726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nodakai", "html_url": "https://github.com/nodakai", "followers_url": "https://api.github.com/users/nodakai/followers", "following_url": "https://api.github.com/users/nodakai/following{/other_user}", "gists_url": "https://api.github.com/users/nodakai/gists{/gist_id}", "starred_url": "https://api.github.com/users/nodakai/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nodakai/subscriptions", "organizations_url": "https://api.github.com/users/nodakai/orgs", "repos_url": "https://api.github.com/users/nodakai/repos", "events_url": "https://api.github.com/users/nodakai/events{/privacy}", "received_events_url": "https://api.github.com/users/nodakai/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nodakai", "id": 90726, "node_id": "MDQ6VXNlcjkwNzI2", "avatar_url": "https://avatars.githubusercontent.com/u/90726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nodakai", "html_url": "https://github.com/nodakai", "followers_url": "https://api.github.com/users/nodakai/followers", "following_url": "https://api.github.com/users/nodakai/following{/other_user}", "gists_url": "https://api.github.com/users/nodakai/gists{/gist_id}", "starred_url": "https://api.github.com/users/nodakai/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nodakai/subscriptions", "organizations_url": "https://api.github.com/users/nodakai/orgs", "repos_url": "https://api.github.com/users/nodakai/repos", "events_url": "https://api.github.com/users/nodakai/events{/privacy}", "received_events_url": "https://api.github.com/users/nodakai/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bcb8a06ef7929417f09ed5055692d8afc59b3c70", "url": "https://api.github.com/repos/rust-lang/rust/commits/bcb8a06ef7929417f09ed5055692d8afc59b3c70", "html_url": "https://github.com/rust-lang/rust/commit/bcb8a06ef7929417f09ed5055692d8afc59b3c70"}], "stats": {"total": 7, "additions": 6, "deletions": 1}, "files": [{"sha": "71c1c61e3d97ebd51e9bd8cf5b9946cbcbe5ca5c", "filename": "src/bootstrap/bootstrap.py", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/97d0bc3f044a2f105ec760f78da800a1e44c8f05/src%2Fbootstrap%2Fbootstrap.py", "raw_url": "https://github.com/rust-lang/rust/raw/97d0bc3f044a2f105ec760f78da800a1e44c8f05/src%2Fbootstrap%2Fbootstrap.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbootstrap.py?ref=97d0bc3f044a2f105ec760f78da800a1e44c8f05", "patch": "@@ -308,7 +308,12 @@ def output(filepath):\n     tmp = filepath + '.tmp'\n     with open(tmp, 'w') as f:\n         yield f\n-    os.rename(tmp, filepath)\n+    try:\n+        os.remove(filepath)  # PermissionError/OSError on Win32 if in use\n+        os.rename(tmp, filepath)\n+    except OSError:\n+        shutil.copy2(tmp, filepath)\n+        os.remove(tmp)\n \n \n class RustBuild(object):"}]}