{"sha": "9dfec5d35b4f52d0b9653edf8e656c9a3c04f492", "node_id": "C_kwDOAAsO6NoAKDlkZmVjNWQzNWI0ZjUyZDBiOTY1M2VkZjhlNjU2YzlhM2MwNGY0OTI", "commit": {"author": {"name": "Joshua Nelson", "email": "github@jyn.dev", "date": "2023-02-05T19:53:39Z"}, "committer": {"name": "Joshua Nelson", "email": "github@jyn.dev", "date": "2023-02-05T20:29:49Z"}, "message": "Run the tools builder on all PRs\n\nPreviously, it would only run on changes to subtrees, submodules, or select directories.\nThat made it so that changes to the compiler that broke tools would only be detected on a full bors merge.\nThis makes it so the tools builder runs by default, making it easier to catch breaking changes to clippy (which was the most effected).", "tree": {"sha": "1b68ef720d5fe6532a2a118c5d1fec1f134eba28", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1b68ef720d5fe6532a2a118c5d1fec1f134eba28"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9dfec5d35b4f52d0b9653edf8e656c9a3c04f492", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9dfec5d35b4f52d0b9653edf8e656c9a3c04f492", "html_url": "https://github.com/rust-lang/rust/commit/9dfec5d35b4f52d0b9653edf8e656c9a3c04f492", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9dfec5d35b4f52d0b9653edf8e656c9a3c04f492/comments", "author": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "319b88c463fe6f51bb6badbbd3bb97252a60f3a5", "url": "https://api.github.com/repos/rust-lang/rust/commits/319b88c463fe6f51bb6badbbd3bb97252a60f3a5", "html_url": "https://github.com/rust-lang/rust/commit/319b88c463fe6f51bb6badbbd3bb97252a60f3a5"}], "stats": {"total": 42, "additions": 2, "deletions": 40}, "files": [{"sha": "b51105750c82cc9aa428298d520959ab20071409", "filename": ".github/workflows/ci.yml", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9dfec5d35b4f52d0b9653edf8e656c9a3c04f492/.github%2Fworkflows%2Fci.yml", "raw_url": "https://github.com/rust-lang/rust/raw/9dfec5d35b4f52d0b9653edf8e656c9a3c04f492/.github%2Fworkflows%2Fci.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fci.yml?ref=9dfec5d35b4f52d0b9653edf8e656c9a3c04f492", "patch": "@@ -60,9 +60,8 @@ jobs:\n             env: {}\n           - name: x86_64-gnu-tools\n             tidy: false\n-            env:\n-              CI_ONLY_WHEN_SUBMODULES_CHANGED: 1\n             os: ubuntu-20.04-xl\n+            env: {}\n     timeout-minutes: 600\n     runs-on: \"${{ matrix.os }}\"\n     steps:"}, {"sha": "3c128c0ca251b514142c020fbc7c6409ee843a06", "filename": "src/ci/github-actions/ci.yml", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9dfec5d35b4f52d0b9653edf8e656c9a3c04f492/src%2Fci%2Fgithub-actions%2Fci.yml", "raw_url": "https://github.com/rust-lang/rust/raw/9dfec5d35b4f52d0b9653edf8e656c9a3c04f492/src%2Fci%2Fgithub-actions%2Fci.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fgithub-actions%2Fci.yml?ref=9dfec5d35b4f52d0b9653edf8e656c9a3c04f492", "patch": "@@ -307,8 +307,6 @@ jobs:\n           - name: x86_64-gnu-tools\n             <<: *job-linux-xl\n             tidy: false\n-            env:\n-              CI_ONLY_WHEN_SUBMODULES_CHANGED: 1\n \n   auto:\n     permissions:"}, {"sha": "48127166ad0809b644ba4b533b042588ab0eec7a", "filename": "src/ci/scripts/should-skip-this.sh", "status": "modified", "additions": 1, "deletions": 36, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/9dfec5d35b4f52d0b9653edf8e656c9a3c04f492/src%2Fci%2Fscripts%2Fshould-skip-this.sh", "raw_url": "https://github.com/rust-lang/rust/raw/9dfec5d35b4f52d0b9653edf8e656c9a3c04f492/src%2Fci%2Fscripts%2Fshould-skip-this.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fscripts%2Fshould-skip-this.sh?ref=9dfec5d35b4f52d0b9653edf8e656c9a3c04f492", "patch": "@@ -1,46 +1,11 @@\n #!/bin/bash\n-# Set the SKIP_JOB environment variable if this job is supposed to only run\n-# when submodules are updated and they were not. The following time consuming\n-# tasks will be skipped when the environment variable is present.\n+# Set the SKIP_JOB environment variable if this job is not supposed to run on the current builder.\n \n set -euo pipefail\n IFS=$'\\n\\t'\n \n source \"$(cd \"$(dirname \"$0\")\" && pwd)/../shared.sh\"\n \n-if [[ -n \"${CI_ONLY_WHEN_SUBMODULES_CHANGED-}\" ]]; then\n-    git fetch \"https://github.com/$GITHUB_REPOSITORY\" \"$GITHUB_BASE_REF\"\n-    BASE_COMMIT=\"$(git merge-base FETCH_HEAD HEAD)\"\n-\n-    echo \"Searching for toolstate changes between $BASE_COMMIT and $(git rev-parse HEAD)\"\n-\n-    if git diff \"$BASE_COMMIT\" | grep --quiet \"^index .* 160000\"; then\n-        # Submodules pseudo-files inside git have the 160000 permissions, so when\n-        # those files are present in the diff a submodule was updated.\n-        echo \"Submodules were updated\"\n-    elif ! (git diff --quiet \"$BASE_COMMIT\" -- \\\n-             src/tools/clippy src/tools/rustfmt src/tools/miri \\\n-             library/std/src/sys); then\n-        # There is not an easy blanket search for subtrees. For now, manually list\n-        # the subtrees.\n-        # Also run this when the platform-specific parts of std change, in case\n-        # that breaks Miri.\n-        echo \"Tool subtrees were updated\"\n-    elif ! (git diff --quiet \"$BASE_COMMIT\" -- \\\n-             tests/rustdoc-gui \\\n-             src/librustdoc \\\n-             src/ci/docker/host-x86_64/x86_64-gnu-tools/Dockerfile \\\n-             src/ci/docker/host-x86_64/x86_64-gnu-tools/browser-ui-test.version \\\n-             src/tools/rustdoc-gui); then\n-        # There was a change in either rustdoc or in its GUI tests.\n-        echo \"Rustdoc was updated\"\n-    else\n-        echo \"Not executing this job since no submodules nor subtrees were updated\"\n-        ciCommandSetEnv SKIP_JOB 1\n-        exit 0\n-    fi\n-fi\n-\n if [[ -n \"${CI_ONLY_WHEN_CHANNEL-}\" ]]; then\n     if [[ \"${CI_ONLY_WHEN_CHANNEL}\" = \"$(cat src/ci/channel)\" ]]; then\n         echo \"The channel is the expected one\""}]}