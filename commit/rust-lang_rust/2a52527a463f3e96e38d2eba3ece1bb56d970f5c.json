{"sha": "2a52527a463f3e96e38d2eba3ece1bb56d970f5c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJhNTI1MjdhNDYzZjNlOTZlMzhkMmViYTNlY2UxYmI1NmQ5NzBmNWM=", "commit": {"author": {"name": "flip1995", "email": "uwdkn@student.kit.edu", "date": "2018-03-31T15:53:24Z"}, "committer": {"name": "flip1995", "email": "uwdkn@student.kit.edu", "date": "2018-03-31T15:53:24Z"}, "message": "Fix lintlib script", "tree": {"sha": "3420f8d73874eaea6964f6b7b8bd8931359ee0fb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3420f8d73874eaea6964f6b7b8bd8931359ee0fb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2a52527a463f3e96e38d2eba3ece1bb56d970f5c", "comment_count": 0, "verification": {"verified": false, "reason": "unverified_email", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz66kzxK9mXB0K2lyZ1erJvcvAIQFAlq/rvQACgkQZ1erJvcv\nAISkOw//VW8VaNFInxq7L6MzfJ0scO0AU9iAKlkpKqChzqNJ9dTP+/7/LV66j4Un\nuaGEpnijJOOB9n/j5CMO0ovXc84pyU86KH8tppBW+yU+n9NfVp2tDXNDTxe89ufd\nMOUcDn9T8Kvcwin7tKDiJ7em4p1GcIxSD9OPgZoOA/eMqMxP3vQJPoVjMEM7bDUD\nU+t/iaeNH6FHR2QIHtE1eJzFPwLLfJqtremJGBqEkrZCWgT6yzxa9ziesv8hodji\nip4u/S84ptIOPrDINVaTh4/EVjOn1t+RhJd9N4EHmh2C11r5bFpLcVgCB7j//+tD\n6zu+pYO3AqVayCpOsEa51/yCoZ0hJ9ieXDiwDmQ9o5IPl6HFG1ZFwzAh3YS8q3/q\nt9I3zYR9EsEOhMdxknOFXIgxx1UFy/c9n/RLr31OTfyWRbpf+d7dpZyEUkMPmlRd\nklGEkehFFhr1VbW5zMAckLd7ChoMtnZZG+7wwMgqAfymSNu5WNukooaEOjZoYlyV\ndWEdgZii1pdwVblqEdzpd5QAy3kh8QNxyF9jjFbcOyvZ3k0E6Mk4HBiNFgqzfrMw\nQ+YidNHKQWl9UVqIOIvFfpfcpzszMjKswHyX8qvkQJ2kOknhvd0Kum1HGzSxamO5\n+KuHktCfL9l3+YGNA9qWxAHWP/1TBxwVPToXAojeZJ7U/lFAxsw=\n=6uH7\n-----END PGP SIGNATURE-----", "payload": "tree 3420f8d73874eaea6964f6b7b8bd8931359ee0fb\nparent b7a0b97e97e1aa9e7ce2377ae623cbbdaf78372c\nauthor flip1995 <uwdkn@student.kit.edu> 1522511604 +0200\ncommitter flip1995 <uwdkn@student.kit.edu> 1522511604 +0200\n\nFix lintlib script\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2a52527a463f3e96e38d2eba3ece1bb56d970f5c", "html_url": "https://github.com/rust-lang/rust/commit/2a52527a463f3e96e38d2eba3ece1bb56d970f5c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2a52527a463f3e96e38d2eba3ece1bb56d970f5c/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b7a0b97e97e1aa9e7ce2377ae623cbbdaf78372c", "url": "https://api.github.com/repos/rust-lang/rust/commits/b7a0b97e97e1aa9e7ce2377ae623cbbdaf78372c", "html_url": "https://github.com/rust-lang/rust/commit/b7a0b97e97e1aa9e7ce2377ae623cbbdaf78372c"}], "stats": {"total": 60, "additions": 27, "deletions": 33}, "files": [{"sha": "c28177e10629c927618cea9bfbc226153e9de0da", "filename": "util/lintlib.py", "status": "modified", "additions": 27, "deletions": 33, "changes": 60, "blob_url": "https://github.com/rust-lang/rust/blob/2a52527a463f3e96e38d2eba3ece1bb56d970f5c/util%2Flintlib.py", "raw_url": "https://github.com/rust-lang/rust/raw/2a52527a463f3e96e38d2eba3ece1bb56d970f5c/util%2Flintlib.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/util%2Flintlib.py?ref=2a52527a463f3e96e38d2eba3ece1bb56d970f5c", "patch": "@@ -7,12 +7,11 @@\n import logging as log\n log.basicConfig(level=log.INFO, format='%(levelname)s: %(message)s')\n \n-Lint = collections.namedtuple('Lint', 'name level doc sourcefile')\n+Lint = collections.namedtuple('Lint', 'name level doc sourcefile group')\n Config = collections.namedtuple('Config', 'name ty doc default')\n \n lintname_re = re.compile(r'''pub\\s+([A-Z_][A-Z_0-9]*)''')\n-level_re = re.compile(r'''(Forbid|Deny|Warn|Allow)''')\n-group_re = re.compile(r'''([a-z_][a-z_0-9]+)''')\n+group_re = re.compile(r'''\\s*([a-z_][a-z_0-9]+)''')\n conf_re = re.compile(r'''define_Conf! {\\n([^}]*)\\n}''', re.MULTILINE)\n confvar_re = re.compile(\n     r'''/// Lint: (\\w+). (.*).*\\n\\s*\\([^,]+,\\s+\"([^\"]+)\",\\s+([^=\\)]+)=>\\s+(.*)\\),''', re.MULTILINE)\n@@ -27,6 +26,7 @@\n     \"nursery\": 'Allow',\n }\n \n+\n def parse_lints(lints, filepath):\n     last_comment = []\n     comment = True\n@@ -57,36 +57,30 @@ def parse_lints(lints, filepath):\n                 else:\n                     last_comment = []\n             if not comment:\n-                if name:\n-                    g = group_re.search(line)\n-                    if g:\n-                        group = g.group(1).lower()\n-                        level = lint_levels[group]\n-                        log.info(\"found %s with level %s in %s\",\n-                                name, level, filepath)\n-                        lints.append(Lint(name, level, last_comment, filepath, group))\n-                        last_comment = []\n-                        comment = True\n-                else:\n-                    m = lintname_re.search(line)\n-                    if m:\n-                        name = m.group(1).lower()\n-\n-                        if deprecated:\n-                            level = \"Deprecated\"\n-                        else:\n-                            while True:\n-                                m = level_re.search(line)\n-                                if m:\n-                                    level = m.group(0)\n-                                    break\n-                                line = next(fp)\n-                        if not clippy:\n-                            log.info(\"found %s with level %s in %s\",\n-                                    name, level, filepath)\n-                            lints.append(Lint(name, level, last_comment, filepath, \"deprecated\"))\n-                            last_comment = []\n-                            comment = True\n+                m = lintname_re.search(line)\n+\n+                if m:\n+                    name = m.group(1).lower()\n+                    line = next(fp)\n+\n+                    if deprecated:\n+                        level = \"Deprecated\"\n+                        group = \"deprecated\"\n+                    else:\n+                        while True:\n+                            g = group_re.search(line)\n+                            if g:\n+                                group = g.group(1).lower()\n+                                level = lint_levels[group]\n+                                break\n+                            line = next(fp)\n+\n+                    log.info(\"found %s with level %s in %s\",\n+                             name, level, filepath)\n+                    lints.append(Lint(name, level, last_comment, filepath, group))\n+                    last_comment = []\n+                    comment = True\n+\n                     if \"}\" in line:\n                         log.warn(\"Warning: missing Lint-Name in %s\", filepath)\n                         comment = True"}]}