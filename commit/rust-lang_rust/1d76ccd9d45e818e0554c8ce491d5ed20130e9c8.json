{"sha": "1d76ccd9d45e818e0554c8ce491d5ed20130e9c8", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFkNzZjY2Q5ZDQ1ZTgxOGUwNTU0YzhjZTQ5MWQ1ZWQyMDEzMGU5Yzg=", "commit": {"author": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2016-03-02T15:59:47Z"}, "committer": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2016-03-02T19:26:03Z"}, "message": "Update `COMPILER_TESTS.md` documentation to discuss revisions", "tree": {"sha": "4b7e08a16341d5eb8f0d5bfeac0117e5f64b000f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4b7e08a16341d5eb8f0d5bfeac0117e5f64b000f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1d76ccd9d45e818e0554c8ce491d5ed20130e9c8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1d76ccd9d45e818e0554c8ce491d5ed20130e9c8", "html_url": "https://github.com/rust-lang/rust/commit/1d76ccd9d45e818e0554c8ce491d5ed20130e9c8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1d76ccd9d45e818e0554c8ce491d5ed20130e9c8/comments", "author": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3fb80e33a89709e3457ad0943f5847eb5800d620", "url": "https://api.github.com/repos/rust-lang/rust/commits/3fb80e33a89709e3457ad0943f5847eb5800d620", "html_url": "https://github.com/rust-lang/rust/commit/3fb80e33a89709e3457ad0943f5847eb5800d620"}], "stats": {"total": 31, "additions": 31, "deletions": 0}, "files": [{"sha": "08afd2137ba0cf0228a5fcda07f8336ac00925bc", "filename": "COMPILER_TESTS.md", "status": "modified", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/1d76ccd9d45e818e0554c8ce491d5ed20130e9c8/COMPILER_TESTS.md", "raw_url": "https://github.com/rust-lang/rust/raw/1d76ccd9d45e818e0554c8ce491d5ed20130e9c8/COMPILER_TESTS.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/COMPILER_TESTS.md?ref=1d76ccd9d45e818e0554c8ce491d5ed20130e9c8", "patch": "@@ -42,3 +42,34 @@ whole, instead of just a few lines inside the test.\n * `ignore-test` always ignores the test\n * `ignore-lldb` and `ignore-gdb` will skip the debuginfo tests\n * `min-{gdb,lldb}-version`\n+\n+## Revisions\n+\n+Certain classes of tests support \"revisions\" (as of the time of this\n+writing, this includes run-pass, compile-fail, run-fail, and\n+incremental, though incremental tests are somewhat\n+different). Revisions allow a single test file to be used for multiple\n+tests. This is done by adding a special header at the top of the file:\n+\n+```\n+// revisions: foo bar baz\n+```\n+\n+This will result in the test being compiled (and tested) three times,\n+once with `--cfg foo`, once with `--cfg bar`, and once with `--cfg\n+baz`. You can therefore use `#[cfg(foo)]` etc within the test to tweak\n+each of these results.\n+\n+You can also customize headers and expected error messages to a particular\n+revision. To do this, add `[foo]` (or `bar`, `baz`, etc) after the `//`\n+comment, like so:\n+\n+```\n+// A flag to pass in only for cfg `foo`:\n+//[foo]compile-flags: -Z verbose\n+\n+#[cfg(foo)]\n+fn test_foo() {\n+    let x: usize = 32_u32; //[foo]~ ERROR mismatched types\n+}\n+```"}]}