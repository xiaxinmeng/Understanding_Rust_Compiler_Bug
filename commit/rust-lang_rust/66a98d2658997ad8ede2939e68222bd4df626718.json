{"sha": "66a98d2658997ad8ede2939e68222bd4df626718", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY2YTk4ZDI2NTg5OTdhZDhlZGUyOTM5ZTY4MjIyYmQ0ZGY2MjY3MTg=", "commit": {"author": {"name": "Oliver Schneider", "email": "git-no-reply-9879165716479413131@oli-obk.de", "date": "2018-03-28T09:50:17Z"}, "committer": {"name": "Oliver Schneider", "email": "git-no-reply-9879165716479413131@oli-obk.de", "date": "2018-03-28T09:50:17Z"}, "message": "Use cargo check instead of cargo rustc", "tree": {"sha": "2de3182af1c040031da41e0511ad9a4eeae21875", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2de3182af1c040031da41e0511ad9a4eeae21875"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/66a98d2658997ad8ede2939e68222bd4df626718", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJgBAABCgBKFiEEvpMjxK4/cnPNfesJHVy0/Fl8MAQFAlq7ZVksHGdpdC1uby1y\nZXBseS05ODc5MTY1NzE2NDc5NDEzMTMxQG9saS1vYmsuZGUACgkQHVy0/Fl8MASB\nrxAAmYbQuWBEwG2YNe5MxHV4XHmkNcnsiuuk8i35EvsTp3kBOMKf1Af5rM1fif0m\nhxWSUOeqe1/Pt6t5lvw1/UX4vwyDYHchkNjQ5oVhi9rTSKrjgHaJcueQu51q5zxP\nFklnTTWyPMPUhS19ENqGF6f0s3mo+I1sYnXZ26zyStErPacAGhpMa9reYZQmvSdD\n9XfQJXpSbLqAk+yHWHibY1siVGl7PrM++pJYo7utcgGhdazttqibEuID5f7LXZB6\nZitzfj+iCWIrxN1v5dc6CaTK4my9oSI3HiEE3li6VtxBCJivVQcUpe3OW9kPCBxm\n+/Sc40zoXhIOPINTyJVSDTE6HOs2XA3O0vG1BXyXKHFYAf+MF1KB+o9ZIHKjKdkf\nqIE9NASdtCl3irie3Yp7d8I//Bj9h6Xe7+4S7UOUKuxq4+jRgXk1T2TEvltTP4/E\nyuqz9aa+usBVlGHjU1m2zNrKQeaap4ZglE3jdaMi0aCYV8VFTz2MDQKrNJl2Q6It\nXpy6JUgP6fEdg+3LWTGaTkIJtkQ6Fo/xfcNAMJ9mhnvDq6c+iDCiCu75TOjrYKoU\nMf08CoLn8q4Uubh/11clYH+tx2/b8u7CRmPR3v24sQpzR1h/5zD44fIL+esI6ndL\nuSnqZAZAxu5A5fL2Pg+r0ujytdZJ2kKJKSIKwgji7l2mo1I=\n=RreH\n-----END PGP SIGNATURE-----", "payload": "tree 2de3182af1c040031da41e0511ad9a4eeae21875\nparent 9b10c4be8cb5850fbb52b55f876e9095ca61e088\nauthor Oliver Schneider <git-no-reply-9879165716479413131@oli-obk.de> 1522230617 +0200\ncommitter Oliver Schneider <git-no-reply-9879165716479413131@oli-obk.de> 1522230617 +0200\n\nUse cargo check instead of cargo rustc\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/66a98d2658997ad8ede2939e68222bd4df626718", "html_url": "https://github.com/rust-lang/rust/commit/66a98d2658997ad8ede2939e68222bd4df626718", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/66a98d2658997ad8ede2939e68222bd4df626718/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9b10c4be8cb5850fbb52b55f876e9095ca61e088", "url": "https://api.github.com/repos/rust-lang/rust/commits/9b10c4be8cb5850fbb52b55f876e9095ca61e088", "html_url": "https://github.com/rust-lang/rust/commit/9b10c4be8cb5850fbb52b55f876e9095ca61e088"}], "stats": {"total": 23, "additions": 13, "deletions": 10}, "files": [{"sha": "73746798601d3bbeedbbc2452984b348eac2a0db", "filename": "src/driver.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/66a98d2658997ad8ede2939e68222bd4df626718/src%2Fdriver.rs", "raw_url": "https://github.com/rust-lang/rust/raw/66a98d2658997ad8ede2939e68222bd4df626718/src%2Fdriver.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdriver.rs?ref=66a98d2658997ad8ede2939e68222bd4df626718", "patch": "@@ -186,10 +186,13 @@ pub fn main() {\n     let clippy_enabled = env::var(\"CLIPPY_TESTS\")\n         .ok()\n         .map_or(false, |val| val == \"true\")\n-        || orig_args.iter().any(|s| s == \"--emit=metadata\");\n+        || orig_args.iter().any(|s| s == \"--emit=dep-info,metadata\");\n \n     if clippy_enabled {\n         args.extend_from_slice(&[\"--cfg\".to_owned(), r#\"feature=\"cargo-clippy\"\"#.to_owned()]);\n+        if let Ok(extra_args) = env::var(\"CLIPPY_ARGS\") {\n+            args.extend(extra_args.split(\"__CLIPPY_HACKERY__\").filter(|s| !s.is_empty()).map(str::to_owned));\n+        }\n     }\n \n     let mut ccc = ClippyCompilerCalls::new(clippy_enabled);"}, {"sha": "598d129dec2b22e813812467f91e96944325782a", "filename": "src/main.rs", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/66a98d2658997ad8ede2939e68222bd4df626718/src%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/66a98d2658997ad8ede2939e68222bd4df626718/src%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmain.rs?ref=66a98d2658997ad8ede2939e68222bd4df626718", "patch": "@@ -175,23 +175,22 @@ pub fn main() {\n     }\n }\n \n-fn process<I>(old_args: I) -> Result<(), i32>\n+fn process<I>(mut old_args: I) -> Result<(), i32>\n where\n     I: Iterator<Item = String>,\n {\n-    let mut args = vec![\"rustc\".to_owned()];\n+    let mut args = vec![\"check\".to_owned()];\n \n     let mut found_dashes = false;\n-    for arg in old_args {\n+    for arg in old_args.by_ref() {\n         found_dashes |= arg == \"--\";\n+        if found_dashes {\n+            break;\n+        }\n         args.push(arg);\n     }\n-    if !found_dashes {\n-        args.push(\"--\".to_owned());\n-    }\n-    args.push(\"--emit=metadata\".to_owned());\n-    args.push(\"--cfg\".to_owned());\n-    args.push(r#\"feature=\"cargo-clippy\"\"#.to_owned());\n+\n+    let clippy_args: String = old_args.map(|arg| format!(\"{}__CLIPPY_HACKERY__\", arg)).collect();\n \n     let mut path = std::env::current_exe()\n         .expect(\"current executable path invalid\")\n@@ -202,6 +201,7 @@ where\n     let exit_status = std::process::Command::new(\"cargo\")\n         .args(&args)\n         .env(\"RUSTC_WRAPPER\", path)\n+        .env(\"CLIPPY_ARGS\", clippy_args)\n         .spawn()\n         .expect(\"could not run cargo\")\n         .wait()"}]}