{"sha": "48193c2fe00e630bed3c989e479e7be437c4c133", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ4MTkzYzJmZTAwZTYzMGJlZDNjOTg5ZTQ3OWU3YmU0MzdjNGMxMzM=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2017-09-16T14:16:47Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2017-09-17T00:09:37Z"}, "message": "Rollup merge of #44356 - nrc:rls-component-manifest, r=@alexcrichton\n\nAttempt to fix the component manifest problem for rls-preview\n\ncc #44270\n\nSee #44270", "tree": {"sha": "54eea7046353f736680c31d0c2b204439a398d59", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/54eea7046353f736680c31d0c2b204439a398d59"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/48193c2fe00e630bed3c989e479e7be437c4c133", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/48193c2fe00e630bed3c989e479e7be437c4c133", "html_url": "https://github.com/rust-lang/rust/commit/48193c2fe00e630bed3c989e479e7be437c4c133", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/48193c2fe00e630bed3c989e479e7be437c4c133/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2a844b3d0d3e3db70d44ad1127f4d37b26211383", "url": "https://api.github.com/repos/rust-lang/rust/commits/2a844b3d0d3e3db70d44ad1127f4d37b26211383", "html_url": "https://github.com/rust-lang/rust/commit/2a844b3d0d3e3db70d44ad1127f4d37b26211383"}, {"sha": "39c9a3d7961df049d77660131033c003e24364a3", "url": "https://api.github.com/repos/rust-lang/rust/commits/39c9a3d7961df049d77660131033c003e24364a3", "html_url": "https://github.com/rust-lang/rust/commit/39c9a3d7961df049d77660131033c003e24364a3"}], "stats": {"total": 17, "additions": 13, "deletions": 4}, "files": [{"sha": "7bca088dbd5a8f8529738b5fce536ca66a030576", "filename": "src/bootstrap/dist.rs", "status": "modified", "additions": 13, "deletions": 4, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/48193c2fe00e630bed3c989e479e7be437c4c133/src%2Fbootstrap%2Fdist.rs", "raw_url": "https://github.com/rust-lang/rust/raw/48193c2fe00e630bed3c989e479e7be437c4c133/src%2Fbootstrap%2Fdist.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdist.rs?ref=48193c2fe00e630bed3c989e479e7be437c4c133", "patch": "@@ -1098,8 +1098,14 @@ impl Step for Rls {\n            .arg(\"--output-dir\").arg(&distdir(build))\n            .arg(\"--non-installed-overlay\").arg(&overlay)\n            .arg(format!(\"--package-name={}-{}\", name, target))\n-           .arg(\"--component-name=rls\")\n            .arg(\"--legacy-manifest-dirs=rustlib,cargo\");\n+\n+        if build.config.channel == \"nightly\" {\n+            cmd.arg(\"--component-name=rls\");\n+        } else {\n+            cmd.arg(\"--component-name=rls-preview\");\n+        }\n+\n         build.run(&mut cmd);\n         distdir(build).join(format!(\"{}-{}.tar.gz\", name, target))\n     }\n@@ -1302,9 +1308,12 @@ impl Step for Extended {\n             cp_r(&work.join(&format!(\"{}-{}\", pkgname(build, \"rust-std\"), target))\n                         .join(format!(\"rust-std-{}\", target)),\n                     &exe.join(\"rust-std\"));\n-            cp_r(&work.join(&format!(\"{}-{}\", pkgname(build, \"rls\"), target))\n-                        .join(\"rls\"),\n-                    &exe.join(\"rls\"));\n+            let rls_path = if build.config.channel == \"nightly\" {\n+                work.join(&format!(\"{}-{}\", pkgname(build, \"rls\"), target)).join(\"rls\")\n+            } else {\n+                work.join(&format!(\"{}-{}\", pkgname(build, \"rls\"), target)).join(\"rls-preview\")\n+            };\n+            cp_r(&rls_path, &exe.join(\"rls\"));\n             cp_r(&work.join(&format!(\"{}-{}\", pkgname(build, \"rust-analysis\"), target))\n                         .join(format!(\"rust-analysis-{}\", target)),\n                     &exe.join(\"rust-analysis\"));"}]}