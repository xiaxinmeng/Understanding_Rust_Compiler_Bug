{"sha": "29871d5480c887abdaf4b8b2b925a9e4aee7b521", "node_id": "C_kwDOAAsO6NoAKDI5ODcxZDU0ODBjODg3YWJkYWY0YjhiMmI5MjVhOWU0YWVlN2I1MjE", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-06-06T10:00:32Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-06-06T10:00:32Z"}, "message": "Rollup merge of #111962 - theIDinside:better-gdb, r=Mark-Simulacrum\n\nMake GDB Python Pretty Printers loadable after spawning GDB, avoiding required `rust-gdb`\n\nFixes #111961\n\nMakes the Python pretty printer library source'able from within GDB after spawn, making the wrapper script `rust-gdb` become not the required approach to use the pretty printer library.\n\nAllows for integration into GUI:s that wrap GDB extremely easy. The previous design complicates this feature.", "tree": {"sha": "21f478f3a1e6e9154eed2a53e28fae166d0345c1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/21f478f3a1e6e9154eed2a53e28fae166d0345c1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/29871d5480c887abdaf4b8b2b925a9e4aee7b521", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkfwPACRBK7hj4Ov3rIwAAzlcIAIw3+LeOoQkJfYLPKA8DRdhD\nBvsKtP3rmSjFFq0D0+CcGEt5w/G5oozP6TPzhNPX8VIo2TaQIrWbxqDELiMn+c/z\nIJFF8L8S9ROzrZdtk1mZzGddPjroh3pIQ+Ixt8lc6C/7R99Q4s24QoWqJBmpdVGs\nUTJVZ1nnVeId/L+xOo7mpnKrEkLVaz3++tGB+U3HDpPY+slgV4BNgQ4jVD0AQ7JX\nMbB3KJcSWu6zbdybOYez2FcKQF/1hqP48BLQ/VYAUZMrSmpLBmy+4xJA755ynstH\nyRIIIGwFIouPHPgkZ/RGIEke5Qs/dF6FOnrPZo4ekQ6Gi97Dx5QPmiDZRp47hrs=\n=dK8W\n-----END PGP SIGNATURE-----\n", "payload": "tree 21f478f3a1e6e9154eed2a53e28fae166d0345c1\nparent c4e11dc3277ee44d4fbfb58da5273bd00940e6d4\nparent c5145dc87a2b750a12e8f36d84ff6fb4f8edfdf4\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1686045632 +0200\ncommitter GitHub <noreply@github.com> 1686045632 +0200\n\nRollup merge of #111962 - theIDinside:better-gdb, r=Mark-Simulacrum\n\nMake GDB Python Pretty Printers loadable after spawning GDB, avoiding required `rust-gdb`\n\nFixes #111961\n\nMakes the Python pretty printer library source'able from within GDB after spawn, making the wrapper script `rust-gdb` become not the required approach to use the pretty printer library.\n\nAllows for integration into GUI:s that wrap GDB extremely easy. The previous design complicates this feature.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/29871d5480c887abdaf4b8b2b925a9e4aee7b521", "html_url": "https://github.com/rust-lang/rust/commit/29871d5480c887abdaf4b8b2b925a9e4aee7b521", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/29871d5480c887abdaf4b8b2b925a9e4aee7b521/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c4e11dc3277ee44d4fbfb58da5273bd00940e6d4", "url": "https://api.github.com/repos/rust-lang/rust/commits/c4e11dc3277ee44d4fbfb58da5273bd00940e6d4", "html_url": "https://github.com/rust-lang/rust/commit/c4e11dc3277ee44d4fbfb58da5273bd00940e6d4"}, {"sha": "c5145dc87a2b750a12e8f36d84ff6fb4f8edfdf4", "url": "https://api.github.com/repos/rust-lang/rust/commits/c5145dc87a2b750a12e8f36d84ff6fb4f8edfdf4", "html_url": "https://github.com/rust-lang/rust/commit/c5145dc87a2b750a12e8f36d84ff6fb4f8edfdf4"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "491b6ba9e9e695b0f70fab3bc0b221da1390d1e3", "filename": "src/etc/gdb_load_rust_pretty_printers.py", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/29871d5480c887abdaf4b8b2b925a9e4aee7b521/src%2Fetc%2Fgdb_load_rust_pretty_printers.py", "raw_url": "https://github.com/rust-lang/rust/raw/29871d5480c887abdaf4b8b2b925a9e4aee7b521/src%2Fetc%2Fgdb_load_rust_pretty_printers.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fgdb_load_rust_pretty_printers.py?ref=29871d5480c887abdaf4b8b2b925a9e4aee7b521", "patch": "@@ -1,3 +1,14 @@\n+# Add this folder to the python sys path; GDB Python-interpreter will now find modules in this path\n+import sys\n+from os import path\n+self_dir = path.dirname(path.realpath(__file__))\n+sys.path.append(self_dir)\n+\n import gdb\n import gdb_lookup\n-gdb_lookup.register_printers(gdb.current_objfile())\n+\n+# current_objfile can be none; even with `gdb foo-app`; sourcing this file after gdb init now works\n+try:\n+    gdb_lookup.register_printers(gdb.current_objfile())\n+except Exception:\n+    gdb_lookup.register_printers(gdb.selected_inferior().progspace)"}]}