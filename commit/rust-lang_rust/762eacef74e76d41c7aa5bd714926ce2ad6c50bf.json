{"sha": "762eacef74e76d41c7aa5bd714926ce2ad6c50bf", "node_id": "C_kwDOAAsO6NoAKDc2MmVhY2VmNzRlNzZkNDFjN2FhNWJkNzE0OTI2Y2UyYWQ2YzUwYmY", "commit": {"author": {"name": "DropDemBits", "email": "r3usrlnd@gmail.com", "date": "2023-03-26T22:08:10Z"}, "committer": {"name": "DropDemBits", "email": "r3usrlnd@gmail.com", "date": "2023-03-26T22:08:10Z"}, "message": "factor out adding a snippet", "tree": {"sha": "6eb3e89a0db31b92c526688d1fd98d8d43682148", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6eb3e89a0db31b92c526688d1fd98d8d43682148"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/762eacef74e76d41c7aa5bd714926ce2ad6c50bf", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niHUEABYKAB0WIQTeuYGhWxN6R+Ctnb9/4CpsHt+gdQUCZCDCSgAKCRB/4CpsHt+g\nda0cAQC3/VaSiDnD90OCfmHDLkJHlmeuJV+DMlmFrk5JTRJONAEA2U5vk0FP0coY\nI24B+sLUnmNUwsVy8UM+AYgFH/mzcAw=\n=6V7F\n-----END PGP SIGNATURE-----", "payload": "tree 6eb3e89a0db31b92c526688d1fd98d8d43682148\nparent a284a0c7cd2e2113a68c5e547ab3d10805dab6fb\nauthor DropDemBits <r3usrlnd@gmail.com> 1679868490 -0400\ncommitter DropDemBits <r3usrlnd@gmail.com> 1679868490 -0400\n\nfactor out adding a snippet\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/762eacef74e76d41c7aa5bd714926ce2ad6c50bf", "html_url": "https://github.com/rust-lang/rust/commit/762eacef74e76d41c7aa5bd714926ce2ad6c50bf", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/762eacef74e76d41c7aa5bd714926ce2ad6c50bf/comments", "author": {"login": "DropDemBits", "id": 13354275, "node_id": "MDQ6VXNlcjEzMzU0Mjc1", "avatar_url": "https://avatars.githubusercontent.com/u/13354275?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DropDemBits", "html_url": "https://github.com/DropDemBits", "followers_url": "https://api.github.com/users/DropDemBits/followers", "following_url": "https://api.github.com/users/DropDemBits/following{/other_user}", "gists_url": "https://api.github.com/users/DropDemBits/gists{/gist_id}", "starred_url": "https://api.github.com/users/DropDemBits/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DropDemBits/subscriptions", "organizations_url": "https://api.github.com/users/DropDemBits/orgs", "repos_url": "https://api.github.com/users/DropDemBits/repos", "events_url": "https://api.github.com/users/DropDemBits/events{/privacy}", "received_events_url": "https://api.github.com/users/DropDemBits/received_events", "type": "User", "site_admin": false}, "committer": {"login": "DropDemBits", "id": 13354275, "node_id": "MDQ6VXNlcjEzMzU0Mjc1", "avatar_url": "https://avatars.githubusercontent.com/u/13354275?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DropDemBits", "html_url": "https://github.com/DropDemBits", "followers_url": "https://api.github.com/users/DropDemBits/followers", "following_url": "https://api.github.com/users/DropDemBits/following{/other_user}", "gists_url": "https://api.github.com/users/DropDemBits/gists{/gist_id}", "starred_url": "https://api.github.com/users/DropDemBits/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DropDemBits/subscriptions", "organizations_url": "https://api.github.com/users/DropDemBits/orgs", "repos_url": "https://api.github.com/users/DropDemBits/repos", "events_url": "https://api.github.com/users/DropDemBits/events{/privacy}", "received_events_url": "https://api.github.com/users/DropDemBits/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a284a0c7cd2e2113a68c5e547ab3d10805dab6fb", "url": "https://api.github.com/repos/rust-lang/rust/commits/a284a0c7cd2e2113a68c5e547ab3d10805dab6fb", "html_url": "https://github.com/rust-lang/rust/commit/a284a0c7cd2e2113a68c5e547ab3d10805dab6fb"}], "stats": {"total": 15, "additions": 6, "deletions": 9}, "files": [{"sha": "04e62a8e9166e2746862012a6812d6a3c65f5076", "filename": "crates/ide-db/src/source_change.rs", "status": "modified", "additions": 6, "deletions": 9, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/762eacef74e76d41c7aa5bd714926ce2ad6c50bf/crates%2Fide-db%2Fsrc%2Fsource_change.rs", "raw_url": "https://github.com/rust-lang/rust/raw/762eacef74e76d41c7aa5bd714926ce2ad6c50bf/crates%2Fide-db%2Fsrc%2Fsource_change.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide-db%2Fsrc%2Fsource_change.rs?ref=762eacef74e76d41c7aa5bd714926ce2ad6c50bf", "patch": "@@ -237,27 +237,24 @@ impl SourceChangeBuilder {\n     /// Adds a tabstop snippet to place the cursor before `node`\n     pub fn add_tabstop_before(&mut self, _cap: SnippetCap, node: impl AstNode) {\n         assert!(node.syntax().parent().is_some());\n-\n-        let snippet_builder = self.snippet_builder.get_or_insert(SnippetBuilder { places: vec![] });\n-        snippet_builder.places.push(PlaceSnippet::Before(node.syntax().clone()));\n-        self.source_change.is_snippet = true;\n+        self.add_snippet(PlaceSnippet::Before(node.syntax().clone()));\n     }\n \n     /// Adds a tabstop snippet to place the cursor after `node`\n     pub fn add_tabstop_after(&mut self, _cap: SnippetCap, node: impl AstNode) {\n         assert!(node.syntax().parent().is_some());\n-\n-        let snippet_builder = self.snippet_builder.get_or_insert(SnippetBuilder { places: vec![] });\n-        snippet_builder.places.push(PlaceSnippet::After(node.syntax().clone()));\n-        self.source_change.is_snippet = true;\n+        self.add_snippet(PlaceSnippet::After(node.syntax().clone()));\n     }\n \n     /// Adds a snippet to move the cursor selected over `node`\n     pub fn add_placeholder_snippet(&mut self, _cap: SnippetCap, node: impl AstNode) {\n         assert!(node.syntax().parent().is_some());\n+        self.add_snippet(PlaceSnippet::Over(node.syntax().clone()))\n+    }\n \n+    fn add_snippet(&mut self, snippet: PlaceSnippet) {\n         let snippet_builder = self.snippet_builder.get_or_insert(SnippetBuilder { places: vec![] });\n-        snippet_builder.places.push(PlaceSnippet::Over(node.syntax().clone()));\n+        snippet_builder.places.push(snippet);\n         self.source_change.is_snippet = true;\n     }\n "}]}