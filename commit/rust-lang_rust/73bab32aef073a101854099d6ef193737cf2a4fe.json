{"sha": "73bab32aef073a101854099d6ef193737cf2a4fe", "node_id": "MDY6Q29tbWl0NzI0NzEyOjczYmFiMzJhZWYwNzNhMTAxODU0MDk5ZDZlZjE5MzczN2NmMmE0ZmU=", "commit": {"author": {"name": "GrayJack", "email": "gr41.j4ck@gmail.com", "date": "2020-07-20T12:46:50Z"}, "committer": {"name": "GrayJack", "email": "gr41.j4ck@gmail.com", "date": "2020-07-20T12:46:50Z"}, "message": "Highlight more cases of SyntaxKind when it is a punctuation", "tree": {"sha": "6636603fd06fcb68a3473746fc56261e36cc8362", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6636603fd06fcb68a3473746fc56261e36cc8362"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/73bab32aef073a101854099d6ef193737cf2a4fe", "comment_count": 0, "verification": {"verified": false, "reason": "unknown_key", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEcp2lmfLVC4NXZ3mZEsVOBKq5kx4FAl8VkjoACgkQEsVOBKq5\nkx5TChAAkX31KYoiE/+GDhoe30StXRb5TVLwGeJ5wahmbKARoAlc1VS07K1aXWh7\n5KrjcSMOME2k+NvXGZN4cZLhdhyCN42Yd9Nwd3sO4wiocRiv/0bcusvad+VRCuHU\nfKOaiL5+YdcJtF6Vu4Bw+W1o9dTE8alMTChzo5kmtOnk9BlR83nZH4bY6C8lYrTo\nI6zS9YbMc2DgOCKQY/B9qPHC09EbPJzYbiXZwCTZ9lwC9k5SlQuMRaGJGOJLM5hk\nfqYuP4sq3HTUK3Ms0CZlwLKALgWqHs4jslFIRGYvaETLmRGK06PJuIUFrT9sivg/\n17SWWrL5NPuhbPFbJkJcWpUNnH9VB57cJLRI9linINETfyTQObwUUhQnj1/r8BZB\n4mOiYbzHS2EZemFvyimZWpIsID2GR7igx/WDOWrIOp38BcHHGgEk7+CDEtFthnrb\nWTYoJHIcVmMfN3TLEkBMSc2QfO71Y2DiakTGcTJxHAIQD7CAOKuk2XZS/Ju2DZSL\n6HNXDuNh4M1mUfhOrcnQ4wy5IOWWsqyGrpvJ8Vj0WyAI0yNM//Q34TVeZjIJQoDP\nIq9xGsM3VeNEJ+i2p8vALQ1LbOwddf/u5M1vpHeSZw88Q8sO/2AR5pVPTORKL34a\nPYrif/Iu6SzbKgihvs9WB5qGdSMv41hXuZE50b3D1m5dZEH0OLo=\n=oXad\n-----END PGP SIGNATURE-----", "payload": "tree 6636603fd06fcb68a3473746fc56261e36cc8362\nparent c9c518e5e9761bf35d466c47c57c3a1358b56b3c\nauthor GrayJack <gr41.j4ck@gmail.com> 1595249210 -0300\ncommitter GrayJack <gr41.j4ck@gmail.com> 1595249210 -0300\n\nHighlight more cases of SyntaxKind when it is a punctuation\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/73bab32aef073a101854099d6ef193737cf2a4fe", "html_url": "https://github.com/rust-lang/rust/commit/73bab32aef073a101854099d6ef193737cf2a4fe", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/73bab32aef073a101854099d6ef193737cf2a4fe/comments", "author": {"login": "GrayJack", "id": 17973728, "node_id": "MDQ6VXNlcjE3OTczNzI4", "avatar_url": "https://avatars.githubusercontent.com/u/17973728?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GrayJack", "html_url": "https://github.com/GrayJack", "followers_url": "https://api.github.com/users/GrayJack/followers", "following_url": "https://api.github.com/users/GrayJack/following{/other_user}", "gists_url": "https://api.github.com/users/GrayJack/gists{/gist_id}", "starred_url": "https://api.github.com/users/GrayJack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GrayJack/subscriptions", "organizations_url": "https://api.github.com/users/GrayJack/orgs", "repos_url": "https://api.github.com/users/GrayJack/repos", "events_url": "https://api.github.com/users/GrayJack/events{/privacy}", "received_events_url": "https://api.github.com/users/GrayJack/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GrayJack", "id": 17973728, "node_id": "MDQ6VXNlcjE3OTczNzI4", "avatar_url": "https://avatars.githubusercontent.com/u/17973728?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GrayJack", "html_url": "https://github.com/GrayJack", "followers_url": "https://api.github.com/users/GrayJack/followers", "following_url": "https://api.github.com/users/GrayJack/following{/other_user}", "gists_url": "https://api.github.com/users/GrayJack/gists{/gist_id}", "starred_url": "https://api.github.com/users/GrayJack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GrayJack/subscriptions", "organizations_url": "https://api.github.com/users/GrayJack/orgs", "repos_url": "https://api.github.com/users/GrayJack/repos", "events_url": "https://api.github.com/users/GrayJack/events{/privacy}", "received_events_url": "https://api.github.com/users/GrayJack/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c9c518e5e9761bf35d466c47c57c3a1358b56b3c", "url": "https://api.github.com/repos/rust-lang/rust/commits/c9c518e5e9761bf35d466c47c57c3a1358b56b3c", "html_url": "https://github.com/rust-lang/rust/commit/c9c518e5e9761bf35d466c47c57c3a1358b56b3c"}], "stats": {"total": 46, "additions": 32, "deletions": 14}, "files": [{"sha": "606637d11b3da8277986ae2e5af3c7c9849ca3ed", "filename": "crates/ra_ide/src/syntax_highlighting.rs", "status": "modified", "additions": 32, "deletions": 14, "changes": 46, "blob_url": "https://github.com/rust-lang/rust/blob/73bab32aef073a101854099d6ef193737cf2a4fe/crates%2Fra_ide%2Fsrc%2Fsyntax_highlighting.rs", "raw_url": "https://github.com/rust-lang/rust/raw/73bab32aef073a101854099d6ef193737cf2a4fe/crates%2Fra_ide%2Fsrc%2Fsyntax_highlighting.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide%2Fsrc%2Fsyntax_highlighting.rs?ref=73bab32aef073a101854099d6ef193737cf2a4fe", "patch": "@@ -539,21 +539,39 @@ fn highlight_element(\n                 _ => h,\n             }\n         }\n-        T![*] => {\n-            let prefix_expr = element.parent().and_then(ast::PrefixExpr::cast)?;\n-\n-            let expr = prefix_expr.expr()?;\n-            let ty = sema.type_of_expr(&expr)?;\n-            if !ty.is_raw_ptr() {\n-                return None;\n-            } else {\n-                HighlightTag::Operator | HighlightModifier::Unsafe\n+        p if p.is_punct() => match p {\n+            T![::] | T![->] | T![=>] | T![&] => HighlightTag::Operator.into(),\n+            T![@] => HighlightTag::Operator | HighlightModifier::ControlFlow,\n+            T![!] if element.parent().and_then(ast::MacroCall::cast).is_some() => {\n+                Highlight::new(HighlightTag::Macro)\n             }\n-        }\n-        T![!] if element.parent().and_then(ast::MacroCall::cast).is_some() => {\n-            Highlight::new(HighlightTag::Macro)\n-        }\n-        p if p.is_punct() => HighlightTag::Punctuation.into(),\n+            T![*] if element.parent().and_then(ast::PrefixExpr::cast).is_some() => {\n+                let prefix_expr = element.parent().and_then(ast::PrefixExpr::cast)?;\n+\n+                let expr = prefix_expr.expr()?;\n+                let ty = sema.type_of_expr(&expr)?;\n+                if ty.is_raw_ptr() {\n+                    HighlightTag::Operator | HighlightModifier::Unsafe\n+                } else if let Some(ast::PrefixOp::Deref) = prefix_expr.op_kind() {\n+                    HighlightTag::Operator.into()\n+                } else {\n+                    HighlightTag::Punctuation.into()\n+                }\n+            }\n+            T![-] if element.parent().and_then(ast::PrefixExpr::cast).is_some() => {\n+                HighlightTag::NumericLiteral.into()\n+            }\n+            _ if element.parent().and_then(ast::PrefixExpr::cast).is_some() => {\n+                HighlightTag::Operator.into()\n+            }\n+            _ if element.parent().and_then(ast::BinExpr::cast).is_some() => {\n+                HighlightTag::Operator.into()\n+            }\n+            _ if element.parent().and_then(ast::RangeExpr::cast).is_some() => {\n+                HighlightTag::Operator.into()\n+            }\n+            _ => HighlightTag::Punctuation.into(),\n+        },\n \n         k if k.is_keyword() => {\n             let h = Highlight::new(HighlightTag::Keyword);"}]}