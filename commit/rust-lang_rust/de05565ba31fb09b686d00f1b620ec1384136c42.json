{"sha": "de05565ba31fb09b686d00f1b620ec1384136c42", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRlMDU1NjViYTMxZmIwOWI2ODZkMDBmMWI2MjBlYzEzODQxMzZjNDI=", "commit": {"author": {"name": "Jakub Bukaj", "email": "jakub@jakub.cc", "date": "2014-11-17T23:24:07Z"}, "committer": {"name": "Jakub Bukaj", "email": "jakub@jakub.cc", "date": "2014-11-17T23:24:07Z"}, "message": "rollup merge of #19029: vberger/stability_function_body\n\nItems defined in the body of a function has no visibility outside it, and thus have no reason to inherit its stability.\n\nCloses #17488", "tree": {"sha": "ced0057bb2a8e6fb97cd782e9347b656a623281e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ced0057bb2a8e6fb97cd782e9347b656a623281e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/de05565ba31fb09b686d00f1b620ec1384136c42", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/de05565ba31fb09b686d00f1b620ec1384136c42", "html_url": "https://github.com/rust-lang/rust/commit/de05565ba31fb09b686d00f1b620ec1384136c42", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/de05565ba31fb09b686d00f1b620ec1384136c42/comments", "author": null, "committer": null, "parents": [{"sha": "f3759dd2b66c155450f5fa618a22ae66ba4b5c7d", "url": "https://api.github.com/repos/rust-lang/rust/commits/f3759dd2b66c155450f5fa618a22ae66ba4b5c7d", "html_url": "https://github.com/rust-lang/rust/commit/f3759dd2b66c155450f5fa618a22ae66ba4b5c7d"}, {"sha": "55200504f06956664cc6a9a998e7a14e05f09fdb", "url": "https://api.github.com/repos/rust-lang/rust/commits/55200504f06956664cc6a9a998e7a14e05f09fdb", "html_url": "https://github.com/rust-lang/rust/commit/55200504f06956664cc6a9a998e7a14e05f09fdb"}], "stats": {"total": 21, "additions": 19, "deletions": 2}, "files": [{"sha": "e3069f54e4497518be49eb009ce1c2ab804cd6ea", "filename": "src/librustc/middle/stability.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/de05565ba31fb09b686d00f1b620ec1384136c42/src%2Flibrustc%2Fmiddle%2Fstability.rs", "raw_url": "https://github.com/rust-lang/rust/raw/de05565ba31fb09b686d00f1b620ec1384136c42/src%2Flibrustc%2Fmiddle%2Fstability.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fstability.rs?ref=de05565ba31fb09b686d00f1b620ec1384136c42", "patch": "@@ -83,10 +83,13 @@ impl<'v> Visitor<'v> for Annotator {\n                 b: &'v Block, s: Span, _: NodeId) {\n         match fk {\n             FkMethod(_, _, meth) => {\n-                self.annotate(meth.id, &meth.attrs, |v| visit::walk_fn(v, fk, fd, b, s));\n+                // Methods are not already annotated, so we annotate it\n+                self.annotate(meth.id, &meth.attrs, |_| {});\n             }\n-            _ => visit::walk_fn(self, fk, fd, b, s)\n+            _ => {}\n         }\n+        // Items defined in a function body have no reason to have\n+        // a stability attribute, so we don't recurse.\n     }\n \n     fn visit_trait_item(&mut self, t: &TraitItem) {"}, {"sha": "8e1723ddab24cc8848e76f84c57ca5a3e25599a8", "filename": "src/test/compile-fail/lint-stability.rs", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/de05565ba31fb09b686d00f1b620ec1384136c42/src%2Ftest%2Fcompile-fail%2Flint-stability.rs", "raw_url": "https://github.com/rust-lang/rust/raw/de05565ba31fb09b686d00f1b620ec1384136c42/src%2Ftest%2Fcompile-fail%2Flint-stability.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Flint-stability.rs?ref=de05565ba31fb09b686d00f1b620ec1384136c42", "patch": "@@ -459,6 +459,20 @@ mod this_crate {\n         foo.trait_stable();\n     }\n \n+    #[deprecated]\n+    fn test_fn_body() {\n+        fn fn_in_body() {}\n+        fn_in_body();\n+    }\n+\n+    impl MethodTester {\n+        #[deprecated]\n+        fn test_method_body(&self) {\n+            fn fn_in_body() {}\n+            fn_in_body();\n+        }\n+    }\n+\n     #[deprecated]\n     pub trait DeprecatedTrait {}\n "}]}