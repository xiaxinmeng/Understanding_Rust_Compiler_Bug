{"sha": "51b110fc6801200501e8b92f0ca7b90fa1b52d46", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUxYjExMGZjNjgwMTIwMDUwMWU4YjkyZjBjYTdiOTBmYTFiNTJkNDY=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-09-08T20:34:26Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-09-08T20:34:26Z"}, "message": "Rollup merge of #64288 - guanqun:use-get-toml, r=Mark-Simulacrum\n\nuse 'get_toml' instead of regular expression", "tree": {"sha": "2f12c24c5d782663e770156e3394fdecec5185d1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2f12c24c5d782663e770156e3394fdecec5185d1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/51b110fc6801200501e8b92f0ca7b90fa1b52d46", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJddWXSCRBK7hj4Ov3rIwAAdHIIAI3/pVqjK23C16uklLeL9g1z\nl7Pny/Fzr4Rdqxf1za5JYcuiTtIh9SJ2IN0RjJf8T1/H+aK4mBXaRsfrFmXq5KRd\nbcsO50XUCynpb0kgZkH2gvh0x/42k20DZD2jPnYXblw5AyZ4T6nWKGfPK46W1SCM\n5i9VFkW2cuiTSQKALdiMqT8ntNuFXxHuwwZKrV7kDgb6YWPshyUgBCfeSY0NYhHd\ns94JXprVMCj/IixZobSHTis5wy2e6+B2sdD4jg7Azr6tPAOgDMxeRPneyB1bh37D\n9WOxJPW2fpObPNdIKxHOGVHrvYWP07YNWrIdpcye0XEs28vQoqNm1HCt2vLKDCM=\n=FLCs\n-----END PGP SIGNATURE-----\n", "payload": "tree 2f12c24c5d782663e770156e3394fdecec5185d1\nparent 17166784507a9bdbfb4531ce0030c67603ed5907\nparent 85e09c6531e1d3920065310c275b573bfad412ac\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1567974866 +0200\ncommitter GitHub <noreply@github.com> 1567974866 +0200\n\nRollup merge of #64288 - guanqun:use-get-toml, r=Mark-Simulacrum\n\nuse 'get_toml' instead of regular expression\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/51b110fc6801200501e8b92f0ca7b90fa1b52d46", "html_url": "https://github.com/rust-lang/rust/commit/51b110fc6801200501e8b92f0ca7b90fa1b52d46", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/51b110fc6801200501e8b92f0ca7b90fa1b52d46/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "17166784507a9bdbfb4531ce0030c67603ed5907", "url": "https://api.github.com/repos/rust-lang/rust/commits/17166784507a9bdbfb4531ce0030c67603ed5907", "html_url": "https://github.com/rust-lang/rust/commit/17166784507a9bdbfb4531ce0030c67603ed5907"}, {"sha": "85e09c6531e1d3920065310c275b573bfad412ac", "url": "https://api.github.com/repos/rust-lang/rust/commits/85e09c6531e1d3920065310c275b573bfad412ac", "html_url": "https://github.com/rust-lang/rust/commit/85e09c6531e1d3920065310c275b573bfad412ac"}], "stats": {"total": 20, "additions": 15, "deletions": 5}, "files": [{"sha": "14bc90700b76eef7ac896cf5a2867288aed599dc", "filename": "src/bootstrap/bootstrap.py", "status": "modified", "additions": 15, "deletions": 5, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/51b110fc6801200501e8b92f0ca7b90fa1b52d46/src%2Fbootstrap%2Fbootstrap.py", "raw_url": "https://github.com/rust-lang/rust/raw/51b110fc6801200501e8b92f0ca7b90fa1b52d46/src%2Fbootstrap%2Fbootstrap.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbootstrap.py?ref=51b110fc6801200501e8b92f0ca7b90fa1b52d46", "patch": "@@ -523,6 +523,10 @@ def get_toml(self, key, section=None):\n         'value2'\n         >>> rb.get_toml('key', 'c') is None\n         True\n+\n+        >>> rb.config_toml = 'key1 = true'\n+        >>> rb.get_toml(\"key1\")\n+        'true'\n         \"\"\"\n \n         cur_section = None\n@@ -571,6 +575,12 @@ def get_string(line):\n \n         >>> RustBuild.get_string('    \"devel\"   ')\n         'devel'\n+        >>> RustBuild.get_string(\"    'devel'   \")\n+        'devel'\n+        >>> RustBuild.get_string('devel') is None\n+        True\n+        >>> RustBuild.get_string('    \"devel   ')\n+        ''\n         \"\"\"\n         start = line.find('\"')\n         if start != -1:\n@@ -822,13 +832,13 @@ def bootstrap(help_triggered):\n     except (OSError, IOError):\n         pass\n \n-    match = re.search(r'\\nverbose = (\\d+)', build.config_toml)\n-    if match is not None:\n-        build.verbose = max(build.verbose, int(match.group(1)))\n+    config_verbose = build.get_toml('verbose', 'build')\n+    if config_verbose is not None:\n+        build.verbose = max(build.verbose, int(config_verbose))\n \n-    build.use_vendored_sources = '\\nvendor = true' in build.config_toml\n+    build.use_vendored_sources = build.get_toml('vendor', 'build') == 'true'\n \n-    build.use_locked_deps = '\\nlocked-deps = true' in build.config_toml\n+    build.use_locked_deps = build.get_toml('locked-deps', 'build') == 'true'\n \n     build.check_vendored_status()\n "}]}