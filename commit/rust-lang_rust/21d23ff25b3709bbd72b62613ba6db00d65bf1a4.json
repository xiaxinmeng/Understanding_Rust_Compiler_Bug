{"sha": "21d23ff25b3709bbd72b62613ba6db00d65bf1a4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjIxZDIzZmYyNWIzNzA5YmJkNzJiNjI2MTNiYTZkYjAwZDY1YmYxYTQ=", "commit": {"author": {"name": "Flavio Percoco", "email": "flaper87@gmail.com", "date": "2014-03-05T21:09:38Z"}, "committer": {"name": "Flavio Percoco", "email": "flaper87@gmail.com", "date": "2014-03-20T09:16:55Z"}, "message": "Make `Rc`, `Cell` and `RefCell` NoShare", "tree": {"sha": "edf3d1327f7345df85bb8c6cfe0b5f96d626cece", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/edf3d1327f7345df85bb8c6cfe0b5f96d626cece"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/21d23ff25b3709bbd72b62613ba6db00d65bf1a4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/21d23ff25b3709bbd72b62613ba6db00d65bf1a4", "html_url": "https://github.com/rust-lang/rust/commit/21d23ff25b3709bbd72b62613ba6db00d65bf1a4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/21d23ff25b3709bbd72b62613ba6db00d65bf1a4/comments", "author": {"login": "flaper87", "id": 13816, "node_id": "MDQ6VXNlcjEzODE2", "avatar_url": "https://avatars.githubusercontent.com/u/13816?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flaper87", "html_url": "https://github.com/flaper87", "followers_url": "https://api.github.com/users/flaper87/followers", "following_url": "https://api.github.com/users/flaper87/following{/other_user}", "gists_url": "https://api.github.com/users/flaper87/gists{/gist_id}", "starred_url": "https://api.github.com/users/flaper87/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flaper87/subscriptions", "organizations_url": "https://api.github.com/users/flaper87/orgs", "repos_url": "https://api.github.com/users/flaper87/repos", "events_url": "https://api.github.com/users/flaper87/events{/privacy}", "received_events_url": "https://api.github.com/users/flaper87/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flaper87", "id": 13816, "node_id": "MDQ6VXNlcjEzODE2", "avatar_url": "https://avatars.githubusercontent.com/u/13816?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flaper87", "html_url": "https://github.com/flaper87", "followers_url": "https://api.github.com/users/flaper87/followers", "following_url": "https://api.github.com/users/flaper87/following{/other_user}", "gists_url": "https://api.github.com/users/flaper87/gists{/gist_id}", "starred_url": "https://api.github.com/users/flaper87/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flaper87/subscriptions", "organizations_url": "https://api.github.com/users/flaper87/orgs", "repos_url": "https://api.github.com/users/flaper87/repos", "events_url": "https://api.github.com/users/flaper87/events{/privacy}", "received_events_url": "https://api.github.com/users/flaper87/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "37154fb8b939e9f81d9feb8139c7879099fb5cd6", "url": "https://api.github.com/repos/rust-lang/rust/commits/37154fb8b939e9f81d9feb8139c7879099fb5cd6", "html_url": "https://github.com/rust-lang/rust/commit/37154fb8b939e9f81d9feb8139c7879099fb5cd6"}], "stats": {"total": 25, "additions": 18, "deletions": 7}, "files": [{"sha": "3276bbbcbb6255a403c0b485dbbf775ab523e184", "filename": "src/libstd/cell.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/21d23ff25b3709bbd72b62613ba6db00d65bf1a4/src%2Flibstd%2Fcell.rs", "raw_url": "https://github.com/rust-lang/rust/raw/21d23ff25b3709bbd72b62613ba6db00d65bf1a4/src%2Flibstd%2Fcell.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fcell.rs?ref=21d23ff25b3709bbd72b62613ba6db00d65bf1a4", "patch": "@@ -23,6 +23,7 @@ pub struct Cell<T> {\n     priv value: T,\n     priv marker1: marker::InvariantType<T>,\n     priv marker2: marker::NoFreeze,\n+    priv marker3: marker::NoShare,\n }\n \n impl<T:Pod> Cell<T> {\n@@ -32,6 +33,7 @@ impl<T:Pod> Cell<T> {\n             value: value,\n             marker1: marker::InvariantType::<T>,\n             marker2: marker::NoFreeze,\n+            marker3: marker::NoShare,\n         }\n     }\n \n@@ -75,6 +77,7 @@ pub struct RefCell<T> {\n     priv marker1: marker::InvariantType<T>,\n     priv marker2: marker::NoFreeze,\n     priv marker3: marker::NoPod,\n+    priv marker4: marker::NoShare,\n }\n \n // Values [1, MAX-1] represent the number of `Ref` active\n@@ -90,6 +93,7 @@ impl<T> RefCell<T> {\n             marker1: marker::InvariantType::<T>,\n             marker2: marker::NoFreeze,\n             marker3: marker::NoPod,\n+            marker4: marker::NoShare,\n             value: value,\n             borrow: UNUSED,\n         }"}, {"sha": "605cbd3f28a12fba59272d1f8d8ec3914841055d", "filename": "src/libstd/rc.rs", "status": "modified", "additions": 14, "deletions": 7, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/21d23ff25b3709bbd72b62613ba6db00d65bf1a4/src%2Flibstd%2Frc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/21d23ff25b3709bbd72b62613ba6db00d65bf1a4/src%2Flibstd%2Frc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Frc.rs?ref=21d23ff25b3709bbd72b62613ba6db00d65bf1a4", "patch": "@@ -42,7 +42,8 @@ struct RcBox<T> {\n #[unsafe_no_drop_flag]\n pub struct Rc<T> {\n     priv ptr: *mut RcBox<T>,\n-    priv marker: marker::NoSend\n+    priv nosend: marker::NoSend,\n+    priv noshare: marker::NoShare\n }\n \n impl<T> Rc<T> {\n@@ -56,7 +57,8 @@ impl<T> Rc<T> {\n                 // strong destructor is running, even if the weak\n                 // pointer is stored inside the strong one.\n                 ptr: transmute(~RcBox { value: value, strong: 1, weak: 1 }),\n-                marker: marker::NoSend,\n+                nosend: marker::NoSend,\n+                noshare: marker::NoShare\n             }\n         }\n     }\n@@ -67,7 +69,11 @@ impl<T> Rc<T> {\n     pub fn downgrade(&self) -> Weak<T> {\n         unsafe {\n             (*self.ptr).weak += 1;\n-            Weak { ptr: self.ptr, marker: marker::NoSend }\n+            Weak {\n+                ptr: self.ptr,\n+                nosend: marker::NoSend,\n+                noshare: marker::NoShare\n+            }\n         }\n     }\n }\n@@ -107,7 +113,7 @@ impl<T> Clone for Rc<T> {\n     fn clone(&self) -> Rc<T> {\n         unsafe {\n             (*self.ptr).strong += 1;\n-            Rc { ptr: self.ptr, marker: marker::NoSend }\n+            Rc { ptr: self.ptr, nosend: marker::NoSend, noshare: marker::NoShare }\n         }\n     }\n }\n@@ -138,7 +144,8 @@ impl<T: Ord> Ord for Rc<T> {\n #[unsafe_no_drop_flag]\n pub struct Weak<T> {\n     priv ptr: *mut RcBox<T>,\n-    priv marker: marker::NoSend\n+    priv nosend: marker::NoSend,\n+    priv noshare: marker::NoShare\n }\n \n impl<T> Weak<T> {\n@@ -149,7 +156,7 @@ impl<T> Weak<T> {\n                 None\n             } else {\n                 (*self.ptr).strong += 1;\n-                Some(Rc { ptr: self.ptr, marker: marker::NoSend })\n+                Some(Rc { ptr: self.ptr, nosend: marker::NoSend, noshare: marker::NoShare })\n             }\n         }\n     }\n@@ -176,7 +183,7 @@ impl<T> Clone for Weak<T> {\n     fn clone(&self) -> Weak<T> {\n         unsafe {\n             (*self.ptr).weak += 1;\n-            Weak { ptr: self.ptr, marker: marker::NoSend }\n+            Weak { ptr: self.ptr, nosend: marker::NoSend, noshare: marker::NoShare }\n         }\n     }\n }"}]}