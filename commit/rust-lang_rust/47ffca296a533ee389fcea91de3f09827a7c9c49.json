{"sha": "47ffca296a533ee389fcea91de3f09827a7c9c49", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ3ZmZjYTI5NmE1MzNlZTM4OWZjZWE5MWRlM2YwOTgyN2E3YzljNDk=", "commit": {"author": {"name": "Dylan DPC", "email": "dylan.dpc@gmail.com", "date": "2020-03-30T14:24:44Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-03-30T14:24:44Z"}, "message": "Rollup merge of #70479 - RalfJung:win-env, r=Mark-Simulacrum\n\navoid creating unnecessary reference in Windows Env iterator\n\nDiscovered in https://github.com/rust-lang/miri/pull/1225: the Windows `Env` iterator violates Stacked Borrows by creating an `&u16`, turning it into a raw pointer, and then accessing memory outside the range of that type.\n\nThere is no need to create a reference here in the first place, so the fix is trivial.\nCc @JOE1994\nCc https://github.com/rust-lang/unsafe-code-guidelines/issues/134", "tree": {"sha": "3cf343394b6bce7b8d6d3423e444512337528ec4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3cf343394b6bce7b8d6d3423e444512337528ec4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/47ffca296a533ee389fcea91de3f09827a7c9c49", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJeggEsCRBK7hj4Ov3rIwAAdHIIADkJMiefft+dHMUO4hoPRYkX\nj1ZeEKg35JElC4e/kEgtVP005fTSMibJcmpD2D5SZDCm7lGQIlURbl7CUsoqwxaC\nhCSn0gYvnWnS55d+cKkzfdzJelPLuiMXNoly82B9iuiCC482nzoMrJZVUdW5/Hp4\nakyBJXsMA0t4kWrjDKFnzYLK0UDr8eFEywp/GPWu4FbT8R2MmOf8/Bjy8niKd/wT\nNDXkkF6RTgvtxwOJ0APwGsgjmhDiloxWI5RdC5ul/20s0K7hTYRboHYn2CVEsAUx\nq5mT7Ype8bYfGfXhUVrC4bl58JDx8IUfz7nJTJWRSYtbR1apZn+wimgy6FuGXO4=\n=7vz4\n-----END PGP SIGNATURE-----\n", "payload": "tree 3cf343394b6bce7b8d6d3423e444512337528ec4\nparent a80ec3b3b1d11ed83754885efdd07037d256dbf2\nparent 2a1e61e2d653cd287ac902bdf3411d8cbbc40f0c\nauthor Dylan DPC <dylan.dpc@gmail.com> 1585578284 +0200\ncommitter GitHub <noreply@github.com> 1585578284 +0200\n\nRollup merge of #70479 - RalfJung:win-env, r=Mark-Simulacrum\n\navoid creating unnecessary reference in Windows Env iterator\n\nDiscovered in https://github.com/rust-lang/miri/pull/1225: the Windows `Env` iterator violates Stacked Borrows by creating an `&u16`, turning it into a raw pointer, and then accessing memory outside the range of that type.\n\nThere is no need to create a reference here in the first place, so the fix is trivial.\nCc @JOE1994\nCc https://github.com/rust-lang/unsafe-code-guidelines/issues/134\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/47ffca296a533ee389fcea91de3f09827a7c9c49", "html_url": "https://github.com/rust-lang/rust/commit/47ffca296a533ee389fcea91de3f09827a7c9c49", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/47ffca296a533ee389fcea91de3f09827a7c9c49/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a80ec3b3b1d11ed83754885efdd07037d256dbf2", "url": "https://api.github.com/repos/rust-lang/rust/commits/a80ec3b3b1d11ed83754885efdd07037d256dbf2", "html_url": "https://github.com/rust-lang/rust/commit/a80ec3b3b1d11ed83754885efdd07037d256dbf2"}, {"sha": "2a1e61e2d653cd287ac902bdf3411d8cbbc40f0c", "url": "https://api.github.com/repos/rust-lang/rust/commits/2a1e61e2d653cd287ac902bdf3411d8cbbc40f0c", "html_url": "https://github.com/rust-lang/rust/commit/2a1e61e2d653cd287ac902bdf3411d8cbbc40f0c"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "a0da2498bb7e0fec156dd7cb11251f4ed98ffb1c", "filename": "src/libstd/sys/windows/os.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/47ffca296a533ee389fcea91de3f09827a7c9c49/src%2Flibstd%2Fsys%2Fwindows%2Fos.rs", "raw_url": "https://github.com/rust-lang/rust/raw/47ffca296a533ee389fcea91de3f09827a7c9c49/src%2Flibstd%2Fsys%2Fwindows%2Fos.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Fwindows%2Fos.rs?ref=47ffca296a533ee389fcea91de3f09827a7c9c49", "patch": "@@ -94,7 +94,7 @@ impl Iterator for Env {\n                 if *self.cur == 0 {\n                     return None;\n                 }\n-                let p = &*self.cur as *const u16;\n+                let p = self.cur as *const u16;\n                 let mut len = 0;\n                 while *p.offset(len) != 0 {\n                     len += 1;"}]}