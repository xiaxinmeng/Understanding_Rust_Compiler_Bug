{"sha": "99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94", "node_id": "C_kwDOAAsO6NoAKDk5ZDU3ZWUyM2Q2MTI5M2JjMTRmNmE4ZjBlYjlhZDRmZTEwYWNjOTQ", "commit": {"author": {"name": "Arthur Cohen", "email": "arthur.cohen@embecosm.com", "date": "2022-08-18T09:15:26Z"}, "committer": {"name": "Arthur Cohen", "email": "arthur.cohen@embecosm.com", "date": "2022-09-27T13:55:42Z"}, "message": "core: Mark all safe intrinsics with #[rustc_safe_intrinsic]", "tree": {"sha": "622f0d882db942e9cf7fadfe78ae283f2cbed0a4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/622f0d882db942e9cf7fadfe78ae283f2cbed0a4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94", "html_url": "https://github.com/rust-lang/rust/commit/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/comments", "author": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "committer": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0ab2c91a2d8fe770d9fc47f06545367bab8ea302", "url": "https://api.github.com/repos/rust-lang/rust/commits/0ab2c91a2d8fe770d9fc47f06545367bab8ea302", "html_url": "https://github.com/rust-lang/rust/commit/0ab2c91a2d8fe770d9fc47f06545367bab8ea302"}], "stats": {"total": 53, "additions": 51, "deletions": 2}, "files": [{"sha": "cc546bdbb3b353ecf242e618d6090ac9f59d6da9", "filename": "compiler/rustc_error_codes/src/error_codes/E0094.md", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0094.md", "raw_url": "https://github.com/rust-lang/rust/raw/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0094.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0094.md?ref=99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94", "patch": "@@ -6,6 +6,7 @@ Erroneous code example:\n #![feature(intrinsics)]\n \n extern \"rust-intrinsic\" {\n+    #[rustc_safe_intrinsic]\n     fn size_of<T, U>() -> usize; // error: intrinsic has wrong number\n                                  //        of type parameters\n }\n@@ -19,6 +20,7 @@ Example:\n #![feature(intrinsics)]\n \n extern \"rust-intrinsic\" {\n+    #[rustc_safe_intrinsic]\n     fn size_of<T>() -> usize; // ok!\n }\n ```"}, {"sha": "8c2462ebd9b86d87b40f7e64c67eb4fcbdf07fef", "filename": "compiler/rustc_error_codes/src/error_codes/E0211.md", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0211.md", "raw_url": "https://github.com/rust-lang/rust/raw/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0211.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0211.md?ref=99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94", "patch": "@@ -7,6 +7,7 @@ used. Erroneous code examples:\n #![feature(intrinsics)]\n \n extern \"rust-intrinsic\" {\n+    #[rustc_safe_intrinsic]\n     fn size_of<T>(); // error: intrinsic has wrong type\n }\n \n@@ -42,6 +43,7 @@ For the first code example, please check the function definition. Example:\n #![feature(intrinsics)]\n \n extern \"rust-intrinsic\" {\n+    #[rustc_safe_intrinsic]\n     fn size_of<T>() -> usize; // ok!\n }\n ```"}, {"sha": "15ee14398b6768cb644a6a7c3a9f17ba6f6323f4", "filename": "library/core/src/intrinsics.rs", "status": "modified", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/library%2Fcore%2Fsrc%2Fintrinsics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/library%2Fcore%2Fsrc%2Fintrinsics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fintrinsics.rs?ref=99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94", "patch": "@@ -788,6 +788,7 @@ extern \"rust-intrinsic\" {\n     /// uninitialized at that point in the control flow.\n     ///\n     /// This intrinsic should not be used outside of the compiler.\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn rustc_peek<T>(_: T) -> T;\n \n     /// Aborts the execution of the process.\n@@ -805,6 +806,7 @@ extern \"rust-intrinsic\" {\n     /// On Unix, the\n     /// process will probably terminate with a signal like `SIGABRT`, `SIGILL`, `SIGTRAP`, `SIGSEGV` or\n     /// `SIGBUS`.  The precise behaviour is not guaranteed and not stable.\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn abort() -> !;\n \n     /// Informs the optimizer that this point in the code is not reachable,\n@@ -843,6 +845,7 @@ extern \"rust-intrinsic\" {\n     ///\n     /// This intrinsic does not have a stable counterpart.\n     #[rustc_const_unstable(feature = \"const_likely\", issue = \"none\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn likely(b: bool) -> bool;\n \n     /// Hints to the compiler that branch condition is likely to be false.\n@@ -857,6 +860,7 @@ extern \"rust-intrinsic\" {\n     ///\n     /// This intrinsic does not have a stable counterpart.\n     #[rustc_const_unstable(feature = \"const_likely\", issue = \"none\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn unlikely(b: bool) -> bool;\n \n     /// Executes a breakpoint trap, for inspection by a debugger.\n@@ -876,6 +880,7 @@ extern \"rust-intrinsic\" {\n     ///\n     /// The stabilized version of this intrinsic is [`core::mem::size_of`].\n     #[rustc_const_stable(feature = \"const_size_of\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn size_of<T>() -> usize;\n \n     /// The minimum alignment of a type.\n@@ -887,6 +892,7 @@ extern \"rust-intrinsic\" {\n     ///\n     /// The stabilized version of this intrinsic is [`core::mem::align_of`].\n     #[rustc_const_stable(feature = \"const_min_align_of\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn min_align_of<T>() -> usize;\n     /// The preferred alignment of a type.\n     ///\n@@ -915,6 +921,7 @@ extern \"rust-intrinsic\" {\n     ///\n     /// The stabilized version of this intrinsic is [`core::any::type_name`].\n     #[rustc_const_unstable(feature = \"const_type_name\", issue = \"63084\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn type_name<T: ?Sized>() -> &'static str;\n \n     /// Gets an identifier which is globally unique to the specified type. This\n@@ -928,27 +935,31 @@ extern \"rust-intrinsic\" {\n     ///\n     /// The stabilized version of this intrinsic is [`core::any::TypeId::of`].\n     #[rustc_const_unstable(feature = \"const_type_id\", issue = \"77125\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn type_id<T: ?Sized + 'static>() -> u64;\n \n     /// A guard for unsafe functions that cannot ever be executed if `T` is uninhabited:\n     /// This will statically either panic, or do nothing.\n     ///\n     /// This intrinsic does not have a stable counterpart.\n     #[rustc_const_stable(feature = \"const_assert_type\", since = \"1.59.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn assert_inhabited<T>();\n \n     /// A guard for unsafe functions that cannot ever be executed if `T` does not permit\n     /// zero-initialization: This will statically either panic, or do nothing.\n     ///\n     /// This intrinsic does not have a stable counterpart.\n     #[rustc_const_unstable(feature = \"const_assert_type2\", issue = \"none\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn assert_zero_valid<T>();\n \n     /// A guard for unsafe functions that cannot ever be executed if `T` has invalid\n     /// bit patterns: This will statically either panic, or do nothing.\n     ///\n     /// This intrinsic does not have a stable counterpart.\n     #[rustc_const_unstable(feature = \"const_assert_type2\", issue = \"none\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn assert_uninit_valid<T>();\n \n     /// Gets a reference to a static `Location` indicating where it was called.\n@@ -960,6 +971,7 @@ extern \"rust-intrinsic\" {\n     ///\n     /// Consider using [`core::panic::Location::caller`] instead.\n     #[rustc_const_unstable(feature = \"const_caller_location\", issue = \"76156\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn caller_location() -> &'static crate::panic::Location<'static>;\n \n     /// Moves a value out of scope without running drop glue.\n@@ -972,6 +984,7 @@ extern \"rust-intrinsic\" {\n     /// Therefore, implementations must not require the user to uphold\n     /// any safety invariants.\n     #[rustc_const_unstable(feature = \"const_intrinsic_forget\", issue = \"none\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn forget<T: ?Sized>(_: T);\n \n     /// Reinterprets the bits of a value of one type as another type.\n@@ -1251,6 +1264,7 @@ extern \"rust-intrinsic\" {\n     ///\n     /// The stabilized version of this intrinsic is [`mem::needs_drop`](crate::mem::needs_drop).\n     #[rustc_const_stable(feature = \"const_needs_drop\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn needs_drop<T: ?Sized>() -> bool;\n \n     /// Calculates the offset from a pointer.\n@@ -1295,6 +1309,7 @@ extern \"rust-intrinsic\" {\n     /// any safety invariants.\n     ///\n     /// Consider using [`pointer::mask`] instead.\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn ptr_mask<T>(ptr: *const T, mask: usize) -> *const T;\n \n     /// Equivalent to the appropriate `llvm.memcpy.p0i8.0i8.*` intrinsic, with\n@@ -1486,6 +1501,7 @@ extern \"rust-intrinsic\" {\n     ///\n     /// The stabilized version of this intrinsic is\n     /// [`f32::min`]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn minnumf32(x: f32, y: f32) -> f32;\n     /// Returns the minimum of two `f64` values.\n     ///\n@@ -1496,6 +1512,7 @@ extern \"rust-intrinsic\" {\n     ///\n     /// The stabilized version of this intrinsic is\n     /// [`f64::min`]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn minnumf64(x: f64, y: f64) -> f64;\n     /// Returns the maximum of two `f32` values.\n     ///\n@@ -1506,6 +1523,7 @@ extern \"rust-intrinsic\" {\n     ///\n     /// The stabilized version of this intrinsic is\n     /// [`f32::max`]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn maxnumf32(x: f32, y: f32) -> f32;\n     /// Returns the maximum of two `f64` values.\n     ///\n@@ -1516,6 +1534,7 @@ extern \"rust-intrinsic\" {\n     ///\n     /// The stabilized version of this intrinsic is\n     /// [`f64::max`]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn maxnumf64(x: f64, y: f64) -> f64;\n \n     /// Copies the sign from `y` to `x` for `f32` values.\n@@ -1636,6 +1655,7 @@ extern \"rust-intrinsic\" {\n     /// primitives via the `count_ones` method. For example,\n     /// [`u32::count_ones`]\n     #[rustc_const_stable(feature = \"const_ctpop\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn ctpop<T: Copy>(x: T) -> T;\n \n     /// Returns the number of leading unset bits (zeroes) in an integer type `T`.\n@@ -1673,6 +1693,7 @@ extern \"rust-intrinsic\" {\n     /// assert_eq!(num_leading, 16);\n     /// ```\n     #[rustc_const_stable(feature = \"const_ctlz\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn ctlz<T: Copy>(x: T) -> T;\n \n     /// Like `ctlz`, but extra-unsafe as it returns `undef` when\n@@ -1729,6 +1750,7 @@ extern \"rust-intrinsic\" {\n     /// assert_eq!(num_trailing, 16);\n     /// ```\n     #[rustc_const_stable(feature = \"const_cttz\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn cttz<T: Copy>(x: T) -> T;\n \n     /// Like `cttz`, but extra-unsafe as it returns `undef` when\n@@ -1761,6 +1783,7 @@ extern \"rust-intrinsic\" {\n     /// primitives via the `swap_bytes` method. For example,\n     /// [`u32::swap_bytes`]\n     #[rustc_const_stable(feature = \"const_bswap\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn bswap<T: Copy>(x: T) -> T;\n \n     /// Reverses the bits in an integer type `T`.\n@@ -1774,6 +1797,7 @@ extern \"rust-intrinsic\" {\n     /// primitives via the `reverse_bits` method. For example,\n     /// [`u32::reverse_bits`]\n     #[rustc_const_stable(feature = \"const_bitreverse\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn bitreverse<T: Copy>(x: T) -> T;\n \n     /// Performs checked integer addition.\n@@ -1787,6 +1811,7 @@ extern \"rust-intrinsic\" {\n     /// primitives via the `overflowing_add` method. For example,\n     /// [`u32::overflowing_add`]\n     #[rustc_const_stable(feature = \"const_int_overflow\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn add_with_overflow<T: Copy>(x: T, y: T) -> (T, bool);\n \n     /// Performs checked integer subtraction\n@@ -1800,6 +1825,7 @@ extern \"rust-intrinsic\" {\n     /// primitives via the `overflowing_sub` method. For example,\n     /// [`u32::overflowing_sub`]\n     #[rustc_const_stable(feature = \"const_int_overflow\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn sub_with_overflow<T: Copy>(x: T, y: T) -> (T, bool);\n \n     /// Performs checked integer multiplication\n@@ -1813,6 +1839,7 @@ extern \"rust-intrinsic\" {\n     /// primitives via the `overflowing_mul` method. For example,\n     /// [`u32::overflowing_mul`]\n     #[rustc_const_stable(feature = \"const_int_overflow\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn mul_with_overflow<T: Copy>(x: T, y: T) -> (T, bool);\n \n     /// Performs an exact division, resulting in undefined behavior where\n@@ -1887,6 +1914,7 @@ extern \"rust-intrinsic\" {\n     /// primitives via the `rotate_left` method. For example,\n     /// [`u32::rotate_left`]\n     #[rustc_const_stable(feature = \"const_int_rotate\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn rotate_left<T: Copy>(x: T, y: T) -> T;\n \n     /// Performs rotate right.\n@@ -1900,6 +1928,7 @@ extern \"rust-intrinsic\" {\n     /// primitives via the `rotate_right` method. For example,\n     /// [`u32::rotate_right`]\n     #[rustc_const_stable(feature = \"const_int_rotate\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn rotate_right<T: Copy>(x: T, y: T) -> T;\n \n     /// Returns (a + b) mod 2<sup>N</sup>, where N is the width of T in bits.\n@@ -1913,6 +1942,7 @@ extern \"rust-intrinsic\" {\n     /// primitives via the `wrapping_add` method. For example,\n     /// [`u32::wrapping_add`]\n     #[rustc_const_stable(feature = \"const_int_wrapping\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn wrapping_add<T: Copy>(a: T, b: T) -> T;\n     /// Returns (a - b) mod 2<sup>N</sup>, where N is the width of T in bits.\n     ///\n@@ -1925,6 +1955,7 @@ extern \"rust-intrinsic\" {\n     /// primitives via the `wrapping_sub` method. For example,\n     /// [`u32::wrapping_sub`]\n     #[rustc_const_stable(feature = \"const_int_wrapping\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn wrapping_sub<T: Copy>(a: T, b: T) -> T;\n     /// Returns (a * b) mod 2<sup>N</sup>, where N is the width of T in bits.\n     ///\n@@ -1937,6 +1968,7 @@ extern \"rust-intrinsic\" {\n     /// primitives via the `wrapping_mul` method. For example,\n     /// [`u32::wrapping_mul`]\n     #[rustc_const_stable(feature = \"const_int_wrapping\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn wrapping_mul<T: Copy>(a: T, b: T) -> T;\n \n     /// Computes `a + b`, saturating at numeric bounds.\n@@ -1950,6 +1982,7 @@ extern \"rust-intrinsic\" {\n     /// primitives via the `saturating_add` method. For example,\n     /// [`u32::saturating_add`]\n     #[rustc_const_stable(feature = \"const_int_saturating\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn saturating_add<T: Copy>(a: T, b: T) -> T;\n     /// Computes `a - b`, saturating at numeric bounds.\n     ///\n@@ -1962,6 +1995,7 @@ extern \"rust-intrinsic\" {\n     /// primitives via the `saturating_sub` method. For example,\n     /// [`u32::saturating_sub`]\n     #[rustc_const_stable(feature = \"const_int_saturating\", since = \"1.40.0\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn saturating_sub<T: Copy>(a: T, b: T) -> T;\n \n     /// Returns the value of the discriminant for the variant in 'v';\n@@ -1974,6 +2008,7 @@ extern \"rust-intrinsic\" {\n     ///\n     /// The stabilized version of this intrinsic is [`core::mem::discriminant`].\n     #[rustc_const_unstable(feature = \"const_discriminant\", issue = \"69821\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn discriminant_value<T>(v: &T) -> <T as DiscriminantKind>::Discriminant;\n \n     /// Returns the number of variants of the type `T` cast to a `usize`;\n@@ -1986,6 +2021,7 @@ extern \"rust-intrinsic\" {\n     ///\n     /// The to-be-stabilized version of this intrinsic is [`mem::variant_count`].\n     #[rustc_const_unstable(feature = \"variant_count\", issue = \"73662\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn variant_count<T>() -> usize;\n \n     /// Rust's \"try catch\" construct which invokes the function pointer `try_fn`\n@@ -2019,6 +2055,7 @@ extern \"rust-intrinsic\" {\n     /// Therefore, implementations must not require the user to uphold\n     /// any safety invariants.\n     #[rustc_const_unstable(feature = \"const_raw_ptr_comparison\", issue = \"53020\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn ptr_guaranteed_cmp<T>(ptr: *const T, other: *const T) -> u8;\n \n     /// Allocates a block of memory at compile time.\n@@ -2069,6 +2106,7 @@ extern \"rust-intrinsic\" {\n     ///\n     /// [`std::hint::black_box`]: crate::hint::black_box\n     #[rustc_const_unstable(feature = \"const_black_box\", issue = \"none\")]\n+    #[cfg_attr(not(bootstrap), rustc_safe_intrinsic)]\n     pub fn black_box<T>(dummy: T) -> T;\n \n     /// `ptr` must point to a vtable."}, {"sha": "a2ec932c124555b7abdf0876c205c47785915ab8", "filename": "src/test/ui/error-codes/E0094.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/src%2Ftest%2Fui%2Ferror-codes%2FE0094.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/src%2Ftest%2Fui%2Ferror-codes%2FE0094.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0094.rs?ref=99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94", "patch": "@@ -1,5 +1,7 @@\n #![feature(intrinsics)]\n+\n extern \"rust-intrinsic\" {\n+    #[rustc_safe_intrinsic]\n     fn size_of<T, U>() -> usize; //~ ERROR E0094\n }\n "}, {"sha": "531cd4c784d3384091fb7215c909b8eabb3efbba", "filename": "src/test/ui/error-codes/E0094.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/src%2Ftest%2Fui%2Ferror-codes%2FE0094.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/src%2Ftest%2Fui%2Ferror-codes%2FE0094.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0094.stderr?ref=99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94", "patch": "@@ -1,5 +1,5 @@\n error[E0094]: intrinsic has wrong number of type parameters: found 2, expected 1\n-  --> $DIR/E0094.rs:3:15\n+  --> $DIR/E0094.rs:5:15\n    |\n LL |     fn size_of<T, U>() -> usize;\n    |               ^^^^^^ expected 1 type parameter"}, {"sha": "a72aa4171a1030891318eb7fd59b065e099ff934", "filename": "src/test/ui/extern/extern-with-type-bounds.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/src%2Ftest%2Fui%2Fextern%2Fextern-with-type-bounds.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/src%2Ftest%2Fui%2Fextern%2Fextern-with-type-bounds.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-with-type-bounds.rs?ref=99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94", "patch": "@@ -2,6 +2,7 @@\n \n extern \"rust-intrinsic\" {\n     // Real example from libcore\n+    #[rustc_safe_intrinsic]\n     fn type_id<T: ?Sized + 'static>() -> u64;\n \n     // Silent bounds made explicit to make sure they are actually\n@@ -10,6 +11,7 @@ extern \"rust-intrinsic\" {\n \n     // Bounds aren't checked right now, so this should work\n     // even though it's incorrect.\n+    #[rustc_safe_intrinsic]\n     fn size_of<T: Clone>() -> usize;\n \n     // Unresolved bounds should still error."}, {"sha": "88be1e5dd3da02a79784ba0eb4a398543e808afb", "filename": "src/test/ui/extern/extern-with-type-bounds.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/src%2Ftest%2Fui%2Fextern%2Fextern-with-type-bounds.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/src%2Ftest%2Fui%2Fextern%2Fextern-with-type-bounds.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-with-type-bounds.stderr?ref=99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94", "patch": "@@ -1,5 +1,5 @@\n error[E0405]: cannot find trait `NoSuchTrait` in this scope\n-  --> $DIR/extern-with-type-bounds.rs:16:20\n+  --> $DIR/extern-with-type-bounds.rs:18:20\n    |\n LL |     fn align_of<T: NoSuchTrait>() -> usize;\n    |                    ^^^^^^^^^^^ not found in this scope"}, {"sha": "c8b1ff1dbce3b479d00c0e63981d18f138b6f9d9", "filename": "src/test/ui/intrinsics/intrinsic-alignment.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/src%2Ftest%2Fui%2Fintrinsics%2Fintrinsic-alignment.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/src%2Ftest%2Fui%2Fintrinsics%2Fintrinsic-alignment.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fintrinsics%2Fintrinsic-alignment.rs?ref=99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94", "patch": "@@ -6,6 +6,7 @@\n mod rusti {\n     extern \"rust-intrinsic\" {\n         pub fn pref_align_of<T>() -> usize;\n+        #[rustc_safe_intrinsic]\n         pub fn min_align_of<T>() -> usize;\n     }\n }"}, {"sha": "ee704198d193bb13713820db29838648d1f2bb92", "filename": "src/test/ui/structs-enums/rec-align-u32.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/src%2Ftest%2Fui%2Fstructs-enums%2Frec-align-u32.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/src%2Ftest%2Fui%2Fstructs-enums%2Frec-align-u32.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fstructs-enums%2Frec-align-u32.rs?ref=99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94", "patch": "@@ -10,6 +10,7 @@ use std::mem;\n mod rusti {\n     extern \"rust-intrinsic\" {\n         pub fn pref_align_of<T>() -> usize;\n+        #[rustc_safe_intrinsic]\n         pub fn min_align_of<T>() -> usize;\n     }\n }"}, {"sha": "40ede9705f115d0097f2e3cb337535261783914d", "filename": "src/test/ui/structs-enums/rec-align-u64.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/src%2Ftest%2Fui%2Fstructs-enums%2Frec-align-u64.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94/src%2Ftest%2Fui%2Fstructs-enums%2Frec-align-u64.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fstructs-enums%2Frec-align-u64.rs?ref=99d57ee23d61293bc14f6a8f0eb9ad4fe10acc94", "patch": "@@ -12,6 +12,7 @@ use std::mem;\n mod rusti {\n     extern \"rust-intrinsic\" {\n         pub fn pref_align_of<T>() -> usize;\n+        #[rustc_safe_intrinsic]\n         pub fn min_align_of<T>() -> usize;\n     }\n }"}]}