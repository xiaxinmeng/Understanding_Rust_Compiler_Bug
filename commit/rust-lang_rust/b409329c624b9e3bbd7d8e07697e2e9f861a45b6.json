{"sha": "b409329c624b9e3bbd7d8e07697e2e9f861a45b6", "node_id": "C_kwDOAAsO6NoAKGI0MDkzMjljNjI0YjllM2JiZDdkOGUwNzY5N2UyZTlmODYxYTQ1YjY", "commit": {"author": {"name": "Alan Egerton", "email": "eggyal@gmail.com", "date": "2023-02-11T10:02:18Z"}, "committer": {"name": "Alan Egerton", "email": "eggyal@gmail.com", "date": "2023-02-13T10:24:47Z"}, "message": "Workaround issue #107747\n\nOnly required until fix #107803 is merged into stage0 compiler, expected\nwhen beta 1.69.0 is released on 2023-03-09, then this commit can be\nreverted.", "tree": {"sha": "e812ce016a1aac24da5842c85712178cb3d7c2c0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e812ce016a1aac24da5842c85712178cb3d7c2c0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b409329c624b9e3bbd7d8e07697e2e9f861a45b6", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJFBAABCAAvFiEEvrRBFuOXsbT1OVTHfUwvbCISJTIFAmPqD+8RHGVnZ3lhbEBn\nbWFpbC5jb20ACgkQfUwvbCISJTKT5g//aU5yXycameGbik+uAHQNTUH0ZBKi7y4L\nwnmcUSvVmlVe7IMlryg+ASOJtj5dTgbft+//5iP6JLifAommDsaFUEEELnMSlUCm\nmCVPN98hOF4S88NHCSDSM5yPBbu4xvKp52rt0VIPXx1cL6xKNuYRMq2GX+p24JxU\nVER5YsMBEaasOFje0TjlE8uxSg3cu8B3eFZag2AxjiQPOn+101zJno38hT2u//gb\nnu4hH7wGKM8V7XDdqb2tG0GKZYLH7EFtZSJgV6MZKojaXNxDpjoMZHRhjsK5vQd+\ngBr5tLBF8oXi/8nSqn8NEnWun/1UFFVm3cJozvrFUk2S6XSTY3zcq5JUVKvOBrPI\n1jQE748SAAvBR5fbOk0nLUxrxtdmexH+ECHa50Dpy76GpiJFvUtLh3TjVJegfKWK\nIwuPOYyQJRIEaKyl1IzZI4xw7EADPPxobG11pCtfSHcTF3RVyn8L//ls0lsAVkBX\nqVrSgmzEaOLnJil/b8QGeaRKC08QJp6w+rUETfI8xcYCneno8q5m0fYyuGdON+L0\n/LHqrrT499wlh6Pi+56r+GHuPpF3tUqVSbhM4aja/gFFCGdVq277eF5f61ch1Hlz\ncqgP0qNCvpoVlNrgoR45RoOIeWAWZ50nX7D4bOcaYQnTpG/1h0kqm7W6bo9Qp1T9\nWd2/Ax46/zk=\n=UfR6\n-----END PGP SIGNATURE-----", "payload": "tree e812ce016a1aac24da5842c85712178cb3d7c2c0\nparent 36d09e3906d8c487149bbc9b101bb85322eba525\nauthor Alan Egerton <eggyal@gmail.com> 1676109738 +0000\ncommitter Alan Egerton <eggyal@gmail.com> 1676283887 +0000\n\nWorkaround issue #107747\n\nOnly required until fix #107803 is merged into stage0 compiler, expected\nwhen beta 1.69.0 is released on 2023-03-09, then this commit can be\nreverted.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b409329c624b9e3bbd7d8e07697e2e9f861a45b6", "html_url": "https://github.com/rust-lang/rust/commit/b409329c624b9e3bbd7d8e07697e2e9f861a45b6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b409329c624b9e3bbd7d8e07697e2e9f861a45b6/comments", "author": {"login": "eggyal", "id": 3089613, "node_id": "MDQ6VXNlcjMwODk2MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3089613?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eggyal", "html_url": "https://github.com/eggyal", "followers_url": "https://api.github.com/users/eggyal/followers", "following_url": "https://api.github.com/users/eggyal/following{/other_user}", "gists_url": "https://api.github.com/users/eggyal/gists{/gist_id}", "starred_url": "https://api.github.com/users/eggyal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eggyal/subscriptions", "organizations_url": "https://api.github.com/users/eggyal/orgs", "repos_url": "https://api.github.com/users/eggyal/repos", "events_url": "https://api.github.com/users/eggyal/events{/privacy}", "received_events_url": "https://api.github.com/users/eggyal/received_events", "type": "User", "site_admin": false}, "committer": {"login": "eggyal", "id": 3089613, "node_id": "MDQ6VXNlcjMwODk2MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3089613?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eggyal", "html_url": "https://github.com/eggyal", "followers_url": "https://api.github.com/users/eggyal/followers", "following_url": "https://api.github.com/users/eggyal/following{/other_user}", "gists_url": "https://api.github.com/users/eggyal/gists{/gist_id}", "starred_url": "https://api.github.com/users/eggyal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eggyal/subscriptions", "organizations_url": "https://api.github.com/users/eggyal/orgs", "repos_url": "https://api.github.com/users/eggyal/repos", "events_url": "https://api.github.com/users/eggyal/events{/privacy}", "received_events_url": "https://api.github.com/users/eggyal/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "36d09e3906d8c487149bbc9b101bb85322eba525", "url": "https://api.github.com/repos/rust-lang/rust/commits/36d09e3906d8c487149bbc9b101bb85322eba525", "html_url": "https://github.com/rust-lang/rust/commit/36d09e3906d8c487149bbc9b101bb85322eba525"}], "stats": {"total": 20, "additions": 17, "deletions": 3}, "files": [{"sha": "51760c9130869e246407b8ae10eac233619ddcdb", "filename": "compiler/rustc_hir_analysis/src/variance/mod.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b409329c624b9e3bbd7d8e07697e2e9f861a45b6/compiler%2Frustc_hir_analysis%2Fsrc%2Fvariance%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b409329c624b9e3bbd7d8e07697e2e9f861a45b6/compiler%2Frustc_hir_analysis%2Fsrc%2Fvariance%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_analysis%2Fsrc%2Fvariance%2Fmod.rs?ref=b409329c624b9e3bbd7d8e07697e2e9f861a45b6", "patch": "@@ -7,8 +7,10 @@ use rustc_arena::DroplessArena;\n use rustc_hir::def::DefKind;\n use rustc_hir::def_id::{DefId, LocalDefId};\n use rustc_middle::ty::query::Providers;\n+#[cfg(not(bootstrap))]\n+use rustc_middle::ty::TypeVisitable;\n use rustc_middle::ty::{self, CrateVariancesMap, SubstsRef, Ty, TyCtxt};\n-use rustc_middle::ty::{DefIdTree, TypeSuperVisitable, TypeVisitable};\n+use rustc_middle::ty::{DefIdTree, TypeSuperVisitable};\n use std::ops::ControlFlow;\n \n /// Defines the `TermsContext` basically houses an arena where we can"}, {"sha": "1d76f435e26d951a0211145c591acdcbd10c97a7", "filename": "compiler/rustc_middle/src/ty/layout.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/b409329c624b9e3bbd7d8e07697e2e9f861a45b6/compiler%2Frustc_middle%2Fsrc%2Fty%2Flayout.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b409329c624b9e3bbd7d8e07697e2e9f861a45b6/compiler%2Frustc_middle%2Fsrc%2Fty%2Flayout.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fty%2Flayout.rs?ref=b409329c624b9e3bbd7d8e07697e2e9f861a45b6", "patch": "@@ -1120,6 +1120,13 @@ impl From<call::AdjustForForeignAbiError> for FnAbiError<'_> {\n \n impl<'tcx> fmt::Display for FnAbiError<'tcx> {\n     fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {\n+        #[cfg(bootstrap)]\n+        match self {\n+            Self::Layout(err) => fmt::Display::fmt(err, f),\n+            Self::AdjustForForeignAbi(err) => fmt::Display::fmt(err, f),\n+        }\n+\n+        #[cfg(not(bootstrap))]\n         match self {\n             Self::Layout(err) => err.fmt(f),\n             Self::AdjustForForeignAbi(err) => err.fmt(f),"}, {"sha": "16905c2100b40120524d3fe924e04173e600e743", "filename": "compiler/rustc_middle/src/ty/opaque_types.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b409329c624b9e3bbd7d8e07697e2e9f861a45b6/compiler%2Frustc_middle%2Fsrc%2Fty%2Fopaque_types.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b409329c624b9e3bbd7d8e07697e2e9f861a45b6/compiler%2Frustc_middle%2Fsrc%2Fty%2Fopaque_types.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fty%2Fopaque_types.rs?ref=b409329c624b9e3bbd7d8e07697e2e9f861a45b6", "patch": "@@ -1,7 +1,9 @@\n use crate::error::ConstNotUsedTraitAlias;\n use crate::ty::fold::{ir::TypeFolder, TypeSuperFoldable};\n use crate::ty::subst::{GenericArg, GenericArgKind};\n-use crate::ty::{self, Ty, TyCtxt, TypeFoldable};\n+#[cfg(not(bootstrap))]\n+use crate::ty::TypeFoldable;\n+use crate::ty::{self, Ty, TyCtxt};\n use rustc_data_structures::fx::FxHashMap;\n use rustc_span::def_id::DefId;\n use rustc_span::Span;"}, {"sha": "b10b35b77d47107e31250e97e0878b92f81a0295", "filename": "compiler/rustc_trait_selection/src/traits/auto_trait.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b409329c624b9e3bbd7d8e07697e2e9f861a45b6/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fauto_trait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b409329c624b9e3bbd7d8e07697e2e9f861a45b6/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fauto_trait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fauto_trait.rs?ref=b409329c624b9e3bbd7d8e07697e2e9f861a45b6", "patch": "@@ -9,6 +9,7 @@ use crate::infer::InferCtxt;\n use crate::traits::project::ProjectAndUnifyResult;\n use rustc_middle::mir::interpret::ErrorHandled;\n use rustc_middle::ty::fold::{ir::TypeFolder, TypeSuperFoldable};\n+#[cfg(not(bootstrap))]\n use rustc_middle::ty::visit::TypeVisitable;\n use rustc_middle::ty::{ImplPolarity, Region, RegionVid};\n "}, {"sha": "7be749c55d98e91340e16a5d67faad23435a792b", "filename": "compiler/rustc_trait_selection/src/traits/structural_match.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b409329c624b9e3bbd7d8e07697e2e9f861a45b6/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fstructural_match.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b409329c624b9e3bbd7d8e07697e2e9f861a45b6/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fstructural_match.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fstructural_match.rs?ref=b409329c624b9e3bbd7d8e07697e2e9f861a45b6", "patch": "@@ -1,6 +1,8 @@\n use rustc_data_structures::fx::FxHashSet;\n use rustc_hir as hir;\n-use rustc_middle::ty::{self, ir::TypeVisitor, Ty, TyCtxt, TypeSuperVisitable, TypeVisitable};\n+#[cfg(not(bootstrap))]\n+use rustc_middle::ty::TypeVisitable;\n+use rustc_middle::ty::{self, ir::TypeVisitor, Ty, TyCtxt, TypeSuperVisitable};\n use rustc_span::Span;\n use std::ops::ControlFlow;\n "}]}