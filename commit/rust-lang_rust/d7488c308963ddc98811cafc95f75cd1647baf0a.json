{"sha": "d7488c308963ddc98811cafc95f75cd1647baf0a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ3NDg4YzMwODk2M2RkYzk4ODExY2FmYzk1Zjc1Y2QxNjQ3YmFmMGE=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2017-12-07T08:37:06Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2017-12-26T16:00:45Z"}, "message": "Update CONTRIBUTING.md now that toolstate.toml is gone.", "tree": {"sha": "463ae676143e4f93b3bef49ccf37f20b7f8b1da2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/463ae676143e4f93b3bef49ccf37f20b7f8b1da2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d7488c308963ddc98811cafc95f75cd1647baf0a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlpCci0ACgkQ/vbIBR0O\nATxpAw/+LrvhvPsoFkUqVSNIvghCynJzTbOfyIMy+m74CrXttpZuMXK1v8c+0hwm\n4ZeTYc/PJ6/4V0vVampqgQ4oSdd4fR7O/UOU08f2avojbA+OUdUPAoud69XIcxZH\nSmaaoB5WtQkgTXNs21qw0mE55779KcK/zBYw2HsFB6woWTQWEA8tb8v8814Q41t5\nLtIpAUUGFkpch6msSogH+205KTEXAkfQX52aNy4eMvPBcL1JeMQqPZBjfikYzXaL\ncnBPpw7X0XES2j4gAN9ZDnT9R471pS2iZxDcw+S+Y3Xq50vBuNI4HX3THATK+7Fj\nGryblbOqxvliY1OjVPofvFPtQuq0t1V4T7wgIrL58arS0CkOgvk+jwHZhjQHLayD\n8DUjE3H/9Ex1vn0btTXbenCsxzOpM1S2pKex9Vsl4P61v+be0GGHAY6FbGIqtW/U\nrXwyo9qcu2DIVWFNq1SrUd5fRyyObRQldLbOMJGm7hFCKsR9rnpcPAd2e1a9oNIo\nB96tqN2HvQUkqYfM9r8KaYpkYM9K28PFYBD3e5KvhRqIU9qugFKX7PZQuyK+TlNY\n6sDMpLCHh4G7b02TYV0mgJ8I5VNBuBxB2If7H1Xx0xTnd+VXfc70a1f22qWiJExT\ns46kTk7luuGhvgmJqCCsImTCDGySNflJjGtijeIM7OcKq5z0sb8=\n=ylOW\n-----END PGP SIGNATURE-----", "payload": "tree 463ae676143e4f93b3bef49ccf37f20b7f8b1da2\nparent 2566fa25c7fefbd61e4251bda4407747a3023891\nauthor kennytm <kennytm@gmail.com> 1512635826 +0800\ncommitter kennytm <kennytm@gmail.com> 1514304045 +0800\n\nUpdate CONTRIBUTING.md now that toolstate.toml is gone.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d7488c308963ddc98811cafc95f75cd1647baf0a", "html_url": "https://github.com/rust-lang/rust/commit/d7488c308963ddc98811cafc95f75cd1647baf0a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d7488c308963ddc98811cafc95f75cd1647baf0a/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2566fa25c7fefbd61e4251bda4407747a3023891", "url": "https://api.github.com/repos/rust-lang/rust/commits/2566fa25c7fefbd61e4251bda4407747a3023891", "html_url": "https://github.com/rust-lang/rust/commit/2566fa25c7fefbd61e4251bda4407747a3023891"}], "stats": {"total": 40, "additions": 19, "deletions": 21}, "files": [{"sha": "54c507304f9f112493d9ea399fdf042de499f5aa", "filename": "CONTRIBUTING.md", "status": "modified", "additions": 19, "deletions": 21, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/d7488c308963ddc98811cafc95f75cd1647baf0a/CONTRIBUTING.md", "raw_url": "https://github.com/rust-lang/rust/raw/d7488c308963ddc98811cafc95f75cd1647baf0a/CONTRIBUTING.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/CONTRIBUTING.md?ref=d7488c308963ddc98811cafc95f75cd1647baf0a", "patch": "@@ -369,26 +369,29 @@ Currently building Rust will also build the following external projects:\n \n * [clippy](https://github.com/rust-lang-nursery/rust-clippy)\n * [miri](https://github.com/solson/miri)\n+* [rustfmt](https://github.com/rust-lang-nursery/rustfmt)\n+* [rls](https://github.com/rust-lang-nursery/rls/)\n \n-If your changes break one of these projects, you need to fix them by opening\n-a pull request against the broken project asking to put the fix on a branch.\n-Then you can disable the tool building via `src/tools/toolstate.toml`.\n-Once the branch containing your fix is likely to be merged, you can point\n-the affected submodule at this branch.\n+We allow breakage of these tools in the nightly channel. Maintainers of these\n+projects will be notified of the breakages and should fix them as soon as\n+possible.\n \n-Don't forget to also add your changes with\n+After the external is fixed, one could add the changes with\n \n-```\n+```sh\n git add path/to/submodule\n ```\n \n outside the submodule.\n \n-In order to prepare your PR, you can run the build locally by doing\n+In order to prepare your tool-fixing PR, you can run the build locally by doing\n `./x.py build src/tools/TOOL`. If you will be editing the sources\n there, you may wish to set `submodules = false` in the `config.toml`\n to prevent `x.py` from resetting to the original branch.\n \n+Breakage is not allowed in the beta and stable channels, and must be addressed\n+before the PR is merged.\n+\n #### Breaking Tools Built With The Compiler\n [breaking-tools-built-with-the-compiler]: #breaking-tools-built-with-the-compiler\n \n@@ -406,12 +409,12 @@ tests.\n That means that, in the default state, you can't update the compiler without first\n fixing rustfmt, rls and the other tools that the compiler builds.\n \n-Luckily, a feature was [added to Rust's build](https://github.com/rust-lang/rust/pull/45243)\n-to make all of this easy to handle. The idea is that you mark the tools as \"broken\",\n+Luckily, a feature was [added to Rust's build](https://github.com/rust-lang/rust/issues/45861)\n+to make all of this easy to handle. The idea is that we allow these tools to be \"broken\",\n so that the rust-lang/rust build passes without trying to build them, then land the change\n in the compiler, wait for a nightly, and go update the tools that you broke. Once you're done\n-and the tools are working again, you go back in the compiler and change the tools back\n-from \"broken\".\n+and the tools are working again, you go back in the compiler and update the tools\n+so they can be distributed again.\n \n This should avoid a bunch of synchronization dances and is also much easier on contributors as\n there's no need to block on rls/rustfmt/other tools changes going upstream.\n@@ -430,15 +433,10 @@ Here are those same steps in detail:\n 4. (optional) Maintainers of these submodules will **not** merge the PR. The PR can't be\n    merged because CI will be broken. You'll want to write a message on the PR referencing\n    your change, and how the PR should be merged once your change makes it into a nightly.\n-5. Update `src/tools/toolstate.toml` to indicate that the tool in question is \"broken\",\n-   that will disable building it on CI. See the documentation in that file for the exact\n-   configuration values you can use.\n-6. Commit the changes to `src/tools/toolstate.toml`, **do not update submodules in your commit**,\n-   and then update the PR you have for rust-lang/rust.\n-7. Wait for your PR to merge.\n-8. Wait for a nightly\n-9. (optional) Help land your PR on the upstream repository now that your changes are in nightly.\n-10. (optional) Send a PR to rust-lang/rust updating the submodule, reverting `src/tools/toolstate.toml` back to a \"building\" or \"testing\" state.\n+5. Wait for your PR to merge.\n+6. Wait for a nightly\n+7. (optional) Help land your PR on the upstream repository now that your changes are in nightly.\n+8. (optional) Send a PR to rust-lang/rust updating the submodule.\n \n #### Updating submodules\n [updating-submodules]: #updating-submodules"}]}