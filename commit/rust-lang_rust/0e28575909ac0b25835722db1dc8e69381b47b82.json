{"sha": "0e28575909ac0b25835722db1dc8e69381b47b82", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBlMjg1NzU5MDlhYzBiMjU4MzU3MjJkYjFkYzhlNjkzODFiNDdiODI=", "commit": {"author": {"name": "Ryan Levick", "email": "me@ryanlevick.com", "date": "2021-06-24T14:29:03Z"}, "committer": {"name": "Ryan Levick", "email": "me@ryanlevick.com", "date": "2021-06-28T14:40:46Z"}, "message": "Only include lint in future_incompatible lint group if not an edition lint", "tree": {"sha": "bad6bbc03752d334769e260cc1f252b065b1b277", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bad6bbc03752d334769e260cc1f252b065b1b277"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0e28575909ac0b25835722db1dc8e69381b47b82", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0e28575909ac0b25835722db1dc8e69381b47b82", "html_url": "https://github.com/rust-lang/rust/commit/0e28575909ac0b25835722db1dc8e69381b47b82", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0e28575909ac0b25835722db1dc8e69381b47b82/comments", "author": {"login": "rylev", "id": 1327285, "node_id": "MDQ6VXNlcjEzMjcyODU=", "avatar_url": "https://avatars.githubusercontent.com/u/1327285?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rylev", "html_url": "https://github.com/rylev", "followers_url": "https://api.github.com/users/rylev/followers", "following_url": "https://api.github.com/users/rylev/following{/other_user}", "gists_url": "https://api.github.com/users/rylev/gists{/gist_id}", "starred_url": "https://api.github.com/users/rylev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rylev/subscriptions", "organizations_url": "https://api.github.com/users/rylev/orgs", "repos_url": "https://api.github.com/users/rylev/repos", "events_url": "https://api.github.com/users/rylev/events{/privacy}", "received_events_url": "https://api.github.com/users/rylev/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rylev", "id": 1327285, "node_id": "MDQ6VXNlcjEzMjcyODU=", "avatar_url": "https://avatars.githubusercontent.com/u/1327285?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rylev", "html_url": "https://github.com/rylev", "followers_url": "https://api.github.com/users/rylev/followers", "following_url": "https://api.github.com/users/rylev/following{/other_user}", "gists_url": "https://api.github.com/users/rylev/gists{/gist_id}", "starred_url": "https://api.github.com/users/rylev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rylev/subscriptions", "organizations_url": "https://api.github.com/users/rylev/orgs", "repos_url": "https://api.github.com/users/rylev/repos", "events_url": "https://api.github.com/users/rylev/events{/privacy}", "received_events_url": "https://api.github.com/users/rylev/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "451e98e7b02c8bf5e3bd5c9e780d51f7986a4408", "url": "https://api.github.com/repos/rust-lang/rust/commits/451e98e7b02c8bf5e3bd5c9e780d51f7986a4408", "html_url": "https://github.com/rust-lang/rust/commit/451e98e7b02c8bf5e3bd5c9e780d51f7986a4408"}], "stats": {"total": 59, "additions": 40, "deletions": 19}, "files": [{"sha": "acb051e0b18a23163167f3885a5920d681472ce9", "filename": "compiler/rustc_lint/src/context.rs", "status": "modified", "additions": 10, "deletions": 10, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/0e28575909ac0b25835722db1dc8e69381b47b82/compiler%2Frustc_lint%2Fsrc%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0e28575909ac0b25835722db1dc8e69381b47b82/compiler%2Frustc_lint%2Fsrc%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Fcontext.rs?ref=0e28575909ac0b25835722db1dc8e69381b47b82", "patch": "@@ -220,17 +220,17 @@ impl LintStore {\n                         })\n                         .lint_ids\n                         .push(id);\n+                } else {\n+                    self.lint_groups\n+                        .entry(\"future_incompatible\")\n+                        .or_insert(LintGroup {\n+                            lint_ids: vec![],\n+                            from_plugin: lint.is_plugin,\n+                            depr: None,\n+                        })\n+                        .lint_ids\n+                        .push(id);\n                 }\n-\n-                self.lint_groups\n-                    .entry(\"future_incompatible\")\n-                    .or_insert(LintGroup {\n-                        lint_ids: vec![],\n-                        from_plugin: lint.is_plugin,\n-                        depr: None,\n-                    })\n-                    .lint_ids\n-                    .push(id);\n             }\n         }\n     }"}, {"sha": "bbd0e33d7193e9081fd0df6b99515a86f47b6e22", "filename": "src/test/ui/future-incompatible-lint-group.rs", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/0e28575909ac0b25835722db1dc8e69381b47b82/src%2Ftest%2Fui%2Ffuture-incompatible-lint-group.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0e28575909ac0b25835722db1dc8e69381b47b82/src%2Ftest%2Fui%2Ffuture-incompatible-lint-group.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffuture-incompatible-lint-group.rs?ref=0e28575909ac0b25835722db1dc8e69381b47b82", "patch": "@@ -1,8 +1,18 @@\n+// Ensure that the future_incompatible lint group only includes\n+// lints for changes that are not tied to an edition\n #![deny(future_incompatible)]\n \n trait Tr {\n-    fn f(u8) {} //~ ERROR anonymous parameters are deprecated\n-                //~^ WARN this is accepted in the current edition\n+    // Warn only since this is not a `future_incompatible` lint\n+    fn f(u8) {} //~ WARN anonymous parameters are deprecated\n+                //~| WARN this is accepted in the current edition\n+}\n+\n+pub mod submodule {\n+    // Error since this is a `future_incompatible` lint\n+    #![doc(test(some_test))]\n+        //~^ ERROR this attribute can only be applied at the crate level\n+        //~| WARN this was previously accepted by the compiler\n }\n \n fn main() {}"}, {"sha": "cb9be88c9ee44f43a14e63f267f545fbf9588f95", "filename": "src/test/ui/future-incompatible-lint-group.stderr", "status": "modified", "additions": 18, "deletions": 7, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/0e28575909ac0b25835722db1dc8e69381b47b82/src%2Ftest%2Fui%2Ffuture-incompatible-lint-group.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0e28575909ac0b25835722db1dc8e69381b47b82/src%2Ftest%2Fui%2Ffuture-incompatible-lint-group.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffuture-incompatible-lint-group.stderr?ref=0e28575909ac0b25835722db1dc8e69381b47b82", "patch": "@@ -1,17 +1,28 @@\n-error: anonymous parameters are deprecated and will be removed in the next edition.\n-  --> $DIR/future-incompatible-lint-group.rs:4:10\n+warning: anonymous parameters are deprecated and will be removed in the next edition.\n+  --> $DIR/future-incompatible-lint-group.rs:7:10\n    |\n LL |     fn f(u8) {}\n    |          ^^ help: try naming the parameter or explicitly ignoring it: `_: u8`\n    |\n+   = note: `#[warn(anonymous_parameters)]` on by default\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2018!\n+   = note: for more information, see issue #41686 <https://github.com/rust-lang/rust/issues/41686>\n+\n+error: this attribute can only be applied at the crate level\n+  --> $DIR/future-incompatible-lint-group.rs:13:12\n+   |\n+LL |     #![doc(test(some_test))]\n+   |            ^^^^^^^^^^^^^^^\n+   |\n note: the lint level is defined here\n-  --> $DIR/future-incompatible-lint-group.rs:1:9\n+  --> $DIR/future-incompatible-lint-group.rs:3:9\n    |\n LL | #![deny(future_incompatible)]\n    |         ^^^^^^^^^^^^^^^^^^^\n-   = note: `#[deny(anonymous_parameters)]` implied by `#[deny(future_incompatible)]`\n-   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2018!\n-   = note: for more information, see issue #41686 <https://github.com/rust-lang/rust/issues/41686>\n+   = note: `#[deny(invalid_doc_attributes)]` implied by `#[deny(future_incompatible)]`\n+   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n+   = note: for more information, see issue #82730 <https://github.com/rust-lang/rust/issues/82730>\n+   = note: read https://doc.rust-lang.org/nightly/rustdoc/the-doc-attribute.html#at-the-crate-level for more information\n \n-error: aborting due to previous error\n+error: aborting due to previous error; 1 warning emitted\n "}]}