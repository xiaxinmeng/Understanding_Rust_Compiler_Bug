{"sha": "134b61a317ebcb3d2ac7d7a4539dc10483852194", "node_id": "MDY6Q29tbWl0NzI0NzEyOjEzNGI2MWEzMTdlYmNiM2QyYWM3ZDdhNDUzOWRjMTA0ODM4NTIxOTQ=", "commit": {"author": {"name": "Erick Tryzelaar", "email": "erick.tryzelaar@gmail.com", "date": "2011-05-19T02:32:18Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-05-20T19:32:44Z"}, "message": "Use CFG_LLVM_ROOT's llvm-config if it exists.\n\nOn some platform (OS X), llvm needs macros like\n__STDC_LIMIT_MACROS defined in order to work, which is\nnormally defined in llvm-config. This patch modifies\nthe config to use CFG_LLVM_ROOT's llvm-config if it\nexists, which fixes the compile failures.", "tree": {"sha": "4b458b8616e5f15606f1123468aa224227c0b9ea", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4b458b8616e5f15606f1123468aa224227c0b9ea"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/134b61a317ebcb3d2ac7d7a4539dc10483852194", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/134b61a317ebcb3d2ac7d7a4539dc10483852194", "html_url": "https://github.com/rust-lang/rust/commit/134b61a317ebcb3d2ac7d7a4539dc10483852194", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/134b61a317ebcb3d2ac7d7a4539dc10483852194/comments", "author": {"login": "erickt", "id": 84711, "node_id": "MDQ6VXNlcjg0NzEx", "avatar_url": "https://avatars.githubusercontent.com/u/84711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/erickt", "html_url": "https://github.com/erickt", "followers_url": "https://api.github.com/users/erickt/followers", "following_url": "https://api.github.com/users/erickt/following{/other_user}", "gists_url": "https://api.github.com/users/erickt/gists{/gist_id}", "starred_url": "https://api.github.com/users/erickt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/erickt/subscriptions", "organizations_url": "https://api.github.com/users/erickt/orgs", "repos_url": "https://api.github.com/users/erickt/repos", "events_url": "https://api.github.com/users/erickt/events{/privacy}", "received_events_url": "https://api.github.com/users/erickt/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b6d2fe4d74387799adc25718dae36223c975f644", "url": "https://api.github.com/repos/rust-lang/rust/commits/b6d2fe4d74387799adc25718dae36223c975f644", "html_url": "https://github.com/rust-lang/rust/commit/b6d2fe4d74387799adc25718dae36223c975f644"}], "stats": {"total": 23, "additions": 14, "deletions": 9}, "files": [{"sha": "f9045950032e72324934a597f46072ae92fb53c0", "filename": "configure", "status": "modified", "additions": 14, "deletions": 9, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/134b61a317ebcb3d2ac7d7a4539dc10483852194/configure", "raw_url": "https://github.com/rust-lang/rust/raw/134b61a317ebcb3d2ac7d7a4539dc10483852194/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=134b61a317ebcb3d2ac7d7a4539dc10483852194", "patch": "@@ -226,7 +226,12 @@ then\n     putvar CFG_BAD_VALGRIND\n fi\n \n-if [ ! -z \"$CFG_LLVM_ROOT\" ]\n+if [ ! -z \"$CFG_LLVM_ROOT\" -a -e \"$CFG_LLVM_ROOT/bin/llvm-config\" ]\n+then\n+    CFG_LLVM_CONFIG=\"$CFG_LLVM_ROOT/bin/llvm-config\"\n+fi\n+\n+if [ ! -z \"$CFG_LLVM_ROOT\" -a -z \"$CFG_LLVM_CONFIG\" ]\n then\n     CFG_LLVM_INCDIR=\"$CFG_LLVM_ROOT/include\"\n     CFG_LLVM_BINDIR=\"$CFG_LLVM_ROOT/bin\"\n@@ -247,14 +252,14 @@ then\n                       | cut -d ' ' -f 4-)\n elif [ ! -z \"$CFG_LLVM_CONFIG\" ]\n then\n-    CFG_LLVM_VERSION=$(llvm-config --version)\n-    CFG_LLVM_INCDIR=$(llvm-config --includedir)\n-    CFG_LLVM_BINDIR=$(llvm-config --bindir)\n-    CFG_LLVM_LIBDIR=$(llvm-config --libdir)\n-    CFG_LLVM_CXXFLAGS=$(llvm-config --cxxflags)\n-    CFG_LLVM_LDFLAGS=$(llvm-config --ldflags)\n-    CFG_LLVM_LIBS=$(llvm-config --libs)\n-    CFG_LLVM_TRIPLE=$(llvm-config --host-target)\n+    CFG_LLVM_VERSION=$($CFG_LLVM_CONFIG --version)\n+    CFG_LLVM_INCDIR=$($CFG_LLVM_CONFIG --includedir)\n+    CFG_LLVM_BINDIR=$($CFG_LLVM_CONFIG --bindir)\n+    CFG_LLVM_LIBDIR=$($CFG_LLVM_CONFIG --libdir)\n+    CFG_LLVM_CXXFLAGS=$($CFG_LLVM_CONFIG --cxxflags)\n+    CFG_LLVM_LDFLAGS=$($CFG_LLVM_CONFIG --ldflags)\n+    CFG_LLVM_LIBS=$($CFG_LLVM_CONFIG --libs)\n+    CFG_LLVM_TRIPLE=$($CFG_LLVM_CONFIG --host-target)\n else\n     err \"either the \\\"CFG_LLVM_ROOT\\\" environment variable must be set, or a \\\n \\\"llvm-config\\\" script must be present\""}]}