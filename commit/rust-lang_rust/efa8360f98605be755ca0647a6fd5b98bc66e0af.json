{"sha": "efa8360f98605be755ca0647a6fd5b98bc66e0af", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVmYTgzNjBmOTg2MDViZTc1NWNhMDY0N2E2ZmQ1Yjk4YmM2NmUwYWY=", "commit": {"author": {"name": "Barosl LEE", "email": "github@barosl.com", "date": "2015-01-20T17:16:47Z"}, "committer": {"name": "Barosl LEE", "email": "github@barosl.com", "date": "2015-01-20T17:16:47Z"}, "message": "Rollup merge of #21331 - michaelsproul:sync-error-impls, r=alexcrichton\n\nTwo errors in `std::sync` are currently missing implementations of the standard error trait because they contain types which aren't `Send`.\r\n\r\nThis PR therefore requires #21312.", "tree": {"sha": "71bf49c39aca8aa8698a7c77daabc1cc16bc1646", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/71bf49c39aca8aa8698a7c77daabc1cc16bc1646"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/efa8360f98605be755ca0647a6fd5b98bc66e0af", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/efa8360f98605be755ca0647a6fd5b98bc66e0af", "html_url": "https://github.com/rust-lang/rust/commit/efa8360f98605be755ca0647a6fd5b98bc66e0af", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/efa8360f98605be755ca0647a6fd5b98bc66e0af/comments", "author": {"login": "barosl", "id": 573768, "node_id": "MDQ6VXNlcjU3Mzc2OA==", "avatar_url": "https://avatars.githubusercontent.com/u/573768?v=4", "gravatar_id": "", "url": "https://api.github.com/users/barosl", "html_url": "https://github.com/barosl", "followers_url": "https://api.github.com/users/barosl/followers", "following_url": "https://api.github.com/users/barosl/following{/other_user}", "gists_url": "https://api.github.com/users/barosl/gists{/gist_id}", "starred_url": "https://api.github.com/users/barosl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/barosl/subscriptions", "organizations_url": "https://api.github.com/users/barosl/orgs", "repos_url": "https://api.github.com/users/barosl/repos", "events_url": "https://api.github.com/users/barosl/events{/privacy}", "received_events_url": "https://api.github.com/users/barosl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "barosl", "id": 573768, "node_id": "MDQ6VXNlcjU3Mzc2OA==", "avatar_url": "https://avatars.githubusercontent.com/u/573768?v=4", "gravatar_id": "", "url": "https://api.github.com/users/barosl", "html_url": "https://github.com/barosl", "followers_url": "https://api.github.com/users/barosl/followers", "following_url": "https://api.github.com/users/barosl/following{/other_user}", "gists_url": "https://api.github.com/users/barosl/gists{/gist_id}", "starred_url": "https://api.github.com/users/barosl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/barosl/subscriptions", "organizations_url": "https://api.github.com/users/barosl/orgs", "repos_url": "https://api.github.com/users/barosl/repos", "events_url": "https://api.github.com/users/barosl/events{/privacy}", "received_events_url": "https://api.github.com/users/barosl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b3f6e82beb507eeff94e988308f77224bbfb56f4", "url": "https://api.github.com/repos/rust-lang/rust/commits/b3f6e82beb507eeff94e988308f77224bbfb56f4", "html_url": "https://github.com/rust-lang/rust/commit/b3f6e82beb507eeff94e988308f77224bbfb56f4"}, {"sha": "ffdf1118d5f86b4d55cbf8ec86aa488d9dfc88b2", "url": "https://api.github.com/repos/rust-lang/rust/commits/ffdf1118d5f86b4d55cbf8ec86aa488d9dfc88b2", "html_url": "https://github.com/rust-lang/rust/commit/ffdf1118d5f86b4d55cbf8ec86aa488d9dfc88b2"}], "stats": {"total": 29, "additions": 23, "deletions": 6}, "files": [{"sha": "e28c3c37b6f765ee7df620998bd0359b5c04f4fe", "filename": "src/libstd/sync/poison.rs", "status": "modified", "additions": 23, "deletions": 6, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/efa8360f98605be755ca0647a6fd5b98bc66e0af/src%2Flibstd%2Fsync%2Fpoison.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efa8360f98605be755ca0647a6fd5b98bc66e0af/src%2Flibstd%2Fsync%2Fpoison.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsync%2Fpoison.rs?ref=efa8360f98605be755ca0647a6fd5b98bc66e0af", "patch": "@@ -11,7 +11,7 @@\n use prelude::v1::*;\n \n use cell::UnsafeCell;\n-use error::FromError;\n+use error::{Error, FromError};\n use fmt;\n use thread::Thread;\n \n@@ -92,7 +92,13 @@ pub type TryLockResult<Guard> = Result<Guard, TryLockError<Guard>>;\n \n impl<T> fmt::Show for PoisonError<T> {\n     fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {\n-        \"poisoned lock: another task failed inside\".fmt(f)\n+        self.description().fmt(f)\n+    }\n+}\n+\n+impl<T> Error for PoisonError<T> {\n+    fn description(&self) -> &str {\n+        \"poisoned lock: another task failed inside\"\n     }\n }\n \n@@ -126,11 +132,22 @@ impl<T> FromError<PoisonError<T>> for TryLockError<T> {\n \n impl<T> fmt::Show for TryLockError<T> {\n     fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {\n+        self.description().fmt(f)\n+    }\n+}\n+\n+impl<T> Error for TryLockError<T> {\n+    fn description(&self) -> &str {\n+        match *self {\n+            TryLockError::Poisoned(ref p) => p.description(),\n+            TryLockError::WouldBlock => \"try_lock failed because the operation would block\"\n+        }\n+    }\n+\n+    fn cause(&self) -> Option<&Error> {\n         match *self {\n-            TryLockError::Poisoned(ref p) => p.fmt(f),\n-            TryLockError::WouldBlock => {\n-                \"try_lock failed because the operation would block\".fmt(f)\n-            }\n+            TryLockError::Poisoned(ref p) => Some(p),\n+            _ => None\n         }\n     }\n }"}]}