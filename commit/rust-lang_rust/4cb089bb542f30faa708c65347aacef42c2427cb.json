{"sha": "4cb089bb542f30faa708c65347aacef42c2427cb", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRjYjA4OWJiNTQyZjMwZmFhNzA4YzY1MzQ3YWFjZWY0MmMyNDI3Y2I=", "commit": {"author": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2020-04-23T18:15:04Z"}, "committer": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2021-02-11T03:10:14Z"}, "message": "Inherit `#[stable(..)]` annotations in enum variants and fields from its item", "tree": {"sha": "43ce41b66bc415d9672932ada7144a90e618172f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/43ce41b66bc415d9672932ada7144a90e618172f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4cb089bb542f30faa708c65347aacef42c2427cb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4cb089bb542f30faa708c65347aacef42c2427cb", "html_url": "https://github.com/rust-lang/rust/commit/4cb089bb542f30faa708c65347aacef42c2427cb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4cb089bb542f30faa708c65347aacef42c2427cb/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "178108bf81606a0e25b1066568c2b8c8e0648617", "url": "https://api.github.com/repos/rust-lang/rust/commits/178108bf81606a0e25b1066568c2b8c8e0648617", "html_url": "https://github.com/rust-lang/rust/commit/178108bf81606a0e25b1066568c2b8c8e0648617"}], "stats": {"total": 364, "additions": 207, "deletions": 157}, "files": [{"sha": "02b20e45d000c43c340eee99a6aacaac1c054c84", "filename": "compiler/rustc_passes/src/lib_features.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4cb089bb542f30faa708c65347aacef42c2427cb/compiler%2Frustc_passes%2Fsrc%2Flib_features.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4cb089bb542f30faa708c65347aacef42c2427cb/compiler%2Frustc_passes%2Fsrc%2Flib_features.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Flib_features.rs?ref=4cb089bb542f30faa708c65347aacef42c2427cb", "patch": "@@ -109,7 +109,7 @@ impl LibFeatureCollector<'tcx> {\n     }\n \n     fn span_feature_error(&self, span: Span, msg: &str) {\n-        struct_span_err!(self.tcx.sess, span, E0711, \"{}\", &msg,).emit();\n+        struct_span_err!(self.tcx.sess, span, E0711, \"{}\", &msg).emit();\n     }\n }\n "}, {"sha": "0e142665911dab3dc023bfb8f1d1abf8d1f1b730", "filename": "compiler/rustc_passes/src/stability.rs", "status": "modified", "additions": 37, "deletions": 11, "changes": 48, "blob_url": "https://github.com/rust-lang/rust/blob/4cb089bb542f30faa708c65347aacef42c2427cb/compiler%2Frustc_passes%2Fsrc%2Fstability.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4cb089bb542f30faa708c65347aacef42c2427cb/compiler%2Frustc_passes%2Fsrc%2Fstability.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Fstability.rs?ref=4cb089bb542f30faa708c65347aacef42c2427cb", "patch": "@@ -70,6 +70,17 @@ impl InheritConstStability {\n     }\n }\n \n+enum InheritStability {\n+    Yes,\n+    No,\n+}\n+\n+impl InheritStability {\n+    fn yes(&self) -> bool {\n+        matches!(self, InheritStability::Yes)\n+    }\n+}\n+\n // A private tree-walker for producing an Index.\n struct Annotator<'a, 'tcx> {\n     tcx: TyCtxt<'tcx>,\n@@ -91,6 +102,7 @@ impl<'a, 'tcx> Annotator<'a, 'tcx> {\n         kind: AnnotationKind,\n         inherit_deprecation: InheritDeprecation,\n         inherit_const_stability: InheritConstStability,\n+        inherit_from_parent: InheritStability,\n         visit_children: F,\n     ) where\n         F: FnOnce(&mut Self),\n@@ -131,12 +143,13 @@ impl<'a, 'tcx> Annotator<'a, 'tcx> {\n         }\n \n         if self.tcx.features().staged_api {\n-            if let Some(..) = attrs.iter().find(|a| self.tcx.sess.check_name(a, sym::deprecated)) {\n-                self.tcx.sess.span_err(\n-                    item_sp,\n-                    \"`#[deprecated]` cannot be used in staged API; \\\n-                                                use `#[rustc_deprecated]` instead\",\n-                );\n+            if let Some(a) = attrs.iter().find(|a| self.tcx.sess.check_name(a, sym::deprecated)) {\n+                self.tcx\n+                    .sess\n+                    .struct_span_err(a.span, \"`#[deprecated]` cannot be used in staged API\")\n+                    .span_label(a.span, \"use `#[rustc_deprecated]` instead\")\n+                    .span_label(item_sp, \"\")\n+                    .emit();\n             }\n         } else {\n             self.recurse_with_stability_attrs(\n@@ -185,7 +198,7 @@ impl<'a, 'tcx> Annotator<'a, 'tcx> {\n             if kind == AnnotationKind::Prohibited\n                 || (kind == AnnotationKind::Container && stab.level.is_stable() && is_deprecated)\n             {\n-                self.tcx.sess.span_err(item_sp, \"This stability annotation is useless\");\n+                self.tcx.sess.span_err(item_sp, \"this stability annotation is useless\");\n             }\n \n             debug!(\"annotate: found {:?}\", stab);\n@@ -202,15 +215,15 @@ impl<'a, 'tcx> Annotator<'a, 'tcx> {\n                 {\n                     match stab_v.parse::<u64>() {\n                         Err(_) => {\n-                            self.tcx.sess.span_err(item_sp, \"Invalid stability version found\");\n+                            self.tcx.sess.span_err(item_sp, \"invalid stability version found\");\n                             break;\n                         }\n                         Ok(stab_vp) => match dep_v.parse::<u64>() {\n                             Ok(dep_vp) => match dep_vp.cmp(&stab_vp) {\n                                 Ordering::Less => {\n                                     self.tcx.sess.span_err(\n                                         item_sp,\n-                                        \"An API can't be stabilized after it is deprecated\",\n+                                        \"an API can't be stabilized after it is deprecated\",\n                                     );\n                                     break;\n                                 }\n@@ -221,7 +234,7 @@ impl<'a, 'tcx> Annotator<'a, 'tcx> {\n                                 if dep_v != \"TBD\" {\n                                     self.tcx\n                                         .sess\n-                                        .span_err(item_sp, \"Invalid deprecation version found\");\n+                                        .span_err(item_sp, \"invalid deprecation version found\");\n                                 }\n                                 break;\n                             }\n@@ -237,7 +250,9 @@ impl<'a, 'tcx> Annotator<'a, 'tcx> {\n         if stab.is_none() {\n             debug!(\"annotate: stab not found, parent = {:?}\", self.parent_stab);\n             if let Some(stab) = self.parent_stab {\n-                if inherit_deprecation.yes() && stab.level.is_unstable() {\n+                if inherit_deprecation.yes() && stab.level.is_unstable()\n+                    || inherit_from_parent.yes()\n+                {\n                     self.index.stab_map.insert(hir_id, stab);\n                 }\n             }\n@@ -368,6 +383,7 @@ impl<'a, 'tcx> Visitor<'tcx> for Annotator<'a, 'tcx> {\n                         AnnotationKind::Required,\n                         InheritDeprecation::Yes,\n                         InheritConstStability::No,\n+                        InheritStability::Yes,\n                         |_| {},\n                     )\n                 }\n@@ -382,6 +398,7 @@ impl<'a, 'tcx> Visitor<'tcx> for Annotator<'a, 'tcx> {\n             kind,\n             InheritDeprecation::Yes,\n             const_stab_inherit,\n+            InheritStability::No,\n             |v| intravisit::walk_item(v, i),\n         );\n         self.in_trait_impl = orig_in_trait_impl;\n@@ -395,6 +412,7 @@ impl<'a, 'tcx> Visitor<'tcx> for Annotator<'a, 'tcx> {\n             AnnotationKind::Required,\n             InheritDeprecation::Yes,\n             InheritConstStability::No,\n+            InheritStability::No,\n             |v| {\n                 intravisit::walk_trait_item(v, ti);\n             },\n@@ -411,6 +429,7 @@ impl<'a, 'tcx> Visitor<'tcx> for Annotator<'a, 'tcx> {\n             kind,\n             InheritDeprecation::Yes,\n             InheritConstStability::No,\n+            InheritStability::No,\n             |v| {\n                 intravisit::walk_impl_item(v, ii);\n             },\n@@ -425,6 +444,7 @@ impl<'a, 'tcx> Visitor<'tcx> for Annotator<'a, 'tcx> {\n             AnnotationKind::Required,\n             InheritDeprecation::Yes,\n             InheritConstStability::No,\n+            InheritStability::Yes,\n             |v| {\n                 if let Some(ctor_hir_id) = var.data.ctor_hir_id() {\n                     v.annotate(\n@@ -434,6 +454,7 @@ impl<'a, 'tcx> Visitor<'tcx> for Annotator<'a, 'tcx> {\n                         AnnotationKind::Required,\n                         InheritDeprecation::Yes,\n                         InheritConstStability::No,\n+                        InheritStability::No,\n                         |_| {},\n                     );\n                 }\n@@ -451,6 +472,7 @@ impl<'a, 'tcx> Visitor<'tcx> for Annotator<'a, 'tcx> {\n             AnnotationKind::Required,\n             InheritDeprecation::Yes,\n             InheritConstStability::No,\n+            InheritStability::Yes,\n             |v| {\n                 intravisit::walk_struct_field(v, s);\n             },\n@@ -465,6 +487,7 @@ impl<'a, 'tcx> Visitor<'tcx> for Annotator<'a, 'tcx> {\n             AnnotationKind::Required,\n             InheritDeprecation::Yes,\n             InheritConstStability::No,\n+            InheritStability::No,\n             |v| {\n                 intravisit::walk_foreign_item(v, i);\n             },\n@@ -479,6 +502,7 @@ impl<'a, 'tcx> Visitor<'tcx> for Annotator<'a, 'tcx> {\n             AnnotationKind::Required,\n             InheritDeprecation::Yes,\n             InheritConstStability::No,\n+            InheritStability::No,\n             |_| {},\n         );\n     }\n@@ -499,6 +523,7 @@ impl<'a, 'tcx> Visitor<'tcx> for Annotator<'a, 'tcx> {\n             kind,\n             InheritDeprecation::No,\n             InheritConstStability::No,\n+            InheritStability::No,\n             |v| {\n                 intravisit::walk_generic_param(v, p);\n             },\n@@ -669,6 +694,7 @@ fn new_index(tcx: TyCtxt<'tcx>) -> Index<'tcx> {\n             AnnotationKind::Required,\n             InheritDeprecation::Yes,\n             InheritConstStability::No,\n+            InheritStability::No,\n             |v| intravisit::walk_crate(v, krate),\n         );\n     }"}, {"sha": "910bfd1b5e48a4afa42423439de70ecd486ee234", "filename": "src/test/ui/deprecation/deprecation-in-staged-api.rs", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Fdeprecation%2Fdeprecation-in-staged-api.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Fdeprecation%2Fdeprecation-in-staged-api.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdeprecation%2Fdeprecation-in-staged-api.rs?ref=4cb089bb542f30faa708c65347aacef42c2427cb", "patch": "@@ -1,8 +1,4 @@\n-// #[deprecated] cannot be used in staged API\n-\n #![feature(staged_api)]\n-\n #![stable(feature = \"stable_test_feature\", since = \"1.0.0\")]\n-\n-#[deprecated]\n-fn main() { } //~ ERROR `#[deprecated]` cannot be used in staged API\n+#[deprecated] //~ ERROR `#[deprecated]` cannot be used in staged API\n+fn main() {}"}, {"sha": "cf977fa4b7b44d1293a4506f9050a4bdd756e531", "filename": "src/test/ui/deprecation/deprecation-in-staged-api.stderr", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Fdeprecation%2Fdeprecation-in-staged-api.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Fdeprecation%2Fdeprecation-in-staged-api.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdeprecation%2Fdeprecation-in-staged-api.stderr?ref=4cb089bb542f30faa708c65347aacef42c2427cb", "patch": "@@ -1,8 +1,10 @@\n-error: `#[deprecated]` cannot be used in staged API; use `#[rustc_deprecated]` instead\n-  --> $DIR/deprecation-in-staged-api.rs:8:1\n+error: `#[deprecated]` cannot be used in staged API\n+  --> $DIR/deprecation-in-staged-api.rs:3:1\n    |\n-LL | fn main() { }\n-   | ^^^^^^^^^^^^^\n+LL | #[deprecated]\n+   | ^^^^^^^^^^^^^ use `#[rustc_deprecated]` instead\n+LL | fn main() {}\n+   | ------------\n \n error: aborting due to previous error\n "}, {"sha": "3cbb48c4a6be0567dff147330b0f7301e0705743", "filename": "src/test/ui/lint/auxiliary/lint_stability_fields.rs", "status": "modified", "additions": 19, "deletions": 4, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Flint%2Fauxiliary%2Flint_stability_fields.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Flint%2Fauxiliary%2Flint_stability_fields.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fauxiliary%2Flint_stability_fields.rs?ref=4cb089bb542f30faa708c65347aacef42c2427cb", "patch": "@@ -3,20 +3,35 @@\n \n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n pub struct Stable {\n-    #[stable(feature = \"rust1\", since = \"1.0.0\")]\n-    pub inherit: u8, // it's a lie (stable doesn't inherit)\n+    pub inherit: u8,\n     #[unstable(feature = \"unstable_test_feature\", issue = \"none\")]\n     pub override1: u8,\n     #[rustc_deprecated(since = \"1.0.0\", reason = \"text\")]\n     #[unstable(feature = \"unstable_test_feature\", issue = \"none\")]\n     pub override2: u8,\n+    #[stable(feature = \"rust2\", since = \"2.0.0\")]\n+    pub override3: u8,\n }\n \n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n-pub struct Stable2(#[stable(feature = \"rust1\", since = \"1.0.0\")] pub u8,\n+pub struct Stable2(#[stable(feature = \"rust2\", since = \"2.0.0\")] pub u8,\n                    #[unstable(feature = \"unstable_test_feature\", issue = \"none\")] pub u8,\n                    #[unstable(feature = \"unstable_test_feature\", issue = \"none\")]\n-                   #[rustc_deprecated(since = \"1.0.0\", reason = \"text\")] pub u8);\n+                   #[rustc_deprecated(since = \"1.0.0\", reason = \"text\")] pub u8,\n+                   pub u8);\n+\n+#[stable(feature = \"rust1\", since = \"1.0.0\")]\n+pub enum Stable3 {\n+    Inherit(u8),\n+    InheritOverride(#[stable(feature = \"rust2\", since = \"2.0.0\")] u8),\n+    #[stable(feature = \"rust2\", since = \"2.0.0\")]\n+    Override1,\n+    #[unstable(feature = \"unstable_test_feature\", issue = \"none\")]\n+    Override2,\n+    #[rustc_deprecated(since = \"1.0.0\", reason = \"text\")]\n+    #[unstable(feature = \"unstable_test_feature\", issue = \"none\")]\n+    Override3,\n+}\n \n #[unstable(feature = \"unstable_test_feature\", issue = \"none\")]\n pub struct Unstable {"}, {"sha": "2024cf15ab0a1339cca9b0f0974a19ff90aacfa8", "filename": "src/test/ui/lint/lint-stability-fields-deprecated.rs", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Flint%2Flint-stability-fields-deprecated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Flint%2Flint-stability-fields-deprecated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-stability-fields-deprecated.rs?ref=4cb089bb542f30faa708c65347aacef42c2427cb", "patch": "@@ -17,33 +17,38 @@ mod cross_crate {\n             override1: 2,\n             override2: 3,\n             //~^ ERROR use of deprecated field\n+            override3: 4,\n         };\n \n         let _ = x.inherit;\n         let _ = x.override1;\n         let _ = x.override2;\n         //~^ ERROR use of deprecated field\n+        let _ = x.override3;\n \n         let Stable {\n             inherit: _,\n             override1: _,\n-            override2: _\n+            override2: _,\n             //~^ ERROR use of deprecated field\n+            override3: _,\n         } = x;\n         // all fine\n         let Stable { .. } = x;\n \n-        let x = Stable2(1, 2, 3);\n+        let x = Stable2(1, 2, 3, 4);\n \n         let _ = x.0;\n         let _ = x.1;\n         let _ = x.2;\n         //~^ ERROR use of deprecated field\n+        let _ = x.3;\n \n         let Stable2(_,\n                    _,\n+                   _,\n+                   //~^ ERROR use of deprecated field\n                    _)\n-            //~^ ERROR use of deprecated field\n             = x;\n         // all fine\n         let Stable2(..) = x;"}, {"sha": "151b3e59b9130115e89cf23e00629a73aa8dee8a", "filename": "src/test/ui/lint/lint-stability-fields-deprecated.stderr", "status": "modified", "additions": 63, "deletions": 63, "changes": 126, "blob_url": "https://github.com/rust-lang/rust/blob/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Flint%2Flint-stability-fields-deprecated.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Flint%2Flint-stability-fields-deprecated.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-stability-fields-deprecated.stderr?ref=4cb089bb542f30faa708c65347aacef42c2427cb", "patch": "@@ -1,5 +1,5 @@\n error: use of deprecated struct `cross_crate::lint_stability_fields::Deprecated`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:94:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:99:17\n    |\n LL |         let x = Deprecated {\n    |                 ^^^^^^^^^^\n@@ -11,67 +11,67 @@ LL | #![deny(deprecated)]\n    |         ^^^^^^^^^^\n \n error: use of deprecated struct `cross_crate::lint_stability_fields::Deprecated`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:111:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:116:13\n    |\n LL |         let Deprecated {\n    |             ^^^^^^^^^^\n \n error: use of deprecated struct `cross_crate::lint_stability_fields::Deprecated`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:121:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:126:13\n    |\n LL |         let Deprecated\n    |             ^^^^^^^^^^\n \n error: use of deprecated struct `cross_crate::lint_stability_fields::Deprecated2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:126:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:131:17\n    |\n LL |         let x = Deprecated2(1, 2, 3);\n    |                 ^^^^^^^^^^^\n \n error: use of deprecated struct `cross_crate::lint_stability_fields::Deprecated2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:136:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:141:13\n    |\n LL |         let Deprecated2\n    |             ^^^^^^^^^^^\n \n error: use of deprecated struct `cross_crate::lint_stability_fields::Deprecated2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:145:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:150:13\n    |\n LL |         let Deprecated2\n    |             ^^^^^^^^^^^\n \n error: use of deprecated struct `this_crate::Deprecated`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:281:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:286:17\n    |\n LL |         let x = Deprecated {\n    |                 ^^^^^^^^^^\n \n error: use of deprecated struct `this_crate::Deprecated`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:298:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:303:13\n    |\n LL |         let Deprecated {\n    |             ^^^^^^^^^^\n \n error: use of deprecated struct `this_crate::Deprecated`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:308:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:313:13\n    |\n LL |         let Deprecated\n    |             ^^^^^^^^^^\n \n error: use of deprecated tuple struct `this_crate::Deprecated2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:313:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:318:17\n    |\n LL |         let x = Deprecated2(1, 2, 3);\n    |                 ^^^^^^^^^^^\n \n error: use of deprecated tuple struct `this_crate::Deprecated2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:323:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:328:13\n    |\n LL |         let Deprecated2\n    |             ^^^^^^^^^^^\n \n error: use of deprecated tuple struct `this_crate::Deprecated2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:332:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:337:13\n    |\n LL |         let Deprecated2\n    |             ^^^^^^^^^^^\n@@ -83,295 +83,295 @@ LL |             override2: 3,\n    |             ^^^^^^^^^^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Stable::override2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:24:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:25:17\n    |\n LL |         let _ = x.override2;\n    |                 ^^^^^^^^^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Stable::override2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:30:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:32:13\n    |\n-LL |             override2: _\n+LL |             override2: _,\n    |             ^^^^^^^^^^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Stable2::2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:40:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:43:17\n    |\n LL |         let _ = x.2;\n    |                 ^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Stable2::2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:45:20\n+  --> $DIR/lint-stability-fields-deprecated.rs:49:20\n    |\n-LL |                    _)\n+LL |                    _,\n    |                    ^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Unstable::override2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:55:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:60:13\n    |\n LL |             override2: 3,\n    |             ^^^^^^^^^^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Unstable::override2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:61:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:66:17\n    |\n LL |         let _ = x.override2;\n    |                 ^^^^^^^^^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Unstable::override2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:67:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:72:13\n    |\n LL |             override2: _\n    |             ^^^^^^^^^^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Unstable2::2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:80:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:85:17\n    |\n LL |         let _ = x.2;\n    |                 ^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Unstable2::2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:86:14\n+  --> $DIR/lint-stability-fields-deprecated.rs:91:14\n    |\n LL |              _)\n    |              ^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Deprecated::inherit`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:96:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:101:13\n    |\n LL |             inherit: 1,\n    |             ^^^^^^^^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Deprecated::override1`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:98:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:103:13\n    |\n LL |             override1: 2,\n    |             ^^^^^^^^^^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Deprecated::override2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:100:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:105:13\n    |\n LL |             override2: 3,\n    |             ^^^^^^^^^^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Deprecated::inherit`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:104:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:109:17\n    |\n LL |         let _ = x.inherit;\n    |                 ^^^^^^^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Deprecated::override1`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:106:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:111:17\n    |\n LL |         let _ = x.override1;\n    |                 ^^^^^^^^^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Deprecated::override2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:108:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:113:17\n    |\n LL |         let _ = x.override2;\n    |                 ^^^^^^^^^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Deprecated::inherit`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:113:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:118:13\n    |\n LL |             inherit: _,\n    |             ^^^^^^^^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Deprecated::override1`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:115:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:120:13\n    |\n LL |             override1: _,\n    |             ^^^^^^^^^^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Deprecated::override2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:117:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:122:13\n    |\n LL |             override2: _\n    |             ^^^^^^^^^^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Deprecated2::0`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:129:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:134:17\n    |\n LL |         let _ = x.0;\n    |                 ^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Deprecated2::1`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:131:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:136:17\n    |\n LL |         let _ = x.1;\n    |                 ^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Deprecated2::2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:133:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:138:17\n    |\n LL |         let _ = x.2;\n    |                 ^^^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Deprecated2::0`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:138:14\n+  --> $DIR/lint-stability-fields-deprecated.rs:143:14\n    |\n LL |             (_,\n    |              ^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Deprecated2::1`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:140:14\n+  --> $DIR/lint-stability-fields-deprecated.rs:145:14\n    |\n LL |              _,\n    |              ^\n \n error: use of deprecated field `cross_crate::lint_stability_fields::Deprecated2::2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:142:14\n+  --> $DIR/lint-stability-fields-deprecated.rs:147:14\n    |\n LL |              _)\n    |              ^\n \n error: use of deprecated field `this_crate::Stable::override2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:205:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:210:13\n    |\n LL |             override2: 3,\n    |             ^^^^^^^^^^^^\n \n error: use of deprecated field `this_crate::Stable::override2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:211:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:216:17\n    |\n LL |         let _ = x.override2;\n    |                 ^^^^^^^^^^^\n \n error: use of deprecated field `this_crate::Stable::override2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:217:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:222:13\n    |\n LL |             override2: _\n    |             ^^^^^^^^^^^^\n \n error: use of deprecated field `this_crate::Stable2::2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:227:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:232:17\n    |\n LL |         let _ = x.2;\n    |                 ^^^\n \n error: use of deprecated field `this_crate::Stable2::2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:232:20\n+  --> $DIR/lint-stability-fields-deprecated.rs:237:20\n    |\n LL |                    _)\n    |                    ^\n \n error: use of deprecated field `this_crate::Unstable::override2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:242:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:247:13\n    |\n LL |             override2: 3,\n    |             ^^^^^^^^^^^^\n \n error: use of deprecated field `this_crate::Unstable::override2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:248:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:253:17\n    |\n LL |         let _ = x.override2;\n    |                 ^^^^^^^^^^^\n \n error: use of deprecated field `this_crate::Unstable::override2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:254:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:259:13\n    |\n LL |             override2: _\n    |             ^^^^^^^^^^^^\n \n error: use of deprecated field `this_crate::Unstable2::2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:267:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:272:17\n    |\n LL |         let _ = x.2;\n    |                 ^^^\n \n error: use of deprecated field `this_crate::Unstable2::2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:273:14\n+  --> $DIR/lint-stability-fields-deprecated.rs:278:14\n    |\n LL |              _)\n    |              ^\n \n error: use of deprecated field `this_crate::Deprecated::inherit`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:283:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:288:13\n    |\n LL |             inherit: 1,\n    |             ^^^^^^^^^^\n \n error: use of deprecated field `this_crate::Deprecated::override1`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:285:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:290:13\n    |\n LL |             override1: 2,\n    |             ^^^^^^^^^^^^\n \n error: use of deprecated field `this_crate::Deprecated::override2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:287:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:292:13\n    |\n LL |             override2: 3,\n    |             ^^^^^^^^^^^^\n \n error: use of deprecated field `this_crate::Deprecated::inherit`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:291:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:296:17\n    |\n LL |         let _ = x.inherit;\n    |                 ^^^^^^^^^\n \n error: use of deprecated field `this_crate::Deprecated::override1`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:293:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:298:17\n    |\n LL |         let _ = x.override1;\n    |                 ^^^^^^^^^^^\n \n error: use of deprecated field `this_crate::Deprecated::override2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:295:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:300:17\n    |\n LL |         let _ = x.override2;\n    |                 ^^^^^^^^^^^\n \n error: use of deprecated field `this_crate::Deprecated::inherit`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:300:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:305:13\n    |\n LL |             inherit: _,\n    |             ^^^^^^^^^^\n \n error: use of deprecated field `this_crate::Deprecated::override1`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:302:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:307:13\n    |\n LL |             override1: _,\n    |             ^^^^^^^^^^^^\n \n error: use of deprecated field `this_crate::Deprecated::override2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:304:13\n+  --> $DIR/lint-stability-fields-deprecated.rs:309:13\n    |\n LL |             override2: _\n    |             ^^^^^^^^^^^^\n \n error: use of deprecated field `this_crate::Deprecated2::0`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:316:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:321:17\n    |\n LL |         let _ = x.0;\n    |                 ^^^\n \n error: use of deprecated field `this_crate::Deprecated2::1`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:318:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:323:17\n    |\n LL |         let _ = x.1;\n    |                 ^^^\n \n error: use of deprecated field `this_crate::Deprecated2::2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:320:17\n+  --> $DIR/lint-stability-fields-deprecated.rs:325:17\n    |\n LL |         let _ = x.2;\n    |                 ^^^\n \n error: use of deprecated field `this_crate::Deprecated2::0`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:325:14\n+  --> $DIR/lint-stability-fields-deprecated.rs:330:14\n    |\n LL |             (_,\n    |              ^\n \n error: use of deprecated field `this_crate::Deprecated2::1`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:327:14\n+  --> $DIR/lint-stability-fields-deprecated.rs:332:14\n    |\n LL |              _,\n    |              ^\n \n error: use of deprecated field `this_crate::Deprecated2::2`: text\n-  --> $DIR/lint-stability-fields-deprecated.rs:329:14\n+  --> $DIR/lint-stability-fields-deprecated.rs:334:14\n    |\n LL |              _)\n    |              ^"}, {"sha": "4083648984867b475aa73ccafd79b71dc51f1a82", "filename": "src/test/ui/lint/lint-stability-fields.rs", "status": "modified", "additions": 15, "deletions": 5, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Flint%2Flint-stability-fields.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Flint%2Flint-stability-fields.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-stability-fields.rs?ref=4cb089bb542f30faa708c65347aacef42c2427cb", "patch": "@@ -20,29 +20,34 @@ mod cross_crate {\n             inherit: 1,\n             override1: 2, //~ ERROR use of unstable\n             override2: 3, //~ ERROR use of unstable\n+            override3: 4,\n         };\n \n         let _ = x.inherit;\n         let _ = x.override1; //~ ERROR use of unstable\n         let _ = x.override2; //~ ERROR use of unstable\n+        let _ = x.override3;\n \n         let Stable {\n             inherit: _,\n             override1: _, //~ ERROR use of unstable\n-            override2: _ //~ ERROR use of unstable\n+            override2: _, //~ ERROR use of unstable\n+            override3: _\n         } = x;\n         // all fine\n         let Stable { .. } = x;\n \n-        let x = Stable2(1, 2, 3);\n+        let x = Stable2(1, 2, 3, 4);\n \n         let _ = x.0;\n         let _ = x.1; //~ ERROR use of unstable\n         let _ = x.2; //~ ERROR use of unstable\n+        let _ = x.3;\n \n         let Stable2(_,\n                    _, //~ ERROR use of unstable\n-                   _) //~ ERROR use of unstable\n+                   _, //~ ERROR use of unstable\n+                   _)\n             = x;\n         // all fine\n         let Stable2(..) = x;\n@@ -133,11 +138,13 @@ mod this_crate {\n         #[rustc_deprecated(since = \"1.0.0\", reason = \"text\")]\n         #[unstable(feature = \"unstable_test_feature\", issue = \"none\")]\n         override2: u8,\n+        #[stable(feature = \"rust2\", since = \"2.0.0\")]\n+        override3: u8,\n     }\n \n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     struct Stable2(u8,\n-                   #[stable(feature = \"rust1\", since = \"1.0.0\")] u8,\n+                   #[stable(feature = \"rust2\", since = \"2.0.0\")] u8,\n                    #[unstable(feature = \"unstable_test_feature\", issue = \"none\")]\n                    #[rustc_deprecated(since = \"1.0.0\", reason = \"text\")] u8);\n \n@@ -178,16 +185,19 @@ mod this_crate {\n             inherit: 1,\n             override1: 2,\n             override2: 3,\n+            override3: 4,\n         };\n \n         let _ = x.inherit;\n         let _ = x.override1;\n         let _ = x.override2;\n+        let _ = x.override3;\n \n         let Stable {\n             inherit: _,\n             override1: _,\n-            override2: _\n+            override2: _,\n+            override3: _\n         } = x;\n         // all fine\n         let Stable { .. } = x;"}, {"sha": "3d2e73c1e8e9232a99b76b3040694dc1abf4a6e3", "filename": "src/test/ui/lint/lint-stability-fields.stderr", "status": "modified", "additions": 43, "deletions": 43, "changes": 86, "blob_url": "https://github.com/rust-lang/rust/blob/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Flint%2Flint-stability-fields.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Flint%2Flint-stability-fields.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-stability-fields.stderr?ref=4cb089bb542f30faa708c65347aacef42c2427cb", "patch": "@@ -1,101 +1,101 @@\n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:51:17\n+  --> $DIR/lint-stability-fields.rs:56:17\n    |\n LL |         let x = Unstable {\n    |                 ^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:61:13\n+  --> $DIR/lint-stability-fields.rs:66:13\n    |\n LL |         let Unstable {\n    |             ^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:67:13\n+  --> $DIR/lint-stability-fields.rs:72:13\n    |\n LL |         let Unstable\n    |             ^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:72:17\n+  --> $DIR/lint-stability-fields.rs:77:17\n    |\n LL |         let x = reexport::Unstable2(1, 2, 3);\n    |                 ^^^^^^^^^^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:74:17\n+  --> $DIR/lint-stability-fields.rs:79:17\n    |\n LL |         let x = Unstable2(1, 2, 3);\n    |                 ^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:80:13\n+  --> $DIR/lint-stability-fields.rs:85:13\n    |\n LL |         let Unstable2\n    |             ^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:85:13\n+  --> $DIR/lint-stability-fields.rs:90:13\n    |\n LL |         let Unstable2\n    |             ^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:90:17\n+  --> $DIR/lint-stability-fields.rs:95:17\n    |\n LL |         let x = Deprecated {\n    |                 ^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:100:13\n+  --> $DIR/lint-stability-fields.rs:105:13\n    |\n LL |         let Deprecated {\n    |             ^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:106:13\n+  --> $DIR/lint-stability-fields.rs:111:13\n    |\n LL |         let Deprecated\n    |             ^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:110:17\n+  --> $DIR/lint-stability-fields.rs:115:17\n    |\n LL |         let x = Deprecated2(1, 2, 3);\n    |                 ^^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:116:13\n+  --> $DIR/lint-stability-fields.rs:121:13\n    |\n LL |         let Deprecated2\n    |             ^^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:121:13\n+  --> $DIR/lint-stability-fields.rs:126:13\n    |\n LL |         let Deprecated2\n    |             ^^^^^^^^^^^\n@@ -119,223 +119,223 @@ LL |             override2: 3,\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:26:17\n+  --> $DIR/lint-stability-fields.rs:27:17\n    |\n LL |         let _ = x.override1;\n    |                 ^^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:27:17\n+  --> $DIR/lint-stability-fields.rs:28:17\n    |\n LL |         let _ = x.override2;\n    |                 ^^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:31:13\n+  --> $DIR/lint-stability-fields.rs:33:13\n    |\n LL |             override1: _,\n    |             ^^^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:32:13\n+  --> $DIR/lint-stability-fields.rs:34:13\n    |\n-LL |             override2: _\n+LL |             override2: _,\n    |             ^^^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:40:17\n+  --> $DIR/lint-stability-fields.rs:43:17\n    |\n LL |         let _ = x.1;\n    |                 ^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:41:17\n+  --> $DIR/lint-stability-fields.rs:44:17\n    |\n LL |         let _ = x.2;\n    |                 ^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:44:20\n+  --> $DIR/lint-stability-fields.rs:48:20\n    |\n LL |                    _,\n    |                    ^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:45:20\n+  --> $DIR/lint-stability-fields.rs:49:20\n    |\n-LL |                    _)\n+LL |                    _,\n    |                    ^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:52:13\n+  --> $DIR/lint-stability-fields.rs:57:13\n    |\n LL |             inherit: 1,\n    |             ^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:54:13\n+  --> $DIR/lint-stability-fields.rs:59:13\n    |\n LL |             override2: 3,\n    |             ^^^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:57:17\n+  --> $DIR/lint-stability-fields.rs:62:17\n    |\n LL |         let _ = x.inherit;\n    |                 ^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:59:17\n+  --> $DIR/lint-stability-fields.rs:64:17\n    |\n LL |         let _ = x.override2;\n    |                 ^^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:62:13\n+  --> $DIR/lint-stability-fields.rs:67:13\n    |\n LL |             inherit: _,\n    |             ^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:64:13\n+  --> $DIR/lint-stability-fields.rs:69:13\n    |\n LL |             override2: _\n    |             ^^^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:76:17\n+  --> $DIR/lint-stability-fields.rs:81:17\n    |\n LL |         let _ = x.0;\n    |                 ^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:78:17\n+  --> $DIR/lint-stability-fields.rs:83:17\n    |\n LL |         let _ = x.2;\n    |                 ^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:81:14\n+  --> $DIR/lint-stability-fields.rs:86:14\n    |\n LL |             (_,\n    |              ^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:83:14\n+  --> $DIR/lint-stability-fields.rs:88:14\n    |\n LL |              _)\n    |              ^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:91:13\n+  --> $DIR/lint-stability-fields.rs:96:13\n    |\n LL |             inherit: 1,\n    |             ^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:93:13\n+  --> $DIR/lint-stability-fields.rs:98:13\n    |\n LL |             override2: 3,\n    |             ^^^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:96:17\n+  --> $DIR/lint-stability-fields.rs:101:17\n    |\n LL |         let _ = x.inherit;\n    |                 ^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:98:17\n+  --> $DIR/lint-stability-fields.rs:103:17\n    |\n LL |         let _ = x.override2;\n    |                 ^^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:101:13\n+  --> $DIR/lint-stability-fields.rs:106:13\n    |\n LL |             inherit: _,\n    |             ^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:103:13\n+  --> $DIR/lint-stability-fields.rs:108:13\n    |\n LL |             override2: _\n    |             ^^^^^^^^^^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:112:17\n+  --> $DIR/lint-stability-fields.rs:117:17\n    |\n LL |         let _ = x.0;\n    |                 ^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:114:17\n+  --> $DIR/lint-stability-fields.rs:119:17\n    |\n LL |         let _ = x.2;\n    |                 ^^^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:117:14\n+  --> $DIR/lint-stability-fields.rs:122:14\n    |\n LL |             (_,\n    |              ^\n    |\n    = help: add `#![feature(unstable_test_feature)]` to the crate attributes to enable\n \n error[E0658]: use of unstable library feature 'unstable_test_feature'\n-  --> $DIR/lint-stability-fields.rs:119:14\n+  --> $DIR/lint-stability-fields.rs:124:14\n    |\n LL |              _)\n    |              ^"}, {"sha": "3f4fdfd0180ed2587cf5c6cf685a891affcb69ce", "filename": "src/test/ui/stability-attribute/stability-attribute-issue-43027.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Fstability-attribute%2Fstability-attribute-issue-43027.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Fstability-attribute%2Fstability-attribute-issue-43027.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fstability-attribute%2Fstability-attribute-issue-43027.rs?ref=4cb089bb542f30faa708c65347aacef42c2427cb", "patch": "@@ -1,10 +1,15 @@\n+// check-pass\n #![feature(staged_api)]\n #![stable(feature = \"test\", since = \"0\")]\n \n #[stable(feature = \"test\", since = \"0\")]\n-pub struct Reverse<T>(pub T); //~ ERROR field has missing stability attribute\n+pub struct A<T>(pub T);\n+\n+#[stable(feature = \"test\", since = \"0\")]\n+pub struct B<T>(#[stable(feature = \"test\", since = \"0\")] pub T);\n \n fn main() {\n     // Make sure the field is used to fill the stability cache\n-    Reverse(0).0;\n+    A(0).0;\n+    B(0).0;\n }"}, {"sha": "280c72acccb1863d613586ba707db5d745b36841", "filename": "src/test/ui/stability-attribute/stability-attribute-issue-43027.stderr", "status": "removed", "additions": 0, "deletions": 8, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/178108bf81606a0e25b1066568c2b8c8e0648617/src%2Ftest%2Fui%2Fstability-attribute%2Fstability-attribute-issue-43027.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/178108bf81606a0e25b1066568c2b8c8e0648617/src%2Ftest%2Fui%2Fstability-attribute%2Fstability-attribute-issue-43027.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fstability-attribute%2Fstability-attribute-issue-43027.stderr?ref=178108bf81606a0e25b1066568c2b8c8e0648617", "patch": "@@ -1,8 +0,0 @@\n-error: field has missing stability attribute\n-  --> $DIR/stability-attribute-issue-43027.rs:5:23\n-   |\n-LL | pub struct Reverse<T>(pub T);\n-   |                       ^^^^^\n-\n-error: aborting due to previous error\n-"}, {"sha": "1cc31d8ec187d1678bfdec77f36767ef8ce269ac", "filename": "src/test/ui/stability-attribute/stability-attribute-sanity.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Fstability-attribute%2Fstability-attribute-sanity.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Fstability-attribute%2Fstability-attribute-sanity.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fstability-attribute%2Fstability-attribute-sanity.rs?ref=4cb089bb542f30faa708c65347aacef42c2427cb", "patch": "@@ -62,12 +62,11 @@ fn multiple3() { }\n #[rustc_deprecated(since = \"b\", reason = \"text\")] //~ ERROR multiple deprecated attributes\n #[rustc_const_unstable(feature = \"c\", issue = \"none\")]\n #[rustc_const_unstable(feature = \"d\", issue = \"none\")] //~ ERROR multiple stability levels\n-pub const fn multiple4() { }\n-//~^ ERROR Invalid stability version found\n+pub const fn multiple4() { } //~ ERROR invalid stability version found\n \n #[stable(feature = \"a\", since = \"1.0.0\")]\n #[rustc_deprecated(since = \"invalid\", reason = \"text\")]\n-fn invalid_deprecation_version() {} //~ ERROR Invalid deprecation version found\n+fn invalid_deprecation_version() {} //~ ERROR invalid deprecation version found\n \n #[rustc_deprecated(since = \"a\", reason = \"text\")]\n fn deprecated_without_unstable_or_stable() { }"}, {"sha": "07e3da73c60c77001ffe61af6c4fec780e9ff732", "filename": "src/test/ui/stability-attribute/stability-attribute-sanity.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Fstability-attribute%2Fstability-attribute-sanity.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4cb089bb542f30faa708c65347aacef42c2427cb/src%2Ftest%2Fui%2Fstability-attribute%2Fstability-attribute-sanity.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fstability-attribute%2Fstability-attribute-sanity.stderr?ref=4cb089bb542f30faa708c65347aacef42c2427cb", "patch": "@@ -96,20 +96,20 @@ error[E0544]: multiple stability levels\n LL | #[rustc_const_unstable(feature = \"d\", issue = \"none\")]\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-error: Invalid stability version found\n+error: invalid stability version found\n   --> $DIR/stability-attribute-sanity.rs:65:1\n    |\n LL | pub const fn multiple4() { }\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-error: Invalid deprecation version found\n-  --> $DIR/stability-attribute-sanity.rs:70:1\n+error: invalid deprecation version found\n+  --> $DIR/stability-attribute-sanity.rs:69:1\n    |\n LL | fn invalid_deprecation_version() {}\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error[E0549]: rustc_deprecated attribute must be paired with either stable or unstable attribute\n-  --> $DIR/stability-attribute-sanity.rs:72:1\n+  --> $DIR/stability-attribute-sanity.rs:71:1\n    |\n LL | #[rustc_deprecated(since = \"a\", reason = \"text\")]\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^"}]}