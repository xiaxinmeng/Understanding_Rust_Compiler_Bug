{"sha": "abbc618d00dcfef9f9321fa19cd5688ce24c1507", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFiYmM2MThkMDBkY2ZlZjlmOTMyMWZhMTljZDU2ODhjZTI0YzE1MDc=", "commit": {"author": {"name": "Philipp Krones", "email": "hello@philkrones.com", "date": "2020-04-25T19:06:30Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-04-25T19:06:30Z"}, "message": "Rollup merge of #5517 - flip1995:deploy_time_travel, r=Manishearth\n\nDeploy time travel\n\nSince not only commits to the master branch, but also tags and the beta branch are deployed, we have to be cautious which version of the deploy script is used. GHA always runs the workflow that is commited on the `ref`, that gets tested. For tagged commits. this is 6 weeks outdated workflows/scripts. To prevent this, this workflow first checks out the deploy.sh script, the website templates and all python scripts generating files for the website.\n\nchangelog: none", "tree": {"sha": "dda19db2ca79506f6ec3d0a1d0dd556b1a753788", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/dda19db2ca79506f6ec3d0a1d0dd556b1a753788"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/abbc618d00dcfef9f9321fa19cd5688ce24c1507", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJepIo2CRBK7hj4Ov3rIwAAdHIIAHTDjs7FUDTOacVL7vufad5H\npFfkwFY3jEqyxLqd1Hf+LW66bXhPsdRccbwG8alk+rgKcmlKHkRpV9n5syEx0sJB\nAYdCY6W9sbJOGkbqd1j7gYZ3/Jd/A7lwcAsWG5wV6fAc35YkSS2mntZNTUc5lGYu\nzgrBLkjh0R1uW6Y415tL0iupNGehLlLsPUHhRfdfGer2EeP5IaCCgFBzKtcXJrJu\ntONuIfqdvjFqpp/Bf8Jxir6NdlyigziukQ+FeNXkQF3U1wYeQRTK7f+/FU+zKsA3\nqvsdO70pca3Abr3S+RjE0g+u814eQhBJUGXtuvHgb4WOsQlllxfrTy98d0X7Jh8=\n=Lvq6\n-----END PGP SIGNATURE-----\n", "payload": "tree dda19db2ca79506f6ec3d0a1d0dd556b1a753788\nparent e39550e45ec16bb23a868a348f05a95ad6df6b1c\nparent 0476e8b48380f0376ff040f07edfe74372ae2101\nauthor Philipp Krones <hello@philkrones.com> 1587841590 +0200\ncommitter GitHub <noreply@github.com> 1587841590 +0200\n\nRollup merge of #5517 - flip1995:deploy_time_travel, r=Manishearth\n\nDeploy time travel\n\nSince not only commits to the master branch, but also tags and the beta branch are deployed, we have to be cautious which version of the deploy script is used. GHA always runs the workflow that is commited on the `ref`, that gets tested. For tagged commits. this is 6 weeks outdated workflows/scripts. To prevent this, this workflow first checks out the deploy.sh script, the website templates and all python scripts generating files for the website.\n\nchangelog: none\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/abbc618d00dcfef9f9321fa19cd5688ce24c1507", "html_url": "https://github.com/rust-lang/rust/commit/abbc618d00dcfef9f9321fa19cd5688ce24c1507", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/abbc618d00dcfef9f9321fa19cd5688ce24c1507/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e39550e45ec16bb23a868a348f05a95ad6df6b1c", "url": "https://api.github.com/repos/rust-lang/rust/commits/e39550e45ec16bb23a868a348f05a95ad6df6b1c", "html_url": "https://github.com/rust-lang/rust/commit/e39550e45ec16bb23a868a348f05a95ad6df6b1c"}, {"sha": "0476e8b48380f0376ff040f07edfe74372ae2101", "url": "https://api.github.com/repos/rust-lang/rust/commits/0476e8b48380f0376ff040f07edfe74372ae2101", "html_url": "https://github.com/rust-lang/rust/commit/0476e8b48380f0376ff040f07edfe74372ae2101"}], "stats": {"total": 8, "additions": 6, "deletions": 2}, "files": [{"sha": "6675a1029bbc8ad2cf7b86adbc6fc65c672530c2", "filename": ".github/workflows/clippy_bors.yml", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/abbc618d00dcfef9f9321fa19cd5688ce24c1507/.github%2Fworkflows%2Fclippy_bors.yml", "raw_url": "https://github.com/rust-lang/rust/raw/abbc618d00dcfef9f9321fa19cd5688ce24c1507/.github%2Fworkflows%2Fclippy_bors.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fclippy_bors.yml?ref=abbc618d00dcfef9f9321fa19cd5688ce24c1507", "patch": "@@ -77,8 +77,6 @@ jobs:\n       run: |\n         sudo dpkg --add-architecture i386\n         sudo apt-get update\n-        # perform system upgrade to work around https://github.com/rust-lang/rust-clippy/issues/5477 , revert as soon as that is fixed\n-        sudo apt-get -y upgrade\n         sudo apt-get install gcc-multilib libssl-dev:i386 libgit2-dev:i386\n       if: matrix.host == 'i686-unknown-linux-gnu'\n "}, {"sha": "f542f9b02c17b3d16903329df6d9d2fb2348462a", "filename": ".github/workflows/deploy.yml", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/abbc618d00dcfef9f9321fa19cd5688ce24c1507/.github%2Fworkflows%2Fdeploy.yml", "raw_url": "https://github.com/rust-lang/rust/raw/abbc618d00dcfef9f9321fa19cd5688ce24c1507/.github%2Fworkflows%2Fdeploy.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fdeploy.yml?ref=abbc618d00dcfef9f9321fa19cd5688ce24c1507", "patch": "@@ -38,6 +38,12 @@ jobs:\n     - name: Set beta to true\n       if: github.ref == 'refs/heads/beta'\n       run: echo \"::set-env name=BETA::true\"\n+\n+    - name: Use scripts and templates from master branch\n+      run: |\n+        git fetch --no-tags --prune --depth=1 origin master\n+        git checkout origin/master -- .github/deploy.sh util/gh-pages/ util/*.py\n+\n     - name: Deploy\n       run: |\n         eval \"$(ssh-agent -s)\""}]}