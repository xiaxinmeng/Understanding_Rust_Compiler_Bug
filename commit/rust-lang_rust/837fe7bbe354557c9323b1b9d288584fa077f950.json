{"sha": "837fe7bbe354557c9323b1b9d288584fa077f950", "node_id": "MDY6Q29tbWl0NzI0NzEyOjgzN2ZlN2JiZTM1NDU1N2M5MzIzYjFiOWQyODg1ODRmYTA3N2Y5NTA=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2019-07-09T11:57:22Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2019-07-09T11:57:22Z"}, "message": "Regression test.", "tree": {"sha": "be343219754ee1ec1999adca024193ae5260d8a7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/be343219754ee1ec1999adca024193ae5260d8a7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/837fe7bbe354557c9323b1b9d288584fa077f950", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/837fe7bbe354557c9323b1b9d288584fa077f950", "html_url": "https://github.com/rust-lang/rust/commit/837fe7bbe354557c9323b1b9d288584fa077f950", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/837fe7bbe354557c9323b1b9d288584fa077f950/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "50840ee851c7059e6261b2d961d5386e6763e963", "url": "https://api.github.com/repos/rust-lang/rust/commits/50840ee851c7059e6261b2d961d5386e6763e963", "html_url": "https://github.com/rust-lang/rust/commit/50840ee851c7059e6261b2d961d5386e6763e963"}], "stats": {"total": 72, "additions": 72, "deletions": 0}, "files": [{"sha": "454d7e5e9cdea8c97c43968bcb2ff226ed3bb8ae", "filename": "src/test/ui/hrtb/issue-62203-hrtb-ice.rs", "status": "added", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/rust-lang/rust/blob/837fe7bbe354557c9323b1b9d288584fa077f950/src%2Ftest%2Fui%2Fhrtb%2Fissue-62203-hrtb-ice.rs", "raw_url": "https://github.com/rust-lang/rust/raw/837fe7bbe354557c9323b1b9d288584fa077f950/src%2Ftest%2Fui%2Fhrtb%2Fissue-62203-hrtb-ice.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fhrtb%2Fissue-62203-hrtb-ice.rs?ref=837fe7bbe354557c9323b1b9d288584fa077f950", "patch": "@@ -0,0 +1,50 @@\n+trait T0<'a, A> {\n+    type O;\n+}\n+\n+struct L<T> {\n+    f: T,\n+}\n+\n+// explicitly named variants of what one would normally denote by the\n+// unit type `()`. Why do this? So that we can differentiate them in\n+// the diagnostic output.\n+struct Unit1;\n+struct Unit2;\n+struct Unit3;\n+struct Unit4;\n+\n+impl<'a, A, T> T0<'a, A> for L<T>\n+where\n+    T: FnMut(A) -> Unit3,\n+{\n+    type O = T::Output;\n+}\n+\n+trait T1: for<'r> Ty<'r> {\n+    fn m<'a, B: Ty<'a>, F>(&self, f: F) -> Unit1\n+    where\n+        F: for<'r> T0<'r, (<Self as Ty<'r>>::V,), O = <B as Ty<'r>>::V>,\n+    {\n+        unimplemented!();\n+    }\n+}\n+\n+trait Ty<'a> {\n+    type V;\n+}\n+\n+fn main() {\n+    let v = Unit2.m(\n+        //~^ ERROR type mismatch\n+        //~| ERROR type mismatch\n+        L {\n+            f : |x| { drop(x); Unit4 }\n+        });\n+}\n+\n+impl<'a> Ty<'a> for Unit2 {\n+    type V = &'a u8;\n+}\n+\n+impl T1 for Unit2 {}"}, {"sha": "c2d0e0c2a26bc077ed41b93068e730b08fa50b84", "filename": "src/test/ui/hrtb/issue-62203-hrtb-ice.stderr", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/837fe7bbe354557c9323b1b9d288584fa077f950/src%2Ftest%2Fui%2Fhrtb%2Fissue-62203-hrtb-ice.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/837fe7bbe354557c9323b1b9d288584fa077f950/src%2Ftest%2Fui%2Fhrtb%2Fissue-62203-hrtb-ice.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fhrtb%2Fissue-62203-hrtb-ice.stderr?ref=837fe7bbe354557c9323b1b9d288584fa077f950", "patch": "@@ -0,0 +1,22 @@\n+error[E0271]: type mismatch resolving `for<'r> <L<[closure@$DIR/issue-62203-hrtb-ice.rs:42:17: 42:39]> as T0<'r, (<Unit2 as Ty<'r>>::V,)>>::O == <_ as Ty<'r>>::V`\n+  --> $DIR/issue-62203-hrtb-ice.rs:38:19\n+   |\n+LL |     let v = Unit2.m(\n+   |                   ^ expected struct `Unit4`, found associated type\n+   |\n+   = note: expected type `Unit4`\n+              found type `<_ as Ty<'_>>::V`\n+\n+error[E0271]: type mismatch resolving `<[closure@$DIR/issue-62203-hrtb-ice.rs:42:17: 42:39] as std::ops::FnOnce<((&u8,),)>>::Output == Unit3`\n+  --> $DIR/issue-62203-hrtb-ice.rs:38:19\n+   |\n+LL |     let v = Unit2.m(\n+   |                   ^ expected struct `Unit4`, found struct `Unit3`\n+   |\n+   = note: expected type `Unit4`\n+              found type `Unit3`\n+   = note: required because of the requirements on the impl of `for<'r> T0<'r, (<Unit2 as Ty<'r>>::V,)>` for `L<[closure@$DIR/issue-62203-hrtb-ice.rs:42:17: 42:39]>`\n+\n+error: aborting due to 2 previous errors\n+\n+For more information about this error, try `rustc --explain E0271`."}]}