{"sha": "18be370342c9b2a93f1d56b2b674bd2fbdcbb019", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE4YmUzNzAzNDJjOWIyYTkzZjFkNTZiMmI2NzRiZDJmYmRjYmIwMTk=", "commit": {"author": {"name": "Yoshua Wuyts", "email": "yoshuawuyts@gmail.com", "date": "2020-04-05T15:50:45Z"}, "committer": {"name": "Yoshua Wuyts", "email": "yoshuawuyts@gmail.com", "date": "2020-07-14T12:49:07Z"}, "message": "Add core::ready! macro", "tree": {"sha": "3f3d55e74a040b83fb770224e3378c2261b7d2df", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3f3d55e74a040b83fb770224e3378c2261b7d2df"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/18be370342c9b2a93f1d56b2b674bd2fbdcbb019", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/18be370342c9b2a93f1d56b2b674bd2fbdcbb019", "html_url": "https://github.com/rust-lang/rust/commit/18be370342c9b2a93f1d56b2b674bd2fbdcbb019", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/18be370342c9b2a93f1d56b2b674bd2fbdcbb019/comments", "author": {"login": "yoshuawuyts", "id": 2467194, "node_id": "MDQ6VXNlcjI0NjcxOTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2467194?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yoshuawuyts", "html_url": "https://github.com/yoshuawuyts", "followers_url": "https://api.github.com/users/yoshuawuyts/followers", "following_url": "https://api.github.com/users/yoshuawuyts/following{/other_user}", "gists_url": "https://api.github.com/users/yoshuawuyts/gists{/gist_id}", "starred_url": "https://api.github.com/users/yoshuawuyts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yoshuawuyts/subscriptions", "organizations_url": "https://api.github.com/users/yoshuawuyts/orgs", "repos_url": "https://api.github.com/users/yoshuawuyts/repos", "events_url": "https://api.github.com/users/yoshuawuyts/events{/privacy}", "received_events_url": "https://api.github.com/users/yoshuawuyts/received_events", "type": "User", "site_admin": false}, "committer": {"login": "yoshuawuyts", "id": 2467194, "node_id": "MDQ6VXNlcjI0NjcxOTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2467194?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yoshuawuyts", "html_url": "https://github.com/yoshuawuyts", "followers_url": "https://api.github.com/users/yoshuawuyts/followers", "following_url": "https://api.github.com/users/yoshuawuyts/following{/other_user}", "gists_url": "https://api.github.com/users/yoshuawuyts/gists{/gist_id}", "starred_url": "https://api.github.com/users/yoshuawuyts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yoshuawuyts/subscriptions", "organizations_url": "https://api.github.com/users/yoshuawuyts/orgs", "repos_url": "https://api.github.com/users/yoshuawuyts/repos", "events_url": "https://api.github.com/users/yoshuawuyts/events{/privacy}", "received_events_url": "https://api.github.com/users/yoshuawuyts/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9d09331e00b02f81c714b0c41ce3a38380dd36a2", "url": "https://api.github.com/repos/rust-lang/rust/commits/9d09331e00b02f81c714b0c41ce3a38380dd36a2", "html_url": "https://github.com/rust-lang/rust/commit/9d09331e00b02f81c714b0c41ce3a38380dd36a2"}], "stats": {"total": 65, "additions": 65, "deletions": 0}, "files": [{"sha": "3d6f4f5971a62db2a88b3657a26008ade27732c4", "filename": "src/libcore/task/mod.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/18be370342c9b2a93f1d56b2b674bd2fbdcbb019/src%2Flibcore%2Ftask%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18be370342c9b2a93f1d56b2b674bd2fbdcbb019/src%2Flibcore%2Ftask%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Ftask%2Fmod.rs?ref=18be370342c9b2a93f1d56b2b674bd2fbdcbb019", "patch": "@@ -9,3 +9,7 @@ pub use self::poll::Poll;\n mod wake;\n #[stable(feature = \"futures_api\", since = \"1.36.0\")]\n pub use self::wake::{Context, RawWaker, RawWakerVTable, Waker};\n+\n+mod ready;\n+#[unstable(feature = \"ready_macro\", issue = \"70922\")]\n+pub use ready::ready;"}, {"sha": "d4e733eb2bcf52668466933ba6555b92d77a29cb", "filename": "src/libcore/task/ready.rs", "status": "added", "additions": 60, "deletions": 0, "changes": 60, "blob_url": "https://github.com/rust-lang/rust/blob/18be370342c9b2a93f1d56b2b674bd2fbdcbb019/src%2Flibcore%2Ftask%2Fready.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18be370342c9b2a93f1d56b2b674bd2fbdcbb019/src%2Flibcore%2Ftask%2Fready.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Ftask%2Fready.rs?ref=18be370342c9b2a93f1d56b2b674bd2fbdcbb019", "patch": "@@ -0,0 +1,60 @@\n+/// Extracts the successful type of a `Poll<T>`.\n+///\n+/// This macro bakes in propagation of `Pending` signals by returning early.\n+///\n+/// # Examples\n+///\n+/// ```\n+/// #![feature(future_readiness_fns)]\n+/// #![feature(ready_macro)]\n+///\n+/// use core::task::{ready, Context, Poll};\n+/// use core::future::{self, Future};\n+/// use core::pin::Pin;\n+///\n+/// pub fn do_poll(cx: &mut Context<'_>) -> Poll<()> {\n+///     let mut fut = future::ready(42);\n+///     let fut = Pin::new(&mut fut);\n+///\n+///     let num = ready!(fut.poll(cx));\n+///     # drop(num);\n+///     // ... use num\n+///\n+///     Poll::Ready(())\n+/// }\n+/// ```\n+///\n+/// The `ready!` call expands to:\n+///\n+/// ```\n+/// # #![feature(future_readiness_fns)]\n+/// # #![feature(ready_macro)]\n+/// #\n+/// # use core::task::{Context, Poll};\n+/// # use core::future::{self, Future};\n+/// # use core::pin::Pin;\n+/// #\n+/// # pub fn do_poll(cx: &mut Context<'_>) -> Poll<()> {\n+///     # let mut fut = future::ready(42);\n+///     # let fut = Pin::new(&mut fut);\n+///     #\n+/// let num = match fut.poll(cx) {\n+///     Poll::Ready(t) => t,\n+///     Poll::Pending => return Poll::Pending,\n+/// };\n+///     # drop(num);\n+///     # // ... use num\n+///     #\n+///     # Poll::Ready(())\n+/// # }\n+/// ```\n+#[unstable(feature = \"ready_macro\", issue = \"70922\")]\n+#[rustc_macro_transparency = \"semitransparent\"]\n+pub macro ready($e:expr) {\n+    match $e {\n+        $crate::task::Poll::Ready(t) => t,\n+        $crate::task::Poll::Pending => {\n+            return $crate::task::Poll::Pending;\n+        }\n+    }\n+}"}, {"sha": "939db4bb12e56406138d5192f8a6c022778850be", "filename": "src/libstd/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/18be370342c9b2a93f1d56b2b674bd2fbdcbb019/src%2Flibstd%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18be370342c9b2a93f1d56b2b674bd2fbdcbb019/src%2Flibstd%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Flib.rs?ref=18be370342c9b2a93f1d56b2b674bd2fbdcbb019", "patch": "@@ -299,6 +299,7 @@\n #![feature(ptr_internals)]\n #![feature(raw)]\n #![feature(raw_ref_macros)]\n+#![feature(ready_macro)]\n #![feature(renamed_spin_loop)]\n #![feature(rustc_attrs)]\n #![feature(rustc_private)]"}]}