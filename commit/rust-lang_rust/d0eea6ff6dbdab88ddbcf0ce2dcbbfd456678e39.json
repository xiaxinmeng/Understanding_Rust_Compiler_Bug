{"sha": "d0eea6ff6dbdab88ddbcf0ce2dcbbfd456678e39", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQwZWVhNmZmNmRiZGFiODhkZGJjZjBjZTJkY2JiZmQ0NTY2NzhlMzk=", "commit": {"author": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2019-10-08T16:46:57Z"}, "committer": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2019-10-08T16:56:05Z"}, "message": "review comments", "tree": {"sha": "e2a8a2ad6cc7063d580c4c11bd7ca7904fa3b5a3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e2a8a2ad6cc7063d580c4c11bd7ca7904fa3b5a3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d0eea6ff6dbdab88ddbcf0ce2dcbbfd456678e39", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d0eea6ff6dbdab88ddbcf0ce2dcbbfd456678e39", "html_url": "https://github.com/rust-lang/rust/commit/d0eea6ff6dbdab88ddbcf0ce2dcbbfd456678e39", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d0eea6ff6dbdab88ddbcf0ce2dcbbfd456678e39/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ac9025c1979d0b4019d90a8ab7ad4336d468a0de", "url": "https://api.github.com/repos/rust-lang/rust/commits/ac9025c1979d0b4019d90a8ab7ad4336d468a0de", "html_url": "https://github.com/rust-lang/rust/commit/ac9025c1979d0b4019d90a8ab7ad4336d468a0de"}], "stats": {"total": 14, "additions": 5, "deletions": 9}, "files": [{"sha": "1f792ecc2da9031fb3b78b3afe990272b8670868", "filename": "src/librustc/hir/mod.rs", "status": "modified", "additions": 4, "deletions": 8, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/d0eea6ff6dbdab88ddbcf0ce2dcbbfd456678e39/src%2Flibrustc%2Fhir%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0eea6ff6dbdab88ddbcf0ce2dcbbfd456678e39/src%2Flibrustc%2Fhir%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fhir%2Fmod.rs?ref=d0eea6ff6dbdab88ddbcf0ce2dcbbfd456678e39", "patch": "@@ -1555,15 +1555,11 @@ impl Expr {\n     /// `ExprKind` of any given `Expr` for presentation don't have to care about `DropTemps`\n     /// beyond remembering to call this function before doing analysis on it.\n     pub fn peel_drop_temps(&self) -> &Self {\n-        let mut base_expr = self;\n-        loop {\n-            match &base_expr.kind {\n-                ExprKind::DropTemps(expr) => {\n-                    base_expr = &expr;\n-                }\n-                _ => return base_expr,\n-            }\n+        let mut expr = self;\n+        while let ExprKind::DropTemps(inner) = &expr.kind {\n+            expr = inner;\n         }\n+        expr\n     }\n }\n "}, {"sha": "d92ea7fd49a7294fa5d87175bf524ac020399c5b", "filename": "src/librustc_typeck/check/demand.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d0eea6ff6dbdab88ddbcf0ce2dcbbfd456678e39/src%2Flibrustc_typeck%2Fcheck%2Fdemand.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0eea6ff6dbdab88ddbcf0ce2dcbbfd456678e39/src%2Flibrustc_typeck%2Fcheck%2Fdemand.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fdemand.rs?ref=d0eea6ff6dbdab88ddbcf0ce2dcbbfd456678e39", "patch": "@@ -109,13 +109,13 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                               allow_two_phase: AllowTwoPhase)\n                               -> (Ty<'tcx>, Option<DiagnosticBuilder<'tcx>>) {\n         let expected = self.resolve_type_vars_with_obligations(expected);\n-        let expr = expr.peel_drop_temps();\n \n         let e = match self.try_coerce(expr, checked_ty, expected, allow_two_phase) {\n             Ok(ty) => return (ty, None),\n             Err(e) => e\n         };\n \n+        let expr = expr.peel_drop_temps();\n         let cause = self.misc(expr.span);\n         let expr_ty = self.resolve_type_vars_with_obligations(checked_ty);\n         let mut err = self.report_mismatched_types(&cause, expected, expr_ty, e);"}]}