{"sha": "3f5f54cd8bf73e7a271955582834fda9e707429d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNmNWY1NGNkOGJmNzNlN2EyNzE5NTU1ODI4MzRmZGE5ZTcwNzQyOWQ=", "commit": {"author": {"name": "Adam Gemmell", "email": "adam.gemmell@arm.com", "date": "2021-04-28T16:54:44Z"}, "committer": {"name": "Adam Gemmell", "email": "adam.gemmell@arm.com", "date": "2021-04-28T16:54:44Z"}, "message": "Update list of allowed aarch64 features\n\nThese features were recently added to std_detect. Features not supported\nby LLVM 9, the current minimum version for Rust, are commented.", "tree": {"sha": "1741848e205de4d559a56cb4653708d7e2e8e666", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1741848e205de4d559a56cb4653708d7e2e8e666"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3f5f54cd8bf73e7a271955582834fda9e707429d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3f5f54cd8bf73e7a271955582834fda9e707429d", "html_url": "https://github.com/rust-lang/rust/commit/3f5f54cd8bf73e7a271955582834fda9e707429d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3f5f54cd8bf73e7a271955582834fda9e707429d/comments", "author": {"login": "adamgemmell", "id": 3757567, "node_id": "MDQ6VXNlcjM3NTc1Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/3757567?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adamgemmell", "html_url": "https://github.com/adamgemmell", "followers_url": "https://api.github.com/users/adamgemmell/followers", "following_url": "https://api.github.com/users/adamgemmell/following{/other_user}", "gists_url": "https://api.github.com/users/adamgemmell/gists{/gist_id}", "starred_url": "https://api.github.com/users/adamgemmell/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adamgemmell/subscriptions", "organizations_url": "https://api.github.com/users/adamgemmell/orgs", "repos_url": "https://api.github.com/users/adamgemmell/repos", "events_url": "https://api.github.com/users/adamgemmell/events{/privacy}", "received_events_url": "https://api.github.com/users/adamgemmell/received_events", "type": "User", "site_admin": false}, "committer": {"login": "adamgemmell", "id": 3757567, "node_id": "MDQ6VXNlcjM3NTc1Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/3757567?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adamgemmell", "html_url": "https://github.com/adamgemmell", "followers_url": "https://api.github.com/users/adamgemmell/followers", "following_url": "https://api.github.com/users/adamgemmell/following{/other_user}", "gists_url": "https://api.github.com/users/adamgemmell/gists{/gist_id}", "starred_url": "https://api.github.com/users/adamgemmell/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adamgemmell/subscriptions", "organizations_url": "https://api.github.com/users/adamgemmell/orgs", "repos_url": "https://api.github.com/users/adamgemmell/repos", "events_url": "https://api.github.com/users/adamgemmell/events{/privacy}", "received_events_url": "https://api.github.com/users/adamgemmell/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "20040fa332c04b2d17925345163957d196cfbfe6", "url": "https://api.github.com/repos/rust-lang/rust/commits/20040fa332c04b2d17925345163957d196cfbfe6", "html_url": "https://github.com/rust-lang/rust/commit/20040fa332c04b2d17925345163957d196cfbfe6"}], "stats": {"total": 83, "additions": 81, "deletions": 2}, "files": [{"sha": "f0a2c91c0185145b6125930c00a0ccec7a7640ea", "filename": "compiler/rustc_codegen_llvm/src/llvm_util.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/3f5f54cd8bf73e7a271955582834fda9e707429d/compiler%2Frustc_codegen_llvm%2Fsrc%2Fllvm_util.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3f5f54cd8bf73e7a271955582834fda9e707429d/compiler%2Frustc_codegen_llvm%2Fsrc%2Fllvm_util.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_llvm%2Fsrc%2Fllvm_util.rs?ref=3f5f54cd8bf73e7a271955582834fda9e707429d", "patch": "@@ -152,6 +152,12 @@ pub fn to_llvm_feature<'a>(sess: &Session, s: &'a str) -> &'a str {\n         (\"x86\", \"avx512vpclmulqdq\") => \"vpclmulqdq\",\n         (\"aarch64\", \"fp\") => \"fp-armv8\",\n         (\"aarch64\", \"fp16\") => \"fullfp16\",\n+        (\"aarch64\", \"fhm\") => \"fp16fml\",\n+        (\"aarch64\", \"lse2\") => \"outline-atomics\",\n+        (\"aarch64\", \"rcpc2\") => \"rcpc-immo\",\n+        (\"aarch64\", \"dpb\") => \"ccpp\",\n+        (\"aarch64\", \"dpb2\") => \"ccdp\",\n+        (\"aarch64\", \"fcma\") => \"complxnum\",\n         (_, s) => s,\n     }\n }"}, {"sha": "aa415754dadb0d5bb15809ecbbbaffb58c4c5137", "filename": "compiler/rustc_codegen_ssa/src/target_features.rs", "status": "modified", "additions": 75, "deletions": 2, "changes": 77, "blob_url": "https://github.com/rust-lang/rust/blob/3f5f54cd8bf73e7a271955582834fda9e707429d/compiler%2Frustc_codegen_ssa%2Fsrc%2Ftarget_features.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3f5f54cd8bf73e7a271955582834fda9e707429d/compiler%2Frustc_codegen_ssa%2Fsrc%2Ftarget_features.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_ssa%2Fsrc%2Ftarget_features.rs?ref=3f5f54cd8bf73e7a271955582834fda9e707429d", "patch": "@@ -33,22 +33,95 @@ const ARM_ALLOWED_FEATURES: &[(&str, Option<Symbol>)] = &[\n     (\"thumb-mode\", Some(sym::arm_target_feature)),\n ];\n \n+// Commented features are not available in LLVM 9.0, or have since been renamed\n const AARCH64_ALLOWED_FEATURES: &[(&str, Option<Symbol>)] = &[\n-    (\"fp\", Some(sym::aarch64_target_feature)),\n+    // FEAT_AdvSimd\n     (\"neon\", Some(sym::aarch64_target_feature)),\n+    // FEAT_FP\n+    (\"fp\", Some(sym::aarch64_target_feature)),\n+    // FEAT_FP16\n+    (\"fp16\", Some(sym::aarch64_target_feature)),\n+    // FEAT_SVE\n     (\"sve\", Some(sym::aarch64_target_feature)),\n+    // FEAT_CRC\n     (\"crc\", Some(sym::aarch64_target_feature)),\n+    // Cryptographic extension\n     (\"crypto\", Some(sym::aarch64_target_feature)),\n+    // FEAT_RAS\n     (\"ras\", Some(sym::aarch64_target_feature)),\n+    // FEAT_LSE\n     (\"lse\", Some(sym::aarch64_target_feature)),\n+    // FEAT_LSE2\n+    // (\"lse2\", Some(sym::aarch64_target_feature)),\n+    // FEAT_RDM\n     (\"rdm\", Some(sym::aarch64_target_feature)),\n-    (\"fp16\", Some(sym::aarch64_target_feature)),\n+    // FEAT_RCPC\n     (\"rcpc\", Some(sym::aarch64_target_feature)),\n+    // FEAT_RCPC2\n+    (\"rcpc2\", Some(sym::aarch64_target_feature)),\n+    // FEAT_DotProd\n     (\"dotprod\", Some(sym::aarch64_target_feature)),\n+    // FEAT_TME\n     (\"tme\", Some(sym::aarch64_target_feature)),\n+    // FEAT_FHM\n+    (\"fhm\", Some(sym::aarch64_target_feature)),\n+    // FEAT_DIT\n+    (\"dit\", Some(sym::aarch64_target_feature)),\n+    // FEAT_FLAGM\n+    // (\"flagm\", Some(sym::aarch64_target_feature)),\n+    // FEAT_SSBS\n+    (\"ssbs\", Some(sym::aarch64_target_feature)),\n+    // FEAT_SB\n+    (\"sb\", Some(sym::aarch64_target_feature)),\n+    // FEAT_PAUTH\n+    // (\"pauth\", Some(sym::aarch64_target_feature)),\n+    // FEAT_DPB\n+    (\"dpb\", Some(sym::aarch64_target_feature)),\n+    // FEAT_DPB2\n+    (\"dpb2\", Some(sym::aarch64_target_feature)),\n+    // FEAT_SVE2\n+    (\"sve2\", Some(sym::aarch64_target_feature)),\n+    // FEAT_SVE2_AES\n+    (\"sve2-aes\", Some(sym::aarch64_target_feature)),\n+    // FEAT_SVE2_SM4\n+    (\"sve2-sm4\", Some(sym::aarch64_target_feature)),\n+    // FEAT_SVE2_SHA3\n+    (\"sve2-sha3\", Some(sym::aarch64_target_feature)),\n+    // FEAT_SVE2_BitPerm\n+    (\"sve2-bitperm\", Some(sym::aarch64_target_feature)),\n+    // FEAT_FRINTTS\n+    (\"fptoint\", Some(sym::aarch64_target_feature)),\n+    // FEAT_I8MM\n+    // (\"i8mm\", Some(sym::aarch64_target_feature)),\n+    // FEAT_F32MM\n+    // (\"f32mm\", Some(sym::aarch64_target_feature)),\n+    // FEAT_F64MM\n+    // (\"f64mm\", Some(sym::aarch64_target_feature)),\n+    // FEAT_BF16\n+    // (\"bf16\", Some(sym::aarch64_target_feature)),\n+    // FEAT_RAND\n+    (\"rand\", Some(sym::aarch64_target_feature)),\n+    // FEAT_BTI\n+    (\"bti\", Some(sym::aarch64_target_feature)),\n+    // FEAT_MTE\n+    (\"mte\", Some(sym::aarch64_target_feature)),\n+    // FEAT_JSCVT\n+    (\"jsconv\", Some(sym::aarch64_target_feature)),\n+    // FEAT_FCMA\n+    (\"fcma\", Some(sym::aarch64_target_feature)),\n+    // FEAT_SHA1 & FEAT_SHA256\n+    (\"sha2\", Some(sym::aarch64_target_feature)),\n+    // FEAT_SHA512 & FEAT_SHA3\n+    (\"sha3\", Some(sym::aarch64_target_feature)),\n+    // FEAT_SM3 & FEAT_SM4\n+    (\"sm4\", Some(sym::aarch64_target_feature)),\n     (\"v8.1a\", Some(sym::aarch64_target_feature)),\n     (\"v8.2a\", Some(sym::aarch64_target_feature)),\n     (\"v8.3a\", Some(sym::aarch64_target_feature)),\n+    (\"v8.4a\", Some(sym::aarch64_target_feature)),\n+    (\"v8.5a\", Some(sym::aarch64_target_feature)),\n+    // (\"v8.6a\", Some(sym::aarch64_target_feature)),\n+    // (\"v8.7a\", Some(sym::aarch64_target_feature)),\n ];\n \n const X86_ALLOWED_FEATURES: &[(&str, Option<Symbol>)] = &["}]}