{"sha": "15b1daaca3fd4020d7a93cff14507b9104ec6d02", "node_id": "C_kwDOAAsO6NoAKDE1YjFkYWFjYTNmZDQwMjBkN2E5M2NmZjE0NTA3YjkxMDRlYzZkMDI", "commit": {"author": {"name": "Luqman Aden", "email": "me@luqman.ca", "date": "2022-08-07T20:55:36Z"}, "committer": {"name": "Luqman Aden", "email": "me@luqman.ca", "date": "2022-08-07T21:01:04Z"}, "message": "Add UI test for #100199", "tree": {"sha": "9cdf293748b03347745b4ebdaa18b526f145c880", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9cdf293748b03347745b4ebdaa18b526f145c880"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/15b1daaca3fd4020d7a93cff14507b9104ec6d02", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/15b1daaca3fd4020d7a93cff14507b9104ec6d02", "html_url": "https://github.com/rust-lang/rust/commit/15b1daaca3fd4020d7a93cff14507b9104ec6d02", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/15b1daaca3fd4020d7a93cff14507b9104ec6d02/comments", "author": {"login": "luqmana", "id": 287063, "node_id": "MDQ6VXNlcjI4NzA2Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/287063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luqmana", "html_url": "https://github.com/luqmana", "followers_url": "https://api.github.com/users/luqmana/followers", "following_url": "https://api.github.com/users/luqmana/following{/other_user}", "gists_url": "https://api.github.com/users/luqmana/gists{/gist_id}", "starred_url": "https://api.github.com/users/luqmana/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luqmana/subscriptions", "organizations_url": "https://api.github.com/users/luqmana/orgs", "repos_url": "https://api.github.com/users/luqmana/repos", "events_url": "https://api.github.com/users/luqmana/events{/privacy}", "received_events_url": "https://api.github.com/users/luqmana/received_events", "type": "User", "site_admin": false}, "committer": {"login": "luqmana", "id": 287063, "node_id": "MDQ6VXNlcjI4NzA2Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/287063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luqmana", "html_url": "https://github.com/luqmana", "followers_url": "https://api.github.com/users/luqmana/followers", "following_url": "https://api.github.com/users/luqmana/following{/other_user}", "gists_url": "https://api.github.com/users/luqmana/gists{/gist_id}", "starred_url": "https://api.github.com/users/luqmana/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luqmana/subscriptions", "organizations_url": "https://api.github.com/users/luqmana/orgs", "repos_url": "https://api.github.com/users/luqmana/repos", "events_url": "https://api.github.com/users/luqmana/events{/privacy}", "received_events_url": "https://api.github.com/users/luqmana/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fc83a0cb57eaad7104cc8861ba354fc76da79684", "url": "https://api.github.com/repos/rust-lang/rust/commits/fc83a0cb57eaad7104cc8861ba354fc76da79684", "html_url": "https://github.com/rust-lang/rust/commit/fc83a0cb57eaad7104cc8861ba354fc76da79684"}], "stats": {"total": 49, "additions": 49, "deletions": 0}, "files": [{"sha": "9e190b542db49d438e79e22717355b363d538767", "filename": "src/test/ui/macros/auxiliary/issue-100199.rs", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/15b1daaca3fd4020d7a93cff14507b9104ec6d02/src%2Ftest%2Fui%2Fmacros%2Fauxiliary%2Fissue-100199.rs", "raw_url": "https://github.com/rust-lang/rust/raw/15b1daaca3fd4020d7a93cff14507b9104ec6d02/src%2Ftest%2Fui%2Fmacros%2Fauxiliary%2Fissue-100199.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Fauxiliary%2Fissue-100199.rs?ref=15b1daaca3fd4020d7a93cff14507b9104ec6d02", "patch": "@@ -0,0 +1,18 @@\n+// force-host\n+// no-prefer-dynamic\n+\n+#![crate_type = \"proc-macro\"]\n+#![feature(proc_macro_quote)]\n+\n+extern crate proc_macro;\n+\n+use proc_macro::{quote, Ident, Span, TokenStream, TokenTree};\n+\n+#[proc_macro_attribute]\n+pub fn struct_with_bound(_: TokenStream, _: TokenStream) -> TokenStream {\n+    let crate_ident = TokenTree::Ident(Ident::new(\"crate\", Span::call_site()));\n+    let trait_ident = TokenTree::Ident(Ident::new(\"MyTrait\", Span::call_site()));\n+    quote!(\n+        struct Foo<T: $crate_ident::$trait_ident> {}\n+    )\n+}"}, {"sha": "6e50afa075984b181f266a0aea8ca93dee13bcfe", "filename": "src/test/ui/macros/issue-100199.rs", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/15b1daaca3fd4020d7a93cff14507b9104ec6d02/src%2Ftest%2Fui%2Fmacros%2Fissue-100199.rs", "raw_url": "https://github.com/rust-lang/rust/raw/15b1daaca3fd4020d7a93cff14507b9104ec6d02/src%2Ftest%2Fui%2Fmacros%2Fissue-100199.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Fissue-100199.rs?ref=15b1daaca3fd4020d7a93cff14507b9104ec6d02", "patch": "@@ -0,0 +1,16 @@\n+#[issue_100199::struct_with_bound] //~ ERROR cannot find trait `MyTrait` in the crate root\n+struct Foo {}\n+// The above must be on the first line so that it's span points to pos 0.\n+// This used to trigger an ICE because the diagnostic emitter would get\n+// an unexpected dummy span (lo == 0 == hi) while attempting to print a\n+// suggestion.\n+\n+// aux-build: issue-100199.rs\n+\n+extern crate issue_100199;\n+\n+mod traits {\n+    pub trait MyTrait {}\n+}\n+\n+fn main() {}"}, {"sha": "2cb45dc12473ef52311aeb7cfa4bda97292a1a54", "filename": "src/test/ui/macros/issue-100199.stderr", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/15b1daaca3fd4020d7a93cff14507b9104ec6d02/src%2Ftest%2Fui%2Fmacros%2Fissue-100199.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/15b1daaca3fd4020d7a93cff14507b9104ec6d02/src%2Ftest%2Fui%2Fmacros%2Fissue-100199.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Fissue-100199.stderr?ref=15b1daaca3fd4020d7a93cff14507b9104ec6d02", "patch": "@@ -0,0 +1,15 @@\n+error[E0405]: cannot find trait `MyTrait` in the crate root\n+  --> $DIR/issue-100199.rs:1:1\n+   |\n+LL | #[issue_100199::struct_with_bound]\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ not found in the crate root\n+   |\n+   = note: this error originates in the attribute macro `issue_100199::struct_with_bound` (in Nightly builds, run with -Z macro-backtrace for more info)\n+help: consider importing this trait\n+   |\n+LL | use traits::MyTrait;\n+   |\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0405`."}]}