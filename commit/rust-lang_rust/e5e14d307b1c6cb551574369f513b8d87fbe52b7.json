{"sha": "e5e14d307b1c6cb551574369f513b8d87fbe52b7", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU1ZTE0ZDMwN2IxYzZjYjU1MTU3NDM2OWY1MTNiOGQ4N2ZiZTUyYjc=", "commit": {"author": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2018-08-12T19:21:53Z"}, "committer": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2018-08-15T20:05:01Z"}, "message": "When closure with no arguments was expected, suggest wrapping", "tree": {"sha": "ad27d149823c06a2a2f8fad299a13bd04c79e7d3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ad27d149823c06a2a2f8fad299a13bd04c79e7d3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e5e14d307b1c6cb551574369f513b8d87fbe52b7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e5e14d307b1c6cb551574369f513b8d87fbe52b7", "html_url": "https://github.com/rust-lang/rust/commit/e5e14d307b1c6cb551574369f513b8d87fbe52b7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e5e14d307b1c6cb551574369f513b8d87fbe52b7/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0f4b4987cd6dea5406dec0634770839fb31ce72c", "url": "https://api.github.com/repos/rust-lang/rust/commits/0f4b4987cd6dea5406dec0634770839fb31ce72c", "html_url": "https://github.com/rust-lang/rust/commit/0f4b4987cd6dea5406dec0634770839fb31ce72c"}], "stats": {"total": 60, "additions": 53, "deletions": 7}, "files": [{"sha": "3ebd10a920919cde757e38cfa57e85a1dca2f0fd", "filename": "src/libcore/ops/function.rs", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/e5e14d307b1c6cb551574369f513b8d87fbe52b7/src%2Flibcore%2Fops%2Ffunction.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e5e14d307b1c6cb551574369f513b8d87fbe52b7/src%2Flibcore%2Fops%2Ffunction.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fops%2Ffunction.rs?ref=e5e14d307b1c6cb551574369f513b8d87fbe52b7", "patch": "@@ -66,6 +66,11 @@\n #[lang = \"fn\"]\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n #[rustc_paren_sugar]\n+#[rustc_on_unimplemented(\n+    on(Args=\"()\", note=\"wrap the `{Self}` in a closure with no arguments: `|| {{ /* code */ }}\"),\n+    message=\"expected a `{Fn}<{Args}>` closure, found `{Self}`\",\n+    label=\"expected an `Fn<{Args}>` closure, found `{Self}`\",\n+)]\n #[fundamental] // so that regex can rely that `&str: !FnMut`\n pub trait Fn<Args> : FnMut<Args> {\n     /// Performs the call operation.\n@@ -139,6 +144,11 @@ pub trait Fn<Args> : FnMut<Args> {\n #[lang = \"fn_mut\"]\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n #[rustc_paren_sugar]\n+#[rustc_on_unimplemented(\n+    on(Args=\"()\", note=\"wrap the `{Self}` in a closure with no arguments: `|| {{ /* code */ }}\"),\n+    message=\"expected a `{FnMut}<{Args}>` closure, found `{Self}`\",\n+    label=\"expected an `FnMut<{Args}>` closure, found `{Self}`\",\n+)]\n #[fundamental] // so that regex can rely that `&str: !FnMut`\n pub trait FnMut<Args> : FnOnce<Args> {\n     /// Performs the call operation.\n@@ -212,6 +222,11 @@ pub trait FnMut<Args> : FnOnce<Args> {\n #[lang = \"fn_once\"]\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n #[rustc_paren_sugar]\n+#[rustc_on_unimplemented(\n+    on(Args=\"()\", note=\"wrap the `{Self}` in a closure with no arguments: `|| {{ /* code */ }}\"),\n+    message=\"expected a `{FnOnce}<{Args}>` closure, found `{Self}`\",\n+    label=\"expected an `FnOnce<{Args}>` closure, found `{Self}`\",\n+)]\n #[fundamental] // so that regex can rely that `&str: !FnMut`\n pub trait FnOnce<Args> {\n     /// The returned type after the call operator is used."}, {"sha": "ff52948ca8559f6482cc965c8de3ca399541a576", "filename": "src/test/ui/closure-expected.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/e5e14d307b1c6cb551574369f513b8d87fbe52b7/src%2Ftest%2Fui%2Fclosure-expected.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e5e14d307b1c6cb551574369f513b8d87fbe52b7/src%2Ftest%2Fui%2Fclosure-expected.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fclosure-expected.rs?ref=e5e14d307b1c6cb551574369f513b8d87fbe52b7", "patch": "@@ -0,0 +1,15 @@\n+// Copyright 2018 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+fn main() {\n+    let x = Some(1);\n+    let y = x.or_else(4);\n+    //~^ ERROR expected a `std::ops::FnOnce<()>` closure, found `{integer}`\n+}"}, {"sha": "0da506b5b8139262e7c7621312a6d5d0ae913c28", "filename": "src/test/ui/closure-expected.stderr", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/e5e14d307b1c6cb551574369f513b8d87fbe52b7/src%2Ftest%2Fui%2Fclosure-expected.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e5e14d307b1c6cb551574369f513b8d87fbe52b7/src%2Ftest%2Fui%2Fclosure-expected.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fclosure-expected.stderr?ref=e5e14d307b1c6cb551574369f513b8d87fbe52b7", "patch": "@@ -0,0 +1,12 @@\n+error[E0277]: expected a `std::ops::FnOnce<()>` closure, found `{integer}`\n+  --> $DIR/closure-expected.rs:13:15\n+   |\n+LL |     let y = x.or_else(4);\n+   |               ^^^^^^^ expected an `FnOnce<()>` closure, found `{integer}`\n+   |\n+   = help: the trait `std::ops::FnOnce<()>` is not implemented for `{integer}`\n+   = note: wrap the `{integer}` in a closure with no arguments: `|| { /* code */ }\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0277`."}, {"sha": "ea313385c10185caf87aecdc37ee3de8b93c8559", "filename": "src/test/ui/extern/extern-wrong-value-type.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e5e14d307b1c6cb551574369f513b8d87fbe52b7/src%2Ftest%2Fui%2Fextern%2Fextern-wrong-value-type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e5e14d307b1c6cb551574369f513b8d87fbe52b7/src%2Ftest%2Fui%2Fextern%2Fextern-wrong-value-type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fextern%2Fextern-wrong-value-type.rs?ref=e5e14d307b1c6cb551574369f513b8d87fbe52b7", "patch": "@@ -17,5 +17,5 @@ fn main() {\n     // extern functions are extern \"C\" fn\n     let _x: extern \"C\" fn() = f; // OK\n     is_fn(f);\n-    //~^ ERROR `extern \"C\" fn() {f}: std::ops::Fn<()>` is not satisfied\n+    //~^ ERROR expected a `std::ops::Fn<()>` closure, found `extern \"C\" fn() {f}`\n }"}, {"sha": "ac7b0a609846281197761aacb176cf6efff8529a", "filename": "src/test/ui/fn/fn-trait-formatting.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e5e14d307b1c6cb551574369f513b8d87fbe52b7/src%2Ftest%2Fui%2Ffn%2Ffn-trait-formatting.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e5e14d307b1c6cb551574369f513b8d87fbe52b7/src%2Ftest%2Fui%2Ffn%2Ffn-trait-formatting.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffn%2Ffn-trait-formatting.rs?ref=e5e14d307b1c6cb551574369f513b8d87fbe52b7", "patch": "@@ -27,5 +27,5 @@ fn main() {\n     //~| found type `std::boxed::Box<dyn std::ops::FnMut() -> isize>`\n \n     needs_fn(1);\n-    //~^ ERROR : std::ops::Fn<(isize,)>`\n+    //~^ ERROR expected a `std::ops::Fn<(isize,)>` closure, found `{integer}`\n }"}, {"sha": "2708de2c13a8fc185408a838cdad805c590489b6", "filename": "src/test/ui/issues/issue-22034.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e5e14d307b1c6cb551574369f513b8d87fbe52b7/src%2Ftest%2Fui%2Fissues%2Fissue-22034.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e5e14d307b1c6cb551574369f513b8d87fbe52b7/src%2Ftest%2Fui%2Fissues%2Fissue-22034.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-22034.rs?ref=e5e14d307b1c6cb551574369f513b8d87fbe52b7", "patch": "@@ -16,6 +16,6 @@ fn main() {\n     let ptr: *mut () = 0 as *mut _;\n     let _: &mut Fn() = unsafe {\n         &mut *(ptr as *mut Fn())\n-        //~^ ERROR `(): std::ops::Fn<()>` is not satisfied\n+        //~^ ERROR expected a `std::ops::Fn<()>` closure, found `()`\n     };\n }"}, {"sha": "da376fedbb98af5313eadeac191d0794e19e2100", "filename": "src/test/ui/issues/issue-22034.stderr", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/e5e14d307b1c6cb551574369f513b8d87fbe52b7/src%2Ftest%2Fui%2Fissues%2Fissue-22034.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e5e14d307b1c6cb551574369f513b8d87fbe52b7/src%2Ftest%2Fui%2Fissues%2Fissue-22034.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-22034.stderr?ref=e5e14d307b1c6cb551574369f513b8d87fbe52b7", "patch": "@@ -1,9 +1,11 @@\n-error[E0277]: the trait bound `(): std::ops::Fn<()>` is not satisfied\n+error[E0277]: expected a `std::ops::Fn<()>` closure, found `()`\n   --> $DIR/issue-22034.rs:18:16\n    |\n LL |         &mut *(ptr as *mut Fn())\n-   |                ^^^ the trait `std::ops::Fn<()>` is not implemented for `()`\n+   |                ^^^ expected an `Fn<()>` closure, found `()`\n    |\n+   = help: the trait `std::ops::Fn<()>` is not implemented for `()`\n+   = note: wrap the `()` in a closure with no arguments: `|| { /* code */ }\n    = note: required for the cast to the object type `dyn std::ops::Fn()`\n \n error: aborting due to previous error"}, {"sha": "0418933180c00b97dbd96bafb89cf62f1d711370", "filename": "src/test/ui/issues/issue-23966.stderr", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/e5e14d307b1c6cb551574369f513b8d87fbe52b7/src%2Ftest%2Fui%2Fissues%2Fissue-23966.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e5e14d307b1c6cb551574369f513b8d87fbe52b7/src%2Ftest%2Fui%2Fissues%2Fissue-23966.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-23966.stderr?ref=e5e14d307b1c6cb551574369f513b8d87fbe52b7", "patch": "@@ -1,8 +1,10 @@\n-error[E0277]: the trait bound `(): std::ops::FnMut<(_, char)>` is not satisfied\n+error[E0277]: expected a `std::ops::FnMut<(_, char)>` closure, found `()`\n   --> $DIR/issue-23966.rs:12:16\n    |\n LL |     \"\".chars().fold(|_, _| (), ());\n-   |                ^^^^ the trait `std::ops::FnMut<(_, char)>` is not implemented for `()`\n+   |                ^^^^ expected an `FnMut<(_, char)>` closure, found `()`\n+   |\n+   = help: the trait `std::ops::FnMut<(_, char)>` is not implemented for `()`\n \n error: aborting due to previous error\n "}]}