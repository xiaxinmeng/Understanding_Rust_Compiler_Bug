{"sha": "fad826f9661e321f74ce2d837103114271b132d1", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZhZDgyNmY5NjYxZTMyMWY3NGNlMmQ4MzcxMDMxMTQyNzFiMTMyZDE=", "commit": {"author": {"name": "Tim Neumann", "email": "timnn@google.com", "date": "2018-04-07T20:18:51Z"}, "committer": {"name": "Tim Neumann", "email": "timnn@google.com", "date": "2018-04-07T20:18:51Z"}, "message": "allow invalid UTF-8 in bytes Regexes", "tree": {"sha": "95e5c37540f1c45ce29a73c443ca649794d58c78", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/95e5c37540f1c45ce29a73c443ca649794d58c78"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fad826f9661e321f74ce2d837103114271b132d1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fad826f9661e321f74ce2d837103114271b132d1", "html_url": "https://github.com/rust-lang/rust/commit/fad826f9661e321f74ce2d837103114271b132d1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fad826f9661e321f74ce2d837103114271b132d1/comments", "author": {"login": "TimNN", "id": 1178249, "node_id": "MDQ6VXNlcjExNzgyNDk=", "avatar_url": "https://avatars.githubusercontent.com/u/1178249?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TimNN", "html_url": "https://github.com/TimNN", "followers_url": "https://api.github.com/users/TimNN/followers", "following_url": "https://api.github.com/users/TimNN/following{/other_user}", "gists_url": "https://api.github.com/users/TimNN/gists{/gist_id}", "starred_url": "https://api.github.com/users/TimNN/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TimNN/subscriptions", "organizations_url": "https://api.github.com/users/TimNN/orgs", "repos_url": "https://api.github.com/users/TimNN/repos", "events_url": "https://api.github.com/users/TimNN/events{/privacy}", "received_events_url": "https://api.github.com/users/TimNN/received_events", "type": "User", "site_admin": false}, "committer": {"login": "TimNN", "id": 1178249, "node_id": "MDQ6VXNlcjExNzgyNDk=", "avatar_url": "https://avatars.githubusercontent.com/u/1178249?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TimNN", "html_url": "https://github.com/TimNN", "followers_url": "https://api.github.com/users/TimNN/followers", "following_url": "https://api.github.com/users/TimNN/following{/other_user}", "gists_url": "https://api.github.com/users/TimNN/gists{/gist_id}", "starred_url": "https://api.github.com/users/TimNN/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TimNN/subscriptions", "organizations_url": "https://api.github.com/users/TimNN/orgs", "repos_url": "https://api.github.com/users/TimNN/repos", "events_url": "https://api.github.com/users/TimNN/events{/privacy}", "received_events_url": "https://api.github.com/users/TimNN/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "22df45f1ac5e7574c3afa655a370f603c8c0cdf1", "url": "https://api.github.com/repos/rust-lang/rust/commits/22df45f1ac5e7574c3afa655a370f603c8c0cdf1", "html_url": "https://github.com/rust-lang/rust/commit/22df45f1ac5e7574c3afa655a370f603c8c0cdf1"}], "stats": {"total": 66, "additions": 35, "deletions": 31}, "files": [{"sha": "26c1e2b244e3de3eb34b6a47ba99227610696c89", "filename": "clippy_lints/src/regex.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/fad826f9661e321f74ce2d837103114271b132d1/clippy_lints%2Fsrc%2Fregex.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fad826f9661e321f74ce2d837103114271b132d1/clippy_lints%2Fsrc%2Fregex.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fregex.rs?ref=fad826f9661e321f74ce2d837103114271b132d1", "patch": "@@ -187,7 +187,10 @@ fn check_set<'a, 'tcx>(cx: &LateContext<'a, 'tcx>, expr: &'tcx Expr, utf8: bool)\n }\n \n fn check_regex<'a, 'tcx>(cx: &LateContext<'a, 'tcx>, expr: &'tcx Expr, utf8: bool) {\n-    let mut parser = regex_syntax::ParserBuilder::new().unicode(utf8).build();\n+    let mut parser = regex_syntax::ParserBuilder::new()\n+        .unicode(utf8)\n+        .allow_invalid_utf8(!utf8)\n+        .build();\n \n     if let ExprLit(ref lit) = expr.node {\n         if let LitKind::Str(ref r, style) = lit.node {"}, {"sha": "b80aaa2df320d8700fc3b5079e7b7c6d5b751eaa", "filename": "tests/ui/regex.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/fad826f9661e321f74ce2d837103114271b132d1/tests%2Fui%2Fregex.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fad826f9661e321f74ce2d837103114271b132d1/tests%2Fui%2Fregex.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fregex.rs?ref=fad826f9661e321f74ce2d837103114271b132d1", "patch": "@@ -34,6 +34,7 @@ fn syntax_error() {\n     let bset = BRegexSet::new(&[\n         r\"[a-z]+@[a-z]+\\.(com|org|net)\",\n         r\"[a-z]+\\.(com|org|net)\",\n+        r\".\", // regression test\n     ]);\n \n     let set_error = RegexSet::new(&["}, {"sha": "39c360583e7d33a2c46e68415a4d46261e8006bf", "filename": "tests/ui/regex.stderr", "status": "modified", "additions": 30, "deletions": 30, "changes": 60, "blob_url": "https://github.com/rust-lang/rust/blob/fad826f9661e321f74ce2d837103114271b132d1/tests%2Fui%2Fregex.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fad826f9661e321f74ce2d837103114271b132d1/tests%2Fui%2Fregex.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fregex.stderr?ref=fad826f9661e321f74ce2d837103114271b132d1", "patch": "@@ -56,113 +56,113 @@ error: regex syntax error on position 0: unclosed group\n    |                                                        ^^^^^^^^^^^^^\n \n error: regex syntax error on position 0: unclosed group\n-  --> $DIR/regex.rs:40:9\n+  --> $DIR/regex.rs:41:9\n    |\n-40 |         OPENING_PAREN,\n+41 |         OPENING_PAREN,\n    |         ^^^^^^^^^^^^^\n \n error: regex syntax error on position 0: unclosed group\n-  --> $DIR/regex.rs:44:9\n+  --> $DIR/regex.rs:45:9\n    |\n-44 |         OPENING_PAREN,\n+45 |         OPENING_PAREN,\n    |         ^^^^^^^^^^^^^\n \n error: regex syntax error: unrecognized escape sequence\n-  --> $DIR/regex.rs:48:45\n+  --> $DIR/regex.rs:49:45\n    |\n-48 |     let raw_string_error = Regex::new(r\"[...//...]\");\n+49 |     let raw_string_error = Regex::new(r\"[...//...]\");\n    |                                             ^^\n \n error: regex syntax error: unrecognized escape sequence\n-  --> $DIR/regex.rs:49:46\n+  --> $DIR/regex.rs:50:46\n    |\n-49 |     let raw_string_error = Regex::new(r#\"[...//...]\"#);\n+50 |     let raw_string_error = Regex::new(r#\"[...//...]\"#);\n    |                                              ^^\n \n error: trivial regex\n-  --> $DIR/regex.rs:53:33\n+  --> $DIR/regex.rs:54:33\n    |\n-53 |     let trivial_eq = Regex::new(\"^foobar$\");\n+54 |     let trivial_eq = Regex::new(\"^foobar$\");\n    |                                 ^^^^^^^^^^\n    |\n    = help: consider using `==` on `str`s\n \n error: trivial regex\n-  --> $DIR/regex.rs:55:48\n+  --> $DIR/regex.rs:56:48\n    |\n-55 |     let trivial_eq_builder = RegexBuilder::new(\"^foobar$\");\n+56 |     let trivial_eq_builder = RegexBuilder::new(\"^foobar$\");\n    |                                                ^^^^^^^^^^\n    |\n    = help: consider using `==` on `str`s\n \n error: trivial regex\n-  --> $DIR/regex.rs:57:42\n+  --> $DIR/regex.rs:58:42\n    |\n-57 |     let trivial_starts_with = Regex::new(\"^foobar\");\n+58 |     let trivial_starts_with = Regex::new(\"^foobar\");\n    |                                          ^^^^^^^^^\n    |\n    = help: consider using `str::starts_with`\n \n error: trivial regex\n-  --> $DIR/regex.rs:59:40\n+  --> $DIR/regex.rs:60:40\n    |\n-59 |     let trivial_ends_with = Regex::new(\"foobar$\");\n+60 |     let trivial_ends_with = Regex::new(\"foobar$\");\n    |                                        ^^^^^^^^^\n    |\n    = help: consider using `str::ends_with`\n \n error: trivial regex\n-  --> $DIR/regex.rs:61:39\n+  --> $DIR/regex.rs:62:39\n    |\n-61 |     let trivial_contains = Regex::new(\"foobar\");\n+62 |     let trivial_contains = Regex::new(\"foobar\");\n    |                                       ^^^^^^^^\n    |\n    = help: consider using `str::contains`\n \n error: trivial regex\n-  --> $DIR/regex.rs:63:39\n+  --> $DIR/regex.rs:64:39\n    |\n-63 |     let trivial_contains = Regex::new(NOT_A_REAL_REGEX);\n+64 |     let trivial_contains = Regex::new(NOT_A_REAL_REGEX);\n    |                                       ^^^^^^^^^^^^^^^^\n    |\n    = help: consider using `str::contains`\n \n error: trivial regex\n-  --> $DIR/regex.rs:65:40\n+  --> $DIR/regex.rs:66:40\n    |\n-65 |     let trivial_backslash = Regex::new(\"a/.b\");\n+66 |     let trivial_backslash = Regex::new(\"a/.b\");\n    |                                        ^^^^^^^\n    |\n    = help: consider using `str::contains`\n \n error: trivial regex\n-  --> $DIR/regex.rs:68:36\n+  --> $DIR/regex.rs:69:36\n    |\n-68 |     let trivial_empty = Regex::new(\"\");\n+69 |     let trivial_empty = Regex::new(\"\");\n    |                                    ^^\n    |\n    = help: the regex is unlikely to be useful as it is\n \n error: trivial regex\n-  --> $DIR/regex.rs:70:36\n+  --> $DIR/regex.rs:71:36\n    |\n-70 |     let trivial_empty = Regex::new(\"^\");\n+71 |     let trivial_empty = Regex::new(\"^\");\n    |                                    ^^^\n    |\n    = help: the regex is unlikely to be useful as it is\n \n error: trivial regex\n-  --> $DIR/regex.rs:72:36\n+  --> $DIR/regex.rs:73:36\n    |\n-72 |     let trivial_empty = Regex::new(\"^$\");\n+73 |     let trivial_empty = Regex::new(\"^$\");\n    |                                    ^^^^\n    |\n    = help: consider using `str::is_empty`\n \n error: trivial regex\n-  --> $DIR/regex.rs:74:44\n+  --> $DIR/regex.rs:75:44\n    |\n-74 |     let binary_trivial_empty = BRegex::new(\"^$\");\n+75 |     let binary_trivial_empty = BRegex::new(\"^$\");\n    |                                            ^^^^\n    |\n    = help: consider using `str::is_empty`"}]}