{"sha": "a3418933c6d8252f986194f85bf2a6dcca438207", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEzNDE4OTMzYzZkODI1MmY5ODYxOTRmODViZjJhNmRjY2E0MzgyMDc=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-08-18T07:27:09Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-08-28T05:23:23Z"}, "message": "Add run-rustfix for useless_attribute test", "tree": {"sha": "aaf385026a1b0642e928ac70c46e2bc930cd15b6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/aaf385026a1b0642e928ac70c46e2bc930cd15b6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a3418933c6d8252f986194f85bf2a6dcca438207", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJEBAABCgAuFiEEj4U0bmbiMSg/mWqvgqphyqETl+YFAl1mD84QHGRldkBwaGFu\nc2NoLm5ldAAKCRCCqmHKoROX5raSEADIGXeLlfTnIFwomPUkDzIsShp3uqzQZmKM\nKW5gmQZbQuG3S1NtzDibNmgLj0ZOqPh7yfrEI2lKneSPaiH7Xn5td0C4oQwIXAPO\nK/6zw2VT4y1Chb4sdlOjd292qtzIIp7Z8e766jvUNvckU49EM/7d51TlHBXlZePP\nYrv5DTJOvvaycsMKVz28TpMTJbOuplBb2oUWaa39jQH7DCrD62jb3DLr1AbbGHZx\nTLIpTHm2W9lJH/6hu1vQeakoqWk9afUkTmTaOiakyUL/cbwRnmrEf8NEYbyTtSj0\nlVscJTuby/pdqItKm+Pi3IuGJ1zATPl72EpGKOaoJDURp6wZ6su0NDahNqW9oX6v\ne3Pqtml76xMKjl7WRLc4MJaLTteIJSPwu1UHdlzBflRHjuXCC3bP/vrIUvZjHXyQ\nkF7o0Ekt/uKOh//R5oqc/79a0jTCP4BKrUqNIuGmlkNQL29qv07jh+oMkERczSTc\n1f+yL//cKfHehwlF284nRDcCy8Um2FhbZuQZh1u7yahtG8TMRIs5yqbpq7ic11lP\nkcHFukTdlbe/mH94HjOQJjzTRkQife8lfEtxrCssOz4MKsbVjx99Kz6GTqN2F1ai\n0zO7SOaJCZU1Jd2woe7wXAdaxRB5tgQ/3JViIE9IvoUdAHX/4VVeE7+/MltUbXFc\nsDd9uZRB2Q==\n=V6mM\n-----END PGP SIGNATURE-----", "payload": "tree aaf385026a1b0642e928ac70c46e2bc930cd15b6\nparent b6e87c6ae35febbf85b3834f41e4628e4088ccb4\nauthor Philipp Hansch <dev@phansch.net> 1566113229 +0200\ncommitter Philipp Hansch <dev@phansch.net> 1566969803 +0200\n\nAdd run-rustfix for useless_attribute test\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a3418933c6d8252f986194f85bf2a6dcca438207", "html_url": "https://github.com/rust-lang/rust/commit/a3418933c6d8252f986194f85bf2a6dcca438207", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a3418933c6d8252f986194f85bf2a6dcca438207/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b6e87c6ae35febbf85b3834f41e4628e4088ccb4", "url": "https://api.github.com/repos/rust-lang/rust/commits/b6e87c6ae35febbf85b3834f41e4628e4088ccb4", "html_url": "https://github.com/rust-lang/rust/commit/b6e87c6ae35febbf85b3834f41e4628e4088ccb4"}], "stats": {"total": 54, "additions": 52, "deletions": 2}, "files": [{"sha": "d729311e90704c03131fff17ee380a51dfc20860", "filename": "tests/ui/useless_attribute.fixed", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/rust-lang/rust/blob/a3418933c6d8252f986194f85bf2a6dcca438207/tests%2Fui%2Fuseless_attribute.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/a3418933c6d8252f986194f85bf2a6dcca438207/tests%2Fui%2Fuseless_attribute.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fuseless_attribute.fixed?ref=a3418933c6d8252f986194f85bf2a6dcca438207", "patch": "@@ -0,0 +1,49 @@\n+// run-rustfix\n+// aux-build:proc_macro_derive.rs\n+\n+#![warn(clippy::useless_attribute)]\n+#![warn(unreachable_pub)]\n+\n+#![allow(dead_code)]\n+#![cfg_attr(feature = \"cargo-clippy\", allow(dead_code))]\n+#[rustfmt::skip]\n+#[cfg_attr(feature = \"cargo-clippy\",\n+           allow(dead_code))]\n+#[allow(unused_imports)]\n+#[allow(unused_extern_crates)]\n+#[macro_use]\n+extern crate clippy_lints;\n+\n+#[macro_use]\n+extern crate proc_macro_derive;\n+\n+// don't lint on unused_import for `use` items\n+#[allow(unused_imports)]\n+use std::collections;\n+\n+// don't lint on deprecated for `use` items\n+mod foo {\n+    #[deprecated]\n+    pub struct Bar;\n+}\n+#[allow(deprecated)]\n+pub use foo::Bar;\n+\n+// This should not trigger the lint. There's lint level definitions inside the external derive\n+// that would trigger the useless_attribute lint.\n+#[derive(DeriveSomething)]\n+struct Baz;\n+\n+// don't lint on unreachable_pub for `use` items\n+mod a {\n+    mod b {\n+        #[allow(dead_code)]\n+        #[allow(unreachable_pub)]\n+        pub struct C {}\n+    }\n+\n+    #[allow(unreachable_pub)]\n+    pub use self::b::C;\n+}\n+\n+fn main() {}"}, {"sha": "c6fc553112729f68c38fb6ba6355d933df979bb7", "filename": "tests/ui/useless_attribute.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a3418933c6d8252f986194f85bf2a6dcca438207/tests%2Fui%2Fuseless_attribute.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a3418933c6d8252f986194f85bf2a6dcca438207/tests%2Fui%2Fuseless_attribute.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fuseless_attribute.rs?ref=a3418933c6d8252f986194f85bf2a6dcca438207", "patch": "@@ -1,3 +1,4 @@\n+// run-rustfix\n // aux-build:proc_macro_derive.rs\n \n #![warn(clippy::useless_attribute)]"}, {"sha": "87a1291543e158da0a3edb6d01d2bf4381519bcd", "filename": "tests/ui/useless_attribute.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a3418933c6d8252f986194f85bf2a6dcca438207/tests%2Fui%2Fuseless_attribute.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a3418933c6d8252f986194f85bf2a6dcca438207/tests%2Fui%2Fuseless_attribute.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fuseless_attribute.stderr?ref=a3418933c6d8252f986194f85bf2a6dcca438207", "patch": "@@ -1,13 +1,13 @@\n error: useless lint attribute\n-  --> $DIR/useless_attribute.rs:6:1\n+  --> $DIR/useless_attribute.rs:7:1\n    |\n LL | #[allow(dead_code)]\n    | ^^^^^^^^^^^^^^^^^^^ help: if you just forgot a `!`, use: `#![allow(dead_code)]`\n    |\n    = note: `-D clippy::useless-attribute` implied by `-D warnings`\n \n error: useless lint attribute\n-  --> $DIR/useless_attribute.rs:7:1\n+  --> $DIR/useless_attribute.rs:8:1\n    |\n LL | #[cfg_attr(feature = \"cargo-clippy\", allow(dead_code))]\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: if you just forgot a `!`, use: `#![cfg_attr(feature = \"cargo-clippy\", allow(dead_code)`"}]}