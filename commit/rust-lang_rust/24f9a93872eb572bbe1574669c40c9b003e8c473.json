{"sha": "24f9a93872eb572bbe1574669c40c9b003e8c473", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI0ZjlhOTM4NzJlYjU3MmJiZTE1NzQ2NjljNDBjOWIwMDNlOGM0NzM=", "commit": {"author": {"name": "Adrien T\u00e9tar", "email": "adri-from-59@hotmail.fr", "date": "2014-01-04T20:16:57Z"}, "committer": {"name": "Adrien T\u00e9tar", "email": "adri-from-59@hotmail.fr", "date": "2014-01-04T20:49:52Z"}, "message": "etc: licenseck: don't hardcode a specific year", "tree": {"sha": "99fc0ff3706a51d76d0cf489045090a6baf96034", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/99fc0ff3706a51d76d0cf489045090a6baf96034"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/24f9a93872eb572bbe1574669c40c9b003e8c473", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/24f9a93872eb572bbe1574669c40c9b003e8c473", "html_url": "https://github.com/rust-lang/rust/commit/24f9a93872eb572bbe1574669c40c9b003e8c473", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/24f9a93872eb572bbe1574669c40c9b003e8c473/comments", "author": {"login": "adrientetar", "id": 1250894, "node_id": "MDQ6VXNlcjEyNTA4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1250894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adrientetar", "html_url": "https://github.com/adrientetar", "followers_url": "https://api.github.com/users/adrientetar/followers", "following_url": "https://api.github.com/users/adrientetar/following{/other_user}", "gists_url": "https://api.github.com/users/adrientetar/gists{/gist_id}", "starred_url": "https://api.github.com/users/adrientetar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adrientetar/subscriptions", "organizations_url": "https://api.github.com/users/adrientetar/orgs", "repos_url": "https://api.github.com/users/adrientetar/repos", "events_url": "https://api.github.com/users/adrientetar/events{/privacy}", "received_events_url": "https://api.github.com/users/adrientetar/received_events", "type": "User", "site_admin": false}, "committer": {"login": "adrientetar", "id": 1250894, "node_id": "MDQ6VXNlcjEyNTA4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1250894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adrientetar", "html_url": "https://github.com/adrientetar", "followers_url": "https://api.github.com/users/adrientetar/followers", "following_url": "https://api.github.com/users/adrientetar/following{/other_user}", "gists_url": "https://api.github.com/users/adrientetar/gists{/gist_id}", "starred_url": "https://api.github.com/users/adrientetar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adrientetar/subscriptions", "organizations_url": "https://api.github.com/users/adrientetar/orgs", "repos_url": "https://api.github.com/users/adrientetar/repos", "events_url": "https://api.github.com/users/adrientetar/events{/privacy}", "received_events_url": "https://api.github.com/users/adrientetar/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b432e82515f4cc145cf41bbcb92ff9b874b23afe", "url": "https://api.github.com/repos/rust-lang/rust/commits/b432e82515f4cc145cf41bbcb92ff9b874b23afe", "html_url": "https://github.com/rust-lang/rust/commit/b432e82515f4cc145cf41bbcb92ff9b874b23afe"}], "stats": {"total": 79, "additions": 20, "deletions": 59}, "files": [{"sha": "b76238ca388bb8ef09c1f25d35d8c5ecdce58b0b", "filename": "src/compiletest/common.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/24f9a93872eb572bbe1574669c40c9b003e8c473/src%2Fcompiletest%2Fcommon.rs", "raw_url": "https://github.com/rust-lang/rust/raw/24f9a93872eb572bbe1574669c40c9b003e8c473/src%2Fcompiletest%2Fcommon.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcompiletest%2Fcommon.rs?ref=24f9a93872eb572bbe1574669c40c9b003e8c473", "patch": "@@ -1,5 +1,5 @@\n-// Copyright 2012-2013 The Rust Project Developers. See the\n-// COPYRIGHT file at the top-level directory of this distribution and at\n+// Copyright 2012-2013 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n // http://rust-lang.org/COPYRIGHT.\n //\n // Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or"}, {"sha": "d4a4f38cc63baca38560f6e610058c5e739374ff", "filename": "src/compiletest/header.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/24f9a93872eb572bbe1574669c40c9b003e8c473/src%2Fcompiletest%2Fheader.rs", "raw_url": "https://github.com/rust-lang/rust/raw/24f9a93872eb572bbe1574669c40c9b003e8c473/src%2Fcompiletest%2Fheader.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcompiletest%2Fheader.rs?ref=24f9a93872eb572bbe1574669c40c9b003e8c473", "patch": "@@ -1,5 +1,5 @@\n-// Copyright 2012-2013 The Rust Project Developers. See the\n-// COPYRIGHT file at the top-level directory of this distribution and at\n+// Copyright 2012-2013 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n // http://rust-lang.org/COPYRIGHT.\n //\n // Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or"}, {"sha": "6136c39bb7390d1faac457d0cd98d9e364fd1334", "filename": "src/compiletest/runtest.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/24f9a93872eb572bbe1574669c40c9b003e8c473/src%2Fcompiletest%2Fruntest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/24f9a93872eb572bbe1574669c40c9b003e8c473/src%2Fcompiletest%2Fruntest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcompiletest%2Fruntest.rs?ref=24f9a93872eb572bbe1574669c40c9b003e8c473", "patch": "@@ -1,5 +1,5 @@\n-// Copyright 2012-2013 The Rust Project Developers. See the\n-// COPYRIGHT file at the top-level directory of this distribution and at\n+// Copyright 2012-2013 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n // http://rust-lang.org/COPYRIGHT.\n //\n // Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or"}, {"sha": "b5a721c03ff099149bf22a51c12bb1767f9951d6", "filename": "src/etc/licenseck.py", "status": "modified", "additions": 12, "deletions": 51, "changes": 63, "blob_url": "https://github.com/rust-lang/rust/blob/24f9a93872eb572bbe1574669c40c9b003e8c473/src%2Fetc%2Flicenseck.py", "raw_url": "https://github.com/rust-lang/rust/raw/24f9a93872eb572bbe1574669c40c9b003e8c473/src%2Fetc%2Flicenseck.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Flicenseck.py?ref=24f9a93872eb572bbe1574669c40c9b003e8c473", "patch": "@@ -8,20 +8,8 @@\n # option. This file may not be copied, modified, or distributed\n # except according to those terms.\n \n-license0 = \"\"\"\\\n-// Copyright 2012-2013 The Rust Project Developers. See the\n-// COPYRIGHT file at the top-level directory of this distribution and at\n-// http://rust-lang.org/COPYRIGHT.\n-//\n-// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n-// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n-// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n-// option. This file may not be copied, modified, or distributed\n-// except according to those terms.\n-\"\"\"\n-\n-license1 = \"\"\"\\\n-// Copyright 2012 The Rust Project Developers. See the COPYRIGHT\n+license1 = \"\"\"// Copyright \"\"\"\n+license2 = \"\"\" The Rust Project Developers. See the COPYRIGHT\n // file at the top-level directory of this distribution and at\n // http://rust-lang.org/COPYRIGHT.\n //\n@@ -32,20 +20,8 @@\n // except according to those terms.\n \"\"\"\n \n-license2 = \"\"\"\\\n-// Copyright 2013 The Rust Project Developers. See the COPYRIGHT\n-// file at the top-level directory of this distribution and at\n-// http://rust-lang.org/COPYRIGHT.\n-//\n-// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n-// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n-// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n-// option. This file may not be copied, modified, or distributed\n-// except according to those terms.\n-\"\"\"\n-\n-license3 = \"\"\"\\\n-# Copyright 2013 The Rust Project Developers. See the COPYRIGHT\n+license3 = \"\"\"# Copyright \"\"\"\n+license4 = \"\"\" The Rust Project Developers. See the COPYRIGHT\n # file at the top-level directory of this distribution and at\n # http://rust-lang.org/COPYRIGHT.\n #\n@@ -56,20 +32,6 @@\n # except according to those terms.\n \"\"\"\n \n-license4 = \"\"\"\\\n-// Copyright 2012-2013 The Rust Project Developers. See the COPYRIGHT\n-// file at the top-level directory of this distribution and at\n-// http://rust-lang.org/COPYRIGHT.\n-//\n-// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n-// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n-// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n-// option. This file may not be copied, modified, or distributed\n-// except according to those terms.\n-\"\"\"\n-\n-licenses = [license0, license1, license2, license3, license4]\n-\n exceptions = [\n     \"rt/rust_android_dummy.cpp\", # BSD, chromium\n     \"rt/rust_android_dummy.h\", # BSD, chromium\n@@ -82,20 +44,19 @@\n ]\n \n def check_license(name, contents):\n-    valid_license = False\n-    for a_valid_license in licenses:\n-        if contents.startswith(a_valid_license):\n-            valid_license = True\n-            break\n-    if valid_license:\n-        return True\n-\n+    # Whitelist check\n     for exception in exceptions:\n         if name.endswith(exception):\n             return True\n \n+    # Xfail check\n     firstlineish = contents[:100]\n     if firstlineish.find(\"xfail-license\") != -1:\n         return True\n \n-    return False\n+    # License check\n+    boilerplate = contents[:500]\n+    if (boilerplate.find(license1) == -1 or boilerplate.find(license2) == -1) and \\\n+       (boilerplate.find(license3) == -1 or boilerplate.find(license4) == -1):\n+        return False\n+    return True\n\\ No newline at end of file"}, {"sha": "57da01ccad0fe8c42c6f3647917ddf1c14a50853", "filename": "src/libsyntax/ext/source_util.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/24f9a93872eb572bbe1574669c40c9b003e8c473/src%2Flibsyntax%2Fext%2Fsource_util.rs", "raw_url": "https://github.com/rust-lang/rust/raw/24f9a93872eb572bbe1574669c40c9b003e8c473/src%2Flibsyntax%2Fext%2Fsource_util.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fext%2Fsource_util.rs?ref=24f9a93872eb572bbe1574669c40c9b003e8c473", "patch": "@@ -1,5 +1,5 @@\n-// Copyright 2012-2013 The Rust Project Developers. See the\n-// COPYRIGHT file at the top-level directory of this distribution and at\n+// Copyright 2012-2013 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n // http://rust-lang.org/COPYRIGHT.\n //\n // Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or"}]}