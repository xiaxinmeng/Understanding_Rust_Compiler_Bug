{"sha": "a8162171fdc1a0400f340454ebbca8aa4cd90007", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE4MTYyMTcxZmRjMWEwNDAwZjM0MDQ1NGViYmNhOGFhNGNkOTAwMDc=", "commit": {"author": {"name": "Steve Klabnik", "email": "steve@steveklabnik.com", "date": "2016-05-07T19:35:17Z"}, "committer": {"name": "Steve Klabnik", "email": "steve@steveklabnik.com", "date": "2016-05-07T19:35:17Z"}, "message": "Rollup merge of #33336 - birkenfeld:issue-27361, r=sfackler\n\nparser: do not try to continue with `unsafe` on foreign fns\n\nThe changed line makes it look like `unsafe` is allowed, but the first statement of `parse_item_foreign_fn` is:\n\n```\nself.expect_keyword(keywords::Fn)?;\n```\n\nSo we get the strange \"expected one of `fn`, `pub`, `static`, or `unsafe`, found `unsafe`\".\n\nFixes: #27361", "tree": {"sha": "953a214e7272564c43654a953e3c20d64fd2aa89", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/953a214e7272564c43654a953e3c20d64fd2aa89"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a8162171fdc1a0400f340454ebbca8aa4cd90007", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a8162171fdc1a0400f340454ebbca8aa4cd90007", "html_url": "https://github.com/rust-lang/rust/commit/a8162171fdc1a0400f340454ebbca8aa4cd90007", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a8162171fdc1a0400f340454ebbca8aa4cd90007/comments", "author": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "committer": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b651b2c8af0bb98557a4f283a878c65b5ce25fc7", "url": "https://api.github.com/repos/rust-lang/rust/commits/b651b2c8af0bb98557a4f283a878c65b5ce25fc7", "html_url": "https://github.com/rust-lang/rust/commit/b651b2c8af0bb98557a4f283a878c65b5ce25fc7"}, {"sha": "b75f81c9b3f996100c72f9141dcf6161f8fc90f4", "url": "https://api.github.com/repos/rust-lang/rust/commits/b75f81c9b3f996100c72f9141dcf6161f8fc90f4", "html_url": "https://github.com/rust-lang/rust/commit/b75f81c9b3f996100c72f9141dcf6161f8fc90f4"}], "stats": {"total": 6, "additions": 3, "deletions": 3}, "files": [{"sha": "48368cc025c85cb7498a16aad0ef38edcaf8fba2", "filename": "src/libsyntax/parse/parser.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a8162171fdc1a0400f340454ebbca8aa4cd90007/src%2Flibsyntax%2Fparse%2Fparser.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8162171fdc1a0400f340454ebbca8aa4cd90007/src%2Flibsyntax%2Fparse%2Fparser.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Fparser.rs?ref=a8162171fdc1a0400f340454ebbca8aa4cd90007", "patch": "@@ -6013,7 +6013,7 @@ impl<'a> Parser<'a> {\n             // FOREIGN STATIC ITEM\n             return Ok(Some(self.parse_item_foreign_static(visibility, lo, attrs)?));\n         }\n-        if self.check_keyword(keywords::Fn) || self.check_keyword(keywords::Unsafe) {\n+        if self.check_keyword(keywords::Fn) {\n             // FOREIGN FUNCTION ITEM\n             return Ok(Some(self.parse_item_foreign_fn(visibility, lo, attrs)?));\n         }"}, {"sha": "acf7187cf436ff0d6ee06e40975c017099cc074f", "filename": "src/test/parse-fail/extern-no-fn.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a8162171fdc1a0400f340454ebbca8aa4cd90007/src%2Ftest%2Fparse-fail%2Fextern-no-fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8162171fdc1a0400f340454ebbca8aa4cd90007/src%2Ftest%2Fparse-fail%2Fextern-no-fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fparse-fail%2Fextern-no-fn.rs?ref=a8162171fdc1a0400f340454ebbca8aa4cd90007", "patch": "@@ -11,7 +11,7 @@\n // compile-flags: -Z parse-only\n \n extern {\n-    f(); //~ ERROR expected one of `fn`, `pub`, `static`, `unsafe`, or `}`, found `f`\n+    f(); //~ ERROR expected one of `fn`, `pub`, `static`, or `}`, found `f`\n }\n \n fn main() {"}, {"sha": "e632af6c83b1d4f7950fd66e5d38da658321053d", "filename": "src/test/parse-fail/removed-syntax-extern-const.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a8162171fdc1a0400f340454ebbca8aa4cd90007/src%2Ftest%2Fparse-fail%2Fremoved-syntax-extern-const.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8162171fdc1a0400f340454ebbca8aa4cd90007/src%2Ftest%2Fparse-fail%2Fremoved-syntax-extern-const.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fparse-fail%2Fremoved-syntax-extern-const.rs?ref=a8162171fdc1a0400f340454ebbca8aa4cd90007", "patch": "@@ -12,5 +12,5 @@\n \n extern {\n     const i: isize;\n-    //~^ ERROR expected one of `fn`, `pub`, `static`, `unsafe`, or `}`, found `const`\n+    //~^ ERROR expected one of `fn`, `pub`, `static`, or `}`, found `const`\n }"}]}