{"sha": "36381fabaf18a6dfa0e9ee27b5045c2e8cf1c8ed", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM2MzgxZmFiYWYxOGE2ZGZhMGU5ZWUyN2I1MDQ1YzJlOGNmMWM4ZWQ=", "commit": {"author": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2018-06-06T17:02:09Z"}, "committer": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2018-06-06T17:02:09Z"}, "message": "Warn on `repr` without hints", "tree": {"sha": "b957cf11679d31d1fce20fcfb50ea6fe513b7aa4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b957cf11679d31d1fce20fcfb50ea6fe513b7aa4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/36381fabaf18a6dfa0e9ee27b5045c2e8cf1c8ed", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/36381fabaf18a6dfa0e9ee27b5045c2e8cf1c8ed", "html_url": "https://github.com/rust-lang/rust/commit/36381fabaf18a6dfa0e9ee27b5045c2e8cf1c8ed", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/36381fabaf18a6dfa0e9ee27b5045c2e8cf1c8ed/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "41affd03eb169830773cd1b11efda562ab81fad0", "url": "https://api.github.com/repos/rust-lang/rust/commits/41affd03eb169830773cd1b11efda562ab81fad0", "html_url": "https://github.com/rust-lang/rust/commit/41affd03eb169830773cd1b11efda562ab81fad0"}], "stats": {"total": 18, "additions": 17, "deletions": 1}, "files": [{"sha": "a526967aff0aabadbcdf55a031aee66b49f52d5d", "filename": "src/librustc/diagnostics.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/36381fabaf18a6dfa0e9ee27b5045c2e8cf1c8ed/src%2Flibrustc%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/36381fabaf18a6dfa0e9ee27b5045c2e8cf1c8ed/src%2Flibrustc%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fdiagnostics.rs?ref=36381fabaf18a6dfa0e9ee27b5045c2e8cf1c8ed", "patch": "@@ -2139,6 +2139,7 @@ register_diagnostics! {\n     E0657, // `impl Trait` can only capture lifetimes bound at the fn level\n     E0687, // in-band lifetimes cannot be used in `fn`/`Fn` syntax\n     E0688, // in-band lifetimes cannot be mixed with explicit lifetime binders\n+    E0689, // `#[repr]` must have a hint\n \n     E0906, // closures cannot be static\n }"}, {"sha": "1e642b98e18ceb83743435a18b104c618f563ed1", "filename": "src/librustc/hir/check_attr.rs", "status": "modified", "additions": 16, "deletions": 1, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/36381fabaf18a6dfa0e9ee27b5045c2e8cf1c8ed/src%2Flibrustc%2Fhir%2Fcheck_attr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/36381fabaf18a6dfa0e9ee27b5045c2e8cf1c8ed/src%2Flibrustc%2Fhir%2Fcheck_attr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fhir%2Fcheck_attr.rs?ref=36381fabaf18a6dfa0e9ee27b5045c2e8cf1c8ed", "patch": "@@ -154,7 +154,22 @@ impl<'a, 'tcx> CheckAttrVisitor<'a, 'tcx> {\n         let hints: Vec<_> = item.attrs\n             .iter()\n             .filter(|attr| attr.name() == \"repr\")\n-            .filter_map(|attr| attr.meta_item_list())\n+            .filter_map(|attr| {\n+                let list = attr.meta_item_list();\n+                let mut has_hints = false;\n+                if let Some(ref list) = list {\n+                    has_hints = !list.is_empty();\n+                }\n+                if !has_hints {\n+                    span_warn!(\n+                        self.tcx.sess,\n+                        item.span,\n+                        E0689,\n+                        \"`repr` attribute cannot be empty\",\n+                    );\n+                }\n+                list\n+            })\n             .flat_map(|hints| hints)\n             .collect();\n "}]}