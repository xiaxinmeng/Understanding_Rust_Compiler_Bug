{"sha": "6653bb38d5bb95bda0937e876094ef3b8bfca92c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY2NTNiYjM4ZDViYjk1YmRhMDkzN2U4NzYwOTRlZjNiOGJmY2E5MmM=", "commit": {"author": {"name": "Oliver Schneider", "email": "git-no-reply-9879165716479413131@oli-obk.de", "date": "2018-05-07T16:02:57Z"}, "committer": {"name": "Oliver Schneider", "email": "git-no-reply-9879165716479413131@oli-obk.de", "date": "2018-05-07T16:02:57Z"}, "message": "Implement missing intrinsic", "tree": {"sha": "3dfb4a55638ba864818b6c6489e6c43c7b4003bb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3dfb4a55638ba864818b6c6489e6c43c7b4003bb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6653bb38d5bb95bda0937e876094ef3b8bfca92c", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJgBAABCgBKFiEEvpMjxK4/cnPNfesJHVy0/Fl8MAQFAlrweLEsHGdpdC1uby1y\nZXBseS05ODc5MTY1NzE2NDc5NDEzMTMxQG9saS1vYmsuZGUACgkQHVy0/Fl8MATE\nWg//R6HuJ7ZeuTR5k+WZjZHJ6EHeJnv9PGqLjMwI+hMORn7S7TVwU144BMjlVlJk\n3huZl5cpTV62CkswfA1qGwe5451mu/GnRAsgWI+jccEdJlF577J6DNxxktMNSwE5\nBmH2jbPiiTGGul+eHeEQTK7bQw2BxI/YxZK1nh37sC1KAt2ki+7CLHdEr7VW41rm\nvp3l2mggnpZYz0cBgaqtjCeBMWJ5QGJ5IdtAfopDXNvqDBPcMDGdAJUrQj8aDQme\nPreJj6Siy8AgP2vktwt9xKMA9jUY/pgf5eumWtFhBWOAO5aC8kahEkd9IEZP9dQT\nE6EUbj3GzZFg6rXDc4tz3wwuqewawIc2upk5QVrBUIza7uohnAIaYqXiR98vephn\nWxwSqufKNGlm8rLKKeSyufKrGYCld+WPV8SQakHMbbY6FNWjz8sCXMowZORgVR/D\neslcKfMhb2Xhv/++HdAz8j/yPXvXE8K9Fa/2q7ZHHTBJ7HeZl1eAJ9BqzYeEz1dI\nMv6XnLu+be0VymHB7QsXMPtJqhGzqmR8Xv0Oj5P+aRIubQxYkQPJnMaTI0pfxP10\nxWQDjs2FlS428UkQ4MZ6pt0FDRXvtSdDh/aCvfIQk2DdmwGg31/3KgJV9iVXUdr9\nf8+9LTFsWMFibvxJ1LR5a6XJhDpnR1HgiL8OQ6Zg33WMP9M=\n=jdcF\n-----END PGP SIGNATURE-----", "payload": "tree 3dfb4a55638ba864818b6c6489e6c43c7b4003bb\nparent 0a88698daf8b5bc63de8297b287c82df82c07c36\nauthor Oliver Schneider <git-no-reply-9879165716479413131@oli-obk.de> 1525708977 +0200\ncommitter Oliver Schneider <git-no-reply-9879165716479413131@oli-obk.de> 1525708977 +0200\n\nImplement missing intrinsic\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6653bb38d5bb95bda0937e876094ef3b8bfca92c", "html_url": "https://github.com/rust-lang/rust/commit/6653bb38d5bb95bda0937e876094ef3b8bfca92c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6653bb38d5bb95bda0937e876094ef3b8bfca92c/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0a88698daf8b5bc63de8297b287c82df82c07c36", "url": "https://api.github.com/repos/rust-lang/rust/commits/0a88698daf8b5bc63de8297b287c82df82c07c36", "html_url": "https://github.com/rust-lang/rust/commit/0a88698daf8b5bc63de8297b287c82df82c07c36"}], "stats": {"total": 14, "additions": 14, "deletions": 0}, "files": [{"sha": "453e834566a6eceb59036e828593f2db968de5a5", "filename": "miri/intrinsic.rs", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/6653bb38d5bb95bda0937e876094ef3b8bfca92c/miri%2Fintrinsic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6653bb38d5bb95bda0937e876094ef3b8bfca92c/miri%2Fintrinsic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/miri%2Fintrinsic.rs?ref=6653bb38d5bb95bda0937e876094ef3b8bfca92c", "patch": "@@ -315,6 +315,20 @@ impl<'a, 'mir, 'tcx> EvalContextExt<'tcx> for EvalContext<'a, 'mir, 'tcx, super:\n                 self.write_primval(dest, result.0, dest_layout.ty)?;\n             }\n \n+            \"exact_div\" => {\n+                // Performs an exact division, resulting in undefined behavior where\n+                // `x % y != 0` or `y == 0` or `x == T::min_value() && y == -1`\n+                let ty = substs.type_at(0);\n+                let a = self.value_to_primval(args[0])?;\n+                let b = self.value_to_primval(args[1])?;\n+                // check x % y != 0\n+                if self.binary_op(mir::BinOp::Rem, a, ty, b, ty)?.0 != PrimVal::Bytes(0) {\n+                    return err!(ValidationFailure(format!(\"exact_div: {:?} cannot be divided by {:?}\", a, b)));\n+                }\n+                let result = self.binary_op(mir::BinOp::Div, a, ty, b, ty)?;\n+                self.write_primval(dest, result.0, dest_layout.ty)?;\n+            },\n+\n             \"likely\" | \"unlikely\" | \"forget\" => {}\n \n             \"init\" => {"}]}