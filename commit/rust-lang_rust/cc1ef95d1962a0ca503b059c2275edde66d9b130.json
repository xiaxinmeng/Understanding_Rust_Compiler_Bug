{"sha": "cc1ef95d1962a0ca503b059c2275edde66d9b130", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNjMWVmOTVkMTk2MmEwY2E1MDNiMDU5YzIyNzVlZGRlNjZkOWIxMzA=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2019-11-26T08:29:53Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-11-26T08:29:53Z"}, "message": "Merge #2407\n\n2407: :arrow_up: salsa r=matklad a=matklad\n\n\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>", "tree": {"sha": "d05b34483333fd1abfe95679cd37a6a837c468ff", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d05b34483333fd1abfe95679cd37a6a837c468ff"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cc1ef95d1962a0ca503b059c2275edde66d9b130", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJd3OKBCRBK7hj4Ov3rIwAAdHIIADQv/a7XTNK38qhTP0sAodY2\nlwTyi+YnWRS7cDLFiSgsCNmFFHEnf4K5eUDRngBv0Psbyf659xmC+Bd6hl++Ei5x\nlf6fxe0BR41zHFMrfHmdDfxjv4UH3hzZ0AI1xU5DwK8o3nf8T/WNTgsRqDKdDGTs\n1UoAseeo1JYUESJWecVXFSkt5IMCVUZWU6kMqGf/C0L9s3uCBhzMiYNE1MQvnhi6\ntECnWHilCpAZA4F30OgD5h3uINH6ilQWyUZsQjWCV9Jz4joEdA1/sd9tIAH9MFpU\nXnuUvIoPvPU7U7SWasgeHHzlKuMXWoFaTLe9H97fXE8DHTuuoI/3Kci1Pu6sNKc=\n=yD7W\n-----END PGP SIGNATURE-----\n", "payload": "tree d05b34483333fd1abfe95679cd37a6a837c468ff\nparent 58a3b3b502580e9f49dcfc9b7223e8aec258adf6\nparent 131c2da6bfd8ad6a25a55b4c85081da327ba2acb\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1574756993 +0000\ncommitter GitHub <noreply@github.com> 1574756993 +0000\n\nMerge #2407\n\n2407: :arrow_up: salsa r=matklad a=matklad\n\n\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cc1ef95d1962a0ca503b059c2275edde66d9b130", "html_url": "https://github.com/rust-lang/rust/commit/cc1ef95d1962a0ca503b059c2275edde66d9b130", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cc1ef95d1962a0ca503b059c2275edde66d9b130/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "58a3b3b502580e9f49dcfc9b7223e8aec258adf6", "url": "https://api.github.com/repos/rust-lang/rust/commits/58a3b3b502580e9f49dcfc9b7223e8aec258adf6", "html_url": "https://github.com/rust-lang/rust/commit/58a3b3b502580e9f49dcfc9b7223e8aec258adf6"}, {"sha": "131c2da6bfd8ad6a25a55b4c85081da327ba2acb", "url": "https://api.github.com/repos/rust-lang/rust/commits/131c2da6bfd8ad6a25a55b4c85081da327ba2acb", "html_url": "https://github.com/rust-lang/rust/commit/131c2da6bfd8ad6a25a55b4c85081da327ba2acb"}], "stats": {"total": 78, "additions": 53, "deletions": 25}, "files": [{"sha": "12d8af7e2a9e134140b8b576e6bebb7cb65949f4", "filename": "Cargo.lock", "status": "modified", "additions": 32, "deletions": 20, "changes": 52, "blob_url": "https://github.com/rust-lang/rust/blob/cc1ef95d1962a0ca503b059c2275edde66d9b130/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/cc1ef95d1962a0ca503b059c2275edde66d9b130/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=cc1ef95d1962a0ca503b059c2275edde66d9b130", "patch": "@@ -291,16 +291,6 @@ dependencies = [\n  \"lazy_static 1.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n-[[package]]\n-name = \"derive-new\"\n-version = \"0.5.8\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-dependencies = [\n- \"proc-macro2 1.0.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"quote 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"syn 1.0.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n-]\n-\n [[package]]\n name = \"difference\"\n version = \"2.0.0\"\n@@ -799,6 +789,15 @@ dependencies = [\n  \"rustc_version 0.2.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n+[[package]]\n+name = \"parking_lot\"\n+version = \"0.10.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+dependencies = [\n+ \"lock_api 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"parking_lot_core 0.7.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+]\n+\n [[package]]\n name = \"parking_lot_core\"\n version = \"0.6.2\"\n@@ -813,6 +812,19 @@ dependencies = [\n  \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n+[[package]]\n+name = \"parking_lot_core\"\n+version = \"0.7.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+dependencies = [\n+ \"cfg-if 0.1.10 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"cloudabi 0.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"libc 0.2.65 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"redox_syscall 0.1.56 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"smallvec 1.0.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n+]\n+\n [[package]]\n name = \"paste\"\n version = \"0.1.6\"\n@@ -981,7 +993,7 @@ dependencies = [\n  \"ra_syntax 0.1.0\",\n  \"relative-path 1.0.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rustc-hash 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"salsa 0.13.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"salsa 0.14.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"test_utils 0.1.0\",\n ]\n \n@@ -1472,23 +1484,22 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"salsa\"\n-version = \"0.13.2\"\n+version = \"0.14.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"crossbeam 0.7.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"derive-new 0.5.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"indexmap 1.3.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"parking_lot 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"parking_lot 0.10.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand 0.7.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rustc-hash 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"salsa-macros 0.13.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"smallvec 0.6.13 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"salsa-macros 0.14.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"smallvec 1.0.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n name = \"salsa-macros\"\n-version = \"0.13.2\"\n+version = \"0.14.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"heck 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -1877,7 +1888,6 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum crossbeam-epoch 0.8.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"5064ebdbf05ce3cb95e45c8b086f72263f4166b29b97f6baff7ef7fe047b55ac\"\n \"checksum crossbeam-queue 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"dfd6515864a82d2f877b42813d4553292c6659498c9a2aa31bab5a15243c2700\"\n \"checksum crossbeam-utils 0.7.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ce446db02cdc3165b94ae73111e570793400d0794e46125cc4056c81cbb039f4\"\n-\"checksum derive-new 0.5.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"71f31892cd5c62e414316f2963c5689242c43d8e7bbcaaeca97e5e28c95d91d9\"\n \"checksum difference 2.0.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"524cbf6897b527295dff137cec09ecf3a05f4fddffd7dfcd1585403449e74198\"\n \"checksum drop_bomb 0.1.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"69b26e475fd29098530e709294e94e661974c851aed42512793f120fed4e199f\"\n \"checksum dtoa 0.4.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ea57b42383d091c85abcc2706240b94ab2a8fa1fc81c10ff23c4de06e2a90b5e\"\n@@ -1940,8 +1950,10 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum number_prefix 0.3.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"17b02fc0ff9a9e4b35b3342880f48e896ebf69f2967921fe8646bf5b7125956a\"\n \"checksum once_cell 1.2.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"891f486f630e5c5a4916c7e16c4b24a53e78c860b646e9f8e005e4f16847bfed\"\n \"checksum ordermap 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"a86ed3f5f244b372d6b1a00b72ef7f8876d0bc6a78a4c9985c53614041512063\"\n+\"checksum parking_lot 0.10.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"92e98c49ab0b7ce5b222f2cc9193fc4efe11c6d0bd4f648e374684a6857b1cfc\"\n \"checksum parking_lot 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f842b1982eb6c2fe34036a4fbfb06dd185a3f5c8edfaacdf7d1ea10b07de6252\"\n \"checksum parking_lot_core 0.6.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b876b1b9e7ac6e1a74a6da34d25c42e17e8862aa409cbbbdcfc8d86c6f3bc62b\"\n+\"checksum parking_lot_core 0.7.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7582838484df45743c8434fbff785e8edf260c28748353d44bc0da32e0ceabf1\"\n \"checksum paste 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"423a519e1c6e828f1e73b720f9d9ed2fa643dce8a7737fb43235ce0b41eeaa49\"\n \"checksum paste-impl 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"4214c9e912ef61bf42b81ba9a47e8aad1b2ffaf739ab162bf96d1e011f54e6c5\"\n \"checksum percent-encoding 2.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"d4fd5641d01c8f18a23da7b6fe29298ff4b55afcccdf78973b24cf3175fee32e\"\n@@ -1985,8 +1997,8 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum rustc_lexer 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"c86aae0c77166108c01305ee1a36a1e77289d7dc6ca0a3cd91ff4992de2d16a5\"\n \"checksum rustc_version 0.2.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"138e3e0acb6c9fb258b19b67cb8abd63c00679d2851805ea151465464fe9030a\"\n \"checksum ryu 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"bfa8506c1de11c9c4e4c38863ccbe02a305c8188e85a05a784c9e11e1c3910c8\"\n-\"checksum salsa 0.13.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ec0865bdd9d8e614686a0cbb76979c735810131d287eb1683e91e4e64a58c387\"\n-\"checksum salsa-macros 0.13.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"cac182212d3a1db75ddc42399ff1461b258a694b8318ee7e0baf6c976e39efee\"\n+\"checksum salsa 0.14.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"4a006c56096acaaa5e82e5974c28d05ff1e84aa70615f19c53fecf8a1afb2fd2\"\n+\"checksum salsa-macros 0.14.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"038a09b6271446f1123f142fe7e5bef6d4687c4cf82e6986be574c2af3745530\"\n \"checksum same-file 1.0.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"585e8ddcedc187886a30fa705c47985c3fa88d06624095856b36ca0b82ff4421\"\n \"checksum scopeguard 1.0.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b42e15e59b18a828bbf5c58ea01debb36b9b096346de35d941dcb89009f24a0d\"\n \"checksum semver 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"1d7eb9ef2c18661902cc47e535f9bc51b78acd254da71d375c2f6720d9a40403\""}, {"sha": "523259fd46318af0e6cfe2f4f90e08fd76927e87", "filename": "crates/ra_assists/src/test_db.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/cc1ef95d1962a0ca503b059c2275edde66d9b130/crates%2Fra_assists%2Fsrc%2Ftest_db.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cc1ef95d1962a0ca503b059c2275edde66d9b130/crates%2Fra_assists%2Fsrc%2Ftest_db.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_assists%2Fsrc%2Ftest_db.rs?ref=cc1ef95d1962a0ca503b059c2275edde66d9b130", "patch": "@@ -21,6 +21,9 @@ impl salsa::Database for TestDB {\n     fn salsa_runtime(&self) -> &salsa::Runtime<Self> {\n         &self.runtime\n     }\n+    fn salsa_runtime_mut(&mut self) -> &mut salsa::Runtime<Self> {\n+        &mut self.runtime\n+    }\n }\n \n impl std::panic::RefUnwindSafe for TestDB {}"}, {"sha": "34105af57f3476421cebe1665d35d156fc695ab7", "filename": "crates/ra_cli/src/analysis_bench.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cc1ef95d1962a0ca503b059c2275edde66d9b130/crates%2Fra_cli%2Fsrc%2Fanalysis_bench.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cc1ef95d1962a0ca503b059c2275edde66d9b130/crates%2Fra_cli%2Fsrc%2Fanalysis_bench.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_cli%2Fsrc%2Fanalysis_bench.rs?ref=cc1ef95d1962a0ca503b059c2275edde66d9b130", "patch": "@@ -91,7 +91,7 @@ fn do_work<F: Fn(&Analysis) -> T, T>(host: &mut AnalysisHost, file_id: FileId, w\n     {\n         let start = Instant::now();\n         eprint!(\"trivial change: \");\n-        host.raw_database().salsa_runtime().synthetic_write(Durability::LOW);\n+        host.raw_database_mut().salsa_runtime_mut().synthetic_write(Durability::LOW);\n         work(&host.analysis());\n         eprintln!(\"{:?}\", start.elapsed());\n     }\n@@ -111,7 +111,7 @@ fn do_work<F: Fn(&Analysis) -> T, T>(host: &mut AnalysisHost, file_id: FileId, w\n     {\n         let start = Instant::now();\n         eprint!(\"const change:   \");\n-        host.raw_database().salsa_runtime().synthetic_write(Durability::HIGH);\n+        host.raw_database_mut().salsa_runtime_mut().synthetic_write(Durability::HIGH);\n         let res = work(&host.analysis());\n         eprintln!(\"{:?}\", start.elapsed());\n         res"}, {"sha": "7afa5d8fc91152c69144ed7878081582e516fe9f", "filename": "crates/ra_db/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cc1ef95d1962a0ca503b059c2275edde66d9b130/crates%2Fra_db%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/cc1ef95d1962a0ca503b059c2275edde66d9b130/crates%2Fra_db%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_db%2FCargo.toml?ref=cc1ef95d1962a0ca503b059c2275edde66d9b130", "patch": "@@ -8,7 +8,7 @@ authors = [\"rust-analyzer developers\"]\n doctest = false\n \n [dependencies]\n-salsa = \"0.13.0\"\n+salsa = \"0.14.1\"\n relative-path = \"1.0.0\"\n rustc-hash = \"1.0\"\n "}, {"sha": "a2071f71cf41048cc812f8d9e64fb1eec80243b4", "filename": "crates/ra_hir/src/test_db.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cc1ef95d1962a0ca503b059c2275edde66d9b130/crates%2Fra_hir%2Fsrc%2Ftest_db.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cc1ef95d1962a0ca503b059c2275edde66d9b130/crates%2Fra_hir%2Fsrc%2Ftest_db.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Ftest_db.rs?ref=cc1ef95d1962a0ca503b059c2275edde66d9b130", "patch": "@@ -28,6 +28,10 @@ impl salsa::Database for TestDB {\n         &self.runtime\n     }\n \n+    fn salsa_runtime_mut(&mut self) -> &mut salsa::Runtime<Self> {\n+        &mut self.runtime\n+    }\n+\n     fn salsa_event(&self, event: impl Fn() -> salsa::Event<TestDB>) {\n         let mut events = self.events.lock();\n         if let Some(events) = &mut *events {"}, {"sha": "54e3a84bdfbb87f8ab7f137653a0d906995b858d", "filename": "crates/ra_hir_def/src/test_db.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cc1ef95d1962a0ca503b059c2275edde66d9b130/crates%2Fra_hir_def%2Fsrc%2Ftest_db.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cc1ef95d1962a0ca503b059c2275edde66d9b130/crates%2Fra_hir_def%2Fsrc%2Ftest_db.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir_def%2Fsrc%2Ftest_db.rs?ref=cc1ef95d1962a0ca503b059c2275edde66d9b130", "patch": "@@ -24,7 +24,9 @@ impl salsa::Database for TestDB {\n     fn salsa_runtime(&self) -> &salsa::Runtime<Self> {\n         &self.runtime\n     }\n-\n+    fn salsa_runtime_mut(&mut self) -> &mut salsa::Runtime<Self> {\n+        &mut self.runtime\n+    }\n     fn salsa_event(&self, event: impl Fn() -> salsa::Event<TestDB>) {\n         let mut events = self.events.lock().unwrap();\n         if let Some(events) = &mut *events {"}, {"sha": "918736e2a155a0415debe67a9309a65d4bc3dc7d", "filename": "crates/ra_hir_expand/src/test_db.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cc1ef95d1962a0ca503b059c2275edde66d9b130/crates%2Fra_hir_expand%2Fsrc%2Ftest_db.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cc1ef95d1962a0ca503b059c2275edde66d9b130/crates%2Fra_hir_expand%2Fsrc%2Ftest_db.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir_expand%2Fsrc%2Ftest_db.rs?ref=cc1ef95d1962a0ca503b059c2275edde66d9b130", "patch": "@@ -23,6 +23,10 @@ impl salsa::Database for TestDB {\n         &self.runtime\n     }\n \n+    fn salsa_runtime_mut(&mut self) -> &mut salsa::Runtime<Self> {\n+        &mut self.runtime\n+    }\n+\n     fn salsa_event(&self, event: impl Fn() -> salsa::Event<TestDB>) {\n         let mut events = self.events.lock().unwrap();\n         if let Some(events) = &mut *events {"}, {"sha": "84340aff8c9d997369112cdfbecf459b2061552d", "filename": "crates/ra_ide_api/src/change.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cc1ef95d1962a0ca503b059c2275edde66d9b130/crates%2Fra_ide_api%2Fsrc%2Fchange.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cc1ef95d1962a0ca503b059c2275edde66d9b130/crates%2Fra_ide_api%2Fsrc%2Fchange.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fchange.rs?ref=cc1ef95d1962a0ca503b059c2275edde66d9b130", "patch": "@@ -171,7 +171,7 @@ impl RootDatabase {\n         log::info!(\"apply_change {:?}\", change);\n         {\n             let _p = profile(\"RootDatabase::apply_change/cancellation\");\n-            self.salsa_runtime().synthetic_write(Durability::LOW);\n+            self.salsa_runtime_mut().synthetic_write(Durability::LOW);\n         }\n         if !change.new_roots.is_empty() {\n             let mut local_roots = Vec::clone(&self.local_roots());"}, {"sha": "f739ebecd3b6541a0b28a94000b1f89c0ccb3b22", "filename": "crates/ra_ide_api/src/db.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/cc1ef95d1962a0ca503b059c2275edde66d9b130/crates%2Fra_ide_api%2Fsrc%2Fdb.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cc1ef95d1962a0ca503b059c2275edde66d9b130/crates%2Fra_ide_api%2Fsrc%2Fdb.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fdb.rs?ref=cc1ef95d1962a0ca503b059c2275edde66d9b130", "patch": "@@ -65,6 +65,9 @@ impl salsa::Database for RootDatabase {\n     fn salsa_runtime(&self) -> &salsa::Runtime<RootDatabase> {\n         &self.runtime\n     }\n+    fn salsa_runtime_mut(&mut self) -> &mut salsa::Runtime<Self> {\n+        &mut self.runtime\n+    }\n     fn on_propagated_panic(&self) -> ! {\n         Canceled::throw()\n     }"}]}