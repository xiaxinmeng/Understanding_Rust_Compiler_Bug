{"sha": "ecf63630cfbeeb62764a9b417f29258d6abdd2df", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVjZjYzNjMwY2ZiZWViNjI3NjRhOWI0MTdmMjkyNThkNmFiZGQyZGY=", "commit": {"author": {"name": "Josh Stone", "email": "cuviper@gmail.com", "date": "2019-03-28T01:15:22Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-03-28T01:15:22Z"}, "message": "Rollup merge of #58837 - Centril:librustc_interface_2018, r=petrochenkov\n\nlibrustc_interface => 2018\n\nr? @oli-obk\n\nThis will likely produce an ICE for some reason... so super-WIP.", "tree": {"sha": "abb904196a6d7aff8eba594333780fb0bd1f0d7e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/abb904196a6d7aff8eba594333780fb0bd1f0d7e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ecf63630cfbeeb62764a9b417f29258d6abdd2df", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJcnCAqCRBK7hj4Ov3rIwAAdHIIAA7jQOXHbG8nzBwXRpxoCjiw\nEEzVtdkBo3p0jrc6+U6dzJymYOSuOaOhtqLNR9KGA3m2cNjLW8NwhDVXL9cueXTg\n4eEgN3EnrFMJpInd7ZMjh+sDafbmCAEJ25+r28mGGE1EraCV2kMFImrU6VGZVlDi\n3KwwKPuRMs3zCsADLX+Ihaq9QcuWPRzMxByxxXF7mBpxZJMcAyM3ybfIKP3DJZh+\nhy6j6NSVnRPpjr5Ke2e2bLrp4G1xWDbj48ZLlJp9oosIHuZuSqWO+QW6XTzQqYR2\nlCFcdiYra6DKp1e6ro4/SM+G45TYTiIPTgL9WDzQWg0+GqsIca9QaDfWqjz6884=\n=tPoe\n-----END PGP SIGNATURE-----\n", "payload": "tree abb904196a6d7aff8eba594333780fb0bd1f0d7e\nparent 2a3c2bfce41436777654183d33fc5646fe651fdf\nparent bf1068b1370f7bc3e17164cb4abd010b15073fa8\nauthor Josh Stone <cuviper@gmail.com> 1553735722 -0700\ncommitter GitHub <noreply@github.com> 1553735722 -0700\n\nRollup merge of #58837 - Centril:librustc_interface_2018, r=petrochenkov\n\nlibrustc_interface => 2018\n\nr? @oli-obk\n\nThis will likely produce an ICE for some reason... so super-WIP.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ecf63630cfbeeb62764a9b417f29258d6abdd2df", "html_url": "https://github.com/rust-lang/rust/commit/ecf63630cfbeeb62764a9b417f29258d6abdd2df", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ecf63630cfbeeb62764a9b417f29258d6abdd2df/comments", "author": {"login": "cuviper", "id": 36186, "node_id": "MDQ6VXNlcjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/36186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuviper", "html_url": "https://github.com/cuviper", "followers_url": "https://api.github.com/users/cuviper/followers", "following_url": "https://api.github.com/users/cuviper/following{/other_user}", "gists_url": "https://api.github.com/users/cuviper/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuviper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuviper/subscriptions", "organizations_url": "https://api.github.com/users/cuviper/orgs", "repos_url": "https://api.github.com/users/cuviper/repos", "events_url": "https://api.github.com/users/cuviper/events{/privacy}", "received_events_url": "https://api.github.com/users/cuviper/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2a3c2bfce41436777654183d33fc5646fe651fdf", "url": "https://api.github.com/repos/rust-lang/rust/commits/2a3c2bfce41436777654183d33fc5646fe651fdf", "html_url": "https://github.com/rust-lang/rust/commit/2a3c2bfce41436777654183d33fc5646fe651fdf"}, {"sha": "bf1068b1370f7bc3e17164cb4abd010b15073fa8", "url": "https://api.github.com/repos/rust-lang/rust/commits/bf1068b1370f7bc3e17164cb4abd010b15073fa8", "html_url": "https://github.com/rust-lang/rust/commit/bf1068b1370f7bc3e17164cb4abd010b15073fa8"}], "stats": {"total": 61, "additions": 22, "deletions": 39}, "files": [{"sha": "ec934ee48212c254badbd6b9d220a99387348ba8", "filename": "src/librustc_interface/Cargo.toml", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/ecf63630cfbeeb62764a9b417f29258d6abdd2df/src%2Flibrustc_interface%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/ecf63630cfbeeb62764a9b417f29258d6abdd2df/src%2Flibrustc_interface%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_interface%2FCargo.toml?ref=ecf63630cfbeeb62764a9b417f29258d6abdd2df", "patch": "@@ -2,6 +2,7 @@\n authors = [\"The Rust Project Developers\"]\n name = \"rustc_interface\"\n version = \"0.0.0\"\n+edition = \"2018\"\n \n [lib]\n name = \"rustc_interface\"\n@@ -10,7 +11,7 @@ crate-type = [\"dylib\"]\n \n [dependencies]\n log = \"0.4\"\n-rustc-rayon = \"0.1.1\"\n+rayon = { version = \"0.1.1\", package = \"rustc-rayon\" }\n smallvec = { version = \"0.6.7\", features = [\"union\", \"may_dangle\"] }\n scoped-tls = \"1.0\"\n syntax = { path = \"../libsyntax\" }"}, {"sha": "bec868be505b50ab86e78f4ffede21177aea71ee", "filename": "src/librustc_interface/interface.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/ecf63630cfbeeb62764a9b417f29258d6abdd2df/src%2Flibrustc_interface%2Finterface.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ecf63630cfbeeb62764a9b417f29258d6abdd2df/src%2Flibrustc_interface%2Finterface.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_interface%2Finterface.rs?ref=ecf63630cfbeeb62764a9b417f29258d6abdd2df", "patch": "@@ -1,4 +1,8 @@\n-use queries::Queries;\n+use crate::queries::Queries;\n+use crate::util;\n+use crate::profile;\n+pub use crate::passes::BoxedResolver;\n+\n use rustc::lint;\n use rustc::session::config::{self, Input};\n use rustc::session::{DiagnosticOutput, Session};\n@@ -15,10 +19,6 @@ use std::result;\n use std::sync::{Arc, Mutex};\n use syntax;\n use syntax::source_map::{FileLoader, SourceMap};\n-use util;\n-use profile;\n-\n-pub use passes::BoxedResolver;\n \n pub type Result<T> = result::Result<T, ErrorReported>;\n "}, {"sha": "3314681b6981a5096da6821cddaf61cfa40a13bb", "filename": "src/librustc_interface/lib.rs", "status": "modified", "additions": 2, "deletions": 25, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/ecf63630cfbeeb62764a9b417f29258d6abdd2df/src%2Flibrustc_interface%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ecf63630cfbeeb62764a9b417f29258d6abdd2df/src%2Flibrustc_interface%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_interface%2Flib.rs?ref=ecf63630cfbeeb62764a9b417f29258d6abdd2df", "patch": "@@ -6,37 +6,14 @@\n #![feature(generators)]\n #![cfg_attr(unix, feature(libc))]\n \n+#![deny(rust_2018_idioms)]\n+\n #![allow(unused_imports)]\n \n #![recursion_limit=\"256\"]\n \n #[cfg(unix)]\n extern crate libc;\n-#[macro_use]\n-extern crate log;\n-extern crate rustc;\n-extern crate rustc_codegen_utils;\n-extern crate rustc_allocator;\n-extern crate rustc_borrowck;\n-extern crate rustc_incremental;\n-extern crate rustc_traits;\n-#[macro_use]\n-extern crate rustc_data_structures;\n-extern crate rustc_errors;\n-extern crate rustc_lint;\n-extern crate rustc_metadata;\n-extern crate rustc_mir;\n-extern crate rustc_passes;\n-extern crate rustc_plugin;\n-extern crate rustc_privacy;\n-extern crate rustc_rayon as rayon;\n-extern crate rustc_resolve;\n-extern crate rustc_typeck;\n-extern crate smallvec;\n-extern crate serialize;\n-extern crate syntax;\n-extern crate syntax_pos;\n-extern crate syntax_ext;\n \n pub mod interface;\n mod passes;"}, {"sha": "44ca11df694a966dd4ca95c9ab0eca49ee71b2c5", "filename": "src/librustc_interface/passes.rs", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/ecf63630cfbeeb62764a9b417f29258d6abdd2df/src%2Flibrustc_interface%2Fpasses.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ecf63630cfbeeb62764a9b417f29258d6abdd2df/src%2Flibrustc_interface%2Fpasses.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_interface%2Fpasses.rs?ref=ecf63630cfbeeb62764a9b417f29258d6abdd2df", "patch": "@@ -1,7 +1,8 @@\n-use interface::{Compiler, Result};\n-use util;\n-use proc_macro_decls;\n+use crate::interface::{Compiler, Result};\n+use crate::util;\n+use crate::proc_macro_decls;\n \n+use log::{debug, info, warn, log_enabled};\n use rustc::dep_graph::DepGraph;\n use rustc::hir;\n use rustc::hir::lowering::lower_crate;\n@@ -20,6 +21,7 @@ use rustc::session::search_paths::PathKind;\n use rustc_allocator as allocator;\n use rustc_borrowck as borrowck;\n use rustc_codegen_utils::codegen_backend::CodegenBackend;\n+use rustc_data_structures::{box_region_allow_access, declare_box_region_type, parallel};\n use rustc_data_structures::fingerprint::Fingerprint;\n use rustc_data_structures::stable_hasher::StableHasher;\n use rustc_data_structures::sync::{Lrc, ParallelIterator, par_iter};\n@@ -758,7 +760,7 @@ pub fn prepare_outputs(\n     Ok(outputs)\n }\n \n-pub fn default_provide(providers: &mut ty::query::Providers) {\n+pub fn default_provide(providers: &mut ty::query::Providers<'_>) {\n     providers.analysis = analysis;\n     proc_macro_decls::provide(providers);\n     plugin::build::provide(providers);\n@@ -783,7 +785,7 @@ pub fn default_provide(providers: &mut ty::query::Providers) {\n     lint::provide(providers);\n }\n \n-pub fn default_provide_extern(providers: &mut ty::query::Providers) {\n+pub fn default_provide_extern(providers: &mut ty::query::Providers<'_>) {\n     cstore::provide_extern(providers);\n }\n "}, {"sha": "d0c8dff207083d6773692a279fac5c8c2724c006", "filename": "src/librustc_interface/profile/mod.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/ecf63630cfbeeb62764a9b417f29258d6abdd2df/src%2Flibrustc_interface%2Fprofile%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ecf63630cfbeeb62764a9b417f29258d6abdd2df/src%2Flibrustc_interface%2Fprofile%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_interface%2Fprofile%2Fmod.rs?ref=ecf63630cfbeeb62764a9b417f29258d6abdd2df", "patch": "@@ -1,8 +1,9 @@\n+use log::debug;\n+use rustc::dep_graph::DepNode;\n use rustc::session::Session;\n use rustc::util::common::{ProfQDumpParams, ProfileQueriesMsg, profq_msg, profq_set_chan};\n use std::sync::mpsc::{Receiver};\n use std::io::{Write};\n-use rustc::dep_graph::{DepNode};\n use std::time::{Duration, Instant};\n \n pub mod trace;"}, {"sha": "570509ffb2b8ca1b7e6b5915ec5041dec1ef76dc", "filename": "src/librustc_interface/queries.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/ecf63630cfbeeb62764a9b417f29258d6abdd2df/src%2Flibrustc_interface%2Fqueries.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ecf63630cfbeeb62764a9b417f29258d6abdd2df/src%2Flibrustc_interface%2Fqueries.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_interface%2Fqueries.rs?ref=ecf63630cfbeeb62764a9b417f29258d6abdd2df", "patch": "@@ -1,5 +1,6 @@\n-use interface::{Compiler, Result};\n-use passes::{self, BoxedResolver, ExpansionResult, BoxedGlobalCtxt, PluginInfo};\n+use crate::interface::{Compiler, Result};\n+use crate::passes::{self, BoxedResolver, ExpansionResult, BoxedGlobalCtxt, PluginInfo};\n+\n use rustc_incremental::DepGraphFuture;\n use rustc_data_structures::sync::Lrc;\n use rustc::session::config::{Input, OutputFilenames, OutputType};"}, {"sha": "6e4f2bf24e32f0750ab4ecfbb231d73489ee6ef3", "filename": "src/librustc_interface/util.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/ecf63630cfbeeb62764a9b417f29258d6abdd2df/src%2Flibrustc_interface%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ecf63630cfbeeb62764a9b417f29258d6abdd2df/src%2Flibrustc_interface%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_interface%2Futil.rs?ref=ecf63630cfbeeb62764a9b417f29258d6abdd2df", "patch": "@@ -1,3 +1,4 @@\n+use log::info;\n use rustc::session::config::{Input, OutputFilenames, ErrorOutputType};\n use rustc::session::{self, config, early_error, filesearch, Session, DiagnosticOutput};\n use rustc::session::CrateDisambiguator;"}]}