{"sha": "5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVmMzQzMTY5MWRkMmIyYjJiM2M0OGFkNWJmYTZjYTc4MmE5YTZkMDk=", "commit": {"author": {"name": "Andy Russell", "email": "arussell123@gmail.com", "date": "2018-12-14T04:28:54Z"}, "committer": {"name": "Andy Russell", "email": "arussell123@gmail.com", "date": "2018-12-14T16:15:25Z"}, "message": "simplify deprecation and stability rendering", "tree": {"sha": "8df9f74d34defa12fc0f9c5e0f834c7c52c35f48", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8df9f74d34defa12fc0f9c5e0f834c7c52c35f48"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQFKBAABCAA0FiEELriChyEaiMu0yCg7viIhAz7bw3QFAlwT1x0WHGFydXNzZWxs\nMTIzQGdtYWlsLmNvbQAKCRC+IiEDPtvDdPvNB/0WR1V7KRcQo+WlJDMjsoXBFJcE\nxtfmM26bBYLVzV7FDWLCScgHWYj/WC3ELckQ6RMv6SSy5HbhR9vAr+w1bYY7mQej\nhLRUoLJ1AtHvMZ5xnl10orkkz3ArWGeiA16TlQzOOyguyHslFY2ku5qRmnar8Hre\nEQNQ/Sp5rOJ/q4VdLUYuwqM2D5ZLgw5Hxy4CrnQQXpfn6l/t6p03Vt/ZgRggHzbC\ngL+MA9KgJZv8uHKvHx25mJ4HiJfxT7Vylarms0Kh8+bprRE2JWXN/JAh8n8t8eq2\n9nDZ9QokbQb94hO+e1Ntu7GGUI/cLxbTl92cVkFb6vvNFL1psLUEQjWOPbnR\n=DNNy\n-----END PGP SIGNATURE-----", "payload": "tree 8df9f74d34defa12fc0f9c5e0f834c7c52c35f48\nparent f4b07e0713b2d82417968db08cd0575734cdac0d\nauthor Andy Russell <arussell123@gmail.com> 1544761734 -0500\ncommitter Andy Russell <arussell123@gmail.com> 1544804125 -0500\n\nsimplify deprecation and stability rendering\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09", "html_url": "https://github.com/rust-lang/rust/commit/5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09/comments", "author": {"login": "euclio", "id": 1372438, "node_id": "MDQ6VXNlcjEzNzI0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1372438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/euclio", "html_url": "https://github.com/euclio", "followers_url": "https://api.github.com/users/euclio/followers", "following_url": "https://api.github.com/users/euclio/following{/other_user}", "gists_url": "https://api.github.com/users/euclio/gists{/gist_id}", "starred_url": "https://api.github.com/users/euclio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/euclio/subscriptions", "organizations_url": "https://api.github.com/users/euclio/orgs", "repos_url": "https://api.github.com/users/euclio/repos", "events_url": "https://api.github.com/users/euclio/events{/privacy}", "received_events_url": "https://api.github.com/users/euclio/received_events", "type": "User", "site_admin": false}, "committer": {"login": "euclio", "id": 1372438, "node_id": "MDQ6VXNlcjEzNzI0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1372438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/euclio", "html_url": "https://github.com/euclio", "followers_url": "https://api.github.com/users/euclio/followers", "following_url": "https://api.github.com/users/euclio/following{/other_user}", "gists_url": "https://api.github.com/users/euclio/gists{/gist_id}", "starred_url": "https://api.github.com/users/euclio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/euclio/subscriptions", "organizations_url": "https://api.github.com/users/euclio/orgs", "repos_url": "https://api.github.com/users/euclio/repos", "events_url": "https://api.github.com/users/euclio/events{/privacy}", "received_events_url": "https://api.github.com/users/euclio/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f4b07e0713b2d82417968db08cd0575734cdac0d", "url": "https://api.github.com/repos/rust-lang/rust/commits/f4b07e0713b2d82417968db08cd0575734cdac0d", "html_url": "https://github.com/rust-lang/rust/commit/f4b07e0713b2d82417968db08cd0575734cdac0d"}], "stats": {"total": 270, "additions": 141, "deletions": 129}, "files": [{"sha": "7ac718ed730bc7de65727653566581225f275131", "filename": "src/librustdoc/clean/mod.rs", "status": "modified", "additions": 27, "deletions": 21, "changes": 48, "blob_url": "https://github.com/rust-lang/rust/blob/5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09/src%2Flibrustdoc%2Fclean%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09/src%2Flibrustdoc%2Fclean%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Fmod.rs?ref=5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09", "patch": "@@ -478,7 +478,7 @@ impl Item {\n                 classes.push(\"unstable\");\n             }\n \n-            if !s.deprecated_since.is_empty() {\n+            if s.deprecation.is_some() {\n                 classes.push(\"deprecated\");\n             }\n \n@@ -503,6 +503,15 @@ impl Item {\n     pub fn type_(&self) -> ItemType {\n         ItemType::from(self)\n     }\n+\n+    /// Returns the info in the item's `#[deprecated]` or `#[rustc_deprecated]` attributes.\n+    ///\n+    /// If the item is not deprecated, returns `None`.\n+    pub fn deprecation(&self) -> Option<&Deprecation> {\n+        self.deprecation\n+            .as_ref()\n+            .or_else(|| self.stability.as_ref().and_then(|s| s.deprecation.as_ref()))\n+    }\n }\n \n #[derive(Clone, RustcEncodable, RustcDecodable, Debug)]\n@@ -3838,40 +3847,37 @@ impl Clean<Item> for doctree::ProcMacro {\n #[derive(Clone, RustcEncodable, RustcDecodable, Debug)]\n pub struct Stability {\n     pub level: stability::StabilityLevel,\n-    pub feature: String,\n+    pub feature: Option<String>,\n     pub since: String,\n-    pub deprecated_since: String,\n-    pub deprecated_reason: String,\n-    pub unstable_reason: String,\n-    pub issue: Option<u32>\n+    pub deprecation: Option<Deprecation>,\n+    pub unstable_reason: Option<String>,\n+    pub issue: Option<u32>,\n }\n \n #[derive(Clone, RustcEncodable, RustcDecodable, Debug)]\n pub struct Deprecation {\n-    pub since: String,\n-    pub note: String,\n+    pub since: Option<String>,\n+    pub note: Option<String>,\n }\n \n impl Clean<Stability> for attr::Stability {\n     fn clean(&self, _: &DocContext) -> Stability {\n         Stability {\n             level: stability::StabilityLevel::from_attr_level(&self.level),\n-            feature: self.feature.to_string(),\n+            feature: Some(self.feature.to_string()).filter(|f| !f.is_empty()),\n             since: match self.level {\n                 attr::Stable {ref since} => since.to_string(),\n                 _ => String::new(),\n             },\n-            deprecated_since: match self.rustc_depr {\n-                Some(attr::RustcDeprecation {ref since, ..}) => since.to_string(),\n-                _=> String::new(),\n-            },\n-            deprecated_reason: match self.rustc_depr {\n-                Some(ref depr) => depr.reason.to_string(),\n-                _ => String::new(),\n-            },\n+            deprecation: self.rustc_depr.as_ref().map(|d| {\n+                Deprecation {\n+                    note: Some(d.reason.to_string()).filter(|r| !r.is_empty()),\n+                    since: Some(d.since.to_string()).filter(|d| !d.is_empty()),\n+                }\n+            }),\n             unstable_reason: match self.level {\n-                attr::Unstable { reason: Some(ref reason), .. } => reason.to_string(),\n-                _ => String::new(),\n+                attr::Unstable { reason: Some(ref reason), .. } => Some(reason.to_string()),\n+                _ => None,\n             },\n             issue: match self.level {\n                 attr::Unstable {issue, ..} => Some(issue),\n@@ -3890,8 +3896,8 @@ impl<'a> Clean<Stability> for &'a attr::Stability {\n impl Clean<Deprecation> for attr::Deprecation {\n     fn clean(&self, _: &DocContext) -> Deprecation {\n         Deprecation {\n-            since: self.since.as_ref().map_or(String::new(), |s| s.to_string()),\n-            note: self.note.as_ref().map_or(String::new(), |s| s.to_string()),\n+            since: self.since.map(|s| s.to_string()).filter(|s| !s.is_empty()),\n+            note: self.note.map(|n| n.to_string()).filter(|n| !n.is_empty()),\n         }\n     }\n }"}, {"sha": "689054da39d011f4d96739b1066cecc4706a1617", "filename": "src/librustdoc/html/render.rs", "status": "modified", "additions": 84, "deletions": 98, "changes": 182, "blob_url": "https://github.com/rust-lang/rust/blob/5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09/src%2Flibrustdoc%2Fhtml%2Frender.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09/src%2Flibrustdoc%2Fhtml%2Frender.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender.rs?ref=5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09", "patch": "@@ -65,7 +65,7 @@ use rustc::hir;\n use rustc::util::nodemap::{FxHashMap, FxHashSet};\n use rustc_data_structures::flock;\n \n-use clean::{self, AttributesExt, GetDefId, SelfTy, Mutability};\n+use clean::{self, AttributesExt, Deprecation, GetDefId, SelfTy, Mutability};\n use config::RenderOptions;\n use doctree;\n use fold::DocFolder;\n@@ -2449,7 +2449,7 @@ fn document_full(w: &mut fmt::Formatter, item: &clean::Item,\n \n fn document_stability(w: &mut fmt::Formatter, cx: &Context, item: &clean::Item,\n                       is_hidden: bool) -> fmt::Result {\n-    let stabilities = short_stability(item, cx, true);\n+    let stabilities = short_stability(item, cx);\n     if !stabilities.is_empty() {\n         write!(w, \"<div class='stability{}'>\", if is_hidden { \" hidden\" } else { \"\" })?;\n         for stability in stabilities {\n@@ -2642,18 +2642,6 @@ fn item_module(w: &mut fmt::Formatter, cx: &Context,\n             _ => {\n                 if myitem.name.is_none() { continue }\n \n-                let stabilities = short_stability(myitem, cx, false);\n-\n-                let stab_docs = if !stabilities.is_empty() {\n-                    stabilities.iter()\n-                               .map(|s| format!(\"[{}]\", s))\n-                               .collect::<Vec<_>>()\n-                               .as_slice()\n-                               .join(\" \")\n-                } else {\n-                    String::new()\n-                };\n-\n                 let unsafety_flag = match myitem.inner {\n                     clean::FunctionItem(ref func) | clean::ForeignFunctionItem(ref func)\n                     if func.header.unsafety == hir::Unsafety::Unsafe => {\n@@ -2674,11 +2662,11 @@ fn item_module(w: &mut fmt::Formatter, cx: &Context,\n                        <tr class='{stab}{add}module-item'>\\\n                            <td><a class=\\\"{class}\\\" href=\\\"{href}\\\" \\\n                                   title='{title}'>{name}</a>{unsafety_flag}</td>\\\n-                           <td class='docblock-short'>{stab_docs}{docs}\\\n+                           <td class='docblock-short'>{stab_tags}{docs}\\\n                            </td>\\\n                        </tr>\",\n                        name = *myitem.name.as_ref().unwrap(),\n-                       stab_docs = stab_docs,\n+                       stab_tags = stability_tags(myitem),\n                        docs = MarkdownSummaryLine(doc_value, &myitem.links()),\n                        class = myitem.type_(),\n                        add = add,\n@@ -2705,101 +2693,99 @@ fn item_module(w: &mut fmt::Formatter, cx: &Context,\n     Ok(())\n }\n \n-fn short_stability(item: &clean::Item, cx: &Context, show_reason: bool) -> Vec<String> {\n+/// Render the stability and deprecation tags that are displayed in the item's summary at the\n+/// module level.\n+fn stability_tags(item: &clean::Item) -> String {\n+    let mut tags = String::new();\n+\n+    // The trailing space after each tag is to space it properly against the rest of the docs.\n+    if item.deprecation().is_some() {\n+        tags.push_str(\"[<div class='stab deprecated'>Deprecated</div>] \");\n+    }\n+\n+    if item\n+        .stability\n+        .as_ref()\n+        .filter(|s| s.level == stability::Unstable)\n+        .is_some()\n+    {\n+        tags.push_str(\"[<div class='stab unstable'>Experimental</div>] \");\n+    }\n+\n+    if let Some(ref cfg) = item.attrs.cfg {\n+        tags.push_str(&format!(\n+            \"[<div class='stab portability'>{}</div>] \",\n+            cfg.render_short_html()\n+        ));\n+    }\n+\n+    tags\n+}\n+\n+/// Render the stability and/or deprecation warning that is displayed at the top of the item's\n+/// documentation.\n+fn short_stability(item: &clean::Item, cx: &Context) -> Vec<String> {\n     let mut stability = vec![];\n     let error_codes = ErrorCodes::from(UnstableFeatures::from_environment().is_nightly_build());\n \n-    if let Some(stab) = item.stability.as_ref() {\n-        let deprecated_reason = if show_reason && !stab.deprecated_reason.is_empty() {\n-            format!(\": {}\", stab.deprecated_reason)\n+    if let Some(Deprecation { since, note }) = &item.deprecation() {\n+        let mut message = if let Some(since) = since {\n+            if stability::deprecation_in_effect(since) {\n+                format!(\"Deprecated since {}\", Escape(since))\n+            } else {\n+                format!(\"Deprecating in {}\", Escape(since))\n+            }\n         } else {\n-            String::new()\n+            String::from(\"Deprecated\")\n         };\n-        if !stab.deprecated_since.is_empty() {\n-            let since = if show_reason {\n-                format!(\" since {}\", Escape(&stab.deprecated_since))\n-            } else {\n-                String::new()\n-            };\n+\n+        if let Some(note) = note {\n             let mut ids = cx.id_map.borrow_mut();\n-            let html = MarkdownHtml(&deprecated_reason, RefCell::new(&mut ids), error_codes);\n-            let text = if stability::deprecation_in_effect(&stab.deprecated_since) {\n-                format!(\"Deprecated{}{}\", since, html)\n-            } else {\n-                format!(\"Deprecating in {}{}\", Escape(&stab.deprecated_since), html)\n-            };\n-            stability.push(format!(\"<div class='stab deprecated'>{}</div>\", text))\n-        };\n+            let html = MarkdownHtml(&note, RefCell::new(&mut ids), error_codes);\n+            message.push_str(&format!(\": {}\", html));\n+        }\n+        stability.push(format!(\"<div class='stab deprecated'>{}</div>\", message));\n+    }\n \n-        if stab.level == stability::Unstable {\n-            if show_reason {\n-                let unstable_extra = match (!stab.feature.is_empty(),\n-                                            &cx.shared.issue_tracker_base_url,\n-                                            stab.issue) {\n-                    (true, &Some(ref tracker_url), Some(issue_no)) if issue_no > 0 =>\n-                        format!(\" (<code>{} </code><a href=\\\"{}{}\\\">#{}</a>)\",\n-                                Escape(&stab.feature), tracker_url, issue_no, issue_no),\n-                    (false, &Some(ref tracker_url), Some(issue_no)) if issue_no > 0 =>\n-                        format!(\" (<a href=\\\"{}{}\\\">#{}</a>)\", Escape(&tracker_url), issue_no,\n-                                issue_no),\n-                    (true, ..) =>\n-                        format!(\" (<code>{}</code>)\", Escape(&stab.feature)),\n-                    _ => String::new(),\n-                };\n-                if stab.unstable_reason.is_empty() {\n-                    stability.push(format!(\"<div class='stab unstable'>\\\n-                                            <span class=microscope>\ud83d\udd2c</span> \\\n-                                            This is a nightly-only experimental API. {}\\\n-                                            </div>\",\n-                                           unstable_extra));\n-                } else {\n-                    let mut ids = cx.id_map.borrow_mut();\n-                    let text = format!(\"<summary><span class=microscope>\ud83d\udd2c</span> \\\n-                                        This is a nightly-only experimental API. {}\\\n-                                        </summary>{}\",\n-                                       unstable_extra,\n-                                       MarkdownHtml(\n-                                           &stab.unstable_reason,\n-                                           RefCell::new(&mut ids),\n-                                           error_codes));\n-                    stability.push(format!(\"<div class='stab unstable'><details>{}</details></div>\",\n-                                   text));\n-                }\n-            } else {\n-                stability.push(\"<div class='stab unstable'>Experimental</div>\".to_string())\n+    if let Some(stab) = item\n+        .stability\n+        .as_ref()\n+        .filter(|stab| stab.level == stability::Unstable)\n+    {\n+        let mut message = String::from(\n+            \"<span class=microscope>\ud83d\udd2c</span> This is a nightly-only experimental API.\",\n+        );\n+\n+        if let Some(feature) = stab.feature.as_ref() {\n+            let mut feature = format!(\"<code>{}</code>\", Escape(&feature));\n+            if let (Some(url), Some(issue)) = (&cx.shared.issue_tracker_base_url, stab.issue) {\n+                feature.push_str(&format!(\n+                    \"&nbsp;<a href=\\\"{url}{issue}\\\">#{issue}</a>\",\n+                    url = url,\n+                    issue = issue\n+                ));\n             }\n-        };\n-    } else if let Some(depr) = item.deprecation.as_ref() {\n-        let note = if show_reason && !depr.note.is_empty() {\n-            format!(\": {}\", depr.note)\n-        } else {\n-            String::new()\n-        };\n-        let since = if show_reason && !depr.since.is_empty() {\n-            format!(\" since {}\", Escape(&depr.since))\n-        } else {\n-            String::new()\n-        };\n \n-        let mut ids = cx.id_map.borrow_mut();\n-        let text = if stability::deprecation_in_effect(&depr.since) {\n-            format!(\"Deprecated{}{}\",\n-                    since,\n-                    MarkdownHtml(&note, RefCell::new(&mut ids), error_codes))\n-        } else {\n-            format!(\"Deprecating in {}{}\",\n-                    Escape(&depr.since),\n-                    MarkdownHtml(&note, RefCell::new(&mut ids), error_codes))\n-        };\n-        stability.push(format!(\"<div class='stab deprecated'>{}</div>\", text))\n+            message.push_str(&format!(\" ({})\", feature));\n+        }\n+\n+        if let Some(unstable_reason) = &stab.unstable_reason {\n+            let mut ids = cx.id_map.borrow_mut();\n+            message = format!(\n+                \"<details><summary>{}</summary>{}</details>\",\n+                message,\n+                MarkdownHtml(&unstable_reason, RefCell::new(&mut ids), error_codes)\n+            );\n+        }\n+\n+        stability.push(format!(\"<div class='stab unstable'>{}</div>\", message))\n     }\n \n     if let Some(ref cfg) = item.attrs.cfg {\n-        stability.push(format!(\"<div class='stab portability'>{}</div>\", if show_reason {\n+        stability.push(format!(\n+            \"<div class='stab portability'>{}</div>\",\n             cfg.render_long_html()\n-        } else {\n-            cfg.render_short_html()\n-        }));\n+        ));\n     }\n \n     stability"}, {"sha": "63447ad169002377940202115ba6d429ec2822aa", "filename": "src/test/rustdoc/deprecated.rs", "status": "modified", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09/src%2Ftest%2Frustdoc%2Fdeprecated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09/src%2Ftest%2Frustdoc%2Fdeprecated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fdeprecated.rs?ref=5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09", "patch": "@@ -10,7 +10,29 @@\n \n #![feature(deprecated)]\n \n+// @matches deprecated/index.html '//*[@class=\"docblock-short\"]' \\\n+//      '^\\[Deprecated\\] Deprecated docs'\n // @has deprecated/struct.S.html '//*[@class=\"stab deprecated\"]' \\\n //      'Deprecated since 1.0.0: text'\n+/// Deprecated docs\n #[deprecated(since = \"1.0.0\", note = \"text\")]\n pub struct S;\n+\n+// @matches deprecated/index.html '//*[@class=\"docblock-short\"]' '^Docs'\n+/// Docs\n+pub struct T;\n+\n+// @matches deprecated/struct.U.html '//*[@class=\"stab deprecated\"]' \\\n+//      'Deprecated since 1.0.0$'\n+#[deprecated(since = \"1.0.0\")]\n+pub struct U;\n+\n+// @matches deprecated/struct.V.html '//*[@class=\"stab deprecated\"]' \\\n+//      'Deprecated: text$'\n+#[deprecated(note = \"text\")]\n+pub struct V;\n+\n+// @matches deprecated/struct.W.html '//*[@class=\"stab deprecated\"]' \\\n+//      'Deprecated$'\n+#[deprecated]\n+pub struct W;"}, {"sha": "4723b04a078be75e405bd989305e1c934cabf31c", "filename": "src/test/rustdoc/issue-27759.rs", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09/src%2Ftest%2Frustdoc%2Fissue-27759.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09/src%2Ftest%2Frustdoc%2Fissue-27759.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fissue-27759.rs?ref=5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09", "patch": "@@ -14,13 +14,11 @@\n #![unstable(feature=\"test\", issue=\"27759\")]\n \n // @has issue_27759/unstable/index.html\n-// @has - '<code>test </code>'\n-// @has - '<a href=\"http://issue_url/27759\">#27759</a>'\n+// @has - '<code>test</code>&nbsp;<a href=\"http://issue_url/27759\">#27759</a>'\n #[unstable(feature=\"test\", issue=\"27759\")]\n pub mod unstable {\n     // @has issue_27759/unstable/fn.issue.html\n-    // @has - '<code>test_function </code>'\n-    // @has - '<a href=\"http://issue_url/1234567890\">#1234567890</a>'\n-    #[unstable(feature=\"test_function\", issue=\"1234567890\")]\n+    // @has - '<code>test_function</code>&nbsp;<a href=\"http://issue_url/12345\">#12345</a>'\n+    #[unstable(feature=\"test_function\", issue=\"12345\")]\n     pub fn issue() {}\n }"}, {"sha": "34423d0176d2d44403c42aaf657beec5d1a20b07", "filename": "src/test/rustdoc/issue-32374.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09/src%2Ftest%2Frustdoc%2Fissue-32374.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09/src%2Ftest%2Frustdoc%2Fissue-32374.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fissue-32374.rs?ref=5f3431691dd2b2b2b3c48ad5bfa6ca782a9a6d09", "patch": "@@ -13,15 +13,15 @@\n \n #![unstable(feature=\"test\", issue = \"32374\")]\n \n-// @has issue_32374/index.html '//*[@class=\"docblock-short\"]' \\\n-//      '[Deprecated] [Experimental]'\n+// @matches issue_32374/index.html '//*[@class=\"docblock-short\"]' \\\n+//      '^\\[Deprecated\\] \\[Experimental\\] Docs'\n \n // @has issue_32374/struct.T.html '//*[@class=\"stab deprecated\"]' \\\n //      'Deprecated since 1.0.0: text'\n-// @has - '<code>test </code>'\n-// @has - '<a href=\"http://issue_url/32374\">#32374</a>'\n+// @has - '<code>test</code>&nbsp;<a href=\"http://issue_url/32374\">#32374</a>'\n // @matches issue_32374/struct.T.html '//*[@class=\"stab unstable\"]' \\\n-//      '\ud83d\udd2c This is a nightly-only experimental API.  \\(test #32374\\)$'\n+//      '\ud83d\udd2c This is a nightly-only experimental API. \\(test #32374\\)$'\n+/// Docs\n #[rustc_deprecated(since = \"1.0.0\", reason = \"text\")]\n #[unstable(feature = \"test\", issue = \"32374\")]\n pub struct T;"}]}