{"sha": "95ea4a1a8a0c8786fdb0d6c63669ece927820ad3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk1ZWE0YTFhOGEwYzg3ODZmZGIwZDZjNjM2NjllY2U5Mjc4MjBhZDM=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-09-26T15:55:15Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-09-26T15:55:15Z"}, "message": "Rollup merge of #64783 - onehr:onehrxn, r=varkor\n\nFix issue #64732\n\nBased on issue #64732, when creating a byte literal with single quotes,\nthe suggestion message would indicate that you meant to write a `str` literal,\nbut we actually meant to write a byte string literal.\n\nSo I changed the unescape_error_reporting.rs to decide whether to print out\n\"if you meant to write a `str` literal, use double quotes\",\nor \"if you meant to write a byte string literal, use double quotes\".\n\nFixes #64732.", "tree": {"sha": "d65d373ce0b6b6f59811d74261374c0e494df878", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d65d373ce0b6b6f59811d74261374c0e494df878"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/95ea4a1a8a0c8786fdb0d6c63669ece927820ad3", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdjN9jCRBK7hj4Ov3rIwAAdHIIAIZlUFQaJbdNkdrB60hpjIB8\nSti6/OnO2cE3WJSTn/GMAkfi8nuhj98HtOCWdbi6KZ9t0ROj0Md4dAvGb7yKRN5+\nJZsjxmv56nMGPFEnnRtckdi7gf/jihiesfQXj47rJI79JxT6jZoXyDyQpVknnJN3\njh6DMlv80IFaxEu+4DrNzvMb57fY6pmytbuqt0gXVTQhKKYwrv7Hh0bHBiSTM7Fp\nxVpY3bFNxeC/l/cLthnze4aRhu6IwQj2j1v7EKwdDIKDn2/AA/ymVCiLZchoPEmO\nnpOYhhlrF79IP/WTh4rI6Irm5tz+FqWliA3xJqe1Si2SPUlP1HqXKN/050DvpDM=\n=N/Oz\n-----END PGP SIGNATURE-----\n", "payload": "tree d65d373ce0b6b6f59811d74261374c0e494df878\nparent 01303936f37ef494bfe11012645ff7ca37606fdf\nparent a048447ff42c0e7c793aa33c92aa8daf61576b71\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1569513315 +0200\ncommitter GitHub <noreply@github.com> 1569513315 +0200\n\nRollup merge of #64783 - onehr:onehrxn, r=varkor\n\nFix issue #64732\n\nBased on issue #64732, when creating a byte literal with single quotes,\nthe suggestion message would indicate that you meant to write a `str` literal,\nbut we actually meant to write a byte string literal.\n\nSo I changed the unescape_error_reporting.rs to decide whether to print out\n\"if you meant to write a `str` literal, use double quotes\",\nor \"if you meant to write a byte string literal, use double quotes\".\n\nFixes #64732.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/95ea4a1a8a0c8786fdb0d6c63669ece927820ad3", "html_url": "https://github.com/rust-lang/rust/commit/95ea4a1a8a0c8786fdb0d6c63669ece927820ad3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/95ea4a1a8a0c8786fdb0d6c63669ece927820ad3/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "01303936f37ef494bfe11012645ff7ca37606fdf", "url": "https://api.github.com/repos/rust-lang/rust/commits/01303936f37ef494bfe11012645ff7ca37606fdf", "html_url": "https://github.com/rust-lang/rust/commit/01303936f37ef494bfe11012645ff7ca37606fdf"}, {"sha": "a048447ff42c0e7c793aa33c92aa8daf61576b71", "url": "https://api.github.com/repos/rust-lang/rust/commits/a048447ff42c0e7c793aa33c92aa8daf61576b71", "html_url": "https://github.com/rust-lang/rust/commit/a048447ff42c0e7c793aa33c92aa8daf61576b71"}], "stats": {"total": 39, "additions": 38, "deletions": 1}, "files": [{"sha": "5565015179c2d5949a9291f72b5b1431b38b21c0", "filename": "src/libsyntax/parse/unescape_error_reporting.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/95ea4a1a8a0c8786fdb0d6c63669ece927820ad3/src%2Flibsyntax%2Fparse%2Funescape_error_reporting.rs", "raw_url": "https://github.com/rust-lang/rust/raw/95ea4a1a8a0c8786fdb0d6c63669ece927820ad3/src%2Flibsyntax%2Fparse%2Funescape_error_reporting.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Funescape_error_reporting.rs?ref=95ea4a1a8a0c8786fdb0d6c63669ece927820ad3", "patch": "@@ -47,14 +47,20 @@ pub(crate) fn emit_unescape_error(\n                 .emit();\n         }\n         EscapeError::MoreThanOneChar => {\n+            let msg = if mode.is_bytes() {\n+                \"if you meant to write a byte string literal, use double quotes\"\n+            } else {\n+                \"if you meant to write a `str` literal, use double quotes\"\n+            };\n+\n             handler\n                 .struct_span_err(\n                     span_with_quotes,\n                     \"character literal may only contain one codepoint\",\n                 )\n                 .span_suggestion(\n                     span_with_quotes,\n-                    \"if you meant to write a `str` literal, use double quotes\",\n+                    msg,\n                     format!(\"\\\"{}\\\"\", lit),\n                     Applicability::MachineApplicable,\n                 ).emit()"}, {"sha": "2db51ea6042aa533d2caaa6cb5b6978094bb4072", "filename": "src/test/ui/issues/issue-64732.rs", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/95ea4a1a8a0c8786fdb0d6c63669ece927820ad3/src%2Ftest%2Fui%2Fissues%2Fissue-64732.rs", "raw_url": "https://github.com/rust-lang/rust/raw/95ea4a1a8a0c8786fdb0d6c63669ece927820ad3/src%2Ftest%2Fui%2Fissues%2Fissue-64732.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-64732.rs?ref=95ea4a1a8a0c8786fdb0d6c63669ece927820ad3", "patch": "@@ -0,0 +1,9 @@\n+#![allow(unused)]\n+fn main() {\n+    let _foo = b'hello\\0';\n+    //~^ ERROR character literal may only contain one codepoint\n+    //~| HELP if you meant to write a byte string literal, use double quotes\n+    let _bar = 'hello';\n+    //~^ ERROR character literal may only contain one codepoint\n+    //~| HELP if you meant to write a `str` literal, use double quotes\n+}"}, {"sha": "fc0e8e3bdb20f6b464f105abb2ca238eb0fa5a29", "filename": "src/test/ui/issues/issue-64732.stderr", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/95ea4a1a8a0c8786fdb0d6c63669ece927820ad3/src%2Ftest%2Fui%2Fissues%2Fissue-64732.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/95ea4a1a8a0c8786fdb0d6c63669ece927820ad3/src%2Ftest%2Fui%2Fissues%2Fissue-64732.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-64732.stderr?ref=95ea4a1a8a0c8786fdb0d6c63669ece927820ad3", "patch": "@@ -0,0 +1,22 @@\n+error: character literal may only contain one codepoint\n+  --> $DIR/issue-64732.rs:3:17\n+   |\n+LL |     let _foo = b'hello\\0';\n+   |                 ^^^^^^^^^\n+help: if you meant to write a byte string literal, use double quotes\n+   |\n+LL |     let _foo = b\"hello\\0\";\n+   |                 ^^^^^^^^^\n+\n+error: character literal may only contain one codepoint\n+  --> $DIR/issue-64732.rs:6:16\n+   |\n+LL |     let _bar = 'hello';\n+   |                ^^^^^^^\n+help: if you meant to write a `str` literal, use double quotes\n+   |\n+LL |     let _bar = \"hello\";\n+   |                ^^^^^^^\n+\n+error: aborting due to 2 previous errors\n+"}]}