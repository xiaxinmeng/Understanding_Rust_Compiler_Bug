{"sha": "e21865a4407495a5724798a59276e4f276bc93f6", "node_id": "MDY6Q29tbWl0NzI0NzEyOmUyMTg2NWE0NDA3NDk1YTU3MjQ3OThhNTkyNzZlNGYyNzZiYzkzZjY=", "commit": {"author": {"name": "Roy Frostig", "email": "rfrostig@mozilla.com", "date": "2010-07-13T06:55:44Z"}, "committer": {"name": "Roy Frostig", "email": "rfrostig@mozilla.com", "date": "2010-07-15T19:30:46Z"}, "message": "Begin moving closure-or-obj pointer out to front of call args by changing the order within the call-arg tup referent type.  This breaks the world quite a bit, since it remains to fix custom call paths: glue, upcalls, natives.", "tree": {"sha": "cd69733ab8b2f4bdb25edc4c820f6ef8e6def069", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cd69733ab8b2f4bdb25edc4c820f6ef8e6def069"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e21865a4407495a5724798a59276e4f276bc93f6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e21865a4407495a5724798a59276e4f276bc93f6", "html_url": "https://github.com/rust-lang/rust/commit/e21865a4407495a5724798a59276e4f276bc93f6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e21865a4407495a5724798a59276e4f276bc93f6/comments", "author": {"login": "froystig", "id": 123903, "node_id": "MDQ6VXNlcjEyMzkwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/123903?v=4", "gravatar_id": "", "url": "https://api.github.com/users/froystig", "html_url": "https://github.com/froystig", "followers_url": "https://api.github.com/users/froystig/followers", "following_url": "https://api.github.com/users/froystig/following{/other_user}", "gists_url": "https://api.github.com/users/froystig/gists{/gist_id}", "starred_url": "https://api.github.com/users/froystig/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/froystig/subscriptions", "organizations_url": "https://api.github.com/users/froystig/orgs", "repos_url": "https://api.github.com/users/froystig/repos", "events_url": "https://api.github.com/users/froystig/events{/privacy}", "received_events_url": "https://api.github.com/users/froystig/received_events", "type": "User", "site_admin": false}, "committer": {"login": "froystig", "id": 123903, "node_id": "MDQ6VXNlcjEyMzkwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/123903?v=4", "gravatar_id": "", "url": "https://api.github.com/users/froystig", "html_url": "https://github.com/froystig", "followers_url": "https://api.github.com/users/froystig/followers", "following_url": "https://api.github.com/users/froystig/following{/other_user}", "gists_url": "https://api.github.com/users/froystig/gists{/gist_id}", "starred_url": "https://api.github.com/users/froystig/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/froystig/subscriptions", "organizations_url": "https://api.github.com/users/froystig/orgs", "repos_url": "https://api.github.com/users/froystig/repos", "events_url": "https://api.github.com/users/froystig/events{/privacy}", "received_events_url": "https://api.github.com/users/froystig/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "44d719d5fb246bfdfc9a83af2a43d79428319b47", "url": "https://api.github.com/repos/rust-lang/rust/commits/44d719d5fb246bfdfc9a83af2a43d79428319b47", "html_url": "https://github.com/rust-lang/rust/commit/44d719d5fb246bfdfc9a83af2a43d79428319b47"}], "stats": {"total": 17, "additions": 9, "deletions": 8}, "files": [{"sha": "18c49460576c99d068e15e7f0d68fa69a3dabacc", "filename": "src/boot/be/abi.ml", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/e21865a4407495a5724798a59276e4f276bc93f6/src%2Fboot%2Fbe%2Fabi.ml", "raw_url": "https://github.com/rust-lang/rust/raw/e21865a4407495a5724798a59276e4f276bc93f6/src%2Fboot%2Fbe%2Fabi.ml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fboot%2Fbe%2Fabi.ml?ref=e21865a4407495a5724798a59276e4f276bc93f6", "patch": "@@ -68,17 +68,17 @@ let vec_elt_data = 3;;\n \n let calltup_elt_out_ptr = 0;;\n let calltup_elt_task_ptr = 1;;\n-let calltup_elt_ty_params = 2;;\n-let calltup_elt_args = 3;;\n-let calltup_elt_iterator_args = 4;;\n-let calltup_elt_indirect_args = 5;;\n+let calltup_elt_indirect_args = 2;;\n+let calltup_elt_ty_params = 3;;\n+let calltup_elt_args = 4;;\n+let calltup_elt_iterator_args = 5;;\n \n let iterator_args_elt_block_fn = 0;;\n let iterator_args_elt_outer_frame_ptr = 1;;\n \n let indirect_args_elt_closure = 0;;\n \n-(* ty_params, src, dst, tydesc, taskptr. *)\n+(* dst, taskptr, closure-ptr, ty_params, src, src2=target_task *)\n let worst_case_glue_call_args = 5;;\n \n type abi ="}, {"sha": "e1a7ff47dbd1cdf0c5e444e37e02ef61d3b26e33", "filename": "src/boot/me/layout.ml", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/e21865a4407495a5724798a59276e4f276bc93f6/src%2Fboot%2Fme%2Flayout.ml", "raw_url": "https://github.com/rust-lang/rust/raw/e21865a4407495a5724798a59276e4f276bc93f6/src%2Fboot%2Fme%2Flayout.ml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fboot%2Fme%2Flayout.ml?ref=e21865a4407495a5724798a59276e4f276bc93f6", "patch": "@@ -21,7 +21,8 @@ let layout_visitor\n    *     |...                         |\n    *     |...                         |\n    *     +----------------------------+ <-- fp + abi_frame_base_sz\n-   *     |task ptr (implicit arg)     |        + abi_implicit_args_sz\n+   *     |closure/obj ptr (impl. arg) |        + abi_implicit_args_sz\n+   *     |task ptr (implicit arg)     |\n    *     |output ptr (implicit arg)   |\n    *     +----------------------------+ <-- fp + abi_frame_base_sz\n    *     |return pc                   |"}, {"sha": "7b18a5bc402c11ce296f1580db704456af36b99e", "filename": "src/boot/me/semant.ml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/e21865a4407495a5724798a59276e4f276bc93f6/src%2Fboot%2Fme%2Fsemant.ml", "raw_url": "https://github.com/rust-lang/rust/raw/e21865a4407495a5724798a59276e4f276bc93f6/src%2Fboot%2Fme%2Fsemant.ml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fboot%2Fme%2Fsemant.ml?ref=e21865a4407495a5724798a59276e4f276bc93f6", "patch": "@@ -2027,10 +2027,10 @@ let call_args_referent_type_full\n       [|\n         out_ptr_rty;                   (* Abi.calltup_elt_out_ptr       *)\n         task_ptr_rty;                  (* Abi.calltup_elt_task_ptr      *)\n+        Il.StructTy indirect_arg_rtys; (* Abi.calltup_elt_indirect_args *)\n         ty_param_rtys;                 (* Abi.calltup_elt_ty_params     *)\n         arg_rtys;                      (* Abi.calltup_elt_args          *)\n-        Il.StructTy iterator_arg_rtys; (* Abi.calltup_elt_iterator_args *)\n-        Il.StructTy indirect_arg_rtys  (* Abi.calltup_elt_indirect_args *)\n+        Il.StructTy iterator_arg_rtys  (* Abi.calltup_elt_iterator_args *)\n       |]\n ;;\n "}]}