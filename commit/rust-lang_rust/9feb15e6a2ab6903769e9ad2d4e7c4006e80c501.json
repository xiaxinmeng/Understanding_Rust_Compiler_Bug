{"sha": "9feb15e6a2ab6903769e9ad2d4e7c4006e80c501", "node_id": "MDY6Q29tbWl0NzI0NzEyOjlmZWIxNWU2YTJhYjY5MDM3NjllOWFkMmQ0ZTdjNDAwNmU4MGM1MDE=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2020-05-31T16:58:57Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-05-31T16:58:57Z"}, "message": "Merge #4669\n\n4669: Always derive from `process.env` when spawning a child process/shell execution r=matklad a=Dfinity-Alin\n\nThis is useful when an extension (e.g. [Nix Environment Selector](https://marketplace.visualstudio.com/items?itemName=arrterian.nix-env-selector)) or [launch\r\nconfiguration](https://stackoverflow.com/questions/57641460/set-env-var-for-node-js-when-launching-through-vs-code) sets one or more environment variables.\r\n\r\nWhen `env` is not explicitly specified in the options passed to\r\n`child_process.spawn()` or `vscode.ShellExecution()`, then `process.env` gets\r\napplied automatically. But when an explicit `env` is set, it should inherit from\r\n`process.env` rather than replace it completely.\n\nCo-authored-by: Alin Sinpalean <alin.sinpalean@dfinity.org>", "tree": {"sha": "0de7e082161a41927c36e89d015b136381738c13", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0de7e082161a41927c36e89d015b136381738c13"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9feb15e6a2ab6903769e9ad2d4e7c4006e80c501", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJe0+JRCRBK7hj4Ov3rIwAAdHIIAEkO7bG56YvP0C8E9W/Ada+Z\nCOF7D4gS4/ZcNyEYMxWAUVxHfs+2G7opxqHiWSH5LGANAHxsuq/MMgt+MDZZdFh7\ncdRaxKvbUyQRivIhYjCrvNZP0hLyGMnJR+4L3qfu/sciW0+yqF32NNmC7kZ0Qn7X\n6FPKuCYfW1RX0NcR8xVpdxIuj6ht4DcK2L4ktHie8Kl1uW0GOq1qT4iIdtHjF/d9\ndrd0y/FsmcMDnbJvSJn8gMJ6Bp3OKyL5rjpm1evi5c9FPT4QzHoVlQNeufhZRohE\nYc6sr8mUk1nACYB3y7X3JgnhJjanVDWotoIxBDBpdQLRTrxttzUEqhZ0M+qJP1w=\n=KSmM\n-----END PGP SIGNATURE-----\n", "payload": "tree 0de7e082161a41927c36e89d015b136381738c13\nparent c575da1609e3ed793002e73acdb135e4a831eb81\nparent 771457ec5cc4e3af6f5d64b6b8d89f1cba4d2aba\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1590944337 +0000\ncommitter GitHub <noreply@github.com> 1590944337 +0000\n\nMerge #4669\n\n4669: Always derive from `process.env` when spawning a child process/shell execution r=matklad a=Dfinity-Alin\n\nThis is useful when an extension (e.g. [Nix Environment Selector](https://marketplace.visualstudio.com/items?itemName=arrterian.nix-env-selector)) or [launch\r\nconfiguration](https://stackoverflow.com/questions/57641460/set-env-var-for-node-js-when-launching-through-vs-code) sets one or more environment variables.\r\n\r\nWhen `env` is not explicitly specified in the options passed to\r\n`child_process.spawn()` or `vscode.ShellExecution()`, then `process.env` gets\r\napplied automatically. But when an explicit `env` is set, it should inherit from\r\n`process.env` rather than replace it completely.\n\nCo-authored-by: Alin Sinpalean <alin.sinpalean@dfinity.org>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9feb15e6a2ab6903769e9ad2d4e7c4006e80c501", "html_url": "https://github.com/rust-lang/rust/commit/9feb15e6a2ab6903769e9ad2d4e7c4006e80c501", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9feb15e6a2ab6903769e9ad2d4e7c4006e80c501/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c575da1609e3ed793002e73acdb135e4a831eb81", "url": "https://api.github.com/repos/rust-lang/rust/commits/c575da1609e3ed793002e73acdb135e4a831eb81", "html_url": "https://github.com/rust-lang/rust/commit/c575da1609e3ed793002e73acdb135e4a831eb81"}, {"sha": "771457ec5cc4e3af6f5d64b6b8d89f1cba4d2aba", "url": "https://api.github.com/repos/rust-lang/rust/commits/771457ec5cc4e3af6f5d64b6b8d89f1cba4d2aba", "html_url": "https://github.com/rust-lang/rust/commit/771457ec5cc4e3af6f5d64b6b8d89f1cba4d2aba"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "8e1ba83ed676d237951eee06287b38f2534783e4", "filename": "editors/code/src/run.ts", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9feb15e6a2ab6903769e9ad2d4e7c4006e80c501/editors%2Fcode%2Fsrc%2Frun.ts", "raw_url": "https://github.com/rust-lang/rust/raw/9feb15e6a2ab6903769e9ad2d4e7c4006e80c501/editors%2Fcode%2Fsrc%2Frun.ts", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Fsrc%2Frun.ts?ref=9feb15e6a2ab6903769e9ad2d4e7c4006e80c501", "patch": "@@ -177,7 +177,7 @@ export function createTask(spec: ra.Runnable): vscode.Task {\n         label: spec.label,\n         command: spec.bin,\n         args: spec.extraArgs ? [...spec.args, '--', ...spec.extraArgs] : spec.args,\n-        env: spec.env,\n+        env: Object.assign({}, process.env, spec.env),\n     };\n \n     const execOption: vscode.ShellExecutionOptions = {"}]}