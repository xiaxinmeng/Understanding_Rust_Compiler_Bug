{"sha": "d597da32672805644b6dc76cfffeca6b8c4d8e62", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ1OTdkYTMyNjcyODA1NjQ0YjZkYzc2Y2ZmZmVjYTZiOGM0ZDhlNjI=", "commit": {"author": {"name": "Corey Farwell", "email": "coreyf@rwell.org", "date": "2018-02-02T04:36:33Z"}, "committer": {"name": "Corey Farwell", "email": "coreyf@rwell.org", "date": "2018-02-03T16:50:48Z"}, "message": "Clarify shared file handler behavior of File::try_clone.\n\nFixes https://github.com/rust-lang/rust/issues/46578.", "tree": {"sha": "d0601e38873b5922afd2dd789f8c8b54091407aa", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d0601e38873b5922afd2dd789f8c8b54091407aa"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d597da32672805644b6dc76cfffeca6b8c4d8e62", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d597da32672805644b6dc76cfffeca6b8c4d8e62", "html_url": "https://github.com/rust-lang/rust/commit/d597da32672805644b6dc76cfffeca6b8c4d8e62", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d597da32672805644b6dc76cfffeca6b8c4d8e62/comments", "author": {"login": "frewsxcv", "id": 416575, "node_id": "MDQ6VXNlcjQxNjU3NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/416575?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frewsxcv", "html_url": "https://github.com/frewsxcv", "followers_url": "https://api.github.com/users/frewsxcv/followers", "following_url": "https://api.github.com/users/frewsxcv/following{/other_user}", "gists_url": "https://api.github.com/users/frewsxcv/gists{/gist_id}", "starred_url": "https://api.github.com/users/frewsxcv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frewsxcv/subscriptions", "organizations_url": "https://api.github.com/users/frewsxcv/orgs", "repos_url": "https://api.github.com/users/frewsxcv/repos", "events_url": "https://api.github.com/users/frewsxcv/events{/privacy}", "received_events_url": "https://api.github.com/users/frewsxcv/received_events", "type": "User", "site_admin": false}, "committer": {"login": "frewsxcv", "id": 416575, "node_id": "MDQ6VXNlcjQxNjU3NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/416575?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frewsxcv", "html_url": "https://github.com/frewsxcv", "followers_url": "https://api.github.com/users/frewsxcv/followers", "following_url": "https://api.github.com/users/frewsxcv/following{/other_user}", "gists_url": "https://api.github.com/users/frewsxcv/gists{/gist_id}", "starred_url": "https://api.github.com/users/frewsxcv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frewsxcv/subscriptions", "organizations_url": "https://api.github.com/users/frewsxcv/orgs", "repos_url": "https://api.github.com/users/frewsxcv/repos", "events_url": "https://api.github.com/users/frewsxcv/events{/privacy}", "received_events_url": "https://api.github.com/users/frewsxcv/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8ccab7eed5f4fc93500fbf242e575073ca70d7cb", "url": "https://api.github.com/repos/rust-lang/rust/commits/8ccab7eed5f4fc93500fbf242e575073ca70d7cb", "html_url": "https://github.com/rust-lang/rust/commit/8ccab7eed5f4fc93500fbf242e575073ca70d7cb"}], "stats": {"total": 36, "additions": 29, "deletions": 7}, "files": [{"sha": "594c9d0ff5aed0fd3a8fa98ee136ecb30a011994", "filename": "src/libstd/fs.rs", "status": "modified", "additions": 29, "deletions": 7, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/d597da32672805644b6dc76cfffeca6b8c4d8e62/src%2Flibstd%2Ffs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d597da32672805644b6dc76cfffeca6b8c4d8e62/src%2Flibstd%2Ffs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Ffs.rs?ref=d597da32672805644b6dc76cfffeca6b8c4d8e62", "patch": "@@ -482,20 +482,42 @@ impl File {\n         self.inner.file_attr().map(Metadata)\n     }\n \n-    /// Creates a new independently owned handle to the underlying file.\n-    ///\n-    /// The returned `File` is a reference to the same state that this object\n-    /// references. Both handles will read and write with the same cursor\n-    /// position.\n+    /// Create a new `File` instance that shares the same underlying file handle\n+    /// as the existing `File` instance. Reads, writes, and seeks will affect\n+    /// both `File` instances simultaneously.\n     ///\n     /// # Examples\n     ///\n+    /// Create two handles for a file named `foo.txt`:\n+    ///\n     /// ```no_run\n     /// use std::fs::File;\n     ///\n     /// # fn foo() -> std::io::Result<()> {\n-    /// let mut f = File::open(\"foo.txt\")?;\n-    /// let file_copy = f.try_clone()?;\n+    /// let mut file = File::open(\"foo.txt\")?;\n+    /// let file_copy = file.try_clone()?;\n+    /// # Ok(())\n+    /// # }\n+    /// ```\n+    ///\n+    /// Assuming there\u2019s a file named `foo.txt` with contents `abcdef\\n`, create\n+    /// two handles, seek one of them, and read the remaining bytes from the\n+    /// other handle:\n+    ///\n+    /// ```no_run\n+    /// use std::fs::File;\n+    /// use std::io::SeekFrom;\n+    /// use std::io::prelude::*;\n+    ///\n+    /// # fn foo() -> std::io::Result<()> {\n+    /// let mut file = File::open(\"foo.txt\")?;\n+    /// let mut file_copy = file.try_clone()?;\n+    ///\n+    /// file.seek(SeekFrom::Start(3))?;\n+    ///\n+    /// let mut contents = vec![];\n+    /// file_copy.read_to_end(&mut contents)?;\n+    /// assert_eq!(contents, b\"def\\n\");\n     /// # Ok(())\n     /// # }\n     /// ```"}]}