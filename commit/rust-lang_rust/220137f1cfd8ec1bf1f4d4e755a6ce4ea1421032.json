{"sha": "220137f1cfd8ec1bf1f4d4e755a6ce4ea1421032", "node_id": "C_kwDOAAsO6NoAKDIyMDEzN2YxY2ZkOGVjMWJmMWY0ZDRlNzU1YTZjZTRlYTE0MjEwMzI", "commit": {"author": {"name": "C\u00f4me ALLART", "email": "come.allart@etu.emse.fr", "date": "2021-12-07T17:02:18Z"}, "committer": {"name": "C\u00f4me ALLART", "email": "come.allart@etu.emse.fr", "date": "2021-12-07T17:02:18Z"}, "message": "fix: disable assist for documented functions", "tree": {"sha": "e497fe961194d3175181d056a43aaa18336ceb31", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e497fe961194d3175181d056a43aaa18336ceb31"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/220137f1cfd8ec1bf1f4d4e755a6ce4ea1421032", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/220137f1cfd8ec1bf1f4d4e755a6ce4ea1421032", "html_url": "https://github.com/rust-lang/rust/commit/220137f1cfd8ec1bf1f4d4e755a6ce4ea1421032", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/220137f1cfd8ec1bf1f4d4e755a6ce4ea1421032/comments", "author": null, "committer": null, "parents": [{"sha": "3a82548c5e04395ba63add086461671e89d80262", "url": "https://api.github.com/repos/rust-lang/rust/commits/3a82548c5e04395ba63add086461671e89d80262", "html_url": "https://github.com/rust-lang/rust/commit/3a82548c5e04395ba63add086461671e89d80262"}], "stats": {"total": 19, "additions": 15, "deletions": 4}, "files": [{"sha": "b69fc1332b4431dffea793eb68a5f0fb80815a00", "filename": "crates/ide_assists/src/handlers/generate_documentation_template.rs", "status": "modified", "additions": 15, "deletions": 4, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/220137f1cfd8ec1bf1f4d4e755a6ce4ea1421032/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fgenerate_documentation_template.rs", "raw_url": "https://github.com/rust-lang/rust/raw/220137f1cfd8ec1bf1f4d4e755a6ce4ea1421032/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fgenerate_documentation_template.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fgenerate_documentation_template.rs?ref=220137f1cfd8ec1bf1f4d4e755a6ce4ea1421032", "patch": "@@ -41,7 +41,10 @@ pub(crate) fn generate_documentation_template(\n ) -> Option<()> {\n     let name = ctx.find_node_at_offset::<ast::Name>()?;\n     let ast_func = name.syntax().parent().and_then(ast::Fn::cast)?;\n-    if is_in_trait_impl(&ast_func) || !is_public(&ast_func) {\n+    if is_in_trait_impl(&ast_func)\n+        || !is_public(&ast_func)\n+        || ast_func.doc_comments().next().is_some()\n+    {\n         return None;\n     }\n \n@@ -70,9 +73,6 @@ pub(crate) fn generate_documentation_template(\n                     doc_lines.append(&mut lines);\n                 }\n             }\n-            if ast_func.doc_comments().next().is_some() {\n-                doc_lines.push(\"--- OLD VERSION BELOW ---\".into());\n-            }\n             builder.insert(text_range.start(), documentation_from_lines(doc_lines, indent_level));\n         },\n     )\n@@ -501,6 +501,17 @@ mod ParentPrivateModule {\n         );\n     }\n \n+    #[test]\n+    fn not_applicable_if_function_already_documented() {\n+        check_assist_not_applicable(\n+            generate_documentation_template,\n+            r#\"\n+/// Some documentation here\n+pub fn $0documented_function() {}\n+\"#,\n+        );\n+    }\n+\n     #[test]\n     fn supports_noop_function() {\n         check_assist("}]}