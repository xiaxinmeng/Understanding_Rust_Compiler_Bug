{"sha": "a8751e077f32c4da4787986d9a93ca7645e7df95", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE4NzUxZTA3N2YzMmM0ZGE0Nzg3OTg2ZDlhOTNjYTc2NDVlN2RmOTU=", "commit": {"author": {"name": "Jeffrey Seyfried", "email": "jeffrey.seyfried@gmail.com", "date": "2016-06-30T07:39:32Z"}, "committer": {"name": "Jeffrey Seyfried", "email": "jeffrey.seyfried@gmail.com", "date": "2016-06-30T07:39:32Z"}, "message": "Rollup merge of #34547 - sanxiyn:pretty-lifetime, r=pnkfelix\n\nFix pretty-printing of lifetime bound\n\nFix #34527.", "tree": {"sha": "1c007cf2b5f602bb7cfc104bdac157370fd08700", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1c007cf2b5f602bb7cfc104bdac157370fd08700"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a8751e077f32c4da4787986d9a93ca7645e7df95", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a8751e077f32c4da4787986d9a93ca7645e7df95", "html_url": "https://github.com/rust-lang/rust/commit/a8751e077f32c4da4787986d9a93ca7645e7df95", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a8751e077f32c4da4787986d9a93ca7645e7df95/comments", "author": {"login": "jseyfried", "id": 8652869, "node_id": "MDQ6VXNlcjg2NTI4Njk=", "avatar_url": "https://avatars.githubusercontent.com/u/8652869?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jseyfried", "html_url": "https://github.com/jseyfried", "followers_url": "https://api.github.com/users/jseyfried/followers", "following_url": "https://api.github.com/users/jseyfried/following{/other_user}", "gists_url": "https://api.github.com/users/jseyfried/gists{/gist_id}", "starred_url": "https://api.github.com/users/jseyfried/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jseyfried/subscriptions", "organizations_url": "https://api.github.com/users/jseyfried/orgs", "repos_url": "https://api.github.com/users/jseyfried/repos", "events_url": "https://api.github.com/users/jseyfried/events{/privacy}", "received_events_url": "https://api.github.com/users/jseyfried/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jseyfried", "id": 8652869, "node_id": "MDQ6VXNlcjg2NTI4Njk=", "avatar_url": "https://avatars.githubusercontent.com/u/8652869?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jseyfried", "html_url": "https://github.com/jseyfried", "followers_url": "https://api.github.com/users/jseyfried/followers", "following_url": "https://api.github.com/users/jseyfried/following{/other_user}", "gists_url": "https://api.github.com/users/jseyfried/gists{/gist_id}", "starred_url": "https://api.github.com/users/jseyfried/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jseyfried/subscriptions", "organizations_url": "https://api.github.com/users/jseyfried/orgs", "repos_url": "https://api.github.com/users/jseyfried/repos", "events_url": "https://api.github.com/users/jseyfried/events{/privacy}", "received_events_url": "https://api.github.com/users/jseyfried/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bd7a3639a89e032bb28493b823c62c8abf751f65", "url": "https://api.github.com/repos/rust-lang/rust/commits/bd7a3639a89e032bb28493b823c62c8abf751f65", "html_url": "https://github.com/rust-lang/rust/commit/bd7a3639a89e032bb28493b823c62c8abf751f65"}, {"sha": "3c29fc5f6cd69b1299cf5482a6bc991ba6b86a0f", "url": "https://api.github.com/repos/rust-lang/rust/commits/3c29fc5f6cd69b1299cf5482a6bc991ba6b86a0f", "html_url": "https://github.com/rust-lang/rust/commit/3c29fc5f6cd69b1299cf5482a6bc991ba6b86a0f"}], "stats": {"total": 355, "additions": 233, "deletions": 122}, "files": [{"sha": "6d8601f3dad6d3bee0c8ce725e2efc4418fe85b2", "filename": "mk/llvm.mk", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/mk%2Fllvm.mk", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/mk%2Fllvm.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fllvm.mk?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -27,12 +27,18 @@ endif\n \n define DEF_LLVM_RULES\n \n+ifeq ($(1),$$(CFG_BUILD))\n+LLVM_DEPS_TARGET_$(1) := $$(LLVM_DEPS)\n+else\n+LLVM_DEPS_TARGET_$(1) := $$(LLVM_DEPS) $$(LLVM_CONFIG_$$(CFG_BUILD))\n+endif\n+\n # If CFG_LLVM_ROOT is defined then we don't build LLVM ourselves\n ifeq ($(CFG_LLVM_ROOT),)\n \n LLVM_STAMP_$(1) = $$(CFG_LLVM_BUILD_DIR_$(1))/llvm-auto-clean-stamp\n \n-$$(LLVM_CONFIG_$(1)): $$(LLVM_DEPS) $$(LLVM_STAMP_$(1))\n+$$(LLVM_CONFIG_$(1)): $$(LLVM_DEPS_TARGET_$(1)) $$(LLVM_STAMP_$(1))\n \t@$$(call E, cmake: llvm)\n ifeq ($$(findstring msvc,$(1)),msvc)\n \t$$(Q)$$(CFG_CMAKE) --build $$(CFG_LLVM_BUILD_DIR_$(1)) \\\n@@ -42,7 +48,13 @@ else\n endif\n \t$$(Q)touch $$(LLVM_CONFIG_$(1))\n \n+ifeq ($$(findstring msvc,$(1)),msvc)\n clean-llvm$(1):\n+else\n+clean-llvm$(1):\n+\t@$$(call E, clean: llvm)\n+\t$$(Q)$$(MAKE) -C $$(CFG_LLVM_BUILD_DIR_$(1)) clean\n+endif\n \n else\n clean-llvm$(1):"}, {"sha": "1e677aa48b0f664346ad29af25d756627578b4e7", "filename": "src/bootstrap/build/native.rs", "status": "modified", "additions": 46, "deletions": 23, "changes": 69, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Fbootstrap%2Fbuild%2Fnative.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Fbootstrap%2Fbuild%2Fnative.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbuild%2Fnative.rs?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -135,27 +135,64 @@ pub fn compiler_rt(build: &Build, target: &str) {\n     let dst = build.compiler_rt_out(target);\n     let arch = target.split('-').next().unwrap();\n     let mode = if build.config.rust_optimize {\"Release\"} else {\"Debug\"};\n+\n+    let build_llvm_config = build.llvm_config(&build.config.build);\n+    let mut cfg = cmake::Config::new(build.src.join(\"src/compiler-rt\"));\n+    cfg.target(target)\n+       .host(&build.config.build)\n+       .out_dir(&dst)\n+       .profile(mode)\n+       .define(\"LLVM_CONFIG_PATH\", build_llvm_config)\n+       .define(\"COMPILER_RT_DEFAULT_TARGET_TRIPLE\", target)\n+       .define(\"COMPILER_RT_BUILD_SANITIZERS\", \"OFF\")\n+       .define(\"COMPILER_RT_BUILD_EMUTLS\", \"OFF\")\n+       // inform about c/c++ compilers, the c++ compiler isn't actually used but\n+       // it's needed to get the initial configure to work on all platforms.\n+       .define(\"CMAKE_C_COMPILER\", build.cc(target))\n+       .define(\"CMAKE_CXX_COMPILER\", build.cc(target));\n+\n     let (dir, build_target, libname) = if target.contains(\"linux\") ||\n                                           target.contains(\"freebsd\") ||\n                                           target.contains(\"netbsd\") {\n-        let os = if target.contains(\"android\") {\"-android\"} else {\"\"};\n-        let arch = if arch.starts_with(\"arm\") && target.contains(\"eabihf\") {\n-            \"armhf\"\n+        let os_extra = if target.contains(\"android\") && target.contains(\"arm\") {\n+            \"-android\"\n         } else {\n-            arch\n+            \"\"\n         };\n-        let target = format!(\"clang_rt.builtins-{}{}\", arch, os);\n+        let builtins_arch = match arch {\n+            \"i586\" => \"i386\",\n+            \"arm\" | \"armv7\" if target.contains(\"android\") => \"armhf\",\n+            \"arm\" if target.contains(\"eabihf\") => \"armhf\",\n+            _ => arch,\n+        };\n+        let target = format!(\"clang_rt.builtins-{}{}\", builtins_arch, os_extra);\n         (\"linux\".to_string(), target.clone(), target)\n-    } else if target.contains(\"darwin\") {\n-        let target = format!(\"clang_rt.builtins_{}_osx\", arch);\n+    } else if target.contains(\"apple-darwin\") {\n+        let builtins_arch = match arch {\n+            \"i686\" => \"i386\",\n+            _ => arch,\n+        };\n+        let target = format!(\"clang_rt.builtins_{}_osx\", builtins_arch);\n+        (\"builtins\".to_string(), target.clone(), target)\n+    } else if target.contains(\"apple-ios\") {\n+        cfg.define(\"COMPILER_RT_ENABLE_IOS\", \"ON\");\n+        let target = match arch {\n+            \"armv7s\" => \"hard_pic_armv7em_macho_embedded\".to_string(),\n+            \"aarch64\" => \"builtins_arm64_ios\".to_string(),\n+            _ => format!(\"hard_pic_{}_macho_embedded\", arch),\n+        };\n         (\"builtins\".to_string(), target.clone(), target)\n     } else if target.contains(\"windows-gnu\") {\n         let target = format!(\"clang_rt.builtins-{}\", arch);\n         (\"windows\".to_string(), target.clone(), target)\n     } else if target.contains(\"windows-msvc\") {\n+        let builtins_arch = match arch {\n+            \"i586\" | \"i686\" => \"i386\",\n+            _ => arch,\n+        };\n         (format!(\"windows/{}\", mode),\n          \"lib/builtins/builtins\".to_string(),\n-         format!(\"clang_rt.builtins-{}\", arch.replace(\"i686\", \"i386\")))\n+         format!(\"clang_rt.builtins-{}\", builtins_arch))\n     } else {\n         panic!(\"can't get os from target: {}\", target)\n     };\n@@ -168,21 +205,7 @@ pub fn compiler_rt(build: &Build, target: &str) {\n     }\n     let _ = fs::remove_dir_all(&dst);\n     t!(fs::create_dir_all(&dst));\n-    let build_llvm_config = build.llvm_config(&build.config.build);\n-    let mut cfg = cmake::Config::new(build.src.join(\"src/compiler-rt\"));\n-    cfg.target(target)\n-       .host(&build.config.build)\n-       .out_dir(&dst)\n-       .profile(mode)\n-       .define(\"LLVM_CONFIG_PATH\", build_llvm_config)\n-       .define(\"COMPILER_RT_DEFAULT_TARGET_TRIPLE\", target)\n-       .define(\"COMPILER_RT_BUILD_SANITIZERS\", \"OFF\")\n-       .define(\"COMPILER_RT_BUILD_EMUTLS\", \"OFF\")\n-       // inform about c/c++ compilers, the c++ compiler isn't actually used but\n-       // it's needed to get the initial configure to work on all platforms.\n-       .define(\"CMAKE_C_COMPILER\", build.cc(target))\n-       .define(\"CMAKE_CXX_COMPILER\", build.cc(target))\n-       .build_target(&build_target);\n+    cfg.build_target(&build_target);\n     cfg.build();\n }\n "}, {"sha": "a6b4e9492181c790fe5a3c040ca6e02397824d8f", "filename": "src/doc/book/closures.md", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Fdoc%2Fbook%2Fclosures.md", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Fdoc%2Fbook%2Fclosures.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Fbook%2Fclosures.md?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -322,7 +322,7 @@ to our closure when we pass it to `call_with_one`, so we use `&||`.\n A quick note about closures that use explicit lifetimes. Sometimes you might have a closure\n that takes a reference like so:\n \n-```\n+```rust\n fn call_with_ref<F>(some_closure:F) -> i32\n     where F: Fn(&i32) -> i32 {\n \n@@ -334,8 +334,8 @@ fn call_with_ref<F>(some_closure:F) -> i32\n Normally you can specify the lifetime of the parameter to our closure. We\n could annotate it on the function declaration:\n \n-```ignore\n-fn call_with_ref<'a, F>(some_closure:F) -> i32 \n+```rust,ignore\n+fn call_with_ref<'a, F>(some_closure:F) -> i32\n     where F: Fn(&'a 32) -> i32 {\n ```\n \n@@ -353,11 +353,11 @@ fn call_with_ref<F>(some_closure:F) -> i32\n     where F: for<'a> Fn(&'a 32) -> i32 {\n ```\n \n-This lets the Rust compiler find the minimum lifetime to invoke our closure and \n+This lets the Rust compiler find the minimum lifetime to invoke our closure and\n satisfy the borrow checker's rules. Our function then compiles and excutes as we\n expect.\n \n-```\n+```rust\n fn call_with_ref<F>(some_closure:F) -> i32\n     where F: for<'a> Fn(&'a i32) -> i32 {\n "}, {"sha": "67fe8ba2c11a48e0d5bde95d9a769caeef0a4541", "filename": "src/doc/book/crates-and-modules.md", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Fdoc%2Fbook%2Fcrates-and-modules.md", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Fdoc%2Fbook%2Fcrates-and-modules.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Fbook%2Fcrates-and-modules.md?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -22,12 +22,10 @@ As an example, let\u2019s make a *phrases* crate, which will give us various phrase\n in different languages. To keep things simple, we\u2019ll stick to \u2018greetings\u2019 and\n \u2018farewells\u2019 as two kinds of phrases, and use English and Japanese (\u65e5\u672c\u8a9e) as\n two languages for those phrases to be in. We\u2019ll use this module layout:\n-\n ```text\n                                     +-----------+\n                                 +---| greetings |\n-                                |   +-----------+\n-                  +---------+   |\n+                  +---------+   |   +-----------+\n               +---| english |---+\n               |   +---------+   |   +-----------+\n               |                 +---| farewells |\n@@ -37,8 +35,7 @@ two languages for those phrases to be in. We\u2019ll use this module layout:\n               |                 +---| greetings |\n               |   +----------+  |   +-----------+\n               +---| japanese |--+\n-                  +----------+  |\n-                                |   +-----------+\n+                  +----------+  |   +-----------+\n                                 +---| farewells |\n                                     +-----------+\n ```"}, {"sha": "c3e32e56c42666581f597ad0398f9c8f983d6115", "filename": "src/doc/book/ownership.md", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Fdoc%2Fbook%2Fownership.md", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Fdoc%2Fbook%2Fownership.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Fbook%2Fownership.md?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -67,7 +67,7 @@ Vectors have a [generic type][generics] `Vec<T>`, so in this example `v` will ha\n \n [arrays]: primitive-types.html#arrays\n [vectors]: vectors.html\n-[heap]: the-stack-and-the-heap.html\n+[heap]: the-stack-and-the-heap.html#the-heap\n [stack]: the-stack-and-the-heap.html#the-stack\n [bindings]: variable-bindings.html\n [generics]: generics.html\n@@ -136,6 +136,8 @@ Rust allocates memory for an integer [i32] on the [stack][sh], copies the bit\n pattern representing the value of 10 to the allocated memory and binds the\n variable name x to this memory region for future reference.\n \n+[i32]: primitive-types.html#numeric-types\n+\n Now consider the following code fragment:\n \n ```rust"}, {"sha": "e685cb129b939669a235ec14ddb2091c9d06f086", "filename": "src/doc/book/traits.md", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Fdoc%2Fbook%2Ftraits.md", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Fdoc%2Fbook%2Ftraits.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Fbook%2Ftraits.md?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -397,10 +397,10 @@ fn normal<T: ConvertTo<i64>>(x: &T) -> i64 {\n }\n \n // can be called with T == i64\n-fn inverse<T>() -> T\n+fn inverse<T>(x: i32) -> T\n         // this is using ConvertTo as if it were \"ConvertTo<i64>\"\n         where i32: ConvertTo<T> {\n-    42.convert()\n+    x.convert()\n }\n ```\n "}, {"sha": "59dbffd6e28e7e705f679cb59bd9454015c8c339", "filename": "src/doc/reference.md", "status": "modified", "additions": 13, "deletions": 5, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Fdoc%2Freference.md", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Fdoc%2Freference.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Freference.md?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -114,12 +114,20 @@ Non-doc comments are interpreted as a form of whitespace.\n \n ## Whitespace\n \n-Whitespace is any non-empty string containing only the following characters:\n-\n+Whitespace is any non-empty string containing only characters that have the\n+`Pattern_White_Space` Unicode property, namely:\n+\n+- `U+0009` (horizontal tab, `'\\t'`)\n+- `U+000A` (line feed, `'\\n'`)\n+- `U+000B` (vertical tab)\n+- `U+000C` (form feed)\n+- `U+000D` (carriage return, `'\\r'`)\n - `U+0020` (space, `' '`)\n-- `U+0009` (tab, `'\\t'`)\n-- `U+000A` (LF, `'\\n'`)\n-- `U+000D` (CR, `'\\r'`)\n+- `U+0085` (next line)\n+- `U+200E` (left-to-right mark)\n+- `U+200F` (right-to-left mark)\n+- `U+2028` (line separator)\n+- `U+2029` (paragraph separator)\n \n Rust is a \"free-form\" language, meaning that all forms of whitespace serve only\n to separate _tokens_ in the grammar, and have no semantic significance."}, {"sha": "15de0dd802d99f0a067c6df18d086e1cdb3465b8", "filename": "src/libcollections/fmt.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibcollections%2Ffmt.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibcollections%2Ffmt.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcollections%2Ffmt.rs?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -28,6 +28,7 @@\n //! format!(\"{:?}\", (3, 4));          // => \"(3, 4)\"\n //! format!(\"{value}\", value=4);      // => \"4\"\n //! format!(\"{} {}\", 1, 2);           // => \"1 2\"\n+//! format!(\"{:04}\", 42);             // => \"0042\" with leading zeros\n //! ```\n //!\n //! From these, you can see that the first argument is a format string. It is"}, {"sha": "9040e4bf8db5f23661174bb68a27822e63aa5d88", "filename": "src/librustc/diagnostics.rs", "status": "modified", "additions": 15, "deletions": 25, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibrustc%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibrustc%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fdiagnostics.rs?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -673,45 +673,35 @@ extern \"C\" {\n \"##,\n \n E0269: r##\"\n-Functions must eventually return a value of their return type. For example, in\n-the following function:\n+A returned value was expected but not all control paths return one.\n+\n+Erroneous code example:\n \n ```compile_fail,E0269\n fn abracada_FAIL() -> String {\n     \"this won't work\".to_string();\n+    // error: not all control paths return a value\n }\n ```\n \n-If the condition is true, the value `x` is returned, but if the condition is\n-false, control exits the `if` block and reaches a place where nothing is being\n-returned. All possible control paths must eventually return a `u8`, which is not\n-happening here.\n-\n-An easy fix for this in a complicated function is to specify a default return\n-value, if possible:\n+In the previous code, the function is supposed to return a `String`, however,\n+the code returns nothing (because of the ';'). Another erroneous code would be:\n \n-```ignore\n-fn foo(x: u8) -> u8 {\n-    if x > 0 {\n-        x // alternatively, `return x`\n+```compile_fail\n+fn abracada_FAIL(b: bool) -> u32 {\n+    if b {\n+        0\n+    } else {\n+        \"a\" // It fails because an `u32` was expected and something else is\n+            // returned.\n     }\n-    // lots of other if branches\n-    0 // return 0 if all else fails\n }\n ```\n \n It is advisable to find out what the unhandled cases are and check for them,\n returning an appropriate value or panicking if necessary. Check if you need\n-to remove a semicolon from the last expression, like in this case:\n-\n-```ignore\n-fn foo(x: u8) -> u8 {\n-    inner(2*x + 1);\n-}\n-```\n-\n-The semicolon discards the return value of `inner`, instead of returning\n-it from `foo`.\n+to remove a semicolon from the last expression, like in the first erroneous\n+code example.\n \"##,\n \n E0270: r##\""}, {"sha": "0334c5ef5c4f4397120d1408d1f8aa6227c8e5f8", "filename": "src/librustdoc/visit_ast.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibrustdoc%2Fvisit_ast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibrustdoc%2Fvisit_ast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fvisit_ast.rs?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -189,8 +189,8 @@ impl<'a, 'tcx> RustdocVisitor<'a, 'tcx> {\n             }\n             hir::ViewPathList(p, paths) => {\n                 let mine = paths.into_iter().filter(|path| {\n-                    !self.maybe_inline_local(path.node.id(), None, false, om,\n-                                     please_inline)\n+                    !self.maybe_inline_local(path.node.id(), path.node.rename(),\n+                                             false, om, please_inline)\n                 }).collect::<hir::HirVec<hir::PathListItem>>();\n \n                 if mine.is_empty() {"}, {"sha": "07f43f72ff55ab1d987b60c70c37b909695f27a3", "filename": "src/libstd/io/util.rs", "status": "modified", "additions": 23, "deletions": 6, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibstd%2Fio%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibstd%2Fio%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fio%2Futil.rs?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -78,14 +78,11 @@ pub struct Empty { _priv: () }\n /// A slightly sad example of not reading anything into a buffer:\n ///\n /// ```\n-/// use std::io;\n-/// use std::io::Read;\n+/// use std::io::{self, Read};\n ///\n-/// # fn foo() -> io::Result<String> {\n /// let mut buffer = String::new();\n-/// try!(io::empty().read_to_string(&mut buffer));\n-/// # Ok(buffer)\n-/// # }\n+/// io::empty().read_to_string(&mut buffer).unwrap();\n+/// assert!(buffer.is_empty());\n /// ```\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n pub fn empty() -> Empty { Empty { _priv: () } }\n@@ -113,6 +110,16 @@ pub struct Repeat { byte: u8 }\n ///\n /// All reads from this reader will succeed by filling the specified buffer with\n /// the given byte.\n+///\n+/// # Examples\n+///\n+/// ```\n+/// use std::io::{self, Read};\n+///\n+/// let mut buffer = [0; 3];\n+/// io::repeat(0b101).read_exact(&mut buffer).unwrap();\n+/// assert_eq!(buffer, [0b101, 0b101, 0b101]);\n+/// ```\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n pub fn repeat(byte: u8) -> Repeat { Repeat { byte: byte } }\n \n@@ -139,6 +146,16 @@ pub struct Sink { _priv: () }\n ///\n /// All calls to `write` on the returned instance will return `Ok(buf.len())`\n /// and the contents of the buffer will not be inspected.\n+///\n+/// # Examples\n+///\n+/// ```rust\n+/// use std::io::{self, Write};\n+///\n+/// let mut buffer = vec![1, 2, 3, 5, 8];\n+/// let num_bytes = io::sink().write(&mut buffer).unwrap();\n+/// assert_eq!(num_bytes, 5);\n+/// ```\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n pub fn sink() -> Sink { Sink { _priv: () } }\n "}, {"sha": "17d412411c0481fe47813bfca8f0270cdfdaf707", "filename": "src/libstd/num/f32.rs", "status": "modified", "additions": 10, "deletions": 8, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibstd%2Fnum%2Ff32.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibstd%2Fnum%2Ff32.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fnum%2Ff32.rs?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -217,7 +217,7 @@ impl f32 {\n     /// // Values between `0` and `min` are Subnormal.\n     /// assert!(!lower_than_min.is_normal());\n     /// ```\n-    /// [subnormal]: http://en.wikipedia.org/wiki/Denormal_number\n+    /// [subnormal]: https://en.wikipedia.org/wiki/Denormal_number\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     #[inline]\n     pub fn is_normal(self) -> bool { num::Float::is_normal(self) }\n@@ -923,12 +923,12 @@ impl f32 {\n     /// Computes the tangent of a number (in radians).\n     ///\n     /// ```\n-    /// use std::f64;\n+    /// use std::f32;\n     ///\n-    /// let x = f64::consts::PI/4.0;\n+    /// let x = f32::consts::PI / 4.0;\n     /// let abs_difference = (x.tan() - 1.0).abs();\n     ///\n-    /// assert!(abs_difference < 1e-10);\n+    /// assert!(abs_difference <= f32::EPSILON);\n     /// ```\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     #[inline]\n@@ -1052,12 +1052,14 @@ impl f32 {\n     /// number is close to zero.\n     ///\n     /// ```\n-    /// let x = 7.0f64;\n+    /// use std::f32;\n     ///\n-    /// // e^(ln(7)) - 1\n-    /// let abs_difference = (x.ln().exp_m1() - 6.0).abs();\n+    /// let x = 6.0f32;\n     ///\n-    /// assert!(abs_difference < 1e-10);\n+    /// // e^(ln(6)) - 1\n+    /// let abs_difference = (x.ln().exp_m1() - 5.0).abs();\n+    ///\n+    /// assert!(abs_difference <= f32::EPSILON);\n     /// ```\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     #[inline]"}, {"sha": "70b7706535ca17784f4ebf81f95aac4b93110b5d", "filename": "src/libstd/num/f64.rs", "status": "modified", "additions": 10, "deletions": 10, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibstd%2Fnum%2Ff64.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibstd%2Fnum%2Ff64.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fnum%2Ff64.rs?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -147,23 +147,23 @@ impl f64 {\n     /// [subnormal][subnormal], or `NaN`.\n     ///\n     /// ```\n-    /// use std::f32;\n+    /// use std::f64;\n     ///\n-    /// let min = f32::MIN_POSITIVE; // 1.17549435e-38f64\n-    /// let max = f32::MAX;\n-    /// let lower_than_min = 1.0e-40_f32;\n-    /// let zero = 0.0f32;\n+    /// let min = f64::MIN_POSITIVE; // 2.2250738585072014e-308f64\n+    /// let max = f64::MAX;\n+    /// let lower_than_min = 1.0e-308_f64;\n+    /// let zero = 0.0f64;\n     ///\n     /// assert!(min.is_normal());\n     /// assert!(max.is_normal());\n     ///\n     /// assert!(!zero.is_normal());\n-    /// assert!(!f32::NAN.is_normal());\n-    /// assert!(!f32::INFINITY.is_normal());\n+    /// assert!(!f64::NAN.is_normal());\n+    /// assert!(!f64::INFINITY.is_normal());\n     /// // Values between `0` and `min` are Subnormal.\n     /// assert!(!lower_than_min.is_normal());\n     /// ```\n-    /// [subnormal]: http://en.wikipedia.org/wiki/Denormal_number\n+    /// [subnormal]: https://en.wikipedia.org/wiki/Denormal_number\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     #[inline]\n     pub fn is_normal(self) -> bool { num::Float::is_normal(self) }\n@@ -655,9 +655,9 @@ impl f64 {\n     /// ```\n     /// #![feature(float_extras)]\n     ///\n-    /// let x = 1.0f32;\n+    /// let x = 1.0f64;\n     ///\n-    /// let abs_diff = (x.next_after(2.0) - 1.00000011920928955078125_f32).abs();\n+    /// let abs_diff = (x.next_after(2.0) - 1.0000000000000002220446049250313_f64).abs();\n     ///\n     /// assert!(abs_diff < 1e-10);\n     /// ```"}, {"sha": "c103ff7f4b025345a260fd586f01eb01829b643e", "filename": "src/libstd/path.rs", "status": "modified", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibstd%2Fpath.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibstd%2Fpath.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fpath.rs?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -525,6 +525,26 @@ impl<'a> Hash for PrefixComponent<'a> {\n ///\n /// See the module documentation for an in-depth explanation of components and\n /// their role in the API.\n+///\n+/// This `enum` is created from iterating over the [`path::Components`]\n+/// `struct`.\n+///\n+/// # Examples\n+///\n+/// ```rust\n+/// use std::path::{Component, Path};\n+///\n+/// let path = Path::new(\"/tmp/foo/bar.txt\");\n+/// let components = path.components().collect::<Vec<_>>();\n+/// assert_eq!(&components, &[\n+///     Component::RootDir,\n+///     Component::Normal(\"tmp\".as_ref()),\n+///     Component::Normal(\"foo\".as_ref()),\n+///     Component::Normal(\"bar.txt\".as_ref()),\n+/// ]);\n+/// ```\n+///\n+/// [`path::Components`]: struct.Components.html\n #[derive(Copy, Clone, PartialEq, Eq, PartialOrd, Ord, Hash, Debug)]\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n pub enum Component<'a> {"}, {"sha": "be9cd6a688858ff2fc6b8da382babd1d0c496892", "filename": "src/libstd/primitive_docs.rs", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibstd%2Fprimitive_docs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibstd%2Fprimitive_docs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fprimitive_docs.rs?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -490,9 +490,6 @@ mod prim_tuple { }\n ///\n /// *[See also the `std::f32` module](f32/index.html).*\n ///\n-/// However, please note that examples are shared between the `f64` and `f32`\n-/// primitive types. So it's normal if you see usage of `f64` in there.\n-///\n mod prim_f32 { }\n \n #[doc(primitive = \"f64\")]\n@@ -501,9 +498,6 @@ mod prim_f32 { }\n ///\n /// *[See also the `std::f64` module](f64/index.html).*\n ///\n-/// However, please note that examples are shared between the `f64` and `f32`\n-/// primitive types. So it's normal if you see usage of `f32` in there.\n-///\n mod prim_f64 { }\n \n #[doc(primitive = \"i8\")]"}, {"sha": "e9736fea7b37f43955f04d7137cefa517cfaaa9b", "filename": "src/libstd/thread/mod.rs", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibstd%2Fthread%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibstd%2Fthread%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fthread%2Fmod.rs?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -394,6 +394,19 @@ pub fn sleep_ms(ms: u32) {\n /// signal being received or a spurious wakeup. Platforms which do not support\n /// nanosecond precision for sleeping will have `dur` rounded up to the nearest\n /// granularity of time they can sleep for.\n+///\n+/// # Examples\n+///\n+/// ```rust,no_run\n+/// use std::{thread, time};\n+///\n+/// let ten_millis = time::Duration::from_millis(10);\n+/// let now = time::Instant::now();\n+///\n+/// thread::sleep(ten_millis);\n+///\n+/// assert!(now.elapsed() >= ten_millis);\n+/// ```\n #[stable(feature = \"thread_sleep\", since = \"1.4.0\")]\n pub fn sleep(dur: Duration) {\n     imp::Thread::sleep(dur)"}, {"sha": "94b71661bc21ec7714611162a27dadabbbc726ca", "filename": "src/libsyntax/print/pprust.rs", "status": "modified", "additions": 17, "deletions": 22, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibsyntax%2Fprint%2Fpprust.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Flibsyntax%2Fprint%2Fpprust.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fprint%2Fpprust.rs?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -1338,7 +1338,7 @@ impl<'a> State<'a> {\n                 if comma {\n                     try!(self.word_space(\",\"))\n                 }\n-                try!(self.print_lifetime_def(lifetime_def));\n+                try!(self.print_lifetime_bounds(&lifetime_def.lifetime, &lifetime_def.bounds));\n                 comma = true;\n             }\n             try!(word(&mut self.s, \">\"));\n@@ -2749,16 +2749,20 @@ impl<'a> State<'a> {\n         self.print_name(lifetime.name)\n     }\n \n-    pub fn print_lifetime_def(&mut self,\n-                              lifetime: &ast::LifetimeDef)\n-                              -> io::Result<()>\n+    pub fn print_lifetime_bounds(&mut self,\n+                                 lifetime: &ast::Lifetime,\n+                                 bounds: &[ast::Lifetime])\n+                                 -> io::Result<()>\n     {\n-        try!(self.print_lifetime(&lifetime.lifetime));\n-        let mut sep = \":\";\n-        for v in &lifetime.bounds {\n-            try!(word(&mut self.s, sep));\n-            try!(self.print_lifetime(v));\n-            sep = \"+\";\n+        try!(self.print_lifetime(lifetime));\n+        if !bounds.is_empty() {\n+            try!(word(&mut self.s, \": \"));\n+            for (i, bound) in bounds.iter().enumerate() {\n+                if i != 0 {\n+                    try!(word(&mut self.s, \" + \"));\n+                }\n+                try!(self.print_lifetime(bound));\n+            }\n         }\n         Ok(())\n     }\n@@ -2781,8 +2785,8 @@ impl<'a> State<'a> {\n \n         try!(self.commasep(Inconsistent, &ints[..], |s, &idx| {\n             if idx < generics.lifetimes.len() {\n-                let lifetime = &generics.lifetimes[idx];\n-                s.print_lifetime_def(lifetime)\n+                let lifetime_def = &generics.lifetimes[idx];\n+                s.print_lifetime_bounds(&lifetime_def.lifetime, &lifetime_def.bounds)\n             } else {\n                 let idx = idx - generics.lifetimes.len();\n                 let param = &generics.ty_params[idx];\n@@ -2833,16 +2837,7 @@ impl<'a> State<'a> {\n                 ast::WherePredicate::RegionPredicate(ast::WhereRegionPredicate{ref lifetime,\n                                                                                ref bounds,\n                                                                                ..}) => {\n-                    try!(self.print_lifetime(lifetime));\n-                    try!(word(&mut self.s, \":\"));\n-\n-                    for (i, bound) in bounds.iter().enumerate() {\n-                        try!(self.print_lifetime(bound));\n-\n-                        if i != 0 {\n-                            try!(word(&mut self.s, \":\"));\n-                        }\n-                    }\n+                    try!(self.print_lifetime_bounds(lifetime, bounds));\n                 }\n                 ast::WherePredicate::EqPredicate(ast::WhereEqPredicate{ref path, ref ty, ..}) => {\n                     try!(self.print_path(path, false, 0));"}, {"sha": "2cc7153b7f5ce57561c1107b3ad82903c180e0db", "filename": "src/test/pretty/lifetime.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Ftest%2Fpretty%2Flifetime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Ftest%2Fpretty%2Flifetime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fpretty%2Flifetime.rs?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -0,0 +1,15 @@\n+// Copyright 2016 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// pp-exact\n+\n+fn f1<'a, 'b, 'c>(_x: &'a u32, _y: &'b u32, _z: &'c u32) where 'c: 'a + 'b { }\n+\n+fn main() { }"}, {"sha": "388064a8be8546cd0078ef0abf0899b00d1c733d", "filename": "src/test/pretty/where-clauses.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Ftest%2Fpretty%2Fwhere-clauses.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Ftest%2Fpretty%2Fwhere-clauses.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fpretty%2Fwhere-clauses.rs?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -10,6 +10,6 @@\n \n // pp-exact\n \n-fn f<'a, 'b, T>(t: T) -> isize where T: 'a, 'a:'b, T: Eq { 0 }\n+fn f<'a, 'b, T>(t: T) -> isize where T: 'a, 'a: 'b, T: Eq { 0 }\n \n fn main() { }"}, {"sha": "a6de638854f65b082b6b3b1adf7a36bb70f54a3c", "filename": "src/test/rustdoc/issue-34473.rs", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Ftest%2Frustdoc%2Fissue-34473.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8751e077f32c4da4787986d9a93ca7645e7df95/src%2Ftest%2Frustdoc%2Fissue-34473.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fissue-34473.rs?ref=a8751e077f32c4da4787986d9a93ca7645e7df95", "patch": "@@ -0,0 +1,22 @@\n+// Copyright 2016 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+#![crate_name = \"foo\"]\n+\n+mod second {\n+    pub struct SomeTypeWithLongName;\n+}\n+\n+// @has foo/index.html\n+// @!has - SomeTypeWithLongName\n+// @has foo/struct.SomeType.html\n+// @!has - SomeTypeWithLongName\n+// @!has foo/struct.SomeTypeWithLongName.html\n+pub use second::{SomeTypeWithLongName as SomeType};"}]}