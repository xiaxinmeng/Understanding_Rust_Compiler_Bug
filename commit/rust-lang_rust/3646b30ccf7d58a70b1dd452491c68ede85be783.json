{"sha": "3646b30ccf7d58a70b1dd452491c68ede85be783", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM2NDZiMzBjY2Y3ZDU4YTcwYjFkZDQ1MjQ5MWM2OGVkZTg1YmU3ODM=", "commit": {"author": {"name": "mcarton", "email": "cartonmartin+git@gmail.com", "date": "2016-06-17T11:21:46Z"}, "committer": {"name": "mcarton", "email": "cartonmartin+git@gmail.com", "date": "2016-06-17T11:21:46Z"}, "message": "Include restriction lints in the wiki", "tree": {"sha": "62840d204d0f236a2a9a8071aa04ce61f571ed0e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/62840d204d0f236a2a9a8071aa04ce61f571ed0e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3646b30ccf7d58a70b1dd452491c68ede85be783", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3646b30ccf7d58a70b1dd452491c68ede85be783", "html_url": "https://github.com/rust-lang/rust/commit/3646b30ccf7d58a70b1dd452491c68ede85be783", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3646b30ccf7d58a70b1dd452491c68ede85be783/comments", "author": {"login": "mcarton", "id": 3751788, "node_id": "MDQ6VXNlcjM3NTE3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/3751788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mcarton", "html_url": "https://github.com/mcarton", "followers_url": "https://api.github.com/users/mcarton/followers", "following_url": "https://api.github.com/users/mcarton/following{/other_user}", "gists_url": "https://api.github.com/users/mcarton/gists{/gist_id}", "starred_url": "https://api.github.com/users/mcarton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mcarton/subscriptions", "organizations_url": "https://api.github.com/users/mcarton/orgs", "repos_url": "https://api.github.com/users/mcarton/repos", "events_url": "https://api.github.com/users/mcarton/events{/privacy}", "received_events_url": "https://api.github.com/users/mcarton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mcarton", "id": 3751788, "node_id": "MDQ6VXNlcjM3NTE3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/3751788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mcarton", "html_url": "https://github.com/mcarton", "followers_url": "https://api.github.com/users/mcarton/followers", "following_url": "https://api.github.com/users/mcarton/following{/other_user}", "gists_url": "https://api.github.com/users/mcarton/gists{/gist_id}", "starred_url": "https://api.github.com/users/mcarton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mcarton/subscriptions", "organizations_url": "https://api.github.com/users/mcarton/orgs", "repos_url": "https://api.github.com/users/mcarton/repos", "events_url": "https://api.github.com/users/mcarton/events{/privacy}", "received_events_url": "https://api.github.com/users/mcarton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d921dfa2c3fc88aef7abb51977419a30e612adee", "url": "https://api.github.com/repos/rust-lang/rust/commits/d921dfa2c3fc88aef7abb51977419a30e612adee", "html_url": "https://github.com/rust-lang/rust/commit/d921dfa2c3fc88aef7abb51977419a30e612adee"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "e8b2280cb471637ebde0b52d5aef812aab1a6975", "filename": "util/update_wiki.py", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/3646b30ccf7d58a70b1dd452491c68ede85be783/util%2Fupdate_wiki.py", "raw_url": "https://github.com/rust-lang/rust/raw/3646b30ccf7d58a70b1dd452491c68ede85be783/util%2Fupdate_wiki.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/util%2Fupdate_wiki.py?ref=3646b30ccf7d58a70b1dd452491c68ede85be783", "patch": "@@ -52,6 +52,11 @@ def parse_file(d, f):\n                 elif line.startswith(\"declare_lint!\"):\n                     comment = False\n                     deprecated = False\n+                    restriction = False\n+                elif line.startswith(\"declare_restriction_lint!\"):\n+                    comment = False\n+                    deprecated = False\n+                    restriction = True\n                 elif line.startswith(\"declare_deprecated_lint!\"):\n                     comment = False\n                     deprecated = True\n@@ -65,7 +70,7 @@ def parse_file(d, f):\n                     name = m.group(1).lower()\n \n                     # Intentionally either a never looping or infinite loop\n-                    while not deprecated:\n+                    while not deprecated and not restriction:\n                         m = re.search(level_re, line)\n                         if m:\n                             level = m.group(0)\n@@ -75,6 +80,8 @@ def parse_file(d, f):\n \n                     if deprecated:\n                         level = \"Deprecated\"\n+                    elif restriction:\n+                        level = \"Allow\"\n \n                     print(\"found %s with level %s in %s\" % (name, level, f))\n                     d[name] = (level, last_comment)\n@@ -162,6 +169,7 @@ def check_wiki_page(d, c, f):\n \n def main():\n     (d, c) = parse_path()\n+    print('Found %s lints' % len(d))\n     if \"-c\" in sys.argv:\n         check_wiki_page(d, c, \"../rust-clippy.wiki/Home.md\")\n     else:"}]}