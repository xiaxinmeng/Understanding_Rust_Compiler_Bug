{"sha": "a70653ac7e292670bb90fb57ecce796b09392590", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE3MDY1M2FjN2UyOTI2NzBiYjkwZmI1N2VjY2U3OTZiMDkzOTI1OTA=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-06-09T04:29:05Z"}, "committer": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-06-15T17:18:09Z"}, "message": "enum-variant-generic-args: describe + account for unit variants.", "tree": {"sha": "8d67a5ca1785a2d5d8e1cf2e02d5dc00adfefa4a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8d67a5ca1785a2d5d8e1cf2e02d5dc00adfefa4a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a70653ac7e292670bb90fb57ecce796b09392590", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a70653ac7e292670bb90fb57ecce796b09392590", "html_url": "https://github.com/rust-lang/rust/commit/a70653ac7e292670bb90fb57ecce796b09392590", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a70653ac7e292670bb90fb57ecce796b09392590/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "26f98fdf58b6d3b03f413169c8a2db36fef087dc", "url": "https://api.github.com/repos/rust-lang/rust/commits/26f98fdf58b6d3b03f413169c8a2db36fef087dc", "html_url": "https://github.com/rust-lang/rust/commit/26f98fdf58b6d3b03f413169c8a2db36fef087dc"}], "stats": {"total": 160, "additions": 130, "deletions": 30}, "files": [{"sha": "f182c3ba8c798ae86016659728efc0bc1c9aa088", "filename": "src/test/ui/type-alias-enum-variants/enum-variant-generic-args.rs", "status": "modified", "additions": 35, "deletions": 1, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/a70653ac7e292670bb90fb57ecce796b09392590/src%2Ftest%2Fui%2Ftype-alias-enum-variants%2Fenum-variant-generic-args.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a70653ac7e292670bb90fb57ecce796b09392590/src%2Ftest%2Fui%2Ftype-alias-enum-variants%2Fenum-variant-generic-args.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-enum-variants%2Fenum-variant-generic-args.rs?ref=a70653ac7e292670bb90fb57ecce796b09392590", "patch": "@@ -1,4 +1,10 @@\n-enum Enum<T> { TSVariant(T), SVariant { v: T } }\n+// Checks that applied type arguments of enums, and aliases to them, are respected.\n+// For example, `Self` is never a type constructor. Therefore, no types can be applied to it.\n+//\n+// We also check that the variant to an type-aliased enum cannot be type applied whether\n+// that alias is generic or monomorphic.\n+\n+enum Enum<T> { TSVariant(T), SVariant { v: T }, UVariant }\n type Alias<T> = Enum<T>;\n type AliasFixed = Enum<()>;\n \n@@ -30,6 +36,16 @@ impl<T> Enum<T> {\n         //~^^ ERROR type arguments are not allowed for this type [E0109]\n         //~^^^ ERROR mismatched types [E0308]\n     }\n+\n+    fn u_variant() {\n+        Self::UVariant::<()>;\n+        //~^ ERROR type arguments are not allowed for this type [E0109]\n+        Self::<()>::UVariant;\n+        //~^ ERROR type arguments are not allowed for this type [E0109]\n+        Self::<()>::UVariant::<()>;\n+        //~^ ERROR type arguments are not allowed for this type [E0109]\n+        //~^^ ERROR type arguments are not allowed for this type [E0109]\n+    }\n }\n \n fn main() {\n@@ -68,4 +84,22 @@ fn main() {\n     AliasFixed::<()>::SVariant::<()> { v: () };\n     //~^ ERROR type arguments are not allowed for this type [E0109]\n     //~^^ ERROR wrong number of type arguments: expected 0, found 1 [E0107]\n+\n+    // Unit variant\n+\n+    Enum::<()>::UVariant::<()>;\n+    //~^ ERROR type arguments are not allowed for this type [E0109]\n+\n+    Alias::UVariant::<()>;\n+    //~^ ERROR type arguments are not allowed for this type [E0109]\n+    Alias::<()>::UVariant::<()>;\n+    //~^ ERROR type arguments are not allowed for this type [E0109]\n+\n+    AliasFixed::UVariant::<()>;\n+    //~^ ERROR type arguments are not allowed for this type [E0109]\n+    AliasFixed::<()>::UVariant;\n+    //~^ ERROR wrong number of type arguments: expected 0, found 1 [E0107]\n+    AliasFixed::<()>::UVariant::<()>;\n+    //~^ ERROR type arguments are not allowed for this type [E0109]\n+    //~^^ ERROR wrong number of type arguments: expected 0, found 1 [E0107]\n }"}, {"sha": "ee73622cb7bd1f9b260041a4b733dc1b60d510bb", "filename": "src/test/ui/type-alias-enum-variants/enum-variant-generic-args.stderr", "status": "modified", "additions": 95, "deletions": 29, "changes": 124, "blob_url": "https://github.com/rust-lang/rust/blob/a70653ac7e292670bb90fb57ecce796b09392590/src%2Ftest%2Fui%2Ftype-alias-enum-variants%2Fenum-variant-generic-args.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a70653ac7e292670bb90fb57ecce796b09392590/src%2Ftest%2Fui%2Ftype-alias-enum-variants%2Fenum-variant-generic-args.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-enum-variants%2Fenum-variant-generic-args.stderr?ref=a70653ac7e292670bb90fb57ecce796b09392590", "patch": "@@ -1,5 +1,5 @@\n error[E0308]: mismatched types\n-  --> $DIR/enum-variant-generic-args.rs:7:25\n+  --> $DIR/enum-variant-generic-args.rs:13:25\n    |\n LL |         Self::TSVariant(());\n    |                         ^^ expected type parameter, found ()\n@@ -8,19 +8,19 @@ LL |         Self::TSVariant(());\n               found type `()`\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:9:27\n+  --> $DIR/enum-variant-generic-args.rs:15:27\n    |\n LL |         Self::TSVariant::<()>(());\n    |                           ^^ type argument not allowed\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:11:16\n+  --> $DIR/enum-variant-generic-args.rs:17:16\n    |\n LL |         Self::<()>::TSVariant(());\n    |                ^^ type argument not allowed\n \n error[E0308]: mismatched types\n-  --> $DIR/enum-variant-generic-args.rs:11:31\n+  --> $DIR/enum-variant-generic-args.rs:17:31\n    |\n LL |         Self::<()>::TSVariant(());\n    |                               ^^ expected type parameter, found ()\n@@ -29,19 +29,19 @@ LL |         Self::<()>::TSVariant(());\n               found type `()`\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:14:16\n+  --> $DIR/enum-variant-generic-args.rs:20:16\n    |\n LL |         Self::<()>::TSVariant::<()>(());\n    |                ^^ type argument not allowed\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:14:33\n+  --> $DIR/enum-variant-generic-args.rs:20:33\n    |\n LL |         Self::<()>::TSVariant::<()>(());\n    |                                 ^^ type argument not allowed\n \n error[E0308]: mismatched types\n-  --> $DIR/enum-variant-generic-args.rs:20:29\n+  --> $DIR/enum-variant-generic-args.rs:26:29\n    |\n LL |         Self::SVariant { v: () };\n    |                             ^^ expected type parameter, found ()\n@@ -50,13 +50,13 @@ LL |         Self::SVariant { v: () };\n               found type `()`\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:22:26\n+  --> $DIR/enum-variant-generic-args.rs:28:26\n    |\n LL |         Self::SVariant::<()> { v: () };\n    |                          ^^ type argument not allowed\n \n error[E0308]: mismatched types\n-  --> $DIR/enum-variant-generic-args.rs:22:35\n+  --> $DIR/enum-variant-generic-args.rs:28:35\n    |\n LL |         Self::SVariant::<()> { v: () };\n    |                                   ^^ expected type parameter, found ()\n@@ -65,13 +65,13 @@ LL |         Self::SVariant::<()> { v: () };\n               found type `()`\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:25:16\n+  --> $DIR/enum-variant-generic-args.rs:31:16\n    |\n LL |         Self::<()>::SVariant { v: () };\n    |                ^^ type argument not allowed\n \n error[E0308]: mismatched types\n-  --> $DIR/enum-variant-generic-args.rs:25:35\n+  --> $DIR/enum-variant-generic-args.rs:31:35\n    |\n LL |         Self::<()>::SVariant { v: () };\n    |                                   ^^ expected type parameter, found ()\n@@ -80,19 +80,19 @@ LL |         Self::<()>::SVariant { v: () };\n               found type `()`\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:28:16\n+  --> $DIR/enum-variant-generic-args.rs:34:16\n    |\n LL |         Self::<()>::SVariant::<()> { v: () };\n    |                ^^ type argument not allowed\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:28:32\n+  --> $DIR/enum-variant-generic-args.rs:34:32\n    |\n LL |         Self::<()>::SVariant::<()> { v: () };\n    |                                ^^ type argument not allowed\n \n error[E0308]: mismatched types\n-  --> $DIR/enum-variant-generic-args.rs:28:41\n+  --> $DIR/enum-variant-generic-args.rs:34:41\n    |\n LL |         Self::<()>::SVariant::<()> { v: () };\n    |                                         ^^ expected type parameter, found ()\n@@ -101,90 +101,156 @@ LL |         Self::<()>::SVariant::<()> { v: () };\n               found type `()`\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:38:29\n+  --> $DIR/enum-variant-generic-args.rs:41:26\n+   |\n+LL |         Self::UVariant::<()>;\n+   |                          ^^ type argument not allowed\n+\n+error[E0109]: type arguments are not allowed for this type\n+  --> $DIR/enum-variant-generic-args.rs:43:16\n+   |\n+LL |         Self::<()>::UVariant;\n+   |                ^^ type argument not allowed\n+\n+error[E0109]: type arguments are not allowed for this type\n+  --> $DIR/enum-variant-generic-args.rs:45:16\n+   |\n+LL |         Self::<()>::UVariant::<()>;\n+   |                ^^ type argument not allowed\n+\n+error[E0109]: type arguments are not allowed for this type\n+  --> $DIR/enum-variant-generic-args.rs:45:32\n+   |\n+LL |         Self::<()>::UVariant::<()>;\n+   |                                ^^ type argument not allowed\n+\n+error[E0109]: type arguments are not allowed for this type\n+  --> $DIR/enum-variant-generic-args.rs:54:29\n    |\n LL |     Enum::<()>::TSVariant::<()>(());\n    |                             ^^ type argument not allowed\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:41:24\n+  --> $DIR/enum-variant-generic-args.rs:57:24\n    |\n LL |     Alias::TSVariant::<()>(());\n    |                        ^^ type argument not allowed\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:43:30\n+  --> $DIR/enum-variant-generic-args.rs:59:30\n    |\n LL |     Alias::<()>::TSVariant::<()>(());\n    |                              ^^ type argument not allowed\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:46:29\n+  --> $DIR/enum-variant-generic-args.rs:62:29\n    |\n LL |     AliasFixed::TSVariant::<()>(());\n    |                             ^^ type argument not allowed\n \n error[E0107]: wrong number of type arguments: expected 0, found 1\n-  --> $DIR/enum-variant-generic-args.rs:48:18\n+  --> $DIR/enum-variant-generic-args.rs:64:18\n    |\n LL |     AliasFixed::<()>::TSVariant(());\n    |                  ^^ unexpected type argument\n \n error[E0107]: wrong number of type arguments: expected 0, found 1\n-  --> $DIR/enum-variant-generic-args.rs:50:18\n+  --> $DIR/enum-variant-generic-args.rs:66:18\n    |\n LL |     AliasFixed::<()>::TSVariant::<()>(());\n    |                  ^^ unexpected type argument\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:50:35\n+  --> $DIR/enum-variant-generic-args.rs:66:35\n    |\n LL |     AliasFixed::<()>::TSVariant::<()>(());\n    |                                   ^^ type argument not allowed\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:56:28\n+  --> $DIR/enum-variant-generic-args.rs:72:28\n    |\n LL |     Enum::<()>::SVariant::<()> { v: () };\n    |                            ^^ type argument not allowed\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:59:23\n+  --> $DIR/enum-variant-generic-args.rs:75:23\n    |\n LL |     Alias::SVariant::<()> { v: () };\n    |                       ^^ type argument not allowed\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:61:29\n+  --> $DIR/enum-variant-generic-args.rs:77:29\n    |\n LL |     Alias::<()>::SVariant::<()> { v: () };\n    |                             ^^ type argument not allowed\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:64:28\n+  --> $DIR/enum-variant-generic-args.rs:80:28\n    |\n LL |     AliasFixed::SVariant::<()> { v: () };\n    |                            ^^ type argument not allowed\n \n error[E0107]: wrong number of type arguments: expected 0, found 1\n-  --> $DIR/enum-variant-generic-args.rs:66:18\n+  --> $DIR/enum-variant-generic-args.rs:82:18\n    |\n LL |     AliasFixed::<()>::SVariant { v: () };\n    |                  ^^ unexpected type argument\n \n error[E0107]: wrong number of type arguments: expected 0, found 1\n-  --> $DIR/enum-variant-generic-args.rs:68:18\n+  --> $DIR/enum-variant-generic-args.rs:84:18\n    |\n LL |     AliasFixed::<()>::SVariant::<()> { v: () };\n    |                  ^^ unexpected type argument\n \n error[E0109]: type arguments are not allowed for this type\n-  --> $DIR/enum-variant-generic-args.rs:68:34\n+  --> $DIR/enum-variant-generic-args.rs:84:34\n    |\n LL |     AliasFixed::<()>::SVariant::<()> { v: () };\n    |                                  ^^ type argument not allowed\n \n-error: aborting due to 28 previous errors\n+error[E0109]: type arguments are not allowed for this type\n+  --> $DIR/enum-variant-generic-args.rs:90:28\n+   |\n+LL |     Enum::<()>::UVariant::<()>;\n+   |                            ^^ type argument not allowed\n+\n+error[E0109]: type arguments are not allowed for this type\n+  --> $DIR/enum-variant-generic-args.rs:93:23\n+   |\n+LL |     Alias::UVariant::<()>;\n+   |                       ^^ type argument not allowed\n+\n+error[E0109]: type arguments are not allowed for this type\n+  --> $DIR/enum-variant-generic-args.rs:95:29\n+   |\n+LL |     Alias::<()>::UVariant::<()>;\n+   |                             ^^ type argument not allowed\n+\n+error[E0109]: type arguments are not allowed for this type\n+  --> $DIR/enum-variant-generic-args.rs:98:28\n+   |\n+LL |     AliasFixed::UVariant::<()>;\n+   |                            ^^ type argument not allowed\n+\n+error[E0107]: wrong number of type arguments: expected 0, found 1\n+  --> $DIR/enum-variant-generic-args.rs:100:18\n+   |\n+LL |     AliasFixed::<()>::UVariant;\n+   |                  ^^ unexpected type argument\n+\n+error[E0107]: wrong number of type arguments: expected 0, found 1\n+  --> $DIR/enum-variant-generic-args.rs:102:18\n+   |\n+LL |     AliasFixed::<()>::UVariant::<()>;\n+   |                  ^^ unexpected type argument\n+\n+error[E0109]: type arguments are not allowed for this type\n+  --> $DIR/enum-variant-generic-args.rs:102:34\n+   |\n+LL |     AliasFixed::<()>::UVariant::<()>;\n+   |                                  ^^ type argument not allowed\n+\n+error: aborting due to 39 previous errors\n \n Some errors have detailed explanations: E0107, E0109, E0308.\n For more information about an error, try `rustc --explain E0107`."}]}