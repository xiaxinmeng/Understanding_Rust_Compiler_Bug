{"sha": "e25cbf85849a48e02701736375c784b3e3e0e3fc", "node_id": "C_kwDOAAsO6NoAKGUyNWNiZjg1ODQ5YTQ4ZTAyNzAxNzM2Mzc1Yzc4NGIzZTNlMGUzZmM", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-05-31T18:22:41Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-05-31T18:22:41Z"}, "message": "Auto merge of #12430 - Veykril:completions, r=Veykril\n\nminor: Remove unused code", "tree": {"sha": "9c29775d54c6f240d3d9b0238c460db24ee81e7e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9c29775d54c6f240d3d9b0238c460db24ee81e7e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e25cbf85849a48e02701736375c784b3e3e0e3fc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e25cbf85849a48e02701736375c784b3e3e0e3fc", "html_url": "https://github.com/rust-lang/rust/commit/e25cbf85849a48e02701736375c784b3e3e0e3fc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e25cbf85849a48e02701736375c784b3e3e0e3fc/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e10799536a22a777891f5a971626e79c17097f9e", "url": "https://api.github.com/repos/rust-lang/rust/commits/e10799536a22a777891f5a971626e79c17097f9e", "html_url": "https://github.com/rust-lang/rust/commit/e10799536a22a777891f5a971626e79c17097f9e"}, {"sha": "1234d8647f42460df7e857514ee1534dc55372e5", "url": "https://api.github.com/repos/rust-lang/rust/commits/1234d8647f42460df7e857514ee1534dc55372e5", "html_url": "https://github.com/rust-lang/rust/commit/1234d8647f42460df7e857514ee1534dc55372e5"}], "stats": {"total": 18, "additions": 0, "deletions": 18}, "files": [{"sha": "f3e316ff3c1dfc88c3310d3e4c2ebed8080d1f26", "filename": "crates/ide-completion/src/context.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/e25cbf85849a48e02701736375c784b3e3e0e3fc/crates%2Fide-completion%2Fsrc%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e25cbf85849a48e02701736375c784b3e3e0e3fc/crates%2Fide-completion%2Fsrc%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide-completion%2Fsrc%2Fcontext.rs?ref=e25cbf85849a48e02701736375c784b3e3e0e3fc", "patch": "@@ -383,7 +383,6 @@ impl<'a> CompletionContext<'a> {\n     // FIXME: This shouldn't exist\n     pub(crate) fn is_path_disallowed(&self) -> bool {\n         !self.qualifier_ctx.none()\n-            || matches!(self.prev_sibling, Some(ImmediatePrevSibling::Visibility))\n             || (matches!(self.name_ctx(), Some(NameContext { .. })) && self.pattern_ctx.is_none())\n             || matches!(self.pattern_ctx, Some(PatternContext { record_pat: Some(_), .. }))\n             || matches!("}, {"sha": "cc599a02cb26f6987ab7dcadb1db0b257e999ddc", "filename": "crates/ide-completion/src/patterns.rs", "status": "modified", "additions": 0, "deletions": 17, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/e25cbf85849a48e02701736375c784b3e3e0e3fc/crates%2Fide-completion%2Fsrc%2Fpatterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e25cbf85849a48e02701736375c784b3e3e0e3fc/crates%2Fide-completion%2Fsrc%2Fpatterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide-completion%2Fsrc%2Fpatterns.rs?ref=e25cbf85849a48e02701736375c784b3e3e0e3fc", "patch": "@@ -23,7 +23,6 @@ pub(crate) enum ImmediatePrevSibling {\n     IfExpr,\n     TraitDefName,\n     ImplDefType,\n-    Visibility,\n }\n \n #[derive(Clone, Debug, PartialEq, Eq)]\n@@ -77,17 +76,6 @@ pub(crate) fn determine_prev_sibling(name_like: &ast::NameLike) -> Option<Immedi\n         _ => node,\n     };\n     let prev_sibling = non_trivia_sibling(node.into(), Direction::Prev)?.into_node()?;\n-    if prev_sibling.kind() == ERROR {\n-        let prev_sibling = prev_sibling.first_child()?;\n-        let res = match_ast! {\n-            match prev_sibling {\n-                // vis followed by random ident will always error the parser\n-                ast::Visibility(_) => ImmediatePrevSibling::Visibility,\n-                _ => return None,\n-            }\n-        };\n-        return Some(res);\n-    }\n     let res = match_ast! {\n         match prev_sibling {\n             ast::ExprStmt(it) => {\n@@ -442,9 +430,4 @@ mod tests {\n         check_prev_sibling(r\"fn foo() { if true {} w$0\", ImmediatePrevSibling::IfExpr);\n         check_prev_sibling(r\"fn foo() { if true {}; w$0\", None);\n     }\n-\n-    #[test]\n-    fn test_vis_prev_sibling() {\n-        check_prev_sibling(r\"pub w$0\", ImmediatePrevSibling::Visibility);\n-    }\n }"}]}