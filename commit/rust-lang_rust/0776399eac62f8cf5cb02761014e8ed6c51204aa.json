{"sha": "0776399eac62f8cf5cb02761014e8ed6c51204aa", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA3NzYzOTllYWM2MmY4Y2Y1Y2IwMjc2MTAxNGU4ZWQ2YzUxMjA0YWE=", "commit": {"author": {"name": "Eduard Burtescu", "email": "edy.burt@gmail.com", "date": "2016-04-18T12:38:45Z"}, "committer": {"name": "Eduard Burtescu", "email": "edy.burt@gmail.com", "date": "2016-04-19T13:08:45Z"}, "message": "Make data-layout mandatory in target specs.", "tree": {"sha": "ce4873190bd024695a3642f8e02b2ba122844f61", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ce4873190bd024695a3642f8e02b2ba122844f61"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0776399eac62f8cf5cb02761014e8ed6c51204aa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0776399eac62f8cf5cb02761014e8ed6c51204aa", "html_url": "https://github.com/rust-lang/rust/commit/0776399eac62f8cf5cb02761014e8ed6c51204aa", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0776399eac62f8cf5cb02761014e8ed6c51204aa/comments", "author": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e8c0aeb88ba1e12d0c0a1d0ed7b4a90b44460a29", "url": "https://api.github.com/repos/rust-lang/rust/commits/e8c0aeb88ba1e12d0c0a1d0ed7b4a90b44460a29", "html_url": "https://github.com/rust-lang/rust/commit/e8c0aeb88ba1e12d0c0a1d0ed7b4a90b44460a29"}], "stats": {"total": 87, "additions": 73, "deletions": 14}, "files": [{"sha": "2f0a043f9a7de907158e28a1bb7a617659b94ef2", "filename": "src/librustc_back/target/aarch64_apple_ios.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Faarch64_apple_ios.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Faarch64_apple_ios.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Faarch64_apple_ios.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -16,6 +16,7 @@ pub fn target() -> Target {\n         llvm_target: \"arm64-apple-ios\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n+        data_layout: \"e-m:o-i64:64-i128:128-n32:64-S128\".to_string(),\n         arch: \"aarch64\".to_string(),\n         target_os: \"ios\".to_string(),\n         target_env: \"\".to_string(),"}, {"sha": "c4212e702129cb93fe36c9dc8393722f90823855", "filename": "src/librustc_back/target/aarch64_linux_android.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Faarch64_linux_android.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Faarch64_linux_android.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Faarch64_linux_android.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -15,6 +15,7 @@ pub fn target() -> Target {\n         llvm_target: \"aarch64-linux-android\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n+        data_layout: \"e-m:e-i64:64-i128:128-n32:64-S128\".to_string(),\n         arch: \"aarch64\".to_string(),\n         target_os: \"android\".to_string(),\n         target_env: \"\".to_string(),"}, {"sha": "3bf4e92fb6aab134e4a71fee62f1005cddd22878", "filename": "src/librustc_back/target/aarch64_unknown_linux_gnu.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Faarch64_unknown_linux_gnu.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Faarch64_unknown_linux_gnu.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Faarch64_unknown_linux_gnu.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -17,6 +17,7 @@ pub fn target() -> Target {\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n         target_env: \"gnu\".to_string(),\n+        data_layout: \"e-m:e-i64:64-i128:128-n32:64-S128\".to_string(),\n         arch: \"aarch64\".to_string(),\n         target_os: \"linux\".to_string(),\n         target_vendor: \"unknown\".to_string(),"}, {"sha": "0a61b14763476f72f5389c8b300338a211fa5fb1", "filename": "src/librustc_back/target/arm_linux_androideabi.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Farm_linux_androideabi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Farm_linux_androideabi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Farm_linux_androideabi.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -18,6 +18,7 @@ pub fn target() -> Target {\n         llvm_target: \"arm-linux-androideabi\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:e-p:32:32-i64:64-v128:64:128-a:0:32-n32-S64\".to_string(),\n         arch: \"arm\".to_string(),\n         target_os: \"android\".to_string(),\n         target_env: \"gnu\".to_string(),"}, {"sha": "0cb0949d4622fa7066adc8f3820fdbac4c6bdf9d", "filename": "src/librustc_back/target/arm_unknown_linux_gnueabi.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Farm_unknown_linux_gnueabi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Farm_unknown_linux_gnueabi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Farm_unknown_linux_gnueabi.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -16,6 +16,7 @@ pub fn target() -> Target {\n         llvm_target: \"arm-unknown-linux-gnueabi\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:e-p:32:32-i64:64-v128:64:128-a:0:32-n32-S64\".to_string(),\n         arch: \"arm\".to_string(),\n         target_os: \"linux\".to_string(),\n         target_env: \"gnueabi\".to_string(),"}, {"sha": "05b9401a0635c99d1337c8092b6f45924bd2e1e3", "filename": "src/librustc_back/target/arm_unknown_linux_gnueabihf.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Farm_unknown_linux_gnueabihf.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Farm_unknown_linux_gnueabihf.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Farm_unknown_linux_gnueabihf.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -16,6 +16,7 @@ pub fn target() -> Target {\n         llvm_target: \"arm-unknown-linux-gnueabihf\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:e-p:32:32-i64:64-v128:64:128-a:0:32-n32-S64\".to_string(),\n         arch: \"arm\".to_string(),\n         target_os: \"linux\".to_string(),\n         target_env: \"gnueabihf\".to_string(),"}, {"sha": "d131f8b2ef002b9e405ba7555e1b530f271058f4", "filename": "src/librustc_back/target/armv7_apple_ios.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Farmv7_apple_ios.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Farmv7_apple_ios.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Farmv7_apple_ios.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -16,6 +16,7 @@ pub fn target() -> Target {\n         llvm_target: \"armv7-apple-ios\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:o-p:32:32-f64:32:64-v64:32:64-v128:32:128-a:0:32-n32-S32\".to_string(),\n         arch: \"arm\".to_string(),\n         target_os: \"ios\".to_string(),\n         target_env: \"\".to_string(),"}, {"sha": "9c9bb72f76cfdecfd43c6d1536e7ecde98a3052e", "filename": "src/librustc_back/target/armv7_unknown_linux_gnueabihf.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Farmv7_unknown_linux_gnueabihf.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Farmv7_unknown_linux_gnueabihf.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Farmv7_unknown_linux_gnueabihf.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -16,6 +16,7 @@ pub fn target() -> Target {\n         llvm_target: \"armv7-unknown-linux-gnueabihf\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:e-p:32:32-i64:64-v128:64:128-a:0:32-n32-S64\".to_string(),\n         arch: \"arm\".to_string(),\n         target_os: \"linux\".to_string(),\n         target_env: \"gnueabihf\".to_string(),"}, {"sha": "d317589bf3680fc2075b8960daaef5d54eb76df0", "filename": "src/librustc_back/target/armv7s_apple_ios.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Farmv7s_apple_ios.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Farmv7s_apple_ios.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Farmv7s_apple_ios.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -16,6 +16,7 @@ pub fn target() -> Target {\n         llvm_target: \"armv7s-apple-ios\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:o-p:32:32-f64:32:64-v64:32:64-v128:32:128-a:0:32-n32-S32\".to_string(),\n         arch: \"arm\".to_string(),\n         target_os: \"ios\".to_string(),\n         target_env: \"\".to_string(),"}, {"sha": "546f9df605b30f49ab82ccc56a6bc869d3eb27da", "filename": "src/librustc_back/target/asmjs_unknown_emscripten.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fasmjs_unknown_emscripten.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fasmjs_unknown_emscripten.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fasmjs_unknown_emscripten.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -31,6 +31,7 @@ pub fn target() -> Target {\n         target_os: \"emscripten\".to_string(),\n         target_env: \"\".to_string(),\n         target_vendor: \"unknown\".to_string(),\n+        data_layout: \"e-p:32:32-i64:64-v128:32:128-n32-S128\".to_string(),\n         arch: \"asmjs\".to_string(),\n         options: opts,\n     }"}, {"sha": "d149d4bbdc2d6e51e045923703eeb975970303bf", "filename": "src/librustc_back/target/i386_apple_ios.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi386_apple_ios.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi386_apple_ios.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fi386_apple_ios.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -16,6 +16,7 @@ pub fn target() -> Target {\n         llvm_target: \"i386-apple-ios\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:o-p:32:32-f64:32:64-f80:128-n8:16:32-S128\".to_string(),\n         arch: \"x86\".to_string(),\n         target_os: \"ios\".to_string(),\n         target_env: \"\".to_string(),"}, {"sha": "b6e2f4d8e8ac9bf2f2b7f1d548e42e2f5dde27d1", "filename": "src/librustc_back/target/i686_apple_darwin.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi686_apple_darwin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi686_apple_darwin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fi686_apple_darwin.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -19,6 +19,7 @@ pub fn target() -> Target {\n         llvm_target: \"i686-apple-darwin\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:o-p:32:32-f64:32:64-f80:128-n8:16:32-S128\".to_string(),\n         arch: \"x86\".to_string(),\n         target_os: \"macos\".to_string(),\n         target_env: \"\".to_string(),"}, {"sha": "b338a971ff74cb730645e9fe54dff480ceee30b1", "filename": "src/librustc_back/target/i686_linux_android.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi686_linux_android.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi686_linux_android.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fi686_linux_android.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -18,6 +18,7 @@ pub fn target() -> Target {\n         llvm_target: \"i686-linux-android\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:e-p:32:32-f64:32:64-f80:32-n8:16:32-S128\".to_string(),\n         arch: \"x86\".to_string(),\n         target_os: \"android\".to_string(),\n         target_env: \"gnu\".to_string(),"}, {"sha": "48203cc74d6a1df74673d1cf94c6ef61b4032129", "filename": "src/librustc_back/target/i686_pc_windows_gnu.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi686_pc_windows_gnu.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi686_pc_windows_gnu.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fi686_pc_windows_gnu.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -22,6 +22,7 @@ pub fn target() -> Target {\n         llvm_target: \"i686-pc-windows-gnu\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:x-p:32:32-i64:64-f80:32-n8:16:32-a:0:32-S32\".to_string(),\n         arch: \"x86\".to_string(),\n         target_os: \"windows\".to_string(),\n         target_env: \"gnu\".to_string(),"}, {"sha": "501219ad607cf6be9bf7533e19335bab1d442fbe", "filename": "src/librustc_back/target/i686_pc_windows_msvc.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi686_pc_windows_msvc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi686_pc_windows_msvc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fi686_pc_windows_msvc.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -27,6 +27,7 @@ pub fn target() -> Target {\n         llvm_target: \"i686-pc-windows-msvc\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:x-p:32:32-i64:64-f80:32-n8:16:32-a:0:32-S32\".to_string(),\n         arch: \"x86\".to_string(),\n         target_os: \"windows\".to_string(),\n         target_env: \"msvc\".to_string(),"}, {"sha": "cdbbd5eafddbb7239c67cf3541d4e6fec797be2b", "filename": "src/librustc_back/target/i686_unknown_dragonfly.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi686_unknown_dragonfly.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi686_unknown_dragonfly.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fi686_unknown_dragonfly.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -19,6 +19,7 @@ pub fn target() -> Target {\n         llvm_target: \"i686-unknown-dragonfly\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:e-p:32:32-f64:32:64-f80:32-n8:16:32-S128\".to_string(),\n         arch: \"x86\".to_string(),\n         target_os: \"dragonfly\".to_string(),\n         target_env: \"\".to_string(),"}, {"sha": "fadedc24149c7cf73dacd5a692989d358c149afe", "filename": "src/librustc_back/target/i686_unknown_freebsd.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi686_unknown_freebsd.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi686_unknown_freebsd.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fi686_unknown_freebsd.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -19,6 +19,7 @@ pub fn target() -> Target {\n         llvm_target: \"i686-unknown-freebsd\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:e-p:32:32-f64:32:64-f80:32-n8:16:32-S128\".to_string(),\n         arch: \"x86\".to_string(),\n         target_os: \"freebsd\".to_string(),\n         target_env: \"\".to_string(),"}, {"sha": "a1f3ab769070f99600bbbad2ee7c21126b753ecc", "filename": "src/librustc_back/target/i686_unknown_linux_gnu.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi686_unknown_linux_gnu.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi686_unknown_linux_gnu.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fi686_unknown_linux_gnu.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -19,6 +19,7 @@ pub fn target() -> Target {\n         llvm_target: \"i686-unknown-linux-gnu\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:e-p:32:32-f64:32:64-f80:32-n8:16:32-S128\".to_string(),\n         arch: \"x86\".to_string(),\n         target_os: \"linux\".to_string(),\n         target_env: \"gnu\".to_string(),"}, {"sha": "cce023b843016474deb4999c3a1b2a0e08747bfc", "filename": "src/librustc_back/target/i686_unknown_linux_musl.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi686_unknown_linux_musl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fi686_unknown_linux_musl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fi686_unknown_linux_musl.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -37,6 +37,7 @@ pub fn target() -> Target {\n         llvm_target: \"i686-unknown-linux-musl\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:e-p:32:32-f64:32:64-f80:32-n8:16:32-S128\".to_string(),\n         arch: \"x86\".to_string(),\n         target_os: \"linux\".to_string(),\n         target_env: \"musl\".to_string(),"}, {"sha": "472b73302a358e15dc75a35a821bd1b7650cecbf", "filename": "src/librustc_back/target/le32_unknown_nacl.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fle32_unknown_nacl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fle32_unknown_nacl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fle32_unknown_nacl.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -34,6 +34,7 @@ pub fn target() -> Target {\n         target_os: \"nacl\".to_string(),\n         target_env: \"newlib\".to_string(),\n         target_vendor: \"unknown\".to_string(),\n+        data_layout: \"e-i64:64:64-p:32:32:32-v128:32:32\".to_string(),\n         arch: \"le32\".to_string(),\n         options: opts,\n     }"}, {"sha": "863f5ceab0ae09c8a4e5146e230eccb58c578364", "filename": "src/librustc_back/target/mips_unknown_linux_gnu.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fmips_unknown_linux_gnu.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fmips_unknown_linux_gnu.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fmips_unknown_linux_gnu.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -15,6 +15,7 @@ pub fn target() -> Target {\n         llvm_target: \"mips-unknown-linux-gnu\".to_string(),\n         target_endian: \"big\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"E-m:m-p:32:32-i8:8:32-i16:16:32-i64:64-n32-S64\".to_string(),\n         arch: \"mips\".to_string(),\n         target_os: \"linux\".to_string(),\n         target_env: \"gnu\".to_string(),"}, {"sha": "ac0fde5449ff4eb889d55f883918e64d836b8417", "filename": "src/librustc_back/target/mips_unknown_linux_musl.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fmips_unknown_linux_musl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fmips_unknown_linux_musl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fmips_unknown_linux_musl.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -15,6 +15,7 @@ pub fn target() -> Target {\n         llvm_target: \"mips-unknown-linux-musl\".to_string(),\n         target_endian: \"big\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"E-m:m-p:32:32-i8:8:32-i16:16:32-i64:64-n32-S64\".to_string(),\n         arch: \"mips\".to_string(),\n         target_os: \"linux\".to_string(),\n         target_env: \"musl\".to_string(),"}, {"sha": "ff33effa3e79b708fe9db77025d0494d6fde351a", "filename": "src/librustc_back/target/mipsel_unknown_linux_gnu.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fmipsel_unknown_linux_gnu.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fmipsel_unknown_linux_gnu.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fmipsel_unknown_linux_gnu.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -15,6 +15,7 @@ pub fn target() -> Target {\n         llvm_target: \"mipsel-unknown-linux-gnu\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:m-p:32:32-i8:8:32-i16:16:32-i64:64-n32-S64\".to_string(),\n         arch: \"mips\".to_string(),\n         target_os: \"linux\".to_string(),\n         target_env: \"gnu\".to_string(),"}, {"sha": "d9fb14050365de27860e83759321d4417036f69d", "filename": "src/librustc_back/target/mipsel_unknown_linux_musl.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fmipsel_unknown_linux_musl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fmipsel_unknown_linux_musl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fmipsel_unknown_linux_musl.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -15,6 +15,7 @@ pub fn target() -> Target {\n         llvm_target: \"mipsel-unknown-linux-musl\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:m-p:32:32-i8:8:32-i16:16:32-i64:64-n32-S64\".to_string(),\n         arch: \"mips\".to_string(),\n         target_os: \"linux\".to_string(),\n         target_env: \"musl\".to_string(),"}, {"sha": "3f75201aad2cc1422e67910f93faabea63ed508c", "filename": "src/librustc_back/target/mod.rs", "status": "modified", "additions": 13, "deletions": 9, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fmod.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -39,10 +39,10 @@\n //! this module defines the format the JSON file should take, though each\n //! underscore in the field names should be replaced with a hyphen (`-`) in the\n //! JSON file. Some fields are required in every target specification, such as\n-//! `llvm-target`, `target-endian`, `target-pointer-width`, `arch`, and\n-//! `os`. In general, options passed to rustc with `-C` override the target's\n-//! settings, though `target-feature` and `link-args` will *add* to the list\n-//! specified by the target, rather than replace.\n+//! `llvm-target`, `target-endian`, `target-pointer-width`, `data-layout`,\n+//! `arch`, and `os`. In general, options passed to rustc with `-C` override\n+//! the target's settings, though `target-feature` and `link-args` will *add*\n+//! to the list specified by the target, rather than replace.\n \n use serialize::json::Json;\n use std::default::Default;\n@@ -75,7 +75,8 @@ macro_rules! supported_targets {\n             if false { }\n             $(\n                 else if target == stringify!($module) {\n-                    let t = $module::target();\n+                    let mut t = $module::target();\n+                    t.options.is_builtin = true;\n                     debug!(\"Got builtin target: {:?}\", t);\n                     return Some(t);\n                 }\n@@ -161,6 +162,8 @@ pub struct Target {\n     /// Architecture to use for ABI considerations. Valid options: \"x86\",\n     /// \"x86_64\", \"arm\", \"aarch64\", \"mips\", \"powerpc\", and \"powerpc64\".\n     pub arch: String,\n+    /// [Data layout](http://llvm.org/docs/LangRef.html#data-layout) to pass to LLVM.\n+    pub data_layout: String,\n     /// Optional settings with defaults.\n     pub options: TargetOptions,\n }\n@@ -171,8 +174,9 @@ pub struct Target {\n /// these try to take \"minimal defaults\" that don't assume anything about the runtime they run in.\n #[derive(Clone, Debug)]\n pub struct TargetOptions {\n-    /// [Data layout](http://llvm.org/docs/LangRef.html#data-layout) to pass to LLVM.\n-    pub data_layout: Option<String>,\n+    /// Whether the target is built-in or loaded from a custom target specification.\n+    pub is_builtin: bool,\n+\n     /// Linker to invoke. Defaults to \"cc\".\n     pub linker: String,\n     /// Archive utility to use when managing archives. Defaults to \"ar\".\n@@ -293,7 +297,7 @@ impl Default for TargetOptions {\n     /// incomplete, and if used for compilation, will certainly not work.\n     fn default() -> TargetOptions {\n         TargetOptions {\n-            data_layout: None,\n+            is_builtin: false,\n             linker: option_env!(\"CFG_DEFAULT_LINKER\").unwrap_or(\"cc\").to_string(),\n             ar: option_env!(\"CFG_DEFAULT_AR\").unwrap_or(\"ar\").to_string(),\n             pre_link_args: Vec::new(),\n@@ -378,6 +382,7 @@ impl Target {\n             llvm_target: get_req_field(\"llvm-target\"),\n             target_endian: get_req_field(\"target-endian\"),\n             target_pointer_width: get_req_field(\"target-pointer-width\"),\n+            data_layout: get_req_field(\"data-layout\"),\n             arch: get_req_field(\"arch\"),\n             target_os: get_req_field(\"os\"),\n             target_env: get_opt_field(\"env\", \"\"),\n@@ -426,7 +431,6 @@ impl Target {\n         key!(staticlib_prefix);\n         key!(staticlib_suffix);\n         key!(features);\n-        key!(data_layout, optional);\n         key!(dynamic_linking, bool);\n         key!(executables, bool);\n         key!(disable_redzone, bool);"}, {"sha": "fe7daaec1cdebac8445e54865832263b6cb9bfad", "filename": "src/librustc_back/target/powerpc64_unknown_linux_gnu.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fpowerpc64_unknown_linux_gnu.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fpowerpc64_unknown_linux_gnu.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fpowerpc64_unknown_linux_gnu.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -19,6 +19,7 @@ pub fn target() -> Target {\n         llvm_target: \"powerpc64-unknown-linux-gnu\".to_string(),\n         target_endian: \"big\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n+        data_layout: \"E-m:e-i64:64-n32:64\".to_string(),\n         arch: \"powerpc64\".to_string(),\n         target_os: \"linux\".to_string(),\n         target_env: \"gnu\".to_string(),"}, {"sha": "4aab2b1802c9871fef58a8b3ecfe1ded2aba8a80", "filename": "src/librustc_back/target/powerpc64le_unknown_linux_gnu.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fpowerpc64le_unknown_linux_gnu.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fpowerpc64le_unknown_linux_gnu.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fpowerpc64le_unknown_linux_gnu.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -19,6 +19,7 @@ pub fn target() -> Target {\n         llvm_target: \"powerpc64le-unknown-linux-gnu\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n+        data_layout: \"e-m:e-i64:64-n32:64\".to_string(),\n         arch: \"powerpc64\".to_string(),\n         target_os: \"linux\".to_string(),\n         target_env: \"gnu\".to_string(),"}, {"sha": "1df36442c06884bf205311b2965fb619bcb72325", "filename": "src/librustc_back/target/powerpc_unknown_linux_gnu.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fpowerpc_unknown_linux_gnu.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fpowerpc_unknown_linux_gnu.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fpowerpc_unknown_linux_gnu.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -18,6 +18,7 @@ pub fn target() -> Target {\n         llvm_target: \"powerpc-unknown-linux-gnu\".to_string(),\n         target_endian: \"big\".to_string(),\n         target_pointer_width: \"32\".to_string(),\n+        data_layout: \"E-m:e-p:32:32-i64:64-n32\".to_string(),\n         arch: \"powerpc\".to_string(),\n         target_os: \"linux\".to_string(),\n         target_env: \"gnu\".to_string(),"}, {"sha": "c8b5dd0eccc5cfe19741bc6eccbcf1d8f1c90a73", "filename": "src/librustc_back/target/x86_64_apple_darwin.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_apple_darwin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_apple_darwin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fx86_64_apple_darwin.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -20,6 +20,7 @@ pub fn target() -> Target {\n         llvm_target: \"x86_64-apple-darwin\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n+        data_layout: \"e-m:o-i64:64-f80:128-n8:16:32:64-S128\".to_string(),\n         arch: \"x86_64\".to_string(),\n         target_os: \"macos\".to_string(),\n         target_env: \"\".to_string(),"}, {"sha": "d038e88f2b4fd780fb7a1064c8e697e3823cfe13", "filename": "src/librustc_back/target/x86_64_apple_ios.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_apple_ios.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_apple_ios.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fx86_64_apple_ios.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -16,6 +16,7 @@ pub fn target() -> Target {\n         llvm_target: \"x86_64-apple-ios\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n+        data_layout: \"e-m:o-i64:64-f80:128-n8:16:32:64-S128\".to_string(),\n         arch: \"x86_64\".to_string(),\n         target_os: \"ios\".to_string(),\n         target_env: \"\".to_string(),"}, {"sha": "f0a09ae71efeb7c3b02d67666473b080479b76f4", "filename": "src/librustc_back/target/x86_64_pc_windows_gnu.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_pc_windows_gnu.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_pc_windows_gnu.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fx86_64_pc_windows_gnu.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -19,6 +19,7 @@ pub fn target() -> Target {\n         llvm_target: \"x86_64-pc-windows-gnu\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n+        data_layout: \"e-m:w-i64:64-f80:128-n8:16:32:64-S128\".to_string(),\n         arch: \"x86_64\".to_string(),\n         target_os: \"windows\".to_string(),\n         target_env: \"gnu\".to_string(),"}, {"sha": "b3fbd6ef05170a04c5810fa841940c7c8aabd299", "filename": "src/librustc_back/target/x86_64_pc_windows_msvc.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_pc_windows_msvc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_pc_windows_msvc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fx86_64_pc_windows_msvc.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -18,6 +18,7 @@ pub fn target() -> Target {\n         llvm_target: \"x86_64-pc-windows-msvc\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n+        data_layout: \"e-m:w-i64:64-f80:128-n8:16:32:64-S128\".to_string(),\n         arch: \"x86_64\".to_string(),\n         target_os: \"windows\".to_string(),\n         target_env: \"msvc\".to_string(),"}, {"sha": "652159d10fda2edf6e2cdcfe894389ec99ca2803", "filename": "src/librustc_back/target/x86_64_rumprun_netbsd.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_rumprun_netbsd.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_rumprun_netbsd.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fx86_64_rumprun_netbsd.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -27,6 +27,7 @@ pub fn target() -> Target {\n         llvm_target: \"x86_64-rumprun-netbsd\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n+        data_layout: \"e-m:e-i64:64-f80:128-n8:16:32:64-S128\".to_string(),\n         arch: \"x86_64\".to_string(),\n         target_os: \"netbsd\".to_string(),\n         target_env: \"\".to_string(),"}, {"sha": "5aa08ea9c8ca9fa3a067727f062bca3b845395b8", "filename": "src/librustc_back/target/x86_64_sun_solaris.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_sun_solaris.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_sun_solaris.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fx86_64_sun_solaris.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -19,6 +19,7 @@ pub fn target() -> Target {\n         llvm_target: \"x86_64-pc-solaris\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n+        data_layout: \"e-m:e-i64:64-f80:128-n8:16:32:64-S128\".to_string(),\n         arch: \"x86_64\".to_string(),\n         target_os: \"solaris\".to_string(),\n         target_env: \"\".to_string(),"}, {"sha": "e8b95ed80d9e65d2f74c404db81b56ee0c0e8769", "filename": "src/librustc_back/target/x86_64_unknown_bitrig.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_bitrig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_bitrig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_bitrig.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -18,6 +18,7 @@ pub fn target() -> Target {\n         llvm_target: \"x86_64-unknown-bitrig\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n+        data_layout: \"e-m:e-i64:64-f80:128-n8:16:32:64-S128\".to_string(),\n         arch: \"x86_64\".to_string(),\n         target_os: \"bitrig\".to_string(),\n         target_env: \"\".to_string(),"}, {"sha": "3fa46c31a5eb19ed618a6a613fefe8865e0e2e97", "filename": "src/librustc_back/target/x86_64_unknown_dragonfly.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_dragonfly.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_dragonfly.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_dragonfly.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -19,6 +19,7 @@ pub fn target() -> Target {\n         llvm_target: \"x86_64-unknown-dragonfly\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n+        data_layout: \"e-m:e-i64:64-f80:128-n8:16:32:64-S128\".to_string(),\n         arch: \"x86_64\".to_string(),\n         target_os: \"dragonfly\".to_string(),\n         target_env: \"\".to_string(),"}, {"sha": "d345a32179423e691feb9c824cbc96b4a2400035", "filename": "src/librustc_back/target/x86_64_unknown_freebsd.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_freebsd.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_freebsd.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_freebsd.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -19,6 +19,7 @@ pub fn target() -> Target {\n         llvm_target: \"x86_64-unknown-freebsd\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n+        data_layout: \"e-m:e-i64:64-f80:128-n8:16:32:64-S128\".to_string(),\n         arch: \"x86_64\".to_string(),\n         target_os: \"freebsd\".to_string(),\n         target_env: \"\".to_string(),"}, {"sha": "69e333a135002239b2ee85c472dc4ff39033696e", "filename": "src/librustc_back/target/x86_64_unknown_linux_gnu.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_linux_gnu.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_linux_gnu.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_linux_gnu.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -19,6 +19,7 @@ pub fn target() -> Target {\n         llvm_target: \"x86_64-unknown-linux-gnu\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n+        data_layout: \"e-m:e-i64:64-f80:128-n8:16:32:64-S128\".to_string(),\n         arch: \"x86_64\".to_string(),\n         target_os: \"linux\".to_string(),\n         target_env: \"gnu\".to_string(),"}, {"sha": "622a1fe8baf14b242d5abf551c65c451aad219a9", "filename": "src/librustc_back/target/x86_64_unknown_linux_musl.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_linux_musl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_linux_musl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_linux_musl.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -73,6 +73,7 @@ pub fn target() -> Target {\n         llvm_target: \"x86_64-unknown-linux-musl\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n+        data_layout: \"e-m:e-i64:64-f80:128-n8:16:32:64-S128\".to_string(),\n         arch: \"x86_64\".to_string(),\n         target_os: \"linux\".to_string(),\n         target_env: \"musl\".to_string(),"}, {"sha": "74bf71891199a4da9d33748f31323233ce9ca100", "filename": "src/librustc_back/target/x86_64_unknown_netbsd.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_netbsd.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_netbsd.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_netbsd.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -18,6 +18,7 @@ pub fn target() -> Target {\n         llvm_target: \"x86_64-unknown-netbsd\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n+        data_layout: \"e-m:e-i64:64-f80:128-n8:16:32:64-S128\".to_string(),\n         arch: \"x86_64\".to_string(),\n         target_os: \"netbsd\".to_string(),\n         target_env: \"\".to_string(),"}, {"sha": "521de5373d0b16267ad135153df159e7d62a1d75", "filename": "src/librustc_back/target/x86_64_unknown_openbsd.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_openbsd.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_openbsd.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fx86_64_unknown_openbsd.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -19,6 +19,7 @@ pub fn target() -> Target {\n         llvm_target: \"x86_64-unknown-openbsd\".to_string(),\n         target_endian: \"little\".to_string(),\n         target_pointer_width: \"64\".to_string(),\n+        data_layout: \"e-m:e-i64:64-f80:128-n8:16:32:64-S128\".to_string(),\n         arch: \"x86_64\".to_string(),\n         target_os: \"openbsd\".to_string(),\n         target_env: \"\".to_string(),"}, {"sha": "a7c34df024819f7c3d9d1a4bef704c670c4b5397", "filename": "src/librustc_trans/context.rs", "status": "modified", "additions": 19, "deletions": 5, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_trans%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Flibrustc_trans%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fcontext.rs?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -36,11 +36,12 @@ use session::Session;\n use util::sha2::Sha256;\n use util::nodemap::{NodeMap, NodeSet, DefIdMap, FnvHashMap, FnvHashSet};\n \n-use std::ffi::CString;\n+use std::ffi::{CStr, CString};\n use std::cell::{Cell, RefCell};\n use std::marker::PhantomData;\n use std::ptr;\n use std::rc::Rc;\n+use std::str;\n use syntax::ast;\n use syntax::parse::token::InternedString;\n \n@@ -255,15 +256,28 @@ unsafe fn create_context_and_module(sess: &Session, mod_name: &str) -> (ContextR\n     let mod_name = CString::new(mod_name).unwrap();\n     let llmod = llvm::LLVMModuleCreateWithNameInContext(mod_name.as_ptr(), llcx);\n \n-    if let Some(ref custom_data_layout) = sess.target.target.options.data_layout {\n-        let data_layout = CString::new(&custom_data_layout[..]).unwrap();\n-        llvm::LLVMSetDataLayout(llmod, data_layout.as_ptr());\n-    } else {\n+    // Ensure the data-layout values hardcoded remain the defaults.\n+    if sess.target.target.options.is_builtin {\n         let tm = ::back::write::create_target_machine(sess);\n         llvm::LLVMRustSetDataLayoutFromTargetMachine(llmod, tm);\n         llvm::LLVMRustDisposeTargetMachine(tm);\n+\n+        let data_layout = llvm::LLVMGetDataLayout(llmod);\n+        let data_layout = str::from_utf8(CStr::from_ptr(data_layout).to_bytes())\n+            .ok().expect(\"got a non-UTF8 data-layout from LLVM\");\n+\n+        if sess.target.target.data_layout != data_layout {\n+            bug!(\"data-layout for builtin `{}` target, `{}`, \\\n+                  differs from LLVM default, `{}`\",\n+                 sess.target.target.llvm_target,\n+                 sess.target.target.data_layout,\n+                 data_layout);\n+        }\n     }\n \n+    let data_layout = CString::new(&sess.target.target.data_layout[..]).unwrap();\n+    llvm::LLVMSetDataLayout(llmod, data_layout.as_ptr());\n+\n     let llvm_target = sess.target.target.llvm_target.as_bytes();\n     let llvm_target = CString::new(llvm_target).unwrap();\n     llvm::LLVMRustSetNormalizedTarget(llmod, llvm_target.as_ptr());"}, {"sha": "b7083c2776aeccd3f5575be4e55c25dc7222d0f9", "filename": "src/test/run-make/target-specs/my-awesome-platform.json", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Ftest%2Frun-make%2Ftarget-specs%2Fmy-awesome-platform.json", "raw_url": "https://github.com/rust-lang/rust/raw/0776399eac62f8cf5cb02761014e8ed6c51204aa/src%2Ftest%2Frun-make%2Ftarget-specs%2Fmy-awesome-platform.json", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Ftarget-specs%2Fmy-awesome-platform.json?ref=0776399eac62f8cf5cb02761014e8ed6c51204aa", "patch": "@@ -1,4 +1,5 @@\n {\n+    \"data-layout\": \"e-m:e-p:32:32-f64:32:64-f80:32-n8:16:32-S128\",\n     \"llvm-target\": \"i686-unknown-linux-gnu\",\n     \"target-endian\": \"little\",\n     \"target-pointer-width\": \"32\","}]}