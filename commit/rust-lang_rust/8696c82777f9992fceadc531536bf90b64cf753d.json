{"sha": "8696c82777f9992fceadc531536bf90b64cf753d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg2OTZjODI3NzdmOTk5MmZjZWFkYzUzMTUzNmJmOTBiNjRjZjc1M2Q=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2021-05-23T20:22:38Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2021-05-23T20:43:33Z"}, "message": "feat: generate getter assist places the cursor at the generated function", "tree": {"sha": "a4adc7abf12fd3b1e61aca0c922b93e0eaab800b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a4adc7abf12fd3b1e61aca0c922b93e0eaab800b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8696c82777f9992fceadc531536bf90b64cf753d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8696c82777f9992fceadc531536bf90b64cf753d", "html_url": "https://github.com/rust-lang/rust/commit/8696c82777f9992fceadc531536bf90b64cf753d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8696c82777f9992fceadc531536bf90b64cf753d/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "af54b1e248f377853957ada0270e269bedb577b4", "url": "https://api.github.com/repos/rust-lang/rust/commits/af54b1e248f377853957ada0270e269bedb577b4", "html_url": "https://github.com/rust-lang/rust/commit/af54b1e248f377853957ada0270e269bedb577b4"}], "stats": {"total": 23, "additions": 14, "deletions": 9}, "files": [{"sha": "9faaaf284b0f702e6572b2e4d6493aa92bcbaf4d", "filename": "crates/ide_assists/src/handlers/generate_getter.rs", "status": "modified", "additions": 12, "deletions": 7, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/8696c82777f9992fceadc531536bf90b64cf753d/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fgenerate_getter.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8696c82777f9992fceadc531536bf90b64cf753d/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fgenerate_getter.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fgenerate_getter.rs?ref=8696c82777f9992fceadc531536bf90b64cf753d", "patch": "@@ -23,7 +23,7 @@ use crate::{\n //\n // impl Person {\n //     /// Get a reference to the person's name.\n-//     fn name(&self) -> &String {\n+//     fn $0name(&self) -> &String {\n //         &self.name\n //     }\n // }\n@@ -49,7 +49,7 @@ pub(crate) fn generate_getter(acc: &mut Assists, ctx: &AssistContext) -> Option<\n //\n // impl Person {\n //     /// Get a mutable reference to the person's name.\n-//     fn name_mut(&mut self) -> &mut String {\n+//     fn $0name_mut(&mut self) -> &mut String {\n //         &mut self.name\n //     }\n // }\n@@ -119,7 +119,12 @@ pub(crate) fn generate_getter_impl(\n                     strukt.syntax().text_range().end()\n                 });\n \n-            builder.insert(start_offset, buf);\n+            match ctx.config.snippet_cap {\n+                Some(cap) => {\n+                    builder.insert_snippet(cap, start_offset, buf.replacen(\"fn \", \"fn $0\", 1))\n+                }\n+                None => builder.insert(start_offset, buf),\n+            }\n         },\n     )\n }\n@@ -146,7 +151,7 @@ struct Context {\n \n impl Context {\n     /// Get a reference to the context's data.\n-    fn data(&self) -> &Data {\n+    fn $0data(&self) -> &Data {\n         &self.data\n     }\n }\n@@ -167,7 +172,7 @@ struct Context {\n \n impl Context {\n     /// Get a mutable reference to the context's data.\n-    fn data_mut(&mut self) -> &mut Data {\n+    fn $0data_mut(&mut self) -> &mut Data {\n         &mut self.data\n     }\n }\n@@ -224,7 +229,7 @@ pub(crate) struct Context {\n \n impl Context {\n     /// Get a reference to the context's data.\n-    pub(crate) fn data(&self) -> &Data {\n+    pub(crate) fn $0data(&self) -> &Data {\n         &self.data\n     }\n }\n@@ -262,7 +267,7 @@ impl Context {\n     }\n \n     /// Get a reference to the context's count.\n-    fn count(&self) -> &usize {\n+    fn $0count(&self) -> &usize {\n         &self.count\n     }\n }"}, {"sha": "ffc915fd4d9425a53f1360570f6bbc04a0323261", "filename": "crates/ide_assists/src/tests/generated.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/8696c82777f9992fceadc531536bf90b64cf753d/crates%2Fide_assists%2Fsrc%2Ftests%2Fgenerated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8696c82777f9992fceadc531536bf90b64cf753d/crates%2Fide_assists%2Fsrc%2Ftests%2Fgenerated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_assists%2Fsrc%2Ftests%2Fgenerated.rs?ref=8696c82777f9992fceadc531536bf90b64cf753d", "patch": "@@ -786,7 +786,7 @@ struct Person {\n \n impl Person {\n     /// Get a reference to the person's name.\n-    fn name(&self) -> &String {\n+    fn $0name(&self) -> &String {\n         &self.name\n     }\n }\n@@ -810,7 +810,7 @@ struct Person {\n \n impl Person {\n     /// Get a mutable reference to the person's name.\n-    fn name_mut(&mut self) -> &mut String {\n+    fn $0name_mut(&mut self) -> &mut String {\n         &mut self.name\n     }\n }"}]}