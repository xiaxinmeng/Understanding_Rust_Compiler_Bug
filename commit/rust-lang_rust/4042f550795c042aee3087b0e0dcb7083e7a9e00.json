{"sha": "4042f550795c042aee3087b0e0dcb7083e7a9e00", "node_id": "C_kwDOAAsO6NoAKDQwNDJmNTUwNzk1YzA0MmFlZTMwODdiMGUwZGNiNzA4M2U3YTllMDA", "commit": {"author": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-12-17T19:20:29Z"}, "committer": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-12-17T19:20:29Z"}, "message": "Don't ICE in check_must_not_suspend_ty for mismatched tuple arity", "tree": {"sha": "2b68ec108ef4d12f9c45e76f4ff902115f58b165", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2b68ec108ef4d12f9c45e76f4ff902115f58b165"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4042f550795c042aee3087b0e0dcb7083e7a9e00", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4042f550795c042aee3087b0e0dcb7083e7a9e00", "html_url": "https://github.com/rust-lang/rust/commit/4042f550795c042aee3087b0e0dcb7083e7a9e00", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4042f550795c042aee3087b0e0dcb7083e7a9e00/comments", "author": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "984eab57f708e62c09b3d708033fe620130b5f39", "url": "https://api.github.com/repos/rust-lang/rust/commits/984eab57f708e62c09b3d708033fe620130b5f39", "html_url": "https://github.com/rust-lang/rust/commit/984eab57f708e62c09b3d708033fe620130b5f39"}], "stats": {"total": 26, "additions": 22, "deletions": 4}, "files": [{"sha": "e4ac91befac610e8f71729bf7be89dacf1ababff", "filename": "compiler/rustc_hir_typeck/src/generator_interior/mod.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/4042f550795c042aee3087b0e0dcb7083e7a9e00/compiler%2Frustc_hir_typeck%2Fsrc%2Fgenerator_interior%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4042f550795c042aee3087b0e0dcb7083e7a9e00/compiler%2Frustc_hir_typeck%2Fsrc%2Fgenerator_interior%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_typeck%2Fsrc%2Fgenerator_interior%2Fmod.rs?ref=4042f550795c042aee3087b0e0dcb7083e7a9e00", "patch": "@@ -607,10 +607,7 @@ fn check_must_not_suspend_ty<'tcx>(\n         ty::Tuple(fields) => {\n             let mut has_emitted = false;\n             let comps = match data.expr.map(|e| &e.kind) {\n-                Some(hir::ExprKind::Tup(comps)) => {\n-                    debug_assert_eq!(comps.len(), fields.len());\n-                    Some(comps)\n-                }\n+                Some(hir::ExprKind::Tup(comps)) if comps.len() == fields.len() => Some(comps),\n                 _ => None,\n             };\n             for (i, ty) in fields.iter().enumerate() {"}, {"sha": "c7e14e4256138d9dbe3d6443a60f571e14119f4a", "filename": "src/test/ui/lint/must_not_suspend/tuple-mismatch.rs", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/4042f550795c042aee3087b0e0dcb7083e7a9e00/src%2Ftest%2Fui%2Flint%2Fmust_not_suspend%2Ftuple-mismatch.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4042f550795c042aee3087b0e0dcb7083e7a9e00/src%2Ftest%2Fui%2Flint%2Fmust_not_suspend%2Ftuple-mismatch.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fmust_not_suspend%2Ftuple-mismatch.rs?ref=4042f550795c042aee3087b0e0dcb7083e7a9e00", "patch": "@@ -0,0 +1,9 @@\n+#![feature(generators)]\n+\n+fn main() {\n+    let _generator = || {\n+        yield ((), ((), ()));\n+        yield ((), ());\n+        //~^ ERROR mismatched types\n+    };\n+}"}, {"sha": "cca8cd9bd89f16ce5e9b3aecc24c6ed5f4cf58dc", "filename": "src/test/ui/lint/must_not_suspend/tuple-mismatch.stderr", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/4042f550795c042aee3087b0e0dcb7083e7a9e00/src%2Ftest%2Fui%2Flint%2Fmust_not_suspend%2Ftuple-mismatch.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4042f550795c042aee3087b0e0dcb7083e7a9e00/src%2Ftest%2Fui%2Flint%2Fmust_not_suspend%2Ftuple-mismatch.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fmust_not_suspend%2Ftuple-mismatch.stderr?ref=4042f550795c042aee3087b0e0dcb7083e7a9e00", "patch": "@@ -0,0 +1,12 @@\n+error[E0308]: mismatched types\n+  --> $DIR/tuple-mismatch.rs:6:20\n+   |\n+LL |         yield ((), ());\n+   |                    ^^ expected tuple, found `()`\n+   |\n+   = note:  expected tuple `((), ())`\n+           found unit type `()`\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0308`."}]}