{"sha": "6a82a5fb0eb523b8fda8058ddffa31fa6c25ca87", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZhODJhNWZiMGViNTIzYjhmZGE4MDU4ZGRmZmEzMWZhNmMyNWNhODc=", "commit": {"author": {"name": "Erik Johnston", "email": "erikj@jki.re", "date": "2016-04-07T19:47:43Z"}, "committer": {"name": "Erik Johnston", "email": "erikj@jki.re", "date": "2016-04-07T19:47:43Z"}, "message": "Tidy up", "tree": {"sha": "bc64bdcfad161d413741293025d111d06bfde6b1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bc64bdcfad161d413741293025d111d06bfde6b1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6a82a5fb0eb523b8fda8058ddffa31fa6c25ca87", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6a82a5fb0eb523b8fda8058ddffa31fa6c25ca87", "html_url": "https://github.com/rust-lang/rust/commit/6a82a5fb0eb523b8fda8058ddffa31fa6c25ca87", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6a82a5fb0eb523b8fda8058ddffa31fa6c25ca87/comments", "author": {"login": "erikjohnston", "id": 8428120, "node_id": "MDQ6VXNlcjg0MjgxMjA=", "avatar_url": "https://avatars.githubusercontent.com/u/8428120?v=4", "gravatar_id": "", "url": "https://api.github.com/users/erikjohnston", "html_url": "https://github.com/erikjohnston", "followers_url": "https://api.github.com/users/erikjohnston/followers", "following_url": "https://api.github.com/users/erikjohnston/following{/other_user}", "gists_url": "https://api.github.com/users/erikjohnston/gists{/gist_id}", "starred_url": "https://api.github.com/users/erikjohnston/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/erikjohnston/subscriptions", "organizations_url": "https://api.github.com/users/erikjohnston/orgs", "repos_url": "https://api.github.com/users/erikjohnston/repos", "events_url": "https://api.github.com/users/erikjohnston/events{/privacy}", "received_events_url": "https://api.github.com/users/erikjohnston/received_events", "type": "User", "site_admin": false}, "committer": {"login": "erikjohnston", "id": 8428120, "node_id": "MDQ6VXNlcjg0MjgxMjA=", "avatar_url": "https://avatars.githubusercontent.com/u/8428120?v=4", "gravatar_id": "", "url": "https://api.github.com/users/erikjohnston", "html_url": "https://github.com/erikjohnston", "followers_url": "https://api.github.com/users/erikjohnston/followers", "following_url": "https://api.github.com/users/erikjohnston/following{/other_user}", "gists_url": "https://api.github.com/users/erikjohnston/gists{/gist_id}", "starred_url": "https://api.github.com/users/erikjohnston/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/erikjohnston/subscriptions", "organizations_url": "https://api.github.com/users/erikjohnston/orgs", "repos_url": "https://api.github.com/users/erikjohnston/repos", "events_url": "https://api.github.com/users/erikjohnston/events{/privacy}", "received_events_url": "https://api.github.com/users/erikjohnston/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4c9dd747bf3e6f3b3502d75755fc083f466ed3d8", "url": "https://api.github.com/repos/rust-lang/rust/commits/4c9dd747bf3e6f3b3502d75755fc083f466ed3d8", "html_url": "https://github.com/rust-lang/rust/commit/4c9dd747bf3e6f3b3502d75755fc083f466ed3d8"}], "stats": {"total": 9, "additions": 5, "deletions": 4}, "files": [{"sha": "5b901f2eafc455d9533126946e558500ce293abf", "filename": "src/items.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/6a82a5fb0eb523b8fda8058ddffa31fa6c25ca87/src%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a82a5fb0eb523b8fda8058ddffa31fa6c25ca87/src%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fitems.rs?ref=6a82a5fb0eb523b8fda8058ddffa31fa6c25ca87", "patch": "@@ -1363,15 +1363,16 @@ fn rewrite_fn_base(context: &RewriteContext,\n     // Return type.\n     if !ret_str.is_empty() {\n         let ret_should_indent = match context.config.fn_args_layout {\n+            // If our args are block layout then we surely must have space.\n             FnArgLayoutStyle::Block if put_args_in_block => false,\n             FnArgLayoutStyle::BlockAlways => false,\n             _ => {\n+                // If we've already gone multi-line, or the return type would push\n+                // over the max width, then put the return type on a new line.\n                 result.contains(\"\\n\") || multi_line_ret_str ||\n                 result.len() + indent.width() + ret_str_len > context.config.max_width\n             }\n         };\n-        // If we've already gone multi-line, or the return type would push\n-        // over the max width, then put the return type on a new line.\n         let ret_indent = if ret_should_indent {\n             let indent = match context.config.fn_return_indent {\n                 ReturnIndent::WithWhereClause => indent + 4,\n@@ -1423,13 +1424,13 @@ fn rewrite_fn_base(context: &RewriteContext,\n         }\n     }\n \n-    let where_compressed = match context.config.where_density {\n+    let should_compress_where = match context.config.where_density {\n         Density::Compressed => !result.contains('\\n') || put_args_in_block,\n         Density::CompressedIfEmpty => !has_body && !result.contains('\\n'),\n         _ => false,\n     } || (put_args_in_block && ret_str.is_empty());\n \n-    let where_density = if where_compressed {\n+    let where_density = if should_compress_where {\n         Density::Compressed\n     } else {\n         Density::Tall"}]}