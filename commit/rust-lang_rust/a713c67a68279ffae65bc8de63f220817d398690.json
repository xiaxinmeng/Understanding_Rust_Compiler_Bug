{"sha": "a713c67a68279ffae65bc8de63f220817d398690", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE3MTNjNjdhNjgyNzlmZmFlNjViYzhkZTYzZjIyMDgxN2QzOTg2OTA=", "commit": {"author": {"name": "Ryan Cumming", "email": "etaoins@gmail.com", "date": "2018-01-09T08:54:13Z"}, "committer": {"name": "Ryan Cumming", "email": "etaoins@gmail.com", "date": "2018-01-09T09:01:35Z"}, "message": "Skip linker-output-non-utf8 test on Apple\n\nThis test fails on APFS filesystems with the following error:\n\nmkdir: /Users/ryan/Code/rust/build/x86_64-apple-darwin/test/run-make/linker-output-non-utf8.stage2-x86_64-apple-darwin/zzz\ufffd: Illegal byte sequence\n\nThis is due to APFS now requiring that all paths are valid UTF-8. As\nAPFS will be the default filesystem for all new Darwin-based systems the\nmost straightforward fix is to skip this test on Darwin as well as\nWindows.", "tree": {"sha": "5d23930e295d1cfd15d5e30377756efc4bc01f32", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5d23930e295d1cfd15d5e30377756efc4bc01f32"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a713c67a68279ffae65bc8de63f220817d398690", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a713c67a68279ffae65bc8de63f220817d398690", "html_url": "https://github.com/rust-lang/rust/commit/a713c67a68279ffae65bc8de63f220817d398690", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a713c67a68279ffae65bc8de63f220817d398690/comments", "author": {"login": "etaoins", "id": 687534, "node_id": "MDQ6VXNlcjY4NzUzNA==", "avatar_url": "https://avatars.githubusercontent.com/u/687534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/etaoins", "html_url": "https://github.com/etaoins", "followers_url": "https://api.github.com/users/etaoins/followers", "following_url": "https://api.github.com/users/etaoins/following{/other_user}", "gists_url": "https://api.github.com/users/etaoins/gists{/gist_id}", "starred_url": "https://api.github.com/users/etaoins/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/etaoins/subscriptions", "organizations_url": "https://api.github.com/users/etaoins/orgs", "repos_url": "https://api.github.com/users/etaoins/repos", "events_url": "https://api.github.com/users/etaoins/events{/privacy}", "received_events_url": "https://api.github.com/users/etaoins/received_events", "type": "User", "site_admin": false}, "committer": {"login": "etaoins", "id": 687534, "node_id": "MDQ6VXNlcjY4NzUzNA==", "avatar_url": "https://avatars.githubusercontent.com/u/687534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/etaoins", "html_url": "https://github.com/etaoins", "followers_url": "https://api.github.com/users/etaoins/followers", "following_url": "https://api.github.com/users/etaoins/following{/other_user}", "gists_url": "https://api.github.com/users/etaoins/gists{/gist_id}", "starred_url": "https://api.github.com/users/etaoins/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/etaoins/subscriptions", "organizations_url": "https://api.github.com/users/etaoins/orgs", "repos_url": "https://api.github.com/users/etaoins/repos", "events_url": "https://api.github.com/users/etaoins/events{/privacy}", "received_events_url": "https://api.github.com/users/etaoins/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "74966b5cb84934737d21bd9001db07bd93fa5d64", "url": "https://api.github.com/repos/rust-lang/rust/commits/74966b5cb84934737d21bd9001db07bd93fa5d64", "html_url": "https://github.com/rust-lang/rust/commit/74966b5cb84934737d21bd9001db07bd93fa5d64"}], "stats": {"total": 20, "additions": 12, "deletions": 8}, "files": [{"sha": "70906e5d2b2c71230d22d15b453f16f47f0df0e8", "filename": "src/test/run-make/linker-output-non-utf8/Makefile", "status": "modified", "additions": 12, "deletions": 8, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/a713c67a68279ffae65bc8de63f220817d398690/src%2Ftest%2Frun-make%2Flinker-output-non-utf8%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/a713c67a68279ffae65bc8de63f220817d398690/src%2Ftest%2Frun-make%2Flinker-output-non-utf8%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Flinker-output-non-utf8%2FMakefile?ref=a713c67a68279ffae65bc8de63f220817d398690", "patch": "@@ -2,15 +2,12 @@\n \n # Make sure we don't ICE if the linker prints a non-UTF-8 error message.\n \n-ifdef IS_WINDOWS\n-# ignore windows\n+# Ignore Windows and Apple\n \n-# This does not work in its current form on windows, possibly due to\n-# gcc bugs or something about valid Windows paths.  See issue #29151\n-# for more information.\n-all:\n-\n-else\n+# This does not work in its current form on Windows or Apple APFS due\n+# to their filesystems requiring paths to be valid Unicode.\n+ifndef IS_WINDOWS\n+ifneq ($(shell uname),Darwin)\n \n # The zzz it to allow humans to tab complete or glob this thing.\n bad_dir := $(TMPDIR)/zzz$$'\\xff'\n@@ -20,5 +17,12 @@ all:\n \tmkdir $(bad_dir)\n \tmv $(TMPDIR)/liblibrary.a $(bad_dir)\n \tLIBRARY_PATH=$(bad_dir) $(RUSTC) exec.rs 2>&1 | $(CGREP) this_symbol_not_defined\n+else\n+all:\n+\n+endif\n+\n+else\n+all:\n \n endif"}]}