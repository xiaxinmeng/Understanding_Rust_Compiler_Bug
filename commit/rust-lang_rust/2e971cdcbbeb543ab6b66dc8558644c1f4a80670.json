{"sha": "2e971cdcbbeb543ab6b66dc8558644c1f4a80670", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJlOTcxY2RjYmJlYjU0M2FiNmI2NmRjODU1ODY0NGMxZjRhODA2NzA=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-08-11T07:11:58Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-08-11T07:11:58Z"}, "message": "Use dict for AST", "tree": {"sha": "61facd6dbdcdf00bbbbda503cc3b78826e63af07", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/61facd6dbdcdf00bbbbda503cc3b78826e63af07"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2e971cdcbbeb543ab6b66dc8558644c1f4a80670", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2e971cdcbbeb543ab6b66dc8558644c1f4a80670", "html_url": "https://github.com/rust-lang/rust/commit/2e971cdcbbeb543ab6b66dc8558644c1f4a80670", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2e971cdcbbeb543ab6b66dc8558644c1f4a80670/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e69c70e2a208fd89d4d49a104f5516c55546309e", "url": "https://api.github.com/repos/rust-lang/rust/commits/e69c70e2a208fd89d4d49a104f5516c55546309e", "html_url": "https://github.com/rust-lang/rust/commit/e69c70e2a208fd89d4d49a104f5516c55546309e"}], "stats": {"total": 44, "additions": 18, "deletions": 26}, "files": [{"sha": "12e5a1c3e223dc6c7ede36e9f5cdff3af5a28e1c", "filename": "crates/libsyntax2/src/ast/generated.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/2e971cdcbbeb543ab6b66dc8558644c1f4a80670/crates%2Flibsyntax2%2Fsrc%2Fast%2Fgenerated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2e971cdcbbeb543ab6b66dc8558644c1f4a80670/crates%2Flibsyntax2%2Fsrc%2Fast%2Fgenerated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Flibsyntax2%2Fsrc%2Fast%2Fgenerated.rs?ref=2e971cdcbbeb543ab6b66dc8558644c1f4a80670", "patch": "@@ -4,7 +4,6 @@ use {\n     SyntaxKind::*,\n };\n \n-\n #[derive(Debug, Clone, Copy)]\n pub struct File<R: TreeRoot = Arc<SyntaxRoot>> {\n     syntax: SyntaxNode<R>,\n@@ -28,7 +27,6 @@ impl<R: TreeRoot> File<R> {\n     }\n }\n \n-\n #[derive(Debug, Clone, Copy)]\n pub struct Function<R: TreeRoot = Arc<SyntaxRoot>> {\n     syntax: SyntaxNode<R>,\n@@ -53,7 +51,6 @@ impl<R: TreeRoot> Function<R> {\n     }\n }\n \n-\n #[derive(Debug, Clone, Copy)]\n pub struct Name<R: TreeRoot = Arc<SyntaxRoot>> {\n     syntax: SyntaxNode<R>,"}, {"sha": "09630e427ac4694e8c8603e126f2e53b5e57ef22", "filename": "crates/libsyntax2/src/ast/generated.rs.tera", "status": "modified", "additions": 11, "deletions": 12, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/2e971cdcbbeb543ab6b66dc8558644c1f4a80670/crates%2Flibsyntax2%2Fsrc%2Fast%2Fgenerated.rs.tera", "raw_url": "https://github.com/rust-lang/rust/raw/2e971cdcbbeb543ab6b66dc8558644c1f4a80670/crates%2Flibsyntax2%2Fsrc%2Fast%2Fgenerated.rs.tera", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Flibsyntax2%2Fsrc%2Fast%2Fgenerated.rs.tera?ref=2e971cdcbbeb543ab6b66dc8558644c1f4a80670", "patch": "@@ -3,28 +3,27 @@ use {\n     SyntaxNode, SyntaxRoot, TreeRoot, AstNode,\n     SyntaxKind::*,\n };\n-{% for node in ast %}\n-{% set Name = node.kind | camel  %}\n+{% for node, methods in ast %}\n #[derive(Debug, Clone, Copy)]\n-pub struct {{ Name }}<R: TreeRoot = Arc<SyntaxRoot>> {\n+pub struct {{ node }}<R: TreeRoot = Arc<SyntaxRoot>> {\n     syntax: SyntaxNode<R>,\n }\n \n-impl<R: TreeRoot> AstNode<R> for {{ Name }}<R> {\n+impl<R: TreeRoot> AstNode<R> for {{ node }}<R> {\n     fn cast(syntax: SyntaxNode<R>) -> Option<Self> {\n         match syntax.kind() {\n-            {{ node.kind }} => Some({{ Name }} { syntax }),\n+            {{ node | upper }} => Some({{ node }} { syntax }),\n             _ => None,\n         }\n     }\n     fn syntax(&self) -> &SyntaxNode<R> { &self.syntax }\n }\n \n-impl<R: TreeRoot> {{ Name }}<R> {\n-{%- if node.collections -%}\n-{%- for m in node.collections -%}\n+impl<R: TreeRoot> {{ node }}<R> {\n+{%- if methods.collections -%}\n+{%- for m in methods.collections -%}\n {%- set method_name = m.0 -%}\n-{%- set ChildName = m.1 | camel %}\n+{%- set ChildName = m.1 %}\n     pub fn {{ method_name }}<'a>(&'a self) -> impl Iterator<Item = {{ ChildName }}<R>> + 'a {\n         self.syntax()\n             .children()\n@@ -33,10 +32,10 @@ impl<R: TreeRoot> {{ Name }}<R> {\n {% endfor -%}\n {%- endif -%}\n \n-{%- if node.options -%}\n-{%- for m in node.options -%}\n+{%- if methods.options -%}\n+{%- for m in methods.options -%}\n {%- set method_name = m.0 -%}\n-{%- set ChildName = m.1 | camel %}\n+{%- set ChildName = m.1 %}\n     pub fn {{ method_name }}(&self) -> Option<{{ ChildName }}<R>> {\n         self.syntax()\n             .children()"}, {"sha": "650f722127f1631f3cd342b8130387fb41a4eff7", "filename": "crates/libsyntax2/src/grammar.ron", "status": "modified", "additions": 7, "deletions": 11, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/2e971cdcbbeb543ab6b66dc8558644c1f4a80670/crates%2Flibsyntax2%2Fsrc%2Fgrammar.ron", "raw_url": "https://github.com/rust-lang/rust/raw/2e971cdcbbeb543ab6b66dc8558644c1f4a80670/crates%2Flibsyntax2%2Fsrc%2Fgrammar.ron", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Flibsyntax2%2Fsrc%2Fgrammar.ron?ref=2e971cdcbbeb543ab6b66dc8558644c1f4a80670", "patch": "@@ -213,21 +213,17 @@ Grammar(\n         \"SELF_PARAM\",\n         \"ARG_LIST\",\n     ],\n-    ast: [\n-        (\n-            kind: \"FILE\",\n+    ast: {\n+        \"File\": (\n             collections: [\n-                [\"functions\", \"FUNCTION\"]\n+                [\"functions\", \"Function\"]\n             ]\n         ),\n-        (\n-            kind: \"FUNCTION\",\n+        \"Function\": (\n             options: [\n-                [\"name\", \"NAME\"]\n+                [\"name\", \"Name\"]\n             ]\n         ),\n-        (\n-            kind: \"NAME\"\n-        ),\n-    ]\n+        \"Name\": (),\n+    },\n )"}]}