{"sha": "3efc3e2455f1ebb7f74239c3398bae872ce0549e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNlZmMzZTI0NTVmMWViYjdmNzQyMzljMzM5OGJhZTg3MmNlMDU0OWU=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2019-04-10T14:54:54Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2019-04-10T14:54:54Z"}, "message": "Auto merge of #3937 - stepnivlk:type_dependent_defs-wrappers, r=oli-obk\n\nSupport updated type dependent def ID getter\n\nThis PR changes all the calls to `type_dependent_defs` (with panics via `[]`) to new method `type_dependent_def_id` with more explicit `unwrap` panic.\n\nRust PR: https://github.com/rust-lang/rust/pull/59216\nIssue author: @oli-obk", "tree": {"sha": "dc98e2c48e383d366b4408ebd95a3f50f2176ff6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/dc98e2c48e383d366b4408ebd95a3f50f2176ff6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3efc3e2455f1ebb7f74239c3398bae872ce0549e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3efc3e2455f1ebb7f74239c3398bae872ce0549e", "html_url": "https://github.com/rust-lang/rust/commit/3efc3e2455f1ebb7f74239c3398bae872ce0549e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3efc3e2455f1ebb7f74239c3398bae872ce0549e/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3d469f436f4ae9daad490fc004b1351d8807bb91", "url": "https://api.github.com/repos/rust-lang/rust/commits/3d469f436f4ae9daad490fc004b1351d8807bb91", "html_url": "https://github.com/rust-lang/rust/commit/3d469f436f4ae9daad490fc004b1351d8807bb91"}, {"sha": "603996c9d5a64e4d9b8a35d5a575b1e04b72d122", "url": "https://api.github.com/repos/rust-lang/rust/commits/603996c9d5a64e4d9b8a35d5a575b1e04b72d122", "html_url": "https://github.com/rust-lang/rust/commit/603996c9d5a64e4d9b8a35d5a575b1e04b72d122"}], "stats": {"total": 14, "additions": 7, "deletions": 7}, "files": [{"sha": "d67381660e511ab45540de2c2fc63cd68dc138c0", "filename": "clippy_lints/src/eta_reduction.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3efc3e2455f1ebb7f74239c3398bae872ce0549e/clippy_lints%2Fsrc%2Feta_reduction.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3efc3e2455f1ebb7f74239c3398bae872ce0549e/clippy_lints%2Fsrc%2Feta_reduction.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Feta_reduction.rs?ref=3efc3e2455f1ebb7f74239c3398bae872ce0549e", "patch": "@@ -102,7 +102,7 @@ fn check_closure(cx: &LateContext<'_, '_>, expr: &Expr) {\n             // Are the expression or the arguments type-adjusted? Then we need the closure\n             if !(is_adjusted(cx, ex) || args.iter().skip(1).any(|arg| is_adjusted(cx, arg)));\n \n-            let method_def_id = cx.tables.type_dependent_defs()[ex.hir_id].def_id();\n+            let method_def_id = cx.tables.type_dependent_def_id(ex.hir_id).unwrap();\n             if !type_is_unsafe_function(cx, cx.tcx.type_of(method_def_id));\n \n             if compare_inputs(&mut iter_input_pats(decl, body), &mut args.into_iter());"}, {"sha": "307f03c692807cf3b7df4d2779c9a760cb65019a", "filename": "clippy_lints/src/functions.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3efc3e2455f1ebb7f74239c3398bae872ce0549e/clippy_lints%2Fsrc%2Ffunctions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3efc3e2455f1ebb7f74239c3398bae872ce0549e/clippy_lints%2Fsrc%2Ffunctions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Ffunctions.rs?ref=3efc3e2455f1ebb7f74239c3398bae872ce0549e", "patch": "@@ -303,7 +303,7 @@ impl<'a, 'tcx> hir::intravisit::Visitor<'tcx> for DerefVisitor<'a, 'tcx> {\n                 }\n             },\n             hir::ExprKind::MethodCall(_, _, ref args) => {\n-                let def_id = self.tables.type_dependent_defs()[expr.hir_id].def_id();\n+                let def_id = self.tables.type_dependent_def_id(expr.hir_id).unwrap();\n                 let base_type = self.cx.tcx.type_of(def_id);\n \n                 if type_is_unsafe_function(self.cx, base_type) {"}, {"sha": "11b4d237c5600955f97da145cf6d63fef65d7740", "filename": "clippy_lints/src/loops.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3efc3e2455f1ebb7f74239c3398bae872ce0549e/clippy_lints%2Fsrc%2Floops.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3efc3e2455f1ebb7f74239c3398bae872ce0549e/clippy_lints%2Fsrc%2Floops.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Floops.rs?ref=3efc3e2455f1ebb7f74239c3398bae872ce0549e", "patch": "@@ -1369,7 +1369,7 @@ fn check_for_loop_arg(cx: &LateContext<'_, '_>, pat: &Pat, arg: &Expr, expr: &Ex\n                     lint_iter_method(cx, args, arg, method_name);\n                 }\n             } else if method_name == \"into_iter\" && match_trait_method(cx, arg, &paths::INTO_ITERATOR) {\n-                let def_id = cx.tables.type_dependent_defs()[arg.hir_id].def_id();\n+                let def_id = cx.tables.type_dependent_def_id(arg.hir_id).unwrap();\n                 let substs = cx.tables.node_substs(arg.hir_id);\n                 let method_type = cx.tcx.type_of(def_id).subst(cx.tcx, substs);\n \n@@ -1904,7 +1904,7 @@ impl<'a, 'tcx> Visitor<'tcx> for VarVisitor<'a, 'tcx> {\n                 }\n             },\n             ExprKind::MethodCall(_, _, ref args) => {\n-                let def_id = self.cx.tables.type_dependent_defs()[expr.hir_id].def_id();\n+                let def_id = self.cx.tables.type_dependent_def_id(expr.hir_id).unwrap();\n                 for (ty, expr) in self.cx.tcx.fn_sig(def_id).inputs().skip_binder().iter().zip(args) {\n                     self.prefer_mutable = false;\n                     if let ty::Ref(_, _, mutbl) = ty.sty {"}, {"sha": "7333aa9f589709952e478e18070ad865e75bf053", "filename": "clippy_lints/src/mut_reference.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3efc3e2455f1ebb7f74239c3398bae872ce0549e/clippy_lints%2Fsrc%2Fmut_reference.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3efc3e2455f1ebb7f74239c3398bae872ce0549e/clippy_lints%2Fsrc%2Fmut_reference.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmut_reference.rs?ref=3efc3e2455f1ebb7f74239c3398bae872ce0549e", "patch": "@@ -50,7 +50,7 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for UnnecessaryMutPassed {\n                 }\n             },\n             ExprKind::MethodCall(ref path, _, ref arguments) => {\n-                let def_id = cx.tables.type_dependent_defs()[e.hir_id].def_id();\n+                let def_id = cx.tables.type_dependent_def_id(e.hir_id).unwrap();\n                 let substs = cx.tables.node_substs(e.hir_id);\n                 let method_type = cx.tcx.type_of(def_id).subst(cx.tcx, substs);\n                 check_arguments(cx, arguments, method_type, &path.ident.as_str())"}, {"sha": "542a18635d32f8eb53d63a3646fac7ab54b2622d", "filename": "clippy_lints/src/utils/mod.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3efc3e2455f1ebb7f74239c3398bae872ce0549e/clippy_lints%2Fsrc%2Futils%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3efc3e2455f1ebb7f74239c3398bae872ce0549e/clippy_lints%2Fsrc%2Futils%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Fmod.rs?ref=3efc3e2455f1ebb7f74239c3398bae872ce0549e", "patch": "@@ -239,8 +239,8 @@ pub fn match_type(cx: &LateContext<'_, '_>, ty: Ty<'_>, path: &[&str]) -> bool {\n \n /// Checks if the method call given in `expr` belongs to the given trait.\n pub fn match_trait_method(cx: &LateContext<'_, '_>, expr: &Expr, path: &[&str]) -> bool {\n-    let method_call = cx.tables.type_dependent_defs()[expr.hir_id];\n-    let trt_id = cx.tcx.trait_of_item(method_call.def_id());\n+    let def_id = cx.tables.type_dependent_def_id(expr.hir_id).unwrap();\n+    let trt_id = cx.tcx.trait_of_item(def_id);\n     if let Some(trt_id) = trt_id {\n         match_def_path(cx.tcx, trt_id, path)\n     } else {"}]}