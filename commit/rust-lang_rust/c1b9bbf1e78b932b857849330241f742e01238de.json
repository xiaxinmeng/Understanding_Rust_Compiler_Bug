{"sha": "c1b9bbf1e78b932b857849330241f742e01238de", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMxYjliYmYxZTc4YjkzMmI4NTc4NDkzMzAyNDFmNzQyZTAxMjM4ZGU=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-07-16T08:08:07Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-07-16T08:08:07Z"}, "message": "Rollup merge of #87145 - jsgf:fix-lint-opt-hash, r=michaelwoerister\n\nMake --cap-lints and related options leave crate hash alone\n\nCloses: #87144", "tree": {"sha": "1937bf31c612349757f2c65b0838607ed97f6f49", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1937bf31c612349757f2c65b0838607ed97f6f49"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c1b9bbf1e78b932b857849330241f742e01238de", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJg8T5oCRBK7hj4Ov3rIwAAskgIAIfqsBER810yeudJGS+wUbDA\nzZvdsjh6GHu+y5W5BVVHJWNjWnuNhOdDf6/oMky0YsRuEuKsrY17nGCV025tsaIQ\nPstn/fnx9FmIW2fVP0kcumXPx65tKudjpZ6pHXCTP+jGh/ByW9bJXrYn7pL4EH8y\nWq9XR40tEARazNL51kBFSlWES5fi4JX+BmPDK2tgU1TnP0LU7Gxfrlg17D1rZCkS\nAkQpF0lp51MdQEyNDnkJThfjhSBVqIwsR1x/LX8ssDy6ANh/fy9Pspmc/YldDBtM\n0gNckA+Tr8vjvbSgmUQsoes2hZwW4BP6Yy1oCk94YU/cYWlb/2RfX8v6G77UH2A=\n=oyPu\n-----END PGP SIGNATURE-----\n", "payload": "tree 1937bf31c612349757f2c65b0838607ed97f6f49\nparent 36de8778fc08e0244bacd214719a09417d863a64\nparent 51142a0f5fd55d864c068759a7f0e00ab64f6e37\nauthor Guillaume Gomez <guillaume1.gomez@gmail.com> 1626422887 +0200\ncommitter GitHub <noreply@github.com> 1626422887 +0200\n\nRollup merge of #87145 - jsgf:fix-lint-opt-hash, r=michaelwoerister\n\nMake --cap-lints and related options leave crate hash alone\n\nCloses: #87144\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c1b9bbf1e78b932b857849330241f742e01238de", "html_url": "https://github.com/rust-lang/rust/commit/c1b9bbf1e78b932b857849330241f742e01238de", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c1b9bbf1e78b932b857849330241f742e01238de/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "36de8778fc08e0244bacd214719a09417d863a64", "url": "https://api.github.com/repos/rust-lang/rust/commits/36de8778fc08e0244bacd214719a09417d863a64", "html_url": "https://github.com/rust-lang/rust/commit/36de8778fc08e0244bacd214719a09417d863a64"}, {"sha": "51142a0f5fd55d864c068759a7f0e00ab64f6e37", "url": "https://api.github.com/repos/rust-lang/rust/commits/51142a0f5fd55d864c068759a7f0e00ab64f6e37", "html_url": "https://github.com/rust-lang/rust/commit/51142a0f5fd55d864c068759a7f0e00ab64f6e37"}], "stats": {"total": 28, "additions": 21, "deletions": 7}, "files": [{"sha": "b1e4e3ba395217fefa8917c70aaa31836f42b998", "filename": "compiler/rustc_interface/src/tests.rs", "status": "modified", "additions": 18, "deletions": 4, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/c1b9bbf1e78b932b857849330241f742e01238de/compiler%2Frustc_interface%2Fsrc%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c1b9bbf1e78b932b857849330241f742e01238de/compiler%2Frustc_interface%2Fsrc%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_interface%2Fsrc%2Ftests.rs?ref=c1b9bbf1e78b932b857849330241f742e01238de", "patch": "@@ -236,9 +236,9 @@ fn test_lints_tracking_hash_different_values() {\n         (String::from(\"d\"), Level::Deny),\n     ];\n \n-    assert_different_hash(&v1, &v2);\n-    assert_different_hash(&v1, &v3);\n-    assert_different_hash(&v2, &v3);\n+    assert_non_crate_hash_different(&v1, &v2);\n+    assert_non_crate_hash_different(&v1, &v3);\n+    assert_non_crate_hash_different(&v2, &v3);\n }\n \n #[test]\n@@ -261,7 +261,21 @@ fn test_lints_tracking_hash_different_construction_order() {\n     ];\n \n     // The hash should be order-dependent\n-    assert_different_hash(&v1, &v2);\n+    assert_non_crate_hash_different(&v1, &v2);\n+}\n+\n+#[test]\n+fn test_lint_cap_hash_different() {\n+    let mut v1 = Options::default();\n+    let mut v2 = Options::default();\n+    let v3 = Options::default();\n+\n+    v1.lint_cap = Some(Level::Forbid);\n+    v2.lint_cap = Some(Level::Allow);\n+\n+    assert_non_crate_hash_different(&v1, &v2);\n+    assert_non_crate_hash_different(&v1, &v3);\n+    assert_non_crate_hash_different(&v2, &v3);\n }\n \n #[test]"}, {"sha": "8e2e33f2d51508d51aed04554ad64d8837009754", "filename": "compiler/rustc_session/src/options.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/c1b9bbf1e78b932b857849330241f742e01238de/compiler%2Frustc_session%2Fsrc%2Foptions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c1b9bbf1e78b932b857849330241f742e01238de/compiler%2Frustc_session%2Fsrc%2Foptions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_session%2Fsrc%2Foptions.rs?ref=c1b9bbf1e78b932b857849330241f742e01238de", "patch": "@@ -133,9 +133,9 @@ top_level_options!(\n         /// can influence whether overflow checks are done or not.\n         debug_assertions: bool [TRACKED],\n         debuginfo: DebugInfo [TRACKED],\n-        lint_opts: Vec<(String, lint::Level)> [TRACKED],\n-        lint_cap: Option<lint::Level> [TRACKED],\n-        force_warns: Vec<String> [TRACKED],\n+        lint_opts: Vec<(String, lint::Level)> [TRACKED_NO_CRATE_HASH],\n+        lint_cap: Option<lint::Level> [TRACKED_NO_CRATE_HASH],\n+        force_warns: Vec<String> [TRACKED_NO_CRATE_HASH],\n         describe_lints: bool [UNTRACKED],\n         output_types: OutputTypes [TRACKED],\n         search_paths: Vec<SearchPath> [UNTRACKED],"}]}