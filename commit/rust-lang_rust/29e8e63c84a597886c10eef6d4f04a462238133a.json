{"sha": "29e8e63c84a597886c10eef6d4f04a462238133a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI5ZThlNjNjODRhNTk3ODg2YzEwZWVmNmQ0ZjA0YTQ2MjIzODEzM2E=", "commit": {"author": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2019-01-18T23:47:25Z"}, "committer": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2019-01-24T18:36:50Z"}, "message": "review comments", "tree": {"sha": "7be68ebd0dbed5c9c4f3a2003b0a865aed2cbfc3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7be68ebd0dbed5c9c4f3a2003b0a865aed2cbfc3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/29e8e63c84a597886c10eef6d4f04a462238133a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/29e8e63c84a597886c10eef6d4f04a462238133a", "html_url": "https://github.com/rust-lang/rust/commit/29e8e63c84a597886c10eef6d4f04a462238133a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/29e8e63c84a597886c10eef6d4f04a462238133a/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0e2d6e017592753089a9238c7fe269e45d32d459", "url": "https://api.github.com/repos/rust-lang/rust/commits/0e2d6e017592753089a9238c7fe269e45d32d459", "html_url": "https://github.com/rust-lang/rust/commit/0e2d6e017592753089a9238c7fe269e45d32d459"}], "stats": {"total": 30, "additions": 11, "deletions": 19}, "files": [{"sha": "56b87feb82b2c34f2ce9bf93e14fe72489960f47", "filename": "src/librustc_mir/borrow_check/error_reporting.rs", "status": "modified", "additions": 10, "deletions": 15, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/29e8e63c84a597886c10eef6d4f04a462238133a/src%2Flibrustc_mir%2Fborrow_check%2Ferror_reporting.rs", "raw_url": "https://github.com/rust-lang/rust/raw/29e8e63c84a597886c10eef6d4f04a462238133a/src%2Flibrustc_mir%2Fborrow_check%2Ferror_reporting.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Ferror_reporting.rs?ref=29e8e63c84a597886c10eef6d4f04a462238133a", "patch": "@@ -203,20 +203,6 @@ impl<'cx, 'gcx, 'tcx> MirBorrowckCtxt<'cx, 'gcx, 'tcx> {\n                     Some(ref name) => format!(\"`{}`\", name),\n                     None => \"value\".to_owned(),\n                 };\n-                let mut note = true;\n-                for decl in &self.mir.local_decls {\n-                    if decl.ty == ty && decl.name.map(|x| x.to_string()) == opt_name {\n-                        err.span_label(\n-                            decl.source_info.span,\n-                            format!(\n-                                \"move occurs because {} has type `{}`, \\\n-                                 which does not implement the `Copy` trait\",\n-                                note_msg, ty,\n-                        ));\n-                        note = false;\n-                        break;\n-                    }\n-                }\n                 if let ty::TyKind::Param(param_ty) = ty.sty {\n                     let tcx = self.infcx.tcx;\n                     let generics = tcx.generics_of(self.mir_def_id);\n@@ -228,7 +214,16 @@ impl<'cx, 'gcx, 'tcx> MirBorrowckCtxt<'cx, 'gcx, 'tcx> {\n                         );\n                     }\n                 }\n-                if note {\n+                if let Place::Local(local) = place {\n+                    let decl = &self.mir.local_decls[*local];\n+                    err.span_label(\n+                        decl.source_info.span,\n+                        format!(\n+                            \"move occurs because {} has type `{}`, \\\n+                                which does not implement the `Copy` trait\",\n+                            note_msg, ty,\n+                    ));\n+                } else {\n                     err.note(&format!(\n                         \"move occurs because {} has type `{}`, \\\n                          which does not implement the `Copy` trait\","}, {"sha": "fd4d318b5ddf1cea094b9bb9e73933e9febce6dc", "filename": "src/test/ui/borrowck/issue-41962.stderr", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/29e8e63c84a597886c10eef6d4f04a462238133a/src%2Ftest%2Fui%2Fborrowck%2Fissue-41962.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29e8e63c84a597886c10eef6d4f04a462238133a/src%2Ftest%2Fui%2Fborrowck%2Fissue-41962.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fissue-41962.stderr?ref=29e8e63c84a597886c10eef6d4f04a462238133a", "patch": "@@ -19,13 +19,10 @@ LL |         if let Some(thing) = maybe {\n error[E0382]: use of moved value (Mir)\n   --> $DIR/issue-41962.rs:7:21\n    |\n-LL |     let maybe = Some(vec![true, true]);\n-   |                      ---------------- move occurs because value has type `std::vec::Vec<bool>`, which does not implement the `Copy` trait\n-...\n LL |         if let Some(thing) = maybe {\n    |                     ^^^^^ value moved here, in previous iteration of loop\n    |\n-   = note: this error originates in a macro outside of the current crate (in Nightly builds, run with -Z external-macro-backtrace for more info)\n+   = note: move occurs because value has type `std::vec::Vec<bool>`, which does not implement the `Copy` trait\n \n error: aborting due to 3 previous errors\n "}]}