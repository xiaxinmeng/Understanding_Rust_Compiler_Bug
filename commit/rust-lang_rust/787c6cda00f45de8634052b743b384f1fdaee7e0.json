{"sha": "787c6cda00f45de8634052b743b384f1fdaee7e0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc4N2M2Y2RhMDBmNDVkZTg2MzQwNTJiNzQzYjM4NGYxZmRhZWU3ZTA=", "commit": {"author": {"name": "Dave Huseby", "email": "dhuseby@mozilla.com", "date": "2015-04-03T00:27:19Z"}, "committer": {"name": "Dave Huseby", "email": "dhuseby@mozilla.com", "date": "2015-04-03T15:54:08Z"}, "message": "this correctly disables jemalloc on Bitrig", "tree": {"sha": "0ac94894a0ce319d295d6d5d5e8834f9d34a0cba", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0ac94894a0ce319d295d6d5d5e8834f9d34a0cba"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/787c6cda00f45de8634052b743b384f1fdaee7e0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/787c6cda00f45de8634052b743b384f1fdaee7e0", "html_url": "https://github.com/rust-lang/rust/commit/787c6cda00f45de8634052b743b384f1fdaee7e0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/787c6cda00f45de8634052b743b384f1fdaee7e0/comments", "author": null, "committer": null, "parents": [{"sha": "2615106a46879c4e9acc46874ebe06b549d06d67", "url": "https://api.github.com/repos/rust-lang/rust/commits/2615106a46879c4e9acc46874ebe06b549d06d67", "html_url": "https://github.com/rust-lang/rust/commit/2615106a46879c4e9acc46874ebe06b549d06d67"}], "stats": {"total": 10, "additions": 8, "deletions": 2}, "files": [{"sha": "1c0911314b2fb12a3b502f39d8f9cd5724db880c", "filename": "configure", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/787c6cda00f45de8634052b743b384f1fdaee7e0/configure", "raw_url": "https://github.com/rust-lang/rust/raw/787c6cda00f45de8634052b743b384f1fdaee7e0/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=787c6cda00f45de8634052b743b384f1fdaee7e0", "patch": "@@ -545,7 +545,6 @@ opt verify-install 1 \"verify installed binaries work\"\n # This is used by the automation to produce single-target nightlies\n opt dist-host-only 0 \"only install bins for the host architecture\"\n opt inject-std-version 1 \"inject the current compiler version of libstd into programs\"\n-opt jemalloc 1 \"build liballoc with jemalloc\"\n opt llvm-version-check 1 \"don't check if the LLVM version is supported, build anyway\"\n \n valopt localstatedir \"/var/lib\" \"local state directory\"\n@@ -562,6 +561,7 @@ valopt android-cross-path \"/opt/ndk_standalone\" \"Android NDK standalone path\"\n # (others are conditionally saved).\n opt_nosave manage-submodules 1 \"let the build manage the git submodules\"\n opt_nosave clang 0 \"prefer clang to gcc for building the runtime\"\n+opt_nosave jemalloc 1 \"build liballoc with jemalloc\"\n \n valopt_nosave prefix \"/usr/local\" \"set installation prefix\"\n valopt_nosave local-rust-root \"/usr/local\" \"set prefix for local rust binary\"\n@@ -775,7 +775,7 @@ if [ $CFG_OSTYPE = unknown-bitrig ]\n then\n     step_msg \"on Bitrig, forcing use of clang, disabling jemalloc\"\n     CFG_ENABLE_CLANG=1\n-    CFG_ENABLE_JEMALLOC=0\n+    CFG_DISABLE_JEMALLOC=1\n fi\n \n if [ -z \"$CFG_ENABLE_CLANG\" -a -z \"$CFG_GCC\" ]\n@@ -828,6 +828,12 @@ then\n     putvar CFG_ENABLE_CLANG\n fi\n \n+# Same with jemalloc.  save the setting here.\n+if [ ! -z \"$CFG_DISABLE_JEMALLOC\" ]\n+then\n+    putvar CFG_DISABLE_JEMALLOC\n+fi\n+\n if [ ! -z \"$CFG_LLVM_ROOT\" -a -z \"$CFG_DISABLE_LLVM_VERSION_CHECK\" -a -e \"$CFG_LLVM_ROOT/bin/llvm-config\" ]\n then\n     step_msg \"using custom LLVM at $CFG_LLVM_ROOT\""}]}