{"sha": "bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJiMjdiYzVjNjg3YzM4ZmZjN2UxMGU5NGFkNTVhMTBlMDZlZTFlMjU=", "commit": {"author": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2017-07-21T05:58:39Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2017-07-21T05:58:39Z"}, "message": "Merge pull request #1806 from topecongiro/item-brace-style\n\nApply item_brace_style to module", "tree": {"sha": "60da02283cc70bd004cc0047347b9017942bdd9f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/60da02283cc70bd004cc0047347b9017942bdd9f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25", "html_url": "https://github.com/rust-lang/rust/commit/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0786efcab2315bd81f9c2aefc84c16ed0ce8bf1c", "url": "https://api.github.com/repos/rust-lang/rust/commits/0786efcab2315bd81f9c2aefc84c16ed0ce8bf1c", "html_url": "https://github.com/rust-lang/rust/commit/0786efcab2315bd81f9c2aefc84c16ed0ce8bf1c"}, {"sha": "3e3d3c00de689b933831a572d2ed8c4541e6584a", "url": "https://api.github.com/repos/rust-lang/rust/commits/3e3d3c00de689b933831a572d2ed8c4541e6584a", "html_url": "https://github.com/rust-lang/rust/commit/3e3d3c00de689b933831a572d2ed8c4541e6584a"}], "stats": {"total": 51, "additions": 47, "deletions": 4}, "files": [{"sha": "e6e7f038ce7c70bfdc6acd3d09d6aa24560033ab", "filename": "src/visitor.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/src%2Fvisitor.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/src%2Fvisitor.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fvisitor.rs?ref=bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25", "patch": "@@ -19,7 +19,7 @@ use {Indent, Shape};\n use codemap::{LineRangeUtils, SpanUtils};\n use comment::{contains_comment, FindUncommented};\n use comment::rewrite_comment;\n-use config::Config;\n+use config::{BraceStyle, Config};\n use expr::{format_expr, ExprType};\n use items::{format_impl, format_trait, rewrite_associated_impl_type, rewrite_associated_type,\n             rewrite_static, rewrite_type_alias};\n@@ -665,7 +665,11 @@ impl<'a> FmtVisitor<'a> {\n         self.buffer.push_str(&ident.to_string());\n \n         if is_internal {\n-            self.buffer.push_str(\" {\");\n+            match self.config.item_brace_style() {\n+                BraceStyle::AlwaysNextLine => self.buffer\n+                    .push_str(&format!(\"\\n{}{{\", self.block_indent.to_string(self.config))),\n+                _ => self.buffer.push_str(\" {\"),\n+            }\n             // Hackery to account for the closing }.\n             let mod_lo = self.codemap.span_after(source!(self, s), \"{\");\n             let body_snippet = self.snippet(mk_sp(mod_lo, source!(self, m.inner).hi - BytePos(1)));"}, {"sha": "aa84801fe5d61ed51f067d137fa16347e5d66e93", "filename": "tests/source/configs-item_brace_style-always_next_line.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/tests%2Fsource%2Fconfigs-item_brace_style-always_next_line.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/tests%2Fsource%2Fconfigs-item_brace_style-always_next_line.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fconfigs-item_brace_style-always_next_line.rs?ref=bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25", "patch": "@@ -8,3 +8,9 @@ struct Lorem {\n struct Dolor<T> where T: Eq {\n     sit: T,\n }\n+\n+#[cfg(test)]\n+mod tests {\n+    #[test]\n+    fn it_works() {}\n+}"}, {"sha": "a67f7e6478e5ac4a7d44ee86c03e69f14daf31e4", "filename": "tests/source/configs-item_brace_style-prefer_same_line.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/tests%2Fsource%2Fconfigs-item_brace_style-prefer_same_line.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/tests%2Fsource%2Fconfigs-item_brace_style-prefer_same_line.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fconfigs-item_brace_style-prefer_same_line.rs?ref=bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25", "patch": "@@ -8,3 +8,9 @@ struct Lorem {\n struct Dolor<T> where T: Eq {\n     sit: T,\n }\n+\n+#[cfg(test)]\n+mod tests {\n+    #[test]\n+    fn it_works() {}\n+}"}, {"sha": "11d4015d4c909747f4c09cc02e10915ebc1cb172", "filename": "tests/source/configs-item_brace_style-same_line_where.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/tests%2Fsource%2Fconfigs-item_brace_style-same_line_where.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/tests%2Fsource%2Fconfigs-item_brace_style-same_line_where.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fconfigs-item_brace_style-same_line_where.rs?ref=bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25", "patch": "@@ -8,3 +8,9 @@ struct Lorem {\n struct Dolor<T> where T: Eq {\n     sit: T,\n }\n+\n+#[cfg(test)]\n+mod tests {\n+    #[test]\n+    fn it_works() {}\n+}"}, {"sha": "eb264446bde69a83001522d88f9eb10adf2c9989", "filename": "tests/target/configs-item_brace_style-always_next_line.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/tests%2Ftarget%2Fconfigs-item_brace_style-always_next_line.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/tests%2Ftarget%2Fconfigs-item_brace_style-always_next_line.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fconfigs-item_brace_style-always_next_line.rs?ref=bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25", "patch": "@@ -12,3 +12,10 @@ where\n {\n     sit: T,\n }\n+\n+#[cfg(test)]\n+mod tests\n+{\n+    #[test]\n+    fn it_works() {}\n+}"}, {"sha": "1b5dbfa9d4972d7e7066e89c17812c3e8c7fda76", "filename": "tests/target/configs-item_brace_style-prefer_same_line.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/tests%2Ftarget%2Fconfigs-item_brace_style-prefer_same_line.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/tests%2Ftarget%2Fconfigs-item_brace_style-prefer_same_line.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fconfigs-item_brace_style-prefer_same_line.rs?ref=bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25", "patch": "@@ -10,3 +10,9 @@ where\n     T: Eq, {\n     sit: T,\n }\n+\n+#[cfg(test)]\n+mod tests {\n+    #[test]\n+    fn it_works() {}\n+}"}, {"sha": "ab88c1ca3ab2a6b254107fbf0321b7f0c9ee57c7", "filename": "tests/target/configs-item_brace_style-same_line_where.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/tests%2Ftarget%2Fconfigs-item_brace_style-same_line_where.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/tests%2Ftarget%2Fconfigs-item_brace_style-same_line_where.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fconfigs-item_brace_style-same_line_where.rs?ref=bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25", "patch": "@@ -11,3 +11,9 @@ where\n {\n     sit: T,\n }\n+\n+#[cfg(test)]\n+mod tests {\n+    #[test]\n+    fn it_works() {}\n+}"}, {"sha": "422ed55b2db509f4726f55801550767a61ad2bb8", "filename": "tests/target/indented-impl.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/tests%2Ftarget%2Findented-impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/tests%2Ftarget%2Findented-impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Findented-impl.rs?ref=bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25", "patch": "@@ -1,5 +1,6 @@\n // rustfmt-item_brace_style: AlwaysNextLine\n-mod x {\n+mod x\n+{\n     struct X(i8);\n \n     impl Y for X"}, {"sha": "270cd35eb2e732d8104621561d3ba09764606519", "filename": "tests/target/item-brace-style-always-next-line.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/tests%2Ftarget%2Fitem-brace-style-always-next-line.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25/tests%2Ftarget%2Fitem-brace-style-always-next-line.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fitem-brace-style-always-next-line.rs?ref=bb27bc5c687c38ffc7e10e94ad55a10e06ee1e25", "patch": "@@ -1,6 +1,7 @@\n // rustfmt-item_brace_style: AlwaysNextLine\n \n-mod M {\n+mod M\n+{\n     enum A\n     {\n         A,"}]}