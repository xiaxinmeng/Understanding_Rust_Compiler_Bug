{"sha": "664cc8c754646188af39d25dd67e6057109f7c22", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY2NGNjOGM3NTQ2NDYxODhhZjM5ZDI1ZGQ2N2U2MDU3MTA5ZjdjMjI=", "commit": {"author": {"name": "Milo", "email": "50248166+Milo123459@users.noreply.github.com", "date": "2021-06-19T07:12:46Z"}, "committer": {"name": "Milo", "email": "50248166+Milo123459@users.noreply.github.com", "date": "2021-06-19T07:12:46Z"}, "message": "use num_format", "tree": {"sha": "dccffe3c2eb92483e06950b84d071e8116809700", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/dccffe3c2eb92483e06950b84d071e8116809700"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/664cc8c754646188af39d25dd67e6057109f7c22", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/664cc8c754646188af39d25dd67e6057109f7c22", "html_url": "https://github.com/rust-lang/rust/commit/664cc8c754646188af39d25dd67e6057109f7c22", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/664cc8c754646188af39d25dd67e6057109f7c22/comments", "author": {"login": "Milo123459", "id": 50248166, "node_id": "MDQ6VXNlcjUwMjQ4MTY2", "avatar_url": "https://avatars.githubusercontent.com/u/50248166?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Milo123459", "html_url": "https://github.com/Milo123459", "followers_url": "https://api.github.com/users/Milo123459/followers", "following_url": "https://api.github.com/users/Milo123459/following{/other_user}", "gists_url": "https://api.github.com/users/Milo123459/gists{/gist_id}", "starred_url": "https://api.github.com/users/Milo123459/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Milo123459/subscriptions", "organizations_url": "https://api.github.com/users/Milo123459/orgs", "repos_url": "https://api.github.com/users/Milo123459/repos", "events_url": "https://api.github.com/users/Milo123459/events{/privacy}", "received_events_url": "https://api.github.com/users/Milo123459/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Milo123459", "id": 50248166, "node_id": "MDQ6VXNlcjUwMjQ4MTY2", "avatar_url": "https://avatars.githubusercontent.com/u/50248166?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Milo123459", "html_url": "https://github.com/Milo123459", "followers_url": "https://api.github.com/users/Milo123459/followers", "following_url": "https://api.github.com/users/Milo123459/following{/other_user}", "gists_url": "https://api.github.com/users/Milo123459/gists{/gist_id}", "starred_url": "https://api.github.com/users/Milo123459/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Milo123459/subscriptions", "organizations_url": "https://api.github.com/users/Milo123459/orgs", "repos_url": "https://api.github.com/users/Milo123459/repos", "events_url": "https://api.github.com/users/Milo123459/events{/privacy}", "received_events_url": "https://api.github.com/users/Milo123459/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d2f7e0fea44b7fda460f38acc7d361259aaa1116", "url": "https://api.github.com/repos/rust-lang/rust/commits/d2f7e0fea44b7fda460f38acc7d361259aaa1116", "html_url": "https://github.com/rust-lang/rust/commit/d2f7e0fea44b7fda460f38acc7d361259aaa1116"}], "stats": {"total": 46, "additions": 38, "deletions": 8}, "files": [{"sha": "51e11d28dfb4641a9d0faac0411f427e951ea07d", "filename": "Cargo.lock", "status": "modified", "additions": 30, "deletions": 3, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/664cc8c754646188af39d25dd67e6057109f7c22/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/664cc8c754646188af39d25dd67e6057109f7c22/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=664cc8c754646188af39d25dd67e6057109f7c22", "patch": "@@ -47,6 +47,15 @@ version = \"0.12.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"33954243bd79057c2de7338850b85983a44588021f8a5fee574a8888c6de4344\"\n \n+[[package]]\n+name = \"arrayvec\"\n+version = \"0.4.12\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"cd9fd44efafa8690358b7408d253adf110036b88f55672a933f01d616ad9b1b9\"\n+dependencies = [\n+ \"nodrop\",\n+]\n+\n [[package]]\n name = \"arrayvec\"\n version = \"0.7.0\"\n@@ -459,7 +468,7 @@ dependencies = [\n name = \"hir\"\n version = \"0.0.0\"\n dependencies = [\n- \"arrayvec\",\n+ \"arrayvec 0.7.0\",\n  \"base_db\",\n  \"cfg\",\n  \"either\",\n@@ -529,7 +538,7 @@ dependencies = [\n name = \"hir_ty\"\n version = \"0.0.0\"\n dependencies = [\n- \"arrayvec\",\n+ \"arrayvec 0.7.0\",\n  \"base_db\",\n  \"chalk-ir\",\n  \"chalk-recursive\",\n@@ -582,6 +591,7 @@ dependencies = [\n  \"indexmap\",\n  \"itertools\",\n  \"log\",\n+ \"num-format\",\n  \"oorandom\",\n  \"profile\",\n  \"pulldown-cmark\",\n@@ -934,6 +944,12 @@ dependencies = [\n  \"winapi\",\n ]\n \n+[[package]]\n+name = \"nodrop\"\n+version = \"0.1.14\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"72ef4a56884ca558e5ddb05a1d1e7e1bfd9a68d9ed024c21704cc98872dae1bb\"\n+\n [[package]]\n name = \"notify\"\n version = \"5.0.0-pre.9\"\n@@ -960,6 +976,16 @@ dependencies = [\n  \"winapi\",\n ]\n \n+[[package]]\n+name = \"num-format\"\n+version = \"0.4.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"bafe4179722c2894288ee77a9f044f02811c86af699344c498b0840c698a2465\"\n+dependencies = [\n+ \"arrayvec 0.4.12\",\n+ \"itoa\",\n+]\n+\n [[package]]\n name = \"num_cpus\"\n version = \"1.13.0\"\n@@ -1317,6 +1343,7 @@ dependencies = [\n  \"lsp-types\",\n  \"mbe\",\n  \"mimalloc\",\n+ \"num-format\",\n  \"oorandom\",\n  \"parking_lot\",\n  \"proc_macro_srv\",\n@@ -1560,7 +1587,7 @@ dependencies = [\n name = \"syntax\"\n version = \"0.0.0\"\n dependencies = [\n- \"arrayvec\",\n+ \"arrayvec 0.7.0\",\n  \"cov-mark\",\n  \"expect-test\",\n  \"indexmap\","}, {"sha": "e76fa5c2dd31f693edec94cac9bc64208416eca5", "filename": "crates/ide/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/664cc8c754646188af39d25dd67e6057109f7c22/crates%2Fide%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/664cc8c754646188af39d25dd67e6057109f7c22/crates%2Fide%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2FCargo.toml?ref=664cc8c754646188af39d25dd67e6057109f7c22", "patch": "@@ -21,7 +21,7 @@ pulldown-cmark-to-cmark = \"6.0.0\"\n pulldown-cmark = { version = \"0.8.0\", default-features = false }\n url = \"2.1.1\"\n dot = \"0.1.4\"\n-\n+num-format = \"0.4.0\"\n stdx = { path = \"../stdx\", version = \"0.0.0\" }\n syntax = { path = \"../syntax\", version = \"0.0.0\" }\n text_edit = { path = \"../text_edit\", version = \"0.0.0\" }"}, {"sha": "f0b670cd6e956f88a1d0b5b00cf59d1de8f9cf05", "filename": "crates/ide/src/status.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/664cc8c754646188af39d25dd67e6057109f7c22/crates%2Fide%2Fsrc%2Fstatus.rs", "raw_url": "https://github.com/rust-lang/rust/raw/664cc8c754646188af39d25dd67e6057109f7c22/crates%2Fide%2Fsrc%2Fstatus.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fstatus.rs?ref=664cc8c754646188af39d25dd67e6057109f7c22", "patch": "@@ -10,6 +10,7 @@ use ide_db::{\n     RootDatabase,\n };\n use itertools::Itertools;\n+use num_format::{Buffer, Locale};\n use profile::{memory_usage, Bytes};\n use rustc_hash::FxHashMap;\n use stdx::format_to;\n@@ -109,7 +110,8 @@ pub(crate) struct SyntaxTreeStats {\n \n impl fmt::Display for SyntaxTreeStats {\n     fn fmt(&self, fmt: &mut fmt::Formatter) -> fmt::Result {\n-        write!(fmt, \"{} trees, {} preserved\", self.total, self.retained)\n+        let buf = Buffer::default().write_formatted(&self.total, &Locale::en);\n+        write!(fmt, \"{} trees, {} preserved\", buf.to_string(), self.retained)\n     }\n }\n "}, {"sha": "9be140b58bc0e19c3e8ee26d8d3e7152d823721d", "filename": "crates/rust-analyzer/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/664cc8c754646188af39d25dd67e6057109f7c22/crates%2Frust-analyzer%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/664cc8c754646188af39d25dd67e6057109f7c22/crates%2Frust-analyzer%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2FCargo.toml?ref=664cc8c754646188af39d25dd67e6057109f7c22", "patch": "@@ -38,7 +38,7 @@ tracing = \"0.1\"\n tracing-subscriber = { version = \"0.2\", default-features = false, features = [\"env-filter\", \"registry\"] }\n tracing-tree = { version = \"0.1.4\" }\n always-assert = \"0.1\"\n-\n+num-format = \"0.4.0\"\n stdx = { path = \"../stdx\", version = \"0.0.0\" }\n flycheck = { path = \"../flycheck\", version = \"0.0.0\" }\n ide = { path = \"../ide\", version = \"0.0.0\" }"}, {"sha": "9858ac717ff58f24a11a70893739a2fa7a872d16", "filename": "crates/rust-analyzer/src/handlers.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/664cc8c754646188af39d25dd67e6057109f7c22/crates%2Frust-analyzer%2Fsrc%2Fhandlers.rs", "raw_url": "https://github.com/rust-lang/rust/raw/664cc8c754646188af39d25dd67e6057109f7c22/crates%2Frust-analyzer%2Fsrc%2Fhandlers.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fhandlers.rs?ref=664cc8c754646188af39d25dd67e6057109f7c22", "patch": "@@ -25,6 +25,7 @@ use lsp_types::{\n     SemanticTokensRangeResult, SemanticTokensResult, SymbolInformation, SymbolTag,\n     TextDocumentIdentifier, TextDocumentPositionParams, Url, WorkspaceEdit,\n };\n+use num_format::{Locale, ToFormattedString};\n use project_model::TargetKind;\n use serde::{Deserialize, Serialize};\n use serde_json::{json, to_value};\n@@ -66,8 +67,8 @@ pub(crate) fn handle_analyzer_status(\n         format_to!(\n             buf,\n             \"Loaded {:?} packages across {} workspace{}.\\n\",\n-            snap.workspaces.iter().map(|w| w.n_packages()).sum::<usize>(),\n-            snap.workspaces.len(),\n+            snap.workspaces.iter().map(|w| w.n_packages()).sum::<usize>().to_formatted_string(&Locale::en),\n+            snap.workspaces.len().to_formatted_string(&Locale::en),\n             if snap.workspaces.len() == 1 { \"\" } else { \"s\" }\n         );\n     }"}]}