{"sha": "6ef8198406af9ba18787e0fd50ae2e25f78b7e4f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZlZjgxOTg0MDZhZjliYTE4Nzg3ZTBmZDUwYWUyZTI1Zjc4YjdlNGY=", "commit": {"author": {"name": "Michael Woerister", "email": "michaelwoerister@posteo.net", "date": "2016-08-12T22:22:02Z"}, "committer": {"name": "Michael Woerister", "email": "michaelwoerister@posteo.net", "date": "2016-08-29T18:27:40Z"}, "message": "Move `flock.rs` from librustdoc to librustc_data_structures.", "tree": {"sha": "db36496bd2ae735b403376f2e0f3642984e69318", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/db36496bd2ae735b403376f2e0f3642984e69318"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6ef8198406af9ba18787e0fd50ae2e25f78b7e4f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6ef8198406af9ba18787e0fd50ae2e25f78b7e4f", "html_url": "https://github.com/rust-lang/rust/commit/6ef8198406af9ba18787e0fd50ae2e25f78b7e4f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6ef8198406af9ba18787e0fd50ae2e25f78b7e4f/comments", "author": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "committer": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "86dde9bbda92c02c61282b5df5d38338a798ef3b", "url": "https://api.github.com/repos/rust-lang/rust/commits/86dde9bbda92c02c61282b5df5d38338a798ef3b", "html_url": "https://github.com/rust-lang/rust/commit/86dde9bbda92c02c61282b5df5d38338a798ef3b"}], "stats": {"total": 16, "additions": 10, "deletions": 6}, "files": [{"sha": "a915d07384f3cd712dc012af7e5684e1ddb61c92", "filename": "mk/crates.mk", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/6ef8198406af9ba18787e0fd50ae2e25f78b7e4f/mk%2Fcrates.mk", "raw_url": "https://github.com/rust-lang/rust/raw/6ef8198406af9ba18787e0fd50ae2e25f78b7e4f/mk%2Fcrates.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fcrates.mk?ref=6ef8198406af9ba18787e0fd50ae2e25f78b7e4f", "patch": "@@ -112,7 +112,7 @@ DEPS_rustc := syntax fmt_macros flate arena serialize getopts rbml \\\n \t      rustc_const_math syntax_pos rustc_errors\n DEPS_rustc_back := std syntax flate log libc\n DEPS_rustc_borrowck := rustc log graphviz syntax syntax_pos rustc_errors rustc_mir\n-DEPS_rustc_data_structures := std log serialize\n+DEPS_rustc_data_structures := std log serialize libc\n DEPS_rustc_driver := arena flate getopts graphviz libc rustc rustc_back rustc_borrowck \\\n                      rustc_typeck rustc_mir rustc_resolve log syntax serialize rustc_llvm \\\n                      rustc_trans rustc_privacy rustc_lint rustc_plugin \\\n@@ -137,9 +137,8 @@ DEPS_rustc_save_analysis := rustc log syntax syntax_pos serialize\n DEPS_rustc_typeck := rustc syntax syntax_pos rustc_platform_intrinsics rustc_const_math \\\n                      rustc_const_eval rustc_errors\n \n-DEPS_rustdoc := rustc rustc_driver native:hoedown serialize getopts \\\n-                test rustc_lint rustc_const_eval syntax_pos\n-\n+DEPS_rustdoc := rustc rustc_driver native:hoedown serialize getopts test \\\n+                rustc_lint rustc_const_eval syntax_pos rustc_data_structures\n \n TOOL_DEPS_compiletest := test getopts log serialize\n TOOL_DEPS_rustdoc := rustdoc"}, {"sha": "41bcfdb7cb0f03b86fe21efdc0c85a8fc3fa0639", "filename": "src/librustc_data_structures/flock.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/6ef8198406af9ba18787e0fd50ae2e25f78b7e4f/src%2Flibrustc_data_structures%2Fflock.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6ef8198406af9ba18787e0fd50ae2e25f78b7e4f/src%2Flibrustc_data_structures%2Fflock.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_data_structures%2Fflock.rs?ref=6ef8198406af9ba18787e0fd50ae2e25f78b7e4f", "previous_filename": "src/librustdoc/flock.rs"}, {"sha": "4391123559f9b558682279851c4de64973eb83ec", "filename": "src/librustc_data_structures/lib.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/6ef8198406af9ba18787e0fd50ae2e25f78b7e4f/src%2Flibrustc_data_structures%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6ef8198406af9ba18787e0fd50ae2e25f78b7e4f/src%2Flibrustc_data_structures%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_data_structures%2Flib.rs?ref=6ef8198406af9ba18787e0fd50ae2e25f78b7e4f", "patch": "@@ -30,13 +30,16 @@\n #![feature(staged_api)]\n #![feature(unboxed_closures)]\n #![feature(fn_traits)]\n+#![feature(libc)]\n \n #![cfg_attr(test, feature(test))]\n \n extern crate core;\n #[macro_use]\n extern crate log;\n extern crate serialize as rustc_serialize; // used by deriving\n+#[cfg(unix)]\n+extern crate libc;\n \n pub mod bitvec;\n pub mod graph;\n@@ -51,6 +54,7 @@ pub mod fnv;\n pub mod tuple_slice;\n pub mod veccell;\n pub mod control_flow_graph;\n+pub mod flock;\n \n // See comments in src/librustc/lib.rs\n #[doc(hidden)]"}, {"sha": "d3b9ca737b990336d7427ea2df38fbbef4e6252d", "filename": "src/librustdoc/html/render.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/6ef8198406af9ba18787e0fd50ae2e25f78b7e4f/src%2Flibrustdoc%2Fhtml%2Frender.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6ef8198406af9ba18787e0fd50ae2e25f78b7e4f/src%2Flibrustdoc%2Fhtml%2Frender.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender.rs?ref=6ef8198406af9ba18787e0fd50ae2e25f78b7e4f", "patch": "@@ -62,6 +62,7 @@ use rustc::middle::stability;\n use rustc::session::config::get_unstable_features_setting;\n use rustc::hir;\n use rustc::util::nodemap::{FnvHashMap, FnvHashSet};\n+use rustc_data_structures::flock;\n \n use clean::{self, Attributes, GetDefId};\n use doctree;\n@@ -651,7 +652,7 @@ fn write_shared(cx: &Context,\n     // docs placed in the output directory, so this needs to be a synchronized\n     // operation with respect to all other rustdocs running around.\n     try_err!(mkdir(&cx.dst), &cx.dst);\n-    let _lock = ::flock::Lock::new(&cx.dst.join(\".lock\"));\n+    let _lock = flock::Lock::new(&cx.dst.join(\".lock\"));\n \n     // Add all the static files. These may already exist, but we just\n     // overwrite them anyway to make sure that they're fresh and up-to-date."}, {"sha": "0e685f063bd7b52dfc40f5f067bebaede45f7c65", "filename": "src/librustdoc/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6ef8198406af9ba18787e0fd50ae2e25f78b7e4f/src%2Flibrustdoc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6ef8198406af9ba18787e0fd50ae2e25f78b7e4f/src%2Flibrustdoc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Flib.rs?ref=6ef8198406af9ba18787e0fd50ae2e25f78b7e4f", "patch": "@@ -35,6 +35,7 @@ extern crate libc;\n extern crate rustc;\n extern crate rustc_const_eval;\n extern crate rustc_const_math;\n+extern crate rustc_data_structures;\n extern crate rustc_trans;\n extern crate rustc_driver;\n extern crate rustc_resolve;\n@@ -86,7 +87,6 @@ pub mod plugins;\n pub mod visit_ast;\n pub mod visit_lib;\n pub mod test;\n-mod flock;\n \n use clean::Attributes;\n "}]}