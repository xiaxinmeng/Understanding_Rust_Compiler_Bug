{"sha": "afb5b2150a011c779f49fc6df1cf32811271230e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFmYjViMjE1MGEwMTFjNzc5ZjQ5ZmM2ZGYxY2YzMjgxMTI3MTIzMGU=", "commit": {"author": {"name": "Fran\u00e7ois Mockers", "email": "mockersf@gmail.com", "date": "2021-07-04T23:33:51Z"}, "committer": {"name": "Fran\u00e7ois Mockers", "email": "mockersf@gmail.com", "date": "2021-07-06T20:13:08Z"}, "message": "review - better error names/doc", "tree": {"sha": "c3ac04c6e1f2ad28ff1646c9a8fe630c5b925c16", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c3ac04c6e1f2ad28ff1646c9a8fe630c5b925c16"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/afb5b2150a011c779f49fc6df1cf32811271230e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/afb5b2150a011c779f49fc6df1cf32811271230e", "html_url": "https://github.com/rust-lang/rust/commit/afb5b2150a011c779f49fc6df1cf32811271230e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/afb5b2150a011c779f49fc6df1cf32811271230e/comments", "author": {"login": "mockersf", "id": 8672791, "node_id": "MDQ6VXNlcjg2NzI3OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/8672791?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mockersf", "html_url": "https://github.com/mockersf", "followers_url": "https://api.github.com/users/mockersf/followers", "following_url": "https://api.github.com/users/mockersf/following{/other_user}", "gists_url": "https://api.github.com/users/mockersf/gists{/gist_id}", "starred_url": "https://api.github.com/users/mockersf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mockersf/subscriptions", "organizations_url": "https://api.github.com/users/mockersf/orgs", "repos_url": "https://api.github.com/users/mockersf/repos", "events_url": "https://api.github.com/users/mockersf/events{/privacy}", "received_events_url": "https://api.github.com/users/mockersf/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mockersf", "id": 8672791, "node_id": "MDQ6VXNlcjg2NzI3OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/8672791?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mockersf", "html_url": "https://github.com/mockersf", "followers_url": "https://api.github.com/users/mockersf/followers", "following_url": "https://api.github.com/users/mockersf/following{/other_user}", "gists_url": "https://api.github.com/users/mockersf/gists{/gist_id}", "starred_url": "https://api.github.com/users/mockersf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mockersf/subscriptions", "organizations_url": "https://api.github.com/users/mockersf/orgs", "repos_url": "https://api.github.com/users/mockersf/repos", "events_url": "https://api.github.com/users/mockersf/events{/privacy}", "received_events_url": "https://api.github.com/users/mockersf/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fc97fbeef3cbd21d94a321faead3ee64b1a14a61", "url": "https://api.github.com/repos/rust-lang/rust/commits/fc97fbeef3cbd21d94a321faead3ee64b1a14a61", "html_url": "https://github.com/rust-lang/rust/commit/fc97fbeef3cbd21d94a321faead3ee64b1a14a61"}], "stats": {"total": 17, "additions": 9, "deletions": 8}, "files": [{"sha": "08499cef33ef19cb23564159e605f7408587341c", "filename": "src/librustdoc/html/format.rs", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/afb5b2150a011c779f49fc6df1cf32811271230e/src%2Flibrustdoc%2Fhtml%2Fformat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/afb5b2150a011c779f49fc6df1cf32811271230e/src%2Flibrustdoc%2Fhtml%2Fformat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fformat.rs?ref=afb5b2150a011c779f49fc6df1cf32811271230e", "patch": "@@ -474,11 +474,12 @@ impl clean::GenericArgs {\n \n // Possible errors when computing href link source for a `DefId`\n crate enum HrefError {\n-    // `DefId` is in an unknown location. This seems to happen when building without dependencies\n-    // but a trait from a dependency is still visible\n-    UnknownLocation,\n-    // Unavailable because private\n-    Unavailable,\n+    /// This item is known to rustdoc, but from a crate that does not have documentation generated.\n+    ///\n+    /// This can only happen for non-local items.\n+    DocumentationNotBuilt,\n+    /// This can only happen for non-local items when `--document-private-items` is not passed.\n+    Private,\n     // Not in external cache, href link should be in same page\n     NotInExternalCache,\n }\n@@ -491,7 +492,7 @@ crate fn href(did: DefId, cx: &Context<'_>) -> Result<(String, ItemType, Vec<Str\n     }\n \n     if !did.is_local() && !cache.access_levels.is_public(did) && !cache.document_private {\n-        return Err(HrefError::Unavailable);\n+        return Err(HrefError::Private);\n     }\n \n     let (fqp, shortty, mut url_parts) = match cache.paths.get(&did) {\n@@ -513,7 +514,7 @@ crate fn href(did: DefId, cx: &Context<'_>) -> Result<(String, ItemType, Vec<Str\n                             s\n                         }\n                         ExternalLocation::Local => href_relative_parts(module_fqp, relative_to),\n-                        ExternalLocation::Unknown => return Err(HrefError::UnknownLocation),\n+                        ExternalLocation::Unknown => return Err(HrefError::DocumentationNotBuilt),\n                     },\n                 )\n             } else {"}, {"sha": "e6a10c47497b1d652cb5198c88b302a2467f3874", "filename": "src/librustdoc/html/render/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/afb5b2150a011c779f49fc6df1cf32811271230e/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/afb5b2150a011c779f49fc6df1cf32811271230e/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs?ref=afb5b2150a011c779f49fc6df1cf32811271230e", "patch": "@@ -869,7 +869,7 @@ fn render_assoc_item(\n \n                 match href(did.expect_def_id(), cx) {\n                     Ok(p) => Some(format!(\"{}#{}.{}\", p.0, ty, name)),\n-                    Err(HrefError::UnknownLocation) => None,\n+                    Err(HrefError::DocumentationNotBuilt) => None,\n                     Err(_) => Some(format!(\"#{}.{}\", ty, name)),\n                 }\n             }"}]}