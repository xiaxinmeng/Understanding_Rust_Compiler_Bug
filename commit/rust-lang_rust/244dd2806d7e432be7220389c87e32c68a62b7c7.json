{"sha": "244dd2806d7e432be7220389c87e32c68a62b7c7", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI0NGRkMjgwNmQ3ZTQzMmJlNzIyMDM4OWM4N2UzMmM2OGE2MmI3Yzc=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2020-07-02T03:35:52Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-07-02T03:35:52Z"}, "message": "Rollup merge of #73839 - crlf0710:snapshot_the_reality, r=Manishearth\n\nSplit and expand nonstandard-style lints unicode unit test.\n\nRFC 2457 requested that the `nonstandard_style` series of linted be adjusted to cover the non_ascii_identifier case. However when i read the code of those implementations, it seems they're already supporting non_ascii_identifiers. But the exact rules is a little different than what's proposed in RFC 2457.\n\nSo I splitted and expanded the existing test case to try to exercise every branch in the code. I think it'll also be easier to examine the cases in these unit tests to see whether it's ok to just leave them as is, or some adjustments are needed.\n\nr? @Manishearth", "tree": {"sha": "3143d98a90dfe2248c38e35cfd3542a870a99ef7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3143d98a90dfe2248c38e35cfd3542a870a99ef7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/244dd2806d7e432be7220389c87e32c68a62b7c7", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJe/VYZCRBK7hj4Ov3rIwAAdHIIAIPU6M8DB9nN90JbCVihPAzH\nbJiSpYXN2COZQURQtYWQe+/HuLeA1G64NYRE2ZweA1P1j7mtWXMbO+V1KqpD6xNi\nJHMwWKdYqZJ499+2/4wZSxKvmSjmR0MI3/QKUS93fRGSdmpf/G2QDEDdNI98xvSp\nMUCaFTu7y1pcRgdFfIeqiwPSihckwbHJaZypQxnQPDW/Bp5P9BjQ/GOCcD81UliT\n5FGzbcFGCSf8kH039bMk1H9lcqtNXq7pMp1FOEcmTxDUw+YUIb9LaEF5Mv5Ux/cu\njbwPRL+WYqeQeodZMtpXmlSgpIKOX8ROyYZO2XSpX+YBiw+0JBRRPAy+ZMVNfTg=\n=emj1\n-----END PGP SIGNATURE-----\n", "payload": "tree 3143d98a90dfe2248c38e35cfd3542a870a99ef7\nparent 5d429f384734a3245db8f7862e95b5adb2112705\nparent e8f5785bfc3123b67e79e509c76259062e214b97\nauthor Manish Goregaokar <manishsmail@gmail.com> 1593660952 -0700\ncommitter GitHub <noreply@github.com> 1593660952 -0700\n\nRollup merge of #73839 - crlf0710:snapshot_the_reality, r=Manishearth\n\nSplit and expand nonstandard-style lints unicode unit test.\n\nRFC 2457 requested that the `nonstandard_style` series of linted be adjusted to cover the non_ascii_identifier case. However when i read the code of those implementations, it seems they're already supporting non_ascii_identifiers. But the exact rules is a little different than what's proposed in RFC 2457.\n\nSo I splitted and expanded the existing test case to try to exercise every branch in the code. I think it'll also be easier to examine the cases in these unit tests to see whether it's ok to just leave them as is, or some adjustments are needed.\n\nr? @Manishearth\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/244dd2806d7e432be7220389c87e32c68a62b7c7", "html_url": "https://github.com/rust-lang/rust/commit/244dd2806d7e432be7220389c87e32c68a62b7c7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/244dd2806d7e432be7220389c87e32c68a62b7c7/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5d429f384734a3245db8f7862e95b5adb2112705", "url": "https://api.github.com/repos/rust-lang/rust/commits/5d429f384734a3245db8f7862e95b5adb2112705", "html_url": "https://github.com/rust-lang/rust/commit/5d429f384734a3245db8f7862e95b5adb2112705"}, {"sha": "e8f5785bfc3123b67e79e509c76259062e214b97", "url": "https://api.github.com/repos/rust-lang/rust/commits/e8f5785bfc3123b67e79e509c76259062e214b97", "html_url": "https://github.com/rust-lang/rust/commit/e8f5785bfc3123b67e79e509c76259062e214b97"}], "stats": {"total": 205, "additions": 189, "deletions": 16}, "files": [{"sha": "4f90bd98c63e59ac39d064536c5b7e3ceab4b976", "filename": "src/test/ui/lint/lint-nonstandard-style-unicode-1.rs", "status": "added", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/rust-lang/rust/blob/244dd2806d7e432be7220389c87e32c68a62b7c7/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/244dd2806d7e432be7220389c87e32c68a62b7c7/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-1.rs?ref=244dd2806d7e432be7220389c87e32c68a62b7c7", "patch": "@@ -0,0 +1,50 @@\n+#![allow(dead_code)]\n+\n+#![forbid(non_camel_case_types)]\n+#![feature(non_ascii_idents)]\n+\n+// Some scripts (e.g., hiragana) don't have a concept of\n+// upper/lowercase\n+\n+// 1. non_camel_case_types\n+\n+// Can start with non-lowercase letter\n+struct \u0398\u03c7;\n+struct \u30d2a;\n+\n+struct \u03c7a;\n+//~^ ERROR type `\u03c7a` should have an upper camel case name\n+\n+// If there's already leading or trailing underscores, they get trimmed before checking.\n+// This is fine:\n+struct _\u30d2b;\n+\n+// This is not:\n+struct __\u03c7a;\n+//~^ ERROR type `__\u03c7a` should have an upper camel case name\n+\n+// Besides this, we cannot have two continous underscores in the middle.\n+\n+struct \u5bf9__\u5426;\n+//~^ ERROR type `\u5bf9__\u5426` should have an upper camel case name\n+\n+struct \u30d2__\u03c7;\n+//~^ ERROR type `\u30d2__\u03c7` should have an upper camel case name\n+\n+// also cannot have lowercase letter next to a underscore.\n+// so this triggers the lint:\n+\n+struct Hello_\u4f60\u597d;\n+//~^ ERROR type `Hello_\u4f60\u597d` should have an upper camel case name\n+\n+struct Hello_World;\n+//~^ ERROR type `Hello_World` should have an upper camel case name\n+\n+struct \u4f60_\u04df;\n+//~^ ERROR type `\u4f60_\u04df` should have an upper camel case name\n+\n+// and this is ok:\n+\n+struct \u4f60_\u597d;\n+\n+fn main() {}"}, {"sha": "371002656591c133a642f5678d7df7c20c3cbbc1", "filename": "src/test/ui/lint/lint-nonstandard-style-unicode-1.stderr", "status": "added", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/rust-lang/rust/blob/244dd2806d7e432be7220389c87e32c68a62b7c7/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/244dd2806d7e432be7220389c87e32c68a62b7c7/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-1.stderr?ref=244dd2806d7e432be7220389c87e32c68a62b7c7", "patch": "@@ -0,0 +1,50 @@\n+error: type `\u03c7a` should have an upper camel case name\n+  --> $DIR/lint-nonstandard-style-unicode-1.rs:15:8\n+   |\n+LL | struct \u03c7a;\n+   |        ^^ help: convert the identifier to upper camel case: `\u03a7a`\n+   |\n+note: the lint level is defined here\n+  --> $DIR/lint-nonstandard-style-unicode-1.rs:3:11\n+   |\n+LL | #![forbid(non_camel_case_types)]\n+   |           ^^^^^^^^^^^^^^^^^^^^\n+\n+error: type `__\u03c7a` should have an upper camel case name\n+  --> $DIR/lint-nonstandard-style-unicode-1.rs:23:8\n+   |\n+LL | struct __\u03c7a;\n+   |        ^^^^ help: convert the identifier to upper camel case: `\u03a7a`\n+\n+error: type `\u5bf9__\u5426` should have an upper camel case name\n+  --> $DIR/lint-nonstandard-style-unicode-1.rs:28:8\n+   |\n+LL | struct \u5bf9__\u5426;\n+   |        ^^^^^^ help: convert the identifier to upper camel case: `\u5bf9_\u5426`\n+\n+error: type `\u30d2__\u03c7` should have an upper camel case name\n+  --> $DIR/lint-nonstandard-style-unicode-1.rs:31:8\n+   |\n+LL | struct \u30d2__\u03c7;\n+   |        ^^^^^ help: convert the identifier to upper camel case: `\u30d2\u03a7`\n+\n+error: type `Hello_\u4f60\u597d` should have an upper camel case name\n+  --> $DIR/lint-nonstandard-style-unicode-1.rs:37:8\n+   |\n+LL | struct Hello_\u4f60\u597d;\n+   |        ^^^^^^^^^^ help: convert the identifier to upper camel case: `Hello\u4f60\u597d`\n+\n+error: type `Hello_World` should have an upper camel case name\n+  --> $DIR/lint-nonstandard-style-unicode-1.rs:40:8\n+   |\n+LL | struct Hello_World;\n+   |        ^^^^^^^^^^^ help: convert the identifier to upper camel case: `HelloWorld`\n+\n+error: type `\u4f60_\u04df` should have an upper camel case name\n+  --> $DIR/lint-nonstandard-style-unicode-1.rs:43:8\n+   |\n+LL | struct \u4f60_\u04df;\n+   |        ^^^^ help: convert the identifier to upper camel case: `\u4f60\u04de`\n+\n+error: aborting due to 7 previous errors\n+"}, {"sha": "813e0ea5c5708b76c7578aabeb084005bc03aa40", "filename": "src/test/ui/lint/lint-nonstandard-style-unicode-2.rs", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/244dd2806d7e432be7220389c87e32c68a62b7c7/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/244dd2806d7e432be7220389c87e32c68a62b7c7/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-2.rs?ref=244dd2806d7e432be7220389c87e32c68a62b7c7", "patch": "@@ -0,0 +1,30 @@\n+#![allow(dead_code)]\n+\n+#![forbid(non_snake_case)]\n+#![feature(non_ascii_idents)]\n+\n+// Some scripts (e.g., hiragana) don't have a concept of\n+// upper/lowercase\n+\n+// 2. non_snake_case\n+\n+// Can only use non-uppercase letters.\n+// So this works:\n+\n+fn \u7f16\u7a0b() {}\n+\n+// but this doesn't:\n+\n+fn \u0426() {}\n+//~^ ERROR function `\u0426` should have a snake case name\n+\n+// besides this, you cannot use continous underscores in the middle\n+\n+fn \u5206__\u9694() {}\n+//~^ ERROR function `\u5206__\u9694` should have a snake case name\n+\n+// but you can use them both at the beginning and at the end.\n+\n+fn _______\u4e0d_\u8fde_\u7eed_\u7684_\u5b58_\u5728_______() {}\n+\n+fn main() {}"}, {"sha": "0b309e315a4117dca42714e5fe5f8fa3b1d42f23", "filename": "src/test/ui/lint/lint-nonstandard-style-unicode-2.stderr", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/244dd2806d7e432be7220389c87e32c68a62b7c7/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/244dd2806d7e432be7220389c87e32c68a62b7c7/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-2.stderr?ref=244dd2806d7e432be7220389c87e32c68a62b7c7", "patch": "@@ -0,0 +1,20 @@\n+error: function `\u0426` should have a snake case name\n+  --> $DIR/lint-nonstandard-style-unicode-2.rs:18:4\n+   |\n+LL | fn \u0426() {}\n+   |    ^ help: convert the identifier to snake case: `\u0446`\n+   |\n+note: the lint level is defined here\n+  --> $DIR/lint-nonstandard-style-unicode-2.rs:3:11\n+   |\n+LL | #![forbid(non_snake_case)]\n+   |           ^^^^^^^^^^^^^^\n+\n+error: function `\u5206__\u9694` should have a snake case name\n+  --> $DIR/lint-nonstandard-style-unicode-2.rs:23:4\n+   |\n+LL | fn \u5206__\u9694() {}\n+   |    ^^^^^^ help: convert the identifier to snake case: `\u5206_\u9694`\n+\n+error: aborting due to 2 previous errors\n+"}, {"sha": "b17c2de39a0c0e7b1963d50e6580a4a8b4f9e8f5", "filename": "src/test/ui/lint/lint-nonstandard-style-unicode-3.rs", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/244dd2806d7e432be7220389c87e32c68a62b7c7/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/244dd2806d7e432be7220389c87e32c68a62b7c7/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-3.rs?ref=244dd2806d7e432be7220389c87e32c68a62b7c7", "patch": "@@ -0,0 +1,25 @@\n+#![allow(dead_code)]\n+\n+#![forbid(non_upper_case_globals)]\n+#![feature(non_ascii_idents)]\n+\n+// Some scripts (e.g., hiragana) don't have a concept of\n+// upper/lowercase\n+\n+// 3. non_upper_case_globals\n+\n+// Can only use non-lowercase letters.\n+// So this works:\n+\n+static \u30e9: usize = 0;\n+\n+// but this doesn't:\n+\n+static \u03c4\u03b5\u03c7: f32 = 3.14159265;\n+//~^ ERROR static variable `\u03c4\u03b5\u03c7` should have an upper case name\n+\n+// This has no limit at all on underscore usages.\n+\n+static __\u5bc6__\u5c01__\u7ebf__\u5185__\u7981__\u6b62__\u7b54__\u9898__: bool = true;\n+\n+fn main() {}"}, {"sha": "44bd5ad55ff5c8c702802d39a4a98bb69354eb89", "filename": "src/test/ui/lint/lint-nonstandard-style-unicode-3.stderr", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/244dd2806d7e432be7220389c87e32c68a62b7c7/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/244dd2806d7e432be7220389c87e32c68a62b7c7/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode-3.stderr?ref=244dd2806d7e432be7220389c87e32c68a62b7c7", "patch": "@@ -0,0 +1,14 @@\n+error: static variable `\u03c4\u03b5\u03c7` should have an upper case name\n+  --> $DIR/lint-nonstandard-style-unicode-3.rs:18:8\n+   |\n+LL | static \u03c4\u03b5\u03c7: f32 = 3.14159265;\n+   |        ^^^ help: convert the identifier to upper case: `\u03a4\u0395\u03a7`\n+   |\n+note: the lint level is defined here\n+  --> $DIR/lint-nonstandard-style-unicode-3.rs:3:11\n+   |\n+LL | #![forbid(non_upper_case_globals)]\n+   |           ^^^^^^^^^^^^^^^^^^^^^^\n+\n+error: aborting due to previous error\n+"}, {"sha": "9f16cb20fb32cf029024a160814a53e7fd0ecd6e", "filename": "src/test/ui/lint/lint-nonstandard-style-unicode.rs", "status": "removed", "additions": 0, "deletions": 16, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/5d429f384734a3245db8f7862e95b5adb2112705/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d429f384734a3245db8f7862e95b5adb2112705/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-nonstandard-style-unicode.rs?ref=5d429f384734a3245db8f7862e95b5adb2112705", "patch": "@@ -1,16 +0,0 @@\n-// check-pass\n-\n-#![allow(dead_code)]\n-\n-#![forbid(non_camel_case_types)]\n-#![forbid(non_upper_case_globals)]\n-#![feature(non_ascii_idents)]\n-\n-// Some scripts (e.g., hiragana) don't have a concept of\n-// upper/lowercase\n-\n-struct \u30d2;\n-\n-static \u30e9: usize = 0;\n-\n-pub fn main() {}"}]}