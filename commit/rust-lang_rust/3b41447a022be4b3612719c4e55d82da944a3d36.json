{"sha": "3b41447a022be4b3612719c4e55d82da944a3d36", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNiNDE0NDdhMDIyYmU0YjM2MTI3MTljNGU1NWQ4MmRhOTQ0YTNkMzY=", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2021-08-10T19:18:33Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-08-10T19:18:33Z"}, "message": "Rollup merge of #86840 - usbalbin:const_from, r=oli-obk\n\nConstify implementations of `(Try)From` for int types\n\nI believe this to be one of the (many?) things blocking const (Range) iterators.\n\n~~If this is to be merged maybe that should wait until `#![feature(const_trait_impl)]` no longer needs `#![allow(incomplete_features)]`?~~ - Done", "tree": {"sha": "4e45991a38184f8c085d7a2fea1e0746477b93fb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4e45991a38184f8c085d7a2fea1e0746477b93fb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3b41447a022be4b3612719c4e55d82da944a3d36", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhEtEJCRBK7hj4Ov3rIwAArtIIAJIudwcG9/ucUCGSp45wwL/T\n3n72i2WJ1yoBXcNVBwOcv5H+cUBR3Q9jxOus5uinERAufesg0v8MY619sNYn2upy\n0taLl1lMnnrh2Mu8KjCiZMh3bCc3e5xuU0GgceSBgqO7WsvSFjyoxlCw64bg4JR5\nrt88Uw2d4daA8qkdzJHcEjwbGtdqGDZGdaT+I76DQkdfrVZOo2F5bdKoEmNjh9w2\nNRmMfItty+7W7lj67ZRjw8cFRjKYZlLdxWHz/oH+DkmFPQvPLCv0DFvhvBkTE3n1\nO7NHcs56JVOJ6Nz2NeNUmJlxHHXRzAVvbkQjYZLWFBLQ9L5q6PAF4sj9KI0CIiI=\n=sbOd\n-----END PGP SIGNATURE-----\n", "payload": "tree 4e45991a38184f8c085d7a2fea1e0746477b93fb\nparent ae90dcf0207c57c3034f00b07048d63f8b2363c8\nparent c8bf5ed628c5007bd7c88a2265698d3117cbdc72\nauthor Yuki Okushi <jtitor@2k36.org> 1628623113 +0900\ncommitter GitHub <noreply@github.com> 1628623113 +0900\n\nRollup merge of #86840 - usbalbin:const_from, r=oli-obk\n\nConstify implementations of `(Try)From` for int types\n\nI believe this to be one of the (many?) things blocking const (Range) iterators.\n\n~~If this is to be merged maybe that should wait until `#![feature(const_trait_impl)]` no longer needs `#![allow(incomplete_features)]`?~~ - Done\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3b41447a022be4b3612719c4e55d82da944a3d36", "html_url": "https://github.com/rust-lang/rust/commit/3b41447a022be4b3612719c4e55d82da944a3d36", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3b41447a022be4b3612719c4e55d82da944a3d36/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ae90dcf0207c57c3034f00b07048d63f8b2363c8", "url": "https://api.github.com/repos/rust-lang/rust/commits/ae90dcf0207c57c3034f00b07048d63f8b2363c8", "html_url": "https://github.com/rust-lang/rust/commit/ae90dcf0207c57c3034f00b07048d63f8b2363c8"}, {"sha": "c8bf5ed628c5007bd7c88a2265698d3117cbdc72", "url": "https://api.github.com/repos/rust-lang/rust/commits/c8bf5ed628c5007bd7c88a2265698d3117cbdc72", "html_url": "https://github.com/rust-lang/rust/commit/c8bf5ed628c5007bd7c88a2265698d3117cbdc72"}], "stats": {"total": 45, "additions": 40, "deletions": 5}, "files": [{"sha": "75ef873abc965f40f2bf53258d1e4ab352de5565", "filename": "library/core/src/convert/num.rs", "status": "modified", "additions": 10, "deletions": 5, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/3b41447a022be4b3612719c4e55d82da944a3d36/library%2Fcore%2Fsrc%2Fconvert%2Fnum.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3b41447a022be4b3612719c4e55d82da944a3d36/library%2Fcore%2Fsrc%2Fconvert%2Fnum.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fconvert%2Fnum.rs?ref=3b41447a022be4b3612719c4e55d82da944a3d36", "patch": "@@ -45,7 +45,8 @@ impl_float_to_int!(f64 => u8 u16 u32 u64 u128 usize i8 i16 i32 i64 i128 isize);\n macro_rules! impl_from {\n     ($Small: ty, $Large: ty, #[$attr:meta], $doc: expr) => {\n         #[$attr]\n-        impl From<$Small> for $Large {\n+        #[rustc_const_unstable(feature = \"const_num_from_num\", issue = \"87852\")]\n+        impl const From<$Small> for $Large {\n             // Rustdocs on the impl block show a \"[+] show undocumented items\" toggle.\n             // Rustdocs on functions do not.\n             #[doc = $doc]\n@@ -172,7 +173,8 @@ impl_from! { f32, f64, #[stable(feature = \"lossless_float_conv\", since = \"1.6.0\"\n macro_rules! try_from_unbounded {\n     ($source:ty, $($target:ty),*) => {$(\n         #[stable(feature = \"try_from\", since = \"1.34.0\")]\n-        impl TryFrom<$source> for $target {\n+        #[rustc_const_unstable(feature = \"const_num_from_num\", issue = \"87852\")]\n+        impl const TryFrom<$source> for $target {\n             type Error = TryFromIntError;\n \n             /// Try to create the target number type from a source\n@@ -190,7 +192,8 @@ macro_rules! try_from_unbounded {\n macro_rules! try_from_lower_bounded {\n     ($source:ty, $($target:ty),*) => {$(\n         #[stable(feature = \"try_from\", since = \"1.34.0\")]\n-        impl TryFrom<$source> for $target {\n+        #[rustc_const_unstable(feature = \"const_num_from_num\", issue = \"87852\")]\n+        impl const TryFrom<$source> for $target {\n             type Error = TryFromIntError;\n \n             /// Try to create the target number type from a source\n@@ -212,7 +215,8 @@ macro_rules! try_from_lower_bounded {\n macro_rules! try_from_upper_bounded {\n     ($source:ty, $($target:ty),*) => {$(\n         #[stable(feature = \"try_from\", since = \"1.34.0\")]\n-        impl TryFrom<$source> for $target {\n+        #[rustc_const_unstable(feature = \"const_num_from_num\", issue = \"87852\")]\n+        impl const TryFrom<$source> for $target {\n             type Error = TryFromIntError;\n \n             /// Try to create the target number type from a source\n@@ -234,7 +238,8 @@ macro_rules! try_from_upper_bounded {\n macro_rules! try_from_both_bounded {\n     ($source:ty, $($target:ty),*) => {$(\n         #[stable(feature = \"try_from\", since = \"1.34.0\")]\n-        impl TryFrom<$source> for $target {\n+        #[rustc_const_unstable(feature = \"const_num_from_num\", issue = \"87852\")]\n+        impl const TryFrom<$source> for $target {\n             type Error = TryFromIntError;\n \n             /// Try to create the target number type from a source"}, {"sha": "37c3f8d4c16abfbe12370ead005d77639c839858", "filename": "library/core/src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/3b41447a022be4b3612719c4e55d82da944a3d36/library%2Fcore%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3b41447a022be4b3612719c4e55d82da944a3d36/library%2Fcore%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Flib.rs?ref=3b41447a022be4b3612719c4e55d82da944a3d36", "patch": "@@ -99,6 +99,7 @@\n #![feature(const_slice_from_raw_parts)]\n #![feature(const_slice_ptr_len)]\n #![feature(const_swap)]\n+#![feature(const_trait_impl)]\n #![feature(const_type_id)]\n #![feature(const_type_name)]\n #![feature(const_unreachable_unchecked)]"}, {"sha": "89eaa34a6717c2e01e93a178276719102d266396", "filename": "library/core/tests/lib.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3b41447a022be4b3612719c4e55d82da944a3d36/library%2Fcore%2Ftests%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3b41447a022be4b3612719c4e55d82da944a3d36/library%2Fcore%2Ftests%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Ftests%2Flib.rs?ref=3b41447a022be4b3612719c4e55d82da944a3d36", "patch": "@@ -13,6 +13,8 @@\n #![feature(const_ptr_read)]\n #![feature(const_ptr_write)]\n #![feature(const_ptr_offset)]\n+#![feature(const_trait_impl)]\n+#![feature(const_num_from_num)]\n #![feature(core_intrinsics)]\n #![feature(core_private_bignum)]\n #![feature(core_private_diy_float)]"}, {"sha": "aca18ef39de1ac456cfd262a12e956e922356b78", "filename": "library/core/tests/num/const_from.rs", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/3b41447a022be4b3612719c4e55d82da944a3d36/library%2Fcore%2Ftests%2Fnum%2Fconst_from.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3b41447a022be4b3612719c4e55d82da944a3d36/library%2Fcore%2Ftests%2Fnum%2Fconst_from.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Ftests%2Fnum%2Fconst_from.rs?ref=3b41447a022be4b3612719c4e55d82da944a3d36", "patch": "@@ -0,0 +1,25 @@\n+#[test]\n+fn from() {\n+    use core::convert::TryFrom;\n+    use core::num::TryFromIntError;\n+\n+    // From\n+    const FROM: i64 = i64::from(1i32);\n+    assert_eq!(FROM, 1i64);\n+\n+    // From int to float\n+    const FROM_F64: f64 = f64::from(42u8);\n+    assert_eq!(FROM_F64, 42f64);\n+\n+    // Upper bounded\n+    const U8_FROM_U16: Result<u8, TryFromIntError> = u8::try_from(1u16);\n+    assert_eq!(U8_FROM_U16, Ok(1u8));\n+\n+    // Both bounded\n+    const I8_FROM_I16: Result<i8, TryFromIntError> = i8::try_from(1i16);\n+    assert_eq!(I8_FROM_I16, Ok(1i8));\n+\n+    // Lower bounded\n+    const I16_FROM_U16: Result<i16, TryFromIntError> = i16::try_from(1u16);\n+    assert_eq!(I16_FROM_U16, Ok(1i16));\n+}"}, {"sha": "37b5e9127d5b0b0645e4a5dde48f80fc7d6ee515", "filename": "library/core/tests/num/mod.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3b41447a022be4b3612719c4e55d82da944a3d36/library%2Fcore%2Ftests%2Fnum%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3b41447a022be4b3612719c4e55d82da944a3d36/library%2Fcore%2Ftests%2Fnum%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Ftests%2Fnum%2Fmod.rs?ref=3b41447a022be4b3612719c4e55d82da944a3d36", "patch": "@@ -27,6 +27,8 @@ mod u64;\n mod u8;\n \n mod bignum;\n+\n+mod const_from;\n mod dec2flt;\n mod flt2dec;\n mod int_log;"}]}