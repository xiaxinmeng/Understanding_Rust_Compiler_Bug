{"sha": "ce216a55336d1e45f43ad5f0f1a9bf7e8a85b895", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNlMjE2YTU1MzM2ZDFlNDVmNDNhZDVmMGYxYTliZjdlOGE4NWI4OTU=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-03-23T00:42:53Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-03-29T21:42:30Z"}, "message": "rustc: Remove the session dependency from front::attr", "tree": {"sha": "3fb5e525dd7b1766e47ae829381b5200be75be40", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3fb5e525dd7b1766e47ae829381b5200be75be40"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ce216a55336d1e45f43ad5f0f1a9bf7e8a85b895", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ce216a55336d1e45f43ad5f0f1a9bf7e8a85b895", "html_url": "https://github.com/rust-lang/rust/commit/ce216a55336d1e45f43ad5f0f1a9bf7e8a85b895", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ce216a55336d1e45f43ad5f0f1a9bf7e8a85b895/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cb2840bcafcc4e4255c10c74a20ccdec33bb9b63", "url": "https://api.github.com/repos/rust-lang/rust/commits/cb2840bcafcc4e4255c10c74a20ccdec33bb9b63", "html_url": "https://github.com/rust-lang/rust/commit/cb2840bcafcc4e4255c10c74a20ccdec33bb9b63"}], "stats": {"total": 13, "additions": 7, "deletions": 6}, "files": [{"sha": "3ef65a44a1436b62a7c804f720f10dd44deeccc2", "filename": "src/rustc/back/link.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ce216a55336d1e45f43ad5f0f1a9bf7e8a85b895/src%2Frustc%2Fback%2Flink.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ce216a55336d1e45f43ad5f0f1a9bf7e8a85b895/src%2Frustc%2Fback%2Flink.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fback%2Flink.rs?ref=ce216a55336d1e45f43ad5f0f1a9bf7e8a85b895", "patch": "@@ -302,7 +302,7 @@ fn build_link_meta(sess: session, c: ast::crate, output: str,\n         let mut vers: option<str> = none;\n         let mut cmh_items: [@ast::meta_item] = [];\n         let linkage_metas = attr::find_linkage_metas(c.node.attrs);\n-        attr::require_unique_names(sess, linkage_metas);\n+        attr::require_unique_names(sess.diagnostic(), linkage_metas);\n         for meta: @ast::meta_item in linkage_metas {\n             if attr::get_meta_item_name(meta) == \"name\" {\n                 alt attr::get_meta_item_value_str(meta) {"}, {"sha": "cc41957a021de5d105435177d87a15b5afba4397", "filename": "src/rustc/front/attr.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/ce216a55336d1e45f43ad5f0f1a9bf7e8a85b895/src%2Frustc%2Ffront%2Fattr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ce216a55336d1e45f43ad5f0f1a9bf7e8a85b895/src%2Frustc%2Ffront%2Fattr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Ffront%2Fattr.rs?ref=ce216a55336d1e45f43ad5f0f1a9bf7e8a85b895", "patch": "@@ -4,7 +4,7 @@ import std::map;\n import std::map::hashmap;\n import either::either;\n import syntax::{ast, ast_util};\n-import driver::session::session;\n+import driver::diagnostic::span_handler;\n \n export attr_meta;\n export attr_metas;\n@@ -220,13 +220,14 @@ fn remove_meta_items_by_name(items: [@ast::meta_item], name: str) ->\n     ret vec::filter_map(items, filter);\n }\n \n-fn require_unique_names(sess: session, metas: [@ast::meta_item]) {\n+fn require_unique_names(diagnostic: span_handler,\n+                        metas: [@ast::meta_item]) {\n     let map = map::str_hash();\n     for meta: @ast::meta_item in metas {\n         let name = get_meta_item_name(meta);\n         if map.contains_key(name) {\n-            sess.span_fatal(meta.span,\n-                            #fmt[\"duplicate meta item `%s`\", name]);\n+            diagnostic.span_fatal(meta.span,\n+                                  #fmt[\"duplicate meta item `%s`\", name]);\n         }\n         map.insert(name, ());\n     }"}, {"sha": "5d8cf74d2f8c072754bf27c51c09021d63cb3201", "filename": "src/rustc/metadata/creader.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ce216a55336d1e45f43ad5f0f1a9bf7e8a85b895/src%2Frustc%2Fmetadata%2Fcreader.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ce216a55336d1e45f43ad5f0f1a9bf7e8a85b895/src%2Frustc%2Fmetadata%2Fcreader.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fmetadata%2Fcreader.rs?ref=ce216a55336d1e45f43ad5f0f1a9bf7e8a85b895", "patch": "@@ -137,7 +137,7 @@ fn find_library_crate(sess: session::session, ident: ast::ident,\n                       metas: [@ast::meta_item])\n    -> option<{ident: str, data: @[u8]}> {\n \n-    attr::require_unique_names(sess, metas);\n+    attr::require_unique_names(sess.diagnostic(), metas);\n     let metas = metas;\n \n     let crate_name ="}]}