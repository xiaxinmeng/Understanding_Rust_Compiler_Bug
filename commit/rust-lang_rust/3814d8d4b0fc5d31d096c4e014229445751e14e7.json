{"sha": "3814d8d4b0fc5d31d096c4e014229445751e14e7", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM4MTRkOGQ0YjBmYzVkMzFkMDk2YzRlMDE0MjI5NDQ1NzUxZTE0ZTc=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-08-12T03:47:35Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-08-12T19:08:28Z"}, "message": "Convert run-pass/vec-append to ivecs", "tree": {"sha": "dc74bee3338c2d620b0295dffe1320125464f677", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/dc74bee3338c2d620b0295dffe1320125464f677"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3814d8d4b0fc5d31d096c4e014229445751e14e7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3814d8d4b0fc5d31d096c4e014229445751e14e7", "html_url": "https://github.com/rust-lang/rust/commit/3814d8d4b0fc5d31d096c4e014229445751e14e7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3814d8d4b0fc5d31d096c4e014229445751e14e7/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c06d95f1788f7c3b708f0be1fc452c35abf03841", "url": "https://api.github.com/repos/rust-lang/rust/commits/c06d95f1788f7c3b708f0be1fc452c35abf03841", "html_url": "https://github.com/rust-lang/rust/commit/c06d95f1788f7c3b708f0be1fc452c35abf03841"}], "stats": {"total": 34, "additions": 14, "deletions": 20}, "files": [{"sha": "99ed77af47fda4e6c531a3ae68ec1c42caadc2e8", "filename": "src/test/run-pass/vec-append.rs", "status": "modified", "additions": 14, "deletions": 20, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/3814d8d4b0fc5d31d096c4e014229445751e14e7/src%2Ftest%2Frun-pass%2Fvec-append.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3814d8d4b0fc5d31d096c4e014229445751e14e7/src%2Ftest%2Frun-pass%2Fvec-append.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fvec-append.rs?ref=3814d8d4b0fc5d31d096c4e014229445751e14e7", "patch": "@@ -3,34 +3,33 @@\n // -*- rust -*-\n use std;\n import std::str;\n-import std::vec;\n-\n+import std::ivec;\n \n // FIXME: import std::dbg::const_refcount. Currently\n // cross-crate const references don't work.\n const const_refcount: uint = 0x7bad_face_u;\n \n fn fast_growth() {\n-    let v: vec[int] = [1, 2, 3, 4, 5];\n-    v += [6, 7, 8, 9, 0];\n+    let v: [int] = ~[1, 2, 3, 4, 5];\n+    v += ~[6, 7, 8, 9, 0];\n     log v.(9);\n     assert (v.(0) == 1);\n     assert (v.(7) == 8);\n     assert (v.(9) == 0);\n }\n \n fn slow_growth() {\n-    let v: vec[int] = [];\n-    let u: vec[int] = v;\n-    v += [17];\n+    let v: [int] = ~[];\n+    let u: [int] = v;\n+    v += ~[17];\n     log v.(0);\n     assert (v.(0) == 17);\n }\n \n fn slow_growth2_helper(s: str) { // ref up: s\n \n-    obj acc(mutable v: vec[str]) {\n-        fn add(s: &str) { v += [s]; }\n+    obj acc(mutable v: [str]) {\n+        fn add(s: &str) { v += ~[s]; }\n     }\n     let ss: str = s; // ref up: s\n \n@@ -47,26 +46,21 @@ fn slow_growth2_helper(s: str) { // ref up: s\n          * mumble, the existing str in the originally- shared vec.\n          */\n \n-        let v: vec[str] = [mumble]; // ref up: v, mumble\n+        let v: [str] = ~[mumble]; // ref up: mumble\n \n-        log vec::refcount[str](v);\n-        let a: acc = acc(v); // ref up: a, v\n+        let a: acc = acc(v);\n \n-        log vec::refcount[str](v);\n-        assert (vec::refcount[str](v) == 2u);\n-        a.add(s); // ref up: mumble, s.  ref down: v\n+        a.add(s); // ref up: mumble, s\n \n-        log vec::refcount[str](v);\n         log str::refcount(s);\n         log str::refcount(mumble);\n-        assert (vec::refcount[str](v) == 1u);\n         assert (str::refcount(s) == const_refcount);\n         assert (str::refcount(mumble) == const_refcount);\n         log v.(0);\n-        log vec::len[str](v);\n+        log ivec::len[str](v);\n         assert (str::eq(v.(0), mumble));\n-        assert (vec::len[str](v) == 1u);\n-    } // ref down: a, mumble, s, v\n+        assert (ivec::len[str](v) == 1u);\n+    } // ref down: mumble, s,\n \n     log str::refcount(s);\n     log str::refcount(mumble);"}]}