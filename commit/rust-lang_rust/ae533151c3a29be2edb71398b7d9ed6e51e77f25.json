{"sha": "ae533151c3a29be2edb71398b7d9ed6e51e77f25", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFlNTMzMTUxYzNhMjliZTJlZGI3MTM5OGI3ZDllZDZlNTFlNzdmMjU=", "commit": {"author": {"name": "Jonas Schievink", "email": "jonasschievink@gmail.com", "date": "2020-03-25T21:07:41Z"}, "committer": {"name": "Jonas Schievink", "email": "jonasschievink@gmail.com", "date": "2020-04-17T18:37:34Z"}, "message": "Ignore generator-drop-cleanup on wasm32-bare", "tree": {"sha": "9cc2f89cedcc877e6293d51bbec3648037cef37a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9cc2f89cedcc877e6293d51bbec3648037cef37a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ae533151c3a29be2edb71398b7d9ed6e51e77f25", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ae533151c3a29be2edb71398b7d9ed6e51e77f25", "html_url": "https://github.com/rust-lang/rust/commit/ae533151c3a29be2edb71398b7d9ed6e51e77f25", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ae533151c3a29be2edb71398b7d9ed6e51e77f25/comments", "author": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7bbdd2d4d662a39229ada01eacbf3a1c808b64e2", "url": "https://api.github.com/repos/rust-lang/rust/commits/7bbdd2d4d662a39229ada01eacbf3a1c808b64e2", "html_url": "https://github.com/rust-lang/rust/commit/7bbdd2d4d662a39229ada01eacbf3a1c808b64e2"}], "stats": {"total": 64, "additions": 33, "deletions": 31}, "files": [{"sha": "3e9707c6491f61b480c84cf2c9d0317e40c0cf91", "filename": "src/test/mir-opt/generator-drop-cleanup.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ae533151c3a29be2edb71398b7d9ed6e51e77f25/src%2Ftest%2Fmir-opt%2Fgenerator-drop-cleanup.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ae533151c3a29be2edb71398b7d9ed6e51e77f25/src%2Ftest%2Fmir-opt%2Fgenerator-drop-cleanup.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Fgenerator-drop-cleanup.rs?ref=ae533151c3a29be2edb71398b7d9ed6e51e77f25", "patch": "@@ -1,5 +1,7 @@\n #![feature(generators, generator_trait)]\n \n+// ignore-wasm32-bare compiled with panic=abort by default\n+\n // Regression test for #58892, generator drop shims should not have blocks\n // spuriously marked as cleanup\n "}, {"sha": "887a4dd2cd38383869ad9828bba618c441280ef8", "filename": "src/test/mir-opt/generator-drop-cleanup/rustc.main-{{closure}}.generator_drop.0.mir", "status": "modified", "additions": 31, "deletions": 31, "changes": 62, "blob_url": "https://github.com/rust-lang/rust/blob/ae533151c3a29be2edb71398b7d9ed6e51e77f25/src%2Ftest%2Fmir-opt%2Fgenerator-drop-cleanup%2Frustc.main-%7B%7Bclosure%7D%7D.generator_drop.0.mir", "raw_url": "https://github.com/rust-lang/rust/raw/ae533151c3a29be2edb71398b7d9ed6e51e77f25/src%2Ftest%2Fmir-opt%2Fgenerator-drop-cleanup%2Frustc.main-%7B%7Bclosure%7D%7D.generator_drop.0.mir", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Fgenerator-drop-cleanup%2Frustc.main-%7B%7Bclosure%7D%7D.generator_drop.0.mir?ref=ae533151c3a29be2edb71398b7d9ed6e51e77f25", "patch": "@@ -1,80 +1,80 @@\n // MIR for `main::{{closure}}#0` 0 generator_drop\n // generator_layout = GeneratorLayout { field_tys: [std::string::String], variant_fields: [[], [], [], [_0]], storage_conflicts: BitMatrix { num_rows: 1, num_columns: 1, words: [1], marker: PhantomData } }\n \n-fn main::{{closure}}#0(_1: *mut [generator@$DIR/generator-drop-cleanup.rs:8:15: 11:6 {std::string::String, ()}]) -> () {\n-    let mut _0: ();                      // return place in scope 0 at $DIR/generator-drop-cleanup.rs:8:15: 11:6\n-    let mut _2: ();                      // in scope 0 at $DIR/generator-drop-cleanup.rs:8:15: 11:6\n-    let _3: std::string::String;         // in scope 0 at $DIR/generator-drop-cleanup.rs:9:13: 9:15\n-    let _4: ();                          // in scope 0 at $DIR/generator-drop-cleanup.rs:10:9: 10:14\n-    let mut _5: ();                      // in scope 0 at $DIR/generator-drop-cleanup.rs:10:9: 10:14\n-    let mut _7: ();                      // in scope 0 at $DIR/generator-drop-cleanup.rs:8:18: 8:18\n-    let mut _8: ();                      // in scope 0 at $DIR/generator-drop-cleanup.rs:8:15: 11:6\n-    let mut _9: isize;                   // in scope 0 at $DIR/generator-drop-cleanup.rs:8:15: 11:6\n+fn main::{{closure}}#0(_1: *mut [generator@$DIR/generator-drop-cleanup.rs:10:15: 13:6 {std::string::String, ()}]) -> () {\n+    let mut _0: ();                      // return place in scope 0 at $DIR/generator-drop-cleanup.rs:10:15: 13:6\n+    let mut _2: ();                      // in scope 0 at $DIR/generator-drop-cleanup.rs:10:15: 13:6\n+    let _3: std::string::String;         // in scope 0 at $DIR/generator-drop-cleanup.rs:11:13: 11:15\n+    let _4: ();                          // in scope 0 at $DIR/generator-drop-cleanup.rs:12:9: 12:14\n+    let mut _5: ();                      // in scope 0 at $DIR/generator-drop-cleanup.rs:12:9: 12:14\n+    let mut _7: ();                      // in scope 0 at $DIR/generator-drop-cleanup.rs:10:18: 10:18\n+    let mut _8: ();                      // in scope 0 at $DIR/generator-drop-cleanup.rs:10:15: 13:6\n+    let mut _9: isize;                   // in scope 0 at $DIR/generator-drop-cleanup.rs:10:15: 13:6\n     scope 1 {\n-        debug _s => (((*_1) as variant#3).0: std::string::String); // in scope 1 at $DIR/generator-drop-cleanup.rs:9:13: 9:15\n+        debug _s => (((*_1) as variant#3).0: std::string::String); // in scope 1 at $DIR/generator-drop-cleanup.rs:11:13: 11:15\n     }\n     scope 2 {\n-        let mut _6: std::vec::Vec<u8>;   // in scope 2 at $DIR/generator-drop-cleanup.rs:9:18: 9:31\n+        let mut _6: std::vec::Vec<u8>;   // in scope 2 at $DIR/generator-drop-cleanup.rs:11:18: 11:31\n         scope 3 {\n         }\n     }\n \n     bb0: {\n-        _9 = discriminant((*_1));        // bb0[0]: scope 0 at $DIR/generator-drop-cleanup.rs:8:15: 11:6\n-        switchInt(move _9) -> [0u32: bb7, 3u32: bb11, otherwise: bb12]; // bb0[1]: scope 0 at $DIR/generator-drop-cleanup.rs:8:15: 11:6\n+        _9 = discriminant((*_1));        // bb0[0]: scope 0 at $DIR/generator-drop-cleanup.rs:10:15: 13:6\n+        switchInt(move _9) -> [0u32: bb7, 3u32: bb11, otherwise: bb12]; // bb0[1]: scope 0 at $DIR/generator-drop-cleanup.rs:10:15: 13:6\n     }\n \n     bb1 (cleanup): {\n-        resume;                          // bb1[0]: scope 0 at $DIR/generator-drop-cleanup.rs:8:15: 11:6\n+        resume;                          // bb1[0]: scope 0 at $DIR/generator-drop-cleanup.rs:10:15: 13:6\n     }\n \n     bb2 (cleanup): {\n-        nop;                             // bb2[0]: scope 0 at $DIR/generator-drop-cleanup.rs:11:5: 11:6\n-        goto -> bb8;                     // bb2[1]: scope 0 at $DIR/generator-drop-cleanup.rs:11:5: 11:6\n+        nop;                             // bb2[0]: scope 0 at $DIR/generator-drop-cleanup.rs:13:5: 13:6\n+        goto -> bb8;                     // bb2[1]: scope 0 at $DIR/generator-drop-cleanup.rs:13:5: 13:6\n     }\n \n     bb3: {\n-        StorageDead(_5);                 // bb3[0]: scope 1 at $DIR/generator-drop-cleanup.rs:10:13: 10:14\n-        StorageDead(_4);                 // bb3[1]: scope 1 at $DIR/generator-drop-cleanup.rs:10:14: 10:15\n-        drop((((*_1) as variant#3).0: std::string::String)) -> [return: bb4, unwind: bb2]; // bb3[2]: scope 0 at $DIR/generator-drop-cleanup.rs:11:5: 11:6\n+        StorageDead(_5);                 // bb3[0]: scope 1 at $DIR/generator-drop-cleanup.rs:12:13: 12:14\n+        StorageDead(_4);                 // bb3[1]: scope 1 at $DIR/generator-drop-cleanup.rs:12:14: 12:15\n+        drop((((*_1) as variant#3).0: std::string::String)) -> [return: bb4, unwind: bb2]; // bb3[2]: scope 0 at $DIR/generator-drop-cleanup.rs:13:5: 13:6\n     }\n \n     bb4: {\n-        nop;                             // bb4[0]: scope 0 at $DIR/generator-drop-cleanup.rs:11:5: 11:6\n-        goto -> bb9;                     // bb4[1]: scope 0 at $DIR/generator-drop-cleanup.rs:11:5: 11:6\n+        nop;                             // bb4[0]: scope 0 at $DIR/generator-drop-cleanup.rs:13:5: 13:6\n+        goto -> bb9;                     // bb4[1]: scope 0 at $DIR/generator-drop-cleanup.rs:13:5: 13:6\n     }\n \n     bb5: {\n-        return;                          // bb5[0]: scope 0 at $DIR/generator-drop-cleanup.rs:8:15: 11:6\n+        return;                          // bb5[0]: scope 0 at $DIR/generator-drop-cleanup.rs:10:15: 13:6\n     }\n \n     bb6: {\n-        return;                          // bb6[0]: scope 0 at $DIR/generator-drop-cleanup.rs:8:15: 11:6\n+        return;                          // bb6[0]: scope 0 at $DIR/generator-drop-cleanup.rs:10:15: 13:6\n     }\n \n     bb7: {\n-        goto -> bb10;                    // bb7[0]: scope 0 at $DIR/generator-drop-cleanup.rs:8:15: 11:6\n+        goto -> bb10;                    // bb7[0]: scope 0 at $DIR/generator-drop-cleanup.rs:10:15: 13:6\n     }\n \n     bb8 (cleanup): {\n-        goto -> bb1;                     // bb8[0]: scope 0 at $DIR/generator-drop-cleanup.rs:11:5: 11:6\n+        goto -> bb1;                     // bb8[0]: scope 0 at $DIR/generator-drop-cleanup.rs:13:5: 13:6\n     }\n \n     bb9: {\n-        goto -> bb5;                     // bb9[0]: scope 0 at $DIR/generator-drop-cleanup.rs:11:5: 11:6\n+        goto -> bb5;                     // bb9[0]: scope 0 at $DIR/generator-drop-cleanup.rs:13:5: 13:6\n     }\n \n     bb10: {\n-        goto -> bb6;                     // bb10[0]: scope 0 at $DIR/generator-drop-cleanup.rs:8:15: 11:6\n+        goto -> bb6;                     // bb10[0]: scope 0 at $DIR/generator-drop-cleanup.rs:10:15: 13:6\n     }\n \n     bb11: {\n-        StorageLive(_4);                 // bb11[0]: scope 0 at $DIR/generator-drop-cleanup.rs:8:15: 11:6\n-        StorageLive(_5);                 // bb11[1]: scope 0 at $DIR/generator-drop-cleanup.rs:8:15: 11:6\n-        goto -> bb3;                     // bb11[2]: scope 0 at $DIR/generator-drop-cleanup.rs:8:15: 11:6\n+        StorageLive(_4);                 // bb11[0]: scope 0 at $DIR/generator-drop-cleanup.rs:10:15: 13:6\n+        StorageLive(_5);                 // bb11[1]: scope 0 at $DIR/generator-drop-cleanup.rs:10:15: 13:6\n+        goto -> bb3;                     // bb11[2]: scope 0 at $DIR/generator-drop-cleanup.rs:10:15: 13:6\n     }\n \n     bb12: {\n-        return;                          // bb12[0]: scope 0 at $DIR/generator-drop-cleanup.rs:8:15: 11:6\n+        return;                          // bb12[0]: scope 0 at $DIR/generator-drop-cleanup.rs:10:15: 13:6\n     }\n }"}]}