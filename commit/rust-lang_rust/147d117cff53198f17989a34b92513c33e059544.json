{"sha": "147d117cff53198f17989a34b92513c33e059544", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE0N2QxMTdjZmY1MzE5OGYxNzk4OWEzNGI5MjUxM2MzM2UwNTk1NDQ=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-08-02T20:06:11Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-08-02T20:06:11Z"}, "message": "auto merge of #16169 : Gankro/rust/simple-docs, r=cmr\n\n<strike>Adds a simple/detailed toggle to api doc pages.\r\nDetailed mode is the current behaviour, simple mode hides all doccomment details leaving only signatures for quick browsing.\r\n</strike>\r\nAdds [expand all] and [collapse all] \"links\" to all api doc pages. All doccomments are collapsed, leaving only signatures for quick browsing.\r\n\r\nIn addition, clicking on a <strike>function name</strike> function's [toggle details] link now toggles the visibility of the associated doccomment.\r\n\r\n--------\r\n\r\n# [Live Build Here](http://cg.scs.carleton.ca/~abeinges/doc/std/vec/struct.Vec.html)\r\n\r\nThis is something that's been bothering me, and I've seen some people mention in IRC before. The docs are *great* if you want a full in-depth look at an API, but *awful* if you want to scan them. This provides the ability to toggle complexity freely. Interacts perfectly well with noscript, since the static page is effectively unchanged. Collapsing is just hiding divs with css.\r\n\r\nI'm not much of a designer, so design input welcome on the actual UX for toggling.\r\n\r\nThe actual javascript is *a bit* brittle to layout changes, but it always will be without adding lots of extra junk to the actual markup, which didn't seem worth it.", "tree": {"sha": "b59b110df008569024f8c0cdbea998c9ef7d9d55", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b59b110df008569024f8c0cdbea998c9ef7d9d55"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/147d117cff53198f17989a34b92513c33e059544", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/147d117cff53198f17989a34b92513c33e059544", "html_url": "https://github.com/rust-lang/rust/commit/147d117cff53198f17989a34b92513c33e059544", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/147d117cff53198f17989a34b92513c33e059544/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "432042ac149804c8d6b59b8cdf537ce39493796c", "url": "https://api.github.com/repos/rust-lang/rust/commits/432042ac149804c8d6b59b8cdf537ce39493796c", "html_url": "https://github.com/rust-lang/rust/commit/432042ac149804c8d6b59b8cdf537ce39493796c"}, {"sha": "88fe6dfa31a1bee49090dc72c537c5cd7bd632f4", "url": "https://api.github.com/repos/rust-lang/rust/commits/88fe6dfa31a1bee49090dc72c537c5cd7bd632f4", "html_url": "https://github.com/rust-lang/rust/commit/88fe6dfa31a1bee49090dc72c537c5cd7bd632f4"}], "stats": {"total": 99, "additions": 96, "deletions": 3}, "files": [{"sha": "9a2031dc447bdabd77fae80ac2da1522a8b94913", "filename": "src/librustdoc/html/render.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/147d117cff53198f17989a34b92513c33e059544/src%2Flibrustdoc%2Fhtml%2Frender.rs", "raw_url": "https://github.com/rust-lang/rust/raw/147d117cff53198f17989a34b92513c33e059544/src%2Flibrustdoc%2Fhtml%2Frender.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender.rs?ref=147d117cff53198f17989a34b92513c33e059544", "patch": "@@ -1316,6 +1316,12 @@ impl<'a> fmt::Show for Item<'a> {\n             _ => {}\n         };\n \n+        try!(write!(fmt,\n+        r##\"<span id='render-detail'>\n+            <a id=\"collapse-all\" href=\"#\">[collapse all]</a>\n+            <a id=\"expand-all\" href=\"#\">[expand all]</a>\n+        </span>\"##));\n+\n         // Write `src` tag\n         //\n         // When this item is part of a `pub use` in a downstream crate, the"}, {"sha": "64a0665d4008b686ee8c0dac3bb5da0de975d951", "filename": "src/librustdoc/html/static/main.css", "status": "modified", "additions": 39, "deletions": 3, "changes": 42, "blob_url": "https://github.com/rust-lang/rust/blob/147d117cff53198f17989a34b92513c33e059544/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.css", "raw_url": "https://github.com/rust-lang/rust/raw/147d117cff53198f17989a34b92513c33e059544/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.css?ref=147d117cff53198f17989a34b92513c33e059544", "patch": "@@ -101,7 +101,7 @@ h3.impl, h3.method, h4.method {\n h3.impl, h3.method {\n     margin-top: 15px;\n }\n-h1, h2, h3, h4, section.sidebar, a.source, .search-input, .content table a {\n+h1, h2, h3, h4, section.sidebar, a.source, .search-input, .content table a, .collapse-toggle {\n     font-family: \"Fira Sans\", \"Helvetica Neue\", Helvetica, Arial, sans-serif;\n }\n \n@@ -277,7 +277,10 @@ nav.sub {\n }\n .content .multi-column li { width: 100%; display: inline-block; }\n \n-.content .method { font-size: 1em; }\n+.content .method { \n+    font-size: 1em; \n+    position: relative;\n+}\n .content .methods .docblock { margin-left: 40px; }\n \n .content .impl-methods .docblock { margin-left: 40px; }\n@@ -405,7 +408,7 @@ h1 .stability {\n     padding: 4px 10px;\n }\n \n-.impl-methods .stability {\n+.impl-methods .stability, .methods .stability {\n     margin-right: 20px;\n }\n \n@@ -477,3 +480,36 @@ pre.rust { position: relative; }\n         margin: 0 auto;\n     }\n }\n+\n+.collapse-toggle {\n+    font-weight: 100;\n+    position: absolute;\n+    left: 13px;\n+    color: #999;\n+    margin-top: 2px;\n+}\n+\n+.toggle-wrapper > .collapse-toggle {\n+    left: -24px;\n+    margin-top: 0px;\n+}\n+\n+.toggle-wrapper {\n+    position: relative;\n+}\n+\n+.toggle-wrapper.collapsed {\n+    height: 1em;\n+    transition: height .2s;\n+}\n+\n+.collapse-toggle > .inner {\n+    display: inline-block;\n+    width: 1ch;\n+    text-align: center;\n+}\n+\n+.toggle-label {\n+    color: #999;\n+    font-style: italic;\n+}"}, {"sha": "9b44dc63f383b889f1a6b095ca1d661276f90432", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 51, "deletions": 0, "changes": 51, "blob_url": "https://github.com/rust-lang/rust/blob/147d117cff53198f17989a34b92513c33e059544/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/147d117cff53198f17989a34b92513c33e059544/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=147d117cff53198f17989a34b92513c33e059544", "patch": "@@ -730,4 +730,55 @@\n     if (query['gotosrc']) {\n         window.location = $('#src-' + query['gotosrc']).attr('href');\n     }\n+\n+    $(\"#expand-all\").on(\"click\", function() {\n+        $(\".docblock\").show();\n+        $(\".toggle-label\").hide();\n+        $(\".toggle-wrapper\").removeClass(\"collapsed\");\n+        $(\".collapse-toggle\").children(\".inner\").html(\"-\");\n+    });\n+\n+    $(\"#collapse-all\").on(\"click\", function() {\n+        $(\".docblock\").hide();\n+        $(\".toggle-label\").show();\n+        $(\".toggle-wrapper\").addClass(\"collapsed\");\n+        $(\".collapse-toggle\").children(\".inner\").html(\"+\");\n+    });\n+\n+    $(document).on(\"click\", \".collapse-toggle\", function() {\n+        var toggle = $(this);\n+        var relatedDoc = toggle.parent().next();\n+        if (relatedDoc.is(\".docblock\")) {\n+            if (relatedDoc.is(\":visible\")) {\n+                relatedDoc.slideUp({duration:'fast', easing:'linear'});\n+                toggle.parent(\".toggle-wrapper\").addClass(\"collapsed\");\n+                toggle.children(\".inner\").html(\"+\");\n+                toggle.children(\".toggle-label\").fadeIn();\n+            } else {\n+                relatedDoc.slideDown({duration:'fast', easing:'linear'});\n+                toggle.parent(\".toggle-wrapper\").removeClass(\"collapsed\");\n+                toggle.children(\".inner\").html(\"-\");\n+                toggle.children(\".toggle-label\").hide();\n+            }\n+        }\n+    });\n+\n+    $(function() {\n+        var toggle = \"<a href='javascript:void(0)'\"\n+            + \"class='collapse-toggle'>[<span class='inner'>-</span>]</a>\";\n+\n+        $(\".method\").each(function() {\n+           if ($(this).next().is(\".docblock\")) {\n+               $(this).children().first().after(toggle);\n+           }\n+        });\n+\n+        var mainToggle = $(toggle);\n+        mainToggle.append(\"<span class='toggle-label' style='display:none'>\"\n+            + \"&nbsp;Expand&nbsp;description</span></a>\")\n+        var wrapper =  $(\"<div class='toggle-wrapper'>\");\n+        wrapper.append(mainToggle);\n+        $(\"#main > .docblock\").before(wrapper);\n+    });\n+\n }());"}]}