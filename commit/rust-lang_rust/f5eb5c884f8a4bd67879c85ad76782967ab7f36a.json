{"sha": "f5eb5c884f8a4bd67879c85ad76782967ab7f36a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY1ZWI1Yzg4NGY4YTRiZDY3ODc5Yzg1YWQ3Njc4Mjk2N2FiN2YzNmE=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2021-03-04T22:19:41Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2021-03-04T22:19:41Z"}, "message": "Make rustc shim's verbose output include crate_name being compiled.\n\nThis change is mainly motivated by an issue with the environment\nprinting I added in PR 82403: multiple rustc invocations progress\nin parallel, and the environment output, spanning multiple lines,\ngets interleaved in ways make it difficult to extra the enviroment settings.\n\n(This aforementioned difficulty is more of a hiccup than an outright\nshow-stopper, because the environment variables tend to be the same for all of\nthe rustc invocations, so it doesn't matter too much if one mixes up which lines\none is looking at. But still: Better to fix it.)", "tree": {"sha": "90a4a31ebdd3acd184e7cda3038c3ff5f3aff5d0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/90a4a31ebdd3acd184e7cda3038c3ff5f3aff5d0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f5eb5c884f8a4bd67879c85ad76782967ab7f36a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f5eb5c884f8a4bd67879c85ad76782967ab7f36a", "html_url": "https://github.com/rust-lang/rust/commit/f5eb5c884f8a4bd67879c85ad76782967ab7f36a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f5eb5c884f8a4bd67879c85ad76782967ab7f36a/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "409920873cf8a95739a55dc5fe5adb05e1b4758e", "url": "https://api.github.com/repos/rust-lang/rust/commits/409920873cf8a95739a55dc5fe5adb05e1b4758e", "html_url": "https://github.com/rust-lang/rust/commit/409920873cf8a95739a55dc5fe5adb05e1b4758e"}], "stats": {"total": 15, "additions": 10, "deletions": 5}, "files": [{"sha": "1bd36e25c02044c1bb5d66e0f1c1c6c66341da94", "filename": "src/bootstrap/bin/rustc.rs", "status": "modified", "additions": 10, "deletions": 5, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/f5eb5c884f8a4bd67879c85ad76782967ab7f36a/src%2Fbootstrap%2Fbin%2Frustc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f5eb5c884f8a4bd67879c85ad76782967ab7f36a/src%2Fbootstrap%2Fbin%2Frustc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbin%2Frustc.rs?ref=f5eb5c884f8a4bd67879c85ad76782967ab7f36a", "patch": "@@ -141,18 +141,23 @@ fn main() {\n     if verbose > 1 {\n         let rust_env_vars =\n             env::vars().filter(|(k, _)| k.starts_with(\"RUST\") || k.starts_with(\"CARGO\"));\n+        let prefix = match crate_name {\n+            Some(crate_name) => format!(\"rustc {}\", crate_name),\n+            None => \"rustc\".to_string(),\n+        };\n         for (i, (k, v)) in rust_env_vars.enumerate() {\n-            eprintln!(\"rustc env[{}]: {:?}={:?}\", i, k, v);\n+            eprintln!(\"{} env[{}]: {:?}={:?}\", prefix, i, k, v);\n         }\n-        eprintln!(\"rustc working directory: {}\", env::current_dir().unwrap().display());\n+        eprintln!(\"{} working directory: {}\", prefix, env::current_dir().unwrap().display());\n         eprintln!(\n-            \"rustc command: {:?}={:?} {:?}\",\n+            \"{} command: {:?}={:?} {:?}\",\n+            prefix,\n             bootstrap::util::dylib_path_var(),\n             env::join_paths(&dylib_path).unwrap(),\n             cmd,\n         );\n-        eprintln!(\"sysroot: {:?}\", sysroot);\n-        eprintln!(\"libdir: {:?}\", libdir);\n+        eprintln!(\"{} sysroot: {:?}\", prefix, sysroot);\n+        eprintln!(\"{} libdir: {:?}\", prefix, libdir);\n     }\n \n     let start = Instant::now();"}]}