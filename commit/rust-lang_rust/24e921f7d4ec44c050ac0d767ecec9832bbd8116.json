{"sha": "24e921f7d4ec44c050ac0d767ecec9832bbd8116", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI0ZTkyMWY3ZDRlYzQ0YzA1MGFjMGQ3NjdlY2VjOTgzMmJiZDgxMTY=", "commit": {"author": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2012-04-09T22:55:02Z"}, "committer": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2012-04-09T23:36:59Z"}, "message": "make anything used in a resource body always reachable\n(they appear to be uncond. inlined)\n\nFixes #2170.", "tree": {"sha": "959f8afef81d1d71c1de935e3cf6fa6d0869ecd9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/959f8afef81d1d71c1de935e3cf6fa6d0869ecd9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/24e921f7d4ec44c050ac0d767ecec9832bbd8116", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/24e921f7d4ec44c050ac0d767ecec9832bbd8116", "html_url": "https://github.com/rust-lang/rust/commit/24e921f7d4ec44c050ac0d767ecec9832bbd8116", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/24e921f7d4ec44c050ac0d767ecec9832bbd8116/comments", "author": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "564d8e09c725ccd773e27e6d0edc8fa0a163bf6d", "url": "https://api.github.com/repos/rust-lang/rust/commits/564d8e09c725ccd773e27e6d0edc8fa0a163bf6d", "html_url": "https://github.com/rust-lang/rust/commit/564d8e09c725ccd773e27e6d0edc8fa0a163bf6d"}], "stats": {"total": 21, "additions": 20, "deletions": 1}, "files": [{"sha": "3a462ff7392717142261647193d30daf9ac8776d", "filename": "src/rustc/middle/trans/reachable.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/24e921f7d4ec44c050ac0d767ecec9832bbd8116/src%2Frustc%2Fmiddle%2Ftrans%2Freachable.rs", "raw_url": "https://github.com/rust-lang/rust/raw/24e921f7d4ec44c050ac0d767ecec9832bbd8116/src%2Frustc%2Fmiddle%2Ftrans%2Freachable.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fmiddle%2Ftrans%2Freachable.rs?ref=24e921f7d4ec44c050ac0d767ecec9832bbd8116", "patch": "@@ -84,7 +84,11 @@ fn traverse_public_item(cx: ctx, item: @item) {\n               for vec::each(nm.items) {|item| cx.rmap.insert(item.id, ()); }\n           }\n       }\n-      item_res(_, tps, blk, _, _) | item_fn(_, tps, blk) {\n+      item_res(_, tps, blk, _, _) {\n+        // resources seem to be unconditionally inlined\n+        traverse_inline_body(cx, blk);\n+      }\n+      item_fn(_, tps, blk) {\n         if tps.len() > 0u ||\n            attr::find_inline_attr(item.attrs) != attr::ia_none {\n             traverse_inline_body(cx, blk);"}, {"sha": "50f424594c971a1bdbf8d0861de93e6b31bafe48", "filename": "src/test/auxiliary/issue2170lib.rs", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/24e921f7d4ec44c050ac0d767ecec9832bbd8116/src%2Ftest%2Fauxiliary%2Fissue2170lib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/24e921f7d4ec44c050ac0d767ecec9832bbd8116/src%2Ftest%2Fauxiliary%2Fissue2170lib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fauxiliary%2Fissue2170lib.rs?ref=24e921f7d4ec44c050ac0d767ecec9832bbd8116", "patch": "@@ -0,0 +1,8 @@\n+export rsrc;\n+\n+fn foo(_x: i32) {\n+}\n+\n+resource rsrc(x: i32) {\n+    foo(x);\n+}\n\\ No newline at end of file"}, {"sha": "34e51843070d567bbc465703bd0c8085110649a6", "filename": "src/test/run-pass/issue2170exe.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/24e921f7d4ec44c050ac0d767ecec9832bbd8116/src%2Ftest%2Frun-pass%2Fissue2170exe.rs", "raw_url": "https://github.com/rust-lang/rust/raw/24e921f7d4ec44c050ac0d767ecec9832bbd8116/src%2Ftest%2Frun-pass%2Fissue2170exe.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fissue2170exe.rs?ref=24e921f7d4ec44c050ac0d767ecec9832bbd8116", "patch": "@@ -0,0 +1,7 @@\n+// xfail-fast - check-fail fast doesn't under aux-build\n+// aux-build:issue2170lib.rs\n+use issue2170lib;\n+\n+fn main() {\n+    let _ = issue2170lib::rsrc(2i32);\n+}"}]}