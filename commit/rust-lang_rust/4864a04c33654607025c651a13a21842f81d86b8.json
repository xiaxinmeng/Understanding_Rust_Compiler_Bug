{"sha": "4864a04c33654607025c651a13a21842f81d86b8", "node_id": "C_kwDOAAsO6NoAKDQ4NjRhMDRjMzM2NTQ2MDcwMjVjNjUxYTEzYTIxODQyZjgxZDg2Yjg", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-11-16T07:36:12Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-11-16T07:36:12Z"}, "message": "Rollup merge of #104401 - RalfJung:mpsc-leak, r=Amanieu\n\navoid memory leak in mpsc test\n\nr? ```@Amanieu```", "tree": {"sha": "5f7b8bca4592e2dcbbb911b6aa5d1b8154c414dd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5f7b8bca4592e2dcbbb911b6aa5d1b8154c414dd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4864a04c33654607025c651a13a21842f81d86b8", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjdJLsCRBK7hj4Ov3rIwAA5DQIAK7d8qVYHHcleKm9BbD1D6Jm\nw6wMCRdIN6oWBSnA0XLgmSGdazTNRTSjhkXc8F6GdoG2vc9DFVrA+MfZoKE75lga\nXHwGbELuQ1TcxJ1Gxrbu2z8H/hz1Tpie4ed/n+GJ69nIUFZl+NeW4qfBecLZuF7e\nj9b71AsB/wtyX8oLdf98JLTR8Y/YCa79aYv7FG/e+UN7t97ShnjRJMGTjPniTxmN\nIIWAhxcfoVsbdHdz9Y+NDFLikXyAh66dvLInKVsYsgPJ5Cuyawe8JXGHaXQodbdv\nYkTwV2oltjfQ6x0Nk1gcFVB7h4TCvNnrUNueo8c+layX6MTX0Qllw4jdlSmfl1U=\n=nSvM\n-----END PGP SIGNATURE-----\n", "payload": "tree 5f7b8bca4592e2dcbbb911b6aa5d1b8154c414dd\nparent 3a8cacd7fb4e05df32bb5c94bfe650519bae993e\nparent 5fd561dea24d137734195d8d2dc82fe179553b2d\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1668584172 +0100\ncommitter GitHub <noreply@github.com> 1668584172 +0100\n\nRollup merge of #104401 - RalfJung:mpsc-leak, r=Amanieu\n\navoid memory leak in mpsc test\n\nr? ```@Amanieu```\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4864a04c33654607025c651a13a21842f81d86b8", "html_url": "https://github.com/rust-lang/rust/commit/4864a04c33654607025c651a13a21842f81d86b8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4864a04c33654607025c651a13a21842f81d86b8/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3a8cacd7fb4e05df32bb5c94bfe650519bae993e", "url": "https://api.github.com/repos/rust-lang/rust/commits/3a8cacd7fb4e05df32bb5c94bfe650519bae993e", "html_url": "https://github.com/rust-lang/rust/commit/3a8cacd7fb4e05df32bb5c94bfe650519bae993e"}, {"sha": "5fd561dea24d137734195d8d2dc82fe179553b2d", "url": "https://api.github.com/repos/rust-lang/rust/commits/5fd561dea24d137734195d8d2dc82fe179553b2d", "html_url": "https://github.com/rust-lang/rust/commit/5fd561dea24d137734195d8d2dc82fe179553b2d"}], "stats": {"total": 5, "additions": 3, "deletions": 2}, "files": [{"sha": "1e52a4a705c982caade8aa8dd91f9530fee627ce", "filename": "library/std/src/sync/mpsc/tests.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/4864a04c33654607025c651a13a21842f81d86b8/library%2Fstd%2Fsrc%2Fsync%2Fmpsc%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4864a04c33654607025c651a13a21842f81d86b8/library%2Fstd%2Fsrc%2Fsync%2Fmpsc%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsync%2Fmpsc%2Ftests.rs?ref=4864a04c33654607025c651a13a21842f81d86b8", "patch": "@@ -713,10 +713,11 @@ fn issue_39364() {\n     let t = thread::spawn(move || {\n         thread::sleep(Duration::from_millis(300));\n         let _ = tx.clone();\n-        crate::mem::forget(tx);\n+        // Don't drop; hand back to caller.\n+        tx\n     });\n \n     let _ = rx.recv_timeout(Duration::from_millis(500));\n-    t.join().unwrap();\n+    let _tx = t.join().unwrap(); // delay dropping until end of test\n     let _ = rx.recv_timeout(Duration::from_millis(500));\n }"}]}