{"sha": "e64b677ca66d742e7c06738bacf3a160cba827a7", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU2NGI2NzdjYTY2ZDc0MmU3YzA2NzM4YmFjZjNhMTYwY2JhODI3YTc=", "commit": {"author": {"name": "Corey Richardson", "email": "corey@octayn.net", "date": "2015-03-28T03:01:19Z"}, "committer": {"name": "Corey Richardson", "email": "corey@octayn.net", "date": "2015-03-29T10:15:51Z"}, "message": "mk: don't build docs for internal or behind-the-facade crates in beta/stable\n\nThis saves a bunch of a time and will make distributions smaller, as well as\navoiding filling the implementors page with internal garbage. Turn it back on\nwith `--enable-compiler-docs` if you want compiler docs during development.\n\nCrates behind the facade are only documented on nightly/dev builds (where they\ncan be used).\n\n[breaking-change]\n\nCloses #23772\nCloses #21297", "tree": {"sha": "0e85291891a6e9712d240f461752fc7ddfefd7bd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0e85291891a6e9712d240f461752fc7ddfefd7bd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e64b677ca66d742e7c06738bacf3a160cba827a7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e64b677ca66d742e7c06738bacf3a160cba827a7", "html_url": "https://github.com/rust-lang/rust/commit/e64b677ca66d742e7c06738bacf3a160cba827a7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e64b677ca66d742e7c06738bacf3a160cba827a7/comments", "author": {"login": "emberian", "id": 704250, "node_id": "MDQ6VXNlcjcwNDI1MA==", "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emberian", "html_url": "https://github.com/emberian", "followers_url": "https://api.github.com/users/emberian/followers", "following_url": "https://api.github.com/users/emberian/following{/other_user}", "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}", "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emberian/subscriptions", "organizations_url": "https://api.github.com/users/emberian/orgs", "repos_url": "https://api.github.com/users/emberian/repos", "events_url": "https://api.github.com/users/emberian/events{/privacy}", "received_events_url": "https://api.github.com/users/emberian/received_events", "type": "User", "site_admin": false}, "committer": {"login": "emberian", "id": 704250, "node_id": "MDQ6VXNlcjcwNDI1MA==", "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emberian", "html_url": "https://github.com/emberian", "followers_url": "https://api.github.com/users/emberian/followers", "following_url": "https://api.github.com/users/emberian/following{/other_user}", "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}", "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emberian/subscriptions", "organizations_url": "https://api.github.com/users/emberian/orgs", "repos_url": "https://api.github.com/users/emberian/repos", "events_url": "https://api.github.com/users/emberian/events{/privacy}", "received_events_url": "https://api.github.com/users/emberian/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "199bdcfeff5cfafd1f8e8ff583d7209272469879", "url": "https://api.github.com/repos/rust-lang/rust/commits/199bdcfeff5cfafd1f8e8ff583d7209272469879", "html_url": "https://github.com/rust-lang/rust/commit/199bdcfeff5cfafd1f8e8ff583d7209272469879"}], "stats": {"total": 40, "additions": 28, "deletions": 12}, "files": [{"sha": "3673a20738c997cdc52d59c1b4f10cc5377418be", "filename": "configure", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/e64b677ca66d742e7c06738bacf3a160cba827a7/configure", "raw_url": "https://github.com/rust-lang/rust/raw/e64b677ca66d742e7c06738bacf3a160cba827a7/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=e64b677ca66d742e7c06738bacf3a160cba827a7", "patch": "@@ -526,7 +526,8 @@ VAL_OPTIONS=\"\"\n opt valgrind 0 \"run tests with valgrind (memcheck by default)\"\n opt helgrind 0 \"run tests with helgrind instead of memcheck\"\n opt valgrind-rpass 1 \"run rpass-valgrind tests with valgrind\"\n-opt docs     1 \"build documentation\"\n+opt docs     1 \"build standard library documentation\"\n+opt compiler-docs     0 \"build compiler documentation\"\n opt optimize 1 \"build optimized rust code\"\n opt optimize-cxx 1 \"build optimized C++ code\"\n opt optimize-llvm 1 \"build optimized LLVM\""}, {"sha": "7494a9c5f9892b2396d952340ae878505a14aff9", "filename": "mk/crates.mk", "status": "modified", "additions": 22, "deletions": 10, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/e64b677ca66d742e7c06738bacf3a160cba827a7/mk%2Fcrates.mk", "raw_url": "https://github.com/rust-lang/rust/raw/e64b677ca66d742e7c06738bacf3a160cba827a7/mk%2Fcrates.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fcrates.mk?ref=e64b677ca66d742e7c06738bacf3a160cba827a7", "patch": "@@ -122,17 +122,29 @@ ONLY_RLIB_rustc_bitflags := 1\n # You should not need to edit below this line\n ################################################################################\n \n+# On channels where the only usable crate is std, only build documentation for\n+# std. This keeps distributions small and doesn't clutter up the API docs with\n+# confusing internal details from the crates behind the facade.\n+\n+ifeq ($(CFG_RELEASE_CHANNEL),stable)\n+DOC_CRATES := std\n+else\n+ifeq ($(CFG_RELEASE_CHANNEL),beta)\n+DOC_CRATES := std\n+else\n DOC_CRATES := $(filter-out rustc, \\\n-              $(filter-out rustc_trans, \\\n-              $(filter-out rustc_typeck, \\\n-              $(filter-out rustc_borrowck, \\\n-              $(filter-out rustc_resolve, \\\n-              $(filter-out rustc_driver, \\\n-              $(filter-out rustc_privacy, \\\n-              $(filter-out rustc_lint, \\\n-              $(filter-out log, \\\n-              $(filter-out getopts, \\\n-              $(filter-out syntax, $(CRATES))))))))))))\n+\t   $(filter-out rustc_trans, \\\n+\t   $(filter-out rustc_typeck, \\\n+\t   $(filter-out rustc_borrowck, \\\n+\t   $(filter-out rustc_resolve, \\\n+\t   $(filter-out rustc_driver, \\\n+\t   $(filter-out rustc_privacy, \\\n+\t   $(filter-out rustc_lint, \\\n+\t   $(filter-out log, \\\n+\t   $(filter-out getopts, \\\n+\t   $(filter-out syntax, $(CRATES))))))))))))\n+endif\n+endif\n COMPILER_DOC_CRATES := rustc rustc_trans rustc_borrowck rustc_resolve \\\n                        rustc_typeck rustc_driver syntax rustc_privacy \\\n                        rustc_lint"}, {"sha": "d297055ba9acb6e3b5c2b322f38ddcccc3b35949", "filename": "mk/docs.mk", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e64b677ca66d742e7c06738bacf3a160cba827a7/mk%2Fdocs.mk", "raw_url": "https://github.com/rust-lang/rust/raw/e64b677ca66d742e7c06738bacf3a160cba827a7/mk%2Fdocs.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fdocs.mk?ref=e64b677ca66d742e7c06738bacf3a160cba827a7", "patch": "@@ -259,7 +259,10 @@ doc/$(1)/index.html: $$(LIB_DOC_DEP_$(1)) doc/$(1)/\n endef\n \n $(foreach crate,$(DOC_CRATES),$(eval $(call DEF_LIB_DOC,$(crate),DOC_TARGETS)))\n-$(foreach crate,$(COMPILER_DOC_CRATES),$(eval $(call DEF_LIB_DOC,$(crate),COMPILER_DOC_TARGETS)))\n+\n+ifdef CFG_COMPILER_DOCS\n+  $(foreach crate,$(COMPILER_DOC_CRATES),$(eval $(call DEF_LIB_DOC,$(crate),COMPILER_DOC_TARGETS)))\n+endif\n \n ifdef CFG_DISABLE_DOCS\n   $(info cfg: disabling doc build (CFG_DISABLE_DOCS))"}]}