{"sha": "6e55426c8c1cda45a99eef7974274c37579d0ccb", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZlNTU0MjZjOGMxY2RhNDVhOTllZWY3OTc0Mjc0YzM3NTc5ZDBjY2I=", "commit": {"author": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2011-11-29T05:23:42Z"}, "committer": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2011-11-29T20:51:10Z"}, "message": "tweak to get windows test-running correct", "tree": {"sha": "4439487f7d70ba74035b7a626302b2b57fa439cb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4439487f7d70ba74035b7a626302b2b57fa439cb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6e55426c8c1cda45a99eef7974274c37579d0ccb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6e55426c8c1cda45a99eef7974274c37579d0ccb", "html_url": "https://github.com/rust-lang/rust/commit/6e55426c8c1cda45a99eef7974274c37579d0ccb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6e55426c8c1cda45a99eef7974274c37579d0ccb/comments", "author": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "89a4f8c7515d15e005e496a0ec62bef9682a0880", "url": "https://api.github.com/repos/rust-lang/rust/commits/89a4f8c7515d15e005e496a0ec62bef9682a0880", "html_url": "https://github.com/rust-lang/rust/commit/89a4f8c7515d15e005e496a0ec62bef9682a0880"}], "stats": {"total": 17, "additions": 9, "deletions": 8}, "files": [{"sha": "375cbf26a736a8e43f25c57ec2aaeb5e6f170749", "filename": "mk/platform.mk", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6e55426c8c1cda45a99eef7974274c37579d0ccb/mk%2Fplatform.mk", "raw_url": "https://github.com/rust-lang/rust/raw/6e55426c8c1cda45a99eef7974274c37579d0ccb/mk%2Fplatform.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fplatform.mk?ref=6e55426c8c1cda45a99eef7974274c37579d0ccb", "patch": "@@ -101,7 +101,7 @@ else\n   CFG_GCCISH_CFLAGS += -O2\n endif\n \n-CFG_TESTLIB=$(CFG_BUILD_DIR)/$(CFG_HOST_TRIPLE)/$(strip \\\n+CFG_TESTLIB=$(CFG_BUILD_DIR)/$(2)/$(strip \\\n  $(if $(findstring stage0,$(1)), \\\n        stage0/lib, \\\n       $(if $(findstring stage1,$(1)), \\\n@@ -158,8 +158,8 @@ ifdef CFG_WINDOWSY\n   CFG_DEF_SUFFIX := .def\n   CFG_LDPATH :=$(CFG_LDPATH):$$PATH\n   CFG_RUN=PATH=\"$(CFG_LDPATH):$(1)\" $(2)\n-  CFG_RUN_TARG=$(call CFG_RUN,$(HOST_LIB$(1)),$(2))\n-  CFG_RUN_TEST=$(call CFG_RUN,$(call CFG_TESTLIB,$(1)),$(1))\n+  CFG_RUN_TARG=$(call CFG_RUN,$(HLIB$(1)_H_$(CFG_HOST_TRIPLE)),$(2))\n+  CFG_RUN_TEST=$(call CFG_RUN,$(call CFG_TESTLIB,$(1),$(3)),$(1))\n   CFG_LIBUV_LINK_FLAGS=-lWs2_32\n \n   ifndef CFG_ENABLE_MINGW_CROSS"}, {"sha": "ca3f1485da906b82b10406b2a695db25ebb0030a", "filename": "mk/tests.mk", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/6e55426c8c1cda45a99eef7974274c37579d0ccb/mk%2Ftests.mk", "raw_url": "https://github.com/rust-lang/rust/raw/6e55426c8c1cda45a99eef7974274c37579d0ccb/mk%2Ftests.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftests.mk?ref=6e55426c8c1cda45a99eef7974274c37579d0ccb", "patch": "@@ -62,7 +62,7 @@ STDTEST_INPUTS := $(wildcard $(S)src/test/stdtest/*rs)\n \n # Run the compiletest runner itself under valgrind\n ifdef CTEST_VALGRIND\n-  CFG_RUN_CTEST=$(call CFG_RUN_TEST,$(2))\n+  CFG_RUN_CTEST=$(call CFG_RUN_TEST,$(2),$(3))\n else\n   CFG_RUN_CTEST=$(call CFG_RUN,$(TLIB$(1)_T_$(3)_H_$(3)),$(2))\n endif\n@@ -174,7 +174,7 @@ $(3)/test/stdtest.stage$(1)-$(2)$$(X):\t\t\t\\\n check-stage$(1)-T-$(2)-H-$(3)-std-dummy:\t\t\t\\\n \t\t$(3)/test/stdtest.stage$(1)-$(2)$$(X)\n \t@$$(call E, run: $$<)\n-\t$$(Q)$$(call CFG_RUN_TEST,$$<) $$(TESTARGS)\n+\t$$(Q)$$(call CFG_RUN_TEST,$$<,$(2),$(3)) $$(TESTARGS)\n \n # Rules for the rustc test runner\n \n@@ -189,7 +189,7 @@ $(3)/test/rustctest.stage$(1)-$(2)$$(X):\t\t\t\t\t\\\n check-stage$(1)-T-$(2)-H-$(3)-rustc-dummy:\t\t\\\n \t\t$(3)/test/rustctest.stage$(1)-$(2)$$(X)\n \t@$$(call E, run: $$<)\n-\t$$(Q)$$(call CFG_RUN_TEST,$$<) $$(TESTARGS)\n+\t$$(Q)$$(call CFG_RUN_TEST,$$<,$(2),$(3)) $$(TESTARGS)\n \n # Rules for the cfail/rfail/rpass/bench/perf test runner\n \n@@ -395,4 +395,4 @@ test/$(FT_DRIVER)$(X): test/$(FT_DRIVER).rs $(TARGET_HOST_LIB2)/$(FT_LIB) \\\n \t$(STAGE2_$(CFG_HOST_TRIPLE)) -L $(HOST_LIB2) -o $@ $<\n \n test/$(FT_DRIVER).out: test/$(FT_DRIVER)$(X) $(SREQ2$(CFG_HOST_TRIPLE))\n-\t$(Q)$(call CFG_RUN_TEST, $<)\n+\t$(Q)$(call CFG_RUN_TEST,$<,$(CFG_HOST_TRIPLE),$(CFG_HOST_TRIPLE))"}, {"sha": "3ad64d8bed95ed93fc74bdd83b9b3ca8c09482b7", "filename": "src/etc/snapshot.py", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/6e55426c8c1cda45a99eef7974274c37579d0ccb/src%2Fetc%2Fsnapshot.py", "raw_url": "https://github.com/rust-lang/rust/raw/6e55426c8c1cda45a99eef7974274c37579d0ccb/src%2Fetc%2Fsnapshot.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fsnapshot.py?ref=6e55426c8c1cda45a99eef7974274c37579d0ccb", "patch": "@@ -56,7 +56,8 @@ def full_snapshot_name(date, rev, platform, hsh):\n \n def get_kernel(triple):\n     os_name = triple.split('-')[-1]\n-    if os_name == \"nt\" or scrub(os.getenv(\"CFG_ENABLE_MINGW_CROSS\")):\n+    #scrub(os.getenv(\"CFG_ENABLE_MINGW_CROSS\")):\n+    if os_name == \"nt\" or os_name == \"mingw32\":\n         return \"winnt\"\n     if os_name == \"darwin\":\n         return \"macos\""}]}