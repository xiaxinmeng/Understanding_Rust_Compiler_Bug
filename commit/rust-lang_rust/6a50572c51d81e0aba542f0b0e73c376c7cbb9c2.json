{"sha": "6a50572c51d81e0aba542f0b0e73c376c7cbb9c2", "node_id": "C_kwDOAAsO6NoAKDZhNTA1NzJjNTFkODFlMGFiYTU0MmYwYjBlNzNjMzc2YzdjYmI5YzI", "commit": {"author": {"name": "ridwanabdillahi", "email": "91507758+ridwanabdillahi@users.noreply.github.com", "date": "2022-03-04T17:57:40Z"}, "committer": {"name": "ridwanabdillahi", "email": "91507758+ridwanabdillahi@users.noreply.github.com", "date": "2022-03-04T17:57:40Z"}, "message": "Support RelWithDebInfo for lld.", "tree": {"sha": "e1b45c08baa0064834c605d057804a0357e9b58e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e1b45c08baa0064834c605d057804a0357e9b58e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6a50572c51d81e0aba542f0b0e73c376c7cbb9c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6a50572c51d81e0aba542f0b0e73c376c7cbb9c2", "html_url": "https://github.com/rust-lang/rust/commit/6a50572c51d81e0aba542f0b0e73c376c7cbb9c2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6a50572c51d81e0aba542f0b0e73c376c7cbb9c2/comments", "author": {"login": "ridwanabdillahi", "id": 91507758, "node_id": "U_kgDOBXRMLg", "avatar_url": "https://avatars.githubusercontent.com/u/91507758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ridwanabdillahi", "html_url": "https://github.com/ridwanabdillahi", "followers_url": "https://api.github.com/users/ridwanabdillahi/followers", "following_url": "https://api.github.com/users/ridwanabdillahi/following{/other_user}", "gists_url": "https://api.github.com/users/ridwanabdillahi/gists{/gist_id}", "starred_url": "https://api.github.com/users/ridwanabdillahi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ridwanabdillahi/subscriptions", "organizations_url": "https://api.github.com/users/ridwanabdillahi/orgs", "repos_url": "https://api.github.com/users/ridwanabdillahi/repos", "events_url": "https://api.github.com/users/ridwanabdillahi/events{/privacy}", "received_events_url": "https://api.github.com/users/ridwanabdillahi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ridwanabdillahi", "id": 91507758, "node_id": "U_kgDOBXRMLg", "avatar_url": "https://avatars.githubusercontent.com/u/91507758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ridwanabdillahi", "html_url": "https://github.com/ridwanabdillahi", "followers_url": "https://api.github.com/users/ridwanabdillahi/followers", "following_url": "https://api.github.com/users/ridwanabdillahi/following{/other_user}", "gists_url": "https://api.github.com/users/ridwanabdillahi/gists{/gist_id}", "starred_url": "https://api.github.com/users/ridwanabdillahi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ridwanabdillahi/subscriptions", "organizations_url": "https://api.github.com/users/ridwanabdillahi/orgs", "repos_url": "https://api.github.com/users/ridwanabdillahi/repos", "events_url": "https://api.github.com/users/ridwanabdillahi/events{/privacy}", "received_events_url": "https://api.github.com/users/ridwanabdillahi/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b4bf56cd66ca83e908fd43bde4c627f94b2a8a9f", "url": "https://api.github.com/repos/rust-lang/rust/commits/b4bf56cd66ca83e908fd43bde4c627f94b2a8a9f", "html_url": "https://github.com/rust-lang/rust/commit/b4bf56cd66ca83e908fd43bde4c627f94b2a8a9f"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "40ab5d45a4bcd1b0504dca94defbb911e5cd5a45", "filename": "src/bootstrap/native.rs", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/6a50572c51d81e0aba542f0b0e73c376c7cbb9c2/src%2Fbootstrap%2Fnative.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a50572c51d81e0aba542f0b0e73c376c7cbb9c2/src%2Fbootstrap%2Fnative.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fnative.rs?ref=6a50572c51d81e0aba542f0b0e73c376c7cbb9c2", "patch": "@@ -653,8 +653,16 @@ impl Step for Lld {\n         // there's probably a lot of reasons you can't do that other than this.\n         let llvm_config_shim = env::current_exe().unwrap().with_file_name(\"llvm-config-wrapper\");\n \n+        // Re-use the same flags as llvm to control the level of debug information\n+        // generated for lld.\n+        let profile = match (builder.config.llvm_optimize, builder.config.llvm_release_debuginfo) {\n+            (false, _) => \"Debug\",\n+            (true, false) => \"Release\",\n+            (true, true) => \"RelWithDebInfo\",\n+        };\n+\n         cfg.out_dir(&out_dir)\n-            .profile(\"Release\")\n+            .profile(profile)\n             .env(\"LLVM_CONFIG_REAL\", &llvm_config)\n             .define(\"LLVM_CONFIG_PATH\", llvm_config_shim)\n             .define(\"LLVM_INCLUDE_TESTS\", \"OFF\");"}]}