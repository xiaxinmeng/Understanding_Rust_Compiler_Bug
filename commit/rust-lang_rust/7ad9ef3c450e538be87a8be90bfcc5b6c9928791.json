{"sha": "7ad9ef3c450e538be87a8be90bfcc5b6c9928791", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdhZDllZjNjNDUwZTUzOGJlODdhOGJlOTBiZmNjNWI2Yzk5Mjg3OTE=", "commit": {"author": {"name": "est31", "email": "MTest31@outlook.com", "date": "2018-05-17T21:50:27Z"}, "committer": {"name": "est31", "email": "MTest31@outlook.com", "date": "2018-05-17T21:54:49Z"}, "message": "CheckLoopVisitor: also visit closure arguments\n\nThis turns an ICE on this code:\n\nfn main() {\n    |_: [u8; break]| ();\n}\n\nfrom\n    'assertion failed: self.tcx.sess.err_count() > 0', librustc_typeck/check/mod.rs\nto\n    librustc_mir/hair/cx/expr.rs:543: invalid loop id for break: not inside loop scope\n\nwhich is at a later stage during compilation and most importantly\nfixes of bug #50576 will fix this as well.", "tree": {"sha": "5ed893c8ebef2ed1d34f7656fe2a9635893ba7a3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5ed893c8ebef2ed1d34f7656fe2a9635893ba7a3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7ad9ef3c450e538be87a8be90bfcc5b6c9928791", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7ad9ef3c450e538be87a8be90bfcc5b6c9928791", "html_url": "https://github.com/rust-lang/rust/commit/7ad9ef3c450e538be87a8be90bfcc5b6c9928791", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7ad9ef3c450e538be87a8be90bfcc5b6c9928791/comments", "author": {"login": "est31", "id": 8872119, "node_id": "MDQ6VXNlcjg4NzIxMTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/est31", "html_url": "https://github.com/est31", "followers_url": "https://api.github.com/users/est31/followers", "following_url": "https://api.github.com/users/est31/following{/other_user}", "gists_url": "https://api.github.com/users/est31/gists{/gist_id}", "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/est31/subscriptions", "organizations_url": "https://api.github.com/users/est31/orgs", "repos_url": "https://api.github.com/users/est31/repos", "events_url": "https://api.github.com/users/est31/events{/privacy}", "received_events_url": "https://api.github.com/users/est31/received_events", "type": "User", "site_admin": false}, "committer": {"login": "est31", "id": 8872119, "node_id": "MDQ6VXNlcjg4NzIxMTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/est31", "html_url": "https://github.com/est31", "followers_url": "https://api.github.com/users/est31/followers", "following_url": "https://api.github.com/users/est31/following{/other_user}", "gists_url": "https://api.github.com/users/est31/gists{/gist_id}", "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/est31/subscriptions", "organizations_url": "https://api.github.com/users/est31/orgs", "repos_url": "https://api.github.com/users/est31/repos", "events_url": "https://api.github.com/users/est31/events{/privacy}", "received_events_url": "https://api.github.com/users/est31/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0e325d0141ce8d86524f55c2df53835aab895096", "url": "https://api.github.com/repos/rust-lang/rust/commits/0e325d0141ce8d86524f55c2df53835aab895096", "html_url": "https://github.com/rust-lang/rust/commit/0e325d0141ce8d86524f55c2df53835aab895096"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "670097e3a48565f287526bdfcd1ca2793347ca8f", "filename": "src/librustc_passes/loops.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/7ad9ef3c450e538be87a8be90bfcc5b6c9928791/src%2Flibrustc_passes%2Floops.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7ad9ef3c450e538be87a8be90bfcc5b6c9928791/src%2Flibrustc_passes%2Floops.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_passes%2Floops.rs?ref=7ad9ef3c450e538be87a8be90bfcc5b6c9928791", "patch": "@@ -82,7 +82,8 @@ impl<'a, 'hir> Visitor<'hir> for CheckLoopVisitor<'a, 'hir> {\n             hir::ExprLoop(ref b, _, source) => {\n                 self.with_context(Loop(LoopKind::Loop(source)), |v| v.visit_block(&b));\n             }\n-            hir::ExprClosure(.., b, _, _) => {\n+            hir::ExprClosure(_, ref function_decl, b, _, _) => {\n+                self.visit_fn_decl(&function_decl);\n                 self.with_context(Closure, |v| v.visit_nested_body(b));\n             }\n             hir::ExprBlock(ref b, Some(_label)) => {"}]}