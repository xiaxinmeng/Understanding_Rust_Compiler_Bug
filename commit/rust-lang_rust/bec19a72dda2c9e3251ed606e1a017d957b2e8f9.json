{"sha": "bec19a72dda2c9e3251ed606e1a017d957b2e8f9", "node_id": "C_kwDOAAsO6NoAKGJlYzE5YTcyZGRhMmM5ZTMyNTFlZDYwNmUxYTAxN2Q5NTdiMmU4Zjk", "commit": {"author": {"name": "R\u00e9my Rakic", "email": "remy.rakic+github@gmail.com", "date": "2021-09-30T20:12:06Z"}, "committer": {"name": "R\u00e9my Rakic", "email": "remy.rakic+github@gmail.com", "date": "2021-09-30T20:55:05Z"}, "message": "add regression test for issue 89119", "tree": {"sha": "c53adee007fe0291c9288da04daa30eee979f790", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c53adee007fe0291c9288da04daa30eee979f790"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bec19a72dda2c9e3251ed606e1a017d957b2e8f9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bec19a72dda2c9e3251ed606e1a017d957b2e8f9", "html_url": "https://github.com/rust-lang/rust/commit/bec19a72dda2c9e3251ed606e1a017d957b2e8f9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bec19a72dda2c9e3251ed606e1a017d957b2e8f9/comments", "author": {"login": "lqd", "id": 247183, "node_id": "MDQ6VXNlcjI0NzE4Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/247183?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lqd", "html_url": "https://github.com/lqd", "followers_url": "https://api.github.com/users/lqd/followers", "following_url": "https://api.github.com/users/lqd/following{/other_user}", "gists_url": "https://api.github.com/users/lqd/gists{/gist_id}", "starred_url": "https://api.github.com/users/lqd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lqd/subscriptions", "organizations_url": "https://api.github.com/users/lqd/orgs", "repos_url": "https://api.github.com/users/lqd/repos", "events_url": "https://api.github.com/users/lqd/events{/privacy}", "received_events_url": "https://api.github.com/users/lqd/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lqd", "id": 247183, "node_id": "MDQ6VXNlcjI0NzE4Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/247183?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lqd", "html_url": "https://github.com/lqd", "followers_url": "https://api.github.com/users/lqd/followers", "following_url": "https://api.github.com/users/lqd/following{/other_user}", "gists_url": "https://api.github.com/users/lqd/gists{/gist_id}", "starred_url": "https://api.github.com/users/lqd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lqd/subscriptions", "organizations_url": "https://api.github.com/users/lqd/orgs", "repos_url": "https://api.github.com/users/lqd/repos", "events_url": "https://api.github.com/users/lqd/events{/privacy}", "received_events_url": "https://api.github.com/users/lqd/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6dc08b909b469d58dd8fa54c57ab193b8cf95257", "url": "https://api.github.com/repos/rust-lang/rust/commits/6dc08b909b469d58dd8fa54c57ab193b8cf95257", "html_url": "https://github.com/rust-lang/rust/commit/6dc08b909b469d58dd8fa54c57ab193b8cf95257"}], "stats": {"total": 71, "additions": 71, "deletions": 0}, "files": [{"sha": "769e897316327245d77caf3ab3aa7f023288b478", "filename": "src/test/ui/traits/auxiliary/issue_89119_intercrate_caching.rs", "status": "added", "additions": 60, "deletions": 0, "changes": 60, "blob_url": "https://github.com/rust-lang/rust/blob/bec19a72dda2c9e3251ed606e1a017d957b2e8f9/src%2Ftest%2Fui%2Ftraits%2Fauxiliary%2Fissue_89119_intercrate_caching.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bec19a72dda2c9e3251ed606e1a017d957b2e8f9/src%2Ftest%2Fui%2Ftraits%2Fauxiliary%2Fissue_89119_intercrate_caching.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Fauxiliary%2Fissue_89119_intercrate_caching.rs?ref=bec19a72dda2c9e3251ed606e1a017d957b2e8f9", "patch": "@@ -0,0 +1,60 @@\n+// This is the auxiliary crate for the regression test for issue #89119, minimized\n+// from `zvariant-2.8.0`.\n+\n+use std::convert::TryFrom;\n+use std::borrow::Cow;\n+\n+pub struct Str<'a>(Cow<'a, str>);\n+impl<'a> Str<'a> {\n+    pub fn to_owned(&self) -> Str<'static> {\n+        todo!()\n+    }\n+}\n+\n+pub enum Value<'a> {\n+    Str(Str<'a>),\n+    Value(Box<Value<'a>>),\n+}\n+impl<'a> Value<'a> {\n+    pub fn to_owned(&self) -> Value<'static> {\n+        match self {\n+            Value::Str(v) => Value::Str(v.to_owned()),\n+            Value::Value(v) => {\n+                let o = OwnedValue::from(&**v);\n+                Value::Value(Box::new(o.into_inner()))\n+            }\n+        }\n+    }\n+}\n+\n+struct OwnedValue(Value<'static>);\n+impl OwnedValue {\n+    pub(crate) fn into_inner(self) -> Value<'static> {\n+        todo!()\n+    }\n+}\n+impl<'a, T> TryFrom<OwnedValue> for Vec<T>\n+where\n+    T: TryFrom<Value<'a>, Error = ()>,\n+{\n+    type Error = ();\n+    fn try_from(_: OwnedValue) -> Result<Self, Self::Error> {\n+        todo!()\n+    }\n+}\n+impl TryFrom<OwnedValue> for Vec<OwnedValue> {\n+    type Error = ();\n+    fn try_from(_: OwnedValue) -> Result<Self, Self::Error> {\n+        todo!()\n+    }\n+}\n+impl<'a> From<Value<'a>> for OwnedValue {\n+    fn from(_: Value<'a>) -> Self {\n+        todo!()\n+    }\n+}\n+impl<'a> From<&Value<'a>> for OwnedValue {\n+    fn from(_: &Value<'a>) -> Self {\n+        todo!()\n+    }\n+}"}, {"sha": "170f69915e2abbfb0765a8faf908ecf0a598fb4c", "filename": "src/test/ui/traits/issue-89119.rs", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/bec19a72dda2c9e3251ed606e1a017d957b2e8f9/src%2Ftest%2Fui%2Ftraits%2Fissue-89119.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bec19a72dda2c9e3251ed606e1a017d957b2e8f9/src%2Ftest%2Fui%2Ftraits%2Fissue-89119.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Fissue-89119.rs?ref=bec19a72dda2c9e3251ed606e1a017d957b2e8f9", "patch": "@@ -0,0 +1,11 @@\n+// This is a regression test for issue #89119: an issue in intercrate mode caching.\n+//\n+// It requires multiple crates, of course, but the bug is triggered by the code in the dependency,\n+// not the main crate. This is why this file is empty.\n+//\n+// The auxiliary crate used in the test contains the code minimized from `zvariant-2.8.0`.\n+\n+// check-pass\n+// aux-build: issue_89119_intercrate_caching.rs\n+\n+fn main() {}"}]}