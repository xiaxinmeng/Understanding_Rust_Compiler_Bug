{"sha": "a619e2539859b6e1365fedf3fff17485b4748d64", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE2MTllMjUzOTg1OWI2ZTEzNjVmZWRmM2ZmZjE3NDg1YjQ3NDhkNjQ=", "commit": {"author": {"name": "Mara Bos", "email": "m-ou.se@m-ou.se", "date": "2020-11-08T12:36:12Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-11-08T12:36:12Z"}, "message": "Rollup merge of #78706 - bjorn3:fix_run_make_without_llvm, r=Mark-Simulacrum\n\nFix run-make tests running when LLVM is disabled\n\nThe `--cc`, `--cxx`, `--cflags` and `--ar` flags were only passed to compiletest when `builder.config.llvm_enabled()` returned true. This is preventing me from running the tests on cg_clif.", "tree": {"sha": "6ad71492116e378139a70922668de620398b5817", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6ad71492116e378139a70922668de620398b5817"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a619e2539859b6e1365fedf3fff17485b4748d64", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfp+Y9CRBK7hj4Ov3rIwAAdHIIAAHKVf13FrRVZ3zzy2hBbP3i\nFAFsRhwPaP35HK1oMIclUbcLp6KRwPwCwLNmR1z8kv4dCNfrFY3NLx8ojJ9TKT0m\n/JRkKOYMjGwx30FLOkOFoo0jEoTs8a2PFdCNrOw7YbkLgOZ49wVRo6QrPczYjmGs\n5BAN7FtmvZCHzS8LwhSUNeh1gEE33Kq4Thxg5XV4cyHCLE1Y1X9cZ2aqoio5GSOV\n4XfZf1JE+PtvafEDLMLj7yb9yg/C0FfjipAL95BtPEMNwi2R4FNvTqgJhaIMu693\nNz+aovQzXhV3/ywgsFLhnOM97ZqyIm3jrdz+gopI1kI6hd0PRhwCNfzQTNZgt1Q=\n=eVUX\n-----END PGP SIGNATURE-----\n", "payload": "tree 6ad71492116e378139a70922668de620398b5817\nparent 7d9ad6d949f57b3e00a5f0c76e712886e9f5fb87\nparent 39103ced582f1111af41326f904966aedd8bc47f\nauthor Mara Bos <m-ou.se@m-ou.se> 1604838972 +0100\ncommitter GitHub <noreply@github.com> 1604838972 +0100\n\nRollup merge of #78706 - bjorn3:fix_run_make_without_llvm, r=Mark-Simulacrum\n\nFix run-make tests running when LLVM is disabled\n\nThe `--cc`, `--cxx`, `--cflags` and `--ar` flags were only passed to compiletest when `builder.config.llvm_enabled()` returned true. This is preventing me from running the tests on cg_clif.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a619e2539859b6e1365fedf3fff17485b4748d64", "html_url": "https://github.com/rust-lang/rust/commit/a619e2539859b6e1365fedf3fff17485b4748d64", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a619e2539859b6e1365fedf3fff17485b4748d64/comments", "author": {"login": "m-ou-se", "id": 783247, "node_id": "MDQ6VXNlcjc4MzI0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/783247?v=4", "gravatar_id": "", "url": "https://api.github.com/users/m-ou-se", "html_url": "https://github.com/m-ou-se", "followers_url": "https://api.github.com/users/m-ou-se/followers", "following_url": "https://api.github.com/users/m-ou-se/following{/other_user}", "gists_url": "https://api.github.com/users/m-ou-se/gists{/gist_id}", "starred_url": "https://api.github.com/users/m-ou-se/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/m-ou-se/subscriptions", "organizations_url": "https://api.github.com/users/m-ou-se/orgs", "repos_url": "https://api.github.com/users/m-ou-se/repos", "events_url": "https://api.github.com/users/m-ou-se/events{/privacy}", "received_events_url": "https://api.github.com/users/m-ou-se/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7d9ad6d949f57b3e00a5f0c76e712886e9f5fb87", "url": "https://api.github.com/repos/rust-lang/rust/commits/7d9ad6d949f57b3e00a5f0c76e712886e9f5fb87", "html_url": "https://github.com/rust-lang/rust/commit/7d9ad6d949f57b3e00a5f0c76e712886e9f5fb87"}, {"sha": "39103ced582f1111af41326f904966aedd8bc47f", "url": "https://api.github.com/repos/rust-lang/rust/commits/39103ced582f1111af41326f904966aedd8bc47f", "html_url": "https://github.com/rust-lang/rust/commit/39103ced582f1111af41326f904966aedd8bc47f"}], "stats": {"total": 26, "additions": 15, "deletions": 11}, "files": [{"sha": "2b87c4b91af83d5add01015b886aaf62e50f95d0", "filename": "src/bootstrap/test.rs", "status": "modified", "additions": 15, "deletions": 11, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/a619e2539859b6e1365fedf3fff17485b4748d64/src%2Fbootstrap%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a619e2539859b6e1365fedf3fff17485b4748d64/src%2Fbootstrap%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftest.rs?ref=a619e2539859b6e1365fedf3fff17485b4748d64", "patch": "@@ -1205,17 +1205,6 @@ note: if you're sure you want to do this, please open an issue as to why. In the\n             // Only pass correct values for these flags for the `run-make` suite as it\n             // requires that a C++ compiler was configured which isn't always the case.\n             if !builder.config.dry_run && matches!(suite, \"run-make\" | \"run-make-fulldeps\") {\n-                cmd.arg(\"--cc\")\n-                    .arg(builder.cc(target))\n-                    .arg(\"--cxx\")\n-                    .arg(builder.cxx(target).unwrap())\n-                    .arg(\"--cflags\")\n-                    .arg(builder.cflags(target, GitRepo::Rustc).join(\" \"));\n-                copts_passed = true;\n-                if let Some(ar) = builder.ar(target) {\n-                    cmd.arg(\"--ar\").arg(ar);\n-                }\n-\n                 // The llvm/bin directory contains many useful cross-platform\n                 // tools. Pass the path to run-make tests so they can use them.\n                 let llvm_bin_path = llvm_config\n@@ -1241,6 +1230,21 @@ note: if you're sure you want to do this, please open an issue as to why. In the\n             }\n         }\n \n+        // Only pass correct values for these flags for the `run-make` suite as it\n+        // requires that a C++ compiler was configured which isn't always the case.\n+        if !builder.config.dry_run && matches!(suite, \"run-make\" | \"run-make-fulldeps\") {\n+            cmd.arg(\"--cc\")\n+                .arg(builder.cc(target))\n+                .arg(\"--cxx\")\n+                .arg(builder.cxx(target).unwrap())\n+                .arg(\"--cflags\")\n+                .arg(builder.cflags(target, GitRepo::Rustc).join(\" \"));\n+            copts_passed = true;\n+            if let Some(ar) = builder.ar(target) {\n+                cmd.arg(\"--ar\").arg(ar);\n+            }\n+        }\n+\n         if !llvm_components_passed {\n             cmd.arg(\"--llvm-components\").arg(\"\");\n         }"}]}