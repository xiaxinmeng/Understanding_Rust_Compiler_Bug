{"sha": "20f2497efd5e74bdbf775f8de144ed5c3e3394e8", "node_id": "MDY6Q29tbWl0NzI0NzEyOjIwZjI0OTdlZmQ1ZTc0YmRiZjc3NWY4ZGUxNDRlZDVjM2UzMzk0ZTg=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-02-21T13:27:22Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-02-21T13:27:22Z"}, "message": "Update CI scripts", "tree": {"sha": "0ee5313a18aa251d71a722f2592642b85caf4529", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0ee5313a18aa251d71a722f2592642b85caf4529"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/20f2497efd5e74bdbf775f8de144ed5c3e3394e8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/20f2497efd5e74bdbf775f8de144ed5c3e3394e8", "html_url": "https://github.com/rust-lang/rust/commit/20f2497efd5e74bdbf775f8de144ed5c3e3394e8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/20f2497efd5e74bdbf775f8de144ed5c3e3394e8/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8005092cf0dcb05665c7e7f06fa29dfb45d3c529", "url": "https://api.github.com/repos/rust-lang/rust/commits/8005092cf0dcb05665c7e7f06fa29dfb45d3c529", "html_url": "https://github.com/rust-lang/rust/commit/8005092cf0dcb05665c7e7f06fa29dfb45d3c529"}], "stats": {"total": 28, "additions": 26, "deletions": 2}, "files": [{"sha": "47cf1172d3659e17030a28942f3a465751e4fa26", "filename": "src/bootstrap/mk/Makefile.in", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/20f2497efd5e74bdbf775f8de144ed5c3e3394e8/src%2Fbootstrap%2Fmk%2FMakefile.in", "raw_url": "https://github.com/rust-lang/rust/raw/20f2497efd5e74bdbf775f8de144ed5c3e3394e8/src%2Fbootstrap%2Fmk%2FMakefile.in", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fmk%2FMakefile.in?ref=20f2497efd5e74bdbf775f8de144ed5c3e3394e8", "patch": "@@ -45,6 +45,10 @@ check-aux:\n \t\tsrc/tools/cargo \\\n \t\tsrc/tools/cargotest \\\n \t\t$(BOOTSTRAP_ARGS)\n+check-aux-and-gui: check-aux\n+\t$(Q)$(BOOTSTRAP) test --stage 2 \\\n+\t\tsrc/test/rustdoc-gui \\\n+\t\t$(BOOTSTRAP_ARGS)\n check-bootstrap:\n \t$(Q)$(CFG_PYTHON) $(CFG_SRC_DIR)src/bootstrap/bootstrap_test.py\n dist:"}, {"sha": "a5bedadc05b6170e3ef540b8a1ce99fbf777d983", "filename": "src/ci/docker/host-x86_64/x86_64-gnu-aux/Dockerfile", "status": "modified", "additions": 22, "deletions": 2, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/20f2497efd5e74bdbf775f8de144ed5c3e3394e8/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-aux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/20f2497efd5e74bdbf775f8de144ed5c3e3394e8/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-aux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-aux%2FDockerfile?ref=20f2497efd5e74bdbf775f8de144ed5c3e3394e8", "patch": "@@ -17,10 +17,30 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n   libgl1-mesa-dev \\\n   llvm-dev \\\n   libfreetype6-dev \\\n-  libexpat1-dev\n+  libexpat1-dev \\\n+  libexpat1-dev \\\n+  gnupg \\\n+  apt-utils \\\n+  wget \\\n+  fonts-ipafont-gothic \\\n+  fonts-wqy-zenhei \\\n+  fonts-thai-tlwg \\\n+  fonts-kacst \\\n+  fonts-freefont-ttf \\\n+  libxss1 \\\n+  libxtst6\n+\n+RUN curl -sL https://nodejs.org/dist/v14.4.0/node-v14.4.0-linux-x64.tar.xz | tar -xJ\n+ENV PATH=\"/node-v14.4.0-linux-x64/bin:${PATH}\"\n+\n+# Install required dependencies from browser-UI-test framework\n+# For now, we need to use `--unsafe-perm=true` to go around an issue when npm tries\n+# to create a new folder. For reference:\n+# https://github.com/puppeteer/puppeteer/issues/375\n+RUN npm install browser-ui-test -g --unsafe-perm=true\n \n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n ENV RUST_CONFIGURE_ARGS --build=x86_64-unknown-linux-gnu\n-ENV RUST_CHECK_TARGET check-aux\n+ENV RUST_CHECK_TARGET check-aux-and-gui"}]}