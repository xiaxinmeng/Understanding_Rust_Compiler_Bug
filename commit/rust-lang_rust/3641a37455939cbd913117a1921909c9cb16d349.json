{"sha": "3641a37455939cbd913117a1921909c9cb16d349", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM2NDFhMzc0NTU5MzljYmQ5MTMxMTdhMTkyMTkwOWM5Y2IxNmQzNDk=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2020-10-03T18:45:39Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2020-10-04T11:36:47Z"}, "message": "Enforce crate level attributes checks", "tree": {"sha": "2019101e8720950fa7ac2b4144ba28376c6dfd8f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2019101e8720950fa7ac2b4144ba28376c6dfd8f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3641a37455939cbd913117a1921909c9cb16d349", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3641a37455939cbd913117a1921909c9cb16d349", "html_url": "https://github.com/rust-lang/rust/commit/3641a37455939cbd913117a1921909c9cb16d349", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3641a37455939cbd913117a1921909c9cb16d349/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6ec247462257f86942ccbb6bc6977ad711889285", "url": "https://api.github.com/repos/rust-lang/rust/commits/6ec247462257f86942ccbb6bc6977ad711889285", "html_url": "https://github.com/rust-lang/rust/commit/6ec247462257f86942ccbb6bc6977ad711889285"}], "stats": {"total": 749, "additions": 377, "deletions": 372}, "files": [{"sha": "59955b273342071af14744a430eb512da2b8703c", "filename": "compiler/rustc_passes/src/check_attr.rs", "status": "modified", "additions": 31, "deletions": 3, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/3641a37455939cbd913117a1921909c9cb16d349/compiler%2Frustc_passes%2Fsrc%2Fcheck_attr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3641a37455939cbd913117a1921909c9cb16d349/compiler%2Frustc_passes%2Fsrc%2Fcheck_attr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Fcheck_attr.rs?ref=3641a37455939cbd913117a1921909c9cb16d349", "patch": "@@ -19,8 +19,8 @@ use rustc_hir::{\n use rustc_hir::{MethodKind, Target};\n use rustc_session::lint::builtin::{CONFLICTING_REPR_HINTS, UNUSED_ATTRIBUTES};\n use rustc_session::parse::feature_err;\n-use rustc_span::symbol::sym;\n-use rustc_span::Span;\n+use rustc_span::symbol::{sym, Symbol};\n+use rustc_span::{Span, DUMMY_SP};\n \n pub(crate) fn target_from_impl_item<'tcx>(\n     tcx: TyCtxt<'tcx>,\n@@ -821,17 +821,45 @@ fn is_c_like_enum(item: &Item<'_>) -> bool {\n     }\n }\n \n+fn check_invalid_crate_level_attr(tcx: TyCtxt<'_>, attrs: &[Attribute]) {\n+    const ATTRS_TO_CHECK: &[Symbol] = &[\n+        sym::macro_export,\n+        sym::repr,\n+        sym::path,\n+        sym::automatically_derived,\n+        sym::start,\n+        sym::main,\n+    ];\n+\n+    for attr in attrs {\n+        for attr_to_check in ATTRS_TO_CHECK {\n+            if tcx.sess.check_name(attr, *attr_to_check) {\n+                tcx.sess\n+                    .struct_span_err(\n+                        attr.span,\n+                        &format!(\n+                            \"`{}` attribute cannot be used at crate level\",\n+                            attr_to_check.to_ident_string()\n+                        ),\n+                    )\n+                    .emit();\n+            }\n+        }\n+    }\n+}\n+\n fn check_mod_attrs(tcx: TyCtxt<'_>, module_def_id: LocalDefId) {\n     tcx.hir()\n         .visit_item_likes_in_module(module_def_id, &mut CheckAttrVisitor { tcx }.as_deep_visitor());\n     if module_def_id.is_top_level_module() {\n         CheckAttrVisitor { tcx }.check_attributes(\n             CRATE_HIR_ID,\n             tcx.hir().krate_attrs(),\n-            &tcx.hir().span(CRATE_HIR_ID),\n+            &DUMMY_SP,\n             Target::Mod,\n             None,\n         );\n+        check_invalid_crate_level_attr(tcx, tcx.hir().krate_attrs());\n     }\n }\n "}, {"sha": "e87adb378e7f77fe3166b7952dcb06df89e609ff", "filename": "compiler/rustc_passes/src/entry.rs", "status": "modified", "additions": 26, "deletions": 18, "changes": 44, "blob_url": "https://github.com/rust-lang/rust/blob/3641a37455939cbd913117a1921909c9cb16d349/compiler%2Frustc_passes%2Fsrc%2Fentry.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3641a37455939cbd913117a1921909c9cb16d349/compiler%2Frustc_passes%2Fsrc%2Fentry.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Fentry.rs?ref=3641a37455939cbd913117a1921909c9cb16d349", "patch": "@@ -78,29 +78,38 @@ fn entry_fn(tcx: TyCtxt<'_>, cnum: CrateNum) -> Option<(LocalDefId, EntryFnType)\n // Beware, this is duplicated in `librustc_builtin_macros/test_harness.rs`\n // (with `ast::Item`), so make sure to keep them in sync.\n fn entry_point_type(sess: &Session, item: &Item<'_>, at_root: bool) -> EntryPointType {\n-    match item.kind {\n-        ItemKind::Fn(..) => {\n-            if sess.contains_name(&item.attrs, sym::start) {\n-                EntryPointType::Start\n-            } else if sess.contains_name(&item.attrs, sym::main) {\n-                EntryPointType::MainAttr\n-            } else if item.ident.name == sym::main {\n-                if at_root {\n-                    // This is a top-level function so can be `main`.\n-                    EntryPointType::MainNamed\n-                } else {\n-                    EntryPointType::OtherMain\n-                }\n-            } else {\n-                EntryPointType::None\n-            }\n+    if sess.contains_name(&item.attrs, sym::start) {\n+        EntryPointType::Start\n+    } else if sess.contains_name(&item.attrs, sym::main) {\n+        EntryPointType::MainAttr\n+    } else if item.ident.name == sym::main {\n+        if at_root {\n+            // This is a top-level function so can be `main`.\n+            EntryPointType::MainNamed\n+        } else {\n+            EntryPointType::OtherMain\n         }\n-        _ => EntryPointType::None,\n+    } else {\n+        EntryPointType::None\n     }\n }\n \n+fn throw_attr_err(sess: &Session, span: Span, attr: &str) {\n+    sess.struct_span_err(span, &format!(\"`{}` attribute can only be used on functions\", attr))\n+        .emit();\n+}\n+\n fn find_item(item: &Item<'_>, ctxt: &mut EntryContext<'_, '_>, at_root: bool) {\n     match entry_point_type(&ctxt.session, item, at_root) {\n+        EntryPointType::None => (),\n+        _ if !matches!(item.kind, ItemKind::Fn(..)) => {\n+            if let Some(attr) = ctxt.session.find_by_name(item.attrs, sym::start) {\n+                throw_attr_err(&ctxt.session, attr.span, \"start\");\n+            }\n+            if let Some(attr) = ctxt.session.find_by_name(item.attrs, sym::main) {\n+                throw_attr_err(&ctxt.session, attr.span, \"main\");\n+            }\n+        }\n         EntryPointType::MainNamed => {\n             if ctxt.main_fn.is_none() {\n                 ctxt.main_fn = Some((item.hir_id, item.span));\n@@ -137,7 +146,6 @@ fn find_item(item: &Item<'_>, ctxt: &mut EntryContext<'_, '_>, at_root: bool) {\n                     .emit();\n             }\n         }\n-        EntryPointType::None => (),\n     }\n }\n "}, {"sha": "3e899e00d11f1dae0e67eb6e4d93f0768726e26e", "filename": "compiler/rustc_session/src/lint/builtin.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3641a37455939cbd913117a1921909c9cb16d349/compiler%2Frustc_session%2Fsrc%2Flint%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3641a37455939cbd913117a1921909c9cb16d349/compiler%2Frustc_session%2Fsrc%2Flint%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_session%2Fsrc%2Flint%2Fbuiltin.rs?ref=3641a37455939cbd913117a1921909c9cb16d349", "patch": "@@ -518,7 +518,7 @@ declare_lint! {\n     /// ### Example\n     ///\n     /// ```rust\n-    /// #![macro_export]\n+    /// #![ignore]\n     /// ```\n     ///\n     /// {{produces}}"}, {"sha": "309d0bc4d43030cef50455fbc79d8d59fa076ef5", "filename": "src/test/rustdoc-ui/doc-alias-crate-level.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/3641a37455939cbd913117a1921909c9cb16d349/src%2Ftest%2Frustdoc-ui%2Fdoc-alias-crate-level.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3641a37455939cbd913117a1921909c9cb16d349/src%2Ftest%2Frustdoc-ui%2Fdoc-alias-crate-level.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fdoc-alias-crate-level.rs?ref=3641a37455939cbd913117a1921909c9cb16d349", "patch": "@@ -1,3 +1,6 @@\n #![feature(doc_alias)]\n \n-#![doc(alias = \"shouldn't work!\")] //~ ERROR\n+#![doc(alias = \"crate-level-not-working\")] //~ ERROR\n+\n+#[doc(alias = \"shouldn't work!\")] //~ ERROR\n+pub fn foo() {}"}, {"sha": "fc14266cd714c608a5d1ca3f49e418ab7dd2e3d7", "filename": "src/test/rustdoc-ui/doc-alias-crate-level.stderr", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/3641a37455939cbd913117a1921909c9cb16d349/src%2Ftest%2Frustdoc-ui%2Fdoc-alias-crate-level.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3641a37455939cbd913117a1921909c9cb16d349/src%2Ftest%2Frustdoc-ui%2Fdoc-alias-crate-level.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fdoc-alias-crate-level.stderr?ref=3641a37455939cbd913117a1921909c9cb16d349", "patch": "@@ -1,8 +1,14 @@\n+error: '\\'' character isn't allowed in `#[doc(alias = \"...\")]`\n+  --> $DIR/doc-alias-crate-level.rs:5:7\n+   |\n+LL | #[doc(alias = \"shouldn't work!\")]\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n error: `#![doc(alias = \"...\")]` isn't allowed as a crate level attribute\n   --> $DIR/doc-alias-crate-level.rs:3:8\n    |\n-LL | #![doc(alias = \"shouldn't work!\")]\n-   |        ^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL | #![doc(alias = \"crate-level-not-working\")]\n+   |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-error: aborting due to previous error\n+error: aborting due to 2 previous errors\n "}, {"sha": "45756d6a04bd05b8318e6679649771eb46b3ad53", "filename": "src/test/ui/doc-alias-crate-level.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3641a37455939cbd913117a1921909c9cb16d349/src%2Ftest%2Fui%2Fdoc-alias-crate-level.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3641a37455939cbd913117a1921909c9cb16d349/src%2Ftest%2Fui%2Fdoc-alias-crate-level.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdoc-alias-crate-level.stderr?ref=3641a37455939cbd913117a1921909c9cb16d349", "patch": "@@ -1,4 +1,4 @@\n-error: `#![doc(alias = \"...\")]` isn't allowed as a crate level attribute\n+error: '\\'' character isn't allowed in `#[doc(alias = \"...\")]`\n   --> $DIR/doc-alias-crate-level.rs:7:8\n    |\n LL | #![doc(alias = \"shouldn't work!\")]"}, {"sha": "6404b2c3115cbf023b3efe3e326834a5ca7ec5b3", "filename": "src/test/ui/feature-gate/issue-43106-gating-of-builtin-attrs-error.rs", "status": "modified", "additions": 45, "deletions": 9, "changes": 54, "blob_url": "https://github.com/rust-lang/rust/blob/3641a37455939cbd913117a1921909c9cb16d349/src%2Ftest%2Fui%2Ffeature-gate%2Fissue-43106-gating-of-builtin-attrs-error.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3641a37455939cbd913117a1921909c9cb16d349/src%2Ftest%2Fui%2Ffeature-gate%2Fissue-43106-gating-of-builtin-attrs-error.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gate%2Fissue-43106-gating-of-builtin-attrs-error.rs?ref=3641a37455939cbd913117a1921909c9cb16d349", "patch": "@@ -1,3 +1,6 @@\n+//~ NOTE: not an `extern crate` item\n+//~^ NOTE: not a function or static\n+//~^^ NOTE: not a function or closure\n // This is testing whether various builtin attributes signals an\n // error or warning when put in \"weird\" places.\n //\n@@ -7,22 +10,19 @@\n \n // ignore-tidy-linelength\n \n-#![deny(unused_attributes)]\n-//~^ NOTE not a function or static\n-//~^^ NOTE the lint level is defined here\n-//~^^^ NOTE not an `extern crate` item\n-//~^^^^ NOTE not a function or static\n-//~^^^^^ NOTE not a function or closure\n-\n #![macro_export]\n+//~^ ERROR: `macro_export` attribute cannot be used at crate level\n #![main]\n+//~^ ERROR: `main` attribute cannot be used at crate level\n #![start]\n+//~^ ERROR: `start` attribute cannot be used at crate level\n #![repr()]\n+//~^ ERROR: `repr` attribute cannot be used at crate level\n #![path = \"3800\"]\n+//~^ ERROR: `path` attribute cannot be used at crate level\n #![automatically_derived]\n+//~^ ERROR: `automatically_derived` attribute cannot be used at crate level\n #![no_mangle]\n-//~^ ERROR attribute should be applied to a function or static\n-//~^^ WARN\n #![no_link]\n //~^ ERROR: attribute should be applied to an `extern crate` item\n #![export_name = \"2200\"]\n@@ -107,4 +107,40 @@ mod export_name {\n     //~| NOTE not a function or static\n }\n \n+#[main]\n+//~^ ERROR: `main` attribute can only be used on functions\n+mod main {\n+    mod inner { #![main] }\n+    //~^ ERROR: `main` attribute can only be used on functions\n+\n+    // for `fn f()` case, see feature-gate-main.rs\n+\n+    #[main] struct S;\n+    //~^ ERROR: `main` attribute can only be used on functions\n+\n+    #[main] type T = S;\n+    //~^ ERROR: `main` attribute can only be used on functions\n+\n+    #[main] impl S { }\n+    //~^ ERROR: `main` attribute can only be used on functions\n+}\n+\n+#[start]\n+//~^ ERROR: `start` attribute can only be used on functions\n+mod start {\n+    mod inner { #![start] }\n+    //~^ ERROR: `start` attribute can only be used on functions\n+\n+    // for `fn f()` case, see feature-gate-start.rs\n+\n+    #[start] struct S;\n+    //~^ ERROR: `start` attribute can only be used on functions\n+\n+    #[start] type T = S;\n+    //~^ ERROR: `start` attribute can only be used on functions\n+\n+    #[start] impl S { }\n+    //~^ ERROR: `start` attribute can only be used on functions\n+}\n+\n fn main() {}"}, {"sha": "3ca1bd2ea7e48c7bf64ff69d61f8c7c97065f244", "filename": "src/test/ui/feature-gate/issue-43106-gating-of-builtin-attrs-error.stderr", "status": "modified", "additions": 103, "deletions": 56, "changes": 159, "blob_url": "https://github.com/rust-lang/rust/blob/3641a37455939cbd913117a1921909c9cb16d349/src%2Ftest%2Fui%2Ffeature-gate%2Fissue-43106-gating-of-builtin-attrs-error.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3641a37455939cbd913117a1921909c9cb16d349/src%2Ftest%2Fui%2Ffeature-gate%2Fissue-43106-gating-of-builtin-attrs-error.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gate%2Fissue-43106-gating-of-builtin-attrs-error.stderr?ref=3641a37455939cbd913117a1921909c9cb16d349", "patch": "@@ -8,6 +8,66 @@ LL |     #[inline = \"2100\"] fn f() { }\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n    = note: for more information, see issue #57571 <https://github.com/rust-lang/rust/issues/57571>\n \n+error: `main` attribute can only be used on functions\n+  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:110:1\n+   |\n+LL | #[main]\n+   | ^^^^^^^\n+\n+error: `main` attribute can only be used on functions\n+  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:113:17\n+   |\n+LL |     mod inner { #![main] }\n+   |                 ^^^^^^^^\n+\n+error: `main` attribute can only be used on functions\n+  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:118:5\n+   |\n+LL |     #[main] struct S;\n+   |     ^^^^^^^\n+\n+error: `main` attribute can only be used on functions\n+  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:121:5\n+   |\n+LL |     #[main] type T = S;\n+   |     ^^^^^^^\n+\n+error: `main` attribute can only be used on functions\n+  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:124:5\n+   |\n+LL |     #[main] impl S { }\n+   |     ^^^^^^^\n+\n+error: `start` attribute can only be used on functions\n+  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:128:1\n+   |\n+LL | #[start]\n+   | ^^^^^^^^\n+\n+error: `start` attribute can only be used on functions\n+  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:131:17\n+   |\n+LL |     mod inner { #![start] }\n+   |                 ^^^^^^^^^\n+\n+error: `start` attribute can only be used on functions\n+  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:136:5\n+   |\n+LL |     #[start] struct S;\n+   |     ^^^^^^^^\n+\n+error: `start` attribute can only be used on functions\n+  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:139:5\n+   |\n+LL |     #[start] type T = S;\n+   |     ^^^^^^^^\n+\n+error: `start` attribute can only be used on functions\n+  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:142:5\n+   |\n+LL |     #[start] impl S { }\n+   |     ^^^^^^^^\n+\n error[E0518]: attribute should be applied to function or closure\n   --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:32:1\n    |\n@@ -53,72 +113,59 @@ LL | |\n LL | | }\n    | |_- not a function or static\n \n-error: attribute should be applied to a function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:23:1\n-   |\n-LL | / #![deny(unused_attributes)]\n-LL | |\n-LL | |\n-LL | |\n-...  |\n-LL | | #![no_mangle]\n-   | | ^^^^^^^^^^^^^\n-...  |\n-LL | |\n-LL | | fn main() {}\n-   | |____________- not a function or static\n-   |\n-note: the lint level is defined here\n-  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:10:9\n-   |\n-LL | #![deny(unused_attributes)]\n-   |         ^^^^^^^^^^^^^^^^^\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-\n error: attribute should be applied to an `extern crate` item\n   --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:26:1\n    |\n-LL | / #![deny(unused_attributes)]\n-LL | |\n-LL | |\n-LL | |\n-...  |\n-LL | | #![no_link]\n-   | | ^^^^^^^^^^^\n-...  |\n-LL | |\n-LL | | fn main() {}\n-   | |____________- not an `extern crate` item\n+LL | #![no_link]\n+   | ^^^^^^^^^^^\n \n error: attribute should be applied to a function or static\n   --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:28:1\n    |\n-LL | / #![deny(unused_attributes)]\n-LL | |\n-LL | |\n-LL | |\n-...  |\n-LL | | #![export_name = \"2200\"]\n-   | | ^^^^^^^^^^^^^^^^^^^^^^^^\n-...  |\n-LL | |\n-LL | | fn main() {}\n-   | |____________- not a function or static\n+LL | #![export_name = \"2200\"]\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^\n \n error[E0518]: attribute should be applied to function or closure\n   --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:30:1\n    |\n-LL | / #![deny(unused_attributes)]\n-LL | |\n-LL | |\n-LL | |\n-...  |\n-LL | | #![inline]\n-   | | ^^^^^^^^^^\n-...  |\n-LL | |\n-LL | | fn main() {}\n-   | |____________- not a function or closure\n+LL | #![inline]\n+   | ^^^^^^^^^^\n+\n+error: `macro_export` attribute cannot be used at crate level\n+  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:13:1\n+   |\n+LL | #![macro_export]\n+   | ^^^^^^^^^^^^^^^^\n+\n+error: `main` attribute cannot be used at crate level\n+  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:15:1\n+   |\n+LL | #![main]\n+   | ^^^^^^^^\n+\n+error: `start` attribute cannot be used at crate level\n+  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:17:1\n+   |\n+LL | #![start]\n+   | ^^^^^^^^^\n+\n+error: `repr` attribute cannot be used at crate level\n+  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:19:1\n+   |\n+LL | #![repr()]\n+   | ^^^^^^^^^^\n+\n+error: `path` attribute cannot be used at crate level\n+  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:21:1\n+   |\n+LL | #![path = \"3800\"]\n+   | ^^^^^^^^^^^^^^^^^\n+\n+error: `automatically_derived` attribute cannot be used at crate level\n+  --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:23:1\n+   |\n+LL | #![automatically_derived]\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error[E0518]: attribute should be applied to function or closure\n   --> $DIR/issue-43106-gating-of-builtin-attrs-error.rs:37:17\n@@ -198,6 +245,6 @@ error: attribute should be applied to a function or static\n LL |     #[export_name = \"2200\"] impl S { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^^ ---------- not a function or static\n \n-error: aborting due to 21 previous errors\n+error: aborting due to 36 previous errors\n \n For more information about this error, try `rustc --explain E0518`."}, {"sha": "aba6c08f41dae4a9c232aea56285b7c8c740ed98", "filename": "src/test/ui/feature-gate/issue-43106-gating-of-builtin-attrs.rs", "status": "modified", "additions": 3, "deletions": 39, "changes": 42, "blob_url": "https://github.com/rust-lang/rust/blob/3641a37455939cbd913117a1921909c9cb16d349/src%2Ftest%2Fui%2Ffeature-gate%2Fissue-43106-gating-of-builtin-attrs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3641a37455939cbd913117a1921909c9cb16d349/src%2Ftest%2Fui%2Ffeature-gate%2Fissue-43106-gating-of-builtin-attrs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gate%2Fissue-43106-gating-of-builtin-attrs.rs?ref=3641a37455939cbd913117a1921909c9cb16d349", "patch": "@@ -1,3 +1,6 @@\n+//~ NOTE not a function\n+//~^ NOTE not a foreign function or static\n+//~^^ NOTE not a function or static\n // This test enumerates as many compiler-builtin ungated attributes as\n // possible (that is, all the mutually compatible ones), and checks\n // that we get \"expected\" (*) warnings for each in the various weird\n@@ -34,9 +37,6 @@\n // ignore-tidy-linelength\n \n #![feature(test, plugin_registrar)]\n-//~^ NOTE not a function\n-//~^^ NOTE not a foreign function or static\n-//~^^^ NOTE not a function or static\n #![warn(unused_attributes, unknown_lints)]\n //~^ NOTE the lint level is defined here\n //~| NOTE the lint level is defined here\n@@ -249,42 +249,6 @@ mod plugin_registrar {\n     //~| HELP may be removed in a future compiler version\n }\n \n-#[main]\n-//~^ WARN unused attribute\n-mod main {\n-    mod inner { #![main] }\n-    //~^ WARN unused attribute\n-\n-    // for `fn f()` case, see feature-gate-main.rs\n-\n-    #[main] struct S;\n-    //~^ WARN unused attribute\n-\n-    #[main] type T = S;\n-    //~^ WARN unused attribute\n-\n-    #[main] impl S { }\n-    //~^ WARN unused attribute\n-}\n-\n-#[start]\n-//~^ WARN unused attribute\n-mod start {\n-    mod inner { #![start] }\n-    //~^ WARN unused attribute\n-\n-    // for `fn f()` case, see feature-gate-start.rs\n-\n-    #[start] struct S;\n-    //~^ WARN unused attribute\n-\n-    #[start] type T = S;\n-    //~^ WARN unused attribute\n-\n-    #[start] impl S { }\n-    //~^ WARN unused attribute\n-}\n-\n // At time of unit test authorship, if compiling without `--test` then\n // non-crate-level #[test] attributes seem to be ignored.\n "}, {"sha": "ef9c9ef48a8093ef47d0dd0e456d4d42c5214ac6", "filename": "src/test/ui/feature-gate/issue-43106-gating-of-builtin-attrs.stderr", "status": "modified", "additions": 154, "deletions": 241, "changes": 395, "blob_url": "https://github.com/rust-lang/rust/blob/3641a37455939cbd913117a1921909c9cb16d349/src%2Ftest%2Fui%2Ffeature-gate%2Fissue-43106-gating-of-builtin-attrs.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3641a37455939cbd913117a1921909c9cb16d349/src%2Ftest%2Fui%2Ffeature-gate%2Fissue-43106-gating-of-builtin-attrs.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gate%2Fissue-43106-gating-of-builtin-attrs.stderr?ref=3641a37455939cbd913117a1921909c9cb16d349", "patch": "@@ -173,13 +173,13 @@ LL |     #[deny(x5100)] impl S { }\n    |            ^^^^^\n \n warning: `#[macro_escape]` is a deprecated synonym for `#[macro_use]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:474:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:438:1\n    |\n LL | #[macro_escape]\n    | ^^^^^^^^^^^^^^^\n \n warning: `#[macro_escape]` is a deprecated synonym for `#[macro_use]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:477:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:441:17\n    |\n LL |     mod inner { #![macro_escape] }\n    |                 ^^^^^^^^^^^^^^^^\n@@ -237,7 +237,7 @@ LL | #![no_start]\n    | ^^^^^^^^^^^^ help: remove this attribute\n \n warning: attribute should be applied to a function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:369:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:333:1\n    |\n LL |   #[no_mangle]\n    |   ^^^^^^^^^^^^\n@@ -259,7 +259,7 @@ LL | #![warn(unused_attributes, unknown_lints)]\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a function\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:536:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:500:1\n    |\n LL |   #[cold]\n    |   ^^^^^^^\n@@ -276,7 +276,7 @@ LL | | }\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a foreign function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:565:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:529:1\n    |\n LL |   #[link_name = \"1900\"]\n    |   ^^^^^^^^^^^^^^^^^^^^^\n@@ -293,7 +293,7 @@ LL | | }\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:604:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:568:1\n    |\n LL |   #[link_section = \"1800\"]\n    |   ^^^^^^^^^^^^^^^^^^^^^^^^\n@@ -312,120 +312,93 @@ LL | | }\n warning: attribute should be applied to a function\n   --> $DIR/issue-43106-gating-of-builtin-attrs.rs:69:1\n    |\n-LL | / #![feature(test, plugin_registrar)]\n-LL | |\n-LL | |\n-LL | |\n-...  |\n-LL | | #![cold]\n-   | | ^^^^^^^^\n-...  |\n-LL | |\n-LL | | fn main() {}\n-   | |____________- not a function\n+LL | #![cold]\n+   | ^^^^^^^^\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a foreign function or static\n   --> $DIR/issue-43106-gating-of-builtin-attrs.rs:73:1\n    |\n-LL | / #![feature(test, plugin_registrar)]\n-LL | |\n-LL | |\n-LL | |\n-...  |\n-LL | | #![link_name = \"1900\"]\n-   | | ^^^^^^^^^^^^^^^^^^^^^^\n-...  |\n-LL | |\n-LL | | fn main() {}\n-   | |____________- not a foreign function or static\n+LL | #![link_name = \"1900\"]\n+   | ^^^^^^^^^^^^^^^^^^^^^^\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a function or static\n   --> $DIR/issue-43106-gating-of-builtin-attrs.rs:76:1\n    |\n-LL | / #![feature(test, plugin_registrar)]\n-LL | |\n-LL | |\n-LL | |\n-...  |\n-LL | | #![link_section = \"1800\"]\n-   | | ^^^^^^^^^^^^^^^^^^^^^^^^^\n-...  |\n-LL | |\n-LL | | fn main() {}\n-   | |____________- not a function or static\n+LL | #![link_section = \"1800\"]\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:374:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:338:17\n    |\n LL |     mod inner { #![no_mangle] }\n    |     ------------^^^^^^^^^^^^^-- not a function or static\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:381:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:345:5\n    |\n LL |     #[no_mangle] struct S;\n    |     ^^^^^^^^^^^^ --------- not a function or static\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:386:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:350:5\n    |\n LL |     #[no_mangle] type T = S;\n    |     ^^^^^^^^^^^^ ----------- not a function or static\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:391:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:355:5\n    |\n LL |     #[no_mangle] impl S { }\n    |     ^^^^^^^^^^^^ ---------- not a function or static\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a function\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:542:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:506:17\n    |\n LL |     mod inner { #![cold] }\n    |     ------------^^^^^^^^-- not a function\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a function\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:549:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:513:5\n    |\n LL |     #[cold] struct S;\n    |     ^^^^^^^ --------- not a function\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a function\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:554:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:518:5\n    |\n LL |     #[cold] type T = S;\n    |     ^^^^^^^ ----------- not a function\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a function\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:559:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:523:5\n    |\n LL |     #[cold] impl S { }\n    |     ^^^^^^^ ---------- not a function\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a foreign function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:571:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:535:5\n    |\n LL |     #[link_name = \"1900\"]\n    |     ^^^^^^^^^^^^^^^^^^^^^\n@@ -435,77 +408,77 @@ LL |     extern { }\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n help: try `#[link(name = \"1900\")]` instead\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:571:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:535:5\n    |\n LL |     #[link_name = \"1900\"]\n    |     ^^^^^^^^^^^^^^^^^^^^^\n \n warning: attribute should be applied to a foreign function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:578:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:542:17\n    |\n LL |     mod inner { #![link_name=\"1900\"] }\n    |     ------------^^^^^^^^^^^^^^^^^^^^-- not a foreign function or static\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a foreign function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:583:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:547:5\n    |\n LL |     #[link_name = \"1900\"] fn f() { }\n    |     ^^^^^^^^^^^^^^^^^^^^^ ---------- not a foreign function or static\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a foreign function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:588:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:552:5\n    |\n LL |     #[link_name = \"1900\"] struct S;\n    |     ^^^^^^^^^^^^^^^^^^^^^ --------- not a foreign function or static\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a foreign function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:593:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:557:5\n    |\n LL |     #[link_name = \"1900\"] type T = S;\n    |     ^^^^^^^^^^^^^^^^^^^^^ ----------- not a foreign function or static\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a foreign function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:598:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:562:5\n    |\n LL |     #[link_name = \"1900\"] impl S { }\n    |     ^^^^^^^^^^^^^^^^^^^^^ ---------- not a foreign function or static\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:610:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:574:17\n    |\n LL |     mod inner { #![link_section=\"1800\"] }\n    |     ------------^^^^^^^^^^^^^^^^^^^^^^^-- not a function or static\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:617:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:581:5\n    |\n LL |     #[link_section = \"1800\"] struct S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^ --------- not a function or static\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:622:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:586:5\n    |\n LL |     #[link_section = \"1800\"] type T = S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^ ----------- not a function or static\n    |\n    = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n \n warning: attribute should be applied to a function or static\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:627:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:591:5\n    |\n LL |     #[link_section = \"1800\"] impl S { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^ ---------- not a function or static\n@@ -611,793 +584,733 @@ LL | #[plugin_registrar]\n    | ^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:255:17\n-   |\n-LL |     mod inner { #![main] }\n-   |                 ^^^^^^^^\n-\n-warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:260:5\n-   |\n-LL |     #[main] struct S;\n-   |     ^^^^^^^\n-\n-warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:263:5\n-   |\n-LL |     #[main] type T = S;\n-   |     ^^^^^^^\n-\n-warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:266:5\n-   |\n-LL |     #[main] impl S { }\n-   |     ^^^^^^^\n-\n-warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:252:1\n-   |\n-LL | #[main]\n-   | ^^^^^^^\n-\n-warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:273:17\n-   |\n-LL |     mod inner { #![start] }\n-   |                 ^^^^^^^^^\n-\n-warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:278:5\n-   |\n-LL |     #[start] struct S;\n-   |     ^^^^^^^^\n-\n-warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:281:5\n-   |\n-LL |     #[start] type T = S;\n-   |     ^^^^^^^^\n-\n-warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:284:5\n-   |\n-LL |     #[start] impl S { }\n-   |     ^^^^^^^^\n-\n-warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:270:1\n-   |\n-LL | #[start]\n-   | ^^^^^^^^\n-\n-warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:337:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:301:5\n    |\n LL |     #[path = \"3800\"] fn f() { }\n    |     ^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:340:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:304:5\n    |\n LL |     #[path = \"3800\"]  struct S;\n    |     ^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:343:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:307:5\n    |\n LL |     #[path = \"3800\"] type T = S;\n    |     ^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:346:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:310:5\n    |\n LL |     #[path = \"3800\"] impl S { }\n    |     ^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:353:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:317:17\n    |\n LL |     mod inner { #![automatically_derived] }\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:356:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:320:5\n    |\n LL |     #[automatically_derived] fn f() { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:359:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:323:5\n    |\n LL |     #[automatically_derived] struct S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:362:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:326:5\n    |\n LL |     #[automatically_derived] type T = S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:365:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:329:5\n    |\n LL |     #[automatically_derived] impl S { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:350:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:314:1\n    |\n LL | #[automatically_derived]\n    | ^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:400:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:364:17\n    |\n LL |     mod inner { #![should_panic] }\n    |                 ^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:403:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:367:5\n    |\n LL |     #[should_panic] fn f() { }\n    |     ^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:406:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:370:5\n    |\n LL |     #[should_panic] struct S;\n    |     ^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:409:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:373:5\n    |\n LL |     #[should_panic] type T = S;\n    |     ^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:412:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:376:5\n    |\n LL |     #[should_panic] impl S { }\n    |     ^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:397:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:361:1\n    |\n LL | #[should_panic]\n    | ^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:419:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:383:17\n    |\n LL |     mod inner { #![ignore] }\n    |                 ^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:422:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:386:5\n    |\n LL |     #[ignore] fn f() { }\n    |     ^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:425:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:389:5\n    |\n LL |     #[ignore] struct S;\n    |     ^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:428:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:392:5\n    |\n LL |     #[ignore] type T = S;\n    |     ^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:431:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:395:5\n    |\n LL |     #[ignore] impl S { }\n    |     ^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:416:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:380:1\n    |\n LL | #[ignore]\n    | ^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:438:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:402:17\n    |\n LL |     mod inner { #![no_implicit_prelude] }\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:441:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:405:5\n    |\n LL |     #[no_implicit_prelude] fn f() { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:444:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:408:5\n    |\n LL |     #[no_implicit_prelude] struct S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:447:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:411:5\n    |\n LL |     #[no_implicit_prelude] type T = S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:450:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:414:5\n    |\n LL |     #[no_implicit_prelude] impl S { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:435:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:399:1\n    |\n LL | #[no_implicit_prelude]\n    | ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:457:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:421:17\n    |\n LL |     mod inner { #![reexport_test_harness_main=\"2900\"] }\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:460:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:424:5\n    |\n LL |     #[reexport_test_harness_main = \"2900\"] fn f() { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:463:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:427:5\n    |\n LL |     #[reexport_test_harness_main = \"2900\"] struct S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:466:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:430:5\n    |\n LL |     #[reexport_test_harness_main = \"2900\"] type T = S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:469:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:433:5\n    |\n LL |     #[reexport_test_harness_main = \"2900\"] impl S { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:454:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:418:1\n    |\n LL | #[reexport_test_harness_main = \"2900\"]\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:481:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:445:5\n    |\n LL |     #[macro_escape] fn f() { }\n    |     ^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:484:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:448:5\n    |\n LL |     #[macro_escape] struct S;\n    |     ^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:487:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:451:5\n    |\n LL |     #[macro_escape] type T = S;\n    |     ^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:490:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:454:5\n    |\n LL |     #[macro_escape] impl S { }\n    |     ^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:498:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:462:17\n    |\n LL |     mod inner { #![no_std] }\n    |                 ^^^^^^^^^^\n \n warning: crate-level attribute should be in the root module\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:498:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:462:17\n    |\n LL |     mod inner { #![no_std] }\n    |                 ^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:502:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:466:5\n    |\n LL |     #[no_std] fn f() { }\n    |     ^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:502:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:466:5\n    |\n LL |     #[no_std] fn f() { }\n    |     ^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:506:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:470:5\n    |\n LL |     #[no_std] struct S;\n    |     ^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:506:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:470:5\n    |\n LL |     #[no_std] struct S;\n    |     ^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:510:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:474:5\n    |\n LL |     #[no_std] type T = S;\n    |     ^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:510:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:474:5\n    |\n LL |     #[no_std] type T = S;\n    |     ^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:514:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:478:5\n    |\n LL |     #[no_std] impl S { }\n    |     ^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:514:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:478:5\n    |\n LL |     #[no_std] impl S { }\n    |     ^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:494:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:458:1\n    |\n LL | #[no_std]\n    | ^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:494:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:458:1\n    |\n LL | #[no_std]\n    | ^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:699:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:663:17\n    |\n LL |     mod inner { #![crate_name=\"0900\"] }\n    |                 ^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be in the root module\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:699:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:663:17\n    |\n LL |     mod inner { #![crate_name=\"0900\"] }\n    |                 ^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:703:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:667:5\n    |\n LL |     #[crate_name = \"0900\"] fn f() { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:703:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:667:5\n    |\n LL |     #[crate_name = \"0900\"] fn f() { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:707:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:671:5\n    |\n LL |     #[crate_name = \"0900\"] struct S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:707:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:671:5\n    |\n LL |     #[crate_name = \"0900\"] struct S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:711:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:675:5\n    |\n LL |     #[crate_name = \"0900\"] type T = S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:711:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:675:5\n    |\n LL |     #[crate_name = \"0900\"] type T = S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:715:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:679:5\n    |\n LL |     #[crate_name = \"0900\"] impl S { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:715:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:679:5\n    |\n LL |     #[crate_name = \"0900\"] impl S { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:695:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:659:1\n    |\n LL | #[crate_name = \"0900\"]\n    | ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:695:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:659:1\n    |\n LL | #[crate_name = \"0900\"]\n    | ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:724:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:688:17\n    |\n LL |     mod inner { #![crate_type=\"0800\"] }\n    |                 ^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be in the root module\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:724:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:688:17\n    |\n LL |     mod inner { #![crate_type=\"0800\"] }\n    |                 ^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:728:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:692:5\n    |\n LL |     #[crate_type = \"0800\"] fn f() { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:728:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:692:5\n    |\n LL |     #[crate_type = \"0800\"] fn f() { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:732:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:696:5\n    |\n LL |     #[crate_type = \"0800\"] struct S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:732:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:696:5\n    |\n LL |     #[crate_type = \"0800\"] struct S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:736:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:700:5\n    |\n LL |     #[crate_type = \"0800\"] type T = S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:736:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:700:5\n    |\n LL |     #[crate_type = \"0800\"] type T = S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:740:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:704:5\n    |\n LL |     #[crate_type = \"0800\"] impl S { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:740:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:704:5\n    |\n LL |     #[crate_type = \"0800\"] impl S { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:720:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:684:1\n    |\n LL | #[crate_type = \"0800\"]\n    | ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:720:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:684:1\n    |\n LL | #[crate_type = \"0800\"]\n    | ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:749:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:713:17\n    |\n LL |     mod inner { #![feature(x0600)] }\n    |                 ^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be in the root module\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:749:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:713:17\n    |\n LL |     mod inner { #![feature(x0600)] }\n    |                 ^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:753:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:717:5\n    |\n LL |     #[feature(x0600)] fn f() { }\n    |     ^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:753:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:717:5\n    |\n LL |     #[feature(x0600)] fn f() { }\n    |     ^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:757:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:721:5\n    |\n LL |     #[feature(x0600)] struct S;\n    |     ^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:757:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:721:5\n    |\n LL |     #[feature(x0600)] struct S;\n    |     ^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:761:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:725:5\n    |\n LL |     #[feature(x0600)] type T = S;\n    |     ^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:761:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:725:5\n    |\n LL |     #[feature(x0600)] type T = S;\n    |     ^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:765:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:729:5\n    |\n LL |     #[feature(x0600)] impl S { }\n    |     ^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:765:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:729:5\n    |\n LL |     #[feature(x0600)] impl S { }\n    |     ^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:745:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:709:1\n    |\n LL | #[feature(x0600)]\n    | ^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:745:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:709:1\n    |\n LL | #[feature(x0600)]\n    | ^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:775:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:739:17\n    |\n LL |     mod inner { #![no_main] }\n    |                 ^^^^^^^^^^^\n \n warning: crate-level attribute should be in the root module\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:775:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:739:17\n    |\n LL |     mod inner { #![no_main] }\n    |                 ^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:779:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:743:5\n    |\n LL |     #[no_main] fn f() { }\n    |     ^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:779:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:743:5\n    |\n LL |     #[no_main] fn f() { }\n    |     ^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:783:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:747:5\n    |\n LL |     #[no_main] struct S;\n    |     ^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:783:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:747:5\n    |\n LL |     #[no_main] struct S;\n    |     ^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:787:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:751:5\n    |\n LL |     #[no_main] type T = S;\n    |     ^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:787:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:751:5\n    |\n LL |     #[no_main] type T = S;\n    |     ^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:791:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:755:5\n    |\n LL |     #[no_main] impl S { }\n    |     ^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:791:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:755:5\n    |\n LL |     #[no_main] impl S { }\n    |     ^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:771:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:735:1\n    |\n LL | #[no_main]\n    | ^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:771:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:735:1\n    |\n LL | #[no_main]\n    | ^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:813:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:777:17\n    |\n LL |     mod inner { #![recursion_limit=\"0200\"] }\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be in the root module\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:813:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:777:17\n    |\n LL |     mod inner { #![recursion_limit=\"0200\"] }\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:817:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:781:5\n    |\n LL |     #[recursion_limit=\"0200\"] fn f() { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:817:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:781:5\n    |\n LL |     #[recursion_limit=\"0200\"] fn f() { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:821:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:785:5\n    |\n LL |     #[recursion_limit=\"0200\"] struct S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:821:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:785:5\n    |\n LL |     #[recursion_limit=\"0200\"] struct S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:825:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:789:5\n    |\n LL |     #[recursion_limit=\"0200\"] type T = S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:825:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:789:5\n    |\n LL |     #[recursion_limit=\"0200\"] type T = S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:829:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:793:5\n    |\n LL |     #[recursion_limit=\"0200\"] impl S { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:829:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:793:5\n    |\n LL |     #[recursion_limit=\"0200\"] impl S { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:809:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:773:1\n    |\n LL | #[recursion_limit=\"0200\"]\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:809:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:773:1\n    |\n LL | #[recursion_limit=\"0200\"]\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:838:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:802:17\n    |\n LL |     mod inner { #![type_length_limit=\"0100\"] }\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be in the root module\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:838:17\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:802:17\n    |\n LL |     mod inner { #![type_length_limit=\"0100\"] }\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:842:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:806:5\n    |\n LL |     #[type_length_limit=\"0100\"] fn f() { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:842:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:806:5\n    |\n LL |     #[type_length_limit=\"0100\"] fn f() { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:846:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:810:5\n    |\n LL |     #[type_length_limit=\"0100\"] struct S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:846:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:810:5\n    |\n LL |     #[type_length_limit=\"0100\"] struct S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:850:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:814:5\n    |\n LL |     #[type_length_limit=\"0100\"] type T = S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:850:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:814:5\n    |\n LL |     #[type_length_limit=\"0100\"] type T = S;\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:854:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:818:5\n    |\n LL |     #[type_length_limit=\"0100\"] impl S { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:854:5\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:818:5\n    |\n LL |     #[type_length_limit=\"0100\"] impl S { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused attribute\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:834:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:798:1\n    |\n LL | #[type_length_limit=\"0100\"]\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`\n-  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:834:1\n+  --> $DIR/issue-43106-gating-of-builtin-attrs.rs:798:1\n    |\n LL | #[type_length_limit=\"0100\"]\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n@@ -1426,5 +1339,5 @@ warning: unused attribute\n LL | #![proc_macro_derive()]\n    | ^^^^^^^^^^^^^^^^^^^^^^^\n \n-warning: 215 warnings emitted\n+warning: 205 warnings emitted\n "}]}