{"sha": "b9b8f5b44469c9050989b044d76a07969f320882", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI5YjhmNWI0NDQ2OWM5MDUwOTg5YjA0NGQ3NmEwNzk2OWYzMjA4ODI=", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2021-08-10T19:18:41Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-08-10T19:18:41Z"}, "message": "Rollup merge of #87865 - tsoutsman:master, r=GuillaumeGomez\n\nClarify terms in rustdoc book\n\nFixes #70898\n\nI chose to completely remove the term directive over attribute because rustdoc has a lint called `invalid_codeblock_attributes` and the term attributes is used throughout the book. I slightly changed the introductory sentence to describe the relationship between annotations and attributes.\n\nI also moved the text explaining the example from below the blocks to above the blocks which is more in line with the rest of the book. I also changed the description for the `should_panic` attribute as I found it a little confusing. Finally, some of the blocks were `text` and some were `rust` so I changed them all to `text` which is in line with the rest of the book.", "tree": {"sha": "9b257fe18420497b9c44ec1deb81d1c269be35bb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9b257fe18420497b9c44ec1deb81d1c269be35bb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b9b8f5b44469c9050989b044d76a07969f320882", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhEtERCRBK7hj4Ov3rIwAAJ6EIAKrmlBRlmJZztvFQqCRSejOA\nSlimWrGFbovHt74TG7IcmRUR8w0jZ9hDfB+u82GelnHGtwikYH/0g+xjeAHa+Lak\nBwnrRTFXmBj+TtXmXP/FuIsl2OaLDTXBgQezp2hMxDyViBhtLvRBmHZw3CMei3dh\nyBXHgnbVnXas/rCdVqVzu9p+kurpZmXlb1n7OfzYL5FY/qMUenXvjmOOwmNURKZH\nIcjv7nRutDM6rd6QVHCTDaQgJWbp3AlXbUZhh3j7IyPcNcFS4Knnnd5AXP3bUgFj\n0UT0LKH+dvkZ9qEJCP1v0RM3X0ks/FAe+A3AC+d9nRWr0wNGwE+ndYnN9KQqC9o=\n=UeQr\n-----END PGP SIGNATURE-----\n", "payload": "tree 9b257fe18420497b9c44ec1deb81d1c269be35bb\nparent deee28a14de8a59485fca717647ad2c82b06a7c3\nparent a4af0401dd39a5f10da4e386bd68524b35071783\nauthor Yuki Okushi <jtitor@2k36.org> 1628623121 +0900\ncommitter GitHub <noreply@github.com> 1628623121 +0900\n\nRollup merge of #87865 - tsoutsman:master, r=GuillaumeGomez\n\nClarify terms in rustdoc book\n\nFixes #70898\n\nI chose to completely remove the term directive over attribute because rustdoc has a lint called `invalid_codeblock_attributes` and the term attributes is used throughout the book. I slightly changed the introductory sentence to describe the relationship between annotations and attributes.\n\nI also moved the text explaining the example from below the blocks to above the blocks which is more in line with the rest of the book. I also changed the description for the `should_panic` attribute as I found it a little confusing. Finally, some of the blocks were `text` and some were `rust` so I changed them all to `text` which is in line with the rest of the book.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b9b8f5b44469c9050989b044d76a07969f320882", "html_url": "https://github.com/rust-lang/rust/commit/b9b8f5b44469c9050989b044d76a07969f320882", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b9b8f5b44469c9050989b044d76a07969f320882/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "deee28a14de8a59485fca717647ad2c82b06a7c3", "url": "https://api.github.com/repos/rust-lang/rust/commits/deee28a14de8a59485fca717647ad2c82b06a7c3", "html_url": "https://github.com/rust-lang/rust/commit/deee28a14de8a59485fca717647ad2c82b06a7c3"}, {"sha": "a4af0401dd39a5f10da4e386bd68524b35071783", "url": "https://api.github.com/repos/rust-lang/rust/commits/a4af0401dd39a5f10da4e386bd68524b35071783", "html_url": "https://github.com/rust-lang/rust/commit/a4af0401dd39a5f10da4e386bd68524b35071783"}], "stats": {"total": 46, "additions": 24, "deletions": 22}, "files": [{"sha": "70900a0bab942fa514533aec0fc3f884c8ab89e2", "filename": "src/doc/rustdoc/src/documentation-tests.md", "status": "modified", "additions": 24, "deletions": 22, "changes": 46, "blob_url": "https://github.com/rust-lang/rust/blob/b9b8f5b44469c9050989b044d76a07969f320882/src%2Fdoc%2Frustdoc%2Fsrc%2Fdocumentation-tests.md", "raw_url": "https://github.com/rust-lang/rust/raw/b9b8f5b44469c9050989b044d76a07969f320882/src%2Fdoc%2Frustdoc%2Fsrc%2Fdocumentation-tests.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustdoc%2Fsrc%2Fdocumentation-tests.md?ref=b9b8f5b44469c9050989b044d76a07969f320882", "patch": "@@ -297,20 +297,23 @@ we can add the `#[macro_use]` attribute. Second, we\u2019ll need to add our own\n \n ## Attributes\n \n-There are a few annotations that are useful to help `rustdoc` do the right\n+Code blocks can be annotated with attributes that help `rustdoc` do the right\n thing when testing your code:\n \n+The `ignore` attribute tells Rust to ignore your code. This is almost never\n+what you want as it's the most generic. Instead, consider annotating it\n+with `text` if it's not code or using `#`s to get a working example that\n+only shows the part you care about.\n+\n ```rust\n /// ```ignore\n /// fn foo() {\n /// ```\n # fn foo() {}\n ```\n \n-The `ignore` directive tells Rust to ignore your code. This is almost never\n-what you want, as it's the most generic. Instead, consider annotating it\n-with `text` if it's not code, or using `#`s to get a working example that\n-only shows the part you care about.\n+`should_panic` tells `rustdoc` that the code should compile correctly but\n+panic during execution. If the code doesn't panic, the test will fail.\n \n ```rust\n /// ```should_panic\n@@ -319,8 +322,10 @@ only shows the part you care about.\n # fn foo() {}\n ```\n \n-`should_panic` tells `rustdoc` that the code should compile correctly, but\n-not actually pass as a test.\n+The `no_run` attribute will compile your code but not run it. This is\n+important for examples such as \"Here's how to retrieve a web page,\"\n+which you would want to ensure compiles, but might be run in a test\n+environment that has no network access.\n \n ```rust\n /// ```no_run\n@@ -331,24 +336,24 @@ not actually pass as a test.\n # fn foo() {}\n ```\n \n-The `no_run` attribute will compile your code, but not run it. This is\n-important for examples such as \"Here's how to retrieve a web page,\"\n-which you would want to ensure compiles, but might be run in a test\n-environment that has no network access.\n+`compile_fail` tells `rustdoc` that the compilation should fail. If it\n+compiles, then the test will fail. However, please note that code failing\n+with the current Rust release may work in a future release, as new features\n+are added.\n \n-```text\n+```rust\n /// ```compile_fail\n /// let x = 5;\n /// x += 2; // shouldn't compile!\n /// ```\n+# fn foo() {}\n ```\n \n-`compile_fail` tells `rustdoc` that the compilation should fail. If it\n-compiles, then the test will fail. However please note that code failing\n-with the current Rust release may work in a future release, as new features\n-are added.\n+`edition2018` tells `rustdoc` that the code sample should be compiled using\n+the 2018 edition of Rust. Similarly, you can specify `edition2015` to compile\n+the code with the 2015 edition.\n \n-```text\n+```rust\n /// Only runs on the 2018 edition.\n ///\n /// ```edition2018\n@@ -358,12 +363,9 @@ are added.\n ///         + \"3\".parse::<i32>()?\n /// };\n /// ```\n+# fn foo() {}\n ```\n \n-`edition2018` tells `rustdoc` that the code sample should be compiled using\n-the 2018 edition of Rust. Similarly, you can specify `edition2015` to compile\n-the code with the 2015 edition.\n-\n ## Syntax reference\n \n The *exact* syntax for code blocks, including the edge cases, can be found\n@@ -385,7 +387,7 @@ section.\n \n However, it's preferable to use fenced code blocks over indented code blocks.\n Not only are fenced code blocks considered more idiomatic for Rust code,\n-but there is no way to use directives such as `ignore` or `should_panic` with\n+but there is no way to use attributes such as `ignore` or `should_panic` with\n indented code blocks.\n \n ### Include items only when collecting doctests"}]}