{"sha": "d006f5734f49625c34d6fc33bf6b9967243abca8", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQwMDZmNTczNGY0OTYyNWMzNGQ2ZmMzM2JmNmI5OTY3MjQzYWJjYTg=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-08-28T20:58:49Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-08-28T20:58:49Z"}, "message": "Auto merge of #76035 - tiagolam:master, r=pietroalbini\n\nBuild dist-x86_64-musl with --enable-profiler.\n\nTrying to build a Rust project with `-Zprofile` for target\nx86_64-unknown-linux-musl using rustc 1.46.0-nightly (346aec9b0\n2020-07-11), installed with rustup, results in the following error.\n```\n        export RUSTFLAGS=\"-Zprofile -Ccodegen-units=1 -Copt-level=0 -Clink-dead-code -Coverflow-checks=off -Zpanic_abort_tests -Cpanic=abort\"export CARGO_INCREMENTAL=0$ cargo build --target=x86_64-unknown-linux-muslCompiling hello_world v0.1.0 (\u2026)error[E0463]: can't find crate for `profiler_builtins`\n        |\n         = note: the compiler may have been built without the profiler runtime\n\n        error: aborting due to previous error\n\n        For more information about this error, try `rustc --explain E0463`.error: could not compile `hello_world`.\n\n        To learn more, run the command again with --verbose.\n```\n\n`-Zprofile` is required here to enable grcov profiling.\n\nThis is similar in nature to issue\nhttps://github.com/rust-lang/rust/issues/57257, which has been fixed in\nasimilar way at https://github.com/rust-lang/rust/pull/60476 .\n\nA fix for Android has also landed not long ago:\nhttps://github.com/rust-lang/rust/pull/70054 .\n\nSigned-off-by: Tiago Lam <tiagol@hadean.com>", "tree": {"sha": "00a8281562ecd84cb49985b92b6c8eab66b5e539", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/00a8281562ecd84cb49985b92b6c8eab66b5e539"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d006f5734f49625c34d6fc33bf6b9967243abca8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d006f5734f49625c34d6fc33bf6b9967243abca8", "html_url": "https://github.com/rust-lang/rust/commit/d006f5734f49625c34d6fc33bf6b9967243abca8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d006f5734f49625c34d6fc33bf6b9967243abca8/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "abb98ca10de10e0a80e2bdbb8f704649ceed556f", "url": "https://api.github.com/repos/rust-lang/rust/commits/abb98ca10de10e0a80e2bdbb8f704649ceed556f", "html_url": "https://github.com/rust-lang/rust/commit/abb98ca10de10e0a80e2bdbb8f704649ceed556f"}, {"sha": "e4bd5cd94a1623312d2ec4eef79cc4dbe7ce3377", "url": "https://api.github.com/repos/rust-lang/rust/commits/e4bd5cd94a1623312d2ec4eef79cc4dbe7ce3377", "html_url": "https://github.com/rust-lang/rust/commit/e4bd5cd94a1623312d2ec4eef79cc4dbe7ce3377"}], "stats": {"total": 1, "additions": 1, "deletions": 0}, "files": [{"sha": "dc8745cd8d44325c0dc18d1bad415e5c28ae8393", "filename": "src/ci/docker/host-x86_64/dist-x86_64-musl/Dockerfile", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d006f5734f49625c34d6fc33bf6b9967243abca8/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-x86_64-musl%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/d006f5734f49625c34d6fc33bf6b9967243abca8/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-x86_64-musl%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-x86_64-musl%2FDockerfile?ref=d006f5734f49625c34d6fc33bf6b9967243abca8", "patch": "@@ -33,6 +33,7 @@ ENV HOSTS=x86_64-unknown-linux-musl\n ENV RUST_CONFIGURE_ARGS \\\n       --musl-root-x86_64=/usr/local/x86_64-linux-musl \\\n       --enable-extended \\\n+      --enable-profiler \\\n       --enable-lld \\\n       --set target.x86_64-unknown-linux-musl.crt-static=false \\\n       --build $HOSTS"}]}