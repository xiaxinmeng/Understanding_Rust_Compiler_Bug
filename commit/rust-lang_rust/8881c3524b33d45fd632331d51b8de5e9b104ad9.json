{"sha": "8881c3524b33d45fd632331d51b8de5e9b104ad9", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg4ODFjMzUyNGIzM2Q0NWZkNjMyMzMxZDUxYjhkZTVlOWIxMDRhZDk=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-10-07T21:12:10Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-10-07T21:12:10Z"}, "message": "auto merge of #17834 : sfackler/rust/rustdoc-cfgs, r=alexcrichton,alexcrichton\n\nRustdoc would previously improperly handle key=\"value\" style cfgs, which\r\nare notably used for Cargo features.", "tree": {"sha": "55e014b82e523d93eb1a15613a31d7bbd1bd6129", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/55e014b82e523d93eb1a15613a31d7bbd1bd6129"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8881c3524b33d45fd632331d51b8de5e9b104ad9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8881c3524b33d45fd632331d51b8de5e9b104ad9", "html_url": "https://github.com/rust-lang/rust/commit/8881c3524b33d45fd632331d51b8de5e9b104ad9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8881c3524b33d45fd632331d51b8de5e9b104ad9/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "683e40f355596d211a31066db8524496e432bae5", "url": "https://api.github.com/repos/rust-lang/rust/commits/683e40f355596d211a31066db8524496e432bae5", "html_url": "https://github.com/rust-lang/rust/commit/683e40f355596d211a31066db8524496e432bae5"}, {"sha": "a585b4e8a0ca41a2445838245f3d44358a82a4dc", "url": "https://api.github.com/repos/rust-lang/rust/commits/a585b4e8a0ca41a2445838245f3d44358a82a4dc", "html_url": "https://github.com/rust-lang/rust/commit/a585b4e8a0ca41a2445838245f3d44358a82a4dc"}], "stats": {"total": 11, "additions": 3, "deletions": 8}, "files": [{"sha": "9ce012502446dca7f8d9fcfe3bd6efd4daf0e3e4", "filename": "src/librustc/driver/config.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8881c3524b33d45fd632331d51b8de5e9b104ad9/src%2Flibrustc%2Fdriver%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8881c3524b33d45fd632331d51b8de5e9b104ad9/src%2Flibrustc%2Fdriver%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fdriver%2Fconfig.rs?ref=8881c3524b33d45fd632331d51b8de5e9b104ad9", "patch": "@@ -630,7 +630,7 @@ pub fn optgroups() -> Vec<getopts::OptGroup> {\n \n \n // Convert strings provided as --cfg [cfgspec] into a crate_cfg\n-fn parse_cfgspecs(cfgspecs: Vec<String> ) -> ast::CrateConfig {\n+pub fn parse_cfgspecs(cfgspecs: Vec<String> ) -> ast::CrateConfig {\n     cfgspecs.into_iter().map(|s| {\n         parse::parse_meta_from_source_str(\"cfgspec\".to_string(),\n                                           s.to_string(),"}, {"sha": "f0f08ff7077caf5bcea085847aafc1e4a8f33348", "filename": "src/librustdoc/core.rs", "status": "modified", "additions": 2, "deletions": 7, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/8881c3524b33d45fd632331d51b8de5e9b104ad9/src%2Flibrustdoc%2Fcore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8881c3524b33d45fd632331d51b8de5e9b104ad9/src%2Flibrustdoc%2Fcore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fcore.rs?ref=8881c3524b33d45fd632331d51b8de5e9b104ad9", "patch": "@@ -14,8 +14,6 @@ use rustc::lint;\n use rustc::back::link;\n \n use syntax::{ast, ast_map, codemap, diagnostic};\n-use syntax::parse::token;\n-use syntax::ptr::P;\n \n use std::cell::RefCell;\n use std::os;\n@@ -95,6 +93,7 @@ pub fn run_core(libs: Vec<Path>, cfgs: Vec<String>, externs: Externs,\n         lint_opts: vec!((warning_lint, lint::Allow)),\n         externs: externs,\n         target_triple: triple.unwrap_or(driver::host_triple().to_string()),\n+        cfg: config::parse_cfgspecs(cfgs),\n         ..config::basic_options().clone()\n     };\n \n@@ -108,11 +107,7 @@ pub fn run_core(libs: Vec<Path>, cfgs: Vec<String>, externs: Externs,\n                                        Some(cpath.clone()),\n                                        span_diagnostic_handler);\n \n-    let mut cfg = config::build_configuration(&sess);\n-    for cfg_ in cfgs.into_iter() {\n-        let cfg_ = token::intern_and_get_ident(cfg_.as_slice());\n-        cfg.push(P(codemap::dummy_spanned(ast::MetaWord(cfg_))));\n-    }\n+    let cfg = config::build_configuration(&sess);\n \n     let krate = driver::phase_1_parse_input(&sess, cfg, &input);\n "}]}