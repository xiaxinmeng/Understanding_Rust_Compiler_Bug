{"sha": "7b938d890323131d61af4f9383fb5b595cfb5694", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdiOTM4ZDg5MDMyMzEzMWQ2MWFmNGY5MzgzZmI1YjU5NWNmYjU2OTQ=", "commit": {"author": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2012-03-09T23:55:13Z"}, "committer": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2012-03-09T23:55:13Z"}, "message": "rustc: Add region def ids to the AST", "tree": {"sha": "450b77ab03729c672a00d61faaee2ec15616cf16", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/450b77ab03729c672a00d61faaee2ec15616cf16"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7b938d890323131d61af4f9383fb5b595cfb5694", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7b938d890323131d61af4f9383fb5b595cfb5694", "html_url": "https://github.com/rust-lang/rust/commit/7b938d890323131d61af4f9383fb5b595cfb5694", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7b938d890323131d61af4f9383fb5b595cfb5694/comments", "author": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e2f6052c6d34229e41530d2260cd1915d11659bc", "url": "https://api.github.com/repos/rust-lang/rust/commits/e2f6052c6d34229e41530d2260cd1915d11659bc", "html_url": "https://github.com/rust-lang/rust/commit/e2f6052c6d34229e41530d2260cd1915d11659bc"}], "stats": {"total": 31, "additions": 28, "deletions": 3}, "files": [{"sha": "060d011a9b7d9c5997ead4fda535fb9165fc569c", "filename": "src/rustc/metadata/astencode.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/7b938d890323131d61af4f9383fb5b595cfb5694/src%2Frustc%2Fmetadata%2Fastencode.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7b938d890323131d61af4f9383fb5b595cfb5694/src%2Frustc%2Fmetadata%2Fastencode.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fmetadata%2Fastencode.rs?ref=7b938d890323131d61af4f9383fb5b595cfb5694", "patch": "@@ -434,6 +434,7 @@ impl of tr for ast::def {\n           ast::def_class_method(did0, did1) {\n             ast::def_class_method(did0.tr(xcx), did1.tr(xcx))\n           }\n+          ast::def_region(nid) { ast::def_region(xcx.tr_id(nid)) }\n         }\n     }\n }\n@@ -1004,4 +1005,4 @@ fn test_simplification() {\n       }\n       _ { fail; }\n     }\n-}\n\\ No newline at end of file\n+}"}, {"sha": "35e6f5c79978363a25f5f7399e41c8d29e41dfe4", "filename": "src/rustc/metadata/astencode_gen.rs", "status": "modified", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/7b938d890323131d61af4f9383fb5b595cfb5694/src%2Frustc%2Fmetadata%2Fastencode_gen.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7b938d890323131d61af4f9383fb5b595cfb5694/src%2Frustc%2Fmetadata%2Fastencode_gen.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fmetadata%2Fastencode_gen.rs?ref=7b938d890323131d61af4f9383fb5b595cfb5694", "patch": "@@ -8212,6 +8212,7 @@ fn serialize_164<S: std::serialization::serializer>(s: S,\n                 /*syntax::ast::def_id*/\n                 /*syntax::ast::def_id*//*syntax::ast::def_id*/\n                 /*syntax::ast::def_id*//*syntax::ast::def_id*/\n+                /*syntax::ast::node_id*/\n                 {||\n                     alt v {\n                       syntax::ast::def_fn(v0, v1) {\n@@ -8470,6 +8471,19 @@ fn serialize_164<S: std::serialization::serializer>(s: S,\n                                                 }\n                                             })\n                       }\n+                      syntax::ast::def_region(v0) {\n+                        s.emit_enum_variant(\"syntax::ast::def_region\", 17u,\n+                                            1u,\n+                                            {||\n+                                                {\n+                                                    s.emit_enum_variant_arg(0u,\n+                                                                            {||\n+                                                                                serialize_27(s,\n+                                                                                             v0)\n+                                                                            })\n+                                                }\n+                                            })\n+                      }\n                     }\n                 });\n }\n@@ -8590,6 +8604,8 @@ fn deserialize_164<S: std::serialization::deserializer>(s: S) ->\n                 /*syntax::ast::def_id*//*syntax::ast::def_id*/\n \n                 /*syntax::ast::def_id*//*syntax::ast::def_id*/\n+\n+                /*syntax::ast::node_id*/\n                 {||\n                     s.read_enum_variant({|v_id|\n                                             alt check v_id {\n@@ -8731,6 +8747,12 @@ fn deserialize_164<S: std::serialization::deserializer>(s: S) ->\n                                                                                                           deserialize_165(s)\n                                                                                                       }))\n                                               }\n+                                              17u {\n+                                                syntax::ast::def_region(s.read_enum_variant_arg(0u,\n+                                                                                                {||\n+                                                                                                    deserialize_27(s)\n+                                                                                                }))\n+                                              }\n                                             }\n                                         })\n                 })"}, {"sha": "7333369d77aa6abc3b658fa413ad53dca58507bc", "filename": "src/rustc/middle/resolve.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/7b938d890323131d61af4f9383fb5b595cfb5694/src%2Frustc%2Fmiddle%2Fresolve.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7b938d890323131d61af4f9383fb5b595cfb5694/src%2Frustc%2Fmiddle%2Fresolve.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fmiddle%2Fresolve.rs?ref=7b938d890323131d61af4f9383fb5b595cfb5694", "patch": "@@ -1713,6 +1713,7 @@ fn ns_for_def(d: def) -> namespace {\n       ast::def_ty(_) | ast::def_binding(_) | ast::def_use(_) |\n       ast::def_ty_param(_, _) | ast::def_prim_ty(_) | ast::def_class(_)\n       { ns_type }\n+      ast::def_region(_) { fail \"regions are not handled by this pass\" }\n     }\n }\n "}, {"sha": "91590d5be6b78de16a48c05429254d75b4100b9d", "filename": "src/rustc/syntax/ast.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/7b938d890323131d61af4f9383fb5b595cfb5694/src%2Frustc%2Fsyntax%2Fast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7b938d890323131d61af4f9383fb5b595cfb5694/src%2Frustc%2Fsyntax%2Fast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fsyntax%2Fast.rs?ref=7b938d890323131d61af4f9383fb5b595cfb5694", "patch": "@@ -50,7 +50,8 @@ enum def {\n     def_class_field(def_id, def_id),\n     // No purity allowed for now, I guess\n     // (simpler this way, b/c presumably methods read mutable state)\n-    def_class_method(def_id, def_id)\n+    def_class_method(def_id, def_id),\n+    def_region(node_id)\n }\n \n // The set of meta_items that define the compilation environment of the crate,"}, {"sha": "f55d51a6ed8eaf361c8ecd06dc35fd5097608cc6", "filename": "src/rustc/syntax/ast_util.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7b938d890323131d61af4f9383fb5b595cfb5694/src%2Frustc%2Fsyntax%2Fast_util.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7b938d890323131d61af4f9383fb5b595cfb5694/src%2Frustc%2Fsyntax%2Fast_util.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fsyntax%2Fast_util.rs?ref=7b938d890323131d61af4f9383fb5b595cfb5694", "patch": "@@ -42,7 +42,7 @@ fn def_id_of_def(d: def) -> def_id {\n       def_class(id) | def_class_field(_, id) | def_class_method(_, id) { id }\n \n       def_arg(id, _) | def_local(id, _) | def_self(id) |\n-      def_upvar(id, _, _) | def_binding(id) {\n+      def_upvar(id, _, _) | def_binding(id) | def_region(id) {\n         local_def(id)\n       }\n "}]}