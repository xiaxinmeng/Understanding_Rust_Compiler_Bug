{"sha": "9e108f89222e10c3ccd6a899a6b1ea71a91fc5ea", "node_id": "C_kwDOAAsO6NoAKDllMTA4Zjg5MjIyZTEwYzNjY2Q2YTg5OWE2YjFlYTcxYTkxZmM1ZWE", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-05-31T09:19:08Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-05-31T09:19:08Z"}, "message": "Rollup merge of #112089 - Kobzol:bootstrap-warnings, r=jyn514\n\nAdd `--warnings warn` flag to `x.py`\n\nSo that bootstrap itself can be built with warnings not being treated as errors.\n\nFixes: https://github.com/rust-lang/rust/issues/76805\n\nr? ```@jyn514```", "tree": {"sha": "69fb4fe62f45dc6eb9b520fa015bc37cf36ffc5a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/69fb4fe62f45dc6eb9b520fa015bc37cf36ffc5a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9e108f89222e10c3ccd6a899a6b1ea71a91fc5ea", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkdxEMCRBK7hj4Ov3rIwAAFRcIAH4SxoXzF14bSSuXTFXo8sZZ\nzOjs0KbUS1DxbrlcXs3VV6wcCeuq/PDM5QMqBBpalk5Z6VHAsOnsgwauIMSvpbt2\nsMV7RIGqVY6EfWcj2lyhyOIOB6KSEEC0BodbyGVdTMhM4++CZjbM3NYoYhZGdSMM\nzxgPFSUtxcuChEUjd50adepSalE+AF8crHh4gMrD4YPk3wvBd33Q7ZB3AIWR5Gx1\nzeLMH771oWWzjYQURDzx3Wb98DcAalpG595RhSgV80Wsvaxo4mvd1eQAVmCIN77t\nWY2Zk1f51x+Tj1QXgOoYPDLjcye/18gUmCAjuQDX+LGAOhxJ2ZFNys4uJNfBeoU=\n=Z+z1\n-----END PGP SIGNATURE-----\n", "payload": "tree 69fb4fe62f45dc6eb9b520fa015bc37cf36ffc5a\nparent aee05c74e190c8d435cb6269256e448fc7e0a684\nparent 023e6c4be3785d0d8260b3c0d4fd87b88d9b48d9\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1685524748 +0200\ncommitter GitHub <noreply@github.com> 1685524748 +0200\n\nRollup merge of #112089 - Kobzol:bootstrap-warnings, r=jyn514\n\nAdd `--warnings warn` flag to `x.py`\n\nSo that bootstrap itself can be built with warnings not being treated as errors.\n\nFixes: https://github.com/rust-lang/rust/issues/76805\n\nr? ```@jyn514```\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9e108f89222e10c3ccd6a899a6b1ea71a91fc5ea", "html_url": "https://github.com/rust-lang/rust/commit/9e108f89222e10c3ccd6a899a6b1ea71a91fc5ea", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9e108f89222e10c3ccd6a899a6b1ea71a91fc5ea/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "aee05c74e190c8d435cb6269256e448fc7e0a684", "url": "https://api.github.com/repos/rust-lang/rust/commits/aee05c74e190c8d435cb6269256e448fc7e0a684", "html_url": "https://github.com/rust-lang/rust/commit/aee05c74e190c8d435cb6269256e448fc7e0a684"}, {"sha": "023e6c4be3785d0d8260b3c0d4fd87b88d9b48d9", "url": "https://api.github.com/repos/rust-lang/rust/commits/023e6c4be3785d0d8260b3c0d4fd87b88d9b48d9", "html_url": "https://github.com/rust-lang/rust/commit/023e6c4be3785d0d8260b3c0d4fd87b88d9b48d9"}], "stats": {"total": 11, "additions": 8, "deletions": 3}, "files": [{"sha": "473fdbe1edc27038cf1a7dd1ad46dae0fc60d48d", "filename": "src/bootstrap/bootstrap.py", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/9e108f89222e10c3ccd6a899a6b1ea71a91fc5ea/src%2Fbootstrap%2Fbootstrap.py", "raw_url": "https://github.com/rust-lang/rust/raw/9e108f89222e10c3ccd6a899a6b1ea71a91fc5ea/src%2Fbootstrap%2Fbootstrap.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbootstrap.py?ref=9e108f89222e10c3ccd6a899a6b1ea71a91fc5ea", "patch": "@@ -835,7 +835,7 @@ def bootstrap_binary(self):\n         \"\"\"\n         return os.path.join(self.build_dir, \"bootstrap\", \"debug\", \"bootstrap\")\n \n-    def build_bootstrap(self, color, verbose_count):\n+    def build_bootstrap(self, color, warnings, verbose_count):\n         \"\"\"Build bootstrap\"\"\"\n         env = os.environ.copy()\n         if \"GITHUB_ACTIONS\" in env:\n@@ -894,7 +894,11 @@ def build_bootstrap(self, color, verbose_count):\n         if target_linker is not None:\n             env[\"RUSTFLAGS\"] += \" -C linker=\" + target_linker\n         env[\"RUSTFLAGS\"] += \" -Wrust_2018_idioms -Wunused_lifetimes\"\n-        if self.get_toml(\"deny-warnings\", \"rust\") != \"false\":\n+        if warnings == \"default\":\n+            deny_warnings = self.get_toml(\"deny-warnings\", \"rust\") != \"false\"\n+        else:\n+            deny_warnings = warnings == \"deny\"\n+        if deny_warnings:\n             env[\"RUSTFLAGS\"] += \" -Dwarnings\"\n \n         env[\"PATH\"] = os.path.join(self.bin_root(), \"bin\") + \\\n@@ -987,6 +991,7 @@ def parse_args():\n     parser.add_argument('--color', choices=['always', 'never', 'auto'])\n     parser.add_argument('--clean', action='store_true')\n     parser.add_argument('--json-output', action='store_true')\n+    parser.add_argument('--warnings', choices=['deny', 'warn', 'default'], default='default')\n     parser.add_argument('-v', '--verbose', action='count', default=0)\n \n     return parser.parse_known_args(sys.argv)[0]\n@@ -1052,7 +1057,7 @@ def bootstrap(args):\n     # Fetch/build the bootstrap\n     build.download_toolchain()\n     sys.stdout.flush()\n-    build.build_bootstrap(args.color, verbose_count)\n+    build.build_bootstrap(args.color, args.warnings, verbose_count)\n     sys.stdout.flush()\n \n     # Run the bootstrap"}]}