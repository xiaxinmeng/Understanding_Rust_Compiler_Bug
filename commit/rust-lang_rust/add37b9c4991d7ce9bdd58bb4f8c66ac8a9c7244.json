{"sha": "add37b9c4991d7ce9bdd58bb4f8c66ac8a9c7244", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFkZDM3YjljNDk5MWQ3Y2U5YmRkNThiYjRmOGM2NmFjOGE5YzcyNDQ=", "commit": {"author": {"name": "Johan Sk\u00f6ld", "email": "johan@skold.cc", "date": "2015-11-15T11:34:04Z"}, "committer": {"name": "Johan Sk\u00f6ld", "email": "johan@skold.cc", "date": "2015-11-15T12:16:34Z"}, "message": "Adds a \"Native\" option to newline_style.\n\nBy using it one will get \\r\\n line endings on Windows, and \\n line endings\non other platforms.", "tree": {"sha": "8717a96d4dcd7e4e51876177896bc8bdfce11a59", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8717a96d4dcd7e4e51876177896bc8bdfce11a59"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/add37b9c4991d7ce9bdd58bb4f8c66ac8a9c7244", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/add37b9c4991d7ce9bdd58bb4f8c66ac8a9c7244", "html_url": "https://github.com/rust-lang/rust/commit/add37b9c4991d7ce9bdd58bb4f8c66ac8a9c7244", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/add37b9c4991d7ce9bdd58bb4f8c66ac8a9c7244/comments", "author": {"login": "rhoot", "id": 1258798, "node_id": "MDQ6VXNlcjEyNTg3OTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1258798?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rhoot", "html_url": "https://github.com/rhoot", "followers_url": "https://api.github.com/users/rhoot/followers", "following_url": "https://api.github.com/users/rhoot/following{/other_user}", "gists_url": "https://api.github.com/users/rhoot/gists{/gist_id}", "starred_url": "https://api.github.com/users/rhoot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rhoot/subscriptions", "organizations_url": "https://api.github.com/users/rhoot/orgs", "repos_url": "https://api.github.com/users/rhoot/repos", "events_url": "https://api.github.com/users/rhoot/events{/privacy}", "received_events_url": "https://api.github.com/users/rhoot/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rhoot", "id": 1258798, "node_id": "MDQ6VXNlcjEyNTg3OTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1258798?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rhoot", "html_url": "https://github.com/rhoot", "followers_url": "https://api.github.com/users/rhoot/followers", "following_url": "https://api.github.com/users/rhoot/following{/other_user}", "gists_url": "https://api.github.com/users/rhoot/gists{/gist_id}", "starred_url": "https://api.github.com/users/rhoot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rhoot/subscriptions", "organizations_url": "https://api.github.com/users/rhoot/orgs", "repos_url": "https://api.github.com/users/rhoot/repos", "events_url": "https://api.github.com/users/rhoot/events{/privacy}", "received_events_url": "https://api.github.com/users/rhoot/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cdf56f75a1fa3736c414ca6c96a58b21f4dc90fb", "url": "https://api.github.com/repos/rust-lang/rust/commits/cdf56f75a1fa3736c414ca6c96a58b21f4dc90fb", "html_url": "https://github.com/rust-lang/rust/commit/cdf56f75a1fa3736c414ca6c96a58b21f4dc90fb"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "713d3aefd3cd1281bee0875182961a3c356f6af4", "filename": "src/config.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/add37b9c4991d7ce9bdd58bb4f8c66ac8a9c7244/src%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/add37b9c4991d7ce9bdd58bb4f8c66ac8a9c7244/src%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fconfig.rs?ref=add37b9c4991d7ce9bdd58bb4f8c66ac8a9c7244", "patch": "@@ -26,6 +26,7 @@ macro_rules! configuration_option_enum{\n configuration_option_enum! { NewlineStyle:\n     Windows, // \\r\\n\n     Unix, // \\n\n+    Native, // \\r\\n in Windows, \\n on other platforms\n }\n \n configuration_option_enum! { BraceStyle:"}, {"sha": "5b997b55c251b9d1ca2eb1de9a0d70d993f14137", "filename": "src/filemap.rs", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/add37b9c4991d7ce9bdd58bb4f8c66ac8a9c7244/src%2Ffilemap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/add37b9c4991d7ce9bdd58bb4f8c66ac8a9c7244/src%2Ffilemap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ffilemap.rs?ref=add37b9c4991d7ce9bdd58bb4f8c66ac8a9c7244", "patch": "@@ -59,7 +59,17 @@ pub fn write_file(text: &StringBuffer,\n                                 -> Result<(), io::Error>\n         where T: Write\n     {\n-        match config.newline_style {\n+        let style = if config.newline_style == NewlineStyle::Native {\n+            if cfg!(windows) {\n+                NewlineStyle::Windows\n+            } else {\n+                NewlineStyle::Unix\n+            }\n+        } else {\n+            config.newline_style\n+        };\n+\n+        match style {\n             NewlineStyle::Unix => write!(writer, \"{}\", text),\n             NewlineStyle::Windows => {\n                 for (c, _) in text.chars() {\n@@ -71,6 +81,7 @@ pub fn write_file(text: &StringBuffer,\n                 }\n                 Ok(())\n             }\n+            NewlineStyle::Native => unreachable!(),\n         }\n     }\n "}]}