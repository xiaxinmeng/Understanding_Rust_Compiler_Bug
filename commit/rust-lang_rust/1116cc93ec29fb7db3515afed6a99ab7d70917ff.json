{"sha": "1116cc93ec29fb7db3515afed6a99ab7d70917ff", "node_id": "C_kwDOAAsO6NoAKDExMTZjYzkzZWMyOWZiN2RiMzUxNWFmZWQ2YTk5YWI3ZDcwOTE3ZmY", "commit": {"author": {"name": "Brent Westbrook", "email": "brentrwestbrook@gmail.com", "date": "2022-12-20T16:07:37Z"}, "committer": {"name": "Brent Westbrook", "email": "brentrwestbrook@gmail.com", "date": "2022-12-20T16:07:37Z"}, "message": "return immediately from `render_tuple_lit` if `snippet_cap` is None\n\npartially addresses #13767", "tree": {"sha": "d5a4d3a844fb0895b702c0b6336aefd685859a3b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d5a4d3a844fb0895b702c0b6336aefd685859a3b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1116cc93ec29fb7db3515afed6a99ab7d70917ff", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1116cc93ec29fb7db3515afed6a99ab7d70917ff", "html_url": "https://github.com/rust-lang/rust/commit/1116cc93ec29fb7db3515afed6a99ab7d70917ff", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1116cc93ec29fb7db3515afed6a99ab7d70917ff/comments", "author": {"login": "ntBre", "id": 36778786, "node_id": "MDQ6VXNlcjM2Nzc4Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/36778786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ntBre", "html_url": "https://github.com/ntBre", "followers_url": "https://api.github.com/users/ntBre/followers", "following_url": "https://api.github.com/users/ntBre/following{/other_user}", "gists_url": "https://api.github.com/users/ntBre/gists{/gist_id}", "starred_url": "https://api.github.com/users/ntBre/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ntBre/subscriptions", "organizations_url": "https://api.github.com/users/ntBre/orgs", "repos_url": "https://api.github.com/users/ntBre/repos", "events_url": "https://api.github.com/users/ntBre/events{/privacy}", "received_events_url": "https://api.github.com/users/ntBre/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ntBre", "id": 36778786, "node_id": "MDQ6VXNlcjM2Nzc4Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/36778786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ntBre", "html_url": "https://github.com/ntBre", "followers_url": "https://api.github.com/users/ntBre/followers", "following_url": "https://api.github.com/users/ntBre/following{/other_user}", "gists_url": "https://api.github.com/users/ntBre/gists{/gist_id}", "starred_url": "https://api.github.com/users/ntBre/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ntBre/subscriptions", "organizations_url": "https://api.github.com/users/ntBre/orgs", "repos_url": "https://api.github.com/users/ntBre/repos", "events_url": "https://api.github.com/users/ntBre/events{/privacy}", "received_events_url": "https://api.github.com/users/ntBre/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4596847a88abb0d5077c5111c3093e724673d7a0", "url": "https://api.github.com/repos/rust-lang/rust/commits/4596847a88abb0d5077c5111c3093e724673d7a0", "html_url": "https://github.com/rust-lang/rust/commit/4596847a88abb0d5077c5111c3093e724673d7a0"}], "stats": {"total": 41, "additions": 40, "deletions": 1}, "files": [{"sha": "6743ec897f00b5ae444c4b6f6d272ee2ea261f66", "filename": "crates/ide-completion/src/completions/record.rs", "status": "modified", "additions": 37, "deletions": 1, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/1116cc93ec29fb7db3515afed6a99ab7d70917ff/crates%2Fide-completion%2Fsrc%2Fcompletions%2Frecord.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1116cc93ec29fb7db3515afed6a99ab7d70917ff/crates%2Fide-completion%2Fsrc%2Fcompletions%2Frecord.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide-completion%2Fsrc%2Fcompletions%2Frecord.rs?ref=1116cc93ec29fb7db3515afed6a99ab7d70917ff", "patch": "@@ -124,7 +124,12 @@ fn complete_fields(\n \n #[cfg(test)]\n mod tests {\n-    use crate::tests::check_edit;\n+    use ide_db::SnippetCap;\n+\n+    use crate::{\n+        tests::{check_edit, check_edit_with_config, TEST_CONFIG},\n+        CompletionConfig,\n+    };\n \n     #[test]\n     fn literal_struct_completion_edit() {\n@@ -151,6 +156,37 @@ fn baz() {\n         )\n     }\n \n+    #[test]\n+    fn enum_variant_no_snippets() {\n+        let conf = CompletionConfig { snippet_cap: SnippetCap::new(false), ..TEST_CONFIG };\n+        check_edit_with_config(\n+            conf,\n+            \"Variant()\",\n+            r#\"\n+enum Enum {\n+    Variant(usize),\n+}\n+\n+impl Enum {\n+    fn new(u: usize) -> Self {\n+        Self::Va$0\n+    }\n+}\n+\"#,\n+            r#\"\n+enum Enum {\n+    Variant(usize),\n+}\n+\n+impl Enum {\n+    fn new(u: usize) -> Self {\n+        Self::Variant\n+    }\n+}\n+\"#,\n+        )\n+    }\n+\n     #[test]\n     fn literal_struct_impl_self_completion() {\n         check_edit("}, {"sha": "c328962b110fe41cee8a48fefe64086bf0de15c6", "filename": "crates/ide-completion/src/render/variant.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/1116cc93ec29fb7db3515afed6a99ab7d70917ff/crates%2Fide-completion%2Fsrc%2Frender%2Fvariant.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1116cc93ec29fb7db3515afed6a99ab7d70917ff/crates%2Fide-completion%2Fsrc%2Frender%2Fvariant.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide-completion%2Fsrc%2Frender%2Fvariant.rs?ref=1116cc93ec29fb7db3515afed6a99ab7d70917ff", "patch": "@@ -48,6 +48,9 @@ pub(crate) fn render_tuple_lit(\n     fields: &[hir::Field],\n     path: &str,\n ) -> RenderedLiteral {\n+    if snippet_cap.is_none() {\n+        return RenderedLiteral { literal: format!(\"{}\", path), detail: format!(\"{}\", path) };\n+    }\n     let completions = fields.iter().enumerate().format_with(\", \", |(idx, _), f| {\n         if snippet_cap.is_some() {\n             f(&format_args!(\"${{{}:()}}\", idx + 1))"}]}