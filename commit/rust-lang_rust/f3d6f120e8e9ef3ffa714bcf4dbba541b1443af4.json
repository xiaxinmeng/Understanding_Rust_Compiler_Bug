{"sha": "f3d6f120e8e9ef3ffa714bcf4dbba541b1443af4", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYzZDZmMTIwZThlOWVmM2ZmYTcxNGJjZjRkYmJhNTQxYjE0NDNhZjQ=", "commit": {"author": {"name": "steveklabnik", "email": "steve@steveklabnik.com", "date": "2017-09-11T15:55:07Z"}, "committer": {"name": "steveklabnik", "email": "steve@steveklabnik.com", "date": "2017-09-11T15:56:35Z"}, "message": "update mdbook", "tree": {"sha": "92963b99c9ae3e1557f8e1b2aa94921b2104128e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/92963b99c9ae3e1557f8e1b2aa94921b2104128e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f3d6f120e8e9ef3ffa714bcf4dbba541b1443af4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f3d6f120e8e9ef3ffa714bcf4dbba541b1443af4", "html_url": "https://github.com/rust-lang/rust/commit/f3d6f120e8e9ef3ffa714bcf4dbba541b1443af4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f3d6f120e8e9ef3ffa714bcf4dbba541b1443af4/comments", "author": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "committer": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "19d30fcdb28c2a4f57774b827b1a17ee156b5c56", "url": "https://api.github.com/repos/rust-lang/rust/commits/19d30fcdb28c2a4f57774b827b1a17ee156b5c56", "html_url": "https://github.com/rust-lang/rust/commit/19d30fcdb28c2a4f57774b827b1a17ee156b5c56"}], "stats": {"total": 54, "additions": 27, "deletions": 27}, "files": [{"sha": "63e70e4223fd533855d6042474d1bbcbf434d3b4", "filename": "src/Cargo.lock", "status": "modified", "additions": 19, "deletions": 6, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/f3d6f120e8e9ef3ffa714bcf4dbba541b1443af4/src%2FCargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/f3d6f120e8e9ef3ffa714bcf4dbba541b1443af4/src%2FCargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2FCargo.lock?ref=f3d6f120e8e9ef3ffa714bcf4dbba541b1443af4", "patch": "@@ -490,6 +490,14 @@ dependencies = [\n  \"regex 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n+[[package]]\n+name = \"error-chain\"\n+version = \"0.10.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+dependencies = [\n+ \"backtrace 0.3.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n+]\n+\n [[package]]\n name = \"error-chain\"\n version = \"0.11.0\"\n@@ -642,7 +650,7 @@ dependencies = [\n \n [[package]]\n name = \"handlebars\"\n-version = \"0.26.2\"\n+version = \"0.27.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"lazy_static 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -926,18 +934,22 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"mdbook\"\n-version = \"0.0.22\"\n+version = \"0.0.25\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"clap 2.26.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"env_logger 0.4.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"handlebars 0.26.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"error-chain 0.10.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"handlebars 0.27.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"lazy_static 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"open 1.2.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"pulldown-cmark 0.0.14 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"regex 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"serde 1.0.11 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"serde_derive 1.0.11 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"serde_json 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"tempdir 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"toml 0.4.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -1398,7 +1410,7 @@ name = \"rustbook\"\n version = \"0.1.0\"\n dependencies = [\n  \"clap 2.26.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"mdbook 0.0.22 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"mdbook 0.0.25 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -2463,6 +2475,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum enum_primitive 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"be4551092f4d519593039259a9ed8daedf0da12e5109c5280338073eaeb81180\"\n \"checksum env_logger 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"15abd780e45b3ea4f76b4e9a26ff4843258dd8a3eed2775a0e7368c2e7936c2f\"\n \"checksum env_logger 0.4.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"3ddf21e73e016298f5cb37d6ef8e8da8e39f91f9ec8b0df44b7deb16a9f8cd5b\"\n+\"checksum error-chain 0.10.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"d9435d864e017c3c6afeac1654189b06cdb491cf2ff73dbf0d73b0f292f42ff8\"\n \"checksum error-chain 0.11.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ff511d5dc435d703f4971bc399647c9bc38e20cb41452e3b9feb4765419ed3f3\"\n \"checksum filetime 0.1.10 (registry+https://github.com/rust-lang/crates.io-index)\" = \"5363ab8e4139b8568a6237db5248646e5a8a2f89bd5ccb02092182b11fd3e922\"\n \"checksum flate2 0.2.19 (registry+https://github.com/rust-lang/crates.io-index)\" = \"36df0166e856739905cd3d7e0b210fe818592211a008862599845e012d8d304c\"\n@@ -2478,7 +2491,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum glob 0.2.11 (registry+https://github.com/rust-lang/crates.io-index)\" = \"8be18de09a56b60ed0edf84bc9df007e30040691af7acd1c41874faac5895bfb\"\n \"checksum globset 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"feeb1b6840809ef5efcf7a4a990bc4e1b7ee3df8cf9e2379a75aeb2ba42ac9c3\"\n \"checksum hamcrest 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"bf088f042a467089e9baa4972f57f9247e42a0cc549ba264c7a04fbb8ecb89d4\"\n-\"checksum handlebars 0.26.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"fbba80e74e9591a5f6a4ffff6b7f9d645759a896e431cfbdc853e9184370294a\"\n+\"checksum handlebars 0.27.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ef7567daf271a32e60301e4821fcb5b51a5b535167115d1ce04f46c3f0a15f0b\"\n \"checksum hex 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"d6a22814455d41612f41161581c2883c0c6a1c41852729b17d5ed88f01e153aa\"\n \"checksum home 0.3.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9f25ae61099d8f3fee8b483df0bd4ecccf4b2731897aad40d50eca1b641fe6db\"\n \"checksum html-diff 0.0.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"5298d63081a642508fce965740ddb03a386c5d81bf1fef0579a815cf49cb8c68\"\n@@ -2503,7 +2516,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum magenta-sys 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"40d014c7011ac470ae28e2f76a02bfea4a8480f73e701353b49ad7a8d75f4699\"\n \"checksum markup5ever 0.3.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ff834ac7123c6a37826747e5ca09db41fd7a83126792021c2e636ad174bb77d3\"\n \"checksum matches 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"100aabe6b8ff4e4a7e32c1c13523379802df0772b82466207ac25b013f193376\"\n-\"checksum mdbook 0.0.22 (registry+https://github.com/rust-lang/crates.io-index)\" = \"22911d86cde6f80fa9f0fb2a68bbbde85d97af4fe0ce267141c83a4187d28700\"\n+\"checksum mdbook 0.0.25 (registry+https://github.com/rust-lang/crates.io-index)\" = \"146eadfc6d141452a364c351f07bb19208d1401e931f40b8532f87bba3ecc40f\"\n \"checksum memchr 0.1.11 (registry+https://github.com/rust-lang/crates.io-index)\" = \"d8b629fb514376c675b98c1421e80b151d3817ac42d7c667717d282761418d20\"\n \"checksum memchr 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"1dbccc0e46f1ea47b9f17e6d67c5a96bd27030519c519c9c91327e31275a47b4\"\n \"checksum miniz-sys 0.1.9 (registry+https://github.com/rust-lang/crates.io-index)\" = \"28eaee17666671fa872e567547e8428e83308ebe5808cdf6a0e28397dbe2c726\""}, {"sha": "e57c105008ade1a337ba612173813ca5ccb11b6c", "filename": "src/tools/rustbook/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f3d6f120e8e9ef3ffa714bcf4dbba541b1443af4/src%2Ftools%2Frustbook%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/f3d6f120e8e9ef3ffa714bcf4dbba541b1443af4/src%2Ftools%2Frustbook%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustbook%2FCargo.toml?ref=f3d6f120e8e9ef3ffa714bcf4dbba541b1443af4", "patch": "@@ -8,5 +8,5 @@ license = \"MIT/Apache-2.0\"\n clap = \"2.25.0\"\n \n [dependencies.mdbook]\n-version = \"0.0.22\"\n+version = \"0.0.25\"\n default-features = false"}, {"sha": "a0c3e811a7aa2cc5b69c177f6e08ef11db258672", "filename": "src/tools/rustbook/src/main.rs", "status": "modified", "additions": 7, "deletions": 20, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/f3d6f120e8e9ef3ffa714bcf4dbba541b1443af4/src%2Ftools%2Frustbook%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f3d6f120e8e9ef3ffa714bcf4dbba541b1443af4/src%2Ftools%2Frustbook%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustbook%2Fsrc%2Fmain.rs?ref=f3d6f120e8e9ef3ffa714bcf4dbba541b1443af4", "patch": "@@ -13,13 +13,13 @@ extern crate mdbook;\n extern crate clap;\n \n use std::env;\n-use std::error::Error;\n use std::io::{self, Write};\n use std::path::{Path, PathBuf};\n \n use clap::{App, ArgMatches, SubCommand, AppSettings};\n \n use mdbook::MDBook;\n+use mdbook::errors::Result;\n \n fn main() {\n     let d_message = \"-d, --dest-dir=[dest-dir]\n@@ -49,34 +49,21 @@ fn main() {\n         ::std::process::exit(101);\n     }\n }\n-\n // Build command implementation\n-fn build(args: &ArgMatches) -> Result<(), Box<Error>> {\n-    let book = build_mdbook_struct(args);\n+pub fn build(args: &ArgMatches) -> Result<()> {\n+    let book_dir = get_book_dir(args);\n+    let book = MDBook::new(&book_dir).read_config()?;\n \n     let mut book = match args.value_of(\"dest-dir\") {\n-        Some(dest_dir) => book.set_dest(Path::new(dest_dir)),\n-        None => book\n+        Some(dest_dir) => book.with_destination(dest_dir),\n+        None => book,\n     };\n \n-    try!(book.build());\n+    book.build()?;\n \n     Ok(())\n }\n \n-fn build_mdbook_struct(args: &ArgMatches) -> mdbook::MDBook {\n-    let book_dir = get_book_dir(args);\n-    let mut book = MDBook::new(&book_dir).read_config();\n-\n-    // By default mdbook will attempt to create non-existent files referenced\n-    // from SUMMARY.md files. This is problematic on CI where we mount the\n-    // source directory as readonly. To avoid any issues, we'll disabled\n-    // mdbook's implicit file creation feature.\n-    book.create_missing = false;\n-\n-    book\n-}\n-\n fn get_book_dir(args: &ArgMatches) -> PathBuf {\n     if let Some(dir) = args.value_of(\"dir\") {\n         // Check if path is relative from current dir, or absolute..."}]}