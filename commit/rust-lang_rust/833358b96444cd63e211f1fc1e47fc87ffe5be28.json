{"sha": "833358b96444cd63e211f1fc1e47fc87ffe5be28", "node_id": "MDY6Q29tbWl0NzI0NzEyOjgzMzM1OGI5NjQ0NGNkNjNlMjExZjFmYzFlNDdmYzg3ZmZlNWJlMjg=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-09-17T15:41:19Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-09-17T15:41:19Z"}, "message": "Rollup merge of #88964 - GuillaumeGomez:version-help, r=Nemo157\n\nAdd rustdoc version into the help popup\n\nAfter a discussion with a rustdoc user about a specific behaviour, we realized we were not talking about the same version. To add on top of it, it was actually not that simple to find out the version since it was hosted documentation.\n\nSo to simplify things, I added the version into the help popup:\n\n![Screenshot from 2021-09-16 10-45-52](https://user-images.githubusercontent.com/3050060/133581128-b93b460a-e1cb-4a31-9f2f-97c7a916cfcc.png)\n\nDoes the version format looks or would you prefer that I add more information? We can also add the commit hash, commit date, host and release.\n\ncc `@rust-lang/rustdoc`\nr? `@jyn514`", "tree": {"sha": "8765327e84e000f6eb3f31f5aa0e96279fa9b1e0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8765327e84e000f6eb3f31f5aa0e96279fa9b1e0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/833358b96444cd63e211f1fc1e47fc87ffe5be28", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhRLcgCRBK7hj4Ov3rIwAAFEcIAGIvhRbVulrfYWdgoc0hK5Rp\n022uP5FCbs131KyuRWSbvnhU4CvWew3xWLognjRfVK5Vog9uiOMoCPQDPzl7fBok\nDBbpK/heaWdFmLFdarUgAANSmfyEVTz+txBVlXgZHR55PCFZK8Ggq5w0Dmn2CNF0\n5RMJOjvAB6ZYuszGK4DKcGoc3+QT6DDNupCGQoDDYNa9D4femsTZBwU8dovPWdJB\n6u1jJKeBcEw7YbD9x5uSkJAipdK+Kh9g72vh76trQ+XJGw3xcXoEHwVBLobQpTYx\ndrUYLS3nxIyZwZ+sunugVjusc2vV7KkKakE57ndcFd2nzn1cbTFMuObdiAXBeNE=\n=bWS0\n-----END PGP SIGNATURE-----\n", "payload": "tree 8765327e84e000f6eb3f31f5aa0e96279fa9b1e0\nparent eb62779f2d6dc5cfe9208416e13392744b4e76ac\nparent cd3f4da244578a2ab4d17d10016c61b9191b21e4\nauthor Guillaume Gomez <guillaume1.gomez@gmail.com> 1631893279 +0200\ncommitter GitHub <noreply@github.com> 1631893279 +0200\n\nRollup merge of #88964 - GuillaumeGomez:version-help, r=Nemo157\n\nAdd rustdoc version into the help popup\n\nAfter a discussion with a rustdoc user about a specific behaviour, we realized we were not talking about the same version. To add on top of it, it was actually not that simple to find out the version since it was hosted documentation.\n\nSo to simplify things, I added the version into the help popup:\n\n![Screenshot from 2021-09-16 10-45-52](https://user-images.githubusercontent.com/3050060/133581128-b93b460a-e1cb-4a31-9f2f-97c7a916cfcc.png)\n\nDoes the version format looks or would you prefer that I add more information? We can also add the commit hash, commit date, host and release.\n\ncc `@rust-lang/rustdoc`\nr? `@jyn514`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/833358b96444cd63e211f1fc1e47fc87ffe5be28", "html_url": "https://github.com/rust-lang/rust/commit/833358b96444cd63e211f1fc1e47fc87ffe5be28", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/833358b96444cd63e211f1fc1e47fc87ffe5be28/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "eb62779f2d6dc5cfe9208416e13392744b4e76ac", "url": "https://api.github.com/repos/rust-lang/rust/commits/eb62779f2d6dc5cfe9208416e13392744b4e76ac", "html_url": "https://github.com/rust-lang/rust/commit/eb62779f2d6dc5cfe9208416e13392744b4e76ac"}, {"sha": "cd3f4da244578a2ab4d17d10016c61b9191b21e4", "url": "https://api.github.com/repos/rust-lang/rust/commits/cd3f4da244578a2ab4d17d10016c61b9191b21e4", "html_url": "https://github.com/rust-lang/rust/commit/cd3f4da244578a2ab4d17d10016c61b9191b21e4"}], "stats": {"total": 52, "additions": 39, "deletions": 13}, "files": [{"sha": "c1a83ad5820cb9067b329fc6590f783755198349", "filename": "src/librustdoc/html/render/write_shared.rs", "status": "modified", "additions": 12, "deletions": 4, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/833358b96444cd63e211f1fc1e47fc87ffe5be28/src%2Flibrustdoc%2Fhtml%2Frender%2Fwrite_shared.rs", "raw_url": "https://github.com/rust-lang/rust/raw/833358b96444cd63e211f1fc1e47fc87ffe5be28/src%2Flibrustdoc%2Fhtml%2Frender%2Fwrite_shared.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fwrite_shared.rs?ref=833358b96444cd63e211f1fc1e47fc87ffe5be28", "patch": "@@ -268,10 +268,18 @@ pub(super) fn write_shared(\n     // Maybe we can change the representation to move this out of main.js?\n     write_minify(\n         \"main.js\",\n-        static_files::MAIN_JS.replace(\n-            \"/* INSERT THEMES HERE */\",\n-            &format!(\" = {}\", serde_json::to_string(&themes).unwrap()),\n-        ),\n+        static_files::MAIN_JS\n+            .replace(\n+                \"/* INSERT THEMES HERE */\",\n+                &format!(\" = {}\", serde_json::to_string(&themes).unwrap()),\n+            )\n+            .replace(\n+                \"/* INSERT RUSTDOC_VERSION HERE */\",\n+                &format!(\n+                    \"rustdoc {}\",\n+                    rustc_interface::util::version_str().unwrap_or(\"unknown version\")\n+                ),\n+            ),\n         cx,\n         options,\n     )?;"}, {"sha": "eb7cc9309f41641c6212ca6e244e8ad6fd5b43ef", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 12, "deletions": 3, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/833358b96444cd63e211f1fc1e47fc87ffe5be28/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/833358b96444cd63e211f1fc1e47fc87ffe5be28/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=833358b96444cd63e211f1fc1e47fc87ffe5be28", "patch": "@@ -928,15 +928,24 @@ body.blur > :not(#help) {\n \tdisplay: block;\n \tmargin-right: 0.5rem;\n }\n-#help > div > span {\n+#help span.top, #help span.bottom {\n \ttext-align: center;\n \tdisplay: block;\n-\tmargin: 10px 0;\n \tfont-size: 18px;\n-\tborder-bottom: 1px solid #ccc;\n+\n+}\n+#help span.top {\n+\ttext-align: center;\n+\tdisplay: block;\n+\tmargin: 10px 0;\n+\tborder-bottom: 1px solid;\n \tpadding-bottom: 4px;\n \tmargin-bottom: 6px;\n }\n+#help span.bottom {\n+\tclear: both;\n+\tborder-top: 1px solid;\n+}\n #help dd { margin: 5px 35px; }\n #help .infos { padding-left: 0; }\n #help h1, #help h2 { margin-top: 0; }"}, {"sha": "c79801e830876f77c0720756da2c3fa398052e13", "filename": "src/librustdoc/html/static/css/themes/ayu.css", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/833358b96444cd63e211f1fc1e47fc87ffe5be28/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "raw_url": "https://github.com/rust-lang/rust/raw/833358b96444cd63e211f1fc1e47fc87ffe5be28/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css?ref=833358b96444cd63e211f1fc1e47fc87ffe5be28", "patch": "@@ -286,8 +286,8 @@ details.undocumented > summary::before {\n \tborder-radius: 4px;\n }\n \n-#help > div > span {\n-\tborder-bottom-color: #5c6773;\n+#help span.bottom, #help span.top {\n+\tborder-color: #5c6773;\n }\n \n .since {"}, {"sha": "d2e54070acd68621efadf5e506c9ffb9806aed1c", "filename": "src/librustdoc/html/static/css/themes/dark.css", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/833358b96444cd63e211f1fc1e47fc87ffe5be28/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/833358b96444cd63e211f1fc1e47fc87ffe5be28/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css?ref=833358b96444cd63e211f1fc1e47fc87ffe5be28", "patch": "@@ -242,8 +242,8 @@ details.undocumented > summary::before {\n \tborder-color: #bfbfbf;\n }\n \n-#help > div > span {\n-\tborder-bottom-color: #bfbfbf;\n+#help span.bottom, #help span.top {\n+\tborder-color: #bfbfbf;\n }\n \n #help dt {"}, {"sha": "25d810560c1469b98397fd2975ad686c82c1165a", "filename": "src/librustdoc/html/static/css/themes/light.css", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/833358b96444cd63e211f1fc1e47fc87ffe5be28/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "raw_url": "https://github.com/rust-lang/rust/raw/833358b96444cd63e211f1fc1e47fc87ffe5be28/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css?ref=833358b96444cd63e211f1fc1e47fc87ffe5be28", "patch": "@@ -232,8 +232,8 @@ details.undocumented > summary::before {\n \tborder-color: #bfbfbf;\n }\n \n-#help > div > span {\n-\tborder-bottom-color: #bfbfbf;\n+#help span.bottom, #help span.top {\n+\tborder-color: #bfbfbf;\n }\n \n .since {"}, {"sha": "e396fd9d288db1cc34da37279113f4a65683b0c7", "filename": "src/librustdoc/html/static/js/main.js", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/833358b96444cd63e211f1fc1e47fc87ffe5be28/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/833358b96444cd63e211f1fc1e47fc87ffe5be28/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js?ref=833358b96444cd63e211f1fc1e47fc87ffe5be28", "patch": "@@ -911,6 +911,7 @@ function hideThemeButtonState() {\n         });\n \n         var book_info = document.createElement(\"span\");\n+        book_info.className = \"top\";\n         book_info.innerHTML = \"You can find more information in \\\n             <a href=\\\"https://doc.rust-lang.org/rustdoc/\\\">the rustdoc book</a>.\";\n \n@@ -961,6 +962,14 @@ function hideThemeButtonState() {\n         container.appendChild(div_shortcuts);\n         container.appendChild(div_infos);\n \n+        var rustdoc_version = document.createElement(\"span\");\n+        rustdoc_version.className = \"bottom\";\n+        var rustdoc_version_code = document.createElement(\"code\");\n+        rustdoc_version_code.innerText = \"/* INSERT RUSTDOC_VERSION HERE */\";\n+        rustdoc_version.appendChild(rustdoc_version_code);\n+\n+        container.appendChild(rustdoc_version);\n+\n         popup.appendChild(container);\n         insertAfter(popup, searchState.outputElement());\n         // So that it's only built once and then it'll do nothing when called!"}]}