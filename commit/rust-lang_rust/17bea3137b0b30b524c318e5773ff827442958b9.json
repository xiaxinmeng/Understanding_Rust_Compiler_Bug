{"sha": "17bea3137b0b30b524c318e5773ff827442958b9", "node_id": "C_kwDOAAsO6NoAKDE3YmVhMzEzN2IwYjMwYjUyNGMzMThlNTc3M2ZmODI3NDQyOTU4Yjk", "commit": {"author": {"name": "Jason Newcomb", "email": "jsnewcomb@pm.me", "date": "2022-05-05T17:24:38Z"}, "committer": {"name": "Jason Newcomb", "email": "jsnewcomb@pm.me", "date": "2022-05-05T17:43:37Z"}, "message": "Revert hack fixing #2475 added in commit 034c81b76145a0514916f34713671b16f26988df. It's no longer needed.", "tree": {"sha": "8d2b7bb6922b9c09ecc115ae231132d1a04862c4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8d2b7bb6922b9c09ecc115ae231132d1a04862c4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/17bea3137b0b30b524c318e5773ff827442958b9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/17bea3137b0b30b524c318e5773ff827442958b9", "html_url": "https://github.com/rust-lang/rust/commit/17bea3137b0b30b524c318e5773ff827442958b9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/17bea3137b0b30b524c318e5773ff827442958b9/comments", "author": {"login": "Jarcho", "id": 7761774, "node_id": "MDQ6VXNlcjc3NjE3NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/7761774?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jarcho", "html_url": "https://github.com/Jarcho", "followers_url": "https://api.github.com/users/Jarcho/followers", "following_url": "https://api.github.com/users/Jarcho/following{/other_user}", "gists_url": "https://api.github.com/users/Jarcho/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jarcho/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jarcho/subscriptions", "organizations_url": "https://api.github.com/users/Jarcho/orgs", "repos_url": "https://api.github.com/users/Jarcho/repos", "events_url": "https://api.github.com/users/Jarcho/events{/privacy}", "received_events_url": "https://api.github.com/users/Jarcho/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Jarcho", "id": 7761774, "node_id": "MDQ6VXNlcjc3NjE3NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/7761774?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jarcho", "html_url": "https://github.com/Jarcho", "followers_url": "https://api.github.com/users/Jarcho/followers", "following_url": "https://api.github.com/users/Jarcho/following{/other_user}", "gists_url": "https://api.github.com/users/Jarcho/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jarcho/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jarcho/subscriptions", "organizations_url": "https://api.github.com/users/Jarcho/orgs", "repos_url": "https://api.github.com/users/Jarcho/repos", "events_url": "https://api.github.com/users/Jarcho/events{/privacy}", "received_events_url": "https://api.github.com/users/Jarcho/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7c21f91b15b7604f818565646b686d90f99d1baf", "url": "https://api.github.com/repos/rust-lang/rust/commits/7c21f91b15b7604f818565646b686d90f99d1baf", "html_url": "https://github.com/rust-lang/rust/commit/7c21f91b15b7604f818565646b686d90f99d1baf"}], "stats": {"total": 21, "additions": 5, "deletions": 16}, "files": [{"sha": "30dde2f0ef0982e8aa217353249cb12892cc2d32", "filename": "clippy_lints/src/attrs.rs", "status": "modified", "additions": 5, "deletions": 16, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/17bea3137b0b30b524c318e5773ff827442958b9/clippy_lints%2Fsrc%2Fattrs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/17bea3137b0b30b524c318e5773ff827442958b9/clippy_lints%2Fsrc%2Fattrs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fattrs.rs?ref=17bea3137b0b30b524c318e5773ff827442958b9", "patch": "@@ -6,7 +6,7 @@ use clippy_utils::msrvs;\n use clippy_utils::source::{first_line_of_span, is_present_in_source, snippet_opt, without_block_comments};\n use clippy_utils::{extract_msrv_attr, meets_msrv};\n use if_chain::if_chain;\n-use rustc_ast::{AttrKind, AttrStyle, Attribute, Lit, LitKind, MacArgs, MacArgsEq, MetaItemKind, NestedMetaItem};\n+use rustc_ast::{AttrKind, AttrStyle, Attribute, Lit, LitKind, MetaItemKind, NestedMetaItem};\n use rustc_errors::Applicability;\n use rustc_hir::{\n     Block, Expr, ExprKind, ImplItem, ImplItemKind, Item, ItemKind, StmtKind, TraitFn, TraitItem, TraitItemKind,\n@@ -586,21 +586,10 @@ impl EarlyLintPass for EarlyAttributes {\n \n fn check_empty_line_after_outer_attr(cx: &EarlyContext<'_>, item: &rustc_ast::Item) {\n     for attr in &item.attrs {\n-        let attr_item = if let AttrKind::Normal(ref attr, _) = attr.kind {\n-            attr\n-        } else {\n-            return;\n-        };\n-\n-        if attr.style == AttrStyle::Outer {\n-            if let MacArgs::Eq(_, MacArgsEq::Ast(expr)) = &attr_item.args\n-                && !matches!(expr.kind, rustc_ast::ExprKind::Lit(..)) {\n-                return;\n-            }\n-            if attr_item.args.inner_tokens().is_empty() || !is_present_in_source(cx, attr.span) {\n-                return;\n-            }\n-\n+        if matches!(attr.kind, AttrKind::Normal(..))\n+            && attr.style == AttrStyle::Outer\n+            && is_present_in_source(cx, attr.span)\n+        {\n             let begin_of_attr_to_item = Span::new(attr.span.lo(), item.span.lo(), item.span.ctxt(), item.span.parent());\n             let end_of_attr_to_item = Span::new(attr.span.hi(), item.span.lo(), item.span.ctxt(), item.span.parent());\n "}]}