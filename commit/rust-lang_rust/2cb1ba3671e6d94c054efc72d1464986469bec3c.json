{"sha": "2cb1ba3671e6d94c054efc72d1464986469bec3c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJjYjFiYTM2NzFlNmQ5NGMwNTRlZmM3MmQxNDY0OTg2NDY5YmVjM2M=", "commit": {"author": {"name": "hi-rustin", "email": "rustin.liu@gmail.com", "date": "2021-05-16T02:18:28Z"}, "committer": {"name": "hi-rustin", "email": "rustin.liu@gmail.com", "date": "2021-05-16T02:18:28Z"}, "message": "More tests for issue-85255", "tree": {"sha": "657559b8fd3705ac4f29549c29fb4e9b8514d3bc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/657559b8fd3705ac4f29549c29fb4e9b8514d3bc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2cb1ba3671e6d94c054efc72d1464986469bec3c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2cb1ba3671e6d94c054efc72d1464986469bec3c", "html_url": "https://github.com/rust-lang/rust/commit/2cb1ba3671e6d94c054efc72d1464986469bec3c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2cb1ba3671e6d94c054efc72d1464986469bec3c/comments", "author": {"login": "hi-rustin", "id": 29879298, "node_id": "MDQ6VXNlcjI5ODc5Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/29879298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hi-rustin", "html_url": "https://github.com/hi-rustin", "followers_url": "https://api.github.com/users/hi-rustin/followers", "following_url": "https://api.github.com/users/hi-rustin/following{/other_user}", "gists_url": "https://api.github.com/users/hi-rustin/gists{/gist_id}", "starred_url": "https://api.github.com/users/hi-rustin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hi-rustin/subscriptions", "organizations_url": "https://api.github.com/users/hi-rustin/orgs", "repos_url": "https://api.github.com/users/hi-rustin/repos", "events_url": "https://api.github.com/users/hi-rustin/events{/privacy}", "received_events_url": "https://api.github.com/users/hi-rustin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "hi-rustin", "id": 29879298, "node_id": "MDQ6VXNlcjI5ODc5Mjk4", "avatar_url": "https://avatars.githubusercontent.com/u/29879298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hi-rustin", "html_url": "https://github.com/hi-rustin", "followers_url": "https://api.github.com/users/hi-rustin/followers", "following_url": "https://api.github.com/users/hi-rustin/following{/other_user}", "gists_url": "https://api.github.com/users/hi-rustin/gists{/gist_id}", "starred_url": "https://api.github.com/users/hi-rustin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hi-rustin/subscriptions", "organizations_url": "https://api.github.com/users/hi-rustin/orgs", "repos_url": "https://api.github.com/users/hi-rustin/repos", "events_url": "https://api.github.com/users/hi-rustin/events{/privacy}", "received_events_url": "https://api.github.com/users/hi-rustin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d565c7488749fd0e998d6be21efeb20354e4696d", "url": "https://api.github.com/repos/rust-lang/rust/commits/d565c7488749fd0e998d6be21efeb20354e4696d", "html_url": "https://github.com/rust-lang/rust/commit/d565c7488749fd0e998d6be21efeb20354e4696d"}], "stats": {"total": 87, "additions": 82, "deletions": 5}, "files": [{"sha": "8c4aad66d474dd2d2e7e9dd4194244ec0200f245", "filename": "src/test/ui/lint/dead-code/issue-85255.rs", "status": "modified", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/2cb1ba3671e6d94c054efc72d1464986469bec3c/src%2Ftest%2Fui%2Flint%2Fdead-code%2Fissue-85255.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2cb1ba3671e6d94c054efc72d1464986469bec3c/src%2Ftest%2Fui%2Flint%2Fdead-code%2Fissue-85255.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fdead-code%2Fissue-85255.rs?ref=2cb1ba3671e6d94c054efc72d1464986469bec3c", "patch": "@@ -2,6 +2,7 @@\n // check-pass\n \n #![warn(dead_code)]\n+#![feature(crate_visibility_modifier)]\n \n struct Foo {\n     a: i32, //~ WARNING: field is never read\n@@ -15,8 +16,36 @@ impl Bar {\n     pub fn b(&self) -> i32 { 6 } //~ WARNING: associated function is never used\n }\n \n+pub(crate) struct Foo1 {\n+    a: i32, //~ WARNING: field is never read\n+    pub b: i32, //~ WARNING: field is never read\n+}\n+\n+pub(crate) struct Bar1;\n+\n+impl Bar1 {\n+    fn a(&self) -> i32 { 5 } //~ WARNING: associated function is never used\n+    pub fn b(&self) -> i32 { 6 } //~ WARNING: associated function is never used\n+}\n+\n+crate struct Foo2 {\n+    a: i32, //~ WARNING: field is never read\n+    pub b: i32, //~ WARNING: field is never read\n+}\n+\n+crate struct Bar2;\n+\n+impl Bar2 {\n+    fn a(&self) -> i32 { 5 } //~ WARNING: associated function is never used\n+    pub fn b(&self) -> i32 { 6 } //~ WARNING: associated function is never used\n+}\n+\n \n fn main() {\n     let _ = Foo { a: 1, b: 2 };\n     let _ = Bar;\n+    let _ = Foo1 { a: 1, b: 2 };\n+    let _ = Bar1;\n+    let _ = Foo2 { a: 1, b: 2 };\n+    let _ = Bar2;\n }"}, {"sha": "736b1a20422768d43ecf27988e19cf99ffaa2f23", "filename": "src/test/ui/lint/dead-code/issue-85255.stderr", "status": "modified", "additions": 53, "deletions": 5, "changes": 58, "blob_url": "https://github.com/rust-lang/rust/blob/2cb1ba3671e6d94c054efc72d1464986469bec3c/src%2Ftest%2Fui%2Flint%2Fdead-code%2Fissue-85255.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2cb1ba3671e6d94c054efc72d1464986469bec3c/src%2Ftest%2Fui%2Flint%2Fdead-code%2Fissue-85255.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fdead-code%2Fissue-85255.stderr?ref=2cb1ba3671e6d94c054efc72d1464986469bec3c", "patch": "@@ -1,5 +1,5 @@\n warning: field is never read: `a`\n-  --> $DIR/issue-85255.rs:7:5\n+  --> $DIR/issue-85255.rs:8:5\n    |\n LL |     a: i32,\n    |     ^^^^^^\n@@ -11,22 +11,70 @@ LL | #![warn(dead_code)]\n    |         ^^^^^^^^^\n \n warning: field is never read: `b`\n-  --> $DIR/issue-85255.rs:8:5\n+  --> $DIR/issue-85255.rs:9:5\n+   |\n+LL |     pub b: i32,\n+   |     ^^^^^^^^^^\n+\n+warning: associated function is never used: `a`\n+  --> $DIR/issue-85255.rs:15:8\n+   |\n+LL |     fn a(&self) -> i32 { 5 }\n+   |        ^\n+\n+warning: associated function is never used: `b`\n+  --> $DIR/issue-85255.rs:16:12\n+   |\n+LL |     pub fn b(&self) -> i32 { 6 }\n+   |            ^\n+\n+warning: field is never read: `a`\n+  --> $DIR/issue-85255.rs:20:5\n+   |\n+LL |     a: i32,\n+   |     ^^^^^^\n+\n+warning: field is never read: `b`\n+  --> $DIR/issue-85255.rs:21:5\n+   |\n+LL |     pub b: i32,\n+   |     ^^^^^^^^^^\n+\n+warning: associated function is never used: `a`\n+  --> $DIR/issue-85255.rs:27:8\n+   |\n+LL |     fn a(&self) -> i32 { 5 }\n+   |        ^\n+\n+warning: associated function is never used: `b`\n+  --> $DIR/issue-85255.rs:28:12\n+   |\n+LL |     pub fn b(&self) -> i32 { 6 }\n+   |            ^\n+\n+warning: field is never read: `a`\n+  --> $DIR/issue-85255.rs:32:5\n+   |\n+LL |     a: i32,\n+   |     ^^^^^^\n+\n+warning: field is never read: `b`\n+  --> $DIR/issue-85255.rs:33:5\n    |\n LL |     pub b: i32,\n    |     ^^^^^^^^^^\n \n warning: associated function is never used: `a`\n-  --> $DIR/issue-85255.rs:14:8\n+  --> $DIR/issue-85255.rs:39:8\n    |\n LL |     fn a(&self) -> i32 { 5 }\n    |        ^\n \n warning: associated function is never used: `b`\n-  --> $DIR/issue-85255.rs:15:12\n+  --> $DIR/issue-85255.rs:40:12\n    |\n LL |     pub fn b(&self) -> i32 { 6 }\n    |            ^\n \n-warning: 4 warnings emitted\n+warning: 12 warnings emitted\n "}]}