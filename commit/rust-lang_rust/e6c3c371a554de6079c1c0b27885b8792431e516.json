{"sha": "e6c3c371a554de6079c1c0b27885b8792431e516", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU2YzNjMzcxYTU1NGRlNjA3OWMxYzBiMjc4ODViODc5MjQzMWU1MTY=", "commit": {"author": {"name": "Tim Chevalier", "email": "chevalier@alum.wellesley.edu", "date": "2013-04-17T20:53:48Z"}, "committer": {"name": "Tim Chevalier", "email": "chevalier@alum.wellesley.edu", "date": "2013-04-17T21:32:40Z"}, "message": "rustpkg: Add a few tests\n\nThere's no test runner for rustpkg yet; just sketching out a few\nbasic test scenarios. pass/ contains packages that should compile\nsuccessfully, whereas fail/ contains packages that should fail\nto build.", "tree": {"sha": "541f25e6fdf6eec9c6ffd9c8da39d5590ac1cc4d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/541f25e6fdf6eec9c6ffd9c8da39d5590ac1cc4d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e6c3c371a554de6079c1c0b27885b8792431e516", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e6c3c371a554de6079c1c0b27885b8792431e516", "html_url": "https://github.com/rust-lang/rust/commit/e6c3c371a554de6079c1c0b27885b8792431e516", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e6c3c371a554de6079c1c0b27885b8792431e516/comments", "author": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "committer": {"login": "catamorphism", "id": 427212, "node_id": "MDQ6VXNlcjQyNzIxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/427212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/catamorphism", "html_url": "https://github.com/catamorphism", "followers_url": "https://api.github.com/users/catamorphism/followers", "following_url": "https://api.github.com/users/catamorphism/following{/other_user}", "gists_url": "https://api.github.com/users/catamorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/catamorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/catamorphism/subscriptions", "organizations_url": "https://api.github.com/users/catamorphism/orgs", "repos_url": "https://api.github.com/users/catamorphism/repos", "events_url": "https://api.github.com/users/catamorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/catamorphism/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c01c3d9fc6e28b8260894c9522eb29e29874dcbd", "url": "https://api.github.com/repos/rust-lang/rust/commits/c01c3d9fc6e28b8260894c9522eb29e29874dcbd", "html_url": "https://github.com/rust-lang/rust/commit/c01c3d9fc6e28b8260894c9522eb29e29874dcbd"}], "stats": {"total": 161, "additions": 161, "deletions": 0}, "files": [{"sha": "c9c1f00fb082a57f23274a97d06e4813b84fc729", "filename": "src/librustpkg/testsuite/fail/no-inferred-crates/zzyzx.rs", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Ffail%2Fno-inferred-crates%2Fzzyzx.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Ffail%2Fno-inferred-crates%2Fzzyzx.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Ffail%2Fno-inferred-crates%2Fzzyzx.rs?ref=e6c3c371a554de6079c1c0b27885b8792431e516", "patch": "@@ -0,0 +1,22 @@\n+// Copyright 2013 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+/*\n+The test runner should check that, after `rustpkg build hello-world`:\n+  * testsuite/hello-world/build/ exists\n+  * testsuite/hello-world/build/ contains an executable named hello-world\n+  * testsuite/hello-world/build/ does not contain a library\n+*/\n+\n+use core::io;\n+\n+fn main() {\n+    io::println(~\"Hello world!\");\n+}"}, {"sha": "e300c2a3295a3849e17476a1969fc458e304171d", "filename": "src/librustpkg/testsuite/pass/fancy-lib/bar.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Ffancy-lib%2Fbar.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Ffancy-lib%2Fbar.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Ffancy-lib%2Fbar.rs?ref=e6c3c371a554de6079c1c0b27885b8792431e516", "patch": "@@ -0,0 +1,3 @@\n+pub fn assert_true() {\n+    assert!(true);\n+}"}, {"sha": "55261a820981ab2735c1e34e2c4c2efdf3c81753", "filename": "src/librustpkg/testsuite/pass/fancy-lib/fancy-lib.rc", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Ffancy-lib%2Ffancy-lib.rc", "raw_url": "https://github.com/rust-lang/rust/raw/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Ffancy-lib%2Ffancy-lib.rc", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Ffancy-lib%2Ffancy-lib.rc?ref=e6c3c371a554de6079c1c0b27885b8792431e516", "patch": "@@ -0,0 +1,24 @@\n+// Copyright 2013 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+/*\n+The test runner should check that, after `rustpkg build fancy-lib`:\n+  * testsuite/fancy-lib/build/ exists\n+  * testsuite/fancy-lib/build/ contains a file called generated.rs\n+  * testsuite/fancy-lib/build/ contains a library named libfancy_lib\n+  * testsuite/fancy-lib/build/ does not contain an executable\n+  *\n+*/\n+\n+extern mod std;\n+\n+pub mod foo;\n+pub mod bar;\n+#[path = \"build/generated.rs\"] pub mod generated;"}, {"sha": "16c384ad8b8c1a05fb34c8191f6986766deb48e4", "filename": "src/librustpkg/testsuite/pass/fancy-lib/fancy-lib.rs", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Ffancy-lib%2Ffancy-lib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Ffancy-lib%2Ffancy-lib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Ffancy-lib%2Ffancy-lib.rs?ref=e6c3c371a554de6079c1c0b27885b8792431e516", "patch": "@@ -0,0 +1,24 @@\n+// Copyright 2013 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+/*\n+The test runner should check that, after `rustpkg build fancy-lib`:\n+  * testsuite/fancy-lib/build/ exists\n+  * testsuite/fancy-lib/build/ contains a file called generated.rs\n+  * testsuite/fancy-lib/build/ contains a library named libfancy_lib\n+  * testsuite/fancy-lib/build/ does not contain an executable\n+  *\n+*/\n+\n+extern mod std;\n+\n+pub mod foo;\n+pub mod bar;\n+pub mod generated;"}, {"sha": "4b3f3923d058f61345038caaa2a2511c185a1b44", "filename": "src/librustpkg/testsuite/pass/fancy-lib/foo.rs", "status": "added", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Ffancy-lib%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Ffancy-lib%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Ffancy-lib%2Ffoo.rs?ref=e6c3c371a554de6079c1c0b27885b8792431e516", "patch": "@@ -0,0 +1,2 @@\n+pub fn do_nothing() {\n+}\n\\ No newline at end of file"}, {"sha": "6d3495f2b2869e0438cdf45b8302845e0f86f9f4", "filename": "src/librustpkg/testsuite/pass/fancy-lib/pkg.rs", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Ffancy-lib%2Fpkg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Ffancy-lib%2Fpkg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Ffancy-lib%2Fpkg.rs?ref=e6c3c371a554de6079c1c0b27885b8792431e516", "patch": "@@ -0,0 +1,17 @@\n+// Copyright 2013 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+pub fn main() {\n+    let cwd = os::getcwd();\n+    debug!(\"cwd = %s\", cwd.to_str());\n+    let file = io::file_writer(&Path(~\"fancy-lib/build/generated.rs\"),\n+                               [io::Create]).get();\n+    file.write_str(\"pub fn wheeeee() { for [1, 2, 3].each() |_| { assert!(true); } }\");\n+}\n\\ No newline at end of file"}, {"sha": "c9c1f00fb082a57f23274a97d06e4813b84fc729", "filename": "src/librustpkg/testsuite/pass/hello-world/main.rs", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fhello-world%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fhello-world%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fhello-world%2Fmain.rs?ref=e6c3c371a554de6079c1c0b27885b8792431e516", "patch": "@@ -0,0 +1,22 @@\n+// Copyright 2013 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+/*\n+The test runner should check that, after `rustpkg build hello-world`:\n+  * testsuite/hello-world/build/ exists\n+  * testsuite/hello-world/build/ contains an executable named hello-world\n+  * testsuite/hello-world/build/ does not contain a library\n+*/\n+\n+use core::io;\n+\n+fn main() {\n+    io::println(~\"Hello world!\");\n+}"}, {"sha": "e300c2a3295a3849e17476a1969fc458e304171d", "filename": "src/librustpkg/testsuite/pass/simple-lib/bar.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsimple-lib%2Fbar.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsimple-lib%2Fbar.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsimple-lib%2Fbar.rs?ref=e6c3c371a554de6079c1c0b27885b8792431e516", "patch": "@@ -0,0 +1,3 @@\n+pub fn assert_true() {\n+    assert!(true);\n+}"}, {"sha": "4b3f3923d058f61345038caaa2a2511c185a1b44", "filename": "src/librustpkg/testsuite/pass/simple-lib/foo.rs", "status": "added", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsimple-lib%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsimple-lib%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsimple-lib%2Ffoo.rs?ref=e6c3c371a554de6079c1c0b27885b8792431e516", "patch": "@@ -0,0 +1,2 @@\n+pub fn do_nothing() {\n+}\n\\ No newline at end of file"}, {"sha": "1cdca6cdd5d87f3208ac2d85c9ba255447c59dbf", "filename": "src/librustpkg/testsuite/pass/simple-lib/lib.rs", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsimple-lib%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsimple-lib%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsimple-lib%2Flib.rs?ref=e6c3c371a554de6079c1c0b27885b8792431e516", "patch": "@@ -0,0 +1,21 @@\n+// Copyright 2013 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+/*\n+The test runner should check that, after `rustpkg build simple-lib`:\n+  * testsuite/simple-lib/build/ exists\n+  * testsuite/simple-lib/build/ contains a library named libsimple_lib\n+  * testsuite/simple-lib/build/ does not contain an executable\n+*/\n+\n+extern mod std;\n+\n+pub mod foo;\n+pub mod bar;"}, {"sha": "1cdca6cdd5d87f3208ac2d85c9ba255447c59dbf", "filename": "src/librustpkg/testsuite/pass/simple-lib/simple-lib.rc", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsimple-lib%2Fsimple-lib.rc", "raw_url": "https://github.com/rust-lang/rust/raw/e6c3c371a554de6079c1c0b27885b8792431e516/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsimple-lib%2Fsimple-lib.rc", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Ftestsuite%2Fpass%2Fsimple-lib%2Fsimple-lib.rc?ref=e6c3c371a554de6079c1c0b27885b8792431e516", "patch": "@@ -0,0 +1,21 @@\n+// Copyright 2013 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+/*\n+The test runner should check that, after `rustpkg build simple-lib`:\n+  * testsuite/simple-lib/build/ exists\n+  * testsuite/simple-lib/build/ contains a library named libsimple_lib\n+  * testsuite/simple-lib/build/ does not contain an executable\n+*/\n+\n+extern mod std;\n+\n+pub mod foo;\n+pub mod bar;"}]}