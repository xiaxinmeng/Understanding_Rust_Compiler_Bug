{"sha": "622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c", "node_id": "C_kwDOAAsO6NoAKDYyMjI0NGFjNTgzMmRiYjJhYjFlNGY0M2VhOGYxYzMzYjZiMDFiM2M", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2022-05-23T09:23:38Z"}, "committer": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2022-05-23T09:23:38Z"}, "message": "Add some regression tests for #90400", "tree": {"sha": "e593c2db06cc91bbbcb4913e7eb6d1353174f467", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e593c2db06cc91bbbcb4913e7eb6d1353174f467"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEClCZYSKPPkQPouAvN5zu/dY+XdcFAmKLUpoACgkQN5zu/dY+\nXdfhag//Tqtq7DVKFD0kYPxEVV0/y1ecYUPtOUeEBargrtxrCBNi/t1fCJcEziJj\n7+g2lIr+cjUpB4engzGBrCGe9s5tdnORvxldpDNcDIP1J08FRx14zUnbQ79jHhz1\nvuxZbDrToysUB0NTMQ1f8cC8gBWX9QD1iQg87LHmzRLXTeEakjzh3HB53k+mxH3i\nEbXcnNdm34mJHTEbicIZcdvzO8q8+pnVvuVSwUB0Yn60fx5PcAkv2cvN3+aVXbmv\nm55CuGCkYqvSykjJWVXjskKCeK3te11hAsUy0MhUIS0AA0ztAKIPrESFFFAYqtmX\nWOZOV4rwFmm0+2/xpHr4+MN82wDIpn5U3HXhhRACLXzkAyxHmeDuyx5vDfOB9rQr\nybz/3HdxWbuJh/vhB+Xr9pPXn7CYk0Q8P1T0pZtvrAInPAbR370ZUViORItMt1tO\nIgRLtoSjDHwOXutLeIOnfXNu8YBptBvd/6TflaQwsZJYSxkm32YM9yQnwM7ZYNue\nq39A6/cNe4ZLM92l0+3vrWRSc889pD6viLzAEczAvNpqjOErDcOpRdce/ygx8aDE\nzH9RVKCNvSiAIkDIgLG+MmLBPcsx/5c+1ichds/2QmuE75waI7N8u5GV56SBY2Mc\nStbFe9mzrNfEP8JqsXit0GVdjdeRAJPNLyBD2C0lzrtNB8UKGxI=\n=N1Uj\n-----END PGP SIGNATURE-----", "payload": "tree e593c2db06cc91bbbcb4913e7eb6d1353174f467\nparent 03c8b0b6edb22d0c3a935a16ca5f068728da4b26\nauthor Yuki Okushi <jtitor@2k36.org> 1653297818 +0900\ncommitter Yuki Okushi <jtitor@2k36.org> 1653297818 +0900\n\nAdd some regression tests for #90400\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c", "html_url": "https://github.com/rust-lang/rust/commit/622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "03c8b0b6edb22d0c3a935a16ca5f068728da4b26", "url": "https://api.github.com/repos/rust-lang/rust/commits/03c8b0b6edb22d0c3a935a16ca5f068728da4b26", "html_url": "https://github.com/rust-lang/rust/commit/03c8b0b6edb22d0c3a935a16ca5f068728da4b26"}], "stats": {"total": 106, "additions": 106, "deletions": 0}, "files": [{"sha": "8550a3e86379e8ea1d08f02bae56b4706f6cfd3b", "filename": "src/test/ui/type-alias-impl-trait/issue-90400-1.rs", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-1.rs?ref=622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c", "patch": "@@ -0,0 +1,30 @@\n+// Regression test for #90400,\n+// taken from https://github.com/rust-lang/rust/issues/90400#issuecomment-954927836\n+\n+#![feature(generic_associated_types)]\n+#![feature(type_alias_impl_trait)]\n+\n+trait Bar {\n+    fn bar(&self);\n+}\n+\n+trait Foo {\n+    type FooFn<B>: FnOnce();\n+\n+    fn foo<B: Bar>(&self, bar: B) -> Self::FooFn<B>;\n+}\n+\n+struct MyFoo;\n+\n+impl Foo for MyFoo {\n+    type FooFn<B> = impl FnOnce();\n+\n+    fn foo<B: Bar>(&self, bar: B) -> Self::FooFn<B> {\n+        move || bar.bar() //~ ERROR: the trait bound `B: Bar` is not satisfied\n+    }\n+}\n+\n+fn main() {\n+    let boom: <MyFoo as Foo>::FooFn<u32> = unsafe { core::mem::zeroed() };\n+    boom();\n+}"}, {"sha": "428a1074031ee5ebc96403d334d701172eac3097", "filename": "src/test/ui/type-alias-impl-trait/issue-90400-1.stderr", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-1.stderr?ref=622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c", "patch": "@@ -0,0 +1,19 @@\n+error[E0277]: the trait bound `B: Bar` is not satisfied\n+  --> $DIR/issue-90400-1.rs:23:9\n+   |\n+LL |         move || bar.bar()\n+   |         ^^^^^^^^^^^^^^^^^ the trait `Bar` is not implemented for `B`\n+   |\n+note: required by a bound in `<MyFoo as Foo>::foo`\n+  --> $DIR/issue-90400-1.rs:22:15\n+   |\n+LL |     fn foo<B: Bar>(&self, bar: B) -> Self::FooFn<B> {\n+   |               ^^^ required by this bound in `<MyFoo as Foo>::foo`\n+help: consider restricting type parameter `B`\n+   |\n+LL |     type FooFn<B: Bar> = impl FnOnce();\n+   |                 +++++\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0277`."}, {"sha": "2b369bb8a2b92efd56e599cd02ee4852e5afab14", "filename": "src/test/ui/type-alias-impl-trait/issue-90400-2.rs", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-2.rs?ref=622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c", "patch": "@@ -0,0 +1,38 @@\n+// Regression test for #90400,\n+// taken from https://github.com/rust-lang/rust/issues/90400#issuecomment-954927836\n+\n+#![feature(generic_associated_types)]\n+#![feature(type_alias_impl_trait)]\n+\n+trait Bar {\n+    fn bar(&self);\n+}\n+\n+trait Baz {\n+    fn baz(&self);\n+}\n+\n+trait Foo {\n+    type FooFn<B>: Baz;\n+\n+    fn foo<B: Bar>(&self, bar: B) -> Self::FooFn<B>;\n+}\n+\n+struct MyFoo;\n+impl Foo for MyFoo {\n+    type FooFn<B> = impl Baz;\n+\n+    fn foo<B: Bar>(&self, bar: B) -> Self::FooFn<B> {\n+        MyBaz(bar) //~ ERROR: the trait bound `B: Bar` is not satisfied\n+    }\n+}\n+\n+struct MyBaz<B: Bar>(B);\n+impl<B: Bar> Baz for MyBaz<B> {\n+    fn baz(&self) {}\n+}\n+\n+fn main() {\n+    let boom: <MyFoo as Foo>::FooFn<u32> = unsafe { core::mem::zeroed() };\n+    boom.baz();\n+}"}, {"sha": "5da05a4390f7b98a2cf39a8724bf2f9376ef0a31", "filename": "src/test/ui/type-alias-impl-trait/issue-90400-2.stderr", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype-alias-impl-trait%2Fissue-90400-2.stderr?ref=622244ac5832dbb2ab1e4f43ea8f1c33b6b01b3c", "patch": "@@ -0,0 +1,19 @@\n+error[E0277]: the trait bound `B: Bar` is not satisfied\n+  --> $DIR/issue-90400-2.rs:26:9\n+   |\n+LL |         MyBaz(bar)\n+   |         ^^^^^^^^^^ the trait `Bar` is not implemented for `B`\n+   |\n+note: required because of the requirements on the impl of `Baz` for `MyBaz<B>`\n+  --> $DIR/issue-90400-2.rs:31:14\n+   |\n+LL | impl<B: Bar> Baz for MyBaz<B> {\n+   |              ^^^     ^^^^^^^^\n+help: consider restricting type parameter `B`\n+   |\n+LL |     type FooFn<B: Bar> = impl Baz;\n+   |                 +++++\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0277`."}]}