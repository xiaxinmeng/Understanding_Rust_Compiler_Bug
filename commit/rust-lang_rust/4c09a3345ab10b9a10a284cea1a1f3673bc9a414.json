{"sha": "4c09a3345ab10b9a10a284cea1a1f3673bc9a414", "node_id": "C_kwDOAAsO6NoAKDRjMDlhMzM0NWFiMTBiOWExMGEyODRjZWExYTFmMzY3M2JjOWE0MTQ", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-05-08T08:45:20Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-05-08T08:45:20Z"}, "message": "Auto merge of #96659 - thatzopoulos:issue-90679-fix, r=Mark-Simulacrum\n\nImprove error for missing cmake\n\nThis PR updates the error message for a missing `cmake` to be more in line with the error message for a missing installation of `ninja`.\nThe original issue, (#90679), suggests that both `ninja` and `cmake` are only needed for building LLVM, so I have included the suggestion from `ninja` to set `download-ci-llvm = true` if the user would rather download LLVM. If `cmake` actually is used in other areas, I can remove that part of the message.\n\nFixes: #90679", "tree": {"sha": "a6366b9752e14d4475573861e92056622f70bb1d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a6366b9752e14d4475573861e92056622f70bb1d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4c09a3345ab10b9a10a284cea1a1f3673bc9a414", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4c09a3345ab10b9a10a284cea1a1f3673bc9a414", "html_url": "https://github.com/rust-lang/rust/commit/4c09a3345ab10b9a10a284cea1a1f3673bc9a414", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4c09a3345ab10b9a10a284cea1a1f3673bc9a414/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "30046ce1fe8d00e576cc7b91404c7cf79aaa5a3b", "url": "https://api.github.com/repos/rust-lang/rust/commits/30046ce1fe8d00e576cc7b91404c7cf79aaa5a3b", "html_url": "https://github.com/rust-lang/rust/commit/30046ce1fe8d00e576cc7b91404c7cf79aaa5a3b"}, {"sha": "bdca7376fd9f800f57b2ee17d95af3b327baa332", "url": "https://api.github.com/repos/rust-lang/rust/commits/bdca7376fd9f800f57b2ee17d95af3b327baa332", "html_url": "https://github.com/rust-lang/rust/commit/bdca7376fd9f800f57b2ee17d95af3b327baa332"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "64c5dd7aea7202ef50a4ba49cc3738c6727c7f16", "filename": "src/bootstrap/sanity.rs", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/4c09a3345ab10b9a10a284cea1a1f3673bc9a414/src%2Fbootstrap%2Fsanity.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4c09a3345ab10b9a10a284cea1a1f3673bc9a414/src%2Fbootstrap%2Fsanity.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fsanity.rs?ref=4c09a3345ab10b9a10a284cea1a1f3673bc9a414", "patch": "@@ -94,7 +94,18 @@ pub fn check(build: &mut Build) {\n             .any(|build_llvm_ourselves| build_llvm_ourselves);\n     let need_cmake = building_llvm || build.config.any_sanitizers_enabled();\n     if need_cmake {\n-        cmd_finder.must_have(\"cmake\");\n+        if cmd_finder.maybe_have(\"cmake\").is_none() {\n+            eprintln!(\n+                \"\n+Couldn't find required command: cmake\n+\n+You should install cmake, or set `download-ci-llvm = true` in the\n+`[llvm]` section section of `config.toml` to download LLVM rather\n+than building it.\n+\"\n+            );\n+            std::process::exit(1);\n+        }\n     }\n \n     build.config.python = build"}]}