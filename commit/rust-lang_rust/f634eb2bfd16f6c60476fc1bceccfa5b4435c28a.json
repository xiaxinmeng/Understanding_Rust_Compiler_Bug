{"sha": "f634eb2bfd16f6c60476fc1bceccfa5b4435c28a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY2MzRlYjJiZmQxNmY2YzYwNDc2ZmMxYmNlY2NmYTViNDQzNWMyOGE=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-09-30T23:11:47Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-09-30T23:18:19Z"}, "message": "Make config of static stdlib more consistent with rest of makefile\n\nI haven't tested if it actually works. Static stdlib is probably becoming\nbitrotted.", "tree": {"sha": "c29991b6353a530ce38d8fdcb3d3bc8c8af91bf7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c29991b6353a530ce38d8fdcb3d3bc8c8af91bf7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f634eb2bfd16f6c60476fc1bceccfa5b4435c28a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f634eb2bfd16f6c60476fc1bceccfa5b4435c28a", "html_url": "https://github.com/rust-lang/rust/commit/f634eb2bfd16f6c60476fc1bceccfa5b4435c28a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f634eb2bfd16f6c60476fc1bceccfa5b4435c28a/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "38c67a4c8d9b0c582c90926ebf23a3672bb5c013", "url": "https://api.github.com/repos/rust-lang/rust/commits/38c67a4c8d9b0c582c90926ebf23a3672bb5c013", "html_url": "https://github.com/rust-lang/rust/commit/38c67a4c8d9b0c582c90926ebf23a3672bb5c013"}], "stats": {"total": 24, "additions": 14, "deletions": 10}, "files": [{"sha": "7bd1c28e85106b98d4778ac851ff0c8934889eaa", "filename": "Makefile.in", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/f634eb2bfd16f6c60476fc1bceccfa5b4435c28a/Makefile.in", "raw_url": "https://github.com/rust-lang/rust/raw/f634eb2bfd16f6c60476fc1bceccfa5b4435c28a/Makefile.in", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Makefile.in?ref=f634eb2bfd16f6c60476fc1bceccfa5b4435c28a", "patch": "@@ -53,12 +53,6 @@ CFG_RUSTLLVM :=$(call CFG_LIB_NAME,rustllvm)\n CFG_STDLIB :=$(call CFG_LIB_NAME,std)\n CFG_LIBRUSTC :=$(call CFG_LIB_NAME,rustc)\n \n-ifdef CFG_DISABLE_SHAREDSTD\n-  CFG_STDLIB_DEFAULT = $(1)/lib/libstd.rlib\n-else\n-  CFG_STDLIB_DEFAULT = $(2)/lib/$(CFG_STDLIB)\n-endif\n-\n # version-string calculation\n CFG_GIT_DIR := $(CFG_SRC_DIR).git\n CFG_VERSION = prerelease\n@@ -185,10 +179,16 @@ TARGET_HOST_ROOT$(1) = $$(TARGET_ROOT$(1)$$(CFG_HOST_TRIPLE))\n TARGET_HOST_BIN$(1) = $$(TARGET_BIN$(1)$$(CFG_HOST_TRIPLE))\n TARGET_HOST_LIB$(1) = $$(TARGET_LIB$(1)$$(CFG_HOST_TRIPLE))\n \n+ifdef CFG_DISABLE_SHAREDSTD\n+  HOST_STDLIB_DEFAULT$(1) = $$(HOST_LIB$(1))/libstd.rlib\n+else\n+  HOST_STDLIB_DEFAULT$(1) = $$(HOST_LIB$(1))/$(CFG_STDLIB)\n+endif\n+\n ifdef CFG_DISABLE_SHAREDSTD\n SREQ$(1)$(2) = $$(HOST_BIN$(1))/rustc$(X)          \\\n            $$(HOST_LIB$(1))/$$(CFG_RUNTIME)     \\\n-           $$(call CFG_STDLIB_DEFAULT,stage$(1),stage$(1)) \\\n+           $$(HOST_STDLIB_DEFAULT$(1)) \\\n            $$(HOST_LIB$(1))/$$(CFG_RUSTLLVM)    \\\n            $$(TARGET_LIB$(1)$(2))/$$(CFG_RUNTIME) \\\n            $$(TARGET_LIB$(1)$(2))/$$(CFG_STDLIB) \\\n@@ -198,7 +198,7 @@ SREQ$(1)$(2) = $$(HOST_BIN$(1))/rustc$(X)          \\\n else\n SREQ$(1)$(2) = $$(HOST_BIN$(1))/rustc$(X)          \\\n            $$(HOST_LIB$(1))/$$(CFG_RUNTIME)     \\\n-           $$(call CFG_STDLIB_DEFAULT,stage$(1),stage$(1)) \\\n+           $$(HOST_STDLIB_DEFAULT$(1)) \\\n            $$(HOST_LIB$(1))/$$(CFG_RUSTLLVM)    \\\n            $$(TARGET_LIB$(1)$(2))/$$(CFG_RUNTIME) \\\n            $$(TARGET_LIB$(1)$(2))/$$(CFG_STDLIB) \\"}, {"sha": "f64c0088d29461c9740bad88b2798a2db7a4e2da", "filename": "mk/stageN.mk", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/f634eb2bfd16f6c60476fc1bceccfa5b4435c28a/mk%2FstageN.mk", "raw_url": "https://github.com/rust-lang/rust/raw/f634eb2bfd16f6c60476fc1bceccfa5b4435c28a/mk%2FstageN.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2FstageN.mk?ref=f634eb2bfd16f6c60476fc1bceccfa5b4435c28a", "patch": "@@ -29,7 +29,7 @@ $$(HOST_LIB$(2))/%.o: $$(HOST_LIB$(2))/%.s\n \n $$(HOST_BIN$(2))/rustc$$(X): $$(COMPILER_CRATE) $$(COMPILER_INPUTS)          \\\n                           $$(HOST_LIB$(2))/$$(CFG_RUNTIME)                       \\\n-                          $$(call CFG_STDLIB_DEFAULT,stage$(1),stage$(2)) \\\n+                          $$(HOST_STDLIB_DEFAULT$(2)) \\\n                           $$(HOST_LIB$(2))/$$(CFG_RUSTLLVM)                      \\\n                           $$(SREQ$(1)$(3))\n \t@$$(call E, compile_and_link: $$@)\n@@ -49,6 +49,10 @@ $$(HOST_LIB$(2))/$$(CFG_STDLIB): $$(TARGET_HOST_LIB$(1))/$$(CFG_STDLIB)\n \t@$$(call E, cp: $$@)\n \t$$(Q)cp $$< $$@\n \n+$$(HOST_LIB$(2))/libstd.rlib: $$(TARGET_HOST_LIB$(1))/libstd.rlib\n+\t@$$(call E, cp: $$@)\n+\t$$(Q)cp $$< $$@\n+\n $$(HOST_LIB$(2))/$$(CFG_RUSTLLVM): rustllvm/$$(CFG_RUSTLLVM)\n \t@$$(call E, cp: $$@)\n \t$$(Q)cp $$< $$@"}, {"sha": "77ff20e5a0143e1d80dd1ca2fdefbdb09fe3eb0b", "filename": "mk/tests.mk", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f634eb2bfd16f6c60476fc1bceccfa5b4435c28a/mk%2Ftests.mk", "raw_url": "https://github.com/rust-lang/rust/raw/f634eb2bfd16f6c60476fc1bceccfa5b4435c28a/mk%2Ftests.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftests.mk?ref=f634eb2bfd16f6c60476fc1bceccfa5b4435c28a", "patch": "@@ -147,7 +147,7 @@ check-stage$(2)-rustc: test/rustctest.stage$(2).out \\\n \n test/rustctest.stage$(2)$$(X): $$(COMPILER_CRATE) $$(COMPILER_INPUTS) \\\n                            $$(HOST_LIB$(2))/$$(CFG_RUNTIME) \\\n-                           $$(call CFG_STDLIB_DEFAULT,stage$(1),stage$(2)) \\\n+                           $$(HOST_STDLIB_DEFAULT$(2)) \\\n                            $$(HOST_LIB$(2))/$$(CFG_RUSTLLVM) \\\n                            $$(SREQ$(1)$$(CFG_HOST_TRIPLE))\n \t@$$(call E, compile_and_link: $$@)"}]}