{"sha": "eb0ab5e6b25ce536cbb3032c31aa131a8f7caaa6", "node_id": "MDY6Q29tbWl0NzI0NzEyOmViMGFiNWU2YjI1Y2U1MzZjYmIzMDMyYzMxYWExMzFhOGY3Y2FhYTY=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-02-25T07:54:54Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-02-25T13:30:51Z"}, "message": "Rollup merge of #48517 - penpalperson:master, r=Mark-Simulacrum\n\nAdded error-format flag to x.py.\n\nFixes #48475\n\nr? @Mark-Simulacrum", "tree": {"sha": "1d4d58b894b232f7c70e9c22ceb5307ef41c924d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1d4d58b894b232f7c70e9c22ceb5307ef41c924d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/eb0ab5e6b25ce536cbb3032c31aa131a8f7caaa6", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlqSuosACgkQ/vbIBR0O\nATw1MRAArc7YZqteERV6WLo0veWn4vFBFrc6r92Qk3lDPX9YDnKTBB1HMcAub+5m\nAA/hjUdTdlw0jHaUa5wb3QpJYND7tjf9cz6izKWvuUZzPCKG7DAf1eabZhCjPcFA\nLgFqqkC2hggnq4nxm3zoskfbbENiY1kiZG+uM0IqpHed+sCKDfY9nGfNM2TSx0/B\ndletOSWcvL/V1VnxXQmIlc5Xt6p9DL7WMG4MwP7RfOueClG6pVJDBb0nzYY3flsI\nFgakfSXpR2NT36NvVW1bvr/AkRTs54O7kYHZn6UUZjDuzM0E1dz5zzz3HTSIwdt9\njgs4hdG8a1XcgGOSGAIP9KibPl35qnlnDJPir/5hRDCYjjPhSzsrkPbR3xv/MBqA\nhEutk9WoKpFaPsB3jdOmKnfXCccC3QYmHDNWHGCvRRJlXAxknWBDIzC5WlvP1bpz\ni+huxUP9d91i1zoWNYzD9M5xWrQi65Sw+C+nWqlKvlbw+ch84PULuCFEh4733Hw5\nNDM2F5i8X4nZYNiP1As6MH3XrqyNiiJ4t9jjzaINyAzKafYZhu3xVhkVzamw8cln\nmml/GtIQ92pmXMb/kyMymcKqb/8EzTJ9KOPhid06b2VgXDl2yfaJbnbbhpF1DxQr\n+OI89SrxELOwr9nlH2WZtiZprOZgS6fhnAdW3VB2zCR4nALK5vg=\n=N1AF\n-----END PGP SIGNATURE-----", "payload": "tree 1d4d58b894b232f7c70e9c22ceb5307ef41c924d\nparent 4ab2184312b2c6eb000b6f9f5311d26d42b32857\nparent 264a92182e037c46cdcf37890e3142eaf634444d\nauthor kennytm <kennytm@gmail.com> 1519545294 +0800\ncommitter kennytm <kennytm@gmail.com> 1519565451 +0800\n\nRollup merge of #48517 - penpalperson:master, r=Mark-Simulacrum\n\nAdded error-format flag to x.py.\n\nFixes #48475\n\nr? @Mark-Simulacrum\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/eb0ab5e6b25ce536cbb3032c31aa131a8f7caaa6", "html_url": "https://github.com/rust-lang/rust/commit/eb0ab5e6b25ce536cbb3032c31aa131a8f7caaa6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/eb0ab5e6b25ce536cbb3032c31aa131a8f7caaa6/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4ab2184312b2c6eb000b6f9f5311d26d42b32857", "url": "https://api.github.com/repos/rust-lang/rust/commits/4ab2184312b2c6eb000b6f9f5311d26d42b32857", "html_url": "https://github.com/rust-lang/rust/commit/4ab2184312b2c6eb000b6f9f5311d26d42b32857"}, {"sha": "264a92182e037c46cdcf37890e3142eaf634444d", "url": "https://api.github.com/repos/rust-lang/rust/commits/264a92182e037c46cdcf37890e3142eaf634444d", "html_url": "https://github.com/rust-lang/rust/commit/264a92182e037c46cdcf37890e3142eaf634444d"}], "stats": {"total": 13, "additions": 13, "deletions": 0}, "files": [{"sha": "ca35a896e08c88f07583bc88fe5adc6b4673a2fc", "filename": "src/bootstrap/bin/rustc.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/eb0ab5e6b25ce536cbb3032c31aa131a8f7caaa6/src%2Fbootstrap%2Fbin%2Frustc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eb0ab5e6b25ce536cbb3032c31aa131a8f7caaa6/src%2Fbootstrap%2Fbin%2Frustc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbin%2Frustc.rs?ref=eb0ab5e6b25ce536cbb3032c31aa131a8f7caaa6", "patch": "@@ -61,6 +61,11 @@ fn main() {\n         args.remove(n);\n     }\n \n+    if let Some(s) = env::var_os(\"RUSTC_ERROR_FORMAT\") {\n+        args.push(\"--error-format\".into());\n+        args.push(s);\n+    }\n+\n     // Detect whether or not we're a build script depending on whether --target\n     // is passed (a bit janky...)\n     let target = args.windows(2)"}, {"sha": "b5946b44e05ef6316ab5881d7250f1e923548b61", "filename": "src/bootstrap/builder.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/eb0ab5e6b25ce536cbb3032c31aa131a8f7caaa6/src%2Fbootstrap%2Fbuilder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eb0ab5e6b25ce536cbb3032c31aa131a8f7caaa6/src%2Fbootstrap%2Fbuilder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbuilder.rs?ref=eb0ab5e6b25ce536cbb3032c31aa131a8f7caaa6", "patch": "@@ -599,6 +599,9 @@ impl<'a> Builder<'a> {\n         if let Some(target_linker) = self.build.linker(target) {\n             cargo.env(\"RUSTC_TARGET_LINKER\", target_linker);\n         }\n+        if let Some(ref error_format) = self.config.rustc_error_format {\n+            cargo.env(\"RUSTC_ERROR_FORMAT\", error_format);\n+        }\n         if cmd != \"build\" && cmd != \"check\" {\n             cargo.env(\"RUSTDOC_LIBDIR\", self.rustc_libdir(self.compiler(2, self.build.build)));\n         }"}, {"sha": "6bc20181a0330a5a51eef0ae83defe310cb87e39", "filename": "src/bootstrap/config.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/eb0ab5e6b25ce536cbb3032c31aa131a8f7caaa6/src%2Fbootstrap%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eb0ab5e6b25ce536cbb3032c31aa131a8f7caaa6/src%2Fbootstrap%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.rs?ref=eb0ab5e6b25ce536cbb3032c31aa131a8f7caaa6", "patch": "@@ -57,6 +57,7 @@ pub struct Config {\n     pub profiler: bool,\n     pub ignore_git: bool,\n     pub exclude: Vec<PathBuf>,\n+    pub rustc_error_format: Option<String>,\n \n     pub run_host_only: bool,\n \n@@ -330,6 +331,7 @@ impl Config {\n         config.test_miri = false;\n         config.rust_codegen_backends = vec![INTERNER.intern_str(\"llvm\")];\n \n+        config.rustc_error_format = flags.rustc_error_format;\n         config.on_fail = flags.on_fail;\n         config.stage = flags.stage;\n         config.src = flags.src;"}, {"sha": "8ca5910a11c0d5c8b2f3648992dc1758ce403415", "filename": "src/bootstrap/flags.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/eb0ab5e6b25ce536cbb3032c31aa131a8f7caaa6/src%2Fbootstrap%2Fflags.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eb0ab5e6b25ce536cbb3032c31aa131a8f7caaa6/src%2Fbootstrap%2Fflags.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fflags.rs?ref=eb0ab5e6b25ce536cbb3032c31aa131a8f7caaa6", "patch": "@@ -43,6 +43,7 @@ pub struct Flags {\n     pub cmd: Subcommand,\n     pub incremental: bool,\n     pub exclude: Vec<PathBuf>,\n+    pub rustc_error_format: Option<String>,\n }\n \n pub enum Subcommand {\n@@ -118,6 +119,7 @@ To learn more about a subcommand, run `./x.py <subcommand> -h`\");\n         opts.optopt(\"\", \"src\", \"path to the root of the rust checkout\", \"DIR\");\n         opts.optopt(\"j\", \"jobs\", \"number of jobs to run in parallel\", \"JOBS\");\n         opts.optflag(\"h\", \"help\", \"print this help message\");\n+        opts.optflag(\"\", \"error-format\", \"rustc error format\");\n \n         // fn usage()\n         let usage = |exit_code: i32, opts: &Options, subcommand_help: &str, extra_help: &str| -> ! {\n@@ -370,6 +372,7 @@ Arguments:\n             verbose: matches.opt_count(\"verbose\"),\n             stage,\n             on_fail: matches.opt_str(\"on-fail\"),\n+            rustc_error_format: matches.opt_str(\"error-format\"),\n             keep_stage: matches.opt_str(\"keep-stage\").map(|j| j.parse().unwrap()),\n             build: matches.opt_str(\"build\").map(|s| INTERNER.intern_string(s)),\n             host: split(matches.opt_strs(\"host\"))"}]}