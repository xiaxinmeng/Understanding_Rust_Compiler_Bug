{"sha": "0c2f570151749d14e351f30fa234693b36bc4e72", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBjMmY1NzAxNTE3NDlkMTRlMzUxZjMwZmEyMzQ2OTNiMzZiYzRlNzI=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2021-03-14T13:10:06Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-03-14T13:10:06Z"}, "message": "Merge #8012\n\n8012: xtask: replace \"lint\" command by a simply cargo alias r=matklad a=matthiaskrgr\n\nThis strips the run_clippy implementation out of xtask and replaces it by\r\na simple \"cargo lint\" alias which runs clippy with the corresponding flags.\r\n\r\nUnfortunately  I could not name the alias \"clippy\" because that would lead to infinite recursion. :sweat_smile: \n\nCo-authored-by: Matthias Kr\u00fcger <matthias.krueger@famsik.de>", "tree": {"sha": "717c195e1ea7894c25d62cdab0b6c4526585eba1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/717c195e1ea7894c25d62cdab0b6c4526585eba1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0c2f570151749d14e351f30fa234693b36bc4e72", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgTgsuCRBK7hj4Ov3rIwAAdHIIAGHTSuyZDn/qAfjjdD3/Usix\nKJhxawc4HA+mL6AUBxYZ4jIJ3V+ULH84kzjlwbt5C4/6+3yJuHO8z0Kms3yyFjFg\ntoxWPS16DvYR5OKJ5BIAdCPQSEEcboskKom0iCNP0vqnlcOOpOlVG1REt12lMN2W\nCQc1IjRn999WcTxr/Wn/nzozUz3sqxUuIRZSLDVeLLDBqr13SvDw4oXDWlfKnNlG\nkW5Oiztliki461GmbBjsFs5ablEmwjklnGbSCRMszXm1aWPGDMkHRSvEw65G/Dqj\nolpBe0HbIZrL9HrFqRMU8g3trMNSNQ8UiTqTIr0XzEHzr8iBxkSoMh2VVOoDvLo=\n=2wOj\n-----END PGP SIGNATURE-----\n", "payload": "tree 717c195e1ea7894c25d62cdab0b6c4526585eba1\nparent a8a7fa834726eb763fe872b02db821f99098a498\nparent 5008e5682159965c6f3b174aed3523c0b5e2fc08\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1615727406 +0000\ncommitter GitHub <noreply@github.com> 1615727406 +0000\n\nMerge #8012\n\n8012: xtask: replace \"lint\" command by a simply cargo alias r=matklad a=matthiaskrgr\n\nThis strips the run_clippy implementation out of xtask and replaces it by\r\na simple \"cargo lint\" alias which runs clippy with the corresponding flags.\r\n\r\nUnfortunately  I could not name the alias \"clippy\" because that would lead to infinite recursion. :sweat_smile: \n\nCo-authored-by: Matthias Kr\u00fcger <matthias.krueger@famsik.de>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0c2f570151749d14e351f30fa234693b36bc4e72", "html_url": "https://github.com/rust-lang/rust/commit/0c2f570151749d14e351f30fa234693b36bc4e72", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0c2f570151749d14e351f30fa234693b36bc4e72/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a8a7fa834726eb763fe872b02db821f99098a498", "url": "https://api.github.com/repos/rust-lang/rust/commits/a8a7fa834726eb763fe872b02db821f99098a498", "html_url": "https://github.com/rust-lang/rust/commit/a8a7fa834726eb763fe872b02db821f99098a498"}, {"sha": "5008e5682159965c6f3b174aed3523c0b5e2fc08", "url": "https://api.github.com/repos/rust-lang/rust/commits/5008e5682159965c6f3b174aed3523c0b5e2fc08", "html_url": "https://github.com/rust-lang/rust/commit/5008e5682159965c6f3b174aed3523c0b5e2fc08"}], "stats": {"total": 23, "additions": 1, "deletions": 22}, "files": [{"sha": "1447614b76363d6cd61b64c0a1678fcdd3988e64", "filename": ".cargo/config", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0c2f570151749d14e351f30fa234693b36bc4e72/.cargo%2Fconfig", "raw_url": "https://github.com/rust-lang/rust/raw/0c2f570151749d14e351f30fa234693b36bc4e72/.cargo%2Fconfig", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.cargo%2Fconfig?ref=0c2f570151749d14e351f30fa234693b36bc4e72", "patch": "@@ -3,6 +3,7 @@ xtask = \"run --package xtask --bin xtask --\"\n install-ra = \"run --package xtask --bin xtask -- install\" # for backwards compat\n tq = \"test -- -q\"\n qt = \"tq\"\n+lint = \"clippy --all-targets -- -Aclippy::collapsible_if -Aclippy::needless_pass_by_value -Aclippy::nonminimal_bool -Aclippy::redundant_pattern_matching --cap-lints warn\"\n \n [target.x86_64-pc-windows-msvc]\n linker = \"rust-lld\""}, {"sha": "4cd2b1ddbf1ae30c756ecc1ad19ae5e44f88d07a", "filename": "xtask/src/flags.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0c2f570151749d14e351f30fa234693b36bc4e72/xtask%2Fsrc%2Fflags.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0c2f570151749d14e351f30fa234693b36bc4e72/xtask%2Fsrc%2Fflags.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/xtask%2Fsrc%2Fflags.rs?ref=0c2f570151749d14e351f30fa234693b36bc4e72", "patch": "@@ -27,7 +27,6 @@ xflags::xflags! {\n             optional --jemalloc\n         }\n \n-        cmd lint {}\n         cmd fuzz-tests {}\n         cmd pre-cache {}\n \n@@ -63,7 +62,6 @@ pub struct Xtask {\n pub enum XtaskCmd {\n     Help(Help),\n     Install(Install),\n-    Lint(Lint),\n     FuzzTests(FuzzTests),\n     PreCache(PreCache),\n     Release(Release),"}, {"sha": "915aae71a3149579b468ca2fb73ab5eea1192878", "filename": "xtask/src/main.rs", "status": "modified", "additions": 0, "deletions": 20, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/0c2f570151749d14e351f30fa234693b36bc4e72/xtask%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0c2f570151749d14e351f30fa234693b36bc4e72/xtask%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/xtask%2Fsrc%2Fmain.rs?ref=0c2f570151749d14e351f30fa234693b36bc4e72", "patch": "@@ -40,7 +40,6 @@ fn main() -> Result<()> {\n             return Ok(());\n         }\n         flags::XtaskCmd::Install(cmd) => cmd.run(),\n-        flags::XtaskCmd::Lint(_) => run_clippy(),\n         flags::XtaskCmd::FuzzTests(_) => run_fuzzer(),\n         flags::XtaskCmd::PreCache(cmd) => cmd.run(),\n         flags::XtaskCmd::Release(cmd) => cmd.run(),\n@@ -95,25 +94,6 @@ fn ensure_rustfmt() -> Result<()> {\n     Ok(())\n }\n \n-fn run_clippy() -> Result<()> {\n-    if cmd!(\"cargo clippy --version\").read().is_err() {\n-        bail!(\n-            \"Failed run cargo clippy. \\\n-            Please run `rustup component add clippy` to install it.\",\n-        )\n-    }\n-\n-    let allowed_lints = \"\n-        -A clippy::collapsible_if\n-        -A clippy::needless_pass_by_value\n-        -A clippy::nonminimal_bool\n-        -A clippy::redundant_pattern_matching\n-    \"\n-    .split_ascii_whitespace();\n-    cmd!(\"cargo clippy --all-features --all-targets -- {allowed_lints...}\").run()?;\n-    Ok(())\n-}\n-\n fn run_fuzzer() -> Result<()> {\n     let _d = pushd(\"./crates/syntax\")?;\n     let _e = pushenv(\"RUSTUP_TOOLCHAIN\", \"nightly\");"}]}