{"sha": "0432030c2727183f3cbda0263de2ca2b90c37353", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA0MzIwMzBjMjcyNzE4M2YzY2JkYTAyNjNkZTJjYTJiOTBjMzczNTM=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-03-03T06:37:59Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-03-06T03:39:55Z"}, "message": "rt: Don't take the task lock on state transitions", "tree": {"sha": "bffe141f4b6de2bfdbedab88c5623a82cb4dc7d0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bffe141f4b6de2bfdbedab88c5623a82cb4dc7d0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0432030c2727183f3cbda0263de2ca2b90c37353", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0432030c2727183f3cbda0263de2ca2b90c37353", "html_url": "https://github.com/rust-lang/rust/commit/0432030c2727183f3cbda0263de2ca2b90c37353", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0432030c2727183f3cbda0263de2ca2b90c37353/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "43f9f4d54ab7a0b61bce06e017c715e2f4cc85de", "url": "https://api.github.com/repos/rust-lang/rust/commits/43f9f4d54ab7a0b61bce06e017c715e2f4cc85de", "html_url": "https://github.com/rust-lang/rust/commit/43f9f4d54ab7a0b61bce06e017c715e2f4cc85de"}], "stats": {"total": 6, "additions": 0, "deletions": 6}, "files": [{"sha": "7b5b528782bcacaab14411dba7ac0b25c9a84254", "filename": "src/rt/rust_task.cpp", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/0432030c2727183f3cbda0263de2ca2b90c37353/src%2Frt%2Frust_task.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/0432030c2727183f3cbda0263de2ca2b90c37353/src%2Frt%2Frust_task.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_task.cpp?ref=0432030c2727183f3cbda0263de2ca2b90c37353", "patch": "@@ -421,8 +421,6 @@ rust_task::transition(rust_task_list *src, rust_task_list *dst) {\n \n void\n rust_task::block(rust_cond *on, const char* name) {\n-    I(thread, !lock.lock_held_by_current_thread());\n-    scoped_lock with(lock);\n     LOG(this, task, \"Blocking on 0x%\" PRIxPTR \", cond: 0x%\" PRIxPTR,\n                          (uintptr_t) on, (uintptr_t) cond);\n     A(thread, cond == NULL, \"Cannot block an already blocked task.\");\n@@ -435,8 +433,6 @@ rust_task::block(rust_cond *on, const char* name) {\n \n void\n rust_task::wakeup(rust_cond *from) {\n-    I(thread, !lock.lock_held_by_current_thread());\n-    scoped_lock with(lock);\n     A(thread, cond != NULL, \"Cannot wake up unblocked task.\");\n     LOG(this, task, \"Blocked on 0x%\" PRIxPTR \" woken up on 0x%\" PRIxPTR,\n                         (uintptr_t) cond, (uintptr_t) from);\n@@ -449,8 +445,6 @@ rust_task::wakeup(rust_cond *from) {\n \n void\n rust_task::die() {\n-    I(thread, !lock.lock_held_by_current_thread());\n-    scoped_lock with(lock);\n     transition(&thread->running_tasks, &thread->dead_tasks);\n }\n "}]}