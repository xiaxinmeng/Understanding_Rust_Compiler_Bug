{"sha": "1ad7c52812b336c23d86bc4c74c408fe5c850761", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFhZDdjNTI4MTJiMzM2YzIzZDg2YmM0Yzc0YzQwOGZlNWM4NTA3NjE=", "commit": {"author": {"name": "Yuki Okushi", "email": "huyuumi.dev@gmail.com", "date": "2021-03-27T16:33:23Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-03-27T16:33:23Z"}, "message": "Rollup merge of #83569 - sjakobi:issue56445-regression-test, r=jackh726\n\nAdd regression tests for #56445\n\nCloses #56445.", "tree": {"sha": "2bd2416c2a6dcbdf410e6d9f932960b124cb576a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2bd2416c2a6dcbdf410e6d9f932960b124cb576a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1ad7c52812b336c23d86bc4c74c408fe5c850761", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgX15TCRBK7hj4Ov3rIwAAdHIIACY+ObSX+CIgxKEFDw5bymED\npGHoEBbZuzmrwL/HPexpnJiwtv1H+6ZLB04jG5XX4oDHw4lzajP77lXlEiQ1vUMr\nbAx67MseU5DKvyQgREEkwQIhF9rsc0iIzGu3bMbkraJ3Yo1lmLErLpmeQER0z9bF\nxaCnxy49jQb+kX//UbE/qWHWyZJ+NdFEJdLztEdPNmu82jcci6Ta3KCWski3vfac\n5a4h75qa3CCk62qoHEid53gvSE0fRBzemWNu2AY7FoGkTdWnZS+P+n7NpOiXZT21\nmV0kwakBjKPWtr5YIgSEZtLU2kZJzwCwwl3WnNkoY0db0cLUc90IFNim4tfxggk=\n=DnsD\n-----END PGP SIGNATURE-----\n", "payload": "tree 2bd2416c2a6dcbdf410e6d9f932960b124cb576a\nparent 69acaf335f891dcd4f2410355e9e6eea6522589c\nparent 09275802249824e54d8eac577147112d4752671a\nauthor Yuki Okushi <huyuumi.dev@gmail.com> 1616862803 +0900\ncommitter GitHub <noreply@github.com> 1616862803 +0900\n\nRollup merge of #83569 - sjakobi:issue56445-regression-test, r=jackh726\n\nAdd regression tests for #56445\n\nCloses #56445.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1ad7c52812b336c23d86bc4c74c408fe5c850761", "html_url": "https://github.com/rust-lang/rust/commit/1ad7c52812b336c23d86bc4c74c408fe5c850761", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1ad7c52812b336c23d86bc4c74c408fe5c850761/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "69acaf335f891dcd4f2410355e9e6eea6522589c", "url": "https://api.github.com/repos/rust-lang/rust/commits/69acaf335f891dcd4f2410355e9e6eea6522589c", "html_url": "https://github.com/rust-lang/rust/commit/69acaf335f891dcd4f2410355e9e6eea6522589c"}, {"sha": "09275802249824e54d8eac577147112d4752671a", "url": "https://api.github.com/repos/rust-lang/rust/commits/09275802249824e54d8eac577147112d4752671a", "html_url": "https://github.com/rust-lang/rust/commit/09275802249824e54d8eac577147112d4752671a"}], "stats": {"total": 51, "additions": 48, "deletions": 3}, "files": [{"sha": "8416d64e1c2de1dbc72d9cfe65a126b0d9a430d9", "filename": "src/test/ui/const-generics/issues/issue-56445-1.full.stderr", "status": "renamed", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/1ad7c52812b336c23d86bc4c74c408fe5c850761/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-1.full.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/1ad7c52812b336c23d86bc4c74c408fe5c850761/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-1.full.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-1.full.stderr?ref=1ad7c52812b336c23d86bc4c74c408fe5c850761", "patch": "@@ -1,5 +1,5 @@\n warning: the feature `const_generics` is incomplete and may not be safe to use and/or cause compiler crashes\n-  --> $DIR/issue-56445.rs:3:27\n+  --> $DIR/issue-56445-1.rs:3:27\n    |\n LL | #![cfg_attr(full, feature(const_generics))]\n    |                           ^^^^^^^^^^^^^^\n@@ -8,7 +8,7 @@ LL | #![cfg_attr(full, feature(const_generics))]\n    = note: see issue #44580 <https://github.com/rust-lang/rust/issues/44580> for more information\n \n error[E0771]: use of non-static lifetime `'a` in const generic\n-  --> $DIR/issue-56445.rs:8:26\n+  --> $DIR/issue-56445-1.rs:8:26\n    |\n LL | struct Bug<'a, const S: &'a str>(PhantomData<&'a ()>);\n    |                          ^^", "previous_filename": "src/test/ui/const-generics/issues/issue-56445.full.stderr"}, {"sha": "f7056f27cb37bd8337c6c41d5165b65150390b78", "filename": "src/test/ui/const-generics/issues/issue-56445-1.min.stderr", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1ad7c52812b336c23d86bc4c74c408fe5c850761/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-1.min.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/1ad7c52812b336c23d86bc4c74c408fe5c850761/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-1.min.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-1.min.stderr?ref=1ad7c52812b336c23d86bc4c74c408fe5c850761", "patch": "@@ -1,5 +1,5 @@\n error[E0771]: use of non-static lifetime `'a` in const generic\n-  --> $DIR/issue-56445.rs:8:26\n+  --> $DIR/issue-56445-1.rs:8:26\n    |\n LL | struct Bug<'a, const S: &'a str>(PhantomData<&'a ()>);\n    |                          ^^", "previous_filename": "src/test/ui/const-generics/issues/issue-56445.min.stderr"}, {"sha": "bc9e1dee853e482c592da4e5c6741e26d54c3ebd", "filename": "src/test/ui/const-generics/issues/issue-56445-1.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/1ad7c52812b336c23d86bc4c74c408fe5c850761/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1ad7c52812b336c23d86bc4c74c408fe5c850761/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-1.rs?ref=1ad7c52812b336c23d86bc4c74c408fe5c850761", "previous_filename": "src/test/ui/const-generics/issues/issue-56445.rs"}, {"sha": "e078c8487c7278093ec810aad3f4814715f41211", "filename": "src/test/ui/const-generics/issues/issue-56445-2.rs", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/1ad7c52812b336c23d86bc4c74c408fe5c850761/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1ad7c52812b336c23d86bc4c74c408fe5c850761/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-2.rs?ref=1ad7c52812b336c23d86bc4c74c408fe5c850761", "patch": "@@ -0,0 +1,11 @@\n+// Regression test for https://github.com/rust-lang/rust/issues/56445#issuecomment-502095133\n+struct OnDiskDirEntry<'a> { _s: &'a usize }\n+\n+impl<'a> OnDiskDirEntry<'a> {\n+    const LFN_FRAGMENT_LEN: usize = 2;\n+\n+    fn lfn_contents(&self) -> [char; Self::LFN_FRAGMENT_LEN] { loop { } }\n+    //~^ ERROR: generic `Self` types are currently not permitted in anonymous constants\n+}\n+\n+fn main() {}"}, {"sha": "770c80cbbd305ca8456186e2679064f7f65bacd2", "filename": "src/test/ui/const-generics/issues/issue-56445-2.stderr", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/1ad7c52812b336c23d86bc4c74c408fe5c850761/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/1ad7c52812b336c23d86bc4c74c408fe5c850761/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-2.stderr?ref=1ad7c52812b336c23d86bc4c74c408fe5c850761", "patch": "@@ -0,0 +1,14 @@\n+error: generic `Self` types are currently not permitted in anonymous constants\n+  --> $DIR/issue-56445-2.rs:7:38\n+   |\n+LL |     fn lfn_contents(&self) -> [char; Self::LFN_FRAGMENT_LEN] { loop { } }\n+   |                                      ^^^^\n+   |\n+note: not a concrete type\n+  --> $DIR/issue-56445-2.rs:4:10\n+   |\n+LL | impl<'a> OnDiskDirEntry<'a> {\n+   |          ^^^^^^^^^^^^^^^^^^\n+\n+error: aborting due to previous error\n+"}, {"sha": "c29df14586e21c0d9e45e35833566127a09ac56f", "filename": "src/test/ui/const-generics/issues/issue-56445-3.rs", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/1ad7c52812b336c23d86bc4c74c408fe5c850761/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1ad7c52812b336c23d86bc4c74c408fe5c850761/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-3.rs?ref=1ad7c52812b336c23d86bc4c74c408fe5c850761", "patch": "@@ -0,0 +1,12 @@\n+// Regression test for https://github.com/rust-lang/rust/issues/56445#issuecomment-524494170\n+pub struct Memory<'rom> {\n+    rom: &'rom [u8],\n+    ram: [u8; Self::SIZE],\n+    //~^ ERROR: generic `Self` types are currently not permitted in anonymous constants\n+}\n+\n+impl<'rom> Memory<'rom> {\n+    pub const SIZE: usize = 0x8000;\n+}\n+\n+fn main() {}"}, {"sha": "f1c49eecfb54765b688fececc4e3417651c28d08", "filename": "src/test/ui/const-generics/issues/issue-56445-3.stderr", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/1ad7c52812b336c23d86bc4c74c408fe5c850761/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/1ad7c52812b336c23d86bc4c74c408fe5c850761/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-56445-3.stderr?ref=1ad7c52812b336c23d86bc4c74c408fe5c850761", "patch": "@@ -0,0 +1,8 @@\n+error: generic `Self` types are currently not permitted in anonymous constants\n+  --> $DIR/issue-56445-3.rs:4:15\n+   |\n+LL |     ram: [u8; Self::SIZE],\n+   |               ^^^^\n+\n+error: aborting due to previous error\n+"}]}