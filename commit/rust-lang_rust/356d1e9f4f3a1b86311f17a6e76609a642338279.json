{"sha": "356d1e9f4f3a1b86311f17a6e76609a642338279", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM1NmQxZTlmNGYzYTFiODYzMTFmMTdhNmU3NjYwOWE2NDIzMzgyNzk=", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2020-05-30T21:09:00Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-05-30T21:09:00Z"}, "message": "Rollup merge of #72772 - RalfJung:valid-char, r=petrochenkov\n\nmiri validation: clarify valid values of 'char'\n\nThe old text said \"expected a valid unicode codepoint\", which is not actually correct -- it has to be a scalar value (which is a code point that is not part of a surrogate pair).", "tree": {"sha": "f21d80d2535c5ae6414655e5e61cd4c7af97dbf5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f21d80d2535c5ae6414655e5e61cd4c7af97dbf5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/356d1e9f4f3a1b86311f17a6e76609a642338279", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJe0sttCRBK7hj4Ov3rIwAAdHIIADAacpDw4b7thi32nXqb3s0q\nx6L0YrWf5sQT4LJvjn7j3aOf1AUUdHODyW/bErBrlBCpc5qm8glW6wKfXRnQeAIM\nq0Moh+cP690EbeZQ/9kcOpP3rPnmjJ1j60VDRIz3gT1GZwjYQ3Knui1gLNVJ0njb\nSq76h66OBE6neETcPZKa1n9y+2ovBzaLDBDGKtg1WO4N696dSv2kM4I5aAh/lBn6\nOpUcxvF5L35bABC5bP2tJU8BGEtCpmlL9OBRr48zGE3tGfuAlN2A5Wsbg5+IfvHU\nO3la7AEGsolW3HQWTQP8ou5BjK6sTvaY3SDMDMwTIsEr989AgdtMYdrLS72QgHY=\n=Gft2\n-----END PGP SIGNATURE-----\n", "payload": "tree f21d80d2535c5ae6414655e5e61cd4c7af97dbf5\nparent 32481bc80ada911e638cde861d17eddc8338d49a\nparent f8d38057335ff6c760fabb53b62d87938d8fb17f\nauthor Ralf Jung <post@ralfj.de> 1590872940 +0200\ncommitter GitHub <noreply@github.com> 1590872940 +0200\n\nRollup merge of #72772 - RalfJung:valid-char, r=petrochenkov\n\nmiri validation: clarify valid values of 'char'\n\nThe old text said \"expected a valid unicode codepoint\", which is not actually correct -- it has to be a scalar value (which is a code point that is not part of a surrogate pair).\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/356d1e9f4f3a1b86311f17a6e76609a642338279", "html_url": "https://github.com/rust-lang/rust/commit/356d1e9f4f3a1b86311f17a6e76609a642338279", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/356d1e9f4f3a1b86311f17a6e76609a642338279/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "32481bc80ada911e638cde861d17eddc8338d49a", "url": "https://api.github.com/repos/rust-lang/rust/commits/32481bc80ada911e638cde861d17eddc8338d49a", "html_url": "https://github.com/rust-lang/rust/commit/32481bc80ada911e638cde861d17eddc8338d49a"}, {"sha": "f8d38057335ff6c760fabb53b62d87938d8fb17f", "url": "https://api.github.com/repos/rust-lang/rust/commits/f8d38057335ff6c760fabb53b62d87938d8fb17f", "html_url": "https://github.com/rust-lang/rust/commit/f8d38057335ff6c760fabb53b62d87938d8fb17f"}], "stats": {"total": 4, "additions": 2, "deletions": 2}, "files": [{"sha": "d5f4a63baaa83fc6b572aa9c010e57ce7eca3587", "filename": "src/librustc_mir/interpret/validity.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/356d1e9f4f3a1b86311f17a6e76609a642338279/src%2Flibrustc_mir%2Finterpret%2Fvalidity.rs", "raw_url": "https://github.com/rust-lang/rust/raw/356d1e9f4f3a1b86311f17a6e76609a642338279/src%2Flibrustc_mir%2Finterpret%2Fvalidity.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Finterpret%2Fvalidity.rs?ref=356d1e9f4f3a1b86311f17a6e76609a642338279", "patch": "@@ -485,7 +485,7 @@ impl<'rt, 'mir, 'tcx: 'mir, M: Machine<'mir, 'tcx>> ValidityVisitor<'rt, 'mir, '\n                 try_validation!(\n                     value.to_char(),\n                     self.path,\n-                    err_ub!(InvalidChar(..)) => { \"{}\", value } expected { \"a valid unicode codepoint\" },\n+                    err_ub!(InvalidChar(..)) => { \"{}\", value } expected { \"a valid unicode scalar value (in `0..=0x10FFFF` but not in `0xD800..=0xDFFF`)\" },\n                 );\n                 Ok(true)\n             }"}, {"sha": "e49fd3e0b970bd4ed7d2b5a92a57c3b0ceb44bf2", "filename": "src/test/ui/consts/const-eval/ub-enum.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/356d1e9f4f3a1b86311f17a6e76609a642338279/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fub-enum.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/356d1e9f4f3a1b86311f17a6e76609a642338279/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fub-enum.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fub-enum.stderr?ref=356d1e9f4f3a1b86311f17a6e76609a642338279", "patch": "@@ -82,7 +82,7 @@ error[E0080]: it is undefined behavior to use this value\n   --> $DIR/ub-enum.rs:87:1\n    |\n LL | const BAD_OPTION_CHAR: Option<(char, char)> = Some(('x', unsafe { mem::transmute(!0u32) }));\n-   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ type validation failed: encountered 0xffffffff at .<enum-variant(Some)>.0.1, but expected a valid unicode codepoint\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ type validation failed: encountered 0xffffffff at .<enum-variant(Some)>.0.1, but expected a valid unicode scalar value (in `0..=0x10FFFF` but not in `0xD800..=0xDFFF`)\n    |\n    = note: The rules on what exactly is undefined behavior aren't clear, so this check might be overzealous. Please open an issue on the rustc repository if you believe it should not be considered undefined behavior.\n "}]}