{"sha": "6a81014ae9f169b4b6277b76052ea0a032049477", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZhODEwMTRhZTlmMTY5YjRiNjI3N2I3NjA1MmVhMGEwMzIwNDk0Nzc=", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2020-04-17T09:03:20Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2020-04-17T09:04:48Z"}, "message": "test #[derive] on packed struct", "tree": {"sha": "7c1345e53b656c7c40284ec0e54f4f92eb2831e2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7c1345e53b656c7c40284ec0e54f4f92eb2831e2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6a81014ae9f169b4b6277b76052ea0a032049477", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6a81014ae9f169b4b6277b76052ea0a032049477", "html_url": "https://github.com/rust-lang/rust/commit/6a81014ae9f169b4b6277b76052ea0a032049477", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6a81014ae9f169b4b6277b76052ea0a032049477/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9b4af73eb08963fa5450e6d967c29399c3339abe", "url": "https://api.github.com/repos/rust-lang/rust/commits/9b4af73eb08963fa5450e6d967c29399c3339abe", "html_url": "https://github.com/rust-lang/rust/commit/9b4af73eb08963fa5450e6d967c29399c3339abe"}], "stats": {"total": 23, "additions": 23, "deletions": 0}, "files": [{"sha": "7aa53ef568f560c2f0d58a9f5fadfe6cfc3e0a15", "filename": "tests/run-pass/packed_struct.rs", "status": "modified", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/6a81014ae9f169b4b6277b76052ea0a032049477/tests%2Frun-pass%2Fpacked_struct.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a81014ae9f169b4b6277b76052ea0a032049477/tests%2Frun-pass%2Fpacked_struct.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fpacked_struct.rs?ref=6a81014ae9f169b4b6277b76052ea0a032049477", "patch": "@@ -1,5 +1,7 @@\n #![feature(unsize, coerce_unsized)]\n \n+use std::collections::hash_map::DefaultHasher;\n+use std::hash::Hash;\n \n fn test_basic() {\n     #[repr(packed)]\n@@ -114,10 +116,31 @@ fn test_static() {\n     assert_eq!({FOO.i}, 42);\n }\n \n+fn test_derive() {\n+    #[repr(packed)]\n+    #[derive(Copy, Clone, PartialEq, Eq, PartialOrd, Ord, Hash, Default, Debug)]\n+    struct P {\n+        a: usize,\n+        b: u8,\n+        c: usize,\n+    }\n+\n+    let x = P {a: 1usize, b: 2u8, c: 3usize};\n+    let y = P {a: 1usize, b: 2u8, c: 4usize};\n+\n+    let _clone = x.clone();\n+    assert!(x != y);\n+    assert_eq!(x.partial_cmp(&y).unwrap(), x.cmp(&y));\n+    x.hash(&mut DefaultHasher::new());\n+    P::default();\n+    format!(\"{:?}\", x);\n+}\n+\n fn main() {\n     test_basic();\n     test_unsizing();\n     test_drop();\n     test_inner_packed();\n     test_static();\n+    test_derive();\n }"}]}