{"sha": "5b0a49efa8d5ecc2838edfb93820e46dbff1a606", "node_id": "MDY6Q29tbWl0NzI0NzEyOjViMGE0OWVmYThkNWVjYzI4MzhlZGZiOTM4MjBlNDZkYmZmMWE2MDY=", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2021-06-04T04:42:57Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-06-04T04:42:57Z"}, "message": "Rollup merge of #85899 - klensy:jsondocck-f, r=Mark-Simulacrum\n\njsondocck small cleanup\n\nupdated `shlex` (there was some fix https://github.com/comex/rust-shlex/commit/6db4704fcad8393dd6947b1d31720327546a84a2)\nreplaced `lazy_static` with `once_cell`\nremoved `serde` direct dependency (`serde_json` will pull it)", "tree": {"sha": "2691dc0d2bd9bd291fd5a232391fcee10c44a886", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2691dc0d2bd9bd291fd5a232391fcee10c44a886"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5b0a49efa8d5ecc2838edfb93820e46dbff1a606", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgua9RCRBK7hj4Ov3rIwAA9I8IAH/oMXPKwyz4j9+lrChNRd0T\nuwoPPNoLRResviHRAedq6m4Widxa1ra1lptjqG/o4vad+FNeKLfZoaLqKBTU9ub2\nmt4sW2iaWXDSmeAxmEELcP+cyor2dTx7JCgxL23GgeJyGziDxKkiFujHy2r/Q8ZP\noCpBBw5j/ukWeiK8mkd89XgpsZVcUgLhh+2LfrYW30UV1pZaN1DAlFIoKKOTPS6U\nIpkeRfnnecYTvSc5k0Z8Zr5qnNI9reY36guhQP0JubkHOFEmVvrwby+/daQIedfZ\nlsx0I3jmS07oAuQo1ck6+rIKTDWdbv4yOuVoouR4xNuEA8X49TPg19sBudZf3nk=\n=Q0cg\n-----END PGP SIGNATURE-----\n", "payload": "tree 2691dc0d2bd9bd291fd5a232391fcee10c44a886\nparent 3500e76330c92196064d5ebdee6dfcd3f56c193c\nparent 5afc594e6294cee451ded335397cade6a9098bd1\nauthor Yuki Okushi <jtitor@2k36.org> 1622781777 +0900\ncommitter GitHub <noreply@github.com> 1622781777 +0900\n\nRollup merge of #85899 - klensy:jsondocck-f, r=Mark-Simulacrum\n\njsondocck small cleanup\n\nupdated `shlex` (there was some fix https://github.com/comex/rust-shlex/commit/6db4704fcad8393dd6947b1d31720327546a84a2)\nreplaced `lazy_static` with `once_cell`\nremoved `serde` direct dependency (`serde_json` will pull it)\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5b0a49efa8d5ecc2838edfb93820e46dbff1a606", "html_url": "https://github.com/rust-lang/rust/commit/5b0a49efa8d5ecc2838edfb93820e46dbff1a606", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5b0a49efa8d5ecc2838edfb93820e46dbff1a606/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3500e76330c92196064d5ebdee6dfcd3f56c193c", "url": "https://api.github.com/repos/rust-lang/rust/commits/3500e76330c92196064d5ebdee6dfcd3f56c193c", "html_url": "https://github.com/rust-lang/rust/commit/3500e76330c92196064d5ebdee6dfcd3f56c193c"}, {"sha": "5afc594e6294cee451ded335397cade6a9098bd1", "url": "https://api.github.com/repos/rust-lang/rust/commits/5afc594e6294cee451ded335397cade6a9098bd1", "html_url": "https://github.com/rust-lang/rust/commit/5afc594e6294cee451ded335397cade6a9098bd1"}], "stats": {"total": 30, "additions": 11, "deletions": 19}, "files": [{"sha": "3096b8c40f7f6b7825d2579f4a58cec3d113769c", "filename": "Cargo.lock", "status": "modified", "additions": 3, "deletions": 10, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/5b0a49efa8d5ecc2838edfb93820e46dbff1a606/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/5b0a49efa8d5ecc2838edfb93820e46dbff1a606/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=5b0a49efa8d5ecc2838edfb93820e46dbff1a606", "patch": "@@ -1753,11 +1753,10 @@ dependencies = [\n  \"fs-err\",\n  \"getopts\",\n  \"jsonpath_lib\",\n- \"lazy_static\",\n+ \"once_cell\",\n  \"regex\",\n- \"serde\",\n  \"serde_json\",\n- \"shlex 0.1.1\",\n+ \"shlex\",\n ]\n \n [[package]]\n@@ -2138,7 +2137,7 @@ dependencies = [\n  \"serde\",\n  \"serde_derive\",\n  \"serde_json\",\n- \"shlex 1.0.0\",\n+ \"shlex\",\n  \"tempfile\",\n  \"toml\",\n ]\n@@ -4813,12 +4812,6 @@ version = \"0.1.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"45bb67a18fa91266cc7807181f62f9178a6873bfad7dc788c42e6430db40184f\"\n \n-[[package]]\n-name = \"shlex\"\n-version = \"0.1.1\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"7fdf1b9db47230893d76faad238fd6097fd6d6a9245cd7a4d90dbd639536bbd2\"\n-\n [[package]]\n name = \"shlex\"\n version = \"1.0.0\""}, {"sha": "b5f1554dbe4df7959a6524ef972f91eb97cf3be8", "filename": "src/tools/jsondocck/Cargo.toml", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5b0a49efa8d5ecc2838edfb93820e46dbff1a606/src%2Ftools%2Fjsondocck%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/5b0a49efa8d5ecc2838edfb93820e46dbff1a606/src%2Ftools%2Fjsondocck%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fjsondocck%2FCargo.toml?ref=5b0a49efa8d5ecc2838edfb93820e46dbff1a606", "patch": "@@ -8,8 +8,7 @@ edition = \"2018\"\n jsonpath_lib = \"0.2\"\n getopts = \"0.2\"\n regex = \"1.4\"\n-lazy_static = \"1.4\"\n-shlex = \"0.1\"\n-serde = \"1.0\"\n+shlex = \"1.0\"\n serde_json = \"1.0\"\n fs-err = \"2.5.0\"\n+once_cell = \"1.0\""}, {"sha": "b8ea10f3d22778e6a96032bdecc729f8ba1b2376", "filename": "src/tools/jsondocck/src/main.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/5b0a49efa8d5ecc2838edfb93820e46dbff1a606/src%2Ftools%2Fjsondocck%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5b0a49efa8d5ecc2838edfb93820e46dbff1a606/src%2Ftools%2Fjsondocck%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fjsondocck%2Fsrc%2Fmain.rs?ref=5b0a49efa8d5ecc2838edfb93820e46dbff1a606", "patch": "@@ -1,5 +1,5 @@\n use jsonpath_lib::select;\n-use lazy_static::lazy_static;\n+use once_cell::sync::Lazy;\n use regex::{Regex, RegexBuilder};\n use serde_json::Value;\n use std::borrow::Cow;\n@@ -94,19 +94,19 @@ impl fmt::Display for CommandKind {\n     }\n }\n \n-lazy_static! {\n-    static ref LINE_PATTERN: Regex = RegexBuilder::new(\n+static LINE_PATTERN: Lazy<Regex> = Lazy::new(|| {\n+    RegexBuilder::new(\n         r#\"\n         \\s(?P<invalid>!?)@(?P<negated>!?)\n         (?P<cmd>[A-Za-z]+(?:-[A-Za-z]+)*)\n         (?P<args>.*)$\n-    \"#\n+    \"#,\n     )\n     .ignore_whitespace(true)\n     .unicode(true)\n     .build()\n-    .unwrap();\n-}\n+    .unwrap()\n+});\n \n fn print_err(msg: &str, lineno: usize) {\n     eprintln!(\"Invalid command: {} on line {}\", msg, lineno)"}]}