{"sha": "94d96b60f334e662f516bd0f04cc4191d7a804e6", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk0ZDk2YjYwZjMzNGU2NjJmNTE2YmQwZjA0Y2M0MTkxZDdhODA0ZTY=", "commit": {"author": {"name": "gfreezy", "email": "gfreezy@gmail.com", "date": "2019-01-19T16:38:34Z"}, "committer": {"name": "gfreezy", "email": "gfreezy@gmail.com", "date": "2019-01-19T16:38:34Z"}, "message": "refactor to use `remove_range` and `replace_range` instead of TextEdit", "tree": {"sha": "34ed5b9da22c938a5f7a3cac7a09de5812fa819f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/34ed5b9da22c938a5f7a3cac7a09de5812fa819f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/94d96b60f334e662f516bd0f04cc4191d7a804e6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/94d96b60f334e662f516bd0f04cc4191d7a804e6", "html_url": "https://github.com/rust-lang/rust/commit/94d96b60f334e662f516bd0f04cc4191d7a804e6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/94d96b60f334e662f516bd0f04cc4191d7a804e6/comments", "author": {"login": "gfreezy", "id": 510012, "node_id": "MDQ6VXNlcjUxMDAxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/510012?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gfreezy", "html_url": "https://github.com/gfreezy", "followers_url": "https://api.github.com/users/gfreezy/followers", "following_url": "https://api.github.com/users/gfreezy/following{/other_user}", "gists_url": "https://api.github.com/users/gfreezy/gists{/gist_id}", "starred_url": "https://api.github.com/users/gfreezy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gfreezy/subscriptions", "organizations_url": "https://api.github.com/users/gfreezy/orgs", "repos_url": "https://api.github.com/users/gfreezy/repos", "events_url": "https://api.github.com/users/gfreezy/events{/privacy}", "received_events_url": "https://api.github.com/users/gfreezy/received_events", "type": "User", "site_admin": false}, "committer": {"login": "gfreezy", "id": 510012, "node_id": "MDQ6VXNlcjUxMDAxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/510012?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gfreezy", "html_url": "https://github.com/gfreezy", "followers_url": "https://api.github.com/users/gfreezy/followers", "following_url": "https://api.github.com/users/gfreezy/following{/other_user}", "gists_url": "https://api.github.com/users/gfreezy/gists{/gist_id}", "starred_url": "https://api.github.com/users/gfreezy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gfreezy/subscriptions", "organizations_url": "https://api.github.com/users/gfreezy/orgs", "repos_url": "https://api.github.com/users/gfreezy/repos", "events_url": "https://api.github.com/users/gfreezy/events{/privacy}", "received_events_url": "https://api.github.com/users/gfreezy/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "64342599ca43fb72d0db8e79802a1018f480b5f5", "url": "https://api.github.com/repos/rust-lang/rust/commits/64342599ca43fb72d0db8e79802a1018f480b5f5", "html_url": "https://github.com/rust-lang/rust/commit/64342599ca43fb72d0db8e79802a1018f480b5f5"}], "stats": {"total": 1374, "additions": 619, "deletions": 755}, "files": [{"sha": "e1c0d26c7d1640379723e715127e0949b2ef924c", "filename": "crates/ra_ide_api/src/completion/complete_dot.rs", "status": "modified", "additions": 10, "deletions": 6, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_dot.rs", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_dot.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_dot.rs?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -31,7 +31,7 @@ fn complete_fields(acc: &mut Completions, ctx: &CompletionContext, receiver: Ty)\n                         for field in s.fields(ctx.db) {\n                             CompletionItem::new(\n                                 CompletionKind::Reference,\n-                                ctx,\n+                                ctx.leaf_range(),\n                                 field.name().to_string(),\n                             )\n                             .kind(CompletionItemKind::Field)\n@@ -45,7 +45,7 @@ fn complete_fields(acc: &mut Completions, ctx: &CompletionContext, receiver: Ty)\n             }\n             Ty::Tuple(fields) => {\n                 for (i, _ty) in fields.iter().enumerate() {\n-                    CompletionItem::new(CompletionKind::Reference, ctx, i.to_string())\n+                    CompletionItem::new(CompletionKind::Reference, ctx.leaf_range(), i.to_string())\n                         .kind(CompletionItemKind::Field)\n                         .add_to(acc);\n                 }\n@@ -59,10 +59,14 @@ fn complete_methods(acc: &mut Completions, ctx: &CompletionContext, receiver: Ty\n     receiver.iterate_methods(ctx.db, |func| {\n         let sig = func.signature(ctx.db);\n         if sig.has_self_param() {\n-            CompletionItem::new(CompletionKind::Reference, ctx, sig.name().to_string())\n-                .from_function(ctx, func)\n-                .kind(CompletionItemKind::Method)\n-                .add_to(acc);\n+            CompletionItem::new(\n+                CompletionKind::Reference,\n+                ctx.leaf_range(),\n+                sig.name().to_string(),\n+            )\n+            .from_function(ctx, func)\n+            .kind(CompletionItemKind::Method)\n+            .add_to(acc);\n         }\n         None::<()>\n     });"}, {"sha": "c3e3ea93100ddea8cb380eed6e9d23375fe9bda6", "filename": "crates/ra_ide_api/src/completion/complete_fn_param.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_fn_param.rs", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_fn_param.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_fn_param.rs?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -34,7 +34,7 @@ pub(super) fn complete_fn_param(acc: &mut Completions, ctx: &CompletionContext)\n             }\n         })\n         .for_each(|(label, lookup)| {\n-            CompletionItem::new(CompletionKind::Magic, ctx, label)\n+            CompletionItem::new(CompletionKind::Magic, ctx.leaf_range(), label)\n                 .lookup_by(lookup)\n                 .add_to(acc)\n         });"}, {"sha": "006b200765686f8da3a5398246a9873d90cf5838", "filename": "crates/ra_ide_api/src/completion/complete_keyword.rs", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_keyword.rs", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_keyword.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_keyword.rs?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -9,25 +9,26 @@ use crate::completion::{CompletionContext, CompletionItem, Completions, Completi\n \n pub(super) fn complete_use_tree_keyword(acc: &mut Completions, ctx: &CompletionContext) {\n     // complete keyword \"crate\" in use stmt\n+    let leaf_range = ctx.leaf_range();\n     match (ctx.use_item_syntax.as_ref(), ctx.path_prefix.as_ref()) {\n         (Some(_), None) => {\n-            CompletionItem::new(CompletionKind::Keyword, ctx, \"crate\")\n+            CompletionItem::new(CompletionKind::Keyword, leaf_range, \"crate\")\n                 .kind(CompletionItemKind::Keyword)\n                 .insert_text(\"crate::\")\n                 .add_to(acc);\n-            CompletionItem::new(CompletionKind::Keyword, ctx, \"self\")\n+            CompletionItem::new(CompletionKind::Keyword, leaf_range, \"self\")\n                 .kind(CompletionItemKind::Keyword)\n                 .add_to(acc);\n-            CompletionItem::new(CompletionKind::Keyword, ctx, \"super\")\n+            CompletionItem::new(CompletionKind::Keyword, leaf_range, \"super\")\n                 .kind(CompletionItemKind::Keyword)\n                 .insert_text(\"super::\")\n                 .add_to(acc);\n         }\n         (Some(_), Some(_)) => {\n-            CompletionItem::new(CompletionKind::Keyword, ctx, \"self\")\n+            CompletionItem::new(CompletionKind::Keyword, leaf_range, \"self\")\n                 .kind(CompletionItemKind::Keyword)\n                 .add_to(acc);\n-            CompletionItem::new(CompletionKind::Keyword, ctx, \"super\")\n+            CompletionItem::new(CompletionKind::Keyword, leaf_range, \"super\")\n                 .kind(CompletionItemKind::Keyword)\n                 .insert_text(\"super::\")\n                 .add_to(acc);\n@@ -37,7 +38,7 @@ pub(super) fn complete_use_tree_keyword(acc: &mut Completions, ctx: &CompletionC\n }\n \n fn keyword(ctx: &CompletionContext, kw: &str, snippet: &str) -> CompletionItem {\n-    CompletionItem::new(CompletionKind::Keyword, ctx, kw)\n+    CompletionItem::new(CompletionKind::Keyword, ctx.leaf_range(), kw)\n         .kind(CompletionItemKind::Keyword)\n         .snippet(snippet)\n         .build()"}, {"sha": "513a2ee89c83351fc754ff8537893dbf112b5d38", "filename": "crates/ra_ide_api/src/completion/complete_path.rs", "status": "modified", "additions": 14, "deletions": 6, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_path.rs", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_path.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_path.rs?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -15,18 +15,26 @@ pub(super) fn complete_path(acc: &mut Completions, ctx: &CompletionContext) {\n         hir::Def::Module(module) => {\n             let module_scope = module.scope(ctx.db);\n             for (name, res) in module_scope.entries() {\n-                CompletionItem::new(CompletionKind::Reference, ctx, name.to_string())\n-                    .from_resolution(ctx, res)\n-                    .add_to(acc);\n+                CompletionItem::new(\n+                    CompletionKind::Reference,\n+                    ctx.leaf_range(),\n+                    name.to_string(),\n+                )\n+                .from_resolution(ctx, res)\n+                .add_to(acc);\n             }\n         }\n         hir::Def::Enum(e) => {\n             e.variants(ctx.db)\n                 .into_iter()\n                 .for_each(|(variant_name, _variant)| {\n-                    CompletionItem::new(CompletionKind::Reference, ctx, variant_name.to_string())\n-                        .kind(CompletionItemKind::EnumVariant)\n-                        .add_to(acc)\n+                    CompletionItem::new(\n+                        CompletionKind::Reference,\n+                        ctx.leaf_range(),\n+                        variant_name.to_string(),\n+                    )\n+                    .kind(CompletionItemKind::EnumVariant)\n+                    .add_to(acc)\n                 });\n         }\n         _ => return,"}, {"sha": "958a12f226b61e44a0123284f1e6ac8df9f5aeca", "filename": "crates/ra_ide_api/src/completion/complete_scope.rs", "status": "modified", "additions": 14, "deletions": 6, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_scope.rs", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_scope.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_scope.rs?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -29,9 +29,13 @@ pub(super) fn complete_scope(acc: &mut Completions, ctx: &CompletionContext) {\n             }\n         })\n         .for_each(|(name, res)| {\n-            CompletionItem::new(CompletionKind::Reference, ctx, name.to_string())\n-                .from_resolution(ctx, res)\n-                .add_to(acc)\n+            CompletionItem::new(\n+                CompletionKind::Reference,\n+                ctx.leaf_range(),\n+                name.to_string(),\n+            )\n+            .from_resolution(ctx, res)\n+            .add_to(acc)\n         });\n }\n \n@@ -46,9 +50,13 @@ fn complete_fn(\n         .flat_map(|scope| scopes.scopes.entries(scope).iter())\n         .filter(|entry| shadowed.insert(entry.name()))\n         .for_each(|entry| {\n-            CompletionItem::new(CompletionKind::Reference, ctx, entry.name().to_string())\n-                .kind(CompletionItemKind::Binding)\n-                .add_to(acc)\n+            CompletionItem::new(\n+                CompletionKind::Reference,\n+                ctx.leaf_range(),\n+                entry.name().to_string(),\n+            )\n+            .kind(CompletionItemKind::Binding)\n+            .add_to(acc)\n         });\n }\n "}, {"sha": "4fa23bbf6f0f8a8701df2945f8a598c43b469688", "filename": "crates/ra_ide_api/src/completion/complete_snippet.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_snippet.rs", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_snippet.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_snippet.rs?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,7 +1,7 @@\n use crate::completion::{CompletionItem, Completions, CompletionKind, CompletionItemKind, CompletionContext, completion_item::Builder};\n \n-fn snippet<'a>(ctx: &'a CompletionContext<'a>, label: &str, snippet: &str) -> Builder<'a> {\n-    CompletionItem::new(CompletionKind::Snippet, ctx, label)\n+fn snippet(ctx: &CompletionContext, label: &str, snippet: &str) -> Builder {\n+    CompletionItem::new(CompletionKind::Snippet, ctx.leaf_range(), label)\n         .snippet(snippet)\n         .kind(CompletionItemKind::Snippet)\n }"}, {"sha": "da8da94d1ec5b673ce85e9d6bc2228033abe8788", "filename": "crates/ra_ide_api/src/completion/completion_item.rs", "status": "modified", "additions": 36, "deletions": 74, "changes": 110, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcompletion_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcompletion_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcompletion_item.rs?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,10 +1,7 @@\n use hir::PerNs;\n-use ra_text_edit::{\n-    AtomTextEdit,\n-    TextEdit,\n-};\n \n use crate::completion::completion_context::CompletionContext;\n+use ra_syntax::TextRange;\n \n /// `CompletionItem` describes a single completion variant in the editor pop-up.\n /// It is basically a POD with various properties. To construct a\n@@ -18,26 +15,10 @@ pub struct CompletionItem {\n     kind: Option<CompletionItemKind>,\n     detail: Option<String>,\n     lookup: Option<String>,\n-    /// The format of the insert text. The format applies to both the `insert_text` property\n-    /// and the `insert` property of a provided `text_edit`.\n+    insert_text: Option<String>,\n     insert_text_format: InsertTextFormat,\n-    /// An edit which is applied to a document when selecting this completion. When an edit is\n-    /// provided the value of `insert_text` is ignored.\n-    ///\n-    /// *Note:* The range of the edit must be a single line range and it must contain the position\n-    /// at which completion has been requested.\n-    ///\n-    /// *Note:* If sending a range that overlaps a string, the string should match the relevant\n-    /// part of the replacement text, or be filtered out.\n-    text_edit: Option<AtomTextEdit>,\n-    /// An optional array of additional text edits that are applied when\n-    /// selecting this completion. Edits must not overlap (including the same insert position)\n-    /// with the main edit nor with themselves.\n-    ///\n-    /// Additional text edits should be used to change text unrelated to the current cursor position\n-    /// (for example adding an import statement at the top of the file if the completion item will\n-    /// insert an unqualified type).\n-    additional_text_edits: Option<TextEdit>,\n+    replace_range: TextRange,\n+    delete_range: Option<TextRange>,\n }\n \n #[derive(Debug, Clone, Copy, PartialEq, Eq)]\n@@ -76,23 +57,22 @@ pub enum InsertTextFormat {\n }\n \n impl CompletionItem {\n-    pub(crate) fn new<'a>(\n+    pub(crate) fn new(\n         completion_kind: CompletionKind,\n-        ctx: &'a CompletionContext,\n+        replace_range: TextRange,\n         label: impl Into<String>,\n-    ) -> Builder<'a> {\n+    ) -> Builder {\n         let label = label.into();\n         Builder {\n-            ctx,\n+            replace_range,\n             completion_kind,\n             label,\n             insert_text: None,\n             insert_text_format: InsertTextFormat::PlainText,\n             detail: None,\n             lookup: None,\n             kind: None,\n-            text_edit: None,\n-            additional_text_edits: None,\n+            delete_range: None,\n         }\n     }\n     /// What user sees in pop-up in the UI.\n@@ -114,107 +94,89 @@ impl CompletionItem {\n     pub fn insert_text_format(&self) -> InsertTextFormat {\n         self.insert_text_format.clone()\n     }\n-\n+    pub fn insert_text(&self) -> String {\n+        match &self.insert_text {\n+            Some(t) => t.clone(),\n+            None => self.label.clone(),\n+        }\n+    }\n     pub fn kind(&self) -> Option<CompletionItemKind> {\n         self.kind\n     }\n-    pub fn text_edit(&mut self) -> Option<&AtomTextEdit> {\n-        self.text_edit.as_ref()\n+    pub fn delete_range(&self) -> Option<TextRange> {\n+        self.delete_range\n     }\n-    pub fn take_additional_text_edits(&mut self) -> Option<TextEdit> {\n-        self.additional_text_edits.take()\n+    pub fn replace_range(&self) -> TextRange {\n+        self.replace_range\n     }\n }\n \n /// A helper to make `CompletionItem`s.\n #[must_use]\n-pub(crate) struct Builder<'a> {\n-    ctx: &'a CompletionContext<'a>,\n+pub(crate) struct Builder {\n+    replace_range: TextRange,\n     completion_kind: CompletionKind,\n     label: String,\n     insert_text: Option<String>,\n     insert_text_format: InsertTextFormat,\n     detail: Option<String>,\n     lookup: Option<String>,\n     kind: Option<CompletionItemKind>,\n-    text_edit: Option<AtomTextEdit>,\n-    additional_text_edits: Option<TextEdit>,\n+    delete_range: Option<TextRange>,\n }\n \n-impl<'a> Builder<'a> {\n+impl Builder {\n     pub(crate) fn add_to(self, acc: &mut Completions) {\n         acc.add(self.build())\n     }\n \n     pub(crate) fn build(self) -> CompletionItem {\n-        let self_text_edit = self.text_edit;\n-        let self_insert_text = self.insert_text;\n-        let text_edit = match (self_text_edit, self_insert_text) {\n-            (Some(text_edit), ..) => Some(text_edit),\n-            (None, Some(insert_text)) => {\n-                Some(AtomTextEdit::replace(self.ctx.leaf_range(), insert_text))\n-            }\n-            _ => None,\n-        };\n-\n         CompletionItem {\n+            replace_range: self.replace_range,\n             label: self.label,\n             detail: self.detail,\n             insert_text_format: self.insert_text_format,\n             lookup: self.lookup,\n             kind: self.kind,\n             completion_kind: self.completion_kind,\n-            text_edit,\n-            additional_text_edits: self.additional_text_edits,\n+            delete_range: self.delete_range,\n+            insert_text: self.insert_text,\n         }\n     }\n-    pub(crate) fn lookup_by(mut self, lookup: impl Into<String>) -> Builder<'a> {\n+    pub(crate) fn lookup_by(mut self, lookup: impl Into<String>) -> Builder {\n         self.lookup = Some(lookup.into());\n         self\n     }\n-    pub(crate) fn insert_text(mut self, insert_text: impl Into<String>) -> Builder<'a> {\n+    pub(crate) fn insert_text(mut self, insert_text: impl Into<String>) -> Builder {\n         self.insert_text = Some(insert_text.into());\n         self\n     }\n     #[allow(unused)]\n-    pub(crate) fn insert_text_format(\n-        mut self,\n-        insert_text_format: InsertTextFormat,\n-    ) -> Builder<'a> {\n+    pub(crate) fn insert_text_format(mut self, insert_text_format: InsertTextFormat) -> Builder {\n         self.insert_text_format = insert_text_format;\n         self\n     }\n-    pub(crate) fn snippet(mut self, snippet: impl Into<String>) -> Builder<'a> {\n+    pub(crate) fn snippet(mut self, snippet: impl Into<String>) -> Builder {\n         self.insert_text_format = InsertTextFormat::Snippet;\n         self.insert_text(snippet)\n     }\n-    pub(crate) fn kind(mut self, kind: CompletionItemKind) -> Builder<'a> {\n+    pub(crate) fn kind(mut self, kind: CompletionItemKind) -> Builder {\n         self.kind = Some(kind);\n         self\n     }\n     #[allow(unused)]\n-    pub(crate) fn text_edit(mut self, text_edit: AtomTextEdit) -> Builder<'a> {\n-        self.text_edit = Some(text_edit);\n-        self\n-    }\n-    #[allow(unused)]\n-    pub(crate) fn additional_text_edits(mut self, additional_text_edits: TextEdit) -> Builder<'a> {\n-        self.additional_text_edits = Some(additional_text_edits);\n-        self\n-    }\n-    #[allow(unused)]\n-    pub(crate) fn detail(self, detail: impl Into<String>) -> Builder<'a> {\n+    pub(crate) fn detail(self, detail: impl Into<String>) -> Builder {\n         self.set_detail(Some(detail))\n     }\n-    pub(crate) fn set_detail(mut self, detail: Option<impl Into<String>>) -> Builder<'a> {\n+    pub(crate) fn set_detail(mut self, detail: Option<impl Into<String>>) -> Builder {\n         self.detail = detail.map(Into::into);\n         self\n     }\n     pub(super) fn from_resolution(\n         mut self,\n         ctx: &CompletionContext,\n         resolution: &hir::Resolution,\n-    ) -> Builder<'a> {\n+    ) -> Builder {\n         let resolved = resolution.def_id.map(|d| d.resolve(ctx.db));\n         let kind = match resolved {\n             PerNs {\n@@ -259,7 +221,7 @@ impl<'a> Builder<'a> {\n         mut self,\n         ctx: &CompletionContext,\n         function: hir::Function,\n-    ) -> Builder<'a> {\n+    ) -> Builder {\n         // If not an import, add parenthesis automatically.\n         if ctx.use_item_syntax.is_none() && !ctx.is_call {\n             if function.signature(ctx.db).params().is_empty() {\n@@ -274,7 +236,7 @@ impl<'a> Builder<'a> {\n     }\n }\n \n-impl<'a> Into<CompletionItem> for Builder<'a> {\n+impl<'a> Into<CompletionItem> for Builder {\n     fn into(self) -> CompletionItem {\n         self.build()\n     }"}, {"sha": "ff8646ab208b7274dc3d005b8bc2d382096e160c", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__bindings_from_for.snap", "status": "modified", "additions": 9, "deletions": 10, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_for.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_for.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_for.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.835266+00:00\n+Created: 2019-01-19T16:37:23.674785+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,9 +11,10 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [62; 100),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -23,13 +24,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [62; 100),\n-                insert: \"quux()$0\"\n-            }\n+        insert_text: Some(\n+            \"quux()$0\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [62; 100),\n+        delete_range: None\n     }\n ]"}, {"sha": "2176af32d8d8306a92aa194b856f38f184f25ebb", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__bindings_from_if_let.snap", "status": "modified", "additions": 12, "deletions": 12, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_if_let.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_if_let.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_if_let.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.835796+00:00\n+Created: 2019-01-19T16:37:23.676585+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,9 +11,10 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [213; 231),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -23,9 +24,10 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [213; 231),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -35,13 +37,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [213; 231),\n-                insert: \"quux()$0\"\n-            }\n+        insert_text: Some(\n+            \"quux()$0\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [213; 231),\n+        delete_range: None\n     }\n ]"}, {"sha": "49745745dc7a1ea86d4516f510ebfc84cbb4ca09", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__bindings_from_let.snap", "status": "modified", "additions": 12, "deletions": 12, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_let.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_let.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_let.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.835351+00:00\n+Created: 2019-01-19T16:37:23.676674+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,9 +11,10 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [78; 79),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -23,9 +24,10 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [78; 79),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -35,13 +37,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [78; 79),\n-                insert: \"quux($0)\"\n-            }\n+        insert_text: Some(\n+            \"quux($0)\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [78; 79),\n+        delete_range: None\n     }\n ]"}, {"sha": "c8a0a78aab66d0dc96df3111d7e01370941129bd", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__completes_break_and_continue_in_loops1.snap", "status": "modified", "additions": 36, "deletions": 50, "changes": 86, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_break_and_continue_in_loops1.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_break_and_continue_in_loops1.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_break_and_continue_in_loops1.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.819543+00:00\n+Created: 2019-01-19T16:37:23.630898+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,14 +11,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [54; 56),\n-                insert: \"if $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"if $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [54; 56),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -28,14 +26,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [54; 56),\n-                insert: \"match $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"match $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [54; 56),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -45,14 +41,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [54; 56),\n-                insert: \"while $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"while $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [54; 56),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -62,14 +56,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [54; 56),\n-                insert: \"loop {$0}\"\n-            }\n+        insert_text: Some(\n+            \"loop {$0}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [54; 56),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -79,14 +71,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [54; 56),\n-                insert: \"continue;\"\n-            }\n+        insert_text: Some(\n+            \"continue;\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [54; 56),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -96,14 +86,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [54; 56),\n-                insert: \"break;\"\n-            }\n+        insert_text: Some(\n+            \"break;\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [54; 56),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -113,13 +101,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [54; 56),\n-                insert: \"return $0;\"\n-            }\n+        insert_text: Some(\n+            \"return $0;\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [54; 56),\n+        delete_range: None\n     }\n ]"}, {"sha": "707021e21257654e0279e5498ab4fead78d62f7c", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__completes_break_and_continue_in_loops2.snap", "status": "modified", "additions": 26, "deletions": 36, "changes": 62, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_break_and_continue_in_loops2.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_break_and_continue_in_loops2.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_break_and_continue_in_loops2.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.830288+00:00\n+Created: 2019-01-19T16:37:23.647435+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,14 +11,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [59; 61),\n-                insert: \"if $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"if $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [59; 61),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -28,14 +26,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [59; 61),\n-                insert: \"match $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"match $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [59; 61),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -45,14 +41,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [59; 61),\n-                insert: \"while $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"while $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [59; 61),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -62,14 +56,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [59; 61),\n-                insert: \"loop {$0}\"\n-            }\n+        insert_text: Some(\n+            \"loop {$0}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [59; 61),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -79,13 +71,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [59; 61),\n-                insert: \"return $0;\"\n-            }\n+        insert_text: Some(\n+            \"return $0;\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [59; 61),\n+        delete_range: None\n     }\n ]"}, {"sha": "a65ab3cc0083db19d1fa396fe44b985d9b506e63", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__deeply_nested_use_tree.snap", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__deeply_nested_use_tree.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__deeply_nested_use_tree.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__deeply_nested_use_tree.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T11:53:16.799862+00:00\n+Created: 2019-01-19T16:37:23.649286+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,8 +11,9 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [23; 25),\n+        delete_range: None\n     }\n ]"}, {"sha": "a935b06f4e5e0d3bc0b41f49435da1be1d2a3250", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__dont_add_semi_after_return_if_not_a_statement.snap", "status": "modified", "additions": 26, "deletions": 36, "changes": 62, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_add_semi_after_return_if_not_a_statement.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_add_semi_after_return_if_not_a_statement.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_add_semi_after_return_if_not_a_statement.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.821375+00:00\n+Created: 2019-01-19T16:37:23.640573+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,14 +11,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [84; 102),\n-                insert: \"if $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"if $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [84; 102),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -28,14 +26,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [84; 102),\n-                insert: \"match $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"match $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [84; 102),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -45,14 +41,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [84; 102),\n-                insert: \"while $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"while $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [84; 102),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -62,14 +56,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [84; 102),\n-                insert: \"loop {$0}\"\n-            }\n+        insert_text: Some(\n+            \"loop {$0}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [84; 102),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -79,13 +71,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [84; 102),\n-                insert: \"return $0\"\n-            }\n+        insert_text: Some(\n+            \"return $0\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [84; 102),\n+        delete_range: None\n     }\n ]"}, {"sha": "abc01d4d610327f4c2e0afd398a37a50ff3fc29c", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__dont_render_function_parens_if_already_call.snap", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_render_function_parens_if_already_call.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_render_function_parens_if_already_call.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_render_function_parens_if_already_call.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T11:53:16.799845+00:00\n+Created: 2019-01-19T16:37:23.670539+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,9 +11,10 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [35; 39),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -23,8 +24,9 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [35; 39),\n+        delete_range: None\n     }\n ]"}, {"sha": "2d3234b2c24026e7c2c7c580a2d450f932838f90", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__dont_render_function_parens_in_use_item.snap", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_render_function_parens_in_use_item.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_render_function_parens_in_use_item.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_render_function_parens_in_use_item.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T11:53:16.799820+00:00\n+Created: 2019-01-19T16:37:23.671764+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,8 +11,9 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [40; 41),\n+        delete_range: None\n     }\n ]"}, {"sha": "6e4817d1a6d02a50320dc4849ab49d826e0477ea", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__dont_show_both_completions_for_shadowing.snap", "status": "modified", "additions": 9, "deletions": 10, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_show_both_completions_for_shadowing.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_show_both_completions_for_shadowing.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_show_both_completions_for_shadowing.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.841643+00:00\n+Created: 2019-01-19T16:37:23.680378+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,9 +11,10 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [108; 146),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -23,13 +24,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [108; 146),\n-                insert: \"foo()$0\"\n-            }\n+        insert_text: Some(\n+            \"foo()$0\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [108; 146),\n+        delete_range: None\n     }\n ]"}, {"sha": "4ec75e2ca48503e4eb6a93edb3ea9dc8dfa61a7d", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__inserts_parens_for_function_calls1.snap", "status": "modified", "additions": 11, "deletions": 15, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__inserts_parens_for_function_calls1.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__inserts_parens_for_function_calls1.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__inserts_parens_for_function_calls1.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.844671+00:00\n+Created: 2019-01-19T16:37:23.681170+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,14 +11,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [53; 56),\n-                insert: \"no_args()$0\"\n-            }\n+        insert_text: Some(\n+            \"no_args()$0\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [53; 56),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -28,13 +26,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [53; 56),\n-                insert: \"main()$0\"\n-            }\n+        insert_text: Some(\n+            \"main()$0\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [53; 56),\n+        delete_range: None\n     }\n ]"}, {"sha": "11a8f175722580201ffe3936849443e706601fae", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__inserts_parens_for_function_calls2.snap", "status": "modified", "additions": 11, "deletions": 15, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__inserts_parens_for_function_calls2.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__inserts_parens_for_function_calls2.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__inserts_parens_for_function_calls2.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.849139+00:00\n+Created: 2019-01-19T16:37:23.686781+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,14 +11,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [72; 77),\n-                insert: \"main()$0\"\n-            }\n+        insert_text: Some(\n+            \"main()$0\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [72; 77),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -28,13 +26,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [72; 77),\n-                insert: \"with_args($0)\"\n-            }\n+        insert_text: Some(\n+            \"with_args($0)\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [72; 77),\n+        delete_range: None\n     }\n ]"}, {"sha": "02e88a96e0b9bcf1298815baab40af5936a272be", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__keywords_in_function1.snap", "status": "modified", "additions": 26, "deletions": 36, "changes": 62, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function1.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function1.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function1.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.819926+00:00\n+Created: 2019-01-19T16:37:23.640068+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,14 +11,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [24; 54),\n-                insert: \"if $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"if $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [24; 54),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -28,14 +26,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [24; 54),\n-                insert: \"match $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"match $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [24; 54),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -45,14 +41,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [24; 54),\n-                insert: \"while $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"while $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [24; 54),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -62,14 +56,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [24; 54),\n-                insert: \"loop {$0}\"\n-            }\n+        insert_text: Some(\n+            \"loop {$0}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [24; 54),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -79,13 +71,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [24; 54),\n-                insert: \"return;\"\n-            }\n+        insert_text: Some(\n+            \"return;\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [24; 54),\n+        delete_range: None\n     }\n ]"}, {"sha": "41dc288f6c6162ce060c4b2317c3e421f858480c", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__keywords_in_function2.snap", "status": "modified", "additions": 36, "deletions": 50, "changes": 86, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function2.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function2.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function2.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.819839+00:00\n+Created: 2019-01-19T16:37:23.640134+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,14 +11,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [91; 105),\n-                insert: \"if $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"if $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [91; 105),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -28,14 +26,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [91; 105),\n-                insert: \"match $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"match $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [91; 105),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -45,14 +41,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [91; 105),\n-                insert: \"while $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"while $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [91; 105),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -62,14 +56,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [91; 105),\n-                insert: \"loop {$0}\"\n-            }\n+        insert_text: Some(\n+            \"loop {$0}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [91; 105),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -79,14 +71,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [91; 105),\n-                insert: \"else {$0}\"\n-            }\n+        insert_text: Some(\n+            \"else {$0}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [91; 105),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -96,14 +86,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [91; 105),\n-                insert: \"else if $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"else if $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [91; 105),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -113,13 +101,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [91; 105),\n-                insert: \"return;\"\n-            }\n+        insert_text: Some(\n+            \"return;\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [91; 105),\n+        delete_range: None\n     }\n ]"}, {"sha": "6cbed012f864bf8d52737845e1101ce28fef7108", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__keywords_in_function3.snap", "status": "modified", "additions": 26, "deletions": 36, "changes": 62, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function3.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function3.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function3.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.822255+00:00\n+Created: 2019-01-19T16:37:23.640767+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,14 +11,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [31; 65),\n-                insert: \"if $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"if $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [31; 65),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -28,14 +26,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [31; 65),\n-                insert: \"match $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"match $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [31; 65),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -45,14 +41,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [31; 65),\n-                insert: \"while $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"while $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [31; 65),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -62,14 +56,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [31; 65),\n-                insert: \"loop {$0}\"\n-            }\n+        insert_text: Some(\n+            \"loop {$0}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [31; 65),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -79,13 +71,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [31; 65),\n-                insert: \"return $0;\"\n-            }\n+        insert_text: Some(\n+            \"return $0;\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [31; 65),\n+        delete_range: None\n     }\n ]"}, {"sha": "b95cb72c11bbaec09c694d71f4a9f54398c11084", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__keywords_in_function4.snap", "status": "modified", "additions": 26, "deletions": 36, "changes": 62, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function4.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function4.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function4.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.830680+00:00\n+Created: 2019-01-19T16:37:23.664707+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,14 +11,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [24; 58),\n-                insert: \"if $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"if $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [24; 58),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -28,14 +26,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [24; 58),\n-                insert: \"match $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"match $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [24; 58),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -45,14 +41,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [24; 58),\n-                insert: \"while $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"while $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [24; 58),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -62,14 +56,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [24; 58),\n-                insert: \"loop {$0}\"\n-            }\n+        insert_text: Some(\n+            \"loop {$0}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [24; 58),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -79,13 +71,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [24; 58),\n-                insert: \"return;\"\n-            }\n+        insert_text: Some(\n+            \"return;\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [24; 58),\n+        delete_range: None\n     }\n ]"}, {"sha": "d53c9e72f2b601c5944194865568b1a62f4d4bd8", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__keywords_in_use_stmt1.snap", "status": "modified", "additions": 14, "deletions": 17, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt1.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt1.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt1.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.819227+00:00\n+Created: 2019-01-19T16:37:23.639067+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,14 +11,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: PlainText,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [16; 30),\n-                insert: \"crate::\"\n-            }\n+        insert_text: Some(\n+            \"crate::\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: PlainText,\n+        replace_range: [16; 30),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -28,9 +26,10 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [16; 30),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -40,13 +39,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: PlainText,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [16; 30),\n-                insert: \"super::\"\n-            }\n+        insert_text: Some(\n+            \"super::\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: PlainText,\n+        replace_range: [16; 30),\n+        delete_range: None\n     }\n ]"}, {"sha": "fee3b6e3b0271651aa6b28f0700a052439291d4d", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__keywords_in_use_stmt2.snap", "status": "modified", "additions": 9, "deletions": 10, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt2.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt2.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt2.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.822990+00:00\n+Created: 2019-01-19T16:37:23.643595+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,9 +11,10 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [18; 20),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -23,13 +24,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: PlainText,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [18; 20),\n-                insert: \"super::\"\n-            }\n+        insert_text: Some(\n+            \"super::\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: PlainText,\n+        replace_range: [18; 20),\n+        delete_range: None\n     }\n ]"}, {"sha": "2181d6c8b2a039149f860a806134bcfad12b2df1", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__keywords_in_use_stmt3.snap", "status": "modified", "additions": 9, "deletions": 10, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt3.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt3.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt3.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.826915+00:00\n+Created: 2019-01-19T16:37:23.648502+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,9 +11,10 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [23; 24),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -23,13 +24,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: PlainText,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [23; 24),\n-                insert: \"super::\"\n-            }\n+        insert_text: Some(\n+            \"super::\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: PlainText,\n+        replace_range: [23; 24),\n+        delete_range: None\n     }\n ]"}, {"sha": "6da2c0ea98185f42f72796df0ddf6a67b54c1516", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__last_return_in_block_has_semi1.snap", "status": "modified", "additions": 26, "deletions": 36, "changes": 62, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__last_return_in_block_has_semi1.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__last_return_in_block_has_semi1.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__last_return_in_block_has_semi1.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.821139+00:00\n+Created: 2019-01-19T16:37:23.640449+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,14 +11,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [62; 100),\n-                insert: \"if $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"if $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [62; 100),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -28,14 +26,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [62; 100),\n-                insert: \"match $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"match $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [62; 100),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -45,14 +41,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [62; 100),\n-                insert: \"while $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"while $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [62; 100),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -62,14 +56,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [62; 100),\n-                insert: \"loop {$0}\"\n-            }\n+        insert_text: Some(\n+            \"loop {$0}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [62; 100),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -79,13 +71,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [62; 100),\n-                insert: \"return $0;\"\n-            }\n+        insert_text: Some(\n+            \"return $0;\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [62; 100),\n+        delete_range: None\n     }\n ]"}, {"sha": "33bc4bb518423248f71ebd6b5c27d908c43dcb46", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__last_return_in_block_has_semi2.snap", "status": "modified", "additions": 26, "deletions": 36, "changes": 62, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__last_return_in_block_has_semi2.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__last_return_in_block_has_semi2.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__last_return_in_block_has_semi2.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.829078+00:00\n+Created: 2019-01-19T16:37:23.649440+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,14 +11,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [62; 100),\n-                insert: \"if $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"if $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [62; 100),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -28,14 +26,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [62; 100),\n-                insert: \"match $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"match $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [62; 100),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -45,14 +41,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [62; 100),\n-                insert: \"while $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"while $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [62; 100),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -62,14 +56,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [62; 100),\n-                insert: \"loop {$0}\"\n-            }\n+        insert_text: Some(\n+            \"loop {$0}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [62; 100),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -79,13 +71,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [62; 100),\n-                insert: \"return $0;\"\n-            }\n+        insert_text: Some(\n+            \"return $0;\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [62; 100),\n+        delete_range: None\n     }\n ]"}, {"sha": "9081bd50db5490b9ef1c6f67044273f814470171", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__method_completion.snap", "status": "modified", "additions": 6, "deletions": 8, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__method_completion.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__method_completion.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__method_completion.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.817204+00:00\n+Created: 2019-01-19T16:37:23.629020+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,13 +11,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [143; 144),\n-                insert: \"the_method($0)\"\n-            }\n+        insert_text: Some(\n+            \"the_method($0)\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [143; 144),\n+        delete_range: None\n     }\n ]"}, {"sha": "be75ec0b55cb417eca5a51231c6ec6bb3e6bebe5", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__module_items.snap", "status": "modified", "additions": 12, "deletions": 12, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__module_items.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__module_items.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__module_items.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.835687+00:00\n+Created: 2019-01-19T16:37:23.676740+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,14 +11,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [72; 102),\n-                insert: \"quux()$0\"\n-            }\n+        insert_text: Some(\n+            \"quux()$0\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [72; 102),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -28,9 +26,10 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [72; 102),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -40,8 +39,9 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [72; 102),\n+        delete_range: None\n     }\n ]"}, {"sha": "8277a6191fc6c18a100c1453b42ca0ddb2bfe372", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__module_items_in_nested_modules.snap", "status": "modified", "additions": 9, "deletions": 10, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__module_items_in_nested_modules.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__module_items_in_nested_modules.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__module_items_in_nested_modules.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.836102+00:00\n+Created: 2019-01-19T16:37:23.677905+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,14 +11,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [100; 102),\n-                insert: \"quux()$0\"\n-            }\n+        insert_text: Some(\n+            \"quux()$0\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [100; 102),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -28,8 +26,9 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [100; 102),\n+        delete_range: None\n     }\n ]"}, {"sha": "bb2830737c3315f8caffa3e85956498fd00de88f", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__nested_use_tree.snap", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__nested_use_tree.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__nested_use_tree.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__nested_use_tree.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T11:53:16.799743+00:00\n+Created: 2019-01-19T16:37:23.666350+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,9 +11,10 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [12; 14),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -23,8 +24,9 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [12; 14),\n+        delete_range: None\n     }\n ]"}, {"sha": "8bcf60fa8bb90723c6799dd519439f41e50627d6", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__no_semi_after_break_continue_in_expr.snap", "status": "modified", "additions": 36, "deletions": 50, "changes": 86, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__no_semi_after_break_continue_in_expr.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__no_semi_after_break_continue_in_expr.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__no_semi_after_break_continue_in_expr.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.821881+00:00\n+Created: 2019-01-19T16:37:23.640842+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,14 +11,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [106; 108),\n-                insert: \"if $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"if $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [106; 108),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -28,14 +26,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [106; 108),\n-                insert: \"match $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"match $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [106; 108),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -45,14 +41,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [106; 108),\n-                insert: \"while $0 {}\"\n-            }\n+        insert_text: Some(\n+            \"while $0 {}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [106; 108),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -62,14 +56,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [106; 108),\n-                insert: \"loop {$0}\"\n-            }\n+        insert_text: Some(\n+            \"loop {$0}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [106; 108),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -79,14 +71,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [106; 108),\n-                insert: \"continue\"\n-            }\n+        insert_text: Some(\n+            \"continue\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [106; 108),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -96,14 +86,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [106; 108),\n-                insert: \"break\"\n-            }\n+        insert_text: Some(\n+            \"break\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [106; 108),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Keyword,\n@@ -113,13 +101,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [106; 108),\n-                insert: \"return\"\n-            }\n+        insert_text: Some(\n+            \"return\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [106; 108),\n+        delete_range: None\n     }\n ]"}, {"sha": "67a07512965327219ad80ff9e5eaae230bf36c05", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__param_completion_last_param.snap", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_last_param.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_last_param.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_last_param.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T11:27:14.070727+00:00\n+Created: 2019-01-19T16:37:23.629063+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,8 +11,9 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         lookup: Some(\n             \"file_id\"\n         ),\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [98; 102),\n+        delete_range: None\n     }\n ]"}, {"sha": "7f349ea160cd8a99cc4d7929032c6966b4ea457d", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__param_completion_nth_param.snap", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_nth_param.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_nth_param.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_nth_param.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T11:29:09.355053+00:00\n+Created: 2019-01-19T16:37:23.629062+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,8 +11,9 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         lookup: Some(\n             \"file_id\"\n         ),\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [98; 102),\n+        delete_range: None\n     }\n ]"}, {"sha": "8aa07e2bcc771beeb15de14593ae5aad63a910c1", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__param_completion_trait_param.snap", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_trait_param.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_trait_param.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_trait_param.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T11:29:09.355066+00:00\n+Created: 2019-01-19T16:37:23.630980+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,8 +11,9 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         lookup: Some(\n             \"file_id\"\n         ),\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [269; 273),\n+        delete_range: None\n     }\n ]"}, {"sha": "1e69b865fd6c7066aa83c9daa44484f70d3fa760", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__reference_completion.snap", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__reference_completion.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__reference_completion.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__reference_completion.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T11:53:16.799765+00:00\n+Created: 2019-01-19T16:37:23.664242+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,9 +11,10 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [45; 47),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -23,8 +24,9 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [45; 47),\n+        delete_range: None\n     }\n ]"}, {"sha": "5d2d018721143147ae93cda37805e1f544e523a9", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__return_type.snap", "status": "modified", "additions": 9, "deletions": 10, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__return_type.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__return_type.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__return_type.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.837692+00:00\n+Created: 2019-01-19T16:37:23.678426+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,9 +11,10 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [46; 60),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -23,13 +24,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [46; 60),\n-                insert: \"x()$0\"\n-            }\n+        insert_text: Some(\n+            \"x()$0\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [46; 60),\n+        delete_range: None\n     }\n ]"}, {"sha": "61ed4d0f2b0d9d7a91239ac4e6a90238ef370e29", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__self_in_methods.snap", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__self_in_methods.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__self_in_methods.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__self_in_methods.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T11:59:18.394156+00:00\n+Created: 2019-01-19T16:37:23.679470+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,8 +11,9 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [24; 26),\n+        delete_range: None\n     }\n ]"}, {"sha": "10ced4f288478a92b7aac53e956ef892fa3561d3", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__snippets_in_expressions.snap", "status": "modified", "additions": 11, "deletions": 15, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__snippets_in_expressions.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__snippets_in_expressions.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__snippets_in_expressions.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.844708+00:00\n+Created: 2019-01-19T16:37:23.681192+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,14 +11,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [16; 18),\n-                insert: \"eprintln!(\\\"$0 = {:?}\\\", $0);\"\n-            }\n+        insert_text: Some(\n+            \"eprintln!(\\\"$0 = {:?}\\\", $0);\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [16; 18),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Snippet,\n@@ -28,13 +26,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [16; 18),\n-                insert: \"eprintln!(\\\"$0 = {:#?}\\\", $0);\"\n-            }\n+        insert_text: Some(\n+            \"eprintln!(\\\"$0 = {:#?}\\\", $0);\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [16; 18),\n+        delete_range: None\n     }\n ]"}, {"sha": "5a87ae357d69be580b154a38f82be38a93cf3196", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__snippets_in_items.snap", "status": "modified", "additions": 11, "deletions": 15, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__snippets_in_items.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__snippets_in_items.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__snippets_in_items.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.845616+00:00\n+Created: 2019-01-19T16:37:23.682017+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -13,14 +13,12 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         lookup: Some(\n             \"tfn\"\n         ),\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [49; 79),\n-                insert: \"#[test]\\nfn ${1:feature}() {\\n    $0\\n}\"\n-            }\n+        insert_text: Some(\n+            \"#[test]\\nfn ${1:feature}() {\\n    $0\\n}\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [49; 79),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Snippet,\n@@ -30,13 +28,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [49; 79),\n-                insert: \"pub(crate) $0\"\n-            }\n+        insert_text: Some(\n+            \"pub(crate) $0\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [49; 79),\n+        delete_range: None\n     }\n ]"}, {"sha": "6208d04a489989235731f8864f2f186098f343d5", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__struct_field_completion.snap", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T11:34:11.702218+00:00\n+Created: 2019-01-19T16:37:23.628928+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -13,8 +13,9 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n             \"u32\"\n         ),\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [84; 85),\n+        delete_range: None\n     }\n ]"}, {"sha": "6de8ada5a4d3f5ebf2e048a5bf1b0ea05d6c65c5", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__struct_field_completion_autoderef.snap", "status": "modified", "additions": 9, "deletions": 10, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion_autoderef.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion_autoderef.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion_autoderef.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.817216+00:00\n+Created: 2019-01-19T16:37:23.629043+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -13,9 +13,10 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n             \"(u32, i32)\"\n         ),\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [125; 126),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -25,13 +26,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [125; 126),\n-                insert: \"foo($0)\"\n-            }\n+        insert_text: Some(\n+            \"foo($0)\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [125; 126),\n+        delete_range: None\n     }\n ]"}, {"sha": "3e5c4fca90a03aceca2937c937942bc449c871c6", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__struct_field_completion_self.snap", "status": "modified", "additions": 9, "deletions": 10, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion_self.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion_self.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion_self.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T13:42:17.817207+00:00\n+Created: 2019-01-19T16:37:23.629041+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -13,9 +13,10 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n             \"(u32,)\"\n         ),\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [120; 121),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -25,13 +26,11 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n-        insert_text_format: Snippet,\n-        text_edit: Some(\n-            AtomTextEdit {\n-                delete: [120; 121),\n-                insert: \"foo($0)\"\n-            }\n+        insert_text: Some(\n+            \"foo($0)\"\n         ),\n-        additional_text_edits: None\n+        insert_text_format: Snippet,\n+        replace_range: [120; 121),\n+        delete_range: None\n     }\n ]"}, {"sha": "bbec167d5db00caadf52dfa9c7ef3b91c6de6108", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__use_item_starting_with_crate.snap", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__use_item_starting_with_crate.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__use_item_starting_with_crate.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__use_item_starting_with_crate.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T11:53:16.799683+00:00\n+Created: 2019-01-19T16:37:23.667522+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,9 +11,10 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [11; 13),\n+        delete_range: None\n     },\n     CompletionItem {\n         completion_kind: Reference,\n@@ -23,8 +24,9 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [11; 13),\n+        delete_range: None\n     }\n ]"}, {"sha": "ed571c605d8e5034ab6f8619af9e79b8e3be57b5", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__use_item_starting_with_self.snap", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__use_item_starting_with_self.snap", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__use_item_starting_with_self.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__use_item_starting_with_self.snap?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -1,4 +1,4 @@\n-Created: 2019-01-19T11:53:16.799788+00:00\n+Created: 2019-01-19T16:37:23.669476+00:00\n Creator: insta@0.1.4\n Source: crates/ra_ide_api/src/completion/completion_item.rs\n \n@@ -11,8 +11,9 @@ Source: crates/ra_ide_api/src/completion/completion_item.rs\n         ),\n         detail: None,\n         lookup: None,\n+        insert_text: None,\n         insert_text_format: PlainText,\n-        text_edit: None,\n-        additional_text_edits: None\n+        replace_range: [24; 26),\n+        delete_range: None\n     }\n ]"}, {"sha": "54a977b7a241d77cae6a52fbebda1e064738c551", "filename": "crates/ra_lsp_server/src/conv.rs", "status": "modified", "additions": 13, "deletions": 7, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_lsp_server%2Fsrc%2Fconv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/94d96b60f334e662f516bd0f04cc4191d7a804e6/crates%2Fra_lsp_server%2Fsrc%2Fconv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fconv.rs?ref=94d96b60f334e662f516bd0f04cc4191d7a804e6", "patch": "@@ -13,6 +13,7 @@ use ra_syntax::{SyntaxKind, TextRange, TextUnit};\n use ra_text_edit::{AtomTextEdit, TextEdit};\n \n use crate::{req, server_world::ServerWorld, Result};\n+use ra_text_edit::TextEditBuilder;\n \n pub trait Conv {\n     type Output;\n@@ -78,19 +79,24 @@ impl ConvWith for CompletionItem {\n     type Ctx = LineIndex;\n     type Output = ::lsp_types::CompletionItem;\n \n-    fn conv_with(mut self, ctx: &LineIndex) -> ::lsp_types::CompletionItem {\n-        let text_edit = self.text_edit().map(|t| t.conv_with(ctx));\n-        let additonal_text_edit = self\n-            .take_additional_text_edits()\n-            .map(|it| it.conv_with(ctx));\n+    fn conv_with(self, ctx: &LineIndex) -> ::lsp_types::CompletionItem {\n+        let atom_text_edit = AtomTextEdit::replace(self.replace_range(), self.insert_text());\n+        let text_edit = (&atom_text_edit).conv_with(ctx);\n+        let additional_text_edits = if let Some(delete_range) = self.delete_range() {\n+            let mut builder = TextEditBuilder::default();\n+            builder.delete(delete_range);\n+            Some(builder.finish().conv_with(ctx))\n+        } else {\n+            None\n+        };\n \n         let mut res = lsp_types::CompletionItem {\n             label: self.label().to_string(),\n             detail: self.detail().map(|it| it.to_string()),\n             filter_text: Some(self.lookup().to_string()),\n             kind: self.kind().map(|it| it.conv()),\n-            text_edit,\n-            additional_text_edits: additonal_text_edit,\n+            text_edit: Some(text_edit),\n+            additional_text_edits,\n             ..Default::default()\n         };\n         res.insert_text_format = Some(match self.insert_text_format() {"}]}