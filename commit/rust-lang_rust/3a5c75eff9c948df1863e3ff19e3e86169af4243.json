{"sha": "3a5c75eff9c948df1863e3ff19e3e86169af4243", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNhNWM3NWVmZjljOTQ4ZGYxODYzZTNmZjE5ZTNlODYxNjlhZjQyNDM=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2012-01-31T00:29:13Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2012-01-31T00:29:13Z"}, "message": "Tidy up redundant code in configure relating to valopt and triples.", "tree": {"sha": "d6c2f4f33b625f6f9ecbfb1c39e75b432839a6c2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d6c2f4f33b625f6f9ecbfb1c39e75b432839a6c2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3a5c75eff9c948df1863e3ff19e3e86169af4243", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3a5c75eff9c948df1863e3ff19e3e86169af4243", "html_url": "https://github.com/rust-lang/rust/commit/3a5c75eff9c948df1863e3ff19e3e86169af4243", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3a5c75eff9c948df1863e3ff19e3e86169af4243/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fe745f1b5dd0d53c127b19608449506f91e94c21", "url": "https://api.github.com/repos/rust-lang/rust/commits/fe745f1b5dd0d53c127b19608449506f91e94c21", "html_url": "https://github.com/rust-lang/rust/commit/fe745f1b5dd0d53c127b19608449506f91e94c21"}], "stats": {"total": 26, "additions": 6, "deletions": 20}, "files": [{"sha": "9ec8f2e7bff9c2187a3e3aded3ad2a162f6cfb52", "filename": "configure", "status": "modified", "additions": 6, "deletions": 20, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/3a5c75eff9c948df1863e3ff19e3e86169af4243/configure", "raw_url": "https://github.com/rust-lang/rust/raw/3a5c75eff9c948df1863e3ff19e3e86169af4243/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=3a5c75eff9c948df1863e3ff19e3e86169af4243", "patch": "@@ -267,8 +267,8 @@ opt mingw-cross 0 \"cross-compile for win32 using mingw\"\n opt clang 0 \"prefer clang to gcc for building the runtime\"\n valopt prefix \"/usr/local\" \"set installation prefix\"\n valopt llvm-root \"\" \"set LLVM root\"\n-valopt host-triple \"$DEFAULT_HOST_TRIPLE\" \"primary LLVM host triple\"\n-valopt target-triples \"\" \"LLVM target triples (defaults to host if unset)\"\n+valopt host-triple \"${DEFAULT_HOST_TRIPLE}\" \"LLVM host triple\"\n+valopt target-triples \"${CFG_HOST_TRIPLE}\" \"LLVM target triples\"\n \n if [ $HELP -eq 1 ]\n then\n@@ -356,23 +356,10 @@ else\n     CFG_C_COMPILER=\"gcc\"\n fi\n \n-if [ -z \"$CFG_PREFIX\" ]\n-then\n-    CFG_PREFIX=/usr/local\n-fi\n-\n-if [ -z \"$CFG_HOST_TRIPLE\" ]\n-then\n-    CFG_HOST_TRIPLE=\"$DEFAULT_HOST_TRIPLE\"\n-fi\n-\n-if [ -z \"$CFG_TARGET_TRIPLES\" ]\n-then\n-    CFG_TARGET_TRIPLES=\"${CFG_HOST_TRIPLE}\"\n-else\n-    CFG_TARGET_TRIPLES=\"$(echo $CFG_TARGET_TRIPLES | tr ',' ' ')\"\n-fi\n+# a little post-processing of various config values\n \n+CFG_PREFIX=${CFG_PREFIX%/}\n+CFG_TARGET_TRIPLES=\"$(echo $CFG_TARGET_TRIPLES | tr ',' ' ')\"\n case $CFG_TARGET_TRIPLES in\n     (*$CFG_HOST_TRIPLE*) ;;\n     (*) err \"Host triple is not among the target triples.\" ;;\n@@ -628,10 +615,9 @@ putvar CFG_BUILD_DIR\n putvar CFG_OSTYPE\n putvar CFG_CPUTYPE\n putvar CFG_CONFIGURE_ARGS\n-putvar CFG_HOST_TRIPLE\n+putvar CFG_PREFIX\n putvar CFG_TARGET_TRIPLES\n putvar CFG_C_COMPILER\n-putvar CFG_PREFIX\n putvar CFG_LIBDIR\n \n # Setting this again because it may have been changed"}]}