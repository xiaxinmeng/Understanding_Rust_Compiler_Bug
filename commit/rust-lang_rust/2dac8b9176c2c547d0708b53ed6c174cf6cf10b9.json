{"sha": "2dac8b9176c2c547d0708b53ed6c174cf6cf10b9", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJkYWM4YjkxNzZjMmM1NDdkMDcwOGI1M2VkNmMxNzRjZjZjZjEwYjk=", "commit": {"author": {"name": "Tyler Mandry", "email": "tmandry@gmail.com", "date": "2019-10-15T23:07:55Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-10-15T23:07:55Z"}, "message": "Rollup merge of #65402 - michaelwoerister:pgo-troubleshooting-docs, r=alexcrichton\n\nAdd troubleshooting section to PGO chapter in rustc book.\n\n- Adds a note about using `-pgo-warn-missing-function` in order to spot mistakes in PGO setup.\n- Mentions cargo symbol name issue fixed in 1.39.\n\nNominating for backport.\n\nr? @alexcrichton", "tree": {"sha": "1944abcafaf893d07772f19f6d7d131a037c00f9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1944abcafaf893d07772f19f6d7d131a037c00f9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2dac8b9176c2c547d0708b53ed6c174cf6cf10b9", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdplFMCRBK7hj4Ov3rIwAAdHIIADjSBn/BASOFtR2D1MSDfq9m\n9Mj4Xr5MOsELhCKN9a0UMLnwC7vRAyDmqaRJ5q9dPR6xJL/nYqmUgEpcYXyKdOCB\n2MV8a+drvNo2nKMSCsAbWNRauIo+hSMLG25H57+7Mq2qCsZ7jSXnt0zdug+u6byy\n6ju7H1IwcADIfq0s/AQKnww4j5PG6ZFOK/fwhkz5KqA/an+Wt6tFvu0U4NhDN3AQ\ntiCXqHdGKJvAZDRASgeupQfFU0hB+Xn22hbBKtKgYJYv9mUu1O7LY3WK5n1wW93Y\nWk4don3T9UW95vcVVpWmpKKqVkfrcw5tfCw6yyXT4fy/Q6XZiF4e+WPvqZ5GJnU=\n=jcCF\n-----END PGP SIGNATURE-----\n", "payload": "tree 1944abcafaf893d07772f19f6d7d131a037c00f9\nparent bbcf66a4a177c1756d5b6845933e6cb06aa21b2c\nparent f81b1548ddf886449d8ea95f82b56274b60fbac7\nauthor Tyler Mandry <tmandry@gmail.com> 1571180875 -0700\ncommitter GitHub <noreply@github.com> 1571180875 -0700\n\nRollup merge of #65402 - michaelwoerister:pgo-troubleshooting-docs, r=alexcrichton\n\nAdd troubleshooting section to PGO chapter in rustc book.\n\n- Adds a note about using `-pgo-warn-missing-function` in order to spot mistakes in PGO setup.\n- Mentions cargo symbol name issue fixed in 1.39.\n\nNominating for backport.\n\nr? @alexcrichton\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2dac8b9176c2c547d0708b53ed6c174cf6cf10b9", "html_url": "https://github.com/rust-lang/rust/commit/2dac8b9176c2c547d0708b53ed6c174cf6cf10b9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2dac8b9176c2c547d0708b53ed6c174cf6cf10b9/comments", "author": {"login": "tmandry", "id": 2280544, "node_id": "MDQ6VXNlcjIyODA1NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2280544?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmandry", "html_url": "https://github.com/tmandry", "followers_url": "https://api.github.com/users/tmandry/followers", "following_url": "https://api.github.com/users/tmandry/following{/other_user}", "gists_url": "https://api.github.com/users/tmandry/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmandry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmandry/subscriptions", "organizations_url": "https://api.github.com/users/tmandry/orgs", "repos_url": "https://api.github.com/users/tmandry/repos", "events_url": "https://api.github.com/users/tmandry/events{/privacy}", "received_events_url": "https://api.github.com/users/tmandry/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bbcf66a4a177c1756d5b6845933e6cb06aa21b2c", "url": "https://api.github.com/repos/rust-lang/rust/commits/bbcf66a4a177c1756d5b6845933e6cb06aa21b2c", "html_url": "https://github.com/rust-lang/rust/commit/bbcf66a4a177c1756d5b6845933e6cb06aa21b2c"}, {"sha": "f81b1548ddf886449d8ea95f82b56274b60fbac7", "url": "https://api.github.com/repos/rust-lang/rust/commits/f81b1548ddf886449d8ea95f82b56274b60fbac7", "html_url": "https://github.com/rust-lang/rust/commit/f81b1548ddf886449d8ea95f82b56274b60fbac7"}], "stats": {"total": 11, "additions": 11, "deletions": 0}, "files": [{"sha": "d066f4a9cf59c1040c8691b803b3d650f399944c", "filename": "src/doc/rustc/src/profile-guided-optimization.md", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/2dac8b9176c2c547d0708b53ed6c174cf6cf10b9/src%2Fdoc%2Frustc%2Fsrc%2Fprofile-guided-optimization.md", "raw_url": "https://github.com/rust-lang/rust/raw/2dac8b9176c2c547d0708b53ed6c174cf6cf10b9/src%2Fdoc%2Frustc%2Fsrc%2Fprofile-guided-optimization.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Fprofile-guided-optimization.md?ref=2dac8b9176c2c547d0708b53ed6c174cf6cf10b9", "patch": "@@ -125,6 +125,17 @@ RUSTFLAGS=\"-Cprofile-use=/tmp/pgo-data/merged.profdata\" \\\n     cargo build --release --target=x86_64-unknown-linux-gnu\n ```\n \n+### Troubleshooting\n+\n+- It is recommended to pass `-Cllvm-args=-pgo-warn-missing-function` during the\n+  `-Cprofile-use` phase. LLVM by default does not warn if it cannot find\n+  profiling data for a given function. Enabling this warning will make it\n+  easier to spot errors in your setup.\n+\n+- There is a [known issue](https://github.com/rust-lang/cargo/issues/7416) in\n+  Cargo prior to version 1.39 that will prevent PGO from working correctly. Be\n+  sure to use Cargo 1.39 or newer when doing PGO.\n+\n ## Further Reading\n \n `rustc`'s PGO support relies entirely on LLVM's implementation of the feature"}]}