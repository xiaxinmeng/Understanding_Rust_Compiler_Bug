{"sha": "7734308f895eb415c92365fab883ecbb5419fb27", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc3MzQzMDhmODk1ZWI0MTVjOTIzNjVmYWI4ODNlY2JiNTQxOWZiMjc=", "commit": {"author": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2016-05-11T00:50:00Z"}, "committer": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2016-05-18T14:11:35Z"}, "message": "ignore dep-graph in resolve and lower_crate\n\nThis got removed at some point, it seems.", "tree": {"sha": "e6302b30871dcfd6db88322df013d54e5d2ee709", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e6302b30871dcfd6db88322df013d54e5d2ee709"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7734308f895eb415c92365fab883ecbb5419fb27", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7734308f895eb415c92365fab883ecbb5419fb27", "html_url": "https://github.com/rust-lang/rust/commit/7734308f895eb415c92365fab883ecbb5419fb27", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7734308f895eb415c92365fab883ecbb5419fb27/comments", "author": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b711734a5f7280cc3ceb99e09551a7b7691c7d0b", "url": "https://api.github.com/repos/rust-lang/rust/commits/b711734a5f7280cc3ceb99e09551a7b7691c7d0b", "html_url": "https://github.com/rust-lang/rust/commit/b711734a5f7280cc3ceb99e09551a7b7691c7d0b"}], "stats": {"total": 16, "additions": 13, "deletions": 3}, "files": [{"sha": "ba655b35eda151f75c209d3aa3323d8e3a922778", "filename": "src/librustc/hir/lowering.rs", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/7734308f895eb415c92365fab883ecbb5419fb27/src%2Flibrustc%2Fhir%2Flowering.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7734308f895eb415c92365fab883ecbb5419fb27/src%2Flibrustc%2Fhir%2Flowering.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fhir%2Flowering.rs?ref=7734308f895eb415c92365fab883ecbb5419fb27", "patch": "@@ -45,6 +45,7 @@ use hir::map::Definitions;\n use hir::map::definitions::DefPathData;\n use hir::def_id::{DefIndex, DefId};\n use hir::def::{Def, PathResolution};\n+use session::Session;\n \n use std::collections::BTreeMap;\n use std::iter;\n@@ -97,8 +98,16 @@ impl Resolver for DummyResolver {\n     }\n }\n \n-pub fn lower_crate(krate: &Crate, id_assigner: &NodeIdAssigner, resolver: &mut Resolver)\n+pub fn lower_crate(sess: &Session,\n+                   krate: &Crate,\n+                   id_assigner: &NodeIdAssigner,\n+                   resolver: &mut Resolver)\n                    -> hir::Crate {\n+    // We're constructing the HIR here; we don't care what we will\n+    // read, since we haven't even constructed the *input* to\n+    // incr. comp. yet.\n+    let _ignore = sess.dep_graph.in_ignore();\n+\n     LoweringContext {\n         crate_root: if std_inject::no_core(krate) {\n             None"}, {"sha": "1d60c2eb43788b3d52217cbd02a4e42aa6ead598", "filename": "src/librustc_driver/driver.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7734308f895eb415c92365fab883ecbb5419fb27/src%2Flibrustc_driver%2Fdriver.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7734308f895eb415c92365fab883ecbb5419fb27/src%2Flibrustc_driver%2Fdriver.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_driver%2Fdriver.rs?ref=7734308f895eb415c92365fab883ecbb5419fb27", "patch": "@@ -814,7 +814,7 @@ pub fn lower_and_resolve<'a>(sess: &Session,\n \n         // Lower ast -> hir.\n         let hir_forest = time(sess.time_passes(), \"lowering ast -> hir\", || {\n-            hir_map::Forest::new(lower_crate(krate, sess, &mut resolver), dep_graph)\n+            hir_map::Forest::new(lower_crate(sess, krate, sess, &mut resolver), dep_graph)\n         });\n \n         (ty::CrateAnalysis {"}, {"sha": "61ed88ec173d4e2c8445afd482b72ccfe870f643", "filename": "src/librustc_resolve/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/7734308f895eb415c92365fab883ecbb5419fb27/src%2Flibrustc_resolve%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7734308f895eb415c92365fab883ecbb5419fb27/src%2Flibrustc_resolve%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Flib.rs?ref=7734308f895eb415c92365fab883ecbb5419fb27", "patch": "@@ -3624,6 +3624,7 @@ pub fn resolve_crate<'a, 'b>(resolver: &'b mut Resolver<'a>, krate: &'b Crate) {\n     // reflects not just its contents but the results of name\n     // resolution on those contents. Hopefully we'll push this back at\n     // some point.\n+    let _ignore = resolver.session.dep_graph.in_ignore();\n \n     resolver.build_reduced_graph(krate);\n     resolve_imports::resolve_imports(resolver);"}, {"sha": "2754f77444c67544a24cb442d09e0828a3c39f98", "filename": "src/librustdoc/test.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7734308f895eb415c92365fab883ecbb5419fb27/src%2Flibrustdoc%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7734308f895eb415c92365fab883ecbb5419fb27/src%2Flibrustdoc%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Ftest.rs?ref=7734308f895eb415c92365fab883ecbb5419fb27", "patch": "@@ -101,7 +101,7 @@ pub fn run(input: &str,\n     let defs = hir_map::collect_definitions(&krate);\n \n     let mut dummy_resolver = DummyResolver;\n-    let krate = lower_crate(&krate, &sess, &mut dummy_resolver);\n+    let krate = lower_crate(&sess, &krate, &sess, &mut dummy_resolver);\n \n     let opts = scrape_test_config(&krate);\n "}]}