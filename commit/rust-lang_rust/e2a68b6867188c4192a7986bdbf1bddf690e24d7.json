{"sha": "e2a68b6867188c4192a7986bdbf1bddf690e24d7", "node_id": "MDY6Q29tbWl0NzI0NzEyOmUyYTY4YjY4NjcxODhjNDE5MmE3OTg2YmRiZjFiZGRmNjkwZTI0ZDc=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2013-11-01T16:16:11Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2013-11-01T16:16:11Z"}, "message": "Give test and main tasks better names\n\nTests now have the same name as the test that they're running (to allow for\neasier diagnosing of failure sources), and the main task is now specially named\n<main> instead of <unnamed>.\n\nCloses #10195\nCloses #10073", "tree": {"sha": "9e476e536d8087e5298c1d5f084e01da2d25d0e2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9e476e536d8087e5298c1d5f084e01da2d25d0e2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e2a68b6867188c4192a7986bdbf1bddf690e24d7", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e2a68b6867188c4192a7986bdbf1bddf690e24d7", "html_url": "https://github.com/rust-lang/rust/commit/e2a68b6867188c4192a7986bdbf1bddf690e24d7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e2a68b6867188c4192a7986bdbf1bddf690e24d7/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e976de32dc590f759e6c0c72d286844ca373e775", "url": "https://api.github.com/repos/rust-lang/rust/commits/e976de32dc590f759e6c0c72d286844ca373e775", "html_url": "https://github.com/rust-lang/rust/commit/e976de32dc590f759e6c0c72d286844ca373e775"}], "stats": {"total": 40, "additions": 40, "deletions": 0}, "files": [{"sha": "f262e6c60fb35c5e908269b4e022277541ff44e3", "filename": "src/libextra/test.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/e2a68b6867188c4192a7986bdbf1bddf690e24d7/src%2Flibextra%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e2a68b6867188c4192a7986bdbf1bddf690e24d7/src%2Flibextra%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibextra%2Ftest.rs?ref=e2a68b6867188c4192a7986bdbf1bddf690e24d7", "patch": "@@ -869,6 +869,10 @@ pub fn run_test(force_ignore: bool,\n         do task::spawn {\n             let mut task = task::task();\n             task.unlinked();\n+            task.name(match desc.name {\n+                DynTestName(ref name) => SendStrOwned(name.clone()),\n+                StaticTestName(name) => SendStrStatic(name),\n+            });\n             let result_future = task.future_result();\n             task.spawn(testfn_cell.take());\n "}, {"sha": "a5c0d3be044c95d7a55fd46aa1a3bff8d0f75197", "filename": "src/libstd/rt/mod.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/e2a68b6867188c4192a7986bdbf1bddf690e24d7/src%2Flibstd%2Frt%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e2a68b6867188c4192a7986bdbf1bddf690e24d7/src%2Flibstd%2Frt%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Frt%2Fmod.rs?ref=e2a68b6867188c4192a7986bdbf1bddf690e24d7", "patch": "@@ -68,6 +68,7 @@ use rt::sched::{Scheduler, Shutdown};\n use rt::sleeper_list::SleeperList;\n use rt::task::UnwindResult;\n use rt::task::{Task, SchedTask, GreenTask, Sched};\n+use send_str::SendStrStatic;\n use unstable::atomics::{AtomicInt, AtomicBool, SeqCst};\n use unstable::sync::UnsafeArc;\n use vec::{OwnedVector, MutableVector, ImmutableVector};\n@@ -373,6 +374,7 @@ fn run_(main: ~fn(), use_main_sched: bool) -> int {\n         // run the main task in one of our threads.\n \n         let mut main_task = ~Task::new_root(&mut scheds[0].stack_pool, None, main.take());\n+        main_task.name = Some(SendStrStatic(\"<main>\"));\n         main_task.death.on_exit = Some(on_exit.take());\n         let main_task_cell = Cell::new(main_task);\n \n@@ -410,6 +412,7 @@ fn run_(main: ~fn(), use_main_sched: bool) -> int {\n         let home = Sched(main_sched.make_handle());\n         let mut main_task = ~Task::new_root_homed(&mut main_sched.stack_pool, None,\n                                                   home, main.take());\n+        main_task.name = Some(SendStrStatic(\"<main>\"));\n         main_task.death.on_exit = Some(on_exit.take());\n         rtdebug!(\"bootstrapping main_task\");\n "}, {"sha": "ca219fe21837d5041200ee1ef83fd157537185bf", "filename": "src/test/run-fail/main-fail.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/e2a68b6867188c4192a7986bdbf1bddf690e24d7/src%2Ftest%2Frun-fail%2Fmain-fail.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e2a68b6867188c4192a7986bdbf1bddf690e24d7/src%2Ftest%2Frun-fail%2Fmain-fail.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-fail%2Fmain-fail.rs?ref=e2a68b6867188c4192a7986bdbf1bddf690e24d7", "patch": "@@ -0,0 +1,15 @@\n+// Copyright 2013 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// error-pattern:task '<main>' failed at\n+\n+fn main() {\n+    fail!()\n+}"}, {"sha": "ddd54f00159d0e2b2b28cc9ba417851188c32a84", "filename": "src/test/run-fail/test-fail.rs", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/e2a68b6867188c4192a7986bdbf1bddf690e24d7/src%2Ftest%2Frun-fail%2Ftest-fail.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e2a68b6867188c4192a7986bdbf1bddf690e24d7/src%2Ftest%2Frun-fail%2Ftest-fail.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-fail%2Ftest-fail.rs?ref=e2a68b6867188c4192a7986bdbf1bddf690e24d7", "patch": "@@ -0,0 +1,18 @@\n+// Copyright 2013 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// error-pattern:task 'test_foo' failed at\n+// compile-flags: --test\n+\n+#[test]\n+fn test_foo() {\n+    fail!()\n+}\n+"}]}