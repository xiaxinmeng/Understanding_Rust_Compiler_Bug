{"sha": "96334d0d7cc2901acc80a67ba454409dcd452a30", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk2MzM0ZDBkN2NjMjkwMWFjYzgwYTY3YmE0NTQ0MDlkY2Q0NTJhMzA=", "commit": {"author": {"name": "xiongmao86", "email": "xiongmao86dev@sina.com", "date": "2020-01-02T05:12:23Z"}, "committer": {"name": "xiongmao86", "email": "xiongmao86dev@sina.com", "date": "2020-01-12T11:54:17Z"}, "message": "Declare lint.", "tree": {"sha": "e468bc42c6a745e7f98013efa2b25a7efb786241", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e468bc42c6a745e7f98013efa2b25a7efb786241"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/96334d0d7cc2901acc80a67ba454409dcd452a30", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/96334d0d7cc2901acc80a67ba454409dcd452a30", "html_url": "https://github.com/rust-lang/rust/commit/96334d0d7cc2901acc80a67ba454409dcd452a30", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/96334d0d7cc2901acc80a67ba454409dcd452a30/comments", "author": {"login": "xiongmao86", "id": 1770218, "node_id": "MDQ6VXNlcjE3NzAyMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1770218?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xiongmao86", "html_url": "https://github.com/xiongmao86", "followers_url": "https://api.github.com/users/xiongmao86/followers", "following_url": "https://api.github.com/users/xiongmao86/following{/other_user}", "gists_url": "https://api.github.com/users/xiongmao86/gists{/gist_id}", "starred_url": "https://api.github.com/users/xiongmao86/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xiongmao86/subscriptions", "organizations_url": "https://api.github.com/users/xiongmao86/orgs", "repos_url": "https://api.github.com/users/xiongmao86/repos", "events_url": "https://api.github.com/users/xiongmao86/events{/privacy}", "received_events_url": "https://api.github.com/users/xiongmao86/received_events", "type": "User", "site_admin": false}, "committer": {"login": "xiongmao86", "id": 1770218, "node_id": "MDQ6VXNlcjE3NzAyMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1770218?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xiongmao86", "html_url": "https://github.com/xiongmao86", "followers_url": "https://api.github.com/users/xiongmao86/followers", "following_url": "https://api.github.com/users/xiongmao86/following{/other_user}", "gists_url": "https://api.github.com/users/xiongmao86/gists{/gist_id}", "starred_url": "https://api.github.com/users/xiongmao86/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xiongmao86/subscriptions", "organizations_url": "https://api.github.com/users/xiongmao86/orgs", "repos_url": "https://api.github.com/users/xiongmao86/repos", "events_url": "https://api.github.com/users/xiongmao86/events{/privacy}", "received_events_url": "https://api.github.com/users/xiongmao86/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3a788452e2d81273d9c3981e401019bf0f45d78d", "url": "https://api.github.com/repos/rust-lang/rust/commits/3a788452e2d81273d9c3981e401019bf0f45d78d", "html_url": "https://github.com/rust-lang/rust/commit/3a788452e2d81273d9c3981e401019bf0f45d78d"}], "stats": {"total": 46, "additions": 46, "deletions": 0}, "files": [{"sha": "11d745a4c23cf73edaef007f13cf223f5a865d88", "filename": "CHANGELOG.md", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/96334d0d7cc2901acc80a67ba454409dcd452a30/CHANGELOG.md", "raw_url": "https://github.com/rust-lang/rust/raw/96334d0d7cc2901acc80a67ba454409dcd452a30/CHANGELOG.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/CHANGELOG.md?ref=96334d0d7cc2901acc80a67ba454409dcd452a30", "patch": "@@ -1093,6 +1093,7 @@ Released 2018-09-13\n [`extend_from_slice`]: https://rust-lang.github.io/rust-clippy/master/index.html#extend_from_slice\n [`extra_unused_lifetimes`]: https://rust-lang.github.io/rust-clippy/master/index.html#extra_unused_lifetimes\n [`fallible_impl_from`]: https://rust-lang.github.io/rust-clippy/master/index.html#fallible_impl_from\n+[`filetype_is_file`]: https://rust-lang.github.io/rust-clippy/master/index.html#filetype_is_file\n [`filter_map`]: https://rust-lang.github.io/rust-clippy/master/index.html#filter_map\n [`filter_map_next`]: https://rust-lang.github.io/rust-clippy/master/index.html#filter_map_next\n [`filter_next`]: https://rust-lang.github.io/rust-clippy/master/index.html#filter_next"}, {"sha": "85cca4a77fe4339b80ee9a46d4d65b24249ae7e5", "filename": "clippy_lints/src/lib.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/96334d0d7cc2901acc80a67ba454409dcd452a30/clippy_lints%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/96334d0d7cc2901acc80a67ba454409dcd452a30/clippy_lints%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.rs?ref=96334d0d7cc2901acc80a67ba454409dcd452a30", "patch": "@@ -612,6 +612,7 @@ pub fn register_plugins(store: &mut lint::LintStore, sess: &Session, conf: &Conf\n         &methods::CLONE_ON_COPY,\n         &methods::CLONE_ON_REF_PTR,\n         &methods::EXPECT_FUN_CALL,\n+        &methods::FILETYPE_IS_FILE,\n         &methods::FILTER_MAP,\n         &methods::FILTER_MAP_NEXT,\n         &methods::FILTER_NEXT,\n@@ -1199,6 +1200,7 @@ pub fn register_plugins(store: &mut lint::LintStore, sess: &Session, conf: &Conf\n         LintId::of(&methods::CLONE_DOUBLE_REF),\n         LintId::of(&methods::CLONE_ON_COPY),\n         LintId::of(&methods::EXPECT_FUN_CALL),\n+        LintId::of(&methods::FILETYPE_IS_FILE),\n         LintId::of(&methods::FILTER_NEXT),\n         LintId::of(&methods::FLAT_MAP_IDENTITY),\n         LintId::of(&methods::INEFFICIENT_TO_STRING),\n@@ -1384,6 +1386,7 @@ pub fn register_plugins(store: &mut lint::LintStore, sess: &Session, conf: &Conf\n         LintId::of(&mem_replace::MEM_REPLACE_OPTION_WITH_NONE),\n         LintId::of(&mem_replace::MEM_REPLACE_WITH_DEFAULT),\n         LintId::of(&methods::CHARS_LAST_CMP),\n+        LintId::of(&methods::FILETYPE_IS_FILE),\n         LintId::of(&methods::INTO_ITER_ON_REF),\n         LintId::of(&methods::ITER_CLONED_COLLECT),\n         LintId::of(&methods::ITER_NTH_ZERO),"}, {"sha": "b5f68817c3582c78aeeabea65f7ef96b5f6582ee", "filename": "clippy_lints/src/methods/mod.rs", "status": "modified", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/96334d0d7cc2901acc80a67ba454409dcd452a30/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/96334d0d7cc2901acc80a67ba454409dcd452a30/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs?ref=96334d0d7cc2901acc80a67ba454409dcd452a30", "patch": "@@ -1130,6 +1130,40 @@ declare_clippy_lint! {\n     \"Check for offset calculations on raw pointers to zero-sized types\"\n }\n \n+declare_clippy_lint! {\n+    /// **What it does:** Checks for `FileType::is_file()`.\n+    ///\n+    /// **Why is this bad?** When people testing a file type with `FileType::is_file`\n+    /// they are testing whether a path is something they can get bytes from. But\n+    /// `is_file` doesn't cover special file types in unix-like systems. and not covering\n+    /// symlink in windows. Using `!FileType::is_dir()` is a better way to that intention.\n+    ///\n+    /// **Example:**\n+    ///\n+    /// ```rust,ignore\n+    /// let metadata = std::fs::metadata(\"foo.txt\")?;\n+    /// let filetype = metadata.file_type();\n+    ///\n+    /// if filetype.is_file() {\n+    ///     // read file\n+    /// }\n+    /// ```\n+    ///\n+    /// should be writing as:\n+    ///\n+    /// ```rust,ignore\n+    /// let metadata = std::fs::metadata(\"foo.txt\")?;\n+    /// let filetype = metadata.file_type();\n+    ///\n+    /// if !filetype.is_dir() {\n+    ///     // read file\n+    /// }\n+    /// ```\n+    pub FILETYPE_IS_FILE,\n+    style,\n+    \"`FileType::is_file` is not recommended to test for readable file type.\"\n+}\n+\n declare_lint_pass!(Methods => [\n     OPTION_UNWRAP_USED,\n     RESULT_UNWRAP_USED,\n@@ -1177,6 +1211,7 @@ declare_lint_pass!(Methods => [\n     UNINIT_ASSUMED_INIT,\n     MANUAL_SATURATING_ARITHMETIC,\n     ZST_OFFSET,\n+    FILETYPE_IS_FILE,\n ]);\n \n impl<'a, 'tcx> LateLintPass<'a, 'tcx> for Methods {"}, {"sha": "5dd82b66b8e8442eafc0b5b7c8435bd3b5ebf39b", "filename": "src/lintlist/mod.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/96334d0d7cc2901acc80a67ba454409dcd452a30/src%2Flintlist%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/96334d0d7cc2901acc80a67ba454409dcd452a30/src%2Flintlist%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flintlist%2Fmod.rs?ref=96334d0d7cc2901acc80a67ba454409dcd452a30", "patch": "@@ -560,6 +560,13 @@ pub const ALL_LINTS: [Lint; 346] = [\n         deprecation: None,\n         module: \"fallible_impl_from\",\n     },\n+    Lint {\n+        name: \"filetype_is_file\",\n+        group: \"style\",\n+        desc: \"`FileType::is_file` is not recommended to test for readable file type.\",\n+        deprecation: None,\n+        module: \"methods\",\n+    },\n     Lint {\n         name: \"filter_map\",\n         group: \"pedantic\","}]}