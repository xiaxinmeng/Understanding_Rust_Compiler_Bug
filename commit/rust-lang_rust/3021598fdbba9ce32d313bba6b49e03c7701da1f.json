{"sha": "3021598fdbba9ce32d313bba6b49e03c7701da1f", "node_id": "C_kwDOAAsO6NoAKDMwMjE1OThmZGJiYTljZTMyZDMxM2JiYTZiNDllMDNjNzcwMWRhMWY", "commit": {"author": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-10-12T04:03:59Z"}, "committer": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-10-12T04:04:55Z"}, "message": "Do not register placeholder region outlives when considering_regions is false", "tree": {"sha": "504eb3233a76d40be6c1cdccc85a847883a700f5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/504eb3233a76d40be6c1cdccc85a847883a700f5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3021598fdbba9ce32d313bba6b49e03c7701da1f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3021598fdbba9ce32d313bba6b49e03c7701da1f", "html_url": "https://github.com/rust-lang/rust/commit/3021598fdbba9ce32d313bba6b49e03c7701da1f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3021598fdbba9ce32d313bba6b49e03c7701da1f/comments", "author": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "db0597f5619d5ed93feca28e61226d3581cc7867", "url": "https://api.github.com/repos/rust-lang/rust/commits/db0597f5619d5ed93feca28e61226d3581cc7867", "html_url": "https://github.com/rust-lang/rust/commit/db0597f5619d5ed93feca28e61226d3581cc7867"}], "stats": {"total": 63, "additions": 62, "deletions": 1}, "files": [{"sha": "ee752a1c73dd5601aae7ab68a135bc18693d84ce", "filename": "compiler/rustc_trait_selection/src/traits/fulfill.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3021598fdbba9ce32d313bba6b49e03c7701da1f/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ffulfill.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3021598fdbba9ce32d313bba6b49e03c7701da1f/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ffulfill.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ffulfill.rs?ref=3021598fdbba9ce32d313bba6b49e03c7701da1f", "patch": "@@ -355,7 +355,7 @@ impl<'a, 'tcx> ObligationProcessor for FulfillProcessor<'a, 'tcx> {\n                 }\n \n                 ty::PredicateKind::RegionOutlives(data) => {\n-                    if infcx.considering_regions || data.has_placeholders() {\n+                    if infcx.considering_regions {\n                         infcx.region_outlives_predicate(&obligation.cause, Binder::dummy(data));\n                     }\n "}, {"sha": "2db7f8a354cf58479eae15f7c81282ef25a274fc", "filename": "src/test/ui/higher-rank-trait-bounds/issue-100689.rs", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/3021598fdbba9ce32d313bba6b49e03c7701da1f/src%2Ftest%2Fui%2Fhigher-rank-trait-bounds%2Fissue-100689.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3021598fdbba9ce32d313bba6b49e03c7701da1f/src%2Ftest%2Fui%2Fhigher-rank-trait-bounds%2Fissue-100689.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fhigher-rank-trait-bounds%2Fissue-100689.rs?ref=3021598fdbba9ce32d313bba6b49e03c7701da1f", "patch": "@@ -0,0 +1,29 @@\n+// check-pass\n+\n+struct Foo<'a> {\n+    foo: &'a mut usize,\n+}\n+\n+trait Bar<'a> {\n+    type FooRef<'b>\n+    where\n+        'a: 'b;\n+    fn uwu(foo: Foo<'a>, f: impl for<'b> FnMut(Self::FooRef<'b>));\n+}\n+impl<'a> Bar<'a> for () {\n+    type FooRef<'b>\n+    =\n+        &'b Foo<'a>\n+    where\n+        'a : 'b,\n+    ;\n+\n+    fn uwu(\n+        foo: Foo<'a>,\n+        mut f: impl for<'b> FnMut(&'b Foo<'a>), //relevant part\n+    ) {\n+        f(&foo);\n+    }\n+}\n+\n+fn main() {}"}, {"sha": "952b81584f30d9ce0bf24ead28e785d8716d2fed", "filename": "src/test/ui/higher-rank-trait-bounds/issue-102899.rs", "status": "added", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/3021598fdbba9ce32d313bba6b49e03c7701da1f/src%2Ftest%2Fui%2Fhigher-rank-trait-bounds%2Fissue-102899.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3021598fdbba9ce32d313bba6b49e03c7701da1f/src%2Ftest%2Fui%2Fhigher-rank-trait-bounds%2Fissue-102899.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fhigher-rank-trait-bounds%2Fissue-102899.rs?ref=3021598fdbba9ce32d313bba6b49e03c7701da1f", "patch": "@@ -0,0 +1,32 @@\n+// check-pass\n+\n+pub trait BufferTrait<'buffer> {\n+    type Subset<'channel>\n+    where\n+        'buffer: 'channel;\n+\n+    fn for_each_subset<F>(&self, f: F)\n+    where\n+        F: for<'channel> Fn(Self::Subset<'channel>);\n+}\n+\n+pub struct SomeBuffer<'buffer> {\n+    samples: &'buffer [()],\n+}\n+\n+impl<'buffer> BufferTrait<'buffer> for SomeBuffer<'buffer> {\n+    type Subset<'subset> = Subset<'subset> where 'buffer: 'subset;\n+\n+    fn for_each_subset<F>(&self, _f: F)\n+    where\n+        F: for<'subset> Fn(Subset<'subset>),\n+    {\n+        todo!()\n+    }\n+}\n+\n+pub struct Subset<'subset> {\n+    buffer: &'subset [()],\n+}\n+\n+fn main() {}"}]}