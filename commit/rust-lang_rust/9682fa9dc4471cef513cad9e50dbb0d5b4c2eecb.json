{"sha": "9682fa9dc4471cef513cad9e50dbb0d5b4c2eecb", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk2ODJmYTlkYzQ0NzFjZWY1MTNjYWQ5ZTUwZGJiMGQ1YjRjMmVlY2I=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-05-15T11:29:47Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-05-15T11:29:47Z"}, "message": "Rollup merge of #84461 - jyn514:remove-strip-item, r=GuillaumeGomez\n\nrustdoc: Remove unnecessary `StripItem` wrapper", "tree": {"sha": "5d4b8e90504b5f184eede7881a62b4de431eee4b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5d4b8e90504b5f184eede7881a62b4de431eee4b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9682fa9dc4471cef513cad9e50dbb0d5b4c2eecb", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgn7CrCRBK7hj4Ov3rIwAABrsIAFbUgV3I/U2dvHpDEQXx3VZZ\nozZM6mVhcsCysB49AuiTJRRGdPND1R/HDZONKI8Bp93Ly9cP5o95bS9UOVBz+fAk\nKAexPGtXdvfXgqvs9Fh4yJs/oWiFDt35To9RBhXdTnRSA2PiuEiSWC1l0CA2BH10\n92CntZGdI5d2a2oVIq2sUq48BPFN7YPfdF0QzrHgWjlhCoBWAiGq9RM39u8ct9q6\n8tJCI9IoUUXOoHAM27qY/fX/jsQrEmAMUF/ivbQNaesqxA4Qw+h7M5wHUGN/bB9A\nN0p3+TMdt+fG+FdSCj3RslpKrJAxkhy0oarFavRQD/1loljcYirfliUQV8CmP+w=\n=QAQL\n-----END PGP SIGNATURE-----\n", "payload": "tree 5d4b8e90504b5f184eede7881a62b4de431eee4b\nparent c6dd87a6b4a62cf5d2cb6207b1dcea652ea1aa60\nparent 0aa28446f8422ed03845b00074fd49eabc28c695\nauthor Guillaume Gomez <guillaume1.gomez@gmail.com> 1621078187 +0200\ncommitter GitHub <noreply@github.com> 1621078187 +0200\n\nRollup merge of #84461 - jyn514:remove-strip-item, r=GuillaumeGomez\n\nrustdoc: Remove unnecessary `StripItem` wrapper\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9682fa9dc4471cef513cad9e50dbb0d5b4c2eecb", "html_url": "https://github.com/rust-lang/rust/commit/9682fa9dc4471cef513cad9e50dbb0d5b4c2eecb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9682fa9dc4471cef513cad9e50dbb0d5b4c2eecb/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c6dd87a6b4a62cf5d2cb6207b1dcea652ea1aa60", "url": "https://api.github.com/repos/rust-lang/rust/commits/c6dd87a6b4a62cf5d2cb6207b1dcea652ea1aa60", "html_url": "https://github.com/rust-lang/rust/commit/c6dd87a6b4a62cf5d2cb6207b1dcea652ea1aa60"}, {"sha": "0aa28446f8422ed03845b00074fd49eabc28c695", "url": "https://api.github.com/repos/rust-lang/rust/commits/0aa28446f8422ed03845b00074fd49eabc28c695", "html_url": "https://github.com/rust-lang/rust/commit/0aa28446f8422ed03845b00074fd49eabc28c695"}], "stats": {"total": 25, "additions": 9, "deletions": 16}, "files": [{"sha": "723792381ef09df8d1820090f1a53a3bf4fada9b", "filename": "src/librustdoc/fold.rs", "status": "modified", "additions": 4, "deletions": 11, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/9682fa9dc4471cef513cad9e50dbb0d5b4c2eecb/src%2Flibrustdoc%2Ffold.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9682fa9dc4471cef513cad9e50dbb0d5b4c2eecb/src%2Flibrustdoc%2Ffold.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Ffold.rs?ref=9682fa9dc4471cef513cad9e50dbb0d5b4c2eecb", "patch": "@@ -1,17 +1,10 @@\n use crate::clean::*;\n \n-crate struct StripItem(pub Item);\n-\n-impl StripItem {\n-    crate fn strip(self) -> Item {\n-        match self.0 {\n-            Item { kind: box StrippedItem(..), .. } => self.0,\n-            mut i => {\n-                i.kind = box StrippedItem(i.kind);\n-                i\n-            }\n-        }\n+crate fn strip_item(mut item: Item) -> Item {\n+    if !matches!(*item.kind, StrippedItem(..)) {\n+        item.kind = box StrippedItem(item.kind);\n     }\n+    item\n }\n \n crate trait DocFolder: Sized {"}, {"sha": "87573e8e037a96c22d546d48647b19c735d65727", "filename": "src/librustdoc/passes/strip_hidden.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9682fa9dc4471cef513cad9e50dbb0d5b4c2eecb/src%2Flibrustdoc%2Fpasses%2Fstrip_hidden.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9682fa9dc4471cef513cad9e50dbb0d5b4c2eecb/src%2Flibrustdoc%2Fpasses%2Fstrip_hidden.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fstrip_hidden.rs?ref=9682fa9dc4471cef513cad9e50dbb0d5b4c2eecb", "patch": "@@ -4,7 +4,7 @@ use std::mem;\n use crate::clean;\n use crate::clean::{FakeDefIdSet, Item, NestedAttributesExt};\n use crate::core::DocContext;\n-use crate::fold::{DocFolder, StripItem};\n+use crate::fold::{strip_item, DocFolder};\n use crate::passes::{ImplStripper, Pass};\n \n crate const STRIP_HIDDEN: Pass = Pass {\n@@ -44,7 +44,7 @@ impl<'a> DocFolder for Stripper<'a> {\n                     // strip things like impl methods but when doing so\n                     // we must not add any items to the `retained` set.\n                     let old = mem::replace(&mut self.update_retained, false);\n-                    let ret = StripItem(self.fold_item_recur(i)).strip();\n+                    let ret = strip_item(self.fold_item_recur(i));\n                     self.update_retained = old;\n                     return Some(ret);\n                 }"}, {"sha": "528518410aa0680a7c0dc24cd7e2cfba1b891b22", "filename": "src/librustdoc/passes/stripper.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/9682fa9dc4471cef513cad9e50dbb0d5b4c2eecb/src%2Flibrustdoc%2Fpasses%2Fstripper.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9682fa9dc4471cef513cad9e50dbb0d5b4c2eecb/src%2Flibrustdoc%2Fpasses%2Fstripper.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fstripper.rs?ref=9682fa9dc4471cef513cad9e50dbb0d5b4c2eecb", "patch": "@@ -3,7 +3,7 @@ use rustc_middle::middle::privacy::AccessLevels;\n use std::mem;\n \n use crate::clean::{self, FakeDefIdSet, GetDefId, Item};\n-use crate::fold::{DocFolder, StripItem};\n+use crate::fold::{strip_item, DocFolder};\n \n crate struct Stripper<'a> {\n     crate retained: &'a mut FakeDefIdSet,\n@@ -51,15 +51,15 @@ impl<'a> DocFolder for Stripper<'a> {\n \n             clean::StructFieldItem(..) => {\n                 if !i.visibility.is_public() {\n-                    return Some(StripItem(i).strip());\n+                    return Some(strip_item(i));\n                 }\n             }\n \n             clean::ModuleItem(..) => {\n                 if i.def_id.is_local() && !i.visibility.is_public() {\n                     debug!(\"Stripper: stripping module {:?}\", i.name);\n                     let old = mem::replace(&mut self.update_retained, false);\n-                    let ret = StripItem(self.fold_item_recur(i)).strip();\n+                    let ret = strip_item(self.fold_item_recur(i));\n                     self.update_retained = old;\n                     return Some(ret);\n                 }"}]}