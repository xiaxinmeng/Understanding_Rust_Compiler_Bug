{"sha": "360d6e4b7ddcfbb203dced9883532bc4f39137e0", "node_id": "C_kwDOAAsO6NoAKDM2MGQ2ZTRiN2RkY2ZiYjIwM2RjZWQ5ODgzNTMyYmM0ZjM5MTM3ZTA", "commit": {"author": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2022-05-09T18:46:24Z"}, "committer": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2022-05-09T18:49:05Z"}, "message": "rustdoc: search result ranking fix", "tree": {"sha": "ec34dc7e9394ae28343e96097476d054d6c46660", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ec34dc7e9394ae28343e96097476d054d6c46660"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/360d6e4b7ddcfbb203dced9883532bc4f39137e0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/360d6e4b7ddcfbb203dced9883532bc4f39137e0", "html_url": "https://github.com/rust-lang/rust/commit/360d6e4b7ddcfbb203dced9883532bc4f39137e0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/360d6e4b7ddcfbb203dced9883532bc4f39137e0/comments", "author": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "committer": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0e345b76a5550d82caff5540649ee0ba6e3b4f3f", "url": "https://api.github.com/repos/rust-lang/rust/commits/0e345b76a5550d82caff5540649ee0ba6e3b4f3f", "html_url": "https://github.com/rust-lang/rust/commit/0e345b76a5550d82caff5540649ee0ba6e3b4f3f"}], "stats": {"total": 25, "additions": 24, "deletions": 1}, "files": [{"sha": "5a2ca145ac798060d0f26bce88f0328ef18487f8", "filename": "src/librustdoc/html/static/js/search.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/360d6e4b7ddcfbb203dced9883532bc4f39137e0/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsearch.js", "raw_url": "https://github.com/rust-lang/rust/raw/360d6e4b7ddcfbb203dced9883532bc4f39137e0/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsearch.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsearch.js?ref=360d6e4b7ddcfbb203dced9883532bc4f39137e0", "patch": "@@ -1323,7 +1323,6 @@ window.initSearch = rawSearchIndex => {\n                 }\n             }\n             lev = levenshtein(searchWord, elem.pathLast);\n-            lev += lev_add;\n             if (lev > 0 && elem.pathLast.length > 2 && searchWord.indexOf(elem.pathLast) > -1)\n             {\n                 if (elem.pathLast.length < 6) {\n@@ -1332,6 +1331,7 @@ window.initSearch = rawSearchIndex => {\n                     lev = 0;\n                 }\n             }\n+            lev += lev_add;\n             if (lev > MAX_LEV_DISTANCE) {\n                 return;\n             } else if (index !== -1 && elem.fullPath.length < 2) {"}, {"sha": "4aee569b0f481c4ee6791cb5ac800bad4991182f", "filename": "src/test/rustdoc-js/path-ordering.js", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/360d6e4b7ddcfbb203dced9883532bc4f39137e0/src%2Ftest%2Frustdoc-js%2Fpath-ordering.js", "raw_url": "https://github.com/rust-lang/rust/raw/360d6e4b7ddcfbb203dced9883532bc4f39137e0/src%2Ftest%2Frustdoc-js%2Fpath-ordering.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-js%2Fpath-ordering.js?ref=360d6e4b7ddcfbb203dced9883532bc4f39137e0", "patch": "@@ -0,0 +1,14 @@\n+// exact-check\n+\n+const QUERY = 'b::ccccccc';\n+\n+const EXPECTED = {\n+    'others': [\n+        // `ccccccc` is an exact match for all three of these.\n+        // However `b` is a closer match for `bb` than for any\n+        // of the others, so it ought to go first.\n+        { 'path': 'path_ordering::bb', 'name': 'Ccccccc' },\n+        { 'path': 'path_ordering::aa', 'name': 'Ccccccc' },\n+        { 'path': 'path_ordering::dd', 'name': 'Ccccccc' },\n+    ],\n+};"}, {"sha": "7843cf7f9dc489a0830fec7decb6288f7ea637c6", "filename": "src/test/rustdoc-js/path-ordering.rs", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/360d6e4b7ddcfbb203dced9883532bc4f39137e0/src%2Ftest%2Frustdoc-js%2Fpath-ordering.rs", "raw_url": "https://github.com/rust-lang/rust/raw/360d6e4b7ddcfbb203dced9883532bc4f39137e0/src%2Ftest%2Frustdoc-js%2Fpath-ordering.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-js%2Fpath-ordering.rs?ref=360d6e4b7ddcfbb203dced9883532bc4f39137e0", "patch": "@@ -0,0 +1,9 @@\n+pub mod dd {\n+    pub struct Ccccccc;\n+}\n+pub mod aa {\n+    pub struct Ccccccc;\n+}\n+pub mod bb {\n+    pub struct Ccccccc;\n+}"}]}