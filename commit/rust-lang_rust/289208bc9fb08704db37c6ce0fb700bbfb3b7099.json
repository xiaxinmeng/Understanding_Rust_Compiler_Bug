{"sha": "289208bc9fb08704db37c6ce0fb700bbfb3b7099", "node_id": "C_kwDOAAsO6NoAKDI4OTIwOGJjOWZiMDg3MDRkYjM3YzZjZTBmYjcwMGJiZmIzYjcwOTk", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2023-02-25T16:10:58Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2023-02-25T16:10:58Z"}, "message": "Auto merge of #14203 - shilangyu:fix/angled-path-segments, r=lnicola\n\nfix: Add check for extra path segments after a fully qualified one\n\n`type A = <()>;` is parsed just fine by rust-analyzer, but then rejected by rustc:\n\n```\nerror: expected `::`, found `;`\n --> x.rs:7:14\n  |\n7 | type A = <()>;\n  |              ^ expected `::`\n\n```\n\nFixed by adding a lookahead for the `::` token after fully-qualified path segments.", "tree": {"sha": "82cd1eeaa269a027b8193517948fa66e2685ee2c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/82cd1eeaa269a027b8193517948fa66e2685ee2c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/289208bc9fb08704db37c6ce0fb700bbfb3b7099", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/289208bc9fb08704db37c6ce0fb700bbfb3b7099", "html_url": "https://github.com/rust-lang/rust/commit/289208bc9fb08704db37c6ce0fb700bbfb3b7099", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/289208bc9fb08704db37c6ce0fb700bbfb3b7099/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9a4efb4cc3f6516d27c246bdb414e99bb916b554", "url": "https://api.github.com/repos/rust-lang/rust/commits/9a4efb4cc3f6516d27c246bdb414e99bb916b554", "html_url": "https://github.com/rust-lang/rust/commit/9a4efb4cc3f6516d27c246bdb414e99bb916b554"}, {"sha": "44e47fe4083adbd35889da7a6489ec3252a4f04b", "url": "https://api.github.com/repos/rust-lang/rust/commits/44e47fe4083adbd35889da7a6489ec3252a4f04b", "html_url": "https://github.com/rust-lang/rust/commit/44e47fe4083adbd35889da7a6489ec3252a4f04b"}], "stats": {"total": 58, "additions": 58, "deletions": 0}, "files": [{"sha": "b663a2917897ea068f92d84451b80e3aefcbedfb", "filename": "crates/hir-def/src/macro_expansion_tests/mbe/regression.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/289208bc9fb08704db37c6ce0fb700bbfb3b7099/crates%2Fhir-def%2Fsrc%2Fmacro_expansion_tests%2Fmbe%2Fregression.rs", "raw_url": "https://github.com/rust-lang/rust/raw/289208bc9fb08704db37c6ce0fb700bbfb3b7099/crates%2Fhir-def%2Fsrc%2Fmacro_expansion_tests%2Fmbe%2Fregression.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir-def%2Fsrc%2Fmacro_expansion_tests%2Fmbe%2Fregression.rs?ref=289208bc9fb08704db37c6ce0fb700bbfb3b7099", "patch": "@@ -827,6 +827,7 @@ macro_rules! rgb_color {\n /* parse error: expected type */\n /* parse error: expected R_PAREN */\n /* parse error: expected R_ANGLE */\n+/* parse error: expected `::` */\n /* parse error: expected COMMA */\n /* parse error: expected R_ANGLE */\n /* parse error: expected SEMICOLON */"}, {"sha": "26490aa97e0a0a2e46829c1590fb6d63e104adbe", "filename": "crates/parser/src/grammar/paths.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/289208bc9fb08704db37c6ce0fb700bbfb3b7099/crates%2Fparser%2Fsrc%2Fgrammar%2Fpaths.rs", "raw_url": "https://github.com/rust-lang/rust/raw/289208bc9fb08704db37c6ce0fb700bbfb3b7099/crates%2Fparser%2Fsrc%2Fgrammar%2Fpaths.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Fsrc%2Fgrammar%2Fpaths.rs?ref=289208bc9fb08704db37c6ce0fb700bbfb3b7099", "patch": "@@ -77,6 +77,9 @@ fn path_segment(p: &mut Parser<'_>, mode: Mode, first: bool) {\n     // type X = <A as B>::Output;\n     // fn foo() { <usize as Default>::default(); }\n     if first && p.eat(T![<]) {\n+        // test_err angled_path_without_qual\n+        // type X = <()>;\n+        // type Y = <A as B>;\n         types::type_(p);\n         if p.eat(T![as]) {\n             if is_use_path_start(p) {\n@@ -86,6 +89,9 @@ fn path_segment(p: &mut Parser<'_>, mode: Mode, first: bool) {\n             }\n         }\n         p.expect(T![>]);\n+        if !p.at(T![::]) {\n+            p.error(\"expected `::`\");\n+        }\n     } else {\n         let empty = if first {\n             p.eat(T![::]);"}, {"sha": "0529e9750e7f03af3221382ba6009cf480b9a72c", "filename": "crates/parser/test_data/parser/inline/err/0016_angled_path_without_qual.rast", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/rust-lang/rust/blob/289208bc9fb08704db37c6ce0fb700bbfb3b7099/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0016_angled_path_without_qual.rast", "raw_url": "https://github.com/rust-lang/rust/raw/289208bc9fb08704db37c6ce0fb700bbfb3b7099/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0016_angled_path_without_qual.rast", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0016_angled_path_without_qual.rast?ref=289208bc9fb08704db37c6ce0fb700bbfb3b7099", "patch": "@@ -0,0 +1,49 @@\n+SOURCE_FILE\n+  TYPE_ALIAS\n+    TYPE_KW \"type\"\n+    WHITESPACE \" \"\n+    NAME\n+      IDENT \"X\"\n+    WHITESPACE \" \"\n+    EQ \"=\"\n+    WHITESPACE \" \"\n+    PATH_TYPE\n+      PATH\n+        PATH_SEGMENT\n+          L_ANGLE \"<\"\n+          TUPLE_TYPE\n+            L_PAREN \"(\"\n+            R_PAREN \")\"\n+          R_ANGLE \">\"\n+    SEMICOLON \";\"\n+  WHITESPACE \"\\n\"\n+  TYPE_ALIAS\n+    TYPE_KW \"type\"\n+    WHITESPACE \" \"\n+    NAME\n+      IDENT \"Y\"\n+    WHITESPACE \" \"\n+    EQ \"=\"\n+    WHITESPACE \" \"\n+    PATH_TYPE\n+      PATH\n+        PATH_SEGMENT\n+          L_ANGLE \"<\"\n+          PATH_TYPE\n+            PATH\n+              PATH_SEGMENT\n+                NAME_REF\n+                  IDENT \"A\"\n+          WHITESPACE \" \"\n+          AS_KW \"as\"\n+          WHITESPACE \" \"\n+          PATH_TYPE\n+            PATH\n+              PATH_SEGMENT\n+                NAME_REF\n+                  IDENT \"B\"\n+          R_ANGLE \">\"\n+    SEMICOLON \";\"\n+  WHITESPACE \"\\n\"\n+error 13: expected `::`\n+error 32: expected `::`"}, {"sha": "802d6cc14a49aa41bf331cb62444803ae3229495", "filename": "crates/parser/test_data/parser/inline/err/0016_angled_path_without_qual.rs", "status": "added", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/289208bc9fb08704db37c6ce0fb700bbfb3b7099/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0016_angled_path_without_qual.rs", "raw_url": "https://github.com/rust-lang/rust/raw/289208bc9fb08704db37c6ce0fb700bbfb3b7099/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0016_angled_path_without_qual.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Ftest_data%2Fparser%2Finline%2Ferr%2F0016_angled_path_without_qual.rs?ref=289208bc9fb08704db37c6ce0fb700bbfb3b7099", "patch": "@@ -0,0 +1,2 @@\n+type X = <()>;\n+type Y = <A as B>;"}]}