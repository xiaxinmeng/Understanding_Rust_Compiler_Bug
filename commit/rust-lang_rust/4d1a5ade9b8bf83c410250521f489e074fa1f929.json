{"sha": "4d1a5ade9b8bf83c410250521f489e074fa1f929", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRkMWE1YWRlOWI4YmY4M2M0MTAyNTA1MjFmNDg5ZTA3NGZhMWY5Mjk=", "commit": {"author": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2019-08-27T09:45:03Z"}, "committer": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2019-10-13T12:35:14Z"}, "message": "Introduce FuncId backend type", "tree": {"sha": "07f76fa6b1673399495b8bb5be173f12e7c77e57", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/07f76fa6b1673399495b8bb5be173f12e7c77e57"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4d1a5ade9b8bf83c410250521f489e074fa1f929", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4d1a5ade9b8bf83c410250521f489e074fa1f929", "html_url": "https://github.com/rust-lang/rust/commit/4d1a5ade9b8bf83c410250521f489e074fa1f929", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4d1a5ade9b8bf83c410250521f489e074fa1f929/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "29b6e0f0a1d1a37f8dc729484a64e59bf0b9a0a3", "url": "https://api.github.com/repos/rust-lang/rust/commits/29b6e0f0a1d1a37f8dc729484a64e59bf0b9a0a3", "html_url": "https://github.com/rust-lang/rust/commit/29b6e0f0a1d1a37f8dc729484a64e59bf0b9a0a3"}], "stats": {"total": 26, "additions": 16, "deletions": 10}, "files": [{"sha": "a2cbfdfe827cfdeba2b377c3b7cbf4aa8ef64341", "filename": "src/librustc_codegen_llvm/builder.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_llvm%2Fbuilder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_llvm%2Fbuilder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Fbuilder.rs?ref=4d1a5ade9b8bf83c410250521f489e074fa1f929", "patch": "@@ -52,6 +52,7 @@ const UNNAMED: *const c_char = EMPTY_C_STR.as_ptr();\n \n impl BackendTypes for Builder<'_, 'll, 'tcx> {\n     type Value = <CodegenCx<'ll, 'tcx> as BackendTypes>::Value;\n+    type FuncId = <CodegenCx<'ll, 'tcx> as BackendTypes>::FuncId;\n     type BasicBlock = <CodegenCx<'ll, 'tcx> as BackendTypes>::BasicBlock;\n     type Type = <CodegenCx<'ll, 'tcx> as BackendTypes>::Type;\n     type Funclet = <CodegenCx<'ll, 'tcx> as BackendTypes>::Funclet;"}, {"sha": "d1a7b4dd6bf75684522ebf733855ba9c8e8a933a", "filename": "src/librustc_codegen_llvm/common.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_llvm%2Fcommon.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_llvm%2Fcommon.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Fcommon.rs?ref=4d1a5ade9b8bf83c410250521f489e074fa1f929", "patch": "@@ -86,6 +86,8 @@ impl Funclet<'ll> {\n \n impl BackendTypes for CodegenCx<'ll, 'tcx> {\n     type Value = &'ll Value;\n+    type FuncId = &'ll Value;\n+\n     type BasicBlock = &'ll BasicBlock;\n     type Type = &'ll Type;\n     type Funclet = Funclet<'ll>;"}, {"sha": "890b8325fd9c997e370a420d38df07e80441c795", "filename": "src/librustc_codegen_ssa/README.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_ssa%2FREADME.md", "raw_url": "https://github.com/rust-lang/rust/raw/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_ssa%2FREADME.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2FREADME.md?ref=4d1a5ade9b8bf83c410250521f489e074fa1f929", "patch": "@@ -84,7 +84,7 @@ pub trait BuilderMethods<'a, 'tcx>:\n {\n     fn new_block<'b>(\n         cx: &'a Self::CodegenCx,\n-        llfn: Self::Value,\n+        llfn: Self::FuncId,\n         name: &'b str\n     ) -> Self;\n     /* ... */"}, {"sha": "50a245f67113fb1bc352e90dcc80b74abc209b16", "filename": "src/librustc_codegen_ssa/mir/mod.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_ssa%2Fmir%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_ssa%2Fmir%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Fmir%2Fmod.rs?ref=4d1a5ade9b8bf83c410250521f489e074fa1f929", "patch": "@@ -30,7 +30,7 @@ pub struct FunctionCx<'a, 'tcx, Bx: BuilderMethods<'a, 'tcx>> {\n \n     debug_context: FunctionDebugContext<Bx::DIScope>,\n \n-    llfn: Bx::Value,\n+    llfn: Bx::FuncId,\n \n     cx: &'a Bx::CodegenCx,\n \n@@ -183,7 +183,7 @@ impl<'a, 'tcx, V: CodegenObject> LocalRef<'tcx, V> {\n \n pub fn codegen_mir<'a, 'tcx, Bx: BuilderMethods<'a, 'tcx>>(\n     cx: &'a Bx::CodegenCx,\n-    llfn: Bx::Value,\n+    llfn: Bx::FuncId,\n     mir: &'a Body<'tcx>,\n     instance: Instance<'tcx>,\n     sig: ty::FnSig<'tcx>,"}, {"sha": "499deaa0fb0c615e228fef39ae441086d69a0864", "filename": "src/librustc_codegen_ssa/traits/backend.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_ssa%2Ftraits%2Fbackend.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_ssa%2Ftraits%2Fbackend.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Ftraits%2Fbackend.rs?ref=4d1a5ade9b8bf83c410250521f489e074fa1f929", "patch": "@@ -14,6 +14,8 @@ use syntax_pos::symbol::InternedString;\n \n pub trait BackendTypes {\n     type Value: CodegenObject;\n+    type FuncId: CodegenObject;\n+\n     type BasicBlock: Copy;\n     type Type: CodegenObject;\n     type Funclet;"}, {"sha": "b252b20f2295e430314e2a652235183e9da2313d", "filename": "src/librustc_codegen_ssa/traits/builder.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_ssa%2Ftraits%2Fbuilder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_ssa%2Ftraits%2Fbuilder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Ftraits%2Fbuilder.rs?ref=4d1a5ade9b8bf83c410250521f489e074fa1f929", "patch": "@@ -34,7 +34,7 @@ pub trait BuilderMethods<'a, 'tcx>:\n     + HasTargetSpec\n \n {\n-    fn new_block<'b>(cx: &'a Self::CodegenCx, llfn: Self::Value, name: &'b str) -> Self;\n+    fn new_block<'b>(cx: &'a Self::CodegenCx, llfn: Self::FuncId, name: &'b str) -> Self;\n     fn with_cx(cx: &'a Self::CodegenCx) -> Self;\n     fn build_sibling_block(&self, name: &str) -> Self;\n     fn cx(&self) -> &Self::CodegenCx;"}, {"sha": "71594240a9eafeeef8d222b897cc685ec5e73880", "filename": "src/librustc_codegen_ssa/traits/debuginfo.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_ssa%2Ftraits%2Fdebuginfo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_ssa%2Ftraits%2Fdebuginfo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Ftraits%2Fdebuginfo.rs?ref=4d1a5ade9b8bf83c410250521f489e074fa1f929", "patch": "@@ -20,7 +20,7 @@ pub trait DebugInfoMethods<'tcx>: BackendTypes {\n         &self,\n         instance: Instance<'tcx>,\n         sig: ty::FnSig<'tcx>,\n-        llfn: Self::Value,\n+        llfn: Self::FuncId,\n         mir: &mir::Body<'_>,\n     ) -> FunctionDebugContext<Self::DIScope>;\n "}, {"sha": "c087e64feab3fb0c3be352e582216f9d0d2cfb1d", "filename": "src/librustc_codegen_ssa/traits/declare.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_ssa%2Ftraits%2Fdeclare.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_ssa%2Ftraits%2Fdeclare.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Ftraits%2Fdeclare.rs?ref=4d1a5ade9b8bf83c410250521f489e074fa1f929", "patch": "@@ -17,13 +17,13 @@ pub trait DeclareMethods<'tcx>: BackendTypes {\n     ///\n     /// If there\u2019s a value with the same name already declared, the function will\n     /// update the declaration and return existing Value instead.\n-    fn declare_cfn(&self, name: &str, fn_type: Self::Type) -> Self::Value;\n+    fn declare_cfn(&self, name: &str, fn_type: Self::Type) -> Self::FuncId;\n \n     /// Declare a Rust function.\n     ///\n     /// If there\u2019s a value with the same name already declared, the function will\n     /// update the declaration and return existing Value instead.\n-    fn declare_fn(&self, name: &str, sig: ty::PolyFnSig<'tcx>) -> Self::Value;\n+    fn declare_fn(&self, name: &str, sig: ty::PolyFnSig<'tcx>) -> Self::FuncId;\n \n     /// Declare a global with an intention to define it.\n     ///"}, {"sha": "83435edb98f7aab00ffc6366c9d947867c8eece6", "filename": "src/librustc_codegen_ssa/traits/misc.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_ssa%2Ftraits%2Fmisc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_ssa%2Ftraits%2Fmisc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Ftraits%2Fmisc.rs?ref=4d1a5ade9b8bf83c410250521f489e074fa1f929", "patch": "@@ -11,14 +11,14 @@ pub trait MiscMethods<'tcx>: BackendTypes {\n         &self,\n     ) -> &RefCell<FxHashMap<(Ty<'tcx>, Option<ty::PolyExistentialTraitRef<'tcx>>), Self::Value>>;\n     fn check_overflow(&self) -> bool;\n-    fn instances(&self) -> &RefCell<FxHashMap<Instance<'tcx>, Self::Value>>;\n+    fn instances(&self) -> &RefCell<FxHashMap<Instance<'tcx>, Self::FuncId>>;\n     fn get_fn(&self, instance: Instance<'tcx>) -> Self::Value;\n     fn eh_personality(&self) -> Self::Value;\n     fn eh_unwind_resume(&self) -> Self::Value;\n     fn sess(&self) -> &Session;\n     fn codegen_unit(&self) -> &Arc<CodegenUnit<'tcx>>;\n     fn used_statics(&self) -> &RefCell<Vec<Self::Value>>;\n-    fn set_frame_pointer_elimination(&self, llfn: Self::Value);\n-    fn apply_target_cpu_attr(&self, llfn: Self::Value);\n+    fn set_frame_pointer_elimination(&self, llfn: Self::FuncId);\n+    fn apply_target_cpu_attr(&self, llfn: Self::FuncId);\n     fn create_used_variable(&self);\n }"}, {"sha": "22a544c032417545ab1c91d24f199e6b82693290", "filename": "src/librustc_codegen_ssa/traits/mod.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_ssa%2Ftraits%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4d1a5ade9b8bf83c410250521f489e074fa1f929/src%2Flibrustc_codegen_ssa%2Ftraits%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Ftraits%2Fmod.rs?ref=4d1a5ade9b8bf83c410250521f489e074fa1f929", "patch": "@@ -88,6 +88,7 @@ pub trait HasCodegen<'tcx>:\n     type CodegenCx: CodegenMethods<'tcx>\n         + BackendTypes<\n             Value = Self::Value,\n+            FuncId = Self::FuncId,\n             BasicBlock = Self::BasicBlock,\n             Type = Self::Type,\n             Funclet = Self::Funclet,"}]}