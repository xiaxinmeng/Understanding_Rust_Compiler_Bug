{"sha": "05bf105c90e7f0dee866fb15f6616afe25fe209f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA1YmYxMDVjOTBlN2YwZGVlODY2ZmIxNWY2NjE2YWZlMjVmZTIwOWY=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-12-20T03:50:52Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-12-20T06:05:40Z"}, "message": "rt: Rename asm_call_on_stack to __morestack\n\nNewer gdb's will backtrace through functions named __morestack even\nif they change the stack.", "tree": {"sha": "d79c145430f5351ca96c8b5405e7fabbe34fade3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d79c145430f5351ca96c8b5405e7fabbe34fade3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/05bf105c90e7f0dee866fb15f6616afe25fe209f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/05bf105c90e7f0dee866fb15f6616afe25fe209f", "html_url": "https://github.com/rust-lang/rust/commit/05bf105c90e7f0dee866fb15f6616afe25fe209f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/05bf105c90e7f0dee866fb15f6616afe25fe209f/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f302b79d61165641fb090986a607d8d7e6c317c8", "url": "https://api.github.com/repos/rust-lang/rust/commits/f302b79d61165641fb090986a607d8d7e6c317c8", "html_url": "https://github.com/rust-lang/rust/commit/f302b79d61165641fb090986a607d8d7e6c317c8"}], "stats": {"total": 44, "additions": 30, "deletions": 14}, "files": [{"sha": "a8b89dc6b0f8bbc35bb871b219cd787443f3e4d1", "filename": "src/rt/arch/i386/ccall.S", "status": "modified", "additions": 13, "deletions": 5, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/05bf105c90e7f0dee866fb15f6616afe25fe209f/src%2Frt%2Farch%2Fi386%2Fccall.S", "raw_url": "https://github.com/rust-lang/rust/raw/05bf105c90e7f0dee866fb15f6616afe25fe209f/src%2Frt%2Farch%2Fi386%2Fccall.S", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Farch%2Fi386%2Fccall.S?ref=05bf105c90e7f0dee866fb15f6616afe25fe209f", "patch": "@@ -1,11 +1,19 @@\n-    .text\n+/*\n+\tThe function for switching to the C stack.  It is called\n+\t__morestack because gdb allows any frame with that name to\n+\tmove the stack pointer to a different stack, which it usually\n+\tconsiders an error.\n+*/\n+\n+\t.text\n \n #if defined(__APPLE__) || defined(_WIN32)\n-.globl _asm_call_on_stack\n-_asm_call_on_stack:\n+.globl ___morestack\n+___morestack:\n #else\n-.globl asm_call_on_stack\n-asm_call_on_stack:\n+.globl __morestack\n+.hidden __morestack\n+__morestack:\n #endif\n \n #if defined(__linux__) || defined(__APPLE__)"}, {"sha": "13775f95510715e92172761b9619dfe6771885d3", "filename": "src/rt/arch/i386/context.h", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/05bf105c90e7f0dee866fb15f6616afe25fe209f/src%2Frt%2Farch%2Fi386%2Fcontext.h", "raw_url": "https://github.com/rust-lang/rust/raw/05bf105c90e7f0dee866fb15f6616afe25fe209f/src%2Frt%2Farch%2Fi386%2Fcontext.h", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Farch%2Fi386%2Fcontext.h?ref=05bf105c90e7f0dee866fb15f6616afe25fe209f", "patch": "@@ -29,7 +29,7 @@ struct registers_t {\n   uint32_t eip;\n };\n \n-extern \"C\" void asm_call_on_stack(void *args, void *fn_ptr, uintptr_t stack_ptr);\n+extern \"C\" void __morestack(void *args, void *fn_ptr, uintptr_t stack_ptr);\n \n class context {\n public:\n@@ -57,7 +57,7 @@ class context {\n   }\n \n   void call_shim_on_c_stack(void *args, void *fn_ptr) {\n-      asm_call_on_stack(args, fn_ptr, regs.esp);\n+      __morestack(args, fn_ptr, regs.esp);\n   }\n };\n "}, {"sha": "c208c7ae643370703eac28e8f03cd05961bd5d23", "filename": "src/rt/arch/x86_64/ccall.S", "status": "modified", "additions": 13, "deletions": 4, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/05bf105c90e7f0dee866fb15f6616afe25fe209f/src%2Frt%2Farch%2Fx86_64%2Fccall.S", "raw_url": "https://github.com/rust-lang/rust/raw/05bf105c90e7f0dee866fb15f6616afe25fe209f/src%2Frt%2Farch%2Fx86_64%2Fccall.S", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Farch%2Fx86_64%2Fccall.S?ref=05bf105c90e7f0dee866fb15f6616afe25fe209f", "patch": "@@ -1,3 +1,10 @@\n+/*\n+\tThe function for switching to the C stack.  It is called\n+\t__morestack because gdb allows any frame with that name to\n+\tmove the stack pointer to a different stack, which it usually\n+\tconsiders an error.\n+*/\n+\n #include \"regs.h\"\n \n #define ARG0 RUSTRT_ARG0_S\n@@ -7,11 +14,13 @@\n         .text\n \n #if defined(__APPLE__) || defined(_WIN32)\n-.globl _asm_call_on_stack\n-_asm_call_on_stack:\n+.globl ___morestack\n+.private_extern MORESTACK\n+___morestack:\n #else\n-.globl asm_call_on_stack\n-asm_call_on_stack:\n+.globl __morestack\n+.hidden __morestack\n+__morestack:\n #endif\n \n #if defined(__linux__) || defined(__APPLE__)"}, {"sha": "75902fd79548545550d9149e7b799219747ea45e", "filename": "src/rt/arch/x86_64/context.h", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/05bf105c90e7f0dee866fb15f6616afe25fe209f/src%2Frt%2Farch%2Fx86_64%2Fcontext.h", "raw_url": "https://github.com/rust-lang/rust/raw/05bf105c90e7f0dee866fb15f6616afe25fe209f/src%2Frt%2Farch%2Fx86_64%2Fcontext.h", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Farch%2Fx86_64%2Fcontext.h?ref=05bf105c90e7f0dee866fb15f6616afe25fe209f", "patch": "@@ -27,7 +27,7 @@ struct registers_t {\n     uint64_t data[RUSTRT_MAX];\n };\n \n-extern \"C\" void asm_call_on_stack(void *args, void *fn_ptr, uintptr_t stack_ptr);\n+extern \"C\" void __morestack(void *args, void *fn_ptr, uintptr_t stack_ptr);\n \n class context {\n public:\n@@ -55,7 +55,7 @@ class context {\n     }\n \n     void call_shim_on_c_stack(void *args, void *fn_ptr) {\n-        asm_call_on_stack(args, fn_ptr, regs.data[RUSTRT_RSP]);\n+        __morestack(args, fn_ptr, regs.data[RUSTRT_RSP]);\n     }\n };\n "}, {"sha": "8353483ebf243da3f06d91a1826855b19cde2cfe", "filename": "src/rt/rustrt.def.in", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/05bf105c90e7f0dee866fb15f6616afe25fe209f/src%2Frt%2Frustrt.def.in", "raw_url": "https://github.com/rust-lang/rust/raw/05bf105c90e7f0dee866fb15f6616afe25fe209f/src%2Frt%2Frustrt.def.in", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frustrt.def.in?ref=05bf105c90e7f0dee866fb15f6616afe25fe209f", "patch": "@@ -73,7 +73,6 @@ upcall_call_shim_on_c_stack\n upcall_new_stack\n upcall_del_stack\n upcall_reset_stack_limit\n-asm_call_on_stack\n rust_uv_default_loop\n rust_uv_loop_new\n rust_uv_loop_delete"}]}