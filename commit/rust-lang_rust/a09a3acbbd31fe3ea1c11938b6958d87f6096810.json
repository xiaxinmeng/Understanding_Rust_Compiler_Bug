{"sha": "a09a3acbbd31fe3ea1c11938b6958d87f6096810", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEwOWEzYWNiYmQzMWZlM2VhMWMxMTkzOGI2OTU4ZDg3ZjYwOTY4MTA=", "commit": {"author": {"name": "Seo Sanghyeon", "email": "sanxiyn@gmail.com", "date": "2016-04-04T11:32:42Z"}, "committer": {"name": "Seo Sanghyeon", "email": "sanxiyn@gmail.com", "date": "2016-04-04T11:32:42Z"}, "message": "Remove outdated comment", "tree": {"sha": "5c85f43cdf64e30dc931e62de954a42e6636cb6f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5c85f43cdf64e30dc931e62de954a42e6636cb6f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a09a3acbbd31fe3ea1c11938b6958d87f6096810", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a09a3acbbd31fe3ea1c11938b6958d87f6096810", "html_url": "https://github.com/rust-lang/rust/commit/a09a3acbbd31fe3ea1c11938b6958d87f6096810", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a09a3acbbd31fe3ea1c11938b6958d87f6096810/comments", "author": {"login": "sanxiyn", "id": 45249, "node_id": "MDQ6VXNlcjQ1MjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/45249?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanxiyn", "html_url": "https://github.com/sanxiyn", "followers_url": "https://api.github.com/users/sanxiyn/followers", "following_url": "https://api.github.com/users/sanxiyn/following{/other_user}", "gists_url": "https://api.github.com/users/sanxiyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanxiyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanxiyn/subscriptions", "organizations_url": "https://api.github.com/users/sanxiyn/orgs", "repos_url": "https://api.github.com/users/sanxiyn/repos", "events_url": "https://api.github.com/users/sanxiyn/events{/privacy}", "received_events_url": "https://api.github.com/users/sanxiyn/received_events", "type": "User", "site_admin": false}, "committer": {"login": "sanxiyn", "id": 45249, "node_id": "MDQ6VXNlcjQ1MjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/45249?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanxiyn", "html_url": "https://github.com/sanxiyn", "followers_url": "https://api.github.com/users/sanxiyn/followers", "following_url": "https://api.github.com/users/sanxiyn/following{/other_user}", "gists_url": "https://api.github.com/users/sanxiyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanxiyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanxiyn/subscriptions", "organizations_url": "https://api.github.com/users/sanxiyn/orgs", "repos_url": "https://api.github.com/users/sanxiyn/repos", "events_url": "https://api.github.com/users/sanxiyn/events{/privacy}", "received_events_url": "https://api.github.com/users/sanxiyn/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f92ce2e9fe56942e0fd6a18d0e11bc4a9bdf8ddd", "url": "https://api.github.com/repos/rust-lang/rust/commits/f92ce2e9fe56942e0fd6a18d0e11bc4a9bdf8ddd", "html_url": "https://github.com/rust-lang/rust/commit/f92ce2e9fe56942e0fd6a18d0e11bc4a9bdf8ddd"}], "stats": {"total": 25, "additions": 5, "deletions": 20}, "files": [{"sha": "19a8f9ec5e89a505b412db7f45b0574e76676ad1", "filename": "src/librustc_resolve/check_unused.rs", "status": "modified", "additions": 5, "deletions": 20, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/a09a3acbbd31fe3ea1c11938b6958d87f6096810/src%2Flibrustc_resolve%2Fcheck_unused.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a09a3acbbd31fe3ea1c11938b6958d87f6096810/src%2Flibrustc_resolve%2Fcheck_unused.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Fcheck_unused.rs?ref=a09a3acbbd31fe3ea1c11938b6958d87f6096810", "patch": "@@ -51,16 +51,8 @@ impl<'a, 'b, 'tcx:'b> DerefMut for UnusedImportCheckVisitor<'a, 'b, 'tcx> {\n \n impl<'a, 'b, 'tcx> UnusedImportCheckVisitor<'a, 'b, 'tcx> {\n     // We have information about whether `use` (import) directives are actually\n-    // used now. If an import is not used at all, we signal a lint error. If an\n-    // import is only used for a single namespace, we remove the other namespace\n-    // from the recorded privacy information. That means in privacy.rs, we will\n-    // only check imports and namespaces which are used. In particular, this\n-    // means that if an import could name either a public or private item, we\n-    // will check the correct thing, dependent on how the import is used.\n-    fn finalize_import(&mut self, id: ast::NodeId, span: Span) {\n-        debug!(\"finalizing import uses for {:?}\",\n-               self.session.codemap().span_to_snippet(span));\n-\n+    // used now. If an import is not used at all, we signal a lint error.\n+    fn check_import(&mut self, id: ast::NodeId, span: Span) {\n         if !self.used_imports.contains(&(id, TypeNS)) &&\n            !self.used_imports.contains(&(id, ValueNS)) {\n             self.session.add_lint(lint::builtin::UNUSED_IMPORTS,\n@@ -95,23 +87,16 @@ impl<'a, 'b, 'v, 'tcx> Visitor<'v> for UnusedImportCheckVisitor<'a, 'b, 'tcx> {\n             hir::ItemUse(ref p) => {\n                 match p.node {\n                     ViewPathSimple(_, _) => {\n-                        self.finalize_import(item.id, p.span)\n+                        self.check_import(item.id, p.span)\n                     }\n \n                     ViewPathList(_, ref list) => {\n                         for i in list {\n-                            self.finalize_import(i.node.id(), i.span);\n+                            self.check_import(i.node.id(), i.span);\n                         }\n                     }\n                     ViewPathGlob(_) => {\n-                        if !self.used_imports.contains(&(item.id, TypeNS)) &&\n-                           !self.used_imports.contains(&(item.id, ValueNS)) {\n-                            self.session\n-                                .add_lint(lint::builtin::UNUSED_IMPORTS,\n-                                          item.id,\n-                                          p.span,\n-                                          \"unused import\".to_string());\n-                        }\n+                        self.check_import(item.id, p.span)\n                     }\n                 }\n             }"}]}