{"sha": "e1913587889b0b1147531c370d9c810b46b5971e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmUxOTEzNTg3ODg5YjBiMTE0NzUzMWMzNzBkOWM4MTBiNDZiNTk3MWU=", "commit": {"author": {"name": "aspen", "email": "luxx4x@protonmail.com", "date": "2020-06-30T21:21:49Z"}, "committer": {"name": "aspen", "email": "luxx4x@protonmail.com", "date": "2020-06-30T21:21:49Z"}, "message": "Changes required for rustc/cargo to build for iOS targets", "tree": {"sha": "7cfc69f74c7182f7da2e6b0213aac03160ee0024", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7cfc69f74c7182f7da2e6b0213aac03160ee0024"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e1913587889b0b1147531c370d9c810b46b5971e", "comment_count": 0, "verification": {"verified": false, "reason": "no_user", "signature": "-----BEGIN PGP SIGNATURE-----\n\niHUEABYIAB0WIQT9GEgotw7oWiVcdotzKTKWiWXeVgUCXvus7gAKCRBzKTKWiWXe\nVgekAQDRkpZ7KzwVM/QQW3hHNHSBPIGF32+Y86JbYsynhRYRngD/bMB+IISDv388\npuX/0KDodU5dSzDu/ZgR6PE/VF4xkQI=\n=6yBO\n-----END PGP SIGNATURE-----", "payload": "tree 7cfc69f74c7182f7da2e6b0213aac03160ee0024\nparent 16957bd4d3a5377263f76ed74c572aad8e4b7e59\nauthor aspen <luxx4x@protonmail.com> 1593552109 -0400\ncommitter aspen <luxx4x@protonmail.com> 1593552109 -0400\n\nChanges required for rustc/cargo to build for iOS targets\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e1913587889b0b1147531c370d9c810b46b5971e", "html_url": "https://github.com/rust-lang/rust/commit/e1913587889b0b1147531c370d9c810b46b5971e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e1913587889b0b1147531c370d9c810b46b5971e/comments", "author": null, "committer": null, "parents": [{"sha": "16957bd4d3a5377263f76ed74c572aad8e4b7e59", "url": "https://api.github.com/repos/rust-lang/rust/commits/16957bd4d3a5377263f76ed74c572aad8e4b7e59", "html_url": "https://github.com/rust-lang/rust/commit/16957bd4d3a5377263f76ed74c572aad8e4b7e59"}], "stats": {"total": 13, "additions": 13, "deletions": 0}, "files": [{"sha": "b11a7fc6255f3dda11b9847577964f2d88a55eff", "filename": "src/bootstrap/lib.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e1913587889b0b1147531c370d9c810b46b5971e/src%2Fbootstrap%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e1913587889b0b1147531c370d9c810b46b5971e/src%2Fbootstrap%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Flib.rs?ref=e1913587889b0b1147531c370d9c810b46b5971e", "patch": "@@ -811,6 +811,11 @@ impl Build {\n         if target.contains(\"apple-darwin\") {\n             base.push(\"-stdlib=libc++\".into());\n         }\n+        \n+        // Required for LLVM to properly compile.\n+        if target.contains(\"apple-ios\") {\n+            base.push(\"-miphoneos-version-min=10.0\".into());\n+        }\n \n         // Work around an apparently bad MinGW / GCC optimization,\n         // See: http://lists.llvm.org/pipermail/cfe-dev/2016-December/051980.html"}, {"sha": "e35ffb304bcfa8fa90b9fcdee4dad6179727a846", "filename": "src/bootstrap/native.rs", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/e1913587889b0b1147531c370d9c810b46b5971e/src%2Fbootstrap%2Fnative.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e1913587889b0b1147531c370d9c810b46b5971e/src%2Fbootstrap%2Fnative.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fnative.rs?ref=e1913587889b0b1147531c370d9c810b46b5971e", "patch": "@@ -175,6 +175,14 @@ impl Step for Llvm {\n             cfg.define(\"LLVM_ENABLE_ZLIB\", \"OFF\");\n         }\n \n+        // Are we compiling for iOS/tvOS?\n+        if target.contains(\"apple\") && !target.contains(\"darwin\") {\n+            cfg.define(\"CMAKE_OSX_SYSROOT\", \"/\");\n+            cfg.define(\"CMAKE_OSX_DEPLOYMENT_TARGET\", \"\");\n+            cfg.define(\"LLVM_ENABLE_PLUGINS\", \"OFF\"); // Prevent cmake from adding -bundle to CFLAGS automatically.\n+            cfg.define(\"LLVM_ENABLE_ZLIB\", \"OFF\");\n+        }\n+\n         if builder.config.llvm_thin_lto {\n             cfg.define(\"LLVM_ENABLE_LTO\", \"Thin\");\n             if !target.contains(\"apple\") {"}]}