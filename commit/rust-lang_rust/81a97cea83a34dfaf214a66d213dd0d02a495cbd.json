{"sha": "81a97cea83a34dfaf214a66d213dd0d02a495cbd", "node_id": "MDY6Q29tbWl0NzI0NzEyOjgxYTk3Y2VhODNhMzRkZmFmMjE0YTY2ZDIxM2RkMGQwMmE0OTVjYmQ=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2021-05-06T15:11:12Z"}, "committer": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2021-05-06T15:11:12Z"}, "message": "move the current channel to src/ci/channel\n\nThis will make it easier for tools to programmatically detect which\nchannel CI is building.", "tree": {"sha": "2cdb292e9ec8a6ace48378515370a7f14fb53101", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2cdb292e9ec8a6ace48378515370a7f14fb53101"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/81a97cea83a34dfaf214a66d213dd0d02a495cbd", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE1JbYPtLJAsc22U9xPgar6Auq8ZwFAmCUB00ACgkQPgar6Auq\n8ZzHuQ/8DDNd9HiCT+htCDYBns19a8DzQHny6Q2CnHr4yqQdTvYYRukBrYh27fPn\ncBdhzy0Lkt/crpg9Y530lFYMxCFtv2GOaiE/30QMal2UYSBJ2zBgS/LLTyi4PMYk\nom2mwtO0EugoCo+o4l7YjLQsuGFI9ozcZwTcwlL/b3zD/kgSnYSANfPVLQsDsj8T\nCWomTfAGm+53HMNjeJ8vDmM9B4xh0OnKRr94LzT3p/siAly/d49r+ykdQe+IvhBB\nAMluhgl9lwA7OpNdMSbecRDKppG0p7EoSdSIanakQQp1ZyGMl8rVIZcc3R1FUkuH\nEqhabjsjD5JWyQu2dcxaw4Aa3F0ocpsofnQKVWOAGimoMh4TU7U+kcKCSdKmtwvc\n5GSkXxJnulhn7CU8chFOq1ac2DoAFwV/vuvI2SgCNjnJVDrU5wHLSbnzqaZ+/W2p\nDs01cnC/qljb+tLNtpT8bPZi//tz0GfVg8VUrRNLpOEuQLXqmxWFJqilYcP/kTzY\nXlwNUu0F8ygjk7oVh6FD8Pf2U5+suYt2PL04O0svyX4a1KAOOhj8t9L8pP3+IHUb\n9OFvYbkQWiujrnAGeCn+aV2FQ26IFQqR/RsmlDPU5G/SS/7iSsg4yECTH43ZmMHx\njgniN2/CR3qsHdlbIeagNRx/Y4ILls8vQB2AlfMo0q5r8eaMQ30=\n=FfI4\n-----END PGP SIGNATURE-----", "payload": "tree 2cdb292e9ec8a6ace48378515370a7f14fb53101\nparent 109248a4eb99bc83684c94ca4ef36f2fadc17e2a\nauthor Pietro Albini <pietro@pietroalbini.org> 1620313872 +0200\ncommitter Pietro Albini <pietro@pietroalbini.org> 1620313872 +0200\n\nmove the current channel to src/ci/channel\n\nThis will make it easier for tools to programmatically detect which\nchannel CI is building.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/81a97cea83a34dfaf214a66d213dd0d02a495cbd", "html_url": "https://github.com/rust-lang/rust/commit/81a97cea83a34dfaf214a66d213dd0d02a495cbd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/81a97cea83a34dfaf214a66d213dd0d02a495cbd/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "109248a4eb99bc83684c94ca4ef36f2fadc17e2a", "url": "https://api.github.com/repos/rust-lang/rust/commits/109248a4eb99bc83684c94ca4ef36f2fadc17e2a", "html_url": "https://github.com/rust-lang/rust/commit/109248a4eb99bc83684c94ca4ef36f2fadc17e2a"}], "stats": {"total": 10, "additions": 2, "deletions": 8}, "files": [{"sha": "bf867e0ae5b6c08df1118a2ece970677bc479f1b", "filename": "src/ci/channel", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/81a97cea83a34dfaf214a66d213dd0d02a495cbd/src%2Fci%2Fchannel", "raw_url": "https://github.com/rust-lang/rust/raw/81a97cea83a34dfaf214a66d213dd0d02a495cbd/src%2Fci%2Fchannel", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fchannel?ref=81a97cea83a34dfaf214a66d213dd0d02a495cbd", "patch": "@@ -0,0 +1 @@\n+nightly"}, {"sha": "35f80a935c6937ea022eef265ed2f9e89701542a", "filename": "src/ci/run.sh", "status": "modified", "additions": 1, "deletions": 8, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/81a97cea83a34dfaf214a66d213dd0d02a495cbd/src%2Fci%2Frun.sh", "raw_url": "https://github.com/rust-lang/rust/raw/81a97cea83a34dfaf214a66d213dd0d02a495cbd/src%2Fci%2Frun.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Frun.sh?ref=81a97cea83a34dfaf214a66d213dd0d02a495cbd", "patch": "@@ -62,17 +62,10 @@ if [ \"$DIST_SRC\" = \"\" ]; then\n   RUST_CONFIGURE_ARGS=\"$RUST_CONFIGURE_ARGS --disable-dist-src\"\n fi\n \n-# If we're deploying artifacts then we set the release channel, otherwise if\n-# we're not deploying then we want to be sure to enable all assertions because\n-# we'll be running tests\n-#\n-# FIXME: need a scheme for changing this `nightly` value to `beta` and `stable`\n-#        either automatically or manually.\n-export RUST_RELEASE_CHANNEL=nightly\n-\n # Always set the release channel for bootstrap; this is normally not important (i.e., only dist\n # builds would seem to matter) but in practice bootstrap wants to know whether we're targeting\n # master, beta, or stable with a build to determine whether to run some checks (notably toolstate).\n+export RUST_RELEASE_CHANNEL=\"$(cat \"${ci_dir}/channel\")\"\n RUST_CONFIGURE_ARGS=\"$RUST_CONFIGURE_ARGS --release-channel=$RUST_RELEASE_CHANNEL\"\n \n if [ \"$DEPLOY$DEPLOY_ALT\" = \"1\" ]; then"}]}