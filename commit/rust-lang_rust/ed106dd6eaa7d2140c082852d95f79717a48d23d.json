{"sha": "ed106dd6eaa7d2140c082852d95f79717a48d23d", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVkMTA2ZGQ2ZWFhN2QyMTQwYzA4Mjg1MmQ5NWY3OTcxN2E0OGQyM2Q=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-09-30T19:08:51Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-09-30T23:18:19Z"}, "message": "Fix some make variables in tests.mk", "tree": {"sha": "e339bc297f6d2a28b9428b19d59aa0fa5ce362b4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e339bc297f6d2a28b9428b19d59aa0fa5ce362b4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ed106dd6eaa7d2140c082852d95f79717a48d23d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ed106dd6eaa7d2140c082852d95f79717a48d23d", "html_url": "https://github.com/rust-lang/rust/commit/ed106dd6eaa7d2140c082852d95f79717a48d23d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ed106dd6eaa7d2140c082852d95f79717a48d23d/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c065280a0b0e3b85050151f478c3134b0a3cce23", "url": "https://api.github.com/repos/rust-lang/rust/commits/c065280a0b0e3b85050151f478c3134b0a3cce23", "html_url": "https://github.com/rust-lang/rust/commit/c065280a0b0e3b85050151f478c3134b0a3cce23"}], "stats": {"total": 42, "additions": 25, "deletions": 17}, "files": [{"sha": "c8059f7280cc3f4a9ef09cabce2c1aa1f95b5c4d", "filename": "Makefile.in", "status": "modified", "additions": 22, "deletions": 14, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/ed106dd6eaa7d2140c082852d95f79717a48d23d/Makefile.in", "raw_url": "https://github.com/rust-lang/rust/raw/ed106dd6eaa7d2140c082852d95f79717a48d23d/Makefile.in", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Makefile.in?ref=ed106dd6eaa7d2140c082852d95f79717a48d23d", "patch": "@@ -168,25 +168,33 @@ LLC := $(CFG_LLVM_BINDIR)/llc$(X)\n ######################################################################\n \n define SREQ\n+\n+TARGET_ROOT$(1)$(2) = stage$(1)/lib/rustc/$(2)\n+TARGET_BIN$(1)$(2) = $(TARGET_ROOT$(1)$(2))/bin\n+TARGET_LIB$(1)$(2) = $(TARGET_ROOT$(1)$(2))/lib\n+HOST_ROOT$(1) = $(TARGET_ROOT$(1)$$(CFG_HOST_TRIPLE))\n+HOST_BIN$(1) = $(TARGET_BIN$(1)$$(CFG_HOST_TRIPLE))\n+HOST_LIB$(1) = $(TARGET_LIB$(1)$$(CFG_HOST_TRIPLE))\n+\n ifdef CFG_DISABLE_SHAREDSTD\n-SREQ$(1)$(2) = stage$(1)/bin/rustc$(X)          \\\n-           stage$(1)/lib/$$(CFG_RUNTIME)     \\\n+SREQ$(1)$(2) = $(HOST_BIN$(1))/rustc$(X)          \\\n+           $(HOST_LIB$(1))/$$(CFG_RUNTIME)     \\\n            $$(call CFG_STDLIB_DEFAULT,stage$(1),stage$(1)) \\\n-           stage$(1)/lib/$$(CFG_RUSTLLVM)    \\\n-           stage$(1)/lib/rustc/$(2)/$$(CFG_RUNTIME) \\\n-           stage$(1)/lib/rustc/$(2)/$$(CFG_STDLIB) \\\n-           stage$(1)/lib/rustc/$(2)/intrinsics.bc \\\n-           stage$(1)/lib/rustc/$(2)/main.o \\\n+           $(HOST_LIB$(1))/$$(CFG_RUSTLLVM)    \\\n+           $(TARGET_LIB$(1)$(2))/$$(CFG_RUNTIME) \\\n+           $(TARGET_LIB$(1)$(2))/$$(CFG_STDLIB) \\\n+           $(TARGET_LIB$(1)$(2))/intrinsics.bc \\\n+           $(TARGET_LIB$(1)$(2))/main.o \\\n            $$(MKFILES)\n else\n-SREQ$(1)$(2) = stage$(1)/bin/rustc$(X)          \\\n-           stage$(1)/lib/$$(CFG_RUNTIME)     \\\n+SREQ$(1)$(2) = $(HOST_BIN$(1))/rustc$(X)          \\\n+           $(HOST_LIB$(1))/$$(CFG_RUNTIME)     \\\n            $$(call CFG_STDLIB_DEFAULT,stage$(1),stage$(1)) \\\n-           stage$(1)/lib/$$(CFG_RUSTLLVM)    \\\n-           stage$(1)/lib/rustc/$(2)/$$(CFG_RUNTIME) \\\n-           stage$(1)/lib/rustc/$(2)/$$(CFG_STDLIB) \\\n-           stage$(1)/lib/rustc/$(2)/intrinsics.bc \\\n-           stage$(1)/lib/rustc/$(2)/main.o \\\n+           $(HOST_LIB$(1))/$$(CFG_RUSTLLVM)    \\\n+           $(TARGET_LIB$(1)$(2))/$$(CFG_RUNTIME) \\\n+           $(TARGET_LIB$(1)$(2))/$$(CFG_STDLIB) \\\n+           $(TARGET_LIB$(1)$(2))/intrinsics.bc \\\n+           $(TARGET_LIB$(1)$(2))/main.o \\\n            $$(MKFILES)\n endif\n "}, {"sha": "130c811393499854d9ed66edb4060797ea3a8b81", "filename": "mk/tests.mk", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/ed106dd6eaa7d2140c082852d95f79717a48d23d/mk%2Ftests.mk", "raw_url": "https://github.com/rust-lang/rust/raw/ed106dd6eaa7d2140c082852d95f79717a48d23d/mk%2Ftests.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftests.mk?ref=ed106dd6eaa7d2140c082852d95f79717a48d23d", "patch": "@@ -131,7 +131,7 @@ check-stage$(2): tidy \\\n check-stage$(2)-std: test/stdtest.stage$(2).out \\\n \n test/stdtest.stage$(2)$$(X): $$(STDTEST_CRATE) $$(STDTEST_INPUTS) \\\n-                             $$(SREQ$(2)$(CFG_HOST_TRIPLE))\n+                             $$(SREQ$(2)$$(CFG_HOST_TRIPLE))\n \t@$$(call E, compile_and_link: $$@)\n \t$$(STAGE$(2)) -o $$@ $$< --test\n \n@@ -149,7 +149,7 @@ test/rustctest.stage$(2)$$(X): $$(COMPILER_CRATE) $$(COMPILER_INPUTS) \\\n                            stage$(2)/lib/$$(CFG_RUNTIME) \\\n                            $$(call CFG_STDLIB_DEFAULT,stage$(1),stage$(2)) \\\n                            stage$(2)/lib/$$(CFG_RUSTLLVM) \\\n-                           $$(SREQ$(1)$(CFG_HOST_TRIPLE))\n+                           $$(SREQ$(1)$$(CFG_HOST_TRIPLE))\n \t@$$(call E, compile_and_link: $$@)\n \t$$(STAGE$(1)) -o $$@ $$< --test\n \n@@ -243,7 +243,7 @@ PRETTY_PRETTY_ARGS$(2) := $$(CTEST_COMMON_ARGS$(2)) \\\n \n test/compiletest.stage$(2)$$(X): $$(COMPILETEST_CRATE) \\\n                                  $$(COMPILETEST_INPUTS) \\\n-                                 $$(SREQ$(2)$(CFG_HOST_TRIPLE))\n+                                 $$(SREQ$(2)$$(CFG_HOST_TRIPLE))\n \t@$$(call E, compile_and_link: $$@)\n \t$$(STAGE$(2)) -o $$@ $$<\n "}]}