{"sha": "6cb364cda47d960d08b8e7fb03d0df0e9bdbd190", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZjYjM2NGNkYTQ3ZDk2MGQwOGI4ZTdmYjAzZDBkZjBlOWJkYmQxOTA=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2020-08-22T14:49:56Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2020-08-23T12:39:43Z"}, "message": "Prevent automatic page change when using history", "tree": {"sha": "f301c1c43d317691bf9bdc0f7184f81447cdbd1a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f301c1c43d317691bf9bdc0f7184f81447cdbd1a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6cb364cda47d960d08b8e7fb03d0df0e9bdbd190", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6cb364cda47d960d08b8e7fb03d0df0e9bdbd190", "html_url": "https://github.com/rust-lang/rust/commit/6cb364cda47d960d08b8e7fb03d0df0e9bdbd190", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6cb364cda47d960d08b8e7fb03d0df0e9bdbd190/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1a22a0ff93d63f738151f096434e732466b4a42e", "url": "https://api.github.com/repos/rust-lang/rust/commits/1a22a0ff93d63f738151f096434e732466b4a42e", "html_url": "https://github.com/rust-lang/rust/commit/1a22a0ff93d63f738151f096434e732466b4a42e"}], "stats": {"total": 15, "additions": 11, "deletions": 4}, "files": [{"sha": "f465228b7493ee3324095369fa10ed659328ed95", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/6cb364cda47d960d08b8e7fb03d0df0e9bdbd190/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/6cb364cda47d960d08b8e7fb03d0df0e9bdbd190/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=6cb364cda47d960d08b8e7fb03d0df0e9bdbd190", "patch": "@@ -1576,14 +1576,18 @@ function defocusSearchBar() {\n         }\n \n         function showResults(results) {\n-            if (results.others.length === 1 &&\n-                getCurrentValue(\"rustdoc-go-to-only-result\") === \"true\") {\n+            var search = getSearchElement();\n+            if (results.others.length === 1\n+                && getCurrentValue(\"rustdoc-go-to-only-result\") === \"true\"\n+                && (!search.firstChild || search.firstChild.innerText !== getSearchLoadingText()))\n+            {\n                 var elem = document.createElement(\"a\");\n                 elem.href = results.others[0].href;\n                 elem.style.display = \"none\";\n                 // For firefox, we need the element to be in the DOM so it can be clicked.\n                 document.body.appendChild(elem);\n                 elem.click();\n+                return;\n             }\n             var query = getQuery(search_input.value);\n \n@@ -1602,7 +1606,6 @@ function defocusSearchBar() {\n                 \"</div><div id=\\\"results\\\">\" +\n                 ret_others[0] + ret_in_args[0] + ret_returned[0] + \"</div>\";\n \n-            var search = getSearchElement();\n             search.innerHTML = output;\n             showSearchResults(search);\n             var tds = search.getElementsByTagName(\"td\");\n@@ -2679,6 +2682,10 @@ function defocusSearchBar() {\n         }\n     }\n \n+    function getSearchLoadingText() {\n+        return \"Loading search results...\";\n+    }\n+\n     if (search_input) {\n         search_input.onfocus = function() {\n             putBackSearch(this);\n@@ -2688,7 +2695,7 @@ function defocusSearchBar() {\n     var params = getQueryStringParams();\n     if (params && params.search) {\n         var search = getSearchElement();\n-        search.innerHTML = \"<h3 style=\\\"text-align: center;\\\">Loading search results...</h3>\";\n+        search.innerHTML = \"<h3 style=\\\"text-align: center;\\\">\" + getSearchLoadingText() + \"</h3>\";\n         showSearchResults(search);\n     }\n "}]}