{"sha": "3d78f502bdb74a2d0b9cc8d9bb990e0a471dfb8c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNkNzhmNTAyYmRiNzRhMmQwYjljYzhkOWJiOTkwZTBhNDcxZGZiOGM=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2021-01-13T17:10:46Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2021-01-13T18:32:24Z"}, "message": "Use upstream TextSize API", "tree": {"sha": "652c20b44230439351678936db4b5c590bbd177b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/652c20b44230439351678936db4b5c590bbd177b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3d78f502bdb74a2d0b9cc8d9bb990e0a471dfb8c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3d78f502bdb74a2d0b9cc8d9bb990e0a471dfb8c", "html_url": "https://github.com/rust-lang/rust/commit/3d78f502bdb74a2d0b9cc8d9bb990e0a471dfb8c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3d78f502bdb74a2d0b9cc8d9bb990e0a471dfb8c/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f84f5cb0ea3c1b10fbe96038d0201975913425cc", "url": "https://api.github.com/repos/rust-lang/rust/commits/f84f5cb0ea3c1b10fbe96038d0201975913425cc", "html_url": "https://github.com/rust-lang/rust/commit/f84f5cb0ea3c1b10fbe96038d0201975913425cc"}], "stats": {"total": 22, "additions": 5, "deletions": 17}, "files": [{"sha": "7b175ec677e3aee9ba500f87368838262905ba9d", "filename": "Cargo.lock", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3d78f502bdb74a2d0b9cc8d9bb990e0a471dfb8c/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/3d78f502bdb74a2d0b9cc8d9bb990e0a471dfb8c/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=3d78f502bdb74a2d0b9cc8d9bb990e0a471dfb8c", "patch": "@@ -1635,9 +1635,9 @@ dependencies = [\n \n [[package]]\n name = \"text-size\"\n-version = \"1.0.0\"\n+version = \"1.1.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"f03e7efdedc3bc78cb2337f1e2785c39e45f5ef762d9e4ebb137fff7380a6d8a\"\n+checksum = \"288cb548dbe72b652243ea797201f3d481a0609a967980fcc5b2315ea811560a\"\n \n [[package]]\n name = \"text_edit\""}, {"sha": "882a685a567be4f15a93708646f331753f7c3421", "filename": "crates/ide/src/syntax_highlighting/highlights.rs", "status": "modified", "additions": 2, "deletions": 12, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/3d78f502bdb74a2d0b9cc8d9bb990e0a471dfb8c/crates%2Fide%2Fsrc%2Fsyntax_highlighting%2Fhighlights.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3d78f502bdb74a2d0b9cc8d9bb990e0a471dfb8c/crates%2Fide%2Fsrc%2Fsyntax_highlighting%2Fhighlights.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fsyntax_highlighting%2Fhighlights.rs?ref=3d78f502bdb74a2d0b9cc8d9bb990e0a471dfb8c", "patch": "@@ -1,5 +1,5 @@\n //! Collects a tree of highlighted ranges and flattens it.\n-use std::{cmp::Ordering, iter};\n+use std::iter;\n \n use stdx::equal_range_by;\n use syntax::TextRange;\n@@ -52,7 +52,7 @@ impl Node {\n         }\n \n         let overlapping =\n-            equal_range_by(&self.nested, |n| ordering(n.hl_range.range, hl_range.range));\n+            equal_range_by(&self.nested, |n| TextRange::ordering(n.hl_range.range, hl_range.range));\n \n         if overlapping.len() == 1\n             && self.nested[overlapping.start].hl_range.range.contains_range(hl_range.range)\n@@ -90,13 +90,3 @@ impl Node {\n         }\n     }\n }\n-\n-pub(super) fn ordering(r1: TextRange, r2: TextRange) -> Ordering {\n-    if r1.end() <= r2.start() {\n-        Ordering::Less\n-    } else if r2.end() <= r1.start() {\n-        Ordering::Greater\n-    } else {\n-        Ordering::Equal\n-    }\n-}"}, {"sha": "24ff473ecdf8a75811f99f1b4e703e79b3b7b7ef", "filename": "crates/ide/src/syntax_highlighting/injector.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3d78f502bdb74a2d0b9cc8d9bb990e0a471dfb8c/crates%2Fide%2Fsrc%2Fsyntax_highlighting%2Finjector.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3d78f502bdb74a2d0b9cc8d9bb990e0a471dfb8c/crates%2Fide%2Fsrc%2Fsyntax_highlighting%2Finjector.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fsyntax_highlighting%2Finjector.rs?ref=3d78f502bdb74a2d0b9cc8d9bb990e0a471dfb8c", "patch": "@@ -5,8 +5,6 @@ use std::ops::{self, Sub};\n use stdx::equal_range_by;\n use syntax::{TextRange, TextSize};\n \n-use super::highlights::ordering;\n-\n #[derive(Default)]\n pub(super) struct Injector {\n     buf: String,\n@@ -33,7 +31,7 @@ impl Injector {\n         &self.buf\n     }\n     pub(super) fn map_range_up(&self, range: TextRange) -> impl Iterator<Item = TextRange> + '_ {\n-        equal_range_by(&self.ranges, |&(r, _)| ordering(r, range)).filter_map(move |i| {\n+        equal_range_by(&self.ranges, |&(r, _)| TextRange::ordering(r, range)).filter_map(move |i| {\n             let (target_range, delta) = self.ranges[i];\n             let intersection = target_range.intersect(range).unwrap();\n             Some(intersection + delta?)"}]}