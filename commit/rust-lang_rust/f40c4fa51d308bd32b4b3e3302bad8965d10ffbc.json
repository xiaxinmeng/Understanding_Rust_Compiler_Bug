{"sha": "f40c4fa51d308bd32b4b3e3302bad8965d10ffbc", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY0MGM0ZmE1MWQzMDhiZDMyYjRiM2UzMzAyYmFkODk2NWQxMGZmYmM=", "commit": {"author": {"name": "Oliver S\u0336c\u0336h\u0336n\u0336e\u0336i\u0336d\u0336e\u0336r Scherer", "email": "github35764891676564198441@oli-obk.de", "date": "2018-10-17T07:47:02Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-10-17T07:47:02Z"}, "message": "Merge pull request #3327 from phansch/update_changelog_riir\n\nRIIR update_lints: Update changelog links", "tree": {"sha": "b66e353588b44c52ee3532afb37ca8525bf5296c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b66e353588b44c52ee3532afb37ca8525bf5296c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f40c4fa51d308bd32b4b3e3302bad8965d10ffbc", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJbxuj2CRBK7hj4Ov3rIwAAdHIIABo/TjJxVaUcMSA6TkVGNGwr\n2yUwgH63p+3+HJMhFrAd+tXkPIoKwLpoCdKY9iwVAZTy9erwzPD9dWduPk5MaCjm\nMP1ewMBmcW0zdeQ/jQGYgChgzcDYZgMbCz9q9+6Y10sZBz4GelaWzpa+BOHQiobT\n3ELqmgKmVV1lO7D0p05bORBRkkKRAG1R6R98U13PDY+FqCWxGeyA9lVwuxj/ZyGq\ngxJEzmQqnEaFF5ivkkmH+AMMfa8yEz4PIGUP7tjzPDUCVmvlOzjhm1fT+fp3JoK1\nkOW4jrB4mxNPYxaxA3LvGGlDfSPEYNkEEOnQtUtraQ+3lg6cncaDbGkzxInHdxo=\n=AwpF\n-----END PGP SIGNATURE-----\n", "payload": "tree b66e353588b44c52ee3532afb37ca8525bf5296c\nparent 284c63e84d21a844c0cbe6fc9d227f381f1b5130\nparent 9f3ac4e5a396170c6f59e0f654c65b5ba0c4e5e5\nauthor Oliver S\u0336c\u0336h\u0336n\u0336e\u0336i\u0336d\u0336e\u0336r Scherer <github35764891676564198441@oli-obk.de> 1539762422 +0200\ncommitter GitHub <noreply@github.com> 1539762422 +0200\n\nMerge pull request #3327 from phansch/update_changelog_riir\n\nRIIR update_lints: Update changelog links"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f40c4fa51d308bd32b4b3e3302bad8965d10ffbc", "html_url": "https://github.com/rust-lang/rust/commit/f40c4fa51d308bd32b4b3e3302bad8965d10ffbc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f40c4fa51d308bd32b4b3e3302bad8965d10ffbc/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "284c63e84d21a844c0cbe6fc9d227f381f1b5130", "url": "https://api.github.com/repos/rust-lang/rust/commits/284c63e84d21a844c0cbe6fc9d227f381f1b5130", "html_url": "https://github.com/rust-lang/rust/commit/284c63e84d21a844c0cbe6fc9d227f381f1b5130"}, {"sha": "9f3ac4e5a396170c6f59e0f654c65b5ba0c4e5e5", "url": "https://api.github.com/repos/rust-lang/rust/commits/9f3ac4e5a396170c6f59e0f654c65b5ba0c4e5e5", "html_url": "https://github.com/rust-lang/rust/commit/9f3ac4e5a396170c6f59e0f654c65b5ba0c4e5e5"}], "stats": {"total": 44, "additions": 41, "deletions": 3}, "files": [{"sha": "773512333815e2104e7f8bfab49c0d212e7dbddc", "filename": "clippy_dev/src/lib.rs", "status": "modified", "additions": 31, "deletions": 1, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/f40c4fa51d308bd32b4b3e3302bad8965d10ffbc/clippy_dev%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f40c4fa51d308bd32b4b3e3302bad8965d10ffbc/clippy_dev%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Flib.rs?ref=f40c4fa51d308bd32b4b3e3302bad8965d10ffbc", "patch": "@@ -59,13 +59,29 @@ impl Lint {\n \n     /// Returns all non-deprecated lints and non-internal lints\n     pub fn usable_lints(lints: impl Iterator<Item=Self>) -> impl Iterator<Item=Self> {\n-        lints.filter(|l| l.deprecation.is_none() && !l.group.starts_with(\"internal\"))\n+        lints.filter(|l| l.deprecation.is_none() && !l.is_internal())\n     }\n \n     /// Returns the lints in a HashMap, grouped by the different lint groups\n     pub fn by_lint_group(lints: &[Self]) -> HashMap<String, Vec<Self>> {\n         lints.iter().map(|lint| (lint.group.to_string(), lint.clone())).into_group_map()\n     }\n+\n+    pub fn is_internal(&self) -> bool {\n+        self.group.starts_with(\"internal\")\n+    }\n+}\n+\n+pub fn gen_changelog_lint_list(lints: Vec<Lint>) -> Vec<String> {\n+    let mut lint_list_sorted: Vec<Lint> = lints;\n+    lint_list_sorted.sort_by_key(|l| l.name.clone());\n+    lint_list_sorted\n+        .iter()\n+        .filter(|l| !l.is_internal())\n+        .map(|l| {\n+            format!(\"[`{}`]: {}#{}\", l.name, DOCS_LINK.clone(), l.name)\n+        })\n+        .collect()\n }\n \n /// Gathers all files in `src/clippy_lints` and gathers all lints inside\n@@ -291,3 +307,17 @@ fn test_by_lint_group() {\n     ]);\n     assert_eq!(expected, Lint::by_lint_group(&lints));\n }\n+\n+#[test]\n+fn test_gen_changelog_lint_list() {\n+    let lints = vec![\n+        Lint::new(\"should_assert_eq\", \"group1\", \"abc\", None, \"module_name\"),\n+        Lint::new(\"should_assert_eq2\", \"group2\", \"abc\", None, \"module_name\"),\n+        Lint::new(\"incorrect_internal\", \"internal_style\", \"abc\", None, \"module_name\"),\n+    ];\n+    let expected = vec![\n+        format!(\"[`should_assert_eq`]: {}#should_assert_eq\", DOCS_LINK.to_string()),\n+        format!(\"[`should_assert_eq2`]: {}#should_assert_eq2\", DOCS_LINK.to_string())\n+    ];\n+    assert_eq!(expected, gen_changelog_lint_list(lints));\n+}"}, {"sha": "8769ee6b8103eb9b7a4e69f072f48f7893b6b6e6", "filename": "clippy_dev/src/main.rs", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/f40c4fa51d308bd32b4b3e3302bad8965d10ffbc/clippy_dev%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f40c4fa51d308bd32b4b3e3302bad8965d10ffbc/clippy_dev%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Fmain.rs?ref=f40c4fa51d308bd32b4b3e3302bad8965d10ffbc", "patch": "@@ -59,8 +59,8 @@ fn print_lints() {\n }\n \n fn update_lints() {\n-    let lint_list = gather_all();\n-    let usable_lints: Vec<Lint> = Lint::usable_lints(lint_list).collect();\n+    let lint_list: Vec<Lint> = gather_all().collect();\n+    let usable_lints: Vec<Lint> = Lint::usable_lints(lint_list.clone().into_iter()).collect();\n     let lint_count = usable_lints.len();\n \n     replace_region_in_file(\n@@ -74,4 +74,12 @@ fn update_lints() {\n             ]\n         }\n     );\n+\n+    replace_region_in_file(\n+        \"../CHANGELOG.md\",\n+        \"<!-- begin autogenerated links to lint list -->\",\n+        \"<!-- end autogenerated links to lint list -->\",\n+        false,\n+        || { gen_changelog_lint_list(lint_list.clone()) }\n+    );\n }"}]}