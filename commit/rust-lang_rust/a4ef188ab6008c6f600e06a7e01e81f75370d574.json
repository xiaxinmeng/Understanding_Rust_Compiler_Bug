{"sha": "a4ef188ab6008c6f600e06a7e01e81f75370d574", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE0ZWYxODhhYjYwMDhjNmY2MDBlMDZhN2UwMWU4MWY3NTM3MGQ1NzQ=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-04-25T01:05:24Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-04-25T01:05:24Z"}, "message": "Rollup merge of #60160 - xldenis:fix-overlapping-zero-width-annotation, r=estebank\n\nFix #58270, fix off-by-one error in error diagnostics.\n\nThis fixes #58270 by checking if two diagnostics overlap completely when we're calculating the line offset for each message.", "tree": {"sha": "0d1e0f669217b452ad987024276fefe008bee236", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0d1e0f669217b452ad987024276fefe008bee236"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a4ef188ab6008c6f600e06a7e01e81f75370d574", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJcwQfUCRBK7hj4Ov3rIwAAdHIIAA0ziKwuXekmaYLlnt/m4J2p\nqcdSkMX0ynHGzoW+HhMgbSzKqOnIJ+fERI9DPEWRvCO+6WsJECcAfrRVSi3Odquw\nuPvCkwdIXXqBWUqc8rviTVXoTgXxmV1eNz1dwSqJfvWXm6vsBiLDMMb3WfX84X/C\ndZE7q7PBwwyCRjjdRcKrydD1jfUAlTK3mMfVVSSi5QbEfw4nqSfwc+6mLt1y3R3n\nZq0uU4bIwKnVi8McdxibiiOEWGWcB+wF5sjuP9wuteyJd52YgpCrq8bbCjtn0n6G\nnNct+Odl+vxov27S1ERL+c3x8/qyCGKbaBIcc7PQW5mU4V6OylTpEXqEPTU6kAM=\n=BBFO\n-----END PGP SIGNATURE-----\n", "payload": "tree 0d1e0f669217b452ad987024276fefe008bee236\nparent bb892be98edeced022881397b1d64b968943aea7\nparent 4a073dda936b2bc594056dca43c3ea51479435fe\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1556154324 +0200\ncommitter GitHub <noreply@github.com> 1556154324 +0200\n\nRollup merge of #60160 - xldenis:fix-overlapping-zero-width-annotation, r=estebank\n\nFix #58270, fix off-by-one error in error diagnostics.\n\nThis fixes #58270 by checking if two diagnostics overlap completely when we're calculating the line offset for each message.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a4ef188ab6008c6f600e06a7e01e81f75370d574", "html_url": "https://github.com/rust-lang/rust/commit/a4ef188ab6008c6f600e06a7e01e81f75370d574", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a4ef188ab6008c6f600e06a7e01e81f75370d574/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bb892be98edeced022881397b1d64b968943aea7", "url": "https://api.github.com/repos/rust-lang/rust/commits/bb892be98edeced022881397b1d64b968943aea7", "html_url": "https://github.com/rust-lang/rust/commit/bb892be98edeced022881397b1d64b968943aea7"}, {"sha": "4a073dda936b2bc594056dca43c3ea51479435fe", "url": "https://api.github.com/repos/rust-lang/rust/commits/4a073dda936b2bc594056dca43c3ea51479435fe", "html_url": "https://github.com/rust-lang/rust/commit/4a073dda936b2bc594056dca43c3ea51479435fe"}], "stats": {"total": 37, "additions": 19, "deletions": 18}, "files": [{"sha": "c3d594204f413de24eeeb0ab860a88c37a52170a", "filename": "src/librustc_errors/emitter.rs", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/a4ef188ab6008c6f600e06a7e01e81f75370d574/src%2Flibrustc_errors%2Femitter.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a4ef188ab6008c6f600e06a7e01e81f75370d574/src%2Flibrustc_errors%2Femitter.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_errors%2Femitter.rs?ref=a4ef188ab6008c6f600e06a7e01e81f75370d574", "patch": "@@ -268,6 +268,7 @@ impl EmitterWriter {\n                 // 6..7. This is degenerate input, but it's best to degrade\n                 // gracefully -- and the parser likes to supply a span like\n                 // that for EOF, in particular.\n+\n                 if lo.col_display == hi.col_display && lo.line == hi.line {\n                     hi.col_display += 1;\n                 }\n@@ -547,6 +548,15 @@ impl EmitterWriter {\n                     && j > i                      // multiline lines).\n                     && p == 0  // We're currently on the first line, move the label one line down\n                 {\n+                    // If we're overlapping with an un-labelled annotation with the same span\n+                    // we can just merge them in the output\n+                    if next.start_col == annotation.start_col\n+                    && next.end_col == annotation.end_col\n+                    && !next.has_label()\n+                    {\n+                        continue;\n+                    }\n+\n                     // This annotation needs a new line in the output.\n                     p += 1;\n                     break;"}, {"sha": "ac97d32a6e15b7f05e553b5f455adac50007656f", "filename": "src/test/ui/issue-60075.stderr", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a4ef188ab6008c6f600e06a7e01e81f75370d574/src%2Ftest%2Fui%2Fissue-60075.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a4ef188ab6008c6f600e06a7e01e81f75370d574/src%2Ftest%2Fui%2Fissue-60075.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissue-60075.stderr?ref=a4ef188ab6008c6f600e06a7e01e81f75370d574", "patch": "@@ -11,9 +11,7 @@ LL |     fn qux() -> Option<usize> {\n    |                               - unclosed delimiter\n LL |         let _ = if true {\n LL |         });\n-   |           ^\n-   |           |\n-   |           help: `}` may belong here\n+   |           ^ help: `}` may belong here\n \n error: expected identifier, found `;`\n   --> $DIR/issue-60075.rs:6:11"}, {"sha": "58ab0a142d6f1c29236c957da827a642ec2c74ea", "filename": "src/test/ui/issues/issue-58856-1.stderr", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/a4ef188ab6008c6f600e06a7e01e81f75370d574/src%2Ftest%2Fui%2Fissues%2Fissue-58856-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a4ef188ab6008c6f600e06a7e01e81f75370d574/src%2Ftest%2Fui%2Fissues%2Fissue-58856-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-58856-1.stderr?ref=a4ef188ab6008c6f600e06a7e01e81f75370d574", "patch": "@@ -2,9 +2,8 @@ error: expected one of `)`, `,`, or `:`, found `>`\n   --> $DIR/issue-58856-1.rs:2:14\n    |\n LL |     fn b(self>\n-   |         -    ^\n-   |         |    |\n-   |         |    help: `)` may belong here\n+   |         -    ^ help: `)` may belong here\n+   |         |\n    |         unclosed delimiter\n \n error: aborting due to previous error"}, {"sha": "b49ee0cfc7033407fcf9d2dd6b70ad4e0cf7ae5c", "filename": "src/test/ui/lifetimes/lifetime-errors/ex3-both-anon-regions-both-are-structs-3.stderr", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a4ef188ab6008c6f600e06a7e01e81f75370d574/src%2Ftest%2Fui%2Flifetimes%2Flifetime-errors%2Fex3-both-anon-regions-both-are-structs-3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a4ef188ab6008c6f600e06a7e01e81f75370d574/src%2Ftest%2Fui%2Flifetimes%2Flifetime-errors%2Fex3-both-anon-regions-both-are-structs-3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flifetimes%2Flifetime-errors%2Fex3-both-anon-regions-both-are-structs-3.stderr?ref=a4ef188ab6008c6f600e06a7e01e81f75370d574", "patch": "@@ -2,9 +2,7 @@ error[E0623]: lifetime mismatch\n   --> $DIR/ex3-both-anon-regions-both-are-structs-3.rs:7:11\n    |\n LL | fn foo(mut x: Ref) {\n-   |               ---\n-   |               |\n-   |               this type is declared with multiple lifetimes...\n+   |               --- this type is declared with multiple lifetimes...\n LL |     x.a = x.b;\n    |           ^^^ ...but data with one lifetime flows into the other here\n "}, {"sha": "5b9a9b7f06c39aa9fd06b551bf50509d27e9cc58", "filename": "src/test/ui/parser/issue-10636-2.stderr", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/a4ef188ab6008c6f600e06a7e01e81f75370d574/src%2Ftest%2Fui%2Fparser%2Fissue-10636-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a4ef188ab6008c6f600e06a7e01e81f75370d574/src%2Ftest%2Fui%2Fparser%2Fissue-10636-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissue-10636-2.stderr?ref=a4ef188ab6008c6f600e06a7e01e81f75370d574", "patch": "@@ -2,9 +2,8 @@ error: expected one of `)`, `,`, `.`, `?`, or an operator, found `;`\n   --> $DIR/issue-10636-2.rs:5:25\n    |\n LL |     option.map(|some| 42;\n-   |               -         ^\n-   |               |         |\n-   |               |         help: `)` may belong here\n+   |               -         ^ help: `)` may belong here\n+   |               |\n    |               unclosed delimiter\n \n error: expected expression, found `)`"}, {"sha": "6b3a488805f972ddfa1c7aaf91b744f955a01261", "filename": "src/test/ui/regions/regions-variance-contravariant-use-covariant-in-second-position.stderr", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a4ef188ab6008c6f600e06a7e01e81f75370d574/src%2Ftest%2Fui%2Fregions%2Fregions-variance-contravariant-use-covariant-in-second-position.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a4ef188ab6008c6f600e06a7e01e81f75370d574/src%2Ftest%2Fui%2Fregions%2Fregions-variance-contravariant-use-covariant-in-second-position.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fregions%2Fregions-variance-contravariant-use-covariant-in-second-position.stderr?ref=a4ef188ab6008c6f600e06a7e01e81f75370d574", "patch": "@@ -2,9 +2,7 @@ error[E0623]: lifetime mismatch\n   --> $DIR/regions-variance-contravariant-use-covariant-in-second-position.rs:25:30\n    |\n LL | fn use_<'short,'long>(c: S<'long, 'short>,\n-   |                          ----------------\n-   |                          |\n-   |                          this type is declared with multiple lifetimes...\n+   |                          ---------------- this type is declared with multiple lifetimes...\n ...\n LL |     let _: S<'long, 'long> = c;\n    |                              ^ ...but data with one lifetime flows into the other here"}, {"sha": "607573f27698b4af7e3734d4721b7dcadfbe504e", "filename": "src/test/ui/resolve/token-error-correct-3.stderr", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/a4ef188ab6008c6f600e06a7e01e81f75370d574/src%2Ftest%2Fui%2Fresolve%2Ftoken-error-correct-3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a4ef188ab6008c6f600e06a7e01e81f75370d574/src%2Ftest%2Fui%2Fresolve%2Ftoken-error-correct-3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fresolve%2Ftoken-error-correct-3.stderr?ref=a4ef188ab6008c6f600e06a7e01e81f75370d574", "patch": "@@ -2,9 +2,8 @@ error: expected one of `)`, `,`, `.`, `?`, or an operator, found `;`\n   --> $DIR/token-error-correct-3.rs:15:35\n    |\n LL |             callback(path.as_ref();\n-   |                     -             ^\n-   |                     |             |\n-   |                     |             help: `)` may belong here\n+   |                     -             ^ help: `)` may belong here\n+   |                     |\n    |                     unclosed delimiter\n \n error: expected one of `.`, `;`, `?`, `}`, or an operator, found `)`"}]}