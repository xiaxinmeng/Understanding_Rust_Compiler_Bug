{"sha": "d7ba66bf44f993e64114e17cc15f1b0d56ae8f70", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ3YmE2NmJmNDRmOTkzZTY0MTE0ZTE3Y2MxNWYxYjBkNTZhZThmNzA=", "commit": {"author": {"name": "mcarton", "email": "cartonmartin+git@gmail.com", "date": "2016-06-08T19:48:10Z"}, "committer": {"name": "mcarton", "email": "cartonmartin+git@gmail.com", "date": "2016-06-08T19:53:58Z"}, "message": "Automatically defines the `clippy` feature", "tree": {"sha": "e1ff1ad505c3924f302d8757c21a07646261dd60", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e1ff1ad505c3924f302d8757c21a07646261dd60"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d7ba66bf44f993e64114e17cc15f1b0d56ae8f70", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v2\n\niQIcBAABCAAGBQJXWHfYAAoJEF5CfHlMukXo5joP/2HxzWWPDOh4/b4SU4JnMWtC\nYB3ThD/8wLR1O3NVYJoVagJksnyr2E67a1Qmv400HRIwbO1Bp1EayimNepc6lz1T\nYv96CQzeQOMetXvuCimXBnEv7mTzw5okNwWII9d88MCEnIKBDDuxWBRwGwGkyDxD\nzSb30NgzLGG2RjCuCVGuG74ZR2UP0MHgLrXNEuuQL6kX4fq7e08g8/HTezZeG14Q\nWD8rscmVeHgFq7XVCYv5m7u+AcXXWxRr1ewBx/oKKKNiUomqSyGV7DOnrDyWybRu\nYm1zLozdDINVLLC+eDUQcI5Mxzn+U+WGa6vWU3A9anL9YBaYM5fv5T3XSrLvUScm\nB0FV6F/NZ7nHo4vVuizRD2H5lzy4UZDtgC1UzvHaudCLp05NaxeqJSjIWxY5J+G1\nwIhIqPA5qdJSKVtwLC3io2FEChqjWyBlPNMcHCsc/d/0LG3AY/ZHH39XwxiVQkQo\nO4A/I5Pa8ssh7aSrUgtz5uXIzfxqlGjlPqfyCWrtTzrCD+IO4GfyZfYSMyjO/FjF\nJWAZlbgm8+a3BCVtFgxp3XJpFXN2wU01g8ZfgqQv09lcbxktXE4hvdcEyC4NV7cf\nfI+gSgUc3tAFA8KLVPxV/AT5DSsLu8FOVqjA7wi47XbQFhDNO8zOLNkXyx3+0ZbY\nD1hVefjrpKCOiDISOT1w\n=LPZe\n-----END PGP SIGNATURE-----", "payload": "tree e1ff1ad505c3924f302d8757c21a07646261dd60\nparent 94cc344b07382cdd18c4c95142aa8818e0d19557\nauthor mcarton <cartonmartin+git@gmail.com> 1465415290 +0200\ncommitter mcarton <cartonmartin+git@gmail.com> 1465415638 +0200\n\nAutomatically defines the `clippy` feature\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d7ba66bf44f993e64114e17cc15f1b0d56ae8f70", "html_url": "https://github.com/rust-lang/rust/commit/d7ba66bf44f993e64114e17cc15f1b0d56ae8f70", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d7ba66bf44f993e64114e17cc15f1b0d56ae8f70/comments", "author": {"login": "mcarton", "id": 3751788, "node_id": "MDQ6VXNlcjM3NTE3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/3751788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mcarton", "html_url": "https://github.com/mcarton", "followers_url": "https://api.github.com/users/mcarton/followers", "following_url": "https://api.github.com/users/mcarton/following{/other_user}", "gists_url": "https://api.github.com/users/mcarton/gists{/gist_id}", "starred_url": "https://api.github.com/users/mcarton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mcarton/subscriptions", "organizations_url": "https://api.github.com/users/mcarton/orgs", "repos_url": "https://api.github.com/users/mcarton/repos", "events_url": "https://api.github.com/users/mcarton/events{/privacy}", "received_events_url": "https://api.github.com/users/mcarton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mcarton", "id": 3751788, "node_id": "MDQ6VXNlcjM3NTE3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/3751788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mcarton", "html_url": "https://github.com/mcarton", "followers_url": "https://api.github.com/users/mcarton/followers", "following_url": "https://api.github.com/users/mcarton/following{/other_user}", "gists_url": "https://api.github.com/users/mcarton/gists{/gist_id}", "starred_url": "https://api.github.com/users/mcarton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mcarton/subscriptions", "organizations_url": "https://api.github.com/users/mcarton/orgs", "repos_url": "https://api.github.com/users/mcarton/repos", "events_url": "https://api.github.com/users/mcarton/events{/privacy}", "received_events_url": "https://api.github.com/users/mcarton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "94cc344b07382cdd18c4c95142aa8818e0d19557", "url": "https://api.github.com/repos/rust-lang/rust/commits/94cc344b07382cdd18c4c95142aa8818e0d19557", "html_url": "https://github.com/rust-lang/rust/commit/94cc344b07382cdd18c4c95142aa8818e0d19557"}], "stats": {"total": 49, "additions": 32, "deletions": 17}, "files": [{"sha": "4009246507c261cfd02dba424a5eb6a46f21160e", "filename": "CHANGELOG.md", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d7ba66bf44f993e64114e17cc15f1b0d56ae8f70/CHANGELOG.md", "raw_url": "https://github.com/rust-lang/rust/raw/d7ba66bf44f993e64114e17cc15f1b0d56ae8f70/CHANGELOG.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/CHANGELOG.md?ref=d7ba66bf44f993e64114e17cc15f1b0d56ae8f70", "patch": "@@ -1,6 +1,9 @@\n # Change Log\n All notable changes to this project will be documented in this file.\n \n+## 0.0.76 \u2014 TBD\n+* `cargo clippy` now automatically defines the `clippy` feature\n+\n ## 0.0.75 \u2014 2016-06-08\n * Rustup to *rustc 1.11.0-nightly (763f9234b 2016-06-06)*\n "}, {"sha": "2e40f6ed74c5642617d757f4e0a535476fcb5bbb", "filename": "README.md", "status": "modified", "additions": 23, "deletions": 16, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/d7ba66bf44f993e64114e17cc15f1b0d56ae8f70/README.md", "raw_url": "https://github.com/rust-lang/rust/raw/d7ba66bf44f993e64114e17cc15f1b0d56ae8f70/README.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/README.md?ref=d7ba66bf44f993e64114e17cc15f1b0d56ae8f70", "patch": "@@ -245,22 +245,6 @@ similar crates.\n SYSROOT=/path/to/rustc/sysroot cargo install clippy\n ```\n \n-### Configuring clippy\n-\n-You can add options  to `allow`/`warn`/`deny`:\n-\n-*   the whole set of `Warn` lints using the `clippy` lint group (`#![deny(clippy)]`)\n-\n-*   all lints using both the `clippy` and `clippy_pedantic` lint groups (`#![deny(clippy)]`,\n-    `#![deny(clippy_pedantic)]`). Note that `clippy_pedantic` contains some very aggressive\n-    lints prone to false positives.\n-\n-*   only some lints (`#![deny(single_match, box_vec)]`, etc)\n-\n-*   `allow`/`warn`/`deny` can be limited to a single function or module using `#[allow(...)]`, etc\n-\n-Note: `deny` produces errors instead of warnings\n-\n ### Running clippy from the command line without installing\n \n To have cargo compile your crate with clippy without needing `#![plugin(clippy)]`\n@@ -321,6 +305,29 @@ You can also specify the path to the configuration file with:\n To deactivate the \u201cfor further information visit *wiki-link*\u201d message you can\n define the `CLIPPY_DISABLE_WIKI_LINKS` environment variable.\n \n+### Allowing/denying lints\n+\n+You can add options  to `allow`/`warn`/`deny`:\n+\n+*   the whole set of `Warn` lints using the `clippy` lint group (`#![deny(clippy)]`)\n+\n+*   all lints using both the `clippy` and `clippy_pedantic` lint groups (`#![deny(clippy)]`,\n+    `#![deny(clippy_pedantic)]`). Note that `clippy_pedantic` contains some very aggressive\n+    lints prone to false positives.\n+\n+*   only some lints (`#![deny(single_match, box_vec)]`, etc)\n+\n+*   `allow`/`warn`/`deny` can be limited to a single function or module using `#[allow(...)]`, etc\n+\n+Note: `deny` produces errors instead of warnings.\n+\n+For convenience, `cargo clippy` automatically defines a `clippy` features. This\n+lets you set lints level and compile with or without clippy transparently:\n+\n+```rust\n+#[cfg_attr(feature = \"clippy\", allow(needless_lifetimes))]\n+```\n+\n ## Link with clippy service\n \n `clippy-service` is a rust web initiative providing `rust-clippy` as a web service."}, {"sha": "43483e76a0fda28f000f4c87ea27fe050fe18590", "filename": "src/main.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/d7ba66bf44f993e64114e17cc15f1b0d56ae8f70/src%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d7ba66bf44f993e64114e17cc15f1b0d56ae8f70/src%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmain.rs?ref=d7ba66bf44f993e64114e17cc15f1b0d56ae8f70", "patch": "@@ -141,11 +141,14 @@ pub fn main() {\n             }\n         }\n     } else {\n-        let args: Vec<String> = if env::args().any(|s| s == \"--sysroot\") {\n+        let mut args: Vec<String> = if env::args().any(|s| s == \"--sysroot\") {\n             env::args().collect()\n         } else {\n             env::args().chain(Some(\"--sysroot\".to_owned())).chain(Some(sys_root)).collect()\n         };\n+\n+        args.extend_from_slice(&[\"--cfg\".to_owned(), r#\"feature=\"clippy\"\"#.to_owned()]);\n+\n         let (result, _) = rustc_driver::run_compiler(&args, &mut ClippyCompilerCalls::new());\n \n         if let Err(err_count) = result {\n@@ -174,6 +177,8 @@ fn process<P, I>(old_args: I, dep_path: P, sysroot: &str) -> Result<(), i32>\n     args.push(String::from(\"--sysroot\"));\n     args.push(sysroot.to_owned());\n     args.push(\"-Zno-trans\".to_owned());\n+    args.push(\"--cfg\".to_owned());\n+    args.push(r#\"feature=\"clippy\"\"#.to_owned());\n \n     let path = std::env::current_exe().expect(\"current executable path invalid\");\n     let exit_status = std::process::Command::new(\"cargo\")"}]}