{"sha": "8a2b7a5c19d4ae83c883065b4ee53b450d45afce", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhhMmI3YTVjMTlkNGFlODNjODgzMDY1YjRlZTUzYjQ1MGQ0NWFmY2U=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-07-12T04:16:44Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-07-12T04:16:44Z"}, "message": "auto merge of #15597 : brson/rust/ldconfig, r=pcwalton\n\nIf ldconfig fails it emits a warning. This is very possible when installing\r\nto a non-system directory, so the warning tries to indicate that it may\r\nnot be a problem.", "tree": {"sha": "edd43a3ec9b31c0484849d723369e846e0754933", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/edd43a3ec9b31c0484849d723369e846e0754933"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8a2b7a5c19d4ae83c883065b4ee53b450d45afce", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8a2b7a5c19d4ae83c883065b4ee53b450d45afce", "html_url": "https://github.com/rust-lang/rust/commit/8a2b7a5c19d4ae83c883065b4ee53b450d45afce", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8a2b7a5c19d4ae83c883065b4ee53b450d45afce/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5ad7286dc37839b7234ff51aab172e48935869d8", "url": "https://api.github.com/repos/rust-lang/rust/commits/5ad7286dc37839b7234ff51aab172e48935869d8", "html_url": "https://github.com/rust-lang/rust/commit/5ad7286dc37839b7234ff51aab172e48935869d8"}, {"sha": "96418569641eecbb5d87a790ce4300658d46fd46", "url": "https://api.github.com/repos/rust-lang/rust/commits/96418569641eecbb5d87a790ce4300658d46fd46", "html_url": "https://github.com/rust-lang/rust/commit/96418569641eecbb5d87a790ce4300658d46fd46"}], "stats": {"total": 15, "additions": 12, "deletions": 3}, "files": [{"sha": "c949743ea75949f4bd84b4e1b6812b391ec7f5d9", "filename": "src/etc/install.sh", "status": "modified", "additions": 12, "deletions": 3, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/8a2b7a5c19d4ae83c883065b4ee53b450d45afce/src%2Fetc%2Finstall.sh", "raw_url": "https://github.com/rust-lang/rust/raw/8a2b7a5c19d4ae83c883065b4ee53b450d45afce/src%2Fetc%2Finstall.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Finstall.sh?ref=8a2b7a5c19d4ae83c883065b4ee53b450d45afce", "patch": "@@ -466,6 +466,17 @@ while read p; do\n # The manifest lists all files to install\n done < \"${CFG_SRC_DIR}/${CFG_LIBDIR_RELATIVE}/rustlib/manifest.in\"\n \n+# Run ldconfig to make dynamic libraries available to the linker\n+if [ \"$CFG_OSTYPE\" = \"Linux\" ]\n+    then\n+    ldconfig\n+    if [ $? -ne 0 ]\n+    then\n+        warn \"failed to run ldconfig.\"\n+        warn \"this may happen when not installing as root and may be fine\"\n+    fi\n+fi\n+\n # Sanity check: can we run the installed binaries?\n #\n # As with the verification above, make sure the right LD_LIBRARY_PATH-equivalent\n@@ -489,13 +500,11 @@ then\n             err \"${ERR}\"\n         else\n             echo\n-            echo \"    please ensure '${CFG_PREFIX}/lib' is added to ${CFG_LD_PATH_VAR}\"\n-            echo\n+            echo \"    Note: please ensure '${CFG_PREFIX}/lib' is added to ${CFG_LD_PATH_VAR}\"\n         fi\n     fi\n fi\n \n-\n echo\n echo \"    Rust is ready to roll.\"\n echo"}]}