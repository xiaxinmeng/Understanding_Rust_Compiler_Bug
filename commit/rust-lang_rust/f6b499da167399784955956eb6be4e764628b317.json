{"sha": "f6b499da167399784955956eb6be4e764628b317", "node_id": "C_kwDOAAsO6NoAKGY2YjQ5OWRhMTY3Mzk5Nzg0OTU1OTU2ZWI2YmU0ZTc2NDYyOGIzMTc", "commit": {"author": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2021-11-30T06:14:38Z"}, "committer": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2021-11-30T06:20:34Z"}, "message": "Suggest the `pat_param` specifier before `|` on 2021 edition\n\nWe have a migration warning but no lint for users who have enabled the\nnew edition.", "tree": {"sha": "6d9bd8a978d33a56ef52bcc4419c09582b2bb7b9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6d9bd8a978d33a56ef52bcc4419c09582b2bb7b9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f6b499da167399784955956eb6be4e764628b317", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f6b499da167399784955956eb6be4e764628b317", "html_url": "https://github.com/rust-lang/rust/commit/f6b499da167399784955956eb6be4e764628b317", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f6b499da167399784955956eb6be4e764628b317/comments", "author": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6db0a0e9a4a2f55b1a85954e114ada0b45c32e45", "url": "https://api.github.com/repos/rust-lang/rust/commits/6db0a0e9a4a2f55b1a85954e114ada0b45c32e45", "html_url": "https://github.com/rust-lang/rust/commit/6db0a0e9a4a2f55b1a85954e114ada0b45c32e45"}], "stats": {"total": 18, "additions": 18, "deletions": 0}, "files": [{"sha": "537a10e98e59de2dcf0c11c0beac366c47de7511", "filename": "compiler/rustc_expand/src/mbe/macro_rules.rs", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/f6b499da167399784955956eb6be4e764628b317/compiler%2Frustc_expand%2Fsrc%2Fmbe%2Fmacro_rules.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f6b499da167399784955956eb6be4e764628b317/compiler%2Frustc_expand%2Fsrc%2Fmbe%2Fmacro_rules.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_expand%2Fsrc%2Fmbe%2Fmacro_rules.rs?ref=f6b499da167399784955956eb6be4e764628b317", "patch": "@@ -1027,6 +1027,24 @@ fn check_matcher_core(\n                                 ),\n                             );\n                             err.span_label(sp, format!(\"not allowed after `{}` fragments\", kind));\n+\n+                            if kind == NonterminalKind::PatWithOr\n+                                && sess.edition == Edition::Edition2021\n+                                && next_token.is_token(&BinOp(token::BinOpToken::Or))\n+                            {\n+                                let suggestion = quoted_tt_to_string(&TokenTree::MetaVarDecl(\n+                                    span,\n+                                    name,\n+                                    Some(NonterminalKind::PatParam { inferred: false }),\n+                                ));\n+                                err.span_suggestion(\n+                                    span,\n+                                    &format!(\"try a `pat_param` fragment specifier instead\"),\n+                                    suggestion,\n+                                    Applicability::MaybeIncorrect,\n+                                );\n+                            }\n+\n                             let msg = \"allowed there are: \";\n                             match possible {\n                                 &[] => {}"}]}