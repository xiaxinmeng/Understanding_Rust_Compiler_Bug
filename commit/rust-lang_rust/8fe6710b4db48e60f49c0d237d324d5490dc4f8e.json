{"sha": "8fe6710b4db48e60f49c0d237d324d5490dc4f8e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhmZTY3MTBiNGRiNDhlNjBmNDljMGQyMzdkMzI0ZDU0OTBkYzRmOGU=", "commit": {"author": {"name": "Camelid", "email": "camelidcamel@gmail.com", "date": "2020-06-16T19:43:03Z"}, "committer": {"name": "Camelid", "email": "camelidcamel@gmail.com", "date": "2020-06-20T18:12:43Z"}, "message": "Create a separate, tool-only suggestion for the comma\n\nThat way the comma isn't highlighted as part of the option in the UI.\n\nWeirdly, the comma removal suggestion shows up in the UI.", "tree": {"sha": "e08b7bd02c3469762e73a18e15b97f07c71ef49d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e08b7bd02c3469762e73a18e15b97f07c71ef49d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8fe6710b4db48e60f49c0d237d324d5490dc4f8e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8fe6710b4db48e60f49c0d237d324d5490dc4f8e", "html_url": "https://github.com/rust-lang/rust/commit/8fe6710b4db48e60f49c0d237d324d5490dc4f8e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8fe6710b4db48e60f49c0d237d324d5490dc4f8e/comments", "author": {"login": "camelid", "id": 37223377, "node_id": "MDQ6VXNlcjM3MjIzMzc3", "avatar_url": "https://avatars.githubusercontent.com/u/37223377?v=4", "gravatar_id": "", "url": "https://api.github.com/users/camelid", "html_url": "https://github.com/camelid", "followers_url": "https://api.github.com/users/camelid/followers", "following_url": "https://api.github.com/users/camelid/following{/other_user}", "gists_url": "https://api.github.com/users/camelid/gists{/gist_id}", "starred_url": "https://api.github.com/users/camelid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/camelid/subscriptions", "organizations_url": "https://api.github.com/users/camelid/orgs", "repos_url": "https://api.github.com/users/camelid/repos", "events_url": "https://api.github.com/users/camelid/events{/privacy}", "received_events_url": "https://api.github.com/users/camelid/received_events", "type": "User", "site_admin": false}, "committer": {"login": "camelid", "id": 37223377, "node_id": "MDQ6VXNlcjM3MjIzMzc3", "avatar_url": "https://avatars.githubusercontent.com/u/37223377?v=4", "gravatar_id": "", "url": "https://api.github.com/users/camelid", "html_url": "https://github.com/camelid", "followers_url": "https://api.github.com/users/camelid/followers", "following_url": "https://api.github.com/users/camelid/following{/other_user}", "gists_url": "https://api.github.com/users/camelid/gists{/gist_id}", "starred_url": "https://api.github.com/users/camelid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/camelid/subscriptions", "organizations_url": "https://api.github.com/users/camelid/orgs", "repos_url": "https://api.github.com/users/camelid/repos", "events_url": "https://api.github.com/users/camelid/events{/privacy}", "received_events_url": "https://api.github.com/users/camelid/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4ba66970d87684fa412a6475bf68ed6042c9e1e9", "url": "https://api.github.com/repos/rust-lang/rust/commits/4ba66970d87684fa412a6475bf68ed6042c9e1e9", "html_url": "https://github.com/rust-lang/rust/commit/4ba66970d87684fa412a6475bf68ed6042c9e1e9"}], "stats": {"total": 14, "additions": 9, "deletions": 5}, "files": [{"sha": "1d59029333db0034544049e74345f82e37bd0999", "filename": "src/librustc_builtin_macros/asm.rs", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/8fe6710b4db48e60f49c0d237d324d5490dc4f8e/src%2Flibrustc_builtin_macros%2Fasm.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8fe6710b4db48e60f49c0d237d324d5490dc4f8e/src%2Flibrustc_builtin_macros%2Fasm.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_builtin_macros%2Fasm.rs?ref=8fe6710b4db48e60f49c0d237d324d5490dc4f8e", "patch": "@@ -294,6 +294,14 @@ fn err_duplicate_option<'a>(p: &mut Parser<'a>, symbol: Symbol, span: Span) {\n         String::new(),\n         Applicability::MachineApplicable,\n     );\n+    if p.look_ahead(0, |t| t == &token::Comma) {\n+        err.tool_only_span_suggestion(\n+            p.token.span,\n+            \"remove this comma\",\n+            String::new(),\n+            Applicability::MachineApplicable,\n+        );\n+    }\n     err.emit();\n }\n \n@@ -306,11 +314,7 @@ fn try_set_option<'a>(\n     if !args.options.contains(option) {\n         args.options |= option;\n     } else {\n-        let mut span = p.prev_token.span;\n-        if p.look_ahead(0, |t| t == &token::Comma) {\n-            span = span.to(p.token.span);\n-        }\n-        err_duplicate_option(p, symbol, span);\n+        err_duplicate_option(p, symbol, p.prev_token.span);\n     }\n }\n "}]}