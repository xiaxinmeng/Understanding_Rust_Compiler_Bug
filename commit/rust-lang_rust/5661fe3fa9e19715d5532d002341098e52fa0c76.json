{"sha": "5661fe3fa9e19715d5532d002341098e52fa0c76", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU2NjFmZTNmYTllMTk3MTVkNTUzMmQwMDIzNDEwOThlNTJmYTBjNzY=", "commit": {"author": {"name": "Lucas De Angelis", "email": "deangelis.lucas@outlook.com", "date": "2021-02-26T21:09:39Z"}, "committer": {"name": "Lucas De Angelis", "email": "deangelis.lucas@outlook.com", "date": "2021-02-26T21:09:39Z"}, "message": "Fix intra-doc handling of `Self` in enum\n\nFixes #82209", "tree": {"sha": "8d2afc557f18a271b020465aca4f6e2ae3e54e85", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8d2afc557f18a271b020465aca4f6e2ae3e54e85"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5661fe3fa9e19715d5532d002341098e52fa0c76", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5661fe3fa9e19715d5532d002341098e52fa0c76", "html_url": "https://github.com/rust-lang/rust/commit/5661fe3fa9e19715d5532d002341098e52fa0c76", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5661fe3fa9e19715d5532d002341098e52fa0c76/comments", "author": {"login": "lucas-deangelis", "id": 55180995, "node_id": "MDQ6VXNlcjU1MTgwOTk1", "avatar_url": "https://avatars.githubusercontent.com/u/55180995?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lucas-deangelis", "html_url": "https://github.com/lucas-deangelis", "followers_url": "https://api.github.com/users/lucas-deangelis/followers", "following_url": "https://api.github.com/users/lucas-deangelis/following{/other_user}", "gists_url": "https://api.github.com/users/lucas-deangelis/gists{/gist_id}", "starred_url": "https://api.github.com/users/lucas-deangelis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lucas-deangelis/subscriptions", "organizations_url": "https://api.github.com/users/lucas-deangelis/orgs", "repos_url": "https://api.github.com/users/lucas-deangelis/repos", "events_url": "https://api.github.com/users/lucas-deangelis/events{/privacy}", "received_events_url": "https://api.github.com/users/lucas-deangelis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lucas-deangelis", "id": 55180995, "node_id": "MDQ6VXNlcjU1MTgwOTk1", "avatar_url": "https://avatars.githubusercontent.com/u/55180995?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lucas-deangelis", "html_url": "https://github.com/lucas-deangelis", "followers_url": "https://api.github.com/users/lucas-deangelis/followers", "following_url": "https://api.github.com/users/lucas-deangelis/following{/other_user}", "gists_url": "https://api.github.com/users/lucas-deangelis/gists{/gist_id}", "starred_url": "https://api.github.com/users/lucas-deangelis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lucas-deangelis/subscriptions", "organizations_url": "https://api.github.com/users/lucas-deangelis/orgs", "repos_url": "https://api.github.com/users/lucas-deangelis/repos", "events_url": "https://api.github.com/users/lucas-deangelis/events{/privacy}", "received_events_url": "https://api.github.com/users/lucas-deangelis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cecdb181ade91c0a5ffab9a148dba68fc7d00ee3", "url": "https://api.github.com/repos/rust-lang/rust/commits/cecdb181ade91c0a5ffab9a148dba68fc7d00ee3", "html_url": "https://github.com/rust-lang/rust/commit/cecdb181ade91c0a5ffab9a148dba68fc7d00ee3"}], "stats": {"total": 11, "additions": 11, "deletions": 0}, "files": [{"sha": "2e1197b3fe7b6ace10625ca5cbdb162e8175fc29", "filename": "src/librustdoc/passes/collect_intra_doc_links.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/5661fe3fa9e19715d5532d002341098e52fa0c76/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5661fe3fa9e19715d5532d002341098e52fa0c76/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs?ref=5661fe3fa9e19715d5532d002341098e52fa0c76", "patch": "@@ -838,6 +838,9 @@ impl<'a, 'tcx> DocFolder for LinkCollector<'a, 'tcx> {\n         debug!(\"looking for the `Self` type\");\n         let self_id = if item.is_fake() {\n             None\n+        // Checking if the item is a field in a variant in an enum\n+        } else if (matches!(self.cx.tcx.def_kind(item.def_id), DefKind::Field) && matches!(self.cx.tcx.def_kind(self.cx.tcx.parent(item.def_id).unwrap()), DefKind::Variant)) {\n+            self.cx.tcx.parent(item.def_id).and_then(|item_id| self.cx.tcx.parent(item_id))\n         } else if matches!(\n             self.cx.tcx.def_kind(item.def_id),\n             DefKind::AssocConst"}, {"sha": "72a585a705eef6de2315fe69e9536614be5c3c18", "filename": "src/test/rustdoc/issue-82209.rs", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/5661fe3fa9e19715d5532d002341098e52fa0c76/src%2Ftest%2Frustdoc%2Fissue-82209.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5661fe3fa9e19715d5532d002341098e52fa0c76/src%2Ftest%2Frustdoc%2Fissue-82209.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fissue-82209.rs?ref=5661fe3fa9e19715d5532d002341098e52fa0c76", "patch": "@@ -0,0 +1,8 @@\n+#![deny(broken_intra_doc_links)]\n+pub enum Foo {\n+    Bar {\n+        abc: i32,\n+        /// [Self::Bar::abc]\n+        xyz: i32,\n+    },\n+}"}]}