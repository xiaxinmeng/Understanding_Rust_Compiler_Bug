{"sha": "042e1e027974eadc164b875b4a0ab197dd9988cb", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA0MmUxZTAyNzk3NGVhZGMxNjRiODc1YjRhMGFiMTk3ZGQ5OTg4Y2I=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-04-20T14:11:05Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-04-20T14:11:05Z"}, "message": "Fix #50113: must explicitly request file name when using with_file_name.", "tree": {"sha": "cd804dafe0f298f148ab5794f01eb2016f0a4acf", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cd804dafe0f298f148ab5794f01eb2016f0a4acf"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/042e1e027974eadc164b875b4a0ab197dd9988cb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/042e1e027974eadc164b875b4a0ab197dd9988cb", "html_url": "https://github.com/rust-lang/rust/commit/042e1e027974eadc164b875b4a0ab197dd9988cb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/042e1e027974eadc164b875b4a0ab197dd9988cb/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "85f5dd489ea1cb93707ba1ddf4a7678d3aee3f74", "url": "https://api.github.com/repos/rust-lang/rust/commits/85f5dd489ea1cb93707ba1ddf4a7678d3aee3f74", "html_url": "https://github.com/rust-lang/rust/commit/85f5dd489ea1cb93707ba1ddf4a7678d3aee3f74"}], "stats": {"total": 6, "additions": 4, "deletions": 2}, "files": [{"sha": "0f4d247633a61b46016c27b0b8b860475d3aa19b", "filename": "src/tools/compiletest/src/runtest.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/042e1e027974eadc164b875b4a0ab197dd9988cb/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/042e1e027974eadc164b875b4a0ab197dd9988cb/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs?ref=042e1e027974eadc164b875b4a0ab197dd9988cb", "patch": "@@ -2880,8 +2880,10 @@ impl<'test> TestCx<'test> {\n             }\n         }\n \n-        let expected_output_path = self.expected_output_path(kind);\n-        let output_file = self.output_base_name().with_file_name(&expected_output_path);\n+        let expected_output = self.expected_output_path(kind);\n+        // #50113: output is abspath; only want filename component.\n+        let expected_output = expected_output.file_name().expect(\"output path requires file name\");\n+        let output_file = self.output_base_name().with_file_name(&expected_output);\n         match File::create(&output_file).and_then(|mut f| f.write_all(actual.as_bytes())) {\n             Ok(()) => {}\n             Err(e) => self.fatal(&format!("}]}