{"sha": "c9932b395ada3c367aea5e79645c10657262ea6f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM5OTMyYjM5NWFkYTNjMzY3YWVhNWU3OTY0NWMxMDY1NzI2MmVhNmY=", "commit": {"author": {"name": "Ryan Scott", "email": "ryan@ryan-scott.me", "date": "2017-04-07T03:20:37Z"}, "committer": {"name": "Ryan Scott", "email": "ryan@ryan-scott.me", "date": "2017-04-07T03:20:37Z"}, "message": "Changes based on PR feedback", "tree": {"sha": "5514a7dc3628724a4246f4d0a6b63ae5ad0241e8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5514a7dc3628724a4246f4d0a6b63ae5ad0241e8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c9932b395ada3c367aea5e79645c10657262ea6f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c9932b395ada3c367aea5e79645c10657262ea6f", "html_url": "https://github.com/rust-lang/rust/commit/c9932b395ada3c367aea5e79645c10657262ea6f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c9932b395ada3c367aea5e79645c10657262ea6f/comments", "author": {"login": "ryan-scott-dev", "id": 1508992, "node_id": "MDQ6VXNlcjE1MDg5OTI=", "avatar_url": "https://avatars.githubusercontent.com/u/1508992?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ryan-scott-dev", "html_url": "https://github.com/ryan-scott-dev", "followers_url": "https://api.github.com/users/ryan-scott-dev/followers", "following_url": "https://api.github.com/users/ryan-scott-dev/following{/other_user}", "gists_url": "https://api.github.com/users/ryan-scott-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/ryan-scott-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ryan-scott-dev/subscriptions", "organizations_url": "https://api.github.com/users/ryan-scott-dev/orgs", "repos_url": "https://api.github.com/users/ryan-scott-dev/repos", "events_url": "https://api.github.com/users/ryan-scott-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/ryan-scott-dev/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ryan-scott-dev", "id": 1508992, "node_id": "MDQ6VXNlcjE1MDg5OTI=", "avatar_url": "https://avatars.githubusercontent.com/u/1508992?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ryan-scott-dev", "html_url": "https://github.com/ryan-scott-dev", "followers_url": "https://api.github.com/users/ryan-scott-dev/followers", "following_url": "https://api.github.com/users/ryan-scott-dev/following{/other_user}", "gists_url": "https://api.github.com/users/ryan-scott-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/ryan-scott-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ryan-scott-dev/subscriptions", "organizations_url": "https://api.github.com/users/ryan-scott-dev/orgs", "repos_url": "https://api.github.com/users/ryan-scott-dev/repos", "events_url": "https://api.github.com/users/ryan-scott-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/ryan-scott-dev/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e753dfa9a945043c7c465fc3f1e9389585e096d0", "url": "https://api.github.com/repos/rust-lang/rust/commits/e753dfa9a945043c7c465fc3f1e9389585e096d0", "html_url": "https://github.com/rust-lang/rust/commit/e753dfa9a945043c7c465fc3f1e9389585e096d0"}], "stats": {"total": 9, "additions": 2, "deletions": 7}, "files": [{"sha": "8eabe92fb98c005a7a4beec26e456b02e9791f47", "filename": "src/librustc_mir/transform/qualify_consts.rs", "status": "modified", "additions": 2, "deletions": 7, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/c9932b395ada3c367aea5e79645c10657262ea6f/src%2Flibrustc_mir%2Ftransform%2Fqualify_consts.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c9932b395ada3c367aea5e79645c10657262ea6f/src%2Flibrustc_mir%2Ftransform%2Fqualify_consts.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Ftransform%2Fqualify_consts.rs?ref=c9932b395ada3c367aea5e79645c10657262ea6f", "patch": "@@ -603,7 +603,8 @@ impl<'a, 'tcx> Visitor<'tcx> for Qualifier<'a, 'tcx, 'tcx> {\n             Rvalue::Cast(CastKind::ReifyFnPointer, ..) |\n             Rvalue::Cast(CastKind::UnsafeFnPointer, ..) |\n             Rvalue::Cast(CastKind::ClosureFnPointer, ..) |\n-            Rvalue::Cast(CastKind::Unsize, ..) => {}\n+            Rvalue::Cast(CastKind::Unsize, ..) |\n+            Rvalue::Discriminant(..) => {}\n \n             Rvalue::Len(_) => {\n                 // Static lvalues in consts would have errored already,\n@@ -721,12 +722,6 @@ impl<'a, 'tcx> Visitor<'tcx> for Qualifier<'a, 'tcx, 'tcx> {\n                 }\n             }\n \n-            Rvalue::Discriminant(..) => {\n-                // FIXME implement discriminant const qualify\n-                self.add(Qualif::NOT_CONST);\n-                // Discriminants in consts will error elsewhere as an unimplemented expression type\n-            }\n-\n             Rvalue::Box(_) => {\n                 self.add(Qualif::NOT_CONST);\n                 if self.mode != Mode::Fn {"}]}