{"sha": "ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJhODNiMzlkNGU1M2Y0MTIzMzlmMWFmOGM0ZjdjYmU4MGViMWVlNmU=", "commit": {"author": {"name": "Anton Golov", "email": "jesyspa@gmail.com", "date": "2021-08-20T13:59:42Z"}, "committer": {"name": "Anton Golov", "email": "jesyspa@gmail.com", "date": "2021-08-20T13:59:42Z"}, "message": "Change example and tests for E0161.\n\nThe code will not emit this warning once box expressions require a sized\ntype (since that error is emitted earlier in the flow).", "tree": {"sha": "c11a2fb9f402635539bcce590aa8e19932e0ee63", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c11a2fb9f402635539bcce590aa8e19932e0ee63"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e", "html_url": "https://github.com/rust-lang/rust/commit/ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e/comments", "author": {"login": "jesyspa", "id": 543293, "node_id": "MDQ6VXNlcjU0MzI5Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/543293?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jesyspa", "html_url": "https://github.com/jesyspa", "followers_url": "https://api.github.com/users/jesyspa/followers", "following_url": "https://api.github.com/users/jesyspa/following{/other_user}", "gists_url": "https://api.github.com/users/jesyspa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jesyspa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jesyspa/subscriptions", "organizations_url": "https://api.github.com/users/jesyspa/orgs", "repos_url": "https://api.github.com/users/jesyspa/repos", "events_url": "https://api.github.com/users/jesyspa/events{/privacy}", "received_events_url": "https://api.github.com/users/jesyspa/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jesyspa", "id": 543293, "node_id": "MDQ6VXNlcjU0MzI5Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/543293?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jesyspa", "html_url": "https://github.com/jesyspa", "followers_url": "https://api.github.com/users/jesyspa/followers", "following_url": "https://api.github.com/users/jesyspa/following{/other_user}", "gists_url": "https://api.github.com/users/jesyspa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jesyspa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jesyspa/subscriptions", "organizations_url": "https://api.github.com/users/jesyspa/orgs", "repos_url": "https://api.github.com/users/jesyspa/repos", "events_url": "https://api.github.com/users/jesyspa/events{/privacy}", "received_events_url": "https://api.github.com/users/jesyspa/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "521734787ecf80ff12df7ca5998f7ec0b3b7b2c9", "url": "https://api.github.com/repos/rust-lang/rust/commits/521734787ecf80ff12df7ca5998f7ec0b3b7b2c9", "html_url": "https://github.com/rust-lang/rust/commit/521734787ecf80ff12df7ca5998f7ec0b3b7b2c9"}], "stats": {"total": 108, "additions": 47, "deletions": 61}, "files": [{"sha": "ebd2c97698bedfb2c752ec6341847439da976f5f", "filename": "compiler/rustc_error_codes/src/error_codes/E0161.md", "status": "modified", "additions": 21, "deletions": 5, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0161.md", "raw_url": "https://github.com/rust-lang/rust/raw/ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0161.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0161.md?ref=ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e", "patch": "@@ -4,11 +4,18 @@ Erroneous code example:\n \n ```compile_fail,E0161\n #![feature(box_syntax)]\n+trait Bar {\n+    fn f(self);\n+}\n+\n+impl Bar for i32 {\n+    fn f(self) {}\n+}\n \n fn main() {\n-    let array: &[isize] = &[1, 2, 3];\n-    let _x: Box<[isize]> = box *array;\n-    // error: cannot move a value of type [isize]: the size of [isize] cannot\n+    let b: Box<dyn Bar> = box (0 as i32);\n+    b.f();\n+    // error: cannot move a value of type dyn Bar: the size of dyn Bar cannot\n     //        be statically determined\n }\n ```\n@@ -22,8 +29,17 @@ it around as usual. Example:\n ```\n #![feature(box_syntax)]\n \n+trait Bar {\n+    fn f(&self);\n+}\n+\n+impl Bar for i32 {\n+    fn f(&self) {}\n+}\n+\n fn main() {\n-    let array: &[isize] = &[1, 2, 3];\n-    let _x: Box<&[isize]> = box array; // ok!\n+    let b: Box<dyn Bar> = box (0 as i32);\n+    b.f();\n+    // ok!\n }\n ```"}, {"sha": "6beb29c57d52772f0bc4d98633023069760b59c0", "filename": "src/test/ui/error-codes/E0161.edition.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e/src%2Ftest%2Fui%2Ferror-codes%2FE0161.edition.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e/src%2Ftest%2Fui%2Ferror-codes%2FE0161.edition.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0161.edition.stderr?ref=ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e", "patch": "@@ -1,8 +1,8 @@\n-error[E0161]: cannot move a value of type [i32]: the size of [i32] cannot be statically determined\n-  --> $DIR/E0161.rs:22:9\n+error[E0161]: cannot move a value of type dyn Bar: the size of dyn Bar cannot be statically determined\n+  --> $DIR/E0161.rs:29:5\n    |\n-LL |     box *x;\n-   |         ^^\n+LL |     x.f();\n+   |     ^\n \n error: aborting due to previous error\n "}, {"sha": "2baba998f12fe14db2938a44253951c99372ed6f", "filename": "src/test/ui/error-codes/E0161.editionul.stderr", "status": "removed", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/521734787ecf80ff12df7ca5998f7ec0b3b7b2c9/src%2Ftest%2Fui%2Ferror-codes%2FE0161.editionul.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/521734787ecf80ff12df7ca5998f7ec0b3b7b2c9/src%2Ftest%2Fui%2Ferror-codes%2FE0161.editionul.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0161.editionul.stderr?ref=521734787ecf80ff12df7ca5998f7ec0b3b7b2c9", "patch": "@@ -1,9 +0,0 @@\n-error[E0161]: cannot move a value of type [i32]: the size of [i32] cannot be statically determined\n-  --> $DIR/E0161.rs:22:5\n-   |\n-LL |     box *x;\n-   |     ^^^^^^\n-\n-error: aborting due to previous error\n-\n-For more information about this error, try `rustc --explain E0161`."}, {"sha": "6beb29c57d52772f0bc4d98633023069760b59c0", "filename": "src/test/ui/error-codes/E0161.migrate.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e/src%2Ftest%2Fui%2Ferror-codes%2FE0161.migrate.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e/src%2Ftest%2Fui%2Ferror-codes%2FE0161.migrate.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0161.migrate.stderr?ref=ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e", "patch": "@@ -1,8 +1,8 @@\n-error[E0161]: cannot move a value of type [i32]: the size of [i32] cannot be statically determined\n-  --> $DIR/E0161.rs:22:9\n+error[E0161]: cannot move a value of type dyn Bar: the size of dyn Bar cannot be statically determined\n+  --> $DIR/E0161.rs:29:5\n    |\n-LL |     box *x;\n-   |         ^^\n+LL |     x.f();\n+   |     ^\n \n error: aborting due to previous error\n "}, {"sha": "2baba998f12fe14db2938a44253951c99372ed6f", "filename": "src/test/ui/error-codes/E0161.migrateul.stderr", "status": "removed", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/521734787ecf80ff12df7ca5998f7ec0b3b7b2c9/src%2Ftest%2Fui%2Ferror-codes%2FE0161.migrateul.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/521734787ecf80ff12df7ca5998f7ec0b3b7b2c9/src%2Ftest%2Fui%2Ferror-codes%2FE0161.migrateul.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0161.migrateul.stderr?ref=521734787ecf80ff12df7ca5998f7ec0b3b7b2c9", "patch": "@@ -1,9 +0,0 @@\n-error[E0161]: cannot move a value of type [i32]: the size of [i32] cannot be statically determined\n-  --> $DIR/E0161.rs:22:5\n-   |\n-LL |     box *x;\n-   |     ^^^^^^\n-\n-error: aborting due to previous error\n-\n-For more information about this error, try `rustc --explain E0161`."}, {"sha": "6beb29c57d52772f0bc4d98633023069760b59c0", "filename": "src/test/ui/error-codes/E0161.nll.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e/src%2Ftest%2Fui%2Ferror-codes%2FE0161.nll.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e/src%2Ftest%2Fui%2Ferror-codes%2FE0161.nll.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0161.nll.stderr?ref=ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e", "patch": "@@ -1,8 +1,8 @@\n-error[E0161]: cannot move a value of type [i32]: the size of [i32] cannot be statically determined\n-  --> $DIR/E0161.rs:22:9\n+error[E0161]: cannot move a value of type dyn Bar: the size of dyn Bar cannot be statically determined\n+  --> $DIR/E0161.rs:29:5\n    |\n-LL |     box *x;\n-   |         ^^\n+LL |     x.f();\n+   |     ^\n \n error: aborting due to previous error\n "}, {"sha": "2baba998f12fe14db2938a44253951c99372ed6f", "filename": "src/test/ui/error-codes/E0161.nllul.stderr", "status": "removed", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/521734787ecf80ff12df7ca5998f7ec0b3b7b2c9/src%2Ftest%2Fui%2Ferror-codes%2FE0161.nllul.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/521734787ecf80ff12df7ca5998f7ec0b3b7b2c9/src%2Ftest%2Fui%2Ferror-codes%2FE0161.nllul.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0161.nllul.stderr?ref=521734787ecf80ff12df7ca5998f7ec0b3b7b2c9", "patch": "@@ -1,9 +0,0 @@\n-error[E0161]: cannot move a value of type [i32]: the size of [i32] cannot be statically determined\n-  --> $DIR/E0161.rs:22:5\n-   |\n-LL |     box *x;\n-   |     ^^^^^^\n-\n-error: aborting due to previous error\n-\n-For more information about this error, try `rustc --explain E0161`."}, {"sha": "ba74529e4b6e43f6bdf837c88333b60891bb843a", "filename": "src/test/ui/error-codes/E0161.rs", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e/src%2Ftest%2Fui%2Ferror-codes%2FE0161.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e/src%2Ftest%2Fui%2Ferror-codes%2FE0161.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0161.rs?ref=ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e", "patch": "@@ -8,6 +8,10 @@\n //[edition]edition:2018\n //[zflagsul]compile-flags: -Z borrowck=migrate\n //[editionul]edition:2018\n+//[migrateul] check-pass\n+//[nllul] check-pass\n+//[zflagsul] check-pass\n+//[editionul] check-pass\n \n #![allow(incomplete_features)]\n #![cfg_attr(nll, feature(nll))]\n@@ -16,12 +20,14 @@\n #![cfg_attr(zflagsul, feature(unsized_locals))]\n #![cfg_attr(nllul, feature(unsized_locals))]\n #![cfg_attr(editionul, feature(unsized_locals))]\n-#![feature(box_syntax)]\n \n-fn foo(x: Box<[i32]>) {\n-    box *x;\n+trait Bar {\n+    fn f(self);\n+}\n+\n+fn foo(x: Box<dyn Bar>) {\n+    x.f();\n     //[migrate,nll,zflags,edition]~^ ERROR E0161\n-    //[migrateul,nllul,zflagsul,editionul]~^^ ERROR E0161\n }\n \n fn main() {}"}, {"sha": "6beb29c57d52772f0bc4d98633023069760b59c0", "filename": "src/test/ui/error-codes/E0161.zflags.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e/src%2Ftest%2Fui%2Ferror-codes%2FE0161.zflags.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e/src%2Ftest%2Fui%2Ferror-codes%2FE0161.zflags.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0161.zflags.stderr?ref=ba83b39d4e53f412339f1af8c4f7cbe80eb1ee6e", "patch": "@@ -1,8 +1,8 @@\n-error[E0161]: cannot move a value of type [i32]: the size of [i32] cannot be statically determined\n-  --> $DIR/E0161.rs:22:9\n+error[E0161]: cannot move a value of type dyn Bar: the size of dyn Bar cannot be statically determined\n+  --> $DIR/E0161.rs:29:5\n    |\n-LL |     box *x;\n-   |         ^^\n+LL |     x.f();\n+   |     ^\n \n error: aborting due to previous error\n "}, {"sha": "2baba998f12fe14db2938a44253951c99372ed6f", "filename": "src/test/ui/error-codes/E0161.zflagsul.stderr", "status": "removed", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/521734787ecf80ff12df7ca5998f7ec0b3b7b2c9/src%2Ftest%2Fui%2Ferror-codes%2FE0161.zflagsul.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/521734787ecf80ff12df7ca5998f7ec0b3b7b2c9/src%2Ftest%2Fui%2Ferror-codes%2FE0161.zflagsul.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0161.zflagsul.stderr?ref=521734787ecf80ff12df7ca5998f7ec0b3b7b2c9", "patch": "@@ -1,9 +0,0 @@\n-error[E0161]: cannot move a value of type [i32]: the size of [i32] cannot be statically determined\n-  --> $DIR/E0161.rs:22:5\n-   |\n-LL |     box *x;\n-   |     ^^^^^^\n-\n-error: aborting due to previous error\n-\n-For more information about this error, try `rustc --explain E0161`."}]}