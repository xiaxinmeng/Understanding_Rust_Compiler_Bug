{"sha": "4993807dd9416ed65b9cac0e507af34bfe04a4ad", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ5OTM4MDdkZDk0MTZlZDY1YjljYWMwZTUwN2FmMzRiZmUwNGE0YWQ=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2019-11-24T13:05:12Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2019-11-27T12:12:27Z"}, "message": "little intra-doc code cleanup", "tree": {"sha": "a3c512ca70cc631130adf5d752e871e24a62aed9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a3c512ca70cc631130adf5d752e871e24a62aed9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4993807dd9416ed65b9cac0e507af34bfe04a4ad", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4993807dd9416ed65b9cac0e507af34bfe04a4ad", "html_url": "https://github.com/rust-lang/rust/commit/4993807dd9416ed65b9cac0e507af34bfe04a4ad", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4993807dd9416ed65b9cac0e507af34bfe04a4ad/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b5f265eeed23ac87ec6b4a7e6bc7cb4ea3e67c31", "url": "https://api.github.com/repos/rust-lang/rust/commits/b5f265eeed23ac87ec6b4a7e6bc7cb4ea3e67c31", "html_url": "https://github.com/rust-lang/rust/commit/b5f265eeed23ac87ec6b4a7e6bc7cb4ea3e67c31"}], "stats": {"total": 27, "additions": 11, "deletions": 16}, "files": [{"sha": "636f6bcb13b1d6b4393cd66d4475913a4fa65649", "filename": "src/librustdoc/passes/collect_intra_doc_links.rs", "status": "modified", "additions": 11, "deletions": 16, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/4993807dd9416ed65b9cac0e507af34bfe04a4ad/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4993807dd9416ed65b9cac0e507af34bfe04a4ad/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs?ref=4993807dd9416ed65b9cac0e507af34bfe04a4ad", "patch": "@@ -121,23 +121,18 @@ impl<'a, 'tcx> LinkCollector<'a, 'tcx> {\n \n             // Try looking for methods and associated items.\n             let mut split = path_str.rsplitn(2, \"::\");\n-            let item_name = if let Some(first) = split.next() {\n-                Symbol::intern(first)\n-            } else {\n-                return Err(ErrorKind::ResolutionFailure)\n-            };\n-\n-            let mut path = if let Some(second) = split.next() {\n-                second.to_owned()\n-            } else {\n-                return Err(ErrorKind::ResolutionFailure)\n-            };\n-\n-            if path == \"self\" || path == \"Self\" {\n-                if let Some(name) = current_item.as_ref() {\n-                    path = name.clone();\n+            let item_name = split.next()\n+                .map(|f| Symbol::intern(f))\n+                .ok_or(ErrorKind::ResolutionFailure)?;\n+            let path = split.next().map(|f| {\n+                if f == \"self\" || f == \"Self\" {\n+                    if let Some(name) = current_item.as_ref() {\n+                        return name.clone();\n+                    }\n                 }\n-            }\n+                f.to_owned()\n+            }).ok_or(ErrorKind::ResolutionFailure)?;\n+\n             if let Some(prim) = is_primitive(&path, TypeNS) {\n                 let did = primitive_impl(cx, &path).ok_or(ErrorKind::ResolutionFailure)?;\n                 return cx.tcx.associated_items(did)"}]}