{"sha": "92da7e9ffa2ebde6b8ccd73c86f58b0570059e42", "node_id": "MDY6Q29tbWl0NzI0NzEyOjkyZGE3ZTlmZmEyZWJkZTZiOGNjZDczYzg2ZjU4YjA1NzAwNTllNDI=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2021-08-15T10:24:37Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2021-08-15T10:24:37Z"}, "message": "internal: optimize compile time\n\ncargo llvm-lines shows that path_to_error bloats the code. I don't think\nI've needed this functionality recently, seems that we've fixed most of\nthe serialization problems. So let's just remove it. Should be easy to\nadd back if we ever need it, and it does make sense to keep the\n`from_json` function around.", "tree": {"sha": "2748d8cfa8ee619b9f86e40693e89290cd91e1e0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2748d8cfa8ee619b9f86e40693e89290cd91e1e0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/92da7e9ffa2ebde6b8ccd73c86f58b0570059e42", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/92da7e9ffa2ebde6b8ccd73c86f58b0570059e42", "html_url": "https://github.com/rust-lang/rust/commit/92da7e9ffa2ebde6b8ccd73c86f58b0570059e42", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/92da7e9ffa2ebde6b8ccd73c86f58b0570059e42/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "182a2b8e72eee2faaef0ef17330937bd0edaa4b6", "url": "https://api.github.com/repos/rust-lang/rust/commits/182a2b8e72eee2faaef0ef17330937bd0edaa4b6", "html_url": "https://github.com/rust-lang/rust/commit/182a2b8e72eee2faaef0ef17330937bd0edaa4b6"}], "stats": {"total": 16, "additions": 3, "deletions": 13}, "files": [{"sha": "d7d0832bb31c8cf24a7a03a442cedc6e8c4bd571", "filename": "Cargo.lock", "status": "modified", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/92da7e9ffa2ebde6b8ccd73c86f58b0570059e42/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/92da7e9ffa2ebde6b8ccd73c86f58b0570059e42/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=92da7e9ffa2ebde6b8ccd73c86f58b0570059e42", "patch": "@@ -1315,7 +1315,6 @@ dependencies = [\n  \"rustc-hash\",\n  \"serde\",\n  \"serde_json\",\n- \"serde_path_to_error\",\n  \"sourcegen\",\n  \"stdx\",\n  \"syntax\",\n@@ -1453,15 +1452,6 @@ dependencies = [\n  \"serde\",\n ]\n \n-[[package]]\n-name = \"serde_path_to_error\"\n-version = \"0.1.4\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"42f6109f0506e20f7e0f910e51a0079acf41da8e0694e6442527c4ddf5a2b158\"\n-dependencies = [\n- \"serde\",\n-]\n-\n [[package]]\n name = \"serde_repr\"\n version = \"0.1.7\""}, {"sha": "b8355005617d6aa18a4ad72ca40b2d597df2f660", "filename": "crates/rust-analyzer/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/92da7e9ffa2ebde6b8ccd73c86f58b0570059e42/crates%2Frust-analyzer%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/92da7e9ffa2ebde6b8ccd73c86f58b0570059e42/crates%2Frust-analyzer%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2FCargo.toml?ref=92da7e9ffa2ebde6b8ccd73c86f58b0570059e42", "patch": "@@ -31,7 +31,6 @@ oorandom = \"11.1.2\"\n rustc-hash = \"1.1.0\"\n serde = { version = \"1.0.106\", features = [\"derive\"] }\n serde_json = { version = \"1.0.48\", features = [\"preserve_order\"] }\n-serde_path_to_error = \"0.1\"\n threadpool = \"1.7.1\"\n rayon = \"1.5\"\n mimalloc = { version = \"0.1.19\", default-features = false, optional = true }"}, {"sha": "d29ec512d6193ecbf9d70bfe6c6502d2fa6edc20", "filename": "crates/rust-analyzer/src/lib.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/92da7e9ffa2ebde6b8ccd73c86f58b0570059e42/crates%2Frust-analyzer%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/92da7e9ffa2ebde6b8ccd73c86f58b0570059e42/crates%2Frust-analyzer%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Flib.rs?ref=92da7e9ffa2ebde6b8ccd73c86f58b0570059e42", "patch": "@@ -41,16 +41,17 @@ pub mod config;\n #[cfg(test)]\n mod integrated_benchmarks;\n \n-use serde::de::DeserializeOwned;\n use std::fmt;\n \n+use serde::de::DeserializeOwned;\n+\n pub use crate::{caps::server_capabilities, main_loop::main_loop};\n \n pub type Error = Box<dyn std::error::Error + Send + Sync>;\n pub type Result<T, E = Error> = std::result::Result<T, E>;\n \n pub fn from_json<T: DeserializeOwned>(what: &'static str, json: serde_json::Value) -> Result<T> {\n-    let res = serde_path_to_error::deserialize(&json)\n+    let res = serde_json::from_value(json.clone())\n         .map_err(|e| format!(\"Failed to deserialize {}: {}; {}\", what, e, json))?;\n     Ok(res)\n }"}]}