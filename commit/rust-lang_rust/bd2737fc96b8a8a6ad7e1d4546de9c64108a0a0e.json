{"sha": "bd2737fc96b8a8a6ad7e1d4546de9c64108a0a0e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJkMjczN2ZjOTZiOGE4YTZhZDdlMWQ0NTQ2ZGU5YzY0MTA4YTBhMGU=", "commit": {"author": {"name": "Daniel Silverstone", "email": "dsilvers@digital-scurf.org", "date": "2021-03-16T10:50:45Z"}, "committer": {"name": "Daniel Silverstone", "email": "dsilvers@digital-scurf.org", "date": "2021-03-16T10:50:45Z"}, "message": "ci/docker: Add SDK/NDK level 21 to android docker for 32bit platforms\n\nCertain features of Linux (getauxval() and epoll_create1()) are only\navailable in android SDK/NDK levels 18 and 21 respectively.  The 32bit\nplatform is currently on level 14 for compatibility with Android 4.0.\n\nThis patch adds SDK/NDK level 21 to the docker for 32 bit platforms,\nwhile leaving the default setup at level 14.\n\nWith this done, projects such as `rustup` which rely on these dockers\ncan build with modern ecosystem crates such as tokio 1.0, by using\nthe level 21 toolchain, but those which do not need to switch will\nbe unaffected, since the level 14 toolchain remains available.\n\nSigned-off-by: Daniel Silverstone <dsilvers@digital-scurf.org>", "tree": {"sha": "64b81b67260b6a947861613f855216b0cbaed930", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/64b81b67260b6a947861613f855216b0cbaed930"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bd2737fc96b8a8a6ad7e1d4546de9c64108a0a0e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQFPBAABCgA5FiEEbMzlsXMGvNwXnPlUww30OfKYfXQFAmBQjZAbHGRzaWx2ZXJz\nQGRpZ2l0YWwtc2N1cmYub3JnAAoJEMMN9DnymH10Az4IANXqYbigY704Gd2sDCn/\nilavHk/22SozNkmjFh7IhavfL2VFBNSIfw5t24lTK3i1ja23dqS4P2KG9qtBqENP\n+qXWl2TouIxYfvu634zWLU/glXvRc4vqQQamND92L4EKGSsICvcTkRwWYzQTUbSu\nYwYeHjrRH5UZjH/sBNolWPk56JJQyCM7oBcpTVDw7mY1uZzboJuXe2tkGJFE/6yx\ny+x7xIjQwqbF9EeTrpW1uVGSjxCpmdbx0XrmF+0Ueg2S3WugqO+O1qa3YnwHtdUN\nM7jbA0kgAm+C+bvxzPMG4L9Sz7JNBWuGna08z5tTXAuDc+SvOBMjhWh8Z4dklX4s\nA1U=\n=9lEo\n-----END PGP SIGNATURE-----", "payload": "tree 64b81b67260b6a947861613f855216b0cbaed930\nparent ec487bf3cfc9ce386da25169509fae8f2b4d4eec\nauthor Daniel Silverstone <dsilvers@digital-scurf.org> 1615891845 +0000\ncommitter Daniel Silverstone <dsilvers@digital-scurf.org> 1615891845 +0000\n\nci/docker: Add SDK/NDK level 21 to android docker for 32bit platforms\n\nCertain features of Linux (getauxval() and epoll_create1()) are only\navailable in android SDK/NDK levels 18 and 21 respectively.  The 32bit\nplatform is currently on level 14 for compatibility with Android 4.0.\n\nThis patch adds SDK/NDK level 21 to the docker for 32 bit platforms,\nwhile leaving the default setup at level 14.\n\nWith this done, projects such as `rustup` which rely on these dockers\ncan build with modern ecosystem crates such as tokio 1.0, by using\nthe level 21 toolchain, but those which do not need to switch will\nbe unaffected, since the level 14 toolchain remains available.\n\nSigned-off-by: Daniel Silverstone <dsilvers@digital-scurf.org>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bd2737fc96b8a8a6ad7e1d4546de9c64108a0a0e", "html_url": "https://github.com/rust-lang/rust/commit/bd2737fc96b8a8a6ad7e1d4546de9c64108a0a0e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bd2737fc96b8a8a6ad7e1d4546de9c64108a0a0e/comments", "author": {"login": "kinnison", "id": 1469421, "node_id": "MDQ6VXNlcjE0Njk0MjE=", "avatar_url": "https://avatars.githubusercontent.com/u/1469421?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kinnison", "html_url": "https://github.com/kinnison", "followers_url": "https://api.github.com/users/kinnison/followers", "following_url": "https://api.github.com/users/kinnison/following{/other_user}", "gists_url": "https://api.github.com/users/kinnison/gists{/gist_id}", "starred_url": "https://api.github.com/users/kinnison/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kinnison/subscriptions", "organizations_url": "https://api.github.com/users/kinnison/orgs", "repos_url": "https://api.github.com/users/kinnison/repos", "events_url": "https://api.github.com/users/kinnison/events{/privacy}", "received_events_url": "https://api.github.com/users/kinnison/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kinnison", "id": 1469421, "node_id": "MDQ6VXNlcjE0Njk0MjE=", "avatar_url": "https://avatars.githubusercontent.com/u/1469421?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kinnison", "html_url": "https://github.com/kinnison", "followers_url": "https://api.github.com/users/kinnison/followers", "following_url": "https://api.github.com/users/kinnison/following{/other_user}", "gists_url": "https://api.github.com/users/kinnison/gists{/gist_id}", "starred_url": "https://api.github.com/users/kinnison/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kinnison/subscriptions", "organizations_url": "https://api.github.com/users/kinnison/orgs", "repos_url": "https://api.github.com/users/kinnison/repos", "events_url": "https://api.github.com/users/kinnison/events{/privacy}", "received_events_url": "https://api.github.com/users/kinnison/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ec487bf3cfc9ce386da25169509fae8f2b4d4eec", "url": "https://api.github.com/repos/rust-lang/rust/commits/ec487bf3cfc9ce386da25169509fae8f2b4d4eec", "html_url": "https://github.com/rust-lang/rust/commit/ec487bf3cfc9ce386da25169509fae8f2b4d4eec"}], "stats": {"total": 2, "additions": 2, "deletions": 0}, "files": [{"sha": "2f0496d7dd4ba06ab3a7f8e79bb9a26950c829a0", "filename": "src/ci/docker/host-x86_64/dist-android/Dockerfile", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/bd2737fc96b8a8a6ad7e1d4546de9c64108a0a0e/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-android%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/bd2737fc96b8a8a6ad7e1d4546de9c64108a0a0e/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-android%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-android%2FDockerfile?ref=bd2737fc96b8a8a6ad7e1d4546de9c64108a0a0e", "patch": "@@ -9,6 +9,8 @@ RUN . /scripts/android-ndk.sh && \\\n     download_ndk android-ndk-r15c-linux-x86_64.zip && \\\n     make_standalone_toolchain arm 14 && \\\n     make_standalone_toolchain x86 14 && \\\n+    make_standalone_toolchain arm 21 && \\\n+    make_standalone_toolchain x86 21 && \\\n     make_standalone_toolchain arm64 21 && \\\n     make_standalone_toolchain x86_64 21 && \\\n     remove_ndk"}]}