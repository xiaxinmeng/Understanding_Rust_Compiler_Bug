{"sha": "cc9347a90293d5bfead754cb91c828fb6555b3ff", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNjOTM0N2E5MDI5M2Q1YmZlYWQ3NTRjYjkxYzgyOGZiNjU1NWIzZmY=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2014-10-02T20:50:43Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2014-10-02T20:50:43Z"}, "message": "travis: Stop building and testing rust\n\nInstead, only run `make tidy`. The tidy script can run quite quickly, and it's\nsuper annoying to run tests for 50 minutes only to have bors fail with a\n\"trailing whitespace\" error.", "tree": {"sha": "b26a673129d20de4f21f2bd98e9f5db832bdffdd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b26a673129d20de4f21f2bd98e9f5db832bdffdd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cc9347a90293d5bfead754cb91c828fb6555b3ff", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cc9347a90293d5bfead754cb91c828fb6555b3ff", "html_url": "https://github.com/rust-lang/rust/commit/cc9347a90293d5bfead754cb91c828fb6555b3ff", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cc9347a90293d5bfead754cb91c828fb6555b3ff/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b2d4eb186e99b66051be9089f836c66a558dd995", "url": "https://api.github.com/repos/rust-lang/rust/commits/b2d4eb186e99b66051be9089f836c66a558dd995", "html_url": "https://github.com/rust-lang/rust/commit/b2d4eb186e99b66051be9089f836c66a558dd995"}], "stats": {"total": 63, "additions": 11, "deletions": 52}, "files": [{"sha": "354cb969edde46c909411b382de3f09190f267d2", "filename": ".travis.yml", "status": "modified", "additions": 11, "deletions": 52, "changes": 63, "blob_url": "https://github.com/rust-lang/rust/blob/cc9347a90293d5bfead754cb91c828fb6555b3ff/.travis.yml", "raw_url": "https://github.com/rust-lang/rust/raw/cc9347a90293d5bfead754cb91c828fb6555b3ff/.travis.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.travis.yml?ref=cc9347a90293d5bfead754cb91c828fb6555b3ff", "patch": "@@ -1,60 +1,19 @@\n # Use something that's not 'ruby' so we don't set up things like\n-# RVM/bundler/ruby and whatnot. Right now 'rust' isn't a language on travis and\n-# it treats unknown languages as ruby-like I believe.\n+# RVM/bundler/ruby and whatnot. Right now 'rust' as a language actually\n+# downloads a rust/cargo snapshot, which we don't really want for building rust.\n language: c\n \n-# Before we start doing anything, install a stock LLVM\n-install:\n-  - sudo sh -c \"echo 'deb http://llvm.org/apt/precise/ llvm-toolchain-precise-3.4 main' >> /etc/apt/sources.list\"\n-  - sudo sh -c \"echo 'deb http://llvm.org/apt/precise/ llvm-toolchain-precise main' >> /etc/apt/sources.list\"\n-  - sudo sh -c \"echo 'deb http://ppa.launchpad.net/ubuntu-toolchain-r/test/ubuntu precise main' >> /etc/apt/sources.list\"\n-  - wget -O - http://llvm.org/apt/llvm-snapshot.gpg.key | sudo apt-key add -\n-  - sudo apt-get update -qq\n-  - sudo apt-get install -qq --force-yes -y llvm-$LLVM_VERSION\n-    llvm-${LLVM_VERSION}-dev clang-$LLVM_VERSION lldb-$LLVM_VERSION\n-\n-\n-# All of the llvm tools are suffixed with \"-$VERS\" which we don't want, so\n-# symlink them all into a local directory and just use that\n+# The test suite is in general way too stressful for travis, especially in\n+# terms of time limit and reliability. In the past we've tried to scale things\n+# back to only build the stage1 compiler and run a subset of tests, but this\n+# didn't end up panning out very well.\n #\n-# FIXME: this shouldn't update the src/llvm sub-repo, that takes about a minute\n-#        it's gotta download so much stuff.\n+# As a result, we're just using travis to run `make tidy` now. It'll help\n+# everyone find out about their trailing spaces early on!\n before_script:\n-  - mkdir -p local-llvm/bin\n-  - ln -nsf /usr/bin/llvm-config-$LLVM_VERSION local-llvm/bin/llvm-config\n-  - ln -nsf /usr/bin/llvm-mc-$LLVM_VERSION local-llvm/bin/llvm-mc\n-  - ln -nsf /usr/bin/llvm-as-$LLVM_VERSION local-llvm/bin/llvm-as\n-  - ln -nsf /usr/bin/llvm-dis-$LLVM_VERSION local-llvm/bin/llvm-dis\n-  - ln -nsf /usr/bin/llc-$LLVM_VERSION local-llvm/bin/llc\n-  - ln -nsf /usr/include/llvm-$LLVM_VERSION local-llvm/include\n-  - ./configure --disable-optimize-tests --llvm-root=`pwd`/local-llvm\n-    --enable-fast-make --enable-clang\n-\n-# Tidy everything up first, then build a few things, and then run a few tests.\n-# Note that this is meant to run in a \"fairly small\" amount of time, so this\n-# isn't exhaustive at all.\n-#\n-# As a result of https://github.com/travis-ci/travis-ci/issues/1066, we run\n-# everything in one large command instead of multiple commands.\n-script: |\n-  if [[ $TRAVIS_PULL_REQUEST != 'false' ]]; then\n-    if [[ $LLVM_VERSION != '3.4' ]]; then exit 0; fi\n-  fi &&\n-  make tidy &&\n-  make -j4 rustc-stage1 RUSTFLAGS='-Z time-passes' &&\n-  make check-stage1-std check-stage1-rpass check-stage1-cfail check-stage1-rfail check-stage1-doc\n-\n-env:\n-  global:\n-    - NO_BENCH=1\n-  matrix:\n-    - LLVM_VERSION=3.3\n-    - LLVM_VERSION=3.4\n-\n-# We track this ourselves, and in theory we don't have to update the LLVM repo\n-# (but sadly we do right now anyway).\n-git:\n-  submodules: false\n+  - ./configure\n+script:\n+  - make tidy\n \n notifications:\n   email: false"}]}