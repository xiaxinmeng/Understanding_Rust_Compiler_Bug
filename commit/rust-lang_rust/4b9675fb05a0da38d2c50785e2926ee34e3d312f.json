{"sha": "4b9675fb05a0da38d2c50785e2926ee34e3d312f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRiOTY3NWZiMDVhMGRhMzhkMmM1MDc4NWUyOTI2ZWUzNGUzZDMxMmY=", "commit": {"author": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2020-08-17T19:13:04Z"}, "committer": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2020-08-18T14:27:13Z"}, "message": "Update license check post-cargo update", "tree": {"sha": "296ed708f937c7064392c6e381a25c808c01fe29", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/296ed708f937c7064392c6e381a25c808c01fe29"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4b9675fb05a0da38d2c50785e2926ee34e3d312f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4b9675fb05a0da38d2c50785e2926ee34e3d312f", "html_url": "https://github.com/rust-lang/rust/commit/4b9675fb05a0da38d2c50785e2926ee34e3d312f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4b9675fb05a0da38d2c50785e2926ee34e3d312f/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "342d9567491ee044aac99870536cb5df75d6aec2", "url": "https://api.github.com/repos/rust-lang/rust/commits/342d9567491ee044aac99870536cb5df75d6aec2", "html_url": "https://github.com/rust-lang/rust/commit/342d9567491ee044aac99870536cb5df75d6aec2"}], "stats": {"total": 45, "additions": 27, "deletions": 18}, "files": [{"sha": "9ed3c6e0d98ba3375b3a6ded5e095cfdb8e97187", "filename": "src/tools/tidy/src/deps.rs", "status": "modified", "additions": 27, "deletions": 18, "changes": 45, "blob_url": "https://github.com/rust-lang/rust/blob/4b9675fb05a0da38d2c50785e2926ee34e3d312f/src%2Ftools%2Ftidy%2Fsrc%2Fdeps.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4b9675fb05a0da38d2c50785e2926ee34e3d312f/src%2Ftools%2Ftidy%2Fsrc%2Fdeps.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Ftidy%2Fsrc%2Fdeps.rs?ref=4b9675fb05a0da38d2c50785e2926ee34e3d312f", "patch": "@@ -25,24 +25,24 @@ const LICENSES: &[&str] = &[\n /// tooling. It is _crucial_ that no exception crates be dependencies\n /// of the Rust runtime (std/test).\n const EXCEPTIONS: &[(&str, &str)] = &[\n-    (\"mdbook\", \"MPL-2.0\"),                  // mdbook\n-    (\"openssl\", \"Apache-2.0\"),              // cargo, mdbook\n-    (\"rdrand\", \"ISC\"),                      // mdbook, rustfmt\n-    (\"fuchsia-cprng\", \"BSD-3-Clause\"),      // mdbook, rustfmt\n-    (\"fuchsia-zircon-sys\", \"BSD-3-Clause\"), // rustdoc, rustc, cargo\n-    (\"fuchsia-zircon\", \"BSD-3-Clause\"),     // rustdoc, rustc, cargo (jobserver & tempdir)\n-    (\"colored\", \"MPL-2.0\"),                 // rustfmt\n-    (\"ordslice\", \"Apache-2.0\"),             // rls\n-    (\"cloudabi\", \"BSD-2-Clause\"),           // (rls -> crossbeam-channel 0.2 -> rand 0.5)\n-    (\"ryu\", \"Apache-2.0 OR BSL-1.0\"),       // rls/cargo/... (because of serde)\n-    (\"bytesize\", \"Apache-2.0\"),             // cargo\n-    (\"im-rc\", \"MPL-2.0+\"),                  // cargo\n-    (\"constant_time_eq\", \"CC0-1.0\"),        // rustfmt\n-    (\"sized-chunks\", \"MPL-2.0+\"),           // cargo via im-rc\n-    (\"bitmaps\", \"MPL-2.0+\"),                // cargo via im-rc\n+    (\"mdbook\", \"MPL-2.0\"),                                  // mdbook\n+    (\"openssl\", \"Apache-2.0\"),                              // cargo, mdbook\n+    (\"fuchsia-zircon-sys\", \"BSD-3-Clause\"),                 // rustdoc, rustc, cargo\n+    (\"fuchsia-zircon\", \"BSD-3-Clause\"), // rustdoc, rustc, cargo (jobserver & tempdir)\n+    (\"colored\", \"MPL-2.0\"),             // rustfmt\n+    (\"ordslice\", \"Apache-2.0\"),         // rls\n+    (\"cloudabi\", \"BSD-2-Clause\"),       // (rls -> crossbeam-channel 0.2 -> rand 0.5)\n+    (\"ryu\", \"Apache-2.0 OR BSL-1.0\"),   // rls/cargo/... (because of serde)\n+    (\"bytesize\", \"Apache-2.0\"),         // cargo\n+    (\"im-rc\", \"MPL-2.0+\"),              // cargo\n+    (\"constant_time_eq\", \"CC0-1.0\"),    // rustfmt\n+    (\"sized-chunks\", \"MPL-2.0+\"),       // cargo via im-rc\n+    (\"bitmaps\", \"MPL-2.0+\"),            // cargo via im-rc\n+    (\"crossbeam-queue\", \"MIT/Apache-2.0 AND BSD-2-Clause\"), // rls via rayon\n+    (\"arrayref\", \"BSD-2-Clause\"),       // cargo-miri/directories/.../rust-argon2 (redox)\n+    (\"instant\", \"BSD-3-Clause\"),        // rustc_driver/tracing-subscriber/parking_lot\n     // FIXME: this dependency violates the documentation comment above:\n     (\"fortanix-sgx-abi\", \"MPL-2.0\"), // libstd but only for `sgx` target\n-    (\"crossbeam-channel\", \"MIT/Apache-2.0 AND BSD-2-Clause\"), // cargo\n ];\n \n /// These are the root crates that are part of the runtime. The licenses for\n@@ -69,8 +69,8 @@ const PERMITTED_DEPENDENCIES: &[&str] = &[\n     \"bitflags\",\n     \"block-buffer\",\n     \"block-padding\",\n-    \"byte-tools\",\n     \"byteorder\",\n+    \"byte-tools\",\n     \"cc\",\n     \"cfg-if\",\n     \"chalk-derive\",\n@@ -103,6 +103,7 @@ const PERMITTED_DEPENDENCIES: &[&str] = &[\n     \"hermit-abi\",\n     \"humantime\",\n     \"indexmap\",\n+    \"instant\",\n     \"itertools\",\n     \"jobserver\",\n     \"kernel32-sys\",\n@@ -112,13 +113,13 @@ const PERMITTED_DEPENDENCIES: &[&str] = &[\n     \"lock_api\",\n     \"log\",\n     \"log_settings\",\n+    \"maybe-uninit\",\n     \"md-5\",\n     \"measureme\",\n     \"memchr\",\n     \"memmap\",\n     \"memoffset\",\n     \"miniz_oxide\",\n-    \"nodrop\",\n     \"num_cpus\",\n     \"object\",\n     \"once_cell\",\n@@ -233,6 +234,14 @@ fn check_exceptions(metadata: &Metadata, bad: &mut bool) {\n                 }\n                 Some(pkg_license) => {\n                     if pkg_license.as_str() != *license {\n+                        if *name == \"crossbeam-queue\"\n+                            && *license == \"MIT/Apache-2.0 AND BSD-2-Clause\"\n+                        {\n+                            // We have two versions of crossbeam-queue and both\n+                            // are fine.\n+                            continue;\n+                        }\n+\n                         println!(\"dependency exception `{}` license has changed\", name);\n                         println!(\"    previously `{}` now `{}`\", license, pkg_license);\n                         println!(\"    update EXCEPTIONS for the new license\");"}]}