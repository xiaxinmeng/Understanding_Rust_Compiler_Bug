{"sha": "280dea743b5227d0d162217cbb89db881242c94e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI4MGRlYTc0M2I1MjI3ZDBkMTYyMjE3Y2JiODlkYjg4MTI0MmM5NGU=", "commit": {"author": {"name": "James Miller", "email": "james@aatch.net", "date": "2015-01-09T05:06:45Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2015-03-03T11:10:19Z"}, "message": "Implement parse_opt_bool better\n\nDuring my clean-up of rebase errors, I took the opportunity to implement\nparse_opt_bool so that it isn't identical to parse_bool wrapped in\n`Some`.\n\nparse_opt_bool considers no value to be true, a value of 'y', 'yes' or\n'on' to be true and 'n', 'no' or 'off' to be false. All other values are\nan error.", "tree": {"sha": "fb4892b0e233f4ec6ba5a646e2451d0597a5bd04", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fb4892b0e233f4ec6ba5a646e2451d0597a5bd04"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/280dea743b5227d0d162217cbb89db881242c94e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/280dea743b5227d0d162217cbb89db881242c94e", "html_url": "https://github.com/rust-lang/rust/commit/280dea743b5227d0d162217cbb89db881242c94e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/280dea743b5227d0d162217cbb89db881242c94e/comments", "author": {"login": "Aatch", "id": 342416, "node_id": "MDQ6VXNlcjM0MjQxNg==", "avatar_url": "https://avatars.githubusercontent.com/u/342416?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aatch", "html_url": "https://github.com/Aatch", "followers_url": "https://api.github.com/users/Aatch/followers", "following_url": "https://api.github.com/users/Aatch/following{/other_user}", "gists_url": "https://api.github.com/users/Aatch/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aatch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aatch/subscriptions", "organizations_url": "https://api.github.com/users/Aatch/orgs", "repos_url": "https://api.github.com/users/Aatch/repos", "events_url": "https://api.github.com/users/Aatch/events{/privacy}", "received_events_url": "https://api.github.com/users/Aatch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1246d4067fdc034d064dfb78f88c2c3c079c3f4f", "url": "https://api.github.com/repos/rust-lang/rust/commits/1246d4067fdc034d064dfb78f88c2c3c079c3f4f", "html_url": "https://github.com/rust-lang/rust/commit/1246d4067fdc034d064dfb78f88c2c3c079c3f4f"}], "stats": {"total": 17, "additions": 15, "deletions": 2}, "files": [{"sha": "536caece21f841f3309b76a39b5ecf2725cd5e3e", "filename": "src/librustc/session/config.rs", "status": "modified", "additions": 15, "deletions": 2, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/280dea743b5227d0d162217cbb89db881242c94e/src%2Flibrustc%2Fsession%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/280dea743b5227d0d162217cbb89db881242c94e/src%2Flibrustc%2Fsession%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fsession%2Fconfig.rs?ref=280dea743b5227d0d162217cbb89db881242c94e", "patch": "@@ -348,7 +348,8 @@ macro_rules! options {\n     #[allow(non_upper_case_globals, dead_code)]\n     mod $mod_desc {\n         pub const parse_bool: Option<&'static str> = None;\n-        pub const parse_opt_bool: Option<&'static str> = None;\n+        pub const parse_opt_bool: Option<&'static str> =\n+            Some(\"one of: `y`, `yes`, `on`, `n`, `no`, or `off`\");\n         pub const parse_string: Option<&'static str> = Some(\"a string\");\n         pub const parse_opt_string: Option<&'static str> = Some(\"a string\");\n         pub const parse_list: Option<&'static str> = Some(\"a space-separated list of strings\");\n@@ -379,7 +380,19 @@ macro_rules! options {\n \n         fn parse_opt_bool(slot: &mut Option<bool>, v: Option<&str>) -> bool {\n             match v {\n-                Some(..) => false,\n+                Some(s) => {\n+                    match s {\n+                        \"n\" | \"no\" | \"off\" => {\n+                            *slot = Some(false);\n+                        }\n+                        \"y\" | \"yes\" | \"on\" => {\n+                            *slot = Some(true);\n+                        }\n+                        _ => { return false; }\n+                    }\n+\n+                    true\n+                },\n                 None => { *slot = Some(true); true }\n             }\n         }"}]}