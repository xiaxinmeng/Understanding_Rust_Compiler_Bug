{"sha": "37b22cf2d5d787106077d4f9ef3092ca80e92a1b", "node_id": "C_kwDOAAsO6NoAKDM3YjIyY2YyZDVkNzg3MTA2MDc3ZDRmOWVmMzA5MmNhODBlOTJhMWI", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2023-04-22T03:28:13Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2023-04-22T03:28:13Z"}, "message": "Auto merge of #110469 - compiler-errors:encode-lt-param-span, r=oli-obk\n\nEncode lifetime param spans too\n\nFixes #110464\nFixes #110591", "tree": {"sha": "bf0c73f86bd9d9ae0d2e793f7462ddcba971055a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bf0c73f86bd9d9ae0d2e793f7462ddcba971055a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/37b22cf2d5d787106077d4f9ef3092ca80e92a1b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/37b22cf2d5d787106077d4f9ef3092ca80e92a1b", "html_url": "https://github.com/rust-lang/rust/commit/37b22cf2d5d787106077d4f9ef3092ca80e92a1b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/37b22cf2d5d787106077d4f9ef3092ca80e92a1b/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "80a2ec49a4ffb7a351c41c8db14711297324b587", "url": "https://api.github.com/repos/rust-lang/rust/commits/80a2ec49a4ffb7a351c41c8db14711297324b587", "html_url": "https://github.com/rust-lang/rust/commit/80a2ec49a4ffb7a351c41c8db14711297324b587"}, {"sha": "24c2c075cc2216af8868809fdd68c9da8466c327", "url": "https://api.github.com/repos/rust-lang/rust/commits/24c2c075cc2216af8868809fdd68c9da8466c327", "html_url": "https://github.com/rust-lang/rust/commit/24c2c075cc2216af8868809fdd68c9da8466c327"}], "stats": {"total": 84, "additions": 50, "deletions": 34}, "files": [{"sha": "17a9daee7d03811d3e531d699e80f6c05628f829", "filename": "compiler/rustc_metadata/src/rmeta/encoder.rs", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/37b22cf2d5d787106077d4f9ef3092ca80e92a1b/compiler%2Frustc_metadata%2Fsrc%2Frmeta%2Fencoder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/37b22cf2d5d787106077d4f9ef3092ca80e92a1b/compiler%2Frustc_metadata%2Fsrc%2Frmeta%2Fencoder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_metadata%2Fsrc%2Frmeta%2Fencoder.rs?ref=37b22cf2d5d787106077d4f9ef3092ca80e92a1b", "patch": "@@ -824,6 +824,7 @@ fn should_encode_span(def_kind: DefKind) -> bool {\n         | DefKind::AssocTy\n         | DefKind::TyParam\n         | DefKind::ConstParam\n+        | DefKind::LifetimeParam\n         | DefKind::Fn\n         | DefKind::Const\n         | DefKind::Static(_)\n@@ -840,10 +841,7 @@ fn should_encode_span(def_kind: DefKind) -> bool {\n         | DefKind::Impl { .. }\n         | DefKind::Closure\n         | DefKind::Generator => true,\n-        DefKind::ForeignMod\n-        | DefKind::ImplTraitPlaceholder\n-        | DefKind::LifetimeParam\n-        | DefKind::GlobalAsm => false,\n+        DefKind::ForeignMod | DefKind::ImplTraitPlaceholder | DefKind::GlobalAsm => false,\n     }\n }\n "}, {"sha": "85b0c6c9df8b16a96a6e803a380ac58efd97788c", "filename": "tests/ui/consts/auxiliary/foreign-generic-mismatch-with-const-arg.rs", "status": "removed", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/80a2ec49a4ffb7a351c41c8db14711297324b587/tests%2Fui%2Fconsts%2Fauxiliary%2Fforeign-generic-mismatch-with-const-arg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/80a2ec49a4ffb7a351c41c8db14711297324b587/tests%2Fui%2Fconsts%2Fauxiliary%2Fforeign-generic-mismatch-with-const-arg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fconsts%2Fauxiliary%2Fforeign-generic-mismatch-with-const-arg.rs?ref=80a2ec49a4ffb7a351c41c8db14711297324b587", "patch": "@@ -1 +0,0 @@\n-pub fn test<const N: usize, T>() {}"}, {"sha": "7590abbd827b1d1b9b3e1cee637dfd8cc9c7b833", "filename": "tests/ui/consts/foreign-generic-mismatch-with-const-arg.rs", "status": "removed", "additions": 0, "deletions": 8, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/80a2ec49a4ffb7a351c41c8db14711297324b587/tests%2Fui%2Fconsts%2Fforeign-generic-mismatch-with-const-arg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/80a2ec49a4ffb7a351c41c8db14711297324b587/tests%2Fui%2Fconsts%2Fforeign-generic-mismatch-with-const-arg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fconsts%2Fforeign-generic-mismatch-with-const-arg.rs?ref=80a2ec49a4ffb7a351c41c8db14711297324b587", "patch": "@@ -1,8 +0,0 @@\n-// aux-build: foreign-generic-mismatch-with-const-arg.rs\n-\n-extern crate foreign_generic_mismatch_with_const_arg;\n-\n-fn main() {\n-    foreign_generic_mismatch_with_const_arg::test::<1>();\n-    //~^ ERROR function takes 2 generic arguments but 1 generic argument was supplied\n-}"}, {"sha": "4cc03a20514aa186fb27ae37becea3037aedcf68", "filename": "tests/ui/consts/foreign-generic-mismatch-with-const-arg.stderr", "status": "removed", "additions": 0, "deletions": 21, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/80a2ec49a4ffb7a351c41c8db14711297324b587/tests%2Fui%2Fconsts%2Fforeign-generic-mismatch-with-const-arg.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/80a2ec49a4ffb7a351c41c8db14711297324b587/tests%2Fui%2Fconsts%2Fforeign-generic-mismatch-with-const-arg.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fconsts%2Fforeign-generic-mismatch-with-const-arg.stderr?ref=80a2ec49a4ffb7a351c41c8db14711297324b587", "patch": "@@ -1,21 +0,0 @@\n-error[E0107]: function takes 2 generic arguments but 1 generic argument was supplied\n-  --> $DIR/foreign-generic-mismatch-with-const-arg.rs:6:46\n-   |\n-LL |     foreign_generic_mismatch_with_const_arg::test::<1>();\n-   |                                              ^^^^   - supplied 1 generic argument\n-   |                                              |\n-   |                                              expected 2 generic arguments\n-   |\n-note: function defined here, with 2 generic parameters: `N`, `T`\n-  --> $DIR/auxiliary/foreign-generic-mismatch-with-const-arg.rs:1:8\n-   |\n-LL | pub fn test<const N: usize, T>() {}\n-   |        ^^^^ --------------  -\n-help: add missing generic argument\n-   |\n-LL |     foreign_generic_mismatch_with_const_arg::test::<1, T>();\n-   |                                                      +++\n-\n-error: aborting due to previous error\n-\n-For more information about this error, try `rustc --explain E0107`."}, {"sha": "d89c1e036887a02cfe65372d5153d6ce1190ba94", "filename": "tests/ui/generics/auxiliary/foreign-generic-mismatch.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/37b22cf2d5d787106077d4f9ef3092ca80e92a1b/tests%2Fui%2Fgenerics%2Fauxiliary%2Fforeign-generic-mismatch.rs", "raw_url": "https://github.com/rust-lang/rust/raw/37b22cf2d5d787106077d4f9ef3092ca80e92a1b/tests%2Fui%2Fgenerics%2Fauxiliary%2Fforeign-generic-mismatch.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fgenerics%2Fauxiliary%2Fforeign-generic-mismatch.rs?ref=37b22cf2d5d787106077d4f9ef3092ca80e92a1b", "patch": "@@ -0,0 +1,3 @@\n+pub fn const_arg<const N: usize, T>() {}\n+\n+pub fn lt_arg<'a: 'a>() {}"}, {"sha": "403fd73d7df934be0a483b9dc81987c4d3b9d9a8", "filename": "tests/ui/generics/foreign-generic-mismatch.rs", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/37b22cf2d5d787106077d4f9ef3092ca80e92a1b/tests%2Fui%2Fgenerics%2Fforeign-generic-mismatch.rs", "raw_url": "https://github.com/rust-lang/rust/raw/37b22cf2d5d787106077d4f9ef3092ca80e92a1b/tests%2Fui%2Fgenerics%2Fforeign-generic-mismatch.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fgenerics%2Fforeign-generic-mismatch.rs?ref=37b22cf2d5d787106077d4f9ef3092ca80e92a1b", "patch": "@@ -0,0 +1,10 @@\n+// aux-build: foreign-generic-mismatch.rs\n+\n+extern crate foreign_generic_mismatch;\n+\n+fn main() {\n+    foreign_generic_mismatch::const_arg::<()>();\n+    //~^ ERROR function takes 2 generic arguments but 1 generic argument was supplied\n+    foreign_generic_mismatch::lt_arg::<'static, 'static>();\n+    //~^ ERROR function takes 1 lifetime argument but 2 lifetime arguments were supplied\n+}"}, {"sha": "5322b3f919d2d4f7dcf6c6c96f3c3bdc9e4f4423", "filename": "tests/ui/generics/foreign-generic-mismatch.stderr", "status": "added", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/37b22cf2d5d787106077d4f9ef3092ca80e92a1b/tests%2Fui%2Fgenerics%2Fforeign-generic-mismatch.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/37b22cf2d5d787106077d4f9ef3092ca80e92a1b/tests%2Fui%2Fgenerics%2Fforeign-generic-mismatch.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fgenerics%2Fforeign-generic-mismatch.stderr?ref=37b22cf2d5d787106077d4f9ef3092ca80e92a1b", "patch": "@@ -0,0 +1,35 @@\n+error[E0107]: function takes 2 generic arguments but 1 generic argument was supplied\n+  --> $DIR/foreign-generic-mismatch.rs:6:31\n+   |\n+LL |     foreign_generic_mismatch::const_arg::<()>();\n+   |                               ^^^^^^^^^   -- supplied 1 generic argument\n+   |                               |\n+   |                               expected 2 generic arguments\n+   |\n+note: function defined here, with 2 generic parameters: `N`, `T`\n+  --> $DIR/auxiliary/foreign-generic-mismatch.rs:1:8\n+   |\n+LL | pub fn const_arg<const N: usize, T>() {}\n+   |        ^^^^^^^^^ --------------  -\n+help: add missing generic argument\n+   |\n+LL |     foreign_generic_mismatch::const_arg::<(), T>();\n+   |                                             +++\n+\n+error[E0107]: function takes 1 lifetime argument but 2 lifetime arguments were supplied\n+  --> $DIR/foreign-generic-mismatch.rs:8:31\n+   |\n+LL |     foreign_generic_mismatch::lt_arg::<'static, 'static>();\n+   |                               ^^^^^^            ------- help: remove this lifetime argument\n+   |                               |\n+   |                               expected 1 lifetime argument\n+   |\n+note: function defined here, with 1 lifetime parameter: `'a`\n+  --> $DIR/auxiliary/foreign-generic-mismatch.rs:3:8\n+   |\n+LL | pub fn lt_arg<'a: 'a>() {}\n+   |        ^^^^^^ --\n+\n+error: aborting due to 2 previous errors\n+\n+For more information about this error, try `rustc --explain E0107`."}]}