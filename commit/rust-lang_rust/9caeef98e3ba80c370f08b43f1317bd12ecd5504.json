{"sha": "9caeef98e3ba80c370f08b43f1317bd12ecd5504", "node_id": "MDY6Q29tbWl0NzI0NzEyOjljYWVlZjk4ZTNiYTgwYzM3MGYwOGI0M2YxMzE3YmQxMmVjZDU1MDQ=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2021-03-16T19:36:55Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-03-16T19:36:55Z"}, "message": "Merge #8042\n\n8042: Add perf_revision to benchmark results r=lnicola a=d2weber\n\nI gave it a try to add the hash as described in #8031 \r\nFeel free to tell me if there is something I could improve.\n\nCo-authored-by: Douglas Weber <douglas.web@web.de>", "tree": {"sha": "6992372cb752fc922dc851b723ff1e31923f2946", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6992372cb752fc922dc851b723ff1e31923f2946"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9caeef98e3ba80c370f08b43f1317bd12ecd5504", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgUQjXCRBK7hj4Ov3rIwAAdHIIAKvQtk7BQTV5vksUxbVSI2xi\nFJaT9RSluk6DN+8zxoa2+1JEAlMJ0X2MD9KZGovM8zbLfSn7VFhh5M2gtjfEevOR\nzpeK0uuh99VQYIKF+UKKxgZC+8bmRNNHSlTDVlJLYobegsCSrhbo31xq9ZQMKOmx\n+YDQzoSXjK4GQfW93IChDM7ij+rxEBvkNik1Eu3H3ESvFD7QNk5Uc+bxz0rLpoez\nvx1fQf+KonOwOCqZHwaq1cBb9DbNCklKPz5uVlFDeKQI2+Eg+HNoStONduUCgIvd\n71FpT5mLs2ZGlQfFSvxuIpNgGHzWgTfqbLIQJC5SSkljrHq/+EbkZGcsxHgNIv4=\n=R0HJ\n-----END PGP SIGNATURE-----\n", "payload": "tree 6992372cb752fc922dc851b723ff1e31923f2946\nparent 9375207461dc69d622ecc46e924be70c08339d33\nparent 81a2eaa92a221f754455e3abd0ec3939ae06cafe\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1615923415 +0000\ncommitter GitHub <noreply@github.com> 1615923415 +0000\n\nMerge #8042\n\n8042: Add perf_revision to benchmark results r=lnicola a=d2weber\n\nI gave it a try to add the hash as described in #8031 \r\nFeel free to tell me if there is something I could improve.\n\nCo-authored-by: Douglas Weber <douglas.web@web.de>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9caeef98e3ba80c370f08b43f1317bd12ecd5504", "html_url": "https://github.com/rust-lang/rust/commit/9caeef98e3ba80c370f08b43f1317bd12ecd5504", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9caeef98e3ba80c370f08b43f1317bd12ecd5504/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9375207461dc69d622ecc46e924be70c08339d33", "url": "https://api.github.com/repos/rust-lang/rust/commits/9375207461dc69d622ecc46e924be70c08339d33", "html_url": "https://github.com/rust-lang/rust/commit/9375207461dc69d622ecc46e924be70c08339d33"}, {"sha": "81a2eaa92a221f754455e3abd0ec3939ae06cafe", "url": "https://api.github.com/repos/rust-lang/rust/commits/81a2eaa92a221f754455e3abd0ec3939ae06cafe", "html_url": "https://github.com/rust-lang/rust/commit/81a2eaa92a221f754455e3abd0ec3939ae06cafe"}], "stats": {"total": 8, "additions": 6, "deletions": 2}, "files": [{"sha": "97395738b0dff5707e8a9d30d5321d0acaf65b96", "filename": "xtask/src/metrics.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/9caeef98e3ba80c370f08b43f1317bd12ecd5504/xtask%2Fsrc%2Fmetrics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9caeef98e3ba80c370f08b43f1317bd12ecd5504/xtask%2Fsrc%2Fmetrics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/xtask%2Fsrc%2Fmetrics.rs?ref=9caeef98e3ba80c370f08b43f1317bd12ecd5504", "patch": "@@ -26,7 +26,8 @@ impl flags::Metrics {\n         }\n         {\n             let _d = pushd(\"./target/rustc-perf\")?;\n-            cmd!(\"git reset --hard c52ee623e231e7690a93be88d943016968c1036b\").run()?;\n+            let revision = &metrics.perf_revision;\n+            cmd!(\"git reset --hard {revision}\").run()?;\n         }\n \n         let _env = pushenv(\"RA_METRICS\", \"1\");\n@@ -108,6 +109,7 @@ struct Metrics {\n     host: Host,\n     timestamp: SystemTime,\n     revision: String,\n+    perf_revision: String,\n     metrics: BTreeMap<String, (u64, Unit)>,\n }\n \n@@ -123,7 +125,8 @@ impl Metrics {\n         let host = Host::new()?;\n         let timestamp = SystemTime::now();\n         let revision = cmd!(\"git rev-parse HEAD\").read()?;\n-        Ok(Metrics { host, timestamp, revision, metrics: BTreeMap::new() })\n+        let perf_revision = \"c52ee623e231e7690a93be88d943016968c1036b\".into();\n+        Ok(Metrics { host, timestamp, revision, perf_revision, metrics: BTreeMap::new() })\n     }\n \n     fn report(&mut self, name: &str, value: u64, unit: Unit) {\n@@ -141,6 +144,7 @@ impl Metrics {\n         let timestamp = self.timestamp.duration_since(UNIX_EPOCH).unwrap();\n         obj.number(\"timestamp\", timestamp.as_secs() as f64);\n         obj.string(\"revision\", &self.revision);\n+        obj.string(\"perf_revision\", &self.perf_revision);\n         let mut metrics = obj.object(\"metrics\");\n         for (k, (value, unit)) in &self.metrics {\n             metrics.array(k).number(*value as f64).string(unit);"}]}