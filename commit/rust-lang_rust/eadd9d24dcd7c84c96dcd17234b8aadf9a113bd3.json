{"sha": "eadd9d24dcd7c84c96dcd17234b8aadf9a113bd3", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVhZGQ5ZDI0ZGNkN2M4NGM5NmRjZDE3MjM0YjhhYWRmOWExMTNiZDM=", "commit": {"author": {"name": "flip1995", "email": "hello@philkrones.com", "date": "2020-04-25T18:51:02Z"}, "committer": {"name": "flip1995", "email": "hello@philkrones.com", "date": "2020-04-25T18:51:02Z"}, "message": "Don't trigger while_let_on_iterator when the iterator is recreated every iteration", "tree": {"sha": "3b729e3cc898244fe80a21c0943b101f96f0d5a2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3b729e3cc898244fe80a21c0943b101f96f0d5a2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/eadd9d24dcd7c84c96dcd17234b8aadf9a113bd3", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEqv54U47RUUXZfOLnLO/Nsn7QvnkFAl6khpYACgkQLO/Nsn7Q\nvnklrA//YK2Q9dTdL7dNMXhT9sSFBIkLWMqJLOeBQDf5k7v78ie1JnJb9HCtjIww\nhGlTr7bxIboi/f1iMnMEMCMJFZiVtentEO0eGKiZ4Vs2Oxd+KaLzxOd69PQhgyMR\neJT8mKAVGl3eRNiyTiLTIRG12gIayUXWBbV2KwiybilCJyadedcJwBbX4ErrZAAy\n2N1EWkYm/9CSddmYleG3Vr19srcF0KRULGK/0wAhvCeD8N1LZEwi/KTMKEjFkBu4\nAh0AvzSx3nYxNNP4da9K+HUbm+342OeYjxk0Dj9WZAO22/FBsf0aghzb2o2VyBkI\nFQPLnrcToJ08AKTmCCSmoONEx9Sazc4T69VH2bvYm1eTxoZIhkDG3dG+Uf/wsSlR\ni14qsQtvOOb5AGVr4SEF2OfrmuzddTvynT5QhhCaMH48mB8icai6slufZhOX0W0G\nbuASK+64kfN4LnxfFZssspDV46sLx+yuwge/6wzW4R0Jcy6Rz5lWqfMg4OIHOrdp\n4pZCjbvtvyNMy960FMb1n/A73KNdROpTcEjace/rJQIe8h01LP1FOK++AZdlAr4y\n0IYnKNuDtKHT3kYNYKfEUofuTaWHAA/tzo+2eRsKwlGFnD0R7Bh83JAAPj5Ncztp\nIdJFx9Le+e8M4RzV/BHW6AYdFWkAkZBxXmFT1WphWiilExqiNjA=\n=2PnG\n-----END PGP SIGNATURE-----", "payload": "tree 3b729e3cc898244fe80a21c0943b101f96f0d5a2\nparent 6ffe725bbcbcbad4caf4b10e546687c13c1d2ac7\nauthor flip1995 <hello@philkrones.com> 1587840662 +0200\ncommitter flip1995 <hello@philkrones.com> 1587840662 +0200\n\nDon't trigger while_let_on_iterator when the iterator is recreated every iteration\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/eadd9d24dcd7c84c96dcd17234b8aadf9a113bd3", "html_url": "https://github.com/rust-lang/rust/commit/eadd9d24dcd7c84c96dcd17234b8aadf9a113bd3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/eadd9d24dcd7c84c96dcd17234b8aadf9a113bd3/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6ffe725bbcbcbad4caf4b10e546687c13c1d2ac7", "url": "https://api.github.com/repos/rust-lang/rust/commits/6ffe725bbcbcbad4caf4b10e546687c13c1d2ac7", "html_url": "https://github.com/rust-lang/rust/commit/6ffe725bbcbcbad4caf4b10e546687c13c1d2ac7"}], "stats": {"total": 11, "additions": 11, "deletions": 0}, "files": [{"sha": "6e9b7f685eb11bb1f2f0e340f2fe50f62d4a4291", "filename": "clippy_lints/src/loops.rs", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/eadd9d24dcd7c84c96dcd17234b8aadf9a113bd3/clippy_lints%2Fsrc%2Floops.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eadd9d24dcd7c84c96dcd17234b8aadf9a113bd3/clippy_lints%2Fsrc%2Floops.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Floops.rs?ref=eadd9d24dcd7c84c96dcd17234b8aadf9a113bd3", "patch": "@@ -566,6 +566,17 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for Loops {\n             ) = (pat, &match_expr.kind)\n             {\n                 let iter_expr = &method_args[0];\n+\n+                // Don't lint when the iterator is recreated on every iteration\n+                if_chain! {\n+                    if let ExprKind::MethodCall(..) | ExprKind::Call(..) = iter_expr.kind;\n+                    if let Some(iter_def_id) = get_trait_def_id(cx, &paths::ITERATOR);\n+                    if implements_trait(cx, cx.tables.expr_ty(iter_expr), iter_def_id, &[]);\n+                    then {\n+                        return;\n+                    }\n+                }\n+\n                 let lhs_constructor = last_path_segment(qpath);\n                 if method_path.ident.name == sym!(next)\n                     && match_trait_method(cx, match_expr, &paths::ITERATOR)"}]}