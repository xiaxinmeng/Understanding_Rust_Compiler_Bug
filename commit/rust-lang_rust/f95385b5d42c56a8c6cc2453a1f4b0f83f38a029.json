{"sha": "f95385b5d42c56a8c6cc2453a1f4b0f83f38a029", "node_id": "C_kwDOAAsO6NoAKGY5NTM4NWI1ZDQyYzU2YThjNmNjMjQ1M2ExZjRiMGY4M2YzOGEwMjk", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-12-02T07:28:09Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-12-02T07:28:09Z"}, "message": "Rollup merge of #105132 - GuillaumeGomez:migrate-summary-toggle-to-var, r=notriddle\n\nMigrate summary toggle filter to CSS variable\n\nr? `@notriddle`", "tree": {"sha": "f1697a3f751a932a94b86cb820a4c0388331a993", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f1697a3f751a932a94b86cb820a4c0388331a993"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f95385b5d42c56a8c6cc2453a1f4b0f83f38a029", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjiakJCRBK7hj4Ov3rIwAArQQIAC3iPM67HPzlVAPX7h0aS+rC\nVm4k4LDHhZAOlBitojuY+QQVsNOt6pRsix3b4D5aMflYsnT6LF7URq2w4hYwGME7\n4nPpg5Kp1Vm9z8SsncVSEeflCJa2DOyEJmLihjL2RnB8atiCiX4uiCegP5fdloTy\nfLDb9mXwUbJjTcSkWYHfn0zW3bhXsIl1KKl5myFXI5Osfk85HQsEh9yns0pwYX5I\npnm5QnDBEZt7xj/enFsES7qW1sarN/XrbpjGvk/8rRjIkwKqxBae9/NmfFOEKKDz\nev21m1G3NC7iSjd2xIsJQDFIK9bnYFjIbDaOkeZp/90T8k9sVIHILkv2mC+MWxs=\n=KhnH\n-----END PGP SIGNATURE-----\n", "payload": "tree f1697a3f751a932a94b86cb820a4c0388331a993\nparent 4c4dec440837cc9dc3287c5d1ba20def25d11838\nparent 188f31eba0c190425bb1fde67005cfd535686c36\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1669966089 +0100\ncommitter GitHub <noreply@github.com> 1669966089 +0100\n\nRollup merge of #105132 - GuillaumeGomez:migrate-summary-toggle-to-var, r=notriddle\n\nMigrate summary toggle filter to CSS variable\n\nr? `@notriddle`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f95385b5d42c56a8c6cc2453a1f4b0f83f38a029", "html_url": "https://github.com/rust-lang/rust/commit/f95385b5d42c56a8c6cc2453a1f4b0f83f38a029", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f95385b5d42c56a8c6cc2453a1f4b0f83f38a029/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4c4dec440837cc9dc3287c5d1ba20def25d11838", "url": "https://api.github.com/repos/rust-lang/rust/commits/4c4dec440837cc9dc3287c5d1ba20def25d11838", "html_url": "https://github.com/rust-lang/rust/commit/4c4dec440837cc9dc3287c5d1ba20def25d11838"}, {"sha": "188f31eba0c190425bb1fde67005cfd535686c36", "url": "https://api.github.com/repos/rust-lang/rust/commits/188f31eba0c190425bb1fde67005cfd535686c36", "html_url": "https://github.com/rust-lang/rust/commit/188f31eba0c190425bb1fde67005cfd535686c36"}], "stats": {"total": 41, "additions": 33, "deletions": 8}, "files": [{"sha": "e94bb4490dfc17457090935838417ccbd7b87590", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f95385b5d42c56a8c6cc2453a1f4b0f83f38a029/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/f95385b5d42c56a8c6cc2453a1f4b0f83f38a029/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=f95385b5d42c56a8c6cc2453a1f4b0f83f38a029", "patch": "@@ -1516,6 +1516,7 @@ details.rustdoc-toggle > summary::before {\n \tdisplay: inline-block;\n \tvertical-align: middle;\n \topacity: .5;\n+\tfilter: var(--toggle-filter);\n }\n \n details.rustdoc-toggle > summary.hideme > span,"}, {"sha": "6e0905e730d0896f2e12bd2db518e4d0ca5918f8", "filename": "src/librustdoc/html/static/css/themes/ayu.css", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/f95385b5d42c56a8c6cc2453a1f4b0f83f38a029/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "raw_url": "https://github.com/rust-lang/rust/raw/f95385b5d42c56a8c6cc2453a1f4b0f83f38a029/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css?ref=f95385b5d42c56a8c6cc2453a1f4b0f83f38a029", "patch": "@@ -21,6 +21,7 @@ Original by Dempfi (https://github.com/dempfi/ayu)\n \t--right-side-color: grey;\n \t--code-attribute-color: #999;\n \t--toggles-color: #999;\n+\t--toggle-filter: invert(100%);\n \t--search-input-focused-border-color: #5c6773; /* Same as `--border-color`. */\n \t--copy-path-button-color: #fff;\n \t--copy-path-img-filter: invert(70%);\n@@ -158,10 +159,6 @@ body.source .example-wrap pre.rust a {\n \tbackground: #333;\n }\n \n-details.rustdoc-toggle > summary::before {\n-\tfilter: invert(100%);\n-}\n-\n .module-item .stab,\n .import-item .stab {\n \tcolor: #000;"}, {"sha": "334fc3de5616d5103d8ab484c74106451c369620", "filename": "src/librustdoc/html/static/css/themes/dark.css", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/f95385b5d42c56a8c6cc2453a1f4b0f83f38a029/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/f95385b5d42c56a8c6cc2453a1f4b0f83f38a029/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css?ref=f95385b5d42c56a8c6cc2453a1f4b0f83f38a029", "patch": "@@ -16,6 +16,7 @@\n \t--right-side-color: grey;\n \t--code-attribute-color: #999;\n \t--toggles-color: #999;\n+\t--toggle-filter: invert(100%);\n \t--search-input-focused-border-color: #008dfd;\n \t--copy-path-button-color: #999;\n \t--copy-path-img-filter: invert(50%);\n@@ -89,10 +90,6 @@ body.source .example-wrap pre.rust a {\n \tbackground: #333;\n }\n \n-details.rustdoc-toggle > summary::before {\n-\tfilter: invert(100%);\n-}\n-\n #titles > button:not(.selected) {\n \tbackground-color: #252525;\n \tborder-top-color: #252525;"}, {"sha": "453e7508af4ba85eefdc211ce913d0cd1e2eedc2", "filename": "src/librustdoc/html/static/css/themes/light.css", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f95385b5d42c56a8c6cc2453a1f4b0f83f38a029/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "raw_url": "https://github.com/rust-lang/rust/raw/f95385b5d42c56a8c6cc2453a1f4b0f83f38a029/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css?ref=f95385b5d42c56a8c6cc2453a1f4b0f83f38a029", "patch": "@@ -16,6 +16,7 @@\n \t--right-side-color: grey;\n \t--code-attribute-color: #999;\n \t--toggles-color: #999;\n+\t--toggle-filter: none;\n \t--search-input-focused-border-color: #66afe9;\n \t--copy-path-button-color: #999;\n \t--copy-path-img-filter: invert(50%);"}, {"sha": "b7d1072376758dd65efa16143ca9dc9dd7fcb42c", "filename": "src/test/rustdoc-gui/toggle-docs.goml", "status": "modified", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/f95385b5d42c56a8c6cc2453a1f4b0f83f38a029/src%2Ftest%2Frustdoc-gui%2Ftoggle-docs.goml", "raw_url": "https://github.com/rust-lang/rust/raw/f95385b5d42c56a8c6cc2453a1f4b0f83f38a029/src%2Ftest%2Frustdoc-gui%2Ftoggle-docs.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Ftoggle-docs.goml?ref=f95385b5d42c56a8c6cc2453a1f4b0f83f38a029", "patch": "@@ -40,3 +40,32 @@ assert-attribute-false: (\n click: \"#toggle-all-docs\"\n wait-for-text: (\"#toggle-all-docs\", \"[\u2212]\")\n assert-attribute: (\"details.rustdoc-toggle\", {\"open\": \"\"}, ALL)\n+\n+// Checking the toggles style.\n+show-text: true\n+define-function: (\n+    \"check-color\",\n+    (theme, filter),\n+    [\n+        // Setting the theme.\n+\t(\"local-storage\", {\"rustdoc-theme\": |theme|, \"rustdoc-use-system-theme\": \"false\"}),\n+        // We reload the page so the local storage settings are being used.\n+        (\"reload\"),\n+\n+        (\"assert-css\", (\"details.rustdoc-toggle > summary::before\", {\n+            \"opacity\": \"0.5\",\n+            \"filter\": |filter|,\n+        }, ALL)),\n+        (\"move-cursor-to\", \"details.rustdoc-toggle summary\"),\n+        (\"assert-css\", (\"details.rustdoc-toggle > summary:hover::before\", {\n+            \"opacity\": \"1\",\n+            \"filter\": |filter|,\n+        })),\n+        // moving the cursor somewhere else to not mess with next function calls.\n+        (\"move-cursor-to\", \".search-input\"),\n+    ]\n+)\n+\n+call-function: (\"check-color\", {\"theme\": \"ayu\", \"filter\": \"invert(1)\"})\n+call-function: (\"check-color\", {\"theme\": \"dark\", \"filter\": \"invert(1)\"})\n+call-function: (\"check-color\", {\"theme\": \"light\", \"filter\": \"none\"})"}]}