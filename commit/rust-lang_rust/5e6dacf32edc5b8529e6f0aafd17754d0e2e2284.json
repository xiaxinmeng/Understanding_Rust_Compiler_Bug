{"sha": "5e6dacf32edc5b8529e6f0aafd17754d0e2e2284", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVlNmRhY2YzMmVkYzViODUyOWU2ZjBhYWZkMTc3NTRkMGUyZTIyODQ=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2013-03-14T22:37:38Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2013-03-18T23:59:37Z"}, "message": "mk: If NO_REBUILD is set then don't rebuild core/std before testing\n\nCan make turnaround of testing changes to core/std/syntax much faster.", "tree": {"sha": "aadbccfc982ec0d81580ad5fdda566f3cd1f007a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/aadbccfc982ec0d81580ad5fdda566f3cd1f007a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5e6dacf32edc5b8529e6f0aafd17754d0e2e2284", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5e6dacf32edc5b8529e6f0aafd17754d0e2e2284", "html_url": "https://github.com/rust-lang/rust/commit/5e6dacf32edc5b8529e6f0aafd17754d0e2e2284", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5e6dacf32edc5b8529e6f0aafd17754d0e2e2284/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9a075f264a1024a3c03edc033be59971ad590171", "url": "https://api.github.com/repos/rust-lang/rust/commits/9a075f264a1024a3c03edc033be59971ad590171", "html_url": "https://github.com/rust-lang/rust/commit/9a075f264a1024a3c03edc033be59971ad590171"}], "stats": {"total": 14, "additions": 11, "deletions": 3}, "files": [{"sha": "f96b7325f60d4abab77a4b8f576c87377eb62657", "filename": "mk/tests.mk", "status": "modified", "additions": 11, "deletions": 3, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/5e6dacf32edc5b8529e6f0aafd17754d0e2e2284/mk%2Ftests.mk", "raw_url": "https://github.com/rust-lang/rust/raw/5e6dacf32edc5b8529e6f0aafd17754d0e2e2284/mk%2Ftests.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftests.mk?ref=5e6dacf32edc5b8529e6f0aafd17754d0e2e2284", "patch": "@@ -244,21 +244,29 @@ $(foreach host,$(CFG_HOST_TRIPLES), \\\n \n define TEST_RUNNER\n \n+# If NO_REBUILD is set then break the dependencies on std so we can\n+# test crates without rebuilding core and std first\n+ifeq ($(NO_REBUILD),)\n+STDTESTDEP_$(1)_$(2)_$(3) = $$(TLIB$(1)_T_$(2)_H_$(3))/$$(CFG_STDLIB_$(2))\n+else\n+STDTESTDEP_$(1)_$(2)_$(3) =\n+endif\n+\n $(3)/test/coretest.stage$(1)-$(2)$$(X_$(2)):\t\t\t\\\n \t\t$$(CORELIB_CRATE) $$(CORELIB_INPUTS)\t\\\n-\t\t$$(TLIB$(1)_T_$(2)_H_$(3))/$$(CFG_STDLIB_$(2))\n+\t\t$$(STDTESTDEP_$(1)_$(2)_$(3))\n \t@$$(call E, compile_and_link: $$@)\n \t$$(STAGE$(1)_T_$(2)_H_$(3)) -o $$@ $$< --test\n \n $(3)/test/stdtest.stage$(1)-$(2)$$(X_$(2)):\t\t\t\\\n \t\t$$(STDLIB_CRATE) $$(STDLIB_INPUTS)\t\\\n-\t\t$$(TLIB$(1)_T_$(2)_H_$(3))/$$(CFG_STDLIB_$(2))\n+\t\t$$(STDTESTDEP_$(1)_$(2)_$(3))\n \t@$$(call E, compile_and_link: $$@)\n \t$$(STAGE$(1)_T_$(2)_H_$(3)) -o $$@ $$< --test\n \n $(3)/test/syntaxtest.stage$(1)-$(2)$$(X_$(2)):\t\t\t\\\n \t\t$$(LIBSYNTAX_CRATE) $$(LIBSYNTAX_INPUTS)\t\\\n-\t\t$$(TLIB$(1)_T_$(2)_H_$(3))/$$(CFG_STDLIB_$(2))\n+\t\t$$(STDTESTDEP_$(1)_$(2)_$(3))\n \t@$$(call E, compile_and_link: $$@)\n \t$$(STAGE$(1)_T_$(2)_H_$(3)) -o $$@ $$< --test\n "}]}