{"sha": "1c1c7949ab6a8d4150b7e645ae4779677e86ebd1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFjMWM3OTQ5YWI2YThkNDE1MGI3ZTY0NWFlNDc3OTY3N2U4NmViZDE=", "commit": {"author": {"name": "Aaron Hill", "email": "aa1ronham@gmail.com", "date": "2021-07-17T13:31:13Z"}, "committer": {"name": "Aaron Hill", "email": "aa1ronham@gmail.com", "date": "2021-07-18T04:03:58Z"}, "message": "Add test for `#[allow]` for warnings on attribute macro", "tree": {"sha": "db75cbdc7f3fcf727053a018cf198f63966401da", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/db75cbdc7f3fcf727053a018cf198f63966401da"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1c1c7949ab6a8d4150b7e645ae4779677e86ebd1", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE7J9Gc3TfBwj2K399tAh+UQ6YsWQFAmDzqC4ACgkQtAh+UQ6Y\nsWTxOg/7BcouPM40kQBNqzWTy7HhHkxpeivIJOJHSD+g/jHalXDxkSYPZVz7b3Ty\n+DLko3/eTW94EKM4Iau20VxwU7vhiUJ//kZxewvaNFrSSVqpjLRfpBIiqqFcICgZ\n4icmuXRUGyyzAHFK9rg5LeTddZwu5VTgQRQ3CdsnRtOslW94q8WO50ICZWy8vs5h\n5segammPomyWpova4LxZ2tjt2YjvIeheaQhaU2h4rVabzGi1hsgVv/KVAu3dwg9w\nx3qyaxAqK5bpK/foI6xdkGjPRwFaasJiboBCyyTF3y7WPYC14fJAYNSQLfYiZ2P3\navkC5oRAVHuD+QZhvo9ryTWFREr1Ee1501cGoUXftVAjU0pqTaZ5dzB3YH+DV6d/\nTg3yraKclLlQTd5C3eQR+Q0JKri8sbZgJpoz2HZ9H4lMNoMNu62D/fMrYs/a3Lxb\nc0nADTDYIQ8GpW22U2qt6a5id8+u0M/7ODUz7xiSbf+MV7d7tVx8OgZfG1pAeaxH\n/mPE/hyacKSQzLcgbHiJnXEOv+OiqOp+idhuARNzx7f2c84WzIbzpUWSDT0Bcz9v\n9rR4cufU68ymmenPbEAfOcWUjtH6lPbw3l+e/FXYiy5p0ECYsZgNqzk878Ui6szU\naVhk3+YgdUT+8pgHmWIQuSGByedDEqDiWSw4gUjpTp1GwGwNVhY=\n=30Rf\n-----END PGP SIGNATURE-----", "payload": "tree db75cbdc7f3fcf727053a018cf198f63966401da\nparent 7ca089c6d2e834ea007d7a62b8bbbe0c880de4a2\nauthor Aaron Hill <aa1ronham@gmail.com> 1626528673 -0500\ncommitter Aaron Hill <aa1ronham@gmail.com> 1626581038 -0500\n\nAdd test for `#[allow]` for warnings on attribute macro\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1c1c7949ab6a8d4150b7e645ae4779677e86ebd1", "html_url": "https://github.com/rust-lang/rust/commit/1c1c7949ab6a8d4150b7e645ae4779677e86ebd1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1c1c7949ab6a8d4150b7e645ae4779677e86ebd1/comments", "author": {"login": "Aaron1011", "id": 1408859, "node_id": "MDQ6VXNlcjE0MDg4NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1408859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aaron1011", "html_url": "https://github.com/Aaron1011", "followers_url": "https://api.github.com/users/Aaron1011/followers", "following_url": "https://api.github.com/users/Aaron1011/following{/other_user}", "gists_url": "https://api.github.com/users/Aaron1011/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aaron1011/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aaron1011/subscriptions", "organizations_url": "https://api.github.com/users/Aaron1011/orgs", "repos_url": "https://api.github.com/users/Aaron1011/repos", "events_url": "https://api.github.com/users/Aaron1011/events{/privacy}", "received_events_url": "https://api.github.com/users/Aaron1011/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Aaron1011", "id": 1408859, "node_id": "MDQ6VXNlcjE0MDg4NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1408859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aaron1011", "html_url": "https://github.com/Aaron1011", "followers_url": "https://api.github.com/users/Aaron1011/followers", "following_url": "https://api.github.com/users/Aaron1011/following{/other_user}", "gists_url": "https://api.github.com/users/Aaron1011/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aaron1011/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aaron1011/subscriptions", "organizations_url": "https://api.github.com/users/Aaron1011/orgs", "repos_url": "https://api.github.com/users/Aaron1011/repos", "events_url": "https://api.github.com/users/Aaron1011/events{/privacy}", "received_events_url": "https://api.github.com/users/Aaron1011/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7ca089c6d2e834ea007d7a62b8bbbe0c880de4a2", "url": "https://api.github.com/repos/rust-lang/rust/commits/7ca089c6d2e834ea007d7a62b8bbbe0c880de4a2", "html_url": "https://github.com/rust-lang/rust/commit/7ca089c6d2e834ea007d7a62b8bbbe0c880de4a2"}], "stats": {"total": 69, "additions": 69, "deletions": 0}, "files": [{"sha": "2f484809a5c9941cc3e6f762c19194965d62bf97", "filename": "src/test/ui/proc-macro/auxiliary/call-deprecated.rs", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/1c1c7949ab6a8d4150b7e645ae4779677e86ebd1/src%2Ftest%2Fui%2Fproc-macro%2Fauxiliary%2Fcall-deprecated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1c1c7949ab6a8d4150b7e645ae4779677e86ebd1/src%2Ftest%2Fui%2Fproc-macro%2Fauxiliary%2Fcall-deprecated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Fauxiliary%2Fcall-deprecated.rs?ref=1c1c7949ab6a8d4150b7e645ae4779677e86ebd1", "patch": "@@ -0,0 +1,19 @@\n+// force-host\n+// no-prefer-dynamic\n+\n+#![crate_type = \"proc-macro\"]\n+\n+extern crate proc_macro;\n+use proc_macro::*;\n+\n+#[proc_macro_attribute]\n+#[deprecated(since = \"1.0.0\", note = \"test\")]\n+pub fn attr(_: TokenStream, input: TokenStream) -> TokenStream {\n+    input\n+}\n+\n+#[proc_macro_attribute]\n+#[deprecated(since = \"1.0.0\", note = \"test\")]\n+pub fn attr_remove(_: TokenStream, _: TokenStream) -> TokenStream {\n+    TokenStream::new()\n+}"}, {"sha": "b92cc23638ae1d2cc2a17923d008d2742089b59f", "filename": "src/test/ui/proc-macro/call-deprecated.rs", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/1c1c7949ab6a8d4150b7e645ae4779677e86ebd1/src%2Ftest%2Fui%2Fproc-macro%2Fcall-deprecated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1c1c7949ab6a8d4150b7e645ae4779677e86ebd1/src%2Ftest%2Fui%2Fproc-macro%2Fcall-deprecated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Fcall-deprecated.rs?ref=1c1c7949ab6a8d4150b7e645ae4779677e86ebd1", "patch": "@@ -0,0 +1,34 @@\n+// check-pass\n+// aux-build:call-deprecated.rs\n+\n+extern crate call_deprecated;\n+\n+// These first two `#[allow(deprecated)]` attributes\n+// do nothing, since the AST nodes for `First` and `Second`\n+// haven't been been assigned a `NodeId`.\n+// See #63221 for a discussion about how we should\n+// handle the interaction of 'inert' attributes and\n+// proc-macro attributes.\n+\n+#[allow(deprecated)]\n+#[call_deprecated::attr] //~ WARN use of deprecated macro\n+struct First;\n+\n+#[allow(deprecated)]\n+#[call_deprecated::attr_remove] //~ WARN use of deprecated macro\n+struct Second;\n+\n+#[allow(deprecated)]\n+mod bar {\n+    #[allow(deprecated)]\n+    #[call_deprecated::attr]\n+    struct Third;\n+\n+    #[allow(deprecated)]\n+    #[call_deprecated::attr_remove]\n+    struct Fourth;\n+}\n+\n+\n+fn main() {\n+}"}, {"sha": "3506f9a16a3c4b7ff5ec661c6a4e429a349e3ce3", "filename": "src/test/ui/proc-macro/call-deprecated.stderr", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/1c1c7949ab6a8d4150b7e645ae4779677e86ebd1/src%2Ftest%2Fui%2Fproc-macro%2Fcall-deprecated.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/1c1c7949ab6a8d4150b7e645ae4779677e86ebd1/src%2Ftest%2Fui%2Fproc-macro%2Fcall-deprecated.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Fcall-deprecated.stderr?ref=1c1c7949ab6a8d4150b7e645ae4779677e86ebd1", "patch": "@@ -0,0 +1,16 @@\n+warning: use of deprecated macro `call_deprecated::attr`: test\n+  --> $DIR/call-deprecated.rs:14:3\n+   |\n+LL | #[call_deprecated::attr]\n+   |   ^^^^^^^^^^^^^^^^^^^^^\n+   |\n+   = note: `#[warn(deprecated)]` on by default\n+\n+warning: use of deprecated macro `call_deprecated::attr_remove`: test\n+  --> $DIR/call-deprecated.rs:18:3\n+   |\n+LL | #[call_deprecated::attr_remove]\n+   |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+warning: 2 warnings emitted\n+"}]}