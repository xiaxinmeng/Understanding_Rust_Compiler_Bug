{"sha": "9ac2af1dfc3bac5cce7c731548ec8504bca283c5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjlhYzJhZjFkZmMzYmFjNWNjZTdjNzMxNTQ4ZWM4NTA0YmNhMjgzYzU=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2020-07-22T23:34:46Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-07-22T23:34:46Z"}, "message": "Rollup merge of #74618 - JohnTitor:no-more-bad-placeholder, r=estebank\n\nDo not ICE on assoc type with bad placeholder\n\nFixes #74612\nr? @estebank", "tree": {"sha": "879c3308369cb8a7559916ce1e67d65c3e4ede33", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/879c3308369cb8a7559916ce1e67d65c3e4ede33"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9ac2af1dfc3bac5cce7c731548ec8504bca283c5", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfGM0XCRBK7hj4Ov3rIwAAdHIIADC/40DIiRD8Tm4mKT5cVn/s\nJd9YnXaC5vHldibB2UVRgs4cP0oyQdxZcc7qcG23j0jmnJjfQalZSwgPOFB6JN8N\nx2LtR4376cpX1pPeTNxyB4VEW5tw9P5SM+MzlVKQ8ydinXfCUunU0z6nB269dWYX\njF4ekukwTG5Z33bhScxVI/3CYPUkDcK6m0AnE0fxan8mkZhJMMyIqZ0nwC489iC5\n141S/jYK/8zKxys9DUOLUHq5ShPBtR5fFOcmL+tJuCj/uqi/tl1VZpYj08D7xG91\nIfQb3rIngQ26+qUsS7lk7DyKL9rGkS2rVnvWnGbAUj4Q3ncNsPY7y+V7OPWmnIU=\n=SXQY\n-----END PGP SIGNATURE-----\n", "payload": "tree 879c3308369cb8a7559916ce1e67d65c3e4ede33\nparent 0edf2e618d72c23d429b8c814837404b31267a71\nparent 430bd39a0da2b17e5c7ca4842e25b7f523c51522\nauthor Manish Goregaokar <manishsmail@gmail.com> 1595460886 -0700\ncommitter GitHub <noreply@github.com> 1595460886 -0700\n\nRollup merge of #74618 - JohnTitor:no-more-bad-placeholder, r=estebank\n\nDo not ICE on assoc type with bad placeholder\n\nFixes #74612\nr? @estebank\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9ac2af1dfc3bac5cce7c731548ec8504bca283c5", "html_url": "https://github.com/rust-lang/rust/commit/9ac2af1dfc3bac5cce7c731548ec8504bca283c5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9ac2af1dfc3bac5cce7c731548ec8504bca283c5/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0edf2e618d72c23d429b8c814837404b31267a71", "url": "https://api.github.com/repos/rust-lang/rust/commits/0edf2e618d72c23d429b8c814837404b31267a71", "html_url": "https://github.com/rust-lang/rust/commit/0edf2e618d72c23d429b8c814837404b31267a71"}, {"sha": "430bd39a0da2b17e5c7ca4842e25b7f523c51522", "url": "https://api.github.com/repos/rust-lang/rust/commits/430bd39a0da2b17e5c7ca4842e25b7f523c51522", "html_url": "https://github.com/rust-lang/rust/commit/430bd39a0da2b17e5c7ca4842e25b7f523c51522"}], "stats": {"total": 28, "additions": 21, "deletions": 7}, "files": [{"sha": "cb9348a9521bcd6e05f4061080d41ac76752cdd7", "filename": "src/librustc_typeck/collect.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/9ac2af1dfc3bac5cce7c731548ec8504bca283c5/src%2Flibrustc_typeck%2Fcollect.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9ac2af1dfc3bac5cce7c731548ec8504bca283c5/src%2Flibrustc_typeck%2Fcollect.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcollect.rs?ref=9ac2af1dfc3bac5cce7c731548ec8504bca283c5", "patch": "@@ -730,7 +730,13 @@ fn convert_trait_item(tcx: TyCtxt<'_>, trait_item_id: hir::HirId) {\n             placeholder_type_error(tcx, None, &[], visitor.0, false);\n         }\n \n-        hir::TraitItemKind::Type(_, None) => {}\n+        hir::TraitItemKind::Type(_, None) => {\n+            // #74612: Visit and try to find bad placeholders\n+            // even if there is no concrete type.\n+            let mut visitor = PlaceholderHirTyCollector::default();\n+            visitor.visit_trait_item(trait_item);\n+            placeholder_type_error(tcx, None, &[], visitor.0, false);\n+        }\n     };\n \n     tcx.ensure().predicates_of(def_id);"}, {"sha": "2c8b1e76b1b82984d7a677a07d53c27b6c849f23", "filename": "src/test/ui/typeck/typeck_type_placeholder_item.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9ac2af1dfc3bac5cce7c731548ec8504bca283c5/src%2Ftest%2Fui%2Ftypeck%2Ftypeck_type_placeholder_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9ac2af1dfc3bac5cce7c731548ec8504bca283c5/src%2Ftest%2Fui%2Ftypeck%2Ftypeck_type_placeholder_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftypeck%2Ftypeck_type_placeholder_item.rs?ref=9ac2af1dfc3bac5cce7c731548ec8504bca283c5", "patch": "@@ -194,6 +194,8 @@ trait Qux {\n     const D: _ = 42;\n     //~^ ERROR the type placeholder `_` is not allowed within types on item signatures\n     // type E: _; // FIXME: make the parser propagate the existence of `B`\n+    type F: std::ops::Fn(_);\n+    //~^ ERROR the type placeholder `_` is not allowed within types on item signatures\n }\n impl Qux for Struct {\n     type A = _;"}, {"sha": "782ff4948cda46e9032450e063bc65acbfbd44e8", "filename": "src/test/ui/typeck/typeck_type_placeholder_item.stderr", "status": "modified", "additions": 12, "deletions": 6, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/9ac2af1dfc3bac5cce7c731548ec8504bca283c5/src%2Ftest%2Fui%2Ftypeck%2Ftypeck_type_placeholder_item.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/9ac2af1dfc3bac5cce7c731548ec8504bca283c5/src%2Ftest%2Fui%2Ftypeck%2Ftypeck_type_placeholder_item.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftypeck%2Ftypeck_type_placeholder_item.stderr?ref=9ac2af1dfc3bac5cce7c731548ec8504bca283c5", "patch": "@@ -29,7 +29,7 @@ LL | struct BadStruct2<_, T>(_, T);\n    |                   ^ expected identifier, found reserved identifier\n \n error: associated constant in `impl` without body\n-  --> $DIR/typeck_type_placeholder_item.rs:203:5\n+  --> $DIR/typeck_type_placeholder_item.rs:205:5\n    |\n LL |     const C: _;\n    |     ^^^^^^^^^^-\n@@ -545,6 +545,12 @@ LL |     const D: _ = 42;\n    |              not allowed in type signatures\n    |              help: replace `_` with the correct type: `i32`\n \n+error[E0121]: the type placeholder `_` is not allowed within types on item signatures\n+  --> $DIR/typeck_type_placeholder_item.rs:197:26\n+   |\n+LL |     type F: std::ops::Fn(_);\n+   |                          ^ not allowed in type signatures\n+\n error[E0121]: the type placeholder `_` is not allowed within types on item signatures\n   --> $DIR/typeck_type_placeholder_item.rs:40:24\n    |\n@@ -582,33 +588,33 @@ LL |         fn clone(&self) -> _ { FnTest9 }\n    |                            help: replace with the correct return type: `main::FnTest9`\n \n error[E0121]: the type placeholder `_` is not allowed within types on item signatures\n-  --> $DIR/typeck_type_placeholder_item.rs:199:14\n+  --> $DIR/typeck_type_placeholder_item.rs:201:14\n    |\n LL |     type A = _;\n    |              ^ not allowed in type signatures\n \n error[E0121]: the type placeholder `_` is not allowed within types on item signatures\n-  --> $DIR/typeck_type_placeholder_item.rs:201:14\n+  --> $DIR/typeck_type_placeholder_item.rs:203:14\n    |\n LL |     type B = _;\n    |              ^ not allowed in type signatures\n \n error[E0121]: the type placeholder `_` is not allowed within types on item signatures\n-  --> $DIR/typeck_type_placeholder_item.rs:203:14\n+  --> $DIR/typeck_type_placeholder_item.rs:205:14\n    |\n LL |     const C: _;\n    |              ^ not allowed in type signatures\n \n error[E0121]: the type placeholder `_` is not allowed within types on item signatures\n-  --> $DIR/typeck_type_placeholder_item.rs:206:14\n+  --> $DIR/typeck_type_placeholder_item.rs:208:14\n    |\n LL |     const D: _ = 42;\n    |              ^\n    |              |\n    |              not allowed in type signatures\n    |              help: replace `_` with the correct type: `i32`\n \n-error: aborting due to 66 previous errors\n+error: aborting due to 67 previous errors\n \n Some errors have detailed explanations: E0121, E0282, E0403.\n For more information about an error, try `rustc --explain E0121`."}]}