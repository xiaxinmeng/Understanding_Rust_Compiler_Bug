{"sha": "1273f94cbb19608e6a4e02c54d8543f6fe648a47", "node_id": "MDY6Q29tbWl0NzI0NzEyOjEyNzNmOTRjYmIxOTYwOGU2YTRlMDJjNTRkODU0M2Y2ZmU2NDhhNDc=", "commit": {"author": {"name": "Kevin Ballard", "email": "kevin@sb.org", "date": "2014-05-30T23:35:10Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2014-06-19T00:01:22Z"}, "message": "Add commands :RustEmitIr and :RustEmitAsm", "tree": {"sha": "f25be1eadea7cde0cf190fdb96687facd14c54fb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f25be1eadea7cde0cf190fdb96687facd14c54fb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1273f94cbb19608e6a4e02c54d8543f6fe648a47", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1273f94cbb19608e6a4e02c54d8543f6fe648a47", "html_url": "https://github.com/rust-lang/rust/commit/1273f94cbb19608e6a4e02c54d8543f6fe648a47", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1273f94cbb19608e6a4e02c54d8543f6fe648a47/comments", "author": {"login": "lilyball", "id": 714, "node_id": "MDQ6VXNlcjcxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lilyball", "html_url": "https://github.com/lilyball", "followers_url": "https://api.github.com/users/lilyball/followers", "following_url": "https://api.github.com/users/lilyball/following{/other_user}", "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}", "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions", "organizations_url": "https://api.github.com/users/lilyball/orgs", "repos_url": "https://api.github.com/users/lilyball/repos", "events_url": "https://api.github.com/users/lilyball/events{/privacy}", "received_events_url": "https://api.github.com/users/lilyball/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "918eda59bee9a627919d11b7bc9f909d7a9676ff", "url": "https://api.github.com/repos/rust-lang/rust/commits/918eda59bee9a627919d11b7bc9f909d7a9676ff", "html_url": "https://github.com/rust-lang/rust/commit/918eda59bee9a627919d11b7bc9f909d7a9676ff"}], "stats": {"total": 62, "additions": 62, "deletions": 0}, "files": [{"sha": "c6b9b314da5c4581d2d3f2fdaa17054612f10d73", "filename": "src/etc/vim/autoload/rust.vim", "status": "modified", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/1273f94cbb19608e6a4e02c54d8543f6fe648a47/src%2Fetc%2Fvim%2Fautoload%2Frust.vim", "raw_url": "https://github.com/rust-lang/rust/raw/1273f94cbb19608e6a4e02c54d8543f6fe648a47/src%2Fetc%2Fvim%2Fautoload%2Frust.vim", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fvim%2Fautoload%2Frust.vim?ref=1273f94cbb19608e6a4e02c54d8543f6fe648a47", "patch": "@@ -130,6 +130,39 @@ function! rust#CompleteExpand(lead, line, pos)\n \treturn glob(escape(a:lead, \"*?[\") . '*', 0, 1)\n endfunction\n \n+\" Emit {{{1\n+\n+function! rust#Emit(type, args)\n+\tcall s:WithPath(function(\"s:Emit\"), a:type, a:args)\n+endfunction\n+\n+function! s:Emit(path, type, args)\n+\ttry\n+\t\tlet rustc = exists(\"g:rustc_path\") ? g:rustc_path : \"rustc\"\n+\n+\t\tlet args = [a:path, '--emit', a:type, '-o', '-'] + a:args\n+\t\tlet output = system(shellescape(rustc) . \" \" . join(map(args, \"shellescape(v:val)\")))\n+\t\tif v:shell_error\n+\t\t\techohl WarningMsg\n+\t\t\techo output\n+\t\t\techohl None\n+\t\telse\n+\t\t\tnew\n+\t\t\tsilent put =output\n+\t\t\t1\n+\t\t\td\n+\t\t\tif a:type == \"ir\"\n+\t\t\t\tsetl filetype=llvm\n+\t\t\telseif a:type == \"asm\"\n+\t\t\t\tsetl filetype=asm\n+\t\t\tendif\n+\t\t\tsetl buftype=nofile\n+\t\t\tsetl bufhidden=hide\n+\t\t\tsetl noswapfile\n+\t\tendif\n+\tendtry\n+endfunction\n+\n \" Utility functions {{{1\n \n function! s:WithPath(func, ...)"}, {"sha": "96ed69db635294c1b572f7b270d57b8c24809456", "filename": "src/etc/vim/doc/rust.txt", "status": "modified", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/1273f94cbb19608e6a4e02c54d8543f6fe648a47/src%2Fetc%2Fvim%2Fdoc%2Frust.txt", "raw_url": "https://github.com/rust-lang/rust/raw/1273f94cbb19608e6a4e02c54d8543f6fe648a47/src%2Fetc%2Fvim%2Fdoc%2Frust.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fvim%2Fdoc%2Frust.txt?ref=1273f94cbb19608e6a4e02c54d8543f6fe648a47", "patch": "@@ -107,6 +107,27 @@ COMMANDS                                                       *rust-commands*\n \t\tIf |g:rustc_path| is defined, it is used as the path to rustc.\n \t\tOtherwise it is assumed rustc can be found in $PATH.\n \n+:RustEmitIr [args]                                               *:RustEmitIr*\n+\t\tCompiles the current file to LLVM IR and displays the results\n+\t\tin a new split. If the current file has unsaved changes, it\n+\t\twill be saved first using |:update|. If the current file is an\n+\t\tunnamed buffer, it will be written to a temporary file first.\n+\n+\t\tThe arguments given to |:RustEmitIr| will be passed to rustc.\n+\n+\t\tIf |g:rustc_path| is defined, it is used as the path to rustc.\n+\t\tOtherwise it is assumed rustc can be found in $PATH.\n+\n+:RustEmitAsm [args]                                             *:RustEmitAsm*\n+\t\tCompiles the current file to assembly and displays the results\n+\t\tin a new split. If the current file has unsaved changes, it\n+\t\twill be saved first using |:update|. If the current file is an\n+\t\tunnamed buffer, it will be written to a temporary file first.\n+\n+\t\tThe arguments given to |:RustEmitAsm| will be passed to rustc.\n+\n+\t\tIf |g:rustc_path| is defined, it is used as the path to rustc.\n+\t\tOtherwise it is assumed rustc can be found in $PATH.\n \n ==============================================================================\n MAPPINGS                                                       *rust-mappings*"}, {"sha": "65f9f4105ad8fda5c8d58657f5832072102e47d5", "filename": "src/etc/vim/ftplugin/rust.vim", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/1273f94cbb19608e6a4e02c54d8543f6fe648a47/src%2Fetc%2Fvim%2Fftplugin%2Frust.vim", "raw_url": "https://github.com/rust-lang/rust/raw/1273f94cbb19608e6a4e02c54d8543f6fe648a47/src%2Fetc%2Fvim%2Fftplugin%2Frust.vim", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fvim%2Fftplugin%2Frust.vim?ref=1273f94cbb19608e6a4e02c54d8543f6fe648a47", "patch": "@@ -66,6 +66,12 @@ command! -nargs=* -complete=file -bang -bar -buffer RustRun call rust#Run(<bang>\n \" See |:RustExpand| for docs\n command! -nargs=* -complete=customlist,rust#CompleteExpand -bang -bar -buffer RustExpand call rust#Expand(<bang>0, [<f-args>])\n \n+\" See |:RustEmitIr| for docs\n+command! -nargs=* -bar -buffer RustEmitIr call rust#Emit(\"ir\", [<f-args>])\n+\n+\" See |:RustEmitAsm| for docs\n+command! -nargs=* -bar -buffer RustEmitAsm call rust#Emit(\"asm\", [<f-args>])\n+\n \" Mappings {{{1\n \n \" Bind \u2318R in MacVim to :RustRun\n@@ -91,6 +97,8 @@ let b:undo_ftplugin = \"\n \t\t\\|unlet! b:rust_last_rustc_args b:rust_last_args\n \t\t\\|delcommand RustRun\n \t\t\\|delcommand RustExpand\n+\t\t\\|delcommand RustEmitIr\n+\t\t\\|delcommand RustEmitAsm\n \t\t\\|nunmap <buffer> <D-r>\n \t\t\\|nunmap <buffer> <D-R>\n \t\t\\|nunmap <buffer> [["}]}