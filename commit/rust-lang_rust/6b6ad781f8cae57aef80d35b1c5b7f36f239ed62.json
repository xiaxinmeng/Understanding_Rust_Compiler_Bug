{"sha": "6b6ad781f8cae57aef80d35b1c5b7f36f239ed62", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZiNmFkNzgxZjhjYWU1N2FlZjgwZDM1YjFjNWI3ZjM2ZjIzOWVkNjI=", "commit": {"author": {"name": "Deadbeef", "email": "ent3rm4n@gmail.com", "date": "2021-07-26T04:06:55Z"}, "committer": {"name": "Deadbeef", "email": "ent3rm4n@gmail.com", "date": "2021-08-13T09:28:51Z"}, "message": "Fix call-generic-method-nonconst test", "tree": {"sha": "5efac6efd2ad2a95bde328e8c6efab6ec92db77f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5efac6efd2ad2a95bde328e8c6efab6ec92db77f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6b6ad781f8cae57aef80d35b1c5b7f36f239ed62", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEQ7Fl7qPq2YcWF1dqAn35M4hird0FAmEWO1MACgkQAn35M4hi\nrd3XvQ/8D1QPFKqQ2hmqcUoJ8sB5UTrKCw4QQm4jYLR7ZL/RbVbIrLXJQMXAwWwQ\nk9nc1ay52eYPvQt08+1Q+3Sg+bVAm9ap0GLcL5V885a6801ocg41oTogZMTf6sfa\nE5Jk77UYXMnT2ZhAyf85Iol4NGzHeDX3/320t4xn4MoI+kgH+9xJHNeU3ddSMSUw\nScvaodK5pGYhAfClN+NNUs14WspPe8ARh8nhCyrtE08RC3+1n4EPiO4XafWuDfUc\nFDf0dtr54pjrJYlExRZmH4kU6sO5oaYtpIVrDjl+i7Ohht64fy02hONS1j0wXKUK\nKHsek3qsKPyfvEjvx1tvVZzSvNfD6Qjd8Iy4v75tNKvFss750Ao1a+pXlMkYf4SS\njoAn6FYHT3di8iJHOvUSDN4jiuYll2jBZfzdKMljBQSwCXe1dYq/mvkFJ3fG6M+B\nC990I2RA/m7TwPc1hsxZfx0ofCWio8pBq5rC2W8GRTbszyZlbon9v0E2+w1yadS1\nEv4BI/VFal/R1Ne/SpTkk8OQY7t9Y/wLAYa1kLpDFdMXZNdCcajKzTpC2pL8h596\nv3JS0Nk7dso44N4+IrRrS9a1Q6vmPxapDgNzoKpAvVANm9fnlJHQinbRhmK75JT4\ntZZxDzDZro7JbGVWQXZ9L1AJJO7hZubqwpC2ucMr0PsOj+UkOOs=\n=tPhZ\n-----END PGP SIGNATURE-----", "payload": "tree 5efac6efd2ad2a95bde328e8c6efab6ec92db77f\nparent 7106f8d8ee2574c4fbd9b89e76bc1d177e867876\nauthor Deadbeef <ent3rm4n@gmail.com> 1627272415 +0800\ncommitter Deadbeef <ent3rm4n@gmail.com> 1628846931 +0000\n\nFix call-generic-method-nonconst test\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6b6ad781f8cae57aef80d35b1c5b7f36f239ed62", "html_url": "https://github.com/rust-lang/rust/commit/6b6ad781f8cae57aef80d35b1c5b7f36f239ed62", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6b6ad781f8cae57aef80d35b1c5b7f36f239ed62/comments", "author": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7106f8d8ee2574c4fbd9b89e76bc1d177e867876", "url": "https://api.github.com/repos/rust-lang/rust/commits/7106f8d8ee2574c4fbd9b89e76bc1d177e867876", "html_url": "https://github.com/rust-lang/rust/commit/7106f8d8ee2574c4fbd9b89e76bc1d177e867876"}], "stats": {"total": 24, "additions": 20, "deletions": 4}, "files": [{"sha": "9fc39afac9f8bfb104872af88cc219f988f09408", "filename": "compiler/rustc_hir/src/hir.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6b6ad781f8cae57aef80d35b1c5b7f36f239ed62/compiler%2Frustc_hir%2Fsrc%2Fhir.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6b6ad781f8cae57aef80d35b1c5b7f36f239ed62/compiler%2Frustc_hir%2Fsrc%2Fhir.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir%2Fsrc%2Fhir.rs?ref=6b6ad781f8cae57aef80d35b1c5b7f36f239ed62", "patch": "@@ -3261,7 +3261,7 @@ impl<'hir> Node<'hir> {\n         }\n     }\n \n-    /// Returns `Constness::Const` when this node is a const fn/impl.\n+    /// Returns `Constness::Const` when this node is a const fn/impl/item.\n     pub fn constness(&self) -> Constness {\n         match self {\n             Node::Item(Item {\n@@ -3278,6 +3278,10 @@ impl<'hir> Node<'hir> {\n             })\n             | Node::Item(Item { kind: ItemKind::Impl(Impl { constness, .. }), .. }) => *constness,\n \n+            Node::Item(Item { kind: ItemKind::Const(..), .. })\n+            | Node::TraitItem(TraitItem { kind: TraitItemKind::Const(..), .. })\n+            | Node::ImplItem(ImplItem { kind: ImplItemKind::Const(..), .. }) => Constness::Const,\n+\n             _ => Constness::NotConst,\n         }\n     }"}, {"sha": "8343974f8c7e756358600e41d278e2cd72249c35", "filename": "src/test/ui/rfc-2632-const-trait-impl/call-generic-method-nonconst.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/6b6ad781f8cae57aef80d35b1c5b7f36f239ed62/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fcall-generic-method-nonconst.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6b6ad781f8cae57aef80d35b1c5b7f36f239ed62/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fcall-generic-method-nonconst.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fcall-generic-method-nonconst.rs?ref=6b6ad781f8cae57aef80d35b1c5b7f36f239ed62", "patch": "@@ -1,7 +1,5 @@\n-// FIXME(jschievink): this is not rejected correctly (only when the non-const impl is actually used)\n-// ignore-test\n-\n #![feature(const_trait_impl)]\n+#![feature(const_fn_trait_bound)]\n \n struct S;\n "}, {"sha": "75c7cab362147daa42bc0dbf483c69146c543e91", "filename": "src/test/ui/rfc-2632-const-trait-impl/call-generic-method-nonconst.stderr", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/6b6ad781f8cae57aef80d35b1c5b7f36f239ed62/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fcall-generic-method-nonconst.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/6b6ad781f8cae57aef80d35b1c5b7f36f239ed62/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fcall-generic-method-nonconst.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fcall-generic-method-nonconst.stderr?ref=6b6ad781f8cae57aef80d35b1c5b7f36f239ed62", "patch": "@@ -0,0 +1,14 @@\n+error[E0277]: can't compare `S` with `S`\n+  --> $DIR/call-generic-method-nonconst.rs:19:34\n+   |\n+LL | const fn equals_self<T: PartialEq>(t: &T) -> bool {\n+   |                         --------- required by this bound in `equals_self`\n+...\n+LL | pub const EQ: bool = equals_self(&S);\n+   |                                  ^^ no implementation for `S == S`\n+   |\n+   = help: the trait `PartialEq` is not implemented for `S`\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0277`."}]}