{"sha": "f6c4e303c9745b96199ccf3a6d0d77d979ee343d", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY2YzRlMzAzYzk3NDViOTYxOTljY2YzYTZkMGQ3N2Q5NzllZTM0M2Q=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2018-08-06T06:05:04Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-08-06T06:05:04Z"}, "message": "Merge pull request #2999 from flip1995/single_char_pattern\n\nFix single_char_pattern lint for escaped chars", "tree": {"sha": "5e2f49c0ffca8bfa69e747bd069c9d34fa9b06ee", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5e2f49c0ffca8bfa69e747bd069c9d34fa9b06ee"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f6c4e303c9745b96199ccf3a6d0d77d979ee343d", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJbZ+UQCRBK7hj4Ov3rIwAAdHIIAANE8/Eu4u+rygtcGx4OVmSc\npUplJxou/zKTu3l8hItxGXM8sY+BloRA9PeOAVpkAWlFY4/8HUhzVq9rOkOj+wHx\n8PML6yGiIvAq2PEZdWN9swwsNAXkO0b5RjjYL/B0hZ7WdVdILxbpsdwJ5bY5NP3s\naB8bLzH+M4oE5t/mPlsoSSScZzZwSu29GrWVvMFSJReAhOIkFCDttWDY9dPaPa3d\nsxZAfmSWQC8eyG0b9NA29Jl7mNppfxjtmfH6dh2gOXytJ0BZqZibu7Cdav8edDH0\nanTHqYQLgpO3EjEteGpkbQvTSGpTrDDRyD/JiRF67H4Smhq9EfvLdQab/s+/VsM=\n=06Pj\n-----END PGP SIGNATURE-----\n", "payload": "tree 5e2f49c0ffca8bfa69e747bd069c9d34fa9b06ee\nparent 32e4897854c111de6941bade2a9c8f40d009632e\nparent 55672e7e496118ec2c59a4190464b7837d3dcfa4\nauthor Philipp Hansch <dev@phansch.net> 1533535504 +0100\ncommitter GitHub <noreply@github.com> 1533535504 +0100\n\nMerge pull request #2999 from flip1995/single_char_pattern\n\nFix single_char_pattern lint for escaped chars"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f6c4e303c9745b96199ccf3a6d0d77d979ee343d", "html_url": "https://github.com/rust-lang/rust/commit/f6c4e303c9745b96199ccf3a6d0d77d979ee343d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f6c4e303c9745b96199ccf3a6d0d77d979ee343d/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "32e4897854c111de6941bade2a9c8f40d009632e", "url": "https://api.github.com/repos/rust-lang/rust/commits/32e4897854c111de6941bade2a9c8f40d009632e", "html_url": "https://github.com/rust-lang/rust/commit/32e4897854c111de6941bade2a9c8f40d009632e"}, {"sha": "55672e7e496118ec2c59a4190464b7837d3dcfa4", "url": "https://api.github.com/repos/rust-lang/rust/commits/55672e7e496118ec2c59a4190464b7837d3dcfa4", "html_url": "https://github.com/rust-lang/rust/commit/55672e7e496118ec2c59a4190464b7837d3dcfa4"}], "stats": {"total": 14, "additions": 9, "deletions": 5}, "files": [{"sha": "ae661f2106cc3778bab5b595797488aedca382e9", "filename": "clippy_lints/src/methods.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/f6c4e303c9745b96199ccf3a6d0d77d979ee343d/clippy_lints%2Fsrc%2Fmethods.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f6c4e303c9745b96199ccf3a6d0d77d979ee343d/clippy_lints%2Fsrc%2Fmethods.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmethods.rs?ref=f6c4e303c9745b96199ccf3a6d0d77d979ee343d", "patch": "@@ -1899,11 +1899,8 @@ fn lint_chars_last_cmp_with_unwrap<'a, 'tcx>(cx: &LateContext<'a, 'tcx>, info: &\n fn lint_single_char_pattern<'a, 'tcx>(cx: &LateContext<'a, 'tcx>, _expr: &'tcx hir::Expr, arg: &'tcx hir::Expr) {\n     if let Some((Constant::Str(r), _)) = constant(cx, cx.tables, arg) {\n         if r.len() == 1 {\n-            let c = r.chars().next().unwrap();\n             let snip = snippet(cx, arg.span, \"..\");\n-            let hint = snip.replace(\n-                &format!(\"\\\"{}\\\"\", c.escape_default()),\n-                &format!(\"'{}'\", c.escape_default()));\n+            let hint = format!(\"'{}'\", &snip[1..snip.len() - 1]);\n             span_lint_and_sugg(\n                 cx,\n                 SINGLE_CHAR_PATTERN,"}, {"sha": "577a0e270906d674f35532ad8834d9e22b3ddef9", "filename": "tests/ui/single_char_pattern.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f6c4e303c9745b96199ccf3a6d0d77d979ee343d/tests%2Fui%2Fsingle_char_pattern.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f6c4e303c9745b96199ccf3a6d0d77d979ee343d/tests%2Fui%2Fsingle_char_pattern.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsingle_char_pattern.rs?ref=f6c4e303c9745b96199ccf3a6d0d77d979ee343d", "patch": "@@ -42,4 +42,5 @@ fn main() {\n     h.contains(\"X\"); // should not warn\n \n     x.replace(\";\", \",\").split(\",\"); // issue #2978\n+    x.starts_with(\"\\x03\"); // issue #2996\n }"}, {"sha": "044b4909a373b319a246f5c39b4ac255cd626d9f", "filename": "tests/ui/single_char_pattern.stderr", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/f6c4e303c9745b96199ccf3a6d0d77d979ee343d/tests%2Fui%2Fsingle_char_pattern.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/f6c4e303c9745b96199ccf3a6d0d77d979ee343d/tests%2Fui%2Fsingle_char_pattern.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsingle_char_pattern.stderr?ref=f6c4e303c9745b96199ccf3a6d0d77d979ee343d", "patch": "@@ -114,5 +114,11 @@ error: single-character string constant used as pattern\n 44 |     x.replace(\";\", \",\").split(\",\"); // issue #2978\n    |                               ^^^ help: try using a char instead: `','`\n \n-error: aborting due to 19 previous errors\n+error: single-character string constant used as pattern\n+  --> $DIR/single_char_pattern.rs:45:19\n+   |\n+45 |     x.starts_with(\"/x03\"); // issue #2996\n+   |                   ^^^^^^ help: try using a char instead: `'/x03'`\n+\n+error: aborting due to 20 previous errors\n "}]}