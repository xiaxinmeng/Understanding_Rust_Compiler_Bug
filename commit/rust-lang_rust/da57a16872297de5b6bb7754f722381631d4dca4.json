{"sha": "da57a16872297de5b6bb7754f722381631d4dca4", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRhNTdhMTY4NzIyOTdkZTViNmJiNzc1NGY3MjIzODE2MzFkNGRjYTQ=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2020-10-06T06:26:16Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2020-10-06T12:39:04Z"}, "message": "clippy_lints: Replace lazy_static with SyncLazy", "tree": {"sha": "932f980c32bf6ab43c524c74251e4425ca9baae3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/932f980c32bf6ab43c524c74251e4425ca9baae3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/da57a16872297de5b6bb7754f722381631d4dca4", "comment_count": 0, "verification": {"verified": false, "reason": "unknown_key", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEb0jkZw3AJLMiOp9wGI/nM3KGUrEFAl98ZWgACgkQGI/nM3KG\nUrFq9g//YK6IKJ/29QkilY6LXjuthz8DBxkYxMVYzG/0rH/i0QTRkEDSYcnFZA4u\ncT0ZkG5hXoZBGGwUGj82XbIeKOoklk852sQnKV1MXc4NUE4mAaD1oEAwVeqtlkm7\nqRHIJ3i7qZrKESHKQjAv82bks89yRCXnDKtYL+UOx5cmBPNAjJxmaPkQnTgiN7ea\n3bvysvNF5bY1b9nsIVzAzPMoO9Fi2gpOBnJcQaFe28Zf7CEpQKEWsIGNxAFN2dl/\nmtnVnSqgPDnt1xJP3Ha5dK4uSz4p3Yz1O99H3if0U9uAA0W9PjFxJVH2Vgq37gWj\n5rbBNvvuWMTJhIhEldPE2rUCSeHN+eO8Nm76TeKk07/+ep/EPPVUboPB87/uG4+S\nC67MZTFL4FJytMT6aXYF1k3zG4FeKzXvSD3t/fS5R4J+OMjOm9SpsFDHJy0ddKZ0\n2AHileICvaOfr/jGbyzT3rTvs1o9Hb864ZJOYtmWkCJKsrYlKS3G2GASkX1ZYQNV\nqGfDvkcs1fHWI5V1aCkf9G4xeE2yeOWtoH3Cf4oyQ4eMAWEkbkH0rKjY6lmsJz0w\nVb14Lq+rXSLvCyUg+4fykynO3Z0PeUxRWsBRw9Llz7H/FkvvLHW9IGDZOAXYBDOJ\nnTHwDvdoXRO1CRB78otX61ier/GwsSaG4vAxBv706Q2kn8ejLO4=\n=BkzL\n-----END PGP SIGNATURE-----", "payload": "tree 932f980c32bf6ab43c524c74251e4425ca9baae3\nparent 9b4ceee5930e5a7118ac25a0f424a7f83d01980f\nauthor Philipp Hansch <dev@phansch.net> 1601965576 +0200\ncommitter Philipp Hansch <dev@phansch.net> 1601987944 +0200\n\nclippy_lints: Replace lazy_static with SyncLazy\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/da57a16872297de5b6bb7754f722381631d4dca4", "html_url": "https://github.com/rust-lang/rust/commit/da57a16872297de5b6bb7754f722381631d4dca4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/da57a16872297de5b6bb7754f722381631d4dca4/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9b4ceee5930e5a7118ac25a0f424a7f83d01980f", "url": "https://api.github.com/repos/rust-lang/rust/commits/9b4ceee5930e5a7118ac25a0f424a7f83d01980f", "html_url": "https://github.com/rust-lang/rust/commit/9b4ceee5930e5a7118ac25a0f424a7f83d01980f"}], "stats": {"total": 14, "additions": 7, "deletions": 7}, "files": [{"sha": "fcf817b82c89ef95f9785d75ba9e8015d467e67a", "filename": "clippy_lints/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/da57a16872297de5b6bb7754f722381631d4dca4/clippy_lints%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/da57a16872297de5b6bb7754f722381631d4dca4/clippy_lints%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2FCargo.toml?ref=da57a16872297de5b6bb7754f722381631d4dca4", "patch": "@@ -20,7 +20,6 @@ edition = \"2018\"\n cargo_metadata = \"0.11.1\"\n if_chain = \"1.0.0\"\n itertools = \"0.9\"\n-lazy_static = \"1.0.2\"\n pulldown-cmark = { version = \"0.8\", default-features = false }\n quine-mc_cluskey = \"0.2.2\"\n regex-syntax = \"0.6\""}, {"sha": "826a059f92abeeb7fe6f4d5adb97f0a1a7571af6", "filename": "clippy_lints/src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/da57a16872297de5b6bb7754f722381631d4dca4/clippy_lints%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/da57a16872297de5b6bb7754f722381631d4dca4/clippy_lints%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.rs?ref=da57a16872297de5b6bb7754f722381631d4dca4", "patch": "@@ -7,6 +7,7 @@\n #![feature(crate_visibility_modifier)]\n #![feature(drain_filter)]\n #![feature(in_band_lifetimes)]\n+#![feature(once_cell)]\n #![feature(or_patterns)]\n #![feature(rustc_private)]\n #![feature(stmt_expr_attributes)]"}, {"sha": "b4b4b3dc18d51a290feee50ee8a917b8849bb800", "filename": "clippy_lints/src/macro_use.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/da57a16872297de5b6bb7754f722381631d4dca4/clippy_lints%2Fsrc%2Fmacro_use.rs", "raw_url": "https://github.com/rust-lang/rust/raw/da57a16872297de5b6bb7754f722381631d4dca4/clippy_lints%2Fsrc%2Fmacro_use.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmacro_use.rs?ref=da57a16872297de5b6bb7754f722381631d4dca4", "patch": "@@ -18,9 +18,9 @@ declare_clippy_lint! {\n     /// **Known problems:** None.\n     ///\n     /// **Example:**\n-    /// ```rust\n+    /// ```rust,ignore\n     /// #[macro_use]\n-    /// use lazy_static;\n+    /// use some_macro;\n     /// ```\n     pub MACRO_USE_IMPORTS,\n     pedantic,"}, {"sha": "dd2fd0bb445fec5345ff6ed7a898ac067d22f095", "filename": "clippy_lints/src/utils/conf.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/da57a16872297de5b6bb7754f722381631d4dca4/clippy_lints%2Fsrc%2Futils%2Fconf.rs", "raw_url": "https://github.com/rust-lang/rust/raw/da57a16872297de5b6bb7754f722381631d4dca4/clippy_lints%2Fsrc%2Futils%2Fconf.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Fconf.rs?ref=da57a16872297de5b6bb7754f722381631d4dca4", "patch": "@@ -2,10 +2,10 @@\n \n #![deny(clippy::missing_docs_in_private_items)]\n \n-use lazy_static::lazy_static;\n use rustc_ast::ast::{LitKind, MetaItemKind, NestedMetaItem};\n use rustc_span::source_map;\n use source_map::Span;\n+use std::lazy::SyncLazy;\n use std::path::{Path, PathBuf};\n use std::sync::Mutex;\n use std::{env, fmt, fs, io};\n@@ -54,9 +54,8 @@ impl From<io::Error> for Error {\n     }\n }\n \n-lazy_static! {\n-    static ref ERRORS: Mutex<Vec<Error>> = Mutex::new(Vec::new());\n-}\n+/// Vec of errors that might be collected during config toml parsing\n+static ERRORS: SyncLazy<Mutex<Vec<Error>>> = SyncLazy::new(|| Mutex::new(Vec::new()));\n \n macro_rules! define_Conf {\n     ($(#[$doc:meta] ($config:ident, $config_str:literal: $Ty:ty, $default:expr),)+) => {\n@@ -82,6 +81,7 @@ macro_rules! define_Conf {\n                     use serde::Deserialize;\n                     pub fn deserialize<'de, D: serde::Deserializer<'de>>(deserializer: D) -> Result<$Ty, D::Error> {\n                         use super::super::{ERRORS, Error};\n+\n                         Ok(\n                             <$Ty>::deserialize(deserializer).unwrap_or_else(|e| {\n                                 ERRORS"}]}