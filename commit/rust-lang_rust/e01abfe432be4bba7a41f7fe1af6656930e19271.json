{"sha": "e01abfe432be4bba7a41f7fe1af6656930e19271", "node_id": "MDY6Q29tbWl0NzI0NzEyOmUwMWFiZmU0MzJiZTRiYmE3YTQxZjdmZTFhZjY2NTY5MzBlMTkyNzE=", "commit": {"author": {"name": "Andrew Chin", "email": "achin@eminence32.net", "date": "2014-01-11T05:34:09Z"}, "committer": {"name": "Andrew Chin", "email": "achin@eminence32.net", "date": "2014-01-11T05:34:09Z"}, "message": "Fix `rustpkg help` handling\n\nIn general, you could run \"rustpkg help <cmd>\" to see some specific\nusage information for <cmd>.  However, this was handled in a very ad-hoc\nand buggy manner.  For example, running \"rustpkg help prefer\" would\nactually show you the usage information for the \"uninstall\" cmd.\n\nThis commit attempts to fix this by making Help a real Command, and\nmaking the handing of it explicit.", "tree": {"sha": "d7d54e4d4abe920c759b92139380175e999bec00", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d7d54e4d4abe920c759b92139380175e999bec00"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e01abfe432be4bba7a41f7fe1af6656930e19271", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e01abfe432be4bba7a41f7fe1af6656930e19271", "html_url": "https://github.com/rust-lang/rust/commit/e01abfe432be4bba7a41f7fe1af6656930e19271", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e01abfe432be4bba7a41f7fe1af6656930e19271/comments", "author": {"login": "eminence", "id": 402454, "node_id": "MDQ6VXNlcjQwMjQ1NA==", "avatar_url": "https://avatars.githubusercontent.com/u/402454?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eminence", "html_url": "https://github.com/eminence", "followers_url": "https://api.github.com/users/eminence/followers", "following_url": "https://api.github.com/users/eminence/following{/other_user}", "gists_url": "https://api.github.com/users/eminence/gists{/gist_id}", "starred_url": "https://api.github.com/users/eminence/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eminence/subscriptions", "organizations_url": "https://api.github.com/users/eminence/orgs", "repos_url": "https://api.github.com/users/eminence/repos", "events_url": "https://api.github.com/users/eminence/events{/privacy}", "received_events_url": "https://api.github.com/users/eminence/received_events", "type": "User", "site_admin": false}, "committer": {"login": "eminence", "id": 402454, "node_id": "MDQ6VXNlcjQwMjQ1NA==", "avatar_url": "https://avatars.githubusercontent.com/u/402454?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eminence", "html_url": "https://github.com/eminence", "followers_url": "https://api.github.com/users/eminence/followers", "following_url": "https://api.github.com/users/eminence/following{/other_user}", "gists_url": "https://api.github.com/users/eminence/gists{/gist_id}", "starred_url": "https://api.github.com/users/eminence/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eminence/subscriptions", "organizations_url": "https://api.github.com/users/eminence/orgs", "repos_url": "https://api.github.com/users/eminence/repos", "events_url": "https://api.github.com/users/eminence/events{/privacy}", "received_events_url": "https://api.github.com/users/eminence/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f411b94ce1b3d4b6751093beeb7d9674e45db0d3", "url": "https://api.github.com/repos/rust-lang/rust/commits/f411b94ce1b3d4b6751093beeb7d9674e45db0d3", "html_url": "https://github.com/rust-lang/rust/commit/f411b94ce1b3d4b6751093beeb7d9674e45db0d3"}], "stats": {"total": 22, "additions": 20, "deletions": 2}, "files": [{"sha": "721cfedd4aabc37e189a567815ec63888335267a", "filename": "src/librustpkg/context.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/e01abfe432be4bba7a41f7fe1af6656930e19271/src%2Flibrustpkg%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e01abfe432be4bba7a41f7fe1af6656930e19271/src%2Flibrustpkg%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Fcontext.rs?ref=e01abfe432be4bba7a41f7fe1af6656930e19271", "patch": "@@ -229,12 +229,13 @@ pub enum Command {\n     BuildCmd,\n     CleanCmd,\n     DoCmd,\n+    HelpCmd,\n     InfoCmd,\n+    InitCmd,\n     InstallCmd,\n     ListCmd,\n     PreferCmd,\n     TestCmd,\n-    InitCmd,\n     UninstallCmd,\n     UnpreferCmd,\n }\n@@ -246,6 +247,7 @@ impl FromStr for Command {\n             &\"build\" => Some(BuildCmd),\n             &\"clean\" => Some(CleanCmd),\n             &\"do\" => Some(DoCmd),\n+            &\"help\" => Some(HelpCmd),\n             &\"info\" => Some(InfoCmd),\n             &\"install\" => Some(InstallCmd),\n             &\"list\"    => Some(ListCmd),"}, {"sha": "538865acfb504c4a9795b7669f7d096ad7bf7409", "filename": "src/librustpkg/lib.rs", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/e01abfe432be4bba7a41f7fe1af6656930e19271/src%2Flibrustpkg%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e01abfe432be4bba7a41f7fe1af6656930e19271/src%2Flibrustpkg%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Flib.rs?ref=e01abfe432be4bba7a41f7fe1af6656930e19271", "patch": "@@ -43,7 +43,7 @@ use workspace::{each_pkg_parent_workspace, pkg_parent_workspaces, cwd_to_workspa\n use workspace::determine_destination;\n use context::{BuildContext, Trans, Nothing, Pretty, Analysis,\n               LLVMAssemble, LLVMCompileBitcode};\n-use context::{Command, BuildCmd, CleanCmd, DoCmd, InfoCmd, InstallCmd, ListCmd,\n+use context::{Command, BuildCmd, CleanCmd, DoCmd, HelpCmd, InfoCmd, InstallCmd, ListCmd,\n     PreferCmd, TestCmd, InitCmd, UninstallCmd, UnpreferCmd};\n use crate_id::CrateId;\n use package_source::PkgSrc;\n@@ -314,6 +314,18 @@ impl CtxMethods for BuildContext {\n \n                 self.do_cmd(args[0].clone(), args[1].clone());\n             }\n+            HelpCmd => {\n+                if args.len() != 1 {\n+                    return usage::general();\n+                }\n+                match FromStr::from_str(args[0]) {\n+                    Some(help_cmd) => usage::usage_for_command(help_cmd),\n+                    None => {\n+                        usage::general();\n+                        error(format!(\"{} is not a recognized command\", args[0]))\n+                    }\n+                }\n+            }\n             InfoCmd => {\n                 self.info();\n             }"}, {"sha": "ccc0beafd71ca1e34c92975cb473efe4611342d7", "filename": "src/librustpkg/usage.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/e01abfe432be4bba7a41f7fe1af6656930e19271/src%2Flibrustpkg%2Fusage.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e01abfe432be4bba7a41f7fe1af6656930e19271/src%2Flibrustpkg%2Fusage.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustpkg%2Fusage.rs?ref=e01abfe432be4bba7a41f7fe1af6656930e19271", "patch": "@@ -16,6 +16,9 @@ pub fn general() {\n Where <cmd> is one of:\n     build, clean, do, info, install, list, prefer, test, uninstall, unprefer\n \n+For more help on a given command, you can run:\n+    rustpkg help <cmd>\n+\n Options:\n \n     -h, --help                  Display this message\n@@ -162,6 +165,7 @@ pub fn usage_for_command(command: Command){\n         BuildCmd => build(),\n         CleanCmd => clean(),\n         DoCmd => do_cmd(),\n+        HelpCmd => general(),\n         InfoCmd => info(),\n         InstallCmd => install(),\n         ListCmd => list(),"}]}