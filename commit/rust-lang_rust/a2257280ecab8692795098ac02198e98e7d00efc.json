{"sha": "a2257280ecab8692795098ac02198e98e7d00efc", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEyMjU3MjgwZWNhYjg2OTI3OTUwOThhYzAyMTk4ZTk4ZTdkMDBlZmM=", "commit": {"author": {"name": "Oliver Schneider", "email": "git-spam-no-reply9815368754983@oli-obk.de", "date": "2016-09-13T10:41:20Z"}, "committer": {"name": "Oliver Schneider", "email": "git-spam-no-reply9815368754983@oli-obk.de", "date": "2016-09-13T10:41:20Z"}, "message": "don't lint expressions referencing `!` objects, just expressions creating them", "tree": {"sha": "a012492567ce4f24b7f53749349aac39dfecb753", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a012492567ce4f24b7f53749349aac39dfecb753"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a2257280ecab8692795098ac02198e98e7d00efc", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQIcBAABAgAGBQJX19fQAAoJEFbW7qD8Z6xGD3QP+gNSkz9svx88rLjvMV0AhjRv\nqyD6h6Bsll60p4eq3rYa9IMdrKc26SAzSIHchuIZqCwj88uYKDpT4FXDKes40bss\n7T1stZeW4ku7Sdhjwe4cawPgkqHWc/KsdeWYQyXvtzqEUHOkYIGkOEjJsrl9fVQT\n8Rld7u23b406j7eMxVxdqIhDJTXeTq4Ks8exZi1SG99rZHtD/fl5+s1XaK08+rbQ\nrZGbXBh50Vpsu3K1wsK96twO0tu/xKb3LlpdbWfYWPKpCCRH6yEmVk6gwr+P5QV1\ndADqD7y3d14oK5ng000EYadWC501WCLtwSQ/TxKqhXbsGoaFXoKoRlR0q2fg9cvX\nYPEKteRKLzSdEhlHx+3p5xUu7acfDFLLpzuIX/W+w2qJ0OCWJNe8Cz08zwKExD24\nokoQtHWszTLRtY3YllA2iMr7tPdr9XgmjcUzPSNvsoN6R5Bw42nrwYlLyaLGvIY2\nHzU8rmhMiM2eOYaj7CXJEfUM5mCPcfoF7s0d0PeHZv/YtdWWXMH759DkA3HHtc7P\nAVeG6oTULhI2elg8stWee6OiWzwNbSUodDYz3+DID2XrWEPelTj++eppg4/l76UO\nHO16YJL4AIxJnerClP07w3+M3LiPUEdFDpIIE8DrdM+leokBGefojja1X2mA+lkl\nqghZ727fqRlocsqazCsn\n=kv9R\n-----END PGP SIGNATURE-----", "payload": "tree a012492567ce4f24b7f53749349aac39dfecb753\nparent f469860dc23cd432b76a1d6779ce2f1206805c6f\nauthor Oliver Schneider <git-spam-no-reply9815368754983@oli-obk.de> 1473763280 +0200\ncommitter Oliver Schneider <git-spam-no-reply9815368754983@oli-obk.de> 1473763280 +0200\n\ndon't lint expressions referencing `!` objects, just expressions creating them"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a2257280ecab8692795098ac02198e98e7d00efc", "html_url": "https://github.com/rust-lang/rust/commit/a2257280ecab8692795098ac02198e98e7d00efc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a2257280ecab8692795098ac02198e98e7d00efc/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f469860dc23cd432b76a1d6779ce2f1206805c6f", "url": "https://api.github.com/repos/rust-lang/rust/commits/f469860dc23cd432b76a1d6779ce2f1206805c6f", "html_url": "https://github.com/rust-lang/rust/commit/f469860dc23cd432b76a1d6779ce2f1206805c6f"}], "stats": {"total": 9, "additions": 3, "deletions": 6}, "files": [{"sha": "f357cd8f6f9d441073e6db02685bd6e92709a35a", "filename": "clippy_lints/src/eval_order_dependence.rs", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/a2257280ecab8692795098ac02198e98e7d00efc/clippy_lints%2Fsrc%2Feval_order_dependence.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a2257280ecab8692795098ac02198e98e7d00efc/clippy_lints%2Fsrc%2Feval_order_dependence.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Feval_order_dependence.rs?ref=a2257280ecab8692795098ac02198e98e7d00efc", "patch": "@@ -122,9 +122,6 @@ impl<'a, 'tcx> DivergenceVisitor<'a, 'tcx> {\n \n impl<'a, 'tcx, 'v> Visitor<'v> for DivergenceVisitor<'a, 'tcx> {\n     fn visit_expr(&mut self, e: &'v Expr) {\n-        // this match can be replaced by just the default arm, once\n-        // https://github.com/rust-lang/rust/issues/35121 makes sure that\n-        // ! is propagated properly\n         match e.node {\n             ExprAgain(_) |\n             ExprBreak(_) |\n@@ -137,8 +134,8 @@ impl<'a, 'tcx, 'v> Visitor<'v> for DivergenceVisitor<'a, 'tcx> {\n                 _ => {},\n             },\n             ExprMethodCall(..) => { /* TODO */ },\n-            _ => if let ty::TyNever = self.0.tcx.expr_ty(e).sty {\n-                self.report_diverging_sub_expr(e);\n+            _ => {\n+                // do not lint expressions referencing objects of type `!`, as that required a diverging expression to begin with\n             },\n         }\n         self.maybe_walk_expr(e);"}, {"sha": "20b284732b06849fab43440dcdadde3291a5f1d4", "filename": "tests/compile-fail/diverging_sub_expression.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a2257280ecab8692795098ac02198e98e7d00efc/tests%2Fcompile-fail%2Fdiverging_sub_expression.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a2257280ecab8692795098ac02198e98e7d00efc/tests%2Fcompile-fail%2Fdiverging_sub_expression.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-fail%2Fdiverging_sub_expression.rs?ref=a2257280ecab8692795098ac02198e98e7d00efc", "patch": "@@ -10,5 +10,5 @@ fn main() {\n     let b = true;\n     b || diverge(); //~ ERROR sub-expression diverges\n     let y = (5, diverge(), 6); //~ ERROR sub-expression diverges\n-    println!(\"{}\", y.1); //~ ERROR sub-expression diverges\n+    println!(\"{}\", y.1);\n }"}]}