{"sha": "2ba317ddb2d4d31eee07650aa657772d00ca7ac4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJiYTMxN2RkYjJkNGQzMWVlZTA3NjUwYWE2NTc3NzJkMDBjYTdhYzQ=", "commit": {"author": {"name": "Haitao Li", "email": "lihaitao@gmail.com", "date": "2011-12-08T16:01:48Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-12-13T00:15:29Z"}, "message": "build: Temp hack to make transition to new snapshot", "tree": {"sha": "c7642156d0d46c9f1ac4fa41c509673b06c72bdb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c7642156d0d46c9f1ac4fa41c509673b06c72bdb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2ba317ddb2d4d31eee07650aa657772d00ca7ac4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2ba317ddb2d4d31eee07650aa657772d00ca7ac4", "html_url": "https://github.com/rust-lang/rust/commit/2ba317ddb2d4d31eee07650aa657772d00ca7ac4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2ba317ddb2d4d31eee07650aa657772d00ca7ac4/comments", "author": {"login": "lht", "id": 19508, "node_id": "MDQ6VXNlcjE5NTA4", "avatar_url": "https://avatars.githubusercontent.com/u/19508?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lht", "html_url": "https://github.com/lht", "followers_url": "https://api.github.com/users/lht/followers", "following_url": "https://api.github.com/users/lht/following{/other_user}", "gists_url": "https://api.github.com/users/lht/gists{/gist_id}", "starred_url": "https://api.github.com/users/lht/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lht/subscriptions", "organizations_url": "https://api.github.com/users/lht/orgs", "repos_url": "https://api.github.com/users/lht/repos", "events_url": "https://api.github.com/users/lht/events{/privacy}", "received_events_url": "https://api.github.com/users/lht/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "03d1644acc4e4cf69cde361564982c468ce92efa", "url": "https://api.github.com/repos/rust-lang/rust/commits/03d1644acc4e4cf69cde361564982c468ce92efa", "html_url": "https://github.com/rust-lang/rust/commit/03d1644acc4e4cf69cde361564982c468ce92efa"}], "stats": {"total": 31, "additions": 28, "deletions": 3}, "files": [{"sha": "ac57d5f0923be0e987c74d2f775c3de36e847938", "filename": "mk/stage0.mk", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/2ba317ddb2d4d31eee07650aa657772d00ca7ac4/mk%2Fstage0.mk", "raw_url": "https://github.com/rust-lang/rust/raw/2ba317ddb2d4d31eee07650aa657772d00ca7ac4/mk%2Fstage0.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fstage0.mk?ref=2ba317ddb2d4d31eee07650aa657772d00ca7ac4", "patch": "@@ -13,13 +13,21 @@ $(HLIB0_H_$(CFG_HOST_TRIPLE))/$(CFG_RUNTIME): \\\n \t\t$(HBIN0_H_$(CFG_HOST_TRIPLE))/rustc$(X)\n \t$(Q)touch $@\n \n+## FIXME temporary hack for snapshot transition\n+CORELIB_DUMMY :=$(call CFG_LIB_NAME,core-dummy)\n+STDLIB_DUMMY :=$(call CFG_LIB_NAME,std-dummy)\n+\n $(HLIB0_H_$(CFG_HOST_TRIPLE))/$(CFG_CORELIB): \\\n \t\t$(HBIN0_H_$(CFG_HOST_TRIPLE))/rustc$(X)\n \t$(Q)touch $@\n+\t$(foreach target,$(CFG_TARGET_TRIPLES),\\\n+\t$(shell touch $(CFG_HOST_TRIPLE)/stage0/lib/rustc/$(target)/lib/$(CORELIB_DUMMY)))\n \n $(HLIB0_H_$(CFG_HOST_TRIPLE))/$(CFG_STDLIB): \\\n \t\t$(HBIN0_H_$(CFG_HOST_TRIPLE))/rustc$(X)\n \t$(Q)touch $@\n+\t$(foreach target,$(CFG_TARGET_TRIPLES),\\\n+\t$(shell touch $(CFG_HOST_TRIPLE)/stage0/lib/rustc/$(target)/lib/$(STDLIB_DUMMY)))\n \n $(HLIB0_H_$(CFG_HOST_TRIPLE))/$(CFG_RUSTLLVM): \\\n \t\t$(HBIN0_H_$(CFG_HOST_TRIPLE))/rustc$(X)\n@@ -45,12 +53,12 @@ $$(HLIB0_H_$(1))/$$(CFG_RUNTIME): \\\n $$(HLIB0_H_$(1))/$(CFG_CORELIB): \\\n \t\t$$(TLIB$(2)_T_$(1)_H_$(3))/$$(CFG_CORELIB)\n \t@$$(call E, cp: $$@)\n-\t$$(Q)cp $$< $$@\n+\t$$(Q)cp $$(TLIB$(2)_T_$(1)_H_$(3))/$$(CORELIB_GLOB) $$@\n \n $$(HLIB0_H_$(1))/$(CFG_STDLIB): \\\n \t\t$$(TLIB$(2)_T_$(1)_H_$(3))/$$(CFG_STDLIB)\n \t@$$(call E, cp: $$@)\n-\t$$(Q)cp $$< $$@\n+\t$$(Q)cp $$(TLIB$(2)_T_$(1)_H_$(3))/$$(STDLIB_GLOB) $$@\n \n $$(HLIB0_H_$(1))/$(CFG_RUSTLLVM): \\\n \t\t$$(TLIB$(2)_T_$(1)_H_$(3))/$$(CFG_RUSTLLVM)"}, {"sha": "b42a76350d998e342e52e5477f5c4473662bd846", "filename": "src/etc/get-snapshot.py", "status": "modified", "additions": 18, "deletions": 1, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/2ba317ddb2d4d31eee07650aa657772d00ca7ac4/src%2Fetc%2Fget-snapshot.py", "raw_url": "https://github.com/rust-lang/rust/raw/2ba317ddb2d4d31eee07650aa657772d00ca7ac4/src%2Fetc%2Fget-snapshot.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fget-snapshot.py?ref=2ba317ddb2d4d31eee07650aa657772d00ca7ac4", "patch": "@@ -3,13 +3,30 @@\n import os, tarfile, hashlib, re, shutil, sys\n from snapshot import *\n \n+old_snapshot_files = {\n+    \"linux\": [\"bin/rustc\",\n+              \"lib/libcore.so\",\n+              \"lib/libruststd.so\",\n+              \"lib/librustrt.so\",\n+              \"lib/librustllvm.so\"],\n+    \"macos\": [\"bin/rustc\",\n+              \"lib/libcore.dylib\",\n+              \"lib/libruststd.dylib\",\n+              \"lib/librustrt.dylib\",\n+              \"lib/librustllvm.dylib\"],\n+    \"winnt\": [\"bin/rustc.exe\",\n+              \"lib/core.dll\",\n+              \"lib/ruststd.dll\",\n+              \"lib/rustrt.dll\",\n+              \"lib/rustllvm.dll\"]\n+    }\n \n def unpack_snapshot(triple, snap):\n   dl_path = os.path.join(download_dir_base, snap)\n   print(\"opening snapshot \" + dl_path)\n   tar = tarfile.open(dl_path)\n   kernel = get_kernel(triple)\n-  for name in snapshot_files[kernel]:\n+  for name in old_snapshot_files[kernel]:\n     p = \"rust-stage0/\" + name\n     stagep = os.path.join(triple, \"stage0\")\n     fp = os.path.join(stagep, name)"}]}