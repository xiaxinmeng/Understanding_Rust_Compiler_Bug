{"sha": "762f6452b96d93f4f108bf7101189f2688a9dcde", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc2MmY2NDUyYjk2ZDkzZjRmMTA4YmY3MTAxMTg5ZjI2ODhhOWRjZGU=", "commit": {"author": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2019-07-30T04:43:54Z"}, "committer": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2019-07-30T04:43:54Z"}, "message": "review comments", "tree": {"sha": "7002fd74130c00b77536b97047c68db9cf1410a2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7002fd74130c00b77536b97047c68db9cf1410a2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/762f6452b96d93f4f108bf7101189f2688a9dcde", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/762f6452b96d93f4f108bf7101189f2688a9dcde", "html_url": "https://github.com/rust-lang/rust/commit/762f6452b96d93f4f108bf7101189f2688a9dcde", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/762f6452b96d93f4f108bf7101189f2688a9dcde/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "86f4f68b70fb743d05778e88a44bb1259a03e3df", "url": "https://api.github.com/repos/rust-lang/rust/commits/86f4f68b70fb743d05778e88a44bb1259a03e3df", "html_url": "https://github.com/rust-lang/rust/commit/86f4f68b70fb743d05778e88a44bb1259a03e3df"}], "stats": {"total": 31, "additions": 14, "deletions": 17}, "files": [{"sha": "4e16ad0ba0e0823f753bde065713c1bca8224629", "filename": "src/libfmt_macros/lib.rs", "status": "modified", "additions": 5, "deletions": 9, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/762f6452b96d93f4f108bf7101189f2688a9dcde/src%2Flibfmt_macros%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/762f6452b96d93f4f108bf7101189f2688a9dcde/src%2Flibfmt_macros%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibfmt_macros%2Flib.rs?ref=762f6452b96d93f4f108bf7101189f2688a9dcde", "patch": "@@ -514,10 +514,6 @@ impl<'a> Parser<'a> {\n         // Width and precision\n         let mut havewidth = false;\n \n-        let mut width_span_start = 0;\n-        if let Some((pos, '0')) = self.cur.peek() {\n-            width_span_start = *pos;\n-        }\n         if self.consume('0') {\n             // small ambiguity with '0$' as a format string. In theory this is a\n             // '0' flag and then an ill-formatted format string with just a '$'\n@@ -531,11 +527,11 @@ impl<'a> Parser<'a> {\n             }\n         }\n         if !havewidth {\n-            if width_span_start == 0 {\n-                if let Some((pos, _)) = self.cur.peek() {\n-                    width_span_start = *pos;\n-                }\n-            }\n+            let width_span_start = if let Some((pos, _)) = self.cur.peek() {\n+                *pos\n+            } else {\n+                0\n+            };\n             let (w, sp) = self.count(width_span_start);\n             spec.width = w;\n             spec.width_span = sp;"}, {"sha": "b9337fd9fab8890418279f0d4eabe53783a0f29d", "filename": "src/libsyntax_ext/format.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/762f6452b96d93f4f108bf7101189f2688a9dcde/src%2Flibsyntax_ext%2Fformat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/762f6452b96d93f4f108bf7101189f2688a9dcde/src%2Flibsyntax_ext%2Fformat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax_ext%2Fformat.rs?ref=762f6452b96d93f4f108bf7101189f2688a9dcde", "patch": "@@ -586,7 +586,7 @@ impl<'a, 'b> Context<'a, 'b> {\n                     arg.position.index() == simple_arg.position.index();\n \n                 if arg.format.precision_span.is_some() || arg.format.width_span.is_some() {\n-                    self.arg_with_formatting.push(arg.format); //'liself.fmtsp.from_inner(span));\n+                    self.arg_with_formatting.push(arg.format);\n                 }\n                 if !pos_simple || arg.format != simple_arg.format || fill != ' ' {\n                     self.all_pieces_simple = false;"}, {"sha": "6a8fca2a28c546a4afe25598f88b5ebae52dfd4c", "filename": "src/libsyntax_pos/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/762f6452b96d93f4f108bf7101189f2688a9dcde/src%2Flibsyntax_pos%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/762f6452b96d93f4f108bf7101189f2688a9dcde/src%2Flibsyntax_pos%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax_pos%2Flib.rs?ref=762f6452b96d93f4f108bf7101189f2688a9dcde", "patch": "@@ -1402,6 +1402,7 @@ pub struct MalformedSourceMapPositions {\n     pub end_pos: BytePos\n }\n \n+/// Range inside of a `Span` used for diagnostics when we only have access to relative positions.\n #[derive(Copy, Clone, PartialEq, Eq, Debug)]\n pub struct InnerSpan {\n     pub start: usize,"}, {"sha": "336ea2254bf5a698e90b843c3e0c8a0a97d829d0", "filename": "src/test/ui/if/ifmt-bad-arg.stderr", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/762f6452b96d93f4f108bf7101189f2688a9dcde/src%2Ftest%2Fui%2Fif%2Fifmt-bad-arg.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/762f6452b96d93f4f108bf7101189f2688a9dcde/src%2Ftest%2Fui%2Fif%2Fifmt-bad-arg.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fif%2Fifmt-bad-arg.stderr?ref=762f6452b96d93f4f108bf7101189f2688a9dcde", "patch": "@@ -235,10 +235,10 @@ error: 4 positional arguments in format string, but there are 3 arguments\n   --> $DIR/ifmt-bad-arg.rs:81:15\n    |\n LL |     println!(\"{} {:07$.*} {}\", 1, 3.2, 4);\n-   |               ^^ ^^-----^ ^^      --- this parameter corresponds to the precision flag\n-   |                    |  |\n-   |                    |  this precision flag adds an extra required argument at position 1, which is why there are 4 arguments expected\n-   |                    this width flag expects an `usize` argument at position 7, but there are 3 arguments\n+   |               ^^ ^^^----^ ^^      --- this parameter corresponds to the precision flag\n+   |                     | |\n+   |                     | this precision flag adds an extra required argument at position 1, which is why there are 4 arguments expected\n+   |                     this width flag expects an `usize` argument at position 7, but there are 3 arguments\n    |\n    = note: positional arguments are zero-based\n    = note: for information about formatting flags, visit https://doc.rust-lang.org/std/fmt/index.html\n@@ -247,9 +247,9 @@ error: invalid reference to positional argument 7 (there are 3 arguments)\n   --> $DIR/ifmt-bad-arg.rs:84:18\n    |\n LL |     println!(\"{} {:07$} {}\", 1, 3.2, 4);\n-   |                  ^^---^\n-   |                    |\n-   |                    this width flag expects an `usize` argument at position 7, but there are 3 arguments\n+   |                  ^^^--^\n+   |                     |\n+   |                     this width flag expects an `usize` argument at position 7, but there are 3 arguments\n    |\n    = note: positional arguments are zero-based\n    = note: for information about formatting flags, visit https://doc.rust-lang.org/std/fmt/index.html"}]}