{"sha": "0cb367266b0a336c0a18ae999beeadd3235961a2", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBjYjM2NzI2NmIwYTMzNmMwYTE4YWU5OTliZWVhZGQzMjM1OTYxYTI=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2018-02-23T21:52:28Z"}, "committer": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2018-02-28T03:24:16Z"}, "message": "Emit parentheses in suggestion for global paths", "tree": {"sha": "e3e371d55f37efce00161ed4d90b004cb1f1e560", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e3e371d55f37efce00161ed4d90b004cb1f1e560"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0cb367266b0a336c0a18ae999beeadd3235961a2", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEKEMXbnGOy4KpaPA5O79NPi73n5gFAlqWIOAACgkQO79NPi73\nn5hmfhAAohmHM9MF1LJrh+oA2+cH8Ex3AYHT0LyGeUFQuPXcKTW5AqrpZ6Y8FWgJ\nxE2Gz/8k7XXRKqP82Ly57IPHMbstIZvMfH9KxvnK5ghO5Moe9KMBKH9401UOw8V3\nJWSmT0uYw1lPQNB23GiCPuXX25+KAPh1ZVSUNIVkL+fMutqnYiJlYl0jWOsAYGie\nSAHZ2O0Y6y5k63mByIJXw6AMnILHL04MfOiSkqShbx/ASRMyCyQV1/TLfNcV1RiV\nu0IxWadmdsD19ARtdZpgld260LNU7W0087kFumV2EFHmLIfsUQnfKvWJWUETHhZ3\nvWK9t2kJ0A9z+5Dtv3TIr2QVH+kR9LiMyilR+w2d8/VgIDGOlBjm/zuuPQBJyiLO\nLpKTHigmOZuDnjnRNQ1rOTOEXmrAAqsRc+I8JUYQglGny1wRs9XI4rZ7JvO8PsZh\n2naK0k+/6NTigFe0WPs7MXHyQxEfbLMMqu86xp3bftzEk56i7MWUFWNxhAvILnOT\nLZL+wwagZJ6lfNHklfBMbpNf0e/x17WZxLNXmRQ1T2VADmaM4Y4iAT9hCfre0tt6\n4TZvJi4ew9L+8mioxCt1oeu/Ssv65zoqNiHkaJxHHrR321QmDr0THhGh53DTMVfo\nCVHntUNq25zLIcUylF+sjNKiofsAF8Olu+q1TL40rFM+gWgwxOY=\n=CE2k\n-----END PGP SIGNATURE-----", "payload": "tree e3e371d55f37efce00161ed4d90b004cb1f1e560\nparent dd67fe17276e4bf8cd054d2a8453dc58e0571447\nauthor Manish Goregaokar <manishsmail@gmail.com> 1519422748 -0800\ncommitter Manish Goregaokar <manishsmail@gmail.com> 1519788256 -0800\n\nEmit parentheses in suggestion for global paths\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0cb367266b0a336c0a18ae999beeadd3235961a2", "html_url": "https://github.com/rust-lang/rust/commit/0cb367266b0a336c0a18ae999beeadd3235961a2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0cb367266b0a336c0a18ae999beeadd3235961a2/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dd67fe17276e4bf8cd054d2a8453dc58e0571447", "url": "https://api.github.com/repos/rust-lang/rust/commits/dd67fe17276e4bf8cd054d2a8453dc58e0571447", "html_url": "https://github.com/rust-lang/rust/commit/dd67fe17276e4bf8cd054d2a8453dc58e0571447"}], "stats": {"total": 13, "additions": 7, "deletions": 6}, "files": [{"sha": "9d4011fa7ad9f523acacbd60ffa0193907687765", "filename": "src/librustc/hir/lowering.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/0cb367266b0a336c0a18ae999beeadd3235961a2/src%2Flibrustc%2Fhir%2Flowering.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0cb367266b0a336c0a18ae999beeadd3235961a2/src%2Flibrustc%2Fhir%2Flowering.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fhir%2Flowering.rs?ref=0cb367266b0a336c0a18ae999beeadd3235961a2", "patch": "@@ -914,7 +914,7 @@ impl<'a> LoweringContext<'a> {\n                 let qpath = self.lower_qpath(t.id, qself, path, ParamMode::Explicit, itctx);\n                 let ty = self.ty_path(id, t.span, qpath);\n                 if let hir::TyTraitObject(..) = ty.node {\n-                    self.maybe_lint_bare_trait(t.span, t.id);\n+                    self.maybe_lint_bare_trait(t.span, t.id, qself.is_none() && path.is_global());\n                 }\n                 return ty;\n             }\n@@ -955,7 +955,7 @@ impl<'a> LoweringContext<'a> {\n                     self.elided_lifetime(t.span)\n                 });\n                 if kind != TraitObjectSyntax::Dyn {\n-                    self.maybe_lint_bare_trait(t.span, t.id);\n+                    self.maybe_lint_bare_trait(t.span, t.id, false);\n                 }\n                 hir::TyTraitObject(bounds, lifetime_bound)\n             }\n@@ -3710,12 +3710,12 @@ impl<'a> LoweringContext<'a> {\n         }\n     }\n \n-    fn maybe_lint_bare_trait(&self, span: Span, id: NodeId) {\n+    fn maybe_lint_bare_trait(&self, span: Span, id: NodeId, is_global: bool) {\n         if self.sess.features.borrow().dyn_trait {\n             self.sess.buffer_lint_with_diagnostic(\n                 builtin::BARE_TRAIT_OBJECT, id, span,\n                 \"trait objects without an explicit `dyn` are deprecated\",\n-                builtin::BuiltinLintDiagnostics::BareTraitObject(span)\n+                builtin::BuiltinLintDiagnostics::BareTraitObject(span, is_global)\n             )\n         }\n     }"}, {"sha": "b68b7dc6c067256d1fea467c43f8749517006ce2", "filename": "src/librustc/lint/builtin.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/0cb367266b0a336c0a18ae999beeadd3235961a2/src%2Flibrustc%2Flint%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0cb367266b0a336c0a18ae999beeadd3235961a2/src%2Flibrustc%2Flint%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Flint%2Fbuiltin.rs?ref=0cb367266b0a336c0a18ae999beeadd3235961a2", "patch": "@@ -320,15 +320,16 @@ impl LintPass for HardwiredLints {\n #[derive(PartialEq, RustcEncodable, RustcDecodable, Debug)]\n pub enum BuiltinLintDiagnostics {\n     Normal,\n-    BareTraitObject(Span)\n+    BareTraitObject(Span, /* is_global */ bool)\n }\n \n impl BuiltinLintDiagnostics {\n     pub fn run(self, sess: &Session, db: &mut DiagnosticBuilder) {\n         match self {\n             BuiltinLintDiagnostics::Normal => (),\n-            BuiltinLintDiagnostics::BareTraitObject(span) => {\n+            BuiltinLintDiagnostics::BareTraitObject(span, is_global) => {\n                 let sugg = match sess.codemap().span_to_snippet(span) {\n+                    Ok(ref s) if is_global => format!(\"dyn ({})\", s),\n                     Ok(s) => format!(\"dyn {}\", s),\n                     Err(_) => format!(\"dyn <type>\")\n                 };"}]}