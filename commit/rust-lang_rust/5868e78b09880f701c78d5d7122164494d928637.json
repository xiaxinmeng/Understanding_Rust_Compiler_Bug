{"sha": "5868e78b09880f701c78d5d7122164494d928637", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU4NjhlNzhiMDk4ODBmNzAxYzc4ZDVkNzEyMjE2NDQ5NGQ5Mjg2Mzc=", "commit": {"author": {"name": "Jeffrey Seyfried", "email": "jeffrey.seyfried@gmail.com", "date": "2016-07-27T18:54:16Z"}, "committer": {"name": "Jeffrey Seyfried", "email": "jeffrey.seyfried@gmail.com", "date": "2016-08-01T19:06:43Z"}, "message": "Refactor away `resolution.report_conflicts()`.", "tree": {"sha": "c462ce0a4a3da637253399cdf8ede8bbaa1a8d23", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c462ce0a4a3da637253399cdf8ede8bbaa1a8d23"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5868e78b09880f701c78d5d7122164494d928637", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5868e78b09880f701c78d5d7122164494d928637", "html_url": "https://github.com/rust-lang/rust/commit/5868e78b09880f701c78d5d7122164494d928637", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5868e78b09880f701c78d5d7122164494d928637/comments", "author": {"login": "jseyfried", "id": 8652869, "node_id": "MDQ6VXNlcjg2NTI4Njk=", "avatar_url": "https://avatars.githubusercontent.com/u/8652869?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jseyfried", "html_url": "https://github.com/jseyfried", "followers_url": "https://api.github.com/users/jseyfried/followers", "following_url": "https://api.github.com/users/jseyfried/following{/other_user}", "gists_url": "https://api.github.com/users/jseyfried/gists{/gist_id}", "starred_url": "https://api.github.com/users/jseyfried/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jseyfried/subscriptions", "organizations_url": "https://api.github.com/users/jseyfried/orgs", "repos_url": "https://api.github.com/users/jseyfried/repos", "events_url": "https://api.github.com/users/jseyfried/events{/privacy}", "received_events_url": "https://api.github.com/users/jseyfried/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jseyfried", "id": 8652869, "node_id": "MDQ6VXNlcjg2NTI4Njk=", "avatar_url": "https://avatars.githubusercontent.com/u/8652869?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jseyfried", "html_url": "https://github.com/jseyfried", "followers_url": "https://api.github.com/users/jseyfried/followers", "following_url": "https://api.github.com/users/jseyfried/following{/other_user}", "gists_url": "https://api.github.com/users/jseyfried/gists{/gist_id}", "starred_url": "https://api.github.com/users/jseyfried/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jseyfried/subscriptions", "organizations_url": "https://api.github.com/users/jseyfried/orgs", "repos_url": "https://api.github.com/users/jseyfried/repos", "events_url": "https://api.github.com/users/jseyfried/events{/privacy}", "received_events_url": "https://api.github.com/users/jseyfried/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "79e82b5c41b981d4ac6c8cc67d8424c800b1015c", "url": "https://api.github.com/repos/rust-lang/rust/commits/79e82b5c41b981d4ac6c8cc67d8424c800b1015c", "html_url": "https://github.com/rust-lang/rust/commit/79e82b5c41b981d4ac6c8cc67d8424c800b1015c"}], "stats": {"total": 34, "additions": 12, "deletions": 22}, "files": [{"sha": "691114574d0a92cdd9d26c3879bad9aaf70f6f9d", "filename": "src/librustc_resolve/resolve_imports.rs", "status": "modified", "additions": 12, "deletions": 22, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/5868e78b09880f701c78d5d7122164494d928637/src%2Flibrustc_resolve%2Fresolve_imports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5868e78b09880f701c78d5d7122164494d928637/src%2Flibrustc_resolve%2Fresolve_imports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Fresolve_imports.rs?ref=5868e78b09880f701c78d5d7122164494d928637", "patch": "@@ -203,24 +203,6 @@ impl<'a> NameResolution<'a> {\n \n         self.binding.map(Success)\n     }\n-\n-    fn report_conflicts<F: FnMut(&NameBinding, &NameBinding)>(&self, mut report: F) {\n-        let binding = match self.binding {\n-            Some(binding) => binding,\n-            None => return,\n-        };\n-\n-        for duplicate_glob in self.duplicate_globs.iter() {\n-            // FIXME #31337: We currently allow items to shadow glob-imported re-exports.\n-            if !binding.is_import() {\n-                if let NameBindingKind::Import { binding, .. } = duplicate_glob.kind {\n-                    if binding.is_import() { continue }\n-                }\n-            }\n-\n-            report(duplicate_glob, binding);\n-        }\n-    }\n }\n \n impl<'a> ::ModuleS<'a> {\n@@ -677,15 +659,23 @@ impl<'a, 'b:'a> ImportResolver<'a, 'b> {\n         let mut reexports = Vec::new();\n         for (&(name, ns), resolution) in module.resolutions.borrow().iter() {\n             let resolution = resolution.borrow();\n-            resolution.report_conflicts(|b1, b2| {\n-                self.report_conflict(module, name, ns, b1, b2)\n-            });\n-\n             let binding = match resolution.binding {\n                 Some(binding) => binding,\n                 None => continue,\n             };\n \n+            // Report conflicts\n+            for duplicate_glob in resolution.duplicate_globs.iter() {\n+                // FIXME #31337: We currently allow items to shadow glob-imported re-exports.\n+                if !binding.is_import() {\n+                    if let NameBindingKind::Import { binding, .. } = duplicate_glob.kind {\n+                        if binding.is_import() { continue }\n+                    }\n+                }\n+\n+                self.report_conflict(module, name, ns, duplicate_glob, binding);\n+            }\n+\n             if binding.vis == ty::Visibility::Public &&\n                (binding.is_import() || binding.is_extern_crate()) {\n                 if let Some(def) = binding.def() {"}]}