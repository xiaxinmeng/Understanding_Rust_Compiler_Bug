{"sha": "77f685390c5b85e84aeb010b37b3bb9c5839eb4d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc3ZjY4NTM5MGM1Yjg1ZTg0YWViMDEwYjM3YjNiYjljNTgzOWViNGQ=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-10-13T17:17:14Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-10-13T17:17:14Z"}, "message": "Rollup merge of #65369 - tmiasko:sanitizers-keep-names, r=varkor\n\nDon't discard value names when using address or memory sanitizer\n\nThe value names are used when reporting issues found by address\nsanitizer or memory sanitizer. Avoid discarding names when those\nsanitizers are enabled, unless explicitly requested to do otherwise.", "tree": {"sha": "4aada333a3b1478d7180c51ae0ea8d51f263bd48", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4aada333a3b1478d7180c51ae0ea8d51f263bd48"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/77f685390c5b85e84aeb010b37b3bb9c5839eb4d", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdo1waCRBK7hj4Ov3rIwAAdHIIAI5DjwM9h0LYZmslrQq+48IS\nhGEPAI4fvGBDwHnwVjO789Cb+spSqSoS/v47pZVtMg8Hci69TARk1C9V+hO5BG4d\nwz1IgP7BWOJQlc1xeQkbV+V6uPaGMkoqRVyTrNoWF7dQByAieURORdQw4Fk0eVrb\nXanr0QVSZOeuxU0HvrsprB699UEK7BalVdU6sN5vpZay+EB66DymZ1e6DhSLzXrq\nHa7MXCSyiphD8V5xR6Al8iCDqtNeQLTLnQPBgKFZoF2g8LP93GCnkYlBHHbP44a4\nWs9vOZRMbPnPCy4VYctvOK7LiTGJ2W8UBiKD4pk+5SE9JiAztHmmNRcxdeSM+FU=\n=z0Nh\n-----END PGP SIGNATURE-----\n", "payload": "tree 4aada333a3b1478d7180c51ae0ea8d51f263bd48\nparent 8f8954e6716026608cffd3c7694e6863972f102f\nparent d488500812424061264a69c9ecfe0247bc00d1af\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1570987034 +0200\ncommitter GitHub <noreply@github.com> 1570987034 +0200\n\nRollup merge of #65369 - tmiasko:sanitizers-keep-names, r=varkor\n\nDon't discard value names when using address or memory sanitizer\n\nThe value names are used when reporting issues found by address\nsanitizer or memory sanitizer. Avoid discarding names when those\nsanitizers are enabled, unless explicitly requested to do otherwise.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/77f685390c5b85e84aeb010b37b3bb9c5839eb4d", "html_url": "https://github.com/rust-lang/rust/commit/77f685390c5b85e84aeb010b37b3bb9c5839eb4d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/77f685390c5b85e84aeb010b37b3bb9c5839eb4d/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8f8954e6716026608cffd3c7694e6863972f102f", "url": "https://api.github.com/repos/rust-lang/rust/commits/8f8954e6716026608cffd3c7694e6863972f102f", "html_url": "https://github.com/rust-lang/rust/commit/8f8954e6716026608cffd3c7694e6863972f102f"}, {"sha": "d488500812424061264a69c9ecfe0247bc00d1af", "url": "https://api.github.com/repos/rust-lang/rust/commits/d488500812424061264a69c9ecfe0247bc00d1af", "html_url": "https://github.com/rust-lang/rust/commit/d488500812424061264a69c9ecfe0247bc00d1af"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "fa2902e4f0edef0d55424bc8394b79ae783e9b16", "filename": "src/librustc/session/mod.rs", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/77f685390c5b85e84aeb010b37b3bb9c5839eb4d/src%2Flibrustc%2Fsession%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/77f685390c5b85e84aeb010b37b3bb9c5839eb4d/src%2Flibrustc%2Fsession%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fsession%2Fmod.rs?ref=77f685390c5b85e84aeb010b37b3bb9c5839eb4d", "patch": "@@ -7,7 +7,7 @@ use rustc_data_structures::fingerprint::Fingerprint;\n \n use crate::lint;\n use crate::lint::builtin::BuiltinLintDiagnostics;\n-use crate::session::config::{OutputType, PrintRequest, SwitchWithOptPath};\n+use crate::session::config::{OutputType, PrintRequest, Sanitizer, SwitchWithOptPath};\n use crate::session::search_paths::{PathKind, SearchPath};\n use crate::util::nodemap::{FxHashMap, FxHashSet};\n use crate::util::common::{duration_to_secs_str, ErrorReported};\n@@ -626,6 +626,14 @@ impl Session {\n             .output_types\n             .contains_key(&OutputType::LlvmAssembly)\n             || self.opts.output_types.contains_key(&OutputType::Bitcode);\n+\n+        // Address sanitizer and memory sanitizer use alloca name when reporting an issue.\n+        let more_names = match self.opts.debugging_opts.sanitizer {\n+            Some(Sanitizer::Address) => true,\n+            Some(Sanitizer::Memory) => true,\n+            _ => more_names,\n+        };\n+\n         self.opts.debugging_opts.fewer_names || !more_names\n     }\n "}, {"sha": "3a377c32993d5497ef982964a1198944b3c9df4d", "filename": "src/test/run-make-fulldeps/sanitizer-address/Makefile", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/77f685390c5b85e84aeb010b37b3bb9c5839eb4d/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-address%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/77f685390c5b85e84aeb010b37b3bb9c5839eb4d/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-address%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fsanitizer-address%2FMakefile?ref=77f685390c5b85e84aeb010b37b3bb9c5839eb4d", "patch": "@@ -24,4 +24,7 @@ endif\n \n all:\n \t$(RUSTC) -g -Z sanitizer=address -Z print-link-args $(EXTRA_RUSTFLAG) overflow.rs | $(CGREP) librustc_asan\n+\t# Verify that stack buffer overflow is detected:\n \t$(TMPDIR)/overflow 2>&1 | $(CGREP) stack-buffer-overflow\n+\t# Verify that variable name is included in address sanitizer report:\n+\t$(TMPDIR)/overflow 2>&1 | $(CGREP) \"'xs'\""}]}