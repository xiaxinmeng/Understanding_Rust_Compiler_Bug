{"sha": "9adb3dfdcb2cab7a10d7ac7a48170672b3961fe8", "node_id": "MDY6Q29tbWl0NzI0NzEyOjlhZGIzZGZkY2IyY2FiN2ExMGQ3YWM3YTQ4MTcwNjcyYjM5NjFmZTg=", "commit": {"author": {"name": "Paul Faria", "email": "Nashenas88@gmail.com", "date": "2015-06-13T18:47:10Z"}, "committer": {"name": "Paul Faria", "email": "Nashenas88@gmail.com", "date": "2015-06-20T01:01:39Z"}, "message": "Uncomplete fix for #2392", "tree": {"sha": "5ae25659877b9a4f3c3647e3ef1f887d83f2974f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5ae25659877b9a4f3c3647e3ef1f887d83f2974f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9adb3dfdcb2cab7a10d7ac7a48170672b3961fe8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9adb3dfdcb2cab7a10d7ac7a48170672b3961fe8", "html_url": "https://github.com/rust-lang/rust/commit/9adb3dfdcb2cab7a10d7ac7a48170672b3961fe8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9adb3dfdcb2cab7a10d7ac7a48170672b3961fe8/comments", "author": {"login": "Nashenas88", "id": 1673130, "node_id": "MDQ6VXNlcjE2NzMxMzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1673130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nashenas88", "html_url": "https://github.com/Nashenas88", "followers_url": "https://api.github.com/users/Nashenas88/followers", "following_url": "https://api.github.com/users/Nashenas88/following{/other_user}", "gists_url": "https://api.github.com/users/Nashenas88/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nashenas88/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nashenas88/subscriptions", "organizations_url": "https://api.github.com/users/Nashenas88/orgs", "repos_url": "https://api.github.com/users/Nashenas88/repos", "events_url": "https://api.github.com/users/Nashenas88/events{/privacy}", "received_events_url": "https://api.github.com/users/Nashenas88/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Nashenas88", "id": 1673130, "node_id": "MDQ6VXNlcjE2NzMxMzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1673130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nashenas88", "html_url": "https://github.com/Nashenas88", "followers_url": "https://api.github.com/users/Nashenas88/followers", "following_url": "https://api.github.com/users/Nashenas88/following{/other_user}", "gists_url": "https://api.github.com/users/Nashenas88/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nashenas88/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nashenas88/subscriptions", "organizations_url": "https://api.github.com/users/Nashenas88/orgs", "repos_url": "https://api.github.com/users/Nashenas88/repos", "events_url": "https://api.github.com/users/Nashenas88/events{/privacy}", "received_events_url": "https://api.github.com/users/Nashenas88/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e4efb47b9d23a96ff4684df80360bbed0ec68bc9", "url": "https://api.github.com/repos/rust-lang/rust/commits/e4efb47b9d23a96ff4684df80360bbed0ec68bc9", "html_url": "https://github.com/rust-lang/rust/commit/e4efb47b9d23a96ff4684df80360bbed0ec68bc9"}], "stats": {"total": 33, "additions": 28, "deletions": 5}, "files": [{"sha": "be34c7057210c8dea289e9f73a1ad9bef3761e7c", "filename": "src/librustc_typeck/check/method/suggest.rs", "status": "modified", "additions": 17, "deletions": 5, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/9adb3dfdcb2cab7a10d7ac7a48170672b3961fe8/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fsuggest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9adb3dfdcb2cab7a10d7ac7a48170672b3961fe8/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fsuggest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fsuggest.rs?ref=9adb3dfdcb2cab7a10d7ac7a48170672b3961fe8", "patch": "@@ -59,12 +59,24 @@ pub fn report_error<'a, 'tcx>(fcx: &FnCtxt<'a, 'tcx>,\n                 None);\n \n             // If the item has the name of a field, give a help note\n-            if let (&ty::TyStruct(did, _), Some(_)) = (&rcvr_ty.sty, rcvr_expr) {\n+            if let (&ty::TyStruct(did, substs), Some(_)) = (&rcvr_ty.sty, rcvr_expr) {\n                 let fields = ty::lookup_struct_fields(cx, did);\n-                if fields.iter().any(|f| f.name == item_name) {\n-                    cx.sess.span_note(span,\n-                        &format!(\"use `(s.{0})(...)` if you meant to call the \\\n-                                 function stored in the `{0}` field\", item_name));\n+\n+                if let Some(field) = fields.iter().find(|f| f.name == item_name) {\n+\n+                    match ty::lookup_field_type(cx, did, field.id, substs).sty {\n+                        ty::TyClosure(_, _) | ty::TyBareFn(_,_) => {\n+                            cx.sess.span_note(span,\n+                                &format!(\"use `({0}.{1})(...)` if you meant to call the \\\n+                                          function stored in the `{1}` field\",\n+                                    ty::item_path_str(cx, did), item_name));\n+                        },\n+                        _ => {\n+                            cx.sess.span_note(span,\n+                                &format!(\"did you mean to write `{0}.{1}`?\",\n+                                    ty::item_path_str(cx, did), item_name));\n+                        },\n+                    };\n                 }\n             }\n "}, {"sha": "3572e5084c15acd9c0a9f2e3adedf342d7cf8451", "filename": "src/test/compile-fail/issue-18343.rs", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/9adb3dfdcb2cab7a10d7ac7a48170672b3961fe8/src%2Ftest%2Fcompile-fail%2Fissue-18343.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9adb3dfdcb2cab7a10d7ac7a48170672b3961fe8/src%2Ftest%2Fcompile-fail%2Fissue-18343.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-18343.rs?ref=9adb3dfdcb2cab7a10d7ac7a48170672b3961fe8", "patch": "@@ -10,10 +10,21 @@\n \n struct Obj<F> where F: FnMut() -> u32 {\n     closure: F,\n+    nfn: usize,\n+}\n+\n+fn func() -> u32 {\n+    0\n }\n \n fn main() {\n     let o = Obj { closure: || 42 };\n     o.closure(); //~ ERROR no method named `closure` found\n     //~^ NOTE use `(s.closure)(...)` if you meant to call the function stored in the `closure` field\n+    let x = o.nfn(); //~ ERROR no method named `closure` found\n+    //~^ NOTE did you mean `o.nfn`?\n+\n+    let b = Obj { closure: func };\n+    b.closure(); //~ ERROR no method named `closure` found\n+    //~^ NOTE use `(s.closure)(...)` if you meant to call the function stored in the `closure` field\n }"}]}