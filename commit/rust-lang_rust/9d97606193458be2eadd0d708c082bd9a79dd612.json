{"sha": "9d97606193458be2eadd0d708c082bd9a79dd612", "node_id": "C_kwDOAAsO6NoAKDlkOTc2MDYxOTM0NThiZTJlYWRkMGQ3MDhjMDgyYmQ5YTc5ZGQ2MTI", "commit": {"author": {"name": "Nikita Popov", "email": "npopov@redhat.com", "date": "2022-07-19T13:35:40Z"}, "committer": {"name": "Nikita Popov", "email": "npopov@redhat.com", "date": "2022-08-09T10:39:59Z"}, "message": "Allow old toolchain on some images\n\nLLVM 16 will require GCC >= 7.1. For now, set the flag that\nallows using an older toolchain.", "tree": {"sha": "f028139539f7634f3f0a2f034ac08131c7da9997", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f028139539f7634f3f0a2f034ac08131c7da9997"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9d97606193458be2eadd0d708c082bd9a79dd612", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9d97606193458be2eadd0d708c082bd9a79dd612", "html_url": "https://github.com/rust-lang/rust/commit/9d97606193458be2eadd0d708c082bd9a79dd612", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9d97606193458be2eadd0d708c082bd9a79dd612/comments", "author": {"login": "nikic", "id": 216080, "node_id": "MDQ6VXNlcjIxNjA4MA==", "avatar_url": "https://avatars.githubusercontent.com/u/216080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikic", "html_url": "https://github.com/nikic", "followers_url": "https://api.github.com/users/nikic/followers", "following_url": "https://api.github.com/users/nikic/following{/other_user}", "gists_url": "https://api.github.com/users/nikic/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikic/subscriptions", "organizations_url": "https://api.github.com/users/nikic/orgs", "repos_url": "https://api.github.com/users/nikic/repos", "events_url": "https://api.github.com/users/nikic/events{/privacy}", "received_events_url": "https://api.github.com/users/nikic/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikic", "id": 216080, "node_id": "MDQ6VXNlcjIxNjA4MA==", "avatar_url": "https://avatars.githubusercontent.com/u/216080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikic", "html_url": "https://github.com/nikic", "followers_url": "https://api.github.com/users/nikic/followers", "following_url": "https://api.github.com/users/nikic/following{/other_user}", "gists_url": "https://api.github.com/users/nikic/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikic/subscriptions", "organizations_url": "https://api.github.com/users/nikic/orgs", "repos_url": "https://api.github.com/users/nikic/repos", "events_url": "https://api.github.com/users/nikic/events{/privacy}", "received_events_url": "https://api.github.com/users/nikic/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8c1f9d04e820a680a4b2801c63f66a482bcfe5f7", "url": "https://api.github.com/repos/rust-lang/rust/commits/8c1f9d04e820a680a4b2801c63f66a482bcfe5f7", "html_url": "https://github.com/rust-lang/rust/commit/8c1f9d04e820a680a4b2801c63f66a482bcfe5f7"}], "stats": {"total": 37, "additions": 25, "deletions": 12}, "files": [{"sha": "a2335687ab33568266850d9437942656b0ae0f3d", "filename": "src/ci/docker/host-x86_64/arm-android/Dockerfile", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Farm-android%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Farm-android%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Farm-android%2FDockerfile?ref=9d97606193458be2eadd0d708c082bd9a79dd612", "patch": "@@ -29,7 +29,8 @@ ENV PATH=$PATH:/android/sdk/platform-tools\n \n ENV TARGETS=arm-linux-androideabi\n \n-ENV RUST_CONFIGURE_ARGS --arm-linux-androideabi-ndk=/android/ndk/arm-14\n+ENV RUST_CONFIGURE_ARGS --arm-linux-androideabi-ndk=/android/ndk/arm-14 \\\n+    --set llvm.allow-old-toolchain\n \n ENV SCRIPT python3 ../x.py --stage 2 test --host='' --target $TARGETS\n "}, {"sha": "c98fa496d4861d22c274e17d3f38c2ca12fc7ccf", "filename": "src/ci/docker/host-x86_64/dist-android/Dockerfile", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-android%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-android%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-android%2FDockerfile?ref=9d97606193458be2eadd0d708c082bd9a79dd612", "patch": "@@ -32,7 +32,8 @@ ENV RUST_CONFIGURE_ARGS \\\n       --i686-linux-android-ndk=/android/ndk/x86-14 \\\n       --aarch64-linux-android-ndk=/android/ndk/arm64-21 \\\n       --x86_64-linux-android-ndk=/android/ndk/x86_64-21 \\\n-      --disable-docs\n+      --disable-docs \\\n+      --set llvm.allow-old-toolchain\n \n ENV SCRIPT python3 ../x.py dist --host='' --target $TARGETS\n "}, {"sha": "b0d65428ec6c488a7166e9f05108439cd95e2478", "filename": "src/ci/docker/host-x86_64/dist-i586-gnu-i586-i686-musl/Dockerfile", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-i586-gnu-i586-i686-musl%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-i586-gnu-i586-i686-musl%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-i586-gnu-i586-i686-musl%2FDockerfile?ref=9d97606193458be2eadd0d708c082bd9a79dd612", "patch": "@@ -36,7 +36,8 @@ RUN /scripts/cmake.sh\n ENV RUST_CONFIGURE_ARGS \\\n       --musl-root-i586=/musl-i586 \\\n       --musl-root-i686=/musl-i686 \\\n-      --disable-docs\n+      --disable-docs \\\n+      --set llvm.allow-old-toolchain\n \n # Newer binutils broke things on some vms/distros (i.e., linking against\n # unknown relocs disabled by the following flag), so we need to go out of our"}, {"sha": "948fa40dd4b13c0161c41637570f8a31c19d182b", "filename": "src/ci/docker/host-x86_64/dist-mips-linux/Dockerfile", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-mips-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-mips-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-mips-linux%2FDockerfile?ref=9d97606193458be2eadd0d708c082bd9a79dd612", "patch": "@@ -26,5 +26,6 @@ RUN /scripts/cmake.sh\n \n ENV HOSTS=mips-unknown-linux-gnu\n \n-ENV RUST_CONFIGURE_ARGS --enable-extended --disable-docs\n+ENV RUST_CONFIGURE_ARGS --enable-extended --disable-docs \\\n+    --set llvm.allow-old-toolchain\n ENV SCRIPT python3 ../x.py dist --host $HOSTS --target $HOSTS"}, {"sha": "fd15dbd22c6c279b807556067174458961a387fc", "filename": "src/ci/docker/host-x86_64/dist-mips64-linux/Dockerfile", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-mips64-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-mips64-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-mips64-linux%2FDockerfile?ref=9d97606193458be2eadd0d708c082bd9a79dd612", "patch": "@@ -25,5 +25,6 @@ RUN /scripts/cmake.sh\n \n ENV HOSTS=mips64-unknown-linux-gnuabi64\n \n-ENV RUST_CONFIGURE_ARGS --enable-extended --disable-docs\n+ENV RUST_CONFIGURE_ARGS --enable-extended --disable-docs \\\n+    --set llvm.allow-old-toolchain\n ENV SCRIPT python3 ../x.py dist --host $HOSTS --target $HOSTS"}, {"sha": "376bdfb4a2f4b6e1d80375e806a7cc510a418c5d", "filename": "src/ci/docker/host-x86_64/dist-mips64el-linux/Dockerfile", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-mips64el-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-mips64el-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-mips64el-linux%2FDockerfile?ref=9d97606193458be2eadd0d708c082bd9a79dd612", "patch": "@@ -26,5 +26,6 @@ RUN /scripts/cmake.sh\n \n ENV HOSTS=mips64el-unknown-linux-gnuabi64\n \n-ENV RUST_CONFIGURE_ARGS --enable-extended --disable-docs\n+ENV RUST_CONFIGURE_ARGS --enable-extended --disable-docs \\\n+    --set llvm.allow-old-toolchain\n ENV SCRIPT python3 ../x.py dist --host $HOSTS --target $HOSTS"}, {"sha": "70c8b2a96c8c1e458582e32ce01bbf3c1d1596aa", "filename": "src/ci/docker/host-x86_64/dist-mipsel-linux/Dockerfile", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-mipsel-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-mipsel-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-mipsel-linux%2FDockerfile?ref=9d97606193458be2eadd0d708c082bd9a79dd612", "patch": "@@ -25,5 +25,6 @@ RUN /scripts/cmake.sh\n \n ENV HOSTS=mipsel-unknown-linux-gnu\n \n-ENV RUST_CONFIGURE_ARGS --enable-extended --disable-docs\n+ENV RUST_CONFIGURE_ARGS --enable-extended --disable-docs \\\n+    --set llvm.allow-old-toolchain\n ENV SCRIPT python3 ../x.py dist --host $HOSTS --target $HOSTS"}, {"sha": "fed4be4c30a74163893253a0f5f72d3e19d801b4", "filename": "src/ci/docker/host-x86_64/dist-x86_64-netbsd/Dockerfile", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-x86_64-netbsd%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-x86_64-netbsd%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-x86_64-netbsd%2FDockerfile?ref=9d97606193458be2eadd0d708c082bd9a79dd612", "patch": "@@ -21,5 +21,6 @@ ENV \\\n \n ENV HOSTS=x86_64-unknown-netbsd\n \n-ENV RUST_CONFIGURE_ARGS --enable-extended --disable-docs\n+ENV RUST_CONFIGURE_ARGS --enable-extended --disable-docs \\\n+    --set llvm.allow-old-toolchain\n ENV SCRIPT python3 ../x.py dist --host $HOSTS --target $HOSTS"}, {"sha": "1f8d0a64ea48e0ecc380ea6411c21eea80ed36b2", "filename": "src/ci/docker/host-x86_64/i686-gnu-nopt/Dockerfile", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fi686-gnu-nopt%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fi686-gnu-nopt%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fi686-gnu-nopt%2FDockerfile?ref=9d97606193458be2eadd0d708c082bd9a79dd612", "patch": "@@ -27,6 +27,7 @@ RUN mkdir -p /config\n RUN echo \"[rust]\" > /config/nopt-std-config.toml\n RUN echo \"optimize = false\" >> /config/nopt-std-config.toml\n \n-ENV RUST_CONFIGURE_ARGS --build=i686-unknown-linux-gnu --disable-optimize-tests\n+ENV RUST_CONFIGURE_ARGS --build=i686-unknown-linux-gnu --disable-optimize-tests \\\n+    --set llvm.allow-old-toolchain\n ENV SCRIPT python3 ../x.py test --stage 0 --config /config/nopt-std-config.toml library/std \\\n   && python3 ../x.py --stage 2 test"}, {"sha": "7bca0398dea7c6679bcf8e6286b2b5c116392340", "filename": "src/ci/docker/host-x86_64/i686-gnu/Dockerfile", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fi686-gnu%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fi686-gnu%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fi686-gnu%2FDockerfile?ref=9d97606193458be2eadd0d708c082bd9a79dd612", "patch": "@@ -23,7 +23,8 @@ RUN sh /scripts/sccache.sh\n COPY scripts/cmake.sh /scripts/\n RUN /scripts/cmake.sh\n \n-ENV RUST_CONFIGURE_ARGS --build=i686-unknown-linux-gnu\n+ENV RUST_CONFIGURE_ARGS --build=i686-unknown-linux-gnu \\\n+    --set llvm.allow-old-toolchain\n # Exclude some tests that are unlikely to be platform specific, to speed up\n # this slow job.\n ENV SCRIPT python3 ../x.py --stage 2 test \\"}, {"sha": "bfc6975c19dc9b174e0b6deaf3ecb4beeb4ec474", "filename": "src/ci/docker/host-x86_64/x86_64-gnu-aux/Dockerfile", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-aux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-aux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-aux%2FDockerfile?ref=9d97606193458be2eadd0d708c082bd9a79dd612", "patch": "@@ -26,5 +26,6 @@ RUN sh /scripts/sccache.sh\n COPY scripts/cmake.sh /scripts/\n RUN /scripts/cmake.sh\n \n-ENV RUST_CONFIGURE_ARGS --build=x86_64-unknown-linux-gnu\n+ENV RUST_CONFIGURE_ARGS --build=x86_64-unknown-linux-gnu \\\n+    --set llvm.allow-old-toolchain\n ENV RUST_CHECK_TARGET check-aux"}, {"sha": "4bb4042cd7e2ffa75a0986c2a7dd3a12dc560c35", "filename": "src/ci/docker/host-x86_64/x86_64-gnu-distcheck/Dockerfile", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-distcheck%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-distcheck%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-distcheck%2FDockerfile?ref=9d97606193458be2eadd0d708c082bd9a79dd612", "patch": "@@ -22,6 +22,7 @@ RUN sh /scripts/sccache.sh\n COPY scripts/cmake.sh /scripts/\n RUN /scripts/cmake.sh\n \n-ENV RUST_CONFIGURE_ARGS --build=x86_64-unknown-linux-gnu --set rust.ignore-git=false\n+ENV RUST_CONFIGURE_ARGS --build=x86_64-unknown-linux-gnu --set rust.ignore-git=false \\\n+    --set llvm.allow-old-toolchain\n ENV SCRIPT python3 ../x.py --stage 2 test distcheck\n ENV DIST_SRC 1"}, {"sha": "f442a477a7b1e121a00f8da94ae63b40677cd90d", "filename": "src/ci/docker/host-x86_64/x86_64-gnu-tools/Dockerfile", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-tools%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/9d97606193458be2eadd0d708c082bd9a79dd612/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-tools%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-tools%2FDockerfile?ref=9d97606193458be2eadd0d708c082bd9a79dd612", "patch": "@@ -81,6 +81,7 @@ COPY host-x86_64/x86_64-gnu-tools/browser-ui-test.version /tmp/\n RUN npm install -g browser-ui-test@$(head -n 1 /tmp/browser-ui-test.version) --unsafe-perm=true\n \n ENV RUST_CONFIGURE_ARGS \\\n+  --set llvm.allow-old-toolchain \\\n   --build=x86_64-unknown-linux-gnu \\\n   --save-toolstates=/tmp/toolstate/toolstates.json\n "}]}