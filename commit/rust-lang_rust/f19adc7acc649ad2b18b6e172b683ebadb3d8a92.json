{"sha": "f19adc7acc649ad2b18b6e172b683ebadb3d8a92", "node_id": "C_kwDOAAsO6NoAKGYxOWFkYzdhY2M2NDlhZDJiMThiNmUxNzJiNjgzZWJhZGIzZDhhOTI", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-02-19T05:45:29Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-02-19T05:45:29Z"}, "message": "Rollup merge of #93658 - cchiw:issue-77443-fix, r=joshtriplett\n\nStabilize `#[cfg(panic = \"...\")]`\n\n[Stabilization PR](https://rustc-dev-guide.rust-lang.org/stabilization_guide.html#stabilization-pr) for #77443", "tree": {"sha": "4cd6e4c2d2b978efce0edd9d4d12e2268195a2b2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4cd6e4c2d2b978efce0edd9d4d12e2268195a2b2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f19adc7acc649ad2b18b6e172b683ebadb3d8a92", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJiEIP5CRBK7hj4Ov3rIwAAGsEIAFsBIY3imeRkfIAqVM8ZHtIt\nRwivxFhxesWBAkTa+kO+kbiyAL811k5sWly9h9/bNKMSFPu0FAX0Ju2EefiTGQZw\nTsbRNmmd5ZQJdl4j9hcFrsr1RzjTjD6Z7gvfFRM8qq35TyfYhR5zxqVVUG7g0oxm\nHoYd/Ud1KPbXjuInjydSOgFqejlNqPaGMnDI3EgtvlFTBlqnxG+0/7yTnPmrCZMf\nrdLFsd2f5jYG9W6OE9DTyHtJLCxpTTVeGOs7i1CA/seHH3AgdZEmN4bHyCtmcudh\noVohgTyCc3I89WDbx+Y7kcNFL6ObaFP989P18nRcOzzHCrppdPQ6w6m1E6IHmok=\n=xv/3\n-----END PGP SIGNATURE-----\n", "payload": "tree 4cd6e4c2d2b978efce0edd9d4d12e2268195a2b2\nparent 4fa71ed0f0589133a3ab4a565d572f2c5373fad0\nparent dbeab9c532080a52f5cc86fbb4ca679581b866fd\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1645249529 +0100\ncommitter GitHub <noreply@github.com> 1645249529 +0100\n\nRollup merge of #93658 - cchiw:issue-77443-fix, r=joshtriplett\n\nStabilize `#[cfg(panic = \"...\")]`\n\n[Stabilization PR](https://rustc-dev-guide.rust-lang.org/stabilization_guide.html#stabilization-pr) for #77443\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f19adc7acc649ad2b18b6e172b683ebadb3d8a92", "html_url": "https://github.com/rust-lang/rust/commit/f19adc7acc649ad2b18b6e172b683ebadb3d8a92", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f19adc7acc649ad2b18b6e172b683ebadb3d8a92/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4fa71ed0f0589133a3ab4a565d572f2c5373fad0", "url": "https://api.github.com/repos/rust-lang/rust/commits/4fa71ed0f0589133a3ab4a565d572f2c5373fad0", "html_url": "https://github.com/rust-lang/rust/commit/4fa71ed0f0589133a3ab4a565d572f2c5373fad0"}, {"sha": "dbeab9c532080a52f5cc86fbb4ca679581b866fd", "url": "https://api.github.com/repos/rust-lang/rust/commits/dbeab9c532080a52f5cc86fbb4ca679581b866fd", "html_url": "https://github.com/rust-lang/rust/commit/dbeab9c532080a52f5cc86fbb4ca679581b866fd"}], "stats": {"total": 83, "additions": 5, "deletions": 78}, "files": [{"sha": "d43f926d0a56a458fc3dbd97fe27ef867736ba31", "filename": "compiler/rustc_feature/src/accepted.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f19adc7acc649ad2b18b6e172b683ebadb3d8a92/compiler%2Frustc_feature%2Fsrc%2Faccepted.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f19adc7acc649ad2b18b6e172b683ebadb3d8a92/compiler%2Frustc_feature%2Fsrc%2Faccepted.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_feature%2Fsrc%2Faccepted.rs?ref=f19adc7acc649ad2b18b6e172b683ebadb3d8a92", "patch": "@@ -70,6 +70,8 @@ declare_features! (\n     (accepted, cfg_attr_multi, \"1.33.0\", Some(54881), None),\n     /// Allows the use of `#[cfg(doctest)]`, set when rustdoc is collecting doctests.\n     (accepted, cfg_doctest, \"1.40.0\", Some(62210), None),\n+    /// Enables `#[cfg(panic = \"...\")]` config key.\n+    (accepted, cfg_panic, \"1.60.0\", Some(77443), None),\n     /// Allows `cfg(target_feature = \"...\")`.\n     (accepted, cfg_target_feature, \"1.27.0\", Some(29717), None),\n     /// Allows `cfg(target_vendor = \"...\")`."}, {"sha": "5545abc6024af2f8140488b18989da4e9cfa8c4d", "filename": "compiler/rustc_feature/src/active.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f19adc7acc649ad2b18b6e172b683ebadb3d8a92/compiler%2Frustc_feature%2Fsrc%2Factive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f19adc7acc649ad2b18b6e172b683ebadb3d8a92/compiler%2Frustc_feature%2Fsrc%2Factive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_feature%2Fsrc%2Factive.rs?ref=f19adc7acc649ad2b18b6e172b683ebadb3d8a92", "patch": "@@ -306,8 +306,6 @@ declare_features! (\n     (active, c_variadic, \"1.34.0\", Some(44930), None),\n     /// Allows capturing disjoint fields in a closure/generator (RFC 2229).\n     (incomplete, capture_disjoint_fields, \"1.49.0\", Some(53488), None),\n-    /// Enables `#[cfg(panic = \"...\")]` config key.\n-    (active, cfg_panic, \"1.49.0\", Some(77443), None),\n     /// Allows the use of `#[cfg(sanitize = \"option\")]`; set when -Zsanitizer is used.\n     (active, cfg_sanitize, \"1.41.0\", Some(39699), None),\n     /// Allows `cfg(target_abi = \"...\")`."}, {"sha": "1fb1a38a927d549db9b4f93e1cbee58ebfbf54f3", "filename": "compiler/rustc_feature/src/builtin_attrs.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f19adc7acc649ad2b18b6e172b683ebadb3d8a92/compiler%2Frustc_feature%2Fsrc%2Fbuiltin_attrs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f19adc7acc649ad2b18b6e172b683ebadb3d8a92/compiler%2Frustc_feature%2Fsrc%2Fbuiltin_attrs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_feature%2Fsrc%2Fbuiltin_attrs.rs?ref=f19adc7acc649ad2b18b6e172b683ebadb3d8a92", "patch": "@@ -34,7 +34,6 @@ const GATED_CFGS: &[GatedCfg] = &[\n     (sym::target_has_atomic_load_store, sym::cfg_target_has_atomic, cfg_fn!(cfg_target_has_atomic)),\n     (sym::sanitize, sym::cfg_sanitize, cfg_fn!(cfg_sanitize)),\n     (sym::version, sym::cfg_version, cfg_fn!(cfg_version)),\n-    (sym::panic, sym::cfg_panic, cfg_fn!(cfg_panic)),\n ];\n \n /// Find a gated cfg determined by the `pred`icate which is given the cfg's name."}, {"sha": "06c7be054a0381b0eaa9574efba3277999d4fe46", "filename": "library/core/tests/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f19adc7acc649ad2b18b6e172b683ebadb3d8a92/library%2Fcore%2Ftests%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f19adc7acc649ad2b18b6e172b683ebadb3d8a92/library%2Fcore%2Ftests%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Ftests%2Flib.rs?ref=f19adc7acc649ad2b18b6e172b683ebadb3d8a92", "patch": "@@ -6,7 +6,7 @@\n #![feature(bool_to_option)]\n #![feature(box_syntax)]\n #![feature(cell_update)]\n-#![feature(cfg_panic)]\n+#![cfg_attr(bootstrap, feature(cfg_panic))]\n #![cfg_attr(bootstrap, feature(cfg_target_has_atomic))]\n #![feature(const_assume)]\n #![feature(const_black_box)]"}, {"sha": "f5b73128ad6c28a80a259f75f85879ca881f0b25", "filename": "src/doc/unstable-book/src/language-features/cfg-panic.md", "status": "removed", "additions": 0, "deletions": 38, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/4fa71ed0f0589133a3ab4a565d572f2c5373fad0/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fcfg-panic.md", "raw_url": "https://github.com/rust-lang/rust/raw/4fa71ed0f0589133a3ab4a565d572f2c5373fad0/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fcfg-panic.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fcfg-panic.md?ref=4fa71ed0f0589133a3ab4a565d572f2c5373fad0", "patch": "@@ -1,38 +0,0 @@\n-# `cfg_panic`\n-\n-The tracking issue for this feature is: [#77443]\n-\n-[#77443]: https://github.com/rust-lang/rust/issues/77443\n-\n-------------------------\n-\n-The `cfg_panic` feature makes it possible to execute different code\n-depending on the panic strategy.\n-\n-Possible values at the moment are `\"unwind\"` or `\"abort\"`, although\n-it is possible that new panic strategies may be added to Rust in the\n-future.\n-\n-## Examples\n-\n-```rust\n-#![feature(cfg_panic)]\n-\n-#[cfg(panic = \"unwind\")]\n-fn a() {\n-    // ...\n-}\n-\n-#[cfg(not(panic = \"unwind\"))]\n-fn a() {\n-    // ...\n-}\n-\n-fn b() {\n-    if cfg!(panic = \"abort\") {\n-        // ...\n-    } else {\n-        // ...\n-    }\n-}\n-```"}, {"sha": "3853b598a7a799aaede4c32e01e06b2b33978653", "filename": "src/test/ui/cfg/cfg-panic-abort.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f19adc7acc649ad2b18b6e172b683ebadb3d8a92/src%2Ftest%2Fui%2Fcfg%2Fcfg-panic-abort.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f19adc7acc649ad2b18b6e172b683ebadb3d8a92/src%2Ftest%2Fui%2Fcfg%2Fcfg-panic-abort.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcfg%2Fcfg-panic-abort.rs?ref=f19adc7acc649ad2b18b6e172b683ebadb3d8a92", "patch": "@@ -1,7 +1,7 @@\n // build-pass\n // compile-flags: -C panic=abort\n // no-prefer-dynamic\n-#![feature(cfg_panic)]\n+\n \n #[cfg(panic = \"unwind\")]\n pub fn bad() -> i32 { }"}, {"sha": "fb3e5059c8199b68c7db516ede49671ba8dfbbc1", "filename": "src/test/ui/cfg/cfg-panic.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f19adc7acc649ad2b18b6e172b683ebadb3d8a92/src%2Ftest%2Fui%2Fcfg%2Fcfg-panic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f19adc7acc649ad2b18b6e172b683ebadb3d8a92/src%2Ftest%2Fui%2Fcfg%2Fcfg-panic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcfg%2Fcfg-panic.rs?ref=f19adc7acc649ad2b18b6e172b683ebadb3d8a92", "patch": "@@ -4,7 +4,7 @@\n // ignore-emscripten no panic_unwind implementation\n // ignore-wasm32     no panic_unwind implementation\n // ignore-wasm64     no panic_unwind implementation\n-#![feature(cfg_panic)]\n+\n \n #[cfg(panic = \"abort\")]\n pub fn bad() -> i32 { }"}, {"sha": "1508374d9426622b852b97403aa99d7aeaac458f", "filename": "src/test/ui/feature-gates/feature-gate-cfg-panic.rs", "status": "removed", "additions": 0, "deletions": 11, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/4fa71ed0f0589133a3ab4a565d572f2c5373fad0/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-cfg-panic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4fa71ed0f0589133a3ab4a565d572f2c5373fad0/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-cfg-panic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-cfg-panic.rs?ref=4fa71ed0f0589133a3ab4a565d572f2c5373fad0", "patch": "@@ -1,11 +0,0 @@\n-#[cfg(panic = \"unwind\")]\n-//~^ ERROR `cfg(panic)` is experimental and subject to change\n-fn foo() -> bool { true }\n-#[cfg(not(panic = \"unwind\"))]\n-//~^ ERROR `cfg(panic)` is experimental and subject to change\n-fn foo() -> bool { false }\n-\n-\n-fn main() {\n-    assert!(foo());\n-}"}, {"sha": "ea5cd54fa90f0e3716f67758198408711edbb572", "filename": "src/test/ui/feature-gates/feature-gate-cfg-panic.stderr", "status": "removed", "additions": 0, "deletions": 21, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/4fa71ed0f0589133a3ab4a565d572f2c5373fad0/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-cfg-panic.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4fa71ed0f0589133a3ab4a565d572f2c5373fad0/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-cfg-panic.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-cfg-panic.stderr?ref=4fa71ed0f0589133a3ab4a565d572f2c5373fad0", "patch": "@@ -1,21 +0,0 @@\n-error[E0658]: `cfg(panic)` is experimental and subject to change\n-  --> $DIR/feature-gate-cfg-panic.rs:1:7\n-   |\n-LL | #[cfg(panic = \"unwind\")]\n-   |       ^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #77443 <https://github.com/rust-lang/rust/issues/77443> for more information\n-   = help: add `#![feature(cfg_panic)]` to the crate attributes to enable\n-\n-error[E0658]: `cfg(panic)` is experimental and subject to change\n-  --> $DIR/feature-gate-cfg-panic.rs:4:11\n-   |\n-LL | #[cfg(not(panic = \"unwind\"))]\n-   |           ^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #77443 <https://github.com/rust-lang/rust/issues/77443> for more information\n-   = help: add `#![feature(cfg_panic)]` to the crate attributes to enable\n-\n-error: aborting due to 2 previous errors\n-\n-For more information about this error, try `rustc --explain E0658`."}, {"sha": "560352b5cb958411c9db7ff5b69cfbf6a4aa2ba2", "filename": "src/test/ui/fmt/format-args-capture.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f19adc7acc649ad2b18b6e172b683ebadb3d8a92/src%2Ftest%2Fui%2Ffmt%2Fformat-args-capture.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f19adc7acc649ad2b18b6e172b683ebadb3d8a92/src%2Ftest%2Fui%2Ffmt%2Fformat-args-capture.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffmt%2Fformat-args-capture.rs?ref=f19adc7acc649ad2b18b6e172b683ebadb3d8a92", "patch": "@@ -1,5 +1,4 @@\n // run-pass\n-#![feature(cfg_panic)]\n \n fn main() {\n     named_argument_takes_precedence_to_captured();"}, {"sha": "2b12a62d0eb258143c7602f0e8ebaf177ad39d9f", "filename": "src/test/ui/issues/issue-68696-catch-during-unwind.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f19adc7acc649ad2b18b6e172b683ebadb3d8a92/src%2Ftest%2Fui%2Fissues%2Fissue-68696-catch-during-unwind.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f19adc7acc649ad2b18b6e172b683ebadb3d8a92/src%2Ftest%2Fui%2Fissues%2Fissue-68696-catch-during-unwind.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-68696-catch-during-unwind.rs?ref=f19adc7acc649ad2b18b6e172b683ebadb3d8a92", "patch": "@@ -4,7 +4,6 @@\n // entering the catch_unwind.\n //\n // run-pass\n-#![feature(cfg_panic)]\n \n use std::panic::catch_unwind;\n "}]}