{"sha": "f565447775a532c5b3b2d0d4b9fa8ee9fb36d12f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY1NjU0NDc3NzVhNTMyYzViM2IyZDBkNGI5ZmE4ZWU5ZmIzNmQxMmY=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2020-07-01T14:43:11Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-07-01T14:43:11Z"}, "message": "Merge #5173\n\n5173: Automatically reload project on config change r=matklad a=matklad\n\n\n\nbors r+\n\ud83e\udd16\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>", "tree": {"sha": "dbb9bcce274f1a1cdbc6cf4690c2d582427b2ef5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/dbb9bcce274f1a1cdbc6cf4690c2d582427b2ef5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f565447775a532c5b3b2d0d4b9fa8ee9fb36d12f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJe/KD/CRBK7hj4Ov3rIwAAdHIIABu0MUjTFl+mwVT9Ixjg9zx2\nLJDygwYbmrVWdn4X0D/sivvWMAO9G558w82fkI7lGvBgjJmEz8zFJqT74bQxsaND\nuaKpyqD9quTr0ypc5D2TF/O3uD+734nV67IQzKwxFlLc4C4/GI3462/Ig4p8dPzW\n+FRDfORWqyn6BkjNEC5s3e8f66I3o/ZpCa/MKaw3K8IZoEjzzzXZVgHLSrf3OVuZ\nok5eJSStlxRpj/R2Vz7REkCOQzcOjTnuisrgp0FOoubCOuw8PYb0TtKHr2L9zHHO\nS20pwA4hyBNPXZuPG1cnzZ5/6ABuR/TsMyRMZ3Kwd3/YrABm1vBNU52yYa6FSJw=\n=QeLf\n-----END PGP SIGNATURE-----\n", "payload": "tree dbb9bcce274f1a1cdbc6cf4690c2d582427b2ef5\nparent 3cf389f88bfec5e0caa6dd2f12c951f6f6b968d1\nparent a03cfa49268d3938b55ceff046d04a75de8972b9\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1593614591 +0000\ncommitter GitHub <noreply@github.com> 1593614591 +0000\n\nMerge #5173\n\n5173: Automatically reload project on config change r=matklad a=matklad\n\n\n\nbors r+\n\ud83e\udd16\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f565447775a532c5b3b2d0d4b9fa8ee9fb36d12f", "html_url": "https://github.com/rust-lang/rust/commit/f565447775a532c5b3b2d0d4b9fa8ee9fb36d12f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f565447775a532c5b3b2d0d4b9fa8ee9fb36d12f/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3cf389f88bfec5e0caa6dd2f12c951f6f6b968d1", "url": "https://api.github.com/repos/rust-lang/rust/commits/3cf389f88bfec5e0caa6dd2f12c951f6f6b968d1", "html_url": "https://github.com/rust-lang/rust/commit/3cf389f88bfec5e0caa6dd2f12c951f6f6b968d1"}, {"sha": "a03cfa49268d3938b55ceff046d04a75de8972b9", "url": "https://api.github.com/repos/rust-lang/rust/commits/a03cfa49268d3938b55ceff046d04a75de8972b9", "html_url": "https://github.com/rust-lang/rust/commit/a03cfa49268d3938b55ceff046d04a75de8972b9"}], "stats": {"total": 13, "additions": 8, "deletions": 5}, "files": [{"sha": "b0fe093335866ff5c34b7dba264a1e907f42598d", "filename": "crates/ra_project_model/src/project_json.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/f565447775a532c5b3b2d0d4b9fa8ee9fb36d12f/crates%2Fra_project_model%2Fsrc%2Fproject_json.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f565447775a532c5b3b2d0d4b9fa8ee9fb36d12f/crates%2Fra_project_model%2Fsrc%2Fproject_json.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_project_model%2Fsrc%2Fproject_json.rs?ref=f565447775a532c5b3b2d0d4b9fa8ee9fb36d12f", "patch": "@@ -10,22 +10,22 @@ use serde::{de, Deserialize};\n use stdx::split_delim;\n \n /// Roots and crates that compose this Rust project.\n-#[derive(Clone, Debug)]\n+#[derive(Clone, Debug, Eq, PartialEq)]\n pub struct ProjectJson {\n     pub(crate) roots: Vec<Root>,\n     pub(crate) crates: Vec<Crate>,\n }\n \n /// A root points to the directory which contains Rust crates. rust-analyzer watches all files in\n /// all roots. Roots might be nested.\n-#[derive(Clone, Debug)]\n+#[derive(Clone, Debug, Eq, PartialEq)]\n pub struct Root {\n     pub(crate) path: AbsPathBuf,\n }\n \n /// A crate points to the root module of a crate and lists the dependencies of the crate. This is\n /// useful in creating the crate graph.\n-#[derive(Clone, Debug)]\n+#[derive(Clone, Debug, Eq, PartialEq)]\n pub struct Crate {\n     pub(crate) root_module: AbsPathBuf,\n     pub(crate) edition: Edition,"}, {"sha": "6c311648a9d506bb8ee358883b09f419511c1596", "filename": "crates/rust-analyzer/src/config.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f565447775a532c5b3b2d0d4b9fa8ee9fb36d12f/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f565447775a532c5b3b2d0d4b9fa8ee9fb36d12f/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs?ref=f565447775a532c5b3b2d0d4b9fa8ee9fb36d12f", "patch": "@@ -44,7 +44,7 @@ pub struct Config {\n     pub root_path: AbsPathBuf,\n }\n \n-#[derive(Debug, Clone)]\n+#[derive(Debug, Clone, Eq, PartialEq)]\n pub enum LinkedProject {\n     ProjectManifest(ProjectManifest),\n     InlineJsonProject(ProjectJson),"}, {"sha": "0c1fd1b8b5b06d297f9dfa18fdf296b9492ca4d6", "filename": "crates/rust-analyzer/src/reload.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/f565447775a532c5b3b2d0d4b9fa8ee9fb36d12f/crates%2Frust-analyzer%2Fsrc%2Freload.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f565447775a532c5b3b2d0d4b9fa8ee9fb36d12f/crates%2Frust-analyzer%2Fsrc%2Freload.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Freload.rs?ref=f565447775a532c5b3b2d0d4b9fa8ee9fb36d12f", "patch": "@@ -19,11 +19,14 @@ impl GlobalState {\n         if self.config.lru_capacity != old_config.lru_capacity {\n             self.analysis_host.update_lru_capacity(old_config.lru_capacity);\n         }\n-        if self.config.flycheck != old_config.flycheck {\n+        if self.config.linked_projects != old_config.linked_projects {\n+            self.reload()\n+        } else if self.config.flycheck != old_config.flycheck {\n             self.reload_flycheck();\n         }\n     }\n     pub(crate) fn reload(&mut self) {\n+        log::info!(\"reloading projects: {:?}\", self.config.linked_projects);\n         let workspaces = {\n             if self.config.linked_projects.is_empty()\n                 && self.config.notifications.cargo_toml_not_found"}]}