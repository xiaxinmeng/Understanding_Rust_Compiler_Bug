{"sha": "7344d28768c43d8955bf23c183d606be08f27c64", "node_id": "MDY6Q29tbWl0NzI0NzEyOjczNDRkMjg3NjhjNDNkODk1NWJmMjNjMTgzZDYwNmJlMDhmMjdjNjQ=", "commit": {"author": {"name": "Bernardo", "email": "berublan@gmail.com", "date": "2018-12-10T21:09:12Z"}, "committer": {"name": "Bernardo", "email": "berublan@gmail.com", "date": "2018-12-10T21:09:12Z"}, "message": "extract AtomEdit and Edit into new ra_text_edit crate", "tree": {"sha": "f0773b4db640dac303f1f683115c780ac3eb0b9c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f0773b4db640dac303f1f683115c780ac3eb0b9c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7344d28768c43d8955bf23c183d606be08f27c64", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7344d28768c43d8955bf23c183d606be08f27c64", "html_url": "https://github.com/rust-lang/rust/commit/7344d28768c43d8955bf23c183d606be08f27c64", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7344d28768c43d8955bf23c183d606be08f27c64/comments", "author": {"login": "vemoo", "id": 4866051, "node_id": "MDQ6VXNlcjQ4NjYwNTE=", "avatar_url": "https://avatars.githubusercontent.com/u/4866051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vemoo", "html_url": "https://github.com/vemoo", "followers_url": "https://api.github.com/users/vemoo/followers", "following_url": "https://api.github.com/users/vemoo/following{/other_user}", "gists_url": "https://api.github.com/users/vemoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/vemoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vemoo/subscriptions", "organizations_url": "https://api.github.com/users/vemoo/orgs", "repos_url": "https://api.github.com/users/vemoo/repos", "events_url": "https://api.github.com/users/vemoo/events{/privacy}", "received_events_url": "https://api.github.com/users/vemoo/received_events", "type": "User", "site_admin": false}, "committer": {"login": "vemoo", "id": 4866051, "node_id": "MDQ6VXNlcjQ4NjYwNTE=", "avatar_url": "https://avatars.githubusercontent.com/u/4866051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vemoo", "html_url": "https://github.com/vemoo", "followers_url": "https://api.github.com/users/vemoo/followers", "following_url": "https://api.github.com/users/vemoo/following{/other_user}", "gists_url": "https://api.github.com/users/vemoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/vemoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vemoo/subscriptions", "organizations_url": "https://api.github.com/users/vemoo/orgs", "repos_url": "https://api.github.com/users/vemoo/repos", "events_url": "https://api.github.com/users/vemoo/events{/privacy}", "received_events_url": "https://api.github.com/users/vemoo/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f655f993fe6d9faa81b0e776b9b24308d2ea1c68", "url": "https://api.github.com/repos/rust-lang/rust/commits/f655f993fe6d9faa81b0e776b9b24308d2ea1c68", "html_url": "https://github.com/rust-lang/rust/commit/f655f993fe6d9faa81b0e776b9b24308d2ea1c68"}], "stats": {"total": 121, "additions": 81, "deletions": 40}, "files": [{"sha": "56d5c65b9cd3c94bb2b4549d5080215b07088967", "filename": "Cargo.lock", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -610,6 +610,7 @@ dependencies = [\n  \"ra_editor 0.1.0\",\n  \"ra_hir 0.1.0\",\n  \"ra_syntax 0.1.0\",\n+ \"ra_text_edit 0.1.0\",\n  \"rayon 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"relative-path 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rustc-hash 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -649,6 +650,7 @@ dependencies = [\n  \"itertools 0.7.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"join_to_string 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"ra_syntax 0.1.0\",\n+ \"ra_text_edit 0.1.0\",\n  \"rustc-hash 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"superslice 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"test_utils 0.1.0\",\n@@ -687,6 +689,7 @@ dependencies = [\n  \"ra_analysis 0.1.0\",\n  \"ra_editor 0.1.0\",\n  \"ra_syntax 0.1.0\",\n+ \"ra_text_edit 0.1.0\",\n  \"rayon 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"relative-path 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rustc-hash 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -710,13 +713,22 @@ dependencies = [\n  \"drop_bomb 0.1.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"itertools 0.7.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"parking_lot 0.6.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"ra_text_edit 0.1.0\",\n  \"rowan 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"test_utils 0.1.0\",\n  \"text_unit 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"unicode-xid 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"walkdir 2.2.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n+[[package]]\n+name = \"ra_text_edit\"\n+version = \"0.1.0\"\n+dependencies = [\n+ \"test_utils 0.1.0\",\n+ \"text_unit 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+]\n+\n [[package]]\n name = \"rand\"\n version = \"0.4.3\""}, {"sha": "4a7b99947e164395f57c3aca9749bd38e06c88b0", "filename": "crates/ra_analysis/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_analysis%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_analysis%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_analysis%2FCargo.toml?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -14,6 +14,7 @@ rustc-hash = \"1.0\"\n parking_lot = \"0.6.4\"\n ra_syntax = { path = \"../ra_syntax\" }\n ra_editor = { path = \"../ra_editor\" }\n+ra_text_edit = { path = \"../ra_text_edit\" }\n ra_db = { path = \"../ra_db\" }\n hir = { path = \"../ra_hir\", package = \"ra_hir\" }\n test_utils = { path = \"../test_utils\" }"}, {"sha": "e833309666c25d386fcd6d1e91e1d0e6cc17d765", "filename": "crates/ra_analysis/src/completion.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_analysis%2Fsrc%2Fcompletion.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_analysis%2Fsrc%2Fcompletion.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_analysis%2Fsrc%2Fcompletion.rs?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -1,10 +1,11 @@\n mod reference_completion;\n \n use ra_editor::find_node_at_offset;\n+use ra_text_edit::AtomEdit;\n use ra_syntax::{\n     algo::visit::{visitor_ctx, VisitorCtx},\n     ast,\n-    AstNode, AtomEdit,\n+    AstNode,\n     SyntaxNodeRef,\n };\n use ra_db::SyntaxDatabase;"}, {"sha": "2f8f1dab5e276e1e86090e3132f82930ef857004", "filename": "crates/ra_analysis/src/lib.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_analysis%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_analysis%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_analysis%2Fsrc%2Flib.rs?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -18,7 +18,8 @@ pub mod mock_analysis;\n \n use std::{fmt, sync::Arc};\n \n-use ra_syntax::{AtomEdit, SourceFileNode, TextRange, TextUnit};\n+use ra_syntax::{SourceFileNode, TextRange, TextUnit};\n+use ra_text_edit::AtomEdit;\n use ra_db::FileResolverImp;\n use rayon::prelude::*;\n use relative_path::RelativePathBuf;"}, {"sha": "c29be13509a5ab66b67a3405101712fa3a4bdd15", "filename": "crates/ra_editor/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_editor%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_editor%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_editor%2FCargo.toml?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -12,6 +12,7 @@ join_to_string = \"0.1.1\"\n rustc-hash = \"1.0\"\n \n ra_syntax = { path = \"../ra_syntax\" }\n+ra_text_edit = { path = \"../ra_text_edit\" }\n \n [dev-dependencies]\n test_utils = { path = \"../test_utils\" }"}, {"sha": "ddc44c77823bfe54eb0c1b04ff1f2b5f7911b2ec", "filename": "crates/ra_editor/src/lib.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_editor%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_editor%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_editor%2Fsrc%2Flib.rs?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -1,5 +1,4 @@\n mod code_actions;\n-mod edit;\n mod extend_selection;\n mod folding_ranges;\n mod line_index;\n@@ -10,14 +9,13 @@ mod typing;\n \n pub use self::{\n     code_actions::{add_derive, add_impl, flip_comma, introduce_variable, LocalEdit},\n-    edit::{Edit, EditBuilder},\n     extend_selection::extend_selection,\n     folding_ranges::{folding_ranges, Fold, FoldKind},\n     line_index::{LineCol, LineIndex},\n     symbols::{file_structure, file_symbols, FileSymbol, StructureNode},\n     typing::{join_lines, on_enter, on_eq_typed},\n };\n-pub use ra_syntax::AtomEdit;\n+use ra_text_edit::{Edit, EditBuilder};\n use ra_syntax::{\n     algo::find_leaf_at_offset,\n     ast::{self, AstNode, NameOwner},"}, {"sha": "cf9af001b895befd776df06a8f2102b153098f87", "filename": "crates/ra_editor/src/typing.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_editor%2Fsrc%2Ftyping.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_editor%2Fsrc%2Ftyping.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_editor%2Fsrc%2Ftyping.rs?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -3,11 +3,12 @@ use std::mem;\n use ra_syntax::{\n     algo::{find_covering_node, find_leaf_at_offset, LeafAtOffset},\n     ast,\n-    text_utils::{contains_offset_nonstrict, intersect},\n+    text_utils::intersect,\n     AstNode, SourceFileNode, SyntaxKind,\n     SyntaxKind::*,\n     SyntaxNodeRef, TextRange, TextUnit,\n };\n+use ra_text_edit::text_utils::contains_offset_nonstrict;\n \n use crate::{find_node_at_offset, EditBuilder, LocalEdit};\n "}, {"sha": "133decc525783d0a9b9bc2dac8d188fb1c610721", "filename": "crates/ra_lsp_server/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_lsp_server%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_lsp_server%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2FCargo.toml?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -28,6 +28,7 @@ rustc-hash = \"1.0\"\n \n ra_syntax = { path = \"../ra_syntax\" }\n ra_editor = { path = \"../ra_editor\" }\n+ra_text_edit = { path = \"../ra_text_edit\" }\n ra_analysis = { path = \"../ra_analysis\" }\n gen_lsp_server = { path = \"../gen_lsp_server\" }\n "}, {"sha": "8bf8576be9b48305689ea285dc7e17efc9d6e982", "filename": "crates/ra_lsp_server/src/conv.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_lsp_server%2Fsrc%2Fconv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_lsp_server%2Fsrc%2Fconv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fconv.rs?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -3,7 +3,8 @@ use languageserver_types::{\n     TextDocumentItem, TextDocumentPositionParams, TextEdit, Url, VersionedTextDocumentIdentifier,\n };\n use ra_analysis::{FileId, FileSystemEdit, SourceChange, SourceFileNodeEdit, FilePosition};\n-use ra_editor::{AtomEdit, Edit, LineCol, LineIndex};\n+use ra_editor::{LineCol, LineIndex};\n+use ra_text_edit::{AtomEdit, Edit};\n use ra_syntax::{SyntaxKind, TextRange, TextUnit};\n \n use crate::{req, server_world::ServerWorld, Result};"}, {"sha": "21ca22c5c4d3e3e6f369ac9345734b5933df690e", "filename": "crates/ra_lsp_server/src/main_loop/handlers.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop%2Fhandlers.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop%2Fhandlers.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop%2Fhandlers.rs?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -9,7 +9,8 @@ use languageserver_types::{\n     WorkspaceEdit, ParameterInformation, SignatureInformation, Hover, HoverContents,\n };\n use ra_analysis::{FileId, FoldKind, Query, RunnableKind, FilePosition};\n-use ra_syntax::{TextUnit, text_utils::{contains_offset_nonstrict, intersect}};\n+use ra_syntax::{TextUnit, text_utils::intersect};\n+use ra_text_edit::text_utils::contains_offset_nonstrict;\n use rustc_hash::FxHashMap;\n use serde_json::to_value;\n "}, {"sha": "8c9a7e238b6aa0fd95bc82bde140221751fe8be4", "filename": "crates/ra_syntax/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_syntax%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_syntax%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2FCargo.toml?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -15,6 +15,7 @@ drop_bomb = \"0.1.4\"\n parking_lot = \"0.6.0\"\n rowan = \"0.1.2\"\n text_unit = \"0.1.5\"\n+ra_text_edit = { path = \"../ra_text_edit\" }\n \n [dev-dependencies]\n test_utils = { path = \"../test_utils\" }"}, {"sha": "7295fb2378e8c7baa4502c10674c4e4ea4046f50", "filename": "crates/ra_syntax/src/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_syntax%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_syntax%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Fsrc%2Flib.rs?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -41,13 +41,13 @@ pub use rowan::{SmolStr, TextRange, TextUnit};\n pub use crate::{\n     ast::AstNode,\n     lexer::{tokenize, Token},\n-    reparsing::AtomEdit,\n     syntax_kinds::SyntaxKind,\n     yellow::{\n         Direction, OwnedRoot, RefRoot, SyntaxError, SyntaxNode, SyntaxNodeRef, TreeRoot, WalkEvent, Location,\n     },\n };\n \n+use ra_text_edit::AtomEdit;\n use crate::yellow::GreenNode;\n \n /// `SourceFileNode` represents a parse tree for a single Rust file."}, {"sha": "873809a5a35a84509dd75ab621f8d60f77ef36aa", "filename": "crates/ra_syntax/src/reparsing.rs", "status": "modified", "additions": 1, "deletions": 23, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_syntax%2Fsrc%2Freparsing.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_syntax%2Fsrc%2Freparsing.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Fsrc%2Freparsing.rs?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -6,29 +6,7 @@ use crate::parser_impl;\n use crate::text_utils::replace_range;\n use crate::yellow::{self, GreenNode, SyntaxError, SyntaxNodeRef};\n use crate::{SyntaxKind::*, TextRange, TextUnit};\n-\n-#[derive(Debug, Clone)]\n-pub struct AtomEdit {\n-    pub delete: TextRange,\n-    pub insert: String,\n-}\n-\n-impl AtomEdit {\n-    pub fn replace(range: TextRange, replace_with: String) -> AtomEdit {\n-        AtomEdit {\n-            delete: range,\n-            insert: replace_with,\n-        }\n-    }\n-\n-    pub fn delete(range: TextRange) -> AtomEdit {\n-        AtomEdit::replace(range, String::new())\n-    }\n-\n-    pub fn insert(offset: TextUnit, text: String) -> AtomEdit {\n-        AtomEdit::replace(TextRange::offset_len(offset, 0.into()), text)\n-    }\n-}\n+use ra_text_edit::AtomEdit;\n \n pub(crate) fn incremental_reparse(\n     node: SyntaxNodeRef,"}, {"sha": "417d43e1ba0e5b488efd2c99e7ec3dfc12bd2638", "filename": "crates/ra_syntax/src/text_utils.rs", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_syntax%2Fsrc%2Ftext_utils.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_syntax%2Fsrc%2Ftext_utils.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Fsrc%2Ftext_utils.rs?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -1,8 +1,4 @@\n-use crate::{TextRange, TextUnit};\n-\n-pub fn contains_offset_nonstrict(range: TextRange, offset: TextUnit) -> bool {\n-    range.start() <= offset && offset <= range.end()\n-}\n+use crate::TextRange;\n \n pub fn intersect(r1: TextRange, r2: TextRange) -> Option<TextRange> {\n     let start = r1.start().max(r2.start());"}, {"sha": "46bde9a086bc0aa9fa26d2fec182ff608c955f7e", "filename": "crates/ra_syntax/src/yellow/syntax_text.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_syntax%2Fsrc%2Fyellow%2Fsyntax_text.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_syntax%2Fsrc%2Fyellow%2Fsyntax_text.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Fsrc%2Fyellow%2Fsyntax_text.rs?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -1,7 +1,8 @@\n use std::{fmt, ops};\n \n+use ra_text_edit::text_utils::contains_offset_nonstrict;\n use crate::{\n-    text_utils::{contains_offset_nonstrict, intersect},\n+    text_utils::intersect,\n     SyntaxNodeRef, TextRange, TextUnit,\n };\n "}, {"sha": "3c4157a4e721b210778edfdf4cc7032aade1ca80", "filename": "crates/ra_text_edit/Cargo.toml", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_text_edit%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_text_edit%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_text_edit%2FCargo.toml?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -0,0 +1,12 @@\n+[package]\n+edition = \"2018\"\n+name = \"ra_text_edit\"\n+version = \"0.1.0\"\n+authors = [\"Aleksey Kladov <aleksey.kladov@gmail.com>\"]\n+publish = false\n+\n+[dependencies]\n+text_unit = \"0.1.5\"\n+\n+[dev-dependencies]\n+test_utils = { path = \"../test_utils\" }"}, {"sha": "560cf2bbc9804d1c43241be5b6e37ab0de79bab2", "filename": "crates/ra_text_edit/src/edit.rs", "status": "renamed", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_text_edit%2Fsrc%2Fedit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_text_edit%2Fsrc%2Fedit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_text_edit%2Fsrc%2Fedit.rs?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -1,5 +1,6 @@\n-use crate::{TextRange, TextUnit};\n-use ra_syntax::{text_utils::contains_offset_nonstrict, AtomEdit};\n+use crate::AtomEdit;\n+use crate::text_utils::contains_offset_nonstrict;\n+use text_unit::{TextRange, TextUnit};\n \n #[derive(Debug, Clone)]\n pub struct Edit {", "previous_filename": "crates/ra_editor/src/edit.rs"}, {"sha": "789471e8a282523ce142f116ee2ec3ff2c7d0247", "filename": "crates/ra_text_edit/src/lib.rs", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_text_edit%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_text_edit%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_text_edit%2Fsrc%2Flib.rs?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -0,0 +1,29 @@\n+mod edit;\n+pub mod text_utils;\n+\n+pub use crate::edit::{Edit, EditBuilder};\n+\n+use text_unit::{TextRange, TextUnit};\n+\n+#[derive(Debug, Clone)]\n+pub struct AtomEdit {\n+    pub delete: TextRange,\n+    pub insert: String,\n+}\n+\n+impl AtomEdit {\n+    pub fn replace(range: TextRange, replace_with: String) -> AtomEdit {\n+        AtomEdit {\n+            delete: range,\n+            insert: replace_with,\n+        }\n+    }\n+\n+    pub fn delete(range: TextRange) -> AtomEdit {\n+        AtomEdit::replace(range, String::new())\n+    }\n+\n+    pub fn insert(offset: TextUnit, text: String) -> AtomEdit {\n+        AtomEdit::replace(TextRange::offset_len(offset, 0.into()), text)\n+    }\n+}"}, {"sha": "e3b4dc4fe35552b9bfce0d3eac6844a4c39af98e", "filename": "crates/ra_text_edit/src/text_utils.rs", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_text_edit%2Fsrc%2Ftext_utils.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7344d28768c43d8955bf23c183d606be08f27c64/crates%2Fra_text_edit%2Fsrc%2Ftext_utils.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_text_edit%2Fsrc%2Ftext_utils.rs?ref=7344d28768c43d8955bf23c183d606be08f27c64", "patch": "@@ -0,0 +1,5 @@\n+use text_unit::{TextRange, TextUnit};\n+\n+pub fn contains_offset_nonstrict(range: TextRange, offset: TextUnit) -> bool {\n+    range.start() <= offset && offset <= range.end()\n+}"}]}