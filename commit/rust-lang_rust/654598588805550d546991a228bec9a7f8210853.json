{"sha": "654598588805550d546991a228bec9a7f8210853", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY1NDU5ODU4ODgwNTU1MGQ1NDY5OTFhMjI4YmVjOWE3ZjgyMTA4NTM=", "commit": {"author": {"name": "Dylan DPC", "email": "dylan.dpc@gmail.com", "date": "2020-09-06T23:17:46Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-09-06T23:17:46Z"}, "message": "Rollup merge of #76274 - scottmcm:fix-76271, r=petrochenkov\n\nAllow try blocks as the argument to return expressions\n\nFixes #76271\n\nI don't think this needs to be edition-aware (phew) since `return try` in 2015 is also the start of an expression, just with a struct literal instead of a block (`return try { x: 4, y: 5 }`).", "tree": {"sha": "8d67fb798c275e3c0ff1807acf76be82b8ca6d42", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8d67fb798c275e3c0ff1807acf76be82b8ca6d42"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/654598588805550d546991a228bec9a7f8210853", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfVW4bCRBK7hj4Ov3rIwAAdHIIAFkt/oOmpK0yrm5YVoueC3Pq\nXtwaMt7t6sg6AL4YZPSjplGZJHBlJxtF9p72QvsqrHrZSEMBA3KUR4iBbxwdKrEn\nvazZH6/xevTg3+DV+8OR9QxN/gkj5QxfPRYDgfP44ajJ9SKmknJZ6uDRQY3tP1h6\nSW+CI0obaPM4AdkXuh1nDHrnvz8HFVN2wxMBXgnxC/dRkd+UeHA1RA6sXI0mP1tf\nxtJiJ+Xm9kdaJ8jvSrKfod5WRPQEL4UP3w4o3INhYOBevftHUtqLhNfVj/UYQYej\n/Zd08ofwEIBp81mXP8KlI7Vi3wxDqfep7nBOgY304hutP/WBy/tihKRdrOT5dms=\n=C3cG\n-----END PGP SIGNATURE-----\n", "payload": "tree 8d67fb798c275e3c0ff1807acf76be82b8ca6d42\nparent e488c4f187be7f561ff24fcbdc8427767be79f1f\nparent 791f93c796f7b4f0346eee276baf6e31ed3c81ea\nauthor Dylan DPC <dylan.dpc@gmail.com> 1599434266 +0200\ncommitter GitHub <noreply@github.com> 1599434266 +0200\n\nRollup merge of #76274 - scottmcm:fix-76271, r=petrochenkov\n\nAllow try blocks as the argument to return expressions\n\nFixes #76271\n\nI don't think this needs to be edition-aware (phew) since `return try` in 2015 is also the start of an expression, just with a struct literal instead of a block (`return try { x: 4, y: 5 }`).\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/654598588805550d546991a228bec9a7f8210853", "html_url": "https://github.com/rust-lang/rust/commit/654598588805550d546991a228bec9a7f8210853", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/654598588805550d546991a228bec9a7f8210853/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e488c4f187be7f561ff24fcbdc8427767be79f1f", "url": "https://api.github.com/repos/rust-lang/rust/commits/e488c4f187be7f561ff24fcbdc8427767be79f1f", "html_url": "https://github.com/rust-lang/rust/commit/e488c4f187be7f561ff24fcbdc8427767be79f1f"}, {"sha": "791f93c796f7b4f0346eee276baf6e31ed3c81ea", "url": "https://api.github.com/repos/rust-lang/rust/commits/791f93c796f7b4f0346eee276baf6e31ed3c81ea", "html_url": "https://github.com/rust-lang/rust/commit/791f93c796f7b4f0346eee276baf6e31ed3c81ea"}], "stats": {"total": 13, "additions": 13, "deletions": 0}, "files": [{"sha": "09c0983bb9d1aa0c1b96d4b442ce31b1f206855f", "filename": "compiler/rustc_ast/src/token.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/654598588805550d546991a228bec9a7f8210853/compiler%2Frustc_ast%2Fsrc%2Ftoken.rs", "raw_url": "https://github.com/rust-lang/rust/raw/654598588805550d546991a228bec9a7f8210853/compiler%2Frustc_ast%2Fsrc%2Ftoken.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast%2Fsrc%2Ftoken.rs?ref=654598588805550d546991a228bec9a7f8210853", "patch": "@@ -173,6 +173,7 @@ pub fn ident_can_begin_expr(name: Symbol, span: Span, is_raw: bool) -> bool {\n             kw::Move,\n             kw::Return,\n             kw::True,\n+            kw::Try,\n             kw::Unsafe,\n             kw::While,\n             kw::Yield,"}, {"sha": "a15bfeef1c12d49b07d50a85983ac586042e8e57", "filename": "src/test/ui/try-block/try-block-in-return.rs", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/654598588805550d546991a228bec9a7f8210853/src%2Ftest%2Fui%2Ftry-block%2Ftry-block-in-return.rs", "raw_url": "https://github.com/rust-lang/rust/raw/654598588805550d546991a228bec9a7f8210853/src%2Ftest%2Fui%2Ftry-block%2Ftry-block-in-return.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftry-block%2Ftry-block-in-return.rs?ref=654598588805550d546991a228bec9a7f8210853", "patch": "@@ -0,0 +1,12 @@\n+// run-pass\n+// compile-flags: --edition 2018\n+\n+#![feature(try_blocks)]\n+\n+fn issue_76271() -> Option<i32> {\n+    return try { 4 }\n+}\n+\n+fn main() {\n+    assert_eq!(issue_76271(), Some(4));\n+}"}]}