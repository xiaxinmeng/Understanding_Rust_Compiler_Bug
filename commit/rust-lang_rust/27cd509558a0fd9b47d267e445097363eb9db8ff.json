{"sha": "27cd509558a0fd9b47d267e445097363eb9db8ff", "node_id": "C_kwDOAAsO6NoAKDI3Y2Q1MDk1NThhMGZkOWI0N2QyNjdlNDQ1MDk3MzYzZWI5ZGI4ZmY", "commit": {"author": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2023-02-07T16:41:16Z"}, "committer": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2023-02-07T16:41:16Z"}, "message": "fix jointess for floats not being set properly", "tree": {"sha": "67b72a533c51fcc3a765020ab934b8aadf2dad1b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/67b72a533c51fcc3a765020ab934b8aadf2dad1b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/27cd509558a0fd9b47d267e445097363eb9db8ff", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/27cd509558a0fd9b47d267e445097363eb9db8ff", "html_url": "https://github.com/rust-lang/rust/commit/27cd509558a0fd9b47d267e445097363eb9db8ff", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/27cd509558a0fd9b47d267e445097363eb9db8ff/comments", "author": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e59487de38b1be5b06b92eb4a9d30c0adb32d9db", "url": "https://api.github.com/repos/rust-lang/rust/commits/e59487de38b1be5b06b92eb4a9d30c0adb32d9db", "html_url": "https://github.com/rust-lang/rust/commit/e59487de38b1be5b06b92eb4a9d30c0adb32d9db"}], "stats": {"total": 16, "additions": 7, "deletions": 9}, "files": [{"sha": "21939c349435d9d0de64502412675a1428095a27", "filename": "crates/parser/src/shortcuts.rs", "status": "modified", "additions": 7, "deletions": 9, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/27cd509558a0fd9b47d267e445097363eb9db8ff/crates%2Fparser%2Fsrc%2Fshortcuts.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27cd509558a0fd9b47d267e445097363eb9db8ff/crates%2Fparser%2Fsrc%2Fshortcuts.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Fsrc%2Fshortcuts.rs?ref=27cd509558a0fd9b47d267e445097363eb9db8ff", "patch": "@@ -43,18 +43,16 @@ impl<'a> LexedStr<'a> {\n                         res.was_joint();\n                     }\n                     res.push(kind);\n-                }\n-                if kind == SyntaxKind::FLOAT_NUMBER {\n                     // we set jointness for floating point numbers as a hack to inform the\n                     // parser about whether we have a `0.` or `0.1` style float\n-                    if self.text(i).split_once('.').map_or(false, |(_, it)| it.is_empty()) {\n-                        was_joint = false;\n-                    } else {\n-                        was_joint = true;\n+                    if kind == SyntaxKind::FLOAT_NUMBER {\n+                        if !self.text(i).split_once('.').map_or(true, |(_, it)| it.is_empty()) {\n+                            res.was_joint();\n+                        }\n                     }\n-                } else {\n-                    was_joint = true;\n                 }\n+\n+                was_joint = true;\n             }\n         }\n         res\n@@ -202,7 +200,7 @@ impl Builder<'_, '_> {\n                 (self.sink)(StrStep::Token { kind: SyntaxKind::DOT, text: \".\" });\n \n                 if has_pseudo_dot {\n-                    assert!(right.is_empty());\n+                    assert!(right.is_empty(), \"{left}.{right}\");\n                     self.state = State::Normal;\n                 } else {\n                     (self.sink)(StrStep::Enter { kind: SyntaxKind::NAME_REF });"}]}