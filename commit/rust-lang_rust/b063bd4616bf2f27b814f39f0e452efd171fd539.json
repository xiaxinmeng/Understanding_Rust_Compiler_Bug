{"sha": "b063bd4616bf2f27b814f39f0e452efd171fd539", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIwNjNiZDQ2MTZiZjJmMjdiODE0ZjM5ZjBlNDUyZWZkMTcxZmQ1Mzk=", "commit": {"author": {"name": "Pazzaz", "email": "pazzaz.sundqvist@gmail.com", "date": "2018-08-15T17:42:07Z"}, "committer": {"name": "Pazzaz", "email": "pazzaz.sundqvist@gmail.com", "date": "2018-08-15T17:42:07Z"}, "message": "Test VecDeque append not dropping twice", "tree": {"sha": "3f921d87352e20524defded86c729506a156d478", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3f921d87352e20524defded86c729506a156d478"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b063bd4616bf2f27b814f39f0e452efd171fd539", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b063bd4616bf2f27b814f39f0e452efd171fd539", "html_url": "https://github.com/rust-lang/rust/commit/b063bd4616bf2f27b814f39f0e452efd171fd539", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b063bd4616bf2f27b814f39f0e452efd171fd539/comments", "author": {"login": "Pazzaz", "id": 16006944, "node_id": "MDQ6VXNlcjE2MDA2OTQ0", "avatar_url": "https://avatars.githubusercontent.com/u/16006944?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Pazzaz", "html_url": "https://github.com/Pazzaz", "followers_url": "https://api.github.com/users/Pazzaz/followers", "following_url": "https://api.github.com/users/Pazzaz/following{/other_user}", "gists_url": "https://api.github.com/users/Pazzaz/gists{/gist_id}", "starred_url": "https://api.github.com/users/Pazzaz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Pazzaz/subscriptions", "organizations_url": "https://api.github.com/users/Pazzaz/orgs", "repos_url": "https://api.github.com/users/Pazzaz/repos", "events_url": "https://api.github.com/users/Pazzaz/events{/privacy}", "received_events_url": "https://api.github.com/users/Pazzaz/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Pazzaz", "id": 16006944, "node_id": "MDQ6VXNlcjE2MDA2OTQ0", "avatar_url": "https://avatars.githubusercontent.com/u/16006944?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Pazzaz", "html_url": "https://github.com/Pazzaz", "followers_url": "https://api.github.com/users/Pazzaz/followers", "following_url": "https://api.github.com/users/Pazzaz/following{/other_user}", "gists_url": "https://api.github.com/users/Pazzaz/gists{/gist_id}", "starred_url": "https://api.github.com/users/Pazzaz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Pazzaz/subscriptions", "organizations_url": "https://api.github.com/users/Pazzaz/orgs", "repos_url": "https://api.github.com/users/Pazzaz/repos", "events_url": "https://api.github.com/users/Pazzaz/events{/privacy}", "received_events_url": "https://api.github.com/users/Pazzaz/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "76625280b25bfe66d3a6e2c7e4c04726886fa7e1", "url": "https://api.github.com/repos/rust-lang/rust/commits/76625280b25bfe66d3a6e2c7e4c04726886fa7e1", "html_url": "https://github.com/rust-lang/rust/commit/76625280b25bfe66d3a6e2c7e4c04726886fa7e1"}], "stats": {"total": 25, "additions": 25, "deletions": 0}, "files": [{"sha": "3ea6c87a6516939ecca7ec94a41b162ba5cd18fc", "filename": "src/liballoc/tests/vec_deque.rs", "status": "modified", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/b063bd4616bf2f27b814f39f0e452efd171fd539/src%2Fliballoc%2Ftests%2Fvec_deque.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b063bd4616bf2f27b814f39f0e452efd171fd539/src%2Fliballoc%2Ftests%2Fvec_deque.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Ftests%2Fvec_deque.rs?ref=b063bd4616bf2f27b814f39f0e452efd171fd539", "patch": "@@ -1004,6 +1004,31 @@ fn test_append_permutations() {\n     }\n }\n \n+struct DropCounter<'a> {\n+    count: &'a mut u32,\n+}\n+\n+impl<'a> Drop for DropCounter<'a> {\n+    fn drop(&mut self) {\n+        *self.count += 1;\n+    }\n+}\n+\n+#[test]\n+fn test_append_double_drop() {\n+    let (mut count_a, mut count_b) = (0, 0);\n+    {\n+        let mut a = VecDeque::new();\n+        let mut b = VecDeque::new();\n+        a.push_back(DropCounter { count: &mut count_a });\n+        b.push_back(DropCounter { count: &mut count_b });\n+\n+        a.append(&mut b);\n+    }\n+    assert_eq!(count_a, 1);\n+    assert_eq!(count_b, 1);\n+}\n+\n #[test]\n fn test_retain() {\n     let mut buf = VecDeque::new();"}]}