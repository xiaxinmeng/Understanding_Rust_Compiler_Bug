{"sha": "67202b8b68d93c90e89ca001945865f13bc97154", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY3MjAyYjhiNjhkOTNjOTBlODljYTAwMTk0NTg2NWYxM2JjOTcxNTQ=", "commit": {"author": {"name": "Simon Sapin", "email": "simon.sapin@exyr.org", "date": "2018-07-06T23:44:57Z"}, "committer": {"name": "Simon Sapin", "email": "simon.sapin@exyr.org", "date": "2018-07-06T23:44:57Z"}, "message": "Fix is_dangling import when Arc is #[cfg]\u2019ed out", "tree": {"sha": "a8794d3b4071cd0b9013df73f05d0195f7af7640", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a8794d3b4071cd0b9013df73f05d0195f7af7640"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/67202b8b68d93c90e89ca001945865f13bc97154", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/67202b8b68d93c90e89ca001945865f13bc97154", "html_url": "https://github.com/rust-lang/rust/commit/67202b8b68d93c90e89ca001945865f13bc97154", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/67202b8b68d93c90e89ca001945865f13bc97154/comments", "author": {"login": "SimonSapin", "id": 291359, "node_id": "MDQ6VXNlcjI5MTM1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SimonSapin", "html_url": "https://github.com/SimonSapin", "followers_url": "https://api.github.com/users/SimonSapin/followers", "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}", "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}", "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions", "organizations_url": "https://api.github.com/users/SimonSapin/orgs", "repos_url": "https://api.github.com/users/SimonSapin/repos", "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}", "received_events_url": "https://api.github.com/users/SimonSapin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "SimonSapin", "id": 291359, "node_id": "MDQ6VXNlcjI5MTM1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SimonSapin", "html_url": "https://github.com/SimonSapin", "followers_url": "https://api.github.com/users/SimonSapin/followers", "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}", "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}", "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions", "organizations_url": "https://api.github.com/users/SimonSapin/orgs", "repos_url": "https://api.github.com/users/SimonSapin/repos", "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}", "received_events_url": "https://api.github.com/users/SimonSapin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5717d99d1b3b76ec7814c95dfcc0399ab4ddaa83", "url": "https://api.github.com/repos/rust-lang/rust/commits/5717d99d1b3b76ec7814c95dfcc0399ab4ddaa83", "html_url": "https://github.com/rust-lang/rust/commit/5717d99d1b3b76ec7814c95dfcc0399ab4ddaa83"}], "stats": {"total": 14, "additions": 7, "deletions": 7}, "files": [{"sha": "5b71d0b85a03eb06d2d846094821e3461a1b0a16", "filename": "src/liballoc/rc.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/67202b8b68d93c90e89ca001945865f13bc97154/src%2Fliballoc%2Frc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/67202b8b68d93c90e89ca001945865f13bc97154/src%2Fliballoc%2Frc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Frc.rs?ref=67202b8b68d93c90e89ca001945865f13bc97154", "patch": "@@ -261,7 +261,6 @@ use core::convert::From;\n \n use alloc::{Global, Alloc, Layout, box_free, handle_alloc_error};\n use string::String;\n-use sync::is_dangling;\n use vec::Vec;\n \n struct RcBox<T: ?Sized> {\n@@ -1192,6 +1191,12 @@ impl<T> Weak<T> {\n     }\n }\n \n+pub(crate) fn is_dangling<T: ?Sized>(ptr: NonNull<T>) -> bool {\n+    let address = ptr.as_ptr() as *mut () as usize;\n+    let align = align_of_val(unsafe { ptr.as_ref() });\n+    address == align\n+}\n+\n impl<T: ?Sized> Weak<T> {\n     /// Attempts to upgrade the `Weak` pointer to an [`Rc`], extending\n     /// the lifetime of the value if successful."}, {"sha": "6710878b31d945bdc2cfdf7a4cd111ec544bd672", "filename": "src/liballoc/sync.rs", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/67202b8b68d93c90e89ca001945865f13bc97154/src%2Fliballoc%2Fsync.rs", "raw_url": "https://github.com/rust-lang/rust/raw/67202b8b68d93c90e89ca001945865f13bc97154/src%2Fliballoc%2Fsync.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Fsync.rs?ref=67202b8b68d93c90e89ca001945865f13bc97154", "patch": "@@ -34,6 +34,7 @@ use core::convert::From;\n \n use alloc::{Global, Alloc, Layout, box_free, handle_alloc_error};\n use boxed::Box;\n+use rc::is_dangling;\n use string::String;\n use vec::Vec;\n \n@@ -1038,12 +1039,6 @@ impl<T> Weak<T> {\n     }\n }\n \n-pub(crate) fn is_dangling<T: ?Sized>(ptr: NonNull<T>) -> bool {\n-    let address = ptr.as_ptr() as *mut () as usize;\n-    let align = align_of_val(unsafe { ptr.as_ref() });\n-    address == align\n-}\n-\n impl<T: ?Sized> Weak<T> {\n     /// Attempts to upgrade the `Weak` pointer to an [`Arc`], extending\n     /// the lifetime of the value if successful."}]}