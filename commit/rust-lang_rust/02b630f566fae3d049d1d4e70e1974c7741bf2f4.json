{"sha": "02b630f566fae3d049d1d4e70e1974c7741bf2f4", "node_id": "C_kwDOAAsO6NoAKDAyYjYzMGY1NjZmYWUzZDA0OWQxZDRlNzBlMTk3NGM3NzQxYmYyZjQ", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2022-05-25T22:32:09Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-05-25T22:32:09Z"}, "message": "Rollup merge of #97317 - GuillaumeGomez:gui-settings-text-click, r=jsha\n\nAllow to click on setting text\n\nYou can test it [here](https://rustdoc.crud.net/imperio/gui-settings-text-click/doc/foo/index.html).\n\nThis PR allows to click on the text alongside the toggle to change it.\n\nr? `@jsha`", "tree": {"sha": "b5f46af257b5bc0dc8a56f8c1d519a18cd8579e0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b5f46af257b5bc0dc8a56f8c1d519a18cd8579e0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/02b630f566fae3d049d1d4e70e1974c7741bf2f4", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJijq5pCRBK7hj4Ov3rIwAAFjAIAIXG5nVctzN7D7K8sh6DnMJx\nEc0kVaLKgLIh2mqgcx6TEWp2shFe6xrq6Ms/0XFqmtV5jiwEcCkT1tSZDp5a9CgT\nsrgwpBxP0RqQxQQbID8dSLrL7m/Pv946NZwbtzoRSAb8hBtRFSM+WGaJ2D7hT2mA\nEiFaMM4CCIca5SpAjWsYKCtHuSgHCtO1MpaGH0oV3pT/5chhrQ/2KBURJl10roZv\nZpaIF8PDNuysRlwFCYW3BR21TY9RkfafTwMIz7fVQ1IIC58BB3/VIq1UtJeCCSmg\nXHXNmRv7mWD5g5mzJsvMloKd5GnI6+aduE7JsJ83h5ZS6EuhUbdYUqpIpz5FcOg=\n=Wa12\n-----END PGP SIGNATURE-----\n", "payload": "tree b5f46af257b5bc0dc8a56f8c1d519a18cd8579e0\nparent 1b5e1215efa47cf4d78a945c7be1c04cda4f57d4\nparent f4f14f66711756e67bbc252b9e14546c771fe508\nauthor Guillaume Gomez <guillaume1.gomez@gmail.com> 1653517929 +0200\ncommitter GitHub <noreply@github.com> 1653517929 +0200\n\nRollup merge of #97317 - GuillaumeGomez:gui-settings-text-click, r=jsha\n\nAllow to click on setting text\n\nYou can test it [here](https://rustdoc.crud.net/imperio/gui-settings-text-click/doc/foo/index.html).\n\nThis PR allows to click on the text alongside the toggle to change it.\n\nr? `@jsha`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/02b630f566fae3d049d1d4e70e1974c7741bf2f4", "html_url": "https://github.com/rust-lang/rust/commit/02b630f566fae3d049d1d4e70e1974c7741bf2f4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/02b630f566fae3d049d1d4e70e1974c7741bf2f4/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1b5e1215efa47cf4d78a945c7be1c04cda4f57d4", "url": "https://api.github.com/repos/rust-lang/rust/commits/1b5e1215efa47cf4d78a945c7be1c04cda4f57d4", "html_url": "https://github.com/rust-lang/rust/commit/1b5e1215efa47cf4d78a945c7be1c04cda4f57d4"}, {"sha": "f4f14f66711756e67bbc252b9e14546c771fe508", "url": "https://api.github.com/repos/rust-lang/rust/commits/f4f14f66711756e67bbc252b9e14546c771fe508", "html_url": "https://github.com/rust-lang/rust/commit/f4f14f66711756e67bbc252b9e14546c771fe508"}], "stats": {"total": 105, "additions": 65, "deletions": 40}, "files": [{"sha": "03834411d1529ea7337b4a2c2a4a34b689d2a54e", "filename": "src/ci/docker/host-x86_64/x86_64-gnu-tools/browser-ui-test.version", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/02b630f566fae3d049d1d4e70e1974c7741bf2f4/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-tools%2Fbrowser-ui-test.version", "raw_url": "https://github.com/rust-lang/rust/raw/02b630f566fae3d049d1d4e70e1974c7741bf2f4/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-tools%2Fbrowser-ui-test.version", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-tools%2Fbrowser-ui-test.version?ref=02b630f566fae3d049d1d4e70e1974c7741bf2f4", "patch": "@@ -1 +1 @@\n-0.9.3\n\\ No newline at end of file\n+0.9.5\n\\ No newline at end of file"}, {"sha": "d0229bdb5f23c5f153fd8d7d76e390138078b171", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 0, "deletions": 24, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/02b630f566fae3d049d1d4e70e1974c7741bf2f4/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/02b630f566fae3d049d1d4e70e1974c7741bf2f4/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=02b630f566fae3d049d1d4e70e1974c7741bf2f4", "patch": "@@ -1415,30 +1415,6 @@ pre.rust {\n #settings-menu.rotate > a img {\n \tanimation: rotating 2s linear infinite;\n }\n-#settings-menu #settings {\n-\tposition: absolute;\n-\tright: 0;\n-\tz-index: 1;\n-\tdisplay: block;\n-\tmargin-top: 7px;\n-\tborder-radius: 3px;\n-\tborder: 1px solid;\n-}\n-#settings-menu #settings .setting-line {\n-\tmargin: 0.6em;\n-}\n-/* This rule is to draw the little arrow connecting the settings menu to the gear icon. */\n-#settings-menu #settings::before {\n-\tcontent: '';\n-\tposition: absolute;\n-\tright: 11px;\n-\tborder: solid;\n-\tborder-width: 1px 1px 0 0;\n-\tdisplay: inline-block;\n-\tpadding: 4px;\n-\ttransform: rotate(-45deg);\n-\ttop: -5px;\n-}\n \n #help-button {\n \tfont-family: \"Fira Sans\", Arial, sans-serif;"}, {"sha": "c69ff04236dcb47c07baf27efa3cae2a031dc5c3", "filename": "src/librustdoc/html/static/css/settings.css", "status": "modified", "additions": 34, "deletions": 6, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/02b630f566fae3d049d1d4e70e1974c7741bf2f4/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fsettings.css", "raw_url": "https://github.com/rust-lang/rust/raw/02b630f566fae3d049d1d4e70e1974c7741bf2f4/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fsettings.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fsettings.css?ref=02b630f566fae3d049d1d4e70e1974c7741bf2f4", "patch": "@@ -46,9 +46,12 @@\n .toggle {\n \tposition: relative;\n \tdisplay: inline-block;\n-\twidth: 45px;\n+\twidth: 100%;\n \theight: 27px;\n \tmargin-right: 20px;\n+\tdisplay: flex;\n+\talign-items: center;\n+\tcursor: pointer;\n }\n \n .toggle input {\n@@ -57,12 +60,12 @@\n }\n \n .slider {\n-\tposition: absolute;\n+\tposition: relative;\n+\twidth: 45px;\n+\tdisplay: block;\n+\theight: 28px;\n+\tmargin-right: 20px;\n \tcursor: pointer;\n-\ttop: 0;\n-\tleft: 0;\n-\tright: 0;\n-\tbottom: 0;\n \tbackground-color: #ccc;\n \ttransition: .3s;\n }\n@@ -95,3 +98,28 @@ input:checked + .slider:before {\n \twidth: 100%;\n \tdisplay: block;\n }\n+\n+div#settings {\n+\tposition: absolute;\n+\tright: 0;\n+\tz-index: 1;\n+\tdisplay: block;\n+\tmargin-top: 7px;\n+\tborder-radius: 3px;\n+\tborder: 1px solid;\n+}\n+#settings .setting-line {\n+\tmargin: 1.2em 0.6em;\n+}\n+/* This rule is to draw the little arrow connecting the settings menu to the gear icon. */\n+div#settings::before {\n+\tcontent: '';\n+\tposition: absolute;\n+\tright: 11px;\n+\tborder: solid;\n+\tborder-width: 1px 1px 0 0;\n+\tdisplay: inline-block;\n+\tpadding: 4px;\n+\ttransform: rotate(-45deg);\n+\ttop: -5px;\n+}"}, {"sha": "6746783717fbe71c93476e4e03fe6e3530d9af3c", "filename": "src/librustdoc/html/static/js/settings.js", "status": "modified", "additions": 5, "deletions": 6, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/02b630f566fae3d049d1d4e70e1974c7741bf2f4/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js", "raw_url": "https://github.com/rust-lang/rust/raw/02b630f566fae3d049d1d4e70e1974c7741bf2f4/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js?ref=02b630f566fae3d049d1d4e70e1974c7741bf2f4", "patch": "@@ -130,12 +130,11 @@\n             } else {\n                 // This is a toggle.\n                 const checked = setting[\"default\"] === true ? \" checked\" : \"\";\n-                output += `\n-                    <label class=\"toggle\">\n-                        <input type=\"checkbox\" id=\"${js_data_name}\"${checked}>\n-                        <span class=\"slider\"></span>\n-                    </label>\n-                    <div>${setting_name}</div>`;\n+                output += `<label class=\"toggle\">\\\n+                        <input type=\"checkbox\" id=\"${js_data_name}\"${checked}>\\\n+                        <span class=\"slider\"></span>\\\n+                        <span class=\"label\">${setting_name}</span>\\\n+                    </label>`;\n             }\n             output += \"</div>\";\n         }"}, {"sha": "1b2d1e31f520cf2642dfa56d457c914cad2064df", "filename": "src/test/rustdoc-gui/settings.goml", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/02b630f566fae3d049d1d4e70e1974c7741bf2f4/src%2Ftest%2Frustdoc-gui%2Fsettings.goml", "raw_url": "https://github.com/rust-lang/rust/raw/02b630f566fae3d049d1d4e70e1974c7741bf2f4/src%2Ftest%2Frustdoc-gui%2Fsettings.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsettings.goml?ref=02b630f566fae3d049d1d4e70e1974c7741bf2f4", "patch": "@@ -34,7 +34,7 @@ wait-for: \"#settings\"\n \n // We check that the \"Use system theme\" is disabled.\n assert-property: (\"#use-system-theme\", {\"checked\": \"false\"})\n-assert: \"//*[@class='setting-line']/*[text()='Use system theme']\"\n+assert: \"//*[@class='setting-line']//span[text()='Use system theme']\"\n // Meaning that only the \"theme\" menu is showing up.\n assert: \".setting-line:not(.hidden) #theme\"\n assert: \".setting-line.hidden #preferred-dark-theme\"\n@@ -55,7 +55,13 @@ assert: \".setting-line.hidden #theme\"\n assert-text: (\"#preferred-dark-theme .setting-name\", \"Preferred dark theme\")\n assert-text: (\"#preferred-light-theme .setting-name\", \"Preferred light theme\")\n \n+// We now check that clicking on the \"sliders\"' text is like clicking on the slider.\n+// To test it, we use the \"Disable keyboard shortcuts\".\n+local-storage: {\"rustdoc-disable-shortcuts\": \"false\"}\n+click: \".setting-line:last-child .toggle .label\"\n+assert-local-storage: {\"rustdoc-disable-shortcuts\": \"true\"}\n+\n // Now we go to the settings page to check that the CSS is loaded as expected.\n goto: file://|DOC_PATH|/settings.html\n wait-for: \"#settings\"\n-assert-css: (\".setting-line .toggle\", {\"width\": \"45px\", \"margin-right\": \"20px\"})\n+assert-css: (\".setting-line .toggle .slider\", {\"width\": \"45px\", \"margin-right\": \"20px\"})"}, {"sha": "4599e12de5f334391f2c76b4e638cc74830468f5", "filename": "src/tools/rustdoc-gui/tester.js", "status": "modified", "additions": 17, "deletions": 1, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/02b630f566fae3d049d1d4e70e1974c7741bf2f4/src%2Ftools%2Frustdoc-gui%2Ftester.js", "raw_url": "https://github.com/rust-lang/rust/raw/02b630f566fae3d049d1d4e70e1974c7741bf2f4/src%2Ftools%2Frustdoc-gui%2Ftester.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustdoc-gui%2Ftester.js?ref=02b630f566fae3d049d1d4e70e1974c7741bf2f4", "patch": "@@ -19,6 +19,7 @@ function showHelp() {\n     console.log(\"  --help                     : show this message then quit\");\n     console.log(\"  --tests-folder [PATH]      : location of the .GOML tests folder\");\n     console.log(\"  --jobs [NUMBER]            : number of threads to run tests on\");\n+    console.log(\"  --executable-path [PATH]   : path of the browser's executable to be used\");\n }\n \n function isNumeric(s) {\n@@ -34,20 +35,25 @@ function parseOptions(args) {\n         \"show_text\": false,\n         \"no_headless\": false,\n         \"jobs\": -1,\n+        \"executable_path\": null,\n+        \"no_sandbox\": false,\n     };\n     var correspondances = {\n         \"--doc-folder\": \"doc_folder\",\n         \"--tests-folder\": \"tests_folder\",\n         \"--debug\": \"debug\",\n         \"--show-text\": \"show_text\",\n         \"--no-headless\": \"no_headless\",\n+        \"--executable-path\": \"executable_path\",\n+        \"--no-sandbox\": \"no_sandbox\",\n     };\n \n     for (var i = 0; i < args.length; ++i) {\n         if (args[i] === \"--doc-folder\"\n             || args[i] === \"--tests-folder\"\n             || args[i] === \"--file\"\n-            || args[i] === \"--jobs\") {\n+            || args[i] === \"--jobs\"\n+            || args[i] === \"--executable-path\") {\n             i += 1;\n             if (i >= args.length) {\n                 console.log(\"Missing argument after `\" + args[i - 1] + \"` option.\");\n@@ -68,6 +74,9 @@ function parseOptions(args) {\n         } else if (args[i] === \"--help\") {\n             showHelp();\n             process.exit(0);\n+        } else if (args[i] === \"--no-sandbox\") {\n+            console.log(\"`--no-sandbox` is being used. Be very careful!\");\n+            opts[correspondances[args[i]]] = true;\n         } else if (correspondances[args[i]]) {\n             opts[correspondances[args[i]]] = true;\n         } else {\n@@ -147,10 +156,17 @@ async function main(argv) {\n         if (opts[\"show_text\"]) {\n             args.push(\"--show-text\");\n         }\n+        if (opts[\"no_sandbox\"]) {\n+            args.push(\"--no-sandbox\");\n+        }\n         if (opts[\"no_headless\"]) {\n             args.push(\"--no-headless\");\n             headless = false;\n         }\n+        if (opts[\"executable_path\"] !== null) {\n+            args.push(\"--executable-path\");\n+            args.push(opts[\"executable_path\"]);\n+        }\n         options.parseArguments(args);\n     } catch (error) {\n         console.error(`invalid argument: ${error}`);"}]}