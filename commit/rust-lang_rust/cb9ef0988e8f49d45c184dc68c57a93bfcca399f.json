{"sha": "cb9ef0988e8f49d45c184dc68c57a93bfcca399f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNiOWVmMDk4OGU4ZjQ5ZDQ1YzE4NGRjNjhjNTdhOTNiZmNjYTM5OWY=", "commit": {"author": {"name": "Dylan DPC", "email": "dylan.dpc@gmail.com", "date": "2020-08-22T00:14:54Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-08-22T00:14:54Z"}, "message": "Rollup merge of #75781 - Amanieu:asm-fix, r=nagisa\n\nMore inline asm register name fixups for LLVM\n\nFixes #75761\n\nr? @nagisa", "tree": {"sha": "5179cc3079e345484d3cd7b8422e8f123a65e705", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5179cc3079e345484d3cd7b8422e8f123a65e705"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cb9ef0988e8f49d45c184dc68c57a93bfcca399f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfQGN+CRBK7hj4Ov3rIwAAdHIIAHf3ZdZzJpnGC24FQVxe/Fq1\n8nWTxWRy/NOHLanIFMCj2zllUd1+8X/dWs+m86e/s0UQEK3hV/pEQQmB0YwEylUM\n8jUEJ+TbqjgD1cAe5Oo4bZxJC1Lod74LjbnL875f/sCi6n7zDSXlVa/nsSS6p9QU\nM1G/CYpFWaPrmAx3MWbK1H/fAWtv3Vfq/ZsdK6zoF08vBvfHacToIMcWCsrzzz7Q\nf5j+nAb9g0sUAhpMv41CJwLGyF8/pkF9iarr11qDOFiPaDuJMjBe5dlnEhCxXHEi\n3dnws5dxd4BFfzNKTgDyNTKY2ICNlLdj/cMFh8lCYDy3JHcbJC1doLErdYHDsH8=\n=06fr\n-----END PGP SIGNATURE-----\n", "payload": "tree 5179cc3079e345484d3cd7b8422e8f123a65e705\nparent d8262297ad5b9a69f17ba026d7041e50233d1bc1\nparent 4fe4c3b7e3668c525bec91be33a29852b2c68a4d\nauthor Dylan DPC <dylan.dpc@gmail.com> 1598055294 +0200\ncommitter GitHub <noreply@github.com> 1598055294 +0200\n\nRollup merge of #75781 - Amanieu:asm-fix, r=nagisa\n\nMore inline asm register name fixups for LLVM\n\nFixes #75761\n\nr? @nagisa\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cb9ef0988e8f49d45c184dc68c57a93bfcca399f", "html_url": "https://github.com/rust-lang/rust/commit/cb9ef0988e8f49d45c184dc68c57a93bfcca399f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cb9ef0988e8f49d45c184dc68c57a93bfcca399f/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d8262297ad5b9a69f17ba026d7041e50233d1bc1", "url": "https://api.github.com/repos/rust-lang/rust/commits/d8262297ad5b9a69f17ba026d7041e50233d1bc1", "html_url": "https://github.com/rust-lang/rust/commit/d8262297ad5b9a69f17ba026d7041e50233d1bc1"}, {"sha": "4fe4c3b7e3668c525bec91be33a29852b2c68a4d", "url": "https://api.github.com/repos/rust-lang/rust/commits/4fe4c3b7e3668c525bec91be33a29852b2c68a4d", "html_url": "https://github.com/rust-lang/rust/commit/4fe4c3b7e3668c525bec91be33a29852b2c68a4d"}], "stats": {"total": 12, "additions": 10, "deletions": 2}, "files": [{"sha": "4fef94dde5f7a3f41dc60a31cceff88262bd3172", "filename": "src/librustc_codegen_llvm/asm.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/cb9ef0988e8f49d45c184dc68c57a93bfcca399f/src%2Flibrustc_codegen_llvm%2Fasm.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cb9ef0988e8f49d45c184dc68c57a93bfcca399f/src%2Flibrustc_codegen_llvm%2Fasm.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Fasm.rs?ref=cb9ef0988e8f49d45c184dc68c57a93bfcca399f", "patch": "@@ -479,10 +479,13 @@ fn reg_to_llvm(reg: InlineAsmRegOrRegClass, layout: Option<&TyAndLayout<'tcx>>)\n                         _ => unreachable!(),\n                     }\n                 } else {\n-                    // We use i32 as the type for discarded outputs\n-                    's'\n+                    // We use i64x2 as the type for discarded outputs\n+                    'q'\n                 };\n                 format!(\"{{{}{}}}\", class, idx)\n+            } else if reg == InlineAsmReg::AArch64(AArch64InlineAsmReg::x30) {\n+                // LLVM doesn't recognize x30\n+                \"lr\".to_string()\n             } else {\n                 format!(\"{{{}}}\", reg.name())\n             }"}, {"sha": "e39f74c916c4ad4a7a233a10c701b2ba1ec39621", "filename": "src/test/assembly/asm/aarch64-types.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/cb9ef0988e8f49d45c184dc68c57a93bfcca399f/src%2Ftest%2Fassembly%2Fasm%2Faarch64-types.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cb9ef0988e8f49d45c184dc68c57a93bfcca399f/src%2Ftest%2Fassembly%2Fasm%2Faarch64-types.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fassembly%2Fasm%2Faarch64-types.rs?ref=cb9ef0988e8f49d45c184dc68c57a93bfcca399f", "patch": "@@ -553,3 +553,8 @@ check_reg!(v0_f32x4 f32x4 \"s0\" \"fmov\");\n // CHECK: fmov s0, s0\n // CHECK: //NO_APP\n check_reg!(v0_f64x2 f64x2 \"s0\" \"fmov\");\n+\n+// Regression test for #75761\n+pub unsafe fn issue_75761() {\n+    asm!(\"\", out(\"v0\") _, out(\"x30\") _);\n+}"}]}