{"sha": "cd35e251ea086e8637562323acfe65216b2c8051", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNkMzVlMjUxZWEwODZlODYzNzU2MjMyM2FjZmU2NTIxNmIyYzgwNTE=", "commit": {"author": {"name": "Roxane", "email": "roxane.fruytier@hotmail.com", "date": "2021-08-24T02:41:19Z"}, "committer": {"name": "Roxane", "email": "roxane.fruytier@hotmail.com", "date": "2021-08-28T23:29:46Z"}, "message": "Add additional match test case", "tree": {"sha": "cf203085b8a8d3346836be2bc5f920042116a069", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cf203085b8a8d3346836be2bc5f920042116a069"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cd35e251ea086e8637562323acfe65216b2c8051", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cd35e251ea086e8637562323acfe65216b2c8051", "html_url": "https://github.com/rust-lang/rust/commit/cd35e251ea086e8637562323acfe65216b2c8051", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cd35e251ea086e8637562323acfe65216b2c8051/comments", "author": {"login": "roxelo", "id": 12419401, "node_id": "MDQ6VXNlcjEyNDE5NDAx", "avatar_url": "https://avatars.githubusercontent.com/u/12419401?v=4", "gravatar_id": "", "url": "https://api.github.com/users/roxelo", "html_url": "https://github.com/roxelo", "followers_url": "https://api.github.com/users/roxelo/followers", "following_url": "https://api.github.com/users/roxelo/following{/other_user}", "gists_url": "https://api.github.com/users/roxelo/gists{/gist_id}", "starred_url": "https://api.github.com/users/roxelo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/roxelo/subscriptions", "organizations_url": "https://api.github.com/users/roxelo/orgs", "repos_url": "https://api.github.com/users/roxelo/repos", "events_url": "https://api.github.com/users/roxelo/events{/privacy}", "received_events_url": "https://api.github.com/users/roxelo/received_events", "type": "User", "site_admin": false}, "committer": {"login": "roxelo", "id": 12419401, "node_id": "MDQ6VXNlcjEyNDE5NDAx", "avatar_url": "https://avatars.githubusercontent.com/u/12419401?v=4", "gravatar_id": "", "url": "https://api.github.com/users/roxelo", "html_url": "https://github.com/roxelo", "followers_url": "https://api.github.com/users/roxelo/followers", "following_url": "https://api.github.com/users/roxelo/following{/other_user}", "gists_url": "https://api.github.com/users/roxelo/gists{/gist_id}", "starred_url": "https://api.github.com/users/roxelo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/roxelo/subscriptions", "organizations_url": "https://api.github.com/users/roxelo/orgs", "repos_url": "https://api.github.com/users/roxelo/repos", "events_url": "https://api.github.com/users/roxelo/events{/privacy}", "received_events_url": "https://api.github.com/users/roxelo/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "20de556a26dd1fb10a3cbaf9bc02c27015edb406", "url": "https://api.github.com/repos/rust-lang/rust/commits/20de556a26dd1fb10a3cbaf9bc02c27015edb406", "html_url": "https://github.com/rust-lang/rust/commit/20de556a26dd1fb10a3cbaf9bc02c27015edb406"}], "stats": {"total": 51, "additions": 51, "deletions": 0}, "files": [{"sha": "f5330b07445a2d4b24c30325604e7dcad24aa257", "filename": "src/test/ui/closures/2229_closure_analysis/match-edge-cases.rs", "status": "modified", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/cd35e251ea086e8637562323acfe65216b2c8051/src%2Ftest%2Fui%2Fclosures%2F2229_closure_analysis%2Fmatch-edge-cases.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cd35e251ea086e8637562323acfe65216b2c8051/src%2Ftest%2Fui%2Fclosures%2F2229_closure_analysis%2Fmatch-edge-cases.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fclosures%2F2229_closure_analysis%2Fmatch-edge-cases.rs?ref=cd35e251ea086e8637562323acfe65216b2c8051", "patch": "@@ -41,4 +41,38 @@ pub fn edge_case_char(event: char) {\n     };\n }\n \n+enum SingleVariant {\n+    A\n+}\n+\n+struct TestStruct {\n+    x: i32,\n+    y: i32,\n+    z: i32,\n+}\n+\n+fn edge_case_if() {\n+    let sv = SingleVariant::A;\n+    let condition = true;\n+    // sv should not be captured as it is a SingleVariant\n+    let _a = || {\n+        match sv {\n+            SingleVariant::A if condition => (),\n+            _ => ()\n+        }\n+    };\n+    let mut mut_sv = sv;\n+    _a();\n+\n+    // ts should be captured\n+    let ts = TestStruct { x: 1, y: 1, z: 1 };\n+    let _b = || { match ts {\n+        TestStruct{ x: 1, .. } => (),\n+        _ => ()\n+    }};\n+    let mut mut_ts = ts;\n+    //~^ ERROR: cannot move out of `ts` because it is borrowed\n+    _b();\n+}\n+\n fn main() {}"}, {"sha": "b9d2316206ecbb8908626560eb2c040eece53d13", "filename": "src/test/ui/closures/2229_closure_analysis/match-edge-cases.stderr", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/cd35e251ea086e8637562323acfe65216b2c8051/src%2Ftest%2Fui%2Fclosures%2F2229_closure_analysis%2Fmatch-edge-cases.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cd35e251ea086e8637562323acfe65216b2c8051/src%2Ftest%2Fui%2Fclosures%2F2229_closure_analysis%2Fmatch-edge-cases.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fclosures%2F2229_closure_analysis%2Fmatch-edge-cases.stderr?ref=cd35e251ea086e8637562323acfe65216b2c8051", "patch": "@@ -0,0 +1,17 @@\n+error[E0505]: cannot move out of `ts` because it is borrowed\n+  --> $DIR/match-edge-cases.rs:32:22\n+   |\n+LL |     let _b = || { match ts {\n+   |              --         -- borrow occurs due to use in closure\n+   |              |\n+   |              borrow of `ts` occurs here\n+...\n+LL |     let mut mut_ts = ts;\n+   |                      ^^ move out of `ts` occurs here\n+LL |\n+LL |     _b();\n+   |     -- borrow later used here\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0505`."}]}