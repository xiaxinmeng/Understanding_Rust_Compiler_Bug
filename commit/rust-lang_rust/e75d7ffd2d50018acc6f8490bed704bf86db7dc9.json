{"sha": "e75d7ffd2d50018acc6f8490bed704bf86db7dc9", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU3NWQ3ZmZkMmQ1MDAxOGFjYzZmODQ5MGJlZDcwNGJmODZkYjdkYzk=", "commit": {"author": {"name": "Andre Bogus", "email": "bogusandre@gmail.com", "date": "2017-05-15T20:49:20Z"}, "committer": {"name": "Andre Bogus", "email": "bogusandre@gmail.com", "date": "2017-05-15T20:49:20Z"}, "message": "distinguish debug_assert", "tree": {"sha": "408108b6fa28900a9bccb04e3f757b638a73de3a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/408108b6fa28900a9bccb04e3f757b638a73de3a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e75d7ffd2d50018acc6f8490bed704bf86db7dc9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e75d7ffd2d50018acc6f8490bed704bf86db7dc9", "html_url": "https://github.com/rust-lang/rust/commit/e75d7ffd2d50018acc6f8490bed704bf86db7dc9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e75d7ffd2d50018acc6f8490bed704bf86db7dc9/comments", "author": {"login": "llogiq", "id": 4200835, "node_id": "MDQ6VXNlcjQyMDA4MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4200835?v=4", "gravatar_id": "", "url": "https://api.github.com/users/llogiq", "html_url": "https://github.com/llogiq", "followers_url": "https://api.github.com/users/llogiq/followers", "following_url": "https://api.github.com/users/llogiq/following{/other_user}", "gists_url": "https://api.github.com/users/llogiq/gists{/gist_id}", "starred_url": "https://api.github.com/users/llogiq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/llogiq/subscriptions", "organizations_url": "https://api.github.com/users/llogiq/orgs", "repos_url": "https://api.github.com/users/llogiq/repos", "events_url": "https://api.github.com/users/llogiq/events{/privacy}", "received_events_url": "https://api.github.com/users/llogiq/received_events", "type": "User", "site_admin": false}, "committer": {"login": "llogiq", "id": 4200835, "node_id": "MDQ6VXNlcjQyMDA4MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4200835?v=4", "gravatar_id": "", "url": "https://api.github.com/users/llogiq", "html_url": "https://github.com/llogiq", "followers_url": "https://api.github.com/users/llogiq/followers", "following_url": "https://api.github.com/users/llogiq/following{/other_user}", "gists_url": "https://api.github.com/users/llogiq/gists{/gist_id}", "starred_url": "https://api.github.com/users/llogiq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/llogiq/subscriptions", "organizations_url": "https://api.github.com/users/llogiq/orgs", "repos_url": "https://api.github.com/users/llogiq/repos", "events_url": "https://api.github.com/users/llogiq/events{/privacy}", "received_events_url": "https://api.github.com/users/llogiq/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fe85cde91cf5bc4c6e6f4a7fc2b4b758e40d335a", "url": "https://api.github.com/repos/rust-lang/rust/commits/fe85cde91cf5bc4c6e6f4a7fc2b4b758e40d335a", "html_url": "https://github.com/rust-lang/rust/commit/fe85cde91cf5bc4c6e6f4a7fc2b4b758e40d335a"}], "stats": {"total": 34, "additions": 27, "deletions": 7}, "files": [{"sha": "93baab8634725abd2d106c012d5a13db4d96682e", "filename": "clippy_lints/src/should_assert_eq.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e75d7ffd2d50018acc6f8490bed704bf86db7dc9/clippy_lints%2Fsrc%2Fshould_assert_eq.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e75d7ffd2d50018acc6f8490bed704bf86db7dc9/clippy_lints%2Fsrc%2Fshould_assert_eq.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fshould_assert_eq.rs?ref=e75d7ffd2d50018acc6f8490bed704bf86db7dc9", "patch": "@@ -1,6 +1,6 @@\n use rustc::lint::*;\n use rustc::hir::*;\n-use utils::{is_direct_expn_of, implements_trait, span_lint};\n+use utils::{is_direct_expn_of, is_expn_of, implements_trait, span_lint};\n \n /// **What it does:** Checks for `assert!(x == y)` or `assert!(x != y)` which can be better written\n /// using `assert_eq` or `assert_ne` if `x` and `y` implement `Debug` trait.\n@@ -39,6 +39,7 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for ShouldAssertEq {\n             is_direct_expn_of(e.span, \"assert\").is_some(),\n             let Some(debug_trait) = cx.tcx.lang_items.debug_trait(),\n         ], {\n+            let debug = is_expn_of(e.span, \"debug_assert\").map_or(\"\", |_| \"debug_\");\n             let sugg = match binop.node {\n                 BinOp_::BiEq => \"assert_eq\",\n                 BinOp_::BiNe => \"assert_ne\",\n@@ -52,7 +53,7 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for ShouldAssertEq {\n \n             if implements_trait(cx, ty1, debug_trait, &[], Some(parent)) &&\n                 implements_trait(cx, ty2, debug_trait, &[], Some(parent)) {\n-                span_lint(cx, SHOULD_ASSERT_EQ, e.span, &format!(\"use `{}` for better reporting\", sugg));\n+                span_lint(cx, SHOULD_ASSERT_EQ, e.span, &format!(\"use `{}{}` for better reporting\", debug, sugg));\n             }\n         }}\n     }"}, {"sha": "a5d11d907f8113016330754452050c1d3c58776c", "filename": "tests/ui/should_assert_eq.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/e75d7ffd2d50018acc6f8490bed704bf86db7dc9/tests%2Fui%2Fshould_assert_eq.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e75d7ffd2d50018acc6f8490bed704bf86db7dc9/tests%2Fui%2Fshould_assert_eq.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fshould_assert_eq.rs?ref=e75d7ffd2d50018acc6f8490bed704bf86db7dc9", "patch": "@@ -18,6 +18,9 @@ fn main() {\n     assert!(NonDebug(1) != NonDebug(2)); // ok\n \n     test_generic(1, 2, 3, 4);\n+\n+    debug_assert!(4 == 5);\n+    debug_assert!(4 != 6);\n }\n \n fn test_generic<T: std::fmt::Debug + Eq, U: Eq>(x: T, y: T, z: U, w: U) {"}, {"sha": "3e5013fd3d8a0fb5a6922dacc906ef4cae2cac2f", "filename": "tests/ui/should_assert_eq.stderr", "status": "modified", "additions": 21, "deletions": 5, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/e75d7ffd2d50018acc6f8490bed704bf86db7dc9/tests%2Fui%2Fshould_assert_eq.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e75d7ffd2d50018acc6f8490bed704bf86db7dc9/tests%2Fui%2Fshould_assert_eq.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fshould_assert_eq.stderr?ref=e75d7ffd2d50018acc6f8490bed704bf86db7dc9", "patch": "@@ -27,21 +27,37 @@ error: use `assert_ne` for better reporting\n    |\n    = note: this error originates in a macro outside of the current crate\n \n+error: use `debug_assert_eq` for better reporting\n+  --> $DIR/should_assert_eq.rs:22:5\n+   |\n+22 |     debug_assert!(4 == 5);\n+   |     ^^^^^^^^^^^^^^^^^^^^^^\n+   |\n+   = note: this error originates in a macro outside of the current crate\n+\n+error: use `debug_assert_ne` for better reporting\n+  --> $DIR/should_assert_eq.rs:23:5\n+   |\n+23 |     debug_assert!(4 != 6);\n+   |     ^^^^^^^^^^^^^^^^^^^^^^\n+   |\n+   = note: this error originates in a macro outside of the current crate\n+\n error: use `assert_eq` for better reporting\n-  --> $DIR/should_assert_eq.rs:24:5\n+  --> $DIR/should_assert_eq.rs:27:5\n    |\n-24 |     assert!(x == y);\n+27 |     assert!(x == y);\n    |     ^^^^^^^^^^^^^^^^\n    |\n    = note: this error originates in a macro outside of the current crate\n \n error: use `assert_ne` for better reporting\n-  --> $DIR/should_assert_eq.rs:27:5\n+  --> $DIR/should_assert_eq.rs:30:5\n    |\n-27 |     assert!(x != y);\n+30 |     assert!(x != y);\n    |     ^^^^^^^^^^^^^^^^\n    |\n    = note: this error originates in a macro outside of the current crate\n \n-error: aborting due to 5 previous errors\n+error: aborting due to 7 previous errors\n "}]}