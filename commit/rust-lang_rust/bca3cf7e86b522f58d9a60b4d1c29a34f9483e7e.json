{"sha": "bca3cf7e86b522f58d9a60b4d1c29a34f9483e7e", "node_id": "C_kwDOAAsO6NoAKGJjYTNjZjdlODZiNTIyZjU4ZDlhNjBiNGQxYzI5YTM0Zjk0ODNlN2U", "commit": {"author": {"name": "est31", "email": "MTest31@outlook.com", "date": "2022-08-30T12:46:35Z"}, "committer": {"name": "est31", "email": "MTest31@outlook.com", "date": "2022-09-15T19:06:45Z"}, "message": "Stabilize the let_else feature", "tree": {"sha": "a7c1ad5585f5311b225e2f5d943d243c0a942c56", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a7c1ad5585f5311b225e2f5d943d243c0a942c56"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bca3cf7e86b522f58d9a60b4d1c29a34f9483e7e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bca3cf7e86b522f58d9a60b4d1c29a34f9483e7e", "html_url": "https://github.com/rust-lang/rust/commit/bca3cf7e86b522f58d9a60b4d1c29a34f9483e7e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bca3cf7e86b522f58d9a60b4d1c29a34f9483e7e/comments", "author": {"login": "est31", "id": 8872119, "node_id": "MDQ6VXNlcjg4NzIxMTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/est31", "html_url": "https://github.com/est31", "followers_url": "https://api.github.com/users/est31/followers", "following_url": "https://api.github.com/users/est31/following{/other_user}", "gists_url": "https://api.github.com/users/est31/gists{/gist_id}", "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/est31/subscriptions", "organizations_url": "https://api.github.com/users/est31/orgs", "repos_url": "https://api.github.com/users/est31/repos", "events_url": "https://api.github.com/users/est31/events{/privacy}", "received_events_url": "https://api.github.com/users/est31/received_events", "type": "User", "site_admin": false}, "committer": {"login": "est31", "id": 8872119, "node_id": "MDQ6VXNlcjg4NzIxMTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/est31", "html_url": "https://github.com/est31", "followers_url": "https://api.github.com/users/est31/followers", "following_url": "https://api.github.com/users/est31/following{/other_user}", "gists_url": "https://api.github.com/users/est31/gists{/gist_id}", "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/est31/subscriptions", "organizations_url": "https://api.github.com/users/est31/orgs", "repos_url": "https://api.github.com/users/est31/repos", "events_url": "https://api.github.com/users/est31/events{/privacy}", "received_events_url": "https://api.github.com/users/est31/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "35a0407814a6b5a04f0929105631e9c69e293e9d", "url": "https://api.github.com/repos/rust-lang/rust/commits/35a0407814a6b5a04f0929105631e9c69e293e9d", "html_url": "https://github.com/rust-lang/rust/commit/35a0407814a6b5a04f0929105631e9c69e293e9d"}], "stats": {"total": 42, "additions": 10, "deletions": 32}, "files": [{"sha": "8c4878f129c9e4fe22022a5191fa17576414336c", "filename": "compiler/rustc_ast_lowering/src/block.rs", "status": "modified", "additions": 0, "deletions": 11, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/bca3cf7e86b522f58d9a60b4d1c29a34f9483e7e/compiler%2Frustc_ast_lowering%2Fsrc%2Fblock.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bca3cf7e86b522f58d9a60b4d1c29a34f9483e7e/compiler%2Frustc_ast_lowering%2Fsrc%2Fblock.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Fblock.rs?ref=bca3cf7e86b522f58d9a60b4d1c29a34f9483e7e", "patch": "@@ -1,8 +1,6 @@\n use crate::{ImplTraitContext, ImplTraitPosition, LoweringContext};\n use rustc_ast::{Block, BlockCheckMode, Local, LocalKind, Stmt, StmtKind};\n use rustc_hir as hir;\n-use rustc_session::parse::feature_err;\n-use rustc_span::sym;\n \n use smallvec::SmallVec;\n \n@@ -91,15 +89,6 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         let hir_id = self.lower_node_id(l.id);\n         let pat = self.lower_pat(&l.pat);\n         let els = if let LocalKind::InitElse(_, els) = &l.kind {\n-            if !self.tcx.features().let_else {\n-                feature_err(\n-                    &self.tcx.sess.parse_sess,\n-                    sym::let_else,\n-                    l.span,\n-                    \"`let...else` statements are unstable\",\n-                )\n-                .emit();\n-            }\n             Some(self.lower_block(els, false))\n         } else {\n             None"}, {"sha": "5f7de94e726573ebf9062afc11ffc1b035dc2042", "filename": "compiler/rustc_feature/src/accepted.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/bca3cf7e86b522f58d9a60b4d1c29a34f9483e7e/compiler%2Frustc_feature%2Fsrc%2Faccepted.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bca3cf7e86b522f58d9a60b4d1c29a34f9483e7e/compiler%2Frustc_feature%2Fsrc%2Faccepted.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_feature%2Fsrc%2Faccepted.rs?ref=bca3cf7e86b522f58d9a60b4d1c29a34f9483e7e", "patch": "@@ -190,6 +190,8 @@ declare_features! (\n     (accepted, item_like_imports, \"1.15.0\", Some(35120), None),\n     /// Allows `'a: { break 'a; }`.\n     (accepted, label_break_value, \"CURRENT_RUSTC_VERSION\", Some(48594), None),\n+    /// Allows `let...else` statements.\n+    (accepted, let_else, \"CURRENT_RUSTC_VERSION\", Some(87335), None),\n     /// Allows `break {expr}` with a value inside `loop`s.\n     (accepted, loop_break_value, \"1.19.0\", Some(37339), None),\n     /// Allows use of `?` as the Kleene \"at most one\" operator in macros."}, {"sha": "ad28595ca82b3a390d87169fe577279488a5f129", "filename": "compiler/rustc_feature/src/active.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/bca3cf7e86b522f58d9a60b4d1c29a34f9483e7e/compiler%2Frustc_feature%2Fsrc%2Factive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bca3cf7e86b522f58d9a60b4d1c29a34f9483e7e/compiler%2Frustc_feature%2Fsrc%2Factive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_feature%2Fsrc%2Factive.rs?ref=bca3cf7e86b522f58d9a60b4d1c29a34f9483e7e", "patch": "@@ -430,8 +430,6 @@ declare_features! (\n     (active, large_assignments, \"1.52.0\", Some(83518), None),\n     /// Allows `if/while p && let q = r && ...` chains.\n     (active, let_chains, \"1.37.0\", Some(53667), None),\n-    /// Allows `let...else` statements.\n-    (active, let_else, \"1.56.0\", Some(87335), None),\n     /// Allows `#[link(..., cfg(..))]`.\n     (active, link_cfg, \"1.14.0\", Some(37406), None),\n     /// Allows using `reason` in lint attributes and the `#[expect(lint)]` lint check."}, {"sha": "3f04a9dabfd1f743046b2a87c69b558919743863", "filename": "src/test/ui/feature-gates/feature-gate-let_else.rs", "status": "removed", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/35a0407814a6b5a04f0929105631e9c69e293e9d/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-let_else.rs", "raw_url": "https://github.com/rust-lang/rust/raw/35a0407814a6b5a04f0929105631e9c69e293e9d/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-let_else.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-let_else.rs?ref=35a0407814a6b5a04f0929105631e9c69e293e9d", "patch": "@@ -1,5 +0,0 @@\n-fn main() {\n-    let Some(x) = Some(1) else { //~ ERROR `let...else` statements are unstable\n-        return;\n-    };\n-}"}, {"sha": "8625260415467f23b3fdc983391bb6c791764a33", "filename": "src/test/ui/feature-gates/feature-gate-let_else.stderr", "status": "removed", "additions": 0, "deletions": 14, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/35a0407814a6b5a04f0929105631e9c69e293e9d/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-let_else.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/35a0407814a6b5a04f0929105631e9c69e293e9d/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-let_else.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-let_else.stderr?ref=35a0407814a6b5a04f0929105631e9c69e293e9d", "patch": "@@ -1,14 +0,0 @@\n-error[E0658]: `let...else` statements are unstable\n-  --> $DIR/feature-gate-let_else.rs:2:5\n-   |\n-LL | /     let Some(x) = Some(1) else {\n-LL | |         return;\n-LL | |     };\n-   | |______^\n-   |\n-   = note: see issue #87335 <https://github.com/rust-lang/rust/issues/87335> for more information\n-   = help: add `#![feature(let_else)]` to the crate attributes to enable\n-\n-error: aborting due to previous error\n-\n-For more information about this error, try `rustc --explain E0658`."}, {"sha": "3505533e63f14736fbc85b587524803e78806b84", "filename": "src/test/ui/let-else/let-else.rs", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/bca3cf7e86b522f58d9a60b4d1c29a34f9483e7e/src%2Ftest%2Fui%2Flet-else%2Flet-else.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bca3cf7e86b522f58d9a60b4d1c29a34f9483e7e/src%2Ftest%2Fui%2Flet-else%2Flet-else.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flet-else%2Flet-else.rs?ref=bca3cf7e86b522f58d9a60b4d1c29a34f9483e7e", "patch": "@@ -0,0 +1,8 @@\n+// run-pass\n+\n+fn main() {\n+    let Some(x) = Some(1) else {\n+        return;\n+    };\n+    assert_eq!(x, 1);\n+}"}]}