{"sha": "103816d704133fc954344d551af04cb333b03e94", "node_id": "C_kwDOAAsO6NoAKDEwMzgxNmQ3MDQxMzNmYzk1NDM0NGQ1NTFhZjA0Y2IzMzNiMDNlOTQ", "commit": {"author": {"name": "Joshua Nelson", "email": "github@jyn.dev", "date": "2022-12-22T19:21:48Z"}, "committer": {"name": "Joshua Nelson", "email": "github@jyn.dev", "date": "2022-12-22T19:23:56Z"}, "message": "Avoid running the `Profile` step twice on `x setup`\n\nPrevents runs like the following:\n```\n$ x setup\nWelcome to the Rust project! What do you want to do with x.py?\na) library: Contribute to the standard library\nb) compiler: Contribute to the compiler itself\nc) codegen: Contribute to the compiler, and also modify LLVM or codegen\nd) tools: Contribute to tools which depend on the compiler, but do not modify it directly (e.g. rustdoc, clippy, miri)\ne) user: Install Rust from source\nPlease choose one (a/b/c/d/e): b\n\nTo get started, try one of the following commands:\n- `x.py check`\n- `x.py build`\n- `x.py test`\nFor more suggestions, see https://rustc-dev-guide.rust-lang.org/building/suggested.html\n`x.py` will now use the configuration at /home/nilsh/projects/rustfast/src/bootstrap/defaults/config.compiler.toml\nWelcome to the Rust project! What do you want to do with x.py?\n...\n```", "tree": {"sha": "e3f0fe121c7942321cca565912dcfa145bf33297", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e3f0fe121c7942321cca565912dcfa145bf33297"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/103816d704133fc954344d551af04cb333b03e94", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/103816d704133fc954344d551af04cb333b03e94", "html_url": "https://github.com/rust-lang/rust/commit/103816d704133fc954344d551af04cb333b03e94", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/103816d704133fc954344d551af04cb333b03e94/comments", "author": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e5e4eef02d443eae5089a330e59a69a4f350db81", "url": "https://api.github.com/repos/rust-lang/rust/commits/e5e4eef02d443eae5089a330e59a69a4f350db81", "html_url": "https://github.com/rust-lang/rust/commit/e5e4eef02d443eae5089a330e59a69a4f350db81"}], "stats": {"total": 4, "additions": 4, "deletions": 0}, "files": [{"sha": "cd360cbef9654b3108d2c1100f6613c5039f6278", "filename": "src/bootstrap/setup.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/103816d704133fc954344d551af04cb333b03e94/src%2Fbootstrap%2Fsetup.rs", "raw_url": "https://github.com/rust-lang/rust/raw/103816d704133fc954344d551af04cb333b03e94/src%2Fbootstrap%2Fsetup.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fsetup.rs?ref=103816d704133fc954344d551af04cb333b03e94", "patch": "@@ -96,6 +96,10 @@ impl Step for Profile {\n     }\n \n     fn make_run(run: RunConfig<'_>) {\n+        if run.builder.config.dry_run() {\n+            return;\n+        }\n+\n         // for Profile, `run.paths` will have 1 and only 1 element\n         // this is because we only accept at most 1 path from user input.\n         // If user calls `x.py setup` without arguments, the interactive TUI"}]}