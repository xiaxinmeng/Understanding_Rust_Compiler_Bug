{"sha": "62068a59eea44ff78c4293d5fcc676279b1deab0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYyMDY4YTU5ZWVhNDRmZjc4YzQyOTNkNWZjYzY3NjI3OWIxZGVhYjA=", "commit": {"author": {"name": "Aur\u00e9lien Deharbe", "email": "aurelien.deharbe@ssi.gouv.fr", "date": "2020-09-11T15:31:52Z"}, "committer": {"name": "Aur\u00e9lien Deharbe", "email": "aurelien.deharbe@ssi.gouv.fr", "date": "2020-09-11T15:31:52Z"}, "message": "repairing broken error message and rustfix application for the new test\ncase", "tree": {"sha": "5b192a89bc2696d3136750e4ee6b35cb9de74ce0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5b192a89bc2696d3136750e4ee6b35cb9de74ce0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/62068a59eea44ff78c4293d5fcc676279b1deab0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/62068a59eea44ff78c4293d5fcc676279b1deab0", "html_url": "https://github.com/rust-lang/rust/commit/62068a59eea44ff78c4293d5fcc676279b1deab0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/62068a59eea44ff78c4293d5fcc676279b1deab0/comments", "author": {"login": "ad-anssi", "id": 45487748, "node_id": "MDQ6VXNlcjQ1NDg3NzQ4", "avatar_url": "https://avatars.githubusercontent.com/u/45487748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ad-anssi", "html_url": "https://github.com/ad-anssi", "followers_url": "https://api.github.com/users/ad-anssi/followers", "following_url": "https://api.github.com/users/ad-anssi/following{/other_user}", "gists_url": "https://api.github.com/users/ad-anssi/gists{/gist_id}", "starred_url": "https://api.github.com/users/ad-anssi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ad-anssi/subscriptions", "organizations_url": "https://api.github.com/users/ad-anssi/orgs", "repos_url": "https://api.github.com/users/ad-anssi/repos", "events_url": "https://api.github.com/users/ad-anssi/events{/privacy}", "received_events_url": "https://api.github.com/users/ad-anssi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ad-anssi", "id": 45487748, "node_id": "MDQ6VXNlcjQ1NDg3NzQ4", "avatar_url": "https://avatars.githubusercontent.com/u/45487748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ad-anssi", "html_url": "https://github.com/ad-anssi", "followers_url": "https://api.github.com/users/ad-anssi/followers", "following_url": "https://api.github.com/users/ad-anssi/following{/other_user}", "gists_url": "https://api.github.com/users/ad-anssi/gists{/gist_id}", "starred_url": "https://api.github.com/users/ad-anssi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ad-anssi/subscriptions", "organizations_url": "https://api.github.com/users/ad-anssi/orgs", "repos_url": "https://api.github.com/users/ad-anssi/repos", "events_url": "https://api.github.com/users/ad-anssi/events{/privacy}", "received_events_url": "https://api.github.com/users/ad-anssi/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f9059a41b48813845e1ffa2d1bdcbc455ffcd10c", "url": "https://api.github.com/repos/rust-lang/rust/commits/f9059a41b48813845e1ffa2d1bdcbc455ffcd10c", "html_url": "https://github.com/rust-lang/rust/commit/f9059a41b48813845e1ffa2d1bdcbc455ffcd10c"}], "stats": {"total": 38, "additions": 28, "deletions": 10}, "files": [{"sha": "7340c5744808c4325c93a3e6469a5a98f5617345", "filename": "compiler/rustc_parse/src/parser/mod.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/62068a59eea44ff78c4293d5fcc676279b1deab0/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/62068a59eea44ff78c4293d5fcc676279b1deab0/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs?ref=62068a59eea44ff78c4293d5fcc676279b1deab0", "patch": "@@ -694,9 +694,13 @@ impl<'a> Parser<'a> {\n                                 Ok(t) => {\n                                     // Parsed successfully, therefore most probably the code only\n                                     // misses a separator.\n+                                    let mut exp_span = self.sess.source_map().next_point(sp);\n+                                    if self.sess.source_map().is_multiline(exp_span) {\n+                                        exp_span = sp;\n+                                    }\n                                     expect_err\n                                         .span_suggestion_short(\n-                                            self.sess.source_map().next_point(sp),\n+                                            exp_span,\n                                             &format!(\"missing `{}`\", token_str),\n                                             token_str,\n                                             Applicability::MaybeIncorrect,"}, {"sha": "2d7a30b8361ad7b2ccc11845bd6cd5154f526921", "filename": "src/test/ui/issue-76597.fixed", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/62068a59eea44ff78c4293d5fcc676279b1deab0/src%2Ftest%2Fui%2Fissue-76597.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/62068a59eea44ff78c4293d5fcc676279b1deab0/src%2Ftest%2Fui%2Fissue-76597.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissue-76597.fixed?ref=62068a59eea44ff78c4293d5fcc676279b1deab0", "patch": "@@ -0,0 +1,11 @@\n+// run-rustfix\n+\n+#![allow(dead_code)]\n+#![allow(unused_variables)]\n+fn f(\n+                                     x: u8,\n+                                     y: u8,\n+) {}\n+//~^^ ERROR: expected one of `!`, `(`, `)`, `+`, `,`, `::`, or `<`, found `y`\n+\n+fn main() {}"}, {"sha": "521b9c64b1c5714bcf8bdf84f629bb1163f5c3bf", "filename": "src/test/ui/issue-76597.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/62068a59eea44ff78c4293d5fcc676279b1deab0/src%2Ftest%2Fui%2Fissue-76597.rs", "raw_url": "https://github.com/rust-lang/rust/raw/62068a59eea44ff78c4293d5fcc676279b1deab0/src%2Ftest%2Fui%2Fissue-76597.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissue-76597.rs?ref=62068a59eea44ff78c4293d5fcc676279b1deab0", "patch": "@@ -1,3 +1,7 @@\n+// run-rustfix\n+\n+#![allow(dead_code)]\n+#![allow(unused_variables)]\n fn f(\n                                      x: u8\n                                      y: u8,"}, {"sha": "50b23329f0cebd2f8400354675514ba9fd844d0f", "filename": "src/test/ui/issue-76597.stderr", "status": "modified", "additions": 8, "deletions": 9, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/62068a59eea44ff78c4293d5fcc676279b1deab0/src%2Ftest%2Fui%2Fissue-76597.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/62068a59eea44ff78c4293d5fcc676279b1deab0/src%2Ftest%2Fui%2Fissue-76597.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissue-76597.stderr?ref=62068a59eea44ff78c4293d5fcc676279b1deab0", "patch": "@@ -1,14 +1,13 @@\n error: expected one of `!`, `(`, `)`, `+`, `,`, `::`, or `<`, found `y`\n-  --> $DIR/issue-76597.rs:3:38\n+  --> $DIR/issue-76597.rs:7:38\n    |\n-LL |   ...                   x: u8\n-   |                              - expected one of 7 possible tokens\n-   |  ____________________________|\n-   | |\n-LL | | ...                   y: u8,\n-|  | |                       ^ unexpected token\n-|  | |\n-   |   help: missing `,`\n+LL | ...                   x: u8\n+   |                            -\n+   |                            |\n+   |                            expected one of 7 possible tokens\n+   |                            help: missing `,`\n+LL | ...                   y: u8,\n+   |                       ^ unexpected token\n \n error: aborting due to previous error\n "}]}