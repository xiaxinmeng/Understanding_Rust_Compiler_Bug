{"sha": "ccf54177990bd569ec1903735e2c55b6b68471a8", "node_id": "C_kwDOAAsO6NoAKGNjZjU0MTc3OTkwYmQ1NjllYzE5MDM3MzVlMmM1NWI2YjY4NDcxYTg", "commit": {"author": {"name": "zhaixiaojuan", "email": "zhaixiaojuan@loongson.cn", "date": "2022-07-07T07:46:10Z"}, "committer": {"name": "wangrui", "email": "wangrui@loongson.cn", "date": "2023-04-04T09:05:08Z"}, "message": "Enable loongarch64 LLVM target", "tree": {"sha": "4ec068d491a4f637081b8011ff83ce633cc4e03b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4ec068d491a4f637081b8011ff83ce633cc4e03b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ccf54177990bd569ec1903735e2c55b6b68471a8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ccf54177990bd569ec1903735e2c55b6b68471a8", "html_url": "https://github.com/rust-lang/rust/commit/ccf54177990bd569ec1903735e2c55b6b68471a8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ccf54177990bd569ec1903735e2c55b6b68471a8/comments", "author": {"login": "zhaixiaojuan", "id": 67671683, "node_id": "MDQ6VXNlcjY3NjcxNjgz", "avatar_url": "https://avatars.githubusercontent.com/u/67671683?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zhaixiaojuan", "html_url": "https://github.com/zhaixiaojuan", "followers_url": "https://api.github.com/users/zhaixiaojuan/followers", "following_url": "https://api.github.com/users/zhaixiaojuan/following{/other_user}", "gists_url": "https://api.github.com/users/zhaixiaojuan/gists{/gist_id}", "starred_url": "https://api.github.com/users/zhaixiaojuan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zhaixiaojuan/subscriptions", "organizations_url": "https://api.github.com/users/zhaixiaojuan/orgs", "repos_url": "https://api.github.com/users/zhaixiaojuan/repos", "events_url": "https://api.github.com/users/zhaixiaojuan/events{/privacy}", "received_events_url": "https://api.github.com/users/zhaixiaojuan/received_events", "type": "User", "site_admin": false}, "committer": {"login": "heiher", "id": 1407733, "node_id": "MDQ6VXNlcjE0MDc3MzM=", "avatar_url": "https://avatars.githubusercontent.com/u/1407733?v=4", "gravatar_id": "", "url": "https://api.github.com/users/heiher", "html_url": "https://github.com/heiher", "followers_url": "https://api.github.com/users/heiher/followers", "following_url": "https://api.github.com/users/heiher/following{/other_user}", "gists_url": "https://api.github.com/users/heiher/gists{/gist_id}", "starred_url": "https://api.github.com/users/heiher/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/heiher/subscriptions", "organizations_url": "https://api.github.com/users/heiher/orgs", "repos_url": "https://api.github.com/users/heiher/repos", "events_url": "https://api.github.com/users/heiher/events{/privacy}", "received_events_url": "https://api.github.com/users/heiher/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "10f7ba562a2f84ff2cfc6d5beec795c24c7e15cd", "url": "https://api.github.com/repos/rust-lang/rust/commits/10f7ba562a2f84ff2cfc6d5beec795c24c7e15cd", "html_url": "https://github.com/rust-lang/rust/commit/10f7ba562a2f84ff2cfc6d5beec795c24c7e15cd"}], "stats": {"total": 20, "additions": 18, "deletions": 2}, "files": [{"sha": "b0783d75d4756156696775ca2950742929aff0be", "filename": "compiler/rustc_llvm/build.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/ccf54177990bd569ec1903735e2c55b6b68471a8/compiler%2Frustc_llvm%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ccf54177990bd569ec1903735e2c55b6b68471a8/compiler%2Frustc_llvm%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_llvm%2Fbuild.rs?ref=ccf54177990bd569ec1903735e2c55b6b68471a8", "patch": "@@ -10,6 +10,7 @@ const OPTIONAL_COMPONENTS: &[&str] = &[\n     \"aarch64\",\n     \"amdgpu\",\n     \"avr\",\n+    \"loongarch\",\n     \"m68k\",\n     \"mips\",\n     \"powerpc\","}, {"sha": "d48b3a30fc167d98ece21ddff5fdbf0723bd633f", "filename": "compiler/rustc_llvm/llvm-wrapper/PassWrapper.cpp", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/ccf54177990bd569ec1903735e2c55b6b68471a8/compiler%2Frustc_llvm%2Fllvm-wrapper%2FPassWrapper.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/ccf54177990bd569ec1903735e2c55b6b68471a8/compiler%2Frustc_llvm%2Fllvm-wrapper%2FPassWrapper.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_llvm%2Fllvm-wrapper%2FPassWrapper.cpp?ref=ccf54177990bd569ec1903735e2c55b6b68471a8", "patch": "@@ -146,6 +146,12 @@ extern \"C\" void LLVMTimeTraceProfilerFinish(const char* FileName) {\n #define SUBTARGET_HEXAGON\n #endif\n \n+#ifdef LLVM_COMPONENT_LOONGARCH\n+#define SUBTARGET_LOONGARCH SUBTARGET(LoongArch)\n+#else\n+#define SUBTARGET_LOONGARCH\n+#endif\n+\n #define GEN_SUBTARGETS                                                         \\\n   SUBTARGET_X86                                                                \\\n   SUBTARGET_ARM                                                                \\\n@@ -159,6 +165,7 @@ extern \"C\" void LLVMTimeTraceProfilerFinish(const char* FileName) {\n   SUBTARGET_SPARC                                                              \\\n   SUBTARGET_HEXAGON                                                            \\\n   SUBTARGET_RISCV                                                              \\\n+  SUBTARGET_LOONGARCH                                                          \\\n \n #define SUBTARGET(x)                                                           \\\n   namespace llvm {                                                             \\"}, {"sha": "06351731bdecdb92f481ac1402b1cfa289c54412", "filename": "compiler/rustc_llvm/src/lib.rs", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/ccf54177990bd569ec1903735e2c55b6b68471a8/compiler%2Frustc_llvm%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ccf54177990bd569ec1903735e2c55b6b68471a8/compiler%2Frustc_llvm%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_llvm%2Fsrc%2Flib.rs?ref=ccf54177990bd569ec1903735e2c55b6b68471a8", "patch": "@@ -102,6 +102,14 @@ pub fn initialize_available_targets() {\n         LLVMInitializeM68kAsmPrinter,\n         LLVMInitializeM68kAsmParser\n     );\n+    init_target!(\n+        llvm_component = \"loongarch\",\n+        LLVMInitializeLoongArchTargetInfo,\n+        LLVMInitializeLoongArchTarget,\n+        LLVMInitializeLoongArchTargetMC,\n+        LLVMInitializeLoongArchAsmPrinter,\n+        LLVMInitializeLoongArchAsmParser\n+    );\n     init_target!(\n         llvm_component = \"mips\",\n         LLVMInitializeMipsTargetInfo,"}, {"sha": "27b6781ca35507351fb2056b52ae4f915092182b", "filename": "config.example.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ccf54177990bd569ec1903735e2c55b6b68471a8/config.example.toml", "raw_url": "https://github.com/rust-lang/rust/raw/ccf54177990bd569ec1903735e2c55b6b68471a8/config.example.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/config.example.toml?ref=ccf54177990bd569ec1903735e2c55b6b68471a8", "patch": "@@ -88,7 +88,7 @@ changelog-seen = 2\n # the resulting rustc being unable to compile for the disabled architectures.\n #\n # To add support for new targets, see https://rustc-dev-guide.rust-lang.org/building/new-target.html.\n-#targets = \"AArch64;ARM;BPF;Hexagon;MSP430;Mips;NVPTX;PowerPC;RISCV;Sparc;SystemZ;WebAssembly;X86\"\n+#targets = \"AArch64;ARM;BPF;Hexagon;LoongArch;MSP430;Mips;NVPTX;PowerPC;RISCV;Sparc;SystemZ;WebAssembly;X86\"\n \n # LLVM experimental targets to build support for. These targets are specified in\n # the same format as above, but since these targets are experimental, they are"}, {"sha": "55b2da7872d2a64dfce671ed4d61946271218754", "filename": "src/bootstrap/llvm.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ccf54177990bd569ec1903735e2c55b6b68471a8/src%2Fbootstrap%2Fllvm.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ccf54177990bd569ec1903735e2c55b6b68471a8/src%2Fbootstrap%2Fllvm.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fllvm.rs?ref=ccf54177990bd569ec1903735e2c55b6b68471a8", "patch": "@@ -291,7 +291,7 @@ impl Step for Llvm {\n         let llvm_targets = match &builder.config.llvm_targets {\n             Some(s) => s,\n             None => {\n-                \"AArch64;ARM;BPF;Hexagon;MSP430;Mips;NVPTX;PowerPC;RISCV;\\\n+                \"AArch64;ARM;BPF;Hexagon;LoongArch;MSP430;Mips;NVPTX;PowerPC;RISCV;\\\n                      Sparc;SystemZ;WebAssembly;X86\"\n             }\n         };"}]}