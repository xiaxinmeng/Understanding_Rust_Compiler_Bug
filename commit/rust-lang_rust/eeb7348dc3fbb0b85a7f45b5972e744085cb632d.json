{"sha": "eeb7348dc3fbb0b85a7f45b5972e744085cb632d", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVlYjczNDhkYzNmYmIwYjg1YTdmNDViNTk3MmU3NDQwODVjYjYzMmQ=", "commit": {"author": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2019-05-22T11:00:09Z"}, "committer": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2019-05-27T12:32:03Z"}, "message": "PGO: Check that pgo-use file actually exists. LLVM seems to only emit an easy-to-overlook warning otherwise.", "tree": {"sha": "e4ae70434ad5ff1ffaf088a2109420a07531b65e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e4ae70434ad5ff1ffaf088a2109420a07531b65e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/eeb7348dc3fbb0b85a7f45b5972e744085cb632d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/eeb7348dc3fbb0b85a7f45b5972e744085cb632d", "html_url": "https://github.com/rust-lang/rust/commit/eeb7348dc3fbb0b85a7f45b5972e744085cb632d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/eeb7348dc3fbb0b85a7f45b5972e744085cb632d/comments", "author": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "committer": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e943426045361045286c6be55c349381b5506f0b", "url": "https://api.github.com/repos/rust-lang/rust/commits/e943426045361045286c6be55c349381b5506f0b", "html_url": "https://github.com/rust-lang/rust/commit/e943426045361045286c6be55c349381b5506f0b"}], "stats": {"total": 9, "additions": 9, "deletions": 0}, "files": [{"sha": "3d8092f6e007073c9edb0b91063ae22eb13c145f", "filename": "src/librustc/session/mod.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/eeb7348dc3fbb0b85a7f45b5972e744085cb632d/src%2Flibrustc%2Fsession%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eeb7348dc3fbb0b85a7f45b5972e744085cb632d/src%2Flibrustc%2Fsession%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fsession%2Fmod.rs?ref=eeb7348dc3fbb0b85a7f45b5972e744085cb632d", "patch": "@@ -1272,6 +1272,15 @@ fn validate_commandline_args_with_session_available(sess: &Session) {\n         sess.err(\"Linker plugin based LTO is not supported together with \\\n                   `-C prefer-dynamic` when targeting MSVC\");\n     }\n+\n+    // Make sure that any given profiling data actually exists so LLVM can't\n+    // decide to silently skip PGO.\n+    if let Some(ref path) = sess.opts.debugging_opts.pgo_use {\n+        if !path.exists() {\n+            sess.err(&format!(\"File `{}` passed to `-Zpgo-use` does not exist.\",\n+                              path.display()));\n+        }\n+    }\n }\n \n /// Hash value constructed out of all the `-C metadata` arguments passed to the"}]}