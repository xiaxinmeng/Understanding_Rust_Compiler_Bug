{"sha": "68014e6b1ceb34da29b51a2804779138c6275fa4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY4MDE0ZTZiMWNlYjM0ZGEyOWI1MWEyODA0Nzc5MTM4YzYyNzVmYTQ=", "commit": {"author": {"name": "Rich Kadel", "email": "richkadel@google.com", "date": "2020-11-06T02:21:30Z"}, "committer": {"name": "Rich Kadel", "email": "richkadel@google.com", "date": "2020-11-06T04:24:36Z"}, "message": "Disable the spanview tests on MacOS for now\n\nAnd even though CI should now pass for MacOS, the llvm-cov show --debug\nflag does not work when developing outside of CI, so I'm disabling it\nfor MacOS by default.", "tree": {"sha": "3acdf2d20b5d965a2de9ab19d1706d8db0715074", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3acdf2d20b5d965a2de9ab19d1706d8db0715074"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/68014e6b1ceb34da29b51a2804779138c6275fa4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/68014e6b1ceb34da29b51a2804779138c6275fa4", "html_url": "https://github.com/rust-lang/rust/commit/68014e6b1ceb34da29b51a2804779138c6275fa4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/68014e6b1ceb34da29b51a2804779138c6275fa4/comments", "author": {"login": "richkadel", "id": 3827298, "node_id": "MDQ6VXNlcjM4MjcyOTg=", "avatar_url": "https://avatars.githubusercontent.com/u/3827298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/richkadel", "html_url": "https://github.com/richkadel", "followers_url": "https://api.github.com/users/richkadel/followers", "following_url": "https://api.github.com/users/richkadel/following{/other_user}", "gists_url": "https://api.github.com/users/richkadel/gists{/gist_id}", "starred_url": "https://api.github.com/users/richkadel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/richkadel/subscriptions", "organizations_url": "https://api.github.com/users/richkadel/orgs", "repos_url": "https://api.github.com/users/richkadel/repos", "events_url": "https://api.github.com/users/richkadel/events{/privacy}", "received_events_url": "https://api.github.com/users/richkadel/received_events", "type": "User", "site_admin": false}, "committer": {"login": "richkadel", "id": 3827298, "node_id": "MDQ6VXNlcjM4MjcyOTg=", "avatar_url": "https://avatars.githubusercontent.com/u/3827298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/richkadel", "html_url": "https://github.com/richkadel", "followers_url": "https://api.github.com/users/richkadel/followers", "following_url": "https://api.github.com/users/richkadel/following{/other_user}", "gists_url": "https://api.github.com/users/richkadel/gists{/gist_id}", "starred_url": "https://api.github.com/users/richkadel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/richkadel/subscriptions", "organizations_url": "https://api.github.com/users/richkadel/orgs", "repos_url": "https://api.github.com/users/richkadel/repos", "events_url": "https://api.github.com/users/richkadel/events{/privacy}", "received_events_url": "https://api.github.com/users/richkadel/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "430dcb6110ae00fb64eb927e55dffa2bba87b657", "url": "https://api.github.com/repos/rust-lang/rust/commits/430dcb6110ae00fb64eb927e55dffa2bba87b657", "html_url": "https://github.com/rust-lang/rust/commit/430dcb6110ae00fb64eb927e55dffa2bba87b657"}], "stats": {"total": 20, "additions": 20, "deletions": 0}, "files": [{"sha": "b175768e1996286d54f2a96b8f9ecffb368561eb", "filename": "src/test/run-make-fulldeps/coverage-reports-base/Makefile", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/68014e6b1ceb34da29b51a2804779138c6275fa4/src%2Ftest%2Frun-make-fulldeps%2Fcoverage-reports-base%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/68014e6b1ceb34da29b51a2804779138c6275fa4/src%2Ftest%2Frun-make-fulldeps%2Fcoverage-reports-base%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fcoverage-reports-base%2FMakefile?ref=68014e6b1ceb34da29b51a2804779138c6275fa4", "patch": "@@ -13,6 +13,12 @@\n BASEDIR=../coverage-reports-base\n SOURCEDIR=../coverage\n \n+ifeq ($(UNAME),Darwin)\n+# FIXME(richkadel): It appears that --debug is not available on MacOS even when not running\n+# under CI.\n+NO_LLVM_ASSERTIONS=1\n+endif\n+\n # The `llvm-cov show` flag `--debug`, used to generate the `counters` output files, is only enabled\n # if LLVM assertions are enabled. Some CI builds disable debug assertions.\n ifndef NO_LLVM_ASSERTIONS"}, {"sha": "fb9f5215fe8ee8e41a9c6989b6a1b24efc1eaa72", "filename": "src/test/run-make-fulldeps/coverage-spanview-base/Makefile", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/68014e6b1ceb34da29b51a2804779138c6275fa4/src%2Ftest%2Frun-make-fulldeps%2Fcoverage-spanview-base%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/68014e6b1ceb34da29b51a2804779138c6275fa4/src%2Ftest%2Frun-make-fulldeps%2Fcoverage-spanview-base%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fcoverage-spanview-base%2FMakefile?ref=68014e6b1ceb34da29b51a2804779138c6275fa4", "patch": "@@ -9,6 +9,10 @@\n BASEDIR=../coverage-spanview-base\n SOURCEDIR=../coverage\n \n+ifeq ($(UNAME),Darwin)\n+SED_HAS_ISSUES=1\n+endif\n+\n all: $(patsubst $(SOURCEDIR)/%.rs,%,$(wildcard $(SOURCEDIR)/*.rs))\n \n # Ensure there are no `expected` results for tests that may have been removed or renamed\n@@ -29,6 +33,14 @@ endif\n \t\t\t-Zdump-mir-spanview \\\n \t\t\t-Zdump-mir-dir=\"$(TMPDIR)\"/mir_dump.$@\n \n+ifdef SED_HAS_ISSUES\n+\t# FIXME(richkadel): MacOS's default sed has some significant limitations. Until I've come up\n+\t# with a better workaround, I'm disabling this test for MacOS.\n+\t#\n+\t# For future reference, see if `gsed` is available as an alternative.\n+\twhich gsed || echo \"no gsed\"\n+else\n+\n \tfor path in \"$(TMPDIR)\"/mir_dump.$@/*; do \\\n \t\techo $$path; \\\n \t\tfile=\"$$(basename \"$$path\")\"; \\\n@@ -58,3 +70,5 @@ else\n \tcp \"$(TMPDIR)\"/mir_dump.$@/*InstrumentCoverage.0.html \"$(TMPDIR)\"/actual_mir_dump.$@/\n \t$(DIFF) -r expected_mir_dump.$@/ \"$(TMPDIR)\"/actual_mir_dump.$@/\n endif\n+\n+endif"}]}