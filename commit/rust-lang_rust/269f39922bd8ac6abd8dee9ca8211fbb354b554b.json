{"sha": "269f39922bd8ac6abd8dee9ca8211fbb354b554b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI2OWYzOTkyMmJkOGFjNmFiZDhkZWU5Y2E4MjExZmJiMzU0YjU1NGI=", "commit": {"author": {"name": "Dylan DPC", "email": "dylan.dpc@gmail.com", "date": "2021-02-23T15:10:27Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-02-23T15:10:27Z"}, "message": "Rollup merge of #82308 - estebank:issue-82290, r=lcnr\n\nLower condition of `if` expression before it's \"then\" block\n\nFix #82290, fix #82250.", "tree": {"sha": "841ba7acee6cd868e00b3983af495eac61020150", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/841ba7acee6cd868e00b3983af495eac61020150"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/269f39922bd8ac6abd8dee9ca8211fbb354b554b", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgNRrjCRBK7hj4Ov3rIwAAdHIIACkogSap1zTZqyfKddcS/hHc\n91aBy75mwzrZOzXI+YqIe+WtHBSFE2rauBIYkfQbMjqU8iGb4TykzsD8HykSJ6Ya\nbG2e3AYM5oUNR89boFTNP2MXi0p6+XXVeXh54Lvjg0HtuS3JO0GHue4BgksN4OtR\n5JhHPHY2CHjeeS+WwEyAFZCcHANJ6TguwDgn4YYYUEW1f7BdiXdwbO5j8mTH8dJq\nHaIdZFIWhWlfrPFDeN21S2DE+yK+T05Wzbl0e/cr1YiqqUgwL7CVrgv7kilhrHMp\nHn2N4y0BnxJqkS8wwrc51ihUQdWZkAcTuweYsw47aNCmiZ6z0WvHB+6t9KAaLzc=\n=fmiY\n-----END PGP SIGNATURE-----\n", "payload": "tree 841ba7acee6cd868e00b3983af495eac61020150\nparent 8e67fe501118ec161181a4efa1a6b002bb0f5605\nparent f0637e4e185e8c3dda694004d1dfd31126ed1fbd\nauthor Dylan DPC <dylan.dpc@gmail.com> 1614093027 +0100\ncommitter GitHub <noreply@github.com> 1614093027 +0100\n\nRollup merge of #82308 - estebank:issue-82290, r=lcnr\n\nLower condition of `if` expression before it's \"then\" block\n\nFix #82290, fix #82250.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/269f39922bd8ac6abd8dee9ca8211fbb354b554b", "html_url": "https://github.com/rust-lang/rust/commit/269f39922bd8ac6abd8dee9ca8211fbb354b554b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/269f39922bd8ac6abd8dee9ca8211fbb354b554b/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8e67fe501118ec161181a4efa1a6b002bb0f5605", "url": "https://api.github.com/repos/rust-lang/rust/commits/8e67fe501118ec161181a4efa1a6b002bb0f5605", "html_url": "https://github.com/rust-lang/rust/commit/8e67fe501118ec161181a4efa1a6b002bb0f5605"}, {"sha": "f0637e4e185e8c3dda694004d1dfd31126ed1fbd", "url": "https://api.github.com/repos/rust-lang/rust/commits/f0637e4e185e8c3dda694004d1dfd31126ed1fbd", "html_url": "https://github.com/rust-lang/rust/commit/f0637e4e185e8c3dda694004d1dfd31126ed1fbd"}], "stats": {"total": 30, "additions": 29, "deletions": 1}, "files": [{"sha": "6d44feec2c4969f6095b557048460a7313e74550", "filename": "compiler/rustc_ast_lowering/src/expr.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/269f39922bd8ac6abd8dee9ca8211fbb354b554b/compiler%2Frustc_ast_lowering%2Fsrc%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/269f39922bd8ac6abd8dee9ca8211fbb354b554b/compiler%2Frustc_ast_lowering%2Fsrc%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Fexpr.rs?ref=269f39922bd8ac6abd8dee9ca8211fbb354b554b", "patch": "@@ -347,8 +347,9 @@ impl<'hir> LoweringContext<'_, 'hir> {\n     ) -> hir::ExprKind<'hir> {\n         macro_rules! make_if {\n             ($opt:expr) => {{\n+                let cond = self.lower_expr(cond);\n                 let then_expr = self.lower_block_expr(then);\n-                hir::ExprKind::If(self.lower_expr(cond), self.arena.alloc(then_expr), $opt)\n+                hir::ExprKind::If(cond, self.arena.alloc(then_expr), $opt)\n             }};\n         }\n         if let Some(rslt) = else_opt {"}, {"sha": "67f0274fe7436e9b1acfe6ff9dec4144ea4bddd2", "filename": "src/test/ui/pattern/issue-82290.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/269f39922bd8ac6abd8dee9ca8211fbb354b554b/src%2Ftest%2Fui%2Fpattern%2Fissue-82290.rs", "raw_url": "https://github.com/rust-lang/rust/raw/269f39922bd8ac6abd8dee9ca8211fbb354b554b/src%2Ftest%2Fui%2Fpattern%2Fissue-82290.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpattern%2Fissue-82290.rs?ref=269f39922bd8ac6abd8dee9ca8211fbb354b554b", "patch": "@@ -0,0 +1,7 @@\n+#![feature(let_chains)] //~ WARN the feature `let_chains` is incomplete\n+\n+fn main() {\n+    if true && let x = 1 { //~ ERROR `let` expressions are not supported here\n+        let _ = x;\n+    }\n+}"}, {"sha": "65ef018dc97374ddc8371b18e3b8a28c8ec432d7", "filename": "src/test/ui/pattern/issue-82290.stderr", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/269f39922bd8ac6abd8dee9ca8211fbb354b554b/src%2Ftest%2Fui%2Fpattern%2Fissue-82290.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/269f39922bd8ac6abd8dee9ca8211fbb354b554b/src%2Ftest%2Fui%2Fpattern%2Fissue-82290.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpattern%2Fissue-82290.stderr?ref=269f39922bd8ac6abd8dee9ca8211fbb354b554b", "patch": "@@ -0,0 +1,20 @@\n+error: `let` expressions are not supported here\n+  --> $DIR/issue-82290.rs:4:16\n+   |\n+LL |     if true && let x = 1 {\n+   |                ^^^^^^^^^\n+   |\n+   = note: only supported directly in conditions of `if`- and `while`-expressions\n+   = note: as well as when nested within `&&` and parenthesis in those conditions\n+\n+warning: the feature `let_chains` is incomplete and may not be safe to use and/or cause compiler crashes\n+  --> $DIR/issue-82290.rs:1:12\n+   |\n+LL | #![feature(let_chains)]\n+   |            ^^^^^^^^^^\n+   |\n+   = note: `#[warn(incomplete_features)]` on by default\n+   = note: see issue #53667 <https://github.com/rust-lang/rust/issues/53667> for more information\n+\n+error: aborting due to previous error; 1 warning emitted\n+"}]}