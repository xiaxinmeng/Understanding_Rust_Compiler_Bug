{"sha": "adde928305f7d1c0c114201b10a759ac4236e599", "node_id": "C_kwDOAAsO6NoAKGFkZGU5MjgzMDVmN2QxYzBjMTE0MjAxYjEwYTc1OWFjNDIzNmU1OTk", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-09-23T02:29:17Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-09-23T02:29:17Z"}, "message": "Rollup merge of #102042 - LukeMathWalker:add-rust-json-docs-to-rustup, r=Mark-Simulacrum\n\nDistribute rust-docs-json via rustup.\n\nI am not 100% sure on how to treat `rust-json-docs` in `target_host_combination`. I went along with a similar strategy to the one used for `rust-docs`, but looking for guidance there.", "tree": {"sha": "827004999b8e3c992f6d4b69f76820ce64b423e6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/827004999b8e3c992f6d4b69f76820ce64b423e6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/adde928305f7d1c0c114201b10a759ac4236e599", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjLRn9CRBK7hj4Ov3rIwAA+DMIAIoebCmFKEw/vszfEX7MPBRi\nLdV+h0czWLr2ddc6cZQJr0QxAjqD5eWBoZHQG7iCaiLXezffz0YIiMu084kTaH2H\njtlzmfQoHzZWjrPIVr5BwIqFxo2R8DyYlRpiDUKEc34+CmeLROq6CHASy5bK8zxV\nMO2G1r4YWPrWv+vvXmGu9CvsQZFIyVc+XRRJMF7nPkpeCrJS6v0UHg0GlyK4WsDN\n6VTgJfyOG20OSfoQQ6xh7SX5KtwEKQAE6FgsfCC/Bxl1lQnG2GMwNnWyPYzJEeCD\n8M+V5x0czTI6ThK/L8j9HpcWGsy8qb3zyihEcbv641SJAoOPLLduTWX3yHfu02A=\n=ZTCy\n-----END PGP SIGNATURE-----\n", "payload": "tree 827004999b8e3c992f6d4b69f76820ce64b423e6\nparent 695b708311df451739b759b652a17c9e8c94b6c8\nparent e572d513bd2ca1743d141ccee91563d6faf2e19f\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1663900157 +0200\ncommitter GitHub <noreply@github.com> 1663900157 +0200\n\nRollup merge of #102042 - LukeMathWalker:add-rust-json-docs-to-rustup, r=Mark-Simulacrum\n\nDistribute rust-docs-json via rustup.\n\nI am not 100% sure on how to treat `rust-json-docs` in `target_host_combination`. I went along with a similar strategy to the one used for `rust-docs`, but looking for guidance there.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/adde928305f7d1c0c114201b10a759ac4236e599", "html_url": "https://github.com/rust-lang/rust/commit/adde928305f7d1c0c114201b10a759ac4236e599", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/adde928305f7d1c0c114201b10a759ac4236e599/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "695b708311df451739b759b652a17c9e8c94b6c8", "url": "https://api.github.com/repos/rust-lang/rust/commits/695b708311df451739b759b652a17c9e8c94b6c8", "html_url": "https://github.com/rust-lang/rust/commit/695b708311df451739b759b652a17c9e8c94b6c8"}, {"sha": "e572d513bd2ca1743d141ccee91563d6faf2e19f", "url": "https://api.github.com/repos/rust-lang/rust/commits/e572d513bd2ca1743d141ccee91563d6faf2e19f", "html_url": "https://github.com/rust-lang/rust/commit/e572d513bd2ca1743d141ccee91563d6faf2e19f"}], "stats": {"total": 19, "additions": 8, "deletions": 11}, "files": [{"sha": "b7bc96cc86dac9006a336223ce7226c8077e7bbd", "filename": "src/bootstrap/dist.rs", "status": "modified", "additions": 4, "deletions": 10, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/adde928305f7d1c0c114201b10a759ac4236e599/src%2Fbootstrap%2Fdist.rs", "raw_url": "https://github.com/rust-lang/rust/raw/adde928305f7d1c0c114201b10a759ac4236e599/src%2Fbootstrap%2Fdist.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdist.rs?ref=adde928305f7d1c0c114201b10a759ac4236e599", "patch": "@@ -86,29 +86,23 @@ impl Step for JsonDocs {\n \n     fn should_run(run: ShouldRun<'_>) -> ShouldRun<'_> {\n         let default = run.builder.config.docs;\n-        run.alias(\"rust-json-docs\").default_condition(default)\n+        run.alias(\"rust-docs-json\").default_condition(default)\n     }\n \n     fn make_run(run: RunConfig<'_>) {\n         run.builder.ensure(JsonDocs { host: run.target });\n     }\n \n-    /// Builds the `rust-json-docs` installer component.\n+    /// Builds the `rust-docs-json` installer component.\n     fn run(self, builder: &Builder<'_>) -> Option<GeneratedTarball> {\n-        // This prevents JSON docs from being built for \"dist\" or \"install\"\n-        // on the stable/beta channels. The JSON format is not stable yet and\n-        // should not be included in stable/beta toolchains.\n-        if !builder.build.unstable_features() {\n-            return None;\n-        }\n-\n         let host = self.host;\n         builder.ensure(crate::doc::JsonStd { stage: builder.top_stage, target: host });\n \n         let dest = \"share/doc/rust/json\";\n \n-        let mut tarball = Tarball::new(builder, \"rust-json-docs\", &host.triple);\n+        let mut tarball = Tarball::new(builder, \"rust-docs-json\", &host.triple);\n         tarball.set_product_name(\"Rust Documentation In JSON Format\");\n+        tarball.is_preview(true);\n         tarball.add_bulk_dir(&builder.json_doc_out(host), dest);\n         Some(tarball.generate())\n     }"}, {"sha": "14311cff5c8c53a568100a4fa23025e9b3e25ce9", "filename": "src/tools/build-manifest/src/main.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/adde928305f7d1c0c114201b10a759ac4236e599/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/adde928305f7d1c0c114201b10a759ac4236e599/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs?ref=adde928305f7d1c0c114201b10a759ac4236e599", "patch": "@@ -184,7 +184,7 @@ static PKG_INSTALLERS: &[&str] = &[\"x86_64-apple-darwin\", \"aarch64-apple-darwin\"\n \n static MINGW: &[&str] = &[\"i686-pc-windows-gnu\", \"x86_64-pc-windows-gnu\"];\n \n-static NIGHTLY_ONLY_COMPONENTS: &[&str] = &[\"miri-preview\"];\n+static NIGHTLY_ONLY_COMPONENTS: &[&str] = &[\"miri-preview\", \"rust-docs-json-preview\"];\n \n macro_rules! t {\n     ($e:expr) => {\n@@ -294,6 +294,7 @@ impl Builder {\n         package!(\"rust-mingw\", MINGW);\n         package!(\"rust-std\", TARGETS);\n         self.package(\"rust-docs\", &mut manifest.pkg, HOSTS, DOCS_FALLBACK);\n+        self.package(\"rust-docs-json-preview\", &mut manifest.pkg, HOSTS, DOCS_FALLBACK);\n         package!(\"rust-src\", &[\"*\"]);\n         package!(\"rls-preview\", HOSTS);\n         package!(\"rust-analyzer-preview\", HOSTS);\n@@ -379,6 +380,7 @@ impl Builder {\n         rename(\"rustfmt\", \"rustfmt-preview\");\n         rename(\"clippy\", \"clippy-preview\");\n         rename(\"miri\", \"miri-preview\");\n+        rename(\"rust-docs-json\", \"rust-docs-json-preview\");\n         rename(\"rust-analyzer\", \"rust-analyzer-preview\");\n     }\n \n@@ -435,6 +437,7 @@ impl Builder {\n             host_component(\"rustfmt-preview\"),\n             host_component(\"llvm-tools-preview\"),\n             host_component(\"rust-analysis\"),\n+            host_component(\"rust-docs-json\"),\n         ]);\n \n         extensions.extend("}]}