{"sha": "fb36440b7a0d2444dd079876d4fde6b0ee9d5670", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZiMzY0NDBiN2EwZDI0NDRkZDA3OTg3NmQ0ZmRlNmIwZWU5ZDU2NzA=", "commit": {"author": {"name": "Eduard-Mihai Burtescu", "email": "edy.burt@gmail.com", "date": "2020-02-08T21:46:57Z"}, "committer": {"name": "Eduard-Mihai Burtescu", "email": "edy.burt@gmail.com", "date": "2020-10-21T01:43:56Z"}, "message": "test: ensure #[track_caller] tests also test MIR inlining.", "tree": {"sha": "934819c7fec7279701127d96053aefb2339c6746", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/934819c7fec7279701127d96053aefb2339c6746"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fb36440b7a0d2444dd079876d4fde6b0ee9d5670", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fb36440b7a0d2444dd079876d4fde6b0ee9d5670", "html_url": "https://github.com/rust-lang/rust/commit/fb36440b7a0d2444dd079876d4fde6b0ee9d5670", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fb36440b7a0d2444dd079876d4fde6b0ee9d5670/comments", "author": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6bc5eafbce7dd3630a26b9f2e94938a4dfc61c06", "url": "https://api.github.com/repos/rust-lang/rust/commits/6bc5eafbce7dd3630a26b9f2e94938a4dfc61c06", "html_url": "https://github.com/rust-lang/rust/commit/6bc5eafbce7dd3630a26b9f2e94938a4dfc61c06"}], "stats": {"total": 41, "additions": 29, "deletions": 12}, "files": [{"sha": "b2ed8a0d7da685c305460228cb18ac0c3992a61c", "filename": "src/test/ui/rfc-2091-track-caller/caller-location-intrinsic.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fb36440b7a0d2444dd079876d4fde6b0ee9d5670/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Fcaller-location-intrinsic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fb36440b7a0d2444dd079876d4fde6b0ee9d5670/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Fcaller-location-intrinsic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Fcaller-location-intrinsic.rs?ref=fb36440b7a0d2444dd079876d4fde6b0ee9d5670", "patch": "@@ -1,4 +1,6 @@\n // run-pass\n+// revisions: default mir-opt\n+//[mir-opt] compile-flags: -Zmir-opt-level=3\n \n #[inline(never)]\n #[track_caller]\n@@ -13,13 +15,13 @@ macro_rules! caller_location_from_macro {\n fn main() {\n     let loc = codegen_caller_loc();\n     assert_eq!(loc.file(), file!());\n-    assert_eq!(loc.line(), 14);\n+    assert_eq!(loc.line(), 16);\n     assert_eq!(loc.column(), 15);\n \n     // `Location::caller()` in a macro should behave similarly to `file!` and `line!`,\n     // i.e. point to where the macro was invoked, instead of the macro itself.\n     let loc2 = caller_location_from_macro!();\n     assert_eq!(loc2.file(), file!());\n-    assert_eq!(loc2.line(), 21);\n+    assert_eq!(loc2.line(), 23);\n     assert_eq!(loc2.column(), 16);\n }"}, {"sha": "89a42acafba782823dc52ae0519fd6600270c88b", "filename": "src/test/ui/rfc-2091-track-caller/const-caller-location.rs", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/fb36440b7a0d2444dd079876d4fde6b0ee9d5670/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Fconst-caller-location.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fb36440b7a0d2444dd079876d4fde6b0ee9d5670/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Fconst-caller-location.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Fconst-caller-location.rs?ref=fb36440b7a0d2444dd079876d4fde6b0ee9d5670", "patch": "@@ -1,4 +1,6 @@\n // run-pass\n+// revisions: default mir-opt\n+//[mir-opt] compile-flags: -Zmir-opt-level=3\n \n #![feature(const_caller_location, const_fn)]\n \n@@ -24,18 +26,18 @@ const fn contained() -> &'static Location<'static> {\n \n fn main() {\n     assert_eq!(LOCATION.file(), file!());\n-    assert_eq!(LOCATION.line(), 7);\n+    assert_eq!(LOCATION.line(), 9);\n     assert_eq!(LOCATION.column(), 29);\n \n     assert_eq!(TRACKED.file(), file!());\n-    assert_eq!(TRACKED.line(), 9);\n+    assert_eq!(TRACKED.line(), 11);\n     assert_eq!(TRACKED.column(), 28);\n \n     assert_eq!(NESTED.file(), file!());\n-    assert_eq!(NESTED.line(), 17);\n+    assert_eq!(NESTED.line(), 19);\n     assert_eq!(NESTED.column(), 5);\n \n     assert_eq!(CONTAINED.file(), file!());\n-    assert_eq!(CONTAINED.line(), 22);\n+    assert_eq!(CONTAINED.line(), 24);\n     assert_eq!(CONTAINED.column(), 5);\n }"}, {"sha": "d072fb76f10d8b74fc936894c43cf020eb52da3e", "filename": "src/test/ui/rfc-2091-track-caller/intrinsic-wrapper.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/fb36440b7a0d2444dd079876d4fde6b0ee9d5670/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Fintrinsic-wrapper.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fb36440b7a0d2444dd079876d4fde6b0ee9d5670/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Fintrinsic-wrapper.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Fintrinsic-wrapper.rs?ref=fb36440b7a0d2444dd079876d4fde6b0ee9d5670", "patch": "@@ -1,4 +1,6 @@\n // run-pass\n+// revisions: default mir-opt\n+//[mir-opt] compile-flags: -Zmir-opt-level=3\n \n macro_rules! caller_location_from_macro {\n     () => (core::panic::Location::caller());\n@@ -7,13 +9,13 @@ macro_rules! caller_location_from_macro {\n fn main() {\n     let loc = core::panic::Location::caller();\n     assert_eq!(loc.file(), file!());\n-    assert_eq!(loc.line(), 8);\n+    assert_eq!(loc.line(), 10);\n     assert_eq!(loc.column(), 15);\n \n     // `Location::caller()` in a macro should behave similarly to `file!` and `line!`,\n     // i.e. point to where the macro was invoked, instead of the macro itself.\n     let loc2 = caller_location_from_macro!();\n     assert_eq!(loc2.file(), file!());\n-    assert_eq!(loc2.line(), 15);\n+    assert_eq!(loc2.line(), 17);\n     assert_eq!(loc2.column(), 16);\n }"}, {"sha": "4d548d4f0aa395e22e092371d4a4ce547480e3c3", "filename": "src/test/ui/rfc-2091-track-caller/pass.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/fb36440b7a0d2444dd079876d4fde6b0ee9d5670/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Fpass.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fb36440b7a0d2444dd079876d4fde6b0ee9d5670/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Fpass.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Fpass.rs?ref=fb36440b7a0d2444dd079876d4fde6b0ee9d5670", "patch": "@@ -1,4 +1,7 @@\n // run-pass\n+// revisions: default mir-opt\n+//[mir-opt] compile-flags: -Zmir-opt-level=3\n+\n #[track_caller]\n fn f() {}\n "}, {"sha": "0d7a5c42532f1cd53f9a1134c4c9e8c4b942ed9d", "filename": "src/test/ui/rfc-2091-track-caller/std-panic-locations.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fb36440b7a0d2444dd079876d4fde6b0ee9d5670/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Fstd-panic-locations.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fb36440b7a0d2444dd079876d4fde6b0ee9d5670/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Fstd-panic-locations.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Fstd-panic-locations.rs?ref=fb36440b7a0d2444dd079876d4fde6b0ee9d5670", "patch": "@@ -1,5 +1,7 @@\n // run-pass\n // ignore-wasm32-bare compiled with panic=abort by default\n+// revisions: default mir-opt\n+//[mir-opt] compile-flags: -Zmir-opt-level=3\n \n #![feature(option_expect_none, option_unwrap_none)]\n #![allow(unconditional_panic)]"}, {"sha": "43135ebbf65df3e223ba26e2808d3f011ef1a589", "filename": "src/test/ui/rfc-2091-track-caller/track-caller-attribute.rs", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/fb36440b7a0d2444dd079876d4fde6b0ee9d5670/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Ftrack-caller-attribute.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fb36440b7a0d2444dd079876d4fde6b0ee9d5670/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Ftrack-caller-attribute.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Ftrack-caller-attribute.rs?ref=fb36440b7a0d2444dd079876d4fde6b0ee9d5670", "patch": "@@ -1,4 +1,6 @@\n // run-pass\n+// revisions: default mir-opt\n+//[mir-opt] compile-flags: -Zmir-opt-level=3\n \n use std::panic::Location;\n \n@@ -18,21 +20,21 @@ fn nested_tracked() -> &'static Location<'static> {\n fn main() {\n     let location = Location::caller();\n     assert_eq!(location.file(), file!());\n-    assert_eq!(location.line(), 19);\n+    assert_eq!(location.line(), 21);\n     assert_eq!(location.column(), 20);\n \n     let tracked = tracked();\n     assert_eq!(tracked.file(), file!());\n-    assert_eq!(tracked.line(), 24);\n+    assert_eq!(tracked.line(), 26);\n     assert_eq!(tracked.column(), 19);\n \n     let nested = nested_intrinsic();\n     assert_eq!(nested.file(), file!());\n-    assert_eq!(nested.line(), 11);\n+    assert_eq!(nested.line(), 13);\n     assert_eq!(nested.column(), 5);\n \n     let contained = nested_tracked();\n     assert_eq!(contained.file(), file!());\n-    assert_eq!(contained.line(), 15);\n+    assert_eq!(contained.line(), 17);\n     assert_eq!(contained.column(), 5);\n }"}, {"sha": "2122a4ca219250d18568283032fb4b2e1dd0601d", "filename": "src/test/ui/rfc-2091-track-caller/tracked-fn-ptr-with-arg.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fb36440b7a0d2444dd079876d4fde6b0ee9d5670/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Ftracked-fn-ptr-with-arg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fb36440b7a0d2444dd079876d4fde6b0ee9d5670/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Ftracked-fn-ptr-with-arg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Ftracked-fn-ptr-with-arg.rs?ref=fb36440b7a0d2444dd079876d4fde6b0ee9d5670", "patch": "@@ -1,4 +1,6 @@\n // run-pass\n+// revisions: default mir-opt\n+//[mir-opt] compile-flags: -Zmir-opt-level=3\n \n fn pass_to_ptr_call<T>(f: fn(T), x: T) {\n     f(x);"}, {"sha": "922d2d7b7021a9d7c187b91270c36f7a9adbb5e3", "filename": "src/test/ui/rfc-2091-track-caller/tracked-fn-ptr.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fb36440b7a0d2444dd079876d4fde6b0ee9d5670/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Ftracked-fn-ptr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fb36440b7a0d2444dd079876d4fde6b0ee9d5670/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Ftracked-fn-ptr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2091-track-caller%2Ftracked-fn-ptr.rs?ref=fb36440b7a0d2444dd079876d4fde6b0ee9d5670", "patch": "@@ -1,4 +1,6 @@\n // run-pass\n+// revisions: default mir-opt\n+//[mir-opt] compile-flags: -Zmir-opt-level=3\n \n fn ptr_call(f: fn()) {\n     f();"}]}