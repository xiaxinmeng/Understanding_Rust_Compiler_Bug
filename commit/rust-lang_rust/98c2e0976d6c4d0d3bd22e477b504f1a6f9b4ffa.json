{"sha": "98c2e0976d6c4d0d3bd22e477b504f1a6f9b4ffa", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk4YzJlMDk3NmQ2YzRkMGQzYmQyMmU0NzdiNTA0ZjFhNmY5YjRmZmE=", "commit": {"author": {"name": "Shotaro Yamada", "email": "sinkuu@sinkuu.xyz", "date": "2018-04-23T04:54:09Z"}, "committer": {"name": "Shotaro Yamada", "email": "sinkuu@sinkuu.xyz", "date": "2018-04-26T12:56:21Z"}, "message": "Do not ICE on generics mismatch with non-local traits\n\nFixes #49841", "tree": {"sha": "deba8b0da9bbf6ccd10bcb9683f4f7889e1711a7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/deba8b0da9bbf6ccd10bcb9683f4f7889e1711a7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/98c2e0976d6c4d0d3bd22e477b504f1a6f9b4ffa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/98c2e0976d6c4d0d3bd22e477b504f1a6f9b4ffa", "html_url": "https://github.com/rust-lang/rust/commit/98c2e0976d6c4d0d3bd22e477b504f1a6f9b4ffa", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/98c2e0976d6c4d0d3bd22e477b504f1a6f9b4ffa/comments", "author": {"login": "sinkuu", "id": 7091080, "node_id": "MDQ6VXNlcjcwOTEwODA=", "avatar_url": "https://avatars.githubusercontent.com/u/7091080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sinkuu", "html_url": "https://github.com/sinkuu", "followers_url": "https://api.github.com/users/sinkuu/followers", "following_url": "https://api.github.com/users/sinkuu/following{/other_user}", "gists_url": "https://api.github.com/users/sinkuu/gists{/gist_id}", "starred_url": "https://api.github.com/users/sinkuu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sinkuu/subscriptions", "organizations_url": "https://api.github.com/users/sinkuu/orgs", "repos_url": "https://api.github.com/users/sinkuu/repos", "events_url": "https://api.github.com/users/sinkuu/events{/privacy}", "received_events_url": "https://api.github.com/users/sinkuu/received_events", "type": "User", "site_admin": false}, "committer": {"login": "sinkuu", "id": 7091080, "node_id": "MDQ6VXNlcjcwOTEwODA=", "avatar_url": "https://avatars.githubusercontent.com/u/7091080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sinkuu", "html_url": "https://github.com/sinkuu", "followers_url": "https://api.github.com/users/sinkuu/followers", "following_url": "https://api.github.com/users/sinkuu/following{/other_user}", "gists_url": "https://api.github.com/users/sinkuu/gists{/gist_id}", "starred_url": "https://api.github.com/users/sinkuu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sinkuu/subscriptions", "organizations_url": "https://api.github.com/users/sinkuu/orgs", "repos_url": "https://api.github.com/users/sinkuu/repos", "events_url": "https://api.github.com/users/sinkuu/events{/privacy}", "received_events_url": "https://api.github.com/users/sinkuu/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "81135c9dbc92dc78df747d5096ff07d867ef3b02", "url": "https://api.github.com/repos/rust-lang/rust/commits/81135c9dbc92dc78df747d5096ff07d867ef3b02", "html_url": "https://github.com/rust-lang/rust/commit/81135c9dbc92dc78df747d5096ff07d867ef3b02"}], "stats": {"total": 14, "additions": 12, "deletions": 2}, "files": [{"sha": "2003e0cc3d28f721f3676c84ceedf5c78793d000", "filename": "src/librustc_typeck/check/compare_method.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/98c2e0976d6c4d0d3bd22e477b504f1a6f9b4ffa/src%2Flibrustc_typeck%2Fcheck%2Fcompare_method.rs", "raw_url": "https://github.com/rust-lang/rust/raw/98c2e0976d6c4d0d3bd22e477b504f1a6f9b4ffa/src%2Flibrustc_typeck%2Fcheck%2Fcompare_method.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fcompare_method.rs?ref=98c2e0976d6c4d0d3bd22e477b504f1a6f9b4ffa", "patch": "@@ -730,8 +730,7 @@ fn compare_synthetic_generics<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n         if impl_ty.synthetic != trait_ty.synthetic {\n             let impl_node_id = tcx.hir.as_local_node_id(impl_ty.def_id).unwrap();\n             let impl_span = tcx.hir.span(impl_node_id);\n-            let trait_node_id = tcx.hir.as_local_node_id(trait_ty.def_id).unwrap();\n-            let trait_span = tcx.hir.span(trait_node_id);\n+            let trait_span = tcx.def_span(trait_ty.def_id);\n             let mut err = struct_span_err!(tcx.sess,\n                                            impl_span,\n                                            E0643,"}, {"sha": "d6707f590113ce5e464edd019ca0b55225d610e1", "filename": "src/test/compile-fail/impl-trait/impl-generic-mismatch.rs", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/98c2e0976d6c4d0d3bd22e477b504f1a6f9b4ffa/src%2Ftest%2Fcompile-fail%2Fimpl-trait%2Fimpl-generic-mismatch.rs", "raw_url": "https://github.com/rust-lang/rust/raw/98c2e0976d6c4d0d3bd22e477b504f1a6f9b4ffa/src%2Ftest%2Fcompile-fail%2Fimpl-trait%2Fimpl-generic-mismatch.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fimpl-trait%2Fimpl-generic-mismatch.rs?ref=98c2e0976d6c4d0d3bd22e477b504f1a6f9b4ffa", "patch": "@@ -28,4 +28,15 @@ impl Bar for () {\n     //~^ Error method `bar` has incompatible signature for trait\n }\n \n+// With non-local trait (#49841):\n+\n+use std::hash::{Hash, Hasher};\n+\n+struct X;\n+\n+impl Hash for X {\n+    fn hash(&self, hasher: &mut impl Hasher) {}\n+    //~^ Error method `hash` has incompatible signature for trait\n+}\n+\n fn main() {}"}]}