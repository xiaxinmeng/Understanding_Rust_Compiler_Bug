{"sha": "3f849a8b1edb11762194ef6f0f153a0e672c9112", "node_id": "C_kwDOAAsO6NoAKDNmODQ5YThiMWVkYjExNzYyMTk0ZWY2ZjBmMTUzYTBlNjcyYzkxMTI", "commit": {"author": {"name": "Ben Reeves", "email": "benwolverine2019@gmail.com", "date": "2021-12-27T06:24:19Z"}, "committer": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2022-01-28T23:42:24Z"}, "message": "Add test for old ICE in #89066", "tree": {"sha": "430af4ec7941fec59bcf3f076e562ddf82323ade", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/430af4ec7941fec59bcf3f076e562ddf82323ade"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3f849a8b1edb11762194ef6f0f153a0e672c9112", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3f849a8b1edb11762194ef6f0f153a0e672c9112", "html_url": "https://github.com/rust-lang/rust/commit/3f849a8b1edb11762194ef6f0f153a0e672c9112", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3f849a8b1edb11762194ef6f0f153a0e672c9112/comments", "author": {"login": "BGR360", "id": 13339928, "node_id": "MDQ6VXNlcjEzMzM5OTI4", "avatar_url": "https://avatars.githubusercontent.com/u/13339928?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BGR360", "html_url": "https://github.com/BGR360", "followers_url": "https://api.github.com/users/BGR360/followers", "following_url": "https://api.github.com/users/BGR360/following{/other_user}", "gists_url": "https://api.github.com/users/BGR360/gists{/gist_id}", "starred_url": "https://api.github.com/users/BGR360/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BGR360/subscriptions", "organizations_url": "https://api.github.com/users/BGR360/orgs", "repos_url": "https://api.github.com/users/BGR360/repos", "events_url": "https://api.github.com/users/BGR360/events{/privacy}", "received_events_url": "https://api.github.com/users/BGR360/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2819d9051c733e3777b884e9f5f653029e49cce0", "url": "https://api.github.com/repos/rust-lang/rust/commits/2819d9051c733e3777b884e9f5f653029e49cce0", "html_url": "https://github.com/rust-lang/rust/commit/2819d9051c733e3777b884e9f5f653029e49cce0"}], "stats": {"total": 67, "additions": 67, "deletions": 0}, "files": [{"sha": "2873f5237d4a1022871781aeb1662a5bd487cfd8", "filename": "src/test/ui/save-analysis/issue-89066.rs", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/3f849a8b1edb11762194ef6f0f153a0e672c9112/src%2Ftest%2Fui%2Fsave-analysis%2Fissue-89066.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3f849a8b1edb11762194ef6f0f153a0e672c9112/src%2Ftest%2Fui%2Fsave-analysis%2Fissue-89066.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsave-analysis%2Fissue-89066.rs?ref=3f849a8b1edb11762194ef6f0f153a0e672c9112", "patch": "@@ -0,0 +1,28 @@\n+// compile-flags: -Zsave-analysis\n+\n+// Check that this does not ICE.\n+// Stolen from src/test/ui/const-generics/generic_arg_infer/infer-arg-test.rs\n+\n+#![feature(generic_arg_infer)]\n+\n+struct All<'a, T, const N: usize> {\n+  v: &'a T,\n+}\n+\n+struct BadInfer<_>;\n+//~^ ERROR expected identifier\n+//~| ERROR parameter `_` is never used\n+\n+fn all_fn<'a, T, const N: usize>() {}\n+\n+fn bad_infer_fn<_>() {}\n+//~^ ERROR expected identifier\n+\n+\n+fn main() {\n+  let a: All<_, _, _>;\n+  //~^ ERROR this struct takes 2 generic arguments but 3 generic arguments were supplied\n+  all_fn();\n+  let v: [u8; _];\n+  let v: [u8; 10] = [0; _];\n+}"}, {"sha": "a3ff1c02b2a0480e98580a980837659b24c9af6c", "filename": "src/test/ui/save-analysis/issue-89066.stderr", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/3f849a8b1edb11762194ef6f0f153a0e672c9112/src%2Ftest%2Fui%2Fsave-analysis%2Fissue-89066.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3f849a8b1edb11762194ef6f0f153a0e672c9112/src%2Ftest%2Fui%2Fsave-analysis%2Fissue-89066.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsave-analysis%2Fissue-89066.stderr?ref=3f849a8b1edb11762194ef6f0f153a0e672c9112", "patch": "@@ -0,0 +1,39 @@\n+error: expected identifier, found reserved identifier `_`\n+  --> $DIR/issue-89066.rs:12:17\n+   |\n+LL | struct BadInfer<_>;\n+   |                 ^ expected identifier, found reserved identifier\n+\n+error: expected identifier, found reserved identifier `_`\n+  --> $DIR/issue-89066.rs:18:17\n+   |\n+LL | fn bad_infer_fn<_>() {}\n+   |                 ^ expected identifier, found reserved identifier\n+\n+error[E0392]: parameter `_` is never used\n+  --> $DIR/issue-89066.rs:12:17\n+   |\n+LL | struct BadInfer<_>;\n+   |                 ^ unused parameter\n+   |\n+   = help: consider removing `_`, referring to it in a field, or using a marker such as `PhantomData`\n+   = help: if you intended `_` to be a const parameter, use `const _: usize` instead\n+\n+error[E0107]: this struct takes 2 generic arguments but 3 generic arguments were supplied\n+  --> $DIR/issue-89066.rs:23:10\n+   |\n+LL |   let a: All<_, _, _>;\n+   |          ^^^       - help: remove this generic argument\n+   |          |\n+   |          expected 2 generic arguments\n+   |\n+note: struct defined here, with 2 generic parameters: `T`, `N`\n+  --> $DIR/issue-89066.rs:8:8\n+   |\n+LL | struct All<'a, T, const N: usize> {\n+   |        ^^^     -        -\n+\n+error: aborting due to 4 previous errors\n+\n+Some errors have detailed explanations: E0107, E0392.\n+For more information about an error, try `rustc --explain E0107`."}]}