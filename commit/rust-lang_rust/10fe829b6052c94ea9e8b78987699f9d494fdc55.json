{"sha": "10fe829b6052c94ea9e8b78987699f9d494fdc55", "node_id": "MDY6Q29tbWl0NzI0NzEyOjEwZmU4MjliNjA1MmM5NGVhOWU4Yjc4OTg3Njk5ZjlkNDk0ZmRjNTU=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2019-03-16T06:56:58Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2019-03-16T14:40:43Z"}, "message": "Rollup merge of #59180 - taiki-e:try_blocks, r=scottmcm\n\nUse try blocks in rustc_codegen_ssa\n\nr? @scottmcm", "tree": {"sha": "89189f4a6bc5eaad96293416ceb04937ed9a9179", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/89189f4a6bc5eaad96293416ceb04937ed9a9179"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/10fe829b6052c94ea9e8b78987699f9d494fdc55", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlyNCusACgkQ/vbIBR0O\nATwoTw/+MVtLO91XOvwxPL9iEicgTldEINM0CRtGlgVCUshpy59kUzuodzq7XDnS\n1jJVd9LVldkKzW/KkWYgNQMIJrN/07KEnO+2hD+Px98jkPJIq3Z9vhClyQQRk5Hk\nskHsu18v12x9L8yqhfEWlfUbW8m+SHoQkdoA/74TsYAqajrJVE0i7ChcVB7AqtnT\n+T937jEN1o4MnRpsS1jYf5pdy65bbJE/A7Yk1ND8D4Sk0trPs2P3yA0y2wocoQX3\nmpfG9mUrkBKL9efZnuBkik5RdQqPFGrQgK7MkUgSh9qYth64cnduZ0N14pOjpmV0\no6sUKB7RtayZsWFsu8sPTmn7/idx3FhQNGbdi6pwF2Z0dqir0J2Z6UJOaeaO+MwD\nuWjrFozPTi5C1bgabzaltxlV8zk57+SBd58rPI+wFsK2uVnL16iTVgA9Hqq6F5bI\nq3A7ZoJ7PsFmS43397VL6j+ZnLqydU913oSkYXNEjEOqNxijykdLiLazrexnIB3S\nxeR6sNON5H5qiS2qbM5LD2fLyrynOm8JpzKcvCLa6AV6rveluHX1zJy+4pcEelIx\noYUgYvuq541tp9mvTFXsmNZMata1WcUgFh8xR9/afYDtMiAujSozak6d5XQ05Iqw\nl7Tbr/a4mI0h6jAsNmyl4uJ8PgzAR2unctaOl4TzE33t1cvvN48=\n=MTKh\n-----END PGP SIGNATURE-----", "payload": "tree 89189f4a6bc5eaad96293416ceb04937ed9a9179\nparent 08959313bebd77a02db2d036a5b39714cba930bc\nparent ab19e5870ea28584ecf3ff4885e29afbbcaf0854\nauthor kennytm <kennytm@gmail.com> 1552719418 +0800\ncommitter kennytm <kennytm@gmail.com> 1552747243 +0800\n\nRollup merge of #59180 - taiki-e:try_blocks, r=scottmcm\n\nUse try blocks in rustc_codegen_ssa\n\nr? @scottmcm\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/10fe829b6052c94ea9e8b78987699f9d494fdc55", "html_url": "https://github.com/rust-lang/rust/commit/10fe829b6052c94ea9e8b78987699f9d494fdc55", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/10fe829b6052c94ea9e8b78987699f9d494fdc55/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "08959313bebd77a02db2d036a5b39714cba930bc", "url": "https://api.github.com/repos/rust-lang/rust/commits/08959313bebd77a02db2d036a5b39714cba930bc", "html_url": "https://github.com/rust-lang/rust/commit/08959313bebd77a02db2d036a5b39714cba930bc"}, {"sha": "ab19e5870ea28584ecf3ff4885e29afbbcaf0854", "url": "https://api.github.com/repos/rust-lang/rust/commits/ab19e5870ea28584ecf3ff4885e29afbbcaf0854", "html_url": "https://github.com/rust-lang/rust/commit/ab19e5870ea28584ecf3ff4885e29afbbcaf0854"}], "stats": {"total": 16, "additions": 7, "deletions": 9}, "files": [{"sha": "e6470dbb61ce18649625555d582ede8430586b6a", "filename": "src/librustc_codegen_ssa/back/linker.rs", "status": "modified", "additions": 6, "deletions": 9, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/10fe829b6052c94ea9e8b78987699f9d494fdc55/src%2Flibrustc_codegen_ssa%2Fback%2Flinker.rs", "raw_url": "https://github.com/rust-lang/rust/raw/10fe829b6052c94ea9e8b78987699f9d494fdc55/src%2Flibrustc_codegen_ssa%2Fback%2Flinker.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Fback%2Flinker.rs?ref=10fe829b6052c94ea9e8b78987699f9d494fdc55", "patch": "@@ -382,29 +382,27 @@ impl<'a> Linker for GccLinker<'a> {\n \n         if self.sess.target.target.options.is_like_osx {\n             // Write a plain, newline-separated list of symbols\n-            let res = (|| -> io::Result<()> {\n+            let res: io::Result<()> = try {\n                 let mut f = BufWriter::new(File::create(&path)?);\n                 for sym in self.info.exports[&crate_type].iter() {\n                     debug!(\"  _{}\", sym);\n                     writeln!(f, \"_{}\", sym)?;\n                 }\n-                Ok(())\n-            })();\n+            };\n             if let Err(e) = res {\n                 self.sess.fatal(&format!(\"failed to write lib.def file: {}\", e));\n             }\n         } else {\n             // Write an LD version script\n-            let res = (|| -> io::Result<()> {\n+            let res: io::Result<()> = try {\n                 let mut f = BufWriter::new(File::create(&path)?);\n                 writeln!(f, \"{{\\n  global:\")?;\n                 for sym in self.info.exports[&crate_type].iter() {\n                     debug!(\"    {};\", sym);\n                     writeln!(f, \"    {};\", sym)?;\n                 }\n                 writeln!(f, \"\\n  local:\\n    *;\\n}};\")?;\n-                Ok(())\n-            })();\n+            };\n             if let Err(e) = res {\n                 self.sess.fatal(&format!(\"failed to write version script: {}\", e));\n             }\n@@ -644,7 +642,7 @@ impl<'a> Linker for MsvcLinker<'a> {\n                       tmpdir: &Path,\n                       crate_type: CrateType) {\n         let path = tmpdir.join(\"lib.def\");\n-        let res = (|| -> io::Result<()> {\n+        let res: io::Result<()> = try {\n             let mut f = BufWriter::new(File::create(&path)?);\n \n             // Start off with the standard module name header and then go\n@@ -655,8 +653,7 @@ impl<'a> Linker for MsvcLinker<'a> {\n                 debug!(\"  _{}\", symbol);\n                 writeln!(f, \"  {}\", symbol)?;\n             }\n-            Ok(())\n-        })();\n+        };\n         if let Err(e) = res {\n             self.sess.fatal(&format!(\"failed to write lib.def file: {}\", e));\n         }"}, {"sha": "fe9b88c85f009fc5507ef57390d94284287a9e8a", "filename": "src/librustc_codegen_ssa/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/10fe829b6052c94ea9e8b78987699f9d494fdc55/src%2Flibrustc_codegen_ssa%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/10fe829b6052c94ea9e8b78987699f9d494fdc55/src%2Flibrustc_codegen_ssa%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Flib.rs?ref=10fe829b6052c94ea9e8b78987699f9d494fdc55", "patch": "@@ -7,6 +7,7 @@\n #![feature(libc)]\n #![feature(rustc_diagnostic_macros)]\n #![feature(stmt_expr_attributes)]\n+#![feature(try_blocks)]\n #![feature(in_band_lifetimes)]\n #![feature(nll)]\n #![allow(unused_attributes)]"}]}