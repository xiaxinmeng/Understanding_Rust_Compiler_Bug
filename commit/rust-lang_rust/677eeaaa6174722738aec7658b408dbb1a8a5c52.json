{"sha": "677eeaaa6174722738aec7658b408dbb1a8a5c52", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY3N2VlYWFhNjE3NDcyMjczOGFlYzc2NThiNDA4ZGJiMWE4YTVjNTI=", "commit": {"author": {"name": "Bastien Orivel", "email": "eijebong@bananium.fr", "date": "2018-05-08T20:11:58Z"}, "committer": {"name": "Bastien Orivel", "email": "eijebong@bananium.fr", "date": "2018-06-20T17:28:27Z"}, "message": "Replace tempdir by tempfile in librustc_trans", "tree": {"sha": "0217c558078bf6ab4d2596d9844813c741bb1a21", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0217c558078bf6ab4d2596d9844813c741bb1a21"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/677eeaaa6174722738aec7658b408dbb1a8a5c52", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/677eeaaa6174722738aec7658b408dbb1a8a5c52", "html_url": "https://github.com/rust-lang/rust/commit/677eeaaa6174722738aec7658b408dbb1a8a5c52", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/677eeaaa6174722738aec7658b408dbb1a8a5c52/comments", "author": {"login": "Eijebong", "id": 3650385, "node_id": "MDQ6VXNlcjM2NTAzODU=", "avatar_url": "https://avatars.githubusercontent.com/u/3650385?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Eijebong", "html_url": "https://github.com/Eijebong", "followers_url": "https://api.github.com/users/Eijebong/followers", "following_url": "https://api.github.com/users/Eijebong/following{/other_user}", "gists_url": "https://api.github.com/users/Eijebong/gists{/gist_id}", "starred_url": "https://api.github.com/users/Eijebong/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Eijebong/subscriptions", "organizations_url": "https://api.github.com/users/Eijebong/orgs", "repos_url": "https://api.github.com/users/Eijebong/repos", "events_url": "https://api.github.com/users/Eijebong/events{/privacy}", "received_events_url": "https://api.github.com/users/Eijebong/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Eijebong", "id": 3650385, "node_id": "MDQ6VXNlcjM2NTAzODU=", "avatar_url": "https://avatars.githubusercontent.com/u/3650385?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Eijebong", "html_url": "https://github.com/Eijebong", "followers_url": "https://api.github.com/users/Eijebong/followers", "following_url": "https://api.github.com/users/Eijebong/following{/other_user}", "gists_url": "https://api.github.com/users/Eijebong/gists{/gist_id}", "starred_url": "https://api.github.com/users/Eijebong/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Eijebong/subscriptions", "organizations_url": "https://api.github.com/users/Eijebong/orgs", "repos_url": "https://api.github.com/users/Eijebong/repos", "events_url": "https://api.github.com/users/Eijebong/events{/privacy}", "received_events_url": "https://api.github.com/users/Eijebong/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ae9a27185ec77503c602264305ec3d62f469d66e", "url": "https://api.github.com/repos/rust-lang/rust/commits/ae9a27185ec77503c602264305ec3d62f469d66e", "html_url": "https://github.com/rust-lang/rust/commit/ae9a27185ec77503c602264305ec3d62f469d66e"}], "stats": {"total": 12, "additions": 6, "deletions": 6}, "files": [{"sha": "4bf704cd409567ce81e6fae8c2e85b976e697ae4", "filename": "src/Cargo.lock", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/677eeaaa6174722738aec7658b408dbb1a8a5c52/src%2FCargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/677eeaaa6174722738aec7658b408dbb1a8a5c52/src%2FCargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2FCargo.lock?ref=677eeaaa6174722738aec7658b408dbb1a8a5c52", "patch": "@@ -2103,7 +2103,7 @@ dependencies = [\n  \"serialize 0.0.0\",\n  \"syntax 0.0.0\",\n  \"syntax_pos 0.0.0\",\n- \"tempdir 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"tempfile 3.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]"}, {"sha": "6ddae57e336ede3c2059cf1105b1a35ca1701d4c", "filename": "src/librustc_codegen_llvm/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/677eeaaa6174722738aec7658b408dbb1a8a5c52/src%2Flibrustc_codegen_llvm%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/677eeaaa6174722738aec7658b408dbb1a8a5c52/src%2Flibrustc_codegen_llvm%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2FCargo.toml?ref=677eeaaa6174722738aec7658b408dbb1a8a5c52", "patch": "@@ -32,7 +32,7 @@ rustc_mir = { path = \"../librustc_mir\" }\n serialize = { path = \"../libserialize\" }\n syntax = { path = \"../libsyntax\" }\n syntax_pos = { path = \"../libsyntax_pos\" }\n-tempdir = \"0.3\"\n+tempfile = \"3.0\"\n \n # not actually used but needed to make sure we enable the same feature set as\n # winapi used in librustc"}, {"sha": "be336e93112c3a5535a0b32636f810729e48f602", "filename": "src/librustc_codegen_llvm/back/link.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/677eeaaa6174722738aec7658b408dbb1a8a5c52/src%2Flibrustc_codegen_llvm%2Fback%2Flink.rs", "raw_url": "https://github.com/rust-lang/rust/raw/677eeaaa6174722738aec7658b408dbb1a8a5c52/src%2Flibrustc_codegen_llvm%2Fback%2Flink.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Fback%2Flink.rs?ref=677eeaaa6174722738aec7658b408dbb1a8a5c52", "patch": "@@ -28,7 +28,7 @@ use {CodegenResults, CrateInfo};\n use rustc::util::common::time;\n use rustc::util::fs::fix_windows_verbatim_for_gcc;\n use rustc::hir::def_id::CrateNum;\n-use tempdir::TempDir;\n+use tempfile::{Builder as TempFileBuilder, TempDir};\n use rustc_target::spec::{PanicStrategy, RelroLevel, LinkerFlavor, TargetTriple};\n use rustc_data_structures::fx::FxHashSet;\n use context::get_reloc_model;\n@@ -321,7 +321,7 @@ fn link_binary_output(sess: &Session,\n         // final destination, with a `fs::rename` call. In order for the rename to\n         // always succeed, the temporary file needs to be on the same filesystem,\n         // which is why we create it inside the output directory specifically.\n-        let metadata_tmpdir = match TempDir::new_in(out_filename.parent().unwrap(), \"rmeta\") {\n+        let metadata_tmpdir = match TempFileBuilder::new().prefix(\"rmeta\").tempdir_in(out_filename.parent().unwrap()) {\n             Ok(tmpdir) => tmpdir,\n             Err(err) => sess.fatal(&format!(\"couldn't create a temp dir: {}\", err)),\n         };\n@@ -332,7 +332,7 @@ fn link_binary_output(sess: &Session,\n         out_filenames.push(out_filename);\n     }\n \n-    let tmpdir = match TempDir::new(\"rustc\") {\n+    let tmpdir = match TempFileBuilder::new().prefix(\"rustc\").tempdir() {\n         Ok(tmpdir) => tmpdir,\n         Err(err) => sess.fatal(&format!(\"couldn't create a temp dir: {}\", err)),\n     };"}, {"sha": "b11b0c7abe875b11b3a3bd184768ef00e330e17b", "filename": "src/librustc_codegen_llvm/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/677eeaaa6174722738aec7658b408dbb1a8a5c52/src%2Flibrustc_codegen_llvm%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/677eeaaa6174722738aec7658b408dbb1a8a5c52/src%2Flibrustc_codegen_llvm%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Flib.rs?ref=677eeaaa6174722738aec7658b408dbb1a8a5c52", "patch": "@@ -56,7 +56,7 @@ extern crate syntax_pos;\n extern crate rustc_errors as errors;\n extern crate serialize;\n extern crate cc; // Used to locate MSVC\n-extern crate tempdir;\n+extern crate tempfile;\n \n use back::bytecode::RLIB_BYTECODE_EXTENSION;\n "}]}