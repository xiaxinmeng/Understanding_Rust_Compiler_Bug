{"sha": "2e6fc3e2c060b8b093a49e6a10e3468ca644d963", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJlNmZjM2UyYzA2MGI4YjA5M2E0OWU2YTEwZTM0NjhjYTY0NGQ5NjM=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2018-07-23T09:37:03Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2018-07-23T09:37:03Z"}, "message": "Auto merge of #52211 - bjorn3:misc_rustdoc_changes, r=QuietMisdreavus\n\nMisc rustdoc changes", "tree": {"sha": "c4cebc6200c41f4eb75a630ad8b48046adcd03a4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c4cebc6200c41f4eb75a630ad8b48046adcd03a4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2e6fc3e2c060b8b093a49e6a10e3468ca644d963", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2e6fc3e2c060b8b093a49e6a10e3468ca644d963", "html_url": "https://github.com/rust-lang/rust/commit/2e6fc3e2c060b8b093a49e6a10e3468ca644d963", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2e6fc3e2c060b8b093a49e6a10e3468ca644d963/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3900bf8ae3aafdd3ab13a0e6400d47bc5cb2e121", "url": "https://api.github.com/repos/rust-lang/rust/commits/3900bf8ae3aafdd3ab13a0e6400d47bc5cb2e121", "html_url": "https://github.com/rust-lang/rust/commit/3900bf8ae3aafdd3ab13a0e6400d47bc5cb2e121"}, {"sha": "55c11e3db49558fe231867a436f7adb997e43b7b", "url": "https://api.github.com/repos/rust-lang/rust/commits/55c11e3db49558fe231867a436f7adb997e43b7b", "html_url": "https://github.com/rust-lang/rust/commit/55c11e3db49558fe231867a436f7adb997e43b7b"}], "stats": {"total": 20, "additions": 4, "deletions": 16}, "files": [{"sha": "98684b27973bc660bc351bfc9b2feff15652ceb9", "filename": "src/librustdoc/clean/mod.rs", "status": "modified", "additions": 0, "deletions": 8, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/2e6fc3e2c060b8b093a49e6a10e3468ca644d963/src%2Flibrustdoc%2Fclean%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2e6fc3e2c060b8b093a49e6a10e3468ca644d963/src%2Flibrustdoc%2Fclean%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Fmod.rs?ref=2e6fc3e2c060b8b093a49e6a10e3468ca644d963", "patch": "@@ -4435,14 +4435,6 @@ where\n \n // Start of code copied from rust-clippy\n \n-pub fn get_trait_def_id(tcx: &TyCtxt, path: &[&str], use_local: bool) -> Option<DefId> {\n-    if use_local {\n-        path_to_def_local(tcx, path)\n-    } else {\n-        path_to_def(tcx, path)\n-    }\n-}\n-\n pub fn path_to_def_local(tcx: &TyCtxt, path: &[&str]) -> Option<DefId> {\n     let krate = tcx.hir.krate();\n     let mut items = krate.module.item_ids.clone();"}, {"sha": "6e1b45895474a5848ea3977b386c08269f84c6be", "filename": "src/librustdoc/core.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/2e6fc3e2c060b8b093a49e6a10e3468ca644d963/src%2Flibrustdoc%2Fcore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2e6fc3e2c060b8b093a49e6a10e3468ca644d963/src%2Flibrustdoc%2Fcore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fcore.rs?ref=2e6fc3e2c060b8b093a49e6a10e3468ca644d963", "patch": "@@ -362,9 +362,9 @@ pub fn run_core(search_paths: SearchPaths,\n             };\n \n             let send_trait = if crate_name == Some(\"core\".to_string()) {\n-                clean::get_trait_def_id(&tcx, &[\"marker\", \"Send\"], true)\n+                clean::path_to_def_local(&tcx, &[\"marker\", \"Send\"])\n             } else {\n-                clean::get_trait_def_id(&tcx, &[\"core\", \"marker\", \"Send\"], false)\n+                clean::path_to_def(&tcx, &[\"core\", \"marker\", \"Send\"])\n             };\n \n             let ctxt = DocContext {\n@@ -390,7 +390,7 @@ pub fn run_core(search_paths: SearchPaths,\n             debug!(\"crate: {:?}\", tcx.hir.krate());\n \n             let krate = {\n-                let mut v = RustdocVisitor::new(&*cstore, &ctxt);\n+                let mut v = RustdocVisitor::new(&ctxt);\n                 v.visit(tcx.hir.krate());\n                 v.clean(&ctxt)\n             };"}, {"sha": "09d304b71a2c1627adb424e0742b253b256945f3", "filename": "src/librustdoc/visit_ast.rs", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/2e6fc3e2c060b8b093a49e6a10e3468ca644d963/src%2Flibrustdoc%2Fvisit_ast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2e6fc3e2c060b8b093a49e6a10e3468ca644d963/src%2Flibrustdoc%2Fvisit_ast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fvisit_ast.rs?ref=2e6fc3e2c060b8b093a49e6a10e3468ca644d963", "patch": "@@ -21,7 +21,6 @@ use syntax_pos::{self, Span};\n use rustc::hir::map as hir_map;\n use rustc::hir::def::Def;\n use rustc::hir::def_id::{DefId, LOCAL_CRATE};\n-use rustc::middle::cstore::CrateStore;\n use rustc::middle::privacy::AccessLevel;\n use rustc::util::nodemap::{FxHashSet, FxHashMap};\n \n@@ -40,7 +39,6 @@ use doctree::*;\n // framework from syntax?\n \n pub struct RustdocVisitor<'a, 'tcx: 'a, 'rcx: 'a> {\n-    pub cstore: &'a CrateStore,\n     pub module: Module,\n     pub attrs: hir::HirVec<ast::Attribute>,\n     pub cx: &'a core::DocContext<'a, 'tcx, 'rcx>,\n@@ -52,8 +50,7 @@ pub struct RustdocVisitor<'a, 'tcx: 'a, 'rcx: 'a> {\n }\n \n impl<'a, 'tcx, 'rcx> RustdocVisitor<'a, 'tcx, 'rcx> {\n-    pub fn new(cstore: &'a CrateStore,\n-               cx: &'a core::DocContext<'a, 'tcx, 'rcx>) -> RustdocVisitor<'a, 'tcx, 'rcx> {\n+    pub fn new(cx: &'a core::DocContext<'a, 'tcx, 'rcx>) -> RustdocVisitor<'a, 'tcx, 'rcx> {\n         // If the root is re-exported, terminate all recursion.\n         let mut stack = FxHashSet();\n         stack.insert(ast::CRATE_NODE_ID);\n@@ -65,7 +62,6 @@ impl<'a, 'tcx, 'rcx> RustdocVisitor<'a, 'tcx, 'rcx> {\n             inlining: false,\n             inside_public_path: true,\n             exact_paths: Some(FxHashMap()),\n-            cstore,\n         }\n     }\n "}]}