{"sha": "9787321841d604b792be107e91bcca8ee1ecfd52", "node_id": "C_kwDOAAsO6NoAKDk3ODczMjE4NDFkNjA0Yjc5MmJlMTA3ZTkxYmNjYThlZTFlY2ZkNTI", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-10-14T12:55:11Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-10-14T12:55:11Z"}, "message": "Clean up rust-logo rustdoc GUI test", "tree": {"sha": "40197cddd8a3c9043757b6b2193dee73faa8c116", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/40197cddd8a3c9043757b6b2193dee73faa8c116"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9787321841d604b792be107e91bcca8ee1ecfd52", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9787321841d604b792be107e91bcca8ee1ecfd52", "html_url": "https://github.com/rust-lang/rust/commit/9787321841d604b792be107e91bcca8ee1ecfd52", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9787321841d604b792be107e91bcca8ee1ecfd52/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1755c8530287d9f29d8d188e5d7a57f6aa35cf7f", "url": "https://api.github.com/repos/rust-lang/rust/commits/1755c8530287d9f29d8d188e5d7a57f6aa35cf7f", "html_url": "https://github.com/rust-lang/rust/commit/1755c8530287d9f29d8d188e5d7a57f6aa35cf7f"}], "stats": {"total": 96, "additions": 26, "deletions": 70}, "files": [{"sha": "6c8dc85941931b2886346c08305c7fa562da544b", "filename": "src/test/rustdoc-gui/rust-logo.goml", "status": "modified", "additions": 26, "deletions": 70, "changes": 96, "blob_url": "https://github.com/rust-lang/rust/blob/9787321841d604b792be107e91bcca8ee1ecfd52/src%2Ftest%2Frustdoc-gui%2Frust-logo.goml", "raw_url": "https://github.com/rust-lang/rust/raw/9787321841d604b792be107e91bcca8ee1ecfd52/src%2Ftest%2Frustdoc-gui%2Frust-logo.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Frust-logo.goml?ref=9787321841d604b792be107e91bcca8ee1ecfd52", "patch": "@@ -1,78 +1,34 @@\n // This test ensures that the correct style is applied to the rust logo in the sidebar.\n goto: \"file://\" + |DOC_PATH| + \"/test_docs/index.html\"\n \n-// First we start with the dark theme.\n-local-storage: {\n-    \"rustdoc-theme\": \"dark\",\n-    \"rustdoc-preferred-dark-theme\": \"dark\",\n-    \"rustdoc-use-system-theme\": \"false\",\n-}\n-reload:\n-\n-assert-css: (\n-    \".rust-logo\",\n-    {\"filter\": \"drop-shadow(rgb(255, 255, 255) 1px 0px 0px) drop-shadow(rgb(255, 255, 255) 0px 1px 0px) drop-shadow(rgb(255, 255, 255) -1px 0px 0px) drop-shadow(rgb(255, 255, 255) 0px -1px 0px)\"},\n+define-function: (\n+    \"check-logo\",\n+    (theme, filter),\n+    [\n+        // Going to the doc page.\n+        (\"goto\", \"file://\" + |DOC_PATH| + \"/test_docs/index.html\"),\n+        // Changing theme.\n+        (\"local-storage\", {\"rustdoc-theme\": |theme|, \"rustdoc-use-system-theme\": \"false\"}),\n+        (\"reload\"),\n+        (\"assert-css\", (\".rust-logo\", {\"filter\": |filter|})),\n+        // Going to the source code page.\n+        (\"goto\", \"file://\" + |DOC_PATH| + \"/src/test_docs/lib.rs.html\"),\n+        // Changing theme (since it's local files, the local storage works by folder).\n+        (\"local-storage\", {\"rustdoc-theme\": |theme|, \"rustdoc-use-system-theme\": \"false\"}),\n+        (\"reload\"),\n+        (\"assert-css\", (\".rust-logo\", {\"filter\": |filter|})),\n+    ],\n )\n \n-// In the source view page now.\n-goto: \"file://\" + |DOC_PATH| + \"/src/test_docs/lib.rs.html\"\n-\n-local-storage: {\n-    \"rustdoc-theme\": \"dark\",\n-    \"rustdoc-preferred-dark-theme\": \"dark\",\n-    \"rustdoc-use-system-theme\": \"false\",\n-}\n-reload:\n-\n-assert-css: (\n-    \".rust-logo\",\n-    {\"filter\": \"drop-shadow(rgb(255, 255, 255) 1px 0px 0px) drop-shadow(rgb(255, 255, 255) 0px 1px 0px) drop-shadow(rgb(255, 255, 255) -1px 0px 0px) drop-shadow(rgb(255, 255, 255) 0px -1px 0px)\"},\n+call-function: (\n+    \"check-logo\",\n+    (\"ayu\", \"drop-shadow(rgb(255, 255, 255) 1px 0px 0px) drop-shadow(rgb(255, 255, 255) 0px 1px 0px) drop-shadow(rgb(255, 255, 255) -1px 0px 0px) drop-shadow(rgb(255, 255, 255) 0px -1px 0px)\"),\n )\n-\n-// Then with the ayu theme.\n-local-storage: {\n-    \"rustdoc-theme\": \"ayu\",\n-    \"rustdoc-preferred-dark-theme\": \"ayu\",\n-    \"rustdoc-use-system-theme\": \"false\",\n-}\n-reload:\n-\n-assert-css: (\n-    \".rust-logo\",\n-    {\"filter\": \"drop-shadow(rgb(255, 255, 255) 1px 0px 0px) drop-shadow(rgb(255, 255, 255) 0px 1px 0px) drop-shadow(rgb(255, 255, 255) -1px 0px 0px) drop-shadow(rgb(255, 255, 255) 0px -1px 0px)\"},\n+call-function: (\n+    \"check-logo\",\n+    (\"dark\", \"drop-shadow(rgb(255, 255, 255) 1px 0px 0px) drop-shadow(rgb(255, 255, 255) 0px 1px 0px) drop-shadow(rgb(255, 255, 255) -1px 0px 0px) drop-shadow(rgb(255, 255, 255) 0px -1px 0px)\"),\n )\n-\n-// In the source view page now.\n-goto: \"file://\" + |DOC_PATH| + \"/src/test_docs/lib.rs.html\"\n-\n-local-storage: {\n-    \"rustdoc-theme\": \"ayu\",\n-    \"rustdoc-preferred-dark-theme\": \"ayu\",\n-    \"rustdoc-use-system-theme\": \"false\",\n-}\n-reload:\n-\n-assert-css: (\n-    \".rust-logo\",\n-    {\"filter\": \"drop-shadow(rgb(255, 255, 255) 1px 0px 0px) drop-shadow(rgb(255, 255, 255) 0px 1px 0px) drop-shadow(rgb(255, 255, 255) -1px 0px 0px) drop-shadow(rgb(255, 255, 255) 0px -1px 0px)\"},\n-)\n-\n-// And finally with the light theme.\n-local-storage: {\"rustdoc-theme\": \"light\", \"rustdoc-use-system-theme\": \"false\"}\n-reload:\n-\n-assert-css: (\n-    \".rust-logo\",\n-    {\"filter\": \"none\"},\n-)\n-\n-// In the source view page now.\n-goto: \"file://\" + |DOC_PATH| + \"/src/test_docs/lib.rs.html\"\n-\n-local-storage: {\"rustdoc-theme\": \"light\", \"rustdoc-use-system-theme\": \"false\"}\n-reload:\n-\n-assert-css: (\n-    \".rust-logo\",\n-    {\"filter\": \"none\"},\n+call-function: (\n+    \"check-logo\",\n+    (\"light\", \"none\"),\n )"}]}