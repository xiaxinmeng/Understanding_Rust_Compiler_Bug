{"sha": "8216b5fc10e7c7b0d4e9f40bb4f9fdaaaebf9400", "node_id": "MDY6Q29tbWl0NzI0NzEyOjgyMTZiNWZjMTBlN2M3YjBkNGU5ZjQwYmI0ZjlmZGFhYWViZjk0MDA=", "commit": {"author": {"name": "Brian Anderson", "email": "andersrb@gmail.com", "date": "2011-04-27T00:49:03Z"}, "committer": {"name": "Brian Anderson", "email": "andersrb@gmail.com", "date": "2011-04-27T00:49:03Z"}, "message": "Fix the interaction between various flags in #fmt", "tree": {"sha": "b7dddff0dda11e1eae672740185f8431952b317b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b7dddff0dda11e1eae672740185f8431952b317b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8216b5fc10e7c7b0d4e9f40bb4f9fdaaaebf9400", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8216b5fc10e7c7b0d4e9f40bb4f9fdaaaebf9400", "html_url": "https://github.com/rust-lang/rust/commit/8216b5fc10e7c7b0d4e9f40bb4f9fdaaaebf9400", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8216b5fc10e7c7b0d4e9f40bb4f9fdaaaebf9400/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2e12fbfc06abdf1547528047b1438204ca4121a1", "url": "https://api.github.com/repos/rust-lang/rust/commits/2e12fbfc06abdf1547528047b1438204ca4121a1", "html_url": "https://github.com/rust-lang/rust/commit/2e12fbfc06abdf1547528047b1438204ca4121a1"}], "stats": {"total": 38, "additions": 29, "deletions": 9}, "files": [{"sha": "c71e49a39b2142b668abd909d819a105bb9cb4c2", "filename": "src/lib/ExtFmt.rs", "status": "modified", "additions": 12, "deletions": 7, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/8216b5fc10e7c7b0d4e9f40bb4f9fdaaaebf9400/src%2Flib%2FExtFmt.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8216b5fc10e7c7b0d4e9f40bb4f9fdaaaebf9400/src%2Flib%2FExtFmt.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib%2FExtFmt.rs?ref=8216b5fc10e7c7b0d4e9f40bb4f9fdaaaebf9400", "patch": "@@ -532,15 +532,20 @@ mod RT {\n         // instead.\n         if (signed\n             && zero_padding\n-            && _str.byte_len(s) > 0u\n-            && s.(0) == '-' as u8) {\n+            && _str.byte_len(s) > 0u) {\n \n-            auto bytelen = _str.byte_len(s);\n-            auto numpart = _str.substr(s, 1u, bytelen - 1u);\n-            ret \"-\" + padstr + numpart;\n-        } else {\n-            ret padstr + s;\n+            auto head = s.(0);\n+            if (head == '+' as u8\n+                || head == '-' as u8\n+                || head == ' ' as u8) {\n+\n+                auto headstr = _str.unsafe_from_bytes(vec(head));\n+                auto bytelen = _str.byte_len(s);\n+                auto numpart = _str.substr(s, 1u, bytelen - 1u);\n+                ret headstr + padstr + numpart;\n+            }\n         }\n+        ret padstr + s;\n     }\n \n     fn have_flag(vec[flag] flags, flag f) -> bool {"}, {"sha": "82b3e658a63786f997a3d2e9aebd17ac257159d4", "filename": "src/test/run-pass/syntax-extension-fmt.rs", "status": "modified", "additions": 17, "deletions": 2, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/8216b5fc10e7c7b0d4e9f40bb4f9fdaaaebf9400/src%2Ftest%2Frun-pass%2Fsyntax-extension-fmt.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8216b5fc10e7c7b0d4e9f40bb4f9fdaaaebf9400/src%2Ftest%2Frun-pass%2Fsyntax-extension-fmt.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fsyntax-extension-fmt.rs?ref=8216b5fc10e7c7b0d4e9f40bb4f9fdaaaebf9400", "patch": "@@ -175,6 +175,21 @@ fn main() {\n   test(#fmt(\"%06.5X\", 127u), \" 0007F\");\n   test(#fmt(\"%06.5o\", 10u), \" 00012\");\n \n-  // TODO: Padding and +\n-  // TODO: Padding and ' '\n+  // Signed combinations\n+  test(#fmt(\"% 5d\", 1), \"    1\");\n+  test(#fmt(\"% 5d\", -1), \"   -1\");\n+  test(#fmt(\"%+5d\", 1), \"   +1\");\n+  test(#fmt(\"%+5d\", -1), \"   -1\");\n+  test(#fmt(\"% 05d\", 1), \" 0001\");\n+  test(#fmt(\"% 05d\", -1), \"-0001\");\n+  test(#fmt(\"%+05d\", 1), \"+0001\");\n+  test(#fmt(\"%+05d\", -1), \"-0001\");\n+  test(#fmt(\"%- 5d\", 1), \" 1   \");\n+  test(#fmt(\"%- 5d\", -1), \"-1   \");\n+  test(#fmt(\"%-+5d\", 1), \"+1   \");\n+  test(#fmt(\"%-+5d\", -1), \"-1   \");\n+  test(#fmt(\"%- 05d\", 1), \" 1   \");\n+  test(#fmt(\"%- 05d\", -1), \"-1   \");\n+  test(#fmt(\"%-+05d\", 1), \"+1   \");\n+  test(#fmt(\"%-+05d\", -1), \"-1   \");\n }"}]}