{"sha": "62590288621fe9c1fd9b379ed613538f7225f3eb", "node_id": "C_kwDOAAsO6NoAKDYyNTkwMjg4NjIxZmU5YzFmZDliMzc5ZWQ2MTM1MzhmNzIyNWYzZWI", "commit": {"author": {"name": "Arthur Carcano", "email": "arthur.carcano@ocamlpro.com", "date": "2022-11-30T22:31:42Z"}, "committer": {"name": "Arthur Carcano", "email": "arthur.carcano@ocamlpro.com", "date": "2022-11-30T22:45:01Z"}, "message": "Add test for regression for FileType equality\n\nCf: https://github.com/rust-lang/rust/issues/104900", "tree": {"sha": "c70bc1c91d2b94f3a478840aede012b58ebf032f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c70bc1c91d2b94f3a478840aede012b58ebf032f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/62590288621fe9c1fd9b379ed613538f7225f3eb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/62590288621fe9c1fd9b379ed613538f7225f3eb", "html_url": "https://github.com/rust-lang/rust/commit/62590288621fe9c1fd9b379ed613538f7225f3eb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/62590288621fe9c1fd9b379ed613538f7225f3eb/comments", "author": {"login": "krtab", "id": 53921575, "node_id": "MDQ6VXNlcjUzOTIxNTc1", "avatar_url": "https://avatars.githubusercontent.com/u/53921575?v=4", "gravatar_id": "", "url": "https://api.github.com/users/krtab", "html_url": "https://github.com/krtab", "followers_url": "https://api.github.com/users/krtab/followers", "following_url": "https://api.github.com/users/krtab/following{/other_user}", "gists_url": "https://api.github.com/users/krtab/gists{/gist_id}", "starred_url": "https://api.github.com/users/krtab/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/krtab/subscriptions", "organizations_url": "https://api.github.com/users/krtab/orgs", "repos_url": "https://api.github.com/users/krtab/repos", "events_url": "https://api.github.com/users/krtab/events{/privacy}", "received_events_url": "https://api.github.com/users/krtab/received_events", "type": "User", "site_admin": false}, "committer": {"login": "krtab", "id": 53921575, "node_id": "MDQ6VXNlcjUzOTIxNTc1", "avatar_url": "https://avatars.githubusercontent.com/u/53921575?v=4", "gravatar_id": "", "url": "https://api.github.com/users/krtab", "html_url": "https://github.com/krtab", "followers_url": "https://api.github.com/users/krtab/followers", "following_url": "https://api.github.com/users/krtab/following{/other_user}", "gists_url": "https://api.github.com/users/krtab/gists{/gist_id}", "starred_url": "https://api.github.com/users/krtab/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/krtab/subscriptions", "organizations_url": "https://api.github.com/users/krtab/orgs", "repos_url": "https://api.github.com/users/krtab/repos", "events_url": "https://api.github.com/users/krtab/events{/privacy}", "received_events_url": "https://api.github.com/users/krtab/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "77005950f09d2f9ba54962bf5adc3f2bc3a7213f", "url": "https://api.github.com/repos/rust-lang/rust/commits/77005950f09d2f9ba54962bf5adc3f2bc3a7213f", "html_url": "https://github.com/rust-lang/rust/commit/77005950f09d2f9ba54962bf5adc3f2bc3a7213f"}], "stats": {"total": 16, "additions": 16, "deletions": 0}, "files": [{"sha": "4748ac9d97ef8fda19d11f2d2f48e403ef466fae", "filename": "library/std/src/fs/tests.rs", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/62590288621fe9c1fd9b379ed613538f7225f3eb/library%2Fstd%2Fsrc%2Ffs%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/62590288621fe9c1fd9b379ed613538f7225f3eb/library%2Fstd%2Fsrc%2Ffs%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Ffs%2Ftests.rs?ref=62590288621fe9c1fd9b379ed613538f7225f3eb", "patch": "@@ -1551,3 +1551,19 @@ fn hiberfil_sys() {\n     fs::metadata(hiberfil).unwrap();\n     assert_eq!(true, hiberfil.exists());\n }\n+\n+/// Test that two different ways of obtaining the FileType give the same result.\n+/// Cf. https://github.com/rust-lang/rust/issues/104900\n+#[test]\n+fn test_eq_direntry_metadata() {\n+    let tmpdir = tmpdir();\n+    let file_path = tmpdir.join(\"file\");\n+    File::create(file_path).unwrap();\n+    for e in fs::read_dir(tmpdir.path()).unwrap() {\n+        let e = e.unwrap();\n+        let p = e.path();\n+        let ft1 = e.file_type().unwrap();\n+        let ft2 = p.metadata().unwrap().file_type();\n+        assert_eq!(ft1, ft2);\n+    }\n+}"}]}