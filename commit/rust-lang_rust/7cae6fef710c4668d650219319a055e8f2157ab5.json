{"sha": "7cae6fef710c4668d650219319a055e8f2157ab5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdjYWU2ZmVmNzEwYzQ2NjhkNjUwMjE5MzE5YTA1NWU4ZjIxNTdhYjU=", "commit": {"author": {"name": "Jimmy Brush", "email": "code@jimmah.com", "date": "2018-03-24T14:01:46Z"}, "committer": {"name": "Jimmy Brush", "email": "code@jimmah.com", "date": "2018-03-24T14:01:46Z"}, "message": "don't pass -no-pie to gnu ld\n\nfixes #48884", "tree": {"sha": "5449602571207746d1aa3eb394c8fefc76c9f41b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5449602571207746d1aa3eb394c8fefc76c9f41b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7cae6fef710c4668d650219319a055e8f2157ab5", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA1EtiBaDzGKsVzCxjAopB5kfVmQFAlq2WsAACgkQjAopB5kf\nVmTzow/+JupXXhEmsQYf/SX7zaqNPMOmkwuTvCtwfETW8/+PCiFcsy461AhgTNJk\nAp9uiNTkgmCjHvhTfGm9UzY5qJu0VOigxtsJ2kNjv5sp5IHxoAa9Dq/CSxykuU0z\nVlJpDdFs/lhhRUc9MOO6oaKOVVYmYSOXh3Asf43uIcEjnnNqE5oWT3mHN1WzfcR1\nVaNkz9ogrserG9Gmt64LlKTR3/4pZkgzyttD/MwvMVBcW8NojBzvbf3S9epE0wrT\nmzcxHBYSzqc34xdpjCvDUcxDKCn3Z8HkJ1fONok4Qh/idcJXsxA5hF34wCm2RkjT\nYgv6NW1AYDU0G+jYXeda0l73yi3Iu2T5UwIBMXzc8dAEfpiXKqUN6JpBT5b5O8DD\nIYGbMiMCWvBviTCLiLE6sVu+M9Vg6dYmIWs//D7Ir4dOauYwgKbZAUC3YZ2cgoX3\nyD2qrymhfEq4+ySd5Ks5KD59Cripa+pN24XJJ/Qcdw/VdZkuCtjTvOF8LHxWZPf4\ngcTklZ08jNHaEV8DJZKuq6Ee04fGx+CeNHSkM+2t0c0ZSRY5ktyPZ0jNfRy5RjnQ\nHd690RgPm6LWLUiUAf6znK+p4UKsxDfmmbaVIpNSQepLoo6CNEJtyZtOrinouq0e\nJd3KG9ik3TGq7FoIzV5M46Tlf5qTohxXuD0JNmqyEv5Cy/WtzxI=\n=aOq9\n-----END PGP SIGNATURE-----", "payload": "tree 5449602571207746d1aa3eb394c8fefc76c9f41b\nparent a0b0f5fba5d7bf18b24d1fa0e454a4fe871fecee\nauthor Jimmy Brush <code@jimmah.com> 1521900106 -0400\ncommitter Jimmy Brush <code@jimmah.com> 1521900106 -0400\n\ndon't pass -no-pie to gnu ld\n\nfixes #48884\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7cae6fef710c4668d650219319a055e8f2157ab5", "html_url": "https://github.com/rust-lang/rust/commit/7cae6fef710c4668d650219319a055e8f2157ab5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7cae6fef710c4668d650219319a055e8f2157ab5/comments", "author": {"login": "canarysnort01", "id": 24806352, "node_id": "MDQ6VXNlcjI0ODA2MzUy", "avatar_url": "https://avatars.githubusercontent.com/u/24806352?v=4", "gravatar_id": "", "url": "https://api.github.com/users/canarysnort01", "html_url": "https://github.com/canarysnort01", "followers_url": "https://api.github.com/users/canarysnort01/followers", "following_url": "https://api.github.com/users/canarysnort01/following{/other_user}", "gists_url": "https://api.github.com/users/canarysnort01/gists{/gist_id}", "starred_url": "https://api.github.com/users/canarysnort01/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/canarysnort01/subscriptions", "organizations_url": "https://api.github.com/users/canarysnort01/orgs", "repos_url": "https://api.github.com/users/canarysnort01/repos", "events_url": "https://api.github.com/users/canarysnort01/events{/privacy}", "received_events_url": "https://api.github.com/users/canarysnort01/received_events", "type": "User", "site_admin": false}, "committer": {"login": "canarysnort01", "id": 24806352, "node_id": "MDQ6VXNlcjI0ODA2MzUy", "avatar_url": "https://avatars.githubusercontent.com/u/24806352?v=4", "gravatar_id": "", "url": "https://api.github.com/users/canarysnort01", "html_url": "https://github.com/canarysnort01", "followers_url": "https://api.github.com/users/canarysnort01/followers", "following_url": "https://api.github.com/users/canarysnort01/following{/other_user}", "gists_url": "https://api.github.com/users/canarysnort01/gists{/gist_id}", "starred_url": "https://api.github.com/users/canarysnort01/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/canarysnort01/subscriptions", "organizations_url": "https://api.github.com/users/canarysnort01/orgs", "repos_url": "https://api.github.com/users/canarysnort01/repos", "events_url": "https://api.github.com/users/canarysnort01/events{/privacy}", "received_events_url": "https://api.github.com/users/canarysnort01/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a0b0f5fba5d7bf18b24d1fa0e454a4fe871fecee", "url": "https://api.github.com/repos/rust-lang/rust/commits/a0b0f5fba5d7bf18b24d1fa0e454a4fe871fecee", "html_url": "https://github.com/rust-lang/rust/commit/a0b0f5fba5d7bf18b24d1fa0e454a4fe871fecee"}], "stats": {"total": 6, "additions": 4, "deletions": 2}, "files": [{"sha": "b2bcbb295cedc87b2d9de4842a4e07f4adc7edfc", "filename": "src/librustc_trans/back/link.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/7cae6fef710c4668d650219319a055e8f2157ab5/src%2Flibrustc_trans%2Fback%2Flink.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7cae6fef710c4668d650219319a055e8f2157ab5/src%2Flibrustc_trans%2Fback%2Flink.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fback%2Flink.rs?ref=7cae6fef710c4668d650219319a055e8f2157ab5", "patch": "@@ -712,6 +712,7 @@ fn link_natively(sess: &Session,\n         // linking executables as pie. Different versions of gcc seem to use\n         // different quotes in the error message so don't check for them.\n         if sess.target.target.options.linker_is_gnu &&\n+           sess.linker_flavor() != LinkerFlavor::Ld &&\n            (out.contains(\"unrecognized command line option\") ||\n             out.contains(\"unknown argument\")) &&\n            out.contains(\"-no-pie\") &&\n@@ -1007,8 +1008,9 @@ fn link_args(cmd: &mut Linker,\n         } else {\n             // recent versions of gcc can be configured to generate position\n             // independent executables by default. We have to pass -no-pie to\n-            // explicitly turn that off.\n-            if sess.target.target.options.linker_is_gnu {\n+            // explicitly turn that off. Not applicable to ld.\n+            if sess.target.target.options.linker_is_gnu\n+                && sess.linker_flavor() != LinkerFlavor::Ld {\n                 cmd.no_position_independent_executable();\n             }\n         }"}]}