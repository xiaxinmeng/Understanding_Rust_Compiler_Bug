{"sha": "c418a48737a3d7b18c090ed1ae605f5e0561c1b3", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM0MThhNDg3MzdhM2Q3YjE4YzA5MGVkMWFlNjA1ZjVlMDU2MWMxYjM=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2021-08-26T19:38:11Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-08-26T19:38:11Z"}, "message": "Rollup merge of #88320 - sexxi-goose:issue-88103, r=nikomatsakis\n\ntype_implements_trait consider obligation failure on overflow\n\nFixes: #88103", "tree": {"sha": "78999cf62ce5db7a43a13ca548a13310bd2117b8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/78999cf62ce5db7a43a13ca548a13310bd2117b8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c418a48737a3d7b18c090ed1ae605f5e0561c1b3", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhJ+2jCRBK7hj4Ov3rIwAAwhAIAIJtau1PbsSPDu1xYRbaN8sc\nMguY8LiP3nilZPe6hcP5GLBsaarJZFQZneEslIz5CEN1TAMe1F8Da++LelCL5jpr\nty+qR2s/g5XAUdCdkIytnfJ2xZ4baWlXoXeqyFVRZOL0gZGRXa8eccE0t1K97adW\nhG7E1Z4Gau2S+Ji0bkXusDGBlt0KgX6Q66wNPh1ifGPSANGPii3Roz8qQRLn/2+Q\nD+FAowF7Dimf+TDHY1PLPZIu0ZeEutZMz23FN+Pji7l8ekPakQIXItWrljdqSfl9\n/nxCvUGoWoX5WTfVIc85Rz1PgZRryiIPv0F3rBdxSXSFjHg91BGNf9fa5bfwq+U=\n=q6s5\n-----END PGP SIGNATURE-----\n", "payload": "tree 78999cf62ce5db7a43a13ca548a13310bd2117b8\nparent dfca7b333182c9f2153e846525833d7ed1c3bfd4\nparent 88bcd4457be4d37d83d505ad3fe2dc7a5ce7203a\nauthor Manish Goregaokar <manishsmail@gmail.com> 1630006691 -0700\ncommitter GitHub <noreply@github.com> 1630006691 -0700\n\nRollup merge of #88320 - sexxi-goose:issue-88103, r=nikomatsakis\n\ntype_implements_trait consider obligation failure on overflow\n\nFixes: #88103\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c418a48737a3d7b18c090ed1ae605f5e0561c1b3", "html_url": "https://github.com/rust-lang/rust/commit/c418a48737a3d7b18c090ed1ae605f5e0561c1b3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c418a48737a3d7b18c090ed1ae605f5e0561c1b3/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dfca7b333182c9f2153e846525833d7ed1c3bfd4", "url": "https://api.github.com/repos/rust-lang/rust/commits/dfca7b333182c9f2153e846525833d7ed1c3bfd4", "html_url": "https://github.com/rust-lang/rust/commit/dfca7b333182c9f2153e846525833d7ed1c3bfd4"}, {"sha": "88bcd4457be4d37d83d505ad3fe2dc7a5ce7203a", "url": "https://api.github.com/repos/rust-lang/rust/commits/88bcd4457be4d37d83d505ad3fe2dc7a5ce7203a", "html_url": "https://github.com/rust-lang/rust/commit/88bcd4457be4d37d83d505ad3fe2dc7a5ce7203a"}], "stats": {"total": 6, "additions": 5, "deletions": 1}, "files": [{"sha": "c90649353e80f391b5739378a3bd29813bd5e22f", "filename": "compiler/rustc_trait_selection/src/infer.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/c418a48737a3d7b18c090ed1ae605f5e0561c1b3/compiler%2Frustc_trait_selection%2Fsrc%2Finfer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c418a48737a3d7b18c090ed1ae605f5e0561c1b3/compiler%2Frustc_trait_selection%2Fsrc%2Finfer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Finfer.rs?ref=c418a48737a3d7b18c090ed1ae605f5e0561c1b3", "patch": "@@ -44,6 +44,10 @@ pub trait InferCtxtExt<'tcx> {\n     /// - the self type\n     /// - the *other* type parameters of the trait, excluding the self-type\n     /// - the parameter environment\n+    ///\n+    /// Invokes `evaluate_obligation`, so in the event that evaluating\n+    /// `Ty: Trait` causes overflow, EvaluatedToRecur (or EvaluatedToUnknown)\n+    /// will be returned.\n     fn type_implements_trait(\n         &self,\n         trait_def_id: DefId,\n@@ -117,7 +121,7 @@ impl<'cx, 'tcx> InferCtxtExt<'tcx> for InferCtxt<'cx, 'tcx> {\n             recursion_depth: 0,\n             predicate: trait_ref.without_const().to_predicate(self.tcx),\n         };\n-        self.evaluate_obligation_no_overflow(&obligation)\n+        self.evaluate_obligation(&obligation).unwrap_or(traits::EvaluationResult::EvaluatedToErr)\n     }\n }\n "}]}