{"sha": "4a9bfe41841ad7299174832cbad450625ef5fc58", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRhOWJmZTQxODQxYWQ3Mjk5MTc0ODMyY2JhZDQ1MDYyNWVmNWZjNTg=", "commit": {"author": {"name": "flip1995", "email": "hello@philkrones.com", "date": "2020-02-11T10:11:43Z"}, "committer": {"name": "flip1995", "email": "hello@philkrones.com", "date": "2020-02-14T13:37:56Z"}, "message": "Let update_lints also generate the internal lints", "tree": {"sha": "74eaf06d6f6297c6b6a0e559e42b417f9d9d7ff7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/74eaf06d6f6297c6b6a0e559e42b417f9d9d7ff7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4a9bfe41841ad7299174832cbad450625ef5fc58", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZxoS6lESXlRGMHWcaTCGhp1QZjcFAl5GorQACgkQaTCGhp1Q\nZjcLJRAArIt6DZqfzgHPai3Kcqz4gTgbePsBnMCn7u4mfeqR0rVJzzp+Omji3J5j\nXAtIYcqa5Hp9Ym+r0OkJJeiq43aB6R+OKIVshWzDja6LIkYAjel4mclkfa5SOUCp\n/0E8Jt6B4jsHXfeArTIWHe0yeE6ZS0eJHK4kDebOaHQXw4HbxLcdQul4YLVAmJtj\n0oikp72LQ4xQboC6w86c1XUuWbhQawjKiHrRm8rhCXLY/D/qEFQXSkoR9TpMsyEW\ne43ePsSCnXaPrgXsIbMO2YeCMy9vjBgrSOeeAhv88JP+lUMiLGp9EPQtBCYhtoMC\nBVxih5CECtYcg0AX8Ew9eWEnOoEDYpV8Nbwq0tacIlcT03cHOFLVtXMfhgpl0dus\ng3ecrEd+ZPG8eoZnCwjELj+CBimrYMzGCVSFvjlowStGj7FjvJ5z99mCd2KrxoYV\n01ucl5/wLDnTz5iaoU7EzbDct2tmzUDoVN7ZLFkX3fNYj/qnA1Rpa9qsgM1GBmiA\n7+J/vQyheCI8TPRhTZ1ZSUFadIeQe9Io9lkV2oJFE9kmltNtdl2hIozdfC5Xc1dQ\nh5jtDtSY8y/2CyIGzlkC1kfyLl5CEaQm51M8un+U7tFHyj6VHTqIkb/aeAPiSGCH\nGlk3CDto13QcX4qo9AfqpTS9ZzRhzL0zOTYYBdplnktPRva8YAU=\n=lbrh\n-----END PGP SIGNATURE-----", "payload": "tree 74eaf06d6f6297c6b6a0e559e42b417f9d9d7ff7\nparent 3da2c9183a19c6f11e8bd61f16d03b6830eb3eec\nauthor flip1995 <hello@philkrones.com> 1581415903 +0100\ncommitter flip1995 <hello@philkrones.com> 1581687476 +0100\n\nLet update_lints also generate the internal lints\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4a9bfe41841ad7299174832cbad450625ef5fc58", "html_url": "https://github.com/rust-lang/rust/commit/4a9bfe41841ad7299174832cbad450625ef5fc58", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4a9bfe41841ad7299174832cbad450625ef5fc58/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3da2c9183a19c6f11e8bd61f16d03b6830eb3eec", "url": "https://api.github.com/repos/rust-lang/rust/commits/3da2c9183a19c6f11e8bd61f16d03b6830eb3eec", "html_url": "https://github.com/rust-lang/rust/commit/3da2c9183a19c6f11e8bd61f16d03b6830eb3eec"}], "stats": {"total": 13, "additions": 10, "deletions": 3}, "files": [{"sha": "8e6479b64c4c6978eec0275e2e65dabd44fb158b", "filename": "clippy_dev/src/lib.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/4a9bfe41841ad7299174832cbad450625ef5fc58/clippy_dev%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4a9bfe41841ad7299174832cbad450625ef5fc58/clippy_dev%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Flib.rs?ref=4a9bfe41841ad7299174832cbad450625ef5fc58", "patch": "@@ -61,6 +61,11 @@ impl Lint {\n         lints.filter(|l| l.deprecation.is_none() && !l.is_internal())\n     }\n \n+    /// Returns all internal lints (not `internal_warn` lints)\n+    pub fn internal_lints(lints: impl Iterator<Item = Self>) -> impl Iterator<Item = Self> {\n+        lints.filter(|l| l.group == \"internal\")\n+    }\n+\n     /// Returns the lints in a `HashMap`, grouped by the different lint groups\n     #[must_use]\n     pub fn by_lint_group(lints: impl Iterator<Item = Self>) -> HashMap<String, Vec<Self>> {\n@@ -79,7 +84,7 @@ pub fn gen_lint_group_list(lints: Vec<Lint>) -> Vec<String> {\n     lints\n         .into_iter()\n         .filter_map(|l| {\n-            if l.is_internal() || l.deprecation.is_some() {\n+            if l.deprecation.is_some() {\n                 None\n             } else {\n                 Some(format!(\"        LintId::of(&{}::{}),\", l.module, l.name.to_uppercase()))"}, {"sha": "c2c9112e3b86d3fbd9a42e14c5cd612cf04f38c5", "filename": "clippy_dev/src/main.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4a9bfe41841ad7299174832cbad450625ef5fc58/clippy_dev%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4a9bfe41841ad7299174832cbad450625ef5fc58/clippy_dev%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Fmain.rs?ref=4a9bfe41841ad7299174832cbad450625ef5fc58", "patch": "@@ -164,6 +164,8 @@ fn print_lints() {\n fn update_lints(update_mode: UpdateMode) {\n     let lint_list: Vec<Lint> = gather_all().collect();\n \n+    let internal_lints = Lint::internal_lints(lint_list.clone().into_iter());\n+\n     let usable_lints: Vec<Lint> = Lint::usable_lints(lint_list.clone().into_iter()).collect();\n     let lint_count = usable_lints.len();\n \n@@ -267,7 +269,7 @@ fn update_lints(update_mode: UpdateMode) {\n     .changed;\n \n     // Generate the list of lints for all other lint groups\n-    for (lint_group, lints) in Lint::by_lint_group(usable_lints.into_iter()) {\n+    for (lint_group, lints) in Lint::by_lint_group(usable_lints.into_iter().chain(internal_lints)) {\n         file_change |= replace_region_in_file(\n             Path::new(\"clippy_lints/src/lib.rs\"),\n             &format!(\"store.register_group\\\\(true, \\\"clippy::{}\\\"\", lint_group),"}, {"sha": "a641ff777871553c21190a8981b04ac1d3be8686", "filename": "clippy_lints/src/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4a9bfe41841ad7299174832cbad450625ef5fc58/clippy_lints%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4a9bfe41841ad7299174832cbad450625ef5fc58/clippy_lints%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.rs?ref=4a9bfe41841ad7299174832cbad450625ef5fc58", "patch": "@@ -1105,10 +1105,10 @@ pub fn register_plugins(store: &mut rustc_lint::LintStore, sess: &Session, conf:\n     store.register_group(true, \"clippy::internal\", Some(\"clippy_internal\"), vec![\n         LintId::of(&utils::internal_lints::CLIPPY_LINTS_INTERNAL),\n         LintId::of(&utils::internal_lints::COMPILER_LINT_FUNCTIONS),\n+        LintId::of(&utils::internal_lints::DEFAULT_LINT),\n         LintId::of(&utils::internal_lints::LINT_WITHOUT_LINT_PASS),\n         LintId::of(&utils::internal_lints::OUTER_EXPN_EXPN_DATA),\n         LintId::of(&utils::internal_lints::PRODUCE_ICE),\n-        LintId::of(&utils::internal_lints::DEFAULT_LINT),\n     ]);\n \n     store.register_group(true, \"clippy::all\", Some(\"clippy\"), vec!["}]}