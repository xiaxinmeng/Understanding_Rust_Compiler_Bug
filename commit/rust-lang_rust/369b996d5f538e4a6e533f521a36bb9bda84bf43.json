{"sha": "369b996d5f538e4a6e533f521a36bb9bda84bf43", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM2OWI5OTZkNWY1MzhlNGE2ZTUzM2Y1MjFhMzZiYjliZGE4NGJmNDM=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2016-11-17T18:40:57Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2016-11-17T18:40:57Z"}, "message": "Rollup merge of #37766 - tarka:book-testing-concurrency-capture, r=steveklabnik\n\nAdd sections about testing concurrency and stdout/err capture", "tree": {"sha": "f21ed17d9bbdff7cf7314f4a1b7dd8b776e251e2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f21ed17d9bbdff7cf7314f4a1b7dd8b776e251e2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/369b996d5f538e4a6e533f521a36bb9bda84bf43", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/369b996d5f538e4a6e533f521a36bb9bda84bf43", "html_url": "https://github.com/rust-lang/rust/commit/369b996d5f538e4a6e533f521a36bb9bda84bf43", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/369b996d5f538e4a6e533f521a36bb9bda84bf43/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b633767b1049c9f8ca93f7399a5f4bf68bd487b9", "url": "https://api.github.com/repos/rust-lang/rust/commits/b633767b1049c9f8ca93f7399a5f4bf68bd487b9", "html_url": "https://github.com/rust-lang/rust/commit/b633767b1049c9f8ca93f7399a5f4bf68bd487b9"}, {"sha": "5a76fe4225f735a3a6e8574954b327157461423c", "url": "https://api.github.com/repos/rust-lang/rust/commits/5a76fe4225f735a3a6e8574954b327157461423c", "html_url": "https://github.com/rust-lang/rust/commit/5a76fe4225f735a3a6e8574954b327157461423c"}], "stats": {"total": 42, "additions": 42, "deletions": 0}, "files": [{"sha": "14a05102b9a0346406cdd451c157ab879df9606f", "filename": "src/doc/book/testing.md", "status": "modified", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/rust-lang/rust/blob/369b996d5f538e4a6e533f521a36bb9bda84bf43/src%2Fdoc%2Fbook%2Ftesting.md", "raw_url": "https://github.com/rust-lang/rust/raw/369b996d5f538e4a6e533f521a36bb9bda84bf43/src%2Fdoc%2Fbook%2Ftesting.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Fbook%2Ftesting.md?ref=369b996d5f538e4a6e533f521a36bb9bda84bf43", "patch": "@@ -586,3 +586,45 @@ you add more examples.\n \n We haven\u2019t covered all of the details with writing documentation tests. For more,\n please see the [Documentation chapter](documentation.html).\n+\n+# Testing and concurrency\n+\n+One thing that is important to note when writing tests are run concurrently\n+using threads. For this reason you should take care that your tests are written\n+in such a way as to not depend on each-other, or on any shared state. \"Shared\n+state\" can also include the environment, such as the current working directory,\n+or environment variables.\n+\n+If this is an issue it is possible to control this concurrency, either by\n+setting the environment variable `RUST_TEST_THREADS`, or by passing the argument\n+`--test-threads` to the tests:\n+\n+```bash\n+$ RUST_TEST_THREADS=1 cargo test   # Run tests with no concurrency\n+...\n+$ cargo test -- --test-threads=1   # Same as above\n+...\n+```\n+\n+# Test output\n+\n+By default Rust's test library captures and discards output to standard\n+out/error, e.g. output from `println!()`. This too can be controlled using the\n+environment or a switch:\n+\n+\n+```bash\n+$ RUST_TEST_NOCAPTURE=1 cargo test   # Preserve stdout/stderr\n+...\n+$ cargo test -- --nocapture          # Same as above\n+...\n+```\n+\n+However a better method avoiding capture is to use logging rather than raw\n+output. Rust has a [standard logging API][log], which provides a frontend to\n+multiple logging implementations. This can be used in conjunction with the\n+default [env_logger] to output any debugging information in a manner that can be\n+controlled at runtime.\n+\n+[log]: https://crates.io/crates/log\n+[env_logger]: https://crates.io/crates/env_logger"}]}