{"sha": "67b2b3d0ce59fe082b442de30627c3386048eaca", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY3YjJiM2QwY2U1OWZlMDgyYjQ0MmRlMzA2MjdjMzM4NjA0OGVhY2E=", "commit": {"author": {"name": "Jonas Schievink", "email": "jonas.schievink@ferrous-systems.com", "date": "2020-08-12T09:49:49Z"}, "committer": {"name": "Jonas Schievink", "email": "jonas.schievink@ferrous-systems.com", "date": "2020-08-12T10:23:25Z"}, "message": "Fix build on musl and test it in CI", "tree": {"sha": "55f1ba6759838b18f16efb24616efa37f6140a51", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/55f1ba6759838b18f16efb24616efa37f6140a51"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/67b2b3d0ce59fe082b442de30627c3386048eaca", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/67b2b3d0ce59fe082b442de30627c3386048eaca", "html_url": "https://github.com/rust-lang/rust/commit/67b2b3d0ce59fe082b442de30627c3386048eaca", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/67b2b3d0ce59fe082b442de30627c3386048eaca/comments", "author": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b93408d0b2609b82f869b1953122df4a46bb0014", "url": "https://api.github.com/repos/rust-lang/rust/commits/b93408d0b2609b82f869b1953122df4a46bb0014", "html_url": "https://github.com/rust-lang/rust/commit/b93408d0b2609b82f869b1953122df4a46bb0014"}], "stats": {"total": 24, "additions": 16, "deletions": 8}, "files": [{"sha": "f977c88bee70a3743bee3551cbda3579b9577ba7", "filename": ".github/workflows/ci.yaml", "status": "modified", "additions": 13, "deletions": 5, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/67b2b3d0ce59fe082b442de30627c3386048eaca/.github%2Fworkflows%2Fci.yaml", "raw_url": "https://github.com/rust-lang/rust/raw/67b2b3d0ce59fe082b442de30627c3386048eaca/.github%2Fworkflows%2Fci.yaml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fci.yaml?ref=67b2b3d0ce59fe082b442de30627c3386048eaca", "patch": "@@ -88,11 +88,14 @@ jobs:\n       if: matrix.os == 'windows-latest'\n       run: Remove-Item ./target/debug/xtask.exe, ./target/debug/deps/xtask.exe\n \n-  # Weird target to catch non-portable code\n-  rust-power:\n-    name: Rust Power\n+  # Weird targets to catch non-portable code\n+  rust-cross:\n+    name: Rust Cross\n     runs-on: ubuntu-latest\n \n+    env:\n+      targets: \"powerpc-unknown-linux-gnu x86_64-unknown-linux-musl\"\n+\n     steps:\n     - name: Checkout repository\n       uses: actions/checkout@v2\n@@ -103,7 +106,9 @@ jobs:\n         toolchain: stable\n         profile: minimal\n         override: true\n-        target: 'powerpc-unknown-linux-gnu'\n+\n+    - name: Install Rust targets\n+      run: rustup target add ${{ env.targets }}\n \n     - name: Cache cargo directories\n       uses: actions/cache@v2\n@@ -114,7 +119,10 @@ jobs:\n         key: ${{ runner.os }}-cargo-${{ hashFiles('**/Cargo.lock') }}\n \n     - name: Check\n-      run: cargo check --target=powerpc-unknown-linux-gnu --all-targets\n+      run: |\n+        for target in ${{ env.targets }}; do\n+          cargo check --target=$target --all-targets\n+        done\n \n   typescript:\n     name: TypeScript"}, {"sha": "26588916254f082c22aebdb5e6b879333c8f2561", "filename": "Cargo.lock", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/67b2b3d0ce59fe082b442de30627c3386048eaca/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/67b2b3d0ce59fe082b442de30627c3386048eaca/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=67b2b3d0ce59fe082b442de30627c3386048eaca", "patch": "@@ -852,9 +852,9 @@ dependencies = [\n \n [[package]]\n name = \"perf-event-open-sys\"\n-version = \"0.3.1\"\n+version = \"0.3.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"95db63e37862bc1b842135d2234ef9418f222cc660c6752f45e7cf9ddfb97f96\"\n+checksum = \"83e7183862f36d10263d0a1ccaef50fef734ade948bf026afd1bd97355c78273\"\n dependencies = [\n  \"libc\",\n ]"}, {"sha": "83390212ae0bbc81691430c2a332d2eecdd9725e", "filename": "crates/ra_prof/src/memory_usage.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/67b2b3d0ce59fe082b442de30627c3386048eaca/crates%2Fra_prof%2Fsrc%2Fmemory_usage.rs", "raw_url": "https://github.com/rust-lang/rust/raw/67b2b3d0ce59fe082b442de30627c3386048eaca/crates%2Fra_prof%2Fsrc%2Fmemory_usage.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_prof%2Fsrc%2Fmemory_usage.rs?ref=67b2b3d0ce59fe082b442de30627c3386048eaca", "patch": "@@ -24,7 +24,7 @@ impl std::ops::Sub for MemoryUsage {\n impl MemoryUsage {\n     pub fn current() -> MemoryUsage {\n         cfg_if! {\n-            if #[cfg(target_os = \"linux\")] {\n+            if #[cfg(all(target_os = \"linux\", target_env = \"gnu\"))] {\n                 // Note: This is incredibly slow.\n                 let alloc = unsafe { libc::mallinfo() }.uordblks as isize;\n                 MemoryUsage { allocated: Bytes(alloc) }"}]}