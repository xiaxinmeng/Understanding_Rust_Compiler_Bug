{"sha": "380b81853ed64b58f8cccd66c2d30726387df9ab", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM4MGI4MTg1M2VkNjRiNThmOGNjY2Q2NmMyZDMwNzI2Mzg3ZGY5YWI=", "commit": {"author": {"name": "Luca Barbato", "email": "lu_zero@gentoo.org", "date": "2017-08-07T07:25:59Z"}, "committer": {"name": "Luca Barbato", "email": "lu_zero@gentoo.org", "date": "2017-08-07T07:25:59Z"}, "message": "Narrow or widen the vector element without changing the vector size", "tree": {"sha": "9d49c32a1087c1881e69e63524e3e773f02ae068", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9d49c32a1087c1881e69e63524e3e773f02ae068"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/380b81853ed64b58f8cccd66c2d30726387df9ab", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/380b81853ed64b58f8cccd66c2d30726387df9ab", "html_url": "https://github.com/rust-lang/rust/commit/380b81853ed64b58f8cccd66c2d30726387df9ab", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/380b81853ed64b58f8cccd66c2d30726387df9ab/comments", "author": {"login": "lu-zero", "id": 239012, "node_id": "MDQ6VXNlcjIzOTAxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/239012?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lu-zero", "html_url": "https://github.com/lu-zero", "followers_url": "https://api.github.com/users/lu-zero/followers", "following_url": "https://api.github.com/users/lu-zero/following{/other_user}", "gists_url": "https://api.github.com/users/lu-zero/gists{/gist_id}", "starred_url": "https://api.github.com/users/lu-zero/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lu-zero/subscriptions", "organizations_url": "https://api.github.com/users/lu-zero/orgs", "repos_url": "https://api.github.com/users/lu-zero/repos", "events_url": "https://api.github.com/users/lu-zero/events{/privacy}", "received_events_url": "https://api.github.com/users/lu-zero/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lu-zero", "id": 239012, "node_id": "MDQ6VXNlcjIzOTAxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/239012?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lu-zero", "html_url": "https://github.com/lu-zero", "followers_url": "https://api.github.com/users/lu-zero/followers", "following_url": "https://api.github.com/users/lu-zero/following{/other_user}", "gists_url": "https://api.github.com/users/lu-zero/gists{/gist_id}", "starred_url": "https://api.github.com/users/lu-zero/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lu-zero/subscriptions", "organizations_url": "https://api.github.com/users/lu-zero/orgs", "repos_url": "https://api.github.com/users/lu-zero/repos", "events_url": "https://api.github.com/users/lu-zero/events{/privacy}", "received_events_url": "https://api.github.com/users/lu-zero/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bb47972d4c02f1731792e76488e1d2bc266de080", "url": "https://api.github.com/repos/rust-lang/rust/commits/bb47972d4c02f1731792e76488e1d2bc266de080", "html_url": "https://github.com/rust-lang/rust/commit/bb47972d4c02f1731792e76488e1d2bc266de080"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "e9cf71c32fe9a2d83821dffcdf8b7543fac7757b", "filename": "src/etc/platform-intrinsics/generator.py", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/380b81853ed64b58f8cccd66c2d30726387df9ab/src%2Fetc%2Fplatform-intrinsics%2Fgenerator.py", "raw_url": "https://github.com/rust-lang/rust/raw/380b81853ed64b58f8cccd66c2d30726387df9ab/src%2Fetc%2Fplatform-intrinsics%2Fgenerator.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fplatform-intrinsics%2Fgenerator.py?ref=380b81853ed64b58f8cccd66c2d30726387df9ab", "patch": "@@ -19,7 +19,7 @@\n SPEC = re.compile(\n     r'^(?:(?P<void>V)|(?P<id>[iusfIUSF])(?:\\((?P<start>\\d+)-(?P<end>\\d+)\\)|'\n     r'(?P<width>\\d+)(:?/(?P<llvm_width>\\d+))?)'\n-    r'|(?P<reference>\\d+))(?P<index>\\.\\d+)?(?P<modifiers>[vShdnwusfDMC]*)(?P<force_width>x\\d+)?'\n+    r'|(?P<reference>\\d+))(?P<index>\\.\\d+)?(?P<modifiers>[vShdnwusfDMCNW]*)(?P<force_width>x\\d+)?'\n     r'(?:(?P<pointer>Pm|Pc)(?P<llvm_pointer>/.*)?|(?P<bitcast>->.*))?$'\n )\n \n@@ -246,6 +246,12 @@ def modify(self, spec, width, previous):\n             return Vector(self._elem, self._length // 2)\n         elif spec == 'd':\n             return Vector(self._elem, self._length * 2)\n+        elif spec == 'N':\n+            elem = self._elem.__class__(self._elem.bitwidth() // 2)\n+            return Vector(elem, self._length * 2)\n+        elif spec == 'W':\n+            elem = self._elem.__class__(self._elem.bitwidth() * 2)\n+            return Vector(elem, self._length // 2)\n         elif spec.startswith('x'):\n             new_bitwidth = int(spec[1:])\n             return Vector(self._elem, new_bitwidth // self._elem.bitwidth())\n@@ -714,6 +720,8 @@ def parse_args():\n         - 'd': double the length of the vector (u32x2 -> u32x4)\n         - 'n': narrow the element of the vector (u32x4 -> u16x4)\n         - 'w': widen the element of the vector (u16x4 -> u32x4)\n+        - 'N': half the length of the vector element (u32x4 -> u16x8)\n+        - 'W': double the length of the vector element (u16x8 -> u32x4)\n         - 'u': force a number (vector or scalar) to be unsigned int (f32x4 -> u32x4)\n         - 's': force a number (vector or scalar) to be signed int (u32x4 -> i32x4)\n         - 'f': force a number (vector or scalar) to be float (u32x4 -> f32x4)"}]}