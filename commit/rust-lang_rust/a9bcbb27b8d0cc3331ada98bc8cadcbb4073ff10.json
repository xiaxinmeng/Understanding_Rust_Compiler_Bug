{"sha": "a9bcbb27b8d0cc3331ada98bc8cadcbb4073ff10", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE5YmNiYjI3YjhkMGNjMzMzMWFkYTk4YmM4Y2FkY2JiNDA3M2ZmMTA=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-07-16T21:35:19Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-07-16T21:35:19Z"}, "message": "Block beta if clippy breaks.\n\nDon't fail master pull request when an unrelated tool is not test-pass.", "tree": {"sha": "b234151a48a194362f959cf635e87d2f0d650a33", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b234151a48a194362f959cf635e87d2f0d650a33"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a9bcbb27b8d0cc3331ada98bc8cadcbb4073ff10", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAltND5cACgkQ/vbIBR0O\nATwDXhAArn7NbDnza158KrDq1ml4spzu4qqFLcSGrvOAaY6UFj6jeiN1eQbh08d0\nk592xV0tJyiigD2argYkS4JouvI/wC/B+hTiuOgEAJVOpwiTZf3S/Xsr2O0GHJ6F\nhh7Lzecatt1zLwAJ9R7IZ2G7LsYAY+UPdObfUFCWaFJr4AnFaf/nfx9XgOozEkyi\nAima1g87UTLrVeUhdTDF2DiIbbmWCjpaslpBU07SG/XSFm7Q2agVdLwKM4Tj8B49\n9gq/ygn8T6GX+2OhrePXSmMVJkgOttrBWTI18KRIGv2ifPI8oT2mWxnWuedUl85A\ndyCDro/R6ozvZV6WCTHN2TH0516NA8lCKXxZ0fyoXrOjKZm9unXqxESGSYGAwWoF\nluRODSG84l0L7lJXRsz+8joiC+vFpwhxPXdAT8bPewxOHPJhs7sdwQTtqh/gjDng\n7KERV2tIYTYHqD9kxqZTpX/q5xTuPjzI5ceLlD9Uz1sEKTj3mCOz4uBE2eM5btxK\nB+sCKkI4xeGQuOb0527dvMVabUlW+OSo4uQ3M3jRbwtGghkTAfcR9u47iJ59iF4w\nsET3wiTBjxYPtmr+IEjubBTetiDbvnp9XtDtTQR7U/Efi/pCcH5QCuiNzd0Tva+u\nnHulMaMUKGgWBKqfdR1kBZiEb9W7dzL6v87aMDVoNTXmdM+Jod4=\n=6mU/\n-----END PGP SIGNATURE-----", "payload": "tree b234151a48a194362f959cf635e87d2f0d650a33\nparent 50702b28383c15907c29e8f70256cdd439800834\nauthor kennytm <kennytm@gmail.com> 1531776919 +0800\ncommitter kennytm <kennytm@gmail.com> 1531776919 +0800\n\nBlock beta if clippy breaks.\n\nDon't fail master pull request when an unrelated tool is not test-pass.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a9bcbb27b8d0cc3331ada98bc8cadcbb4073ff10", "html_url": "https://github.com/rust-lang/rust/commit/a9bcbb27b8d0cc3331ada98bc8cadcbb4073ff10", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a9bcbb27b8d0cc3331ada98bc8cadcbb4073ff10/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "50702b28383c15907c29e8f70256cdd439800834", "url": "https://api.github.com/repos/rust-lang/rust/commits/50702b28383c15907c29e8f70256cdd439800834", "html_url": "https://github.com/rust-lang/rust/commit/50702b28383c15907c29e8f70256cdd439800834"}], "stats": {"total": 16, "additions": 9, "deletions": 7}, "files": [{"sha": "f6d375058a77205c5d23d405218ea128ef40ae9d", "filename": "src/ci/docker/x86_64-gnu-tools/checktools.sh", "status": "modified", "additions": 9, "deletions": 7, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/a9bcbb27b8d0cc3331ada98bc8cadcbb4073ff10/src%2Fci%2Fdocker%2Fx86_64-gnu-tools%2Fchecktools.sh", "raw_url": "https://github.com/rust-lang/rust/raw/a9bcbb27b8d0cc3331ada98bc8cadcbb4073ff10/src%2Fci%2Fdocker%2Fx86_64-gnu-tools%2Fchecktools.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fx86_64-gnu-tools%2Fchecktools.sh?ref=a9bcbb27b8d0cc3331ada98bc8cadcbb4073ff10", "patch": "@@ -81,8 +81,8 @@ status_check() {\n     check_dispatch $1 beta rust-by-example src/doc/rust-by-example\n     check_dispatch $1 beta rls src/tools/rls\n     check_dispatch $1 beta rustfmt src/tools/rustfmt\n+    check_dispatch $1 beta clippy-driver src/tools/clippy\n     # these tools are not required for beta to successfully branch\n-    check_dispatch $1 nightly clippy-driver src/tools/clippy\n     check_dispatch $1 nightly miri src/tools/miri\n }\n \n@@ -106,12 +106,14 @@ $COMMIT\\t$(cat \"$TOOLSTATE_FILE\")\n     fi\n }\n \n-if [ \"$RUST_RELEASE_CHANNEL\" = nightly -a -n \"${TOOLSTATE_REPO_ACCESS_TOKEN+is_set}\" ]; then\n-    . \"$(dirname $0)/repo.sh\"\n-    MESSAGE_FILE=$(mktemp -t msg.XXXXXX)\n-    echo \"($OS CI update)\" > \"$MESSAGE_FILE\"\n-    commit_toolstate_change \"$MESSAGE_FILE\" change_toolstate\n-    rm -f \"$MESSAGE_FILE\"\n+if [ \"$RUST_RELEASE_CHANNEL\" = nightly ]; then\n+    if [ -n \"${TOOLSTATE_REPO_ACCESS_TOKEN+is_set}\" ]; then\n+        . \"$(dirname $0)/repo.sh\"\n+        MESSAGE_FILE=$(mktemp -t msg.XXXXXX)\n+        echo \"($OS CI update)\" > \"$MESSAGE_FILE\"\n+        commit_toolstate_change \"$MESSAGE_FILE\" change_toolstate\n+        rm -f \"$MESSAGE_FILE\"\n+    fi\n     exit 0\n fi\n "}]}