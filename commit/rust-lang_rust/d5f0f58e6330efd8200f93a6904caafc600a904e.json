{"sha": "d5f0f58e6330efd8200f93a6904caafc600a904e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ1ZjBmNThlNjMzMGVmZDgyMDBmOTNhNjkwNGNhYWZjNjAwYTkwNGU=", "commit": {"author": {"name": "Josh Mcguigan", "email": "joshmcg88@gmail.com", "date": "2021-03-12T21:46:40Z"}, "committer": {"name": "Josh Mcguigan", "email": "joshmcg88@gmail.com", "date": "2021-03-12T21:46:40Z"}, "message": "add params_display and ty_display", "tree": {"sha": "4edb9751d70b50892c83d1cb7186b39b025bd7ba", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4edb9751d70b50892c83d1cb7186b39b025bd7ba"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d5f0f58e6330efd8200f93a6904caafc600a904e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d5f0f58e6330efd8200f93a6904caafc600a904e", "html_url": "https://github.com/rust-lang/rust/commit/d5f0f58e6330efd8200f93a6904caafc600a904e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d5f0f58e6330efd8200f93a6904caafc600a904e/comments", "author": {"login": "JoshMcguigan", "id": 22216761, "node_id": "MDQ6VXNlcjIyMjE2NzYx", "avatar_url": "https://avatars.githubusercontent.com/u/22216761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JoshMcguigan", "html_url": "https://github.com/JoshMcguigan", "followers_url": "https://api.github.com/users/JoshMcguigan/followers", "following_url": "https://api.github.com/users/JoshMcguigan/following{/other_user}", "gists_url": "https://api.github.com/users/JoshMcguigan/gists{/gist_id}", "starred_url": "https://api.github.com/users/JoshMcguigan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JoshMcguigan/subscriptions", "organizations_url": "https://api.github.com/users/JoshMcguigan/orgs", "repos_url": "https://api.github.com/users/JoshMcguigan/repos", "events_url": "https://api.github.com/users/JoshMcguigan/events{/privacy}", "received_events_url": "https://api.github.com/users/JoshMcguigan/received_events", "type": "User", "site_admin": false}, "committer": {"login": "JoshMcguigan", "id": 22216761, "node_id": "MDQ6VXNlcjIyMjE2NzYx", "avatar_url": "https://avatars.githubusercontent.com/u/22216761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JoshMcguigan", "html_url": "https://github.com/JoshMcguigan", "followers_url": "https://api.github.com/users/JoshMcguigan/followers", "following_url": "https://api.github.com/users/JoshMcguigan/following{/other_user}", "gists_url": "https://api.github.com/users/JoshMcguigan/gists{/gist_id}", "starred_url": "https://api.github.com/users/JoshMcguigan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JoshMcguigan/subscriptions", "organizations_url": "https://api.github.com/users/JoshMcguigan/orgs", "repos_url": "https://api.github.com/users/JoshMcguigan/repos", "events_url": "https://api.github.com/users/JoshMcguigan/events{/privacy}", "received_events_url": "https://api.github.com/users/JoshMcguigan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "53bb46fa853bee99f673a0ed0a53798c46847d99", "url": "https://api.github.com/repos/rust-lang/rust/commits/53bb46fa853bee99f673a0ed0a53798c46847d99", "html_url": "https://github.com/rust-lang/rust/commit/53bb46fa853bee99f673a0ed0a53798c46847d99"}], "stats": {"total": 26, "additions": 17, "deletions": 9}, "files": [{"sha": "b6b67e7a713f78efacf2e7f97ec7e855ae6cc84f", "filename": "crates/ide_completion/src/render/function.rs", "status": "modified", "additions": 17, "deletions": 9, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/d5f0f58e6330efd8200f93a6904caafc600a904e/crates%2Fide_completion%2Fsrc%2Frender%2Ffunction.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d5f0f58e6330efd8200f93a6904caafc600a904e/crates%2Fide_completion%2Fsrc%2Frender%2Ffunction.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_completion%2Fsrc%2Frender%2Ffunction.rs?ref=d5f0f58e6330efd8200f93a6904caafc600a904e", "patch": "@@ -60,7 +60,19 @@ impl<'a> FunctionRender<'a> {\n     }\n \n     fn detail(&self) -> String {\n-        let params = if let Some(self_param) = self.func.self_param(self.ctx.db()) {\n+        let ret_ty = self.func.ret_type(self.ctx.db());\n+        let ret = if ret_ty.is_unit() {\n+            // Omit the return type if it is the unit type\n+            String::new()\n+        } else {\n+            format!(\" {}\", self.ty_display())\n+        };\n+\n+        format!(\"fn({}){}\", self.params_display(), ret)\n+    }\n+\n+    fn params_display(&self) -> String {\n+        if let Some(self_param) = self.func.self_param(self.ctx.db()) {\n             let params = self\n                 .func\n                 .assoc_fn_params(self.ctx.db())\n@@ -77,17 +89,13 @@ impl<'a> FunctionRender<'a> {\n                 .map(|p| p.ty().display(self.ctx.db()).to_string())\n                 .join(\", \");\n             params\n-        };\n+        }\n+    }\n \n+    fn ty_display(&self) -> String {\n         let ret_ty = self.func.ret_type(self.ctx.db());\n-        let ret = if ret_ty.is_unit() {\n-            // Omit the `-> ()` for unit return types\n-            String::new()\n-        } else {\n-            format!(\" -> {}\", ret_ty.display(self.ctx.db()))\n-        };\n \n-        format!(\"fn({}){}\", params, ret)\n+        format!(\"-> {}\", ret_ty.display(self.ctx.db()))\n     }\n \n     fn add_arg(&self, arg: &str, ty: &Type) -> String {"}]}