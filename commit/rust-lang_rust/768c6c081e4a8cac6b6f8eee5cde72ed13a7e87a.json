{"sha": "768c6c081e4a8cac6b6f8eee5cde72ed13a7e87a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc2OGM2YzA4MWU0YThjYWM2YjZmOGVlZTVjZGU3MmVkMTNhN2U4N2E=", "commit": {"author": {"name": "Dylan McKay", "email": "dylanmckay34@gmail.com", "date": "2017-02-04T10:22:05Z"}, "committer": {"name": "Dylan McKay", "email": "dylanmckay34@gmail.com", "date": "2017-02-04T10:22:05Z"}, "message": "Support a debug info API change for LLVM 4.0\n\nInstead of directly creating a 'DIGlobalVariable', we now have to create\na 'DIGlobalVariableExpression' which itself contains a reference to a\n'DIGlobalVariable'.\n\nThis is a straightforward change.\n\nIn the future, we should rename 'DIGlobalVariable' in the FFI\nbindings, assuming we will only refer to 'DIGlobalVariableExpression'\nand not 'DIGlobalVariable'.", "tree": {"sha": "971746f9da04b4be1593c9d9733e7f1b74b53570", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/971746f9da04b4be1593c9d9733e7f1b74b53570"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/768c6c081e4a8cac6b6f8eee5cde72ed13a7e87a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/768c6c081e4a8cac6b6f8eee5cde72ed13a7e87a", "html_url": "https://github.com/rust-lang/rust/commit/768c6c081e4a8cac6b6f8eee5cde72ed13a7e87a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/768c6c081e4a8cac6b6f8eee5cde72ed13a7e87a/comments", "author": null, "committer": null, "parents": [{"sha": "0648517faf1e2cf37c8b6770cbd0180a816ed9a0", "url": "https://api.github.com/repos/rust-lang/rust/commits/0648517faf1e2cf37c8b6770cbd0180a816ed9a0", "html_url": "https://github.com/rust-lang/rust/commit/0648517faf1e2cf37c8b6770cbd0180a816ed9a0"}], "stats": {"total": 10, "additions": 10, "deletions": 0}, "files": [{"sha": "8510b9f523cb5eb34af3910c2372a5511e8ae227", "filename": "src/librustc_llvm/ffi.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/768c6c081e4a8cac6b6f8eee5cde72ed13a7e87a/src%2Flibrustc_llvm%2Fffi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/768c6c081e4a8cac6b6f8eee5cde72ed13a7e87a/src%2Flibrustc_llvm%2Fffi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_llvm%2Fffi.rs?ref=768c6c081e4a8cac6b6f8eee5cde72ed13a7e87a", "patch": "@@ -8,6 +8,12 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n+// FIXME: Rename 'DIGlobalVariable' to 'DIGlobalVariableExpression'\n+// once support for LLVM 3.9 is dropped.\n+//\n+// This method was changed in this LLVM patch:\n+// https://reviews.llvm.org/D26769\n+\n use debuginfo::{DIBuilderRef, DIDescriptor, DIFile, DILexicalBlock, DISubprogram, DIType,\n                 DIBasicType, DIDerivedType, DICompositeType, DIScope, DIVariable,\n                 DIGlobalVariable, DIArray, DISubrange, DITemplateTypeParameter, DIEnumerator,"}, {"sha": "c7bcd2558186e6f94ef24a4e82d14bbedd9326bf", "filename": "src/rustllvm/RustWrapper.cpp", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/768c6c081e4a8cac6b6f8eee5cde72ed13a7e87a/src%2Frustllvm%2FRustWrapper.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/768c6c081e4a8cac6b6f8eee5cde72ed13a7e87a/src%2Frustllvm%2FRustWrapper.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustllvm%2FRustWrapper.cpp?ref=768c6c081e4a8cac6b6f8eee5cde72ed13a7e87a", "patch": "@@ -588,7 +588,11 @@ extern \"C\" LLVMRustMetadataRef LLVMRustDIBuilderCreateStaticVariable(\n   }\n #endif\n \n+#if LLVM_VERSION_GE(4, 0)\n+  return wrap(Builder->createGlobalVariableExpression(\n+#else\n   return wrap(Builder->createGlobalVariable(\n+#endif\n       unwrapDI<DIDescriptor>(Context), Name, LinkageName,\n       unwrapDI<DIFile>(File), LineNo, unwrapDI<DIType>(Ty), IsLocalToUnit,\n #if LLVM_VERSION_GE(4, 0)"}]}