{"sha": "cafc4582e66c478b6b297ae85b225c788106015e", "node_id": "C_kwDOAAsO6NoAKGNhZmM0NTgyZTY2YzQ3OGI2YjI5N2FlODViMjI1Yzc4ODEwNjAxNWU", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-12-05T09:48:39Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-12-05T09:48:39Z"}, "message": "Auto merge of #91510 - camelid:two-cleanups, r=GuillaumeGomez\n\nrustdoc: Cleanup two things in `clean::types`\n\nExplanations are in the individual commits.", "tree": {"sha": "5289642ff1de8c55c6891d25f169df12a6c1a428", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5289642ff1de8c55c6891d25f169df12a6c1a428"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cafc4582e66c478b6b297ae85b225c788106015e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cafc4582e66c478b6b297ae85b225c788106015e", "html_url": "https://github.com/rust-lang/rust/commit/cafc4582e66c478b6b297ae85b225c788106015e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cafc4582e66c478b6b297ae85b225c788106015e/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6c189bc9c20f501819c67e40b980e287c7e24d10", "url": "https://api.github.com/repos/rust-lang/rust/commits/6c189bc9c20f501819c67e40b980e287c7e24d10", "html_url": "https://github.com/rust-lang/rust/commit/6c189bc9c20f501819c67e40b980e287c7e24d10"}, {"sha": "51ca2cc6affdfb32ba278a8f6c408a1149c053f7", "url": "https://api.github.com/repos/rust-lang/rust/commits/51ca2cc6affdfb32ba278a8f6c408a1149c053f7", "html_url": "https://github.com/rust-lang/rust/commit/51ca2cc6affdfb32ba278a8f6c408a1149c053f7"}], "stats": {"total": 47, "additions": 14, "deletions": 33}, "files": [{"sha": "1fe4aa9023ea310193eb6f2494b2d8f47b64122e", "filename": "src/librustdoc/clean/types.rs", "status": "modified", "additions": 0, "deletions": 19, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/cafc4582e66c478b6b297ae85b225c788106015e/src%2Flibrustdoc%2Fclean%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cafc4582e66c478b6b297ae85b225c788106015e/src%2Flibrustdoc%2Fclean%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Ftypes.rs?ref=cafc4582e66c478b6b297ae85b225c788106015e", "patch": "@@ -1207,10 +1207,6 @@ impl GenericBound {\n crate struct Lifetime(pub Symbol);\n \n impl Lifetime {\n-    crate fn get_ref(&self) -> SymbolStr {\n-        self.0.as_str()\n-    }\n-\n     crate fn statik() -> Lifetime {\n         Lifetime(kw::StaticLifetime)\n     }\n@@ -1248,17 +1244,6 @@ impl GenericParamDefKind {\n     crate fn is_type(&self) -> bool {\n         matches!(self, GenericParamDefKind::Type { .. })\n     }\n-\n-    // FIXME(eddyb) this either returns the default of a type parameter, or the\n-    // type of a `const` parameter. It seems that the intention is to *visit*\n-    // any embedded types, but `get_type` seems to be the wrong name for that.\n-    crate fn get_type(&self) -> Option<Type> {\n-        match self {\n-            GenericParamDefKind::Type { default, .. } => default.as_deref().cloned(),\n-            GenericParamDefKind::Const { ty, .. } => Some((&**ty).clone()),\n-            GenericParamDefKind::Lifetime { .. } => None,\n-        }\n-    }\n }\n \n #[derive(Clone, PartialEq, Eq, Debug, Hash)]\n@@ -1283,10 +1268,6 @@ impl GenericParamDef {\n         self.kind.is_type()\n     }\n \n-    crate fn get_type(&self) -> Option<Type> {\n-        self.kind.get_type()\n-    }\n-\n     crate fn get_bounds(&self) -> Option<&[GenericBound]> {\n         match self.kind {\n             GenericParamDefKind::Type { ref bounds, .. } => Some(bounds),"}, {"sha": "a3cbb5756fefc38fa878f0ed481a6f7e95535e87", "filename": "src/librustdoc/html/format.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cafc4582e66c478b6b297ae85b225c788106015e/src%2Flibrustdoc%2Fhtml%2Fformat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cafc4582e66c478b6b297ae85b225c788106015e/src%2Flibrustdoc%2Fhtml%2Fformat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fformat.rs?ref=cafc4582e66c478b6b297ae85b225c788106015e", "patch": "@@ -346,7 +346,7 @@ crate fn print_where_clause<'a, 'tcx: 'a>(\n \n impl clean::Lifetime {\n     crate fn print(&self) -> impl fmt::Display + '_ {\n-        self.get_ref()\n+        self.0.as_str()\n     }\n }\n "}, {"sha": "2f7214e958ea7d2169b64afb03fad5928c0060d1", "filename": "src/librustdoc/html/render/cache.rs", "status": "modified", "additions": 13, "deletions": 13, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/cafc4582e66c478b6b297ae85b225c788106015e/src%2Flibrustdoc%2Fhtml%2Frender%2Fcache.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cafc4582e66c478b6b297ae85b225c788106015e/src%2Flibrustdoc%2Fhtml%2Frender%2Fcache.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fcache.rs?ref=cafc4582e66c478b6b297ae85b225c788106015e", "patch": "@@ -347,19 +347,19 @@ crate fn get_real_types<'tcx>(\n             let bounds = where_pred.get_bounds().unwrap_or_else(|| &[]);\n             for bound in bounds.iter() {\n                 if let GenericBound::TraitBound(poly_trait, _) = bound {\n-                    for x in poly_trait.generic_params.iter() {\n-                        if !x.is_type() {\n-                            continue;\n-                        }\n-                        if let Some(ty) = x.get_type() {\n-                            get_real_types(\n-                                generics,\n-                                &ty,\n-                                tcx,\n-                                recurse + 1,\n-                                &mut ty_generics,\n-                                cache,\n-                            );\n+                    for param_def in poly_trait.generic_params.iter() {\n+                        match &param_def.kind {\n+                            clean::GenericParamDefKind::Type { default: Some(ty), .. } => {\n+                                get_real_types(\n+                                    generics,\n+                                    ty,\n+                                    tcx,\n+                                    recurse + 1,\n+                                    &mut ty_generics,\n+                                    cache,\n+                                )\n+                            }\n+                            _ => {}\n                         }\n                     }\n                 }"}]}