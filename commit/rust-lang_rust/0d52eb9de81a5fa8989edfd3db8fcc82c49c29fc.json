{"sha": "0d52eb9de81a5fa8989edfd3db8fcc82c49c29fc", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBkNTJlYjlkZTgxYTVmYTg5ODllZGZkM2RiOGZjYzgyYzQ5YzI5ZmM=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-05-01T18:41:00Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-05-02T17:12:20Z"}, "message": "Improve code readability", "tree": {"sha": "a935b28538590435f15ad9801da0b4bbfe1783a9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a935b28538590435f15ad9801da0b4bbfe1783a9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0d52eb9de81a5fa8989edfd3db8fcc82c49c29fc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0d52eb9de81a5fa8989edfd3db8fcc82c49c29fc", "html_url": "https://github.com/rust-lang/rust/commit/0d52eb9de81a5fa8989edfd3db8fcc82c49c29fc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0d52eb9de81a5fa8989edfd3db8fcc82c49c29fc/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "29777fc6cd8a3c0f0df8efc97210745928e97235", "url": "https://api.github.com/repos/rust-lang/rust/commits/29777fc6cd8a3c0f0df8efc97210745928e97235", "html_url": "https://github.com/rust-lang/rust/commit/29777fc6cd8a3c0f0df8efc97210745928e97235"}], "stats": {"total": 36, "additions": 18, "deletions": 18}, "files": [{"sha": "520d1c77a87cbc8011ed9b36011a0009e32bfbbe", "filename": "src/librustdoc/html/render/mod.rs", "status": "modified", "additions": 18, "deletions": 18, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/0d52eb9de81a5fa8989edfd3db8fcc82c49c29fc/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0d52eb9de81a5fa8989edfd3db8fcc82c49c29fc/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs?ref=0d52eb9de81a5fa8989edfd3db8fcc82c49c29fc", "patch": "@@ -1457,8 +1457,8 @@ fn render_impl(\n     }\n \n     fn render_default_items(\n-        w: &mut Buffer,\n-        tmp_w: &mut Buffer,\n+        boring: &mut Buffer,\n+        interesting: &mut Buffer,\n         cx: &Context<'_>,\n         t: &clean::Trait,\n         i: &clean::Impl,\n@@ -1477,8 +1477,8 @@ fn render_impl(\n             let assoc_link = AssocItemLink::GotoSource(did, &i.provided_trait_methods);\n \n             doc_impl_item(\n-                w,\n-                tmp_w,\n+                boring,\n+                interesting,\n                 cx,\n                 trait_item,\n                 parent,\n@@ -1513,10 +1513,14 @@ fn render_impl(\n             );\n         }\n     }\n-    let details_str = if impl_items.is_empty() && default_impl_items.is_empty() {\n-        \"\"\n-    } else {\n-        \"<details class=\\\"rustdoc-toggle implementors-toggle\\\" open><summary>\"\n+    let toggled = !impl_items.is_empty() || !default_impl_items.is_empty();\n+    let open_details = |close_tags: &mut String| {\n+        if toggled {\n+            close_tags.insert_str(0, \"</details>\");\n+            \"<details class=\\\"rustdoc-toggle implementors-toggle\\\" open><summary>\"\n+        } else {\n+            \"\"\n+        }\n     };\n     if render_mode == RenderMode::Normal {\n         let id = cx.derive_id(match i.inner_impl().trait_ {\n@@ -1538,11 +1542,10 @@ fn render_impl(\n             write!(\n                 w,\n                 \"{}<h3 id=\\\"{}\\\" class=\\\"impl\\\"{}><code class=\\\"in-band\\\">\",\n-                details_str, id, aliases\n+                open_details(&mut close_tags),\n+                id,\n+                aliases\n             );\n-            if !impl_items.is_empty() || !default_impl_items.is_empty() {\n-                close_tags.insert_str(0, \"</details>\");\n-            }\n             write!(w, \"{}\", i.inner_impl().print(use_absolute, cx));\n             if show_def_docs {\n                 for it in &i.inner_impl().items {\n@@ -1566,14 +1569,11 @@ fn render_impl(\n             write!(\n                 w,\n                 \"{}<h3 id=\\\"{}\\\" class=\\\"impl\\\"{}><code class=\\\"in-band\\\">{}</code>\",\n-                details_str,\n+                open_details(&mut close_tags),\n                 id,\n                 aliases,\n                 i.inner_impl().print(false, cx)\n             );\n-            if !impl_items.is_empty() || !default_impl_items.is_empty() {\n-                close_tags.insert_str(0, \"</details>\");\n-            }\n         }\n         write!(w, \"<a href=\\\"#{}\\\" class=\\\"anchor\\\"></a>\", id);\n         render_stability_since_raw(\n@@ -1584,7 +1584,7 @@ fn render_impl(\n             outer_const_version,\n         );\n         write_srclink(cx, &i.impl_item, w);\n-        if impl_items.is_empty() && default_impl_items.is_empty() {\n+        if !toggled {\n             w.write_str(\"</h3>\");\n         } else {\n             w.write_str(\"</h3></summary>\");\n@@ -1613,7 +1613,7 @@ fn render_impl(\n             );\n         }\n     }\n-    if !impl_items.is_empty() || !default_impl_items.is_empty() {\n+    if toggled {\n         w.write_str(\"<div class=\\\"impl-items\\\">\");\n         w.push_buffer(default_impl_items);\n         if trait_.is_some() && !impl_items.is_empty() {"}]}