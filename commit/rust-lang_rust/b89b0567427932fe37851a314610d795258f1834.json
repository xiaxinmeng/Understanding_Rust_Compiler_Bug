{"sha": "b89b0567427932fe37851a314610d795258f1834", "node_id": "C_kwDOAAsO6NoAKGI4OWIwNTY3NDI3OTMyZmUzNzg1MWEzMTQ2MTBkNzk1MjU4ZjE4MzQ", "commit": {"author": {"name": "Chris Denton", "email": "christophersdenton@gmail.com", "date": "2022-04-26T14:56:26Z"}, "committer": {"name": "Chris Denton", "email": "christophersdenton@gmail.com", "date": "2022-04-26T14:56:26Z"}, "message": "Add `set_inheritable` for Windows `Handle`s", "tree": {"sha": "de836ef390199bc7592478250cd39b2656800f71", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/de836ef390199bc7592478250cd39b2656800f71"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b89b0567427932fe37851a314610d795258f1834", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE+p/jD6jrzmnSIWJLcTRy8vRWJ94FAmJoCBoACgkQcTRy8vRW\nJ95vJBAAiDBWBKzue+e/nsPdRhlHbjF3ECeV34gn16/v6I+VP1FlcEBobJjyWXRu\nGS0oS3AuJNGMnjNv9SRW5LbLf6kSXWwR5RHMvVmGT7U/Jwe42yE99P7LfuTVVPdw\n9MP1AJlPY4PyDrCsMggEu4XbUOci0NQjLlbzMW3Fd4jSj4JAzCexJjzua2R3pRvj\nJZG1aeV1haXJl0J+7m1qbUeTn5SUA7f18wDj2kisYn9B3cwZEvZNSLXBmkbriPUI\n0Zs25C22enRv/lw8Gl39u972DUOYtZ07S84hTTS42LqPTsct6KSL25gInjB6Wsk2\nEb9mSPNd2dbWyt2gyx9/KK9e+XOYblVr+aD9FLNwVOJwn1mLEZnfDyNkkO0TRxbH\ngYDcym5u8DDq1DXZwxTneKUxEaFzf673Hotf8N7i4bsq8SizyrLY8ZXs32vPk6rK\n0r7zd2IH99+HmvpBhsf3XjFPRBAgO4hgVyQLWLE1dmxUVAGBiWQjtOoCNkllMF79\nA4VgWv6N1l+1Aw1Tyb+qNR/s0jtX+idubaoHX+X43vw9FILJqcakxyVI5G5nA77J\nx7XAsd3n9DHjS/iumv+qFWozqoFNKxzOEeGxlhxtCe1s7rn2X+iPnHb4uf3PMYyO\nqnIPS4mJok/GlsX8WV3lCM6RSG/x5aEqxDbI08ByaG6yKDjDfek=\n=K9kj\n-----END PGP SIGNATURE-----", "payload": "tree de836ef390199bc7592478250cd39b2656800f71\nparent 7417110cefda899a685a77557ac2bd7d7ee07e54\nauthor Chris Denton <christophersdenton@gmail.com> 1650984986 +0100\ncommitter Chris Denton <christophersdenton@gmail.com> 1650984986 +0100\n\nAdd `set_inheritable` for Windows `Handle`s\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b89b0567427932fe37851a314610d795258f1834", "html_url": "https://github.com/rust-lang/rust/commit/b89b0567427932fe37851a314610d795258f1834", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b89b0567427932fe37851a314610d795258f1834/comments", "author": {"login": "ChrisDenton", "id": 4459874, "node_id": "MDQ6VXNlcjQ0NTk4NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4459874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChrisDenton", "html_url": "https://github.com/ChrisDenton", "followers_url": "https://api.github.com/users/ChrisDenton/followers", "following_url": "https://api.github.com/users/ChrisDenton/following{/other_user}", "gists_url": "https://api.github.com/users/ChrisDenton/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChrisDenton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChrisDenton/subscriptions", "organizations_url": "https://api.github.com/users/ChrisDenton/orgs", "repos_url": "https://api.github.com/users/ChrisDenton/repos", "events_url": "https://api.github.com/users/ChrisDenton/events{/privacy}", "received_events_url": "https://api.github.com/users/ChrisDenton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ChrisDenton", "id": 4459874, "node_id": "MDQ6VXNlcjQ0NTk4NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4459874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChrisDenton", "html_url": "https://github.com/ChrisDenton", "followers_url": "https://api.github.com/users/ChrisDenton/followers", "following_url": "https://api.github.com/users/ChrisDenton/following{/other_user}", "gists_url": "https://api.github.com/users/ChrisDenton/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChrisDenton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChrisDenton/subscriptions", "organizations_url": "https://api.github.com/users/ChrisDenton/orgs", "repos_url": "https://api.github.com/users/ChrisDenton/repos", "events_url": "https://api.github.com/users/ChrisDenton/events{/privacy}", "received_events_url": "https://api.github.com/users/ChrisDenton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7417110cefda899a685a77557ac2bd7d7ee07e54", "url": "https://api.github.com/repos/rust-lang/rust/commits/7417110cefda899a685a77557ac2bd7d7ee07e54", "html_url": "https://github.com/rust-lang/rust/commit/7417110cefda899a685a77557ac2bd7d7ee07e54"}], "stats": {"total": 16, "additions": 16, "deletions": 0}, "files": [{"sha": "b41fb3395fe396dc99c95ddad847952cf8693332", "filename": "library/std/src/os/windows/io/handle.rs", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/b89b0567427932fe37851a314610d795258f1834/library%2Fstd%2Fsrc%2Fos%2Fwindows%2Fio%2Fhandle.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b89b0567427932fe37851a314610d795258f1834/library%2Fstd%2Fsrc%2Fos%2Fwindows%2Fio%2Fhandle.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fos%2Fwindows%2Fio%2Fhandle.rs?ref=b89b0567427932fe37851a314610d795258f1834", "patch": "@@ -198,6 +198,18 @@ impl OwnedHandle {\n         })?;\n         unsafe { Ok(Self::from_raw_handle(ret)) }\n     }\n+\n+    /// Allow child processes to inherit the handle.\n+    pub(crate) fn set_inheritable(&self) -> io::Result<()> {\n+        cvt(unsafe {\n+            c::SetHandleInformation(\n+                self.as_raw_handle(),\n+                c::HANDLE_FLAG_INHERIT,\n+                c::HANDLE_FLAG_INHERIT,\n+            )\n+        })?;\n+        Ok(())\n+    }\n }\n \n impl TryFrom<HandleOrInvalid> for OwnedHandle {"}, {"sha": "3b609825a79da94d435213f249ccc0332a3f3c38", "filename": "library/std/src/sys/windows/handle.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b89b0567427932fe37851a314610d795258f1834/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fhandle.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b89b0567427932fe37851a314610d795258f1834/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fhandle.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fhandle.rs?ref=b89b0567427932fe37851a314610d795258f1834", "patch": "@@ -221,6 +221,10 @@ impl Handle {\n         Ok(Self(self.0.duplicate(access, inherit, options)?))\n     }\n \n+    pub(crate) fn set_inheritable(&self) -> io::Result<()> {\n+        self.0.set_inheritable()\n+    }\n+\n     /// Performs a synchronous read.\n     ///\n     /// If the handle is opened for asynchronous I/O then this abort the process."}]}