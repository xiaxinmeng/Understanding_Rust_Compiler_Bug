{"sha": "f50a582126e35300bba5a3a8bec001ae6c301ed5", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY1MGE1ODIxMjZlMzUzMDBiYmE1YTNhOGJlYzAwMWFlNmMzMDFlZDU=", "commit": {"author": {"name": "Paul Stansifer", "email": "paul.stansifer@gmail.com", "date": "2011-08-08T21:17:33Z"}, "committer": {"name": "Paul Stansifer", "email": "paul.stansifer@gmail.com", "date": "2011-08-15T22:35:27Z"}, "message": "Add a syntax extension to log syntax, for debugging macros.", "tree": {"sha": "09031625fda9f5c8cc470f9ff6404b69f94ccdc9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/09031625fda9f5c8cc470f9ff6404b69f94ccdc9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f50a582126e35300bba5a3a8bec001ae6c301ed5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f50a582126e35300bba5a3a8bec001ae6c301ed5", "html_url": "https://github.com/rust-lang/rust/commit/f50a582126e35300bba5a3a8bec001ae6c301ed5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f50a582126e35300bba5a3a8bec001ae6c301ed5/comments", "author": {"login": "paulstansifer", "id": 1431, "node_id": "MDQ6VXNlcjE0MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1431?v=4", "gravatar_id": "", "url": "https://api.github.com/users/paulstansifer", "html_url": "https://github.com/paulstansifer", "followers_url": "https://api.github.com/users/paulstansifer/followers", "following_url": "https://api.github.com/users/paulstansifer/following{/other_user}", "gists_url": "https://api.github.com/users/paulstansifer/gists{/gist_id}", "starred_url": "https://api.github.com/users/paulstansifer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/paulstansifer/subscriptions", "organizations_url": "https://api.github.com/users/paulstansifer/orgs", "repos_url": "https://api.github.com/users/paulstansifer/repos", "events_url": "https://api.github.com/users/paulstansifer/events{/privacy}", "received_events_url": "https://api.github.com/users/paulstansifer/received_events", "type": "User", "site_admin": false}, "committer": {"login": "paulstansifer", "id": 1431, "node_id": "MDQ6VXNlcjE0MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1431?v=4", "gravatar_id": "", "url": "https://api.github.com/users/paulstansifer", "html_url": "https://github.com/paulstansifer", "followers_url": "https://api.github.com/users/paulstansifer/followers", "following_url": "https://api.github.com/users/paulstansifer/following{/other_user}", "gists_url": "https://api.github.com/users/paulstansifer/gists{/gist_id}", "starred_url": "https://api.github.com/users/paulstansifer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/paulstansifer/subscriptions", "organizations_url": "https://api.github.com/users/paulstansifer/orgs", "repos_url": "https://api.github.com/users/paulstansifer/repos", "events_url": "https://api.github.com/users/paulstansifer/events{/privacy}", "received_events_url": "https://api.github.com/users/paulstansifer/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e7139e28f47a7a3c4618925a8ab302d6afc644d6", "url": "https://api.github.com/repos/rust-lang/rust/commits/e7139e28f47a7a3c4618925a8ab302d6afc644d6", "html_url": "https://github.com/rust-lang/rust/commit/e7139e28f47a7a3c4618925a8ab302d6afc644d6"}], "stats": {"total": 25, "additions": 22, "deletions": 3}, "files": [{"sha": "a0505f870b46debc232c0d7ca911a5c3bac50b97", "filename": "src/comp/rustc.rc", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f50a582126e35300bba5a3a8bec001ae6c301ed5/src%2Fcomp%2Frustc.rc", "raw_url": "https://github.com/rust-lang/rust/raw/f50a582126e35300bba5a3a8bec001ae6c301ed5/src%2Fcomp%2Frustc.rc", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Frustc.rc?ref=f50a582126e35300bba5a3a8bec001ae6c301ed5", "patch": "@@ -49,6 +49,7 @@ mod middle {\n \n mod syntax {\n     mod ast;\n+\n     mod fold;\n     mod visit;\n     mod codemap;\n@@ -67,6 +68,7 @@ mod syntax {\n         mod simplext;\n         mod concat_idents;\n         mod ident_to_str;\n+        mod log_syntax;\n     }\n     mod print {\n         mod pprust;"}, {"sha": "62c480ad96b69632e00f41c265dc83afd23516b3", "filename": "src/comp/syntax/ext/base.rs", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/f50a582126e35300bba5a3a8bec001ae6c301ed5/src%2Fcomp%2Fsyntax%2Fext%2Fbase.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f50a582126e35300bba5a3a8bec001ae6c301ed5/src%2Fcomp%2Fsyntax%2Fext%2Fbase.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fsyntax%2Fext%2Fbase.rs?ref=f50a582126e35300bba5a3a8bec001ae6c301ed5", "patch": "@@ -29,19 +29,23 @@ fn syntax_expander_table() -> hashmap[str, syntax_extension] {\n                             normal(ext::concat_idents::expand_syntax_ext));\n     syntax_expanders.insert(\"ident_to_str\",\n                             normal(ext::ident_to_str::expand_syntax_ext));\n+    syntax_expanders.insert(\"log_syntax\",\n+                            normal(ext::log_syntax::expand_syntax_ext));\n     ret syntax_expanders;\n }\n \n-obj ext_ctxt(sess: @session, crate_file_name_hack: str, \n+obj ext_ctxt(sess: @session, crate_file_name_hack: str,\n              mutable backtrace: span[]) {\n     fn crate_file_name() -> str { ret crate_file_name_hack; }\n \n+    fn session() -> @session { ret sess; }\n+\n     fn print_backtrace() {\n         for sp: span in backtrace {\n             sess.span_note(sp, \"(while expanding this)\")\n         }\n     }\n-    \n+\n     fn bt_push(sp: span) { backtrace += ~[sp]; }\n     fn bt_pop() { ivec::pop(backtrace); }\n \n@@ -59,7 +63,7 @@ obj ext_ctxt(sess: @session, crate_file_name_hack: str,\n     }\n     fn span_bug(sp:span, msg: str) -> ! {\n         self.print_backtrace();\n-        sess.span_bug(sp, msg); \n+        sess.span_bug(sp, msg);\n     }\n     fn bug(msg: str) -> ! {\n         self.print_backtrace();"}, {"sha": "9cd745f07f75ff71af3c9aab8eafbd1da4b0822e", "filename": "src/comp/syntax/ext/log_syntax.rs", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/f50a582126e35300bba5a3a8bec001ae6c301ed5/src%2Fcomp%2Fsyntax%2Fext%2Flog_syntax.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f50a582126e35300bba5a3a8bec001ae6c301ed5/src%2Fcomp%2Fsyntax%2Fext%2Flog_syntax.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fsyntax%2Fext%2Flog_syntax.rs?ref=f50a582126e35300bba5a3a8bec001ae6c301ed5", "patch": "@@ -0,0 +1,13 @@\n+import std::option;\n+import base::*;\n+import syntax::ast;\n+\n+fn expand_syntax_ext(cx: &ext_ctxt, sp: codemap::span, arg: @ast::expr,\n+                     body: option::t[str]) -> @ast::expr {\n+\n+    cx.print_backtrace();\n+    std::io::stdout().write_line(print::pprust::expr_to_str(arg));\n+\n+    //trivial expression\n+    ret @{id: cx.next_id(), node: ast::expr_rec(~[], option::none), span: sp};\n+}\n\\ No newline at end of file"}]}