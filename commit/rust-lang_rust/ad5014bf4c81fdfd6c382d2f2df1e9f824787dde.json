{"sha": "ad5014bf4c81fdfd6c382d2f2df1e9f824787dde", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFkNTAxNGJmNGM4MWZkZmQ2YzM4MmQyZjJkZjFlOWY4MjQ3ODdkZGU=", "commit": {"author": {"name": "Haitao Li", "email": "lihaitao@gmail.com", "date": "2011-10-16T09:02:06Z"}, "committer": {"name": "Haitao Li", "email": "lihaitao@gmail.com", "date": "2011-10-16T09:12:30Z"}, "message": "Fix link error by explicitly link needed DSOs\n\nBuilding Rust(version 280bc56) on Ubuntu 11.10 failed with link error,\nlike:\n\ncompile_and_link: stage0/lib/rustc/i686-unknown-linux-gnu/lib/libstd.so\ncompile_and_link: stage0/lib/rustc/i686-unknown-linux-gnu/bin/rustc\n/local/src/rust/build/stage0/lib/rustc/i686-unknown-linux-gnu/lib/librustrt.so:\nundefined reference to `clock_gettime'\ncollect2: ld returned 1 exit status\nerror: linking with gcc failed with code 1\n\nGCC toolchain released by Ubuntu 11.10 introduced a few compiler flags\nthat are different with upstream GCC[1]. Flags \"-Wl,--as-needed' and\n'-Wl,--no-copy-dt-needed-entries' are passed by default.\n\nFunction clock_gettime from librt is used by librustrt, indirectly by\nrustc. It is necessary to explicitly pass the \"-lrt\" flags when building\nrustc.\n\nPlease note since the toolchain changes will be the default in the next\nrelease(2.22) of binutils, this is not actually a Debian/Ubuntu specific\nissue.\n\n1. https://wiki.ubuntu.com/OneiricOcelot/ReleaseNotes#GCC_4.6_Toolchain\n\nSigned-off-by: Haitao Li <lihaitao@gmail.com>", "tree": {"sha": "3b05061d87aa5a22578347f8d15d11b353ab1689", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3b05061d87aa5a22578347f8d15d11b353ab1689"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ad5014bf4c81fdfd6c382d2f2df1e9f824787dde", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ad5014bf4c81fdfd6c382d2f2df1e9f824787dde", "html_url": "https://github.com/rust-lang/rust/commit/ad5014bf4c81fdfd6c382d2f2df1e9f824787dde", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ad5014bf4c81fdfd6c382d2f2df1e9f824787dde/comments", "author": {"login": "lht", "id": 19508, "node_id": "MDQ6VXNlcjE5NTA4", "avatar_url": "https://avatars.githubusercontent.com/u/19508?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lht", "html_url": "https://github.com/lht", "followers_url": "https://api.github.com/users/lht/followers", "following_url": "https://api.github.com/users/lht/following{/other_user}", "gists_url": "https://api.github.com/users/lht/gists{/gist_id}", "starred_url": "https://api.github.com/users/lht/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lht/subscriptions", "organizations_url": "https://api.github.com/users/lht/orgs", "repos_url": "https://api.github.com/users/lht/repos", "events_url": "https://api.github.com/users/lht/events{/privacy}", "received_events_url": "https://api.github.com/users/lht/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lht", "id": 19508, "node_id": "MDQ6VXNlcjE5NTA4", "avatar_url": "https://avatars.githubusercontent.com/u/19508?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lht", "html_url": "https://github.com/lht", "followers_url": "https://api.github.com/users/lht/followers", "following_url": "https://api.github.com/users/lht/following{/other_user}", "gists_url": "https://api.github.com/users/lht/gists{/gist_id}", "starred_url": "https://api.github.com/users/lht/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lht/subscriptions", "organizations_url": "https://api.github.com/users/lht/orgs", "repos_url": "https://api.github.com/users/lht/repos", "events_url": "https://api.github.com/users/lht/events{/privacy}", "received_events_url": "https://api.github.com/users/lht/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "280bc5633d77b91253b0a0d60c78b9afdbcb59e5", "url": "https://api.github.com/repos/rust-lang/rust/commits/280bc5633d77b91253b0a0d60c78b9afdbcb59e5", "html_url": "https://github.com/rust-lang/rust/commit/280bc5633d77b91253b0a0d60c78b9afdbcb59e5"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "2162e67724ee5e5e87e5325862126831e44dc86a", "filename": "src/comp/back/link.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ad5014bf4c81fdfd6c382d2f2df1e9f824787dde/src%2Fcomp%2Fback%2Flink.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ad5014bf4c81fdfd6c382d2f2df1e9f824787dde/src%2Fcomp%2Fback%2Flink.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fback%2Flink.rs?ref=ad5014bf4c81fdfd6c382d2f2df1e9f824787dde", "patch": "@@ -582,7 +582,7 @@ fn link_binary(sess: session::session,\n         gcc_args += [\"-lm\", main];\n     }\n \n-    gcc_args += [\"-lrustrt\"];\n+    gcc_args += [\"-lrustrt\", \"-lrt\"];\n \n     gcc_args += rpath::get_rpath_flags(sess, saved_out_filename);\n "}]}