{"sha": "b7972d34ed489f54e14972c176c2d335ed4f26c2", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI3OTcyZDM0ZWQ0ODlmNTRlMTQ5NzJjMTc2YzJkMzM1ZWQ0ZjI2YzI=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-03-19T01:32:31Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-03-19T01:33:22Z"}, "message": "Add support for building glue.o.", "tree": {"sha": "e4b473cff39d553b061400c91788a54bf3b0a425", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e4b473cff39d553b061400c91788a54bf3b0a425"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b7972d34ed489f54e14972c176c2d335ed4f26c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b7972d34ed489f54e14972c176c2d335ed4f26c2", "html_url": "https://github.com/rust-lang/rust/commit/b7972d34ed489f54e14972c176c2d335ed4f26c2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b7972d34ed489f54e14972c176c2d335ed4f26c2/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "29d7cb88335845ce22e019d091ed1332af531650", "url": "https://api.github.com/repos/rust-lang/rust/commits/29d7cb88335845ce22e019d091ed1332af531650", "html_url": "https://github.com/rust-lang/rust/commit/29d7cb88335845ce22e019d091ed1332af531650"}], "stats": {"total": 18, "additions": 17, "deletions": 1}, "files": [{"sha": "f1c4ef2eeaf49c5e93427a0a0f0de24123987a48", "filename": "Makefile.in", "status": "modified", "additions": 17, "deletions": 1, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/b7972d34ed489f54e14972c176c2d335ed4f26c2/Makefile.in", "raw_url": "https://github.com/rust-lang/rust/raw/b7972d34ed489f54e14972c176c2d335ed4f26c2/Makefile.in", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Makefile.in?ref=b7972d34ed489f54e14972c176c2d335ed4f26c2", "patch": "@@ -105,14 +105,16 @@ ifdef CFG_UNIXY\n     CFG_VALGRIND += --leak-check=full \\\n                     --error-exitcode=1 \\\n                     --quiet --vex-iropt-level=0 \\\n-                    --suppressions=etc/x86.supp\n+                    --suppressions=$(S)src/etc/x86.supp\n   endif\n endif\n \n CFG_RUNTIME :=$(call CFG_LIB_NAME,rustrt)\n CFG_LLVMEXT :=$(call CFG_LIB_NAME,llvmext)\n CFG_STDLIB :=$(call CFG_LIB_NAME,std)\n \n+CFG_LLC_CFLAGS := -march=x86\n+\n ifdef CFG_GCC\n   CFG_INFO := $(info cfg: using gcc)\n   CFG_GCC_CFLAGS += -Wall -Werror -fno-rtti -fno-exceptions -g\n@@ -331,6 +333,7 @@ all: boot/rustboot$(X)          \\\n      rt/$(CFG_RUNTIME)          \\\n      llvmext/$(CFG_LLVMEXT)     \\\n      stage0/rustc$(X)           \\\n+     stage0/glue.o              \\\n      $(GENERATED)\n \n rt/$(CFG_RUNTIME): $(RUNTIME_OBJS) $(MKFILES) $(RUNTIME_HDR)\n@@ -400,6 +403,19 @@ llvmext/%.o: llvmext/%.cpp $(MKFILES)\n \t@$(call E, lex-gen: $@)\n \t$(Q)ocamllex$(OPT) -q -o $@ $<\n \n+%.o: %.s\n+\t@$(call E, assemble [llvm]: $@)\n+\t$(Q)gcc $(CFG_GCC_CFLAGS) -o $@ -c $<\n+\n+%.ll: %.bc\n+\t@$(call E, dis [llvm]: $@)\n+\t$(Q)$(CFG_LLVM_BINDIR)/llvm-dis -o $@ $<\n+\n+\n+%.s: %.bc\n+\t@$(call E, compile [llvm]: $@)\n+\t$(Q)$(CFG_LLVM_BINDIR)/llc $(CFG_LLC_CFLAGS) -o $@ $<\n+\n \n ######################################################################\n # Cleanup"}]}