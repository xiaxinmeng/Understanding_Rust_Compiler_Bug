{"sha": "c2d381d39d282c0586d50ea7d7a431ffd5ddb3fb", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMyZDM4MWQzOWQyODJjMDU4NmQ1MGVhN2Q3YTQzMWZmZDVkZGIzZmI=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2019-01-10T21:31:34Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2019-01-10T21:31:34Z"}, "message": "Auto merge of #57484 - alexcrichton:fix-nightlies, r=Mark-Simulacru\n\nIntegrate miri into build-manifest\n\nThis fixes a mistake where miri was accidentally left out of the\nbuild-manifest parsing, meaning that today's nightly generated a\nmanifest with invalid urls!\n\nFixes #57488.", "tree": {"sha": "184bb30084496c06fb3b4ebb456aa8ef484997da", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/184bb30084496c06fb3b4ebb456aa8ef484997da"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c2d381d39d282c0586d50ea7d7a431ffd5ddb3fb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c2d381d39d282c0586d50ea7d7a431ffd5ddb3fb", "html_url": "https://github.com/rust-lang/rust/commit/c2d381d39d282c0586d50ea7d7a431ffd5ddb3fb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c2d381d39d282c0586d50ea7d7a431ffd5ddb3fb/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6ecad338381cc3b8d56e2df22e5971a598eddd6c", "url": "https://api.github.com/repos/rust-lang/rust/commits/6ecad338381cc3b8d56e2df22e5971a598eddd6c", "html_url": "https://github.com/rust-lang/rust/commit/6ecad338381cc3b8d56e2df22e5971a598eddd6c"}, {"sha": "dd326f84fb0acb10aaa18da23db56e92dc79afdb", "url": "https://api.github.com/repos/rust-lang/rust/commits/dd326f84fb0acb10aaa18da23db56e92dc79afdb", "html_url": "https://github.com/rust-lang/rust/commit/dd326f84fb0acb10aaa18da23db56e92dc79afdb"}], "stats": {"total": 19, "additions": 17, "deletions": 2}, "files": [{"sha": "df34dfe4544ae4e550b5c8981a2006e1c0688944", "filename": "src/bootstrap/dist.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c2d381d39d282c0586d50ea7d7a431ffd5ddb3fb/src%2Fbootstrap%2Fdist.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c2d381d39d282c0586d50ea7d7a431ffd5ddb3fb/src%2Fbootstrap%2Fdist.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdist.rs?ref=c2d381d39d282c0586d50ea7d7a431ffd5ddb3fb", "patch": "@@ -1984,14 +1984,14 @@ impl Step for HashSign {\n         cmd.arg(distdir(builder));\n         cmd.arg(today.trim());\n         cmd.arg(builder.rust_package_vers());\n+        cmd.arg(addr);\n         cmd.arg(builder.package_vers(&builder.release_num(\"cargo\")));\n         cmd.arg(builder.package_vers(&builder.release_num(\"rls\")));\n         cmd.arg(builder.package_vers(&builder.release_num(\"clippy\")));\n         cmd.arg(builder.package_vers(&builder.release_num(\"miri\")));\n         cmd.arg(builder.package_vers(&builder.release_num(\"rustfmt\")));\n         cmd.arg(builder.llvm_tools_package_vers());\n         cmd.arg(builder.lldb_package_vers());\n-        cmd.arg(addr);\n \n         builder.create_dir(&distdir(builder));\n "}, {"sha": "28c0b6ccb318713d5bdf4915d514bc4a42207405", "filename": "src/tools/build-manifest/src/main.rs", "status": "modified", "additions": 16, "deletions": 1, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/c2d381d39d282c0586d50ea7d7a431ffd5ddb3fb/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c2d381d39d282c0586d50ea7d7a431ffd5ddb3fb/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs?ref=c2d381d39d282c0586d50ea7d7a431ffd5ddb3fb", "patch": "@@ -192,6 +192,7 @@ struct Builder {\n     rustfmt_release: String,\n     llvm_tools_release: String,\n     lldb_release: String,\n+    miri_release: String,\n \n     input: PathBuf,\n     output: PathBuf,\n@@ -207,6 +208,7 @@ struct Builder {\n     rustfmt_version: Option<String>,\n     llvm_tools_version: Option<String>,\n     lldb_version: Option<String>,\n+    miri_version: Option<String>,\n \n     rust_git_commit_hash: Option<String>,\n     cargo_git_commit_hash: Option<String>,\n@@ -215,6 +217,7 @@ struct Builder {\n     rustfmt_git_commit_hash: Option<String>,\n     llvm_tools_git_commit_hash: Option<String>,\n     lldb_git_commit_hash: Option<String>,\n+    miri_git_commit_hash: Option<String>,\n \n     should_sign: bool,\n }\n@@ -237,13 +240,14 @@ fn main() {\n     let output = PathBuf::from(args.next().unwrap());\n     let date = args.next().unwrap();\n     let rust_release = args.next().unwrap();\n+    let s3_address = args.next().unwrap();\n     let cargo_release = args.next().unwrap();\n     let rls_release = args.next().unwrap();\n     let clippy_release = args.next().unwrap();\n+    let miri_release = args.next().unwrap();\n     let rustfmt_release = args.next().unwrap();\n     let llvm_tools_release = args.next().unwrap();\n     let lldb_release = args.next().unwrap();\n-    let s3_address = args.next().unwrap();\n \n     // Do not ask for a passphrase while manually testing\n     let mut passphrase = String::new();\n@@ -259,6 +263,7 @@ fn main() {\n         rustfmt_release,\n         llvm_tools_release,\n         lldb_release,\n+        miri_release,\n \n         input,\n         output,\n@@ -274,6 +279,7 @@ fn main() {\n         rustfmt_version: None,\n         llvm_tools_version: None,\n         lldb_version: None,\n+        miri_version: None,\n \n         rust_git_commit_hash: None,\n         cargo_git_commit_hash: None,\n@@ -282,6 +288,7 @@ fn main() {\n         rustfmt_git_commit_hash: None,\n         llvm_tools_git_commit_hash: None,\n         lldb_git_commit_hash: None,\n+        miri_git_commit_hash: None,\n \n         should_sign,\n     }.build();\n@@ -297,6 +304,7 @@ impl Builder {\n         self.llvm_tools_version = self.version(\"llvm-tools\", \"x86_64-unknown-linux-gnu\");\n         // lldb is only built for macOS.\n         self.lldb_version = self.version(\"lldb\", \"x86_64-apple-darwin\");\n+        self.miri_version = self.version(\"miri\", \"x86_64-unknown-linux-gnu\");\n \n         self.rust_git_commit_hash = self.git_commit_hash(\"rust\", \"x86_64-unknown-linux-gnu\");\n         self.cargo_git_commit_hash = self.git_commit_hash(\"cargo\", \"x86_64-unknown-linux-gnu\");\n@@ -306,6 +314,7 @@ impl Builder {\n         self.llvm_tools_git_commit_hash = self.git_commit_hash(\"llvm-tools\",\n                                                                \"x86_64-unknown-linux-gnu\");\n         self.lldb_git_commit_hash = self.git_commit_hash(\"lldb\", \"x86_64-unknown-linux-gnu\");\n+        self.miri_git_commit_hash = self.git_commit_hash(\"miri\", \"x86_64-unknown-linux-gnu\");\n \n         self.digest_and_sign();\n         let manifest = self.build_manifest();\n@@ -516,6 +525,8 @@ impl Builder {\n             format!(\"llvm-tools-{}-{}.tar.gz\", self.llvm_tools_release, target)\n         } else if component == \"lldb\" || component == \"lldb-preview\" {\n             format!(\"lldb-{}-{}.tar.gz\", self.lldb_release, target)\n+        } else if component == \"miri\" || component == \"miri-preview\" {\n+            format!(\"miri-{}-{}.tar.gz\", self.miri_release, target)\n         } else {\n             format!(\"{}-{}-{}.tar.gz\", component, self.rust_release, target)\n         }\n@@ -534,6 +545,8 @@ impl Builder {\n             &self.llvm_tools_version\n         } else if component == \"lldb\" || component == \"lldb-preview\" {\n             &self.lldb_version\n+        } else if component == \"miri\" || component == \"miri-preview\" {\n+            &self.miri_version\n         } else {\n             &self.rust_version\n         }\n@@ -552,6 +565,8 @@ impl Builder {\n             &self.llvm_tools_git_commit_hash\n         } else if component == \"lldb\" || component == \"lldb-preview\" {\n             &self.lldb_git_commit_hash\n+        } else if component == \"miri\" || component == \"miri-preview\" {\n+            &self.miri_git_commit_hash\n         } else {\n             &self.rust_git_commit_hash\n         }"}]}