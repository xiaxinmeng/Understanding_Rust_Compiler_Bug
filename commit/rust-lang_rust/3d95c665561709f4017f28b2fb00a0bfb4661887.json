{"sha": "3d95c665561709f4017f28b2fb00a0bfb4661887", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNkOTVjNjY1NTYxNzA5ZjQwMTdmMjhiMmZiMDBhMGJmYjQ2NjE4ODc=", "commit": {"author": {"name": "Nick Spain", "email": "nicholas.spain@stileeducation.com", "date": "2021-01-01T00:17:15Z"}, "committer": {"name": "Nick Spain", "email": "nicholas.spain@stileeducation.com", "date": "2021-01-01T00:17:15Z"}, "message": "Strip completion prefix of what has already been typed\n\nPer Veykril's suggestion, this removes the need to repeat the completion text twice. It also handles the completion\nin a more general case.", "tree": {"sha": "5fea5dbd1150f99c2d0bf07258131fc4e5600eec", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5fea5dbd1150f99c2d0bf07258131fc4e5600eec"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3d95c665561709f4017f28b2fb00a0bfb4661887", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3d95c665561709f4017f28b2fb00a0bfb4661887", "html_url": "https://github.com/rust-lang/rust/commit/3d95c665561709f4017f28b2fb00a0bfb4661887", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3d95c665561709f4017f28b2fb00a0bfb4661887/comments", "author": {"login": "nick96", "id": 9591268, "node_id": "MDQ6VXNlcjk1OTEyNjg=", "avatar_url": "https://avatars.githubusercontent.com/u/9591268?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nick96", "html_url": "https://github.com/nick96", "followers_url": "https://api.github.com/users/nick96/followers", "following_url": "https://api.github.com/users/nick96/following{/other_user}", "gists_url": "https://api.github.com/users/nick96/gists{/gist_id}", "starred_url": "https://api.github.com/users/nick96/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nick96/subscriptions", "organizations_url": "https://api.github.com/users/nick96/orgs", "repos_url": "https://api.github.com/users/nick96/repos", "events_url": "https://api.github.com/users/nick96/events{/privacy}", "received_events_url": "https://api.github.com/users/nick96/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nick96", "id": 9591268, "node_id": "MDQ6VXNlcjk1OTEyNjg=", "avatar_url": "https://avatars.githubusercontent.com/u/9591268?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nick96", "html_url": "https://github.com/nick96", "followers_url": "https://api.github.com/users/nick96/followers", "following_url": "https://api.github.com/users/nick96/following{/other_user}", "gists_url": "https://api.github.com/users/nick96/gists{/gist_id}", "starred_url": "https://api.github.com/users/nick96/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nick96/subscriptions", "organizations_url": "https://api.github.com/users/nick96/orgs", "repos_url": "https://api.github.com/users/nick96/repos", "events_url": "https://api.github.com/users/nick96/events{/privacy}", "received_events_url": "https://api.github.com/users/nick96/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "49eeeb61ae309a245de2f9bf65ffb0ea9576ba6c", "url": "https://api.github.com/repos/rust-lang/rust/commits/49eeeb61ae309a245de2f9bf65ffb0ea9576ba6c", "html_url": "https://github.com/rust-lang/rust/commit/49eeeb61ae309a245de2f9bf65ffb0ea9576ba6c"}], "stats": {"total": 9, "additions": 4, "deletions": 5}, "files": [{"sha": "e58b9a27448b0e71c4a403800f594d7396ba7aff", "filename": "crates/completion/src/completions/record.rs", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/3d95c665561709f4017f28b2fb00a0bfb4661887/crates%2Fcompletion%2Fsrc%2Fcompletions%2Frecord.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3d95c665561709f4017f28b2fb00a0bfb4661887/crates%2Fcompletion%2Fsrc%2Fcompletions%2Frecord.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcompletion%2Fsrc%2Fcompletions%2Frecord.rs?ref=3d95c665561709f4017f28b2fb00a0bfb4661887", "patch": "@@ -20,11 +20,10 @@ pub(crate) fn complete_record(acc: &mut Completions, ctx: &CompletionContext) ->\n \n             let missing_fields = ctx.sema.record_literal_missing_fields(record_lit);\n             if impl_default_trait && !missing_fields.is_empty() {\n-                let completion_text = if ctx.token.to_string() == \".\" {\n-                    \".Default::default()\"\n-                } else {\n-                    \"..Default::default()\"\n-                };\n+                let completion_text = \"..Default::default()\";\n+                let completion_text = completion_text\n+                    .strip_prefix(ctx.token.to_string().as_str())\n+                    .unwrap_or(completion_text);\n                 acc.add(\n                     CompletionItem::new(\n                         CompletionKind::Snippet,"}]}