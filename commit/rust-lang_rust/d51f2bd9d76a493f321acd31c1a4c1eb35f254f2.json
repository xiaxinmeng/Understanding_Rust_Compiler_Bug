{"sha": "d51f2bd9d76a493f321acd31c1a4c1eb35f254f2", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ1MWYyYmQ5ZDc2YTQ5M2YzMjFhY2QzMWMxYTRjMWViMzVmMjU0ZjI=", "commit": {"author": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2020-02-09T05:05:43Z"}, "committer": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2020-02-09T05:05:43Z"}, "message": "review comments", "tree": {"sha": "99d215552b2ea430896278bdb87ac5ea7d9b77ec", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/99d215552b2ea430896278bdb87ac5ea7d9b77ec"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d51f2bd9d76a493f321acd31c1a4c1eb35f254f2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d51f2bd9d76a493f321acd31c1a4c1eb35f254f2", "html_url": "https://github.com/rust-lang/rust/commit/d51f2bd9d76a493f321acd31c1a4c1eb35f254f2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d51f2bd9d76a493f321acd31c1a4c1eb35f254f2/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "109d5c189f4b5c3405a7d6cfb312e04d866c0c31", "url": "https://api.github.com/repos/rust-lang/rust/commits/109d5c189f4b5c3405a7d6cfb312e04d866c0c31", "html_url": "https://github.com/rust-lang/rust/commit/109d5c189f4b5c3405a7d6cfb312e04d866c0c31"}], "stats": {"total": 21, "additions": 9, "deletions": 12}, "files": [{"sha": "d91f6edc9800c3063c3e13ad83fcc704227e488e", "filename": "src/librustc_mir/borrow_check/diagnostics/mutability_errors.rs", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/d51f2bd9d76a493f321acd31c1a4c1eb35f254f2/src%2Flibrustc_mir%2Fborrow_check%2Fdiagnostics%2Fmutability_errors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d51f2bd9d76a493f321acd31c1a4c1eb35f254f2/src%2Flibrustc_mir%2Fborrow_check%2Fdiagnostics%2Fmutability_errors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Fdiagnostics%2Fmutability_errors.rs?ref=d51f2bd9d76a493f321acd31c1a4c1eb35f254f2", "patch": "@@ -447,7 +447,7 @@ impl<'a, 'tcx> MirBorrowckCtxt<'a, 'tcx> {\n \n     /// Targetted error when encountering an `FnMut` closure where an `Fn` closure was expected.\n     fn expected_fn_found_fn_mut_call(&self, err: &mut DiagnosticBuilder<'_>, sp: Span, act: &str) {\n-        err.span_label(sp, format!(\"cannot {ACT}\", ACT = act));\n+        err.span_label(sp, format!(\"cannot {}\", act));\n \n         let hir = self.infcx.tcx.hir();\n         let closure_id = hir.as_local_hir_id(self.mir_def_id).unwrap();\n@@ -528,13 +528,14 @@ impl<'a, 'tcx> MirBorrowckCtxt<'a, 'tcx> {\n                     kind: hir::ImplItemKind::Method(sig, _),\n                     ..\n                 }) => {\n-                    err.span_label(ident.span, \"you might have to change this...\");\n-                    err.span_label(sig.decl.output.span(), \"...to return `FnMut` instead of `Fn`\");\n+                    err.span_label(ident.span, \"\");\n+                    err.span_label(\n+                        sig.decl.output.span(),\n+                        \"change this to return `FnMut` instead of `Fn`\",\n+                    );\n                     err.span_label(self.body.span, \"in this closure\");\n                 }\n-                parent => {\n-                    err.note(&format!(\"parent {:?}\", parent));\n-                }\n+                _ => {}\n             }\n         }\n     }"}, {"sha": "3046b047d00f6eea0268cdbfd02472ab24bf2490", "filename": "src/test/ui/borrowck/borrow-immutable-upvar-mutation.stderr", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/d51f2bd9d76a493f321acd31c1a4c1eb35f254f2/src%2Ftest%2Fui%2Fborrowck%2Fborrow-immutable-upvar-mutation.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d51f2bd9d76a493f321acd31c1a4c1eb35f254f2/src%2Ftest%2Fui%2Fborrowck%2Fborrow-immutable-upvar-mutation.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrow-immutable-upvar-mutation.stderr?ref=d51f2bd9d76a493f321acd31c1a4c1eb35f254f2", "patch": "@@ -68,9 +68,7 @@ error[E0594]: cannot assign to `x`, as it is a captured variable in a `Fn` closu\n   --> $DIR/borrow-immutable-upvar-mutation.rs:43:9\n    |\n LL |   fn foo() -> Box<dyn Fn() -> usize> {\n-   |      ---      ---------------------- ...to return `FnMut` instead of `Fn`\n-   |      |\n-   |      you might have to change this...\n+   |      ---      ---------------------- change this to return `FnMut` instead of `Fn`\n LL |       let mut x = 0;\n LL |       Box::new(move || {\n    |  ______________-\n@@ -84,9 +82,7 @@ error[E0594]: cannot assign to `x`, as it is a captured variable in a `Fn` closu\n   --> $DIR/borrow-immutable-upvar-mutation.rs:51:9\n    |\n LL |   fn bar() -> impl Fn() -> usize {\n-   |      ---      ------------------ ...to return `FnMut` instead of `Fn`\n-   |      |\n-   |      you might have to change this...\n+   |      ---      ------------------ change this to return `FnMut` instead of `Fn`\n LL |       let mut x = 0;\n LL | /     move || {\n LL | |         x += 1;"}]}