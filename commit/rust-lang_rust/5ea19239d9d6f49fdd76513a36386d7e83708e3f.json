{"sha": "5ea19239d9d6f49fdd76513a36386d7e83708e3f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVlYTE5MjM5ZDlkNmY0OWZkZDc2NTEzYTM2Mzg2ZDdlODM3MDhlM2Y=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-06-05T11:12:57Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-06-05T11:12:57Z"}, "message": "Auto merge of #86001 - richkadel:revert-85617-rustin-patch-fix, r=Mark-Simulacrum\n\nRevert \"shrinking the deprecated method span\"\n\nReverts rust-lang/rust#85617\n\nFixes: #86000\n\nr? `@Mark-Simulacrum`", "tree": {"sha": "c42ec722628d5c53a02327b90894b6de848fc1b8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c42ec722628d5c53a02327b90894b6de848fc1b8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5ea19239d9d6f49fdd76513a36386d7e83708e3f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5ea19239d9d6f49fdd76513a36386d7e83708e3f", "html_url": "https://github.com/rust-lang/rust/commit/5ea19239d9d6f49fdd76513a36386d7e83708e3f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5ea19239d9d6f49fdd76513a36386d7e83708e3f/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "34b9932f5c0f519d6b9b9f95f21723142c5dc877", "url": "https://api.github.com/repos/rust-lang/rust/commits/34b9932f5c0f519d6b9b9f95f21723142c5dc877", "html_url": "https://github.com/rust-lang/rust/commit/34b9932f5c0f519d6b9b9f95f21723142c5dc877"}, {"sha": "1384200b1c2f69808dd16df1e967ef4e8a31dfdd", "url": "https://api.github.com/repos/rust-lang/rust/commits/1384200b1c2f69808dd16df1e967ef4e8a31dfdd", "html_url": "https://github.com/rust-lang/rust/commit/1384200b1c2f69808dd16df1e967ef4e8a31dfdd"}], "stats": {"total": 312, "additions": 149, "deletions": 163}, "files": [{"sha": "f41e0e0370680f4b3cafb8eb8c0c5ef2acadd2ee", "filename": "compiler/rustc_passes/src/stability.rs", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/5ea19239d9d6f49fdd76513a36386d7e83708e3f/compiler%2Frustc_passes%2Fsrc%2Fstability.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5ea19239d9d6f49fdd76513a36386d7e83708e3f/compiler%2Frustc_passes%2Fsrc%2Fstability.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Fstability.rs?ref=5ea19239d9d6f49fdd76513a36386d7e83708e3f", "patch": "@@ -828,11 +828,7 @@ impl Visitor<'tcx> for Checker<'tcx> {\n \n     fn visit_path(&mut self, path: &'tcx hir::Path<'tcx>, id: hir::HirId) {\n         if let Some(def_id) = path.res.opt_def_id() {\n-            let method_span = match path.segments {\n-                [.., _, last] => Some(last.ident.span),\n-                _ => None,\n-            };\n-            self.tcx.check_stability(def_id, Some(id), path.span, method_span)\n+            self.tcx.check_stability(def_id, Some(id), path.span, None)\n         }\n         intravisit::walk_path(self, path)\n     }"}, {"sha": "35e42a6857f320cfa429c639e4ae9d6069f538d2", "filename": "src/test/ui/deprecation/deprecation-lint.rs", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/5ea19239d9d6f49fdd76513a36386d7e83708e3f/src%2Ftest%2Fui%2Fdeprecation%2Fdeprecation-lint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5ea19239d9d6f49fdd76513a36386d7e83708e3f/src%2Ftest%2Fui%2Fdeprecation%2Fdeprecation-lint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdeprecation%2Fdeprecation-lint.rs?ref=5ea19239d9d6f49fdd76513a36386d7e83708e3f", "patch": "@@ -430,6 +430,24 @@ mod this_crate2 {\n             // the patterns are all fine:\n             (..) = x;\n     }\n+\n+    #[derive(Debug)]\n+    #[deprecated(note = \"Use something else instead\")]\n+    enum DeprecatedDebugEnum {\n+        Variant1 { value: Option<String> },\n+    }\n+\n+    #[allow(deprecated)]\n+    impl DeprecatedDebugEnum {\n+        fn new() -> Self {\n+            DeprecatedDebugEnum::Variant1 { value: None }\n+        }\n+    }\n+\n+    #[allow(deprecated)]\n+    pub fn allow_dep() {\n+        let _ = DeprecatedDebugEnum::new();\n+    }\n }\n \n fn main() {}"}, {"sha": "3699a939e27882e21e5a0a5363b9461f21cff183", "filename": "src/test/ui/deprecation/deprecation-lint.stderr", "status": "modified", "additions": 54, "deletions": 54, "changes": 108, "blob_url": "https://github.com/rust-lang/rust/blob/5ea19239d9d6f49fdd76513a36386d7e83708e3f/src%2Ftest%2Fui%2Fdeprecation%2Fdeprecation-lint.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5ea19239d9d6f49fdd76513a36386d7e83708e3f/src%2Ftest%2Fui%2Fdeprecation%2Fdeprecation-lint.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdeprecation%2Fdeprecation-lint.stderr?ref=5ea19239d9d6f49fdd76513a36386d7e83708e3f", "patch": "@@ -11,16 +11,16 @@ LL | #![deny(deprecated)]\n    |         ^^^^^^^^^^\n \n error: use of deprecated associated function `deprecation_lint::Trait::trait_deprecated`: text\n-  --> $DIR/deprecation-lint.rs:21:16\n+  --> $DIR/deprecation-lint.rs:21:9\n    |\n LL |         Trait::trait_deprecated(&foo);\n-   |                ^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated associated function `deprecation_lint::Trait::trait_deprecated`: text\n-  --> $DIR/deprecation-lint.rs:23:25\n+  --> $DIR/deprecation-lint.rs:23:9\n    |\n LL |         <Foo as Trait>::trait_deprecated(&foo);\n-   |                         ^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated function `deprecation_lint::deprecated_text`: text\n   --> $DIR/deprecation-lint.rs:25:9\n@@ -29,16 +29,16 @@ LL |         deprecated_text();\n    |         ^^^^^^^^^^^^^^^\n \n error: use of deprecated associated function `deprecation_lint::Trait::trait_deprecated_text`: text\n-  --> $DIR/deprecation-lint.rs:30:16\n+  --> $DIR/deprecation-lint.rs:30:9\n    |\n LL | ...   Trait::trait_deprecated_text(&foo);\n-   |              ^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated associated function `deprecation_lint::Trait::trait_deprecated_text`: text\n-  --> $DIR/deprecation-lint.rs:32:25\n+  --> $DIR/deprecation-lint.rs:32:9\n    |\n LL | ...   <Foo as Trait>::trait_deprecated_text(&foo);\n-   |                       ^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated struct `deprecation_lint::DeprecatedStruct`: text\n   --> $DIR/deprecation-lint.rs:34:17\n@@ -53,10 +53,10 @@ LL |         let _ = DeprecatedUnitStruct;\n    |                 ^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated variant `deprecation_lint::Enum::DeprecatedVariant`: text\n-  --> $DIR/deprecation-lint.rs:40:23\n+  --> $DIR/deprecation-lint.rs:40:17\n    |\n LL |         let _ = Enum::DeprecatedVariant;\n-   |                       ^^^^^^^^^^^^^^^^^\n+   |                 ^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated struct `deprecation_lint::DeprecatedTupleStruct`: text\n   --> $DIR/deprecation-lint.rs:42:17\n@@ -65,28 +65,28 @@ LL |         let _ = DeprecatedTupleStruct (1);\n    |                 ^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated struct `deprecation_lint::nested::DeprecatedStruct`: text\n-  --> $DIR/deprecation-lint.rs:44:25\n+  --> $DIR/deprecation-lint.rs:44:17\n    |\n LL |         let _ = nested::DeprecatedStruct {\n-   |                         ^^^^^^^^^^^^^^^^\n+   |                 ^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated struct `deprecation_lint::nested::DeprecatedUnitStruct`: text\n-  --> $DIR/deprecation-lint.rs:48:25\n+  --> $DIR/deprecation-lint.rs:48:17\n    |\n LL |         let _ = nested::DeprecatedUnitStruct;\n-   |                         ^^^^^^^^^^^^^^^^^^^^\n+   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated variant `deprecation_lint::nested::Enum::DeprecatedVariant`: text\n-  --> $DIR/deprecation-lint.rs:50:31\n+  --> $DIR/deprecation-lint.rs:50:17\n    |\n LL | ...   let _ = nested::Enum::DeprecatedVariant;\n-   |                             ^^^^^^^^^^^^^^^^^\n+   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated struct `deprecation_lint::nested::DeprecatedTupleStruct`: text\n-  --> $DIR/deprecation-lint.rs:52:25\n+  --> $DIR/deprecation-lint.rs:52:17\n    |\n LL | ...   let _ = nested::DeprecatedTupleStruct (1);\n-   |                       ^^^^^^^^^^^^^^^^^^^^^\n+   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated function `deprecation_lint::deprecated_text`: text\n   --> $DIR/deprecation-lint.rs:59:25\n@@ -101,28 +101,28 @@ LL |         macro_test_arg!(macro_test_arg!(deprecated_text()));\n    |                                         ^^^^^^^^^^^^^^^\n \n error: use of deprecated associated function `deprecation_lint::Trait::trait_deprecated`: text\n-  --> $DIR/deprecation-lint.rs:65:16\n+  --> $DIR/deprecation-lint.rs:65:9\n    |\n LL |         Trait::trait_deprecated(&foo);\n-   |                ^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated associated function `deprecation_lint::Trait::trait_deprecated`: text\n-  --> $DIR/deprecation-lint.rs:67:25\n+  --> $DIR/deprecation-lint.rs:67:9\n    |\n LL |         <Foo as Trait>::trait_deprecated(&foo);\n-   |                         ^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated associated function `deprecation_lint::Trait::trait_deprecated_text`: text\n-  --> $DIR/deprecation-lint.rs:69:16\n+  --> $DIR/deprecation-lint.rs:69:9\n    |\n LL | ...   Trait::trait_deprecated_text(&foo);\n-   |              ^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated associated function `deprecation_lint::Trait::trait_deprecated_text`: text\n-  --> $DIR/deprecation-lint.rs:71:25\n+  --> $DIR/deprecation-lint.rs:71:9\n    |\n LL | ...   <Foo as Trait>::trait_deprecated_text(&foo);\n-   |                       ^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated trait `deprecation_lint::DeprecatedTrait`: text\n   --> $DIR/deprecation-lint.rs:81:10\n@@ -173,10 +173,10 @@ LL |         let Deprecated2\n    |             ^^^^^^^^^^^\n \n error: use of deprecated function `deprecation_lint::deprecated_mod::deprecated`: text\n-  --> $DIR/deprecation-lint.rs:162:25\n+  --> $DIR/deprecation-lint.rs:162:9\n    |\n LL |         deprecated_mod::deprecated();\n-   |                         ^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated function `this_crate::deprecated`: text\n   --> $DIR/deprecation-lint.rs:245:9\n@@ -185,16 +185,16 @@ LL |         deprecated();\n    |         ^^^^^^^^^^\n \n error: use of deprecated associated function `this_crate::Trait::trait_deprecated`: text\n-  --> $DIR/deprecation-lint.rs:250:16\n+  --> $DIR/deprecation-lint.rs:250:9\n    |\n LL |         Trait::trait_deprecated(&foo);\n-   |                ^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated associated function `this_crate::Trait::trait_deprecated`: text\n-  --> $DIR/deprecation-lint.rs:252:25\n+  --> $DIR/deprecation-lint.rs:252:9\n    |\n LL |         <Foo as Trait>::trait_deprecated(&foo);\n-   |                         ^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated function `this_crate::deprecated_text`: text\n   --> $DIR/deprecation-lint.rs:254:9\n@@ -203,16 +203,16 @@ LL |         deprecated_text();\n    |         ^^^^^^^^^^^^^^^\n \n error: use of deprecated associated function `this_crate::Trait::trait_deprecated_text`: text\n-  --> $DIR/deprecation-lint.rs:259:16\n+  --> $DIR/deprecation-lint.rs:259:9\n    |\n LL |         Trait::trait_deprecated_text(&foo);\n-   |                ^^^^^^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated associated function `this_crate::Trait::trait_deprecated_text`: text\n-  --> $DIR/deprecation-lint.rs:261:25\n+  --> $DIR/deprecation-lint.rs:261:9\n    |\n LL | ...   <Foo as Trait>::trait_deprecated_text(&foo);\n-   |                       ^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated function `this_crate::deprecated_future`: text\n   --> $DIR/deprecation-lint.rs:264:9\n@@ -239,10 +239,10 @@ LL |         let _ = DeprecatedUnitStruct;\n    |                 ^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated unit variant `this_crate::Enum::DeprecatedVariant`: text\n-  --> $DIR/deprecation-lint.rs:274:23\n+  --> $DIR/deprecation-lint.rs:274:17\n    |\n LL |         let _ = Enum::DeprecatedVariant;\n-   |                       ^^^^^^^^^^^^^^^^^\n+   |                 ^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated tuple struct `this_crate::DeprecatedTupleStruct`: text\n   --> $DIR/deprecation-lint.rs:276:17\n@@ -251,52 +251,52 @@ LL |         let _ = DeprecatedTupleStruct (1);\n    |                 ^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated struct `this_crate::nested::DeprecatedStruct`: text\n-  --> $DIR/deprecation-lint.rs:278:25\n+  --> $DIR/deprecation-lint.rs:278:17\n    |\n LL |         let _ = nested::DeprecatedStruct {\n-   |                         ^^^^^^^^^^^^^^^^\n+   |                 ^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated unit struct `this_crate::nested::DeprecatedUnitStruct`: text\n-  --> $DIR/deprecation-lint.rs:283:25\n+  --> $DIR/deprecation-lint.rs:283:17\n    |\n LL |         let _ = nested::DeprecatedUnitStruct;\n-   |                         ^^^^^^^^^^^^^^^^^^^^\n+   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated unit variant `this_crate::nested::Enum::DeprecatedVariant`: text\n-  --> $DIR/deprecation-lint.rs:285:31\n+  --> $DIR/deprecation-lint.rs:285:17\n    |\n LL | ...   let _ = nested::Enum::DeprecatedVariant;\n-   |                             ^^^^^^^^^^^^^^^^^\n+   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated tuple struct `this_crate::nested::DeprecatedTupleStruct`: text\n-  --> $DIR/deprecation-lint.rs:287:25\n+  --> $DIR/deprecation-lint.rs:287:17\n    |\n LL | ...   let _ = nested::DeprecatedTupleStruct (1);\n-   |                       ^^^^^^^^^^^^^^^^^^^^^\n+   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated associated function `this_crate::Trait::trait_deprecated`: text\n-  --> $DIR/deprecation-lint.rs:292:16\n+  --> $DIR/deprecation-lint.rs:292:9\n    |\n LL |         Trait::trait_deprecated(&foo);\n-   |                ^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated associated function `this_crate::Trait::trait_deprecated`: text\n-  --> $DIR/deprecation-lint.rs:294:25\n+  --> $DIR/deprecation-lint.rs:294:9\n    |\n LL |         <Foo as Trait>::trait_deprecated(&foo);\n-   |                         ^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated associated function `this_crate::Trait::trait_deprecated_text`: text\n-  --> $DIR/deprecation-lint.rs:296:16\n+  --> $DIR/deprecation-lint.rs:296:9\n    |\n LL |         Trait::trait_deprecated_text(&foo);\n-   |                ^^^^^^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated associated function `this_crate::Trait::trait_deprecated_text`: text\n-  --> $DIR/deprecation-lint.rs:298:25\n+  --> $DIR/deprecation-lint.rs:298:9\n    |\n LL | ...   <Foo as Trait>::trait_deprecated_text(&foo);\n-   |                       ^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: use of deprecated function `this_crate::test_fn_closure_body::{closure#0}::bar`\n   --> $DIR/deprecation-lint.rs:316:13"}, {"sha": "eba72f88a89115cefd1c018221477a124d41d7f4", "filename": "src/test/ui/deprecation/suggestion.fixed", "status": "modified", "additions": 3, "deletions": 14, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/5ea19239d9d6f49fdd76513a36386d7e83708e3f/src%2Ftest%2Fui%2Fdeprecation%2Fsuggestion.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/5ea19239d9d6f49fdd76513a36386d7e83708e3f/src%2Ftest%2Fui%2Fdeprecation%2Fsuggestion.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdeprecation%2Fsuggestion.fixed?ref=5ea19239d9d6f49fdd76513a36386d7e83708e3f", "patch": "@@ -1,7 +1,9 @@\n // run-rustfix\n \n #![feature(staged_api)]\n+\n #![stable(since = \"1.0.0\", feature = \"test\")]\n+\n #![deny(deprecated)]\n #![allow(dead_code)]\n \n@@ -19,21 +21,8 @@ impl Foo {\n     fn replacement(&self) {}\n }\n \n-mod bar {\n-    #[rustc_deprecated(\n-    since = \"1.0.0\",\n-    reason = \"replaced by `replacement`\",\n-    suggestion = \"replacement\",\n-    )]\n-    #[stable(since = \"1.0.0\", feature = \"test\")]\n-    pub fn deprecated() {}\n-\n-    pub fn replacement() {}\n-}\n-\n fn main() {\n     let foo = Foo;\n-    foo.replacement(); //~ ERROR use of deprecated\n \n-    bar::replacement(); //~ ERROR use of deprecated\n+    foo.replacement(); //~ ERROR use of deprecated\n }"}, {"sha": "8f9791c13e8563651988f115e89a17c5fdc3ff16", "filename": "src/test/ui/deprecation/suggestion.rs", "status": "modified", "additions": 3, "deletions": 14, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/5ea19239d9d6f49fdd76513a36386d7e83708e3f/src%2Ftest%2Fui%2Fdeprecation%2Fsuggestion.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5ea19239d9d6f49fdd76513a36386d7e83708e3f/src%2Ftest%2Fui%2Fdeprecation%2Fsuggestion.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdeprecation%2Fsuggestion.rs?ref=5ea19239d9d6f49fdd76513a36386d7e83708e3f", "patch": "@@ -1,7 +1,9 @@\n // run-rustfix\n \n #![feature(staged_api)]\n+\n #![stable(since = \"1.0.0\", feature = \"test\")]\n+\n #![deny(deprecated)]\n #![allow(dead_code)]\n \n@@ -19,21 +21,8 @@ impl Foo {\n     fn replacement(&self) {}\n }\n \n-mod bar {\n-    #[rustc_deprecated(\n-    since = \"1.0.0\",\n-    reason = \"replaced by `replacement`\",\n-    suggestion = \"replacement\",\n-    )]\n-    #[stable(since = \"1.0.0\", feature = \"test\")]\n-    pub fn deprecated() {}\n-\n-    pub fn replacement() {}\n-}\n-\n fn main() {\n     let foo = Foo;\n-    foo.deprecated(); //~ ERROR use of deprecated\n \n-    bar::deprecated(); //~ ERROR use of deprecated\n+    foo.deprecated(); //~ ERROR use of deprecated\n }"}, {"sha": "8a7cb1def909e3a818d6d2ca588e3dc018456dc9", "filename": "src/test/ui/deprecation/suggestion.stderr", "status": "modified", "additions": 6, "deletions": 12, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/5ea19239d9d6f49fdd76513a36386d7e83708e3f/src%2Ftest%2Fui%2Fdeprecation%2Fsuggestion.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5ea19239d9d6f49fdd76513a36386d7e83708e3f/src%2Ftest%2Fui%2Fdeprecation%2Fsuggestion.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdeprecation%2Fsuggestion.stderr?ref=5ea19239d9d6f49fdd76513a36386d7e83708e3f", "patch": "@@ -1,20 +1,14 @@\n-error: use of deprecated function `bar::deprecated`: replaced by `replacement`\n-  --> $DIR/suggestion.rs:38:10\n+error: use of deprecated associated function `Foo::deprecated`: replaced by `replacement`\n+  --> $DIR/suggestion.rs:27:9\n    |\n-LL |     bar::deprecated();\n-   |          ^^^^^^^^^^ help: replace the use of the deprecated function: `replacement`\n+LL |     foo.deprecated();\n+   |         ^^^^^^^^^^ help: replace the use of the deprecated associated function: `replacement`\n    |\n note: the lint level is defined here\n-  --> $DIR/suggestion.rs:5:9\n+  --> $DIR/suggestion.rs:7:9\n    |\n LL | #![deny(deprecated)]\n    |         ^^^^^^^^^^\n \n-error: use of deprecated associated function `Foo::deprecated`: replaced by `replacement`\n-  --> $DIR/suggestion.rs:36:9\n-   |\n-LL |     foo.deprecated();\n-   |         ^^^^^^^^^^ help: replace the use of the deprecated associated function: `replacement`\n-\n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n "}, {"sha": "94fc1a7b46dbaf85e1234f8e109091572ad66541", "filename": "src/test/ui/lint/lint-stability-deprecated.stderr", "status": "modified", "additions": 56, "deletions": 56, "changes": 112, "blob_url": "https://github.com/rust-lang/rust/blob/5ea19239d9d6f49fdd76513a36386d7e83708e3f/src%2Ftest%2Fui%2Flint%2Flint-stability-deprecated.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5ea19239d9d6f49fdd76513a36386d7e83708e3f/src%2Ftest%2Fui%2Flint%2Flint-stability-deprecated.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-stability-deprecated.stderr?ref=5ea19239d9d6f49fdd76513a36386d7e83708e3f", "patch": "@@ -11,16 +11,16 @@ LL | #![warn(deprecated)]\n    |         ^^^^^^^^^^\n \n warning: use of deprecated associated function `lint_stability::Trait::trait_deprecated`: text\n-  --> $DIR/lint-stability-deprecated.rs:29:16\n+  --> $DIR/lint-stability-deprecated.rs:29:9\n    |\n LL |         Trait::trait_deprecated(&foo);\n-   |                ^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `lint_stability::Trait::trait_deprecated`: text\n-  --> $DIR/lint-stability-deprecated.rs:31:25\n+  --> $DIR/lint-stability-deprecated.rs:31:9\n    |\n LL |         <Foo as Trait>::trait_deprecated(&foo);\n-   |                         ^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated function `lint_stability::deprecated_text`: text\n   --> $DIR/lint-stability-deprecated.rs:33:9\n@@ -29,16 +29,16 @@ LL |         deprecated_text();\n    |         ^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `lint_stability::Trait::trait_deprecated_text`: text\n-  --> $DIR/lint-stability-deprecated.rs:38:16\n+  --> $DIR/lint-stability-deprecated.rs:38:9\n    |\n LL | ...   Trait::trait_deprecated_text(&foo);\n-   |              ^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `lint_stability::Trait::trait_deprecated_text`: text\n-  --> $DIR/lint-stability-deprecated.rs:40:25\n+  --> $DIR/lint-stability-deprecated.rs:40:9\n    |\n LL | ...   <Foo as Trait>::trait_deprecated_text(&foo);\n-   |                       ^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated function `lint_stability::deprecated_unstable`: text\n   --> $DIR/lint-stability-deprecated.rs:42:9\n@@ -47,16 +47,16 @@ LL |         deprecated_unstable();\n    |         ^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `lint_stability::Trait::trait_deprecated_unstable`: text\n-  --> $DIR/lint-stability-deprecated.rs:47:16\n+  --> $DIR/lint-stability-deprecated.rs:47:9\n    |\n LL | ...   Trait::trait_deprecated_unstable(&foo);\n-   |              ^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `lint_stability::Trait::trait_deprecated_unstable`: text\n-  --> $DIR/lint-stability-deprecated.rs:49:25\n+  --> $DIR/lint-stability-deprecated.rs:49:9\n    |\n LL | ...   <Foo as Trait>::trait_deprecated_unstable(&foo);\n-   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated function `lint_stability::deprecated_unstable_text`: text\n   --> $DIR/lint-stability-deprecated.rs:51:9\n@@ -65,16 +65,16 @@ LL |         deprecated_unstable_text();\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `lint_stability::Trait::trait_deprecated_unstable_text`: text\n-  --> $DIR/lint-stability-deprecated.rs:56:16\n+  --> $DIR/lint-stability-deprecated.rs:56:9\n    |\n LL | ...   Trait::trait_deprecated_unstable_text(&foo);\n-   |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `lint_stability::Trait::trait_deprecated_unstable_text`: text\n-  --> $DIR/lint-stability-deprecated.rs:58:25\n+  --> $DIR/lint-stability-deprecated.rs:58:9\n    |\n LL | ...   <Foo as Trait>::trait_deprecated_unstable_text(&foo);\n-   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated struct `lint_stability::DeprecatedStruct`: text\n   --> $DIR/lint-stability-deprecated.rs:108:17\n@@ -101,16 +101,16 @@ LL |         let _ = DeprecatedUnstableUnitStruct;\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated variant `lint_stability::Enum::DeprecatedVariant`: text\n-  --> $DIR/lint-stability-deprecated.rs:123:23\n+  --> $DIR/lint-stability-deprecated.rs:123:17\n    |\n LL |         let _ = Enum::DeprecatedVariant;\n-   |                       ^^^^^^^^^^^^^^^^^\n+   |                 ^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated variant `lint_stability::Enum::DeprecatedUnstableVariant`: text\n-  --> $DIR/lint-stability-deprecated.rs:124:23\n+  --> $DIR/lint-stability-deprecated.rs:124:17\n    |\n LL |         let _ = Enum::DeprecatedUnstableVariant;\n-   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated struct `lint_stability::DeprecatedTupleStruct`: text\n   --> $DIR/lint-stability-deprecated.rs:128:17\n@@ -143,52 +143,52 @@ LL |         macro_test_arg!(macro_test_arg!(deprecated_text()));\n    |                                         ^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `lint_stability::Trait::trait_deprecated`: text\n-  --> $DIR/lint-stability-deprecated.rs:145:16\n+  --> $DIR/lint-stability-deprecated.rs:145:9\n    |\n LL |         Trait::trait_deprecated(&foo);\n-   |                ^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `lint_stability::Trait::trait_deprecated`: text\n-  --> $DIR/lint-stability-deprecated.rs:147:25\n+  --> $DIR/lint-stability-deprecated.rs:147:9\n    |\n LL |         <Foo as Trait>::trait_deprecated(&foo);\n-   |                         ^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `lint_stability::Trait::trait_deprecated_text`: text\n-  --> $DIR/lint-stability-deprecated.rs:149:16\n+  --> $DIR/lint-stability-deprecated.rs:149:9\n    |\n LL | ...   Trait::trait_deprecated_text(&foo);\n-   |              ^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `lint_stability::Trait::trait_deprecated_text`: text\n-  --> $DIR/lint-stability-deprecated.rs:151:25\n+  --> $DIR/lint-stability-deprecated.rs:151:9\n    |\n LL | ...   <Foo as Trait>::trait_deprecated_text(&foo);\n-   |                       ^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `lint_stability::Trait::trait_deprecated_unstable`: text\n-  --> $DIR/lint-stability-deprecated.rs:153:16\n+  --> $DIR/lint-stability-deprecated.rs:153:9\n    |\n LL | ...   Trait::trait_deprecated_unstable(&foo);\n-   |              ^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `lint_stability::Trait::trait_deprecated_unstable`: text\n-  --> $DIR/lint-stability-deprecated.rs:155:25\n+  --> $DIR/lint-stability-deprecated.rs:155:9\n    |\n LL | ...   <Foo as Trait>::trait_deprecated_unstable(&foo);\n-   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `lint_stability::Trait::trait_deprecated_unstable_text`: text\n-  --> $DIR/lint-stability-deprecated.rs:157:16\n+  --> $DIR/lint-stability-deprecated.rs:157:9\n    |\n LL | ...   Trait::trait_deprecated_unstable_text(&foo);\n-   |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `lint_stability::Trait::trait_deprecated_unstable_text`: text\n-  --> $DIR/lint-stability-deprecated.rs:159:25\n+  --> $DIR/lint-stability-deprecated.rs:159:9\n    |\n LL | ...   <Foo as Trait>::trait_deprecated_unstable_text(&foo);\n-   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated trait `lint_stability::DeprecatedTrait`: text\n   --> $DIR/lint-stability-deprecated.rs:187:10\n@@ -203,10 +203,10 @@ LL |     trait LocalTrait2 : DeprecatedTrait { }\n    |                         ^^^^^^^^^^^^^^^\n \n warning: use of deprecated function `inheritance::inherited_stability::unstable_mod::deprecated`: text\n-  --> $DIR/lint-stability-deprecated.rs:208:23\n+  --> $DIR/lint-stability-deprecated.rs:208:9\n    |\n LL |         unstable_mod::deprecated();\n-   |                       ^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated function `this_crate::deprecated`: text\n   --> $DIR/lint-stability-deprecated.rs:330:9\n@@ -215,16 +215,16 @@ LL |         deprecated();\n    |         ^^^^^^^^^^\n \n warning: use of deprecated associated function `this_crate::Trait::trait_deprecated`: text\n-  --> $DIR/lint-stability-deprecated.rs:335:16\n+  --> $DIR/lint-stability-deprecated.rs:335:9\n    |\n LL |         Trait::trait_deprecated(&foo);\n-   |                ^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `this_crate::Trait::trait_deprecated`: text\n-  --> $DIR/lint-stability-deprecated.rs:337:25\n+  --> $DIR/lint-stability-deprecated.rs:337:9\n    |\n LL |         <Foo as Trait>::trait_deprecated(&foo);\n-   |                         ^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated function `this_crate::deprecated_text`: text\n   --> $DIR/lint-stability-deprecated.rs:339:9\n@@ -233,16 +233,16 @@ LL |         deprecated_text();\n    |         ^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `this_crate::Trait::trait_deprecated_text`: text\n-  --> $DIR/lint-stability-deprecated.rs:344:16\n+  --> $DIR/lint-stability-deprecated.rs:344:9\n    |\n LL |         Trait::trait_deprecated_text(&foo);\n-   |                ^^^^^^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `this_crate::Trait::trait_deprecated_text`: text\n-  --> $DIR/lint-stability-deprecated.rs:346:25\n+  --> $DIR/lint-stability-deprecated.rs:346:9\n    |\n LL | ...   <Foo as Trait>::trait_deprecated_text(&foo);\n-   |                       ^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated struct `this_crate::DeprecatedStruct`: text\n   --> $DIR/lint-stability-deprecated.rs:384:17\n@@ -257,10 +257,10 @@ LL |         let _ = DeprecatedUnitStruct;\n    |                 ^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated unit variant `this_crate::Enum::DeprecatedVariant`: text\n-  --> $DIR/lint-stability-deprecated.rs:395:23\n+  --> $DIR/lint-stability-deprecated.rs:395:17\n    |\n LL |         let _ = Enum::DeprecatedVariant;\n-   |                       ^^^^^^^^^^^^^^^^^\n+   |                 ^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated tuple struct `this_crate::DeprecatedTupleStruct`: text\n   --> $DIR/lint-stability-deprecated.rs:399:17\n@@ -269,28 +269,28 @@ LL |         let _ = DeprecatedTupleStruct (1);\n    |                 ^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `this_crate::Trait::trait_deprecated`: text\n-  --> $DIR/lint-stability-deprecated.rs:406:16\n+  --> $DIR/lint-stability-deprecated.rs:406:9\n    |\n LL |         Trait::trait_deprecated(&foo);\n-   |                ^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `this_crate::Trait::trait_deprecated`: text\n-  --> $DIR/lint-stability-deprecated.rs:408:25\n+  --> $DIR/lint-stability-deprecated.rs:408:9\n    |\n LL |         <Foo as Trait>::trait_deprecated(&foo);\n-   |                         ^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `this_crate::Trait::trait_deprecated_text`: text\n-  --> $DIR/lint-stability-deprecated.rs:410:16\n+  --> $DIR/lint-stability-deprecated.rs:410:9\n    |\n LL |         Trait::trait_deprecated_text(&foo);\n-   |                ^^^^^^^^^^^^^^^^^^^^^\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated associated function `this_crate::Trait::trait_deprecated_text`: text\n-  --> $DIR/lint-stability-deprecated.rs:412:25\n+  --> $DIR/lint-stability-deprecated.rs:412:9\n    |\n LL | ...   <Foo as Trait>::trait_deprecated_text(&foo);\n-   |                       ^^^^^^^^^^^^^^^^^^^^^\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: use of deprecated function `this_crate::test_fn_body::fn_in_body`: text\n   --> $DIR/lint-stability-deprecated.rs:439:9"}, {"sha": "99523f8eb645d5877260abc8b62f03ee0215f949", "filename": "src/test/ui/stability-attribute/generics-default-stability.stderr", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/5ea19239d9d6f49fdd76513a36386d7e83708e3f/src%2Ftest%2Fui%2Fstability-attribute%2Fgenerics-default-stability.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5ea19239d9d6f49fdd76513a36386d7e83708e3f/src%2Ftest%2Fui%2Fstability-attribute%2Fgenerics-default-stability.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fstability-attribute%2Fgenerics-default-stability.stderr?ref=5ea19239d9d6f49fdd76513a36386d7e83708e3f", "patch": "@@ -169,10 +169,10 @@ LL |     let _: Alias5<isize> = Alias5::Some(0);\n    |            ^^^^^^^^^^^^^\n \n warning: use of deprecated variant `unstable_generic_param::Enum4::Some`: test\n-  --> $DIR/generics-default-stability.rs:231:34\n+  --> $DIR/generics-default-stability.rs:231:27\n    |\n LL |     let _: Enum4<isize> = Enum4::Some(1);\n-   |                                  ^^^^\n+   |                           ^^^^^^^^^^^\n \n warning: use of deprecated enum `unstable_generic_param::Enum4`: test\n   --> $DIR/generics-default-stability.rs:231:12\n@@ -193,10 +193,10 @@ LL |     let _: Enum4<usize> = ENUM4;\n    |            ^^^^^^^^^^^^\n \n warning: use of deprecated variant `unstable_generic_param::Enum4::Some`: test\n-  --> $DIR/generics-default-stability.rs:237:34\n+  --> $DIR/generics-default-stability.rs:237:27\n    |\n LL |     let _: Enum4<isize> = Enum4::Some(0);\n-   |                                  ^^^^\n+   |                           ^^^^^^^^^^^\n \n warning: use of deprecated enum `unstable_generic_param::Enum4`: test\n   --> $DIR/generics-default-stability.rs:237:12\n@@ -205,10 +205,10 @@ LL |     let _: Enum4<isize> = Enum4::Some(0);\n    |            ^^^^^^^^^^^^\n \n warning: use of deprecated variant `unstable_generic_param::Enum5::Some`: test\n-  --> $DIR/generics-default-stability.rs:242:34\n+  --> $DIR/generics-default-stability.rs:242:27\n    |\n LL |     let _: Enum5<isize> = Enum5::Some(1);\n-   |                                  ^^^^\n+   |                           ^^^^^^^^^^^\n \n warning: use of deprecated enum `unstable_generic_param::Enum5`: test\n   --> $DIR/generics-default-stability.rs:242:12\n@@ -229,10 +229,10 @@ LL |     let _: Enum5<usize> = ENUM5;\n    |            ^^^^^^^^^^^^\n \n warning: use of deprecated variant `unstable_generic_param::Enum5::Some`: test\n-  --> $DIR/generics-default-stability.rs:249:34\n+  --> $DIR/generics-default-stability.rs:249:27\n    |\n LL |     let _: Enum5<isize> = Enum5::Some(0);\n-   |                                  ^^^^\n+   |                           ^^^^^^^^^^^\n \n warning: use of deprecated enum `unstable_generic_param::Enum5`: test\n   --> $DIR/generics-default-stability.rs:249:12"}]}