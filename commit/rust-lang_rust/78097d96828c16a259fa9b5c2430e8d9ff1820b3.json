{"sha": "78097d96828c16a259fa9b5c2430e8d9ff1820b3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc4MDk3ZDk2ODI4YzE2YTI1OWZhOWI1YzI0MzBlOGQ5ZmYxODIwYjM=", "commit": {"author": {"name": "Jens Reidel", "email": "jens@troet.org", "date": "2020-09-06T17:24:37Z"}, "committer": {"name": "Jens Reidel", "email": "jens@troet.org", "date": "2020-09-06T17:24:37Z"}, "message": "initial attempt to add aarch64-unknown-linux-musl to dist-linux-arm", "tree": {"sha": "cf694e01412f43d5b5a039b0fa546885f9729af1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cf694e01412f43d5b5a039b0fa546885f9729af1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/78097d96828c16a259fa9b5c2430e8d9ff1820b3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/78097d96828c16a259fa9b5c2430e8d9ff1820b3", "html_url": "https://github.com/rust-lang/rust/commit/78097d96828c16a259fa9b5c2430e8d9ff1820b3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/78097d96828c16a259fa9b5c2430e8d9ff1820b3/comments", "author": {"login": "Gelbpunkt", "id": 38864617, "node_id": "MDQ6VXNlcjM4ODY0NjE3", "avatar_url": "https://avatars.githubusercontent.com/u/38864617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Gelbpunkt", "html_url": "https://github.com/Gelbpunkt", "followers_url": "https://api.github.com/users/Gelbpunkt/followers", "following_url": "https://api.github.com/users/Gelbpunkt/following{/other_user}", "gists_url": "https://api.github.com/users/Gelbpunkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/Gelbpunkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Gelbpunkt/subscriptions", "organizations_url": "https://api.github.com/users/Gelbpunkt/orgs", "repos_url": "https://api.github.com/users/Gelbpunkt/repos", "events_url": "https://api.github.com/users/Gelbpunkt/events{/privacy}", "received_events_url": "https://api.github.com/users/Gelbpunkt/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Gelbpunkt", "id": 38864617, "node_id": "MDQ6VXNlcjM4ODY0NjE3", "avatar_url": "https://avatars.githubusercontent.com/u/38864617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Gelbpunkt", "html_url": "https://github.com/Gelbpunkt", "followers_url": "https://api.github.com/users/Gelbpunkt/followers", "following_url": "https://api.github.com/users/Gelbpunkt/following{/other_user}", "gists_url": "https://api.github.com/users/Gelbpunkt/gists{/gist_id}", "starred_url": "https://api.github.com/users/Gelbpunkt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Gelbpunkt/subscriptions", "organizations_url": "https://api.github.com/users/Gelbpunkt/orgs", "repos_url": "https://api.github.com/users/Gelbpunkt/repos", "events_url": "https://api.github.com/users/Gelbpunkt/events{/privacy}", "received_events_url": "https://api.github.com/users/Gelbpunkt/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4b65872d272875adb298b6dc12d5e4e79cf8e263", "url": "https://api.github.com/repos/rust-lang/rust/commits/4b65872d272875adb298b6dc12d5e4e79cf8e263", "html_url": "https://github.com/rust-lang/rust/commit/4b65872d272875adb298b6dc12d5e4e79cf8e263"}], "stats": {"total": 31, "additions": 14, "deletions": 17}, "files": [{"sha": "88b13eab2d08cceef29a0cc1e8c0f5581f2c3712", "filename": "src/ci/docker/host-x86_64/dist-arm-linux/Dockerfile", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/78097d96828c16a259fa9b5c2430e8d9ff1820b3/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-arm-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/78097d96828c16a259fa9b5c2430e8d9ff1820b3/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-arm-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-arm-linux%2FDockerfile?ref=78097d96828c16a259fa9b5c2430e8d9ff1820b3", "patch": "@@ -6,6 +6,14 @@ RUN sh /scripts/cross-apt-packages.sh\n COPY scripts/crosstool-ng-1.24.sh /scripts/\n RUN sh /scripts/crosstool-ng-1.24.sh\n \n+WORKDIR /build\n+\n+COPY scripts/musl-toolchain.sh /build/\n+# We need to mitigate rust-lang/rust#34978 when compiling musl itself as well\n+RUN CFLAGS=\"-Wa,--compress-debug-sections=none -Wl,--compress-debug-sections=none\" \\\n+    CXXFLAGS=\"-Wa,--compress-debug-sections=none -Wl,--compress-debug-sections=none\" \\\n+    bash musl-toolchain.sh aarch64 && rm -rf build\n+\n COPY scripts/rustbuild-setup.sh /scripts/\n RUN sh /scripts/rustbuild-setup.sh\n USER rustbuild\n@@ -25,7 +33,8 @@ ENV CC_arm_unknown_linux_gnueabi=arm-unknown-linux-gnueabi-gcc \\\n     AR_arm_unknown_linux_gnueabi=arm-unknown-linux-gnueabi-ar \\\n     CXX_arm_unknown_linux_gnueabi=arm-unknown-linux-gnueabi-g++\n \n-ENV HOSTS=arm-unknown-linux-gnueabi\n+ENV HOSTS=arm-unknown-linux-gnueabi,aarch64-unknown-linux-musl\n \n-ENV RUST_CONFIGURE_ARGS --enable-full-tools --disable-docs\n+ENV RUST_CONFIGURE_ARGS --enable-full-tools --disable-docs --musl-root-aarch64=/usr/local/aarch64-linux-musl \\\n+    --set target.aarch64-unknown-linux-musl.crt-static=false\n ENV SCRIPT python3 ../x.py dist --host $HOSTS --target $HOSTS"}, {"sha": "66709a4004cafbbbe59b90fda81aa621a0ca8459", "filename": "src/ci/docker/host-x86_64/dist-arm-linux/arm-linux-gnueabi.config", "status": "modified", "additions": 2, "deletions": 15, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/78097d96828c16a259fa9b5c2430e8d9ff1820b3/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-arm-linux%2Farm-linux-gnueabi.config", "raw_url": "https://github.com/rust-lang/rust/raw/78097d96828c16a259fa9b5c2430e8d9ff1820b3/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-arm-linux%2Farm-linux-gnueabi.config", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-arm-linux%2Farm-linux-gnueabi.config?ref=78097d96828c16a259fa9b5c2430e8d9ff1820b3", "patch": "@@ -14,6 +14,7 @@ CT_CONFIGURE_has_autoconf_2_65_or_newer=y\n CT_CONFIGURE_has_autoreconf_2_65_or_newer=y\n CT_CONFIGURE_has_automake_1_15_or_newer=y\n CT_CONFIGURE_has_gnu_m4_1_4_12_or_newer=y\n+CT_CONFIGURE_has_python_3_4_or_newer=y\n CT_CONFIGURE_has_bison_2_7_or_newer=y\n CT_CONFIGURE_has_python=y\n CT_CONFIGURE_has_git=y\n@@ -132,12 +133,6 @@ CT_ARCH_ARM=y\n # CT_ARCH_XTENSA is not set\n CT_ARCH=\"arm\"\n CT_ARCH_CHOICE_KSYM=\"ARM\"\n-# CT_ARCH_ALPHA_EV4 is not set\n-# CT_ARCH_ALPHA_EV45 is not set\n-# CT_ARCH_ALPHA_EV5 is not set\n-# CT_ARCH_ALPHA_EV56 is not set\n-# CT_ARCH_ALPHA_EV6 is not set\n-# CT_ARCH_ALPHA_EV67 is not set\n CT_ARCH_CPU=\"\"\n CT_ARCH_TUNE=\"\"\n CT_ARCH_ARM_SHOW=y\n@@ -371,8 +366,6 @@ CT_ALL_BINUTILS_CHOICES=\"BINUTILS\"\n # C-library\n #\n CT_LIBC_GLIBC=y\n-# CT_LIBC_NEWLIB is not set\n-# CT_LIBC_NONE is not set\n # CT_LIBC_UCLIBC is not set\n CT_LIBC=\"glibc\"\n CT_LIBC_CHOICE_KSYM=\"GLIBC\"\n@@ -389,6 +382,7 @@ CT_GLIBC_USE=\"GLIBC\"\n CT_GLIBC_PKG_NAME=\"glibc\"\n CT_GLIBC_SRC_RELEASE=y\n CT_GLIBC_PATCH_ORDER=\"global\"\n+# CT_GLIBC_V_2_29 is not set\n # CT_GLIBC_V_2_28 is not set\n # CT_GLIBC_V_2_27 is not set\n # CT_GLIBC_V_2_26 is not set\n@@ -407,7 +401,6 @@ CT_GLIBC_ARCHIVE_FORMATS=\".tar.xz .tar.bz2 .tar.gz\"\n CT_GLIBC_SIGNATURE_FORMAT=\"packed/.sig\"\n CT_GLIBC_2_29_or_older=y\n CT_GLIBC_older_than_2_29=y\n-CT_GLIBC_REQUIRE_older_than_2_29=y\n CT_GLIBC_2_27_or_older=y\n CT_GLIBC_older_than_2_27=y\n CT_GLIBC_2_26_or_older=y\n@@ -447,12 +440,6 @@ CT_GLIBC_FORCE_UNWIND=y\n CT_GLIBC_KERNEL_VERSION_AS_HEADERS=y\n # CT_GLIBC_KERNEL_VERSION_CHOSEN is not set\n CT_GLIBC_MIN_KERNEL=\"3.2.101\"\n-# CT_GLIBC_SSP_DEFAULT is not set\n-# CT_GLIBC_SSP_NO is not set\n-# CT_GLIBC_SSP_YES is not set\n-# CT_GLIBC_SSP_ALL is not set\n-# CT_GLIBC_SSP_STRONG is not set\n-# CT_NEWLIB_USE_REDHAT is not set\n CT_ALL_LIBC_CHOICES=\"AVR_LIBC BIONIC GLIBC MINGW_W64 MOXIEBOX MUSL NEWLIB NONE UCLIBC\"\n CT_LIBC_SUPPORT_THREADS_ANY=y\n CT_LIBC_SUPPORT_THREADS_NATIVE=y"}, {"sha": "ff9ee67763ba5dbb3f701414b029fca828163127", "filename": "src/tools/build-manifest/src/main.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/78097d96828c16a259fa9b5c2430e8d9ff1820b3/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/78097d96828c16a259fa9b5c2430e8d9ff1820b3/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs?ref=78097d96828c16a259fa9b5c2430e8d9ff1820b3", "patch": "@@ -16,6 +16,7 @@ use std::process::{Command, Stdio};\n \n static HOSTS: &[&str] = &[\n     \"aarch64-unknown-linux-gnu\",\n+    \"aarch64-unknown-linux-musl\",\n     \"arm-unknown-linux-gnueabi\",\n     \"arm-unknown-linux-gnueabihf\",\n     \"armv7-unknown-linux-gnueabihf\","}]}