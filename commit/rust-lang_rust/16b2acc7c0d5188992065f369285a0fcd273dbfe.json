{"sha": "16b2acc7c0d5188992065f369285a0fcd273dbfe", "node_id": "C_kwDOAAsO6NoAKDE2YjJhY2M3YzBkNTE4ODk5MjA2NWYzNjkyODVhMGZjZDI3M2RiZmU", "commit": {"author": {"name": "lcnr", "email": "rust@lcnr.de", "date": "2022-07-08T09:17:12Z"}, "committer": {"name": "lcnr", "email": "rust@lcnr.de", "date": "2022-07-15T15:01:32Z"}, "message": "hir typeck: `fulfillment_cx` ignore regions", "tree": {"sha": "a54d76d29b7356ec82f3a4600d5a0e6c97f8d061", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a54d76d29b7356ec82f3a4600d5a0e6c97f8d061"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/16b2acc7c0d5188992065f369285a0fcd273dbfe", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/16b2acc7c0d5188992065f369285a0fcd273dbfe", "html_url": "https://github.com/rust-lang/rust/commit/16b2acc7c0d5188992065f369285a0fcd273dbfe", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/16b2acc7c0d5188992065f369285a0fcd273dbfe/comments", "author": {"login": "lcnr", "id": 29864074, "node_id": "MDQ6VXNlcjI5ODY0MDc0", "avatar_url": "https://avatars.githubusercontent.com/u/29864074?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lcnr", "html_url": "https://github.com/lcnr", "followers_url": "https://api.github.com/users/lcnr/followers", "following_url": "https://api.github.com/users/lcnr/following{/other_user}", "gists_url": "https://api.github.com/users/lcnr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lcnr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lcnr/subscriptions", "organizations_url": "https://api.github.com/users/lcnr/orgs", "repos_url": "https://api.github.com/users/lcnr/repos", "events_url": "https://api.github.com/users/lcnr/events{/privacy}", "received_events_url": "https://api.github.com/users/lcnr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lcnr", "id": 29864074, "node_id": "MDQ6VXNlcjI5ODY0MDc0", "avatar_url": "https://avatars.githubusercontent.com/u/29864074?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lcnr", "html_url": "https://github.com/lcnr", "followers_url": "https://api.github.com/users/lcnr/followers", "following_url": "https://api.github.com/users/lcnr/following{/other_user}", "gists_url": "https://api.github.com/users/lcnr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lcnr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lcnr/subscriptions", "organizations_url": "https://api.github.com/users/lcnr/orgs", "repos_url": "https://api.github.com/users/lcnr/repos", "events_url": "https://api.github.com/users/lcnr/events{/privacy}", "received_events_url": "https://api.github.com/users/lcnr/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5bd8c960f5f7b07128ebdb12e7f788b1ba0a1902", "url": "https://api.github.com/repos/rust-lang/rust/commits/5bd8c960f5f7b07128ebdb12e7f788b1ba0a1902", "html_url": "https://github.com/rust-lang/rust/commit/5bd8c960f5f7b07128ebdb12e7f788b1ba0a1902"}], "stats": {"total": 12, "additions": 11, "deletions": 1}, "files": [{"sha": "0f7dc6a1257e5eee318905021a75fa539af7c8c7", "filename": "compiler/rustc_trait_selection/src/traits/engine.rs", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/16b2acc7c0d5188992065f369285a0fcd273dbfe/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fengine.rs", "raw_url": "https://github.com/rust-lang/rust/raw/16b2acc7c0d5188992065f369285a0fcd273dbfe/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fengine.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fengine.rs?ref=16b2acc7c0d5188992065f369285a0fcd273dbfe", "patch": "@@ -15,6 +15,8 @@ use rustc_middle::ty::{self, Ty, TyCtxt};\n \n pub trait TraitEngineExt<'tcx> {\n     fn new(tcx: TyCtxt<'tcx>) -> Box<Self>;\n+\n+    fn new_ignoring_regions(tcx: TyCtxt<'tcx>) -> Box<Self>;\n }\n \n impl<'tcx> TraitEngineExt<'tcx> for dyn TraitEngine<'tcx> {\n@@ -25,6 +27,14 @@ impl<'tcx> TraitEngineExt<'tcx> for dyn TraitEngine<'tcx> {\n             Box::new(FulfillmentContext::new())\n         }\n     }\n+\n+    fn new_ignoring_regions(tcx: TyCtxt<'tcx>) -> Box<Self> {\n+        if tcx.sess.opts.unstable_opts.chalk {\n+            Box::new(ChalkFulfillmentContext::new())\n+        } else {\n+            Box::new(FulfillmentContext::new_ignoring_regions())\n+        }\n+    }\n }\n \n /// Used if you want to have pleasant experience when dealing"}, {"sha": "4afbc00b37c7359f67f89cec973e491e077f0bff", "filename": "compiler/rustc_typeck/src/check/inherited.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/16b2acc7c0d5188992065f369285a0fcd273dbfe/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Finherited.rs", "raw_url": "https://github.com/rust-lang/rust/raw/16b2acc7c0d5188992065f369285a0fcd273dbfe/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Finherited.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Finherited.rs?ref=16b2acc7c0d5188992065f369285a0fcd273dbfe", "patch": "@@ -113,7 +113,7 @@ impl<'a, 'tcx> Inherited<'a, 'tcx> {\n                 maybe_typeck_results: infcx.in_progress_typeck_results,\n             },\n             infcx,\n-            fulfillment_cx: RefCell::new(<dyn TraitEngine<'_>>::new(tcx)),\n+            fulfillment_cx: RefCell::new(<dyn TraitEngine<'_>>::new_ignoring_regions(tcx)),\n             locals: RefCell::new(Default::default()),\n             deferred_sized_obligations: RefCell::new(Vec::new()),\n             deferred_call_resolutions: RefCell::new(Default::default()),"}]}