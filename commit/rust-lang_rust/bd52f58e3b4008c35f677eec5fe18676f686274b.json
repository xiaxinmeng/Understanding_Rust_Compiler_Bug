{"sha": "bd52f58e3b4008c35f677eec5fe18676f686274b", "node_id": "C_kwDOAAsO6NoAKGJkNTJmNThlM2I0MDA4YzM1ZjY3N2VlYzVmZTE4Njc2ZjY4NjI3NGI", "commit": {"author": {"name": "ouz-a", "email": "oguz.agcayazi@gmail.com", "date": "2022-07-28T09:56:57Z"}, "committer": {"name": "ouz-a", "email": "oguz.agcayazi@gmail.com", "date": "2022-07-28T09:56:57Z"}, "message": "create type alias", "tree": {"sha": "4cbcef03ba16f3e9384969c163db06957129dc5d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4cbcef03ba16f3e9384969c163db06957129dc5d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bd52f58e3b4008c35f677eec5fe18676f686274b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bd52f58e3b4008c35f677eec5fe18676f686274b", "html_url": "https://github.com/rust-lang/rust/commit/bd52f58e3b4008c35f677eec5fe18676f686274b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bd52f58e3b4008c35f677eec5fe18676f686274b/comments", "author": {"login": "ouz-a", "id": 90461915, "node_id": "MDQ6VXNlcjkwNDYxOTE1", "avatar_url": "https://avatars.githubusercontent.com/u/90461915?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ouz-a", "html_url": "https://github.com/ouz-a", "followers_url": "https://api.github.com/users/ouz-a/followers", "following_url": "https://api.github.com/users/ouz-a/following{/other_user}", "gists_url": "https://api.github.com/users/ouz-a/gists{/gist_id}", "starred_url": "https://api.github.com/users/ouz-a/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ouz-a/subscriptions", "organizations_url": "https://api.github.com/users/ouz-a/orgs", "repos_url": "https://api.github.com/users/ouz-a/repos", "events_url": "https://api.github.com/users/ouz-a/events{/privacy}", "received_events_url": "https://api.github.com/users/ouz-a/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ouz-a", "id": 90461915, "node_id": "MDQ6VXNlcjkwNDYxOTE1", "avatar_url": "https://avatars.githubusercontent.com/u/90461915?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ouz-a", "html_url": "https://github.com/ouz-a", "followers_url": "https://api.github.com/users/ouz-a/followers", "following_url": "https://api.github.com/users/ouz-a/following{/other_user}", "gists_url": "https://api.github.com/users/ouz-a/gists{/gist_id}", "starred_url": "https://api.github.com/users/ouz-a/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ouz-a/subscriptions", "organizations_url": "https://api.github.com/users/ouz-a/orgs", "repos_url": "https://api.github.com/users/ouz-a/repos", "events_url": "https://api.github.com/users/ouz-a/events{/privacy}", "received_events_url": "https://api.github.com/users/ouz-a/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a5c895e1d8f8b9f17d4c91a6741f082eca67a3cc", "url": "https://api.github.com/repos/rust-lang/rust/commits/a5c895e1d8f8b9f17d4c91a6741f082eca67a3cc", "html_url": "https://github.com/rust-lang/rust/commit/a5c895e1d8f8b9f17d4c91a6741f082eca67a3cc"}], "stats": {"total": 26, "additions": 10, "deletions": 16}, "files": [{"sha": "b8634fd568bc8250a172afa82a21460d64b5d434", "filename": "compiler/rustc_mir_dataflow/src/move_paths/builder.rs", "status": "modified", "additions": 7, "deletions": 11, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/bd52f58e3b4008c35f677eec5fe18676f686274b/compiler%2Frustc_mir_dataflow%2Fsrc%2Fmove_paths%2Fbuilder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bd52f58e3b4008c35f677eec5fe18676f686274b/compiler%2Frustc_mir_dataflow%2Fsrc%2Fmove_paths%2Fbuilder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_dataflow%2Fsrc%2Fmove_paths%2Fbuilder.rs?ref=bd52f58e3b4008c35f677eec5fe18676f686274b", "patch": "@@ -207,13 +207,12 @@ impl<'b, 'a, 'tcx> Gatherer<'b, 'a, 'tcx> {\n     }\n }\n \n+pub type MoveDat<'tcx> = (FxHashMap<Local, Place<'tcx>>, MoveData<'tcx>);\n+\n impl<'a, 'tcx> MoveDataBuilder<'a, 'tcx> {\n     fn finalize(\n         self,\n-    ) -> Result<\n-        (FxHashMap<rustc_middle::mir::Local, rustc_middle::mir::Place<'tcx>>, MoveData<'tcx>),\n-        (MoveData<'tcx>, Vec<(Place<'tcx>, MoveError<'tcx>)>),\n-    > {\n+    ) -> Result<MoveDat<'tcx>, (MoveData<'tcx>, Vec<(Place<'tcx>, MoveError<'tcx>)>)> {\n         debug!(\"{}\", {\n             debug!(\"moves for {:?}:\", self.body.span);\n             for (j, mo) in self.data.moves.iter_enumerated() {\n@@ -226,10 +225,10 @@ impl<'a, 'tcx> MoveDataBuilder<'a, 'tcx> {\n             \"done dumping moves\"\n         });\n \n-        if !self.errors.is_empty() {\n-            Err((self.data, self.errors))\n-        } else {\n+        if self.errors.is_empty() {\n             Ok((self.un_derefer.derefer_sidetable, self.data))\n+        } else {\n+            Err((self.data, self.errors))\n         }\n     }\n }\n@@ -238,10 +237,7 @@ pub(super) fn gather_moves<'tcx>(\n     body: &Body<'tcx>,\n     tcx: TyCtxt<'tcx>,\n     param_env: ty::ParamEnv<'tcx>,\n-) -> Result<\n-    (FxHashMap<rustc_middle::mir::Local, rustc_middle::mir::Place<'tcx>>, MoveData<'tcx>),\n-    (MoveData<'tcx>, Vec<(Place<'tcx>, MoveError<'tcx>)>),\n-> {\n+) -> Result<MoveDat<'tcx>, (MoveData<'tcx>, Vec<(Place<'tcx>, MoveError<'tcx>)>)> {\n     let mut builder = MoveDataBuilder::new(body, tcx, param_env);\n \n     builder.gather_args();"}, {"sha": "aeb985143fddcedd0deb9b9a51cc293f7563d5ac", "filename": "compiler/rustc_mir_dataflow/src/move_paths/mod.rs", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/bd52f58e3b4008c35f677eec5fe18676f686274b/compiler%2Frustc_mir_dataflow%2Fsrc%2Fmove_paths%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bd52f58e3b4008c35f677eec5fe18676f686274b/compiler%2Frustc_mir_dataflow%2Fsrc%2Fmove_paths%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_dataflow%2Fsrc%2Fmove_paths%2Fmod.rs?ref=bd52f58e3b4008c35f677eec5fe18676f686274b", "patch": "@@ -1,3 +1,4 @@\n+use crate::move_paths::builder::MoveDat;\n use rustc_data_structures::fx::FxHashMap;\n use rustc_index::vec::IndexVec;\n use rustc_middle::mir::*;\n@@ -386,10 +387,7 @@ impl<'tcx> MoveData<'tcx> {\n         body: &Body<'tcx>,\n         tcx: TyCtxt<'tcx>,\n         param_env: ParamEnv<'tcx>,\n-    ) -> Result<\n-        (FxHashMap<rustc_middle::mir::Local, rustc_middle::mir::Place<'tcx>>, MoveData<'tcx>),\n-        (MoveData<'tcx>, Vec<(Place<'tcx>, MoveError<'tcx>)>),\n-    > {\n+    ) -> Result<MoveDat<'tcx>, (MoveData<'tcx>, Vec<(Place<'tcx>, MoveError<'tcx>)>)> {\n         builder::gather_moves(body, tcx, param_env)\n     }\n "}, {"sha": "f2471f37a5266b744c4fe1d30ce36e16bd7f3f69", "filename": "compiler/rustc_mir_dataflow/src/rustc_peek.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/bd52f58e3b4008c35f677eec5fe18676f686274b/compiler%2Frustc_mir_dataflow%2Fsrc%2Frustc_peek.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bd52f58e3b4008c35f677eec5fe18676f686274b/compiler%2Frustc_mir_dataflow%2Fsrc%2Frustc_peek.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_dataflow%2Fsrc%2Frustc_peek.rs?ref=bd52f58e3b4008c35f677eec5fe18676f686274b", "patch": "@@ -31,7 +31,7 @@ impl<'tcx> MirPass<'tcx> for SanityCheck {\n \n         let param_env = tcx.param_env(def_id);\n         let (_, move_data) = MoveData::gather_moves(body, tcx, param_env).unwrap();\n-        let mdpe = MoveDataParamEnv { move_data: move_data, param_env };\n+        let mdpe = MoveDataParamEnv { move_data, param_env };\n \n         if has_rustc_mir_with(tcx, def_id, sym::rustc_peek_maybe_init).is_some() {\n             let flow_inits = MaybeInitializedPlaces::new(tcx, body, &mdpe)"}]}