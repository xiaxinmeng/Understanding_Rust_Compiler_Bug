{"sha": "f16e3837090416ba771649aecc591421a1ebb7e8", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYxNmUzODM3MDkwNDE2YmE3NzE2NDlhZWNjNTkxNDIxYTFlYmI3ZTg=", "commit": {"author": {"name": "flip1995", "email": "hello@philkrones.com", "date": "2020-01-29T14:46:38Z"}, "committer": {"name": "flip1995", "email": "hello@philkrones.com", "date": "2020-02-01T15:41:31Z"}, "message": "Don't trigger `debug_assert_with_mut_call` on `.await`", "tree": {"sha": "5c1bb0017be94ce05620069435d007e1f81182c1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5c1bb0017be94ce05620069435d007e1f81182c1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f16e3837090416ba771649aecc591421a1ebb7e8", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZxoS6lESXlRGMHWcaTCGhp1QZjcFAl41nCsACgkQaTCGhp1Q\nZje8Gw//bk2bvzvZ5XOphgxOIoDskPzIQ6Id6mUdFevodEXd7Je3EU0aC8hMnskc\nfaUQymRB/y9AiP6XjzdY+YrW21mSEcLlA7tY/rorGfPB5VDVdD9qjNxxVys/9eUK\nehcMkZmm6wRX8sNkPKxFMOeJXePV+N78fkLSiC62mILBuaU5M4GlYG3atK2fW8FE\nZNTf72bFHcF81yCJR6KNkqU1FqFziRltef2Dd1lZ73Y5vX0f8ihK4rFRpuLOsOnD\n9Z3T9MrnPfLU0XeUNDpp/YWFWk5BLrj0gJIdf22Zu4aMwwAEy76PYGed5vt1MrMr\nb5xFypagzWbJ1eVqLn2mlsLnOAThlSeyqiZuFWSD7bC31LyH3+RNAk6TiOnmzxxB\n9aHao3Vj3of/xyaOjwSlXkV+XiuPoAfU7wyYtVYdiXv5KE9xcYzb2kRhTxpqLLxG\nAGDTvx9rCrm0rnyw1dqx3pCTcHk12hsI32Q0+GvJYYBpKUoAiIDIUSKkCIZ4K1ry\njhPn2Vl0mHW/ImGd0lBLIYe9/x/Xq9xnuta9G5uADNdSLk3pj4Zq6kIZJyaSoP83\nQwJFw+bzVRLf5vYQFDXXxCLhVKe/jFIoUN/8zhMWcElCwYP5aVNi2cj3qALtpxQR\np79gHk76B68Jyl2IOgDzhGv3Q5mvfMSVPPdLcrLSBX9rGSrRrFc=\n=MCD+\n-----END PGP SIGNATURE-----", "payload": "tree 5c1bb0017be94ce05620069435d007e1f81182c1\nparent 2c4df2418c7b7c6d1f23e8d5257183015d4572aa\nauthor flip1995 <hello@philkrones.com> 1580309198 +0100\ncommitter flip1995 <hello@philkrones.com> 1580571691 +0100\n\nDon't trigger `debug_assert_with_mut_call` on `.await`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f16e3837090416ba771649aecc591421a1ebb7e8", "html_url": "https://github.com/rust-lang/rust/commit/f16e3837090416ba771649aecc591421a1ebb7e8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f16e3837090416ba771649aecc591421a1ebb7e8/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2c4df2418c7b7c6d1f23e8d5257183015d4572aa", "url": "https://api.github.com/repos/rust-lang/rust/commits/2c4df2418c7b7c6d1f23e8d5257183015d4572aa", "html_url": "https://github.com/rust-lang/rust/commit/2c4df2418c7b7c6d1f23e8d5257183015d4572aa"}], "stats": {"total": 4, "additions": 3, "deletions": 1}, "files": [{"sha": "881f59bbabdffb76b5db63d732ae364996fde469", "filename": "clippy_lints/src/mutable_debug_assertion.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/f16e3837090416ba771649aecc591421a1ebb7e8/clippy_lints%2Fsrc%2Fmutable_debug_assertion.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f16e3837090416ba771649aecc591421a1ebb7e8/clippy_lints%2Fsrc%2Fmutable_debug_assertion.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmutable_debug_assertion.rs?ref=f16e3837090416ba771649aecc591421a1ebb7e8", "patch": "@@ -4,7 +4,7 @@ use matches::matches;\n use rustc::hir::map::Map;\n use rustc::ty;\n use rustc_hir::intravisit::{walk_expr, NestedVisitorMap, Visitor};\n-use rustc_hir::{BorrowKind, Expr, ExprKind, Mutability, StmtKind, UnOp};\n+use rustc_hir::{BorrowKind, Expr, ExprKind, MatchSource, Mutability, StmtKind, UnOp};\n use rustc_lint::{LateContext, LateLintPass};\n use rustc_session::{declare_lint_pass, declare_tool_lint};\n use rustc_span::Span;\n@@ -147,6 +147,8 @@ impl<'a, 'tcx> Visitor<'tcx> for MutArgVisitor<'a, 'tcx> {\n                     }\n                 }\n             },\n+            // Don't check await desugars\n+            ExprKind::Match(_, _, MatchSource::AwaitDesugar) => return,\n             _ if !self.found => self.expr_span = Some(expr.span),\n             _ => return,\n         }"}]}