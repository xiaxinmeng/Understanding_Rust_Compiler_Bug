{"sha": "9741fbd202b2b55de95abe1eb7f3d8185e312444", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk3NDFmYmQyMDJiMmI1NWRlOTVhYmUxZWI3ZjNkODE4NWUzMTI0NDQ=", "commit": {"author": {"name": "Jake Goulding", "email": "jake.goulding@gmail.com", "date": "2020-07-11T13:38:01Z"}, "committer": {"name": "Jake Goulding", "email": "jake.goulding@gmail.com", "date": "2020-07-12T18:34:33Z"}, "message": "Don't allow `DESTDIR` to influence LLVM builds\n\nWhen running a command like `DESTDIR=foo x.py install` in a completely\nclean build directory, this will cause LLVM to be installed into\n`DESTDIR`, which then causes the build to fail later when it attempts\nto *use* those LLVM files.", "tree": {"sha": "dad7383a22008b4346f63e2329438209bea08d0e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/dad7383a22008b4346f63e2329438209bea08d0e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9741fbd202b2b55de95abe1eb7f3d8185e312444", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9741fbd202b2b55de95abe1eb7f3d8185e312444", "html_url": "https://github.com/rust-lang/rust/commit/9741fbd202b2b55de95abe1eb7f3d8185e312444", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9741fbd202b2b55de95abe1eb7f3d8185e312444/comments", "author": {"login": "shepmaster", "id": 174509, "node_id": "MDQ6VXNlcjE3NDUwOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/174509?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shepmaster", "html_url": "https://github.com/shepmaster", "followers_url": "https://api.github.com/users/shepmaster/followers", "following_url": "https://api.github.com/users/shepmaster/following{/other_user}", "gists_url": "https://api.github.com/users/shepmaster/gists{/gist_id}", "starred_url": "https://api.github.com/users/shepmaster/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shepmaster/subscriptions", "organizations_url": "https://api.github.com/users/shepmaster/orgs", "repos_url": "https://api.github.com/users/shepmaster/repos", "events_url": "https://api.github.com/users/shepmaster/events{/privacy}", "received_events_url": "https://api.github.com/users/shepmaster/received_events", "type": "User", "site_admin": false}, "committer": {"login": "shepmaster", "id": 174509, "node_id": "MDQ6VXNlcjE3NDUwOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/174509?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shepmaster", "html_url": "https://github.com/shepmaster", "followers_url": "https://api.github.com/users/shepmaster/followers", "following_url": "https://api.github.com/users/shepmaster/following{/other_user}", "gists_url": "https://api.github.com/users/shepmaster/gists{/gist_id}", "starred_url": "https://api.github.com/users/shepmaster/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shepmaster/subscriptions", "organizations_url": "https://api.github.com/users/shepmaster/orgs", "repos_url": "https://api.github.com/users/shepmaster/repos", "events_url": "https://api.github.com/users/shepmaster/events{/privacy}", "received_events_url": "https://api.github.com/users/shepmaster/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9d09331e00b02f81c714b0c41ce3a38380dd36a2", "url": "https://api.github.com/repos/rust-lang/rust/commits/9d09331e00b02f81c714b0c41ce3a38380dd36a2", "html_url": "https://github.com/rust-lang/rust/commit/9d09331e00b02f81c714b0c41ce3a38380dd36a2"}], "stats": {"total": 5, "additions": 5, "deletions": 0}, "files": [{"sha": "ca0b3ddc920ed6d9faeda24a0578266d7032646a", "filename": "src/bootstrap/native.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/9741fbd202b2b55de95abe1eb7f3d8185e312444/src%2Fbootstrap%2Fnative.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9741fbd202b2b55de95abe1eb7f3d8185e312444/src%2Fbootstrap%2Fnative.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fnative.rs?ref=9741fbd202b2b55de95abe1eb7f3d8185e312444", "patch": "@@ -347,6 +347,11 @@ fn configure_cmake(\n     // LLVM and LLD builds can produce a lot of those and hit CI limits on log size.\n     cfg.define(\"CMAKE_INSTALL_MESSAGE\", \"LAZY\");\n \n+    // Do not allow the user's value of DESTDIR to influence where\n+    // LLVM will install itself. LLVM must always be installed in our\n+    // own build directories.\n+    cfg.env(\"DESTDIR\", \"\");\n+\n     if builder.config.ninja {\n         cfg.generator(\"Ninja\");\n     }"}]}