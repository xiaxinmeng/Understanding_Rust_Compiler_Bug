{"sha": "86dfca278dd5f9f589cecfe6de91ad8264c300d0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg2ZGZjYTI3OGRkNWY5ZjU4OWNlY2ZlNmRlOTFhZDgyNjRjMzAwZDA=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2012-07-11T22:10:18Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2012-07-11T22:10:18Z"}, "message": "Try less complicated trick for solving the dSYM glob portability issue.", "tree": {"sha": "611c35ec303a3dce55ce95fde2964a040c00692b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/611c35ec303a3dce55ce95fde2964a040c00692b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/86dfca278dd5f9f589cecfe6de91ad8264c300d0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/86dfca278dd5f9f589cecfe6de91ad8264c300d0", "html_url": "https://github.com/rust-lang/rust/commit/86dfca278dd5f9f589cecfe6de91ad8264c300d0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/86dfca278dd5f9f589cecfe6de91ad8264c300d0/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "63df2484146a3f2e34aa743ac600eb82620cb70a", "url": "https://api.github.com/repos/rust-lang/rust/commits/63df2484146a3f2e34aa743ac600eb82620cb70a", "html_url": "https://github.com/rust-lang/rust/commit/63df2484146a3f2e34aa743ac600eb82620cb70a"}], "stats": {"total": 15, "additions": 2, "deletions": 13}, "files": [{"sha": "3c35e4beb040ca505e7f04229490e3025024b8f7", "filename": "mk/host.mk", "status": "modified", "additions": 0, "deletions": 11, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/86dfca278dd5f9f589cecfe6de91ad8264c300d0/mk%2Fhost.mk", "raw_url": "https://github.com/rust-lang/rust/raw/86dfca278dd5f9f589cecfe6de91ad8264c300d0/mk%2Fhost.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fhost.mk?ref=86dfca278dd5f9f589cecfe6de91ad8264c300d0", "patch": "@@ -31,7 +31,6 @@ $$(HLIB$(2)_H_$(4))/$$(CFG_LIBRUSTC): \\\n \t@$$(call E, cp: $$@)\n \t$$(Q)cp $$< $$@\n \t$$(Q)cp -R $$(TLIB$(1)_T_$(4)_H_$(3))/$(LIBRUSTC_GLOB) \\\n-\t\t$$(TLIB$(1)_T_$(4)_H_$(3))/$(LIBRUSTC_DSYM_GLOB) \\\n \t        $$(HLIB$(2)_H_$(4))\n \n $$(HLIB$(2)_H_$(4))/$$(CFG_LIBSYNTAX): \\\n@@ -43,7 +42,6 @@ $$(HLIB$(2)_H_$(4))/$$(CFG_LIBSYNTAX): \\\n \t@$$(call E, cp: $$@)\n \t$$(Q)cp $$< $$@\n \t$$(Q)cp -R $$(TLIB$(1)_T_$(4)_H_$(3))/$(LIBSYNTAX_GLOB) \\\n-\t\t$$(TLIB$(1)_T_$(4)_H_$(3))/$(LIBSYNTAX_DSYM_GLOB) \\\n \t        $$(HLIB$(2)_H_$(4))\n \n $$(HLIB$(2)_H_$(4))/$$(CFG_RUNTIME): \\\n@@ -56,15 +54,7 @@ $$(HLIB$(2)_H_$(4))/$$(CFG_CORELIB): \\\n \t$$(HLIB$(2)_H_$(4))/$$(CFG_RUNTIME)\n \t@$$(call E, cp: $$@)\n \t$$(Q)cp $$< $$@\n-# Subtle: We do not let the shell expand $(CORELIB_DSYM_GLOB) directly rather\n-# we use Make's $$(wildcard) facility. The reason is that, on mac, when using\n-# USE_SNAPSHOT_CORELIB, we copy the core.dylib file out of the snapshot.\n-# In that case, there is no .dSYM file.  Annoyingly, bash then refuses to expand\n-# glob, and cp reports an error because libcore-*.dylib.dsym does not exist.\n-# Make instead expands the glob to nothing, which gives us the correct behavior.\n-# (Copy .dsym file if it exists, but do nothing otherwise)\n \t$$(Q)cp -R $$(TLIB$(1)_T_$(4)_H_$(3))/$(CORELIB_GLOB) \\\n-\t\t$$(wildcard $$(TLIB$(1)_T_$(4)_H_$(3))/$(CORELIB_DSYM_GLOB)) \\\n \t        $$(HLIB$(2)_H_$(4))\n \n $$(HLIB$(2)_H_$(4))/$$(CFG_STDLIB): \\\n@@ -74,7 +64,6 @@ $$(HLIB$(2)_H_$(4))/$$(CFG_STDLIB): \\\n \t@$$(call E, cp: $$@)\n \t$$(Q)cp $$< $$@\n \t$$(Q)cp -R $$(TLIB$(1)_T_$(4)_H_$(3))/$(STDLIB_GLOB) \\\n-\t\t$$(wildcard $$(TLIB$(1)_T_$(4)_H_$(3))/$(STDLIB_DSYM_GLOB)) \\\n \t        $$(HLIB$(2)_H_$(4))\n \n $$(HLIB$(2)_H_$(4))/libcore.rlib: \\"}, {"sha": "ec3c5174b56bc851efa64935091555050cb5f1d9", "filename": "mk/platform.mk", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/86dfca278dd5f9f589cecfe6de91ad8264c300d0/mk%2Fplatform.mk", "raw_url": "https://github.com/rust-lang/rust/raw/86dfca278dd5f9f589cecfe6de91ad8264c300d0/mk%2Fplatform.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fplatform.mk?ref=86dfca278dd5f9f589cecfe6de91ad8264c300d0", "patch": "@@ -76,8 +76,8 @@ endif\n \n ifneq ($(findstring darwin,$(CFG_OSTYPE)),)\n   CFG_LIB_NAME=lib$(1).dylib\n-  CFG_LIB_GLOB=lib$(1)-*.dylib\n-  CFG_LIB_DSYM_GLOB=lib$(1)-*.dylib.dSYM\n+  # needs trailing * to pick up the .dSYM file too\n+  CFG_LIB_GLOB=lib$(1)-*.dylib*\n   CFG_UNIXY := 1\n   CFG_LDENV := DYLD_LIBRARY_PATH\n   CFG_GCCISH_LINK_FLAGS += -dynamiclib -lpthread -framework CoreServices -Wl,-no_compact_unwind"}]}