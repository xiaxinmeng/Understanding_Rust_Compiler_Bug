{"sha": "bdbbbe687ec6e644838926693db7ad5dcf3c7c4d", "node_id": "C_kwDOAAsO6NoAKGJkYmJiZTY4N2VjNmU2NDQ4Mzg5MjY2OTNkYjdhZDVkY2YzYzdjNGQ", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2022-08-27T04:14:25Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-08-27T04:14:25Z"}, "message": "Rollup merge of #101062 - notriddle:notriddle/text-javascript, r=GuillaumeGomez\n\nrustdoc: remove empty extern_crates and type=\"text/javascript\" on script\n\nLike #101023, this removes an attribute with a default value.", "tree": {"sha": "d9684e9b3560bd4b2c9c45ea82bad15cae689ddf", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d9684e9b3560bd4b2c9c45ea82bad15cae689ddf"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bdbbbe687ec6e644838926693db7ad5dcf3c7c4d", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjCZohCRBK7hj4Ov3rIwAAgnUIAASH1INJci5tO7IQiJFWVBSf\nx57oDIW4WZvZc1U4bWDLfpgYi027Qv7VOyzBhxVlhk0lR1hkwrXOnPK+pZGUq4XW\nsp2/GvFifnfdwWUoqLeb6JqVz9hv7Ckv0I6j8AzC4QD1uU2bzAybLfOvTDbnmoRe\niAb+wSYxBFCydA9NU8QEzFPyW8F9TqJVWF3JXpIp8Yk9kQShFES9M6zNI95hYbkZ\n90MpgYeUNE3QDHU9J42TtbO4c7cLOBQjFbq9sY4VZeJPg82PwwT5LuB9VH2/7rrt\nZX0+2lXgclF2Jj5WvBF7V2wH+Vx77PxFcM2MygdFKrU1m4/6hHYz7cL3/xjYD8Q=\n=gTuy\n-----END PGP SIGNATURE-----\n", "payload": "tree d9684e9b3560bd4b2c9c45ea82bad15cae689ddf\nparent aa6b7508546d011ad61a814cc0c086d15fb15617\nparent 52582d301d8ffbf0787ad4dd426f0ec7dab8f76f\nauthor Yuki Okushi <jtitor@2k36.org> 1661573665 +0900\ncommitter GitHub <noreply@github.com> 1661573665 +0900\n\nRollup merge of #101062 - notriddle:notriddle/text-javascript, r=GuillaumeGomez\n\nrustdoc: remove empty extern_crates and type=\"text/javascript\" on script\n\nLike #101023, this removes an attribute with a default value.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bdbbbe687ec6e644838926693db7ad5dcf3c7c4d", "html_url": "https://github.com/rust-lang/rust/commit/bdbbbe687ec6e644838926693db7ad5dcf3c7c4d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bdbbbe687ec6e644838926693db7ad5dcf3c7c4d/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "aa6b7508546d011ad61a814cc0c086d15fb15617", "url": "https://api.github.com/repos/rust-lang/rust/commits/aa6b7508546d011ad61a814cc0c086d15fb15617", "html_url": "https://github.com/rust-lang/rust/commit/aa6b7508546d011ad61a814cc0c086d15fb15617"}, {"sha": "52582d301d8ffbf0787ad4dd426f0ec7dab8f76f", "url": "https://api.github.com/repos/rust-lang/rust/commits/52582d301d8ffbf0787ad4dd426f0ec7dab8f76f", "html_url": "https://github.com/rust-lang/rust/commit/52582d301d8ffbf0787ad4dd426f0ec7dab8f76f"}], "stats": {"total": 12, "additions": 7, "deletions": 5}, "files": [{"sha": "710064a37d0415e1cac3ff91d11b767c4defc195", "filename": "src/librustdoc/html/render/print_item.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/bdbbbe687ec6e644838926693db7ad5dcf3c7c4d/src%2Flibrustdoc%2Fhtml%2Frender%2Fprint_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bdbbbe687ec6e644838926693db7ad5dcf3c7c4d/src%2Flibrustdoc%2Fhtml%2Frender%2Fprint_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fprint_item.rs?ref=bdbbbe687ec6e644838926693db7ad5dcf3c7c4d", "patch": "@@ -997,7 +997,7 @@ fn item_trait(w: &mut Buffer, cx: &mut Context<'_>, it: &clean::Item, t: &clean:\n     // So C's HTML will have something like this:\n     //\n     // ```html\n-    // <script type=\"text/javascript\" src=\"/implementors/A/trait.Foo.js\"\n+    // <script src=\"/implementors/A/trait.Foo.js\"\n     //     data-ignore-extern-crates=\"A,B\" async></script>\n     // ```\n     //\n@@ -1023,9 +1023,11 @@ fn item_trait(w: &mut Buffer, cx: &mut Context<'_>, it: &clean::Item, t: &clean:\n         .map(|cnum| cx.shared.tcx.crate_name(cnum).to_string())\n         .collect::<Vec<_>>()\n         .join(\",\");\n+    let (extern_before, extern_after) =\n+        if extern_crates.is_empty() { (\"\", \"\") } else { (\" data-ignore-extern-crates=\\\"\", \"\\\"\") };\n     write!(\n         w,\n-        \"<script type=\\\"text/javascript\\\" src=\\\"{src}\\\" data-ignore-extern-crates=\\\"{extern_crates}\\\" async></script>\",\n+        \"<script src=\\\"{src}\\\"{extern_before}{extern_crates}{extern_after} async></script>\",\n         src = js_src_path.finish(),\n     );\n }"}, {"sha": "7f61c95e794b0696fde560ee74a6d42dd8a3ac95", "filename": "src/librustdoc/html/static/js/main.js", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/bdbbbe687ec6e644838926693db7ad5dcf3c7c4d/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/bdbbbe687ec6e644838926693db7ad5dcf3c7c4d/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js?ref=bdbbbe687ec6e644838926693db7ad5dcf3c7c4d", "patch": "@@ -528,9 +528,9 @@ function loadCss(cssFileName) {\n         // We don't want to include impls from this JS file, when the HTML already has them.\n         // The current crate should always be ignored. Other crates that should also be\n         // ignored are included in the attribute `data-ignore-extern-crates`.\n-        const ignoreExternCrates = document\n-            .querySelector(\"script[data-ignore-extern-crates]\")\n-            .getAttribute(\"data-ignore-extern-crates\");\n+        const script = document\n+            .querySelector(\"script[data-ignore-extern-crates]\");\n+        const ignoreExternCrates = script ? script.getAttribute(\"data-ignore-extern-crates\") : \"\";\n         for (const lib of libs) {\n             if (lib === window.currentCrate || ignoreExternCrates.indexOf(lib) !== -1) {\n                 continue;"}]}