{"sha": "a539b5e69349817e8ee535eb3a28764d5e2718b7", "node_id": "C_kwDOAAsO6NoAKGE1MzliNWU2OTM0OTgxN2U4ZWU1MzVlYjNhMjg3NjRkNWUyNzE4Yjc", "commit": {"author": {"name": "zhoufan", "email": "1247714429@qq.com", "date": "2021-11-18T03:11:37Z"}, "committer": {"name": "zhoufan", "email": "1247714429@qq.com", "date": "2021-11-18T03:11:37Z"}, "message": "fix: parse the range pat inside the tuple pat", "tree": {"sha": "ce9723a2ca6669c3e6587ad6768d621ac38e8bb2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ce9723a2ca6669c3e6587ad6768d621ac38e8bb2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a539b5e69349817e8ee535eb3a28764d5e2718b7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a539b5e69349817e8ee535eb3a28764d5e2718b7", "html_url": "https://github.com/rust-lang/rust/commit/a539b5e69349817e8ee535eb3a28764d5e2718b7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a539b5e69349817e8ee535eb3a28764d5e2718b7/comments", "author": {"login": "xffxff", "id": 30254428, "node_id": "MDQ6VXNlcjMwMjU0NDI4", "avatar_url": "https://avatars.githubusercontent.com/u/30254428?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xffxff", "html_url": "https://github.com/xffxff", "followers_url": "https://api.github.com/users/xffxff/followers", "following_url": "https://api.github.com/users/xffxff/following{/other_user}", "gists_url": "https://api.github.com/users/xffxff/gists{/gist_id}", "starred_url": "https://api.github.com/users/xffxff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xffxff/subscriptions", "organizations_url": "https://api.github.com/users/xffxff/orgs", "repos_url": "https://api.github.com/users/xffxff/repos", "events_url": "https://api.github.com/users/xffxff/events{/privacy}", "received_events_url": "https://api.github.com/users/xffxff/received_events", "type": "User", "site_admin": false}, "committer": {"login": "xffxff", "id": 30254428, "node_id": "MDQ6VXNlcjMwMjU0NDI4", "avatar_url": "https://avatars.githubusercontent.com/u/30254428?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xffxff", "html_url": "https://github.com/xffxff", "followers_url": "https://api.github.com/users/xffxff/followers", "following_url": "https://api.github.com/users/xffxff/following{/other_user}", "gists_url": "https://api.github.com/users/xffxff/gists{/gist_id}", "starred_url": "https://api.github.com/users/xffxff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xffxff/subscriptions", "organizations_url": "https://api.github.com/users/xffxff/orgs", "repos_url": "https://api.github.com/users/xffxff/repos", "events_url": "https://api.github.com/users/xffxff/events{/privacy}", "received_events_url": "https://api.github.com/users/xffxff/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fdd49b97133a77ff652017d24b72ced37d4a822d", "url": "https://api.github.com/repos/rust-lang/rust/commits/fdd49b97133a77ff652017d24b72ced37d4a822d", "html_url": "https://github.com/rust-lang/rust/commit/fdd49b97133a77ff652017d24b72ced37d4a822d"}], "stats": {"total": 250, "additions": 168, "deletions": 82}, "files": [{"sha": "70ff87b238613f3162e0d643a4a4a6c6c1be0d24", "filename": "crates/parser/src/grammar/patterns.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/a539b5e69349817e8ee535eb3a28764d5e2718b7/crates%2Fparser%2Fsrc%2Fgrammar%2Fpatterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a539b5e69349817e8ee535eb3a28764d5e2718b7/crates%2Fparser%2Fsrc%2Fgrammar%2Fpatterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Fsrc%2Fgrammar%2Fpatterns.rs?ref=a539b5e69349817e8ee535eb3a28764d5e2718b7", "patch": "@@ -74,6 +74,11 @@ fn pattern_single_r(p: &mut Parser, recovery_set: TokenSet) {\n         //         Some(0) | None => (),\n         //         Some(1..) => ()\n         //     }\n+        //\n+        //     match (10 as u8, 5 as u8) {\n+        //         (0, _) => (),\n+        //         (1.., _) => ()\n+        //     }\n         // }\n \n         // FIXME: support half_open_range_patterns (`..=2`),\n@@ -85,7 +90,7 @@ fn pattern_single_r(p: &mut Parser, recovery_set: TokenSet) {\n \n                 // `0 .. =>` or `let 0 .. =` or `Some(0 .. )`\n                 //       ^                ^                ^\n-                if p.at(T![=]) | p.at(T![')']) {\n+                if p.at(T![=]) | p.at(T![')']) | p.at(T![,]) {\n                     // test half_open_range_pat\n                     // fn f() { let 0 .. = 1u32; }\n                 } else {"}, {"sha": "0eb5af54b880bbb42defae2105f5d33e3164d4af", "filename": "crates/syntax/test_data/parser/inline/ok/0058_range_pat.rast", "status": "modified", "additions": 157, "deletions": 81, "changes": 238, "blob_url": "https://github.com/rust-lang/rust/blob/a539b5e69349817e8ee535eb3a28764d5e2718b7/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0058_range_pat.rast", "raw_url": "https://github.com/rust-lang/rust/raw/a539b5e69349817e8ee535eb3a28764d5e2718b7/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0058_range_pat.rast", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0058_range_pat.rast?ref=a539b5e69349817e8ee535eb3a28764d5e2718b7", "patch": "@@ -1,5 +1,5 @@\n-SOURCE_FILE@0..223\n-  FN@0..222\n+SOURCE_FILE@0..307\n+  FN@0..306\n     FN_KW@0..2 \"fn\"\n     WHITESPACE@2..3 \" \"\n     NAME@3..7\n@@ -8,8 +8,8 @@ SOURCE_FILE@0..223\n       L_PAREN@7..8 \"(\"\n       R_PAREN@8..9 \")\"\n     WHITESPACE@9..10 \" \"\n-    BLOCK_EXPR@10..222\n-      STMT_LIST@10..222\n+    BLOCK_EXPR@10..306\n+      STMT_LIST@10..306\n         L_CURLY@10..11 \"{\"\n         WHITESPACE@11..16 \"\\n    \"\n         EXPR_STMT@16..132\n@@ -96,80 +96,156 @@ SOURCE_FILE@0..223\n               WHITESPACE@126..131 \"\\n    \"\n               R_CURLY@131..132 \"}\"\n         WHITESPACE@132..138 \"\\n\\n    \"\n-        MATCH_EXPR@138..220\n-          MATCH_KW@138..143 \"match\"\n-          WHITESPACE@143..144 \" \"\n-          CALL_EXPR@144..158\n-            PATH_EXPR@144..148\n-              PATH@144..148\n-                PATH_SEGMENT@144..148\n-                  NAME_REF@144..148\n-                    IDENT@144..148 \"Some\"\n-            ARG_LIST@148..158\n-              L_PAREN@148..149 \"(\"\n-              CAST_EXPR@149..157\n-                LITERAL@149..151\n-                  INT_NUMBER@149..151 \"10\"\n-                WHITESPACE@151..152 \" \"\n-                AS_KW@152..154 \"as\"\n-                WHITESPACE@154..155 \" \"\n-                PATH_TYPE@155..157\n-                  PATH@155..157\n-                    PATH_SEGMENT@155..157\n-                      NAME_REF@155..157\n-                        IDENT@155..157 \"u8\"\n-              R_PAREN@157..158 \")\"\n-          WHITESPACE@158..159 \" \"\n-          MATCH_ARM_LIST@159..220\n-            L_CURLY@159..160 \"{\"\n-            WHITESPACE@160..169 \"\\n        \"\n-            MATCH_ARM@169..190\n-              OR_PAT@169..183\n-                TUPLE_STRUCT_PAT@169..176\n-                  PATH@169..173\n-                    PATH_SEGMENT@169..173\n-                      NAME_REF@169..173\n-                        IDENT@169..173 \"Some\"\n-                  L_PAREN@173..174 \"(\"\n-                  LITERAL_PAT@174..175\n-                    LITERAL@174..175\n-                      INT_NUMBER@174..175 \"0\"\n-                  R_PAREN@175..176 \")\"\n-                WHITESPACE@176..177 \" \"\n-                PIPE@177..178 \"|\"\n-                WHITESPACE@178..179 \" \"\n-                IDENT_PAT@179..183\n-                  NAME@179..183\n-                    IDENT@179..183 \"None\"\n-              WHITESPACE@183..184 \" \"\n-              FAT_ARROW@184..186 \"=>\"\n-              WHITESPACE@186..187 \" \"\n-              TUPLE_EXPR@187..189\n-                L_PAREN@187..188 \"(\"\n-                R_PAREN@188..189 \")\"\n-              COMMA@189..190 \",\"\n-            WHITESPACE@190..199 \"\\n        \"\n-            MATCH_ARM@199..214\n-              TUPLE_STRUCT_PAT@199..208\n-                PATH@199..203\n-                  PATH_SEGMENT@199..203\n-                    NAME_REF@199..203\n-                      IDENT@199..203 \"Some\"\n-                L_PAREN@203..204 \"(\"\n-                RANGE_PAT@204..207\n-                  LITERAL_PAT@204..205\n-                    LITERAL@204..205\n-                      INT_NUMBER@204..205 \"1\"\n-                  DOT2@205..207 \"..\"\n-                R_PAREN@207..208 \")\"\n-              WHITESPACE@208..209 \" \"\n-              FAT_ARROW@209..211 \"=>\"\n-              WHITESPACE@211..212 \" \"\n-              TUPLE_EXPR@212..214\n-                L_PAREN@212..213 \"(\"\n-                R_PAREN@213..214 \")\"\n-            WHITESPACE@214..219 \"\\n    \"\n-            R_CURLY@219..220 \"}\"\n-        WHITESPACE@220..221 \"\\n\"\n-        R_CURLY@221..222 \"}\"\n-  WHITESPACE@222..223 \"\\n\"\n+        EXPR_STMT@138..220\n+          MATCH_EXPR@138..220\n+            MATCH_KW@138..143 \"match\"\n+            WHITESPACE@143..144 \" \"\n+            CALL_EXPR@144..158\n+              PATH_EXPR@144..148\n+                PATH@144..148\n+                  PATH_SEGMENT@144..148\n+                    NAME_REF@144..148\n+                      IDENT@144..148 \"Some\"\n+              ARG_LIST@148..158\n+                L_PAREN@148..149 \"(\"\n+                CAST_EXPR@149..157\n+                  LITERAL@149..151\n+                    INT_NUMBER@149..151 \"10\"\n+                  WHITESPACE@151..152 \" \"\n+                  AS_KW@152..154 \"as\"\n+                  WHITESPACE@154..155 \" \"\n+                  PATH_TYPE@155..157\n+                    PATH@155..157\n+                      PATH_SEGMENT@155..157\n+                        NAME_REF@155..157\n+                          IDENT@155..157 \"u8\"\n+                R_PAREN@157..158 \")\"\n+            WHITESPACE@158..159 \" \"\n+            MATCH_ARM_LIST@159..220\n+              L_CURLY@159..160 \"{\"\n+              WHITESPACE@160..169 \"\\n        \"\n+              MATCH_ARM@169..190\n+                OR_PAT@169..183\n+                  TUPLE_STRUCT_PAT@169..176\n+                    PATH@169..173\n+                      PATH_SEGMENT@169..173\n+                        NAME_REF@169..173\n+                          IDENT@169..173 \"Some\"\n+                    L_PAREN@173..174 \"(\"\n+                    LITERAL_PAT@174..175\n+                      LITERAL@174..175\n+                        INT_NUMBER@174..175 \"0\"\n+                    R_PAREN@175..176 \")\"\n+                  WHITESPACE@176..177 \" \"\n+                  PIPE@177..178 \"|\"\n+                  WHITESPACE@178..179 \" \"\n+                  IDENT_PAT@179..183\n+                    NAME@179..183\n+                      IDENT@179..183 \"None\"\n+                WHITESPACE@183..184 \" \"\n+                FAT_ARROW@184..186 \"=>\"\n+                WHITESPACE@186..187 \" \"\n+                TUPLE_EXPR@187..189\n+                  L_PAREN@187..188 \"(\"\n+                  R_PAREN@188..189 \")\"\n+                COMMA@189..190 \",\"\n+              WHITESPACE@190..199 \"\\n        \"\n+              MATCH_ARM@199..214\n+                TUPLE_STRUCT_PAT@199..208\n+                  PATH@199..203\n+                    PATH_SEGMENT@199..203\n+                      NAME_REF@199..203\n+                        IDENT@199..203 \"Some\"\n+                  L_PAREN@203..204 \"(\"\n+                  RANGE_PAT@204..207\n+                    LITERAL_PAT@204..205\n+                      LITERAL@204..205\n+                        INT_NUMBER@204..205 \"1\"\n+                    DOT2@205..207 \"..\"\n+                  R_PAREN@207..208 \")\"\n+                WHITESPACE@208..209 \" \"\n+                FAT_ARROW@209..211 \"=>\"\n+                WHITESPACE@211..212 \" \"\n+                TUPLE_EXPR@212..214\n+                  L_PAREN@212..213 \"(\"\n+                  R_PAREN@213..214 \")\"\n+              WHITESPACE@214..219 \"\\n    \"\n+              R_CURLY@219..220 \"}\"\n+        WHITESPACE@220..226 \"\\n\\n    \"\n+        MATCH_EXPR@226..304\n+          MATCH_KW@226..231 \"match\"\n+          WHITESPACE@231..232 \" \"\n+          TUPLE_EXPR@232..251\n+            L_PAREN@232..233 \"(\"\n+            CAST_EXPR@233..241\n+              LITERAL@233..235\n+                INT_NUMBER@233..235 \"10\"\n+              WHITESPACE@235..236 \" \"\n+              AS_KW@236..238 \"as\"\n+              WHITESPACE@238..239 \" \"\n+              PATH_TYPE@239..241\n+                PATH@239..241\n+                  PATH_SEGMENT@239..241\n+                    NAME_REF@239..241\n+                      IDENT@239..241 \"u8\"\n+            COMMA@241..242 \",\"\n+            WHITESPACE@242..243 \" \"\n+            CAST_EXPR@243..250\n+              LITERAL@243..244\n+                INT_NUMBER@243..244 \"5\"\n+              WHITESPACE@244..245 \" \"\n+              AS_KW@245..247 \"as\"\n+              WHITESPACE@247..248 \" \"\n+              PATH_TYPE@248..250\n+                PATH@248..250\n+                  PATH_SEGMENT@248..250\n+                    NAME_REF@248..250\n+                      IDENT@248..250 \"u8\"\n+            R_PAREN@250..251 \")\"\n+          WHITESPACE@251..252 \" \"\n+          MATCH_ARM_LIST@252..304\n+            L_CURLY@252..253 \"{\"\n+            WHITESPACE@253..262 \"\\n        \"\n+            MATCH_ARM@262..275\n+              TUPLE_PAT@262..268\n+                L_PAREN@262..263 \"(\"\n+                LITERAL_PAT@263..264\n+                  LITERAL@263..264\n+                    INT_NUMBER@263..264 \"0\"\n+                COMMA@264..265 \",\"\n+                WHITESPACE@265..266 \" \"\n+                WILDCARD_PAT@266..267\n+                  UNDERSCORE@266..267 \"_\"\n+                R_PAREN@267..268 \")\"\n+              WHITESPACE@268..269 \" \"\n+              FAT_ARROW@269..271 \"=>\"\n+              WHITESPACE@271..272 \" \"\n+              TUPLE_EXPR@272..274\n+                L_PAREN@272..273 \"(\"\n+                R_PAREN@273..274 \")\"\n+              COMMA@274..275 \",\"\n+            WHITESPACE@275..284 \"\\n        \"\n+            MATCH_ARM@284..298\n+              TUPLE_PAT@284..292\n+                L_PAREN@284..285 \"(\"\n+                RANGE_PAT@285..288\n+                  LITERAL_PAT@285..286\n+                    LITERAL@285..286\n+                      INT_NUMBER@285..286 \"1\"\n+                  DOT2@286..288 \"..\"\n+                COMMA@288..289 \",\"\n+                WHITESPACE@289..290 \" \"\n+                WILDCARD_PAT@290..291\n+                  UNDERSCORE@290..291 \"_\"\n+                R_PAREN@291..292 \")\"\n+              WHITESPACE@292..293 \" \"\n+              FAT_ARROW@293..295 \"=>\"\n+              WHITESPACE@295..296 \" \"\n+              TUPLE_EXPR@296..298\n+                L_PAREN@296..297 \"(\"\n+                R_PAREN@297..298 \")\"\n+            WHITESPACE@298..303 \"\\n    \"\n+            R_CURLY@303..304 \"}\"\n+        WHITESPACE@304..305 \"\\n\"\n+        R_CURLY@305..306 \"}\"\n+  WHITESPACE@306..307 \"\\n\""}, {"sha": "6c586a895609837a8cd05e8da871dac85ceebbc6", "filename": "crates/syntax/test_data/parser/inline/ok/0058_range_pat.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/a539b5e69349817e8ee535eb3a28764d5e2718b7/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0058_range_pat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a539b5e69349817e8ee535eb3a28764d5e2718b7/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0058_range_pat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0058_range_pat.rs?ref=a539b5e69349817e8ee535eb3a28764d5e2718b7", "patch": "@@ -10,4 +10,9 @@ fn main() {\n         Some(0) | None => (),\n         Some(1..) => ()\n     }\n+\n+    match (10 as u8, 5 as u8) {\n+        (0, _) => (),\n+        (1.., _) => ()\n+    }\n }"}]}