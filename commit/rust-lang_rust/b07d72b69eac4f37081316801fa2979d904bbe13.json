{"sha": "b07d72b69eac4f37081316801fa2979d904bbe13", "node_id": "C_kwDOAAsO6NoAKGIwN2Q3MmI2OWVhYzRmMzcwODEzMTY4MDFmYTI5NzlkOTA0YmJlMTM", "commit": {"author": {"name": "dswij", "email": "dswijj@gmail.com", "date": "2022-08-27T16:06:30Z"}, "committer": {"name": "dswij", "email": "dswijj@gmail.com", "date": "2022-08-27T16:07:00Z"}, "message": "Ignore  when there is comment", "tree": {"sha": "2a241c5885de92dd17a8706e01dba76d98e02b59", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2a241c5885de92dd17a8706e01dba76d98e02b59"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b07d72b69eac4f37081316801fa2979d904bbe13", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b07d72b69eac4f37081316801fa2979d904bbe13", "html_url": "https://github.com/rust-lang/rust/commit/b07d72b69eac4f37081316801fa2979d904bbe13", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b07d72b69eac4f37081316801fa2979d904bbe13/comments", "author": {"login": "dswij", "id": 44697459, "node_id": "MDQ6VXNlcjQ0Njk3NDU5", "avatar_url": "https://avatars.githubusercontent.com/u/44697459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dswij", "html_url": "https://github.com/dswij", "followers_url": "https://api.github.com/users/dswij/followers", "following_url": "https://api.github.com/users/dswij/following{/other_user}", "gists_url": "https://api.github.com/users/dswij/gists{/gist_id}", "starred_url": "https://api.github.com/users/dswij/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dswij/subscriptions", "organizations_url": "https://api.github.com/users/dswij/orgs", "repos_url": "https://api.github.com/users/dswij/repos", "events_url": "https://api.github.com/users/dswij/events{/privacy}", "received_events_url": "https://api.github.com/users/dswij/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dswij", "id": 44697459, "node_id": "MDQ6VXNlcjQ0Njk3NDU5", "avatar_url": "https://avatars.githubusercontent.com/u/44697459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dswij", "html_url": "https://github.com/dswij", "followers_url": "https://api.github.com/users/dswij/followers", "following_url": "https://api.github.com/users/dswij/following{/other_user}", "gists_url": "https://api.github.com/users/dswij/gists{/gist_id}", "starred_url": "https://api.github.com/users/dswij/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dswij/subscriptions", "organizations_url": "https://api.github.com/users/dswij/orgs", "repos_url": "https://api.github.com/users/dswij/repos", "events_url": "https://api.github.com/users/dswij/events{/privacy}", "received_events_url": "https://api.github.com/users/dswij/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "51e9113c60ce0699c8d343102828f26928081dc3", "url": "https://api.github.com/repos/rust-lang/rust/commits/51e9113c60ce0699c8d343102828f26928081dc3", "html_url": "https://github.com/rust-lang/rust/commit/51e9113c60ce0699c8d343102828f26928081dc3"}], "stats": {"total": 54, "additions": 53, "deletions": 1}, "files": [{"sha": "34cc082687ec20426d6f36ae4c1aa11a4530458a", "filename": "clippy_lints/src/matches/match_like_matches.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b07d72b69eac4f37081316801fa2979d904bbe13/clippy_lints%2Fsrc%2Fmatches%2Fmatch_like_matches.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b07d72b69eac4f37081316801fa2979d904bbe13/clippy_lints%2Fsrc%2Fmatches%2Fmatch_like_matches.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmatches%2Fmatch_like_matches.rs?ref=b07d72b69eac4f37081316801fa2979d904bbe13", "patch": "@@ -1,10 +1,11 @@\n use clippy_utils::diagnostics::span_lint_and_sugg;\n use clippy_utils::is_wild;\n use clippy_utils::source::snippet_with_applicability;\n+use clippy_utils::span_contains_comment;\n use rustc_ast::{Attribute, LitKind};\n use rustc_errors::Applicability;\n use rustc_hir::{Arm, BorrowKind, Expr, ExprKind, Guard, Pat};\n-use rustc_lint::LateContext;\n+use rustc_lint::{LateContext, LintContext};\n use rustc_middle::ty;\n use rustc_span::source_map::Spanned;\n \n@@ -76,6 +77,7 @@ where\n         >,\n {\n     if_chain! {\n+        if !span_contains_comment(cx.sess().source_map(), expr.span);\n         if iter.len() >= 2;\n         if cx.typeck_results().expr_ty(expr).is_bool();\n         if let Some((_, last_pat_opt, last_expr, _)) = iter.next_back();"}, {"sha": "95ca571d07bfbf88fcce5d626814d6f210156ee2", "filename": "tests/ui/match_expr_like_matches_macro.fixed", "status": "modified", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/b07d72b69eac4f37081316801fa2979d904bbe13/tests%2Fui%2Fmatch_expr_like_matches_macro.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/b07d72b69eac4f37081316801fa2979d904bbe13/tests%2Fui%2Fmatch_expr_like_matches_macro.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmatch_expr_like_matches_macro.fixed?ref=b07d72b69eac4f37081316801fa2979d904bbe13", "patch": "@@ -167,4 +167,29 @@ fn main() {\n             _ => false,\n         };\n     }\n+\n+    let x = ' ';\n+    // ignore if match block contains comment\n+    let _line_comments = match x {\n+        // numbers are bad!\n+        '1' | '2' | '3' => true,\n+        // spaces are very important to be true.\n+        ' ' => true,\n+        // as are dots\n+        '.' => true,\n+        _ => false,\n+    };\n+\n+    let _block_comments = match x {\n+        /* numbers are bad!\n+         */\n+        '1' | '2' | '3' => true,\n+        /* spaces are very important to be true.\n+         */\n+        ' ' => true,\n+        /* as are dots\n+         */\n+        '.' => true,\n+        _ => false,\n+    };\n }"}, {"sha": "3b9c8cadadcc417ebbe731a3735dd98580837e46", "filename": "tests/ui/match_expr_like_matches_macro.rs", "status": "modified", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/b07d72b69eac4f37081316801fa2979d904bbe13/tests%2Fui%2Fmatch_expr_like_matches_macro.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b07d72b69eac4f37081316801fa2979d904bbe13/tests%2Fui%2Fmatch_expr_like_matches_macro.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmatch_expr_like_matches_macro.rs?ref=b07d72b69eac4f37081316801fa2979d904bbe13", "patch": "@@ -208,4 +208,29 @@ fn main() {\n             _ => false,\n         };\n     }\n+\n+    let x = ' ';\n+    // ignore if match block contains comment\n+    let _line_comments = match x {\n+        // numbers are bad!\n+        '1' | '2' | '3' => true,\n+        // spaces are very important to be true.\n+        ' ' => true,\n+        // as are dots\n+        '.' => true,\n+        _ => false,\n+    };\n+\n+    let _block_comments = match x {\n+        /* numbers are bad!\n+         */\n+        '1' | '2' | '3' => true,\n+        /* spaces are very important to be true.\n+         */\n+        ' ' => true,\n+        /* as are dots\n+         */\n+        '.' => true,\n+        _ => false,\n+    };\n }"}]}