{"sha": "e6ea19d7bd17cf7252d6af90781665d5e87ea156", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU2ZWExOWQ3YmQxN2NmNzI1MmQ2YWY5MDc4MTY2NWQ1ZTg3ZWExNTY=", "commit": {"author": {"name": "Tom Tromey", "email": "tom@tromey.com", "date": "2018-09-25T18:27:09Z"}, "committer": {"name": "Tom Tromey", "email": "tom@tromey.com", "date": "2018-09-25T18:27:09Z"}, "message": "Include path in stamp hash for debuginfo tests\n\nThe debuginfo tests are exposed to the environment in a couple of\nways: the path to the gdb executable matters, as does the Python path\nused when loading lldb.\n\nThis patch incorporates these paths into the hash that is written to\nthe stamp file, so that changing the path will cause the tests to be\nre-run.", "tree": {"sha": "9cac8b894f52b82b4feadb70f73e11dec04a9da3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9cac8b894f52b82b4feadb70f73e11dec04a9da3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e6ea19d7bd17cf7252d6af90781665d5e87ea156", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e6ea19d7bd17cf7252d6af90781665d5e87ea156", "html_url": "https://github.com/rust-lang/rust/commit/e6ea19d7bd17cf7252d6af90781665d5e87ea156", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e6ea19d7bd17cf7252d6af90781665d5e87ea156/comments", "author": {"login": "tromey", "id": 1557670, "node_id": "MDQ6VXNlcjE1NTc2NzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tromey", "html_url": "https://github.com/tromey", "followers_url": "https://api.github.com/users/tromey/followers", "following_url": "https://api.github.com/users/tromey/following{/other_user}", "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}", "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tromey/subscriptions", "organizations_url": "https://api.github.com/users/tromey/orgs", "repos_url": "https://api.github.com/users/tromey/repos", "events_url": "https://api.github.com/users/tromey/events{/privacy}", "received_events_url": "https://api.github.com/users/tromey/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tromey", "id": 1557670, "node_id": "MDQ6VXNlcjE1NTc2NzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1557670?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tromey", "html_url": "https://github.com/tromey", "followers_url": "https://api.github.com/users/tromey/followers", "following_url": "https://api.github.com/users/tromey/following{/other_user}", "gists_url": "https://api.github.com/users/tromey/gists{/gist_id}", "starred_url": "https://api.github.com/users/tromey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tromey/subscriptions", "organizations_url": "https://api.github.com/users/tromey/orgs", "repos_url": "https://api.github.com/users/tromey/repos", "events_url": "https://api.github.com/users/tromey/events{/privacy}", "received_events_url": "https://api.github.com/users/tromey/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ae366637fedf6f34185e54fc7b2d725b1a458ff6", "url": "https://api.github.com/repos/rust-lang/rust/commits/ae366637fedf6f34185e54fc7b2d725b1a458ff6", "html_url": "https://github.com/rust-lang/rust/commit/ae366637fedf6f34185e54fc7b2d725b1a458ff6"}], "stats": {"total": 13, "additions": 13, "deletions": 0}, "files": [{"sha": "f1a275b05c91b740c6c1bc74f39aa592119c70e3", "filename": "src/tools/compiletest/src/runtest.rs", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/e6ea19d7bd17cf7252d6af90781665d5e87ea156/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e6ea19d7bd17cf7252d6af90781665d5e87ea156/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs?ref=e6ea19d7bd17cf7252d6af90781665d5e87ea156", "patch": "@@ -224,6 +224,19 @@ pub fn run(config: Config, testpaths: &TestPaths, revision: Option<&str>) {\n pub fn compute_stamp_hash(config: &Config) -> String {\n     let mut hash = DefaultHasher::new();\n     config.stage_id.hash(&mut hash);\n+    match config.mode {\n+        DebugInfoGdb => match config.gdb {\n+            None => env::var_os(\"PATH\").hash(&mut hash),\n+            Some(ref s) if s.is_empty() => env::var_os(\"PATH\").hash(&mut hash),\n+            Some(ref s) => s.hash(&mut hash),\n+        },\n+        DebugInfoLldb => {\n+            env::var_os(\"PATH\").hash(&mut hash);\n+            env::var_os(\"PYTHONPATH\").hash(&mut hash);\n+        },\n+\n+        _ => {},\n+    };\n     format!(\"{:x}\", hash.finish())\n }\n "}]}