{"sha": "f9576a6fce3a185ef6f61045a566f47c7bd54758", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY5NTc2YTZmY2UzYTE4NWVmNmY2MTA0NWE1NjZmNDdjN2JkNTQ3NTg=", "commit": {"author": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2019-07-15T23:55:10Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-07-15T23:55:10Z"}, "message": "Rollup merge of #62668 - goodmanjonathan:fix-62660, r=estebank\n\nFix #62660\n\nIf the explicitly given type of a `self` parameter fails to parse correctly, we need to propagate the error rather than dropping it and causing an ICE.\n\nFixes #62660.", "tree": {"sha": "a4952f77b74dd0eb58ceb924a877ec6dae144983", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a4952f77b74dd0eb58ceb924a877ec6dae144983"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f9576a6fce3a185ef6f61045a566f47c7bd54758", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdLRJeCRBK7hj4Ov3rIwAAdHIIAA2Qs+m19ynUsC9rTfK/WBP5\n7SJOwkWgAS11eFNnXxcJZu+SHw4z/em3zC/+G90db0XttKYJjQi47JfJddbtDob/\nl5gYF0SpCOvVe197+f83u09hYcxTWStQmpTZLTGVadm78eAyZ+zWROdS5wk1cBV5\nyOsJfpi4h31LPDqa2b6a9iUyX7cxIlyhHw5jQ/w1FyOAgzyfcG4MLXlw/K2Mq0pb\nWOSMbMyHKBPaHehwXb7SPS6VV3YQdVsfnRlnzou1oB3nm9d4whL6zaCzGsQtzxAV\nvcb293jlKWeKJWa1fysc8I9ntZL17Nf681JOkX7t8anSaGn/uDGDdOH4thZShb8=\n=yTtn\n-----END PGP SIGNATURE-----\n", "payload": "tree a4952f77b74dd0eb58ceb924a877ec6dae144983\nparent aa480100b38c349aa0288f553911d498be8583ce\nparent 7111328556e0580f1323cde3d5193eb8d2767693\nauthor Mark Rousskov <mark.simulacrum@gmail.com> 1563234910 -0400\ncommitter GitHub <noreply@github.com> 1563234910 -0400\n\nRollup merge of #62668 - goodmanjonathan:fix-62660, r=estebank\n\nFix #62660\n\nIf the explicitly given type of a `self` parameter fails to parse correctly, we need to propagate the error rather than dropping it and causing an ICE.\n\nFixes #62660.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f9576a6fce3a185ef6f61045a566f47c7bd54758", "html_url": "https://github.com/rust-lang/rust/commit/f9576a6fce3a185ef6f61045a566f47c7bd54758", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f9576a6fce3a185ef6f61045a566f47c7bd54758/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "aa480100b38c349aa0288f553911d498be8583ce", "url": "https://api.github.com/repos/rust-lang/rust/commits/aa480100b38c349aa0288f553911d498be8583ce", "html_url": "https://github.com/rust-lang/rust/commit/aa480100b38c349aa0288f553911d498be8583ce"}, {"sha": "7111328556e0580f1323cde3d5193eb8d2767693", "url": "https://api.github.com/repos/rust-lang/rust/commits/7111328556e0580f1323cde3d5193eb8d2767693", "html_url": "https://github.com/rust-lang/rust/commit/7111328556e0580f1323cde3d5193eb8d2767693"}], "stats": {"total": 21, "additions": 20, "deletions": 1}, "files": [{"sha": "050b614d1477b38e079c8954b47d31de37fb9d79", "filename": "src/libsyntax/parse/parser.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f9576a6fce3a185ef6f61045a566f47c7bd54758/src%2Flibsyntax%2Fparse%2Fparser.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f9576a6fce3a185ef6f61045a566f47c7bd54758/src%2Flibsyntax%2Fparse%2Fparser.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Fparser.rs?ref=f9576a6fce3a185ef6f61045a566f47c7bd54758", "patch": "@@ -1498,7 +1498,7 @@ impl<'a> Parser<'a> {\n         F: Fn(&token::Token) -> bool\n     {\n         let attrs = self.parse_arg_attributes()?;\n-        if let Ok(Some(mut arg)) = self.parse_self_arg() {\n+        if let Some(mut arg) = self.parse_self_arg()? {\n             arg.attrs = attrs.into();\n             return self.recover_bad_self_arg(arg, is_trait_item);\n         }"}, {"sha": "33c8a9fa328ca2ee696ec3e88907f6f14c1f0069", "filename": "src/test/ui/parser/issue-62660.rs", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/f9576a6fce3a185ef6f61045a566f47c7bd54758/src%2Ftest%2Fui%2Fparser%2Fissue-62660.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f9576a6fce3a185ef6f61045a566f47c7bd54758/src%2Ftest%2Fui%2Fparser%2Fissue-62660.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissue-62660.rs?ref=f9576a6fce3a185ef6f61045a566f47c7bd54758", "patch": "@@ -0,0 +1,11 @@\n+// Regression test for issue #62660: if a receiver's type does not\n+// successfully parse, emit the correct error instead of ICE-ing the compiler.\n+\n+struct Foo;\n+\n+impl Foo {\n+    pub fn foo(_: i32, self: Box<Self) {}\n+    //~^ ERROR expected one of `!`, `(`, `+`, `,`, `::`, `<`, or `>`, found `)`\n+}\n+\n+fn main() {}"}, {"sha": "3a8f6797b82fb7f5829ea2be7c137e147b26794b", "filename": "src/test/ui/parser/issue-62660.stderr", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/f9576a6fce3a185ef6f61045a566f47c7bd54758/src%2Ftest%2Fui%2Fparser%2Fissue-62660.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/f9576a6fce3a185ef6f61045a566f47c7bd54758/src%2Ftest%2Fui%2Fparser%2Fissue-62660.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissue-62660.stderr?ref=f9576a6fce3a185ef6f61045a566f47c7bd54758", "patch": "@@ -0,0 +1,8 @@\n+error: expected one of `!`, `(`, `+`, `,`, `::`, `<`, or `>`, found `)`\n+  --> $DIR/issue-62660.rs:7:38\n+   |\n+LL |     pub fn foo(_: i32, self: Box<Self) {}\n+   |                                      ^ expected one of 7 possible tokens here\n+\n+error: aborting due to previous error\n+"}]}