{"sha": "b4ecbe93401a56181baaffc4ff7e275aeecc5182", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI0ZWNiZTkzNDAxYTU2MTgxYmFhZmZjNGZmN2UyNzVhZWVjYzUxODI=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2014-04-22T05:28:21Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2014-04-23T17:03:43Z"}, "message": "std: Change Finally to take `&mut self`\n\nAs with the previous commits, the Finally trait is primarily implemented for\nclosures, so the trait was modified from `&self` to `&mut self`. This will\nrequire that any closure variable invoked with `finally` to be stored in a\nmutable slot.\n\n[breaking-change]", "tree": {"sha": "8dcae1c59342fc3de1954f500e74467c9d14f5fc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8dcae1c59342fc3de1954f500e74467c9d14f5fc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b4ecbe93401a56181baaffc4ff7e275aeecc5182", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b4ecbe93401a56181baaffc4ff7e275aeecc5182", "html_url": "https://github.com/rust-lang/rust/commit/b4ecbe93401a56181baaffc4ff7e275aeecc5182", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b4ecbe93401a56181baaffc4ff7e275aeecc5182/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2b2d1e14c97b7692debf62dd2739049f1f377a5e", "url": "https://api.github.com/repos/rust-lang/rust/commits/2b2d1e14c97b7692debf62dd2739049f1f377a5e", "html_url": "https://github.com/rust-lang/rust/commit/2b2d1e14c97b7692debf62dd2739049f1f377a5e"}], "stats": {"total": 12, "additions": 6, "deletions": 6}, "files": [{"sha": "2dab0e975da3c0b4bc8bc3dbcb8ede55d571f112", "filename": "src/libstd/rt/task.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b4ecbe93401a56181baaffc4ff7e275aeecc5182/src%2Flibstd%2Frt%2Ftask.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b4ecbe93401a56181baaffc4ff7e275aeecc5182/src%2Flibstd%2Frt%2Ftask.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Frt%2Ftask.rs?ref=b4ecbe93401a56181baaffc4ff7e275aeecc5182", "patch": "@@ -109,7 +109,7 @@ impl Task {\n     /// This function is *not* meant to be abused as a \"try/catch\" block. This\n     /// is meant to be used at the absolute boundaries of a task's lifetime, and\n     /// only for that purpose.\n-    pub fn run(~self, f: ||) -> ~Task {\n+    pub fn run(~self, mut f: ||) -> ~Task {\n         // Need to put ourselves into TLS, but also need access to the unwinder.\n         // Unsafely get a handle to the task so we can continue to use it after\n         // putting it in tls (so we can invoke the unwinder)."}, {"sha": "96e52a4818eec66fa4098954f6a3834dcdb92ca2", "filename": "src/libstd/unstable/finally.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/b4ecbe93401a56181baaffc4ff7e275aeecc5182/src%2Flibstd%2Funstable%2Ffinally.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b4ecbe93401a56181baaffc4ff7e275aeecc5182/src%2Flibstd%2Funstable%2Ffinally.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Funstable%2Ffinally.rs?ref=b4ecbe93401a56181baaffc4ff7e275aeecc5182", "patch": "@@ -35,19 +35,19 @@ use ops::Drop;\n #[cfg(test)] use task::failing;\n \n pub trait Finally<T> {\n-    fn finally(&self, dtor: ||) -> T;\n+    fn finally(&mut self, dtor: ||) -> T;\n }\n \n impl<'a,T> Finally<T> for ||: 'a -> T {\n-    fn finally(&self, dtor: ||) -> T {\n-        try_finally(&mut (), (),\n-                    |_, _| (*self)(),\n+    fn finally(&mut self, dtor: ||) -> T {\n+        try_finally(&mut (), self,\n+                    |_, f| (*f)(),\n                     |_| dtor())\n     }\n }\n \n impl<T> Finally<T> for fn() -> T {\n-    fn finally(&self, dtor: ||) -> T {\n+    fn finally(&mut self, dtor: ||) -> T {\n         try_finally(&mut (), (),\n                     |_, _| (*self)(),\n                     |_| dtor())"}]}