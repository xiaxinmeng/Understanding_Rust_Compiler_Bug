{"sha": "b428f287c3ddb951450bc5f94cf3a5e38a59e3d6", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI0MjhmMjg3YzNkZGI5NTE0NTBiYzVmOTRjZjNhNWUzOGE1OWUzZDY=", "commit": {"author": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2020-09-23T18:58:41Z"}, "committer": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2020-09-25T17:38:23Z"}, "message": "Bless tests", "tree": {"sha": "96054ec9fa65667f6156a2186595a09c9a3bece8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/96054ec9fa65667f6156a2186595a09c9a3bece8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6", "html_url": "https://github.com/rust-lang/rust/commit/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/comments", "author": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6a52c094408370a3bd60ed0976211995ef52fc23", "url": "https://api.github.com/repos/rust-lang/rust/commits/6a52c094408370a3bd60ed0976211995ef52fc23", "html_url": "https://github.com/rust-lang/rust/commit/6a52c094408370a3bd60ed0976211995ef52fc23"}], "stats": {"total": 48, "additions": 24, "deletions": 24}, "files": [{"sha": "094ae7378bce827e4c5c88931f8477701bc7843c", "filename": "src/test/ui/consts/const-extern-fn/const-extern-fn-min-const-fn.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-min-const-fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-min-const-fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-min-const-fn.rs?ref=b428f287c3ddb951450bc5f94cf3a5e38a59e3d6", "patch": "@@ -4,7 +4,7 @@ const extern fn unsize(x: &[u8; 3]) -> &[u8] { x }\n const unsafe extern \"C\" fn closure() -> fn() { || {} }\n //~^ ERROR function pointers in const fn are unstable\n const unsafe extern fn use_float() { 1.0 + 1.0; }\n-//~^ ERROR only int, `bool` and `char` operations are stable in const fn\n+//~^ ERROR floating point arithmetic\n const extern \"C\" fn ptr_cast(val: *const u8) { val as usize; }\n //~^ ERROR casting pointers to integers\n "}, {"sha": "49caac00ca88489a16137e78695db37a6d4e093a", "filename": "src/test/ui/consts/const-extern-fn/const-extern-fn-min-const-fn.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-min-const-fn.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-min-const-fn.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-extern-fn%2Fconst-extern-fn-min-const-fn.stderr?ref=b428f287c3ddb951450bc5f94cf3a5e38a59e3d6", "patch": "@@ -7,14 +7,14 @@ LL | const unsafe extern \"C\" fn closure() -> fn() { || {} }\n    = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n-error[E0723]: only int, `bool` and `char` operations are stable in const fn\n+error[E0658]: floating point arithmetic is not allowed in constant functions\n   --> $DIR/const-extern-fn-min-const-fn.rs:6:38\n    |\n LL | const unsafe extern fn use_float() { 1.0 + 1.0; }\n    |                                      ^^^^^^^^^\n    |\n    = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n-   = help: add `#![feature(const_fn)]` to the crate attributes to enable\n+   = help: add `#![feature(const_fn_floating_point_arithmetic)]` to the crate attributes to enable\n \n error[E0658]: casting pointers to integers in constant functions is unstable\n   --> $DIR/const-extern-fn-min-const-fn.rs:8:48"}, {"sha": "e15f4b804f716ddcd31f3adc9424117e7e2f4eaf", "filename": "src/test/ui/consts/const_let_eq_float.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fconst_let_eq_float.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fconst_let_eq_float.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_let_eq_float.rs?ref=b428f287c3ddb951450bc5f94cf3a5e38a59e3d6", "patch": "@@ -1,6 +1,6 @@\n-// build-pass (FIXME(62277): could be check-pass?)\n+// run-pass\n \n-#![feature(const_fn)]\n+#![feature(const_fn_floating_point_arithmetic)]\n \n struct Foo<T>(T);\n struct Bar<T> { x: T }"}, {"sha": "86b26a53371d8164c38bcd0626d2e0ba6f98007f", "filename": "src/test/ui/consts/min_const_fn/min_const_fn.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.rs?ref=b428f287c3ddb951450bc5f94cf3a5e38a59e3d6", "patch": "@@ -78,13 +78,13 @@ const fn foo11<T: std::fmt::Display>(t: T) -> T { t }\n const fn foo11_2<T: Send>(t: T) -> T { t }\n //~^ ERROR trait bounds other than `Sized` on const fn parameters are unstable\n const fn foo19(f: f32) -> f32 { f * 2.0 }\n-//~^ ERROR int, `bool` and `char` operations\n+//~^ ERROR floating point arithmetic\n const fn foo19_2(f: f32) -> f32 { 2.0 - f }\n-//~^ ERROR int, `bool` and `char` operations\n+//~^ ERROR floating point arithmetic\n const fn foo19_3(f: f32) -> f32 { -f }\n-//~^ ERROR int, `bool` and `char` operations\n+//~^ ERROR floating point arithmetic\n const fn foo19_4(f: f32, g: f32) -> f32 { f / g }\n-//~^ ERROR int, `bool` and `char` operations\n+//~^ ERROR floating point arithmetic\n \n static BAR: u32 = 42;\n const fn foo25() -> u32 { BAR } //~ ERROR cannot refer to statics"}, {"sha": "60c4eef795359f9407d45f953bd0397092b312c3", "filename": "src/test/ui/consts/min_const_fn/min_const_fn.stderr", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.stderr?ref=b428f287c3ddb951450bc5f94cf3a5e38a59e3d6", "patch": "@@ -76,41 +76,41 @@ LL | const fn foo11_2<T: Send>(t: T) -> T { t }\n    = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n-error[E0723]: only int, `bool` and `char` operations are stable in const fn\n+error[E0658]: floating point arithmetic is not allowed in constant functions\n   --> $DIR/min_const_fn.rs:80:33\n    |\n LL | const fn foo19(f: f32) -> f32 { f * 2.0 }\n    |                                 ^^^^^^^\n    |\n    = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n-   = help: add `#![feature(const_fn)]` to the crate attributes to enable\n+   = help: add `#![feature(const_fn_floating_point_arithmetic)]` to the crate attributes to enable\n \n-error[E0723]: only int, `bool` and `char` operations are stable in const fn\n+error[E0658]: floating point arithmetic is not allowed in constant functions\n   --> $DIR/min_const_fn.rs:82:35\n    |\n LL | const fn foo19_2(f: f32) -> f32 { 2.0 - f }\n    |                                   ^^^^^^^\n    |\n    = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n-   = help: add `#![feature(const_fn)]` to the crate attributes to enable\n+   = help: add `#![feature(const_fn_floating_point_arithmetic)]` to the crate attributes to enable\n \n-error[E0723]: only int, `bool` and `char` operations are stable in const fn\n+error[E0658]: floating point arithmetic is not allowed in constant functions\n   --> $DIR/min_const_fn.rs:84:35\n    |\n LL | const fn foo19_3(f: f32) -> f32 { -f }\n    |                                   ^^\n    |\n    = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n-   = help: add `#![feature(const_fn)]` to the crate attributes to enable\n+   = help: add `#![feature(const_fn_floating_point_arithmetic)]` to the crate attributes to enable\n \n-error[E0723]: only int, `bool` and `char` operations are stable in const fn\n+error[E0658]: floating point arithmetic is not allowed in constant functions\n   --> $DIR/min_const_fn.rs:86:43\n    |\n LL | const fn foo19_4(f: f32, g: f32) -> f32 { f / g }\n    |                                           ^^^^^\n    |\n    = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n-   = help: add `#![feature(const_fn)]` to the crate attributes to enable\n+   = help: add `#![feature(const_fn_floating_point_arithmetic)]` to the crate attributes to enable\n \n error[E0013]: constant functions cannot refer to statics\n   --> $DIR/min_const_fn.rs:90:27"}, {"sha": "292e2dd167c919d0800887e0b77ec632489fefdf", "filename": "src/test/ui/consts/min_const_fn/min_const_fn_libstd_stability.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn_libstd_stability.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn_libstd_stability.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn_libstd_stability.rs?ref=b428f287c3ddb951450bc5f94cf3a5e38a59e3d6", "patch": "@@ -3,7 +3,7 @@\n             we're apparently really bad at it\",\n             issue = \"none\")]\n \n-#![feature(const_fn, foo, foo2)]\n+#![feature(const_fn, const_fn_floating_point_arithmetic, foo, foo2)]\n #![feature(staged_api)]\n \n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n@@ -25,9 +25,9 @@ const fn bar2() -> u32 { foo2() } //~ ERROR not yet stable as a const fn\n \n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n #[rustc_const_stable(feature = \"rust1\", since = \"1.0.0\")]\n-// conformity is required, even with `const_fn` feature gate\n+// Const-stable functions cannot rely on unstable const-eval features.\n const fn bar3() -> u32 { (5f32 + 6f32) as u32 }\n-//~^ ERROR const-stable function cannot use `#[feature(const_fn)]`\n+//~^ ERROR const-stable function cannot use `#[feature(const_fn_floating_point_arithmetic)]`\n \n // check whether this function cannot be called even with the feature gate active\n #[unstable(feature = \"foo2\", issue = \"none\")]"}, {"sha": "fa2260b40d19fe03a9207ba1bc707b50c971e88c", "filename": "src/test/ui/consts/min_const_fn/min_const_fn_libstd_stability.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn_libstd_stability.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn_libstd_stability.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn_libstd_stability.stderr?ref=b428f287c3ddb951450bc5f94cf3a5e38a59e3d6", "patch": "@@ -14,7 +14,7 @@ LL | const fn bar2() -> u32 { foo2() }\n    |\n    = help: Const-stable functions can only call other const-stable functions\n \n-error: const-stable function cannot use `#[feature(const_fn)]`\n+error: const-stable function cannot use `#[feature(const_fn_floating_point_arithmetic)]`\n   --> $DIR/min_const_fn_libstd_stability.rs:29:26\n    |\n LL | const fn bar3() -> u32 { (5f32 + 6f32) as u32 }"}, {"sha": "0f48341ddf3eccd4dd2ac79e3cdabad3927c7b91", "filename": "src/test/ui/consts/min_const_fn/min_const_unsafe_fn_libstd_stability.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_unsafe_fn_libstd_stability.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_unsafe_fn_libstd_stability.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_unsafe_fn_libstd_stability.rs?ref=b428f287c3ddb951450bc5f94cf3a5e38a59e3d6", "patch": "@@ -3,7 +3,7 @@\n             we're apparently really bad at it\",\n             issue = \"none\")]\n \n-#![feature(const_fn, foo, foo2)]\n+#![feature(const_fn, const_fn_floating_point_arithmetic, foo, foo2)]\n #![feature(staged_api)]\n \n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n@@ -27,7 +27,7 @@ const unsafe fn bar2() -> u32 { unsafe { foo2() } } //~ ERROR not yet stable as\n #[rustc_const_stable(feature = \"rust1\", since = \"1.0.0\")]\n // conformity is required, even with `const_fn` feature gate\n const unsafe fn bar3() -> u32 { (5f32 + 6f32) as u32 }\n-//~^ ERROR const-stable function cannot use `#[feature(const_fn)]`\n+//~^ ERROR const-stable function cannot use `#[feature(const_fn_floating_point_arithmetic)]`\n \n // check whether this function cannot be called even with the feature gate active\n #[unstable(feature = \"foo2\", issue = \"none\")]"}, {"sha": "1ca5964ce0fc4355b90451693e077ece36d1e28a", "filename": "src/test/ui/consts/min_const_fn/min_const_unsafe_fn_libstd_stability.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_unsafe_fn_libstd_stability.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_unsafe_fn_libstd_stability.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_unsafe_fn_libstd_stability.stderr?ref=b428f287c3ddb951450bc5f94cf3a5e38a59e3d6", "patch": "@@ -14,7 +14,7 @@ LL | const unsafe fn bar2() -> u32 { unsafe { foo2() } }\n    |\n    = help: Const-stable functions can only call other const-stable functions\n \n-error: const-stable function cannot use `#[feature(const_fn)]`\n+error: const-stable function cannot use `#[feature(const_fn_floating_point_arithmetic)]`\n   --> $DIR/min_const_unsafe_fn_libstd_stability.rs:29:33\n    |\n LL | const unsafe fn bar3() -> u32 { (5f32 + 6f32) as u32 }"}]}