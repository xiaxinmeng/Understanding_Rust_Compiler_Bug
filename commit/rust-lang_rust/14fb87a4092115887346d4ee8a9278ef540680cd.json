{"sha": "14fb87a4092115887346d4ee8a9278ef540680cd", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE0ZmI4N2E0MDkyMTE1ODg3MzQ2ZDRlZThhOTI3OGVmNTQwNjgwY2Q=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2021-08-26T19:38:07Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-08-26T19:38:07Z"}, "message": "Rollup merge of #88215 - jyn514:lazy-loading, r=petrochenkov\n\nReland #83738: \"rustdoc: Don't load all extern crates unconditionally\"\n\nI hopefully found all the bugs :crossed_fingers: time for a take two. See the last commit for details on what went wrong before.\n\nr? `@petrochenkov` (but feel free to reassign to Guillaume if you don't have time.)\n\nCloses https://github.com/rust-lang/rust/issues/68427. Includes a fix for https://github.com/rust-lang/rust/issues/84738.", "tree": {"sha": "0923dfdd24a9f9ab1265418aa2db600619d20485", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0923dfdd24a9f9ab1265418aa2db600619d20485"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/14fb87a4092115887346d4ee8a9278ef540680cd", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhJ+2fCRBK7hj4Ov3rIwAAwSUIAKDMhHkF6Okl+Yu4Kk9sPCtO\n41yUOPCtLxcu6z7YI7quABtafRctJsazqs3sYuxgJkeE/Z0pxFq1Sm1iNLiCCaGa\nO5una8aYfppXyLwnT4F65DWiPCV1H6ez0HLtYefhOf06Pk9Vf01+IUxZATdM3yuE\nrLsKbXbFLVME2ZvITxPifmSbDrNYDf5NjJGTMswQfJ9l3QgNhTYenZ5yX5fkN9bY\nnuBCCL86sv9cyMexZtEhY5Gq2g14C9Qb/gZxUaUCqz68eMXD9FTxHcwHl7Cf+EfK\nl3BK1I7QNx3a36NWDEwifny3tZSone7LDY/VOCnqpo4KQAWPagObePwFsxpRwOM=\n=QCCz\n-----END PGP SIGNATURE-----\n", "payload": "tree 0923dfdd24a9f9ab1265418aa2db600619d20485\nparent 8aa46e51dfc20f6bc01207d67a5f666239ed8e07\nparent c60a370dac4821d0a1a4d55943e28c2da2220dc7\nauthor Manish Goregaokar <manishsmail@gmail.com> 1630006687 -0700\ncommitter GitHub <noreply@github.com> 1630006687 -0700\n\nRollup merge of #88215 - jyn514:lazy-loading, r=petrochenkov\n\nReland #83738: \"rustdoc: Don't load all extern crates unconditionally\"\n\nI hopefully found all the bugs :crossed_fingers: time for a take two. See the last commit for details on what went wrong before.\n\nr? `@petrochenkov` (but feel free to reassign to Guillaume if you don't have time.)\n\nCloses https://github.com/rust-lang/rust/issues/68427. Includes a fix for https://github.com/rust-lang/rust/issues/84738.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/14fb87a4092115887346d4ee8a9278ef540680cd", "html_url": "https://github.com/rust-lang/rust/commit/14fb87a4092115887346d4ee8a9278ef540680cd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/14fb87a4092115887346d4ee8a9278ef540680cd/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8aa46e51dfc20f6bc01207d67a5f666239ed8e07", "url": "https://api.github.com/repos/rust-lang/rust/commits/8aa46e51dfc20f6bc01207d67a5f666239ed8e07", "html_url": "https://github.com/rust-lang/rust/commit/8aa46e51dfc20f6bc01207d67a5f666239ed8e07"}, {"sha": "c60a370dac4821d0a1a4d55943e28c2da2220dc7", "url": "https://api.github.com/repos/rust-lang/rust/commits/c60a370dac4821d0a1a4d55943e28c2da2220dc7", "html_url": "https://github.com/rust-lang/rust/commit/c60a370dac4821d0a1a4d55943e28c2da2220dc7"}], "stats": {"total": 157, "additions": 116, "deletions": 41}, "files": [{"sha": "bd1d970fc199b6237515bb90518e28d643f2d748", "filename": "src/librustdoc/core.rs", "status": "modified", "additions": 5, "deletions": 34, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Flibrustdoc%2Fcore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Flibrustdoc%2Fcore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fcore.rs?ref=14fb87a4092115887346d4ee8a9278ef540680cd", "patch": "@@ -4,9 +4,8 @@ use rustc_driver::abort_on_err;\n use rustc_errors::emitter::{Emitter, EmitterWriter};\n use rustc_errors::json::JsonEmitter;\n use rustc_feature::UnstableFeatures;\n-use rustc_hir::def::Namespace::TypeNS;\n use rustc_hir::def::Res;\n-use rustc_hir::def_id::{DefId, LocalDefId, CRATE_DEF_INDEX};\n+use rustc_hir::def_id::{DefId, LocalDefId};\n use rustc_hir::HirId;\n use rustc_hir::{\n     intravisit::{self, NestedVisitorMap, Visitor},\n@@ -23,7 +22,7 @@ use rustc_session::DiagnosticOutput;\n use rustc_session::Session;\n use rustc_span::source_map;\n use rustc_span::symbol::sym;\n-use rustc_span::{Span, DUMMY_SP};\n+use rustc_span::Span;\n \n use std::cell::RefCell;\n use std::mem;\n@@ -301,41 +300,13 @@ crate fn create_config(\n }\n \n crate fn create_resolver<'a>(\n-    externs: config::Externs,\n     queries: &Queries<'a>,\n     sess: &Session,\n ) -> Rc<RefCell<interface::BoxedResolver>> {\n-    let extern_names: Vec<String> = externs\n-        .iter()\n-        .filter(|(_, entry)| entry.add_prelude)\n-        .map(|(name, _)| name)\n-        .cloned()\n-        .collect();\n-\n-    let (_, resolver, _) = &*abort_on_err(queries.expansion(), sess).peek();\n-\n-    // Before we actually clone it, let's force all the extern'd crates to\n-    // actually be loaded, just in case they're only referred to inside\n-    // intra-doc links\n-    resolver.borrow_mut().access(|resolver| {\n-        sess.time(\"load_extern_crates\", || {\n-            for extern_name in &extern_names {\n-                debug!(\"loading extern crate {}\", extern_name);\n-                if let Err(()) = resolver\n-                    .resolve_str_path_error(\n-                        DUMMY_SP,\n-                        extern_name,\n-                        TypeNS,\n-                        LocalDefId { local_def_index: CRATE_DEF_INDEX }.to_def_id(),\n-                  ) {\n-                    warn!(\"unable to resolve external crate {} (do you have an unused `--extern` crate?)\", extern_name)\n-                  }\n-            }\n-        });\n-    });\n+    let (krate, resolver, _) = &*abort_on_err(queries.expansion(), sess).peek();\n+    let resolver = resolver.clone();\n \n-    // Now we're good to clone the resolver because everything should be loaded\n-    resolver.clone()\n+    crate::passes::collect_intra_doc_links::load_intra_link_crates(resolver, krate)\n }\n \n crate fn run_global_ctxt("}, {"sha": "70f8b67363814b8ba4f82c26eb8199aa04a9b875", "filename": "src/librustdoc/lib.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Flibrustdoc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Flibrustdoc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Flib.rs?ref=14fb87a4092115887346d4ee8a9278ef540680cd", "patch": "@@ -30,6 +30,7 @@ extern crate tracing;\n // Dependencies listed in Cargo.toml do not need `extern crate`.\n \n extern crate rustc_ast;\n+extern crate rustc_ast_lowering;\n extern crate rustc_ast_pretty;\n extern crate rustc_attr;\n extern crate rustc_data_structures;\n@@ -724,7 +725,6 @@ fn main_options(options: config::Options) -> MainResult {\n     let default_passes = options.default_passes;\n     let output_format = options.output_format;\n     // FIXME: fix this clone (especially render_options)\n-    let externs = options.externs.clone();\n     let manual_passes = options.manual_passes.clone();\n     let render_options = options.render_options.clone();\n     let config = core::create_config(options);\n@@ -742,7 +742,7 @@ fn main_options(options: config::Options) -> MainResult {\n             // We need to hold on to the complete resolver, so we cause everything to be\n             // cloned for the analysis passes to use. Suboptimal, but necessary in the\n             // current architecture.\n-            let resolver = core::create_resolver(externs, queries, &sess);\n+            let resolver = core::create_resolver(queries, &sess);\n \n             if sess.has_errors() {\n                 sess.fatal(\"Compilation failed, aborting rustdoc\");"}, {"sha": "178c8c15a158861ca6483398e43650bf6c08f113", "filename": "src/librustdoc/passes/collect_intra_doc_links.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs?ref=14fb87a4092115887346d4ee8a9278ef540680cd", "patch": "@@ -37,6 +37,9 @@ use crate::html::markdown::{markdown_links, MarkdownLink};\n use crate::lint::{BROKEN_INTRA_DOC_LINKS, PRIVATE_INTRA_DOC_LINKS};\n use crate::passes::Pass;\n \n+mod early;\n+crate use early::load_intra_link_crates;\n+\n crate const COLLECT_INTRA_DOC_LINKS: Pass = Pass {\n     name: \"collect-intra-doc-links\",\n     run: collect_intra_doc_links,"}, {"sha": "cd90528ab9c8a9b6dd18040052680cb08ba4eef2", "filename": "src/librustdoc/passes/collect_intra_doc_links/early.rs", "status": "added", "additions": 75, "deletions": 0, "changes": 75, "blob_url": "https://github.com/rust-lang/rust/blob/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links%2Fearly.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links%2Fearly.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links%2Fearly.rs?ref=14fb87a4092115887346d4ee8a9278ef540680cd", "patch": "@@ -0,0 +1,75 @@\n+use rustc_ast as ast;\n+use rustc_hir::def::Namespace::TypeNS;\n+use rustc_hir::def_id::{LocalDefId, CRATE_DEF_ID};\n+use rustc_interface::interface;\n+use rustc_span::Span;\n+\n+use std::cell::RefCell;\n+use std::mem;\n+use std::rc::Rc;\n+\n+type Resolver = Rc<RefCell<interface::BoxedResolver>>;\n+// Letting the resolver escape at the end of the function leads to inconsistencies between the\n+// crates the TyCtxt sees and the resolver sees (because the resolver could load more crates\n+// after escaping). Hopefully `IntraLinkCrateLoader` gets all the crates we need ...\n+crate fn load_intra_link_crates(resolver: Resolver, krate: &ast::Crate) -> Resolver {\n+    let mut loader = IntraLinkCrateLoader { current_mod: CRATE_DEF_ID, resolver };\n+    // `walk_crate` doesn't visit the crate itself for some reason.\n+    loader.load_links_in_attrs(&krate.attrs, krate.span);\n+    ast::visit::walk_crate(&mut loader, krate);\n+    loader.resolver\n+}\n+\n+struct IntraLinkCrateLoader {\n+    current_mod: LocalDefId,\n+    resolver: Rc<RefCell<interface::BoxedResolver>>,\n+}\n+\n+impl IntraLinkCrateLoader {\n+    fn load_links_in_attrs(&mut self, attrs: &[ast::Attribute], span: Span) {\n+        use crate::html::markdown::markdown_links;\n+        use crate::passes::collect_intra_doc_links::preprocess_link;\n+\n+        // FIXME: this probably needs to consider inlining\n+        let attrs = crate::clean::Attributes::from_ast(attrs, None);\n+        for (parent_module, doc) in attrs.collapsed_doc_value_by_module_level() {\n+            debug!(?doc);\n+            for link in markdown_links(&doc.as_str()) {\n+                debug!(?link.link);\n+                let path_str = if let Some(Ok(x)) = preprocess_link(&link) {\n+                    x.path_str\n+                } else {\n+                    continue;\n+                };\n+                self.resolver.borrow_mut().access(|resolver| {\n+                    let _ = resolver.resolve_str_path_error(\n+                        span,\n+                        &path_str,\n+                        TypeNS,\n+                        parent_module.unwrap_or(self.current_mod.to_def_id()),\n+                    );\n+                });\n+            }\n+        }\n+    }\n+}\n+\n+impl ast::visit::Visitor<'_> for IntraLinkCrateLoader {\n+    fn visit_item(&mut self, item: &ast::Item) {\n+        use rustc_ast_lowering::ResolverAstLowering;\n+\n+        if let ast::ItemKind::Mod(..) = item.kind {\n+            let new_mod =\n+                self.resolver.borrow_mut().access(|resolver| resolver.local_def_id(item.id));\n+            let old_mod = mem::replace(&mut self.current_mod, new_mod);\n+\n+            self.load_links_in_attrs(&item.attrs, item.span);\n+            ast::visit::walk_item(self, item);\n+\n+            self.current_mod = old_mod;\n+        } else {\n+            self.load_links_in_attrs(&item.attrs, item.span);\n+            ast::visit::walk_item(self, item);\n+        }\n+    }\n+}"}, {"sha": "0e86fe45640f8ec80d728be3cd9aa536c7f02b06", "filename": "src/librustdoc/passes/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Flibrustdoc%2Fpasses%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Flibrustdoc%2Fpasses%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fmod.rs?ref=14fb87a4092115887346d4ee8a9278ef540680cd", "patch": "@@ -30,7 +30,7 @@ crate use self::unindent_comments::UNINDENT_COMMENTS;\n mod propagate_doc_cfg;\n crate use self::propagate_doc_cfg::PROPAGATE_DOC_CFG;\n \n-mod collect_intra_doc_links;\n+crate mod collect_intra_doc_links;\n crate use self::collect_intra_doc_links::COLLECT_INTRA_DOC_LINKS;\n \n mod doc_test_lints;"}, {"sha": "17b26850d4d2518d8b718f92354e570667e1dd9e", "filename": "src/test/rustdoc-ui/auxiliary/panic-item.rs", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Ftest%2Frustdoc-ui%2Fauxiliary%2Fpanic-item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Ftest%2Frustdoc-ui%2Fauxiliary%2Fpanic-item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fauxiliary%2Fpanic-item.rs?ref=14fb87a4092115887346d4ee8a9278ef540680cd", "patch": "@@ -0,0 +1,17 @@\n+// no-prefer-dynamic\n+#![crate_type = \"lib\"]\n+#![no_std]\n+#![feature(lang_items)]\n+\n+use core::panic::PanicInfo;\n+use core::sync::atomic::{self, Ordering};\n+\n+#[panic_handler]\n+fn panic(_info: &PanicInfo) -> ! {\n+    loop {\n+        atomic::compiler_fence(Ordering::SeqCst);\n+    }\n+}\n+\n+#[lang = \"eh_personality\"]\n+fn foo() {}"}, {"sha": "f703a183790745c007db89829e286e4430ac57c1", "filename": "src/test/rustdoc-ui/unused-extern-crate.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Ftest%2Frustdoc-ui%2Funused-extern-crate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Ftest%2Frustdoc-ui%2Funused-extern-crate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Funused-extern-crate.rs?ref=14fb87a4092115887346d4ee8a9278ef540680cd", "patch": "@@ -0,0 +1,3 @@\n+// check-pass\n+// aux-crate:panic_item=panic-item.rs\n+// @has unused_extern_crate/index.html"}, {"sha": "2f3d069bd51c36665d483943ee79d60dded77367", "filename": "src/test/rustdoc/auxiliary/issue-66159-1.rs", "status": "removed", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8aa46e51dfc20f6bc01207d67a5f666239ed8e07/src%2Ftest%2Frustdoc%2Fauxiliary%2Fissue-66159-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8aa46e51dfc20f6bc01207d67a5f666239ed8e07/src%2Ftest%2Frustdoc%2Fauxiliary%2Fissue-66159-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fauxiliary%2Fissue-66159-1.rs?ref=8aa46e51dfc20f6bc01207d67a5f666239ed8e07", "patch": "@@ -1,2 +0,0 @@\n-/// This will be referred to by the test docstring\n-pub struct Something;"}, {"sha": "75d4289321cae043a338e921b736a0e0f18c8e07", "filename": "src/test/rustdoc/intra-doc/auxiliary/pub-struct.rs", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Ftest%2Frustdoc%2Fintra-doc%2Fauxiliary%2Fpub-struct.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Ftest%2Frustdoc%2Fintra-doc%2Fauxiliary%2Fpub-struct.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fintra-doc%2Fauxiliary%2Fpub-struct.rs?ref=14fb87a4092115887346d4ee8a9278ef540680cd", "patch": "@@ -0,0 +1 @@\n+pub struct SomeStruct;"}, {"sha": "bad6ec7557989087c379f2d8719dc2bc20fc0d78", "filename": "src/test/rustdoc/intra-doc/extern-reference-link.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Ftest%2Frustdoc%2Fintra-doc%2Fextern-reference-link.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Ftest%2Frustdoc%2Fintra-doc%2Fextern-reference-link.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fintra-doc%2Fextern-reference-link.rs?ref=14fb87a4092115887346d4ee8a9278ef540680cd", "patch": "@@ -0,0 +1,7 @@\n+// compile-flags: --extern pub_struct\n+// aux-build:pub-struct.rs\n+\n+/// [SomeStruct]\n+///\n+/// [SomeStruct]: pub_struct::SomeStruct\n+pub fn foo() {}"}, {"sha": "56742b39790a88b6217728192b47ef2b40371bc8", "filename": "src/test/rustdoc/intra-doc/issue-66159.rs", "status": "renamed", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Ftest%2Frustdoc%2Fintra-doc%2Fissue-66159.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14fb87a4092115887346d4ee8a9278ef540680cd/src%2Ftest%2Frustdoc%2Fintra-doc%2Fissue-66159.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fintra-doc%2Fissue-66159.rs?ref=14fb87a4092115887346d4ee8a9278ef540680cd", "patch": "@@ -1,4 +1,4 @@\n-// aux-crate:priv:issue_66159_1=issue-66159-1.rs\n+// aux-crate:priv:pub_struct=pub-struct.rs\n // compile-flags:-Z unstable-options\n \n // The issue was an ICE which meant that we never actually generated the docs\n@@ -7,4 +7,4 @@\n // verify that the struct is linked correctly.\n \n // @has issue_66159/index.html\n-//! [issue_66159_1::Something]\n+//! [pub_struct::SomeStruct]", "previous_filename": "src/test/rustdoc/issue-66159.rs"}]}