{"sha": "053afe4907fa7ac7ff6d08d42583bde9a4d4414c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA1M2FmZTQ5MDdmYTdhYzdmZjZkMDhkNDI1ODNiZGU5YTRkNDQxNGM=", "commit": {"author": {"name": "flip1995", "email": "philipp.krones@embecosm.com", "date": "2021-01-02T17:01:42Z"}, "committer": {"name": "flip1995", "email": "philipp.krones@embecosm.com", "date": "2021-01-02T17:12:28Z"}, "message": "Use bootstrap rustc for versioncheck in Clippy", "tree": {"sha": "009c58e6a60d92439692e61b378c1ddeac1a99fb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/009c58e6a60d92439692e61b378c1ddeac1a99fb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/053afe4907fa7ac7ff6d08d42583bde9a4d4414c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/053afe4907fa7ac7ff6d08d42583bde9a4d4414c", "html_url": "https://github.com/rust-lang/rust/commit/053afe4907fa7ac7ff6d08d42583bde9a4d4414c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/053afe4907fa7ac7ff6d08d42583bde9a4d4414c/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ba4bf4f9c57b180410ed1d7eebbd2931846094c3", "url": "https://api.github.com/repos/rust-lang/rust/commits/ba4bf4f9c57b180410ed1d7eebbd2931846094c3", "html_url": "https://github.com/rust-lang/rust/commit/ba4bf4f9c57b180410ed1d7eebbd2931846094c3"}], "stats": {"total": 7, "additions": 4, "deletions": 3}, "files": [{"sha": "76b6126c76c6a640b98491587f721a592aece397", "filename": "tests/versioncheck.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/053afe4907fa7ac7ff6d08d42583bde9a4d4414c/tests%2Fversioncheck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/053afe4907fa7ac7ff6d08d42583bde9a4d4414c/tests%2Fversioncheck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fversioncheck.rs?ref=053afe4907fa7ac7ff6d08d42583bde9a4d4414c", "patch": "@@ -28,10 +28,11 @@ fn check_that_clippy_has_the_same_major_version_as_rustc() {\n     let clippy_minor = clippy_version.minor;\n     let clippy_patch = clippy_version.patch;\n \n-    // get the rustc version\n-    // this way the rust-toolchain file version is honored\n+    // get the rustc version either from the rustc installed with the toolchain file or from\n+    // `RUSTC_REAL` if Clippy is build in the Rust repo with `./x.py`.\n+    let rustc = std::env::var(\"RUSTC_REAL\").unwrap_or_else(|_| \"rustc\".to_string());\n     let rustc_version = String::from_utf8(\n-        std::process::Command::new(\"rustc\")\n+        std::process::Command::new(&rustc)\n             .arg(\"--version\")\n             .output()\n             .expect(\"failed to run `rustc --version`\")"}]}