{"sha": "b4815ad1baffb2603f7580cbdf1ac1b01879b767", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI0ODE1YWQxYmFmZmIyNjAzZjc1ODBjYmRmMWFjMWIwMTg3OWI3Njc=", "commit": {"author": {"name": "Huon Wilson", "email": "dbau.pp+github@gmail.com", "date": "2014-03-09T04:54:16Z"}, "committer": {"name": "Huon Wilson", "email": "dbau.pp+github@gmail.com", "date": "2014-03-09T09:59:43Z"}, "message": "mk: only build PDFs of the manual and tutorial.\n\nThis restores the old behaviour (as compared to building PDF versions of\nall standalone docs), because some of the guides use unicode characters,\nwhich seems to make pdftex unhappy.", "tree": {"sha": "a178bd283545d0876d001e5adc58e26b32868019", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a178bd283545d0876d001e5adc58e26b32868019"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b4815ad1baffb2603f7580cbdf1ac1b01879b767", "comment_count": 7, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b4815ad1baffb2603f7580cbdf1ac1b01879b767", "html_url": "https://github.com/rust-lang/rust/commit/b4815ad1baffb2603f7580cbdf1ac1b01879b767", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b4815ad1baffb2603f7580cbdf1ac1b01879b767/comments", "author": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bb8ac2159feb1739992b1b511a0a9afeaab10a8e", "url": "https://api.github.com/repos/rust-lang/rust/commits/bb8ac2159feb1739992b1b511a0a9afeaab10a8e", "html_url": "https://github.com/rust-lang/rust/commit/bb8ac2159feb1739992b1b511a0a9afeaab10a8e"}], "stats": {"total": 14, "additions": 12, "deletions": 2}, "files": [{"sha": "00832e0821690f1c0bd47a5e1249da123449de23", "filename": "mk/docs.mk", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/b4815ad1baffb2603f7580cbdf1ac1b01879b767/mk%2Fdocs.mk", "raw_url": "https://github.com/rust-lang/rust/raw/b4815ad1baffb2603f7580cbdf1ac1b01879b767/mk%2Fdocs.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fdocs.mk?ref=b4815ad1baffb2603f7580cbdf1ac1b01879b767", "patch": "@@ -14,6 +14,9 @@\n #\n # The DOCS variable is their names (with no file extension).\n #\n+# PDF_DOCS lists the targets for which PDF documentation should be\n+# build.\n+#\n # RUSTDOC_FLAGS_xyz variables are extra arguments to pass to the\n # rustdoc invocation for xyz.\n #\n@@ -28,6 +31,8 @@ DOCS := index tutorial guide-ffi guide-macros guide-lifetimes \\\n \tcomplement-cheatsheet guide-runtime \\\n \trust rustdoc\n \n+PDF_DOCS := tutorial rust\n+\n RUSTDOC_DEPS_rust := doc/full-toc.inc\n RUSTDOC_FLAGS_rust := --markdown-in-header=doc/full-toc.inc\n \n@@ -45,8 +50,6 @@ PANDOC_TEX_OPTS = $(PANDOC_BASE_OPTS) --include-before-body=doc/version.md \\\n \t--from=markdown --include-before-body=doc/footer.tex --to=latex\n PANDOC_EPUB_OPTS = $(PANDOC_BASE_OPTS) --to=epub\n \n-\n-\n # The rustdoc executable...\n RUSTDOC_EXE = $(HBIN2_H_$(CFG_BUILD))/rustdoc$(X_$(CFG_BUILD))\n # ...with rpath included in case --disable-rpath was provided to\n@@ -146,6 +149,11 @@ doc/footer.tex: $(D)/footer.tex | doc/\n \n # The (english) documentation for each doc item.\n \n+define DEF_SHOULD_BUILD_PDF_DOC\n+SHOULD_BUILD_PDF_DOC_$(1) = 1\n+endef\n+$(foreach docname,$(PDF_DOCS),$(eval $(call DEF_SHOULD_BUILD_PDF_DOC,$(docname))))\n+\n define DEF_DOC\n \n # HTML (rustdoc)\n@@ -171,13 +179,15 @@ doc/$(1).tex: $$(D)/$(1).md doc/footer.tex doc/version.md | doc/\n \t$$(CFG_PANDOC) $$(PANDOC_TEX_OPTS) --output=$$@\n \n ifneq ($(NO_PDF_DOCS),1)\n+ifeq ($$(SHOULD_BUILD_PDF_DOC_$(1)),1)\n DOC_TARGETS += doc/$(1).pdf\n doc/$(1).pdf: doc/$(1).tex\n \t@$$(call E, pdflatex: $$@)\n \t$$(Q)$$(CFG_PDFLATEX) \\\n \t-interaction=batchmode \\\n \t-output-directory=doc \\\n \t$$<\n+endif # SHOULD_BUILD_PDF_DOCS_$(1)\n endif # NO_PDF_DOCS\n \n endif # ONLY_HTML_DOCS"}]}