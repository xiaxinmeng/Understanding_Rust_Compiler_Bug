{"sha": "996511a45655e452ec3132094e08dcbebee36a67", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk5NjUxMWE0NTY1NWU0NTJlYzMxMzIwOTRlMDhkY2JlYmVlMzZhNjc=", "commit": {"author": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2019-12-13T13:46:10Z"}, "committer": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2020-01-10T09:18:21Z"}, "message": "Use 'relaxed' memory ordering for simple atomic counters in dep-graph.", "tree": {"sha": "1485220307b222fa7f10506d9699e54da11da495", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1485220307b222fa7f10506d9699e54da11da495"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/996511a45655e452ec3132094e08dcbebee36a67", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/996511a45655e452ec3132094e08dcbebee36a67", "html_url": "https://github.com/rust-lang/rust/commit/996511a45655e452ec3132094e08dcbebee36a67", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/996511a45655e452ec3132094e08dcbebee36a67/comments", "author": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "committer": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a62c040929a0620498c85f7a051e4005c28ff4d7", "url": "https://api.github.com/repos/rust-lang/rust/commits/a62c040929a0620498c85f7a051e4005c28ff4d7", "html_url": "https://github.com/rust-lang/rust/commit/a62c040929a0620498c85f7a051e4005c28ff4d7"}], "stats": {"total": 8, "additions": 4, "deletions": 4}, "files": [{"sha": "0148997ca9ee7aec57fe3e71b05bac5a5d234d99", "filename": "src/librustc/dep_graph/graph.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/996511a45655e452ec3132094e08dcbebee36a67/src%2Flibrustc%2Fdep_graph%2Fgraph.rs", "raw_url": "https://github.com/rust-lang/rust/raw/996511a45655e452ec3132094e08dcbebee36a67/src%2Flibrustc%2Fdep_graph%2Fgraph.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fdep_graph%2Fgraph.rs?ref=996511a45655e452ec3132094e08dcbebee36a67", "patch": "@@ -497,8 +497,8 @@ impl DepGraph {\n             let current_dep_graph = &self.data.as_ref().unwrap().current;\n \n             Some((\n-                current_dep_graph.total_read_count.load(SeqCst),\n-                current_dep_graph.total_duplicate_read_count.load(SeqCst),\n+                current_dep_graph.total_read_count.load(Relaxed),\n+                current_dep_graph.total_duplicate_read_count.load(Relaxed),\n             ))\n         } else {\n             None\n@@ -1111,7 +1111,7 @@ impl DepGraphData {\n             if let Some(task_deps) = icx.task_deps {\n                 let mut task_deps = task_deps.lock();\n                 if cfg!(debug_assertions) {\n-                    self.current.total_read_count.fetch_add(1, SeqCst);\n+                    self.current.total_read_count.fetch_add(1, Relaxed);\n                 }\n                 if task_deps.read_set.insert(source) {\n                     task_deps.reads.push(source);\n@@ -1129,7 +1129,7 @@ impl DepGraphData {\n                         }\n                     }\n                 } else if cfg!(debug_assertions) {\n-                    self.current.total_duplicate_read_count.fetch_add(1, SeqCst);\n+                    self.current.total_duplicate_read_count.fetch_add(1, Relaxed);\n                 }\n             }\n         })"}]}