{"sha": "5e28eb580ff48a84fe6f49bff31c4c022f243ac9", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVlMjhlYjU4MGZmNDhhODRmZTZmNDliZmYzMWM0YzAyMmYyNDNhYzk=", "commit": {"author": {"name": "Nell Shamrell", "email": "nellshamrell@gmail.com", "date": "2020-06-18T17:30:47Z"}, "committer": {"name": "Nell Shamrell", "email": "nellshamrell@gmail.com", "date": "2020-06-25T23:01:45Z"}, "message": "Adds a clearer message for when the async keyword is missing from a function\n\nSigned-off-by: Nell Shamrell <nellshamrell@gmail.com>", "tree": {"sha": "4f2722dbe8db97973ec8e71583c4918bddbc75c2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4f2722dbe8db97973ec8e71583c4918bddbc75c2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5e28eb580ff48a84fe6f49bff31c4c022f243ac9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5e28eb580ff48a84fe6f49bff31c4c022f243ac9", "html_url": "https://github.com/rust-lang/rust/commit/5e28eb580ff48a84fe6f49bff31c4c022f243ac9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/comments", "author": {"login": "nellshamrell", "id": 813007, "node_id": "MDQ6VXNlcjgxMzAwNw==", "avatar_url": "https://avatars.githubusercontent.com/u/813007?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nellshamrell", "html_url": "https://github.com/nellshamrell", "followers_url": "https://api.github.com/users/nellshamrell/followers", "following_url": "https://api.github.com/users/nellshamrell/following{/other_user}", "gists_url": "https://api.github.com/users/nellshamrell/gists{/gist_id}", "starred_url": "https://api.github.com/users/nellshamrell/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nellshamrell/subscriptions", "organizations_url": "https://api.github.com/users/nellshamrell/orgs", "repos_url": "https://api.github.com/users/nellshamrell/repos", "events_url": "https://api.github.com/users/nellshamrell/events{/privacy}", "received_events_url": "https://api.github.com/users/nellshamrell/received_events", "type": "User", "site_admin": true}, "committer": {"login": "nellshamrell", "id": 813007, "node_id": "MDQ6VXNlcjgxMzAwNw==", "avatar_url": "https://avatars.githubusercontent.com/u/813007?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nellshamrell", "html_url": "https://github.com/nellshamrell", "followers_url": "https://api.github.com/users/nellshamrell/followers", "following_url": "https://api.github.com/users/nellshamrell/following{/other_user}", "gists_url": "https://api.github.com/users/nellshamrell/gists{/gist_id}", "starred_url": "https://api.github.com/users/nellshamrell/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nellshamrell/subscriptions", "organizations_url": "https://api.github.com/users/nellshamrell/orgs", "repos_url": "https://api.github.com/users/nellshamrell/repos", "events_url": "https://api.github.com/users/nellshamrell/events{/privacy}", "received_events_url": "https://api.github.com/users/nellshamrell/received_events", "type": "User", "site_admin": true}, "parents": [{"sha": "50fc24d8a172a853b5dfe40702d6550e3b8562ba", "url": "https://api.github.com/repos/rust-lang/rust/commits/50fc24d8a172a853b5dfe40702d6550e3b8562ba", "html_url": "https://github.com/rust-lang/rust/commit/50fc24d8a172a853b5dfe40702d6550e3b8562ba"}], "stats": {"total": 37, "additions": 22, "deletions": 15}, "files": [{"sha": "abf461338d80a95137e6c1e8f2715ccfdd8e27a4", "filename": "src/libcore/future/future.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Flibcore%2Ffuture%2Ffuture.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Flibcore%2Ffuture%2Ffuture.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Ffuture%2Ffuture.rs?ref=5e28eb580ff48a84fe6f49bff31c4c022f243ac9", "patch": "@@ -27,6 +27,7 @@ use crate::task::{Context, Poll};\n #[must_use = \"futures do nothing unless you `.await` or poll them\"]\n #[stable(feature = \"futures_api\", since = \"1.36.0\")]\n #[lang = \"future_trait\"]\n+#[rustc_on_unimplemented(label = \"`{Self}` is not a future\", message = \"`{Self}` is not a future\")]\n pub trait Future {\n     /// The type of value produced on completion.\n     #[stable(feature = \"futures_api\", since = \"1.36.0\")]"}, {"sha": "86d459bf084b1f6827c92525f8dc317f518ac7b9", "filename": "src/test/ui/async-await/async-error-span.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Ftest%2Fui%2Fasync-await%2Fasync-error-span.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Ftest%2Fui%2Fasync-await%2Fasync-error-span.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fasync-await%2Fasync-error-span.rs?ref=5e28eb580ff48a84fe6f49bff31c4c022f243ac9", "patch": "@@ -5,7 +5,7 @@\n use std::future::Future;\n \n fn get_future() -> impl Future<Output = ()> {\n-//~^ ERROR the trait bound `(): std::future::Future` is not satisfied\n+//~^ ERROR `()` is not a future\n     panic!()\n }\n "}, {"sha": "9523f040aa8cd91c3526600b6d207913be08228a", "filename": "src/test/ui/async-await/async-error-span.stderr", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Ftest%2Fui%2Fasync-await%2Fasync-error-span.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Ftest%2Fui%2Fasync-await%2Fasync-error-span.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fasync-await%2Fasync-error-span.stderr?ref=5e28eb580ff48a84fe6f49bff31c4c022f243ac9", "patch": "@@ -1,12 +1,13 @@\n-error[E0277]: the trait bound `(): std::future::Future` is not satisfied\n+error[E0277]: `()` is not a future\n   --> $DIR/async-error-span.rs:7:20\n    |\n LL | fn get_future() -> impl Future<Output = ()> {\n-   |                    ^^^^^^^^^^^^^^^^^^^^^^^^ the trait `std::future::Future` is not implemented for `()`\n+   |                    ^^^^^^^^^^^^^^^^^^^^^^^^ `()` is not a future\n LL |\n LL |     panic!()\n    |     -------- this returned value is of type `!`\n    |\n+   = help: the trait `std::future::Future` is not implemented for `()`\n    = note: the return type of a function must have a statically known size\n \n error[E0698]: type inside `async fn` body must be known in this context"}, {"sha": "34d12db8806dc0845e77096f283c0804e73d9579", "filename": "src/test/ui/async-await/issue-70594.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Ftest%2Fui%2Fasync-await%2Fissue-70594.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Ftest%2Fui%2Fasync-await%2Fissue-70594.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fasync-await%2Fissue-70594.rs?ref=5e28eb580ff48a84fe6f49bff31c4c022f243ac9", "patch": "@@ -6,7 +6,7 @@ async fn fun() {\n     //~| error: `.await` is not allowed in a `const`\n     //~| error: `loop` is not allowed in a `const`\n     //~| error: `.await` is not allowed in a `const`\n-    //~| error: the trait bound `(): std::future::Future` is not satisfied\n+    //~| error: `()` is not a future\n }\n \n fn main() {}"}, {"sha": "1b7abe317222d982c6eb8d276d03769af2394746", "filename": "src/test/ui/async-await/issue-70594.stderr", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Ftest%2Fui%2Fasync-await%2Fissue-70594.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Ftest%2Fui%2Fasync-await%2Fissue-70594.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fasync-await%2Fissue-70594.stderr?ref=5e28eb580ff48a84fe6f49bff31c4c022f243ac9", "patch": "@@ -27,12 +27,13 @@ error[E0744]: `.await` is not allowed in a `const`\n LL |     [1; ().await];\n    |         ^^^^^^^^\n \n-error[E0277]: the trait bound `(): std::future::Future` is not satisfied\n+error[E0277]: `()` is not a future\n   --> $DIR/issue-70594.rs:4:9\n    |\n LL |     [1; ().await];\n-   |         ^^^^^^^^ the trait `std::future::Future` is not implemented for `()`\n+   |         ^^^^^^^^ `()` is not a future\n    |\n+   = help: the trait `std::future::Future` is not implemented for `()`\n    = note: required by `std::future::Future::poll`\n \n error: aborting due to 5 previous errors"}, {"sha": "e3ba74a03c898c933470709ef1097adb569faad0", "filename": "src/test/ui/async-await/issues/issue-62009-1.stderr", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Ftest%2Fui%2Fasync-await%2Fissues%2Fissue-62009-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Ftest%2Fui%2Fasync-await%2Fissues%2Fissue-62009-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fasync-await%2Fissues%2Fissue-62009-1.stderr?ref=5e28eb580ff48a84fe6f49bff31c4c022f243ac9", "patch": "@@ -27,12 +27,13 @@ LL | fn main() {\n LL |     (|_| 2333).await;\n    |     ^^^^^^^^^^^^^^^^ only allowed inside `async` functions and blocks\n \n-error[E0277]: the trait bound `[closure@$DIR/issue-62009-1.rs:12:5: 12:15]: std::future::Future` is not satisfied\n+error[E0277]: `[closure@$DIR/issue-62009-1.rs:12:5: 12:15]` is not a future\n   --> $DIR/issue-62009-1.rs:12:5\n    |\n LL |     (|_| 2333).await;\n-   |     ^^^^^^^^^^^^^^^^ the trait `std::future::Future` is not implemented for `[closure@$DIR/issue-62009-1.rs:12:5: 12:15]`\n+   |     ^^^^^^^^^^^^^^^^ `[closure@$DIR/issue-62009-1.rs:12:5: 12:15]` is not a future\n    |\n+   = help: the trait `std::future::Future` is not implemented for `[closure@$DIR/issue-62009-1.rs:12:5: 12:15]`\n    = note: required by `std::future::Future::poll`\n \n error: aborting due to 4 previous errors"}, {"sha": "fecba721ac9fdeb101053fd43ce0b7e2789ee00e", "filename": "src/test/ui/issues-71798.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Ftest%2Fui%2Fissues-71798.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Ftest%2Fui%2Fissues-71798.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues-71798.rs?ref=5e28eb580ff48a84fe6f49bff31c4c022f243ac9", "patch": "@@ -1,5 +1,5 @@\n fn test_ref(x: &u32) -> impl std::future::Future<Output = u32> + '_ {\n-    *x //~^ ERROR the trait bound `u32: std::future::Future` is not satisfied\n+    *x //~^ ERROR `u32` is not a future\n }\n \n fn main() {"}, {"sha": "b3b29a726413156e284f85931100cdb5e688fba3", "filename": "src/test/ui/issues-71798.stderr", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Ftest%2Fui%2Fissues-71798.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Ftest%2Fui%2Fissues-71798.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues-71798.stderr?ref=5e28eb580ff48a84fe6f49bff31c4c022f243ac9", "patch": "@@ -4,14 +4,15 @@ error[E0425]: cannot find value `u` in this scope\n LL |     let _ = test_ref & u;\n    |                        ^ not found in this scope\n \n-error[E0277]: the trait bound `u32: std::future::Future` is not satisfied\n+error[E0277]: `u32` is not a future\n   --> $DIR/issues-71798.rs:1:25\n    |\n LL | fn test_ref(x: &u32) -> impl std::future::Future<Output = u32> + '_ {\n-   |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ the trait `std::future::Future` is not implemented for `u32`\n+   |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ `u32` is not a future\n LL |     *x\n    |     -- this returned value is of type `u32`\n    |\n+   = help: the trait `std::future::Future` is not implemented for `u32`\n    = note: the return type of a function must have a statically known size\n \n error: aborting due to 2 previous errors"}, {"sha": "11372494772d0962c55e4d66faf252c6330ec8f5", "filename": "src/test/ui/suggestions/async-fn-ctor-passed-as-arg-where-it-should-have-been-called.stderr", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Ftest%2Fui%2Fsuggestions%2Fasync-fn-ctor-passed-as-arg-where-it-should-have-been-called.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5e28eb580ff48a84fe6f49bff31c4c022f243ac9/src%2Ftest%2Fui%2Fsuggestions%2Fasync-fn-ctor-passed-as-arg-where-it-should-have-been-called.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsuggestions%2Fasync-fn-ctor-passed-as-arg-where-it-should-have-been-called.stderr?ref=5e28eb580ff48a84fe6f49bff31c4c022f243ac9", "patch": "@@ -1,4 +1,4 @@\n-error[E0277]: the trait bound `fn() -> impl std::future::Future {foo}: std::future::Future` is not satisfied\n+error[E0277]: `fn() -> impl std::future::Future {foo}` is not a future\n   --> $DIR/async-fn-ctor-passed-as-arg-where-it-should-have-been-called.rs:10:9\n    |\n LL | async fn foo() {}\n@@ -8,14 +8,15 @@ LL | fn bar(f: impl Future<Output=()>) {}\n    |                ----------------- required by this bound in `bar`\n ...\n LL |     bar(foo);\n-   |         ^^^ the trait `std::future::Future` is not implemented for `fn() -> impl std::future::Future {foo}`\n+   |         ^^^ `fn() -> impl std::future::Future {foo}` is not a future\n    |\n+   = help: the trait `std::future::Future` is not implemented for `fn() -> impl std::future::Future {foo}`\n help: use parentheses to call the function\n    |\n LL |     bar(foo());\n    |            ^^\n \n-error[E0277]: the trait bound `[closure@$DIR/async-fn-ctor-passed-as-arg-where-it-should-have-been-called.rs:11:25: 11:36]: std::future::Future` is not satisfied\n+error[E0277]: `[closure@$DIR/async-fn-ctor-passed-as-arg-where-it-should-have-been-called.rs:11:25: 11:36]` is not a future\n   --> $DIR/async-fn-ctor-passed-as-arg-where-it-should-have-been-called.rs:12:9\n    |\n LL | fn bar(f: impl Future<Output=()>) {}\n@@ -24,8 +25,9 @@ LL | fn bar(f: impl Future<Output=()>) {}\n LL |     let async_closure = async || ();\n    |                         -------- consider calling this closure\n LL |     bar(async_closure);\n-   |         ^^^^^^^^^^^^^ the trait `std::future::Future` is not implemented for `[closure@$DIR/async-fn-ctor-passed-as-arg-where-it-should-have-been-called.rs:11:25: 11:36]`\n+   |         ^^^^^^^^^^^^^ `[closure@$DIR/async-fn-ctor-passed-as-arg-where-it-should-have-been-called.rs:11:25: 11:36]` is not a future\n    |\n+   = help: the trait `std::future::Future` is not implemented for `[closure@$DIR/async-fn-ctor-passed-as-arg-where-it-should-have-been-called.rs:11:25: 11:36]`\n help: use parentheses to call the closure\n    |\n LL |     bar(async_closure());"}]}