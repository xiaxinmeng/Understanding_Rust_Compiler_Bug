{"sha": "515d14f0944a5e5e6b2df206549e08ebe39e18f1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUxNWQxNGYwOTQ0YTVlNWU2YjJkZjIwNjU0OWUwOGViZTM5ZTE4ZjE=", "commit": {"author": {"name": "Mark Simulacrum", "email": "mark.simulacrum@gmail.com", "date": "2016-12-18T03:19:34Z"}, "committer": {"name": "Mark Simulacrum", "email": "mark.simulacrum@gmail.com", "date": "2016-12-21T03:03:31Z"}, "message": "Inline/Replace finish with build_return_block", "tree": {"sha": "510a5adf143cd7684fca5742ba2969a5b9a6b881", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/510a5adf143cd7684fca5742ba2969a5b9a6b881"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/515d14f0944a5e5e6b2df206549e08ebe39e18f1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/515d14f0944a5e5e6b2df206549e08ebe39e18f1", "html_url": "https://github.com/rust-lang/rust/commit/515d14f0944a5e5e6b2df206549e08ebe39e18f1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/515d14f0944a5e5e6b2df206549e08ebe39e18f1/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b48e74b5b015cfc3a71e0b7e0f3d12972aab20f6", "url": "https://api.github.com/repos/rust-lang/rust/commits/b48e74b5b015cfc3a71e0b7e0f3d12972aab20f6", "html_url": "https://github.com/rust-lang/rust/commit/b48e74b5b015cfc3a71e0b7e0f3d12972aab20f6"}], "stats": {"total": 16, "additions": 5, "deletions": 11}, "files": [{"sha": "1e37f743b6fbe406a1bfa4e3ecc95f778951159d", "filename": "src/librustc_trans/base.rs", "status": "modified", "additions": 1, "deletions": 7, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/515d14f0944a5e5e6b2df206549e08ebe39e18f1/src%2Flibrustc_trans%2Fbase.rs", "raw_url": "https://github.com/rust-lang/rust/raw/515d14f0944a5e5e6b2df206549e08ebe39e18f1/src%2Flibrustc_trans%2Fbase.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fbase.rs?ref=515d14f0944a5e5e6b2df206549e08ebe39e18f1", "patch": "@@ -565,12 +565,6 @@ pub fn alloc_ty<'a, 'tcx>(bcx: &BlockAndBuilder<'a, 'tcx>, ty: Ty<'tcx>, name: &\n }\n \n impl<'a, 'tcx> FunctionContext<'a, 'tcx> {\n-    /// Ties up the llstaticallocas -> llloadenv -> lltop edges,\n-    /// and builds the return block.\n-    pub fn finish(&'a self, ret_cx: &BlockAndBuilder<'a, 'tcx>) {\n-        self.build_return_block(ret_cx);\n-    }\n-\n     // Builds the return block for a function.\n     pub fn build_return_block(&self, ret_cx: &BlockAndBuilder<'a, 'tcx>) {\n         if self.llretslotptr.is_none() || self.fn_ty.ret.is_indirect() {\n@@ -711,7 +705,7 @@ pub fn trans_ctor_shim<'a, 'tcx>(ccx: &CrateContext<'a, 'tcx>,\n         adt::trans_set_discr(&bcx, sig.output(), dest, disr);\n     }\n \n-    fcx.finish(&bcx);\n+    fcx.build_return_block(&bcx);\n }\n \n pub fn llvm_linkage_by_name(name: &str) -> Option<Linkage> {"}, {"sha": "fa24c5ecf2e41d20b6260271ae1a9eadf1c6cade", "filename": "src/librustc_trans/callee.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/515d14f0944a5e5e6b2df206549e08ebe39e18f1/src%2Flibrustc_trans%2Fcallee.rs", "raw_url": "https://github.com/rust-lang/rust/raw/515d14f0944a5e5e6b2df206549e08ebe39e18f1/src%2Flibrustc_trans%2Fcallee.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fcallee.rs?ref=515d14f0944a5e5e6b2df206549e08ebe39e18f1", "patch": "@@ -419,7 +419,7 @@ fn trans_fn_once_adapter_shim<'a, 'tcx>(\n         bcx.unreachable();\n     }\n     self_scope.trans(&bcx);\n-    fcx.finish(&bcx);\n+    fcx.build_return_block(&bcx);\n \n     ccx.instances().borrow_mut().insert(method_instance, lloncefn);\n \n@@ -540,7 +540,7 @@ fn trans_fn_pointer_shim<'a, 'tcx>(\n         ty: bare_fn_ty\n     };\n     callee.call(&bcx, &llargs[(self_idx + 1)..], fcx.llretslotptr, None);\n-    fcx.finish(&bcx);\n+    fcx.build_return_block(&bcx);\n \n     ccx.fn_pointer_shims().borrow_mut().insert(bare_fn_ty_maybe_ref, llfn);\n "}, {"sha": "936ab0901123dcecfb7b7f7e86ed348621e6a97c", "filename": "src/librustc_trans/glue.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/515d14f0944a5e5e6b2df206549e08ebe39e18f1/src%2Flibrustc_trans%2Fglue.rs", "raw_url": "https://github.com/rust-lang/rust/raw/515d14f0944a5e5e6b2df206549e08ebe39e18f1/src%2Flibrustc_trans%2Fglue.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fglue.rs?ref=515d14f0944a5e5e6b2df206549e08ebe39e18f1", "patch": "@@ -201,7 +201,7 @@ pub fn implement_drop_glue<'a, 'tcx>(ccx: &CrateContext<'a, 'tcx>, g: DropGlueKi\n     // type, so we don't need to explicitly cast the function parameter.\n \n     let bcx = make_drop_glue(bcx, get_param(llfn, 0), g);\n-    fcx.finish(&bcx);\n+    fcx.build_return_block(&bcx);\n }\n \n fn trans_custom_dtor<'a, 'tcx>(mut bcx: BlockAndBuilder<'a, 'tcx>,"}, {"sha": "a09838f282b377e9baa03a8a7eac19689f3771db", "filename": "src/librustc_trans/meth.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/515d14f0944a5e5e6b2df206549e08ebe39e18f1/src%2Flibrustc_trans%2Fmeth.rs", "raw_url": "https://github.com/rust-lang/rust/raw/515d14f0944a5e5e6b2df206549e08ebe39e18f1/src%2Flibrustc_trans%2Fmeth.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fmeth.rs?ref=515d14f0944a5e5e6b2df206549e08ebe39e18f1", "patch": "@@ -86,7 +86,7 @@ pub fn trans_object_shim<'a, 'tcx>(ccx: &'a CrateContext<'a, 'tcx>,\n \n     let llargs = get_params(fcx.llfn);\n     callee.call(&bcx, &llargs[fcx.fn_ty.ret.is_indirect() as usize..], fcx.llretslotptr, None);\n-    fcx.finish(&bcx);\n+    fcx.build_return_block(&bcx);\n \n     llfn\n }"}]}