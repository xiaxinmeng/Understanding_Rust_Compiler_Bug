{"sha": "db9d01842450fe07f77ca97d9a68d105366f407e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRiOWQwMTg0MjQ1MGZlMDdmNzdjYTk3ZDlhNjhkMTA1MzY2ZjQwN2U=", "commit": {"author": {"name": "Theo Belaire", "email": "theo.belaire@gmail.com", "date": "2015-05-01T02:46:15Z"}, "committer": {"name": "Theo Belaire", "email": "theo.belaire@gmail.com", "date": "2015-05-01T15:37:38Z"}, "message": "Fixed some nits", "tree": {"sha": "cac6b9c221c167f278a1e027adb765b7afebcbf8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cac6b9c221c167f278a1e027adb765b7afebcbf8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/db9d01842450fe07f77ca97d9a68d105366f407e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/db9d01842450fe07f77ca97d9a68d105366f407e", "html_url": "https://github.com/rust-lang/rust/commit/db9d01842450fe07f77ca97d9a68d105366f407e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/db9d01842450fe07f77ca97d9a68d105366f407e/comments", "author": {"login": "tbelaire", "id": 427239, "node_id": "MDQ6VXNlcjQyNzIzOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/427239?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tbelaire", "html_url": "https://github.com/tbelaire", "followers_url": "https://api.github.com/users/tbelaire/followers", "following_url": "https://api.github.com/users/tbelaire/following{/other_user}", "gists_url": "https://api.github.com/users/tbelaire/gists{/gist_id}", "starred_url": "https://api.github.com/users/tbelaire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tbelaire/subscriptions", "organizations_url": "https://api.github.com/users/tbelaire/orgs", "repos_url": "https://api.github.com/users/tbelaire/repos", "events_url": "https://api.github.com/users/tbelaire/events{/privacy}", "received_events_url": "https://api.github.com/users/tbelaire/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tbelaire", "id": 427239, "node_id": "MDQ6VXNlcjQyNzIzOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/427239?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tbelaire", "html_url": "https://github.com/tbelaire", "followers_url": "https://api.github.com/users/tbelaire/followers", "following_url": "https://api.github.com/users/tbelaire/following{/other_user}", "gists_url": "https://api.github.com/users/tbelaire/gists{/gist_id}", "starred_url": "https://api.github.com/users/tbelaire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tbelaire/subscriptions", "organizations_url": "https://api.github.com/users/tbelaire/orgs", "repos_url": "https://api.github.com/users/tbelaire/repos", "events_url": "https://api.github.com/users/tbelaire/events{/privacy}", "received_events_url": "https://api.github.com/users/tbelaire/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "372c69d8d293985ad3bffbe5c5e527dc37e90169", "url": "https://api.github.com/repos/rust-lang/rust/commits/372c69d8d293985ad3bffbe5c5e527dc37e90169", "html_url": "https://github.com/rust-lang/rust/commit/372c69d8d293985ad3bffbe5c5e527dc37e90169"}], "stats": {"total": 17, "additions": 8, "deletions": 9}, "files": [{"sha": "91eb068e845a12af4bc8ad0e08694e8f992d52fe", "filename": "src/librustc_resolve/resolve_imports.rs", "status": "modified", "additions": 5, "deletions": 8, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/db9d01842450fe07f77ca97d9a68d105366f407e/src%2Flibrustc_resolve%2Fresolve_imports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/db9d01842450fe07f77ca97d9a68d105366f407e/src%2Flibrustc_resolve%2Fresolve_imports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Fresolve_imports.rs?ref=db9d01842450fe07f77ca97d9a68d105366f407e", "patch": "@@ -896,8 +896,6 @@ impl<'a, 'b:'a, 'tcx:'b> ImportResolver<'a, 'b, 'tcx> {\n \n         match target {\n             Some(ref target) if target.shadowable != Shadowable::Always => {\n-                use syntax::ast_map::NodeItem;\n-\n                 let ns_word = match namespace {\n                     TypeNS => \"type\",\n                     ValueNS => \"value\",\n@@ -907,12 +905,11 @@ impl<'a, 'b:'a, 'tcx:'b> ImportResolver<'a, 'b, 'tcx> {\n                            in this module\", ns_word,\n                                   &token::get_name(name));\n                 let use_id = import_resolution.id(namespace);\n-                if let NodeItem(item) = self.resolver.ast_map.get(use_id) {\n-                    // item is syntax::ast::Item;\n-                    span_note!(self.resolver.session, item.span,\n-                               \"previous import of `{}` here\",\n-                               token::get_name(name));\n-                }\n+                let item = self.resolver.ast_map.expect_item(use_id);\n+                // item is syntax::ast::Item;\n+                span_note!(self.resolver.session, item.span,\n+                            \"previous import of `{}` here\",\n+                            token::get_name(name));\n             }\n             Some(_) | None => {}\n         }"}, {"sha": "cbf13c0a559092fee8af5cbff0ec903c71f65173", "filename": "src/test/compile-fail/double-import.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/db9d01842450fe07f77ca97d9a68d105366f407e/src%2Ftest%2Fcompile-fail%2Fdouble-import.rs", "raw_url": "https://github.com/rust-lang/rust/raw/db9d01842450fe07f77ca97d9a68d105366f407e/src%2Ftest%2Fcompile-fail%2Fdouble-import.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fdouble-import.rs?ref=db9d01842450fe07f77ca97d9a68d105366f407e", "patch": "@@ -1,4 +1,4 @@\n-// Copyright 2013 The Rust Project Developers. See the COPYRIGHT\n+// Copyright 2015 The Rust Project Developers. See the COPYRIGHT\n // file at the top-level directory of this distribution and at\n // http://rust-lang.org/COPYRIGHT.\n //\n@@ -10,6 +10,8 @@\n #![feature(no_std)]\n #![no_std]\n \n+// This tests that conflicting imports shows both `use` lines\n+// when reporting the error.\n \n mod sub1 {\n     fn foo() {} // implementation 1"}]}