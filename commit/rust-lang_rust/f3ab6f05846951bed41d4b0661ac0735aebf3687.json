{"sha": "f3ab6f05846951bed41d4b0661ac0735aebf3687", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYzYWI2ZjA1ODQ2OTUxYmVkNDFkNGIwNjYxYWMwNzM1YWViZjM2ODc=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-10-12T15:50:36Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-10-12T15:50:36Z"}, "message": "Auto merge of #77854 - pietroalbini:ETOOMANYCHANNELS, r=Mark-Simulacrum\n\nbuild-manifest: stop generating numbered channel names except for stable\n\nThis fixes numbered channel names being created for the nightly channel, and once the root cause of this rides the trains, for beta.\n\nr? `@Mark-Simulacrum`", "tree": {"sha": "809b0533b3a0751caac64f7df7adfee9428325d4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/809b0533b3a0751caac64f7df7adfee9428325d4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f3ab6f05846951bed41d4b0661ac0735aebf3687", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f3ab6f05846951bed41d4b0661ac0735aebf3687", "html_url": "https://github.com/rust-lang/rust/commit/f3ab6f05846951bed41d4b0661ac0735aebf3687", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f3ab6f05846951bed41d4b0661ac0735aebf3687/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d6b5ffb5b41579dbc49e651691fa9bb670a39a07", "url": "https://api.github.com/repos/rust-lang/rust/commits/d6b5ffb5b41579dbc49e651691fa9bb670a39a07", "html_url": "https://github.com/rust-lang/rust/commit/d6b5ffb5b41579dbc49e651691fa9bb670a39a07"}, {"sha": "5973fd42a2e9475bb36c07cbd9985870ad5ff9a1", "url": "https://api.github.com/repos/rust-lang/rust/commits/5973fd42a2e9475bb36c07cbd9985870ad5ff9a1", "html_url": "https://github.com/rust-lang/rust/commit/5973fd42a2e9475bb36c07cbd9985870ad5ff9a1"}], "stats": {"total": 9, "additions": 5, "deletions": 4}, "files": [{"sha": "7ee28cd6e5d95caf8985a6bdbc610c9699988fe7", "filename": "src/tools/build-manifest/src/main.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/f3ab6f05846951bed41d4b0661ac0735aebf3687/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f3ab6f05846951bed41d4b0661ac0735aebf3687/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fmain.rs?ref=f3ab6f05846951bed41d4b0661ac0735aebf3687", "patch": "@@ -252,12 +252,13 @@ impl Builder {\n         }\n         let manifest = self.build_manifest();\n \n-        let rust_version = self.versions.rustc_version();\n         self.write_channel_files(self.versions.channel(), &manifest);\n-        if self.versions.channel() != rust_version {\n-            self.write_channel_files(&rust_version, &manifest);\n-        }\n         if self.versions.channel() == \"stable\" {\n+            // channel-rust-1.XX.YY.toml\n+            let rust_version = self.versions.rustc_version();\n+            self.write_channel_files(rust_version, &manifest);\n+\n+            // channel-rust-1.XX.toml\n             let major_minor = rust_version.split('.').take(2).collect::<Vec<_>>().join(\".\");\n             self.write_channel_files(&major_minor, &manifest);\n         }"}]}