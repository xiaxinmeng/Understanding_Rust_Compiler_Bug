{"sha": "52f76400b5b8fc9ac14c2caa5eb6736bcbd38223", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUyZjc2NDAwYjViOGZjOWFjMTRjMmNhYTVlYjY3MzZiY2JkMzgyMjM=", "commit": {"author": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2011-12-15T22:30:19Z"}, "committer": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2011-12-16T16:06:44Z"}, "message": "extend with ty_send_type and ty_opaque_closure", "tree": {"sha": "43b3178e65600b96c3a7e8e3a0e1d54d8c3b290b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/43b3178e65600b96c3a7e8e3a0e1d54d8c3b290b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/52f76400b5b8fc9ac14c2caa5eb6736bcbd38223", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/52f76400b5b8fc9ac14c2caa5eb6736bcbd38223", "html_url": "https://github.com/rust-lang/rust/commit/52f76400b5b8fc9ac14c2caa5eb6736bcbd38223", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/52f76400b5b8fc9ac14c2caa5eb6736bcbd38223/comments", "author": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b5e5043d5d8adecb04cf25a1be0e186d96d2f82a", "url": "https://api.github.com/repos/rust-lang/rust/commits/b5e5043d5d8adecb04cf25a1be0e186d96d2f82a", "html_url": "https://github.com/rust-lang/rust/commit/b5e5043d5d8adecb04cf25a1be0e186d96d2f82a"}], "stats": {"total": 13, "additions": 11, "deletions": 2}, "files": [{"sha": "5f87016866a87b277e384be4f46bdc4a56aaa044", "filename": "src/comp/metadata/tydecode.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/52f76400b5b8fc9ac14c2caa5eb6736bcbd38223/src%2Fcomp%2Fmetadata%2Ftydecode.rs", "raw_url": "https://github.com/rust-lang/rust/raw/52f76400b5b8fc9ac14c2caa5eb6736bcbd38223/src%2Fcomp%2Fmetadata%2Ftydecode.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmetadata%2Ftydecode.rs?ref=52f76400b5b8fc9ac14c2caa5eb6736bcbd38223", "patch": "@@ -294,6 +294,8 @@ fn parse_ty(st: @pstate, sd: str_def) -> ty::t {\n       'X' { ret ty::mk_var(st.tcx, parse_int(st)); }\n       'E' { let def = parse_def(st, sd); ret ty::mk_native(st.tcx, def); }\n       'Y' { ret ty::mk_type(st.tcx); }\n+      'y' { ret ty::mk_send_type(st.tcx); }\n+      'C' { ret ty::mk_opaque_closure(st.tcx); }\n       '#' {\n         let pos = parse_hex(st);\n         assert (next(st) as char == ':');"}, {"sha": "f779b64929fde47294c15523b9ebd039bfe68b46", "filename": "src/comp/metadata/tyencode.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/52f76400b5b8fc9ac14c2caa5eb6736bcbd38223/src%2Fcomp%2Fmetadata%2Ftyencode.rs", "raw_url": "https://github.com/rust-lang/rust/raw/52f76400b5b8fc9ac14c2caa5eb6736bcbd38223/src%2Fcomp%2Fmetadata%2Ftyencode.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmetadata%2Ftyencode.rs?ref=52f76400b5b8fc9ac14c2caa5eb6736bcbd38223", "patch": "@@ -183,6 +183,8 @@ fn enc_sty(w: io::writer, cx: @ctxt, st: ty::sty) {\n         w.write_str(uint::str(id));\n       }\n       ty::ty_type. { w.write_char('Y'); }\n+      ty::ty_send_type. { w.write_char('y'); }\n+      ty::ty_opaque_closure. { w.write_char('C'); }\n       ty::ty_constr(ty, cs) {\n         w.write_str(\"A[\");\n         enc_ty(w, cx, ty);"}, {"sha": "8ac5f471ded995443f2110a34f29a2278925483c", "filename": "src/comp/middle/shape.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/52f76400b5b8fc9ac14c2caa5eb6736bcbd38223/src%2Fcomp%2Fmiddle%2Fshape.rs", "raw_url": "https://github.com/rust-lang/rust/raw/52f76400b5b8fc9ac14c2caa5eb6736bcbd38223/src%2Fcomp%2Fmiddle%2Fshape.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmiddle%2Fshape.rs?ref=52f76400b5b8fc9ac14c2caa5eb6736bcbd38223", "patch": "@@ -305,7 +305,7 @@ fn shape_of(ccx: @crate_ctxt, t: ty::t, ty_param_map: [uint],\n       ty::ty_int(ast::ty_i.) { s += [s_int(ccx.tcx)]; }\n       ty::ty_float(ast::ty_f.) { s += [s_float(ccx.tcx)]; }\n       ty::ty_uint(ast::ty_u.) | ty::ty_ptr(_) | ty::ty_type. |\n-      ty::ty_native(_) { s += [s_uint(ccx.tcx)]; }\n+      ty::ty_send_type. | ty::ty_native(_) { s += [s_uint(ccx.tcx)]; }\n       ty::ty_int(ast::ty_i8.) { s += [shape_i8]; }\n       ty::ty_uint(ast::ty_u16.) { s += [shape_u16]; }\n       ty::ty_int(ast::ty_i16.) { s += [shape_i16]; }"}, {"sha": "de5954796fc01aa0df6c9edd2ff99e084d4db409", "filename": "src/comp/middle/trans.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/52f76400b5b8fc9ac14c2caa5eb6736bcbd38223/src%2Fcomp%2Fmiddle%2Ftrans.rs", "raw_url": "https://github.com/rust-lang/rust/raw/52f76400b5b8fc9ac14c2caa5eb6736bcbd38223/src%2Fcomp%2Fmiddle%2Ftrans.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmiddle%2Ftrans.rs?ref=52f76400b5b8fc9ac14c2caa5eb6736bcbd38223", "patch": "@@ -192,7 +192,7 @@ fn type_of_inner(cx: @crate_ctxt, sp: span, t: ty::t)\n         std::util::unreachable()\n       }\n       ty::ty_param(_, _) { T_typaram(cx.tn) }\n-      ty::ty_type. { T_ptr(cx.tydesc_type) }\n+      ty::ty_send_type. | ty::ty_type. { T_ptr(cx.tydesc_type) }\n       ty::ty_tup(elts) {\n         let tys = [];\n         for elt in elts {\n@@ -204,6 +204,11 @@ fn type_of_inner(cx: @crate_ctxt, sp: span, t: ty::t)\n       ty::ty_opaque_closure. {\n         T_opaque_closure(cx)\n       }\n+      _ {\n+        log_err (\"type_of_inner not implemented for \",\n+                ty::struct(cx.tcx, t));\n+        fail \"type_of_inner not implemented for this kind of type\";\n+      }\n     };\n     cx.lltypes.insert(t, llty);\n     ret llty;"}]}