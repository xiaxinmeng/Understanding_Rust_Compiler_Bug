{"sha": "f0c459ebd2edbf6ad18eac91fb1ad80b98d3359e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYwYzQ1OWViZDJlZGJmNmFkMThlYWM5MWZiMWFkODBiOThkMzM1OWU=", "commit": {"author": {"name": "Johannes L\u00f6thberg", "email": "johannes@kyriasis.com", "date": "2018-02-22T20:28:20Z"}, "committer": {"name": "Johannes L\u00f6thberg", "email": "johannes@kyriasis.com", "date": "2018-03-06T22:39:00Z"}, "message": "Make relro-level=off explicitly disable RELRO\n\nPreviously relro-level=off would just not tell the linker to use RELRO,\nbut when you want to disable RELRO you most likely want to entirely\nprevent.\n\nSigned-off-by: Johannes L\u00f6thberg <johannes@kyriasis.com>", "tree": {"sha": "98cba0916ee9524724a1464b1ebf94f1f3181c63", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/98cba0916ee9524724a1464b1ebf94f1f3181c63"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f0c459ebd2edbf6ad18eac91fb1ad80b98d3359e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f0c459ebd2edbf6ad18eac91fb1ad80b98d3359e", "html_url": "https://github.com/rust-lang/rust/commit/f0c459ebd2edbf6ad18eac91fb1ad80b98d3359e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f0c459ebd2edbf6ad18eac91fb1ad80b98d3359e/comments", "author": {"login": "kyrias", "id": 2285387, "node_id": "MDQ6VXNlcjIyODUzODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2285387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyrias", "html_url": "https://github.com/kyrias", "followers_url": "https://api.github.com/users/kyrias/followers", "following_url": "https://api.github.com/users/kyrias/following{/other_user}", "gists_url": "https://api.github.com/users/kyrias/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyrias/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyrias/subscriptions", "organizations_url": "https://api.github.com/users/kyrias/orgs", "repos_url": "https://api.github.com/users/kyrias/repos", "events_url": "https://api.github.com/users/kyrias/events{/privacy}", "received_events_url": "https://api.github.com/users/kyrias/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kyrias", "id": 2285387, "node_id": "MDQ6VXNlcjIyODUzODc=", "avatar_url": "https://avatars.githubusercontent.com/u/2285387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kyrias", "html_url": "https://github.com/kyrias", "followers_url": "https://api.github.com/users/kyrias/followers", "following_url": "https://api.github.com/users/kyrias/following{/other_user}", "gists_url": "https://api.github.com/users/kyrias/gists{/gist_id}", "starred_url": "https://api.github.com/users/kyrias/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kyrias/subscriptions", "organizations_url": "https://api.github.com/users/kyrias/orgs", "repos_url": "https://api.github.com/users/kyrias/repos", "events_url": "https://api.github.com/users/kyrias/events{/privacy}", "received_events_url": "https://api.github.com/users/kyrias/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2789b067da2ac921b86199bde21dd231ace1da39", "url": "https://api.github.com/repos/rust-lang/rust/commits/2789b067da2ac921b86199bde21dd231ace1da39", "html_url": "https://github.com/rust-lang/rust/commit/2789b067da2ac921b86199bde21dd231ace1da39"}], "stats": {"total": 27, "additions": 21, "deletions": 6}, "files": [{"sha": "56b845c304932f3e651c07b17c039cfb58b2bee2", "filename": "src/librustc_trans/back/link.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/f0c459ebd2edbf6ad18eac91fb1ad80b98d3359e/src%2Flibrustc_trans%2Fback%2Flink.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f0c459ebd2edbf6ad18eac91fb1ad80b98d3359e/src%2Flibrustc_trans%2Fback%2Flink.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fback%2Flink.rs?ref=f0c459ebd2edbf6ad18eac91fb1ad80b98d3359e", "patch": "@@ -1014,7 +1014,9 @@ fn link_args(cmd: &mut Linker,\n         RelroLevel::Partial => {\n             cmd.partial_relro();\n         },\n-        RelroLevel::Off => {},\n+        RelroLevel::Off => {\n+            cmd.no_relro();\n+        },\n     }\n \n     // Pass optimization flags down to the linker."}, {"sha": "9bd7d83a19185135f3f4f9307f974b1583c22211", "filename": "src/librustc_trans/back/linker.rs", "status": "modified", "additions": 18, "deletions": 5, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/f0c459ebd2edbf6ad18eac91fb1ad80b98d3359e/src%2Flibrustc_trans%2Fback%2Flinker.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f0c459ebd2edbf6ad18eac91fb1ad80b98d3359e/src%2Flibrustc_trans%2Fback%2Flinker.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fback%2Flinker.rs?ref=f0c459ebd2edbf6ad18eac91fb1ad80b98d3359e", "patch": "@@ -113,8 +113,9 @@ pub trait Linker {\n     fn gc_sections(&mut self, keep_metadata: bool);\n     fn position_independent_executable(&mut self);\n     fn no_position_independent_executable(&mut self);\n-    fn partial_relro(&mut self);\n     fn full_relro(&mut self);\n+    fn partial_relro(&mut self);\n+    fn no_relro(&mut self);\n     fn optimize(&mut self);\n     fn debuginfo(&mut self);\n     fn no_default_libraries(&mut self);\n@@ -188,8 +189,9 @@ impl<'a> Linker for GccLinker<'a> {\n     fn add_object(&mut self, path: &Path) { self.cmd.arg(path); }\n     fn position_independent_executable(&mut self) { self.cmd.arg(\"-pie\"); }\n     fn no_position_independent_executable(&mut self) { self.cmd.arg(\"-no-pie\"); }\n-    fn partial_relro(&mut self) { self.linker_arg(\"-z,relro\"); }\n     fn full_relro(&mut self) { self.linker_arg(\"-z,relro,-z,now\"); }\n+    fn partial_relro(&mut self) { self.linker_arg(\"-z,relro\"); }\n+    fn no_relro(&mut self) { self.linker_arg(\"-z,norelro\"); }\n     fn build_static_executable(&mut self) { self.cmd.arg(\"-static\"); }\n     fn args(&mut self, args: &[String]) { self.cmd.args(args); }\n \n@@ -452,11 +454,15 @@ impl<'a> Linker for MsvcLinker<'a> {\n         // noop\n     }\n \n+    fn full_relro(&mut self) {\n+        // noop\n+    }\n+\n     fn partial_relro(&mut self) {\n         // noop\n     }\n \n-    fn full_relro(&mut self) {\n+    fn no_relro(&mut self) {\n         // noop\n     }\n \n@@ -664,11 +670,15 @@ impl<'a> Linker for EmLinker<'a> {\n         // noop\n     }\n \n+    fn full_relro(&mut self) {\n+        // noop\n+    }\n+\n     fn partial_relro(&mut self) {\n         // noop\n     }\n \n-    fn full_relro(&mut self) {\n+    fn no_relro(&mut self) {\n         // noop\n     }\n \n@@ -829,10 +839,13 @@ impl Linker for WasmLd {\n     fn position_independent_executable(&mut self) {\n     }\n \n+    fn full_relro(&mut self) {\n+    }\n+\n     fn partial_relro(&mut self) {\n     }\n \n-    fn full_relro(&mut self) {\n+    fn no_relro(&mut self) {\n     }\n \n     fn build_static_executable(&mut self) {"}]}