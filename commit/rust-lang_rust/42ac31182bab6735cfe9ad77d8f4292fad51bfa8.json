{"sha": "42ac31182bab6735cfe9ad77d8f4292fad51bfa8", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQyYWMzMTE4MmJhYjY3MzVjZmU5YWQ3N2Q4ZjQyOTJmYWQ1MWJmYTg=", "commit": {"author": {"name": "Peter Atashian", "email": "retep998@gmail.com", "date": "2017-06-01T03:24:19Z"}, "committer": {"name": "Peter Atashian", "email": "retep998@gmail.com", "date": "2017-06-02T10:30:54Z"}, "message": "Add test for vecs with overaligned data", "tree": {"sha": "1fe80559e706cd2cf61e581d2f69cbc12fd9d3f2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1fe80559e706cd2cf61e581d2f69cbc12fd9d3f2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/42ac31182bab6735cfe9ad77d8f4292fad51bfa8", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v2\n\niQEcBAABCAAGBQJZMT5eAAoJEN4E2eJ1WbyKxj0H/2X/Dx4BQvCh/HkTXjJQRQtL\nCZD0lESllQvZz2ThZKqEyL6QON+rkMZtivK+6nR0iWYyr6oXp9igw5YgZ+D/n7th\nYkMsfyKiq0ahEdVGRU4YzFEEEEEfeZhqFdd/UmAZ4xdpP7R7F93e6YR2F9bdOUPQ\n+92v0stAdXKH0hS3fCRKMQ72cdMlPYPZQKAuMb5R8FdK4W922zls8HfcdukNSNCF\ngnpyuWgZlj5i0QKM4kKZVociUkh1iRyVn3xqyd1RQyX8hYVPP68TTnTC5OZRsQ9w\nf+2eesN2/bdyPdJpRIn7e7YlNMUNrSPlgZrEK3dk2yckpnvtv+iAAaeWAG9GTDQ=\n=ywxa\n-----END PGP SIGNATURE-----", "payload": "tree 1fe80559e706cd2cf61e581d2f69cbc12fd9d3f2\nparent 077c23e9879f4d0c7dab984cd518b21aa5e7347f\nauthor Peter Atashian <retep998@gmail.com> 1496287459 -0400\ncommitter Peter Atashian <retep998@gmail.com> 1496399454 -0400\n\nAdd test for vecs with overaligned data\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/42ac31182bab6735cfe9ad77d8f4292fad51bfa8", "html_url": "https://github.com/rust-lang/rust/commit/42ac31182bab6735cfe9ad77d8f4292fad51bfa8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/42ac31182bab6735cfe9ad77d8f4292fad51bfa8/comments", "author": {"login": "retep998", "id": 666308, "node_id": "MDQ6VXNlcjY2NjMwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/666308?v=4", "gravatar_id": "", "url": "https://api.github.com/users/retep998", "html_url": "https://github.com/retep998", "followers_url": "https://api.github.com/users/retep998/followers", "following_url": "https://api.github.com/users/retep998/following{/other_user}", "gists_url": "https://api.github.com/users/retep998/gists{/gist_id}", "starred_url": "https://api.github.com/users/retep998/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/retep998/subscriptions", "organizations_url": "https://api.github.com/users/retep998/orgs", "repos_url": "https://api.github.com/users/retep998/repos", "events_url": "https://api.github.com/users/retep998/events{/privacy}", "received_events_url": "https://api.github.com/users/retep998/received_events", "type": "User", "site_admin": false}, "committer": {"login": "retep998", "id": 666308, "node_id": "MDQ6VXNlcjY2NjMwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/666308?v=4", "gravatar_id": "", "url": "https://api.github.com/users/retep998", "html_url": "https://github.com/retep998", "followers_url": "https://api.github.com/users/retep998/followers", "following_url": "https://api.github.com/users/retep998/following{/other_user}", "gists_url": "https://api.github.com/users/retep998/gists{/gist_id}", "starred_url": "https://api.github.com/users/retep998/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/retep998/subscriptions", "organizations_url": "https://api.github.com/users/retep998/orgs", "repos_url": "https://api.github.com/users/retep998/repos", "events_url": "https://api.github.com/users/retep998/events{/privacy}", "received_events_url": "https://api.github.com/users/retep998/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "077c23e9879f4d0c7dab984cd518b21aa5e7347f", "url": "https://api.github.com/repos/rust-lang/rust/commits/077c23e9879f4d0c7dab984cd518b21aa5e7347f", "html_url": "https://github.com/rust-lang/rust/commit/077c23e9879f4d0c7dab984cd518b21aa5e7347f"}], "stats": {"total": 17, "additions": 17, "deletions": 0}, "files": [{"sha": "66918e0f5f8ae5bbfadb631837388092e8fcc51b", "filename": "src/libcollections/tests/lib.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/42ac31182bab6735cfe9ad77d8f4292fad51bfa8/src%2Flibcollections%2Ftests%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/42ac31182bab6735cfe9ad77d8f4292fad51bfa8/src%2Flibcollections%2Ftests%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcollections%2Ftests%2Flib.rs?ref=42ac31182bab6735cfe9ad77d8f4292fad51bfa8", "patch": "@@ -10,6 +10,7 @@\n \n #![deny(warnings)]\n \n+#![feature(attr_literals)]\n #![feature(box_syntax)]\n #![feature(inclusive_range_syntax)]\n #![feature(collection_placement)]\n@@ -19,6 +20,7 @@\n #![feature(pattern)]\n #![feature(placement_in_syntax)]\n #![feature(rand)]\n+#![feature(repr_align)]\n #![feature(slice_rotate)]\n #![feature(splice)]\n #![feature(step_by)]"}, {"sha": "fdf453b39cf5d9144c21cf9c4091af7c41c44312", "filename": "src/libcollections/tests/vec.rs", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/42ac31182bab6735cfe9ad77d8f4292fad51bfa8/src%2Flibcollections%2Ftests%2Fvec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/42ac31182bab6735cfe9ad77d8f4292fad51bfa8/src%2Flibcollections%2Ftests%2Fvec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcollections%2Ftests%2Fvec.rs?ref=42ac31182bab6735cfe9ad77d8f4292fad51bfa8", "patch": "@@ -781,3 +781,18 @@ fn from_into_inner() {\n     assert_eq!(vec, [2, 3]);\n     assert!(ptr != vec.as_ptr());\n }\n+\n+#[test]\n+fn overaligned_allocations() {\n+    #[repr(align(256))]\n+    struct Foo(usize);\n+    let mut v = vec![Foo(273)];\n+    for i in 0..0x1000 {\n+        v.reserve_exact(i);\n+        assert!(v[0].0 == 273);\n+        assert!(v.as_ptr() as usize & 0xff == 0);\n+        v.shrink_to_fit();\n+        assert!(v[0].0 == 273);\n+        assert!(v.as_ptr() as usize & 0xff == 0);\n+    }\n+}"}]}