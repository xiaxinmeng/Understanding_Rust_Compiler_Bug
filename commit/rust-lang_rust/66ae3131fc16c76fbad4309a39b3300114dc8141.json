{"sha": "66ae3131fc16c76fbad4309a39b3300114dc8141", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY2YWUzMTMxZmMxNmM3NmZiYWQ0MzA5YTM5YjMzMDAxMTRkYzgxNDE=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2019-02-17T15:19:47Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2019-02-17T15:39:50Z"}, "message": "publish_toolstate.py: further fix the runtime errors\n\nThe regex was missing a `,`, causing `relevant_pr_match` to become None\nand set the PR number to -1 and assigned the new issue to\n`@<unknown user>`. This causes the 422 error when creating the issue due\nto invalid assignee and unable to leave the tool-is-broken comment since\nPR -1 does not exist.\n\nThe default user names are now also changed to @ghost to prevent the\n422 error in case anything goes wrong again.", "tree": {"sha": "e0d19b97d2d51da27974d30912be05bcbfbb4632", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e0d19b97d2d51da27974d30912be05bcbfbb4632"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/66ae3131fc16c76fbad4309a39b3300114dc8141", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlxpgEYACgkQ/vbIBR0O\nATyuhxAAt3JJry3LT9lDHM3jw3x7e3GdE267E2pV9ibT5vIhckDz97gkCCXRCczu\n8nTdBIu6kmikXcrJ6j27pqHCjS28J4RyWxv1lQnxRKczMTPG3HQ380xxqnInKBIX\nH1TLYa5JiEnDK9uKNJ2rCc1FgamIjWBx3nsjDFCFJ0yjA/256FO7JRPbterLlaTk\n4ymU5E22KZ0PZ6tvctShbWwxI+VfTLoWw1c/QJh0J2e4zqqTPsJqGI8wRXwkHfy2\nJx28PqC737t2cV/Y2oKjzuaVnyejnVfIVXOQcsSD1tossNi3Na6VncwKocXLgKj7\nrN8kFP74PBgpvhVs7YPFikKHwBWYd4HZr7sJRv7aHVHvQiq93gmGLVQBCrVAdByY\nED8debh1VX1oh7DW7O2TkHiCutGgsPdZmfQMlQKo4nU4gg4YV/dTdHlNCrIGCPJo\nfJNGOQTSkgCsfPvzZyAnvymd7C1kEns+eqwxcDWePvu50XBz9Pst9NW3Q7rTpUGK\nokdGWW/Y9GRjZ0h6VUZtl0lidYTHMLBC4oXKaFyxSZBW0CXLbUj7ZwGNIyWGJfUN\nUR9Y/+czbL+9RCcX3uTSyMG5BF5dByZroK+Q2ba4Uu5TWZpAtUiWhTGHzLZ5kXdn\nLHVVYPPc194WQ2GcFT8gzdpZDoFQMhq9vH0DZwgCEmSi9vIc5vA=\n=cXO+\n-----END PGP SIGNATURE-----", "payload": "tree e0d19b97d2d51da27974d30912be05bcbfbb4632\nparent 8af675a07576940ba24e3d91abd10b029b937946\nauthor kennytm <kennytm@gmail.com> 1550416787 +0800\ncommitter kennytm <kennytm@gmail.com> 1550417990 +0800\n\npublish_toolstate.py: further fix the runtime errors\n\nThe regex was missing a `,`, causing `relevant_pr_match` to become None\nand set the PR number to -1 and assigned the new issue to\n`@<unknown user>`. This causes the 422 error when creating the issue due\nto invalid assignee and unable to leave the tool-is-broken comment since\nPR -1 does not exist.\n\nThe default user names are now also changed to @ghost to prevent the\n422 error in case anything goes wrong again.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/66ae3131fc16c76fbad4309a39b3300114dc8141", "html_url": "https://github.com/rust-lang/rust/commit/66ae3131fc16c76fbad4309a39b3300114dc8141", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/66ae3131fc16c76fbad4309a39b3300114dc8141/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8af675a07576940ba24e3d91abd10b029b937946", "url": "https://api.github.com/repos/rust-lang/rust/commits/8af675a07576940ba24e3d91abd10b029b937946", "html_url": "https://github.com/rust-lang/rust/commit/8af675a07576940ba24e3d91abd10b029b937946"}], "stats": {"total": 6, "additions": 3, "deletions": 3}, "files": [{"sha": "abcf14d90be1548af62915afe14538d4b33e88ee", "filename": "src/tools/publish_toolstate.py", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/66ae3131fc16c76fbad4309a39b3300114dc8141/src%2Ftools%2Fpublish_toolstate.py", "raw_url": "https://github.com/rust-lang/rust/raw/66ae3131fc16c76fbad4309a39b3300114dc8141/src%2Ftools%2Fpublish_toolstate.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fpublish_toolstate.py?ref=66ae3131fc16c76fbad4309a39b3300114dc8141", "patch": "@@ -171,7 +171,7 @@ def update_latest(\n \n     # assume that PR authors are also owners of the repo where the branch lives\n     relevant_pr_match = re.search(\n-        'Auto merge of #([0-9]+) - ([^:]+):[^,]+ r=([^\\s]+)',\n+        r'Auto merge of #([0-9]+) - ([^:]+):[^,]+, r=(\\S+)',\n         cur_commit_msg,\n     )\n     if relevant_pr_match:\n@@ -182,10 +182,10 @@ def update_latest(\n         pr_reviewer = relevant_pr_match.group(3)\n     else:\n         number = '-1'\n-        relevant_pr_user = '<unknown user>'\n+        relevant_pr_user = 'ghost'\n         relevant_pr_number = '<unknown PR>'\n         relevant_pr_url = '<unknown>'\n-        pr_reviewer = '<unknown reviewer>'\n+        pr_reviewer = 'ghost'\n \n     message = update_latest(\n         cur_commit,"}]}