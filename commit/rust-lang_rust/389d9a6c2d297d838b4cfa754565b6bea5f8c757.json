{"sha": "389d9a6c2d297d838b4cfa754565b6bea5f8c757", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM4OWQ5YTZjMmQyOTdkODM4YjRjZmE3NTQ1NjViNmJlYTVmOGM3NTc=", "commit": {"author": {"name": "Charles Lew", "email": "crlf0710@gmail.com", "date": "2020-09-16T12:57:14Z"}, "committer": {"name": "Charles Lew", "email": "crlf0710@gmail.com", "date": "2020-09-16T12:57:14Z"}, "message": "Lower extern type alias as foreign opaque type.", "tree": {"sha": "ac8ace43e9dd1167fb343092685f710a7c57a1a5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ac8ace43e9dd1167fb343092685f710a7c57a1a5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/389d9a6c2d297d838b4cfa754565b6bea5f8c757", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/389d9a6c2d297d838b4cfa754565b6bea5f8c757", "html_url": "https://github.com/rust-lang/rust/commit/389d9a6c2d297d838b4cfa754565b6bea5f8c757", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/389d9a6c2d297d838b4cfa754565b6bea5f8c757/comments", "author": {"login": "crlf0710", "id": 451806, "node_id": "MDQ6VXNlcjQ1MTgwNg==", "avatar_url": "https://avatars.githubusercontent.com/u/451806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crlf0710", "html_url": "https://github.com/crlf0710", "followers_url": "https://api.github.com/users/crlf0710/followers", "following_url": "https://api.github.com/users/crlf0710/following{/other_user}", "gists_url": "https://api.github.com/users/crlf0710/gists{/gist_id}", "starred_url": "https://api.github.com/users/crlf0710/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crlf0710/subscriptions", "organizations_url": "https://api.github.com/users/crlf0710/orgs", "repos_url": "https://api.github.com/users/crlf0710/repos", "events_url": "https://api.github.com/users/crlf0710/events{/privacy}", "received_events_url": "https://api.github.com/users/crlf0710/received_events", "type": "User", "site_admin": false}, "committer": {"login": "crlf0710", "id": 451806, "node_id": "MDQ6VXNlcjQ1MTgwNg==", "avatar_url": "https://avatars.githubusercontent.com/u/451806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crlf0710", "html_url": "https://github.com/crlf0710", "followers_url": "https://api.github.com/users/crlf0710/followers", "following_url": "https://api.github.com/users/crlf0710/following{/other_user}", "gists_url": "https://api.github.com/users/crlf0710/gists{/gist_id}", "starred_url": "https://api.github.com/users/crlf0710/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crlf0710/subscriptions", "organizations_url": "https://api.github.com/users/crlf0710/orgs", "repos_url": "https://api.github.com/users/crlf0710/repos", "events_url": "https://api.github.com/users/crlf0710/events{/privacy}", "received_events_url": "https://api.github.com/users/crlf0710/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b302f69b7c5b1b966ec3f8637761ecb867e3bcca", "url": "https://api.github.com/repos/rust-lang/rust/commits/b302f69b7c5b1b966ec3f8637761ecb867e3bcca", "html_url": "https://github.com/rust-lang/rust/commit/b302f69b7c5b1b966ec3f8637761ecb867e3bcca"}], "stats": {"total": 10, "additions": 8, "deletions": 2}, "files": [{"sha": "6190906da9856f2210605ff98feb7a8442dc09dd", "filename": "crates/hir_def/src/data.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/389d9a6c2d297d838b4cfa754565b6bea5f8c757/crates%2Fhir_def%2Fsrc%2Fdata.rs", "raw_url": "https://github.com/rust-lang/rust/raw/389d9a6c2d297d838b4cfa754565b6bea5f8c757/crates%2Fhir_def%2Fsrc%2Fdata.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_def%2Fsrc%2Fdata.rs?ref=389d9a6c2d297d838b4cfa754565b6bea5f8c757", "patch": "@@ -54,6 +54,7 @@ pub struct TypeAliasData {\n     pub name: Name,\n     pub type_ref: Option<TypeRef>,\n     pub visibility: RawVisibility,\n+    pub is_extern: bool,\n     /// Bounds restricting the type alias itself (eg. `type Ty: Bound;` in a trait or impl).\n     pub bounds: Vec<TypeBound>,\n }\n@@ -71,6 +72,7 @@ impl TypeAliasData {\n             name: typ.name.clone(),\n             type_ref: typ.type_ref.clone(),\n             visibility: item_tree[typ.visibility].clone(),\n+            is_extern: typ.is_extern,\n             bounds: typ.bounds.to_vec(),\n         })\n     }"}, {"sha": "39252bc5e2cb9f3f24e1a4541ddc30805021d461", "filename": "crates/hir_ty/src/lower.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/389d9a6c2d297d838b4cfa754565b6bea5f8c757/crates%2Fhir_ty%2Fsrc%2Flower.rs", "raw_url": "https://github.com/rust-lang/rust/raw/389d9a6c2d297d838b4cfa754565b6bea5f8c757/crates%2Fhir_ty%2Fsrc%2Flower.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_ty%2Fsrc%2Flower.rs?ref=389d9a6c2d297d838b4cfa754565b6bea5f8c757", "patch": "@@ -1101,9 +1101,13 @@ fn type_for_type_alias(db: &dyn HirDatabase, t: TypeAliasId) -> Binders<Ty> {\n     let resolver = t.resolver(db.upcast());\n     let ctx =\n         TyLoweringContext::new(db, &resolver).with_type_param_mode(TypeParamLoweringMode::Variable);\n-    let type_ref = &db.type_alias_data(t).type_ref;\n     let substs = Substs::bound_vars(&generics, DebruijnIndex::INNERMOST);\n-    let inner = Ty::from_hir(&ctx, type_ref.as_ref().unwrap_or(&TypeRef::Error));\n+    let inner = if db.type_alias_data(t).is_extern {\n+        Ty::simple(TypeCtor::ForeignType(t))\n+    } else {\n+        let type_ref = &db.type_alias_data(t).type_ref;\n+        Ty::from_hir(&ctx, type_ref.as_ref().unwrap_or(&TypeRef::Error))\n+    };\n     Binders::new(substs.len(), inner)\n }\n "}]}