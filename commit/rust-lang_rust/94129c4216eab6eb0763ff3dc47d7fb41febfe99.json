{"sha": "94129c4216eab6eb0763ff3dc47d7fb41febfe99", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk0MTI5YzQyMTZlYWI2ZWIwNzYzZmYzZGM0N2Q3ZmI0MWZlYmZlOTk=", "commit": {"author": {"name": "Rafael \u00c1vila de Esp\u00edndola", "email": "respindola@mozilla.com", "date": "2011-05-25T19:33:57Z"}, "committer": {"name": "Rafael \u00c1vila de Esp\u00edndola", "email": "respindola@mozilla.com", "date": "2011-05-25T19:33:57Z"}, "message": "dead argument removal part one.", "tree": {"sha": "5cc8777b4444abea1f99baf7554fbb5c4a2e2d6d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5cc8777b4444abea1f99baf7554fbb5c4a2e2d6d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/94129c4216eab6eb0763ff3dc47d7fb41febfe99", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/94129c4216eab6eb0763ff3dc47d7fb41febfe99", "html_url": "https://github.com/rust-lang/rust/commit/94129c4216eab6eb0763ff3dc47d7fb41febfe99", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/94129c4216eab6eb0763ff3dc47d7fb41febfe99/comments", "author": null, "committer": null, "parents": [{"sha": "db47cb5c1355041a30475e2d32debded1811a354", "url": "https://api.github.com/repos/rust-lang/rust/commits/db47cb5c1355041a30475e2d32debded1811a354", "html_url": "https://github.com/rust-lang/rust/commit/db47cb5c1355041a30475e2d32debded1811a354"}], "stats": {"total": 16, "additions": 10, "deletions": 6}, "files": [{"sha": "eb09e070db45adffa0ac65ed8f4fcbb59126968b", "filename": "src/comp/middle/trans.rs", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/94129c4216eab6eb0763ff3dc47d7fb41febfe99/src%2Fcomp%2Fmiddle%2Ftrans.rs", "raw_url": "https://github.com/rust-lang/rust/raw/94129c4216eab6eb0763ff3dc47d7fb41febfe99/src%2Fcomp%2Fmiddle%2Ftrans.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmiddle%2Ftrans.rs?ref=94129c4216eab6eb0763ff3dc47d7fb41febfe99", "patch": "@@ -7706,7 +7706,7 @@ fn find_main_fn(&@crate_ctxt cx) -> ValueRef {\n \n fn trans_main_fn(@local_ctxt cx, ValueRef llcrate, ValueRef crate_map) {\n     auto T_main_args = [T_int(), T_int()];\n-    auto T_rust_start_args = [T_int(), T_int(), T_int(), T_int(), T_int()];\n+    auto T_rust_start_args = [T_int(), T_int(), T_int(), T_int()];\n \n     auto main_name;\n     if (str::eq(std::os::target_os(), \"win32\")) {\n@@ -7718,7 +7718,7 @@ fn trans_main_fn(@local_ctxt cx, ValueRef llcrate, ValueRef crate_map) {\n     auto llmain =\n         decl_cdecl_fn(cx.ccx.llmod, main_name, T_fn(T_main_args, T_int()));\n \n-    auto llrust_start = decl_cdecl_fn(cx.ccx.llmod, \"rust_start\",\n+    auto llrust_start = decl_cdecl_fn(cx.ccx.llmod, \"new_rust_start\",\n                                       T_fn(T_rust_start_args, T_int()));\n \n     auto llargc = llvm::LLVMGetParam(llmain, 0u);\n@@ -7737,8 +7737,7 @@ fn trans_main_fn(@local_ctxt cx, ValueRef llcrate, ValueRef crate_map) {\n         llvm::LLVMAppendBasicBlock(llmain, str::buf(\"\"));\n     auto b = new_builder(llbb);\n \n-    auto start_args = [p2i(llrust_main), p2i(llcrate), llargc, llargv,\n-                          p2i(crate_map)];\n+    auto start_args = [p2i(llrust_main), llargc, llargv, p2i(crate_map)];\n \n     b.Ret(b.Call(llrust_start, start_args));\n }"}, {"sha": "0194760c6fdc54722e069e658919ed24f1fec494", "filename": "src/rt/rust.cpp", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/94129c4216eab6eb0763ff3dc47d7fb41febfe99/src%2Frt%2Frust.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/94129c4216eab6eb0763ff3dc47d7fb41febfe99/src%2Frt%2Frust.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust.cpp?ref=94129c4216eab6eb0763ff3dc47d7fb41febfe99", "patch": "@@ -77,8 +77,7 @@ command_line_args : public dom_owned<command_line_args>\n  */\n \n extern \"C\" CDECL int\n-rust_start(uintptr_t main_fn, rust_crate const *crate, int argc,\n-           char **argv, void* crate_map) {\n+new_rust_start(uintptr_t main_fn, int argc, char **argv, void* crate_map) {\n \n     update_log_settings(crate_map, getenv(\"RUST_LOG\"));\n     rust_srv *srv = new rust_srv();\n@@ -118,6 +117,12 @@ rust_start(uintptr_t main_fn, rust_crate const *crate, int argc,\n     return ret;\n }\n \n+extern \"C\" CDECL int\n+rust_start(uintptr_t main_fn, rust_crate const *crate, int argc,\n+           char **argv, void* crate_map) {\n+    return new_rust_start(main_fn, argc, argv, crate_map);\n+}\n+\n //\n // Local Variables:\n // mode: C++"}]}