{"sha": "39dab68404aa5649c45e6d428b8d5edb134ef44c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM5ZGFiNjg0MDRhYTU2NDljNDVlNmQ0MjhiOGQ1ZWRiMTM0ZWY0NGM=", "commit": {"author": {"name": "gfreezy", "email": "gfreezy@gmail.com", "date": "2019-01-01T15:12:51Z"}, "committer": {"name": "gfreezy", "email": "gfreezy@gmail.com", "date": "2019-01-01T15:12:51Z"}, "message": "place complete_use_tree_keyword in the same mod with complete_expr_keyword", "tree": {"sha": "bfbb1d64978187b4eae6042599af2f68bd4c4563", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bfbb1d64978187b4eae6042599af2f68bd4c4563"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/39dab68404aa5649c45e6d428b8d5edb134ef44c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/39dab68404aa5649c45e6d428b8d5edb134ef44c", "html_url": "https://github.com/rust-lang/rust/commit/39dab68404aa5649c45e6d428b8d5edb134ef44c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/39dab68404aa5649c45e6d428b8d5edb134ef44c/comments", "author": {"login": "gfreezy", "id": 510012, "node_id": "MDQ6VXNlcjUxMDAxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/510012?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gfreezy", "html_url": "https://github.com/gfreezy", "followers_url": "https://api.github.com/users/gfreezy/followers", "following_url": "https://api.github.com/users/gfreezy/following{/other_user}", "gists_url": "https://api.github.com/users/gfreezy/gists{/gist_id}", "starred_url": "https://api.github.com/users/gfreezy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gfreezy/subscriptions", "organizations_url": "https://api.github.com/users/gfreezy/orgs", "repos_url": "https://api.github.com/users/gfreezy/repos", "events_url": "https://api.github.com/users/gfreezy/events{/privacy}", "received_events_url": "https://api.github.com/users/gfreezy/received_events", "type": "User", "site_admin": false}, "committer": {"login": "gfreezy", "id": 510012, "node_id": "MDQ6VXNlcjUxMDAxMg==", "avatar_url": "https://avatars.githubusercontent.com/u/510012?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gfreezy", "html_url": "https://github.com/gfreezy", "followers_url": "https://api.github.com/users/gfreezy/followers", "following_url": "https://api.github.com/users/gfreezy/following{/other_user}", "gists_url": "https://api.github.com/users/gfreezy/gists{/gist_id}", "starred_url": "https://api.github.com/users/gfreezy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gfreezy/subscriptions", "organizations_url": "https://api.github.com/users/gfreezy/orgs", "repos_url": "https://api.github.com/users/gfreezy/repos", "events_url": "https://api.github.com/users/gfreezy/events{/privacy}", "received_events_url": "https://api.github.com/users/gfreezy/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9895529d5c7223e572f04ec424d94a187b4983a1", "url": "https://api.github.com/repos/rust-lang/rust/commits/9895529d5c7223e572f04ec424d94a187b4983a1", "html_url": "https://github.com/rust-lang/rust/commit/9895529d5c7223e572f04ec424d94a187b4983a1"}], "stats": {"total": 144, "additions": 67, "deletions": 77}, "files": [{"sha": "b4ee092b50819edaacb89762eff0ff510ac46f40", "filename": "crates/ra_analysis/src/completion.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/39dab68404aa5649c45e6d428b8d5edb134ef44c/crates%2Fra_analysis%2Fsrc%2Fcompletion.rs", "raw_url": "https://github.com/rust-lang/rust/raw/39dab68404aa5649c45e6d428b8d5edb134ef44c/crates%2Fra_analysis%2Fsrc%2Fcompletion.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_analysis%2Fsrc%2Fcompletion.rs?ref=39dab68404aa5649c45e6d428b8d5edb134ef44c", "patch": "@@ -7,7 +7,6 @@ mod complete_keyword;\n mod complete_snippet;\n mod complete_path;\n mod complete_scope;\n-mod complete_use_tree;\n \n use ra_db::SyntaxDatabase;\n \n@@ -41,12 +40,12 @@ pub(crate) fn completions(\n \n     complete_fn_param::complete_fn_param(&mut acc, &ctx);\n     complete_keyword::complete_expr_keyword(&mut acc, &ctx);\n+    complete_keyword::complete_use_tree_keyword(&mut acc, &ctx);\n     complete_snippet::complete_expr_snippet(&mut acc, &ctx);\n     complete_snippet::complete_item_snippet(&mut acc, &ctx);\n     complete_path::complete_path(&mut acc, &ctx)?;\n     complete_scope::complete_scope(&mut acc, &ctx)?;\n     complete_dot::complete_dot(&mut acc, &ctx)?;\n-    complete_use_tree::complete_use_tree_keyword(&mut acc, &ctx);\n \n     Ok(Some(acc))\n }"}, {"sha": "28194c9088755a295a974a1182e031f7406057e8", "filename": "crates/ra_analysis/src/completion/complete_keyword.rs", "status": "modified", "additions": 66, "deletions": 0, "changes": 66, "blob_url": "https://github.com/rust-lang/rust/blob/39dab68404aa5649c45e6d428b8d5edb134ef44c/crates%2Fra_analysis%2Fsrc%2Fcompletion%2Fcomplete_keyword.rs", "raw_url": "https://github.com/rust-lang/rust/raw/39dab68404aa5649c45e6d428b8d5edb134ef44c/crates%2Fra_analysis%2Fsrc%2Fcompletion%2Fcomplete_keyword.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_analysis%2Fsrc%2Fcompletion%2Fcomplete_keyword.rs?ref=39dab68404aa5649c45e6d428b8d5edb134ef44c", "patch": "@@ -7,6 +7,38 @@ use ra_syntax::{\n \n use crate::completion::{CompletionContext, CompletionItem, Completions, CompletionKind, CompletionItemKind};\n \n+pub(super) fn complete_use_tree_keyword(acc: &mut Completions, ctx: &CompletionContext) {\n+    // complete keyword \"crate\" in use stmt\n+    match (ctx.use_item_syntax.as_ref(), ctx.path_prefix.as_ref()) {\n+        (Some(_), None) => {\n+            CompletionItem::new(CompletionKind::Keyword, \"crate\")\n+                .kind(CompletionItemKind::Keyword)\n+                .lookup_by(\"crate\")\n+                .snippet(\"crate::\")\n+                .add_to(acc);\n+            CompletionItem::new(CompletionKind::Keyword, \"self\")\n+                .kind(CompletionItemKind::Keyword)\n+                .lookup_by(\"self\")\n+                .add_to(acc);\n+            CompletionItem::new(CompletionKind::Keyword, \"super\")\n+                .kind(CompletionItemKind::Keyword)\n+                .lookup_by(\"super\")\n+                .add_to(acc);\n+        }\n+        (Some(_), Some(_)) => {\n+            CompletionItem::new(CompletionKind::Keyword, \"self\")\n+                .kind(CompletionItemKind::Keyword)\n+                .lookup_by(\"self\")\n+                .add_to(acc);\n+            CompletionItem::new(CompletionKind::Keyword, \"super\")\n+                .kind(CompletionItemKind::Keyword)\n+                .lookup_by(\"super\")\n+                .add_to(acc);\n+        }\n+        _ => {}\n+    }\n+}\n+\n fn keyword(kw: &str, snippet: &str) -> CompletionItem {\n     CompletionItem::new(CompletionKind::Keyword, kw)\n         .kind(CompletionItemKind::Keyword)\n@@ -80,6 +112,40 @@ mod tests {\n         check_completion(code, expected_completions, CompletionKind::Keyword);\n     }\n \n+    #[test]\n+    fn completes_keywords_in_use_stmt() {\n+        check_keyword_completion(\n+            r\"\n+            use <|>\n+            \",\n+            r#\"\n+            crate \"crate\" \"crate::\"\n+            self \"self\"\n+            super \"super\"\n+            \"#,\n+        );\n+\n+        check_keyword_completion(\n+            r\"\n+            use a::<|>\n+            \",\n+            r#\"\n+            self \"self\"\n+            super \"super\"\n+            \"#,\n+        );\n+\n+        check_keyword_completion(\n+            r\"\n+            use a::{b, <|>}\n+            \",\n+            r#\"\n+            self \"self\"\n+            super \"super\"\n+            \"#,\n+        );\n+    }\n+\n     #[test]\n     fn completes_various_keywords_in_function() {\n         check_keyword_completion("}, {"sha": "5f2f6e4496eff08aef5560495511c355c208ec8c", "filename": "crates/ra_analysis/src/completion/complete_use_tree.rs", "status": "removed", "additions": 0, "deletions": 75, "changes": 75, "blob_url": "https://github.com/rust-lang/rust/blob/9895529d5c7223e572f04ec424d94a187b4983a1/crates%2Fra_analysis%2Fsrc%2Fcompletion%2Fcomplete_use_tree.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9895529d5c7223e572f04ec424d94a187b4983a1/crates%2Fra_analysis%2Fsrc%2Fcompletion%2Fcomplete_use_tree.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_analysis%2Fsrc%2Fcompletion%2Fcomplete_use_tree.rs?ref=9895529d5c7223e572f04ec424d94a187b4983a1", "patch": "@@ -1,75 +0,0 @@\n-use crate::completion::{CompletionContext, CompletionItem, Completions, CompletionKind, CompletionItemKind};\n-\n-pub(super) fn complete_use_tree_keyword(acc: &mut Completions, ctx: &CompletionContext) {\n-    // complete keyword \"crate\" in use stmt\n-    match (ctx.use_item_syntax.as_ref(), ctx.path_prefix.as_ref()) {\n-        (Some(_), None) => {\n-            CompletionItem::new(CompletionKind::Keyword, \"crate\")\n-                .kind(CompletionItemKind::Keyword)\n-                .lookup_by(\"crate\")\n-                .snippet(\"crate::\")\n-                .add_to(acc);\n-            CompletionItem::new(CompletionKind::Keyword, \"self\")\n-                .kind(CompletionItemKind::Keyword)\n-                .lookup_by(\"self\")\n-                .add_to(acc);\n-            CompletionItem::new(CompletionKind::Keyword, \"super\")\n-                .kind(CompletionItemKind::Keyword)\n-                .lookup_by(\"super\")\n-                .add_to(acc);\n-        }\n-        (Some(_), Some(_)) => {\n-            CompletionItem::new(CompletionKind::Keyword, \"self\")\n-                .kind(CompletionItemKind::Keyword)\n-                .lookup_by(\"self\")\n-                .add_to(acc);\n-            CompletionItem::new(CompletionKind::Keyword, \"super\")\n-                .kind(CompletionItemKind::Keyword)\n-                .lookup_by(\"super\")\n-                .add_to(acc);\n-        }\n-        _ => {}\n-    }\n-}\n-\n-#[cfg(test)]\n-mod tests {\n-    use crate::completion::{CompletionKind, check_completion};\n-    fn check_keyword_completion(code: &str, expected_completions: &str) {\n-        check_completion(code, expected_completions, CompletionKind::Keyword);\n-    }\n-\n-    #[test]\n-    fn completes_keywords_in_use_stmt() {\n-        check_keyword_completion(\n-            r\"\n-            use <|>\n-            \",\n-            r#\"\n-            crate \"crate\" \"crate::\"\n-            self \"self\"\n-            super \"super\"\n-            \"#,\n-        );\n-\n-        check_keyword_completion(\n-            r\"\n-            use a::<|>\n-            \",\n-            r#\"\n-            self \"self\"\n-            super \"super\"\n-            \"#,\n-        );\n-\n-        check_keyword_completion(\n-            r\"\n-            use a::{b, <|>}\n-            \",\n-            r#\"\n-            self \"self\"\n-            super \"super\"\n-            \"#,\n-        );\n-    }\n-}"}]}