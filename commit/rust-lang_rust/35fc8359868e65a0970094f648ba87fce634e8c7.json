{"sha": "35fc8359868e65a0970094f648ba87fce634e8c7", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM1ZmM4MzU5ODY4ZTY1YTA5NzAwOTRmNjQ4YmE4N2ZjZTYzNGU4Yzc=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-09-08T07:08:50Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-09-08T07:08:50Z"}, "message": "Auto merge of #76423 - Mark-Simulacrum:stable-bootstrap, r=jyn514\n\nMake bootstrap build on beta\n\nThis is generally a good idea, and will help with being able to build bootstrap\nwithout Python over time as it means we can \"just\" build with cargo +beta build\nrather than needing the user to set environment variables. This is a minor step,\nbut a necessary one on that road.\n\nr? `@jyn514`", "tree": {"sha": "0d41a92fc8d41770988249d212c612ea0ca8e839", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0d41a92fc8d41770988249d212c612ea0ca8e839"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/35fc8359868e65a0970094f648ba87fce634e8c7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/35fc8359868e65a0970094f648ba87fce634e8c7", "html_url": "https://github.com/rust-lang/rust/commit/35fc8359868e65a0970094f648ba87fce634e8c7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/35fc8359868e65a0970094f648ba87fce634e8c7/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e82584a77d019bd5ee4254b5870270b1493763a6", "url": "https://api.github.com/repos/rust-lang/rust/commits/e82584a77d019bd5ee4254b5870270b1493763a6", "html_url": "https://github.com/rust-lang/rust/commit/e82584a77d019bd5ee4254b5870270b1493763a6"}, {"sha": "2656d3414c960174b29d2e57122126672d1c747c", "url": "https://api.github.com/repos/rust-lang/rust/commits/2656d3414c960174b29d2e57122126672d1c747c", "html_url": "https://github.com/rust-lang/rust/commit/2656d3414c960174b29d2e57122126672d1c747c"}], "stats": {"total": 9, "additions": 4, "deletions": 5}, "files": [{"sha": "4ab23b40ac34b8615bd28c160c4f2f3787bdabe1", "filename": "src/bootstrap/bootstrap.py", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/35fc8359868e65a0970094f648ba87fce634e8c7/src%2Fbootstrap%2Fbootstrap.py", "raw_url": "https://github.com/rust-lang/rust/raw/35fc8359868e65a0970094f648ba87fce634e8c7/src%2Fbootstrap%2Fbootstrap.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbootstrap.py?ref=35fc8359868e65a0970094f648ba87fce634e8c7", "patch": "@@ -714,7 +714,6 @@ def build_bootstrap(self):\n         # See also: <https://github.com/rust-lang/rust/issues/70208>.\n         if \"CARGO_BUILD_TARGET\" in env:\n             del env[\"CARGO_BUILD_TARGET\"]\n-        env[\"RUSTC_BOOTSTRAP\"] = '1'\n         env[\"CARGO_TARGET_DIR\"] = build_dir\n         env[\"RUSTC\"] = self.rustc()\n         env[\"LD_LIBRARY_PATH\"] = os.path.join(self.bin_root(), \"lib\") + \\"}, {"sha": "3b8c9c2d58e0d0f58f100e1bba5fcd8beecd2b07", "filename": "src/bootstrap/lib.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/35fc8359868e65a0970094f648ba87fce634e8c7/src%2Fbootstrap%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/35fc8359868e65a0970094f648ba87fce634e8c7/src%2Fbootstrap%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Flib.rs?ref=35fc8359868e65a0970094f648ba87fce634e8c7", "patch": "@@ -103,8 +103,6 @@\n //! More documentation can be found in each respective module below, and you can\n //! also check out the `src/bootstrap/README.md` file for more information.\n \n-#![feature(drain_filter)]\n-\n use std::cell::{Cell, RefCell};\n use std::collections::{HashMap, HashSet};\n use std::env;"}, {"sha": "e8d7de7a5dcaa19e40e093e518591e16ec37d8f6", "filename": "src/bootstrap/tool.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/35fc8359868e65a0970094f648ba87fce634e8c7/src%2Fbootstrap%2Ftool.rs", "raw_url": "https://github.com/rust-lang/rust/raw/35fc8359868e65a0970094f648ba87fce634e8c7/src%2Fbootstrap%2Ftool.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftool.rs?ref=35fc8359868e65a0970094f648ba87fce634e8c7", "patch": "@@ -162,13 +162,15 @@ impl Step for ToolBuild {\n                 \"the following dependencies are duplicated although they \\\n                       have the same features enabled:\"\n             );\n-            for (id, cur, prev) in duplicates.drain_filter(|(_, cur, prev)| cur.2 == prev.2) {\n+            let (same, different): (Vec<_>, Vec<_>) =\n+                duplicates.into_iter().partition(|(_, cur, prev)| cur.2 == prev.2);\n+            for (id, cur, prev) in same {\n                 println!(\"  {}\", id);\n                 // same features\n                 println!(\"    `{}` ({:?})\\n    `{}` ({:?})\", cur.0, cur.1, prev.0, prev.1);\n             }\n             println!(\"the following dependencies have different features:\");\n-            for (id, cur, prev) in duplicates {\n+            for (id, cur, prev) in different {\n                 println!(\"  {}\", id);\n                 let cur_features: HashSet<_> = cur.2.into_iter().collect();\n                 let prev_features: HashSet<_> = prev.2.into_iter().collect();"}]}