{"sha": "99868f6ba8c3afb56a92e144fe17bdbe018fa8ec", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk5ODY4ZjZiYThjM2FmYjU2YTkyZTE0NGZlMTdiZGJlMDE4ZmE4ZWM=", "commit": {"author": {"name": "Sean Collins", "email": "sean@cllns.com", "date": "2015-05-17T21:05:23Z"}, "committer": {"name": "Sean Collins", "email": "sean@cllns.com", "date": "2015-05-17T21:05:23Z"}, "message": "Add 'active' class to current page in rustbook table of contents", "tree": {"sha": "569cb949ae56c4844200e792fe965fb305f27cae", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/569cb949ae56c4844200e792fe965fb305f27cae"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/99868f6ba8c3afb56a92e144fe17bdbe018fa8ec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/99868f6ba8c3afb56a92e144fe17bdbe018fa8ec", "html_url": "https://github.com/rust-lang/rust/commit/99868f6ba8c3afb56a92e144fe17bdbe018fa8ec", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/99868f6ba8c3afb56a92e144fe17bdbe018fa8ec/comments", "author": {"login": "cllns", "id": 632942, "node_id": "MDQ6VXNlcjYzMjk0Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/632942?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cllns", "html_url": "https://github.com/cllns", "followers_url": "https://api.github.com/users/cllns/followers", "following_url": "https://api.github.com/users/cllns/following{/other_user}", "gists_url": "https://api.github.com/users/cllns/gists{/gist_id}", "starred_url": "https://api.github.com/users/cllns/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cllns/subscriptions", "organizations_url": "https://api.github.com/users/cllns/orgs", "repos_url": "https://api.github.com/users/cllns/repos", "events_url": "https://api.github.com/users/cllns/events{/privacy}", "received_events_url": "https://api.github.com/users/cllns/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cllns", "id": 632942, "node_id": "MDQ6VXNlcjYzMjk0Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/632942?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cllns", "html_url": "https://github.com/cllns", "followers_url": "https://api.github.com/users/cllns/followers", "following_url": "https://api.github.com/users/cllns/following{/other_user}", "gists_url": "https://api.github.com/users/cllns/gists{/gist_id}", "starred_url": "https://api.github.com/users/cllns/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cllns/subscriptions", "organizations_url": "https://api.github.com/users/cllns/orgs", "repos_url": "https://api.github.com/users/cllns/repos", "events_url": "https://api.github.com/users/cllns/events{/privacy}", "received_events_url": "https://api.github.com/users/cllns/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8b7c17db2235a2a3f2c71242b11fc429a8d05a90", "url": "https://api.github.com/repos/rust-lang/rust/commits/8b7c17db2235a2a3f2c71242b11fc429a8d05a90", "html_url": "https://github.com/rust-lang/rust/commit/8b7c17db2235a2a3f2c71242b11fc429a8d05a90"}], "stats": {"total": 30, "additions": 21, "deletions": 9}, "files": [{"sha": "31c973214a1c944aac7d567dd312eb2fe693e45c", "filename": "src/rustbook/build.rs", "status": "modified", "additions": 16, "deletions": 9, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/99868f6ba8c3afb56a92e144fe17bdbe018fa8ec/src%2Frustbook%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99868f6ba8c3afb56a92e144fe17bdbe018fa8ec/src%2Frustbook%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustbook%2Fbuild.rs?ref=99868f6ba8c3afb56a92e144fe17bdbe018fa8ec", "patch": "@@ -37,27 +37,34 @@ pub fn parse_cmd(name: &str) -> Option<Box<Subcommand>> {\n     }\n }\n \n-fn write_toc(book: &Book, path_to_root: &Path, out: &mut Write) -> io::Result<()> {\n+fn write_toc(book: &Book, current_page: &BookItem, out: &mut Write) -> io::Result<()> {\n     fn walk_items(items: &[BookItem],\n                   section: &str,\n-                  path_to_root: &Path,\n+                  current_page: &BookItem,\n                   out: &mut Write) -> io::Result<()> {\n         for (i, item) in items.iter().enumerate() {\n-            try!(walk_item(item, &format!(\"{}{}.\", section, i + 1)[..], path_to_root, out));\n+            try!(walk_item(item, &format!(\"{}{}.\", section, i + 1)[..], current_page, out));\n         }\n         Ok(())\n     }\n     fn walk_item(item: &BookItem,\n                  section: &str,\n-                 path_to_root: &Path,\n+                 current_page: &BookItem,\n                  out: &mut Write) -> io::Result<()> {\n-        try!(writeln!(out, \"<li><a href='{}'><b>{}</b> {}</a>\",\n-                 path_to_root.join(&item.path.with_extension(\"html\")).display(),\n+        let class_string = if item.path == current_page.path {\n+          \"class='active'\"\n+        } else {\n+        \"\"\n+        };\n+\n+        try!(writeln!(out, \"<li><a {} href='{}'><b>{}</b> {}</a>\",\n+                 class_string,\n+                 item.path_to_root.join(&item.path.with_extension(\"html\")).display(),\n                  section,\n                  item.title));\n         if !item.children.is_empty() {\n             try!(writeln!(out, \"<ul class='section'>\"));\n-            let _ = walk_items(&item.children[..], section, path_to_root, out);\n+            let _ = walk_items(&item.children[..], section, current_page, out);\n             try!(writeln!(out, \"</ul>\"));\n         }\n         try!(writeln!(out, \"</li>\"));\n@@ -67,7 +74,7 @@ fn write_toc(book: &Book, path_to_root: &Path, out: &mut Write) -> io::Result<()\n \n     try!(writeln!(out, \"<div id='toc' class='mobile-hidden'>\"));\n     try!(writeln!(out, \"<ul class='chapter'>\"));\n-    try!(walk_items(&book.chapters[..], \"\", path_to_root, out));\n+    try!(walk_items(&book.chapters[..], \"\", &current_page, out));\n     try!(writeln!(out, \"</ul>\"));\n     try!(writeln!(out, \"</div>\"));\n \n@@ -115,7 +122,7 @@ fn render(book: &Book, tgt: &Path) -> CliResult<()> {\n                   <span class=\"bar\"></span>\n                 </button>\n               </div>\"#));\n-            let _ = write_toc(book, &item.path_to_root, &mut toc);\n+            let _ = write_toc(book, &item, &mut toc);\n             try!(writeln!(&mut toc, \"<div id='page-wrapper'>\"));\n             try!(writeln!(&mut toc, \"<div id='page'>\"));\n         }"}, {"sha": "aae5f21a73dc653f0e7b7e37bde2095ae0a2f666", "filename": "src/rustbook/css.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/99868f6ba8c3afb56a92e144fe17bdbe018fa8ec/src%2Frustbook%2Fcss.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99868f6ba8c3afb56a92e144fe17bdbe018fa8ec/src%2Frustbook%2Fcss.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustbook%2Fcss.rs?ref=99868f6ba8c3afb56a92e144fe17bdbe018fa8ec", "patch": "@@ -97,6 +97,11 @@ body {\n     color: #000000;\n }\n \n+.chapter li a.active {\n+    text-decoration: underline;\n+    font-weight: bold;\n+}\n+\n #toggle-nav {\n     height: 20px;\n     width:  30px;"}]}