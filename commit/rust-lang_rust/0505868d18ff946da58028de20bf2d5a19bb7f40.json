{"sha": "0505868d18ff946da58028de20bf2d5a19bb7f40", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA1MDU4NjhkMThmZjk0NmRhNTgwMjhkZTIwYmYyZDVhMTliYjdmNDA=", "commit": {"author": {"name": "Aaron Hill", "email": "aa1ronham@gmail.com", "date": "2019-08-04T13:21:17Z"}, "committer": {"name": "Aaron Hill", "email": "aa1ronham@gmail.com", "date": "2019-08-04T13:21:17Z"}, "message": "Do nothing when we try to generate random data of length 0\n\nThis preserves compatibility with programs that pass a null pointer and\na length of zero to getrandom(), or their platform's equivalent.", "tree": {"sha": "e32e8fce24d75379cfc3e72900415d0f661d8b14", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e32e8fce24d75379cfc3e72900415d0f661d8b14"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0505868d18ff946da58028de20bf2d5a19bb7f40", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE7J9Gc3TfBwj2K399tAh+UQ6YsWQFAl1G2/gACgkQtAh+UQ6Y\nsWQQuhAAm6OOdCCnReYQuxl4ab78TDgrkHcqXPP0Z0CRaU8OT2GuKNcUdyZx1a9k\nzH0yxLPVewOSCN02AFrCE/wGaOelGBADeqkgIHXCNsq5Df/afasplMoHjZ0IQWgV\n9sa02QHRsqvqZWWZu/lk3crlxeeS9btANAceQ0Cn1/YyatX01iKFdymGBU13W6cU\nwHFDxqBm9fd3qMksikpzdxtdBvZXWUc5d0OGWR6yz93HFZ+MdmPPYeHHmxpY0Orn\nEzNeBgpHutaqxXB6vfV/3k0zEBuDLXRf6mX3GkpO4VmsZQ0gTcSyC0HQeKsbXPAe\nFfpmN598134NF8lrQ+1g6emPIbutdJ1kBBtv2/EJYK2Wjaw7iI7fohnPZXBnAsV6\nX8/oK8WD+J61LCHjrfagbVH7hIp1i22CGiJ9Ju5RWcGoqZGxN0gh4idF1TMzp60x\nipshKd4QqbxGOzXe5NuGASaTiW8rxLJb13/iWS4JbPgtaMfST70ZF49dsodIwv9R\nDcYU5aHn02RKfQhm2ErTdr1IZGEg7labWr8eQNKbGNVVrvhmkgaVv5LpDKnX0pEg\nOFF5Rre6jyvkdpxSrgqPdWA+Aik4XqDVsFyqSEVE4fYJhLW0KqBcGRqxJSwIZJgP\nqoTZRsO7ISJdAL5FPro8d9te2FmSWVX5xomsiemSGryqWezb9L0=\n=jzOK\n-----END PGP SIGNATURE-----", "payload": "tree e32e8fce24d75379cfc3e72900415d0f661d8b14\nparent d82b24422d3778f595731981065873e015bb297b\nauthor Aaron Hill <aa1ronham@gmail.com> 1564924877 -0400\ncommitter Aaron Hill <aa1ronham@gmail.com> 1564924877 -0400\n\nDo nothing when we try to generate random data of length 0\n\nThis preserves compatibility with programs that pass a null pointer and\na length of zero to getrandom(), or their platform's equivalent.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0505868d18ff946da58028de20bf2d5a19bb7f40", "html_url": "https://github.com/rust-lang/rust/commit/0505868d18ff946da58028de20bf2d5a19bb7f40", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0505868d18ff946da58028de20bf2d5a19bb7f40/comments", "author": {"login": "Aaron1011", "id": 1408859, "node_id": "MDQ6VXNlcjE0MDg4NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1408859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aaron1011", "html_url": "https://github.com/Aaron1011", "followers_url": "https://api.github.com/users/Aaron1011/followers", "following_url": "https://api.github.com/users/Aaron1011/following{/other_user}", "gists_url": "https://api.github.com/users/Aaron1011/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aaron1011/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aaron1011/subscriptions", "organizations_url": "https://api.github.com/users/Aaron1011/orgs", "repos_url": "https://api.github.com/users/Aaron1011/repos", "events_url": "https://api.github.com/users/Aaron1011/events{/privacy}", "received_events_url": "https://api.github.com/users/Aaron1011/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Aaron1011", "id": 1408859, "node_id": "MDQ6VXNlcjE0MDg4NTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1408859?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aaron1011", "html_url": "https://github.com/Aaron1011", "followers_url": "https://api.github.com/users/Aaron1011/followers", "following_url": "https://api.github.com/users/Aaron1011/following{/other_user}", "gists_url": "https://api.github.com/users/Aaron1011/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aaron1011/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aaron1011/subscriptions", "organizations_url": "https://api.github.com/users/Aaron1011/orgs", "repos_url": "https://api.github.com/users/Aaron1011/repos", "events_url": "https://api.github.com/users/Aaron1011/events{/privacy}", "received_events_url": "https://api.github.com/users/Aaron1011/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d82b24422d3778f595731981065873e015bb297b", "url": "https://api.github.com/repos/rust-lang/rust/commits/d82b24422d3778f595731981065873e015bb297b", "html_url": "https://github.com/rust-lang/rust/commit/d82b24422d3778f595731981065873e015bb297b"}], "stats": {"total": 8, "additions": 8, "deletions": 0}, "files": [{"sha": "c543240442ec7e78d649b46787b479de470753cc", "filename": "src/helpers.rs", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/0505868d18ff946da58028de20bf2d5a19bb7f40/src%2Fhelpers.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0505868d18ff946da58028de20bf2d5a19bb7f40/src%2Fhelpers.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fhelpers.rs?ref=0505868d18ff946da58028de20bf2d5a19bb7f40", "patch": "@@ -81,6 +81,14 @@ pub trait EvalContextExt<'mir, 'tcx: 'mir>: crate::MiriEvalContextExt<'mir, 'tcx\n         ptr: Scalar<Tag>,\n         len: usize,\n     ) -> InterpResult<'tcx>  {\n+        // Some programs pass in a null pointer and a length of 0\n+        // to their platform's random-generation function (e.g. getrandom())\n+        // on Linux. For compatibility with these programs, we don't perform\n+        // any additional checks - it's okay if the pointer is invalid,\n+        // since we wouldn't actually be writing to it.\n+        if len == 0 {\n+            return Ok(())\n+        }\n         let this = self.eval_context_mut();\n \n         let ptr = match this.memory().check_ptr_access(ptr, Size::from_bytes(len as u64), Align::from_bytes(1).unwrap())? {"}]}