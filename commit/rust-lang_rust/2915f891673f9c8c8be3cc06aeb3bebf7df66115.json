{"sha": "2915f891673f9c8c8be3cc06aeb3bebf7df66115", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI5MTVmODkxNjczZjljOGM4YmUzY2MwNmFlYjNiZWJmN2RmNjYxMTU=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-09-19T01:59:56Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-09-19T01:59:56Z"}, "message": "Auto merge of #28468 - nagisa:revert-negate-unsigned-warning, r=alexcrichton\n\nThis reverts commit 0ca8e4994ee43ba9dfbded6e129b30ff5fe7a994.\r\n\r\nFixes #27141", "tree": {"sha": "76aad3dfdfa62adb82c03e240f505e87dc5dec9e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/76aad3dfdfa62adb82c03e240f505e87dc5dec9e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2915f891673f9c8c8be3cc06aeb3bebf7df66115", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2915f891673f9c8c8be3cc06aeb3bebf7df66115", "html_url": "https://github.com/rust-lang/rust/commit/2915f891673f9c8c8be3cc06aeb3bebf7df66115", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2915f891673f9c8c8be3cc06aeb3bebf7df66115/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6e5a3254747cf1f76f8ea698d37f688e13344392", "url": "https://api.github.com/repos/rust-lang/rust/commits/6e5a3254747cf1f76f8ea698d37f688e13344392", "html_url": "https://github.com/rust-lang/rust/commit/6e5a3254747cf1f76f8ea698d37f688e13344392"}, {"sha": "5104a93a0d9c09bf53921c4d8a2f48a3b7891ffb", "url": "https://api.github.com/repos/rust-lang/rust/commits/5104a93a0d9c09bf53921c4d8a2f48a3b7891ffb", "html_url": "https://github.com/rust-lang/rust/commit/5104a93a0d9c09bf53921c4d8a2f48a3b7891ffb"}], "stats": {"total": 29, "additions": 15, "deletions": 14}, "files": [{"sha": "5b875e6acbc04b022c38dd1a8bce20f24b9e6663", "filename": "src/librustc_lint/builtin.rs", "status": "modified", "additions": 7, "deletions": 8, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/2915f891673f9c8c8be3cc06aeb3bebf7df66115/src%2Flibrustc_lint%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2915f891673f9c8c8be3cc06aeb3bebf7df66115/src%2Flibrustc_lint%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Fbuiltin.rs?ref=2915f891673f9c8c8be3cc06aeb3bebf7df66115", "patch": "@@ -49,7 +49,7 @@ use std::{i8, i16, i32, i64, u8, u16, u32, u64, f32, f64};\n use syntax::{abi, ast};\n use syntax::attr::{self, AttrMetaMethods};\n use syntax::codemap::{self, Span};\n-use syntax::feature_gate::{KNOWN_ATTRIBUTES, AttributeType};\n+use syntax::feature_gate::{KNOWN_ATTRIBUTES, AttributeType, emit_feature_err, GateIssue};\n use syntax::ast::{TyIs, TyUs, TyI8, TyU8, TyI16, TyU16, TyI32, TyU32, TyI64, TyU64};\n use syntax::ptr::P;\n \n@@ -381,13 +381,12 @@ impl LateLintPass for TypeLimits {\n \n         fn check_unsigned_negation_feature(cx: &LateContext, span: Span) {\n             if !cx.sess().features.borrow().negate_unsigned {\n-                // FIXME(#27141): change this to syntax::feature_gate::emit_feature_err\u2026\n-                cx.sess().span_warn(span,\n-                    \"unary negation of unsigned integers will be feature gated in the future\");\n-                // \u2026and remove following two expressions.\n-                if option_env!(\"CFG_DISABLE_UNSTABLE_FEATURES\").is_some() { return; }\n-                cx.sess().fileline_help(span, \"add #![feature(negate_unsigned)] to the \\\n-                                               crate attributes to enable the gate in advance\");\n+                emit_feature_err(\n+                    &cx.sess().parse_sess.span_diagnostic,\n+                    \"negate_unsigned\",\n+                    span,\n+                    GateIssue::Language,\n+                    \"unary negation of unsigned integers may be removed in the future\");\n             }\n         }\n     }"}, {"sha": "21ac23253c86a7d16ac5a0e2ee21408638bfd2c9", "filename": "src/test/bench/shootout-mandelbrot.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2915f891673f9c8c8be3cc06aeb3bebf7df66115/src%2Ftest%2Fbench%2Fshootout-mandelbrot.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2915f891673f9c8c8be3cc06aeb3bebf7df66115/src%2Ftest%2Fbench%2Fshootout-mandelbrot.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fbench%2Fshootout-mandelbrot.rs?ref=2915f891673f9c8c8be3cc06aeb3bebf7df66115", "patch": "@@ -192,7 +192,7 @@ fn write_line(init_i: f64, vec_init_r: &[f64], res: &mut Vec<u8>) {\n             i += 2;\n         }\n \n-        res.push(cur_byte^-1);\n+        res.push(cur_byte^!0);\n     }\n }\n "}, {"sha": "b1c73fab4ffa61f2623ad2128c12c3272c47bef1", "filename": "src/test/compile-fail/feature-gate-negate-unsigned.rs", "status": "renamed", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/2915f891673f9c8c8be3cc06aeb3bebf7df66115/src%2Ftest%2Fcompile-fail%2Ffeature-gate-negate-unsigned.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2915f891673f9c8c8be3cc06aeb3bebf7df66115/src%2Ftest%2Fcompile-fail%2Ffeature-gate-negate-unsigned.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Ffeature-gate-negate-unsigned.rs?ref=2915f891673f9c8c8be3cc06aeb3bebf7df66115", "patch": "@@ -18,21 +18,21 @@ impl std::ops::Neg for S {\n }\n \n const _MAX: usize = -1;\n-//~^ WARN unary negation of unsigned integers will be feature gated in the future\n+//~^ ERROR unary negation of unsigned integers may be removed in the future\n \n fn main() {\n     let a = -1;\n-    //~^ WARN unary negation of unsigned integers will be feature gated in the future\n+    //~^ ERROR unary negation of unsigned integers may be removed in the future\n     let _b : u8 = a; // for infering variable a to u8.\n \n     -a;\n-    //~^ WARN unary negation of unsigned integers will be feature gated in the future\n+    //~^ ERROR unary negation of unsigned integers may be removed in the future\n \n     let _d = -1u8;\n-    //~^ WARN unary negation of unsigned integers will be feature gated in the future\n+    //~^ ERROR unary negation of unsigned integers may be removed in the future\n \n     for _ in -10..10u8 {}\n-    //~^ WARN unary negation of unsigned integers will be feature gated in the future\n+    //~^ ERROR unary negation of unsigned integers may be removed in the future\n \n     -S; // should not trigger the gate; issue 26840\n }", "previous_filename": "src/test/run-pass/feature-gate-negate-unsigned.rs"}, {"sha": "fdb70fe248eff1bc456ebbf60557582488d985b0", "filename": "src/test/run-pass/unary-minus-suffix-inference.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2915f891673f9c8c8be3cc06aeb3bebf7df66115/src%2Ftest%2Frun-pass%2Funary-minus-suffix-inference.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2915f891673f9c8c8be3cc06aeb3bebf7df66115/src%2Ftest%2Frun-pass%2Funary-minus-suffix-inference.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Funary-minus-suffix-inference.rs?ref=2915f891673f9c8c8be3cc06aeb3bebf7df66115", "patch": "@@ -8,6 +8,8 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n+#![feature(negate_unsigned)]\n+\n pub fn main() {\n     let a = 1;\n     let a_neg: i8 = -a;"}]}