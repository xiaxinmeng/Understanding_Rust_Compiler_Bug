{"sha": "c886b72dab918d6f4d3be025135f769bc429cc79", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM4ODZiNzJkYWI5MThkNmY0ZDNiZTAyNTEzNWY3NjliYzQyOWNjNzk=", "commit": {"author": {"name": "Bernardo", "email": "berublan@gmail.com", "date": "2018-12-22T21:11:10Z"}, "committer": {"name": "Bernardo", "email": "berublan@gmail.com", "date": "2018-12-25T19:03:14Z"}, "message": "make criterion args work, small simplification", "tree": {"sha": "f96737e3f2f4512aff9521743a124fe1c1326b8c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f96737e3f2f4512aff9521743a124fe1c1326b8c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c886b72dab918d6f4d3be025135f769bc429cc79", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c886b72dab918d6f4d3be025135f769bc429cc79", "html_url": "https://github.com/rust-lang/rust/commit/c886b72dab918d6f4d3be025135f769bc429cc79", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c886b72dab918d6f4d3be025135f769bc429cc79/comments", "author": {"login": "vemoo", "id": 4866051, "node_id": "MDQ6VXNlcjQ4NjYwNTE=", "avatar_url": "https://avatars.githubusercontent.com/u/4866051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vemoo", "html_url": "https://github.com/vemoo", "followers_url": "https://api.github.com/users/vemoo/followers", "following_url": "https://api.github.com/users/vemoo/following{/other_user}", "gists_url": "https://api.github.com/users/vemoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/vemoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vemoo/subscriptions", "organizations_url": "https://api.github.com/users/vemoo/orgs", "repos_url": "https://api.github.com/users/vemoo/repos", "events_url": "https://api.github.com/users/vemoo/events{/privacy}", "received_events_url": "https://api.github.com/users/vemoo/received_events", "type": "User", "site_admin": false}, "committer": {"login": "vemoo", "id": 4866051, "node_id": "MDQ6VXNlcjQ4NjYwNTE=", "avatar_url": "https://avatars.githubusercontent.com/u/4866051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vemoo", "html_url": "https://github.com/vemoo", "followers_url": "https://api.github.com/users/vemoo/followers", "following_url": "https://api.github.com/users/vemoo/following{/other_user}", "gists_url": "https://api.github.com/users/vemoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/vemoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vemoo/subscriptions", "organizations_url": "https://api.github.com/users/vemoo/orgs", "repos_url": "https://api.github.com/users/vemoo/repos", "events_url": "https://api.github.com/users/vemoo/events{/privacy}", "received_events_url": "https://api.github.com/users/vemoo/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dc2afae991892719b97b0e4b40d8483b43b08680", "url": "https://api.github.com/repos/rust-lang/rust/commits/dc2afae991892719b97b0e4b40d8483b43b08680", "html_url": "https://github.com/rust-lang/rust/commit/dc2afae991892719b97b0e4b40d8483b43b08680"}], "stats": {"total": 36, "additions": 18, "deletions": 18}, "files": [{"sha": "7ed7526ec5baa525051ba59c37d523bd7172a41c", "filename": "crates/ra_editor/Cargo.toml", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c886b72dab918d6f4d3be025135f769bc429cc79/crates%2Fra_editor%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/c886b72dab918d6f4d3be025135f769bc429cc79/crates%2Fra_editor%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_editor%2FCargo.toml?ref=c886b72dab918d6f4d3be025135f769bc429cc79", "patch": "@@ -23,6 +23,10 @@ rand = \"*\"\n rand_xorshift = \"*\"\n lazy_static = \"*\"\n \n+[lib]\n+# so that criterion arguments work, see: https://bheisler.github.io/criterion.rs/book/faq.html#cargo-bench-gives-unrecognized-option-errors-for-valid-command-line-options\n+bench = false\n+\n [[bench]]\n name = \"translate_offset_with_edit_benchmark\"\n harness = false\n\\ No newline at end of file"}, {"sha": "0f550fd39a2f3ce4f8d0a394b7848e5e46bb4a64", "filename": "crates/ra_editor/benches/translate_offset_with_edit_benchmark.rs", "status": "modified", "additions": 14, "deletions": 15, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/c886b72dab918d6f4d3be025135f769bc429cc79/crates%2Fra_editor%2Fbenches%2Ftranslate_offset_with_edit_benchmark.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c886b72dab918d6f4d3be025135f769bc429cc79/crates%2Fra_editor%2Fbenches%2Ftranslate_offset_with_edit_benchmark.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_editor%2Fbenches%2Ftranslate_offset_with_edit_benchmark.rs?ref=c886b72dab918d6f4d3be025135f769bc429cc79", "patch": "@@ -65,21 +65,20 @@ lazy_static! {\n }\n \n fn compare_translates(c: &mut Criterion) {\n-    let f1 = Fun::new(\"translate_after_edit\", |b, _| {\n-        b.iter(|| {\n-            let d = &*DATA;\n-            line_index_utils::translate_after_edit(&d.text, d.offset, d.edits.clone());\n-        })\n-    });\n-\n-    let f2 = Fun::new(\"translate_offset_with_edit\", |b, _| {\n-        b.iter(|| {\n-            let d = &*DATA;\n-            line_index_utils::translate_offset_with_edit(&d.line_index, d.offset, &d.edits);\n-        })\n-    });\n-\n-    let functions = vec![f1, f2];\n+    let functions = vec![\n+        Fun::new(\"translate_after_edit\", |b, _| {\n+            b.iter(|| {\n+                let d = &*DATA;\n+                line_index_utils::translate_after_edit(&d.text, d.offset, d.edits.clone());\n+            })\n+        }),\n+        Fun::new(\"translate_offset_with_edit\", |b, _| {\n+            b.iter(|| {\n+                let d = &*DATA;\n+                line_index_utils::translate_offset_with_edit(&d.line_index, d.offset, &d.edits);\n+            })\n+        }),\n+    ];\n \n     c.bench_functions(\"translate\", functions, ());\n }"}, {"sha": "632c962cc2ad3fe48fd078196113673ea20c30c1", "filename": "crates/ra_editor/src/line_index_utils.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/c886b72dab918d6f4d3be025135f769bc429cc79/crates%2Fra_editor%2Fsrc%2Fline_index_utils.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c886b72dab918d6f4d3be025135f769bc429cc79/crates%2Fra_editor%2Fsrc%2Fline_index_utils.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_editor%2Fsrc%2Fline_index_utils.rs?ref=c886b72dab918d6f4d3be025135f769bc429cc79", "patch": "@@ -270,9 +270,6 @@ pub fn translate_offset_with_edit(\n                 Step::Newline(n) => {\n                     if offset < *n {\n                         return res.to_line_col(offset);\n-                    } else if offset == *n {\n-                        res.add_line(*n);\n-                        return res.to_line_col(offset);\n                     } else {\n                         res.add_line(*n);\n                     }"}]}