{"sha": "3d4d6703a9d54b3285811813fc98b6b30abda03c", "node_id": "C_kwDOAAsO6NoAKDNkNGQ2NzAzYTlkNTRiMzI4NTgxMTgxM2ZjOThiNmIzMGFiZGEwM2M", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-05-10T04:12:14Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-05-10T04:12:14Z"}, "message": "Rollup merge of #111381 - oli-obk:closure_attr, r=petrochenkov\n\nKeep encoding attributes for closures\n\nsee https://github.com/model-checking/kani/pull/2406#issuecomment-1539630332 for some context.\n\nWe stopped encoding attributes for closures, but some tools need them", "tree": {"sha": "92d912538e297ea962b3b234b6fb8e9a4e23cf5f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/92d912538e297ea962b3b234b6fb8e9a4e23cf5f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3d4d6703a9d54b3285811813fc98b6b30abda03c", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkWxmeCRBK7hj4Ov3rIwAAuGUIAA0PPCcJBBuI8ukbM0hfNiau\n5WuINii6N/thLxhBB3we/joANImVrLvJgxt04a5Y48X0ky91DCABIGJRQ8IPVf1M\nS6EXhvQVA63iNX/tWlGY4XsGYKWMLxIZxtlE6/a+hGoDRVqpI8qo/MldldJAjF5S\n/uOnnV/ZM6kvkt9ZiygRcR+uRm+5K3+0+5FUVq6H7xGGlBt2JYGk+eEQhBDcBuQh\nUQ9vkUyteX3ec047U62u1kyFhUrYkl5eTpQ9WxSd1RBByPTgDZdx/kzhLbYF5icV\nmFz9DHUxuPIqPC3lrLCaZR17C2g9k3HhXDZM68Ldlkz8JUPgBgZSNbolgvmEJvE=\n=Plkh\n-----END PGP SIGNATURE-----\n", "payload": "tree 92d912538e297ea962b3b234b6fb8e9a4e23cf5f\nparent d117b41409746d4970ffc886a8f54e49696fe06f\nparent b7f570fff3e582e2ffb8bce3ea698b6bc8f4ccef\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1683691934 +0200\ncommitter GitHub <noreply@github.com> 1683691934 +0200\n\nRollup merge of #111381 - oli-obk:closure_attr, r=petrochenkov\n\nKeep encoding attributes for closures\n\nsee https://github.com/model-checking/kani/pull/2406#issuecomment-1539630332 for some context.\n\nWe stopped encoding attributes for closures, but some tools need them\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3d4d6703a9d54b3285811813fc98b6b30abda03c", "html_url": "https://github.com/rust-lang/rust/commit/3d4d6703a9d54b3285811813fc98b6b30abda03c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3d4d6703a9d54b3285811813fc98b6b30abda03c/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d117b41409746d4970ffc886a8f54e49696fe06f", "url": "https://api.github.com/repos/rust-lang/rust/commits/d117b41409746d4970ffc886a8f54e49696fe06f", "html_url": "https://github.com/rust-lang/rust/commit/d117b41409746d4970ffc886a8f54e49696fe06f"}, {"sha": "b7f570fff3e582e2ffb8bce3ea698b6bc8f4ccef", "url": "https://api.github.com/repos/rust-lang/rust/commits/b7f570fff3e582e2ffb8bce3ea698b6bc8f4ccef", "html_url": "https://github.com/rust-lang/rust/commit/b7f570fff3e582e2ffb8bce3ea698b6bc8f4ccef"}], "stats": {"total": 6, "additions": 5, "deletions": 1}, "files": [{"sha": "29cf432b8f9186030725272371c737d0033db6e2", "filename": "compiler/rustc_metadata/src/rmeta/encoder.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/3d4d6703a9d54b3285811813fc98b6b30abda03c/compiler%2Frustc_metadata%2Fsrc%2Frmeta%2Fencoder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3d4d6703a9d54b3285811813fc98b6b30abda03c/compiler%2Frustc_metadata%2Fsrc%2Frmeta%2Fencoder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_metadata%2Fsrc%2Frmeta%2Fencoder.rs?ref=3d4d6703a9d54b3285811813fc98b6b30abda03c", "patch": "@@ -862,6 +862,11 @@ fn should_encode_attrs(def_kind: DefKind) -> bool {\n         | DefKind::Macro(_)\n         | DefKind::Field\n         | DefKind::Impl { .. } => true,\n+        // Tools may want to be able to detect their tool lints on\n+        // closures from upstream crates, too. This is used by\n+        // https://github.com/model-checking/kani and is not a performance\n+        // or maintenance issue for us.\n+        DefKind::Closure => true,\n         DefKind::TyParam\n         | DefKind::ConstParam\n         | DefKind::Ctor(..)\n@@ -874,7 +879,6 @@ fn should_encode_attrs(def_kind: DefKind) -> bool {\n         | DefKind::ImplTraitPlaceholder\n         | DefKind::LifetimeParam\n         | DefKind::GlobalAsm\n-        | DefKind::Closure\n         | DefKind::Generator => false,\n     }\n }"}]}