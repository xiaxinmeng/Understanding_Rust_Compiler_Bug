{"sha": "c29b3fa1484c625bd34cb4d94fc76f36c6233447", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMyOWIzZmExNDg0YzYyNWJkMzRjYjRkOTRmYzc2ZjM2YzYyMzM0NDc=", "commit": {"author": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2020-05-29T16:24:59Z"}, "committer": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2020-06-10T21:09:51Z"}, "message": "On recursive ADT, provide indirection structured suggestion", "tree": {"sha": "20e2737f33c3ae1a777c4524a34a549ed1117795", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/20e2737f33c3ae1a777c4524a34a549ed1117795"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c29b3fa1484c625bd34cb4d94fc76f36c6233447", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c29b3fa1484c625bd34cb4d94fc76f36c6233447", "html_url": "https://github.com/rust-lang/rust/commit/c29b3fa1484c625bd34cb4d94fc76f36c6233447", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c29b3fa1484c625bd34cb4d94fc76f36c6233447/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bb8674837a9cc5225020e07fc3f164762bb4c11c", "url": "https://api.github.com/repos/rust-lang/rust/commits/bb8674837a9cc5225020e07fc3f164762bb4c11c", "html_url": "https://github.com/rust-lang/rust/commit/bb8674837a9cc5225020e07fc3f164762bb4c11c"}], "stats": {"total": 381, "additions": 315, "deletions": 66}, "files": [{"sha": "acaa26c6ad2fc609b72adbc4c8f79761e3ab902e", "filename": "src/librustc_errors/diagnostic.rs", "status": "modified", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Flibrustc_errors%2Fdiagnostic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Flibrustc_errors%2Fdiagnostic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_errors%2Fdiagnostic.rs?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -296,6 +296,29 @@ impl Diagnostic {\n         self\n     }\n \n+    pub fn multipart_suggestions(\n+        &mut self,\n+        msg: &str,\n+        suggestions: Vec<Vec<(Span, String)>>,\n+        applicability: Applicability,\n+    ) -> &mut Self {\n+        self.suggestions.push(CodeSuggestion {\n+            substitutions: suggestions\n+                .into_iter()\n+                .map(|suggestion| Substitution {\n+                    parts: suggestion\n+                        .into_iter()\n+                        .map(|(span, snippet)| SubstitutionPart { snippet, span })\n+                        .collect(),\n+                })\n+                .collect(),\n+            msg: msg.to_owned(),\n+            style: SuggestionStyle::ShowCode,\n+            applicability,\n+        });\n+        self\n+    }\n+\n     /// Prints out a message with for a multipart suggestion without showing the suggested code.\n     ///\n     /// This is intended to be used for suggestions that are obvious in what the changes need to"}, {"sha": "22bf8fe34aa155543c72fa41ad11d746ec1c8ee3", "filename": "src/librustc_errors/diagnostic_builder.rs", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Flibrustc_errors%2Fdiagnostic_builder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Flibrustc_errors%2Fdiagnostic_builder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_errors%2Fdiagnostic_builder.rs?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -260,6 +260,19 @@ impl<'a> DiagnosticBuilder<'a> {\n         self\n     }\n \n+    pub fn multipart_suggestions(\n+        &mut self,\n+        msg: &str,\n+        suggestions: Vec<Vec<(Span, String)>>,\n+        applicability: Applicability,\n+    ) -> &mut Self {\n+        if !self.0.allow_suggestions {\n+            return self;\n+        }\n+        self.0.diagnostic.multipart_suggestions(msg, suggestions, applicability);\n+        self\n+    }\n+\n     pub fn tool_only_multipart_suggestion(\n         &mut self,\n         msg: &str,"}, {"sha": "5cdfa6f90128dabf35cd962f265978431c5010c4", "filename": "src/librustc_middle/ty/util.rs", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Flibrustc_middle%2Fty%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Flibrustc_middle%2Fty%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_middle%2Fty%2Futil.rs?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -827,7 +827,15 @@ impl<'tcx> ty::TyS<'tcx> {\n                     // Find non representable fields with their spans\n                     fold_repr(def.all_fields().map(|field| {\n                         let ty = field.ty(tcx, substs);\n-                        let span = tcx.hir().span_if_local(field.did).unwrap_or(sp);\n+                        let span = match field\n+                            .did\n+                            .as_local()\n+                            .map(|id| tcx.hir().as_local_hir_id(id))\n+                            .and_then(|id| tcx.hir().find(id))\n+                        {\n+                            Some(hir::Node::Field(field)) => field.ty.span,\n+                            _ => sp,\n+                        };\n                         match is_type_structurally_recursive(\n                             tcx,\n                             span,"}, {"sha": "3457f7b4580c5ec8360a0cadd76221b36212c4b7", "filename": "src/librustc_trait_selection/traits/error_reporting/mod.rs", "status": "modified", "additions": 52, "deletions": 14, "changes": 66, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Flibrustc_trait_selection%2Ftraits%2Ferror_reporting%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Flibrustc_trait_selection%2Ftraits%2Ferror_reporting%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trait_selection%2Ftraits%2Ferror_reporting%2Fmod.rs?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -1747,24 +1747,62 @@ impl<'a, 'tcx> InferCtxtPrivExt<'tcx> for InferCtxt<'a, 'tcx> {\n pub fn recursive_type_with_infinite_size_error(\n     tcx: TyCtxt<'tcx>,\n     type_def_id: DefId,\n-) -> DiagnosticBuilder<'tcx> {\n+    spans: Vec<Span>,\n+) {\n     assert!(type_def_id.is_local());\n     let span = tcx.hir().span_if_local(type_def_id).unwrap();\n     let span = tcx.sess.source_map().guess_head_span(span);\n-    let mut err = struct_span_err!(\n-        tcx.sess,\n-        span,\n-        E0072,\n-        \"recursive type `{}` has infinite size\",\n-        tcx.def_path_str(type_def_id)\n-    );\n+    let path = tcx.def_path_str(type_def_id);\n+    let mut err =\n+        struct_span_err!(tcx.sess, span, E0072, \"recursive type `{}` has infinite size\", path);\n     err.span_label(span, \"recursive type has infinite size\");\n-    err.help(&format!(\n-        \"insert indirection (e.g., a `Box`, `Rc`, or `&`) \\\n-                           at some point to make `{}` representable\",\n-        tcx.def_path_str(type_def_id)\n-    ));\n-    err\n+    for &span in &spans {\n+        err.span_label(span, \"recursive without indirection\");\n+    }\n+    let short_msg = format!(\"insert some indirection to make `{}` representable\", path);\n+    let msg = format!(\n+        \"insert some indirection (e.g., a `Box`, `Rc`, or `&`) to make `{}` representable\",\n+        path,\n+    );\n+    match &spans[..] {\n+        [span] => {\n+            err.multipart_suggestions(\n+                &short_msg,\n+                vec![\n+                    vec![\n+                        (span.shrink_to_lo(), \"Box<\".to_string()),\n+                        (span.shrink_to_hi(), \">\".to_string()),\n+                    ],\n+                    vec![\n+                        (span.shrink_to_lo(), \"Rc<\".to_string()),\n+                        (span.shrink_to_hi(), \">\".to_string()),\n+                    ],\n+                    vec![(span.shrink_to_lo(), \"&\".to_string())],\n+                ],\n+                Applicability::HasPlaceholders,\n+            );\n+        }\n+        _ if spans.len() <= 4 => {\n+            err.multipart_suggestion(\n+                &msg,\n+                spans\n+                    .iter()\n+                    .flat_map(|&span| {\n+                        vec![\n+                            (span.shrink_to_lo(), \"Box<\".to_string()),\n+                            (span.shrink_to_hi(), \">\".to_string()),\n+                        ]\n+                        .into_iter()\n+                    })\n+                    .collect(),\n+                Applicability::HasPlaceholders,\n+            );\n+        }\n+        _ => {\n+            err.help(&msg);\n+        }\n+    }\n+    err.emit();\n }\n \n /// Summarizes information"}, {"sha": "1e8a149d7d9ec35bad99fbe645bbe23fa3c700d7", "filename": "src/librustc_typeck/check/mod.rs", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -2390,11 +2390,7 @@ fn check_representable(tcx: TyCtxt<'_>, sp: Span, item_def_id: LocalDefId) -> bo\n     // caught by case 1.\n     match rty.is_representable(tcx, sp) {\n         Representability::SelfRecursive(spans) => {\n-            let mut err = recursive_type_with_infinite_size_error(tcx, item_def_id.to_def_id());\n-            for span in spans {\n-                err.span_label(span, \"recursive without indirection\");\n-            }\n-            err.emit();\n+            recursive_type_with_infinite_size_error(tcx, item_def_id.to_def_id(), spans);\n             return false;\n         }\n         Representability::Representable | Representability::ContainsRecursive => (),"}, {"sha": "b6a4d8f4cf563bb0983897f3016c6acad1539b32", "filename": "src/test/ui/infinite/infinite-tag-type-recursion.stderr", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Finfinite%2Finfinite-tag-type-recursion.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Finfinite%2Finfinite-tag-type-recursion.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finfinite%2Finfinite-tag-type-recursion.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -6,7 +6,14 @@ LL | enum MList { Cons(isize, MList), Nil }\n    | |\n    | recursive type has infinite size\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `MList` representable\n+help: insert some indirection to make `MList` representable\n+   |\n+LL | enum MList { Cons(isize, Box<MList>), Nil }\n+   |                          ^^^^     ^\n+LL | enum MList { Cons(isize, Rc<MList>), Nil }\n+   |                          ^^^     ^\n+LL | enum MList { Cons(isize, &MList), Nil }\n+   |                          ^\n \n error[E0391]: cycle detected when computing drop-check constraints for `MList`\n   --> $DIR/infinite-tag-type-recursion.rs:1:1"}, {"sha": "8d44154650e04305feff43ba5090891e7ab5c5e3", "filename": "src/test/ui/issues/issue-17431-1.stderr", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-17431-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-17431-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-17431-1.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -2,11 +2,18 @@ error[E0072]: recursive type `Foo` has infinite size\n   --> $DIR/issue-17431-1.rs:1:1\n    |\n LL | struct Foo { foo: Option<Option<Foo>> }\n-   | ^^^^^^^^^^   ------------------------ recursive without indirection\n+   | ^^^^^^^^^^        ------------------- recursive without indirection\n    | |\n    | recursive type has infinite size\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `Foo` representable\n+help: insert some indirection to make `Foo` representable\n+   |\n+LL | struct Foo { foo: Box<Option<Option<Foo>>> }\n+   |                   ^^^^                   ^\n+LL | struct Foo { foo: Rc<Option<Option<Foo>>> }\n+   |                   ^^^                   ^\n+LL | struct Foo { foo: &Option<Option<Foo>> }\n+   |                   ^\n \n error: aborting due to previous error\n "}, {"sha": "b06184e84da28744d20c42d7f881b8a19b6635c5", "filename": "src/test/ui/issues/issue-17431-2.stderr", "status": "modified", "additions": 18, "deletions": 4, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-17431-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-17431-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-17431-2.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -2,21 +2,35 @@ error[E0072]: recursive type `Baz` has infinite size\n   --> $DIR/issue-17431-2.rs:1:1\n    |\n LL | struct Baz { q: Option<Foo> }\n-   | ^^^^^^^^^^   -------------- recursive without indirection\n+   | ^^^^^^^^^^      ----------- recursive without indirection\n    | |\n    | recursive type has infinite size\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `Baz` representable\n+help: insert some indirection to make `Baz` representable\n+   |\n+LL | struct Baz { q: Box<Option<Foo>> }\n+   |                 ^^^^           ^\n+LL | struct Baz { q: Rc<Option<Foo>> }\n+   |                 ^^^           ^\n+LL | struct Baz { q: &Option<Foo> }\n+   |                 ^\n \n error[E0072]: recursive type `Foo` has infinite size\n   --> $DIR/issue-17431-2.rs:4:1\n    |\n LL | struct Foo { q: Option<Baz> }\n-   | ^^^^^^^^^^   -------------- recursive without indirection\n+   | ^^^^^^^^^^      ----------- recursive without indirection\n    | |\n    | recursive type has infinite size\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `Foo` representable\n+help: insert some indirection to make `Foo` representable\n+   |\n+LL | struct Foo { q: Box<Option<Baz>> }\n+   |                 ^^^^           ^\n+LL | struct Foo { q: Rc<Option<Baz>> }\n+   |                 ^^^           ^\n+LL | struct Foo { q: &Option<Baz> }\n+   |                 ^\n \n error: aborting due to 2 previous errors\n "}, {"sha": "f32bd70fd6d943e01006dbc8a5c3947ebdf3ff41", "filename": "src/test/ui/issues/issue-17431-3.stderr", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-17431-3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-17431-3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-17431-3.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -2,11 +2,18 @@ error[E0072]: recursive type `Foo` has infinite size\n   --> $DIR/issue-17431-3.rs:3:1\n    |\n LL | struct Foo { foo: Mutex<Option<Foo>> }\n-   | ^^^^^^^^^^   ----------------------- recursive without indirection\n+   | ^^^^^^^^^^        ------------------ recursive without indirection\n    | |\n    | recursive type has infinite size\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `Foo` representable\n+help: insert some indirection to make `Foo` representable\n+   |\n+LL | struct Foo { foo: Box<Mutex<Option<Foo>>> }\n+   |                   ^^^^                  ^\n+LL | struct Foo { foo: Rc<Mutex<Option<Foo>>> }\n+   |                   ^^^                  ^\n+LL | struct Foo { foo: &Mutex<Option<Foo>> }\n+   |                   ^\n \n error: aborting due to previous error\n "}, {"sha": "372c5e975c844b4e37507a1d838891a8e8d4ee9f", "filename": "src/test/ui/issues/issue-17431-4.stderr", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-17431-4.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-17431-4.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-17431-4.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -2,11 +2,18 @@ error[E0072]: recursive type `Foo` has infinite size\n   --> $DIR/issue-17431-4.rs:3:1\n    |\n LL | struct Foo<T> { foo: Option<Option<Foo<T>>>, marker: marker::PhantomData<T> }\n-   | ^^^^^^^^^^^^^   --------------------------- recursive without indirection\n+   | ^^^^^^^^^^^^^        ---------------------- recursive without indirection\n    | |\n    | recursive type has infinite size\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `Foo` representable\n+help: insert some indirection to make `Foo` representable\n+   |\n+LL | struct Foo<T> { foo: Box<Option<Option<Foo<T>>>>, marker: marker::PhantomData<T> }\n+   |                      ^^^^                      ^\n+LL | struct Foo<T> { foo: Rc<Option<Option<Foo<T>>>>, marker: marker::PhantomData<T> }\n+   |                      ^^^                      ^\n+LL | struct Foo<T> { foo: &Option<Option<Foo<T>>>, marker: marker::PhantomData<T> }\n+   |                      ^\n \n error: aborting due to previous error\n "}, {"sha": "01b850ac336949fcd842d27d13f3393acfda07b1", "filename": "src/test/ui/issues/issue-17431-5.stderr", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-17431-5.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-17431-5.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-17431-5.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -2,11 +2,18 @@ error[E0072]: recursive type `Bar` has infinite size\n   --> $DIR/issue-17431-5.rs:5:1\n    |\n LL | struct Bar<T> { x: Bar<Foo> , marker: marker::PhantomData<T> }\n-   | ^^^^^^^^^^^^^   ----------- recursive without indirection\n+   | ^^^^^^^^^^^^^      -------- recursive without indirection\n    | |\n    | recursive type has infinite size\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `Bar` representable\n+help: insert some indirection to make `Bar` representable\n+   |\n+LL | struct Bar<T> { x: Box<Bar<Foo>> , marker: marker::PhantomData<T> }\n+   |                    ^^^^        ^\n+LL | struct Bar<T> { x: Rc<Bar<Foo>> , marker: marker::PhantomData<T> }\n+   |                    ^^^        ^\n+LL | struct Bar<T> { x: &Bar<Foo> , marker: marker::PhantomData<T> }\n+   |                    ^\n \n error: aborting due to previous error\n "}, {"sha": "ce6c2db07fb6d641fec4b795328a44cb22d368c3", "filename": "src/test/ui/issues/issue-17431-6.stderr", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-17431-6.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-17431-6.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-17431-6.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -6,7 +6,14 @@ LL | enum Foo { X(Mutex<Option<Foo>>) }\n    | |\n    | recursive type has infinite size\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `Foo` representable\n+help: insert some indirection to make `Foo` representable\n+   |\n+LL | enum Foo { X(Box<Mutex<Option<Foo>>>) }\n+   |              ^^^^                  ^\n+LL | enum Foo { X(Rc<Mutex<Option<Foo>>>) }\n+   |              ^^^                  ^\n+LL | enum Foo { X(&Mutex<Option<Foo>>) }\n+   |              ^\n \n error: aborting due to previous error\n "}, {"sha": "4fb563ba502f2294af61399b5c2dbd605fbaf55e", "filename": "src/test/ui/issues/issue-17431-7.stderr", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-17431-7.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-17431-7.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-17431-7.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -6,7 +6,14 @@ LL | enum Foo { Voo(Option<Option<Foo>>) }\n    | |\n    | recursive type has infinite size\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `Foo` representable\n+help: insert some indirection to make `Foo` representable\n+   |\n+LL | enum Foo { Voo(Box<Option<Option<Foo>>>) }\n+   |                ^^^^                   ^\n+LL | enum Foo { Voo(Rc<Option<Option<Foo>>>) }\n+   |                ^^^                   ^\n+LL | enum Foo { Voo(&Option<Option<Foo>>) }\n+   |                ^\n \n error: aborting due to previous error\n "}, {"sha": "48b7a61e059ea26565d4a21a4d0bd0afe4c137e4", "filename": "src/test/ui/issues/issue-2718-a.stderr", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-2718-a.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-2718-a.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-2718-a.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -7,7 +7,14 @@ LL |     pub struct Pong(SendPacket<Ping>);\n    |     |               recursive without indirection\n    |     recursive type has infinite size\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `pingpong::Pong` representable\n+help: insert some indirection to make `pingpong::Pong` representable\n+   |\n+LL |     pub struct Pong(Box<SendPacket<Ping>>);\n+   |                     ^^^^                ^\n+LL |     pub struct Pong(Rc<SendPacket<Ping>>);\n+   |                     ^^^                ^\n+LL |     pub struct Pong(&SendPacket<Ping>);\n+   |                     ^\n \n error: aborting due to previous error\n "}, {"sha": "d1173a4b3334c23e37ae0b4dce27af603fc88ec8", "filename": "src/test/ui/issues/issue-3008-1.stderr", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-3008-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-3008-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-3008-1.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -7,7 +7,14 @@ LL | enum Bar {\n LL |     BarSome(Bar)\n    |             --- recursive without indirection\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `Bar` representable\n+help: insert some indirection to make `Bar` representable\n+   |\n+LL |     BarSome(Box<Bar>)\n+   |             ^^^^   ^\n+LL |     BarSome(Rc<Bar>)\n+   |             ^^^   ^\n+LL |     BarSome(&Bar)\n+   |             ^\n \n error: aborting due to previous error\n "}, {"sha": "4fd60639b21a8f7116ee1aeb8bdcfab2f666a4e2", "filename": "src/test/ui/issues/issue-3008-2.stderr", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-3008-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-3008-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-3008-2.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -2,11 +2,18 @@ error[E0072]: recursive type `Bar` has infinite size\n   --> $DIR/issue-3008-2.rs:2:1\n    |\n LL | struct Bar { x: Bar }\n-   | ^^^^^^^^^^   ------ recursive without indirection\n+   | ^^^^^^^^^^      --- recursive without indirection\n    | |\n    | recursive type has infinite size\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `Bar` representable\n+help: insert some indirection to make `Bar` representable\n+   |\n+LL | struct Bar { x: Box<Bar> }\n+   |                 ^^^^   ^\n+LL | struct Bar { x: Rc<Bar> }\n+   |                 ^^^   ^\n+LL | struct Bar { x: &Bar }\n+   |                 ^\n \n error: aborting due to previous error\n "}, {"sha": "e6efad918830005cc1a9aadfefc78bfdf2114fab", "filename": "src/test/ui/issues/issue-3008-3.stderr", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-3008-3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-3008-3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-3008-3.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -6,7 +6,14 @@ LL | enum E2<T> { V2(E2<E1>, marker::PhantomData<T>), }\n    | |\n    | recursive type has infinite size\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `E2` representable\n+help: insert some indirection to make `E2` representable\n+   |\n+LL | enum E2<T> { V2(Box<E2<E1>>, marker::PhantomData<T>), }\n+   |                 ^^^^      ^\n+LL | enum E2<T> { V2(Rc<E2<E1>>, marker::PhantomData<T>), }\n+   |                 ^^^      ^\n+LL | enum E2<T> { V2(&E2<E1>, marker::PhantomData<T>), }\n+   |                 ^\n \n error: aborting due to previous error\n "}, {"sha": "0f3d3690b732ea1bf1d3660b2bd441f02caae636", "filename": "src/test/ui/issues/issue-32326.stderr", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-32326.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-32326.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-32326.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -8,7 +8,10 @@ LL |     Plus(Expr, Expr),\n    |          |\n    |          recursive without indirection\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `Expr` representable\n+help: insert some indirection (e.g., a `Box`, `Rc`, or `&`) to make `Expr` representable\n+   |\n+LL |     Plus(Box<Expr>, Box<Expr>),\n+   |          ^^^^    ^  ^^^^    ^\n \n error: aborting due to previous error\n "}, {"sha": "9b50ddec12a44aa093939714b8f9d474e5e35af0", "filename": "src/test/ui/issues/issue-3779.stderr", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-3779.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-3779.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-3779.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -5,9 +5,16 @@ LL | struct S {\n    | ^^^^^^^^ recursive type has infinite size\n LL |\n LL |     element: Option<S>\n-   |     ------------------ recursive without indirection\n+   |              --------- recursive without indirection\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `S` representable\n+help: insert some indirection to make `S` representable\n+   |\n+LL |     element: Box<Option<S>>\n+   |              ^^^^         ^\n+LL |     element: Rc<Option<S>>\n+   |              ^^^         ^\n+LL |     element: &Option<S>\n+   |              ^\n \n error: aborting due to previous error\n "}, {"sha": "a6fe83a9b563632af9c490dffa1ad7454a143a02", "filename": "src/test/ui/issues/issue-57271.stderr", "status": "modified", "additions": 16, "deletions": 2, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-57271.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fissues%2Fissue-57271.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-57271.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -7,7 +7,14 @@ LL |     Class(ClassTypeSignature),\n LL |     Array(TypeSignature),\n    |           ------------- recursive without indirection\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `ObjectType` representable\n+help: insert some indirection to make `ObjectType` representable\n+   |\n+LL |     Array(Box<TypeSignature>),\n+   |           ^^^^             ^\n+LL |     Array(Rc<TypeSignature>),\n+   |           ^^^             ^\n+LL |     Array(&TypeSignature),\n+   |           ^\n \n error[E0072]: recursive type `TypeSignature` has infinite size\n   --> $DIR/issue-57271.rs:19:1\n@@ -18,7 +25,14 @@ LL |     Base(BaseType),\n LL |     Object(ObjectType),\n    |            ---------- recursive without indirection\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `TypeSignature` representable\n+help: insert some indirection to make `TypeSignature` representable\n+   |\n+LL |     Object(Box<ObjectType>),\n+   |            ^^^^          ^\n+LL |     Object(Rc<ObjectType>),\n+   |            ^^^          ^\n+LL |     Object(&ObjectType),\n+   |            ^\n \n error: aborting due to 2 previous errors\n "}, {"sha": "c68badd458bce7431ae8d38043729c6ef4c46e3c", "filename": "src/test/ui/recursion/recursive-enum.stderr", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Frecursion%2Frecursive-enum.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Frecursion%2Frecursive-enum.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frecursion%2Frecursive-enum.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -6,7 +6,14 @@ LL | enum List<T> { Cons(T, List<T>), Nil }\n    | |\n    | recursive type has infinite size\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `List` representable\n+help: insert some indirection to make `List` representable\n+   |\n+LL | enum List<T> { Cons(T, Box<List<T>>), Nil }\n+   |                        ^^^^       ^\n+LL | enum List<T> { Cons(T, Rc<List<T>>), Nil }\n+   |                        ^^^       ^\n+LL | enum List<T> { Cons(T, &List<T>), Nil }\n+   |                        ^\n \n error: aborting due to previous error\n "}, {"sha": "99d8cfd0a05c93344c337d5cb57da671a76cc74b", "filename": "src/test/ui/sized-cycle-note.stderr", "status": "modified", "additions": 18, "deletions": 4, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fsized-cycle-note.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fsized-cycle-note.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsized-cycle-note.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -2,21 +2,35 @@ error[E0072]: recursive type `Baz` has infinite size\n   --> $DIR/sized-cycle-note.rs:9:1\n    |\n LL | struct Baz { q: Option<Foo> }\n-   | ^^^^^^^^^^   -------------- recursive without indirection\n+   | ^^^^^^^^^^      ----------- recursive without indirection\n    | |\n    | recursive type has infinite size\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `Baz` representable\n+help: insert some indirection to make `Baz` representable\n+   |\n+LL | struct Baz { q: Box<Option<Foo>> }\n+   |                 ^^^^           ^\n+LL | struct Baz { q: Rc<Option<Foo>> }\n+   |                 ^^^           ^\n+LL | struct Baz { q: &Option<Foo> }\n+   |                 ^\n \n error[E0072]: recursive type `Foo` has infinite size\n   --> $DIR/sized-cycle-note.rs:11:1\n    |\n LL | struct Foo { q: Option<Baz> }\n-   | ^^^^^^^^^^   -------------- recursive without indirection\n+   | ^^^^^^^^^^      ----------- recursive without indirection\n    | |\n    | recursive type has infinite size\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `Foo` representable\n+help: insert some indirection to make `Foo` representable\n+   |\n+LL | struct Foo { q: Box<Option<Baz>> }\n+   |                 ^^^^           ^\n+LL | struct Foo { q: Rc<Option<Baz>> }\n+   |                 ^^^           ^\n+LL | struct Foo { q: &Option<Baz> }\n+   |                 ^\n \n error: aborting due to 2 previous errors\n "}, {"sha": "855e4facb7b8cb93127561dc2675ac5bb893344a", "filename": "src/test/ui/span/E0072.stderr", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fspan%2FE0072.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fspan%2FE0072.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspan%2FE0072.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -5,9 +5,16 @@ LL | struct ListNode {\n    | ^^^^^^^^^^^^^^^ recursive type has infinite size\n LL |     head: u8,\n LL |     tail: Option<ListNode>,\n-   |     ---------------------- recursive without indirection\n+   |           ---------------- recursive without indirection\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `ListNode` representable\n+help: insert some indirection to make `ListNode` representable\n+   |\n+LL |     tail: Box<Option<ListNode>>,\n+   |           ^^^^                ^\n+LL |     tail: Rc<Option<ListNode>>,\n+   |           ^^^                ^\n+LL |     tail: &Option<ListNode>,\n+   |           ^\n \n error: aborting due to previous error\n "}, {"sha": "260c2157e96b75a90cb311fec48d1f63b04d84ed", "filename": "src/test/ui/span/multiline-span-E0072.stderr", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fspan%2Fmultiline-span-E0072.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fspan%2Fmultiline-span-E0072.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspan%2Fmultiline-span-E0072.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -6,11 +6,18 @@ LL | | ListNode\n LL | | {\n LL | |     head: u8,\n LL | |     tail: Option<ListNode>,\n-   | |     ---------------------- recursive without indirection\n+   | |           ---------------- recursive without indirection\n LL | | }\n    | |_^ recursive type has infinite size\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `ListNode` representable\n+help: insert some indirection to make `ListNode` representable\n+   |\n+LL |     tail: Box<Option<ListNode>>,\n+   |           ^^^^                ^\n+LL |     tail: Rc<Option<ListNode>>,\n+   |           ^^^                ^\n+LL |     tail: &Option<ListNode>,\n+   |           ^\n \n error: aborting due to previous error\n "}, {"sha": "c1a3270d0a567584222440a14668b0c58116a20f", "filename": "src/test/ui/span/recursive-type-field.stderr", "status": "modified", "additions": 15, "deletions": 8, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fspan%2Frecursive-type-field.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Fspan%2Frecursive-type-field.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspan%2Frecursive-type-field.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -4,28 +4,35 @@ error[E0072]: recursive type `Foo` has infinite size\n LL | struct Foo<'a> {\n    | ^^^^^^^^^^^^^^ recursive type has infinite size\n LL |     bar: Bar<'a>,\n-   |     ------------ recursive without indirection\n+   |          ------- recursive without indirection\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `Foo` representable\n+help: insert some indirection to make `Foo` representable\n+   |\n+LL |     bar: Box<Bar<'a>>,\n+   |          ^^^^       ^\n+LL |     bar: Rc<Bar<'a>>,\n+   |          ^^^       ^\n+LL |     bar: &Bar<'a>,\n+   |          ^\n \n error[E0072]: recursive type `Bar` has infinite size\n   --> $DIR/recursive-type-field.rs:8:1\n    |\n LL | struct Bar<'a> {\n    | ^^^^^^^^^^^^^^ recursive type has infinite size\n LL |     y: (Foo<'a>, Foo<'a>),\n-   |     --------------------- recursive without indirection\n+   |        ------------------ recursive without indirection\n LL |     z: Option<Bar<'a>>,\n-   |     ------------------ recursive without indirection\n+   |        --------------- recursive without indirection\n ...\n LL |     d: [Bar<'a>; 1],\n-   |     --------------- recursive without indirection\n+   |        ------------ recursive without indirection\n LL |     e: Foo<'a>,\n-   |     ---------- recursive without indirection\n+   |        ------- recursive without indirection\n LL |     x: Bar<'a>,\n-   |     ---------- recursive without indirection\n+   |        ------- recursive without indirection\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `Bar` representable\n+   = help: insert some indirection (e.g., a `Box`, `Rc`, or `&`) to make `Bar` representable\n \n error: aborting due to 2 previous errors\n "}, {"sha": "b98a6eac49e044ac6ac5066d4c9eb3e2070ce823", "filename": "src/test/ui/type/type-recursive.stderr", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Ftype%2Ftype-recursive.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Ftype%2Ftype-recursive.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftype%2Ftype-recursive.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -5,9 +5,16 @@ LL | struct T1 {\n    | ^^^^^^^^^ recursive type has infinite size\n LL |     foo: isize,\n LL |     foolish: T1\n-   |     ----------- recursive without indirection\n+   |              -- recursive without indirection\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `T1` representable\n+help: insert some indirection to make `T1` representable\n+   |\n+LL |     foolish: Box<T1>\n+   |              ^^^^  ^\n+LL |     foolish: Rc<T1>\n+   |              ^^^  ^\n+LL |     foolish: &T1\n+   |              ^\n \n error: aborting due to previous error\n "}, {"sha": "70863a549ad25a1b555894e7b65f57419b0bb897", "filename": "src/test/ui/union/union-nonrepresentable.stderr", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Funion%2Funion-nonrepresentable.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c29b3fa1484c625bd34cb4d94fc76f36c6233447/src%2Ftest%2Fui%2Funion%2Funion-nonrepresentable.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Funion%2Funion-nonrepresentable.stderr?ref=c29b3fa1484c625bd34cb4d94fc76f36c6233447", "patch": "@@ -5,9 +5,16 @@ LL | union U {\n    | ^^^^^^^ recursive type has infinite size\n LL |     a: u8,\n LL |     b: U,\n-   |     ---- recursive without indirection\n+   |        - recursive without indirection\n    |\n-   = help: insert indirection (e.g., a `Box`, `Rc`, or `&`) at some point to make `U` representable\n+help: insert some indirection to make `U` representable\n+   |\n+LL |     b: Box<U>,\n+   |        ^^^^ ^\n+LL |     b: Rc<U>,\n+   |        ^^^ ^\n+LL |     b: &U,\n+   |        ^\n \n error: aborting due to previous error\n "}]}