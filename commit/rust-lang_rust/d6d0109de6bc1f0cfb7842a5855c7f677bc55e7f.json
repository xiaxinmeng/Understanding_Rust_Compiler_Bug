{"sha": "d6d0109de6bc1f0cfb7842a5855c7f677bc55e7f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ2ZDAxMDlkZTZiYzFmMGNmYjc4NDJhNTg1NWM3ZjY3N2JjNTVlN2Y=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-03-03T08:06:15Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-03-03T08:06:15Z"}, "message": "Auto merge of #1732 - RalfJung:atomic_op, r=RalfJung\n\nrename atomic_op_min_max -> atomic_op\n\nThe corresponding enum is called `AtomicOp` so IMO this also makes more sense as the name for the function.", "tree": {"sha": "866e0c63fe7a4d515759e06ee1b97b060ef5fa24", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/866e0c63fe7a4d515759e06ee1b97b060ef5fa24"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d6d0109de6bc1f0cfb7842a5855c7f677bc55e7f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d6d0109de6bc1f0cfb7842a5855c7f677bc55e7f", "html_url": "https://github.com/rust-lang/rust/commit/d6d0109de6bc1f0cfb7842a5855c7f677bc55e7f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d6d0109de6bc1f0cfb7842a5855c7f677bc55e7f/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2670839e1af540a496a0d889fce9ad42529ecc11", "url": "https://api.github.com/repos/rust-lang/rust/commits/2670839e1af540a496a0d889fce9ad42529ecc11", "html_url": "https://github.com/rust-lang/rust/commit/2670839e1af540a496a0d889fce9ad42529ecc11"}, {"sha": "9f3dbad5d073f764a28e9c3c1397b4b39d6a3fc2", "url": "https://api.github.com/repos/rust-lang/rust/commits/9f3dbad5d073f764a28e9c3c1397b4b39d6a3fc2", "html_url": "https://github.com/rust-lang/rust/commit/9f3dbad5d073f764a28e9c3c1397b4b39d6a3fc2"}], "stats": {"total": 102, "additions": 51, "deletions": 51}, "files": [{"sha": "d7e025f023843d97777c6ecd13cba56d453b1783", "filename": "src/shims/intrinsics.rs", "status": "modified", "additions": 51, "deletions": 51, "changes": 102, "blob_url": "https://github.com/rust-lang/rust/blob/d6d0109de6bc1f0cfb7842a5855c7f677bc55e7f/src%2Fshims%2Fintrinsics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6d0109de6bc1f0cfb7842a5855c7f677bc55e7f/src%2Fshims%2Fintrinsics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fshims%2Fintrinsics.rs?ref=d6d0109de6bc1f0cfb7842a5855c7f677bc55e7f", "patch": "@@ -394,226 +394,226 @@ pub trait EvalContextExt<'mir, 'tcx: 'mir>: crate::MiriEvalContextExt<'mir, 'tcx\n                 AtomicReadOp::Acquire,\n             )?,\n \n-            \"atomic_or\" => this.atomic_op_min_max(\n+            \"atomic_or\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitOr, false),\n                 AtomicRwOp::SeqCst,\n             )?,\n-            \"atomic_or_acq\" => this.atomic_op_min_max(\n+            \"atomic_or_acq\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitOr, false),\n                 AtomicRwOp::Acquire,\n             )?,\n-            \"atomic_or_rel\" => this.atomic_op_min_max(\n+            \"atomic_or_rel\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitOr, false),\n                 AtomicRwOp::Release,\n             )?,\n-            \"atomic_or_acqrel\" => this.atomic_op_min_max(\n+            \"atomic_or_acqrel\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitOr, false),\n                 AtomicRwOp::AcqRel,\n             )?,\n-            \"atomic_or_relaxed\" => this.atomic_op_min_max(\n+            \"atomic_or_relaxed\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitOr, false),\n                 AtomicRwOp::Relaxed,\n             )?,\n-            \"atomic_xor\" => this.atomic_op_min_max(\n+            \"atomic_xor\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitXor, false),\n                 AtomicRwOp::SeqCst,\n             )?,\n-            \"atomic_xor_acq\" => this.atomic_op_min_max(\n+            \"atomic_xor_acq\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitXor, false),\n                 AtomicRwOp::Acquire,\n             )?,\n-            \"atomic_xor_rel\" => this.atomic_op_min_max(\n+            \"atomic_xor_rel\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitXor, false),\n                 AtomicRwOp::Release,\n             )?,\n-            \"atomic_xor_acqrel\" => this.atomic_op_min_max(\n+            \"atomic_xor_acqrel\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitXor, false),\n                 AtomicRwOp::AcqRel,\n             )?,\n-            \"atomic_xor_relaxed\" => this.atomic_op_min_max(\n+            \"atomic_xor_relaxed\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitXor, false),\n                 AtomicRwOp::Relaxed,\n             )?,\n-            \"atomic_and\" => this.atomic_op_min_max(\n+            \"atomic_and\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitAnd, false),\n                 AtomicRwOp::SeqCst,\n             )?,\n-            \"atomic_and_acq\" => this.atomic_op_min_max(\n+            \"atomic_and_acq\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitAnd, false),\n                 AtomicRwOp::Acquire,\n             )?,\n-            \"atomic_and_rel\" => this.atomic_op_min_max(\n+            \"atomic_and_rel\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitAnd, false),\n                 AtomicRwOp::Release,\n             )?,\n-            \"atomic_and_acqrel\" => this.atomic_op_min_max(\n+            \"atomic_and_acqrel\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitAnd, false),\n                 AtomicRwOp::AcqRel,\n             )?,\n-            \"atomic_and_relaxed\" => this.atomic_op_min_max(\n+            \"atomic_and_relaxed\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitAnd, false),\n                 AtomicRwOp::Relaxed,\n             )?,\n-            \"atomic_nand\" => this.atomic_op_min_max(\n+            \"atomic_nand\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitAnd, true),\n                 AtomicRwOp::SeqCst,\n             )?,\n-            \"atomic_nand_acq\" => this.atomic_op_min_max(\n+            \"atomic_nand_acq\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitAnd, true),\n                 AtomicRwOp::Acquire,\n             )?,\n-            \"atomic_nand_rel\" => this.atomic_op_min_max(\n+            \"atomic_nand_rel\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitAnd, true),\n                 AtomicRwOp::Release,\n             )?,\n-            \"atomic_nand_acqrel\" => this.atomic_op_min_max(\n+            \"atomic_nand_acqrel\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitAnd, true),\n                 AtomicRwOp::AcqRel,\n             )?,\n-            \"atomic_nand_relaxed\" => this.atomic_op_min_max(\n+            \"atomic_nand_relaxed\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::BitAnd, true),\n                 AtomicRwOp::Relaxed,\n             )?,\n-            \"atomic_xadd\" => this.atomic_op_min_max(\n+            \"atomic_xadd\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::Add, false),\n                 AtomicRwOp::SeqCst,\n             )?,\n-            \"atomic_xadd_acq\" => this.atomic_op_min_max(\n+            \"atomic_xadd_acq\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::Add, false),\n                 AtomicRwOp::Acquire,\n             )?,\n-            \"atomic_xadd_rel\" => this.atomic_op_min_max(\n+            \"atomic_xadd_rel\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::Add, false),\n                 AtomicRwOp::Release,\n             )?,\n-            \"atomic_xadd_acqrel\" => this.atomic_op_min_max(\n+            \"atomic_xadd_acqrel\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::Add, false),\n                 AtomicRwOp::AcqRel,\n             )?,\n-            \"atomic_xadd_relaxed\" => this.atomic_op_min_max(\n+            \"atomic_xadd_relaxed\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::Add, false),\n                 AtomicRwOp::Relaxed,\n             )?,\n-            \"atomic_xsub\" => this.atomic_op_min_max(\n+            \"atomic_xsub\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::Sub, false),\n                 AtomicRwOp::SeqCst,\n             )?,\n-            \"atomic_xsub_acq\" => this.atomic_op_min_max(\n+            \"atomic_xsub_acq\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::Sub, false),\n                 AtomicRwOp::Acquire,\n             )?,\n-            \"atomic_xsub_rel\" => this.atomic_op_min_max(\n+            \"atomic_xsub_rel\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::Sub, false),\n                 AtomicRwOp::Release,\n             )?,\n-            \"atomic_xsub_acqrel\" => this.atomic_op_min_max(\n+            \"atomic_xsub_acqrel\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::Sub, false),\n                 AtomicRwOp::AcqRel,\n             )?,\n-            \"atomic_xsub_relaxed\" => this.atomic_op_min_max(\n+            \"atomic_xsub_relaxed\" => this.atomic_op(\n                 args,\n                 dest,\n                 AtomicOp::MirOp(BinOp::Sub, false),\n                 AtomicRwOp::Relaxed,\n             )?,\n             \"atomic_min\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Min, AtomicRwOp::SeqCst)?,\n+                this.atomic_op(args, dest, AtomicOp::Min, AtomicRwOp::SeqCst)?,\n             \"atomic_min_acq\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Min, AtomicRwOp::Acquire)?,\n+                this.atomic_op(args, dest, AtomicOp::Min, AtomicRwOp::Acquire)?,\n             \"atomic_min_rel\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Min, AtomicRwOp::Release)?,\n+                this.atomic_op(args, dest, AtomicOp::Min, AtomicRwOp::Release)?,\n             \"atomic_min_acqrel\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Min, AtomicRwOp::AcqRel)?,\n+                this.atomic_op(args, dest, AtomicOp::Min, AtomicRwOp::AcqRel)?,\n             \"atomic_min_relaxed\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Min, AtomicRwOp::Relaxed)?,\n+                this.atomic_op(args, dest, AtomicOp::Min, AtomicRwOp::Relaxed)?,\n             \"atomic_max\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Max, AtomicRwOp::SeqCst)?,\n+                this.atomic_op(args, dest, AtomicOp::Max, AtomicRwOp::SeqCst)?,\n             \"atomic_max_acq\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Max, AtomicRwOp::Acquire)?,\n+                this.atomic_op(args, dest, AtomicOp::Max, AtomicRwOp::Acquire)?,\n             \"atomic_max_rel\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Max, AtomicRwOp::Release)?,\n+                this.atomic_op(args, dest, AtomicOp::Max, AtomicRwOp::Release)?,\n             \"atomic_max_acqrel\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Max, AtomicRwOp::AcqRel)?,\n+                this.atomic_op(args, dest, AtomicOp::Max, AtomicRwOp::AcqRel)?,\n             \"atomic_max_relaxed\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Max, AtomicRwOp::Relaxed)?,\n+                this.atomic_op(args, dest, AtomicOp::Max, AtomicRwOp::Relaxed)?,\n             \"atomic_umin\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Min, AtomicRwOp::SeqCst)?,\n+                this.atomic_op(args, dest, AtomicOp::Min, AtomicRwOp::SeqCst)?,\n             \"atomic_umin_acq\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Min, AtomicRwOp::Acquire)?,\n+                this.atomic_op(args, dest, AtomicOp::Min, AtomicRwOp::Acquire)?,\n             \"atomic_umin_rel\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Min, AtomicRwOp::Release)?,\n+                this.atomic_op(args, dest, AtomicOp::Min, AtomicRwOp::Release)?,\n             \"atomic_umin_acqrel\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Min, AtomicRwOp::AcqRel)?,\n+                this.atomic_op(args, dest, AtomicOp::Min, AtomicRwOp::AcqRel)?,\n             \"atomic_umin_relaxed\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Min, AtomicRwOp::Relaxed)?,\n+                this.atomic_op(args, dest, AtomicOp::Min, AtomicRwOp::Relaxed)?,\n             \"atomic_umax\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Max, AtomicRwOp::SeqCst)?,\n+                this.atomic_op(args, dest, AtomicOp::Max, AtomicRwOp::SeqCst)?,\n             \"atomic_umax_acq\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Max, AtomicRwOp::Acquire)?,\n+                this.atomic_op(args, dest, AtomicOp::Max, AtomicRwOp::Acquire)?,\n             \"atomic_umax_rel\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Max, AtomicRwOp::Release)?,\n+                this.atomic_op(args, dest, AtomicOp::Max, AtomicRwOp::Release)?,\n             \"atomic_umax_acqrel\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Max, AtomicRwOp::AcqRel)?,\n+                this.atomic_op(args, dest, AtomicOp::Max, AtomicRwOp::AcqRel)?,\n             \"atomic_umax_relaxed\" =>\n-                this.atomic_op_min_max(args, dest, AtomicOp::Max, AtomicRwOp::Relaxed)?,\n+                this.atomic_op(args, dest, AtomicOp::Max, AtomicRwOp::Relaxed)?,\n \n             // Query type information\n             \"assert_zero_valid\" | \"assert_uninit_valid\" => {\n@@ -729,7 +729,7 @@ pub trait EvalContextExt<'mir, 'tcx: 'mir>: crate::MiriEvalContextExt<'mir, 'tcx\n         Ok(())\n     }\n \n-    fn atomic_op_min_max(\n+    fn atomic_op(\n         &mut self,\n         args: &[OpTy<'tcx, Tag>],\n         dest: &PlaceTy<'tcx, Tag>,"}]}