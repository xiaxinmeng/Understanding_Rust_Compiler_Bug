{"sha": "36131f5be403e3f89c45627498bea535d94cb619", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM2MTMxZjViZTQwM2UzZjg5YzQ1NjI3NDk4YmVhNTM1ZDk0Y2I2MTk=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-08-23T22:35:56Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-08-23T22:35:56Z"}, "message": "auto merge of #16691 : klutzy/rust/issue-15297, r=alexcrichton\n\nFirst commit fixes issue regarding recognizing MSYS2 build.\r\nSecond commit fixes issue regarding MSYS/Windows paths.", "tree": {"sha": "b844e3c9f3506880eee34ea0b5e54b6f69315f68", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b844e3c9f3506880eee34ea0b5e54b6f69315f68"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/36131f5be403e3f89c45627498bea535d94cb619", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/36131f5be403e3f89c45627498bea535d94cb619", "html_url": "https://github.com/rust-lang/rust/commit/36131f5be403e3f89c45627498bea535d94cb619", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/36131f5be403e3f89c45627498bea535d94cb619/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1153ad3239dc1d5f08f2325ded25f5bb95872cb5", "url": "https://api.github.com/repos/rust-lang/rust/commits/1153ad3239dc1d5f08f2325ded25f5bb95872cb5", "html_url": "https://github.com/rust-lang/rust/commit/1153ad3239dc1d5f08f2325ded25f5bb95872cb5"}, {"sha": "7eb35bc2a9dcc0a7cd91fb247d156eb87df25b27", "url": "https://api.github.com/repos/rust-lang/rust/commits/7eb35bc2a9dcc0a7cd91fb247d156eb87df25b27", "html_url": "https://github.com/rust-lang/rust/commit/7eb35bc2a9dcc0a7cd91fb247d156eb87df25b27"}], "stats": {"total": 27, "additions": 17, "deletions": 10}, "files": [{"sha": "e919f3329fe2a4725976b4147cd4790455dec204", "filename": "README.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/36131f5be403e3f89c45627498bea535d94cb619/README.md", "raw_url": "https://github.com/rust-lang/rust/raw/36131f5be403e3f89c45627498bea535d94cb619/README.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/README.md?ref=36131f5be403e3f89c45627498bea535d94cb619", "patch": "@@ -71,7 +71,7 @@ To easily build on windows we can use [MSYS2](http://sourceforge.net/projects/ms\n 3. With that now start `mingw32_shell.bat` from where you installed MSYS2 (i.e. `C:\\msys`).\n 4. From there just navigate to where you have Rust's source code, configure and build it:\n \n-        $ ./configure --build=i686-pc-mingw32\n+        $ ./configure\n         $ make && make install\n \n [repo]: https://github.com/rust-lang/rust"}, {"sha": "5a2f9b5f20c763d01cffad1a880ef4251764a470", "filename": "configure", "status": "modified", "additions": 12, "deletions": 6, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/36131f5be403e3f89c45627498bea535d94cb619/configure", "raw_url": "https://github.com/rust-lang/rust/raw/36131f5be403e3f89c45627498bea535d94cb619/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=36131f5be403e3f89c45627498bea535d94cb619", "patch": "@@ -299,13 +299,19 @@ case $CFG_OSTYPE in\n         CFG_OSTYPE=apple-darwin\n         ;;\n \n-    MINGW32*)\n+    MINGW*)\n+        # msys' `uname` does not print gcc configuration, but prints msys\n+        # configuration. so we cannot believe `uname -m`:\n+        # msys1 is always i686 and msys2 is always x86_64.\n+        # instead, msys defines $MSYSTEM which is MINGW32 on i686 and\n+        # MINGW64 on x86_64.\n+        CFG_CPUTYPE=i686\n         CFG_OSTYPE=pc-mingw32\n-        ;;\n-\n-    MINGW64*)\n-        # msys2, MSYSTEM=MINGW64\n-        CFG_OSTYPE=w64-mingw32\n+        if [ \"$MSYSTEM\" = MINGW64 ]\n+        then\n+            CFG_CPUTYPE=x86_64\n+            CFG_OSTYPE=w64-mingw32\n+        fi\n         ;;\n \n # Thad's Cygwin identifers below"}, {"sha": "b46a3b036005c1776bf5bf1fe854899d2db30a84", "filename": "src/etc/maketest.py", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/36131f5be403e3f89c45627498bea535d94cb619/src%2Fetc%2Fmaketest.py", "raw_url": "https://github.com/rust-lang/rust/raw/36131f5be403e3f89c45627498bea535d94cb619/src%2Fetc%2Fmaketest.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fmaketest.py?ref=36131f5be403e3f89c45627498bea535d94cb619", "patch": "@@ -15,13 +15,14 @@\n # msys1/msys2 automatically converts `/abs/path1:/abs/path2` into\n # `c:\\real\\abs\\path1;c:\\real\\abs\\path2` (semicolons) if shell thinks\n # the value is list of paths.\n+# (if there is only one path, it becomes `c:/real/abs/path`.)\n # this causes great confusion and error: shell and Makefile doesn't like\n # windows paths so it is really error-prone. revert it for peace.\n def normalize_path(v):\n-    # c:\\path -> /c/path\n-    if ':\\\\' in v:\n-        v = '/' + v.replace(':\\\\', '/')\n     v = v.replace('\\\\', '/')\n+    # c:/path -> /c/path\n+    if ':/' in v:\n+        v = '/' + v.replace(':/', '/')\n     return v\n \n "}]}