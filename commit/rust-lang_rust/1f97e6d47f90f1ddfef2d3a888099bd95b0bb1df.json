{"sha": "1f97e6d47f90f1ddfef2d3a888099bd95b0bb1df", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFmOTdlNmQ0N2Y5MGYxZGRmZWYyZDNhODg4MDk5YmQ5NWIwYmIxZGY=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2013-04-20T07:24:44Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2013-04-20T07:24:44Z"}, "message": "rt: Add rust_dbg_next_port for generating test port numbers", "tree": {"sha": "a3a688af2e971fd91993e00403d9ba01b4866d43", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a3a688af2e971fd91993e00403d9ba01b4866d43"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1f97e6d47f90f1ddfef2d3a888099bd95b0bb1df", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1f97e6d47f90f1ddfef2d3a888099bd95b0bb1df", "html_url": "https://github.com/rust-lang/rust/commit/1f97e6d47f90f1ddfef2d3a888099bd95b0bb1df", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1f97e6d47f90f1ddfef2d3a888099bd95b0bb1df/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6a5c4f68c2f8c10bf439a39373f5c518ed2f58a1", "url": "https://api.github.com/repos/rust-lang/rust/commits/6a5c4f68c2f8c10bf439a39373f5c518ed2f58a1", "html_url": "https://github.com/rust-lang/rust/commit/6a5c4f68c2f8c10bf439a39373f5c518ed2f58a1"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "7938d65acd21dd68cd4eb0151fc13df5619a59d3", "filename": "src/rt/rust_test_helpers.cpp", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/1f97e6d47f90f1ddfef2d3a888099bd95b0bb1df/src%2Frt%2Frust_test_helpers.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/1f97e6d47f90f1ddfef2d3a888099bd95b0bb1df/src%2Frt%2Frust_test_helpers.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_test_helpers.cpp?ref=1f97e6d47f90f1ddfef2d3a888099bd95b0bb1df", "patch": "@@ -165,3 +165,14 @@ extern \"C\" CDECL TwoDoubles\n rust_dbg_extern_identity_TwoDoubles(TwoDoubles u) {\n     return u;\n }\n+\n+// Generates increasing port numbers for network testing\n+extern \"C\" CDECL uintptr_t\n+rust_dbg_next_port() {\n+  static lock_and_signal dbg_port_lock;\n+  static uintptr_t next_port = 9000;\n+  scoped_lock with(dbg_port_lock);\n+  uintptr_t this_port = next_port;\n+  next_port += 1;\n+  return this_port;\n+}"}, {"sha": "f84a73a394b6c6694336cdf5b5487b4da2c2d74b", "filename": "src/rt/rustrt.def.in", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1f97e6d47f90f1ddfef2d3a888099bd95b0bb1df/src%2Frt%2Frustrt.def.in", "raw_url": "https://github.com/rust-lang/rust/raw/1f97e6d47f90f1ddfef2d3a888099bd95b0bb1df/src%2Frt%2Frustrt.def.in", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frustrt.def.in?ref=1f97e6d47f90f1ddfef2d3a888099bd95b0bb1df", "patch": "@@ -221,4 +221,4 @@ rust_uv_free_ip4_addr\n rust_uv_free_ip6_addr\n rust_call_nullary_fn\n rust_initialize_global_state\n-\n+rust_dbg_next_port"}]}