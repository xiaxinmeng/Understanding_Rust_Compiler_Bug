{"sha": "d6c5a04eff9643b634cb2c98411f973b8f7aa1e2", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ2YzVhMDRlZmY5NjQzYjYzNGNiMmM5ODQxMWY5NzNiOGY3YWExZTI=", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2020-02-10T10:37:02Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2020-02-10T10:37:02Z"}, "message": "some more tests for i128 oveflow behavior", "tree": {"sha": "51a4701312b5e8cf4d14549eb0fc2d8e2449a4c2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/51a4701312b5e8cf4d14549eb0fc2d8e2449a4c2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d6c5a04eff9643b634cb2c98411f973b8f7aa1e2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d6c5a04eff9643b634cb2c98411f973b8f7aa1e2", "html_url": "https://github.com/rust-lang/rust/commit/d6c5a04eff9643b634cb2c98411f973b8f7aa1e2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d6c5a04eff9643b634cb2c98411f973b8f7aa1e2/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1ddb0503ff1e203de40f5bbc1e0b00d1b4e99d12", "url": "https://api.github.com/repos/rust-lang/rust/commits/1ddb0503ff1e203de40f5bbc1e0b00d1b4e99d12", "html_url": "https://github.com/rust-lang/rust/commit/1ddb0503ff1e203de40f5bbc1e0b00d1b4e99d12"}], "stats": {"total": 79, "additions": 66, "deletions": 13}, "files": [{"sha": "7c5aaedda35fa484baf97b385a8e70f465037b60", "filename": "src/test/ui/consts/const-err2.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/d6c5a04eff9643b634cb2c98411f973b8f7aa1e2/src%2Ftest%2Fui%2Fconsts%2Fconst-err2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6c5a04eff9643b634cb2c98411f973b8f7aa1e2/src%2Ftest%2Fui%2Fconsts%2Fconst-err2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-err2.rs?ref=d6c5a04eff9643b634cb2c98411f973b8f7aa1e2", "patch": "@@ -17,16 +17,22 @@ fn black_box<T>(_: T) {\n fn main() {\n     let a = -std::i8::MIN;\n     //~^ ERROR const_err\n+    let a_i128 = -std::i128::MIN;\n+    //~^ ERROR const_err\n     let b = 200u8 + 200u8 + 200u8;\n     //~^ ERROR const_err\n+    let b_i128 = std::i128::MIN - std::i128::MAX;\n+    //~^ ERROR const_err\n     let c = 200u8 * 4;\n     //~^ ERROR const_err\n     let d = 42u8 - (42u8 + 1);\n     //~^ ERROR const_err\n     let _e = [5u8][1];\n-    //~^ ERROR index out of bounds\n+    //~^ ERROR const_err\n     black_box(a);\n+    black_box(a_i128);\n     black_box(b);\n+    black_box(b_i128);\n     black_box(c);\n     black_box(d);\n }"}, {"sha": "f135bf0b06cadb3f061a45199bfe7143b2bf3885", "filename": "src/test/ui/consts/const-err2.stderr", "status": "modified", "additions": 17, "deletions": 5, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/d6c5a04eff9643b634cb2c98411f973b8f7aa1e2/src%2Ftest%2Fui%2Fconsts%2Fconst-err2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6c5a04eff9643b634cb2c98411f973b8f7aa1e2/src%2Ftest%2Fui%2Fconsts%2Fconst-err2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-err2.stderr?ref=d6c5a04eff9643b634cb2c98411f973b8f7aa1e2", "patch": "@@ -11,28 +11,40 @@ LL | #![deny(const_err)]\n    |         ^^^^^^^^^\n \n error: this expression will panic at runtime\n-  --> $DIR/const-err2.rs:20:13\n+  --> $DIR/const-err2.rs:20:18\n+   |\n+LL |     let a_i128 = -std::i128::MIN;\n+   |                  ^^^^^^^^^^^^^^^ attempt to negate with overflow\n+\n+error: this expression will panic at runtime\n+  --> $DIR/const-err2.rs:22:13\n    |\n LL |     let b = 200u8 + 200u8 + 200u8;\n    |             ^^^^^^^^^^^^^ attempt to add with overflow\n \n error: this expression will panic at runtime\n-  --> $DIR/const-err2.rs:22:13\n+  --> $DIR/const-err2.rs:24:18\n+   |\n+LL |     let b_i128 = std::i128::MIN - std::i128::MAX;\n+   |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ attempt to subtract with overflow\n+\n+error: this expression will panic at runtime\n+  --> $DIR/const-err2.rs:26:13\n    |\n LL |     let c = 200u8 * 4;\n    |             ^^^^^^^^^ attempt to multiply with overflow\n \n error: this expression will panic at runtime\n-  --> $DIR/const-err2.rs:24:13\n+  --> $DIR/const-err2.rs:28:13\n    |\n LL |     let d = 42u8 - (42u8 + 1);\n    |             ^^^^^^^^^^^^^^^^^ attempt to subtract with overflow\n \n error: index out of bounds: the len is 1 but the index is 1\n-  --> $DIR/const-err2.rs:26:14\n+  --> $DIR/const-err2.rs:30:14\n    |\n LL |     let _e = [5u8][1];\n    |              ^^^^^^^^\n \n-error: aborting due to 5 previous errors\n+error: aborting due to 7 previous errors\n "}, {"sha": "43aba4a8b012b00a6022751d586c24a74c90bb4f", "filename": "src/test/ui/consts/const-err3.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/d6c5a04eff9643b634cb2c98411f973b8f7aa1e2/src%2Ftest%2Fui%2Fconsts%2Fconst-err3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6c5a04eff9643b634cb2c98411f973b8f7aa1e2/src%2Ftest%2Fui%2Fconsts%2Fconst-err3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-err3.rs?ref=d6c5a04eff9643b634cb2c98411f973b8f7aa1e2", "patch": "@@ -17,16 +17,22 @@ fn black_box<T>(_: T) {\n fn main() {\n     let a = -std::i8::MIN;\n     //~^ ERROR const_err\n+    let a_i128 = -std::i128::MIN;\n+    //~^ ERROR const_err\n     let b = 200u8 + 200u8 + 200u8;\n     //~^ ERROR const_err\n+    let b_i128 = std::i128::MIN - std::i128::MAX;\n+    //~^ ERROR const_err\n     let c = 200u8 * 4;\n     //~^ ERROR const_err\n     let d = 42u8 - (42u8 + 1);\n     //~^ ERROR const_err\n     let _e = [5u8][1];\n     //~^ ERROR const_err\n     black_box(a);\n+    black_box(a_i128);\n     black_box(b);\n+    black_box(b_i128);\n     black_box(c);\n     black_box(d);\n }"}, {"sha": "05f64b87fcce6debabaeb621523f95f9cb275e8c", "filename": "src/test/ui/consts/const-err3.stderr", "status": "modified", "additions": 17, "deletions": 5, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/d6c5a04eff9643b634cb2c98411f973b8f7aa1e2/src%2Ftest%2Fui%2Fconsts%2Fconst-err3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6c5a04eff9643b634cb2c98411f973b8f7aa1e2/src%2Ftest%2Fui%2Fconsts%2Fconst-err3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-err3.stderr?ref=d6c5a04eff9643b634cb2c98411f973b8f7aa1e2", "patch": "@@ -10,29 +10,41 @@ note: the lint level is defined here\n LL | #![deny(const_err)]\n    |         ^^^^^^^^^\n \n+error: attempt to negate with overflow\n+  --> $DIR/const-err3.rs:20:18\n+   |\n+LL |     let a_i128 = -std::i128::MIN;\n+   |                  ^^^^^^^^^^^^^^^\n+\n error: attempt to add with overflow\n-  --> $DIR/const-err3.rs:20:13\n+  --> $DIR/const-err3.rs:22:13\n    |\n LL |     let b = 200u8 + 200u8 + 200u8;\n    |             ^^^^^^^^^^^^^\n \n+error: attempt to subtract with overflow\n+  --> $DIR/const-err3.rs:24:18\n+   |\n+LL |     let b_i128 = std::i128::MIN - std::i128::MAX;\n+   |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n error: attempt to multiply with overflow\n-  --> $DIR/const-err3.rs:22:13\n+  --> $DIR/const-err3.rs:26:13\n    |\n LL |     let c = 200u8 * 4;\n    |             ^^^^^^^^^\n \n error: attempt to subtract with overflow\n-  --> $DIR/const-err3.rs:24:13\n+  --> $DIR/const-err3.rs:28:13\n    |\n LL |     let d = 42u8 - (42u8 + 1);\n    |             ^^^^^^^^^^^^^^^^^\n \n error: index out of bounds: the len is 1 but the index is 1\n-  --> $DIR/const-err3.rs:26:14\n+  --> $DIR/const-err3.rs:30:14\n    |\n LL |     let _e = [5u8][1];\n    |              ^^^^^^^^\n \n-error: aborting due to 5 previous errors\n+error: aborting due to 7 previous errors\n "}, {"sha": "2c3421b7a8d0b4dd347bf6f86f6d1c3cbc96de3c", "filename": "src/test/ui/consts/const-int-arithmetic.rs", "status": "modified", "additions": 19, "deletions": 2, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/d6c5a04eff9643b634cb2c98411f973b8f7aa1e2/src%2Ftest%2Fui%2Fconsts%2Fconst-int-arithmetic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6c5a04eff9643b634cb2c98411f973b8f7aa1e2/src%2Ftest%2Fui%2Fconsts%2Fconst-int-arithmetic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-int-arithmetic.rs?ref=d6c5a04eff9643b634cb2c98411f973b8f7aa1e2", "patch": "@@ -7,7 +7,7 @@\n #![feature(const_saturating_int_methods)]\n #![feature(const_wrapping_int_methods)]\n \n-use std::i8;\n+use std::{i8, i128};\n \n macro_rules! suite {\n     ($(\n@@ -65,6 +65,10 @@ suite!(\n         C26: 5i8.checked_rem_euclid(0), None;\n         C27: i8::MIN.checked_rem_euclid(-1), None;\n     }\n+    checked_i128 -> Option<i128> {\n+        CHK_ADD_I128: i128::MAX.checked_add(1), None;\n+        CHK_MUL_I128: i128::MIN.checked_mul(-1), None;\n+    }\n \n     saturating_and_wrapping -> i8 {\n         // `const_saturating_int_methods`\n@@ -104,6 +108,13 @@ suite!(\n         C47: 100i8.wrapping_rem_euclid(10), 0;\n         C48: (-128i8).wrapping_rem_euclid(-1), 0;\n     }\n+    saturating_and_wrapping_i128 -> i128 {\n+        SAT_ADD_I128: i128::MAX.saturating_add(1), i128::MAX;\n+        SAT_MUL_I128: i128::MAX.saturating_mul(2), i128::MAX;\n+\n+        WRP_ADD_I128: i128::MAX.wrapping_add(1), i128::MIN;\n+        WRP_MUL_I128: i128::MAX.wrapping_mul(3), i128::MAX-2;\n+    }\n \n     overflowing -> (i8, bool) {\n         // `const_overflowing_int_methods`\n@@ -119,12 +130,18 @@ suite!(\n \n         C55: 5i8.overflowing_rem_euclid(2), (1, false);\n         C56: i8::MIN.overflowing_rem_euclid(-1), (0, true);\n-\n+    }\n+    overflowing_i128 -> (i128, bool) {\n+        OFL_ADD_I128: i128::MAX.overflowing_add(1), (i128::MIN, true);\n+        OFL_MUL_I128: i128::MAX.overflowing_mul(3), (i128::MAX-2, true);\n     }\n );\n \n fn main() {\n    checked();\n+   checked_i128();\n    saturating_and_wrapping();\n+   saturating_and_wrapping_i128();\n    overflowing();\n+   overflowing_i128();\n }"}]}