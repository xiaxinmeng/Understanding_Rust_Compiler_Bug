{"sha": "beefcf88544b7f4d1b5e9ae77f93566303d34326", "node_id": "C_kwDOAAsO6NoAKGJlZWZjZjg4NTQ0YjdmNGQxYjVlOWFlNzdmOTM1NjYzMDNkMzQzMjY", "commit": {"author": {"name": "Joshua Nelson", "email": "github@jyn.dev", "date": "2022-12-31T01:02:10Z"}, "committer": {"name": "Joshua Nelson", "email": "github@jyn.dev", "date": "2023-01-01T21:44:18Z"}, "message": "Cleanup `mingw-tidy` docker job\n\n- Avoid `/checkout/src/ci/run.sh: line 187: [: =: unary operator expected`: https://github.com/rust-lang/rust/actions/runs/3809902408/jobs/6481611301#step:26:1701\n- Avoid running `x check` in the tidy test, to get faster feedback. It's\n  already run on the normal `mingw-check` job.", "tree": {"sha": "93d93b4e608d231b1bbcb358a174555b76f15db4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/93d93b4e608d231b1bbcb358a174555b76f15db4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/beefcf88544b7f4d1b5e9ae77f93566303d34326", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/beefcf88544b7f4d1b5e9ae77f93566303d34326", "html_url": "https://github.com/rust-lang/rust/commit/beefcf88544b7f4d1b5e9ae77f93566303d34326", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/beefcf88544b7f4d1b5e9ae77f93566303d34326/comments", "author": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "77429957a0e9c90a26c89def061ffdd4bae5ccb9", "url": "https://api.github.com/repos/rust-lang/rust/commits/77429957a0e9c90a26c89def061ffdd4bae5ccb9", "html_url": "https://github.com/rust-lang/rust/commit/77429957a0e9c90a26c89def061ffdd4bae5ccb9"}], "stats": {"total": 5, "additions": 2, "deletions": 3}, "files": [{"sha": "dc0e591cad6f6f9aec51a1ab2eec129f01e9988b", "filename": "src/ci/docker/host-x86_64/mingw-check-tidy/Dockerfile", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/beefcf88544b7f4d1b5e9ae77f93566303d34326/src%2Fci%2Fdocker%2Fhost-x86_64%2Fmingw-check-tidy%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/beefcf88544b7f4d1b5e9ae77f93566303d34326/src%2Fci%2Fdocker%2Fhost-x86_64%2Fmingw-check-tidy%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fmingw-check-tidy%2FDockerfile?ref=beefcf88544b7f4d1b5e9ae77f93566303d34326", "patch": "@@ -32,5 +32,4 @@ RUN pip3 install --no-deps --no-cache-dir --require-hashes -r /tmp/reuse-require\n COPY host-x86_64/mingw-check/validate-toolstate.sh /scripts/\n COPY host-x86_64/mingw-check/validate-error-codes.sh /scripts/\n \n-ENV RUN_CHECK_WITH_PARALLEL_QUERIES 1\n ENV SCRIPT python3 ../x.py test --stage 0 src/tools/tidy tidyselftest"}, {"sha": "0db9c993eecb407f2fd72cb4a3a0a76ef3535cb4", "filename": "src/ci/run.sh", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/beefcf88544b7f4d1b5e9ae77f93566303d34326/src%2Fci%2Frun.sh", "raw_url": "https://github.com/rust-lang/rust/raw/beefcf88544b7f4d1b5e9ae77f93566303d34326/src%2Fci%2Frun.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Frun.sh?ref=beefcf88544b7f4d1b5e9ae77f93566303d34326", "patch": "@@ -184,11 +184,11 @@ if [ \"$RUN_CHECK_WITH_PARALLEL_QUERIES\" != \"\" ]; then\n   $SRC/configure --set rust.parallel-compiler\n \n   # Save the build metrics before we wipe the directory\n-  if [ $HAS_METRICS = 1 ]; then\n+  if [ \"$HAS_METRICS\" = 1 ]; then\n     mv build/metrics.json .\n   fi\n   rm -rf build\n-  if [ $HAS_METRICS = 1 ]; then\n+  if [ \"$HAS_METRICS\" = 1 ]; then\n     mkdir build\n     mv metrics.json build\n   fi"}]}