{"sha": "c188635a2ab51d592e3d8e850d9d05b9eb905033", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMxODg2MzVhMmFiNTFkNTkyZTNkOGU4NTBkOWQwNWI5ZWI5MDUwMzM=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2016-12-20T19:16:50Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2016-12-20T20:59:11Z"}, "message": "Rollup merge of #38493 - sanxiyn:filecheck, r=alexcrichton\n\nFind FileCheck using llvm-config\n\nThis allows using system LLVM from Debian package to run codegen tests.\n\nFix #36282.\n\nr? @alexcrichton", "tree": {"sha": "031796ff9c3e0480285ee6d3797f61d0389131d9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/031796ff9c3e0480285ee6d3797f61d0389131d9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c188635a2ab51d592e3d8e850d9d05b9eb905033", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c188635a2ab51d592e3d8e850d9d05b9eb905033", "html_url": "https://github.com/rust-lang/rust/commit/c188635a2ab51d592e3d8e850d9d05b9eb905033", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c188635a2ab51d592e3d8e850d9d05b9eb905033/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "10bb4a4801243f2465fa9b17cfa7ab40f7f3980d", "url": "https://api.github.com/repos/rust-lang/rust/commits/10bb4a4801243f2465fa9b17cfa7ab40f7f3980d", "html_url": "https://github.com/rust-lang/rust/commit/10bb4a4801243f2465fa9b17cfa7ab40f7f3980d"}, {"sha": "73877a0bc882abc2a88fe9c0d4fb95d49c1ba492", "url": "https://api.github.com/repos/rust-lang/rust/commits/73877a0bc882abc2a88fe9c0d4fb95d49c1ba492", "html_url": "https://github.com/rust-lang/rust/commit/73877a0bc882abc2a88fe9c0d4fb95d49c1ba492"}], "stats": {"total": 5, "additions": 3, "deletions": 2}, "files": [{"sha": "128e03fe8f88848fd4ae3f13369f490937769cd1", "filename": "src/bootstrap/lib.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/c188635a2ab51d592e3d8e850d9d05b9eb905033/src%2Fbootstrap%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c188635a2ab51d592e3d8e850d9d05b9eb905033/src%2Fbootstrap%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Flib.rs?ref=c188635a2ab51d592e3d8e850d9d05b9eb905033", "patch": "@@ -721,7 +721,8 @@ impl Build {\n     fn llvm_filecheck(&self, target: &str) -> PathBuf {\n         let target_config = self.config.target_config.get(target);\n         if let Some(s) = target_config.and_then(|c| c.llvm_config.as_ref()) {\n-            s.parent().unwrap().join(exe(\"FileCheck\", target))\n+            let llvm_bindir = output(Command::new(s).arg(\"--bindir\"));\n+            Path::new(llvm_bindir.trim()).join(exe(\"FileCheck\", target))\n         } else {\n             let base = self.llvm_out(&self.config.build).join(\"build\");\n             let exe = exe(\"FileCheck\", target);"}, {"sha": "5d543419fc9b6a78b8331728caf46d2f02e31aa3", "filename": "src/bootstrap/sanity.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c188635a2ab51d592e3d8e850d9d05b9eb905033/src%2Fbootstrap%2Fsanity.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c188635a2ab51d592e3d8e850d9d05b9eb905033/src%2Fbootstrap%2Fsanity.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fsanity.rs?ref=c188635a2ab51d592e3d8e850d9d05b9eb905033", "patch": "@@ -143,7 +143,7 @@ pub fn check(build: &mut Build) {\n     // Externally configured LLVM requires FileCheck to exist\n     let filecheck = build.llvm_filecheck(&build.config.build);\n     if !filecheck.starts_with(&build.out) && !filecheck.exists() && build.config.codegen_tests {\n-        panic!(\"filecheck executable {:?} does not exist\", filecheck);\n+        panic!(\"FileCheck executable {:?} does not exist\", filecheck);\n     }\n \n     for target in build.config.target.iter() {"}]}