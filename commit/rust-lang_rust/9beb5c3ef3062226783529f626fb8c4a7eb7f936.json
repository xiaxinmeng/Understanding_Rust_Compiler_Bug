{"sha": "9beb5c3ef3062226783529f626fb8c4a7eb7f936", "node_id": "MDY6Q29tbWl0NzI0NzEyOjliZWI1YzNlZjMwNjIyMjY3ODM1MjlmNjI2ZmI4YzRhN2ViN2Y5MzY=", "commit": {"author": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2018-09-07T23:50:57Z"}, "committer": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2018-09-08T11:15:11Z"}, "message": "Add checks for expected macro output in restricted shadowing tests", "tree": {"sha": "726b9dc48f14f5ed6e1af70b3917d480c13a230e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/726b9dc48f14f5ed6e1af70b3917d480c13a230e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9beb5c3ef3062226783529f626fb8c4a7eb7f936", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9beb5c3ef3062226783529f626fb8c4a7eb7f936", "html_url": "https://github.com/rust-lang/rust/commit/9beb5c3ef3062226783529f626fb8c4a7eb7f936", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9beb5c3ef3062226783529f626fb8c4a7eb7f936/comments", "author": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ae2e5aa1c7a926d663d9bc7ef46d1c0ffdc71e77", "url": "https://api.github.com/repos/rust-lang/rust/commits/ae2e5aa1c7a926d663d9bc7ef46d1c0ffdc71e77", "html_url": "https://github.com/rust-lang/rust/commit/ae2e5aa1c7a926d663d9bc7ef46d1c0ffdc71e77"}], "stats": {"total": 250, "additions": 134, "deletions": 116}, "files": [{"sha": "6c9a924081aeb5737bd1216aadc8172d597c18ba", "filename": "src/librustc_resolve/lib.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9beb5c3ef3062226783529f626fb8c4a7eb7f936/src%2Flibrustc_resolve%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9beb5c3ef3062226783529f626fb8c4a7eb7f936/src%2Flibrustc_resolve%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Flib.rs?ref=9beb5c3ef3062226783529f626fb8c4a7eb7f936", "patch": "@@ -1274,6 +1274,8 @@ impl<'a> NameBinding<'a> {\n     // expansion round `max(invoc_id, binding)` when they both emerged from macros.\n     // Then this function returns `true` if `self` may emerge from a macro *after* that\n     // in some later round and screw up our previously found resolution.\n+    // See more detailed explanation in\n+    // https://github.com/rust-lang/rust/pull/53778#issuecomment-419224049\n     fn may_appear_after(&self, invoc_id: Mark, binding: &NameBinding) -> bool {\n         // self > max(invoc_id, binding) => !(self <= invoc_id || self <= binding)\n         // Expansions are partially ordered, so \"may appear after\" is an inversion of"}, {"sha": "f5cac2dfbfb4113b7593cf4ee58d59e8398c0563", "filename": "src/test/ui/macros/restricted-shadowing-legacy.rs", "status": "modified", "additions": 28, "deletions": 20, "changes": 48, "blob_url": "https://github.com/rust-lang/rust/blob/9beb5c3ef3062226783529f626fb8c4a7eb7f936/src%2Ftest%2Fui%2Fmacros%2Frestricted-shadowing-legacy.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9beb5c3ef3062226783529f626fb8c4a7eb7f936/src%2Ftest%2Fui%2Fmacros%2Frestricted-shadowing-legacy.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Frestricted-shadowing-legacy.rs?ref=9beb5c3ef3062226783529f626fb8c4a7eb7f936", "patch": "@@ -1,4 +1,9 @@\n // Legend:\n+// `N` - number of combination, from 0 to 4*4*4=64\n+// `Outer < Invoc` means that expansion that produced macro definition `Outer`\n+// is a strict ancestor of expansion that produced macro definition `Inner`.\n+// `>`, `=` and `Unordered` mean \"strict descendant\", \"same\" and\n+// \"not in ordering relation\" for parent expansions.\n // `+` - possible configuration\n // `-` - configuration impossible due to properties of partial ordering\n // `-?` - configuration impossible due to block/scope syntax\n@@ -72,12 +77,15 @@\n \n #![feature(decl_macro, rustc_attrs)]\n \n+struct Right;\n+// struct Wrong; // not defined\n+\n macro_rules! include { () => {\n     macro_rules! gen_outer { () => {\n-        macro_rules! m { () => {} }\n+        macro_rules! m { () => { Wrong } }\n     }}\n     macro_rules! gen_inner { () => {\n-        macro_rules! m { () => {} }\n+        macro_rules! m { () => { Right } }\n     }}\n     macro_rules! gen_invoc { () => {\n         m!()\n@@ -96,29 +104,29 @@ macro_rules! include { () => {\n     }\n \n     fn check5() {\n-        macro_rules! m { () => {} }\n+        macro_rules! m { () => { Wrong } }\n \n         macro_rules! gen_inner_invoc { () => {\n-            macro_rules! m { () => {} }\n+            macro_rules! m { () => { Right } }\n             m!(); // OK\n         }}\n         gen_inner_invoc!();\n     }\n \n     fn check9() {\n-        macro_rules! m { () => {} }\n+        macro_rules! m { () => { Wrong } }\n \n         macro_rules! gen_inner_gen_invoc { () => {\n-            macro_rules! m { () => {} }\n+            macro_rules! m { () => { Right } }\n             gen_invoc!(); // OK\n         }}\n         gen_inner_gen_invoc!();\n     }\n \n     fn check10() {\n-        macro_rules! m { () => {} }\n+        macro_rules! m { () => { Wrong } }\n \n-        macro_rules! m { () => {} }\n+        macro_rules! m { () => { Right } }\n \n         gen_invoc!(); // OK\n     }\n@@ -141,9 +149,9 @@ macro_rules! include { () => {\n     }\n \n     fn check22() {\n-        macro_rules! m { () => {} }\n+        macro_rules! m { () => { Wrong } }\n \n-        macro_rules! m { () => {} }\n+        macro_rules! m { () => { Right } }\n \n         m!(); // OK\n     }\n@@ -159,7 +167,7 @@ macro_rules! include { () => {\n     fn check39() {\n         gen_outer!();\n \n-        macro_rules! m { () => {} }\n+        macro_rules! m { () => { Right } }\n \n         m!(); // OK\n     }\n@@ -178,7 +186,7 @@ macro_rules! include { () => {\n         gen_outer!();\n \n         macro_rules! gen_inner_invoc { () => {\n-            macro_rules! m { () => {} }\n+            macro_rules! m { () => { Right } }\n             m!(); // OK\n         }}\n         gen_inner_invoc!();\n@@ -187,7 +195,7 @@ macro_rules! include { () => {\n     fn check59() {\n         gen_outer!();\n \n-        macro_rules! m { () => {} }\n+        macro_rules! m { () => { Right } }\n \n         gen_invoc!(); // OK\n     }\n@@ -196,7 +204,7 @@ macro_rules! include { () => {\n         gen_outer!();\n \n         macro_rules! gen_inner_gen_invoc { () => {\n-            macro_rules! m { () => {} }\n+            macro_rules! m { () => { Right } }\n             gen_invoc!(); // OK\n         }}\n         gen_inner_gen_invoc!();\n@@ -226,8 +234,8 @@ macro_rules! include { () => {\n \n     fn check34() {\n         macro_rules! gen_outer_inner { () => {\n-            macro_rules! m { () => {} }\n-            macro_rules! m { () => {} }\n+            macro_rules! m { () => { Wrong } }\n+            macro_rules! m { () => { Right } }\n         }}\n         gen_outer_inner!();\n \n@@ -237,7 +245,7 @@ macro_rules! include { () => {\n     fn check35() {\n         macro_rules! gen_gen_outer_inner { () => {\n             gen_outer!();\n-            macro_rules! m { () => {} }\n+            macro_rules! m { () => { Right } }\n         }}\n         gen_gen_outer_inner!();\n \n@@ -257,8 +265,8 @@ macro_rules! include { () => {\n \n     fn check62() {\n         macro_rules! gen_outer_inner { () => {\n-            macro_rules! m { () => {} }\n-            macro_rules! m { () => {} }\n+            macro_rules! m { () => { Wrong } }\n+            macro_rules! m { () => { Right } }\n         }}\n         gen_outer_inner!();\n \n@@ -268,7 +276,7 @@ macro_rules! include { () => {\n     fn check63() {\n         macro_rules! gen_gen_outer_inner { () => {\n             gen_outer!();\n-            macro_rules! m { () => {} }\n+            macro_rules! m { () => { Right } }\n         }}\n         gen_gen_outer_inner!();\n "}, {"sha": "c1a01956998b4ad576761f96e6e24dc2f4681ede", "filename": "src/test/ui/macros/restricted-shadowing-legacy.stderr", "status": "modified", "additions": 46, "deletions": 46, "changes": 92, "blob_url": "https://github.com/rust-lang/rust/blob/9beb5c3ef3062226783529f626fb8c4a7eb7f936/src%2Ftest%2Fui%2Fmacros%2Frestricted-shadowing-legacy.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/9beb5c3ef3062226783529f626fb8c4a7eb7f936/src%2Ftest%2Fui%2Fmacros%2Frestricted-shadowing-legacy.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Frestricted-shadowing-legacy.stderr?ref=9beb5c3ef3062226783529f626fb8c4a7eb7f936", "patch": "@@ -1,19 +1,19 @@\n error[E0659]: `m` is ambiguous\n-  --> $DIR/restricted-shadowing-legacy.rs:93:13\n+  --> $DIR/restricted-shadowing-legacy.rs:101:13\n    |\n LL |             m!(); //~ ERROR `m` is ambiguous\n    |             ^\n    |\n note: `m` could refer to the name defined here\n-  --> $DIR/restricted-shadowing-legacy.rs:80:9\n+  --> $DIR/restricted-shadowing-legacy.rs:88:9\n    |\n-LL |         macro_rules! m { () => {} }\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL |         macro_rules! m { () => { Right } }\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n note: `m` could also refer to the name defined here\n-  --> $DIR/restricted-shadowing-legacy.rs:89:9\n+  --> $DIR/restricted-shadowing-legacy.rs:97:9\n    |\n LL |         macro_rules! m { () => {} }\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n@@ -23,21 +23,21 @@ LL | include!();\n    = note: macro-expanded macros do not shadow\n \n error[E0659]: `m` is ambiguous\n-  --> $DIR/restricted-shadowing-legacy.rs:131:42\n+  --> $DIR/restricted-shadowing-legacy.rs:139:42\n    |\n LL |         macro_rules! gen_invoc { () => { m!() } } //~ ERROR `m` is ambiguous\n    |                                          ^\n    |\n note: `m` could refer to the name defined here\n-  --> $DIR/restricted-shadowing-legacy.rs:80:9\n+  --> $DIR/restricted-shadowing-legacy.rs:88:9\n    |\n-LL |         macro_rules! m { () => {} }\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL |         macro_rules! m { () => { Right } }\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n note: `m` could also refer to the name defined here\n-  --> $DIR/restricted-shadowing-legacy.rs:127:9\n+  --> $DIR/restricted-shadowing-legacy.rs:135:9\n    |\n LL |         macro_rules! m { () => {} }\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n@@ -47,21 +47,21 @@ LL | include!();\n    = note: macro-expanded macros do not shadow\n \n error[E0659]: `m` is ambiguous\n-  --> $DIR/restricted-shadowing-legacy.rs:140:9\n+  --> $DIR/restricted-shadowing-legacy.rs:148:9\n    |\n LL |         m!(); //~ ERROR `m` is ambiguous\n    |         ^\n    |\n note: `m` could refer to the name defined here\n-  --> $DIR/restricted-shadowing-legacy.rs:80:9\n+  --> $DIR/restricted-shadowing-legacy.rs:88:9\n    |\n-LL |         macro_rules! m { () => {} }\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL |         macro_rules! m { () => { Right } }\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n note: `m` could also refer to the name defined here\n-  --> $DIR/restricted-shadowing-legacy.rs:136:9\n+  --> $DIR/restricted-shadowing-legacy.rs:144:9\n    |\n LL |         macro_rules! m { () => {} }\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n@@ -71,93 +71,93 @@ LL | include!();\n    = note: macro-expanded macros do not shadow\n \n error[E0659]: `m` is ambiguous\n-  --> $DIR/restricted-shadowing-legacy.rs:156:9\n+  --> $DIR/restricted-shadowing-legacy.rs:164:9\n    |\n LL |         m!(); //~ ERROR `m` is ambiguous\n    |         ^\n    |\n note: `m` could refer to the name defined here\n-  --> $DIR/restricted-shadowing-legacy.rs:80:9\n+  --> $DIR/restricted-shadowing-legacy.rs:88:9\n    |\n-LL |         macro_rules! m { () => {} }\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL |         macro_rules! m { () => { Right } }\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n note: `m` could also refer to the name defined here\n-  --> $DIR/restricted-shadowing-legacy.rs:77:9\n+  --> $DIR/restricted-shadowing-legacy.rs:85:9\n    |\n-LL |         macro_rules! m { () => {} }\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL |         macro_rules! m { () => { Wrong } }\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n    = note: macro-expanded macros do not shadow\n \n error[E0659]: `m` is ambiguous\n-  --> $DIR/restricted-shadowing-legacy.rs:172:13\n+  --> $DIR/restricted-shadowing-legacy.rs:180:13\n    |\n LL |             m!(); //~ ERROR `m` is ambiguous\n    |             ^\n    |\n note: `m` could refer to the name defined here\n-  --> $DIR/restricted-shadowing-legacy.rs:80:9\n+  --> $DIR/restricted-shadowing-legacy.rs:88:9\n    |\n-LL |         macro_rules! m { () => {} }\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL |         macro_rules! m { () => { Right } }\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n note: `m` could also refer to the name defined here\n-  --> $DIR/restricted-shadowing-legacy.rs:77:9\n+  --> $DIR/restricted-shadowing-legacy.rs:85:9\n    |\n-LL |         macro_rules! m { () => {} }\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL |         macro_rules! m { () => { Wrong } }\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n    = note: macro-expanded macros do not shadow\n \n error[E0659]: `m` is ambiguous\n-  --> $DIR/restricted-shadowing-legacy.rs:210:42\n+  --> $DIR/restricted-shadowing-legacy.rs:218:42\n    |\n LL |         macro_rules! gen_invoc { () => { m!() } } //~ ERROR `m` is ambiguous\n    |                                          ^\n    |\n note: `m` could refer to the name defined here\n-  --> $DIR/restricted-shadowing-legacy.rs:80:9\n+  --> $DIR/restricted-shadowing-legacy.rs:88:9\n    |\n-LL |         macro_rules! m { () => {} }\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL |         macro_rules! m { () => { Right } }\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n note: `m` could also refer to the name defined here\n-  --> $DIR/restricted-shadowing-legacy.rs:77:9\n+  --> $DIR/restricted-shadowing-legacy.rs:85:9\n    |\n-LL |         macro_rules! m { () => {} }\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL |         macro_rules! m { () => { Wrong } }\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n    = note: macro-expanded macros do not shadow\n \n error[E0659]: `m` is ambiguous\n-  --> $DIR/restricted-shadowing-legacy.rs:224:9\n+  --> $DIR/restricted-shadowing-legacy.rs:232:9\n    |\n LL |         m!(); //~ ERROR `m` is ambiguous\n    |         ^\n    |\n note: `m` could refer to the name defined here\n-  --> $DIR/restricted-shadowing-legacy.rs:80:9\n+  --> $DIR/restricted-shadowing-legacy.rs:88:9\n    |\n-LL |         macro_rules! m { () => {} }\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL |         macro_rules! m { () => { Right } }\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n note: `m` could also refer to the name defined here\n-  --> $DIR/restricted-shadowing-legacy.rs:219:13\n+  --> $DIR/restricted-shadowing-legacy.rs:227:13\n    |\n LL |             macro_rules! m { () => {} }\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n@@ -167,21 +167,21 @@ LL | include!();\n    = note: macro-expanded macros do not shadow\n \n error[E0659]: `m` is ambiguous\n-  --> $DIR/restricted-shadowing-legacy.rs:254:42\n+  --> $DIR/restricted-shadowing-legacy.rs:262:42\n    |\n LL |         macro_rules! gen_invoc { () => { m!() } } //~ ERROR `m` is ambiguous\n    |                                          ^\n    |\n note: `m` could refer to the name defined here\n-  --> $DIR/restricted-shadowing-legacy.rs:80:9\n+  --> $DIR/restricted-shadowing-legacy.rs:88:9\n    |\n-LL |         macro_rules! m { () => {} }\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL |         macro_rules! m { () => { Right } }\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n note: `m` could also refer to the name defined here\n-  --> $DIR/restricted-shadowing-legacy.rs:249:13\n+  --> $DIR/restricted-shadowing-legacy.rs:257:13\n    |\n LL |             macro_rules! m { () => {} }\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^"}, {"sha": "448f623c2208fe3d6ab10ba119ab33c045834a91", "filename": "src/test/ui/macros/restricted-shadowing-modern.rs", "status": "modified", "additions": 22, "deletions": 14, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/9beb5c3ef3062226783529f626fb8c4a7eb7f936/src%2Ftest%2Fui%2Fmacros%2Frestricted-shadowing-modern.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9beb5c3ef3062226783529f626fb8c4a7eb7f936/src%2Ftest%2Fui%2Fmacros%2Frestricted-shadowing-modern.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Frestricted-shadowing-modern.rs?ref=9beb5c3ef3062226783529f626fb8c4a7eb7f936", "patch": "@@ -1,4 +1,9 @@\n // Legend:\n+// `N` - number of combination, from 0 to 4*4*4=64\n+// `Outer < Invoc` means that expansion that produced macro definition `Outer`\n+// is a strict ancestor of expansion that produced macro definition `Inner`.\n+// `>`, `=` and `Unordered` mean \"strict descendant\", \"same\" and\n+// \"not in ordering relation\" for parent expansions.\n // `+` - possible configuration\n // `-` - configuration impossible due to properties of partial ordering\n // `-?` - configuration impossible due to block/scope syntax\n@@ -72,15 +77,18 @@\n \n #![feature(decl_macro, rustc_attrs)]\n \n+struct Right;\n+// struct Wrong; // not defined\n+\n #[rustc_transparent_macro]\n macro include() {\n     #[rustc_transparent_macro]\n     macro gen_outer() {\n-        macro m() {}\n+        macro m() { Wrong }\n     }\n     #[rustc_transparent_macro]\n     macro gen_inner() {\n-        macro m() {}\n+        macro m() { Right }\n     }\n     #[rustc_transparent_macro]\n     macro gen_invoc() {\n@@ -102,33 +110,33 @@ macro include() {\n     }\n \n     fn check5() {\n-        macro m() {}\n+        macro m() { Wrong }\n         {\n             #[rustc_transparent_macro]\n             macro gen_inner_invoc() {\n-                macro m() {}\n+                macro m() { Right }\n                 m!(); // OK\n             }\n             gen_inner_invoc!();\n         }\n     }\n \n     fn check9() {\n-        macro m() {}\n+        macro m() { Wrong }\n         {\n             #[rustc_transparent_macro]\n             macro gen_inner_gen_invoc() {\n-                macro m() {}\n+                macro m() { Right }\n                 gen_invoc!(); // OK\n             }\n             gen_inner_gen_invoc!();\n         }\n     }\n \n     fn check10() {\n-        macro m() {}\n+        macro m() { Wrong }\n         {\n-            macro m() {}\n+            macro m() { Right }\n             gen_invoc!(); // OK\n         }\n     }\n@@ -152,9 +160,9 @@ macro include() {\n     }\n \n     fn check22() {\n-        macro m() {}\n+        macro m() { Wrong }\n         {\n-            macro m() {}\n+            macro m() { Right }\n             m!(); // OK\n         }\n     }\n@@ -170,7 +178,7 @@ macro include() {\n     fn check39() {\n         gen_outer!();\n         {\n-            macro m() {}\n+            macro m() { Right }\n             m!(); // OK\n         }\n     }\n@@ -192,7 +200,7 @@ macro include() {\n         {\n             #[rustc_transparent_macro]\n             macro gen_inner_invoc() {\n-                macro m() {}\n+                macro m() { Right }\n                 m!(); // OK\n             }\n             gen_inner_invoc!();\n@@ -202,7 +210,7 @@ macro include() {\n     fn check59() {\n         gen_outer!();\n         {\n-            macro m() {}\n+            macro m() { Right }\n             gen_invoc!(); // OK\n         }\n     }\n@@ -212,7 +220,7 @@ macro include() {\n         {\n             #[rustc_transparent_macro]\n             macro gen_inner_gen_invoc() {\n-                macro m() {}\n+                macro m() { Right }\n                 gen_invoc!(); // OK\n             }\n             gen_inner_gen_invoc!();"}, {"sha": "af4a93a40794590a2bff39c50a143272e49e7196", "filename": "src/test/ui/macros/restricted-shadowing-modern.stderr", "status": "modified", "additions": 36, "deletions": 36, "changes": 72, "blob_url": "https://github.com/rust-lang/rust/blob/9beb5c3ef3062226783529f626fb8c4a7eb7f936/src%2Ftest%2Fui%2Fmacros%2Frestricted-shadowing-modern.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/9beb5c3ef3062226783529f626fb8c4a7eb7f936/src%2Ftest%2Fui%2Fmacros%2Frestricted-shadowing-modern.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Frestricted-shadowing-modern.stderr?ref=9beb5c3ef3062226783529f626fb8c4a7eb7f936", "patch": "@@ -1,5 +1,5 @@\n error[E0659]: `m` is ambiguous\n-  --> $DIR/restricted-shadowing-modern.rs:98:17\n+  --> $DIR/restricted-shadowing-modern.rs:106:17\n    |\n LL |                 m!(); //~ ERROR `m` is ambiguous\n    |                 ^\n@@ -8,15 +8,15 @@ LL | include!();\n    | ----------- in this macro invocation\n    |\n note: `m` could refer to the name defined here\n-  --> $DIR/restricted-shadowing-modern.rs:83:9\n+  --> $DIR/restricted-shadowing-modern.rs:91:9\n    |\n-LL |         macro m() {}\n-   |         ^^^^^^^^^^^^\n+LL |         macro m() { Right }\n+   |         ^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n note: `m` could also refer to the name defined here\n-  --> $DIR/restricted-shadowing-modern.rs:93:9\n+  --> $DIR/restricted-shadowing-modern.rs:101:9\n    |\n LL |         macro m() {}\n    |         ^^^^^^^^^^^^\n@@ -26,7 +26,7 @@ LL | include!();\n    = note: macro-expanded macros do not shadow\n \n error[E0659]: `m` is ambiguous\n-  --> $DIR/restricted-shadowing-modern.rs:141:33\n+  --> $DIR/restricted-shadowing-modern.rs:149:33\n    |\n LL |             macro gen_invoc() { m!() } //~ ERROR `m` is ambiguous\n    |                                 ^\n@@ -35,15 +35,15 @@ LL | include!();\n    | ----------- in this macro invocation\n    |\n note: `m` could refer to the name defined here\n-  --> $DIR/restricted-shadowing-modern.rs:83:9\n+  --> $DIR/restricted-shadowing-modern.rs:91:9\n    |\n-LL |         macro m() {}\n-   |         ^^^^^^^^^^^^\n+LL |         macro m() { Right }\n+   |         ^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n note: `m` could also refer to the name defined here\n-  --> $DIR/restricted-shadowing-modern.rs:137:9\n+  --> $DIR/restricted-shadowing-modern.rs:145:9\n    |\n LL |         macro m() {}\n    |         ^^^^^^^^^^^^\n@@ -53,7 +53,7 @@ LL | include!();\n    = note: macro-expanded macros do not shadow\n \n error[E0659]: `m` is ambiguous\n-  --> $DIR/restricted-shadowing-modern.rs:150:13\n+  --> $DIR/restricted-shadowing-modern.rs:158:13\n    |\n LL |             m!(); //~ ERROR `m` is ambiguous\n    |             ^\n@@ -62,15 +62,15 @@ LL | include!();\n    | ----------- in this macro invocation\n    |\n note: `m` could refer to the name defined here\n-  --> $DIR/restricted-shadowing-modern.rs:83:9\n+  --> $DIR/restricted-shadowing-modern.rs:91:9\n    |\n-LL |         macro m() {}\n-   |         ^^^^^^^^^^^^\n+LL |         macro m() { Right }\n+   |         ^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n note: `m` could also refer to the name defined here\n-  --> $DIR/restricted-shadowing-modern.rs:147:9\n+  --> $DIR/restricted-shadowing-modern.rs:155:9\n    |\n LL |         macro m() {}\n    |         ^^^^^^^^^^^^\n@@ -80,7 +80,7 @@ LL | include!();\n    = note: macro-expanded macros do not shadow\n \n error[E0659]: `m` is ambiguous\n-  --> $DIR/restricted-shadowing-modern.rs:166:13\n+  --> $DIR/restricted-shadowing-modern.rs:174:13\n    |\n LL |             m!(); //~ ERROR `m` is ambiguous\n    |             ^\n@@ -89,25 +89,25 @@ LL | include!();\n    | ----------- in this macro invocation\n    |\n note: `m` could refer to the name defined here\n-  --> $DIR/restricted-shadowing-modern.rs:83:9\n+  --> $DIR/restricted-shadowing-modern.rs:91:9\n    |\n-LL |         macro m() {}\n-   |         ^^^^^^^^^^^^\n+LL |         macro m() { Right }\n+   |         ^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n note: `m` could also refer to the name defined here\n-  --> $DIR/restricted-shadowing-modern.rs:79:9\n+  --> $DIR/restricted-shadowing-modern.rs:87:9\n    |\n-LL |         macro m() {}\n-   |         ^^^^^^^^^^^^\n+LL |         macro m() { Wrong }\n+   |         ^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n    = note: macro-expanded macros do not shadow\n \n error[E0659]: `m` is ambiguous\n-  --> $DIR/restricted-shadowing-modern.rs:184:17\n+  --> $DIR/restricted-shadowing-modern.rs:192:17\n    |\n LL |                 m!(); //~ ERROR `m` is ambiguous\n    |                 ^\n@@ -116,25 +116,25 @@ LL | include!();\n    | ----------- in this macro invocation\n    |\n note: `m` could refer to the name defined here\n-  --> $DIR/restricted-shadowing-modern.rs:83:9\n+  --> $DIR/restricted-shadowing-modern.rs:91:9\n    |\n-LL |         macro m() {}\n-   |         ^^^^^^^^^^^^\n+LL |         macro m() { Right }\n+   |         ^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n note: `m` could also refer to the name defined here\n-  --> $DIR/restricted-shadowing-modern.rs:79:9\n+  --> $DIR/restricted-shadowing-modern.rs:87:9\n    |\n-LL |         macro m() {}\n-   |         ^^^^^^^^^^^^\n+LL |         macro m() { Wrong }\n+   |         ^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n    = note: macro-expanded macros do not shadow\n \n error[E0659]: `m` is ambiguous\n-  --> $DIR/restricted-shadowing-modern.rs:227:33\n+  --> $DIR/restricted-shadowing-modern.rs:235:33\n    |\n LL |             macro gen_invoc() { m!() } //~ ERROR `m` is ambiguous\n    |                                 ^\n@@ -143,18 +143,18 @@ LL | include!();\n    | ----------- in this macro invocation\n    |\n note: `m` could refer to the name defined here\n-  --> $DIR/restricted-shadowing-modern.rs:83:9\n+  --> $DIR/restricted-shadowing-modern.rs:91:9\n    |\n-LL |         macro m() {}\n-   |         ^^^^^^^^^^^^\n+LL |         macro m() { Right }\n+   |         ^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation\n note: `m` could also refer to the name defined here\n-  --> $DIR/restricted-shadowing-modern.rs:79:9\n+  --> $DIR/restricted-shadowing-modern.rs:87:9\n    |\n-LL |         macro m() {}\n-   |         ^^^^^^^^^^^^\n+LL |         macro m() { Wrong }\n+   |         ^^^^^^^^^^^^^^^^^^^\n ...\n LL | include!();\n    | ----------- in this macro invocation"}]}