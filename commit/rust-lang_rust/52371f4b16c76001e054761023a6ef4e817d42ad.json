{"sha": "52371f4b16c76001e054761023a6ef4e817d42ad", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUyMzcxZjRiMTZjNzYwMDFlMDU0NzYxMDIzYTZlZjRlODE3ZDQyYWQ=", "commit": {"author": {"name": "David Carlier", "email": "devnexen@gmail.com", "date": "2021-07-28T17:22:19Z"}, "committer": {"name": "David Carlier", "email": "devnexen@gmail.com", "date": "2021-07-28T17:22:19Z"}, "message": "thread set_name haiku implementation.", "tree": {"sha": "f481359d002456fb34a8b570414eae1c4bfc4bf1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f481359d002456fb34a8b570414eae1c4bfc4bf1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/52371f4b16c76001e054761023a6ef4e817d42ad", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/52371f4b16c76001e054761023a6ef4e817d42ad", "html_url": "https://github.com/rust-lang/rust/commit/52371f4b16c76001e054761023a6ef4e817d42ad", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/52371f4b16c76001e054761023a6ef4e817d42ad/comments", "author": {"login": "devnexen", "id": 4922778, "node_id": "MDQ6VXNlcjQ5MjI3Nzg=", "avatar_url": "https://avatars.githubusercontent.com/u/4922778?v=4", "gravatar_id": "", "url": "https://api.github.com/users/devnexen", "html_url": "https://github.com/devnexen", "followers_url": "https://api.github.com/users/devnexen/followers", "following_url": "https://api.github.com/users/devnexen/following{/other_user}", "gists_url": "https://api.github.com/users/devnexen/gists{/gist_id}", "starred_url": "https://api.github.com/users/devnexen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/devnexen/subscriptions", "organizations_url": "https://api.github.com/users/devnexen/orgs", "repos_url": "https://api.github.com/users/devnexen/repos", "events_url": "https://api.github.com/users/devnexen/events{/privacy}", "received_events_url": "https://api.github.com/users/devnexen/received_events", "type": "User", "site_admin": false}, "committer": {"login": "devnexen", "id": 4922778, "node_id": "MDQ6VXNlcjQ5MjI3Nzg=", "avatar_url": "https://avatars.githubusercontent.com/u/4922778?v=4", "gravatar_id": "", "url": "https://api.github.com/users/devnexen", "html_url": "https://github.com/devnexen", "followers_url": "https://api.github.com/users/devnexen/followers", "following_url": "https://api.github.com/users/devnexen/following{/other_user}", "gists_url": "https://api.github.com/users/devnexen/gists{/gist_id}", "starred_url": "https://api.github.com/users/devnexen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/devnexen/subscriptions", "organizations_url": "https://api.github.com/users/devnexen/orgs", "repos_url": "https://api.github.com/users/devnexen/repos", "events_url": "https://api.github.com/users/devnexen/events{/privacy}", "received_events_url": "https://api.github.com/users/devnexen/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "eba3228b2a9875d268ff3990903d04e19f6cdb0c", "url": "https://api.github.com/repos/rust-lang/rust/commits/eba3228b2a9875d268ff3990903d04e19f6cdb0c", "html_url": "https://github.com/rust-lang/rust/commit/eba3228b2a9875d268ff3990903d04e19f6cdb0c"}], "stats": {"total": 11, "additions": 9, "deletions": 2}, "files": [{"sha": "bc61f472a2b0501fcbda5f5e4c01a3a61ed58fee", "filename": "library/std/src/sys/unix/thread.rs", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/52371f4b16c76001e054761023a6ef4e817d42ad/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fthread.rs", "raw_url": "https://github.com/rust-lang/rust/raw/52371f4b16c76001e054761023a6ef4e817d42ad/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fthread.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fthread.rs?ref=52371f4b16c76001e054761023a6ef4e817d42ad", "patch": "@@ -164,16 +164,23 @@ impl Thread {\n         }\n     }\n \n+    #[cfg(target_os = \"haiku\")]\n+    pub fn set_name(name: &CStr) {\n+        unsafe {\n+            let thread_self = libc::find_thread(ptr::null_mut());\n+            libc::rename_thread(thread_self, name.as_ptr());\n+        }\n+    }\n+\n     #[cfg(any(\n         target_env = \"newlib\",\n-        target_os = \"haiku\",\n         target_os = \"l4re\",\n         target_os = \"emscripten\",\n         target_os = \"redox\",\n         target_os = \"vxworks\"\n     ))]\n     pub fn set_name(_name: &CStr) {\n-        // Newlib, Haiku, Emscripten, and VxWorks have no way to set a thread name.\n+        // Newlib, Emscripten, and VxWorks have no way to set a thread name.\n     }\n \n     pub fn sleep(dur: Duration) {"}]}