{"sha": "27b9e6d450590751fca863312a8cf10f289cf1f2", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI3YjllNmQ0NTA1OTA3NTFmY2E4NjMzMTJhOGNmMTBmMjg5Y2YxZjI=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-01-12T18:32:28Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-01-12T18:32:28Z"}, "message": "Auto merge of #38569 - chris-morgan:rustdoc-highlight-kw-2, r=steveklabnik\n\nFix rustdoc highlighting of `&` and `*`\n\nWhitespace tokens were included, so the span check used with `&` was incorrect, and it was never highlighted as kw-2 (RefKeyword).\n\nThe `*` in `*foo` and `*const T` should also be highlighted kw-2, so I added them. Note that this *will* cause mishighlighting of code like `1*2`, but that should have been written `1 * 2`. Same deal with `1&2`.", "tree": {"sha": "e4e04470fc45f547949ea16e84f354976d44de40", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e4e04470fc45f547949ea16e84f354976d44de40"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/27b9e6d450590751fca863312a8cf10f289cf1f2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/27b9e6d450590751fca863312a8cf10f289cf1f2", "html_url": "https://github.com/rust-lang/rust/commit/27b9e6d450590751fca863312a8cf10f289cf1f2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/27b9e6d450590751fca863312a8cf10f289cf1f2/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ac5046cf67e51df286e7c8df02d67c302d4c4d09", "url": "https://api.github.com/repos/rust-lang/rust/commits/ac5046cf67e51df286e7c8df02d67c302d4c4d09", "html_url": "https://github.com/rust-lang/rust/commit/ac5046cf67e51df286e7c8df02d67c302d4c4d09"}, {"sha": "c9a6e874cacc7067bf2466f8bc7d154daccd95b1", "url": "https://api.github.com/repos/rust-lang/rust/commits/c9a6e874cacc7067bf2466f8bc7d154daccd95b1", "html_url": "https://github.com/rust-lang/rust/commit/c9a6e874cacc7067bf2466f8bc7d154daccd95b1"}], "stats": {"total": 8, "additions": 5, "deletions": 3}, "files": [{"sha": "a031be8b3c2be598bd34fadcaf0fc62a3df96bae", "filename": "src/librustdoc/html/highlight.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/27b9e6d450590751fca863312a8cf10f289cf1f2/src%2Flibrustdoc%2Fhtml%2Fhighlight.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27b9e6d450590751fca863312a8cf10f289cf1f2/src%2Flibrustdoc%2Fhtml%2Fhighlight.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fhighlight.rs?ref=27b9e6d450590751fca863312a8cf10f289cf1f2", "patch": "@@ -218,9 +218,11 @@ impl<'a> Classifier<'a> {\n             token::Comment => Class::Comment,\n             token::DocComment(..) => Class::DocComment,\n \n-            // If this '&' token is directly adjacent to another token, assume\n-            // that it's the address-of operator instead of the and-operator.\n-            token::BinOp(token::And) if self.lexer.peek().sp.lo == tas.sp.hi => Class::RefKeyWord,\n+            // If this '&' or '*' token is followed by a non-whitespace token, assume that it's the\n+            // reference or dereference operator or a reference or pointer type, instead of the\n+            // bit-and or multiplication operator.\n+            token::BinOp(token::And) | token::BinOp(token::Star)\n+                if self.lexer.peek().tok != token::Whitespace => Class::RefKeyWord,\n \n             // Consider this as part of a macro invocation if there was a\n             // leading identifier."}]}