{"sha": "d2762acb8ce945670ee2249149a5757991591e85", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQyNzYyYWNiOGNlOTQ1NjcwZWUyMjQ5MTQ5YTU3NTc5OTE1OTFlODU=", "commit": {"author": {"name": "Andre Richter", "email": "andre.o.richter@gmail.com", "date": "2019-09-18T13:38:02Z"}, "committer": {"name": "Andre Richter", "email": "andre.o.richter@gmail.com", "date": "2019-09-23T12:15:49Z"}, "message": "Differentiate AArch64 bare-metal targets between hf and non-hf.\n\nFollowing up on [1] and [2], this PR adds differntiation for aarch64 bare-metal\ntargets between versions with and without hardware floating point enabled.\n\nThis streamlines the target naming with other existing ARM targets and provides\nthe user clear indication if he is getting float or non-float for his bare-metal\ntarget.\n\n[1] https://github.com/rust-lang/rust/pull/60135#issuecomment-485851356\n[2] https://github.com/rust-embedded/wg/issues/230\n\nCloses: rust-embedded/wg#230", "tree": {"sha": "29dfe9458aabd81674d3ccc316723556b0a47fc2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/29dfe9458aabd81674d3ccc316723556b0a47fc2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d2762acb8ce945670ee2249149a5757991591e85", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEgYxQvhftoHGii/kEIRbBqxAvYV4FAl2It3cACgkQIRbBqxAv\nYV7ckRAA4Q6vVrhjqaHjjNWCTlpDHQNU8hX34xTMWxv7uOzI1NrnOtTIx6U166gS\nz893C+gu1FDwWYckkFnh2/Ux+9SscvSOZBMySFkKJ46yo/0UqF/g/kYCAkQGwWf1\n3QbHmOaBQL+3HOTHfX/HvZHyJMBc8xyIiMmPUDdKcm0ZjoddYXYFIgF3AgKlNOM+\nRSfwcGkt2AuMh4azUzQwoLgfNxQ5VAq0tG0YXScIadeOkKUnCyqLs8EQVbb7q0mG\nfdmaEyLot6UNPyRiJaiDgoUCtKG6dsCSvCw9q83YfhTYuhU2lPO+GyV2cZL9aKeS\nNDYlRQoV86jmXUtngRs/x9ZVBbHElzPkorO/Wxomxk2dFyXKA/mI8SMuc+kBgqpA\nVU2eLPDkSkz8VlKACM1ljpp9uNJaCGu7A1rXidWeU9gn1YO6GFOkXpD1rZfAzAP8\n/Aiswt5crnV9TJ36ah4dOLG0iEs79VuZK1o1S5AHcBP7SSlSCyESKYe6VaPYHXOA\nZylEZc2XYk3MgMBGej2pVLaYY39vPFDNHA7rgJet/K7HYovtvwjliqR5LWzyMgZI\nvT1pHr455Iiejphy3Ov+Robi91H/YMgYIsvGHzr2bsjSRa7Rik8o5PjjIs67a7jb\n7vDuyp9q3gSimZOwf2He/epe0QIldhqV1injMpKVxunfJtGUCag=\n=ND4o\n-----END PGP SIGNATURE-----", "payload": "tree 29dfe9458aabd81674d3ccc316723556b0a47fc2\nparent 64c09694a6ecc434cd3a61ade89beb1de17770c5\nauthor Andre Richter <andre.o.richter@gmail.com> 1568813882 +0200\ncommitter Andre Richter <andre.o.richter@gmail.com> 1569240949 +0200\n\nDifferentiate AArch64 bare-metal targets between hf and non-hf.\n\nFollowing up on [1] and [2], this PR adds differntiation for aarch64 bare-metal\ntargets between versions with and without hardware floating point enabled.\n\nThis streamlines the target naming with other existing ARM targets and provides\nthe user clear indication if he is getting float or non-float for his bare-metal\ntarget.\n\n[1] https://github.com/rust-lang/rust/pull/60135#issuecomment-485851356\n[2] https://github.com/rust-embedded/wg/issues/230\n\nCloses: rust-embedded/wg#230\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d2762acb8ce945670ee2249149a5757991591e85", "html_url": "https://github.com/rust-lang/rust/commit/d2762acb8ce945670ee2249149a5757991591e85", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d2762acb8ce945670ee2249149a5757991591e85/comments", "author": {"login": "andre-richter", "id": 4130005, "node_id": "MDQ6VXNlcjQxMzAwMDU=", "avatar_url": "https://avatars.githubusercontent.com/u/4130005?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andre-richter", "html_url": "https://github.com/andre-richter", "followers_url": "https://api.github.com/users/andre-richter/followers", "following_url": "https://api.github.com/users/andre-richter/following{/other_user}", "gists_url": "https://api.github.com/users/andre-richter/gists{/gist_id}", "starred_url": "https://api.github.com/users/andre-richter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andre-richter/subscriptions", "organizations_url": "https://api.github.com/users/andre-richter/orgs", "repos_url": "https://api.github.com/users/andre-richter/repos", "events_url": "https://api.github.com/users/andre-richter/events{/privacy}", "received_events_url": "https://api.github.com/users/andre-richter/received_events", "type": "User", "site_admin": false}, "committer": {"login": "andre-richter", "id": 4130005, "node_id": "MDQ6VXNlcjQxMzAwMDU=", "avatar_url": "https://avatars.githubusercontent.com/u/4130005?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andre-richter", "html_url": "https://github.com/andre-richter", "followers_url": "https://api.github.com/users/andre-richter/followers", "following_url": "https://api.github.com/users/andre-richter/following{/other_user}", "gists_url": "https://api.github.com/users/andre-richter/gists{/gist_id}", "starred_url": "https://api.github.com/users/andre-richter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andre-richter/subscriptions", "organizations_url": "https://api.github.com/users/andre-richter/orgs", "repos_url": "https://api.github.com/users/andre-richter/repos", "events_url": "https://api.github.com/users/andre-richter/events{/privacy}", "received_events_url": "https://api.github.com/users/andre-richter/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "64c09694a6ecc434cd3a61ade89beb1de17770c5", "url": "https://api.github.com/repos/rust-lang/rust/commits/64c09694a6ecc434cd3a61ade89beb1de17770c5", "html_url": "https://github.com/rust-lang/rust/commit/64c09694a6ecc434cd3a61ade89beb1de17770c5"}], "stats": {"total": 42, "additions": 40, "deletions": 2}, "files": [{"sha": "b9549ec2120dd82ff101db59c4ce064871b1d9c5", "filename": "src/librustc_target/spec/aarch64_unknown_none.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d2762acb8ce945670ee2249149a5757991591e85/src%2Flibrustc_target%2Fspec%2Faarch64_unknown_none.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d2762acb8ce945670ee2249149a5757991591e85/src%2Flibrustc_target%2Fspec%2Faarch64_unknown_none.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_target%2Fspec%2Faarch64_unknown_none.rs?ref=d2762acb8ce945670ee2249149a5757991591e85", "patch": "@@ -1,4 +1,4 @@\n-// Generic AArch64 target for bare-metal code\n+// Generic AArch64 target for bare-metal code - Floating point enabled\n //\n // Can be used in conjunction with the `target-feature` and\n // `target-cpu` compiler flags to opt-in more hardware-specific\n@@ -11,7 +11,7 @@ use super::{LldFlavor, LinkerFlavor, Target, TargetOptions, PanicStrategy};\n pub fn target() -> Result<Target, String> {\n     let opts = TargetOptions {\n         linker: Some(\"rust-lld\".to_owned()),\n-        features: \"+strict-align\".to_string(),\n+        features: \"+strict-align,+neon,+fp-armv8\".to_string(),\n         executables: true,\n         relocation_model: \"static\".to_string(),\n         disable_redzone: true,"}, {"sha": "b91f2af68ecb85c2e08c51725da9af9254a4af97", "filename": "src/librustc_target/spec/aarch64_unknown_none_softfloat.rs", "status": "added", "additions": 37, "deletions": 0, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/d2762acb8ce945670ee2249149a5757991591e85/src%2Flibrustc_target%2Fspec%2Faarch64_unknown_none_softfloat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d2762acb8ce945670ee2249149a5757991591e85/src%2Flibrustc_target%2Fspec%2Faarch64_unknown_none_softfloat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_target%2Fspec%2Faarch64_unknown_none_softfloat.rs?ref=d2762acb8ce945670ee2249149a5757991591e85", "patch": "@@ -0,0 +1,37 @@\n+// Generic AArch64 target for bare-metal code - Floating point disabled\n+//\n+// Can be used in conjunction with the `target-feature` and\n+// `target-cpu` compiler flags to opt-in more hardware-specific\n+// features.\n+//\n+// For example, `-C target-cpu=cortex-a53`.\n+\n+use super::{LldFlavor, LinkerFlavor, Target, TargetOptions, PanicStrategy};\n+\n+pub fn target() -> Result<Target, String> {\n+    let opts = TargetOptions {\n+        linker: Some(\"rust-lld\".to_owned()),\n+        features: \"+strict-align,-neon,-fp-armv8\".to_string(),\n+        executables: true,\n+        relocation_model: \"static\".to_string(),\n+        disable_redzone: true,\n+        linker_is_gnu: true,\n+        max_atomic_width: Some(128),\n+        panic_strategy: PanicStrategy::Abort,\n+        abi_blacklist: super::arm_base::abi_blacklist(),\n+        .. Default::default()\n+    };\n+    Ok(Target {\n+        llvm_target: \"aarch64-unknown-none\".to_string(),\n+        target_endian: \"little\".to_string(),\n+        target_pointer_width: \"64\".to_string(),\n+        target_c_int_width: \"32\".to_string(),\n+        target_os: \"none\".to_string(),\n+        target_env: String::new(),\n+        target_vendor: String::new(),\n+        data_layout: \"e-m:e-i8:8:32-i16:16:32-i64:64-i128:128-n32:64-S128\".to_string(),\n+        arch: \"aarch64\".to_string(),\n+        linker_flavor: LinkerFlavor::Lld(LldFlavor::Ld),\n+        options: opts,\n+    })\n+}"}, {"sha": "25add0cc6a4be2cede092124a1ed10954cbdf989", "filename": "src/librustc_target/spec/mod.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d2762acb8ce945670ee2249149a5757991591e85/src%2Flibrustc_target%2Fspec%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d2762acb8ce945670ee2249149a5757991591e85/src%2Flibrustc_target%2Fspec%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_target%2Fspec%2Fmod.rs?ref=d2762acb8ce945670ee2249149a5757991591e85", "patch": "@@ -489,6 +489,7 @@ supported_targets! {\n     (\"riscv64gc-unknown-none-elf\", riscv64gc_unknown_none_elf),\n \n     (\"aarch64-unknown-none\", aarch64_unknown_none),\n+    (\"aarch64-unknown-none-softfloat\", aarch64_unknown_none_softfloat),\n \n     (\"x86_64-fortanix-unknown-sgx\", x86_64_fortanix_unknown_sgx),\n "}]}