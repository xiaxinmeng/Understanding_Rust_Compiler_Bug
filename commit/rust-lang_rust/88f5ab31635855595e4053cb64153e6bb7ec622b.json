{"sha": "88f5ab31635855595e4053cb64153e6bb7ec622b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg4ZjVhYjMxNjM1ODU1NTk1ZTQwNTNjYjY0MTUzZTZiYjdlYzYyMmI=", "commit": {"author": {"name": "Elliott Slaughter", "email": "eslaughter@mozilla.com", "date": "2012-08-22T23:55:48Z"}, "committer": {"name": "Elliott Slaughter", "email": "eslaughter@mozilla.com", "date": "2012-09-07T16:21:21Z"}, "message": "gc: Fix for deallocating resources on the shared heap while cleaning stack.", "tree": {"sha": "58fe7723e1e40bf4e0837f28af54bc3e2b25a52d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/58fe7723e1e40bf4e0837f28af54bc3e2b25a52d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/88f5ab31635855595e4053cb64153e6bb7ec622b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/88f5ab31635855595e4053cb64153e6bb7ec622b", "html_url": "https://github.com/rust-lang/rust/commit/88f5ab31635855595e4053cb64153e6bb7ec622b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/88f5ab31635855595e4053cb64153e6bb7ec622b/comments", "author": null, "committer": null, "parents": [{"sha": "3405c548e8f65c9955dfc89188f3cd9db4432bba", "url": "https://api.github.com/repos/rust-lang/rust/commits/3405c548e8f65c9955dfc89188f3cd9db4432bba", "html_url": "https://github.com/rust-lang/rust/commit/3405c548e8f65c9955dfc89188f3cd9db4432bba"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "741fa4de12253a0c5604308e29b9c96d4decbb7f", "filename": "src/libcore/gc.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/88f5ab31635855595e4053cb64153e6bb7ec622b/src%2Flibcore%2Fgc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/88f5ab31635855595e4053cb64153e6bb7ec622b/src%2Flibcore%2Fgc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fgc.rs?ref=88f5ab31635855595e4053cb64153e6bb7ec622b", "patch": "@@ -113,7 +113,8 @@ unsafe fn walk_gc_roots(mem: Memory, visitor: Visitor) {\n                             let refcount = **root;\n                             if mem | task_local_heap != 0 && refcount != -1 {\n                                 if !visitor(root, tydesc) { return; }\n-                            } else if mem | exchange_heap != 0 {\n+                            } else if mem | exchange_heap != 0\n+                                && refcount == -1 {\n                                 if !visitor(root, tydesc) { return; }\n                             }\n                         } else {"}]}