{"sha": "ab085d9aea5625ace47165e7178420ca37c91963", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFiMDg1ZDlhZWE1NjI1YWNlNDcxNjVlNzE3ODQyMGNhMzdjOTE5NjM=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2019-06-17T15:18:31Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2019-06-17T15:18:31Z"}, "message": "Auto merge of #4214 - d-dorazio:4204-fix-float-cmp-neq, r=flip1995\n\nfix suggestion for floating point inequality\n\nIt should be of the form `(a - b).abs() > error` whereas it was `(a - b).abs() < error` that is instead what should be used for equality.\n\nfixes #4204.\n\nchangelog: fix suggestion for floating point inequality", "tree": {"sha": "f9e0977df29057706193f26cf12e3f81db34a466", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f9e0977df29057706193f26cf12e3f81db34a466"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ab085d9aea5625ace47165e7178420ca37c91963", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ab085d9aea5625ace47165e7178420ca37c91963", "html_url": "https://github.com/rust-lang/rust/commit/ab085d9aea5625ace47165e7178420ca37c91963", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ab085d9aea5625ace47165e7178420ca37c91963/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "be5d17feb20534d503c49722beecf5501d5d9c3a", "url": "https://api.github.com/repos/rust-lang/rust/commits/be5d17feb20534d503c49722beecf5501d5d9c3a", "html_url": "https://github.com/rust-lang/rust/commit/be5d17feb20534d503c49722beecf5501d5d9c3a"}, {"sha": "be14ea8c3755a49efea5188cc48345d3e98b7514", "url": "https://api.github.com/repos/rust-lang/rust/commits/be14ea8c3755a49efea5188cc48345d3e98b7514", "html_url": "https://github.com/rust-lang/rust/commit/be14ea8c3755a49efea5188cc48345d3e98b7514"}], "stats": {"total": 14, "additions": 9, "deletions": 5}, "files": [{"sha": "bb43b894cd0954b7626263b5025b9e4369120981", "filename": "clippy_lints/src/misc.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/ab085d9aea5625ace47165e7178420ca37c91963/clippy_lints%2Fsrc%2Fmisc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ab085d9aea5625ace47165e7178420ca37c91963/clippy_lints%2Fsrc%2Fmisc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmisc.rs?ref=ab085d9aea5625ace47165e7178420ca37c91963", "patch": "@@ -387,7 +387,11 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for MiscLints {\n                         db.span_suggestion(\n                             expr.span,\n                             \"consider comparing them within some error\",\n-                            format!(\"({}).abs() < error\", lhs - rhs),\n+                            format!(\n+                                \"({}).abs() {} error\",\n+                                lhs - rhs,\n+                                if op == BinOpKind::Eq { '<' } else { '>' }\n+                            ),\n                             Applicability::MachineApplicable, // snippet\n                         );\n                         db.span_note(expr.span, \"std::f32::EPSILON and std::f64::EPSILON are available.\");"}, {"sha": "5dc5fbf0f6e8aaeac281a667f5c6904b71458048", "filename": "tests/ui/float_cmp.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ab085d9aea5625ace47165e7178420ca37c91963/tests%2Fui%2Ffloat_cmp.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ab085d9aea5625ace47165e7178420ca37c91963/tests%2Fui%2Ffloat_cmp.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ffloat_cmp.stderr?ref=ab085d9aea5625ace47165e7178420ca37c91963", "patch": "@@ -2,7 +2,7 @@ error: strict comparison of f32 or f64\n   --> $DIR/float_cmp.rs:60:5\n    |\n LL |     ONE as f64 != 2.0;\n-   |     ^^^^^^^^^^^^^^^^^ help: consider comparing them within some error: `(ONE as f64 - 2.0).abs() < error`\n+   |     ^^^^^^^^^^^^^^^^^ help: consider comparing them within some error: `(ONE as f64 - 2.0).abs() > error`\n    |\n    = note: `-D clippy::float-cmp` implied by `-D warnings`\n note: std::f32::EPSILON and std::f64::EPSILON are available.\n@@ -27,7 +27,7 @@ error: strict comparison of f32 or f64\n   --> $DIR/float_cmp.rs:68:5\n    |\n LL |     twice(x) != twice(ONE as f64);\n-   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: consider comparing them within some error: `(twice(x) - twice(ONE as f64)).abs() < error`\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: consider comparing them within some error: `(twice(x) - twice(ONE as f64)).abs() > error`\n    |\n note: std::f32::EPSILON and std::f64::EPSILON are available.\n   --> $DIR/float_cmp.rs:68:5"}, {"sha": "48e92fa44ab8e7f1c98a0d7e8e1386282c12b393", "filename": "tests/ui/float_cmp_const.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ab085d9aea5625ace47165e7178420ca37c91963/tests%2Fui%2Ffloat_cmp_const.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ab085d9aea5625ace47165e7178420ca37c91963/tests%2Fui%2Ffloat_cmp_const.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ffloat_cmp_const.stderr?ref=ab085d9aea5625ace47165e7178420ca37c91963", "patch": "@@ -27,7 +27,7 @@ error: strict comparison of f32 or f64 constant\n   --> $DIR/float_cmp_const.rs:20:5\n    |\n LL |     TWO != ONE;\n-   |     ^^^^^^^^^^ help: consider comparing them within some error: `(TWO - ONE).abs() < error`\n+   |     ^^^^^^^^^^ help: consider comparing them within some error: `(TWO - ONE).abs() > error`\n    |\n note: std::f32::EPSILON and std::f64::EPSILON are available.\n   --> $DIR/float_cmp_const.rs:20:5\n@@ -75,7 +75,7 @@ error: strict comparison of f32 or f64 constant\n   --> $DIR/float_cmp_const.rs:27:5\n    |\n LL |     v != ONE;\n-   |     ^^^^^^^^ help: consider comparing them within some error: `(v - ONE).abs() < error`\n+   |     ^^^^^^^^ help: consider comparing them within some error: `(v - ONE).abs() > error`\n    |\n note: std::f32::EPSILON and std::f64::EPSILON are available.\n   --> $DIR/float_cmp_const.rs:27:5"}]}