{"sha": "b86620a558dd662fe4261b8c0a2798b7c3d1f068", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI4NjYyMGE1NThkZDY2MmZlNDI2MWI4YzBhMjc5OGI3YzNkMWYwNjg=", "commit": {"author": {"name": "Dylan DPC", "email": "dylan.dpc@gmail.com", "date": "2020-05-06T11:22:22Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-05-06T11:22:22Z"}, "message": "Rollup merge of #71921 - RalfJung:open-mode, r=hanna-kruppe\n\nexplain the types used in the open64 call\n\nFixes https://github.com/rust-lang/rust/issues/71915, where I learned about this quirk. I don't actually know what I am talking about here. ;)", "tree": {"sha": "37c3fb4745e7d4415233d21c70eba1595fca85cc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/37c3fb4745e7d4415233d21c70eba1595fca85cc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b86620a558dd662fe4261b8c0a2798b7c3d1f068", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJesp3vCRBK7hj4Ov3rIwAAdHIIAEZXclCoGtAKThDcs27crL4m\ne7KK/yEHDK7F6PJrnQknQxVCMKWNICqXBDL8rcn1wt89MipTLiS4vG0u1XjrkDEh\ntW6vM5O12S3XVz/32AdDCBRruhGqQk2Qn6+9JHuJkvVD3Bj428Yc8fF6LiOhHCrN\nUaBcKYaQ9WInYoCmMrltfZ4I+dSPJEW7+jcN8IfENQiPhIaDdFU7QNvwRYsDiJIg\nE23dRNAt7Ck1IyFtc6hJgce+JY+WmlIJBKeSMmbp3JET9Uz5mhWV75SGMXdqfBl2\noJdTCPSqZIeBG+s29a3OJ1hdcQhzx88fSFTFqyAE+XnHel482j0aznS03rlSJv4=\n=RK5U\n-----END PGP SIGNATURE-----\n", "payload": "tree 37c3fb4745e7d4415233d21c70eba1595fca85cc\nparent f29a92366e06b43da52929a14ac4931b218cb3fc\nparent fbf791bd5259ebbf7575db245a2cffd0f59a15a8\nauthor Dylan DPC <dylan.dpc@gmail.com> 1588764142 +0200\ncommitter GitHub <noreply@github.com> 1588764142 +0200\n\nRollup merge of #71921 - RalfJung:open-mode, r=hanna-kruppe\n\nexplain the types used in the open64 call\n\nFixes https://github.com/rust-lang/rust/issues/71915, where I learned about this quirk. I don't actually know what I am talking about here. ;)\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b86620a558dd662fe4261b8c0a2798b7c3d1f068", "html_url": "https://github.com/rust-lang/rust/commit/b86620a558dd662fe4261b8c0a2798b7c3d1f068", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b86620a558dd662fe4261b8c0a2798b7c3d1f068/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f29a92366e06b43da52929a14ac4931b218cb3fc", "url": "https://api.github.com/repos/rust-lang/rust/commits/f29a92366e06b43da52929a14ac4931b218cb3fc", "html_url": "https://github.com/rust-lang/rust/commit/f29a92366e06b43da52929a14ac4931b218cb3fc"}, {"sha": "fbf791bd5259ebbf7575db245a2cffd0f59a15a8", "url": "https://api.github.com/repos/rust-lang/rust/commits/fbf791bd5259ebbf7575db245a2cffd0f59a15a8", "html_url": "https://github.com/rust-lang/rust/commit/fbf791bd5259ebbf7575db245a2cffd0f59a15a8"}], "stats": {"total": 4, "additions": 4, "deletions": 0}, "files": [{"sha": "80cf6a5dbc27b181747f4adc7c80637a9d399fbb", "filename": "src/libstd/sys/unix/fs.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b86620a558dd662fe4261b8c0a2798b7c3d1f068/src%2Flibstd%2Fsys%2Funix%2Ffs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b86620a558dd662fe4261b8c0a2798b7c3d1f068/src%2Flibstd%2Fsys%2Funix%2Ffs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Funix%2Ffs.rs?ref=b86620a558dd662fe4261b8c0a2798b7c3d1f068", "patch": "@@ -703,6 +703,10 @@ impl File {\n             | opts.get_access_mode()?\n             | opts.get_creation_mode()?\n             | (opts.custom_flags as c_int & !libc::O_ACCMODE);\n+        // The third argument of `open64` is documented to have type `mode_t`. On\n+        // some platforms (like macOS, where `open64` is actually `open`), `mode_t` is `u16`.\n+        // However, since this is a variadic function, C integer promotion rules mean that on\n+        // the ABI level, this still gets passed as `c_int` (aka `u32` on Unix platforms).\n         let fd = cvt_r(|| unsafe { open64(path.as_ptr(), flags, opts.mode as c_int) })?;\n         let fd = FileDesc::new(fd);\n "}]}