{"sha": "ba8620398713d6f116dd1cce1a7e1cd6e3f97461", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJhODYyMDM5ODcxM2Q2ZjExNmRkMWNjZTFhN2UxY2Q2ZTNmOTc0NjE=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2021-05-07T19:47:09Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-05-07T19:47:09Z"}, "message": "Merge #8752\n\n8752: Switch from jemalloc to tikv-jemalloc r=matklad a=djrenren\n\nFixes https://github.com/rust-analyzer/rust-analyzer/issues/8252.\r\n\r\nNo idea if we're still interested in this but it was a simple change so here's the PR.\n\nCo-authored-by: John Renner <john@jrenner.net>", "tree": {"sha": "a08967ef47b1f0f0d9468dd89bf34bb566160012", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a08967ef47b1f0f0d9468dd89bf34bb566160012"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ba8620398713d6f116dd1cce1a7e1cd6e3f97461", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJglZk9CRBK7hj4Ov3rIwAAPqEIAGhAPhXds4yjzg6HnLcLHHW+\nzvt7K6G1GNVVkj66m9y4dV0E+jq0d1DlaxhymbMh2ySzuK/ARh+vLnKc/W55oxA4\nLhSDzoibFkbCyFM1M4joE0B/JMn4FWbbX3CGpHh3cGHkxzELkgWcFWFfywdX7dFg\nAP/uWKPIDuB0ZX5LOt9HD8APEkaMxF6fLxF7J+KvPs4to0AANGZLEibQzdWYVRzy\nwLtQqeXnyA67tG+vKV4WRvgFnG/vo0xENGCUv+MqJzdp0e9C//Bt7Xzw1ZupeQcf\nLKsE60DqPgVLU7y3v8LQwUkqaJl65NCs/FCAzdNMPwXdYXVz5IcyTOJJ4eN+ECw=\n=i3Xp\n-----END PGP SIGNATURE-----\n", "payload": "tree a08967ef47b1f0f0d9468dd89bf34bb566160012\nparent 1ec82d4bdf47fa5ec1f8599757bbadae274d4f5a\nparent 4059112b4e6fbe6fd1b9c6640c031a2c346f6225\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1620416829 +0000\ncommitter GitHub <noreply@github.com> 1620416829 +0000\n\nMerge #8752\n\n8752: Switch from jemalloc to tikv-jemalloc r=matklad a=djrenren\n\nFixes https://github.com/rust-analyzer/rust-analyzer/issues/8252.\r\n\r\nNo idea if we're still interested in this but it was a simple change so here's the PR.\n\nCo-authored-by: John Renner <john@jrenner.net>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ba8620398713d6f116dd1cce1a7e1cd6e3f97461", "html_url": "https://github.com/rust-lang/rust/commit/ba8620398713d6f116dd1cce1a7e1cd6e3f97461", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ba8620398713d6f116dd1cce1a7e1cd6e3f97461/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1ec82d4bdf47fa5ec1f8599757bbadae274d4f5a", "url": "https://api.github.com/repos/rust-lang/rust/commits/1ec82d4bdf47fa5ec1f8599757bbadae274d4f5a", "html_url": "https://github.com/rust-lang/rust/commit/1ec82d4bdf47fa5ec1f8599757bbadae274d4f5a"}, {"sha": "4059112b4e6fbe6fd1b9c6640c031a2c346f6225", "url": "https://api.github.com/repos/rust-lang/rust/commits/4059112b4e6fbe6fd1b9c6640c031a2c346f6225", "html_url": "https://github.com/rust-lang/rust/commit/4059112b4e6fbe6fd1b9c6640c031a2c346f6225"}], "stats": {"total": 72, "additions": 36, "deletions": 36}, "files": [{"sha": "f3a512a8a79fddffdd4608abe27e424c187f9c43", "filename": "Cargo.lock", "status": "modified", "additions": 34, "deletions": 34, "changes": 68, "blob_url": "https://github.com/rust-lang/rust/blob/ba8620398713d6f116dd1cce1a7e1cd6e3f97461/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/ba8620398713d6f116dd1cce1a7e1cd6e3f97461/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=ba8620398713d6f116dd1cce1a7e1cd6e3f97461", "patch": "@@ -749,38 +749,6 @@ version = \"0.4.7\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"dd25036021b0de88a0aff6b850051563c6516d0bf53f8638938edbb9de732736\"\n \n-[[package]]\n-name = \"jemalloc-ctl\"\n-version = \"0.3.3\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"c502a5ff9dd2924f1ed32ba96e3b65735d837b4bfd978d3161b1702e66aca4b7\"\n-dependencies = [\n- \"jemalloc-sys\",\n- \"libc\",\n- \"paste\",\n-]\n-\n-[[package]]\n-name = \"jemalloc-sys\"\n-version = \"0.3.2\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"0d3b9f3f5c9b31aa0f5ed3260385ac205db665baa41d49bb8338008ae94ede45\"\n-dependencies = [\n- \"cc\",\n- \"fs_extra\",\n- \"libc\",\n-]\n-\n-[[package]]\n-name = \"jemallocator\"\n-version = \"0.3.2\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"43ae63fcfc45e99ab3d1b29a46782ad679e98436c3169d15a167a1108a724b69\"\n-dependencies = [\n- \"jemalloc-sys\",\n- \"libc\",\n-]\n-\n [[package]]\n name = \"jod-thread\"\n version = \"0.1.2\"\n@@ -1201,11 +1169,11 @@ version = \"0.0.0\"\n dependencies = [\n  \"cfg-if\",\n  \"countme\",\n- \"jemalloc-ctl\",\n  \"la-arena\",\n  \"libc\",\n  \"once_cell\",\n  \"perf-event\",\n+ \"tikv-jemalloc-ctl\",\n ]\n \n [[package]]\n@@ -1349,7 +1317,6 @@ dependencies = [\n  \"ide_db\",\n  \"ide_ssr\",\n  \"itertools\",\n- \"jemallocator\",\n  \"jod-thread\",\n  \"log\",\n  \"lsp-server\",\n@@ -1371,6 +1338,7 @@ dependencies = [\n  \"test_utils\",\n  \"text_edit\",\n  \"threadpool\",\n+ \"tikv-jemallocator\",\n  \"toolchain\",\n  \"tracing\",\n  \"tracing-subscriber\",\n@@ -1669,6 +1637,38 @@ dependencies = [\n  \"num_cpus\",\n ]\n \n+[[package]]\n+name = \"tikv-jemalloc-ctl\"\n+version = \"0.4.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"f28c80e4338857639f443169a601fafe49866aed8d7a8d565c2f5bfb1a021adf\"\n+dependencies = [\n+ \"libc\",\n+ \"paste\",\n+ \"tikv-jemalloc-sys\",\n+]\n+\n+[[package]]\n+name = \"tikv-jemalloc-sys\"\n+version = \"0.4.1+5.2.1-patched\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"8a26331b05179d4cb505c8d6814a7e18d298972f0a551b0e3cefccff927f86d3\"\n+dependencies = [\n+ \"cc\",\n+ \"fs_extra\",\n+ \"libc\",\n+]\n+\n+[[package]]\n+name = \"tikv-jemallocator\"\n+version = \"0.4.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"3c14a5a604eb8715bc5785018a37d00739b180bcf609916ddf4393d33d49ccdf\"\n+dependencies = [\n+ \"libc\",\n+ \"tikv-jemalloc-sys\",\n+]\n+\n [[package]]\n name = \"tinyvec\"\n version = \"1.2.0\""}, {"sha": "1a8c8f862c2851b13e7ef9a1c2d7782e7c5cc1d1", "filename": "crates/profile/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ba8620398713d6f116dd1cce1a7e1cd6e3f97461/crates%2Fprofile%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/ba8620398713d6f116dd1cce1a7e1cd6e3f97461/crates%2Fprofile%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fprofile%2FCargo.toml?ref=ba8620398713d6f116dd1cce1a7e1cd6e3f97461", "patch": "@@ -15,7 +15,7 @@ cfg-if = \"1\"\n libc = \"0.2.73\"\n la-arena = { version = \"0.2.0\", path = \"../../lib/arena\" }\n countme = { version = \"2.0.1\", features = [\"enable\"] }\n-jemalloc-ctl = { version = \"0.3.3\", optional = true }\n+jemalloc-ctl = { version = \"0.4.1\", package = \"tikv-jemalloc-ctl\", optional = true }\n \n [target.'cfg(target_os = \"linux\")'.dependencies]\n perf-event = \"0.4\""}, {"sha": "3010815df7fb54562e0435d599edfbff70809d2d", "filename": "crates/rust-analyzer/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ba8620398713d6f116dd1cce1a7e1cd6e3f97461/crates%2Frust-analyzer%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/ba8620398713d6f116dd1cce1a7e1cd6e3f97461/crates%2Frust-analyzer%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2FCargo.toml?ref=ba8620398713d6f116dd1cce1a7e1cd6e3f97461", "patch": "@@ -63,7 +63,7 @@ proc_macro_srv = { path = \"../proc_macro_srv\", version = \"0.0.0\" }\n winapi = \"0.3.8\"\n \n [target.'cfg(not(target_env = \"msvc\"))'.dependencies]\n-jemallocator = { version = \"0.3.2\", optional = true }\n+jemallocator = { version = \"0.4.1\", package = \"tikv-jemallocator\", optional = true }\n \n [dev-dependencies]\n expect-test = \"1.1\""}]}