{"sha": "9073acdc9888acd2ba66601a77b96fbda67ac8c7", "node_id": "MDY6Q29tbWl0NzI0NzEyOjkwNzNhY2RjOTg4OGFjZDJiYTY2NjAxYTc3Yjk2ZmJkYTY3YWM4Yzc=", "commit": {"author": {"name": "Adam Reichold", "email": "adam.reichold@t-online.de", "date": "2020-08-05T14:56:51Z"}, "committer": {"name": "Adam Reichold", "email": "adam.reichold@t-online.de", "date": "2020-08-05T15:15:08Z"}, "message": "Add fallback for cfg(unix) targets that do not define libc::_SC_IOV_MAX.", "tree": {"sha": "cd375c98b72d1a949d7d6e2ff7a56f606b20f99a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cd375c98b72d1a949d7d6e2ff7a56f606b20f99a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9073acdc9888acd2ba66601a77b96fbda67ac8c7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9073acdc9888acd2ba66601a77b96fbda67ac8c7", "html_url": "https://github.com/rust-lang/rust/commit/9073acdc9888acd2ba66601a77b96fbda67ac8c7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9073acdc9888acd2ba66601a77b96fbda67ac8c7/comments", "author": {"login": "adamreichold", "id": 12997846, "node_id": "MDQ6VXNlcjEyOTk3ODQ2", "avatar_url": "https://avatars.githubusercontent.com/u/12997846?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adamreichold", "html_url": "https://github.com/adamreichold", "followers_url": "https://api.github.com/users/adamreichold/followers", "following_url": "https://api.github.com/users/adamreichold/following{/other_user}", "gists_url": "https://api.github.com/users/adamreichold/gists{/gist_id}", "starred_url": "https://api.github.com/users/adamreichold/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adamreichold/subscriptions", "organizations_url": "https://api.github.com/users/adamreichold/orgs", "repos_url": "https://api.github.com/users/adamreichold/repos", "events_url": "https://api.github.com/users/adamreichold/events{/privacy}", "received_events_url": "https://api.github.com/users/adamreichold/received_events", "type": "User", "site_admin": false}, "committer": {"login": "adamreichold", "id": 12997846, "node_id": "MDQ6VXNlcjEyOTk3ODQ2", "avatar_url": "https://avatars.githubusercontent.com/u/12997846?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adamreichold", "html_url": "https://github.com/adamreichold", "followers_url": "https://api.github.com/users/adamreichold/followers", "following_url": "https://api.github.com/users/adamreichold/following{/other_user}", "gists_url": "https://api.github.com/users/adamreichold/gists{/gist_id}", "starred_url": "https://api.github.com/users/adamreichold/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adamreichold/subscriptions", "organizations_url": "https://api.github.com/users/adamreichold/orgs", "repos_url": "https://api.github.com/users/adamreichold/repos", "events_url": "https://api.github.com/users/adamreichold/events{/privacy}", "received_events_url": "https://api.github.com/users/adamreichold/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "04a0114e7ecc44049425aaf8f7ba7f66da80e0c4", "url": "https://api.github.com/repos/rust-lang/rust/commits/04a0114e7ecc44049425aaf8f7ba7f66da80e0c4", "html_url": "https://github.com/rust-lang/rust/commit/04a0114e7ecc44049425aaf8f7ba7f66da80e0c4"}], "stats": {"total": 7, "additions": 7, "deletions": 0}, "files": [{"sha": "e36a53084bae1874a92be0ba1056e7edf691f899", "filename": "library/std/src/sys/unix/fd.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/9073acdc9888acd2ba66601a77b96fbda67ac8c7/library%2Fstd%2Fsrc%2Fsys%2Funix%2Ffd.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9073acdc9888acd2ba66601a77b96fbda67ac8c7/library%2Fstd%2Fsrc%2Fsys%2Funix%2Ffd.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Ffd.rs?ref=9073acdc9888acd2ba66601a77b96fbda67ac8c7", "patch": "@@ -3,6 +3,7 @@\n use crate::cmp;\n use crate::io::{self, Initializer, IoSlice, IoSliceMut, Read};\n use crate::mem;\n+#[cfg(not(any(target_os = \"redox\", target_env = \"newlib\")))]\n use crate::sync::atomic::{AtomicUsize, Ordering};\n use crate::sys::cvt;\n use crate::sys_common::AsInner;\n@@ -27,6 +28,7 @@ const READ_LIMIT: usize = c_int::MAX as usize - 1;\n #[cfg(not(target_os = \"macos\"))]\n const READ_LIMIT: usize = libc::ssize_t::MAX as usize;\n \n+#[cfg(not(any(target_os = \"redox\", target_env = \"newlib\")))]\n fn max_iov() -> usize {\n     static LIM: AtomicUsize = AtomicUsize::new(0);\n \n@@ -42,6 +44,11 @@ fn max_iov() -> usize {\n     lim\n }\n \n+#[cfg(any(target_os = \"redox\", target_env = \"newlib\"))]\n+fn max_iov() -> usize {\n+    16 // The minimum value required by POSIX.\n+}\n+\n impl FileDesc {\n     pub fn new(fd: c_int) -> FileDesc {\n         FileDesc { fd }"}]}