{"sha": "fb9f3e6dec8b1b6296c10abcbfdf59ce957bce09", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZiOWYzZTZkZWM4YjFiNjI5NmMxMGFiY2JmZGY1OWNlOTU3YmNlMDk=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2019-07-26T11:10:44Z"}, "committer": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2019-07-26T16:51:01Z"}, "message": "ci: add debug checks for pypi network outages", "tree": {"sha": "ff82a350484710442959cea65dcaa7f0d7ad8e02", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ff82a350484710442959cea65dcaa7f0d7ad8e02"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fb9f3e6dec8b1b6296c10abcbfdf59ce957bce09", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE1JbYPtLJAsc22U9xPgar6Auq8ZwFAl07L3YACgkQPgar6Auq\n8ZzgdA/+IjjBMbLQf4aRy8SO3vVbt4XPt+95atOpM/MmqMd5O/0zE+/2GgLQuxHv\nvDaNwIzqvX+TWpHrVMbv7akLvbg16p/i+t/NZXHd4JFdbC52rKSROq56cXYanL8q\nbdpWoWo5HrbBunGV8ukg314uZvjpel2aLQsSqCJWWnb3k+5vYgF/NbNphLl2guyb\nwlv8ZU6HlEKQvwkwog8l3OeR0F9YdzrqDbtAa1ltm7Z4CDKi0QDL0jmWl0isLU6o\nDe5ckE4HbBiroH9JBvNu+XwJRXgyJXD74GPCG3OJ6dFtLOgkCllw1/7mb51tSKve\nvTLt/tECCU0lFMUt52OCys0gpuO4/BnehFRnmC8eeyuHwgmJQZ1Sx5LkoMOsqYn8\n3YO53y0C8o/8fsBwzK6ElkqgxhH+zwhkdUc4D/iLLuhUNAPXdQQ0wx9DMhzGxkna\nJdZBqVaaVm3XfwSz/ml9D+WB2miVklWmc18wDJPw7xxbEcY1x21tCNiBGUS/S84S\nP2TXog8LnIUDSjBaCqmuY8ru1jcqoncrrEg3Kyjum3qD0iLn8z/KuMIdrQisbiLK\nQa1eQyjc6Atm4gX6jG+UMRsZ/EPwPy4aGrBF6tSfezeMlB94YUnExTFVgjSOLjg4\nvgvqbuWYobpnGutYAlK1WhzMYBJ21cy0Jez1H1RfJ7ucHxpXBrM=\n=DozF\n-----END PGP SIGNATURE-----", "payload": "tree ff82a350484710442959cea65dcaa7f0d7ad8e02\nparent a7f28678bbf4e16893bb6a718e427504167a9494\nauthor Pietro Albini <pietro@pietroalbini.org> 1564139444 +0200\ncommitter Pietro Albini <pietro@pietroalbini.org> 1564159861 +0200\n\nci: add debug checks for pypi network outages\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fb9f3e6dec8b1b6296c10abcbfdf59ce957bce09", "html_url": "https://github.com/rust-lang/rust/commit/fb9f3e6dec8b1b6296c10abcbfdf59ce957bce09", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fb9f3e6dec8b1b6296c10abcbfdf59ce957bce09/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a7f28678bbf4e16893bb6a718e427504167a9494", "url": "https://api.github.com/repos/rust-lang/rust/commits/a7f28678bbf4e16893bb6a718e427504167a9494", "html_url": "https://github.com/rust-lang/rust/commit/a7f28678bbf4e16893bb6a718e427504167a9494"}], "stats": {"total": 28, "additions": 27, "deletions": 1}, "files": [{"sha": "015fd8348855038e5c3aa79c3cd7a25c56414a56", "filename": ".azure-pipelines/steps/run.yml", "status": "modified", "additions": 27, "deletions": 1, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/fb9f3e6dec8b1b6296c10abcbfdf59ce957bce09/.azure-pipelines%2Fsteps%2Frun.yml", "raw_url": "https://github.com/rust-lang/rust/raw/fb9f3e6dec8b1b6296c10abcbfdf59ce957bce09/.azure-pipelines%2Fsteps%2Frun.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.azure-pipelines%2Fsteps%2Frun.yml?ref=fb9f3e6dec8b1b6296c10abcbfdf59ce957bce09", "patch": "@@ -140,9 +140,35 @@ steps:\n # images, etc.\n - bash: |\n     set -e\n+    # Temporary code to debug #62967.\n+    debug_failed_connections() {\n+        echo \"trying to ping pypi.org\"\n+        ping pypi.org -c10 || true\n+        echo \"trying to ping google.com\"\n+        ping google.com -c10 || true\n+        echo \"trying to ping 8.8.8.8\"\n+        ping 8.8.8.8 -c10 || true\n+        echo \"trying to download pypi.org\"\n+        curl https://pypi.org || true\n+        echo \"trying to download from our S3 bucket\"\n+        curl https://rust-lang-ci2.s3.amazonaws.com || true\n+        echo \"trying to dig pypi.org\"\n+        dig pypi.org || true\n+        echo \"trying to dig files.pythonhosted.org\"\n+        dig files.pythonhosted.org || true\n+        echo \"trying to connect to pypi.org with openssl\"\n+        echo | openssl s_client -connect pypi.org:443 || true\n+        echo \"trying to connect to files.pythonhosted.org with openssl\"\n+        echo | openssl s_client -connect files.pythonhosted.org:443 || true\n+    }\n+    debug_failed_connections_and_fail() {\n+        debug_failed_connections\n+        return 1\n+    }\n     source src/ci/shared.sh\n     sudo apt-get install -y python3-setuptools\n-    retry pip3 install -r src/ci/awscli-requirements.txt --upgrade --user\n+    debug_failed_connections\n+    retry pip3 install -r src/ci/awscli-requirements.txt --upgrade --user || debug_failed_connections_and_fail\n     echo \"##vso[task.prependpath]$HOME/.local/bin\"\n   displayName: Install awscli (Linux)\n   condition: and(succeeded(), not(variables.SKIP_JOB), eq(variables['Agent.OS'], 'Linux'))"}]}