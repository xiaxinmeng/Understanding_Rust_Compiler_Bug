{"sha": "1f2c18a0afd55bf3a5319d9e3810ec1ac6b3e1bb", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFmMmMxOGEwYWZkNTViZjNhNTMxOWQ5ZTM4MTBlYzFhYzZiM2UxYmI=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2014-04-08T22:10:41Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2014-04-10T22:22:01Z"}, "message": "rustc: Don't allow priv use to shadow pub use\n\nPreviously, a private use statement would shadow a public use statement, all of\na sudden publicly exporting the privately used item. The correct behavior here\nis to only shadow the use for the module in question, but for now it just\nreverts the entire name to private so the pub use doesn't have much effect.\n\nThe behavior isn't exactly what we want, but this no longer has backwards\ncompatibility hazards.", "tree": {"sha": "7cae8ac126922eee38607c2a0032c85cdad7ba0d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7cae8ac126922eee38607c2a0032c85cdad7ba0d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1f2c18a0afd55bf3a5319d9e3810ec1ac6b3e1bb", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1f2c18a0afd55bf3a5319d9e3810ec1ac6b3e1bb", "html_url": "https://github.com/rust-lang/rust/commit/1f2c18a0afd55bf3a5319d9e3810ec1ac6b3e1bb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1f2c18a0afd55bf3a5319d9e3810ec1ac6b3e1bb/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "df533c6e87f5052667b0c03c918f95b51439fdba", "url": "https://api.github.com/repos/rust-lang/rust/commits/df533c6e87f5052667b0c03c918f95b51439fdba", "html_url": "https://github.com/rust-lang/rust/commit/df533c6e87f5052667b0c03c918f95b51439fdba"}], "stats": {"total": 35, "additions": 34, "deletions": 1}, "files": [{"sha": "38eab354f2bd86cbd9cfac8cc66ac588df3bfc2b", "filename": "src/librustc/middle/resolve.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/1f2c18a0afd55bf3a5319d9e3810ec1ac6b3e1bb/src%2Flibrustc%2Fmiddle%2Fresolve.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1f2c18a0afd55bf3a5319d9e3810ec1ac6b3e1bb/src%2Flibrustc%2Fmiddle%2Fresolve.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fresolve.rs?ref=1f2c18a0afd55bf3a5319d9e3810ec1ac6b3e1bb", "patch": "@@ -1982,6 +1982,7 @@ impl<'a> Resolver<'a> {\n                         // the source of this name is different now\n                         resolution.type_id.set(id);\n                         resolution.value_id.set(id);\n+                        resolution.is_public.set(is_public);\n                     }\n                     None => {\n                         debug!(\"(building import directive) creating new\");"}, {"sha": "dd874fecc52a5d32de0a6f7982bbc3e73294a6ea", "filename": "src/libstd/io/test.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/1f2c18a0afd55bf3a5319d9e3810ec1ac6b3e1bb/src%2Flibstd%2Fio%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1f2c18a0afd55bf3a5319d9e3810ec1ac6b3e1bb/src%2Flibstd%2Fio%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fio%2Ftest.rs?ref=1f2c18a0afd55bf3a5319d9e3810ec1ac6b3e1bb", "patch": "@@ -39,7 +39,6 @@ macro_rules! iotest (\n             use io::process::*;\n             use unstable::running_on_valgrind;\n             use str;\n-            use util;\n \n             fn f() $b\n "}, {"sha": "0830722f9692950209511cc60a330788f0f5b541", "filename": "src/test/compile-fail/resolve-priv-shadowing-pub.rs", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/1f2c18a0afd55bf3a5319d9e3810ec1ac6b3e1bb/src%2Ftest%2Fcompile-fail%2Fresolve-priv-shadowing-pub.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1f2c18a0afd55bf3a5319d9e3810ec1ac6b3e1bb/src%2Ftest%2Fcompile-fail%2Fresolve-priv-shadowing-pub.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fresolve-priv-shadowing-pub.rs?ref=1f2c18a0afd55bf3a5319d9e3810ec1ac6b3e1bb", "patch": "@@ -0,0 +1,33 @@\n+// Copyright 2014 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+mod a {\n+    pub fn foobar() -> int { 1 }\n+}\n+\n+mod b {\n+    pub fn foobar() -> int { 2 }\n+}\n+\n+mod c {\n+    // Technically the second use shadows the first, but in theory it should\n+    // only be shadowed for this module. The implementation of resolve currently\n+    // doesn't implement this, so this test is ensuring that using \"c::foobar\"\n+    // is *not* getting b::foobar. Today it's an error, but perhaps one day it\n+    // can correctly get a::foobar instead.\n+    pub use a::foobar;\n+    use b::foobar;\n+}\n+\n+fn main() {\n+    assert_eq!(c::foobar(), 1);\n+    //~^ ERROR: unresolved name `c::foobar`\n+}\n+"}]}