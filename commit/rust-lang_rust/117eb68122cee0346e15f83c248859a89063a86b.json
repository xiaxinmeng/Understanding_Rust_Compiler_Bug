{"sha": "117eb68122cee0346e15f83c248859a89063a86b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjExN2ViNjgxMjJjZWUwMzQ2ZTE1ZjgzYzI0ODg1OWE4OTA2M2E4NmI=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-01-23T09:03:43Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-01-23T14:30:58Z"}, "message": "Rollup merge of #47655 - etaoins:fix-spurious-warning-on-empty-proc-macro-crate, r=alexcrichton\n\nFix spurious warning on empty proc macro crates\n\nWhile attempting to reproduce rust-lang/rust#47086 I noticed the following warning:\n\n```shell\n> rustc /dev/null --crate-type proc-macro\nwarning: unused variable: `registrar`\n --> /dev/null:0:1\n```\n\nAs there are no macros to register the automatically generated registrar function for the crate has no body. As a result its `registrar` argument is unused triggering the above warning.\n\nThe warning is confusing and not easily actionable by the developer. It could also be triggered legitimately by e.g. having all of the macros in a crate #[cfg]'ed out.\n\nFix by naming the generated argument `_registrar` inside `mk_registrar()`. This suppresses the unused variable warning.", "tree": {"sha": "fc485ed15f61814434e4665f899d344f04fabb9f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fc485ed15f61814434e4665f899d344f04fabb9f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/117eb68122cee0346e15f83c248859a89063a86b", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlpnRyIACgkQ/vbIBR0O\nATzGGRAAkXupNHn1ZhHWV42aEPSxFGD0H+rhvDQV2vQp2jYNOQv+ZXLmfCQ/Yu6x\nDhUneHMXbckkRkAe668+txfWa4fSEw62UcTezP/5rm8bmIYZg+RVmqlWBIgpL4S+\nYLGkFX6MHmwmRA8YHlWQoxdVZOp8Sg+qsSi6JZncstPx5U4y035msR+j4/ZzRv8N\nFQS0BaFr+K+nuWeItJEf0tnQF7YSV7A1d7nzQ87VuYez4uMZi9mqL9eSXd6RJZ3e\nUwErWmybC2WFSZ28843ZjmkL+N4lMbCWiB7CuULonZhym5XpRHtgoiebJscLb0op\nX4SguFNpN/FlrW2u7YCwi/1ScmXUFH2CJOkakAhUQNAY839NOBhduracbl2le7zj\nU1kOahlF7RJEPF2UBuWO2B9fIw0K5sQTeVCEGGCsX++tVd3axpdYLQNJw1pQ3Tj7\nBKWuGX9g3QNTzYEgwiKlsowPgSL0MnJn4ZflRmllJ0ViOqWYNQqH0cXWCjiVNQX2\n0MN+lV+kVhvejif3dEXedPd8y498juZ095mmV818pEFXaff6y7gbZsi1rcwmb1fs\neAkXEEeVJj43+5b0fwFQ2KGVE8sx0ONH8sI1n4cqkWq9XT/ZfG7klAkHsC3cbDHs\nC9oX3gH1cEEowrTDZm7GJaZCEUJBdzGO32iUBZ59OshJjRdIgKc=\n=JNAC\n-----END PGP SIGNATURE-----", "payload": "tree fc485ed15f61814434e4665f899d344f04fabb9f\nparent 9d26a25bb627e8cee8476331cf25212a5aacebd1\nparent e1bffbdf66cecc442e8d9e20642df82a155e2aa0\nauthor kennytm <kennytm@gmail.com> 1516698223 +0800\ncommitter kennytm <kennytm@gmail.com> 1516717858 +0800\n\nRollup merge of #47655 - etaoins:fix-spurious-warning-on-empty-proc-macro-crate, r=alexcrichton\n\nFix spurious warning on empty proc macro crates\n\nWhile attempting to reproduce rust-lang/rust#47086 I noticed the following warning:\n\n```shell\n> rustc /dev/null --crate-type proc-macro\nwarning: unused variable: `registrar`\n --> /dev/null:0:1\n```\n\nAs there are no macros to register the automatically generated registrar function for the crate has no body. As a result its `registrar` argument is unused triggering the above warning.\n\nThe warning is confusing and not easily actionable by the developer. It could also be triggered legitimately by e.g. having all of the macros in a crate #[cfg]'ed out.\n\nFix by naming the generated argument `_registrar` inside `mk_registrar()`. This suppresses the unused variable warning.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/117eb68122cee0346e15f83c248859a89063a86b", "html_url": "https://github.com/rust-lang/rust/commit/117eb68122cee0346e15f83c248859a89063a86b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/117eb68122cee0346e15f83c248859a89063a86b/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9d26a25bb627e8cee8476331cf25212a5aacebd1", "url": "https://api.github.com/repos/rust-lang/rust/commits/9d26a25bb627e8cee8476331cf25212a5aacebd1", "html_url": "https://github.com/rust-lang/rust/commit/9d26a25bb627e8cee8476331cf25212a5aacebd1"}, {"sha": "e1bffbdf66cecc442e8d9e20642df82a155e2aa0", "url": "https://api.github.com/repos/rust-lang/rust/commits/e1bffbdf66cecc442e8d9e20642df82a155e2aa0", "html_url": "https://github.com/rust-lang/rust/commit/e1bffbdf66cecc442e8d9e20642df82a155e2aa0"}], "stats": {"total": 33, "additions": 32, "deletions": 1}, "files": [{"sha": "0ba21e6b366cfc531755014ec7a37bae21f5a016", "filename": "src/libsyntax_ext/proc_macro_registrar.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/117eb68122cee0346e15f83c248859a89063a86b/src%2Flibsyntax_ext%2Fproc_macro_registrar.rs", "raw_url": "https://github.com/rust-lang/rust/raw/117eb68122cee0346e15f83c248859a89063a86b/src%2Flibsyntax_ext%2Fproc_macro_registrar.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax_ext%2Fproc_macro_registrar.rs?ref=117eb68122cee0346e15f83c248859a89063a86b", "patch": "@@ -381,7 +381,7 @@ fn mk_registrar(cx: &mut ExtCtxt,\n \n     let __internal = Ident::from_str(\"__internal\");\n     let registry = Ident::from_str(\"Registry\");\n-    let registrar = Ident::from_str(\"registrar\");\n+    let registrar = Ident::from_str(\"_registrar\");\n     let register_custom_derive = Ident::from_str(\"register_custom_derive\");\n     let register_attr_proc_macro = Ident::from_str(\"register_attr_proc_macro\");\n     let register_bang_proc_macro = Ident::from_str(\"register_bang_proc_macro\");"}, {"sha": "b45d4bf41d63583f17528915760d9738b3a28cb1", "filename": "src/test/run-pass-fulldeps/proc-macro/auxiliary/empty-crate.rs", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/117eb68122cee0346e15f83c248859a89063a86b/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fauxiliary%2Fempty-crate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/117eb68122cee0346e15f83c248859a89063a86b/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fauxiliary%2Fempty-crate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fauxiliary%2Fempty-crate.rs?ref=117eb68122cee0346e15f83c248859a89063a86b", "patch": "@@ -0,0 +1,14 @@\n+// Copyright 2018 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// no-prefer-dynamic\n+\n+#![crate_type = \"proc-macro\"]\n+#![deny(unused_variables)]"}, {"sha": "38a2716aee77beaa56fc164d36e91d26ee8645b0", "filename": "src/test/run-pass-fulldeps/proc-macro/empty-crate.rs", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/117eb68122cee0346e15f83c248859a89063a86b/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fempty-crate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/117eb68122cee0346e15f83c248859a89063a86b/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fempty-crate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-fulldeps%2Fproc-macro%2Fempty-crate.rs?ref=117eb68122cee0346e15f83c248859a89063a86b", "patch": "@@ -0,0 +1,17 @@\n+// Copyright 2018 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// aux-build:empty-crate.rs\n+// ignore-stage1\n+\n+#[macro_use]\n+extern crate empty_crate;\n+\n+fn main() {}"}]}