{"sha": "e9bca510fe17354f876aa289bb39d347d7c69c69", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU5YmNhNTEwZmUxNzM1NGY4NzZhYTI4OWJiMzlkMzQ3ZDdjNjljNjk=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-02-29T13:59:45Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-02-29T13:59:45Z"}, "message": "Auto merge of #69260 - GuillaumeGomez:create-E0747-error-code, r=varkor,estebank\n\nCreate E0747 error code for unterminated raw strings\n\nReopening of #66035.\n\nr? @estebank", "tree": {"sha": "40659d608c96e6f87d8d1951f983e4dfe2886135", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/40659d608c96e6f87d8d1951f983e4dfe2886135"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e9bca510fe17354f876aa289bb39d347d7c69c69", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e9bca510fe17354f876aa289bb39d347d7c69c69", "html_url": "https://github.com/rust-lang/rust/commit/e9bca510fe17354f876aa289bb39d347d7c69c69", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e9bca510fe17354f876aa289bb39d347d7c69c69/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3f9bddc7fea3ca1d49f39f22bb937a84ed32f84e", "url": "https://api.github.com/repos/rust-lang/rust/commits/3f9bddc7fea3ca1d49f39f22bb937a84ed32f84e", "html_url": "https://github.com/rust-lang/rust/commit/3f9bddc7fea3ca1d49f39f22bb937a84ed32f84e"}, {"sha": "e2738285ea7374bc6423ea6de095ad0e8990975d", "url": "https://api.github.com/repos/rust-lang/rust/commits/e2738285ea7374bc6423ea6de095ad0e8990975d", "html_url": "https://github.com/rust-lang/rust/commit/e2738285ea7374bc6423ea6de095ad0e8990975d"}], "stats": {"total": 34, "additions": 29, "deletions": 5}, "files": [{"sha": "89359bb1bfdff40a4678067c27bce645f3fc5578", "filename": "src/librustc_error_codes/error_codes.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/e9bca510fe17354f876aa289bb39d347d7c69c69/src%2Flibrustc_error_codes%2Ferror_codes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e9bca510fe17354f876aa289bb39d347d7c69c69/src%2Flibrustc_error_codes%2Ferror_codes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_error_codes%2Ferror_codes.rs?ref=e9bca510fe17354f876aa289bb39d347d7c69c69", "patch": "@@ -418,6 +418,7 @@ E0744: include_str!(\"./error_codes/E0744.md\"),\n E0745: include_str!(\"./error_codes/E0745.md\"),\n E0746: include_str!(\"./error_codes/E0746.md\"),\n E0747: include_str!(\"./error_codes/E0747.md\"),\n+E0748: include_str!(\"./error_codes/E0748.md\"),\n ;\n //  E0006, // merged with E0005\n //  E0008, // cannot bind by-move into a pattern guard"}, {"sha": "69f1c026125bfc2fbf299c7fdbcde74a288a0281", "filename": "src/librustc_error_codes/error_codes/E0748.md", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/e9bca510fe17354f876aa289bb39d347d7c69c69/src%2Flibrustc_error_codes%2Ferror_codes%2FE0748.md", "raw_url": "https://github.com/rust-lang/rust/raw/e9bca510fe17354f876aa289bb39d347d7c69c69/src%2Flibrustc_error_codes%2Ferror_codes%2FE0748.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_error_codes%2Ferror_codes%2FE0748.md?ref=e9bca510fe17354f876aa289bb39d347d7c69c69", "patch": "@@ -0,0 +1,16 @@\n+A raw string isn't correctly terminated because the trailing `#` count doesn't\n+match its leading `#` count.\n+\n+Erroneous code example:\n+\n+```compile_fail,E0748\n+let dolphins = r##\"Dolphins!\"#; // error!\n+```\n+\n+To terminate a raw string, you have to have the same number of `#` at the end\n+as at the beginning. Example:\n+\n+```\n+let dolphins = r#\"Dolphins!\"#; // One `#` at the beginning, one at the end so\n+                               // all good!\n+```"}, {"sha": "face0e679927c58223e9d4f3b59e5038263dc3b7", "filename": "src/librustc_parse/lexer/mod.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/e9bca510fe17354f876aa289bb39d347d7c69c69/src%2Flibrustc_parse%2Flexer%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e9bca510fe17354f876aa289bb39d347d7c69c69/src%2Flibrustc_parse%2Flexer%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_parse%2Flexer%2Fmod.rs?ref=e9bca510fe17354f876aa289bb39d347d7c69c69", "patch": "@@ -1,5 +1,5 @@\n use rustc_data_structures::sync::Lrc;\n-use rustc_errors::{DiagnosticBuilder, FatalError};\n+use rustc_errors::{error_code, DiagnosticBuilder, FatalError};\n use rustc_lexer::unescape;\n use rustc_lexer::Base;\n use rustc_session::parse::ParseSess;\n@@ -495,7 +495,11 @@ impl<'a> StringReader<'a> {\n     }\n \n     fn report_unterminated_raw_string(&self, start: BytePos, n_hashes: usize) -> ! {\n-        let mut err = self.struct_span_fatal(start, start, \"unterminated raw string\");\n+        let mut err = self.sess.span_diagnostic.struct_span_fatal_with_code(\n+            self.mk_sp(start, start),\n+            \"unterminated raw string\",\n+            error_code!(E0748),\n+        );\n         err.span_label(self.mk_sp(start, start), \"unterminated raw string\");\n \n         if n_hashes > 0 {"}, {"sha": "d5f22e2a1a8144ae826e4cc4cc508d6122e1087e", "filename": "src/test/ui/parser/raw-byte-string-eof.stderr", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/e9bca510fe17354f876aa289bb39d347d7c69c69/src%2Ftest%2Fui%2Fparser%2Fraw-byte-string-eof.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e9bca510fe17354f876aa289bb39d347d7c69c69/src%2Ftest%2Fui%2Fparser%2Fraw-byte-string-eof.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fraw-byte-string-eof.stderr?ref=e9bca510fe17354f876aa289bb39d347d7c69c69", "patch": "@@ -1,4 +1,4 @@\n-error: unterminated raw string\n+error[E0748]: unterminated raw string\n   --> $DIR/raw-byte-string-eof.rs:2:5\n    |\n LL |     br##\"a\"#;\n@@ -8,3 +8,4 @@ LL |     br##\"a\"#;\n \n error: aborting due to previous error\n \n+For more information about this error, try `rustc --explain E0748`."}, {"sha": "077f763f154c589cd2f58e79a0e31552e8884a20", "filename": "src/test/ui/parser/raw-str-unterminated.stderr", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/e9bca510fe17354f876aa289bb39d347d7c69c69/src%2Ftest%2Fui%2Fparser%2Fraw-str-unterminated.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e9bca510fe17354f876aa289bb39d347d7c69c69/src%2Ftest%2Fui%2Fparser%2Fraw-str-unterminated.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fraw-str-unterminated.stderr?ref=e9bca510fe17354f876aa289bb39d347d7c69c69", "patch": "@@ -1,4 +1,4 @@\n-error: unterminated raw string\n+error[E0748]: unterminated raw string\n   --> $DIR/raw-str-unterminated.rs:2:5\n    |\n LL |     r#\" string literal goes on\n@@ -8,3 +8,4 @@ LL |     r#\" string literal goes on\n \n error: aborting due to previous error\n \n+For more information about this error, try `rustc --explain E0748`."}, {"sha": "0f1d7e4651deb234787ab2b1bd54c2bddb1351bb", "filename": "src/test/ui/parser/raw/raw_string.stderr", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/e9bca510fe17354f876aa289bb39d347d7c69c69/src%2Ftest%2Fui%2Fparser%2Fraw%2Fraw_string.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e9bca510fe17354f876aa289bb39d347d7c69c69/src%2Ftest%2Fui%2Fparser%2Fraw%2Fraw_string.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fraw%2Fraw_string.stderr?ref=e9bca510fe17354f876aa289bb39d347d7c69c69", "patch": "@@ -1,4 +1,4 @@\n-error: unterminated raw string\n+error[E0748]: unterminated raw string\n   --> $DIR/raw_string.rs:2:13\n    |\n LL |     let x = r##\"lol\"#;\n@@ -8,3 +8,4 @@ LL |     let x = r##\"lol\"#;\n \n error: aborting due to previous error\n \n+For more information about this error, try `rustc --explain E0748`."}]}