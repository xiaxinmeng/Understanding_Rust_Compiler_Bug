{"sha": "df75165cf4ed8dc06576f12b5867ac8672cde3c6", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRmNzUxNjVjZjRlZDhkYzA2NTc2ZjEyYjU4NjdhYzg2NzJjZGUzYzY=", "commit": {"author": {"name": "Roy Frostig", "email": "rfrostig@mozilla.com", "date": "2010-07-14T01:11:23Z"}, "committer": {"name": "Roy Frostig", "email": "rfrostig@mozilla.com", "date": "2010-07-15T19:30:46Z"}, "message": "Make the x86 backend push an extra word as closure/obj arg when emitting any code that amounts to a glue or native call.", "tree": {"sha": "64cb85389960239dd4f6ad6f24afef73480e8d92", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/64cb85389960239dd4f6ad6f24afef73480e8d92"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/df75165cf4ed8dc06576f12b5867ac8672cde3c6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/df75165cf4ed8dc06576f12b5867ac8672cde3c6", "html_url": "https://github.com/rust-lang/rust/commit/df75165cf4ed8dc06576f12b5867ac8672cde3c6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/df75165cf4ed8dc06576f12b5867ac8672cde3c6/comments", "author": {"login": "froystig", "id": 123903, "node_id": "MDQ6VXNlcjEyMzkwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/123903?v=4", "gravatar_id": "", "url": "https://api.github.com/users/froystig", "html_url": "https://github.com/froystig", "followers_url": "https://api.github.com/users/froystig/followers", "following_url": "https://api.github.com/users/froystig/following{/other_user}", "gists_url": "https://api.github.com/users/froystig/gists{/gist_id}", "starred_url": "https://api.github.com/users/froystig/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/froystig/subscriptions", "organizations_url": "https://api.github.com/users/froystig/orgs", "repos_url": "https://api.github.com/users/froystig/repos", "events_url": "https://api.github.com/users/froystig/events{/privacy}", "received_events_url": "https://api.github.com/users/froystig/received_events", "type": "User", "site_admin": false}, "committer": {"login": "froystig", "id": 123903, "node_id": "MDQ6VXNlcjEyMzkwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/123903?v=4", "gravatar_id": "", "url": "https://api.github.com/users/froystig", "html_url": "https://github.com/froystig", "followers_url": "https://api.github.com/users/froystig/followers", "following_url": "https://api.github.com/users/froystig/following{/other_user}", "gists_url": "https://api.github.com/users/froystig/gists{/gist_id}", "starred_url": "https://api.github.com/users/froystig/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/froystig/subscriptions", "organizations_url": "https://api.github.com/users/froystig/orgs", "repos_url": "https://api.github.com/users/froystig/repos", "events_url": "https://api.github.com/users/froystig/events{/privacy}", "received_events_url": "https://api.github.com/users/froystig/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5d10a264de17df801e893df2d1e2725c78162179", "url": "https://api.github.com/repos/rust-lang/rust/commits/5d10a264de17df801e893df2d1e2725c78162179", "html_url": "https://github.com/rust-lang/rust/commit/5d10a264de17df801e893df2d1e2725c78162179"}], "stats": {"total": 8, "additions": 5, "deletions": 3}, "files": [{"sha": "bd71229d22d60964071c3200086f1c4def583772", "filename": "src/boot/be/abi.ml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/df75165cf4ed8dc06576f12b5867ac8672cde3c6/src%2Fboot%2Fbe%2Fabi.ml", "raw_url": "https://github.com/rust-lang/rust/raw/df75165cf4ed8dc06576f12b5867ac8672cde3c6/src%2Fboot%2Fbe%2Fabi.ml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fboot%2Fbe%2Fabi.ml?ref=df75165cf4ed8dc06576f12b5867ac8672cde3c6", "patch": "@@ -79,7 +79,7 @@ let iterator_args_elt_outer_frame_ptr = 1;;\n let indirect_args_elt_closure = 0;;\n \n (* dst, taskptr, closure-ptr, ty_params, src, src2=target_task *)\n-let worst_case_glue_call_args = 5;;\n+let worst_case_glue_call_args = 6;;\n \n type abi =\n   {"}, {"sha": "811da12a3c7cadd507373cd3d3f733b171121760", "filename": "src/boot/be/x86.ml", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/df75165cf4ed8dc06576f12b5867ac8672cde3c6/src%2Fboot%2Fbe%2Fx86.ml", "raw_url": "https://github.com/rust-lang/rust/raw/df75165cf4ed8dc06576f12b5867ac8672cde3c6/src%2Fboot%2Fbe%2Fx86.ml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fboot%2Fbe%2Fx86.ml?ref=df75165cf4ed8dc06576f12b5867ac8672cde3c6", "patch": "@@ -536,11 +536,12 @@ let frame_base_sz = Int64.mul (Int64.of_int frame_base_words) word_sz;;\n let frame_info_words = 2 (* crate ptr, crate-rel frame info disp *) ;;\n let frame_info_sz = Int64.mul (Int64.of_int frame_info_words) word_sz;;\n \n-let implicit_arg_words = 2 (* task ptr,out ptr *);;\n-let implicit_args_sz =  Int64.mul (Int64.of_int implicit_arg_words) word_sz;;\n+let implicit_arg_words = 3 (* task ptr, out ptr, closure ptr *);;\n+let implicit_args_sz = Int64.mul (Int64.of_int implicit_arg_words) word_sz;;\n \n let out_ptr = wordptr_n (Il.Hreg ebp) (frame_base_words);;\n let task_ptr = wordptr_n (Il.Hreg ebp) (frame_base_words+1);;\n+let closure_ptr = wordptr_n (Il.Hreg ebp) (frame_base_words+2);;\n let ty_param_n i =\n   wordptr_n (Il.Hreg ebp) (frame_base_words + implicit_arg_words + i);;\n \n@@ -855,6 +856,7 @@ let sweep_gc_chain\n       (c (ecx_n Abi.tydesc_field_first_param));\n     push (ro eax);                              (* Push typarams ptr.     *)\n \n+    push (immi 0L);                             (* Push null closure-ptr  *)\n     push (c task_ptr);                          (* Push task ptr.         *)\n     push (immi 0L);                             (* Push null outptr.      *)\n "}]}