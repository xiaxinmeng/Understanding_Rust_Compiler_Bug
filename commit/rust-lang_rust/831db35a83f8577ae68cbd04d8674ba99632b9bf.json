{"sha": "831db35a83f8577ae68cbd04d8674ba99632b9bf", "node_id": "MDY6Q29tbWl0NzI0NzEyOjgzMWRiMzVhODNmODU3N2FlNjhjYmQwNGQ4Njc0YmE5OTYzMmI5YmY=", "commit": {"author": {"name": "topecongiro", "email": "seuchida@gmail.com", "date": "2017-08-15T07:49:02Z"}, "committer": {"name": "topecongiro", "email": "seuchida@gmail.com", "date": "2017-08-15T07:49:02Z"}, "message": "Move isatty() to utils.rs", "tree": {"sha": "d77fda08c5ca3a63491321ba1024890079006dcf", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d77fda08c5ca3a63491321ba1024890079006dcf"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/831db35a83f8577ae68cbd04d8674ba99632b9bf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/831db35a83f8577ae68cbd04d8674ba99632b9bf", "html_url": "https://github.com/rust-lang/rust/commit/831db35a83f8577ae68cbd04d8674ba99632b9bf", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/831db35a83f8577ae68cbd04d8674ba99632b9bf/comments", "author": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "committer": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a1d28bf41cbec4748633bbe336145a862429b265", "url": "https://api.github.com/repos/rust-lang/rust/commits/a1d28bf41cbec4748633bbe336145a862429b265", "html_url": "https://github.com/rust-lang/rust/commit/a1d28bf41cbec4748633bbe336145a862429b265"}], "stats": {"total": 39, "additions": 20, "deletions": 19}, "files": [{"sha": "3fb228653851541da06dee98136776a044fb88ae", "filename": "src/rustfmt_diff.rs", "status": "modified", "additions": 1, "deletions": 19, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/831db35a83f8577ae68cbd04d8674ba99632b9bf/src%2Frustfmt_diff.rs", "raw_url": "https://github.com/rust-lang/rust/raw/831db35a83f8577ae68cbd04d8674ba99632b9bf/src%2Frustfmt_diff.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustfmt_diff.rs?ref=831db35a83f8577ae68cbd04d8674ba99632b9bf", "patch": "@@ -12,6 +12,7 @@ use diff;\n use std::collections::VecDeque;\n use std::io;\n use term;\n+use utils::isatty;\n \n #[derive(Debug, PartialEq)]\n pub enum DiffLine {\n@@ -105,25 +106,6 @@ where\n         }\n         _ => print_diff_basic(diff, get_section_title),\n     }\n-\n-    // isatty shamelessly adapted from cargo.\n-    #[cfg(unix)]\n-    fn isatty() -> bool {\n-        extern crate libc;\n-\n-        unsafe { libc::isatty(libc::STDOUT_FILENO) != 0 }\n-    }\n-    #[cfg(windows)]\n-    fn isatty() -> bool {\n-        extern crate kernel32;\n-        extern crate winapi;\n-\n-        unsafe {\n-            let handle = kernel32::GetStdHandle(winapi::winbase::STD_OUTPUT_HANDLE);\n-            let mut out = 0;\n-            kernel32::GetConsoleMode(handle, &mut out) != 0\n-        }\n-    }\n }\n \n fn print_diff_fancy<F>("}, {"sha": "bd46ef1bc6ad20de917f510f570e3dfdb6e75c82", "filename": "src/utils.rs", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/831db35a83f8577ae68cbd04d8674ba99632b9bf/src%2Futils.rs", "raw_url": "https://github.com/rust-lang/rust/raw/831db35a83f8577ae68cbd04d8674ba99632b9bf/src%2Futils.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Futils.rs?ref=831db35a83f8577ae68cbd04d8674ba99632b9bf", "patch": "@@ -516,3 +516,22 @@ pub fn left_most_sub_expr(e: &ast::Expr) -> &ast::Expr {\n         _ => e,\n     }\n }\n+\n+// isatty shamelessly adapted from cargo.\n+#[cfg(unix)]\n+pub fn isatty() -> bool {\n+    extern crate libc;\n+\n+    unsafe { libc::isatty(libc::STDOUT_FILENO) != 0 }\n+}\n+#[cfg(windows)]\n+pub fn isatty() -> bool {\n+    extern crate kernel32;\n+    extern crate winapi;\n+\n+    unsafe {\n+        let handle = kernel32::GetStdHandle(winapi::winbase::STD_OUTPUT_HANDLE);\n+        let mut out = 0;\n+        kernel32::GetConsoleMode(handle, &mut out) != 0\n+    }\n+}"}]}