{"sha": "19eb225bc2725202c02e3d520876bab25dc026d1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE5ZWIyMjViYzI3MjUyMDJjMDJlM2Q1MjA4NzZiYWIyNWRjMDI2ZDE=", "commit": {"author": {"name": "Zack Corr", "email": "zack@z0w0.me", "date": "2013-02-16T15:21:56Z"}, "committer": {"name": "Zack Corr", "email": "zack@z0w0.me", "date": "2013-02-16T15:21:56Z"}, "message": "Support link_args at the crate level. Closes #1301", "tree": {"sha": "a58df7ed3e7463cb55ffd28e3c40ce4cf10a2e7b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a58df7ed3e7463cb55ffd28e3c40ce4cf10a2e7b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/19eb225bc2725202c02e3d520876bab25dc026d1", "comment_count": 1, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/19eb225bc2725202c02e3d520876bab25dc026d1", "html_url": "https://github.com/rust-lang/rust/commit/19eb225bc2725202c02e3d520876bab25dc026d1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/19eb225bc2725202c02e3d520876bab25dc026d1/comments", "author": {"login": "z0w0", "id": 676417, "node_id": "MDQ6VXNlcjY3NjQxNw==", "avatar_url": "https://avatars.githubusercontent.com/u/676417?v=4", "gravatar_id": "", "url": "https://api.github.com/users/z0w0", "html_url": "https://github.com/z0w0", "followers_url": "https://api.github.com/users/z0w0/followers", "following_url": "https://api.github.com/users/z0w0/following{/other_user}", "gists_url": "https://api.github.com/users/z0w0/gists{/gist_id}", "starred_url": "https://api.github.com/users/z0w0/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/z0w0/subscriptions", "organizations_url": "https://api.github.com/users/z0w0/orgs", "repos_url": "https://api.github.com/users/z0w0/repos", "events_url": "https://api.github.com/users/z0w0/events{/privacy}", "received_events_url": "https://api.github.com/users/z0w0/received_events", "type": "User", "site_admin": false}, "committer": {"login": "z0w0", "id": 676417, "node_id": "MDQ6VXNlcjY3NjQxNw==", "avatar_url": "https://avatars.githubusercontent.com/u/676417?v=4", "gravatar_id": "", "url": "https://api.github.com/users/z0w0", "html_url": "https://github.com/z0w0", "followers_url": "https://api.github.com/users/z0w0/followers", "following_url": "https://api.github.com/users/z0w0/following{/other_user}", "gists_url": "https://api.github.com/users/z0w0/gists{/gist_id}", "starred_url": "https://api.github.com/users/z0w0/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/z0w0/subscriptions", "organizations_url": "https://api.github.com/users/z0w0/orgs", "repos_url": "https://api.github.com/users/z0w0/repos", "events_url": "https://api.github.com/users/z0w0/events{/privacy}", "received_events_url": "https://api.github.com/users/z0w0/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9ad8a1f46566ddcd705cc918863cee2946d8b946", "url": "https://api.github.com/repos/rust-lang/rust/commits/9ad8a1f46566ddcd705cc918863cee2946d8b946", "html_url": "https://github.com/rust-lang/rust/commit/9ad8a1f46566ddcd705cc918863cee2946d8b946"}], "stats": {"total": 15, "additions": 15, "deletions": 0}, "files": [{"sha": "a4daac1ebe155e4c83d8cb82216d88474ab4e380", "filename": "src/librustc/metadata/creader.rs", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/19eb225bc2725202c02e3d520876bab25dc026d1/src%2Flibrustc%2Fmetadata%2Fcreader.rs", "raw_url": "https://github.com/rust-lang/rust/raw/19eb225bc2725202c02e3d520876bab25dc026d1/src%2Flibrustc%2Fmetadata%2Fcreader.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmetadata%2Fcreader.rs?ref=19eb225bc2725202c02e3d520876bab25dc026d1", "patch": "@@ -55,6 +55,7 @@ pub fn read_crates(diag: span_handler,\n             visit_view_item: |a| visit_view_item(e, a),\n             visit_item: |a| visit_item(e, a),\n             .. *visit::default_simple_visitor()});\n+    visit_crate(e, crate);\n     visit::visit_crate(crate, (), v);\n     dump_crates(e.crate_cache);\n     warn_if_multiple_versions(e, diag, e.crate_cache);\n@@ -125,6 +126,20 @@ struct Env {\n     intr: @ident_interner\n }\n \n+fn visit_crate(e: @mut Env, c: ast::crate) {\n+    let cstore = e.cstore;\n+    let link_args = attr::find_attrs_by_name(c.node.attrs, \"link_args\");\n+\n+    for link_args.each |a| {\n+        match attr::get_meta_item_value_str(attr::attr_meta(*a)) {\n+          Some(ref linkarg) => {\n+            cstore::add_used_link_args(cstore, (/*bad*/copy *linkarg));\n+          }\n+          None => {/* fallthrough */ }\n+        }\n+    }\n+}\n+\n fn visit_view_item(e: @mut Env, i: @ast::view_item) {\n     match /*bad*/copy i.node {\n       ast::view_item_use(ident, meta_items, id) => {"}]}