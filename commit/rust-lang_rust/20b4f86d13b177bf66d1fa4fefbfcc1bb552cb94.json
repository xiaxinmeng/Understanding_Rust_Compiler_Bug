{"sha": "20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94", "node_id": "MDY6Q29tbWl0NzI0NzEyOjIwYjRmODZkMTNiMTc3YmY2NmQxZmE0ZmVmYmZjYzFiYjU1MmNiOTQ=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2017-07-20T22:50:33Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2017-07-25T14:09:31Z"}, "message": "Stabilize the `compile_error_macro` feature\n\nStabilizes:\n\n* `compile_error!` as a macro defined by rustc\n\nCloses #40872", "tree": {"sha": "c53a883de937df40bc562f244fef8c5e5dddc903", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c53a883de937df40bc562f244fef8c5e5dddc903"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94", "html_url": "https://github.com/rust-lang/rust/commit/20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "daeb6077c87dab99f2d301d06965558b8d064c28", "url": "https://api.github.com/repos/rust-lang/rust/commits/daeb6077c87dab99f2d301d06965558b8d064c28", "html_url": "https://github.com/rust-lang/rust/commit/daeb6077c87dab99f2d301d06965558b8d064c28"}], "stats": {"total": 56, "additions": 4, "deletions": 52}, "files": [{"sha": "4de631e1fb30775f235db383ee6e0be0badce63e", "filename": "src/doc/unstable-book/src/language-features/compile-error.md", "status": "removed", "additions": 0, "deletions": 20, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/daeb6077c87dab99f2d301d06965558b8d064c28/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fcompile-error.md", "raw_url": "https://github.com/rust-lang/rust/raw/daeb6077c87dab99f2d301d06965558b8d064c28/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fcompile-error.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fcompile-error.md?ref=daeb6077c87dab99f2d301d06965558b8d064c28", "patch": "@@ -1,20 +0,0 @@\n-# `compile_error`\n-\n-The tracking issue for this feature is: [#40872]\n-\n-[#40872]: https://github.com/rust-lang/rust/issues/40872\n-\n-------------------------\n-\n-The `compile_error` feature adds a macro which will generate a compilation\n-error with the specified error message.\n-\n-## Examples\n-\n-```rust,compile_fail\n-#![feature(compile_error)]\n-\n-fn main() {\n-    compile_error!(\"The error message\"); //ERROR The error message\n-}\n-```"}, {"sha": "2edf8e1fa886f9bde3ba843b161aad7cc3ce7e62", "filename": "src/libcore/macros.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94/src%2Flibcore%2Fmacros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94/src%2Flibcore%2Fmacros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fmacros.rs?ref=20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94", "patch": "@@ -574,7 +574,7 @@ mod builtin {\n     /// For more information, see the [RFC].\n     ///\n     /// [RFC]: https://github.com/rust-lang/rfcs/blob/master/text/1695-add-error-macro.md\n-    #[unstable(feature = \"compile_error_macro\", issue = \"40872\")]\n+    #[stable(feature = \"compile_error_macro\", since = \"1.20.0\")]\n     #[macro_export]\n     #[cfg(dox)]\n     macro_rules! compile_error { ($msg:expr) => ({ /* compiler built-in */ }) }"}, {"sha": "343c499b3ff7c1824b101c0f30f12cff3c41086d", "filename": "src/libstd/macros.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94/src%2Flibstd%2Fmacros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94/src%2Flibstd%2Fmacros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fmacros.rs?ref=20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94", "patch": "@@ -249,7 +249,7 @@ pub mod builtin {\n     /// For more information, see the [RFC].\n     ///\n     /// [RFC]: https://github.com/rust-lang/rfcs/blob/master/text/1695-add-error-macro.md\n-    #[unstable(feature = \"compile_error_macro\", issue = \"40872\")]\n+    #[stable(feature = \"compile_error_macro\", since = \"1.20.0\")]\n     #[macro_export]\n     macro_rules! compile_error { ($msg:expr) => ({ /* compiler built-in */ }) }\n "}, {"sha": "f6d56557166d4de2565c0e4e217ec4de437d3709", "filename": "src/libsyntax/ext/expand.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94/src%2Flibsyntax%2Fext%2Fexpand.rs", "raw_url": "https://github.com/rust-lang/rust/raw/20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94/src%2Flibsyntax%2Fext%2Fexpand.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fext%2Fexpand.rs?ref=20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94", "patch": "@@ -1041,7 +1041,6 @@ impl<'feat> ExpansionConfig<'feat> {\n         fn enable_allow_internal_unstable = allow_internal_unstable,\n         fn enable_custom_derive = custom_derive,\n         fn proc_macro_enabled = proc_macro,\n-        fn enable_compile_error = compile_error,\n     }\n }\n "}, {"sha": "e8de8cf41c970ce5f33fad1d9d157b46a5b85f63", "filename": "src/libsyntax/feature_gate.rs", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94/src%2Flibsyntax%2Ffeature_gate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94/src%2Flibsyntax%2Ffeature_gate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Ffeature_gate.rs?ref=20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94", "patch": "@@ -117,7 +117,6 @@ macro_rules! declare_features {\n \n declare_features! (\n     (active, asm, \"1.0.0\", Some(29722)),\n-    (active, compile_error, \"1.20.0\", Some(40872)),\n     (active, concat_idents, \"1.0.0\", Some(29599)),\n     (active, link_args, \"1.0.0\", Some(29596)),\n     (active, log_syntax, \"1.0.0\", Some(29598)),\n@@ -445,6 +444,8 @@ declare_features! (\n     // Allows the definition of associated constants in `trait` or `impl`\n     // blocks.\n     (accepted, associated_consts, \"1.20.0\", Some(29646)),\n+    // Usage of the `compile_error!` macro\n+    (accepted, compile_error, \"1.20.0\", Some(40872)),\n );\n \n // If you change this, please modify src/doc/unstable-book as well. You must\n@@ -1040,9 +1041,6 @@ pub const EXPLAIN_LOG_SYNTAX: &'static str =\n pub const EXPLAIN_CONCAT_IDENTS: &'static str =\n     \"`concat_idents` is not stable enough for use and is subject to change\";\n \n-pub const EXPLAIN_COMPILE_ERROR: &'static str =\n-    \"`compile_error` is not stable enough for use and is subject to change\";\n-\n pub const EXPLAIN_TRACE_MACROS: &'static str =\n     \"`trace_macros` is not stable enough for use and is subject to change\";\n pub const EXPLAIN_ALLOW_INTERNAL_UNSTABLE: &'static str ="}, {"sha": "7bc7afba63cb4d8f43539e851847391d74c84df7", "filename": "src/libsyntax_ext/compile_error.rs", "status": "modified", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94/src%2Flibsyntax_ext%2Fcompile_error.rs", "raw_url": "https://github.com/rust-lang/rust/raw/20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94/src%2Flibsyntax_ext%2Fcompile_error.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax_ext%2Fcompile_error.rs?ref=20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94", "patch": "@@ -12,23 +12,13 @@\n \n use syntax::ext::base::*;\n use syntax::ext::base;\n-use syntax::feature_gate;\n use syntax_pos::Span;\n use syntax::tokenstream;\n \n pub fn expand_compile_error<'cx>(cx: &'cx mut ExtCtxt,\n                               sp: Span,\n                               tts: &[tokenstream::TokenTree])\n                               -> Box<base::MacResult + 'cx> {\n-    if !cx.ecfg.enable_compile_error() {\n-        feature_gate::emit_feature_err(&cx.parse_sess,\n-                                       \"compile_error\",\n-                                       sp,\n-                                       feature_gate::GateIssue::Language,\n-                                       feature_gate::EXPLAIN_COMPILE_ERROR);\n-        return DummyResult::expr(sp);\n-    }\n-\n     let var = match get_single_str_from_tts(cx, sp, tts, \"compile_error!\") {\n         None => return DummyResult::expr(sp),\n         Some(v) => v,"}, {"sha": "e9c5993098c3e317da3119de87e3ebdf049e6a0e", "filename": "src/test/compile-fail/compile_error_macro.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94/src%2Ftest%2Fcompile-fail%2Fcompile_error_macro.rs", "raw_url": "https://github.com/rust-lang/rust/raw/20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94/src%2Ftest%2Fcompile-fail%2Fcompile_error_macro.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fcompile_error_macro.rs?ref=20b4f86d13b177bf66d1fa4fefbfcc1bb552cb94", "patch": "@@ -8,8 +8,6 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n-#![feature(compile_error)]\n-\n fn main() {\n     compile_error!(\"a very descriptive error message\"); //~ ERROR: a very descriptive error message\n }"}, {"sha": "545c6852961c7d6e4447dc667b808ee53c0d6f57", "filename": "src/test/compile-fail/feature-gate-compile_error.rs", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/daeb6077c87dab99f2d301d06965558b8d064c28/src%2Ftest%2Fcompile-fail%2Ffeature-gate-compile_error.rs", "raw_url": "https://github.com/rust-lang/rust/raw/daeb6077c87dab99f2d301d06965558b8d064c28/src%2Ftest%2Fcompile-fail%2Ffeature-gate-compile_error.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Ffeature-gate-compile_error.rs?ref=daeb6077c87dab99f2d301d06965558b8d064c28", "patch": "@@ -1,13 +0,0 @@\n-// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n-// file at the top-level directory of this distribution and at\n-// http://rust-lang.org/COPYRIGHT.\n-//\n-// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n-// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n-// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n-// option. This file may not be copied, modified, or distributed\n-// except according to those terms.\n-\n-fn main() {\n-    compile_error!(\"test\"); //~ ERROR: `compile_error` is not stable enough\n-}"}]}