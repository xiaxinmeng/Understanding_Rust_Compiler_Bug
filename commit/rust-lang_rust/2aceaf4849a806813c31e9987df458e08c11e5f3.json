{"sha": "2aceaf4849a806813c31e9987df458e08c11e5f3", "node_id": "C_kwDOAAsO6NoAKDJhY2VhZjQ4NDlhODA2ODEzYzMxZTk5ODdkZjQ1OGUwOGMxMWU1ZjM", "commit": {"author": {"name": "John K\u00e5re Alsaker", "email": "john.kare.alsaker@gmail.com", "date": "2023-02-02T06:17:46Z"}, "committer": {"name": "John K\u00e5re Alsaker", "email": "john.kare.alsaker@gmail.com", "date": "2023-02-02T06:34:41Z"}, "message": "Add a new `rustc_driver` dylib to rexport `rustc_driver_impl`", "tree": {"sha": "b47c1afcbb519e4ae64919507c9b0bcfd961e577", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b47c1afcbb519e4ae64919507c9b0bcfd961e577"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2aceaf4849a806813c31e9987df458e08c11e5f3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2aceaf4849a806813c31e9987df458e08c11e5f3", "html_url": "https://github.com/rust-lang/rust/commit/2aceaf4849a806813c31e9987df458e08c11e5f3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2aceaf4849a806813c31e9987df458e08c11e5f3/comments", "author": {"login": "Zoxc", "id": 25784, "node_id": "MDQ6VXNlcjI1Nzg0", "avatar_url": "https://avatars.githubusercontent.com/u/25784?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Zoxc", "html_url": "https://github.com/Zoxc", "followers_url": "https://api.github.com/users/Zoxc/followers", "following_url": "https://api.github.com/users/Zoxc/following{/other_user}", "gists_url": "https://api.github.com/users/Zoxc/gists{/gist_id}", "starred_url": "https://api.github.com/users/Zoxc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Zoxc/subscriptions", "organizations_url": "https://api.github.com/users/Zoxc/orgs", "repos_url": "https://api.github.com/users/Zoxc/repos", "events_url": "https://api.github.com/users/Zoxc/events{/privacy}", "received_events_url": "https://api.github.com/users/Zoxc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Zoxc", "id": 25784, "node_id": "MDQ6VXNlcjI1Nzg0", "avatar_url": "https://avatars.githubusercontent.com/u/25784?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Zoxc", "html_url": "https://github.com/Zoxc", "followers_url": "https://api.github.com/users/Zoxc/followers", "following_url": "https://api.github.com/users/Zoxc/following{/other_user}", "gists_url": "https://api.github.com/users/Zoxc/gists{/gist_id}", "starred_url": "https://api.github.com/users/Zoxc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Zoxc/subscriptions", "organizations_url": "https://api.github.com/users/Zoxc/orgs", "repos_url": "https://api.github.com/users/Zoxc/repos", "events_url": "https://api.github.com/users/Zoxc/events{/privacy}", "received_events_url": "https://api.github.com/users/Zoxc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "73681323e611972caa9a6107312c9e1f74467545", "url": "https://api.github.com/repos/rust-lang/rust/commits/73681323e611972caa9a6107312c9e1f74467545", "html_url": "https://github.com/rust-lang/rust/commit/73681323e611972caa9a6107312c9e1f74467545"}], "stats": {"total": 83, "additions": 54, "deletions": 29}, "files": [{"sha": "705210e44b24c5f67e39747bfacbae2ce1deceb6", "filename": "Cargo.lock", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/2aceaf4849a806813c31e9987df458e08c11e5f3/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/2aceaf4849a806813c31e9987df458e08c11e5f3/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=2aceaf4849a806813c31e9987df458e08c11e5f3", "patch": "@@ -3567,6 +3567,7 @@ dependencies = [\n  \"jemalloc-sys\",\n  \"rustc_codegen_ssa\",\n  \"rustc_driver\",\n+ \"rustc_driver_impl\",\n  \"rustc_smir\",\n ]\n \n@@ -3946,6 +3947,13 @@ dependencies = [\n [[package]]\n name = \"rustc_driver\"\n version = \"0.0.0\"\n+dependencies = [\n+ \"rustc_driver_impl\",\n+]\n+\n+[[package]]\n+name = \"rustc_driver_impl\"\n+version = \"0.0.0\"\n dependencies = [\n  \"libc\",\n  \"rustc_ast\","}, {"sha": "41003ad83f31152956dce55a9feb2623f6b4fcc9", "filename": "compiler/rustc/Cargo.toml", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/2aceaf4849a806813c31e9987df458e08c11e5f3/compiler%2Frustc%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/2aceaf4849a806813c31e9987df458e08c11e5f3/compiler%2Frustc%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc%2FCargo.toml?ref=2aceaf4849a806813c31e9987df458e08c11e5f3", "patch": "@@ -5,6 +5,7 @@ edition = \"2021\"\n \n [dependencies]\n rustc_driver = { path = \"../rustc_driver\" }\n+rustc_driver_impl = { path = \"../rustc_driver_impl\" }\n \n # Make sure rustc_codegen_ssa ends up in the sysroot, because this\n # crate is intended to be used by codegen backends, which may not be in-tree.\n@@ -20,6 +21,6 @@ features = ['unprefixed_malloc_on_supported_platforms']\n \n [features]\n jemalloc = ['jemalloc-sys']\n-llvm = ['rustc_driver/llvm']\n-max_level_info = ['rustc_driver/max_level_info']\n-rustc_use_parallel_compiler = ['rustc_driver/rustc_use_parallel_compiler']\n+llvm = ['rustc_driver_impl/llvm']\n+max_level_info = ['rustc_driver_impl/max_level_info']\n+rustc_use_parallel_compiler = ['rustc_driver_impl/rustc_use_parallel_compiler']"}, {"sha": "d7c295418ba6d6d04688b046d494d9b12880b8c4", "filename": "compiler/rustc_driver/Cargo.toml", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/2aceaf4849a806813c31e9987df458e08c11e5f3/compiler%2Frustc_driver%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/2aceaf4849a806813c31e9987df458e08c11e5f3/compiler%2Frustc_driver%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_driver%2FCargo.toml?ref=2aceaf4849a806813c31e9987df458e08c11e5f3", "patch": "@@ -0,0 +1,10 @@\n+[package]\n+name = \"rustc_driver\"\n+version = \"0.0.0\"\n+edition = \"2021\"\n+\n+[lib]\n+crate-type = [\"dylib\"]\n+\n+[dependencies]\n+rustc_driver_impl = { path = \"../rustc_driver_impl\" }"}, {"sha": "195fc71b649d3e60edc407acc28088c23e4fbc01", "filename": "compiler/rustc_driver/src/lib.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/2aceaf4849a806813c31e9987df458e08c11e5f3/compiler%2Frustc_driver%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aceaf4849a806813c31e9987df458e08c11e5f3/compiler%2Frustc_driver%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_driver%2Fsrc%2Flib.rs?ref=2aceaf4849a806813c31e9987df458e08c11e5f3", "patch": "@@ -0,0 +1,7 @@\n+// This crate is intentionally empty and a rexport of `rustc_driver_impl` to allow the code in\n+// `rustc_driver_impl` to be compiled in parallel with other crates.\n+\n+#![allow(unused_extern_crates)]\n+extern crate rustc_driver_impl;\n+\n+pub use rustc_driver_impl::*;"}, {"sha": "af85b12c52b20dc35362d84a6fb873f468a2947c", "filename": "compiler/rustc_driver_impl/Cargo.toml", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/2aceaf4849a806813c31e9987df458e08c11e5f3/compiler%2Frustc_driver_impl%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/2aceaf4849a806813c31e9987df458e08c11e5f3/compiler%2Frustc_driver_impl%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_driver_impl%2FCargo.toml?ref=2aceaf4849a806813c31e9987df458e08c11e5f3", "patch": "@@ -1,10 +1,9 @@\n [package]\n-name = \"rustc_driver\"\n+name = \"rustc_driver_impl\"\n version = \"0.0.0\"\n edition = \"2021\"\n \n [lib]\n-crate-type = [\"dylib\"]\n \n [dependencies]\n tracing = { version = \"0.1.35\" }"}, {"sha": "638b368f702145586b9ca3e109fa2d261944b56e", "filename": "compiler/rustc_driver_impl/src/session_diagnostics.rs", "status": "modified", "additions": 12, "deletions": 12, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/2aceaf4849a806813c31e9987df458e08c11e5f3/compiler%2Frustc_driver_impl%2Fsrc%2Fsession_diagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2aceaf4849a806813c31e9987df458e08c11e5f3/compiler%2Frustc_driver_impl%2Fsrc%2Fsession_diagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_driver_impl%2Fsrc%2Fsession_diagnostics.rs?ref=2aceaf4849a806813c31e9987df458e08c11e5f3", "patch": "@@ -1,67 +1,67 @@\n use rustc_macros::Diagnostic;\n \n #[derive(Diagnostic)]\n-#[diag(driver_rlink_unable_to_read)]\n+#[diag(driver_impl_rlink_unable_to_read)]\n pub(crate) struct RlinkUnableToRead {\n     pub err: std::io::Error,\n }\n \n #[derive(Diagnostic)]\n-#[diag(driver_rlink_wrong_file_type)]\n+#[diag(driver_impl_rlink_wrong_file_type)]\n pub(crate) struct RLinkWrongFileType;\n \n #[derive(Diagnostic)]\n-#[diag(driver_rlink_empty_version_number)]\n+#[diag(driver_impl_rlink_empty_version_number)]\n pub(crate) struct RLinkEmptyVersionNumber;\n \n #[derive(Diagnostic)]\n-#[diag(driver_rlink_encoding_version_mismatch)]\n+#[diag(driver_impl_rlink_encoding_version_mismatch)]\n pub(crate) struct RLinkEncodingVersionMismatch {\n     pub version_array: String,\n     pub rlink_version: u32,\n }\n \n #[derive(Diagnostic)]\n-#[diag(driver_rlink_rustc_version_mismatch)]\n+#[diag(driver_impl_rlink_rustc_version_mismatch)]\n pub(crate) struct RLinkRustcVersionMismatch<'a> {\n     pub rustc_version: String,\n     pub current_version: &'a str,\n }\n \n #[derive(Diagnostic)]\n-#[diag(driver_rlink_no_a_file)]\n+#[diag(driver_impl_rlink_no_a_file)]\n pub(crate) struct RlinkNotAFile;\n \n #[derive(Diagnostic)]\n-#[diag(driver_unpretty_dump_fail)]\n+#[diag(driver_impl_unpretty_dump_fail)]\n pub(crate) struct UnprettyDumpFail {\n     pub path: String,\n     pub err: String,\n }\n \n #[derive(Diagnostic)]\n-#[diag(driver_ice)]\n+#[diag(driver_impl_ice)]\n pub(crate) struct Ice;\n \n #[derive(Diagnostic)]\n-#[diag(driver_ice_bug_report)]\n+#[diag(driver_impl_ice_bug_report)]\n pub(crate) struct IceBugReport<'a> {\n     pub bug_report_url: &'a str,\n }\n \n #[derive(Diagnostic)]\n-#[diag(driver_ice_version)]\n+#[diag(driver_impl_ice_version)]\n pub(crate) struct IceVersion<'a> {\n     pub version: &'a str,\n     pub triple: &'a str,\n }\n \n #[derive(Diagnostic)]\n-#[diag(driver_ice_flags)]\n+#[diag(driver_impl_ice_flags)]\n pub(crate) struct IceFlags {\n     pub flags: String,\n }\n \n #[derive(Diagnostic)]\n-#[diag(driver_ice_exclude_cargo_defaults)]\n+#[diag(driver_impl_ice_exclude_cargo_defaults)]\n pub(crate) struct IceExcludeCargoDefaults;"}, {"sha": "f19b1ff6426177c16eb24dd9093bfa268cb21464", "filename": "compiler/rustc_error_messages/locales/en-US/driver.ftl", "status": "modified", "additions": 12, "deletions": 12, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/2aceaf4849a806813c31e9987df458e08c11e5f3/compiler%2Frustc_error_messages%2Flocales%2Fen-US%2Fdriver.ftl", "raw_url": "https://github.com/rust-lang/rust/raw/2aceaf4849a806813c31e9987df458e08c11e5f3/compiler%2Frustc_error_messages%2Flocales%2Fen-US%2Fdriver.ftl", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_messages%2Flocales%2Fen-US%2Fdriver.ftl?ref=2aceaf4849a806813c31e9987df458e08c11e5f3", "patch": "@@ -1,19 +1,19 @@\n-driver_rlink_unable_to_read = failed to read rlink file: `{$err}`\n+driver_impl_rlink_unable_to_read = failed to read rlink file: `{$err}`\n \n-driver_rlink_wrong_file_type = The input does not look like a .rlink file\n+driver_impl_rlink_wrong_file_type = The input does not look like a .rlink file\n \n-driver_rlink_empty_version_number = The input does not contain version number\n+driver_impl_rlink_empty_version_number = The input does not contain version number\n \n-driver_rlink_encoding_version_mismatch = .rlink file was produced with encoding version `{$version_array}`, but the current version is `{$rlink_version}`\n+driver_impl_rlink_encoding_version_mismatch = .rlink file was produced with encoding version `{$version_array}`, but the current version is `{$rlink_version}`\n \n-driver_rlink_rustc_version_mismatch = .rlink file was produced by rustc version `{$rustc_version}`, but the current version is `{$current_version}`\n+driver_impl_rlink_rustc_version_mismatch = .rlink file was produced by rustc version `{$rustc_version}`, but the current version is `{$current_version}`\n \n-driver_rlink_no_a_file = rlink must be a file\n+driver_impl_rlink_no_a_file = rlink must be a file\n \n-driver_unpretty_dump_fail = pretty-print failed to write `{$path}` due to error `{$err}`\n+driver_impl_unpretty_dump_fail = pretty-print failed to write `{$path}` due to error `{$err}`\n \n-driver_ice = the compiler unexpectedly panicked. this is a bug.\n-driver_ice_bug_report = we would appreciate a bug report: {$bug_report_url}\n-driver_ice_version = rustc {$version} running on {$triple}\n-driver_ice_flags = compiler flags: {$flags}\n-driver_ice_exclude_cargo_defaults = some of the compiler flags provided by cargo are hidden\n+driver_impl_ice = the compiler unexpectedly panicked. this is a bug.\n+driver_impl_ice_bug_report = we would appreciate a bug report: {$bug_report_url}\n+driver_impl_ice_version = rustc {$version} running on {$triple}\n+driver_impl_ice_flags = compiler flags: {$flags}\n+driver_impl_ice_exclude_cargo_defaults = some of the compiler flags provided by cargo are hidden"}]}