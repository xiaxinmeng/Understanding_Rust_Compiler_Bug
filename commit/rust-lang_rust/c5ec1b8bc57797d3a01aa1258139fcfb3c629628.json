{"sha": "c5ec1b8bc57797d3a01aa1258139fcfb3c629628", "node_id": "C_kwDOAAsO6NoAKGM1ZWMxYjhiYzU3Nzk3ZDNhMDFhYTEyNTgxMzlmY2ZiM2M2Mjk2Mjg", "commit": {"author": {"name": "lcnr", "email": "rust@lcnr.de", "date": "2023-05-19T08:44:38Z"}, "committer": {"name": "lcnr", "email": "rust@lcnr.de", "date": "2023-05-19T08:44:38Z"}, "message": "add test", "tree": {"sha": "f0ffd7a1fc270b75b0dd405bbfb23c10a074bc9b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f0ffd7a1fc270b75b0dd405bbfb23c10a074bc9b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c5ec1b8bc57797d3a01aa1258139fcfb3c629628", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c5ec1b8bc57797d3a01aa1258139fcfb3c629628", "html_url": "https://github.com/rust-lang/rust/commit/c5ec1b8bc57797d3a01aa1258139fcfb3c629628", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c5ec1b8bc57797d3a01aa1258139fcfb3c629628/comments", "author": {"login": "lcnr", "id": 29864074, "node_id": "MDQ6VXNlcjI5ODY0MDc0", "avatar_url": "https://avatars.githubusercontent.com/u/29864074?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lcnr", "html_url": "https://github.com/lcnr", "followers_url": "https://api.github.com/users/lcnr/followers", "following_url": "https://api.github.com/users/lcnr/following{/other_user}", "gists_url": "https://api.github.com/users/lcnr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lcnr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lcnr/subscriptions", "organizations_url": "https://api.github.com/users/lcnr/orgs", "repos_url": "https://api.github.com/users/lcnr/repos", "events_url": "https://api.github.com/users/lcnr/events{/privacy}", "received_events_url": "https://api.github.com/users/lcnr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lcnr", "id": 29864074, "node_id": "MDQ6VXNlcjI5ODY0MDc0", "avatar_url": "https://avatars.githubusercontent.com/u/29864074?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lcnr", "html_url": "https://github.com/lcnr", "followers_url": "https://api.github.com/users/lcnr/followers", "following_url": "https://api.github.com/users/lcnr/following{/other_user}", "gists_url": "https://api.github.com/users/lcnr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lcnr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lcnr/subscriptions", "organizations_url": "https://api.github.com/users/lcnr/orgs", "repos_url": "https://api.github.com/users/lcnr/repos", "events_url": "https://api.github.com/users/lcnr/events{/privacy}", "received_events_url": "https://api.github.com/users/lcnr/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1708ad65a45fa39aa177c5f015415a9440c18912", "url": "https://api.github.com/repos/rust-lang/rust/commits/1708ad65a45fa39aa177c5f015415a9440c18912", "html_url": "https://github.com/rust-lang/rust/commit/1708ad65a45fa39aa177c5f015415a9440c18912"}], "stats": {"total": 76, "additions": 75, "deletions": 1}, "files": [{"sha": "aee41c43aefeb75b8acb6757c924e2ad3ea4808b", "filename": "tests/ui/traits/cycle-cache-err-60010.stderr", "status": "modified", "additions": 17, "deletions": 1, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/c5ec1b8bc57797d3a01aa1258139fcfb3c629628/tests%2Fui%2Ftraits%2Fcycle-cache-err-60010.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c5ec1b8bc57797d3a01aa1258139fcfb3c629628/tests%2Fui%2Ftraits%2Fcycle-cache-err-60010.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftraits%2Fcycle-cache-err-60010.stderr?ref=c5ec1b8bc57797d3a01aa1258139fcfb3c629628", "patch": "@@ -1,9 +1,25 @@\n-error[E0275]: overflow evaluating the requirement `RootDatabase: RefUnwindSafe`\n+error[E0275]: overflow evaluating the requirement `SalsaStorage: RefUnwindSafe`\n   --> $DIR/cycle-cache-err-60010.rs:27:13\n    |\n LL |     _parse: <ParseQuery as Query<RootDatabase>>::Data,\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |\n+note: required because it appears within the type `PhantomData<SalsaStorage>`\n+  --> $SRC_DIR/core/src/marker.rs:LL:COL\n+note: required because it appears within the type `Unique<SalsaStorage>`\n+  --> $SRC_DIR/core/src/ptr/unique.rs:LL:COL\n+note: required because it appears within the type `Box<SalsaStorage>`\n+  --> $SRC_DIR/alloc/src/boxed.rs:LL:COL\n+note: required because it appears within the type `Runtime<RootDatabase>`\n+  --> $DIR/cycle-cache-err-60010.rs:23:8\n+   |\n+LL | struct Runtime<DB: Database> {\n+   |        ^^^^^^^\n+note: required because it appears within the type `RootDatabase`\n+  --> $DIR/cycle-cache-err-60010.rs:20:8\n+   |\n+LL | struct RootDatabase {\n+   |        ^^^^^^^^^^^^\n note: required for `RootDatabase` to implement `SourceDatabase`\n   --> $DIR/cycle-cache-err-60010.rs:44:9\n    |"}, {"sha": "d37943b929a1fe942d0650ee4427331332d9c43b", "filename": "tests/ui/traits/solver-cycles/cycle-via-builtin-auto-trait-impl.rs", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/c5ec1b8bc57797d3a01aa1258139fcfb3c629628/tests%2Fui%2Ftraits%2Fsolver-cycles%2Fcycle-via-builtin-auto-trait-impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c5ec1b8bc57797d3a01aa1258139fcfb3c629628/tests%2Fui%2Ftraits%2Fsolver-cycles%2Fcycle-via-builtin-auto-trait-impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftraits%2Fsolver-cycles%2Fcycle-via-builtin-auto-trait-impl.rs?ref=c5ec1b8bc57797d3a01aa1258139fcfb3c629628", "patch": "@@ -0,0 +1,34 @@\n+//~ ERROR overflow\n+// A regression test for #111729 checking that we correctly\n+// track recursion depth for obligations returned by confirmation.\n+use std::panic::RefUnwindSafe;\n+\n+trait Database {\n+    type Storage;\n+}\n+trait Query<DB> {\n+    type Data;\n+}\n+struct ParseQuery;\n+struct RootDatabase {\n+    _runtime: Runtime<RootDatabase>,\n+}\n+\n+impl<T: RefUnwindSafe> Database for T {\n+    type Storage = SalsaStorage;\n+}\n+impl Database for RootDatabase {\n+    type Storage = SalsaStorage;\n+}\n+\n+struct Runtime<DB: Database> {\n+    _storage: Box<DB::Storage>,\n+}\n+struct SalsaStorage {\n+    _parse: <ParseQuery as Query<RootDatabase>>::Data,\n+}\n+\n+impl<DB: Database> Query<DB> for ParseQuery {\n+    type Data = RootDatabase;\n+}\n+fn main() {}"}, {"sha": "8f9ce3ef1e99c6ca2d603caf68945ad5f181041e", "filename": "tests/ui/traits/solver-cycles/cycle-via-builtin-auto-trait-impl.stderr", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/c5ec1b8bc57797d3a01aa1258139fcfb3c629628/tests%2Fui%2Ftraits%2Fsolver-cycles%2Fcycle-via-builtin-auto-trait-impl.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c5ec1b8bc57797d3a01aa1258139fcfb3c629628/tests%2Fui%2Ftraits%2Fsolver-cycles%2Fcycle-via-builtin-auto-trait-impl.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftraits%2Fsolver-cycles%2Fcycle-via-builtin-auto-trait-impl.stderr?ref=c5ec1b8bc57797d3a01aa1258139fcfb3c629628", "patch": "@@ -0,0 +1,24 @@\n+error[E0275]: overflow evaluating the requirement `Runtime<RootDatabase>: RefUnwindSafe`\n+   |\n+   = help: consider increasing the recursion limit by adding a `#![recursion_limit = \"256\"]` attribute to your crate (`cycle_via_builtin_auto_trait_impl`)\n+note: required because it appears within the type `RootDatabase`\n+  --> $DIR/cycle-via-builtin-auto-trait-impl.rs:13:8\n+   |\n+LL | struct RootDatabase {\n+   |        ^^^^^^^^^^^^\n+note: required for `RootDatabase` to implement `Database`\n+  --> $DIR/cycle-via-builtin-auto-trait-impl.rs:17:24\n+   |\n+LL | impl<T: RefUnwindSafe> Database for T {\n+   |         -------------  ^^^^^^^^     ^\n+   |         |\n+   |         unsatisfied trait bound introduced here\n+note: required because it appears within the type `Runtime<RootDatabase>`\n+  --> $DIR/cycle-via-builtin-auto-trait-impl.rs:24:8\n+   |\n+LL | struct Runtime<DB: Database> {\n+   |        ^^^^^^^\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0275`."}]}