{"sha": "99b73e81b351d036449e76ad753160853625c5b6", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk5YjczZTgxYjM1MWQwMzY0NDllNzZhZDc1MzE2MDg1MzYyNWM1YjY=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-08-21T15:51:50Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-08-21T15:51:50Z"}, "message": "Auto merge of #88134 - rylev:force-warn-improvements, r=nikomatsakis\n\nForce warn improvements\n\nAs part of stablization of the `--force-warn` option (#86516) I've made the following changes:\n* Error when the `warnings` lint group is based to the `--force-warn` option\n* Tests have been updated to make it easier to understand the semantics of `--force-warn`\n\nr? `@nikomatsakis`", "tree": {"sha": "597e2840c4d682b9d52795d8c7212326f5b66d13", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/597e2840c4d682b9d52795d8c7212326f5b66d13"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/99b73e81b351d036449e76ad753160853625c5b6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/99b73e81b351d036449e76ad753160853625c5b6", "html_url": "https://github.com/rust-lang/rust/commit/99b73e81b351d036449e76ad753160853625c5b6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/99b73e81b351d036449e76ad753160853625c5b6/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b6e334d87349502766be70d649e6fe4a73573482", "url": "https://api.github.com/repos/rust-lang/rust/commits/b6e334d87349502766be70d649e6fe4a73573482", "html_url": "https://github.com/rust-lang/rust/commit/b6e334d87349502766be70d649e6fe4a73573482"}, {"sha": "d70056e30c9253f42eb12f1030b4977a2a6bc688", "url": "https://api.github.com/repos/rust-lang/rust/commits/d70056e30c9253f42eb12f1030b4977a2a6bc688", "html_url": "https://github.com/rust-lang/rust/commit/d70056e30c9253f42eb12f1030b4977a2a6bc688"}], "stats": {"total": 152, "additions": 139, "deletions": 13}, "files": [{"sha": "7980b704cae6d1e09e067bdbed7cc7cb12352473", "filename": "compiler/rustc_error_codes/src/error_codes/E0602.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0602.md", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0602.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_error_codes%2Fsrc%2Ferror_codes%2FE0602.md?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,4 +1,4 @@\n-An unknown lint was used on the command line.\n+An unknown or invalid lint was used on the command line.\n \n Erroneous code example:\n "}, {"sha": "c2a46e997df4797660411333d3daf8b6317b211d", "filename": "compiler/rustc_lint/src/context.rs", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/compiler%2Frustc_lint%2Fsrc%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/compiler%2Frustc_lint%2Fsrc%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Fcontext.rs?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -332,7 +332,16 @@ impl LintStore {\n         crate_attrs: &[ast::Attribute],\n     ) {\n         let (tool_name, lint_name_only) = parse_lint_and_tool_name(lint_name);\n-\n+        if lint_name_only == crate::WARNINGS.name_lower() && level == Level::ForceWarn {\n+            return struct_span_err!(\n+                sess,\n+                DUMMY_SP,\n+                E0602,\n+                \"`{}` lint group is not supported with \u00b4--force-warn\u00b4\",\n+                crate::WARNINGS.name_lower()\n+            )\n+            .emit();\n+        }\n         let db = match self.check_lint_name(sess, lint_name_only, tool_name, crate_attrs) {\n             CheckLintNameResult::Ok(_) => None,\n             CheckLintNameResult::Warning(ref msg, _) => Some(sess.struct_warn(msg)),"}, {"sha": "6ee5ba6793280676f7bb885c4dd11c63edc6a18a", "filename": "src/test/ui/lint/force-warn/allow-warnings.rs", "status": "renamed", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallow-warnings.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallow-warnings.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallow-warnings.rs?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,3 +1,5 @@\n+// --force-warn $LINT causes $LINT (which is warn-by-default) to warn\n+// despite allowing all warnings in module\n // compile-flags: --force-warn dead_code -Zunstable-options\n // check-pass\n ", "previous_filename": "src/test/ui/lint/force-warn/force-lint-allow-all-warnings.rs"}, {"sha": "cac2b4e91890917a4957538a881bcb3e757950ee", "filename": "src/test/ui/lint/force-warn/allow-warnings.stderr", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallow-warnings.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallow-warnings.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallow-warnings.stderr?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,5 +1,5 @@\n warning: function is never used: `dead_function`\n-  --> $DIR/force-allowed-warning.rs:6:4\n+  --> $DIR/allow-warnings.rs:8:4\n    |\n LL | fn dead_function() {}\n    |    ^^^^^^^^^^^^^", "previous_filename": "src/test/ui/lint/force-warn/force-allowed-warning.stderr"}, {"sha": "fd0b886d84dbeef48ed775d6248839277d58f8e5", "filename": "src/test/ui/lint/force-warn/allowed-by-default-lint.rs", "status": "renamed", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-by-default-lint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-by-default-lint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-by-default-lint.rs?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,3 +1,4 @@\n+// --force-warn $LINT causes $LINT (which is allow-by-default) to warn\n // compile-flags: --force-warn elided_lifetimes_in_paths -Zunstable-options\n // check-pass\n ", "previous_filename": "src/test/ui/lint/force-warn/force-allowed-by-default-lint.rs"}, {"sha": "baa47cbb10fd5a6529a5e29ae856e961553798b0", "filename": "src/test/ui/lint/force-warn/allowed-by-default-lint.stderr", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-by-default-lint.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-by-default-lint.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-by-default-lint.stderr?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,5 +1,5 @@\n warning: hidden lifetime parameters in types are deprecated\n-  --> $DIR/force-allowed-by-default-lint.rs:8:12\n+  --> $DIR/allowed-by-default-lint.rs:9:12\n    |\n LL | fn foo(x: &Foo) {}\n    |            ^^^- help: indicate the anonymous lifetime: `<'_>`", "previous_filename": "src/test/ui/lint/force-warn/force-allowed-by-default-lint.stderr"}, {"sha": "3fab9148392beae16e234badeeae7c8bfcf367ee", "filename": "src/test/ui/lint/force-warn/allowed-cli-deny-by-default-lint.rs", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-cli-deny-by-default-lint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-cli-deny-by-default-lint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-cli-deny-by-default-lint.rs?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -0,0 +1,10 @@\n+// --force-warn $LINT causes $LINT (which is deny-by-default) to warn\n+// despite $LINT being allowed on command line\n+// compile-flags: -A const_err --force-warn const_err -Zunstable-options\n+// check-pass\n+\n+const C: i32 = 1 / 0;\n+//~^ WARN any use of this value will cause an error\n+//~| WARN this was previously accepted by the compiler\n+\n+fn main() {}"}, {"sha": "af6308f0d1b4f1a6fbcfe7ba12b7c2a2b21d4893", "filename": "src/test/ui/lint/force-warn/allowed-cli-deny-by-default-lint.stderr", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-cli-deny-by-default-lint.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-cli-deny-by-default-lint.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-cli-deny-by-default-lint.stderr?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,5 +1,5 @@\n warning: any use of this value will cause an error\n-  --> $DIR/force-allowed-deny-by-default-lint.rs:5:16\n+  --> $DIR/allowed-cli-deny-by-default-lint.rs:6:16\n    |\n LL | const C: i32 = 1 / 0;\n    | ---------------^^^^^-", "previous_filename": "src/test/ui/lint/force-warn/force-allowed-deny-by-default-lint.stderr"}, {"sha": "82a584ac97265e7421716fc9252f89be11df9454", "filename": "src/test/ui/lint/force-warn/allowed-deny-by-default-lint.rs", "status": "renamed", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-deny-by-default-lint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-deny-by-default-lint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-deny-by-default-lint.rs?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,3 +1,5 @@\n+// --force-warn $LINT causes $LINT (which is deny-by-default) to warn\n+// despite $LINT being allowed in module\n // compile-flags: --force-warn const_err -Zunstable-options\n // check-pass\n ", "previous_filename": "src/test/ui/lint/force-warn/force-allowed-deny-by-default-lint.rs"}, {"sha": "05656afd22d88fa68ce33829a31e3706f2dd6e5e", "filename": "src/test/ui/lint/force-warn/allowed-deny-by-default-lint.stderr", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-deny-by-default-lint.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-deny-by-default-lint.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-deny-by-default-lint.stderr?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -0,0 +1,14 @@\n+warning: any use of this value will cause an error\n+  --> $DIR/allowed-deny-by-default-lint.rs:7:16\n+   |\n+LL | const C: i32 = 1 / 0;\n+   | ---------------^^^^^-\n+   |                |\n+   |                attempt to divide `1_i32` by zero\n+   |\n+   = note: requested on the command line with `--force-warn const-err`\n+   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n+   = note: for more information, see issue #71800 <https://github.com/rust-lang/rust/issues/71800>\n+\n+warning: 1 warning emitted\n+"}, {"sha": "86ab12668a3e4f0dd98d4520185f94117a3ed4c7", "filename": "src/test/ui/lint/force-warn/allowed-group-warn-by-default-lint.rs", "status": "renamed", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-group-warn-by-default-lint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-group-warn-by-default-lint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-group-warn-by-default-lint.rs?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,3 +1,5 @@\n+// --force-warn $LINT causes $LINT (which is warn-by-default) to warn\n+// despite $LINT_GROUP (which contains $LINT) being allowed\n // compile-flags: --force-warn bare_trait_objects -Zunstable-options\n // check-pass\n ", "previous_filename": "src/test/ui/lint/force-warn/force-lint-in-allowed-group.rs"}, {"sha": "d945cc3347aab0703d98d8f28940d4580c7b3963", "filename": "src/test/ui/lint/force-warn/allowed-group-warn-by-default-lint.stderr", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-group-warn-by-default-lint.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-group-warn-by-default-lint.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-group-warn-by-default-lint.stderr?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,5 +1,5 @@\n warning: trait objects without an explicit `dyn` are deprecated\n-  --> $DIR/force-lint-in-allowed-group.rs:8:25\n+  --> $DIR/allowed-group-warn-by-default-lint.rs:10:25\n    |\n LL | pub fn function(_x: Box<SomeTrait>) {}\n    |                         ^^^^^^^^^ help: use `dyn`: `dyn SomeTrait`", "previous_filename": "src/test/ui/lint/force-warn/force-lint-in-allowed-group.stderr"}, {"sha": "7204782a324e301faf1085ac21f9aa98316d803f", "filename": "src/test/ui/lint/force-warn/allowed-warn-by-default-lint.rs", "status": "renamed", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-warn-by-default-lint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-warn-by-default-lint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-warn-by-default-lint.rs?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,3 +1,5 @@\n+// --force-warn $LINT causes $LINT (which is warn-by-default) to warn\n+// despite $LINT being allowed in module\n // compile-flags: --force-warn dead_code -Zunstable-options\n // check-pass\n ", "previous_filename": "src/test/ui/lint/force-warn/force-allowed-warning.rs"}, {"sha": "c46d7403fd0230ba5109c9d0cad438321151b96f", "filename": "src/test/ui/lint/force-warn/allowed-warn-by-default-lint.stderr", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-warn-by-default-lint.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-warn-by-default-lint.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-warn-by-default-lint.stderr?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,5 +1,5 @@\n warning: function is never used: `dead_function`\n-  --> $DIR/force-lint-allow-all-warnings.rs:6:4\n+  --> $DIR/allowed-warn-by-default-lint.rs:8:4\n    |\n LL | fn dead_function() {}\n    |    ^^^^^^^^^^^^^", "previous_filename": "src/test/ui/lint/force-warn/force-lint-allow-all-warnings.stderr"}, {"sha": "de3a1bd8dd71996e3de895a3c34ef30b67d2adab", "filename": "src/test/ui/lint/force-warn/cap-lints-allow.rs", "status": "renamed", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-allow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-allow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-allow.rs?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,3 +1,5 @@\n+// --force-warn $LINT casuses $LINT to warn despite --cap-lints\n+// set to allow\n // compile-flags: --cap-lints allow  --force-warn bare_trait_objects -Zunstable-options\n // check-pass\n ", "previous_filename": "src/test/ui/lint/force-warn/force-warn-cap-lints-allow.rs"}, {"sha": "f3ae16b5657f2eb5bf7fc1b919ef4b2cf9e6d503", "filename": "src/test/ui/lint/force-warn/cap-lints-allow.stderr", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-allow.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-allow.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-allow.stderr?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,5 +1,5 @@\n warning: trait objects without an explicit `dyn` are deprecated\n-  --> $DIR/force-warn-cap-lints-allow.rs:6:25\n+  --> $DIR/cap-lints-allow.rs:8:25\n    |\n LL | pub fn function(_x: Box<SomeTrait>) {}\n    |                         ^^^^^^^^^ help: use `dyn`: `dyn SomeTrait`", "previous_filename": "src/test/ui/lint/force-warn/force-warn-cap-lints-allow.stderr"}, {"sha": "70fb90dc1992b9897711c4844233072ea2dd2d14", "filename": "src/test/ui/lint/force-warn/cap-lints-warn-allowed-warn-by-default-lint.rs", "status": "renamed", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-warn-allowed-warn-by-default-lint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-warn-allowed-warn-by-default-lint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-warn-allowed-warn-by-default-lint.rs?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,3 +1,5 @@\n+// --force-warn $LINT_GROUP causes $LINT to warn despite $LINT being\n+// allowed in module and cap-lints set to warn\n // compile-flags: --cap-lints warn  --force-warn rust-2021-compatibility -Zunstable-options\n // check-pass\n #![allow(ellipsis_inclusive_range_patterns)]", "previous_filename": "src/test/ui/lint/force-warn/force-warn-cap-lints-warn.rs"}, {"sha": "3dafaf7055fd05abb2cc02a9d9f45f266f021744", "filename": "src/test/ui/lint/force-warn/cap-lints-warn-allowed-warn-by-default-lint.stderr", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-warn-allowed-warn-by-default-lint.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-warn-allowed-warn-by-default-lint.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-warn-allowed-warn-by-default-lint.stderr?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,5 +1,5 @@\n warning: `...` range patterns are deprecated\n-  --> $DIR/force-warn-cap-lints-warn.rs:8:10\n+  --> $DIR/cap-lints-warn-allowed-warn-by-default-lint.rs:10:10\n    |\n LL |         0...100 => true,\n    |          ^^^ help: use `..=` for an inclusive range", "previous_filename": "src/test/ui/lint/force-warn/force-warn-cap-lints-warn.stderr"}, {"sha": "b0a15cc2fba063179e9f02ecb0a68df181e6159e", "filename": "src/test/ui/lint/force-warn/deny-by-default-lint.rs", "status": "renamed", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fdeny-by-default-lint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fdeny-by-default-lint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fdeny-by-default-lint.rs?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,3 +1,4 @@\n+// --force-warn $LINT causes $LINT (which is deny-by-default) to warn\n // compile-flags: --force-warn const_err -Zunstable-options\n // check-pass\n ", "previous_filename": "src/test/ui/lint/force-warn/force-deny-by-default-lint.rs"}, {"sha": "ef295f99e649cbba17f36805c2fb3706ac1c29a6", "filename": "src/test/ui/lint/force-warn/deny-by-default-lint.stderr", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fdeny-by-default-lint.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fdeny-by-default-lint.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fdeny-by-default-lint.stderr?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,5 +1,5 @@\n warning: any use of this value will cause an error\n-  --> $DIR/force-deny-by-default-lint.rs:4:16\n+  --> $DIR/deny-by-default-lint.rs:5:16\n    |\n LL | const C: i32 = 1 / 0;\n    | ---------------^^^^^-", "previous_filename": "src/test/ui/lint/force-warn/force-deny-by-default-lint.stderr"}, {"sha": "e5dcd9a7ea16f66a5bb521760b6b80b145d8be4b", "filename": "src/test/ui/lint/force-warn/lint-group-allow-warnings.rs", "status": "renamed", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allow-warnings.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allow-warnings.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allow-warnings.rs?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,3 +1,6 @@\n+// --force-warn $LINT_GROUP causes $LINT in $LINT_GROUP to warn\n+// despite all warnings being allowed in module\n+// warn-by-default lint to warn\n // compile-flags: --force-warn nonstandard_style -Zunstable-options\n // check-pass\n ", "previous_filename": "src/test/ui/lint/force-warn/force-lint-group-allow-all-warnings.rs"}, {"sha": "dc7b1b7b98d0c03867374f851175358dc4b63a2f", "filename": "src/test/ui/lint/force-warn/lint-group-allow-warnings.stderr", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allow-warnings.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allow-warnings.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allow-warnings.stderr?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,5 +1,5 @@\n warning: function `FUNCTION` should have a snake case name\n-  --> $DIR/force-lint-group-allow-all-warnings.rs:6:8\n+  --> $DIR/lint-group-allow-warnings.rs:9:8\n    |\n LL | pub fn FUNCTION() {}\n    |        ^^^^^^^^ help: convert the identifier to snake case: `function`", "previous_filename": "src/test/ui/lint/force-warn/force-lint-group-allow-all-warnings.stderr"}, {"sha": "4eb05b538b0baea63e6e4c9c9bdc75272e98d7e1", "filename": "src/test/ui/lint/force-warn/lint-group-allowed-cli-warn-by-default-lint.rs", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-cli-warn-by-default-lint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-cli-warn-by-default-lint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-cli-warn-by-default-lint.rs?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -0,0 +1,12 @@\n+// --force-warn $LINT_GROUP causes $LINT (which is warn-by-default) to warn\n+// despite $LINT being allowed on command line\n+// compile-flags: -A bare-trait-objects --force-warn rust-2018-idioms -Zunstable-options\n+// check-pass\n+\n+pub trait SomeTrait {}\n+\n+pub fn function(_x: Box<SomeTrait>) {}\n+//~^ WARN trait objects without an explicit `dyn` are deprecated\n+//~| WARN this is accepted in the current edition\n+\n+fn main() {}"}, {"sha": "dc62521bf898b6d3dd414324ae015ea3ecd62a62", "filename": "src/test/ui/lint/force-warn/lint-group-allowed-cli-warn-by-default-lint.stderr", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-cli-warn-by-default-lint.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-cli-warn-by-default-lint.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-cli-warn-by-default-lint.stderr?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -0,0 +1,12 @@\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/lint-group-allowed-cli-warn-by-default-lint.rs:8:25\n+   |\n+LL | pub fn function(_x: Box<SomeTrait>) {}\n+   |                         ^^^^^^^^^ help: use `dyn`: `dyn SomeTrait`\n+   |\n+   = note: `--force-warn bare-trait-objects` implied by `--force-warn rust-2018-idioms`\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n+warning: 1 warning emitted\n+"}, {"sha": "dc13b2b24748cae831aa753d28a5301de55601a1", "filename": "src/test/ui/lint/force-warn/lint-group-allowed-lint-group.rs", "status": "renamed", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-lint-group.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-lint-group.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-lint-group.rs?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,3 +1,5 @@\n+// --force-warn $LINT_GROUP causes $LINT to warn despite\n+// $LINT_GROUP being allowed in module\n // compile-flags: --force-warn rust_2018_idioms -Zunstable-options\n // check-pass\n ", "previous_filename": "src/test/ui/lint/force-warn/force-warn-group.rs"}, {"sha": "fcbae024eb60fa77e3f261718b2a41cea8613f96", "filename": "src/test/ui/lint/force-warn/lint-group-allowed-lint-group.stderr", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-lint-group.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-lint-group.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-lint-group.stderr?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,5 +1,5 @@\n warning: trait objects without an explicit `dyn` are deprecated\n-  --> $DIR/force-warn-group.rs:8:25\n+  --> $DIR/lint-group-allowed-lint-group.rs:10:25\n    |\n LL | pub fn function(_x: Box<SomeTrait>) {}\n    |                         ^^^^^^^^^ help: use `dyn`: `dyn SomeTrait`", "previous_filename": "src/test/ui/lint/force-warn/force-warn-group.stderr"}, {"sha": "b7f79b3d4aa3bf9171e8a50eeeeb1c8e2a17d787", "filename": "src/test/ui/lint/force-warn/lint-group-allowed-warn-by-default-lint.rs", "status": "renamed", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-warn-by-default-lint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-warn-by-default-lint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-warn-by-default-lint.rs?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,3 +1,5 @@\n+// --force-warn $LINT_GROUP causes $LINT (which is warn-by-default) to warn\n+// despite $LINT being allowed in module\n // compile-flags: --force-warn rust-2018-idioms -Zunstable-options\n // check-pass\n ", "previous_filename": "src/test/ui/lint/force-warn/force-warn-group-allow-warning.rs"}, {"sha": "1212ae083c23b2d8c0a6c5d8e55c36dc50404938", "filename": "src/test/ui/lint/force-warn/lint-group-allowed-warn-by-default-lint.stderr", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-warn-by-default-lint.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-warn-by-default-lint.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-warn-by-default-lint.stderr?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -1,5 +1,5 @@\n warning: trait objects without an explicit `dyn` are deprecated\n-  --> $DIR/force-warn-group-allow-warning.rs:8:25\n+  --> $DIR/lint-group-allowed-warn-by-default-lint.rs:10:25\n    |\n LL | pub fn function(_x: Box<SomeTrait>) {}\n    |                         ^^^^^^^^^ help: use `dyn`: `dyn SomeTrait`", "previous_filename": "src/test/ui/lint/force-warn/force-warn-group-allow-warning.stderr"}, {"sha": "d2cb3417be68a272c412622ac06afdc40994f8c1", "filename": "src/test/ui/lint/force-warn/warn-by-default-lint-two-modules.rs", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fwarn-by-default-lint-two-modules.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fwarn-by-default-lint-two-modules.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fwarn-by-default-lint-two-modules.rs?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -0,0 +1,18 @@\n+// --force-warn $LINT causes $LINT (which is warn-by-default) to warn\n+// despite being allowed in one submodule (but not the other)\n+// compile-flags: --force-warn dead_code -Zunstable-options\n+// check-pass\n+\n+mod one {\n+    #![allow(dead_code)]\n+\n+    fn dead_function() {}\n+    //~^ WARN function is never used\n+}\n+\n+mod two {\n+    fn dead_function() {}\n+    //~^ WARN function is never used\n+}\n+\n+fn main() {}"}, {"sha": "2a3cf85a1e331776e0742782b375bc75195836e2", "filename": "src/test/ui/lint/force-warn/warn-by-default-lint-two-modules.stderr", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fwarn-by-default-lint-two-modules.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fwarn-by-default-lint-two-modules.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fwarn-by-default-lint-two-modules.stderr?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -0,0 +1,16 @@\n+warning: function is never used: `dead_function`\n+  --> $DIR/warn-by-default-lint-two-modules.rs:9:8\n+   |\n+LL |     fn dead_function() {}\n+   |        ^^^^^^^^^^^^^\n+   |\n+   = note: requested on the command line with `--force-warn dead-code`\n+\n+warning: function is never used: `dead_function`\n+  --> $DIR/warn-by-default-lint-two-modules.rs:14:8\n+   |\n+LL |     fn dead_function() {}\n+   |        ^^^^^^^^^^^^^\n+\n+warning: 2 warnings emitted\n+"}, {"sha": "fa25a1f8a842a906fd9c140e61aae4c253c8a77f", "filename": "src/test/ui/lint/force-warn/warnings-lint-group.rs", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fwarnings-lint-group.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fwarnings-lint-group.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fwarnings-lint-group.rs?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -0,0 +1,5 @@\n+// --force-warn warnings is an error\n+// compile-flags: --force-warn warnings -Zunstable-options\n+// error-pattern: `warnings` lint group is not supported\n+\n+fn main() {}"}, {"sha": "03f5788b527d3fabfd50bfcfddd9f1325a0874a9", "filename": "src/test/ui/lint/force-warn/warnings-lint-group.stderr", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fwarnings-lint-group.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/99b73e81b351d036449e76ad753160853625c5b6/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fwarnings-lint-group.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fwarnings-lint-group.stderr?ref=99b73e81b351d036449e76ad753160853625c5b6", "patch": "@@ -0,0 +1,9 @@\n+error[E0602]: `warnings` lint group is not supported with \u00b4--force-warn\u00b4\n+\n+error[E0602]: `warnings` lint group is not supported with \u00b4--force-warn\u00b4\n+\n+error[E0602]: `warnings` lint group is not supported with \u00b4--force-warn\u00b4\n+\n+error: aborting due to 3 previous errors\n+\n+For more information about this error, try `rustc --explain E0602`."}]}