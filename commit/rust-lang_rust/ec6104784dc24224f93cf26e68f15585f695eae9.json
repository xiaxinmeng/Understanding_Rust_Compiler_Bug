{"sha": "ec6104784dc24224f93cf26e68f15585f695eae9", "node_id": "C_kwDOAAsO6NoAKGVjNjEwNDc4NGRjMjQyMjRmOTNjZjI2ZTY4ZjE1NTg1ZjY5NWVhZTk", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-09-17T17:27:05Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-09-17T17:27:05Z"}, "message": "Rollup merge of #101781 - chriswailes:dynamic-llvm-on-musl, r=jyn514\n\nExtend list of targets that support dyanmic linking for llvm tools\n\nThis commit adds `linux-musl` to the list of targets that support dynamic linking for the LLVM tools.", "tree": {"sha": "b141721a97bcd8467bd1ee4f189e197f7a512261", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b141721a97bcd8467bd1ee4f189e197f7a512261"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ec6104784dc24224f93cf26e68f15585f695eae9", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjJgNpCRBK7hj4Ov3rIwAAmEcIAA/Y8ZNzNROCjjjgEujew59B\nrdRT2n03Sez+EuHGovpYiyRKhnAvNP5rSzNxW5v+N9ySkybjJ1ucmC0zjUCTN6yO\nlqh/y+FkAOyV9Q/dgu/HK8wIxe7DbwPETkesMXL0YjKDRzn1psMOPeb6wX/+Z/o5\n6eGDPFT9RZocYeSfkkSBRhQwl8V2dfMOVkTuz1aAPqAVNB1Vb4TeTC68bgipyvBI\nh0RDYQzfBZPYCJ89rkWf1jwMQZbY1s8XinzmuAnZIE7PHhC0rkDi/+XubvY8hbU/\n6YhzEPuI4AkCEpDmIQ513/LrFyFWQ241GJm7Lo5xScvfdcxhLnH3pcoR/TA01qI=\n=HCVE\n-----END PGP SIGNATURE-----\n", "payload": "tree b141721a97bcd8467bd1ee4f189e197f7a512261\nparent 00d88bdb2c59c4d40add0aa36ba1013d06afd32f\nparent 999502978612be1379240f792614f8580e49d123\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1663435625 +0200\ncommitter GitHub <noreply@github.com> 1663435625 +0200\n\nRollup merge of #101781 - chriswailes:dynamic-llvm-on-musl, r=jyn514\n\nExtend list of targets that support dyanmic linking for llvm tools\n\nThis commit adds `linux-musl` to the list of targets that support dynamic linking for the LLVM tools.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ec6104784dc24224f93cf26e68f15585f695eae9", "html_url": "https://github.com/rust-lang/rust/commit/ec6104784dc24224f93cf26e68f15585f695eae9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ec6104784dc24224f93cf26e68f15585f695eae9/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "00d88bdb2c59c4d40add0aa36ba1013d06afd32f", "url": "https://api.github.com/repos/rust-lang/rust/commits/00d88bdb2c59c4d40add0aa36ba1013d06afd32f", "html_url": "https://github.com/rust-lang/rust/commit/00d88bdb2c59c4d40add0aa36ba1013d06afd32f"}, {"sha": "999502978612be1379240f792614f8580e49d123", "url": "https://api.github.com/repos/rust-lang/rust/commits/999502978612be1379240f792614f8580e49d123", "html_url": "https://github.com/rust-lang/rust/commit/999502978612be1379240f792614f8580e49d123"}], "stats": {"total": 15, "additions": 3, "deletions": 12}, "files": [{"sha": "fade44ecb158b7314e9322365854d4396a94c144", "filename": "src/bootstrap/lib.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ec6104784dc24224f93cf26e68f15585f695eae9/src%2Fbootstrap%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ec6104784dc24224f93cf26e68f15585f695eae9/src%2Fbootstrap%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Flib.rs?ref=ec6104784dc24224f93cf26e68f15585f695eae9", "patch": "@@ -1307,10 +1307,6 @@ impl Build {\n         self.package_vers(&self.version)\n     }\n \n-    fn llvm_link_tools_dynamically(&self, target: TargetSelection) -> bool {\n-        target.contains(\"linux-gnu\") || target.contains(\"apple-darwin\")\n-    }\n-\n     /// Returns the `version` string associated with this compiler for Rust\n     /// itself.\n     ///"}, {"sha": "d6ee6d489cf04ce87646364ef3b22cbadabb195e", "filename": "src/bootstrap/native.rs", "status": "modified", "additions": 2, "deletions": 7, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/ec6104784dc24224f93cf26e68f15585f695eae9/src%2Fbootstrap%2Fnative.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ec6104784dc24224f93cf26e68f15585f695eae9/src%2Fbootstrap%2Fnative.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fnative.rs?ref=ec6104784dc24224f93cf26e68f15585f695eae9", "patch": "@@ -423,12 +423,7 @@ impl Step for Llvm {\n         // which saves both memory during parallel links and overall disk space\n         // for the tools. We don't do this on every platform as it doesn't work\n         // equally well everywhere.\n-        //\n-        // If we're not linking rustc to a dynamic LLVM, though, then don't link\n-        // tools to it.\n-        let llvm_link_shared =\n-            builder.llvm_link_tools_dynamically(target) && builder.llvm_link_shared();\n-        if llvm_link_shared {\n+        if builder.llvm_link_shared() {\n             cfg.define(\"LLVM_LINK_LLVM_DYLIB\", \"ON\");\n         }\n \n@@ -553,7 +548,7 @@ impl Step for Llvm {\n         // libLLVM.dylib will be built. However, llvm-config will still look\n         // for a versioned path like libLLVM-14.dylib. Manually create a symbolic\n         // link to make llvm-config happy.\n-        if llvm_link_shared && target.contains(\"apple-darwin\") {\n+        if builder.llvm_link_shared() && target.contains(\"apple-darwin\") {\n             let mut cmd = Command::new(&build_llvm_config);\n             let version = output(cmd.arg(\"--version\"));\n             let major = version.split('.').next().unwrap();"}, {"sha": "7826fd514093e255cb789106d0a74095cbbba358", "filename": "src/ci/github-actions/ci.yml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ec6104784dc24224f93cf26e68f15585f695eae9/src%2Fci%2Fgithub-actions%2Fci.yml", "raw_url": "https://github.com/rust-lang/rust/raw/ec6104784dc24224f93cf26e68f15585f695eae9/src%2Fci%2Fgithub-actions%2Fci.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fgithub-actions%2Fci.yml?ref=ec6104784dc24224f93cf26e68f15585f695eae9", "patch": "@@ -286,7 +286,7 @@ jobs:\n \n           - name: x86_64-gnu-llvm-13\n             <<: *job-linux-xl\n-            \n+\n           - name: x86_64-gnu-tools\n             env:\n               CI_ONLY_WHEN_SUBMODULES_CHANGED: 1"}]}