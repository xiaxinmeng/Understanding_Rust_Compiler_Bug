{"sha": "288e142737af75007ef973c037cd4ded87d7e510", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI4OGUxNDI3MzdhZjc1MDA3ZWY5NzNjMDM3Y2Q0ZGVkODdkN2U1MTA=", "commit": {"author": {"name": "Christoph Schmidler", "email": "c.schmidler@gmail.com", "date": "2019-12-14T17:51:56Z"}, "committer": {"name": "Christoph Schmidler", "email": "c.schmidler@gmail.com", "date": "2020-03-05T07:09:52Z"}, "message": "Add a new test to reach const_limit setting, although with wrong WARNINGs yet\nrename feature to const_eval_limit", "tree": {"sha": "d7cbdec7f4859e484f55132f197ce9722c0fc7e7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d7cbdec7f4859e484f55132f197ce9722c0fc7e7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/288e142737af75007ef973c037cd4ded87d7e510", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/288e142737af75007ef973c037cd4ded87d7e510", "html_url": "https://github.com/rust-lang/rust/commit/288e142737af75007ef973c037cd4ded87d7e510", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/288e142737af75007ef973c037cd4ded87d7e510/comments", "author": {"login": "TheSamsa", "id": 13667299, "node_id": "MDQ6VXNlcjEzNjY3Mjk5", "avatar_url": "https://avatars.githubusercontent.com/u/13667299?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TheSamsa", "html_url": "https://github.com/TheSamsa", "followers_url": "https://api.github.com/users/TheSamsa/followers", "following_url": "https://api.github.com/users/TheSamsa/following{/other_user}", "gists_url": "https://api.github.com/users/TheSamsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/TheSamsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TheSamsa/subscriptions", "organizations_url": "https://api.github.com/users/TheSamsa/orgs", "repos_url": "https://api.github.com/users/TheSamsa/repos", "events_url": "https://api.github.com/users/TheSamsa/events{/privacy}", "received_events_url": "https://api.github.com/users/TheSamsa/received_events", "type": "User", "site_admin": false}, "committer": {"login": "TheSamsa", "id": 13667299, "node_id": "MDQ6VXNlcjEzNjY3Mjk5", "avatar_url": "https://avatars.githubusercontent.com/u/13667299?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TheSamsa", "html_url": "https://github.com/TheSamsa", "followers_url": "https://api.github.com/users/TheSamsa/followers", "following_url": "https://api.github.com/users/TheSamsa/following{/other_user}", "gists_url": "https://api.github.com/users/TheSamsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/TheSamsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TheSamsa/subscriptions", "organizations_url": "https://api.github.com/users/TheSamsa/orgs", "repos_url": "https://api.github.com/users/TheSamsa/repos", "events_url": "https://api.github.com/users/TheSamsa/events{/privacy}", "received_events_url": "https://api.github.com/users/TheSamsa/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ff38babc31a364e77d1d4d3702c91884b073af17", "url": "https://api.github.com/repos/rust-lang/rust/commits/ff38babc31a364e77d1d4d3702c91884b073af17", "html_url": "https://github.com/rust-lang/rust/commit/ff38babc31a364e77d1d4d3702c91884b073af17"}], "stats": {"total": 89, "additions": 52, "deletions": 37}, "files": [{"sha": "d1442d866dc8ef76c097be5f1d979800324b4fa6", "filename": "src/doc/unstable-book/src/language-features/const-eval-limit.md", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/288e142737af75007ef973c037cd4ded87d7e510/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fconst-eval-limit.md", "raw_url": "https://github.com/rust-lang/rust/raw/288e142737af75007ef973c037cd4ded87d7e510/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fconst-eval-limit.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fconst-eval-limit.md?ref=288e142737af75007ef973c037cd4ded87d7e510", "patch": "@@ -0,0 +1,7 @@\n+# `const_eval_limit`\n+\n+The tracking issue for this feature is: [#67217]\n+\n+[#57563]: https://github.com/rust-lang/rust/issues/67217\n+\n+The `const_eval_limit` allows someone to limit the evaluation steps the CTFE undertakes to evaluate a `const fn`.\n\\ No newline at end of file"}, {"sha": "2fc5963dc6e0bdfb4bacc7b1ae3d1abf56fa5d6e", "filename": "src/doc/unstable-book/src/language-features/const-limit.md", "status": "removed", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/ff38babc31a364e77d1d4d3702c91884b073af17/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fconst-limit.md", "raw_url": "https://github.com/rust-lang/rust/raw/ff38babc31a364e77d1d4d3702c91884b073af17/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fconst-limit.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fconst-limit.md?ref=ff38babc31a364e77d1d4d3702c91884b073af17", "patch": "@@ -1,7 +0,0 @@\n-# `const_limit`\n-\n-The tracking issue for this feature is: [#67217]\n-\n-[#57563]: https://github.com/rust-lang/rust/issues/67217\n-\n-The `const_limit` allows someone to limit the evaluation steps the CTFE undertakes to evaluate a `const fn`.\n\\ No newline at end of file"}, {"sha": "19eb8a3fab88176cf79776583f352d5ffece8ea1", "filename": "src/librustc/middle/limits.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/288e142737af75007ef973c037cd4ded87d7e510/src%2Flibrustc%2Fmiddle%2Flimits.rs", "raw_url": "https://github.com/rust-lang/rust/raw/288e142737af75007ef973c037cd4ded87d7e510/src%2Flibrustc%2Fmiddle%2Flimits.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Flimits.rs?ref=288e142737af75007ef973c037cd4ded87d7e510", "patch": "@@ -1,4 +1,4 @@\n-//! Registering limits, recursion_limit, type_length_limit and const_limit\n+//! Registering limits, recursion_limit, type_length_limit and const_eval_limit\n //!\n //! There are various parts of the compiler that must impose arbitrary limits\n //! on how deeply they recurse to prevent stack overflow. Users can override\n@@ -16,7 +16,7 @@ use rustc_data_structures::sync::Once;\n pub fn update_limits(sess: &Session, krate: &ast::Crate) {\n     update_limit(sess, krate, &sess.recursion_limit, sym::recursion_limit, 128);\n     update_limit(sess, krate, &sess.type_length_limit, sym::type_length_limit, 1048576);\n-    update_limit(sess, krate, &sess.const_limit, sym::const_limit, 1_000_000);\n+    update_limit(sess, krate, &sess.const_eval_limit, sym::const_eval_limit, 1_000_000);\n }\n \n fn update_limit("}, {"sha": "464488964afb7b3c17e1c1b1054155d97472b2b0", "filename": "src/librustc/middle/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/288e142737af75007ef973c037cd4ded87d7e510/src%2Flibrustc%2Fmiddle%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/288e142737af75007ef973c037cd4ded87d7e510/src%2Flibrustc%2Fmiddle%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fmod.rs?ref=288e142737af75007ef973c037cd4ded87d7e510", "patch": "@@ -28,8 +28,8 @@ pub mod lib_features {\n         }\n     }\n }\n+pub mod limits;\n pub mod privacy;\n-pub mod recursion_limit;\n pub mod region;\n pub mod resolve_lifetime;\n pub mod stability;"}, {"sha": "9bfb1a3a66498b9b77d5708a2165c7440d429c40", "filename": "src/librustc_feature/active.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/288e142737af75007ef973c037cd4ded87d7e510/src%2Flibrustc_feature%2Factive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/288e142737af75007ef973c037cd4ded87d7e510/src%2Flibrustc_feature%2Factive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_feature%2Factive.rs?ref=288e142737af75007ef973c037cd4ded87d7e510", "patch": "@@ -533,7 +533,7 @@ declare_features! (\n     (active, const_mut_refs, \"1.41.0\", Some(57349), None),\n \n     // Allows limiting the evaluation steps of const expressions\n-    (active, const_limit, \"1.41.0\", Some(67217), None),\n+    (active, const_eval_limit, \"1.41.0\", Some(67217), None),\n \n     /// Allows the use of `loop` and `while` in constants.\n     (active, const_loop, \"1.41.0\", Some(52000), None),"}, {"sha": "c140adf64d511905952684842cd0e43c864ac3d7", "filename": "src/librustc_feature/builtin_attrs.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/288e142737af75007ef973c037cd4ded87d7e510/src%2Flibrustc_feature%2Fbuiltin_attrs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/288e142737af75007ef973c037cd4ded87d7e510/src%2Flibrustc_feature%2Fbuiltin_attrs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_feature%2Fbuiltin_attrs.rs?ref=288e142737af75007ef973c037cd4ded87d7e510", "patch": "@@ -240,8 +240,8 @@ pub const BUILTIN_ATTRIBUTES: &[BuiltinAttribute] = &[\n     ungated!(recursion_limit, CrateLevel, template!(NameValueStr: \"N\")),\n     ungated!(type_length_limit, CrateLevel, template!(NameValueStr: \"N\")),\n     gated!(\n-        const_limit, CrateLevel, template!(NameValueStr: \"N\"), const_limit,\n-        experimental!(const_limit)\n+        const_eval_limit, CrateLevel, template!(NameValueStr: \"N\"), const_eval_limit,\n+        experimental!(const_eval_limit)\n     ),\n \n     // Entry point:"}, {"sha": "29e9ea1833f8e4f08a284b5626c68cf2990ba2a3", "filename": "src/librustc_interface/passes.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/288e142737af75007ef973c037cd4ded87d7e510/src%2Flibrustc_interface%2Fpasses.rs", "raw_url": "https://github.com/rust-lang/rust/raw/288e142737af75007ef973c037cd4ded87d7e510/src%2Flibrustc_interface%2Fpasses.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_interface%2Fpasses.rs?ref=288e142737af75007ef973c037cd4ded87d7e510", "patch": "@@ -189,7 +189,7 @@ pub fn register_plugins<'a>(\n     }\n \n     sess.time(\"recursion_limit\", || {\n-        middle::recursion_limit::update_limits(sess, &krate);\n+        middle::limits::update_limits(sess, &krate);\n     });\n \n     let mut lint_store = rustc_lint::new_lint_store("}, {"sha": "173b120e1f6d7d632acd5496c86dc0ce7949d8cf", "filename": "src/librustc_session/session.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/288e142737af75007ef973c037cd4ded87d7e510/src%2Flibrustc_session%2Fsession.rs", "raw_url": "https://github.com/rust-lang/rust/raw/288e142737af75007ef973c037cd4ded87d7e510/src%2Flibrustc_session%2Fsession.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_session%2Fsession.rs?ref=288e142737af75007ef973c037cd4ded87d7e510", "patch": "@@ -89,7 +89,7 @@ pub struct Session {\n     pub type_length_limit: Once<usize>,\n \n     /// The maximum blocks a const expression can evaluate.\n-    pub const_limit: Once<usize>,\n+    pub const_eval_limit: Once<usize>,\n \n     /// Map from imported macro spans (which consist of\n     /// the localized span for the macro body) to the\n@@ -1056,7 +1056,7 @@ fn build_session_(\n         features: Once::new(),\n         recursion_limit: Once::new(),\n         type_length_limit: Once::new(),\n-        const_limit: Once::new(),\n+        const_eval_limit: Once::new(),\n         imported_macro_spans: OneThread::new(RefCell::new(FxHashMap::default())),\n         incr_comp_session: OneThread::new(RefCell::new(IncrCompSession::NotInitialized)),\n         cgu_reuse_tracker,"}, {"sha": "c39f9f360c0271771cfc0b4198db1bd80d696176", "filename": "src/librustc_span/symbol.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/288e142737af75007ef973c037cd4ded87d7e510/src%2Flibrustc_span%2Fsymbol.rs", "raw_url": "https://github.com/rust-lang/rust/raw/288e142737af75007ef973c037cd4ded87d7e510/src%2Flibrustc_span%2Fsymbol.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_span%2Fsymbol.rs?ref=288e142737af75007ef973c037cd4ded87d7e510", "patch": "@@ -208,7 +208,7 @@ symbols! {\n         console,\n         const_compare_raw_pointers,\n         const_constructor,\n-        const_limit,\n+        const_eval_limit,\n         const_extern_fn,\n         const_fn,\n         const_fn_union,"}, {"sha": "4ed908312fb6dcc11a58fb72d96b7f5bd9b98780", "filename": "src/test/ui/consts/const_limit/const_eval_limit_not_reached.rs", "status": "renamed", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/288e142737af75007ef973c037cd4ded87d7e510/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_not_reached.rs", "raw_url": "https://github.com/rust-lang/rust/raw/288e142737af75007ef973c037cd4ded87d7e510/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_not_reached.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_not_reached.rs?ref=288e142737af75007ef973c037cd4ded87d7e510", "patch": "@@ -1,6 +1,6 @@\n-// run-pass\n-#![feature(const_limit)]\n-#![const_limit=\"18_446_744_073_709_551_615\"]\n+// check-pass\n+#![feature(const_eval_limit)]\n+#![const_eval_limit=\"1000\"]\n \n const CONSTANT: usize = limit();\n ", "previous_filename": "src/test/ui/consts/const_limit/const_limit_overflow.rs"}, {"sha": "38e70f997f0312e47b2528e0a1e6c34f7af55f6f", "filename": "src/test/ui/consts/const_limit/const_eval_limit_overflow.rs", "status": "renamed", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/288e142737af75007ef973c037cd4ded87d7e510/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_overflow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/288e142737af75007ef973c037cd4ded87d7e510/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_overflow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_overflow.rs?ref=288e142737af75007ef973c037cd4ded87d7e510", "patch": "@@ -1,5 +1,6 @@\n-#![const_limit=\"1\"]\n-//~^ ERROR the `#[const_limit]` attribute is an experimental feature [E0658]\n+// check-pass\n+#![feature(const_eval_limit)]\n+#![const_eval_limit=\"18_446_744_073_709_551_615\"]\n \n const CONSTANT: usize = limit();\n ", "previous_filename": "src/test/ui/consts/const_limit/feature-gate-const_limit.rs"}, {"sha": "86570c240e5f0cad479e6e8f36ff3ea115bf6a03", "filename": "src/test/ui/consts/const_limit/const_eval_limit_reached.rs", "status": "renamed", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/288e142737af75007ef973c037cd4ded87d7e510/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_reached.rs", "raw_url": "https://github.com/rust-lang/rust/raw/288e142737af75007ef973c037cd4ded87d7e510/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_reached.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_reached.rs?ref=288e142737af75007ef973c037cd4ded87d7e510", "patch": "@@ -1,6 +1,6 @@\n-// run-pass\n-#![feature(const_limit)]\n-#![const_limit=\"1000\"]\n+// check-pass\n+#![feature(const_eval_limit)]\n+#![const_eval_limit=\"2\"]\n \n const CONSTANT: usize = limit();\n ", "previous_filename": "src/test/ui/consts/const_limit/const_limit_not_reached.rs"}, {"sha": "61119d7511d49262fc41355eea7720d7155d9eb4", "filename": "src/test/ui/consts/const_limit/feature-gate-const_eval_limit.rs", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/288e142737af75007ef973c037cd4ded87d7e510/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Ffeature-gate-const_eval_limit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/288e142737af75007ef973c037cd4ded87d7e510/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Ffeature-gate-const_eval_limit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Ffeature-gate-const_eval_limit.rs?ref=288e142737af75007ef973c037cd4ded87d7e510", "patch": "@@ -0,0 +1,14 @@\n+#![const_eval_limit=\"42\"]\n+//~^ ERROR the `#[const_eval_limit]` attribute is an experimental feature [E0658]\n+\n+const CONSTANT: usize = limit();\n+\n+fn main() {\n+    assert_eq!(CONSTANT, 1764);\n+}\n+\n+const fn limit() -> usize {\n+    let x = 42;\n+\n+    x * 42\n+}"}, {"sha": "790ba2483a1b689ea030095f49356c1d0f452962", "filename": "src/test/ui/consts/const_limit/feature-gate-const_eval_limit.stderr", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/288e142737af75007ef973c037cd4ded87d7e510/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Ffeature-gate-const_eval_limit.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/288e142737af75007ef973c037cd4ded87d7e510/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Ffeature-gate-const_eval_limit.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Ffeature-gate-const_eval_limit.stderr?ref=288e142737af75007ef973c037cd4ded87d7e510", "patch": "@@ -0,0 +1,12 @@\n+error[E0658]: the `#[const_eval_limit]` attribute is an experimental feature\n+  --> $DIR/feature-gate-const_eval_limit.rs:1:1\n+   |\n+LL | #![const_eval_limit=\"42\"]\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |\n+   = note: for more information, see https://github.com/rust-lang/rust/issues/67217\n+   = help: add `#![feature(const_eval_limit)]` to the crate attributes to enable\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0658`."}, {"sha": "db248994b477925a849451a65d3b69202494ad06", "filename": "src/test/ui/consts/const_limit/feature-gate-const_limit.stderr", "status": "removed", "additions": 0, "deletions": 12, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/ff38babc31a364e77d1d4d3702c91884b073af17/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Ffeature-gate-const_limit.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ff38babc31a364e77d1d4d3702c91884b073af17/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Ffeature-gate-const_limit.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Ffeature-gate-const_limit.stderr?ref=ff38babc31a364e77d1d4d3702c91884b073af17", "patch": "@@ -1,12 +0,0 @@\n-error[E0658]: the `#[const_limit]` attribute is an experimental feature\n-  --> $DIR/feature-gate-const_limit.rs:1:1\n-   |\n-LL | #![const_limit=\"1\"]\n-   | ^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: for more information, see https://github.com/rust-lang/rust/issues/67217\n-   = help: add `#![feature(const_limit)]` to the crate attributes to enable\n-\n-error: aborting due to previous error\n-\n-For more information about this error, try `rustc --explain E0658`."}]}