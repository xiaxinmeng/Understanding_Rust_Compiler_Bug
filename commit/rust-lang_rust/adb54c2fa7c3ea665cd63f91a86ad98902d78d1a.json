{"sha": "adb54c2fa7c3ea665cd63f91a86ad98902d78d1a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFkYjU0YzJmYTdjM2VhNjY1Y2Q2M2Y5MWE4NmFkOTg5MDJkNzhkMWE=", "commit": {"author": {"name": "Josh Stone", "email": "jistone@redhat.com", "date": "2019-02-12T23:28:27Z"}, "committer": {"name": "Josh Stone", "email": "jistone@redhat.com", "date": "2019-02-12T23:28:27Z"}, "message": "[CI] Update dist-x86_64-linux to GCC 5.5\n\nThis also updates dist-i686-linux, since it borrows the same scripts.\n\nWhile we're at it, update llvm+clang+lld to llvm-project 8.0.0-rc2.", "tree": {"sha": "32ae5e6ffe57d2a8ff7898596082ac02dabd62da", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/32ae5e6ffe57d2a8ff7898596082ac02dabd62da"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/adb54c2fa7c3ea665cd63f91a86ad98902d78d1a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/adb54c2fa7c3ea665cd63f91a86ad98902d78d1a", "html_url": "https://github.com/rust-lang/rust/commit/adb54c2fa7c3ea665cd63f91a86ad98902d78d1a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/adb54c2fa7c3ea665cd63f91a86ad98902d78d1a/comments", "author": {"login": "cuviper", "id": 36186, "node_id": "MDQ6VXNlcjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/36186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuviper", "html_url": "https://github.com/cuviper", "followers_url": "https://api.github.com/users/cuviper/followers", "following_url": "https://api.github.com/users/cuviper/following{/other_user}", "gists_url": "https://api.github.com/users/cuviper/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuviper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuviper/subscriptions", "organizations_url": "https://api.github.com/users/cuviper/orgs", "repos_url": "https://api.github.com/users/cuviper/repos", "events_url": "https://api.github.com/users/cuviper/events{/privacy}", "received_events_url": "https://api.github.com/users/cuviper/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cuviper", "id": 36186, "node_id": "MDQ6VXNlcjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/36186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuviper", "html_url": "https://github.com/cuviper", "followers_url": "https://api.github.com/users/cuviper/followers", "following_url": "https://api.github.com/users/cuviper/following{/other_user}", "gists_url": "https://api.github.com/users/cuviper/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuviper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuviper/subscriptions", "organizations_url": "https://api.github.com/users/cuviper/orgs", "repos_url": "https://api.github.com/users/cuviper/repos", "events_url": "https://api.github.com/users/cuviper/events{/privacy}", "received_events_url": "https://api.github.com/users/cuviper/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e0544ca1cff6492ac40c405e04f0c23666536b3b", "url": "https://api.github.com/repos/rust-lang/rust/commits/e0544ca1cff6492ac40c405e04f0c23666536b3b", "html_url": "https://github.com/rust-lang/rust/commit/e0544ca1cff6492ac40c405e04f0c23666536b3b"}], "stats": {"total": 34, "additions": 12, "deletions": 22}, "files": [{"sha": "ac681b71686229cedb957e8f95b1337e2297c06a", "filename": "src/ci/docker/dist-x86_64-linux/build-clang.sh", "status": "modified", "additions": 8, "deletions": 19, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/adb54c2fa7c3ea665cd63f91a86ad98902d78d1a/src%2Fci%2Fdocker%2Fdist-x86_64-linux%2Fbuild-clang.sh", "raw_url": "https://github.com/rust-lang/rust/raw/adb54c2fa7c3ea665cd63f91a86ad98902d78d1a/src%2Fci%2Fdocker%2Fdist-x86_64-linux%2Fbuild-clang.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-x86_64-linux%2Fbuild-clang.sh?ref=adb54c2fa7c3ea665cd63f91a86ad98902d78d1a", "patch": "@@ -4,26 +4,14 @@ set -ex\n \n source shared.sh\n \n-# Currently these commits are all tip-of-tree as of 2018-12-16, used to pick up\n-# a fix for rust-lang/rust#56849\n-LLVM=032b00a5404865765cda7db3039f39d54964d8b0\n-LLD=3e4aa4e8671523321af51449e0569f455ef3ad43\n-CLANG=a6b9739069763243020f4ea6fe586bc135fde1f9\n+LLVM=llvmorg-8.0.0-rc2\n \n-mkdir clang\n-cd clang\n+mkdir llvm-project\n+cd llvm-project\n \n-curl -L https://github.com/llvm-mirror/llvm/archive/$LLVM.tar.gz | \\\n+curl -L https://github.com/llvm/llvm-project/archive/$LLVM.tar.gz | \\\n   tar xzf - --strip-components=1\n \n-mkdir -p tools/clang\n-curl -L https://github.com/llvm-mirror/clang/archive/$CLANG.tar.gz | \\\n-  tar xzf - --strip-components=1 -C tools/clang\n-\n-mkdir -p tools/lld\n-curl -L https://github.com/llvm-mirror/lld/archive/$LLD.tar.gz | \\\n-  tar zxf - --strip-components=1 -C tools/lld\n-\n mkdir clang-build\n cd clang-build\n \n@@ -39,20 +27,21 @@ cd clang-build\n #\n # [1]: https://sourceware.org/ml/crossgcc/2008-11/msg00028.html\n INC=\"/rustroot/include\"\n-INC=\"$INC:/rustroot/lib/gcc/x86_64-unknown-linux-gnu/4.8.5/include-fixed\"\n+INC=\"$INC:/rustroot/lib/gcc/x86_64-unknown-linux-gnu/5.5.0/include-fixed\"\n INC=\"$INC:/usr/include\"\n \n hide_output \\\n-    cmake .. \\\n+    cmake ../llvm \\\n       -DCMAKE_C_COMPILER=/rustroot/bin/gcc \\\n       -DCMAKE_CXX_COMPILER=/rustroot/bin/g++ \\\n       -DCMAKE_BUILD_TYPE=Release \\\n       -DCMAKE_INSTALL_PREFIX=/rustroot \\\n       -DLLVM_TARGETS_TO_BUILD=X86 \\\n+      -DLLVM_ENABLE_PROJECTS=\"clang;lld\" \\\n       -DC_INCLUDE_DIRS=\"$INC\"\n \n hide_output make -j10\n hide_output make install\n \n cd ../..\n-rm -rf clang\n+rm -rf llvm-project"}, {"sha": "7f6e94d326ddf3012e8bf1257b5b99f727c4f1cb", "filename": "src/ci/docker/dist-x86_64-linux/build-gcc.sh", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/adb54c2fa7c3ea665cd63f91a86ad98902d78d1a/src%2Fci%2Fdocker%2Fdist-x86_64-linux%2Fbuild-gcc.sh", "raw_url": "https://github.com/rust-lang/rust/raw/adb54c2fa7c3ea665cd63f91a86ad98902d78d1a/src%2Fci%2Fdocker%2Fdist-x86_64-linux%2Fbuild-gcc.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-x86_64-linux%2Fbuild-gcc.sh?ref=adb54c2fa7c3ea665cd63f91a86ad98902d78d1a", "patch": "@@ -3,9 +3,9 @@ set -ex\n \n source shared.sh\n \n-GCC=4.8.5\n+GCC=5.5.0\n \n-curl https://ftp.gnu.org/gnu/gcc/gcc-$GCC/gcc-$GCC.tar.bz2 | tar xjf -\n+curl https://ftp.gnu.org/gnu/gcc/gcc-$GCC/gcc-$GCC.tar.xz | xzcat | tar xf -\n cd gcc-$GCC\n \n # FIXME(#49246): Remove the `sed` below."}, {"sha": "a678d353d52f5881f69ffde98d10dfac6ceeb465", "filename": "src/ci/docker/dist-x86_64-linux/build-perl.sh", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/adb54c2fa7c3ea665cd63f91a86ad98902d78d1a/src%2Fci%2Fdocker%2Fdist-x86_64-linux%2Fbuild-perl.sh", "raw_url": "https://github.com/rust-lang/rust/raw/adb54c2fa7c3ea665cd63f91a86ad98902d78d1a/src%2Fci%2Fdocker%2Fdist-x86_64-linux%2Fbuild-perl.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-x86_64-linux%2Fbuild-perl.sh?ref=adb54c2fa7c3ea665cd63f91a86ad98902d78d1a", "patch": "@@ -11,7 +11,8 @@ cd perl-5.28.0\n # Gotta do some hackery to tell python about our custom OpenSSL build, but other\n # than that fairly normal.\n CC=gcc \\\n-CFLAGS='-I /rustroot/include' LDFLAGS='-L /rustroot/lib -L /rustroot/lib64' \\\n+CFLAGS='-I /rustroot/include -fgnu89-inline' \\\n+LDFLAGS='-L /rustroot/lib -L /rustroot/lib64' \\\n     hide_output ./configure.gnu\n hide_output make -j10\n hide_output make install"}]}