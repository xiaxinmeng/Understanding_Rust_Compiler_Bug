{"sha": "e74f6114052524bbc2498b43713a8bf1114d14f8", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU3NGY2MTE0MDUyNTI0YmJjMjQ5OGI0MzcxM2E4YmYxMTE0ZDE0Zjg=", "commit": {"author": {"name": "Joe Ranweiler", "email": "joe@lemma.co", "date": "2017-07-19T19:56:05Z"}, "committer": {"name": "Joe Ranweiler", "email": "joe@lemma.co", "date": "2017-07-21T04:51:06Z"}, "message": "Document use of `compiler_builtins` with `no_std` binaries\n\nThe docs for the `compiler_builtins_lib` library feature were removed\nin #42899. But, though the `compiler_builtins` library has been\nmigrated out-of-tree, the feature remains, and is needed to use the\nstand-alone crate. We reintroduce the docs for the feature, and add a\nreference to them when describing how to create a `no_std` executable.", "tree": {"sha": "9773ee69526a76b86ff7fa517a8d680d37bc6a9a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9773ee69526a76b86ff7fa517a8d680d37bc6a9a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e74f6114052524bbc2498b43713a8bf1114d14f8", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niIMEABYIACsWIQQJbh8imDr4nXbXu5rgtkWMsD0WfgUCWXGIRg0cam9lQGxlbW1h\nLmNvAAoJEOC2RYywPRZ+hKoBAM40pwiOnptcAsk2g4qqBNVu05is4JxbRBPeE46v\nRT8vAQD4U3w7qnMuX3xpyJnYhnh6NEZlkS8CtJ9zoNYveA7gDA==\n=GGLb\n-----END PGP SIGNATURE-----", "payload": "tree 9773ee69526a76b86ff7fa517a8d680d37bc6a9a\nparent 9d0946acd0fe0498456ff7a0da208b546d9683b7\nauthor Joe Ranweiler <joe@lemma.co> 1500494165 -0700\ncommitter Joe Ranweiler <joe@lemma.co> 1500612666 -0700\n\nDocument use of `compiler_builtins` with `no_std` binaries\n\nThe docs for the `compiler_builtins_lib` library feature were removed\nin #42899. But, though the `compiler_builtins` library has been\nmigrated out-of-tree, the feature remains, and is needed to use the\nstand-alone crate. We reintroduce the docs for the feature, and add a\nreference to them when describing how to create a `no_std` executable.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e74f6114052524bbc2498b43713a8bf1114d14f8", "html_url": "https://github.com/rust-lang/rust/commit/e74f6114052524bbc2498b43713a8bf1114d14f8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e74f6114052524bbc2498b43713a8bf1114d14f8/comments", "author": {"login": "ranweiler", "id": 515835, "node_id": "MDQ6VXNlcjUxNTgzNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/515835?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ranweiler", "html_url": "https://github.com/ranweiler", "followers_url": "https://api.github.com/users/ranweiler/followers", "following_url": "https://api.github.com/users/ranweiler/following{/other_user}", "gists_url": "https://api.github.com/users/ranweiler/gists{/gist_id}", "starred_url": "https://api.github.com/users/ranweiler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ranweiler/subscriptions", "organizations_url": "https://api.github.com/users/ranweiler/orgs", "repos_url": "https://api.github.com/users/ranweiler/repos", "events_url": "https://api.github.com/users/ranweiler/events{/privacy}", "received_events_url": "https://api.github.com/users/ranweiler/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ranweiler", "id": 515835, "node_id": "MDQ6VXNlcjUxNTgzNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/515835?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ranweiler", "html_url": "https://github.com/ranweiler", "followers_url": "https://api.github.com/users/ranweiler/followers", "following_url": "https://api.github.com/users/ranweiler/following{/other_user}", "gists_url": "https://api.github.com/users/ranweiler/gists{/gist_id}", "starred_url": "https://api.github.com/users/ranweiler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ranweiler/subscriptions", "organizations_url": "https://api.github.com/users/ranweiler/orgs", "repos_url": "https://api.github.com/users/ranweiler/repos", "events_url": "https://api.github.com/users/ranweiler/events{/privacy}", "received_events_url": "https://api.github.com/users/ranweiler/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9d0946acd0fe0498456ff7a0da208b546d9683b7", "url": "https://api.github.com/repos/rust-lang/rust/commits/9d0946acd0fe0498456ff7a0da208b546d9683b7", "html_url": "https://github.com/rust-lang/rust/commit/9d0946acd0fe0498456ff7a0da208b546d9683b7"}], "stats": {"total": 43, "additions": 43, "deletions": 0}, "files": [{"sha": "ecbc860e25c03200be283cc7ab66a40f71a3e1d9", "filename": "src/doc/unstable-book/src/language-features/lang-items.md", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/e74f6114052524bbc2498b43713a8bf1114d14f8/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Flang-items.md", "raw_url": "https://github.com/rust-lang/rust/raw/e74f6114052524bbc2498b43713a8bf1114d14f8/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Flang-items.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Flang-items.md?ref=e74f6114052524bbc2498b43713a8bf1114d14f8", "patch": "@@ -194,6 +194,14 @@ pub extern fn rust_begin_panic(_msg: core::fmt::Arguments,\n }\n ```\n \n+In many cases, you may need to manually link to the `compiler_builtins` crate\n+when building a `no_std` binary. You may observe this via linker error messages\n+such as \"```undefined reference to `__rust_probestack'```\". Using this crate\n+also requires enabling the library feature `compiler_builtins_lib`. You can read\n+more about this [here][compiler-builtins-lib].\n+\n+[compiler-builtins-lib]: library-features/compiler-builtins-lib.html\n+\n ## More about the language items\n \n The compiler currently makes a few assumptions about symbols which are"}, {"sha": "6c71c3f2ce1917af1a8943b0d31735e99d3baa35", "filename": "src/doc/unstable-book/src/library-features/compiler-builtins-lib.md", "status": "added", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/e74f6114052524bbc2498b43713a8bf1114d14f8/src%2Fdoc%2Funstable-book%2Fsrc%2Flibrary-features%2Fcompiler-builtins-lib.md", "raw_url": "https://github.com/rust-lang/rust/raw/e74f6114052524bbc2498b43713a8bf1114d14f8/src%2Fdoc%2Funstable-book%2Fsrc%2Flibrary-features%2Fcompiler-builtins-lib.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flibrary-features%2Fcompiler-builtins-lib.md?ref=e74f6114052524bbc2498b43713a8bf1114d14f8", "patch": "@@ -0,0 +1,35 @@\n+# `compiler_builtins_lib`\n+\n+The tracking issue for this feature is: None.\n+\n+------------------------\n+\n+This feature is required to link to the `compiler_builtins` crate which contains\n+\"compiler intrinsics\". Compiler intrinsics are software implementations of basic\n+operations like multiplication of `u64`s. These intrinsics are only required on\n+platforms where these operations don't directly map to a hardware instruction.\n+\n+You should never need to explicitly link to the `compiler_builtins` crate when\n+building \"std\" programs as `compiler_builtins` is already in the dependency\n+graph of `std`. But you may need it when building `no_std` **binary** crates. If\n+you get a *linker* error like:\n+\n+``` text\n+$PWD/src/main.rs:11: undefined reference to `__aeabi_lmul'\n+$PWD/src/main.rs:11: undefined reference to `__aeabi_uldivmod'\n+```\n+\n+That means that you need to link to this crate.\n+\n+When you link to this crate, make sure it only appears once in your crate\n+dependency graph. Also, it doesn't matter where in the dependency graph you\n+place the `compiler_builtins` crate.\n+\n+<!-- NOTE(ignore) doctests don't support `no_std` binaries -->\n+\n+``` rust,ignore\n+#![feature(compiler_builtins_lib)]\n+#![no_std]\n+\n+extern crate compiler_builtins;\n+```"}]}