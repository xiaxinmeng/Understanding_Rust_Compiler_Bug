{"sha": "5d110c0ee2ec50009eb7c552888a73ce8380d34a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVkMTEwYzBlZTJlYzUwMDA5ZWI3YzU1Mjg4OGE3M2NlODM4MGQzNGE=", "commit": {"author": {"name": "Jeremy Kolb", "email": "kjeremy@gmail.com", "date": "2019-01-22T02:41:39Z"}, "committer": {"name": "Jeremy Kolb", "email": "kjeremy@gmail.com", "date": "2019-01-22T02:41:39Z"}, "message": "Teach CompletionItem about documentation", "tree": {"sha": "9d6d3d1f7ff7818c75e9947b33cadb9c2e73a061", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9d6d3d1f7ff7818c75e9947b33cadb9c2e73a061"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5d110c0ee2ec50009eb7c552888a73ce8380d34a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5d110c0ee2ec50009eb7c552888a73ce8380d34a", "html_url": "https://github.com/rust-lang/rust/commit/5d110c0ee2ec50009eb7c552888a73ce8380d34a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5d110c0ee2ec50009eb7c552888a73ce8380d34a/comments", "author": {"login": "kjeremy", "id": 4325700, "node_id": "MDQ6VXNlcjQzMjU3MDA=", "avatar_url": "https://avatars.githubusercontent.com/u/4325700?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kjeremy", "html_url": "https://github.com/kjeremy", "followers_url": "https://api.github.com/users/kjeremy/followers", "following_url": "https://api.github.com/users/kjeremy/following{/other_user}", "gists_url": "https://api.github.com/users/kjeremy/gists{/gist_id}", "starred_url": "https://api.github.com/users/kjeremy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kjeremy/subscriptions", "organizations_url": "https://api.github.com/users/kjeremy/orgs", "repos_url": "https://api.github.com/users/kjeremy/repos", "events_url": "https://api.github.com/users/kjeremy/events{/privacy}", "received_events_url": "https://api.github.com/users/kjeremy/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kjeremy", "id": 4325700, "node_id": "MDQ6VXNlcjQzMjU3MDA=", "avatar_url": "https://avatars.githubusercontent.com/u/4325700?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kjeremy", "html_url": "https://github.com/kjeremy", "followers_url": "https://api.github.com/users/kjeremy/followers", "following_url": "https://api.github.com/users/kjeremy/following{/other_user}", "gists_url": "https://api.github.com/users/kjeremy/gists{/gist_id}", "starred_url": "https://api.github.com/users/kjeremy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kjeremy/subscriptions", "organizations_url": "https://api.github.com/users/kjeremy/orgs", "repos_url": "https://api.github.com/users/kjeremy/repos", "events_url": "https://api.github.com/users/kjeremy/events{/privacy}", "received_events_url": "https://api.github.com/users/kjeremy/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b59334e67a3c76c91ccd7bc1212a485ab0ac4065", "url": "https://api.github.com/repos/rust-lang/rust/commits/b59334e67a3c76c91ccd7bc1212a485ab0ac4065", "html_url": "https://github.com/rust-lang/rust/commit/b59334e67a3c76c91ccd7bc1212a485ab0ac4065"}], "stats": {"total": 28, "additions": 26, "deletions": 2}, "files": [{"sha": "672c7ed0ed085d94efb1b737ea8d97b6ac6f346f", "filename": "crates/ra_ide_api/src/completion/completion_item.rs", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/5d110c0ee2ec50009eb7c552888a73ce8380d34a/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcompletion_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d110c0ee2ec50009eb7c552888a73ce8380d34a/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcompletion_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcompletion_item.rs?ref=5d110c0ee2ec50009eb7c552888a73ce8380d34a", "patch": "@@ -15,6 +15,7 @@ pub struct CompletionItem {\n     label: String,\n     kind: Option<CompletionItemKind>,\n     detail: Option<String>,\n+    documentation: Option<String>,\n     lookup: Option<String>,\n     insert_text: Option<String>,\n     insert_text_format: InsertTextFormat,\n@@ -77,6 +78,7 @@ impl CompletionItem {\n             insert_text: None,\n             insert_text_format: InsertTextFormat::PlainText,\n             detail: None,\n+            documentation: None,\n             lookup: None,\n             kind: None,\n             text_edit: None,\n@@ -90,6 +92,10 @@ impl CompletionItem {\n     pub fn detail(&self) -> Option<&str> {\n         self.detail.as_ref().map(|it| it.as_str())\n     }\n+    /// A doc-comment\n+    pub fn documentation(&self) -> Option<&str> {\n+        self.documentation.as_ref().map(|it| it.as_str())\n+    }\n     /// What string is used for filtering.\n     pub fn lookup(&self) -> &str {\n         self.lookup\n@@ -127,6 +133,7 @@ pub(crate) struct Builder {\n     insert_text: Option<String>,\n     insert_text_format: InsertTextFormat,\n     detail: Option<String>,\n+    documentation: Option<String>,\n     lookup: Option<String>,\n     kind: Option<CompletionItemKind>,\n     text_edit: Option<TextEdit>,\n@@ -142,6 +149,7 @@ impl Builder {\n             source_range: self.source_range,\n             label: self.label,\n             detail: self.detail,\n+            documentation: self.documentation,\n             insert_text_format: self.insert_text_format,\n             lookup: self.lookup,\n             kind: self.kind,\n@@ -184,6 +192,14 @@ impl Builder {\n         self.detail = detail.map(Into::into);\n         self\n     }\n+    #[allow(unused)]\n+    pub(crate) fn documentation(self, docs: impl Into<String>) -> Builder {\n+        self.set_documentation(Some(docs))\n+    }\n+    pub(crate) fn set_documentation(mut self, docs: Option<impl Into<String>>) -> Builder {\n+        self.documentation = docs.map(Into::into);\n+        self\n+    }\n     pub(super) fn from_resolution(\n         mut self,\n         ctx: &CompletionContext,"}, {"sha": "6818acaf62ab74d2804c12c6d4870c44af91f4a1", "filename": "crates/ra_lsp_server/src/conv.rs", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/5d110c0ee2ec50009eb7c552888a73ce8380d34a/crates%2Fra_lsp_server%2Fsrc%2Fconv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d110c0ee2ec50009eb7c552888a73ce8380d34a/crates%2Fra_lsp_server%2Fsrc%2Fconv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fconv.rs?ref=5d110c0ee2ec50009eb7c552888a73ce8380d34a", "patch": "@@ -1,6 +1,6 @@\n use lsp_types::{\n-    self, CreateFile, DocumentChangeOperation, DocumentChanges, Location, LocationLink,\n-    Position, Range, RenameFile, ResourceOp, SymbolKind, TextDocumentEdit, TextDocumentIdentifier,\n+    self, CreateFile, Documentation, DocumentChangeOperation, DocumentChanges, Location, LocationLink,\n+    MarkupContent, MarkupKind, Position, Range, RenameFile, ResourceOp, SymbolKind, TextDocumentEdit, TextDocumentIdentifier,\n     TextDocumentItem, TextDocumentPositionParams, Url, VersionedTextDocumentIdentifier,\n     WorkspaceEdit,\n };\n@@ -87,13 +87,21 @@ impl ConvWith for CompletionItem {\n             None\n         };\n \n+        let documentation = self.documentation().map(|value| {\n+            Documentation::MarkupContent(MarkupContent {\n+                kind: MarkupKind::Markdown,\n+                value: value.to_string(),\n+            })\n+        });\n+\n         let mut res = lsp_types::CompletionItem {\n             label: self.label().to_string(),\n             detail: self.detail().map(|it| it.to_string()),\n             filter_text: Some(self.lookup().to_string()),\n             kind: self.kind().map(|it| it.conv()),\n             text_edit: Some(text_edit),\n             additional_text_edits,\n+            documentation: documentation,\n             ..Default::default()\n         };\n         res.insert_text_format = Some(match self.insert_text_format() {"}]}