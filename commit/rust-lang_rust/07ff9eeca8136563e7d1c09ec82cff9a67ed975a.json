{"sha": "07ff9eeca8136563e7d1c09ec82cff9a67ed975a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA3ZmY5ZWVjYTgxMzY1NjNlN2QxYzA5ZWM4MmNmZjlhNjdlZDk3NWE=", "commit": {"author": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2020-09-02T17:34:01Z"}, "committer": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2020-09-03T16:36:07Z"}, "message": "Use mark to check that paths that are too long will not be merged", "tree": {"sha": "624b8a2c1caf3bc48833905c30e804267da4ae71", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/624b8a2c1caf3bc48833905c30e804267da4ae71"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/07ff9eeca8136563e7d1c09ec82cff9a67ed975a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/07ff9eeca8136563e7d1c09ec82cff9a67ed975a", "html_url": "https://github.com/rust-lang/rust/commit/07ff9eeca8136563e7d1c09ec82cff9a67ed975a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/07ff9eeca8136563e7d1c09ec82cff9a67ed975a/comments", "author": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "74186d3ae7265b691f00b562f802ed5bdcda5c89", "url": "https://api.github.com/repos/rust-lang/rust/commits/74186d3ae7265b691f00b562f802ed5bdcda5c89", "html_url": "https://github.com/rust-lang/rust/commit/74186d3ae7265b691f00b562f802ed5bdcda5c89"}], "stats": {"total": 13, "additions": 13, "deletions": 0}, "files": [{"sha": "8842068e6508adabdb6f28e2689d5a33dc69f0dd", "filename": "crates/assists/src/utils/insert_use.rs", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/07ff9eeca8136563e7d1c09ec82cff9a67ed975a/crates%2Fassists%2Fsrc%2Futils%2Finsert_use.rs", "raw_url": "https://github.com/rust-lang/rust/raw/07ff9eeca8136563e7d1c09ec82cff9a67ed975a/crates%2Fassists%2Fsrc%2Futils%2Finsert_use.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fassists%2Fsrc%2Futils%2Finsert_use.rs?ref=07ff9eeca8136563e7d1c09ec82cff9a67ed975a", "patch": "@@ -10,6 +10,7 @@ use syntax::{\n };\n \n use crate::assist_context::AssistContext;\n+use test_utils::mark;\n \n /// Determines the containing syntax node in which to insert a `use` statement affecting `position`.\n pub(crate) fn find_insert_use_container(\n@@ -126,6 +127,7 @@ pub fn try_merge_trees(\n     if merge_behaviour == MergeBehaviour::Last\n         && (use_tree_list_is_nested(&lhs_tl) || use_tree_list_is_nested(&rhs_tl))\n     {\n+        mark::hit!(test_last_merge_too_long);\n         return None;\n     }\n \n@@ -586,6 +588,17 @@ use std::io;\",\n         )\n     }\n \n+    #[test]\n+    fn merge_last_too_long() {\n+        mark::check!(test_last_merge_too_long);\n+        check_last(\n+            \"foo::bar\",\n+            r\"use foo::bar::baz::Qux;\",\n+            r\"use foo::bar::baz::Qux;\n+use foo::bar;\",\n+        );\n+    }\n+\n     fn check(\n         path: &str,\n         ra_fixture_before: &str,"}]}