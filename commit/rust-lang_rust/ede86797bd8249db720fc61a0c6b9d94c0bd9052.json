{"sha": "ede86797bd8249db720fc61a0c6b9d94c0bd9052", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVkZTg2Nzk3YmQ4MjQ5ZGI3MjBmYzYxYTBjNmI5ZDk0YzBiZDkwNTI=", "commit": {"author": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2021-09-18T21:37:24Z"}, "committer": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2021-09-20T12:45:39Z"}, "message": "Enable 2021 compatibility lints for all in-tree code\n\nThis just applies the suggested fixes from the compatibility warnings,\nleaving any that are in practice spurious in. This is primarily intended to\nprovide a starting point to identify possible fixes to the migrations (e.g., by\navoiding spurious warnings).\n\nA secondary commit cleans these up where they are false positives (as is true in\nmany of the cases).", "tree": {"sha": "089aad873b21c23ca673c7fbdb03154db8883335", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/089aad873b21c23ca673c7fbdb03154db8883335"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ede86797bd8249db720fc61a0c6b9d94c0bd9052", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ede86797bd8249db720fc61a0c6b9d94c0bd9052", "html_url": "https://github.com/rust-lang/rust/commit/ede86797bd8249db720fc61a0c6b9d94c0bd9052", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ede86797bd8249db720fc61a0c6b9d94c0bd9052/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d37f1091e84cd769eb17af62ee13160087fbf176", "url": "https://api.github.com/repos/rust-lang/rust/commits/d37f1091e84cd769eb17af62ee13160087fbf176", "html_url": "https://github.com/rust-lang/rust/commit/d37f1091e84cd769eb17af62ee13160087fbf176"}], "stats": {"total": 5, "additions": 4, "deletions": 1}, "files": [{"sha": "5c505f6851afe54923c03c92749fa20b79d98952", "filename": "clippy_utils/src/lib.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/ede86797bd8249db720fc61a0c6b9d94c0bd9052/clippy_utils%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ede86797bd8249db720fc61a0c6b9d94c0bd9052/clippy_utils%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_utils%2Fsrc%2Flib.rs?ref=ede86797bd8249db720fc61a0c6b9d94c0bd9052", "patch": "@@ -990,7 +990,10 @@ pub fn can_move_expr_to_closure(cx: &LateContext<'tcx>, expr: &'tcx Expr<'_>) ->\n         captures: HirIdMap::default(),\n     };\n     v.visit_expr(expr);\n-    v.allow_closure.then(|| v.captures)\n+    v.allow_closure.then(|| {\n+        let _ = &v;\n+        v.captures\n+    })\n }\n \n /// Returns the method names and argument list of nested method call expressions that make up"}]}