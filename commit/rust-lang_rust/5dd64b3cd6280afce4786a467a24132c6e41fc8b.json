{"sha": "5dd64b3cd6280afce4786a467a24132c6e41fc8b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVkZDY0YjNjZDYyODBhZmNlNDc4NmE0NjdhMjQxMzJjNmU0MWZjOGI=", "commit": {"author": {"name": "flip1995", "email": "philipp.krones@embecosm.com", "date": "2021-01-02T17:01:42Z"}, "committer": {"name": "flip1995", "email": "philipp.krones@embecosm.com", "date": "2021-01-02T17:12:28Z"}, "message": "Use bootstrap rustc for versioncheck in Clippy", "tree": {"sha": "389468f983f2a952525e18e88622736b4ea32231", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/389468f983f2a952525e18e88622736b4ea32231"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5dd64b3cd6280afce4786a467a24132c6e41fc8b", "comment_count": 0, "verification": {"verified": false, "reason": "bad_email", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEij1UXJ/PQTcb99vTHKDfKvWdaKUFAl/wqX4ACgkQHKDfKvWd\naKWlyhAA1uNynjHjSjJ3G1Lz+Qq48wP1hwoZkHzkCgGUuGylce1HQ3Uspb69QtRh\nt10RVuSIsqV6BKNu0bDJUFBB12scn88z2UNr3ZUgP9GTYaKjDdBnetR/fudgabmE\n0PGgJgsyxOQeh+dtFdi+/xO7eZyQ49z+ukoCRlpKYfioJ8mOu/mAuUpDIPPDBphO\nyRw52Fyy8wMYU3VDca3rFS8W2yAEqdQlEHX0KFTacL5uMMT0YsBgkzT4izArfghw\ncR4G2lqywncRjM9XS4Tx8KpZ7ziCsX9t5FizSxsgyOMc7M95uh1Tzyy1X2XLM6OA\nzGLn6ZENyYVCQk5F16LegNqbTlLWOdidXGrB4iz2zGveS1Fba5tiVfdr3uxyD2fV\neNqgk7r7u+i+Zc/HtevpkDrR10D8jGH6s/CKe1DYH8j0PXNRkKDac8DMoQZAumbF\n1R9gwm9jI2HZpUomYO6zCJExxBzMu7dKjm4mS5fJf4dWNOXUTN+BZpX0IU6cmRqb\nzJyL1M5KsJ6WQz+RrVJ6nS03T9jyo2RoP/AOUZn3JCnIDsN4AXooa6sBGct0vY87\niyUkMwkMLMXeXcN0A52Qm0L9F1RyYhszADUwg+w/QvG99FR+Q7w8m4JfQfG4mI4+\n3MS6WfiNQt+otZD0umZ/freUumrg8H1YGp/SrcKAIAm7o2u+u3E=\n=/Y3o\n-----END PGP SIGNATURE-----", "payload": "tree 389468f983f2a952525e18e88622736b4ea32231\nparent d35d827bc8cac2992a8cd14e3418dadb202f4693\nauthor flip1995 <philipp.krones@embecosm.com> 1609606902 +0100\ncommitter flip1995 <philipp.krones@embecosm.com> 1609607548 +0100\n\nUse bootstrap rustc for versioncheck in Clippy\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5dd64b3cd6280afce4786a467a24132c6e41fc8b", "html_url": "https://github.com/rust-lang/rust/commit/5dd64b3cd6280afce4786a467a24132c6e41fc8b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5dd64b3cd6280afce4786a467a24132c6e41fc8b/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d35d827bc8cac2992a8cd14e3418dadb202f4693", "url": "https://api.github.com/repos/rust-lang/rust/commits/d35d827bc8cac2992a8cd14e3418dadb202f4693", "html_url": "https://github.com/rust-lang/rust/commit/d35d827bc8cac2992a8cd14e3418dadb202f4693"}], "stats": {"total": 7, "additions": 4, "deletions": 3}, "files": [{"sha": "76b6126c76c6a640b98491587f721a592aece397", "filename": "src/tools/clippy/tests/versioncheck.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/5dd64b3cd6280afce4786a467a24132c6e41fc8b/src%2Ftools%2Fclippy%2Ftests%2Fversioncheck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5dd64b3cd6280afce4786a467a24132c6e41fc8b/src%2Ftools%2Fclippy%2Ftests%2Fversioncheck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Ftests%2Fversioncheck.rs?ref=5dd64b3cd6280afce4786a467a24132c6e41fc8b", "patch": "@@ -28,10 +28,11 @@ fn check_that_clippy_has_the_same_major_version_as_rustc() {\n     let clippy_minor = clippy_version.minor;\n     let clippy_patch = clippy_version.patch;\n \n-    // get the rustc version\n-    // this way the rust-toolchain file version is honored\n+    // get the rustc version either from the rustc installed with the toolchain file or from\n+    // `RUSTC_REAL` if Clippy is build in the Rust repo with `./x.py`.\n+    let rustc = std::env::var(\"RUSTC_REAL\").unwrap_or_else(|_| \"rustc\".to_string());\n     let rustc_version = String::from_utf8(\n-        std::process::Command::new(\"rustc\")\n+        std::process::Command::new(&rustc)\n             .arg(\"--version\")\n             .output()\n             .expect(\"failed to run `rustc --version`\")"}]}