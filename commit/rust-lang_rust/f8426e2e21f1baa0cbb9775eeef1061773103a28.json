{"sha": "f8426e2e21f1baa0cbb9775eeef1061773103a28", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY4NDI2ZTJlMjFmMWJhYTBjYmI5Nzc1ZWVlZjEwNjE3NzMxMDNhMjg=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-09-16T02:26:01Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-09-16T02:26:01Z"}, "message": "auto merge of #17288 : alexcrichton/rust/change-snap, r=brson\n\nI'm rotating in some CentOS 5.10 bots so we *actually* build on Linux 2.6.18\r\nlike we advertise doing so. Currently the snapshots are incompatible with CentOS\r\n5.10 due to snapshots requiring glibc 2.6 and CentOS 5.10 having glibc 2.5.\r\n\r\nIt turns out that rustc only requires *one* symbol from glibc 2.6, which is\r\n`futimens`. The rust distribution itself does not use this symbol, but LLVM\r\nconditionally detects it and then uses it. This symbol isn't even called as part\r\nof the compilation process, so we don't even need it!\r\n\r\nThe new snapshot was generated following these instructions [1]:\r\n\r\n1. Download the current x86_64 linux snapshot and unpack it.\r\n2. Open the rustc binary in a hex editor.\r\n3. Change the linkage against glibc 2.6 from strong to *weak*\r\n4. Write changes and re-run src/etc/make-snapshot.py\r\n5. Upload new tarball to S3\r\n\r\nOn CentOS 5.10 a warning is printed each time the snapshot runs that the symbol\r\ncannot be found (anyone with glibc 2.6+ does not have this warning printed). The\r\nkey part is that we can *bootstrap* on CentOS 5.10 at this point. The next\r\nsnapshot will be naturally compatible with glibc 2.3 (even older!) and will not\r\nneed to be manually edited.\r\n\r\n[1]: http://jamesbond3142.no-ip.org/wiki/wiki.cgi/NewAppsOnOldGlibc", "tree": {"sha": "410086af33029cb3bdc78df3efd624de2f2d1b92", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/410086af33029cb3bdc78df3efd624de2f2d1b92"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f8426e2e21f1baa0cbb9775eeef1061773103a28", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f8426e2e21f1baa0cbb9775eeef1061773103a28", "html_url": "https://github.com/rust-lang/rust/commit/f8426e2e21f1baa0cbb9775eeef1061773103a28", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f8426e2e21f1baa0cbb9775eeef1061773103a28/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "63eaba24d6a7f93061d63337ea1f7083ca892787", "url": "https://api.github.com/repos/rust-lang/rust/commits/63eaba24d6a7f93061d63337ea1f7083ca892787", "html_url": "https://github.com/rust-lang/rust/commit/63eaba24d6a7f93061d63337ea1f7083ca892787"}, {"sha": "ba0c100f3b544a03f4b0d9f597ad048fbab1b926", "url": "https://api.github.com/repos/rust-lang/rust/commits/ba0c100f3b544a03f4b0d9f597ad048fbab1b926", "html_url": "https://github.com/rust-lang/rust/commit/ba0c100f3b544a03f4b0d9f597ad048fbab1b926"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "d2a1fd11597cca1852cbaaae0cb8925357371ac3", "filename": "src/snapshots.txt", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f8426e2e21f1baa0cbb9775eeef1061773103a28/src%2Fsnapshots.txt", "raw_url": "https://github.com/rust-lang/rust/raw/f8426e2e21f1baa0cbb9775eeef1061773103a28/src%2Fsnapshots.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fsnapshots.txt?ref=f8426e2e21f1baa0cbb9775eeef1061773103a28", "patch": "@@ -1,7 +1,7 @@\n S 2014-09-10 6faa4f3\n   winnt-x86_64 939eb546469cb936441cff3b6f2478f562f77c46\n   winnt-i386 cfe4f8b519bb9d62588f9310a8f94bc919d5423b\n-  linux-x86_64 72c92895fa9a1dba7880073f2b2b5d0e3e1a2ab6\n+  linux-x86_64 40e2ab1b67d0a2859f7da15e13bfd2748b50f0c7\n   linux-i386 6f5464c9ab191d93bfea0894ca7c6f90c3506f2b\n   freebsd-x86_64 648f35800ba98f1121d418b6d0c13c63b7a8951b\n   macos-i386 545fc45a0071142714639c6be377e6d308c3a4e1"}]}