{"sha": "ffbb43f336276b88c0ede6fc348a170255f12bc1", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZmYmI0M2YzMzYyNzZiODhjMGVkZTZmYzM0OGExNzAyNTVmMTJiYzE=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2021-08-03T12:04:13Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-08-03T12:04:13Z"}, "message": "Merge #9770\n\n9770: Downgrade notify and use `RecommendedWatcher` r=lnicola a=lnicola\n\nCloses #9769\r\n\r\nbors r+\n\nCo-authored-by: Lauren\u021biu Nicola <lnicola@dend.ro>", "tree": {"sha": "1d9803c77c17f0369b49252861e633000dce8c58", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1d9803c77c17f0369b49252861e633000dce8c58"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ffbb43f336276b88c0ede6fc348a170255f12bc1", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhCTC9CRBK7hj4Ov3rIwAAHs4IAIZXG9G1ZJLEcIe5xC8r4USn\nibgU92vRpLHReIIZ/+Vb8u3qenPH6ednz8QiNswgKgWMkyBuXiBFnqdViLWjsF/P\nIrW6iEjW5ehRoFiaFvDGicr8kQ9kmTse+yGfiqPf++AJSoSLi7D3pJR56Vt7K+Su\nrRO9dvDp5RDftkZ7gZQycubqMAiZ582L6QynhdTqL05dvG4tnLimnIeA53H/fUDI\nWT9537xV7JigpJKvrkK298DIwcXz64bIcX9tzCvMitOqtnBrUvOFRUjH63SkR3ZH\nWBtzy9kFRekePV3ipWFNexSVORuW73w0bZQ72uWTH3NpfUShxpvNTAVJB1IEFQo=\n=Uwwi\n-----END PGP SIGNATURE-----\n", "payload": "tree 1d9803c77c17f0369b49252861e633000dce8c58\nparent da894358e16379f3eb3c5d809d64ca208ccfeece\nparent 5b0c86af7d1683983a35f232baa7c98cfa3c382d\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1627992253 +0000\ncommitter GitHub <noreply@github.com> 1627992253 +0000\n\nMerge #9770\n\n9770: Downgrade notify and use `RecommendedWatcher` r=lnicola a=lnicola\n\nCloses #9769\r\n\r\nbors r+\n\nCo-authored-by: Lauren\u021biu Nicola <lnicola@dend.ro>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ffbb43f336276b88c0ede6fc348a170255f12bc1", "html_url": "https://github.com/rust-lang/rust/commit/ffbb43f336276b88c0ede6fc348a170255f12bc1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ffbb43f336276b88c0ede6fc348a170255f12bc1/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "da894358e16379f3eb3c5d809d64ca208ccfeece", "url": "https://api.github.com/repos/rust-lang/rust/commits/da894358e16379f3eb3c5d809d64ca208ccfeece", "html_url": "https://github.com/rust-lang/rust/commit/da894358e16379f3eb3c5d809d64ca208ccfeece"}, {"sha": "5b0c86af7d1683983a35f232baa7c98cfa3c382d", "url": "https://api.github.com/repos/rust-lang/rust/commits/5b0c86af7d1683983a35f232baa7c98cfa3c382d", "html_url": "https://github.com/rust-lang/rust/commit/5b0c86af7d1683983a35f232baa7c98cfa3c382d"}], "stats": {"total": 36, "additions": 8, "deletions": 28}, "files": [{"sha": "4af046ec84b8439e3e5cf1618d8051139f369174", "filename": "Cargo.lock", "status": "modified", "additions": 2, "deletions": 23, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/ffbb43f336276b88c0ede6fc348a170255f12bc1/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/ffbb43f336276b88c0ede6fc348a170255f12bc1/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=ffbb43f336276b88c0ede6fc348a170255f12bc1", "patch": "@@ -763,26 +763,6 @@ version = \"0.1.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"8b23360e99b8717f20aaa4598f5a6541efbe30630039fbc7706cf954a87947ae\"\n \n-[[package]]\n-name = \"kqueue\"\n-version = \"1.0.3\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"512705bfcaeb3d46379771adc69deab978355fc68fdf960f9fb11abc8d678a96\"\n-dependencies = [\n- \"kqueue-sys\",\n- \"libc\",\n-]\n-\n-[[package]]\n-name = \"kqueue-sys\"\n-version = \"1.0.2\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"9803ae382091c10a5c7297ffb9fde284dbc9662b249f86eacef605d97ae92d99\"\n-dependencies = [\n- \"bitflags\",\n- \"libc\",\n-]\n-\n [[package]]\n name = \"la-arena\"\n version = \"0.2.1\"\n@@ -963,16 +943,15 @@ dependencies = [\n \n [[package]]\n name = \"notify\"\n-version = \"5.0.0-pre.11\"\n+version = \"5.0.0-pre.10\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"c614e7ed2b1cf82ec99aeffd8cf6225ef5021b9951148eb161393c394855032c\"\n+checksum = \"51f18203a26893ca1d3526cf58084025d5639f91c44f8b70ab3b724f60e819a0\"\n dependencies = [\n  \"bitflags\",\n  \"crossbeam-channel\",\n  \"filetime\",\n  \"fsevent-sys\",\n  \"inotify\",\n- \"kqueue\",\n  \"libc\",\n  \"mio\",\n  \"walkdir\","}, {"sha": "42200278da51c115add8865167afdc0b2d796a4a", "filename": "crates/vfs-notify/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ffbb43f336276b88c0ede6fc348a170255f12bc1/crates%2Fvfs-notify%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/ffbb43f336276b88c0ede6fc348a170255f12bc1/crates%2Fvfs-notify%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fvfs-notify%2FCargo.toml?ref=ffbb43f336276b88c0ede6fc348a170255f12bc1", "patch": "@@ -14,7 +14,7 @@ rustc-hash = \"1.0\"\n jod-thread = \"0.1.0\"\n walkdir = \"2.3.1\"\n crossbeam-channel = \"0.5.0\"\n-notify = \"=5.0.0-pre.11\"\n+notify = \"=5.0.0-pre.10\"    # check that it builds on NetBSD before upgrading\n \n vfs = { path = \"../vfs\", version = \"0.0.0\" }\n paths = { path = \"../paths\", version = \"0.0.0\" }"}, {"sha": "a28cb7a33041030949424ac6472053841b7ad2b0", "filename": "crates/vfs-notify/src/lib.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/ffbb43f336276b88c0ede6fc348a170255f12bc1/crates%2Fvfs-notify%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ffbb43f336276b88c0ede6fc348a170255f12bc1/crates%2Fvfs-notify%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fvfs-notify%2Fsrc%2Flib.rs?ref=ffbb43f336276b88c0ede6fc348a170255f12bc1", "patch": "@@ -83,9 +83,10 @@ impl NotifyActor {\n                         self.watcher = None;\n                         if !config.watch.is_empty() {\n                             let (watcher_sender, watcher_receiver) = unbounded();\n-                            let watcher = log_notify_error(RecommendedWatcher::new(move |event| {\n-                                watcher_sender.send(event).unwrap()\n-                            }));\n+                            let watcher =\n+                                log_notify_error(RecommendedWatcher::new_immediate(move |event| {\n+                                    watcher_sender.send(event).unwrap()\n+                                }));\n                             self.watcher = watcher.map(|it| (it, watcher_receiver));\n                         }\n \n@@ -214,7 +215,7 @@ impl NotifyActor {\n \n     fn watch(&mut self, path: AbsPathBuf) {\n         if let Some((watcher, _)) = &mut self.watcher {\n-            log_notify_error(watcher.watch(path.as_ref(), RecursiveMode::NonRecursive));\n+            log_notify_error(watcher.watch(&path, RecursiveMode::NonRecursive));\n         }\n     }\n     fn send(&mut self, msg: loader::Message) {"}]}