{"sha": "220ff76e0b1b97c7deef11e320d0cb3b3032c73e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjIyMGZmNzZlMGIxYjk3YzdkZWVmMTFlMzIwZDBjYjNiMzAzMmM3M2U=", "commit": {"author": {"name": "Eduard-Mihai Burtescu", "email": "edy.burt@gmail.com", "date": "2016-11-12T08:38:41Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2016-11-12T08:38:41Z"}, "message": "Rollup merge of #37690 - TimNN:llvm-rel-dbg, r=alexcrichton\n\nrustbuild: support RelWithDebInfo for llvm\n\nr? @alexcrichton", "tree": {"sha": "fdcd9d16204557808d6d36ca1312c91b1dfe61a6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fdcd9d16204557808d6d36ca1312c91b1dfe61a6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/220ff76e0b1b97c7deef11e320d0cb3b3032c73e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/220ff76e0b1b97c7deef11e320d0cb3b3032c73e", "html_url": "https://github.com/rust-lang/rust/commit/220ff76e0b1b97c7deef11e320d0cb3b3032c73e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/220ff76e0b1b97c7deef11e320d0cb3b3032c73e/comments", "author": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6dd4ee6d08064a941e1b628fc54131cfe784b80b", "url": "https://api.github.com/repos/rust-lang/rust/commits/6dd4ee6d08064a941e1b628fc54131cfe784b80b", "html_url": "https://github.com/rust-lang/rust/commit/6dd4ee6d08064a941e1b628fc54131cfe784b80b"}, {"sha": "0254f12224032be95dd97441a866e63c8e15a0e3", "url": "https://api.github.com/repos/rust-lang/rust/commits/0254f12224032be95dd97441a866e63c8e15a0e3", "html_url": "https://github.com/rust-lang/rust/commit/0254f12224032be95dd97441a866e63c8e15a0e3"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "a630aaf8af48439165b8d0030c3c8513f6e36ba1", "filename": "src/bootstrap/config.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/220ff76e0b1b97c7deef11e320d0cb3b3032c73e/src%2Fbootstrap%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/220ff76e0b1b97c7deef11e320d0cb3b3032c73e/src%2Fbootstrap%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.rs?ref=220ff76e0b1b97c7deef11e320d0cb3b3032c73e", "patch": "@@ -50,6 +50,7 @@ pub struct Config {\n     // llvm codegen options\n     pub llvm_assertions: bool,\n     pub llvm_optimize: bool,\n+    pub llvm_release_debuginfo: bool,\n     pub llvm_version_check: bool,\n     pub llvm_static_stdcpp: bool,\n \n@@ -137,6 +138,7 @@ struct Llvm {\n     ninja: Option<bool>,\n     assertions: Option<bool>,\n     optimize: Option<bool>,\n+    release_debuginfo: Option<bool>,\n     version_check: Option<bool>,\n     static_libstdcpp: Option<bool>,\n }\n@@ -243,6 +245,7 @@ impl Config {\n             set(&mut config.ninja, llvm.ninja);\n             set(&mut config.llvm_assertions, llvm.assertions);\n             set(&mut config.llvm_optimize, llvm.optimize);\n+            set(&mut config.llvm_release_debuginfo, llvm.release_debuginfo);\n             set(&mut config.llvm_version_check, llvm.version_check);\n             set(&mut config.llvm_static_stdcpp, llvm.static_libstdcpp);\n         }"}, {"sha": "1388dab303a44ee6755ebe495afc7ccf425ac135", "filename": "src/bootstrap/config.toml.example", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/220ff76e0b1b97c7deef11e320d0cb3b3032c73e/src%2Fbootstrap%2Fconfig.toml.example", "raw_url": "https://github.com/rust-lang/rust/raw/220ff76e0b1b97c7deef11e320d0cb3b3032c73e/src%2Fbootstrap%2Fconfig.toml.example", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.toml.example?ref=220ff76e0b1b97c7deef11e320d0cb3b3032c73e", "patch": "@@ -17,6 +17,9 @@\n # Indicates whether the LLVM build is a Release or Debug build\n #optimize = true\n \n+# Indicates whether an LLVM Release build should include debug info\n+#release-debuginfo = false\n+\n # Indicates whether the LLVM assertions are enabled or not\n #assertions = false\n "}, {"sha": "358cfac74277778497d6476ee0f1e918d320fa17", "filename": "src/bootstrap/native.rs", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/220ff76e0b1b97c7deef11e320d0cb3b3032c73e/src%2Fbootstrap%2Fnative.rs", "raw_url": "https://github.com/rust-lang/rust/raw/220ff76e0b1b97c7deef11e320d0cb3b3032c73e/src%2Fbootstrap%2Fnative.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fnative.rs?ref=220ff76e0b1b97c7deef11e320d0cb3b3032c73e", "patch": "@@ -67,10 +67,17 @@ pub fn llvm(build: &Build, target: &str) {\n     if build.config.ninja {\n         cfg.generator(\"Ninja\");\n     }\n+\n+    let profile = match (build.config.llvm_optimize, build.config.llvm_release_debuginfo) {\n+        (false, _) => \"Debug\",\n+        (true, false) => \"Release\",\n+        (true, true) => \"RelWithDebInfo\",\n+    };\n+\n     cfg.target(target)\n        .host(&build.config.build)\n        .out_dir(&dst)\n-       .profile(if build.config.llvm_optimize {\"Release\"} else {\"Debug\"})\n+       .profile(profile)\n        .define(\"LLVM_ENABLE_ASSERTIONS\", assertions)\n        .define(\"LLVM_TARGETS_TO_BUILD\", \"X86;ARM;AArch64;Mips;PowerPC;SystemZ;JSBackend\")\n        .define(\"LLVM_INCLUDE_EXAMPLES\", \"OFF\")"}]}