{"sha": "54039cafa83e58f271261d730dd9bf6bf78fffba", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU0MDM5Y2FmYTgzZTU4ZjI3MTI2MWQ3MzBkZDliZjZiZjc4ZmZmYmE=", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2019-04-16T18:36:33Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2019-04-16T18:36:33Z"}, "message": "try to really fix tests on macOS", "tree": {"sha": "ec8ef245fb4cb5de29f4829b11a721d8c31c4247", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ec8ef245fb4cb5de29f4829b11a721d8c31c4247"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/54039cafa83e58f271261d730dd9bf6bf78fffba", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/54039cafa83e58f271261d730dd9bf6bf78fffba", "html_url": "https://github.com/rust-lang/rust/commit/54039cafa83e58f271261d730dd9bf6bf78fffba", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/54039cafa83e58f271261d730dd9bf6bf78fffba/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "341798f09da757d18aa6e139748134561b610d00", "url": "https://api.github.com/repos/rust-lang/rust/commits/341798f09da757d18aa6e139748134561b610d00", "html_url": "https://github.com/rust-lang/rust/commit/341798f09da757d18aa6e139748134561b610d00"}], "stats": {"total": 17, "additions": 10, "deletions": 7}, "files": [{"sha": "69a31c42a75c1b8f69b797ae57d2fa77bae14395", "filename": "test-cargo-miri/tests/test.rs", "status": "modified", "additions": 10, "deletions": 7, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/54039cafa83e58f271261d730dd9bf6bf78fffba/test-cargo-miri%2Ftests%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/54039cafa83e58f271261d730dd9bf6bf78fffba/test-cargo-miri%2Ftests%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2Ftests%2Ftest.rs?ref=54039cafa83e58f271261d730dd9bf6bf78fffba", "patch": "@@ -20,15 +20,18 @@ fn fixed_rng() {\n }\n \n #[test]\n-#[cfg(not(target_os=\"macos\"))] // FIXME entropy does not work on macOS\n fn entropy_rng() {\n-    // Use this opportunity to test querying the RNG (needs an external crate, hence tested here and not in the compiletest suite)\n-    let mut rng = SmallRng::from_entropy();\n-    let _val = rng.gen::<i32>();\n+    #[cfg(not(target_os=\"macos\"))] // FIXME entropy does not work on macOS\n+    // (Not disabling the entire test as that would change the output.)\n+    {\n+        // Use this opportunity to test querying the RNG (needs an external crate, hence tested here and not in the compiletest suite)\n+        let mut rng = SmallRng::from_entropy();\n+        let _val = rng.gen::<i32>();\n \n-    // Also try per-thread RNG.\n-    let mut rng = rand::thread_rng();\n-    let _val = rng.gen::<i32>();\n+        // Also try per-thread RNG.\n+        let mut rng = rand::thread_rng();\n+        let _val = rng.gen::<i32>();\n+    }\n }\n \n // A test that won't work on miri"}]}