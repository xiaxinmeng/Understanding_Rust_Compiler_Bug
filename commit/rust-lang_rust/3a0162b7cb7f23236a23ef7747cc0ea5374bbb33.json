{"sha": "3a0162b7cb7f23236a23ef7747cc0ea5374bbb33", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNhMDE2MmI3Y2I3ZjIzMjM2YTIzZWY3NzQ3Y2MwZWE1Mzc0YmJiMzM=", "commit": {"author": {"name": "David Wood", "email": "david@davidtw.co", "date": "2018-03-23T14:04:08Z"}, "committer": {"name": "David Wood", "email": "david@davidtw.co", "date": "2018-03-23T14:04:08Z"}, "message": "Fixed issues with incremental tests.", "tree": {"sha": "820d3c269d30ff08260e9c3602b7b6a11e57d16a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/820d3c269d30ff08260e9c3602b7b6a11e57d16a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3a0162b7cb7f23236a23ef7747cc0ea5374bbb33", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEWwgxPGhT5b/6kagXAXYLT59T8VQFAlq1CVgACgkQAXYLT59T\n8VQxRg//RA8P0G168VyYZBSb1/RWTCyww6GOQfcduqUQJyFhI8ANHlZpPYCiMmAe\nszYyqzCukunnvqf0dDFd6Ys6xQmD7ofIk1ybZ0F9SEJbTOMdpjBaGxLC0qZxid/G\nnHXbTwFzPQrqTXKClNDE/nRkihghTLI7ATfrQBAFLK80NDxk2tJ7RVH+BX3w36LK\nDsUSbOfZbawBchAMCwOAoLFMhqcLLGcli5GRdxa8OborADBfG+0tg1jPdc+6SumE\nCUYw8dgkgfDP7wAm9qiODZcmSjIbxuw6Fy6YZ9zhwToqsE1w1koJSQQF31WqnShi\nO0eb+b0NHZHBkkwnAbJJ9z0CXSZzfM8vvIQrwhD3RYKwmEkRa0E5ilsW1a9S7Xfq\nUnKA3Kjv5R7xZ2mdyYk12CRsn4M9iGUXa09OAyQiYnrCN0ntFt06i+xDKYuYmcdf\nKp8YXSg4jKh1WSYd86bRR08xbLiUYC8M5Lmm7QzD0N7f/dtulzs9mkmkQFm7Ltuk\npow3kB9yA6gAewcvLbVqUNxdnWv2Tdaaj1M6j4uaPDRrN3HzKi0JoDn6UADrp+mN\nnULo746WgWgUKc+zeTD4bI2968rWK5cONNuaXlxeLN5k7+pGBE++3UvWw7mDuoBS\noEjlc4zXzsigrLA3/fwZfi1JxvZ3lDZFsCI4vO0vnnaFpc9qZ+k=\n=OdjK\n-----END PGP SIGNATURE-----", "payload": "tree 820d3c269d30ff08260e9c3602b7b6a11e57d16a\nparent 03481f19eae7cf1f8475c63a0449860e3100d491\nauthor David Wood <david@davidtw.co> 1521813848 +0000\ncommitter David Wood <david@davidtw.co> 1521813848 +0000\n\nFixed issues with incremental tests.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3a0162b7cb7f23236a23ef7747cc0ea5374bbb33", "html_url": "https://github.com/rust-lang/rust/commit/3a0162b7cb7f23236a23ef7747cc0ea5374bbb33", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3a0162b7cb7f23236a23ef7747cc0ea5374bbb33/comments", "author": {"login": "davidtwco", "id": 1295100, "node_id": "MDQ6VXNlcjEyOTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1295100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidtwco", "html_url": "https://github.com/davidtwco", "followers_url": "https://api.github.com/users/davidtwco/followers", "following_url": "https://api.github.com/users/davidtwco/following{/other_user}", "gists_url": "https://api.github.com/users/davidtwco/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidtwco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidtwco/subscriptions", "organizations_url": "https://api.github.com/users/davidtwco/orgs", "repos_url": "https://api.github.com/users/davidtwco/repos", "events_url": "https://api.github.com/users/davidtwco/events{/privacy}", "received_events_url": "https://api.github.com/users/davidtwco/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidtwco", "id": 1295100, "node_id": "MDQ6VXNlcjEyOTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1295100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidtwco", "html_url": "https://github.com/davidtwco", "followers_url": "https://api.github.com/users/davidtwco/followers", "following_url": "https://api.github.com/users/davidtwco/following{/other_user}", "gists_url": "https://api.github.com/users/davidtwco/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidtwco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidtwco/subscriptions", "organizations_url": "https://api.github.com/users/davidtwco/orgs", "repos_url": "https://api.github.com/users/davidtwco/repos", "events_url": "https://api.github.com/users/davidtwco/events{/privacy}", "received_events_url": "https://api.github.com/users/davidtwco/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "03481f19eae7cf1f8475c63a0449860e3100d491", "url": "https://api.github.com/repos/rust-lang/rust/commits/03481f19eae7cf1f8475c63a0449860e3100d491", "html_url": "https://github.com/rust-lang/rust/commit/03481f19eae7cf1f8475c63a0449860e3100d491"}], "stats": {"total": 25, "additions": 24, "deletions": 1}, "files": [{"sha": "4e15f0711a5aa2a6b88bc71cde1635b801215117", "filename": "src/librustc/ty/codec.rs", "status": "modified", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/3a0162b7cb7f23236a23ef7747cc0ea5374bbb33/src%2Flibrustc%2Fty%2Fcodec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3a0162b7cb7f23236a23ef7747cc0ea5374bbb33/src%2Flibrustc%2Fty%2Fcodec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fcodec.rs?ref=3a0162b7cb7f23236a23ef7747cc0ea5374bbb33", "patch": "@@ -17,6 +17,7 @@\n // persisting to incr. comp. caches.\n \n use hir::def_id::{DefId, CrateNum};\n+use infer::canonical::{CanonicalVarInfo, CanonicalVarInfos};\n use rustc_data_structures::fx::FxHashMap;\n use rustc_serialize::{Decodable, Decoder, Encoder, Encodable, opaque};\n use std::hash::Hash;\n@@ -239,6 +240,19 @@ pub fn decode_existential_predicate_slice<'a, 'tcx, D>(decoder: &mut D)\n               .mk_existential_predicates((0..len).map(|_| Decodable::decode(decoder)))?)\n }\n \n+#[inline]\n+pub fn decode_canonical_var_infos<'a, 'tcx, D>(decoder: &mut D)\n+    -> Result<CanonicalVarInfos<'tcx>, D::Error>\n+    where D: TyDecoder<'a, 'tcx>,\n+          'tcx: 'a,\n+{\n+    let len = decoder.read_usize()?;\n+    let interned: Result<Vec<CanonicalVarInfo>, _> = (0..len).map(|_| Decodable::decode(decoder))\n+                                                             .collect();\n+    Ok(decoder.tcx()\n+              .intern_canonical_var_infos(interned?.as_slice()))\n+}\n+\n #[inline]\n pub fn decode_const<'a, 'tcx, D>(decoder: &mut D)\n                                  -> Result<&'tcx ty::Const<'tcx>, D::Error>\n@@ -262,6 +276,7 @@ macro_rules! implement_ty_decoder {\n     ($DecoderName:ident <$($typaram:tt),*>) => {\n         mod __ty_decoder_impl {\n             use super::$DecoderName;\n+            use $crate::infer::canonical::CanonicalVarInfos;\n             use $crate::ty;\n             use $crate::ty::codec::*;\n             use $crate::ty::subst::Substs;\n@@ -364,6 +379,14 @@ macro_rules! implement_ty_decoder {\n                 }\n             }\n \n+            impl<$($typaram),*> SpecializedDecoder<CanonicalVarInfos<'tcx>>\n+                for $DecoderName<$($typaram),*> {\n+                fn specialized_decode(&mut self)\n+                    -> Result<CanonicalVarInfos<'tcx>, Self::Error> {\n+                    decode_canonical_var_infos(self)\n+                }\n+            }\n+\n             impl<$($typaram),*> SpecializedDecoder<&'tcx $crate::ty::Const<'tcx>>\n             for $DecoderName<$($typaram),*> {\n                 fn specialized_decode(&mut self) -> Result<&'tcx ty::Const<'tcx>, Self::Error> {"}, {"sha": "2f49500c3910b0c0d6c42f8614ae6d87b2fb1d0f", "filename": "src/test/incremental/hashes/let_expressions.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3a0162b7cb7f23236a23ef7747cc0ea5374bbb33/src%2Ftest%2Fincremental%2Fhashes%2Flet_expressions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3a0162b7cb7f23236a23ef7747cc0ea5374bbb33/src%2Ftest%2Fincremental%2Fhashes%2Flet_expressions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fincremental%2Fhashes%2Flet_expressions.rs?ref=3a0162b7cb7f23236a23ef7747cc0ea5374bbb33", "patch": "@@ -49,7 +49,7 @@ pub fn add_type() {\n \n #[cfg(not(cfail1))]\n #[rustc_clean(cfg=\"cfail2\",\n-    except=\"HirBody,TypeckTables\")]\n+    except=\"HirBody,TypeckTables,MirValidated\")]\n #[rustc_clean(cfg=\"cfail3\")]\n pub fn add_type() {\n     let _x: u32 = 2u32;"}]}