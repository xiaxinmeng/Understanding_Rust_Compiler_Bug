{"sha": "e1e25a845c2d190afad0c98029cbe368f5bad427", "node_id": "C_kwDOAAsO6NoAKGUxZTI1YTg0NWMyZDE5MGFmYWQwYzk4MDI5Y2JlMzY4ZjViYWQ0Mjc", "commit": {"author": {"name": "Camille GILLOT", "email": "gillot.camille@gmail.com", "date": "2022-08-07T19:03:28Z"}, "committer": {"name": "Camille GILLOT", "email": "gillot.camille@gmail.com", "date": "2022-08-10T16:32:08Z"}, "message": "Generalize trait object generic param check to aliases.", "tree": {"sha": "4c6f24d16b9ea6fb2c237f0551445ae922294f0b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4c6f24d16b9ea6fb2c237f0551445ae922294f0b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e1e25a845c2d190afad0c98029cbe368f5bad427", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e1e25a845c2d190afad0c98029cbe368f5bad427", "html_url": "https://github.com/rust-lang/rust/commit/e1e25a845c2d190afad0c98029cbe368f5bad427", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e1e25a845c2d190afad0c98029cbe368f5bad427/comments", "author": {"login": "cjgillot", "id": 1822483, "node_id": "MDQ6VXNlcjE4MjI0ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1822483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjgillot", "html_url": "https://github.com/cjgillot", "followers_url": "https://api.github.com/users/cjgillot/followers", "following_url": "https://api.github.com/users/cjgillot/following{/other_user}", "gists_url": "https://api.github.com/users/cjgillot/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjgillot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjgillot/subscriptions", "organizations_url": "https://api.github.com/users/cjgillot/orgs", "repos_url": "https://api.github.com/users/cjgillot/repos", "events_url": "https://api.github.com/users/cjgillot/events{/privacy}", "received_events_url": "https://api.github.com/users/cjgillot/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cjgillot", "id": 1822483, "node_id": "MDQ6VXNlcjE4MjI0ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1822483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjgillot", "html_url": "https://github.com/cjgillot", "followers_url": "https://api.github.com/users/cjgillot/followers", "following_url": "https://api.github.com/users/cjgillot/following{/other_user}", "gists_url": "https://api.github.com/users/cjgillot/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjgillot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjgillot/subscriptions", "organizations_url": "https://api.github.com/users/cjgillot/orgs", "repos_url": "https://api.github.com/users/cjgillot/repos", "events_url": "https://api.github.com/users/cjgillot/events{/privacy}", "received_events_url": "https://api.github.com/users/cjgillot/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cc4dd6fc9f1a5c798df269933c7e442b79661a86", "url": "https://api.github.com/repos/rust-lang/rust/commits/cc4dd6fc9f1a5c798df269933c7e442b79661a86", "html_url": "https://github.com/rust-lang/rust/commit/cc4dd6fc9f1a5c798df269933c7e442b79661a86"}], "stats": {"total": 269, "additions": 136, "deletions": 133}, "files": [{"sha": "0951713e5db18bbc0740a91fc3c179032090b148", "filename": "compiler/rustc_typeck/src/astconv/mod.rs", "status": "modified", "additions": 54, "deletions": 80, "changes": 134, "blob_url": "https://github.com/rust-lang/rust/blob/e1e25a845c2d190afad0c98029cbe368f5bad427/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e1e25a845c2d190afad0c98029cbe368f5bad427/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fmod.rs?ref=e1e25a845c2d190afad0c98029cbe368f5bad427", "patch": "@@ -367,36 +367,13 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n             return (tcx.intern_substs(&[]), arg_count);\n         }\n \n-        let is_object = self_ty.map_or(false, |ty| ty == self.tcx().types.trait_object_dummy_self);\n-\n         struct SubstsForAstPathCtxt<'a, 'tcx> {\n             astconv: &'a (dyn AstConv<'tcx> + 'a),\n             def_id: DefId,\n             generic_args: &'a GenericArgs<'a>,\n             span: Span,\n-            missing_type_params: Vec<Symbol>,\n             inferred_params: Vec<Span>,\n             infer_args: bool,\n-            is_object: bool,\n-        }\n-\n-        impl<'tcx, 'a> SubstsForAstPathCtxt<'tcx, 'a> {\n-            fn default_needs_object_self(&mut self, param: &ty::GenericParamDef) -> bool {\n-                let tcx = self.astconv.tcx();\n-                if let GenericParamDefKind::Type { has_default, .. } = param.kind {\n-                    if self.is_object && has_default {\n-                        let default_ty = tcx.at(self.span).type_of(param.def_id);\n-                        let self_param = tcx.types.self_param;\n-                        if default_ty.walk().any(|arg| arg == self_param.into()) {\n-                            // There is no suitable inference default for a type parameter\n-                            // that references self, in an object type.\n-                            return true;\n-                        }\n-                    }\n-                }\n-\n-                false\n-            }\n         }\n \n         impl<'a, 'tcx> CreateSubstsForGenericArgsCtxt<'a, 'tcx> for SubstsForAstPathCtxt<'a, 'tcx> {\n@@ -499,41 +476,23 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n                     GenericParamDefKind::Type { has_default, .. } => {\n                         if !infer_args && has_default {\n                             // No type parameter provided, but a default exists.\n-\n-                            // If we are converting an object type, then the\n-                            // `Self` parameter is unknown. However, some of the\n-                            // other type parameters may reference `Self` in their\n-                            // defaults. This will lead to an ICE if we are not\n-                            // careful!\n-                            if self.default_needs_object_self(param) {\n-                                self.missing_type_params.push(param.name);\n-                                tcx.ty_error().into()\n-                            } else {\n-                                // This is a default type parameter.\n-                                let substs = substs.unwrap();\n-                                if substs.iter().any(|arg| match arg.unpack() {\n-                                    GenericArgKind::Type(ty) => ty.references_error(),\n-                                    _ => false,\n-                                }) {\n-                                    // Avoid ICE #86756 when type error recovery goes awry.\n-                                    return tcx.ty_error().into();\n-                                }\n-                                self.astconv\n-                                    .normalize_ty(\n-                                        self.span,\n-                                        EarlyBinder(tcx.at(self.span).type_of(param.def_id))\n-                                            .subst(tcx, substs),\n-                                    )\n-                                    .into()\n+                            let substs = substs.unwrap();\n+                            if substs.iter().any(|arg| match arg.unpack() {\n+                                GenericArgKind::Type(ty) => ty.references_error(),\n+                                _ => false,\n+                            }) {\n+                                // Avoid ICE #86756 when type error recovery goes awry.\n+                                return tcx.ty_error().into();\n                             }\n+                            self.astconv\n+                                .normalize_ty(\n+                                    self.span,\n+                                    EarlyBinder(tcx.at(self.span).type_of(param.def_id))\n+                                        .subst(tcx, substs),\n+                                )\n+                                .into()\n                         } else if infer_args {\n-                            // No type parameters were provided, we can infer all.\n-                            let param = if !self.default_needs_object_self(param) {\n-                                Some(param)\n-                            } else {\n-                                None\n-                            };\n-                            self.astconv.ty_infer(param, self.span).into()\n+                            self.astconv.ty_infer(Some(param), self.span).into()\n                         } else {\n                             // We've already errored above about the mismatch.\n                             tcx.ty_error().into()\n@@ -563,10 +522,8 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n             def_id,\n             span,\n             generic_args,\n-            missing_type_params: vec![],\n             inferred_params: vec![],\n             infer_args,\n-            is_object,\n         };\n         let substs = Self::create_substs_for_generic_args(\n             tcx,\n@@ -578,13 +535,6 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n             &mut substs_ctx,\n         );\n \n-        self.complain_about_missing_type_params(\n-            substs_ctx.missing_type_params,\n-            def_id,\n-            span,\n-            generic_args.args.is_empty(),\n-        );\n-\n         debug!(\n             \"create_substs_for_ast_path(generic_params={:?}, self_ty={:?}) -> {:?}\",\n             generics, self_ty, substs\n@@ -1489,23 +1439,47 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n         // Erase the `dummy_self` (`trait_object_dummy_self`) used above.\n         let existential_trait_refs = regular_traits.iter().map(|i| {\n             i.trait_ref().map_bound(|trait_ref: ty::TraitRef<'tcx>| {\n-                if trait_ref.self_ty() != dummy_self {\n-                    // FIXME: There appears to be a missing filter on top of `expand_trait_aliases`,\n-                    // which picks up non-supertraits where clauses - but also, the object safety\n-                    // completely ignores trait aliases, which could be object safety hazards. We\n-                    // `delay_span_bug` here to avoid an ICE in stable even when the feature is\n-                    // disabled. (#66420)\n-                    tcx.sess.delay_span_bug(\n-                        DUMMY_SP,\n-                        &format!(\n-                            \"trait_ref_to_existential called on {:?} with non-dummy Self\",\n-                            trait_ref,\n-                        ),\n-                    );\n-                }\n-                ty::ExistentialTraitRef::erase_self_ty(tcx, trait_ref)\n+                assert_eq!(trait_ref.self_ty(), dummy_self);\n+\n+                // Verify that `dummy_self` did not leak inside default type parameters.  This\n+                // could not be done at path creation, since we need to see through trait aliases.\n+                let mut missing_type_params = vec![];\n+                let generics = tcx.generics_of(trait_ref.def_id);\n+                let substs: Vec<_> = trait_ref\n+                    .substs\n+                    .iter()\n+                    .enumerate()\n+                    .skip(1) // Remove `Self` for `ExistentialPredicate`.\n+                    .map(|(index, arg)| {\n+                        if let ty::GenericArgKind::Type(ty) = arg.unpack()\n+                            && ty == dummy_self\n+                        {\n+                            let param = &generics.params[index];\n+                            missing_type_params.push(param.name);\n+                            tcx.ty_error().into()\n+                        } else {\n+                            arg\n+                        }\n+                    })\n+                    .collect();\n+                let substs = tcx.intern_substs(&substs[..]);\n+\n+                let span = i.bottom().1;\n+                let empty_generic_args = trait_bounds.iter().any(|hir_bound| {\n+                    hir_bound.trait_ref.path.res == Res::Def(DefKind::Trait, trait_ref.def_id)\n+                        && hir_bound.span.contains(span)\n+                });\n+                self.complain_about_missing_type_params(\n+                    missing_type_params,\n+                    trait_ref.def_id,\n+                    span,\n+                    empty_generic_args,\n+                );\n+\n+                ty::ExistentialTraitRef { def_id: trait_ref.def_id, substs }\n             })\n         });\n+\n         let existential_projections = bounds.projection_bounds.iter().map(|(bound, _)| {\n             bound.map_bound(|b| {\n                 if b.projection_ty.self_ty() != dummy_self {"}, {"sha": "2b88cf0b4411eaccca994ec545e4584f6f9c00cf", "filename": "src/test/ui/associated-types/issue-22560.stderr", "status": "modified", "additions": 23, "deletions": 23, "changes": 46, "blob_url": "https://github.com/rust-lang/rust/blob/e1e25a845c2d190afad0c98029cbe368f5bad427/src%2Ftest%2Fui%2Fassociated-types%2Fissue-22560.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e1e25a845c2d190afad0c98029cbe368f5bad427/src%2Ftest%2Fui%2Fassociated-types%2Fissue-22560.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fassociated-types%2Fissue-22560.stderr?ref=e1e25a845c2d190afad0c98029cbe368f5bad427", "patch": "@@ -1,25 +1,3 @@\n-error[E0393]: the type parameter `Rhs` must be explicitly specified\n-  --> $DIR/issue-22560.rs:9:23\n-   |\n-LL | trait Sub<Rhs=Self> {\n-   | ------------------- type parameter `Rhs` must be specified for this\n-...\n-LL | type Test = dyn Add + Sub;\n-   |                       ^^^ help: set the type parameter to the desired type: `Sub<Rhs>`\n-   |\n-   = note: because of the default `Self` reference, type parameters must be specified on object types\n-\n-error[E0393]: the type parameter `Rhs` must be explicitly specified\n-  --> $DIR/issue-22560.rs:9:17\n-   |\n-LL | trait Add<Rhs=Self> {\n-   | ------------------- type parameter `Rhs` must be specified for this\n-...\n-LL | type Test = dyn Add + Sub;\n-   |                 ^^^ help: set the type parameter to the desired type: `Add<Rhs>`\n-   |\n-   = note: because of the default `Self` reference, type parameters must be specified on object types\n-\n error[E0225]: only auto traits can be used as additional traits in a trait object\n   --> $DIR/issue-22560.rs:9:23\n    |\n@@ -28,7 +6,7 @@ LL | type Test = dyn Add + Sub;\n    |                 |\n    |                 first non-auto trait\n    |\n-   = help: consider creating a new trait with all of these as supertraits and using that trait here instead: `trait NewTrait: Add<[type error]> + Sub<[type error]> {}`\n+   = help: consider creating a new trait with all of these as supertraits and using that trait here instead: `trait NewTrait: Add + Sub {}`\n    = note: auto-traits like `Send` and `Sync` are traits that have special properties; for more information on them, visit <https://doc.rust-lang.org/reference/special-types-and-traits.html#auto-traits>\n \n error[E0191]: the value of the associated types `Output` (from trait `Add`), `Output` (from trait `Sub`) must be specified\n@@ -50,6 +28,28 @@ help: specify the associated types\n LL | type Test = dyn Add<Output = Type> + Sub<Output = Type>;\n    |                 ~~~~~~~~~~~~~~~~~~   ~~~~~~~~~~~~~~~~~~\n \n+error[E0393]: the type parameter `Rhs` must be explicitly specified\n+  --> $DIR/issue-22560.rs:9:17\n+   |\n+LL | trait Add<Rhs=Self> {\n+   | ------------------- type parameter `Rhs` must be specified for this\n+...\n+LL | type Test = dyn Add + Sub;\n+   |                 ^^^ help: set the type parameter to the desired type: `Add<Rhs>`\n+   |\n+   = note: because of the default `Self` reference, type parameters must be specified on object types\n+\n+error[E0393]: the type parameter `Rhs` must be explicitly specified\n+  --> $DIR/issue-22560.rs:9:23\n+   |\n+LL | trait Sub<Rhs=Self> {\n+   | ------------------- type parameter `Rhs` must be specified for this\n+...\n+LL | type Test = dyn Add + Sub;\n+   |                       ^^^ help: set the type parameter to the desired type: `Sub<Rhs>`\n+   |\n+   = note: because of the default `Self` reference, type parameters must be specified on object types\n+\n error: aborting due to 4 previous errors\n \n Some errors have detailed explanations: E0191, E0225, E0393."}, {"sha": "6175b7df1107ad78029a5ffc4f4231a2d105a05b", "filename": "src/test/ui/cycle-trait/cycle-trait-default-type-trait.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/e1e25a845c2d190afad0c98029cbe368f5bad427/src%2Ftest%2Fui%2Fcycle-trait%2Fcycle-trait-default-type-trait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e1e25a845c2d190afad0c98029cbe368f5bad427/src%2Ftest%2Fui%2Fcycle-trait%2Fcycle-trait-default-type-trait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcycle-trait%2Fcycle-trait-default-type-trait.rs?ref=e1e25a845c2d190afad0c98029cbe368f5bad427", "patch": "@@ -3,7 +3,6 @@\n \n trait Foo<X = Box<dyn Foo>> {\n     //~^ ERROR cycle detected\n-    //~| ERROR cycle detected\n }\n \n fn main() { }"}, {"sha": "9d715f49471463f94d333cc8c2bab63389117b37", "filename": "src/test/ui/cycle-trait/cycle-trait-default-type-trait.stderr", "status": "modified", "additions": 1, "deletions": 20, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/e1e25a845c2d190afad0c98029cbe368f5bad427/src%2Ftest%2Fui%2Fcycle-trait%2Fcycle-trait-default-type-trait.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e1e25a845c2d190afad0c98029cbe368f5bad427/src%2Ftest%2Fui%2Fcycle-trait%2Fcycle-trait-default-type-trait.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcycle-trait%2Fcycle-trait-default-type-trait.stderr?ref=e1e25a845c2d190afad0c98029cbe368f5bad427", "patch": "@@ -10,30 +10,11 @@ note: cycle used when collecting item types in top-level module\n    |\n LL | / trait Foo<X = Box<dyn Foo>> {\n LL | |\n-LL | |\n-LL | | }\n-LL | |\n-LL | | fn main() { }\n-   | |_____________^\n-\n-error[E0391]: cycle detected when computing type of `Foo::X`\n-  --> $DIR/cycle-trait-default-type-trait.rs:4:23\n-   |\n-LL | trait Foo<X = Box<dyn Foo>> {\n-   |                       ^^^\n-   |\n-   = note: ...which immediately requires computing type of `Foo::X` again\n-note: cycle used when collecting item types in top-level module\n-  --> $DIR/cycle-trait-default-type-trait.rs:4:1\n-   |\n-LL | / trait Foo<X = Box<dyn Foo>> {\n-LL | |\n-LL | |\n LL | | }\n LL | |\n LL | | fn main() { }\n    | |_____________^\n \n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n \n For more information about this error, try `rustc --explain E0391`."}, {"sha": "731615a6bd8d4d37e5540d9fee4683d391306e98", "filename": "src/test/ui/issues/issue-21950.stderr", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/e1e25a845c2d190afad0c98029cbe368f5bad427/src%2Ftest%2Fui%2Fissues%2Fissue-21950.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e1e25a845c2d190afad0c98029cbe368f5bad427/src%2Ftest%2Fui%2Fissues%2Fissue-21950.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-21950.stderr?ref=e1e25a845c2d190afad0c98029cbe368f5bad427", "patch": "@@ -1,3 +1,12 @@\n+error[E0191]: the value of the associated type `Output` (from trait `Add`) must be specified\n+  --> $DIR/issue-21950.rs:10:25\n+   |\n+LL |     type Output;\n+   |     ----------- `Output` defined here\n+...\n+LL |     let x = &10 as &dyn Add;\n+   |                         ^^^ help: specify the associated type: `Add<Output = Type>`\n+\n error[E0393]: the type parameter `Rhs` must be explicitly specified\n   --> $DIR/issue-21950.rs:10:25\n    |\n@@ -9,15 +18,6 @@ LL |     let x = &10 as &dyn Add;\n    |\n    = note: because of the default `Self` reference, type parameters must be specified on object types\n \n-error[E0191]: the value of the associated type `Output` (from trait `Add`) must be specified\n-  --> $DIR/issue-21950.rs:10:25\n-   |\n-LL |     type Output;\n-   |     ----------- `Output` defined here\n-...\n-LL |     let x = &10 as &dyn Add;\n-   |                         ^^^ help: specify the associated type: `Add<Output = Type>`\n-\n error: aborting due to 2 previous errors\n \n Some errors have detailed explanations: E0191, E0393."}, {"sha": "d44e1c2a9753048d794d117cbeff8ca3b8b05b33", "filename": "src/test/ui/traits/alias/generic-default-in-dyn.rs", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/e1e25a845c2d190afad0c98029cbe368f5bad427/src%2Ftest%2Fui%2Ftraits%2Falias%2Fgeneric-default-in-dyn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e1e25a845c2d190afad0c98029cbe368f5bad427/src%2Ftest%2Fui%2Ftraits%2Falias%2Fgeneric-default-in-dyn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Falias%2Fgeneric-default-in-dyn.rs?ref=e1e25a845c2d190afad0c98029cbe368f5bad427", "patch": "@@ -0,0 +1,10 @@\n+trait SendEqAlias<T> = PartialEq;\n+//~^ ERROR trait aliases are experimental\n+\n+struct Foo<T>(dyn SendEqAlias<T>);\n+//~^ ERROR the type parameter `Rhs` must be explicitly specified [E0393]\n+\n+struct Bar<T>(dyn SendEqAlias<T>, T);\n+//~^ ERROR the type parameter `Rhs` must be explicitly specified [E0393]\n+\n+fn main() {}"}, {"sha": "76a068e864a3c6380ac1822aa379441f38ca6baf", "filename": "src/test/ui/traits/alias/generic-default-in-dyn.stderr", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/e1e25a845c2d190afad0c98029cbe368f5bad427/src%2Ftest%2Fui%2Ftraits%2Falias%2Fgeneric-default-in-dyn.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e1e25a845c2d190afad0c98029cbe368f5bad427/src%2Ftest%2Fui%2Ftraits%2Falias%2Fgeneric-default-in-dyn.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Falias%2Fgeneric-default-in-dyn.stderr?ref=e1e25a845c2d190afad0c98029cbe368f5bad427", "patch": "@@ -0,0 +1,39 @@\n+error[E0658]: trait aliases are experimental\n+  --> $DIR/generic-default-in-dyn.rs:1:1\n+   |\n+LL | trait SendEqAlias<T> = PartialEq;\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   |\n+   = note: see issue #41517 <https://github.com/rust-lang/rust/issues/41517> for more information\n+   = help: add `#![feature(trait_alias)]` to the crate attributes to enable\n+\n+error[E0393]: the type parameter `Rhs` must be explicitly specified\n+  --> $DIR/generic-default-in-dyn.rs:4:19\n+   |\n+LL | struct Foo<T>(dyn SendEqAlias<T>);\n+   |                   ^^^^^^^^^^^^^^ missing reference to `Rhs`\n+   |\n+  ::: $SRC_DIR/core/src/cmp.rs:LL:COL\n+   |\n+LL | pub trait PartialEq<Rhs: ?Sized = Self> {\n+   | --------------------------------------- type parameter `Rhs` must be specified for this\n+   |\n+   = note: because of the default `Self` reference, type parameters must be specified on object types\n+\n+error[E0393]: the type parameter `Rhs` must be explicitly specified\n+  --> $DIR/generic-default-in-dyn.rs:7:19\n+   |\n+LL | struct Bar<T>(dyn SendEqAlias<T>, T);\n+   |                   ^^^^^^^^^^^^^^ missing reference to `Rhs`\n+   |\n+  ::: $SRC_DIR/core/src/cmp.rs:LL:COL\n+   |\n+LL | pub trait PartialEq<Rhs: ?Sized = Self> {\n+   | --------------------------------------- type parameter `Rhs` must be specified for this\n+   |\n+   = note: because of the default `Self` reference, type parameters must be specified on object types\n+\n+error: aborting due to 3 previous errors\n+\n+Some errors have detailed explanations: E0393, E0658.\n+For more information about an error, try `rustc --explain E0393`."}, {"sha": "158b5a9855752b126a189f45b788f730da0bc09c", "filename": "src/test/ui/traits/unspecified-self-in-trait-ref.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/e1e25a845c2d190afad0c98029cbe368f5bad427/src%2Ftest%2Fui%2Ftraits%2Funspecified-self-in-trait-ref.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e1e25a845c2d190afad0c98029cbe368f5bad427/src%2Ftest%2Fui%2Ftraits%2Funspecified-self-in-trait-ref.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Funspecified-self-in-trait-ref.rs?ref=e1e25a845c2d190afad0c98029cbe368f5bad427", "previous_filename": "src/test/ui/unspecified-self-in-trait-ref.rs"}, {"sha": "7869176bb3ad2a3ffc6fa2cd74caec27d72d66d5", "filename": "src/test/ui/traits/unspecified-self-in-trait-ref.stderr", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/e1e25a845c2d190afad0c98029cbe368f5bad427/src%2Ftest%2Fui%2Ftraits%2Funspecified-self-in-trait-ref.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e1e25a845c2d190afad0c98029cbe368f5bad427/src%2Ftest%2Fui%2Ftraits%2Funspecified-self-in-trait-ref.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Funspecified-self-in-trait-ref.stderr?ref=e1e25a845c2d190afad0c98029cbe368f5bad427", "previous_filename": "src/test/ui/unspecified-self-in-trait-ref.stderr"}]}