{"sha": "4c971620e4bfa32df3e9da02772a2a1c68be004f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRjOTcxNjIwZTRiZmEzMmRmM2U5ZGEwMjc3MmEyYTFjNjhiZTAwNGY=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2018-12-23T22:08:59Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-12-23T22:08:59Z"}, "message": "Rollup merge of #56188 - zackmdavis:if_i_may_suggest, r=davidtwco\n\nenum type instead of variant suggestion unification\n\nFixes #56028.\n\nWeirdly, we were deciding between a help note and a structured suggestion based on whether the import candidate span was a dummy\u2014but we weren't using that span in any case! The dummy-ness of the span (which appears to be a matter of this-crate vs. other-crate definition) isn't the right criterion by which we should decide whether it's germane to mention that \"there is an enum variant\"; instead, let's use the someness of `def` (which is used as the `has_unexpected_resolution` argument to `error_code`).\n\nSince `import_candidate_to_paths` has no other callers, we are free to stop returning the span and rename the function. By using `span_suggestions_`, we leverage the max-suggestions output limit already built in to the emitter, thus resolving #56028.\n\nIn the matter of message wording, \"you can\" is redundant (and perhaps too informal); prefer the imperative.\n\nIn a second commit, we do some unprincipled special-casing to correct and beautify suggestions for `Option` and `Result` (where the existing code was being confused by their being reexported in the prelude).\n\nr? @davidtwco", "tree": {"sha": "91268ea5760753f959fb7c3c329c6b5f2f7d0993", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/91268ea5760753f959fb7c3c329c6b5f2f7d0993"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4c971620e4bfa32df3e9da02772a2a1c68be004f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJcIAd7CRBK7hj4Ov3rIwAAdHIIAKFf7p0ETlrFl6loMRQ/LccJ\nFZIXLJ2vm1AJUSwFDzRAD0BwkLlHyMXYRjkOV4HTCIpRA0pyBUvfODqYgYH0ju+J\nUP7iYGqnA8p0ib08+xs1eNyqMNWzjE1b5om2GHfjggQgeLxx9lQjhuZ8Qim2WJPi\n06r+06qh9cRZJOQOz1wXkCkUADqc27Tp773/e60bpCjcvpePghe0tSut2yhS2DER\nwLcEmX9dBUQuZtj+6TstCC5v8ZWPUSTl/7aUKG2CWoeI53bWZSKy+rdfxrvWEhKo\nvATP9zb8iUxzYCuUYv4ik1sIuu4O6iV/7JKV+dlP2SyFysC1u0ReFLWthHAG2uE=\n=rx9j\n-----END PGP SIGNATURE-----\n", "payload": "tree 91268ea5760753f959fb7c3c329c6b5f2f7d0993\nparent ddab10a692aab2e2984b5c826ed9d78a57e94851\nparent 64ad3e2c423f701b856a6780380a0dbb03f90c22\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1545602939 +0100\ncommitter GitHub <noreply@github.com> 1545602939 +0100\n\nRollup merge of #56188 - zackmdavis:if_i_may_suggest, r=davidtwco\n\nenum type instead of variant suggestion unification\n\nFixes #56028.\n\nWeirdly, we were deciding between a help note and a structured suggestion based on whether the import candidate span was a dummy\u2014but we weren't using that span in any case! The dummy-ness of the span (which appears to be a matter of this-crate vs. other-crate definition) isn't the right criterion by which we should decide whether it's germane to mention that \"there is an enum variant\"; instead, let's use the someness of `def` (which is used as the `has_unexpected_resolution` argument to `error_code`).\n\nSince `import_candidate_to_paths` has no other callers, we are free to stop returning the span and rename the function. By using `span_suggestions_`, we leverage the max-suggestions output limit already built in to the emitter, thus resolving #56028.\n\nIn the matter of message wording, \"you can\" is redundant (and perhaps too informal); prefer the imperative.\n\nIn a second commit, we do some unprincipled special-casing to correct and beautify suggestions for `Option` and `Result` (where the existing code was being confused by their being reexported in the prelude).\n\nr? @davidtwco\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4c971620e4bfa32df3e9da02772a2a1c68be004f", "html_url": "https://github.com/rust-lang/rust/commit/4c971620e4bfa32df3e9da02772a2a1c68be004f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4c971620e4bfa32df3e9da02772a2a1c68be004f/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ddab10a692aab2e2984b5c826ed9d78a57e94851", "url": "https://api.github.com/repos/rust-lang/rust/commits/ddab10a692aab2e2984b5c826ed9d78a57e94851", "html_url": "https://github.com/rust-lang/rust/commit/ddab10a692aab2e2984b5c826ed9d78a57e94851"}, {"sha": "64ad3e2c423f701b856a6780380a0dbb03f90c22", "url": "https://api.github.com/repos/rust-lang/rust/commits/64ad3e2c423f701b856a6780380a0dbb03f90c22", "html_url": "https://github.com/rust-lang/rust/commit/64ad3e2c423f701b856a6780380a0dbb03f90c22"}], "stats": {"total": 191, "additions": 133, "deletions": 58}, "files": [{"sha": "e543677ef06218ea378d6a6b6d71b384f80b12eb", "filename": "src/librustc_resolve/lib.rs", "status": "modified", "additions": 38, "deletions": 18, "changes": 56, "blob_url": "https://github.com/rust-lang/rust/blob/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Flibrustc_resolve%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Flibrustc_resolve%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Flib.rs?ref=4c971620e4bfa32df3e9da02772a2a1c68be004f", "patch": "@@ -3213,23 +3213,43 @@ impl<'a> Resolver<'a> {\n                 let enum_candidates =\n                     this.lookup_import_candidates(ident, ns, is_enum_variant);\n                 let mut enum_candidates = enum_candidates.iter()\n-                    .map(|suggestion| import_candidate_to_paths(&suggestion)).collect::<Vec<_>>();\n+                    .map(|suggestion| {\n+                        import_candidate_to_enum_paths(&suggestion)\n+                    }).collect::<Vec<_>>();\n                 enum_candidates.sort();\n-                for (sp, variant_path, enum_path) in enum_candidates {\n-                    if sp.is_dummy() {\n-                        let msg = format!(\"there is an enum variant `{}`, \\\n-                                           try using `{}`?\",\n-                                          variant_path,\n-                                          enum_path);\n-                        err.help(&msg);\n+\n+                if !enum_candidates.is_empty() {\n+                    // contextualize for E0412 \"cannot find type\", but don't belabor the point\n+                    // (that it's a variant) for E0573 \"expected type, found variant\"\n+                    let preamble = if def.is_none() {\n+                        let others = match enum_candidates.len() {\n+                            1 => String::new(),\n+                            2 => \" and 1 other\".to_owned(),\n+                            n => format!(\" and {} others\", n)\n+                        };\n+                        format!(\"there is an enum variant `{}`{}; \",\n+                                enum_candidates[0].0, others)\n                     } else {\n-                        err.span_suggestion_with_applicability(\n-                            span,\n-                            \"you can try using the variant's enum\",\n-                            enum_path,\n-                            Applicability::MachineApplicable,\n-                        );\n-                    }\n+                        String::new()\n+                    };\n+                    let msg = format!(\"{}try using the variant's enum\", preamble);\n+\n+                    err.span_suggestions_with_applicability(\n+                        span,\n+                        &msg,\n+                        enum_candidates.into_iter()\n+                            .map(|(_variant_path, enum_ty_path)| enum_ty_path)\n+                            // variants re\u00ebxported in prelude doesn't mean `prelude::v1` is the\n+                            // type name! FIXME: is there a more principled way to do this that\n+                            // would work for other re\u00ebxports?\n+                            .filter(|enum_ty_path| enum_ty_path != \"std::prelude::v1\")\n+                            // also say `Option` rather than `std::prelude::v1::Option`\n+                            .map(|enum_ty_path| {\n+                                // FIXME #56861: DRYer prelude filtering\n+                                enum_ty_path.trim_start_matches(\"std::prelude::v1::\").to_owned()\n+                            }),\n+                        Applicability::MachineApplicable,\n+                    );\n                 }\n             }\n             if path.len() == 1 && this.self_type_is_available(span) {\n@@ -5128,8 +5148,8 @@ fn path_names_to_string(path: &Path) -> String {\n                         .collect::<Vec<_>>())\n }\n \n-/// Get the path for an enum and the variant from an `ImportSuggestion` for an enum variant.\n-fn import_candidate_to_paths(suggestion: &ImportSuggestion) -> (Span, String, String) {\n+/// Get the stringified path for an enum from an `ImportSuggestion` for an enum variant.\n+fn import_candidate_to_enum_paths(suggestion: &ImportSuggestion) -> (String, String) {\n     let variant_path = &suggestion.path;\n     let variant_path_string = path_names_to_string(variant_path);\n \n@@ -5140,7 +5160,7 @@ fn import_candidate_to_paths(suggestion: &ImportSuggestion) -> (Span, String, St\n     };\n     let enum_path_string = path_names_to_string(&enum_path);\n \n-    (suggestion.path.span, variant_path_string, enum_path_string)\n+    (variant_path_string, enum_path_string)\n }\n \n "}, {"sha": "996b57f558cc517add601e483a2f27ee677fe851", "filename": "src/librustc_typeck/check/demand.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Flibrustc_typeck%2Fcheck%2Fdemand.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Flibrustc_typeck%2Fcheck%2Fdemand.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fdemand.rs?ref=4c971620e4bfa32df3e9da02772a2a1c68be004f", "patch": "@@ -123,6 +123,7 @@ impl<'a, 'gcx, 'tcx> FnCtxt<'a, 'gcx, 'tcx> {\n                         let sole_field_ty = sole_field.ty(self.tcx, substs);\n                         if self.can_coerce(expr_ty, sole_field_ty) {\n                             let variant_path = self.tcx.item_path_str(variant.did);\n+                            // FIXME #56861: DRYer prelude filtering\n                             Some(variant_path.trim_start_matches(\"std::prelude::v1::\").to_string())\n                         } else {\n                             None"}, {"sha": "264cfa449942c59d57010ef99562e657b2d08906", "filename": "src/test/ui/did_you_mean/issue-56028-there-is-an-enum-variant.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-56028-there-is-an-enum-variant.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-56028-there-is-an-enum-variant.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-56028-there-is-an-enum-variant.rs?ref=4c971620e4bfa32df3e9da02772a2a1c68be004f", "patch": "@@ -0,0 +1,15 @@\n+enum PutDown { Set }\n+enum AffixHeart { Set }\n+enum CauseToBe { Set }\n+enum Determine { Set }\n+enum TableDishesAction { Set }\n+enum Solidify { Set }\n+enum UnorderedCollection { Set }\n+\n+fn setup() -> Set { Set }\n+//~^ ERROR cannot find type `Set` in this scope\n+//~| ERROR cannot find value `Set` in this scope\n+\n+fn main() {\n+    setup();\n+}"}, {"sha": "6107ca32a5d75aec623a738daf538f021a82f1d8", "filename": "src/test/ui/did_you_mean/issue-56028-there-is-an-enum-variant.stderr", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-56028-there-is-an-enum-variant.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-56028-there-is-an-enum-variant.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdid_you_mean%2Fissue-56028-there-is-an-enum-variant.stderr?ref=4c971620e4bfa32df3e9da02772a2a1c68be004f", "patch": "@@ -0,0 +1,38 @@\n+error[E0412]: cannot find type `Set` in this scope\n+  --> $DIR/issue-56028-there-is-an-enum-variant.rs:9:15\n+   |\n+LL | fn setup() -> Set { Set }\n+   |               ^^^ not found in this scope\n+help: there is an enum variant `AffixHeart::Set` and 7 others; try using the variant's enum\n+   |\n+LL | fn setup() -> AffixHeart { Set }\n+   |               ^^^^^^^^^^\n+LL | fn setup() -> CauseToBe { Set }\n+   |               ^^^^^^^^^\n+LL | fn setup() -> Determine { Set }\n+   |               ^^^^^^^^^\n+LL | fn setup() -> PutDown { Set }\n+   |               ^^^^^^^\n+and 3 other candidates\n+\n+error[E0425]: cannot find value `Set` in this scope\n+  --> $DIR/issue-56028-there-is-an-enum-variant.rs:9:21\n+   |\n+LL | fn setup() -> Set { Set }\n+   |                     ^^^ not found in this scope\n+help: possible candidates are found in other modules, you can import them into scope\n+   |\n+LL | use AffixHeart::Set;\n+   |\n+LL | use CauseToBe::Set;\n+   |\n+LL | use Determine::Set;\n+   |\n+LL | use PutDown::Set;\n+   |\n+and 3 other candidates\n+\n+error: aborting due to 2 previous errors\n+\n+Some errors occurred: E0412, E0425.\n+For more information about an error, try `rustc --explain E0412`."}, {"sha": "eb869f5539f366f777f8f9f95d4a6157199aa180", "filename": "src/test/ui/enum/enum-variant-type-2.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Ftest%2Fui%2Fenum%2Fenum-variant-type-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Ftest%2Fui%2Fenum%2Fenum-variant-type-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fenum%2Fenum-variant-type-2.stderr?ref=4c971620e4bfa32df3e9da02772a2a1c68be004f", "patch": "@@ -5,7 +5,7 @@ LL | fn foo(x: Foo::Bar) {} //~ ERROR expected type, found variant `Foo::Bar`\n    |           ^^^^^^^^\n    |           |\n    |           not a type\n-   |           help: you can try using the variant's enum: `Foo`\n+   |           help: try using the variant's enum: `Foo`\n \n error: aborting due to previous error\n "}, {"sha": "a8ab5e8eb7745b4ba5320b94e37efd0c0a756ba7", "filename": "src/test/ui/issues/issue-17546.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Ftest%2Fui%2Fissues%2Fissue-17546.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Ftest%2Fui%2Fissues%2Fissue-17546.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-17546.stderr?ref=4c971620e4bfa32df3e9da02772a2a1c68be004f", "patch": "@@ -5,7 +5,7 @@ LL |     fn new() -> NoResult<MyEnum, String> {\n    |                 --------^^^^^^^^^^^^^^^^\n    |                 |\n    |                 did you mean `Result`?\n-   |                 help: you can try using the variant's enum: `foo::MyEnum`\n+   |                 help: try using the variant's enum: `foo::MyEnum`\n \n error[E0573]: expected type, found variant `Result`\n   --> $DIR/issue-17546.rs:32:17\n@@ -48,7 +48,7 @@ LL | fn newer() -> NoResult<foo::MyEnum, String> {\n    |               --------^^^^^^^^^^^^^^^^^^^^^\n    |               |\n    |               did you mean `Result`?\n-   |               help: you can try using the variant's enum: `foo::MyEnum`\n+   |               help: try using the variant's enum: `foo::MyEnum`\n \n error: aborting due to 4 previous errors\n "}, {"sha": "35ef227acfce6547ef1375852a1295972bcf1262", "filename": "src/test/ui/issues/issue-30535.stderr", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Ftest%2Fui%2Fissues%2Fissue-30535.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Ftest%2Fui%2Fissues%2Fissue-30535.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-30535.stderr?ref=4c971620e4bfa32df3e9da02772a2a1c68be004f", "patch": "@@ -2,9 +2,10 @@ error[E0573]: expected type, found variant `foo::Foo::FooV`\n   --> $DIR/issue-30535.rs:16:8\n    |\n LL |     _: foo::Foo::FooV //~ ERROR expected type, found variant `foo::Foo::FooV`\n-   |        ^^^^^^^^^^^^^^ not a type\n-   |\n-   = help: there is an enum variant `foo::Foo::FooV`, try using `foo::Foo`?\n+   |        ^^^^^^^^^^^^^^\n+   |        |\n+   |        not a type\n+   |        help: try using the variant's enum: `foo::Foo`\n \n error: aborting due to previous error\n "}, {"sha": "ead07a5f0c8fec1d64b66904f377aa07f2e577b8", "filename": "src/test/ui/issues/issue-35075.stderr", "status": "modified", "additions": 10, "deletions": 8, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Ftest%2Fui%2Fissues%2Fissue-35075.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Ftest%2Fui%2Fissues%2Fissue-35075.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-35075.stderr?ref=4c971620e4bfa32df3e9da02772a2a1c68be004f", "patch": "@@ -2,19 +2,21 @@ error[E0412]: cannot find type `Foo` in this scope\n   --> $DIR/issue-35075.rs:12:12\n    |\n LL |     inner: Foo<T> //~ ERROR cannot find type `Foo` in this scope\n-   |            ^^^---\n-   |            |\n-   |            not found in this scope\n-   |            help: you can try using the variant's enum: `Baz`\n+   |            ^^^ not found in this scope\n+help: there is an enum variant `Baz::Foo`; try using the variant's enum\n+   |\n+LL |     inner: Baz //~ ERROR cannot find type `Foo` in this scope\n+   |            ^^^\n \n error[E0412]: cannot find type `Foo` in this scope\n   --> $DIR/issue-35075.rs:16:9\n    |\n LL |     Foo(Foo<T>) //~ ERROR cannot find type `Foo` in this scope\n-   |         ^^^---\n-   |         |\n-   |         not found in this scope\n-   |         help: you can try using the variant's enum: `Baz`\n+   |         ^^^ not found in this scope\n+help: there is an enum variant `Baz::Foo`; try using the variant's enum\n+   |\n+LL |     Foo(Baz) //~ ERROR cannot find type `Foo` in this scope\n+   |         ^^^\n \n error: aborting due to 2 previous errors\n "}, {"sha": "652e1695a85a6fb4569566d16a286b709f28d7f4", "filename": "src/test/ui/issues/issue-35675.stderr", "status": "modified", "additions": 18, "deletions": 16, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Ftest%2Fui%2Fissues%2Fissue-35675.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Ftest%2Fui%2Fissues%2Fissue-35675.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-35675.stderr?ref=4c971620e4bfa32df3e9da02772a2a1c68be004f", "patch": "@@ -2,10 +2,11 @@ error[E0412]: cannot find type `Apple` in this scope\n   --> $DIR/issue-35675.rs:17:29\n    |\n LL | fn should_return_fruit() -> Apple {\n+   |                             ^^^^^ not found in this scope\n+help: there is an enum variant `Fruit::Apple`; try using the variant's enum\n+   |\n+LL | fn should_return_fruit() -> Fruit {\n    |                             ^^^^^\n-   |                             |\n-   |                             not found in this scope\n-   |                             help: you can try using the variant's enum: `Fruit`\n \n error[E0425]: cannot find function `Apple` in this scope\n   --> $DIR/issue-35675.rs:19:5\n@@ -24,7 +25,7 @@ LL | fn should_return_fruit_too() -> Fruit::Apple {\n    |                                 ^^^^^^^^^^^^\n    |                                 |\n    |                                 not a type\n-   |                                 help: you can try using the variant's enum: `Fruit`\n+   |                                 help: try using the variant's enum: `Fruit`\n \n error[E0425]: cannot find function `Apple` in this scope\n   --> $DIR/issue-35675.rs:25:5\n@@ -40,28 +41,29 @@ error[E0573]: expected type, found variant `Ok`\n   --> $DIR/issue-35675.rs:29:13\n    |\n LL | fn foo() -> Ok {\n-   |             ^^ not a type\n-   |\n-   = help: there is an enum variant `std::prelude::v1::Ok`, try using `std::prelude::v1`?\n-   = help: there is an enum variant `std::result::Result::Ok`, try using `std::result::Result`?\n+   |             ^^\n+   |             |\n+   |             not a type\n+   |             help: try using the variant's enum: `std::result::Result`\n \n error[E0412]: cannot find type `Variant3` in this scope\n   --> $DIR/issue-35675.rs:34:13\n    |\n LL | fn bar() -> Variant3 {\n-   |             ^^^^^^^^\n-   |             |\n-   |             not found in this scope\n-   |             help: you can try using the variant's enum: `x::Enum`\n+   |             ^^^^^^^^ not found in this scope\n+help: there is an enum variant `x::Enum::Variant3`; try using the variant's enum\n+   |\n+LL | fn bar() -> x::Enum {\n+   |             ^^^^^^^\n \n error[E0573]: expected type, found variant `Some`\n   --> $DIR/issue-35675.rs:38:13\n    |\n LL | fn qux() -> Some {\n-   |             ^^^^ not a type\n-   |\n-   = help: there is an enum variant `std::prelude::v1::Option::Some`, try using `std::prelude::v1::Option`?\n-   = help: there is an enum variant `std::prelude::v1::Some`, try using `std::prelude::v1`?\n+   |             ^^^^\n+   |             |\n+   |             not a type\n+   |             help: try using the variant's enum: `Option`\n \n error: aborting due to 7 previous errors\n "}, {"sha": "c72729923ef6d6d027ead1bc5dfe83e907e8cdb7", "filename": "src/test/ui/variants/variant-used-as-type.stderr", "status": "modified", "additions": 6, "deletions": 10, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Ftest%2Fui%2Fvariants%2Fvariant-used-as-type.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4c971620e4bfa32df3e9da02772a2a1c68be004f/src%2Ftest%2Fui%2Fvariants%2Fvariant-used-as-type.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fvariants%2Fvariant-used-as-type.stderr?ref=4c971620e4bfa32df3e9da02772a2a1c68be004f", "patch": "@@ -3,28 +3,24 @@ error[E0573]: expected type, found variant `Ty::A`\n    |\n LL |     B(Ty::A),\n    |       ^^^^^ not a type\n-help: you can try using the variant's enum\n-   |\n-LL |     B(Ty),\n-   |       ^^\n-help: you can try using the variant's enum\n+help: try using the variant's enum\n    |\n LL |     B(E),\n    |       ^\n+LL |     B(Ty),\n+   |       ^^\n \n error[E0573]: expected type, found variant `E::A`\n   --> $DIR/variant-used-as-type.rs:27:6\n    |\n LL | impl E::A {}\n    |      ^^^^ not a type\n-help: you can try using the variant's enum\n-   |\n-LL | impl Ty {}\n-   |      ^^\n-help: you can try using the variant's enum\n+help: try using the variant's enum\n    |\n LL | impl E {}\n    |      ^\n+LL | impl Ty {}\n+   |      ^^\n \n error: aborting due to 2 previous errors\n "}]}