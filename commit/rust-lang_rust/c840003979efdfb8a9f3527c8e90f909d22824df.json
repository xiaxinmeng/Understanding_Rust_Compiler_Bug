{"sha": "c840003979efdfb8a9f3527c8e90f909d22824df", "node_id": "C_kwDOAAsO6NoAKGM4NDAwMDM5NzllZmRmYjhhOWYzNTI3YzhlOTBmOTA5ZDIyODI0ZGY", "commit": {"author": {"name": "Josh Triplett", "email": "josh@joshtriplett.org", "date": "2021-10-26T11:16:31Z"}, "committer": {"name": "Josh Triplett", "email": "josh@joshtriplett.org", "date": "2022-01-01T23:57:35Z"}, "message": "Update instrument-coverage documentation to document stability and LLVM versions\n\nThe instrument-coverage option is stable; the details of the profile\ndata format are not.\n\nRecommend llvm-tools-preview as the preferred alternative to obtain a\ncompatible version of the LLVM tools, rather than finding LLVM tools\nelsewhere.", "tree": {"sha": "ab78aea73567b1caeffda21987b343ee0fa65601", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ab78aea73567b1caeffda21987b343ee0fa65601"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c840003979efdfb8a9f3527c8e90f909d22824df", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c840003979efdfb8a9f3527c8e90f909d22824df", "html_url": "https://github.com/rust-lang/rust/commit/c840003979efdfb8a9f3527c8e90f909d22824df", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c840003979efdfb8a9f3527c8e90f909d22824df/comments", "author": {"login": "joshtriplett", "id": 162737, "node_id": "MDQ6VXNlcjE2MjczNw==", "avatar_url": "https://avatars.githubusercontent.com/u/162737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joshtriplett", "html_url": "https://github.com/joshtriplett", "followers_url": "https://api.github.com/users/joshtriplett/followers", "following_url": "https://api.github.com/users/joshtriplett/following{/other_user}", "gists_url": "https://api.github.com/users/joshtriplett/gists{/gist_id}", "starred_url": "https://api.github.com/users/joshtriplett/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joshtriplett/subscriptions", "organizations_url": "https://api.github.com/users/joshtriplett/orgs", "repos_url": "https://api.github.com/users/joshtriplett/repos", "events_url": "https://api.github.com/users/joshtriplett/events{/privacy}", "received_events_url": "https://api.github.com/users/joshtriplett/received_events", "type": "User", "site_admin": false}, "committer": {"login": "joshtriplett", "id": 162737, "node_id": "MDQ6VXNlcjE2MjczNw==", "avatar_url": "https://avatars.githubusercontent.com/u/162737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joshtriplett", "html_url": "https://github.com/joshtriplett", "followers_url": "https://api.github.com/users/joshtriplett/followers", "following_url": "https://api.github.com/users/joshtriplett/following{/other_user}", "gists_url": "https://api.github.com/users/joshtriplett/gists{/gist_id}", "starred_url": "https://api.github.com/users/joshtriplett/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joshtriplett/subscriptions", "organizations_url": "https://api.github.com/users/joshtriplett/orgs", "repos_url": "https://api.github.com/users/joshtriplett/repos", "events_url": "https://api.github.com/users/joshtriplett/events{/privacy}", "received_events_url": "https://api.github.com/users/joshtriplett/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "760c13f48da6d674dac5a7bb2792b699b52b619c", "url": "https://api.github.com/repos/rust-lang/rust/commits/760c13f48da6d674dac5a7bb2792b699b52b619c", "html_url": "https://github.com/rust-lang/rust/commit/760c13f48da6d674dac5a7bb2792b699b52b619c"}], "stats": {"total": 10, "additions": 7, "deletions": 3}, "files": [{"sha": "3b0cf92bbb763d1450443947a5792ea71b83f02e", "filename": "src/doc/rustc/src/codegen-options/index.md", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c840003979efdfb8a9f3527c8e90f909d22824df/src%2Fdoc%2Frustc%2Fsrc%2Fcodegen-options%2Findex.md", "raw_url": "https://github.com/rust-lang/rust/raw/c840003979efdfb8a9f3527c8e90f909d22824df/src%2Fdoc%2Frustc%2Fsrc%2Fcodegen-options%2Findex.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Fcodegen-options%2Findex.md?ref=c840003979efdfb8a9f3527c8e90f909d22824df", "patch": "@@ -182,6 +182,10 @@ The default depends on the [opt-level](#opt-level):\n This option enables instrumentation-based code coverage support. See the\n chapter on [instrumentation-based code coverage] for more information.\n \n+Note that while the `-C instrument-coverage` option is stable, the profile data\n+format produced by the resulting instrumentation may change, and may not work\n+with coverage tools other than those built and shipped with the compiler.\n+\n ## link-arg\n \n This flag lets you append a single extra argument to the linker invocation."}, {"sha": "3d817f143054b9caa881e890b104777529fb0e96", "filename": "src/doc/rustc/src/instrument-coverage.md", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/c840003979efdfb8a9f3527c8e90f909d22824df/src%2Fdoc%2Frustc%2Fsrc%2Finstrument-coverage.md", "raw_url": "https://github.com/rust-lang/rust/raw/c840003979efdfb8a9f3527c8e90f909d22824df/src%2Fdoc%2Frustc%2Fsrc%2Finstrument-coverage.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Finstrument-coverage.md?ref=c840003979efdfb8a9f3527c8e90f909d22824df", "patch": "@@ -117,11 +117,11 @@ If `LLVM_PROFILE_FILE` contains a path to a non-existent directory, the missing\n \n ## Installing LLVM coverage tools\n \n-LLVM's supplies two tools\u2014`llvm-profdata` and `llvm-cov`\u2014that process coverage data and generate reports. There are several ways to find and/or install these tools, but note that the coverage mapping data generated by the Rust compiler requires LLVM version 12 or higher. (`llvm-cov --version` typically shows the tool's LLVM version number.):\n+LLVM's supplies two tools\u2014`llvm-profdata` and `llvm-cov`\u2014that process coverage data and generate reports. There are several ways to find and/or install these tools, but note that the coverage mapping data generated by the Rust compiler requires LLVM version 12 or higher, and processing the *raw* data may require exactly the LLVM version used by the compiler. (`llvm-cov --version` typically shows the tool's LLVM version number, and `rustc --verbose --version` shows the version of LLVM used by the Rust compiler.)\n \n--   You can install the LLVM tools from your operating system distribution, or from your distribution of LLVM.\n+-   You can install compatible versions of these tools via the `rustup` component `llvm-tools-preview`. This component is the recommended path, though it's still considered experimental. In this case, you may also find `cargo-binutils` useful as a wrapper around these tools.\n+-   You can install a compatible version of LLVM tools from your operating system distribution, or from your distribution of LLVM.\n -   If you are building the Rust compiler from source, you can optionally use the bundled LLVM tools, built from source. Those tool binaries can typically be found in your build platform directory at something like: `rust/build/x86_64-unknown-linux-gnu/llvm/bin/llvm-*`.\n--   You can install compatible versions of these tools via the `rustup` component `llvm-tools-preview`, though this is still considered experimental. In this case, you may also find `cargo-binutils` useful as a wrapper around these tools.\n \n The examples in this document show how to use the llvm tools directly.\n "}]}