{"sha": "ad7338e5659f5711e08502906147e22b44e41a3e", "node_id": "C_kwDOAAsO6NoAKGFkNzMzOGU1NjU5ZjU3MTFlMDg1MDI5MDYxNDdlMjJiNDRlNDFhM2U", "commit": {"author": {"name": "Evan Typanski", "email": "evantypanski@gmail.com", "date": "2022-05-13T09:55:50Z"}, "committer": {"name": "Evan Typanski", "email": "evantypanski@gmail.com", "date": "2022-05-13T09:55:50Z"}, "message": "Comment why `hir_ty_to_ty` is safe in `check_ty`", "tree": {"sha": "dd1a7217a7c77b82ba1c2e65586e49c35f54815d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/dd1a7217a7c77b82ba1c2e65586e49c35f54815d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ad7338e5659f5711e08502906147e22b44e41a3e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ad7338e5659f5711e08502906147e22b44e41a3e", "html_url": "https://github.com/rust-lang/rust/commit/ad7338e5659f5711e08502906147e22b44e41a3e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ad7338e5659f5711e08502906147e22b44e41a3e/comments", "author": {"login": "evantypanski", "id": 22875724, "node_id": "MDQ6VXNlcjIyODc1NzI0", "avatar_url": "https://avatars.githubusercontent.com/u/22875724?v=4", "gravatar_id": "", "url": "https://api.github.com/users/evantypanski", "html_url": "https://github.com/evantypanski", "followers_url": "https://api.github.com/users/evantypanski/followers", "following_url": "https://api.github.com/users/evantypanski/following{/other_user}", "gists_url": "https://api.github.com/users/evantypanski/gists{/gist_id}", "starred_url": "https://api.github.com/users/evantypanski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/evantypanski/subscriptions", "organizations_url": "https://api.github.com/users/evantypanski/orgs", "repos_url": "https://api.github.com/users/evantypanski/repos", "events_url": "https://api.github.com/users/evantypanski/events{/privacy}", "received_events_url": "https://api.github.com/users/evantypanski/received_events", "type": "User", "site_admin": false}, "committer": {"login": "evantypanski", "id": 22875724, "node_id": "MDQ6VXNlcjIyODc1NzI0", "avatar_url": "https://avatars.githubusercontent.com/u/22875724?v=4", "gravatar_id": "", "url": "https://api.github.com/users/evantypanski", "html_url": "https://github.com/evantypanski", "followers_url": "https://api.github.com/users/evantypanski/followers", "following_url": "https://api.github.com/users/evantypanski/following{/other_user}", "gists_url": "https://api.github.com/users/evantypanski/gists{/gist_id}", "starred_url": "https://api.github.com/users/evantypanski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/evantypanski/subscriptions", "organizations_url": "https://api.github.com/users/evantypanski/orgs", "repos_url": "https://api.github.com/users/evantypanski/repos", "events_url": "https://api.github.com/users/evantypanski/events{/privacy}", "received_events_url": "https://api.github.com/users/evantypanski/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0def44a1c15e624a6e51206048895021f5b1ee92", "url": "https://api.github.com/repos/rust-lang/rust/commits/0def44a1c15e624a6e51206048895021f5b1ee92", "html_url": "https://github.com/rust-lang/rust/commit/0def44a1c15e624a6e51206048895021f5b1ee92"}], "stats": {"total": 4, "additions": 3, "deletions": 1}, "files": [{"sha": "a1312fcda0b71f251b6443e78b23d12438135ccb", "filename": "clippy_lints/src/types/redundant_allocation.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ad7338e5659f5711e08502906147e22b44e41a3e/clippy_lints%2Fsrc%2Ftypes%2Fredundant_allocation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ad7338e5659f5711e08502906147e22b44e41a3e/clippy_lints%2Fsrc%2Ftypes%2Fredundant_allocation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Ftypes%2Fredundant_allocation.rs?ref=ad7338e5659f5711e08502906147e22b44e41a3e", "patch": "@@ -55,7 +55,9 @@ pub(super) fn check(cx: &LateContext<'_>, hir_ty: &hir::Ty<'_>, qpath: &QPath<'_\n     };\n     let inner_span = match qpath_generic_tys(inner_qpath).next() {\n         Some(ty) => {\n-            // Reallocation of a fat pointer causes it to become thin\n+            // Reallocation of a fat pointer causes it to become thin. `hir_ty_to_ty` is safe to use\n+            // here because `mod.rs` guarantees this lint is only run on types outside of bodies and\n+            // is not run on locals.\n             if !hir_ty_to_ty(cx.tcx, ty).is_sized(cx.tcx.at(ty.span), cx.param_env) {\n                 return false;\n             }"}]}