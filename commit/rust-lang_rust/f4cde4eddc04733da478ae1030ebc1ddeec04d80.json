{"sha": "f4cde4eddc04733da478ae1030ebc1ddeec04d80", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY0Y2RlNGVkZGMwNDczM2RhNDc4YWUxMDMwZWJjMWRkZWVjMDRkODA=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2014-04-05T01:53:28Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2014-04-05T01:53:28Z"}, "message": "Rough regression test for #13266.\n\nAll it checks, unfortunately, is that you actually printed at least\ntwo lines for crateA paths and at least one line for crateB paths.\nBut that's enough to capture the spirit of the bug, I think.  I did\nnot bother trying to verify that the paths themselves reflected where\nthe crates end up.", "tree": {"sha": "b2e98bfb34b8fd8e45fc34416613910f41bcd4cd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b2e98bfb34b8fd8e45fc34416613910f41bcd4cd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f4cde4eddc04733da478ae1030ebc1ddeec04d80", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f4cde4eddc04733da478ae1030ebc1ddeec04d80", "html_url": "https://github.com/rust-lang/rust/commit/f4cde4eddc04733da478ae1030ebc1ddeec04d80", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f4cde4eddc04733da478ae1030ebc1ddeec04d80/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4afd060a5917dfcb6f841e7619d9f9026bd20b9d", "url": "https://api.github.com/repos/rust-lang/rust/commits/4afd060a5917dfcb6f841e7619d9f9026bd20b9d", "html_url": "https://github.com/rust-lang/rust/commit/4afd060a5917dfcb6f841e7619d9f9026bd20b9d"}], "stats": {"total": 100, "additions": 100, "deletions": 0}, "files": [{"sha": "4d80c09c26b337572f81066f83e58eb0ab386b4c", "filename": "src/test/run-make/many-crates-but-no-match/Makefile", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/f4cde4eddc04733da478ae1030ebc1ddeec04d80/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/f4cde4eddc04733da478ae1030ebc1ddeec04d80/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FMakefile?ref=f4cde4eddc04733da478ae1030ebc1ddeec04d80", "patch": "@@ -0,0 +1,34 @@\n+-include ../tools.mk\n+\n+# Modelled after compile-fail/changing-crates test, but this one puts\n+# more than one (mismatching) candidate crate into the search path,\n+# which did not appear directly expressible in compile-fail/aux-build\n+# infrastructure.\n+#\n+# Note that we move the built libraries into target direcrtories rather than\n+# use the `--out-dir` option because the `../tools.mk` file already bakes a\n+# use of `--out-dir` into the definition of $(RUSTC).\n+\n+A1=$(TMPDIR)/a1\n+A2=$(TMPDIR)/a2\n+A3=$(TMPDIR)/a3\n+\n+# A hack to match distinct lines of output from a single run.\n+LOG=$(TMPDIR)/log.txt\n+\n+all: \n+\tmkdir -p $(A1) $(A2) $(A3)\n+\t$(RUSTC) --crate-type=rlib crateA1.rs\n+\tmv $(TMPDIR)/$(call RLIB_GLOB,crateA) $(A1)\n+\t$(RUSTC) --crate-type=rlib -L$(A1) crateB.rs\n+\t$(RUSTC) --crate-type=rlib crateA2.rs\n+\tmv $(TMPDIR)/$(call RLIB_GLOB,crateA) $(A2)\n+\t$(RUSTC) --crate-type=rlib crateA3.rs\n+\tmv $(TMPDIR)/$(call RLIB_GLOB,crateA) $(A3)\n+\t# Ensure crateC fails to compile since A1 is \"missing\" and A2/A3 hashes do not match\n+\t$(RUSTC) -L$(A2) -L$(A3) crateC.rs >$(LOG) 2>&1 || true\n+\tgrep \"error: found possibly newer version of crate \\`crateA\\` which \\`crateB\\` depends on\" $(LOG)\n+\tgrep \"note: perhaps this crate needs to be recompiled?\" $(LOG)\n+\tgrep \"note: crate \\`crateA\\` path #1:\" $(LOG)\n+\tgrep \"note: crate \\`crateA\\` path #2:\" $(LOG)\n+\tgrep \"note: crate \\`crateB\\` path #1:\" $(LOG)"}, {"sha": "0c88cf4745a00e87cbdfed4562e03fa4b20725ad", "filename": "src/test/run-make/many-crates-but-no-match/crateA1.rs", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/f4cde4eddc04733da478ae1030ebc1ddeec04d80/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FcrateA1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f4cde4eddc04733da478ae1030ebc1ddeec04d80/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FcrateA1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FcrateA1.rs?ref=f4cde4eddc04733da478ae1030ebc1ddeec04d80", "patch": "@@ -0,0 +1,14 @@\n+// Copyright 2014 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+#![crate_id=\"crateA\"]\n+\n+// Base crate\n+pub fn func<T>() {}"}, {"sha": "e3fb50e13d0eb1d65a07f9cefaa0addbcf801353", "filename": "src/test/run-make/many-crates-but-no-match/crateA2.rs", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/f4cde4eddc04733da478ae1030ebc1ddeec04d80/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FcrateA2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f4cde4eddc04733da478ae1030ebc1ddeec04d80/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FcrateA2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FcrateA2.rs?ref=f4cde4eddc04733da478ae1030ebc1ddeec04d80", "patch": "@@ -0,0 +1,14 @@\n+// Copyright 2014 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+#![crate_id=\"crateA\"]\n+\n+// Base crate\n+pub fn func<T>() { println!(\"hello\"); }"}, {"sha": "ad9d458be242d6fe7bc4873d20f79b74210f4511", "filename": "src/test/run-make/many-crates-but-no-match/crateA3.rs", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/f4cde4eddc04733da478ae1030ebc1ddeec04d80/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FcrateA3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f4cde4eddc04733da478ae1030ebc1ddeec04d80/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FcrateA3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FcrateA3.rs?ref=f4cde4eddc04733da478ae1030ebc1ddeec04d80", "patch": "@@ -0,0 +1,14 @@\n+// Copyright 2014 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+#![crate_id=\"crateA\"]\n+\n+// Base crate\n+pub fn foo<T>() { println!(\"world!\"); }"}, {"sha": "bf55017c6463f7c0d247777c560c1eb423aa8abd", "filename": "src/test/run-make/many-crates-but-no-match/crateB.rs", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/f4cde4eddc04733da478ae1030ebc1ddeec04d80/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FcrateB.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f4cde4eddc04733da478ae1030ebc1ddeec04d80/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FcrateB.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FcrateB.rs?ref=f4cde4eddc04733da478ae1030ebc1ddeec04d80", "patch": "@@ -0,0 +1,11 @@\n+// Copyright 2014 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+extern crate crateA;"}, {"sha": "174d9382b76be37f56b466240ece1e7ea9ab0b7a", "filename": "src/test/run-make/many-crates-but-no-match/crateC.rs", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/f4cde4eddc04733da478ae1030ebc1ddeec04d80/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FcrateC.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f4cde4eddc04733da478ae1030ebc1ddeec04d80/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FcrateC.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fmany-crates-but-no-match%2FcrateC.rs?ref=f4cde4eddc04733da478ae1030ebc1ddeec04d80", "patch": "@@ -0,0 +1,13 @@\n+// Copyright 2014 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+extern crate crateB;\n+\n+fn main() {}"}]}