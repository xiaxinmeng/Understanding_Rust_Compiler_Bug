{"sha": "bde794dadabd294b8a8a8a9157dbc52d0d469c15", "node_id": "C_kwDOAAsO6NoAKGJkZTc5NGRhZGFiZDI5NGI4YThhOGE5MTU3ZGJjNTJkMGQ0NjljMTU", "commit": {"author": {"name": "Tor Hovland", "email": "tor.hovland@bekk.no", "date": "2021-04-04T11:33:33Z"}, "committer": {"name": "Tor Hovland", "email": "tor.hovland@bekk.no", "date": "2021-11-02T21:43:48Z"}, "message": "Create temps_dir before it's needed.", "tree": {"sha": "bf5e4ae1c9e38af027edac84ae96a9f2aba6d62b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bf5e4ae1c9e38af027edac84ae96a9f2aba6d62b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bde794dadabd294b8a8a8a9157dbc52d0d469c15", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bde794dadabd294b8a8a8a9157dbc52d0d469c15", "html_url": "https://github.com/rust-lang/rust/commit/bde794dadabd294b8a8a8a9157dbc52d0d469c15", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bde794dadabd294b8a8a8a9157dbc52d0d469c15/comments", "author": null, "committer": null, "parents": [{"sha": "5d1e09f44ab0bd3ca29acf44d92e884ec140d00a", "url": "https://api.github.com/repos/rust-lang/rust/commits/5d1e09f44ab0bd3ca29acf44d92e884ec140d00a", "html_url": "https://github.com/rust-lang/rust/commit/5d1e09f44ab0bd3ca29acf44d92e884ec140d00a"}], "stats": {"total": 13, "additions": 7, "deletions": 6}, "files": [{"sha": "e0b0a2195f50d22882e9cee4437e6b79e4979109", "filename": "compiler/rustc_interface/src/passes.rs", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/bde794dadabd294b8a8a8a9157dbc52d0d469c15/compiler%2Frustc_interface%2Fsrc%2Fpasses.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bde794dadabd294b8a8a8a9157dbc52d0d469c15/compiler%2Frustc_interface%2Fsrc%2Fpasses.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_interface%2Fsrc%2Fpasses.rs?ref=bde794dadabd294b8a8a8a9157dbc52d0d469c15", "patch": "@@ -723,6 +723,13 @@ pub fn prepare_outputs(\n         }\n     }\n \n+    if let Some(ref dir) = compiler.temps_dir {\n+        if fs::create_dir_all(dir).is_err() {\n+            sess.err(\"failed to find or create the directory specified by `--temps-dir`\");\n+            return Err(ErrorReported);\n+        }\n+    }\n+\n     write_out_deps(sess, boxed_resolver, &outputs, &output_paths);\n \n     let only_dep_info = sess.opts.output_types.contains_key(&OutputType::DepInfo)\n@@ -735,12 +742,6 @@ pub fn prepare_outputs(\n                 return Err(ErrorReported);\n             }\n         }\n-        if let Some(ref dir) = compiler.temps_dir {\n-            if fs::create_dir_all(dir).is_err() {\n-                sess.err(\"failed to find or create the directory specified by `--temps-dir`\");\n-                return Err(ErrorReported);\n-            }\n-        }\n     }\n \n     Ok(outputs)"}]}