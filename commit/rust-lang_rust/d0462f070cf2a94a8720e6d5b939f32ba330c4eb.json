{"sha": "d0462f070cf2a94a8720e6d5b939f32ba330c4eb", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQwNDYyZjA3MGNmMmE5NGE4NzIwZTZkNWI5MzlmMzJiYTMzMGM0ZWI=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2013-09-13T06:26:06Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2013-09-13T06:26:06Z"}, "message": "Improve the local_data docs slightly\n\nRemove references to local_data::Key and only mention the macro for how to\nconstruct new keys into local data.", "tree": {"sha": "6add4018ac685e6b9cf88f3259aff932bee87595", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6add4018ac685e6b9cf88f3259aff932bee87595"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d0462f070cf2a94a8720e6d5b939f32ba330c4eb", "comment_count": 13, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d0462f070cf2a94a8720e6d5b939f32ba330c4eb", "html_url": "https://github.com/rust-lang/rust/commit/d0462f070cf2a94a8720e6d5b939f32ba330c4eb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d0462f070cf2a94a8720e6d5b939f32ba330c4eb/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "af259a651d52e7243c74a833b2b39a61890e89fe", "url": "https://api.github.com/repos/rust-lang/rust/commits/af259a651d52e7243c74a833b2b39a61890e89fe", "html_url": "https://github.com/rust-lang/rust/commit/af259a651d52e7243c74a833b2b39a61890e89fe"}], "stats": {"total": 15, "additions": 8, "deletions": 7}, "files": [{"sha": "89bdb57e2bdb80fe5945971d6c8661b805319067", "filename": "src/libstd/local_data.rs", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/d0462f070cf2a94a8720e6d5b939f32ba330c4eb/src%2Flibstd%2Flocal_data.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0462f070cf2a94a8720e6d5b939f32ba330c4eb/src%2Flibstd%2Flocal_data.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Flocal_data.rs?ref=d0462f070cf2a94a8720e6d5b939f32ba330c4eb", "patch": "@@ -17,9 +17,10 @@ anywhere within a task, keyed by a global pointer parameterized over the type of\n the TLS slot.  Useful for dynamic variables, singletons, and interfacing with\n foreign code with bad callback interfaces.\n \n-To use, declare a static variable of the type you wish to store. The\n-initialization should be `&local_data::Key`. This is then the key to what you\n-wish to store.\n+To declare a new key for storing local data of a particular type, use the\n+`local_data_key!` macro. This macro will expand to a `static` item apppriately\n+named and annotated. This name is then passed to the functions in this module to\n+modify/read the slot specified by the key.\n \n ~~~{.rust}\n use std::local_data;\n@@ -31,14 +32,14 @@ local_data::set(key_int, 3);\n local_data::get(key_int, |opt| assert_eq!(opt, Some(&3)));\n \n local_data::set(key_vector, ~[4]);\n-local_data::get(key_int, |opt| assert_eq!(opt, Some(&~[4])));\n+local_data::get(key_vector, |opt| assert_eq!(opt, Some(&~[4])));\n ~~~\n \n-Casting 'Arcane Sight' reveals an overwhelming aura of Transmutation\n-magic.\n-\n */\n \n+// Casting 'Arcane Sight' reveals an overwhelming aura of Transmutation\n+// magic.\n+\n use cast;\n use libc;\n use prelude::*;"}]}