{"sha": "b873fa6d42cf305131d2583d03b84686e5e40f2e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI4NzNmYTZkNDJjZjMwNTEzMWQyNTgzZDAzYjg0Njg2ZTVlNDBmMmU=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-09-20T13:07:11Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-09-20T13:07:11Z"}, "message": "Auto merge of #76136 - CDirkx:const-result, r=dtolnay\n\nStabilize some Result methods as const\n\nStabilize the following methods of Result as const:\n - `is_ok`\n - `is_err`\n - `as_ref`\n\nA test is also included, analogous to the test for `const_option`.\n\nThese methods are currently const under the unstable feature `const_result` (tracking issue: #67520).\nI believe these methods to be eligible for stabilization because of the stabilization of #49146 (Allow if and match in constants) and the trivial implementations, see also: [PR#75463](https://github.com/rust-lang/rust/pull/75463) and [PR#76135](https://github.com/rust-lang/rust/pull/76135).\n\nNote: these methods are the only methods currently under the `const_result` feature, thus this PR results in the removal of the feature.\n\nRelated: #76225", "tree": {"sha": "f26b56f7553401eee94a20f954031affd079389a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f26b56f7553401eee94a20f954031affd079389a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b873fa6d42cf305131d2583d03b84686e5e40f2e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b873fa6d42cf305131d2583d03b84686e5e40f2e", "html_url": "https://github.com/rust-lang/rust/commit/b873fa6d42cf305131d2583d03b84686e5e40f2e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b873fa6d42cf305131d2583d03b84686e5e40f2e/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "41507ed0d57eba71adc20a021a19b64322162f04", "url": "https://api.github.com/repos/rust-lang/rust/commits/41507ed0d57eba71adc20a021a19b64322162f04", "html_url": "https://github.com/rust-lang/rust/commit/41507ed0d57eba71adc20a021a19b64322162f04"}, {"sha": "bf70e21a7e48008a8c1d82c3b0376e574f9bc91b", "url": "https://api.github.com/repos/rust-lang/rust/commits/bf70e21a7e48008a8c1d82c3b0376e574f9bc91b", "html_url": "https://github.com/rust-lang/rust/commit/bf70e21a7e48008a8c1d82c3b0376e574f9bc91b"}], "stats": {"total": 307, "additions": 116, "deletions": 191}, "files": [{"sha": "8cd09f8017d9bd9fef049b8b7e5e36f9ca1a71d5", "filename": "library/core/src/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b873fa6d42cf305131d2583d03b84686e5e40f2e/library%2Fcore%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b873fa6d42cf305131d2583d03b84686e5e40f2e/library%2Fcore%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Flib.rs?ref=b873fa6d42cf305131d2583d03b84686e5e40f2e", "patch": "@@ -87,7 +87,6 @@\n #![feature(const_ptr_offset)]\n #![feature(const_ptr_offset_from)]\n #![feature(const_raw_ptr_comparison)]\n-#![feature(const_result)]\n #![feature(const_slice_from_raw_parts)]\n #![feature(const_slice_ptr_len)]\n #![feature(const_size_of_val)]"}, {"sha": "5cec183c237d706bacca90dcdcb2fa854df5074d", "filename": "library/core/src/result.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/b873fa6d42cf305131d2583d03b84686e5e40f2e/library%2Fcore%2Fsrc%2Fresult.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b873fa6d42cf305131d2583d03b84686e5e40f2e/library%2Fcore%2Fsrc%2Fresult.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fresult.rs?ref=b873fa6d42cf305131d2583d03b84686e5e40f2e", "patch": "@@ -273,7 +273,7 @@ impl<T, E> Result<T, E> {\n     /// assert_eq!(x.is_ok(), false);\n     /// ```\n     #[must_use = \"if you intended to assert that this is ok, consider `.unwrap()` instead\"]\n-    #[rustc_const_unstable(feature = \"const_result\", issue = \"67520\")]\n+    #[rustc_const_stable(feature = \"const_result\", since = \"1.48.0\")]\n     #[inline]\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     pub const fn is_ok(&self) -> bool {\n@@ -294,7 +294,7 @@ impl<T, E> Result<T, E> {\n     /// assert_eq!(x.is_err(), true);\n     /// ```\n     #[must_use = \"if you intended to assert that this is err, consider `.unwrap_err()` instead\"]\n-    #[rustc_const_unstable(feature = \"const_result\", issue = \"67520\")]\n+    #[rustc_const_stable(feature = \"const_result\", since = \"1.48.0\")]\n     #[inline]\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     pub const fn is_err(&self) -> bool {\n@@ -438,7 +438,7 @@ impl<T, E> Result<T, E> {\n     /// assert_eq!(x.as_ref(), Err(&\"Error\"));\n     /// ```\n     #[inline]\n-    #[rustc_const_unstable(feature = \"const_result\", issue = \"67520\")]\n+    #[rustc_const_stable(feature = \"const_result\", since = \"1.48.0\")]\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     pub const fn as_ref(&self) -> Result<&T, &E> {\n         match *self {"}, {"sha": "39ea4831b9b867198c3beac39a031773b5dfa08b", "filename": "library/core/tests/result.rs", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/b873fa6d42cf305131d2583d03b84686e5e40f2e/library%2Fcore%2Ftests%2Fresult.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b873fa6d42cf305131d2583d03b84686e5e40f2e/library%2Fcore%2Ftests%2Fresult.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Ftests%2Fresult.rs?ref=b873fa6d42cf305131d2583d03b84686e5e40f2e", "patch": "@@ -304,3 +304,19 @@ fn test_result_as_deref_mut() {\n     let expected_result = Result::Err::<&mut u32, &mut Vec<i32>>(&mut expected_vec);\n     assert_eq!(mut_err.as_deref_mut(), expected_result);\n }\n+\n+#[test]\n+fn result_const() {\n+    // test that the methods of `Result` are usable in a const context\n+\n+    const RESULT: Result<usize, bool> = Ok(32);\n+\n+    const REF: Result<&usize, &bool> = RESULT.as_ref();\n+    assert_eq!(REF, Ok(&32));\n+\n+    const IS_OK: bool = RESULT.is_ok();\n+    assert!(IS_OK);\n+\n+    const IS_ERR: bool = RESULT.is_err();\n+    assert!(!IS_ERR)\n+}"}, {"sha": "db52c97475fa7aa03774b617b37035a099b19b5b", "filename": "src/tools/clippy/clippy_lints/src/matches.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/b873fa6d42cf305131d2583d03b84686e5e40f2e/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Fmatches.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b873fa6d42cf305131d2583d03b84686e5e40f2e/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Fmatches.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Fmatches.rs?ref=b873fa6d42cf305131d2583d03b84686e5e40f2e", "patch": "@@ -1469,10 +1469,10 @@ mod redundant_pattern_match {\n         keyword: &'static str,\n     ) {\n         fn find_suggestion(cx: &LateContext<'_>, hir_id: HirId, path: &QPath<'_>) -> Option<&'static str> {\n-            if match_qpath(path, &paths::RESULT_OK) && can_suggest(cx, hir_id, sym!(result_type), \"is_ok\") {\n+            if match_qpath(path, &paths::RESULT_OK) {\n                 return Some(\"is_ok()\");\n             }\n-            if match_qpath(path, &paths::RESULT_ERR) && can_suggest(cx, hir_id, sym!(result_type), \"is_err\") {\n+            if match_qpath(path, &paths::RESULT_ERR) {\n                 return Some(\"is_err()\");\n             }\n             if match_qpath(path, &paths::OPTION_SOME) && can_suggest(cx, hir_id, sym!(option_type), \"is_some\") {\n@@ -1562,8 +1562,8 @@ mod redundant_pattern_match {\n                             &paths::RESULT_ERR,\n                             \"is_ok()\",\n                             \"is_err()\",\n-                            || can_suggest(cx, hir_id, sym!(result_type), \"is_ok\"),\n-                            || can_suggest(cx, hir_id, sym!(result_type), \"is_err\"),\n+                            || true,\n+                            || true,\n                         )\n                     } else {\n                         None"}, {"sha": "08bfe7c78d38b10d6105a9b119ba31b30b168358", "filename": "src/tools/clippy/tests/ui/redundant_pattern_matching.fixed", "status": "modified", "additions": 18, "deletions": 17, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/b873fa6d42cf305131d2583d03b84686e5e40f2e/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/b873fa6d42cf305131d2583d03b84686e5e40f2e/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching.fixed?ref=b873fa6d42cf305131d2583d03b84686e5e40f2e", "patch": "@@ -77,6 +77,7 @@ fn main() {\n \n     issue5504();\n     issue5697();\n+    issue6067();\n \n     let _ = if gen_opt().is_some() {\n         1\n@@ -131,31 +132,14 @@ fn issue5504() {\n // None of these should be linted because none of the suggested methods\n // are `const fn` without toggling a feature.\n const fn issue5697() {\n-    if let Ok(_) = Ok::<i32, i32>(42) {}\n-\n-    if let Err(_) = Err::<i32, i32>(42) {}\n-\n     if let Some(_) = Some(42) {}\n \n     if let None = None::<()> {}\n \n-    while let Ok(_) = Ok::<i32, i32>(10) {}\n-\n-    while let Err(_) = Ok::<i32, i32>(10) {}\n-\n     while let Some(_) = Some(42) {}\n \n     while let None = None::<()> {}\n \n-    match Ok::<i32, i32>(42) {\n-        Ok(_) => true,\n-        Err(_) => false,\n-    };\n-\n-    match Err::<i32, i32>(42) {\n-        Ok(_) => false,\n-        Err(_) => true,\n-    };\n     match Some(42) {\n         Some(_) => true,\n         None => false,\n@@ -166,3 +150,20 @@ const fn issue5697() {\n         None => true,\n     };\n }\n+\n+// Methods that are unstable const should not be suggested within a const context, see issue #5697.\n+// However, in Rust 1.48.0 the methods `is_ok` and `is_err` of `Result` were stabilized as const,\n+// so the following should be linted.\n+const fn issue6067() {\n+    if Ok::<i32, i32>(42).is_ok() {}\n+\n+    if Err::<i32, i32>(42).is_err() {}\n+\n+    while Ok::<i32, i32>(10).is_ok() {}\n+\n+    while Ok::<i32, i32>(10).is_err() {}\n+\n+    Ok::<i32, i32>(42).is_ok();\n+\n+    Err::<i32, i32>(42).is_err();\n+}"}, {"sha": "c0660c6ac394707d41b2f4a8d66ee289e397a633", "filename": "src/tools/clippy/tests/ui/redundant_pattern_matching.rs", "status": "modified", "additions": 24, "deletions": 17, "changes": 41, "blob_url": "https://github.com/rust-lang/rust/blob/b873fa6d42cf305131d2583d03b84686e5e40f2e/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b873fa6d42cf305131d2583d03b84686e5e40f2e/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching.rs?ref=b873fa6d42cf305131d2583d03b84686e5e40f2e", "patch": "@@ -98,6 +98,7 @@ fn main() {\n \n     issue5504();\n     issue5697();\n+    issue6067();\n \n     let _ = if let Some(_) = gen_opt() {\n         1\n@@ -152,31 +153,14 @@ fn issue5504() {\n // None of these should be linted because none of the suggested methods\n // are `const fn` without toggling a feature.\n const fn issue5697() {\n-    if let Ok(_) = Ok::<i32, i32>(42) {}\n-\n-    if let Err(_) = Err::<i32, i32>(42) {}\n-\n     if let Some(_) = Some(42) {}\n \n     if let None = None::<()> {}\n \n-    while let Ok(_) = Ok::<i32, i32>(10) {}\n-\n-    while let Err(_) = Ok::<i32, i32>(10) {}\n-\n     while let Some(_) = Some(42) {}\n \n     while let None = None::<()> {}\n \n-    match Ok::<i32, i32>(42) {\n-        Ok(_) => true,\n-        Err(_) => false,\n-    };\n-\n-    match Err::<i32, i32>(42) {\n-        Ok(_) => false,\n-        Err(_) => true,\n-    };\n     match Some(42) {\n         Some(_) => true,\n         None => false,\n@@ -187,3 +171,26 @@ const fn issue5697() {\n         None => true,\n     };\n }\n+\n+// Methods that are unstable const should not be suggested within a const context, see issue #5697.\n+// However, in Rust 1.48.0 the methods `is_ok` and `is_err` of `Result` were stabilized as const,\n+// so the following should be linted.\n+const fn issue6067() {\n+    if let Ok(_) = Ok::<i32, i32>(42) {}\n+\n+    if let Err(_) = Err::<i32, i32>(42) {}\n+\n+    while let Ok(_) = Ok::<i32, i32>(10) {}\n+\n+    while let Err(_) = Ok::<i32, i32>(10) {}\n+\n+    match Ok::<i32, i32>(42) {\n+        Ok(_) => true,\n+        Err(_) => false,\n+    };\n+\n+    match Err::<i32, i32>(42) {\n+        Ok(_) => false,\n+        Err(_) => true,\n+    };\n+}"}, {"sha": "efd2f9903ec9cff563ef2491f60637f79572bd63", "filename": "src/tools/clippy/tests/ui/redundant_pattern_matching.stderr", "status": "modified", "additions": 51, "deletions": 9, "changes": 60, "blob_url": "https://github.com/rust-lang/rust/blob/b873fa6d42cf305131d2583d03b84686e5e40f2e/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b873fa6d42cf305131d2583d03b84686e5e40f2e/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching.stderr?ref=b873fa6d42cf305131d2583d03b84686e5e40f2e", "patch": "@@ -149,52 +149,94 @@ LL |     let x = if let Some(_) = opt { true } else { false };\n    |             -------^^^^^^^------ help: try this: `if opt.is_some()`\n \n error: redundant pattern matching, consider using `is_some()`\n-  --> $DIR/redundant_pattern_matching.rs:102:20\n+  --> $DIR/redundant_pattern_matching.rs:103:20\n    |\n LL |     let _ = if let Some(_) = gen_opt() {\n    |             -------^^^^^^^------------ help: try this: `if gen_opt().is_some()`\n \n error: redundant pattern matching, consider using `is_none()`\n-  --> $DIR/redundant_pattern_matching.rs:104:19\n+  --> $DIR/redundant_pattern_matching.rs:105:19\n    |\n LL |     } else if let None = gen_opt() {\n    |            -------^^^^------------ help: try this: `if gen_opt().is_none()`\n \n error: redundant pattern matching, consider using `is_ok()`\n-  --> $DIR/redundant_pattern_matching.rs:106:19\n+  --> $DIR/redundant_pattern_matching.rs:107:19\n    |\n LL |     } else if let Ok(_) = gen_res() {\n    |            -------^^^^^------------ help: try this: `if gen_res().is_ok()`\n \n error: redundant pattern matching, consider using `is_err()`\n-  --> $DIR/redundant_pattern_matching.rs:108:19\n+  --> $DIR/redundant_pattern_matching.rs:109:19\n    |\n LL |     } else if let Err(_) = gen_res() {\n    |            -------^^^^^^------------ help: try this: `if gen_res().is_err()`\n \n error: redundant pattern matching, consider using `is_some()`\n-  --> $DIR/redundant_pattern_matching.rs:141:19\n+  --> $DIR/redundant_pattern_matching.rs:142:19\n    |\n LL |         while let Some(_) = r#try!(result_opt()) {}\n    |         ----------^^^^^^^----------------------- help: try this: `while r#try!(result_opt()).is_some()`\n \n error: redundant pattern matching, consider using `is_some()`\n-  --> $DIR/redundant_pattern_matching.rs:142:16\n+  --> $DIR/redundant_pattern_matching.rs:143:16\n    |\n LL |         if let Some(_) = r#try!(result_opt()) {}\n    |         -------^^^^^^^----------------------- help: try this: `if r#try!(result_opt()).is_some()`\n \n error: redundant pattern matching, consider using `is_some()`\n-  --> $DIR/redundant_pattern_matching.rs:148:12\n+  --> $DIR/redundant_pattern_matching.rs:149:12\n    |\n LL |     if let Some(_) = m!() {}\n    |     -------^^^^^^^------- help: try this: `if m!().is_some()`\n \n error: redundant pattern matching, consider using `is_some()`\n-  --> $DIR/redundant_pattern_matching.rs:149:15\n+  --> $DIR/redundant_pattern_matching.rs:150:15\n    |\n LL |     while let Some(_) = m!() {}\n    |     ----------^^^^^^^------- help: try this: `while m!().is_some()`\n \n-error: aborting due to 29 previous errors\n+error: redundant pattern matching, consider using `is_ok()`\n+  --> $DIR/redundant_pattern_matching.rs:179:12\n+   |\n+LL |     if let Ok(_) = Ok::<i32, i32>(42) {}\n+   |     -------^^^^^--------------------- help: try this: `if Ok::<i32, i32>(42).is_ok()`\n+\n+error: redundant pattern matching, consider using `is_err()`\n+  --> $DIR/redundant_pattern_matching.rs:181:12\n+   |\n+LL |     if let Err(_) = Err::<i32, i32>(42) {}\n+   |     -------^^^^^^---------------------- help: try this: `if Err::<i32, i32>(42).is_err()`\n+\n+error: redundant pattern matching, consider using `is_ok()`\n+  --> $DIR/redundant_pattern_matching.rs:183:15\n+   |\n+LL |     while let Ok(_) = Ok::<i32, i32>(10) {}\n+   |     ----------^^^^^--------------------- help: try this: `while Ok::<i32, i32>(10).is_ok()`\n+\n+error: redundant pattern matching, consider using `is_err()`\n+  --> $DIR/redundant_pattern_matching.rs:185:15\n+   |\n+LL |     while let Err(_) = Ok::<i32, i32>(10) {}\n+   |     ----------^^^^^^--------------------- help: try this: `while Ok::<i32, i32>(10).is_err()`\n+\n+error: redundant pattern matching, consider using `is_ok()`\n+  --> $DIR/redundant_pattern_matching.rs:187:5\n+   |\n+LL | /     match Ok::<i32, i32>(42) {\n+LL | |         Ok(_) => true,\n+LL | |         Err(_) => false,\n+LL | |     };\n+   | |_____^ help: try this: `Ok::<i32, i32>(42).is_ok()`\n+\n+error: redundant pattern matching, consider using `is_err()`\n+  --> $DIR/redundant_pattern_matching.rs:192:5\n+   |\n+LL | /     match Err::<i32, i32>(42) {\n+LL | |         Ok(_) => false,\n+LL | |         Err(_) => true,\n+LL | |     };\n+   | |_____^ help: try this: `Err::<i32, i32>(42).is_err()`\n+\n+error: aborting due to 35 previous errors\n "}, {"sha": "de3fe00d5fa689b81591706e9acd4693f1073053", "filename": "src/tools/clippy/tests/ui/redundant_pattern_matching_const_result.fixed", "status": "removed", "additions": 0, "deletions": 44, "changes": 44, "blob_url": "https://github.com/rust-lang/rust/blob/41507ed0d57eba71adc20a021a19b64322162f04/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching_const_result.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/41507ed0d57eba71adc20a021a19b64322162f04/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching_const_result.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching_const_result.fixed?ref=41507ed0d57eba71adc20a021a19b64322162f04", "patch": "@@ -1,44 +0,0 @@\n-// run-rustfix\n-\n-#![feature(const_result)]\n-#![warn(clippy::redundant_pattern_matching)]\n-#![allow(clippy::match_like_matches_macro, unused)]\n-\n-// Test that results are linted with the feature enabled.\n-\n-const fn issue_5697() {\n-    if Ok::<i32, i32>(42).is_ok() {}\n-\n-    if Err::<i32, i32>(42).is_err() {}\n-\n-    while Ok::<i32, i32>(10).is_ok() {}\n-\n-    while Ok::<i32, i32>(10).is_err() {}\n-\n-    Ok::<i32, i32>(42).is_ok();\n-\n-    Err::<i32, i32>(42).is_err();\n-\n-    // These should not be linted until `const_option` is implemented.\n-    // See https://github.com/rust-lang/rust/issues/67441\n-\n-    if let Some(_) = Some(42) {}\n-\n-    if let None = None::<()> {}\n-\n-    while let Some(_) = Some(42) {}\n-\n-    while let None = None::<()> {}\n-\n-    match Some(42) {\n-        Some(_) => true,\n-        None => false,\n-    };\n-\n-    match None::<()> {\n-        Some(_) => false,\n-        None => true,\n-    };\n-}\n-\n-fn main() {}"}, {"sha": "b77969d53d92df3def12d657c545d7c62e5ee39d", "filename": "src/tools/clippy/tests/ui/redundant_pattern_matching_const_result.rs", "status": "removed", "additions": 0, "deletions": 50, "changes": 50, "blob_url": "https://github.com/rust-lang/rust/blob/41507ed0d57eba71adc20a021a19b64322162f04/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching_const_result.rs", "raw_url": "https://github.com/rust-lang/rust/raw/41507ed0d57eba71adc20a021a19b64322162f04/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching_const_result.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching_const_result.rs?ref=41507ed0d57eba71adc20a021a19b64322162f04", "patch": "@@ -1,50 +0,0 @@\n-// run-rustfix\n-\n-#![feature(const_result)]\n-#![warn(clippy::redundant_pattern_matching)]\n-#![allow(clippy::match_like_matches_macro, unused)]\n-\n-// Test that results are linted with the feature enabled.\n-\n-const fn issue_5697() {\n-    if let Ok(_) = Ok::<i32, i32>(42) {}\n-\n-    if let Err(_) = Err::<i32, i32>(42) {}\n-\n-    while let Ok(_) = Ok::<i32, i32>(10) {}\n-\n-    while let Err(_) = Ok::<i32, i32>(10) {}\n-\n-    match Ok::<i32, i32>(42) {\n-        Ok(_) => true,\n-        Err(_) => false,\n-    };\n-\n-    match Err::<i32, i32>(42) {\n-        Ok(_) => false,\n-        Err(_) => true,\n-    };\n-\n-    // These should not be linted until `const_option` is implemented.\n-    // See https://github.com/rust-lang/rust/issues/67441\n-\n-    if let Some(_) = Some(42) {}\n-\n-    if let None = None::<()> {}\n-\n-    while let Some(_) = Some(42) {}\n-\n-    while let None = None::<()> {}\n-\n-    match Some(42) {\n-        Some(_) => true,\n-        None => false,\n-    };\n-\n-    match None::<()> {\n-        Some(_) => false,\n-        None => true,\n-    };\n-}\n-\n-fn main() {}"}, {"sha": "8ecd72158d33c8c86271578c4e60730199b1b9d0", "filename": "src/tools/clippy/tests/ui/redundant_pattern_matching_const_result.stderr", "status": "removed", "additions": 0, "deletions": 46, "changes": 46, "blob_url": "https://github.com/rust-lang/rust/blob/41507ed0d57eba71adc20a021a19b64322162f04/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching_const_result.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/41507ed0d57eba71adc20a021a19b64322162f04/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching_const_result.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Ftests%2Fui%2Fredundant_pattern_matching_const_result.stderr?ref=41507ed0d57eba71adc20a021a19b64322162f04", "patch": "@@ -1,46 +0,0 @@\n-error: redundant pattern matching, consider using `is_ok()`\n-  --> $DIR/redundant_pattern_matching_const_result.rs:10:12\n-   |\n-LL |     if let Ok(_) = Ok::<i32, i32>(42) {}\n-   |     -------^^^^^--------------------- help: try this: `if Ok::<i32, i32>(42).is_ok()`\n-   |\n-   = note: `-D clippy::redundant-pattern-matching` implied by `-D warnings`\n-\n-error: redundant pattern matching, consider using `is_err()`\n-  --> $DIR/redundant_pattern_matching_const_result.rs:12:12\n-   |\n-LL |     if let Err(_) = Err::<i32, i32>(42) {}\n-   |     -------^^^^^^---------------------- help: try this: `if Err::<i32, i32>(42).is_err()`\n-\n-error: redundant pattern matching, consider using `is_ok()`\n-  --> $DIR/redundant_pattern_matching_const_result.rs:14:15\n-   |\n-LL |     while let Ok(_) = Ok::<i32, i32>(10) {}\n-   |     ----------^^^^^--------------------- help: try this: `while Ok::<i32, i32>(10).is_ok()`\n-\n-error: redundant pattern matching, consider using `is_err()`\n-  --> $DIR/redundant_pattern_matching_const_result.rs:16:15\n-   |\n-LL |     while let Err(_) = Ok::<i32, i32>(10) {}\n-   |     ----------^^^^^^--------------------- help: try this: `while Ok::<i32, i32>(10).is_err()`\n-\n-error: redundant pattern matching, consider using `is_ok()`\n-  --> $DIR/redundant_pattern_matching_const_result.rs:18:5\n-   |\n-LL | /     match Ok::<i32, i32>(42) {\n-LL | |         Ok(_) => true,\n-LL | |         Err(_) => false,\n-LL | |     };\n-   | |_____^ help: try this: `Ok::<i32, i32>(42).is_ok()`\n-\n-error: redundant pattern matching, consider using `is_err()`\n-  --> $DIR/redundant_pattern_matching_const_result.rs:23:5\n-   |\n-LL | /     match Err::<i32, i32>(42) {\n-LL | |         Ok(_) => false,\n-LL | |         Err(_) => true,\n-LL | |     };\n-   | |_____^ help: try this: `Err::<i32, i32>(42).is_err()`\n-\n-error: aborting due to 6 previous errors\n-"}]}