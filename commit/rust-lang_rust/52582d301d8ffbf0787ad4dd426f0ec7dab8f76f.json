{"sha": "52582d301d8ffbf0787ad4dd426f0ec7dab8f76f", "node_id": "C_kwDOAAsO6NoAKDUyNTgyZDMwMWQ4ZmZiZjA3ODdhZDRkZDQyNmYwZWM3ZGFiOGY3NmY", "commit": {"author": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2022-08-26T21:49:06Z"}, "committer": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2022-08-26T22:00:20Z"}, "message": "rustdoc: remove empty extern_crates and type=\"text/javascript\" on script\n\nLike #101023, this removes an attribute with a default value.", "tree": {"sha": "25b89e1f2da294fa74fa84ddbf5e7857ccfd1de7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/25b89e1f2da294fa74fa84ddbf5e7857ccfd1de7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/52582d301d8ffbf0787ad4dd426f0ec7dab8f76f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/52582d301d8ffbf0787ad4dd426f0ec7dab8f76f", "html_url": "https://github.com/rust-lang/rust/commit/52582d301d8ffbf0787ad4dd426f0ec7dab8f76f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/52582d301d8ffbf0787ad4dd426f0ec7dab8f76f/comments", "author": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "committer": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "42fa8ac7236f4f78a82aeea543bdd445a59f02e0", "url": "https://api.github.com/repos/rust-lang/rust/commits/42fa8ac7236f4f78a82aeea543bdd445a59f02e0", "html_url": "https://github.com/rust-lang/rust/commit/42fa8ac7236f4f78a82aeea543bdd445a59f02e0"}], "stats": {"total": 12, "additions": 7, "deletions": 5}, "files": [{"sha": "f258af114ade713b591eb36a348614c38648bb99", "filename": "src/librustdoc/html/render/print_item.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/52582d301d8ffbf0787ad4dd426f0ec7dab8f76f/src%2Flibrustdoc%2Fhtml%2Frender%2Fprint_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/52582d301d8ffbf0787ad4dd426f0ec7dab8f76f/src%2Flibrustdoc%2Fhtml%2Frender%2Fprint_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fprint_item.rs?ref=52582d301d8ffbf0787ad4dd426f0ec7dab8f76f", "patch": "@@ -987,7 +987,7 @@ fn item_trait(w: &mut Buffer, cx: &mut Context<'_>, it: &clean::Item, t: &clean:\n     // So C's HTML will have something like this:\n     //\n     // ```html\n-    // <script type=\"text/javascript\" src=\"/implementors/A/trait.Foo.js\"\n+    // <script src=\"/implementors/A/trait.Foo.js\"\n     //     data-ignore-extern-crates=\"A,B\" async></script>\n     // ```\n     //\n@@ -1013,9 +1013,11 @@ fn item_trait(w: &mut Buffer, cx: &mut Context<'_>, it: &clean::Item, t: &clean:\n         .map(|cnum| cx.shared.tcx.crate_name(cnum).to_string())\n         .collect::<Vec<_>>()\n         .join(\",\");\n+    let (extern_before, extern_after) =\n+        if extern_crates.is_empty() { (\"\", \"\") } else { (\" data-ignore-extern-crates=\\\"\", \"\\\"\") };\n     write!(\n         w,\n-        \"<script type=\\\"text/javascript\\\" src=\\\"{src}\\\" data-ignore-extern-crates=\\\"{extern_crates}\\\" async></script>\",\n+        \"<script src=\\\"{src}\\\"{extern_before}{extern_crates}{extern_after} async></script>\",\n         src = js_src_path.finish(),\n     );\n }"}, {"sha": "7f61c95e794b0696fde560ee74a6d42dd8a3ac95", "filename": "src/librustdoc/html/static/js/main.js", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/52582d301d8ffbf0787ad4dd426f0ec7dab8f76f/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/52582d301d8ffbf0787ad4dd426f0ec7dab8f76f/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js?ref=52582d301d8ffbf0787ad4dd426f0ec7dab8f76f", "patch": "@@ -528,9 +528,9 @@ function loadCss(cssFileName) {\n         // We don't want to include impls from this JS file, when the HTML already has them.\n         // The current crate should always be ignored. Other crates that should also be\n         // ignored are included in the attribute `data-ignore-extern-crates`.\n-        const ignoreExternCrates = document\n-            .querySelector(\"script[data-ignore-extern-crates]\")\n-            .getAttribute(\"data-ignore-extern-crates\");\n+        const script = document\n+            .querySelector(\"script[data-ignore-extern-crates]\");\n+        const ignoreExternCrates = script ? script.getAttribute(\"data-ignore-extern-crates\") : \"\";\n         for (const lib of libs) {\n             if (lib === window.currentCrate || ignoreExternCrates.indexOf(lib) !== -1) {\n                 continue;"}]}