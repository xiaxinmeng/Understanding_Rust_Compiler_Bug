{"sha": "597c6514d142886f807cfcfd04291b464bb43787", "node_id": "C_kwDOAAsO6NoAKDU5N2M2NTE0ZDE0Mjg4NmY4MDdjZmNmZDA0MjkxYjQ2NGJiNDM3ODc", "commit": {"author": {"name": "klensy", "email": "klensy@users.noreply.github.com", "date": "2023-04-28T10:41:48Z"}, "committer": {"name": "klensy", "email": "klensy@users.noreply.github.com", "date": "2023-04-30T10:19:25Z"}, "message": "Arc -> Lrc", "tree": {"sha": "1d27cb703756d2d37cd3ef0c91baa73799cf9a62", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1d27cb703756d2d37cd3ef0c91baa73799cf9a62"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/597c6514d142886f807cfcfd04291b464bb43787", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/597c6514d142886f807cfcfd04291b464bb43787", "html_url": "https://github.com/rust-lang/rust/commit/597c6514d142886f807cfcfd04291b464bb43787", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/597c6514d142886f807cfcfd04291b464bb43787/comments", "author": {"login": "klensy", "id": 1782831, "node_id": "MDQ6VXNlcjE3ODI4MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1782831?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klensy", "html_url": "https://github.com/klensy", "followers_url": "https://api.github.com/users/klensy/followers", "following_url": "https://api.github.com/users/klensy/following{/other_user}", "gists_url": "https://api.github.com/users/klensy/gists{/gist_id}", "starred_url": "https://api.github.com/users/klensy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klensy/subscriptions", "organizations_url": "https://api.github.com/users/klensy/orgs", "repos_url": "https://api.github.com/users/klensy/repos", "events_url": "https://api.github.com/users/klensy/events{/privacy}", "received_events_url": "https://api.github.com/users/klensy/received_events", "type": "User", "site_admin": false}, "committer": {"login": "klensy", "id": 1782831, "node_id": "MDQ6VXNlcjE3ODI4MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1782831?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klensy", "html_url": "https://github.com/klensy", "followers_url": "https://api.github.com/users/klensy/followers", "following_url": "https://api.github.com/users/klensy/following{/other_user}", "gists_url": "https://api.github.com/users/klensy/gists{/gist_id}", "starred_url": "https://api.github.com/users/klensy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klensy/subscriptions", "organizations_url": "https://api.github.com/users/klensy/orgs", "repos_url": "https://api.github.com/users/klensy/repos", "events_url": "https://api.github.com/users/klensy/events{/privacy}", "received_events_url": "https://api.github.com/users/klensy/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a621ec35aef00181be89c65a36bc44d061b99206", "url": "https://api.github.com/repos/rust-lang/rust/commits/a621ec35aef00181be89c65a36bc44d061b99206", "html_url": "https://github.com/rust-lang/rust/commit/a621ec35aef00181be89c65a36bc44d061b99206"}], "stats": {"total": 10, "additions": 4, "deletions": 6}, "files": [{"sha": "72371b9950bfb9337163dd0681171c9bacfa97a2", "filename": "compiler/rustc_passes/src/debugger_visualizer.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/597c6514d142886f807cfcfd04291b464bb43787/compiler%2Frustc_passes%2Fsrc%2Fdebugger_visualizer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/597c6514d142886f807cfcfd04291b464bb43787/compiler%2Frustc_passes%2Fsrc%2Fdebugger_visualizer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Fdebugger_visualizer.rs?ref=597c6514d142886f807cfcfd04291b464bb43787", "patch": "@@ -2,15 +2,14 @@\n \n use hir::CRATE_HIR_ID;\n use rustc_data_structures::fx::FxHashSet;\n+use rustc_data_structures::sync::Lrc;\n use rustc_expand::base::resolve_path;\n use rustc_hir as hir;\n use rustc_hir::HirId;\n use rustc_middle::ty::TyCtxt;\n use rustc_middle::{query::LocalCrate, ty::query::Providers};\n use rustc_span::{sym, DebuggerVisualizerFile, DebuggerVisualizerType};\n \n-use std::sync::Arc;\n-\n use crate::errors::DebugVisualizerUnreadable;\n \n fn check_for_debugger_visualizer(\n@@ -52,7 +51,7 @@ fn check_for_debugger_visualizer(\n             match std::fs::read(&file) {\n                 Ok(contents) => {\n                     debugger_visualizers\n-                        .insert(DebuggerVisualizerFile::new(Arc::from(contents), visualizer_type));\n+                        .insert(DebuggerVisualizerFile::new(Lrc::from(contents), visualizer_type));\n                 }\n                 Err(error) => {\n                     tcx.sess.emit_err(DebugVisualizerUnreadable {"}, {"sha": "341cc61fd1c10b557b517a0edb3ffd930534e528", "filename": "compiler/rustc_span/src/lib.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/597c6514d142886f807cfcfd04291b464bb43787/compiler%2Frustc_span%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/597c6514d142886f807cfcfd04291b464bb43787/compiler%2Frustc_span%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_span%2Fsrc%2Flib.rs?ref=597c6514d142886f807cfcfd04291b464bb43787", "patch": "@@ -69,7 +69,6 @@ use std::hash::Hash;\n use std::ops::{Add, Range, Sub};\n use std::path::{Path, PathBuf};\n use std::str::FromStr;\n-use std::sync::Arc;\n \n use md5::Digest;\n use md5::Md5;\n@@ -1269,13 +1268,13 @@ pub enum DebuggerVisualizerType {\n #[derive(Clone, Debug, Hash, PartialEq, Eq, PartialOrd, Ord, Encodable, Decodable)]\n pub struct DebuggerVisualizerFile {\n     /// The complete debugger visualizer source.\n-    pub src: Arc<[u8]>,\n+    pub src: Lrc<[u8]>,\n     /// Indicates which visualizer type this targets.\n     pub visualizer_type: DebuggerVisualizerType,\n }\n \n impl DebuggerVisualizerFile {\n-    pub fn new(src: Arc<[u8]>, visualizer_type: DebuggerVisualizerType) -> Self {\n+    pub fn new(src: Lrc<[u8]>, visualizer_type: DebuggerVisualizerType) -> Self {\n         DebuggerVisualizerFile { src, visualizer_type }\n     }\n }"}]}