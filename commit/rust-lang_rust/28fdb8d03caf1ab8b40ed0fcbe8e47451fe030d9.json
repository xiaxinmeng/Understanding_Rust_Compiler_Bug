{"sha": "28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI4ZmRiOGQwM2NhZjFhYjhiNDBlZDBmY2JlOGU0NzQ1MWZlMDMwZDk=", "commit": {"author": {"name": "bors[bot]", "email": "bors[bot]@users.noreply.github.com", "date": "2019-01-30T20:51:47Z"}, "committer": {"name": "bors[bot]", "email": "bors[bot]@users.noreply.github.com", "date": "2019-01-30T20:51:47Z"}, "message": "Merge #701\n\n701: Minor type inference tweaks r=flodiebold a=marcusklaas\n\nPass down expectation for reference expressions and type the guard in match expressions.\r\n\r\nI wasn't able to add a test for the former addition because the type variable previously introduced would always resolve to the right type in the things I tried!\n\nCo-authored-by: Marcus Klaas de Vries <mail@marcusklaas.nl>", "tree": {"sha": "a795362bb8cd25edb87e8da3f9786d68e029c22b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a795362bb8cd25edb87e8da3f9786d68e029c22b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9", "html_url": "https://github.com/rust-lang/rust/commit/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "parents": [{"sha": "db17e06c2eec892ab807fd191bc11b15d8da42e2", "url": "https://api.github.com/repos/rust-lang/rust/commits/db17e06c2eec892ab807fd191bc11b15d8da42e2", "html_url": "https://github.com/rust-lang/rust/commit/db17e06c2eec892ab807fd191bc11b15d8da42e2"}, {"sha": "13cb4a1b370038dee51ae739a42d6b98acaef385", "url": "https://api.github.com/repos/rust-lang/rust/commits/13cb4a1b370038dee51ae739a42d6b98acaef385", "html_url": "https://github.com/rust-lang/rust/commit/13cb4a1b370038dee51ae739a42d6b98acaef385"}], "stats": {"total": 226, "additions": 163, "deletions": 63}, "files": [{"sha": "37aa24677c5de0c46d96ceb243a54a2dde96619c", "filename": "crates/ra_hir/src/expr.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_hir%2Fsrc%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_hir%2Fsrc%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fexpr.rs?ref=28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9", "patch": "@@ -219,7 +219,7 @@ pub use ra_syntax::ast::BinOp as BinaryOp;\n #[derive(Debug, Clone, Eq, PartialEq)]\n pub struct MatchArm {\n     pub pats: Vec<PatId>,\n-    // guard: Option<ExprId>, // TODO\n+    pub guard: Option<ExprId>,\n     pub expr: ExprId,\n }\n \n@@ -515,10 +515,12 @@ impl ExprCollector {\n                         MatchArm {\n                             pats: vec![pat],\n                             expr: then_branch,\n+                            guard: None,\n                         },\n                         MatchArm {\n                             pats: vec![placeholder_pat],\n                             expr: else_branch,\n+                            guard: None,\n                         },\n                     ];\n                     self.alloc_expr(\n@@ -617,6 +619,10 @@ impl ExprCollector {\n                         .map(|arm| MatchArm {\n                             pats: arm.pats().map(|p| self.collect_pat(p)).collect(),\n                             expr: self.collect_expr_opt(arm.expr()),\n+                            guard: arm\n+                                .guard()\n+                                .and_then(|guard| guard.expr())\n+                                .map(|e| self.collect_expr(e)),\n                         })\n                         .collect()\n                 } else {"}, {"sha": "60c231e825ddc2e92889fd8be55a34f13f7e93fc", "filename": "crates/ra_hir/src/ty.rs", "status": "modified", "additions": 13, "deletions": 3, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_hir%2Fsrc%2Fty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_hir%2Fsrc%2Fty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty.rs?ref=28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9", "patch": "@@ -1488,7 +1488,9 @@ impl<'a, D: HirDatabase> InferenceContext<'a, D> {\n                     for &pat in &arm.pats {\n                         let _pat_ty = self.infer_pat(pat, &input_ty);\n                     }\n-                    // TODO type the guard\n+                    if let Some(guard_expr) = arm.guard {\n+                        self.infer_expr(guard_expr, &Expectation::has_type(Ty::Bool));\n+                    }\n                     self.infer_expr(arm.expr, &expected);\n                 }\n \n@@ -1561,9 +1563,17 @@ impl<'a, D: HirDatabase> InferenceContext<'a, D> {\n                 cast_ty\n             }\n             Expr::Ref { expr, mutability } => {\n-                // TODO pass the expectation down\n-                let inner_ty = self.infer_expr(*expr, &Expectation::none());\n+                let expectation = if let Ty::Ref(ref subty, expected_mutability) = expected.ty {\n+                    if expected_mutability == Mutability::Mut && *mutability == Mutability::Shared {\n+                        // TODO: throw type error - expected mut reference but found shared ref,\n+                        // which cannot be coerced\n+                    }\n+                    Expectation::has_type((**subty).clone())\n+                } else {\n+                    Expectation::none()\n+                };\n                 // TODO reference coercions etc.\n+                let inner_ty = self.infer_expr(*expr, &expectation);\n                 Ty::Ref(Arc::new(inner_ty), *mutability)\n             }\n             Expr::UnaryOp { expr, op } => {"}, {"sha": "48c83cbb277e2c62e81433fee75a5ff770fcb662", "filename": "crates/ra_hir/src/ty/snapshots/tests__infer_adt_pattern.snap", "status": "modified", "additions": 13, "deletions": 10, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_hir%2Fsrc%2Fty%2Fsnapshots%2Ftests__infer_adt_pattern.snap", "raw_url": "https://github.com/rust-lang/rust/raw/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_hir%2Fsrc%2Fty%2Fsnapshots%2Ftests__infer_adt_pattern.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty%2Fsnapshots%2Ftests__infer_adt_pattern.snap?ref=28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9", "patch": "@@ -1,10 +1,10 @@\n ---\n-created: \"2019-01-22T14:44:59.880187500+00:00\"\n-creator: insta@0.4.0\n+created: \"2019-01-28T21:58:55.559331849+00:00\"\n+creator: insta@0.5.2\n expression: \"&result\"\n-source: \"crates\\\\ra_hir\\\\src\\\\ty\\\\tests.rs\"\n+source: crates/ra_hir/src/ty/tests.rs\n ---\n-[68; 262) '{     ...  d; }': ()\n+[68; 289) '{     ...  d; }': ()\n [78; 79) 'e': E\n [82; 95) 'E::A { x: 3 }': E\n [92; 93) '3': usize\n@@ -15,15 +15,18 @@ source: \"crates\\\\ra_hir\\\\src\\\\ty\\\\tests.rs\"\n [129; 148) 'E::A {..._var }': E\n [139; 146) 'new_var': usize\n [151; 152) 'e': E\n-[159; 218) 'match ...     }': usize\n+[159; 245) 'match ...     }': usize\n [165; 166) 'e': E\n [177; 187) 'E::A { x }': E\n [184; 185) 'x': usize\n [191; 192) 'x': usize\n [202; 206) 'E::B': E\n-[210; 211) '1': usize\n-[229; 248) 'ref d ...{ .. }': &E\n-[237; 248) 'E::A { .. }': E\n-[251; 252) 'e': E\n-[258; 259) 'd': &E\n+[210; 213) 'foo': bool\n+[217; 218) '1': usize\n+[228; 232) 'E::B': E\n+[236; 238) '10': usize\n+[256; 275) 'ref d ...{ .. }': &E\n+[264; 275) 'E::A { .. }': E\n+[278; 279) 'e': E\n+[285; 286) 'd': &E\n "}, {"sha": "042248c35460ed61092f4c0c87e8c4ee23033ed1", "filename": "crates/ra_hir/src/ty/snapshots/tests__infer_array.snap", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_hir%2Fsrc%2Fty%2Fsnapshots%2Ftests__infer_array.snap", "raw_url": "https://github.com/rust-lang/rust/raw/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_hir%2Fsrc%2Fty%2Fsnapshots%2Ftests__infer_array.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty%2Fsnapshots%2Ftests__infer_array.snap?ref=28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9", "patch": "@@ -1,12 +1,12 @@\n ---\n-created: \"2019-01-22T14:44:59.880187500+00:00\"\n-creator: insta@0.4.0\n+created: \"2019-01-30T20:08:05.185312835+00:00\"\n+creator: insta@0.5.2\n expression: \"&result\"\n-source: \"crates\\\\ra_hir\\\\src\\\\ty\\\\tests.rs\"\n+source: crates/ra_hir/src/ty/tests.rs\n ---\n [9; 10) 'x': &str\n [18; 19) 'y': isize\n-[28; 293) '{     ... []; }': ()\n+[28; 324) '{     ... 3]; }': ()\n [38; 39) 'a': [&str]\n [42; 45) '[x]': [&str]\n [43; 44) 'x': &str\n@@ -56,4 +56,10 @@ source: \"crates\\\\ra_hir\\\\src\\\\ty\\\\tests.rs\"\n [260; 263) '\"b\"': &str\n [275; 276) 'x': [u8]\n [288; 290) '[]': [u8]\n+[300; 301) 'z': &[u8]\n+[311; 321) '&[1, 2, 3]': &[u8]\n+[312; 321) '[1, 2, 3]': [u8]\n+[313; 314) '1': u8\n+[316; 317) '2': u8\n+[319; 320) '3': u8\n "}, {"sha": "cb8d6351d9767c4060dad9cbd76eb1b286b15da2", "filename": "crates/ra_hir/src/ty/tests.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_hir%2Fsrc%2Fty%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_hir%2Fsrc%2Fty%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty%2Ftests.rs?ref=28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9", "patch": "@@ -371,6 +371,7 @@ fn test(x: &str, y: isize) {\n \n     let b = [a, [\"b\"]];\n     let x: [u8; 0] = [];\n+    let z: &[u8] = &[1, 2, 3];\n }\n \"#,\n     );\n@@ -426,7 +427,8 @@ fn test() {\n \n     match e {\n         E::A { x } => x,\n-        E::B => 1,\n+        E::B if foo => 1,\n+        E::B => 10,\n     };\n \n     let ref d @ E::A { .. } = e;"}, {"sha": "4f5a96014e40ba7f71afaa689df4d19ef1cf6cad", "filename": "crates/ra_syntax/src/ast/generated.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_syntax%2Fsrc%2Fast%2Fgenerated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_syntax%2Fsrc%2Fast%2Fgenerated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Fsrc%2Fast%2Fgenerated.rs?ref=28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9", "patch": "@@ -1981,7 +1981,11 @@ impl ToOwned for MatchGuard {\n }\n \n \n-impl MatchGuard {}\n+impl MatchGuard {\n+    pub fn expr(&self) -> Option<&Expr> {\n+        super::child_opt(self)\n+    }\n+}\n \n // MethodCallExpr\n #[derive(Debug, PartialEq, Eq, Hash)]"}, {"sha": "e4cad4eb3460113ed0c5a2e591605741c88906bc", "filename": "crates/ra_syntax/src/grammar.ron", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_syntax%2Fsrc%2Fgrammar.ron", "raw_url": "https://github.com/rust-lang/rust/raw/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_syntax%2Fsrc%2Fgrammar.ron", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Fsrc%2Fgrammar.ron?ref=28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9", "patch": "@@ -418,7 +418,7 @@ Grammar(\n             ],\n             collections: [ [ \"pats\", \"Pat\" ] ]\n         ),\n-        \"MatchGuard\": (),\n+        \"MatchGuard\": (options: [\"Expr\"]),\n         \"StructLit\": (options: [\"Path\", \"NamedFieldList\", [\"spread\", \"Expr\"]]),\n         \"NamedFieldList\": (collections: [ [\"fields\", \"NamedField\"] ]),\n         \"NamedField\": (options: [\"NameRef\", \"Expr\"]),"}, {"sha": "600774afd7602c5f2939f5d92ec0d16b74b8cf6b", "filename": "crates/ra_syntax/src/grammar/expressions/atom.rs", "status": "modified", "additions": 16, "deletions": 2, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_syntax%2Fsrc%2Fgrammar%2Fexpressions%2Fatom.rs", "raw_url": "https://github.com/rust-lang/rust/raw/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_syntax%2Fsrc%2Fgrammar%2Fexpressions%2Fatom.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Fsrc%2Fgrammar%2Fexpressions%2Fatom.rs?ref=28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9", "patch": "@@ -360,15 +360,29 @@ fn match_arm(p: &mut Parser) -> BlockLike {\n     while p.eat(PIPE) {\n         patterns::pattern(p);\n     }\n-    if p.eat(IF_KW) {\n-        expr(p);\n+    if p.at(IF_KW) {\n+        match_guard(p);\n     }\n     p.expect(FAT_ARROW);\n     let ret = expr_stmt(p);\n     m.complete(p, MATCH_ARM);\n     ret\n }\n \n+// test match_guard\n+// fn foo() {\n+//     match () {\n+//         _ if foo => (),\n+//     }\n+// }\n+fn match_guard(p: &mut Parser) -> CompletedMarker {\n+    assert!(p.at(IF_KW));\n+    let m = p.start();\n+    p.bump();\n+    expr(p);\n+    m.complete(p, MATCH_GUARD)\n+}\n+\n // test block_expr\n // fn foo() {\n //     {};"}, {"sha": "b44e6187910d8c0d6c93839c7f1771495ff46a85", "filename": "crates/ra_syntax/tests/data/parser/inline/ok/0066_match_arm.txt", "status": "modified", "additions": 43, "deletions": 40, "changes": 83, "blob_url": "https://github.com/rust-lang/rust/blob/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Finline%2Fok%2F0066_match_arm.txt", "raw_url": "https://github.com/rust-lang/rust/raw/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Finline%2Fok%2F0066_match_arm.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Finline%2Fok%2F0066_match_arm.txt?ref=28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9", "patch": "@@ -37,32 +37,33 @@ SOURCE_FILE@[0; 167)\n               PLACEHOLDER_PAT@[51; 52)\n                 UNDERSCORE@[51; 52)\n               WHITESPACE@[52; 53)\n-              IF_KW@[53; 55)\n-              WHITESPACE@[55; 56)\n-              BIN_EXPR@[56; 77)\n-                PATH_EXPR@[56; 60)\n-                  PATH@[56; 60)\n-                    PATH_SEGMENT@[56; 60)\n-                      NAME_REF@[56; 60)\n-                        IDENT@[56; 60) \"Test\"\n-                WHITESPACE@[60; 61)\n-                R_ANGLE@[61; 62)\n-                WHITESPACE@[62; 63)\n-                STRUCT_LIT@[63; 77)\n-                  PATH@[63; 67)\n-                    PATH_SEGMENT@[63; 67)\n-                      NAME_REF@[63; 67)\n-                        IDENT@[63; 67) \"Test\"\n-                  NAMED_FIELD_LIST@[67; 77)\n-                    L_CURLY@[67; 68)\n-                    NAMED_FIELD@[68; 76)\n-                      NAME_REF@[68; 73)\n-                        IDENT@[68; 73) \"field\"\n-                      COLON@[73; 74)\n-                      WHITESPACE@[74; 75)\n-                      LITERAL@[75; 76)\n-                        INT_NUMBER@[75; 76) \"0\"\n-                    R_CURLY@[76; 77)\n+              MATCH_GUARD@[53; 77)\n+                IF_KW@[53; 55)\n+                WHITESPACE@[55; 56)\n+                BIN_EXPR@[56; 77)\n+                  PATH_EXPR@[56; 60)\n+                    PATH@[56; 60)\n+                      PATH_SEGMENT@[56; 60)\n+                        NAME_REF@[56; 60)\n+                          IDENT@[56; 60) \"Test\"\n+                  WHITESPACE@[60; 61)\n+                  R_ANGLE@[61; 62)\n+                  WHITESPACE@[62; 63)\n+                  STRUCT_LIT@[63; 77)\n+                    PATH@[63; 67)\n+                      PATH_SEGMENT@[63; 67)\n+                        NAME_REF@[63; 67)\n+                          IDENT@[63; 67) \"Test\"\n+                    NAMED_FIELD_LIST@[67; 77)\n+                      L_CURLY@[67; 68)\n+                      NAMED_FIELD@[68; 76)\n+                        NAME_REF@[68; 73)\n+                          IDENT@[68; 73) \"field\"\n+                        COLON@[73; 74)\n+                        WHITESPACE@[74; 75)\n+                        LITERAL@[75; 76)\n+                          INT_NUMBER@[75; 76) \"0\"\n+                      R_CURLY@[76; 77)\n               WHITESPACE@[77; 78)\n               FAT_ARROW@[78; 80)\n               WHITESPACE@[80; 81)\n@@ -82,13 +83,14 @@ SOURCE_FILE@[0; 167)\n                 NAME@[97; 98)\n                   IDENT@[97; 98) \"Y\"\n               WHITESPACE@[98; 99)\n-              IF_KW@[99; 101)\n-              WHITESPACE@[101; 102)\n-              PATH_EXPR@[102; 103)\n-                PATH@[102; 103)\n-                  PATH_SEGMENT@[102; 103)\n-                    NAME_REF@[102; 103)\n-                      IDENT@[102; 103) \"Z\"\n+              MATCH_GUARD@[99; 103)\n+                IF_KW@[99; 101)\n+                WHITESPACE@[101; 102)\n+                PATH_EXPR@[102; 103)\n+                  PATH@[102; 103)\n+                    PATH_SEGMENT@[102; 103)\n+                      NAME_REF@[102; 103)\n+                        IDENT@[102; 103) \"Z\"\n               WHITESPACE@[103; 104)\n               FAT_ARROW@[104; 106)\n               WHITESPACE@[106; 107)\n@@ -110,13 +112,14 @@ SOURCE_FILE@[0; 167)\n                 NAME@[125; 126)\n                   IDENT@[125; 126) \"Y\"\n               WHITESPACE@[126; 127)\n-              IF_KW@[127; 129)\n-              WHITESPACE@[129; 130)\n-              PATH_EXPR@[130; 131)\n-                PATH@[130; 131)\n-                  PATH_SEGMENT@[130; 131)\n-                    NAME_REF@[130; 131)\n-                      IDENT@[130; 131) \"Z\"\n+              MATCH_GUARD@[127; 131)\n+                IF_KW@[127; 129)\n+                WHITESPACE@[129; 130)\n+                PATH_EXPR@[130; 131)\n+                  PATH@[130; 131)\n+                    PATH_SEGMENT@[130; 131)\n+                      NAME_REF@[130; 131)\n+                        IDENT@[130; 131) \"Z\"\n               WHITESPACE@[131; 132)\n               FAT_ARROW@[132; 134)\n               WHITESPACE@[134; 135)"}, {"sha": "f1bd72fc4cb5492212c14fca7891387822dc6ead", "filename": "crates/ra_syntax/tests/data/parser/inline/ok/0118_match_guard.rs", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Finline%2Fok%2F0118_match_guard.rs", "raw_url": "https://github.com/rust-lang/rust/raw/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Finline%2Fok%2F0118_match_guard.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Finline%2Fok%2F0118_match_guard.rs?ref=28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9", "patch": "@@ -0,0 +1,5 @@\n+fn foo() {\n+    match () {\n+        _ if foo => (),\n+    }\n+}"}, {"sha": "27553882d76b6650a9893515ba7448569ef957d5", "filename": "crates/ra_syntax/tests/data/parser/inline/ok/0118_match_guard.txt", "status": "added", "additions": 47, "deletions": 0, "changes": 47, "blob_url": "https://github.com/rust-lang/rust/blob/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Finline%2Fok%2F0118_match_guard.txt", "raw_url": "https://github.com/rust-lang/rust/raw/28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Finline%2Fok%2F0118_match_guard.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Finline%2Fok%2F0118_match_guard.txt?ref=28fdb8d03caf1ab8b40ed0fcbe8e47451fe030d9", "patch": "@@ -0,0 +1,47 @@\n+SOURCE_FILE@[0; 58)\n+  FN_DEF@[0; 57)\n+    FN_KW@[0; 2)\n+    WHITESPACE@[2; 3)\n+    NAME@[3; 6)\n+      IDENT@[3; 6) \"foo\"\n+    PARAM_LIST@[6; 8)\n+      L_PAREN@[6; 7)\n+      R_PAREN@[7; 8)\n+    WHITESPACE@[8; 9)\n+    BLOCK@[9; 57)\n+      L_CURLY@[9; 10)\n+      WHITESPACE@[10; 15)\n+      MATCH_EXPR@[15; 55)\n+        MATCH_KW@[15; 20)\n+        WHITESPACE@[20; 21)\n+        TUPLE_EXPR@[21; 23)\n+          L_PAREN@[21; 22)\n+          R_PAREN@[22; 23)\n+        WHITESPACE@[23; 24)\n+        MATCH_ARM_LIST@[24; 55)\n+          L_CURLY@[24; 25)\n+          WHITESPACE@[25; 34)\n+          MATCH_ARM@[34; 48)\n+            PLACEHOLDER_PAT@[34; 35)\n+              UNDERSCORE@[34; 35)\n+            WHITESPACE@[35; 36)\n+            MATCH_GUARD@[36; 42)\n+              IF_KW@[36; 38)\n+              WHITESPACE@[38; 39)\n+              PATH_EXPR@[39; 42)\n+                PATH@[39; 42)\n+                  PATH_SEGMENT@[39; 42)\n+                    NAME_REF@[39; 42)\n+                      IDENT@[39; 42) \"foo\"\n+            WHITESPACE@[42; 43)\n+            FAT_ARROW@[43; 45)\n+            WHITESPACE@[45; 46)\n+            TUPLE_EXPR@[46; 48)\n+              L_PAREN@[46; 47)\n+              R_PAREN@[47; 48)\n+          COMMA@[48; 49)\n+          WHITESPACE@[49; 54)\n+          R_CURLY@[54; 55)\n+      WHITESPACE@[55; 56)\n+      R_CURLY@[56; 57)\n+  WHITESPACE@[57; 58)"}]}