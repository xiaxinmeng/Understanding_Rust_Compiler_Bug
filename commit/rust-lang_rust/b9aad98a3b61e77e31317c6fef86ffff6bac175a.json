{"sha": "b9aad98a3b61e77e31317c6fef86ffff6bac175a", "node_id": "C_kwDOAAsO6NoAKGI5YWFkOThhM2I2MWU3N2UzMTMxN2M2ZmVmODZmZmZmNmJhYzE3NWE", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-07-23T00:57:07Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-07-23T00:57:07Z"}, "message": "Auto merge of #2420 - RalfJung:num_cpus, r=RalfJung\n\nmove num_cpus test from test-cargo-miri to crate test", "tree": {"sha": "306833ed205249c419c3bd24f5bcb3176c938530", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/306833ed205249c419c3bd24f5bcb3176c938530"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b9aad98a3b61e77e31317c6fef86ffff6bac175a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b9aad98a3b61e77e31317c6fef86ffff6bac175a", "html_url": "https://github.com/rust-lang/rust/commit/b9aad98a3b61e77e31317c6fef86ffff6bac175a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b9aad98a3b61e77e31317c6fef86ffff6bac175a/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "963f08b702caf7a06eed564312933ec50dd07f54", "url": "https://api.github.com/repos/rust-lang/rust/commits/963f08b702caf7a06eed564312933ec50dd07f54", "html_url": "https://github.com/rust-lang/rust/commit/963f08b702caf7a06eed564312933ec50dd07f54"}, {"sha": "34922be8013235f37de66cf79573ed2bd2678d85", "url": "https://api.github.com/repos/rust-lang/rust/commits/34922be8013235f37de66cf79573ed2bd2678d85", "html_url": "https://github.com/rust-lang/rust/commit/34922be8013235f37de66cf79573ed2bd2678d85"}], "stats": {"total": 44, "additions": 14, "deletions": 30}, "files": [{"sha": "38bfb2ac620770a76688d97667c53df5e0c4c4a7", "filename": "test-cargo-miri/Cargo.lock", "status": "modified", "additions": 1, "deletions": 26, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/b9aad98a3b61e77e31317c6fef86ffff6bac175a/test-cargo-miri%2FCargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/b9aad98a3b61e77e31317c6fef86ffff6bac175a/test-cargo-miri%2FCargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2FCargo.lock?ref=b9aad98a3b61e77e31317c6fef86ffff6bac175a", "patch": "@@ -48,15 +48,6 @@ dependencies = [\n name = \"exported_symbol_dep\"\n version = \"0.1.0\"\n \n-[[package]]\n-name = \"hermit-abi\"\n-version = \"0.1.19\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"62b467343b94ba476dcb2500d242dadbb39557df889310ac77c5d99100aaac33\"\n-dependencies = [\n- \"libc\",\n-]\n-\n [[package]]\n name = \"issue_1567\"\n version = \"0.1.0\"\n@@ -83,22 +74,6 @@ version = \"0.1.0\"\n name = \"issue_rust_86261\"\n version = \"0.1.0\"\n \n-[[package]]\n-name = \"libc\"\n-version = \"0.2.126\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"349d5a591cd28b49e1d1037471617a32ddcda5731b99419008085f72d5a53836\"\n-\n-[[package]]\n-name = \"num_cpus\"\n-version = \"1.13.1\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"19e64526ebdee182341572e50e9ad03965aa510cd94427a4549448f285e957a1\"\n-dependencies = [\n- \"hermit-abi\",\n- \"libc\",\n-]\n-\n [[package]]\n name = \"proc-macro2\"\n version = \"1.0.40\"\n@@ -132,7 +107,7 @@ dependencies = [\n name = \"subcrate\"\n version = \"0.1.0\"\n dependencies = [\n- \"num_cpus\",\n+ \"byteorder 1.4.3\",\n ]\n \n [[package]]"}, {"sha": "06b1ce1cba4b86b7dac922e044a163fa22cbdee5", "filename": "test-cargo-miri/subcrate/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b9aad98a3b61e77e31317c6fef86ffff6bac175a/test-cargo-miri%2Fsubcrate%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/b9aad98a3b61e77e31317c6fef86ffff6bac175a/test-cargo-miri%2Fsubcrate%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2Fsubcrate%2FCargo.toml?ref=b9aad98a3b61e77e31317c6fef86ffff6bac175a", "patch": "@@ -18,4 +18,4 @@ path = \"test.rs\"\n harness = false\n \n [dev-dependencies]\n-num_cpus = \"1.10.1\"\n+byteorder = \"1.0\""}, {"sha": "77e3c2878ca0e152725146cc7533fc6efaeb6510", "filename": "test-cargo-miri/subcrate/test.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/b9aad98a3b61e77e31317c6fef86ffff6bac175a/test-cargo-miri%2Fsubcrate%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b9aad98a3b61e77e31317c6fef86ffff6bac175a/test-cargo-miri%2Fsubcrate%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2Fsubcrate%2Ftest.rs?ref=b9aad98a3b61e77e31317c6fef86ffff6bac175a", "patch": "@@ -1,5 +1,7 @@\n use std::env;\n \n+use byteorder::{ByteOrder, LittleEndian};\n+\n fn main() {\n     println!(\"subcrate testing\");\n \n@@ -11,6 +13,6 @@ fn main() {\n     let crate_dir = crate_dir.to_string_lossy().replace(\"\\\\\", \"/\");\n     assert_eq!(env_dir, crate_dir);\n \n-    // Make sure we can call `num_cpus`.\n-    num_cpus::get();\n+    // Make sure we can call dev-dependencies.\n+    let _n = <LittleEndian as ByteOrder>::read_u32(&[1, 2, 3, 4]);\n }"}, {"sha": "d4b32e2c29a22ffa53e804e4269c314317ed732b", "filename": "test_dependencies/Cargo.lock", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b9aad98a3b61e77e31317c6fef86ffff6bac175a/test_dependencies%2FCargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/b9aad98a3b61e77e31317c6fef86ffff6bac175a/test_dependencies%2FCargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test_dependencies%2FCargo.lock?ref=b9aad98a3b61e77e31317c6fef86ffff6bac175a", "patch": "@@ -107,6 +107,7 @@ dependencies = [\n  \"getrandom 0.1.16\",\n  \"getrandom 0.2.7\",\n  \"libc\",\n+ \"num_cpus\",\n  \"page_size\",\n  \"rand\",\n  \"tokio\","}, {"sha": "58f731f91d0f4453a43ce3ba238ee9d94e302467", "filename": "test_dependencies/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b9aad98a3b61e77e31317c6fef86ffff6bac175a/test_dependencies%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/b9aad98a3b61e77e31317c6fef86ffff6bac175a/test_dependencies%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test_dependencies%2FCargo.toml?ref=b9aad98a3b61e77e31317c6fef86ffff6bac175a", "patch": "@@ -12,6 +12,7 @@ edition = \"2021\"\n tokio = { version = \"1.0\", features = [\"full\"] }\n libc = \"0.2\"\n page_size = \"0.4.1\"\n+num_cpus = \"1.10.1\"\n \n getrandom_1 = { package = \"getrandom\", version = \"0.1\" }\n getrandom_2 = { package = \"getrandom\", version = \"0.2\" }"}, {"sha": "84339feb11e177c204f30c6184890e2d2792de7a", "filename": "tests/pass/crates/num_cpus.rs", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/b9aad98a3b61e77e31317c6fef86ffff6bac175a/tests%2Fpass%2Fcrates%2Fnum_cpus.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b9aad98a3b61e77e31317c6fef86ffff6bac175a/tests%2Fpass%2Fcrates%2Fnum_cpus.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fpass%2Fcrates%2Fnum_cpus.rs?ref=b9aad98a3b61e77e31317c6fef86ffff6bac175a", "patch": "@@ -0,0 +1,5 @@\n+//@compile-flags: -Zmiri-disable-isolation\n+\n+fn main() {\n+    assert_eq!(num_cpus::get(), 1);\n+}"}, {"sha": "5eccf3b0ea115ca62c6891065a8ba9ca50a27978", "filename": "tests/pass/crates/random.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b9aad98a3b61e77e31317c6fef86ffff6bac175a/tests%2Fpass%2Fcrates%2Frandom.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b9aad98a3b61e77e31317c6fef86ffff6bac175a/tests%2Fpass%2Fcrates%2Frandom.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fpass%2Fcrates%2Frandom.rs?ref=b9aad98a3b61e77e31317c6fef86ffff6bac175a", "patch": "@@ -1,6 +1,6 @@\n-use rand::{rngs::SmallRng, Rng, SeedableRng};\n // mac-os `getrandom_1` does some pointer shenanigans\n //@compile-flags: -Zmiri-permissive-provenance\n+use rand::{rngs::SmallRng, Rng, SeedableRng};\n \n fn main() {\n     // Test `getrandom` directly (in multiple different versions)."}]}