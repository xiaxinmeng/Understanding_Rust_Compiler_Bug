{"sha": "00e9ad1df82efc61b91a1a546629e8d1e529203d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAwZTlhZDFkZjgyZWZjNjFiOTFhMWE1NDY2MjllOGQxZTUyOTIwM2Q=", "commit": {"author": {"name": "Steve Klabnik", "email": "steve@steveklabnik.com", "date": "2015-10-07T16:26:50Z"}, "committer": {"name": "Steve Klabnik", "email": "steve@steveklabnik.com", "date": "2015-11-05T08:34:14Z"}, "message": "Improve error message for char literals\n\nIf you try to put something that's bigger than a char into a char\nliteral, you get an error:\n\n    fn main() {\n        let c = '\u0bb6\u0bcd\u0bb0\u0bc0';\n    }\n\n    error: unterminated character constant:\n\nThis is a very compiler-centric message. Yes, it's technically\n'unterminated', but that's not what you, the user did wrong.\n\nInstead, this commit changes it to\n\n    error: character literal may only contain one codepoint\n\nAs this actually tells you what went wrong.\n\nFixes #28851", "tree": {"sha": "49b4139971cd7459d5a06f8e65c1d8db1664452f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/49b4139971cd7459d5a06f8e65c1d8db1664452f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/00e9ad1df82efc61b91a1a546629e8d1e529203d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/00e9ad1df82efc61b91a1a546629e8d1e529203d", "html_url": "https://github.com/rust-lang/rust/commit/00e9ad1df82efc61b91a1a546629e8d1e529203d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/00e9ad1df82efc61b91a1a546629e8d1e529203d/comments", "author": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "committer": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fffe0757086b8f381226cb5ddcb6c129a815b96d", "url": "https://api.github.com/repos/rust-lang/rust/commits/fffe0757086b8f381226cb5ddcb6c129a815b96d", "html_url": "https://github.com/rust-lang/rust/commit/fffe0757086b8f381226cb5ddcb6c129a815b96d"}], "stats": {"total": 15, "additions": 8, "deletions": 7}, "files": [{"sha": "e1d8a4d8c5423377ebd3223af2a80b617977782b", "filename": "src/libsyntax/parse/lexer/mod.rs", "status": "modified", "additions": 6, "deletions": 5, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/00e9ad1df82efc61b91a1a546629e8d1e529203d/src%2Flibsyntax%2Fparse%2Flexer%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/00e9ad1df82efc61b91a1a546629e8d1e529203d/src%2Flibsyntax%2Fparse%2Flexer%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Flexer%2Fmod.rs?ref=00e9ad1df82efc61b91a1a546629e8d1e529203d", "patch": "@@ -1081,11 +1081,12 @@ impl<'a> StringReader<'a> {\n             if !self.curr_is('\\'') {\n                 let last_bpos = self.last_pos;\n                 panic!(self.fatal_span_verbose(\n-                                   // Byte offsetting here is okay because the\n-                                   // character before position `start` is an\n-                                   // ascii single quote.\n-                                   start - BytePos(1), last_bpos,\n-                                   \"unterminated character constant\".to_string()));\n+                        // Byte offsetting here is okay because the\n+                        // character before position `start` is an\n+                        // ascii single quote.\n+                        start - BytePos(1), last_bpos,\n+\n+                        String::from(\"character literal may only contain one codepoint\")));\n             }\n             let id = if valid { self.name_from(start) } else { token::intern(\"0\") };\n             self.bump(); // advance curr past token"}, {"sha": "6335632455fbd67aa9fe27a33aea26a0be8e7587", "filename": "src/test/parse-fail/lex-bad-char-literals.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/00e9ad1df82efc61b91a1a546629e8d1e529203d/src%2Ftest%2Fparse-fail%2Flex-bad-char-literals.rs", "raw_url": "https://github.com/rust-lang/rust/raw/00e9ad1df82efc61b91a1a546629e8d1e529203d/src%2Ftest%2Fparse-fail%2Flex-bad-char-literals.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fparse-fail%2Flex-bad-char-literals.rs?ref=00e9ad1df82efc61b91a1a546629e8d1e529203d", "patch": "@@ -25,8 +25,8 @@ static s: &'static str =\n     \"\\\u25cf\" //~ ERROR: unknown character escape\n ;\n \n-// THIS MUST BE LAST, since unterminated character constants kill the lexer\n+// THIS MUST BE LAST, since it kills the lexer\n \n static c: char =\n-    '\u25cf  //~ ERROR: unterminated character constant\n+    '\u25cf  //~ ERROR: character literal may only contain one codepoint\n ;"}]}