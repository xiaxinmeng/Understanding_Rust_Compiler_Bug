{"sha": "d74b8e0505b83c72761987c48f3aa3fbb2656573", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ3NGI4ZTA1MDViODNjNzI3NjE5ODdjNDhmM2FhM2ZiYjI2NTY1NzM=", "commit": {"author": {"name": "Scott McMurray", "email": "scottmcm@users.noreply.github.com", "date": "2020-10-03T23:51:43Z"}, "committer": {"name": "Scott McMurray", "email": "scottmcm@users.noreply.github.com", "date": "2020-10-03T23:51:43Z"}, "message": "Replace some once(x).chain(once(y)) with [x, y] IntoIter\n\nNow that we have by-value array iterators...", "tree": {"sha": "9457f992beebc7c51080ebf1e0a63a38af01e637", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9457f992beebc7c51080ebf1e0a63a38af01e637"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d74b8e0505b83c72761987c48f3aa3fbb2656573", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d74b8e0505b83c72761987c48f3aa3fbb2656573", "html_url": "https://github.com/rust-lang/rust/commit/d74b8e0505b83c72761987c48f3aa3fbb2656573", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d74b8e0505b83c72761987c48f3aa3fbb2656573/comments", "author": {"login": "scottmcm", "id": 18526288, "node_id": "MDQ6VXNlcjE4NTI2Mjg4", "avatar_url": "https://avatars.githubusercontent.com/u/18526288?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scottmcm", "html_url": "https://github.com/scottmcm", "followers_url": "https://api.github.com/users/scottmcm/followers", "following_url": "https://api.github.com/users/scottmcm/following{/other_user}", "gists_url": "https://api.github.com/users/scottmcm/gists{/gist_id}", "starred_url": "https://api.github.com/users/scottmcm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scottmcm/subscriptions", "organizations_url": "https://api.github.com/users/scottmcm/orgs", "repos_url": "https://api.github.com/users/scottmcm/repos", "events_url": "https://api.github.com/users/scottmcm/events{/privacy}", "received_events_url": "https://api.github.com/users/scottmcm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "scottmcm", "id": 18526288, "node_id": "MDQ6VXNlcjE4NTI2Mjg4", "avatar_url": "https://avatars.githubusercontent.com/u/18526288?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scottmcm", "html_url": "https://github.com/scottmcm", "followers_url": "https://api.github.com/users/scottmcm/followers", "following_url": "https://api.github.com/users/scottmcm/following{/other_user}", "gists_url": "https://api.github.com/users/scottmcm/gists{/gist_id}", "starred_url": "https://api.github.com/users/scottmcm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scottmcm/subscriptions", "organizations_url": "https://api.github.com/users/scottmcm/orgs", "repos_url": "https://api.github.com/users/scottmcm/repos", "events_url": "https://api.github.com/users/scottmcm/events{/privacy}", "received_events_url": "https://api.github.com/users/scottmcm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "738d4a7a368b4da8bfa31915f06bb1ddce9e9980", "url": "https://api.github.com/repos/rust-lang/rust/commits/738d4a7a368b4da8bfa31915f06bb1ddce9e9980", "html_url": "https://github.com/rust-lang/rust/commit/738d4a7a368b4da8bfa31915f06bb1ddce9e9980"}], "stats": {"total": 20, "additions": 11, "deletions": 9}, "files": [{"sha": "62b1254287724aedacab6f5a7642124dbfd2bcdb", "filename": "compiler/rustc_hir/src/def.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d74b8e0505b83c72761987c48f3aa3fbb2656573/compiler%2Frustc_hir%2Fsrc%2Fdef.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d74b8e0505b83c72761987c48f3aa3fbb2656573/compiler%2Frustc_hir%2Fsrc%2Fdef.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir%2Fsrc%2Fdef.rs?ref=d74b8e0505b83c72761987c48f3aa3fbb2656573", "patch": "@@ -341,9 +341,7 @@ impl<T> PerNS<Option<T>> {\n \n     /// Returns an iterator over the items which are `Some`.\n     pub fn present_items(self) -> impl Iterator<Item = T> {\n-        use std::iter::once;\n-\n-        once(self.type_ns).chain(once(self.value_ns)).chain(once(self.macro_ns)).filter_map(|it| it)\n+        IntoIter::new([self.type_ns, self.value_ns, self.macro_ns]).filter_map(|it| it)\n     }\n }\n "}, {"sha": "406e8936e6ecfcfc67aa40461693229ca658338d", "filename": "compiler/rustc_trait_selection/src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d74b8e0505b83c72761987c48f3aa3fbb2656573/compiler%2Frustc_trait_selection%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d74b8e0505b83c72761987c48f3aa3fbb2656573/compiler%2Frustc_trait_selection%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Flib.rs?ref=d74b8e0505b83c72761987c48f3aa3fbb2656573", "patch": "@@ -11,6 +11,7 @@\n //! This API is completely unstable and subject to change.\n \n #![doc(html_root_url = \"https://doc.rust-lang.org/nightly/nightly-rustc/\")]\n+#![feature(array_value_iter)]\n #![feature(bool_to_option)]\n #![feature(box_patterns)]\n #![feature(drain_filter)]"}, {"sha": "8fc14cb29971d1c1c698bc91bcd94e8c5fcb03f4", "filename": "compiler/rustc_trait_selection/src/traits/object_safety.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d74b8e0505b83c72761987c48f3aa3fbb2656573/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fobject_safety.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d74b8e0505b83c72761987c48f3aa3fbb2656573/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fobject_safety.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fobject_safety.rs?ref=d74b8e0505b83c72761987c48f3aa3fbb2656573", "patch": "@@ -24,6 +24,7 @@ use rustc_span::symbol::Symbol;\n use rustc_span::Span;\n use smallvec::SmallVec;\n \n+use std::array;\n use std::iter;\n \n pub use crate::traits::{MethodViolationCode, ObjectSafetyViolation};\n@@ -652,8 +653,7 @@ fn receiver_is_dispatchable<'tcx>(\n         let caller_bounds: Vec<Predicate<'tcx>> = param_env\n             .caller_bounds()\n             .iter()\n-            .chain(iter::once(unsize_predicate))\n-            .chain(iter::once(trait_predicate))\n+            .chain(array::IntoIter::new([unsize_predicate, trait_predicate]))\n             .collect();\n \n         ty::ParamEnv::new(tcx.intern_predicates(&caller_bounds), param_env.reveal())"}, {"sha": "170ca2ce744cd94f66ce5cad8ac1178fd71b0031", "filename": "compiler/rustc_typeck/src/astconv/mod.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d74b8e0505b83c72761987c48f3aa3fbb2656573/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d74b8e0505b83c72761987c48f3aa3fbb2656573/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fmod.rs?ref=d74b8e0505b83c72761987c48f3aa3fbb2656573", "patch": "@@ -35,8 +35,8 @@ use rustc_trait_selection::traits::error_reporting::report_object_safety_error;\n use rustc_trait_selection::traits::wf::object_region_bounds;\n \n use smallvec::SmallVec;\n+use std::array;\n use std::collections::BTreeSet;\n-use std::iter;\n use std::slice;\n \n #[derive(Debug)]\n@@ -1346,7 +1346,7 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n             debug!(\"one_bound_for_assoc_type: bound2 = {:?}\", bound2);\n \n             let is_equality = is_equality();\n-            let bounds = iter::once(bound).chain(iter::once(bound2)).chain(matching_candidates);\n+            let bounds = array::IntoIter::new([bound, bound2]).chain(matching_candidates);\n             let mut err = if is_equality.is_some() {\n                 // More specific Error Index entry.\n                 struct_span_err!("}, {"sha": "7efda54fbe035a697b046d6ec27e442dbba6d008", "filename": "compiler/rustc_typeck/src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d74b8e0505b83c72761987c48f3aa3fbb2656573/compiler%2Frustc_typeck%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d74b8e0505b83c72761987c48f3aa3fbb2656573/compiler%2Frustc_typeck%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Flib.rs?ref=d74b8e0505b83c72761987c48f3aa3fbb2656573", "patch": "@@ -56,6 +56,7 @@ This API is completely unstable and subject to change.\n */\n \n #![doc(html_root_url = \"https://doc.rust-lang.org/nightly/nightly-rustc/\")]\n+#![feature(array_value_iter)]\n #![feature(bool_to_option)]\n #![feature(box_syntax)]\n #![feature(crate_visibility_modifier)]"}, {"sha": "adb08543334f00426ee3258053cd5d4b87d3933a", "filename": "library/alloc/src/collections/vec_deque.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/d74b8e0505b83c72761987c48f3aa3fbb2656573/library%2Falloc%2Fsrc%2Fcollections%2Fvec_deque.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d74b8e0505b83c72761987c48f3aa3fbb2656573/library%2Falloc%2Fsrc%2Fcollections%2Fvec_deque.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Fcollections%2Fvec_deque.rs?ref=d74b8e0505b83c72761987c48f3aa3fbb2656573", "patch": "@@ -9,10 +9,11 @@\n \n // ignore-tidy-filelength\n \n+use core::array;\n use core::cmp::{self, Ordering};\n use core::fmt;\n use core::hash::{Hash, Hasher};\n-use core::iter::{once, repeat_with, FromIterator, FusedIterator};\n+use core::iter::{repeat_with, FromIterator, FusedIterator};\n use core::mem::{self, replace, ManuallyDrop};\n use core::ops::{Index, IndexMut, Range, RangeBounds, Try};\n use core::ptr::{self, NonNull};\n@@ -99,7 +100,7 @@ impl<'a, 'b, T> PairSlices<'a, 'b, T> {\n     }\n \n     fn remainder(self) -> impl Iterator<Item = &'b [T]> {\n-        once(self.b0).chain(once(self.b1))\n+        array::IntoIter::new([self.b0, self.b1])\n     }\n }\n "}, {"sha": "046c3867d840328d2f1b25b267f33869f47f2cb6", "filename": "library/alloc/src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d74b8e0505b83c72761987c48f3aa3fbb2656573/library%2Falloc%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d74b8e0505b83c72761987c48f3aa3fbb2656573/library%2Falloc%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Flib.rs?ref=d74b8e0505b83c72761987c48f3aa3fbb2656573", "patch": "@@ -77,6 +77,7 @@\n #![cfg_attr(test, feature(new_uninit))]\n #![feature(allocator_api)]\n #![feature(array_chunks)]\n+#![feature(array_value_iter)]\n #![feature(array_windows)]\n #![feature(allow_internal_unstable)]\n #![feature(arbitrary_self_types)]"}]}