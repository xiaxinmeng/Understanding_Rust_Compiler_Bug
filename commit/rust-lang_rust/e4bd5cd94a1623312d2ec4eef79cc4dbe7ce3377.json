{"sha": "e4bd5cd94a1623312d2ec4eef79cc4dbe7ce3377", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU0YmQ1Y2Q5NGExNjIzMzEyZDJlYzRlZWY3OWNjNGRiZTdjZTMzNzc=", "commit": {"author": {"name": "Tiago Lam", "email": "tiagol@hadean.com", "date": "2020-08-28T17:23:20Z"}, "committer": {"name": "Tiago Lam", "email": "tiagol@hadean.com", "date": "2020-08-28T17:23:20Z"}, "message": "Build dist-x86_64-musl with --enable-profiler.\n\nTrying to build a Rust project with `-Zprofile` for target\nx86_64-unknown-linux-musl using rustc 1.46.0-nightly (346aec9b0\n2020-07-11), installed with rustup, results in the following error.\n```\n        export RUSTFLAGS=\"-Zprofile -Ccodegen-units=1 -Copt-level=0 -Clink-dead-code -Coverflow-checks=off -Zpanic_abort_tests -Cpanic=abort\"export CARGO_INCREMENTAL=0$ cargo build --target=x86_64-unknown-linux-muslCompiling hello_world v0.1.0 (\u2026)error[E0463]: can't find crate for `profiler_builtins`\n        |\n         = note: the compiler may have been built without the profiler runtime\n\n        error: aborting due to previous error\n\n        For more information about this error, try `rustc --explain E0463`.error: could not compile `hello_world`.\n\n        To learn more, run the command again with --verbose.\n```\n\n`-Zprofile` is required here to enable grcov profiling.\n\nThis is similar in nature to issue\nhttps://github.com/rust-lang/rust/issues/57257, which has been fixed in\nasimilar way at https://github.com/rust-lang/rust/pull/60476 .\n\nA fix for Android has also landed not long ago:\nhttps://github.com/rust-lang/rust/pull/70054 .\n\nSigned-off-by: Tiago Lam <tiagol@hadean.com>", "tree": {"sha": "69ff224f7c5ce9913dc76e427f95db26e4aacb7e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/69ff224f7c5ce9913dc76e427f95db26e4aacb7e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e4bd5cd94a1623312d2ec4eef79cc4dbe7ce3377", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e4bd5cd94a1623312d2ec4eef79cc4dbe7ce3377", "html_url": "https://github.com/rust-lang/rust/commit/e4bd5cd94a1623312d2ec4eef79cc4dbe7ce3377", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e4bd5cd94a1623312d2ec4eef79cc4dbe7ce3377/comments", "author": {"login": "tiagolam", "id": 2976679, "node_id": "MDQ6VXNlcjI5NzY2Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/2976679?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tiagolam", "html_url": "https://github.com/tiagolam", "followers_url": "https://api.github.com/users/tiagolam/followers", "following_url": "https://api.github.com/users/tiagolam/following{/other_user}", "gists_url": "https://api.github.com/users/tiagolam/gists{/gist_id}", "starred_url": "https://api.github.com/users/tiagolam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tiagolam/subscriptions", "organizations_url": "https://api.github.com/users/tiagolam/orgs", "repos_url": "https://api.github.com/users/tiagolam/repos", "events_url": "https://api.github.com/users/tiagolam/events{/privacy}", "received_events_url": "https://api.github.com/users/tiagolam/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tiagolam", "id": 2976679, "node_id": "MDQ6VXNlcjI5NzY2Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/2976679?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tiagolam", "html_url": "https://github.com/tiagolam", "followers_url": "https://api.github.com/users/tiagolam/followers", "following_url": "https://api.github.com/users/tiagolam/following{/other_user}", "gists_url": "https://api.github.com/users/tiagolam/gists{/gist_id}", "starred_url": "https://api.github.com/users/tiagolam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tiagolam/subscriptions", "organizations_url": "https://api.github.com/users/tiagolam/orgs", "repos_url": "https://api.github.com/users/tiagolam/repos", "events_url": "https://api.github.com/users/tiagolam/events{/privacy}", "received_events_url": "https://api.github.com/users/tiagolam/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3e3c552605180d739eb6c23bc657121679caa456", "url": "https://api.github.com/repos/rust-lang/rust/commits/3e3c552605180d739eb6c23bc657121679caa456", "html_url": "https://github.com/rust-lang/rust/commit/3e3c552605180d739eb6c23bc657121679caa456"}], "stats": {"total": 1, "additions": 1, "deletions": 0}, "files": [{"sha": "dc8745cd8d44325c0dc18d1bad415e5c28ae8393", "filename": "src/ci/docker/host-x86_64/dist-x86_64-musl/Dockerfile", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/e4bd5cd94a1623312d2ec4eef79cc4dbe7ce3377/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-x86_64-musl%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/e4bd5cd94a1623312d2ec4eef79cc4dbe7ce3377/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-x86_64-musl%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-x86_64-musl%2FDockerfile?ref=e4bd5cd94a1623312d2ec4eef79cc4dbe7ce3377", "patch": "@@ -33,6 +33,7 @@ ENV HOSTS=x86_64-unknown-linux-musl\n ENV RUST_CONFIGURE_ARGS \\\n       --musl-root-x86_64=/usr/local/x86_64-linux-musl \\\n       --enable-extended \\\n+      --enable-profiler \\\n       --enable-lld \\\n       --set target.x86_64-unknown-linux-musl.crt-static=false \\\n       --build $HOSTS"}]}