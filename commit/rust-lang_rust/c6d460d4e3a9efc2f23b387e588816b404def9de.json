{"sha": "c6d460d4e3a9efc2f23b387e588816b404def9de", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM2ZDQ2MGQ0ZTNhOWVmYzJmMjNiMzg3ZTU4ODgxNmI0MDRkZWY5ZGU=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-09-20T18:47:22Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-09-20T18:47:22Z"}, "message": "Rehabilitate task-comm-14", "tree": {"sha": "6f9aba24131a566208b9f3e5b67b9dfa241c3c2b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6f9aba24131a566208b9f3e5b67b9dfa241c3c2b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c6d460d4e3a9efc2f23b387e588816b404def9de", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c6d460d4e3a9efc2f23b387e588816b404def9de", "html_url": "https://github.com/rust-lang/rust/commit/c6d460d4e3a9efc2f23b387e588816b404def9de", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c6d460d4e3a9efc2f23b387e588816b404def9de/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "564bdacecebd25e314c6785d7fff601b12c8e10f", "url": "https://api.github.com/repos/rust-lang/rust/commits/564bdacecebd25e314c6785d7fff601b12c8e10f", "html_url": "https://github.com/rust-lang/rust/commit/564bdacecebd25e314c6785d7fff601b12c8e10f"}], "stats": {"total": 20, "additions": 12, "deletions": 8}, "files": [{"sha": "a115d5a60d3b3ee04641c67579722319bd5bd0d5", "filename": "src/test/run-pass/task-comm-14.rs", "status": "renamed", "additions": 12, "deletions": 8, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/c6d460d4e3a9efc2f23b387e588816b404def9de/src%2Ftest%2Frun-pass%2Ftask-comm-14.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c6d460d4e3a9efc2f23b387e588816b404def9de/src%2Ftest%2Frun-pass%2Ftask-comm-14.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Ftask-comm-14.rs?ref=c6d460d4e3a9efc2f23b387e588816b404def9de", "patch": "@@ -1,30 +1,34 @@\n // xfail-test\n-io fn main() {\n-    let port<int> po = port();\n+use std;\n+import std::comm;\n+import std::task;\n+\n+fn main() {\n+    let po = comm::port();\n \n     // Spawn 10 tasks each sending us back one int.\n-    let int i = 10;\n+    let i = 10;\n     while (i > 0) {\n         log i;\n-        spawn \"child\" child(i, chan(po));\n+        task::spawn(bind child(i, comm::chan(po)));\n         i = i - 1;\n     }\n \n     // Spawned tasks are likely killed before they get a chance to send\n     // anything back, so we deadlock here.\n \n     i = 10;\n-    let int value = 0;\n+    let value = 0;\n     while (i > 0) {\n         log i;\n-        po |> value;\n+        value = comm::recv(po);\n         i = i - 1;\n     }\n \n     log \"main thread exiting\";\n }\n \n-io fn child(int x, chan<int> ch) {\n+fn child(x: int, ch: comm::chan<int>) {\n     log x;\n-    ch <| x;\n+    comm::send(ch, x);\n }", "previous_filename": "src/test/run-fail/task-comm-14.rs"}]}