{"sha": "e25129b055cae83e1a005d84c8119b74416f94ad", "node_id": "C_kwDOAAsO6NoAKGUyNTEyOWIwNTVjYWU4M2UxYTAwNWQ4NGM4MTE5Yjc0NDE2Zjk0YWQ", "commit": {"author": {"name": "Waffle Maybe", "email": "waffle.lapkin@gmail.com", "date": "2022-06-24T17:05:02Z"}, "committer": {"name": "Maybe Waffle", "email": "waffle.lapkin@gmail.com", "date": "2022-06-24T17:14:34Z"}, "message": "take advantage of a labelled block\n\nCo-authored-by: Michael Goulet <michael@errs.io>", "tree": {"sha": "205dd0103e15f71c25c4ec891f64cd3c4a1146e1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/205dd0103e15f71c25c4ec891f64cd3c4a1146e1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e25129b055cae83e1a005d84c8119b74416f94ad", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e25129b055cae83e1a005d84c8119b74416f94ad", "html_url": "https://github.com/rust-lang/rust/commit/e25129b055cae83e1a005d84c8119b74416f94ad", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e25129b055cae83e1a005d84c8119b74416f94ad/comments", "author": {"login": "WaffleLapkin", "id": 38225716, "node_id": "MDQ6VXNlcjM4MjI1NzE2", "avatar_url": "https://avatars.githubusercontent.com/u/38225716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/WaffleLapkin", "html_url": "https://github.com/WaffleLapkin", "followers_url": "https://api.github.com/users/WaffleLapkin/followers", "following_url": "https://api.github.com/users/WaffleLapkin/following{/other_user}", "gists_url": "https://api.github.com/users/WaffleLapkin/gists{/gist_id}", "starred_url": "https://api.github.com/users/WaffleLapkin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/WaffleLapkin/subscriptions", "organizations_url": "https://api.github.com/users/WaffleLapkin/orgs", "repos_url": "https://api.github.com/users/WaffleLapkin/repos", "events_url": "https://api.github.com/users/WaffleLapkin/events{/privacy}", "received_events_url": "https://api.github.com/users/WaffleLapkin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "WaffleLapkin", "id": 38225716, "node_id": "MDQ6VXNlcjM4MjI1NzE2", "avatar_url": "https://avatars.githubusercontent.com/u/38225716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/WaffleLapkin", "html_url": "https://github.com/WaffleLapkin", "followers_url": "https://api.github.com/users/WaffleLapkin/followers", "following_url": "https://api.github.com/users/WaffleLapkin/following{/other_user}", "gists_url": "https://api.github.com/users/WaffleLapkin/gists{/gist_id}", "starred_url": "https://api.github.com/users/WaffleLapkin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/WaffleLapkin/subscriptions", "organizations_url": "https://api.github.com/users/WaffleLapkin/orgs", "repos_url": "https://api.github.com/users/WaffleLapkin/repos", "events_url": "https://api.github.com/users/WaffleLapkin/events{/privacy}", "received_events_url": "https://api.github.com/users/WaffleLapkin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3c7f1f16016d8a19a549f2c34a05cfdf8f79968b", "url": "https://api.github.com/repos/rust-lang/rust/commits/3c7f1f16016d8a19a549f2c34a05cfdf8f79968b", "html_url": "https://github.com/rust-lang/rust/commit/3c7f1f16016d8a19a549f2c34a05cfdf8f79968b"}], "stats": {"total": 16, "additions": 8, "deletions": 8}, "files": [{"sha": "5d40f05834355735c4ca98db045d567cef1561d8", "filename": "compiler/rustc_typeck/src/check/pat.rs", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/e25129b055cae83e1a005d84c8119b74416f94ad/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fpat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e25129b055cae83e1a005d84c8119b74416f94ad/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fpat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fpat.rs?ref=e25129b055cae83e1a005d84c8119b74416f94ad", "patch": "@@ -669,9 +669,9 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                 }\n \n                 let ident_kind = match binding_parent {\n-                    hir::Node::Param(_) => Some(\"parameter\"),\n-                    hir::Node::Local(_) => Some(\"variable\"),\n-                    hir::Node::Arm(_) => Some(\"binding\"),\n+                    hir::Node::Param(_) => \"parameter\",\n+                    hir::Node::Local(_) => \"variable\",\n+                    hir::Node::Arm(_) => \"binding\",\n \n                     // Provide diagnostics only if the parent pattern is struct-like,\n                     // i.e. where `mut binding` makes sense\n@@ -680,24 +680,24 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                         | PatKind::TupleStruct(..)\n                         | PatKind::Or(..)\n                         | PatKind::Tuple(..)\n-                        | PatKind::Slice(..) => Some(\"binding\"),\n+                        | PatKind::Slice(..) => \"binding\",\n \n                         PatKind::Wild\n                         | PatKind::Binding(..)\n                         | PatKind::Path(..)\n                         | PatKind::Box(..)\n                         | PatKind::Ref(..)\n                         | PatKind::Lit(..)\n-                        | PatKind::Range(..) => None,\n+                        | PatKind::Range(..) => break 'block None,\n                     },\n \n                     // Don't provide suggestions in other cases\n-                    _ => None,\n+                    _ => break 'block None,\n                 };\n \n-                ident_kind.map(|thing| (\n+                Some((\n                     pat.span,\n-                    format!(\"to declare a mutable {thing} use `mut variable_name`\"),\n+                    format!(\"to declare a mutable {ident_kind} use `mut variable_name`\"),\n                     format!(\"mut {binding}\"),\n                 ))\n "}]}