{"sha": "49920bc581743d6edb9f82fbff4cbafebc212619", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ5OTIwYmM1ODE3NDNkNmVkYjlmODJmYmZmNGNiYWZlYmMyMTI2MTk=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-04-30T09:52:32Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-04-30T09:52:32Z"}, "message": "Auto merge of #84522 - CDirkx:cmath, r=yaahc\n\nReuse `sys::unix::cmath` on other platforms\n\nReuse `sys::unix::cmath` on all non-`windows` platforms.\n\n`unix` is chosen as the canonical location instead of `unsupported` or `common` because `unsupported` doesn't make sense semantically and `common` is reserved for code that is supported on all platforms. Also `unix` is already the home of some non-`windows` code that is technically not exclusive to `unix` like `unix::path`.", "tree": {"sha": "2849e16701ef5e6c51028f7e84c2d04b8ac14364", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2849e16701ef5e6c51028f7e84c2d04b8ac14364"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/49920bc581743d6edb9f82fbff4cbafebc212619", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/49920bc581743d6edb9f82fbff4cbafebc212619", "html_url": "https://github.com/rust-lang/rust/commit/49920bc581743d6edb9f82fbff4cbafebc212619", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/49920bc581743d6edb9f82fbff4cbafebc212619/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bcd696d722c04a0f8c34d884aa4ed2322f55cdd8", "url": "https://api.github.com/repos/rust-lang/rust/commits/bcd696d722c04a0f8c34d884aa4ed2322f55cdd8", "html_url": "https://github.com/rust-lang/rust/commit/bcd696d722c04a0f8c34d884aa4ed2322f55cdd8"}, {"sha": "26fb1e373bd313b70d1f95cd16259035e5a7f8c8", "url": "https://api.github.com/repos/rust-lang/rust/commits/26fb1e373bd313b70d1f95cd16259035e5a7f8c8", "html_url": "https://github.com/rust-lang/rust/commit/26fb1e373bd313b70d1f95cd16259035e5a7f8c8"}], "stats": {"total": 152, "additions": 34, "deletions": 118}, "files": [{"sha": "304cf906b2aeadba92007440bb5628e3c9ed8184", "filename": "library/std/src/sys/hermit/cmath.rs", "status": "removed", "additions": 0, "deletions": 29, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/bcd696d722c04a0f8c34d884aa4ed2322f55cdd8/library%2Fstd%2Fsrc%2Fsys%2Fhermit%2Fcmath.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bcd696d722c04a0f8c34d884aa4ed2322f55cdd8/library%2Fstd%2Fsrc%2Fsys%2Fhermit%2Fcmath.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fhermit%2Fcmath.rs?ref=bcd696d722c04a0f8c34d884aa4ed2322f55cdd8", "patch": "@@ -1,29 +0,0 @@\n-// These symbols are all defined in `compiler-builtins`\n-extern \"C\" {\n-    pub fn acos(n: f64) -> f64;\n-    pub fn acosf(n: f32) -> f32;\n-    pub fn asin(n: f64) -> f64;\n-    pub fn asinf(n: f32) -> f32;\n-    pub fn atan(n: f64) -> f64;\n-    pub fn atan2(a: f64, b: f64) -> f64;\n-    pub fn atan2f(a: f32, b: f32) -> f32;\n-    pub fn atanf(n: f32) -> f32;\n-    pub fn cbrt(n: f64) -> f64;\n-    pub fn cbrtf(n: f32) -> f32;\n-    pub fn cosh(n: f64) -> f64;\n-    pub fn coshf(n: f32) -> f32;\n-    pub fn expm1(n: f64) -> f64;\n-    pub fn expm1f(n: f32) -> f32;\n-    pub fn fdim(a: f64, b: f64) -> f64;\n-    pub fn fdimf(a: f32, b: f32) -> f32;\n-    pub fn hypot(x: f64, y: f64) -> f64;\n-    pub fn hypotf(x: f32, y: f32) -> f32;\n-    pub fn log1p(n: f64) -> f64;\n-    pub fn log1pf(n: f32) -> f32;\n-    pub fn sinh(n: f64) -> f64;\n-    pub fn sinhf(n: f32) -> f32;\n-    pub fn tan(n: f64) -> f64;\n-    pub fn tanf(n: f32) -> f32;\n-    pub fn tanh(n: f64) -> f64;\n-    pub fn tanhf(n: f32) -> f32;\n-}"}, {"sha": "0c49a6fb6deff869921878de95949e5ad1efd2cb", "filename": "library/std/src/sys/hermit/mod.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/49920bc581743d6edb9f82fbff4cbafebc212619/library%2Fstd%2Fsrc%2Fsys%2Fhermit%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/49920bc581743d6edb9f82fbff4cbafebc212619/library%2Fstd%2Fsrc%2Fsys%2Fhermit%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fhermit%2Fmod.rs?ref=49920bc581743d6edb9f82fbff4cbafebc212619", "patch": "@@ -20,6 +20,7 @@ use crate::os::raw::c_char;\n \n pub mod alloc;\n pub mod args;\n+#[path = \"../unix/cmath.rs\"]\n pub mod cmath;\n pub mod condvar;\n pub mod env;"}, {"sha": "b89238f1da8f7af7f3eada50e050eff26797e857", "filename": "library/std/src/sys/sgx/cmath.rs", "status": "removed", "additions": 0, "deletions": 31, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/bcd696d722c04a0f8c34d884aa4ed2322f55cdd8/library%2Fstd%2Fsrc%2Fsys%2Fsgx%2Fcmath.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bcd696d722c04a0f8c34d884aa4ed2322f55cdd8/library%2Fstd%2Fsrc%2Fsys%2Fsgx%2Fcmath.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fsgx%2Fcmath.rs?ref=bcd696d722c04a0f8c34d884aa4ed2322f55cdd8", "patch": "@@ -1,31 +0,0 @@\n-#![cfg(not(test))]\n-\n-// These symbols are all defined in `compiler-builtins`\n-extern \"C\" {\n-    pub fn acos(n: f64) -> f64;\n-    pub fn acosf(n: f32) -> f32;\n-    pub fn asin(n: f64) -> f64;\n-    pub fn asinf(n: f32) -> f32;\n-    pub fn atan(n: f64) -> f64;\n-    pub fn atan2(a: f64, b: f64) -> f64;\n-    pub fn atan2f(a: f32, b: f32) -> f32;\n-    pub fn atanf(n: f32) -> f32;\n-    pub fn cbrt(n: f64) -> f64;\n-    pub fn cbrtf(n: f32) -> f32;\n-    pub fn cosh(n: f64) -> f64;\n-    pub fn coshf(n: f32) -> f32;\n-    pub fn expm1(n: f64) -> f64;\n-    pub fn expm1f(n: f32) -> f32;\n-    pub fn fdim(a: f64, b: f64) -> f64;\n-    pub fn fdimf(a: f32, b: f32) -> f32;\n-    pub fn hypot(x: f64, y: f64) -> f64;\n-    pub fn hypotf(x: f32, y: f32) -> f32;\n-    pub fn log1p(n: f64) -> f64;\n-    pub fn log1pf(n: f32) -> f32;\n-    pub fn sinh(n: f64) -> f64;\n-    pub fn sinhf(n: f32) -> f32;\n-    pub fn tan(n: f64) -> f64;\n-    pub fn tanf(n: f32) -> f32;\n-    pub fn tanh(n: f64) -> f64;\n-    pub fn tanhf(n: f32) -> f32;\n-}"}, {"sha": "bf3bd57e98255d46fd60db3b225dff9850d70e2d", "filename": "library/std/src/sys/sgx/mod.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/49920bc581743d6edb9f82fbff4cbafebc212619/library%2Fstd%2Fsrc%2Fsys%2Fsgx%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/49920bc581743d6edb9f82fbff4cbafebc212619/library%2Fstd%2Fsrc%2Fsys%2Fsgx%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fsgx%2Fmod.rs?ref=49920bc581743d6edb9f82fbff4cbafebc212619", "patch": "@@ -13,6 +13,7 @@ mod waitqueue;\n \n pub mod alloc;\n pub mod args;\n+#[path = \"../unix/cmath.rs\"]\n pub mod cmath;\n pub mod condvar;\n pub mod env;"}, {"sha": "2bf80d7a4cbe2cbf84536e585db646cee4a78a99", "filename": "library/std/src/sys/unix/cmath.rs", "status": "modified", "additions": 28, "deletions": 27, "changes": 55, "blob_url": "https://github.com/rust-lang/rust/blob/49920bc581743d6edb9f82fbff4cbafebc212619/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fcmath.rs", "raw_url": "https://github.com/rust-lang/rust/raw/49920bc581743d6edb9f82fbff4cbafebc212619/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fcmath.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fcmath.rs?ref=49920bc581743d6edb9f82fbff4cbafebc212619", "patch": "@@ -1,32 +1,33 @@\n #![cfg(not(test))]\n \n-use libc::{c_double, c_float};\n+// These symbols are all defined by `libm`,\n+// or by `compiler-builtins` on unsupported platforms.\n \n extern \"C\" {\n-    pub fn acos(n: c_double) -> c_double;\n-    pub fn acosf(n: c_float) -> c_float;\n-    pub fn asin(n: c_double) -> c_double;\n-    pub fn asinf(n: c_float) -> c_float;\n-    pub fn atan(n: c_double) -> c_double;\n-    pub fn atan2(a: c_double, b: c_double) -> c_double;\n-    pub fn atan2f(a: c_float, b: c_float) -> c_float;\n-    pub fn atanf(n: c_float) -> c_float;\n-    pub fn cbrt(n: c_double) -> c_double;\n-    pub fn cbrtf(n: c_float) -> c_float;\n-    pub fn cosh(n: c_double) -> c_double;\n-    pub fn coshf(n: c_float) -> c_float;\n-    pub fn expm1(n: c_double) -> c_double;\n-    pub fn expm1f(n: c_float) -> c_float;\n-    pub fn fdim(a: c_double, b: c_double) -> c_double;\n-    pub fn fdimf(a: c_float, b: c_float) -> c_float;\n-    pub fn hypot(x: c_double, y: c_double) -> c_double;\n-    pub fn hypotf(x: c_float, y: c_float) -> c_float;\n-    pub fn log1p(n: c_double) -> c_double;\n-    pub fn log1pf(n: c_float) -> c_float;\n-    pub fn sinh(n: c_double) -> c_double;\n-    pub fn sinhf(n: c_float) -> c_float;\n-    pub fn tan(n: c_double) -> c_double;\n-    pub fn tanf(n: c_float) -> c_float;\n-    pub fn tanh(n: c_double) -> c_double;\n-    pub fn tanhf(n: c_float) -> c_float;\n+    pub fn acos(n: f64) -> f64;\n+    pub fn acosf(n: f32) -> f32;\n+    pub fn asin(n: f64) -> f64;\n+    pub fn asinf(n: f32) -> f32;\n+    pub fn atan(n: f64) -> f64;\n+    pub fn atan2(a: f64, b: f64) -> f64;\n+    pub fn atan2f(a: f32, b: f32) -> f32;\n+    pub fn atanf(n: f32) -> f32;\n+    pub fn cbrt(n: f64) -> f64;\n+    pub fn cbrtf(n: f32) -> f32;\n+    pub fn cosh(n: f64) -> f64;\n+    pub fn coshf(n: f32) -> f32;\n+    pub fn expm1(n: f64) -> f64;\n+    pub fn expm1f(n: f32) -> f32;\n+    pub fn fdim(a: f64, b: f64) -> f64;\n+    pub fn fdimf(a: f32, b: f32) -> f32;\n+    pub fn hypot(x: f64, y: f64) -> f64;\n+    pub fn hypotf(x: f32, y: f32) -> f32;\n+    pub fn log1p(n: f64) -> f64;\n+    pub fn log1pf(n: f32) -> f32;\n+    pub fn sinh(n: f64) -> f64;\n+    pub fn sinhf(n: f32) -> f32;\n+    pub fn tan(n: f64) -> f64;\n+    pub fn tanf(n: f32) -> f32;\n+    pub fn tanh(n: f64) -> f64;\n+    pub fn tanhf(n: f32) -> f32;\n }"}, {"sha": "6c4fbaf27344b8bd3581a6565b782d0e2f91dfd3", "filename": "library/std/src/sys/unix/mod.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/49920bc581743d6edb9f82fbff4cbafebc212619/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/49920bc581743d6edb9f82fbff4cbafebc212619/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fmod.rs?ref=49920bc581743d6edb9f82fbff4cbafebc212619", "patch": "@@ -11,6 +11,7 @@ pub mod weak;\n pub mod alloc;\n pub mod android;\n pub mod args;\n+#[path = \"../unix/cmath.rs\"]\n pub mod cmath;\n pub mod condvar;\n pub mod env;"}, {"sha": "304cf906b2aeadba92007440bb5628e3c9ed8184", "filename": "library/std/src/sys/unsupported/cmath.rs", "status": "removed", "additions": 0, "deletions": 29, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/bcd696d722c04a0f8c34d884aa4ed2322f55cdd8/library%2Fstd%2Fsrc%2Fsys%2Funsupported%2Fcmath.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bcd696d722c04a0f8c34d884aa4ed2322f55cdd8/library%2Fstd%2Fsrc%2Fsys%2Funsupported%2Fcmath.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funsupported%2Fcmath.rs?ref=bcd696d722c04a0f8c34d884aa4ed2322f55cdd8", "patch": "@@ -1,29 +0,0 @@\n-// These symbols are all defined in `compiler-builtins`\n-extern \"C\" {\n-    pub fn acos(n: f64) -> f64;\n-    pub fn acosf(n: f32) -> f32;\n-    pub fn asin(n: f64) -> f64;\n-    pub fn asinf(n: f32) -> f32;\n-    pub fn atan(n: f64) -> f64;\n-    pub fn atan2(a: f64, b: f64) -> f64;\n-    pub fn atan2f(a: f32, b: f32) -> f32;\n-    pub fn atanf(n: f32) -> f32;\n-    pub fn cbrt(n: f64) -> f64;\n-    pub fn cbrtf(n: f32) -> f32;\n-    pub fn cosh(n: f64) -> f64;\n-    pub fn coshf(n: f32) -> f32;\n-    pub fn expm1(n: f64) -> f64;\n-    pub fn expm1f(n: f32) -> f32;\n-    pub fn fdim(a: f64, b: f64) -> f64;\n-    pub fn fdimf(a: f32, b: f32) -> f32;\n-    pub fn hypot(x: f64, y: f64) -> f64;\n-    pub fn hypotf(x: f32, y: f32) -> f32;\n-    pub fn log1p(n: f64) -> f64;\n-    pub fn log1pf(n: f32) -> f32;\n-    pub fn sinh(n: f64) -> f64;\n-    pub fn sinhf(n: f32) -> f32;\n-    pub fn tan(n: f64) -> f64;\n-    pub fn tanf(n: f32) -> f32;\n-    pub fn tanh(n: f64) -> f64;\n-    pub fn tanhf(n: f32) -> f32;\n-}"}, {"sha": "3ef4c6b8a8f22ca2ac0e184393054c4b4327ecf5", "filename": "library/std/src/sys/unsupported/mod.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/49920bc581743d6edb9f82fbff4cbafebc212619/library%2Fstd%2Fsrc%2Fsys%2Funsupported%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/49920bc581743d6edb9f82fbff4cbafebc212619/library%2Fstd%2Fsrc%2Fsys%2Funsupported%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funsupported%2Fmod.rs?ref=49920bc581743d6edb9f82fbff4cbafebc212619", "patch": "@@ -2,6 +2,7 @@\n \n pub mod alloc;\n pub mod args;\n+#[path = \"../unix/cmath.rs\"]\n pub mod cmath;\n pub mod condvar;\n pub mod env;"}, {"sha": "37f74fcc052e36b40e2a7f0c5148dfcf083019d4", "filename": "library/std/src/sys/wasi/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/49920bc581743d6edb9f82fbff4cbafebc212619/library%2Fstd%2Fsrc%2Fsys%2Fwasi%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/49920bc581743d6edb9f82fbff4cbafebc212619/library%2Fstd%2Fsrc%2Fsys%2Fwasi%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fwasi%2Fmod.rs?ref=49920bc581743d6edb9f82fbff4cbafebc212619", "patch": "@@ -20,7 +20,7 @@ use crate::mem;\n #[path = \"../unix/alloc.rs\"]\n pub mod alloc;\n pub mod args;\n-#[path = \"../unsupported/cmath.rs\"]\n+#[path = \"../unix/cmath.rs\"]\n pub mod cmath;\n #[path = \"../unsupported/condvar.rs\"]\n pub mod condvar;"}, {"sha": "afcc5ca9286d338e0633a920ce53a414658684bb", "filename": "library/std/src/sys/wasm/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/49920bc581743d6edb9f82fbff4cbafebc212619/library%2Fstd%2Fsrc%2Fsys%2Fwasm%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/49920bc581743d6edb9f82fbff4cbafebc212619/library%2Fstd%2Fsrc%2Fsys%2Fwasm%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fwasm%2Fmod.rs?ref=49920bc581743d6edb9f82fbff4cbafebc212619", "patch": "@@ -18,7 +18,7 @@\n \n pub mod alloc;\n pub mod args;\n-#[path = \"../unsupported/cmath.rs\"]\n+#[path = \"../unix/cmath.rs\"]\n pub mod cmath;\n pub mod env;\n #[path = \"../unsupported/fs.rs\"]"}]}