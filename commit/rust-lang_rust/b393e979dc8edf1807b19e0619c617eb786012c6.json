{"sha": "b393e979dc8edf1807b19e0619c617eb786012c6", "node_id": "C_kwDOAAsO6NoAKGIzOTNlOTc5ZGM4ZWRmMTgwN2IxOWUwNjE5YzYxN2ViNzg2MDEyYzY", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-07-16T11:53:43Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-07-16T11:53:43Z"}, "message": "Fix flakyness of GUI tests", "tree": {"sha": "5ba7699e8e51614089cfe354c9cf35fc816d7717", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5ba7699e8e51614089cfe354c9cf35fc816d7717"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b393e979dc8edf1807b19e0619c617eb786012c6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b393e979dc8edf1807b19e0619c617eb786012c6", "html_url": "https://github.com/rust-lang/rust/commit/b393e979dc8edf1807b19e0619c617eb786012c6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b393e979dc8edf1807b19e0619c617eb786012c6/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0ed9c64c3e63acac9bd77abce62501696c390450", "url": "https://api.github.com/repos/rust-lang/rust/commits/0ed9c64c3e63acac9bd77abce62501696c390450", "html_url": "https://github.com/rust-lang/rust/commit/0ed9c64c3e63acac9bd77abce62501696c390450"}], "stats": {"total": 26, "additions": 26, "deletions": 0}, "files": [{"sha": "a5afb037d0fd5987879350827cf35aa698fe59b2", "filename": "src/test/rustdoc-gui/escape-key.goml", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b393e979dc8edf1807b19e0619c617eb786012c6/src%2Ftest%2Frustdoc-gui%2Fescape-key.goml", "raw_url": "https://github.com/rust-lang/rust/raw/b393e979dc8edf1807b19e0619c617eb786012c6/src%2Ftest%2Frustdoc-gui%2Fescape-key.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fescape-key.goml?ref=b393e979dc8edf1807b19e0619c617eb786012c6", "patch": "@@ -3,6 +3,8 @@\n goto: file://|DOC_PATH|/test_docs/index.html\n // First, we check that the search results are hidden when the Escape key is pressed.\n write: (\".search-input\", \"test\")\n+// To be SURE that the search will be run.\n+press-key: 'Enter'\n wait-for: \"#search h1\" // The search element is empty before the first search \n // Check that the currently displayed element is search.\n wait-for: \"#alternative-display #search\""}, {"sha": "d645e2370616144c4acc4f5680e1b08be3f3575d", "filename": "src/test/rustdoc-gui/search-filter.goml", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b393e979dc8edf1807b19e0619c617eb786012c6/src%2Ftest%2Frustdoc-gui%2Fsearch-filter.goml", "raw_url": "https://github.com/rust-lang/rust/raw/b393e979dc8edf1807b19e0619c617eb786012c6/src%2Ftest%2Frustdoc-gui%2Fsearch-filter.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsearch-filter.goml?ref=b393e979dc8edf1807b19e0619c617eb786012c6", "patch": "@@ -2,6 +2,8 @@\n goto: file://|DOC_PATH|/test_docs/index.html\n show-text: true\n write: (\".search-input\", \"test\")\n+// To be SURE that the search will be run.\n+press-key: 'Enter'\n // Waiting for the search results to appear...\n wait-for: \"#titles\"\n assert-text: (\"#results .externcrate\", \"test_docs\")"}, {"sha": "5ef890d472b90804fbc8bf507d235b764670f60d", "filename": "src/test/rustdoc-gui/search-reexport.goml", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b393e979dc8edf1807b19e0619c617eb786012c6/src%2Ftest%2Frustdoc-gui%2Fsearch-reexport.goml", "raw_url": "https://github.com/rust-lang/rust/raw/b393e979dc8edf1807b19e0619c617eb786012c6/src%2Ftest%2Frustdoc-gui%2Fsearch-reexport.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsearch-reexport.goml?ref=b393e979dc8edf1807b19e0619c617eb786012c6", "patch": "@@ -7,6 +7,8 @@ reload:\n assert-text: (\"//*[@id='reexport.TheStdReexport']\", \"pub use ::std as TheStdReexport;\")\n assert-css: (\"//*[@id='reexport.TheStdReexport']\", {\"background-color\": \"rgba(0, 0, 0, 0)\"})\n write: (\".search-input\", \"TheStdReexport\")\n+// To be SURE that the search will be run.\n+press-key: 'Enter'\n wait-for: \"//a[@class='result-import']\"\n assert-attribute: (\n     \"//a[@class='result-import']\",\n@@ -18,6 +20,8 @@ click: \"//a[@class='result-import']\"\n wait-for-css: (\"//*[@id='reexport.TheStdReexport']\", {\"background-color\": \"rgb(73, 74, 61)\"})\n \n // We now check that the alias is working as well on the reexport.\n+// To be SURE that the search will be run.\n+press-key: 'Enter'\n write: (\".search-input\", \"AliasForTheStdReexport\")\n wait-for: \"//a[@class='result-import']\"\n assert-text: ("}, {"sha": "9a49ae2c6b853661f83c5007943dabda13d9ccb4", "filename": "src/test/rustdoc-gui/search-result-color.goml", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b393e979dc8edf1807b19e0619c617eb786012c6/src%2Ftest%2Frustdoc-gui%2Fsearch-result-color.goml", "raw_url": "https://github.com/rust-lang/rust/raw/b393e979dc8edf1807b19e0619c617eb786012c6/src%2Ftest%2Frustdoc-gui%2Fsearch-result-color.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsearch-result-color.goml?ref=b393e979dc8edf1807b19e0619c617eb786012c6", "patch": "@@ -89,6 +89,8 @@ show-text: true\n // We reload the page so the local storage settings are being used.\n reload:\n write: (\".search-input\", \"thisisanalias\")\n+// To be SURE that the search will be run.\n+press-key: 'Enter'\n // Waiting for the search results to appear...\n wait-for: \"#titles\"\n // Checking that the colors for the alias element are the ones expected."}, {"sha": "6295d7fae89070aaaef59aed1681bedd86f1c755", "filename": "src/test/rustdoc-gui/search-result-display.goml", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b393e979dc8edf1807b19e0619c617eb786012c6/src%2Ftest%2Frustdoc-gui%2Fsearch-result-display.goml", "raw_url": "https://github.com/rust-lang/rust/raw/b393e979dc8edf1807b19e0619c617eb786012c6/src%2Ftest%2Frustdoc-gui%2Fsearch-result-display.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsearch-result-display.goml?ref=b393e979dc8edf1807b19e0619c617eb786012c6", "patch": "@@ -2,6 +2,8 @@\n goto: file://|DOC_PATH|/test_docs/index.html\n size: (900, 1000)\n write: (\".search-input\", \"test\")\n+// To be SURE that the search will be run.\n+press-key: 'Enter'\n wait-for: \"#search-settings\"\n // The width is returned by \"getComputedStyle\" which returns the exact number instead of the\n // CSS rule which is \"50%\"..."}, {"sha": "16ae10431acf2dbf86d433f7ff5e29a851be43e2", "filename": "src/test/rustdoc-gui/search-result-keyword.goml", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b393e979dc8edf1807b19e0619c617eb786012c6/src%2Ftest%2Frustdoc-gui%2Fsearch-result-keyword.goml", "raw_url": "https://github.com/rust-lang/rust/raw/b393e979dc8edf1807b19e0619c617eb786012c6/src%2Ftest%2Frustdoc-gui%2Fsearch-result-keyword.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsearch-result-keyword.goml?ref=b393e979dc8edf1807b19e0619c617eb786012c6", "patch": "@@ -1,6 +1,8 @@\n // Checks that the \"keyword\" results have the expected text alongside them.\n goto: file://|DOC_PATH|/test_docs/index.html\n write: (\".search-input\", \"CookieMonster\")\n+// To be SURE that the search will be run.\n+press-key: 'Enter'\n // Waiting for the search results to appear...\n wait-for: \"#titles\"\n // Note: The two next assert commands could be merged as one but readability would be"}, {"sha": "9d506c1519e6b5c2f5ac875045003649102b11c9", "filename": "src/test/rustdoc-gui/search-tab-change-title-fn-sig.goml", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/b393e979dc8edf1807b19e0619c617eb786012c6/src%2Ftest%2Frustdoc-gui%2Fsearch-tab-change-title-fn-sig.goml", "raw_url": "https://github.com/rust-lang/rust/raw/b393e979dc8edf1807b19e0619c617eb786012c6/src%2Ftest%2Frustdoc-gui%2Fsearch-tab-change-title-fn-sig.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsearch-tab-change-title-fn-sig.goml?ref=b393e979dc8edf1807b19e0619c617eb786012c6", "patch": "@@ -2,6 +2,8 @@\n // First, try a search-by-name\n goto: file://|DOC_PATH|/test_docs/index.html\n write: (\".search-input\", \"Foo\")\n+// To be SURE that the search will be run.\n+press-key: 'Enter'\n // Waiting for the search results to appear...\n wait-for: \"#titles\"\n assert-attribute: (\"#titles > button:nth-of-type(1)\", {\"class\": \"selected\"})\n@@ -22,6 +24,8 @@ wait-for-attribute: (\"#titles > button:nth-of-type(3)\", {\"class\": \"selected\"})\n // Now try search-by-return\n goto: file://|DOC_PATH|/test_docs/index.html\n write: (\".search-input\", \"-> String\")\n+// To be SURE that the search will be run.\n+press-key: 'Enter'\n // Waiting for the search results to appear...\n wait-for: \"#titles\"\n assert-attribute: (\"#titles > button:nth-of-type(1)\", {\"class\": \"selected\"})\n@@ -42,6 +46,8 @@ wait-for-attribute: (\"#titles > button:nth-of-type(1)\", {\"class\": \"selected\"})\n // Try with a search-by-return with no results\n goto: file://|DOC_PATH|/test_docs/index.html\n write: (\".search-input\", \"-> Something\")\n+// To be SURE that the search will be run.\n+press-key: 'Enter'\n // Waiting for the search results to appear...\n wait-for: \"#titles\"\n assert-attribute: (\"#titles > button:nth-of-type(1)\", {\"class\": \"selected\"})\n@@ -50,6 +56,8 @@ assert-text: (\"#titles > button:nth-of-type(1)\", \"In Function Return Types\", STA\n // Try with a search-by-parameter\n goto: file://|DOC_PATH|/test_docs/index.html\n write: (\".search-input\", \"usize pattern\")\n+// To be SURE that the search will be run.\n+press-key: 'Enter'\n // Waiting for the search results to appear...\n wait-for: \"#titles\"\n assert-attribute: (\"#titles > button:nth-of-type(1)\", {\"class\": \"selected\"})\n@@ -58,6 +66,8 @@ assert-text: (\"#titles > button:nth-of-type(1)\", \"In Function Parameters\", START\n // Try with a search-by-parameter-and-return\n goto: file://|DOC_PATH|/test_docs/index.html\n write: (\".search-input\", \"pattern -> str\")\n+// To be SURE that the search will be run.\n+press-key: 'Enter'\n // Waiting for the search results to appear...\n wait-for: \"#titles\"\n assert-attribute: (\"#titles > button:nth-of-type(1)\", {\"class\": \"selected\"})"}, {"sha": "8a3365d3cc25e2c90becdb28d450c275e343ebd1", "filename": "src/test/rustdoc-gui/settings.goml", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b393e979dc8edf1807b19e0619c617eb786012c6/src%2Ftest%2Frustdoc-gui%2Fsettings.goml", "raw_url": "https://github.com/rust-lang/rust/raw/b393e979dc8edf1807b19e0619c617eb786012c6/src%2Ftest%2Frustdoc-gui%2Fsettings.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsettings.goml?ref=b393e979dc8edf1807b19e0619c617eb786012c6", "patch": "@@ -20,6 +20,8 @@ wait-for-css: (\"#settings\", {\"display\": \"none\"})\n // Let's click on it when the search results are displayed.\n focus: \".search-input\"\n write: \"test\"\n+// To be SURE that the search will be run.\n+press-key: 'Enter'\n wait-for: \"#alternative-display #search\"\n click: \"#settings-menu\"\n wait-for-css: (\"#settings\", {\"display\": \"block\"})"}]}