{"sha": "75e2dcf56b380c5c941d68a46f321c748cd807a7", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc1ZTJkY2Y1NmIzODBjNWM5NDFkNjhhNDZmMzIxYzc0OGNkODA3YTc=", "commit": {"author": {"name": "Michael Wright", "email": "mikerite@lavabit.com", "date": "2019-11-14T05:42:04Z"}, "committer": {"name": "Michael Wright", "email": "mikerite@lavabit.com", "date": "2019-11-14T05:42:04Z"}, "message": "literal representation: simplification\n\nSimplify calculation in grouping. Add test case to ensure `count()`\ncan't be zero in that branch.", "tree": {"sha": "3d36368dd82cb66e6d37aec30c5c4acf8a113a7e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3d36368dd82cb66e6d37aec30c5c4acf8a113a7e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/75e2dcf56b380c5c941d68a46f321c748cd807a7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/75e2dcf56b380c5c941d68a46f321c748cd807a7", "html_url": "https://github.com/rust-lang/rust/commit/75e2dcf56b380c5c941d68a46f321c748cd807a7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/75e2dcf56b380c5c941d68a46f321c748cd807a7/comments", "author": null, "committer": null, "parents": [{"sha": "2e9d173be1e5a7e1e4788c44dff8b9db268679c1", "url": "https://api.github.com/repos/rust-lang/rust/commits/2e9d173be1e5a7e1e4788c44dff8b9db268679c1", "html_url": "https://github.com/rust-lang/rust/commit/2e9d173be1e5a7e1e4788c44dff8b9db268679c1"}], "stats": {"total": 16, "additions": 14, "deletions": 2}, "files": [{"sha": "f95a27aae3444f173a67f9bf7b766530bde1435c", "filename": "clippy_lints/src/literal_representation.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/75e2dcf56b380c5c941d68a46f321c748cd807a7/clippy_lints%2Fsrc%2Fliteral_representation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/75e2dcf56b380c5c941d68a46f321c748cd807a7/clippy_lints%2Fsrc%2Fliteral_representation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fliteral_representation.rs?ref=75e2dcf56b380c5c941d68a46f321c748cd807a7", "patch": "@@ -268,7 +268,7 @@ impl<'a> NumericLiteral<'a> {\n         let first_group_size;\n \n         if partial_group_first {\n-            first_group_size = (digits.clone().count() + group_size - 1) % group_size + 1;\n+            first_group_size = (digits.clone().count() - 1) % group_size + 1;\n             if pad {\n                 for _ in 0..group_size - first_group_size {\n                     output.push('0');"}, {"sha": "6ae93d5375ab6cfde351d79ba45b22814433c949", "filename": "tests/ui/inconsistent_digit_grouping.fixed", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/75e2dcf56b380c5c941d68a46f321c748cd807a7/tests%2Fui%2Finconsistent_digit_grouping.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/75e2dcf56b380c5c941d68a46f321c748cd807a7/tests%2Fui%2Finconsistent_digit_grouping.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Finconsistent_digit_grouping.fixed?ref=75e2dcf56b380c5c941d68a46f321c748cd807a7", "patch": "@@ -18,4 +18,7 @@ fn main() {\n     let _ = 0x0100_0000;\n     let _ = 0x1000_0000;\n     let _ = 0x0001_0000_0000_u64;\n+\n+    // Test suggestion when fraction has no digits\n+    let _: f32 = 123_456.;\n }"}, {"sha": "c594bdc64c58d21e435879b35e61f48e5ea77d79", "filename": "tests/ui/inconsistent_digit_grouping.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/75e2dcf56b380c5c941d68a46f321c748cd807a7/tests%2Fui%2Finconsistent_digit_grouping.rs", "raw_url": "https://github.com/rust-lang/rust/raw/75e2dcf56b380c5c941d68a46f321c748cd807a7/tests%2Fui%2Finconsistent_digit_grouping.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Finconsistent_digit_grouping.rs?ref=75e2dcf56b380c5c941d68a46f321c748cd807a7", "patch": "@@ -18,4 +18,7 @@ fn main() {\n     let _ = 0x1000000;\n     let _ = 0x10000000;\n     let _ = 0x100000000_u64;\n+\n+    // Test suggestion when fraction has no digits\n+    let _: f32 = 1_23_456.;\n }"}, {"sha": "81c53af1d145f25685d4c42895f1ebd7c55de714", "filename": "tests/ui/inconsistent_digit_grouping.stderr", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/75e2dcf56b380c5c941d68a46f321c748cd807a7/tests%2Fui%2Finconsistent_digit_grouping.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/75e2dcf56b380c5c941d68a46f321c748cd807a7/tests%2Fui%2Finconsistent_digit_grouping.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Finconsistent_digit_grouping.stderr?ref=75e2dcf56b380c5c941d68a46f321c748cd807a7", "patch": "@@ -56,5 +56,11 @@ error: long literal lacking separators\n LL |     let _ = 0x100000000_u64;\n    |             ^^^^^^^^^^^^^^^ help: consider: `0x0001_0000_0000_u64`\n \n-error: aborting due to 9 previous errors\n+error: digits grouped inconsistently by underscores\n+  --> $DIR/inconsistent_digit_grouping.rs:23:18\n+   |\n+LL |     let _: f32 = 1_23_456.;\n+   |                  ^^^^^^^^^ help: consider: `123_456.`\n+\n+error: aborting due to 10 previous errors\n "}]}