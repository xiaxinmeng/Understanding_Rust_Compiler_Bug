{"sha": "72e6d51583ed5fa97ee06fe0259b82b28367874e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjcyZTZkNTE1ODNlZDVmYTk3ZWUwNmZlMDI1OWI4MmIyODM2Nzg3NGU=", "commit": {"author": {"name": "Dylan DPC", "email": "dylan.dpc@gmail.com", "date": "2021-02-23T01:51:43Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-02-23T01:51:43Z"}, "message": "Rollup merge of #81154 - dylni:improve-design-of-assert-len, r=KodrAus\n\nImprove design of `assert_len`\n\nIt was discussed in the [tracking issue](https://github.com/rust-lang/rust/issues/76393#issuecomment-761765448) that `assert_len`'s name and usage are confusing. This PR improves them based on a suggestion by ``@scottmcm`` in that issue.\n\nI also improved the documentation to make it clearer when you might want to use this method.\n\nOld example:\n\n```rust\nlet range = range.assert_len(slice.len());\n```\n\nNew example:\n\n```rust\nlet range = range.ensure_subset_of(..slice.len());\n```\n\nFixes #81157", "tree": {"sha": "be6b57edecd15a58858b257ca6573b550936363f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/be6b57edecd15a58858b257ca6573b550936363f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/72e6d51583ed5fa97ee06fe0259b82b28367874e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgNF+vCRBK7hj4Ov3rIwAAdHIIAHzF95wq+/tGjMSuuZWVqhAe\nEtKZEdDEsWiSirdzIL/mQMPWQPzFK9fXVxDNR+8Bc0FNVXWtXIc2gTyfUiAOkAIx\n7taKOyNtQZCCzGVODU6D+lxo5QrC/7OFoct2NUfIGbGmFdoAPEg1lBKQV7AltQgM\nVpZRSRpM6BSi+EPztEL5wcTIj8R1UNCl0IV4j8g6lJynk0lyPJw0WrS2ftgxd+gn\nbHFloqDMvnNRxjf1b2v7vIK4ekKzThTQzNkQ1kth81OQeu617yeXL9O0f8I+qOCV\n+iXdyEfV3AW/KYJ43zzU9EvxmJeHkNLeBss9DQrfQlvFZHp8RXW0CSq6VEo45Tw=\n=pEqs\n-----END PGP SIGNATURE-----\n", "payload": "tree be6b57edecd15a58858b257ca6573b550936363f\nparent 1c2a949736a85810127b73dbc1006565689d6fe4\nparent fe4fe19ddc38a2da883e1e38d18c821ad1c26fc5\nauthor Dylan DPC <dylan.dpc@gmail.com> 1614045103 +0100\ncommitter GitHub <noreply@github.com> 1614045103 +0100\n\nRollup merge of #81154 - dylni:improve-design-of-assert-len, r=KodrAus\n\nImprove design of `assert_len`\n\nIt was discussed in the [tracking issue](https://github.com/rust-lang/rust/issues/76393#issuecomment-761765448) that `assert_len`'s name and usage are confusing. This PR improves them based on a suggestion by ``@scottmcm`` in that issue.\n\nI also improved the documentation to make it clearer when you might want to use this method.\n\nOld example:\n\n```rust\nlet range = range.assert_len(slice.len());\n```\n\nNew example:\n\n```rust\nlet range = range.ensure_subset_of(..slice.len());\n```\n\nFixes #81157\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/72e6d51583ed5fa97ee06fe0259b82b28367874e", "html_url": "https://github.com/rust-lang/rust/commit/72e6d51583ed5fa97ee06fe0259b82b28367874e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/72e6d51583ed5fa97ee06fe0259b82b28367874e/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1c2a949736a85810127b73dbc1006565689d6fe4", "url": "https://api.github.com/repos/rust-lang/rust/commits/1c2a949736a85810127b73dbc1006565689d6fe4", "html_url": "https://github.com/rust-lang/rust/commit/1c2a949736a85810127b73dbc1006565689d6fe4"}, {"sha": "fe4fe19ddc38a2da883e1e38d18c821ad1c26fc5", "url": "https://api.github.com/repos/rust-lang/rust/commits/fe4fe19ddc38a2da883e1e38d18c821ad1c26fc5", "html_url": "https://github.com/rust-lang/rust/commit/fe4fe19ddc38a2da883e1e38d18c821ad1c26fc5"}], "stats": {"total": 230, "additions": 117, "deletions": 113}, "files": [{"sha": "f7cefdce27856dc587be96392f27f02ade4ed011", "filename": "library/alloc/src/collections/vec_deque/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/72e6d51583ed5fa97ee06fe0259b82b28367874e/library%2Falloc%2Fsrc%2Fcollections%2Fvec_deque%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/72e6d51583ed5fa97ee06fe0259b82b28367874e/library%2Falloc%2Fsrc%2Fcollections%2Fvec_deque%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Fcollections%2Fvec_deque%2Fmod.rs?ref=72e6d51583ed5fa97ee06fe0259b82b28367874e", "patch": "@@ -1063,7 +1063,7 @@ impl<T> VecDeque<T> {\n     where\n         R: RangeBounds<usize>,\n     {\n-        let Range { start, end } = range.assert_len(self.len());\n+        let Range { start, end } = slice::range(range, ..self.len());\n         let tail = self.wrap_add(self.tail, start);\n         let head = self.wrap_add(self.tail, end);\n         (tail, head)"}, {"sha": "c020a969f1fb956f6434cd58f57bb4e97debbecf", "filename": "library/alloc/src/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/72e6d51583ed5fa97ee06fe0259b82b28367874e/library%2Falloc%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/72e6d51583ed5fa97ee06fe0259b82b28367874e/library%2Falloc%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Flib.rs?ref=72e6d51583ed5fa97ee06fe0259b82b28367874e", "patch": "@@ -115,14 +115,14 @@\n #![feature(or_patterns)]\n #![feature(pattern)]\n #![feature(ptr_internals)]\n-#![feature(range_bounds_assert_len)]\n #![feature(rustc_attrs)]\n #![feature(receiver_trait)]\n #![cfg_attr(bootstrap, feature(min_const_generics))]\n #![feature(min_specialization)]\n #![feature(set_ptr_value)]\n #![feature(slice_ptr_get)]\n #![feature(slice_ptr_len)]\n+#![feature(slice_range)]\n #![feature(staged_api)]\n #![feature(str_internals)]\n #![feature(trusted_len)]"}, {"sha": "c5ffade12619f5f58708289eb5e5bb37e9244b99", "filename": "library/alloc/src/slice.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/72e6d51583ed5fa97ee06fe0259b82b28367874e/library%2Falloc%2Fsrc%2Fslice.rs", "raw_url": "https://github.com/rust-lang/rust/raw/72e6d51583ed5fa97ee06fe0259b82b28367874e/library%2Falloc%2Fsrc%2Fslice.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Fslice.rs?ref=72e6d51583ed5fa97ee06fe0259b82b28367874e", "patch": "@@ -92,6 +92,8 @@ use crate::borrow::ToOwned;\n use crate::boxed::Box;\n use crate::vec::Vec;\n \n+#[unstable(feature = \"slice_range\", issue = \"76393\")]\n+pub use core::slice::range;\n #[unstable(feature = \"array_chunks\", issue = \"74985\")]\n pub use core::slice::ArrayChunks;\n #[unstable(feature = \"array_chunks\", issue = \"74985\")]"}, {"sha": "b4deedc52638cb0856433ccb12c07e841a023be4", "filename": "library/alloc/src/string.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/72e6d51583ed5fa97ee06fe0259b82b28367874e/library%2Falloc%2Fsrc%2Fstring.rs", "raw_url": "https://github.com/rust-lang/rust/raw/72e6d51583ed5fa97ee06fe0259b82b28367874e/library%2Falloc%2Fsrc%2Fstring.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Fstring.rs?ref=72e6d51583ed5fa97ee06fe0259b82b28367874e", "patch": "@@ -49,6 +49,7 @@ use core::iter::{FromIterator, FusedIterator};\n use core::ops::Bound::{Excluded, Included, Unbounded};\n use core::ops::{self, Add, AddAssign, Index, IndexMut, Range, RangeBounds};\n use core::ptr;\n+use core::slice;\n use core::str::{lossy, pattern::Pattern};\n \n use crate::borrow::{Cow, ToOwned};\n@@ -1510,14 +1511,14 @@ impl String {\n         // of the vector version. The data is just plain bytes.\n         // Because the range removal happens in Drop, if the Drain iterator is leaked,\n         // the removal will not happen.\n-        let Range { start, end } = range.assert_len(self.len());\n+        let Range { start, end } = slice::range(range, ..self.len());\n         assert!(self.is_char_boundary(start));\n         assert!(self.is_char_boundary(end));\n \n         // Take out two simultaneous borrows. The &mut String won't be accessed\n         // until iteration is over, in Drop.\n         let self_ptr = self as *mut _;\n-        // SAFETY: `assert_len` and `is_char_boundary` do the appropriate bounds checks.\n+        // SAFETY: `slice::range` and `is_char_boundary` do the appropriate bounds checks.\n         let chars_iter = unsafe { self.get_unchecked(start..end) }.chars();\n \n         Drain { start, end, iter: chars_iter, string: self_ptr }"}, {"sha": "dbb7708b60057795006abef3ffc59e450ecfd876", "filename": "library/alloc/src/vec/mod.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/72e6d51583ed5fa97ee06fe0259b82b28367874e/library%2Falloc%2Fsrc%2Fvec%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/72e6d51583ed5fa97ee06fe0259b82b28367874e/library%2Falloc%2Fsrc%2Fvec%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Fvec%2Fmod.rs?ref=72e6d51583ed5fa97ee06fe0259b82b28367874e", "patch": "@@ -1651,7 +1651,7 @@ impl<T, A: Allocator> Vec<T, A> {\n         // the hole, and the vector length is restored to the new length.\n         //\n         let len = self.len();\n-        let Range { start, end } = range.assert_len(len);\n+        let Range { start, end } = slice::range(range, ..len);\n \n         unsafe {\n             // set self.vec length's to start, to be safe in case Drain is leaked\n@@ -2037,11 +2037,11 @@ impl<T: Clone, A: Allocator> Vec<T, A> {\n     where\n         R: RangeBounds<usize>,\n     {\n-        let range = src.assert_len(self.len());\n+        let range = slice::range(src, ..self.len());\n         self.reserve(range.len());\n \n         // SAFETY:\n-        // - `assert_len` guarantees  that the given range is valid for indexing self\n+        // - `slice::range` guarantees  that the given range is valid for indexing self\n         unsafe {\n             self.spec_extend_from_within(range);\n         }"}, {"sha": "dbeb3912130061cb8ab951f672f06f1e133ad6ff", "filename": "library/core/src/ops/range.rs", "status": "modified", "additions": 0, "deletions": 90, "changes": 90, "blob_url": "https://github.com/rust-lang/rust/blob/72e6d51583ed5fa97ee06fe0259b82b28367874e/library%2Fcore%2Fsrc%2Fops%2Frange.rs", "raw_url": "https://github.com/rust-lang/rust/raw/72e6d51583ed5fa97ee06fe0259b82b28367874e/library%2Fcore%2Fsrc%2Fops%2Frange.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fops%2Frange.rs?ref=72e6d51583ed5fa97ee06fe0259b82b28367874e", "patch": "@@ -1,9 +1,5 @@\n use crate::fmt;\n use crate::hash::Hash;\n-use crate::slice::index::{\n-    slice_end_index_len_fail, slice_end_index_overflow_fail, slice_index_order_fail,\n-    slice_start_index_overflow_fail,\n-};\n \n /// An unbounded range (`..`).\n ///\n@@ -764,92 +760,6 @@ pub trait RangeBounds<T: ?Sized> {\n     #[stable(feature = \"collections_range\", since = \"1.28.0\")]\n     fn end_bound(&self) -> Bound<&T>;\n \n-    /// Performs bounds-checking of this range.\n-    ///\n-    /// The returned [`Range`] is safe to pass to [`slice::get_unchecked`] and\n-    /// [`slice::get_unchecked_mut`] for slices of the given length.\n-    ///\n-    /// [`slice::get_unchecked`]: ../../std/primitive.slice.html#method.get_unchecked\n-    /// [`slice::get_unchecked_mut`]: ../../std/primitive.slice.html#method.get_unchecked_mut\n-    ///\n-    /// # Panics\n-    ///\n-    /// Panics if the range would be out of bounds.\n-    ///\n-    /// # Examples\n-    ///\n-    /// ```\n-    /// #![feature(range_bounds_assert_len)]\n-    ///\n-    /// use std::ops::RangeBounds;\n-    ///\n-    /// let v = [10, 40, 30];\n-    /// assert_eq!(1..2, (1..2).assert_len(v.len()));\n-    /// assert_eq!(0..2, (..2).assert_len(v.len()));\n-    /// assert_eq!(1..3, (1..).assert_len(v.len()));\n-    /// ```\n-    ///\n-    /// Panics when [`Index::index`] would panic:\n-    ///\n-    /// ```should_panic\n-    /// #![feature(range_bounds_assert_len)]\n-    ///\n-    /// use std::ops::RangeBounds;\n-    ///\n-    /// (2..1).assert_len(3);\n-    /// ```\n-    ///\n-    /// ```should_panic\n-    /// #![feature(range_bounds_assert_len)]\n-    ///\n-    /// use std::ops::RangeBounds;\n-    ///\n-    /// (1..4).assert_len(3);\n-    /// ```\n-    ///\n-    /// ```should_panic\n-    /// #![feature(range_bounds_assert_len)]\n-    ///\n-    /// use std::ops::RangeBounds;\n-    ///\n-    /// (1..=usize::MAX).assert_len(3);\n-    /// ```\n-    ///\n-    /// [`Index::index`]: crate::ops::Index::index\n-    #[track_caller]\n-    #[unstable(feature = \"range_bounds_assert_len\", issue = \"76393\")]\n-    fn assert_len(self, len: usize) -> Range<usize>\n-    where\n-        Self: RangeBounds<usize>,\n-    {\n-        let start: Bound<&usize> = self.start_bound();\n-        let start = match start {\n-            Bound::Included(&start) => start,\n-            Bound::Excluded(start) => {\n-                start.checked_add(1).unwrap_or_else(|| slice_start_index_overflow_fail())\n-            }\n-            Bound::Unbounded => 0,\n-        };\n-\n-        let end: Bound<&usize> = self.end_bound();\n-        let end = match end {\n-            Bound::Included(end) => {\n-                end.checked_add(1).unwrap_or_else(|| slice_end_index_overflow_fail())\n-            }\n-            Bound::Excluded(&end) => end,\n-            Bound::Unbounded => len,\n-        };\n-\n-        if start > end {\n-            slice_index_order_fail(start, end);\n-        }\n-        if end > len {\n-            slice_end_index_len_fail(end, len);\n-        }\n-\n-        Range { start, end }\n-    }\n-\n     /// Returns `true` if `item` is contained in the range.\n     ///\n     /// # Examples"}, {"sha": "d20986bb724fc6e57f59c882f27a21d937293400", "filename": "library/core/src/slice/index.rs", "status": "modified", "additions": 101, "deletions": 4, "changes": 105, "blob_url": "https://github.com/rust-lang/rust/blob/72e6d51583ed5fa97ee06fe0259b82b28367874e/library%2Fcore%2Fsrc%2Fslice%2Findex.rs", "raw_url": "https://github.com/rust-lang/rust/raw/72e6d51583ed5fa97ee06fe0259b82b28367874e/library%2Fcore%2Fsrc%2Fslice%2Findex.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fslice%2Findex.rs?ref=72e6d51583ed5fa97ee06fe0259b82b28367874e", "patch": "@@ -37,28 +37,28 @@ fn slice_start_index_len_fail(index: usize, len: usize) -> ! {\n #[inline(never)]\n #[cold]\n #[track_caller]\n-pub(crate) fn slice_end_index_len_fail(index: usize, len: usize) -> ! {\n+fn slice_end_index_len_fail(index: usize, len: usize) -> ! {\n     panic!(\"range end index {} out of range for slice of length {}\", index, len);\n }\n \n #[inline(never)]\n #[cold]\n #[track_caller]\n-pub(crate) fn slice_index_order_fail(index: usize, end: usize) -> ! {\n+fn slice_index_order_fail(index: usize, end: usize) -> ! {\n     panic!(\"slice index starts at {} but ends at {}\", index, end);\n }\n \n #[inline(never)]\n #[cold]\n #[track_caller]\n-pub(crate) fn slice_start_index_overflow_fail() -> ! {\n+fn slice_start_index_overflow_fail() -> ! {\n     panic!(\"attempted to index slice from after maximum usize\");\n }\n \n #[inline(never)]\n #[cold]\n #[track_caller]\n-pub(crate) fn slice_end_index_overflow_fail() -> ! {\n+fn slice_end_index_overflow_fail() -> ! {\n     panic!(\"attempted to index slice up to maximum usize\");\n }\n \n@@ -449,3 +449,100 @@ unsafe impl<T> SliceIndex<[T]> for ops::RangeToInclusive<usize> {\n         (0..=self.end).index_mut(slice)\n     }\n }\n+\n+/// Performs bounds-checking of a range.\n+///\n+/// This method is similar to [`Index::index`] for slices, but it returns a\n+/// [`Range`] equivalent to `range`. You can use this method to turn any range\n+/// into `start` and `end` values.\n+///\n+/// `bounds` is the range of the slice to use for bounds-checking. It should\n+/// be a [`RangeTo`] range that ends at the length of the slice.\n+///\n+/// The returned [`Range`] is safe to pass to [`slice::get_unchecked`] and\n+/// [`slice::get_unchecked_mut`] for slices with the given range.\n+///\n+/// [`Range`]: ops::Range\n+/// [`RangeTo`]: ops::RangeTo\n+/// [`slice::get_unchecked`]: ../../std/primitive.slice.html#method.get_unchecked\n+/// [`slice::get_unchecked_mut`]: ../../std/primitive.slice.html#method.get_unchecked_mut\n+///\n+/// # Panics\n+///\n+/// Panics if `range` would be out of bounds.\n+///\n+/// # Examples\n+///\n+/// ```\n+/// #![feature(slice_range)]\n+///\n+/// use std::slice;\n+///\n+/// let v = [10, 40, 30];\n+/// assert_eq!(1..2, slice::range(1..2, ..v.len()));\n+/// assert_eq!(0..2, slice::range(..2, ..v.len()));\n+/// assert_eq!(1..3, slice::range(1.., ..v.len()));\n+/// ```\n+///\n+/// Panics when [`Index::index`] would panic:\n+///\n+/// ```should_panic\n+/// #![feature(slice_range)]\n+///\n+/// use std::slice;\n+///\n+/// slice::range(2..1, ..3);\n+/// ```\n+///\n+/// ```should_panic\n+/// #![feature(slice_range)]\n+///\n+/// use std::slice;\n+///\n+/// slice::range(1..4, ..3);\n+/// ```\n+///\n+/// ```should_panic\n+/// #![feature(slice_range)]\n+///\n+/// use std::slice;\n+///\n+/// slice::range(1..=usize::MAX, ..3);\n+/// ```\n+///\n+/// [`Index::index`]: ops::Index::index\n+#[track_caller]\n+#[unstable(feature = \"slice_range\", issue = \"76393\")]\n+pub fn range<R>(range: R, bounds: ops::RangeTo<usize>) -> ops::Range<usize>\n+where\n+    R: ops::RangeBounds<usize>,\n+{\n+    let len = bounds.end;\n+\n+    let start: ops::Bound<&usize> = range.start_bound();\n+    let start = match start {\n+        ops::Bound::Included(&start) => start,\n+        ops::Bound::Excluded(start) => {\n+            start.checked_add(1).unwrap_or_else(|| slice_start_index_overflow_fail())\n+        }\n+        ops::Bound::Unbounded => 0,\n+    };\n+\n+    let end: ops::Bound<&usize> = range.end_bound();\n+    let end = match end {\n+        ops::Bound::Included(end) => {\n+            end.checked_add(1).unwrap_or_else(|| slice_end_index_overflow_fail())\n+        }\n+        ops::Bound::Excluded(&end) => end,\n+        ops::Bound::Unbounded => len,\n+    };\n+\n+    if start > end {\n+        slice_index_order_fail(start, end);\n+    }\n+    if end > len {\n+        slice_end_index_len_fail(end, len);\n+    }\n+\n+    ops::Range { start, end }\n+}"}, {"sha": "80c2631c24566214b8e26645350f4615404f83cb", "filename": "library/core/src/slice/mod.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/72e6d51583ed5fa97ee06fe0259b82b28367874e/library%2Fcore%2Fsrc%2Fslice%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/72e6d51583ed5fa97ee06fe0259b82b28367874e/library%2Fcore%2Fsrc%2Fslice%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fslice%2Fmod.rs?ref=72e6d51583ed5fa97ee06fe0259b82b28367874e", "patch": "@@ -18,6 +18,7 @@ use crate::option::Option::{None, Some};\n use crate::ptr;\n use crate::result::Result;\n use crate::result::Result::{Err, Ok};\n+use crate::slice;\n \n #[unstable(\n     feature = \"slice_internals\",\n@@ -29,7 +30,7 @@ pub mod memchr;\n \n mod ascii;\n mod cmp;\n-pub(crate) mod index;\n+mod index;\n mod iter;\n mod raw;\n mod rotate;\n@@ -76,6 +77,9 @@ pub use sort::heapsort;\n #[stable(feature = \"slice_get_slice\", since = \"1.28.0\")]\n pub use index::SliceIndex;\n \n+#[unstable(feature = \"slice_range\", issue = \"76393\")]\n+pub use index::range;\n+\n #[lang = \"slice\"]\n #[cfg(not(test))]\n impl<T> [T] {\n@@ -3075,7 +3079,7 @@ impl<T> [T] {\n     where\n         T: Copy,\n     {\n-        let Range { start: src_start, end: src_end } = src.assert_len(self.len());\n+        let Range { start: src_start, end: src_end } = slice::range(src, ..self.len());\n         let count = src_end - src_start;\n         assert!(dest <= self.len() - count, \"dest is out of bounds\");\n         // SAFETY: the conditions for `ptr::copy` have all been checked above,"}, {"sha": "0e95d5ded92969c2d7356f90f5b4feafdfd2e5b0", "filename": "src/doc/unstable-book/src/library-features/range-bounds-assert-len.md", "status": "removed", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/1c2a949736a85810127b73dbc1006565689d6fe4/src%2Fdoc%2Funstable-book%2Fsrc%2Flibrary-features%2Frange-bounds-assert-len.md", "raw_url": "https://github.com/rust-lang/rust/raw/1c2a949736a85810127b73dbc1006565689d6fe4/src%2Fdoc%2Funstable-book%2Fsrc%2Flibrary-features%2Frange-bounds-assert-len.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flibrary-features%2Frange-bounds-assert-len.md?ref=1c2a949736a85810127b73dbc1006565689d6fe4", "patch": "@@ -1,10 +0,0 @@\n-# `range_bounds_assert_len`\n-\n-The tracking issue for this feature is: [#76393]\n-\n-------------------------\n-\n-This adds [`RangeBounds::assert_len`].\n-\n-[#76393]: https://github.com/rust-lang/rust/issues/76393\n-[`RangeBounds::assert_len`]: https://doc.rust-lang.org/nightly/std/ops/trait.RangeBounds.html#method.assert_len"}]}