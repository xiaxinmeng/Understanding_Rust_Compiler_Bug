{"sha": "326d9661b7cdeb0e429468b378fb2af716a3a955", "node_id": "MDY6Q29tbWl0NzI0NzEyOjMyNmQ5NjYxYjdjZGViMGU0Mjk0NjhiMzc4ZmIyYWY3MTZhM2E5NTU=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-05-02T13:15:37Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-05-02T13:15:37Z"}, "message": "auto merge of #6177 : gifnksm/rust/iter-chain, r=thestinger\n\n`T: Iterator<A>` and `U: Iterator<A>` should be able to `chain` whether `T` and `U` are same or not.", "tree": {"sha": "650bcfcdaeb3bd8319e1cef38eb0a725d11af35b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/650bcfcdaeb3bd8319e1cef38eb0a725d11af35b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/326d9661b7cdeb0e429468b378fb2af716a3a955", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/326d9661b7cdeb0e429468b378fb2af716a3a955", "html_url": "https://github.com/rust-lang/rust/commit/326d9661b7cdeb0e429468b378fb2af716a3a955", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/326d9661b7cdeb0e429468b378fb2af716a3a955/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d1f7220219c722665e15b88aeecfc78601fa4f22", "url": "https://api.github.com/repos/rust-lang/rust/commits/d1f7220219c722665e15b88aeecfc78601fa4f22", "html_url": "https://github.com/rust-lang/rust/commit/d1f7220219c722665e15b88aeecfc78601fa4f22"}, {"sha": "8a28970ed36a9259b6cab2ad464f358c2d0bbb6f", "url": "https://api.github.com/repos/rust-lang/rust/commits/8a28970ed36a9259b6cab2ad464f358c2d0bbb6f", "html_url": "https://github.com/rust-lang/rust/commit/8a28970ed36a9259b6cab2ad464f358c2d0bbb6f"}], "stats": {"total": 21, "additions": 15, "deletions": 6}, "files": [{"sha": "5e95485b2736086e8b0ec00a8fd869bc37766930", "filename": "src/libcore/iterator.rs", "status": "modified", "additions": 15, "deletions": 6, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/326d9661b7cdeb0e429468b378fb2af716a3a955/src%2Flibcore%2Fiterator.rs", "raw_url": "https://github.com/rust-lang/rust/raw/326d9661b7cdeb0e429468b378fb2af716a3a955/src%2Flibcore%2Fiterator.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fiterator.rs?ref=326d9661b7cdeb0e429468b378fb2af716a3a955", "patch": "@@ -29,7 +29,7 @@ pub trait Iterator<A> {\n ///\n /// In the future these will be default methods instead of a utility trait.\n pub trait IteratorUtil<A> {\n-    fn chain(self, other: Self) -> ChainIterator<Self>;\n+    fn chain<U: Iterator<A>>(self, other: U) -> ChainIterator<Self, U>;\n     fn zip<B, U: Iterator<B>>(self, other: U) -> ZipIterator<Self, U>;\n     // FIXME: #5898: should be called map\n     fn transform<'r, B>(self, f: &'r fn(A) -> B) -> MapIterator<'r, A, B, Self>;\n@@ -50,7 +50,7 @@ pub trait IteratorUtil<A> {\n /// In the future these will be default methods instead of a utility trait.\n impl<A, T: Iterator<A>> IteratorUtil<A> for T {\n     #[inline(always)]\n-    fn chain(self, other: T) -> ChainIterator<T> {\n+    fn chain<U: Iterator<A>>(self, other: U) -> ChainIterator<T, U> {\n         ChainIterator{a: self, b: other, flag: false}\n     }\n \n@@ -115,13 +115,13 @@ impl<A, T: Iterator<A>> IteratorUtil<A> for T {\n     }\n }\n \n-pub struct ChainIterator<T> {\n+pub struct ChainIterator<T, U> {\n     priv a: T,\n-    priv b: T,\n+    priv b: U,\n     priv flag: bool\n }\n \n-impl<A, T: Iterator<A>> Iterator<A> for ChainIterator<T> {\n+impl<A, T: Iterator<A>, U: Iterator<A>> Iterator<A> for ChainIterator<T, U> {\n     #[inline]\n     fn next(&mut self) -> Option<A> {\n         if self.flag {\n@@ -385,7 +385,7 @@ mod tests {\n     #[test]\n     fn test_iterator_chain() {\n         let xs = [0u, 1, 2, 3, 4, 5];\n-        let ys = [30, 40, 50, 60];\n+        let ys = [30u, 40, 50, 60];\n         let expected = [0, 1, 2, 3, 4, 5, 30, 40, 50, 60];\n         let mut it = xs.iter().chain(ys.iter());\n         let mut i = 0;\n@@ -394,6 +394,15 @@ mod tests {\n             i += 1;\n         }\n         assert_eq!(i, expected.len());\n+\n+        let ys = Counter::new(30u, 10).take(4);\n+        let mut it = xs.iter().transform(|&x| x).chain(ys);\n+        let mut i = 0;\n+        for it.advance |x: uint| {\n+            assert_eq!(x, expected[i]);\n+            i += 1;\n+        }\n+        assert_eq!(i, expected.len());\n     }\n \n     #[test]"}]}