{"sha": "2e3f0d845113995c26a9d59dd69146975a692516", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJlM2YwZDg0NTExMzk5NWMyNmE5ZDU5ZGQ2OTE0Njk3NWE2OTI1MTY=", "commit": {"author": {"name": "Jason Orendorff", "email": "jason.orendorff@gmail.com", "date": "2017-04-03T20:25:30Z"}, "committer": {"name": "Jason Orendorff", "email": "jason.orendorff@gmail.com", "date": "2017-04-04T18:40:26Z"}, "message": "add [T]::rsplit() and rsplit_mut() #41020", "tree": {"sha": "d1566ac7788b5de85896bd676c6dcbafc5572ecb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d1566ac7788b5de85896bd676c6dcbafc5572ecb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2e3f0d845113995c26a9d59dd69146975a692516", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2e3f0d845113995c26a9d59dd69146975a692516", "html_url": "https://github.com/rust-lang/rust/commit/2e3f0d845113995c26a9d59dd69146975a692516", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2e3f0d845113995c26a9d59dd69146975a692516/comments", "author": {"login": "jorendorff", "id": 283361, "node_id": "MDQ6VXNlcjI4MzM2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/283361?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jorendorff", "html_url": "https://github.com/jorendorff", "followers_url": "https://api.github.com/users/jorendorff/followers", "following_url": "https://api.github.com/users/jorendorff/following{/other_user}", "gists_url": "https://api.github.com/users/jorendorff/gists{/gist_id}", "starred_url": "https://api.github.com/users/jorendorff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jorendorff/subscriptions", "organizations_url": "https://api.github.com/users/jorendorff/orgs", "repos_url": "https://api.github.com/users/jorendorff/repos", "events_url": "https://api.github.com/users/jorendorff/events{/privacy}", "received_events_url": "https://api.github.com/users/jorendorff/received_events", "type": "User", "site_admin": true}, "committer": {"login": "jorendorff", "id": 283361, "node_id": "MDQ6VXNlcjI4MzM2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/283361?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jorendorff", "html_url": "https://github.com/jorendorff", "followers_url": "https://api.github.com/users/jorendorff/followers", "following_url": "https://api.github.com/users/jorendorff/following{/other_user}", "gists_url": "https://api.github.com/users/jorendorff/gists{/gist_id}", "starred_url": "https://api.github.com/users/jorendorff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jorendorff/subscriptions", "organizations_url": "https://api.github.com/users/jorendorff/orgs", "repos_url": "https://api.github.com/users/jorendorff/repos", "events_url": "https://api.github.com/users/jorendorff/events{/privacy}", "received_events_url": "https://api.github.com/users/jorendorff/received_events", "type": "User", "site_admin": true}, "parents": [{"sha": "5309a3e31d88def1f3ea966162ed4f81f161d500", "url": "https://api.github.com/repos/rust-lang/rust/commits/5309a3e31d88def1f3ea966162ed4f81f161d500", "html_url": "https://github.com/rust-lang/rust/commit/5309a3e31d88def1f3ea966162ed4f81f161d500"}], "stats": {"total": 219, "additions": 219, "deletions": 0}, "files": [{"sha": "52f33244695eaf858017b94ac4c28fa59cfdf860", "filename": "src/doc/unstable-book/src/SUMMARY.md", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/2e3f0d845113995c26a9d59dd69146975a692516/src%2Fdoc%2Funstable-book%2Fsrc%2FSUMMARY.md", "raw_url": "https://github.com/rust-lang/rust/raw/2e3f0d845113995c26a9d59dd69146975a692516/src%2Fdoc%2Funstable-book%2Fsrc%2FSUMMARY.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2FSUMMARY.md?ref=2e3f0d845113995c26a9d59dd69146975a692516", "patch": "@@ -171,6 +171,7 @@\n - [slice_concat_ext](slice-concat-ext.md)\n - [slice_get_slice](slice-get-slice.md)\n - [slice_patterns](slice-patterns.md)\n+- [slice_rsplit](slice-rsplit.md)\n - [sort_internals](sort-internals.md)\n - [sort_unstable](sort-unstable.md)\n - [specialization](specialization.md)"}, {"sha": "8c2954f7294e02b666e4ad15244be99048f15867", "filename": "src/doc/unstable-book/src/slice-rsplit.md", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/2e3f0d845113995c26a9d59dd69146975a692516/src%2Fdoc%2Funstable-book%2Fsrc%2Fslice-rsplit.md", "raw_url": "https://github.com/rust-lang/rust/raw/2e3f0d845113995c26a9d59dd69146975a692516/src%2Fdoc%2Funstable-book%2Fsrc%2Fslice-rsplit.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Fslice-rsplit.md?ref=2e3f0d845113995c26a9d59dd69146975a692516", "patch": "@@ -0,0 +1,10 @@\n+# `slice_rsplit`\n+\n+The tracking issue for this feature is: [#41020]\n+\n+[#41020]: https://github.com/rust-lang/rust/issues/41020\n+\n+------------------------\n+\n+The `slice_rsplit` feature enables two methods on slices:\n+`slice.rsplit(predicate)` and `slice.rsplit_mut(predicate)`."}, {"sha": "ff020f53e0e77f37aa41c2d9a173108e39fc566f", "filename": "src/libcollections/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/2e3f0d845113995c26a9d59dd69146975a692516/src%2Flibcollections%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2e3f0d845113995c26a9d59dd69146975a692516/src%2Flibcollections%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcollections%2Flib.rs?ref=2e3f0d845113995c26a9d59dd69146975a692516", "patch": "@@ -52,6 +52,7 @@\n #![feature(shared)]\n #![feature(slice_get_slice)]\n #![feature(slice_patterns)]\n+#![feature(slice_rsplit)]\n #![cfg_attr(not(test), feature(sort_unstable))]\n #![feature(specialization)]\n #![feature(staged_api)]"}, {"sha": "6cff315a6ccd9eb28083d2b1f5b2afa9e8dc2430", "filename": "src/libcollections/slice.rs", "status": "modified", "additions": 68, "deletions": 0, "changes": 68, "blob_url": "https://github.com/rust-lang/rust/blob/2e3f0d845113995c26a9d59dd69146975a692516/src%2Flibcollections%2Fslice.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2e3f0d845113995c26a9d59dd69146975a692516/src%2Flibcollections%2Fslice.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcollections%2Fslice.rs?ref=2e3f0d845113995c26a9d59dd69146975a692516", "patch": "@@ -115,6 +115,8 @@ pub use core::slice::{Iter, IterMut};\n pub use core::slice::{SplitMut, ChunksMut, Split};\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n pub use core::slice::{SplitN, RSplitN, SplitNMut, RSplitNMut};\n+#[unstable(feature = \"slice_rsplit\", issue = \"41020\")]\n+pub use core::slice::{RSplit, RSplitMut};\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n pub use core::slice::{from_raw_parts, from_raw_parts_mut};\n #[unstable(feature = \"slice_get_slice\", issue = \"35729\")]\n@@ -779,6 +781,72 @@ impl<T> [T] {\n         core_slice::SliceExt::split_mut(self, pred)\n     }\n \n+    /// Returns an iterator over subslices separated by elements that match\n+    /// `pred`, starting at the end of the slice and working backwards.\n+    /// The matched element is not contained in the subslices.\n+    ///\n+    /// # Examples\n+    ///\n+    /// ```\n+    /// #![feature(slice_rsplit)]\n+    ///\n+    /// let slice = [11, 22, 33, 0, 44, 55];\n+    /// let mut iter = slice.rsplit(|num| *num == 0);\n+    ///\n+    /// assert_eq!(iter.next().unwrap(), &[44, 55]);\n+    /// assert_eq!(iter.next().unwrap(), &[11, 22, 33]);\n+    /// assert_eq!(iter.next(), None);\n+    /// ```\n+    ///\n+    /// As with `split()`, if the first or last element is matched, an empty\n+    /// slice will be the first (or last) item returned by the iterator.\n+    ///\n+    /// ```\n+    /// #![feature(slice_rsplit)]\n+    ///\n+    /// let v = &[0, 1, 1, 2, 3, 5, 8];\n+    /// let mut it = v.rsplit(|n| *n % 2 == 0);\n+    /// assert_eq!(it.next().unwrap(), &[]);\n+    /// assert_eq!(it.next().unwrap(), &[3, 5]);\n+    /// assert_eq!(it.next().unwrap(), &[1, 1]);\n+    /// assert_eq!(it.next().unwrap(), &[]);\n+    /// assert_eq!(it.next(), None);\n+    /// ```\n+    #[unstable(feature = \"slice_rsplit\", issue = \"41020\")]\n+    #[inline]\n+    pub fn rsplit<F>(&self, pred: F) -> RSplit<T, F>\n+        where F: FnMut(&T) -> bool\n+    {\n+        core_slice::SliceExt::rsplit(self, pred)\n+    }\n+\n+    /// Returns an iterator over mutable subslices separated by elements that\n+    /// match `pred`, starting at the end of the slice and working\n+    /// backwards. The matched element is not contained in the subslices.\n+    ///\n+    /// # Examples\n+    ///\n+    /// ```\n+    /// #![feature(slice_rsplit)]\n+    ///\n+    /// let mut v = [100, 400, 300, 200, 600, 500];\n+    ///\n+    /// let mut count = 0;\n+    /// for group in v.rsplit_mut(|num| *num % 3 == 0) {\n+    ///     count += 1;\n+    ///     group[0] = count;\n+    /// }\n+    /// assert_eq!(v, [3, 400, 300, 2, 600, 1]);\n+    /// ```\n+    ///\n+    #[unstable(feature = \"slice_rsplit\", issue = \"41020\")]\n+    #[inline]\n+    pub fn rsplit_mut<F>(&mut self, pred: F) -> RSplitMut<T, F>\n+        where F: FnMut(&T) -> bool\n+    {\n+        core_slice::SliceExt::rsplit_mut(self, pred)\n+    }\n+\n     /// Returns an iterator over subslices separated by elements that match\n     /// `pred`, limited to returning at most `n` items. The matched element is\n     /// not contained in the subslices."}, {"sha": "1e0037755c1ab6f87b37dad9544c58ca1117d084", "filename": "src/libcore/slice/mod.rs", "status": "modified", "additions": 139, "deletions": 0, "changes": 139, "blob_url": "https://github.com/rust-lang/rust/blob/2e3f0d845113995c26a9d59dd69146975a692516/src%2Flibcore%2Fslice%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2e3f0d845113995c26a9d59dd69146975a692516/src%2Flibcore%2Fslice%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fslice%2Fmod.rs?ref=2e3f0d845113995c26a9d59dd69146975a692516", "patch": "@@ -81,6 +81,10 @@ pub trait SliceExt {\n     fn split<P>(&self, pred: P) -> Split<Self::Item, P>\n         where P: FnMut(&Self::Item) -> bool;\n \n+    #[unstable(feature = \"slice_rsplit\", issue = \"41020\")]\n+    fn rsplit<P>(&self, pred: P) -> RSplit<Self::Item, P>\n+        where P: FnMut(&Self::Item) -> bool;\n+\n     #[stable(feature = \"core\", since = \"1.6.0\")]\n     fn splitn<P>(&self, n: usize, pred: P) -> SplitN<Self::Item, P>\n         where P: FnMut(&Self::Item) -> bool;\n@@ -159,6 +163,10 @@ pub trait SliceExt {\n     fn split_mut<P>(&mut self, pred: P) -> SplitMut<Self::Item, P>\n         where P: FnMut(&Self::Item) -> bool;\n \n+    #[unstable(feature = \"slice_rsplit\", issue = \"41020\")]\n+    fn rsplit_mut<P>(&mut self, pred: P) -> RSplitMut<Self::Item, P>\n+        where P: FnMut(&Self::Item) -> bool;\n+\n     #[stable(feature = \"core\", since = \"1.6.0\")]\n     fn splitn_mut<P>(&mut self, n: usize, pred: P) -> SplitNMut<Self::Item, P>\n         where P: FnMut(&Self::Item) -> bool;\n@@ -293,6 +301,13 @@ impl<T> SliceExt for [T] {\n         }\n     }\n \n+    #[inline]\n+    fn rsplit<P>(&self, pred: P) -> RSplit<T, P>\n+        where P: FnMut(&T) -> bool\n+    {\n+        RSplit { inner: self.split(pred) }\n+    }\n+\n     #[inline]\n     fn splitn<P>(&self, n: usize, pred: P) -> SplitN<T, P>\n         where P: FnMut(&T) -> bool\n@@ -475,6 +490,13 @@ impl<T> SliceExt for [T] {\n         SplitMut { v: self, pred: pred, finished: false }\n     }\n \n+    #[inline]\n+    fn rsplit_mut<P>(&mut self, pred: P) -> RSplitMut<T, P>\n+        where P: FnMut(&T) -> bool\n+    {\n+        RSplitMut { inner: self.split_mut(pred) }\n+    }\n+\n     #[inline]\n     fn splitn_mut<P>(&mut self, n: usize, pred: P) -> SplitNMut<T, P>\n         where P: FnMut(&T) -> bool\n@@ -1735,6 +1757,123 @@ impl<'a, T, P> DoubleEndedIterator for SplitMut<'a, T, P> where\n #[unstable(feature = \"fused\", issue = \"35602\")]\n impl<'a, T, P> FusedIterator for SplitMut<'a, T, P> where P: FnMut(&T) -> bool {}\n \n+/// An iterator over subslices separated by elements that match a predicate\n+/// function, starting from the end of the slice.\n+///\n+/// This struct is created by the [`rsplit`] method on [slices].\n+///\n+/// [`rsplit`]: ../../std/primitive.slice.html#method.rsplit\n+/// [slices]: ../../std/primitive.slice.html\n+#[unstable(feature = \"slice_rsplit\", issue = \"41020\")]\n+#[derive(Clone)] // Is this correct, or does it incorrectly require `T: Clone`?\n+pub struct RSplit<'a, T:'a, P> where P: FnMut(&T) -> bool {\n+    inner: Split<'a, T, P>\n+}\n+\n+#[unstable(feature = \"slice_rsplit\", issue = \"41020\")]\n+impl<'a, T: 'a + fmt::Debug, P> fmt::Debug for RSplit<'a, T, P> where P: FnMut(&T) -> bool {\n+    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {\n+        f.debug_struct(\"RSplit\")\n+            .field(\"v\", &self.inner.v)\n+            .field(\"finished\", &self.inner.finished)\n+            .finish()\n+    }\n+}\n+\n+#[unstable(feature = \"slice_rsplit\", issue = \"41020\")]\n+impl<'a, T, P> Iterator for RSplit<'a, T, P> where P: FnMut(&T) -> bool {\n+    type Item = &'a [T];\n+\n+    #[inline]\n+    fn next(&mut self) -> Option<&'a [T]> {\n+        self.inner.next_back()\n+    }\n+\n+    #[inline]\n+    fn size_hint(&self) -> (usize, Option<usize>) {\n+        self.inner.size_hint()\n+    }\n+}\n+\n+#[unstable(feature = \"slice_rsplit\", issue = \"41020\")]\n+impl<'a, T, P> DoubleEndedIterator for RSplit<'a, T, P> where P: FnMut(&T) -> bool {\n+    #[inline]\n+    fn next_back(&mut self) -> Option<&'a [T]> {\n+        self.inner.next()\n+    }\n+}\n+\n+#[unstable(feature = \"slice_rsplit\", issue = \"41020\")]\n+impl<'a, T, P> SplitIter for RSplit<'a, T, P> where P: FnMut(&T) -> bool {\n+    #[inline]\n+    fn finish(&mut self) -> Option<&'a [T]> {\n+        self.inner.finish()\n+    }\n+}\n+\n+//#[unstable(feature = \"fused\", issue = \"35602\")]\n+#[unstable(feature = \"slice_rsplit\", issue = \"41020\")]\n+impl<'a, T, P> FusedIterator for RSplit<'a, T, P> where P: FnMut(&T) -> bool {}\n+\n+/// An iterator over the subslices of the vector which are separated\n+/// by elements that match `pred`, starting from the end of the slice.\n+///\n+/// This struct is created by the [`rsplit_mut`] method on [slices].\n+///\n+/// [`rsplit_mut`]: ../../std/primitive.slice.html#method.rsplit_mut\n+/// [slices]: ../../std/primitive.slice.html\n+#[unstable(feature = \"slice_rsplit\", issue = \"41020\")]\n+pub struct RSplitMut<'a, T:'a, P> where P: FnMut(&T) -> bool {\n+    inner: SplitMut<'a, T, P>\n+}\n+\n+#[unstable(feature = \"slice_rsplit\", issue = \"41020\")]\n+impl<'a, T: 'a + fmt::Debug, P> fmt::Debug for RSplitMut<'a, T, P> where P: FnMut(&T) -> bool {\n+    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {\n+        f.debug_struct(\"RSplitMut\")\n+            .field(\"v\", &self.inner.v)\n+            .field(\"finished\", &self.inner.finished)\n+            .finish()\n+    }\n+}\n+\n+#[unstable(feature = \"slice_rsplit\", issue = \"41020\")]\n+impl<'a, T, P> SplitIter for RSplitMut<'a, T, P> where P: FnMut(&T) -> bool {\n+    #[inline]\n+    fn finish(&mut self) -> Option<&'a mut [T]> {\n+        self.inner.finish()\n+    }\n+}\n+\n+#[unstable(feature = \"slice_rsplit\", issue = \"41020\")]\n+impl<'a, T, P> Iterator for RSplitMut<'a, T, P> where P: FnMut(&T) -> bool {\n+    type Item = &'a mut [T];\n+\n+    #[inline]\n+    fn next(&mut self) -> Option<&'a mut [T]> {\n+        self.inner.next_back()\n+    }\n+\n+    #[inline]\n+    fn size_hint(&self) -> (usize, Option<usize>) {\n+        self.inner.size_hint()\n+    }\n+}\n+\n+#[unstable(feature = \"slice_rsplit\", issue = \"41020\")]\n+impl<'a, T, P> DoubleEndedIterator for RSplitMut<'a, T, P> where\n+    P: FnMut(&T) -> bool,\n+{\n+    #[inline]\n+    fn next_back(&mut self) -> Option<&'a mut [T]> {\n+        self.inner.next()\n+    }\n+}\n+\n+//#[unstable(feature = \"fused\", issue = \"35602\")]\n+#[unstable(feature = \"slice_rsplit\", issue = \"41020\")]\n+impl<'a, T, P> FusedIterator for RSplitMut<'a, T, P> where P: FnMut(&T) -> bool {}\n+\n /// An private iterator over subslices separated by elements that\n /// match a predicate function, splitting at most a fixed number of\n /// times."}]}