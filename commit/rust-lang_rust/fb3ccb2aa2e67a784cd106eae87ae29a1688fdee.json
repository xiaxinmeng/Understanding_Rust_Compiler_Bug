{"sha": "fb3ccb2aa2e67a784cd106eae87ae29a1688fdee", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZiM2NjYjJhYTJlNjdhNzg0Y2QxMDZlYWU4N2FlMjlhMTY4OGZkZWU=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-08-15T21:31:00Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-08-15T21:47:28Z"}, "message": "Removed `ignore-test-compare-mode-nll` from borrowck-closures-two-mut-fail.rs\nby strengthening the tests there.", "tree": {"sha": "bf0ad5771357a5350d077bec9ee3347ff15e50b4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bf0ad5771357a5350d077bec9ee3347ff15e50b4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fb3ccb2aa2e67a784cd106eae87ae29a1688fdee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fb3ccb2aa2e67a784cd106eae87ae29a1688fdee", "html_url": "https://github.com/rust-lang/rust/commit/fb3ccb2aa2e67a784cd106eae87ae29a1688fdee", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fb3ccb2aa2e67a784cd106eae87ae29a1688fdee/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dd9f84f2d3c01d87b8e4d6f96a9c4b46d8e22992", "url": "https://api.github.com/repos/rust-lang/rust/commits/dd9f84f2d3c01d87b8e4d6f96a9c4b46d8e22992", "html_url": "https://github.com/rust-lang/rust/commit/dd9f84f2d3c01d87b8e4d6f96a9c4b46d8e22992"}], "stats": {"total": 103, "additions": 93, "deletions": 10}, "files": [{"sha": "c96799c85f20606117e71831f46ff5106b1ba233", "filename": "src/test/ui/borrowck/borrowck-closures-two-mut-fail.nll.stderr", "status": "added", "additions": 75, "deletions": 0, "changes": 75, "blob_url": "https://github.com/rust-lang/rust/blob/fb3ccb2aa2e67a784cd106eae87ae29a1688fdee/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-two-mut-fail.nll.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fb3ccb2aa2e67a784cd106eae87ae29a1688fdee/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-two-mut-fail.nll.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-two-mut-fail.nll.stderr?ref=fb3ccb2aa2e67a784cd106eae87ae29a1688fdee", "patch": "@@ -0,0 +1,75 @@\n+error[E0499]: cannot borrow `x` as mutable more than once at a time\n+  --> $DIR/borrowck-closures-two-mut-fail.rs:26:24\n+   |\n+LL |     let c1 = to_fn_mut(|| x = 4);\n+   |                        -- - first borrow occurs due to use of `x` in closure\n+   |                        |\n+   |                        first mutable borrow occurs here\n+LL |     let c2 = to_fn_mut(|| x = 5); //~ ERROR cannot borrow `x` as mutable more than once\n+   |                        ^^ - second borrow occurs due to use of `x` in closure\n+   |                        |\n+   |                        second mutable borrow occurs here\n+LL |     c1;\n+   |     -- borrow later used here\n+\n+error[E0499]: cannot borrow `x` as mutable more than once at a time\n+  --> $DIR/borrowck-closures-two-mut-fail.rs:37:24\n+   |\n+LL |     let c1 = to_fn_mut(|| set(&mut x));\n+   |                        --          - first borrow occurs due to use of `x` in closure\n+   |                        |\n+   |                        first mutable borrow occurs here\n+LL |     let c2 = to_fn_mut(|| set(&mut x)); //~ ERROR cannot borrow `x` as mutable more than once\n+   |                        ^^          - second borrow occurs due to use of `x` in closure\n+   |                        |\n+   |                        second mutable borrow occurs here\n+LL |     c1;\n+   |     -- borrow later used here\n+\n+error[E0499]: cannot borrow `x` as mutable more than once at a time\n+  --> $DIR/borrowck-closures-two-mut-fail.rs:44:24\n+   |\n+LL |     let c1 = to_fn_mut(|| x = 5);\n+   |                        -- - first borrow occurs due to use of `x` in closure\n+   |                        |\n+   |                        first mutable borrow occurs here\n+LL |     let c2 = to_fn_mut(|| set(&mut x)); //~ ERROR cannot borrow `x` as mutable more than once\n+   |                        ^^          - second borrow occurs due to use of `x` in closure\n+   |                        |\n+   |                        second mutable borrow occurs here\n+LL |     c1;\n+   |     -- borrow later used here\n+\n+error[E0499]: cannot borrow `x` as mutable more than once at a time\n+  --> $DIR/borrowck-closures-two-mut-fail.rs:51:24\n+   |\n+LL |     let c1 = to_fn_mut(|| x = 5);\n+   |                        -- - first borrow occurs due to use of `x` in closure\n+   |                        |\n+   |                        first mutable borrow occurs here\n+LL |     let c2 = to_fn_mut(|| { let _y = to_fn_mut(|| set(&mut x)); }); // (nested closure)\n+   |                        ^^                                  - second borrow occurs due to use of `x` in closure\n+   |                        |\n+   |                        second mutable borrow occurs here\n+LL |     //~^ ERROR cannot borrow `x` as mutable more than once\n+LL |     c1;\n+   |     -- borrow later used here\n+\n+error[E0499]: cannot borrow `x` as mutable more than once at a time\n+  --> $DIR/borrowck-closures-two-mut-fail.rs:63:24\n+   |\n+LL |     let c1 = to_fn_mut(|| set(&mut *x.f));\n+   |                        --           - first borrow occurs due to use of `x` in closure\n+   |                        |\n+   |                        first mutable borrow occurs here\n+LL |     let c2 = to_fn_mut(|| set(&mut *x.f));\n+   |                        ^^           - second borrow occurs due to use of `x` in closure\n+   |                        |\n+   |                        second mutable borrow occurs here\n+LL |     //~^ ERROR cannot borrow `x` as mutable more than once\n+LL |     c1;\n+   |     -- borrow later used here\n+\n+error: aborting due to 5 previous errors\n+\n+For more information about this error, try `rustc --explain E0499`."}, {"sha": "66ebd346dab62620e58bd893548db35b30b3980c", "filename": "src/test/ui/borrowck/borrowck-closures-two-mut-fail.rs", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/fb3ccb2aa2e67a784cd106eae87ae29a1688fdee/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-two-mut-fail.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fb3ccb2aa2e67a784cd106eae87ae29a1688fdee/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-two-mut-fail.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-two-mut-fail.rs?ref=fb3ccb2aa2e67a784cd106eae87ae29a1688fdee", "patch": "@@ -8,22 +8,23 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n-// ignore-compare-mode-nll\n-\n // Tests that two closures cannot simultaneously have mutable\n // access to the variable, whether that mutable access be used\n // for direct assignment or for taking mutable ref. Issue #6801.\n \n-// ignore-compare-mode-nll\n-\n #![feature(box_syntax)]\n \n+\n+\n+\n+\n fn to_fn_mut<F: FnMut()>(f: F) -> F { f }\n \n fn a() {\n     let mut x = 3;\n     let c1 = to_fn_mut(|| x = 4);\n     let c2 = to_fn_mut(|| x = 5); //~ ERROR cannot borrow `x` as mutable more than once\n+    c1;\n }\n \n fn set(x: &mut isize) {\n@@ -34,19 +35,22 @@ fn b() {\n     let mut x = 3;\n     let c1 = to_fn_mut(|| set(&mut x));\n     let c2 = to_fn_mut(|| set(&mut x)); //~ ERROR cannot borrow `x` as mutable more than once\n+    c1;\n }\n \n fn c() {\n     let mut x = 3;\n     let c1 = to_fn_mut(|| x = 5);\n     let c2 = to_fn_mut(|| set(&mut x)); //~ ERROR cannot borrow `x` as mutable more than once\n+    c1;\n }\n \n fn d() {\n     let mut x = 3;\n     let c1 = to_fn_mut(|| x = 5);\n     let c2 = to_fn_mut(|| { let _y = to_fn_mut(|| set(&mut x)); }); // (nested closure)\n     //~^ ERROR cannot borrow `x` as mutable more than once\n+    c1;\n }\n \n fn g() {\n@@ -58,6 +62,7 @@ fn g() {\n     let c1 = to_fn_mut(|| set(&mut *x.f));\n     let c2 = to_fn_mut(|| set(&mut *x.f));\n     //~^ ERROR cannot borrow `x` as mutable more than once\n+    c1;\n }\n \n fn main() {"}, {"sha": "59104cc4be9b9d0921cb0bd67ef7b1e46458e754", "filename": "src/test/ui/borrowck/borrowck-closures-two-mut-fail.stderr", "status": "modified", "additions": 9, "deletions": 6, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/fb3ccb2aa2e67a784cd106eae87ae29a1688fdee/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-two-mut-fail.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/fb3ccb2aa2e67a784cd106eae87ae29a1688fdee/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-two-mut-fail.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-two-mut-fail.stderr?ref=fb3ccb2aa2e67a784cd106eae87ae29a1688fdee", "patch": "@@ -9,11 +9,12 @@ LL |     let c2 = to_fn_mut(|| x = 5); //~ ERROR cannot borrow `x` as mutable mo\n    |                        ^^ - borrow occurs due to use of `x` in closure\n    |                        |\n    |                        second mutable borrow occurs here\n+LL |     c1;\n LL | }\n    | - first borrow ends here\n \n error[E0499]: cannot borrow `x` as mutable more than once at a time\n-  --> $DIR/borrowck-closures-two-mut-fail.rs:36:24\n+  --> $DIR/borrowck-closures-two-mut-fail.rs:37:24\n    |\n LL |     let c1 = to_fn_mut(|| set(&mut x));\n    |                        --          - previous borrow occurs due to use of `x` in closure\n@@ -23,11 +24,12 @@ LL |     let c2 = to_fn_mut(|| set(&mut x)); //~ ERROR cannot borrow `x` as muta\n    |                        ^^          - borrow occurs due to use of `x` in closure\n    |                        |\n    |                        second mutable borrow occurs here\n+LL |     c1;\n LL | }\n    | - first borrow ends here\n \n error[E0499]: cannot borrow `x` as mutable more than once at a time\n-  --> $DIR/borrowck-closures-two-mut-fail.rs:42:24\n+  --> $DIR/borrowck-closures-two-mut-fail.rs:44:24\n    |\n LL |     let c1 = to_fn_mut(|| x = 5);\n    |                        -- - previous borrow occurs due to use of `x` in closure\n@@ -37,11 +39,12 @@ LL |     let c2 = to_fn_mut(|| set(&mut x)); //~ ERROR cannot borrow `x` as muta\n    |                        ^^          - borrow occurs due to use of `x` in closure\n    |                        |\n    |                        second mutable borrow occurs here\n+LL |     c1;\n LL | }\n    | - first borrow ends here\n \n error[E0499]: cannot borrow `x` as mutable more than once at a time\n-  --> $DIR/borrowck-closures-two-mut-fail.rs:48:24\n+  --> $DIR/borrowck-closures-two-mut-fail.rs:51:24\n    |\n LL |     let c1 = to_fn_mut(|| x = 5);\n    |                        -- - previous borrow occurs due to use of `x` in closure\n@@ -51,12 +54,12 @@ LL |     let c2 = to_fn_mut(|| { let _y = to_fn_mut(|| set(&mut x)); }); // (nes\n    |                        ^^                                  - borrow occurs due to use of `x` in closure\n    |                        |\n    |                        second mutable borrow occurs here\n-LL |     //~^ ERROR cannot borrow `x` as mutable more than once\n+...\n LL | }\n    | - first borrow ends here\n \n error[E0499]: cannot borrow `x` as mutable more than once at a time\n-  --> $DIR/borrowck-closures-two-mut-fail.rs:59:24\n+  --> $DIR/borrowck-closures-two-mut-fail.rs:63:24\n    |\n LL |     let c1 = to_fn_mut(|| set(&mut *x.f));\n    |                        --           - previous borrow occurs due to use of `x` in closure\n@@ -66,7 +69,7 @@ LL |     let c2 = to_fn_mut(|| set(&mut *x.f));\n    |                        ^^           - borrow occurs due to use of `x` in closure\n    |                        |\n    |                        second mutable borrow occurs here\n-LL |     //~^ ERROR cannot borrow `x` as mutable more than once\n+...\n LL | }\n    | - first borrow ends here\n "}]}