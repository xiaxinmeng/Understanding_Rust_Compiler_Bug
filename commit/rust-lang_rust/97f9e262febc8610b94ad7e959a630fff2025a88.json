{"sha": "97f9e262febc8610b94ad7e959a630fff2025a88", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk3ZjllMjYyZmViYzg2MTBiOTRhZDdlOTU5YTYzMGZmZjIwMjVhODg=", "commit": {"author": {"name": "Steve Klabnik", "email": "steve@steveklabnik.com", "date": "2016-01-23T14:38:41Z"}, "committer": {"name": "Steve Klabnik", "email": "steve@steveklabnik.com", "date": "2016-01-23T14:38:41Z"}, "message": "Rollup merge of #31035 - nathankleyn:improve-visibility-of-entry-api, r=steveklabnik\n\nResponding to [a thread of discussion on the Rust subreddit](https://www.reddit.com/r/rust/comments/3racik/mutable_lifetimes_are_too_long_when_matching_an/),\nit was identified that the presence of the Entry API is not duly\npublicised. This commit aims to add some reasonable examples of\ncommon usages of this API to the main example secion of the `HashMap`\ndocumentation.\n\nThis is part of issue #29348.", "tree": {"sha": "349fb5b91002d7b4e2415a3d45b9416523acb301", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/349fb5b91002d7b4e2415a3d45b9416523acb301"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/97f9e262febc8610b94ad7e959a630fff2025a88", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/97f9e262febc8610b94ad7e959a630fff2025a88", "html_url": "https://github.com/rust-lang/rust/commit/97f9e262febc8610b94ad7e959a630fff2025a88", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/97f9e262febc8610b94ad7e959a630fff2025a88/comments", "author": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "committer": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "068fa97c4e18e9bf36e0c5ba530538cf59b9de81", "url": "https://api.github.com/repos/rust-lang/rust/commits/068fa97c4e18e9bf36e0c5ba530538cf59b9de81", "html_url": "https://github.com/rust-lang/rust/commit/068fa97c4e18e9bf36e0c5ba530538cf59b9de81"}, {"sha": "ccba72e660a6b1e183e7d96d1e51d5e4952ba053", "url": "https://api.github.com/repos/rust-lang/rust/commits/ccba72e660a6b1e183e7d96d1e51d5e4952ba053", "html_url": "https://github.com/rust-lang/rust/commit/ccba72e660a6b1e183e7d96d1e51d5e4952ba053"}], "stats": {"total": 29, "additions": 29, "deletions": 0}, "files": [{"sha": "43bf86a00399c8da07108937e10afdf3da3a2fd9", "filename": "src/libstd/collections/hash/map.rs", "status": "modified", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/97f9e262febc8610b94ad7e959a630fff2025a88/src%2Flibstd%2Fcollections%2Fhash%2Fmap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/97f9e262febc8610b94ad7e959a630fff2025a88/src%2Flibstd%2Fcollections%2Fhash%2Fmap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fcollections%2Fhash%2Fmap.rs?ref=97f9e262febc8610b94ad7e959a630fff2025a88", "patch": "@@ -272,6 +272,35 @@ fn test_resize_policy() {\n /// }\n /// ```\n ///\n+/// `HashMap` also implements an [`Entry API`](#method.entry), which allows\n+/// for more complex methods of getting, setting, updating and removing keys and\n+/// their values:\n+///\n+/// ```\n+/// use std::collections::HashMap;\n+///\n+/// // type inference lets us omit an explicit type signature (which\n+/// // would be `HashMap<&str, u8>` in this example).\n+/// let mut player_stats = HashMap::new();\n+///\n+/// fn random_stat_buff() -> u8 {\n+///   // could actually return some random value here - let's just return\n+///   // some fixed value for now\n+///   42\n+/// }\n+///\n+/// // insert a key only if it doesn't already exist\n+/// player_stats.entry(\"health\").or_insert(100);\n+///\n+/// // insert a key using a function that provides a new value only if it\n+/// // doesn't already exist\n+/// player_stats.entry(\"defence\").or_insert_with(random_stat_buff);\n+///\n+/// // update a key, guarding against the key possibly not being set\n+/// let stat = player_stats.entry(\"attack\").or_insert(100);\n+/// *stat += random_stat_buff();\n+/// ```\n+///\n /// The easiest way to use `HashMap` with a custom type as key is to derive `Eq` and `Hash`.\n /// We must also derive `PartialEq`.\n ///"}]}