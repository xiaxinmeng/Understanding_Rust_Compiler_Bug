{"sha": "2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJmMjRmYjRmMmM1ZDg3MDg1MzNhMWIwMTU1ZTFlODg0YmQ0YjJiYTI=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2017-12-31T11:02:55Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2017-12-31T11:03:29Z"}, "message": "Lexer: byte strings", "tree": {"sha": "a4ed4479231d2e5526618d9728d88fc3990b39e2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a4ed4479231d2e5526618d9728d88fc3990b39e2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2", "html_url": "https://github.com/rust-lang/rust/commit/2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f1a840cc385798fc2e3e9ac9ddb0dd57fd0ac509", "url": "https://api.github.com/repos/rust-lang/rust/commits/f1a840cc385798fc2e3e9ac9ddb0dd57fd0ac509", "html_url": "https://github.com/rust-lang/rust/commit/f1a840cc385798fc2e3e9ac9ddb0dd57fd0ac509"}], "stats": {"total": 66, "additions": 55, "deletions": 11}, "files": [{"sha": "c0564e9cf9785039b0928f06457787c57149fb36", "filename": "grammar.ron", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2/grammar.ron", "raw_url": "https://github.com/rust-lang/rust/raw/2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2/grammar.ron", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/grammar.ron?ref=2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2", "patch": "@@ -32,7 +32,12 @@ Grammar(\n         \"FAT_ARROW\",\n         \"NEQ\",\n         \"NOT\",\n-        \"CHAR\",\n         \"LIFETIME\",\n+        \"CHAR\",\n+        \"BYTE\",\n+        \"STRING\",\n+        \"RAW_STRING\",\n+        \"BYTE_STRING\",\n+        \"RAW_BYTE_STRING\",\n     ]\n )\n\\ No newline at end of file"}, {"sha": "283ce8feb37d71ba5bb727f0cb6252938b24dc2a", "filename": "src/lexer/strings.rs", "status": "modified", "additions": 26, "deletions": 5, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2/src%2Flexer%2Fstrings.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2/src%2Flexer%2Fstrings.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flexer%2Fstrings.rs?ref=2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2", "patch": "@@ -33,30 +33,51 @@ pub(crate) fn scan_byte_char_or_string(ptr: &mut Ptr) -> SyntaxKind {\n     match c {\n         '\\'' => {\n             scan_byte(ptr);\n-            CHAR\n+            BYTE\n         }\n         '\"' => {\n             scan_byte_string(ptr);\n-            CHAR\n+            BYTE_STRING\n         }\n         'r' => {\n             scan_raw_byte_string(ptr);\n-            CHAR\n+            RAW_BYTE_STRING\n         }\n         _ => unreachable!(),\n     }\n }\n \n fn scan_byte(ptr: &mut Ptr) {\n-\n+    if ptr.next_is('\\'') {\n+        ptr.bump();\n+        return\n+    }\n+    ptr.bump();\n+    if ptr.next_is('\\'') {\n+        ptr.bump();\n+        return\n+    }\n }\n \n fn scan_byte_string(ptr: &mut Ptr) {\n-\n+    while let Some(c) = ptr.bump() {\n+        if c == '\"' {\n+            return\n+        }\n+    }\n }\n \n fn scan_raw_byte_string(ptr: &mut Ptr) {\n+    if !ptr.next_is('\"') {\n+        return\n+    }\n+    ptr.bump();\n \n+    while let Some(c) = ptr.bump() {\n+        if c == '\"' {\n+            return\n+        }\n+    }\n }\n \n fn scan_char_or_byte(ptr: &mut Ptr) {"}, {"sha": "4a68acb31ff60ba78a51bef1cbec0695711180d4", "filename": "src/syntax_kinds.rs", "status": "modified", "additions": 14, "deletions": 4, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2/src%2Fsyntax_kinds.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2/src%2Fsyntax_kinds.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fsyntax_kinds.rs?ref=2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2", "patch": "@@ -33,10 +33,15 @@ pub const EQEQ: SyntaxKind = SyntaxKind(28);\n pub const FAT_ARROW: SyntaxKind = SyntaxKind(29);\n pub const NEQ: SyntaxKind = SyntaxKind(30);\n pub const NOT: SyntaxKind = SyntaxKind(31);\n-pub const CHAR: SyntaxKind = SyntaxKind(32);\n-pub const LIFETIME: SyntaxKind = SyntaxKind(33);\n+pub const LIFETIME: SyntaxKind = SyntaxKind(32);\n+pub const CHAR: SyntaxKind = SyntaxKind(33);\n+pub const BYTE: SyntaxKind = SyntaxKind(34);\n+pub const STRING: SyntaxKind = SyntaxKind(35);\n+pub const RAW_STRING: SyntaxKind = SyntaxKind(36);\n+pub const BYTE_STRING: SyntaxKind = SyntaxKind(37);\n+pub const RAW_BYTE_STRING: SyntaxKind = SyntaxKind(38);\n \n-static INFOS: [SyntaxInfo; 34] = [\n+static INFOS: [SyntaxInfo; 39] = [\n     SyntaxInfo { name: \"ERROR\" },\n     SyntaxInfo { name: \"IDENT\" },\n     SyntaxInfo { name: \"UNDERSCORE\" },\n@@ -69,8 +74,13 @@ static INFOS: [SyntaxInfo; 34] = [\n     SyntaxInfo { name: \"FAT_ARROW\" },\n     SyntaxInfo { name: \"NEQ\" },\n     SyntaxInfo { name: \"NOT\" },\n-    SyntaxInfo { name: \"CHAR\" },\n     SyntaxInfo { name: \"LIFETIME\" },\n+    SyntaxInfo { name: \"CHAR\" },\n+    SyntaxInfo { name: \"BYTE\" },\n+    SyntaxInfo { name: \"STRING\" },\n+    SyntaxInfo { name: \"RAW_STRING\" },\n+    SyntaxInfo { name: \"BYTE_STRING\" },\n+    SyntaxInfo { name: \"RAW_BYTE_STRING\" },\n ];\n \n pub(crate) fn syntax_info(kind: SyntaxKind) -> &'static SyntaxInfo {"}, {"sha": "1ffc7bb9d0c4483ec8129495f2bbfb7ba429bbf2", "filename": "tests/data/lexer/0008_strings.rs", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2/tests%2Fdata%2Flexer%2F0008_strings.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2/tests%2Fdata%2Flexer%2F0008_strings.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Flexer%2F0008_strings.rs?ref=2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2", "patch": "@@ -0,0 +1 @@\n+b'' b'x' b\"foo\" br\"\"\n\\ No newline at end of file"}, {"sha": "d4ff4b5581ba5e11aa955409df1de757dbe0ddd3", "filename": "tests/data/lexer/0008_strings.txt", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2/tests%2Fdata%2Flexer%2F0008_strings.txt", "raw_url": "https://github.com/rust-lang/rust/raw/2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2/tests%2Fdata%2Flexer%2F0008_strings.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Flexer%2F0008_strings.txt?ref=2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2", "patch": "@@ -0,0 +1,7 @@\n+BYTE 3 \"b\\'\\'\"\n+WHITESPACE 1 \" \"\n+BYTE 4 \"b\\'x\\'\"\n+WHITESPACE 1 \" \"\n+BYTE_STRING 6 \"b\\\"foo\\\"\"\n+WHITESPACE 1 \" \"\n+RAW_BYTE_STRING 4 \"br\\\"\\\"\""}, {"sha": "39b5f85fa25725fee797cee793946f8a1243dd13", "filename": "validation.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2/validation.md", "raw_url": "https://github.com/rust-lang/rust/raw/2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2/validation.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/validation.md?ref=2f24fb4f2c5d8708533a1b0155e1e884bd4b2ba2", "patch": "@@ -5,4 +5,4 @@ Fixmes:\n * Validate that float and integer literals use digits only of the appropriate\n   base, and are in range\n * Validation for unclosed char literal\n-\n+* Strings are completely wrong: more tests and comparison with libsyntax."}]}