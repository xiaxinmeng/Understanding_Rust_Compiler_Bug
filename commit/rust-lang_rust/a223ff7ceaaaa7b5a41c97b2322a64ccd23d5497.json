{"sha": "a223ff7ceaaaa7b5a41c97b2322a64ccd23d5497", "node_id": "C_kwDOAAsO6NoAKGEyMjNmZjdjZWFhYWE3YjVhNDFjOTdiMjMyMmE2NGNjZDIzZDU0OTc", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-02-25T23:46:28Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-02-25T23:46:28Z"}, "message": "Rollup merge of #108449 - fee1-dead-contrib:do_not_lint_unresolved, r=compiler-errors\n\nDo not lint ineffective unstable trait impl for unresolved trait", "tree": {"sha": "16e7855f1dc0e1b3b52c5e3f64f7b14aceb308d8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/16e7855f1dc0e1b3b52c5e3f64f7b14aceb308d8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a223ff7ceaaaa7b5a41c97b2322a64ccd23d5497", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJj+p3UCRBK7hj4Ov3rIwAAR4IIAJHxyzAeQ/OOEKr/OzTAI004\nt/qeQoabVXbydzDbvLwR38z744chpE+hQ37DQ6MqktuPW1UMp9efC71sNGPc1KhD\nq8F7M9e7jmFmzdZ1L1IbBZuWJhsrX72IiN5EWloFmBkb5KH+QmTMwDePGPvUk1wG\nW55HK/D6zeKz8BEdBF4Rj1SrjqgbcwsRzCxzQqdTApos9lFrceUKaWGAZLO14brH\noovfz335t1W/DgmXUSRVcMgoMRGqsBhXSd0CPgMwWOsIJCzYVqeth8dpMCibZB59\nexDerUPilbWM+znal40++bCevTeUuVXXBFRUO7gTkkz9C4y8kuzeBudUrvSR0oc=\n=s88o\n-----END PGP SIGNATURE-----\n", "payload": "tree 16e7855f1dc0e1b3b52c5e3f64f7b14aceb308d8\nparent 65eecc6b59f69bac45ddce8081f5edd23e74b17e\nparent ed34354bfa4f98da2883fdbba4453c571dde1ef7\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1677368788 +0100\ncommitter GitHub <noreply@github.com> 1677368788 +0100\n\nRollup merge of #108449 - fee1-dead-contrib:do_not_lint_unresolved, r=compiler-errors\n\nDo not lint ineffective unstable trait impl for unresolved trait\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a223ff7ceaaaa7b5a41c97b2322a64ccd23d5497", "html_url": "https://github.com/rust-lang/rust/commit/a223ff7ceaaaa7b5a41c97b2322a64ccd23d5497", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a223ff7ceaaaa7b5a41c97b2322a64ccd23d5497/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "65eecc6b59f69bac45ddce8081f5edd23e74b17e", "url": "https://api.github.com/repos/rust-lang/rust/commits/65eecc6b59f69bac45ddce8081f5edd23e74b17e", "html_url": "https://github.com/rust-lang/rust/commit/65eecc6b59f69bac45ddce8081f5edd23e74b17e"}, {"sha": "ed34354bfa4f98da2883fdbba4453c571dde1ef7", "url": "https://api.github.com/repos/rust-lang/rust/commits/ed34354bfa4f98da2883fdbba4453c571dde1ef7", "html_url": "https://github.com/rust-lang/rust/commit/ed34354bfa4f98da2883fdbba4453c571dde1ef7"}], "stats": {"total": 22, "additions": 21, "deletions": 1}, "files": [{"sha": "16194a6f196ea9d4eb402cc35c43400c62744a75", "filename": "compiler/rustc_passes/src/stability.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/a223ff7ceaaaa7b5a41c97b2322a64ccd23d5497/compiler%2Frustc_passes%2Fsrc%2Fstability.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a223ff7ceaaaa7b5a41c97b2322a64ccd23d5497/compiler%2Frustc_passes%2Fsrc%2Fstability.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Fstability.rs?ref=a223ff7ceaaaa7b5a41c97b2322a64ccd23d5497", "patch": "@@ -748,7 +748,10 @@ impl<'tcx> Visitor<'tcx> for Checker<'tcx> {\n                         let mut c = CheckTraitImplStable { tcx: self.tcx, fully_stable: true };\n                         c.visit_ty(self_ty);\n                         c.visit_trait_ref(t);\n-                        if c.fully_stable {\n+\n+                        // do not lint when the trait isn't resolved, since resolution error should\n+                        // be fixed first\n+                        if t.path.res != Res::Err && c.fully_stable {\n                             self.tcx.struct_span_lint_hir(\n                                 INEFFECTIVE_UNSTABLE_TRAIT_IMPL,\n                                 item.hir_id(),"}, {"sha": "818d228bc91c5b08828d718dde3862bf239a1ebd", "filename": "tests/ui/stability-attribute/unresolved_stability_lint.rs", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/a223ff7ceaaaa7b5a41c97b2322a64ccd23d5497/tests%2Fui%2Fstability-attribute%2Funresolved_stability_lint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a223ff7ceaaaa7b5a41c97b2322a64ccd23d5497/tests%2Fui%2Fstability-attribute%2Funresolved_stability_lint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fstability-attribute%2Funresolved_stability_lint.rs?ref=a223ff7ceaaaa7b5a41c97b2322a64ccd23d5497", "patch": "@@ -0,0 +1,8 @@\n+#![feature(staged_api)]\n+#![stable(feature = \"uwu\", since = \"1.0.0\")]\n+\n+#[unstable(feature = \"foo\", issue = \"none\")]\n+impl Foo for () {}\n+//~^ ERROR cannot find trait `Foo` in this scope\n+\n+fn main() {}"}, {"sha": "11d6abcaf361f27361bb11d9bed1b624bf0946f1", "filename": "tests/ui/stability-attribute/unresolved_stability_lint.stderr", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/a223ff7ceaaaa7b5a41c97b2322a64ccd23d5497/tests%2Fui%2Fstability-attribute%2Funresolved_stability_lint.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a223ff7ceaaaa7b5a41c97b2322a64ccd23d5497/tests%2Fui%2Fstability-attribute%2Funresolved_stability_lint.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fstability-attribute%2Funresolved_stability_lint.stderr?ref=a223ff7ceaaaa7b5a41c97b2322a64ccd23d5497", "patch": "@@ -0,0 +1,9 @@\n+error[E0405]: cannot find trait `Foo` in this scope\n+  --> $DIR/unresolved_stability_lint.rs:5:6\n+   |\n+LL | impl Foo for () {}\n+   |      ^^^ not found in this scope\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0405`."}]}