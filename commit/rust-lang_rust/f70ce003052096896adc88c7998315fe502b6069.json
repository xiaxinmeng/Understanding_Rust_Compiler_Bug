{"sha": "f70ce003052096896adc88c7998315fe502b6069", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY3MGNlMDAzMDUyMDk2ODk2YWRjODhjNzk5ODMxNWZlNTAyYjYwNjk=", "commit": {"author": {"name": "Seiichi Uchida", "email": "seuchida@gmail.com", "date": "2019-03-29T13:03:42Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-03-29T13:03:42Z"}, "message": "Merge pull request #3479 from sinkuu/issue_2995\n\nFix indexing panic on unicode whitespaces", "tree": {"sha": "ce656e37788008b626239f6070c586956d620499", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ce656e37788008b626239f6070c586956d620499"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f70ce003052096896adc88c7998315fe502b6069", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJcnheuCRBK7hj4Ov3rIwAAdHIIAIoC93AnhL2ES+YJSVUYSa6Y\ngaFGTmuvtQLwI+rM33N/gWeAPFgnUpP77XChVQN7PuUa3bLEDX9kGwBywhIb3fhD\nswcgzT6iOiDo2StvF0xwBeFQPyxj1kl6U1nUEUoZXLOIOlE2UX2qjkXndesHKzsd\nUpjAd6mZA/V8NTup/eQZ3kWQrEwmww0xcA+UqyD74rtFS0tieiGTo8VkQOkRwQXE\nH+o83kHK+mDRI0Dis6NXnunrOfoD/fm/R1zh8XmG8PQzqBjuFvnA1kNDi1SpuV4J\n6/9HMH+gFg7ATPO5EyKfywq9i8lBRLeqHK5n9rDswcyYPqb5IDGzAtgUFKzHZlg=\n=HF1I\n-----END PGP SIGNATURE-----\n", "payload": "tree ce656e37788008b626239f6070c586956d620499\nparent b4b80b6395b6c52d774be04a8ea8ae70b6ac995c\nparent c0ff894a22511eead2f521b5321f040cca8b1d5b\nauthor Seiichi Uchida <seuchida@gmail.com> 1553864622 +0900\ncommitter GitHub <noreply@github.com> 1553864622 +0900\n\nMerge pull request #3479 from sinkuu/issue_2995\n\nFix indexing panic on unicode whitespaces"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f70ce003052096896adc88c7998315fe502b6069", "html_url": "https://github.com/rust-lang/rust/commit/f70ce003052096896adc88c7998315fe502b6069", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f70ce003052096896adc88c7998315fe502b6069/comments", "author": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b4b80b6395b6c52d774be04a8ea8ae70b6ac995c", "url": "https://api.github.com/repos/rust-lang/rust/commits/b4b80b6395b6c52d774be04a8ea8ae70b6ac995c", "html_url": "https://github.com/rust-lang/rust/commit/b4b80b6395b6c52d774be04a8ea8ae70b6ac995c"}, {"sha": "c0ff894a22511eead2f521b5321f040cca8b1d5b", "url": "https://api.github.com/repos/rust-lang/rust/commits/c0ff894a22511eead2f521b5321f040cca8b1d5b", "html_url": "https://github.com/rust-lang/rust/commit/c0ff894a22511eead2f521b5321f040cca8b1d5b"}], "stats": {"total": 23, "additions": 21, "deletions": 2}, "files": [{"sha": "c75206b5ce685b02102607ad04971d7b4ff23851", "filename": "src/lists.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/f70ce003052096896adc88c7998315fe502b6069/src%2Flists.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f70ce003052096896adc88c7998315fe502b6069/src%2Flists.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flists.rs?ref=f70ce003052096896adc88c7998315fe502b6069", "patch": "@@ -651,7 +651,7 @@ pub fn get_comment_end(\n     if let Some(i) = block_open_index {\n         match post_snippet.find('/') {\n             Some(j) if j < i => block_open_index = None,\n-            _ if i > 0 && &post_snippet[i - 1..i] == \"/\" => block_open_index = None,\n+            _ if post_snippet[..i].chars().last() == Some('/') => block_open_index = None,\n             _ => (),\n         }\n     }\n@@ -692,8 +692,13 @@ pub fn has_extra_newline(post_snippet: &str, comment_end: usize) -> bool {\n         return false;\n     }\n \n+    let len_last = post_snippet[..comment_end]\n+        .chars()\n+        .last()\n+        .unwrap()\n+        .len_utf8();\n     // Everything from the separator to the next item.\n-    let test_snippet = &post_snippet[comment_end - 1..];\n+    let test_snippet = &post_snippet[comment_end - len_last..];\n     let first_newline = test_snippet\n         .find('\\n')\n         .unwrap_or_else(|| test_snippet.len());"}, {"sha": "accf7c3a1ad5d6846cc0d576f11cf4eb80e020a0", "filename": "tests/source/issue-2995.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/f70ce003052096896adc88c7998315fe502b6069/tests%2Fsource%2Fissue-2995.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f70ce003052096896adc88c7998315fe502b6069/tests%2Fsource%2Fissue-2995.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fissue-2995.rs?ref=f70ce003052096896adc88c7998315fe502b6069", "patch": "@@ -0,0 +1,7 @@\n+fn issue_2995() {\n+    // '\\u{2028}' is inserted in the code below.\n+\n+    [0, \u20281];\n+    [0, \u2028/* */ 1];\n+    \u2028[\u20280\u2028,\u20281\u2028]\u2028;\n+}"}, {"sha": "890da8def92f3806af025ab76fd597c650db42f4", "filename": "tests/target/issue-2995.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/f70ce003052096896adc88c7998315fe502b6069/tests%2Ftarget%2Fissue-2995.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f70ce003052096896adc88c7998315fe502b6069/tests%2Ftarget%2Fissue-2995.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-2995.rs?ref=f70ce003052096896adc88c7998315fe502b6069", "patch": "@@ -0,0 +1,7 @@\n+fn issue_2995() {\n+    // '\\u{2028}' is inserted in the code below.\n+\n+    [0, 1];\n+    [0, /* */ 1];\n+    [0, 1];\n+}"}]}