{"sha": "c2c2c4d6f3dae07134858266b7f037ea110a6f82", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMyYzJjNGQ2ZjNkYWUwNzEzNDg1ODI2NmI3ZjAzN2VhMTEwYTZmODI=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-12-17T03:16:43Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-12-17T03:16:43Z"}, "message": "auto merge of #10964 : cartazio/rust/gcc-detector, r=alexcrichton\n\n @alexcrichton and others: heres a proof of concept patch for configure that (for now is OS X only) checks at the very end of the configure script if ``cc``, ``gcc``, and ``g++`` possibly point to the same compiler or not.\r\n\r\nThe way its currently done is i call ```cc  --version```, ``gcc --version`` and ``g++ --version`` and check if theres any matchings for the word ``clang``, ``gcc`` or ``g++``.  So it doesn't rule out miss matched gcc versions or the like, but thats a bit more implausible I think.", "tree": {"sha": "75777f7b1681d95b097d9c6301bd5f5b074f8ef1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/75777f7b1681d95b097d9c6301bd5f5b074f8ef1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c2c2c4d6f3dae07134858266b7f037ea110a6f82", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c2c2c4d6f3dae07134858266b7f037ea110a6f82", "html_url": "https://github.com/rust-lang/rust/commit/c2c2c4d6f3dae07134858266b7f037ea110a6f82", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c2c2c4d6f3dae07134858266b7f037ea110a6f82/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "000cda611f8224ac780fa37432f869f425cd2bb7", "url": "https://api.github.com/repos/rust-lang/rust/commits/000cda611f8224ac780fa37432f869f425cd2bb7", "html_url": "https://github.com/rust-lang/rust/commit/000cda611f8224ac780fa37432f869f425cd2bb7"}, {"sha": "d9525530482f12f9814f46148ba02d3d1ecebee5", "url": "https://api.github.com/repos/rust-lang/rust/commits/d9525530482f12f9814f46148ba02d3d1ecebee5", "html_url": "https://github.com/rust-lang/rust/commit/d9525530482f12f9814f46148ba02d3d1ecebee5"}], "stats": {"total": 21, "additions": 21, "deletions": 0}, "files": [{"sha": "30bbb05cf5d10551d3f377f4b5c0b9a75e2745b3", "filename": "configure", "status": "modified", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/c2c2c4d6f3dae07134858266b7f037ea110a6f82/configure", "raw_url": "https://github.com/rust-lang/rust/raw/c2c2c4d6f3dae07134858266b7f037ea110a6f82/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=c2c2c4d6f3dae07134858266b7f037ea110a6f82", "patch": "@@ -559,6 +559,27 @@ then\n         step_msg \"on OS X 10.9, forcing use of clang\"\n         CFG_ENABLE_CLANG=1\n         putvar CFG_ENABLE_CLANG\n+    else \n+        # on OS X, with xcode 5 and newer, certain developers may have \n+        # cc, gcc and g++ point to a  mixture of clang and gcc\n+        # if so, this will create very strange build errors \n+        # this last stanza is to detect some such problems and save the future rust\n+        # contributor some time solving that issue.\n+        # this detection could be generalized to other OSes aside from OS X\n+        # but the issue seems most likely to happen on OS X\n+\n+        chk_cc () {\n+            $1 --version 2> /dev/null | grep -q $2\n+        }\n+        # check that gcc, cc and g++ all point to the same compiler.\n+        # note that for xcode 5, g++ points to clang, not clang++\n+        if !((chk_cc gcc clang  && chk_cc g++ clang) ||\n+            (chk_cc gcc gcc  &&( chk_cc g++ g++ || chk g++ gcc))) then\n+            err \"the gcc and g++ in your path point to different compilers. \n+Check which versions are in your path with  cc --version and g++ --version. \n+To resolve this problem, either fix your PATH  or run configure with --enable-clang\"\n+        fi\n+\n     fi\n fi\n "}]}