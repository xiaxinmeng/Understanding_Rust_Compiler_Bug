{"sha": "f9da2946d81a973b3c25aa5f4739ac7e05c27278", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY5ZGEyOTQ2ZDgxYTk3M2IzYzI1YWE1ZjQ3MzlhYzdlMDVjMjcyNzg=", "commit": {"author": {"name": "Frank", "email": "lifrank@grinnell.edu", "date": "2020-09-25T14:38:19Z"}, "committer": {"name": "Frank", "email": "lifrank@grinnell.edu", "date": "2020-09-25T16:09:04Z"}, "message": "update error message, refactor disallowed_method", "tree": {"sha": "55f58fe327e6a47476b83d7cab94fe325b846cf7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/55f58fe327e6a47476b83d7cab94fe325b846cf7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f9da2946d81a973b3c25aa5f4739ac7e05c27278", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f9da2946d81a973b3c25aa5f4739ac7e05c27278", "html_url": "https://github.com/rust-lang/rust/commit/f9da2946d81a973b3c25aa5f4739ac7e05c27278", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f9da2946d81a973b3c25aa5f4739ac7e05c27278/comments", "author": {"login": "ilknarf", "id": 30297768, "node_id": "MDQ6VXNlcjMwMjk3NzY4", "avatar_url": "https://avatars.githubusercontent.com/u/30297768?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ilknarf", "html_url": "https://github.com/ilknarf", "followers_url": "https://api.github.com/users/ilknarf/followers", "following_url": "https://api.github.com/users/ilknarf/following{/other_user}", "gists_url": "https://api.github.com/users/ilknarf/gists{/gist_id}", "starred_url": "https://api.github.com/users/ilknarf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ilknarf/subscriptions", "organizations_url": "https://api.github.com/users/ilknarf/orgs", "repos_url": "https://api.github.com/users/ilknarf/repos", "events_url": "https://api.github.com/users/ilknarf/events{/privacy}", "received_events_url": "https://api.github.com/users/ilknarf/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ilknarf", "id": 30297768, "node_id": "MDQ6VXNlcjMwMjk3NzY4", "avatar_url": "https://avatars.githubusercontent.com/u/30297768?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ilknarf", "html_url": "https://github.com/ilknarf", "followers_url": "https://api.github.com/users/ilknarf/followers", "following_url": "https://api.github.com/users/ilknarf/following{/other_user}", "gists_url": "https://api.github.com/users/ilknarf/gists{/gist_id}", "starred_url": "https://api.github.com/users/ilknarf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ilknarf/subscriptions", "organizations_url": "https://api.github.com/users/ilknarf/orgs", "repos_url": "https://api.github.com/users/ilknarf/repos", "events_url": "https://api.github.com/users/ilknarf/events{/privacy}", "received_events_url": "https://api.github.com/users/ilknarf/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3886edb05a2b570664f7249620766582e55a74aa", "url": "https://api.github.com/repos/rust-lang/rust/commits/3886edb05a2b570664f7249620766582e55a74aa", "html_url": "https://github.com/rust-lang/rust/commit/3886edb05a2b570664f7249620766582e55a74aa"}], "stats": {"total": 27, "additions": 13, "deletions": 14}, "files": [{"sha": "603f776e68887ce096ddde17586b8742de733442", "filename": "clippy_lints/src/disallowed_method.rs", "status": "modified", "additions": 8, "deletions": 9, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/f9da2946d81a973b3c25aa5f4739ac7e05c27278/clippy_lints%2Fsrc%2Fdisallowed_method.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f9da2946d81a973b3c25aa5f4739ac7e05c27278/clippy_lints%2Fsrc%2Fdisallowed_method.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fdisallowed_method.rs?ref=f9da2946d81a973b3c25aa5f4739ac7e05c27278", "patch": "@@ -27,7 +27,7 @@ declare_clippy_lint! {\n     /// ```\n     pub DISALLOWED_METHOD,\n     nursery,\n-    \"used disallowed method call\"\n+    \"use of a disallowed method call\"\n }\n \n #[derive(Clone, Debug)]\n@@ -55,18 +55,17 @@ impl<'tcx> LateLintPass<'tcx> for DisallowedMethod {\n \n             let method_call = cx.get_def_path(def_id);\n             if self.disallowed.contains(&method_call) {\n+                let method = method_call\n+                    .iter()\n+                    .map(|s| s.to_ident_string())\n+                    .collect::<Vec<_>>()\n+                    .join(\"::\");\n+\n                 span_lint(\n                     cx,\n                     DISALLOWED_METHOD,\n                     expr.span,\n-                    &format!(\n-                        \"Use of a disallowed method `{}`\",\n-                        method_call\n-                            .iter()\n-                            .map(|s| s.to_ident_string())\n-                            .collect::<Vec<_>>()\n-                            .join(\"::\"),\n-                    ),\n+                    &format!(\"use of a disallowed method `{}`\", method),\n                 );\n             }\n         }"}, {"sha": "ed91b5a6796d8a674ce82e8f54bb6e635a26ca79", "filename": "tests/ui-toml/toml_disallowed_method/conf_disallowed_method.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/f9da2946d81a973b3c25aa5f4739ac7e05c27278/tests%2Fui-toml%2Ftoml_disallowed_method%2Fconf_disallowed_method.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/f9da2946d81a973b3c25aa5f4739ac7e05c27278/tests%2Fui-toml%2Ftoml_disallowed_method%2Fconf_disallowed_method.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui-toml%2Ftoml_disallowed_method%2Fconf_disallowed_method.stderr?ref=f9da2946d81a973b3c25aa5f4739ac7e05c27278", "patch": "@@ -1,12 +1,12 @@\n-error: Use of a disallowed method `regex::re_unicode::Regex::is_match`\n+error: use of a disallowed method `regex::re_unicode::Regex::is_match`\n   --> $DIR/conf_disallowed_method.rs:10:5\n    |\n LL |     re.is_match(\"abc\");\n    |     ^^^^^^^^^^^^^^^^^^\n    |\n    = note: `-D clippy::disallowed-method` implied by `-D warnings`\n \n-error: Use of a disallowed method `core::iter::traits::iterator::Iterator::sum`\n+error: use of a disallowed method `core::iter::traits::iterator::Iterator::sum`\n   --> $DIR/conf_disallowed_method.rs:12:5\n    |\n LL |     a.iter().sum::<i32>();"}, {"sha": "40db1b946d88c927b3a4904273fc076bc39777f6", "filename": "tests/ui/disallowed_method.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/f9da2946d81a973b3c25aa5f4739ac7e05c27278/tests%2Fui%2Fdisallowed_method.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/f9da2946d81a973b3c25aa5f4739ac7e05c27278/tests%2Fui%2Fdisallowed_method.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fdisallowed_method.stderr?ref=f9da2946d81a973b3c25aa5f4739ac7e05c27278", "patch": "@@ -1,18 +1,18 @@\n-error: Use of a disallowed method `disallowed_method::Baz::bad_method`\n+error: use of a disallowed method `disallowed_method::Baz::bad_method`\n   --> $DIR/disallowed_method.rs:48:5\n    |\n LL |     b.bad_method();\n    |     ^^^^^^^^^^^^^^\n    |\n    = note: `-D clippy::disallowed-method` implied by `-D warnings`\n \n-error: Use of a disallowed method `disallowed_method::Baz::bad_method`\n+error: use of a disallowed method `disallowed_method::Baz::bad_method`\n   --> $DIR/disallowed_method.rs:49:5\n    |\n LL |     c.bad_method();\n    |     ^^^^^^^^^^^^^^\n \n-error: Use of a disallowed method `disallowed_method::Foo::bad_method`\n+error: use of a disallowed method `disallowed_method::Foo::bad_method`\n   --> $DIR/disallowed_method.rs:50:5\n    |\n LL |     f.bad_method();"}]}