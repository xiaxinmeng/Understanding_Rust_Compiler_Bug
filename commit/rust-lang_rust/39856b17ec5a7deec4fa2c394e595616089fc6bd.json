{"sha": "39856b17ec5a7deec4fa2c394e595616089fc6bd", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM5ODU2YjE3ZWM1YTdkZWVjNGZhMmMzOTRlNTk1NjE2MDg5ZmM2YmQ=", "commit": {"author": {"name": "Igor Aleksanov", "email": "popzxc@yandex.ru", "date": "2021-06-22T12:34:46Z"}, "committer": {"name": "Igor Aleksanov", "email": "popzxc@yandex.ru", "date": "2021-06-25T09:33:35Z"}, "message": "Improve lint message for match-same-arms lint\n\nSimplify error message producing & remove extra example", "tree": {"sha": "a47e756c819f8cc2f0abef488b14ff6dd1752f35", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a47e756c819f8cc2f0abef488b14ff6dd1752f35"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/39856b17ec5a7deec4fa2c394e595616089fc6bd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/39856b17ec5a7deec4fa2c394e595616089fc6bd", "html_url": "https://github.com/rust-lang/rust/commit/39856b17ec5a7deec4fa2c394e595616089fc6bd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/39856b17ec5a7deec4fa2c394e595616089fc6bd/comments", "author": {"login": "popzxc", "id": 12111581, "node_id": "MDQ6VXNlcjEyMTExNTgx", "avatar_url": "https://avatars.githubusercontent.com/u/12111581?v=4", "gravatar_id": "", "url": "https://api.github.com/users/popzxc", "html_url": "https://github.com/popzxc", "followers_url": "https://api.github.com/users/popzxc/followers", "following_url": "https://api.github.com/users/popzxc/following{/other_user}", "gists_url": "https://api.github.com/users/popzxc/gists{/gist_id}", "starred_url": "https://api.github.com/users/popzxc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/popzxc/subscriptions", "organizations_url": "https://api.github.com/users/popzxc/orgs", "repos_url": "https://api.github.com/users/popzxc/repos", "events_url": "https://api.github.com/users/popzxc/events{/privacy}", "received_events_url": "https://api.github.com/users/popzxc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "popzxc", "id": 12111581, "node_id": "MDQ6VXNlcjEyMTExNTgx", "avatar_url": "https://avatars.githubusercontent.com/u/12111581?v=4", "gravatar_id": "", "url": "https://api.github.com/users/popzxc", "html_url": "https://github.com/popzxc", "followers_url": "https://api.github.com/users/popzxc/followers", "following_url": "https://api.github.com/users/popzxc/following{/other_user}", "gists_url": "https://api.github.com/users/popzxc/gists{/gist_id}", "starred_url": "https://api.github.com/users/popzxc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/popzxc/subscriptions", "organizations_url": "https://api.github.com/users/popzxc/orgs", "repos_url": "https://api.github.com/users/popzxc/repos", "events_url": "https://api.github.com/users/popzxc/events{/privacy}", "received_events_url": "https://api.github.com/users/popzxc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "48fa1dc8bb843aaa7b912beed1666ca9c90f5363", "url": "https://api.github.com/repos/rust-lang/rust/commits/48fa1dc8bb843aaa7b912beed1666ca9c90f5363", "html_url": "https://github.com/rust-lang/rust/commit/48fa1dc8bb843aaa7b912beed1666ca9c90f5363"}], "stats": {"total": 17, "additions": 16, "deletions": 1}, "files": [{"sha": "386349d9f593f64e4825489eb52d2766b57c02fe", "filename": "clippy_lints/src/matches.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/39856b17ec5a7deec4fa2c394e595616089fc6bd/clippy_lints%2Fsrc%2Fmatches.rs", "raw_url": "https://github.com/rust-lang/rust/raw/39856b17ec5a7deec4fa2c394e595616089fc6bd/clippy_lints%2Fsrc%2Fmatches.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmatches.rs?ref=39856b17ec5a7deec4fa2c394e595616089fc6bd", "patch": "@@ -2266,7 +2266,8 @@ fn lint_match_arms<'tcx>(cx: &LateContext<'tcx>, expr: &Expr<'_>) {\n                             ),\n                         );\n                     } else {\n-                        diag.span_help(i.pat.span, &format!(\"consider refactoring into `{} | {}`\", lhs, rhs));\n+                        diag.span_help(i.pat.span, &format!(\"consider refactoring into `{} | {}`\", lhs, rhs,))\n+                            .help(\"...or consider changing the match arm bodies\");\n                     }\n                 },\n             );"}, {"sha": "e48451acfe8f5f4c67f76c65298e40b9a463e9f5", "filename": "tests/ui/match_same_arms.stderr", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/39856b17ec5a7deec4fa2c394e595616089fc6bd/tests%2Fui%2Fmatch_same_arms.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/39856b17ec5a7deec4fa2c394e595616089fc6bd/tests%2Fui%2Fmatch_same_arms.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmatch_same_arms.stderr?ref=39856b17ec5a7deec4fa2c394e595616089fc6bd", "patch": "@@ -32,6 +32,7 @@ help: consider refactoring into `(1, .., 3) | (.., 3)`\n    |\n LL |         (1, .., 3) => 42,\n    |         ^^^^^^^^^^\n+   = help: ...or consider changing the match arm bodies\n \n error: this `match` has identical arm bodies\n   --> $DIR/match_same_arms.rs:24:15\n@@ -49,6 +50,7 @@ help: consider refactoring into `42 | 51`\n    |\n LL |         42 => 1,\n    |         ^^\n+   = help: ...or consider changing the match arm bodies\n \n error: this `match` has identical arm bodies\n   --> $DIR/match_same_arms.rs:26:15\n@@ -66,6 +68,7 @@ help: consider refactoring into `41 | 52`\n    |\n LL |         41 => 2,\n    |         ^^\n+   = help: ...or consider changing the match arm bodies\n \n error: this `match` has identical arm bodies\n   --> $DIR/match_same_arms.rs:32:14\n@@ -83,6 +86,7 @@ help: consider refactoring into `1 | 2`\n    |\n LL |         1 => 2,\n    |         ^\n+   = help: ...or consider changing the match arm bodies\n \n error: this `match` has identical arm bodies\n   --> $DIR/match_same_arms.rs:33:14\n@@ -100,6 +104,7 @@ help: consider refactoring into `1 | 3`\n    |\n LL |         1 => 2,\n    |         ^\n+   = help: ...or consider changing the match arm bodies\n \n error: this `match` has identical arm bodies\n   --> $DIR/match_same_arms.rs:33:14\n@@ -117,6 +122,7 @@ help: consider refactoring into `2 | 3`\n    |\n LL |         2 => 2, //~ ERROR 2nd matched arms have same body\n    |         ^\n+   = help: ...or consider changing the match arm bodies\n \n error: this `match` has identical arm bodies\n   --> $DIR/match_same_arms.rs:50:55\n@@ -134,6 +140,7 @@ help: consider refactoring into `CommandInfo::BuiltIn { name, .. } | CommandInfo\n    |\n LL |                 CommandInfo::BuiltIn { name, .. } => name.to_string(),\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   = help: ...or consider changing the match arm bodies\n \n error: aborting due to 8 previous errors\n "}, {"sha": "e1ed12f9370877b8b0d59411ce345529cf64b84e", "filename": "tests/ui/match_same_arms2.stderr", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/39856b17ec5a7deec4fa2c394e595616089fc6bd/tests%2Fui%2Fmatch_same_arms2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/39856b17ec5a7deec4fa2c394e595616089fc6bd/tests%2Fui%2Fmatch_same_arms2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmatch_same_arms2.stderr?ref=39856b17ec5a7deec4fa2c394e595616089fc6bd", "patch": "@@ -53,6 +53,7 @@ help: consider refactoring into `42 | 51`\n    |\n LL |         42 => foo(),\n    |         ^^\n+   = help: ...or consider changing the match arm bodies\n \n error: this `match` has identical arm bodies\n   --> $DIR/match_same_arms2.rs:40:17\n@@ -70,6 +71,7 @@ help: consider refactoring into `Some(_) | None`\n    |\n LL |         Some(_) => 24,\n    |         ^^^^^^^\n+   = help: ...or consider changing the match arm bodies\n \n error: this `match` has identical arm bodies\n   --> $DIR/match_same_arms2.rs:62:28\n@@ -87,6 +89,7 @@ help: consider refactoring into `(Some(a), None) | (None, Some(a))`\n    |\n LL |         (Some(a), None) => bar(a),\n    |         ^^^^^^^^^^^^^^^\n+   = help: ...or consider changing the match arm bodies\n \n error: this `match` has identical arm bodies\n   --> $DIR/match_same_arms2.rs:68:26\n@@ -104,6 +107,7 @@ help: consider refactoring into `(Some(a), ..) | (.., Some(a))`\n    |\n LL |         (Some(a), ..) => bar(a),\n    |         ^^^^^^^^^^^^^\n+   = help: ...or consider changing the match arm bodies\n \n error: this `match` has identical arm bodies\n   --> $DIR/match_same_arms2.rs:102:29\n@@ -121,6 +125,7 @@ help: consider refactoring into `(Ok(x), Some(_)) | (Ok(_), Some(x))`\n    |\n LL |         (Ok(x), Some(_)) => println!(\"ok {}\", x),\n    |         ^^^^^^^^^^^^^^^^\n+   = help: ...or consider changing the match arm bodies\n    = note: this error originates in the macro `println` (in Nightly builds, run with -Z macro-backtrace for more info)\n \n error: this `match` has identical arm bodies\n@@ -139,6 +144,7 @@ help: consider refactoring into `Ok(3) | Ok(_)`\n    |\n LL |         Ok(3) => println!(\"ok\"),\n    |         ^^^^^\n+   = help: ...or consider changing the match arm bodies\n    = note: this error originates in the macro `println` (in Nightly builds, run with -Z macro-backtrace for more info)\n \n error: this `match` has identical arm bodies\n@@ -163,6 +169,7 @@ help: consider refactoring into `0 | 1`\n    |\n LL |         0 => {\n    |         ^\n+   = help: ...or consider changing the match arm bodies\n \n error: match expression looks like `matches!` macro\n   --> $DIR/match_same_arms2.rs:162:16"}]}