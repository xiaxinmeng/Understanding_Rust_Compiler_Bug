{"sha": "6fe13f62c1e73e6d102ce3673ad31d7195169560", "node_id": "C_kwDOAAsO6NoAKDZmZTEzZjYyYzFlNzNlNmQxMDJjZTM2NzNhZDMxZDcxOTUxNjk1NjA", "commit": {"author": {"name": "Wesley Wiser", "email": "wesleywiser@microsoft.com", "date": "2021-12-04T00:30:10Z"}, "committer": {"name": "Wesley Wiser", "email": "wesleywiser@microsoft.com", "date": "2021-12-04T01:25:21Z"}, "message": "Add test case that evals to `EvaluatedToOkModuloRegions`", "tree": {"sha": "672aae720b1d14aca984e308255d9bee577a2ace", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/672aae720b1d14aca984e308255d9bee577a2ace"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6fe13f62c1e73e6d102ce3673ad31d7195169560", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6fe13f62c1e73e6d102ce3673ad31d7195169560", "html_url": "https://github.com/rust-lang/rust/commit/6fe13f62c1e73e6d102ce3673ad31d7195169560", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6fe13f62c1e73e6d102ce3673ad31d7195169560/comments", "author": {"login": "wesleywiser", "id": 831192, "node_id": "MDQ6VXNlcjgzMTE5Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/831192?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wesleywiser", "html_url": "https://github.com/wesleywiser", "followers_url": "https://api.github.com/users/wesleywiser/followers", "following_url": "https://api.github.com/users/wesleywiser/following{/other_user}", "gists_url": "https://api.github.com/users/wesleywiser/gists{/gist_id}", "starred_url": "https://api.github.com/users/wesleywiser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wesleywiser/subscriptions", "organizations_url": "https://api.github.com/users/wesleywiser/orgs", "repos_url": "https://api.github.com/users/wesleywiser/repos", "events_url": "https://api.github.com/users/wesleywiser/events{/privacy}", "received_events_url": "https://api.github.com/users/wesleywiser/received_events", "type": "User", "site_admin": false}, "committer": {"login": "wesleywiser", "id": 831192, "node_id": "MDQ6VXNlcjgzMTE5Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/831192?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wesleywiser", "html_url": "https://github.com/wesleywiser", "followers_url": "https://api.github.com/users/wesleywiser/followers", "following_url": "https://api.github.com/users/wesleywiser/following{/other_user}", "gists_url": "https://api.github.com/users/wesleywiser/gists{/gist_id}", "starred_url": "https://api.github.com/users/wesleywiser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wesleywiser/subscriptions", "organizations_url": "https://api.github.com/users/wesleywiser/orgs", "repos_url": "https://api.github.com/users/wesleywiser/repos", "events_url": "https://api.github.com/users/wesleywiser/events{/privacy}", "received_events_url": "https://api.github.com/users/wesleywiser/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "98e9b3283e749d278b2ba99f6fb18b2e0e346f82", "url": "https://api.github.com/repos/rust-lang/rust/commits/98e9b3283e749d278b2ba99f6fb18b2e0e346f82", "html_url": "https://github.com/rust-lang/rust/commit/98e9b3283e749d278b2ba99f6fb18b2e0e346f82"}], "stats": {"total": 33, "additions": 32, "deletions": 1}, "files": [{"sha": "19131684a481b66df9fbd83745ca054e0aa8ce12", "filename": "src/test/ui/traits/issue-85360-eval-obligation-ice.rs", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/6fe13f62c1e73e6d102ce3673ad31d7195169560/src%2Ftest%2Fui%2Ftraits%2Fissue-85360-eval-obligation-ice.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6fe13f62c1e73e6d102ce3673ad31d7195169560/src%2Ftest%2Fui%2Ftraits%2Fissue-85360-eval-obligation-ice.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Fissue-85360-eval-obligation-ice.rs?ref=6fe13f62c1e73e6d102ce3673ad31d7195169560", "patch": "@@ -9,6 +9,10 @@ fn main() {\n     test::<MaskedStorage<GenericComp<Pos>>>(make());\n     //~^ ERROR evaluate(Binder(TraitPredicate(<MaskedStorage<GenericComp<Pos>> as std::marker::Sized>, polarity:Positive), [])) = Ok(EvaluatedToOk)\n     //~| ERROR evaluate(Binder(TraitPredicate(<MaskedStorage<GenericComp<Pos>> as std::marker::Sized>, polarity:Positive), [])) = Ok(EvaluatedToOk)\n+\n+    test::<MaskedStorage<GenericComp2<Pos>>>(make());\n+    //~^ ERROR evaluate(Binder(TraitPredicate(<MaskedStorage<GenericComp2<Pos>> as std::marker::Sized>, polarity:Positive), [])) = Ok(EvaluatedToOkModuloRegions)\n+    //~| ERROR evaluate(Binder(TraitPredicate(<MaskedStorage<GenericComp2<Pos>> as std::marker::Sized>, polarity:Positive), [])) = Ok(EvaluatedToOkModuloRegions)\n }\n \n #[rustc_evaluate_where_clauses]\n@@ -52,6 +56,15 @@ struct GenericComp<T> {\n impl<T: 'static> Component for GenericComp<T> {\n     type Storage = VecStorage;\n }\n+\n+struct GenericComp2<T> {\n+    _t: T,\n+}\n+\n+impl<T: 'static> Component for GenericComp2<T> where for<'a> &'a bool: 'a {\n+    type Storage = VecStorage;\n+}\n+\n struct ReadData {\n     pos_interpdata: ReadStorage<GenericComp<Pos>>,\n }"}, {"sha": "ebf977dd6805140376614a89a62a690030e795ac", "filename": "src/test/ui/traits/issue-85360-eval-obligation-ice.stderr", "status": "modified", "additions": 19, "deletions": 1, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/6fe13f62c1e73e6d102ce3673ad31d7195169560/src%2Ftest%2Fui%2Ftraits%2Fissue-85360-eval-obligation-ice.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/6fe13f62c1e73e6d102ce3673ad31d7195169560/src%2Ftest%2Fui%2Ftraits%2Fissue-85360-eval-obligation-ice.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Fissue-85360-eval-obligation-ice.stderr?ref=6fe13f62c1e73e6d102ce3673ad31d7195169560", "patch": "@@ -16,5 +16,23 @@ LL |     test::<MaskedStorage<GenericComp<Pos>>>(make());\n LL | fn test<T: Sized>(_: T) {}\n    |            ----- predicate\n \n-error: aborting due to 2 previous errors\n+error: evaluate(Binder(TraitPredicate(<MaskedStorage<GenericComp2<Pos>> as std::marker::Sized>, polarity:Positive), [])) = Ok(EvaluatedToOkModuloRegions)\n+  --> $DIR/issue-85360-eval-obligation-ice.rs:13:5\n+   |\n+LL |     test::<MaskedStorage<GenericComp2<Pos>>>(make());\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+...\n+LL | fn test<T: Sized>(_: T) {}\n+   |         - predicate\n+\n+error: evaluate(Binder(TraitPredicate(<MaskedStorage<GenericComp2<Pos>> as std::marker::Sized>, polarity:Positive), [])) = Ok(EvaluatedToOkModuloRegions)\n+  --> $DIR/issue-85360-eval-obligation-ice.rs:13:5\n+   |\n+LL |     test::<MaskedStorage<GenericComp2<Pos>>>(make());\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+...\n+LL | fn test<T: Sized>(_: T) {}\n+   |            ----- predicate\n+\n+error: aborting due to 4 previous errors\n "}]}