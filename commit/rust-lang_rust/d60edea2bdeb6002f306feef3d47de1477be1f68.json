{"sha": "d60edea2bdeb6002f306feef3d47de1477be1f68", "node_id": "C_kwDOAAsO6NoAKGQ2MGVkZWEyYmRlYjYwMDJmMzA2ZmVlZjNkNDdkZTE0NzdiZTFmNjg", "commit": {"author": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2022-01-12T00:00:00Z"}, "committer": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2022-01-12T17:51:32Z"}, "message": "Remove LLVM-style inline assembly from clippy", "tree": {"sha": "c53b4e634805ef07f22dd096d49790224e4d17ac", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c53b4e634805ef07f22dd096d49790224e4d17ac"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d60edea2bdeb6002f306feef3d47de1477be1f68", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d60edea2bdeb6002f306feef3d47de1477be1f68", "html_url": "https://github.com/rust-lang/rust/commit/d60edea2bdeb6002f306feef3d47de1477be1f68", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d60edea2bdeb6002f306feef3d47de1477be1f68/comments", "author": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "064eda47f126563e916156a618dc57972afeffa6", "url": "https://api.github.com/repos/rust-lang/rust/commits/064eda47f126563e916156a618dc57972afeffa6", "html_url": "https://github.com/rust-lang/rust/commit/064eda47f126563e916156a618dc57972afeffa6"}], "stats": {"total": 32, "additions": 3, "deletions": 29}, "files": [{"sha": "7319e95b0ac6037c0a8702d6442bf8933968d4c7", "filename": "src/tools/clippy/clippy_lints/src/dereference.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Fdereference.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Fdereference.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Fdereference.rs?ref=d60edea2bdeb6002f306feef3d47de1477be1f68", "patch": "@@ -449,7 +449,6 @@ fn is_linted_explicit_deref_position(parent: Option<Node<'_>>, child_id: HirId,\n         | ExprKind::Continue(..)\n         | ExprKind::Ret(..)\n         | ExprKind::InlineAsm(..)\n-        | ExprKind::LlvmInlineAsm(..)\n         | ExprKind::Struct(..)\n         | ExprKind::Repeat(..)\n         | ExprKind::Yield(..) => true,"}, {"sha": "b51496641b6ca77aa894aac603c75ad9af77b4a5", "filename": "src/tools/clippy/clippy_lints/src/entry.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Fentry.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Fentry.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Fentry.rs?ref=d60edea2bdeb6002f306feef3d47de1477be1f68", "patch": "@@ -504,7 +504,7 @@ impl<'tcx> Visitor<'tcx> for InsertSearcher<'_, 'tcx> {\n                     self.loops.pop();\n                 },\n                 ExprKind::Block(block, _) => self.visit_block(block),\n-                ExprKind::InlineAsm(_) | ExprKind::LlvmInlineAsm(_) => {\n+                ExprKind::InlineAsm(_) => {\n                     self.can_use_entry = false;\n                 },\n                 _ => {"}, {"sha": "55ff54b2e12d886d620dfdf8e36e23825c560fe7", "filename": "src/tools/clippy/clippy_lints/src/loops/never_loop.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Fnever_loop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Fnever_loop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Fnever_loop.rs?ref=d60edea2bdeb6002f306feef3d47de1477be1f68", "patch": "@@ -181,7 +181,6 @@ fn never_loop_expr(expr: &Expr<'_>, main_loop_id: HirId) -> NeverLoopResult {\n         ExprKind::Struct(_, _, None)\n         | ExprKind::Yield(_, _)\n         | ExprKind::Closure(_, _, _, _, _)\n-        | ExprKind::LlvmInlineAsm(_)\n         | ExprKind::Path(_)\n         | ExprKind::ConstBlock(_)\n         | ExprKind::Lit(_)"}, {"sha": "613b6976a13c75b8f83a094fff531a87b7cfc89e", "filename": "src/tools/clippy/clippy_lints/src/suspicious_operation_groupings.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Fsuspicious_operation_groupings.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Fsuspicious_operation_groupings.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Fsuspicious_operation_groupings.rs?ref=d60edea2bdeb6002f306feef3d47de1477be1f68", "patch": "@@ -567,7 +567,6 @@ fn ident_difference_expr_with_base_location(\n         | (Repeat(_, _), Repeat(_, _))\n         | (Struct(_), Struct(_))\n         | (MacCall(_), MacCall(_))\n-        | (LlvmInlineAsm(_), LlvmInlineAsm(_))\n         | (InlineAsm(_), InlineAsm(_))\n         | (Ret(_), Ret(_))\n         | (Continue(_), Continue(_))"}, {"sha": "b0085da2206b90c5d4dba6f25fea2ad1f357ce7e", "filename": "src/tools/clippy/clippy_lints/src/utils/author.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Futils%2Fauthor.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Futils%2Fauthor.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Futils%2Fauthor.rs?ref=d60edea2bdeb6002f306feef3d47de1477be1f68", "patch": "@@ -547,10 +547,6 @@ impl<'a, 'tcx> PrintVisitor<'a, 'tcx> {\n                 kind!(\"InlineAsm(_)\");\n                 out!(\"// unimplemented: `ExprKind::InlineAsm` is not further destructured at the moment\");\n             },\n-            ExprKind::LlvmInlineAsm(_) => {\n-                kind!(\"LlvmInlineAsm(_)\");\n-                out!(\"// unimplemented: `ExprKind::LlvmInlineAsm` is not further destructured at the moment\");\n-            },\n             ExprKind::Struct(qpath, fields, base) => {\n                 bind!(self, qpath, fields);\n                 opt_bind!(self, base);"}, {"sha": "fd3e51c2b32c3716f630e2c314f8a0a13213f07e", "filename": "src/tools/clippy/clippy_lints/src/utils/inspector.rs", "status": "modified", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Futils%2Finspector.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Futils%2Finspector.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Futils%2Finspector.rs?ref=d60edea2bdeb6002f306feef3d47de1477be1f68", "patch": "@@ -304,19 +304,6 @@ fn print_expr(cx: &LateContext<'_>, expr: &hir::Expr<'_>, indent: usize) {\n                 }\n             }\n         },\n-        hir::ExprKind::LlvmInlineAsm(asm) => {\n-            let inputs = &asm.inputs_exprs;\n-            let outputs = &asm.outputs_exprs;\n-            println!(\"{}LlvmInlineAsm\", ind);\n-            println!(\"{}inputs:\", ind);\n-            for e in inputs.iter() {\n-                print_expr(cx, e, indent + 1);\n-            }\n-            println!(\"{}outputs:\", ind);\n-            for e in outputs.iter() {\n-                print_expr(cx, e, indent + 1);\n-            }\n-        },\n         hir::ExprKind::Struct(path, fields, ref base) => {\n             println!(\"{}Struct\", ind);\n             println!(\"{}path: {:?}\", ind, path);"}, {"sha": "fd18ba8842fbca7727d1d67ec1a9b1123bc88560", "filename": "src/tools/clippy/clippy_utils/src/eager_or_lazy.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Feager_or_lazy.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Feager_or_lazy.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Feager_or_lazy.rs?ref=d60edea2bdeb6002f306feef3d47de1477be1f68", "patch": "@@ -175,7 +175,6 @@ fn expr_eagerness(cx: &LateContext<'tcx>, e: &'tcx Expr<'_>) -> EagernessSuggest\n                 | ExprKind::Continue(_)\n                 | ExprKind::Ret(_)\n                 | ExprKind::InlineAsm(_)\n-                | ExprKind::LlvmInlineAsm(_)\n                 | ExprKind::Yield(..)\n                 | ExprKind::Err => {\n                     self.eagerness = ForceNoChange;"}, {"sha": "c4f19f6d966c1f07e558a13541435f6e788089e6", "filename": "src/tools/clippy/clippy_utils/src/hir_utils.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Fhir_utils.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Fhir_utils.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Fhir_utils.rs?ref=d60edea2bdeb6002f306feef3d47de1477be1f68", "patch": "@@ -685,7 +685,7 @@ impl<'a, 'tcx> SpanlessHash<'a, 'tcx> {\n                 }\n                 self.hash_pat(pat);\n             },\n-            ExprKind::LlvmInlineAsm(..) | ExprKind::Err => {},\n+            ExprKind::Err => {},\n             ExprKind::Lit(ref l) => {\n                 l.node.hash(&mut self.s);\n             },"}, {"sha": "79219ce19ac35e333678b1e284bea513617e2581", "filename": "src/tools/clippy/clippy_utils/src/lib.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Flib.rs?ref=d60edea2bdeb6002f306feef3d47de1477be1f68", "patch": "@@ -777,8 +777,7 @@ pub fn can_move_expr_to_closure_no_visit(\n         | ExprKind::Continue(_)\n         | ExprKind::Ret(_)\n         | ExprKind::Yield(..)\n-        | ExprKind::InlineAsm(_)\n-        | ExprKind::LlvmInlineAsm(_) => false,\n+        | ExprKind::InlineAsm(_) => false,\n         // Accessing a field of a local value can only be done if the type isn't\n         // partially moved.\n         ExprKind::Field("}, {"sha": "5cf33155cd2ee174b034431b3ddcb9c199b04ab5", "filename": "src/tools/clippy/clippy_utils/src/qualify_min_const_fn.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Fqualify_min_const_fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Fqualify_min_const_fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Fqualify_min_const_fn.rs?ref=d60edea2bdeb6002f306feef3d47de1477be1f68", "patch": "@@ -222,8 +222,6 @@ fn check_statement(tcx: TyCtxt<'tcx>, body: &Body<'tcx>, def_id: DefId, statemen\n         // just an assignment\n         StatementKind::SetDiscriminant { place, .. } => check_place(tcx, **place, span, body),\n \n-        StatementKind::LlvmInlineAsm { .. } => Err((span, \"cannot use inline assembly in const fn\".into())),\n-\n         StatementKind::CopyNonOverlapping(box rustc_middle::mir::CopyNonOverlapping { dst, src, count }) => {\n             check_operand(tcx, dst, span, body)?;\n             check_operand(tcx, src, span, body)?;"}, {"sha": "cedc16dea31fb1b7ff919772865a9a149980b0de", "filename": "src/tools/clippy/clippy_utils/src/sugg.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Fsugg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d60edea2bdeb6002f306feef3d47de1477be1f68/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Fsugg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Fsugg.rs?ref=d60edea2bdeb6002f306feef3d47de1477be1f68", "patch": "@@ -147,7 +147,6 @@ impl<'a> Sugg<'a> {\n             | hir::ExprKind::Field(..)\n             | hir::ExprKind::Index(..)\n             | hir::ExprKind::InlineAsm(..)\n-            | hir::ExprKind::LlvmInlineAsm(..)\n             | hir::ExprKind::ConstBlock(..)\n             | hir::ExprKind::Lit(..)\n             | hir::ExprKind::Loop(..)\n@@ -205,7 +204,6 @@ impl<'a> Sugg<'a> {\n             | ast::ExprKind::ForLoop(..)\n             | ast::ExprKind::Index(..)\n             | ast::ExprKind::InlineAsm(..)\n-            | ast::ExprKind::LlvmInlineAsm(..)\n             | ast::ExprKind::ConstBlock(..)\n             | ast::ExprKind::Lit(..)\n             | ast::ExprKind::Loop(..)"}]}