{"sha": "883b8199ca7c711b1789c0ffc4a82fadf303ed13", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg4M2I4MTk5Y2E3YzcxMWIxNzg5YzBmZmM0YTgyZmFkZjMwM2VkMTM=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-10-28T08:38:46Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-10-28T08:38:46Z"}, "message": "Rollup merge of #55191 - GuillaumeGomez:fix-sub-variant, r=QuietMisdreavus\n\nFix sub-variant doc display\n\nFixes #54758.\n\n<img width=\"1440\" alt=\"screen shot 2018-10-19 at 01 34 11\" src=\"https://user-images.githubusercontent.com/3050060/47189939-43481d00-d33f-11e8-868f-cf479fc79e62.png\">\n\nr? @QuietMisdreavus", "tree": {"sha": "57ed530633058c744529ad1061cdfbf074d923b9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/57ed530633058c744529ad1061cdfbf074d923b9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/883b8199ca7c711b1789c0ffc4a82fadf303ed13", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJb1XWWCRBK7hj4Ov3rIwAAdHIIAAtMW3PeyHH/jTeFV4HVhS8S\nyLVXGWh4yvxRA+73JCYTMs1aYseMMATMpHVdxN6VwIHNb2lSlce++OgObruzhiRM\n/hQe9SYVHwQsbOF3I7R3R/wjMu7W58m8lN8fjIdAbYMBic8RcIviFga1VB2MHR+Y\nVaW5Ye0ZbPtcGf/WuItaOT+HM6S9pZRtkqOdMkYTKna1+E5FjiRKLos1k7y9Hh0E\nQRlrA8Bx88yqVaQXFS4qmNi7JIi32gegsD179H1KAvtRwtzE3S6Ia30VpWSK/FF+\nZLpDIQaraa0wfn3REEMUMZCDKHYcahHXM4afINFMrkY+9RXlWjXCGZcUqCTRAig=\n=rYx9\n-----END PGP SIGNATURE-----\n", "payload": "tree 57ed530633058c744529ad1061cdfbf074d923b9\nparent b9763de9b544ef5d01928eafdf5194850e94f340\nparent 2fd378b82b14f2746462018e8510e15a079818a0\nauthor kennytm <kennytm@gmail.com> 1540715926 +0800\ncommitter GitHub <noreply@github.com> 1540715926 +0800\n\nRollup merge of #55191 - GuillaumeGomez:fix-sub-variant, r=QuietMisdreavus\n\nFix sub-variant doc display\n\nFixes #54758.\n\n<img width=\"1440\" alt=\"screen shot 2018-10-19 at 01 34 11\" src=\"https://user-images.githubusercontent.com/3050060/47189939-43481d00-d33f-11e8-868f-cf479fc79e62.png\">\n\nr? @QuietMisdreavus\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/883b8199ca7c711b1789c0ffc4a82fadf303ed13", "html_url": "https://github.com/rust-lang/rust/commit/883b8199ca7c711b1789c0ffc4a82fadf303ed13", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/883b8199ca7c711b1789c0ffc4a82fadf303ed13/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b9763de9b544ef5d01928eafdf5194850e94f340", "url": "https://api.github.com/repos/rust-lang/rust/commits/b9763de9b544ef5d01928eafdf5194850e94f340", "html_url": "https://github.com/rust-lang/rust/commit/b9763de9b544ef5d01928eafdf5194850e94f340"}, {"sha": "2fd378b82b14f2746462018e8510e15a079818a0", "url": "https://api.github.com/repos/rust-lang/rust/commits/2fd378b82b14f2746462018e8510e15a079818a0", "html_url": "https://github.com/rust-lang/rust/commit/2fd378b82b14f2746462018e8510e15a079818a0"}], "stats": {"total": 56, "additions": 39, "deletions": 17}, "files": [{"sha": "0fc2473725a16c95db172dd25d4c5217d223cf41", "filename": "src/librustdoc/html/render.rs", "status": "modified", "additions": 8, "deletions": 9, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/883b8199ca7c711b1789c0ffc4a82fadf303ed13/src%2Flibrustdoc%2Fhtml%2Frender.rs", "raw_url": "https://github.com/rust-lang/rust/raw/883b8199ca7c711b1789c0ffc4a82fadf303ed13/src%2Flibrustdoc%2Fhtml%2Frender.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender.rs?ref=883b8199ca7c711b1789c0ffc4a82fadf303ed13", "patch": "@@ -3379,10 +3379,10 @@ fn item_enum(w: &mut fmt::Formatter, cx: &Context, it: &clean::Item,\n                 let variant_id = cx.derive_id(format!(\"{}.{}.fields\",\n                                                    ItemType::Variant,\n                                                    variant.name.as_ref().unwrap()));\n-                write!(w, \"<span class='docblock autohide sub-variant' id='{id}'>\",\n+                write!(w, \"<span class='autohide sub-variant' id='{id}'>\",\n                        id = variant_id)?;\n-                write!(w, \"<h3 class='fields'>Fields of <code>{name}</code></h3>\\n\n-                           <table>\", name = variant.name.as_ref().unwrap())?;\n+                write!(w, \"<h3>Fields of <b>{name}</b></h3><div>\",\n+                       name = variant.name.as_ref().unwrap())?;\n                 for field in &s.fields {\n                     use clean::StructFieldItem;\n                     if let StructFieldItem(ref ty) = field.inner {\n@@ -3394,19 +3394,18 @@ fn item_enum(w: &mut fmt::Formatter, cx: &Context, it: &clean::Item,\n                                                       ItemType::Variant.name_space(),\n                                                       field.name.as_ref().unwrap(),\n                                                       ItemType::StructField.name_space()));\n-                        write!(w, \"<tr><td \\\n-                                   id='{id}'>\\\n-                                   <span id='{ns_id}' class='invisible'>\\\n-                                   <code>{f}:&nbsp;{t}</code></span></td><td>\",\n+                        write!(w, \"<span id=\\\"{id}\\\" class=\\\"variant small-section-header\\\">\\\n+                                   <a href=\\\"#{id}\\\" class=\\\"anchor field\\\"></a>\\\n+                                   <span id='{ns_id}' class='invisible'><code>{f}:&nbsp;{t}\\\n+                                   </code></span></span>\",\n                                id = id,\n                                ns_id = ns_id,\n                                f = field.name.as_ref().unwrap(),\n                                t = *ty)?;\n                         document(w, cx, field)?;\n-                        write!(w, \"</td></tr>\")?;\n                     }\n                 }\n-                write!(w, \"</table></span>\")?;\n+                write!(w, \"</div></span>\")?;\n             }\n             render_stability_since(w, variant, it)?;\n         }"}, {"sha": "02229b82b8ac3e76a7a022f99c47a1f4a78137fb", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 10, "deletions": 7, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/883b8199ca7c711b1789c0ffc4a82fadf303ed13/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/883b8199ca7c711b1789c0ffc4a82fadf303ed13/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=883b8199ca7c711b1789c0ffc4a82fadf303ed13", "patch": "@@ -1886,7 +1886,7 @@\n             if (hasClass(relatedDoc, \"stability\")) {\n                 relatedDoc = relatedDoc.nextElementSibling;\n             }\n-            if (hasClass(relatedDoc, \"docblock\")) {\n+            if (hasClass(relatedDoc, \"docblock\") || hasClass(relatedDoc, \"sub-variant\")) {\n                 var action = mode;\n                 if (action === \"toggle\") {\n                     if (hasClass(relatedDoc, \"hidden-by-usual-hider\")) {\n@@ -2094,15 +2094,13 @@\n     }\n \n     var hideItemDeclarations = getCurrentValue('rustdoc-item-declarations') === \"false\";\n-    onEach(document.getElementsByClassName('docblock'), function(e) {\n+    function buildToggleWrapper(e) {\n         if (hasClass(e, 'autohide')) {\n             var wrap = e.previousElementSibling;\n             if (wrap && hasClass(wrap, 'toggle-wrapper')) {\n                 var toggle = wrap.childNodes[0];\n-                var extra = false;\n-                if (e.childNodes[0].tagName === 'H3') {\n-                    extra = true;\n-                }\n+                var extra = e.childNodes[0].tagName === 'H3';\n+\n                 e.style.display = 'none';\n                 addClass(wrap, 'collapsed');\n                 onEach(toggle.getElementsByClassName('inner'), function(e) {\n@@ -2127,6 +2125,8 @@\n                 if (hideItemDeclarations === false) {\n                     extraClass = 'collapsed';\n                 }\n+            } else if (hasClass(e, \"sub-variant\")) {\n+                otherMessage = '&nbsp;Show&nbsp;fields';\n             } else if (hasClass(e, \"non-exhaustive\")) {\n                 otherMessage = '&nbsp;This&nbsp;';\n                 if (hasClass(e, \"non-exhaustive-struct\")) {\n@@ -2150,7 +2150,10 @@\n                 collapseDocs(e.previousSibling.childNodes[0], \"toggle\");\n             }\n         }\n-    });\n+    }\n+\n+    onEach(document.getElementsByClassName('docblock'), buildToggleWrapper);\n+    onEach(document.getElementsByClassName('sub-variant'), buildToggleWrapper);\n \n     function createToggleWrapper(tog) {\n         var span = document.createElement('span');"}, {"sha": "8bcb828a5ade1e22f961bf5d68fb3ac1ed1eec5d", "filename": "src/librustdoc/html/static/rustdoc.css", "status": "modified", "additions": 21, "deletions": 1, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/883b8199ca7c711b1789c0ffc4a82fadf303ed13/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/883b8199ca7c711b1789c0ffc4a82fadf303ed13/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css?ref=883b8199ca7c711b1789c0ffc4a82fadf303ed13", "patch": "@@ -517,6 +517,10 @@ h4 > code, h3 > code, .invisible > code {\n \tmargin-top: -13px;\n }\n \n+.sub-variant > div > .stability {\n+\tmargin-top: initial;\n+}\n+\n .content .stability::before {\n \tcontent: '\u02ea';\n \tfont-size: 30px;\n@@ -866,7 +870,23 @@ span.since {\n }\n \n .sub-variant, .sub-variant > h3 {\n-\tmargin-top: 0 !important;\n+\tmargin-top: 1px !important;\n+}\n+\n+#main > .sub-variant > h3 {\n+\tfont-size: 15px;\n+\tmargin-left: 25px;\n+\tmargin-bottom: 5px;\n+}\n+\n+.sub-variant > div {\n+\tmargin-left: 20px;\n+\tmargin-bottom: 10px;\n+}\n+\n+.sub-variant > div > span {\n+\tdisplay: block;\n+\tposition: relative;\n }\n \n .toggle-label {"}]}