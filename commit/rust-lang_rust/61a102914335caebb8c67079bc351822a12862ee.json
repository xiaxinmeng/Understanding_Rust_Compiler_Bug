{"sha": "61a102914335caebb8c67079bc351822a12862ee", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYxYTEwMjkxNDMzNWNhZWJiOGM2NzA3OWJjMzUxODIyYTEyODYyZWU=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-09-13T05:48:03Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-09-13T05:48:03Z"}, "message": "Auto merge of #88529 - Meziu:master, r=nagisa\n\nARMv6K Nintendo 3DS Tier 3 target added\n\nAddition of the target specifications to build .elf files for Nintendo 3DS (ARMv6K, Horizon). Requires devkitARM 3DS toolkit for system libraries and arm-none-eabi-gcc linker.", "tree": {"sha": "cb187606f442bf5f4b56320152fd7dde98ad2bac", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cb187606f442bf5f4b56320152fd7dde98ad2bac"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/61a102914335caebb8c67079bc351822a12862ee", "comment_count": 1, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/61a102914335caebb8c67079bc351822a12862ee", "html_url": "https://github.com/rust-lang/rust/commit/61a102914335caebb8c67079bc351822a12862ee", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/61a102914335caebb8c67079bc351822a12862ee/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c6f32f3750987640d11a97e503f57b637fd968fd", "url": "https://api.github.com/repos/rust-lang/rust/commits/c6f32f3750987640d11a97e503f57b637fd968fd", "html_url": "https://github.com/rust-lang/rust/commit/c6f32f3750987640d11a97e503f57b637fd968fd"}, {"sha": "e07ae3ca26fd15202af7fbcb19042d468b1213f0", "url": "https://api.github.com/repos/rust-lang/rust/commits/e07ae3ca26fd15202af7fbcb19042d468b1213f0", "html_url": "https://github.com/rust-lang/rust/commit/e07ae3ca26fd15202af7fbcb19042d468b1213f0"}], "stats": {"total": 46, "additions": 46, "deletions": 0}, "files": [{"sha": "01f5c197d2023c477d14277c129d0f2281da8d02", "filename": "compiler/rustc_target/src/spec/armv6k_nintendo_3ds.rs", "status": "added", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/rust-lang/rust/blob/61a102914335caebb8c67079bc351822a12862ee/compiler%2Frustc_target%2Fsrc%2Fspec%2Farmv6k_nintendo_3ds.rs", "raw_url": "https://github.com/rust-lang/rust/raw/61a102914335caebb8c67079bc351822a12862ee/compiler%2Frustc_target%2Fsrc%2Fspec%2Farmv6k_nintendo_3ds.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Farmv6k_nintendo_3ds.rs?ref=61a102914335caebb8c67079bc351822a12862ee", "patch": "@@ -0,0 +1,43 @@\n+use crate::spec::{LinkArgs, LinkerFlavor, PanicStrategy, RelocModel, Target, TargetOptions};\n+\n+/// A base target for Nintendo 3DS devices using the devkitARM toolchain.\n+///\n+/// Requires the devkitARM toolchain for 3DS targets on the host system.\n+\n+pub fn target() -> Target {\n+    let mut pre_link_args = LinkArgs::new();\n+    pre_link_args.insert(\n+        LinkerFlavor::Gcc,\n+        vec![\n+            \"-specs=3dsx.specs\".to_string(),\n+            \"-mtune=mpcore\".to_string(),\n+            \"-mfloat-abi=hard\".to_string(),\n+            \"-mtp=soft\".to_string(),\n+        ],\n+    );\n+\n+    Target {\n+        llvm_target: \"armv6k-none-eabihf\".to_string(),\n+        pointer_width: 32,\n+        data_layout: \"e-m:e-p:32:32-Fi8-i64:64-v128:64:128-a:0:32-n32-S64\".to_string(),\n+        arch: \"arm\".to_string(),\n+\n+        options: TargetOptions {\n+            os: \"horizon\".to_string(),\n+            env: \"newlib\".to_string(),\n+            vendor: \"nintendo\".to_string(),\n+            abi: \"eabihf\".to_string(),\n+            linker_flavor: LinkerFlavor::Gcc,\n+            cpu: \"mpcore\".to_string(),\n+            executables: true,\n+            families: vec![\"unix\".to_string()],\n+            linker: Some(\"arm-none-eabi-gcc\".to_string()),\n+            relocation_model: RelocModel::Static,\n+            features: \"+vfp2\".to_string(),\n+            pre_link_args,\n+            exe_suffix: \".elf\".to_string(),\n+            panic_strategy: PanicStrategy::Abort,\n+            ..Default::default()\n+        },\n+    }\n+}"}, {"sha": "920a929544abb31f0b3be9229f7f08370fe36c4d", "filename": "compiler/rustc_target/src/spec/mod.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/61a102914335caebb8c67079bc351822a12862ee/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/61a102914335caebb8c67079bc351822a12862ee/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs?ref=61a102914335caebb8c67079bc351822a12862ee", "patch": "@@ -941,6 +941,8 @@ supported_targets! {\n \n     (\"bpfeb-unknown-none\", bpfeb_unknown_none),\n     (\"bpfel-unknown-none\", bpfel_unknown_none),\n+\n+    (\"armv6k-nintendo-3ds\", armv6k_nintendo_3ds),\n }\n \n /// Warnings encountered when parsing the target `json`."}, {"sha": "3ba06e87220e343fa4547806f19891ba1189ecd0", "filename": "src/doc/rustc/src/platform-support.md", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/61a102914335caebb8c67079bc351822a12862ee/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md", "raw_url": "https://github.com/rust-lang/rust/raw/61a102914335caebb8c67079bc351822a12862ee/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md?ref=61a102914335caebb8c67079bc351822a12862ee", "patch": "@@ -217,6 +217,7 @@ target | std | host | notes\n `armv5te-unknown-linux-uclibceabi` | ? |  | ARMv5TE Linux with uClibc\n `armv6-unknown-freebsd` | \u2713 | \u2713 | ARMv6 FreeBSD\n `armv6-unknown-netbsd-eabihf` | ? |  |\n+`armv6k-nintendo-3ds` | * |  | ARMv6K Nintendo 3DS, Horizon (Requires devkitARM toolchain)\n `armv7-apple-ios` | \u2713 |  | ARMv7 iOS, Cortex-a8\n `armv7-unknown-freebsd` | \u2713 | \u2713 | ARMv7 FreeBSD\n `armv7-unknown-netbsd-eabihf` | \u2713 | \u2713 |"}]}