{"sha": "c7a7658c6dd89fd5e0a696460fe9abceb2bde8aa", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM3YTc2NThjNmRkODlmZDVlMGE2OTY0NjBmZTlhYmNlYjJiZGU4YWE=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2020-04-23T19:40:42Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2020-04-23T19:45:18Z"}, "message": "Enable \"full tools\" option on ARM dist builders\n\nThis commit switches the `--enable-extended` option on the arm-related\ndist builders to `--enable-full-tools`. This alias in `config.py`\ncorresponds to enabling a few more options:\n\n* `rust.lld = true` - this is the main purpose of this PR, to enable LLD\n  on ARM-related platforms. This means it will effectively unlock\n  compilation of wasm programs from an arm host.\n\n* `rust.llvm-tools = true` - it turns out that this option is largely\n  ignored in rustbuild today. This is only read in one location to set\n  some flags for the `llvm-tools` package, but the `llvm-tools` package\n  is already produced on all of these builders. It's predicted that this\n  will have no effect on build times.\n\n* `rust.codegen-backends = ['llvm']` - historically this also enabled\n  the emscripten backend, but that has long since been removed.\n\nThis brings the ARM dist builders in line with the x86_64 dist builders\nusing this flag. The hope is that the extra time spent on CI building\nLLD will acceptable because it's cached by `sccache`, LLD is a\nrelatively small C++ project, and the dist builders are all clocking\nwell under 3 hours (the slowest of all builders) around 2 hours.\n\nThere's likely some possible cleanup that can happen with these\nconfigure options since it doesn't look like they've aged too too well,\nbut I'm hopeful that possible refactorings, if necessary, could be\ndeferred to future PRs.", "tree": {"sha": "f503eb448a6a51ad03c1a60b527f82ea315f7da8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f503eb448a6a51ad03c1a60b527f82ea315f7da8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c7a7658c6dd89fd5e0a696460fe9abceb2bde8aa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c7a7658c6dd89fd5e0a696460fe9abceb2bde8aa", "html_url": "https://github.com/rust-lang/rust/commit/c7a7658c6dd89fd5e0a696460fe9abceb2bde8aa", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c7a7658c6dd89fd5e0a696460fe9abceb2bde8aa/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "413a12909f3b149af17d75268ed4a136afb82c36", "url": "https://api.github.com/repos/rust-lang/rust/commits/413a12909f3b149af17d75268ed4a136afb82c36", "html_url": "https://github.com/rust-lang/rust/commit/413a12909f3b149af17d75268ed4a136afb82c36"}], "stats": {"total": 8, "additions": 4, "deletions": 4}, "files": [{"sha": "74766dc970d9f8fbcfb173ce21c6101824c499a0", "filename": "src/ci/docker/dist-aarch64-linux/Dockerfile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c7a7658c6dd89fd5e0a696460fe9abceb2bde8aa/src%2Fci%2Fdocker%2Fdist-aarch64-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/c7a7658c6dd89fd5e0a696460fe9abceb2bde8aa/src%2Fci%2Fdocker%2Fdist-aarch64-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-aarch64-linux%2FDockerfile?ref=c7a7658c6dd89fd5e0a696460fe9abceb2bde8aa", "patch": "@@ -33,7 +33,7 @@ ENV CC_aarch64_unknown_linux_gnu=aarch64-unknown-linux-gnueabi-gcc \\\n ENV HOSTS=aarch64-unknown-linux-gnu\n \n ENV RUST_CONFIGURE_ARGS \\\n-      --enable-extended \\\n+      --enable-full-tools \\\n       --enable-profiler \\\n       --disable-docs\n ENV SCRIPT python3 ../x.py dist --host $HOSTS --target $HOSTS"}, {"sha": "06870a8a982f3ab40e9c24a7c730770ac7405d12", "filename": "src/ci/docker/dist-arm-linux/Dockerfile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c7a7658c6dd89fd5e0a696460fe9abceb2bde8aa/src%2Fci%2Fdocker%2Fdist-arm-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/c7a7658c6dd89fd5e0a696460fe9abceb2bde8aa/src%2Fci%2Fdocker%2Fdist-arm-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-arm-linux%2FDockerfile?ref=c7a7658c6dd89fd5e0a696460fe9abceb2bde8aa", "patch": "@@ -27,5 +27,5 @@ ENV CC_arm_unknown_linux_gnueabi=arm-unknown-linux-gnueabi-gcc \\\n \n ENV HOSTS=arm-unknown-linux-gnueabi\n \n-ENV RUST_CONFIGURE_ARGS --enable-extended --disable-docs\n+ENV RUST_CONFIGURE_ARGS --enable-full-tools --disable-docs\n ENV SCRIPT python3 ../x.py dist --host $HOSTS --target $HOSTS"}, {"sha": "155dd84891435e5ed4bb7ce4f2ed375d9b137049", "filename": "src/ci/docker/dist-armhf-linux/Dockerfile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c7a7658c6dd89fd5e0a696460fe9abceb2bde8aa/src%2Fci%2Fdocker%2Fdist-armhf-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/c7a7658c6dd89fd5e0a696460fe9abceb2bde8aa/src%2Fci%2Fdocker%2Fdist-armhf-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-armhf-linux%2FDockerfile?ref=c7a7658c6dd89fd5e0a696460fe9abceb2bde8aa", "patch": "@@ -27,5 +27,5 @@ ENV CC_arm_unknown_linux_gnueabihf=arm-unknown-linux-gnueabihf-gcc \\\n \n ENV HOSTS=arm-unknown-linux-gnueabihf\n \n-ENV RUST_CONFIGURE_ARGS --enable-extended --disable-docs\n+ENV RUST_CONFIGURE_ARGS --enable-full-tools --disable-docs\n ENV SCRIPT python3 ../x.py dist --host $HOSTS --target $HOSTS"}, {"sha": "649049da5dfe314719af3cfd920eb0ad9d83def6", "filename": "src/ci/docker/dist-armv7-linux/Dockerfile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c7a7658c6dd89fd5e0a696460fe9abceb2bde8aa/src%2Fci%2Fdocker%2Fdist-armv7-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/c7a7658c6dd89fd5e0a696460fe9abceb2bde8aa/src%2Fci%2Fdocker%2Fdist-armv7-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-armv7-linux%2FDockerfile?ref=c7a7658c6dd89fd5e0a696460fe9abceb2bde8aa", "patch": "@@ -27,5 +27,5 @@ ENV CC_armv7_unknown_linux_gnueabihf=armv7-unknown-linux-gnueabihf-gcc \\\n \n ENV HOSTS=armv7-unknown-linux-gnueabihf\n \n-ENV RUST_CONFIGURE_ARGS --enable-extended --disable-docs\n+ENV RUST_CONFIGURE_ARGS --enable-full-tools --disable-docs\n ENV SCRIPT python3 ../x.py dist --host $HOSTS --target $HOSTS"}]}