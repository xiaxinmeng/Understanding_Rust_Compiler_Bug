{"sha": "b02f1f46e550e8f87df6c3ec7f9721b1f4edc958", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIwMmYxZjQ2ZTU1MGU4Zjg3ZGY2YzNlYzdmOTcyMWIxZjRlZGM5NTg=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-08-19T02:19:38Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-08-19T02:22:10Z"}, "message": "Don't pretty-print trailing whitespace for blank lines inside block comments", "tree": {"sha": "7819b74afe2ac7e29dfd33003a3e8c7e2c49f398", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7819b74afe2ac7e29dfd33003a3e8c7e2c49f398"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b02f1f46e550e8f87df6c3ec7f9721b1f4edc958", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b02f1f46e550e8f87df6c3ec7f9721b1f4edc958", "html_url": "https://github.com/rust-lang/rust/commit/b02f1f46e550e8f87df6c3ec7f9721b1f4edc958", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b02f1f46e550e8f87df6c3ec7f9721b1f4edc958/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "84fb821e4036a65f78db1821d75b95526ed3fd76", "url": "https://api.github.com/repos/rust-lang/rust/commits/84fb821e4036a65f78db1821d75b95526ed3fd76", "html_url": "https://github.com/rust-lang/rust/commit/84fb821e4036a65f78db1821d75b95526ed3fd76"}], "stats": {"total": 27, "additions": 25, "deletions": 2}, "files": [{"sha": "a90088f214263bcec77218893ff273fb9b85554b", "filename": "src/comp/syntax/print/pprust.rs", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/b02f1f46e550e8f87df6c3ec7f9721b1f4edc958/src%2Fcomp%2Fsyntax%2Fprint%2Fpprust.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b02f1f46e550e8f87df6c3ec7f9721b1f4edc958/src%2Fcomp%2Fsyntax%2Fprint%2Fpprust.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fsyntax%2Fprint%2Fpprust.rs?ref=b02f1f46e550e8f87df6c3ec7f9721b1f4edc958", "patch": "@@ -1537,7 +1537,12 @@ fn print_comment(s: &ps, cmnt: lexer::cmnt) {\n       }\n       lexer::isolated. {\n         pprust::hardbreak_if_not_bol(s);\n-        for line: str in cmnt.lines { word(s.s, line); hardbreak(s.s); }\n+        for line: str in cmnt.lines {\n+            // Don't print empty lines because they will end up as trailing\n+            // whitespace\n+            if str::is_not_empty(line) { word(s.s, line); }\n+            hardbreak(s.s);\n+        }\n       }\n       lexer::trailing. {\n         word(s.s, \" \");\n@@ -1546,7 +1551,10 @@ fn print_comment(s: &ps, cmnt: lexer::cmnt) {\n             hardbreak(s.s);\n         } else {\n             ibox(s, 0u);\n-            for line: str in cmnt.lines { word(s.s, line); hardbreak(s.s); }\n+            for line: str in cmnt.lines {\n+                if str::is_not_empty(line) { word(s.s, line); }\n+                hardbreak(s.s);\n+            }\n             end(s);\n         }\n       }"}, {"sha": "80611467c4e073bf786989fd603702d98474d052", "filename": "src/test/pretty/block-comment-trailing-whitespace.rs", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/b02f1f46e550e8f87df6c3ec7f9721b1f4edc958/src%2Ftest%2Fpretty%2Fblock-comment-trailing-whitespace.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b02f1f46e550e8f87df6c3ec7f9721b1f4edc958/src%2Ftest%2Fpretty%2Fblock-comment-trailing-whitespace.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fpretty%2Fblock-comment-trailing-whitespace.rs?ref=b02f1f46e550e8f87df6c3ec7f9721b1f4edc958", "patch": "@@ -0,0 +1,8 @@\n+// pp-exact\n+fn f() {\n+    /*\n+    The next line should not be indented.\n+\n+    That one. It shouldn't have been indented.\n+    */\n+}"}, {"sha": "e3f6f891dcb90f92c993b43ffae0755e613a9a7d", "filename": "src/test/pretty/block-comment-trailing-whitespace2.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/b02f1f46e550e8f87df6c3ec7f9721b1f4edc958/src%2Ftest%2Fpretty%2Fblock-comment-trailing-whitespace2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b02f1f46e550e8f87df6c3ec7f9721b1f4edc958/src%2Ftest%2Fpretty%2Fblock-comment-trailing-whitespace2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fpretty%2Fblock-comment-trailing-whitespace2.rs?ref=b02f1f46e550e8f87df6c3ec7f9721b1f4edc958", "patch": "@@ -0,0 +1,7 @@\n+// pp-exact\n+fn f() {\n+} /*\n+  The next line should not be indented.\n+\n+  That one. It shouldn't have been indented.\n+  */"}]}