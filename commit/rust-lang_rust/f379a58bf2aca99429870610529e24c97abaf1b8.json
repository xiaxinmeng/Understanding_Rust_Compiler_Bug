{"sha": "f379a58bf2aca99429870610529e24c97abaf1b8", "node_id": "C_kwDOAAsO6NoAKGYzNzlhNThiZjJhY2E5OTQyOTg3MDYxMDUyOWUyNGM5N2FiYWYxYjg", "commit": {"author": {"name": "Dylan DPC", "email": "99973273+Dylan-DPC@users.noreply.github.com", "date": "2023-05-02T06:14:51Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-05-02T06:14:51Z"}, "message": "Rollup merge of #108668 - gibbyfree:stabilizedebuggervisualizer, r=wesleywiser\n\nStabilize debugger_visualizer\n\nThis stabilizes the `debugger_visualizer` attribute (#95939).\n\n* Marks the `debugger_visualizer` feature as `accepted`.\n* Marks the `debugger_visualizer` attribute as `ungated`.\n* Deletes feature gate test, removes feature gate from other tests.\n\nCloses #95939", "tree": {"sha": "e2d90d9e0ae0e6e62e4afd1459de55f29036152d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e2d90d9e0ae0e6e62e4afd1459de55f29036152d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f379a58bf2aca99429870610529e24c97abaf1b8", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkUKpbCRBK7hj4Ov3rIwAAhB4IAKDIQjpQYDtwS6pV4WASzxee\n9S2Oxcn2/LD5TTHD1r9sXadbFxtn9POlOZJdJEqAIylhZnkCNTKEznA4Vw+kQeqN\ntgQ3ceMYdITthFljdzoAWSaOM4jI4ip4DimYp2TTxgoK3OA/ob3t5spwOCs2cbZz\nROh5myjnDDemlInPdzzP16QT+xl/q5FGUDhB2kEdVzIM8kkvNwVIplt84TQBZhM+\n1ATaVTv35i9y7N2gCT5CBBMqpJehFe/GyOYkRCk3Z50Uf2DrLOA3+XEXU1HvpYX7\nhp83KukQ0Wy+GVZXdSJw8NIwNX4kFx6MiagsCdqWCP64q06RJWe1sAEeOJNePos=\n=/BLa\n-----END PGP SIGNATURE-----\n", "payload": "tree e2d90d9e0ae0e6e62e4afd1459de55f29036152d\nparent b727132e23aaa4e80eb82816d95c20023940f916\nparent c9653a6b0b5ab0a2bd7a6d525c234a15ef1d9a70\nauthor Dylan DPC <99973273+Dylan-DPC@users.noreply.github.com> 1683008091 +0530\ncommitter GitHub <noreply@github.com> 1683008091 +0530\n\nRollup merge of #108668 - gibbyfree:stabilizedebuggervisualizer, r=wesleywiser\n\nStabilize debugger_visualizer\n\nThis stabilizes the `debugger_visualizer` attribute (#95939).\n\n* Marks the `debugger_visualizer` feature as `accepted`.\n* Marks the `debugger_visualizer` attribute as `ungated`.\n* Deletes feature gate test, removes feature gate from other tests.\n\nCloses #95939\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f379a58bf2aca99429870610529e24c97abaf1b8", "html_url": "https://github.com/rust-lang/rust/commit/f379a58bf2aca99429870610529e24c97abaf1b8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f379a58bf2aca99429870610529e24c97abaf1b8/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b727132e23aaa4e80eb82816d95c20023940f916", "url": "https://api.github.com/repos/rust-lang/rust/commits/b727132e23aaa4e80eb82816d95c20023940f916", "html_url": "https://github.com/rust-lang/rust/commit/b727132e23aaa4e80eb82816d95c20023940f916"}, {"sha": "c9653a6b0b5ab0a2bd7a6d525c234a15ef1d9a70", "url": "https://api.github.com/repos/rust-lang/rust/commits/c9653a6b0b5ab0a2bd7a6d525c234a15ef1d9a70", "html_url": "https://github.com/rust-lang/rust/commit/c9653a6b0b5ab0a2bd7a6d525c234a15ef1d9a70"}], "stats": {"total": 69, "additions": 11, "deletions": 58}, "files": [{"sha": "70d608a5ea428223d70fe6a2770f54c6389a6cdc", "filename": "compiler/rustc_feature/src/accepted.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f379a58bf2aca99429870610529e24c97abaf1b8/compiler%2Frustc_feature%2Fsrc%2Faccepted.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f379a58bf2aca99429870610529e24c97abaf1b8/compiler%2Frustc_feature%2Fsrc%2Faccepted.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_feature%2Fsrc%2Faccepted.rs?ref=f379a58bf2aca99429870610529e24c97abaf1b8", "patch": "@@ -130,6 +130,8 @@ declare_features! (\n     (accepted, copy_closures, \"1.26.0\", Some(44490), None),\n     /// Allows `crate` in paths.\n     (accepted, crate_in_paths, \"1.30.0\", Some(45477), None),\n+    /// Allows using `#[debugger_visualizer]` attribute.\n+    (accepted, debugger_visualizer, \"CURRENT_RUSTC_VERSION\", Some(95939), None),\n     /// Allows rustc to inject a default alloc_error_handler\n     (accepted, default_alloc_error_handler, \"1.68.0\", Some(66741), None),\n     /// Allows using assigning a default type to type parameters in algebraic data type definitions."}, {"sha": "80c730398da854725a1108fc5c9fcc19cbc1d7b2", "filename": "compiler/rustc_feature/src/active.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f379a58bf2aca99429870610529e24c97abaf1b8/compiler%2Frustc_feature%2Fsrc%2Factive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f379a58bf2aca99429870610529e24c97abaf1b8/compiler%2Frustc_feature%2Fsrc%2Factive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_feature%2Fsrc%2Factive.rs?ref=f379a58bf2aca99429870610529e24c97abaf1b8", "patch": "@@ -363,8 +363,6 @@ declare_features! (\n     (active, custom_inner_attributes, \"1.30.0\", Some(54726), None),\n     /// Allows custom test frameworks with `#![test_runner]` and `#[test_case]`.\n     (active, custom_test_frameworks, \"1.30.0\", Some(50297), None),\n-    /// Allows using `#[debugger_visualizer]`.\n-    (active, debugger_visualizer, \"1.62.0\", Some(95939), None),\n     /// Allows declarative macros 2.0 (`macro`).\n     (active, decl_macro, \"1.17.0\", Some(39412), None),\n     /// Allows default type parameters to influence type inference."}, {"sha": "574419440de666ff04dabc88791bc34a11a91c11", "filename": "compiler/rustc_feature/src/builtin_attrs.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/f379a58bf2aca99429870610529e24c97abaf1b8/compiler%2Frustc_feature%2Fsrc%2Fbuiltin_attrs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f379a58bf2aca99429870610529e24c97abaf1b8/compiler%2Frustc_feature%2Fsrc%2Fbuiltin_attrs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_feature%2Fsrc%2Fbuiltin_attrs.rs?ref=f379a58bf2aca99429870610529e24c97abaf1b8", "patch": "@@ -403,16 +403,16 @@ pub const BUILTIN_ATTRIBUTES: &[BuiltinAttribute] = &[\n         doc, Normal, template!(List: \"hidden|inline|...\", NameValueStr: \"string\"), DuplicatesOk\n     ),\n \n+    // Debugging\n+    ungated!(\n+        debugger_visualizer, Normal,\n+        template!(List: r#\"natvis_file = \"...\", gdb_script_file = \"...\"\"#), DuplicatesOk\n+    ),\n+\n     // ==========================================================================\n     // Unstable attributes:\n     // ==========================================================================\n \n-    // RFC #3191: #[debugger_visualizer] support\n-    gated!(\n-        debugger_visualizer, Normal, template!(List: r#\"natvis_file = \"...\", gdb_script_file = \"...\"\"#),\n-        DuplicatesOk, experimental!(debugger_visualizer)\n-    ),\n-\n     // Linking:\n     gated!(\n         naked, Normal, template!(Word), WarnFollowing, @only_local: true,"}, {"sha": "c7a0414b67602d191a25157ee8ffa43c85dc601b", "filename": "src/doc/unstable-book/src/language-features/debugger-visualizer.md", "status": "removed", "additions": 0, "deletions": 27, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/b727132e23aaa4e80eb82816d95c20023940f916/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fdebugger-visualizer.md", "raw_url": "https://github.com/rust-lang/rust/raw/b727132e23aaa4e80eb82816d95c20023940f916/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fdebugger-visualizer.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fdebugger-visualizer.md?ref=b727132e23aaa4e80eb82816d95c20023940f916", "patch": "@@ -1,27 +0,0 @@\n-# `debugger_visualizer`\n-\n-The tracking issue for this feature is: [#95939]\n-\n-[#95939]: https://github.com/rust-lang/rust/issues/95939\n-\n-------------------------\n-\n-The `debugger_visualizer` attribute can be used to instruct the compiler\n-to embed a debugger visualizer file into the PDB/ELF generated by `rustc`.\n-\n-## Examples\n-\n-``` rust,ignore (partial-example)\n-#![feature(debugger_visualizer)]\n-#![debugger_visualizer(natvis_file = \"foo.natvis\")]\n-#![debugger_visualizer(gdb_script_file = \"foo.py\")]\n-struct Foo {\n-\n-}\n-```\n-\n-## Limitations\n-\n-Currently, this feature only supports embedding Natvis files on `-windows-msvc`\n-targets via the `natvis_file` meta item. `-windows-gnu` targets are not currently\n-supported."}, {"sha": "c187df637fdc7831741df0faf7097e3849cff20c", "filename": "tests/debuginfo/auxiliary/dependency-with-embedded-visualizers.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f379a58bf2aca99429870610529e24c97abaf1b8/tests%2Fdebuginfo%2Fauxiliary%2Fdependency-with-embedded-visualizers.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f379a58bf2aca99429870610529e24c97abaf1b8/tests%2Fdebuginfo%2Fauxiliary%2Fdependency-with-embedded-visualizers.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdebuginfo%2Fauxiliary%2Fdependency-with-embedded-visualizers.rs?ref=f379a58bf2aca99429870610529e24c97abaf1b8", "patch": "@@ -2,7 +2,6 @@\n // ignore-lldb\n // no-prefer-dynamic\n \n-#![feature(debugger_visualizer)]\n #![debugger_visualizer(natvis_file = \"dependency-with-embedded-visualizers.natvis\")]\n #![debugger_visualizer(gdb_script_file = \"dependency-with-embedded-visualizers.py\")]\n #![crate_type = \"rlib\"]"}, {"sha": "ac421092839f40b6d463a3c0b28ebe5a4788cc9b", "filename": "tests/debuginfo/embedded-visualizer.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f379a58bf2aca99429870610529e24c97abaf1b8/tests%2Fdebuginfo%2Fembedded-visualizer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f379a58bf2aca99429870610529e24c97abaf1b8/tests%2Fdebuginfo%2Fembedded-visualizer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdebuginfo%2Fembedded-visualizer.rs?ref=f379a58bf2aca99429870610529e24c97abaf1b8", "patch": "@@ -60,7 +60,6 @@\n // gdb-check:$4 = \"Person A\" is 10 years old.\n \n #![allow(unused_variables)]\n-#![feature(debugger_visualizer)]\n #![debugger_visualizer(natvis_file = \"embedded-visualizer.natvis\")]\n #![debugger_visualizer(gdb_script_file = \"embedded-visualizer.py\")]\n "}, {"sha": "4c4dc450d18bcecdec74eee9fa6fba6a89fd26b5", "filename": "tests/ui/feature-gates/feature-gate-debugger-visualizer.rs", "status": "removed", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/b727132e23aaa4e80eb82816d95c20023940f916/tests%2Fui%2Ffeature-gates%2Ffeature-gate-debugger-visualizer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b727132e23aaa4e80eb82816d95c20023940f916/tests%2Fui%2Ffeature-gates%2Ffeature-gate-debugger-visualizer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ffeature-gates%2Ffeature-gate-debugger-visualizer.rs?ref=b727132e23aaa4e80eb82816d95c20023940f916", "patch": "@@ -1,3 +0,0 @@\n-#![debugger_visualizer(natvis_file = \"auxiliary/debugger-visualizer.natvis\")] //~ ERROR the `#[debugger_visualizer]` attribute is an experimental feature\n-\n-fn main() {}"}, {"sha": "e9367fbc6c96cf1e127bb00f3aa7115a425bfcf5", "filename": "tests/ui/feature-gates/feature-gate-debugger-visualizer.stderr", "status": "removed", "additions": 0, "deletions": 12, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/b727132e23aaa4e80eb82816d95c20023940f916/tests%2Fui%2Ffeature-gates%2Ffeature-gate-debugger-visualizer.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b727132e23aaa4e80eb82816d95c20023940f916/tests%2Fui%2Ffeature-gates%2Ffeature-gate-debugger-visualizer.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ffeature-gates%2Ffeature-gate-debugger-visualizer.stderr?ref=b727132e23aaa4e80eb82816d95c20023940f916", "patch": "@@ -1,12 +0,0 @@\n-error[E0658]: the `#[debugger_visualizer]` attribute is an experimental feature\n-  --> $DIR/feature-gate-debugger-visualizer.rs:1:1\n-   |\n-LL | #![debugger_visualizer(natvis_file = \"auxiliary/debugger-visualizer.natvis\")]\n-   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #95939 <https://github.com/rust-lang/rust/issues/95939> for more information\n-   = help: add `#![feature(debugger_visualizer)]` to the crate attributes to enable\n-\n-error: aborting due to previous error\n-\n-For more information about this error, try `rustc --explain E0658`."}, {"sha": "150723898bd78f272f40e5851ecbdc433b3e69af", "filename": "tests/ui/invalid/invalid-debugger-visualizer-option.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f379a58bf2aca99429870610529e24c97abaf1b8/tests%2Fui%2Finvalid%2Finvalid-debugger-visualizer-option.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f379a58bf2aca99429870610529e24c97abaf1b8/tests%2Fui%2Finvalid%2Finvalid-debugger-visualizer-option.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Finvalid%2Finvalid-debugger-visualizer-option.rs?ref=f379a58bf2aca99429870610529e24c97abaf1b8", "patch": "@@ -1,7 +1,6 @@\n // normalize-stderr-test: \"foo.random:.*\\(\" -> \"foo.random: $$FILE_NOT_FOUND_MSG (\"\n // normalize-stderr-test: \"os error \\d+\" -> \"os error $$FILE_NOT_FOUND_CODE\"\n \n-#![feature(debugger_visualizer)]\n #![debugger_visualizer(random_file = \"../foo.random\")] //~ ERROR invalid argument\n #![debugger_visualizer(natvis_file = \"../foo.random\")] //~ ERROR\n fn main() {}"}, {"sha": "6fbb4d641e6f65e6c667e636456295163fe11698", "filename": "tests/ui/invalid/invalid-debugger-visualizer-option.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/f379a58bf2aca99429870610529e24c97abaf1b8/tests%2Fui%2Finvalid%2Finvalid-debugger-visualizer-option.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/f379a58bf2aca99429870610529e24c97abaf1b8/tests%2Fui%2Finvalid%2Finvalid-debugger-visualizer-option.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Finvalid%2Finvalid-debugger-visualizer-option.stderr?ref=f379a58bf2aca99429870610529e24c97abaf1b8", "patch": "@@ -1,5 +1,5 @@\n error: invalid argument\n-  --> $DIR/invalid-debugger-visualizer-option.rs:5:24\n+  --> $DIR/invalid-debugger-visualizer-option.rs:4:24\n    |\n LL | #![debugger_visualizer(random_file = \"../foo.random\")]\n    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n@@ -9,7 +9,7 @@ LL | #![debugger_visualizer(random_file = \"../foo.random\")]\n    = note: expected: `gdb_script_file = \"...\"`\n \n error: couldn't read $DIR/../foo.random: $FILE_NOT_FOUND_MSG (os error $FILE_NOT_FOUND_CODE)\n-  --> $DIR/invalid-debugger-visualizer-option.rs:6:24\n+  --> $DIR/invalid-debugger-visualizer-option.rs:5:24\n    |\n LL | #![debugger_visualizer(natvis_file = \"../foo.random\")]\n    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^"}, {"sha": "f9dd20dbfed1dc9a0d2a3b83c313f217952a0b44", "filename": "tests/ui/invalid/invalid-debugger-visualizer-target.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f379a58bf2aca99429870610529e24c97abaf1b8/tests%2Fui%2Finvalid%2Finvalid-debugger-visualizer-target.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f379a58bf2aca99429870610529e24c97abaf1b8/tests%2Fui%2Finvalid%2Finvalid-debugger-visualizer-target.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Finvalid%2Finvalid-debugger-visualizer-target.rs?ref=f379a58bf2aca99429870610529e24c97abaf1b8", "patch": "@@ -1,4 +1,2 @@\n-#![feature(debugger_visualizer)]\n-\n #[debugger_visualizer(natvis_file = \"../foo.natvis\")] //~ ERROR attribute should be applied to a module\n fn main() {}"}, {"sha": "7944f7518593c78765a28bd85cae5a27f25d1532", "filename": "tests/ui/invalid/invalid-debugger-visualizer-target.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f379a58bf2aca99429870610529e24c97abaf1b8/tests%2Fui%2Finvalid%2Finvalid-debugger-visualizer-target.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/f379a58bf2aca99429870610529e24c97abaf1b8/tests%2Fui%2Finvalid%2Finvalid-debugger-visualizer-target.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Finvalid%2Finvalid-debugger-visualizer-target.stderr?ref=f379a58bf2aca99429870610529e24c97abaf1b8", "patch": "@@ -1,5 +1,5 @@\n error: attribute should be applied to a module\n-  --> $DIR/invalid-debugger-visualizer-target.rs:3:1\n+  --> $DIR/invalid-debugger-visualizer-target.rs:1:1\n    |\n LL | #[debugger_visualizer(natvis_file = \"../foo.natvis\")]\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^"}]}