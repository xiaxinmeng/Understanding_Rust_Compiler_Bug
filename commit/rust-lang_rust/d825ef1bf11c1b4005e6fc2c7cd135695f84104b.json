{"sha": "d825ef1bf11c1b4005e6fc2c7cd135695f84104b", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ4MjVlZjFiZjExYzFiNDAwNWU2ZmMyYzdjZDEzNTY5NWY4NDEwNGI=", "commit": {"author": {"name": "Scott Olson", "email": "scott@solson.me", "date": "2016-05-09T01:30:17Z"}, "committer": {"name": "Scott Olson", "email": "scott@solson.me", "date": "2016-05-09T01:30:17Z"}, "message": "Move StructWrappedNullablePointer-using test to bugs dir.", "tree": {"sha": "fc2391513d5244bb1d4d087539f85e657008f516", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fc2391513d5244bb1d4d087539f85e657008f516"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d825ef1bf11c1b4005e6fc2c7cd135695f84104b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d825ef1bf11c1b4005e6fc2c7cd135695f84104b", "html_url": "https://github.com/rust-lang/rust/commit/d825ef1bf11c1b4005e6fc2c7cd135695f84104b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d825ef1bf11c1b4005e6fc2c7cd135695f84104b/comments", "author": {"login": "solson", "id": 26806, "node_id": "MDQ6VXNlcjI2ODA2", "avatar_url": "https://avatars.githubusercontent.com/u/26806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/solson", "html_url": "https://github.com/solson", "followers_url": "https://api.github.com/users/solson/followers", "following_url": "https://api.github.com/users/solson/following{/other_user}", "gists_url": "https://api.github.com/users/solson/gists{/gist_id}", "starred_url": "https://api.github.com/users/solson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/solson/subscriptions", "organizations_url": "https://api.github.com/users/solson/orgs", "repos_url": "https://api.github.com/users/solson/repos", "events_url": "https://api.github.com/users/solson/events{/privacy}", "received_events_url": "https://api.github.com/users/solson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "solson", "id": 26806, "node_id": "MDQ6VXNlcjI2ODA2", "avatar_url": "https://avatars.githubusercontent.com/u/26806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/solson", "html_url": "https://github.com/solson", "followers_url": "https://api.github.com/users/solson/followers", "following_url": "https://api.github.com/users/solson/following{/other_user}", "gists_url": "https://api.github.com/users/solson/gists{/gist_id}", "starred_url": "https://api.github.com/users/solson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/solson/subscriptions", "organizations_url": "https://api.github.com/users/solson/orgs", "repos_url": "https://api.github.com/users/solson/repos", "events_url": "https://api.github.com/users/solson/events{/privacy}", "received_events_url": "https://api.github.com/users/solson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d288472b297c4df82f293d2a8ea9c7098e3a70b3", "url": "https://api.github.com/repos/rust-lang/rust/commits/d288472b297c4df82f293d2a8ea9c7098e3a70b3", "html_url": "https://github.com/rust-lang/rust/commit/d288472b297c4df82f293d2a8ea9c7098e3a70b3"}], "stats": {"total": 37, "additions": 24, "deletions": 13}, "files": [{"sha": "880ca42d45557942593f61e4377775b47ee5a234", "filename": "tests/compile-fail/bugs/struct_wrapped_nullable_pointer.rs", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/d825ef1bf11c1b4005e6fc2c7cd135695f84104b/tests%2Fcompile-fail%2Fbugs%2Fstruct_wrapped_nullable_pointer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d825ef1bf11c1b4005e6fc2c7cd135695f84104b/tests%2Fcompile-fail%2Fbugs%2Fstruct_wrapped_nullable_pointer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-fail%2Fbugs%2Fstruct_wrapped_nullable_pointer.rs?ref=d825ef1bf11c1b4005e6fc2c7cd135695f84104b", "patch": "@@ -0,0 +1,23 @@\n+#![feature(custom_attribute, box_syntax)]\n+#![allow(dead_code, unused_attributes)]\n+\n+// error-pattern:can't handle destination layout StructWrappedNullablePointer\n+\n+use std::cell::RefCell;\n+use std::rc::Rc;\n+\n+struct Loop(Rc<RefCell<Option<Loop>>>);\n+\n+#[miri_run]\n+fn rc_reference_cycle() -> Loop {\n+    let a = Rc::new(RefCell::new(None));\n+    let b = a.clone();\n+    *a.borrow_mut() = Some(Loop(b));\n+    Loop(a)\n+}\n+\n+#[miri_run]\n+fn main() {\n+    let x = rc_reference_cycle().0;\n+    assert!(x.borrow().is_some());\n+}"}, {"sha": "b5bb7c7dbdb9f09a7e5281f16c9ec8580b16eec1", "filename": "tests/run-pass/std.rs", "status": "modified", "additions": 1, "deletions": 13, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/d825ef1bf11c1b4005e6fc2c7cd135695f84104b/tests%2Frun-pass%2Fstd.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d825ef1bf11c1b4005e6fc2c7cd135695f84104b/tests%2Frun-pass%2Fstd.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fstd.rs?ref=d825ef1bf11c1b4005e6fc2c7cd135695f84104b", "patch": "@@ -1,7 +1,7 @@\n #![feature(custom_attribute, box_syntax)]\n #![allow(dead_code, unused_attributes)]\n \n-use std::cell::{Cell, RefCell};\n+use std::cell::Cell;\n use std::rc::Rc;\n use std::sync::Arc;\n \n@@ -29,25 +29,13 @@ fn arc() -> Arc<i32> {\n     a\n }\n \n-struct Loop(Rc<RefCell<Option<Loop>>>);\n-\n-#[miri_run]\n-fn rc_reference_cycle() -> Loop {\n-    let a = Rc::new(RefCell::new(None));\n-    let b = a.clone();\n-    *a.borrow_mut() = Some(Loop(b));\n-    Loop(a)\n-}\n-\n #[miri_run]\n fn true_assert() {\n     assert_eq!(1, 1);\n }\n \n #[miri_run]\n fn main() {\n-    //let x = rc_reference_cycle().0;\n-    //assert!(x.borrow().is_some());\n     assert_eq!(*arc(), 42);\n     assert_eq!(rc_cell().get(), 84);\n }"}]}