{"sha": "0ce564a7e19ac17a7dfad8f94ad009d5e03200bc", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBjZTU2NGE3ZTE5YWMxN2E3ZGZhZDhmOTRhZDAwOWQ1ZTAzMjAwYmM=", "commit": {"author": {"name": "flip1995", "email": "hello@philkrones.com", "date": "2019-02-16T18:37:58Z"}, "committer": {"name": "flip1995", "email": "hello@philkrones.com", "date": "2019-02-19T20:34:14Z"}, "message": "Add test related to the ICE\n\nThis test doesn't reproduce the ICE since it only happens, when the macro is defined in another file.\nCurrently we can't add tests with multiple files AFAIK\n\nAlso using the auxiliary folder didn't help", "tree": {"sha": "0a264ad47701420a64276fbe44d7ca4ea7a005ce", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0a264ad47701420a64276fbe44d7ca4ea7a005ce"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0ce564a7e19ac17a7dfad8f94ad009d5e03200bc", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZxoS6lESXlRGMHWcaTCGhp1QZjcFAlxsaEYACgkQaTCGhp1Q\nZjf+yxAAj/ZekLcFtA9IwPRUkR5Q0jlUxJ0HARLBFRGzikZP8tbx39on39Gc+PP0\nnwu1X71fL7kkjGjPRMFYodsHd7VAg9sd96ri0tqvJ5yFfz9OTnRsxpaGVXwo2rMR\nLzOwgOQMOJ0/eRqw3XyKCOsOdutxQiqHC1uowtOSRyGhc8xKPe7/UaZsfDAF9eMG\npKm1Vdt5FAanwrDOkSHcPjPzGuVt1GWnG4rzFl7jFNF0kgvjUZKqt6Jf6ma6yaJK\nPiOv0wnfRy6MVbOtGmEKvVvZM10/xIl/CLwQz9texCUZXR7hZT8WZQxXPIurVyiF\nRVG8ZRwYruRYHBfno0O8Jjscej1OxY47LCYp5dsVP8RQ59YRp8dQXRJ6MZRikUqO\n0OllycX1jz7c1NPH8DABwR1jawrNdG33QbmgM0V9fcuIvWbBj+wk4UfdkLznXqns\nige22FTBx513aiftezwBif42zFcnBtusKvKowczz2qeeFHzNolR7Jsfqy0sxQb1O\nPRATtam80cpmcPPBgGSqsQFN76HZYHOMu219IQnMRrotlMDHYPd2iL3EDxnK6O2x\nFoegxWPEgEkuV7CKKVF4PBUmzPaR9tI5AQCapAnGnFPwPYe5IzyaiFwY7jlkzjz2\nyEg6odI3lDRetsR/zdHEzJgKClD98adFnDcs2ASRLXeX7IwuPmk=\n=XPIu\n-----END PGP SIGNATURE-----", "payload": "tree 0a264ad47701420a64276fbe44d7ca4ea7a005ce\nparent 87ae6c8bc989c99435afec478a31fca7e319a17d\nauthor flip1995 <hello@philkrones.com> 1550342278 +0100\ncommitter flip1995 <hello@philkrones.com> 1550608454 +0100\n\nAdd test related to the ICE\n\nThis test doesn't reproduce the ICE since it only happens, when the macro is defined in another file.\nCurrently we can't add tests with multiple files AFAIK\n\nAlso using the auxiliary folder didn't help\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0ce564a7e19ac17a7dfad8f94ad009d5e03200bc", "html_url": "https://github.com/rust-lang/rust/commit/0ce564a7e19ac17a7dfad8f94ad009d5e03200bc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0ce564a7e19ac17a7dfad8f94ad009d5e03200bc/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "87ae6c8bc989c99435afec478a31fca7e319a17d", "url": "https://api.github.com/repos/rust-lang/rust/commits/87ae6c8bc989c99435afec478a31fca7e319a17d", "html_url": "https://github.com/rust-lang/rust/commit/87ae6c8bc989c99435afec478a31fca7e319a17d"}], "stats": {"total": 43, "additions": 41, "deletions": 2}, "files": [{"sha": "c7c84b5d9c0a24487a5ce3fa0f092266a2c65c07", "filename": "tests/ui/matches.rs", "status": "modified", "additions": 26, "deletions": 1, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/0ce564a7e19ac17a7dfad8f94ad009d5e03200bc/tests%2Fui%2Fmatches.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0ce564a7e19ac17a7dfad8f94ad009d5e03200bc/tests%2Fui%2Fmatches.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmatches.rs?ref=0ce564a7e19ac17a7dfad8f94ad009d5e03200bc", "patch": "@@ -150,4 +150,29 @@ fn match_as_ref() {\n     };\n }\n \n-fn main() {}\n+macro_rules! foo_variant(\n+    ($idx:expr) => (Foo::get($idx).unwrap())\n+);\n+\n+enum Foo {\n+    A,\n+    B,\n+}\n+\n+impl Foo {\n+    fn get(idx: u8) -> Option<&'static Self> {\n+        match idx {\n+            0 => Some(&Foo::A),\n+            1 => Some(&Foo::B),\n+            _ => None,\n+        }\n+    }\n+}\n+\n+fn main() {\n+    // ICE #3719\n+    match foo_variant!(0) {\n+        &Foo::A => println!(\"A\"),\n+        _ => println!(\"Wild\"),\n+    }\n+}"}, {"sha": "b4159f7a68d08b28309fdd8e7715e8242b778b7b", "filename": "tests/ui/matches.stderr", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/0ce564a7e19ac17a7dfad8f94ad009d5e03200bc/tests%2Fui%2Fmatches.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0ce564a7e19ac17a7dfad8f94ad009d5e03200bc/tests%2Fui%2Fmatches.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmatches.stderr?ref=0ce564a7e19ac17a7dfad8f94ad009d5e03200bc", "patch": "@@ -278,5 +278,19 @@ LL | |         Some(ref mut v) => Some(v),\n LL | |     };\n    | |_____^ help: try this: `mut_owned.as_mut()`\n \n-error: aborting due to 19 previous errors\n+error: you don't need to add `&` to all patterns\n+  --> $DIR/matches.rs:174:5\n+   |\n+LL | /     match foo_variant!(0) {\n+LL | |         &Foo::A => println!(\"A\"),\n+LL | |         _ => println!(\"Wild\"),\n+LL | |     }\n+   | |_____^\n+help: instead of prefixing all patterns with `&`, you can dereference the expression\n+   |\n+LL |     match *foo_variant!(0) {\n+LL |         Foo::A => println!(\"A\"),\n+   |\n+\n+error: aborting due to 20 previous errors\n "}]}