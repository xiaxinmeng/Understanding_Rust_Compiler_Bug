{"sha": "430bd39a0da2b17e5c7ca4842e25b7f523c51522", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQzMGJkMzlhMGRhMmIxN2U1YzdjYTQ4NDJlMjViN2Y1MjNjNTE1MjI=", "commit": {"author": {"name": "Yuki Okushi", "email": "huyuumi.dev@gmail.com", "date": "2020-07-22T05:42:45Z"}, "committer": {"name": "Yuki Okushi", "email": "huyuumi.dev@gmail.com", "date": "2020-07-22T05:43:11Z"}, "message": "Do not ICE on assoc type with bad placeholder", "tree": {"sha": "f905740d0692e721c6bf6b1e20e081fd0fce1e06", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f905740d0692e721c6bf6b1e20e081fd0fce1e06"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/430bd39a0da2b17e5c7ca4842e25b7f523c51522", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEXmatGLoofN5+9u4rsJhshcDi2qEFAl8X0e8ACgkQsJhshcDi\n2qGS+Q/8CNM4DEwwncai/tqVH8d8zki7PwMRQDH5jkF/dtUauAEkX6LGEnVnSo9u\nyD2HaSa+GO7OnDjALOFbKEdPxK9xLZ7tRkBAFB2xDB6xw7XpJv8VKrEbfnifNYhG\noWNEH9CKoC2xQ9Z57IJYkLbJ8Sb/MU/nZHzzXmcUg57ML8fl+XwBQF2WagUk9cKQ\nrXbBKQIM0WAKnkEP2tD6NJQqQ2zFLmZCL8DRwFATPxnKXDkPkFXI2nqkaGIIf8pe\nu7Qg/SfWR9cLqzZWU03ScPThLqDCQKfzszrzLV903N2N5zrzYN7HP7lYAeC6lXIA\nDPNJ9MJYklS7WUVC4pNmqH37z3cNlXNOmt34TAmtDIZ6dfLgHQbFWBaTWKE9Z0sg\nie4hUJX9N+HwElFVyA7ISPl7nDoTDIYaTBZZmaKW446iQtfMWJlqrFx/PhlSCS6O\nIEtnvBmD1eI/6LulAm9jZmgJWk+mehruWk2FySt8QS11P3yTLcAIXAmM5Vh9PQqg\nS25JrSR67DbSW+WLkIXb1bcOfxxMPCYKQmKh4ubX/b9rRg3svUOiwSLYJWQDbnOi\nuKVeAS+kP45TBVL+ez78UTBy7OhFFGRzg5mTG4ILza+/hBHNpiTDd3zxu871uqIK\n5DL3nIRUFoI6iUK5UMuUmn/RRQpORJdzjnbw6Umnxb5R7ynW/aE=\n=tVEi\n-----END PGP SIGNATURE-----", "payload": "tree f905740d0692e721c6bf6b1e20e081fd0fce1e06\nparent aca77cdd8ff05218318a7ba7f750984ba48eb1f3\nauthor Yuki Okushi <huyuumi.dev@gmail.com> 1595396565 +0900\ncommitter Yuki Okushi <huyuumi.dev@gmail.com> 1595396591 +0900\n\nDo not ICE on assoc type with bad placeholder\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/430bd39a0da2b17e5c7ca4842e25b7f523c51522", "html_url": "https://github.com/rust-lang/rust/commit/430bd39a0da2b17e5c7ca4842e25b7f523c51522", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/430bd39a0da2b17e5c7ca4842e25b7f523c51522/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "aca77cdd8ff05218318a7ba7f750984ba48eb1f3", "url": "https://api.github.com/repos/rust-lang/rust/commits/aca77cdd8ff05218318a7ba7f750984ba48eb1f3", "html_url": "https://github.com/rust-lang/rust/commit/aca77cdd8ff05218318a7ba7f750984ba48eb1f3"}], "stats": {"total": 28, "additions": 21, "deletions": 7}, "files": [{"sha": "cb9348a9521bcd6e05f4061080d41ac76752cdd7", "filename": "src/librustc_typeck/collect.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/430bd39a0da2b17e5c7ca4842e25b7f523c51522/src%2Flibrustc_typeck%2Fcollect.rs", "raw_url": "https://github.com/rust-lang/rust/raw/430bd39a0da2b17e5c7ca4842e25b7f523c51522/src%2Flibrustc_typeck%2Fcollect.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcollect.rs?ref=430bd39a0da2b17e5c7ca4842e25b7f523c51522", "patch": "@@ -730,7 +730,13 @@ fn convert_trait_item(tcx: TyCtxt<'_>, trait_item_id: hir::HirId) {\n             placeholder_type_error(tcx, None, &[], visitor.0, false);\n         }\n \n-        hir::TraitItemKind::Type(_, None) => {}\n+        hir::TraitItemKind::Type(_, None) => {\n+            // #74612: Visit and try to find bad placeholders\n+            // even if there is no concrete type.\n+            let mut visitor = PlaceholderHirTyCollector::default();\n+            visitor.visit_trait_item(trait_item);\n+            placeholder_type_error(tcx, None, &[], visitor.0, false);\n+        }\n     };\n \n     tcx.ensure().predicates_of(def_id);"}, {"sha": "2c8b1e76b1b82984d7a677a07d53c27b6c849f23", "filename": "src/test/ui/typeck/typeck_type_placeholder_item.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/430bd39a0da2b17e5c7ca4842e25b7f523c51522/src%2Ftest%2Fui%2Ftypeck%2Ftypeck_type_placeholder_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/430bd39a0da2b17e5c7ca4842e25b7f523c51522/src%2Ftest%2Fui%2Ftypeck%2Ftypeck_type_placeholder_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftypeck%2Ftypeck_type_placeholder_item.rs?ref=430bd39a0da2b17e5c7ca4842e25b7f523c51522", "patch": "@@ -194,6 +194,8 @@ trait Qux {\n     const D: _ = 42;\n     //~^ ERROR the type placeholder `_` is not allowed within types on item signatures\n     // type E: _; // FIXME: make the parser propagate the existence of `B`\n+    type F: std::ops::Fn(_);\n+    //~^ ERROR the type placeholder `_` is not allowed within types on item signatures\n }\n impl Qux for Struct {\n     type A = _;"}, {"sha": "782ff4948cda46e9032450e063bc65acbfbd44e8", "filename": "src/test/ui/typeck/typeck_type_placeholder_item.stderr", "status": "modified", "additions": 12, "deletions": 6, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/430bd39a0da2b17e5c7ca4842e25b7f523c51522/src%2Ftest%2Fui%2Ftypeck%2Ftypeck_type_placeholder_item.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/430bd39a0da2b17e5c7ca4842e25b7f523c51522/src%2Ftest%2Fui%2Ftypeck%2Ftypeck_type_placeholder_item.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftypeck%2Ftypeck_type_placeholder_item.stderr?ref=430bd39a0da2b17e5c7ca4842e25b7f523c51522", "patch": "@@ -29,7 +29,7 @@ LL | struct BadStruct2<_, T>(_, T);\n    |                   ^ expected identifier, found reserved identifier\n \n error: associated constant in `impl` without body\n-  --> $DIR/typeck_type_placeholder_item.rs:203:5\n+  --> $DIR/typeck_type_placeholder_item.rs:205:5\n    |\n LL |     const C: _;\n    |     ^^^^^^^^^^-\n@@ -545,6 +545,12 @@ LL |     const D: _ = 42;\n    |              not allowed in type signatures\n    |              help: replace `_` with the correct type: `i32`\n \n+error[E0121]: the type placeholder `_` is not allowed within types on item signatures\n+  --> $DIR/typeck_type_placeholder_item.rs:197:26\n+   |\n+LL |     type F: std::ops::Fn(_);\n+   |                          ^ not allowed in type signatures\n+\n error[E0121]: the type placeholder `_` is not allowed within types on item signatures\n   --> $DIR/typeck_type_placeholder_item.rs:40:24\n    |\n@@ -582,33 +588,33 @@ LL |         fn clone(&self) -> _ { FnTest9 }\n    |                            help: replace with the correct return type: `main::FnTest9`\n \n error[E0121]: the type placeholder `_` is not allowed within types on item signatures\n-  --> $DIR/typeck_type_placeholder_item.rs:199:14\n+  --> $DIR/typeck_type_placeholder_item.rs:201:14\n    |\n LL |     type A = _;\n    |              ^ not allowed in type signatures\n \n error[E0121]: the type placeholder `_` is not allowed within types on item signatures\n-  --> $DIR/typeck_type_placeholder_item.rs:201:14\n+  --> $DIR/typeck_type_placeholder_item.rs:203:14\n    |\n LL |     type B = _;\n    |              ^ not allowed in type signatures\n \n error[E0121]: the type placeholder `_` is not allowed within types on item signatures\n-  --> $DIR/typeck_type_placeholder_item.rs:203:14\n+  --> $DIR/typeck_type_placeholder_item.rs:205:14\n    |\n LL |     const C: _;\n    |              ^ not allowed in type signatures\n \n error[E0121]: the type placeholder `_` is not allowed within types on item signatures\n-  --> $DIR/typeck_type_placeholder_item.rs:206:14\n+  --> $DIR/typeck_type_placeholder_item.rs:208:14\n    |\n LL |     const D: _ = 42;\n    |              ^\n    |              |\n    |              not allowed in type signatures\n    |              help: replace `_` with the correct type: `i32`\n \n-error: aborting due to 66 previous errors\n+error: aborting due to 67 previous errors\n \n Some errors have detailed explanations: E0121, E0282, E0403.\n For more information about an error, try `rustc --explain E0121`."}]}