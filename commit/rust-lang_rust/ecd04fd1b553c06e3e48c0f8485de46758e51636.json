{"sha": "ecd04fd1b553c06e3e48c0f8485de46758e51636", "node_id": "C_kwDOAAsO6NoAKGVjZDA0ZmQxYjU1M2MwNmUzZTQ4YzBmODQ4NWRlNDY3NThlNTE2MzY", "commit": {"author": {"name": "Gary Guo", "email": "gary@garyguo.net", "date": "2023-04-07T16:15:41Z"}, "committer": {"name": "Gary Guo", "email": "gary@garyguo.net", "date": "2023-05-07T11:38:47Z"}, "message": "Add test for unwinding past terminating POF", "tree": {"sha": "2954d3739dd9e1bcdfabd7a65680fa8c4e405b5b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2954d3739dd9e1bcdfabd7a65680fa8c4e405b5b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ecd04fd1b553c06e3e48c0f8485de46758e51636", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ecd04fd1b553c06e3e48c0f8485de46758e51636", "html_url": "https://github.com/rust-lang/rust/commit/ecd04fd1b553c06e3e48c0f8485de46758e51636", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ecd04fd1b553c06e3e48c0f8485de46758e51636/comments", "author": {"login": "nbdd0121", "id": 4065244, "node_id": "MDQ6VXNlcjQwNjUyNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4065244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nbdd0121", "html_url": "https://github.com/nbdd0121", "followers_url": "https://api.github.com/users/nbdd0121/followers", "following_url": "https://api.github.com/users/nbdd0121/following{/other_user}", "gists_url": "https://api.github.com/users/nbdd0121/gists{/gist_id}", "starred_url": "https://api.github.com/users/nbdd0121/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nbdd0121/subscriptions", "organizations_url": "https://api.github.com/users/nbdd0121/orgs", "repos_url": "https://api.github.com/users/nbdd0121/repos", "events_url": "https://api.github.com/users/nbdd0121/events{/privacy}", "received_events_url": "https://api.github.com/users/nbdd0121/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nbdd0121", "id": 4065244, "node_id": "MDQ6VXNlcjQwNjUyNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4065244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nbdd0121", "html_url": "https://github.com/nbdd0121", "followers_url": "https://api.github.com/users/nbdd0121/followers", "following_url": "https://api.github.com/users/nbdd0121/following{/other_user}", "gists_url": "https://api.github.com/users/nbdd0121/gists{/gist_id}", "starred_url": "https://api.github.com/users/nbdd0121/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nbdd0121/subscriptions", "organizations_url": "https://api.github.com/users/nbdd0121/orgs", "repos_url": "https://api.github.com/users/nbdd0121/repos", "events_url": "https://api.github.com/users/nbdd0121/events{/privacy}", "received_events_url": "https://api.github.com/users/nbdd0121/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "37f7d322b8cd9e9712c3cc9cf3a550371bd164e0", "url": "https://api.github.com/repos/rust-lang/rust/commits/37f7d322b8cd9e9712c3cc9cf3a550371bd164e0", "html_url": "https://github.com/rust-lang/rust/commit/37f7d322b8cd9e9712c3cc9cf3a550371bd164e0"}], "stats": {"total": 26, "additions": 26, "deletions": 0}, "files": [{"sha": "871621520b910086d55e71940ab503aa368a987d", "filename": "tests/run-make/forced-unwind-terminate-pof/Makefile", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/ecd04fd1b553c06e3e48c0f8485de46758e51636/tests%2Frun-make%2Fforced-unwind-terminate-pof%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/ecd04fd1b553c06e3e48c0f8485de46758e51636/tests%2Frun-make%2Fforced-unwind-terminate-pof%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-make%2Fforced-unwind-terminate-pof%2FMakefile?ref=ecd04fd1b553c06e3e48c0f8485de46758e51636", "patch": "@@ -0,0 +1,9 @@\n+# ignore-cross-compile\n+# only-linux\n+include ../tools.mk\n+\n+all: foo\n+\t$(call RUN,foo) | $(CGREP) -v \"cannot unwind\"\n+\n+foo: foo.rs\n+\t$(RUSTC) $<"}, {"sha": "0a51287313f6e97a8016426f3066ecb987f3e062", "filename": "tests/run-make/forced-unwind-terminate-pof/foo.rs", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/ecd04fd1b553c06e3e48c0f8485de46758e51636/tests%2Frun-make%2Fforced-unwind-terminate-pof%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ecd04fd1b553c06e3e48c0f8485de46758e51636/tests%2Frun-make%2Fforced-unwind-terminate-pof%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-make%2Fforced-unwind-terminate-pof%2Ffoo.rs?ref=ecd04fd1b553c06e3e48c0f8485de46758e51636", "patch": "@@ -0,0 +1,17 @@\n+// Tests that forced unwind through POF Rust frames wouldn't trigger our terminating guards.\n+\n+#![feature(c_unwind)]\n+#![no_main]\n+\n+extern \"C-unwind\" {\n+    fn pthread_exit(v: *mut core::ffi::c_void) -> !;\n+}\n+\n+unsafe extern \"C\" fn call_pthread_exit() {\n+    pthread_exit(core::ptr::null_mut());\n+}\n+\n+#[no_mangle]\n+unsafe extern \"C-unwind\" fn main(_argc: core::ffi::c_int, _argv: *mut *mut core::ffi::c_char) {\n+    call_pthread_exit();\n+}"}]}