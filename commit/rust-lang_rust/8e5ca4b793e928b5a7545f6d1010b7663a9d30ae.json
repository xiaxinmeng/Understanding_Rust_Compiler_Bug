{"sha": "8e5ca4b793e928b5a7545f6d1010b7663a9d30ae", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhlNWNhNGI3OTNlOTI4YjVhNzU0NWY2ZDEwMTBiNzY2M2E5ZDMwYWU=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2014-03-14T17:34:29Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2014-03-14T17:34:29Z"}, "message": "std: Fix backtraces on arm linux\n\nOn android, libgcc is missing the _Unwind_GetIP symbol because it's defined as a\nmacro. This is the same case for arm linux, so this commit adds the necessary\ncfgs in place to use the \"expanded macro\" in rust for arm linux.", "tree": {"sha": "683c20d70e0328f8867dcccba4ebefa5646d7efa", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/683c20d70e0328f8867dcccba4ebefa5646d7efa"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8e5ca4b793e928b5a7545f6d1010b7663a9d30ae", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8e5ca4b793e928b5a7545f6d1010b7663a9d30ae", "html_url": "https://github.com/rust-lang/rust/commit/8e5ca4b793e928b5a7545f6d1010b7663a9d30ae", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8e5ca4b793e928b5a7545f6d1010b7663a9d30ae/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "770b6e2fc2f8749466487e4c2ae031b8ceecae04", "url": "https://api.github.com/repos/rust-lang/rust/commits/770b6e2fc2f8749466487e4c2ae031b8ceecae04", "html_url": "https://github.com/rust-lang/rust/commit/770b6e2fc2f8749466487e4c2ae031b8ceecae04"}], "stats": {"total": 15, "additions": 13, "deletions": 2}, "files": [{"sha": "a556db2a05385ea992354be159232a70253b5b48", "filename": "src/libstd/rt/libunwind.rs", "status": "modified", "additions": 13, "deletions": 2, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/8e5ca4b793e928b5a7545f6d1010b7663a9d30ae/src%2Flibstd%2Frt%2Flibunwind.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8e5ca4b793e928b5a7545f6d1010b7663a9d30ae/src%2Flibstd%2Frt%2Flibunwind.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Frt%2Flibunwind.rs?ref=8e5ca4b793e928b5a7545f6d1010b7663a9d30ae", "patch": "@@ -98,16 +98,26 @@ extern \"C\" {\n     pub fn _Unwind_Backtrace(trace: _Unwind_Trace_Fn,\n                              trace_argument: *libc::c_void)\n                 -> _Unwind_Reason_Code;\n-    #[cfg(not(target_os = \"android\"))]\n+    #[cfg(stage0, not(target_os = \"android\"))]\n     pub fn _Unwind_GetIP(ctx: *_Unwind_Context) -> libc::uintptr_t;\n-    #[cfg(not(target_os = \"android\"))]\n+    #[cfg(stage0, not(target_os = \"android\"))]\n+    pub fn _Unwind_FindEnclosingFunction(pc: *libc::c_void) -> *libc::c_void;\n+\n+    #[cfg(not(stage0),\n+          not(target_os = \"android\"),\n+          not(target_os = \"linux\", target_arch = \"arm\"))]\n+    pub fn _Unwind_GetIP(ctx: *_Unwind_Context) -> libc::uintptr_t;\n+    #[cfg(not(stage0),\n+          not(target_os = \"android\"),\n+          not(target_os = \"linux\", target_arch = \"arm\"))]\n     pub fn _Unwind_FindEnclosingFunction(pc: *libc::c_void) -> *libc::c_void;\n }\n \n // On android, the function _Unwind_GetIP is a macro, and this is the expansion\n // of the macro. This is all copy/pasted directly from the header file with the\n // definition of _Unwind_GetIP.\n #[cfg(target_os = \"android\")]\n+#[cfg(target_os = \"linux\", target_os = \"arm\")]\n pub unsafe fn _Unwind_GetIP(ctx: *_Unwind_Context) -> libc::uintptr_t {\n     #[repr(C)]\n     enum _Unwind_VRS_Result {\n@@ -151,6 +161,7 @@ pub unsafe fn _Unwind_GetIP(ctx: *_Unwind_Context) -> libc::uintptr_t {\n \n // This function also doesn't exist on android, so make it a no-op\n #[cfg(target_os = \"android\")]\n+#[cfg(target_os = \"linux\", target_os = \"arm\")]\n pub unsafe fn _Unwind_FindEnclosingFunction(pc: *libc::c_void) -> *libc::c_void{\n     pc\n }"}]}