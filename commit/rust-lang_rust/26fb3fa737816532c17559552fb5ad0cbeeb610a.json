{"sha": "26fb3fa737816532c17559552fb5ad0cbeeb610a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI2ZmIzZmE3Mzc4MTY1MzJjMTc1NTk1NTJmYjVhZDBjYmVlYjYxMGE=", "commit": {"author": {"name": "Joshua Nelson", "email": "jyn514@gmail.com", "date": "2021-02-17T18:29:00Z"}, "committer": {"name": "Caleb Cartwright", "email": "calebcartwright@users.noreply.github.com", "date": "2021-04-22T02:17:36Z"}, "message": "Use rustup in CI to automatically determine the toolchain version needed\n\nThis also removes the (now unused) `RUSTC_RELEASE` and\n`RUSTC_RELEASE_CHANNEL` variables.", "tree": {"sha": "3d131349edf59d895a04662af855cfd7d6d37e35", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3d131349edf59d895a04662af855cfd7d6d37e35"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/26fb3fa737816532c17559552fb5ad0cbeeb610a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/26fb3fa737816532c17559552fb5ad0cbeeb610a", "html_url": "https://github.com/rust-lang/rust/commit/26fb3fa737816532c17559552fb5ad0cbeeb610a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/26fb3fa737816532c17559552fb5ad0cbeeb610a/comments", "author": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "committer": {"login": "calebcartwright", "id": 13042488, "node_id": "MDQ6VXNlcjEzMDQyNDg4", "avatar_url": "https://avatars.githubusercontent.com/u/13042488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/calebcartwright", "html_url": "https://github.com/calebcartwright", "followers_url": "https://api.github.com/users/calebcartwright/followers", "following_url": "https://api.github.com/users/calebcartwright/following{/other_user}", "gists_url": "https://api.github.com/users/calebcartwright/gists{/gist_id}", "starred_url": "https://api.github.com/users/calebcartwright/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/calebcartwright/subscriptions", "organizations_url": "https://api.github.com/users/calebcartwright/orgs", "repos_url": "https://api.github.com/users/calebcartwright/repos", "events_url": "https://api.github.com/users/calebcartwright/events{/privacy}", "received_events_url": "https://api.github.com/users/calebcartwright/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "943b97c3aedb5f7ed7a585dc986687ef377e1a91", "url": "https://api.github.com/repos/rust-lang/rust/commits/943b97c3aedb5f7ed7a585dc986687ef377e1a91", "html_url": "https://github.com/rust-lang/rust/commit/943b97c3aedb5f7ed7a585dc986687ef377e1a91"}], "stats": {"total": 84, "additions": 27, "deletions": 57}, "files": [{"sha": "b79221d0543694426f2a460b6f60575c81acb6a7", "filename": ".github/workflows/integration.yml", "status": "modified", "additions": 5, "deletions": 8, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/26fb3fa737816532c17559552fb5ad0cbeeb610a/.github%2Fworkflows%2Fintegration.yml", "raw_url": "https://github.com/rust-lang/rust/raw/26fb3fa737816532c17559552fb5ad0cbeeb610a/.github%2Fworkflows%2Fintegration.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fintegration.yml?ref=26fb3fa737816532c17559552fb5ad0cbeeb610a", "patch": "@@ -72,14 +72,11 @@ jobs:\n       uses: actions/checkout@v2\n \n       # Run build\n-    - name: setup\n-      uses: actions-rs/toolchain@v1\n-      with:\n-        toolchain: nightly-x86_64-unknown-linux-gnu\n-        target: x86_64-unknown-linux-gnu\n-        override: true\n-        profile: minimal\n-        default: true\n+    - name: install rustup\n+      run: |\n+        curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs > rustup-init.sh\n+        sh rustup-init.sh -y --default-toolchain none\n+\n     - name: run integration tests\n       env:\n         INTEGRATION: ${{ matrix.integration }}"}, {"sha": "6eaae69c708056c56c0e6c8d44883fb8625f241b", "filename": ".github/workflows/linux.yml", "status": "modified", "additions": 6, "deletions": 18, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/26fb3fa737816532c17559552fb5ad0cbeeb610a/.github%2Fworkflows%2Flinux.yml", "raw_url": "https://github.com/rust-lang/rust/raw/26fb3fa737816532c17559552fb5ad0cbeeb610a/.github%2Fworkflows%2Flinux.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Flinux.yml?ref=26fb3fa737816532c17559552fb5ad0cbeeb610a", "patch": "@@ -8,7 +8,7 @@ on:\n jobs:\n   test:\n     runs-on: ubuntu-latest\n-    name: (${{ matrix.target }}, ${{ matrix.channel }}, ${{ matrix.cfg-release-channel }})\n+    name: (${{ matrix.target }}, nightly)\n     strategy:\n       # https://help.github.com/en/actions/getting-started-with-github-actions/about-github-actions#usage-limits\n       # There's a limit of 60 concurrent jobs across all repos in the rust-lang organization.\n@@ -20,29 +20,17 @@ jobs:\n         target: [\n           x86_64-unknown-linux-gnu,\n         ]\n-        channel: [ nightly ]\n-        cfg-release-channel: [\n-          beta,\n-          nightly,\n-        ]\n-\n-    env:\n-      CFG_RELEASE_CHANNEL: ${{ matrix.cfg-release-channel }}\n-      CFG_RELEASE: ${{ matrix.cfg-release-channel }}\n \n     steps:\n     - name: checkout\n       uses: actions/checkout@v2\n \n       # Run build\n-    - name: setup\n-      uses: actions-rs/toolchain@v1\n-      with:\n-        toolchain: ${{ matrix.channel }}-${{ matrix.target }}\n-        target: ${{ matrix.target }}\n-        override: true\n-        profile: minimal\n-        default: true\n+    - name: install rustup\n+      run: |\n+        curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs > rustup-init.sh\n+        sh rustup-init.sh -y --default-toolchain none\n+        rustup target add ${{ matrix.target }}\n \n     - name: build\n       run: |"}, {"sha": "79e4f69163e030b3a5eae659ab0165cb093790bf", "filename": ".github/workflows/mac.yml", "status": "modified", "additions": 6, "deletions": 14, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/26fb3fa737816532c17559552fb5ad0cbeeb610a/.github%2Fworkflows%2Fmac.yml", "raw_url": "https://github.com/rust-lang/rust/raw/26fb3fa737816532c17559552fb5ad0cbeeb610a/.github%2Fworkflows%2Fmac.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fmac.yml?ref=26fb3fa737816532c17559552fb5ad0cbeeb610a", "patch": "@@ -10,32 +10,24 @@ jobs:\n     # https://help.github.com/en/actions/automating-your-workflow-with-github-actions/virtual-environments-for-github-hosted-runners#supported-runners-and-hardware-resources\n     # macOS Catalina 10.15\n     runs-on: macos-latest\n-    name: (${{ matrix.target }}, ${{ matrix.channel }})\n+    name: (${{ matrix.target }}, nightly)\n     strategy:\n       fail-fast: false\n       matrix:\n         target: [\n           x86_64-apple-darwin,\n         ]\n-        channel: [ nightly ]\n-\n-    env:\n-      CFG_RELEASE_CHANNEL: nightly\n-      CFG_RELEASE: nightly\n \n     steps:\n     - name: checkout\n       uses: actions/checkout@v2\n \n       # Run build\n-    - name: setup\n-      uses: actions-rs/toolchain@v1\n-      with:\n-        toolchain: ${{ matrix.channel }}-${{ matrix.target }}\n-        target: ${{ matrix.target }}\n-        override: true\n-        profile: minimal\n-        default: true\n+    - name: install rustup\n+      run: |\n+        curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs > rustup-init.sh\n+        sh rustup-init.sh -y --default-toolchain none\n+        rustup target add ${{ matrix.target }}\n \n     - name: build\n       run: |"}, {"sha": "08cb52eedaea789ad2550f97e11e6dd92e2f2f37", "filename": ".github/workflows/windows.yml", "status": "modified", "additions": 10, "deletions": 17, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/26fb3fa737816532c17559552fb5ad0cbeeb610a/.github%2Fworkflows%2Fwindows.yml", "raw_url": "https://github.com/rust-lang/rust/raw/26fb3fa737816532c17559552fb5ad0cbeeb610a/.github%2Fworkflows%2Fwindows.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fwindows.yml?ref=26fb3fa737816532c17559552fb5ad0cbeeb610a", "patch": "@@ -8,7 +8,7 @@ on:\n jobs:\n   test:\n     runs-on: windows-latest\n-    name: (${{ matrix.target }}, ${{ matrix.channel }})\n+    name: (${{ matrix.target }}, nightly)\n     strategy:\n       # https://help.github.com/en/actions/getting-started-with-github-actions/about-github-actions#usage-limits\n       # There's a limit of 60 concurrent jobs across all repos in the rust-lang organization.\n@@ -23,14 +23,6 @@ jobs:\n           x86_64-pc-windows-gnu,\n           x86_64-pc-windows-msvc,\n         ]\n-        channel: [ nightly ]\n-        include:\n-          - channel: nightly\n-            target: i686-pc-windows-gnu\n-\n-    env:\n-      CFG_RELEASE_CHANNEL: nightly\n-      CFG_RELEASE: nightly\n \n     steps:\n     # The Windows runners have autocrlf enabled by default\n@@ -41,14 +33,15 @@ jobs:\n       uses: actions/checkout@v2\n \n       # Run build\n-    - name: setup\n-      uses: actions-rs/toolchain@v1\n-      with:\n-        toolchain: ${{ matrix.channel }}-${{ matrix.target }}\n-        target: ${{ matrix.target }}\n-        override: true\n-        profile: minimal\n-        default: true\n+    - name: Install Rustup using win.rustup.rs\n+      run: |\n+        # Disable the download progress bar which can cause perf issues\n+        $ProgressPreference = \"SilentlyContinue\"\n+        Invoke-WebRequest https://win.rustup.rs/ -OutFile rustup-init.exe\n+        .\\rustup-init.exe -y --default-host=x86_64-pc-windows-msvc --default-toolchain=none\n+        del rustup-init.exe\n+        rustup target add ${{ matrix.target }}\n+      shell: powershell\n \n     - name: Add mingw32 to path for i686-gnu\n       run: |"}]}