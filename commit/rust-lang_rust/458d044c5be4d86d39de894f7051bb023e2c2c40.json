{"sha": "458d044c5be4d86d39de894f7051bb023e2c2c40", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ1OGQwNDRjNWJlNGQ4NmQzOWRlODk0ZjcwNTFiYjAyM2UyYzJjNDA=", "commit": {"author": {"name": "Camille GILLOT", "email": "gillot.camille@gmail.com", "date": "2021-03-17T16:29:45Z"}, "committer": {"name": "Camille GILLOT", "email": "gillot.camille@gmail.com", "date": "2021-03-18T17:36:55Z"}, "message": "Upgrade memmap to memmap2 in other crates.", "tree": {"sha": "0f3d915769b51c16d2a7df825e2263700ea6879c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0f3d915769b51c16d2a7df825e2263700ea6879c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/458d044c5be4d86d39de894f7051bb023e2c2c40", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/458d044c5be4d86d39de894f7051bb023e2c2c40", "html_url": "https://github.com/rust-lang/rust/commit/458d044c5be4d86d39de894f7051bb023e2c2c40", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/458d044c5be4d86d39de894f7051bb023e2c2c40/comments", "author": {"login": "cjgillot", "id": 1822483, "node_id": "MDQ6VXNlcjE4MjI0ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1822483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjgillot", "html_url": "https://github.com/cjgillot", "followers_url": "https://api.github.com/users/cjgillot/followers", "following_url": "https://api.github.com/users/cjgillot/following{/other_user}", "gists_url": "https://api.github.com/users/cjgillot/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjgillot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjgillot/subscriptions", "organizations_url": "https://api.github.com/users/cjgillot/orgs", "repos_url": "https://api.github.com/users/cjgillot/repos", "events_url": "https://api.github.com/users/cjgillot/events{/privacy}", "received_events_url": "https://api.github.com/users/cjgillot/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cjgillot", "id": 1822483, "node_id": "MDQ6VXNlcjE4MjI0ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1822483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjgillot", "html_url": "https://github.com/cjgillot", "followers_url": "https://api.github.com/users/cjgillot/followers", "following_url": "https://api.github.com/users/cjgillot/following{/other_user}", "gists_url": "https://api.github.com/users/cjgillot/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjgillot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjgillot/subscriptions", "organizations_url": "https://api.github.com/users/cjgillot/orgs", "repos_url": "https://api.github.com/users/cjgillot/repos", "events_url": "https://api.github.com/users/cjgillot/events{/privacy}", "received_events_url": "https://api.github.com/users/cjgillot/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0ce0fedb67fa66d50aa819ef8b12f1d89eb22d7d", "url": "https://api.github.com/repos/rust-lang/rust/commits/0ce0fedb67fa66d50aa819ef8b12f1d89eb22d7d", "html_url": "https://github.com/rust-lang/rust/commit/0ce0fedb67fa66d50aa819ef8b12f1d89eb22d7d"}], "stats": {"total": 26, "additions": 18, "deletions": 8}, "files": [{"sha": "e0c9d9f6e921630032203e49e444ed6e0e99962a", "filename": "Cargo.lock", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/458d044c5be4d86d39de894f7051bb023e2c2c40/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/458d044c5be4d86d39de894f7051bb023e2c2c40/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=458d044c5be4d86d39de894f7051bb023e2c2c40", "patch": "@@ -2158,6 +2158,15 @@ dependencies = [\n  \"winapi 0.3.9\",\n ]\n \n+[[package]]\n+name = \"memmap2\"\n+version = \"0.2.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"04e3e85b970d650e2ae6d70592474087051c11c54da7f7b4949725c5735fbcc6\"\n+dependencies = [\n+ \"libc\",\n+]\n+\n [[package]]\n name = \"memoffset\"\n version = \"0.5.5\"\n@@ -3776,7 +3785,7 @@ dependencies = [\n  \"itertools 0.9.0\",\n  \"jobserver\",\n  \"libc\",\n- \"memmap\",\n+ \"memmap2\",\n  \"pathdiff\",\n  \"rustc_apfloat\",\n  \"rustc_ast\",\n@@ -4110,7 +4119,7 @@ name = \"rustc_metadata\"\n version = \"0.0.0\"\n dependencies = [\n  \"libc\",\n- \"memmap\",\n+ \"memmap2\",\n  \"rustc_ast\",\n  \"rustc_attr\",\n  \"rustc_data_structures\","}, {"sha": "15dbbbd49aa563f3bd62662837a12c9d83f2ac14", "filename": "compiler/rustc_codegen_ssa/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/458d044c5be4d86d39de894f7051bb023e2c2c40/compiler%2Frustc_codegen_ssa%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/458d044c5be4d86d39de894f7051bb023e2c2c40/compiler%2Frustc_codegen_ssa%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_ssa%2FCargo.toml?ref=458d044c5be4d86d39de894f7051bb023e2c2c40", "patch": "@@ -11,7 +11,7 @@ test = false\n bitflags = \"1.2.1\"\n cc = \"1.0.1\"\n itertools = \"0.9\"\n-memmap = \"0.7\"\n+memmap2 = \"0.2.1\"\n tracing = \"0.1\"\n libc = \"0.2.50\"\n jobserver = \"0.1.11\""}, {"sha": "c6aea22a63eb7cd0ecf17796e129c8f531ea6c14", "filename": "compiler/rustc_codegen_ssa/src/back/lto.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/458d044c5be4d86d39de894f7051bb023e2c2c40/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Flto.rs", "raw_url": "https://github.com/rust-lang/rust/raw/458d044c5be4d86d39de894f7051bb023e2c2c40/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Flto.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Flto.rs?ref=458d044c5be4d86d39de894f7051bb023e2c2c40", "patch": "@@ -93,7 +93,7 @@ impl<B: WriteBackendMethods> LtoModuleCodegen<B> {\n pub enum SerializedModule<M: ModuleBufferMethods> {\n     Local(M),\n     FromRlib(Vec<u8>),\n-    FromUncompressedFile(memmap::Mmap),\n+    FromUncompressedFile(memmap2::Mmap),\n }\n \n impl<M: ModuleBufferMethods> SerializedModule<M> {"}, {"sha": "490b3d33112840aba9f70e96a588d61cb4122866", "filename": "compiler/rustc_codegen_ssa/src/back/write.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/458d044c5be4d86d39de894f7051bb023e2c2c40/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Fwrite.rs", "raw_url": "https://github.com/rust-lang/rust/raw/458d044c5be4d86d39de894f7051bb023e2c2c40/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Fwrite.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Fwrite.rs?ref=458d044c5be4d86d39de894f7051bb023e2c2c40", "patch": "@@ -1958,7 +1958,7 @@ pub fn submit_pre_lto_module_to_llvm<B: ExtraBackendMethods>(\n         .unwrap_or_else(|e| panic!(\"failed to open bitcode file `{}`: {}\", bc_path.display(), e));\n \n     let mmap = unsafe {\n-        memmap::Mmap::map(&file).unwrap_or_else(|e| {\n+        memmap2::Mmap::map(&file).unwrap_or_else(|e| {\n             panic!(\"failed to mmap bitcode file `{}`: {}\", bc_path.display(), e)\n         })\n     };"}, {"sha": "48effed927493c873772ab2a000987adaacdc61d", "filename": "compiler/rustc_metadata/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/458d044c5be4d86d39de894f7051bb023e2c2c40/compiler%2Frustc_metadata%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/458d044c5be4d86d39de894f7051bb023e2c2c40/compiler%2Frustc_metadata%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_metadata%2FCargo.toml?ref=458d044c5be4d86d39de894f7051bb023e2c2c40", "patch": "@@ -11,7 +11,7 @@ doctest = false\n libc = \"0.2\"\n snap = \"1\"\n tracing = \"0.1\"\n-memmap = \"0.7\"\n+memmap2 = \"0.2.1\"\n smallvec = { version = \"1.6.1\", features = [\"union\", \"may_dangle\"] }\n rustc_middle = { path = \"../rustc_middle\" }\n rustc_attr = { path = \"../rustc_attr\" }"}, {"sha": "39a39917f578caea0d55d2017a2e7df036967bca", "filename": "compiler/rustc_metadata/src/locator.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/458d044c5be4d86d39de894f7051bb023e2c2c40/compiler%2Frustc_metadata%2Fsrc%2Flocator.rs", "raw_url": "https://github.com/rust-lang/rust/raw/458d044c5be4d86d39de894f7051bb023e2c2c40/compiler%2Frustc_metadata%2Fsrc%2Flocator.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_metadata%2Fsrc%2Flocator.rs?ref=458d044c5be4d86d39de894f7051bb023e2c2c40", "patch": "@@ -728,7 +728,7 @@ impl<'a> CrateLocator<'a> {\n }\n \n /// A trivial wrapper for `Mmap` that implements `StableDeref`.\n-struct StableDerefMmap(memmap::Mmap);\n+struct StableDerefMmap(memmap2::Mmap);\n \n impl Deref for StableDerefMmap {\n     type Target = [u8];\n@@ -779,7 +779,7 @@ fn get_metadata_section(\n             // mmap the file, because only a small fraction of it is read.\n             let file = std::fs::File::open(filename)\n                 .map_err(|_| format!(\"failed to open rmeta metadata: '{}'\", filename.display()))?;\n-            let mmap = unsafe { memmap::Mmap::map(&file) };\n+            let mmap = unsafe { memmap2::Mmap::map(&file) };\n             let mmap = mmap\n                 .map_err(|_| format!(\"failed to mmap rmeta metadata: '{}'\", filename.display()))?;\n "}, {"sha": "96a02038638af8dd3096b51a5a8e782a45925e5c", "filename": "src/tools/tidy/src/deps.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/458d044c5be4d86d39de894f7051bb023e2c2c40/src%2Ftools%2Ftidy%2Fsrc%2Fdeps.rs", "raw_url": "https://github.com/rust-lang/rust/raw/458d044c5be4d86d39de894f7051bb023e2c2c40/src%2Ftools%2Ftidy%2Fsrc%2Fdeps.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Ftidy%2Fsrc%2Fdeps.rs?ref=458d044c5be4d86d39de894f7051bb023e2c2c40", "patch": "@@ -123,6 +123,7 @@ const PERMITTED_DEPENDENCIES: &[&str] = &[\n     \"measureme\",\n     \"memchr\",\n     \"memmap\",\n+    \"memmap2\",\n     \"memoffset\",\n     \"miniz_oxide\",\n     \"num_cpus\","}]}