{"sha": "1834f326c4a2b732c7c62bf7b00efca8af3b290a", "node_id": "C_kwDOAAsO6NoAKDE4MzRmMzI2YzRhMmI3MzJjN2M2MmJmN2IwMGVmY2E4YWYzYjI5MGE", "commit": {"author": {"name": "flip1995", "email": "philipp.krones@embecosm.com", "date": "2022-05-03T15:41:12Z"}, "committer": {"name": "flip1995", "email": "philipp.krones@embecosm.com", "date": "2022-05-03T15:41:12Z"}, "message": "Move only_used_in_recursion to nursery", "tree": {"sha": "4ee3a11beaa6ca7c234959f89bc2c9a54f4128af", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4ee3a11beaa6ca7c234959f89bc2c9a54f4128af"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1834f326c4a2b732c7c62bf7b00efca8af3b290a", "comment_count": 0, "verification": {"verified": false, "reason": "bad_email", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEij1UXJ/PQTcb99vTHKDfKvWdaKUFAmJxTRgACgkQHKDfKvWd\naKXMtw/+KQ6gphMyXYgacOtJw1YpLazxUpef6PFrtHnt24tpM/UzAGi9IWLxgPTW\n7MBsliRWQZln3CjsfH72ZFttWlKHPp19jHubtafVy+hei2i/ibAVZ74/64EClG7S\nnZ3Uj029lgKX2z1UAYlZ21of5y1A/WI+H7CSKhkLi35MyxP0r/U89rp4J344hoLu\nHJpfYar5zDZGJDbes+ZYz/NmiMJbMwMxzKzCls8BR9pJ1Il3wbMSnY/l/HQY54Tu\n+91Kz51Em+7rJ4jFDVMdiL6D0zc6i7hI1TeD93lgURIBFSleW5T2vGMk+XKAy6l3\nHqXnDqeGjiCBfMsUpLPFGYxjjJZPIKJf5RO75O5gKCatNrwfJS6kUtdXrTcFrTnz\nDGyUg5SFZcpluks1aftClzdG3o3l/XZTwT/8u5gi4x5pn49T1b1fjGg/4VXrCN8M\n7O/zUrPgaOpp0eQONc4yqU0fUUUgAvt6dtQGGJerftu5dKap3pdAZq1WI+FcV9ZM\nanHn+IEfMKI4yNsqDEkdZP4m2X2sp7GgF07Q/xkr74rm+8oVwPH8ufee6YJsxegu\nlWtG1mjATcX5XVSvhOmLadokKrYlEkPCrkBof3qM+82p9oTXlJAQ8EJVt1+ABo40\nAnm7qYZ5u0qommiWlxgU/4BpMd9pkob76lEEP7zqME4d74nbg0U=\n=tGEa\n-----END PGP SIGNATURE-----", "payload": "tree 4ee3a11beaa6ca7c234959f89bc2c9a54f4128af\nparent 0ceacbe1854633ed3a4554d4b9ceab4223948b7b\nauthor flip1995 <philipp.krones@embecosm.com> 1651592472 +0100\ncommitter flip1995 <philipp.krones@embecosm.com> 1651592472 +0100\n\nMove only_used_in_recursion to nursery\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1834f326c4a2b732c7c62bf7b00efca8af3b290a", "html_url": "https://github.com/rust-lang/rust/commit/1834f326c4a2b732c7c62bf7b00efca8af3b290a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1834f326c4a2b732c7c62bf7b00efca8af3b290a/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0ceacbe1854633ed3a4554d4b9ceab4223948b7b", "url": "https://api.github.com/repos/rust-lang/rust/commits/0ceacbe1854633ed3a4554d4b9ceab4223948b7b", "html_url": "https://github.com/rust-lang/rust/commit/0ceacbe1854633ed3a4554d4b9ceab4223948b7b"}], "stats": {"total": 12, "additions": 9, "deletions": 3}, "files": [{"sha": "325e74a17788970e6cf03a4455a8a9ccc35a1372", "filename": "clippy_lints/src/lib.register_all.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/1834f326c4a2b732c7c62bf7b00efca8af3b290a/clippy_lints%2Fsrc%2Flib.register_all.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1834f326c4a2b732c7c62bf7b00efca8af3b290a/clippy_lints%2Fsrc%2Flib.register_all.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.register_all.rs?ref=1834f326c4a2b732c7c62bf7b00efca8af3b290a", "patch": "@@ -248,7 +248,6 @@ store.register_group(true, \"clippy::all\", Some(\"clippy_all\"), vec![\n     LintId::of(non_expressive_names::JUST_UNDERSCORES_AND_DIGITS),\n     LintId::of(non_octal_unix_permissions::NON_OCTAL_UNIX_PERMISSIONS),\n     LintId::of(octal_escapes::OCTAL_ESCAPES),\n-    LintId::of(only_used_in_recursion::ONLY_USED_IN_RECURSION),\n     LintId::of(open_options::NONSENSICAL_OPEN_OPTIONS),\n     LintId::of(option_env_unwrap::OPTION_ENV_UNWRAP),\n     LintId::of(overflow_check_conditional::OVERFLOW_CHECK_CONDITIONAL),"}, {"sha": "6f3c433af31a6287b9fce5dee51ad0daaf5f8fcf", "filename": "clippy_lints/src/lib.register_complexity.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/1834f326c4a2b732c7c62bf7b00efca8af3b290a/clippy_lints%2Fsrc%2Flib.register_complexity.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1834f326c4a2b732c7c62bf7b00efca8af3b290a/clippy_lints%2Fsrc%2Flib.register_complexity.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.register_complexity.rs?ref=1834f326c4a2b732c7c62bf7b00efca8af3b290a", "patch": "@@ -68,7 +68,6 @@ store.register_group(true, \"clippy::complexity\", Some(\"clippy_complexity\"), vec!\n     LintId::of(neg_cmp_op_on_partial_ord::NEG_CMP_OP_ON_PARTIAL_ORD),\n     LintId::of(no_effect::NO_EFFECT),\n     LintId::of(no_effect::UNNECESSARY_OPERATION),\n-    LintId::of(only_used_in_recursion::ONLY_USED_IN_RECURSION),\n     LintId::of(overflow_check_conditional::OVERFLOW_CHECK_CONDITIONAL),\n     LintId::of(partialeq_ne_impl::PARTIALEQ_NE_IMPL),\n     LintId::of(precedence::PRECEDENCE),"}, {"sha": "18904a94538904f2d1cf807b98385468fdc606c1", "filename": "clippy_lints/src/lib.register_nursery.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/1834f326c4a2b732c7c62bf7b00efca8af3b290a/clippy_lints%2Fsrc%2Flib.register_nursery.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1834f326c4a2b732c7c62bf7b00efca8af3b290a/clippy_lints%2Fsrc%2Flib.register_nursery.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.register_nursery.rs?ref=1834f326c4a2b732c7c62bf7b00efca8af3b290a", "patch": "@@ -20,6 +20,7 @@ store.register_group(true, \"clippy::nursery\", Some(\"clippy_nursery\"), vec![\n     LintId::of(mutex_atomic::MUTEX_INTEGER),\n     LintId::of(non_send_fields_in_send_ty::NON_SEND_FIELDS_IN_SEND_TY),\n     LintId::of(nonstandard_macro_braces::NONSTANDARD_MACRO_BRACES),\n+    LintId::of(only_used_in_recursion::ONLY_USED_IN_RECURSION),\n     LintId::of(option_if_let_else::OPTION_IF_LET_ELSE),\n     LintId::of(path_buf_push_overwrite::PATH_BUF_PUSH_OVERWRITE),\n     LintId::of(redundant_pub_crate::REDUNDANT_PUB_CRATE),"}, {"sha": "beb812793f81ccfe5d40a44ef3c6840051d3bc6a", "filename": "clippy_lints/src/only_used_in_recursion.rs", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/1834f326c4a2b732c7c62bf7b00efca8af3b290a/clippy_lints%2Fsrc%2Fonly_used_in_recursion.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1834f326c4a2b732c7c62bf7b00efca8af3b290a/clippy_lints%2Fsrc%2Fonly_used_in_recursion.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fonly_used_in_recursion.rs?ref=1834f326c4a2b732c7c62bf7b00efca8af3b290a", "patch": "@@ -1,6 +1,7 @@\n use std::collections::VecDeque;\n \n use clippy_utils::diagnostics::span_lint_and_sugg;\n+use clippy_utils::is_lint_allowed;\n use itertools::{izip, Itertools};\n use rustc_ast::{walk_list, Label, Mutability};\n use rustc_data_structures::fx::{FxHashMap, FxHashSet};\n@@ -33,6 +34,9 @@ declare_clippy_lint! {\n     /// and the assigned variables are also only in recursion, it is useless.\n     ///\n     /// ### Known problems\n+    /// Too many code paths in the linting code are currently untested and prone to produce false\n+    /// positives or are prone to have performance implications.\n+    ///\n     /// In some cases, this would not catch all useless arguments.\n     ///\n     /// ```rust\n@@ -85,7 +89,7 @@ declare_clippy_lint! {\n     /// ```\n     #[clippy::version = \"1.60.0\"]\n     pub ONLY_USED_IN_RECURSION,\n-    complexity,\n+    nursery,\n     \"arguments that is only used in recursion can be removed\"\n }\n declare_lint_pass!(OnlyUsedInRecursion => [ONLY_USED_IN_RECURSION]);\n@@ -100,6 +104,9 @@ impl<'tcx> LateLintPass<'tcx> for OnlyUsedInRecursion {\n         _: Span,\n         id: HirId,\n     ) {\n+        if is_lint_allowed(cx, ONLY_USED_IN_RECURSION, id) {\n+            return;\n+        }\n         if let FnKind::ItemFn(ident, ..) | FnKind::Method(ident, ..) = kind {\n             let def_id = id.owner.to_def_id();\n             let data = cx.tcx.def_path(def_id).data;"}]}