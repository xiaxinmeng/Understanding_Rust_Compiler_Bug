{"sha": "ed077b741dc96a61adaf85ab02b5ef7aef8b0260", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVkMDc3Yjc0MWRjOTZhNjFhZGFmODVhYjAyYjVlZjdhZWY4YjAyNjA=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2020-02-11T10:08:40Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-02-11T10:08:40Z"}, "message": "Merge pull request #3086 from matklad/auto-publish-extension\n\nPublish VS Code extension automatically", "tree": {"sha": "6d1b7db7197c0e33f2889f5b5e6e1c357bbce572", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6d1b7db7197c0e33f2889f5b5e6e1c357bbce572"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ed077b741dc96a61adaf85ab02b5ef7aef8b0260", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJeQn0oCRBK7hj4Ov3rIwAAdHIIAJe7uwa7DZFUU6OLjRxato2P\nBA28aQWUZmfJUrT5yt46Idjq6F1/0NAv2FJiOBrdUNdl0Hrbg5nrYVfCA4aNbZYf\nJ5NV6HY/XIUY9Ac+7yVOuXK7SQMQMthDixcrzAr8T51uOV6N17NiF9ub8E6rvJux\nm8kny6U3YNJjzgh/s0atetIfXPU2z4vuOy7XrSKHtn0cWpCYUZik5/MJgyM71M7j\nFYo0r7wIpF9iC9/GMEXmtMZjyaZ++1ZyRpAS14L0KlDs0ImYdq4XAtxl8foY7dnd\naS/Y6vRodOtoSyI5leNStmTceaJ2RAogNQCD1+uBO7fM4kwTzcMOq4wVLQJN+Zw=\n=NLzd\n-----END PGP SIGNATURE-----\n", "payload": "tree 6d1b7db7197c0e33f2889f5b5e6e1c357bbce572\nparent f55d74dc0dfc8d3f97c7b815c854a34df6e42300\nparent 27ddb127db5a31375b1512660ccaad40d6fa3eda\nauthor Aleksey Kladov <aleksey.kladov@gmail.com> 1581415720 +0100\ncommitter GitHub <noreply@github.com> 1581415720 +0100\n\nMerge pull request #3086 from matklad/auto-publish-extension\n\nPublish VS Code extension automatically"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ed077b741dc96a61adaf85ab02b5ef7aef8b0260", "html_url": "https://github.com/rust-lang/rust/commit/ed077b741dc96a61adaf85ab02b5ef7aef8b0260", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ed077b741dc96a61adaf85ab02b5ef7aef8b0260/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f55d74dc0dfc8d3f97c7b815c854a34df6e42300", "url": "https://api.github.com/repos/rust-lang/rust/commits/f55d74dc0dfc8d3f97c7b815c854a34df6e42300", "html_url": "https://github.com/rust-lang/rust/commit/f55d74dc0dfc8d3f97c7b815c854a34df6e42300"}, {"sha": "27ddb127db5a31375b1512660ccaad40d6fa3eda", "url": "https://api.github.com/repos/rust-lang/rust/commits/27ddb127db5a31375b1512660ccaad40d6fa3eda", "html_url": "https://github.com/rust-lang/rust/commit/27ddb127db5a31375b1512660ccaad40d6fa3eda"}], "stats": {"total": 22, "additions": 19, "deletions": 3}, "files": [{"sha": "b4c42d0b7f5eaa168b9898d6c3909f6e48e030a2", "filename": ".github/workflows/release.yaml", "status": "modified", "additions": 19, "deletions": 3, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/ed077b741dc96a61adaf85ab02b5ef7aef8b0260/.github%2Fworkflows%2Frelease.yaml", "raw_url": "https://github.com/rust-lang/rust/raw/ed077b741dc96a61adaf85ab02b5ef7aef8b0260/.github%2Fworkflows%2Frelease.yaml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Frelease.yaml?ref=ed077b741dc96a61adaf85ab02b5ef7aef8b0260", "patch": "@@ -106,6 +106,17 @@ jobs:\n     runs-on: ubuntu-latest\n     needs: ['build-server', 'build-clients']\n     steps:\n+      - name: Install Nodejs\n+        uses: actions/setup-node@v1\n+        with:\n+          node-version: 12.x\n+\n+      - run: echo \"::set-env name=TAG::$(date --iso)\"\n+      - run: 'echo \"TAG: $TAG\"'\n+\n+      - name: Checkout repository\n+        uses: actions/checkout@v1\n+\n       - uses: actions/download-artifact@v1\n         with:\n           name: editor-plugins\n@@ -124,9 +135,6 @@ jobs:\n           path: dist\n       - run: ls -all ./dist\n \n-      - run: echo \"::set-env name=TAG::$(date --iso)\"\n-      - run: 'echo \"TAG: $TAG\"'\n-\n       - name: Create Release\n         id: create_release\n         # uses: actions/create-release@v1\n@@ -184,3 +192,11 @@ jobs:\n           asset_path: ./dist/rust-analyzer.el\n           asset_name: rust-analyzer.el\n           asset_content_type: text/plain\n+\n+      - run: npm ci\n+        working-directory: ./editors/code\n+\n+      - name: Publish Extension\n+        working-directory: ./editors/code\n+        # token from https://dev.azure.com/rust-analyzer/\n+        run: ./node_modules/vsce/out/vsce publish 0.1.0.$(date +%Y%m%d) --pat ${{ secrets.MARKETPLACE_TOKEN }}"}]}