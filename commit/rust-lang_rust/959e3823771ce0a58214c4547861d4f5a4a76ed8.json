{"sha": "959e3823771ce0a58214c4547861d4f5a4a76ed8", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk1OWUzODIzNzcxY2UwYTU4MjE0YzQ1NDc4NjFkNGY1YTRhNzZlZDg=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2013-02-01T08:17:56Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2013-02-01T08:17:56Z"}, "message": "Revert \"DO NOT COMMIT\"\n\nThis reverts commit 76679c1f91fc68134c850b2d77ff2b83b32a108f.", "tree": {"sha": "ef6c592446b9441c930b99d0833418edf28251d4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ef6c592446b9441c930b99d0833418edf28251d4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/959e3823771ce0a58214c4547861d4f5a4a76ed8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/959e3823771ce0a58214c4547861d4f5a4a76ed8", "html_url": "https://github.com/rust-lang/rust/commit/959e3823771ce0a58214c4547861d4f5a4a76ed8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/959e3823771ce0a58214c4547861d4f5a4a76ed8/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e30388f68203fe3749bab1ba6b2b5670f1fdead2", "url": "https://api.github.com/repos/rust-lang/rust/commits/e30388f68203fe3749bab1ba6b2b5670f1fdead2", "html_url": "https://github.com/rust-lang/rust/commit/e30388f68203fe3749bab1ba6b2b5670f1fdead2"}], "stats": {"total": 24, "additions": 1, "deletions": 23}, "files": [{"sha": "4e557082e6179f5a828b8a0724eabf1f9f394d04", "filename": "src/librustc/middle/trans/glue.rs", "status": "modified", "additions": 0, "deletions": 21, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/959e3823771ce0a58214c4547861d4f5a4a76ed8/src%2Flibrustc%2Fmiddle%2Ftrans%2Fglue.rs", "raw_url": "https://github.com/rust-lang/rust/raw/959e3823771ce0a58214c4547861d4f5a4a76ed8/src%2Flibrustc%2Fmiddle%2Ftrans%2Fglue.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Ftrans%2Fglue.rs?ref=959e3823771ce0a58214c4547861d4f5a4a76ed8", "patch": "@@ -571,30 +571,9 @@ pub fn decr_refcnt_maybe_free(bcx: block,\n     }\n }\n \n-pub fn copy_glue_should_never_be_called(bcx: block, t: ty::t) -> bool {\n-    match ty::get(t).sty {\n-        ty::ty_infer(*)\n-        | ty::ty_type\n-        | ty::ty_opaque_closure_ptr(*)\n-        | ty::ty_opaque_box\n-        | ty::ty_unboxed_vec(*)\n-        | ty::ty_err => {\n-            // Not sure under what scenarios these non-types get take glue\n-            false\n-        }\n-        _ => !ty::type_is_copyable(bcx.tcx(), t)\n-    }\n-}\n \n pub fn make_take_glue(bcx: block, v: ValueRef, t: ty::t) {\n     let _icx = bcx.insn_ctxt(\"make_take_glue\");\n-\n-    if copy_glue_should_never_be_called(bcx, t) {\n-        controlflow::trans_fail(bcx, bcx.fcx.span,\n-                                ~\"calling take glue on non-copyable\");\n-        return;\n-    }\n-\n     // NB: v is a *pointer* to type t here, not a direct value.\n     let bcx = match ty::get(t).sty {\n       ty::ty_box(_) | ty::ty_opaque_box |"}, {"sha": "b07e3ef7b81744594457542d4ba532476d9fa191", "filename": "src/librustc/middle/ty.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/959e3823771ce0a58214c4547861d4f5a4a76ed8/src%2Flibrustc%2Fmiddle%2Fty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/959e3823771ce0a58214c4547861d4f5a4a76ed8/src%2Flibrustc%2Fmiddle%2Fty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fty.rs?ref=959e3823771ce0a58214c4547861d4f5a4a76ed8", "patch": "@@ -2181,8 +2181,7 @@ pub fn type_kind_ext(cx: ctxt, ty: t, allow_ty_var: bool) -> Kind {\n \n       ty_type | ty_opaque_closure_ptr(_)\n       | ty_opaque_box | ty_unboxed_vec(_) | ty_err => {\n-          kind_copyable()\n-        //cx.sess.bug(~\"Asked to compute kind of fictitious type\");\n+        cx.sess.bug(~\"Asked to compute kind of fictitious type\");\n       }\n     };\n "}]}