{"sha": "a416a19153e799dae6679d8672703dbeb48730d5", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE0MTZhMTkxNTNlNzk5ZGFlNjY3OWQ4NjcyNzAzZGJlYjQ4NzMwZDU=", "commit": {"author": {"name": "David Wood", "email": "david@davidtw.co", "date": "2019-05-06T19:45:47Z"}, "committer": {"name": "David Wood", "email": "david@davidtw.co", "date": "2019-05-06T22:40:19Z"}, "message": "Add test for current behaviour.\n\nThis commit adds a test for the current behaviour of signature deduction\nof generators when there is a type mismatch between the return type of\nthe function body and the signature.", "tree": {"sha": "e24e10f079b637ef350c9fc5c6ddfbe1fde3a8e1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e24e10f079b637ef350c9fc5c6ddfbe1fde3a8e1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a416a19153e799dae6679d8672703dbeb48730d5", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEWwgxPGhT5b/6kagXAXYLT59T8VQFAlzQt/AACgkQAXYLT59T\n8VTurBAAvD/1NSVMshmV3D5m4Gqodk4J+vIPh0pcCUTeX5DDIXjgCU8KFJC1WqPj\nN9wvBwStADexK6o0LYN94cmcQ/5xcdasClcT3WElk9kC2U6b72zHi98L3Z/utRoI\nQez20P6zcMDgnI0UTMmjQJBKlK22JQ3EzlK82SD7IsNxDm+wxNc3m5V4Q+f+FV2e\n6sfsX9j+zM+cFHuIAjs9QIndGTMBDQGjlAn72p7kj4/eqHI/lNA4/zu9q7UVAvSh\nWddiKV5+8VkxbRXmY4LbmoUcbsL0O43pvs6vb+buF4tToCesFJxcV9qRXdFiumQO\nUiE25gfyUK8gB0voviKaz2IH/LDIkCacrxqho94XhrT3p3mb9AA9YIojqNxEtdk+\n0oabg74H0ysA4+m+TD6Z5WU4k/RXmsmqJHNbPwVLuVEBYYiFsg0OMveImik7b9dd\nc/VXmoAevDKAmjusGHfOy0s/03vrFADelzfedg6oLkMkuRotRYuHuMEdUaJao4aE\ne+OdBHJ0zly18sGGk9S4HG5ngchwUcrTO3k2GXg+shY494AKVpm9BvGNdQ4Jvt+M\nprieTju3hcAqQp6G+VlZiihxY+SNnjEXraZxGL7B5Aw6FyAH+pMlTideXWMiPuEF\nA17Fj631Jn6JKTwzKkamScz1lJr8KoMzSm4JzewrH5CcUFgkTNk=\n=y4Sh\n-----END PGP SIGNATURE-----", "payload": "tree e24e10f079b637ef350c9fc5c6ddfbe1fde3a8e1\nparent 40bd145cbef28d279aacc903907c3945f83a6296\nauthor David Wood <david@davidtw.co> 1557171947 +0100\ncommitter David Wood <david@davidtw.co> 1557182419 +0100\n\nAdd test for current behaviour.\n\nThis commit adds a test for the current behaviour of signature deduction\nof generators when there is a type mismatch between the return type of\nthe function body and the signature.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a416a19153e799dae6679d8672703dbeb48730d5", "html_url": "https://github.com/rust-lang/rust/commit/a416a19153e799dae6679d8672703dbeb48730d5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a416a19153e799dae6679d8672703dbeb48730d5/comments", "author": {"login": "davidtwco", "id": 1295100, "node_id": "MDQ6VXNlcjEyOTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1295100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidtwco", "html_url": "https://github.com/davidtwco", "followers_url": "https://api.github.com/users/davidtwco/followers", "following_url": "https://api.github.com/users/davidtwco/following{/other_user}", "gists_url": "https://api.github.com/users/davidtwco/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidtwco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidtwco/subscriptions", "organizations_url": "https://api.github.com/users/davidtwco/orgs", "repos_url": "https://api.github.com/users/davidtwco/repos", "events_url": "https://api.github.com/users/davidtwco/events{/privacy}", "received_events_url": "https://api.github.com/users/davidtwco/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidtwco", "id": 1295100, "node_id": "MDQ6VXNlcjEyOTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1295100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidtwco", "html_url": "https://github.com/davidtwco", "followers_url": "https://api.github.com/users/davidtwco/followers", "following_url": "https://api.github.com/users/davidtwco/following{/other_user}", "gists_url": "https://api.github.com/users/davidtwco/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidtwco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidtwco/subscriptions", "organizations_url": "https://api.github.com/users/davidtwco/orgs", "repos_url": "https://api.github.com/users/davidtwco/repos", "events_url": "https://api.github.com/users/davidtwco/events{/privacy}", "received_events_url": "https://api.github.com/users/davidtwco/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "40bd145cbef28d279aacc903907c3945f83a6296", "url": "https://api.github.com/repos/rust-lang/rust/commits/40bd145cbef28d279aacc903907c3945f83a6296", "html_url": "https://github.com/rust-lang/rust/commit/40bd145cbef28d279aacc903907c3945f83a6296"}], "stats": {"total": 40, "additions": 40, "deletions": 0}, "files": [{"sha": "7774ff48f56b730b7bdc028dccf03771e07cee1e", "filename": "src/test/ui/generator/type-mismatch-signature-deduction.rs", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/a416a19153e799dae6679d8672703dbeb48730d5/src%2Ftest%2Fui%2Fgenerator%2Ftype-mismatch-signature-deduction.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a416a19153e799dae6679d8672703dbeb48730d5/src%2Ftest%2Fui%2Fgenerator%2Ftype-mismatch-signature-deduction.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fgenerator%2Ftype-mismatch-signature-deduction.rs?ref=a416a19153e799dae6679d8672703dbeb48730d5", "patch": "@@ -0,0 +1,17 @@\n+#![feature(generators, generator_trait)]\n+\n+use std::ops::Generator;\n+\n+fn foo() -> impl Generator<Return = i32> { //~ ERROR type mismatch\n+    || {\n+        if false {\n+            return Ok(6);\n+        }\n+\n+        yield ();\n+\n+        5 //~ ERROR mismatched types [E0308]\n+    }\n+}\n+\n+fn main() {}"}, {"sha": "9ebf77a02f5cae4020500aa30da09055f975c184", "filename": "src/test/ui/generator/type-mismatch-signature-deduction.stderr", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/a416a19153e799dae6679d8672703dbeb48730d5/src%2Ftest%2Fui%2Fgenerator%2Ftype-mismatch-signature-deduction.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a416a19153e799dae6679d8672703dbeb48730d5/src%2Ftest%2Fui%2Fgenerator%2Ftype-mismatch-signature-deduction.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fgenerator%2Ftype-mismatch-signature-deduction.stderr?ref=a416a19153e799dae6679d8672703dbeb48730d5", "patch": "@@ -0,0 +1,23 @@\n+error[E0308]: mismatched types\n+  --> $DIR/type-mismatch-signature-deduction.rs:13:9\n+   |\n+LL |         5\n+   |         ^ expected enum `std::result::Result`, found integer\n+   |\n+   = note: expected type `std::result::Result<{integer}, _>`\n+              found type `{integer}`\n+\n+error[E0271]: type mismatch resolving `<[generator@$DIR/type-mismatch-signature-deduction.rs:6:5: 14:6 _] as std::ops::Generator>::Return == i32`\n+  --> $DIR/type-mismatch-signature-deduction.rs:5:13\n+   |\n+LL | fn foo() -> impl Generator<Return = i32> {\n+   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected enum `std::result::Result`, found i32\n+   |\n+   = note: expected type `std::result::Result<{integer}, _>`\n+              found type `i32`\n+   = note: the return type of a function must have a statically known size\n+\n+error: aborting due to 2 previous errors\n+\n+Some errors have detailed explanations: E0271, E0308.\n+For more information about an error, try `rustc --explain E0271`."}]}