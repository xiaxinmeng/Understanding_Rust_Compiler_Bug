{"sha": "3c0907ce51f51bbedeb63b482041e4a8e1239364", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNjMDkwN2NlNTFmNTFiYmVkZWI2M2I0ODIwNDFlNGE4ZTEyMzkzNjQ=", "commit": {"author": {"name": "Jorge Aparicio", "email": "jorge@japaric.io", "date": "2018-09-13T17:43:15Z"}, "committer": {"name": "Jorge Aparicio", "email": "jorge@japaric.io", "date": "2018-09-26T13:21:26Z"}, "message": "add -Z emit-stack-sizes", "tree": {"sha": "c104c7c9affb2b67b57093fb7e9dd64cadc06b16", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c104c7c9affb2b67b57093fb7e9dd64cadc06b16"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3c0907ce51f51bbedeb63b482041e4a8e1239364", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3c0907ce51f51bbedeb63b482041e4a8e1239364", "html_url": "https://github.com/rust-lang/rust/commit/3c0907ce51f51bbedeb63b482041e4a8e1239364", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3c0907ce51f51bbedeb63b482041e4a8e1239364/comments", "author": {"login": "japaric", "id": 5018213, "node_id": "MDQ6VXNlcjUwMTgyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/5018213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/japaric", "html_url": "https://github.com/japaric", "followers_url": "https://api.github.com/users/japaric/followers", "following_url": "https://api.github.com/users/japaric/following{/other_user}", "gists_url": "https://api.github.com/users/japaric/gists{/gist_id}", "starred_url": "https://api.github.com/users/japaric/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/japaric/subscriptions", "organizations_url": "https://api.github.com/users/japaric/orgs", "repos_url": "https://api.github.com/users/japaric/repos", "events_url": "https://api.github.com/users/japaric/events{/privacy}", "received_events_url": "https://api.github.com/users/japaric/received_events", "type": "User", "site_admin": false}, "committer": {"login": "japaric", "id": 5018213, "node_id": "MDQ6VXNlcjUwMTgyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/5018213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/japaric", "html_url": "https://github.com/japaric", "followers_url": "https://api.github.com/users/japaric/followers", "following_url": "https://api.github.com/users/japaric/following{/other_user}", "gists_url": "https://api.github.com/users/japaric/gists{/gist_id}", "starred_url": "https://api.github.com/users/japaric/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/japaric/subscriptions", "organizations_url": "https://api.github.com/users/japaric/orgs", "repos_url": "https://api.github.com/users/japaric/repos", "events_url": "https://api.github.com/users/japaric/events{/privacy}", "received_events_url": "https://api.github.com/users/japaric/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c3a1a0d3400bbbcac194efb6ef2b14eef9be5149", "url": "https://api.github.com/repos/rust-lang/rust/commits/c3a1a0d3400bbbcac194efb6ef2b14eef9be5149", "html_url": "https://github.com/rust-lang/rust/commit/c3a1a0d3400bbbcac194efb6ef2b14eef9be5149"}], "stats": {"total": 12, "additions": 10, "deletions": 2}, "files": [{"sha": "eb779e6382f4bebb5e7418f7645329cea222cc66", "filename": "src/librustc/session/config.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3c0907ce51f51bbedeb63b482041e4a8e1239364/src%2Flibrustc%2Fsession%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3c0907ce51f51bbedeb63b482041e4a8e1239364/src%2Flibrustc%2Fsession%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fsession%2Fconfig.rs?ref=3c0907ce51f51bbedeb63b482041e4a8e1239364", "patch": "@@ -1385,6 +1385,8 @@ options! {DebuggingOptions, DebuggingSetter, basic_debugging_options,\n           \"run the self profiler\"),\n     profile_json: bool = (false, parse_bool, [UNTRACKED],\n           \"output a json file with profiler results\"),\n+    emit_stack_sizes: bool = (false, parse_bool, [UNTRACKED],\n+          \"emits a section containing stack size metadata\"),\n }\n \n pub fn default_lib_output() -> CrateType {"}, {"sha": "02ef690b942333c8f44ed8576fd863eeceba265e", "filename": "src/librustc_codegen_llvm/back/write.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3c0907ce51f51bbedeb63b482041e4a8e1239364/src%2Flibrustc_codegen_llvm%2Fback%2Fwrite.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3c0907ce51f51bbedeb63b482041e4a8e1239364/src%2Flibrustc_codegen_llvm%2Fback%2Fwrite.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Fback%2Fwrite.rs?ref=3c0907ce51f51bbedeb63b482041e4a8e1239364", "patch": "@@ -196,6 +196,7 @@ pub fn target_machine_factory(sess: &Session, find_features: bool)\n     let features = CString::new(features).unwrap();\n     let is_pie_binary = !find_features && is_pie_binary(sess);\n     let trap_unreachable = sess.target.target.options.trap_unreachable;\n+    let emit_stack_size_section = sess.opts.debugging_opts.emit_stack_sizes;\n \n     let asm_comments = sess.asm_comments();\n \n@@ -213,6 +214,7 @@ pub fn target_machine_factory(sess: &Session, find_features: bool)\n                 trap_unreachable,\n                 singlethread,\n                 asm_comments,\n+                emit_stack_size_section,\n             )\n         };\n "}, {"sha": "845f2fa9f45a6a90207ca4f688f9fc59c20ebb1b", "filename": "src/librustc_codegen_llvm/llvm/ffi.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/3c0907ce51f51bbedeb63b482041e4a8e1239364/src%2Flibrustc_codegen_llvm%2Fllvm%2Fffi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3c0907ce51f51bbedeb63b482041e4a8e1239364/src%2Flibrustc_codegen_llvm%2Fllvm%2Fffi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Fllvm%2Fffi.rs?ref=3c0907ce51f51bbedeb63b482041e4a8e1239364", "patch": "@@ -1460,7 +1460,8 @@ extern \"C\" {\n                                        DataSections: bool,\n                                        TrapUnreachable: bool,\n                                        Singlethread: bool,\n-                                       AsmComments: bool)\n+                                       AsmComments: bool,\n+                                       EmitStackSizeSection: bool)\n                                        -> Option<&'static mut TargetMachine>;\n     pub fn LLVMRustDisposeTargetMachine(T: &'static mut TargetMachine);\n     pub fn LLVMRustAddAnalysisPasses(T: &'a TargetMachine, PM: &PassManager<'a>, M: &'a Module);"}, {"sha": "06f75d981e3d6c8405503942e9da1734636acfce", "filename": "src/rustllvm/PassWrapper.cpp", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/3c0907ce51f51bbedeb63b482041e4a8e1239364/src%2Frustllvm%2FPassWrapper.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/3c0907ce51f51bbedeb63b482041e4a8e1239364/src%2Frustllvm%2FPassWrapper.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustllvm%2FPassWrapper.cpp?ref=3c0907ce51f51bbedeb63b482041e4a8e1239364", "patch": "@@ -373,7 +373,8 @@ extern \"C\" LLVMTargetMachineRef LLVMRustCreateTargetMachine(\n     bool DataSections,\n     bool TrapUnreachable,\n     bool Singlethread,\n-    bool AsmComments) {\n+    bool AsmComments,\n+    bool EmitStackSizeSection) {\n \n   auto OptLevel = fromRust(RustOptLevel);\n   auto RM = fromRust(RustReloc);\n@@ -411,6 +412,8 @@ extern \"C\" LLVMTargetMachineRef LLVMRustCreateTargetMachine(\n   }\n \n #if LLVM_VERSION_GE(6, 0)\n+  Options.EmitStackSizeSection = EmitStackSizeSection;\n+\n   Optional<CodeModel::Model> CM;\n #else\n   CodeModel::Model CM = CodeModel::Model::Default;"}]}