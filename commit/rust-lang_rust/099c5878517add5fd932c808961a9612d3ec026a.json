{"sha": "099c5878517add5fd932c808961a9612d3ec026a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA5OWM1ODc4NTE3YWRkNWZkOTMyYzgwODk2MWE5NjEyZDNlYzAyNmE=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-11-07T10:01:50Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-11-07T10:01:50Z"}, "message": "Rollup merge of #55495 - wesleywiser:opt_fuel_rustbuild, r=nikomatsakis\n\nDon't print opt fuel messages to stdout because it breaks Rustbuild\n\nRustbuild passes `--message-format json` to the compiler invocations\nwhich causes JSON to be emitted on stdout. Printing optimization fuel\nmessages to stdout breaks the json and causes Rustbuild to fail.\n\nWork around this by emitting optimization fuel related messages on\nstderr instead.", "tree": {"sha": "091549a615ed2c02ffb17fcdc8f60a45174c7f95", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/091549a615ed2c02ffb17fcdc8f60a45174c7f95"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/099c5878517add5fd932c808961a9612d3ec026a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJb4rgOCRBK7hj4Ov3rIwAAdHIIAKFK/rG2+CKKyVDXt5L8vKuy\nz+OMPO0aIxA+yfFgQ75z4JmQpVUFJIHflxFDpI86hYBxlxlTOZ9FXJZQ4aDYIbPF\noM+Md4hIaLxWSc7WH6qrem2W7Uml8hkBnIxEbeEHs9+rJkpPtBNIyUSjNtdbfI+d\n32P6IUnlnfLMFbU40jIRNybblX6qaGrz8qeuU78KzZyCbSxLDd0mjl3CHS1SwAst\nhwQLN1HTAEDaas4CJMEjh4IgWQ8fwdGmcygyfxSsnu8NVwoPT8NTjOue/l8wBEI8\nKnB40f5JtOqRK1psbI6SKARP6PJS5HR9D2ZJ107kd3GXK3nUcBm9YfcgoeG7G7Y=\n=XP6K\n-----END PGP SIGNATURE-----\n", "payload": "tree 091549a615ed2c02ffb17fcdc8f60a45174c7f95\nparent 88f214cfd588e483911c177e050dcdf21b3b8ee6\nparent 22b571d62a6750d1d67509a8e71f524c69d37b9d\nauthor kennytm <kennytm@gmail.com> 1541584910 +0800\ncommitter GitHub <noreply@github.com> 1541584910 +0800\n\nRollup merge of #55495 - wesleywiser:opt_fuel_rustbuild, r=nikomatsakis\n\nDon't print opt fuel messages to stdout because it breaks Rustbuild\n\nRustbuild passes `--message-format json` to the compiler invocations\nwhich causes JSON to be emitted on stdout. Printing optimization fuel\nmessages to stdout breaks the json and causes Rustbuild to fail.\n\nWork around this by emitting optimization fuel related messages on\nstderr instead.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/099c5878517add5fd932c808961a9612d3ec026a", "html_url": "https://github.com/rust-lang/rust/commit/099c5878517add5fd932c808961a9612d3ec026a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/099c5878517add5fd932c808961a9612d3ec026a/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "88f214cfd588e483911c177e050dcdf21b3b8ee6", "url": "https://api.github.com/repos/rust-lang/rust/commits/88f214cfd588e483911c177e050dcdf21b3b8ee6", "html_url": "https://github.com/rust-lang/rust/commit/88f214cfd588e483911c177e050dcdf21b3b8ee6"}, {"sha": "22b571d62a6750d1d67509a8e71f524c69d37b9d", "url": "https://api.github.com/repos/rust-lang/rust/commits/22b571d62a6750d1d67509a8e71f524c69d37b9d", "html_url": "https://github.com/rust-lang/rust/commit/22b571d62a6750d1d67509a8e71f524c69d37b9d"}], "stats": {"total": 13, "additions": 8, "deletions": 5}, "files": [{"sha": "fe94b62ef19e266c6e0989daba86a1992fd46d45", "filename": "src/librustc/session/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/099c5878517add5fd932c808961a9612d3ec026a/src%2Flibrustc%2Fsession%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/099c5878517add5fd932c808961a9612d3ec026a/src%2Flibrustc%2Fsession%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fsession%2Fmod.rs?ref=099c5878517add5fd932c808961a9612d3ec026a", "patch": "@@ -868,7 +868,7 @@ impl Session {\n                 let fuel = self.optimization_fuel_limit.get();\n                 ret = fuel != 0;\n                 if fuel == 0 && !self.out_of_fuel.get() {\n-                    println!(\"optimization-fuel-exhausted: {}\", msg());\n+                    eprintln!(\"optimization-fuel-exhausted: {}\", msg());\n                     self.out_of_fuel.set(true);\n                 } else if fuel > 0 {\n                     self.optimization_fuel_limit.set(fuel - 1);"}, {"sha": "6c7982242bfada275219bc82d01eac49235190b6", "filename": "src/librustc_driver/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/099c5878517add5fd932c808961a9612d3ec026a/src%2Flibrustc_driver%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/099c5878517add5fd932c808961a9612d3ec026a/src%2Flibrustc_driver%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_driver%2Flib.rs?ref=099c5878517add5fd932c808961a9612d3ec026a", "patch": "@@ -952,7 +952,7 @@ impl<'a> CompilerCalls<'a> for RustcDefaultCalls {\n             control.compilation_done.callback = box move |state| {\n                 old_callback(state);\n                 let sess = state.session;\n-                println!(\"Fuel used by {}: {}\",\n+                eprintln!(\"Fuel used by {}: {}\",\n                     sess.print_fuel_crate.as_ref().unwrap(),\n                     sess.print_fuel.get());\n             }"}, {"sha": "a12dad4489df92384837f0709350b449c40fc73e", "filename": "src/test/run-pass/optimization-fuel-0.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/099c5878517add5fd932c808961a9612d3ec026a/src%2Ftest%2Frun-pass%2Foptimization-fuel-0.rs", "raw_url": "https://github.com/rust-lang/rust/raw/099c5878517add5fd932c808961a9612d3ec026a/src%2Ftest%2Frun-pass%2Foptimization-fuel-0.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Foptimization-fuel-0.rs?ref=099c5878517add5fd932c808961a9612d3ec026a", "patch": "@@ -12,7 +12,8 @@\n \n use std::mem::size_of;\n \n-// compile-flags: -Z fuel=foo=0\n+// (#55495: The --error-format is to sidestep an issue in our test harness)\n+// compile-flags: --error-format human -Z fuel=foo=0\n \n struct S1(u8, u16, u8);\n struct S2(u8, u16, u8);"}, {"sha": "3ad405b2b50ff4db108c3e39f337a28379579f12", "filename": "src/test/run-pass/optimization-fuel-0.stderr", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/099c5878517add5fd932c808961a9612d3ec026a/src%2Ftest%2Frun-pass%2Foptimization-fuel-0.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/099c5878517add5fd932c808961a9612d3ec026a/src%2Ftest%2Frun-pass%2Foptimization-fuel-0.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Foptimization-fuel-0.stderr?ref=099c5878517add5fd932c808961a9612d3ec026a", "previous_filename": "src/test/run-pass/optimization-fuel-0.stdout"}, {"sha": "1e76aaa48b761065cfb20c24e0ef6a5bfb7ffeb2", "filename": "src/test/run-pass/optimization-fuel-1.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/099c5878517add5fd932c808961a9612d3ec026a/src%2Ftest%2Frun-pass%2Foptimization-fuel-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/099c5878517add5fd932c808961a9612d3ec026a/src%2Ftest%2Frun-pass%2Foptimization-fuel-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Foptimization-fuel-1.rs?ref=099c5878517add5fd932c808961a9612d3ec026a", "patch": "@@ -12,7 +12,8 @@\n \n use std::mem::size_of;\n \n-// compile-flags: -Z fuel=foo=1\n+// (#55495: The --error-format is to sidestep an issue in our test harness)\n+// compile-flags: --error-format human -Z fuel=foo=1\n \n struct S1(u8, u16, u8);\n struct S2(u8, u16, u8);"}, {"sha": "197e45219c3f8726fd710f5e8b0bcdce2379cffd", "filename": "src/test/run-pass/optimization-fuel-1.stderr", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/099c5878517add5fd932c808961a9612d3ec026a/src%2Ftest%2Frun-pass%2Foptimization-fuel-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/099c5878517add5fd932c808961a9612d3ec026a/src%2Ftest%2Frun-pass%2Foptimization-fuel-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Foptimization-fuel-1.stderr?ref=099c5878517add5fd932c808961a9612d3ec026a", "previous_filename": "src/test/run-pass/optimization-fuel-1.stdout"}, {"sha": "31123410481c33d2f65809c92b57dc42c146dca2", "filename": "src/test/ui/print-fuel/print-fuel.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/099c5878517add5fd932c808961a9612d3ec026a/src%2Ftest%2Fui%2Fprint-fuel%2Fprint-fuel.rs", "raw_url": "https://github.com/rust-lang/rust/raw/099c5878517add5fd932c808961a9612d3ec026a/src%2Ftest%2Fui%2Fprint-fuel%2Fprint-fuel.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fprint-fuel%2Fprint-fuel.rs?ref=099c5878517add5fd932c808961a9612d3ec026a", "patch": "@@ -11,7 +11,8 @@\n #![crate_name=\"foo\"]\n #![allow(dead_code)]\n \n-// compile-flags: -Z print-fuel=foo\n+// (#55495: The --error-format is to sidestep an issue in our test harness)\n+// compile-flags: --error-format human -Z print-fuel=foo\n // compile-pass\n \n struct S1(u8, u16, u8);"}, {"sha": "cc88cc077bb219a372491432f57bdb0f76b8ba62", "filename": "src/test/ui/print-fuel/print-fuel.stderr", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/099c5878517add5fd932c808961a9612d3ec026a/src%2Ftest%2Fui%2Fprint-fuel%2Fprint-fuel.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/099c5878517add5fd932c808961a9612d3ec026a/src%2Ftest%2Fui%2Fprint-fuel%2Fprint-fuel.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fprint-fuel%2Fprint-fuel.stderr?ref=099c5878517add5fd932c808961a9612d3ec026a", "previous_filename": "src/test/ui/print-fuel/print-fuel.stdout"}]}