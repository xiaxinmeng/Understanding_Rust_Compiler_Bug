{"sha": "b8174030841d1b3a26add05ba7de6d252c135d8c", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI4MTc0MDMwODQxZDFiM2EyNmFkZDA1YmE3ZGU2ZDI1MmMxMzVkOGM=", "commit": {"author": {"name": "Oliver Schneider", "email": "git-no-reply-9879165716479413131@oli-obk.de", "date": "2018-05-09T16:22:46Z"}, "committer": {"name": "Oliver Schneider", "email": "git-no-reply-9879165716479413131@oli-obk.de", "date": "2018-05-09T16:22:46Z"}, "message": "Document the checktools script", "tree": {"sha": "df07a852f056fd1caba992b2c4e57ac55658a53a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/df07a852f056fd1caba992b2c4e57ac55658a53a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b8174030841d1b3a26add05ba7de6d252c135d8c", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJgBAABCgBKFiEEvpMjxK4/cnPNfesJHVy0/Fl8MAQFAlrzIFYsHGdpdC1uby1y\nZXBseS05ODc5MTY1NzE2NDc5NDEzMTMxQG9saS1vYmsuZGUACgkQHVy0/Fl8MATl\nhw//WLwwhrLM3c2SjRwyvpa9NM3UwJojHV87VpUBRIzwwu0+jteenENjn9wvpVuX\nUZbDpOobnZeDstf0y4RXsts+S+Lh5AcZHeWt6BaJ2RACOPAr/eV6hkKVMFSUBzb7\nVTuVUk/k9llOeGWrmodgWETag4P5WKXspOTMM8TnQZcirmlRcXj6QHh6xPAIJhL7\n9QMoHpfkAogd85HriKdT8O5A/4atFnsf5iUv1aCzn9bulsV6sKn41sYrXv00zghi\nQtAYaC0yoIyMNToaM6B85Sxzu9I8qU8DF1fJ17IkV91rJdX2c28s3aXhf13qW2Kt\nUy+tpr9XOVOEMWQHx+ohCwUwUX4mzrRcC0kZgslrg78jm5t1C5t7uh6q/6aPuQMp\n7UKAh9K7chBmPLEbnQ1Sd0GFAblcNEGyJ02xT0z0CXKaRJUSLNgORLHznOOBYp9Z\n+QgqKgPa5rOv0pni1svgTgGMYNxv0+mmAg0B51D1pngkxJ8jyknbLxfu2GhaKB6U\nH36eh49E/ul1NsePHTM8jJrv5PICaf2kwyPQQfRRo78YTpw0d0bSHIy098qKIykK\n17iCEmf0bJPrrYF1lXF+0oM+GbwJNyrxY2GF+obxrGB/6NsamqpqeDmrYCKBD8d1\nnezG799loatzIjoO6LgDeCFYE15i1MepsscZ+zMsuAbbS54=\n=JJgF\n-----END PGP SIGNATURE-----", "payload": "tree df07a852f056fd1caba992b2c4e57ac55658a53a\nparent 050cb1c45232017a7708144b867114d7a7fbb569\nauthor Oliver Schneider <git-no-reply-9879165716479413131@oli-obk.de> 1525882966 +0200\ncommitter Oliver Schneider <git-no-reply-9879165716479413131@oli-obk.de> 1525882966 +0200\n\nDocument the checktools script\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b8174030841d1b3a26add05ba7de6d252c135d8c", "html_url": "https://github.com/rust-lang/rust/commit/b8174030841d1b3a26add05ba7de6d252c135d8c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b8174030841d1b3a26add05ba7de6d252c135d8c/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "050cb1c45232017a7708144b867114d7a7fbb569", "url": "https://api.github.com/repos/rust-lang/rust/commits/050cb1c45232017a7708144b867114d7a7fbb569", "html_url": "https://github.com/rust-lang/rust/commit/050cb1c45232017a7708144b867114d7a7fbb569"}], "stats": {"total": 7, "additions": 7, "deletions": 0}, "files": [{"sha": "d71d5daf8113bf4abb59d51101467e85985fc250", "filename": "src/ci/docker/x86_64-gnu-tools/checktools.sh", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/b8174030841d1b3a26add05ba7de6d252c135d8c/src%2Fci%2Fdocker%2Fx86_64-gnu-tools%2Fchecktools.sh", "raw_url": "https://github.com/rust-lang/rust/raw/b8174030841d1b3a26add05ba7de6d252c135d8c/src%2Fci%2Fdocker%2Fx86_64-gnu-tools%2Fchecktools.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fx86_64-gnu-tools%2Fchecktools.sh?ref=b8174030841d1b3a26add05ba7de6d252c135d8c", "patch": "@@ -23,6 +23,8 @@ SIX_WEEK_CYCLE=\"$(( ($(date +%s) / 604800 - 3) % 6 ))\"\n \n touch \"$TOOLSTATE_FILE\"\n \n+# Try to test all the tools and store the build/test success in the TOOLSTATE_FILE\n+\n set +e\n python2.7 \"$X_PY\" test --no-fail-fast \\\n     src/doc/book \\\n@@ -38,6 +40,7 @@ set -e\n cat \"$TOOLSTATE_FILE\"\n echo\n \n+# This function checks that if a tool's submodule changed, the tool's state must improve\n verify_status() {\n     echo \"Verifying status of $1...\"\n     if echo \"$CHANGED_FILES\" | grep -q \"^M[[:blank:]]$2$\"; then\n@@ -57,6 +60,7 @@ verify_status() {\n     fi\n }\n \n+# deduplicates the submodule check and the assertion that on beta some tools MUST be passing\n check_dispatch() {\n     if [ \"$1\" = submodule_changed ]; then\n         # ignore $2 (branch id)\n@@ -69,6 +73,7 @@ check_dispatch() {\n     fi\n }\n \n+# list all tools here\n status_check() {\n     check_dispatch $1 beta book src/doc/book\n     check_dispatch $1 beta nomicon src/doc/nomicon\n@@ -103,4 +108,6 @@ $COMMIT\\t$(cat \"$TOOLSTATE_FILE\")\n     exit 0\n fi\n \n+# abort compilation if an important tool doesn't build\n+# (this code is reachable if not on the nightly channel)\n status_check \"beta_required\""}]}