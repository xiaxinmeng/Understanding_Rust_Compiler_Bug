{"sha": "caef1e833fbd9de740d521114d716a11a29b71cb", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNhZWYxZTgzM2ZiZDlkZTc0MGQ1MjExMTRkNzE2YTExYTI5YjcxY2I=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2019-05-20T03:36:43Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2019-05-20T03:36:43Z"}, "message": "Auto merge of #60815 - nnethercote:use-Symbol-more-2, r=petrochenkov\n\nUse `Symbol` even more\n\nThese patches simplify the code a bit (fewer conversions) and also speed things up a bit (fewer `with_interner` calls).\n\nr? @petrochenkov", "tree": {"sha": "8ac73905ed5b00247210323b5ef501c119d0bf97", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8ac73905ed5b00247210323b5ef501c119d0bf97"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/caef1e833fbd9de740d521114d716a11a29b71cb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/caef1e833fbd9de740d521114d716a11a29b71cb", "html_url": "https://github.com/rust-lang/rust/commit/caef1e833fbd9de740d521114d716a11a29b71cb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/caef1e833fbd9de740d521114d716a11a29b71cb/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "128b4c8035fc788b78157d4e1975cda0f25ce599", "url": "https://api.github.com/repos/rust-lang/rust/commits/128b4c8035fc788b78157d4e1975cda0f25ce599", "html_url": "https://github.com/rust-lang/rust/commit/128b4c8035fc788b78157d4e1975cda0f25ce599"}, {"sha": "c06cdbeac55ec87181d015d2ef759349521773ea", "url": "https://api.github.com/repos/rust-lang/rust/commits/c06cdbeac55ec87181d015d2ef759349521773ea", "html_url": "https://github.com/rust-lang/rust/commit/c06cdbeac55ec87181d015d2ef759349521773ea"}], "stats": {"total": 186, "additions": 96, "deletions": 90}, "files": [{"sha": "22312e7459be125af26df08568861237e5afa534", "filename": "src/librustc/hir/mod.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Fhir%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Fhir%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fhir%2Fmod.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -609,9 +609,9 @@ impl Generics {\n         own_counts\n     }\n \n-    pub fn get_named(&self, name: &InternedString) -> Option<&GenericParam> {\n+    pub fn get_named(&self, name: InternedString) -> Option<&GenericParam> {\n         for param in &self.params {\n-            if *name == param.name.ident().as_interned_str() {\n+            if name == param.name.ident().as_interned_str() {\n                 return Some(param);\n             }\n         }"}, {"sha": "e4505a240379f0047bbde6f12e9f1e85c2f7612d", "filename": "src/librustc/infer/error_reporting/mod.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Finfer%2Ferror_reporting%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Finfer%2Ferror_reporting%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Finfer%2Ferror_reporting%2Fmod.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -194,20 +194,20 @@ impl<'a, 'gcx, 'tcx> TyCtxt<'a, 'gcx, 'tcx> {\n                 let mut sp = cm.def_span(self.hir().span_by_hir_id(node));\n                 if let Some(param) = self.hir()\n                     .get_generics(scope)\n-                    .and_then(|generics| generics.get_named(&br.name))\n+                    .and_then(|generics| generics.get_named(br.name))\n                 {\n                     sp = param.span;\n                 }\n                 (format!(\"the lifetime {} as defined on\", br.name), sp)\n             }\n             ty::ReFree(ty::FreeRegion {\n-                bound_region: ty::BoundRegion::BrNamed(_, ref name),\n+                bound_region: ty::BoundRegion::BrNamed(_, name),\n                 ..\n             }) => {\n                 let mut sp = cm.def_span(self.hir().span_by_hir_id(node));\n                 if let Some(param) = self.hir()\n                     .get_generics(scope)\n-                    .and_then(|generics| generics.get_named(&name))\n+                    .and_then(|generics| generics.get_named(name))\n                 {\n                     sp = param.span;\n                 }"}, {"sha": "feade7a8f56f26d1c8b7e4b73e8bca45f4d8af60", "filename": "src/librustc/infer/error_reporting/nice_region_error/util.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Finfer%2Ferror_reporting%2Fnice_region_error%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Finfer%2Ferror_reporting%2Fnice_region_error%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Finfer%2Ferror_reporting%2Fnice_region_error%2Futil.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -43,7 +43,7 @@ impl<'a, 'gcx, 'tcx> NiceRegionError<'a, 'gcx, 'tcx> {\n     ) -> Option<AnonymousArgInfo<'_>> {\n         let (id, bound_region) = match *anon_region {\n             ty::ReFree(ref free_region) => (free_region.scope, free_region.bound_region),\n-            ty::ReEarlyBound(ref ebr) => (\n+            ty::ReEarlyBound(ebr) => (\n                 self.tcx().parent(ebr.def_id).unwrap(),\n                 ty::BoundRegion::BrNamed(ebr.def_id, ebr.name),\n             ),"}, {"sha": "7e1e751e856478197de92a2e69dc2e2b86ebcea3", "filename": "src/librustc/lint/context.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Flint%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Flint%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Flint%2Fcontext.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -828,8 +828,8 @@ impl<'a, 'tcx> LateContext<'a, 'tcx> {\n \n                 // This shouldn't ever be needed, but just in case:\n                 Ok(vec![match trait_ref {\n-                    Some(trait_ref) => Symbol::intern(&format!(\"{:?}\", trait_ref)).as_str(),\n-                    None => Symbol::intern(&format!(\"<{}>\", self_ty)).as_str(),\n+                    Some(trait_ref) => LocalInternedString::intern(&format!(\"{:?}\", trait_ref)),\n+                    None => LocalInternedString::intern(&format!(\"<{}>\", self_ty)),\n                 }])\n             }\n \n@@ -845,9 +845,10 @@ impl<'a, 'tcx> LateContext<'a, 'tcx> {\n                 // This shouldn't ever be needed, but just in case:\n                 path.push(match trait_ref {\n                     Some(trait_ref) => {\n-                        Symbol::intern(&format!(\"<impl {} for {}>\", trait_ref, self_ty)).as_str()\n+                        LocalInternedString::intern(&format!(\"<impl {} for {}>\", trait_ref,\n+                                                    self_ty))\n                     },\n-                    None => Symbol::intern(&format!(\"<impl {}>\", self_ty)).as_str(),\n+                    None => LocalInternedString::intern(&format!(\"<impl {}>\", self_ty)),\n                 });\n \n                 Ok(path)"}, {"sha": "a26468b0fb6ce0560bc1a1cb46c404dddd0a1872", "filename": "src/librustc/mir/mono.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Fmir%2Fmono.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Fmir%2Fmono.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmir%2Fmono.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -1,6 +1,6 @@\n use crate::hir::def_id::{DefId, CrateNum, LOCAL_CRATE};\n use crate::hir::HirId;\n-use syntax::symbol::{Symbol, InternedString};\n+use syntax::symbol::InternedString;\n use crate::ty::{Instance, TyCtxt};\n use crate::util::nodemap::FxHashMap;\n use rustc_data_structures::base_n;\n@@ -280,7 +280,7 @@ impl<'a, 'gcx: 'tcx, 'tcx: 'a> CodegenUnitNameBuilder<'a, 'gcx, 'tcx> {\n             cgu_name\n         } else {\n             let cgu_name = &cgu_name.as_str()[..];\n-            Symbol::intern(&CodegenUnit::mangle_name(cgu_name)).as_interned_str()\n+            InternedString::intern(&CodegenUnit::mangle_name(cgu_name))\n         }\n     }\n \n@@ -336,6 +336,6 @@ impl<'a, 'gcx: 'tcx, 'tcx: 'a> CodegenUnitNameBuilder<'a, 'gcx, 'tcx> {\n             write!(cgu_name, \".{}\", special_suffix).unwrap();\n         }\n \n-        Symbol::intern(&cgu_name[..]).as_interned_str()\n+        InternedString::intern(&cgu_name[..])\n     }\n }"}, {"sha": "55216f644a180626fdf1eb15369ce64999fe8c1a", "filename": "src/librustc/traits/object_safety.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Ftraits%2Fobject_safety.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Ftraits%2Fobject_safety.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Ftraits%2Fobject_safety.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -18,7 +18,8 @@ use crate::ty::{self, Ty, TyCtxt, TypeFoldable, Predicate, ToPredicate};\n use crate::ty::subst::{Subst, InternalSubsts};\n use std::borrow::Cow;\n use std::iter::{self};\n-use syntax::ast::{self, Name};\n+use syntax::ast::{self};\n+use syntax::symbol::InternedString;\n use syntax_pos::Span;\n \n #[derive(Copy, Clone, Debug, PartialEq, Eq, Hash)]\n@@ -539,7 +540,7 @@ impl<'a, 'tcx> TyCtxt<'a, 'tcx, 'tcx> {\n         // are implemented\n         let unsized_self_ty: Ty<'tcx> = self.mk_ty_param(\n             ::std::u32::MAX,\n-            Name::intern(\"RustaceansAreAwesome\").as_interned_str(),\n+            InternedString::intern(\"RustaceansAreAwesome\"),\n         );\n \n         // `Receiver[Self => U]`"}, {"sha": "404fadbc78afce2119335eff2afcfde7e9876c04", "filename": "src/librustc/traits/structural_impls.rs", "status": "modified", "additions": 4, "deletions": 10, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Ftraits%2Fstructural_impls.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Ftraits%2Fstructural_impls.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Ftraits%2Fstructural_impls.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -312,17 +312,15 @@ impl<'tcx> TypeVisitor<'tcx> for BoundNamesCollector {\n     }\n \n     fn visit_ty(&mut self, t: Ty<'tcx>) -> bool {\n-        use syntax::symbol::Symbol;\n-\n         match t.sty {\n             ty::Bound(debruijn, bound_ty) if debruijn == self.binder_index => {\n                 self.types.insert(\n                     bound_ty.var.as_u32(),\n                     match bound_ty.kind {\n                         ty::BoundTyKind::Param(name) => name,\n-                        ty::BoundTyKind::Anon => Symbol::intern(\n-                            &format!(\"^{}\", bound_ty.var.as_u32())\n-                        ).as_interned_str(),\n+                        ty::BoundTyKind::Anon =>\n+                            InternedString::intern(&format!(\"^{}\", bound_ty.var.as_u32()),\n+                        ),\n                     }\n                 );\n             }\n@@ -334,8 +332,6 @@ impl<'tcx> TypeVisitor<'tcx> for BoundNamesCollector {\n     }\n \n     fn visit_region(&mut self, r: ty::Region<'tcx>) -> bool {\n-        use syntax::symbol::Symbol;\n-\n         match r {\n             ty::ReLateBound(index, br) if *index == self.binder_index => {\n                 match br {\n@@ -344,9 +340,7 @@ impl<'tcx> TypeVisitor<'tcx> for BoundNamesCollector {\n                     }\n \n                     ty::BoundRegion::BrAnon(var) => {\n-                        self.regions.insert(Symbol::intern(\n-                            &format!(\"'^{}\", var)\n-                        ).as_interned_str());\n+                        self.regions.insert(InternedString::intern(&format!(\"'^{}\", var)));\n                     }\n \n                     _ => (),"}, {"sha": "e1c432d5b6da14e9a805f630f4f282fd8fc7f612", "filename": "src/librustc/ty/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Fty%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Fty%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fmod.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -3405,7 +3405,7 @@ impl_stable_hash_for!(struct self::SymbolName {\n impl SymbolName {\n     pub fn new(name: &str) -> SymbolName {\n         SymbolName {\n-            name: Symbol::intern(name).as_interned_str()\n+            name: InternedString::intern(name)\n         }\n     }\n "}, {"sha": "91b708d7dbe10339d00813f79f85cfd108a4f57b", "filename": "src/librustc/ty/print/pretty.rs", "status": "modified", "additions": 5, "deletions": 7, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Fty%2Fprint%2Fpretty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Fty%2Fprint%2Fpretty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fprint%2Fpretty.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -7,10 +7,8 @@ use crate::middle::region;\n use crate::ty::{self, DefIdTree, ParamConst, Ty, TyCtxt, TypeFoldable};\n use crate::ty::subst::{Kind, Subst, UnpackedKind};\n use crate::mir::interpret::ConstValue;\n-use syntax::symbol::{keywords, Symbol};\n-\n use rustc_target::spec::abi::Abi;\n-use syntax::symbol::InternedString;\n+use syntax::symbol::{keywords, InternedString};\n \n use std::cell::Cell;\n use std::fmt::{self, Write as _};\n@@ -1285,10 +1283,10 @@ impl<F: fmt::Write> FmtPrinter<'_, 'gcx, 'tcx, F> {\n     {\n         fn name_by_region_index(index: usize) -> InternedString {\n             match index {\n-                0 => Symbol::intern(\"'r\"),\n-                1 => Symbol::intern(\"'s\"),\n-                i => Symbol::intern(&format!(\"'t{}\", i-2)),\n-            }.as_interned_str()\n+                0 => InternedString::intern(\"'r\"),\n+                1 => InternedString::intern(\"'s\"),\n+                i => InternedString::intern(&format!(\"'t{}\", i-2)),\n+            }\n         }\n \n         // Replace any anonymous late-bound regions with named"}, {"sha": "2fb318a47befd80f6919cd0b22c9eb56bbe3f8f4", "filename": "src/librustc/ty/query/values.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Fty%2Fquery%2Fvalues.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Fty%2Fquery%2Fvalues.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fquery%2Fvalues.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -1,7 +1,7 @@\n use crate::ty::{self, Ty, TyCtxt, AdtSizedConstraint};\n use crate::ty::util::NeedsDrop;\n \n-use syntax::symbol::Symbol;\n+use syntax::symbol::InternedString;\n \n pub(super) trait Value<'tcx>: Sized {\n     fn from_cycle_error<'a>(tcx: TyCtxt<'a, 'tcx, 'tcx>) -> Self;\n@@ -28,7 +28,7 @@ impl<'tcx> Value<'tcx> for Ty<'tcx> {\n \n impl<'tcx> Value<'tcx> for ty::SymbolName {\n     fn from_cycle_error<'a>(_: TyCtxt<'a, 'tcx, 'tcx>) -> Self {\n-        ty::SymbolName { name: Symbol::intern(\"<error>\").as_interned_str() }\n+        ty::SymbolName { name: InternedString::intern(\"<error>\") }\n     }\n }\n "}, {"sha": "d20840ef7cf4de89d6118a99cbe29790e8bf3352", "filename": "src/librustc/ty/sty.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Fty%2Fsty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc%2Fty%2Fsty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fsty.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -1136,7 +1136,7 @@ impl<'a, 'gcx, 'tcx> ParamTy {\n         // FIXME(#50125): Ignoring `Self` with `index != 0` might lead to weird behavior elsewhere,\n         // but this should only be possible when using `-Z continue-parse-after-error` like\n         // `compile-fail/issue-36638.rs`.\n-        self.name == keywords::SelfUpper.name().as_str() && self.index == 0\n+        self.name.as_symbol() == keywords::SelfUpper.name() && self.index == 0\n     }\n }\n "}, {"sha": "9ae0e26196d94fb142ef516b6a2942fca28c5cb9", "filename": "src/librustc_codegen_llvm/intrinsic.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc_codegen_llvm%2Fintrinsic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc_codegen_llvm%2Fintrinsic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Fintrinsic.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -20,7 +20,7 @@ use rustc::ty::layout::{self, LayoutOf, HasTyCtxt, Primitive};\n use rustc_codegen_ssa::common::{IntPredicate, TypeKind};\n use rustc::hir;\n use syntax::ast::{self, FloatTy};\n-use syntax::symbol::Symbol;\n+use syntax::symbol::LocalInternedString;\n \n use rustc_codegen_ssa::traits::*;\n \n@@ -213,7 +213,7 @@ impl IntrinsicCallMethods<'tcx> for Builder<'a, 'll, 'tcx> {\n             }\n             \"type_name\" => {\n                 let tp_ty = substs.type_at(0);\n-                let ty_name = Symbol::intern(&tp_ty.to_string()).as_str();\n+                let ty_name = LocalInternedString::intern(&tp_ty.to_string());\n                 self.const_str_slice(ty_name)\n             }\n             \"type_id\" => {"}, {"sha": "c7dd019fc3eb8abb464c0bcca87e15059a312c76", "filename": "src/librustc_codegen_ssa/mir/block.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc_codegen_ssa%2Fmir%2Fblock.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc_codegen_ssa%2Fmir%2Fblock.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Fmir%2Fblock.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -15,7 +15,7 @@ use crate::traits::*;\n \n use std::borrow::Cow;\n \n-use syntax::symbol::Symbol;\n+use syntax::symbol::LocalInternedString;\n use syntax_pos::Pos;\n \n use super::{FunctionCx, LocalRef};\n@@ -401,7 +401,7 @@ impl<'a, 'tcx: 'a, Bx: BuilderMethods<'a, 'tcx>> FunctionCx<'a, 'tcx, Bx> {\n \n         // Get the location information.\n         let loc = bx.sess().source_map().lookup_char_pos(span.lo());\n-        let filename = Symbol::intern(&loc.file.name.to_string()).as_str();\n+        let filename = LocalInternedString::intern(&loc.file.name.to_string());\n         let line = bx.const_u32(loc.line as u32);\n         let col = bx.const_u32(loc.col.to_usize() as u32 + 1);\n \n@@ -423,7 +423,7 @@ impl<'a, 'tcx: 'a, Bx: BuilderMethods<'a, 'tcx>> FunctionCx<'a, 'tcx, Bx> {\n             }\n             _ => {\n                 let str = msg.description();\n-                let msg_str = Symbol::intern(str).as_str();\n+                let msg_str = LocalInternedString::intern(str);\n                 let msg_file_line_col = bx.static_panic_msg(\n                     Some(msg_str),\n                     filename,\n@@ -535,15 +535,15 @@ impl<'a, 'tcx: 'a, Bx: BuilderMethods<'a, 'tcx>> FunctionCx<'a, 'tcx, Bx> {\n             let layout = bx.layout_of(ty);\n             if layout.abi.is_uninhabited() {\n                 let loc = bx.sess().source_map().lookup_char_pos(span.lo());\n-                let filename = Symbol::intern(&loc.file.name.to_string()).as_str();\n+                let filename = LocalInternedString::intern(&loc.file.name.to_string());\n                 let line = bx.const_u32(loc.line as u32);\n                 let col = bx.const_u32(loc.col.to_usize() as u32 + 1);\n \n                 let str = format!(\n                     \"Attempted to instantiate uninhabited type {}\",\n                     ty\n                 );\n-                let msg_str = Symbol::intern(&str).as_str();\n+                let msg_str = LocalInternedString::intern(&str);\n                 let msg_file_line_col = bx.static_panic_msg(\n                     Some(msg_str),\n                     filename,"}, {"sha": "6915687ceba930d0bde8a5844293a7e7465ca89e", "filename": "src/librustc_codegen_utils/symbol_names.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc_codegen_utils%2Fsymbol_names.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc_codegen_utils%2Fsymbol_names.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_utils%2Fsymbol_names.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -101,7 +101,7 @@ use rustc_data_structures::stable_hasher::{HashStable, StableHasher};\n use rustc_mir::monomorphize::item::{InstantiationMode, MonoItem, MonoItemExt};\n use rustc_mir::monomorphize::Instance;\n \n-use syntax_pos::symbol::{Symbol, InternedString};\n+use syntax_pos::symbol::InternedString;\n \n use log::debug;\n \n@@ -238,13 +238,13 @@ fn compute_symbol_name(tcx: TyCtxt<'_, 'tcx, 'tcx>, instance: Instance<'tcx>) ->\n     if def_id.is_local() {\n         if tcx.plugin_registrar_fn(LOCAL_CRATE) == Some(def_id) {\n             let disambiguator = tcx.sess.local_crate_disambiguator();\n-            return Symbol::intern(&tcx.sess.generate_plugin_registrar_symbol(disambiguator))\n-                .as_interned_str();\n+            return\n+                InternedString::intern(&tcx.sess.generate_plugin_registrar_symbol(disambiguator));\n         }\n         if tcx.proc_macro_decls_static(LOCAL_CRATE) == Some(def_id) {\n             let disambiguator = tcx.sess.local_crate_disambiguator();\n-            return Symbol::intern(&tcx.sess.generate_proc_macro_decls_symbol(disambiguator))\n-                .as_interned_str();\n+            return\n+                InternedString::intern(&tcx.sess.generate_proc_macro_decls_symbol(disambiguator));\n         }\n     }\n \n@@ -322,7 +322,7 @@ fn compute_symbol_name(tcx: TyCtxt<'_, 'tcx, 'tcx>, instance: Instance<'tcx>) ->\n         let _ = printer.write_str(\"{{vtable-shim}}\");\n     }\n \n-    Symbol::intern(&printer.path.finish(hash)).as_interned_str()\n+    InternedString::intern(&printer.path.finish(hash))\n }\n \n // Follow C++ namespace-mangling style, see"}, {"sha": "4d8acd241acd893f17910c81d87d8b09d8b979b6", "filename": "src/librustc_mir/borrow_check/nll/region_infer/error_reporting/region_name.rs", "status": "modified", "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fregion_infer%2Ferror_reporting%2Fregion_name.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fregion_infer%2Ferror_reporting%2Fregion_name.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Fregion_infer%2Ferror_reporting%2Fregion_name.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -12,7 +12,6 @@ use rustc::ty::subst::{SubstsRef, UnpackedKind};\n use rustc::ty::{self, RegionKind, RegionVid, Ty, TyCtxt};\n use rustc::ty::print::RegionHighlightMode;\n use rustc_errors::DiagnosticBuilder;\n-use syntax::ast::Name;\n use syntax::symbol::keywords;\n use syntax_pos::Span;\n use syntax_pos::symbol::InternedString;\n@@ -60,8 +59,8 @@ impl RegionName {\n     }\n \n     #[allow(dead_code)]\n-    crate fn name(&self) -> &InternedString {\n-        &self.name\n+    crate fn name(&self) -> InternedString {\n+        self.name\n     }\n \n     crate fn highlight_region_name(\n@@ -206,7 +205,7 @@ impl<'tcx> RegionInferenceContext<'tcx> {\n         match error_region {\n             ty::ReEarlyBound(ebr) => {\n                 if ebr.has_name() {\n-                    let span = self.get_named_span(tcx, error_region, &ebr.name);\n+                    let span = self.get_named_span(tcx, error_region, ebr.name);\n                     Some(RegionName {\n                         name: ebr.name,\n                         source: RegionNameSource::NamedEarlyBoundRegion(span)\n@@ -223,7 +222,7 @@ impl<'tcx> RegionInferenceContext<'tcx> {\n \n             ty::ReFree(free_region) => match free_region.bound_region {\n                 ty::BoundRegion::BrNamed(_, name) => {\n-                    let span = self.get_named_span(tcx, error_region, &name);\n+                    let span = self.get_named_span(tcx, error_region, name);\n                     Some(RegionName {\n                         name,\n                         source: RegionNameSource::NamedFreeRegion(span),\n@@ -306,7 +305,7 @@ impl<'tcx> RegionInferenceContext<'tcx> {\n         &self,\n         tcx: TyCtxt<'_, '_, 'tcx>,\n         error_region: &RegionKind,\n-        name: &InternedString,\n+        name: InternedString,\n     ) -> Span {\n         let scope = error_region.free_region_binding_scope(tcx);\n         let node = tcx.hir().as_local_hir_id(scope).unwrap_or(hir::DUMMY_HIR_ID);\n@@ -791,6 +790,6 @@ impl<'tcx> RegionInferenceContext<'tcx> {\n         let c = *counter;\n         *counter += 1;\n \n-        Name::intern(&format!(\"'{:?}\", c)).as_interned_str()\n+        InternedString::intern(&format!(\"'{:?}\", c))\n     }\n }"}, {"sha": "6b40245d39a8eae5fb7c094cb85f3d8bd0d122d0", "filename": "src/librustc_mir/monomorphize/item.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc_mir%2Fmonomorphize%2Fitem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc_mir%2Fmonomorphize%2Fitem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fmonomorphize%2Fitem.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -10,7 +10,7 @@ use syntax::attr::InlineAttr;\n use std::fmt::{self, Write};\n use std::iter;\n use rustc::mir::mono::Linkage;\n-use syntax_pos::symbol::Symbol;\n+use syntax_pos::symbol::InternedString;\n use syntax::source_map::Span;\n pub use rustc::mir::mono::MonoItem;\n \n@@ -61,7 +61,7 @@ pub trait MonoItemExt<'a, 'tcx>: fmt::Debug {\n             MonoItem::GlobalAsm(hir_id) => {\n                 let def_id = tcx.hir().local_def_id_from_hir_id(hir_id);\n                 ty::SymbolName {\n-                    name: Symbol::intern(&format!(\"global_asm_{:?}\", def_id)).as_interned_str()\n+                    name: InternedString::intern(&format!(\"global_asm_{:?}\", def_id))\n                 }\n             }\n         }"}, {"sha": "394d1f06029cb6459f2e579b50d770d9dddbd32a", "filename": "src/librustc_mir/transform/check_unsafety.rs", "status": "modified", "additions": 19, "deletions": 24, "changes": 43, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc_mir%2Ftransform%2Fcheck_unsafety.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc_mir%2Ftransform%2Fcheck_unsafety.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Ftransform%2Fcheck_unsafety.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -12,7 +12,7 @@ use rustc::lint::builtin::{SAFE_EXTERN_STATICS, SAFE_PACKED_BORROWS, UNUSED_UNSA\n use rustc::mir::*;\n use rustc::mir::visit::{PlaceContext, Visitor, MutatingUseContext};\n \n-use syntax::symbol::{Symbol, sym};\n+use syntax::symbol::{InternedString, sym};\n \n use std::ops::Bound;\n \n@@ -167,9 +167,9 @@ impl<'a, 'tcx> Visitor<'tcx> for UnsafetyChecker<'a, 'tcx> {\n                     (CastTy::FnPtr, CastTy::Int(_)) => {\n                         self.register_violations(&[UnsafetyViolation {\n                             source_info: self.source_info,\n-                            description: Symbol::intern(\"cast of pointer to int\").as_interned_str(),\n-                            details: Symbol::intern(\"casting pointers to integers in constants\")\n-                                     .as_interned_str(),\n+                            description: InternedString::intern(\"cast of pointer to int\"),\n+                            details: InternedString::intern(\n+                                \"casting pointers to integers in constants\"),\n                             kind: UnsafetyViolationKind::General,\n                         }], &[]);\n                     },\n@@ -185,9 +185,8 @@ impl<'a, 'tcx> Visitor<'tcx> for UnsafetyChecker<'a, 'tcx> {\n                 if let ty::RawPtr(_) | ty::FnPtr(..) = lhs.ty(self.mir, self.tcx).sty {\n                     self.register_violations(&[UnsafetyViolation {\n                         source_info: self.source_info,\n-                        description: Symbol::intern(\"pointer operation\").as_interned_str(),\n-                        details: Symbol::intern(\"operations on pointers in constants\")\n-                                 .as_interned_str(),\n+                        description: InternedString::intern(\"pointer operation\"),\n+                        details: InternedString::intern(\"operations on pointers in constants\"),\n                         kind: UnsafetyViolationKind::General,\n                     }], &[]);\n                 }\n@@ -212,13 +211,11 @@ impl<'a, 'tcx> Visitor<'tcx> for UnsafetyChecker<'a, 'tcx> {\n                             self.source_scope_local_data[source_info.scope].lint_root;\n                         self.register_violations(&[UnsafetyViolation {\n                             source_info,\n-                            description: Symbol::intern(\"borrow of packed field\").as_interned_str(),\n-                            details:\n-                                Symbol::intern(\"fields of packed structs might be misaligned: \\\n-                                                dereferencing a misaligned pointer or even just \\\n-                                                creating a misaligned reference is undefined \\\n-                                                behavior\")\n-                                    .as_interned_str(),\n+                            description: InternedString::intern(\"borrow of packed field\"),\n+                            details: InternedString::intern(\n+                                \"fields of packed structs might be misaligned: dereferencing a \\\n+                                misaligned pointer or even just creating a misaligned reference \\\n+                                is undefined behavior\"),\n                             kind: UnsafetyViolationKind::BorrowPacked(lint_root)\n                         }], &[]);\n                     }\n@@ -315,12 +312,10 @@ impl<'a, 'tcx> Visitor<'tcx> for UnsafetyChecker<'a, 'tcx> {\n                         self.source_scope_local_data[source_info.scope].lint_root;\n                     self.register_violations(&[UnsafetyViolation {\n                         source_info,\n-                        description: Symbol::intern(\"use of extern static\").as_interned_str(),\n-                        details:\n-                            Symbol::intern(\"extern statics are not controlled by the Rust type \\\n-                                            system: invalid data, aliasing violations or data \\\n-                                            races will cause undefined behavior\")\n-                                .as_interned_str(),\n+                        description: InternedString::intern(\"use of extern static\"),\n+                        details: InternedString::intern(\n+                            \"extern statics are not controlled by the Rust type system: invalid \\\n+                            data, aliasing violations or data races will cause undefined behavior\"),\n                         kind: UnsafetyViolationKind::ExternStatic(lint_root)\n                     }], &[]);\n                 }\n@@ -340,8 +335,8 @@ impl<'a, 'tcx> UnsafetyChecker<'a, 'tcx> {\n         let source_info = self.source_info;\n         self.register_violations(&[UnsafetyViolation {\n             source_info,\n-            description: Symbol::intern(description).as_interned_str(),\n-            details: Symbol::intern(details).as_interned_str(),\n+            description: InternedString::intern(description),\n+            details: InternedString::intern(details),\n             kind,\n         }], &[]);\n     }\n@@ -441,8 +436,8 @@ impl<'a, 'tcx> UnsafetyChecker<'a, 'tcx> {\n                                 let source_info = self.source_info;\n                                 self.register_violations(&[UnsafetyViolation {\n                                     source_info,\n-                                    description: Symbol::intern(description).as_interned_str(),\n-                                    details: Symbol::intern(details).as_interned_str(),\n+                                    description: InternedString::intern(description),\n+                                    details: InternedString::intern(details),\n                                     kind: UnsafetyViolationKind::GeneralAndConstFn,\n                                 }], &[]);\n                             }"}, {"sha": "c6191e6b579ce45c036876db9c47656585997c97", "filename": "src/librustc_typeck/check/intrinsic.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc_typeck%2Fcheck%2Fintrinsic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc_typeck%2Fcheck%2Fintrinsic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fintrinsic.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -7,7 +7,7 @@ use rustc::ty::subst::Subst;\n use crate::require_same_types;\n \n use rustc_target::spec::abi::Abi;\n-use syntax::symbol::Symbol;\n+use syntax::symbol::InternedString;\n \n use rustc::hir;\n \n@@ -80,7 +80,7 @@ pub fn intrisic_operation_unsafety(intrinsic: &str) -> hir::Unsafety {\n /// and in libcore/intrinsics.rs\n pub fn check_intrinsic_type<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n                                       it: &hir::ForeignItem) {\n-    let param = |n| tcx.mk_ty_param(n, Symbol::intern(&format!(\"P{}\", n)).as_interned_str());\n+    let param = |n| tcx.mk_ty_param(n, InternedString::intern(&format!(\"P{}\", n)));\n     let name = it.ident.as_str();\n \n     let mk_va_list_ty = || {\n@@ -397,7 +397,7 @@ pub fn check_intrinsic_type<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n pub fn check_platform_intrinsic_type<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n                                                it: &hir::ForeignItem) {\n     let param = |n| {\n-        let name = Symbol::intern(&format!(\"P{}\", n)).as_interned_str();\n+        let name = InternedString::intern(&format!(\"P{}\", n));\n         tcx.mk_ty_param(n, name)\n     };\n "}, {"sha": "711d79f95f53a658d42a1fff866a78c9a78ff4e5", "filename": "src/librustc_typeck/collect.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc_typeck%2Fcollect.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibrustc_typeck%2Fcollect.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcollect.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -39,7 +39,7 @@ use syntax::ast::{Ident, MetaItemKind};\n use syntax::attr::{InlineAttr, OptimizeAttr, list_contains_name, mark_used};\n use syntax::source_map::Spanned;\n use syntax::feature_gate;\n-use syntax::symbol::{keywords, Symbol, sym};\n+use syntax::symbol::{InternedString, keywords, Symbol, sym};\n use syntax_pos::{Span, DUMMY_SP};\n \n use rustc::hir::def::{CtorKind, Res, DefKind};\n@@ -1082,7 +1082,7 @@ fn generics_of<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>, def_id: DefId) -> &'tcx ty\n                 .enumerate()\n                 .map(|(i, &arg)| ty::GenericParamDef {\n                     index: type_start + i as u32,\n-                    name: Symbol::intern(arg).as_interned_str(),\n+                    name: InternedString::intern(arg),\n                     def_id,\n                     pure_wrt_drop: false,\n                     kind: ty::GenericParamDefKind::Type {\n@@ -1097,7 +1097,7 @@ fn generics_of<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>, def_id: DefId) -> &'tcx ty\n             params.extend(upvars.iter().zip((dummy_args.len() as u32)..).map(|(_, i)| {\n                 ty::GenericParamDef {\n                     index: type_start + i,\n-                    name: Symbol::intern(\"<upvar>\").as_interned_str(),\n+                    name: InternedString::intern(\"<upvar>\"),\n                     def_id,\n                     pure_wrt_drop: false,\n                     kind: ty::GenericParamDefKind::Type {"}, {"sha": "aa9028d4a6bad3758d5ed57bfa1a76defb85bdda", "filename": "src/libsyntax_pos/symbol.rs", "status": "modified", "additions": 20, "deletions": 2, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibsyntax_pos%2Fsymbol.rs", "raw_url": "https://github.com/rust-lang/rust/raw/caef1e833fbd9de740d521114d716a11a29b71cb/src%2Flibsyntax_pos%2Fsymbol.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax_pos%2Fsymbol.rs?ref=caef1e833fbd9de740d521114d716a11a29b71cb", "patch": "@@ -1036,6 +1036,17 @@ pub struct LocalInternedString {\n }\n \n impl LocalInternedString {\n+    /// Maps a string to its interned representation.\n+    pub fn intern(string: &str) -> Self {\n+        let string = with_interner(|interner| {\n+            let symbol = interner.intern(string);\n+            interner.strings[symbol.0.as_usize()]\n+        });\n+        LocalInternedString {\n+            string: unsafe { std::mem::transmute::<&str, &str>(string) }\n+        }\n+    }\n+\n     pub fn as_interned_str(self) -> InternedString {\n         InternedString {\n             symbol: Symbol::intern(self.string)\n@@ -1112,7 +1123,7 @@ impl fmt::Display for LocalInternedString {\n \n impl Decodable for LocalInternedString {\n     fn decode<D: Decoder>(d: &mut D) -> Result<LocalInternedString, D::Error> {\n-        Ok(Symbol::intern(&d.read_str()?).as_str())\n+        Ok(LocalInternedString::intern(&d.read_str()?))\n     }\n }\n \n@@ -1141,6 +1152,13 @@ pub struct InternedString {\n }\n \n impl InternedString {\n+    /// Maps a string to its interned representation.\n+    pub fn intern(string: &str) -> Self {\n+        InternedString {\n+            symbol: Symbol::intern(string)\n+        }\n+    }\n+\n     pub fn with<F: FnOnce(&str) -> R, R>(self, f: F) -> R {\n         let str = with_interner(|interner| {\n             interner.get(self.symbol) as *const str\n@@ -1243,7 +1261,7 @@ impl fmt::Display for InternedString {\n \n impl Decodable for InternedString {\n     fn decode<D: Decoder>(d: &mut D) -> Result<InternedString, D::Error> {\n-        Ok(Symbol::intern(&d.read_str()?).as_interned_str())\n+        Ok(InternedString::intern(&d.read_str()?))\n     }\n }\n "}]}