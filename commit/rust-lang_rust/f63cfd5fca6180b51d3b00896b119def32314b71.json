{"sha": "f63cfd5fca6180b51d3b00896b119def32314b71", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY2M2NmZDVmY2E2MTgwYjUxZDNiMDA4OTZiMTE5ZGVmMzIzMTRiNzE=", "commit": {"author": {"name": "Kirill Bulatov", "email": "mail4score@gmail.com", "date": "2019-08-11T21:11:15Z"}, "committer": {"name": "Kirill Bulatov", "email": "mail4score@gmail.com", "date": "2019-08-26T19:44:50Z"}, "message": "Tests", "tree": {"sha": "64faa6aa77ab887492c7dbb9098a0d2221af63b7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/64faa6aa77ab887492c7dbb9098a0d2221af63b7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f63cfd5fca6180b51d3b00896b119def32314b71", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f63cfd5fca6180b51d3b00896b119def32314b71", "html_url": "https://github.com/rust-lang/rust/commit/f63cfd5fca6180b51d3b00896b119def32314b71", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f63cfd5fca6180b51d3b00896b119def32314b71/comments", "author": {"login": "SomeoneToIgnore", "id": 2690773, "node_id": "MDQ6VXNlcjI2OTA3NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/2690773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SomeoneToIgnore", "html_url": "https://github.com/SomeoneToIgnore", "followers_url": "https://api.github.com/users/SomeoneToIgnore/followers", "following_url": "https://api.github.com/users/SomeoneToIgnore/following{/other_user}", "gists_url": "https://api.github.com/users/SomeoneToIgnore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SomeoneToIgnore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SomeoneToIgnore/subscriptions", "organizations_url": "https://api.github.com/users/SomeoneToIgnore/orgs", "repos_url": "https://api.github.com/users/SomeoneToIgnore/repos", "events_url": "https://api.github.com/users/SomeoneToIgnore/events{/privacy}", "received_events_url": "https://api.github.com/users/SomeoneToIgnore/received_events", "type": "User", "site_admin": false}, "committer": {"login": "SomeoneToIgnore", "id": 2690773, "node_id": "MDQ6VXNlcjI2OTA3NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/2690773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SomeoneToIgnore", "html_url": "https://github.com/SomeoneToIgnore", "followers_url": "https://api.github.com/users/SomeoneToIgnore/followers", "following_url": "https://api.github.com/users/SomeoneToIgnore/following{/other_user}", "gists_url": "https://api.github.com/users/SomeoneToIgnore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SomeoneToIgnore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SomeoneToIgnore/subscriptions", "organizations_url": "https://api.github.com/users/SomeoneToIgnore/orgs", "repos_url": "https://api.github.com/users/SomeoneToIgnore/repos", "events_url": "https://api.github.com/users/SomeoneToIgnore/events{/privacy}", "received_events_url": "https://api.github.com/users/SomeoneToIgnore/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "04c2961d0c5493962e948dc8101445cc76f1d460", "url": "https://api.github.com/repos/rust-lang/rust/commits/04c2961d0c5493962e948dc8101445cc76f1d460", "html_url": "https://github.com/rust-lang/rust/commit/04c2961d0c5493962e948dc8101445cc76f1d460"}], "stats": {"total": 104, "additions": 104, "deletions": 0}, "files": [{"sha": "0f53f156edb61af1a00c1d28b361224de27d0b04", "filename": "crates/ra_hir/src/ty/tests.rs", "status": "modified", "additions": 104, "deletions": 0, "changes": 104, "blob_url": "https://github.com/rust-lang/rust/blob/f63cfd5fca6180b51d3b00896b119def32314b71/crates%2Fra_hir%2Fsrc%2Fty%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f63cfd5fca6180b51d3b00896b119def32314b71/crates%2Fra_hir%2Fsrc%2Fty%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty%2Ftests.rs?ref=f63cfd5fca6180b51d3b00896b119def32314b71", "patch": "@@ -3594,3 +3594,107 @@ fn no_such_field_diagnostics() {\n \"###\n     );\n }\n+\n+#[cfg(test)]\n+mod match_with_never_tests {\n+    use super::type_at;\n+\n+    #[test]\n+    fn match_compex_arm_ty() {\n+        let t = type_at(\n+            r#\"\n+//- /main.rs\n+enum Option<T> {\n+    Some(T),\n+    None\n+}\n+\n+fn test(a: i32) {\n+    let i = match a {\n+        2 => Option::Some(2.0),\n+        _ => loop {},\n+    };\n+    i<|>\n+    ()\n+}\n+\"#,\n+        );\n+        assert_eq!(t, \"Option<f64>\");\n+    }\n+\n+    #[test]\n+    fn match_first_arm_never() {\n+        let t = type_at(\n+            r#\"\n+//- /main.rs\n+fn test(a: i32) {\n+    let i = match a {\n+        1 => return,\n+        2 => 2.0,\n+        3 => loop {},\n+        _ => 3.0,\n+    };\n+    i<|>\n+    ()\n+}\n+\"#,\n+        );\n+        assert_eq!(t, \"f64\");\n+    }\n+\n+    #[test]\n+    fn match_second_arm_never() {\n+        let t = type_at(\n+            r#\"\n+//- /main.rs\n+fn test(a: i32) {\n+    let i = match a {\n+        1 => 3.0,\n+        2 => loop {},\n+        3 => 3.0,\n+        _ => return,\n+    };\n+    i<|>\n+    ()\n+}\n+\"#,\n+        );\n+        assert_eq!(t, \"f64\");\n+    }\n+\n+    #[test]\n+    fn match_all_arms_never() {\n+        let t = type_at(\n+            r#\"\n+//- /main.rs\n+fn test(a: i32) {\n+    let i = match a {\n+        2 => return,\n+        _ => loop {},\n+    };\n+    i<|>\n+    ()\n+}\n+\"#,\n+        );\n+        assert_eq!(t, \"!\");\n+    }\n+\n+    #[test]\n+    fn match_no_never_arms() {\n+        let t = type_at(\n+            r#\"\n+//- /main.rs\n+fn test(a: i32) {\n+    let i = match a {\n+        2 => 2.0,\n+        _ => 3.0,\n+    };\n+    i<|>\n+    ()\n+}\n+\"#,\n+        );\n+        assert_eq!(t, \"f64\");\n+    }\n+}"}]}