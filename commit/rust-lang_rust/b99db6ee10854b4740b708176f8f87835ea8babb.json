{"sha": "b99db6ee10854b4740b708176f8f87835ea8babb", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI5OWRiNmVlMTA4NTRiNDc0MGI3MDgxNzZmOGY4NzgzNWVhOGJhYmI=", "commit": {"author": {"name": "Dylan DPC", "email": "dylan.dpc@gmail.com", "date": "2020-03-30T14:24:49Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-03-30T14:24:49Z"}, "message": "Rollup merge of #70546 - lqd:polonius_update, r=nikomatsakis\n\nPolonius: update to 0.12.1, fix more move errors false positives, update test expectations\n\nThis PR:\n- updates `polonius-engine` to version 0.12.1 to fix some move errors false positives\n- fixes a fact generation mistake creating the other move errors false positives\n- updates the test expectations for the polonius compare-mode so that all (minus the 2 OOMs) ui tests pass again (matching the [analysis doc](https://hackmd.io/CjYB0fs4Q9CweyeTdKWyEg?view) starting at case 34)\n\nIn my opinion, this is safe to rollup.\n\nr? @nikomatsakis", "tree": {"sha": "1a83ce2e8cddaee9125cd8960d3089b3162955ca", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1a83ce2e8cddaee9125cd8960d3089b3162955ca"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b99db6ee10854b4740b708176f8f87835ea8babb", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJeggExCRBK7hj4Ov3rIwAAdHIIAAfbrZ0upsKO9uUXcYeZIaoE\n1GRPSRsk+SOSMmyaac6mNeY+UQMQXWYgZuF3BOdg+A0xRY2ZTulfc3kRWxOfXoYN\nnExZz7z+pRZi/2SsTZDEMmtk323dvEcW6k9foNQbVhmq8gQYBKO5A7tgUbn15Rsw\nNo/Y/5rcR/C1Yr6kTLOHpX00FUay2vby4M0k8BruF+UzGV/Dsb8sub6z3eGGeqtw\nDxaKJ289tPKL9IrS/yiVafXoLw0l+/ab5yd9I/6LBxEABXW8uCWtRcDAseAwEd8m\nNsUCBnCz2wc2GN/M8qsbEqotb9xDn1SiIWOCaVqINxBtQM5C/hvNxeT7UkZdCjw=\n=H6d0\n-----END PGP SIGNATURE-----\n", "payload": "tree 1a83ce2e8cddaee9125cd8960d3089b3162955ca\nparent 47ffca296a533ee389fcea91de3f09827a7c9c49\nparent 5af11d261d38c6dad4475c933ffa59a388979cfb\nauthor Dylan DPC <dylan.dpc@gmail.com> 1585578289 +0200\ncommitter GitHub <noreply@github.com> 1585578289 +0200\n\nRollup merge of #70546 - lqd:polonius_update, r=nikomatsakis\n\nPolonius: update to 0.12.1, fix more move errors false positives, update test expectations\n\nThis PR:\n- updates `polonius-engine` to version 0.12.1 to fix some move errors false positives\n- fixes a fact generation mistake creating the other move errors false positives\n- updates the test expectations for the polonius compare-mode so that all (minus the 2 OOMs) ui tests pass again (matching the [analysis doc](https://hackmd.io/CjYB0fs4Q9CweyeTdKWyEg?view) starting at case 34)\n\nIn my opinion, this is safe to rollup.\n\nr? @nikomatsakis\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b99db6ee10854b4740b708176f8f87835ea8babb", "html_url": "https://github.com/rust-lang/rust/commit/b99db6ee10854b4740b708176f8f87835ea8babb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b99db6ee10854b4740b708176f8f87835ea8babb/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "47ffca296a533ee389fcea91de3f09827a7c9c49", "url": "https://api.github.com/repos/rust-lang/rust/commits/47ffca296a533ee389fcea91de3f09827a7c9c49", "html_url": "https://github.com/rust-lang/rust/commit/47ffca296a533ee389fcea91de3f09827a7c9c49"}, {"sha": "5af11d261d38c6dad4475c933ffa59a388979cfb", "url": "https://api.github.com/repos/rust-lang/rust/commits/5af11d261d38c6dad4475c933ffa59a388979cfb", "html_url": "https://github.com/rust-lang/rust/commit/5af11d261d38c6dad4475c933ffa59a388979cfb"}], "stats": {"total": 34, "additions": 20, "deletions": 14}, "files": [{"sha": "15d016a97cf8c56f85fd1cdd64dd57f93b4ab54e", "filename": "Cargo.lock", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b99db6ee10854b4740b708176f8f87835ea8babb/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/b99db6ee10854b4740b708176f8f87835ea8babb/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=b99db6ee10854b4740b708176f8f87835ea8babb", "patch": "@@ -2522,9 +2522,9 @@ checksum = \"05da548ad6865900e60eaba7f589cc0783590a92e940c26953ff81ddbab2d677\"\n \n [[package]]\n name = \"polonius-engine\"\n-version = \"0.12.0\"\n+version = \"0.12.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"04d8ef65e3f89ecaec9ca7cb0e0911b4617352d4494018bcf934992f03f2024c\"\n+checksum = \"ef2558a4b464e185b36ee08a2937ebb62ea5464c38856cfb1465c97cb38db52d\"\n dependencies = [\n  \"datafrog\",\n  \"log\","}, {"sha": "26d75f08ae49aa11a744d27994dac56ab310e288", "filename": "src/librustc_mir/borrow_check/type_check/liveness/polonius.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b99db6ee10854b4740b708176f8f87835ea8babb/src%2Flibrustc_mir%2Fborrow_check%2Ftype_check%2Fliveness%2Fpolonius.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b99db6ee10854b4740b708176f8f87835ea8babb/src%2Flibrustc_mir%2Fborrow_check%2Ftype_check%2Fliveness%2Fpolonius.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Ftype_check%2Fliveness%2Fpolonius.rs?ref=b99db6ee10854b4740b708176f8f87835ea8babb", "patch": "@@ -43,7 +43,7 @@ impl UseFactsExtractor<'_> {\n \n     fn insert_path_access(&mut self, path: MovePathIndex, location: Location) {\n         debug!(\"UseFactsExtractor::insert_path_access({:?}, {:?})\", path, location);\n-        self.path_accessed_at_base.push((path, self.location_table.start_index(location)));\n+        self.path_accessed_at_base.push((path, self.location_to_index(location)));\n     }\n \n     fn place_to_mpi(&self, place: &Place<'_>) -> Option<MovePathIndex> {"}, {"sha": "df60416709f13f8fdc24fedaf5809206474b38aa", "filename": "src/test/ui/closures/closure-expected-type/expect-region-supply-region.polonius.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/b99db6ee10854b4740b708176f8f87835ea8babb/src%2Ftest%2Fui%2Fclosures%2Fclosure-expected-type%2Fexpect-region-supply-region.polonius.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b99db6ee10854b4740b708176f8f87835ea8babb/src%2Ftest%2Fui%2Fclosures%2Fclosure-expected-type%2Fexpect-region-supply-region.polonius.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fclosures%2Fclosure-expected-type%2Fexpect-region-supply-region.polonius.stderr?ref=b99db6ee10854b4740b708176f8f87835ea8babb", "patch": "@@ -2,7 +2,7 @@ error[E0521]: borrowed data escapes outside of closure\n   --> $DIR/expect-region-supply-region.rs:18:9\n    |\n LL |     let mut f: Option<&u32> = None;\n-   |         ----- `f` is declared here, outside of the closure body\n+   |         ----- `f` declared here, outside of the closure body\n LL |     closure_expecting_bound(|x| {\n    |                              - `x` is a reference that is only valid in the closure body\n LL |         f = Some(x);\n@@ -12,7 +12,7 @@ error[E0521]: borrowed data escapes outside of closure\n   --> $DIR/expect-region-supply-region.rs:28:9\n    |\n LL |     let mut f: Option<&u32> = None;\n-   |         ----- `f` is declared here, outside of the closure body\n+   |         ----- `f` declared here, outside of the closure body\n LL |     closure_expecting_bound(|x: &u32| {\n    |                              - `x` is a reference that is only valid in the closure body\n LL |         f = Some(x);\n@@ -33,7 +33,7 @@ error[E0521]: borrowed data escapes outside of closure\n   --> $DIR/expect-region-supply-region.rs:42:9\n    |\n LL |     let mut f: Option<&u32> = None;\n-   |         ----- `f` is declared here, outside of the closure body\n+   |         ----- `f` declared here, outside of the closure body\n ...\n LL |     closure_expecting_bound(|x: &'x u32| {\n    |                              - `x` is a reference that is only valid in the closure body"}, {"sha": "676a934569c4783f57cc66060e1ca943667d4aad", "filename": "src/test/ui/hrtb/hrtb-perfect-forwarding.polonius.stderr", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/b99db6ee10854b4740b708176f8f87835ea8babb/src%2Ftest%2Fui%2Fhrtb%2Fhrtb-perfect-forwarding.polonius.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b99db6ee10854b4740b708176f8f87835ea8babb/src%2Ftest%2Fui%2Fhrtb%2Fhrtb-perfect-forwarding.polonius.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fhrtb%2Fhrtb-perfect-forwarding.polonius.stderr?ref=b99db6ee10854b4740b708176f8f87835ea8babb", "patch": "@@ -39,6 +39,7 @@ LL | |     // Not OK -- The forwarding impl for `Foo` requires that `Bar` also\n ...  |\n LL | |     foo_hrtb_bar_not(&mut t);\n    | |     ------------------------ recursive call site\n+LL | |\n LL | | }\n    | |_^ cannot return without recursing\n    |\n@@ -51,7 +52,7 @@ LL |     foo_hrtb_bar_not(&mut t);\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^\n \n warning: function cannot return without recursing\n-  --> $DIR/hrtb-perfect-forwarding.rs:49:1\n+  --> $DIR/hrtb-perfect-forwarding.rs:50:1\n    |\n LL | / fn foo_hrtb_bar_hrtb<T>(mut t: T)\n LL | |     where T : for<'a> Foo<&'a isize> + for<'b> Bar<&'b isize>"}, {"sha": "6ce3aaf49eb339b12630c25e863546a959c7027f", "filename": "src/test/ui/impl-trait/multiple-lifetimes/error-handling.polonius.stderr", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/b99db6ee10854b4740b708176f8f87835ea8babb/src%2Ftest%2Fui%2Fimpl-trait%2Fmultiple-lifetimes%2Ferror-handling.polonius.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b99db6ee10854b4740b708176f8f87835ea8babb/src%2Ftest%2Fui%2Fimpl-trait%2Fmultiple-lifetimes%2Ferror-handling.polonius.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimpl-trait%2Fmultiple-lifetimes%2Ferror-handling.polonius.stderr?ref=b99db6ee10854b4740b708176f8f87835ea8babb", "patch": "@@ -1,10 +1,13 @@\n error: lifetime may not live long enough\n-  --> $DIR/error-handling.rs:13:56\n+  --> $DIR/error-handling.rs:23:16\n    |\n LL | fn foo<'a, 'b, 'c>(x: &'static i32, mut y: &'a i32) -> E<'b, 'c> {\n-   |        --  -- lifetime `'b` defined here               ^^^^^^^^^ opaque type requires that `'a` must outlive `'b`\n+   |        --  -- lifetime `'b` defined here\n    |        |\n    |        lifetime `'a` defined here\n+...\n+LL |         let _: &'b i32 = *u.0;\n+   |                ^^^^^^^ type annotation requires that `'a` must outlive `'b`\n    |\n    = help: consider adding the following bound: `'a: 'b`\n "}, {"sha": "dbbda62d2086c27f59d8c4fb355c686322521a1d", "filename": "src/test/ui/nll/outlives-suggestion-simple.polonius.stderr", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/b99db6ee10854b4740b708176f8f87835ea8babb/src%2Ftest%2Fui%2Fnll%2Foutlives-suggestion-simple.polonius.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b99db6ee10854b4740b708176f8f87835ea8babb/src%2Ftest%2Fui%2Fnll%2Foutlives-suggestion-simple.polonius.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnll%2Foutlives-suggestion-simple.polonius.stderr?ref=b99db6ee10854b4740b708176f8f87835ea8babb", "patch": "@@ -72,6 +72,8 @@ LL |     (x, x)\n    |\n    = help: consider adding the following bound: `'a: 'c`\n \n+help: add bound `'a: 'b + 'c`\n+\n error: lifetime may not live long enough\n   --> $DIR/outlives-suggestion-simple.rs:31:9\n    |\n@@ -106,16 +108,16 @@ LL |         self.x\n    |\n    = help: consider adding the following bound: `'b: 'a`\n \n-error[E0521]: borrowed data escapes outside of function\n+error[E0521]: borrowed data escapes outside of associated function\n   --> $DIR/outlives-suggestion-simple.rs:73:9\n    |\n LL |     fn get_bar(&self) -> Bar2 {\n    |                -----\n    |                |\n-   |                `self` is declared here, outside of the function body\n-   |                `self` is a reference that is only valid in the function body\n+   |                `self` declared here, outside of the associated function body\n+   |                `self` is a reference that is only valid in the associated function body\n LL |         Bar2::new(&self)\n-   |         ^^^^^^^^^^^^^^^^ `self` escapes the function body here\n+   |         ^^^^^^^^^^^^^^^^ `self` escapes the associated function body here\n \n error: aborting due to 10 previous errors\n "}, {"sha": "46b6c04dcbc341e502a0c51bda030107e85b55da", "filename": "src/test/ui/nll/user-annotations/closure-substs.polonius.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b99db6ee10854b4740b708176f8f87835ea8babb/src%2Ftest%2Fui%2Fnll%2Fuser-annotations%2Fclosure-substs.polonius.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/b99db6ee10854b4740b708176f8f87835ea8babb/src%2Ftest%2Fui%2Fnll%2Fuser-annotations%2Fclosure-substs.polonius.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnll%2Fuser-annotations%2Fclosure-substs.polonius.stderr?ref=b99db6ee10854b4740b708176f8f87835ea8babb", "patch": "@@ -50,7 +50,7 @@ error[E0521]: borrowed data escapes outside of closure\n   --> $DIR/closure-substs.rs:29:9\n    |\n LL |     |x: &i32, b: fn(&'static i32)| {\n-   |      -        - `b` is declared here, outside of the closure body\n+   |      -        - `b` declared here, outside of the closure body\n    |      |\n    |      `x` is a reference that is only valid in the closure body\n LL |         b(x);"}]}