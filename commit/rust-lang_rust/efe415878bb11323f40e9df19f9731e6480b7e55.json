{"sha": "efe415878bb11323f40e9df19f9731e6480b7e55", "node_id": "C_kwDOAAsO6NoAKGVmZTQxNTg3OGJiMTEzMjNmNDBlOWRmMTlmOTczMWU2NDgwYjdlNTU", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-01-01T09:48:56Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-01-01T09:48:56Z"}, "message": "Rollup merge of #92420 - dtolnay:patrange, r=Mark-Simulacrum\n\nFix whitespace in pretty printed PatKind::Range\n\nFollow-up to #92238 fixing one of the FIXMEs.\n\n```rust\nmacro_rules! repro {\n    ($pat:pat) => {\n        stringify!($pat)\n    };\n}\n\nfn main() {\n    println!(\"{}\", repro!(0..=1));\n}\n```\n\nBefore:&ensp;`0 ..=1`\nAfter:&ensp;`0..=1`\n\nThe canonical spacing applied by rustfmt has no space after the lower expr. Rustc's parser diagnostics also do not put a space there:\n\nhttps://github.com/rust-lang/rust/blob/df96fb166f59431e3de443835e50d5b8a7a4adb0/compiler/rustc_parse/src/parser/pat.rs#L754", "tree": {"sha": "8256f68fa10e2485febbf144598e287161359f4d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8256f68fa10e2485febbf144598e287161359f4d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/efe415878bb11323f40e9df19f9731e6480b7e55", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJh0COICRBK7hj4Ov3rIwAA1Z4IACqDwLxJPvw7RqA1/4+LklVF\nigmQSjFVwr2DcyLeHfibczypZdiZry0P28u/mcPd9FvFpTuDznRLYzd0dyfMcwWd\nW7oS78Bc6eR1fKM0BEazc2ZLmH49X6NdAHHbUSZZqEAtfWtierA1gadH1zzDYkSN\n9zA1gswNkrYThw3jKuKw7Bfhz7zzLC/Uc0vNFb2vzx/6410bEnrFZxqNE3lEi5vK\noGG8+7UBbIIXFzeiQjklqL6DO2axyUdHnWOKkJhMq5AgJI8Gl4gPSPpKfomzrKTj\nwu5U3brmorvVZFRFLkF4ioLsBPKpYC17mKyzaXzBe3zn6oZBErPsNfwTUxEM1B8=\n=969L\n-----END PGP SIGNATURE-----\n", "payload": "tree 8256f68fa10e2485febbf144598e287161359f4d\nparent 682b4cbc4ee64fd3c4c548061e126496774f1435\nparent bc1a1ff3c86a12555e8cb430fd8ed608201ccb14\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1641030536 +0100\ncommitter GitHub <noreply@github.com> 1641030536 +0100\n\nRollup merge of #92420 - dtolnay:patrange, r=Mark-Simulacrum\n\nFix whitespace in pretty printed PatKind::Range\n\nFollow-up to #92238 fixing one of the FIXMEs.\n\n```rust\nmacro_rules! repro {\n    ($pat:pat) => {\n        stringify!($pat)\n    };\n}\n\nfn main() {\n    println!(\"{}\", repro!(0..=1));\n}\n```\n\nBefore:&ensp;`0 ..=1`\nAfter:&ensp;`0..=1`\n\nThe canonical spacing applied by rustfmt has no space after the lower expr. Rustc's parser diagnostics also do not put a space there:\n\nhttps://github.com/rust-lang/rust/blob/df96fb166f59431e3de443835e50d5b8a7a4adb0/compiler/rustc_parse/src/parser/pat.rs#L754\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/efe415878bb11323f40e9df19f9731e6480b7e55", "html_url": "https://github.com/rust-lang/rust/commit/efe415878bb11323f40e9df19f9731e6480b7e55", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/efe415878bb11323f40e9df19f9731e6480b7e55/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "682b4cbc4ee64fd3c4c548061e126496774f1435", "url": "https://api.github.com/repos/rust-lang/rust/commits/682b4cbc4ee64fd3c4c548061e126496774f1435", "html_url": "https://github.com/rust-lang/rust/commit/682b4cbc4ee64fd3c4c548061e126496774f1435"}, {"sha": "bc1a1ff3c86a12555e8cb430fd8ed608201ccb14", "url": "https://api.github.com/repos/rust-lang/rust/commits/bc1a1ff3c86a12555e8cb430fd8ed608201ccb14", "html_url": "https://github.com/rust-lang/rust/commit/bc1a1ff3c86a12555e8cb430fd8ed608201ccb14"}], "stats": {"total": 26, "additions": 12, "deletions": 14}, "files": [{"sha": "b87dd449a1e57131cab019899a0f750c51b75fb0", "filename": "compiler/rustc_ast_pretty/src/pprust/state.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/efe415878bb11323f40e9df19f9731e6480b7e55/compiler%2Frustc_ast_pretty%2Fsrc%2Fpprust%2Fstate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efe415878bb11323f40e9df19f9731e6480b7e55/compiler%2Frustc_ast_pretty%2Fsrc%2Fpprust%2Fstate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_pretty%2Fsrc%2Fpprust%2Fstate.rs?ref=efe415878bb11323f40e9df19f9731e6480b7e55", "patch": "@@ -2516,7 +2516,6 @@ impl<'a> State<'a> {\n             PatKind::Range(ref begin, ref end, Spanned { node: ref end_kind, .. }) => {\n                 if let Some(e) = begin {\n                     self.print_expr(e);\n-                    self.space();\n                 }\n                 match *end_kind {\n                     RangeEnd::Included(RangeSyntax::DotDotDot) => self.word(\"...\"),"}, {"sha": "fb11aaf24c4b8d15804de10ab819e2036a29ef29", "filename": "compiler/rustc_hir_pretty/src/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/efe415878bb11323f40e9df19f9731e6480b7e55/compiler%2Frustc_hir_pretty%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efe415878bb11323f40e9df19f9731e6480b7e55/compiler%2Frustc_hir_pretty%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_pretty%2Fsrc%2Flib.rs?ref=efe415878bb11323f40e9df19f9731e6480b7e55", "patch": "@@ -1948,7 +1948,6 @@ impl<'a> State<'a> {\n             PatKind::Range(ref begin, ref end, ref end_kind) => {\n                 if let Some(expr) = begin {\n                     self.print_expr(expr);\n-                    self.space();\n                 }\n                 match *end_kind {\n                     RangeEnd::Included => self.word(\"...\"),"}, {"sha": "93b73c57e9b4d364099996f648f651f9eb81a211", "filename": "src/test/ui/half-open-range-patterns/half-open-range-pats-ref-ambiguous-interp.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/efe415878bb11323f40e9df19f9731e6480b7e55/src%2Ftest%2Fui%2Fhalf-open-range-patterns%2Fhalf-open-range-pats-ref-ambiguous-interp.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/efe415878bb11323f40e9df19f9731e6480b7e55/src%2Ftest%2Fui%2Fhalf-open-range-patterns%2Fhalf-open-range-pats-ref-ambiguous-interp.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fhalf-open-range-patterns%2Fhalf-open-range-pats-ref-ambiguous-interp.stderr?ref=efe415878bb11323f40e9df19f9731e6480b7e55", "patch": "@@ -2,7 +2,7 @@ error: the range pattern here has ambiguous interpretation\n   --> $DIR/half-open-range-pats-ref-ambiguous-interp.rs:8:10\n    |\n LL |         &0.. | _ => {}\n-   |          ^^^ help: add parentheses to clarify the precedence: `(0 ..)`\n+   |          ^^^ help: add parentheses to clarify the precedence: `(0..)`\n \n error[E0586]: inclusive range with no end\n   --> $DIR/half-open-range-pats-ref-ambiguous-interp.rs:10:11\n@@ -16,7 +16,7 @@ error: the range pattern here has ambiguous interpretation\n   --> $DIR/half-open-range-pats-ref-ambiguous-interp.rs:10:10\n    |\n LL |         &0..= | _ => {}\n-   |          ^^^^ help: add parentheses to clarify the precedence: `(0 ..=)`\n+   |          ^^^^ help: add parentheses to clarify the precedence: `(0..=)`\n \n error[E0586]: inclusive range with no end\n   --> $DIR/half-open-range-pats-ref-ambiguous-interp.rs:13:11"}, {"sha": "343a26c14a9b0034ce617331362db35d7c38d5ed", "filename": "src/test/ui/macros/stringify.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/efe415878bb11323f40e9df19f9731e6480b7e55/src%2Ftest%2Fui%2Fmacros%2Fstringify.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efe415878bb11323f40e9df19f9731e6480b7e55/src%2Ftest%2Fui%2Fmacros%2Fstringify.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Fstringify.rs?ref=efe415878bb11323f40e9df19f9731e6480b7e55", "patch": "@@ -712,10 +712,10 @@ fn test_pat() {\n \n     // PatKind::Range\n     assert_eq!(stringify_pat!(..1), \"..1\");\n-    assert_eq!(stringify_pat!(0..), \"0 ..\"); // FIXME\n-    assert_eq!(stringify_pat!(0..1), \"0 ..1\");\n-    assert_eq!(stringify_pat!(0..=1), \"0 ..=1\");\n-    assert_eq!(stringify_pat!(-2..=-1), \"-2 ..=-1\");\n+    assert_eq!(stringify_pat!(0..), \"0..\");\n+    assert_eq!(stringify_pat!(0..1), \"0..1\");\n+    assert_eq!(stringify_pat!(0..=1), \"0..=1\");\n+    assert_eq!(stringify_pat!(-2..=-1), \"-2..=-1\");\n \n     // PatKind::Slice\n     assert_eq!(stringify_pat!([]), \"[]\");"}, {"sha": "a6d27aab4f6af0269d477a1497ccac643cefc38d", "filename": "src/test/ui/parser/intersection-patterns.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/efe415878bb11323f40e9df19f9731e6480b7e55/src%2Ftest%2Fui%2Fparser%2Fintersection-patterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efe415878bb11323f40e9df19f9731e6480b7e55/src%2Ftest%2Fui%2Fparser%2Fintersection-patterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fintersection-patterns.rs?ref=efe415878bb11323f40e9df19f9731e6480b7e55", "patch": "@@ -34,7 +34,7 @@ fn main() {\n         //~| pattern on the left, should be on the right\n         //~| binding on the right, should be on the left\n         //~| HELP switch the order\n-        //~| SUGGESTION e @ 1 ..=5\n+        //~| SUGGESTION e @ 1..=5\n         _ => {}\n     }\n }"}, {"sha": "9dc4c469a60720258ee9eebab4c6284716f946e3", "filename": "src/test/ui/parser/intersection-patterns.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/efe415878bb11323f40e9df19f9731e6480b7e55/src%2Ftest%2Fui%2Fparser%2Fintersection-patterns.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/efe415878bb11323f40e9df19f9731e6480b7e55/src%2Ftest%2Fui%2Fparser%2Fintersection-patterns.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fintersection-patterns.stderr?ref=efe415878bb11323f40e9df19f9731e6480b7e55", "patch": "@@ -27,7 +27,7 @@ LL |         1 ..= 5 @ e => {}\n    |         |         |\n    |         |         binding on the right, should be on the left\n    |         pattern on the left, should be on the right\n-   |         help: switch the order: `e @ 1 ..=5`\n+   |         help: switch the order: `e @ 1..=5`\n \n error: aborting due to 3 previous errors\n "}, {"sha": "38104bab7c8ee77762f1a309412e360dc9f3ea6a", "filename": "src/test/ui/range/range-inclusive-pattern-precedence.fixed", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/efe415878bb11323f40e9df19f9731e6480b7e55/src%2Ftest%2Fui%2Frange%2Frange-inclusive-pattern-precedence.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/efe415878bb11323f40e9df19f9731e6480b7e55/src%2Ftest%2Fui%2Frange%2Frange-inclusive-pattern-precedence.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frange%2Frange-inclusive-pattern-precedence.fixed?ref=efe415878bb11323f40e9df19f9731e6480b7e55", "patch": "@@ -12,7 +12,7 @@ pub fn main() {\n         //~^ WARN `...` range patterns are deprecated\n         //~| WARN this is accepted in the current edition\n         //~| HELP use `..=` for an inclusive range\n-        &(10 ..=15) => {}\n+        &(10..=15) => {}\n         //~^ ERROR the range pattern here has ambiguous interpretation\n         //~| HELP add parentheses to clarify the precedence\n         &(16..=20) => {}"}, {"sha": "10513374cf8087f8e2ec0b656f734fe45feeacd9", "filename": "src/test/ui/range/range-inclusive-pattern-precedence.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/efe415878bb11323f40e9df19f9731e6480b7e55/src%2Ftest%2Fui%2Frange%2Frange-inclusive-pattern-precedence.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/efe415878bb11323f40e9df19f9731e6480b7e55/src%2Ftest%2Fui%2Frange%2Frange-inclusive-pattern-precedence.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frange%2Frange-inclusive-pattern-precedence.stderr?ref=efe415878bb11323f40e9df19f9731e6480b7e55", "patch": "@@ -2,7 +2,7 @@ error: the range pattern here has ambiguous interpretation\n   --> $DIR/range-inclusive-pattern-precedence.rs:15:10\n    |\n LL |         &10..=15 => {}\n-   |          ^^^^^^^ help: add parentheses to clarify the precedence: `(10 ..=15)`\n+   |          ^^^^^^^ help: add parentheses to clarify the precedence: `(10..=15)`\n \n warning: `...` range patterns are deprecated\n   --> $DIR/range-inclusive-pattern-precedence.rs:11:9"}, {"sha": "cdec41d7f75d57a99d09d7d808f61a5b1d22f9b6", "filename": "src/test/ui/range/range-inclusive-pattern-precedence2.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/efe415878bb11323f40e9df19f9731e6480b7e55/src%2Ftest%2Fui%2Frange%2Frange-inclusive-pattern-precedence2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/efe415878bb11323f40e9df19f9731e6480b7e55/src%2Ftest%2Fui%2Frange%2Frange-inclusive-pattern-precedence2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frange%2Frange-inclusive-pattern-precedence2.stderr?ref=efe415878bb11323f40e9df19f9731e6480b7e55", "patch": "@@ -2,7 +2,7 @@ error: the range pattern here has ambiguous interpretation\n   --> $DIR/range-inclusive-pattern-precedence2.rs:14:13\n    |\n LL |         box 10..=15 => {}\n-   |             ^^^^^^^ help: add parentheses to clarify the precedence: `(10 ..=15)`\n+   |             ^^^^^^^ help: add parentheses to clarify the precedence: `(10..=15)`\n \n warning: `...` range patterns are deprecated\n   --> $DIR/range-inclusive-pattern-precedence2.rs:10:14"}, {"sha": "b745b988631693bcb54a88dce0959e1456cd8537", "filename": "src/test/ui/unpretty-expr-fn-arg.stdout", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/efe415878bb11323f40e9df19f9731e6480b7e55/src%2Ftest%2Fui%2Funpretty-expr-fn-arg.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/efe415878bb11323f40e9df19f9731e6480b7e55/src%2Ftest%2Fui%2Funpretty-expr-fn-arg.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Funpretty-expr-fn-arg.stdout?ref=efe415878bb11323f40e9df19f9731e6480b7e55", "patch": "@@ -14,4 +14,4 @@ extern crate std;\n \n fn main() ({ } as ())\n \n-fn foo((-(128 as i8) as i8) ...(127 as i8): i8) ({ } as ())\n+fn foo((-(128 as i8) as i8)...(127 as i8): i8) ({ } as ())"}]}