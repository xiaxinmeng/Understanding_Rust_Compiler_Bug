{"sha": "062019590d70279d82fef3a60a2caf9490f8b97b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA2MjAxOTU5MGQ3MDI3OWQ4MmZlZjNhNjBhMmNhZjk0OTBmOGI5N2I=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-10-15T18:25:54Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-10-15T18:25:54Z"}, "message": "Switch to the master of salsa", "tree": {"sha": "9519620f51adfe64716d3ec8f11ecf88bfad0839", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9519620f51adfe64716d3ec8f11ecf88bfad0839"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/062019590d70279d82fef3a60a2caf9490f8b97b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/062019590d70279d82fef3a60a2caf9490f8b97b", "html_url": "https://github.com/rust-lang/rust/commit/062019590d70279d82fef3a60a2caf9490f8b97b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/062019590d70279d82fef3a60a2caf9490f8b97b/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d783371b862c15d6d402d68e8edce4e37d63796c", "url": "https://api.github.com/repos/rust-lang/rust/commits/d783371b862c15d6d402d68e8edce4e37d63796c", "html_url": "https://github.com/rust-lang/rust/commit/d783371b862c15d6d402d68e8edce4e37d63796c"}], "stats": {"total": 23, "additions": 13, "deletions": 10}, "files": [{"sha": "c18ee2f44dd2aa059faa637d1e095a314ae632ed", "filename": "Cargo.lock", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/062019590d70279d82fef3a60a2caf9490f8b97b/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/062019590d70279d82fef3a60a2caf9490f8b97b/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=062019590d70279d82fef3a60a2caf9490f8b97b", "patch": "@@ -619,7 +619,8 @@ dependencies = [\n  \"ra_syntax 0.1.0\",\n  \"rayon 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"relative-path 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"salsa 0.4.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"rustc-hash 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"salsa 0.4.1 (git+https://github.com/salsa-rs/salsa?rev=20c9fbf)\",\n  \"test_utils 0.1.0\",\n ]\n \n@@ -845,13 +846,14 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n [[package]]\n name = \"salsa\"\n version = \"0.4.1\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+source = \"git+https://github.com/salsa-rs/salsa?rev=20c9fbf#20c9fbf45c0201e39cfeda4c939160ad1c35132c\"\n dependencies = [\n  \"derive-new 0.5.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"indexmap 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.4.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"parking_lot 0.6.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rustc-hash 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"smallvec 0.6.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1350,7 +1352,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum rustc_version 0.2.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"138e3e0acb6c9fb258b19b67cb8abd63c00679d2851805ea151465464fe9030a\"\n \"checksum ryu 0.2.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7153dd96dade874ab973e098cb62fcdbb89a03682e46b144fd09550998d4a4a7\"\n \"checksum safemem 0.3.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"8dca453248a96cb0749e36ccdfe2b0b4e54a61bfef89fb97ec621eb8e0a93dd9\"\n-\"checksum salsa 0.4.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b7a4bcb8e4e81d092709a98130025666d255c8821970dcb9347d05f928e3d505\"\n+\"checksum salsa 0.4.1 (git+https://github.com/salsa-rs/salsa?rev=20c9fbf)\" = \"<none>\"\n \"checksum same-file 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"10f7794e2fda7f594866840e95f5c5962e886e228e68b6505885811a94dd728c\"\n \"checksum scopeguard 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"94258f53601af11e6a49f722422f6e3425c52b06245a5cf9bc09908b174f5e27\"\n \"checksum semver 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"1d7eb9ef2c18661902cc47e535f9bc51b78acd254da71d375c2f6720d9a40403\""}, {"sha": "233f34e34b028ea515a07262ed687f9793c99fc3", "filename": "crates/ra_analysis/Cargo.toml", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/062019590d70279d82fef3a60a2caf9490f8b97b/crates%2Fra_analysis%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/062019590d70279d82fef3a60a2caf9490f8b97b/crates%2Fra_analysis%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_analysis%2FCargo.toml?ref=062019590d70279d82fef3a60a2caf9490f8b97b", "patch": "@@ -15,7 +15,8 @@ fst = \"0.3.1\"\n im = \"12.0.0\"\n ra_syntax = { path = \"../ra_syntax\" }\n ra_editor = { path = \"../ra_editor\" }\n-salsa = \"0.4.1\"\n+salsa = { git = \"https://github.com/salsa-rs/salsa\", rev = \"20c9fbf\" }\n+rustc-hash = \"1.0\"\n \n [dev-dependencies]\n test_utils = { path = \"../test_utils\" }"}, {"sha": "c84bfa7a887fda781651e92ebef8adbc2a7f4afe", "filename": "crates/ra_analysis/src/db/mod.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/062019590d70279d82fef3a60a2caf9490f8b97b/crates%2Fra_analysis%2Fsrc%2Fdb%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/062019590d70279d82fef3a60a2caf9490f8b97b/crates%2Fra_analysis%2Fsrc%2Fdb%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_analysis%2Fsrc%2Fdb%2Fmod.rs?ref=062019590d70279d82fef3a60a2caf9490f8b97b", "patch": "@@ -2,9 +2,9 @@ use std::{\n     fmt,\n     sync::Arc,\n     hash::{Hash, Hasher},\n-    collections::HashSet,\n };\n use salsa;\n+use rustc_hash::FxHashSet;\n use ra_syntax::File;\n use ra_editor::{LineIndex};\n use crate::{\n@@ -63,7 +63,7 @@ salsa::query_group! {\n \n #[derive(Default, Debug)]\n pub(crate) struct FileSet {\n-    pub(crate) files: HashSet<FileId>,\n+    pub(crate) files: FxHashSet<FileId>,\n     pub(crate) resolver: FileResolverImp,\n }\n "}, {"sha": "692a07ccd838ba618e76828712ea9f39a2d22a41", "filename": "crates/ra_analysis/src/roots.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/062019590d70279d82fef3a60a2caf9490f8b97b/crates%2Fra_analysis%2Fsrc%2Froots.rs", "raw_url": "https://github.com/rust-lang/rust/raw/062019590d70279d82fef3a60a2caf9490f8b97b/crates%2Fra_analysis%2Fsrc%2Froots.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_analysis%2Fsrc%2Froots.rs?ref=062019590d70279d82fef3a60a2caf9490f8b97b", "patch": "@@ -1,5 +1,4 @@\n use std::{\n-    collections::{HashMap, HashSet},\n     sync::Arc,\n     panic,\n };\n@@ -8,6 +7,7 @@ use parking_lot::RwLock;\n use once_cell::sync::OnceCell;\n use rayon::prelude::*;\n use salsa::Database;\n+use rustc_hash::{FxHashMap, FxHashSet};\n use ra_editor::LineIndex;\n use ra_syntax::File;\n \n@@ -40,8 +40,8 @@ impl WritableSourceRoot {\n         file_resolver: Option<FileResolverImp>,\n     ) -> WritableSourceRoot {\n         let db = self.db.write();\n-        let mut changed = HashSet::new();\n-        let mut removed = HashSet::new();\n+        let mut changed = FxHashSet::default();\n+        let mut removed = FxHashSet::default();\n         for (file_id, text) in changes {\n             match text {\n                 None => {\n@@ -55,7 +55,7 @@ impl WritableSourceRoot {\n             }\n         }\n         let file_set = db.file_set(());\n-        let mut files: HashSet<FileId> = file_set\n+        let mut files: FxHashSet<FileId> = file_set\n             .files\n             .clone();\n         for file_id in removed {"}]}