{"sha": "dac59ac93afa3ca13adc1bab5eaa9bd2445ee868", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRhYzU5YWM5M2FmYTNjYTEzYWRjMWJhYjVlYWE5YmQyNDQ1ZWU4Njg=", "commit": {"author": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2017-12-06T21:18:28Z"}, "committer": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2017-12-07T10:28:02Z"}, "message": "escape-argument-callee: improve comment per arielb1's suggestions", "tree": {"sha": "fc579d7d8a2d4b67730f02fdabc213ca9cdf7655", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fc579d7d8a2d4b67730f02fdabc213ca9cdf7655"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/dac59ac93afa3ca13adc1bab5eaa9bd2445ee868", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/dac59ac93afa3ca13adc1bab5eaa9bd2445ee868", "html_url": "https://github.com/rust-lang/rust/commit/dac59ac93afa3ca13adc1bab5eaa9bd2445ee868", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/dac59ac93afa3ca13adc1bab5eaa9bd2445ee868/comments", "author": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "05977fe751ae163625016bcf81a6c74c8b50a6de", "url": "https://api.github.com/repos/rust-lang/rust/commits/05977fe751ae163625016bcf81a6c74c8b50a6de", "html_url": "https://github.com/rust-lang/rust/commit/05977fe751ae163625016bcf81a6c74c8b50a6de"}], "stats": {"total": 41, "additions": 23, "deletions": 18}, "files": [{"sha": "1e34aaf1ea03003e92c37f0138ed0c030b7f1be9", "filename": "src/test/ui/nll/closure-requirements/escape-argument-callee.rs", "status": "modified", "additions": 10, "deletions": 5, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/dac59ac93afa3ca13adc1bab5eaa9bd2445ee868/src%2Ftest%2Fui%2Fnll%2Fclosure-requirements%2Fescape-argument-callee.rs", "raw_url": "https://github.com/rust-lang/rust/raw/dac59ac93afa3ca13adc1bab5eaa9bd2445ee868/src%2Ftest%2Fui%2Fnll%2Fclosure-requirements%2Fescape-argument-callee.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnll%2Fclosure-requirements%2Fescape-argument-callee.rs?ref=dac59ac93afa3ca13adc1bab5eaa9bd2445ee868", "patch": "@@ -10,12 +10,17 @@\n \n // Test closure that:\n //\n-// - takes an argument `y`\n-// - stores `y` into another, longer-lived spot\n+// - takes an argument `y` with lifetime `'a` (in the code, it's anonymous)\n+// - stores `y` into another, longer-lived spot with lifetime `'b`\n //\n-// *but* the signature of the closure doesn't indicate that `y` lives\n-// long enough for that. The closure reports the error (and hence we\n-// see it before the closure's \"external requirements\" report).\n+// Because `'a` and `'b` are two different, unrelated higher-ranked\n+// regions with no relationship to one another, this is an error. This\n+// error is reported by the closure itself and is not propagated to\n+// its creator: this is because `'a` and `'b` are higher-ranked\n+// (late-bound) regions and the closure is not allowed to propagate\n+// additional where clauses between higher-ranked regions, only those\n+// that appear free in its type (hence, we see it before the closure's\n+// \"external requirements\" report).\n \n // compile-flags:-Znll -Zborrowck=mir -Zverbose\n "}, {"sha": "c842d51a2ad749554a4a1864ad258c2887051ef0", "filename": "src/test/ui/nll/closure-requirements/escape-argument-callee.stderr", "status": "modified", "additions": 13, "deletions": 13, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/dac59ac93afa3ca13adc1bab5eaa9bd2445ee868/src%2Ftest%2Fui%2Fnll%2Fclosure-requirements%2Fescape-argument-callee.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/dac59ac93afa3ca13adc1bab5eaa9bd2445ee868/src%2Ftest%2Fui%2Fnll%2Fclosure-requirements%2Fescape-argument-callee.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnll%2Fclosure-requirements%2Fescape-argument-callee.stderr?ref=dac59ac93afa3ca13adc1bab5eaa9bd2445ee868", "patch": "@@ -1,19 +1,19 @@\n warning: not reporting region error due to -Znll\n-  --> $DIR/escape-argument-callee.rs:31:50\n+  --> $DIR/escape-argument-callee.rs:36:50\n    |\n-31 |         let mut closure = expect_sig(|p, y| *p = y);\n+36 |         let mut closure = expect_sig(|p, y| *p = y);\n    |                                                  ^\n \n error: free region `'_#4r` does not outlive free region `'_#3r`\n-  --> $DIR/escape-argument-callee.rs:31:45\n+  --> $DIR/escape-argument-callee.rs:36:45\n    |\n-31 |         let mut closure = expect_sig(|p, y| *p = y);\n+36 |         let mut closure = expect_sig(|p, y| *p = y);\n    |                                             ^^^^^^\n \n note: External requirements\n-  --> $DIR/escape-argument-callee.rs:31:38\n+  --> $DIR/escape-argument-callee.rs:36:38\n    |\n-31 |         let mut closure = expect_sig(|p, y| *p = y);\n+36 |         let mut closure = expect_sig(|p, y| *p = y);\n    |                                      ^^^^^^^^^^^^^\n    |\n    = note: defining type: DefId(0/1:9 ~ escape_argument_callee[317d]::test[0]::{{closure}}[0]) with closure substs [\n@@ -23,15 +23,15 @@ note: External requirements\n    = note: number of external vids: 1\n \n note: No external requirements\n-  --> $DIR/escape-argument-callee.rs:25:1\n+  --> $DIR/escape-argument-callee.rs:30:1\n    |\n-25 | / fn test() {\n-26 | |     let x = 44;\n-27 | |     let mut p = &x;\n-28 | |\n+30 | / fn test() {\n+31 | |     let x = 44;\n+32 | |     let mut p = &x;\n+33 | |\n ...  |\n-37 | |     deref(p);\n-38 | | }\n+42 | |     deref(p);\n+43 | | }\n    | |_^\n    |\n    = note: defining type: DefId(0/0:3 ~ escape_argument_callee[317d]::test[0]) with substs []"}]}