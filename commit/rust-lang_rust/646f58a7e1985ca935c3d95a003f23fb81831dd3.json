{"sha": "646f58a7e1985ca935c3d95a003f23fb81831dd3", "node_id": "C_kwDOAAsO6NoAKDY0NmY1OGE3ZTE5ODVjYTkzNWMzZDk1YTAwM2YyM2ZiODE4MzFkZDM", "commit": {"author": {"name": "Camille GILLOT", "email": "gillot.camille@gmail.com", "date": "2021-07-10T08:00:54Z"}, "committer": {"name": "Camille GILLOT", "email": "gillot.camille@gmail.com", "date": "2021-12-04T22:13:58Z"}, "message": "Lint bare traits in AstConv.", "tree": {"sha": "654e3c43ad941d71481b598e73faf3583af56c50", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/654e3c43ad941d71481b598e73faf3583af56c50"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/646f58a7e1985ca935c3d95a003f23fb81831dd3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/646f58a7e1985ca935c3d95a003f23fb81831dd3", "html_url": "https://github.com/rust-lang/rust/commit/646f58a7e1985ca935c3d95a003f23fb81831dd3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/646f58a7e1985ca935c3d95a003f23fb81831dd3/comments", "author": {"login": "cjgillot", "id": 1822483, "node_id": "MDQ6VXNlcjE4MjI0ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1822483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjgillot", "html_url": "https://github.com/cjgillot", "followers_url": "https://api.github.com/users/cjgillot/followers", "following_url": "https://api.github.com/users/cjgillot/following{/other_user}", "gists_url": "https://api.github.com/users/cjgillot/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjgillot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjgillot/subscriptions", "organizations_url": "https://api.github.com/users/cjgillot/orgs", "repos_url": "https://api.github.com/users/cjgillot/repos", "events_url": "https://api.github.com/users/cjgillot/events{/privacy}", "received_events_url": "https://api.github.com/users/cjgillot/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cjgillot", "id": 1822483, "node_id": "MDQ6VXNlcjE4MjI0ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1822483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjgillot", "html_url": "https://github.com/cjgillot", "followers_url": "https://api.github.com/users/cjgillot/followers", "following_url": "https://api.github.com/users/cjgillot/following{/other_user}", "gists_url": "https://api.github.com/users/cjgillot/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjgillot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjgillot/subscriptions", "organizations_url": "https://api.github.com/users/cjgillot/orgs", "repos_url": "https://api.github.com/users/cjgillot/repos", "events_url": "https://api.github.com/users/cjgillot/events{/privacy}", "received_events_url": "https://api.github.com/users/cjgillot/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "887999d163bace7e79370b952bdd1f930ff4cdd5", "url": "https://api.github.com/repos/rust-lang/rust/commits/887999d163bace7e79370b952bdd1f930ff4cdd5", "html_url": "https://github.com/rust-lang/rust/commit/887999d163bace7e79370b952bdd1f930ff4cdd5"}], "stats": {"total": 663, "additions": 366, "deletions": 297}, "files": [{"sha": "8c6d2eac51e5a3fee0041b4762233d0c1d358970", "filename": "compiler/rustc_ast_lowering/src/lib.rs", "status": "modified", "additions": 3, "deletions": 45, "changes": 48, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -47,7 +47,7 @@ use rustc_data_structures::fx::FxHashSet;\n use rustc_data_structures::sorted_map::SortedMap;\n use rustc_data_structures::stable_hasher::{HashStable, StableHasher};\n use rustc_data_structures::sync::Lrc;\n-use rustc_errors::{struct_span_err, Applicability};\n+use rustc_errors::struct_span_err;\n use rustc_hir as hir;\n use rustc_hir::def::{DefKind, Namespace, PartialRes, PerNS, Res};\n use rustc_hir::def_id::{DefId, DefPathHash, LocalDefId, CRATE_DEF_ID};\n@@ -56,11 +56,9 @@ use rustc_hir::intravisit;\n use rustc_hir::{ConstArg, GenericArg, InferKind, ParamName};\n use rustc_index::vec::{Idx, IndexVec};\n use rustc_query_system::ich::StableHashingContext;\n-use rustc_session::lint::builtin::BARE_TRAIT_OBJECTS;\n-use rustc_session::lint::{BuiltinLintDiagnostics, LintBuffer};\n+use rustc_session::lint::LintBuffer;\n use rustc_session::utils::{FlattenNonterminals, NtToTokenstream};\n use rustc_session::Session;\n-use rustc_span::edition::Edition;\n use rustc_span::hygiene::ExpnId;\n use rustc_span::source_map::{respan, DesugaringKind};\n use rustc_span::symbol::{kw, sym, Ident, Symbol};\n@@ -1190,11 +1188,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n     ) -> hir::Ty<'hir> {\n         let id = self.lower_node_id(t.id);\n         let qpath = self.lower_qpath(t.id, qself, path, param_mode, itctx);\n-        let ty = self.ty_path(id, t.span, qpath);\n-        if let hir::TyKind::TraitObject(..) = ty.kind {\n-            self.maybe_lint_bare_trait(t.span, t.id, qself.is_none() && path.is_global());\n-        }\n-        ty\n+        self.ty_path(id, t.span, qpath)\n     }\n \n     fn ty(&mut self, span: Span, kind: hir::TyKind<'hir>) -> hir::Ty<'hir> {\n@@ -1291,9 +1285,6 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                         lifetime_bound.unwrap_or_else(|| this.elided_dyn_bound(t.span));\n                     (bounds, lifetime_bound)\n                 });\n-                if kind != TraitObjectSyntax::Dyn {\n-                    self.maybe_lint_bare_trait(t.span, t.id, false);\n-                }\n                 hir::TyKind::TraitObject(bounds, lifetime_bound, kind)\n             }\n             TyKind::ImplTrait(def_node_id, ref bounds) => {\n@@ -2395,39 +2386,6 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n             name: hir::LifetimeName::Implicit(missing),\n         }\n     }\n-\n-    fn maybe_lint_bare_trait(&mut self, span: Span, id: NodeId, is_global: bool) {\n-        // FIXME(davidtwco): This is a hack to detect macros which produce spans of the\n-        // call site which do not have a macro backtrace. See #61963.\n-        let is_macro_callsite = self\n-            .sess\n-            .source_map()\n-            .span_to_snippet(span)\n-            .map(|snippet| snippet.starts_with(\"#[\"))\n-            .unwrap_or(true);\n-        if !is_macro_callsite {\n-            if span.edition() < Edition::Edition2021 {\n-                self.resolver.lint_buffer().buffer_lint_with_diagnostic(\n-                    BARE_TRAIT_OBJECTS,\n-                    id,\n-                    span,\n-                    \"trait objects without an explicit `dyn` are deprecated\",\n-                    BuiltinLintDiagnostics::BareTraitObject(span, is_global),\n-                )\n-            } else {\n-                let msg = \"trait objects must include the `dyn` keyword\";\n-                let label = \"add `dyn` keyword before this trait\";\n-                let mut err = struct_span_err!(self.sess, span, E0782, \"{}\", msg,);\n-                err.span_suggestion_verbose(\n-                    span.shrink_to_lo(),\n-                    label,\n-                    String::from(\"dyn \"),\n-                    Applicability::MachineApplicable,\n-                );\n-                err.emit();\n-            }\n-        }\n-    }\n }\n \n /// Helper struct for delayed construction of GenericArgs."}, {"sha": "d434549ed8587c50aa3d4ca1e7680274aa644c76", "filename": "compiler/rustc_lint/src/context.rs", "status": "modified", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/compiler%2Frustc_lint%2Fsrc%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/compiler%2Frustc_lint%2Fsrc%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Fcontext.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -635,16 +635,6 @@ pub trait LintContext: Sized {\n                     }\n                 },\n                 BuiltinLintDiagnostics::Normal => (),\n-                BuiltinLintDiagnostics::BareTraitObject(span, is_global) => {\n-                    let (sugg, app) = match sess.source_map().span_to_snippet(span) {\n-                        Ok(s) if is_global => {\n-                            (format!(\"dyn ({})\", s), Applicability::MachineApplicable)\n-                        }\n-                        Ok(s) => (format!(\"dyn {}\", s), Applicability::MachineApplicable),\n-                        Err(_) => (\"dyn <type>\".to_string(), Applicability::HasPlaceholders),\n-                    };\n-                    db.span_suggestion(span, \"use `dyn`\", sugg, app);\n-                }\n                 BuiltinLintDiagnostics::AbsPathWithModule(span) => {\n                     let (sugg, app) = match sess.source_map().span_to_snippet(span) {\n                         Ok(ref s) => {"}, {"sha": "efc0cecb8244c6f35b96d93d1fdba6d6556699f2", "filename": "compiler/rustc_lint_defs/src/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/compiler%2Frustc_lint_defs%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/compiler%2Frustc_lint_defs%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint_defs%2Fsrc%2Flib.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -285,7 +285,6 @@ pub enum ExternDepSpec {\n #[derive(PartialEq, Debug)]\n pub enum BuiltinLintDiagnostics {\n     Normal,\n-    BareTraitObject(Span, /* is_global */ bool),\n     AbsPathWithModule(Span),\n     ProcMacroDeriveResolutionFallback(Span),\n     MacroExpandedMacroExportsAccessedByAbsolutePaths(Span),"}, {"sha": "bc271fac68fd63d83127a920685d8d692c15df87", "filename": "compiler/rustc_typeck/src/astconv/mod.rs", "status": "modified", "additions": 59, "deletions": 5, "changes": 64, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fmod.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -13,6 +13,7 @@ use crate::errors::{\n };\n use crate::middle::resolve_lifetime as rl;\n use crate::require_c_abi_if_c_variadic;\n+use rustc_ast::TraitObjectSyntax;\n use rustc_data_structures::fx::{FxHashMap, FxHashSet};\n use rustc_errors::{struct_span_err, Applicability, ErrorReported, FatalError};\n use rustc_hir as hir;\n@@ -24,7 +25,8 @@ use rustc_hir::{GenericArg, GenericArgs};\n use rustc_middle::ty::subst::{self, GenericArgKind, InternalSubsts, Subst, SubstsRef};\n use rustc_middle::ty::GenericParamDefKind;\n use rustc_middle::ty::{self, Const, DefIdTree, Ty, TyCtxt, TypeFoldable};\n-use rustc_session::lint::builtin::AMBIGUOUS_ASSOCIATED_ITEMS;\n+use rustc_session::lint::builtin::{AMBIGUOUS_ASSOCIATED_ITEMS, BARE_TRAIT_OBJECTS};\n+use rustc_span::edition::Edition;\n use rustc_span::lev_distance::find_best_match_for_name;\n use rustc_span::symbol::{Ident, Symbol};\n use rustc_span::{Span, DUMMY_SP};\n@@ -2289,13 +2291,19 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n     /// Parses the programmer's textual representation of a type into our\n     /// internal notion of a type.\n     pub fn ast_ty_to_ty(&self, ast_ty: &hir::Ty<'_>) -> Ty<'tcx> {\n-        self.ast_ty_to_ty_inner(ast_ty, false)\n+        self.ast_ty_to_ty_inner(ast_ty, false, false)\n+    }\n+\n+    /// Parses the programmer's textual representation of a type into our\n+    /// internal notion of a type.  This is meant to be used within a path.\n+    pub fn ast_ty_to_ty_in_path(&self, ast_ty: &hir::Ty<'_>) -> Ty<'tcx> {\n+        self.ast_ty_to_ty_inner(ast_ty, false, true)\n     }\n \n     /// Turns a `hir::Ty` into a `Ty`. For diagnostics' purposes we keep track of whether trait\n     /// objects are borrowed like `&dyn Trait` to avoid emitting redundant errors.\n     #[tracing::instrument(level = \"debug\", skip(self))]\n-    fn ast_ty_to_ty_inner(&self, ast_ty: &hir::Ty<'_>, borrowed: bool) -> Ty<'tcx> {\n+    fn ast_ty_to_ty_inner(&self, ast_ty: &hir::Ty<'_>, borrowed: bool, in_path: bool) -> Ty<'tcx> {\n         let tcx = self.tcx();\n \n         let result_ty = match ast_ty.kind {\n@@ -2306,7 +2314,7 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n             hir::TyKind::Rptr(ref region, ref mt) => {\n                 let r = self.ast_region_to_region(region, None);\n                 debug!(?r);\n-                let t = self.ast_ty_to_ty_inner(mt.ty, true);\n+                let t = self.ast_ty_to_ty_inner(mt.ty, true, false);\n                 tcx.mk_ref(r, ty::TypeAndMut { ty: t, mutbl: mt.mutbl })\n             }\n             hir::TyKind::Never => tcx.types.never,\n@@ -2325,6 +2333,7 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n                 ))\n             }\n             hir::TyKind::TraitObject(bounds, ref lifetime, _) => {\n+                self.maybe_lint_bare_trait(ast_ty, in_path);\n                 self.conv_object_ty_poly_trait_ref(ast_ty.span, bounds, lifetime, borrowed)\n             }\n             hir::TyKind::Path(hir::QPath::Resolved(ref maybe_qself, ref path)) => {\n@@ -2345,7 +2354,7 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n             }\n             hir::TyKind::Path(hir::QPath::TypeRelative(ref qself, ref segment)) => {\n                 debug!(?qself, ?segment);\n-                let ty = self.ast_ty_to_ty(qself);\n+                let ty = self.ast_ty_to_ty_inner(qself, false, true);\n \n                 let res = if let hir::TyKind::Path(hir::QPath::Resolved(_, path)) = qself.kind {\n                     path.res\n@@ -2602,4 +2611,49 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n         }\n         Some(r)\n     }\n+\n+    fn maybe_lint_bare_trait(&self, self_ty: &hir::Ty<'_>, in_path: bool) {\n+        let tcx = self.tcx();\n+        if let hir::TyKind::TraitObject([poly_trait_ref, ..], _, TraitObjectSyntax::None) =\n+            self_ty.kind\n+        {\n+            let (mut sugg, app) = match tcx.sess.source_map().span_to_snippet(self_ty.span) {\n+                Ok(s) if poly_trait_ref.trait_ref.path.is_global() => {\n+                    (format!(\"dyn ({})\", s), Applicability::MachineApplicable)\n+                }\n+                Ok(s) => (format!(\"dyn {}\", s), Applicability::MachineApplicable),\n+                Err(_) => (\"dyn <type>\".to_string(), Applicability::HasPlaceholders),\n+            };\n+            if in_path {\n+                let has_bracket = tcx\n+                    .sess\n+                    .source_map()\n+                    .span_to_prev_source(self_ty.span)\n+                    .ok()\n+                    .map_or(false, |s| s.trim_end().ends_with('<'));\n+                if !has_bracket {\n+                    sugg = format!(\"<{}>\", sugg);\n+                }\n+            }\n+            if tcx.sess.edition() >= Edition::Edition2021 {\n+                let msg = \"trait objects must include the `dyn` keyword\";\n+                let label = \"add `dyn` keyword before this trait\";\n+                let mut err =\n+                    rustc_errors::struct_span_err!(tcx.sess, self_ty.span, E0782, \"{}\", msg);\n+                err.span_suggestion_verbose(self_ty.span, label, sugg, app).emit();\n+            } else {\n+                let msg = \"trait objects without an explicit `dyn` are deprecated\";\n+                tcx.struct_span_lint_hir(\n+                    BARE_TRAIT_OBJECTS,\n+                    self_ty.hir_id,\n+                    self_ty.span,\n+                    |lint| {\n+                        let mut db = lint.build(msg);\n+                        db.span_suggestion(self_ty.span, \"use `dyn`\", sugg, app);\n+                        db.emit()\n+                    },\n+                );\n+            }\n+        }\n+    }\n }"}, {"sha": "66546b36aa1cc48df6b07927c89acbef0cd5c482", "filename": "compiler/rustc_typeck/src/check/fn_ctxt/_impl.rs", "status": "modified", "additions": 2, "deletions": 56, "changes": 58, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Ffn_ctxt%2F_impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Ffn_ctxt%2F_impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Ffn_ctxt%2F_impl.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -6,15 +6,14 @@ use crate::check::callee::{self, DeferredCallResolution};\n use crate::check::method::{self, MethodCallee, SelfSource};\n use crate::check::{BreakableCtxt, Diverges, Expectation, FnCtxt, LocalTy};\n \n-use rustc_ast::TraitObjectSyntax;\n use rustc_data_structures::captures::Captures;\n use rustc_data_structures::fx::FxHashSet;\n use rustc_errors::{Applicability, DiagnosticBuilder, ErrorReported};\n use rustc_hir as hir;\n use rustc_hir::def::{CtorOf, DefKind, Res};\n use rustc_hir::def_id::DefId;\n use rustc_hir::lang_items::LangItem;\n-use rustc_hir::{ExprKind, GenericArg, Node, QPath, TyKind};\n+use rustc_hir::{ExprKind, GenericArg, Node, QPath};\n use rustc_infer::infer::canonical::{Canonical, OriginalQueryValues, QueryResponse};\n use rustc_infer::infer::error_reporting::TypeAnnotationNeeded::E0282;\n use rustc_infer::infer::{InferOk, InferResult};\n@@ -28,8 +27,6 @@ use rustc_middle::ty::{\n     Ty, UserType,\n };\n use rustc_session::lint;\n-use rustc_session::lint::builtin::BARE_TRAIT_OBJECTS;\n-use rustc_span::edition::Edition;\n use rustc_span::hygiene::DesugaringKind;\n use rustc_span::source_map::{original_sp, DUMMY_SP};\n use rustc_span::symbol::{kw, sym, Ident};\n@@ -844,7 +841,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                 // to be object-safe.\n                 // We manually call `register_wf_obligation` in the success path\n                 // below.\n-                (<dyn AstConv<'_>>::ast_ty_to_ty(self, qself), qself, segment)\n+                (<dyn AstConv<'_>>::ast_ty_to_ty_in_path(self, qself), qself, segment)\n             }\n             QPath::LangItem(..) => {\n                 bug!(\"`resolve_ty_and_res_fully_qualified_call` called on `LangItem`\")\n@@ -890,7 +887,6 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n             });\n \n         if result.is_ok() {\n-            self.maybe_lint_bare_trait(qpath, hir_id, span);\n             self.register_wf_obligation(ty.into(), qself.span, traits::WellFormed(None));\n         }\n \n@@ -903,56 +899,6 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         )\n     }\n \n-    fn maybe_lint_bare_trait(&self, qpath: &QPath<'_>, hir_id: hir::HirId, span: Span) {\n-        if let QPath::TypeRelative(self_ty, _) = qpath {\n-            if let TyKind::TraitObject([poly_trait_ref, ..], _, TraitObjectSyntax::None) =\n-                self_ty.kind\n-            {\n-                let msg = \"trait objects without an explicit `dyn` are deprecated\";\n-                let (sugg, app) = match self.tcx.sess.source_map().span_to_snippet(self_ty.span) {\n-                    Ok(s) if poly_trait_ref.trait_ref.path.is_global() => {\n-                        (format!(\"dyn ({})\", s), Applicability::MachineApplicable)\n-                    }\n-                    Ok(s) => (format!(\"dyn {}\", s), Applicability::MachineApplicable),\n-                    Err(_) => (\"dyn <type>\".to_string(), Applicability::HasPlaceholders),\n-                };\n-                // Wrap in `<..>` if it isn't already.\n-                let sugg = match self.tcx.sess.source_map().span_to_snippet(span) {\n-                    Ok(s) if s.starts_with('<') => sugg,\n-                    _ => format!(\"<{}>\", sugg),\n-                };\n-                let sugg_label = \"use `dyn`\";\n-                if self.sess().edition() >= Edition::Edition2021 {\n-                    let mut err = rustc_errors::struct_span_err!(\n-                        self.sess(),\n-                        self_ty.span,\n-                        E0782,\n-                        \"{}\",\n-                        msg,\n-                    );\n-                    err.span_suggestion(\n-                        self_ty.span,\n-                        sugg_label,\n-                        sugg,\n-                        Applicability::MachineApplicable,\n-                    )\n-                    .emit();\n-                } else {\n-                    self.tcx.struct_span_lint_hir(\n-                        BARE_TRAIT_OBJECTS,\n-                        hir_id,\n-                        self_ty.span,\n-                        |lint| {\n-                            let mut db = lint.build(msg);\n-                            db.span_suggestion(self_ty.span, sugg_label, sugg, app);\n-                            db.emit()\n-                        },\n-                    );\n-                }\n-            }\n-        }\n-    }\n-\n     /// Given a function `Node`, return its `FnDecl` if it exists, or `None` otherwise.\n     pub(in super::super) fn get_node_fn_decl(\n         &self,"}, {"sha": "e12e07a28e76363b03b0c796205582a56b0bf404", "filename": "src/test/ui/const-generics/min_const_generics/const-expression-suggest-missing-braces.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fconst-generics%2Fmin_const_generics%2Fconst-expression-suggest-missing-braces.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fconst-generics%2Fmin_const_generics%2Fconst-expression-suggest-missing-braces.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fmin_const_generics%2Fconst-expression-suggest-missing-braces.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -12,8 +12,6 @@ fn b() {\n     //~^ ERROR expected trait, found constant `BAR`\n     //~| ERROR expected trait, found constant `BAR`\n     //~| ERROR type provided when a constant was expected\n-    //~| WARN trait objects without an explicit `dyn` are deprecated\n-    //~| WARN this is accepted in the current edition\n }\n fn c() {\n     foo::<3 + 3>(); //~ ERROR expressions must be enclosed in braces"}, {"sha": "d9bcc523b1fc46c454caf69567598dba6e0d3671", "filename": "src/test/ui/const-generics/min_const_generics/const-expression-suggest-missing-braces.stderr", "status": "modified", "additions": 11, "deletions": 21, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fconst-generics%2Fmin_const_generics%2Fconst-expression-suggest-missing-braces.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fconst-generics%2Fmin_const_generics%2Fconst-expression-suggest-missing-braces.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fmin_const_generics%2Fconst-expression-suggest-missing-braces.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -10,7 +10,7 @@ LL |     foo::<{ BAR + 3 }>();\n    |           +         +\n \n error: expressions must be enclosed in braces to be used as const generic arguments\n-  --> $DIR/const-expression-suggest-missing-braces.rs:19:11\n+  --> $DIR/const-expression-suggest-missing-braces.rs:17:11\n    |\n LL |     foo::<3 + 3>();\n    |           ^^^^^\n@@ -21,7 +21,7 @@ LL |     foo::<{ 3 + 3 }>();\n    |           +       +\n \n error: expected one of `,` or `>`, found `-`\n-  --> $DIR/const-expression-suggest-missing-braces.rs:22:15\n+  --> $DIR/const-expression-suggest-missing-braces.rs:20:15\n    |\n LL |     foo::<BAR - 3>();\n    |               ^ expected one of `,` or `>`\n@@ -32,7 +32,7 @@ LL |     foo::<{ BAR - 3 }>();\n    |           +         +\n \n error: expected one of `,` or `>`, found `-`\n-  --> $DIR/const-expression-suggest-missing-braces.rs:25:15\n+  --> $DIR/const-expression-suggest-missing-braces.rs:23:15\n    |\n LL |     foo::<BAR - BAR>();\n    |               ^ expected one of `,` or `>`\n@@ -43,7 +43,7 @@ LL |     foo::<{ BAR - BAR }>();\n    |           +           +\n \n error: expressions must be enclosed in braces to be used as const generic arguments\n-  --> $DIR/const-expression-suggest-missing-braces.rs:28:11\n+  --> $DIR/const-expression-suggest-missing-braces.rs:26:11\n    |\n LL |     foo::<100 - BAR>();\n    |           ^^^^^^^^^\n@@ -54,7 +54,7 @@ LL |     foo::<{ 100 - BAR }>();\n    |           +           +\n \n error: expected one of `,` or `>`, found `(`\n-  --> $DIR/const-expression-suggest-missing-braces.rs:31:19\n+  --> $DIR/const-expression-suggest-missing-braces.rs:29:19\n    |\n LL |     foo::<bar<i32>()>();\n    |                   ^ expected one of `,` or `>`\n@@ -65,7 +65,7 @@ LL |     foo::<{ bar<i32>() }>();\n    |           +            +\n \n error: expected one of `,` or `>`, found `(`\n-  --> $DIR/const-expression-suggest-missing-braces.rs:34:21\n+  --> $DIR/const-expression-suggest-missing-braces.rs:32:21\n    |\n LL |     foo::<bar::<i32>()>();\n    |                     ^ expected one of `,` or `>`\n@@ -76,7 +76,7 @@ LL |     foo::<{ bar::<i32>() }>();\n    |           +              +\n \n error: expected one of `,` or `>`, found `(`\n-  --> $DIR/const-expression-suggest-missing-braces.rs:37:21\n+  --> $DIR/const-expression-suggest-missing-braces.rs:35:21\n    |\n LL |     foo::<bar::<i32>() + BAR>();\n    |                     ^ expected one of `,` or `>`\n@@ -87,7 +87,7 @@ LL |     foo::<{ bar::<i32>() + BAR }>();\n    |           +                    +\n \n error: expected one of `,` or `>`, found `(`\n-  --> $DIR/const-expression-suggest-missing-braces.rs:40:21\n+  --> $DIR/const-expression-suggest-missing-braces.rs:38:21\n    |\n LL |     foo::<bar::<i32>() - BAR>();\n    |                     ^ expected one of `,` or `>`\n@@ -98,7 +98,7 @@ LL |     foo::<{ bar::<i32>() - BAR }>();\n    |           +                    +\n \n error: expected one of `,` or `>`, found `-`\n-  --> $DIR/const-expression-suggest-missing-braces.rs:43:15\n+  --> $DIR/const-expression-suggest-missing-braces.rs:41:15\n    |\n LL |     foo::<BAR - bar::<i32>()>();\n    |               ^ expected one of `,` or `>`\n@@ -109,7 +109,7 @@ LL |     foo::<{ BAR - bar::<i32>() }>();\n    |           +                    +\n \n error: expected one of `,` or `>`, found `-`\n-  --> $DIR/const-expression-suggest-missing-braces.rs:46:15\n+  --> $DIR/const-expression-suggest-missing-braces.rs:44:15\n    |\n LL |     foo::<BAR - bar::<i32>()>();\n    |               ^ expected one of `,` or `>`\n@@ -131,23 +131,13 @@ error[E0404]: expected trait, found constant `BAR`\n LL |     foo::<BAR + BAR>();\n    |                 ^^^ not a trait\n \n-warning: trait objects without an explicit `dyn` are deprecated\n-  --> $DIR/const-expression-suggest-missing-braces.rs:11:11\n-   |\n-LL |     foo::<BAR + BAR>();\n-   |           ^^^^^^^^^ help: use `dyn`: `dyn BAR + BAR`\n-   |\n-   = note: `#[warn(bare_trait_objects)]` on by default\n-   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n-   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n-\n error[E0747]: type provided when a constant was expected\n   --> $DIR/const-expression-suggest-missing-braces.rs:11:11\n    |\n LL |     foo::<BAR + BAR>();\n    |           ^^^^^^^^^\n \n-error: aborting due to 14 previous errors; 1 warning emitted\n+error: aborting due to 14 previous errors\n \n Some errors have detailed explanations: E0404, E0747.\n For more information about an error, try `rustc --explain E0404`."}, {"sha": "609a5b0de6b7e2c3ca7e374f5fd338b5e290672c", "filename": "src/test/ui/did_you_mean/bad-assoc-ty.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdid_you_mean%2Fbad-assoc-ty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdid_you_mean%2Fbad-assoc-ty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdid_you_mean%2Fbad-assoc-ty.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -32,6 +32,8 @@ type G = dyn 'static + (Send)::AssocTy;\n // Recovery should not apply in this context.\n type H = Fn(u8) -> (u8)::Output;\n //~^ ERROR ambiguous associated type\n+//~| WARN trait objects without an explicit `dyn` are deprecated\n+//~| WARN this is accepted in the current edition\n \n macro_rules! ty {\n     ($ty: ty) => ($ty::AssocTy);"}, {"sha": "0d37220bc828d7238a3842eaffc9f372b3cb03a4", "filename": "src/test/ui/did_you_mean/bad-assoc-ty.stderr", "status": "modified", "additions": 24, "deletions": 14, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdid_you_mean%2Fbad-assoc-ty.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdid_you_mean%2Fbad-assoc-ty.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdid_you_mean%2Fbad-assoc-ty.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -41,13 +41,13 @@ LL | type G = dyn 'static + (Send)::AssocTy;\n    |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `<dyn 'static + (Send)>::AssocTy`\n \n error: missing angle brackets in associated item path\n-  --> $DIR/bad-assoc-ty.rs:44:10\n+  --> $DIR/bad-assoc-ty.rs:46:10\n    |\n LL | type I = ty!()::AssocTy;\n    |          ^^^^^^^^^^^^^^ help: try: `<ty!()>::AssocTy`\n \n error: missing angle brackets in associated item path\n-  --> $DIR/bad-assoc-ty.rs:37:19\n+  --> $DIR/bad-assoc-ty.rs:39:19\n    |\n LL |     ($ty: ty) => ($ty::AssocTy);\n    |                   ^^^^^^^^^^^^ help: try: `<$ty>::AssocTy`\n@@ -99,14 +99,24 @@ error[E0223]: ambiguous associated type\n LL | type G = dyn 'static + (Send)::AssocTy;\n    |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use fully-qualified syntax: `<(dyn Send + 'static) as Trait>::AssocTy`\n \n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/bad-assoc-ty.rs:33:10\n+   |\n+LL | type H = Fn(u8) -> (u8)::Output;\n+   |          ^^^^^^ help: use `dyn`: `<dyn Fn(u8)>`\n+   |\n+   = note: `#[warn(bare_trait_objects)]` on by default\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n error[E0223]: ambiguous associated type\n   --> $DIR/bad-assoc-ty.rs:33:10\n    |\n LL | type H = Fn(u8) -> (u8)::Output;\n    |          ^^^^^^^^^^^^^^^^^^^^^^ help: use fully-qualified syntax: `<(dyn Fn(u8) -> u8 + 'static) as Trait>::Output`\n \n error[E0223]: ambiguous associated type\n-  --> $DIR/bad-assoc-ty.rs:37:19\n+  --> $DIR/bad-assoc-ty.rs:39:19\n    |\n LL |     ($ty: ty) => ($ty::AssocTy);\n    |                   ^^^^^^^^^^^^ help: use fully-qualified syntax: `<u8 as Trait>::AssocTy`\n@@ -117,13 +127,13 @@ LL | type J = ty!(u8);\n    = note: this error originates in the macro `ty` (in Nightly builds, run with -Z macro-backtrace for more info)\n \n error[E0223]: ambiguous associated type\n-  --> $DIR/bad-assoc-ty.rs:44:10\n+  --> $DIR/bad-assoc-ty.rs:46:10\n    |\n LL | type I = ty!()::AssocTy;\n    |          ^^^^^^^^^^^^^^ help: use fully-qualified syntax: `<u8 as Trait>::AssocTy`\n \n error[E0121]: the type placeholder `_` is not allowed within types on item signatures for functions\n-  --> $DIR/bad-assoc-ty.rs:49:13\n+  --> $DIR/bad-assoc-ty.rs:51:13\n    |\n LL | fn foo<X: K<_, _>>(x: X) {}\n    |             ^  ^ not allowed in type signatures\n@@ -136,7 +146,7 @@ LL | fn foo<X: K<T, T>, T>(x: X) {}\n    |             ~  ~ +++\n \n error[E0121]: the type placeholder `_` is not allowed within types on item signatures for functions\n-  --> $DIR/bad-assoc-ty.rs:52:34\n+  --> $DIR/bad-assoc-ty.rs:54:34\n    |\n LL | fn bar<F>(_: F) where F: Fn() -> _ {}\n    |                                  ^ not allowed in type signatures\n@@ -147,7 +157,7 @@ LL | fn bar<F, T>(_: F) where F: Fn() -> T {}\n    |         +++                         ~\n \n error[E0121]: the type placeholder `_` is not allowed within types on item signatures for functions\n-  --> $DIR/bad-assoc-ty.rs:55:19\n+  --> $DIR/bad-assoc-ty.rs:57:19\n    |\n LL | fn baz<F: Fn() -> _>(_: F) {}\n    |                   ^ not allowed in type signatures\n@@ -158,7 +168,7 @@ LL | fn baz<F: Fn() -> T, T>(_: F) {}\n    |                   ~+++\n \n error[E0121]: the type placeholder `_` is not allowed within types on item signatures for structs\n-  --> $DIR/bad-assoc-ty.rs:58:33\n+  --> $DIR/bad-assoc-ty.rs:60:33\n    |\n LL | struct L<F>(F) where F: Fn() -> _;\n    |                                 ^ not allowed in type signatures\n@@ -169,7 +179,7 @@ LL | struct L<F, T>(F) where F: Fn() -> T;\n    |           +++                      ~\n \n error[E0121]: the type placeholder `_` is not allowed within types on item signatures for structs\n-  --> $DIR/bad-assoc-ty.rs:60:30\n+  --> $DIR/bad-assoc-ty.rs:62:30\n    |\n LL | struct M<F> where F: Fn() -> _ {\n    |                              ^ not allowed in type signatures\n@@ -180,7 +190,7 @@ LL | struct M<F, T> where F: Fn() -> T {\n    |           +++                   ~\n \n error[E0121]: the type placeholder `_` is not allowed within types on item signatures for enums\n-  --> $DIR/bad-assoc-ty.rs:64:28\n+  --> $DIR/bad-assoc-ty.rs:66:28\n    |\n LL | enum N<F> where F: Fn() -> _ {\n    |                            ^ not allowed in type signatures\n@@ -191,7 +201,7 @@ LL | enum N<F, T> where F: Fn() -> T {\n    |         +++                   ~\n \n error[E0121]: the type placeholder `_` is not allowed within types on item signatures for unions\n-  --> $DIR/bad-assoc-ty.rs:69:29\n+  --> $DIR/bad-assoc-ty.rs:71:29\n    |\n LL | union O<F> where F: Fn() -> _ {\n    |                             ^ not allowed in type signatures\n@@ -202,7 +212,7 @@ LL | union O<F, T> where F: Fn() -> T {\n    |          +++                   ~\n \n error[E0121]: the type placeholder `_` is not allowed within types on item signatures for traits\n-  --> $DIR/bad-assoc-ty.rs:74:29\n+  --> $DIR/bad-assoc-ty.rs:76:29\n    |\n LL | trait P<F> where F: Fn() -> _ {\n    |                             ^ not allowed in type signatures\n@@ -213,7 +223,7 @@ LL | trait P<F, T> where F: Fn() -> T {\n    |          +++                   ~\n \n error[E0121]: the type placeholder `_` is not allowed within types on item signatures for functions\n-  --> $DIR/bad-assoc-ty.rs:79:38\n+  --> $DIR/bad-assoc-ty.rs:81:38\n    |\n LL |     fn foo<F>(_: F) where F: Fn() -> _ {}\n    |                                      ^ not allowed in type signatures\n@@ -223,7 +233,7 @@ help: use type parameters instead\n LL |     fn foo<F, T>(_: F) where F: Fn() -> T {}\n    |             +++                         ~\n \n-error: aborting due to 28 previous errors\n+error: aborting due to 28 previous errors; 1 warning emitted\n \n Some errors have detailed explanations: E0121, E0223.\n For more information about an error, try `rustc --explain E0121`."}, {"sha": "d8b3b9c7deba5188e1473aba064fefbdae81e71f", "filename": "src/test/ui/dyn-keyword/dyn-2018-edition-lint.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-2018-edition-lint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-2018-edition-lint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-2018-edition-lint.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -7,8 +7,6 @@ fn function(x: &SomeTrait, y: Box<SomeTrait>) {\n     //~| ERROR trait objects without an explicit `dyn` are deprecated\n     //~| WARN this is accepted in the current edition\n     let _x: &SomeTrait = todo!();\n-    //~^ ERROR trait objects without an explicit `dyn` are deprecated\n-    //~| WARN this is accepted in the current edition\n }\n \n trait SomeTrait {}"}, {"sha": "13d7185041aa23634afecffce4ba3d50f8d62cbb", "filename": "src/test/ui/dyn-keyword/dyn-2018-edition-lint.stderr", "status": "modified", "additions": 1, "deletions": 10, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-2018-edition-lint.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-2018-edition-lint.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-2018-edition-lint.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -21,14 +21,5 @@ LL | fn function(x: &SomeTrait, y: Box<SomeTrait>) {\n    = warning: this is accepted in the current edition (Rust 2018) but is a hard error in Rust 2021!\n    = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n \n-error: trait objects without an explicit `dyn` are deprecated\n-  --> $DIR/dyn-2018-edition-lint.rs:9:14\n-   |\n-LL |     let _x: &SomeTrait = todo!();\n-   |              ^^^^^^^^^ help: use `dyn`: `dyn SomeTrait`\n-   |\n-   = warning: this is accepted in the current edition (Rust 2018) but is a hard error in Rust 2021!\n-   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n-\n-error: aborting due to 3 previous errors\n+error: aborting due to 2 previous errors\n "}, {"sha": "0f05d8753eaa58cbfde26b1baab1935cc2a56381", "filename": "src/test/ui/dyn-keyword/dyn-2021-edition-error.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-2021-edition-error.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-2021-edition-error.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-2021-edition-error.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -4,7 +4,6 @@ fn function(x: &SomeTrait, y: Box<SomeTrait>) {\n     //~^ ERROR trait objects must include the `dyn` keyword\n     //~| ERROR trait objects must include the `dyn` keyword\n     let _x: &SomeTrait = todo!();\n-    //~^ ERROR trait objects must include the `dyn` keyword\n }\n \n trait SomeTrait {}"}, {"sha": "ea1baf01ed44b9af4cb44557c848ce09d1bf30b3", "filename": "src/test/ui/dyn-keyword/dyn-2021-edition-error.stderr", "status": "modified", "additions": 3, "deletions": 14, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-2021-edition-error.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-2021-edition-error.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-2021-edition-error.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -1,14 +1,3 @@\n-error[E0782]: trait objects must include the `dyn` keyword\n-  --> $DIR/dyn-2021-edition-error.rs:6:14\n-   |\n-LL |     let _x: &SomeTrait = todo!();\n-   |              ^^^^^^^^^\n-   |\n-help: add `dyn` keyword before this trait\n-   |\n-LL |     let _x: &dyn SomeTrait = todo!();\n-   |              +++\n-\n error[E0782]: trait objects must include the `dyn` keyword\n   --> $DIR/dyn-2021-edition-error.rs:3:17\n    |\n@@ -18,7 +7,7 @@ LL | fn function(x: &SomeTrait, y: Box<SomeTrait>) {\n help: add `dyn` keyword before this trait\n    |\n LL | fn function(x: &dyn SomeTrait, y: Box<SomeTrait>) {\n-   |                 +++\n+   |                 ~~~~~~~~~~~~~\n \n error[E0782]: trait objects must include the `dyn` keyword\n   --> $DIR/dyn-2021-edition-error.rs:3:35\n@@ -29,8 +18,8 @@ LL | fn function(x: &SomeTrait, y: Box<SomeTrait>) {\n help: add `dyn` keyword before this trait\n    |\n LL | fn function(x: &SomeTrait, y: Box<dyn SomeTrait>) {\n-   |                                   +++\n+   |                                   ~~~~~~~~~~~~~\n \n-error: aborting due to 3 previous errors\n+error: aborting due to 2 previous errors\n \n For more information about this error, try `rustc --explain E0782`."}, {"sha": "00069a3e7adb1c4135af4c2349d5b166c4eee915", "filename": "src/test/ui/dyn-keyword/dyn-angle-brackets.fixed", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-angle-brackets.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-angle-brackets.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-angle-brackets.fixed?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -15,8 +15,6 @@ impl fmt::Display for Foo {\n         <dyn fmt::Debug>::fmt(self, f)\n         //~^ ERROR trait objects without an explicit `dyn` are deprecated\n         //~| WARNING this is accepted in the current edition\n-        //~| ERROR trait objects without an explicit `dyn` are deprecated\n-        //~| WARNING this is accepted in the current edition\n     }\n }\n "}, {"sha": "ee5fee4cfb8b4b8cc5d6ee4a59a1dc69b74c35a9", "filename": "src/test/ui/dyn-keyword/dyn-angle-brackets.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-angle-brackets.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-angle-brackets.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-angle-brackets.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -15,8 +15,6 @@ impl fmt::Display for Foo {\n         <fmt::Debug>::fmt(self, f)\n         //~^ ERROR trait objects without an explicit `dyn` are deprecated\n         //~| WARNING this is accepted in the current edition\n-        //~| ERROR trait objects without an explicit `dyn` are deprecated\n-        //~| WARNING this is accepted in the current edition\n     }\n }\n "}, {"sha": "1f5a10223f1dd6ea1e4adbe5ddc5a6a32165522a", "filename": "src/test/ui/dyn-keyword/dyn-angle-brackets.stderr", "status": "modified", "additions": 1, "deletions": 10, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-angle-brackets.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-angle-brackets.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fdyn-keyword%2Fdyn-angle-brackets.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -12,14 +12,5 @@ LL | #![deny(bare_trait_objects)]\n    = warning: this is accepted in the current edition (Rust 2018) but is a hard error in Rust 2021!\n    = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n \n-error: trait objects without an explicit `dyn` are deprecated\n-  --> $DIR/dyn-angle-brackets.rs:15:10\n-   |\n-LL |         <fmt::Debug>::fmt(self, f)\n-   |          ^^^^^^^^^^ help: use `dyn`: `dyn fmt::Debug`\n-   |\n-   = warning: this is accepted in the current edition (Rust 2018) but is a hard error in Rust 2021!\n-   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n-\n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n "}, {"sha": "de0444b63e2670dbf84bdebdab259d415b285655", "filename": "src/test/ui/editions/dyn-trait-sugg-2021.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Feditions%2Fdyn-trait-sugg-2021.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Feditions%2Fdyn-trait-sugg-2021.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Feditions%2Fdyn-trait-sugg-2021.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -3,10 +3,10 @@\n trait Foo<T> {}\n \n impl<T> dyn Foo<T> {\n-    fn hi(_x: T)  {}\n+    fn hi(_x: T) {}\n }\n \n fn main() {\n     Foo::hi(123);\n-    //~^ ERROR trait objects without an explicit `dyn` are deprecated\n+    //~^ ERROR trait objects must include the `dyn` keyword\n }"}, {"sha": "9d1d2d7c51ec4402cdd8b3cefa5d451af98293fc", "filename": "src/test/ui/editions/dyn-trait-sugg-2021.stderr", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Feditions%2Fdyn-trait-sugg-2021.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Feditions%2Fdyn-trait-sugg-2021.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Feditions%2Fdyn-trait-sugg-2021.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -1,8 +1,13 @@\n-error[E0782]: trait objects without an explicit `dyn` are deprecated\n+error[E0782]: trait objects must include the `dyn` keyword\n   --> $DIR/dyn-trait-sugg-2021.rs:10:5\n    |\n LL |     Foo::hi(123);\n-   |     ^^^ help: use `dyn`: `<dyn Foo>`\n+   |     ^^^\n+   |\n+help: add `dyn` keyword before this trait\n+   |\n+LL |     <dyn Foo>::hi(123);\n+   |     ~~~~~~~~~\n \n error: aborting due to previous error\n "}, {"sha": "f01da8c61ed1d8d47cfd4c861b57ecbc13e08c29", "filename": "src/test/ui/generic-associated-types/gat-trait-path-parenthesised-args.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fgeneric-associated-types%2Fgat-trait-path-parenthesised-args.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fgeneric-associated-types%2Fgat-trait-path-parenthesised-args.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fgeneric-associated-types%2Fgat-trait-path-parenthesised-args.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -9,7 +9,5 @@ fn foo<'a>(arg: Box<dyn X<Y('a) = &'a ()>>) {}\n   //~| ERROR: parenthesized generic arguments cannot be used\n   //~| ERROR this associated type takes 0 generic arguments but 1 generic argument\n   //~| ERROR this associated type takes 1 lifetime argument but 0 lifetime arguments\n-  //~| WARNING: trait objects without an explicit `dyn` are deprecated\n-  //~| WARNING: this is accepted in the current edition\n \n fn main() {}"}, {"sha": "6014a02c4d96fb40f4e29cdbe325e0e8bd66b0c9", "filename": "src/test/ui/generic-associated-types/gat-trait-path-parenthesised-args.stderr", "status": "modified", "additions": 1, "deletions": 11, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fgeneric-associated-types%2Fgat-trait-path-parenthesised-args.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fgeneric-associated-types%2Fgat-trait-path-parenthesised-args.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fgeneric-associated-types%2Fgat-trait-path-parenthesised-args.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -10,16 +10,6 @@ error: parenthesized generic arguments cannot be used in associated type constra\n LL | fn foo<'a>(arg: Box<dyn X<Y('a) = &'a ()>>) {}\n    |                           ^^^^^\n \n-warning: trait objects without an explicit `dyn` are deprecated\n-  --> $DIR/gat-trait-path-parenthesised-args.rs:7:29\n-   |\n-LL | fn foo<'a>(arg: Box<dyn X<Y('a) = &'a ()>>) {}\n-   |                             ^^ help: use `dyn`: `dyn 'a`\n-   |\n-   = note: `#[warn(bare_trait_objects)]` on by default\n-   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n-   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n-\n error[E0107]: this associated type takes 1 lifetime argument but 0 lifetime arguments were supplied\n   --> $DIR/gat-trait-path-parenthesised-args.rs:7:27\n    |\n@@ -50,6 +40,6 @@ note: associated type defined here, with 0 generic parameters\n LL |   type Y<'a>;\n    |        ^\n \n-error: aborting due to 4 previous errors; 1 warning emitted\n+error: aborting due to 4 previous errors\n \n For more information about this error, try `rustc --explain E0107`."}, {"sha": "1a6a7f46b2742da92b949c6d22b7782f0faadd6b", "filename": "src/test/ui/issues/issue-28344.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fissues%2Fissue-28344.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fissues%2Fissue-28344.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-28344.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -4,8 +4,12 @@ fn main() {\n     let x: u8 = BitXor::bitor(0 as u8, 0 as u8);\n     //~^ ERROR must be specified\n     //~| no function or associated item named\n+    //~| WARN trait objects without an explicit `dyn` are deprecated\n+    //~| WARN this is accepted in the current edition\n \n     let g = BitXor::bitor;\n     //~^ ERROR must be specified\n     //~| no function or associated item named\n+    //~| WARN trait objects without an explicit `dyn` are deprecated\n+    //~| WARN this is accepted in the current edition\n }"}, {"sha": "1582ef23731f6e4420b6b978c75a5db47537136d", "filename": "src/test/ui/issues/issue-28344.stderr", "status": "modified", "additions": 22, "deletions": 3, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fissues%2Fissue-28344.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fissues%2Fissue-28344.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-28344.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -1,3 +1,13 @@\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/issue-28344.rs:4:17\n+   |\n+LL |     let x: u8 = BitXor::bitor(0 as u8, 0 as u8);\n+   |                 ^^^^^^ help: use `dyn`: `<dyn BitXor>`\n+   |\n+   = note: `#[warn(bare_trait_objects)]` on by default\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n error[E0191]: the value of the associated type `Output` (from trait `BitXor`) must be specified\n   --> $DIR/issue-28344.rs:4:17\n    |\n@@ -13,22 +23,31 @@ LL |     let x: u8 = BitXor::bitor(0 as u8, 0 as u8);\n    |                         function or associated item not found in `dyn BitXor<_>`\n    |                         help: there is an associated function with a similar name: `bitxor`\n \n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/issue-28344.rs:10:13\n+   |\n+LL |     let g = BitXor::bitor;\n+   |             ^^^^^^ help: use `dyn`: `<dyn BitXor>`\n+   |\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n error[E0191]: the value of the associated type `Output` (from trait `BitXor`) must be specified\n-  --> $DIR/issue-28344.rs:8:13\n+  --> $DIR/issue-28344.rs:10:13\n    |\n LL |     let g = BitXor::bitor;\n    |             ^^^^^^ help: specify the associated type: `BitXor<Output = Type>`\n \n error[E0599]: no function or associated item named `bitor` found for trait object `dyn BitXor<_>` in the current scope\n-  --> $DIR/issue-28344.rs:8:21\n+  --> $DIR/issue-28344.rs:10:21\n    |\n LL |     let g = BitXor::bitor;\n    |                     ^^^^^\n    |                     |\n    |                     function or associated item not found in `dyn BitXor<_>`\n    |                     help: there is an associated function with a similar name: `bitxor`\n \n-error: aborting due to 4 previous errors\n+error: aborting due to 4 previous errors; 2 warnings emitted\n \n Some errors have detailed explanations: E0191, E0599.\n For more information about an error, try `rustc --explain E0191`."}, {"sha": "c838fde5d73b6867e5a242634445b63c69aa1df0", "filename": "src/test/ui/issues/issue-58734.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fissues%2Fissue-58734.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fissues%2Fissue-58734.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-58734.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -19,4 +19,6 @@ fn main() {\n     // no object safety error\n     Trait::nonexistent(());\n     //~^ ERROR no function or associated item named `nonexistent` found\n+    //~| WARN trait objects without an explicit `dyn` are deprecated\n+    //~| WARN this is accepted in the current edition\n }"}, {"sha": "61d0a2796e9cb2e1168dea49642755796b00b647", "filename": "src/test/ui/issues/issue-58734.stderr", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fissues%2Fissue-58734.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fissues%2Fissue-58734.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-58734.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -1,9 +1,19 @@\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/issue-58734.rs:20:5\n+   |\n+LL |     Trait::nonexistent(());\n+   |     ^^^^^ help: use `dyn`: `<dyn Trait>`\n+   |\n+   = note: `#[warn(bare_trait_objects)]` on by default\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n error[E0599]: no function or associated item named `nonexistent` found for trait object `dyn Trait` in the current scope\n   --> $DIR/issue-58734.rs:20:12\n    |\n LL |     Trait::nonexistent(());\n    |            ^^^^^^^^^^^ function or associated item not found in `dyn Trait`\n \n-error: aborting due to previous error\n+error: aborting due to previous error; 1 warning emitted\n \n For more information about this error, try `rustc --explain E0599`."}, {"sha": "0e2294715cd8bb1762c950efa68ec354e445b750", "filename": "src/test/ui/lint/bare-trait-objects-path.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fbare-trait-objects-path.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fbare-trait-objects-path.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fbare-trait-objects-path.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -21,4 +21,6 @@ fn main() {\n     //~^ WARN trait objects without an explicit `dyn` are deprecated\n     //~| WARN this is accepted in the current edition\n     let _: Dyn::Ty; //~ ERROR ambiguous associated type\n+    //~^ WARN trait objects without an explicit `dyn` are deprecated\n+    //~| WARN this is accepted in the current edition\n }"}, {"sha": "cbc0fada65a44406c6ddf441e51079ed2722725f", "filename": "src/test/ui/lint/bare-trait-objects-path.stderr", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fbare-trait-objects-path.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fbare-trait-objects-path.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fbare-trait-objects-path.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -1,3 +1,13 @@\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/bare-trait-objects-path.rs:23:12\n+   |\n+LL |     let _: Dyn::Ty;\n+   |            ^^^ help: use `dyn`: `<dyn Dyn>`\n+   |\n+   = note: `#[warn(bare_trait_objects)]` on by default\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n error[E0223]: ambiguous associated type\n   --> $DIR/bare-trait-objects-path.rs:23:12\n    |\n@@ -10,7 +20,6 @@ warning: trait objects without an explicit `dyn` are deprecated\n LL |     Dyn::func();\n    |     ^^^ help: use `dyn`: `<dyn Dyn>`\n    |\n-   = note: `#[warn(bare_trait_objects)]` on by default\n    = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n    = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n \n@@ -32,6 +41,6 @@ LL |     Dyn::CONST;\n    = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n    = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n \n-error: aborting due to previous error; 3 warnings emitted\n+error: aborting due to previous error; 4 warnings emitted\n \n For more information about this error, try `rustc --explain E0223`."}, {"sha": "631a8cb2f08cc0fae85cb64824aef2fe2e797101", "filename": "src/test/ui/lint/force-warn/allowed-group-warn-by-default-lint.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-group-warn-by-default-lint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-group-warn-by-default-lint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-group-warn-by-default-lint.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -10,5 +10,9 @@ pub trait SomeTrait {}\n pub fn function(_x: Box<SomeTrait>) {}\n //~^ WARN trait objects without an explicit `dyn` are deprecated\n //~| WARN this is accepted in the current edition\n+//~| WARN trait objects without an explicit `dyn` are deprecated\n+//~| WARN this is accepted in the current edition\n+//~| WARN trait objects without an explicit `dyn` are deprecated\n+//~| WARN this is accepted in the current edition\n \n fn main() {}"}, {"sha": "4ad8306d00c5e28b85075180304e6531cc5baa47", "filename": "src/test/ui/lint/force-warn/allowed-group-warn-by-default-lint.stderr", "status": "modified", "additions": 19, "deletions": 1, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-group-warn-by-default-lint.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-group-warn-by-default-lint.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fallowed-group-warn-by-default-lint.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -8,5 +8,23 @@ LL | pub fn function(_x: Box<SomeTrait>) {}\n    = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n    = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n \n-warning: 1 warning emitted\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/allowed-group-warn-by-default-lint.rs:10:25\n+   |\n+LL | pub fn function(_x: Box<SomeTrait>) {}\n+   |                         ^^^^^^^^^ help: use `dyn`: `dyn SomeTrait`\n+   |\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/allowed-group-warn-by-default-lint.rs:10:25\n+   |\n+LL | pub fn function(_x: Box<SomeTrait>) {}\n+   |                         ^^^^^^^^^ help: use `dyn`: `dyn SomeTrait`\n+   |\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n+warning: 3 warnings emitted\n "}, {"sha": "fdba7f4105e732fb7e5e6b4d722db6b078f68c4b", "filename": "src/test/ui/lint/force-warn/cap-lints-allow.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-allow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-allow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-allow.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -8,5 +8,9 @@ pub trait SomeTrait {}\n pub fn function(_x: Box<SomeTrait>) {}\n //~^ WARN trait objects without an explicit `dyn` are deprecated\n //~| WARN this is accepted in the current edition\n+//~| WARN trait objects without an explicit `dyn` are deprecated\n+//~| WARN this is accepted in the current edition\n+//~| WARN trait objects without an explicit `dyn` are deprecated\n+//~| WARN this is accepted in the current edition\n \n fn main() {}"}, {"sha": "3d850cdf94aac7c0c2af853c66ba7b8420a1b8c7", "filename": "src/test/ui/lint/force-warn/cap-lints-allow.stderr", "status": "modified", "additions": 19, "deletions": 1, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-allow.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-allow.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Fcap-lints-allow.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -8,5 +8,23 @@ LL | pub fn function(_x: Box<SomeTrait>) {}\n    = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n    = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n \n-warning: 1 warning emitted\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/cap-lints-allow.rs:8:25\n+   |\n+LL | pub fn function(_x: Box<SomeTrait>) {}\n+   |                         ^^^^^^^^^ help: use `dyn`: `dyn SomeTrait`\n+   |\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/cap-lints-allow.rs:8:25\n+   |\n+LL | pub fn function(_x: Box<SomeTrait>) {}\n+   |                         ^^^^^^^^^ help: use `dyn`: `dyn SomeTrait`\n+   |\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n+warning: 3 warnings emitted\n "}, {"sha": "7ad7462ddc55060dc0c13a520b9ec5795c87ed9d", "filename": "src/test/ui/lint/force-warn/lint-group-allowed-cli-warn-by-default-lint.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-cli-warn-by-default-lint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-cli-warn-by-default-lint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-cli-warn-by-default-lint.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -8,5 +8,9 @@ pub trait SomeTrait {}\n pub fn function(_x: Box<SomeTrait>) {}\n //~^ WARN trait objects without an explicit `dyn` are deprecated\n //~| WARN this is accepted in the current edition\n+//~| WARN trait objects without an explicit `dyn` are deprecated\n+//~| WARN this is accepted in the current edition\n+//~| WARN trait objects without an explicit `dyn` are deprecated\n+//~| WARN this is accepted in the current edition\n \n fn main() {}"}, {"sha": "ad61da95df125b9dfd8a5a994d897f1c82718986", "filename": "src/test/ui/lint/force-warn/lint-group-allowed-cli-warn-by-default-lint.stderr", "status": "modified", "additions": 19, "deletions": 1, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-cli-warn-by-default-lint.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-cli-warn-by-default-lint.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-cli-warn-by-default-lint.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -8,5 +8,23 @@ LL | pub fn function(_x: Box<SomeTrait>) {}\n    = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n    = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n \n-warning: 1 warning emitted\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/lint-group-allowed-cli-warn-by-default-lint.rs:8:25\n+   |\n+LL | pub fn function(_x: Box<SomeTrait>) {}\n+   |                         ^^^^^^^^^ help: use `dyn`: `dyn SomeTrait`\n+   |\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/lint-group-allowed-cli-warn-by-default-lint.rs:8:25\n+   |\n+LL | pub fn function(_x: Box<SomeTrait>) {}\n+   |                         ^^^^^^^^^ help: use `dyn`: `dyn SomeTrait`\n+   |\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n+warning: 3 warnings emitted\n "}, {"sha": "ee5a18c38292bf700d4b5a4211dec5498344a0cf", "filename": "src/test/ui/lint/force-warn/lint-group-allowed-lint-group.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-lint-group.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-lint-group.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-lint-group.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -10,5 +10,9 @@ pub trait SomeTrait {}\n pub fn function(_x: Box<SomeTrait>) {}\n //~^ WARN trait objects without an explicit `dyn` are deprecated\n //~| WARN this is accepted in the current edition\n+//~| WARN trait objects without an explicit `dyn` are deprecated\n+//~| WARN this is accepted in the current edition\n+//~| WARN trait objects without an explicit `dyn` are deprecated\n+//~| WARN this is accepted in the current edition\n \n fn main() {}"}, {"sha": "9e00384a23d4c71d576a4c7f9310ebb86a9c20e3", "filename": "src/test/ui/lint/force-warn/lint-group-allowed-lint-group.stderr", "status": "modified", "additions": 19, "deletions": 1, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-lint-group.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-lint-group.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-lint-group.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -8,5 +8,23 @@ LL | pub fn function(_x: Box<SomeTrait>) {}\n    = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n    = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n \n-warning: 1 warning emitted\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/lint-group-allowed-lint-group.rs:10:25\n+   |\n+LL | pub fn function(_x: Box<SomeTrait>) {}\n+   |                         ^^^^^^^^^ help: use `dyn`: `dyn SomeTrait`\n+   |\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/lint-group-allowed-lint-group.rs:10:25\n+   |\n+LL | pub fn function(_x: Box<SomeTrait>) {}\n+   |                         ^^^^^^^^^ help: use `dyn`: `dyn SomeTrait`\n+   |\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n+warning: 3 warnings emitted\n "}, {"sha": "248aece6fe77c8723aa40862cef2016960a4c7b7", "filename": "src/test/ui/lint/force-warn/lint-group-allowed-warn-by-default-lint.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-warn-by-default-lint.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-warn-by-default-lint.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-warn-by-default-lint.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -10,5 +10,9 @@ pub trait SomeTrait {}\n pub fn function(_x: Box<SomeTrait>) {}\n //~^ WARN trait objects without an explicit `dyn` are deprecated\n //~| WARN this is accepted in the current edition\n+//~| WARN trait objects without an explicit `dyn` are deprecated\n+//~| WARN this is accepted in the current edition\n+//~| WARN trait objects without an explicit `dyn` are deprecated\n+//~| WARN this is accepted in the current edition\n \n fn main() {}"}, {"sha": "ed042609d1541fc62c4c4c140f205ec6622cc90c", "filename": "src/test/ui/lint/force-warn/lint-group-allowed-warn-by-default-lint.stderr", "status": "modified", "additions": 19, "deletions": 1, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-warn-by-default-lint.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-warn-by-default-lint.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fforce-warn%2Flint-group-allowed-warn-by-default-lint.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -8,5 +8,23 @@ LL | pub fn function(_x: Box<SomeTrait>) {}\n    = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n    = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n \n-warning: 1 warning emitted\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/lint-group-allowed-warn-by-default-lint.rs:10:25\n+   |\n+LL | pub fn function(_x: Box<SomeTrait>) {}\n+   |                         ^^^^^^^^^ help: use `dyn`: `dyn SomeTrait`\n+   |\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/lint-group-allowed-warn-by-default-lint.rs:10:25\n+   |\n+LL | pub fn function(_x: Box<SomeTrait>) {}\n+   |                         ^^^^^^^^^ help: use `dyn`: `dyn SomeTrait`\n+   |\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n+warning: 3 warnings emitted\n "}, {"sha": "29c12352146b54568aeac81d6a121978f2fa294a", "filename": "src/test/ui/parser/issues/issue-68890-2.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fparser%2Fissues%2Fissue-68890-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fparser%2Fissues%2Fissue-68890-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissues%2Fissue-68890-2.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -3,5 +3,3 @@ fn main() {}\n type X<'a> = (?'a) +;\n //~^ ERROR `?` may only modify trait bounds, not lifetime bounds\n //~| ERROR at least one trait is required for an object type\n-//~| WARN trait objects without an explicit `dyn` are deprecated\n-//~| WARN this is accepted in the current edition"}, {"sha": "d9fb7beebdb69e2191ecd93ccf88baf4f80e4641", "filename": "src/test/ui/parser/issues/issue-68890-2.stderr", "status": "modified", "additions": 1, "deletions": 11, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fparser%2Fissues%2Fissue-68890-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fparser%2Fissues%2Fissue-68890-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissues%2Fissue-68890-2.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -4,22 +4,12 @@ error: `?` may only modify trait bounds, not lifetime bounds\n LL | type X<'a> = (?'a) +;\n    |               ^\n \n-warning: trait objects without an explicit `dyn` are deprecated\n-  --> $DIR/issue-68890-2.rs:3:14\n-   |\n-LL | type X<'a> = (?'a) +;\n-   |              ^^^^^^^ help: use `dyn`: `dyn (?'a) +`\n-   |\n-   = note: `#[warn(bare_trait_objects)]` on by default\n-   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n-   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n-\n error[E0224]: at least one trait is required for an object type\n   --> $DIR/issue-68890-2.rs:3:14\n    |\n LL | type X<'a> = (?'a) +;\n    |              ^^^^^^^\n \n-error: aborting due to 2 previous errors; 1 warning emitted\n+error: aborting due to 2 previous errors\n \n For more information about this error, try `rustc --explain E0224`."}, {"sha": "5f731f8db775b97a48879bf14425a6e1fdbbc83a", "filename": "src/test/ui/parser/issues/issue-73568-lifetime-after-mut.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fparser%2Fissues%2Fissue-73568-lifetime-after-mut.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fparser%2Fissues%2Fissue-73568-lifetime-after-mut.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissues%2Fissue-73568-lifetime-after-mut.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -13,11 +13,7 @@ mac!('a);\n // avoid false positives\n fn y<'a>(y: &mut 'a + Send) {\n     //~^ ERROR expected a path on the left-hand side of `+`, not `&mut 'a`\n-    //~| WARNING trait objects without an explicit `dyn` are deprecated\n-    //~| WARN this is accepted in the current edition\n     //~| ERROR at least one trait is required for an object type\n     let z = y as &mut 'a + Send;\n     //~^ ERROR expected value, found trait `Send`\n-    //~| WARNING trait objects without an explicit `dyn` are deprecated\n-    //~| WARN this is accepted in the current edition\n }"}, {"sha": "799bc16bd6abfb61da04ca6a530dc5e98719eeed", "filename": "src/test/ui/parser/issues/issue-73568-lifetime-after-mut.stderr", "status": "modified", "additions": 2, "deletions": 21, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fparser%2Fissues%2Fissue-73568-lifetime-after-mut.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fparser%2Fissues%2Fissue-73568-lifetime-after-mut.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fissues%2Fissue-73568-lifetime-after-mut.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -22,37 +22,18 @@ LL | mac!('a);\n    = note: this error originates in the macro `mac` (in Nightly builds, run with -Z macro-backtrace for more info)\n \n error[E0423]: expected value, found trait `Send`\n-  --> $DIR/issue-73568-lifetime-after-mut.rs:19:28\n+  --> $DIR/issue-73568-lifetime-after-mut.rs:17:28\n    |\n LL |     let z = y as &mut 'a + Send;\n    |                            ^^^^ not a value\n \n-warning: trait objects without an explicit `dyn` are deprecated\n-  --> $DIR/issue-73568-lifetime-after-mut.rs:14:18\n-   |\n-LL | fn y<'a>(y: &mut 'a + Send) {\n-   |                  ^^ help: use `dyn`: `dyn 'a`\n-   |\n-   = note: `#[warn(bare_trait_objects)]` on by default\n-   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n-   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n-\n-warning: trait objects without an explicit `dyn` are deprecated\n-  --> $DIR/issue-73568-lifetime-after-mut.rs:19:23\n-   |\n-LL |     let z = y as &mut 'a + Send;\n-   |                       ^^ help: use `dyn`: `dyn 'a`\n-   |\n-   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n-   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n-\n error[E0224]: at least one trait is required for an object type\n   --> $DIR/issue-73568-lifetime-after-mut.rs:14:18\n    |\n LL | fn y<'a>(y: &mut 'a + Send) {\n    |                  ^^\n \n-error: aborting due to 5 previous errors; 2 warnings emitted\n+error: aborting due to 5 previous errors\n \n Some errors have detailed explanations: E0178, E0224, E0423.\n For more information about an error, try `rustc --explain E0178`."}, {"sha": "560195977d03a91776673da99db60d48b1f9a70b", "filename": "src/test/ui/parser/macro/trait-object-macro-matcher.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fparser%2Fmacro%2Ftrait-object-macro-matcher.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fparser%2Fmacro%2Ftrait-object-macro-matcher.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fmacro%2Ftrait-object-macro-matcher.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -11,6 +11,4 @@ fn main() {\n     m!('static);\n     //~^ ERROR lifetime in trait object type must be followed by `+`\n     //~| ERROR at least one trait is required for an object type\n-    //~| WARN trait objects without an explicit `dyn` are deprecated\n-    //~| WARN this is accepted in the current edition\n }"}, {"sha": "40082564bad4c52a2ee9e4d7e98abd1dc69d88f2", "filename": "src/test/ui/parser/macro/trait-object-macro-matcher.stderr", "status": "modified", "additions": 1, "deletions": 11, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fparser%2Fmacro%2Ftrait-object-macro-matcher.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fparser%2Fmacro%2Ftrait-object-macro-matcher.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Fmacro%2Ftrait-object-macro-matcher.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -4,22 +4,12 @@ error: lifetime in trait object type must be followed by `+`\n LL |     m!('static);\n    |        ^^^^^^^\n \n-warning: trait objects without an explicit `dyn` are deprecated\n-  --> $DIR/trait-object-macro-matcher.rs:11:8\n-   |\n-LL |     m!('static);\n-   |        ^^^^^^^ help: use `dyn`: `dyn 'static`\n-   |\n-   = note: `#[warn(bare_trait_objects)]` on by default\n-   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n-   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n-\n error[E0224]: at least one trait is required for an object type\n   --> $DIR/trait-object-macro-matcher.rs:11:8\n    |\n LL |     m!('static);\n    |        ^^^^^^^\n \n-error: aborting due to 2 previous errors; 1 warning emitted\n+error: aborting due to 2 previous errors\n \n For more information about this error, try `rustc --explain E0224`."}, {"sha": "bce40edfcd275dc23bf92245334e58e0e7cd4376", "filename": "src/test/ui/parser/trait-object-trait-parens.stderr", "status": "modified", "additions": 18, "deletions": 18, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fparser%2Ftrait-object-trait-parens.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Fparser%2Ftrait-object-trait-parens.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fparser%2Ftrait-object-trait-parens.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -26,24 +26,6 @@ LL |     let _: Box<(Obj) + (?Sized) + (for<'a> Trait<'a>)>;\n    = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n    = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n \n-warning: trait objects without an explicit `dyn` are deprecated\n-  --> $DIR/trait-object-trait-parens.rs:13:16\n-   |\n-LL |     let _: Box<?Sized + (for<'a> Trait<'a>) + (Obj)>;\n-   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use `dyn`: `dyn ?Sized + (for<'a> Trait<'a>) + (Obj)`\n-   |\n-   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n-   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n-\n-warning: trait objects without an explicit `dyn` are deprecated\n-  --> $DIR/trait-object-trait-parens.rs:18:16\n-   |\n-LL |     let _: Box<for<'a> Trait<'a> + (Obj) + (?Sized)>;\n-   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use `dyn`: `dyn for<'a> Trait<'a> + (Obj) + (?Sized)`\n-   |\n-   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n-   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n-\n error[E0225]: only auto traits can be used as additional traits in a trait object\n   --> $DIR/trait-object-trait-parens.rs:8:35\n    |\n@@ -55,6 +37,15 @@ LL |     let _: Box<(Obj) + (?Sized) + (for<'a> Trait<'a>)>;\n    = help: consider creating a new trait with all of these as supertraits and using that trait here instead: `trait NewTrait: Obj + for<'a> Trait<'a> {}`\n    = note: auto-traits like `Send` and `Sync` are traits that have special properties; for more information on them, visit <https://doc.rust-lang.org/reference/special-types-and-traits.html#auto-traits>\n \n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/trait-object-trait-parens.rs:13:16\n+   |\n+LL |     let _: Box<?Sized + (for<'a> Trait<'a>) + (Obj)>;\n+   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use `dyn`: `dyn ?Sized + (for<'a> Trait<'a>) + (Obj)`\n+   |\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n error[E0225]: only auto traits can be used as additional traits in a trait object\n   --> $DIR/trait-object-trait-parens.rs:13:47\n    |\n@@ -66,6 +57,15 @@ LL |     let _: Box<?Sized + (for<'a> Trait<'a>) + (Obj)>;\n    = help: consider creating a new trait with all of these as supertraits and using that trait here instead: `trait NewTrait: for<'a> Trait<'a> + Obj {}`\n    = note: auto-traits like `Send` and `Sync` are traits that have special properties; for more information on them, visit <https://doc.rust-lang.org/reference/special-types-and-traits.html#auto-traits>\n \n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/trait-object-trait-parens.rs:18:16\n+   |\n+LL |     let _: Box<for<'a> Trait<'a> + (Obj) + (?Sized)>;\n+   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: use `dyn`: `dyn for<'a> Trait<'a> + (Obj) + (?Sized)`\n+   |\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n error[E0225]: only auto traits can be used as additional traits in a trait object\n   --> $DIR/trait-object-trait-parens.rs:18:36\n    |"}, {"sha": "158b5a9855752b126a189f45b788f730da0bc09c", "filename": "src/test/ui/unspecified-self-in-trait-ref.rs", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Funspecified-self-in-trait-ref.rs", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Funspecified-self-in-trait-ref.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Funspecified-self-in-trait-ref.rs?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -9,12 +9,22 @@ pub trait Bar<X=usize, A=Self> {\n fn main() {\n     let a = Foo::lol();\n     //~^ ERROR no function or associated item named\n+    //~| WARN trait objects without an explicit `dyn` are deprecated\n+    //~| WARN this is accepted in the current edition\n     let b = Foo::<_>::lol();\n     //~^ ERROR no function or associated item named\n+    //~| WARN trait objects without an explicit `dyn` are deprecated\n+    //~| WARN this is accepted in the current edition\n     let c = Bar::lol();\n     //~^ ERROR no function or associated item named\n+    //~| WARN trait objects without an explicit `dyn` are deprecated\n+    //~| WARN this is accepted in the current edition\n     let d = Bar::<usize, _>::lol();\n     //~^ ERROR no function or associated item named\n+    //~| WARN trait objects without an explicit `dyn` are deprecated\n+    //~| WARN this is accepted in the current edition\n     let e = Bar::<usize>::lol();\n     //~^ ERROR must be explicitly specified\n+    //~| WARN trait objects without an explicit `dyn` are deprecated\n+    //~| WARN this is accepted in the current edition\n }"}, {"sha": "e6e824ec5dcff34ee60840ea4a3fef9665d6668d", "filename": "src/test/ui/unspecified-self-in-trait-ref.stderr", "status": "modified", "additions": 51, "deletions": 5, "changes": 56, "blob_url": "https://github.com/rust-lang/rust/blob/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Funspecified-self-in-trait-ref.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/646f58a7e1985ca935c3d95a003f23fb81831dd3/src%2Ftest%2Fui%2Funspecified-self-in-trait-ref.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Funspecified-self-in-trait-ref.stderr?ref=646f58a7e1985ca935c3d95a003f23fb81831dd3", "patch": "@@ -1,29 +1,75 @@\n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/unspecified-self-in-trait-ref.rs:10:13\n+   |\n+LL |     let a = Foo::lol();\n+   |             ^^^ help: use `dyn`: `<dyn Foo>`\n+   |\n+   = note: `#[warn(bare_trait_objects)]` on by default\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n error[E0599]: no function or associated item named `lol` found for trait object `dyn Foo<_>` in the current scope\n   --> $DIR/unspecified-self-in-trait-ref.rs:10:18\n    |\n LL |     let a = Foo::lol();\n    |                  ^^^ function or associated item not found in `dyn Foo<_>`\n \n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/unspecified-self-in-trait-ref.rs:14:13\n+   |\n+LL |     let b = Foo::<_>::lol();\n+   |             ^^^^^^^^ help: use `dyn`: `<dyn Foo::<_>>`\n+   |\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n error[E0599]: no function or associated item named `lol` found for trait object `dyn Foo<_>` in the current scope\n-  --> $DIR/unspecified-self-in-trait-ref.rs:12:23\n+  --> $DIR/unspecified-self-in-trait-ref.rs:14:23\n    |\n LL |     let b = Foo::<_>::lol();\n    |                       ^^^ function or associated item not found in `dyn Foo<_>`\n \n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/unspecified-self-in-trait-ref.rs:18:13\n+   |\n+LL |     let c = Bar::lol();\n+   |             ^^^ help: use `dyn`: `<dyn Bar>`\n+   |\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n error[E0599]: no function or associated item named `lol` found for trait object `dyn Bar<_, _>` in the current scope\n-  --> $DIR/unspecified-self-in-trait-ref.rs:14:18\n+  --> $DIR/unspecified-self-in-trait-ref.rs:18:18\n    |\n LL |     let c = Bar::lol();\n    |                  ^^^ function or associated item not found in `dyn Bar<_, _>`\n \n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/unspecified-self-in-trait-ref.rs:22:13\n+   |\n+LL |     let d = Bar::<usize, _>::lol();\n+   |             ^^^^^^^^^^^^^^^ help: use `dyn`: `<dyn Bar::<usize, _>>`\n+   |\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n error[E0599]: no function or associated item named `lol` found for trait object `dyn Bar<usize, _>` in the current scope\n-  --> $DIR/unspecified-self-in-trait-ref.rs:16:30\n+  --> $DIR/unspecified-self-in-trait-ref.rs:22:30\n    |\n LL |     let d = Bar::<usize, _>::lol();\n    |                              ^^^ function or associated item not found in `dyn Bar<usize, _>`\n \n+warning: trait objects without an explicit `dyn` are deprecated\n+  --> $DIR/unspecified-self-in-trait-ref.rs:26:13\n+   |\n+LL |     let e = Bar::<usize>::lol();\n+   |             ^^^^^^^^^^^^ help: use `dyn`: `<dyn Bar::<usize>>`\n+   |\n+   = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/warnings-promoted-to-error.html>\n+\n error[E0393]: the type parameter `A` must be explicitly specified\n-  --> $DIR/unspecified-self-in-trait-ref.rs:18:13\n+  --> $DIR/unspecified-self-in-trait-ref.rs:26:13\n    |\n LL | / pub trait Bar<X=usize, A=Self> {\n LL | |     fn foo(&self);\n@@ -35,7 +81,7 @@ LL |       let e = Bar::<usize>::lol();\n    |\n    = note: because of the default `Self` reference, type parameters must be specified on object types\n \n-error: aborting due to 5 previous errors\n+error: aborting due to 5 previous errors; 5 warnings emitted\n \n Some errors have detailed explanations: E0393, E0599.\n For more information about an error, try `rustc --explain E0393`."}]}