{"sha": "d12128f56fdf315913bd5c427b3322bed484f1b3", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQxMjEyOGY1NmZkZjMxNTkxM2JkNWM0MjdiMzMyMmJlZDQ4NGYxYjM=", "commit": {"author": {"name": "Vincent Belliard", "email": "vincent@famillebelliard.fr", "date": "2012-08-31T17:14:39Z"}, "committer": {"name": "Vincent Belliard", "email": "vincent@famillebelliard.fr", "date": "2012-09-05T14:38:00Z"}, "message": "fix issue #3222", "tree": {"sha": "f0411305d653c670ae879f324d20f4a981e05d29", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f0411305d653c670ae879f324d20f4a981e05d29"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d12128f56fdf315913bd5c427b3322bed484f1b3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d12128f56fdf315913bd5c427b3322bed484f1b3", "html_url": "https://github.com/rust-lang/rust/commit/d12128f56fdf315913bd5c427b3322bed484f1b3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d12128f56fdf315913bd5c427b3322bed484f1b3/comments", "author": {"login": "Vincent-Belliard", "id": 2185554, "node_id": "MDQ6VXNlcjIxODU1NTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2185554?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Vincent-Belliard", "html_url": "https://github.com/Vincent-Belliard", "followers_url": "https://api.github.com/users/Vincent-Belliard/followers", "following_url": "https://api.github.com/users/Vincent-Belliard/following{/other_user}", "gists_url": "https://api.github.com/users/Vincent-Belliard/gists{/gist_id}", "starred_url": "https://api.github.com/users/Vincent-Belliard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Vincent-Belliard/subscriptions", "organizations_url": "https://api.github.com/users/Vincent-Belliard/orgs", "repos_url": "https://api.github.com/users/Vincent-Belliard/repos", "events_url": "https://api.github.com/users/Vincent-Belliard/events{/privacy}", "received_events_url": "https://api.github.com/users/Vincent-Belliard/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Vincent-Belliard", "id": 2185554, "node_id": "MDQ6VXNlcjIxODU1NTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2185554?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Vincent-Belliard", "html_url": "https://github.com/Vincent-Belliard", "followers_url": "https://api.github.com/users/Vincent-Belliard/followers", "following_url": "https://api.github.com/users/Vincent-Belliard/following{/other_user}", "gists_url": "https://api.github.com/users/Vincent-Belliard/gists{/gist_id}", "starred_url": "https://api.github.com/users/Vincent-Belliard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Vincent-Belliard/subscriptions", "organizations_url": "https://api.github.com/users/Vincent-Belliard/orgs", "repos_url": "https://api.github.com/users/Vincent-Belliard/repos", "events_url": "https://api.github.com/users/Vincent-Belliard/events{/privacy}", "received_events_url": "https://api.github.com/users/Vincent-Belliard/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9b88b5fe3862c45318487c37c8a48d9605590ce0", "url": "https://api.github.com/repos/rust-lang/rust/commits/9b88b5fe3862c45318487c37c8a48d9605590ce0", "html_url": "https://github.com/rust-lang/rust/commit/9b88b5fe3862c45318487c37c8a48d9605590ce0"}], "stats": {"total": 59, "additions": 55, "deletions": 4}, "files": [{"sha": "a96529fa01c74dcb361c41a4addd9dc88bbe996a", "filename": "src/rustc/middle/trans/alt.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/d12128f56fdf315913bd5c427b3322bed484f1b3/src%2Frustc%2Fmiddle%2Ftrans%2Falt.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d12128f56fdf315913bd5c427b3322bed484f1b3/src%2Frustc%2Fmiddle%2Ftrans%2Falt.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fmiddle%2Ftrans%2Falt.rs?ref=d12128f56fdf315913bd5c427b3322bed484f1b3", "patch": "@@ -58,8 +58,7 @@ fn trans_opt(bcx: block, o: opt) -> opt_result {\n             return single_result(rslt(bcx, *cell));\n           }\n           _ => {\n-            return single_result(\n-                rslt(bcx, consts::const_expr(ccx, l)));\n+            return single_result(trans_temp_expr(bcx, l));\n           }\n         }\n       }\n@@ -636,13 +635,14 @@ fn compile_submatch(bcx: block, m: match_, vals: ~[ValueRef],\n             }\n           }\n           lit(_) => {\n-            test_val = Load(bcx, val);\n             let pty = node_id_type(bcx, pat_id);\n+            test_val = load_if_immediate(bcx, val, pty);\n             kind = if ty::type_is_integral(pty) { switch }\n                    else { compare };\n           }\n           range(_, _) => {\n-            test_val = Load(bcx, val);\n+            let pty = node_id_type(bcx, pat_id);\n+            test_val = load_if_immediate(bcx, val, pty);\n             kind = compare;\n           }\n         }"}, {"sha": "0bc3eeb169d243e51445aa9f00360e5c90f2aa54", "filename": "src/test/run-pass/alt-borrowed_str.rs", "status": "added", "additions": 51, "deletions": 0, "changes": 51, "blob_url": "https://github.com/rust-lang/rust/blob/d12128f56fdf315913bd5c427b3322bed484f1b3/src%2Ftest%2Frun-pass%2Falt-borrowed_str.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d12128f56fdf315913bd5c427b3322bed484f1b3/src%2Ftest%2Frun-pass%2Falt-borrowed_str.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Falt-borrowed_str.rs?ref=d12128f56fdf315913bd5c427b3322bed484f1b3", "patch": "@@ -0,0 +1,51 @@\n+// -*- rust -*-\n+fn f1(ref_string: &str) {\n+    match ref_string {\n+        \"a\" => io::println(\"found a\"),\n+        \"b\" => io::println(\"found b\"),\n+        _ => io::println(\"not found\")\n+    }\n+}\n+\n+fn f2(ref_string: &str) {\n+    match ref_string {\n+        \"a\" => io::println(\"found a\"),\n+        \"b\" => io::println(\"found b\"),\n+        s => io::println(fmt!(\"not found (%s)\", s))\n+    }\n+}\n+\n+fn g1(ref_1: &str, ref_2: &str) {\n+    match (ref_1, ref_2) {\n+        (\"a\", \"b\") => io::println(\"found a,b\"),\n+        (\"b\", \"c\") => io::println(\"found b,c\"),\n+        _ => io::println(\"not found\")\n+    }\n+}\n+\n+fn g2(ref_1: &str, ref_2: &str) {\n+    match (ref_1, ref_2) {\n+        (\"a\", \"b\") => io::println(\"found a,b\"),\n+        (\"b\", \"c\") => io::println(\"found b,c\"),\n+        (s1, s2) => io::println(fmt!(\"not found (%s, %s)\", s1, s2))\n+    }\n+}\n+\n+fn main() {\n+    f1(@\"a\");\n+    f1(~\"b\");\n+    f1(&\"c\");\n+    f1(\"d\");\n+    f2(@\"a\");\n+    f2(~\"b\");\n+    f2(&\"c\");\n+    f2(\"d\");\n+    g1(@\"a\", @\"b\");\n+    g1(~\"b\", ~\"c\");\n+    g1(&\"c\", &\"d\");\n+    g1(\"d\", \"e\");\n+    g2(@\"a\", @\"b\");\n+    g2(~\"b\", ~\"c\");\n+    g2(&\"c\", &\"d\");\n+    g2(\"d\", \"e\");\n+}"}]}