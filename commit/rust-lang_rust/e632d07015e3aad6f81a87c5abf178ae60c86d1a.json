{"sha": "e632d07015e3aad6f81a87c5abf178ae60c86d1a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU2MzJkMDcwMTVlM2FhZDZmODFhODdjNWFiZjE3OGFlNjBjODZkMWE=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2020-05-20T23:07:23Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-05-20T23:07:23Z"}, "message": "Merge #4543\n\n4543: Remove unused cursor positions r=matklad a=matklad\n\n\n\nbors r+\n\ud83e\udd16\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>", "tree": {"sha": "51fe9bb1f0d937f0b3f2d3c81b14d6d48d75e97e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/51fe9bb1f0d937f0b3f2d3c81b14d6d48d75e97e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e632d07015e3aad6f81a87c5abf178ae60c86d1a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJexbgrCRBK7hj4Ov3rIwAAdHIIADptgc0kTDdk+4i3+wbXoIKe\n2EaE4bZFy5eYPcfUsTz9hP1Wk7wVTYOcKZl+updICeK4PVYLNntcN80G3SIrFZ1t\nZ5hX6CAjQ1yBhBh5fP+vWfzCKWOyE7rRzgLyelQNIahkDoj5zc+OAZS7ui4yoy2a\nOXR2fsgGhpWmANdxJ5KJbFKmsNO1KHPTZ4ijU6xIYEgIzT5vAkAPFAX5JTVo4t3H\npKVOmyimqODhNwWNQeSo0zXarorn2izeF19P1GUa7czK+kCJf4UzD7hhyze9cM2F\nfCR/v8j6BqmF+F/mN3C+NNj1+u7COJ43bnPyeE34kGZb9925IA+4t6cmpja17Ew=\n=Vhap\n-----END PGP SIGNATURE-----\n", "payload": "tree 51fe9bb1f0d937f0b3f2d3c81b14d6d48d75e97e\nparent f83785a94a817bc3cb649e960a5941e8e076d41a\nparent 04a8daaa33ad8aa068ccc24011c0844d06ba0ee7\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1590016043 +0000\ncommitter GitHub <noreply@github.com> 1590016043 +0000\n\nMerge #4543\n\n4543: Remove unused cursor positions r=matklad a=matklad\n\n\n\nbors r+\n\ud83e\udd16\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e632d07015e3aad6f81a87c5abf178ae60c86d1a", "html_url": "https://github.com/rust-lang/rust/commit/e632d07015e3aad6f81a87c5abf178ae60c86d1a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e632d07015e3aad6f81a87c5abf178ae60c86d1a/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f83785a94a817bc3cb649e960a5941e8e076d41a", "url": "https://api.github.com/repos/rust-lang/rust/commits/f83785a94a817bc3cb649e960a5941e8e076d41a", "html_url": "https://github.com/rust-lang/rust/commit/f83785a94a817bc3cb649e960a5941e8e076d41a"}, {"sha": "04a8daaa33ad8aa068ccc24011c0844d06ba0ee7", "url": "https://api.github.com/repos/rust-lang/rust/commits/04a8daaa33ad8aa068ccc24011c0844d06ba0ee7", "html_url": "https://github.com/rust-lang/rust/commit/04a8daaa33ad8aa068ccc24011c0844d06ba0ee7"}], "stats": {"total": 20, "additions": 7, "deletions": 13}, "files": [{"sha": "867a0f0bdc71abaf67048806cddfbeb36030f558", "filename": "crates/ra_ide/src/typing.rs", "status": "modified", "additions": 7, "deletions": 13, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/e632d07015e3aad6f81a87c5abf178ae60c86d1a/crates%2Fra_ide%2Fsrc%2Ftyping.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e632d07015e3aad6f81a87c5abf178ae60c86d1a/crates%2Fra_ide%2Fsrc%2Ftyping.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide%2Fsrc%2Ftyping.rs?ref=e632d07015e3aad6f81a87c5abf178ae60c86d1a", "patch": "@@ -111,7 +111,7 @@ fn on_dot_typed(file: &SourceFile, offset: TextSize) -> Option<SingleFileChange>\n     Some(SingleFileChange {\n         label: \"reindent dot\".to_string(),\n         edit: TextEdit::replace(TextRange::new(offset - current_indent_len, offset), target_indent),\n-        cursor_position: Some(offset + target_indent_len - current_indent_len + TextSize::of('.')),\n+        cursor_position: None,\n     })\n }\n \n@@ -130,7 +130,7 @@ fn on_arrow_typed(file: &SourceFile, offset: TextSize) -> Option<SingleFileChang\n     Some(SingleFileChange {\n         label: \"add space after return type\".to_string(),\n         edit: TextEdit::insert(after_arrow, \" \".to_string()),\n-        cursor_position: Some(after_arrow),\n+        cursor_position: None,\n     })\n }\n \n@@ -140,29 +140,23 @@ mod tests {\n \n     use super::*;\n \n-    fn do_type_char(char_typed: char, before: &str) -> Option<(String, SingleFileChange)> {\n+    fn do_type_char(char_typed: char, before: &str) -> Option<String> {\n         let (offset, before) = extract_offset(before);\n         let edit = TextEdit::insert(offset, char_typed.to_string());\n         let mut before = before.to_string();\n         edit.apply(&mut before);\n         let parse = SourceFile::parse(&before);\n         on_char_typed_inner(&parse.tree(), offset, char_typed).map(|it| {\n             it.edit.apply(&mut before);\n-            (before.to_string(), it)\n+            before.to_string()\n         })\n     }\n \n     fn type_char(char_typed: char, before: &str, after: &str) {\n-        let (actual, file_change) = do_type_char(char_typed, before)\n+        let actual = do_type_char(char_typed, before)\n             .unwrap_or_else(|| panic!(\"typing `{}` did nothing\", char_typed));\n \n-        if after.contains(\"<|>\") {\n-            let (offset, after) = extract_offset(after);\n-            assert_eq_text!(&after, &actual);\n-            assert_eq!(file_change.cursor_position, Some(offset))\n-        } else {\n-            assert_eq_text!(after, &actual);\n-        }\n+        assert_eq_text!(after, &actual);\n     }\n \n     fn type_char_noop(char_typed: char, before: &str) {\n@@ -350,6 +344,6 @@ fn foo() {\n \n     #[test]\n     fn adds_space_after_return_type() {\n-        type_char('>', \"fn foo() -<|>{ 92 }\", \"fn foo() -><|> { 92 }\")\n+        type_char('>', \"fn foo() -<|>{ 92 }\", \"fn foo() -> { 92 }\")\n     }\n }"}]}