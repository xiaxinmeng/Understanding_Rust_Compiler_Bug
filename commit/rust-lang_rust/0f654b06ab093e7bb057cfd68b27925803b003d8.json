{"sha": "0f654b06ab093e7bb057cfd68b27925803b003d8", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBmNjU0YjA2YWIwOTNlN2JiMDU3Y2ZkNjhiMjc5MjU4MDNiMDAzZDg=", "commit": {"author": {"name": "Jonas Schievink", "email": "jonas.schievink@ferrous-systems.com", "date": "2020-07-14T11:12:16Z"}, "committer": {"name": "Jonas Schievink", "email": "jonas.schievink@ferrous-systems.com", "date": "2020-07-14T11:12:16Z"}, "message": "missing impl members: remove assoc. type bounds", "tree": {"sha": "c3fe1dd48945a139ba59c2e48453d8037efc5fe6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c3fe1dd48945a139ba59c2e48453d8037efc5fe6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0f654b06ab093e7bb057cfd68b27925803b003d8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0f654b06ab093e7bb057cfd68b27925803b003d8", "html_url": "https://github.com/rust-lang/rust/commit/0f654b06ab093e7bb057cfd68b27925803b003d8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0f654b06ab093e7bb057cfd68b27925803b003d8/comments", "author": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "510866b4a1a812414568bd96f1d197587ead78c0", "url": "https://api.github.com/repos/rust-lang/rust/commits/510866b4a1a812414568bd96f1d197587ead78c0", "html_url": "https://github.com/rust-lang/rust/commit/510866b4a1a812414568bd96f1d197587ead78c0"}], "stats": {"total": 46, "additions": 46, "deletions": 0}, "files": [{"sha": "124cead6c39ca2ed6c9434b8053580cd3e4d57d9", "filename": "crates/ra_assists/src/handlers/add_missing_impl_members.rs", "status": "modified", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/0f654b06ab093e7bb057cfd68b27925803b003d8/crates%2Fra_assists%2Fsrc%2Fhandlers%2Fadd_missing_impl_members.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0f654b06ab093e7bb057cfd68b27925803b003d8/crates%2Fra_assists%2Fsrc%2Fhandlers%2Fadd_missing_impl_members.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_assists%2Fsrc%2Fhandlers%2Fadd_missing_impl_members.rs?ref=0f654b06ab093e7bb057cfd68b27925803b003d8", "patch": "@@ -158,6 +158,9 @@ fn add_missing_impl_members_inner(\n             .map(|it| ast_transform::apply(&*ast_transform, it))\n             .map(|it| match it {\n                 ast::AssocItem::FnDef(def) => ast::AssocItem::FnDef(add_body(def)),\n+                ast::AssocItem::TypeAliasDef(def) => {\n+                    ast::AssocItem::TypeAliasDef(remove_bounds(def))\n+                }\n                 _ => it,\n             })\n             .map(|it| edit::remove_attrs_and_docs(&it));\n@@ -188,6 +191,14 @@ fn add_missing_impl_members_inner(\n     })\n }\n \n+fn remove_bounds(ty_def: ast::TypeAliasDef) -> ast::TypeAliasDef {\n+    if let Some(name) = ty_def.name() {\n+        make::type_alias_def(name, None, ty_def.type_ref())\n+    } else {\n+        ty_def\n+    }\n+}\n+\n fn add_body(fn_def: ast::FnDef) -> ast::FnDef {\n     if fn_def.body().is_some() {\n         return fn_def;\n@@ -681,6 +692,28 @@ impl Foo<T> for S<T> {\n     fn bar(&self, this: &T, that: &Self) {\n         ${0:todo!()}\n     }\n+}\"#,\n+        )\n+    }\n+\n+    #[test]\n+    fn test_assoc_type_bounds_are_removed() {\n+        check_assist(\n+            add_missing_impl_members,\n+            r#\"\n+trait Tr {\n+    type Ty: Copy + 'static;\n+}\n+\n+impl Tr for ()<|> {\n+}\"#,\n+            r#\"\n+trait Tr {\n+    type Ty: Copy + 'static;\n+}\n+\n+impl Tr for () {\n+    $0type Ty;\n }\"#,\n         )\n     }"}, {"sha": "42116afbbbb2dfaaa96ad5a9de27ca122c01b5b0", "filename": "crates/ra_syntax/src/ast/make.rs", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/0f654b06ab093e7bb057cfd68b27925803b003d8/crates%2Fra_syntax%2Fsrc%2Fast%2Fmake.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0f654b06ab093e7bb057cfd68b27925803b003d8/crates%2Fra_syntax%2Fsrc%2Fast%2Fmake.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Fsrc%2Fast%2Fmake.rs?ref=0f654b06ab093e7bb057cfd68b27925803b003d8", "patch": "@@ -64,6 +64,19 @@ pub fn use_item(use_tree: ast::UseTree) -> ast::UseItem {\n     ast_from_text(&format!(\"use {};\", use_tree))\n }\n \n+pub fn type_alias_def(\n+    name: ast::Name,\n+    bounds: Option<ast::TypeBoundList>,\n+    ty: Option<ast::TypeRef>,\n+) -> ast::TypeAliasDef {\n+    match (bounds, ty) {\n+        (None, None) => ast_from_text(&format!(\"type {};\", name)),\n+        (None, Some(ty)) => ast_from_text(&format!(\"type {} = {};\", name, ty)),\n+        (Some(bounds), None) => ast_from_text(&format!(\"type {}: {};\", name, bounds)),\n+        (Some(bounds), Some(ty)) => ast_from_text(&format!(\"type {}: {} = {};\", name, bounds, ty)),\n+    }\n+}\n+\n pub fn record_field(name: ast::NameRef, expr: Option<ast::Expr>) -> ast::RecordField {\n     return match expr {\n         Some(expr) => from_text(&format!(\"{}: {}\", name, expr)),"}]}