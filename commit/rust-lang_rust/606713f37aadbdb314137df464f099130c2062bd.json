{"sha": "606713f37aadbdb314137df464f099130c2062bd", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYwNjcxM2YzN2FhZGJkYjMxNDEzN2RmNDY0ZjA5OTEzMGMyMDYyYmQ=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2018-07-21T12:32:17Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2018-07-21T12:32:17Z"}, "message": "Auto merge of #52562 - Manishearth:clippyup, r=RalfJung\n\nUpdate clippy\n\nr? @kennytm @oli-obk", "tree": {"sha": "0895d1b1da52820640b824636c8135fc7eef4998", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0895d1b1da52820640b824636c8135fc7eef4998"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/606713f37aadbdb314137df464f099130c2062bd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/606713f37aadbdb314137df464f099130c2062bd", "html_url": "https://github.com/rust-lang/rust/commit/606713f37aadbdb314137df464f099130c2062bd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/606713f37aadbdb314137df464f099130c2062bd/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ef9781358daa0a70bdaf11c9f792210ea30dd396", "url": "https://api.github.com/repos/rust-lang/rust/commits/ef9781358daa0a70bdaf11c9f792210ea30dd396", "html_url": "https://github.com/rust-lang/rust/commit/ef9781358daa0a70bdaf11c9f792210ea30dd396"}, {"sha": "2f7edccb036ee4c6a63664b622d9355ef594979f", "url": "https://api.github.com/repos/rust-lang/rust/commits/2f7edccb036ee4c6a63664b622d9355ef594979f", "html_url": "https://github.com/rust-lang/rust/commit/2f7edccb036ee4c6a63664b622d9355ef594979f"}], "stats": {"total": 42, "additions": 27, "deletions": 15}, "files": [{"sha": "09baaeadaee43b58d8d7ec7af1ed7e75b412aed0", "filename": "src/Cargo.lock", "status": "modified", "additions": 10, "deletions": 10, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/606713f37aadbdb314137df464f099130c2062bd/src%2FCargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/606713f37aadbdb314137df464f099130c2062bd/src%2FCargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2FCargo.lock?ref=606713f37aadbdb314137df464f099130c2062bd", "patch": "@@ -44,7 +44,7 @@ dependencies = [\n  \"html5ever 0.22.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"lazy_static 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"maplit 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"matches 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"matches 0.1.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"tendril 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"url 1.7.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n@@ -342,10 +342,10 @@ name = \"clippy_lints\"\n version = \"0.0.212\"\n dependencies = [\n  \"cargo_metadata 0.5.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"if_chain 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"if_chain 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"itertools 0.7.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"lazy_static 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"matches 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"matches 0.1.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"pulldown-cmark 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"quine-mc_cluskey 0.2.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"regex-syntax 0.6.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -887,14 +887,14 @@ name = \"idna\"\n version = \"0.1.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"matches 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"matches 0.1.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"unicode-bidi 0.3.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"unicode-normalization 0.1.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n name = \"if_chain\"\n-version = \"0.1.2\"\n+version = \"0.1.3\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n@@ -1153,7 +1153,7 @@ dependencies = [\n \n [[package]]\n name = \"matches\"\n-version = \"0.1.6\"\n+version = \"0.1.7\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n@@ -2868,7 +2868,7 @@ name = \"unicode-bidi\"\n version = \"0.3.4\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"matches 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"matches 0.1.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -2932,7 +2932,7 @@ version = \"1.7.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"idna 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"matches 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"matches 0.1.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"percent-encoding 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -3123,7 +3123,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum html5ever 0.22.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b04478cf718862650a0bf66acaf8f2f8c906fbc703f35c916c1f4211b069a364\"\n \"checksum humantime 1.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"0484fda3e7007f2a4a0d9c3a703ca38c71c54c55602ce4660c419fd32e188c9e\"\n \"checksum idna 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"38f09e0f0b1fb55fdee1f17470ad800da77af5186a1a76c026b679358b7e844e\"\n-\"checksum if_chain 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"61bb90bdd39e3af69b0172dfc6130f6cd6332bf040fbb9bdd4401d37adbd48b8\"\n+\"checksum if_chain 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"4bac95d9aa0624e7b78187d6fb8ab012b41d9f6f54b1bcb61e61c4845f8357ec\"\n \"checksum ignore 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"787a5940ab88e0f2f3b2cad3687060bddcf67520f3b761abc31065c9c495d088\"\n \"checksum is-match 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7e5b386aef33a1c677be65237cb9d32c3f3ef56bd035949710c4bb13083eb053\"\n \"checksum isatty 0.1.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"6c324313540cd4d7ba008d43dc6606a32a5579f13cc17b2804c13096f0a5c522\"\n@@ -3148,7 +3148,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum mac 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"c41e0c4fef86961ac6d6f8a82609f55f31b05e4fce149ac5710e439df7619ba4\"\n \"checksum maplit 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"08cbb6b4fef96b6d77bfc40ec491b1690c779e77b05cd9f07f787ed376fd4c43\"\n \"checksum markup5ever 0.7.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"bfedc97d5a503e96816d10fedcd5b42f760b2e525ce2f7ec71f6a41780548475\"\n-\"checksum matches 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"100aabe6b8ff4e4a7e32c1c13523379802df0772b82466207ac25b013f193376\"\n+\"checksum matches 0.1.7 (registry+https://github.com/rust-lang/crates.io-index)\" = \"835511bab37c34c47da5cb44844bea2cfde0236db0b506f90ea4224482c9774a\"\n \"checksum mdbook 0.1.7 (registry+https://github.com/rust-lang/crates.io-index)\" = \"90b5a8d7e341ceee5db3882a06078d42661ddcfa2b3687319cc5da76ec4e782f\"\n \"checksum memchr 2.0.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"796fba70e76612589ed2ce7f45282f5af869e0fdd7cc6199fa1aa1f1d591ba9d\"\n \"checksum memmap 0.6.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"e2ffa2c986de11a9df78620c01eeaaf27d94d3ff02bf81bfcca953102dd0c6ff\""}, {"sha": "0ab10bf223f0778fb5db626e496d9c5f9383f778", "filename": "src/librustc/lint/builtin.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/606713f37aadbdb314137df464f099130c2062bd/src%2Flibrustc%2Flint%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/606713f37aadbdb314137df464f099130c2062bd/src%2Flibrustc%2Flint%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Flint%2Fbuiltin.rs?ref=606713f37aadbdb314137df464f099130c2062bd", "patch": "@@ -77,7 +77,8 @@ declare_lint! {\n declare_lint! {\n     pub UNREACHABLE_CODE,\n     Warn,\n-    \"detects unreachable code paths\"\n+    \"detects unreachable code paths\",\n+    report_in_external_macro: true\n }\n \n declare_lint! {\n@@ -216,7 +217,8 @@ declare_lint! {\n declare_lint! {\n     pub DEPRECATED,\n     Warn,\n-    \"detects use of deprecated items\"\n+    \"detects use of deprecated items\",\n+    report_in_external_macro: true\n }\n \n declare_lint! {"}, {"sha": "c0f3c351d2627666db1d550f2f112befccb2f2db", "filename": "src/librustc/lint/mod.rs", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/606713f37aadbdb314137df464f099130c2062bd/src%2Flibrustc%2Flint%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/606713f37aadbdb314137df464f099130c2062bd/src%2Flibrustc%2Flint%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Flint%2Fmod.rs?ref=606713f37aadbdb314137df464f099130c2062bd", "patch": "@@ -80,6 +80,9 @@ pub struct Lint {\n     /// Starting at the given edition, default to the given lint level. If this is `None`, then use\n     /// `default_level`.\n     pub edition_lint_opts: Option<(Edition, Level)>,\n+\n+    /// Whether this lint is reported even inside expansions of external macros\n+    pub report_in_external_macro: bool,\n }\n \n impl Lint {\n@@ -100,11 +103,18 @@ impl Lint {\n #[macro_export]\n macro_rules! declare_lint {\n     ($vis: vis $NAME: ident, $Level: ident, $desc: expr) => (\n+        declare_lint!{$vis $NAME, $Level, $desc, false}\n+    );\n+    ($vis: vis $NAME: ident, $Level: ident, $desc: expr, report_in_external_macro: $rep: expr) => (\n+        declare_lint!{$vis $NAME, $Level, $desc, $rep}\n+    );\n+    ($vis: vis $NAME: ident, $Level: ident, $desc: expr, $external: expr) => (\n         $vis static $NAME: &$crate::lint::Lint = &$crate::lint::Lint {\n             name: stringify!($NAME),\n             default_level: $crate::lint::$Level,\n             desc: $desc,\n             edition_lint_opts: None,\n+            report_in_external_macro: $external,\n         };\n     );\n     ($vis: vis $NAME: ident, $Level: ident, $desc: expr,\n@@ -115,6 +125,7 @@ macro_rules! declare_lint {\n             default_level: $crate::lint::$Level,\n             desc: $desc,\n             edition_lint_opts: Some(($lint_edition, $crate::lint::Level::$edition_level)),\n+            report_in_external_macro: false,\n         };\n     );\n }\n@@ -583,8 +594,7 @@ pub fn struct_lint_level<'a>(sess: &'a Session,\n     // items to take care of (delete the macro invocation). As a result we have\n     // a few lints we whitelist here for allowing a lint even though it's in a\n     // foreign macro invocation.\n-    } else if lint_id != LintId::of(builtin::UNREACHABLE_CODE) &&\n-        lint_id != LintId::of(builtin::DEPRECATED) {\n+    } else if !lint.report_in_external_macro {\n         if err.span.primary_spans().iter().any(|s| in_external_macro(sess, *s)) {\n             err.cancel();\n         }"}, {"sha": "8085ed733fefeaf37aca0a39da93344326de5d57", "filename": "src/tools/clippy", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": null, "raw_url": null, "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy?ref=606713f37aadbdb314137df464f099130c2062bd", "patch": "@@ -1 +1 @@\n-Subproject commit c05adc545cff45449d40b1c72070ada7db5fc953\n+Subproject commit 8085ed733fefeaf37aca0a39da93344326de5d57"}]}