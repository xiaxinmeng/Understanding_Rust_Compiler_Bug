{"sha": "b1d5e52840f05e846a56023d2ec68bf700274552", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIxZDVlNTI4NDBmMDVlODQ2YTU2MDIzZDJlYzY4YmY3MDAyNzQ1NTI=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2019-08-01T14:00:34Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-08-01T14:00:34Z"}, "message": "Rollup merge of #63191 - pietroalbini:really-fix-toolstate, r=alexcrichton\n\nci: fix toolstate not pushing data for Linux\n\nA recent commit modified toolstate to only push updated data when the `TOOLSTATE_PUBLISH` environment variable is present. This worked fine on Windows but failed on Linux, since Linux jobs run inside Docker containers and the variable wasn't forwarded inside it.\n\nThis changes the Docker startup code to set the `TOOLSTATE_PUBLISH` enviornment variable inside the container if it's present outside.\n\nr? @alexcrichton\nfixes https://github.com/rust-lang/rust/issues/63190", "tree": {"sha": "a3bcfeae70d10a2f18cf1a2b3409a02dec05aa3d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a3bcfeae70d10a2f18cf1a2b3409a02dec05aa3d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b1d5e52840f05e846a56023d2ec68bf700274552", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdQvCCCRBK7hj4Ov3rIwAAdHIIAKpqgtTaw5d8QzC/whIDlFyE\nba4Kex/+ivIGFI9a/cYpHyGIX2WF/ev2ibd2MXs3gmHX8rSOSht5xoiFj2rnvXzL\nvlWRIjKL8bpe6fLNVSw2XVzoxsZYJm2mrHSXgK5dAtlLVd38UPWQjXWcBYPEwL0F\nexOfHbB8KpB4JpMVCF6ty7xzYT4sNs0U/jrBSpSl+9ufQHzHm5ruj507Zfko7h/U\nPEnn1Cq+LCliSQVw4Aq3oVLxMwSVF7R06uAT+C86n2KzgLTIbwCRMMD+3Ur1IxL7\nTqsQi3ouRCpXNlrfaL5bUyeG0/71eyPOMqzp1Pfbe8x5GjE/yIPFHyvDX3XyHfA=\n=Q+BU\n-----END PGP SIGNATURE-----\n", "payload": "tree a3bcfeae70d10a2f18cf1a2b3409a02dec05aa3d\nparent aa15dadd15d4f908b37bd5495ca8ebe74358414d\nparent 8f8b3f26c2aac88b8d9ad4a43124142724f29df0\nauthor Pietro Albini <pietro@pietroalbini.org> 1564668034 +0200\ncommitter GitHub <noreply@github.com> 1564668034 +0200\n\nRollup merge of #63191 - pietroalbini:really-fix-toolstate, r=alexcrichton\n\nci: fix toolstate not pushing data for Linux\n\nA recent commit modified toolstate to only push updated data when the `TOOLSTATE_PUBLISH` environment variable is present. This worked fine on Windows but failed on Linux, since Linux jobs run inside Docker containers and the variable wasn't forwarded inside it.\n\nThis changes the Docker startup code to set the `TOOLSTATE_PUBLISH` enviornment variable inside the container if it's present outside.\n\nr? @alexcrichton\nfixes https://github.com/rust-lang/rust/issues/63190\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b1d5e52840f05e846a56023d2ec68bf700274552", "html_url": "https://github.com/rust-lang/rust/commit/b1d5e52840f05e846a56023d2ec68bf700274552", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b1d5e52840f05e846a56023d2ec68bf700274552/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "aa15dadd15d4f908b37bd5495ca8ebe74358414d", "url": "https://api.github.com/repos/rust-lang/rust/commits/aa15dadd15d4f908b37bd5495ca8ebe74358414d", "html_url": "https://github.com/rust-lang/rust/commit/aa15dadd15d4f908b37bd5495ca8ebe74358414d"}, {"sha": "8f8b3f26c2aac88b8d9ad4a43124142724f29df0", "url": "https://api.github.com/repos/rust-lang/rust/commits/8f8b3f26c2aac88b8d9ad4a43124142724f29df0", "html_url": "https://github.com/rust-lang/rust/commit/8f8b3f26c2aac88b8d9ad4a43124142724f29df0"}], "stats": {"total": 1, "additions": 1, "deletions": 0}, "files": [{"sha": "415d6b63eb8dc1152de7a0c191c0ce0cc4da250a", "filename": "src/ci/docker/run.sh", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b1d5e52840f05e846a56023d2ec68bf700274552/src%2Fci%2Fdocker%2Frun.sh", "raw_url": "https://github.com/rust-lang/rust/raw/b1d5e52840f05e846a56023d2ec68bf700274552/src%2Fci%2Fdocker%2Frun.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Frun.sh?ref=b1d5e52840f05e846a56023d2ec68bf700274552", "patch": "@@ -172,6 +172,7 @@ docker \\\n   --env BUILD_SOURCEBRANCHNAME \\\n   --env TOOLSTATE_REPO_ACCESS_TOKEN \\\n   --env TOOLSTATE_REPO \\\n+  --env TOOLSTATE_PUBLISH \\\n   --env CI_JOB_NAME=\"${CI_JOB_NAME-$IMAGE}\" \\\n   --init \\\n   --rm \\"}]}