{"sha": "27d9691d800eb243a29b812ff201d6e03a01d170", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI3ZDk2OTFkODAwZWIyNDNhMjliODEyZmYyMDFkNmUwM2EwMWQxNzA=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-04-20T16:53:36Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-04-20T16:53:36Z"}, "message": "Do not test RLS and rustfmt if build of these failed.\n\nAvoid a tool being simultaneously test-pass and build-fail.", "tree": {"sha": "7b2ee8f3062b3bbafdc4ff1032a30ec74c43b57f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7b2ee8f3062b3bbafdc4ff1032a30ec74c43b57f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/27d9691d800eb243a29b812ff201d6e03a01d170", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlraGxEACgkQ/vbIBR0O\nATyTfxAApSnZgvnDPHWGEaIhciK8iTlu3Yg0X1XprZGLXPWImpeZ+AYI8uyYwcwT\nLIuYfBBBCpdHTPuPDUYOtlE8BHimPxSK7BL5eMrxqA87VlfJaWcfyt6WnVnQyPAM\ngQcGMLV+dWwcZKvSav3krQL1MDTVl8j/EFsq3QFXOzk3I1o87bHLQb4slGr1pgWr\ncmnKKh4qUWwadtWfDjWdZBQBj0ejTeXT/4MuQusvkLtQOYdeh1r9AEIcNwwXPv/a\nOtKpZNqrvoLUOFZDMxCHU0sTfXMNXMiuxVlEJOqGqI07pi/WSQV6cHhq4zpMLrJ1\nZTr055wjMZvNTyagf20Yz1Yp84ppwQlVFGvqZ68eHbim4b9gqHKcXB41Hj6CxgsS\nmOqWiu8tLeNKKNfZSUqjKvIpYu64lZntv687wL7179psoxVDY8sLyeijnX2NPFcL\n8Ma9/Mwrh9iakgERJO5r5yKpL8/4UnMswuWN5vmRvT85SzqZwCmdT/dkvWLW4Uiu\nzI7CIKJgDbYiIu7/Eq0mkYUWrp12E7n4vlfXTD6HX6yI2KJHi2zjxMD8CuUPynIi\nnrHL5jxdJMmuFhKp2ftqqayzAlsTF0uh0Z1TYcQSp32VjGimJCloJPwcOdQuuIHM\nESucuPJJr1O3lfaCNFS6vMkzUUIlzAcQnNQVZF4w1TFNPOCcnXg=\n=fBgG\n-----END PGP SIGNATURE-----", "payload": "tree 7b2ee8f3062b3bbafdc4ff1032a30ec74c43b57f\nparent 6586074426a2f88a8eb9c530a586c74fdb26503f\nauthor kennytm <kennytm@gmail.com> 1524243216 +0800\ncommitter kennytm <kennytm@gmail.com> 1524243216 +0800\n\nDo not test RLS and rustfmt if build of these failed.\n\nAvoid a tool being simultaneously test-pass and build-fail.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/27d9691d800eb243a29b812ff201d6e03a01d170", "html_url": "https://github.com/rust-lang/rust/commit/27d9691d800eb243a29b812ff201d6e03a01d170", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/27d9691d800eb243a29b812ff201d6e03a01d170/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6586074426a2f88a8eb9c530a586c74fdb26503f", "url": "https://api.github.com/repos/rust-lang/rust/commits/6586074426a2f88a8eb9c530a586c74fdb26503f", "html_url": "https://github.com/rust-lang/rust/commit/6586074426a2f88a8eb9c530a586c74fdb26503f"}], "stats": {"total": 22, "additions": 20, "deletions": 2}, "files": [{"sha": "08bbd68c756b40063e8982265f3a3d7d69020154", "filename": "src/bootstrap/test.rs", "status": "modified", "additions": 20, "deletions": 2, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/27d9691d800eb243a29b812ff201d6e03a01d170/src%2Fbootstrap%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/27d9691d800eb243a29b812ff201d6e03a01d170/src%2Fbootstrap%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftest.rs?ref=27d9691d800eb243a29b812ff201d6e03a01d170", "patch": "@@ -241,7 +241,16 @@ impl Step for Rls {\n         let host = self.host;\n         let compiler = builder.compiler(stage, host);\n \n-        builder.ensure(tool::Rls { compiler, target: self.host, extra_features: Vec::new() });\n+        let build_result = builder.ensure(tool::Rls {\n+            compiler,\n+            target: self.host,\n+            extra_features: Vec::new(),\n+        });\n+        if build_result.is_none() {\n+            eprintln!(\"failed to test rls: could not build\");\n+            return;\n+        }\n+\n         let mut cargo = tool::prepare_tool_cargo(builder,\n                                                  compiler,\n                                                  host,\n@@ -286,7 +295,16 @@ impl Step for Rustfmt {\n         let host = self.host;\n         let compiler = builder.compiler(stage, host);\n \n-        builder.ensure(tool::Rustfmt { compiler, target: self.host, extra_features: Vec::new() });\n+        let build_result = builder.ensure(tool::Rustfmt {\n+            compiler,\n+            target: self.host,\n+            extra_features: Vec::new(),\n+        });\n+        if build_result.is_none() {\n+            eprintln!(\"failed to test rustfmt: could not build\");\n+            return;\n+        }\n+\n         let mut cargo = tool::prepare_tool_cargo(builder,\n                                                  compiler,\n                                                  host,"}]}