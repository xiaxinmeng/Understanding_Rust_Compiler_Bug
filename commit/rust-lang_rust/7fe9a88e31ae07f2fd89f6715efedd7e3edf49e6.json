{"sha": "7fe9a88e31ae07f2fd89f6715efedd7e3edf49e6", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdmZTlhODhlMzFhZTA3ZjJmZDg5ZjY3MTVlZmVkZDdlM2VkZjQ5ZTY=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-06-19T05:55:53Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2011-06-19T09:41:02Z"}, "message": "rustc: Re-introduce session.span_err, session.err\n\nThese errors are non-fatal. The session.abort_if_errors function needs to be\ncalled at strategic points to convert the previous errors to utter failure.\n\nIssue #440", "tree": {"sha": "b779b74468ff2433da14c6f4e02994f4be2ab993", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b779b74468ff2433da14c6f4e02994f4be2ab993"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7fe9a88e31ae07f2fd89f6715efedd7e3edf49e6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7fe9a88e31ae07f2fd89f6715efedd7e3edf49e6", "html_url": "https://github.com/rust-lang/rust/commit/7fe9a88e31ae07f2fd89f6715efedd7e3edf49e6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7fe9a88e31ae07f2fd89f6715efedd7e3edf49e6/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c394a7f49ac29a099994e243017065de2ff97f2a", "url": "https://api.github.com/repos/rust-lang/rust/commits/c394a7f49ac29a099994e243017065de2ff97f2a", "html_url": "https://github.com/rust-lang/rust/commit/c394a7f49ac29a099994e243017065de2ff97f2a"}], "stats": {"total": 18, "additions": 16, "deletions": 2}, "files": [{"sha": "208fb5048c0cff1cf276f1457e0408d2f213757a", "filename": "src/comp/driver/rustc.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7fe9a88e31ae07f2fd89f6715efedd7e3edf49e6/src%2Fcomp%2Fdriver%2Frustc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7fe9a88e31ae07f2fd89f6715efedd7e3edf49e6/src%2Fcomp%2Fdriver%2Frustc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fdriver%2Frustc.rs?ref=7fe9a88e31ae07f2fd89f6715efedd7e3edf49e6", "patch": "@@ -272,7 +272,7 @@ fn build_session(@session::options sopts) -> session::session {\n     auto target_crate_num = 0;\n     auto sess =\n         session::session(target_crate_num, target_cfg, sopts, crate_cache,\n-                         front::codemap::new_codemap());\n+                         front::codemap::new_codemap(), 0u);\n     ret sess;\n }\n "}, {"sha": "14b8213ce3c71f2493c4d90bf8db311b8383d5a8", "filename": "src/comp/driver/session.rs", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/7fe9a88e31ae07f2fd89f6715efedd7e3edf49e6/src%2Fcomp%2Fdriver%2Fsession.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7fe9a88e31ae07f2fd89f6715efedd7e3edf49e6/src%2Fcomp%2Fdriver%2Fsession.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fdriver%2Fsession.rs?ref=7fe9a88e31ae07f2fd89f6715efedd7e3edf49e6", "patch": "@@ -66,7 +66,8 @@ obj session(ast::crate_num cnum,\n             @config targ_cfg,\n             @options opts,\n             map::hashmap[int, crate_metadata] crates,\n-            codemap::codemap cm) {\n+            codemap::codemap cm,\n+            mutable uint err_count) {\n     fn get_targ_cfg() -> @config { ret targ_cfg; }\n     fn get_opts() -> @options { ret opts; }\n     fn get_targ_crate_num() -> ast::crate_num { ret cnum; }\n@@ -80,6 +81,19 @@ obj session(ast::crate_num cnum,\n         emit_diagnostic(none[span], msg, \"error\", 9u8, cm);\n         fail;\n     }\n+    fn span_err(span sp, str msg) {\n+        emit_diagnostic(some(sp), msg, \"error\", 9u8, cm);\n+        err_count += 1u;\n+    }\n+    fn err(span sp, str msg) {\n+        emit_diagnostic(some(sp), msg, \"error\", 9u8, cm);\n+        err_count += 1u;\n+    }\n+    fn abort_if_errors() {\n+        if (err_count > 0u) {\n+            self.fatal(\"aborting due to previous errors\");\n+        }\n+    }\n     fn span_warn(span sp, str msg) {\n         // FIXME: Use constants, but rustboot doesn't know how to export them.\n "}]}