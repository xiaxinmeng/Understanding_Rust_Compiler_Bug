{"sha": "ca5ed2307c6dd8396f58460652c77a6a63704e0b", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNhNWVkMjMwN2M2ZGQ4Mzk2ZjU4NDYwNjUyYzc3YTZhNjM3MDRlMGI=", "commit": {"author": {"name": "Florian Diebold", "email": "flodiebold@gmail.com", "date": "2019-06-12T18:51:29Z"}, "committer": {"name": "Florian Diebold", "email": "flodiebold@gmail.com", "date": "2019-06-15T16:21:23Z"}, "message": "Implement * operation using Deref trait", "tree": {"sha": "a88c2450cd61c22b7472aa4021a797edb08861ad", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a88c2450cd61c22b7472aa4021a797edb08861ad"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ca5ed2307c6dd8396f58460652c77a6a63704e0b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ca5ed2307c6dd8396f58460652c77a6a63704e0b", "html_url": "https://github.com/rust-lang/rust/commit/ca5ed2307c6dd8396f58460652c77a6a63704e0b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ca5ed2307c6dd8396f58460652c77a6a63704e0b/comments", "author": {"login": "flodiebold", "id": 906069, "node_id": "MDQ6VXNlcjkwNjA2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/906069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flodiebold", "html_url": "https://github.com/flodiebold", "followers_url": "https://api.github.com/users/flodiebold/followers", "following_url": "https://api.github.com/users/flodiebold/following{/other_user}", "gists_url": "https://api.github.com/users/flodiebold/gists{/gist_id}", "starred_url": "https://api.github.com/users/flodiebold/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flodiebold/subscriptions", "organizations_url": "https://api.github.com/users/flodiebold/orgs", "repos_url": "https://api.github.com/users/flodiebold/repos", "events_url": "https://api.github.com/users/flodiebold/events{/privacy}", "received_events_url": "https://api.github.com/users/flodiebold/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flodiebold", "id": 906069, "node_id": "MDQ6VXNlcjkwNjA2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/906069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flodiebold", "html_url": "https://github.com/flodiebold", "followers_url": "https://api.github.com/users/flodiebold/followers", "following_url": "https://api.github.com/users/flodiebold/following{/other_user}", "gists_url": "https://api.github.com/users/flodiebold/gists{/gist_id}", "starred_url": "https://api.github.com/users/flodiebold/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flodiebold/subscriptions", "organizations_url": "https://api.github.com/users/flodiebold/orgs", "repos_url": "https://api.github.com/users/flodiebold/repos", "events_url": "https://api.github.com/users/flodiebold/events{/privacy}", "received_events_url": "https://api.github.com/users/flodiebold/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9c5e7dd849eff7bd6f20aa353feef083d089ff58", "url": "https://api.github.com/repos/rust-lang/rust/commits/9c5e7dd849eff7bd6f20aa353feef083d089ff58", "html_url": "https://github.com/rust-lang/rust/commit/9c5e7dd849eff7bd6f20aa353feef083d089ff58"}], "stats": {"total": 8, "additions": 5, "deletions": 3}, "files": [{"sha": "1ee40c70a83cffaf4fb0be27c40e51da3751fc75", "filename": "crates/ra_hir/src/ty/infer.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/ca5ed2307c6dd8396f58460652c77a6a63704e0b/crates%2Fra_hir%2Fsrc%2Fty%2Finfer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ca5ed2307c6dd8396f58460652c77a6a63704e0b/crates%2Fra_hir%2Fsrc%2Fty%2Finfer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fty%2Finfer.rs?ref=ca5ed2307c6dd8396f58460652c77a6a63704e0b", "patch": "@@ -1126,10 +1126,12 @@ impl<'a, D: HirDatabase> InferenceContext<'a, D> {\n                 let inner_ty = self.infer_expr(*expr, &Expectation::none());\n                 match op {\n                     UnaryOp::Deref => {\n-                        if let Some(derefed_ty) = inner_ty.builtin_deref() {\n-                            derefed_ty\n+                        let canonicalized = self.canonicalizer().canonicalize_ty(inner_ty);\n+                        if let Some(derefed_ty) =\n+                            autoderef::deref(self.db, &self.resolver, &canonicalized.value)\n+                        {\n+                            canonicalized.decanonicalize_ty(derefed_ty.value)\n                         } else {\n-                            // FIXME Deref::deref\n                             Ty::Unknown\n                         }\n                     }"}]}