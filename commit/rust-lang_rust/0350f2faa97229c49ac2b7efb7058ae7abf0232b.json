{"sha": "0350f2faa97229c49ac2b7efb7058ae7abf0232b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAzNTBmMmZhYTk3MjI5YzQ5YWMyYjdlZmI3MDU4YWU3YWJmMDIzMmI=", "commit": {"author": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2018-07-20T12:20:37Z"}, "committer": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2018-07-20T12:20:37Z"}, "message": "Don't panic on intrinsics", "tree": {"sha": "184fdf30480d9dac4e44d668c1d8dc96d91b5907", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/184fdf30480d9dac4e44d668c1d8dc96d91b5907"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0350f2faa97229c49ac2b7efb7058ae7abf0232b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0350f2faa97229c49ac2b7efb7058ae7abf0232b", "html_url": "https://github.com/rust-lang/rust/commit/0350f2faa97229c49ac2b7efb7058ae7abf0232b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0350f2faa97229c49ac2b7efb7058ae7abf0232b/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a3b53eb4517a7cdbacaac4e2b9f52959e402bcdf", "url": "https://api.github.com/repos/rust-lang/rust/commits/a3b53eb4517a7cdbacaac4e2b9f52959e402bcdf", "html_url": "https://github.com/rust-lang/rust/commit/a3b53eb4517a7cdbacaac4e2b9f52959e402bcdf"}], "stats": {"total": 20, "additions": 18, "deletions": 2}, "files": [{"sha": "027d0ba954247b961b9cc626a52a9b74d6856fbd", "filename": "example.rs", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/0350f2faa97229c49ac2b7efb7058ae7abf0232b/example.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0350f2faa97229c49ac2b7efb7058ae7abf0232b/example.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/example.rs?ref=0350f2faa97229c49ac2b7efb7058ae7abf0232b", "patch": "@@ -1,4 +1,4 @@\n-#![feature(no_core, lang_items)]\n+#![feature(no_core, lang_items, intrinsics)]\n #![no_core]\n #![allow(dead_code)]\n \n@@ -68,6 +68,10 @@ unsafe fn drop_in_place<T: ?Sized>(to_drop: *mut T) {\n     drop_in_place(to_drop);\n }\n \n+extern \"rust-intrinsic\" {\n+    fn copy<T>(src: *const T, dst: *mut T, count: usize);\n+}\n+\n fn abc(a: u8) -> u8 {\n     a * 2\n }\n@@ -144,3 +148,12 @@ struct DebugTuple(());\n fn debug_tuple() -> DebugTuple {\n     DebugTuple(())\n }\n+\n+unsafe fn use_copy_intrinsic(src: *const u8, dst: *mut u8) {\n+    copy::<u8>(src, dst, 1);\n+}\n+\n+/*unsafe fn use_copy_intrinsic_ref(src: *const u8, dst: *mut u8) {\n+    let copy2 = &copy::<u8>;\n+    copy2(src, dst, 1);\n+}*/"}, {"sha": "01e2bc69fc70107a07727a8b5c445c6ef5cd709e", "filename": "src/abi.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0350f2faa97229c49ac2b7efb7058ae7abf0232b/src%2Fabi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0350f2faa97229c49ac2b7efb7058ae7abf0232b/src%2Fabi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fabi.rs?ref=0350f2faa97229c49ac2b7efb7058ae7abf0232b", "patch": "@@ -15,6 +15,8 @@ pub fn cton_sig_from_fn_ty<'a, 'tcx: 'a>(tcx: TyCtxt<'a, 'tcx, 'tcx>, fn_ty: Ty<\n             unimplemented!();\n         }\n         Abi::System => bug!(\"system abi should be selected elsewhere\"),\n+        // TODO: properly implement intrinsics\n+        Abi::RustIntrinsic => (CallConv::SystemV, sig.inputs().to_vec(), sig.output()),\n         _ => unimplemented!(\"unsupported abi {:?}\", sig.abi),\n     };\n     Signature {"}, {"sha": "1186f5138558d065736ab3cb5cebace267d20f8f", "filename": "src/base.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0350f2faa97229c49ac2b7efb7058ae7abf0232b/src%2Fbase.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0350f2faa97229c49ac2b7efb7058ae7abf0232b/src%2Fbase.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbase.rs?ref=0350f2faa97229c49ac2b7efb7058ae7abf0232b", "patch": "@@ -322,7 +322,7 @@ fn trans_stmt<'a, 'tcx: 'a>(fx: &mut FunctionCx<'a, 'tcx>, cur_ebb: Ebb, stmt: &\n                     }\n                 },\n                 Rvalue::Cast(CastKind::ClosureFnPointer, operand, ty) => unimplemented!(\"rval closure_fn_ptr {:?} {:?}\", operand, ty),\n-                Rvalue::Cast(CastKind::Unsize, operand, ty) => unimplemented!(\"rval unsize {:?} {:?}\", operand, ty),\n+                Rvalue::Cast(CastKind::Unsize, operand, ty) => return Err(format!(\"rval unsize {:?} {:?}\", operand, ty)),\n                 Rvalue::Discriminant(place) => {\n                     let place = trans_place(fx, place);\n                     let dest_cton_ty = fx.cton_type(dest_layout.ty).unwrap();"}, {"sha": "70b82cee8622103996fa3daaaa39367ef8003fcf", "filename": "src/constant.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/0350f2faa97229c49ac2b7efb7058ae7abf0232b/src%2Fconstant.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0350f2faa97229c49ac2b7efb7058ae7abf0232b/src%2Fconstant.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fconstant.rs?ref=0350f2faa97229c49ac2b7efb7058ae7abf0232b", "patch": "@@ -14,6 +14,7 @@ pub fn trans_constant<'a, 'tcx: 'a>(fx: &mut FunctionCx<'a, 'tcx>, const_: &Cons\n             }))\n             .unwrap(),\n     };\n+    fx.tcx.sess.warn(&format!(\"const: {:?}\", value));\n \n     let ty = fx.monomorphize(&const_.ty);\n     let layout = fx.layout_of(ty);"}]}