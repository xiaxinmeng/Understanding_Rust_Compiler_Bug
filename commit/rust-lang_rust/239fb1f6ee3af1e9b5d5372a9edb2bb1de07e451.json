{"sha": "239fb1f6ee3af1e9b5d5372a9edb2bb1de07e451", "node_id": "MDY6Q29tbWl0NzI0NzEyOjIzOWZiMWY2ZWUzYWYxZTliNWQ1MzcyYTllZGIyYmIxZGUwN2U0NTE=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-01-04T08:32:09Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-01-04T08:32:09Z"}, "message": "auto merge of #11283 : brson/rust/doublefailure, r=alexcrichton\n\nPreviously this was an `rtabort!`, indicating a runtime bug. Promote\r\nthis to a more intentional abort and print a (slightly) more\r\ninformative error message.\r\n\r\nCan't test this sense our test suite can't handle an abort exit.\r\n\r\nI consider this to close #910, and that we should open another issue about implementing less conservative semantics here.", "tree": {"sha": "639137f136a0bbfe21192a2eb524a1d5771d5427", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/639137f136a0bbfe21192a2eb524a1d5771d5427"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/239fb1f6ee3af1e9b5d5372a9edb2bb1de07e451", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/239fb1f6ee3af1e9b5d5372a9edb2bb1de07e451", "html_url": "https://github.com/rust-lang/rust/commit/239fb1f6ee3af1e9b5d5372a9edb2bb1de07e451", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/239fb1f6ee3af1e9b5d5372a9edb2bb1de07e451/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3dd7c49faf5ae3a9158ab242a264c0f0eb99f657", "url": "https://api.github.com/repos/rust-lang/rust/commits/3dd7c49faf5ae3a9158ab242a264c0f0eb99f657", "html_url": "https://github.com/rust-lang/rust/commit/3dd7c49faf5ae3a9158ab242a264c0f0eb99f657"}, {"sha": "649c648d6f0627df9ac272b1505e363c7dbd656f", "url": "https://api.github.com/repos/rust-lang/rust/commits/649c648d6f0627df9ac272b1505e363c7dbd656f", "html_url": "https://github.com/rust-lang/rust/commit/649c648d6f0627df9ac272b1505e363c7dbd656f"}], "stats": {"total": 14, "additions": 9, "deletions": 5}, "files": [{"sha": "ea592d1fde557eab1cfeddaedde63922b417a639", "filename": "doc/rust.md", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/239fb1f6ee3af1e9b5d5372a9edb2bb1de07e451/doc%2Frust.md", "raw_url": "https://github.com/rust-lang/rust/raw/239fb1f6ee3af1e9b5d5372a9edb2bb1de07e451/doc%2Frust.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/doc%2Frust.md?ref=239fb1f6ee3af1e9b5d5372a9edb2bb1de07e451", "patch": "@@ -3605,10 +3605,8 @@ failed destructor. Nonetheless, the outermost unwinding activity will continue\n until the stack is unwound and the task transitions to the *dead*\n state. There is no way to \"recover\" from task failure.  Once a task has\n temporarily suspended its unwinding in the *failing* state, failure\n-occurring from within this destructor results in *hard* failure.  The\n-unwinding procedure of hard failure frees resources but does not execute\n-destructors.  The original (soft) failure is still resumed at the point where\n-it was temporarily suspended.\n+occurring from within this destructor results in *hard* failure.\n+A hard failure currently results in the process aborting.\n \n A task in the *dead* state cannot transition to other states; it exists\n only to have its termination status inspected by other tasks, and/or to await"}, {"sha": "6be4ab97ee3e560a2e16104cdd10ffa00c44c703", "filename": "src/libstd/rt/unwind.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/239fb1f6ee3af1e9b5d5372a9edb2bb1de07e451/src%2Flibstd%2Frt%2Funwind.rs", "raw_url": "https://github.com/rust-lang/rust/raw/239fb1f6ee3af1e9b5d5372a9edb2bb1de07e451/src%2Flibstd%2Frt%2Funwind.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Frt%2Funwind.rs?ref=239fb1f6ee3af1e9b5d5372a9edb2bb1de07e451", "patch": "@@ -354,7 +354,13 @@ pub fn begin_unwind<M: Any + Send>(msg: M, file: &'static str, line: uint) -> !\n             }\n \n             if (*task).unwinder.unwinding {\n-                rtabort!(\"unwinding again\");\n+                // If a task fails while it's already unwinding then we\n+                // have limited options. Currently our preference is to\n+                // just abort. In the future we may consider resuming\n+                // unwinding or otherwise exiting the task cleanly.\n+                rterrln!(\"task failed during unwinding (double-failure - total drag!)\")\n+                rterrln!(\"rust must abort now. so sorry.\");\n+                intrinsics::abort();\n             }\n         }\n "}]}