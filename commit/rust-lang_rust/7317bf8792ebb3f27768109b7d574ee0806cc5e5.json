{"sha": "7317bf8792ebb3f27768109b7d574ee0806cc5e5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjczMTdiZjg3OTJlYmIzZjI3NzY4MTA5YjdkNTc0ZWUwODA2Y2M1ZTU=", "commit": {"author": {"name": "Paul Stansifer", "email": "paul.stansifer@gmail.com", "date": "2012-08-02T22:34:13Z"}, "committer": {"name": "Paul Stansifer", "email": "paul.stansifer@gmail.com", "date": "2012-08-22T21:59:24Z"}, "message": "pre-intern some fixed names so they can be used as constants", "tree": {"sha": "c18d1d03ccee13544d7eaa57234f2a39bf24b5a4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c18d1d03ccee13544d7eaa57234f2a39bf24b5a4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7317bf8792ebb3f27768109b7d574ee0806cc5e5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7317bf8792ebb3f27768109b7d574ee0806cc5e5", "html_url": "https://github.com/rust-lang/rust/commit/7317bf8792ebb3f27768109b7d574ee0806cc5e5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7317bf8792ebb3f27768109b7d574ee0806cc5e5/comments", "author": {"login": "paulstansifer", "id": 1431, "node_id": "MDQ6VXNlcjE0MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1431?v=4", "gravatar_id": "", "url": "https://api.github.com/users/paulstansifer", "html_url": "https://github.com/paulstansifer", "followers_url": "https://api.github.com/users/paulstansifer/followers", "following_url": "https://api.github.com/users/paulstansifer/following{/other_user}", "gists_url": "https://api.github.com/users/paulstansifer/gists{/gist_id}", "starred_url": "https://api.github.com/users/paulstansifer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/paulstansifer/subscriptions", "organizations_url": "https://api.github.com/users/paulstansifer/orgs", "repos_url": "https://api.github.com/users/paulstansifer/repos", "events_url": "https://api.github.com/users/paulstansifer/events{/privacy}", "received_events_url": "https://api.github.com/users/paulstansifer/received_events", "type": "User", "site_admin": false}, "committer": {"login": "paulstansifer", "id": 1431, "node_id": "MDQ6VXNlcjE0MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1431?v=4", "gravatar_id": "", "url": "https://api.github.com/users/paulstansifer", "html_url": "https://github.com/paulstansifer", "followers_url": "https://api.github.com/users/paulstansifer/followers", "following_url": "https://api.github.com/users/paulstansifer/following{/other_user}", "gists_url": "https://api.github.com/users/paulstansifer/gists{/gist_id}", "starred_url": "https://api.github.com/users/paulstansifer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/paulstansifer/subscriptions", "organizations_url": "https://api.github.com/users/paulstansifer/orgs", "repos_url": "https://api.github.com/users/paulstansifer/repos", "events_url": "https://api.github.com/users/paulstansifer/events{/privacy}", "received_events_url": "https://api.github.com/users/paulstansifer/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9a7890d73af5ebe4bf862fa727427e290da1391b", "url": "https://api.github.com/repos/rust-lang/rust/commits/9a7890d73af5ebe4bf862fa727427e290da1391b", "html_url": "https://github.com/rust-lang/rust/commit/9a7890d73af5ebe4bf862fa727427e290da1391b"}], "stats": {"total": 22, "additions": 20, "deletions": 2}, "files": [{"sha": "10fac8d0e233ecfd8592cf433a18928b4f267e86", "filename": "src/libsyntax/parse/token.rs", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/7317bf8792ebb3f27768109b7d574ee0806cc5e5/src%2Flibsyntax%2Fparse%2Ftoken.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7317bf8792ebb3f27768109b7d574ee0806cc5e5/src%2Flibsyntax%2Fparse%2Ftoken.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Ftoken.rs?ref=7317bf8792ebb3f27768109b7d574ee0806cc5e5", "patch": "@@ -279,9 +279,18 @@ pure fn is_bar(t: token) -> bool {\n \n type ident_interner = util::interner::interner<@~str>;\n \n+mod special_idents {\n+    const underscore : uint = 0u;\n+    const anon : uint = 1u;\n+    const destr : uint = 2u; // 'drop', but that's reserved\n+}\n+\n fn mk_ident_interner() -> ident_interner {\n-    let rv = @interner::mk::<@~str>(|x| str::hash(*x),\n-                                    |x,y| str::eq(*x, *y));\n+    /* the indices here must correspond to the numbers in special_idents */\n+    let init_vec = ~[@~\"_\", @~\"anon\", @~\"drop\"];\n+\n+    let rv = @interner::mk_prefill::<@~str>(|x| str::hash(*x),\n+                                            |x,y| str::eq(*x, *y), init_vec);\n     rv\n }\n "}, {"sha": "19b27be83e2ce13dc54446c62cd70b7b500c0318", "filename": "src/libsyntax/util/interner.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/7317bf8792ebb3f27768109b7d574ee0806cc5e5/src%2Flibsyntax%2Futil%2Finterner.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7317bf8792ebb3f27768109b7d574ee0806cc5e5/src%2Flibsyntax%2Futil%2Finterner.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Futil%2Finterner.rs?ref=7317bf8792ebb3f27768109b7d574ee0806cc5e5", "patch": "@@ -18,6 +18,15 @@ fn mk<T: const copy>(+hasher: hashfn<T>, +eqer: eqfn<T>) -> interner<T> {\n     return hi as interner::<T>;\n }\n \n+fn mk_prefill<T: const copy>(hasher: hashfn<T>, eqer: eqfn<T>,\n+                             init: ~[T]) -> interner<T> {\n+\n+    let rv = mk(hasher, eqer);\n+    for init.each() |v| { rv.intern(v); }\n+    return rv;\n+}\n+\n+\n /* when traits can extend traits, we should extend index<uint,T> to get [] */\n trait interner<T: const copy> {\n     fn intern(T) -> uint;"}]}