{"sha": "4a4c07a9e027301073461599c610c3ce4e424d25", "node_id": "C_kwDOAAsO6NoAKDRhNGMwN2E5ZTAyNzMwMTA3MzQ2MTU5OWM2MTBjM2NlNGU0MjRkMjU", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2022-05-18T23:22:44Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-05-18T23:22:44Z"}, "message": "Rollup merge of #97139 - GuillaumeGomez:move-dom-settings-generation, r=notriddle\n\nMove some settings DOM generation out of JS\n\nThe first commit reduce the JS size a bit by moving some DOM content generation into the HTML file directly.\n\nThe second commit is an update of the `browser-ui-test` version which improves `wait-for-*` command (if the element doesn't exist, it'll wait for it instead of failing).\n\nr? ``@notriddle``", "tree": {"sha": "0d507c402dfda3d9bc5176d679dd60e40d3bf96f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0d507c402dfda3d9bc5176d679dd60e40d3bf96f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4a4c07a9e027301073461599c610c3ce4e424d25", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJihX/ECRBK7hj4Ov3rIwAAleQIADjIaSf53848cprBgip/yKOu\n5Dpio25Kfxw1kE9MnFD2ot8mqk3ZefOkwaAFzA6qTS8FEANTjhfusDormJMqG8bH\nFxgQWJ/H/nS/sXC4aRaiLR2as6Hu/KeaDbW6rOjoQ5UcIv58aXOJBZ56Es4+SN8a\nwHUWcGYzQ/+K491L2RRq7xlVo3iagBCSvxaS/UJ/40KZN5j4bu8zHDf6YDaRWoSQ\n1FwE1jNISb52hKhh0Znurt8UQb39mzXqbgIFzrWhwLsr6FBaa6K8IxOZTmhkYZA+\nZA6C2OHxK2pZ5OnVt9CaCxStmjD6clCaQZvZg4ZPkDa9BQyg6dTSFb7S+elgMM4=\n=YbJt\n-----END PGP SIGNATURE-----\n", "payload": "tree 0d507c402dfda3d9bc5176d679dd60e40d3bf96f\nparent b7d72add468a00d6d4fd78897c64542e9a0bda33\nparent 30b536e2c5ea9dc52eae72dee4a377a15e508910\nauthor Yuki Okushi <jtitor@2k36.org> 1652916164 +0900\ncommitter GitHub <noreply@github.com> 1652916164 +0900\n\nRollup merge of #97139 - GuillaumeGomez:move-dom-settings-generation, r=notriddle\n\nMove some settings DOM generation out of JS\n\nThe first commit reduce the JS size a bit by moving some DOM content generation into the HTML file directly.\n\nThe second commit is an update of the `browser-ui-test` version which improves `wait-for-*` command (if the element doesn't exist, it'll wait for it instead of failing).\n\nr? ``@notriddle``\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4a4c07a9e027301073461599c610c3ce4e424d25", "html_url": "https://github.com/rust-lang/rust/commit/4a4c07a9e027301073461599c610c3ce4e424d25", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4a4c07a9e027301073461599c610c3ce4e424d25/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b7d72add468a00d6d4fd78897c64542e9a0bda33", "url": "https://api.github.com/repos/rust-lang/rust/commits/b7d72add468a00d6d4fd78897c64542e9a0bda33", "html_url": "https://github.com/rust-lang/rust/commit/b7d72add468a00d6d4fd78897c64542e9a0bda33"}, {"sha": "30b536e2c5ea9dc52eae72dee4a377a15e508910", "url": "https://api.github.com/repos/rust-lang/rust/commits/30b536e2c5ea9dc52eae72dee4a377a15e508910", "html_url": "https://github.com/rust-lang/rust/commit/30b536e2c5ea9dc52eae72dee4a377a15e508910"}], "stats": {"total": 36, "additions": 16, "deletions": 20}, "files": [{"sha": "b3ec1638fda741e3680a70960377c66e3b41c4c7", "filename": "src/ci/docker/host-x86_64/x86_64-gnu-tools/browser-ui-test.version", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4a4c07a9e027301073461599c610c3ce4e424d25/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-tools%2Fbrowser-ui-test.version", "raw_url": "https://github.com/rust-lang/rust/raw/4a4c07a9e027301073461599c610c3ce4e424d25/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-tools%2Fbrowser-ui-test.version", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fx86_64-gnu-tools%2Fbrowser-ui-test.version?ref=4a4c07a9e027301073461599c610c3ce4e424d25", "patch": "@@ -1 +1 @@\n-0.9.2\n\\ No newline at end of file\n+0.9.3\n\\ No newline at end of file"}, {"sha": "81f961992b6f15a97bb15fc56d9f425ed3bc2a07", "filename": "src/librustdoc/html/render/context.rs", "status": "modified", "additions": 13, "deletions": 3, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/4a4c07a9e027301073461599c610c3ce4e424d25/src%2Flibrustdoc%2Fhtml%2Frender%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4a4c07a9e027301073461599c610c3ce4e424d25/src%2Flibrustdoc%2Fhtml%2Frender%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fcontext.rs?ref=4a4c07a9e027301073461599c610c3ce4e424d25", "patch": "@@ -596,9 +596,19 @@ impl<'tcx> FormatRenderer<'tcx> for Context<'tcx> {\n             |buf: &mut Buffer| {\n                 write!(\n                     buf,\n-                    \"<link rel=\\\"stylesheet\\\" type=\\\"text/css\\\" \\\n-                        href=\\\"{root_path}settings{suffix}.css\\\">\\\n-                    <script defer src=\\\"{root_path}settings{suffix}.js\\\"></script>\",\n+                    \"<div class=\\\"main-heading\\\">\\\n+                     <h1 class=\\\"fqn\\\">\\\n+                         <span class=\\\"in-band\\\">Rustdoc settings</span>\\\n+                     </h1>\\\n+                     <span class=\\\"out-of-band\\\">\\\n+                         <a id=\\\"back\\\" href=\\\"javascript:void(0)\\\" onclick=\\\"history.back();\\\">\\\n+                            Back\\\n+                        </a>\\\n+                     </span>\\\n+                     </div>\\\n+                     <link rel=\\\"stylesheet\\\" type=\\\"text/css\\\" \\\n+                         href=\\\"{root_path}settings{suffix}.css\\\">\\\n+                     <script defer src=\\\"{root_path}settings{suffix}.js\\\"></script>\",\n                     root_path = page.static_root_path.unwrap_or(\"\"),\n                     suffix = page.resource_suffix,\n                 )"}, {"sha": "8770cc3f3b1490b422d0a94d4fbc055b034ebc49", "filename": "src/librustdoc/html/static/js/settings.js", "status": "modified", "additions": 2, "deletions": 16, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/4a4c07a9e027301073461599c610c3ce4e424d25/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js", "raw_url": "https://github.com/rust-lang/rust/raw/4a4c07a9e027301073461599c610c3ce4e424d25/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js?ref=4a4c07a9e027301073461599c610c3ce4e424d25", "patch": "@@ -206,22 +206,8 @@\n         ];\n \n         // Then we build the DOM.\n-        let innerHTML = \"\";\n-        let elementKind = \"div\";\n-\n-        if (isSettingsPage) {\n-            elementKind = \"section\";\n-            innerHTML = `<div class=\"main-heading\">\n-                <h1 class=\"fqn\">\n-                    <span class=\"in-band\">Rustdoc settings</span>\n-                </h1>\n-                <span class=\"out-of-band\">\n-                    <a id=\"back\" href=\"javascript:void(0)\" onclick=\"history.back();\">Back</a>\n-                </span>\n-                </div>`;\n-        }\n-        innerHTML += `<div class=\"settings\">${buildSettingsPageSections(settings)}</div>`;\n-\n+        const elementKind = isSettingsPage ? \"section\" : \"div\";\n+        const innerHTML = `<div class=\"settings\">${buildSettingsPageSections(settings)}</div>`;\n         const el = document.createElement(elementKind);\n         el.id = \"settings\";\n         el.innerHTML = innerHTML;"}]}