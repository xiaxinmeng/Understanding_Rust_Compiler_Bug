{"sha": "26b2fa052fd25483c73709981deaa78f60cc6ac4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI2YjJmYTA1MmZkMjU0ODNjNzM3MDk5ODFkZWFhNzhmNjBjYzZhYzQ=", "commit": {"author": {"name": "Keegan McAllister", "email": "mcallister.keegan@gmail.com", "date": "2014-06-21T01:36:21Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2014-06-25T00:23:21Z"}, "message": "Allow splicing more things in quotes", "tree": {"sha": "2b55996564bb09e3c458b3a1b9a54a88453dcc52", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2b55996564bb09e3c458b3a1b9a54a88453dcc52"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/26b2fa052fd25483c73709981deaa78f60cc6ac4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/26b2fa052fd25483c73709981deaa78f60cc6ac4", "html_url": "https://github.com/rust-lang/rust/commit/26b2fa052fd25483c73709981deaa78f60cc6ac4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/26b2fa052fd25483c73709981deaa78f60cc6ac4/comments", "author": {"login": "kmcallister", "id": 444997, "node_id": "MDQ6VXNlcjQ0NDk5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/444997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kmcallister", "html_url": "https://github.com/kmcallister", "followers_url": "https://api.github.com/users/kmcallister/followers", "following_url": "https://api.github.com/users/kmcallister/following{/other_user}", "gists_url": "https://api.github.com/users/kmcallister/gists{/gist_id}", "starred_url": "https://api.github.com/users/kmcallister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kmcallister/subscriptions", "organizations_url": "https://api.github.com/users/kmcallister/orgs", "repos_url": "https://api.github.com/users/kmcallister/repos", "events_url": "https://api.github.com/users/kmcallister/events{/privacy}", "received_events_url": "https://api.github.com/users/kmcallister/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4e26e2d8ca0a389280cf9d46297043df9a63ce06", "url": "https://api.github.com/repos/rust-lang/rust/commits/4e26e2d8ca0a389280cf9d46297043df9a63ce06", "html_url": "https://github.com/rust-lang/rust/commit/4e26e2d8ca0a389280cf9d46297043df9a63ce06"}], "stats": {"total": 16, "additions": 16, "deletions": 0}, "files": [{"sha": "9174bb65b248b062a77ab09b313e9ae75ab62926", "filename": "src/libsyntax/ext/quote.rs", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/26b2fa052fd25483c73709981deaa78f60cc6ac4/src%2Flibsyntax%2Fext%2Fquote.rs", "raw_url": "https://github.com/rust-lang/rust/raw/26b2fa052fd25483c73709981deaa78f60cc6ac4/src%2Flibsyntax%2Fext%2Fquote.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fext%2Fquote.rs?ref=26b2fa052fd25483c73709981deaa78f60cc6ac4", "patch": "@@ -32,6 +32,7 @@ use std::gc::Gc;\n \n pub mod rt {\n     use ast;\n+    use codemap::Spanned;\n     use ext::base::ExtCtxt;\n     use parse::token;\n     use parse;\n@@ -48,12 +49,25 @@ pub mod rt {\n         fn to_tokens(&self, _cx: &ExtCtxt) -> Vec<TokenTree> ;\n     }\n \n+    impl ToTokens for TokenTree {\n+        fn to_tokens(&self, _cx: &ExtCtxt) -> Vec<TokenTree> {\n+            vec!(self.clone())\n+        }\n+    }\n+\n     impl ToTokens for Vec<TokenTree> {\n         fn to_tokens(&self, _cx: &ExtCtxt) -> Vec<TokenTree> {\n             (*self).clone()\n         }\n     }\n \n+    impl<T: ToTokens> ToTokens for Spanned<T> {\n+        fn to_tokens(&self, cx: &ExtCtxt) -> Vec<TokenTree> {\n+            // FIXME: use the span?\n+            self.node.to_tokens(cx)\n+        }\n+    }\n+\n     /* Should be (when bugs in default methods are fixed):\n \n     trait ToSource : ToTokens {\n@@ -121,6 +135,7 @@ pub mod rt {\n     impl_to_source!(Generics, generics_to_str)\n     impl_to_source!(Gc<ast::Item>, item_to_str)\n     impl_to_source!(Gc<ast::Expr>, expr_to_str)\n+    impl_to_source!(Gc<ast::Pat>, pat_to_str)\n     impl_to_source_slice!(ast::Ty, \", \")\n     impl_to_source_slice!(Gc<ast::Item>, \"\\n\\n\")\n \n@@ -207,6 +222,7 @@ pub mod rt {\n \n     impl_to_tokens!(ast::Ident)\n     impl_to_tokens!(Gc<ast::Item>)\n+    impl_to_tokens!(Gc<ast::Pat>)\n     impl_to_tokens_lifetime!(&'a [Gc<ast::Item>])\n     impl_to_tokens!(ast::Ty)\n     impl_to_tokens_lifetime!(&'a [ast::Ty])"}]}