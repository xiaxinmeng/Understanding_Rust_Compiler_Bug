{"sha": "7a9ba240a07e7e9494fa53b0001282d795d1be52", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdhOWJhMjQwYTA3ZTdlOTQ5NGZhNTNiMDAwMTI4MmQ3OTVkMWJlNTI=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-01-16T07:01:05Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-01-16T09:07:42Z"}, "message": "rustdoc: Rename type rustdoc to gen::ctxt", "tree": {"sha": "0a1eb8ce7d4d0b46829b9fee3e3ff5a4c4422c39", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0a1eb8ce7d4d0b46829b9fee3e3ff5a4c4422c39"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7a9ba240a07e7e9494fa53b0001282d795d1be52", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7a9ba240a07e7e9494fa53b0001282d795d1be52", "html_url": "https://github.com/rust-lang/rust/commit/7a9ba240a07e7e9494fa53b0001282d795d1be52", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7a9ba240a07e7e9494fa53b0001282d795d1be52/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "906a7c217454710c866f4593cecd6ba9438d5a8b", "url": "https://api.github.com/repos/rust-lang/rust/commits/906a7c217454710c866f4593cecd6ba9438d5a8b", "html_url": "https://github.com/rust-lang/rust/commit/906a7c217454710c866f4593cecd6ba9438d5a8b"}], "stats": {"total": 43, "additions": 19, "deletions": 24}, "files": [{"sha": "b6197880dcfc3836da9d45dee152ed7ff592491f", "filename": "src/rustdoc/gen.rs", "status": "modified", "additions": 14, "deletions": 14, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/7a9ba240a07e7e9494fa53b0001282d795d1be52/src%2Frustdoc%2Fgen.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7a9ba240a07e7e9494fa53b0001282d795d1be52/src%2Frustdoc%2Fgen.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Fgen.rs?ref=7a9ba240a07e7e9494fa53b0001282d795d1be52", "patch": "@@ -1,4 +1,4 @@\n-type rustdoc = {\n+type ctxt = {\n     ps: pprust::ps,\n     w: io::writer\n };\n@@ -8,8 +8,8 @@ type rustdoc = {\n   args(rd = \"Rustdoc context\",\n        name = \"Crate name\")\n )]\n-fn write_header(rd: rustdoc, name: str) {\n-    rd.w.write_line(\"# Crate \" + name);\n+fn write_header(ctxt: ctxt, name: str) {\n+    ctxt.w.write_line(\"# Crate \" + name);\n }\n \n #[doc(\n@@ -19,30 +19,30 @@ fn write_header(rd: rustdoc, name: str) {\n        doc = \"Function docs extracted from attributes\",\n        _fn = \"AST object representing this function\")\n )]\n-fn write_fndoc(rd: rustdoc, ident: str, doc: doc::fndoc, decl: ast::fn_decl) {\n-    rd.w.write_line(\"## Function `\" + ident + \"`\");\n-    rd.w.write_line(doc.brief);\n+fn write_fndoc(ctxt: ctxt, ident: str, doc: doc::fndoc, decl: ast::fn_decl) {\n+    ctxt.w.write_line(\"## Function `\" + ident + \"`\");\n+    ctxt.w.write_line(doc.brief);\n     alt doc.desc {\n         some(_d) {\n-            rd.w.write_line(\"\");\n-            rd.w.write_line(_d);\n-            rd.w.write_line(\"\");\n+            ctxt.w.write_line(\"\");\n+            ctxt.w.write_line(_d);\n+            ctxt.w.write_line(\"\");\n         }\n         none. { }\n     }\n     for arg: ast::arg in decl.inputs {\n-        rd.w.write_str(\"### Argument `\" + arg.ident + \"`: \");\n-        rd.w.write_line(\"`\" + pprust::ty_to_str(arg.ty) + \"`\");\n+        ctxt.w.write_str(\"### Argument `\" + arg.ident + \"`: \");\n+        ctxt.w.write_line(\"`\" + pprust::ty_to_str(arg.ty) + \"`\");\n         alt doc.args.find(arg.ident) {\n             some(_d) {\n-                rd.w.write_line(_d);\n+                ctxt.w.write_line(_d);\n             }\n             none. { }\n         };\n     }\n-    rd.w.write_line(\"### Returns `\" + pprust::ty_to_str(decl.output) + \"`\");\n+    ctxt.w.write_line(\"### Returns `\" + pprust::ty_to_str(decl.output) + \"`\");\n     alt doc.return {\n-        some(_r) { rd.w.write_line(_r); }\n+        some(_r) { ctxt.w.write_line(_r); }\n         none. { }\n     }\n }"}, {"sha": "58c2519b664fcdc2cc9dfa99c8151fecbdcc8f5c", "filename": "src/rustdoc/rustdoc.rs", "status": "modified", "additions": 5, "deletions": 10, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/7a9ba240a07e7e9494fa53b0001282d795d1be52/src%2Frustdoc%2Frustdoc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7a9ba240a07e7e9494fa53b0001282d795d1be52/src%2Frustdoc%2Frustdoc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Frustdoc.rs?ref=7a9ba240a07e7e9494fa53b0001282d795d1be52", "patch": "@@ -17,23 +17,18 @@ import std::io;\n import io::writer_util;\n import std::map;\n \n-type rustdoc = {\n-    ps: pprust::ps,\n-    w: io::writer\n-};\n-\n #[doc(\n   brief = \"Documents a single crate item.\",\n   args(rd = \"Rustdoc context\",\n        item = \"AST item to document\")\n )]\n-fn doc_item(rd: rustdoc, item: @ast::item) {\n+fn doc_item(ctxt: gen::ctxt, item: @ast::item) {\n     let _fndoc0 = attr_parser::parse_fn(item.ident, item.attrs);\n \n     alt item.node {\n         ast::item_const(ty, expr) { }\n         ast::item_fn(decl, _, _) {\n-            gen::write_fndoc(rd, item.ident, _fndoc0, decl);\n+            gen::write_fndoc(ctxt, item.ident, _fndoc0, decl);\n         }\n         ast::item_mod(_mod) { }\n         ast::item_ty(ty, typarams) { }\n@@ -59,11 +54,11 @@ fn main(argv: [str]) {\n     let crate = parse::from_file(argv[1]);\n \n     let w = io::stdout();\n-    let rd = { ps: pprust::rust_printer(w), w: w };\n-    gen::write_header(rd, argv[1]);\n+    let ctxt = { ps: pprust::rust_printer(w), w: w };\n+    gen::write_header(ctxt, argv[1]);\n \n     let v = visit::mk_simple_visitor(@{\n-        visit_item: bind doc_item(rd, _)\n+        visit_item: bind doc_item(ctxt, _)\n         with *visit::default_simple_visitor()});\n     visit::visit_crate(*crate, (), v);\n }"}]}