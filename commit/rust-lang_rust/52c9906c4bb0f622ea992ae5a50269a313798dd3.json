{"sha": "52c9906c4bb0f622ea992ae5a50269a313798dd3", "node_id": "C_kwDOAAsO6NoAKDUyYzk5MDZjNGJiMGY2MjJlYTk5MmFlNWE1MDI2OWEzMTM3OThkZDM", "commit": {"author": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-06-19T23:27:29Z"}, "committer": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-06-19T23:46:59Z"}, "message": "Use `Span::eq_ctxt` method instead of `.ctxt() == .ctxt()`", "tree": {"sha": "165aef22bee6d4ce1c29c19ca46e8fc99440036b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/165aef22bee6d4ce1c29c19ca46e8fc99440036b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/52c9906c4bb0f622ea992ae5a50269a313798dd3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/52c9906c4bb0f622ea992ae5a50269a313798dd3", "html_url": "https://github.com/rust-lang/rust/commit/52c9906c4bb0f622ea992ae5a50269a313798dd3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/52c9906c4bb0f622ea992ae5a50269a313798dd3/comments", "author": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2c3bb42ebd86247ea5d2fb4daa51d9ada3f6ae61", "url": "https://api.github.com/repos/rust-lang/rust/commits/2c3bb42ebd86247ea5d2fb4daa51d9ada3f6ae61", "html_url": "https://github.com/rust-lang/rust/commit/2c3bb42ebd86247ea5d2fb4daa51d9ada3f6ae61"}], "stats": {"total": 21, "additions": 12, "deletions": 9}, "files": [{"sha": "4418b848e512a638d1b913e6e21a01c973a4c3a5", "filename": "compiler/rustc_middle/src/mir/spanview.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/52c9906c4bb0f622ea992ae5a50269a313798dd3/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fspanview.rs", "raw_url": "https://github.com/rust-lang/rust/raw/52c9906c4bb0f622ea992ae5a50269a313798dd3/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fspanview.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fspanview.rs?ref=52c9906c4bb0f622ea992ae5a50269a313798dd3", "patch": "@@ -667,7 +667,7 @@ fn trim_span_hi(span: Span, to_pos: BytePos) -> Span {\n fn fn_span<'tcx>(tcx: TyCtxt<'tcx>, def_id: DefId) -> Span {\n     let fn_decl_span = tcx.def_span(def_id);\n     if let Some(body_span) = hir_body(tcx, def_id).map(|hir_body| hir_body.value.span) {\n-        if fn_decl_span.ctxt() == body_span.ctxt() { fn_decl_span.to(body_span) } else { body_span }\n+        if fn_decl_span.eq_ctxt(body_span) { fn_decl_span.to(body_span) } else { body_span }\n     } else {\n         fn_decl_span\n     }"}, {"sha": "3e5b4b02f6367a1c5bc90b173059aa6b0a6a453d", "filename": "compiler/rustc_mir_build/src/thir/pattern/check_match.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/52c9906c4bb0f622ea992ae5a50269a313798dd3/compiler%2Frustc_mir_build%2Fsrc%2Fthir%2Fpattern%2Fcheck_match.rs", "raw_url": "https://github.com/rust-lang/rust/raw/52c9906c4bb0f622ea992ae5a50269a313798dd3/compiler%2Frustc_mir_build%2Fsrc%2Fthir%2Fpattern%2Fcheck_match.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_build%2Fsrc%2Fthir%2Fpattern%2Fcheck_match.rs?ref=52c9906c4bb0f622ea992ae5a50269a313798dd3", "patch": "@@ -803,7 +803,7 @@ fn non_exhaustive_match<'p, 'tcx>(\n     let mut suggestion = None;\n     let sm = cx.tcx.sess.source_map();\n     match arms {\n-        [] if sp.ctxt() == expr_span.ctxt() => {\n+        [] if sp.eq_ctxt(expr_span) => {\n             // Get the span for the empty match body `{}`.\n             let (indentation, more) = if let Some(snippet) = sm.indentation_before(sp) {\n                 (format!(\"\\n{}\", snippet), \"    \")\n@@ -830,7 +830,7 @@ fn non_exhaustive_match<'p, 'tcx>(\n                 \" \".to_string()\n             };\n             let comma = if matches!(only.body.kind, hir::ExprKind::Block(..))\n-                && only.span.ctxt() == only.body.span.ctxt()\n+                && only.span.eq_ctxt(only.body.span)\n             {\n                 \"\"\n             } else {\n@@ -841,10 +841,10 @@ fn non_exhaustive_match<'p, 'tcx>(\n                 format!(\"{}{}{} => todo!()\", comma, pre_indentation, pattern),\n             ));\n         }\n-        [.., prev, last] if prev.span.ctxt() == last.span.ctxt() => {\n+        [.., prev, last] if prev.span.eq_ctxt(last.span) => {\n             if let Ok(snippet) = sm.span_to_snippet(prev.span.between(last.span)) {\n                 let comma = if matches!(last.body.kind, hir::ExprKind::Block(..))\n-                    && last.span.ctxt() == last.body.span.ctxt()\n+                    && last.span.eq_ctxt(last.body.span)\n                 {\n                     \"\"\n                 } else {"}, {"sha": "782b620e28fe048c775c3cd82581414d59285424", "filename": "compiler/rustc_mir_transform/src/coverage/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/52c9906c4bb0f622ea992ae5a50269a313798dd3/compiler%2Frustc_mir_transform%2Fsrc%2Fcoverage%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/52c9906c4bb0f622ea992ae5a50269a313798dd3/compiler%2Frustc_mir_transform%2Fsrc%2Fcoverage%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_transform%2Fsrc%2Fcoverage%2Fmod.rs?ref=52c9906c4bb0f622ea992ae5a50269a313798dd3", "patch": "@@ -121,7 +121,7 @@ impl<'a, 'tcx> Instrumentor<'a, 'tcx> {\n \n         let source_file = source_map.lookup_source_file(body_span.lo());\n         let fn_sig_span = match some_fn_sig.filter(|fn_sig| {\n-            fn_sig.span.ctxt() == body_span.ctxt()\n+            fn_sig.span.eq_ctxt(body_span)\n                 && Lrc::ptr_eq(&source_file, &source_map.lookup_source_file(fn_sig.span.lo()))\n         }) {\n             Some(fn_sig) => fn_sig.span.with_hi(body_span.lo()),"}, {"sha": "82070b903256c05ad182fcfb559062049e379035", "filename": "compiler/rustc_mir_transform/src/coverage/spans.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/52c9906c4bb0f622ea992ae5a50269a313798dd3/compiler%2Frustc_mir_transform%2Fsrc%2Fcoverage%2Fspans.rs", "raw_url": "https://github.com/rust-lang/rust/raw/52c9906c4bb0f622ea992ae5a50269a313798dd3/compiler%2Frustc_mir_transform%2Fsrc%2Fcoverage%2Fspans.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_transform%2Fsrc%2Fcoverage%2Fspans.rs?ref=52c9906c4bb0f622ea992ae5a50269a313798dd3", "patch": "@@ -195,7 +195,7 @@ impl CoverageSpan {\n             .expn_span\n             .parent_callsite()\n             .unwrap_or_else(|| bug!(\"macro must have a parent\"))\n-            .ctxt() == body_span.ctxt()\n+            .eq_ctxt(body_span)\n         {\n             return Some(current_macro);\n         }"}, {"sha": "326cf2bd7e91f975c0a8e9e622c158d19c831b16", "filename": "compiler/rustc_resolve/src/late/diagnostics.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/52c9906c4bb0f622ea992ae5a50269a313798dd3/compiler%2Frustc_resolve%2Fsrc%2Flate%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/52c9906c4bb0f622ea992ae5a50269a313798dd3/compiler%2Frustc_resolve%2Fsrc%2Flate%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_resolve%2Fsrc%2Flate%2Fdiagnostics.rs?ref=52c9906c4bb0f622ea992ae5a50269a313798dd3", "patch": "@@ -1875,7 +1875,7 @@ impl<'a: 'ast, 'ast> LateResolutionVisitor<'a, '_, 'ast> {\n         let names = rib\n             .bindings\n             .iter()\n-            .filter(|(id, _)| id.span.ctxt() == label.span.ctxt())\n+            .filter(|(id, _)| id.span.eq_ctxt(label.span))\n             .map(|(id, _)| id.name)\n             .collect::<Vec<Symbol>>();\n "}, {"sha": "a329fa153207bbf7e208b5313c86133b70629254", "filename": "compiler/rustc_span/src/lib.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/52c9906c4bb0f622ea992ae5a50269a313798dd3/compiler%2Frustc_span%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/52c9906c4bb0f622ea992ae5a50269a313798dd3/compiler%2Frustc_span%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_span%2Fsrc%2Flib.rs?ref=52c9906c4bb0f622ea992ae5a50269a313798dd3", "patch": "@@ -537,6 +537,9 @@ impl Span {\n     pub fn ctxt(self) -> SyntaxContext {\n         self.data_untracked().ctxt\n     }\n+    pub fn eq_ctxt(self, other: Span) -> bool {\n+        self.data_untracked().ctxt == other.data_untracked().ctxt\n+    }\n     #[inline]\n     pub fn with_ctxt(self, ctxt: SyntaxContext) -> Span {\n         self.data_untracked().with_ctxt(ctxt)"}, {"sha": "2566cd791997aacfaf72beff5ad139b480acbf4b", "filename": "compiler/rustc_span/src/symbol.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/52c9906c4bb0f622ea992ae5a50269a313798dd3/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs", "raw_url": "https://github.com/rust-lang/rust/raw/52c9906c4bb0f622ea992ae5a50269a313798dd3/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_span%2Fsrc%2Fsymbol.rs?ref=52c9906c4bb0f622ea992ae5a50269a313798dd3", "patch": "@@ -1641,7 +1641,7 @@ impl Ident {\n \n impl PartialEq for Ident {\n     fn eq(&self, rhs: &Self) -> bool {\n-        self.name == rhs.name && self.span.ctxt() == rhs.span.ctxt()\n+        self.name == rhs.name && self.span.eq_ctxt(rhs.span)\n     }\n }\n "}]}