{"sha": "c0fc6a8b6b5bba6eed003fdc08e3af1967ab349d", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMwZmM2YThiNmI1YmJhNmVlZDAwM2ZkYzA4ZTNhZjE5NjdhYjM0OWQ=", "commit": {"author": {"name": "Oliver Schneider", "email": "git-spam-no-reply9815368754983@oli-obk.de", "date": "2018-03-06T13:07:52Z"}, "committer": {"name": "Oliver Schneider", "email": "git-spam-no-reply9815368754983@oli-obk.de", "date": "2018-03-08T07:35:39Z"}, "message": "simplify constant value pair field access", "tree": {"sha": "81258097b54e4395b08fea7c2d44bc39db40b7ae", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/81258097b54e4395b08fea7c2d44bc39db40b7ae"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c0fc6a8b6b5bba6eed003fdc08e3af1967ab349d", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEYFTdM4NKd7XQft77pp+NIls619kFAlqg58sACgkQpp+NIls6\n19n2Qw//R5ywqC6VLQDEygsEdVBuBENsHS8E/L7Df6zCrmh+D5hXBmgnkACI3c7t\nscDDqUkR+ex8wSqBPIqJmK0xUxGv1OG2XjBUSCt7T65XmS1tTY6t50sEjIgTnlGV\nzzzIZhJHqPSpp3bSpPCnO8BTRrrvSabFLenVn6NAz6yegpR33m8XJzwKlABRWN4E\n84KB7hCDhR1hpOn9TV59mHAo9TaVuluN+8fLeqp3HtZBa9L9bqK3ctt8Qg8kt0zC\n4Sg6bAl43jQ26JUQDulWkiz796VpadYjlIrKAI59KKl8lA0bPH5lFtJ/PyXGp7h/\n1GxG/mb9DLqVCSoeaW2o2nuUWzN6vURmdcvtP8fEVL9Ar9g9pQ+ZpN1oPiuy2Y7y\nDEv1bZLZCKI0XyuX/Fxrp8UzBSRlV6mqegTdRj7/NWWe9HysQwsvf2/cfuriLPwL\nrgVoEpScWx9xdUHh0GZXVDy1O8xj+FEvcaiYgVrA3USfV+tJTU+Xz0JBoYs07OGC\naMbA/0arQnX90oeuoBXsNzJscJma+Rx97jvqOV3Di6X8NBhpNKNGZlaJho4LIusN\nSgNZppuyW2685d5xusyJiuR3AESl6xybz7gi9CqdzmK+ywgT5normqz9kZR1x/PK\nbk6IBoJTOoYFdHTUqMnkOhtZ5Gt35MRWDAF1LpFfjEyEqJDnewU=\n=0LMn\n-----END PGP SIGNATURE-----", "payload": "tree 81258097b54e4395b08fea7c2d44bc39db40b7ae\nparent b5ace9a906d0a445420a0ff16f77ce967722ddc6\nauthor Oliver Schneider <git-spam-no-reply9815368754983@oli-obk.de> 1520341672 +0100\ncommitter Oliver Schneider <git-spam-no-reply9815368754983@oli-obk.de> 1520494539 +0100\n\nsimplify constant value pair field access\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c0fc6a8b6b5bba6eed003fdc08e3af1967ab349d", "html_url": "https://github.com/rust-lang/rust/commit/c0fc6a8b6b5bba6eed003fdc08e3af1967ab349d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c0fc6a8b6b5bba6eed003fdc08e3af1967ab349d/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b5ace9a906d0a445420a0ff16f77ce967722ddc6", "url": "https://api.github.com/repos/rust-lang/rust/commits/b5ace9a906d0a445420a0ff16f77ce967722ddc6", "html_url": "https://github.com/rust-lang/rust/commit/b5ace9a906d0a445420a0ff16f77ce967722ddc6"}], "stats": {"total": 7, "additions": 1, "deletions": 6}, "files": [{"sha": "f133d6e9c6dee847be829b68e1246284cc62091c", "filename": "src/librustc_mir/transform/const_prop.rs", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/c0fc6a8b6b5bba6eed003fdc08e3af1967ab349d/src%2Flibrustc_mir%2Ftransform%2Fconst_prop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c0fc6a8b6b5bba6eed003fdc08e3af1967ab349d/src%2Flibrustc_mir%2Ftransform%2Fconst_prop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Ftransform%2Fconst_prop.rs?ref=c0fc6a8b6b5bba6eed003fdc08e3af1967ab349d", "patch": "@@ -183,12 +183,7 @@ impl<'b, 'a, 'tcx:'b> ConstPropagator<'b, 'a, 'tcx> {\n                             trace!(\"layout computed\");\n                             use rustc_data_structures::indexed_vec::Idx;\n                             let field_index = field.index();\n-                            let val = if field_index == 0 {\n-                                a\n-                            } else {\n-                                assert_eq!(field_index, 1);\n-                                b\n-                            };\n+                            let val = [a, b][field_index];\n                             let field = base_layout.field(&*self, field_index).ok()?;\n                             trace!(\"projection resulted in: {:?}\", val);\n                             Some((Value::ByVal(val), field.ty, span))"}]}