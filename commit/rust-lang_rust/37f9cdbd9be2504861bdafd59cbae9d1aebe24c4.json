{"sha": "37f9cdbd9be2504861bdafd59cbae9d1aebe24c4", "node_id": "C_kwDOAAsO6NoAKDM3ZjljZGJkOWJlMjUwNDg2MWJkYWZkNTljYmFlOWQxYWViZTI0YzQ", "commit": {"author": {"name": "Joshua Nelson", "email": "jnelson@cloudflare.com", "date": "2022-06-08T03:21:28Z"}, "committer": {"name": "Joshua Nelson", "email": "jnelson@cloudflare.com", "date": "2022-06-08T03:21:28Z"}, "message": "Don't build the compiler before building rust-demangler\n\nThis saves a lot of time compiling.", "tree": {"sha": "bc24f19e9ac2fa6c17e5f2e78b484dd37e3cc81e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bc24f19e9ac2fa6c17e5f2e78b484dd37e3cc81e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/37f9cdbd9be2504861bdafd59cbae9d1aebe24c4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/37f9cdbd9be2504861bdafd59cbae9d1aebe24c4", "html_url": "https://github.com/rust-lang/rust/commit/37f9cdbd9be2504861bdafd59cbae9d1aebe24c4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/37f9cdbd9be2504861bdafd59cbae9d1aebe24c4/comments", "author": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7fe2c4b00dfbc33643e1af4b293eb057306a8339", "url": "https://api.github.com/repos/rust-lang/rust/commits/7fe2c4b00dfbc33643e1af4b293eb057306a8339", "html_url": "https://github.com/rust-lang/rust/commit/7fe2c4b00dfbc33643e1af4b293eb057306a8339"}], "stats": {"total": 8, "additions": 6, "deletions": 2}, "files": [{"sha": "905fa431d29d123f380522030b831875c25427b6", "filename": "src/bootstrap/tool.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/37f9cdbd9be2504861bdafd59cbae9d1aebe24c4/src%2Fbootstrap%2Ftool.rs", "raw_url": "https://github.com/rust-lang/rust/raw/37f9cdbd9be2504861bdafd59cbae9d1aebe24c4/src%2Fbootstrap%2Ftool.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftool.rs?ref=37f9cdbd9be2504861bdafd59cbae9d1aebe24c4", "patch": "@@ -692,6 +692,7 @@ macro_rules! tool_extended {\n        stable = $stable:expr,\n        $(in_tree = $in_tree:expr,)?\n        $(submodule = $submodule:literal,)?\n+       $(tool_std = $tool_std:literal,)?\n        $extra_deps:block;)+) => {\n         $(\n             #[derive(Debug, Clone, Hash, PartialEq, Eq)]\n@@ -740,7 +741,7 @@ macro_rules! tool_extended {\n                     compiler: $sel.compiler,\n                     target: $sel.target,\n                     tool: $tool_name,\n-                    mode: Mode::ToolRustc,\n+                    mode: if false $(|| $tool_std)? { Mode::ToolStd } else { Mode::ToolRustc },\n                     path: $path,\n                     extra_features: $sel.extra_features,\n                     is_optional_tool: true,\n@@ -774,7 +775,10 @@ tool_extended!((self, builder),\n         });\n         self.extra_features.push(\"clippy\".to_owned());\n     };\n-    RustDemangler, rust_demangler, \"src/tools/rust-demangler\", \"rust-demangler\", stable=false, in_tree=true, {};\n+    // FIXME: tool_std is not quite right, we shouldn't allow nightly features.\n+    // But `builder.cargo` doesn't know how to handle ToolBootstrap in stages other than 0,\n+    // and this is close enough for now.\n+    RustDemangler, rust_demangler, \"src/tools/rust-demangler\", \"rust-demangler\", stable=false, in_tree=true, tool_std=true, {};\n     Rustfmt, rustfmt, \"src/tools/rustfmt\", \"rustfmt\", stable=true, in_tree=true, {};\n     RustAnalyzer, rust_analyzer, \"src/tools/rust-analyzer/crates/rust-analyzer\", \"rust-analyzer\", stable=false, submodule=\"rust-analyzer\", {};\n );"}]}