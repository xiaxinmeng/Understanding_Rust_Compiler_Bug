{"sha": "58372af058c7e4f60dbc6bf9157338ea545e9753", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU4MzcyYWYwNThjN2U0ZjYwZGJjNmJmOTE1NzMzOGVhNTQ1ZTk3NTM=", "commit": {"author": {"name": "Jeffrey Seyfried", "email": "jeffrey.seyfried@gmail.com", "date": "2016-06-12T20:23:29Z"}, "committer": {"name": "Jeffrey Seyfried", "email": "jeffrey.seyfried@gmail.com", "date": "2016-06-16T03:55:57Z"}, "message": "Add test for `MultiItemModifier`s that add items", "tree": {"sha": "477c1f55f5bc5c43f3321ceae2cdc7ac4e30bef0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/477c1f55f5bc5c43f3321ceae2cdc7ac4e30bef0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/58372af058c7e4f60dbc6bf9157338ea545e9753", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/58372af058c7e4f60dbc6bf9157338ea545e9753", "html_url": "https://github.com/rust-lang/rust/commit/58372af058c7e4f60dbc6bf9157338ea545e9753", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/58372af058c7e4f60dbc6bf9157338ea545e9753/comments", "author": {"login": "jseyfried", "id": 8652869, "node_id": "MDQ6VXNlcjg2NTI4Njk=", "avatar_url": "https://avatars.githubusercontent.com/u/8652869?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jseyfried", "html_url": "https://github.com/jseyfried", "followers_url": "https://api.github.com/users/jseyfried/followers", "following_url": "https://api.github.com/users/jseyfried/following{/other_user}", "gists_url": "https://api.github.com/users/jseyfried/gists{/gist_id}", "starred_url": "https://api.github.com/users/jseyfried/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jseyfried/subscriptions", "organizations_url": "https://api.github.com/users/jseyfried/orgs", "repos_url": "https://api.github.com/users/jseyfried/repos", "events_url": "https://api.github.com/users/jseyfried/events{/privacy}", "received_events_url": "https://api.github.com/users/jseyfried/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jseyfried", "id": 8652869, "node_id": "MDQ6VXNlcjg2NTI4Njk=", "avatar_url": "https://avatars.githubusercontent.com/u/8652869?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jseyfried", "html_url": "https://github.com/jseyfried", "followers_url": "https://api.github.com/users/jseyfried/followers", "following_url": "https://api.github.com/users/jseyfried/following{/other_user}", "gists_url": "https://api.github.com/users/jseyfried/gists{/gist_id}", "starred_url": "https://api.github.com/users/jseyfried/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jseyfried/subscriptions", "organizations_url": "https://api.github.com/users/jseyfried/orgs", "repos_url": "https://api.github.com/users/jseyfried/repos", "events_url": "https://api.github.com/users/jseyfried/events{/privacy}", "received_events_url": "https://api.github.com/users/jseyfried/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ac1a1d32f60c9bff72bf77d5d94ad8ce36106e00", "url": "https://api.github.com/repos/rust-lang/rust/commits/ac1a1d32f60c9bff72bf77d5d94ad8ce36106e00", "html_url": "https://github.com/rust-lang/rust/commit/ac1a1d32f60c9bff72bf77d5d94ad8ce36106e00"}], "stats": {"total": 19, "additions": 11, "deletions": 8}, "files": [{"sha": "a22c3ba48492618347b1c04938f708635e118a3b", "filename": "src/test/run-pass-fulldeps/auxiliary/macro_crate_test.rs", "status": "modified", "additions": 9, "deletions": 8, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/58372af058c7e4f60dbc6bf9157338ea545e9753/src%2Ftest%2Frun-pass-fulldeps%2Fauxiliary%2Fmacro_crate_test.rs", "raw_url": "https://github.com/rust-lang/rust/raw/58372af058c7e4f60dbc6bf9157338ea545e9753/src%2Ftest%2Frun-pass-fulldeps%2Fauxiliary%2Fmacro_crate_test.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-fulldeps%2Fauxiliary%2Fmacro_crate_test.rs?ref=58372af058c7e4f60dbc6bf9157338ea545e9753", "patch": "@@ -62,15 +62,16 @@ fn expand_identity(cx: &mut ExtCtxt, _span: Span, tts: &[TokenTree])\n fn expand_into_foo_multi(cx: &mut ExtCtxt,\n                          sp: Span,\n                          attr: &MetaItem,\n-                         it: Annotatable) -> Annotatable {\n+                         it: Annotatable) -> Vec<Annotatable> {\n     match it {\n-        Annotatable::Item(it) => {\n+        Annotatable::Item(it) => vec![\n             Annotatable::Item(P(Item {\n                 attrs: it.attrs.clone(),\n                 ..(*quote_item!(cx, enum Foo2 { Bar2, Baz2 }).unwrap()).clone()\n-            }))\n-        }\n-        Annotatable::ImplItem(it) => {\n+            })),\n+            Annotatable::Item(quote_item!(cx, enum Foo3 { Bar }).unwrap()),\n+        ],\n+        Annotatable::ImplItem(it) => vec![\n             quote_item!(cx, impl X { fn foo(&self) -> i32 { 42 } }).unwrap().and_then(|i| {\n                 match i.node {\n                     ItemKind::Impl(_, _, _, _, _, mut items) => {\n@@ -79,8 +80,8 @@ fn expand_into_foo_multi(cx: &mut ExtCtxt,\n                     _ => unreachable!(\"impl parsed to something other than impl\")\n                 }\n             })\n-        }\n-        Annotatable::TraitItem(it) => {\n+        ],\n+        Annotatable::TraitItem(it) => vec![\n             quote_item!(cx, trait X { fn foo(&self) -> i32 { 0 } }).unwrap().and_then(|i| {\n                 match i.node {\n                     ItemKind::Trait(_, _, _, mut items) => {\n@@ -89,7 +90,7 @@ fn expand_into_foo_multi(cx: &mut ExtCtxt,\n                     _ => unreachable!(\"trait parsed to something other than trait\")\n                 }\n             })\n-        }\n+        ],\n     }\n }\n "}, {"sha": "d17adff007c6335b440c4c42063a753f99f2c91c", "filename": "src/test/run-pass-fulldeps/macro-crate.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/58372af058c7e4f60dbc6bf9157338ea545e9753/src%2Ftest%2Frun-pass-fulldeps%2Fmacro-crate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/58372af058c7e4f60dbc6bf9157338ea545e9753/src%2Ftest%2Frun-pass-fulldeps%2Fmacro-crate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass-fulldeps%2Fmacro-crate.rs?ref=58372af058c7e4f60dbc6bf9157338ea545e9753", "patch": "@@ -40,6 +40,8 @@ pub fn main() {\n     assert_eq!(Foo2::Bar2, Foo2::Bar2);\n     test(None::<Foo2>);\n \n+    let _ = Foo3::Bar;\n+\n     let x = 10i32;\n     assert_eq!(x.foo(), 42);\n     let x = 10u8;"}]}