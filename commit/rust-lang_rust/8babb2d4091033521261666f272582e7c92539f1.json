{"sha": "8babb2d4091033521261666f272582e7c92539f1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhiYWJiMmQ0MDkxMDMzNTIxMjYxNjY2ZjI3MjU4MmU3YzkyNTM5ZjE=", "commit": {"author": {"name": "Martin Carton", "email": "cartonmartin+github@gmail.com", "date": "2016-10-01T13:01:43Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2016-10-01T13:01:43Z"}, "message": "Merge pull request #1250 from elliottneilclark/explicit_into_iter\n\nAdd a lint to warn about un-necessary .into_iter()", "tree": {"sha": "51bddb0b9b58543e63f57abc7f458a461264c800", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/51bddb0b9b58543e63f57abc7f458a461264c800"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8babb2d4091033521261666f272582e7c92539f1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8babb2d4091033521261666f272582e7c92539f1", "html_url": "https://github.com/rust-lang/rust/commit/8babb2d4091033521261666f272582e7c92539f1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8babb2d4091033521261666f272582e7c92539f1/comments", "author": {"login": "mcarton", "id": 3751788, "node_id": "MDQ6VXNlcjM3NTE3ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/3751788?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mcarton", "html_url": "https://github.com/mcarton", "followers_url": "https://api.github.com/users/mcarton/followers", "following_url": "https://api.github.com/users/mcarton/following{/other_user}", "gists_url": "https://api.github.com/users/mcarton/gists{/gist_id}", "starred_url": "https://api.github.com/users/mcarton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mcarton/subscriptions", "organizations_url": "https://api.github.com/users/mcarton/orgs", "repos_url": "https://api.github.com/users/mcarton/repos", "events_url": "https://api.github.com/users/mcarton/events{/privacy}", "received_events_url": "https://api.github.com/users/mcarton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9807c47e42071590d8c34bb34fce407e3ada4aa4", "url": "https://api.github.com/repos/rust-lang/rust/commits/9807c47e42071590d8c34bb34fce407e3ada4aa4", "html_url": "https://github.com/rust-lang/rust/commit/9807c47e42071590d8c34bb34fce407e3ada4aa4"}, {"sha": "2e2052a747a87288ffb3d35c540af5f2c46867ef", "url": "https://api.github.com/repos/rust-lang/rust/commits/2e2052a747a87288ffb3d35c540af5f2c46867ef", "html_url": "https://github.com/rust-lang/rust/commit/2e2052a747a87288ffb3d35c540af5f2c46867ef"}], "stats": {"total": 44, "additions": 42, "deletions": 2}, "files": [{"sha": "cca4245bfa7328fcf87fb97c70764b6c69c06ba3", "filename": "CHANGELOG.md", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/8babb2d4091033521261666f272582e7c92539f1/CHANGELOG.md", "raw_url": "https://github.com/rust-lang/rust/raw/8babb2d4091033521261666f272582e7c92539f1/CHANGELOG.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/CHANGELOG.md?ref=8babb2d4091033521261666f272582e7c92539f1", "patch": "@@ -1,6 +1,9 @@\n # Change Log\n All notable changes to this project will be documented in this file.\n \n+## 0.0.93 \u2014 ?\n+* New lint: [`explicit_into_iter_loop`]\n+\n ## 0.0.92 \u2014 2016-09-30\n * Rustup to *rustc 1.14.0-nightly (289f3a4ca 2016-09-29)*\n \n@@ -230,6 +233,7 @@ All notable changes to this project will be documented in this file.\n [`eval_order_dependence`]: https://github.com/Manishearth/rust-clippy/wiki#eval_order_dependence\n [`expl_impl_clone_on_copy`]: https://github.com/Manishearth/rust-clippy/wiki#expl_impl_clone_on_copy\n [`explicit_counter_loop`]: https://github.com/Manishearth/rust-clippy/wiki#explicit_counter_loop\n+[`explicit_into_iter_loop`]: https://github.com/Manishearth/rust-clippy/wiki#explicit_into_iter_loop\n [`explicit_iter_loop`]: https://github.com/Manishearth/rust-clippy/wiki#explicit_iter_loop\n [`extend_from_slice`]: https://github.com/Manishearth/rust-clippy/wiki#extend_from_slice\n [`filter_map`]: https://github.com/Manishearth/rust-clippy/wiki#filter_map"}, {"sha": "7d6ed96681a5701c384339f3b6a57086137229e2", "filename": "README.md", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/8babb2d4091033521261666f272582e7c92539f1/README.md", "raw_url": "https://github.com/rust-lang/rust/raw/8babb2d4091033521261666f272582e7c92539f1/README.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/README.md?ref=8babb2d4091033521261666f272582e7c92539f1", "patch": "@@ -174,7 +174,7 @@ You can check out this great service at [clippy.bashy.io](https://clippy.bashy.i\n \n ## Lints\n \n-There are 171 lints included in this crate:\n+There are 172 lints included in this crate:\n \n name                                                                                                                 | default | triggers on\n ---------------------------------------------------------------------------------------------------------------------|---------|----------------------------------------------------------------------------------------------------------------------------------\n@@ -220,6 +220,7 @@ name\n [eval_order_dependence](https://github.com/Manishearth/rust-clippy/wiki#eval_order_dependence)                       | warn    | whether a variable read occurs before a write depends on sub-expression evaluation order\n [expl_impl_clone_on_copy](https://github.com/Manishearth/rust-clippy/wiki#expl_impl_clone_on_copy)                   | warn    | implementing `Clone` explicitly on `Copy` types\n [explicit_counter_loop](https://github.com/Manishearth/rust-clippy/wiki#explicit_counter_loop)                       | warn    | for-looping with an explicit counter when `_.enumerate()` would do\n+[explicit_into_iter_loop](https://github.com/Manishearth/rust-clippy/wiki#explicit_into_iter_loop)                   | warn    | for-looping over `_.into_iter()` when `_` would do\n [explicit_iter_loop](https://github.com/Manishearth/rust-clippy/wiki#explicit_iter_loop)                             | warn    | for-looping over `_.iter()` or `_.iter_mut()` when `&_` or `&mut _` would do\n [extend_from_slice](https://github.com/Manishearth/rust-clippy/wiki#extend_from_slice)                               | warn    | `.extend_from_slice(_)` is a faster way to extend a Vec by a slice\n [filter_map](https://github.com/Manishearth/rust-clippy/wiki#filter_map)                                             | allow   | using combinations of `filter`, `map`, `filter_map` and `flat_map` which can usually be written as a single method call"}, {"sha": "fd42d91f41d9fb12ec040f844fda6c101a66f11f", "filename": "clippy_lints/src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/8babb2d4091033521261666f272582e7c92539f1/clippy_lints%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8babb2d4091033521261666f272582e7c92539f1/clippy_lints%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.rs?ref=8babb2d4091033521261666f272582e7c92539f1", "patch": "@@ -346,6 +346,7 @@ pub fn register_plugins(reg: &mut rustc_plugin::Registry) {\n         lifetimes::UNUSED_LIFETIMES,\n         loops::EMPTY_LOOP,\n         loops::EXPLICIT_COUNTER_LOOP,\n+        loops::EXPLICIT_INTO_ITER_LOOP,\n         loops::EXPLICIT_ITER_LOOP,\n         loops::FOR_KV_MAP,\n         loops::FOR_LOOP_OVER_OPTION,"}, {"sha": "fad72db74ed4a382d8f6668346aac330b504c600", "filename": "clippy_lints/src/loops.rs", "status": "modified", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/8babb2d4091033521261666f272582e7c92539f1/clippy_lints%2Fsrc%2Floops.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8babb2d4091033521261666f272582e7c92539f1/clippy_lints%2Fsrc%2Floops.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Floops.rs?ref=8babb2d4091033521261666f272582e7c92539f1", "patch": "@@ -58,6 +58,24 @@ declare_lint! {\n     \"for-looping over `_.iter()` or `_.iter_mut()` when `&_` or `&mut _` would do\"\n }\n \n+/// **What it does:** Checks for loops on `y.into_iter()` where `y` will do, and\n+/// suggests the latter.\n+///\n+/// **Why is this bad?** Readability.\n+///\n+/// **Known problems:** None\n+///\n+/// **Example:**\n+/// ```rust\n+/// // with `y` a `Vec` or slice:\n+/// for x in y.into_iter() { .. }\n+/// ```\n+declare_lint! {\n+    pub EXPLICIT_INTO_ITER_LOOP,\n+    Warn,\n+    \"for-looping over `_.into_iter()` when `_` would do\"\n+}\n+\n /// **What it does:** Checks for loops on `x.next()`.\n ///\n /// **Why is this bad?** `next()` returns either `Some(value)` if there was a\n@@ -275,6 +293,7 @@ impl LintPass for Pass {\n     fn get_lints(&self) -> LintArray {\n         lint_array!(NEEDLESS_RANGE_LOOP,\n                     EXPLICIT_ITER_LOOP,\n+                    EXPLICIT_INTO_ITER_LOOP,\n                     ITER_NEXT_LOOP,\n                     FOR_LOOP_OVER_RESULT,\n                     FOR_LOOP_OVER_OPTION,\n@@ -577,6 +596,16 @@ fn check_for_loop_arg(cx: &LateContext, pat: &Pat, arg: &Expr, expr: &Expr) {\n                                        object,\n                                        method_name));\n                 }\n+            } else if method_name.as_str() == \"into_iter\" && match_trait_method(cx, arg, &paths::INTO_ITERATOR) {\n+                    let object = snippet(cx, args[0].span, \"_\");\n+                    span_lint(cx,\n+                              EXPLICIT_INTO_ITER_LOOP,\n+                              expr.span,\n+                              &format!(\"it is more idiomatic to loop over `{}` instead of `{}.{}()`\",\n+                                       object,\n+                                       object,\n+                                       method_name));\n+\n             } else if method_name.as_str() == \"next\" && match_trait_method(cx, arg, &paths::ITERATOR) {\n                 span_lint(cx,\n                           ITER_NEXT_LOOP,"}, {"sha": "2f05ce37d334528fb9e3b106512a48d9af1aca30", "filename": "clippy_lints/src/utils/paths.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/8babb2d4091033521261666f272582e7c92539f1/clippy_lints%2Fsrc%2Futils%2Fpaths.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8babb2d4091033521261666f272582e7c92539f1/clippy_lints%2Fsrc%2Futils%2Fpaths.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Fpaths.rs?ref=8babb2d4091033521261666f272582e7c92539f1", "patch": "@@ -23,6 +23,7 @@ pub const HASH: [&'static str; 2] = [\"hash\", \"Hash\"];\n pub const HASHMAP: [&'static str; 5] = [\"std\", \"collections\", \"hash\", \"map\", \"HashMap\"];\n pub const HASHMAP_ENTRY: [&'static str; 5] = [\"std\", \"collections\", \"hash\", \"map\", \"Entry\"];\n pub const HASHSET: [&'static str; 5] = [\"std\", \"collections\", \"hash\", \"set\", \"HashSet\"];\n+pub const INTO_ITERATOR: [&'static str; 4] = [\"core\", \"iter\", \"traits\", \"IntoIterator\"];\n pub const IO_PRINT: [&'static str; 3] = [\"std\", \"io\", \"_print\"];\n pub const ITERATOR: [&'static str; 4] = [\"core\", \"iter\", \"iterator\", \"Iterator\"];\n pub const LINKED_LIST: [&'static str; 3] = [\"collections\", \"linked_list\", \"LinkedList\"];"}, {"sha": "22fcbff64b15586421b4290107267093e20cd24d", "filename": "tests/compile-fail/for_loop.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/8babb2d4091033521261666f272582e7c92539f1/tests%2Fcompile-fail%2Ffor_loop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8babb2d4091033521261666f272582e7c92539f1/tests%2Fcompile-fail%2Ffor_loop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-fail%2Ffor_loop.rs?ref=8babb2d4091033521261666f272582e7c92539f1", "patch": "@@ -87,7 +87,7 @@ impl Unrelated {\n     }\n }\n \n-#[deny(needless_range_loop, explicit_iter_loop, iter_next_loop, reverse_range_loop, explicit_counter_loop)]\n+#[deny(needless_range_loop, explicit_iter_loop, explicit_into_iter_loop, iter_next_loop, reverse_range_loop, explicit_counter_loop)]\n #[deny(unused_collect)]\n #[allow(linkedlist, shadow_unrelated, unnecessary_mut_passed, cyclomatic_complexity, similar_names)]\n #[allow(many_single_char_names)]\n@@ -294,6 +294,10 @@ fn main() {\n     for _v in vec.iter() { } //~ERROR it is more idiomatic to loop over `&vec`\n     for _v in vec.iter_mut() { } //~ERROR it is more idiomatic to loop over `&mut vec`\n \n+\n+    let out_vec = vec![1,2,3];\n+    for _v in out_vec.into_iter() { } //~ERROR it is more idiomatic to loop over `out_vec` instead of `out_vec.into_iter()`\n+\n     for _v in &vec { } // these are fine\n     for _v in &mut vec { } // these are fine\n "}]}