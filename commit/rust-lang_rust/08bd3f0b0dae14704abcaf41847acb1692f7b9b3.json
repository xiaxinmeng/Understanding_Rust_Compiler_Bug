{"sha": "08bd3f0b0dae14704abcaf41847acb1692f7b9b3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA4YmQzZjBiMGRhZTE0NzA0YWJjYWY0MTg0N2FjYjE2OTJmN2I5YjM=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-10-09T20:39:26Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-10-09T20:39:26Z"}, "message": "Auto merge of #6152 - flip1995:ice_6139, r=ebroto\n\nFixes ICE 6139\n\nFixes #6139\n\nKind of hacky, but this should be fine.\n\nchangelog: none", "tree": {"sha": "0da2f7cfedde805f82c226c43623504db7b7a437", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0da2f7cfedde805f82c226c43623504db7b7a437"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/08bd3f0b0dae14704abcaf41847acb1692f7b9b3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/08bd3f0b0dae14704abcaf41847acb1692f7b9b3", "html_url": "https://github.com/rust-lang/rust/commit/08bd3f0b0dae14704abcaf41847acb1692f7b9b3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/08bd3f0b0dae14704abcaf41847acb1692f7b9b3/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "947516f0184a7845577de1f0162f172b89965692", "url": "https://api.github.com/repos/rust-lang/rust/commits/947516f0184a7845577de1f0162f172b89965692", "html_url": "https://github.com/rust-lang/rust/commit/947516f0184a7845577de1f0162f172b89965692"}, {"sha": "a98f9d21fcdad85ae95d00d3931cf438f9d5a9de", "url": "https://api.github.com/repos/rust-lang/rust/commits/a98f9d21fcdad85ae95d00d3931cf438f9d5a9de", "html_url": "https://github.com/rust-lang/rust/commit/a98f9d21fcdad85ae95d00d3931cf438f9d5a9de"}], "stats": {"total": 12, "additions": 12, "deletions": 0}, "files": [{"sha": "a982b92bb2b3f498c45fd9ac74f9539555a39d10", "filename": "clippy_lints/src/types.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/08bd3f0b0dae14704abcaf41847acb1692f7b9b3/clippy_lints%2Fsrc%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/08bd3f0b0dae14704abcaf41847acb1692f7b9b3/clippy_lints%2Fsrc%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Ftypes.rs?ref=08bd3f0b0dae14704abcaf41847acb1692f7b9b3", "patch": "@@ -541,6 +541,11 @@ impl Types {\n                                 _ => None,\n                             });\n                             let ty_ty = hir_ty_to_ty(cx.tcx, boxed_ty);\n+                            // HACK(flip1995): This is a fix for an ICE occuring when `ty_ty` is a\n+                            // trait object with a lifetime, e.g. `dyn T<'_>`. Since trait objects\n+                            // don't have a known size, this shouldn't introduce FNs. But there\n+                            // should be a better solution.\n+                            if !matches!(ty_ty.kind(), ty::Dynamic(..));\n                             if ty_ty.is_sized(cx.tcx.at(ty.span), cx.param_env);\n                             if let Ok(ty_ty_size) = cx.layout_of(ty_ty).map(|l| l.size.bytes());\n                             if ty_ty_size <= self.vec_box_size_threshold;"}, {"sha": "f3966e47f5e808eda8fd3f75e0f40ec03b7c8ebc", "filename": "tests/ui/crashes/ice-6139.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/08bd3f0b0dae14704abcaf41847acb1692f7b9b3/tests%2Fui%2Fcrashes%2Fice-6139.rs", "raw_url": "https://github.com/rust-lang/rust/raw/08bd3f0b0dae14704abcaf41847acb1692f7b9b3/tests%2Fui%2Fcrashes%2Fice-6139.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcrashes%2Fice-6139.rs?ref=08bd3f0b0dae14704abcaf41847acb1692f7b9b3", "patch": "@@ -0,0 +1,7 @@\n+trait T<'a> {}\n+\n+fn foo(_: Vec<Box<dyn T<'_>>>) {}\n+\n+fn main() {\n+    foo(vec![]);\n+}"}]}