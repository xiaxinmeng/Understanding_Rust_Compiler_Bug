{"sha": "69a217f37c9e0cfdc2c21ee8c4e969f4a3771734", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY5YTIxN2YzN2M5ZTBjZmRjMmMyMWVlOGM0ZTk2OWY0YTM3NzE3MzQ=", "commit": {"author": {"name": "Jakub Bukaj", "email": "jakub@jakub.cc", "date": "2014-11-23T19:12:03Z"}, "committer": {"name": "Jakub Bukaj", "email": "jakub@jakub.cc", "date": "2014-11-23T19:12:03Z"}, "message": "rollup merge of #19239: jauhien/fix-libdir\n\nA fix for a windows problem pointed by @retep998 in the PR #16552.", "tree": {"sha": "08d59f2eb7bf95b3ca467c9df21cc96fc4f19f25", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/08d59f2eb7bf95b3ca467c9df21cc96fc4f19f25"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/69a217f37c9e0cfdc2c21ee8c4e969f4a3771734", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/69a217f37c9e0cfdc2c21ee8c4e969f4a3771734", "html_url": "https://github.com/rust-lang/rust/commit/69a217f37c9e0cfdc2c21ee8c4e969f4a3771734", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/69a217f37c9e0cfdc2c21ee8c4e969f4a3771734/comments", "author": null, "committer": null, "parents": [{"sha": "593af6213f46a82147ac3f0057cb40a648061ca9", "url": "https://api.github.com/repos/rust-lang/rust/commits/593af6213f46a82147ac3f0057cb40a648061ca9", "html_url": "https://github.com/rust-lang/rust/commit/593af6213f46a82147ac3f0057cb40a648061ca9"}, {"sha": "6ffb7f0132975d66df2bc360960cb641401fc06d", "url": "https://api.github.com/repos/rust-lang/rust/commits/6ffb7f0132975d66df2bc360960cb641401fc06d", "html_url": "https://github.com/rust-lang/rust/commit/6ffb7f0132975d66df2bc360960cb641401fc06d"}], "stats": {"total": 24, "additions": 14, "deletions": 10}, "files": [{"sha": "5ac398220592da8b58937692a171da9d1390ba3c", "filename": "configure", "status": "modified", "additions": 14, "deletions": 10, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/69a217f37c9e0cfdc2c21ee8c4e969f4a3771734/configure", "raw_url": "https://github.com/rust-lang/rust/raw/69a217f37c9e0cfdc2c21ee8c4e969f4a3771734/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=69a217f37c9e0cfdc2c21ee8c4e969f4a3771734", "patch": "@@ -546,22 +546,26 @@ CFG_TARGET=$(to_llvm_triple $CFG_TARGET)\n # there's no rpath. This is where the build system itself puts libraries;\n # --libdir is used to configure the installation directory.\n # FIXME: This needs to parameterized over target triples. Do it in platform.mk\n-CFG_LIBDIR_RELATIVE=lib\n if [ \"$CFG_OSTYPE\" = \"pc-windows-gnu\" ]\n then\n     CFG_LIBDIR_RELATIVE=bin\n-    CFG_LIBDIR=\"${CFG_PREFIX}/${CFG_LIBDIR_RELATIVE}\"\n else\n-    valopt libdir \"${CFG_PREFIX}/${CFG_LIBDIR_RELATIVE}\" \"install libraries (ignored on windows platform)\"\n+    CFG_LIBDIR_RELATIVE=lib\n+fi\n \n-    case \"$CFG_LIBDIR\" in\n-\t\"$CFG_PREFIX\"/*) CAT_INC=2;;\n-\t\"$CFG_PREFIX\"*)  CAT_INC=1;;\n-\t*)\n-            err \"libdir must begin with the prefix. Use --prefix to set it accordingly.\";;\n-    esac\n+valopt libdir \"${CFG_PREFIX}/${CFG_LIBDIR_RELATIVE}\" \"install libraries (do not set it on windows platform)\"\n+\n+case \"$CFG_LIBDIR\" in\n+    \"$CFG_PREFIX\"/*) CAT_INC=2;;\n+    \"$CFG_PREFIX\"*)  CAT_INC=1;;\n+    *)\n+        err \"libdir must begin with the prefix. Use --prefix to set it accordingly.\";;\n+esac\n+\n+CFG_LIBDIR_RELATIVE=`echo ${CFG_LIBDIR} | cut -c$((${#CFG_PREFIX}+${CAT_INC}))-`\n \n-    CFG_LIBDIR_RELATIVE=`echo ${CFG_LIBDIR} | cut -c$((${#CFG_PREFIX}+${CAT_INC}))-`\n+if [ \"$CFG_OSTYPE\" = \"pc-windows-gnu\" ] && [ \"$CFG_LIBDIR_RELATIVE\" != \"bin\" ]; then\n+    err \"libdir on windows should be set to 'bin'\"\n fi\n \n if [ $HELP -eq 1 ]"}]}