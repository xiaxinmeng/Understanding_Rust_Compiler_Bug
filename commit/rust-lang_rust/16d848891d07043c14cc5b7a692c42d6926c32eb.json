{"sha": "16d848891d07043c14cc5b7a692c42d6926c32eb", "node_id": "C_kwDOAAsO6NoAKDE2ZDg0ODg5MWQwNzA0M2MxNGNjNWI3YTY5MmM0MmQ2OTI2YzMyZWI", "commit": {"author": {"name": "Cameron Steffen", "email": "cam.steffen94@gmail.com", "date": "2022-01-10T00:16:05Z"}, "committer": {"name": "Cameron Steffen", "email": "cam.steffen94@gmail.com", "date": "2022-01-10T00:24:51Z"}, "message": "Combine internal features in clippy_utils", "tree": {"sha": "60f76ace2f5af7d31eed7ee1285111ae5f08497a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/60f76ace2f5af7d31eed7ee1285111ae5f08497a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/16d848891d07043c14cc5b7a692c42d6926c32eb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/16d848891d07043c14cc5b7a692c42d6926c32eb", "html_url": "https://github.com/rust-lang/rust/commit/16d848891d07043c14cc5b7a692c42d6926c32eb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/16d848891d07043c14cc5b7a692c42d6926c32eb/comments", "author": {"login": "camsteffen", "id": 5565418, "node_id": "MDQ6VXNlcjU1NjU0MTg=", "avatar_url": "https://avatars.githubusercontent.com/u/5565418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/camsteffen", "html_url": "https://github.com/camsteffen", "followers_url": "https://api.github.com/users/camsteffen/followers", "following_url": "https://api.github.com/users/camsteffen/following{/other_user}", "gists_url": "https://api.github.com/users/camsteffen/gists{/gist_id}", "starred_url": "https://api.github.com/users/camsteffen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/camsteffen/subscriptions", "organizations_url": "https://api.github.com/users/camsteffen/orgs", "repos_url": "https://api.github.com/users/camsteffen/repos", "events_url": "https://api.github.com/users/camsteffen/events{/privacy}", "received_events_url": "https://api.github.com/users/camsteffen/received_events", "type": "User", "site_admin": false}, "committer": {"login": "camsteffen", "id": 5565418, "node_id": "MDQ6VXNlcjU1NjU0MTg=", "avatar_url": "https://avatars.githubusercontent.com/u/5565418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/camsteffen", "html_url": "https://github.com/camsteffen", "followers_url": "https://api.github.com/users/camsteffen/followers", "following_url": "https://api.github.com/users/camsteffen/following{/other_user}", "gists_url": "https://api.github.com/users/camsteffen/gists{/gist_id}", "starred_url": "https://api.github.com/users/camsteffen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/camsteffen/subscriptions", "organizations_url": "https://api.github.com/users/camsteffen/orgs", "repos_url": "https://api.github.com/users/camsteffen/repos", "events_url": "https://api.github.com/users/camsteffen/events{/privacy}", "received_events_url": "https://api.github.com/users/camsteffen/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "59916952c9b7b820574b86aeca130d612fa15c1c", "url": "https://api.github.com/repos/rust-lang/rust/commits/59916952c9b7b820574b86aeca130d612fa15c1c", "html_url": "https://github.com/rust-lang/rust/commit/59916952c9b7b820574b86aeca130d612fa15c1c"}], "stats": {"total": 43, "additions": 21, "deletions": 22}, "files": [{"sha": "a14e530df4ec53dadd56048e96c60b1a00e1baf7", "filename": ".github/workflows/clippy.yml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/16d848891d07043c14cc5b7a692c42d6926c32eb/.github%2Fworkflows%2Fclippy.yml", "raw_url": "https://github.com/rust-lang/rust/raw/16d848891d07043c14cc5b7a692c42d6926c32eb/.github%2Fworkflows%2Fclippy.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fclippy.yml?ref=16d848891d07043c14cc5b7a692c42d6926c32eb", "patch": "@@ -59,7 +59,7 @@ jobs:\n       working-directory: clippy_lints\n \n     - name: Test clippy_utils\n-      run: cargo test --features deny-warnings,internal-lints,metadata-collector-lint\n+      run: cargo test --features deny-warnings,internal\n       working-directory: clippy_utils\n \n     - name: Test rustc_tools_util"}, {"sha": "06522606347d8d8945f7bd08bfc96ff7735ae183", "filename": ".github/workflows/clippy_bors.yml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/16d848891d07043c14cc5b7a692c42d6926c32eb/.github%2Fworkflows%2Fclippy_bors.yml", "raw_url": "https://github.com/rust-lang/rust/raw/16d848891d07043c14cc5b7a692c42d6926c32eb/.github%2Fworkflows%2Fclippy_bors.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fclippy_bors.yml?ref=16d848891d07043c14cc5b7a692c42d6926c32eb", "patch": "@@ -122,7 +122,7 @@ jobs:\n       working-directory: clippy_lints\n \n     - name: Test clippy_utils\n-      run: cargo test --features deny-warnings,internal-lints,metadata-collector-lint\n+      run: cargo test --features deny-warnings,internal\n       working-directory: clippy_utils\n \n     - name: Test rustc_tools_util"}, {"sha": "639138ac9c52d66fb75c7b65abdf00f7fc9b721c", "filename": "clippy_lints/Cargo.toml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/16d848891d07043c14cc5b7a692c42d6926c32eb/clippy_lints%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/16d848891d07043c14cc5b7a692c42d6926c32eb/clippy_lints%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2FCargo.toml?ref=16d848891d07043c14cc5b7a692c42d6926c32eb", "patch": "@@ -30,8 +30,8 @@ url = { version = \"2.2\", features = [\"serde\"] }\n [features]\n deny-warnings = [\"clippy_utils/deny-warnings\"]\n # build clippy with internal lints enabled, off by default\n-internal-lints = [\"clippy_utils/internal-lints\"]\n-metadata-collector-lint = [\"serde_json\", \"clippy_utils/metadata-collector-lint\"]\n+internal-lints = [\"clippy_utils/internal\"]\n+metadata-collector-lint = [\"serde_json\", \"clippy_utils/internal\"]\n \n [package.metadata.rust-analyzer]\n # This crate uses #[feature(rustc_private)]"}, {"sha": "565dd1faa3d7fe2d398a402e42c8ca8b51461645", "filename": "clippy_utils/Cargo.toml", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/16d848891d07043c14cc5b7a692c42d6926c32eb/clippy_utils%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/16d848891d07043c14cc5b7a692c42d6926c32eb/clippy_utils%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_utils%2FCargo.toml?ref=16d848891d07043c14cc5b7a692c42d6926c32eb", "patch": "@@ -11,8 +11,7 @@ rustc-semver = \"1.1\"\n \n [features]\n deny-warnings = []\n-internal-lints = []\n-metadata-collector-lint = []\n+internal = []\n \n [package.metadata.rust-analyzer]\n # This crate uses #[feature(rustc_private)]"}, {"sha": "ca222c3d669956d4b97eb5e4bd9f46ead9aa0d1d", "filename": "clippy_utils/src/diagnostics.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/16d848891d07043c14cc5b7a692c42d6926c32eb/clippy_utils%2Fsrc%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/16d848891d07043c14cc5b7a692c42d6926c32eb/clippy_utils%2Fsrc%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_utils%2Fsrc%2Fdiagnostics.rs?ref=16d848891d07043c14cc5b7a692c42d6926c32eb", "patch": "@@ -198,7 +198,7 @@ pub fn span_lint_hir_and_then(\n ///     |\n ///     = note: `-D fold-any` implied by `-D warnings`\n /// ```\n-#[cfg_attr(feature = \"internal-lints\", allow(clippy::collapsible_span_lint_calls))]\n+#[cfg_attr(feature = \"internal\", allow(clippy::collapsible_span_lint_calls))]\n pub fn span_lint_and_sugg<'a, T: LintContext>(\n     cx: &'a T,\n     lint: &'static Lint,"}, {"sha": "c06a1f826fa2a10a73f72acd291ebf7fb2b4de72", "filename": "clippy_utils/src/paths.rs", "status": "modified", "additions": 15, "deletions": 15, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/16d848891d07043c14cc5b7a692c42d6926c32eb/clippy_utils%2Fsrc%2Fpaths.rs", "raw_url": "https://github.com/rust-lang/rust/raw/16d848891d07043c14cc5b7a692c42d6926c32eb/clippy_utils%2Fsrc%2Fpaths.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_utils%2Fsrc%2Fpaths.rs?ref=16d848891d07043c14cc5b7a692c42d6926c32eb", "patch": "@@ -5,16 +5,16 @@\n //! See <https://github.com/rust-lang/rust-clippy/issues/5393> for more information.\n \n pub const ANY_TRAIT: [&str; 3] = [\"core\", \"any\", \"Any\"];\n-#[cfg(feature = \"metadata-collector-lint\")]\n+#[cfg(feature = \"internal\")]\n pub const APPLICABILITY: [&str; 2] = [\"rustc_lint_defs\", \"Applicability\"];\n-#[cfg(feature = \"metadata-collector-lint\")]\n+#[cfg(feature = \"internal\")]\n pub const APPLICABILITY_VALUES: [[&str; 3]; 4] = [\n     [\"rustc_lint_defs\", \"Applicability\", \"Unspecified\"],\n     [\"rustc_lint_defs\", \"Applicability\", \"HasPlaceholders\"],\n     [\"rustc_lint_defs\", \"Applicability\", \"MaybeIncorrect\"],\n     [\"rustc_lint_defs\", \"Applicability\", \"MachineApplicable\"],\n ];\n-#[cfg(feature = \"metadata-collector-lint\")]\n+#[cfg(feature = \"internal\")]\n pub const DIAGNOSTIC_BUILDER: [&str; 3] = [\"rustc_errors\", \"diagnostic_builder\", \"DiagnosticBuilder\"];\n pub const ARC_PTR_EQ: [&str; 4] = [\"alloc\", \"sync\", \"Arc\", \"ptr_eq\"];\n #[allow(clippy::invalid_paths)] // `check_path` does not seem to work for macros\n@@ -45,7 +45,7 @@ pub const DISPLAY_TRAIT: [&str; 3] = [\"core\", \"fmt\", \"Display\"];\n pub const DOUBLE_ENDED_ITERATOR: [&str; 4] = [\"core\", \"iter\", \"traits\", \"DoubleEndedIterator\"];\n pub const DROP: [&str; 3] = [\"core\", \"mem\", \"drop\"];\n pub const DURATION: [&str; 3] = [\"core\", \"time\", \"Duration\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const EARLY_CONTEXT: [&str; 2] = [\"rustc_lint\", \"EarlyContext\"];\n #[allow(clippy::invalid_paths)] // `check_path` does not seem to work for macros\n pub const EPRINT_MACRO: [&str; 3] = [\"std\", \"macros\", \"eprint\"];\n@@ -71,9 +71,9 @@ pub const HASH: [&str; 3] = [\"core\", \"hash\", \"Hash\"];\n pub const HASHMAP_CONTAINS_KEY: [&str; 6] = [\"std\", \"collections\", \"hash\", \"map\", \"HashMap\", \"contains_key\"];\n pub const HASHMAP_ENTRY: [&str; 5] = [\"std\", \"collections\", \"hash\", \"map\", \"Entry\"];\n pub const HASHMAP_INSERT: [&str; 6] = [\"std\", \"collections\", \"hash\", \"map\", \"HashMap\", \"insert\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const IDENT: [&str; 3] = [\"rustc_span\", \"symbol\", \"Ident\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const IDENT_AS_STR: [&str; 4] = [\"rustc_span\", \"symbol\", \"Ident\", \"as_str\"];\n pub const INDEX: [&str; 3] = [\"core\", \"ops\", \"Index\"];\n pub const INDEX_MUT: [&str; 3] = [\"core\", \"ops\", \"IndexMut\"];\n@@ -85,11 +85,11 @@ pub const IPADDR_V6: [&str; 5] = [\"std\", \"net\", \"ip\", \"IpAddr\", \"V6\"];\n pub const ITER_REPEAT: [&str; 5] = [\"core\", \"iter\", \"sources\", \"repeat\", \"repeat\"];\n #[allow(clippy::invalid_paths)] // internal lints do not know about all external crates\n pub const ITERTOOLS_NEXT_TUPLE: [&str; 3] = [\"itertools\", \"Itertools\", \"next_tuple\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const KW_MODULE: [&str; 3] = [\"rustc_span\", \"symbol\", \"kw\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const LATE_CONTEXT: [&str; 2] = [\"rustc_lint\", \"LateContext\"];\n-#[cfg(any(feature = \"internal-lints\", feature = \"metadata-collector-lint\"))]\n+#[cfg(feature = \"internal\")]\n pub const LINT: [&str; 2] = [\"rustc_lint_defs\", \"Lint\"];\n pub const MEM_DISCRIMINANT: [&str; 3] = [\"core\", \"mem\", \"discriminant\"];\n pub const MEM_FORGET: [&str; 3] = [\"core\", \"mem\", \"forget\"];\n@@ -179,17 +179,17 @@ pub const STR_ENDS_WITH: [&str; 4] = [\"core\", \"str\", \"<impl str>\", \"ends_with\"];\n pub const STR_FROM_UTF8: [&str; 4] = [\"core\", \"str\", \"converts\", \"from_utf8\"];\n pub const STR_LEN: [&str; 4] = [\"core\", \"str\", \"<impl str>\", \"len\"];\n pub const STR_STARTS_WITH: [&str; 4] = [\"core\", \"str\", \"<impl str>\", \"starts_with\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const SYMBOL: [&str; 3] = [\"rustc_span\", \"symbol\", \"Symbol\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const SYMBOL_AS_STR: [&str; 4] = [\"rustc_span\", \"symbol\", \"Symbol\", \"as_str\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const SYMBOL_INTERN: [&str; 4] = [\"rustc_span\", \"symbol\", \"Symbol\", \"intern\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const SYMBOL_TO_IDENT_STRING: [&str; 4] = [\"rustc_span\", \"symbol\", \"Symbol\", \"to_ident_string\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const SYM_MODULE: [&str; 3] = [\"rustc_span\", \"symbol\", \"sym\"];\n-#[cfg(feature = \"internal-lints\")]\n+#[cfg(feature = \"internal\")]\n pub const SYNTAX_CONTEXT: [&str; 3] = [\"rustc_span\", \"hygiene\", \"SyntaxContext\"];\n pub const TO_OWNED_METHOD: [&str; 4] = [\"alloc\", \"borrow\", \"ToOwned\", \"to_owned\"];\n pub const TO_STRING_METHOD: [&str; 4] = [\"alloc\", \"string\", \"ToString\", \"to_string\"];"}]}