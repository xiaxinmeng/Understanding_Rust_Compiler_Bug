{"sha": "f01fa227c0b37a5af343c0c8a074ffa6fb42210e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYwMWZhMjI3YzBiMzdhNWFmMzQzYzBjOGEwNzRmZmE2ZmI0MjIxMGU=", "commit": {"author": {"name": "Michael Wright", "email": "mikerite@lavabit.com", "date": "2018-09-30T04:25:23Z"}, "committer": {"name": "Michael Wright", "email": "mikerite@lavabit.com", "date": "2018-09-30T04:25:23Z"}, "message": "Fix update_lints.py for dir modules", "tree": {"sha": "7dbd3eac970e08ca9ea8e404b85860cd1206e7ec", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7dbd3eac970e08ca9ea8e404b85860cd1206e7ec"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f01fa227c0b37a5af343c0c8a074ffa6fb42210e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f01fa227c0b37a5af343c0c8a074ffa6fb42210e", "html_url": "https://github.com/rust-lang/rust/commit/f01fa227c0b37a5af343c0c8a074ffa6fb42210e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f01fa227c0b37a5af343c0c8a074ffa6fb42210e/comments", "author": null, "committer": null, "parents": [{"sha": "c2ee9c29ab1bcef6c074ad13b86690eea1e43dd7", "url": "https://api.github.com/repos/rust-lang/rust/commits/c2ee9c29ab1bcef6c074ad13b86690eea1e43dd7", "html_url": "https://github.com/rust-lang/rust/commit/c2ee9c29ab1bcef6c074ad13b86690eea1e43dd7"}], "stats": {"total": 16, "additions": 11, "deletions": 5}, "files": [{"sha": "b34dad73f70eeee4a3aa2b1d801992b8b69bc9c3", "filename": "util/update_lints.py", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/f01fa227c0b37a5af343c0c8a074ffa6fb42210e/util%2Fupdate_lints.py", "raw_url": "https://github.com/rust-lang/rust/raw/f01fa227c0b37a5af343c0c8a074ffa6fb42210e/util%2Fupdate_lints.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/util%2Fupdate_lints.py?ref=f01fa227c0b37a5af343c0c8a074ffa6fb42210e", "patch": "@@ -46,7 +46,12 @@ def collect(deprecated_lints, clippy_lints, fn):\n         # remove \\-newline escapes from description string\n         desc = nl_escape_re.sub('', match.group('desc'))\n         cat = match.group('cat')\n-        clippy_lints[cat].append((os.path.splitext(os.path.basename(fn))[0],\n+        if cat in ('internal', 'internal_warn'):\n+            continue\n+        module_name = os.path.splitext(os.path.basename(fn))[0]\n+        if module_name == 'mod':\n+            module_name = os.path.basename(os.path.dirname(fn))\n+        clippy_lints[cat].append((module_name,\n                                   match.group('name').lower(),\n                                   \"allow\",\n                                   desc.replace('\\\\\"', '\"')))\n@@ -138,10 +143,11 @@ def main(print_only=False, check=False):\n         return\n \n     # collect all lints from source files\n-    for fn in os.listdir('clippy_lints/src'):\n-        if fn.endswith('.rs'):\n-            collect(deprecated_lints, clippy_lints,\n-                    os.path.join('clippy_lints', 'src', fn))\n+    for root, dirs, files in os.walk('clippy_lints/src'):\n+        for fn in files:\n+            if fn.endswith('.rs'):\n+                collect(deprecated_lints, clippy_lints,\n+                        os.path.join(root, fn))\n \n     # determine version\n     with open('Cargo.toml') as fp:"}]}