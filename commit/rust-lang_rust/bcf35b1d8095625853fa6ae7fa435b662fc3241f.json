{"sha": "bcf35b1d8095625853fa6ae7fa435b662fc3241f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJjZjM1YjFkODA5NTYyNTg1M2ZhNmFlN2ZhNDM1YjY2MmZjMzI0MWY=", "commit": {"author": {"name": "Bastian Kauschke", "email": "bastian_kauschke@hotmail.de", "date": "2020-03-27T20:56:58Z"}, "committer": {"name": "Bastian Kauschke", "email": "bastian_kauschke@hotmail.de", "date": "2020-03-31T17:01:49Z"}, "message": "add tests for `unused_braces`", "tree": {"sha": "48024e926265ae0f69347c80b189b7ddf138e692", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/48024e926265ae0f69347c80b189b7ddf138e692"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bcf35b1d8095625853fa6ae7fa435b662fc3241f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bcf35b1d8095625853fa6ae7fa435b662fc3241f", "html_url": "https://github.com/rust-lang/rust/commit/bcf35b1d8095625853fa6ae7fa435b662fc3241f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bcf35b1d8095625853fa6ae7fa435b662fc3241f/comments", "author": {"login": "lcnr", "id": 29864074, "node_id": "MDQ6VXNlcjI5ODY0MDc0", "avatar_url": "https://avatars.githubusercontent.com/u/29864074?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lcnr", "html_url": "https://github.com/lcnr", "followers_url": "https://api.github.com/users/lcnr/followers", "following_url": "https://api.github.com/users/lcnr/following{/other_user}", "gists_url": "https://api.github.com/users/lcnr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lcnr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lcnr/subscriptions", "organizations_url": "https://api.github.com/users/lcnr/orgs", "repos_url": "https://api.github.com/users/lcnr/repos", "events_url": "https://api.github.com/users/lcnr/events{/privacy}", "received_events_url": "https://api.github.com/users/lcnr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lcnr", "id": 29864074, "node_id": "MDQ6VXNlcjI5ODY0MDc0", "avatar_url": "https://avatars.githubusercontent.com/u/29864074?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lcnr", "html_url": "https://github.com/lcnr", "followers_url": "https://api.github.com/users/lcnr/followers", "following_url": "https://api.github.com/users/lcnr/following{/other_user}", "gists_url": "https://api.github.com/users/lcnr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lcnr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lcnr/subscriptions", "organizations_url": "https://api.github.com/users/lcnr/orgs", "repos_url": "https://api.github.com/users/lcnr/repos", "events_url": "https://api.github.com/users/lcnr/events{/privacy}", "received_events_url": "https://api.github.com/users/lcnr/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "698b20eedaff60aaed3b1f0bd1bec7d8c095f6a4", "url": "https://api.github.com/repos/rust-lang/rust/commits/698b20eedaff60aaed3b1f0bd1bec7d8c095f6a4", "html_url": "https://github.com/rust-lang/rust/commit/698b20eedaff60aaed3b1f0bd1bec7d8c095f6a4"}], "stats": {"total": 134, "additions": 134, "deletions": 0}, "files": [{"sha": "05234faf714201f21db3bf6c80b5f83d0385f7d2", "filename": "src/test/ui/const-generics/unused_braces.rs", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/bcf35b1d8095625853fa6ae7fa435b662fc3241f/src%2Ftest%2Fui%2Fconst-generics%2Funused_braces.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bcf35b1d8095625853fa6ae7fa435b662fc3241f/src%2Ftest%2Fui%2Fconst-generics%2Funused_braces.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Funused_braces.rs?ref=bcf35b1d8095625853fa6ae7fa435b662fc3241f", "patch": "@@ -0,0 +1,13 @@\n+// check-pass\n+#![warn(unused_braces)]\n+\n+#![feature(const_generics)]\n+//~^ WARN the feature `const_generics` is incomplete and may cause the compiler to crash\n+\n+struct A<const N: usize>;\n+\n+fn main() {\n+    let _: A<7>; // ok\n+    let _: A<{ 7 }>; //~ WARN unnecessary braces\n+    let _: A<{ 3 + 5 }>; // ok\n+}"}, {"sha": "fc3da6096e7d447dd61561e6660ef976c3dedb39", "filename": "src/test/ui/const-generics/unused_braces.stderr", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/bcf35b1d8095625853fa6ae7fa435b662fc3241f/src%2Ftest%2Fui%2Fconst-generics%2Funused_braces.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/bcf35b1d8095625853fa6ae7fa435b662fc3241f/src%2Ftest%2Fui%2Fconst-generics%2Funused_braces.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Funused_braces.stderr?ref=bcf35b1d8095625853fa6ae7fa435b662fc3241f", "patch": "@@ -0,0 +1,20 @@\n+warning: the feature `const_generics` is incomplete and may cause the compiler to crash\n+  --> $DIR/unused_braces.rs:4:12\n+   |\n+LL | #![feature(const_generics)]\n+   |            ^^^^^^^^^^^^^^\n+   |\n+   = note: `#[warn(incomplete_features)]` on by default\n+\n+warning: unnecessary braces around const expression\n+  --> $DIR/unused_braces.rs:11:14\n+   |\n+LL |     let _: A<{ 7 }>;\n+   |              ^^^^^ help: remove these braces\n+   |\n+note: the lint level is defined here\n+  --> $DIR/unused_braces.rs:2:9\n+   |\n+LL | #![warn(unused_braces)]\n+   |         ^^^^^^^^^^^^^\n+"}, {"sha": "de456ee6c230cac9a7d4c9872ba1dbde8974386d", "filename": "src/test/ui/lint/unused_braces.rs", "status": "added", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/bcf35b1d8095625853fa6ae7fa435b662fc3241f/src%2Ftest%2Fui%2Flint%2Funused_braces.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bcf35b1d8095625853fa6ae7fa435b662fc3241f/src%2Ftest%2Fui%2Flint%2Funused_braces.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Funused_braces.rs?ref=bcf35b1d8095625853fa6ae7fa435b662fc3241f", "patch": "@@ -0,0 +1,31 @@\n+// check-pass\n+#![warn(unused_braces, unused_parens)]\n+\n+fn main() {\n+    let _ = (7);\n+    //~^WARN unnecessary parentheses\n+\n+    let _ = { 7 };\n+    //~^ WARN unnecessary braces\n+\n+    if let 7 = { 7 } {\n+        //~^ WARN unnecessary braces\n+    }\n+\n+    let _: [u8; { 3 }];\n+    //~^ WARN unnecessary braces\n+\n+    // do not emit error for multiline blocks.\n+    let _ = {\n+        7\n+    };\n+\n+    // do not emit error for unsafe blocks.\n+    let _ = unsafe { 7 };\n+\n+    // do not emit error, as the `{` would then\n+    // be parsed as part of the `return`.\n+    if { return } {\n+\n+    }\n+}"}, {"sha": "add0611eac29ee93b03c35bd14bb99606364255e", "filename": "src/test/ui/lint/unused_braces.stderr", "status": "added", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/bcf35b1d8095625853fa6ae7fa435b662fc3241f/src%2Ftest%2Fui%2Flint%2Funused_braces.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/bcf35b1d8095625853fa6ae7fa435b662fc3241f/src%2Ftest%2Fui%2Flint%2Funused_braces.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Funused_braces.stderr?ref=bcf35b1d8095625853fa6ae7fa435b662fc3241f", "patch": "@@ -0,0 +1,36 @@\n+warning: unnecessary parentheses around assigned value\n+  --> $DIR/unused_braces.rs:5:13\n+   |\n+LL |     let _ = (7);\n+   |             ^^^ help: remove these parentheses\n+   |\n+note: the lint level is defined here\n+  --> $DIR/unused_braces.rs:2:24\n+   |\n+LL | #![warn(unused_braces, unused_parens)]\n+   |                        ^^^^^^^^^^^^^\n+\n+warning: unnecessary braces around assigned value\n+  --> $DIR/unused_braces.rs:8:13\n+   |\n+LL |     let _ = { 7 };\n+   |             ^^^^^ help: remove these braces\n+   |\n+note: the lint level is defined here\n+  --> $DIR/unused_braces.rs:2:9\n+   |\n+LL | #![warn(unused_braces, unused_parens)]\n+   |         ^^^^^^^^^^^^^\n+\n+warning: unnecessary braces around `let` head expression\n+  --> $DIR/unused_braces.rs:11:16\n+   |\n+LL |     if let 7 = { 7 } {\n+   |                ^^^^^ help: remove these braces\n+\n+warning: unnecessary braces around const expression\n+  --> $DIR/unused_braces.rs:15:17\n+   |\n+LL |     let _: [u8; { 3 }];\n+   |                 ^^^^^ help: remove these braces\n+"}, {"sha": "98dbbecfedde61ffeaaf3c738aa6416af090e72c", "filename": "src/test/ui/lint/unused_parens_borrow.rs", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/bcf35b1d8095625853fa6ae7fa435b662fc3241f/src%2Ftest%2Fui%2Flint%2Funused_parens_borrow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bcf35b1d8095625853fa6ae7fa435b662fc3241f/src%2Ftest%2Fui%2Flint%2Funused_parens_borrow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Funused_parens_borrow.rs?ref=bcf35b1d8095625853fa6ae7fa435b662fc3241f", "patch": "@@ -0,0 +1,22 @@\n+// check-pass\n+#![warn(unused_braces)]\n+\n+// changing `&{ expr }` to `&expr` changes the semantic of the program\n+// so we should not warn this case\n+\n+#[repr(packed)]\n+struct A {\n+    a: u8,\n+    b: u32,\n+}\n+\n+fn main() {\n+    let a = A {\n+        a: 42,\n+        b: 1729,\n+    };\n+\n+    let _ = &{ a.b };\n+    let _ = { a.b };\n+    //~^ WARN unnecessary braces\n+}"}, {"sha": "7e3839ae4e0142fa53807a2d808a1ca88e836c14", "filename": "src/test/ui/lint/unused_parens_borrow.stderr", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/bcf35b1d8095625853fa6ae7fa435b662fc3241f/src%2Ftest%2Fui%2Flint%2Funused_parens_borrow.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/bcf35b1d8095625853fa6ae7fa435b662fc3241f/src%2Ftest%2Fui%2Flint%2Funused_parens_borrow.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Funused_parens_borrow.stderr?ref=bcf35b1d8095625853fa6ae7fa435b662fc3241f", "patch": "@@ -0,0 +1,12 @@\n+warning: unnecessary braces around assigned value\n+  --> $DIR/unused_parens_borrow.rs:20:13\n+   |\n+LL |     let _ = { a.b };\n+   |             ^^^^^^^ help: remove these braces\n+   |\n+note: the lint level is defined here\n+  --> $DIR/unused_parens_borrow.rs:2:9\n+   |\n+LL | #![warn(unused_braces)]\n+   |         ^^^^^^^^^^^^^\n+"}]}