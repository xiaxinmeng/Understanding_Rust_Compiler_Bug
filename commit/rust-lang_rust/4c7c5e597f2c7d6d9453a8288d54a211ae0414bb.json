{"sha": "4c7c5e597f2c7d6d9453a8288d54a211ae0414bb", "node_id": "C_kwDOAAsO6NoAKDRjN2M1ZTU5N2YyYzdkNmQ5NDUzYTgyODhkNTRhMjExYWUwNDE0YmI", "commit": {"author": {"name": "lcnr", "email": "rust@lcnr.de", "date": "2023-02-08T13:16:22Z"}, "committer": {"name": "lcnr", "email": "rust@lcnr.de", "date": "2023-02-08T18:11:14Z"}, "message": "add (currently ICEing) test", "tree": {"sha": "f46d32c832d5505cb128b82d3a2545cb5ef853de", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f46d32c832d5505cb128b82d3a2545cb5ef853de"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4c7c5e597f2c7d6d9453a8288d54a211ae0414bb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4c7c5e597f2c7d6d9453a8288d54a211ae0414bb", "html_url": "https://github.com/rust-lang/rust/commit/4c7c5e597f2c7d6d9453a8288d54a211ae0414bb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4c7c5e597f2c7d6d9453a8288d54a211ae0414bb/comments", "author": {"login": "lcnr", "id": 29864074, "node_id": "MDQ6VXNlcjI5ODY0MDc0", "avatar_url": "https://avatars.githubusercontent.com/u/29864074?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lcnr", "html_url": "https://github.com/lcnr", "followers_url": "https://api.github.com/users/lcnr/followers", "following_url": "https://api.github.com/users/lcnr/following{/other_user}", "gists_url": "https://api.github.com/users/lcnr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lcnr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lcnr/subscriptions", "organizations_url": "https://api.github.com/users/lcnr/orgs", "repos_url": "https://api.github.com/users/lcnr/repos", "events_url": "https://api.github.com/users/lcnr/events{/privacy}", "received_events_url": "https://api.github.com/users/lcnr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lcnr", "id": 29864074, "node_id": "MDQ6VXNlcjI5ODY0MDc0", "avatar_url": "https://avatars.githubusercontent.com/u/29864074?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lcnr", "html_url": "https://github.com/lcnr", "followers_url": "https://api.github.com/users/lcnr/followers", "following_url": "https://api.github.com/users/lcnr/following{/other_user}", "gists_url": "https://api.github.com/users/lcnr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lcnr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lcnr/subscriptions", "organizations_url": "https://api.github.com/users/lcnr/orgs", "repos_url": "https://api.github.com/users/lcnr/repos", "events_url": "https://api.github.com/users/lcnr/events{/privacy}", "received_events_url": "https://api.github.com/users/lcnr/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a5164605bc3b572cf2281ce81ad5339fd6249aea", "url": "https://api.github.com/repos/rust-lang/rust/commits/a5164605bc3b572cf2281ce81ad5339fd6249aea", "html_url": "https://github.com/rust-lang/rust/commit/a5164605bc3b572cf2281ce81ad5339fd6249aea"}], "stats": {"total": 43, "additions": 43, "deletions": 0}, "files": [{"sha": "a3d97927bad2222037e19e1b5baa705e897a2278", "filename": "tests/ui/traits/new-solver/provisional-result-done.rs", "status": "added", "additions": 37, "deletions": 0, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/4c7c5e597f2c7d6d9453a8288d54a211ae0414bb/tests%2Fui%2Ftraits%2Fnew-solver%2Fprovisional-result-done.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4c7c5e597f2c7d6d9453a8288d54a211ae0414bb/tests%2Fui%2Ftraits%2Fnew-solver%2Fprovisional-result-done.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftraits%2Fnew-solver%2Fprovisional-result-done.rs?ref=4c7c5e597f2c7d6d9453a8288d54a211ae0414bb", "patch": "@@ -0,0 +1,37 @@\n+// known-bug: unknown\n+// compile-flags: -Ztrait-solver=next\n+// failure-status: 101\n+// normalize-stderr-test \"note: .*\\n\\n\" -> \"\"\n+// normalize-stderr-test \"thread 'rustc' panicked.*\\n\" -> \"\"\n+// rustc-env:RUST_BACKTRACE=0\n+\n+// This tests checks that we update results in the provisional cache when\n+// we pop a goal from the stack.\n+#![feature(auto_traits)]\n+auto trait Coinductive {}\n+struct Foo<T>(T);\n+struct Bar<T>(T);\n+\n+impl<T> Coinductive for Foo<T>\n+where\n+    Bar<T>: Coinductive\n+{}\n+\n+impl<T> Coinductive for Bar<T>\n+where\n+    Foo<T>: Coinductive,\n+    Bar<T>: ConstrainInfer,\n+{}\n+\n+trait ConstrainInfer {}\n+impl ConstrainInfer for Bar<u8> {}\n+impl ConstrainInfer for Foo<u16> {}\n+\n+fn impls<T: Coinductive>() -> T { todo!() }\n+\n+fn constrain<T: ConstrainInfer>(_: T) {}\n+\n+fn main() {\n+    // This should constrain `_` to `u8`.\n+    impls::<Foo<_>>();\n+}"}, {"sha": "ffc92b81f089e7d3b0c83443b62fb5a9d745d49e", "filename": "tests/ui/traits/new-solver/provisional-result-done.stderr", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/4c7c5e597f2c7d6d9453a8288d54a211ae0414bb/tests%2Fui%2Ftraits%2Fnew-solver%2Fprovisional-result-done.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4c7c5e597f2c7d6d9453a8288d54a211ae0414bb/tests%2Fui%2Ftraits%2Fnew-solver%2Fprovisional-result-done.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftraits%2Fnew-solver%2Fprovisional-result-done.stderr?ref=4c7c5e597f2c7d6d9453a8288d54a211ae0414bb", "patch": "@@ -0,0 +1,6 @@\n+error: the compiler unexpectedly panicked. this is a bug.\n+\n+query stack during panic:\n+#0 [check_well_formed] checking that `<impl at $DIR/provisional-result-done.rs:20:1: 20:31>` is well-formed\n+#1 [check_mod_type_wf] checking that types are well-formed in top-level module\n+end of query stack"}]}