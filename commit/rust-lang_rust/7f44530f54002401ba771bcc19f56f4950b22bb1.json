{"sha": "7f44530f54002401ba771bcc19f56f4950b22bb1", "node_id": "C_kwDOAAsO6NoAKDdmNDQ1MzBmNTQwMDI0MDFiYTc3MWJjYzE5ZjU2ZjQ5NTBiMjJiYjE", "commit": {"author": {"name": "bluthej", "email": "joffrey.bluthe@e.email", "date": "2023-03-18T09:43:02Z"}, "committer": {"name": "bluthej", "email": "joffrey.bluthe@e.email", "date": "2023-03-21T21:51:51Z"}, "message": "Create `clear_with_drain` lint", "tree": {"sha": "5c2613330a4e2464e272a50ccbb95b60d66b7356", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5c2613330a4e2464e272a50ccbb95b60d66b7356"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7f44530f54002401ba771bcc19f56f4950b22bb1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7f44530f54002401ba771bcc19f56f4950b22bb1", "html_url": "https://github.com/rust-lang/rust/commit/7f44530f54002401ba771bcc19f56f4950b22bb1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7f44530f54002401ba771bcc19f56f4950b22bb1/comments", "author": {"login": "bluthej", "id": 29771403, "node_id": "MDQ6VXNlcjI5NzcxNDAz", "avatar_url": "https://avatars.githubusercontent.com/u/29771403?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bluthej", "html_url": "https://github.com/bluthej", "followers_url": "https://api.github.com/users/bluthej/followers", "following_url": "https://api.github.com/users/bluthej/following{/other_user}", "gists_url": "https://api.github.com/users/bluthej/gists{/gist_id}", "starred_url": "https://api.github.com/users/bluthej/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bluthej/subscriptions", "organizations_url": "https://api.github.com/users/bluthej/orgs", "repos_url": "https://api.github.com/users/bluthej/repos", "events_url": "https://api.github.com/users/bluthej/events{/privacy}", "received_events_url": "https://api.github.com/users/bluthej/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bluthej", "id": 29771403, "node_id": "MDQ6VXNlcjI5NzcxNDAz", "avatar_url": "https://avatars.githubusercontent.com/u/29771403?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bluthej", "html_url": "https://github.com/bluthej", "followers_url": "https://api.github.com/users/bluthej/followers", "following_url": "https://api.github.com/users/bluthej/following{/other_user}", "gists_url": "https://api.github.com/users/bluthej/gists{/gist_id}", "starred_url": "https://api.github.com/users/bluthej/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bluthej/subscriptions", "organizations_url": "https://api.github.com/users/bluthej/orgs", "repos_url": "https://api.github.com/users/bluthej/repos", "events_url": "https://api.github.com/users/bluthej/events{/privacy}", "received_events_url": "https://api.github.com/users/bluthej/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6cebe58dfe09654100fe370773e3d10581e20bdf", "url": "https://api.github.com/repos/rust-lang/rust/commits/6cebe58dfe09654100fe370773e3d10581e20bdf", "html_url": "https://github.com/rust-lang/rust/commit/6cebe58dfe09654100fe370773e3d10581e20bdf"}], "stats": {"total": 43, "additions": 43, "deletions": 0}, "files": [{"sha": "81d0ff809686de46e71fa0811292104e2461daa9", "filename": "CHANGELOG.md", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/7f44530f54002401ba771bcc19f56f4950b22bb1/CHANGELOG.md", "raw_url": "https://github.com/rust-lang/rust/raw/7f44530f54002401ba771bcc19f56f4950b22bb1/CHANGELOG.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/CHANGELOG.md?ref=7f44530f54002401ba771bcc19f56f4950b22bb1", "patch": "@@ -4441,6 +4441,7 @@ Released 2018-09-13\n [`chars_last_cmp`]: https://rust-lang.github.io/rust-clippy/master/index.html#chars_last_cmp\n [`chars_next_cmp`]: https://rust-lang.github.io/rust-clippy/master/index.html#chars_next_cmp\n [`checked_conversions`]: https://rust-lang.github.io/rust-clippy/master/index.html#checked_conversions\n+[`clear_with_drain`]: https://rust-lang.github.io/rust-clippy/master/index.html#clear_with_drain\n [`clone_double_ref`]: https://rust-lang.github.io/rust-clippy/master/index.html#clone_double_ref\n [`clone_on_copy`]: https://rust-lang.github.io/rust-clippy/master/index.html#clone_on_copy\n [`clone_on_ref_ptr`]: https://rust-lang.github.io/rust-clippy/master/index.html#clone_on_ref_ptr"}, {"sha": "f7b108c923adfeeb5f8bb569d97b622ce18c9c7f", "filename": "clippy_lints/src/declared_lints.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/7f44530f54002401ba771bcc19f56f4950b22bb1/clippy_lints%2Fsrc%2Fdeclared_lints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7f44530f54002401ba771bcc19f56f4950b22bb1/clippy_lints%2Fsrc%2Fdeclared_lints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fdeclared_lints.rs?ref=7f44530f54002401ba771bcc19f56f4950b22bb1", "patch": "@@ -307,6 +307,7 @@ pub(crate) static LINTS: &[&crate::LintInfo] = &[\n     crate::methods::CASE_SENSITIVE_FILE_EXTENSION_COMPARISONS_INFO,\n     crate::methods::CHARS_LAST_CMP_INFO,\n     crate::methods::CHARS_NEXT_CMP_INFO,\n+    crate::methods::CLEAR_WITH_DRAIN_INFO,\n     crate::methods::CLONED_INSTEAD_OF_COPIED_INFO,\n     crate::methods::CLONE_DOUBLE_REF_INFO,\n     crate::methods::CLONE_ON_COPY_INFO,"}, {"sha": "9e55852ef7a686059d7a1f27f4dc06a3c5ea15ce", "filename": "clippy_lints/src/methods/clear_with_drain.rs", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/7f44530f54002401ba771bcc19f56f4950b22bb1/clippy_lints%2Fsrc%2Fmethods%2Fclear_with_drain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7f44530f54002401ba771bcc19f56f4950b22bb1/clippy_lints%2Fsrc%2Fmethods%2Fclear_with_drain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmethods%2Fclear_with_drain.rs?ref=7f44530f54002401ba771bcc19f56f4950b22bb1", "patch": "@@ -0,0 +1,8 @@\n+use rustc_lint::{LateContext, LintContext};\n+\n+use super::CLEAR_WITH_DRAIN;\n+\n+// TODO: Adjust the parameters as necessary\n+pub(super) fn check(cx: &LateContext) {\n+    todo!();\n+}"}, {"sha": "859284b6a5cc3fb6f688cfb133dafa00da66ce17", "filename": "clippy_lints/src/methods/mod.rs", "status": "modified", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/7f44530f54002401ba771bcc19f56f4950b22bb1/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7f44530f54002401ba771bcc19f56f4950b22bb1/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmethods%2Fmod.rs?ref=7f44530f54002401ba771bcc19f56f4950b22bb1", "patch": "@@ -9,6 +9,7 @@ mod chars_last_cmp;\n mod chars_last_cmp_with_unwrap;\n mod chars_next_cmp;\n mod chars_next_cmp_with_unwrap;\n+mod clear_with_drain;\n mod clone_on_copy;\n mod clone_on_ref_ptr;\n mod cloned_instead_of_copied;\n@@ -3190,6 +3191,25 @@ declare_clippy_lint! {\n     \"single command line argument that looks like it should be multiple arguments\"\n }\n \n+declare_clippy_lint! {\n+    /// ### What it does\n+    ///\n+    /// ### Why is this bad?\n+    ///\n+    /// ### Example\n+    /// ```rust\n+    /// // example code where clippy issues a warning\n+    /// ```\n+    /// Use instead:\n+    /// ```rust\n+    /// // example code which does not raise clippy warning\n+    /// ```\n+    #[clippy::version = \"1.69.0\"]\n+    pub CLEAR_WITH_DRAIN,\n+    nursery,\n+    \"default lint description\"\n+}\n+\n pub struct Methods {\n     avoid_breaking_exported_api: bool,\n     msrv: Msrv,\n@@ -3318,6 +3338,7 @@ impl_lint_pass!(Methods => [\n     SEEK_TO_START_INSTEAD_OF_REWIND,\n     NEEDLESS_COLLECT,\n     SUSPICIOUS_COMMAND_ARG_SPACE,\n+    CLEAR_WITH_DRAIN,\n ]);\n \n /// Extracts a method call name, args, and `Span` of the method name."}, {"sha": "bb3a371cc089700a3636e4b5804556c13631dc45", "filename": "tests/ui/clear_with_drain.rs", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/7f44530f54002401ba771bcc19f56f4950b22bb1/tests%2Fui%2Fclear_with_drain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7f44530f54002401ba771bcc19f56f4950b22bb1/tests%2Fui%2Fclear_with_drain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fclear_with_drain.rs?ref=7f44530f54002401ba771bcc19f56f4950b22bb1", "patch": "@@ -0,0 +1,12 @@\n+#![allow(unused)]\n+#![warn(clippy::clear_with_drain)]\n+\n+fn main() {\n+    let mut vec: Vec<i32> = Vec::new();\n+    //Lint\n+    vec.drain(..);\n+    vec.drain(0..vec.len());\n+\n+    // Dont Lint\n+    let iter = vec.drain(..);\n+}"}]}