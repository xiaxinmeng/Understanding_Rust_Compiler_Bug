{"sha": "003786228d65135b9bae20a260caefc0248eb375", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAwMzc4NjIyOGQ2NTEzNWI5YmFlMjBhMjYwY2FlZmMwMjQ4ZWIzNzU=", "commit": {"author": {"name": "meiomorphism", "email": "meiomorphism@gmail.com", "date": "2020-11-25T12:31:10Z"}, "committer": {"name": "Caleb Cartwright", "email": "calebcartwright@users.noreply.github.com", "date": "2020-11-26T03:32:46Z"}, "message": "fix: don't force a newline after an empty where clause\n\nFixes #4547.", "tree": {"sha": "6e395f4b6b2f7ce2d2ef27deafb03f08c57a858a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6e395f4b6b2f7ce2d2ef27deafb03f08c57a858a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/003786228d65135b9bae20a260caefc0248eb375", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/003786228d65135b9bae20a260caefc0248eb375", "html_url": "https://github.com/rust-lang/rust/commit/003786228d65135b9bae20a260caefc0248eb375", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/003786228d65135b9bae20a260caefc0248eb375/comments", "author": {"login": "meiomorphism", "id": 6301151, "node_id": "MDQ6VXNlcjYzMDExNTE=", "avatar_url": "https://avatars.githubusercontent.com/u/6301151?v=4", "gravatar_id": "", "url": "https://api.github.com/users/meiomorphism", "html_url": "https://github.com/meiomorphism", "followers_url": "https://api.github.com/users/meiomorphism/followers", "following_url": "https://api.github.com/users/meiomorphism/following{/other_user}", "gists_url": "https://api.github.com/users/meiomorphism/gists{/gist_id}", "starred_url": "https://api.github.com/users/meiomorphism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/meiomorphism/subscriptions", "organizations_url": "https://api.github.com/users/meiomorphism/orgs", "repos_url": "https://api.github.com/users/meiomorphism/repos", "events_url": "https://api.github.com/users/meiomorphism/events{/privacy}", "received_events_url": "https://api.github.com/users/meiomorphism/received_events", "type": "User", "site_admin": false}, "committer": {"login": "calebcartwright", "id": 13042488, "node_id": "MDQ6VXNlcjEzMDQyNDg4", "avatar_url": "https://avatars.githubusercontent.com/u/13042488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/calebcartwright", "html_url": "https://github.com/calebcartwright", "followers_url": "https://api.github.com/users/calebcartwright/followers", "following_url": "https://api.github.com/users/calebcartwright/following{/other_user}", "gists_url": "https://api.github.com/users/calebcartwright/gists{/gist_id}", "starred_url": "https://api.github.com/users/calebcartwright/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/calebcartwright/subscriptions", "organizations_url": "https://api.github.com/users/calebcartwright/orgs", "repos_url": "https://api.github.com/users/calebcartwright/repos", "events_url": "https://api.github.com/users/calebcartwright/events{/privacy}", "received_events_url": "https://api.github.com/users/calebcartwright/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "073cc3891fa235e8968d42af4774d6c30a39032a", "url": "https://api.github.com/repos/rust-lang/rust/commits/073cc3891fa235e8968d42af4774d6c30a39032a", "html_url": "https://github.com/rust-lang/rust/commit/073cc3891fa235e8968d42af4774d6c30a39032a"}], "stats": {"total": 25, "additions": 24, "deletions": 1}, "files": [{"sha": "a11a02be2aeadff91c681691bb0df8528de1db7b", "filename": "src/items.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/003786228d65135b9bae20a260caefc0248eb375/src%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/003786228d65135b9bae20a260caefc0248eb375/src%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fitems.rs?ref=003786228d65135b9bae20a260caefc0248eb375", "patch": "@@ -2418,7 +2418,8 @@ fn rewrite_fn_base(\n     result.push_str(&where_clause_str);\n \n     force_new_line_for_brace |= last_line_contains_single_line_comment(&result);\n-    force_new_line_for_brace |= is_params_multi_lined && context.config.where_single_line();\n+    force_new_line_for_brace |=\n+        is_params_multi_lined && context.config.where_single_line() && !where_clause_str.is_empty();\n     Some((result, force_new_line_for_brace))\n }\n "}, {"sha": "ec7f79b689caa3e0985e7cc2670c6da3283d408d", "filename": "tests/target/configs/where_single_line/true-with-brace-style.rs", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/003786228d65135b9bae20a260caefc0248eb375/tests%2Ftarget%2Fconfigs%2Fwhere_single_line%2Ftrue-with-brace-style.rs", "raw_url": "https://github.com/rust-lang/rust/raw/003786228d65135b9bae20a260caefc0248eb375/tests%2Ftarget%2Fconfigs%2Fwhere_single_line%2Ftrue-with-brace-style.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fconfigs%2Fwhere_single_line%2Ftrue-with-brace-style.rs?ref=003786228d65135b9bae20a260caefc0248eb375", "patch": "@@ -0,0 +1,22 @@\n+// rustfmt-brace_style: SameLineWhere\n+// rustfmt-where_single_line: true\n+\n+fn lorem_multi_line_clauseless<Ipsum, Dolor, Sit, Amet>(\n+    a: Aaaaaaaaaaaaaaa,\n+    b: Bbbbbbbbbbbbbbbb,\n+    c: Ccccccccccccccccc,\n+    d: Ddddddddddddddddddddddddd,\n+    e: Eeeeeeeeeeeeeeeeeee,\n+) -> T {\n+    // body\n+}\n+\n+fn lorem_multi_line_clauseless<Ipsum, Dolor, Sit, Amet>(\n+    a: Aaaaaaaaaaaaaaa,\n+    b: Bbbbbbbbbbbbbbbb,\n+    c: Ccccccccccccccccc,\n+    d: Ddddddddddddddddddddddddd,\n+    e: Eeeeeeeeeeeeeeeeeee,\n+) {\n+    // body\n+}"}]}