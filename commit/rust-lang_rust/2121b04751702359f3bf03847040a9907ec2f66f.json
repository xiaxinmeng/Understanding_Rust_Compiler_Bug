{"sha": "2121b04751702359f3bf03847040a9907ec2f66f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjIxMjFiMDQ3NTE3MDIzNTlmM2JmMDM4NDcwNDBhOTkwN2VjMmY2NmY=", "commit": {"author": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2019-09-24T22:24:45Z"}, "committer": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2019-10-17T23:16:41Z"}, "message": "Handle lints, not passes in push_lints\n\nThis extracts the call to get_lints() to callers.", "tree": {"sha": "d7d4bc5d40822bbd4fcb245144803c28f23cb844", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d7d4bc5d40822bbd4fcb245144803c28f23cb844"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2121b04751702359f3bf03847040a9907ec2f66f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2121b04751702359f3bf03847040a9907ec2f66f", "html_url": "https://github.com/rust-lang/rust/commit/2121b04751702359f3bf03847040a9907ec2f66f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2121b04751702359f3bf03847040a9907ec2f66f/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "577d442fe8337338b873d3df1ab5132de6a1af83", "url": "https://api.github.com/repos/rust-lang/rust/commits/577d442fe8337338b873d3df1ab5132de6a1af83", "html_url": "https://github.com/rust-lang/rust/commit/577d442fe8337338b873d3df1ab5132de6a1af83"}], "stats": {"total": 12, "additions": 5, "deletions": 7}, "files": [{"sha": "c21c45b759c63d671218e2172bbe62a3b982d738", "filename": "src/librustc/lint/context.rs", "status": "modified", "additions": 5, "deletions": 7, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/2121b04751702359f3bf03847040a9907ec2f66f/src%2Flibrustc%2Flint%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2121b04751702359f3bf03847040a9907ec2f66f/src%2Flibrustc%2Flint%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Flint%2Fcontext.rs?ref=2121b04751702359f3bf03847040a9907ec2f66f", "patch": "@@ -172,7 +172,7 @@ impl LintStore {\n                                from_plugin: bool,\n                                register_only: bool,\n                                pass: EarlyLintPassObject) {\n-        self.push_pass(from_plugin, &pass);\n+        self.push_lints(from_plugin, &pass.get_lints());\n         if !register_only {\n             self.early_passes.as_mut().unwrap().push(pass);\n         }\n@@ -184,7 +184,7 @@ impl LintStore {\n         register_only: bool,\n         pass: EarlyLintPassObject,\n     ) {\n-        self.push_pass(from_plugin, &pass);\n+        self.push_lints(from_plugin, &pass.get_lints());\n         if !register_only {\n             self.pre_expansion_passes.as_mut().unwrap().push(pass);\n         }\n@@ -195,7 +195,7 @@ impl LintStore {\n                               register_only: bool,\n                               per_module: bool,\n                               pass: LateLintPassObject) {\n-        self.push_pass(from_plugin, &pass);\n+        self.push_lints(from_plugin, &pass.get_lints());\n         if !register_only {\n             if per_module {\n                 self.late_module_passes.push(pass);\n@@ -206,10 +206,8 @@ impl LintStore {\n     }\n \n     // Helper method for register_early/late_pass\n-    fn push_pass<P: LintPass + ?Sized + 'static>(&mut self,\n-                                        from_plugin: bool,\n-                                        pass: &Box<P>) {\n-        for lint in pass.get_lints() {\n+    fn push_lints(&mut self, from_plugin: bool, lints: &[&'static Lint]) {\n+        for lint in lints {\n             self.lints.push((lint, from_plugin));\n \n             let id = LintId::of(lint);"}]}