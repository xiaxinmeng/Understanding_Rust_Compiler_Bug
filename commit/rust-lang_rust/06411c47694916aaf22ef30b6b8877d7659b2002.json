{"sha": "06411c47694916aaf22ef30b6b8877d7659b2002", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA2NDExYzQ3Njk0OTE2YWFmMjJlZjMwYjZiODg3N2Q3NjU5YjIwMDI=", "commit": {"author": {"name": "Alex Burka", "email": "alex@alexburka.com", "date": "2017-04-02T04:46:33Z"}, "committer": {"name": "Alex Burka", "email": "alex@alexburka.com", "date": "2017-04-15T19:06:19Z"}, "message": "update print_visibility for new pub(restricted) syntax", "tree": {"sha": "396ca0db76d8a07af7d0b0c0ea6cb4f929d84bcd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/396ca0db76d8a07af7d0b0c0ea6cb4f929d84bcd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/06411c47694916aaf22ef30b6b8877d7659b2002", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/06411c47694916aaf22ef30b6b8877d7659b2002", "html_url": "https://github.com/rust-lang/rust/commit/06411c47694916aaf22ef30b6b8877d7659b2002", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/06411c47694916aaf22ef30b6b8877d7659b2002/comments", "author": {"login": "durka", "id": 47007, "node_id": "MDQ6VXNlcjQ3MDA3", "avatar_url": "https://avatars.githubusercontent.com/u/47007?v=4", "gravatar_id": "", "url": "https://api.github.com/users/durka", "html_url": "https://github.com/durka", "followers_url": "https://api.github.com/users/durka/followers", "following_url": "https://api.github.com/users/durka/following{/other_user}", "gists_url": "https://api.github.com/users/durka/gists{/gist_id}", "starred_url": "https://api.github.com/users/durka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/durka/subscriptions", "organizations_url": "https://api.github.com/users/durka/orgs", "repos_url": "https://api.github.com/users/durka/repos", "events_url": "https://api.github.com/users/durka/events{/privacy}", "received_events_url": "https://api.github.com/users/durka/received_events", "type": "User", "site_admin": false}, "committer": {"login": "durka", "id": 47007, "node_id": "MDQ6VXNlcjQ3MDA3", "avatar_url": "https://avatars.githubusercontent.com/u/47007?v=4", "gravatar_id": "", "url": "https://api.github.com/users/durka", "html_url": "https://github.com/durka", "followers_url": "https://api.github.com/users/durka/followers", "following_url": "https://api.github.com/users/durka/following{/other_user}", "gists_url": "https://api.github.com/users/durka/gists{/gist_id}", "starred_url": "https://api.github.com/users/durka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/durka/subscriptions", "organizations_url": "https://api.github.com/users/durka/orgs", "repos_url": "https://api.github.com/users/durka/repos", "events_url": "https://api.github.com/users/durka/events{/privacy}", "received_events_url": "https://api.github.com/users/durka/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d53e413e04e438fd0dc1a8b1a8dcb07a0774092a", "url": "https://api.github.com/repos/rust-lang/rust/commits/d53e413e04e438fd0dc1a8b1a8dcb07a0774092a", "html_url": "https://github.com/rust-lang/rust/commit/d53e413e04e438fd0dc1a8b1a8dcb07a0774092a"}], "stats": {"total": 14, "additions": 6, "deletions": 8}, "files": [{"sha": "be1d26f8fe4872c5f82346707883d50141ee3c2c", "filename": "src/libsyntax/print/pprust.rs", "status": "modified", "additions": 6, "deletions": 8, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/06411c47694916aaf22ef30b6b8877d7659b2002/src%2Flibsyntax%2Fprint%2Fpprust.rs", "raw_url": "https://github.com/rust-lang/rust/raw/06411c47694916aaf22ef30b6b8877d7659b2002/src%2Flibsyntax%2Fprint%2Fpprust.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fprint%2Fpprust.rs?ref=06411c47694916aaf22ef30b6b8877d7659b2002", "patch": "@@ -432,13 +432,7 @@ pub fn mac_to_string(arg: &ast::Mac) -> String {\n }\n \n pub fn visibility_qualified(vis: &ast::Visibility, s: &str) -> String {\n-    match *vis {\n-        ast::Visibility::Public => format!(\"pub {}\", s),\n-        ast::Visibility::Crate(_) => format!(\"pub(crate) {}\", s),\n-        ast::Visibility::Restricted { ref path, .. } =>\n-            format!(\"pub({}) {}\", to_string(|s| s.print_path(path, false, 0, true)), s),\n-        ast::Visibility::Inherited => s.to_string()\n-    }\n+    format!(\"{}{}\", to_string(|s| s.print_visibility(vis)), s)\n }\n \n fn needs_parentheses(expr: &ast::Expr) -> bool {\n@@ -1473,7 +1467,11 @@ impl<'a> State<'a> {\n             ast::Visibility::Crate(_) => self.word_nbsp(\"pub(crate)\"),\n             ast::Visibility::Restricted { ref path, .. } => {\n                 let path = to_string(|s| s.print_path(path, false, 0, true));\n-                self.word_nbsp(&format!(\"pub({})\", path))\n+                if path == \"self\" || path == \"super\" {\n+                    self.word_nbsp(&format!(\"pub({})\", path))\n+                } else {\n+                    self.word_nbsp(&format!(\"pub(in {})\", path))\n+                }\n             }\n             ast::Visibility::Inherited => Ok(())\n         }"}]}