{"sha": "c03775e4779bd48a2607cbd04fb0e9d4fa5b92cb", "node_id": "C_kwDOAAsO6NoAKGMwMzc3NWU0Nzc5YmQ0OGEyNjA3Y2JkMDRmYjBlOWQ0ZmE1YjkyY2I", "commit": {"author": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2023-03-10T09:26:02Z"}, "committer": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2023-03-10T09:26:02Z"}, "message": "Fix is_quiescent reporting", "tree": {"sha": "a5940d9a1267e8832cdbaeff7c51e78e33f601a7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a5940d9a1267e8832cdbaeff7c51e78e33f601a7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c03775e4779bd48a2607cbd04fb0e9d4fa5b92cb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c03775e4779bd48a2607cbd04fb0e9d4fa5b92cb", "html_url": "https://github.com/rust-lang/rust/commit/c03775e4779bd48a2607cbd04fb0e9d4fa5b92cb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c03775e4779bd48a2607cbd04fb0e9d4fa5b92cb/comments", "author": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2cb60343ed3774d4645d7d14dff8a1119d3c6785", "url": "https://api.github.com/repos/rust-lang/rust/commits/2cb60343ed3774d4645d7d14dff8a1119d3c6785", "html_url": "https://github.com/rust-lang/rust/commit/2cb60343ed3774d4645d7d14dff8a1119d3c6785"}], "stats": {"total": 12, "additions": 7, "deletions": 5}, "files": [{"sha": "dd0804b4398a9599eeb21e146eb79f8f5536fdd2", "filename": "crates/rust-analyzer/src/main_loop.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/c03775e4779bd48a2607cbd04fb0e9d4fa5b92cb/crates%2Frust-analyzer%2Fsrc%2Fmain_loop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c03775e4779bd48a2607cbd04fb0e9d4fa5b92cb/crates%2Frust-analyzer%2Fsrc%2Fmain_loop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fmain_loop.rs?ref=c03775e4779bd48a2607cbd04fb0e9d4fa5b92cb", "patch": "@@ -444,7 +444,7 @@ impl GlobalState {\n                     ProjectWorkspaceProgress::End(workspaces) => {\n                         self.fetch_workspaces_queue.op_completed(Some(workspaces));\n                         if let Err(e) = self.fetch_workspace_error() {\n-                            tracing::error!(\"FetchWorkspaceError:\\n{e}\")\n+                            tracing::error!(\"FetchWorkspaceError:\\n{e}\");\n                         }\n \n                         let old = Arc::clone(&self.workspaces);\n@@ -468,7 +468,7 @@ impl GlobalState {\n                     BuildDataProgress::End(build_data_result) => {\n                         self.fetch_build_data_queue.op_completed(build_data_result);\n                         if let Err(e) = self.fetch_build_data_error() {\n-                            tracing::error!(\"FetchBuildDataError:\\n{e}\")\n+                            tracing::error!(\"FetchBuildDataError:\\n{e}\");\n                         }\n \n                         self.switch_workspaces(\"fetched build data\".to_string());\n@@ -495,14 +495,14 @@ impl GlobalState {\n                     }\n                 }\n             }\n-            vfs::loader::Message::Progress { n_total: 0, .. } => {}\n             vfs::loader::Message::Progress { n_total, n_done, config_version } => {\n                 always!(config_version <= self.vfs_config_version);\n \n                 self.vfs_progress_config_version = config_version;\n                 self.vfs_progress_n_total = n_total;\n                 self.vfs_progress_n_done = n_done;\n \n+                // if n_total != 0 {\n                 let state = if n_done == 0 {\n                     Progress::Begin\n                 } else if n_done < n_total {\n@@ -517,7 +517,8 @@ impl GlobalState {\n                     Some(format!(\"{n_done}/{n_total}\")),\n                     Some(Progress::fraction(n_done, n_total)),\n                     None,\n-                )\n+                );\n+                // }\n             }\n         }\n     }"}, {"sha": "fca242d91fd4e378d4c2b7208b2869ea62d4af3e", "filename": "crates/rust-analyzer/src/reload.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/c03775e4779bd48a2607cbd04fb0e9d4fa5b92cb/crates%2Frust-analyzer%2Fsrc%2Freload.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c03775e4779bd48a2607cbd04fb0e9d4fa5b92cb/crates%2Frust-analyzer%2Fsrc%2Freload.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Freload.rs?ref=c03775e4779bd48a2607cbd04fb0e9d4fa5b92cb", "patch": "@@ -56,7 +56,8 @@ pub(crate) enum BuildDataProgress {\n \n impl GlobalState {\n     pub(crate) fn is_quiescent(&self) -> bool {\n-        !(self.fetch_workspaces_queue.op_in_progress()\n+        !(self.last_reported_status.is_none()\n+            || self.fetch_workspaces_queue.op_in_progress()\n             || self.fetch_build_data_queue.op_in_progress()\n             || self.vfs_progress_config_version < self.vfs_config_version\n             || self.vfs_progress_n_done < self.vfs_progress_n_total)"}]}