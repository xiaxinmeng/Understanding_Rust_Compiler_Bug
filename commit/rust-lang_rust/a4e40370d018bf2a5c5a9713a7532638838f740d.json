{"sha": "a4e40370d018bf2a5c5a9713a7532638838f740d", "node_id": "C_kwDOAAsO6NoAKGE0ZTQwMzcwZDAxOGJmMmE1YzVhOTcxM2E3NTMyNjM4ODM4Zjc0MGQ", "commit": {"author": {"name": "Santiago Pastorino", "email": "spastorino@gmail.com", "date": "2023-03-08T20:59:06Z"}, "committer": {"name": "Santiago Pastorino", "email": "spastorino@gmail.com", "date": "2023-03-14T13:20:35Z"}, "message": "Make fns from other crates with RPITIT work", "tree": {"sha": "96cafca745c8db2ba910e4e9641bd484360f0e48", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/96cafca745c8db2ba910e4e9641bd484360f0e48"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a4e40370d018bf2a5c5a9713a7532638838f740d", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEF0ntrgrd9qf9uuThgTGiTgx5768FAmQQdKQACgkQgTGiTgx5\n768e6A//eroTXV2Gfo35XEr+81bs8AjlyNVeuHq5B6C6aMZAouLOaR9DjlpVvNKK\n+NDqNVeU3jbS4JX0t8bHX2ebtk0xSJaISRVbEHoBgFw6D5gpLNdovIPduraOEDYL\n2OIXt2+v2fcGz4QRwS1Nt9wsoBRCPRrgqYBXQ7XXKQ/CY5kwqVvP8XfEfvB+ZMCg\n/vUhpjxPWqx3f5uB0durrwR6yrQ9E6sZ1x9Oqjg78sUaU7kfbea3w4zylSl0IzOJ\nfXijOhc9saAabnqYCRKU9j/FznIuw4hXDplDEpVZVmEYObICcxFhEkhpEkReuzsn\n0iloO+lwsbpNSNy1DZ9xT4QXzowE1JsHr/iToTetCSaRUGXS05XLuKeS8LwklfPa\n7Gfgs4a1Gy/8hUPV3bcGxxoOc6APRucrXgxBr39GMNEeYL4Z1l8cAlyxGxz+EBy0\npaZcuhLCvuBP9Auk8UwP9vNTa/G3/PKS6Y8yUnVUKGPaBoVq/aP9ifsr0cF/aG+8\nEiUBpjrGTWhEiNoVG0CNuuwH/H9v79TQbcgYjYpQWxwaWE01RQO2LnW0e4wyGXe5\nopAFwqPn3Yx+YdPs8b9Lj87Hob6vhQuPpVxMj9Cyh8IQk63tcc6mCraclPfoQgpp\nqnC1dPf2AkDoYMNdj60SWKeil9t7WypB5YkyAKtqDFoXF2O4Qu8=\n=njOT\n-----END PGP SIGNATURE-----", "payload": "tree 96cafca745c8db2ba910e4e9641bd484360f0e48\nparent b535da6841c8dec255a1734b9ac1ed9e9e7c5e25\nauthor Santiago Pastorino <spastorino@gmail.com> 1678309146 -0300\ncommitter Santiago Pastorino <spastorino@gmail.com> 1678800035 -0300\n\nMake fns from other crates with RPITIT work\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a4e40370d018bf2a5c5a9713a7532638838f740d", "html_url": "https://github.com/rust-lang/rust/commit/a4e40370d018bf2a5c5a9713a7532638838f740d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a4e40370d018bf2a5c5a9713a7532638838f740d/comments", "author": {"login": "spastorino", "id": 52642, "node_id": "MDQ6VXNlcjUyNjQy", "avatar_url": "https://avatars.githubusercontent.com/u/52642?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spastorino", "html_url": "https://github.com/spastorino", "followers_url": "https://api.github.com/users/spastorino/followers", "following_url": "https://api.github.com/users/spastorino/following{/other_user}", "gists_url": "https://api.github.com/users/spastorino/gists{/gist_id}", "starred_url": "https://api.github.com/users/spastorino/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spastorino/subscriptions", "organizations_url": "https://api.github.com/users/spastorino/orgs", "repos_url": "https://api.github.com/users/spastorino/repos", "events_url": "https://api.github.com/users/spastorino/events{/privacy}", "received_events_url": "https://api.github.com/users/spastorino/received_events", "type": "User", "site_admin": false}, "committer": {"login": "spastorino", "id": 52642, "node_id": "MDQ6VXNlcjUyNjQy", "avatar_url": "https://avatars.githubusercontent.com/u/52642?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spastorino", "html_url": "https://github.com/spastorino", "followers_url": "https://api.github.com/users/spastorino/followers", "following_url": "https://api.github.com/users/spastorino/following{/other_user}", "gists_url": "https://api.github.com/users/spastorino/gists{/gist_id}", "starred_url": "https://api.github.com/users/spastorino/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spastorino/subscriptions", "organizations_url": "https://api.github.com/users/spastorino/orgs", "repos_url": "https://api.github.com/users/spastorino/repos", "events_url": "https://api.github.com/users/spastorino/events{/privacy}", "received_events_url": "https://api.github.com/users/spastorino/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b535da6841c8dec255a1734b9ac1ed9e9e7c5e25", "url": "https://api.github.com/repos/rust-lang/rust/commits/b535da6841c8dec255a1734b9ac1ed9e9e7c5e25", "html_url": "https://github.com/rust-lang/rust/commit/b535da6841c8dec255a1734b9ac1ed9e9e7c5e25"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "3c4fc9cb530a453f620ac042ce7274884514cbfc", "filename": "compiler/rustc_hir/src/definitions.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/a4e40370d018bf2a5c5a9713a7532638838f740d/compiler%2Frustc_hir%2Fsrc%2Fdefinitions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a4e40370d018bf2a5c5a9713a7532638838f740d/compiler%2Frustc_hir%2Fsrc%2Fdefinitions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir%2Fsrc%2Fdefinitions.rs?ref=a4e40370d018bf2a5c5a9713a7532638838f740d", "patch": "@@ -404,8 +404,12 @@ impl DefPathData {\n         match *self {\n             TypeNs(name) | ValueNs(name) | MacroNs(name) | LifetimeNs(name) => Some(name),\n \n+            // We use this name when collecting `ModChild`s.\n+            // FIXME this could probably be removed with some refactoring to the name resolver.\n+            ImplTraitAssocTy => Some(kw::Empty),\n+\n             Impl | ForeignMod | CrateRoot | Use | GlobalAsm | ClosureExpr | Ctor | AnonConst\n-            | ImplTrait | ImplTraitAssocTy => None,\n+            | ImplTrait => None,\n         }\n     }\n "}, {"sha": "a28161245384c033812c60d899001a80e5bdae14", "filename": "compiler/rustc_ty_utils/src/assoc.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/a4e40370d018bf2a5c5a9713a7532638838f740d/compiler%2Frustc_ty_utils%2Fsrc%2Fassoc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a4e40370d018bf2a5c5a9713a7532638838f740d/compiler%2Frustc_ty_utils%2Fsrc%2Fassoc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ty_utils%2Fsrc%2Fassoc.rs?ref=a4e40370d018bf2a5c5a9713a7532638838f740d", "patch": "@@ -328,6 +328,9 @@ fn impl_associated_item_for_impl_trait_in_trait(\n     // `opt_local_def_id_to_hir_id` with `None`.\n     impl_assoc_ty.opt_local_def_id_to_hir_id(None);\n \n+    // Copy span of the opaque.\n+    impl_assoc_ty.def_ident_span(Some(span));\n+\n     impl_assoc_ty.associated_item(ty::AssocItem {\n         name: kw::Empty,\n         kind: ty::AssocKind::Type,\n@@ -342,6 +345,9 @@ fn impl_associated_item_for_impl_trait_in_trait(\n     // extra predicates to assume.\n     impl_assoc_ty.param_env(tcx.param_env(impl_fn_def_id));\n \n+    // Copy visility of the containing function.\n+    impl_assoc_ty.visibility(tcx.visibility(impl_fn_def_id));\n+\n     // Copy impl_defaultness of the containing function.\n     impl_assoc_ty.impl_defaultness(tcx.impl_defaultness(impl_fn_def_id));\n "}, {"sha": "df77372aabdfcf51bcda7bf479eb8fd62c3bb7f8", "filename": "tests/ui/impl-trait/in-trait/foreign.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a4e40370d018bf2a5c5a9713a7532638838f740d/tests%2Fui%2Fimpl-trait%2Fin-trait%2Fforeign.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a4e40370d018bf2a5c5a9713a7532638838f740d/tests%2Fui%2Fimpl-trait%2Fin-trait%2Fforeign.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fimpl-trait%2Fin-trait%2Fforeign.rs?ref=a4e40370d018bf2a5c5a9713a7532638838f740d", "patch": "@@ -1,5 +1,7 @@\n // check-pass\n // aux-build: rpitit.rs\n+// [next] compile-flags: -Zlower-impl-trait-in-trait-to-assoc-ty\n+// revisions: current next\n \n extern crate rpitit;\n "}]}