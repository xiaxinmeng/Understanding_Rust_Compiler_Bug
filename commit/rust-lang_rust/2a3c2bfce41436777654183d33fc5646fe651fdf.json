{"sha": "2a3c2bfce41436777654183d33fc5646fe651fdf", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJhM2MyYmZjZTQxNDM2Nzc3NjU0MTgzZDMzZmM1NjQ2ZmU2NTFmZGY=", "commit": {"author": {"name": "Josh Stone", "email": "cuviper@gmail.com", "date": "2019-03-28T01:15:21Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-03-28T01:15:21Z"}, "message": "Rollup merge of #58253 - taiki-e:librustc_driver-2018, r=petrochenkov\n\nlibrustc_driver => 2018\n\nTransitions `librustc_driver` to Rust 2018; cc #58099\n\nr? @Centril", "tree": {"sha": "8cc49566f8be74ba41c98df5dd3485f9ca6c8d8e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8cc49566f8be74ba41c98df5dd3485f9ca6c8d8e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2a3c2bfce41436777654183d33fc5646fe651fdf", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJcnCApCRBK7hj4Ov3rIwAAdHIIAAbqL02NrZJDuAyk4xbIMHlv\nPrQuW41aH8yV2f0KHwApOG98zJR7Kl6JGC5Z6O1xlvPeCC3emjWy1+J1APWLJzhx\nvtX/5nb59Ss/lTT/A6pXNEHKRFEg+/aFcHYt8XNyG1adAY6udvGGJ2k4Qi742iiP\ncp+OgWA6vEZm/FqbqJWnJzQ8WagceLmMOH2NUOFDzuvAfEd+dUAb9rw71DaJqEqb\nZpT+JlDxcMFMWrxsQPrAIgLKWlr5ncExB5uVP76DHnHs1AR7X3Ww2A0wbgjxDZfG\n/JPI/lD99SJBIzwgoSltbxqrX3RC5NN6fqDpCBkvvixERvboRs9mMZwZlPyaYcM=\n=+eUS\n-----END PGP SIGNATURE-----\n", "payload": "tree 8cc49566f8be74ba41c98df5dd3485f9ca6c8d8e\nparent c818c1a1d603b0b00241764ca951b7e8627a965b\nparent 24a0caec832d774ede930597692b291286176802\nauthor Josh Stone <cuviper@gmail.com> 1553735721 -0700\ncommitter GitHub <noreply@github.com> 1553735721 -0700\n\nRollup merge of #58253 - taiki-e:librustc_driver-2018, r=petrochenkov\n\nlibrustc_driver => 2018\n\nTransitions `librustc_driver` to Rust 2018; cc #58099\n\nr? @Centril\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2a3c2bfce41436777654183d33fc5646fe651fdf", "html_url": "https://github.com/rust-lang/rust/commit/2a3c2bfce41436777654183d33fc5646fe651fdf", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2a3c2bfce41436777654183d33fc5646fe651fdf/comments", "author": {"login": "cuviper", "id": 36186, "node_id": "MDQ6VXNlcjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/36186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuviper", "html_url": "https://github.com/cuviper", "followers_url": "https://api.github.com/users/cuviper/followers", "following_url": "https://api.github.com/users/cuviper/following{/other_user}", "gists_url": "https://api.github.com/users/cuviper/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuviper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuviper/subscriptions", "organizations_url": "https://api.github.com/users/cuviper/orgs", "repos_url": "https://api.github.com/users/cuviper/repos", "events_url": "https://api.github.com/users/cuviper/events{/privacy}", "received_events_url": "https://api.github.com/users/cuviper/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c818c1a1d603b0b00241764ca951b7e8627a965b", "url": "https://api.github.com/repos/rust-lang/rust/commits/c818c1a1d603b0b00241764ca951b7e8627a965b", "html_url": "https://github.com/rust-lang/rust/commit/c818c1a1d603b0b00241764ca951b7e8627a965b"}, {"sha": "24a0caec832d774ede930597692b291286176802", "url": "https://api.github.com/repos/rust-lang/rust/commits/24a0caec832d774ede930597692b291286176802", "html_url": "https://github.com/rust-lang/rust/commit/24a0caec832d774ede930597692b291286176802"}], "stats": {"total": 68, "additions": 23, "deletions": 45}, "files": [{"sha": "5432f80a1712c076045f8ccb6f98721537a60999", "filename": "src/librustc_driver/Cargo.toml", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/2a3c2bfce41436777654183d33fc5646fe651fdf/src%2Flibrustc_driver%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/2a3c2bfce41436777654183d33fc5646fe651fdf/src%2Flibrustc_driver%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_driver%2FCargo.toml?ref=2a3c2bfce41436777654183d33fc5646fe651fdf", "patch": "@@ -2,6 +2,7 @@\n authors = [\"The Rust Project Developers\"]\n name = \"rustc_driver\"\n version = \"0.0.0\"\n+edition = \"2018\"\n \n [lib]\n name = \"rustc_driver\"\n@@ -13,14 +14,14 @@ arena = { path = \"../libarena\" }\n graphviz = { path = \"../libgraphviz\" }\n log = \"0.4\"\n env_logger = { version = \"0.5\", default-features = false }\n-rustc-rayon = \"0.1.2\"\n+rayon = { version = \"0.1.2\", package = \"rustc-rayon\" }\n scoped-tls = \"1.0\"\n rustc = { path = \"../librustc\" }\n rustc_allocator = { path = \"../librustc_allocator\" }\n rustc_target = { path = \"../librustc_target\" }\n rustc_borrowck = { path = \"../librustc_borrowck\" }\n rustc_data_structures = { path = \"../librustc_data_structures\" }\n-rustc_errors = { path = \"../librustc_errors\" }\n+errors = { path = \"../librustc_errors\", package = \"rustc_errors\" }\n rustc_incremental = { path = \"../librustc_incremental\" }\n rustc_lint = { path = \"../librustc_lint\" }\n rustc_metadata = { path = \"../librustc_metadata\" }"}, {"sha": "4b7cffaad5509711e6abea758d79171fe47ac9f4", "filename": "src/librustc_driver/lib.rs", "status": "modified", "additions": 2, "deletions": 29, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/2a3c2bfce41436777654183d33fc5646fe651fdf/src%2Flibrustc_driver%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2a3c2bfce41436777654183d33fc5646fe651fdf/src%2Flibrustc_driver%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_driver%2Flib.rs?ref=2a3c2bfce41436777654183d33fc5646fe651fdf", "patch": "@@ -16,40 +16,13 @@\n \n #![recursion_limit=\"256\"]\n \n-extern crate arena;\n+#![deny(rust_2018_idioms)]\n+\n pub extern crate getopts;\n-extern crate graphviz;\n-extern crate env_logger;\n #[cfg(unix)]\n extern crate libc;\n-extern crate rustc_rayon as rayon;\n-extern crate rustc;\n-extern crate rustc_allocator;\n-extern crate rustc_target;\n-extern crate rustc_borrowck;\n-extern crate rustc_data_structures;\n-extern crate rustc_errors as errors;\n-extern crate rustc_passes;\n-extern crate rustc_lint;\n-extern crate rustc_plugin;\n-extern crate rustc_privacy;\n-extern crate rustc_incremental;\n-extern crate rustc_metadata;\n-extern crate rustc_mir;\n-extern crate rustc_resolve;\n-extern crate rustc_save_analysis;\n-extern crate rustc_traits;\n-extern crate rustc_codegen_utils;\n-extern crate rustc_typeck;\n-extern crate rustc_interface;\n-extern crate scoped_tls;\n-extern crate serialize;\n-extern crate smallvec;\n #[macro_use]\n extern crate log;\n-extern crate syntax;\n-extern crate syntax_ext;\n-extern crate syntax_pos;\n \n use pretty::{PpMode, UserIdentifiedItem};\n "}, {"sha": "5cefc35607db07f9155b7979549152658ca5ce7c", "filename": "src/librustc_driver/pretty.rs", "status": "modified", "additions": 18, "deletions": 14, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/2a3c2bfce41436777654183d33fc5646fe651fdf/src%2Flibrustc_driver%2Fpretty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2a3c2bfce41436777654183d33fc5646fe651fdf/src%2Flibrustc_driver%2Fpretty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_driver%2Fpretty.rs?ref=2a3c2bfce41436777654183d33fc5646fe651fdf", "patch": "@@ -35,9 +35,9 @@ pub use self::UserIdentifiedItem::*;\n pub use self::PpSourceMode::*;\n pub use self::PpMode::*;\n use self::NodesMatchingUII::*;\n-use abort_on_err;\n+use crate::abort_on_err;\n \n-use source_name;\n+use crate::source_name;\n \n #[derive(Copy, Clone, PartialEq, Debug)]\n pub enum PpSourceMode {\n@@ -191,7 +191,7 @@ impl PpSourceMode {\n         tcx: TyCtxt<'tcx, 'tcx, 'tcx>,\n         f: F\n     ) -> A\n-        where F: FnOnce(&dyn HirPrinterSupport, &hir::Crate) -> A\n+        where F: FnOnce(&dyn HirPrinterSupport<'_>, &hir::Crate) -> A\n     {\n         match *self {\n             PpmNormal => {\n@@ -296,7 +296,7 @@ impl<'hir> HirPrinterSupport<'hir> for NoAnn<'hir> {\n \n impl<'hir> pprust::PpAnn for NoAnn<'hir> {}\n impl<'hir> pprust_hir::PpAnn for NoAnn<'hir> {\n-    fn nested(&self, state: &mut pprust_hir::State, nested: pprust_hir::Nested)\n+    fn nested(&self, state: &mut pprust_hir::State<'_>, nested: pprust_hir::Nested)\n               -> io::Result<()> {\n         if let Some(tcx) = self.tcx {\n             pprust_hir::PpAnn::nested(tcx.hir(), state, nested)\n@@ -322,13 +322,13 @@ impl<'hir> PrinterSupport for IdentifiedAnnotation<'hir> {\n }\n \n impl<'hir> pprust::PpAnn for IdentifiedAnnotation<'hir> {\n-    fn pre(&self, s: &mut pprust::State, node: pprust::AnnNode) -> io::Result<()> {\n+    fn pre(&self, s: &mut pprust::State<'_>, node: pprust::AnnNode<'_>) -> io::Result<()> {\n         match node {\n             pprust::AnnNode::Expr(_) => s.popen(),\n             _ => Ok(()),\n         }\n     }\n-    fn post(&self, s: &mut pprust::State, node: pprust::AnnNode) -> io::Result<()> {\n+    fn post(&self, s: &mut pprust::State<'_>, node: pprust::AnnNode<'_>) -> io::Result<()> {\n         match node {\n             pprust::AnnNode::Ident(_) |\n             pprust::AnnNode::Name(_) => Ok(()),\n@@ -373,21 +373,21 @@ impl<'hir> HirPrinterSupport<'hir> for IdentifiedAnnotation<'hir> {\n }\n \n impl<'hir> pprust_hir::PpAnn for IdentifiedAnnotation<'hir> {\n-    fn nested(&self, state: &mut pprust_hir::State, nested: pprust_hir::Nested)\n+    fn nested(&self, state: &mut pprust_hir::State<'_>, nested: pprust_hir::Nested)\n               -> io::Result<()> {\n         if let Some(ref tcx) = self.tcx {\n             pprust_hir::PpAnn::nested(tcx.hir(), state, nested)\n         } else {\n             Ok(())\n         }\n     }\n-    fn pre(&self, s: &mut pprust_hir::State, node: pprust_hir::AnnNode) -> io::Result<()> {\n+    fn pre(&self, s: &mut pprust_hir::State<'_>, node: pprust_hir::AnnNode<'_>) -> io::Result<()> {\n         match node {\n             pprust_hir::AnnNode::Expr(_) => s.popen(),\n             _ => Ok(()),\n         }\n     }\n-    fn post(&self, s: &mut pprust_hir::State, node: pprust_hir::AnnNode) -> io::Result<()> {\n+    fn post(&self, s: &mut pprust_hir::State<'_>, node: pprust_hir::AnnNode<'_>) -> io::Result<()> {\n         match node {\n             pprust_hir::AnnNode::Name(_) => Ok(()),\n             pprust_hir::AnnNode::Item(item) => {\n@@ -434,7 +434,7 @@ impl<'a> PrinterSupport for HygieneAnnotation<'a> {\n }\n \n impl<'a> pprust::PpAnn for HygieneAnnotation<'a> {\n-    fn post(&self, s: &mut pprust::State, node: pprust::AnnNode) -> io::Result<()> {\n+    fn post(&self, s: &mut pprust::State<'_>, node: pprust::AnnNode<'_>) -> io::Result<()> {\n         match node {\n             pprust::AnnNode::Ident(&ast::Ident { name, span }) => {\n                 s.s.space()?;\n@@ -476,7 +476,7 @@ impl<'b, 'tcx> HirPrinterSupport<'tcx> for TypedAnnotation<'b, 'tcx> {\n }\n \n impl<'a, 'tcx> pprust_hir::PpAnn for TypedAnnotation<'a, 'tcx> {\n-    fn nested(&self, state: &mut pprust_hir::State, nested: pprust_hir::Nested)\n+    fn nested(&self, state: &mut pprust_hir::State<'_>, nested: pprust_hir::Nested)\n               -> io::Result<()> {\n         let old_tables = self.tables.get();\n         if let pprust_hir::Nested::Body(id) = nested {\n@@ -486,13 +486,13 @@ impl<'a, 'tcx> pprust_hir::PpAnn for TypedAnnotation<'a, 'tcx> {\n         self.tables.set(old_tables);\n         Ok(())\n     }\n-    fn pre(&self, s: &mut pprust_hir::State, node: pprust_hir::AnnNode) -> io::Result<()> {\n+    fn pre(&self, s: &mut pprust_hir::State<'_>, node: pprust_hir::AnnNode<'_>) -> io::Result<()> {\n         match node {\n             pprust_hir::AnnNode::Expr(_) => s.popen(),\n             _ => Ok(()),\n         }\n     }\n-    fn post(&self, s: &mut pprust_hir::State, node: pprust_hir::AnnNode) -> io::Result<()> {\n+    fn post(&self, s: &mut pprust_hir::State<'_>, node: pprust_hir::AnnNode<'_>) -> io::Result<()> {\n         match node {\n             pprust_hir::AnnNode::Expr(expr) => {\n                 s.s.space()?;\n@@ -580,7 +580,11 @@ impl UserIdentifiedItem {\n         }\n     }\n \n-    fn to_one_node_id(self, user_option: &str, sess: &Session, map: &hir_map::Map) -> ast::NodeId {\n+    fn to_one_node_id(self,\n+                      user_option: &str,\n+                      sess: &Session,\n+                      map: &hir_map::Map<'_>)\n+                      -> ast::NodeId {\n         let fail_because = |is_wrong_because| -> ast::NodeId {\n             let message = format!(\"{} needs NodeId (int) or unique path suffix (b::c::d); got \\\n                                    {}, which {}\","}]}