{"sha": "803576c17e24a5a9e680849346f58d6b6545fb79", "node_id": "MDY6Q29tbWl0NzI0NzEyOjgwMzU3NmMxN2UyNGE1YTllNjgwODQ5MzQ2ZjU4ZDZiNjU0NWZiNzk=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2016-10-19T16:48:46Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2016-10-19T17:08:05Z"}, "message": "Enable line number debuginfo in releases\n\nThis commit enables by default passing the `-C debuginfo=1` argument to the\ncompiler for the stable, beta, and nightly release channels. A new configure\noption was also added, `--enable-debuginfo-lines`, to enable this behavior in\ndeveloper builds as well.\n\nCloses #36452", "tree": {"sha": "24050b37334719c9f544ac8803db0d7ae3542717", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/24050b37334719c9f544ac8803db0d7ae3542717"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/803576c17e24a5a9e680849346f58d6b6545fb79", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/803576c17e24a5a9e680849346f58d6b6545fb79", "html_url": "https://github.com/rust-lang/rust/commit/803576c17e24a5a9e680849346f58d6b6545fb79", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/803576c17e24a5a9e680849346f58d6b6545fb79/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a41505f4f4a93bf94f4f7439d41afd826ab20b94", "url": "https://api.github.com/repos/rust-lang/rust/commits/a41505f4f4a93bf94f4f7439d41afd826ab20b94", "html_url": "https://github.com/rust-lang/rust/commit/a41505f4f4a93bf94f4f7439d41afd826ab20b94"}], "stats": {"total": 22, "additions": 21, "deletions": 1}, "files": [{"sha": "ceb67869efeeff3ea441e9e46a9916db4909068a", "filename": "configure", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/803576c17e24a5a9e680849346f58d6b6545fb79/configure", "raw_url": "https://github.com/rust-lang/rust/raw/803576c17e24a5a9e680849346f58d6b6545fb79/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=803576c17e24a5a9e680849346f58d6b6545fb79", "patch": "@@ -636,6 +636,7 @@ opt_nosave optimize-llvm 1 \"build optimized LLVM\"\n opt_nosave llvm-assertions 0 \"build LLVM with assertions\"\n opt_nosave debug-assertions 0 \"build with debugging assertions\"\n opt_nosave debuginfo 0 \"build with debugger metadata\"\n+opt_nosave debuginfo-lines 0 \"build with line number debugger metadata\"\n opt_nosave debug-jemalloc 0 \"build jemalloc with --enable-debug --enable-fill\"\n \n valopt localstatedir \"/var/lib\" \"local state directory\"\n@@ -721,8 +722,13 @@ case \"$CFG_RELEASE_CHANNEL\" in\n     nightly )\n \tmsg \"overriding settings for $CFG_RELEASE_CHANNEL\"\n \tCFG_ENABLE_LLVM_ASSERTIONS=1\n+\tCFG_ENABLE_DEBUGINFO_LINES=1\n \t;;\n-    dev | beta | stable)\n+    beta | stable)\n+\tmsg \"overriding settings for $CFG_RELEASE_CHANNEL\"\n+\tCFG_ENABLE_DEBUGINFO_LINES=1\n+\t;;\n+    dev)\n \t;;\n     *)\n         err \"release channel must be 'dev', 'nightly', 'beta' or 'stable'\"\n@@ -752,6 +758,7 @@ if [ -n \"$CFG_DISABLE_OPTIMIZE_LLVM\" ]; then putvar CFG_DISABLE_OPTIMIZE_LLVM; f\n if [ -n \"$CFG_ENABLE_LLVM_ASSERTIONS\" ]; then putvar CFG_ENABLE_LLVM_ASSERTIONS; fi\n if [ -n \"$CFG_ENABLE_DEBUG_ASSERTIONS\" ]; then putvar CFG_ENABLE_DEBUG_ASSERTIONS; fi\n if [ -n \"$CFG_ENABLE_DEBUGINFO\" ]; then putvar CFG_ENABLE_DEBUGINFO; fi\n+if [ -n \"$CFG_ENABLE_DEBUGINFO_LINES\" ]; then putvar CFG_ENABLE_DEBUGINFO_LINES; fi\n if [ -n \"$CFG_ENABLE_DEBUG_JEMALLOC\" ]; then putvar CFG_ENABLE_DEBUG_JEMALLOC; fi\n \n step_msg \"looking for build programs\""}, {"sha": "8ffb5585769876a58c847bdf1396c7034fc7c5fe", "filename": "mk/main.mk", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/803576c17e24a5a9e680849346f58d6b6545fb79/mk%2Fmain.mk", "raw_url": "https://github.com/rust-lang/rust/raw/803576c17e24a5a9e680849346f58d6b6545fb79/mk%2Fmain.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fmain.mk?ref=803576c17e24a5a9e680849346f58d6b6545fb79", "patch": "@@ -141,6 +141,9 @@ endif\n ifdef CFG_ENABLE_DEBUGINFO\n   $(info cfg: enabling debuginfo (CFG_ENABLE_DEBUGINFO))\n   CFG_RUSTC_FLAGS += -g\n+else ifdef CFG_ENABLE_DEBUGINFO_LINES\n+  $(info cfg: enabling line number debuginfo (CFG_ENABLE_DEBUGINFO_LINES))\n+  CFG_RUSTC_FLAGS += -C debuginfo=1\n endif\n \n ifdef SAVE_TEMPS"}, {"sha": "d6f2fd2841724c8c2102d0585183c48a90a75b20", "filename": "src/bootstrap/bin/rustc.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/803576c17e24a5a9e680849346f58d6b6545fb79/src%2Fbootstrap%2Fbin%2Frustc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/803576c17e24a5a9e680849346f58d6b6545fb79/src%2Fbootstrap%2Fbin%2Frustc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbin%2Frustc.rs?ref=803576c17e24a5a9e680849346f58d6b6545fb79", "patch": "@@ -112,6 +112,8 @@ fn main() {\n         // code.\n         if env::var(\"RUSTC_DEBUGINFO\") == Ok(\"true\".to_string()) {\n             cmd.arg(\"-g\");\n+        } else if env::var(\"RUSTC_DEBUGINFO_LINES\") == Ok(\"true\".to_string()) {\n+            cmd.arg(\"-Cdebuginfo=1\");\n         }\n         let debug_assertions = match env::var(\"RUSTC_DEBUG_ASSERTIONS\") {\n             Ok(s) => if s == \"true\" {\"y\"} else {\"n\"},"}, {"sha": "8c0ad1ccf825fc8c8af12140963faa8f8c4c9b34", "filename": "src/bootstrap/config.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/803576c17e24a5a9e680849346f58d6b6545fb79/src%2Fbootstrap%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/803576c17e24a5a9e680849346f58d6b6545fb79/src%2Fbootstrap%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.rs?ref=803576c17e24a5a9e680849346f58d6b6545fb79", "patch": "@@ -56,6 +56,7 @@ pub struct Config {\n     pub rust_codegen_units: u32,\n     pub rust_debug_assertions: bool,\n     pub rust_debuginfo: bool,\n+    pub rust_debuginfo_lines: bool,\n     pub rust_rpath: bool,\n     pub rustc_default_linker: Option<String>,\n     pub rustc_default_ar: Option<String>,\n@@ -141,6 +142,7 @@ struct Rust {\n     codegen_units: Option<u32>,\n     debug_assertions: Option<bool>,\n     debuginfo: Option<bool>,\n+    debuginfo_lines: Option<bool>,\n     debug_jemalloc: Option<bool>,\n     use_jemalloc: Option<bool>,\n     backtrace: Option<bool>,\n@@ -239,6 +241,7 @@ impl Config {\n         if let Some(ref rust) = toml.rust {\n             set(&mut config.rust_debug_assertions, rust.debug_assertions);\n             set(&mut config.rust_debuginfo, rust.debuginfo);\n+            set(&mut config.rust_debuginfo_lines, rust.debuginfo_lines);\n             set(&mut config.rust_optimize, rust.optimize);\n             set(&mut config.rust_optimize_tests, rust.optimize_tests);\n             set(&mut config.rust_debuginfo_tests, rust.debuginfo_tests);\n@@ -329,6 +332,7 @@ impl Config {\n                 (\"OPTIMIZE\", self.rust_optimize),\n                 (\"DEBUG_ASSERTIONS\", self.rust_debug_assertions),\n                 (\"DEBUGINFO\", self.rust_debuginfo),\n+                (\"DEBUGINFO_LINES\", self.rust_debuginfo_lines),\n                 (\"JEMALLOC\", self.use_jemalloc),\n                 (\"DEBUG_JEMALLOC\", self.debug_jemalloc),\n                 (\"RPATH\", self.rust_rpath),"}, {"sha": "b4730c003d6461e6ac7d434157ff2cb74febb8fe", "filename": "src/bootstrap/config.toml.example", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/803576c17e24a5a9e680849346f58d6b6545fb79/src%2Fbootstrap%2Fconfig.toml.example", "raw_url": "https://github.com/rust-lang/rust/raw/803576c17e24a5a9e680849346f58d6b6545fb79/src%2Fbootstrap%2Fconfig.toml.example", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.toml.example?ref=803576c17e24a5a9e680849346f58d6b6545fb79", "patch": "@@ -99,6 +99,9 @@\n # Whether or not debuginfo is emitted\n #debuginfo = false\n \n+# Whether or not line number debug information is emitted\n+#debuginfo-lines = false\n+\n # Whether or not jemalloc is built and enabled\n #use-jemalloc = true\n "}, {"sha": "5acc00fe68552c24f349abb16a23b6edd99dad04", "filename": "src/bootstrap/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/803576c17e24a5a9e680849346f58d6b6545fb79/src%2Fbootstrap%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/803576c17e24a5a9e680849346f58d6b6545fb79/src%2Fbootstrap%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Flib.rs?ref=803576c17e24a5a9e680849346f58d6b6545fb79", "patch": "@@ -649,6 +649,7 @@ impl Build {\n              .env(\"RUSTC_REAL\", self.compiler_path(compiler))\n              .env(\"RUSTC_STAGE\", stage.to_string())\n              .env(\"RUSTC_DEBUGINFO\", self.config.rust_debuginfo.to_string())\n+             .env(\"RUSTC_DEBUGINFO_LINES\", self.config.rust_debuginfo_lines.to_string())\n              .env(\"RUSTC_CODEGEN_UNITS\",\n                   self.config.rust_codegen_units.to_string())\n              .env(\"RUSTC_DEBUG_ASSERTIONS\","}]}