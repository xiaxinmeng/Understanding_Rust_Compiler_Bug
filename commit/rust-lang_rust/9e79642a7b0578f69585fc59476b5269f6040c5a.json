{"sha": "9e79642a7b0578f69585fc59476b5269f6040c5a", "node_id": "C_kwDOAAsO6NoAKDllNzk2NDJhN2IwNTc4ZjY5NTg1ZmM1OTQ3NmI1MjY5ZjYwNDBjNWE", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2023-01-23T10:29:58Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-01-23T10:29:58Z"}, "message": "Rollup merge of #106796 - vadorovsky:revert-105708-enable-atomic-cas-bpf, r=bjorn3\n\nBPF: Disable atomic CAS\n\nEnabling CAS for BPF targets (https://github.com/rust-lang/rust/pull/105708) breaks the build of core library.\nThe failure occurs both when building rustc for BPF targets and when\nbuilding crates for BPF targets with the current nightly.\n\nThe LLVM BPF backend does not correctly lower all `atomicrmw` operations\nand crashes for unsupported ones.\n\nBefore we can enable CAS for BPF in Rust, we need to fix the LLVM BPF\nbackend first.\n\nFixes #106795\n\nSigned-off-by: Michal Rostecki <vadorovsky@gmail.com>", "tree": {"sha": "904ddbe19d8c922d6576ba9630c64bee8bc77047", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/904ddbe19d8c922d6576ba9630c64bee8bc77047"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9e79642a7b0578f69585fc59476b5269f6040c5a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjzmGmCRBK7hj4Ov3rIwAAXB4IAB7TQ9YB5gLoPBtMLMrTwhnC\n5bTm9zXIpMjO6LiSi+Qgpn/PSLfWdTbgwgzDQIrVROlueaDIFd5H5JKP3H8yVnOW\n/OvzzPVP8xB+AsTGdBmiGlK4hkv1IuYRVW1PFckpU7mc7rfvE5bJCCY5op1g5YXQ\nhJTeIAryT+2tY+YJ1Ze8iKEgTVbnDF7k4pqo4sP6+3enZagmsrHgt9eOex0Tn71w\neY23sq8MIBqowvLauOssLT1mthaDxu53EmneR/+ddBYO3ytOhe5BONHl9cBZJrAF\n2jrPsFPd+445Ed7i4mzUgFfqz9UPCiH5n4zBIyQgxHvdzdNF0iTUcAC86BsZJ0w=\n=uYLa\n-----END PGP SIGNATURE-----\n", "payload": "tree 904ddbe19d8c922d6576ba9630c64bee8bc77047\nparent 6b3cd03fdb285781c60f5962194719fdfd46d910\nparent 651e8734620a07d25acab4a594e23e33b4d91f50\nauthor Yuki Okushi <jtitor@2k36.org> 1674469798 +0900\ncommitter GitHub <noreply@github.com> 1674469798 +0900\n\nRollup merge of #106796 - vadorovsky:revert-105708-enable-atomic-cas-bpf, r=bjorn3\n\nBPF: Disable atomic CAS\n\nEnabling CAS for BPF targets (https://github.com/rust-lang/rust/pull/105708) breaks the build of core library.\nThe failure occurs both when building rustc for BPF targets and when\nbuilding crates for BPF targets with the current nightly.\n\nThe LLVM BPF backend does not correctly lower all `atomicrmw` operations\nand crashes for unsupported ones.\n\nBefore we can enable CAS for BPF in Rust, we need to fix the LLVM BPF\nbackend first.\n\nFixes #106795\n\nSigned-off-by: Michal Rostecki <vadorovsky@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9e79642a7b0578f69585fc59476b5269f6040c5a", "html_url": "https://github.com/rust-lang/rust/commit/9e79642a7b0578f69585fc59476b5269f6040c5a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9e79642a7b0578f69585fc59476b5269f6040c5a/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6b3cd03fdb285781c60f5962194719fdfd46d910", "url": "https://api.github.com/repos/rust-lang/rust/commits/6b3cd03fdb285781c60f5962194719fdfd46d910", "html_url": "https://github.com/rust-lang/rust/commit/6b3cd03fdb285781c60f5962194719fdfd46d910"}, {"sha": "651e8734620a07d25acab4a594e23e33b4d91f50", "url": "https://api.github.com/repos/rust-lang/rust/commits/651e8734620a07d25acab4a594e23e33b4d91f50", "html_url": "https://github.com/rust-lang/rust/commit/651e8734620a07d25acab4a594e23e33b4d91f50"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "4d03747d0165f698ae7ce3d7867f27110b3316d1", "filename": "compiler/rustc_target/src/spec/bpf_base.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9e79642a7b0578f69585fc59476b5269f6040c5a/compiler%2Frustc_target%2Fsrc%2Fspec%2Fbpf_base.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9e79642a7b0578f69585fc59476b5269f6040c5a/compiler%2Frustc_target%2Fsrc%2Fspec%2Fbpf_base.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Fbpf_base.rs?ref=9e79642a7b0578f69585fc59476b5269f6040c5a", "patch": "@@ -6,7 +6,7 @@ pub fn opts(endian: Endian) -> TargetOptions {\n         allow_asm: true,\n         endian,\n         linker_flavor: LinkerFlavor::Bpf,\n-        atomic_cas: true,\n+        atomic_cas: false,\n         dynamic_linking: true,\n         no_builtins: true,\n         panic_strategy: PanicStrategy::Abort,"}]}