{"sha": "1f28683ffacebc91b3bc47b94c56690633226ff9", "node_id": "C_kwDOAAsO6NoAKDFmMjg2ODNmZmFjZWJjOTFiM2JjNDdiOTRjNTY2OTA2MzMyMjZmZjk", "commit": {"author": {"name": "Yacin Tmimi", "email": "yacintmimi@gmail.com", "date": "2021-11-29T04:39:31Z"}, "committer": {"name": "Caleb Cartwright", "email": "calebcartwright@users.noreply.github.com", "date": "2021-11-29T20:02:02Z"}, "message": "Update nightly only test with #[nightly_only_test] attribute", "tree": {"sha": "541f800dc411daca84eecb1045a42365b795037d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/541f800dc411daca84eecb1045a42365b795037d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1f28683ffacebc91b3bc47b94c56690633226ff9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1f28683ffacebc91b3bc47b94c56690633226ff9", "html_url": "https://github.com/rust-lang/rust/commit/1f28683ffacebc91b3bc47b94c56690633226ff9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1f28683ffacebc91b3bc47b94c56690633226ff9/comments", "author": {"login": "ytmimi", "id": 29028348, "node_id": "MDQ6VXNlcjI5MDI4MzQ4", "avatar_url": "https://avatars.githubusercontent.com/u/29028348?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ytmimi", "html_url": "https://github.com/ytmimi", "followers_url": "https://api.github.com/users/ytmimi/followers", "following_url": "https://api.github.com/users/ytmimi/following{/other_user}", "gists_url": "https://api.github.com/users/ytmimi/gists{/gist_id}", "starred_url": "https://api.github.com/users/ytmimi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ytmimi/subscriptions", "organizations_url": "https://api.github.com/users/ytmimi/orgs", "repos_url": "https://api.github.com/users/ytmimi/repos", "events_url": "https://api.github.com/users/ytmimi/events{/privacy}", "received_events_url": "https://api.github.com/users/ytmimi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "calebcartwright", "id": 13042488, "node_id": "MDQ6VXNlcjEzMDQyNDg4", "avatar_url": "https://avatars.githubusercontent.com/u/13042488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/calebcartwright", "html_url": "https://github.com/calebcartwright", "followers_url": "https://api.github.com/users/calebcartwright/followers", "following_url": "https://api.github.com/users/calebcartwright/following{/other_user}", "gists_url": "https://api.github.com/users/calebcartwright/gists{/gist_id}", "starred_url": "https://api.github.com/users/calebcartwright/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/calebcartwright/subscriptions", "organizations_url": "https://api.github.com/users/calebcartwright/orgs", "repos_url": "https://api.github.com/users/calebcartwright/repos", "events_url": "https://api.github.com/users/calebcartwright/events{/privacy}", "received_events_url": "https://api.github.com/users/calebcartwright/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0fc846f979bc20d556cc07177b384094a421c54c", "url": "https://api.github.com/repos/rust-lang/rust/commits/0fc846f979bc20d556cc07177b384094a421c54c", "html_url": "https://github.com/rust-lang/rust/commit/0fc846f979bc20d556cc07177b384094a421c54c"}], "stats": {"total": 24, "additions": 10, "deletions": 14}, "files": [{"sha": "7738eee0a76049b769a2aa547ccdc908483c16fd", "filename": "src/ignore_path.rs", "status": "modified", "additions": 10, "deletions": 14, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/1f28683ffacebc91b3bc47b94c56690633226ff9/src%2Fignore_path.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1f28683ffacebc91b3bc47b94c56690633226ff9/src%2Fignore_path.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fignore_path.rs?ref=1f28683ffacebc91b3bc47b94c56690633226ff9", "patch": "@@ -37,21 +37,17 @@ mod test {\n     use crate::config::{Config, FileName};\n     use crate::ignore_path::IgnorePathSet;\n \n+    use rustfmt_config_proc_macro::nightly_only_test;\n+\n+    #[nightly_only_test]\n     #[test]\n     fn test_ignore_path_set() {\n-        match option_env!(\"CFG_RELEASE_CHANNEL\") {\n-            // this test requires nightly\n-            None | Some(\"nightly\") => {\n-                let config =\n-                    Config::from_toml(r#\"ignore = [\"foo.rs\", \"bar_dir/*\"]\"#, Path::new(\"\"))\n-                        .unwrap();\n-                let ignore_path_set = IgnorePathSet::from_ignore_list(&config.ignore()).unwrap();\n-\n-                assert!(ignore_path_set.is_match(&FileName::Real(PathBuf::from(\"src/foo.rs\"))));\n-                assert!(ignore_path_set.is_match(&FileName::Real(PathBuf::from(\"bar_dir/baz.rs\"))));\n-                assert!(!ignore_path_set.is_match(&FileName::Real(PathBuf::from(\"src/bar.rs\"))));\n-            }\n-            _ => (),\n-        };\n+        let config =\n+            Config::from_toml(r#\"ignore = [\"foo.rs\", \"bar_dir/*\"]\"#, Path::new(\"\")).unwrap();\n+        let ignore_path_set = IgnorePathSet::from_ignore_list(&config.ignore()).unwrap();\n+\n+        assert!(ignore_path_set.is_match(&FileName::Real(PathBuf::from(\"src/foo.rs\"))));\n+        assert!(ignore_path_set.is_match(&FileName::Real(PathBuf::from(\"bar_dir/baz.rs\"))));\n+        assert!(!ignore_path_set.is_match(&FileName::Real(PathBuf::from(\"src/bar.rs\"))));\n     }\n }"}]}