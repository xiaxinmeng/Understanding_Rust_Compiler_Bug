{"sha": "5e30f05a05326018357c6fffdfb872e8a8d2367c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVlMzBmMDVhMDUzMjYwMTgzNTdjNmZmZmRmYjg3MmU4YThkMjM2N2M=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-04-03T01:44:00Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-04-03T01:44:00Z"}, "message": "Auto merge of #23974 - pnkfelix:fix-23973, r=alexcrichton\n\nDo not suggest `#![feature(...)]` if we are in beta or stable channel.\r\n\r\nFix #23973", "tree": {"sha": "883e6056aceda017cd6d10449dab6458e01ce1d8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/883e6056aceda017cd6d10449dab6458e01ce1d8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5e30f05a05326018357c6fffdfb872e8a8d2367c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5e30f05a05326018357c6fffdfb872e8a8d2367c", "html_url": "https://github.com/rust-lang/rust/commit/5e30f05a05326018357c6fffdfb872e8a8d2367c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5e30f05a05326018357c6fffdfb872e8a8d2367c/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d17d6e7f1f05fbdd4d9d246400ffebf768878c7a", "url": "https://api.github.com/repos/rust-lang/rust/commits/d17d6e7f1f05fbdd4d9d246400ffebf768878c7a", "html_url": "https://github.com/rust-lang/rust/commit/d17d6e7f1f05fbdd4d9d246400ffebf768878c7a"}, {"sha": "f6a06808ec0ec9dec2ca8b5bd2b37c1c66119d95", "url": "https://api.github.com/repos/rust-lang/rust/commits/f6a06808ec0ec9dec2ca8b5bd2b37c1c66119d95", "html_url": "https://github.com/rust-lang/rust/commit/f6a06808ec0ec9dec2ca8b5bd2b37c1c66119d95"}], "stats": {"total": 14, "additions": 6, "deletions": 8}, "files": [{"sha": "689b4595d39a695c265aa161a8a5759a1f7788ac", "filename": "src/libsyntax/feature_gate.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/5e30f05a05326018357c6fffdfb872e8a8d2367c/src%2Flibsyntax%2Ffeature_gate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e30f05a05326018357c6fffdfb872e8a8d2367c/src%2Flibsyntax%2Ffeature_gate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Ffeature_gate.rs?ref=5e30f05a05326018357c6fffdfb872e8a8d2367c", "patch": "@@ -409,13 +409,19 @@ impl<'a> Context<'a> {\n \n pub fn emit_feature_err(diag: &SpanHandler, feature: &str, span: Span, explain: &str) {\n     diag.span_err(span, explain);\n+\n+    // #23973: do not suggest `#![feature(...)]` if we are in beta/stable\n+    if option_env!(\"CFG_DISABLE_UNSTABLE_FEATURES\").is_some() { return; }\n     diag.fileline_help(span, &format!(\"add #![feature({})] to the \\\n                                    crate attributes to enable\",\n                                   feature));\n }\n \n pub fn emit_feature_warn(diag: &SpanHandler, feature: &str, span: Span, explain: &str) {\n     diag.span_warn(span, explain);\n+\n+    // #23973: do not suggest `#![feature(...)]` if we are in beta/stable\n+    if option_env!(\"CFG_DISABLE_UNSTABLE_FEATURES\").is_some() { return; }\n     if diag.handler.can_emit_warnings {\n         diag.fileline_help(span, &format!(\"add #![feature({})] to the \\\n                                        crate attributes to silence this warning\","}, {"sha": "022a6b4f2f7deb95718dce6ab5a5ed1e86d6a916", "filename": "src/test/compile-fail-fulldeps/gated-macro-reexports.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5e30f05a05326018357c6fffdfb872e8a8d2367c/src%2Ftest%2Fcompile-fail-fulldeps%2Fgated-macro-reexports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e30f05a05326018357c6fffdfb872e8a8d2367c/src%2Ftest%2Fcompile-fail-fulldeps%2Fgated-macro-reexports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail-fulldeps%2Fgated-macro-reexports.rs?ref=5e30f05a05326018357c6fffdfb872e8a8d2367c", "patch": "@@ -19,4 +19,3 @@\n #[macro_use] #[no_link]\n extern crate macro_reexport_1;\n //~^ ERROR macros reexports are experimental and possibly buggy\n-//~| HELP add #![feature(macro_reexport)] to the crate attributes to enable"}, {"sha": "d82d0dec72bba4dd0e2e5d04cf4e8541acf85b37", "filename": "src/test/compile-fail/gated-box-patterns.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5e30f05a05326018357c6fffdfb872e8a8d2367c/src%2Ftest%2Fcompile-fail%2Fgated-box-patterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e30f05a05326018357c6fffdfb872e8a8d2367c/src%2Ftest%2Fcompile-fail%2Fgated-box-patterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fgated-box-patterns.rs?ref=5e30f05a05326018357c6fffdfb872e8a8d2367c", "patch": "@@ -16,7 +16,6 @@ fn main() {\n     match x {\n         box 1 => (),\n         //~^ box pattern syntax is experimental\n-        //~| add #![feature(box_patterns)] to the crate attributes to enable\n         _     => ()\n     };\n }"}, {"sha": "a2643fe02b8f72bdc6fdd0594b73238386d01297", "filename": "src/test/compile-fail/gated-box-syntax.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5e30f05a05326018357c6fffdfb872e8a8d2367c/src%2Ftest%2Fcompile-fail%2Fgated-box-syntax.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e30f05a05326018357c6fffdfb872e8a8d2367c/src%2Ftest%2Fcompile-fail%2Fgated-box-syntax.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fgated-box-syntax.rs?ref=5e30f05a05326018357c6fffdfb872e8a8d2367c", "patch": "@@ -13,5 +13,4 @@\n fn main() {\n     let x = box 3;\n     //~^ ERROR box expression syntax is experimental; you can call `Box::new` instead.\n-    //~| HELP add #![feature(box_syntax)] to the crate attributes to enable\n }"}, {"sha": "7b1405c913f6b0236298d07d6521579cfa2938ea", "filename": "src/test/compile-fail/gated-link-args.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5e30f05a05326018357c6fffdfb872e8a8d2367c/src%2Ftest%2Fcompile-fail%2Fgated-link-args.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e30f05a05326018357c6fffdfb872e8a8d2367c/src%2Ftest%2Fcompile-fail%2Fgated-link-args.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fgated-link-args.rs?ref=5e30f05a05326018357c6fffdfb872e8a8d2367c", "patch": "@@ -14,6 +14,5 @@\n #[link_args = \"aFdEfSeVEEE\"]\n extern {}\n //~^ ERROR the `link_args` attribute is not portable across platforms\n-//~| HELP add #![feature(link_args)] to the crate attributes to enable\n \n fn main() { }"}, {"sha": "92a1b071437e60f9fb0867198ce5f1a46aaa3716", "filename": "src/test/compile-fail/gated-link-llvm-intrinsics.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5e30f05a05326018357c6fffdfb872e8a8d2367c/src%2Ftest%2Fcompile-fail%2Fgated-link-llvm-intrinsics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e30f05a05326018357c6fffdfb872e8a8d2367c/src%2Ftest%2Fcompile-fail%2Fgated-link-llvm-intrinsics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fgated-link-llvm-intrinsics.rs?ref=5e30f05a05326018357c6fffdfb872e8a8d2367c", "patch": "@@ -12,7 +12,6 @@ extern {\n     #[link_name = \"llvm.sqrt.f32\"]\n     fn sqrt(x: f32) -> f32;\n     //~^ ERROR linking to LLVM intrinsics is experimental\n-    //~| HELP add #![feature(link_llvm_intrinsics)] to the crate attributes\n }\n \n fn main(){"}, {"sha": "9cdebde7b7b9879946e83a4aaf2c274540cf6cda", "filename": "src/test/compile-fail/gated-plugin_registrar.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5e30f05a05326018357c6fffdfb872e8a8d2367c/src%2Ftest%2Fcompile-fail%2Fgated-plugin_registrar.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e30f05a05326018357c6fffdfb872e8a8d2367c/src%2Ftest%2Fcompile-fail%2Fgated-plugin_registrar.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fgated-plugin_registrar.rs?ref=5e30f05a05326018357c6fffdfb872e8a8d2367c", "patch": "@@ -15,5 +15,4 @@\n #[plugin_registrar]\n pub fn registrar() {}\n //~^ ERROR compiler plugins are experimental\n-//~| HELP add #![feature(plugin_registrar)] to the crate attributes to enable\n fn main() {}"}, {"sha": "9dd1e229e0af5a02b7fbe0e71d47941f27103498", "filename": "src/test/compile-fail/gated-unsafe-destructor.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5e30f05a05326018357c6fffdfb872e8a8d2367c/src%2Ftest%2Fcompile-fail%2Fgated-unsafe-destructor.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e30f05a05326018357c6fffdfb872e8a8d2367c/src%2Ftest%2Fcompile-fail%2Fgated-unsafe-destructor.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fgated-unsafe-destructor.rs?ref=5e30f05a05326018357c6fffdfb872e8a8d2367c", "patch": "@@ -18,8 +18,6 @@ struct D<'a>(&'a u32);\n \n #[unsafe_destructor]\n //~^ ERROR `#[unsafe_destructor]` does nothing anymore\n-//~| HELP: add #![feature(unsafe_destructor)] to the crate attributes to enable\n-// (but of couse there is no point in doing so)\n impl<'a> Drop for D<'a> {\n     fn drop(&mut self) { }\n }"}]}