{"sha": "445d3fe39cbe6b56b72fd08065e3569d73aeb10b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ0NWQzZmUzOWNiZTZiNTZiNzJmZDA4MDY1ZTM1NjlkNzNhZWIxMGI=", "commit": {"author": {"name": "Roy Frostig", "email": "rfrostig@mozilla.com", "date": "2010-08-12T20:11:49Z"}, "committer": {"name": "Roy Frostig", "email": "rfrostig@mozilla.com", "date": "2010-08-12T20:11:49Z"}, "message": "Add vec debugging utility to _vec module.", "tree": {"sha": "48840896b8213eed99efae3ee6298465055f67b6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/48840896b8213eed99efae3ee6298465055f67b6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/445d3fe39cbe6b56b72fd08065e3569d73aeb10b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/445d3fe39cbe6b56b72fd08065e3569d73aeb10b", "html_url": "https://github.com/rust-lang/rust/commit/445d3fe39cbe6b56b72fd08065e3569d73aeb10b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/445d3fe39cbe6b56b72fd08065e3569d73aeb10b/comments", "author": {"login": "froystig", "id": 123903, "node_id": "MDQ6VXNlcjEyMzkwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/123903?v=4", "gravatar_id": "", "url": "https://api.github.com/users/froystig", "html_url": "https://github.com/froystig", "followers_url": "https://api.github.com/users/froystig/followers", "following_url": "https://api.github.com/users/froystig/following{/other_user}", "gists_url": "https://api.github.com/users/froystig/gists{/gist_id}", "starred_url": "https://api.github.com/users/froystig/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/froystig/subscriptions", "organizations_url": "https://api.github.com/users/froystig/orgs", "repos_url": "https://api.github.com/users/froystig/repos", "events_url": "https://api.github.com/users/froystig/events{/privacy}", "received_events_url": "https://api.github.com/users/froystig/received_events", "type": "User", "site_admin": false}, "committer": {"login": "froystig", "id": 123903, "node_id": "MDQ6VXNlcjEyMzkwMw==", "avatar_url": "https://avatars.githubusercontent.com/u/123903?v=4", "gravatar_id": "", "url": "https://api.github.com/users/froystig", "html_url": "https://github.com/froystig", "followers_url": "https://api.github.com/users/froystig/followers", "following_url": "https://api.github.com/users/froystig/following{/other_user}", "gists_url": "https://api.github.com/users/froystig/gists{/gist_id}", "starred_url": "https://api.github.com/users/froystig/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/froystig/subscriptions", "organizations_url": "https://api.github.com/users/froystig/orgs", "repos_url": "https://api.github.com/users/froystig/repos", "events_url": "https://api.github.com/users/froystig/events{/privacy}", "received_events_url": "https://api.github.com/users/froystig/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5267b77d3bad4dff4940fa65aabe8a4353559a95", "url": "https://api.github.com/repos/rust-lang/rust/commits/5267b77d3bad4dff4940fa65aabe8a4353559a95", "html_url": "https://github.com/rust-lang/rust/commit/5267b77d3bad4dff4940fa65aabe8a4353559a95"}], "stats": {"total": 26, "additions": 25, "deletions": 1}, "files": [{"sha": "bb6b337e74831bb7a80d5a93eb42bc31cc810053", "filename": "src/lib/_vec.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/445d3fe39cbe6b56b72fd08065e3569d73aeb10b/src%2Flib%2F_vec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/445d3fe39cbe6b56b72fd08065e3569d73aeb10b/src%2Flib%2F_vec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib%2F_vec.rs?ref=445d3fe39cbe6b56b72fd08065e3569d73aeb10b", "patch": "@@ -10,6 +10,7 @@ native \"rust\" mod rustrt {\n    * want to invoke this as vec_alloc[vec[U], U]. */\n   fn vec_alloc[T, U](uint n_elts) -> vec[U];\n   fn refcount[T](vec[T] v) -> uint;\n+  fn vec_print_debug_info[T](vec[T] v);\n }\n \n fn alloc[T](uint n_elts) -> vec[T] {\n@@ -58,6 +59,10 @@ fn buf_off[T](vec[T] v, uint offset) -> vbuf {\n   ret rustrt.vec_buf[T](v, offset);\n }\n \n+fn print_debug_info[T](vec[T] v) {\n+  rustrt.vec_print_debug_info[T](v);\n+}\n+\n // Returns elements from [start..end) from v.\n fn slice[T](vec[T] v, int start, int end) -> vec[T] {\n   check(0 <= start);"}, {"sha": "5b1f7ae2947bcffee1080af05a7f62ddd106216f", "filename": "src/rt/rust_builtin.cpp", "status": "modified", "additions": 18, "deletions": 1, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/445d3fe39cbe6b56b72fd08065e3569d73aeb10b/src%2Frt%2Frust_builtin.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/445d3fe39cbe6b56b72fd08065e3569d73aeb10b/src%2Frt%2Frust_builtin.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_builtin.cpp?ref=445d3fe39cbe6b56b72fd08065e3569d73aeb10b", "patch": "@@ -82,7 +82,7 @@ extern \"C\" CDECL rust_vec*\n vec_alloc(rust_task *task, type_desc *t, type_desc *elem_t, size_t n_elts)\n {\n     rust_dom *dom = task->dom;\n-    task->log(rust_log::MEM,\n+    task->log(rust_log::MEM | rust_log::STDLIB,\n               \"vec_alloc %\" PRIdPTR \" elements of size %\" PRIdPTR,\n               n_elts, elem_t->size);\n     size_t fill = n_elts * elem_t->size;\n@@ -108,6 +108,23 @@ vec_len(rust_task *task, type_desc *ty, rust_vec *v)\n     return v->fill / ty->size;\n }\n \n+extern \"C\" CDECL void\n+vec_print_debug_info(rust_task *task, type_desc *ty, rust_vec *v)\n+{\n+    task->log(rust_log::STDLIB,\n+              \"vec_print_debug_info(%\" PRIxPTR \")\"\n+              \" with tydesc %\" PRIxPTR\n+              \" (size = %\" PRIdPTR \", align = %\" PRIdPTR \")\"\n+              \" alloc = %\" PRIdPTR \", fill = %\" PRIdPTR\n+              \" , data = ...\", v, ty, ty->size, ty->align, v->alloc, v->fill);\n+\n+    for (size_t i = 0; i < v->fill; ++i) {\n+        task->log(rust_log::STDLIB,\n+                  \"  %\" PRIdPTR \":    0x%\" PRIxPTR,\n+                  i, v->data[i]);\n+    }\n+}\n+\n /* Helper for str_alloc and str_from_vec.  Returns NULL as failure. */\n static rust_str *\n str_alloc_with_data(rust_task *task,"}, {"sha": "c2a1bbe36a9a164b3df4def873b02cc95ae727e4", "filename": "src/rt/rust_log.cpp", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/445d3fe39cbe6b56b72fd08065e3569d73aeb10b/src%2Frt%2Frust_log.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/445d3fe39cbe6b56b72fd08065e3569d73aeb10b/src%2Frt%2Frust_log.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_log.cpp?ref=445d3fe39cbe6b56b72fd08065e3569d73aeb10b", "patch": "@@ -26,6 +26,7 @@ read_type_bit_mask() {\n         bits |= strstr(env_str, \"cache\") ? rust_log::CACHE : 0;\n         bits |= strstr(env_str, \"timer\") ? rust_log::TIMER : 0;\n         bits |= strstr(env_str, \"gc\") ? rust_log::GC : 0;\n+        bits |= strstr(env_str, \"stdlib\") ? rust_log::STDLIB : 0;\n         bits |= strstr(env_str, \"all\") ? rust_log::ALL : 0;\n         bits = strstr(env_str, \"none\") ? 0 : bits;\n     }"}, {"sha": "58b36f8d66b1a556a37bff13e893ed6a5bbb9f90", "filename": "src/rt/rust_log.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/445d3fe39cbe6b56b72fd08065e3569d73aeb10b/src%2Frt%2Frust_log.h", "raw_url": "https://github.com/rust-lang/rust/raw/445d3fe39cbe6b56b72fd08065e3569d73aeb10b/src%2Frt%2Frust_log.h", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_log.h?ref=445d3fe39cbe6b56b72fd08065e3569d73aeb10b", "patch": "@@ -41,6 +41,7 @@ class rust_log {\n         UPCALL = 0x200,\n         TIMER = 0x400,\n         GC = 0x800,\n+        STDLIB = 0x1000,\n         ALL = 0xffffffff\n     };\n "}]}