{"sha": "cac9ad02cf952f16bd8b00797f5bb1dbc30e692e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNhYzlhZDAyY2Y5NTJmMTZiZDhiMDA3OTdmNWJiMWRiYzMwZTY5MmU=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-05-15T21:55:43Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-05-15T21:55:43Z"}, "message": "Auto merge of #5599 - dtolnay:letif, r=flip1995\n\nDowngrade useless_let_if_seq to nursery\n\nI feel that this lint has the wrong balance of incorrect suggestions for a default-enabled lint.\n\nThe immediate code I faced was something like:\n\n```rust\nfn main() {\n    let mut good = do1();\n    if !do2() {\n        good = false;\n    }\n    if good {\n        println!(\"good\");\n    }\n}\n\nfn do1() -> bool { println!(\"1\"); false }\nfn do2() -> bool { println!(\"2\"); false }\n```\n\nOn this code Clippy calls it unidiomatic and suggests the following diff, which has different behavior in a way that I don't necessarily want.\n\n```diff\n- let mut good = do1();\n- if !do2() {\n-     good = false;\n- }\n+ let good = if !do2() {\n+     false\n+ } else {\n+     do1()\n+ };\n```\n\nOn exploring issues filed about this lint, I have found that other users have also struggled with inappropriate suggestions (https://github.com/rust-lang/rust-clippy/issues/4124, https://github.com/rust-lang/rust-clippy/issues/3043, https://github.com/rust-lang/rust-clippy/issues/2918, https://github.com/rust-lang/rust-clippy/issues/2176) and suggestions that make the code worse (https://github.com/rust-lang/rust-clippy/issues/3769, https://github.com/rust-lang/rust-clippy/issues/2749). Overall I believe that this lint is still at nursery quality for now and should not be enabled.\n\n---\n\nchangelog: Remove useless_let_if_seq from default set of enabled lints", "tree": {"sha": "3623294adebe49aacc1b12e634784c8c1f85c361", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3623294adebe49aacc1b12e634784c8c1f85c361"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cac9ad02cf952f16bd8b00797f5bb1dbc30e692e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cac9ad02cf952f16bd8b00797f5bb1dbc30e692e", "html_url": "https://github.com/rust-lang/rust/commit/cac9ad02cf952f16bd8b00797f5bb1dbc30e692e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cac9ad02cf952f16bd8b00797f5bb1dbc30e692e/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e22ccf53322a1a9caeca955802e1f8f07c4c47a0", "url": "https://api.github.com/repos/rust-lang/rust/commits/e22ccf53322a1a9caeca955802e1f8f07c4c47a0", "html_url": "https://github.com/rust-lang/rust/commit/e22ccf53322a1a9caeca955802e1f8f07c4c47a0"}, {"sha": "95399f8f941b89785c6e9d94e0bc32ff5d43ba06", "url": "https://api.github.com/repos/rust-lang/rust/commits/95399f8f941b89785c6e9d94e0bc32ff5d43ba06", "html_url": "https://github.com/rust-lang/rust/commit/95399f8f941b89785c6e9d94e0bc32ff5d43ba06"}], "stats": {"total": 7, "additions": 3, "deletions": 4}, "files": [{"sha": "d7bf8a1476817c28892be2a3033f120fb2585301", "filename": "clippy_lints/src/let_if_seq.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cac9ad02cf952f16bd8b00797f5bb1dbc30e692e/clippy_lints%2Fsrc%2Flet_if_seq.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cac9ad02cf952f16bd8b00797f5bb1dbc30e692e/clippy_lints%2Fsrc%2Flet_if_seq.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flet_if_seq.rs?ref=cac9ad02cf952f16bd8b00797f5bb1dbc30e692e", "patch": "@@ -50,7 +50,7 @@ declare_clippy_lint! {\n     /// };\n     /// ```\n     pub USELESS_LET_IF_SEQ,\n-    style,\n+    nursery,\n     \"unidiomatic `let mut` declaration followed by initialization in `if`\"\n }\n "}, {"sha": "b241ac5559cf11422613f45433e7f597ee23f50f", "filename": "clippy_lints/src/lib.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/cac9ad02cf952f16bd8b00797f5bb1dbc30e692e/clippy_lints%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cac9ad02cf952f16bd8b00797f5bb1dbc30e692e/clippy_lints%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.rs?ref=cac9ad02cf952f16bd8b00797f5bb1dbc30e692e", "patch": "@@ -1266,7 +1266,6 @@ pub fn register_plugins(store: &mut rustc_lint::LintStore, sess: &Session, conf:\n         LintId::of(&large_enum_variant::LARGE_ENUM_VARIANT),\n         LintId::of(&len_zero::LEN_WITHOUT_IS_EMPTY),\n         LintId::of(&len_zero::LEN_ZERO),\n-        LintId::of(&let_if_seq::USELESS_LET_IF_SEQ),\n         LintId::of(&let_underscore::LET_UNDERSCORE_LOCK),\n         LintId::of(&lifetimes::EXTRA_UNUSED_LIFETIMES),\n         LintId::of(&lifetimes::NEEDLESS_LIFETIMES),\n@@ -1476,7 +1475,6 @@ pub fn register_plugins(store: &mut rustc_lint::LintStore, sess: &Session, conf:\n         LintId::of(&inherent_to_string::INHERENT_TO_STRING),\n         LintId::of(&len_zero::LEN_WITHOUT_IS_EMPTY),\n         LintId::of(&len_zero::LEN_ZERO),\n-        LintId::of(&let_if_seq::USELESS_LET_IF_SEQ),\n         LintId::of(&literal_representation::INCONSISTENT_DIGIT_GROUPING),\n         LintId::of(&loops::EMPTY_LOOP),\n         LintId::of(&loops::FOR_KV_MAP),\n@@ -1728,6 +1726,7 @@ pub fn register_plugins(store: &mut rustc_lint::LintStore, sess: &Session, conf:\n         LintId::of(&floating_point_arithmetic::IMPRECISE_FLOPS),\n         LintId::of(&floating_point_arithmetic::SUBOPTIMAL_FLOPS),\n         LintId::of(&future_not_send::FUTURE_NOT_SEND),\n+        LintId::of(&let_if_seq::USELESS_LET_IF_SEQ),\n         LintId::of(&missing_const_for_fn::MISSING_CONST_FOR_FN),\n         LintId::of(&mutable_debug_assertion::DEBUG_ASSERT_WITH_MUT_CALL),\n         LintId::of(&mutex_atomic::MUTEX_INTEGER),"}, {"sha": "e1c68b58b863249f4fe5a93eaef2a07d4ef9c365", "filename": "src/lintlist/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cac9ad02cf952f16bd8b00797f5bb1dbc30e692e/src%2Flintlist%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cac9ad02cf952f16bd8b00797f5bb1dbc30e692e/src%2Flintlist%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flintlist%2Fmod.rs?ref=cac9ad02cf952f16bd8b00797f5bb1dbc30e692e", "patch": "@@ -2469,7 +2469,7 @@ pub static ref ALL_LINTS: Vec<Lint> = vec![\n     },\n     Lint {\n         name: \"useless_let_if_seq\",\n-        group: \"style\",\n+        group: \"nursery\",\n         desc: \"unidiomatic `let mut` declaration followed by initialization in `if`\",\n         deprecation: None,\n         module: \"let_if_seq\","}]}