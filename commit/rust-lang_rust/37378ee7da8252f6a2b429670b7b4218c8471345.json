{"sha": "37378ee7da8252f6a2b429670b7b4218c8471345", "node_id": "C_kwDOAAsO6NoAKDM3Mzc4ZWU3ZGE4MjUyZjZhMmI0Mjk2NzBiN2I0MjE4Yzg0NzEzNDU", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-01-16T19:29:39Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-01-16T19:29:39Z"}, "message": "Rollup merge of #106912 - gftea:pr-106736, r=Nilstrieb\n\ncheck -Z query-dep-graph is enabled if -Z dump-dep-graph (#106736)\n\nPR to solve #106736, r? `@cjgillot`", "tree": {"sha": "f9a99468ee032a49683890660c4a29989092ad95", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f9a99468ee032a49683890660c4a29989092ad95"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/37378ee7da8252f6a2b429670b7b4218c8471345", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjxaWjCRBK7hj4Ov3rIwAANw4IADc30/I1CpW3V1xIRYD4RKzt\nQjSV0/Z0F6Tqte/YVJLrVae6nK/vYZ228f9AnFgYgWj5+jfCAey6SMdMGE6Ob4B1\nGPCWifQzg6wXwlSTjdKK5/oGjRwlem87rSGLoFqozOAIzI+HfwEMoUHY8wvCzYa0\nbvvguhp9wC6aFWjO9etwkerLY4rElVHOJ+SDprFyq8gYSysB8njZMuh5cBkDvO+I\nrvZHVFToM7cJ8BKwPRTb10R6uDe2SWEgw9T3OsK5XMIMv31TiyxGhZJOx3LaBpQh\nhxgI6s7VqR0vZ+3hJPX4SVi2IKeMQHnytdc7AJqoD1f+sWMRQVHJ2TW+9lpWZA8=\n=WR6B\n-----END PGP SIGNATURE-----\n", "payload": "tree f9a99468ee032a49683890660c4a29989092ad95\nparent 8ea26ca17f1baf0877b7b249323f3d5d72f0d3b4\nparent 2c5583efbde7987c6de16cb057503f57c0d73d73\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1673897379 +0100\ncommitter GitHub <noreply@github.com> 1673897379 +0100\n\nRollup merge of #106912 - gftea:pr-106736, r=Nilstrieb\n\ncheck -Z query-dep-graph is enabled if -Z dump-dep-graph (#106736)\n\nPR to solve #106736, r? `@cjgillot`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/37378ee7da8252f6a2b429670b7b4218c8471345", "html_url": "https://github.com/rust-lang/rust/commit/37378ee7da8252f6a2b429670b7b4218c8471345", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/37378ee7da8252f6a2b429670b7b4218c8471345/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8ea26ca17f1baf0877b7b249323f3d5d72f0d3b4", "url": "https://api.github.com/repos/rust-lang/rust/commits/8ea26ca17f1baf0877b7b249323f3d5d72f0d3b4", "html_url": "https://github.com/rust-lang/rust/commit/8ea26ca17f1baf0877b7b249323f3d5d72f0d3b4"}, {"sha": "2c5583efbde7987c6de16cb057503f57c0d73d73", "url": "https://api.github.com/repos/rust-lang/rust/commits/2c5583efbde7987c6de16cb057503f57c0d73d73", "html_url": "https://github.com/rust-lang/rust/commit/2c5583efbde7987c6de16cb057503f57c0d73d73"}], "stats": {"total": 13, "additions": 13, "deletions": 0}, "files": [{"sha": "38aebc81cd6b8cd1a5b95c35fd2a109e67df481f", "filename": "compiler/rustc_session/src/config.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/37378ee7da8252f6a2b429670b7b4218c8471345/compiler%2Frustc_session%2Fsrc%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/37378ee7da8252f6a2b429670b7b4218c8471345/compiler%2Frustc_session%2Fsrc%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_session%2Fsrc%2Fconfig.rs?ref=37378ee7da8252f6a2b429670b7b4218c8471345", "patch": "@@ -2459,6 +2459,11 @@ pub fn build_session_options(matches: &getopts::Matches) -> Options {\n \n     let pretty = parse_pretty(&unstable_opts, error_format);\n \n+    // query-dep-graph is required if dump-dep-graph is given #106736\n+    if unstable_opts.dump_dep_graph && !unstable_opts.query_dep_graph {\n+        early_error(error_format, \"can't dump dependency graph without `-Z query-dep-graph`\");\n+    }\n+\n     // Try to find a directory containing the Rust `src`, for more details see\n     // the doc comment on the `real_rust_source_base_dir` field.\n     let tmp_buf;"}, {"sha": "cbc4def0e03aa8f19c32a981d7cfcd711bbe9bc5", "filename": "tests/ui/dep-graph/dep-graph-dump.rs", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/37378ee7da8252f6a2b429670b7b4218c8471345/tests%2Fui%2Fdep-graph%2Fdep-graph-dump.rs", "raw_url": "https://github.com/rust-lang/rust/raw/37378ee7da8252f6a2b429670b7b4218c8471345/tests%2Fui%2Fdep-graph%2Fdep-graph-dump.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fdep-graph%2Fdep-graph-dump.rs?ref=37378ee7da8252f6a2b429670b7b4218c8471345", "patch": "@@ -0,0 +1,6 @@\n+// Test dump-dep-graph requires query-dep-graph enabled\n+\n+// incremental\n+// compile-flags: -Z dump-dep-graph\n+\n+fn main() {}"}, {"sha": "ea44b8bb07509e7e65a8660107bce094436dbbad", "filename": "tests/ui/dep-graph/dep-graph-dump.stderr", "status": "added", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/37378ee7da8252f6a2b429670b7b4218c8471345/tests%2Fui%2Fdep-graph%2Fdep-graph-dump.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/37378ee7da8252f6a2b429670b7b4218c8471345/tests%2Fui%2Fdep-graph%2Fdep-graph-dump.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fdep-graph%2Fdep-graph-dump.stderr?ref=37378ee7da8252f6a2b429670b7b4218c8471345", "patch": "@@ -0,0 +1,2 @@\n+error: can't dump dependency graph without `-Z query-dep-graph`\n+"}]}