{"sha": "c25319fcfc5046b91b773c87edbfdb087e875343", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMyNTMxOWZjZmM1MDQ2YjkxYjc3M2M4N2VkYmZkYjA4N2U4NzUzNDM=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-11-05T14:25:11Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-11-05T14:26:02Z"}, "message": "Update `ui/borrowck/borrowck-closures-mut-of-imm.rs` robust w.r.t. NLL.", "tree": {"sha": "0e62f2b82f29446e1d8187ea12ec7e812ae5e10b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0e62f2b82f29446e1d8187ea12ec7e812ae5e10b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c25319fcfc5046b91b773c87edbfdb087e875343", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c25319fcfc5046b91b773c87edbfdb087e875343", "html_url": "https://github.com/rust-lang/rust/commit/c25319fcfc5046b91b773c87edbfdb087e875343", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c25319fcfc5046b91b773c87edbfdb087e875343/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fe29cd0a3d1ebff0d90f3e4ebc929f944863be4c", "url": "https://api.github.com/repos/rust-lang/rust/commits/fe29cd0a3d1ebff0d90f3e4ebc929f944863be4c", "html_url": "https://github.com/rust-lang/rust/commit/fe29cd0a3d1ebff0d90f3e4ebc929f944863be4c"}], "stats": {"total": 68, "additions": 43, "deletions": 25}, "files": [{"sha": "160a84c480cd31a6f930ed18b7a6bac3a9c52c1b", "filename": "src/test/ui/borrowck/borrowck-closures-mut-of-imm.nll.stderr", "status": "modified", "additions": 25, "deletions": 8, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/c25319fcfc5046b91b773c87edbfdb087e875343/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-mut-of-imm.nll.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c25319fcfc5046b91b773c87edbfdb087e875343/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-mut-of-imm.nll.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-mut-of-imm.nll.stderr?ref=c25319fcfc5046b91b773c87edbfdb087e875343", "patch": "@@ -1,15 +1,32 @@\n error[E0596]: cannot borrow `*x` as mutable, as it is behind a `&` reference\n-  --> $DIR/borrowck-closures-mut-of-imm.rs:23:21\n+  --> $DIR/borrowck-closures-mut-of-imm.rs:23:25\n    |\n-LL |     let c1 = || set(&mut *x);\n-   |                     ^^^^^^^ cannot borrow as mutable\n+LL |     let mut c1 = || set(&mut *x);\n+   |                         ^^^^^^^ cannot borrow as mutable\n \n error[E0596]: cannot borrow `*x` as mutable, as it is behind a `&` reference\n-  --> $DIR/borrowck-closures-mut-of-imm.rs:25:21\n+  --> $DIR/borrowck-closures-mut-of-imm.rs:25:25\n    |\n-LL |     let c2 = || set(&mut *x);\n-   |                     ^^^^^^^ cannot borrow as mutable\n+LL |     let mut c2 = || set(&mut *x);\n+   |                         ^^^^^^^ cannot borrow as mutable\n \n-error: aborting due to 2 previous errors\n+error[E0524]: two closures require unique access to `x` at the same time\n+  --> $DIR/borrowck-closures-mut-of-imm.rs:25:18\n+   |\n+LL |     let mut c1 = || set(&mut *x);\n+   |                  --           - first borrow occurs due to use of `x` in closure\n+   |                  |\n+   |                  first closure is constructed here\n+LL |     //~^ ERROR cannot borrow\n+LL |     let mut c2 = || set(&mut *x);\n+   |                  ^^           - second borrow occurs due to use of `x` in closure\n+   |                  |\n+   |                  second closure is constructed here\n+...\n+LL |     c2(); c1();\n+   |           -- first borrow later used here\n+\n+error: aborting due to 3 previous errors\n \n-For more information about this error, try `rustc --explain E0596`.\n+Some errors occurred: E0524, E0596.\n+For more information about an error, try `rustc --explain E0524`."}, {"sha": "3bf4f17fde1a808a997df2ab9575d0d9822ecc7d", "filename": "src/test/ui/borrowck/borrowck-closures-mut-of-imm.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/c25319fcfc5046b91b773c87edbfdb087e875343/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-mut-of-imm.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c25319fcfc5046b91b773c87edbfdb087e875343/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-mut-of-imm.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-mut-of-imm.rs?ref=c25319fcfc5046b91b773c87edbfdb087e875343", "patch": "@@ -20,11 +20,12 @@ fn set(x: &mut isize) {\n }\n \n fn a(x: &isize) {\n-    let c1 = || set(&mut *x);\n+    let mut c1 = || set(&mut *x);\n     //~^ ERROR cannot borrow\n-    let c2 = || set(&mut *x);\n+    let mut c2 = || set(&mut *x);\n     //~^ ERROR cannot borrow\n     //~| ERROR two closures require unique access to `x` at the same time\n+    c2(); c1();\n }\n \n fn main() {"}, {"sha": "c248595d57119c1929283086d1e52ea3c5cbb451", "filename": "src/test/ui/borrowck/borrowck-closures-mut-of-imm.stderr", "status": "modified", "additions": 15, "deletions": 15, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/c25319fcfc5046b91b773c87edbfdb087e875343/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-mut-of-imm.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c25319fcfc5046b91b773c87edbfdb087e875343/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-mut-of-imm.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-closures-mut-of-imm.stderr?ref=c25319fcfc5046b91b773c87edbfdb087e875343", "patch": "@@ -1,30 +1,30 @@\n error[E0524]: two closures require unique access to `x` at the same time\n-  --> $DIR/borrowck-closures-mut-of-imm.rs:25:14\n+  --> $DIR/borrowck-closures-mut-of-imm.rs:25:18\n    |\n-LL |     let c1 = || set(&mut *x);\n-   |              --           - previous borrow occurs due to use of `x` in closure\n-   |              |\n-   |              first closure is constructed here\n+LL |     let mut c1 = || set(&mut *x);\n+   |                  --           - previous borrow occurs due to use of `x` in closure\n+   |                  |\n+   |                  first closure is constructed here\n LL |     //~^ ERROR cannot borrow\n-LL |     let c2 = || set(&mut *x);\n-   |              ^^           - borrow occurs due to use of `x` in closure\n-   |              |\n-   |              second closure is constructed here\n+LL |     let mut c2 = || set(&mut *x);\n+   |                  ^^           - borrow occurs due to use of `x` in closure\n+   |                  |\n+   |                  second closure is constructed here\n ...\n LL | }\n    | - borrow from first closure ends here\n \n error[E0596]: cannot borrow immutable borrowed content `***x` as mutable\n-  --> $DIR/borrowck-closures-mut-of-imm.rs:23:26\n+  --> $DIR/borrowck-closures-mut-of-imm.rs:23:30\n    |\n-LL |     let c1 = || set(&mut *x);\n-   |                          ^^ cannot borrow as mutable\n+LL |     let mut c1 = || set(&mut *x);\n+   |                              ^^ cannot borrow as mutable\n \n error[E0596]: cannot borrow immutable borrowed content `***x` as mutable\n-  --> $DIR/borrowck-closures-mut-of-imm.rs:25:26\n+  --> $DIR/borrowck-closures-mut-of-imm.rs:25:30\n    |\n-LL |     let c2 = || set(&mut *x);\n-   |                          ^^ cannot borrow as mutable\n+LL |     let mut c2 = || set(&mut *x);\n+   |                              ^^ cannot borrow as mutable\n \n error: aborting due to 3 previous errors\n "}]}