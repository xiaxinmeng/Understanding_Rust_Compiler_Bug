{"sha": "9733463d2b141a166bfa2f55ec316066ab0f71b6", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk3MzM0NjNkMmIxNDFhMTY2YmZhMmY1NWVjMzE2MDY2YWIwZjcxYjY=", "commit": {"author": {"name": "Steven Fackler", "email": "sfackler@gmail.com", "date": "2017-09-24T04:19:01Z"}, "committer": {"name": "Steven Fackler", "email": "sfackler@gmail.com", "date": "2017-09-24T04:19:01Z"}, "message": "Fix capacity comparison in reserve\n\nYou can otherwise end up in a situation where you don't actually resize\nbut still call into handle_cap_increase which then corrupts head/tail.\n\nCloses #44800", "tree": {"sha": "95667fc249765b7f89f7ab7499d933e42ad68bcc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/95667fc249765b7f89f7ab7499d933e42ad68bcc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9733463d2b141a166bfa2f55ec316066ab0f71b6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9733463d2b141a166bfa2f55ec316066ab0f71b6", "html_url": "https://github.com/rust-lang/rust/commit/9733463d2b141a166bfa2f55ec316066ab0f71b6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9733463d2b141a166bfa2f55ec316066ab0f71b6/comments", "author": {"login": "sfackler", "id": 1455697, "node_id": "MDQ6VXNlcjE0NTU2OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sfackler", "html_url": "https://github.com/sfackler", "followers_url": "https://api.github.com/users/sfackler/followers", "following_url": "https://api.github.com/users/sfackler/following{/other_user}", "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}", "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions", "organizations_url": "https://api.github.com/users/sfackler/orgs", "repos_url": "https://api.github.com/users/sfackler/repos", "events_url": "https://api.github.com/users/sfackler/events{/privacy}", "received_events_url": "https://api.github.com/users/sfackler/received_events", "type": "User", "site_admin": false}, "committer": {"login": "sfackler", "id": 1455697, "node_id": "MDQ6VXNlcjE0NTU2OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sfackler", "html_url": "https://github.com/sfackler", "followers_url": "https://api.github.com/users/sfackler/followers", "following_url": "https://api.github.com/users/sfackler/following{/other_user}", "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}", "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions", "organizations_url": "https://api.github.com/users/sfackler/orgs", "repos_url": "https://api.github.com/users/sfackler/repos", "events_url": "https://api.github.com/users/sfackler/events{/privacy}", "received_events_url": "https://api.github.com/users/sfackler/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "24831c7221c7b4e32a02f8e8cffe7dfacb88b520", "url": "https://api.github.com/repos/rust-lang/rust/commits/24831c7221c7b4e32a02f8e8cffe7dfacb88b520", "html_url": "https://github.com/rust-lang/rust/commit/24831c7221c7b4e32a02f8e8cffe7dfacb88b520"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "6d64e9e303f76ca74b1bd9417398b7f33446f7f0", "filename": "src/liballoc/vec_deque.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9733463d2b141a166bfa2f55ec316066ab0f71b6/src%2Fliballoc%2Fvec_deque.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9733463d2b141a166bfa2f55ec316066ab0f71b6/src%2Fliballoc%2Fvec_deque.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Fvec_deque.rs?ref=9733463d2b141a166bfa2f55ec316066ab0f71b6", "patch": "@@ -558,7 +558,7 @@ impl<T> VecDeque<T> {\n             .and_then(|needed_cap| needed_cap.checked_next_power_of_two())\n             .expect(\"capacity overflow\");\n \n-        if new_cap > self.capacity() {\n+        if new_cap > old_cap {\n             self.buf.reserve_exact(used_cap, new_cap - used_cap);\n             unsafe {\n                 self.handle_cap_increase(old_cap);"}]}