{"sha": "3cb2cd1f7133619761a7c229185f0ab227526181", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNjYjJjZDFmNzEzMzYxOTc2MWE3YzIyOTE4NWYwYWIyMjc1MjYxODE=", "commit": {"author": {"name": "Erick Tryzelaar", "email": "erick.tryzelaar@gmail.com", "date": "2012-03-01T05:23:50Z"}, "committer": {"name": "Erick Tryzelaar", "email": "erick.tryzelaar@gmail.com", "date": "2012-03-03T03:15:35Z"}, "message": "comp/fuzzer: rewrite to use io::with_str_reader.", "tree": {"sha": "40677faa0be6b6975c003eff1a50b99d60f5568e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/40677faa0be6b6975c003eff1a50b99d60f5568e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3cb2cd1f7133619761a7c229185f0ab227526181", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3cb2cd1f7133619761a7c229185f0ab227526181", "html_url": "https://github.com/rust-lang/rust/commit/3cb2cd1f7133619761a7c229185f0ab227526181", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3cb2cd1f7133619761a7c229185f0ab227526181/comments", "author": {"login": "erickt", "id": 84711, "node_id": "MDQ6VXNlcjg0NzEx", "avatar_url": "https://avatars.githubusercontent.com/u/84711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/erickt", "html_url": "https://github.com/erickt", "followers_url": "https://api.github.com/users/erickt/followers", "following_url": "https://api.github.com/users/erickt/following{/other_user}", "gists_url": "https://api.github.com/users/erickt/gists{/gist_id}", "starred_url": "https://api.github.com/users/erickt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/erickt/subscriptions", "organizations_url": "https://api.github.com/users/erickt/orgs", "repos_url": "https://api.github.com/users/erickt/repos", "events_url": "https://api.github.com/users/erickt/events{/privacy}", "received_events_url": "https://api.github.com/users/erickt/received_events", "type": "User", "site_admin": false}, "committer": {"login": "erickt", "id": 84711, "node_id": "MDQ6VXNlcjg0NzEx", "avatar_url": "https://avatars.githubusercontent.com/u/84711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/erickt", "html_url": "https://github.com/erickt", "followers_url": "https://api.github.com/users/erickt/followers", "following_url": "https://api.github.com/users/erickt/following{/other_user}", "gists_url": "https://api.github.com/users/erickt/gists{/gist_id}", "starred_url": "https://api.github.com/users/erickt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/erickt/subscriptions", "organizations_url": "https://api.github.com/users/erickt/orgs", "repos_url": "https://api.github.com/users/erickt/repos", "events_url": "https://api.github.com/users/erickt/events{/privacy}", "received_events_url": "https://api.github.com/users/erickt/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f630ebdb6aac2ceee23765452a2774e83ee3b13e", "url": "https://api.github.com/repos/rust-lang/rust/commits/f630ebdb6aac2ceee23765452a2774e83ee3b13e", "html_url": "https://github.com/rust-lang/rust/commit/f630ebdb6aac2ceee23765452a2774e83ee3b13e"}], "stats": {"total": 30, "additions": 18, "deletions": 12}, "files": [{"sha": "e8655ce6cda7f2f40163266563f528e6224ee30a", "filename": "src/fuzzer/fuzzer.rs", "status": "modified", "additions": 14, "deletions": 10, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/3cb2cd1f7133619761a7c229185f0ab227526181/src%2Ffuzzer%2Ffuzzer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3cb2cd1f7133619761a7c229185f0ab227526181/src%2Ffuzzer%2Ffuzzer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ffuzzer%2Ffuzzer.rs?ref=3cb2cd1f7133619761a7c229185f0ab227526181", "patch": "@@ -412,12 +412,14 @@ fn parse_and_print(code: @str) -> str {\n     write_file(filename, *code);\n     let crate = parser::parse_crate_from_source_str(\n         filename, code, [], sess);\n-    ret as_str(bind pprust::print_crate(sess.cm,\n+    io::with_str_reader(*code) { |rdr|\n+        as_str(bind pprust::print_crate(sess.cm,\n                                         sess.span_diagnostic,\n                                         crate,\n                                         filename,\n-                                        io::str_reader(*code), _,\n-                                        pprust::no_ann()));\n+                                        rdr, _,\n+                                        pprust::no_ann()))\n+    }\n }\n \n fn has_raw_pointers(c: ast::crate) -> bool {\n@@ -557,13 +559,15 @@ fn check_variants(files: [str], cx: context) {\n             parser::parse_crate_from_source_str(\n                 file,\n                 s, [], sess);\n-        #error(\"%s\",\n-               as_str(bind pprust::print_crate(sess.cm,\n-                                               sess.span_diagnostic,\n-                                               crate,\n-                                               file,\n-                                               io::str_reader(*s), _,\n-                                               pprust::no_ann())));\n+        io::with_str_reader(*s) { |rdr|\n+            #error(\"%s\",\n+                   as_str(bind pprust::print_crate(sess.cm,\n+                                                   sess.span_diagnostic,\n+                                                   crate,\n+                                                   file,\n+                                                   rdr, _,\n+                                                   pprust::no_ann())));\n+        }\n         check_variants_of_ast(*crate, sess.cm, file, cx);\n     }\n }"}, {"sha": "b45d95fef270753be86e87e2c43b4faae0ad3c9e", "filename": "src/rustc/driver/driver.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/3cb2cd1f7133619761a7c229185f0ab227526181/src%2Frustc%2Fdriver%2Fdriver.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3cb2cd1f7133619761a7c229185f0ab227526181/src%2Frustc%2Fdriver%2Fdriver.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fdriver%2Fdriver.rs?ref=3cb2cd1f7133619761a7c229185f0ab227526181", "patch": "@@ -272,8 +272,10 @@ fn pretty_print_input(sess: session, cfg: ast::crate_cfg, input: str,\n       ppm_expanded | ppm_normal {}\n     }\n     let src = codemap::get_filemap(sess.codemap, input).src;\n-    pprust::print_crate(sess.codemap, sess.span_diagnostic, crate, input,\n-                        io::str_reader(*src), io::stdout(), ann);\n+    io::with_str_reader(*src) { |rdr|\n+        pprust::print_crate(sess.codemap, sess.span_diagnostic, crate, input,\n+                            rdr, io::stdout(), ann);\n+    }\n }\n \n fn get_os(triple: str) -> option<session::os> {"}]}