{"sha": "89f015ead9ed947d81eecb6e7533f0b8e5f4ed54", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg5ZjAxNWVhZDllZDk0N2Q4MWVlY2I2ZTc1MzNmMGI4ZTVmNGVkNTQ=", "commit": {"author": {"name": "Jonas Schievink", "email": "jonasschievink@gmail.com", "date": "2021-04-12T19:41:44Z"}, "committer": {"name": "Jonas Schievink", "email": "jonasschievink@gmail.com", "date": "2021-04-12T19:41:44Z"}, "message": "Simplify multiline check", "tree": {"sha": "18e1ae1da42b12c2e2122f0aa22a9506cce7aca3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/18e1ae1da42b12c2e2122f0aa22a9506cce7aca3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/89f015ead9ed947d81eecb6e7533f0b8e5f4ed54", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/89f015ead9ed947d81eecb6e7533f0b8e5f4ed54", "html_url": "https://github.com/rust-lang/rust/commit/89f015ead9ed947d81eecb6e7533f0b8e5f4ed54", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/89f015ead9ed947d81eecb6e7533f0b8e5f4ed54/comments", "author": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dd1832c01661e19b8fc4da1111c0263468144ef2", "url": "https://api.github.com/repos/rust-lang/rust/commits/dd1832c01661e19b8fc4da1111c0263468144ef2", "html_url": "https://github.com/rust-lang/rust/commit/dd1832c01661e19b8fc4da1111c0263468144ef2"}], "stats": {"total": 22, "additions": 4, "deletions": 18}, "files": [{"sha": "2a0d500986aa1a416fffad6e4afcb2f076baab7d", "filename": "crates/ide/src/typing/on_enter.rs", "status": "modified", "additions": 4, "deletions": 18, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/89f015ead9ed947d81eecb6e7533f0b8e5f4ed54/crates%2Fide%2Fsrc%2Ftyping%2Fon_enter.rs", "raw_url": "https://github.com/rust-lang/rust/raw/89f015ead9ed947d81eecb6e7533f0b8e5f4ed54/crates%2Fide%2Fsrc%2Ftyping%2Fon_enter.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Ftyping%2Fon_enter.rs?ref=89f015ead9ed947d81eecb6e7533f0b8e5f4ed54", "patch": "@@ -1,14 +1,8 @@\n //! Handles the `Enter` key press. At the momently, this only continues\n //! comments, but should handle indent some time in the future as well.\n \n-use std::sync::Arc;\n-\n+use ide_db::base_db::{FilePosition, SourceDatabase};\n use ide_db::RootDatabase;\n-use ide_db::{\n-    base_db::{FilePosition, SourceDatabase},\n-    line_index::LineIndex,\n-    LineIndexDatabase,\n-};\n use syntax::{\n     algo::find_node_at_offset,\n     ast::{self, edit::IndentLevel, AstToken},\n@@ -55,7 +49,7 @@ pub(crate) fn on_enter(db: &RootDatabase, position: FilePosition) -> Option<Text\n     if token.kind() == L_CURLY {\n         // Typing enter after the `{` of a block expression, where the `}` is on the same line\n         if let Some(edit) = find_node_at_offset(file.syntax(), position.offset - TextSize::of('{'))\n-            .and_then(|block| on_enter_in_block(db, block, position))\n+            .and_then(|block| on_enter_in_block(block, position))\n         {\n             return Some(edit);\n         }\n@@ -103,18 +97,10 @@ fn on_enter_in_comment(\n     Some(edit)\n }\n \n-fn on_enter_in_block(\n-    db: &RootDatabase,\n-    block: ast::BlockExpr,\n-    position: FilePosition,\n-) -> Option<TextEdit> {\n+fn on_enter_in_block(block: ast::BlockExpr, position: FilePosition) -> Option<TextEdit> {\n     let contents = block_contents(&block)?;\n \n-    let line_index: Arc<LineIndex> = db.line_index(position.file_id);\n-    let (open, close) = (block.l_curly_token()?, block.r_curly_token()?);\n-    let start = line_index.line_col(open.text_range().start()).line;\n-    let end = line_index.line_col(close.text_range().end()).line;\n-    if start != end {\n+    if block.syntax().text().contains_char('\\n') {\n         return None;\n     }\n "}]}