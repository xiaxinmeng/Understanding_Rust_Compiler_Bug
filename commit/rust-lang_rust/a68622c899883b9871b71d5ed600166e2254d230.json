{"sha": "a68622c899883b9871b71d5ed600166e2254d230", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE2ODYyMmM4OTk4ODNiOTg3MWI3MWQ1ZWQ2MDAxNjZlMjI1NGQyMzA=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-01-04T01:51:06Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-01-04T01:51:06Z"}, "message": "Auto merge of #38809 - alexcrichton:rustbuild-fresh, r=brson\n\nrustbuild: Fix a few rebuilding issues\n\nDid a bit of investigation and found a few small unrelated issues, but this should help clean up a lot of errors we've been seeing locally.", "tree": {"sha": "97acb7416ff621cbb0f37fd2e4c6b31a30d4b09f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/97acb7416ff621cbb0f37fd2e4c6b31a30d4b09f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a68622c899883b9871b71d5ed600166e2254d230", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a68622c899883b9871b71d5ed600166e2254d230", "html_url": "https://github.com/rust-lang/rust/commit/a68622c899883b9871b71d5ed600166e2254d230", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a68622c899883b9871b71d5ed600166e2254d230/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "468227129d08b52c4cf90313b29fdad1b80e596b", "url": "https://api.github.com/repos/rust-lang/rust/commits/468227129d08b52c4cf90313b29fdad1b80e596b", "html_url": "https://github.com/rust-lang/rust/commit/468227129d08b52c4cf90313b29fdad1b80e596b"}, {"sha": "3ab778b4afc1c11e48dd8b1f82c5dca9c897bcba", "url": "https://api.github.com/repos/rust-lang/rust/commits/3ab778b4afc1c11e48dd8b1f82c5dca9c897bcba", "html_url": "https://github.com/rust-lang/rust/commit/3ab778b4afc1c11e48dd8b1f82c5dca9c897bcba"}], "stats": {"total": 7, "additions": 1, "deletions": 6}, "files": [{"sha": "31f8754d2091e69abd4c0b97a26995cdc6b52dba", "filename": "src/bootstrap/compile.rs", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/a68622c899883b9871b71d5ed600166e2254d230/src%2Fbootstrap%2Fcompile.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a68622c899883b9871b71d5ed600166e2254d230/src%2Fbootstrap%2Fcompile.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fcompile.rs?ref=a68622c899883b9871b71d5ed600166e2254d230", "patch": "@@ -258,11 +258,6 @@ fn compiler_file(compiler: &Path, file: &str) -> PathBuf {\n }\n \n pub fn create_sysroot(build: &Build, compiler: &Compiler) {\n-    // nothing to do in stage0\n-    if compiler.stage == 0 {\n-        return\n-    }\n-\n     let sysroot = build.sysroot(compiler);\n     let _ = fs::remove_dir_all(&sysroot);\n     t!(fs::create_dir_all(&sysroot));\n@@ -396,7 +391,7 @@ pub fn tool(build: &Build, stage: u32, host: &str, tool: &str) {\n /// all files in a directory and updating the stamp if any are newer.\n fn update_mtime(path: &Path) {\n     let mut max = None;\n-    if let Ok(entries) = path.parent().unwrap().read_dir() {\n+    if let Ok(entries) = path.parent().unwrap().join(\"deps\").read_dir() {\n         for entry in entries.map(|e| t!(e)) {\n             if t!(entry.file_type()).is_file() {\n                 let meta = t!(entry.metadata());"}]}