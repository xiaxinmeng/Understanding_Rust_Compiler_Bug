{"sha": "99e43822b44e3a499493ee2797e5b501437d1815", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk5ZTQzODIyYjQ0ZTNhNDk5NDkzZWUyNzk3ZTViNTAxNDM3ZDE4MTU=", "commit": {"author": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2019-02-01T18:31:26Z"}, "committer": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2019-02-01T18:31:26Z"}, "message": "Misc debuginfo.rs changes", "tree": {"sha": "4acc0bb27d33f50293a9a17954eccd3004810015", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4acc0bb27d33f50293a9a17954eccd3004810015"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/99e43822b44e3a499493ee2797e5b501437d1815", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/99e43822b44e3a499493ee2797e5b501437d1815", "html_url": "https://github.com/rust-lang/rust/commit/99e43822b44e3a499493ee2797e5b501437d1815", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/99e43822b44e3a499493ee2797e5b501437d1815/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "410d397bcdfa7898cfb1696eb97c976a30005281", "url": "https://api.github.com/repos/rust-lang/rust/commits/410d397bcdfa7898cfb1696eb97c976a30005281", "html_url": "https://github.com/rust-lang/rust/commit/410d397bcdfa7898cfb1696eb97c976a30005281"}], "stats": {"total": 22, "additions": 14, "deletions": 8}, "files": [{"sha": "63cb7b028e53f684680086d64c6d89dc1c5d9a2e", "filename": "src/debuginfo.rs", "status": "modified", "additions": 14, "deletions": 8, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/99e43822b44e3a499493ee2797e5b501437d1815/src%2Fdebuginfo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/99e43822b44e3a499493ee2797e5b501437d1815/src%2Fdebuginfo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdebuginfo.rs?ref=99e43822b44e3a499493ee2797e5b501437d1815", "patch": "@@ -46,7 +46,6 @@ fn line_program_add_file(line_program: &mut LineProgram, file: &FileName) -> Fil\n             )\n         }\n     }\n-    \n }\n \n struct DebugReloc {\n@@ -57,16 +56,20 @@ struct DebugReloc {\n }\n \n pub struct DebugContext<'tcx> {\n+    // Encoding info\n     encoding: Encoding,\n     endian: RunTimeEndian,\n-\n     symbols: indexmap::IndexSet<String>,\n \n-    strings: StringTable,\n+    // Main data\n     units: UnitTable,\n     line_programs: LineProgramTable,\n+\n+    // Side tables\n+    strings: StringTable,\n     range_lists: RangeListTable,\n \n+    // Global ids\n     unit_id: UnitId,\n     global_line_program: LineProgramId,\n     unit_range_list: RangeList,\n@@ -93,11 +96,12 @@ impl<'a, 'tcx: 'a> DebugContext<'tcx> {\n             None => tcx.crate_name(LOCAL_CRATE).to_string(),\n         };\n \n-        let mut units = UnitTable::default();\n         let mut strings = StringTable::default();\n-        let mut line_programs = LineProgramTable::default();\n         let range_lists = RangeListTable::default();\n \n+        let mut units = UnitTable::default();\n+        let mut line_programs = LineProgramTable::default();\n+\n         let global_line_program = line_programs.add(LineProgram::new(\n             encoding,\n             1,\n@@ -140,13 +144,13 @@ impl<'a, 'tcx: 'a> DebugContext<'tcx> {\n         DebugContext {\n             encoding,\n             endian: target_endian(tcx),\n-\n             symbols: indexmap::IndexSet::new(),\n \n             strings,\n+            range_lists,\n+\n             units,\n             line_programs,\n-            range_lists,\n \n             unit_id,\n             global_line_program,\n@@ -194,8 +198,10 @@ impl<'a, 'tcx: 'a> DebugContext<'tcx> {\n         let mut debug_ranges = DebugRanges::from(WriterRelocate::new(self));\n         let mut debug_rnglists = DebugRngLists::from(WriterRelocate::new(self));\n \n-        let debug_line_offsets = self.line_programs.write(&mut debug_line).unwrap();\n         let debug_str_offsets = self.strings.write(&mut debug_str).unwrap();\n+\n+        let debug_line_offsets = self.line_programs.write(&mut debug_line).unwrap();\n+\n         let range_list_offsets = self\n             .range_lists\n             .write("}]}