{"sha": "d066a7b5069ff857a5bffe7cb5168fe63158144f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQwNjZhN2I1MDY5ZmY4NTdhNWJmZmU3Y2I1MTY4ZmU2MzE1ODE0NGY=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2015-07-23T21:39:02Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2015-07-23T21:39:28Z"}, "message": "update compile-fail/pushpop-unsafe-rejects.rs to reflect switch from saturated to checked arith.", "tree": {"sha": "3cf2adbb07659559ca294c6ae687ca198f92f571", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3cf2adbb07659559ca294c6ae687ca198f92f571"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d066a7b5069ff857a5bffe7cb5168fe63158144f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d066a7b5069ff857a5bffe7cb5168fe63158144f", "html_url": "https://github.com/rust-lang/rust/commit/d066a7b5069ff857a5bffe7cb5168fe63158144f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d066a7b5069ff857a5bffe7cb5168fe63158144f/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2d68d09b4679018d0ba3faf41d239251991bf17b", "url": "https://api.github.com/repos/rust-lang/rust/commits/2d68d09b4679018d0ba3faf41d239251991bf17b", "html_url": "https://github.com/rust-lang/rust/commit/2d68d09b4679018d0ba3faf41d239251991bf17b"}], "stats": {"total": 49, "additions": 25, "deletions": 24}, "files": [{"sha": "72c065ae714173e769051ea1751c7668a0322140", "filename": "src/test/compile-fail/pushpop-unsafe-rejects.rs", "status": "modified", "additions": 25, "deletions": 24, "changes": 49, "blob_url": "https://github.com/rust-lang/rust/blob/d066a7b5069ff857a5bffe7cb5168fe63158144f/src%2Ftest%2Fcompile-fail%2Fpushpop-unsafe-rejects.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d066a7b5069ff857a5bffe7cb5168fe63158144f/src%2Ftest%2Fcompile-fail%2Fpushpop-unsafe-rejects.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fpushpop-unsafe-rejects.rs?ref=d066a7b5069ff857a5bffe7cb5168fe63158144f", "patch": "@@ -45,29 +45,30 @@ fn main() {\n     });\n \n \n-    // Note: For implementation simplicity I have chosen to just have\n-    // the stack do \"saturated pop\", but perhaps we would prefer to\n-    // have cases like these two here be errors:\n-\n-    pop_unsafe!{ g() };\n-\n-    push_unsafe!({\n-        pop_unsafe!(pop_unsafe!{ g() })\n-    });\n-\n-\n-    // Okay, back to examples that do error, even in the presence of\n-    // \"saturated pop\"\n-\n-    push_unsafe!({\n-        g();\n-        pop_unsafe!(pop_unsafe!({\n-            f() //~ ERROR: call to unsafe function\n-        }))\n-    });\n-\n-    pop_unsafe!({\n-        f(); //~ ERROR: call to unsafe function\n-    })\n+    // Note: For implementation simplicity the compiler just\n+    // ICE's if you underflow the push_unsafe stack.\n+    //\n+    // Thus all of the following cases cause an ICE.\n+    //\n+    // (The \"ERROR\" notes are from an earlier version\n+    //  that used saturated arithmetic rather than checked\n+    //  arithmetic.)\n+\n+    //    pop_unsafe!{ g() };\n+    //\n+    //    push_unsafe!({\n+    //        pop_unsafe!(pop_unsafe!{ g() })\n+    //    });\n+    //\n+    //    push_unsafe!({\n+    //        g();\n+    //        pop_unsafe!(pop_unsafe!({\n+    //            f() // ERROR: call to unsafe function\n+    //        }))\n+    //    });\n+    //\n+    //    pop_unsafe!({\n+    //        f(); // ERROR: call to unsafe function\n+    //    })\n \n }"}]}