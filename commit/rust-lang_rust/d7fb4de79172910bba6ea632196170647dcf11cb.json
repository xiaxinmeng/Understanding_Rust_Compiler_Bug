{"sha": "d7fb4de79172910bba6ea632196170647dcf11cb", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ3ZmI0ZGU3OTE3MjkxMGJiYTZlYTYzMjE5NjE3MDY0N2RjZjExY2I=", "commit": {"author": {"name": "Yuki Okushi", "email": "huyuumi.dev@gmail.com", "date": "2021-02-21T06:26:50Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-02-21T06:26:50Z"}, "message": "Rollup merge of #82349 - tmiasko:pretty-test-timeout, r=Mark-Simulacrum\n\ntest: Print test name only once on timeout\n\nPretty formatter when using multiple test threads displays test name twice on\ntimeout event. This implicitly suggest that those are two different events,\nwhile in fact they are always printed together.\n\nPrint test name only once.\n\nBefore:\n\n```\nrunning 3 tests\ntest src/lib.rs - c (line 16) ... ok\ntest src/lib.rs - a (line 3) ... ok\ntest src/lib.rs - b (line 9) ... test src/lib.rs - b (line 9) has been running for over 60 seconds\ntest src/lib.rs - b (line 9) ... ok\n```\n\nAfter:\n\n```\nrunning 3 tests\ntest src/lib.rs - c (line 16) ... ok\ntest src/lib.rs - a (line 3) ... ok\ntest src/lib.rs - b (line 9) has been running for over 60 seconds\ntest src/lib.rs - b (line 9) ... ok\n```", "tree": {"sha": "4c46aed4315f5671ed006deb93874744aeef9ce9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4c46aed4315f5671ed006deb93874744aeef9ce9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d7fb4de79172910bba6ea632196170647dcf11cb", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgMf0qCRBK7hj4Ov3rIwAAdHIIAKM2vSGcLwEJPSK3hmx5dqk1\nRlVCDj+Ol54xevLhA4HlCTq7CEujOglKHoVJPNcH9BBBq+/ea3Vd6fBqyOdW3YMf\nNZFCi3GjSc7CZbr/ochFm9Xm3tvNLlfEum3OPwo29zlM15C9w2WBMJA+XBB/Tela\nHDCv7643NVDZiduIdOnPx8QutFTuhLAE5s1SaZC1/xH3cd0ZA/sWSg0eOiSTxcir\ngJ3kGsy0thg6qJ87fTyk7dUQB+Z+XBLwFpafwAVgbLvYfwk+kdXiTzPyXwmfy0Kb\ngvBfKXMsBx8UsuuhPLasgNAxPGhhgsME5tcAfQlM8iTtkn3BGkRKpimXDjgN7dE=\n=f/TI\n-----END PGP SIGNATURE-----\n", "payload": "tree 4c46aed4315f5671ed006deb93874744aeef9ce9\nparent 01e1d2d5e842cc2ded57f65549603772278f00d6\nparent 88753cead814a0830acdb527f513957fb9fe620a\nauthor Yuki Okushi <huyuumi.dev@gmail.com> 1613888810 +0900\ncommitter GitHub <noreply@github.com> 1613888810 +0900\n\nRollup merge of #82349 - tmiasko:pretty-test-timeout, r=Mark-Simulacrum\n\ntest: Print test name only once on timeout\n\nPretty formatter when using multiple test threads displays test name twice on\ntimeout event. This implicitly suggest that those are two different events,\nwhile in fact they are always printed together.\n\nPrint test name only once.\n\nBefore:\n\n```\nrunning 3 tests\ntest src/lib.rs - c (line 16) ... ok\ntest src/lib.rs - a (line 3) ... ok\ntest src/lib.rs - b (line 9) ... test src/lib.rs - b (line 9) has been running for over 60 seconds\ntest src/lib.rs - b (line 9) ... ok\n```\n\nAfter:\n\n```\nrunning 3 tests\ntest src/lib.rs - c (line 16) ... ok\ntest src/lib.rs - a (line 3) ... ok\ntest src/lib.rs - b (line 9) has been running for over 60 seconds\ntest src/lib.rs - b (line 9) ... ok\n```\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d7fb4de79172910bba6ea632196170647dcf11cb", "html_url": "https://github.com/rust-lang/rust/commit/d7fb4de79172910bba6ea632196170647dcf11cb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d7fb4de79172910bba6ea632196170647dcf11cb/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "01e1d2d5e842cc2ded57f65549603772278f00d6", "url": "https://api.github.com/repos/rust-lang/rust/commits/01e1d2d5e842cc2ded57f65549603772278f00d6", "html_url": "https://github.com/rust-lang/rust/commit/01e1d2d5e842cc2ded57f65549603772278f00d6"}, {"sha": "88753cead814a0830acdb527f513957fb9fe620a", "url": "https://api.github.com/repos/rust-lang/rust/commits/88753cead814a0830acdb527f513957fb9fe620a", "html_url": "https://github.com/rust-lang/rust/commit/88753cead814a0830acdb527f513957fb9fe620a"}], "stats": {"total": 4, "additions": 0, "deletions": 4}, "files": [{"sha": "5e41d6d9692342067cf405fe971615f28b0bd734", "filename": "library/test/src/formatters/pretty.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d7fb4de79172910bba6ea632196170647dcf11cb/library%2Ftest%2Fsrc%2Fformatters%2Fpretty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d7fb4de79172910bba6ea632196170647dcf11cb/library%2Ftest%2Fsrc%2Fformatters%2Fpretty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Ftest%2Fsrc%2Fformatters%2Fpretty.rs?ref=d7fb4de79172910bba6ea632196170647dcf11cb", "patch": "@@ -222,10 +222,6 @@ impl<T: Write> OutputFormatter for PrettyFormatter<T> {\n     }\n \n     fn write_timeout(&mut self, desc: &TestDesc) -> io::Result<()> {\n-        if self.is_multithreaded {\n-            self.write_test_name(desc)?;\n-        }\n-\n         self.write_plain(&format!(\n             \"test {} has been running for over {} seconds\\n\",\n             desc.name,"}]}