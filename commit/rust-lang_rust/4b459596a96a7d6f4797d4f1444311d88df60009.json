{"sha": "4b459596a96a7d6f4797d4f1444311d88df60009", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRiNDU5NTk2YTk2YTdkNmY0Nzk3ZDRmMTQ0NDMxMWQ4OGRmNjAwMDk=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2020-10-06T06:18:11Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2020-10-06T06:18:11Z"}, "message": "clippy_dev: Replace lazy_static with SyncLazy", "tree": {"sha": "7cfb38ea561c67eadd61948b4185446befd00025", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7cfb38ea561c67eadd61948b4185446befd00025"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4b459596a96a7d6f4797d4f1444311d88df60009", "comment_count": 0, "verification": {"verified": false, "reason": "unknown_key", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEb0jkZw3AJLMiOp9wGI/nM3KGUrEFAl98DDYACgkQGI/nM3KG\nUrGHNxAAjBwVyoJB3VeH6NB6xS67P44Z/cYBWdhpG6c9FMpadZZ3rKLQA+eaT56a\nOAgUPijlAgCrcPqVTkDMfwO6pvWzLtg+ifES0ik5xWawRBAB/7O1cME/T2OjTRkR\nD3JbDdI6iqJnQ97sNnR1FGLLlgiinT/rKv6Vd6V0Ro1+VSi6+rAB1B/wvcdqYizM\n0MFGMAscNNnlxbZGaQ6SWwiz3dEGruHd5vgzaadmM2y8284sXASRnse1BBS5OHou\nITBt23YkGJOnFdZsiEtcea69YilKP2V1TFlbQQ/NtYkcwKIwUCFfLidzPorsyDC1\naQSfSLR5/rU5zzfXc8bODE02n+XIW0a3FX6YOkYptGrDz3KUoUAFj5zmmR7YLSyy\n1SBb0af7JNBwuvttNddsqPAUVSg9NLoiCbpYUQNvMTWfX3Fwpm0rAVVFlIV4bk10\nUCiz/A0WxA1SSv02Gw3f88GvqpP/3m7OzeRPf/eAU8P906cZe9Q4oP7wGeHuLpqf\n2UmEmLF/uf8/detg4gD2BpPm9rM0j2emJK6CNKfsFEzgIkN5xfMZOW3L57IaIdgk\nPNUV7/WjZhuY0igRImG2x+3eRCA4iueA9c1asJFGU57k3/FHKcgyj44NvSHHrDnG\n7HU6eeaQ1xlWqsu8cZAJEXbe3BRKibmE02cSbziKQ8Zw7YBDsEU=\n=Miye\n-----END PGP SIGNATURE-----", "payload": "tree 7cfb38ea561c67eadd61948b4185446befd00025\nparent 2ed5143c0ec88fe4cf0e3528bb4aca11059c2c83\nauthor Philipp Hansch <dev@phansch.net> 1601965091 +0200\ncommitter Philipp Hansch <dev@phansch.net> 1601965091 +0200\n\nclippy_dev: Replace lazy_static with SyncLazy\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4b459596a96a7d6f4797d4f1444311d88df60009", "html_url": "https://github.com/rust-lang/rust/commit/4b459596a96a7d6f4797d4f1444311d88df60009", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4b459596a96a7d6f4797d4f1444311d88df60009/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2ed5143c0ec88fe4cf0e3528bb4aca11059c2c83", "url": "https://api.github.com/repos/rust-lang/rust/commits/2ed5143c0ec88fe4cf0e3528bb4aca11059c2c83", "html_url": "https://github.com/rust-lang/rust/commit/2ed5143c0ec88fe4cf0e3528bb4aca11059c2c83"}], "stats": {"total": 43, "additions": 23, "deletions": 20}, "files": [{"sha": "d745000eac7c700f01d2256a76e1fe58720a4b01", "filename": "clippy_dev/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/4b459596a96a7d6f4797d4f1444311d88df60009/clippy_dev%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/4b459596a96a7d6f4797d4f1444311d88df60009/clippy_dev%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2FCargo.toml?ref=4b459596a96a7d6f4797d4f1444311d88df60009", "patch": "@@ -9,7 +9,6 @@ bytecount = \"0.6\"\n clap = \"2.33\"\n itertools = \"0.9\"\n regex = \"1\"\n-lazy_static = \"1.0\"\n shell-escape = \"0.1\"\n walkdir = \"2\"\n "}, {"sha": "567831354f58ab5c7c17ebf154a125195e871487", "filename": "clippy_dev/src/lib.rs", "status": "modified", "additions": 23, "deletions": 19, "changes": 42, "blob_url": "https://github.com/rust-lang/rust/blob/4b459596a96a7d6f4797d4f1444311d88df60009/clippy_dev%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4b459596a96a7d6f4797d4f1444311d88df60009/clippy_dev%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_dev%2Fsrc%2Flib.rs?ref=4b459596a96a7d6f4797d4f1444311d88df60009", "patch": "@@ -1,11 +1,12 @@\n #![cfg_attr(feature = \"deny-warnings\", deny(warnings))]\n+#![feature(once_cell)]\n \n use itertools::Itertools;\n-use lazy_static::lazy_static;\n use regex::Regex;\n use std::collections::HashMap;\n use std::ffi::OsStr;\n use std::fs;\n+use std::lazy::SyncLazy;\n use std::path::{Path, PathBuf};\n use walkdir::WalkDir;\n \n@@ -15,28 +16,31 @@ pub mod ra_setup;\n pub mod stderr_length_check;\n pub mod update_lints;\n \n-lazy_static! {\n-    static ref DEC_CLIPPY_LINT_RE: Regex = Regex::new(\n+static DEC_CLIPPY_LINT_RE: SyncLazy<Regex> = SyncLazy::new(|| {\n+    Regex::new(\n         r#\"(?x)\n-        declare_clippy_lint!\\s*[\\{(]\n-        (?:\\s+///.*)*\n-        \\s+pub\\s+(?P<name>[A-Z_][A-Z_0-9]*)\\s*,\\s*\n-        (?P<cat>[a-z_]+)\\s*,\\s*\n-        \"(?P<desc>(?:[^\"\\\\]+|\\\\(?s).(?-s))*)\"\\s*[})]\n-    \"#\n+    declare_clippy_lint!\\s*[\\{(]\n+    (?:\\s+///.*)*\n+    \\s+pub\\s+(?P<name>[A-Z_][A-Z_0-9]*)\\s*,\\s*\n+    (?P<cat>[a-z_]+)\\s*,\\s*\n+    \"(?P<desc>(?:[^\"\\\\]+|\\\\(?s).(?-s))*)\"\\s*[})]\n+\"#,\n     )\n-    .unwrap();\n-    static ref DEC_DEPRECATED_LINT_RE: Regex = Regex::new(\n+    .unwrap()\n+});\n+\n+static DEC_DEPRECATED_LINT_RE: SyncLazy<Regex> = SyncLazy::new(|| {\n+    Regex::new(\n         r#\"(?x)\n-        declare_deprecated_lint!\\s*[{(]\\s*\n-        (?:\\s+///.*)*\n-        \\s+pub\\s+(?P<name>[A-Z_][A-Z_0-9]*)\\s*,\\s*\n-        \"(?P<desc>(?:[^\"\\\\]+|\\\\(?s).(?-s))*)\"\\s*[})]\n-    \"#\n+    declare_deprecated_lint!\\s*[{(]\\s*\n+    (?:\\s+///.*)*\n+    \\s+pub\\s+(?P<name>[A-Z_][A-Z_0-9]*)\\s*,\\s*\n+    \"(?P<desc>(?:[^\"\\\\]+|\\\\(?s).(?-s))*)\"\\s*[})]\n+\"#,\n     )\n-    .unwrap();\n-    static ref NL_ESCAPE_RE: Regex = Regex::new(r#\"\\\\\\n\\s*\"#).unwrap();\n-}\n+    .unwrap()\n+});\n+static NL_ESCAPE_RE: SyncLazy<Regex> = SyncLazy::new(|| Regex::new(r#\"\\\\\\n\\s*\"#).unwrap());\n \n pub static DOCS_LINK: &str = \"https://rust-lang.github.io/rust-clippy/master/index.html\";\n "}]}