{"sha": "b7eed53b55d43c8d63ede9e8e45c532e9cc83cc2", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI3ZWVkNTNiNTVkNDNjOGQ2M2VkZTllOGU0NWM1MzJlOWNjODNjYzI=", "commit": {"author": {"name": "Jeffrey Seyfried", "email": "jeffrey.seyfried@gmail.com", "date": "2016-11-03T21:58:28Z"}, "committer": {"name": "Jeffrey Seyfried", "email": "jeffrey.seyfried@gmail.com", "date": "2016-11-04T02:39:20Z"}, "message": "Remove field `TtReader::next_tok`.", "tree": {"sha": "54fd812f8fe95d85781fbebbd71720dbc8565f4d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/54fd812f8fe95d85781fbebbd71720dbc8565f4d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b7eed53b55d43c8d63ede9e8e45c532e9cc83cc2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b7eed53b55d43c8d63ede9e8e45c532e9cc83cc2", "html_url": "https://github.com/rust-lang/rust/commit/b7eed53b55d43c8d63ede9e8e45c532e9cc83cc2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b7eed53b55d43c8d63ede9e8e45c532e9cc83cc2/comments", "author": {"login": "jseyfried", "id": 8652869, "node_id": "MDQ6VXNlcjg2NTI4Njk=", "avatar_url": "https://avatars.githubusercontent.com/u/8652869?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jseyfried", "html_url": "https://github.com/jseyfried", "followers_url": "https://api.github.com/users/jseyfried/followers", "following_url": "https://api.github.com/users/jseyfried/following{/other_user}", "gists_url": "https://api.github.com/users/jseyfried/gists{/gist_id}", "starred_url": "https://api.github.com/users/jseyfried/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jseyfried/subscriptions", "organizations_url": "https://api.github.com/users/jseyfried/orgs", "repos_url": "https://api.github.com/users/jseyfried/repos", "events_url": "https://api.github.com/users/jseyfried/events{/privacy}", "received_events_url": "https://api.github.com/users/jseyfried/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jseyfried", "id": 8652869, "node_id": "MDQ6VXNlcjg2NTI4Njk=", "avatar_url": "https://avatars.githubusercontent.com/u/8652869?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jseyfried", "html_url": "https://github.com/jseyfried", "followers_url": "https://api.github.com/users/jseyfried/followers", "following_url": "https://api.github.com/users/jseyfried/following{/other_user}", "gists_url": "https://api.github.com/users/jseyfried/gists{/gist_id}", "starred_url": "https://api.github.com/users/jseyfried/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jseyfried/subscriptions", "organizations_url": "https://api.github.com/users/jseyfried/orgs", "repos_url": "https://api.github.com/users/jseyfried/repos", "events_url": "https://api.github.com/users/jseyfried/events{/privacy}", "received_events_url": "https://api.github.com/users/jseyfried/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "23ad6fdb66a2159b173e3e781c51d648fa663882", "url": "https://api.github.com/repos/rust-lang/rust/commits/23ad6fdb66a2159b173e3e781c51d648fa663882", "html_url": "https://github.com/rust-lang/rust/commit/23ad6fdb66a2159b173e3e781c51d648fa663882"}], "stats": {"total": 9, "additions": 2, "deletions": 7}, "files": [{"sha": "37e329e5d3b29fb581e7d3b77838da3acda067d5", "filename": "src/libsyntax/ext/tt/transcribe.rs", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/b7eed53b55d43c8d63ede9e8e45c532e9cc83cc2/src%2Flibsyntax%2Fext%2Ftt%2Ftranscribe.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b7eed53b55d43c8d63ede9e8e45c532e9cc83cc2/src%2Flibsyntax%2Fext%2Ftt%2Ftranscribe.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fext%2Ftt%2Ftranscribe.rs?ref=b7eed53b55d43c8d63ede9e8e45c532e9cc83cc2", "patch": "@@ -44,7 +44,6 @@ pub struct TtReader<'a> {\n     /* cached: */\n     pub cur_tok: Token,\n     pub cur_span: Span,\n-    pub next_tok: Option<TokenAndSpan>,\n     /// Transform doc comments. Only useful in macro invocations\n     pub fatal_errs: Vec<DiagnosticBuilder<'a>>,\n }\n@@ -77,7 +76,6 @@ pub fn new_tt_reader(sp_diag: &Handler,\n         /* dummy values, never read: */\n         cur_tok: token::Eof,\n         cur_span: DUMMY_SP,\n-        next_tok: None,\n         fatal_errs: Vec::new(),\n     };\n     tt_next_token(&mut r); /* get cur_tok and cur_span set up */\n@@ -156,9 +154,6 @@ fn lockstep_iter_size(t: &TokenTree, r: &TtReader) -> LockstepIterSize {\n /// Return the next token from the TtReader.\n /// EFFECT: advances the reader's token field\n pub fn tt_next_token(r: &mut TtReader) -> TokenAndSpan {\n-    if let Some(tok) = r.next_tok.take() {\n-        return tok;\n-    }\n     // FIXME(pcwalton): Bad copy?\n     let ret_val = TokenAndSpan {\n         tok: r.cur_tok.clone(),"}, {"sha": "cf48c445c80ebf24f2be8bb15467ecba278aab70", "filename": "src/libsyntax/parse/lexer/mod.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b7eed53b55d43c8d63ede9e8e45c532e9cc83cc2/src%2Flibsyntax%2Fparse%2Flexer%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b7eed53b55d43c8d63ede9e8e45c532e9cc83cc2/src%2Flibsyntax%2Fparse%2Flexer%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Flexer%2Fmod.rs?ref=b7eed53b55d43c8d63ede9e8e45c532e9cc83cc2", "patch": "@@ -171,10 +171,10 @@ impl<'a> Reader for TtReader<'a> {\n         self.fatal_errs.clear();\n     }\n     fn peek(&self) -> TokenAndSpan {\n-        self.next_tok.clone().unwrap_or(TokenAndSpan {\n+        TokenAndSpan {\n             tok: self.cur_tok.clone(),\n             sp: self.cur_span,\n-        })\n+        }\n     }\n }\n "}]}