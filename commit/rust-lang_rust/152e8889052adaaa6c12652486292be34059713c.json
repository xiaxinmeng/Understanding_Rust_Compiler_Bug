{"sha": "152e8889052adaaa6c12652486292be34059713c", "node_id": "C_kwDOAAsO6NoAKDE1MmU4ODg5MDUyYWRhYWE2YzEyNjUyNDg2MjkyYmUzNDA1OTcxM2M", "commit": {"author": {"name": "Jacob Hoffman-Andrews", "email": "github@hoffman-andrews.com", "date": "2022-01-13T17:54:44Z"}, "committer": {"name": "Jacob Hoffman-Andrews", "email": "github@hoffman-andrews.com", "date": "2022-01-20T04:52:09Z"}, "message": "Rustdoc mobile: put out-of-band on its own line\n\nBefore this, the item name and the stability, source link, and \"collapse\nall docs\" would compete for room on a single line, resulting in awkward\nwrapping behavior on mobile. This gives a separate line for that\nout-of-band information. It also removes the \"copy path\" icon on mobile\nto make a little more room.\n\nAlso, switch to flex-wrap: wrap, so anytime there's not enough room for\n`source`, it gets bumped to the next line.", "tree": {"sha": "32cd9a7dc265181f69aee41b0e881c71f1a496c0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/32cd9a7dc265181f69aee41b0e881c71f1a496c0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/152e8889052adaaa6c12652486292be34059713c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/152e8889052adaaa6c12652486292be34059713c", "html_url": "https://github.com/rust-lang/rust/commit/152e8889052adaaa6c12652486292be34059713c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/152e8889052adaaa6c12652486292be34059713c/comments", "author": {"login": "jsha", "id": 220205, "node_id": "MDQ6VXNlcjIyMDIwNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/220205?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsha", "html_url": "https://github.com/jsha", "followers_url": "https://api.github.com/users/jsha/followers", "following_url": "https://api.github.com/users/jsha/following{/other_user}", "gists_url": "https://api.github.com/users/jsha/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsha/subscriptions", "organizations_url": "https://api.github.com/users/jsha/orgs", "repos_url": "https://api.github.com/users/jsha/repos", "events_url": "https://api.github.com/users/jsha/events{/privacy}", "received_events_url": "https://api.github.com/users/jsha/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jsha", "id": 220205, "node_id": "MDQ6VXNlcjIyMDIwNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/220205?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsha", "html_url": "https://github.com/jsha", "followers_url": "https://api.github.com/users/jsha/followers", "following_url": "https://api.github.com/users/jsha/following{/other_user}", "gists_url": "https://api.github.com/users/jsha/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsha/subscriptions", "organizations_url": "https://api.github.com/users/jsha/orgs", "repos_url": "https://api.github.com/users/jsha/repos", "events_url": "https://api.github.com/users/jsha/events{/privacy}", "received_events_url": "https://api.github.com/users/jsha/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "237949b6c8e5b387e0a9d1e7a22e0397c95fe488", "url": "https://api.github.com/repos/rust-lang/rust/commits/237949b6c8e5b387e0a9d1e7a22e0397c95fe488", "html_url": "https://github.com/rust-lang/rust/commit/237949b6c8e5b387e0a9d1e7a22e0397c95fe488"}], "stats": {"total": 58, "additions": 43, "deletions": 15}, "files": [{"sha": "d0244351b5973d907995aee75ba8ce37d2582f07", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 20, "deletions": 9, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/152e8889052adaaa6c12652486292be34059713c/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/152e8889052adaaa6c12652486292be34059713c/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=152e8889052adaaa6c12652486292be34059713c", "patch": "@@ -148,11 +148,11 @@ h1.fqn {\n }\n .main-heading {\n \tdisplay: flex;\n+\tflex-wrap: wrap;\n+\tjustify-content: space-between;\n+\tborder-bottom: 1px dashed #DDDDDD;\n+\tpadding-bottom: 6px;\n \tmargin-bottom: 15px;\n-\n-\t/* workaround to keep flex from breaking below 700 px width due to the float: right on the nav\n-\t   above the h1 */\n-\tpadding-left: 1px;\n }\n .main-heading a:hover {\n \ttext-decoration: underline;\n@@ -623,11 +623,7 @@ nav.sub {\n \n .content .out-of-band {\n \tflex-grow: 0;\n-\ttext-align: right;\n-\tmargin-left: auto;\n-\tmargin-right: 0;\n \tfont-size: 1.15rem;\n-\tpadding: 0 0 0 12px;\n \tfont-weight: normal;\n \tfloat: right;\n }\n@@ -1748,10 +1744,25 @@ details.rustdoc-toggle[open] > summary.hideme::after {\n \t\tpadding-top: 0px;\n \t}\n \n-\t.rustdoc {\n+\t.rustdoc,\n+\t.main-heading {\n \t\tflex-direction: column;\n \t}\n \n+\t.content .out-of-band {\n+\t\ttext-align: left;\n+\t\tmargin-left: initial;\n+\t\tpadding: initial;\n+\t}\n+\n+\t.content .out-of-band .since::before {\n+\t\tcontent: \"Since \";\n+\t}\n+\n+\t#copy-path {\n+\t\tdisplay: none;\n+\t}\n+\n \t/* Hide the logo and item name from the sidebar. Those are displayed\n \t   in the mobile-topbar instead. */\n \t.sidebar .sidebar-logo,"}, {"sha": "acde112392521caf3be383a9c11ce7c76d4ece7d", "filename": "src/test/rustdoc-gui/mobile.goml", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/152e8889052adaaa6c12652486292be34059713c/src%2Ftest%2Frustdoc-gui%2Fmobile.goml", "raw_url": "https://github.com/rust-lang/rust/raw/152e8889052adaaa6c12652486292be34059713c/src%2Ftest%2Frustdoc-gui%2Fmobile.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fmobile.goml?ref=152e8889052adaaa6c12652486292be34059713c", "patch": "@@ -0,0 +1,17 @@\n+// Test various properties of the mobile UI\n+goto: file://|DOC_PATH|/staged_api/struct.Foo.html\n+size: (400, 600)\n+\n+// The out-of-band info (source, stable version, collapse) should be below the\n+// h1 when the screen gets narrow enough.\n+assert-css: (\".main-heading\", {\n+  \"display\": \"flex\",\n+  \"flex-direction\": \"column\"\n+})\n+\n+// Note: We can't use assert-text here because the 'Since' is set by CSS and\n+// is therefore not part of the DOM.\n+assert-css: (\".content .out-of-band .since::before\", { \"content\": \"\\\"Since \\\"\" })\n+\n+size: (1000, 1000)\n+assert-css-false: (\".content .out-of-band .since::before\", { \"content\": \"\\\"Since \\\"\" })"}, {"sha": "e7a75b43c5a02abca8294d4cf1dc061608c4d9ab", "filename": "src/test/rustdoc-gui/toggle-docs-mobile.goml", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/152e8889052adaaa6c12652486292be34059713c/src%2Ftest%2Frustdoc-gui%2Ftoggle-docs-mobile.goml", "raw_url": "https://github.com/rust-lang/rust/raw/152e8889052adaaa6c12652486292be34059713c/src%2Ftest%2Frustdoc-gui%2Ftoggle-docs-mobile.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Ftoggle-docs-mobile.goml?ref=152e8889052adaaa6c12652486292be34059713c", "patch": "@@ -1,12 +1,12 @@\n goto: file://|DOC_PATH|/test_docs/struct.Foo.html\n size: (433, 600)\n assert-attribute: (\".top-doc\", {\"open\": \"\"})\n-click: (4, 250) // This is the position of the top doc comment toggle\n+click: (4, 270) // This is the position of the top doc comment toggle\n assert-attribute-false: (\".top-doc\", {\"open\": \"\"})\n-click: (4, 250)\n+click: (4, 270)\n assert-attribute: (\".top-doc\", {\"open\": \"\"})\n // To ensure that the toggle isn't over the text, we check that the toggle isn't clicked.\n-click: (3, 250)\n+click: (3, 270)\n assert-attribute: (\".top-doc\", {\"open\": \"\"})\n \n // Assert the position of the toggle on the top doc block.\n@@ -22,10 +22,10 @@ assert-position: (\n // Now we do the same but with a little bigger width\n size: (600, 600)\n assert-attribute: (\".top-doc\", {\"open\": \"\"})\n-click: (4, 250) // New Y position since all search elements are back on one line.\n+click: (4, 270) // New Y position since all search elements are back on one line.\n assert-attribute-false: (\".top-doc\", {\"open\": \"\"})\n-click: (4, 250)\n+click: (4, 270)\n assert-attribute: (\".top-doc\", {\"open\": \"\"})\n // To ensure that the toggle isn't over the text, we check that the toggle isn't clicked.\n-click: (3, 250)\n+click: (3, 270)\n assert-attribute: (\".top-doc\", {\"open\": \"\"})"}]}