{"sha": "5dc8dfa86ff0862c8fa93f794f12c03007023b2e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVkYzhkZmE4NmZmMDg2MmM4ZmE5M2Y3OTRmMTJjMDMwMDcwMjNiMmU=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2016-05-20T13:49:52Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2016-05-20T13:49:52Z"}, "message": "Rollup merge of #33683 - sanxiyn:paren-span, r=nikomatsakis\n\nPreserve span when lowering ExprKind::Paren\n\nFix #33681.", "tree": {"sha": "859c5a861794252bc9ba80d6227851fbcd6976b5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/859c5a861794252bc9ba80d6227851fbcd6976b5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5dc8dfa86ff0862c8fa93f794f12c03007023b2e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5dc8dfa86ff0862c8fa93f794f12c03007023b2e", "html_url": "https://github.com/rust-lang/rust/commit/5dc8dfa86ff0862c8fa93f794f12c03007023b2e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5dc8dfa86ff0862c8fa93f794f12c03007023b2e/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f22c5aab1e740cf38e0bc04895e2a08597e3b025", "url": "https://api.github.com/repos/rust-lang/rust/commits/f22c5aab1e740cf38e0bc04895e2a08597e3b025", "html_url": "https://github.com/rust-lang/rust/commit/f22c5aab1e740cf38e0bc04895e2a08597e3b025"}, {"sha": "edf1773fb7b56b39e68411d87c86f870697b997b", "url": "https://api.github.com/repos/rust-lang/rust/commits/edf1773fb7b56b39e68411d87c86f870697b997b", "html_url": "https://github.com/rust-lang/rust/commit/edf1773fb7b56b39e68411d87c86f870697b997b"}], "stats": {"total": 45, "additions": 40, "deletions": 5}, "files": [{"sha": "a40608b0762d66a4e74966312d48ff5c1c182e85", "filename": "src/libcore/macros.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5dc8dfa86ff0862c8fa93f794f12c03007023b2e/src%2Flibcore%2Fmacros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5dc8dfa86ff0862c8fa93f794f12c03007023b2e/src%2Flibcore%2Fmacros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fmacros.rs?ref=5dc8dfa86ff0862c8fa93f794f12c03007023b2e", "patch": "@@ -86,7 +86,7 @@ macro_rules! assert {\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n macro_rules! assert_eq {\n     ($left:expr , $right:expr) => ({\n-        match (&($left), &($right)) {\n+        match (&$left, &$right) {\n             (left_val, right_val) => {\n                 if !(*left_val == *right_val) {\n                     panic!(\"assertion failed: `(left == right)` \\"}, {"sha": "28506fd20fe53bc3884290069474916c1a39a23f", "filename": "src/librustc/hir/lowering.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/5dc8dfa86ff0862c8fa93f794f12c03007023b2e/src%2Flibrustc%2Fhir%2Flowering.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5dc8dfa86ff0862c8fa93f794f12c03007023b2e/src%2Flibrustc%2Fhir%2Flowering.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fhir%2Flowering.rs?ref=5dc8dfa86ff0862c8fa93f794f12c03007023b2e", "patch": "@@ -1286,8 +1286,12 @@ impl<'a> LoweringContext<'a> {\n                                     maybe_expr.as_ref().map(|x| self.lower_expr(x)))\n                 }\n                 ExprKind::Paren(ref ex) => {\n-                    // merge attributes into the inner expression.\n                     return self.lower_expr(ex).map(|mut ex| {\n+                        // include parens in span, but only if it is a super-span.\n+                        if e.span.contains(ex.span) {\n+                            ex.span = e.span;\n+                        }\n+                        // merge attributes into the inner expression.\n                         ex.attrs.update(|attrs| {\n                             attrs.prepend(e.attrs.clone())\n                         });"}, {"sha": "790b774bd2133fc0ad1db7b5f49f3a6b9b9d488a", "filename": "src/test/compile-fail/issue-2392.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/5dc8dfa86ff0862c8fa93f794f12c03007023b2e/src%2Ftest%2Fcompile-fail%2Fissue-2392.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5dc8dfa86ff0862c8fa93f794f12c03007023b2e/src%2Ftest%2Fcompile-fail%2Fissue-2392.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-2392.rs?ref=5dc8dfa86ff0862c8fa93f794f12c03007023b2e", "patch": "@@ -81,11 +81,11 @@ impl FuncContainerOuter {\n     fn run(&self) {\n         unsafe {\n             (*self.container).f1(1); //~ ERROR no method named `f1` found\n-            //~^ NOTE use `(*self.container.f1)(...)`\n+            //~^ NOTE use `((*self.container).f1)(...)`\n             (*self.container).f2(1); //~ ERROR no method named `f2` found\n-            //~^ NOTE use `(*self.container.f2)(...)`\n+            //~^ NOTE use `((*self.container).f2)(...)`\n             (*self.container).f3(1); //~ ERROR no method named `f3` found\n-            //~^ NOTE use `(*self.container.f3)(...)`\n+            //~^ NOTE use `((*self.container).f3)(...)`\n         }\n     }\n }"}, {"sha": "8ed5050f3de3c28a0386cd1ff82c4b518c40b2a5", "filename": "src/test/compile-fail/paren-span.rs", "status": "added", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/5dc8dfa86ff0862c8fa93f794f12c03007023b2e/src%2Ftest%2Fcompile-fail%2Fparen-span.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5dc8dfa86ff0862c8fa93f794f12c03007023b2e/src%2Ftest%2Fcompile-fail%2Fparen-span.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fparen-span.rs?ref=5dc8dfa86ff0862c8fa93f794f12c03007023b2e", "patch": "@@ -0,0 +1,31 @@\n+// Copyright 2016 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// Be smart about span of parenthesized expression in macro.\n+\n+macro_rules! paren {\n+    ($e:expr) => (($e))\n+    //            ^^^^ do not highlight here\n+}\n+\n+mod m {\n+    pub struct S {\n+        x: i32\n+    }\n+    pub fn make() -> S {\n+        S { x: 0 }\n+    }\n+}\n+\n+fn main() {\n+    let s = m::make();\n+    paren!(s.x); //~ ERROR field `x` of struct `m::S` is private\n+    //     ^^^ highlight here\n+}"}]}