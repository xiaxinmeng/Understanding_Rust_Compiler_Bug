{"sha": "5b0c86af7d1683983a35f232baa7c98cfa3c382d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjViMGM4NmFmN2QxNjgzOTgzYTM1ZjIzMmJhYTdjOThjZmEzYzM4MmQ=", "commit": {"author": {"name": "Lauren\u021biu Nicola", "email": "lnicola@dend.ro", "date": "2021-08-03T11:32:28Z"}, "committer": {"name": "Lauren\u021biu Nicola", "email": "lnicola@dend.ro", "date": "2021-08-03T11:33:37Z"}, "message": "Downgrade notify and use RecommendedWatcher", "tree": {"sha": "4fd9fbc47b91e97a531a27e3ddfdf8c42752506d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4fd9fbc47b91e97a531a27e3ddfdf8c42752506d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5b0c86af7d1683983a35f232baa7c98cfa3c382d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5b0c86af7d1683983a35f232baa7c98cfa3c382d", "html_url": "https://github.com/rust-lang/rust/commit/5b0c86af7d1683983a35f232baa7c98cfa3c382d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5b0c86af7d1683983a35f232baa7c98cfa3c382d/comments", "author": {"login": "lnicola", "id": 308347, "node_id": "MDQ6VXNlcjMwODM0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/308347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lnicola", "html_url": "https://github.com/lnicola", "followers_url": "https://api.github.com/users/lnicola/followers", "following_url": "https://api.github.com/users/lnicola/following{/other_user}", "gists_url": "https://api.github.com/users/lnicola/gists{/gist_id}", "starred_url": "https://api.github.com/users/lnicola/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lnicola/subscriptions", "organizations_url": "https://api.github.com/users/lnicola/orgs", "repos_url": "https://api.github.com/users/lnicola/repos", "events_url": "https://api.github.com/users/lnicola/events{/privacy}", "received_events_url": "https://api.github.com/users/lnicola/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lnicola", "id": 308347, "node_id": "MDQ6VXNlcjMwODM0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/308347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lnicola", "html_url": "https://github.com/lnicola", "followers_url": "https://api.github.com/users/lnicola/followers", "following_url": "https://api.github.com/users/lnicola/following{/other_user}", "gists_url": "https://api.github.com/users/lnicola/gists{/gist_id}", "starred_url": "https://api.github.com/users/lnicola/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lnicola/subscriptions", "organizations_url": "https://api.github.com/users/lnicola/orgs", "repos_url": "https://api.github.com/users/lnicola/repos", "events_url": "https://api.github.com/users/lnicola/events{/privacy}", "received_events_url": "https://api.github.com/users/lnicola/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "df0936b4af7bd573dc8906b6dbdbf80ff40b75f3", "url": "https://api.github.com/repos/rust-lang/rust/commits/df0936b4af7bd573dc8906b6dbdbf80ff40b75f3", "html_url": "https://github.com/rust-lang/rust/commit/df0936b4af7bd573dc8906b6dbdbf80ff40b75f3"}], "stats": {"total": 36, "additions": 8, "deletions": 28}, "files": [{"sha": "4af046ec84b8439e3e5cf1618d8051139f369174", "filename": "Cargo.lock", "status": "modified", "additions": 2, "deletions": 23, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/5b0c86af7d1683983a35f232baa7c98cfa3c382d/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/5b0c86af7d1683983a35f232baa7c98cfa3c382d/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=5b0c86af7d1683983a35f232baa7c98cfa3c382d", "patch": "@@ -763,26 +763,6 @@ version = \"0.1.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"8b23360e99b8717f20aaa4598f5a6541efbe30630039fbc7706cf954a87947ae\"\n \n-[[package]]\n-name = \"kqueue\"\n-version = \"1.0.3\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"512705bfcaeb3d46379771adc69deab978355fc68fdf960f9fb11abc8d678a96\"\n-dependencies = [\n- \"kqueue-sys\",\n- \"libc\",\n-]\n-\n-[[package]]\n-name = \"kqueue-sys\"\n-version = \"1.0.2\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"9803ae382091c10a5c7297ffb9fde284dbc9662b249f86eacef605d97ae92d99\"\n-dependencies = [\n- \"bitflags\",\n- \"libc\",\n-]\n-\n [[package]]\n name = \"la-arena\"\n version = \"0.2.1\"\n@@ -963,16 +943,15 @@ dependencies = [\n \n [[package]]\n name = \"notify\"\n-version = \"5.0.0-pre.11\"\n+version = \"5.0.0-pre.10\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"c614e7ed2b1cf82ec99aeffd8cf6225ef5021b9951148eb161393c394855032c\"\n+checksum = \"51f18203a26893ca1d3526cf58084025d5639f91c44f8b70ab3b724f60e819a0\"\n dependencies = [\n  \"bitflags\",\n  \"crossbeam-channel\",\n  \"filetime\",\n  \"fsevent-sys\",\n  \"inotify\",\n- \"kqueue\",\n  \"libc\",\n  \"mio\",\n  \"walkdir\","}, {"sha": "42200278da51c115add8865167afdc0b2d796a4a", "filename": "crates/vfs-notify/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5b0c86af7d1683983a35f232baa7c98cfa3c382d/crates%2Fvfs-notify%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/5b0c86af7d1683983a35f232baa7c98cfa3c382d/crates%2Fvfs-notify%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fvfs-notify%2FCargo.toml?ref=5b0c86af7d1683983a35f232baa7c98cfa3c382d", "patch": "@@ -14,7 +14,7 @@ rustc-hash = \"1.0\"\n jod-thread = \"0.1.0\"\n walkdir = \"2.3.1\"\n crossbeam-channel = \"0.5.0\"\n-notify = \"=5.0.0-pre.11\"\n+notify = \"=5.0.0-pre.10\"    # check that it builds on NetBSD before upgrading\n \n vfs = { path = \"../vfs\", version = \"0.0.0\" }\n paths = { path = \"../paths\", version = \"0.0.0\" }"}, {"sha": "a28cb7a33041030949424ac6472053841b7ad2b0", "filename": "crates/vfs-notify/src/lib.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/5b0c86af7d1683983a35f232baa7c98cfa3c382d/crates%2Fvfs-notify%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5b0c86af7d1683983a35f232baa7c98cfa3c382d/crates%2Fvfs-notify%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fvfs-notify%2Fsrc%2Flib.rs?ref=5b0c86af7d1683983a35f232baa7c98cfa3c382d", "patch": "@@ -83,9 +83,10 @@ impl NotifyActor {\n                         self.watcher = None;\n                         if !config.watch.is_empty() {\n                             let (watcher_sender, watcher_receiver) = unbounded();\n-                            let watcher = log_notify_error(RecommendedWatcher::new(move |event| {\n-                                watcher_sender.send(event).unwrap()\n-                            }));\n+                            let watcher =\n+                                log_notify_error(RecommendedWatcher::new_immediate(move |event| {\n+                                    watcher_sender.send(event).unwrap()\n+                                }));\n                             self.watcher = watcher.map(|it| (it, watcher_receiver));\n                         }\n \n@@ -214,7 +215,7 @@ impl NotifyActor {\n \n     fn watch(&mut self, path: AbsPathBuf) {\n         if let Some((watcher, _)) = &mut self.watcher {\n-            log_notify_error(watcher.watch(path.as_ref(), RecursiveMode::NonRecursive));\n+            log_notify_error(watcher.watch(&path, RecursiveMode::NonRecursive));\n         }\n     }\n     fn send(&mut self, msg: loader::Message) {"}]}