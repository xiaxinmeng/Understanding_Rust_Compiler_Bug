{"sha": "a5a6973df68a99a19176c717a337d5cdbf7c5629", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE1YTY5NzNkZjY4YTk5YTE5MTc2YzcxN2EzMzdkNWNkYmY3YzU2Mjk=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-02-03T19:41:52Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-02-03T19:41:52Z"}, "message": "fmt", "tree": {"sha": "1e3a55035197907c6ae1f7815b1be8bf8bb33ae2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1e3a55035197907c6ae1f7815b1be8bf8bb33ae2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a5a6973df68a99a19176c717a337d5cdbf7c5629", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a5a6973df68a99a19176c717a337d5cdbf7c5629", "html_url": "https://github.com/rust-lang/rust/commit/a5a6973df68a99a19176c717a337d5cdbf7c5629", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a5a6973df68a99a19176c717a337d5cdbf7c5629/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2fd3228525858f594361eba345ff31087f8a917a", "url": "https://api.github.com/repos/rust-lang/rust/commits/2fd3228525858f594361eba345ff31087f8a917a", "html_url": "https://github.com/rust-lang/rust/commit/2fd3228525858f594361eba345ff31087f8a917a"}], "stats": {"total": 18, "additions": 7, "deletions": 11}, "files": [{"sha": "df9d2db81583c138a82e796851650719a70b44ac", "filename": "tools/src/bin/collect-tests.rs", "status": "modified", "additions": 7, "deletions": 11, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/a5a6973df68a99a19176c717a337d5cdbf7c5629/tools%2Fsrc%2Fbin%2Fcollect-tests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a5a6973df68a99a19176c717a337d5cdbf7c5629/tools%2Fsrc%2Fbin%2Fcollect-tests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tools%2Fsrc%2Fbin%2Fcollect-tests.rs?ref=a5a6973df68a99a19176c717a337d5cdbf7c5629", "patch": "@@ -1,11 +1,11 @@\n extern crate file;\n-extern crate walkdir;\n extern crate itertools;\n+extern crate walkdir;\n \n use walkdir::WalkDir;\n use itertools::Itertools;\n \n-use std::path::{PathBuf, Path};\n+use std::path::{Path, PathBuf};\n use std::collections::HashSet;\n use std::fs;\n \n@@ -33,7 +33,6 @@ fn main() {\n     }\n }\n \n-\n #[derive(Debug, Eq)]\n struct Test {\n     name: String,\n@@ -57,13 +56,12 @@ fn tests_from_dir(dir: &Path) -> HashSet<Test> {\n     for entry in WalkDir::new(dir) {\n         let entry = entry.unwrap();\n         if !entry.file_type().is_file() {\n-            continue\n+            continue;\n         }\n         if entry.path().extension().unwrap_or_default() != \"rs\" {\n-            continue\n+            continue;\n         }\n-        let text = file::get_text(entry.path())\n-            .unwrap();\n+        let text = file::get_text(entry.path()).unwrap();\n \n         for test in collect_tests(&text) {\n             if let Some(old_test) = res.replace(test) {\n@@ -88,7 +86,7 @@ fn collect_tests(s: &str) -> Vec<Test> {\n         let mut block = block.map(|line| &line[prefix.len()..]);\n         let first = block.next().unwrap();\n         if !first.starts_with(\"test \") {\n-            continue\n+            continue;\n         }\n         let name = first[\"test \".len()..].to_string();\n         let text: String = itertools::join(block.chain(::std::iter::once(\"\")), \"\\n\");\n@@ -104,7 +102,7 @@ fn existing_tests() -> HashSet<Test> {\n         let file = file.unwrap();\n         let path = file.path();\n         if path.extension().unwrap_or_default() != \"rs\" {\n-            continue\n+            continue;\n         }\n         let name = path.file_name().unwrap().to_str().unwrap();\n         let name = name[\"0000_\".len()..name.len() - 3].to_string();\n@@ -130,5 +128,3 @@ fn base_dir() -> PathBuf {\n     let dir = env!(\"CARGO_MANIFEST_DIR\");\n     PathBuf::from(dir).parent().unwrap().to_owned()\n }\n-\n-"}]}