{"sha": "ef5ef53a6f5cc6d40a45e8041ea9e720b948108b", "node_id": "C_kwDOAAsO6NoAKGVmNWVmNTNhNmY1Y2M2ZDQwYTQ1ZTgwNDFlYTllNzIwYjk0ODEwOGI", "commit": {"author": {"name": "nils", "email": "48135649+Nilstrieb@users.noreply.github.com", "date": "2023-03-28T10:51:14Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-03-28T10:51:14Z"}, "message": "Rollup merge of #109562 - bjorn3:update_ar_archive_writer, r=Mark-Simulacrum\n\nUpdate ar_archive_writer to 0.1.3\n\nThis updates object to 0.30 and fixes a bug where the symbol table would be omitted for archives where there are object files yet none that export any symbol. This bug could lead to linker errors for crates like rustc_std_workspace_core which don't contain any code of their own but exist solely for their dependencies. This is likely the cause of the linker issues I was experiencing on Webassembly. It has been shown to cause issues on other platforms too.\n\ncc rust-lang/ar_archive_writer#5", "tree": {"sha": "0d2ce0e8b1dbad61d4820635f1825fb2248e4406", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0d2ce0e8b1dbad61d4820635f1825fb2248e4406"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ef5ef53a6f5cc6d40a45e8041ea9e720b948108b", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkIsaiCRBK7hj4Ov3rIwAA8rQIAEAPixCHVMeeQREZNyeDq8hh\nLmm0v5Q3vulpItyAlRl4QFbUjuKRCavpNkfaz9BVhADJI7ggtCIxVl1x7PMnao16\n6uTJRtaaqv2NH+k4E/osrB1224nPG5ioGiw+ihmYwXIKylsWeL0fH/ChVctZMF68\n6Hdbu5YKL+75hnKJiuFoeyQc+wiT2m/+lknYKmRYBNzXqmkdonDFqTzgcyg6vEvF\n0gXMyqXepzxmIrNw4nxNBbxUgwT3VERSt9yjHvDFQd00LPPW6pbDvd1u5HiI00YJ\nq+2CZlO/fyeTJ4526snxtatF1Gsw2zr7aKWJB7XyvT/OMfbxzj77OB2KmqNdyT0=\n=PDw2\n-----END PGP SIGNATURE-----\n", "payload": "tree 0d2ce0e8b1dbad61d4820635f1825fb2248e4406\nparent 7e90732abe9da454a7177971c55fa069c8d56e8d\nparent 8b1be44758f6b828cb556ecdc7cddc2dbfe0637f\nauthor nils <48135649+Nilstrieb@users.noreply.github.com> 1680000674 +0200\ncommitter GitHub <noreply@github.com> 1680000674 +0200\n\nRollup merge of #109562 - bjorn3:update_ar_archive_writer, r=Mark-Simulacrum\n\nUpdate ar_archive_writer to 0.1.3\n\nThis updates object to 0.30 and fixes a bug where the symbol table would be omitted for archives where there are object files yet none that export any symbol. This bug could lead to linker errors for crates like rustc_std_workspace_core which don't contain any code of their own but exist solely for their dependencies. This is likely the cause of the linker issues I was experiencing on Webassembly. It has been shown to cause issues on other platforms too.\n\ncc rust-lang/ar_archive_writer#5\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ef5ef53a6f5cc6d40a45e8041ea9e720b948108b", "html_url": "https://github.com/rust-lang/rust/commit/ef5ef53a6f5cc6d40a45e8041ea9e720b948108b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ef5ef53a6f5cc6d40a45e8041ea9e720b948108b/comments", "author": {"login": "Nilstrieb", "id": 48135649, "node_id": "MDQ6VXNlcjQ4MTM1NjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/48135649?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nilstrieb", "html_url": "https://github.com/Nilstrieb", "followers_url": "https://api.github.com/users/Nilstrieb/followers", "following_url": "https://api.github.com/users/Nilstrieb/following{/other_user}", "gists_url": "https://api.github.com/users/Nilstrieb/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nilstrieb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nilstrieb/subscriptions", "organizations_url": "https://api.github.com/users/Nilstrieb/orgs", "repos_url": "https://api.github.com/users/Nilstrieb/repos", "events_url": "https://api.github.com/users/Nilstrieb/events{/privacy}", "received_events_url": "https://api.github.com/users/Nilstrieb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7e90732abe9da454a7177971c55fa069c8d56e8d", "url": "https://api.github.com/repos/rust-lang/rust/commits/7e90732abe9da454a7177971c55fa069c8d56e8d", "html_url": "https://github.com/rust-lang/rust/commit/7e90732abe9da454a7177971c55fa069c8d56e8d"}, {"sha": "8b1be44758f6b828cb556ecdc7cddc2dbfe0637f", "url": "https://api.github.com/repos/rust-lang/rust/commits/8b1be44758f6b828cb556ecdc7cddc2dbfe0637f", "html_url": "https://github.com/rust-lang/rust/commit/8b1be44758f6b828cb556ecdc7cddc2dbfe0637f"}], "stats": {"total": 8, "additions": 4, "deletions": 4}, "files": [{"sha": "f0507c873d52d415289a4607553f08daac81040c", "filename": "Cargo.lock", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/ef5ef53a6f5cc6d40a45e8041ea9e720b948108b/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/ef5ef53a6f5cc6d40a45e8041ea9e720b948108b/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=ef5ef53a6f5cc6d40a45e8041ea9e720b948108b", "patch": "@@ -106,11 +106,11 @@ checksum = \"98161a4e3e2184da77bb14f02184cdd111e83bbbcc9979dfee3c44b9a85f5602\"\n \n [[package]]\n name = \"ar_archive_writer\"\n-version = \"0.1.1\"\n+version = \"0.1.3\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"276881980556fdadeb88aa1ffc667e4d2e8fe72531dfabcb7a82bb3c9ea9ba31\"\n+checksum = \"b0639441fd17a3197d1cbca8dc8768cc172a63b64b4bb6c372e8f41ed0acc9bb\"\n dependencies = [\n- \"object 0.29.0\",\n+ \"object 0.30.1\",\n ]\n \n [[package]]"}, {"sha": "12da21dc47772bef572cc1e0f2ff4c60372dc897", "filename": "compiler/rustc_codegen_llvm/src/back/archive.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ef5ef53a6f5cc6d40a45e8041ea9e720b948108b/compiler%2Frustc_codegen_llvm%2Fsrc%2Fback%2Farchive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ef5ef53a6f5cc6d40a45e8041ea9e720b948108b/compiler%2Frustc_codegen_llvm%2Fsrc%2Fback%2Farchive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_llvm%2Fsrc%2Fback%2Farchive.rs?ref=ef5ef53a6f5cc6d40a45e8041ea9e720b948108b", "patch": "@@ -110,7 +110,7 @@ impl ArchiveBuilderBuilder for LlvmArchiveBuilderBuilder {\n     fn new_archive_builder<'a>(&self, sess: &'a Session) -> Box<dyn ArchiveBuilder<'a> + 'a> {\n         // FIXME use ArArchiveBuilder on most targets again once reading thin archives is\n         // implemented\n-        if true || sess.target.arch == \"wasm32\" || sess.target.arch == \"wasm64\" {\n+        if true {\n             Box::new(LlvmArchiveBuilder { sess, additions: Vec::new() })\n         } else {\n             Box::new(ArArchiveBuilder::new(sess, get_llvm_object_symbols))"}]}