{"sha": "256a6e4fa97b3f4261265c89a29a68c4c5ccb618", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI1NmE2ZTRmYTk3YjNmNDI2MTI2NWM4OWEyOWE2OGM0YzVjY2I2MTg=", "commit": {"author": {"name": "Wesley Wiser", "email": "wwiser@gmail.com", "date": "2018-06-14T02:08:41Z"}, "committer": {"name": "Wesley Wiser", "email": "wwiser@gmail.com", "date": "2018-08-02T22:57:24Z"}, "message": "Include additional data in the json output", "tree": {"sha": "e1e108f9412e000376575cbb4673833ebf29f6d7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e1e108f9412e000376575cbb4673833ebf29f6d7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/256a6e4fa97b3f4261265c89a29a68c4c5ccb618", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/256a6e4fa97b3f4261265c89a29a68c4c5ccb618", "html_url": "https://github.com/rust-lang/rust/commit/256a6e4fa97b3f4261265c89a29a68c4c5ccb618", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/256a6e4fa97b3f4261265c89a29a68c4c5ccb618/comments", "author": {"login": "wesleywiser", "id": 831192, "node_id": "MDQ6VXNlcjgzMTE5Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/831192?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wesleywiser", "html_url": "https://github.com/wesleywiser", "followers_url": "https://api.github.com/users/wesleywiser/followers", "following_url": "https://api.github.com/users/wesleywiser/following{/other_user}", "gists_url": "https://api.github.com/users/wesleywiser/gists{/gist_id}", "starred_url": "https://api.github.com/users/wesleywiser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wesleywiser/subscriptions", "organizations_url": "https://api.github.com/users/wesleywiser/orgs", "repos_url": "https://api.github.com/users/wesleywiser/repos", "events_url": "https://api.github.com/users/wesleywiser/events{/privacy}", "received_events_url": "https://api.github.com/users/wesleywiser/received_events", "type": "User", "site_admin": false}, "committer": {"login": "wesleywiser", "id": 831192, "node_id": "MDQ6VXNlcjgzMTE5Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/831192?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wesleywiser", "html_url": "https://github.com/wesleywiser", "followers_url": "https://api.github.com/users/wesleywiser/followers", "following_url": "https://api.github.com/users/wesleywiser/following{/other_user}", "gists_url": "https://api.github.com/users/wesleywiser/gists{/gist_id}", "starred_url": "https://api.github.com/users/wesleywiser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wesleywiser/subscriptions", "organizations_url": "https://api.github.com/users/wesleywiser/orgs", "repos_url": "https://api.github.com/users/wesleywiser/repos", "events_url": "https://api.github.com/users/wesleywiser/events{/privacy}", "received_events_url": "https://api.github.com/users/wesleywiser/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "579facaba2a11883e24d29c6ac4770942ce3cd50", "url": "https://api.github.com/repos/rust-lang/rust/commits/579facaba2a11883e24d29c6ac4770942ce3cd50", "html_url": "https://github.com/rust-lang/rust/commit/579facaba2a11883e24d29c6ac4770942ce3cd50"}], "stats": {"total": 15, "additions": 12, "deletions": 3}, "files": [{"sha": "0ab482c89a125813b85150cf4a4eb810892f60df", "filename": "src/librustc/session/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/256a6e4fa97b3f4261265c89a29a68c4c5ccb618/src%2Flibrustc%2Fsession%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/256a6e4fa97b3f4261265c89a29a68c4c5ccb618/src%2Flibrustc%2Fsession%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fsession%2Fmod.rs?ref=256a6e4fa97b3f4261265c89a29a68c4c5ccb618", "patch": "@@ -841,7 +841,7 @@ impl Session {\n \n     pub fn save_json_results(&self) {\n         let profiler = self.self_profiling.borrow();\n-        profiler.save_results();\n+        profiler.save_results(&self.opts);\n     }\n \n     pub fn print_perf_stats(&self) {"}, {"sha": "6bdc17a74ba46c3adaec8b2eaf8a118d6b744446", "filename": "src/librustc/util/profiling.rs", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/256a6e4fa97b3f4261265c89a29a68c4c5ccb618/src%2Flibrustc%2Futil%2Fprofiling.rs", "raw_url": "https://github.com/rust-lang/rust/raw/256a6e4fa97b3f4261265c89a29a68c4c5ccb618/src%2Flibrustc%2Futil%2Fprofiling.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Futil%2Fprofiling.rs?ref=256a6e4fa97b3f4261265c89a29a68c4c5ccb618", "patch": "@@ -269,8 +269,17 @@ impl SelfProfiler {\n         writeln!(lock, \"Incremental: {}\", incremental).unwrap();\n     }\n \n-    pub fn save_results(&self) {\n-        fs::write(\"self_profiler_results.json\", self.data.json()).unwrap();\n+    pub fn save_results(&self, opts: &Options) {\n+        let category_data = self.data.json();\n+        let compilation_options = format!(\"{{ \\\"optimization_level\\\": \\\"{:?}\\\", \\\"incremental\\\": {} }}\",\n+                                    opts.optimize,\n+                                    if opts.incremental.is_some() { \"true\" } else { \"false\" });\n+\n+        let json = format!(\"{{ \\\"category_data\\\": {}, \\\"compilation_options\\\": {} }}\",\n+                        category_data,\n+                        compilation_options);\n+\n+        fs::write(\"self_profiler_results.json\", json).unwrap();\n     }\n \n     pub fn record_activity<'a>(&'a mut self, category: ProfileCategory) -> ProfilerActivity<'a> {"}]}