{"sha": "e3961df78d23e353ed48961bd82c27b2c935494c", "node_id": "MDY6Q29tbWl0NzI0NzEyOmUzOTYxZGY3OGQyM2UzNTNlZDQ4OTYxYmQ4MmMyN2IyYzkzNTQ5NGM=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-04-21T22:46:05Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-04-21T22:46:05Z"}, "message": "cargo: Discover crates in subdirectories", "tree": {"sha": "cf65afde97932a131dd53bf97adf2f22b9ba2392", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cf65afde97932a131dd53bf97adf2f22b9ba2392"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e3961df78d23e353ed48961bd82c27b2c935494c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e3961df78d23e353ed48961bd82c27b2c935494c", "html_url": "https://github.com/rust-lang/rust/commit/e3961df78d23e353ed48961bd82c27b2c935494c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e3961df78d23e353ed48961bd82c27b2c935494c/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8688b1b845f3ceede2a62da6a2fc2256e6bcfd2a", "url": "https://api.github.com/repos/rust-lang/rust/commits/8688b1b845f3ceede2a62da6a2fc2256e6bcfd2a", "html_url": "https://github.com/rust-lang/rust/commit/8688b1b845f3ceede2a62da6a2fc2256e6bcfd2a"}], "stats": {"total": 11, "additions": 6, "deletions": 5}, "files": [{"sha": "8f5050c6233c67140f66ed7f3b3cbd19b64f9e8d", "filename": "src/cargo/cargo.rs", "status": "modified", "additions": 6, "deletions": 5, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/e3961df78d23e353ed48961bd82c27b2c935494c/src%2Fcargo%2Fcargo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e3961df78d23e353ed48961bd82c27b2c935494c/src%2Fcargo%2Fcargo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcargo%2Fcargo.rs?ref=e3961df78d23e353ed48961bd82c27b2c935494c", "patch": "@@ -517,12 +517,13 @@ fn rustc_sysroot() -> str {\n fn install_source(c: cargo, path: str) {\n     #debug(\"source: %s\", path);\n     os::change_dir(path);\n-    let contents = os::list_dir_path(\".\");\n \n-    #debug(\"contents: %s\", str::connect(contents, \", \"));\n-\n-    let cratefiles =\n-        vec::filter::<str>(contents, { |n| str::ends_with(n, \".rc\") });\n+    let mut cratefiles = [];\n+    for os::walk_dir(\".\") {|p|\n+        if str::ends_with(p, \".rc\") {\n+            cratefiles += [p];\n+        }\n+    }\n \n     if vec::is_empty(cratefiles) {\n         fail \"This doesn't look like a rust package (no .rc files).\";"}]}