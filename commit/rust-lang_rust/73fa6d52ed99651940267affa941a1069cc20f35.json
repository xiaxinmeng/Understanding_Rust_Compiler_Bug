{"sha": "73fa6d52ed99651940267affa941a1069cc20f35", "node_id": "MDY6Q29tbWl0NzI0NzEyOjczZmE2ZDUyZWQ5OTY1MTk0MDI2N2FmZmE5NDFhMTA2OWNjMjBmMzU=", "commit": {"author": {"name": "David Wood", "email": "david@davidtw.co", "date": "2018-03-22T20:49:05Z"}, "committer": {"name": "David Wood", "email": "david@davidtw.co", "date": "2018-03-22T20:49:05Z"}, "message": "Remove std/test documentation from compiler docs.", "tree": {"sha": "27413c3ee6a6eeb656c3f3777f265dad2367fb95", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/27413c3ee6a6eeb656c3f3777f265dad2367fb95"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/73fa6d52ed99651940267affa941a1069cc20f35", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEWwgxPGhT5b/6kagXAXYLT59T8VQFAlq0FsEACgkQAXYLT59T\n8VSASw/+IN0whi1OzITtUv1Op88goH9cAGFHOkY9mAtkmjxkYLwC7oVy5tAwbb78\nh84ogTcjVOaUKyWyqnezQkpwa2bGUh9tVocgTuoWwnVtOZ4lE4kdeMYzKdVBv0K7\nSl8To3sRJsDcSARNyvAGx4/G6nwUDFuQGtFG5MhzzzSfzRoCoRl+//IxH2QPIglV\ncSVidGEDtHixuMn9FYggMQWPRDqWL/jPK+A8SiB5t/sej3BI//zIiUix8ae7iMbW\nOh2fOjTUPbg9vJ7ZGsytHtUeH1JBpU4UInEgmfdSTNpIjl9HgRngmWd+PU4CTo/p\nKyuZLyrObmeDP6Jg+cO8t9kHvyDosdH12+1PatnLPyYdIlnzjMiI9CdOw/TiWV6i\n1Y5KyXIv8La309SqhW7DGPUdSgdOdgCq4GVHweE2/cNXa45lt1cGcNqGeuXUerCG\nSY3bBEZIczZLNKcGrEgza08QPxL+wEJm1Cbd1yEbqStaSCw4pv5BtzYKITte+Qf3\ndtgOe2mxZ7dzyNIYw/E57Z0iJmoT7KDCbQoOKYGSqm3Hcr86Chgc1bafwtEEn78p\n2I9ySwKP4zSekf4Qz3CkNjGaukaJkEtbBUEf/D3fhcptd7d1Ql+8C2cv1+YMU9T3\ncLMwt2XOV7Fy4IRF3K/UgSxUH/tySUWkBdSgQde0RobZGgt3tH8=\n=9lFg\n-----END PGP SIGNATURE-----", "payload": "tree 27413c3ee6a6eeb656c3f3777f265dad2367fb95\nparent 1b0e9f5af9283b003f5fce6f19ede145c1776684\nauthor David Wood <david@davidtw.co> 1521751745 +0000\ncommitter David Wood <david@davidtw.co> 1521751745 +0000\n\nRemove std/test documentation from compiler docs.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/73fa6d52ed99651940267affa941a1069cc20f35", "html_url": "https://github.com/rust-lang/rust/commit/73fa6d52ed99651940267affa941a1069cc20f35", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/73fa6d52ed99651940267affa941a1069cc20f35/comments", "author": {"login": "davidtwco", "id": 1295100, "node_id": "MDQ6VXNlcjEyOTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1295100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidtwco", "html_url": "https://github.com/davidtwco", "followers_url": "https://api.github.com/users/davidtwco/followers", "following_url": "https://api.github.com/users/davidtwco/following{/other_user}", "gists_url": "https://api.github.com/users/davidtwco/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidtwco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidtwco/subscriptions", "organizations_url": "https://api.github.com/users/davidtwco/orgs", "repos_url": "https://api.github.com/users/davidtwco/repos", "events_url": "https://api.github.com/users/davidtwco/events{/privacy}", "received_events_url": "https://api.github.com/users/davidtwco/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidtwco", "id": 1295100, "node_id": "MDQ6VXNlcjEyOTUxMDA=", "avatar_url": "https://avatars.githubusercontent.com/u/1295100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidtwco", "html_url": "https://github.com/davidtwco", "followers_url": "https://api.github.com/users/davidtwco/followers", "following_url": "https://api.github.com/users/davidtwco/following{/other_user}", "gists_url": "https://api.github.com/users/davidtwco/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidtwco/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidtwco/subscriptions", "organizations_url": "https://api.github.com/users/davidtwco/orgs", "repos_url": "https://api.github.com/users/davidtwco/repos", "events_url": "https://api.github.com/users/davidtwco/events{/privacy}", "received_events_url": "https://api.github.com/users/davidtwco/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1b0e9f5af9283b003f5fce6f19ede145c1776684", "url": "https://api.github.com/repos/rust-lang/rust/commits/1b0e9f5af9283b003f5fce6f19ede145c1776684", "html_url": "https://github.com/rust-lang/rust/commit/1b0e9f5af9283b003f5fce6f19ede145c1776684"}], "stats": {"total": 20, "additions": 6, "deletions": 14}, "files": [{"sha": "5563b153f5affb5b3133078404b3a38a325a6dea", "filename": "src/bootstrap/dist.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/73fa6d52ed99651940267affa941a1069cc20f35/src%2Fbootstrap%2Fdist.rs", "raw_url": "https://github.com/rust-lang/rust/raw/73fa6d52ed99651940267affa941a1069cc20f35/src%2Fbootstrap%2Fdist.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdist.rs?ref=73fa6d52ed99651940267affa941a1069cc20f35", "patch": "@@ -163,7 +163,7 @@ impl Step for RustcDocs {\n         let image = tmpdir(build).join(format!(\"{}-{}-image\", name, host));\n         let _ = fs::remove_dir_all(&image);\n \n-        let dst = image.join(\"share/doc/rustc/html\");\n+        let dst = image.join(\"share/doc/rust/html\");\n         t!(fs::create_dir_all(&dst));\n         let src = build.compiler_doc_out(host);\n         cp_r(&src, &dst);\n@@ -179,7 +179,7 @@ impl Step for RustcDocs {\n            .arg(format!(\"--package-name={}-{}\", name, host))\n            .arg(\"--component-name=rustc-docs\")\n            .arg(\"--legacy-manifest-dirs=rustlib,cargo\")\n-           .arg(\"--bulk-dirs=share/doc/rustc/html\");\n+           .arg(\"--bulk-dirs=share/doc/rust/html\");\n         build.run(&mut cmd);\n         t!(fs::remove_dir_all(&image));\n "}, {"sha": "44073a5b0757237bda2fe96abb1aa873e6432756", "filename": "src/bootstrap/doc.rs", "status": "modified", "additions": 4, "deletions": 12, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/73fa6d52ed99651940267affa941a1069cc20f35/src%2Fbootstrap%2Fdoc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/73fa6d52ed99651940267affa941a1069cc20f35/src%2Fbootstrap%2Fdoc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdoc.rs?ref=73fa6d52ed99651940267affa941a1069cc20f35", "patch": "@@ -690,17 +690,10 @@ impl Step for Rustc {\n         builder.ensure(compile::Rustc { compiler, target });\n         let out_dir = build.stage_out(compiler, Mode::Librustc)\n                            .join(target).join(\"doc\");\n-\n-        // See docs in std above for why we symlink\n-        //\n-        // This step must happen after other documentation steps. This\n-        // invariant ensures that compiler documentation is not included\n-        // in the standard documentation tarballs but that all the\n-        // documentation from the standard documentation tarballs is included\n-        // in the compiler documentation tarball.\n-        let my_out = build.crate_doc_out(target);\n-        build.clear_if_dirty(&my_out, &rustdoc);\n-        t!(symlink_dir_force(&my_out, &out_dir));\n+        // We do not symlink to the same shared folder that already contains std library\n+        // documentation from previous steps as we do not want to include that.\n+        build.clear_if_dirty(&out, &rustdoc);\n+        t!(symlink_dir_force(&out, &out_dir));\n \n         let mut cargo = builder.cargo(compiler, Mode::Librustc, target, \"doc\");\n         compile::rustc_cargo(build, &mut cargo);\n@@ -720,7 +713,6 @@ impl Step for Rustc {\n         }\n \n         build.run(&mut cargo);\n-        cp_r(&my_out, &out);\n     }\n }\n "}]}