{"sha": "2bf5f77696504d86426162364a1e2f9ef8c29f02", "node_id": "C_kwDOAAsO6NoAKDJiZjVmNzc2OTY1MDRkODY0MjYxNjIzNjRhMWUyZjllZjhjMjlmMDI", "commit": {"author": {"name": "Pietro Albini", "email": "pietro.albini@ferrous-systems.com", "date": "2023-04-17T09:00:10Z"}, "committer": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2023-04-21T13:34:27Z"}, "message": "treat the dev channel as nightly in compiletest", "tree": {"sha": "9683caae8d9f5497ee771c9e734c6873c067e543", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9683caae8d9f5497ee771c9e734c6873c067e543"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2bf5f77696504d86426162364a1e2f9ef8c29f02", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE1JbYPtLJAsc22U9xPgar6Auq8ZwFAmRCkOMACgkQPgar6Auq\n8Zz7qw/8CnLTtO8maHvPelBsBKKmA6ygdk+KbnBdjrxFVZST8CdLn9hLNlW0CHoE\nqNiT2T2jIpEktIqYaayNGpJsK/8xuFGf78AIyZnL+vQXKdZxp/OFd7CUe8/oV2OW\nxfz76N4XJUvEHorQe76d/ZvYd1jmLhyA88ihWa3QKSYcWCiV84AP8v/X5rQYN7b/\ny1kzcsDte0h2sTgShgxBC4Af66DG4yBXTFHD/NhG+TSI8rl+YUKXjdWvlLjlZZC9\nIOR6f7RsCVIE+YgQRfK0cGrN9OEoXAQrvQ9XaWWNWDcWEDudynO/t/qnwfDU73rv\nyJjlbfffRt/nAD34WzIEv6SWSLfhHxhPrP2m38fzdM/wCfnBFnoBXEYFF9gNZHwt\nJC/pRk751Ut1dMv+dvpni1gNSoJtrGmSBblMHgKrF3j9np1RELzeBmAxbWrx0faa\n7/CuVD8soGqCeaXFcyaX1LYEC+367NLn2xWRWWJM24DC/KNVuxbLncrV/CMwGVkH\nfZ5bMRNxyfFKsk94gNwSKcf7Psj4OIa+0jaVXwY0CNx1gt03VMEsrmUEqzkM2GCb\nQwGcDQHzd5eN3ytNnW89R0mdtvQ+9bYdZtBY8F1jK0Rci+I/D/IHc0Mng+1qALAk\nvuyJqmBsq9UB9z1IwrUqSx9LthvhPgbarXy1+f6RUAxB8hzJ3Cs=\n=hv4E\n-----END PGP SIGNATURE-----", "payload": "tree 9683caae8d9f5497ee771c9e734c6873c067e543\nparent 1151ea6006020e227c74285b24ab53b7964524e6\nauthor Pietro Albini <pietro.albini@ferrous-systems.com> 1681722010 +0200\ncommitter Pietro Albini <pietro@pietroalbini.org> 1682084067 +0200\n\ntreat the dev channel as nightly in compiletest\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2bf5f77696504d86426162364a1e2f9ef8c29f02", "html_url": "https://github.com/rust-lang/rust/commit/2bf5f77696504d86426162364a1e2f9ef8c29f02", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2bf5f77696504d86426162364a1e2f9ef8c29f02/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1151ea6006020e227c74285b24ab53b7964524e6", "url": "https://api.github.com/repos/rust-lang/rust/commits/1151ea6006020e227c74285b24ab53b7964524e6", "html_url": "https://github.com/rust-lang/rust/commit/1151ea6006020e227c74285b24ab53b7964524e6"}], "stats": {"total": 6, "additions": 5, "deletions": 1}, "files": [{"sha": "86a749b935d828a7eef35fd425be65d08fb070c9", "filename": "src/tools/compiletest/src/header/cfg.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/2bf5f77696504d86426162364a1e2f9ef8c29f02/src%2Ftools%2Fcompiletest%2Fsrc%2Fheader%2Fcfg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2bf5f77696504d86426162364a1e2f9ef8c29f02/src%2Ftools%2Fcompiletest%2Fsrc%2Fheader%2Fcfg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fheader%2Fcfg.rs?ref=2bf5f77696504d86426162364a1e2f9ef8c29f02", "patch": "@@ -165,11 +165,15 @@ pub(super) fn parse_cfg_name_directive<'a>(\n         message: \"when the architecture is part of the Thumb family\"\n     }\n \n+    // Technically the locally built compiler uses the \"dev\" channel rather than the \"nightly\"\n+    // channel, even though most people don't know or won't care about it. To avoid confusion, we\n+    // treat the \"dev\" channel as the \"nightly\" channel when processing the directive.\n     condition! {\n-        name: &config.channel,\n+        name: if config.channel == \"dev\" { \"nightly\" } else { &config.channel },\n         allowed_names: &[\"stable\", \"beta\", \"nightly\"],\n         message: \"when the release channel is {name}\",\n     }\n+\n     condition! {\n         name: \"cross-compile\",\n         condition: config.target != config.host,"}]}