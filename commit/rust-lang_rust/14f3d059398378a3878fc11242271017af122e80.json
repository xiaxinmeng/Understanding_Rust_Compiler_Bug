{"sha": "14f3d059398378a3878fc11242271017af122e80", "node_id": "C_kwDOAAsO6NoAKDE0ZjNkMDU5Mzk4Mzc4YTM4NzhmYzExMjQyMjcxMDE3YWYxMjJlODA", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-03-02T17:05:06Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-03-02T17:05:06Z"}, "message": "Auto merge of #8432 - dtolnay-contrib:transmuteundefinedrepr2, r=Manishearth\n\nTransmute_undefined_repr to nursery again\n\nThis PR reinstates #8418, which was reverted in #8425 (incorrectly I think).\n\nI don't want to start a revert war over this but I feel very strongly that this lint is not in a state that would be a net benefit to users of clippy. In its current form, making this an enabled-by-default `correctness` lint with authoritative-sounding proclamations of undefined behavior does more harm than the benefit of the true positive cases.\n\nI can file a bunch more examples of false positives but I don't want to give the author of this lint the impression that it is ready to graduate from `nursery` as soon as I've exhausted the amount of time I am willing to spend revising this lint.\n\nInstead I would recommend that the author of the lint try running it on some reputable codebases containing transmutes. Everywhere that the lint triggers please consider critically whether it should be triggering. For cases that you think are true positives, please raise a few of them with the crate authors (in a PR or issue) to better understand their perspective if they think the transmute is correct.\n\n---\n\n*Please write a short comment explaining your change (or \"none\" for internal only changes)*\n\nchangelog: Re-remove [`transmute_undefined_repr`] from default set of enabled lints", "tree": {"sha": "6e1bf0e657dc13678b39f9b9610120850b19861f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6e1bf0e657dc13678b39f9b9610120850b19861f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/14f3d059398378a3878fc11242271017af122e80", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/14f3d059398378a3878fc11242271017af122e80", "html_url": "https://github.com/rust-lang/rust/commit/14f3d059398378a3878fc11242271017af122e80", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/14f3d059398378a3878fc11242271017af122e80/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1a25d190e7a33e2955a7cb8c18b80f857f4e048f", "url": "https://api.github.com/repos/rust-lang/rust/commits/1a25d190e7a33e2955a7cb8c18b80f857f4e048f", "html_url": "https://github.com/rust-lang/rust/commit/1a25d190e7a33e2955a7cb8c18b80f857f4e048f"}, {"sha": "fd9dd04972252bc709fc0e477c7b8f6796d3f1e1", "url": "https://api.github.com/repos/rust-lang/rust/commits/fd9dd04972252bc709fc0e477c7b8f6796d3f1e1", "html_url": "https://github.com/rust-lang/rust/commit/fd9dd04972252bc709fc0e477c7b8f6796d3f1e1"}], "stats": {"total": 5, "additions": 2, "deletions": 3}, "files": [{"sha": "abfb46035376a3cd792ed6c3ea9cf67746591848", "filename": "clippy_lints/src/lib.register_all.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/14f3d059398378a3878fc11242271017af122e80/clippy_lints%2Fsrc%2Flib.register_all.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14f3d059398378a3878fc11242271017af122e80/clippy_lints%2Fsrc%2Flib.register_all.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.register_all.rs?ref=14f3d059398378a3878fc11242271017af122e80", "patch": "@@ -281,7 +281,6 @@ store.register_group(true, \"clippy::all\", Some(\"clippy_all\"), vec![\n     LintId::of(transmute::TRANSMUTE_INT_TO_FLOAT),\n     LintId::of(transmute::TRANSMUTE_NUM_TO_BYTES),\n     LintId::of(transmute::TRANSMUTE_PTR_TO_REF),\n-    LintId::of(transmute::TRANSMUTE_UNDEFINED_REPR),\n     LintId::of(transmute::UNSOUND_COLLECTION_TRANSMUTE),\n     LintId::of(transmute::WRONG_TRANSMUTE),\n     LintId::of(transmuting_null::TRANSMUTING_NULL),"}, {"sha": "d7bf91eb69214e813ddf10133ab03f2bcbee0d4d", "filename": "clippy_lints/src/lib.register_correctness.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/14f3d059398378a3878fc11242271017af122e80/clippy_lints%2Fsrc%2Flib.register_correctness.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14f3d059398378a3878fc11242271017af122e80/clippy_lints%2Fsrc%2Flib.register_correctness.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.register_correctness.rs?ref=14f3d059398378a3878fc11242271017af122e80", "patch": "@@ -58,7 +58,6 @@ store.register_group(true, \"clippy::correctness\", Some(\"clippy_correctness\"), ve\n     LintId::of(serde_api::SERDE_API_MISUSE),\n     LintId::of(size_of_in_element_count::SIZE_OF_IN_ELEMENT_COUNT),\n     LintId::of(swap::ALMOST_SWAPPED),\n-    LintId::of(transmute::TRANSMUTE_UNDEFINED_REPR),\n     LintId::of(transmute::UNSOUND_COLLECTION_TRANSMUTE),\n     LintId::of(transmute::WRONG_TRANSMUTE),\n     LintId::of(transmuting_null::TRANSMUTING_NULL),"}, {"sha": "8d4dde42bbecad322b0d3ba28da5e24a8ac8d7f2", "filename": "clippy_lints/src/lib.register_nursery.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/14f3d059398378a3878fc11242271017af122e80/clippy_lints%2Fsrc%2Flib.register_nursery.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14f3d059398378a3878fc11242271017af122e80/clippy_lints%2Fsrc%2Flib.register_nursery.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.register_nursery.rs?ref=14f3d059398378a3878fc11242271017af122e80", "patch": "@@ -26,6 +26,7 @@ store.register_group(true, \"clippy::nursery\", Some(\"clippy_nursery\"), vec![\n     LintId::of(strings::STRING_LIT_AS_BYTES),\n     LintId::of(suspicious_operation_groupings::SUSPICIOUS_OPERATION_GROUPINGS),\n     LintId::of(trailing_empty_array::TRAILING_EMPTY_ARRAY),\n+    LintId::of(transmute::TRANSMUTE_UNDEFINED_REPR),\n     LintId::of(transmute::USELESS_TRANSMUTE),\n     LintId::of(use_self::USE_SELF),\n ])"}, {"sha": "1da3b765904813d4407d31d622b6a36049392d6e", "filename": "clippy_lints/src/transmute/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/14f3d059398378a3878fc11242271017af122e80/clippy_lints%2Fsrc%2Ftransmute%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14f3d059398378a3878fc11242271017af122e80/clippy_lints%2Fsrc%2Ftransmute%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Ftransmute%2Fmod.rs?ref=14f3d059398378a3878fc11242271017af122e80", "patch": "@@ -377,7 +377,7 @@ declare_clippy_lint! {\n     /// ```\n     #[clippy::version = \"1.60.0\"]\n     pub TRANSMUTE_UNDEFINED_REPR,\n-    correctness,\n+    nursery,\n     \"transmute to or from a type with an undefined representation\"\n }\n "}]}