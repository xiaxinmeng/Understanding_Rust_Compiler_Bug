{"sha": "c30341ddec0b99bb3bd8bb5fd8c8451778c78330", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMzMDM0MWRkZWMwYjk5YmIzYmQ4YmI1ZmQ4Yzg0NTE3NzhjNzgzMzA=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-08-25T05:24:30Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-08-25T05:24:30Z"}, "message": "Auto merge of #75132 - scottmcm:stabilize-range-is-empty, r=dtolnay\n\nStabilize Range[Inclusive]::is_empty\n\nI would like to propose these two simple methods for stabilization:\n- Knowing that a range is exhausted isn't otherwise trivial\n- Clippy would like to suggest them, but had to do extra work to disable that path <https://github.com/rust-lang/rust-clippy/issues/3807> because they're unstable\n- These work on `PartialOrd`, consistently with the stable `contains` method, and are thus more general than iterator-based approaches that need `Step`\n- They've been unchanged for some time, and have picked up uses in the compiler\n- Stabilizing them doesn't block any future iterator-based `is_empty` plans, as these inherent ones are preferred in name resolution\n\nhttps://doc.rust-lang.org/nightly/std/ops/struct.Range.html#method.is_empty\nhttps://doc.rust-lang.org/nightly/std/ops/struct.RangeInclusive.html#method.is_empty\n\nCloses #48111", "tree": {"sha": "a7482a95b884e75d2a2bd66e4d2c40223a552e05", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a7482a95b884e75d2a2bd66e4d2c40223a552e05"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c30341ddec0b99bb3bd8bb5fd8c8451778c78330", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c30341ddec0b99bb3bd8bb5fd8c8451778c78330", "html_url": "https://github.com/rust-lang/rust/commit/c30341ddec0b99bb3bd8bb5fd8c8451778c78330", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ee541284bf5008bb0425fae02412352025099707", "url": "https://api.github.com/repos/rust-lang/rust/commits/ee541284bf5008bb0425fae02412352025099707", "html_url": "https://github.com/rust-lang/rust/commit/ee541284bf5008bb0425fae02412352025099707"}, {"sha": "d6185f931435a161525f41d270207e33faa26ea2", "url": "https://api.github.com/repos/rust-lang/rust/commits/d6185f931435a161525f41d270207e33faa26ea2", "html_url": "https://github.com/rust-lang/rust/commit/d6185f931435a161525f41d270207e33faa26ea2"}], "stats": {"total": 23, "additions": 5, "deletions": 18}, "files": [{"sha": "d10829832dd169f3779b74528b5be99fcee3fb32", "filename": "library/core/src/ops/range.rs", "status": "modified", "additions": 2, "deletions": 12, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/library%2Fcore%2Fsrc%2Fops%2Frange.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/library%2Fcore%2Fsrc%2Fops%2Frange.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fops%2Frange.rs?ref=c30341ddec0b99bb3bd8bb5fd8c8451778c78330", "patch": "@@ -125,8 +125,6 @@ impl<Idx: PartialOrd<Idx>> Range<Idx> {\n     /// # Examples\n     ///\n     /// ```\n-    /// #![feature(range_is_empty)]\n-    ///\n     /// assert!(!(3..5).is_empty());\n     /// assert!( (3..3).is_empty());\n     /// assert!( (3..2).is_empty());\n@@ -135,13 +133,11 @@ impl<Idx: PartialOrd<Idx>> Range<Idx> {\n     /// The range is empty if either side is incomparable:\n     ///\n     /// ```\n-    /// #![feature(range_is_empty)]\n-    ///\n     /// assert!(!(3.0..5.0).is_empty());\n     /// assert!( (3.0..f32::NAN).is_empty());\n     /// assert!( (f32::NAN..5.0).is_empty());\n     /// ```\n-    #[unstable(feature = \"range_is_empty\", reason = \"recently added\", issue = \"48111\")]\n+    #[stable(feature = \"range_is_empty\", since = \"1.47.0\")]\n     pub fn is_empty(&self) -> bool {\n         !(self.start < self.end)\n     }\n@@ -481,8 +477,6 @@ impl<Idx: PartialOrd<Idx>> RangeInclusive<Idx> {\n     /// # Examples\n     ///\n     /// ```\n-    /// #![feature(range_is_empty)]\n-    ///\n     /// assert!(!(3..=5).is_empty());\n     /// assert!(!(3..=3).is_empty());\n     /// assert!( (3..=2).is_empty());\n@@ -491,8 +485,6 @@ impl<Idx: PartialOrd<Idx>> RangeInclusive<Idx> {\n     /// The range is empty if either side is incomparable:\n     ///\n     /// ```\n-    /// #![feature(range_is_empty)]\n-    ///\n     /// assert!(!(3.0..=5.0).is_empty());\n     /// assert!( (3.0..=f32::NAN).is_empty());\n     /// assert!( (f32::NAN..=5.0).is_empty());\n@@ -501,14 +493,12 @@ impl<Idx: PartialOrd<Idx>> RangeInclusive<Idx> {\n     /// This method returns `true` after iteration has finished:\n     ///\n     /// ```\n-    /// #![feature(range_is_empty)]\n-    ///\n     /// let mut r = 3..=5;\n     /// for _ in r.by_ref() {}\n     /// // Precise field values are unspecified here\n     /// assert!(r.is_empty());\n     /// ```\n-    #[unstable(feature = \"range_is_empty\", reason = \"recently added\", issue = \"48111\")]\n+    #[stable(feature = \"range_is_empty\", since = \"1.47.0\")]\n     #[inline]\n     pub fn is_empty(&self) -> bool {\n         self.exhausted || !(self.start <= self.end)"}, {"sha": "81e621318e14184b3903e7ea6011338ae4a2a4e9", "filename": "library/core/tests/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/library%2Fcore%2Ftests%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/library%2Fcore%2Ftests%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Ftests%2Flib.rs?ref=c30341ddec0b99bb3bd8bb5fd8c8451778c78330", "patch": "@@ -17,7 +17,6 @@\n #![feature(try_find)]\n #![feature(is_sorted)]\n #![feature(pattern)]\n-#![feature(range_is_empty)]\n #![feature(raw)]\n #![feature(sort_internals)]\n #![feature(slice_partition_at_index)]"}, {"sha": "e05041d88460e3cf40fbd010f42f295fd8a12ec6", "filename": "src/librustc_infer/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/src%2Flibrustc_infer%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/src%2Flibrustc_infer%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_infer%2Flib.rs?ref=c30341ddec0b99bb3bd8bb5fd8c8451778c78330", "patch": "@@ -22,7 +22,6 @@\n #![feature(extend_one)]\n #![feature(never_type)]\n #![feature(or_patterns)]\n-#![feature(range_is_empty)]\n #![feature(in_band_lifetimes)]\n #![feature(crate_visibility_modifier)]\n #![recursion_limit = \"512\"] // For rustdoc"}, {"sha": "1b2dea8a378c33df1bfb1017ce063ba54ee441e3", "filename": "src/librustc_middle/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/src%2Flibrustc_middle%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/src%2Flibrustc_middle%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_middle%2Flib.rs?ref=c30341ddec0b99bb3bd8bb5fd8c8451778c78330", "patch": "@@ -40,7 +40,6 @@\n #![feature(nll)]\n #![feature(option_expect_none)]\n #![feature(or_patterns)]\n-#![feature(range_is_empty)]\n #![feature(min_specialization)]\n #![feature(trusted_len)]\n #![feature(stmt_expr_attributes)]"}, {"sha": "2e3b508463540ca5472f407c14abe41394705572", "filename": "src/librustc_mir/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/src%2Flibrustc_mir%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/src%2Flibrustc_mir%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Flib.rs?ref=c30341ddec0b99bb3bd8bb5fd8c8451778c78330", "patch": "@@ -22,7 +22,6 @@ Rust MIR: a lowered representation of Rust.\n #![feature(try_blocks)]\n #![feature(associated_type_bounds)]\n #![feature(associated_type_defaults)]\n-#![feature(range_is_empty)]\n #![feature(stmt_expr_attributes)]\n #![feature(trait_alias)]\n #![feature(option_expect_none)]"}, {"sha": "7e7a15924b7653128c9c5a2db10d6d7e28fd88f9", "filename": "src/test/ui/range_inclusive.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/src%2Ftest%2Fui%2Frange_inclusive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/src%2Ftest%2Fui%2Frange_inclusive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frange_inclusive.rs?ref=c30341ddec0b99bb3bd8bb5fd8c8451778c78330", "patch": "@@ -1,6 +1,5 @@\n // run-pass\n // Test inclusive range syntax.\n-#![feature(range_is_empty)]\n #![allow(unused_braces)]\n #![allow(unused_comparisons)]\n "}, {"sha": "eee3db9b7d4b04d168958c79ea4fcef45bf30e03", "filename": "src/tools/clippy/tests/ui/len_zero_ranges.fixed", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/src%2Ftools%2Fclippy%2Ftests%2Fui%2Flen_zero_ranges.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/src%2Ftools%2Fclippy%2Ftests%2Fui%2Flen_zero_ranges.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Ftests%2Fui%2Flen_zero_ranges.fixed?ref=c30341ddec0b99bb3bd8bb5fd8c8451778c78330", "patch": "@@ -3,6 +3,7 @@\n #![feature(range_is_empty)]\n #![warn(clippy::len_zero)]\n #![allow(unused)]\n+#![allow(stable_features)] // TODO: https://github.com/rust-lang/rust-clippy/issues/5956\n \n mod issue_3807 {\n     // With the feature enabled, `is_empty` should be suggested"}, {"sha": "be2e0f38fd164cbef647318ba40846f0b915acff", "filename": "src/tools/clippy/tests/ui/len_zero_ranges.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/src%2Ftools%2Fclippy%2Ftests%2Fui%2Flen_zero_ranges.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/src%2Ftools%2Fclippy%2Ftests%2Fui%2Flen_zero_ranges.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Ftests%2Fui%2Flen_zero_ranges.rs?ref=c30341ddec0b99bb3bd8bb5fd8c8451778c78330", "patch": "@@ -3,6 +3,7 @@\n #![feature(range_is_empty)]\n #![warn(clippy::len_zero)]\n #![allow(unused)]\n+#![allow(stable_features)] // TODO: https://github.com/rust-lang/rust-clippy/issues/5956\n \n mod issue_3807 {\n     // With the feature enabled, `is_empty` should be suggested"}, {"sha": "acb85f7100a39bbf76d9829949864931e17973d8", "filename": "src/tools/clippy/tests/ui/len_zero_ranges.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/src%2Ftools%2Fclippy%2Ftests%2Fui%2Flen_zero_ranges.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c30341ddec0b99bb3bd8bb5fd8c8451778c78330/src%2Ftools%2Fclippy%2Ftests%2Fui%2Flen_zero_ranges.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Ftests%2Fui%2Flen_zero_ranges.stderr?ref=c30341ddec0b99bb3bd8bb5fd8c8451778c78330", "patch": "@@ -1,5 +1,5 @@\n error: length comparison to zero\n-  --> $DIR/len_zero_ranges.rs:10:17\n+  --> $DIR/len_zero_ranges.rs:11:17\n    |\n LL |         let _ = (0..42).len() == 0;\n    |                 ^^^^^^^^^^^^^^^^^^ help: using `is_empty` is clearer and more explicit: `(0..42).is_empty()`"}]}