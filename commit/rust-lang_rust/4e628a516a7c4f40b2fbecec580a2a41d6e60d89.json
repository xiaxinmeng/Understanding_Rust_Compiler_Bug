{"sha": "4e628a516a7c4f40b2fbecec580a2a41d6e60d89", "node_id": "C_kwDOAAsO6NoAKDRlNjI4YTUxNmE3YzRmNDBiMmZiZWNlYzU4MGEyYTQxZDZlNjBkODk", "commit": {"author": {"name": "klensy", "email": "klensy@users.noreply.github.com", "date": "2023-06-12T19:00:08Z"}, "committer": {"name": "klensy", "email": "klensy@users.noreply.github.com", "date": "2023-06-12T19:00:08Z"}, "message": "add more info to error when calling npm", "tree": {"sha": "bbd917e325ef71bba3f8c3d26bb48dd6e0a34b26", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bbd917e325ef71bba3f8c3d26bb48dd6e0a34b26"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4e628a516a7c4f40b2fbecec580a2a41d6e60d89", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4e628a516a7c4f40b2fbecec580a2a41d6e60d89", "html_url": "https://github.com/rust-lang/rust/commit/4e628a516a7c4f40b2fbecec580a2a41d6e60d89", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4e628a516a7c4f40b2fbecec580a2a41d6e60d89/comments", "author": {"login": "klensy", "id": 1782831, "node_id": "MDQ6VXNlcjE3ODI4MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1782831?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klensy", "html_url": "https://github.com/klensy", "followers_url": "https://api.github.com/users/klensy/followers", "following_url": "https://api.github.com/users/klensy/following{/other_user}", "gists_url": "https://api.github.com/users/klensy/gists{/gist_id}", "starred_url": "https://api.github.com/users/klensy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klensy/subscriptions", "organizations_url": "https://api.github.com/users/klensy/orgs", "repos_url": "https://api.github.com/users/klensy/repos", "events_url": "https://api.github.com/users/klensy/events{/privacy}", "received_events_url": "https://api.github.com/users/klensy/received_events", "type": "User", "site_admin": false}, "committer": {"login": "klensy", "id": 1782831, "node_id": "MDQ6VXNlcjE3ODI4MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1782831?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klensy", "html_url": "https://github.com/klensy", "followers_url": "https://api.github.com/users/klensy/followers", "following_url": "https://api.github.com/users/klensy/following{/other_user}", "gists_url": "https://api.github.com/users/klensy/gists{/gist_id}", "starred_url": "https://api.github.com/users/klensy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klensy/subscriptions", "organizations_url": "https://api.github.com/users/klensy/orgs", "repos_url": "https://api.github.com/users/klensy/repos", "events_url": "https://api.github.com/users/klensy/events{/privacy}", "received_events_url": "https://api.github.com/users/klensy/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "af36fbfc336f176a43a42addfaa12d48163b7e12", "url": "https://api.github.com/repos/rust-lang/rust/commits/af36fbfc336f176a43a42addfaa12d48163b7e12", "html_url": "https://github.com/rust-lang/rust/commit/af36fbfc336f176a43a42addfaa12d48163b7e12"}], "stats": {"total": 14, "additions": 10, "deletions": 4}, "files": [{"sha": "dc902f8cb024262a98f0ef51b4a157fed0aa0ba8", "filename": "src/tools/rustdoc-gui-test/src/main.rs", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/4e628a516a7c4f40b2fbecec580a2a41d6e60d89/src%2Ftools%2Frustdoc-gui-test%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4e628a516a7c4f40b2fbecec580a2a41d6e60d89/src%2Ftools%2Frustdoc-gui-test%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustdoc-gui-test%2Fsrc%2Fmain.rs?ref=4e628a516a7c4f40b2fbecec580a2a41d6e60d89", "patch": "@@ -14,10 +14,16 @@ fn get_browser_ui_test_version_inner(npm: &Path, global: bool) -> Option<String>\n     if global {\n         command.arg(\"--global\");\n     }\n-    let lines = command\n-        .output()\n-        .map(|output| String::from_utf8_lossy(&output.stdout).into_owned())\n-        .unwrap_or(String::new());\n+    let lines = match command.output() {\n+        Ok(output) => String::from_utf8_lossy(&output.stdout).into_owned(),\n+        Err(e) => {\n+            eprintln!(\n+                \"path to npm can be wrong, provided path: {npm:?}. Try to set npm path \\\n+            in config.toml in [build.npm]\",\n+            );\n+            panic!(\"{:?}\", e)\n+        }\n+    };\n     lines\n         .lines()\n         .find_map(|l| l.rsplit(':').next()?.strip_prefix(\"browser-ui-test@\"))"}]}