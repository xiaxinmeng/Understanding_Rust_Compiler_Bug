{"sha": "67b4f8a40ca43998da5f3120613f352392b67ff7", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY3YjRmOGE0MGNhNDM5OThkYTVmMzEyMDYxM2YzNTIzOTJiNjdmZjc=", "commit": {"author": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2017-06-17T04:55:43Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2017-06-17T04:55:43Z"}, "message": "Merge pull request #1698 from topecongiro/vec-semi\n\nUse correct indentaion for vec! with semicolon", "tree": {"sha": "5254acb44873a4f970fb005dd5f3d5b0c72a18b9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5254acb44873a4f970fb005dd5f3d5b0c72a18b9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/67b4f8a40ca43998da5f3120613f352392b67ff7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/67b4f8a40ca43998da5f3120613f352392b67ff7", "html_url": "https://github.com/rust-lang/rust/commit/67b4f8a40ca43998da5f3120613f352392b67ff7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/67b4f8a40ca43998da5f3120613f352392b67ff7/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "05559fc8a4da2f3986d5716df8ddb9729bcbb5cc", "url": "https://api.github.com/repos/rust-lang/rust/commits/05559fc8a4da2f3986d5716df8ddb9729bcbb5cc", "html_url": "https://github.com/rust-lang/rust/commit/05559fc8a4da2f3986d5716df8ddb9729bcbb5cc"}, {"sha": "4a5871eccc5994366b76627c8f240167e7b12cd6", "url": "https://api.github.com/repos/rust-lang/rust/commits/4a5871eccc5994366b76627c8f240167e7b12cd6", "html_url": "https://github.com/rust-lang/rust/commit/4a5871eccc5994366b76627c8f240167e7b12cd6"}], "stats": {"total": 30, "additions": 21, "deletions": 9}, "files": [{"sha": "1b17ced8a42e195a3a6f6da5aa6b7a282f7395e4", "filename": "src/expr.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/67b4f8a40ca43998da5f3120613f352392b67ff7/src%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/67b4f8a40ca43998da5f3120613f352392b67ff7/src%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fexpr.rs?ref=67b4f8a40ca43998da5f3120613f352392b67ff7", "patch": "@@ -157,9 +157,8 @@ fn format_expr(\n         ast::ExprKind::Loop(..) |\n         ast::ExprKind::While(..) |\n         ast::ExprKind::WhileLet(..) => {\n-            to_control_flow(expr, expr_type).and_then(|control_flow| {\n-                control_flow.rewrite(context, shape)\n-            })\n+            to_control_flow(expr, expr_type)\n+                .and_then(|control_flow| control_flow.rewrite(context, shape))\n         }\n         ast::ExprKind::Block(ref block) => block.rewrite(context, shape),\n         ast::ExprKind::Match(ref cond, ref arms) => {"}, {"sha": "88bfb96c5d6a806d9b816bcf5ac72e15e689774b", "filename": "src/macros.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/67b4f8a40ca43998da5f3120613f352392b67ff7/src%2Fmacros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/67b4f8a40ca43998da5f3120613f352392b67ff7/src%2Fmacros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmacros.rs?ref=67b4f8a40ca43998da5f3120613f352392b67ff7", "patch": "@@ -184,7 +184,7 @@ pub fn rewrite_macro(\n             )\n         }\n         MacroStyle::Brackets => {\n-            let mac_shape = try_opt!(shape.shrink_left(macro_name.len()));\n+            let mac_shape = try_opt!(shape.offset_left(macro_name.len()));\n             // Handle special case: `vec![expr; expr]`\n             if vec_with_semi {\n                 let (lbr, rbr) = if context.config.spaces_within_square_brackets() {\n@@ -194,21 +194,21 @@ pub fn rewrite_macro(\n                 };\n                 // 6 = `vec!` + `; `\n                 let total_overhead = lbr.len() + rbr.len() + 6;\n-                let lhs = try_opt!(expr_vec[0].rewrite(context, mac_shape));\n-                let rhs = try_opt!(expr_vec[1].rewrite(context, mac_shape));\n+                let nested_shape = mac_shape.block_indent(context.config.tab_spaces());\n+                let lhs = try_opt!(expr_vec[0].rewrite(context, nested_shape));\n+                let rhs = try_opt!(expr_vec[1].rewrite(context, nested_shape));\n                 if !lhs.contains('\\n') && !rhs.contains('\\n') &&\n                     lhs.len() + rhs.len() + total_overhead <= shape.width\n                 {\n                     Some(format!(\"{}{}{}; {}{}\", macro_name, lbr, lhs, rhs, rbr))\n                 } else {\n-                    let nested_indent = shape.indent.block_indent(context.config);\n                     Some(format!(\n                         \"{}{}\\n{}{};\\n{}{}\\n{}{}\",\n                         macro_name,\n                         lbr,\n-                        nested_indent.to_string(context.config),\n+                        nested_shape.indent.to_string(context.config),\n                         lhs,\n-                        nested_indent.to_string(context.config),\n+                        nested_shape.indent.to_string(context.config),\n                         rhs,\n                         shape.indent.to_string(context.config),\n                         rbr"}, {"sha": "0622ce5023510e084370ef03f3d934e9246230c3", "filename": "tests/source/issue-1693.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/67b4f8a40ca43998da5f3120613f352392b67ff7/tests%2Fsource%2Fissue-1693.rs", "raw_url": "https://github.com/rust-lang/rust/raw/67b4f8a40ca43998da5f3120613f352392b67ff7/tests%2Fsource%2Fissue-1693.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fissue-1693.rs?ref=67b4f8a40ca43998da5f3120613f352392b67ff7", "patch": "@@ -0,0 +1,3 @@\n+fn issue1693() {\n+    let pixel_data = vec![(f16::from_f32(0.82), f16::from_f32(1.78), f16::from_f32(0.21)); 256 * 256];\n+}"}, {"sha": "85421a123bb5c65aca4fe3b07c54a3d965779f5e", "filename": "tests/target/issue-1693.rs", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/67b4f8a40ca43998da5f3120613f352392b67ff7/tests%2Ftarget%2Fissue-1693.rs", "raw_url": "https://github.com/rust-lang/rust/raw/67b4f8a40ca43998da5f3120613f352392b67ff7/tests%2Ftarget%2Fissue-1693.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fissue-1693.rs?ref=67b4f8a40ca43998da5f3120613f352392b67ff7", "patch": "@@ -0,0 +1,10 @@\n+fn issue1693() {\n+    let pixel_data = vec![\n+        (\n+            f16::from_f32(0.82),\n+            f16::from_f32(1.78),\n+            f16::from_f32(0.21)\n+        );\n+        256 * 256\n+    ];\n+}"}]}