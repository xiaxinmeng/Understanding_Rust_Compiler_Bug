{"sha": "952380904b8e925851d96b55a959232ef360aede", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk1MjM4MDkwNGI4ZTkyNTg1MWQ5NmI1NWE5NTkyMzJlZjM2MGFlZGU=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2014-03-09T21:56:37Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2014-03-09T21:56:37Z"}, "message": "install.sh: untabify", "tree": {"sha": "a53cb454191a551d7413b5ebce03ce7c2e9fa0ac", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a53cb454191a551d7413b5ebce03ce7c2e9fa0ac"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/952380904b8e925851d96b55a959232ef360aede", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/952380904b8e925851d96b55a959232ef360aede", "html_url": "https://github.com/rust-lang/rust/commit/952380904b8e925851d96b55a959232ef360aede", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/952380904b8e925851d96b55a959232ef360aede/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1f7de380ce85aed2917c5bf801c68170403559e8", "url": "https://api.github.com/repos/rust-lang/rust/commits/1f7de380ce85aed2917c5bf801c68170403559e8", "html_url": "https://github.com/rust-lang/rust/commit/1f7de380ce85aed2917c5bf801c68170403559e8"}], "stats": {"total": 40, "additions": 20, "deletions": 20}, "files": [{"sha": "9e718a61d88951bf75e6b1ad07f07dfcaf1a5596", "filename": "src/etc/install.sh", "status": "modified", "additions": 20, "deletions": 20, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/952380904b8e925851d96b55a959232ef360aede/src%2Fetc%2Finstall.sh", "raw_url": "https://github.com/rust-lang/rust/raw/952380904b8e925851d96b55a959232ef360aede/src%2Fetc%2Finstall.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Finstall.sh?ref=952380904b8e925851d96b55a959232ef360aede", "patch": "@@ -240,38 +240,38 @@ need_ok \"can't run these binaries on this platform\"\n # FIXME: Hardcoded 'rustlib' ignores CFG_RUSTLIBDIR\n if [ -f \"${CFG_PREFIX}/lib/rustlib/manifest\" ]\n then\n-\twhile read p; do\n-\t\tmsg \"uninstall ${CFG_PREFIX}/$p\"\n-\t\trm \"${CFG_PREFIX}/$p\"\n-\t\tneed_ok \"failed to remove file\"\n-\tdone < \"${CFG_PREFIX}/lib/rustlib/manifest\"\n+    while read p; do\n+        msg \"uninstall ${CFG_PREFIX}/$p\"\n+        rm \"${CFG_PREFIX}/$p\"\n+        need_ok \"failed to remove file\"\n+    done < \"${CFG_PREFIX}/lib/rustlib/manifest\"\n \n     # Remove 'rustlib' directory\n-\tmsg \"uninstall ${CFG_PREFIX}/lib/rustlib\"\n-\trm -r \"${CFG_PREFIX}/lib/rustlib\"\n-\tneed_ok \"failed to remove rustlib\"\n+    msg \"uninstall ${CFG_PREFIX}/lib/rustlib\"\n+    rm -r \"${CFG_PREFIX}/lib/rustlib\"\n+    need_ok \"failed to remove rustlib\"\n fi\n \n # If we're only uninstalling then exit\n if [ -n \"${CFG_UNINSTALL}\" ]\n then\n-\texit 0\n+    exit 0\n fi\n \n # Iterate through the new manifest and install files\n while read p; do\n \n-\tumask 022 && mkdir -p \"${CFG_PREFIX}/$(dirname $p)\"\n-\tneed_ok \"directory creation failed\"\n-\n-\tmsg \"${CFG_PREFIX}/$p\"\n-\tif echo \"$p\" | grep \"/bin/\" > /dev/null\n-\tthen\n-\t\tinstall -m755 \"${CFG_SRC_DIR}/$p\" \"${CFG_PREFIX}/$p\"\n-\telse\n-\t\tinstall -m644 \"${CFG_SRC_DIR}/$p\" \"${CFG_PREFIX}/$p\"\n-\tfi\n-\tneed_ok \"file creation failed\"\n+    umask 022 && mkdir -p \"${CFG_PREFIX}/$(dirname $p)\"\n+    need_ok \"directory creation failed\"\n+\n+    msg \"${CFG_PREFIX}/$p\"\n+    if echo \"$p\" | grep \"/bin/\" > /dev/null\n+    then\n+        install -m755 \"${CFG_SRC_DIR}/$p\" \"${CFG_PREFIX}/$p\"\n+    else\n+        install -m644 \"${CFG_SRC_DIR}/$p\" \"${CFG_PREFIX}/$p\"\n+    fi\n+    need_ok \"file creation failed\"\n \n # The manifest lists all files to install\n done < \"${CFG_SRC_DIR}/lib/rustlib/manifest\""}]}