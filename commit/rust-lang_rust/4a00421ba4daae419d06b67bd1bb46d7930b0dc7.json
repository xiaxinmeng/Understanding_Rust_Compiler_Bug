{"sha": "4a00421ba4daae419d06b67bd1bb46d7930b0dc7", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRhMDA0MjFiYTRkYWFlNDE5ZDA2YjY3YmQxYmI0NmQ3OTMwYjBkYzc=", "commit": {"author": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2020-08-20T00:00:00Z"}, "committer": {"name": "Tomasz Mi\u0105sko", "email": "tomasz.miasko@gmail.com", "date": "2020-08-21T11:17:20Z"}, "message": "Make raw standard stream constructors const", "tree": {"sha": "d047e2c2fce8a6171532a1671e1363227bbd4eed", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d047e2c2fce8a6171532a1671e1363227bbd4eed"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4a00421ba4daae419d06b67bd1bb46d7930b0dc7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4a00421ba4daae419d06b67bd1bb46d7930b0dc7", "html_url": "https://github.com/rust-lang/rust/commit/4a00421ba4daae419d06b67bd1bb46d7930b0dc7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/comments", "author": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tmiasko", "id": 51362316, "node_id": "MDQ6VXNlcjUxMzYyMzE2", "avatar_url": "https://avatars.githubusercontent.com/u/51362316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmiasko", "html_url": "https://github.com/tmiasko", "followers_url": "https://api.github.com/users/tmiasko/followers", "following_url": "https://api.github.com/users/tmiasko/following{/other_user}", "gists_url": "https://api.github.com/users/tmiasko/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmiasko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmiasko/subscriptions", "organizations_url": "https://api.github.com/users/tmiasko/orgs", "repos_url": "https://api.github.com/users/tmiasko/repos", "events_url": "https://api.github.com/users/tmiasko/events{/privacy}", "received_events_url": "https://api.github.com/users/tmiasko/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "479c23bb493e4ea801c125cfc54e70723a9aeeb5", "url": "https://api.github.com/repos/rust-lang/rust/commits/479c23bb493e4ea801c125cfc54e70723a9aeeb5", "html_url": "https://github.com/rust-lang/rust/commit/479c23bb493e4ea801c125cfc54e70723a9aeeb5"}], "stats": {"total": 63, "additions": 33, "deletions": 30}, "files": [{"sha": "c68d5980800873c2735c8d1c6405fb5acd8e5279", "filename": "library/std/src/io/stdio.rs", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fio%2Fstdio.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fio%2Fstdio.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fio%2Fstdio.rs?ref=4a00421ba4daae419d06b67bd1bb46d7930b0dc7", "patch": "@@ -50,7 +50,8 @@ struct StderrRaw(stdio::Stderr);\n /// handles is **not** available to raw handles returned from this function.\n ///\n /// The returned handle has no external synchronization or buffering.\n-fn stdin_raw() -> StdinRaw {\n+#[unstable(feature = \"libstd_sys_internals\", issue = \"none\")]\n+const fn stdin_raw() -> StdinRaw {\n     StdinRaw(stdio::Stdin::new())\n }\n \n@@ -63,7 +64,8 @@ fn stdin_raw() -> StdinRaw {\n ///\n /// The returned handle has no external synchronization or buffering layered on\n /// top.\n-fn stdout_raw() -> StdoutRaw {\n+#[unstable(feature = \"libstd_sys_internals\", issue = \"none\")]\n+const fn stdout_raw() -> StdoutRaw {\n     StdoutRaw(stdio::Stdout::new())\n }\n \n@@ -74,7 +76,8 @@ fn stdout_raw() -> StdoutRaw {\n ///\n /// The returned handle has no external synchronization or buffering layered on\n /// top.\n-fn stderr_raw() -> StderrRaw {\n+#[unstable(feature = \"libstd_sys_internals\", issue = \"none\")]\n+const fn stderr_raw() -> StderrRaw {\n     StderrRaw(stdio::Stderr::new())\n }\n "}, {"sha": "7fec4731a462c6b89cb580e43de7e33a2624bf67", "filename": "library/std/src/sys/cloudabi/stdio.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Fcloudabi%2Fstdio.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Fcloudabi%2Fstdio.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fcloudabi%2Fstdio.rs?ref=4a00421ba4daae419d06b67bd1bb46d7930b0dc7", "patch": "@@ -6,7 +6,7 @@ pub struct Stdout(());\n pub struct Stderr(());\n \n impl Stdin {\n-    pub fn new() -> Stdin {\n+    pub const fn new() -> Stdin {\n         Stdin(())\n     }\n }\n@@ -18,7 +18,7 @@ impl io::Read for Stdin {\n }\n \n impl Stdout {\n-    pub fn new() -> Stdout {\n+    pub const fn new() -> Stdout {\n         Stdout(())\n     }\n }\n@@ -37,7 +37,7 @@ impl io::Write for Stdout {\n }\n \n impl Stderr {\n-    pub fn new() -> Stderr {\n+    pub const fn new() -> Stderr {\n         Stderr(())\n     }\n }"}, {"sha": "82304dd6dc2931112c1dedb7913204445f52d0cb", "filename": "library/std/src/sys/hermit/stdio.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Fhermit%2Fstdio.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Fhermit%2Fstdio.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fhermit%2Fstdio.rs?ref=4a00421ba4daae419d06b67bd1bb46d7930b0dc7", "patch": "@@ -7,7 +7,7 @@ pub struct Stdout;\n pub struct Stderr;\n \n impl Stdin {\n-    pub fn new() -> Stdin {\n+    pub const fn new() -> Stdin {\n         Stdin\n     }\n }\n@@ -28,7 +28,7 @@ impl io::Read for Stdin {\n }\n \n impl Stdout {\n-    pub fn new() -> Stdout {\n+    pub const fn new() -> Stdout {\n         Stdout\n     }\n }\n@@ -69,7 +69,7 @@ impl io::Write for Stdout {\n }\n \n impl Stderr {\n-    pub fn new() -> Stderr {\n+    pub const fn new() -> Stderr {\n         Stderr\n     }\n }"}, {"sha": "49f44f9f498aca1f55eadc62d39122ee346abe71", "filename": "library/std/src/sys/sgx/stdio.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Fsgx%2Fstdio.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Fsgx%2Fstdio.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fsgx%2Fstdio.rs?ref=4a00421ba4daae419d06b67bd1bb46d7930b0dc7", "patch": "@@ -19,7 +19,7 @@ fn with_std_fd<F: FnOnce(&FileDesc) -> R, R>(fd: abi::Fd, f: F) -> R {\n }\n \n impl Stdin {\n-    pub fn new() -> Stdin {\n+    pub const fn new() -> Stdin {\n         Stdin(())\n     }\n }\n@@ -31,7 +31,7 @@ impl io::Read for Stdin {\n }\n \n impl Stdout {\n-    pub fn new() -> Stdout {\n+    pub const fn new() -> Stdout {\n         Stdout(())\n     }\n }\n@@ -47,7 +47,7 @@ impl io::Write for Stdout {\n }\n \n impl Stderr {\n-    pub fn new() -> Stderr {\n+    pub const fn new() -> Stderr {\n         Stderr(())\n     }\n }"}, {"sha": "a05fe8165cff2f2bc5a2cebe9eff9837427ea5c5", "filename": "library/std/src/sys/unix/stdio.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fstdio.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fstdio.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funix%2Fstdio.rs?ref=4a00421ba4daae419d06b67bd1bb46d7930b0dc7", "patch": "@@ -7,7 +7,7 @@ pub struct Stdout(());\n pub struct Stderr(());\n \n impl Stdin {\n-    pub fn new() -> Stdin {\n+    pub const fn new() -> Stdin {\n         Stdin(())\n     }\n }\n@@ -28,7 +28,7 @@ impl io::Read for Stdin {\n }\n \n impl Stdout {\n-    pub fn new() -> Stdout {\n+    pub const fn new() -> Stdout {\n         Stdout(())\n     }\n }\n@@ -53,7 +53,7 @@ impl io::Write for Stdout {\n }\n \n impl Stderr {\n-    pub fn new() -> Stderr {\n+    pub const fn new() -> Stderr {\n         Stderr(())\n     }\n }"}, {"sha": "b5e3f5be9885bc7197bb651111b833cc244a8870", "filename": "library/std/src/sys/unsupported/stdio.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Funsupported%2Fstdio.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Funsupported%2Fstdio.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Funsupported%2Fstdio.rs?ref=4a00421ba4daae419d06b67bd1bb46d7930b0dc7", "patch": "@@ -5,7 +5,7 @@ pub struct Stdout;\n pub struct Stderr;\n \n impl Stdin {\n-    pub fn new() -> Stdin {\n+    pub const fn new() -> Stdin {\n         Stdin\n     }\n }\n@@ -17,7 +17,7 @@ impl io::Read for Stdin {\n }\n \n impl Stdout {\n-    pub fn new() -> Stdout {\n+    pub const fn new() -> Stdout {\n         Stdout\n     }\n }\n@@ -33,7 +33,7 @@ impl io::Write for Stdout {\n }\n \n impl Stderr {\n-    pub fn new() -> Stderr {\n+    pub const fn new() -> Stderr {\n         Stderr\n     }\n }"}, {"sha": "92e9f205b4e6e2edaf2c7ac85c31f6bed2e00f88", "filename": "library/std/src/sys/vxworks/stdio.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Fvxworks%2Fstdio.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Fvxworks%2Fstdio.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fvxworks%2Fstdio.rs?ref=4a00421ba4daae419d06b67bd1bb46d7930b0dc7", "patch": "@@ -6,7 +6,7 @@ pub struct Stdout(());\n pub struct Stderr(());\n \n impl Stdin {\n-    pub fn new() -> Stdin {\n+    pub const fn new() -> Stdin {\n         Stdin(())\n     }\n }\n@@ -21,7 +21,7 @@ impl io::Read for Stdin {\n }\n \n impl Stdout {\n-    pub fn new() -> Stdout {\n+    pub const fn new() -> Stdout {\n         Stdout(())\n     }\n }\n@@ -40,7 +40,7 @@ impl io::Write for Stdout {\n }\n \n impl Stderr {\n-    pub fn new() -> Stderr {\n+    pub const fn new() -> Stderr {\n         Stderr(())\n     }\n }"}, {"sha": "23baafabf7933bd7ad116f0541a3466c687acb77", "filename": "library/std/src/sys/wasi/stdio.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Fwasi%2Fstdio.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Fwasi%2Fstdio.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fwasi%2Fstdio.rs?ref=4a00421ba4daae419d06b67bd1bb46d7930b0dc7", "patch": "@@ -7,7 +7,7 @@ pub struct Stdout;\n pub struct Stderr;\n \n impl Stdin {\n-    pub fn new() -> Stdin {\n+    pub const fn new() -> Stdin {\n         Stdin\n     }\n \n@@ -33,7 +33,7 @@ impl io::Read for Stdin {\n }\n \n impl Stdout {\n-    pub fn new() -> Stdout {\n+    pub const fn new() -> Stdout {\n         Stdout\n     }\n \n@@ -62,7 +62,7 @@ impl io::Write for Stdout {\n }\n \n impl Stderr {\n-    pub fn new() -> Stderr {\n+    pub const fn new() -> Stderr {\n         Stderr\n     }\n "}, {"sha": "ff214497166beb8ac953c890312a5f5e29cb689f", "filename": "library/std/src/sys/windows/stdio.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fstdio.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fstdio.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fstdio.rs?ref=4a00421ba4daae419d06b67bd1bb46d7930b0dc7", "patch": "@@ -131,7 +131,7 @@ fn write_u16s(handle: c::HANDLE, data: &[u16]) -> io::Result<usize> {\n }\n \n impl Stdin {\n-    pub fn new() -> Stdin {\n+    pub const fn new() -> Stdin {\n         Stdin { surrogate: 0 }\n     }\n }\n@@ -255,7 +255,7 @@ fn utf16_to_utf8(utf16: &[u16], utf8: &mut [u8]) -> io::Result<usize> {\n }\n \n impl Stdout {\n-    pub fn new() -> Stdout {\n+    pub const fn new() -> Stdout {\n         Stdout\n     }\n }\n@@ -271,7 +271,7 @@ impl io::Write for Stdout {\n }\n \n impl Stderr {\n-    pub fn new() -> Stderr {\n+    pub const fn new() -> Stderr {\n         Stderr\n     }\n }"}, {"sha": "872511af862a72d47ce767a0975fba1083600617", "filename": "library/std/src/sys/windows/stdio_uwp.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fstdio_uwp.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4a00421ba4daae419d06b67bd1bb46d7930b0dc7/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fstdio_uwp.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fstdio_uwp.rs?ref=4a00421ba4daae419d06b67bd1bb46d7930b0dc7", "patch": "@@ -30,7 +30,7 @@ fn write(handle_id: c::DWORD, data: &[u8]) -> io::Result<usize> {\n }\n \n impl Stdin {\n-    pub fn new() -> Stdin {\n+    pub const fn new() -> Stdin {\n         Stdin {}\n     }\n }\n@@ -44,7 +44,7 @@ impl io::Read for Stdin {\n }\n \n impl Stdout {\n-    pub fn new() -> Stdout {\n+    pub const fn new() -> Stdout {\n         Stdout\n     }\n }\n@@ -60,7 +60,7 @@ impl io::Write for Stdout {\n }\n \n impl Stderr {\n-    pub fn new() -> Stderr {\n+    pub const fn new() -> Stderr {\n         Stderr\n     }\n }"}]}