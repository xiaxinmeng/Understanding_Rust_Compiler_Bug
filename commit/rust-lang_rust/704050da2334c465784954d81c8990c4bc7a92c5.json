{"sha": "704050da2334c465784954d81c8990c4bc7a92c5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjcwNDA1MGRhMjMzNGM0NjU3ODQ5NTRkODFjODk5MGM0YmM3YTkyYzU=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2020-11-08T13:49:29Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2020-11-12T14:00:42Z"}, "message": "Make keyboard interactions in the settings menu more pleasant", "tree": {"sha": "c697b78c695bee586b2f6b21bbf1f3096bd84e8f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c697b78c695bee586b2f6b21bbf1f3096bd84e8f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/704050da2334c465784954d81c8990c4bc7a92c5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/704050da2334c465784954d81c8990c4bc7a92c5", "html_url": "https://github.com/rust-lang/rust/commit/704050da2334c465784954d81c8990c4bc7a92c5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/704050da2334c465784954d81c8990c4bc7a92c5/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "12f0dba618e761c987142474435dff95ab177f3c", "url": "https://api.github.com/repos/rust-lang/rust/commits/12f0dba618e761c987142474435dff95ab177f3c", "html_url": "https://github.com/rust-lang/rust/commit/12f0dba618e761c987142474435dff95ab177f3c"}], "stats": {"total": 70, "additions": 44, "deletions": 26}, "files": [{"sha": "4d75195fb81d4c0dc3343645442d1ed3a16bd39a", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 23, "deletions": 22, "changes": 45, "blob_url": "https://github.com/rust-lang/rust/blob/704050da2334c465784954d81c8990c4bc7a92c5/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/704050da2334c465784954d81c8990c4bc7a92c5/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=704050da2334c465784954d81c8990c4bc7a92c5", "patch": "@@ -40,6 +40,29 @@ if (!DOMTokenList.prototype.remove) {\n     };\n }\n \n+\n+// Gets the human-readable string for the virtual-key code of the\n+// given KeyboardEvent, ev.\n+//\n+// This function is meant as a polyfill for KeyboardEvent#key,\n+// since it is not supported in Trident.  We also test for\n+// KeyboardEvent#keyCode because the handleShortcut handler is\n+// also registered for the keydown event, because Blink doesn't fire\n+// keypress on hitting the Escape key.\n+//\n+// So I guess you could say things are getting pretty interoperable.\n+function getVirtualKey(ev) {\n+    if (\"key\" in ev && typeof ev.key != \"undefined\") {\n+        return ev.key;\n+    }\n+\n+    var c = ev.charCode || ev.keyCode;\n+    if (c == 27) {\n+        return \"Escape\";\n+    }\n+    return String.fromCharCode(c);\n+}\n+\n function getSearchInput() {\n     return document.getElementsByClassName(\"search-input\")[0];\n }\n@@ -323,28 +346,6 @@ function defocusSearchBar() {\n         }\n     }\n \n-    // Gets the human-readable string for the virtual-key code of the\n-    // given KeyboardEvent, ev.\n-    //\n-    // This function is meant as a polyfill for KeyboardEvent#key,\n-    // since it is not supported in Trident.  We also test for\n-    // KeyboardEvent#keyCode because the handleShortcut handler is\n-    // also registered for the keydown event, because Blink doesn't fire\n-    // keypress on hitting the Escape key.\n-    //\n-    // So I guess you could say things are getting pretty interoperable.\n-    function getVirtualKey(ev) {\n-        if (\"key\" in ev && typeof ev.key != \"undefined\") {\n-            return ev.key;\n-        }\n-\n-        var c = ev.charCode || ev.keyCode;\n-        if (c == 27) {\n-            return \"Escape\";\n-        }\n-        return String.fromCharCode(c);\n-    }\n-\n     function getHelpElement() {\n         buildHelperPopup();\n         return document.getElementById(\"help\");"}, {"sha": "daed6e731343ebcf3afde8612229249563b8e3a9", "filename": "src/librustdoc/html/static/settings.js", "status": "modified", "additions": 21, "deletions": 4, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/704050da2334c465784954d81c8990c4bc7a92c5/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fsettings.js", "raw_url": "https://github.com/rust-lang/rust/raw/704050da2334c465784954d81c8990c4bc7a92c5/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fsettings.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fsettings.js?ref=704050da2334c465784954d81c8990c4bc7a92c5", "patch": "@@ -1,5 +1,5 @@\n // Local js definitions:\n-/* global getCurrentValue, updateLocalStorage, updateSystemTheme */\n+/* global getCurrentValue, getVirtualKey, updateLocalStorage, updateSystemTheme */\n \n (function () {\n     function changeSetting(settingName, value) {\n@@ -14,10 +14,25 @@\n         }\n     }\n \n+    function handleKey(ev) {\n+        // Don't interfere with browser shortcuts\n+        if (ev.ctrlKey || ev.altKey || ev.metaKey) {\n+            return;\n+        }\n+        switch (getVirtualKey(ev)) {\n+            case \"Enter\":\n+            case \"Return\":\n+            case \"Space\":\n+                ev.target.checked = !ev.target.checked;\n+                ev.preventDefault();\n+                break;\n+        }\n+    }\n+\n     function setEvents() {\n         var elems = {\n-            toggles: document.getElementsByClassName(\"slider\"),\n-            selects: document.getElementsByClassName(\"select-wrapper\")\n+            toggles: Array.prototype.slice.call(document.getElementsByClassName(\"slider\")),\n+            selects: Array.prototype.slice.call(document.getElementsByClassName(\"select-wrapper\")),\n         };\n         var i;\n \n@@ -32,6 +47,8 @@\n                 toggle.onchange = function() {\n                     changeSetting(this.id, this.checked);\n                 };\n+                toggle.onkeyup = handleKey;\n+                toggle.onkeyrelease = handleKey;\n             }\n         }\n \n@@ -50,5 +67,5 @@\n         }\n     }\n \n-    setEvents();\n+    window.addEventListener(\"DOMContentLoaded\", setEvents);\n })();"}]}