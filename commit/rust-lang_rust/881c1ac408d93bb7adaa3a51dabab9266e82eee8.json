{"sha": "881c1ac408d93bb7adaa3a51dabab9266e82eee8", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg4MWMxYWM0MDhkOTNiYjdhZGFhM2E1MWRhYmFiOTI2NmU4MmVlZTg=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-05-08T18:41:16Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-05-08T18:41:16Z"}, "message": "Auto merge of #83278 - Amanieu:bump_stdarch, r=Mark-Simulacrum\n\nBump stdarch submodule\n\nMajor changes:\n- More AVX-512 intrinsics.\n- More ARM & AArch64 NEON intrinsics.\n- Updated unstable WASM intrinsics to latest draft standards.\n- Intrinsics that previously used `#[rustc_args_required_const]` now use const generics. See #83167 for more details.\n- `std_detect` is now a separate crate instead of a submodule of `std`.", "tree": {"sha": "4ac739f74d6c4eec4afe89ec6a299f41e22d511f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4ac739f74d6c4eec4afe89ec6a299f41e22d511f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/881c1ac408d93bb7adaa3a51dabab9266e82eee8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/881c1ac408d93bb7adaa3a51dabab9266e82eee8", "html_url": "https://github.com/rust-lang/rust/commit/881c1ac408d93bb7adaa3a51dabab9266e82eee8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/881c1ac408d93bb7adaa3a51dabab9266e82eee8/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ff34b919075f35a1787659e9c448a34b06bab8de", "url": "https://api.github.com/repos/rust-lang/rust/commits/ff34b919075f35a1787659e9c448a34b06bab8de", "html_url": "https://github.com/rust-lang/rust/commit/ff34b919075f35a1787659e9c448a34b06bab8de"}, {"sha": "bf8b15f5533c852e69ba9051c96bbcac862bdfbb", "url": "https://api.github.com/repos/rust-lang/rust/commits/bf8b15f5533c852e69ba9051c96bbcac862bdfbb", "html_url": "https://github.com/rust-lang/rust/commit/bf8b15f5533c852e69ba9051c96bbcac862bdfbb"}], "stats": {"total": 62, "additions": 28, "deletions": 34}, "files": [{"sha": "6c4f4e1990b76be8a07bde1956d2e3452fd55ee4", "filename": "library/stdarch", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": null, "raw_url": null, "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstdarch?ref=881c1ac408d93bb7adaa3a51dabab9266e82eee8", "patch": "@@ -1 +1 @@\n-Subproject commit 19f5459dd0f89e466b7bcaa0f69ecca90f21a4d1\n+Subproject commit 6c4f4e1990b76be8a07bde1956d2e3452fd55ee4"}, {"sha": "9add1f8d5a3592615956cefb6ccb69ab5fe1a4e5", "filename": "src/test/ui/consts/const_arg_local.rs", "status": "modified", "additions": 5, "deletions": 7, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/881c1ac408d93bb7adaa3a51dabab9266e82eee8/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_local.rs", "raw_url": "https://github.com/rust-lang/rust/raw/881c1ac408d93bb7adaa3a51dabab9266e82eee8/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_local.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_local.rs?ref=881c1ac408d93bb7adaa3a51dabab9266e82eee8", "patch": "@@ -1,13 +1,11 @@\n-// only-x86_64\n+#![feature(rustc_attrs)]\n \n-#[cfg(target_arch = \"x86\")]\n-use std::arch::x86::*;\n-#[cfg(target_arch = \"x86_64\")]\n-use std::arch::x86_64::*;\n+#[rustc_args_required_const(0)]\n+fn foo(_imm8: i32) {}\n \n-unsafe fn pclmul(a: __m128i, b: __m128i) -> __m128i {\n+fn bar() {\n     let imm8 = 3;\n-    _mm_clmulepi64_si128(a, b, imm8) //~ ERROR argument 3 is required to be a constant\n+    foo(imm8) //~ ERROR argument 1 is required to be a constant\n }\n \n fn main() {}"}, {"sha": "bad85471a6b376df719c9574b98488ba457176b7", "filename": "src/test/ui/consts/const_arg_local.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/881c1ac408d93bb7adaa3a51dabab9266e82eee8/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_local.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/881c1ac408d93bb7adaa3a51dabab9266e82eee8/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_local.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_local.stderr?ref=881c1ac408d93bb7adaa3a51dabab9266e82eee8", "patch": "@@ -1,8 +1,8 @@\n-error: argument 3 is required to be a constant\n-  --> $DIR/const_arg_local.rs:10:5\n+error: argument 1 is required to be a constant\n+  --> $DIR/const_arg_local.rs:8:5\n    |\n-LL |     _mm_clmulepi64_si128(a, b, imm8)\n-   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL |     foo(imm8)\n+   |     ^^^^^^^^^\n \n error: aborting due to previous error\n "}, {"sha": "cea3817550eb2b101215ac0f16289dd03d53e38d", "filename": "src/test/ui/consts/const_arg_promotable.rs", "status": "modified", "additions": 5, "deletions": 7, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/881c1ac408d93bb7adaa3a51dabab9266e82eee8/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_promotable.rs", "raw_url": "https://github.com/rust-lang/rust/raw/881c1ac408d93bb7adaa3a51dabab9266e82eee8/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_promotable.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_promotable.rs?ref=881c1ac408d93bb7adaa3a51dabab9266e82eee8", "patch": "@@ -1,12 +1,10 @@\n-// only-x86_64\n+#![feature(rustc_attrs)]\n \n-#[cfg(target_arch = \"x86\")]\n-use std::arch::x86::*;\n-#[cfg(target_arch = \"x86_64\")]\n-use std::arch::x86_64::*;\n+#[rustc_args_required_const(0)]\n+fn foo(_imm8: i32) {}\n \n-unsafe fn pclmul(a: __m128i, b: __m128i) -> __m128i {\n-    _mm_clmulepi64_si128(a, b, *&mut 42) //~ ERROR argument 3 is required to be a constant\n+fn bar() {\n+    foo(*&mut 42) //~ ERROR argument 1 is required to be a constant\n }\n \n fn main() {}"}, {"sha": "b24b245b3ce0c867f5539e035711208e6b5400cc", "filename": "src/test/ui/consts/const_arg_promotable.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/881c1ac408d93bb7adaa3a51dabab9266e82eee8/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_promotable.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/881c1ac408d93bb7adaa3a51dabab9266e82eee8/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_promotable.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_promotable.stderr?ref=881c1ac408d93bb7adaa3a51dabab9266e82eee8", "patch": "@@ -1,8 +1,8 @@\n-error: argument 3 is required to be a constant\n-  --> $DIR/const_arg_promotable.rs:9:5\n+error: argument 1 is required to be a constant\n+  --> $DIR/const_arg_promotable.rs:7:5\n    |\n-LL |     _mm_clmulepi64_si128(a, b, *&mut 42)\n-   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL |     foo(*&mut 42)\n+   |     ^^^^^^^^^^^^^\n \n error: aborting due to previous error\n "}, {"sha": "3dd3a2ffaf3cba83f332c2fca31e2b85592a8a5f", "filename": "src/test/ui/consts/const_arg_wrapper.rs", "status": "modified", "additions": 5, "deletions": 7, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/881c1ac408d93bb7adaa3a51dabab9266e82eee8/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_wrapper.rs", "raw_url": "https://github.com/rust-lang/rust/raw/881c1ac408d93bb7adaa3a51dabab9266e82eee8/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_wrapper.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_wrapper.rs?ref=881c1ac408d93bb7adaa3a51dabab9266e82eee8", "patch": "@@ -1,12 +1,10 @@\n-// only-x86_64\n+#![feature(rustc_attrs)]\n \n-#[cfg(target_arch = \"x86\")]\n-use std::arch::x86::*;\n-#[cfg(target_arch = \"x86_64\")]\n-use std::arch::x86_64::*;\n+#[rustc_args_required_const(0)]\n+fn foo(_imm8: i32) {}\n \n-unsafe fn pclmul(a: __m128i, b: __m128i, imm8: i32) -> __m128i {\n-    _mm_clmulepi64_si128(a, b, imm8) //~ ERROR argument 3 is required to be a constant\n+fn bar(imm8: i32) {\n+    foo(imm8) //~ ERROR argument 1 is required to be a constant\n }\n \n fn main() {}"}, {"sha": "9cd95a2020fcd1c2b2e0f2ddb0039568e7946e06", "filename": "src/test/ui/consts/const_arg_wrapper.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/881c1ac408d93bb7adaa3a51dabab9266e82eee8/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_wrapper.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/881c1ac408d93bb7adaa3a51dabab9266e82eee8/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_wrapper.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_arg_wrapper.stderr?ref=881c1ac408d93bb7adaa3a51dabab9266e82eee8", "patch": "@@ -1,8 +1,8 @@\n-error: argument 3 is required to be a constant\n-  --> $DIR/const_arg_wrapper.rs:9:5\n+error: argument 1 is required to be a constant\n+  --> $DIR/const_arg_wrapper.rs:7:5\n    |\n-LL |     _mm_clmulepi64_si128(a, b, imm8)\n-   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+LL |     foo(imm8)\n+   |     ^^^^^^^^^\n \n error: aborting due to previous error\n "}]}