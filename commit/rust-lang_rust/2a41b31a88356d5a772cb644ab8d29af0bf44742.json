{"sha": "2a41b31a88356d5a772cb644ab8d29af0bf44742", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJhNDFiMzFhODgzNTZkNWE3NzJjYjY0NGFiOGQyOWFmMGJmNDQ3NDI=", "commit": {"author": {"name": "Wang Xuerui", "email": "idontknw.wang@gmail.com", "date": "2016-07-29T08:40:10Z"}, "committer": {"name": "Wang Xuerui", "email": "idontknw.wang@gmail.com", "date": "2016-07-29T08:40:10Z"}, "message": "syntax_ext: format: fix ICE with bad named arguments", "tree": {"sha": "9a54f52e40d90eb3eefcfd0730637eb1b85daee7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9a54f52e40d90eb3eefcfd0730637eb1b85daee7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2a41b31a88356d5a772cb644ab8d29af0bf44742", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v2\n\niQIcBAABCAAGBQJXmxZqAAoJEHg5bO9pIxDspWYP/0fBG6pHo73QScbiBOhW/lkh\nxHgk2cWdERcmRrjRu1QyIevZ/m1V0FZNgNLCbfsCfDym0YTTqOJApjm+QJLCNqjV\n+z7L/TRrRhet3hkcZulXDt0xc8+57Lh6uHSoJpSWb0+edRgZMhF2d8C2E/04sMvc\n2gqLt21nrfq5lpzqm4yQ9PHogGuoypWRtbGRGxLHSvykbERergC9q2zXuSuhkRbH\naqor+hbrJYJ14C65kMR/NG/RcxbCkp4JsYLF9T710CM8h4vaNvOyX0dcOFIlGq+A\n2dUH/6XRs8R894+uUUQqA78fzHTcTmaJpMJk7rGCLw9Zspb4ZCu8gKgF0DHBPJql\nW0X+UdRvVNEeFyWWmpxy7thbPaoX+erWn7rD5oqbaRXLQ+oIXBF2cXiQOPejpZr9\nqXuk+VSkwQak+fgAtdw7GrATA+5Ok3REGBAoQ+HEpursF2wiUu8FM7VfHXY5B2JA\nkR8kXpPYZfj60A9baJjVSoOdnfYhxzymmHAxQsJOyEREq3WSOj6qkYH1hGX3UHWp\nCjTwg8NcJlZn0AQZtAwjBG2IfTHYtxMI22aVoKBYvqE0O9Kd5dr+Z/1Vw5QY7M45\nXXleSrweut+AlLhfVlsJ1hkoN1oVVwhnp7wzLGYvFFzhTm/5E47x84mKLK/QBlyZ\ntrwRit2ZboSwghvMS4Eg\n=lGGn\n-----END PGP SIGNATURE-----", "payload": "tree 9a54f52e40d90eb3eefcfd0730637eb1b85daee7\nparent d9a911d236cbecb47775276ba51a5f9111bdbc9c\nauthor Wang Xuerui <idontknw.wang@gmail.com> 1469781610 +0800\ncommitter Wang Xuerui <idontknw.wang@gmail.com> 1469781610 +0800\n\nsyntax_ext: format: fix ICE with bad named arguments\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2a41b31a88356d5a772cb644ab8d29af0bf44742", "html_url": "https://github.com/rust-lang/rust/commit/2a41b31a88356d5a772cb644ab8d29af0bf44742", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2a41b31a88356d5a772cb644ab8d29af0bf44742/comments", "author": {"login": "xen0n", "id": 1175567, "node_id": "MDQ6VXNlcjExNzU1Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/1175567?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xen0n", "html_url": "https://github.com/xen0n", "followers_url": "https://api.github.com/users/xen0n/followers", "following_url": "https://api.github.com/users/xen0n/following{/other_user}", "gists_url": "https://api.github.com/users/xen0n/gists{/gist_id}", "starred_url": "https://api.github.com/users/xen0n/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xen0n/subscriptions", "organizations_url": "https://api.github.com/users/xen0n/orgs", "repos_url": "https://api.github.com/users/xen0n/repos", "events_url": "https://api.github.com/users/xen0n/events{/privacy}", "received_events_url": "https://api.github.com/users/xen0n/received_events", "type": "User", "site_admin": false}, "committer": {"login": "xen0n", "id": 1175567, "node_id": "MDQ6VXNlcjExNzU1Njc=", "avatar_url": "https://avatars.githubusercontent.com/u/1175567?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xen0n", "html_url": "https://github.com/xen0n", "followers_url": "https://api.github.com/users/xen0n/followers", "following_url": "https://api.github.com/users/xen0n/following{/other_user}", "gists_url": "https://api.github.com/users/xen0n/gists{/gist_id}", "starred_url": "https://api.github.com/users/xen0n/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xen0n/subscriptions", "organizations_url": "https://api.github.com/users/xen0n/orgs", "repos_url": "https://api.github.com/users/xen0n/repos", "events_url": "https://api.github.com/users/xen0n/events{/privacy}", "received_events_url": "https://api.github.com/users/xen0n/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d9a911d236cbecb47775276ba51a5f9111bdbc9c", "url": "https://api.github.com/repos/rust-lang/rust/commits/d9a911d236cbecb47775276ba51a5f9111bdbc9c", "html_url": "https://github.com/rust-lang/rust/commit/d9a911d236cbecb47775276ba51a5f9111bdbc9c"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "1f6f57c70f72f09dd6186c8eb49449aafdd5fe99", "filename": "src/libsyntax_ext/format.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2a41b31a88356d5a772cb644ab8d29af0bf44742/src%2Flibsyntax_ext%2Fformat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2a41b31a88356d5a772cb644ab8d29af0bf44742/src%2Flibsyntax_ext%2Fformat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax_ext%2Fformat.rs?ref=2a41b31a88356d5a772cb644ab8d29af0bf44742", "patch": "@@ -406,7 +406,9 @@ impl<'a, 'b> Context<'a, 'b> {\n                             let arg_idx = match arg_index_consumed.get_mut(i) {\n                                 None => 0, // error already emitted elsewhere\n                                 Some(offset) => {\n-                                    let arg_idx = self.arg_index_map[i][*offset];\n+                                    let ref idx_map = self.arg_index_map[i];\n+                                    // unwrap_or branch: error already emitted elsewhere\n+                                    let arg_idx = *idx_map.get(*offset).unwrap_or(&0);\n                                     *offset += 1;\n                                     arg_idx\n                                 }"}, {"sha": "59c61a42e077f22146391ed3a7eb62bb551c507e", "filename": "src/test/compile-fail/ifmt-bad-arg.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/2a41b31a88356d5a772cb644ab8d29af0bf44742/src%2Ftest%2Fcompile-fail%2Fifmt-bad-arg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2a41b31a88356d5a772cb644ab8d29af0bf44742/src%2Ftest%2Fcompile-fail%2Fifmt-bad-arg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fifmt-bad-arg.rs?ref=2a41b31a88356d5a772cb644ab8d29af0bf44742", "patch": "@@ -41,6 +41,12 @@ fn main() {\n     //~^ ERROR invalid reference to argument `0` (no arguments given)\n     //~^^ ERROR invalid reference to argument `1` (no arguments given)\n \n+    // bad named arguments, #35082\n+\n+    format!(\"{valuea} {valueb}\", valuea=5, valuec=7);\n+    //~^ ERROR there is no argument named `valueb`\n+    //~^^ ERROR named argument never used\n+\n     // bad syntax of the format string\n \n     format!(\"{\"); //~ ERROR: expected `'}'` but string was terminated"}]}