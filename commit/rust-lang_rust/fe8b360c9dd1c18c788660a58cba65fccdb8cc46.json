{"sha": "fe8b360c9dd1c18c788660a58cba65fccdb8cc46", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZlOGIzNjBjOWRkMWMxOGM3ODg2NjBhNThjYmE2NWZjY2RiOGNjNDY=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2013-12-22T21:46:06Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2013-12-23T17:10:37Z"}, "message": "mk: Run doc tests as part of 'make check'\n\nDon't run doc tests during make check-fast because it involves spawning lots of\nprocesses.", "tree": {"sha": "ed7f6932e0711589d276580f73039aca1516d491", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ed7f6932e0711589d276580f73039aca1516d491"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fe8b360c9dd1c18c788660a58cba65fccdb8cc46", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fe8b360c9dd1c18c788660a58cba65fccdb8cc46", "html_url": "https://github.com/rust-lang/rust/commit/fe8b360c9dd1c18c788660a58cba65fccdb8cc46", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fe8b360c9dd1c18c788660a58cba65fccdb8cc46/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d882b1d4f94336c5f64fd3891ee74c0b579dd395", "url": "https://api.github.com/repos/rust-lang/rust/commits/d882b1d4f94336c5f64fd3891ee74c0b579dd395", "html_url": "https://github.com/rust-lang/rust/commit/d882b1d4f94336c5f64fd3891ee74c0b579dd395"}], "stats": {"total": 27, "additions": 27, "deletions": 0}, "files": [{"sha": "1a56c008ccb702d35e27bd27a7830c6f32ea04a3", "filename": "mk/tests.mk", "status": "modified", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/fe8b360c9dd1c18c788660a58cba65fccdb8cc46/mk%2Ftests.mk", "raw_url": "https://github.com/rust-lang/rust/raw/fe8b360c9dd1c18c788660a58cba65fccdb8cc46/mk%2Ftests.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftests.mk?ref=fe8b360c9dd1c18c788660a58cba65fccdb8cc46", "patch": "@@ -15,6 +15,7 @@\n \n # The names of crates that must be tested\n TEST_TARGET_CRATES = std extra rustuv\n+TEST_DOC_CRATES = std extra\n TEST_HOST_CRATES = rustpkg rustc rustdoc syntax\n TEST_CRATES = $(TEST_TARGET_CRATES) $(TEST_HOST_CRATES)\n \n@@ -281,6 +282,7 @@ check-stage$(1)-T-$(2)-H-$(3)-exec:     \t\t\t\t\\\n \tcheck-stage$(1)-T-$(2)-H-$(3)-rpass-full-exec\t\t\t\\\n \tcheck-stage$(1)-T-$(2)-H-$(3)-rmake-exec\t\t\t\\\n         check-stage$(1)-T-$(2)-H-$(3)-crates-exec                       \\\n+        check-stage$(1)-T-$(2)-H-$(3)-doc-crates-exec                   \\\n \tcheck-stage$(1)-T-$(2)-H-$(3)-bench-exec\t\t\t\\\n \tcheck-stage$(1)-T-$(2)-H-$(3)-debuginfo-exec \\\n \tcheck-stage$(1)-T-$(2)-H-$(3)-codegen-exec \\\n@@ -303,6 +305,10 @@ check-stage$(1)-T-$(2)-H-$(3)-crates-exec: \\\n \n endif\n \n+check-stage$(1)-T-$(2)-H-$(3)-doc-crates-exec: \\\n+        $$(foreach crate,$$(TEST_DOC_CRATES), \\\n+           check-stage$(1)-T-$(2)-H-$(3)-doc-$$(crate)-exec)\n+\n check-stage$(1)-T-$(2)-H-$(3)-doc-exec: \\\n         $$(foreach docname,$$(DOC_TEST_NAMES), \\\n            check-stage$(1)-T-$(2)-H-$(3)-doc-$$(docname)-exec)\n@@ -734,6 +740,26 @@ $(foreach host,$(CFG_HOST), \\\n    $(foreach docname,$(DOC_TEST_NAMES), \\\n     $(eval $(call DEF_RUN_DOC_TEST,$(stage),$(target),$(host),$(docname)))))))\n \n+CRATE_DOC_LIB-std = $(STDLIB_CRATE)\n+CRATE_DOC_LIB-extra = $(EXTRALIB_CRATE)\n+\n+define DEF_CRATE_DOC_TEST\n+\n+check-stage$(1)-T-$(2)-H-$(2)-doc-$(3)-exec: $$(call TEST_OK_FILE,$(1),$(2),$(2),doc-$(3))\n+\n+$$(call TEST_OK_FILE,$(1),$(2),$(2),doc-$(3)):\t\t\\\n+\t        $$(TEST_SREQ$(1)_T_$(2)_H_$(2))\t\t\\\n+\t\t$$(HBIN$(1)_H_$(2))/rustdoc$$(X_$(2))\n+\t@$$(call E, run doc-$(3) [$(2)])\n+\t$$(Q)$$(HBIN$(1)_H_$(2))/rustdoc$$(X_$(2)) --test \\\n+\t    $$(CRATE_DOC_LIB-$(3)) && touch $$@\n+\n+endef\n+\n+$(foreach host,$(CFG_HOST), \\\n+ $(foreach stage,$(STAGES), \\\n+  $(foreach crate,$(TEST_DOC_CRATES), \\\n+   $(eval $(call DEF_CRATE_DOC_TEST,$(stage),$(host),$(crate))))))\n \n ######################################################################\n # Extracting tests for docs\n@@ -762,6 +788,7 @@ $(foreach host,$(CFG_HOST), \\\n TEST_GROUPS = \\\n \tcrates \\\n \t$(foreach crate,$(TEST_CRATES),$(crate)) \\\n+\t$(foreach crate,$(TEST_DOC_CRATES),doc-$(crate)) \\\n \trpass \\\n \trpass-full \\\n \trfail \\"}]}