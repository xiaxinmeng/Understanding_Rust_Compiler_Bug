{"sha": "17dfae79bbc3dabe1427073086acf7f7bd45148c", "node_id": "C_kwDOAAsO6NoAKDE3ZGZhZTc5YmJjM2RhYmUxNDI3MDczMDg2YWNmN2Y3YmQ0NTE0OGM", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-01-25T08:18:25Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-01-25T08:18:25Z"}, "message": "Auto merge of #93089 - pierwill:rm-outlivesconstraint-ord, r=michaelwoerister\n\nRemove ordering traits from `OutlivesConstraint`\n\nIn two cases where this ordering was used, I've replaced the sorting to use a key that does not rely on `DefId` being `Ord`. This is part of #90317. If I understand correctly, whether this is correct depends on whether the `RegionVid`s are tracked during incremental compilation. But I might be mistaken in this approach. cc `@cjgillot`", "tree": {"sha": "a4117ad8152cbc222346846748b75f3139933d87", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a4117ad8152cbc222346846748b75f3139933d87"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/17dfae79bbc3dabe1427073086acf7f7bd45148c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/17dfae79bbc3dabe1427073086acf7f7bd45148c", "html_url": "https://github.com/rust-lang/rust/commit/17dfae79bbc3dabe1427073086acf7f7bd45148c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/17dfae79bbc3dabe1427073086acf7f7bd45148c/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "df368ae457c54fb95d3e64f9986a5f171a6370f0", "url": "https://api.github.com/repos/rust-lang/rust/commits/df368ae457c54fb95d3e64f9986a5f171a6370f0", "html_url": "https://github.com/rust-lang/rust/commit/df368ae457c54fb95d3e64f9986a5f171a6370f0"}, {"sha": "7f16d0ed54b3497e8b26bc68cdf9a7590f3be816", "url": "https://api.github.com/repos/rust-lang/rust/commits/7f16d0ed54b3497e8b26bc68cdf9a7590f3be816", "html_url": "https://github.com/rust-lang/rust/commit/7f16d0ed54b3497e8b26bc68cdf9a7590f3be816"}], "stats": {"total": 6, "additions": 3, "deletions": 3}, "files": [{"sha": "d41143ee763ad835709be88e3966595533913df5", "filename": "compiler/rustc_borrowck/src/constraints/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/17dfae79bbc3dabe1427073086acf7f7bd45148c/compiler%2Frustc_borrowck%2Fsrc%2Fconstraints%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/17dfae79bbc3dabe1427073086acf7f7bd45148c/compiler%2Frustc_borrowck%2Fsrc%2Fconstraints%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_borrowck%2Fsrc%2Fconstraints%2Fmod.rs?ref=17dfae79bbc3dabe1427073086acf7f7bd45148c", "patch": "@@ -72,7 +72,7 @@ impl<'tcx> Index<OutlivesConstraintIndex> for OutlivesConstraintSet<'tcx> {\n     }\n }\n \n-#[derive(Clone, PartialEq, Eq, PartialOrd, Ord)]\n+#[derive(Clone, PartialEq, Eq)]\n pub struct OutlivesConstraint<'tcx> {\n     // NB. The ordering here is not significant for correctness, but\n     // it is for convenience. Before we dump the constraints in the"}, {"sha": "97233b930c395f839abe07d86a4b64640fc5ded7", "filename": "compiler/rustc_borrowck/src/region_infer/dump_mir.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/17dfae79bbc3dabe1427073086acf7f7bd45148c/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fdump_mir.rs", "raw_url": "https://github.com/rust-lang/rust/raw/17dfae79bbc3dabe1427073086acf7f7bd45148c/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fdump_mir.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fdump_mir.rs?ref=17dfae79bbc3dabe1427073086acf7f7bd45148c", "patch": "@@ -72,7 +72,7 @@ impl<'tcx> RegionInferenceContext<'tcx> {\n         }\n \n         let mut constraints: Vec<_> = self.constraints.outlives().iter().collect();\n-        constraints.sort();\n+        constraints.sort_by_key(|c| (c.sup, c.sub));\n         for constraint in &constraints {\n             let OutlivesConstraint { sup, sub, locations, category, variance_info: _ } = constraint;\n             let (name, arg) = match locations {"}, {"sha": "d9120ff245735084f3d9dc2ca4050090d0287e05", "filename": "compiler/rustc_borrowck/src/region_infer/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/17dfae79bbc3dabe1427073086acf7f7bd45148c/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/17dfae79bbc3dabe1427073086acf7f7bd45148c/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fmod.rs?ref=17dfae79bbc3dabe1427073086acf7f7bd45148c", "patch": "@@ -612,7 +612,7 @@ impl<'tcx> RegionInferenceContext<'tcx> {\n     fn propagate_constraints(&mut self, _body: &Body<'tcx>) {\n         debug!(\"constraints={:#?}\", {\n             let mut constraints: Vec<_> = self.constraints.outlives().iter().collect();\n-            constraints.sort();\n+            constraints.sort_by_key(|c| (c.sup, c.sub));\n             constraints\n                 .into_iter()\n                 .map(|c| (c, self.constraint_sccs.scc(c.sup), self.constraint_sccs.scc(c.sub)))"}]}