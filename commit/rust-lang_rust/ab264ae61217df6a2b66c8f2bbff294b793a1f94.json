{"sha": "ab264ae61217df6a2b66c8f2bbff294b793a1f94", "node_id": "C_kwDOAAsO6NoAKGFiMjY0YWU2MTIxN2RmNmEyYjY2YzhmMmJiZmYyOTRiNzkzYTFmOTQ", "commit": {"author": {"name": "Jacob Pratt", "email": "jacob@jhpratt.dev", "date": "2022-11-30T21:17:00Z"}, "committer": {"name": "Jacob Pratt", "email": "jacob@jhpratt.dev", "date": "2022-11-30T21:18:31Z"}, "message": "Fix ICE from #105101", "tree": {"sha": "95941e2828b7d94394f3aa3cf9107532d787e8d7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/95941e2828b7d94394f3aa3cf9107532d787e8d7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ab264ae61217df6a2b66c8f2bbff294b793a1f94", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niHUEABYIAB0WIQTgxeqBxcDGar1sVhy4DhnkZitapAUCY4fIpwAKCRC4DhnkZita\npHDeAQDIkukxy81elB/p5rxPHNWSYSSmfVBIrKpmnYVJdpPNuwD9EyoSP5Zlkdre\nojc3qA42xc1X+e7iA3Fxl0E8nh5Ekww=\n=vSLH\n-----END PGP SIGNATURE-----", "payload": "tree 95941e2828b7d94394f3aa3cf9107532d787e8d7\nparent c97b539e408ea353f4fde2f9251d598291fec421\nauthor Jacob Pratt <jacob@jhpratt.dev> 1669843020 +0000\ncommitter Jacob Pratt <jacob@jhpratt.dev> 1669843111 +0000\n\nFix ICE from #105101\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ab264ae61217df6a2b66c8f2bbff294b793a1f94", "html_url": "https://github.com/rust-lang/rust/commit/ab264ae61217df6a2b66c8f2bbff294b793a1f94", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ab264ae61217df6a2b66c8f2bbff294b793a1f94/comments", "author": {"login": "jhpratt", "id": 3161395, "node_id": "MDQ6VXNlcjMxNjEzOTU=", "avatar_url": "https://avatars.githubusercontent.com/u/3161395?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jhpratt", "html_url": "https://github.com/jhpratt", "followers_url": "https://api.github.com/users/jhpratt/followers", "following_url": "https://api.github.com/users/jhpratt/following{/other_user}", "gists_url": "https://api.github.com/users/jhpratt/gists{/gist_id}", "starred_url": "https://api.github.com/users/jhpratt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jhpratt/subscriptions", "organizations_url": "https://api.github.com/users/jhpratt/orgs", "repos_url": "https://api.github.com/users/jhpratt/repos", "events_url": "https://api.github.com/users/jhpratt/events{/privacy}", "received_events_url": "https://api.github.com/users/jhpratt/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jhpratt", "id": 3161395, "node_id": "MDQ6VXNlcjMxNjEzOTU=", "avatar_url": "https://avatars.githubusercontent.com/u/3161395?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jhpratt", "html_url": "https://github.com/jhpratt", "followers_url": "https://api.github.com/users/jhpratt/followers", "following_url": "https://api.github.com/users/jhpratt/following{/other_user}", "gists_url": "https://api.github.com/users/jhpratt/gists{/gist_id}", "starred_url": "https://api.github.com/users/jhpratt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jhpratt/subscriptions", "organizations_url": "https://api.github.com/users/jhpratt/orgs", "repos_url": "https://api.github.com/users/jhpratt/repos", "events_url": "https://api.github.com/users/jhpratt/events{/privacy}", "received_events_url": "https://api.github.com/users/jhpratt/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c97b539e408ea353f4fde2f9251d598291fec421", "url": "https://api.github.com/repos/rust-lang/rust/commits/c97b539e408ea353f4fde2f9251d598291fec421", "html_url": "https://github.com/rust-lang/rust/commit/c97b539e408ea353f4fde2f9251d598291fec421"}], "stats": {"total": 40, "additions": 39, "deletions": 1}, "files": [{"sha": "bd5c6e42a19f3a9f2cee50ca13203e2a6d2e7079", "filename": "compiler/rustc_builtin_macros/src/deriving/default.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ab264ae61217df6a2b66c8f2bbff294b793a1f94/compiler%2Frustc_builtin_macros%2Fsrc%2Fderiving%2Fdefault.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ab264ae61217df6a2b66c8f2bbff294b793a1f94/compiler%2Frustc_builtin_macros%2Fsrc%2Fderiving%2Fdefault.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_builtin_macros%2Fsrc%2Fderiving%2Fdefault.rs?ref=ab264ae61217df6a2b66c8f2bbff294b793a1f94", "patch": "@@ -146,7 +146,7 @@ fn extract_default_variant<'a>(\n                 let suggestion = default_variants\n                     .iter()\n                     .filter_map(|v| {\n-                        if v.ident == variant.ident {\n+                        if v.span == variant.span {\n                             None\n                         } else {\n                             Some((cx.sess.find_by_name(&v.attrs, kw::Default)?.span, String::new()))"}, {"sha": "1a377feb91948aecf12cda6f987e2b5d0caa2346", "filename": "src/test/ui/deriving/issue-105101.rs", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/ab264ae61217df6a2b66c8f2bbff294b793a1f94/src%2Ftest%2Fui%2Fderiving%2Fissue-105101.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ab264ae61217df6a2b66c8f2bbff294b793a1f94/src%2Ftest%2Fui%2Fderiving%2Fissue-105101.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fderiving%2Fissue-105101.rs?ref=ab264ae61217df6a2b66c8f2bbff294b793a1f94", "patch": "@@ -0,0 +1,9 @@\n+// compile-flags: --crate-type=lib\n+\n+#[derive(Default)] //~ ERROR multiple declared defaults\n+enum E {\n+    #[default]\n+    A,\n+    #[default]\n+    A, //~ ERROR defined multiple times\n+}"}, {"sha": "0f6f67043f32fdb378b459b4e18b215ee2ca2b08", "filename": "src/test/ui/deriving/issue-105101.stderr", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/ab264ae61217df6a2b66c8f2bbff294b793a1f94/src%2Ftest%2Fui%2Fderiving%2Fissue-105101.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/ab264ae61217df6a2b66c8f2bbff294b793a1f94/src%2Ftest%2Fui%2Fderiving%2Fissue-105101.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fderiving%2Fissue-105101.stderr?ref=ab264ae61217df6a2b66c8f2bbff294b793a1f94", "patch": "@@ -0,0 +1,29 @@\n+error: multiple declared defaults\n+  --> $DIR/issue-105101.rs:3:10\n+   |\n+LL | #[derive(Default)]\n+   |          ^^^^^^^\n+...\n+LL |     A,\n+   |     - first default\n+LL |     #[default]\n+LL |     A,\n+   |     - additional default\n+   |\n+   = note: only one variant can be default\n+   = note: this error originates in the derive macro `Default` (in Nightly builds, run with -Z macro-backtrace for more info)\n+\n+error[E0428]: the name `A` is defined multiple times\n+  --> $DIR/issue-105101.rs:8:5\n+   |\n+LL |     A,\n+   |     - previous definition of the type `A` here\n+LL |     #[default]\n+LL |     A,\n+   |     ^ `A` redefined here\n+   |\n+   = note: `A` must be defined only once in the type namespace of this enum\n+\n+error: aborting due to 2 previous errors\n+\n+For more information about this error, try `rustc --explain E0428`."}]}