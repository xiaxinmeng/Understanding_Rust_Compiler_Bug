{"sha": "bcc44b8e025978ae14ff11d484aacbb85aa8eaed", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJjYzQ0YjhlMDI1OTc4YWUxNGZmMTFkNDg0YWFjYmI4NWFhOGVhZWQ=", "commit": {"author": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2020-05-02T21:39:12Z"}, "committer": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2020-05-02T21:46:22Z"}, "message": "Test associated const default qualifs cross-crate\n\nThis also tests for the ICE in #71734", "tree": {"sha": "c543632db7e5a5fa735aae09e4ddc703ab4fb1dd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c543632db7e5a5fa735aae09e4ddc703ab4fb1dd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bcc44b8e025978ae14ff11d484aacbb85aa8eaed", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bcc44b8e025978ae14ff11d484aacbb85aa8eaed", "html_url": "https://github.com/rust-lang/rust/commit/bcc44b8e025978ae14ff11d484aacbb85aa8eaed", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bcc44b8e025978ae14ff11d484aacbb85aa8eaed/comments", "author": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a91d64873f5b8daa43f0e82dedad7e2bc39e8fba", "url": "https://api.github.com/repos/rust-lang/rust/commits/a91d64873f5b8daa43f0e82dedad7e2bc39e8fba", "html_url": "https://github.com/rust-lang/rust/commit/a91d64873f5b8daa43f0e82dedad7e2bc39e8fba"}], "stats": {"total": 44, "additions": 41, "deletions": 3}, "files": [{"sha": "b438bcd9fb5eb0169dd73ec67edde4d25b15cb6f", "filename": "src/test/ui/consts/const_in_pattern/auxiliary/consts.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/bcc44b8e025978ae14ff11d484aacbb85aa8eaed/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fauxiliary%2Fconsts.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bcc44b8e025978ae14ff11d484aacbb85aa8eaed/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fauxiliary%2Fconsts.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fauxiliary%2Fconsts.rs?ref=bcc44b8e025978ae14ff11d484aacbb85aa8eaed", "patch": "@@ -9,3 +9,8 @@ impl PartialEq for CustomEq {\n \n pub const NONE: Option<CustomEq> = None;\n pub const SOME: Option<CustomEq> = Some(CustomEq);\n+\n+pub trait AssocConst {\n+    const NONE: Option<CustomEq> = None;\n+    const SOME: Option<CustomEq> = Some(CustomEq);\n+}"}, {"sha": "05c53e5edccc596fbed49c82bb624c7f761df84b", "filename": "src/test/ui/consts/const_in_pattern/cross-crate-fail.rs", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/bcc44b8e025978ae14ff11d484aacbb85aa8eaed/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcross-crate-fail.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bcc44b8e025978ae14ff11d484aacbb85aa8eaed/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcross-crate-fail.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcross-crate-fail.rs?ref=bcc44b8e025978ae14ff11d484aacbb85aa8eaed", "patch": "@@ -4,12 +4,24 @@\n \n extern crate consts;\n \n+struct Defaulted;\n+impl consts::AssocConst for Defaulted {}\n+\n fn main() {\n+    let _ = Defaulted;\n     match None {\n         consts::SOME => panic!(),\n         //~^ must be annotated with `#[derive(PartialEq, Eq)]`\n         //~| must be annotated with `#[derive(PartialEq, Eq)]`\n \n         _ => {}\n     }\n+\n+    match None {\n+        <Defaulted as consts::AssocConst>::SOME  => panic!(),\n+        //~^ must be annotated with `#[derive(PartialEq, Eq)]`\n+        //~| must be annotated with `#[derive(PartialEq, Eq)]`\n+\n+        _ => {}\n+    }\n }"}, {"sha": "5d147e32f5a8687eb2ed1406d63e01bdf7f0cca8", "filename": "src/test/ui/consts/const_in_pattern/cross-crate-fail.stderr", "status": "modified", "additions": 15, "deletions": 3, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/bcc44b8e025978ae14ff11d484aacbb85aa8eaed/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcross-crate-fail.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/bcc44b8e025978ae14ff11d484aacbb85aa8eaed/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcross-crate-fail.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcross-crate-fail.stderr?ref=bcc44b8e025978ae14ff11d484aacbb85aa8eaed", "patch": "@@ -1,14 +1,26 @@\n error: to use a constant of type `consts::CustomEq` in a pattern, `consts::CustomEq` must be annotated with `#[derive(PartialEq, Eq)]`\n-  --> $DIR/cross-crate-fail.rs:9:9\n+  --> $DIR/cross-crate-fail.rs:13:9\n    |\n LL |         consts::SOME => panic!(),\n    |         ^^^^^^^^^^^^\n \n error: to use a constant of type `consts::CustomEq` in a pattern, `consts::CustomEq` must be annotated with `#[derive(PartialEq, Eq)]`\n-  --> $DIR/cross-crate-fail.rs:9:9\n+  --> $DIR/cross-crate-fail.rs:21:9\n+   |\n+LL |         <Defaulted as consts::AssocConst>::SOME  => panic!(),\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+error: to use a constant of type `consts::CustomEq` in a pattern, `consts::CustomEq` must be annotated with `#[derive(PartialEq, Eq)]`\n+  --> $DIR/cross-crate-fail.rs:13:9\n    |\n LL |         consts::SOME => panic!(),\n    |         ^^^^^^^^^^^^\n \n-error: aborting due to 2 previous errors\n+error: to use a constant of type `consts::CustomEq` in a pattern, `consts::CustomEq` must be annotated with `#[derive(PartialEq, Eq)]`\n+  --> $DIR/cross-crate-fail.rs:21:9\n+   |\n+LL |         <Defaulted as consts::AssocConst>::SOME  => panic!(),\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+error: aborting due to 4 previous errors\n "}, {"sha": "1d8ecf8ae6640e10ac8aef8d87c47e2c8b3b9984", "filename": "src/test/ui/consts/const_in_pattern/cross-crate-pass.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/bcc44b8e025978ae14ff11d484aacbb85aa8eaed/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcross-crate-pass.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bcc44b8e025978ae14ff11d484aacbb85aa8eaed/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcross-crate-pass.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcross-crate-pass.rs?ref=bcc44b8e025978ae14ff11d484aacbb85aa8eaed", "patch": "@@ -6,9 +6,18 @@\n extern crate consts;\n use consts::CustomEq;\n \n+struct Defaulted;\n+impl consts::AssocConst for Defaulted {}\n+\n fn main() {\n+    let _ = Defaulted;\n     match Some(CustomEq) {\n         consts::NONE => panic!(),\n         _ => {}\n     }\n+\n+    match Some(CustomEq) {\n+        <Defaulted as consts::AssocConst>::NONE  => panic!(),\n+        _ => {}\n+    }\n }"}]}