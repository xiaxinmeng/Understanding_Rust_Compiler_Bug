{"sha": "872f3213f21a5efb622115ec9e63e0fe5350b266", "node_id": "C_kwDOAAsO6NoAKDg3MmYzMjEzZjIxYTVlZmI2MjIxMTVlYzllNjNlMGZlNTM1MGIyNjY", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-10-07T09:49:19Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-10-07T09:49:19Z"}, "message": "Auto merge of #7782 - dswij:shadow-unrelated-block, r=flip1995\n\nMake `shadow_reuse` suggestion less verbose\n\nCloses #7764\n\nMake `shadow_reuse` suggestion less verbose.\n\nchangelog: [`shadow_reuse`] does not warn shadowing statement", "tree": {"sha": "ffc8d25e8b20bfb5adbd88f6cdd84c17c9adf552", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ffc8d25e8b20bfb5adbd88f6cdd84c17c9adf552"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/872f3213f21a5efb622115ec9e63e0fe5350b266", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/872f3213f21a5efb622115ec9e63e0fe5350b266", "html_url": "https://github.com/rust-lang/rust/commit/872f3213f21a5efb622115ec9e63e0fe5350b266", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/872f3213f21a5efb622115ec9e63e0fe5350b266/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a04a7cd9f96464b2300af5881a53bb6d1a905cb4", "url": "https://api.github.com/repos/rust-lang/rust/commits/a04a7cd9f96464b2300af5881a53bb6d1a905cb4", "html_url": "https://github.com/rust-lang/rust/commit/a04a7cd9f96464b2300af5881a53bb6d1a905cb4"}, {"sha": "64f8b9d0eac0b3c25c74462bfbe5086feb4264e8", "url": "https://api.github.com/repos/rust-lang/rust/commits/64f8b9d0eac0b3c25c74462bfbe5086feb4264e8", "html_url": "https://github.com/rust-lang/rust/commit/64f8b9d0eac0b3c25c74462bfbe5086feb4264e8"}], "stats": {"total": 71, "additions": 42, "deletions": 29}, "files": [{"sha": "64841f33cc385afa389801c7ab9f19d2d3032514", "filename": "clippy_lints/src/shadow.rs", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/872f3213f21a5efb622115ec9e63e0fe5350b266/clippy_lints%2Fsrc%2Fshadow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/872f3213f21a5efb622115ec9e63e0fe5350b266/clippy_lints%2Fsrc%2Fshadow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fshadow.rs?ref=872f3213f21a5efb622115ec9e63e0fe5350b266", "patch": "@@ -162,11 +162,7 @@ fn lint_shadow(cx: &LateContext<'_>, pat: &Pat<'_>, shadowed: HirId, span: Span)\n             (SHADOW_SAME, msg)\n         },\n         Some(expr) if is_local_used(cx, expr, shadowed) => {\n-            let msg = format!(\n-                \"`{}` is shadowed by `{}` which reuses the original value\",\n-                snippet(cx, pat.span, \"_\"),\n-                snippet(cx, expr.span, \"..\")\n-            );\n+            let msg = format!(\"`{}` is shadowed\", snippet(cx, pat.span, \"_\"));\n             (SHADOW_REUSE, msg)\n         },\n         _ => {"}, {"sha": "55caef59f7f683f5509412a2065391fb211f4c03", "filename": "tests/ui/shadow.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/872f3213f21a5efb622115ec9e63e0fe5350b266/tests%2Fui%2Fshadow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/872f3213f21a5efb622115ec9e63e0fe5350b266/tests%2Fui%2Fshadow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fshadow.rs?ref=872f3213f21a5efb622115ec9e63e0fe5350b266", "patch": "@@ -17,6 +17,11 @@ fn shadow_reuse() -> Option<()> {\n     let x = foo(x);\n     let x = || x;\n     let x = Some(1).map(|_| x)?;\n+    let y = 1;\n+    let y = match y {\n+        1 => 2,\n+        _ => 3,\n+    };\n     None\n }\n "}, {"sha": "feed6e1ba8b8660ff2f73dc71a956fb135c62235", "filename": "tests/ui/shadow.stderr", "status": "modified", "additions": 36, "deletions": 24, "changes": 60, "blob_url": "https://github.com/rust-lang/rust/blob/872f3213f21a5efb622115ec9e63e0fe5350b266/tests%2Fui%2Fshadow.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/872f3213f21a5efb622115ec9e63e0fe5350b266/tests%2Fui%2Fshadow.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fshadow.stderr?ref=872f3213f21a5efb622115ec9e63e0fe5350b266", "patch": "@@ -47,7 +47,7 @@ note: previous binding is here\n LL |     let x = &mut x;\n    |         ^\n \n-error: `x` is shadowed by `x.0` which reuses the original value\n+error: `x` is shadowed\n   --> $DIR/shadow.rs:13:9\n    |\n LL |     let x = x.0;\n@@ -60,7 +60,7 @@ note: previous binding is here\n LL |     let x = ([[0]], ());\n    |         ^\n \n-error: `x` is shadowed by `x[0]` which reuses the original value\n+error: `x` is shadowed\n   --> $DIR/shadow.rs:14:9\n    |\n LL |     let x = x[0];\n@@ -72,7 +72,7 @@ note: previous binding is here\n LL |     let x = x.0;\n    |         ^\n \n-error: `x` is shadowed by `x` which reuses the original value\n+error: `x` is shadowed\n   --> $DIR/shadow.rs:15:10\n    |\n LL |     let [x] = x;\n@@ -84,7 +84,7 @@ note: previous binding is here\n LL |     let x = x[0];\n    |         ^\n \n-error: `x` is shadowed by `Some(x)` which reuses the original value\n+error: `x` is shadowed\n   --> $DIR/shadow.rs:16:9\n    |\n LL |     let x = Some(x);\n@@ -96,7 +96,7 @@ note: previous binding is here\n LL |     let [x] = x;\n    |          ^\n \n-error: `x` is shadowed by `foo(x)` which reuses the original value\n+error: `x` is shadowed\n   --> $DIR/shadow.rs:17:9\n    |\n LL |     let x = foo(x);\n@@ -108,7 +108,7 @@ note: previous binding is here\n LL |     let x = Some(x);\n    |         ^\n \n-error: `x` is shadowed by `|| x` which reuses the original value\n+error: `x` is shadowed\n   --> $DIR/shadow.rs:18:9\n    |\n LL |     let x = || x;\n@@ -120,7 +120,7 @@ note: previous binding is here\n LL |     let x = foo(x);\n    |         ^\n \n-error: `x` is shadowed by `Some(1).map(|_| x)?` which reuses the original value\n+error: `x` is shadowed\n   --> $DIR/shadow.rs:19:9\n    |\n LL |     let x = Some(1).map(|_| x)?;\n@@ -132,102 +132,114 @@ note: previous binding is here\n LL |     let x = || x;\n    |         ^\n \n+error: `y` is shadowed\n+  --> $DIR/shadow.rs:21:9\n+   |\n+LL |     let y = match y {\n+   |         ^\n+   |\n+note: previous binding is here\n+  --> $DIR/shadow.rs:20:9\n+   |\n+LL |     let y = 1;\n+   |         ^\n+\n error: `x` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:25:9\n+  --> $DIR/shadow.rs:30:9\n    |\n LL |     let x = 2;\n    |         ^\n    |\n    = note: `-D clippy::shadow-unrelated` implied by `-D warnings`\n note: previous binding is here\n-  --> $DIR/shadow.rs:24:9\n+  --> $DIR/shadow.rs:29:9\n    |\n LL |     let x = 1;\n    |         ^\n \n error: `x` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:30:13\n+  --> $DIR/shadow.rs:35:13\n    |\n LL |         let x = 1;\n    |             ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:29:10\n+  --> $DIR/shadow.rs:34:10\n    |\n LL |     fn f(x: u32) {\n    |          ^\n \n error: `x` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:35:14\n+  --> $DIR/shadow.rs:40:14\n    |\n LL |         Some(x) => {\n    |              ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:32:9\n+  --> $DIR/shadow.rs:37:9\n    |\n LL |     let x = 1;\n    |         ^\n \n error: `x` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:36:17\n+  --> $DIR/shadow.rs:41:17\n    |\n LL |             let x = 1;\n    |                 ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:35:14\n+  --> $DIR/shadow.rs:40:14\n    |\n LL |         Some(x) => {\n    |              ^\n \n error: `x` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:40:17\n+  --> $DIR/shadow.rs:45:17\n    |\n LL |     if let Some(x) = Some(1) {}\n    |                 ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:32:9\n+  --> $DIR/shadow.rs:37:9\n    |\n LL |     let x = 1;\n    |         ^\n \n error: `x` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:41:20\n+  --> $DIR/shadow.rs:46:20\n    |\n LL |     while let Some(x) = Some(1) {}\n    |                    ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:32:9\n+  --> $DIR/shadow.rs:37:9\n    |\n LL |     let x = 1;\n    |         ^\n \n error: `x` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:42:15\n+  --> $DIR/shadow.rs:47:15\n    |\n LL |     let _ = |[x]: [u32; 1]| {\n    |               ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:32:9\n+  --> $DIR/shadow.rs:37:9\n    |\n LL |     let x = 1;\n    |         ^\n \n error: `x` shadows a previous, unrelated binding\n-  --> $DIR/shadow.rs:43:13\n+  --> $DIR/shadow.rs:48:13\n    |\n LL |         let x = 1;\n    |             ^\n    |\n note: previous binding is here\n-  --> $DIR/shadow.rs:42:15\n+  --> $DIR/shadow.rs:47:15\n    |\n LL |     let _ = |[x]: [u32; 1]| {\n    |               ^\n \n-error: aborting due to 19 previous errors\n+error: aborting due to 20 previous errors\n "}]}