{"sha": "e12d682dde0adbbde3d49dd202b223deb1ceec89", "node_id": "MDY6Q29tbWl0NzI0NzEyOmUxMmQ2ODJkZGUwYWRiYmRlM2Q0OWRkMjAyYjIyM2RlYjFjZWVjODk=", "commit": {"author": {"name": "Zack M. Davis", "email": "code@zackmdavis.net", "date": "2019-07-06T20:20:35Z"}, "committer": {"name": "Zack M. Davis", "email": "code@zackmdavis.net", "date": "2019-07-06T22:04:18Z"}, "message": "path-type examples for single-use lifetime in fn argument UI test\n\nNiko Matsakis commented in October 2017\n(https://github.com/rust-lang/rust/issues/44752#issuecomment-340885834)\nthat these should lint. They do! Let's reify that in the tests now\n(and then we'll see a nice diff when we add suggestions in a future\ncommit).", "tree": {"sha": "7c61f80c824798d6929b2796fb739906ac361bdf", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7c61f80c824798d6929b2796fb739906ac361bdf"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e12d682dde0adbbde3d49dd202b223deb1ceec89", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e12d682dde0adbbde3d49dd202b223deb1ceec89", "html_url": "https://github.com/rust-lang/rust/commit/e12d682dde0adbbde3d49dd202b223deb1ceec89", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e12d682dde0adbbde3d49dd202b223deb1ceec89/comments", "author": {"login": "zackmdavis", "id": 1076988, "node_id": "MDQ6VXNlcjEwNzY5ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1076988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zackmdavis", "html_url": "https://github.com/zackmdavis", "followers_url": "https://api.github.com/users/zackmdavis/followers", "following_url": "https://api.github.com/users/zackmdavis/following{/other_user}", "gists_url": "https://api.github.com/users/zackmdavis/gists{/gist_id}", "starred_url": "https://api.github.com/users/zackmdavis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zackmdavis/subscriptions", "organizations_url": "https://api.github.com/users/zackmdavis/orgs", "repos_url": "https://api.github.com/users/zackmdavis/repos", "events_url": "https://api.github.com/users/zackmdavis/events{/privacy}", "received_events_url": "https://api.github.com/users/zackmdavis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "zackmdavis", "id": 1076988, "node_id": "MDQ6VXNlcjEwNzY5ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1076988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zackmdavis", "html_url": "https://github.com/zackmdavis", "followers_url": "https://api.github.com/users/zackmdavis/followers", "following_url": "https://api.github.com/users/zackmdavis/following{/other_user}", "gists_url": "https://api.github.com/users/zackmdavis/gists{/gist_id}", "starred_url": "https://api.github.com/users/zackmdavis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zackmdavis/subscriptions", "organizations_url": "https://api.github.com/users/zackmdavis/orgs", "repos_url": "https://api.github.com/users/zackmdavis/repos", "events_url": "https://api.github.com/users/zackmdavis/events{/privacy}", "received_events_url": "https://api.github.com/users/zackmdavis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dfd52ba6ac2262c6b61c59ec86bfd23e4e53d3de", "url": "https://api.github.com/repos/rust-lang/rust/commits/dfd52ba6ac2262c6b61c59ec86bfd23e4e53d3de", "html_url": "https://github.com/rust-lang/rust/commit/dfd52ba6ac2262c6b61c59ec86bfd23e4e53d3de"}], "stats": {"total": 29, "additions": 28, "deletions": 1}, "files": [{"sha": "60435c4ad2436d9ea61c07e3f03791891b9bd361", "filename": "src/test/ui/single-use-lifetime/one-use-in-fn-argument.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/e12d682dde0adbbde3d49dd202b223deb1ceec89/src%2Ftest%2Fui%2Fsingle-use-lifetime%2Fone-use-in-fn-argument.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e12d682dde0adbbde3d49dd202b223deb1ceec89/src%2Ftest%2Fui%2Fsingle-use-lifetime%2Fone-use-in-fn-argument.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsingle-use-lifetime%2Fone-use-in-fn-argument.rs?ref=e12d682dde0adbbde3d49dd202b223deb1ceec89", "patch": "@@ -9,4 +9,11 @@ fn a<'a>(x: &'a u32) { //~ ERROR `'a` only used once\n     //~^ HELP elide the single-use lifetime\n }\n \n+struct Single<'a> { x: &'a u32 }\n+struct Double<'a, 'b> { f: &'a &'b u32 }\n+\n+fn center<'m>(_: Single<'m>) {} //~ ERROR `'m` only used once\n+fn left<'x, 'y>(foo: Double<'x, 'y>) -> &'x u32 { foo.f } //~ ERROR `'y` only used once\n+fn right<'x, 'y>(foo: Double<'x, 'y>) -> &'y u32 { foo.f } //~ ERROR `'x` only used once\n+\n fn main() { }"}, {"sha": "e8513e6647a5e6a7513a3b022d489c94a48fa298", "filename": "src/test/ui/single-use-lifetime/one-use-in-fn-argument.stderr", "status": "modified", "additions": 21, "deletions": 1, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/e12d682dde0adbbde3d49dd202b223deb1ceec89/src%2Ftest%2Fui%2Fsingle-use-lifetime%2Fone-use-in-fn-argument.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e12d682dde0adbbde3d49dd202b223deb1ceec89/src%2Ftest%2Fui%2Fsingle-use-lifetime%2Fone-use-in-fn-argument.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsingle-use-lifetime%2Fone-use-in-fn-argument.stderr?ref=e12d682dde0adbbde3d49dd202b223deb1ceec89", "patch": "@@ -16,5 +16,25 @@ help: elide the single-use lifetime\n LL | fn a(x: &u32) {\n    |    --   --\n \n-error: aborting due to previous error\n+error: lifetime parameter `'m` only used once\n+  --> $DIR/one-use-in-fn-argument.rs:15:11\n+   |\n+LL | fn center<'m>(_: Single<'m>) {}\n+   |           ^^            -- ...is used only here\n+   |           |\n+   |           this lifetime...\n+\n+error: lifetime parameter `'y` only used once\n+  --> $DIR/one-use-in-fn-argument.rs:16:13\n+   |\n+LL | fn left<'x, 'y>(foo: Double<'x, 'y>) -> &'x u32 { foo.f }\n+   |             ^^ this lifetime... -- ...is used only here\n+\n+error: lifetime parameter `'x` only used once\n+  --> $DIR/one-use-in-fn-argument.rs:17:10\n+   |\n+LL | fn right<'x, 'y>(foo: Double<'x, 'y>) -> &'y u32 { foo.f }\n+   |          ^^ this lifetime... -- ...is used only here\n+\n+error: aborting due to 4 previous errors\n "}]}