{"sha": "657eefe2dcf18f76ac67a39945810128e101178c", "node_id": "C_kwDOAAsO6NoAKDY1N2VlZmUyZGNmMThmNzZhYzY3YTM5OTQ1ODEwMTI4ZTEwMTE3OGM", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-12-11T17:37:12Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-12-11T17:37:12Z"}, "message": "Auto merge of #103591 - lqd:win-lto, r=Mark-Simulacrum\n\nEnable ThinLTO for rustc on x64 msvc\n\nThis applies the great work from `@bjorn3` and `@Kobzol` in https://github.com/rust-lang/rust/pull/101403 to x64 msvc.\n\nHere are the local results for the try build `68c5c85ed759334a11f0b0e586f5032a23f85ce4`, compared to its parent `0a6b941df354c59b546ec4c0d27f2b9b0cb1162c`. Looking better than my previous local builds.\n\n![image](https://user-images.githubusercontent.com/247183/198158039-98ebac0e-da0e-462e-8162-95e88345edb9.png)\n\n(I can't show cycle counts, as that option is failing on the windows version of the perf collector, but I'll try to analyze and debug this soon)\n\nThis will be the first of a few tests for rustc / llvm / both ThinLTO on the windows and mac targets.", "tree": {"sha": "512f01e09d120ede3fd311bef30ce60ba6a90000", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/512f01e09d120ede3fd311bef30ce60ba6a90000"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/657eefe2dcf18f76ac67a39945810128e101178c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/657eefe2dcf18f76ac67a39945810128e101178c", "html_url": "https://github.com/rust-lang/rust/commit/657eefe2dcf18f76ac67a39945810128e101178c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/657eefe2dcf18f76ac67a39945810128e101178c/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d137783642b0b98eda2796dc66bffc2b089a8327", "url": "https://api.github.com/repos/rust-lang/rust/commits/d137783642b0b98eda2796dc66bffc2b089a8327", "html_url": "https://github.com/rust-lang/rust/commit/d137783642b0b98eda2796dc66bffc2b089a8327"}, {"sha": "684663ed380d0e6a6e135aed9c6055ab4ba94ac8", "url": "https://api.github.com/repos/rust-lang/rust/commits/684663ed380d0e6a6e135aed9c6055ab4ba94ac8", "html_url": "https://github.com/rust-lang/rust/commit/684663ed380d0e6a6e135aed9c6055ab4ba94ac8"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "b29b3a418038ee4407809a38b67f67b7dcf3a010", "filename": ".github/workflows/ci.yml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/657eefe2dcf18f76ac67a39945810128e101178c/.github%2Fworkflows%2Fci.yml", "raw_url": "https://github.com/rust-lang/rust/raw/657eefe2dcf18f76ac67a39945810128e101178c/.github%2Fworkflows%2Fci.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fci.yml?ref=657eefe2dcf18f76ac67a39945810128e101178c", "patch": "@@ -430,7 +430,7 @@ jobs:\n             os: windows-latest-xl\n           - name: dist-x86_64-msvc\n             env:\n-              RUST_CONFIGURE_ARGS: \"--build=x86_64-pc-windows-msvc --host=x86_64-pc-windows-msvc --target=x86_64-pc-windows-msvc --enable-full-tools --enable-profiler\"\n+              RUST_CONFIGURE_ARGS: \"--build=x86_64-pc-windows-msvc --host=x86_64-pc-windows-msvc --target=x86_64-pc-windows-msvc --enable-full-tools --enable-profiler --set rust.lto=thin\"\n               SCRIPT: PGO_HOST=x86_64-pc-windows-msvc src/ci/pgo.sh python x.py dist bootstrap --include-default-paths\n               DIST_REQUIRE_ALL_TOOLS: 1\n             os: windows-latest-xl"}, {"sha": "5a0397a3d123cf714bb63dbf40b4a87a9ae9f69a", "filename": "src/ci/github-actions/ci.yml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/657eefe2dcf18f76ac67a39945810128e101178c/src%2Fci%2Fgithub-actions%2Fci.yml", "raw_url": "https://github.com/rust-lang/rust/raw/657eefe2dcf18f76ac67a39945810128e101178c/src%2Fci%2Fgithub-actions%2Fci.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fgithub-actions%2Fci.yml?ref=657eefe2dcf18f76ac67a39945810128e101178c", "patch": "@@ -667,6 +667,7 @@ jobs:\n                 --target=x86_64-pc-windows-msvc\n                 --enable-full-tools\n                 --enable-profiler\n+                --set rust.lto=thin\n               SCRIPT: PGO_HOST=x86_64-pc-windows-msvc src/ci/pgo.sh python x.py dist bootstrap --include-default-paths\n               DIST_REQUIRE_ALL_TOOLS: 1\n             <<: *job-windows-xl"}]}