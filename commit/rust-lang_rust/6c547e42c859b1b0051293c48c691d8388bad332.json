{"sha": "6c547e42c859b1b0051293c48c691d8388bad332", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZjNTQ3ZTQyYzg1OWIxYjAwNTEyOTNjNDhjNjkxZDgzODhiYWQzMzI=", "commit": {"author": {"name": "Daniel Micay", "email": "danielmicay@gmail.com", "date": "2013-06-15T06:20:06Z"}, "committer": {"name": "Daniel Micay", "email": "danielmicay@gmail.com", "date": "2013-06-16T02:16:21Z"}, "message": "rm vec::uniq_len", "tree": {"sha": "64638dae2106c6be15acd78116c11dc5a76007ea", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/64638dae2106c6be15acd78116c11dc5a76007ea"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6c547e42c859b1b0051293c48c691d8388bad332", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6c547e42c859b1b0051293c48c691d8388bad332", "html_url": "https://github.com/rust-lang/rust/commit/6c547e42c859b1b0051293c48c691d8388bad332", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6c547e42c859b1b0051293c48c691d8388bad332/comments", "author": {"login": "thestinger", "id": 1505226, "node_id": "MDQ6VXNlcjE1MDUyMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thestinger", "html_url": "https://github.com/thestinger", "followers_url": "https://api.github.com/users/thestinger/followers", "following_url": "https://api.github.com/users/thestinger/following{/other_user}", "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}", "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions", "organizations_url": "https://api.github.com/users/thestinger/orgs", "repos_url": "https://api.github.com/users/thestinger/repos", "events_url": "https://api.github.com/users/thestinger/events{/privacy}", "received_events_url": "https://api.github.com/users/thestinger/received_events", "type": "User", "site_admin": false}, "committer": {"login": "thestinger", "id": 1505226, "node_id": "MDQ6VXNlcjE1MDUyMjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1505226?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thestinger", "html_url": "https://github.com/thestinger", "followers_url": "https://api.github.com/users/thestinger/followers", "following_url": "https://api.github.com/users/thestinger/following{/other_user}", "gists_url": "https://api.github.com/users/thestinger/gists{/gist_id}", "starred_url": "https://api.github.com/users/thestinger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thestinger/subscriptions", "organizations_url": "https://api.github.com/users/thestinger/orgs", "repos_url": "https://api.github.com/users/thestinger/repos", "events_url": "https://api.github.com/users/thestinger/events{/privacy}", "received_events_url": "https://api.github.com/users/thestinger/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c989b79127c5062df0a64d8c383de93c82a3d9b7", "url": "https://api.github.com/repos/rust-lang/rust/commits/c989b79127c5062df0a64d8c383de93c82a3d9b7", "html_url": "https://github.com/rust-lang/rust/commit/c989b79127c5062df0a64d8c383de93c82a3d9b7"}], "stats": {"total": 75, "additions": 39, "deletions": 36}, "files": [{"sha": "4ff67fc3f42c297580b9a3bef3f09402ffc63a7a", "filename": "src/libextra/flatpipes.rs", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibextra%2Fflatpipes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibextra%2Fflatpipes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibextra%2Fflatpipes.rs?ref=6c547e42c859b1b0051293c48c691d8388bad332", "patch": "@@ -583,12 +583,12 @@ pub mod bytepipes {\n \n     impl BytePort for PipeBytePort {\n         fn try_recv(&self, count: uint) -> Option<~[u8]> {\n-            if vec::uniq_len(&const *self.buf) >= count {\n+            if self.buf.len() >= count {\n                 let mut bytes = ::core::util::replace(&mut *self.buf, ~[]);\n                 *self.buf = bytes.slice(count, bytes.len()).to_owned();\n                 bytes.truncate(count);\n                 return Some(bytes);\n-            } else if vec::uniq_len(&const *self.buf) > 0 {\n+            } else if !self.buf.is_empty() {\n                 let mut bytes = ::core::util::replace(&mut *self.buf, ~[]);\n                 assert!(count > bytes.len());\n                 match self.try_recv(count - bytes.len()) {\n@@ -598,7 +598,7 @@ pub mod bytepipes {\n                     }\n                     None => return None\n                 }\n-            } else if vec::uniq_len(&const *self.buf) == 0 {\n+            } else /* empty */ {\n                 match self.port.try_recv() {\n                     Some(buf) => {\n                         assert!(!buf.is_empty());\n@@ -607,8 +607,6 @@ pub mod bytepipes {\n                     }\n                     None => return None\n                 }\n-            } else {\n-                ::core::util::unreachable()\n             }\n         }\n     }"}, {"sha": "28b3700399a6e5cb89e205e9c7dc259a3d33cf8c", "filename": "src/libextra/net_tcp.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibextra%2Fnet_tcp.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibextra%2Fnet_tcp.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibextra%2Fnet_tcp.rs?ref=6c547e42c859b1b0051293c48c691d8388bad332", "patch": "@@ -879,8 +879,7 @@ impl io::Reader for TcpSocketBuf {\n \n           // If possible, copy up to `len` bytes from the internal\n           // `data.buf` into `buf`\n-          let nbuffered = vec::uniq_len(&const self.data.buf) -\n-                self.data.buf_off;\n+          let nbuffered = self.data.buf.len() - self.data.buf_off;\n           let needed = len - count;\n             if nbuffered > 0 {\n                 unsafe {\n@@ -934,7 +933,7 @@ impl io::Reader for TcpSocketBuf {\n     }\n     fn read_byte(&self) -> int {\n         loop {\n-          if vec::uniq_len(&const self.data.buf) > self.data.buf_off {\n+          if self.data.buf.len() > self.data.buf_off {\n             let c = self.data.buf[self.data.buf_off];\n             self.data.buf_off += 1;\n             return c as int"}, {"sha": "efbf23f11b15c3ffb86c8ac3cd9068927fe8a5db", "filename": "src/libextra/priority_queue.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibextra%2Fpriority_queue.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibextra%2Fpriority_queue.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibextra%2Fpriority_queue.rs?ref=6c547e42c859b1b0051293c48c691d8388bad332", "patch": "@@ -35,10 +35,10 @@ impl<T:Ord> BaseIter<T> for PriorityQueue<T> {\n \n impl<T:Ord> Container for PriorityQueue<T> {\n     /// Returns the length of the queue\n-    fn len(&const self) -> uint { vec::uniq_len(&const self.data) }\n+    fn len(&self) -> uint { self.data.len() }\n \n     /// Returns true if a queue contains no elements\n-    fn is_empty(&const self) -> bool { self.len() == 0 }\n+    fn is_empty(&self) -> bool { self.len() == 0 }\n }\n \n impl<T:Ord> Mutable for PriorityQueue<T> {"}, {"sha": "0c35630345b4dfbc2102f9e9ab692290904f717b", "filename": "src/libextra/sha1.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibextra%2Fsha1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibextra%2Fsha1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibextra%2Fsha1.rs?ref=6c547e42c859b1b0051293c48c691d8388bad332", "patch": "@@ -93,7 +93,7 @@ pub fn sha1() -> @Sha1 {\n     }\n     fn process_msg_block(st: &mut Sha1State) {\n         assert_eq!(st.h.len(), digest_buf_len);\n-        assert_eq!(vec::uniq_len(st.work_buf), work_buf_len);\n+        assert_eq!(st.work_buf.len(), work_buf_len);\n         let mut t: int; // Loop counter\n         let w = st.work_buf;\n "}, {"sha": "dae9113b3a9dabb1113277f2b2d13ec7950144ef", "filename": "src/libextra/smallintmap.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibextra%2Fsmallintmap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibextra%2Fsmallintmap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibextra%2Fsmallintmap.rs?ref=6c547e42c859b1b0051293c48c691d8388bad332", "patch": "@@ -32,9 +32,9 @@ pub struct SmallIntMap<T> {\n \n impl<V> Container for SmallIntMap<V> {\n     /// Return the number of elements in the map\n-    fn len(&const self) -> uint {\n+    fn len(&self) -> uint {\n         let mut sz = 0;\n-        for uint::range(0, vec::uniq_len(&const self.v)) |i| {\n+        for uint::range(0, self.v.len()) |i| {\n             match self.v[i] {\n                 Some(_) => sz += 1,\n                 None => {}\n@@ -44,7 +44,7 @@ impl<V> Container for SmallIntMap<V> {\n     }\n \n     /// Return true if the map contains no elements\n-    fn is_empty(&const self) -> bool { self.len() == 0 }\n+    fn is_empty(&self) -> bool { self.len() == 0 }\n }\n \n impl<V> Mutable for SmallIntMap<V> {\n@@ -199,12 +199,12 @@ pub struct SmallIntSet {\n \n impl Container for SmallIntSet {\n     /// Return the number of elements in the map\n-    fn len(&const self) -> uint {\n+    fn len(&self) -> uint {\n         self.map.len()\n     }\n \n     /// Return true if the map contains no elements\n-    fn is_empty(&const self) -> bool { self.len() == 0 }\n+    fn is_empty(&self) -> bool { self.len() == 0 }\n }\n \n impl Mutable for SmallIntSet {"}, {"sha": "a465cef09e6be68fac89b59c32e072283db802e3", "filename": "src/libextra/test.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibextra%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibextra%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibextra%2Ftest.rs?ref=6c547e42c859b1b0051293c48c691d8388bad332", "patch": "@@ -365,7 +365,7 @@ pub fn run_tests_console(opts: &TestOpts,\n fn print_failures(st: &ConsoleTestState) {\n     st.out.write_line(\"\\nfailures:\");\n     let mut failures = ~[];\n-    for uint::range(0, vec::uniq_len(&const st.failures)) |i| {\n+    for uint::range(0, st.failures.len()) |i| {\n         let name = copy st.failures[i].name;\n         failures.push(name.to_str());\n     }"}, {"sha": "bcdd6cd0bfa60cd9faf7e1825c75ea16c82d41ea", "filename": "src/libstd/comm.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibstd%2Fcomm.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibstd%2Fcomm.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fcomm.rs?ref=6c547e42c859b1b0051293c48c691d8388bad332", "patch": "@@ -209,7 +209,7 @@ impl<T: Owned> Peekable<T> for PortSet<T> {\n     fn peek(&self) -> bool {\n         // It'd be nice to use self.port.each, but that version isn't\n         // pure.\n-        for uint::range(0, vec::uniq_len(&const self.ports)) |i| {\n+        for uint::range(0, self.ports.len()) |i| {\n             let port: &pipesy::Port<T> = &self.ports[i];\n             if port.peek() {\n                 return true;"}, {"sha": "c1b656f1cd9e6bdc71d818d01f069053bef373d5", "filename": "src/libstd/container.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibstd%2Fcontainer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibstd%2Fcontainer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fcontainer.rs?ref=6c547e42c859b1b0051293c48c691d8388bad332", "patch": "@@ -16,10 +16,10 @@ use option::Option;\n /// knowledge known is the number of elements contained within.\n pub trait Container {\n     /// Return the number of elements in the container\n-    fn len(&const self) -> uint;\n+    fn len(&self) -> uint;\n \n     /// Return true if the container contains no elements\n-    fn is_empty(&const self) -> bool;\n+    fn is_empty(&self) -> bool;\n }\n \n /// A trait to represent mutable containers"}, {"sha": "d3faa75e3b044f4b67bd0bd46545f313261b5955", "filename": "src/libstd/io.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibstd%2Fio.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibstd%2Fio.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fio.rs?ref=6c547e42c859b1b0051293c48c691d8388bad332", "patch": "@@ -1667,7 +1667,7 @@ impl Writer for BytesWriter {\n \n     fn seek(&self, offset: int, whence: SeekStyle) {\n         let pos = *self.pos;\n-        let len = vec::uniq_len(&const *self.bytes);\n+        let len = self.bytes.len();\n         *self.pos = seek_in_buf(offset, pos, len, whence);\n     }\n "}, {"sha": "b7ff1acea139430ecec443e7783e81bf4fcc3c9c", "filename": "src/libstd/repr.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibstd%2Frepr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibstd%2Frepr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Frepr.rs?ref=6c547e42c859b1b0051293c48c691d8388bad332", "patch": "@@ -18,6 +18,7 @@ More runtime type reflection\n \n use cast::transmute;\n use char;\n+use container::Container;\n use intrinsic;\n use intrinsic::{TyDesc, TyVisitor, visit_tydesc};\n use intrinsic::Opaque;\n@@ -502,7 +503,7 @@ impl TyVisitor for ReprVisitor {\n                                 _offset: uint,\n                                 inner: *TyDesc)\n                                 -> bool {\n-        match self.var_stk[vec::uniq_len(&const *self.var_stk) - 1] {\n+        match self.var_stk[self.var_stk.len() - 1] {\n             Matched => {\n                 if i != 0 {\n                     self.writer.write_str(\", \");\n@@ -520,7 +521,7 @@ impl TyVisitor for ReprVisitor {\n                                 _disr_val: int,\n                                 n_fields: uint,\n                                 _name: &str) -> bool {\n-        match self.var_stk[vec::uniq_len(&const *self.var_stk) - 1] {\n+        match self.var_stk[self.var_stk.len() - 1] {\n             Matched => {\n                 if n_fields > 0 {\n                     self.writer.write_char(')');"}, {"sha": "a5e68bcdac4cf2217b6d587608f430867562fd5c", "filename": "src/libstd/rt/io/extensions.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibstd%2Frt%2Fio%2Fextensions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibstd%2Frt%2Fio%2Fextensions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Frt%2Fio%2Fextensions.rs?ref=6c547e42c859b1b0051293c48c691d8388bad332", "patch": "@@ -297,7 +297,8 @@ impl<T: Reader> ReaderUtil for T {\n \n             do (|| {\n                 while total_read < len {\n-                    let slice = vec::mut_slice(*buf, start_len + total_read, buf.len());\n+                    let len = buf.len();\n+                    let slice = vec::mut_slice(*buf, start_len + total_read, len);\n                     match self.read(slice) {\n                         Some(nread) => {\n                             total_read += nread;"}, {"sha": "44f3fc4c321219c7c6deb83e0cd3d9c9955c6633", "filename": "src/libstd/vec.rs", "status": "modified", "additions": 16, "deletions": 12, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibstd%2Fvec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c547e42c859b1b0051293c48c691d8388bad332/src%2Flibstd%2Fvec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fvec.rs?ref=6c547e42c859b1b0051293c48c691d8388bad332", "patch": "@@ -118,15 +118,6 @@ pub fn capacity<T>(v: &const ~[T]) -> uint {\n     }\n }\n \n-// A botch to tide us over until core and std are fully demuted.\n-#[allow(missing_doc)]\n-pub fn uniq_len<T>(v: &const ~[T]) -> uint {\n-    unsafe {\n-        let v: &~[T] = transmute(v);\n-        as_const_buf(*v, |_p, len| len)\n-    }\n-}\n-\n /**\n  * Creates and initializes an owned vector.\n  *\n@@ -1767,19 +1758,32 @@ pub mod traits {\n     }\n }\n \n-impl<'self,T> Container for &'self const [T] {\n+impl<'self, T> Container for &'self const [T] {\n     /// Returns true if a vector contains no elements\n     #[inline]\n-    fn is_empty(&const self) -> bool {\n+    fn is_empty(&self) -> bool {\n         as_const_buf(*self, |_p, len| len == 0u)\n     }\n \n     /// Returns the length of a vector\n     #[inline]\n-    fn len(&const self) -> uint {\n+    fn len(&self) -> uint {\n         as_const_buf(*self, |_p, len| len)\n     }\n+}\n \n+impl<T> Container for ~[T] {\n+    /// Returns true if a vector contains no elements\n+    #[inline]\n+    fn is_empty(&self) -> bool {\n+        as_const_buf(*self, |_p, len| len == 0u)\n+    }\n+\n+    /// Returns the length of a vector\n+    #[inline]\n+    fn len(&self) -> uint {\n+        as_const_buf(*self, |_p, len| len)\n+    }\n }\n \n #[allow(missing_doc)]"}]}