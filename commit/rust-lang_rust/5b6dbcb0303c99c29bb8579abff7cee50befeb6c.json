{"sha": "5b6dbcb0303c99c29bb8579abff7cee50befeb6c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjViNmRiY2IwMzAzYzk5YzI5YmI4NTc5YWJmZjdjZWU1MGJlZmViNmM=", "commit": {"author": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2011-09-30T01:36:27Z"}, "committer": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2011-09-30T01:36:27Z"}, "message": "stdlib: Un-export str::buf; add a comment", "tree": {"sha": "50ad15d769fe5b39f71f180a9564f5d45671834e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/50ad15d769fe5b39f71f180a9564f5d45671834e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5b6dbcb0303c99c29bb8579abff7cee50befeb6c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5b6dbcb0303c99c29bb8579abff7cee50befeb6c", "html_url": "https://github.com/rust-lang/rust/commit/5b6dbcb0303c99c29bb8579abff7cee50befeb6c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5b6dbcb0303c99c29bb8579abff7cee50befeb6c/comments", "author": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3be6cf7ab24ec496443a6fa4cb14cd463cf2f587", "url": "https://api.github.com/repos/rust-lang/rust/commits/3be6cf7ab24ec496443a6fa4cb14cd463cf2f587", "html_url": "https://github.com/rust-lang/rust/commit/3be6cf7ab24ec496443a6fa4cb14cd463cf2f587"}], "stats": {"total": 5, "additions": 3, "deletions": 2}, "files": [{"sha": "39e905f8c96db2368100bbef448264d7ea5ff9de", "filename": "src/lib/str.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5b6dbcb0303c99c29bb8579abff7cee50befeb6c/src%2Flib%2Fstr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5b6dbcb0303c99c29bb8579abff7cee50befeb6c/src%2Flib%2Fstr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib%2Fstr.rs?ref=5b6dbcb0303c99c29bb8579abff7cee50befeb6c", "patch": "@@ -4,8 +4,7 @@ export eq, lteq, hash, is_empty, is_not_empty, is_whitespace, byte_len, index,\n        unshift_char, shift_char, pop_char, push_char, is_utf8, from_chars,\n        to_chars, char_len, char_at, bytes, is_ascii, shift_byte, pop_byte,\n        unsafe_from_byte, unsafe_from_bytes, from_char, char_range_at,\n-       str_from_cstr, sbuf, as_buf, push_byte, utf8_char_width, safe_slice,\n-       buf;\n+       str_from_cstr, sbuf, as_buf, push_byte, utf8_char_width, safe_slice;\n \n native \"rust\" mod rustrt {\n     fn rust_str_push(&s: str, ch: u8);\n@@ -420,6 +419,8 @@ fn trim(s: str) -> str { trim_left(trim_right(s)) }\n \n type sbuf = *u8;\n \n+// NB: This is intentionally unexported because it's easy to misuse (there's\n+// no guarantee that the string is rooted). Instead, use as_buf below.\n fn buf(s: str) -> sbuf {\n     let saddr = ptr::addr_of(s);\n     let vaddr: *[u8] = unsafe::reinterpret_cast(saddr);"}]}