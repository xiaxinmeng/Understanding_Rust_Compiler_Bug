{"sha": "547ce0db274c68869a300b5162c126f95f768dac", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU0N2NlMGRiMjc0YzY4ODY5YTMwMGI1MTYyYzEyNmY5NWY3NjhkYWM=", "commit": {"author": {"name": "flip1995", "email": "philipp.krones@embecosm.com", "date": "2021-01-07T11:38:10Z"}, "committer": {"name": "flip1995", "email": "philipp.krones@embecosm.com", "date": "2021-01-07T11:38:10Z"}, "message": "Change env var used for testing Clippy\n\nThis changes the variable used for testing Clippy in the internal test\nsuite:\n\n```\nCLIPPY_TESTS -> __CLIPPY_INTERNAL_TESTS\n```\n\n`CLIPPY_TESTS` is understandably used in environments of Clippy users,\nso we shouldn't use it in our test suite.", "tree": {"sha": "2321843df9a0bedcb7dbef578fcc574caeb1cb0b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2321843df9a0bedcb7dbef578fcc574caeb1cb0b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/547ce0db274c68869a300b5162c126f95f768dac", "comment_count": 0, "verification": {"verified": false, "reason": "bad_email", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEij1UXJ/PQTcb99vTHKDfKvWdaKUFAl/2/08ACgkQHKDfKvWd\naKV1xBAAv6nAJ+Dd/7zzQDv4pIGC/pKln4YBEmsbYeOTFrIAepqzAwQY74M43sJx\nkgBi3cWmY8hIltYuC3TNIOyjUTfHoZTJ3zi7YjghMNPEnKvjAqQEVbgj9j7zcbzH\nHsFU9ktPhCI8xNufQV6TOsr6KCEZK7/yAeasOXeg3SECBMFu05I/UAeBoGOktawm\nj87LZXhu2pbB8Xf8UKWUcaXFfMvyPZDWHBVIaMEDCLdI13zlRLOWT7Cm50T61UBL\nA4JqvVq3NVHiQpMWVgiUKRtT5srGlihL1VRvN9MeL39xTkQDz0vBM+zNRJ6BNkEP\nHVGu5oWhM5jKGxUJ2gpDV63XYDE1x/P99d5K5wpADS3Z4HQIdKF8iQHW7wQrmiN3\nsttWGUUNMvqkKlKWtgLI/l9p6l+UZ4Tby6aSoToErSPPMLbvTwYU1yYe1+RTQ86g\nTM5XpssG3glKglcJHPeasslG4FWfB0lu77jhmftID66/q+XG637kjEoFpVoJhUvA\nzRiuwnoUbaelfBshbtf/0SsarMAlA943NBlioedQRspF57SV5zYfp3ymrcL5WiD4\nGcHE6sTkRcYsyas+jrm28l6RihNqHXUTqK7rGYqgOShQ9B8M0k+OBsC7rsQl8P5Z\nqv5Wjvw71gP1ELOmIGQ/TTcaPwvvN/6eQ0Q5Qe8SNlMLPajgzpY=\n=TcGY\n-----END PGP SIGNATURE-----", "payload": "tree 2321843df9a0bedcb7dbef578fcc574caeb1cb0b\nparent 8e5c5a64a5e6689ef25809d9b77380c912572060\nauthor flip1995 <philipp.krones@embecosm.com> 1610019490 +0100\ncommitter flip1995 <philipp.krones@embecosm.com> 1610019490 +0100\n\nChange env var used for testing Clippy\n\nThis changes the variable used for testing Clippy in the internal test\nsuite:\n\n```\nCLIPPY_TESTS -> __CLIPPY_INTERNAL_TESTS\n```\n\n`CLIPPY_TESTS` is understandably used in environments of Clippy users,\nso we shouldn't use it in our test suite.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/547ce0db274c68869a300b5162c126f95f768dac", "html_url": "https://github.com/rust-lang/rust/commit/547ce0db274c68869a300b5162c126f95f768dac", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/547ce0db274c68869a300b5162c126f95f768dac/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8e5c5a64a5e6689ef25809d9b77380c912572060", "url": "https://api.github.com/repos/rust-lang/rust/commits/8e5c5a64a5e6689ef25809d9b77380c912572060", "html_url": "https://github.com/rust-lang/rust/commit/8e5c5a64a5e6689ef25809d9b77380c912572060"}], "stats": {"total": 14, "additions": 9, "deletions": 5}, "files": [{"sha": "1a7a30c61be5b8fb9fc8987fc4fdc32667765165", "filename": "doc/adding_lints.md", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/547ce0db274c68869a300b5162c126f95f768dac/doc%2Fadding_lints.md", "raw_url": "https://github.com/rust-lang/rust/raw/547ce0db274c68869a300b5162c126f95f768dac/doc%2Fadding_lints.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/doc%2Fadding_lints.md?ref=547ce0db274c68869a300b5162c126f95f768dac", "patch": "@@ -147,10 +147,14 @@ add `// edition:2018` at the top of the test file (note that it's space-sensitiv\n \n Manually testing against an example file can be useful if you have added some\n `println!`s and the test suite output becomes unreadable. To try Clippy with\n-your local modifications, run `env CLIPPY_TESTS=true cargo run --bin\n-clippy-driver -- -L ./target/debug input.rs` from the working copy root.\n+your local modifications, run\n \n-With tests in place, let's have a look at implementing our lint now.\n+```\n+env __CLIPPY_INTERNAL_TESTS=true cargo run --bin clippy-driver -- -L ./target/debug input.rs\n+```\n+\n+from the working copy root. With tests in place, let's have a look at\n+implementing our lint now.\n \n ## Lint declaration\n "}, {"sha": "f5f6c09ed8e940e71b70469405950c3b9fe1f61d", "filename": "src/driver.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/547ce0db274c68869a300b5162c126f95f768dac/src%2Fdriver.rs", "raw_url": "https://github.com/rust-lang/rust/raw/547ce0db274c68869a300b5162c126f95f768dac/src%2Fdriver.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdriver.rs?ref=547ce0db274c68869a300b5162c126f95f768dac", "patch": "@@ -298,7 +298,7 @@ pub fn main() {\n         // - IF Clippy is run on the main crate, not on deps (`!cap_lints_allow`) THEN\n         //    - IF `--no-deps` is not set (`!no_deps`) OR\n         //    - IF `--no-deps` is set and Clippy is run on the specified primary package\n-        let clippy_tests_set = env::var(\"CLIPPY_TESTS\").map_or(false, |val| val == \"true\");\n+        let clippy_tests_set = env::var(\"__CLIPPY_INTERNAL_TESTS\").map_or(false, |val| val == \"true\");\n         let cap_lints_allow = arg_value(&orig_args, \"--cap-lints\", |val| val == \"allow\").is_some();\n         let in_primary_package = env::var(\"CARGO_PRIMARY_PACKAGE\").is_ok();\n "}, {"sha": "ea800336ef55046f489b47ccc80c58e38334f492", "filename": "tests/compile-test.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/547ce0db274c68869a300b5162c126f95f768dac/tests%2Fcompile-test.rs", "raw_url": "https://github.com/rust-lang/rust/raw/547ce0db274c68869a300b5162c126f95f768dac/tests%2Fcompile-test.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-test.rs?ref=547ce0db274c68869a300b5162c126f95f768dac", "patch": "@@ -254,7 +254,7 @@ fn run_ui_cargo(config: &mut compiletest::Config) {\n \n fn prepare_env() {\n     set_var(\"CLIPPY_DISABLE_DOCS_LINKS\", \"true\");\n-    set_var(\"CLIPPY_TESTS\", \"true\");\n+    set_var(\"__CLIPPY_INTERNAL_TESTS\", \"true\");\n     //set_var(\"RUST_BACKTRACE\", \"0\");\n }\n "}]}