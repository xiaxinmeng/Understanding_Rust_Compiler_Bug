{"sha": "6bcbc426c9abd97ad5379215545349e71592f90b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZiY2JjNDI2YzlhYmQ5N2FkNTM3OTIxNTU0NTM0OWU3MTU5MmY5MGI=", "commit": {"author": {"name": "Eric Huss", "email": "eric@huss.org", "date": "2020-06-23T22:23:46Z"}, "committer": {"name": "Eric Huss", "email": "eric@huss.org", "date": "2020-06-26T14:47:19Z"}, "message": "Update mdbook.", "tree": {"sha": "a11027adc0f06c8dfcaf214954a7ecd3bd1e6bbb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a11027adc0f06c8dfcaf214954a7ecd3bd1e6bbb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6bcbc426c9abd97ad5379215545349e71592f90b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6bcbc426c9abd97ad5379215545349e71592f90b", "html_url": "https://github.com/rust-lang/rust/commit/6bcbc426c9abd97ad5379215545349e71592f90b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6bcbc426c9abd97ad5379215545349e71592f90b/comments", "author": {"login": "ehuss", "id": 43198, "node_id": "MDQ6VXNlcjQzMTk4", "avatar_url": "https://avatars.githubusercontent.com/u/43198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ehuss", "html_url": "https://github.com/ehuss", "followers_url": "https://api.github.com/users/ehuss/followers", "following_url": "https://api.github.com/users/ehuss/following{/other_user}", "gists_url": "https://api.github.com/users/ehuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/ehuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ehuss/subscriptions", "organizations_url": "https://api.github.com/users/ehuss/orgs", "repos_url": "https://api.github.com/users/ehuss/repos", "events_url": "https://api.github.com/users/ehuss/events{/privacy}", "received_events_url": "https://api.github.com/users/ehuss/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ehuss", "id": 43198, "node_id": "MDQ6VXNlcjQzMTk4", "avatar_url": "https://avatars.githubusercontent.com/u/43198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ehuss", "html_url": "https://github.com/ehuss", "followers_url": "https://api.github.com/users/ehuss/followers", "following_url": "https://api.github.com/users/ehuss/following{/other_user}", "gists_url": "https://api.github.com/users/ehuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/ehuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ehuss/subscriptions", "organizations_url": "https://api.github.com/users/ehuss/orgs", "repos_url": "https://api.github.com/users/ehuss/repos", "events_url": "https://api.github.com/users/ehuss/events{/privacy}", "received_events_url": "https://api.github.com/users/ehuss/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6654c5852f76d6b55ebdacc0d428cad5b3dbdbed", "url": "https://api.github.com/repos/rust-lang/rust/commits/6654c5852f76d6b55ebdacc0d428cad5b3dbdbed", "html_url": "https://github.com/rust-lang/rust/commit/6654c5852f76d6b55ebdacc0d428cad5b3dbdbed"}], "stats": {"total": 131, "additions": 20, "deletions": 111}, "files": [{"sha": "e9fb097df92d2d6243fcc13be8dd2da794f974d0", "filename": "Cargo.lock", "status": "modified", "additions": 10, "deletions": 104, "changes": 114, "blob_url": "https://github.com/rust-lang/rust/blob/6bcbc426c9abd97ad5379215545349e71592f90b/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/6bcbc426c9abd97ad5379215545349e71592f90b/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=6bcbc426c9abd97ad5379215545349e71592f90b", "patch": "@@ -65,9 +65,9 @@ dependencies = [\n \n [[package]]\n name = \"anyhow\"\n-version = \"1.0.26\"\n+version = \"1.0.31\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"7825f6833612eb2414095684fcf6c635becf3ce97fe48cf6421321e93bfbd53c\"\n+checksum = \"85bb70cc08ec97ca5450e6eba421deeea5f172c0fc61f78b5357b2a8e8be195f\"\n \n [[package]]\n name = \"arc-swap\"\n@@ -529,7 +529,7 @@ dependencies = [\n  \"if_chain\",\n  \"itertools 0.9.0\",\n  \"lazy_static\",\n- \"pulldown-cmark 0.7.1\",\n+ \"pulldown-cmark\",\n  \"quine-mc_cluskey\",\n  \"quote 1.0.2\",\n  \"regex-syntax\",\n@@ -807,40 +807,6 @@ dependencies = [\n  \"winapi 0.3.8\",\n ]\n \n-[[package]]\n-name = \"darling\"\n-version = \"0.8.6\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"9158d690bc62a3a57c3e45b85e4d50de2008b39345592c64efd79345c7e24be0\"\n-dependencies = [\n- \"darling_core\",\n- \"darling_macro\",\n-]\n-\n-[[package]]\n-name = \"darling_core\"\n-version = \"0.8.6\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"d2a368589465391e127e10c9e3a08efc8df66fd49b87dc8524c764bbe7f2ef82\"\n-dependencies = [\n- \"fnv\",\n- \"ident_case\",\n- \"proc-macro2 0.4.30\",\n- \"quote 0.6.12\",\n- \"syn 0.15.35\",\n-]\n-\n-[[package]]\n-name = \"darling_macro\"\n-version = \"0.8.6\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"244e8987bd4e174385240cde20a3657f607fb0797563c28255c353b5819a07b1\"\n-dependencies = [\n- \"darling_core\",\n- \"quote 0.6.12\",\n- \"syn 0.15.35\",\n-]\n-\n [[package]]\n name = \"datafrog\"\n version = \"2.0.1\"\n@@ -989,15 +955,6 @@ dependencies = [\n  \"termcolor\",\n ]\n \n-[[package]]\n-name = \"error-chain\"\n-version = \"0.12.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"07e791d3be96241c77c43846b665ef1384606da2cd2a48730abe606a12906e02\"\n-dependencies = [\n- \"backtrace\",\n-]\n-\n [[package]]\n name = \"error_index_generator\"\n version = \"0.0.0\"\n@@ -1341,12 +1298,6 @@ version = \"2.0.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"b9b6c53306532d3c8e8087b44e6580e10db51a023cf9b433cea2ac38066b92da\"\n \n-[[package]]\n-name = \"ident_case\"\n-version = \"1.0.1\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"b9e0384b61958566e926dc50660321d12159025e767c18e043daf26b70104c39\"\n-\n [[package]]\n name = \"idna\"\n version = \"0.1.5\"\n@@ -1439,12 +1390,6 @@ dependencies = [\n  \"libc\",\n ]\n \n-[[package]]\n-name = \"is-match\"\n-version = \"0.1.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"7e5b386aef33a1c677be65237cb9d32c3f3ef56bd035949710c4bb13083eb053\"\n-\n [[package]]\n name = \"itertools\"\n version = \"0.8.0\"\n@@ -1797,31 +1742,29 @@ dependencies = [\n \n [[package]]\n name = \"mdbook\"\n-version = \"0.3.7\"\n+version = \"0.4.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"e7ec525f7ebccc2dd935c263717250cd37f9a4b264a77c5dbc950ea2734d8159\"\n+checksum = \"2567ffadc0fd26fe15d6f6e0a80639f19f6a50082fdb460d0ae5d1f7298181be\"\n dependencies = [\n  \"ammonia\",\n+ \"anyhow\",\n  \"chrono\",\n  \"clap\",\n  \"elasticlunr-rs\",\n- \"env_logger 0.6.2\",\n- \"error-chain\",\n+ \"env_logger 0.7.1\",\n  \"handlebars\",\n- \"itertools 0.8.0\",\n  \"lazy_static\",\n  \"log\",\n  \"memchr\",\n  \"open\",\n- \"pulldown-cmark 0.6.1\",\n+ \"pulldown-cmark\",\n  \"regex\",\n  \"serde\",\n  \"serde_derive\",\n  \"serde_json\",\n  \"shlex\",\n  \"tempfile\",\n  \"toml\",\n- \"toml-query\",\n ]\n \n [[package]]\n@@ -2411,25 +2354,14 @@ dependencies = [\n  \"cc\",\n ]\n \n-[[package]]\n-name = \"pulldown-cmark\"\n-version = \"0.6.1\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"1c205cc82214f3594e2d50686730314f817c67ffa80fe800cf0db78c3c2b9d9e\"\n-dependencies = [\n- \"bitflags\",\n- \"getopts\",\n- \"memchr\",\n- \"unicase\",\n-]\n-\n [[package]]\n name = \"pulldown-cmark\"\n version = \"0.7.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"3e142c3b8f49d2200605ee6ba0b1d757310e9e7a72afe78c36ee2ef67300ee00\"\n dependencies = [\n  \"bitflags\",\n+ \"getopts\",\n  \"memchr\",\n  \"unicase\",\n ]\n@@ -4091,7 +4023,7 @@ version = \"0.0.0\"\n dependencies = [\n  \"itertools 0.8.0\",\n  \"minifier\",\n- \"pulldown-cmark 0.7.1\",\n+ \"pulldown-cmark\",\n  \"rustc-rayon\",\n  \"serde\",\n  \"serde_json\",\n@@ -4944,32 +4876,6 @@ dependencies = [\n  \"serde\",\n ]\n \n-[[package]]\n-name = \"toml-query\"\n-version = \"0.9.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"a24369a1894ac8224efcfd567c3d141aea360292f49888e7ec7dcc316527aebb\"\n-dependencies = [\n- \"failure\",\n- \"failure_derive\",\n- \"is-match\",\n- \"lazy_static\",\n- \"regex\",\n- \"toml\",\n- \"toml-query_derive\",\n-]\n-\n-[[package]]\n-name = \"toml-query_derive\"\n-version = \"0.9.0\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"3c99ca245ec273c7e75c8ee58f47b882d0146f3c2c8495158082c6671e8b5335\"\n-dependencies = [\n- \"darling\",\n- \"quote 0.6.12\",\n- \"syn 0.15.35\",\n-]\n-\n [[package]]\n name = \"tracing\"\n version = \"0.1.15\""}, {"sha": "f0a6ce2fa06c27d9b62f84e24045015b3eb52b81", "filename": "src/tools/rustbook/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6bcbc426c9abd97ad5379215545349e71592f90b/src%2Ftools%2Frustbook%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/6bcbc426c9abd97ad5379215545349e71592f90b/src%2Ftools%2Frustbook%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustbook%2FCargo.toml?ref=6bcbc426c9abd97ad5379215545349e71592f90b", "patch": "@@ -9,6 +9,6 @@ edition = \"2018\"\n clap = \"2.25.0\"\n \n [dependencies.mdbook]\n-version = \"0.3.7\"\n+version = \"0.4.0\"\n default-features = false\n features = [\"search\"]"}, {"sha": "c87c64540ad7bb7fa916be04c10b43628d45fc9a", "filename": "src/tools/rustbook/src/main.rs", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/6bcbc426c9abd97ad5379215545349e71592f90b/src%2Ftools%2Frustbook%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6bcbc426c9abd97ad5379215545349e71592f90b/src%2Ftools%2Frustbook%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustbook%2Fsrc%2Fmain.rs?ref=6bcbc426c9abd97ad5379215545349e71592f90b", "patch": "@@ -51,7 +51,7 @@ fn main() {\n // Build command implementation\n pub fn build(args: &ArgMatches<'_>) -> Result3<()> {\n     let book_dir = get_book_dir(args);\n-    let mut book = MDBook::load(&book_dir)?;\n+    let mut book = load_book(&book_dir)?;\n \n     // Set this to allow us to catch bugs in advance.\n     book.config.build.create_missing = false;\n@@ -67,7 +67,7 @@ pub fn build(args: &ArgMatches<'_>) -> Result3<()> {\n \n fn test(args: &ArgMatches<'_>) -> Result3<()> {\n     let book_dir = get_book_dir(args);\n-    let mut book = MDBook::load(&book_dir)?;\n+    let mut book = load_book(&book_dir)?;\n     book.test(vec![])\n }\n \n@@ -81,10 +81,16 @@ fn get_book_dir(args: &ArgMatches<'_>) -> PathBuf {\n     }\n }\n \n+fn load_book(book_dir: &Path) -> Result3<MDBook> {\n+    let mut book = MDBook::load(book_dir)?;\n+    book.config.set(\"output.html.input-404\", \"\").unwrap();\n+    Ok(book)\n+}\n+\n fn handle_error(error: mdbook::errors::Error) -> ! {\n     eprintln!(\"Error: {}\", error);\n \n-    for cause in error.iter().skip(1) {\n+    for cause in error.chain().skip(1) {\n         eprintln!(\"\\tCaused By: {}\", cause);\n     }\n "}, {"sha": "4622e15a1cae88bbda0575adf45b576c46176afb", "filename": "src/tools/tidy/src/deps.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/6bcbc426c9abd97ad5379215545349e71592f90b/src%2Ftools%2Ftidy%2Fsrc%2Fdeps.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6bcbc426c9abd97ad5379215545349e71592f90b/src%2Ftools%2Ftidy%2Fsrc%2Fdeps.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Ftidy%2Fsrc%2Fdeps.rs?ref=6bcbc426c9abd97ad5379215545349e71592f90b", "patch": "@@ -26,9 +26,6 @@ const LICENSES: &[&str] = &[\n const EXCEPTIONS: &[(&str, &str)] = &[\n     (\"mdbook\", \"MPL-2.0\"),                  // mdbook\n     (\"openssl\", \"Apache-2.0\"),              // cargo, mdbook\n-    (\"toml-query\", \"MPL-2.0\"),              // mdbook\n-    (\"toml-query_derive\", \"MPL-2.0\"),       // mdbook\n-    (\"is-match\", \"MPL-2.0\"),                // mdbook\n     (\"rdrand\", \"ISC\"),                      // mdbook, rustfmt\n     (\"fuchsia-cprng\", \"BSD-3-Clause\"),      // mdbook, rustfmt\n     (\"fuchsia-zircon-sys\", \"BSD-3-Clause\"), // rustdoc, rustc, cargo"}]}