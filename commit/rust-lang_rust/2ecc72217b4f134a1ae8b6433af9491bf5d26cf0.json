{"sha": "2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "node_id": "C_kwDOAAsO6NoAKDJlY2M3MjIxN2I0ZjEzNGExYWU4YjY0MzNhZjk0OTFiZjVkMjZjZjA", "commit": {"author": {"name": "Dylan DPC", "email": "99973273+Dylan-DPC@users.noreply.github.com", "date": "2023-05-09T07:03:44Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-05-09T07:03:44Z"}, "message": "Rollup merge of #110504 - compiler-errors:tweak-borrow-sugg, r=cjgillot\n\nTweak borrow suggestion span\n\nAvoids a `span_to_snippet` call when we don't need to surround the expression in parentheses. The fact that the suggestion was using the whole span of the expression rather than just appending a `&` was prevented me from using `// run-rustfix` in another PR (https://github.com/rust-lang/rust/pull/110432#discussion_r1170500484).\n\nAlso some drive-by renames of functions that have been annoying me for a bit.", "tree": {"sha": "4f0617cc4e1b0a1efa9749576ac0fe0104790053", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4f0617cc4e1b0a1efa9749576ac0fe0104790053"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkWfBQCRBK7hj4Ov3rIwAAAKIIACGDqUG5azdgZ9vylj7g3LOG\nAbZLsFZn5mInWDFx4m+r5c63wwh0gRPZHFV15wbZmLMruP7IBqTJ7aettlgpyqDJ\nNGgXQgAo4SCcaoAehp7WlvRCnBev5HKA0EKIcx0jWeJIWulTVxBlHp4Ibnewpbs+\n1HfTkGfYhIY3Rc69WMMNy1JpC/HUKIT0lKdldrPFusdbNb2FO8yMIlPWi86g/Cif\nSgmy3tH3jGyEjc23Jvb/RKNhD23s9quBEH34ipNr0nGsUEaTwnM9JpEjGRPGwJAv\nyb1CtFAfX2UiuN1GQ9FyjTGCXG2ZEQxF7MssRt6pde+kFwHDHyWP79OIK7qaB7A=\n=OMJH\n-----END PGP SIGNATURE-----\n", "payload": "tree 4f0617cc4e1b0a1efa9749576ac0fe0104790053\nparent 02a85bd038546d040efca42a313e44051b078f9c\nparent 4731a25d2dbe84e711101f2cbb83b40fa96c7014\nauthor Dylan DPC <99973273+Dylan-DPC@users.noreply.github.com> 1683615824 +0530\ncommitter GitHub <noreply@github.com> 1683615824 +0530\n\nRollup merge of #110504 - compiler-errors:tweak-borrow-sugg, r=cjgillot\n\nTweak borrow suggestion span\n\nAvoids a `span_to_snippet` call when we don't need to surround the expression in parentheses. The fact that the suggestion was using the whole span of the expression rather than just appending a `&` was prevented me from using `// run-rustfix` in another PR (https://github.com/rust-lang/rust/pull/110432#discussion_r1170500484).\n\nAlso some drive-by renames of functions that have been annoying me for a bit.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "html_url": "https://github.com/rust-lang/rust/commit/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "02a85bd038546d040efca42a313e44051b078f9c", "url": "https://api.github.com/repos/rust-lang/rust/commits/02a85bd038546d040efca42a313e44051b078f9c", "html_url": "https://github.com/rust-lang/rust/commit/02a85bd038546d040efca42a313e44051b078f9c"}, {"sha": "4731a25d2dbe84e711101f2cbb83b40fa96c7014", "url": "https://api.github.com/repos/rust-lang/rust/commits/4731a25d2dbe84e711101f2cbb83b40fa96c7014", "html_url": "https://github.com/rust-lang/rust/commit/4731a25d2dbe84e711101f2cbb83b40fa96c7014"}], "stats": {"total": 918, "additions": 527, "deletions": 391}, "files": [{"sha": "2defca54aff24ef697a7bb7fbd904fd3ddcd23f3", "filename": "compiler/rustc_hir_typeck/src/demand.rs", "status": "modified", "additions": 102, "deletions": 96, "changes": 198, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/compiler%2Frustc_hir_typeck%2Fsrc%2Fdemand.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/compiler%2Frustc_hir_typeck%2Fsrc%2Fdemand.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_typeck%2Fsrc%2Fdemand.rs?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -86,9 +86,9 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         self.emit_type_mismatch_suggestions(err, expr, expr_ty, expected, expected_ty_expr, error);\n         self.note_type_is_not_clone(err, expected, expr_ty, expr);\n         self.note_internal_mutation_in_method(err, expr, Some(expected), expr_ty);\n-        self.check_for_range_as_method_call(err, expr, expr_ty, expected);\n-        self.check_for_binding_assigned_block_without_tail_expression(err, expr, expr_ty, expected);\n-        self.check_wrong_return_type_due_to_generic_arg(err, expr, expr_ty);\n+        self.suggest_method_call_on_range_literal(err, expr, expr_ty, expected);\n+        self.suggest_return_binding_for_missing_tail_expr(err, expr, expr_ty, expected);\n+        self.note_wrong_return_ty_due_to_generic_arg(err, expr, expr_ty);\n     }\n \n     /// Requires that the two types unify, and prints an error message if\n@@ -1087,7 +1087,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n     /// ```ignore (illustrative)\n     /// opt.map(|param| { takes_ref(param) });\n     /// ```\n-    fn can_use_as_ref(&self, expr: &hir::Expr<'_>) -> Option<(Span, &'static str, String)> {\n+    fn can_use_as_ref(&self, expr: &hir::Expr<'_>) -> Option<(Vec<(Span, String)>, &'static str)> {\n         let hir::ExprKind::Path(hir::QPath::Resolved(_, ref path)) = expr.kind else {\n             return None;\n         };\n@@ -1133,12 +1133,13 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n             }\n             _ => false,\n         };\n-        match (is_as_ref_able, self.sess().source_map().span_to_snippet(method_path.ident.span)) {\n-            (true, Ok(src)) => {\n-                let suggestion = format!(\"as_ref().{}\", src);\n-                Some((method_path.ident.span, \"consider using `as_ref` instead\", suggestion))\n-            }\n-            _ => None,\n+        if is_as_ref_able {\n+            Some((\n+                vec![(method_path.ident.span.shrink_to_lo(), \"as_ref().\".to_string())],\n+                \"consider using `as_ref` instead\",\n+            ))\n+        } else {\n+            None\n         }\n     }\n \n@@ -1217,14 +1218,13 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n     /// In addition of this check, it also checks between references mutability state. If the\n     /// expected is mutable but the provided isn't, maybe we could just say \"Hey, try with\n     /// `&mut`!\".\n-    pub fn check_ref(\n+    pub fn suggest_deref_or_ref(\n         &self,\n         expr: &hir::Expr<'tcx>,\n         checked_ty: Ty<'tcx>,\n         expected: Ty<'tcx>,\n     ) -> Option<(\n-        Span,\n-        String,\n+        Vec<(Span, String)>,\n         String,\n         Applicability,\n         bool, /* verbose */\n@@ -1254,30 +1254,28 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                         && let Ok(src) = sm.span_to_snippet(sp)\n                         && replace_prefix(&src, \"b\\\"\", \"\\\"\").is_some()\n                     {\n-                                let pos = sp.lo() + BytePos(1);\n-                                return Some((\n-                                    sp.with_hi(pos),\n-                                    \"consider removing the leading `b`\".to_string(),\n-                                    String::new(),\n-                                    Applicability::MachineApplicable,\n-                                    true,\n-                                    false,\n-                                ));\n-                            }\n-                        }\n+                        let pos = sp.lo() + BytePos(1);\n+                        return Some((\n+                            vec![(sp.with_hi(pos), String::new())],\n+                            \"consider removing the leading `b`\".to_string(),\n+                            Applicability::MachineApplicable,\n+                            true,\n+                            false,\n+                        ));\n+                    }\n+                }\n                 (&ty::Array(arr, _) | &ty::Slice(arr), &ty::Str) if arr == self.tcx.types.u8 => {\n                     if let hir::ExprKind::Lit(_) = expr.kind\n                         && let Ok(src) = sm.span_to_snippet(sp)\n                         && replace_prefix(&src, \"\\\"\", \"b\\\"\").is_some()\n                     {\n-                                return Some((\n-                                    sp.shrink_to_lo(),\n-                                    \"consider adding a leading `b`\".to_string(),\n-                                    \"b\".to_string(),\n-                                    Applicability::MachineApplicable,\n-                                    true,\n-                                    false,\n-                                ));\n+                        return Some((\n+                            vec![(sp.shrink_to_lo(), \"b\".to_string())],\n+                            \"consider adding a leading `b`\".to_string(),\n+                            Applicability::MachineApplicable,\n+                            true,\n+                            false,\n+                        ));\n                     }\n                 }\n                 _ => {}\n@@ -1320,66 +1318,73 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                     }\n \n                     if let hir::ExprKind::Unary(hir::UnOp::Deref, ref inner) = expr.kind\n-                        && let Some(1) = self.deref_steps(expected, checked_ty) {\n+                        && let Some(1) = self.deref_steps(expected, checked_ty)\n+                    {\n                         // We have `*&T`, check if what was expected was `&T`.\n                         // If so, we may want to suggest removing a `*`.\n                         sugg_sp = sugg_sp.with_hi(inner.span.lo());\n                         return Some((\n-                            sugg_sp,\n+                            vec![(sugg_sp, String::new())],\n                             \"consider removing deref here\".to_string(),\n-                            \"\".to_string(),\n                             Applicability::MachineApplicable,\n                             true,\n                             false,\n                         ));\n                     }\n \n-                    if let Ok(src) = sm.span_to_snippet(sugg_sp) {\n-                        let needs_parens = match expr.kind {\n-                            // parenthesize if needed (Issue #46756)\n-                            hir::ExprKind::Cast(_, _) | hir::ExprKind::Binary(_, _, _) => true,\n-                            // parenthesize borrows of range literals (Issue #54505)\n-                            _ if is_range_literal(expr) => true,\n-                            _ => false,\n-                        };\n-\n-                        if let Some(sugg) = self.can_use_as_ref(expr) {\n-                            return Some((\n-                                sugg.0,\n-                                sugg.1.to_string(),\n-                                sugg.2,\n-                                Applicability::MachineApplicable,\n-                                false,\n-                                false,\n-                            ));\n-                        }\n-\n-                        let prefix = match self.maybe_get_struct_pattern_shorthand_field(expr) {\n-                            Some(ident) => format!(\"{ident}: \"),\n-                            None => String::new(),\n-                        };\n-\n-                        if let Some(hir::Node::Expr(hir::Expr {\n-                            kind: hir::ExprKind::Assign(..),\n-                            ..\n-                        })) = self.tcx.hir().find_parent(expr.hir_id)\n-                        {\n-                            if mutability.is_mut() {\n-                                // Suppressing this diagnostic, we'll properly print it in `check_expr_assign`\n-                                return None;\n-                            }\n-                        }\n+                    let needs_parens = match expr.kind {\n+                        // parenthesize if needed (Issue #46756)\n+                        hir::ExprKind::Cast(_, _) | hir::ExprKind::Binary(_, _, _) => true,\n+                        // parenthesize borrows of range literals (Issue #54505)\n+                        _ if is_range_literal(expr) => true,\n+                        _ => false,\n+                    };\n \n-                        let sugg_expr = if needs_parens { format!(\"({src})\") } else { src };\n+                    if let Some((sugg, msg)) = self.can_use_as_ref(expr) {\n                         return Some((\n-                            sp,\n-                            format!(\"consider {}borrowing here\", mutability.mutably_str()),\n-                            format!(\"{prefix}{}{sugg_expr}\", mutability.ref_prefix_str()),\n+                            sugg,\n+                            msg.to_string(),\n                             Applicability::MachineApplicable,\n-                            false,\n+                            true,\n                             false,\n                         ));\n                     }\n+\n+                    let prefix = match self.maybe_get_struct_pattern_shorthand_field(expr) {\n+                        Some(ident) => format!(\"{ident}: \"),\n+                        None => String::new(),\n+                    };\n+\n+                    if let Some(hir::Node::Expr(hir::Expr {\n+                        kind: hir::ExprKind::Assign(..),\n+                        ..\n+                    })) = self.tcx.hir().find_parent(expr.hir_id)\n+                    {\n+                        if mutability.is_mut() {\n+                            // Suppressing this diagnostic, we'll properly print it in `check_expr_assign`\n+                            return None;\n+                        }\n+                    }\n+\n+                    let sugg = mutability.ref_prefix_str();\n+                    let (sugg, verbose) = if needs_parens {\n+                        (\n+                            vec![\n+                                (sp.shrink_to_lo(), format!(\"{prefix}{sugg}(\")),\n+                                (sp.shrink_to_hi(), \")\".to_string()),\n+                            ],\n+                            false,\n+                        )\n+                    } else {\n+                        (vec![(sp.shrink_to_lo(), format!(\"{prefix}{sugg}\"))], true)\n+                    };\n+                    return Some((\n+                        sugg,\n+                        format!(\"consider {}borrowing here\", mutability.mutably_str()),\n+                        Applicability::MachineApplicable,\n+                        verbose,\n+                        false,\n+                    ));\n                 }\n             }\n             (\n@@ -1401,23 +1406,19 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                         && sm.is_span_accessible(call_span)\n                     {\n                         return Some((\n-                            sp.with_hi(call_span.lo()),\n+                            vec![(sp.with_hi(call_span.lo()), String::new())],\n                             \"consider removing the borrow\".to_string(),\n-                            String::new(),\n                             Applicability::MachineApplicable,\n                             true,\n-                            true\n+                            true,\n                         ));\n                     }\n                     return None;\n                 }\n-                if sp.contains(expr.span)\n-                    && sm.is_span_accessible(expr.span)\n-                {\n+                if sp.contains(expr.span) && sm.is_span_accessible(expr.span) {\n                     return Some((\n-                        sp.with_hi(expr.span.lo()),\n+                        vec![(sp.with_hi(expr.span.lo()), String::new())],\n                         \"consider removing the borrow\".to_string(),\n-                        String::new(),\n                         Applicability::MachineApplicable,\n                         true,\n                         true,\n@@ -1441,23 +1442,30 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n \n                     let suggestion = replace_prefix(&src, old_prefix, &new_prefix).map(|_| {\n                         // skip `&` or `&mut ` if both mutabilities are mutable\n-                        let lo = sp.lo() + BytePos(min(old_prefix.len(), mutbl_b.ref_prefix_str().len()) as _);\n+                        let lo = sp.lo()\n+                            + BytePos(min(old_prefix.len(), mutbl_b.ref_prefix_str().len()) as _);\n                         // skip `&` or `&mut `\n                         let hi = sp.lo() + BytePos(old_prefix.len() as _);\n                         let sp = sp.with_lo(lo).with_hi(hi);\n \n                         (\n                             sp,\n-                            format!(\"{}{derefs}\", if mutbl_a != mutbl_b { mutbl_b.prefix_str() } else { \"\" }),\n-                            if mutbl_b <= mutbl_a { Applicability::MachineApplicable } else { Applicability::MaybeIncorrect }\n+                            format!(\n+                                \"{}{derefs}\",\n+                                if mutbl_a != mutbl_b { mutbl_b.prefix_str() } else { \"\" }\n+                            ),\n+                            if mutbl_b <= mutbl_a {\n+                                Applicability::MachineApplicable\n+                            } else {\n+                                Applicability::MaybeIncorrect\n+                            },\n                         )\n                     });\n \n                     if let Some((span, src, applicability)) = suggestion {\n                         return Some((\n-                            span,\n+                            vec![(span, src)],\n                             \"consider dereferencing\".to_string(),\n-                            src,\n                             applicability,\n                             true,\n                             false,\n@@ -1486,9 +1494,8 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                     // If we've reached our target type with just removing `&`, then just print now.\n                     if steps == 0 && !remove.trim().is_empty() {\n                         return Some((\n-                            prefix_span,\n+                            vec![(prefix_span, String::new())],\n                             format!(\"consider removing the `{}`\", remove.trim()),\n-                            String::new(),\n                             // Do not remove `&&` to get to bool, because it might be something like\n                             // { a } && b, which we have a separate fixup suggestion that is more\n                             // likely correct...\n@@ -1554,9 +1561,8 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                         }\n \n                         return Some((\n-                            span,\n+                            vec![(span, suggestion)],\n                             message,\n-                            suggestion,\n                             Applicability::MachineApplicable,\n                             true,\n                             false,\n@@ -1569,7 +1575,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         None\n     }\n \n-    pub fn check_for_cast(\n+    pub fn suggest_cast(\n         &self,\n         err: &mut Diagnostic,\n         expr: &hir::Expr<'_>,\n@@ -1936,7 +1942,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n     }\n \n     /// Identify when the user has written `foo..bar()` instead of `foo.bar()`.\n-    pub fn check_for_range_as_method_call(\n+    pub fn suggest_method_call_on_range_literal(\n         &self,\n         err: &mut Diagnostic,\n         expr: &hir::Expr<'tcx>,\n@@ -2005,7 +2011,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n \n     /// Identify when the type error is because `()` is found in a binding that was assigned a\n     /// block without a tail expression.\n-    fn check_for_binding_assigned_block_without_tail_expression(\n+    fn suggest_return_binding_for_missing_tail_expr(\n         &self,\n         err: &mut Diagnostic,\n         expr: &hir::Expr<'_>,\n@@ -2047,7 +2053,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         }\n     }\n \n-    fn check_wrong_return_type_due_to_generic_arg(\n+    fn note_wrong_return_ty_due_to_generic_arg(\n         &self,\n         err: &mut Diagnostic,\n         expr: &hir::Expr<'_>,"}, {"sha": "c4add4dbdfb2fb29038f464931cfe04bbabe71f1", "filename": "compiler/rustc_hir_typeck/src/fn_ctxt/suggestions.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/compiler%2Frustc_hir_typeck%2Fsrc%2Ffn_ctxt%2Fsuggestions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/compiler%2Frustc_hir_typeck%2Fsrc%2Ffn_ctxt%2Fsuggestions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_typeck%2Fsrc%2Ffn_ctxt%2Fsuggestions.rs?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -275,13 +275,13 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         expected_ty_expr: Option<&'tcx hir::Expr<'tcx>>,\n     ) -> bool {\n         let expr = expr.peel_blocks();\n-        if let Some((sp, msg, suggestion, applicability, verbose, annotation)) =\n-            self.check_ref(expr, found, expected)\n+        if let Some((suggestion, msg, applicability, verbose, annotation)) =\n+            self.suggest_deref_or_ref(expr, found, expected)\n         {\n             if verbose {\n-                err.span_suggestion_verbose(sp, msg, suggestion, applicability);\n+                err.multipart_suggestion_verbose(msg, suggestion, applicability);\n             } else {\n-                err.span_suggestion(sp, msg, suggestion, applicability);\n+                err.multipart_suggestion(msg, suggestion, applicability);\n             }\n             if annotation {\n                 let suggest_annotation = match expr.peel_drop_temps().kind {\n@@ -343,7 +343,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                 err.span_label(sp, format!(\"{descr} `{name}` defined here\"));\n             }\n             return true;\n-        } else if self.check_for_cast(err, expr, found, expected, expected_ty_expr) {\n+        } else if self.suggest_cast(err, expr, found, expected, expected_ty_expr) {\n             return true;\n         } else {\n             let methods = self.get_conversion_methods(expr.span, expected, found, expr.hir_id);"}, {"sha": "486c217707e78cced843d0c4cdb695af9d75efb1", "filename": "compiler/rustc_hir_typeck/src/method/suggest.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/compiler%2Frustc_hir_typeck%2Fsrc%2Fmethod%2Fsuggest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/compiler%2Frustc_hir_typeck%2Fsrc%2Fmethod%2Fsuggest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_typeck%2Fsrc%2Fmethod%2Fsuggest.rs?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -1045,7 +1045,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n             );\n         }\n \n-        self.check_for_inner_self(&mut err, source, rcvr_ty, item_name);\n+        self.suggest_unwrapping_inner_self(&mut err, source, rcvr_ty, item_name);\n \n         bound_spans.sort();\n         bound_spans.dedup();\n@@ -1132,7 +1132,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n             }\n         }\n \n-        self.check_for_deref_method(&mut err, source, rcvr_ty, item_name, expected);\n+        self.note_derefed_ty_has_method(&mut err, source, rcvr_ty, item_name, expected);\n         return Some(err);\n     }\n \n@@ -1805,7 +1805,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         }\n     }\n \n-    fn check_for_inner_self(\n+    fn suggest_unwrapping_inner_self(\n         &self,\n         err: &mut Diagnostic,\n         source: SelfSource<'tcx>,\n@@ -2175,7 +2175,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         }\n     }\n \n-    fn check_for_deref_method(\n+    fn note_derefed_ty_has_method(\n         &self,\n         err: &mut Diagnostic,\n         self_source: SelfSource<'tcx>,"}, {"sha": "082564fbc7f889bd6f9273d29faca5dcbc53ff60", "filename": "tests/ui/argument-suggestions/issue-97484.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fargument-suggestions%2Fissue-97484.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fargument-suggestions%2Fissue-97484.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fargument-suggestions%2Fissue-97484.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -16,7 +16,7 @@ LL | fn foo(a: &A, d: D, e: &E, g: G) {}\n help: consider borrowing here\n    |\n LL |     foo(&&A, B, C, D, &E, F, G);\n-   |                       ~~\n+   |                       +\n help: remove the extra arguments\n    |\n LL -     foo(&&A, B, C, D, E, F, G);"}, {"sha": "cd84505680514abe4cffb3ea97267d0a4b655304", "filename": "tests/ui/async-await/issues/issue-102206.stderr", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fasync-await%2Fissues%2Fissue-102206.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fasync-await%2Fissues%2Fissue-102206.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fasync-await%2Fissues%2Fissue-102206.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -2,14 +2,16 @@ error[E0308]: mismatched types\n   --> $DIR/issue-102206.rs:6:27\n    |\n LL |     std::mem::size_of_val(foo());\n-   |     --------------------- ^^^^^\n-   |     |                     |\n-   |     |                     expected `&_`, found future\n-   |     |                     help: consider borrowing here: `&foo()`\n+   |     --------------------- ^^^^^ expected `&_`, found future\n+   |     |\n    |     arguments to this function are incorrect\n    |\n note: function defined here\n   --> $SRC_DIR/core/src/mem/mod.rs:LL:COL\n+help: consider borrowing here\n+   |\n+LL |     std::mem::size_of_val(&foo());\n+   |                           +\n \n error: aborting due to previous error\n "}, {"sha": "17bbca7a0bdb6d385b703f22a6feced6f82248fb", "filename": "tests/ui/coercion/coercion-slice.stderr", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fcoercion%2Fcoercion-slice.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fcoercion%2Fcoercion-slice.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcoercion%2Fcoercion-slice.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -2,11 +2,14 @@ error[E0308]: mismatched types\n   --> $DIR/coercion-slice.rs:4:21\n    |\n LL |     let _: &[i32] = [0];\n-   |            ------   ^^^\n-   |            |        |\n-   |            |        expected `&[i32]`, found `[{integer}; 1]`\n-   |            |        help: consider borrowing here: `&[0]`\n+   |            ------   ^^^ expected `&[i32]`, found `[{integer}; 1]`\n+   |            |\n    |            expected due to this\n+   |\n+help: consider borrowing here\n+   |\n+LL |     let _: &[i32] = &[0];\n+   |                     +\n \n error: aborting due to previous error\n "}, {"sha": "c58aab42269887895e02c6ff918b88b4ea70f8cd", "filename": "tests/ui/inference/deref-suggestion.stderr", "status": "modified", "additions": 12, "deletions": 8, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Finference%2Fderef-suggestion.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Finference%2Fderef-suggestion.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Finference%2Fderef-suggestion.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -98,19 +98,23 @@ error[E0308]: mismatched types\n   --> $DIR/deref-suggestion.rs:40:17\n    |\n LL |     let s = S { u };\n-   |                 ^\n-   |                 |\n-   |                 expected `&u32`, found integer\n-   |                 help: consider borrowing here: `u: &u`\n+   |                 ^ expected `&u32`, found integer\n+   |\n+help: consider borrowing here\n+   |\n+LL |     let s = S { u: &u };\n+   |                 ++++\n \n error[E0308]: mismatched types\n   --> $DIR/deref-suggestion.rs:42:20\n    |\n LL |     let s = S { u: u };\n-   |                    ^\n-   |                    |\n-   |                    expected `&u32`, found integer\n-   |                    help: consider borrowing here: `&u`\n+   |                    ^ expected `&u32`, found integer\n+   |\n+help: consider borrowing here\n+   |\n+LL |     let s = S { u: &u };\n+   |                    +\n \n error[E0308]: mismatched types\n   --> $DIR/deref-suggestion.rs:45:17"}, {"sha": "879dc5b76c59975fc88ccd73589396509255e6b8", "filename": "tests/ui/issues/issue-11374.stderr", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fissues%2Fissue-11374.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fissues%2Fissue-11374.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fissues%2Fissue-11374.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -2,10 +2,8 @@ error[E0308]: mismatched types\n   --> $DIR/issue-11374.rs:26:15\n    |\n LL |     c.read_to(v);\n-   |       ------- ^\n-   |       |       |\n-   |       |       expected `&mut [u8]`, found `Vec<_>`\n-   |       |       help: consider mutably borrowing here: `&mut v`\n+   |       ------- ^ expected `&mut [u8]`, found `Vec<_>`\n+   |       |\n    |       arguments to this method are incorrect\n    |\n    = note: expected mutable reference `&mut [u8]`\n@@ -15,6 +13,10 @@ note: method defined here\n    |\n LL |     pub fn read_to(&mut self, vec: &mut [u8]) {\n    |            ^^^^^^^            --------------\n+help: consider mutably borrowing here\n+   |\n+LL |     c.read_to(&mut v);\n+   |               ++++\n \n error: aborting due to previous error\n "}, {"sha": "3419c0798595e2e92805bd81fa04e3f6fcee2b72", "filename": "tests/ui/issues/issue-17033.stderr", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fissues%2Fissue-17033.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fissues%2Fissue-17033.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fissues%2Fissue-17033.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -2,11 +2,14 @@ error[E0308]: mismatched types\n   --> $DIR/issue-17033.rs:2:10\n    |\n LL |     (*p)(())\n-   |     ---- ^^\n-   |     |    |\n-   |     |    expected `&mut ()`, found `()`\n-   |     |    help: consider mutably borrowing here: `&mut ()`\n+   |     ---- ^^ expected `&mut ()`, found `()`\n+   |     |\n    |     arguments to this function are incorrect\n+   |\n+help: consider mutably borrowing here\n+   |\n+LL |     (*p)(&mut ())\n+   |          ++++\n \n error: aborting due to previous error\n "}, {"sha": "40098f9622fa99c8c9ef97c3879b8370e6f09331", "filename": "tests/ui/issues/issue-18819.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fissues%2Fissue-18819.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fissues%2Fissue-18819.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fissues%2Fissue-18819.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -19,7 +19,7 @@ LL | fn print_x(_: &dyn Foo<Item=bool>, extra: &str) {\n help: consider borrowing here\n    |\n LL |     print_x(&X);\n-   |             ~~\n+   |             +\n help: provide the argument\n    |\n LL |     print_x(/* &dyn Foo<Item = bool> */, /* &str */);"}, {"sha": "6e126038cc95c074923d3cebdbc97960e6e6da53", "filename": "tests/ui/issues/issue-46302.stderr", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fissues%2Fissue-46302.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fissues%2Fissue-46302.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fissues%2Fissue-46302.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -2,10 +2,12 @@ error[E0308]: mismatched types\n   --> $DIR/issue-46302.rs:3:27\n    |\n LL |   let u: &str = if true { s[..2] } else { s };\n-   |                           ^^^^^^\n-   |                           |\n-   |                           expected `&str`, found `str`\n-   |                           help: consider borrowing here: `&s[..2]`\n+   |                           ^^^^^^ expected `&str`, found `str`\n+   |\n+help: consider borrowing here\n+   |\n+LL |   let u: &str = if true { &s[..2] } else { s };\n+   |                           +\n \n error: aborting due to previous error\n "}, {"sha": "211dd51289595a743586decc12e1868a13376625", "filename": "tests/ui/issues/issue-46756-consider-borrowing-cast-or-binexpr.stderr", "status": "modified", "additions": 12, "deletions": 8, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fissues%2Fissue-46756-consider-borrowing-cast-or-binexpr.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fissues%2Fissue-46756-consider-borrowing-cast-or-binexpr.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fissues%2Fissue-46756-consider-borrowing-cast-or-binexpr.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -2,33 +2,37 @@ error[E0308]: mismatched types\n   --> $DIR/issue-46756-consider-borrowing-cast-or-binexpr.rs:12:42\n    |\n LL |     light_flows_our_war_of_mocking_words(behold as usize);\n-   |     ------------------------------------ ^^^^^^^^^^^^^^^\n-   |     |                                    |\n-   |     |                                    expected `&usize`, found `usize`\n-   |     |                                    help: consider borrowing here: `&(behold as usize)`\n+   |     ------------------------------------ ^^^^^^^^^^^^^^^ expected `&usize`, found `usize`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n note: function defined here\n   --> $DIR/issue-46756-consider-borrowing-cast-or-binexpr.rs:5:4\n    |\n LL | fn light_flows_our_war_of_mocking_words(and_yet: &usize) -> usize {\n    |    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ ---------------\n+help: consider borrowing here\n+   |\n+LL |     light_flows_our_war_of_mocking_words(&(behold as usize));\n+   |                                          ++               +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-46756-consider-borrowing-cast-or-binexpr.rs:14:42\n    |\n LL |     light_flows_our_war_of_mocking_words(with_tears + 4);\n-   |     ------------------------------------ ^^^^^^^^^^^^^^\n-   |     |                                    |\n-   |     |                                    expected `&usize`, found `usize`\n-   |     |                                    help: consider borrowing here: `&(with_tears + 4)`\n+   |     ------------------------------------ ^^^^^^^^^^^^^^ expected `&usize`, found `usize`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n note: function defined here\n   --> $DIR/issue-46756-consider-borrowing-cast-or-binexpr.rs:5:4\n    |\n LL | fn light_flows_our_war_of_mocking_words(and_yet: &usize) -> usize {\n    |    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ ---------------\n+help: consider borrowing here\n+   |\n+LL |     light_flows_our_war_of_mocking_words(&(with_tears + 4));\n+   |                                          ++              +\n \n error: aborting due to 2 previous errors\n "}, {"sha": "aa922e2682d8347e1992b6debd4ec0f4bbf8c26a", "filename": "tests/ui/issues/issue-61106.stderr", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fissues%2Fissue-61106.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fissues%2Fissue-61106.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fissues%2Fissue-61106.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -2,17 +2,19 @@ error[E0308]: mismatched types\n   --> $DIR/issue-61106.rs:3:9\n    |\n LL |     foo(x.clone());\n-   |     --- ^^^^^^^^^\n-   |     |   |\n-   |     |   expected `&str`, found `String`\n-   |     |   help: consider borrowing here: `&x`\n+   |     --- ^^^^^^^^^ expected `&str`, found `String`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n note: function defined here\n   --> $DIR/issue-61106.rs:6:4\n    |\n LL | fn foo(_: &str) {}\n    |    ^^^ -------\n+help: consider borrowing here\n+   |\n+LL |     foo(&x.clone());\n+   |         +\n \n error: aborting due to previous error\n "}, {"sha": "dcc21acc5c0f484121d571828854e37031628942", "filename": "tests/ui/methods/method-self-arg-1.stderr", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fmethods%2Fmethod-self-arg-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fmethods%2Fmethod-self-arg-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmethods%2Fmethod-self-arg-1.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -2,17 +2,19 @@ error[E0308]: mismatched types\n   --> $DIR/method-self-arg-1.rs:11:14\n    |\n LL |     Foo::bar(x);\n-   |     -------- ^\n-   |     |        |\n-   |     |        expected `&Foo`, found `Foo`\n-   |     |        help: consider borrowing here: `&x`\n+   |     -------- ^ expected `&Foo`, found `Foo`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n note: method defined here\n   --> $DIR/method-self-arg-1.rs:6:8\n    |\n LL |     fn bar(&self) {}\n    |        ^^^ -----\n+help: consider borrowing here\n+   |\n+LL |     Foo::bar(&x);\n+   |              +\n \n error[E0308]: mismatched types\n   --> $DIR/method-self-arg-1.rs:13:14"}, {"sha": "7be94ef4ad66386138abcea42c766088c97fff1c", "filename": "tests/ui/mismatched_types/dont-point-return-on-E0308.stderr", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fmismatched_types%2Fdont-point-return-on-E0308.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fmismatched_types%2Fdont-point-return-on-E0308.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmismatched_types%2Fdont-point-return-on-E0308.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -2,17 +2,19 @@ error[E0308]: mismatched types\n   --> $DIR/dont-point-return-on-E0308.rs:11:11\n    |\n LL |         f(());\n-   |         - ^^\n-   |         | |\n-   |         | expected `&()`, found `()`\n-   |         | help: consider borrowing here: `&()`\n+   |         - ^^ expected `&()`, found `()`\n+   |         |\n    |         arguments to this function are incorrect\n    |\n note: function defined here\n   --> $DIR/dont-point-return-on-E0308.rs:3:10\n    |\n LL | async fn f(_: &()) {}\n    |          ^ ------\n+help: consider borrowing here\n+   |\n+LL |         f(&());\n+   |           +\n \n error: aborting due to previous error\n "}, {"sha": "8a3076db9b233978f4f7d13a9fd39b5ecac890f0", "filename": "tests/ui/mut/mut-cross-borrowing.stderr", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fmut%2Fmut-cross-borrowing.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fmut%2Fmut-cross-borrowing.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmut%2Fmut-cross-borrowing.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -2,10 +2,8 @@ error[E0308]: mismatched types\n   --> $DIR/mut-cross-borrowing.rs:7:7\n    |\n LL |     f(x)\n-   |     - ^\n-   |     | |\n-   |     | expected `&mut isize`, found `Box<{integer}>`\n-   |     | help: consider mutably borrowing here: `&mut x`\n+   |     - ^ expected `&mut isize`, found `Box<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected mutable reference `&mut isize`\n@@ -15,6 +13,10 @@ note: function defined here\n    |\n LL | fn f(_: &mut isize) {}\n    |    ^ -------------\n+help: consider mutably borrowing here\n+   |\n+LL |     f(&mut x)\n+   |       ++++\n \n error: aborting due to previous error\n "}, {"sha": "71c36c741cc5eab2e0b02335a6190d98397bf69f", "filename": "tests/ui/range/issue-54505-no-literals.fixed", "status": "modified", "additions": 12, "deletions": 12, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-54505-no-literals.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-54505-no-literals.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Frange%2Fissue-54505-no-literals.fixed?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -16,60 +16,60 @@ fn main() {\n     take_range(&std::ops::Range { start: 0, end: 1 });\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &std::ops::Range { start: 0, end: 1 }\n+    //~| SUGGESTION &\n \n     take_range(&::std::ops::Range { start: 0, end: 1 });\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &::std::ops::Range { start: 0, end: 1 }\n+    //~| SUGGESTION &\n \n     take_range(&std::ops::RangeFrom { start: 1 });\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &std::ops::RangeFrom { start: 1 }\n+    //~| SUGGESTION &\n \n     take_range(&::std::ops::RangeFrom { start: 1 });\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &::std::ops::RangeFrom { start: 1 }\n+    //~| SUGGESTION &\n \n     take_range(&std::ops::RangeFull {});\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &std::ops::RangeFull {}\n+    //~| SUGGESTION &\n \n     take_range(&::std::ops::RangeFull {});\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &::std::ops::RangeFull {}\n+    //~| SUGGESTION &\n \n     take_range(&std::ops::RangeInclusive::new(0, 1));\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &std::ops::RangeInclusive::new(0, 1)\n+    //~| SUGGESTION &\n \n     take_range(&::std::ops::RangeInclusive::new(0, 1));\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &::std::ops::RangeInclusive::new(0, 1)\n+    //~| SUGGESTION &\n \n     take_range(&std::ops::RangeTo { end: 5 });\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &std::ops::RangeTo { end: 5 }\n+    //~| SUGGESTION &\n \n     take_range(&::std::ops::RangeTo { end: 5 });\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &::std::ops::RangeTo { end: 5 }\n+    //~| SUGGESTION &\n \n     take_range(&std::ops::RangeToInclusive { end: 5 });\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &std::ops::RangeToInclusive { end: 5 }\n+    //~| SUGGESTION &\n \n     take_range(&::std::ops::RangeToInclusive { end: 5 });\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &::std::ops::RangeToInclusive { end: 5 }\n+    //~| SUGGESTION &\n }"}, {"sha": "db125d1a22b6de78ed296ddabe321a7bf518fa09", "filename": "tests/ui/range/issue-54505-no-literals.rs", "status": "modified", "additions": 12, "deletions": 12, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-54505-no-literals.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-54505-no-literals.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Frange%2Fissue-54505-no-literals.rs?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -16,60 +16,60 @@ fn main() {\n     take_range(std::ops::Range { start: 0, end: 1 });\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &std::ops::Range { start: 0, end: 1 }\n+    //~| SUGGESTION &\n \n     take_range(::std::ops::Range { start: 0, end: 1 });\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &::std::ops::Range { start: 0, end: 1 }\n+    //~| SUGGESTION &\n \n     take_range(std::ops::RangeFrom { start: 1 });\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &std::ops::RangeFrom { start: 1 }\n+    //~| SUGGESTION &\n \n     take_range(::std::ops::RangeFrom { start: 1 });\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &::std::ops::RangeFrom { start: 1 }\n+    //~| SUGGESTION &\n \n     take_range(std::ops::RangeFull {});\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &std::ops::RangeFull {}\n+    //~| SUGGESTION &\n \n     take_range(::std::ops::RangeFull {});\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &::std::ops::RangeFull {}\n+    //~| SUGGESTION &\n \n     take_range(std::ops::RangeInclusive::new(0, 1));\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &std::ops::RangeInclusive::new(0, 1)\n+    //~| SUGGESTION &\n \n     take_range(::std::ops::RangeInclusive::new(0, 1));\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &::std::ops::RangeInclusive::new(0, 1)\n+    //~| SUGGESTION &\n \n     take_range(std::ops::RangeTo { end: 5 });\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &std::ops::RangeTo { end: 5 }\n+    //~| SUGGESTION &\n \n     take_range(::std::ops::RangeTo { end: 5 });\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &::std::ops::RangeTo { end: 5 }\n+    //~| SUGGESTION &\n \n     take_range(std::ops::RangeToInclusive { end: 5 });\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &std::ops::RangeToInclusive { end: 5 }\n+    //~| SUGGESTION &\n \n     take_range(::std::ops::RangeToInclusive { end: 5 });\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &::std::ops::RangeToInclusive { end: 5 }\n+    //~| SUGGESTION &\n }"}, {"sha": "5894bb6ba553fab6856a4d35d3fad240573401af", "filename": "tests/ui/range/issue-54505-no-literals.stderr", "status": "modified", "additions": 72, "deletions": 48, "changes": 120, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-54505-no-literals.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-54505-no-literals.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Frange%2Fissue-54505-no-literals.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -2,10 +2,8 @@ error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-literals.rs:16:16\n    |\n LL |     take_range(std::ops::Range { start: 0, end: 1 });\n-   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `Range<{integer}>`\n-   |     |          help: consider borrowing here: `&std::ops::Range { start: 0, end: 1 }`\n+   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected `&_`, found `Range<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -15,15 +13,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&std::ops::Range { start: 0, end: 1 });\n+   |                +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-literals.rs:21:16\n    |\n LL |     take_range(::std::ops::Range { start: 0, end: 1 });\n-   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `Range<{integer}>`\n-   |     |          help: consider borrowing here: `&::std::ops::Range { start: 0, end: 1 }`\n+   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected `&_`, found `Range<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -33,15 +33,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&::std::ops::Range { start: 0, end: 1 });\n+   |                +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-literals.rs:26:16\n    |\n LL |     take_range(std::ops::RangeFrom { start: 1 });\n-   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeFrom<{integer}>`\n-   |     |          help: consider borrowing here: `&std::ops::RangeFrom { start: 1 }`\n+   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected `&_`, found `RangeFrom<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -51,15 +53,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&std::ops::RangeFrom { start: 1 });\n+   |                +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-literals.rs:31:16\n    |\n LL |     take_range(::std::ops::RangeFrom { start: 1 });\n-   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeFrom<{integer}>`\n-   |     |          help: consider borrowing here: `&::std::ops::RangeFrom { start: 1 }`\n+   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected `&_`, found `RangeFrom<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -69,15 +73,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&::std::ops::RangeFrom { start: 1 });\n+   |                +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-literals.rs:36:16\n    |\n LL |     take_range(std::ops::RangeFull {});\n-   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeFull`\n-   |     |          help: consider borrowing here: `&std::ops::RangeFull {}`\n+   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^ expected `&_`, found `RangeFull`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -87,15 +93,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&std::ops::RangeFull {});\n+   |                +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-literals.rs:41:16\n    |\n LL |     take_range(::std::ops::RangeFull {});\n-   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeFull`\n-   |     |          help: consider borrowing here: `&::std::ops::RangeFull {}`\n+   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^ expected `&_`, found `RangeFull`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -105,15 +113,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&::std::ops::RangeFull {});\n+   |                +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-literals.rs:46:16\n    |\n LL |     take_range(std::ops::RangeInclusive::new(0, 1));\n-   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeInclusive<{integer}>`\n-   |     |          help: consider borrowing here: `&std::ops::RangeInclusive::new(0, 1)`\n+   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected `&_`, found `RangeInclusive<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -123,15 +133,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&std::ops::RangeInclusive::new(0, 1));\n+   |                +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-literals.rs:51:16\n    |\n LL |     take_range(::std::ops::RangeInclusive::new(0, 1));\n-   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeInclusive<{integer}>`\n-   |     |          help: consider borrowing here: `&::std::ops::RangeInclusive::new(0, 1)`\n+   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected `&_`, found `RangeInclusive<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -141,15 +153,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&::std::ops::RangeInclusive::new(0, 1));\n+   |                +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-literals.rs:56:16\n    |\n LL |     take_range(std::ops::RangeTo { end: 5 });\n-   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeTo<{integer}>`\n-   |     |          help: consider borrowing here: `&std::ops::RangeTo { end: 5 }`\n+   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected `&_`, found `RangeTo<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -159,15 +173,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&std::ops::RangeTo { end: 5 });\n+   |                +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-literals.rs:61:16\n    |\n LL |     take_range(::std::ops::RangeTo { end: 5 });\n-   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeTo<{integer}>`\n-   |     |          help: consider borrowing here: `&::std::ops::RangeTo { end: 5 }`\n+   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected `&_`, found `RangeTo<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -177,15 +193,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&::std::ops::RangeTo { end: 5 });\n+   |                +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-literals.rs:66:16\n    |\n LL |     take_range(std::ops::RangeToInclusive { end: 5 });\n-   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeToInclusive<{integer}>`\n-   |     |          help: consider borrowing here: `&std::ops::RangeToInclusive { end: 5 }`\n+   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected `&_`, found `RangeToInclusive<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -195,15 +213,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&std::ops::RangeToInclusive { end: 5 });\n+   |                +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-literals.rs:71:16\n    |\n LL |     take_range(::std::ops::RangeToInclusive { end: 5 });\n-   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeToInclusive<{integer}>`\n-   |     |          help: consider borrowing here: `&::std::ops::RangeToInclusive { end: 5 }`\n+   |     ---------- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected `&_`, found `RangeToInclusive<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -213,6 +233,10 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&::std::ops::RangeToInclusive { end: 5 });\n+   |                +\n \n error: aborting due to 12 previous errors\n "}, {"sha": "db455fada3bd8a30adda84aef44e64147333d6b0", "filename": "tests/ui/range/issue-54505-no-std.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-54505-no-std.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-54505-no-std.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Frange%2Fissue-54505-no-std.rs?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -29,30 +29,30 @@ fn main() {\n     take_range(0..1);\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(0..1)\n+    //~| SUGGESTION &(\n \n     take_range(1..);\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(1..)\n+    //~| SUGGESTION &(\n \n     take_range(..);\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(..)\n+    //~| SUGGESTION &(\n \n     take_range(0..=1);\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(0..=1)\n+    //~| SUGGESTION &(\n \n     take_range(..5);\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(..5)\n+    //~| SUGGESTION &(\n \n     take_range(..=42);\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(..=42)\n+    //~| SUGGESTION &(\n }"}, {"sha": "13563d1940cb691d1759b929457fa2d541320667", "filename": "tests/ui/range/issue-54505-no-std.stderr", "status": "modified", "additions": 36, "deletions": 24, "changes": 60, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-54505-no-std.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-54505-no-std.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Frange%2Fissue-54505-no-std.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -14,10 +14,8 @@ error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-std.rs:29:16\n    |\n LL |     take_range(0..1);\n-   |     ---------- ^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `Range<{integer}>`\n-   |     |          help: consider borrowing here: `&(0..1)`\n+   |     ---------- ^^^^ expected `&_`, found `Range<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -27,15 +25,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&(0..1));\n+   |                ++    +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-std.rs:34:16\n    |\n LL |     take_range(1..);\n-   |     ---------- ^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeFrom<{integer}>`\n-   |     |          help: consider borrowing here: `&(1..)`\n+   |     ---------- ^^^ expected `&_`, found `RangeFrom<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -45,15 +45,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&(1..));\n+   |                ++   +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-std.rs:39:16\n    |\n LL |     take_range(..);\n-   |     ---------- ^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeFull`\n-   |     |          help: consider borrowing here: `&(..)`\n+   |     ---------- ^^ expected `&_`, found `RangeFull`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -63,15 +65,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&(..));\n+   |                ++  +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-std.rs:44:16\n    |\n LL |     take_range(0..=1);\n-   |     ---------- ^^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeInclusive<{integer}>`\n-   |     |          help: consider borrowing here: `&(0..=1)`\n+   |     ---------- ^^^^^ expected `&_`, found `RangeInclusive<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -81,15 +85,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&(0..=1));\n+   |                ++     +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-std.rs:49:16\n    |\n LL |     take_range(..5);\n-   |     ---------- ^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeTo<{integer}>`\n-   |     |          help: consider borrowing here: `&(..5)`\n+   |     ---------- ^^^ expected `&_`, found `RangeTo<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -99,15 +105,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&(..5));\n+   |                ++   +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505-no-std.rs:54:16\n    |\n LL |     take_range(..=42);\n-   |     ---------- ^^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeToInclusive<{integer}>`\n-   |     |          help: consider borrowing here: `&(..=42)`\n+   |     ---------- ^^^^^ expected `&_`, found `RangeToInclusive<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -117,6 +125,10 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&(..=42));\n+   |                ++     +\n \n error: aborting due to 8 previous errors\n "}, {"sha": "9d113ba1d35c2129f91ad1ed3d16939949639da4", "filename": "tests/ui/range/issue-54505.fixed", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-54505.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-54505.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Frange%2Fissue-54505.fixed?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -14,30 +14,30 @@ fn main() {\n     take_range(&(0..1));\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(0..1)\n+    //~| SUGGESTION &(\n \n     take_range(&(1..));\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(1..)\n+    //~| SUGGESTION &(\n \n     take_range(&(..));\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(..)\n+    //~| SUGGESTION &(\n \n     take_range(&(0..=1));\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(0..=1)\n+    //~| SUGGESTION &(\n \n     take_range(&(..5));\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(..5)\n+    //~| SUGGESTION &(\n \n     take_range(&(..=42));\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(..=42)\n+    //~| SUGGESTION &(\n }"}, {"sha": "c9929988fe539f0657e7f1254436c01bc44b4976", "filename": "tests/ui/range/issue-54505.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-54505.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-54505.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Frange%2Fissue-54505.rs?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -14,30 +14,30 @@ fn main() {\n     take_range(0..1);\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(0..1)\n+    //~| SUGGESTION &(\n \n     take_range(1..);\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(1..)\n+    //~| SUGGESTION &(\n \n     take_range(..);\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(..)\n+    //~| SUGGESTION &(\n \n     take_range(0..=1);\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(0..=1)\n+    //~| SUGGESTION &(\n \n     take_range(..5);\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(..5)\n+    //~| SUGGESTION &(\n \n     take_range(..=42);\n     //~^ ERROR mismatched types [E0308]\n     //~| HELP consider borrowing here\n-    //~| SUGGESTION &(..=42)\n+    //~| SUGGESTION &(\n }"}, {"sha": "0e959fc05e279e935ee21848a9d13064a8a4f9da", "filename": "tests/ui/range/issue-54505.stderr", "status": "modified", "additions": 36, "deletions": 24, "changes": 60, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-54505.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-54505.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Frange%2Fissue-54505.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -2,10 +2,8 @@ error[E0308]: mismatched types\n   --> $DIR/issue-54505.rs:14:16\n    |\n LL |     take_range(0..1);\n-   |     ---------- ^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `Range<{integer}>`\n-   |     |          help: consider borrowing here: `&(0..1)`\n+   |     ---------- ^^^^ expected `&_`, found `Range<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -15,15 +13,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&(0..1));\n+   |                ++    +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505.rs:19:16\n    |\n LL |     take_range(1..);\n-   |     ---------- ^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeFrom<{integer}>`\n-   |     |          help: consider borrowing here: `&(1..)`\n+   |     ---------- ^^^ expected `&_`, found `RangeFrom<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -33,15 +33,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&(1..));\n+   |                ++   +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505.rs:24:16\n    |\n LL |     take_range(..);\n-   |     ---------- ^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeFull`\n-   |     |          help: consider borrowing here: `&(..)`\n+   |     ---------- ^^ expected `&_`, found `RangeFull`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -51,15 +53,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&(..));\n+   |                ++  +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505.rs:29:16\n    |\n LL |     take_range(0..=1);\n-   |     ---------- ^^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeInclusive<{integer}>`\n-   |     |          help: consider borrowing here: `&(0..=1)`\n+   |     ---------- ^^^^^ expected `&_`, found `RangeInclusive<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -69,15 +73,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&(0..=1));\n+   |                ++     +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505.rs:34:16\n    |\n LL |     take_range(..5);\n-   |     ---------- ^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeTo<{integer}>`\n-   |     |          help: consider borrowing here: `&(..5)`\n+   |     ---------- ^^^ expected `&_`, found `RangeTo<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -87,15 +93,17 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&(..5));\n+   |                ++   +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-54505.rs:39:16\n    |\n LL |     take_range(..=42);\n-   |     ---------- ^^^^^\n-   |     |          |\n-   |     |          expected `&_`, found `RangeToInclusive<{integer}>`\n-   |     |          help: consider borrowing here: `&(..=42)`\n+   |     ---------- ^^^^^ expected `&_`, found `RangeToInclusive<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -105,6 +113,10 @@ note: function defined here\n    |\n LL | fn take_range(_r: &impl RangeBounds<i8>) {}\n    |    ^^^^^^^^^^ -------------------------\n+help: consider borrowing here\n+   |\n+LL |     take_range(&(..=42));\n+   |                ++     +\n \n error: aborting due to 6 previous errors\n "}, {"sha": "52efa241d0b12a4176f40c36636fb5a6cd8407c5", "filename": "tests/ui/range/issue-73553-misinterp-range-literal.stderr", "status": "modified", "additions": 12, "deletions": 8, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-73553-misinterp-range-literal.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Frange%2Fissue-73553-misinterp-range-literal.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Frange%2Fissue-73553-misinterp-range-literal.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -2,10 +2,8 @@ error[E0308]: mismatched types\n   --> $DIR/issue-73553-misinterp-range-literal.rs:12:10\n    |\n LL |     demo(tell(1)..tell(10));\n-   |     ---- ^^^^^^^^^^^^^^^^^\n-   |     |    |\n-   |     |    expected `&Range<usize>`, found `Range<usize>`\n-   |     |    help: consider borrowing here: `&(tell(1)..tell(10))`\n+   |     ---- ^^^^^^^^^^^^^^^^^ expected `&Range<usize>`, found `Range<usize>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&std::ops::Range<usize>`\n@@ -15,15 +13,17 @@ note: function defined here\n    |\n LL | fn demo(r: &Range) {\n    |    ^^^^ ---------\n+help: consider borrowing here\n+   |\n+LL |     demo(&(tell(1)..tell(10)));\n+   |          ++                 +\n \n error[E0308]: mismatched types\n   --> $DIR/issue-73553-misinterp-range-literal.rs:14:10\n    |\n LL |     demo(1..10);\n-   |     ---- ^^^^^\n-   |     |    |\n-   |     |    expected `&Range<usize>`, found `Range<{integer}>`\n-   |     |    help: consider borrowing here: `&(1..10)`\n+   |     ---- ^^^^^ expected `&Range<usize>`, found `Range<{integer}>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&std::ops::Range<usize>`\n@@ -33,6 +33,10 @@ note: function defined here\n    |\n LL | fn demo(r: &Range) {\n    |    ^^^^ ---------\n+help: consider borrowing here\n+   |\n+LL |     demo(&(1..10));\n+   |          ++     +\n \n error: aborting due to 2 previous errors\n "}, {"sha": "ff840b781f0721c6f32ebf8875acdf6932ca5b90", "filename": "tests/ui/span/coerce-suggestions.stderr", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fspan%2Fcoerce-suggestions.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fspan%2Fcoerce-suggestions.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fspan%2Fcoerce-suggestions.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -10,11 +10,14 @@ error[E0308]: mismatched types\n   --> $DIR/coerce-suggestions.rs:9:19\n    |\n LL |     let x: &str = String::new();\n-   |            ----   ^^^^^^^^^^^^^\n-   |            |      |\n-   |            |      expected `&str`, found `String`\n-   |            |      help: consider borrowing here: `&String::new()`\n+   |            ----   ^^^^^^^^^^^^^ expected `&str`, found `String`\n+   |            |\n    |            expected due to this\n+   |\n+help: consider borrowing here\n+   |\n+LL |     let x: &str = &String::new();\n+   |                   +\n \n error[E0308]: mismatched types\n   --> $DIR/coerce-suggestions.rs:12:10"}, {"sha": "c8c4a5139880d8e2ccd16816787914f680e3c9cf", "filename": "tests/ui/span/issue-39018.stderr", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fspan%2Fissue-39018.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fspan%2Fissue-39018.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fspan%2Fissue-39018.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -78,10 +78,12 @@ error[E0308]: mismatched types\n   --> $DIR/issue-39018.rs:29:17\n    |\n LL |     let _ = a + b;\n-   |                 ^\n-   |                 |\n-   |                 expected `&str`, found `String`\n-   |                 help: consider borrowing here: `&b`\n+   |                 ^ expected `&str`, found `String`\n+   |\n+help: consider borrowing here\n+   |\n+LL |     let _ = a + &b;\n+   |                 +\n \n error[E0369]: cannot add `String` to `&String`\n   --> $DIR/issue-39018.rs:30:15"}, {"sha": "515cb9e12f858c4fedd9d35e3ce9e0b26802dc73", "filename": "tests/ui/str/str-array-assignment.stderr", "status": "modified", "additions": 13, "deletions": 8, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fstr%2Fstr-array-assignment.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fstr%2Fstr-array-assignment.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fstr%2Fstr-array-assignment.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -10,10 +10,12 @@ error[E0308]: mismatched types\n   --> $DIR/str-array-assignment.rs:5:27\n    |\n LL |   let u: &str = if true { s[..2] } else { s };\n-   |                           ^^^^^^\n-   |                           |\n-   |                           expected `&str`, found `str`\n-   |                           help: consider borrowing here: `&s[..2]`\n+   |                           ^^^^^^ expected `&str`, found `str`\n+   |\n+help: consider borrowing here\n+   |\n+LL |   let u: &str = if true { &s[..2] } else { s };\n+   |                           +\n \n error[E0277]: the size for values of type `str` cannot be known at compilation time\n   --> $DIR/str-array-assignment.rs:7:7\n@@ -33,11 +35,14 @@ error[E0308]: mismatched types\n   --> $DIR/str-array-assignment.rs:9:17\n    |\n LL |   let w: &str = s[..2];\n-   |          ----   ^^^^^^\n-   |          |      |\n-   |          |      expected `&str`, found `str`\n-   |          |      help: consider borrowing here: `&s[..2]`\n+   |          ----   ^^^^^^ expected `&str`, found `str`\n+   |          |\n    |          expected due to this\n+   |\n+help: consider borrowing here\n+   |\n+LL |   let w: &str = &s[..2];\n+   |                 +\n \n error: aborting due to 4 previous errors\n "}, {"sha": "2147d2d92e389b05208a872a16b9f8ace5a2e1a3", "filename": "tests/ui/suggestions/as-ref.stderr", "status": "modified", "additions": 56, "deletions": 32, "changes": 88, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fsuggestions%2Fas-ref.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fsuggestions%2Fas-ref.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsuggestions%2Fas-ref.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -2,61 +2,73 @@ error[E0308]: mismatched types\n   --> $DIR/as-ref.rs:7:29\n    |\n LL |     opt.map(|arg| takes_ref(arg));\n-   |         ---       --------- ^^^ expected `&Foo`, found `Foo`\n-   |         |         |\n-   |         |         arguments to this function are incorrect\n-   |         help: consider using `as_ref` instead: `as_ref().map`\n+   |                   --------- ^^^ expected `&Foo`, found `Foo`\n+   |                   |\n+   |                   arguments to this function are incorrect\n    |\n note: function defined here\n   --> $DIR/as-ref.rs:3:4\n    |\n LL | fn takes_ref(_: &Foo) {}\n    |    ^^^^^^^^^ -------\n+help: consider using `as_ref` instead\n+   |\n+LL |     opt.as_ref().map(|arg| takes_ref(arg));\n+   |         +++++++++\n \n error[E0308]: mismatched types\n   --> $DIR/as-ref.rs:8:39\n    |\n LL |     opt.and_then(|arg| Some(takes_ref(arg)));\n-   |         --------            --------- ^^^ expected `&Foo`, found `Foo`\n-   |         |                   |\n-   |         |                   arguments to this function are incorrect\n-   |         help: consider using `as_ref` instead: `as_ref().and_then`\n+   |                             --------- ^^^ expected `&Foo`, found `Foo`\n+   |                             |\n+   |                             arguments to this function are incorrect\n    |\n note: function defined here\n   --> $DIR/as-ref.rs:3:4\n    |\n LL | fn takes_ref(_: &Foo) {}\n    |    ^^^^^^^^^ -------\n+help: consider using `as_ref` instead\n+   |\n+LL |     opt.as_ref().and_then(|arg| Some(takes_ref(arg)));\n+   |         +++++++++\n \n error[E0308]: mismatched types\n   --> $DIR/as-ref.rs:10:29\n    |\n LL |     opt.map(|arg| takes_ref(arg));\n-   |         ---       --------- ^^^ expected `&Foo`, found `Foo`\n-   |         |         |\n-   |         |         arguments to this function are incorrect\n-   |         help: consider using `as_ref` instead: `as_ref().map`\n+   |                   --------- ^^^ expected `&Foo`, found `Foo`\n+   |                   |\n+   |                   arguments to this function are incorrect\n    |\n note: function defined here\n   --> $DIR/as-ref.rs:3:4\n    |\n LL | fn takes_ref(_: &Foo) {}\n    |    ^^^^^^^^^ -------\n+help: consider using `as_ref` instead\n+   |\n+LL |     opt.as_ref().map(|arg| takes_ref(arg));\n+   |         +++++++++\n \n error[E0308]: mismatched types\n   --> $DIR/as-ref.rs:11:37\n    |\n LL |     opt.and_then(|arg| Ok(takes_ref(arg)));\n-   |         --------          --------- ^^^ expected `&Foo`, found `Foo`\n-   |         |                 |\n-   |         |                 arguments to this function are incorrect\n-   |         help: consider using `as_ref` instead: `as_ref().and_then`\n+   |                           --------- ^^^ expected `&Foo`, found `Foo`\n+   |                           |\n+   |                           arguments to this function are incorrect\n    |\n note: function defined here\n   --> $DIR/as-ref.rs:3:4\n    |\n LL | fn takes_ref(_: &Foo) {}\n    |    ^^^^^^^^^ -------\n+help: consider using `as_ref` instead\n+   |\n+LL |     opt.as_ref().and_then(|arg| Ok(takes_ref(arg)));\n+   |         +++++++++\n \n error[E0308]: mismatched types\n   --> $DIR/as-ref.rs:13:29\n@@ -101,61 +113,73 @@ error[E0308]: mismatched types\n   --> $DIR/as-ref.rs:22:42\n    |\n LL |     multiple_ref_opt.map(|arg| takes_ref(arg));\n-   |                      ---       --------- ^^^ expected `&Foo`, found `Foo`\n-   |                      |         |\n-   |                      |         arguments to this function are incorrect\n-   |                      help: consider using `as_ref` instead: `as_ref().map`\n+   |                                --------- ^^^ expected `&Foo`, found `Foo`\n+   |                                |\n+   |                                arguments to this function are incorrect\n    |\n note: function defined here\n   --> $DIR/as-ref.rs:3:4\n    |\n LL | fn takes_ref(_: &Foo) {}\n    |    ^^^^^^^^^ -------\n+help: consider using `as_ref` instead\n+   |\n+LL |     multiple_ref_opt.as_ref().map(|arg| takes_ref(arg));\n+   |                      +++++++++\n \n error[E0308]: mismatched types\n   --> $DIR/as-ref.rs:23:52\n    |\n LL |     multiple_ref_opt.and_then(|arg| Some(takes_ref(arg)));\n-   |                      --------            --------- ^^^ expected `&Foo`, found `Foo`\n-   |                      |                   |\n-   |                      |                   arguments to this function are incorrect\n-   |                      help: consider using `as_ref` instead: `as_ref().and_then`\n+   |                                          --------- ^^^ expected `&Foo`, found `Foo`\n+   |                                          |\n+   |                                          arguments to this function are incorrect\n    |\n note: function defined here\n   --> $DIR/as-ref.rs:3:4\n    |\n LL | fn takes_ref(_: &Foo) {}\n    |    ^^^^^^^^^ -------\n+help: consider using `as_ref` instead\n+   |\n+LL |     multiple_ref_opt.as_ref().and_then(|arg| Some(takes_ref(arg)));\n+   |                      +++++++++\n \n error[E0308]: mismatched types\n   --> $DIR/as-ref.rs:25:45\n    |\n LL |     multiple_ref_result.map(|arg| takes_ref(arg));\n-   |                         ---       --------- ^^^ expected `&Foo`, found `Foo`\n-   |                         |         |\n-   |                         |         arguments to this function are incorrect\n-   |                         help: consider using `as_ref` instead: `as_ref().map`\n+   |                                   --------- ^^^ expected `&Foo`, found `Foo`\n+   |                                   |\n+   |                                   arguments to this function are incorrect\n    |\n note: function defined here\n   --> $DIR/as-ref.rs:3:4\n    |\n LL | fn takes_ref(_: &Foo) {}\n    |    ^^^^^^^^^ -------\n+help: consider using `as_ref` instead\n+   |\n+LL |     multiple_ref_result.as_ref().map(|arg| takes_ref(arg));\n+   |                         +++++++++\n \n error[E0308]: mismatched types\n   --> $DIR/as-ref.rs:26:53\n    |\n LL |     multiple_ref_result.and_then(|arg| Ok(takes_ref(arg)));\n-   |                         --------          --------- ^^^ expected `&Foo`, found `Foo`\n-   |                         |                 |\n-   |                         |                 arguments to this function are incorrect\n-   |                         help: consider using `as_ref` instead: `as_ref().and_then`\n+   |                                           --------- ^^^ expected `&Foo`, found `Foo`\n+   |                                           |\n+   |                                           arguments to this function are incorrect\n    |\n note: function defined here\n   --> $DIR/as-ref.rs:3:4\n    |\n LL | fn takes_ref(_: &Foo) {}\n    |    ^^^^^^^^^ -------\n+help: consider using `as_ref` instead\n+   |\n+LL |     multiple_ref_result.as_ref().and_then(|arg| Ok(takes_ref(arg)));\n+   |                         +++++++++\n \n error: aborting due to 11 previous errors\n "}, {"sha": "730f5fa1b5e3de5455c4b092d78cc2eed0b15bd5", "filename": "tests/ui/suggestions/suggest-ref-macro.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fsuggestions%2Fsuggest-ref-macro.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fsuggestions%2Fsuggest-ref-macro.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsuggestions%2Fsuggest-ref-macro.rs?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -14,7 +14,7 @@ macro_rules! bla {\n     () => {\n         x(123);\n         //~^ ERROR mismatched types\n-        //~| SUGGESTION &mut 123\n+        //~| SUGGESTION &mut\n     };\n     ($v:expr) => {\n         x($v)\n@@ -25,5 +25,5 @@ fn main() {\n     bla!();\n     bla!(456);\n     //~^ ERROR mismatched types\n-    //~| SUGGESTION &mut 456\n+    //~| SUGGESTION &mut\n }"}, {"sha": "08bc9e86a50f87534a026522e2c1818457cfaf04", "filename": "tests/ui/suggestions/suggest-ref-macro.stderr", "status": "modified", "additions": 11, "deletions": 8, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fsuggestions%2Fsuggest-ref-macro.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Fsuggestions%2Fsuggest-ref-macro.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsuggestions%2Fsuggest-ref-macro.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -18,10 +18,8 @@ error[E0308]: mismatched types\n   --> $DIR/suggest-ref-macro.rs:15:11\n    |\n LL |         x(123);\n-   |         - ^^^\n-   |         | |\n-   |         | expected `&mut i32`, found integer\n-   |         | help: consider mutably borrowing here: `&mut 123`\n+   |         - ^^^ expected `&mut i32`, found integer\n+   |         |\n    |         arguments to this function are incorrect\n ...\n LL |     bla!();\n@@ -33,6 +31,10 @@ note: function defined here\n LL | fn x(_: &mut i32) {}\n    |    ^ -----------\n    = note: this error originates in the macro `bla` (in Nightly builds, run with -Z macro-backtrace for more info)\n+help: consider mutably borrowing here\n+   |\n+LL |         x(&mut 123);\n+   |           ++++\n \n error[E0308]: mismatched types\n   --> $DIR/suggest-ref-macro.rs:26:10\n@@ -41,16 +43,17 @@ LL |         x($v)\n    |         - arguments to this function are incorrect\n ...\n LL |     bla!(456);\n-   |          ^^^\n-   |          |\n-   |          expected `&mut i32`, found integer\n-   |          help: consider mutably borrowing here: `&mut 456`\n+   |          ^^^ expected `&mut i32`, found integer\n    |\n note: function defined here\n   --> $DIR/suggest-ref-macro.rs:11:4\n    |\n LL | fn x(_: &mut i32) {}\n    |    ^ -----------\n+help: consider mutably borrowing here\n+   |\n+LL |     bla!(&mut 456);\n+   |          ++++\n \n error: aborting due to 3 previous errors\n "}, {"sha": "ce6f29d354fd16c32fc8662bce88e67043e801a4", "filename": "tests/ui/type/type-mismatch.stderr", "status": "modified", "additions": 12, "deletions": 8, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Ftype%2Ftype-mismatch.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Ftype%2Ftype-mismatch.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftype%2Ftype-mismatch.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -378,10 +378,8 @@ error[E0308]: mismatched types\n   --> $DIR/type-mismatch.rs:47:23\n    |\n LL |     want::<&Foo<foo>>(f);\n-   |     ----------------- ^\n-   |     |                 |\n-   |     |                 expected `&Foo<foo>`, found `Foo<foo>`\n-   |     |                 help: consider borrowing here: `&f`\n+   |     ----------------- ^ expected `&Foo<foo>`, found `Foo<foo>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&Foo<foo>`\n@@ -391,6 +389,10 @@ note: function defined here\n    |\n LL | fn want<T>(t: T) {}\n    |    ^^^^    ----\n+help: consider borrowing here\n+   |\n+LL |     want::<&Foo<foo>>(&f);\n+   |                       +\n \n error[E0308]: mismatched types\n   --> $DIR/type-mismatch.rs:48:26\n@@ -556,10 +558,8 @@ error[E0308]: mismatched types\n   --> $DIR/type-mismatch.rs:61:26\n    |\n LL |     want::<&Foo<foo, B>>(f);\n-   |     -------------------- ^\n-   |     |                    |\n-   |     |                    expected `&Foo<foo, B>`, found `Foo<foo, B>`\n-   |     |                    help: consider borrowing here: `&f`\n+   |     -------------------- ^ expected `&Foo<foo, B>`, found `Foo<foo, B>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&Foo<foo, B>`\n@@ -569,6 +569,10 @@ note: function defined here\n    |\n LL | fn want<T>(t: T) {}\n    |    ^^^^    ----\n+help: consider borrowing here\n+   |\n+LL |     want::<&Foo<foo, B>>(&f);\n+   |                          +\n \n error[E0308]: mismatched types\n   --> $DIR/type-mismatch.rs:65:19"}, {"sha": "f9cdb280e276a320071154514c5fa89f6d2a9ac0", "filename": "tests/ui/typeck/bad-index-due-to-nested.stderr", "status": "modified", "additions": 10, "deletions": 8, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Ftypeck%2Fbad-index-due-to-nested.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Ftypeck%2Fbad-index-due-to-nested.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftypeck%2Fbad-index-due-to-nested.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -42,27 +42,29 @@ error[E0308]: mismatched types\n LL | fn index<'a, K, V>(map: &'a HashMap<K, V>, k: K) -> &'a V {\n    |              - this type parameter\n LL |     map[k]\n-   |         ^\n-   |         |\n-   |         expected `&K`, found type parameter `K`\n-   |         help: consider borrowing here: `&k`\n+   |         ^ expected `&K`, found type parameter `K`\n    |\n    = note:   expected reference `&K`\n            found type parameter `K`\n+help: consider borrowing here\n+   |\n+LL |     map[&k]\n+   |         +\n \n error[E0308]: mismatched types\n   --> $DIR/bad-index-due-to-nested.rs:20:5\n    |\n LL | fn index<'a, K, V>(map: &'a HashMap<K, V>, k: K) -> &'a V {\n    |                 - this type parameter               ----- expected `&'a V` because of return type\n LL |     map[k]\n-   |     ^^^^^^\n-   |     |\n-   |     expected `&V`, found type parameter `V`\n-   |     help: consider borrowing here: `&map[k]`\n+   |     ^^^^^^ expected `&V`, found type parameter `V`\n    |\n    = note:   expected reference `&'a V`\n            found type parameter `V`\n+help: consider borrowing here\n+   |\n+LL |     &map[k]\n+   |     +\n \n error: aborting due to 4 previous errors\n "}, {"sha": "b9b3a5fe5ec8f086c033a2389e1c2179fa0ddd1c", "filename": "tests/ui/typeck/bad-type-in-vec-contains.stderr", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Ftypeck%2Fbad-type-in-vec-contains.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Ftypeck%2Fbad-type-in-vec-contains.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftypeck%2Fbad-type-in-vec-contains.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -2,16 +2,18 @@ error[E0308]: mismatched types\n   --> $DIR/bad-type-in-vec-contains.rs:5:21\n    |\n LL |     primes.contains(3);\n-   |            -------- ^\n-   |            |        |\n-   |            |        expected `&_`, found integer\n-   |            |        help: consider borrowing here: `&3`\n+   |            -------- ^ expected `&_`, found integer\n+   |            |\n    |            arguments to this method are incorrect\n    |\n    = note: expected reference `&_`\n                    found type `{integer}`\n note: method defined here\n   --> $SRC_DIR/core/src/slice/mod.rs:LL:COL\n+help: consider borrowing here\n+   |\n+LL |     primes.contains(&3);\n+   |                     +\n \n error: aborting due to previous error\n "}, {"sha": "8ecb8b680160b6e880c4c031ea50449d6bb079d9", "filename": "tests/ui/typeck/issue-13853.stderr", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Ftypeck%2Fissue-13853.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Ftypeck%2Fissue-13853.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftypeck%2Fissue-13853.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -20,10 +20,8 @@ error[E0308]: mismatched types\n   --> $DIR/issue-13853.rs:37:13\n    |\n LL |     iterate(graph);\n-   |     ------- ^^^^^\n-   |     |       |\n-   |     |       expected `&_`, found `Vec<Stuff>`\n-   |     |       help: consider borrowing here: `&graph`\n+   |     ------- ^^^^^ expected `&_`, found `Vec<Stuff>`\n+   |     |\n    |     arguments to this function are incorrect\n    |\n    = note: expected reference `&_`\n@@ -33,6 +31,10 @@ note: function defined here\n    |\n LL | fn iterate<N: Node, G: Graph<N>>(graph: &G) {\n    |    ^^^^^^^                       ---------\n+help: consider borrowing here\n+   |\n+LL |     iterate(&graph);\n+   |             +\n \n error: aborting due to 3 previous errors\n "}, {"sha": "8741b35cdcff8bf786c64fc3c38fd87c0f02dc79", "filename": "tests/ui/unsized-locals/suggest-borrow.stderr", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Funsized-locals%2Fsuggest-borrow.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ecc72217b4f134a1ae8b6433af9491bf5d26cf0/tests%2Fui%2Funsized-locals%2Fsuggest-borrow.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Funsized-locals%2Fsuggest-borrow.stderr?ref=2ecc72217b4f134a1ae8b6433af9491bf5d26cf0", "patch": "@@ -16,11 +16,14 @@ error[E0308]: mismatched types\n   --> $DIR/suggest-borrow.rs:3:20\n    |\n LL |     let x: &[u8] = vec!(1, 2, 3)[..];\n-   |            -----   ^^^^^^^^^^^^^^^^^\n-   |            |       |\n-   |            |       expected `&[u8]`, found `[{integer}]`\n-   |            |       help: consider borrowing here: `&vec!(1, 2, 3)[..]`\n+   |            -----   ^^^^^^^^^^^^^^^^^ expected `&[u8]`, found `[{integer}]`\n+   |            |\n    |            expected due to this\n+   |\n+help: consider borrowing here\n+   |\n+LL |     let x: &[u8] = &vec!(1, 2, 3)[..];\n+   |                    +\n \n error[E0308]: mismatched types\n   --> $DIR/suggest-borrow.rs:4:19"}]}