{"sha": "6d2f8af1db238e0a2af73470be950bee65a692e6", "node_id": "C_kwDOAAsO6NoAKDZkMmY4YWYxZGIyMzhlMGEyYWY3MzQ3MGJlOTUwYmVlNjVhNjkyZTY", "commit": {"author": {"name": "Jacob Pratt", "email": "jacob@jhpratt.dev", "date": "2021-11-08T05:55:00Z"}, "committer": {"name": "Jacob Pratt", "email": "jacob@jhpratt.dev", "date": "2021-11-08T22:06:00Z"}, "message": "Permit const assertions in stdlib", "tree": {"sha": "5d9e4857ed697266ac3a7162d5a3775134140d6c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5d9e4857ed697266ac3a7162d5a3775134140d6c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6d2f8af1db238e0a2af73470be950bee65a692e6", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niHUEABYIAB0WIQTgxeqBxcDGar1sVhy4DhnkZitapAUCYYmfSAAKCRC4DhnkZita\npBVRAQDID1qOpaYFGtrIQLf4pCRFsmU6HlI/MqEibp+i4tMqSAEAo16gDvtCRlQc\n0cOK8Hme4V6GEtKU1T4vyTpf1tC2BQI=\n=BV4/\n-----END PGP SIGNATURE-----", "payload": "tree 5d9e4857ed697266ac3a7162d5a3775134140d6c\nparent 089a016919b0a9daaed9f676804102d6ba3f8f9d\nauthor Jacob Pratt <jacob@jhpratt.dev> 1636350900 -0500\ncommitter Jacob Pratt <jacob@jhpratt.dev> 1636409160 -0500\n\nPermit const assertions in stdlib\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6d2f8af1db238e0a2af73470be950bee65a692e6", "html_url": "https://github.com/rust-lang/rust/commit/6d2f8af1db238e0a2af73470be950bee65a692e6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6d2f8af1db238e0a2af73470be950bee65a692e6/comments", "author": {"login": "jhpratt", "id": 3161395, "node_id": "MDQ6VXNlcjMxNjEzOTU=", "avatar_url": "https://avatars.githubusercontent.com/u/3161395?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jhpratt", "html_url": "https://github.com/jhpratt", "followers_url": "https://api.github.com/users/jhpratt/followers", "following_url": "https://api.github.com/users/jhpratt/following{/other_user}", "gists_url": "https://api.github.com/users/jhpratt/gists{/gist_id}", "starred_url": "https://api.github.com/users/jhpratt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jhpratt/subscriptions", "organizations_url": "https://api.github.com/users/jhpratt/orgs", "repos_url": "https://api.github.com/users/jhpratt/repos", "events_url": "https://api.github.com/users/jhpratt/events{/privacy}", "received_events_url": "https://api.github.com/users/jhpratt/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jhpratt", "id": 3161395, "node_id": "MDQ6VXNlcjMxNjEzOTU=", "avatar_url": "https://avatars.githubusercontent.com/u/3161395?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jhpratt", "html_url": "https://github.com/jhpratt", "followers_url": "https://api.github.com/users/jhpratt/followers", "following_url": "https://api.github.com/users/jhpratt/following{/other_user}", "gists_url": "https://api.github.com/users/jhpratt/gists{/gist_id}", "starred_url": "https://api.github.com/users/jhpratt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jhpratt/subscriptions", "organizations_url": "https://api.github.com/users/jhpratt/orgs", "repos_url": "https://api.github.com/users/jhpratt/repos", "events_url": "https://api.github.com/users/jhpratt/events{/privacy}", "received_events_url": "https://api.github.com/users/jhpratt/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "089a016919b0a9daaed9f676804102d6ba3f8f9d", "url": "https://api.github.com/repos/rust-lang/rust/commits/089a016919b0a9daaed9f676804102d6ba3f8f9d", "html_url": "https://github.com/rust-lang/rust/commit/089a016919b0a9daaed9f676804102d6ba3f8f9d"}], "stats": {"total": 51, "additions": 49, "deletions": 2}, "files": [{"sha": "eedea6562bd4db2ca8d42c8dbd71354c10b10813", "filename": "library/core/src/panicking.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/6d2f8af1db238e0a2af73470be950bee65a692e6/library%2Fcore%2Fsrc%2Fpanicking.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6d2f8af1db238e0a2af73470be950bee65a692e6/library%2Fcore%2Fsrc%2Fpanicking.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fpanicking.rs?ref=6d2f8af1db238e0a2af73470be950bee65a692e6", "patch": "@@ -36,6 +36,7 @@ use crate::panic::{Location, PanicInfo};\n #[cfg_attr(not(feature = \"panic_immediate_abort\"), inline(never))]\n #[cfg_attr(feature = \"panic_immediate_abort\", inline)]\n #[track_caller]\n+#[rustc_const_unstable(feature = \"core_panic\", issue = \"none\")]\n #[lang = \"panic\"] // needed by codegen for panic on overflow and other `Assert` MIR terminators\n pub const fn panic(expr: &'static str) -> ! {\n     // Use Arguments::new_v1 instead of format_args!(\"{}\", expr) to potentially"}, {"sha": "7330c86a11a29502eb477ed2ad79b236fccc2e12", "filename": "library/core/src/time.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/6d2f8af1db238e0a2af73470be950bee65a692e6/library%2Fcore%2Fsrc%2Ftime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6d2f8af1db238e0a2af73470be950bee65a692e6/library%2Fcore%2Fsrc%2Ftime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Ftime.rs?ref=6d2f8af1db238e0a2af73470be950bee65a692e6", "patch": "@@ -727,7 +727,7 @@ impl Duration {\n     pub const fn from_secs_f64(secs: f64) -> Duration {\n         match Duration::try_from_secs_f64(secs) {\n             Ok(v) => v,\n-            Err(e) => crate::panicking::panic(e.description()),\n+            Err(e) => panic!(\"{}\", e.description()),\n         }\n     }\n \n@@ -788,7 +788,7 @@ impl Duration {\n     pub const fn from_secs_f32(secs: f32) -> Duration {\n         match Duration::try_from_secs_f32(secs) {\n             Ok(v) => v,\n-            Err(e) => crate::panicking::panic(e.description()),\n+            Err(e) => panic!(\"{}\", e.description()),\n         }\n     }\n "}, {"sha": "94cf64fff1999a5a2d2ada2292d8b74d946bae3f", "filename": "src/test/ui/consts/const-eval/const_panic_stability.e2018.stderr", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/6d2f8af1db238e0a2af73470be950bee65a692e6/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst_panic_stability.e2018.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/6d2f8af1db238e0a2af73470be950bee65a692e6/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst_panic_stability.e2018.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst_panic_stability.e2018.stderr?ref=6d2f8af1db238e0a2af73470be950bee65a692e6", "patch": "@@ -0,0 +1,16 @@\n+warning: panic message is not a string literal\n+  --> $DIR/const_panic_stability.rs:14:12\n+   |\n+LL |     panic!({ \"foo\" });\n+   |            ^^^^^^^^^\n+   |\n+   = note: `#[warn(non_fmt_panics)]` on by default\n+   = note: this usage of panic!() is deprecated; it will be a hard error in Rust 2021\n+   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/panic-macro-consistency.html>\n+help: add a \"{}\" format string to Display the message\n+   |\n+LL |     panic!(\"{}\", { \"foo\" });\n+   |            +++++\n+\n+warning: 1 warning emitted\n+"}, {"sha": "9e8179181fd09cd4b1cc53e248c47b27a70876c5", "filename": "src/test/ui/consts/const-eval/const_panic_stability.e2021.stderr", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/6d2f8af1db238e0a2af73470be950bee65a692e6/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst_panic_stability.e2021.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/6d2f8af1db238e0a2af73470be950bee65a692e6/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst_panic_stability.e2021.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst_panic_stability.e2021.stderr?ref=6d2f8af1db238e0a2af73470be950bee65a692e6", "patch": "@@ -0,0 +1,13 @@\n+error: format argument must be a string literal\n+  --> $DIR/const_panic_stability.rs:14:12\n+   |\n+LL |     panic!({ \"foo\" });\n+   |            ^^^^^^^^^\n+   |\n+help: you might be missing a string literal to format with\n+   |\n+LL |     panic!(\"{}\", { \"foo\" });\n+   |            +++++\n+\n+error: aborting due to previous error\n+"}, {"sha": "1aee6f27e2752384be92aa767d8ab27332b1553e", "filename": "src/test/ui/consts/const-eval/const_panic_stability.rs", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/6d2f8af1db238e0a2af73470be950bee65a692e6/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst_panic_stability.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6d2f8af1db238e0a2af73470be950bee65a692e6/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst_panic_stability.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst_panic_stability.rs?ref=6d2f8af1db238e0a2af73470be950bee65a692e6", "patch": "@@ -0,0 +1,17 @@\n+// revisions: e2018 e2021\n+//[e2018] edition:2018\n+//[e2021] edition:2021\n+//[e2018] check-pass\n+#![crate_type = \"lib\"]\n+#![stable(feature = \"foo\", since = \"1.0.0\")]\n+#![feature(staged_api)]\n+\n+#[stable(feature = \"foo\", since = \"1.0.0\")]\n+#[rustc_const_stable(feature = \"foo\", since = \"1.0.0\")]\n+const fn foo() {\n+    assert!(false);\n+    assert!(false, \"foo\");\n+    panic!({ \"foo\" });\n+    //[e2018]~^ WARNING panic message is not a string literal\n+    //[e2021]~^^ ERROR format argument must be a string literal\n+}"}]}