{"sha": "7bd8fbbd28f38669bc83cb734e2ffef44f3de9ae", "node_id": "C_kwDOAAsO6NoAKDdiZDhmYmJkMjhmMzg2NjliYzgzY2I3MzRlMmZmZWY0NGYzZGU5YWU", "commit": {"author": {"name": "Jakub Ber\u00e1nek", "email": "berykubik@gmail.com", "date": "2023-02-01T16:50:38Z"}, "committer": {"name": "Jakub Ber\u00e1nek", "email": "berykubik@gmail.com", "date": "2023-02-01T16:50:38Z"}, "message": "Print total duration in human time", "tree": {"sha": "1f3cfac775f83a6e02abd1bb15b0c25cd2464342", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1f3cfac775f83a6e02abd1bb15b0c25cd2464342"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7bd8fbbd28f38669bc83cb734e2ffef44f3de9ae", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEEzFQynJm4WzBnfhz8kJzQ0mSDUWsFAmPamF4ACgkQkJzQ0mSD\nUWth0Qv/Xx/07nAIJHHJ15wvh6W1DYd5nGxDnELUCXLl+3mdBpQLq1lifGqpdz5j\nRBcOSGPc/p1B+n7zEta63O2Eas8/QK5hMEHTLeIBVU//K+CiRFCA7tqJ3wcslyPO\nRJcHXETfROk4tB9BsDs2mVbibQgLELnX/sgGCQC8gkn1UFnX08XRRclln8ZCUhOd\nSYcNoKyzJbanQA8vQV3YnjtoMoyvPHDFsBS1gIdTpDuToebdRnoRTKht7ncffSxY\nMcyvtTXBdBOoeV6Dp/WwfOSHqN08gX9AWusJFp4ZAK3e8IJUt7YzD/AHixRIGd7p\nZjlL808FxYiiKRQnM1jRK3yAE7xGzj4CuwNVB1SAbYr6TdhsS6GEK6smoSLCgQcE\nxM7cf4GSHQF797LSGjb+PMMmUKiUPCv+UPHpawk+5vJJT02XqQu32ZzV0AkrFMgk\ngPgojWEMbcGaDTzcd8PsuoV2KojyZ3c+AI/vF0pE0wMv1MFkC9wjjelwBbsbz0i/\nHyZYlbUm\n=t+Xk\n-----END PGP SIGNATURE-----", "payload": "tree 1f3cfac775f83a6e02abd1bb15b0c25cd2464342\nparent 4bce0751492a3e08ac6f4998e06b4dfa72943cc2\nauthor Jakub Ber\u00e1nek <berykubik@gmail.com> 1675270238 +0100\ncommitter Jakub Ber\u00e1nek <berykubik@gmail.com> 1675270238 +0100\n\nPrint total duration in human time\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7bd8fbbd28f38669bc83cb734e2ffef44f3de9ae", "html_url": "https://github.com/rust-lang/rust/commit/7bd8fbbd28f38669bc83cb734e2ffef44f3de9ae", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7bd8fbbd28f38669bc83cb734e2ffef44f3de9ae/comments", "author": {"login": "Kobzol", "id": 4539057, "node_id": "MDQ6VXNlcjQ1MzkwNTc=", "avatar_url": "https://avatars.githubusercontent.com/u/4539057?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Kobzol", "html_url": "https://github.com/Kobzol", "followers_url": "https://api.github.com/users/Kobzol/followers", "following_url": "https://api.github.com/users/Kobzol/following{/other_user}", "gists_url": "https://api.github.com/users/Kobzol/gists{/gist_id}", "starred_url": "https://api.github.com/users/Kobzol/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Kobzol/subscriptions", "organizations_url": "https://api.github.com/users/Kobzol/orgs", "repos_url": "https://api.github.com/users/Kobzol/repos", "events_url": "https://api.github.com/users/Kobzol/events{/privacy}", "received_events_url": "https://api.github.com/users/Kobzol/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Kobzol", "id": 4539057, "node_id": "MDQ6VXNlcjQ1MzkwNTc=", "avatar_url": "https://avatars.githubusercontent.com/u/4539057?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Kobzol", "html_url": "https://github.com/Kobzol", "followers_url": "https://api.github.com/users/Kobzol/followers", "following_url": "https://api.github.com/users/Kobzol/following{/other_user}", "gists_url": "https://api.github.com/users/Kobzol/gists{/gist_id}", "starred_url": "https://api.github.com/users/Kobzol/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Kobzol/subscriptions", "organizations_url": "https://api.github.com/users/Kobzol/orgs", "repos_url": "https://api.github.com/users/Kobzol/repos", "events_url": "https://api.github.com/users/Kobzol/events{/privacy}", "received_events_url": "https://api.github.com/users/Kobzol/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4bce0751492a3e08ac6f4998e06b4dfa72943cc2", "url": "https://api.github.com/repos/rust-lang/rust/commits/4bce0751492a3e08ac6f4998e06b4dfa72943cc2", "html_url": "https://github.com/rust-lang/rust/commit/4bce0751492a3e08ac6f4998e06b4dfa72943cc2"}], "stats": {"total": 19, "additions": 17, "deletions": 2}, "files": [{"sha": "775478bcbab424354e45a42cb554db00d0a8ace5", "filename": "src/ci/stage-build.py", "status": "modified", "additions": 17, "deletions": 2, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/7bd8fbbd28f38669bc83cb734e2ffef44f3de9ae/src%2Fci%2Fstage-build.py", "raw_url": "https://github.com/rust-lang/rust/raw/7bd8fbbd28f38669bc83cb734e2ffef44f3de9ae/src%2Fci%2Fstage-build.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fstage-build.py?ref=7bd8fbbd28f38669bc83cb734e2ffef44f3de9ae", "patch": "@@ -241,7 +241,7 @@ def print_stats(self):\n             len(label) for label in list(self.stages.keys()) + [total_duration_label[:-1]]\n         )) + 1 + 2\n \n-        table_width = max_label_length + 24\n+        table_width = max_label_length + 23\n         divider = \"-\" * table_width\n \n         with StringIO() as output:\n@@ -253,7 +253,7 @@ def print_stats(self):\n                       file=output)\n \n             print(file=output)\n-            print(f\"{total_duration_label:<{max_label_length}} {total_duration:>12.2f}s\",\n+            print(f\"{total_duration_label:<{max_label_length}} {humantime(total_duration):>22}\",\n                   file=output)\n             print(divider, file=output, end=\"\")\n             LOGGER.info(f\"Timer results\\n{output.getvalue()}\")\n@@ -274,6 +274,21 @@ def change_cwd(dir: Path):\n         os.chdir(cwd)\n \n \n+def humantime(time_s: int) -> str:\n+    hours = time_s // 3600\n+    time_s = time_s % 3600\n+    minutes = time_s // 60\n+    seconds = time_s % 60\n+\n+    result = \"\"\n+    if hours > 0:\n+        result += f\"{int(hours)}h \"\n+    if minutes > 0:\n+        result += f\"{int(minutes)}m \"\n+    result += f\"{round(seconds)}s\"\n+    return result\n+\n+\n def move_path(src: Path, dst: Path):\n     LOGGER.info(f\"Moving `{src}` to `{dst}`\")\n     shutil.move(src, dst)"}]}