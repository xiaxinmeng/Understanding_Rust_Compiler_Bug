{"sha": "5ecda802f1f34e404082d01d33d0a9e85c035e48", "node_id": "C_kwDOAAsO6NoAKDVlY2RhODAyZjFmMzRlNDA0MDgyZDAxZDMzZDBhOWU4NWMwMzVlNDg", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2021-10-09T11:45:52Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2021-10-09T11:45:52Z"}, "message": "move test", "tree": {"sha": "4f19e0d0952c5d476e477e5253b951ad4e05fa51", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4f19e0d0952c5d476e477e5253b951ad4e05fa51"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5ecda802f1f34e404082d01d33d0a9e85c035e48", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5ecda802f1f34e404082d01d33d0a9e85c035e48", "html_url": "https://github.com/rust-lang/rust/commit/5ecda802f1f34e404082d01d33d0a9e85c035e48", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5ecda802f1f34e404082d01d33d0a9e85c035e48/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f4ee0d736c6cc857c0941526452e73f2585f8398", "url": "https://api.github.com/repos/rust-lang/rust/commits/f4ee0d736c6cc857c0941526452e73f2585f8398", "html_url": "https://github.com/rust-lang/rust/commit/f4ee0d736c6cc857c0941526452e73f2585f8398"}], "stats": {"total": 44, "additions": 23, "deletions": 21}, "files": [{"sha": "a5e941454c0d32549831eae3a691acd52ead7745", "filename": "crates/hir_def/src/macro_expansion_tests.rs", "status": "modified", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/5ecda802f1f34e404082d01d33d0a9e85c035e48/crates%2Fhir_def%2Fsrc%2Fmacro_expansion_tests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5ecda802f1f34e404082d01d33d0a9e85c035e48/crates%2Fhir_def%2Fsrc%2Fmacro_expansion_tests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_def%2Fsrc%2Fmacro_expansion_tests.rs?ref=5ecda802f1f34e404082d01d33d0a9e85c035e48", "patch": "@@ -180,6 +180,7 @@ macro_rules! m {\n         let _ = 1000;\n         let _ = 12E+99_f64;\n         let _ = \"rust1\";\n+        let _ = -92;\n     }\n }\n fn f() {\n@@ -193,13 +194,15 @@ macro_rules! m {\n         let _ = 1000;\n         let _ = 12E+99_f64;\n         let _ = \"rust1\";\n+        let _ = -92;\n     }\n }\n fn f() {\n     let_ = 'c';\n     let_ = 1000;\n     let_ = 12E+99_f64;\n     let_ = \"rust1\";\n+    let_ = -92;\n }\n \"#]],\n     );\n@@ -224,3 +227,23 @@ macro_rules! m2 { ($x:ident) => {} }\n \"#]],\n     )\n }\n+\n+#[test]\n+fn unary_minus_is_a_literal() {\n+    check(\n+        r#\"\n+macro_rules! m { ($x:literal) => (literal!()); ($x:tt) => (not_a_literal!()); }\n+m!(92);\n+m!(-92);\n+m!(-9.2);\n+m!(--92);\n+\"#,\n+        expect![[r#\"\n+macro_rules! m { ($x:literal) => (literal!()); ($x:tt) => (not_a_literal!()); }\n+literal!()\n+literal!()\n+literal!()\n+/* error: leftover tokens */not_a_literal!()\n+\"#]],\n+    )\n+}"}, {"sha": "0f852d33d5b120ba3f909c769ba1690d117467d3", "filename": "crates/mbe/src/subtree_source.rs", "status": "modified", "additions": 0, "deletions": 21, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/5ecda802f1f34e404082d01d33d0a9e85c035e48/crates%2Fmbe%2Fsrc%2Fsubtree_source.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5ecda802f1f34e404082d01d33d0a9e85c035e48/crates%2Fmbe%2Fsrc%2Fsubtree_source.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fmbe%2Fsrc%2Fsubtree_source.rs?ref=5ecda802f1f34e404082d01d33d0a9e85c035e48", "patch": "@@ -181,24 +181,3 @@ fn convert_leaf(leaf: &tt::Leaf) -> TtToken {\n         tt::Leaf::Punct(punct) => convert_punct(*punct),\n     }\n }\n-\n-#[cfg(test)]\n-mod tests {\n-    use super::{convert_literal, TtToken};\n-    use parser::Token;\n-    use syntax::{SmolStr, SyntaxKind};\n-\n-    #[test]\n-    fn test_negative_literal() {\n-        assert_eq!(\n-            convert_literal(&tt::Literal {\n-                id: tt::TokenId::unspecified(),\n-                text: SmolStr::new(\"-42.0\")\n-            }),\n-            TtToken {\n-                tt: Token { kind: SyntaxKind::FLOAT_NUMBER, is_jointed_to_next: false },\n-                text: SmolStr::new(\"-42.0\")\n-            }\n-        );\n-    }\n-}"}]}