{"sha": "1d16aed7f0993a07dcd7302487fa5781468b5f69", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFkMTZhZWQ3ZjA5OTNhMDdkY2Q3MzAyNDg3ZmE1NzgxNDY4YjVmNjk=", "commit": {"author": {"name": "Yuki Okushi", "email": "huyuumi.dev@gmail.com", "date": "2020-06-27T11:34:27Z"}, "committer": {"name": "Yuki Okushi", "email": "huyuumi.dev@gmail.com", "date": "2020-06-27T19:49:51Z"}, "message": "Add test for issue-72352", "tree": {"sha": "c88fe5d97631d2d0ad68e5f223bb6c44975321a3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c88fe5d97631d2d0ad68e5f223bb6c44975321a3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1d16aed7f0993a07dcd7302487fa5781468b5f69", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEXmatGLoofN5+9u4rsJhshcDi2qEFAl73ot8ACgkQsJhshcDi\n2qHasQ//clokMhGXtt+W3cTHzPf4FVbL5pY7MsJuhZtQzgVsnv7knpzZ2zQEkNkD\nmQik/Q7kC+0gAoOBCNJRSosV+bGkBS0PgR+xqo1xT6/E2zUeolkf2Nb3GdPyhoh/\nfmPBoLX/mqUGlrJ82BEGgAh4dO2jgJ9ltdp6uf/8N2A8fv+rkVUuCUirBNxyp++P\nPxg53TH3DIldAlEp08qfxoDUCgEC+5CiOkb3qEvfnTa3VGI3pdt4hyX9W4wcK7+c\n8NtCLpkPJ3vJ2WtqoxaC8jjcvo7UQ6lIr0a2E3QN1WpRfYHhlN/9aX/Qo6zce4vT\n5Yp+UeU6xQPxzp5JotRwF6mA9bCyVqCmsTq9Q5jCSr7ub6Agoj+Dkj0OsFEzFM4O\nWYB+L1XFJsgq2NSk9SCqsWLdeHFvR1RSX4062JYPzhST/n3lfLKQXemXED1bDJPf\nGCaCjJYFNGs0axZtv+BWlXeQ6Jsf5A4dAzpyZ0oAKO42iQ/qdiFCXSuIlJx0XvSq\nUl8iYVEjvDIzDFDhnYF8pwheg0lVPq/sl+0z5azMeSF814moYCtGUpqSlIim3x6w\n9bnZI16s3PUSaSThiutzpccyzYw8kZKWOE1d+hhpYLJW5tfweyfl3c3DdijGnbU+\ntzJiyqMeQSJ5T7TN3G+KVIk1XFLE6lGfAk7h4Nn78Wh8TSOArJA=\n=gDRT\n-----END PGP SIGNATURE-----", "payload": "tree c88fe5d97631d2d0ad68e5f223bb6c44975321a3\nparent 7125ce7ab7047ed00f488e16e569b037789d7d84\nauthor Yuki Okushi <huyuumi.dev@gmail.com> 1593257667 +0900\ncommitter Yuki Okushi <huyuumi.dev@gmail.com> 1593287391 +0900\n\nAdd test for issue-72352\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1d16aed7f0993a07dcd7302487fa5781468b5f69", "html_url": "https://github.com/rust-lang/rust/commit/1d16aed7f0993a07dcd7302487fa5781468b5f69", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1d16aed7f0993a07dcd7302487fa5781468b5f69/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7125ce7ab7047ed00f488e16e569b037789d7d84", "url": "https://api.github.com/repos/rust-lang/rust/commits/7125ce7ab7047ed00f488e16e569b037789d7d84", "html_url": "https://github.com/rust-lang/rust/commit/7125ce7ab7047ed00f488e16e569b037789d7d84"}], "stats": {"total": 29, "additions": 29, "deletions": 0}, "files": [{"sha": "e977af8deb719ea1a53a8c2a091bca161f51913b", "filename": "src/test/ui/const-generics/issues/issue-72352.rs", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/1d16aed7f0993a07dcd7302487fa5781468b5f69/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-72352.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1d16aed7f0993a07dcd7302487fa5781468b5f69/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-72352.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-72352.rs?ref=1d16aed7f0993a07dcd7302487fa5781468b5f69", "patch": "@@ -0,0 +1,21 @@\n+#![feature(const_generics)]\n+#![allow(incomplete_features)]\n+\n+use std::ffi::{CStr, CString};\n+\n+unsafe fn unsafely_do_the_thing<const F: fn(&CStr) -> usize>(ptr: *const i8) -> usize {\n+    //~^ ERROR: using function pointers as const generic parameters is forbidden\n+    F(CStr::from_ptr(ptr))\n+}\n+\n+fn safely_do_the_thing(s: &CStr) -> usize {\n+    s.to_bytes().len()\n+}\n+\n+fn main() {\n+    let baguette = CString::new(\"baguette\").unwrap();\n+    let ptr = baguette.as_ptr();\n+    println!(\"{}\", unsafe {\n+        unsafely_do_the_thing::<safely_do_the_thing>(ptr)\n+    });\n+}"}, {"sha": "bc48da103936bcdd56584de65ebc72d40523a64a", "filename": "src/test/ui/const-generics/issues/issue-72352.stderr", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/1d16aed7f0993a07dcd7302487fa5781468b5f69/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-72352.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/1d16aed7f0993a07dcd7302487fa5781468b5f69/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-72352.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconst-generics%2Fissues%2Fissue-72352.stderr?ref=1d16aed7f0993a07dcd7302487fa5781468b5f69", "patch": "@@ -0,0 +1,8 @@\n+error: using function pointers as const generic parameters is forbidden\n+  --> $DIR/issue-72352.rs:6:42\n+   |\n+LL | unsafe fn unsafely_do_the_thing<const F: fn(&CStr) -> usize>(ptr: *const i8) -> usize {\n+   |                                          ^^^^^^^^^^^^^^^^^^\n+\n+error: aborting due to previous error\n+"}]}