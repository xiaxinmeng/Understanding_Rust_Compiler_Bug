{"sha": "fe9929e303f4e0322fd0f38ec6cb6b3ec932e4a3", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZlOTkyOWUzMDNmNGUwMzIyZmQwZjM4ZWM2Y2I2YjNlYzkzMmU0YTM=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-07-28T09:07:27Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-07-28T09:07:27Z"}, "message": "auto merge of #8086 : luqmana/rust/rhelp, r=Aatch\n\n#7617 \r\n\r\nWhile the code that was there should've been perfectly fine (and seemingly is on linux at least) there seems to be some sort of weird interaction going on with statics and vectors. I couldn't get a smaller test case to reproduce that behaviour. The for loop in `rust::usage` seemingly just goes past the end of the vector thus getting garbage which it tries to pass to malloc somewhere down the line.\r\n\r\nIn any case, using a fixed length vector seems to mitigate this.", "tree": {"sha": "c3cdc7f7bcd73aa617d1ce5a408a9c4fb2d67439", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c3cdc7f7bcd73aa617d1ce5a408a9c4fb2d67439"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fe9929e303f4e0322fd0f38ec6cb6b3ec932e4a3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fe9929e303f4e0322fd0f38ec6cb6b3ec932e4a3", "html_url": "https://github.com/rust-lang/rust/commit/fe9929e303f4e0322fd0f38ec6cb6b3ec932e4a3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fe9929e303f4e0322fd0f38ec6cb6b3ec932e4a3/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "20454da2db9903688dfd60b826cc704de79767bc", "url": "https://api.github.com/repos/rust-lang/rust/commits/20454da2db9903688dfd60b826cc704de79767bc", "html_url": "https://github.com/rust-lang/rust/commit/20454da2db9903688dfd60b826cc704de79767bc"}, {"sha": "7bd6a92a5a73be334f09791bbc3c83468b10410c", "url": "https://api.github.com/repos/rust-lang/rust/commits/7bd6a92a5a73be334f09791bbc3c83468b10410c", "html_url": "https://github.com/rust-lang/rust/commit/7bd6a92a5a73be334f09791bbc3c83468b10410c"}], "stats": {"total": 8, "additions": 7, "deletions": 1}, "files": [{"sha": "746b75292315aecc52766e843ad45371eccc98cc", "filename": "src/librust/rust.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/fe9929e303f4e0322fd0f38ec6cb6b3ec932e4a3/src%2Flibrust%2Frust.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fe9929e303f4e0322fd0f38ec6cb6b3ec932e4a3/src%2Flibrust%2Frust.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrust%2Frust.rs?ref=fe9929e303f4e0322fd0f38ec6cb6b3ec932e4a3", "patch": "@@ -60,7 +60,13 @@ struct Command<'self> {\n     usage_full: UsageSource<'self>,\n }\n \n-static COMMANDS: &'static [Command<'static>] = &[\n+static NUM_OF_COMMANDS: uint = 7;\n+\n+// FIXME(#7617): should just be &'static [Command<'static>]\n+// but mac os doesn't seem to like that and tries to loop\n+// past the end of COMMANDS in usage thus passing garbage\n+// to str::repeat and eventually malloc and crashing.\n+static COMMANDS: [Command<'static>, .. NUM_OF_COMMANDS] = [\n     Command{\n         cmd: \"build\",\n         action: CallMain(\"rustc\", rustc::main),"}]}