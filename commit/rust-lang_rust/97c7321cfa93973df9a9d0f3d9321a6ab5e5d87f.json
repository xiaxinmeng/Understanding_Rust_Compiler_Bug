{"sha": "97c7321cfa93973df9a9d0f3d9321a6ab5e5d87f", "node_id": "C_kwDOAAsO6NoAKDk3YzczMjFjZmE5Mzk3M2RmOWE5ZDBmM2Q5MzIxYTZhYjVlNWQ4N2Y", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2022-03-18T14:37:59Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-03-18T14:37:59Z"}, "message": "Merge #11753\n\n11753: feat: Complete assoc const patterns on builtin types r=jonas-schievink a=jonas-schievink\n\nfollowup to https://github.com/rust-analyzer/rust-analyzer/pull/11713\r\n\r\nbors r+\n\nCo-authored-by: Jonas Schievink <jonas.schievink@ferrous-systems.com>", "tree": {"sha": "d95554b2291f2f561cc300cbbeec3a3d2e8a8d4e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d95554b2291f2f561cc300cbbeec3a3d2e8a8d4e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/97c7321cfa93973df9a9d0f3d9321a6ab5e5d87f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJiNJlHCRBK7hj4Ov3rIwAAuTgIAAwXjErVjhXooVYpwIciU7hR\nzNZdvfjUBQt3BGTaIQydEM0+Xc3tDIJ0tOEVBsX5uJlamtfklmC8mRSbPtUvYLt1\n0rF5K0jdP5Z9S7OkNBxt8t6CqUWqYpMLy2AMvkTM6o6kmyPVCbDL2WIKtnrIti4o\nfRzR6zj1b/MRzYEhiw2/pt9ClBone1/c3km3dYdbEYQu71e0Yz0oLeCAcF3i68qH\nUVgR0z9gt5r4KtHSwFsUN5+JoTGAbF4a0YKy5Z5OMITfCnFTcVaKXqfqmu7xptnl\n0S5hkJRx1CqpHiDF+WcHuMZL93pY3TI416XYGuojL1l1+zkAwxSPhyZuZiYT1Ew=\n=mIob\n-----END PGP SIGNATURE-----\n", "payload": "tree d95554b2291f2f561cc300cbbeec3a3d2e8a8d4e\nparent 849ac25f057c4edb4f2f58e479380b82d4967d0c\nparent 14203c63782a47f0bdf602fe65e1c282e3adfce3\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1647614279 +0000\ncommitter GitHub <noreply@github.com> 1647614279 +0000\n\nMerge #11753\n\n11753: feat: Complete assoc const patterns on builtin types r=jonas-schievink a=jonas-schievink\n\nfollowup to https://github.com/rust-analyzer/rust-analyzer/pull/11713\r\n\r\nbors r+\n\nCo-authored-by: Jonas Schievink <jonas.schievink@ferrous-systems.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/97c7321cfa93973df9a9d0f3d9321a6ab5e5d87f", "html_url": "https://github.com/rust-lang/rust/commit/97c7321cfa93973df9a9d0f3d9321a6ab5e5d87f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/97c7321cfa93973df9a9d0f3d9321a6ab5e5d87f/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "849ac25f057c4edb4f2f58e479380b82d4967d0c", "url": "https://api.github.com/repos/rust-lang/rust/commits/849ac25f057c4edb4f2f58e479380b82d4967d0c", "html_url": "https://github.com/rust-lang/rust/commit/849ac25f057c4edb4f2f58e479380b82d4967d0c"}, {"sha": "14203c63782a47f0bdf602fe65e1c282e3adfce3", "url": "https://api.github.com/repos/rust-lang/rust/commits/14203c63782a47f0bdf602fe65e1c282e3adfce3", "html_url": "https://github.com/rust-lang/rust/commit/14203c63782a47f0bdf602fe65e1c282e3adfce3"}], "stats": {"total": 31, "additions": 28, "deletions": 3}, "files": [{"sha": "0d3a49c668d73d54fec1ae36c508150d77284bd1", "filename": "crates/ide_completion/src/completions/pattern.rs", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/97c7321cfa93973df9a9d0f3d9321a6ab5e5d87f/crates%2Fide_completion%2Fsrc%2Fcompletions%2Fpattern.rs", "raw_url": "https://github.com/rust-lang/rust/raw/97c7321cfa93973df9a9d0f3d9321a6ab5e5d87f/crates%2Fide_completion%2Fsrc%2Fcompletions%2Fpattern.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_completion%2Fsrc%2Fcompletions%2Fpattern.rs?ref=97c7321cfa93973df9a9d0f3d9321a6ab5e5d87f", "patch": "@@ -141,7 +141,8 @@ fn pattern_path_completion(\n                 | hir::PathResolution::SelfType(_)\n                 | hir::PathResolution::Def(hir::ModuleDef::Adt(hir::Adt::Struct(_)))\n                 | hir::PathResolution::Def(hir::ModuleDef::Adt(hir::Adt::Enum(_)))\n-                | hir::PathResolution::Def(hir::ModuleDef::Adt(hir::Adt::Union(_)))) => {\n+                | hir::PathResolution::Def(hir::ModuleDef::Adt(hir::Adt::Union(_)))\n+                | hir::PathResolution::Def(hir::ModuleDef::BuiltinType(_))) => {\n                     let ty = match res {\n                         hir::PathResolution::TypeParam(param) => param.ty(ctx.db),\n                         hir::PathResolution::SelfType(impl_def) => impl_def.self_ty(ctx.db),\n@@ -158,6 +159,13 @@ fn pattern_path_completion(\n                         hir::PathResolution::Def(hir::ModuleDef::Adt(hir::Adt::Union(u))) => {\n                             u.ty(ctx.db)\n                         }\n+                        hir::PathResolution::Def(hir::ModuleDef::BuiltinType(ty)) => {\n+                            let module = match ctx.module {\n+                                Some(m) => m,\n+                                None => return,\n+                            };\n+                            ty.ty(ctx.db, module)\n+                        }\n                         _ => return,\n                     };\n "}, {"sha": "405a128b7e0f76c16965b536eb8eec9fa82dfcf0", "filename": "crates/ide_completion/src/tests/pattern.rs", "status": "modified", "additions": 19, "deletions": 2, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/97c7321cfa93973df9a9d0f3d9321a6ab5e5d87f/crates%2Fide_completion%2Fsrc%2Ftests%2Fpattern.rs", "raw_url": "https://github.com/rust-lang/rust/raw/97c7321cfa93973df9a9d0f3d9321a6ab5e5d87f/crates%2Fide_completion%2Fsrc%2Ftests%2Fpattern.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_completion%2Fsrc%2Ftests%2Fpattern.rs?ref=97c7321cfa93973df9a9d0f3d9321a6ab5e5d87f", "patch": "@@ -493,7 +493,6 @@ fn f(e: MyEnum) {\n \n     check_empty(\n         r#\"\n-#[repr(C)]\n union U {\n     i: i32,\n     f: f32,\n@@ -515,5 +514,23 @@ fn f(u: U) {\n             ct C pub const C: i32\n             ct D pub const D: i32\n         \"#]],\n-    )\n+    );\n+\n+    check_empty(\n+        r#\"\n+#[lang = \"u32\"]\n+impl u32 {\n+    pub const MIN: Self = 0;\n+}\n+\n+fn f(v: u32) {\n+    match v {\n+        u32::$0\n+    }\n+}\n+        \"#,\n+        expect![[r#\"\n+            ct MIN pub const MIN: Self\n+        \"#]],\n+    );\n }"}]}