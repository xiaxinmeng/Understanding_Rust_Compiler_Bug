{"sha": "87b6326d672f5d40b14460bdedebf4f69288fb6a", "node_id": "C_kwDOAAsO6NoAKDg3YjYzMjZkNjcyZjVkNDBiMTQ0NjBiZGVkZWJmNGY2OTI4OGZiNmE", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-05-05T18:19:40Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-05-05T18:19:40Z"}, "message": "Improve settings loading strategy by loading CSS and JS at the same time to prevent the style to be applied afterwards on slow connections", "tree": {"sha": "39accf7138d1c7b72f18d2c901e1d38c67bc3a00", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/39accf7138d1c7b72f18d2c901e1d38c67bc3a00"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/87b6326d672f5d40b14460bdedebf4f69288fb6a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/87b6326d672f5d40b14460bdedebf4f69288fb6a", "html_url": "https://github.com/rust-lang/rust/commit/87b6326d672f5d40b14460bdedebf4f69288fb6a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/87b6326d672f5d40b14460bdedebf4f69288fb6a/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "12d3f107c1634ed41a800e220ccf99b665d906d8", "url": "https://api.github.com/repos/rust-lang/rust/commits/12d3f107c1634ed41a800e220ccf99b665d906d8", "html_url": "https://github.com/rust-lang/rust/commit/12d3f107c1634ed41a800e220ccf99b665d906d8"}], "stats": {"total": 8, "additions": 4, "deletions": 4}, "files": [{"sha": "a6b64cd54af865b13fcfe9d0d9b167d518a0f4fb", "filename": "src/librustdoc/html/static/js/main.js", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/87b6326d672f5d40b14460bdedebf4f69288fb6a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/87b6326d672f5d40b14460bdedebf4f69288fb6a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js?ref=87b6326d672f5d40b14460bdedebf4f69288fb6a", "patch": "@@ -303,6 +303,9 @@ function loadCss(cssFileName) {\n \n     getSettingsButton().onclick = event => {\n         event.preventDefault();\n+        // Sending request for the CSS and the JS files at the same time so it will\n+        // hopefully be loaded when the JS will generate the settings content.\n+        loadCss(\"settings\");\n         loadScript(window.settingsJS);\n     };\n "}, {"sha": "ac483dbb4197334cb3ac6195fbe64304ee770a70", "filename": "src/librustdoc/html/static/js/settings.js", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/87b6326d672f5d40b14460bdedebf4f69288fb6a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js", "raw_url": "https://github.com/rust-lang/rust/raw/87b6326d672f5d40b14460bdedebf4f69288fb6a/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js?ref=87b6326d672f5d40b14460bdedebf4f69288fb6a", "patch": "@@ -3,7 +3,7 @@\n /* eslint prefer-const: \"error\" */\n /* eslint prefer-arrow-callback: \"error\" */\n // Local js definitions:\n-/* global getSettingValue, getVirtualKey, updateLocalStorage, updateSystemTheme, loadCss */\n+/* global getSettingValue, getVirtualKey, updateLocalStorage, updateSystemTheme */\n /* global addClass, removeClass, onEach, onEachLazy, NOT_DISPLAYED_ID */\n /* global MAIN_ID, getVar, getSettingsButton, switchDisplayedElement, getNotDisplayedElem */\n \n@@ -207,9 +207,6 @@\n             },\n         ];\n \n-        // First, we add the settings.css file.\n-        loadCss(\"settings\");\n-\n         // Then we build the DOM.\n         const el = document.createElement(\"section\");\n         el.id = \"settings\";"}]}