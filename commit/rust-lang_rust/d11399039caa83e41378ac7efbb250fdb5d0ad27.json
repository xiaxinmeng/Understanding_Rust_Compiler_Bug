{"sha": "d11399039caa83e41378ac7efbb250fdb5d0ad27", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQxMTM5OTAzOWNhYTgzZTQxMzc4YWM3ZWZiYjI1MGZkYjVkMGFkMjc=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-05-23T12:47:16Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-05-23T12:47:16Z"}, "message": "Auto merge of #25632 - alexcrichton:dt-dir, r=brson\n\nThis \"fast path\" in `DirEntry::file_type` on Unix wasn't turning out to be so\r\nmuch of a fast path as the `DT_DIR` case wasn't handled, so directories fell\r\nback to using `lstat` instead. This commit adds the missing case to return\r\nquickly if a path is a directory and `DirEntry::file_type` is used.", "tree": {"sha": "4959cd38bca4a997062b518bc6fa19107ca612d1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4959cd38bca4a997062b518bc6fa19107ca612d1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d11399039caa83e41378ac7efbb250fdb5d0ad27", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d11399039caa83e41378ac7efbb250fdb5d0ad27", "html_url": "https://github.com/rust-lang/rust/commit/d11399039caa83e41378ac7efbb250fdb5d0ad27", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d11399039caa83e41378ac7efbb250fdb5d0ad27/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4c2ebc3947568f5ca11c4e8a97538296b4f78285", "url": "https://api.github.com/repos/rust-lang/rust/commits/4c2ebc3947568f5ca11c4e8a97538296b4f78285", "html_url": "https://github.com/rust-lang/rust/commit/4c2ebc3947568f5ca11c4e8a97538296b4f78285"}, {"sha": "e7aad2861422a4fb65808d2a8a6dbeb22e6a0c1d", "url": "https://api.github.com/repos/rust-lang/rust/commits/e7aad2861422a4fb65808d2a8a6dbeb22e6a0c1d", "html_url": "https://github.com/rust-lang/rust/commit/e7aad2861422a4fb65808d2a8a6dbeb22e6a0c1d"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "1a2917a1dd67f9c8d0251fff51b1d8b0cbc425b4", "filename": "src/rt/rust_builtin.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d11399039caa83e41378ac7efbb250fdb5d0ad27/src%2Frt%2Frust_builtin.c", "raw_url": "https://github.com/rust-lang/rust/raw/d11399039caa83e41378ac7efbb250fdb5d0ad27/src%2Frt%2Frust_builtin.c", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_builtin.c?ref=d11399039caa83e41378ac7efbb250fdb5d0ad27", "patch": "@@ -59,14 +59,15 @@ rust_list_dir_val(struct dirent* entry_ptr) {\n \n int\n rust_dir_get_mode(struct dirent* entry_ptr) {\n-#if defined(_DIRENT_HAVE_D_TYPE)\n+#if defined(_DIRENT_HAVE_D_TYPE) || defined(__APPLE__)\n     switch (entry_ptr->d_type) {\n         case DT_BLK: return S_IFBLK;\n         case DT_CHR: return S_IFCHR;\n         case DT_FIFO: return S_IFIFO;\n         case DT_LNK: return S_IFLNK;\n         case DT_REG: return S_IFREG;\n         case DT_SOCK: return S_IFSOCK;\n+        case DT_DIR: return S_IFDIR;\n     }\n #endif\n     return -1;"}]}