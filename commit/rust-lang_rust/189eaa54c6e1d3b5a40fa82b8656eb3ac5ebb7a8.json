{"sha": "189eaa54c6e1d3b5a40fa82b8656eb3ac5ebb7a8", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE4OWVhYTU0YzZlMWQzYjVhNDBmYTgyYjg2NTZlYjNhYzVlYmI3YTg=", "commit": {"author": {"name": "James Wang", "email": "jameswang9909@hotmail.com", "date": "2019-09-28T01:46:55Z"}, "committer": {"name": "James Wang", "email": "jameswang9909@hotmail.com", "date": "2019-09-28T01:47:00Z"}, "message": "Ignore impls derived from macros", "tree": {"sha": "a0c4a7549d577c9e4bdce0d8fa57dd778d0658d0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a0c4a7549d577c9e4bdce0d8fa57dd778d0658d0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/189eaa54c6e1d3b5a40fa82b8656eb3ac5ebb7a8", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEET45e6DXvnW8XRtRTW4DAs/JjzVsFAl2Ou5QACgkQW4DAs/Jj\nzVsCNRAAoYm8IKYZCTN9Bsk4u0L3B08NY6DdpbIVhkRDlgtgCQY6EKAQjyUXZyIt\nTJYOt+am4y0B34yTSEQliEjrPHTRlf0f9WgDakdzY3StuJzvfEkgiuXYnJjZXLZH\n4xXzkkPcAAd16umnmdI7jiN8t3lDEl19QHjs1hRWode35kAQaoaHBVqQ5ZPDwaRC\nL3doMHhNQPMIHGv2XWsd0ZGQm4eKWunUplD1X4U96JJFQSYaFTL4GtU6ShZ+dK7P\nW9yfwaiU9B5biG/vlJq3NFYSI9LXCZBXK7alQet8vS07vo0zBDfsBTHUSxV0K//g\nemd0izxmEwtkhm1hByJ3s//BZDS8E6N55l6f9dagCIBoxLFOWIFSshBMhwegSQfh\nPMCOGeoKtcbxFHXxwX6wnB3jyuYzjwXgjQbJ2N5HhK1Upg3e2SFVWYURjHggPpcs\nw+Fefrif7o61k0R1bssAgPrMLI5jnGlC8/piv1KRnvFddAU43HyjvZcc2fQz9QBO\ncP9y6lEQUK7QufL3QBcMnhobCK/MnjvH2sIH6P0j/93e07ijEVrhP0fqpj/FT/GM\nF0uATq0fI027r3Y9dCMtSPDGXiaF4zDVnDU8hBa+Zgp29fSJixvtonIJjKuuK4ia\nx+jGQ8kGMyDS2QucW8wzgkkycyFoeqOmXv+zmLvMOqzyQ+MQp/M=\n=dhYt\n-----END PGP SIGNATURE-----", "payload": "tree a0c4a7549d577c9e4bdce0d8fa57dd778d0658d0\nparent edd90473ec5ba29b9ae1ee706c982e7046a6e63e\nauthor James Wang <jameswang9909@hotmail.com> 1569635215 -0500\ncommitter James Wang <jameswang9909@hotmail.com> 1569635220 -0500\n\nIgnore impls derived from macros\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/189eaa54c6e1d3b5a40fa82b8656eb3ac5ebb7a8", "html_url": "https://github.com/rust-lang/rust/commit/189eaa54c6e1d3b5a40fa82b8656eb3ac5ebb7a8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/189eaa54c6e1d3b5a40fa82b8656eb3ac5ebb7a8/comments", "author": {"login": "james9909", "id": 9091144, "node_id": "MDQ6VXNlcjkwOTExNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/9091144?v=4", "gravatar_id": "", "url": "https://api.github.com/users/james9909", "html_url": "https://github.com/james9909", "followers_url": "https://api.github.com/users/james9909/followers", "following_url": "https://api.github.com/users/james9909/following{/other_user}", "gists_url": "https://api.github.com/users/james9909/gists{/gist_id}", "starred_url": "https://api.github.com/users/james9909/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/james9909/subscriptions", "organizations_url": "https://api.github.com/users/james9909/orgs", "repos_url": "https://api.github.com/users/james9909/repos", "events_url": "https://api.github.com/users/james9909/events{/privacy}", "received_events_url": "https://api.github.com/users/james9909/received_events", "type": "User", "site_admin": false}, "committer": {"login": "james9909", "id": 9091144, "node_id": "MDQ6VXNlcjkwOTExNDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/9091144?v=4", "gravatar_id": "", "url": "https://api.github.com/users/james9909", "html_url": "https://github.com/james9909", "followers_url": "https://api.github.com/users/james9909/followers", "following_url": "https://api.github.com/users/james9909/following{/other_user}", "gists_url": "https://api.github.com/users/james9909/gists{/gist_id}", "starred_url": "https://api.github.com/users/james9909/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/james9909/subscriptions", "organizations_url": "https://api.github.com/users/james9909/orgs", "repos_url": "https://api.github.com/users/james9909/repos", "events_url": "https://api.github.com/users/james9909/events{/privacy}", "received_events_url": "https://api.github.com/users/james9909/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "edd90473ec5ba29b9ae1ee706c982e7046a6e63e", "url": "https://api.github.com/repos/rust-lang/rust/commits/edd90473ec5ba29b9ae1ee706c982e7046a6e63e", "html_url": "https://github.com/rust-lang/rust/commit/edd90473ec5ba29b9ae1ee706c982e7046a6e63e"}], "stats": {"total": 31, "additions": 29, "deletions": 2}, "files": [{"sha": "063aade4e7f875332367c6b266068daec39f7aaf", "filename": "clippy_lints/src/inherent_impl.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/189eaa54c6e1d3b5a40fa82b8656eb3ac5ebb7a8/clippy_lints%2Fsrc%2Finherent_impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/189eaa54c6e1d3b5a40fa82b8656eb3ac5ebb7a8/clippy_lints%2Fsrc%2Finherent_impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Finherent_impl.rs?ref=189eaa54c6e1d3b5a40fa82b8656eb3ac5ebb7a8", "patch": "@@ -1,6 +1,6 @@\n //! lint on inherent implementations\n \n-use crate::utils::span_lint_and_then;\n+use crate::utils::{in_macro, span_lint_and_then};\n use rustc::hir::*;\n use rustc::lint::{LateContext, LateLintPass, LintArray, LintPass};\n use rustc::{declare_tool_lint, impl_lint_pass};\n@@ -52,7 +52,8 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for MultipleInherentImpl {\n         if let ItemKind::Impl(_, _, _, ref generics, None, _, _) = item.kind {\n             // Remember for each inherent implementation encoutered its span and generics\n             // but filter out implementations that have generic params (type or lifetime)\n-            if generics.params.len() == 0 {\n+            // or are derived from a macro\n+            if !in_macro(item.span) && generics.params.len() == 0 {\n                 self.impls.insert(item.hir_id.owner_def_id(), item.span);\n             }\n         }"}, {"sha": "aeb27b5ba8c2fbfe36da4e533e0a0b14ec9b5e0e", "filename": "tests/ui/crashes/inherent_impl.rs", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/189eaa54c6e1d3b5a40fa82b8656eb3ac5ebb7a8/tests%2Fui%2Fcrashes%2Finherent_impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/189eaa54c6e1d3b5a40fa82b8656eb3ac5ebb7a8/tests%2Fui%2Fcrashes%2Finherent_impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcrashes%2Finherent_impl.rs?ref=189eaa54c6e1d3b5a40fa82b8656eb3ac5ebb7a8", "patch": "@@ -0,0 +1,26 @@\n+#![deny(clippy::multiple_inherent_impl)]\n+\n+/// Test for https://github.com/rust-lang/rust-clippy/issues/4578\n+\n+macro_rules! impl_foo {\n+    ($struct:ident) => {\n+        impl $struct {\n+            fn foo() {}\n+        }\n+    };\n+}\n+\n+macro_rules! impl_bar {\n+    ($struct:ident) => {\n+        impl $struct {\n+            fn bar() {}\n+        }\n+    };\n+}\n+\n+struct MyStruct;\n+\n+impl_foo!(MyStruct);\n+impl_bar!(MyStruct);\n+\n+fn main() {}"}]}