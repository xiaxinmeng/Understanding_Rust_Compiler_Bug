{"sha": "efea645c94451efbb6ac4be29c6307b434057ff2", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVmZWE2NDVjOTQ0NTFlZmJiNmFjNGJlMjljNjMwN2I0MzQwNTdmZjI=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2015-01-21T17:18:56Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2015-01-21T17:18:56Z"}, "message": "rollup merge of #21446: stepancheg/boxed-test\n\nConflicts:\n\tsrc/liballoc/boxed.rs", "tree": {"sha": "244a8ba3e4756a1a8da1a54c86a0deb285341173", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/244a8ba3e4756a1a8da1a54c86a0deb285341173"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/efea645c94451efbb6ac4be29c6307b434057ff2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/efea645c94451efbb6ac4be29c6307b434057ff2", "html_url": "https://github.com/rust-lang/rust/commit/efea645c94451efbb6ac4be29c6307b434057ff2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/efea645c94451efbb6ac4be29c6307b434057ff2/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "907db6c8344a4df070ee2b21479062a63c3ae2be", "url": "https://api.github.com/repos/rust-lang/rust/commits/907db6c8344a4df070ee2b21479062a63c3ae2be", "html_url": "https://github.com/rust-lang/rust/commit/907db6c8344a4df070ee2b21479062a63c3ae2be"}, {"sha": "ace2f09d3f89e20a7caa67bb0548212b07f696c2", "url": "https://api.github.com/repos/rust-lang/rust/commits/ace2f09d3f89e20a7caa67bb0548212b07f696c2", "html_url": "https://github.com/rust-lang/rust/commit/ace2f09d3f89e20a7caa67bb0548212b07f696c2"}], "stats": {"total": 131, "additions": 77, "deletions": 54}, "files": [{"sha": "dd953cabe7ef88ed91195c3494e828fe81028c28", "filename": "src/liballoc/boxed.rs", "status": "modified", "additions": 0, "deletions": 54, "changes": 54, "blob_url": "https://github.com/rust-lang/rust/blob/efea645c94451efbb6ac4be29c6307b434057ff2/src%2Fliballoc%2Fboxed.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efea645c94451efbb6ac4be29c6307b434057ff2/src%2Fliballoc%2Fboxed.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Fboxed.rs?ref=efea645c94451efbb6ac4be29c6307b434057ff2", "patch": "@@ -201,57 +201,3 @@ impl<'a, T> Iterator for Box<Iterator<Item=T> + 'a> {\n         (**self).size_hint()\n     }\n }\n-\n-#[cfg(test)]\n-mod test {\n-    #[test]\n-    fn test_owned_clone() {\n-        let a = Box::new(5i);\n-        let b: Box<int> = a.clone();\n-        assert!(a == b);\n-    }\n-\n-    #[test]\n-    fn any_move() {\n-        let a = Box::new(8u) as Box<Any>;\n-        let b = Box::new(Test) as Box<Any>;\n-\n-        match a.downcast::<uint>() {\n-            Ok(a) => { assert!(a == Box::new(8u)); }\n-            Err(..) => panic!()\n-        }\n-        match b.downcast::<Test>() {\n-            Ok(a) => { assert!(a == Box::new(Test)); }\n-            Err(..) => panic!()\n-        }\n-\n-        let a = Box::new(8u) as Box<Any>;\n-        let b = Box::new(Test) as Box<Any>;\n-\n-        assert!(a.downcast::<Box<Test>>().is_err());\n-        assert!(b.downcast::<Box<uint>>().is_err());\n-    }\n-\n-    #[test]\n-    fn test_show() {\n-        let a = Box::new(8u) as Box<Any>;\n-        let b = Box::new(Test) as Box<Any>;\n-        let a_str = a.to_str();\n-        let b_str = b.to_str();\n-        assert_eq!(a_str, \"Box<Any>\");\n-        assert_eq!(b_str, \"Box<Any>\");\n-\n-        let a = &8u as &Any;\n-        let b = &Test as &Any;\n-        let s = format!(\"{}\", a);\n-        assert_eq!(s, \"&Any\");\n-        let s = format!(\"{}\", b);\n-        assert_eq!(s, \"&Any\");\n-    }\n-\n-    #[test]\n-    fn deref() {\n-        fn homura<T: Deref<Target=i32>>(_: T) { }\n-        homura(Box::new(765i32));\n-    }\n-}"}, {"sha": "c47a771f60d09ceb2ad74fed5a754413f396a34a", "filename": "src/liballoc/boxed_test.rs", "status": "added", "additions": 75, "deletions": 0, "changes": 75, "blob_url": "https://github.com/rust-lang/rust/blob/efea645c94451efbb6ac4be29c6307b434057ff2/src%2Fliballoc%2Fboxed_test.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efea645c94451efbb6ac4be29c6307b434057ff2/src%2Fliballoc%2Fboxed_test.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Fboxed_test.rs?ref=efea645c94451efbb6ac4be29c6307b434057ff2", "patch": "@@ -0,0 +1,75 @@\n+// Copyright 2012-2015 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+//! Test for `boxed` mod.\n+\n+use core::any::Any;\n+use core::ops::Deref;\n+use core::result::Result::{Ok, Err};\n+use core::clone::Clone;\n+\n+use std::boxed::Box;\n+use std::boxed::BoxAny;\n+\n+#[test]\n+fn test_owned_clone() {\n+    let a = Box::new(5i);\n+    let b: Box<int> = a.clone();\n+    assert!(a == b);\n+}\n+\n+#[derive(PartialEq, Eq)]\n+struct Test;\n+\n+#[test]\n+fn any_move() {\n+    let a = Box::new(8u) as Box<Any>;\n+    let b = Box::new(Test) as Box<Any>;\n+\n+    match a.downcast::<uint>() {\n+        Ok(a) => { assert!(a == Box::new(8u)); }\n+        Err(..) => panic!()\n+    }\n+    match b.downcast::<Test>() {\n+        Ok(a) => { assert!(a == Box::new(Test)); }\n+        Err(..) => panic!()\n+    }\n+\n+    let a = Box::new(8u) as Box<Any>;\n+    let b = Box::new(Test) as Box<Any>;\n+\n+    assert!(a.downcast::<Box<Test>>().is_err());\n+    assert!(b.downcast::<Box<uint>>().is_err());\n+}\n+\n+#[test]\n+fn test_show() {\n+    let a = Box::new(8u) as Box<Any>;\n+    let b = Box::new(Test) as Box<Any>;\n+    let a_str = format!(\"{:?}\", a);\n+    let b_str = format!(\"{:?}\", b);\n+    assert_eq!(a_str, \"Box<Any>\");\n+    assert_eq!(b_str, \"Box<Any>\");\n+\n+    static EIGHT: usize = 8us;\n+    static TEST: Test = Test;\n+    let a = &EIGHT as &Any;\n+    let b = &TEST as &Any;\n+    let s = format!(\"{:?}\", a);\n+    assert_eq!(s, \"&Any\");\n+    let s = format!(\"{:?}\", b);\n+    assert_eq!(s, \"&Any\");\n+}\n+\n+#[test]\n+fn deref() {\n+    fn homura<T: Deref<Target=i32>>(_: T) { }\n+    homura(Box::new(765i32));\n+}"}, {"sha": "231ef6e7e74daf3ecea897e5d2b2ff1aabe14286", "filename": "src/liballoc/lib.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/efea645c94451efbb6ac4be29c6307b434057ff2/src%2Fliballoc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efea645c94451efbb6ac4be29c6307b434057ff2/src%2Fliballoc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Flib.rs?ref=efea645c94451efbb6ac4be29c6307b434057ff2", "patch": "@@ -93,6 +93,8 @@ pub mod heap;\n \n #[cfg(not(test))]\n pub mod boxed;\n+#[cfg(test)]\n+mod boxed_test;\n pub mod arc;\n pub mod rc;\n "}]}