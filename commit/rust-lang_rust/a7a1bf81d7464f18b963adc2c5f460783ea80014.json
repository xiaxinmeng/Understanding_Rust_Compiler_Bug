{"sha": "a7a1bf81d7464f18b963adc2c5f460783ea80014", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE3YTFiZjgxZDc0NjRmMThiOTYzYWRjMmM1ZjQ2MDc4M2VhODAwMTQ=", "commit": {"author": {"name": "Colin Davidson", "email": "colrdavidson@gmail.com", "date": "2014-09-21T04:36:17Z"}, "committer": {"name": "Colin Davidson", "email": "colrdavidson@gmail.com", "date": "2014-09-21T06:17:31Z"}, "message": "Move -Z lto to -C lto.\n\nCloses #12443", "tree": {"sha": "eb6181c9d5d1f94fbc19604a926c11a9b5ee6bb3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/eb6181c9d5d1f94fbc19604a926c11a9b5ee6bb3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a7a1bf81d7464f18b963adc2c5f460783ea80014", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a7a1bf81d7464f18b963adc2c5f460783ea80014", "html_url": "https://github.com/rust-lang/rust/commit/a7a1bf81d7464f18b963adc2c5f460783ea80014", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a7a1bf81d7464f18b963adc2c5f460783ea80014/comments", "author": {"login": "colrdavidson", "id": 6327402, "node_id": "MDQ6VXNlcjYzMjc0MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/6327402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/colrdavidson", "html_url": "https://github.com/colrdavidson", "followers_url": "https://api.github.com/users/colrdavidson/followers", "following_url": "https://api.github.com/users/colrdavidson/following{/other_user}", "gists_url": "https://api.github.com/users/colrdavidson/gists{/gist_id}", "starred_url": "https://api.github.com/users/colrdavidson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/colrdavidson/subscriptions", "organizations_url": "https://api.github.com/users/colrdavidson/orgs", "repos_url": "https://api.github.com/users/colrdavidson/repos", "events_url": "https://api.github.com/users/colrdavidson/events{/privacy}", "received_events_url": "https://api.github.com/users/colrdavidson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "colrdavidson", "id": 6327402, "node_id": "MDQ6VXNlcjYzMjc0MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/6327402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/colrdavidson", "html_url": "https://github.com/colrdavidson", "followers_url": "https://api.github.com/users/colrdavidson/followers", "following_url": "https://api.github.com/users/colrdavidson/following{/other_user}", "gists_url": "https://api.github.com/users/colrdavidson/gists{/gist_id}", "starred_url": "https://api.github.com/users/colrdavidson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/colrdavidson/subscriptions", "organizations_url": "https://api.github.com/users/colrdavidson/orgs", "repos_url": "https://api.github.com/users/colrdavidson/repos", "events_url": "https://api.github.com/users/colrdavidson/events{/privacy}", "received_events_url": "https://api.github.com/users/colrdavidson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d7e1bb5ff4622694d48905e944c1cf9bea7a5da7", "url": "https://api.github.com/repos/rust-lang/rust/commits/d7e1bb5ff4622694d48905e944c1cf9bea7a5da7", "html_url": "https://github.com/rust-lang/rust/commit/d7e1bb5ff4622694d48905e944c1cf9bea7a5da7"}], "stats": {"total": 22, "additions": 11, "deletions": 11}, "files": [{"sha": "56212ee1bff44c8b56d1d6f39b84beddfa214b79", "filename": "src/librustc/driver/config.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Flibrustc%2Fdriver%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Flibrustc%2Fdriver%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fdriver%2Fconfig.rs?ref=a7a1bf81d7464f18b963adc2c5f460783ea80014", "patch": "@@ -180,7 +180,6 @@ debugging_opts!(\n         GC,\n         PRINT_LINK_ARGS,\n         PRINT_LLVM_PASSES,\n-        LTO,\n         AST_JSON,\n         AST_JSON_NOEXPAND,\n         LS,\n@@ -219,7 +218,6 @@ pub fn debugging_opts_map() -> Vec<(&'static str, &'static str, u64)> {\n      (\"print-llvm-passes\",\n       \"Prints the llvm optimization passes being run\",\n       PRINT_LLVM_PASSES),\n-     (\"lto\", \"Perform LLVM link-time optimizations\", LTO),\n      (\"ast-json\", \"Print the AST as JSON and halt\", AST_JSON),\n      (\"ast-json-noexpand\", \"Print the pre-expansion AST as JSON and halt\", AST_JSON_NOEXPAND),\n      (\"ls\", \"List the symbols defined by a library crate\", LS),\n@@ -353,6 +351,8 @@ cgoptions!(\n         \"system linker to link outputs with\"),\n     link_args: Vec<String> = (Vec::new(), parse_list,\n         \"extra arguments to pass to the linker (space separated)\"),\n+    lto: bool = (false, parse_bool,\n+        \"perform LLVM link-time optimizations\"),\n     target_cpu: String = (\"generic\".to_string(), parse_string,\n         \"select target processor (llc -mcpu=help for details)\"),\n     target_feature: String = (\"\".to_string(), parse_string,"}, {"sha": "0de0bcc09bf93e1514dafecd682a50d6c63a2aa3", "filename": "src/librustc/driver/session.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Flibrustc%2Fdriver%2Fsession.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Flibrustc%2Fdriver%2Fsession.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fdriver%2Fsession.rs?ref=a7a1bf81d7464f18b963adc2c5f460783ea80014", "patch": "@@ -168,7 +168,7 @@ impl Session {\n         self.debugging_opt(config::PRINT_LLVM_PASSES)\n     }\n     pub fn lto(&self) -> bool {\n-        self.debugging_opt(config::LTO)\n+        self.opts.cg.lto\n     }\n     pub fn no_landing_pads(&self) -> bool {\n         self.debugging_opt(config::NO_LANDING_PADS)"}, {"sha": "1ff6812337406b9602ea71aa12b905d382b0f6f9", "filename": "src/test/compile-fail/issue-11154.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Ftest%2Fcompile-fail%2Fissue-11154.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Ftest%2Fcompile-fail%2Fissue-11154.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-11154.rs?ref=a7a1bf81d7464f18b963adc2c5f460783ea80014", "patch": "@@ -8,7 +8,7 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n-// compile-flags: -Z lto -C prefer-dynamic\n+// compile-flags: -C lto -C prefer-dynamic\n \n // error-pattern: cannot prefer dynamic linking\n "}, {"sha": "4a29ecff06f3b463b42ecfe8fb4a188f168e6ea7", "filename": "src/test/debuginfo/cross-crate-type-uniquing.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Ftest%2Fdebuginfo%2Fcross-crate-type-uniquing.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Ftest%2Fdebuginfo%2Fcross-crate-type-uniquing.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fdebuginfo%2Fcross-crate-type-uniquing.rs?ref=a7a1bf81d7464f18b963adc2c5f460783ea80014", "patch": "@@ -14,7 +14,7 @@\n extern crate cross_crate_debuginfo_type_uniquing;\n \n // no-prefer-dynamic\n-// compile-flags:-g -Zlto\n+// compile-flags:-g -C lto\n \n pub struct C;\n pub fn p() -> C {"}, {"sha": "446c6e5c81b69830b7b8158aa728588b4cbd430d", "filename": "src/test/run-make/issue-14500/Makefile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Ftest%2Frun-make%2Fissue-14500%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Ftest%2Frun-make%2Fissue-14500%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fissue-14500%2FMakefile?ref=a7a1bf81d7464f18b963adc2c5f460783ea80014", "patch": "@@ -8,7 +8,7 @@\n \n all:\n \t$(RUSTC) foo.rs --crate-type=rlib\n-\t$(RUSTC) bar.rs --crate-type=staticlib -Zlto -L. -o $(TMPDIR)/libbar.a\n+\t$(RUSTC) bar.rs --crate-type=staticlib -C lto -L. -o $(TMPDIR)/libbar.a\n \t$(CC) foo.c -lbar -o $(call RUN_BINFILE,foo) $(EXTRACFLAGS)\n \t$(call RUN,foo)\n "}, {"sha": "c678a3c472b1b0ab82d69d40b2866599083e1683", "filename": "src/test/run-make/lto-smoke-c/Makefile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Ftest%2Frun-make%2Flto-smoke-c%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Ftest%2Frun-make%2Flto-smoke-c%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Flto-smoke-c%2FMakefile?ref=a7a1bf81d7464f18b963adc2c5f460783ea80014", "patch": "@@ -4,6 +4,6 @@\n CC := $(CC:-g=)\n \n all:\n-\t$(RUSTC) foo.rs -Z lto\n+\t$(RUSTC) foo.rs -C lto\n \t$(CC) bar.c -lfoo -o $(call RUN_BINFILE,bar) $(EXTRACFLAGS) -lstdc++\n \t$(call RUN,bar)"}, {"sha": "020252e1f8cd3ac2d331da714e0d2747aca61397", "filename": "src/test/run-make/lto-smoke/Makefile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Ftest%2Frun-make%2Flto-smoke%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Ftest%2Frun-make%2Flto-smoke%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Flto-smoke%2FMakefile?ref=a7a1bf81d7464f18b963adc2c5f460783ea80014", "patch": "@@ -2,5 +2,5 @@\n \n all:\n \t$(RUSTC) lib.rs\n-\t$(RUSTC) main.rs -Z lto\n+\t$(RUSTC) main.rs -C lto\n \t$(call RUN,main)"}, {"sha": "5f2b7a701a7c415aa7abae930e0fd2daff3e7557", "filename": "src/test/run-make/lto-syntax-extension/Makefile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Ftest%2Frun-make%2Flto-syntax-extension%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Ftest%2Frun-make%2Flto-syntax-extension%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Flto-syntax-extension%2FMakefile?ref=a7a1bf81d7464f18b963adc2c5f460783ea80014", "patch": "@@ -14,5 +14,5 @@ all: $(DOTEST)\n dotest:\n \tenv\n \t$(RUSTC) lib.rs\n-\t$(RUSTC) main.rs -Z lto\n+\t$(RUSTC) main.rs -C lto\n \t$(call RUN,main)"}, {"sha": "f0b6a505929c66e9a67bcb6ec08034c3fbdcd4a9", "filename": "src/test/run-pass/sepcomp-lib-lto.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Ftest%2Frun-pass%2Fsepcomp-lib-lto.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a7a1bf81d7464f18b963adc2c5f460783ea80014/src%2Ftest%2Frun-pass%2Fsepcomp-lib-lto.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fsepcomp-lib-lto.rs?ref=a7a1bf81d7464f18b963adc2c5f460783ea80014", "patch": "@@ -8,11 +8,11 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n \n-// Check that we can use `-Z lto` when linking against libraries that were\n+// Check that we can use `-C lto` when linking against libraries that were\n // separately compiled.\n \n // aux-build:sepcomp_lib.rs\n-// compile-flags: -Z lto\n+// compile-flags: -C lto\n // no-prefer-dynamic\n \n extern crate sepcomp_lib;"}]}