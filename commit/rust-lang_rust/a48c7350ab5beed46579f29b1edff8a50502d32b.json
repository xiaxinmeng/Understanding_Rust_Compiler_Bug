{"sha": "a48c7350ab5beed46579f29b1edff8a50502d32b", "node_id": "C_kwDOAAsO6NoAKGE0OGM3MzUwYWI1YmVlZDQ2NTc5ZjI5YjFlZGZmOGE1MDUwMmQzMmI", "commit": {"author": {"name": "Dylan DPC", "email": "99973273+Dylan-DPC@users.noreply.github.com", "date": "2023-05-05T13:10:33Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-05-05T13:10:33Z"}, "message": "Rollup merge of #108801 - fee1-dead-contrib:c-str, r=compiler-errors\n\nImplement RFC 3348, `c\"foo\"` literals\n\nRFC: https://github.com/rust-lang/rfcs/pull/3348\nTracking issue: #105723", "tree": {"sha": "bbfbe27ae2d48a2eee020103d2db6f43cc3c9d51", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bbfbe27ae2d48a2eee020103d2db6f43cc3c9d51"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a48c7350ab5beed46579f29b1edff8a50502d32b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a48c7350ab5beed46579f29b1edff8a50502d32b", "html_url": "https://github.com/rust-lang/rust/commit/a48c7350ab5beed46579f29b1edff8a50502d32b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a48c7350ab5beed46579f29b1edff8a50502d32b/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8518391e72e46d0a7886f582145793332055ab90", "url": "https://api.github.com/repos/rust-lang/rust/commits/8518391e72e46d0a7886f582145793332055ab90", "html_url": "https://github.com/rust-lang/rust/commit/8518391e72e46d0a7886f582145793332055ab90"}, {"sha": "f7595e0745d05261fa2b025a4f6b3ee7e7cc4796", "url": "https://api.github.com/repos/rust-lang/rust/commits/f7595e0745d05261fa2b025a4f6b3ee7e7cc4796", "html_url": "https://github.com/rust-lang/rust/commit/f7595e0745d05261fa2b025a4f6b3ee7e7cc4796"}], "stats": {"total": 13, "additions": 10, "deletions": 3}, "files": [{"sha": "a48f4c77f857fb5cd8119d9c5aea9d1958eca4e5", "filename": "clippy_lints/src/matches/match_same_arms.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a48c7350ab5beed46579f29b1edff8a50502d32b/clippy_lints%2Fsrc%2Fmatches%2Fmatch_same_arms.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a48c7350ab5beed46579f29b1edff8a50502d32b/clippy_lints%2Fsrc%2Fmatches%2Fmatch_same_arms.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmatches%2Fmatch_same_arms.rs?ref=a48c7350ab5beed46579f29b1edff8a50502d32b", "patch": "@@ -284,6 +284,7 @@ impl<'a> NormalizedPat<'a> {\n                     LitKind::Str(sym, _) => Self::LitStr(sym),\n                     LitKind::ByteStr(ref bytes, _) => Self::LitBytes(bytes),\n                     LitKind::Byte(val) => Self::LitInt(val.into()),\n+                    LitKind::CStr(ref bytes, _) => Self::LitBytes(bytes),\n                     LitKind::Char(val) => Self::LitInt(val.into()),\n                     LitKind::Int(val, _) => Self::LitInt(val),\n                     LitKind::Bool(val) => Self::LitBool(val),"}, {"sha": "2f2e84fa35a12ce8f7dad577678e6bfdd504fefe", "filename": "clippy_lints/src/strlen_on_c_strings.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/a48c7350ab5beed46579f29b1edff8a50502d32b/clippy_lints%2Fsrc%2Fstrlen_on_c_strings.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a48c7350ab5beed46579f29b1edff8a50502d32b/clippy_lints%2Fsrc%2Fstrlen_on_c_strings.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fstrlen_on_c_strings.rs?ref=a48c7350ab5beed46579f29b1edff8a50502d32b", "patch": "@@ -1,11 +1,11 @@\n use clippy_utils::diagnostics::span_lint_and_sugg;\n use clippy_utils::source::snippet_with_context;\n-use clippy_utils::ty::is_type_diagnostic_item;\n+use clippy_utils::ty::{is_type_diagnostic_item, is_type_lang_item};\n use clippy_utils::visitors::is_expr_unsafe;\n use clippy_utils::{get_parent_node, match_libc_symbol};\n use if_chain::if_chain;\n use rustc_errors::Applicability;\n-use rustc_hir::{Block, BlockCheckMode, Expr, ExprKind, Node, UnsafeSource};\n+use rustc_hir::{Block, BlockCheckMode, Expr, ExprKind, LangItem, Node, UnsafeSource};\n use rustc_lint::{LateContext, LateLintPass};\n use rustc_session::{declare_lint_pass, declare_tool_lint};\n use rustc_span::symbol::sym;\n@@ -67,7 +67,7 @@ impl<'tcx> LateLintPass<'tcx> for StrlenOnCStrings {\n                 let val_name = snippet_with_context(cx, self_arg.span, ctxt, \"..\", &mut app).0;\n                 let method_name = if is_type_diagnostic_item(cx, ty, sym::cstring_type) {\n                     \"as_bytes\"\n-                } else if is_type_diagnostic_item(cx, ty, sym::CStr) {\n+                } else if is_type_lang_item(cx, ty, LangItem::CStr) {\n                     \"to_bytes\"\n                 } else {\n                     return;"}, {"sha": "f75dff46624e40cf2b4bce71df762f9c333c1a67", "filename": "clippy_lints/src/utils/author.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/a48c7350ab5beed46579f29b1edff8a50502d32b/clippy_lints%2Fsrc%2Futils%2Fauthor.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a48c7350ab5beed46579f29b1edff8a50502d32b/clippy_lints%2Fsrc%2Futils%2Fauthor.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Fauthor.rs?ref=a48c7350ab5beed46579f29b1edff8a50502d32b", "patch": "@@ -304,6 +304,11 @@ impl<'a, 'tcx> PrintVisitor<'a, 'tcx> {\n                 kind!(\"ByteStr(ref {vec})\");\n                 chain!(self, \"let [{:?}] = **{vec}\", vec.value);\n             },\n+            LitKind::CStr(ref vec, _) => {\n+                bind!(self, vec);\n+                kind!(\"CStr(ref {vec})\");\n+                chain!(self, \"let [{:?}] = **{vec}\", vec.value);\n+            }\n             LitKind::Str(s, _) => {\n                 bind!(self, s);\n                 kind!(\"Str({s}, _)\");"}, {"sha": "7c7ec6d334d9bc7dadff7024da2a7b5395d47246", "filename": "clippy_utils/src/consts.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a48c7350ab5beed46579f29b1edff8a50502d32b/clippy_utils%2Fsrc%2Fconsts.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a48c7350ab5beed46579f29b1edff8a50502d32b/clippy_utils%2Fsrc%2Fconsts.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_utils%2Fsrc%2Fconsts.rs?ref=a48c7350ab5beed46579f29b1edff8a50502d32b", "patch": "@@ -211,6 +211,7 @@ pub fn lit_to_mir_constant(lit: &LitKind, ty: Option<Ty<'_>>) -> Constant {\n         LitKind::Str(ref is, _) => Constant::Str(is.to_string()),\n         LitKind::Byte(b) => Constant::Int(u128::from(b)),\n         LitKind::ByteStr(ref s, _) => Constant::Binary(Lrc::clone(s)),\n+        LitKind::CStr(ref s, _) => Constant::Binary(Lrc::clone(s)),\n         LitKind::Char(c) => Constant::Char(c),\n         LitKind::Int(n, _) => Constant::Int(n),\n         LitKind::Float(ref is, LitFloatType::Suffixed(fty)) => match fty {"}]}