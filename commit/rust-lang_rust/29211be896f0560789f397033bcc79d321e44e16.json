{"sha": "29211be896f0560789f397033bcc79d321e44e16", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI5MjExYmU4OTZmMDU2MDc4OWYzOTcwMzNiY2M3OWQzMjFlNDRlMTY=", "commit": {"author": {"name": "Wilco Kusee", "email": "wilcokusee@gmail.com", "date": "2019-01-13T11:06:28Z"}, "committer": {"name": "Wilco Kusee", "email": "wilcokusee@gmail.com", "date": "2019-01-13T11:06:28Z"}, "message": "Add run-rustfix to duration_subsec test", "tree": {"sha": "9595d5813bab68fdd173e991a648d70b2013571c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9595d5813bab68fdd173e991a648d70b2013571c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/29211be896f0560789f397033bcc79d321e44e16", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/29211be896f0560789f397033bcc79d321e44e16", "html_url": "https://github.com/rust-lang/rust/commit/29211be896f0560789f397033bcc79d321e44e16", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/29211be896f0560789f397033bcc79d321e44e16/comments", "author": {"login": "detrumi", "id": 5758008, "node_id": "MDQ6VXNlcjU3NTgwMDg=", "avatar_url": "https://avatars.githubusercontent.com/u/5758008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/detrumi", "html_url": "https://github.com/detrumi", "followers_url": "https://api.github.com/users/detrumi/followers", "following_url": "https://api.github.com/users/detrumi/following{/other_user}", "gists_url": "https://api.github.com/users/detrumi/gists{/gist_id}", "starred_url": "https://api.github.com/users/detrumi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/detrumi/subscriptions", "organizations_url": "https://api.github.com/users/detrumi/orgs", "repos_url": "https://api.github.com/users/detrumi/repos", "events_url": "https://api.github.com/users/detrumi/events{/privacy}", "received_events_url": "https://api.github.com/users/detrumi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "detrumi", "id": 5758008, "node_id": "MDQ6VXNlcjU3NTgwMDg=", "avatar_url": "https://avatars.githubusercontent.com/u/5758008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/detrumi", "html_url": "https://github.com/detrumi", "followers_url": "https://api.github.com/users/detrumi/followers", "following_url": "https://api.github.com/users/detrumi/following{/other_user}", "gists_url": "https://api.github.com/users/detrumi/gists{/gist_id}", "starred_url": "https://api.github.com/users/detrumi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/detrumi/subscriptions", "organizations_url": "https://api.github.com/users/detrumi/orgs", "repos_url": "https://api.github.com/users/detrumi/repos", "events_url": "https://api.github.com/users/detrumi/events{/privacy}", "received_events_url": "https://api.github.com/users/detrumi/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ea7eb49b478a5f656f62f3e3664009194408ecf0", "url": "https://api.github.com/repos/rust-lang/rust/commits/ea7eb49b478a5f656f62f3e3664009194408ecf0", "html_url": "https://github.com/rust-lang/rust/commit/ea7eb49b478a5f656f62f3e3664009194408ecf0"}], "stats": {"total": 41, "additions": 36, "deletions": 5}, "files": [{"sha": "ee5c7863effcb84b34a893e18dbc7710be5673b0", "filename": "tests/ui/duration_subsec.fixed", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/29211be896f0560789f397033bcc79d321e44e16/tests%2Fui%2Fduration_subsec.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/29211be896f0560789f397033bcc79d321e44e16/tests%2Fui%2Fduration_subsec.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fduration_subsec.fixed?ref=29211be896f0560789f397033bcc79d321e44e16", "patch": "@@ -0,0 +1,29 @@\n+// run-rustfix\n+#![allow(dead_code)]\n+#![warn(clippy::duration_subsec)]\n+\n+use std::time::Duration;\n+\n+fn main() {\n+    let dur = Duration::new(5, 0);\n+\n+    let bad_millis_1 = dur.subsec_millis();\n+    let bad_millis_2 = dur.subsec_millis();\n+    let good_millis = dur.subsec_millis();\n+    assert_eq!(bad_millis_1, good_millis);\n+    assert_eq!(bad_millis_2, good_millis);\n+\n+    let bad_micros = dur.subsec_micros();\n+    let good_micros = dur.subsec_micros();\n+    assert_eq!(bad_micros, good_micros);\n+\n+    // Handle refs\n+    let _ = (&dur).subsec_micros();\n+\n+    // Handle constants\n+    const NANOS_IN_MICRO: u32 = 1_000;\n+    let _ = dur.subsec_micros();\n+\n+    // Other literals aren't linted\n+    let _ = dur.subsec_nanos() / 699;\n+}"}, {"sha": "3c9d2a286211017854d57039166bf80bb18976b7", "filename": "tests/ui/duration_subsec.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/29211be896f0560789f397033bcc79d321e44e16/tests%2Fui%2Fduration_subsec.rs", "raw_url": "https://github.com/rust-lang/rust/raw/29211be896f0560789f397033bcc79d321e44e16/tests%2Fui%2Fduration_subsec.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fduration_subsec.rs?ref=29211be896f0560789f397033bcc79d321e44e16", "patch": "@@ -1,3 +1,5 @@\n+// run-rustfix\n+#![allow(dead_code)]\n #![warn(clippy::duration_subsec)]\n \n use std::time::Duration;"}, {"sha": "bd8adc2c57055b20e0b515c9f24c33dbcaab902d", "filename": "tests/ui/duration_subsec.stderr", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/29211be896f0560789f397033bcc79d321e44e16/tests%2Fui%2Fduration_subsec.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/29211be896f0560789f397033bcc79d321e44e16/tests%2Fui%2Fduration_subsec.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fduration_subsec.stderr?ref=29211be896f0560789f397033bcc79d321e44e16", "patch": "@@ -1,31 +1,31 @@\n error: Calling `subsec_millis()` is more concise than this calculation\n-  --> $DIR/duration_subsec.rs:8:24\n+  --> $DIR/duration_subsec.rs:10:24\n    |\n LL |     let bad_millis_1 = dur.subsec_micros() / 1_000;\n    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `dur.subsec_millis()`\n    |\n    = note: `-D clippy::duration-subsec` implied by `-D warnings`\n \n error: Calling `subsec_millis()` is more concise than this calculation\n-  --> $DIR/duration_subsec.rs:9:24\n+  --> $DIR/duration_subsec.rs:11:24\n    |\n LL |     let bad_millis_2 = dur.subsec_nanos() / 1_000_000;\n    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `dur.subsec_millis()`\n \n error: Calling `subsec_micros()` is more concise than this calculation\n-  --> $DIR/duration_subsec.rs:14:22\n+  --> $DIR/duration_subsec.rs:16:22\n    |\n LL |     let bad_micros = dur.subsec_nanos() / 1_000;\n    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `dur.subsec_micros()`\n \n error: Calling `subsec_micros()` is more concise than this calculation\n-  --> $DIR/duration_subsec.rs:19:13\n+  --> $DIR/duration_subsec.rs:21:13\n    |\n LL |     let _ = (&dur).subsec_nanos() / 1_000;\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `(&dur).subsec_micros()`\n \n error: Calling `subsec_micros()` is more concise than this calculation\n-  --> $DIR/duration_subsec.rs:23:13\n+  --> $DIR/duration_subsec.rs:25:13\n    |\n LL |     let _ = dur.subsec_nanos() / NANOS_IN_MICRO;\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `dur.subsec_micros()`"}]}