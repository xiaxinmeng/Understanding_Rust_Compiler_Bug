{"sha": "89dc8ae205b65326fda2dc9802d4f5e951e62405", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg5ZGM4YWUyMDViNjUzMjZmZGEyZGM5ODAyZDRmNWU5NTFlNjI0MDU=", "commit": {"author": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2017-11-29T14:24:18Z"}, "committer": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2017-11-29T14:24:18Z"}, "message": "incr.comp.: Remove an unnecessary HIR access which enables hashing spans for type definitions.", "tree": {"sha": "0c2944d5ea72b9eccf5b4eb845affbe2ddbf2673", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0c2944d5ea72b9eccf5b4eb845affbe2ddbf2673"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/89dc8ae205b65326fda2dc9802d4f5e951e62405", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/89dc8ae205b65326fda2dc9802d4f5e951e62405", "html_url": "https://github.com/rust-lang/rust/commit/89dc8ae205b65326fda2dc9802d4f5e951e62405", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/89dc8ae205b65326fda2dc9802d4f5e951e62405/comments", "author": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "committer": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dc0e227745765c198958f0298785d18bcf61d4ae", "url": "https://api.github.com/repos/rust-lang/rust/commits/dc0e227745765c198958f0298785d18bcf61d4ae", "html_url": "https://github.com/rust-lang/rust/commit/dc0e227745765c198958f0298785d18bcf61d4ae"}], "stats": {"total": 24, "additions": 10, "deletions": 14}, "files": [{"sha": "77bf3da679dd776fbe19b8cd355c70a74e74e28c", "filename": "src/librustc/ich/impls_hir.rs", "status": "modified", "additions": 9, "deletions": 11, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/89dc8ae205b65326fda2dc9802d4f5e951e62405/src%2Flibrustc%2Fich%2Fimpls_hir.rs", "raw_url": "https://github.com/rust-lang/rust/raw/89dc8ae205b65326fda2dc9802d4f5e951e62405/src%2Flibrustc%2Fich%2Fimpls_hir.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fich%2Fimpls_hir.rs?ref=89dc8ae205b65326fda2dc9802d4f5e951e62405", "patch": "@@ -884,13 +884,13 @@ impl<'gcx> HashStable<StableHashingContext<'gcx>> for hir::Item {\n     fn hash_stable<W: StableHasherResult>(&self,\n                                           hcx: &mut StableHashingContext<'gcx>,\n                                           hasher: &mut StableHasher<W>) {\n-        let (is_const, hash_spans) = match self.node {\n+        let is_const = match self.node {\n             hir::ItemStatic(..)      |\n             hir::ItemConst(..)       => {\n-                (true, hcx.hash_spans())\n+                true\n             }\n             hir::ItemFn(_, _, constness, ..) => {\n-                (constness == hir::Constness::Const, hcx.hash_spans())\n+                constness == hir::Constness::Const\n             }\n             hir::ItemUse(..)         |\n             hir::ItemExternCrate(..) |\n@@ -904,7 +904,7 @@ impl<'gcx> HashStable<StableHashingContext<'gcx>> for hir::Item {\n             hir::ItemEnum(..)        |\n             hir::ItemStruct(..)      |\n             hir::ItemUnion(..)       => {\n-                (false, false)\n+                false\n             }\n         };\n \n@@ -919,13 +919,11 @@ impl<'gcx> HashStable<StableHashingContext<'gcx>> for hir::Item {\n         } = *self;\n \n         hcx.hash_hir_item_like(attrs, is_const, |hcx| {\n-            hcx.while_hashing_spans(hash_spans, |hcx| {\n-                name.hash_stable(hcx, hasher);\n-                attrs.hash_stable(hcx, hasher);\n-                node.hash_stable(hcx, hasher);\n-                vis.hash_stable(hcx, hasher);\n-                span.hash_stable(hcx, hasher);\n-            });\n+            name.hash_stable(hcx, hasher);\n+            attrs.hash_stable(hcx, hasher);\n+            node.hash_stable(hcx, hasher);\n+            vis.hash_stable(hcx, hasher);\n+            span.hash_stable(hcx, hasher);\n         });\n     }\n }"}, {"sha": "a63c89a03269b1e5b30d7719f733fbafd50239d4", "filename": "src/librustc/ty/mod.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/89dc8ae205b65326fda2dc9802d4f5e951e62405/src%2Flibrustc%2Fty%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/89dc8ae205b65326fda2dc9802d4f5e951e62405/src%2Flibrustc%2Fty%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fmod.rs?ref=89dc8ae205b65326fda2dc9802d4f5e951e62405", "patch": "@@ -2302,9 +2302,7 @@ impl<'a, 'gcx, 'tcx> TyCtxt<'a, 'gcx, 'tcx> {\n     }\n \n     pub fn item_name(self, id: DefId) -> InternedString {\n-        if let Some(id) = self.hir.as_local_node_id(id) {\n-            self.hir.name(id).as_str()\n-        } else if id.index == CRATE_DEF_INDEX {\n+        if id.index == CRATE_DEF_INDEX {\n             self.original_crate_name(id.krate).as_str()\n         } else {\n             let def_key = self.def_key(id);"}]}