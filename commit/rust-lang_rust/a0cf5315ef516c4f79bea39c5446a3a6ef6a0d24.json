{"sha": "a0cf5315ef516c4f79bea39c5446a3a6ef6a0d24", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEwY2Y1MzE1ZWY1MTZjNGY3OWJlYTM5YzU0NDZhM2E2ZWY2YTBkMjQ=", "commit": {"author": {"name": "Jonas Schievink", "email": "jonasschievink@gmail.com", "date": "2019-09-18T22:37:28Z"}, "committer": {"name": "Jonas Schievink", "email": "jonasschievink@gmail.com", "date": "2019-10-05T13:33:26Z"}, "message": "Test that we get the proper errors", "tree": {"sha": "edf954faddb1bde4f618d5a9480700e2f9feafab", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/edf954faddb1bde4f618d5a9480700e2f9feafab"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a0cf5315ef516c4f79bea39c5446a3a6ef6a0d24", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a0cf5315ef516c4f79bea39c5446a3a6ef6a0d24", "html_url": "https://github.com/rust-lang/rust/commit/a0cf5315ef516c4f79bea39c5446a3a6ef6a0d24", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a0cf5315ef516c4f79bea39c5446a3a6ef6a0d24/comments", "author": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9aaef06cf6a0c4e671c51f0d13a4ae6cf8b8dec5", "url": "https://api.github.com/repos/rust-lang/rust/commits/9aaef06cf6a0c4e671c51f0d13a4ae6cf8b8dec5", "html_url": "https://github.com/rust-lang/rust/commit/9aaef06cf6a0c4e671c51f0d13a4ae6cf8b8dec5"}], "stats": {"total": 70, "additions": 70, "deletions": 0}, "files": [{"sha": "3bd2d31ef635172b164eb7a07d5e2cfdbbaf026c", "filename": "src/test/ui/specialization/specialization-default-methods-fail.rs", "status": "added", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/rust-lang/rust/blob/a0cf5315ef516c4f79bea39c5446a3a6ef6a0d24/src%2Ftest%2Fui%2Fspecialization%2Fspecialization-default-methods-fail.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a0cf5315ef516c4f79bea39c5446a3a6ef6a0d24/src%2Ftest%2Fui%2Fspecialization%2Fspecialization-default-methods-fail.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspecialization%2Fspecialization-default-methods-fail.rs?ref=a0cf5315ef516c4f79bea39c5446a3a6ef6a0d24", "patch": "@@ -0,0 +1,43 @@\n+// compile-fail\n+\n+#![feature(specialization)]\n+\n+// Test that attempting to override a non-default method or one not in the\n+// parent impl causes an error\n+\n+trait Foo {\n+    fn foo(&self) -> bool { true }\n+}\n+\n+// Specialization tree for Foo:\n+//\n+//       Box<T>              Vec<T>\n+//        / \\                 / \\\n+// Box<i32>  Box<i64>   Vec<()>  Vec<bool>\n+\n+impl<T> Foo for Box<T> {\n+    fn foo(&self) -> bool { false }\n+}\n+\n+// Allowed\n+impl Foo for Box<i32> {}\n+\n+// Can't override a non-`default` fn\n+impl Foo for Box<i64> {\n+    fn foo(&self) -> bool { true }\n+    //~^ error: `foo` specializes an item from a parent `impl`, but that item is not marked `default`\n+}\n+\n+\n+// Doesn't mention the method = provided body is used and the method is final\n+impl<T> Foo for Vec<T> {}\n+\n+// Allowed\n+impl Foo for Vec<()> {}\n+\n+impl Foo for Vec<bool> {\n+    fn foo(&self) -> bool { true }\n+    //~^ error: `foo` specializes an item from a parent `impl`, but that item is not marked `default`\n+}\n+\n+fn main() {}"}, {"sha": "f962ccca83d06d8a5c1b2ac47a896f7090ec3ce0", "filename": "src/test/ui/specialization/specialization-default-methods-fail.stderr", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/a0cf5315ef516c4f79bea39c5446a3a6ef6a0d24/src%2Ftest%2Fui%2Fspecialization%2Fspecialization-default-methods-fail.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a0cf5315ef516c4f79bea39c5446a3a6ef6a0d24/src%2Ftest%2Fui%2Fspecialization%2Fspecialization-default-methods-fail.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspecialization%2Fspecialization-default-methods-fail.stderr?ref=a0cf5315ef516c4f79bea39c5446a3a6ef6a0d24", "patch": "@@ -0,0 +1,27 @@\n+error[E0520]: `foo` specializes an item from a parent `impl`, but that item is not marked `default`\n+  --> $DIR/specialization-default-methods-fail.rs:27:5\n+   |\n+LL | / impl<T> Foo for Box<T> {\n+LL | |     fn foo(&self) -> bool { false }\n+LL | | }\n+   | |_- parent `impl` is here\n+...\n+LL |       fn foo(&self) -> bool { true }\n+   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ cannot specialize default item `foo`\n+   |\n+   = note: to specialize, `foo` in the parent `impl` must be marked `default`\n+\n+error[E0520]: `foo` specializes an item from a parent `impl`, but that item is not marked `default`\n+  --> $DIR/specialization-default-methods-fail.rs:39:5\n+   |\n+LL | impl<T> Foo for Vec<T> {}\n+   | ------------------------- parent `impl` is here\n+...\n+LL |     fn foo(&self) -> bool { true }\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ cannot specialize default item `foo`\n+   |\n+   = note: to specialize, `foo` in the parent `impl` must be marked `default`\n+\n+error: aborting due to 2 previous errors\n+\n+For more information about this error, try `rustc --explain E0520`."}]}