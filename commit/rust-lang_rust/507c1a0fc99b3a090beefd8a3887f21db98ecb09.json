{"sha": "507c1a0fc99b3a090beefd8a3887f21db98ecb09", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUwN2MxYTBmYzk5YjNhMDkwYmVlZmQ4YTM4ODdmMjFkYjk4ZWNiMDk=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-06-04T00:46:46Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2014-06-04T00:46:46Z"}, "message": "auto merge of #14632 : luqmana/rust/cu, r=huonw\n\nThe distinction doesn't make sense any more since we don't have do blocks anymore.", "tree": {"sha": "ef63d189233432cf82f38afae8d704b0fc5a16d9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ef63d189233432cf82f38afae8d704b0fc5a16d9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/507c1a0fc99b3a090beefd8a3887f21db98ecb09", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/507c1a0fc99b3a090beefd8a3887f21db98ecb09", "html_url": "https://github.com/rust-lang/rust/commit/507c1a0fc99b3a090beefd8a3887f21db98ecb09", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/507c1a0fc99b3a090beefd8a3887f21db98ecb09/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f5ead0dd66ab7c3aaaaabcc34e1726a4acd74b07", "url": "https://api.github.com/repos/rust-lang/rust/commits/f5ead0dd66ab7c3aaaaabcc34e1726a4acd74b07", "html_url": "https://github.com/rust-lang/rust/commit/f5ead0dd66ab7c3aaaaabcc34e1726a4acd74b07"}, {"sha": "559ff5e64b16023523c208539f98c35bb5cdb325", "url": "https://api.github.com/repos/rust-lang/rust/commits/559ff5e64b16023523c208539f98c35bb5cdb325", "html_url": "https://github.com/rust-lang/rust/commit/559ff5e64b16023523c208539f98c35bb5cdb325"}], "stats": {"total": 24, "additions": 2, "deletions": 22}, "files": [{"sha": "3571404adc6af1b2a69c85c17ead64b176e2b7da", "filename": "src/librustc/middle/typeck/check/mod.rs", "status": "modified", "additions": 2, "deletions": 22, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/507c1a0fc99b3a090beefd8a3887f21db98ecb09/src%2Flibrustc%2Fmiddle%2Ftypeck%2Fcheck%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/507c1a0fc99b3a090beefd8a3887f21db98ecb09/src%2Flibrustc%2Fmiddle%2Ftypeck%2Fcheck%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Ftypeck%2Fcheck%2Fmod.rs?ref=507c1a0fc99b3a090beefd8a3887f21db98ecb09", "patch": "@@ -168,15 +168,6 @@ pub struct Inherited<'a> {\n     upvar_borrow_map: RefCell<ty::UpvarBorrowMap>,\n }\n \n-#[deriving(Clone)]\n-pub enum FnKind {\n-    // A do-closure.\n-    DoBlock,\n-\n-    // A normal closure or fn item.\n-    Vanilla\n-}\n-\n #[deriving(Clone)]\n pub struct FnStyleState {\n     pub def: ast::NodeId,\n@@ -249,11 +240,6 @@ pub struct FnCtxt<'a> {\n     // can actually be made to live as long as it needs to live.\n     region_lb: Cell<ast::NodeId>,\n \n-    // Says whether we're inside a for loop, in a do block\n-    // or neither. Helps with error messages involving the\n-    // function return type.\n-    fn_kind: FnKind,\n-\n     inh: &'a Inherited<'a>,\n \n     ccx: &'a CrateCtxt<'a>,\n@@ -289,7 +275,6 @@ fn blank_fn_ctxt<'a>(ccx: &'a CrateCtxt<'a>,\n         ret_ty: rty,\n         ps: RefCell::new(FnStyleState::function(ast::NormalFn, 0)),\n         region_lb: Cell::new(region_bnd),\n-        fn_kind: Vanilla,\n         inh: inh,\n         ccx: ccx\n     }\n@@ -356,7 +341,7 @@ fn check_bare_fn(ccx: &CrateCtxt,\n         ty::ty_bare_fn(ref fn_ty) => {\n             let inh = Inherited::new(ccx.tcx, param_env);\n             let fcx = check_fn(ccx, fn_ty.fn_style, &fn_ty.sig,\n-                               decl, id, body, Vanilla, &inh);\n+                               decl, id, body, &inh);\n \n             vtable::resolve_in_block(&fcx, body);\n             regionck::regionck_fn(&fcx, body);\n@@ -440,7 +425,6 @@ fn check_fn<'a>(ccx: &'a CrateCtxt<'a>,\n                 decl: &ast::FnDecl,\n                 id: ast::NodeId,\n                 body: &ast::Block,\n-                fn_kind: FnKind,\n                 inherited: &'a Inherited<'a>) -> FnCtxt<'a>\n {\n     /*!\n@@ -479,7 +463,6 @@ fn check_fn<'a>(ccx: &'a CrateCtxt<'a>,\n         ret_ty: ret_ty,\n         ps: RefCell::new(FnStyleState::function(fn_style, id)),\n         region_lb: Cell::new(body.id),\n-        fn_kind: fn_kind,\n         inh: inherited,\n         ccx: ccx\n     };\n@@ -2295,7 +2278,6 @@ fn check_expr_with_unifier(fcx: &FnCtxt,\n                      store: ty::TraitStore,\n                      decl: &ast::FnDecl,\n                      body: ast::P<ast::Block>,\n-                     fn_kind: FnKind,\n                      expected: Option<ty::t>) {\n         let tcx = fcx.ccx.tcx;\n \n@@ -2373,7 +2355,7 @@ fn check_expr_with_unifier(fcx: &FnCtxt,\n         };\n \n         check_fn(fcx.ccx, inherited_style, &fty_sig,\n-                 decl, id, body, fn_kind, fcx.inh);\n+                 decl, id, body, fcx.inh);\n     }\n \n \n@@ -3044,7 +3026,6 @@ fn check_expr_with_unifier(fcx: &FnCtxt,\n                       ty::RegionTraitStore(region, ast::MutMutable),\n                       decl,\n                       body,\n-                      Vanilla,\n                       expected);\n       }\n       ast::ExprProc(decl, body) => {\n@@ -3053,7 +3034,6 @@ fn check_expr_with_unifier(fcx: &FnCtxt,\n                       ty::UniqTraitStore,\n                       decl,\n                       body,\n-                      Vanilla,\n                       expected);\n       }\n       ast::ExprBlock(b) => {"}]}