{"sha": "78abcab8088080a1202d44ef9f7903da86a98583", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc4YWJjYWI4MDg4MDgwYTEyMDJkNDRlZjlmNzkwM2RhODZhOTg1ODM=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2018-10-05T06:04:19Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-10-05T06:04:19Z"}, "message": "Merge pull request #3264 from joelgallant/extern-type-complexity\n\nFixes #3222 by checking the BareFnTy Abi type", "tree": {"sha": "455edf36f2cca2ad205ca883ac579b4efadfdc6d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/455edf36f2cca2ad205ca883ac579b4efadfdc6d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/78abcab8088080a1202d44ef9f7903da86a98583", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJbtv7jCRBK7hj4Ov3rIwAAdHIIAIyJs/IVGr0fntIcqypU9f2l\nf8+oDewevqvvtanadBtUsiUxTEfQaR1/octSD/qNJHpUYDSJGdnb+NXGr6sIGcRU\nvbUzsSDV7XcU0n432EEW/Mn/gXstpt0oZ3/reQbIjLoxXl9H1WD6kgRfm/D6e/6A\n+EycAqLJ3ShwSKf0NhWR0o2xKTUOVpDUImCzdSSLRIILXxXO7HZBUu1F7DM6RHKk\n7poLWAzJf3zisp2/DEeu/XCxcgOnNjTmHI5iJA7/y41i/vspH0EfZDayV9mw4Ibs\n7aDJKlKpVm/MunSY1cqb/5Urh2alhUZ21gjHeiJoxQ6K8y1yCygYGPw0bLyZJy8=\n=TCMj\n-----END PGP SIGNATURE-----\n", "payload": "tree 455edf36f2cca2ad205ca883ac579b4efadfdc6d\nparent eb2cfe62b523c34dc2ec5990b0113001c936db7e\nparent 163780ee0b41de143ec06181026ef575a736de2f\nauthor Philipp Hansch <dev@phansch.net> 1538719459 +0100\ncommitter GitHub <noreply@github.com> 1538719459 +0100\n\nMerge pull request #3264 from joelgallant/extern-type-complexity\n\nFixes #3222 by checking the BareFnTy Abi type"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/78abcab8088080a1202d44ef9f7903da86a98583", "html_url": "https://github.com/rust-lang/rust/commit/78abcab8088080a1202d44ef9f7903da86a98583", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/78abcab8088080a1202d44ef9f7903da86a98583/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "eb2cfe62b523c34dc2ec5990b0113001c936db7e", "url": "https://api.github.com/repos/rust-lang/rust/commits/eb2cfe62b523c34dc2ec5990b0113001c936db7e", "html_url": "https://github.com/rust-lang/rust/commit/eb2cfe62b523c34dc2ec5990b0113001c936db7e"}, {"sha": "163780ee0b41de143ec06181026ef575a736de2f", "url": "https://api.github.com/repos/rust-lang/rust/commits/163780ee0b41de143ec06181026ef575a736de2f", "html_url": "https://github.com/rust-lang/rust/commit/163780ee0b41de143ec06181026ef575a736de2f"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "6f024e596107976e5097086567778792d49e22e0", "filename": "clippy_lints/src/types.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/78abcab8088080a1202d44ef9f7903da86a98583/clippy_lints%2Fsrc%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/78abcab8088080a1202d44ef9f7903da86a98583/clippy_lints%2Fsrc%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Ftypes.rs?ref=78abcab8088080a1202d44ef9f7903da86a98583", "patch": "@@ -16,6 +16,7 @@ use std::borrow::Cow;\n use crate::syntax::ast::{FloatTy, IntTy, UintTy};\n use crate::syntax::source_map::Span;\n use crate::syntax::errors::DiagnosticBuilder;\n+use crate::rustc_target::spec::abi::Abi;\n use crate::utils::{comparisons, differing_macro_contexts, higher, in_constant, in_macro, last_path_segment, match_def_path, match_path,\n             match_type, multispan_sugg, opt_def_id, same_tys, snippet, snippet_opt, span_help_and_lint, span_lint,\n             span_lint_and_sugg, span_lint_and_then, clip, unsext, sext, int_bits};\n@@ -1224,7 +1225,7 @@ impl<'tcx> Visitor<'tcx> for TypeComplexityVisitor {\n             TyKind::Path(..) | TyKind::Slice(..) | TyKind::Tup(..) | TyKind::Array(..) => (10 * self.nest, 1),\n \n             // function types bring a lot of overhead\n-            TyKind::BareFn(..) => (50 * self.nest, 1),\n+            TyKind::BareFn(ref bare) if bare.abi == Abi::Rust => (50 * self.nest, 1),\n \n             TyKind::TraitObject(ref param_bounds, _) => {\n                 let has_lifetime_parameters = param_bounds"}, {"sha": "eac2c07c12ea9a4d7fb56bb756f137a50a910ea7", "filename": "tests/ui/complex_types.rs", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/78abcab8088080a1202d44ef9f7903da86a98583/tests%2Fui%2Fcomplex_types.rs", "raw_url": "https://github.com/rust-lang/rust/raw/78abcab8088080a1202d44ef9f7903da86a98583/tests%2Fui%2Fcomplex_types.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcomplex_types.rs?ref=78abcab8088080a1202d44ef9f7903da86a98583", "patch": "@@ -40,5 +40,22 @@ fn test3() {\n     let _y: Vec<Vec<Box<(u32, u32, u32, u32)>>> = vec![];\n }\n \n+#[repr(C)]\n+struct D {\n+    // should not warn, since we don't have control over the signature (#3222)\n+    test4: extern \"C\" fn(\n+        itself: &D,\n+        a: usize,\n+        b: usize,\n+        c: usize,\n+        d: usize,\n+        e: usize,\n+        f: usize,\n+        g: usize,\n+        h: usize,\n+        i: usize,\n+    ),\n+}\n+\n fn main() {\n }"}]}