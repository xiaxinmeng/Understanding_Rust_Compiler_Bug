{"sha": "05972929672175d542ab7a3332bdd507c14b6cc2", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA1OTcyOTI5NjcyMTc1ZDU0MmFiN2EzMzMyYmRkNTA3YzE0YjZjYzI=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-05-08T22:58:31Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-05-08T22:58:31Z"}, "message": "Rollup merge of #60641 - estebank:defer-ice, r=oli-obk\n\nInstead of ICEing on incorrect pattern, use delay_span_bug\n\nFix #60635.", "tree": {"sha": "6c5051bd1edf55469a00b62d3394ad0a6cd9ace9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6c5051bd1edf55469a00b62d3394ad0a6cd9ace9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/05972929672175d542ab7a3332bdd507c14b6cc2", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJc018XCRBK7hj4Ov3rIwAAdHIIAF0XWjebAdXX2jHL0bz8CHFu\n/pM1Pa7kKAai8UpfmyjikWBPsB36xCk5fFDqemErBfrLx4Eci93IcK5lF7053Ntl\nOdaS7j4zUiGsouLZmgVUy9mKdPn/au1FOoeFmzlcbsDlayvX5ACk+dk67IgMMchx\n0CPtsEq5nrYsuk7xAMNsa23qPb8U0zekLwuLICq/UFgAeb+3KaTqtA7fvsknPZEB\nzXof87a7GPPYyMvVe07otJZm2q97hFupHKkwDjtcy0dGoBJLdsb9ubBi74PE8Lm/\nGXuguJGbGRb8X0uiFne3+H4KygqKWJBp/UWP+h4BYlbMgYx3s4Nmhdv8+m0syag=\n=do3s\n-----END PGP SIGNATURE-----\n", "payload": "tree 6c5051bd1edf55469a00b62d3394ad0a6cd9ace9\nparent 450ad65bb2c4bd1aa130b2d08332cc9101ca867f\nparent cc40f41ee5baefa0dc1845dd9d794abe90511161\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1557356311 +0200\ncommitter GitHub <noreply@github.com> 1557356311 +0200\n\nRollup merge of #60641 - estebank:defer-ice, r=oli-obk\n\nInstead of ICEing on incorrect pattern, use delay_span_bug\n\nFix #60635.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/05972929672175d542ab7a3332bdd507c14b6cc2", "html_url": "https://github.com/rust-lang/rust/commit/05972929672175d542ab7a3332bdd507c14b6cc2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/05972929672175d542ab7a3332bdd507c14b6cc2/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "450ad65bb2c4bd1aa130b2d08332cc9101ca867f", "url": "https://api.github.com/repos/rust-lang/rust/commits/450ad65bb2c4bd1aa130b2d08332cc9101ca867f", "html_url": "https://github.com/rust-lang/rust/commit/450ad65bb2c4bd1aa130b2d08332cc9101ca867f"}, {"sha": "cc40f41ee5baefa0dc1845dd9d794abe90511161", "url": "https://api.github.com/repos/rust-lang/rust/commits/cc40f41ee5baefa0dc1845dd9d794abe90511161", "html_url": "https://github.com/rust-lang/rust/commit/cc40f41ee5baefa0dc1845dd9d794abe90511161"}], "stats": {"total": 37, "additions": 35, "deletions": 2}, "files": [{"sha": "7edd5c5a9de1b865f5d51b15b4d5d70c66ec0a87", "filename": "src/librustc/middle/mem_categorization.rs", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/05972929672175d542ab7a3332bdd507c14b6cc2/src%2Flibrustc%2Fmiddle%2Fmem_categorization.rs", "raw_url": "https://github.com/rust-lang/rust/raw/05972929672175d542ab7a3332bdd507c14b6cc2/src%2Flibrustc%2Fmiddle%2Fmem_categorization.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fmem_categorization.rs?ref=05972929672175d542ab7a3332bdd507c14b6cc2", "patch": "@@ -1300,8 +1300,16 @@ impl<'a, 'gcx, 'tcx> MemCategorizationContext<'a, 'gcx, 'tcx> {\n                         }\n                     }\n                     def => {\n-                        span_bug!(pat.span, \"tuple struct pattern didn't resolve \\\n-                                             to variant or struct {:?}\", def);\n+                        debug!(\n+                            \"tuple struct pattern didn't resolve to variant or struct {:?} at {:?}\",\n+                            def,\n+                            pat.span,\n+                        );\n+                        self.tcx.sess.delay_span_bug(pat.span, &format!(\n+                            \"tuple struct pattern didn't resolve to variant or struct {:?}\",\n+                            def,\n+                        ));\n+                        return Err(());\n                     }\n                 };\n "}, {"sha": "ed76b2c5db025a86f65a84d6f8f88b9339933db6", "filename": "src/test/ui/fn-in-pat.rs", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/05972929672175d542ab7a3332bdd507c14b6cc2/src%2Ftest%2Fui%2Ffn-in-pat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/05972929672175d542ab7a3332bdd507c14b6cc2/src%2Ftest%2Fui%2Ffn-in-pat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffn-in-pat.rs?ref=05972929672175d542ab7a3332bdd507c14b6cc2", "patch": "@@ -0,0 +1,16 @@\n+struct A {}\n+\n+impl A {\n+    fn new() {}\n+}\n+\n+fn hof<F>(_: F) where F: FnMut(()) {}\n+\n+fn ice() {\n+    hof(|c| match c {\n+        A::new() => (), //~ ERROR expected tuple struct/variant, found method\n+        _ => ()\n+    })\n+}\n+\n+fn main() {}"}, {"sha": "eee97fe9587c288953130d2acfd004eb304b44aa", "filename": "src/test/ui/fn-in-pat.stderr", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/05972929672175d542ab7a3332bdd507c14b6cc2/src%2Ftest%2Fui%2Ffn-in-pat.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/05972929672175d542ab7a3332bdd507c14b6cc2/src%2Ftest%2Fui%2Ffn-in-pat.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffn-in-pat.stderr?ref=05972929672175d542ab7a3332bdd507c14b6cc2", "patch": "@@ -0,0 +1,9 @@\n+error[E0164]: expected tuple struct/variant, found method `<A>::new`\n+  --> $DIR/fn-in-pat.rs:11:9\n+   |\n+LL |         A::new() => (),\n+   |         ^^^^^^^^ not a tuple variant or struct\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0164`."}]}