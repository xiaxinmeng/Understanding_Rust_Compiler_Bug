{"sha": "640bdbdb1da73cde39c33fc2be3cddd3b71389b0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY0MGJkYmRiMWRhNzNjZGUzOWMzM2ZjMmJlM2NkZGQzYjcxMzg5YjA=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2019-05-27T13:25:01Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2019-06-20T20:59:56Z"}, "message": "Improve theme checker by removing unneeded conditions", "tree": {"sha": "a642cc6f037db08cc7c5641165b15822be2b9506", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a642cc6f037db08cc7c5641165b15822be2b9506"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/640bdbdb1da73cde39c33fc2be3cddd3b71389b0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/640bdbdb1da73cde39c33fc2be3cddd3b71389b0", "html_url": "https://github.com/rust-lang/rust/commit/640bdbdb1da73cde39c33fc2be3cddd3b71389b0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/640bdbdb1da73cde39c33fc2be3cddd3b71389b0/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "165a95b37151105c0822bc84d0939439f7b96b06", "url": "https://api.github.com/repos/rust-lang/rust/commits/165a95b37151105c0822bc84d0939439f7b96b06", "html_url": "https://github.com/rust-lang/rust/commit/165a95b37151105c0822bc84d0939439f7b96b06"}], "stats": {"total": 20, "additions": 14, "deletions": 6}, "files": [{"sha": "7220a05df47e660a5ecc517ec53bb667fd42ab37", "filename": "src/librustdoc/theme.rs", "status": "modified", "additions": 14, "deletions": 6, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/640bdbdb1da73cde39c33fc2be3cddd3b71389b0/src%2Flibrustdoc%2Ftheme.rs", "raw_url": "https://github.com/rust-lang/rust/raw/640bdbdb1da73cde39c33fc2be3cddd3b71389b0/src%2Flibrustdoc%2Ftheme.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Ftheme.rs?ref=640bdbdb1da73cde39c33fc2be3cddd3b71389b0", "patch": "@@ -103,7 +103,7 @@ fn is_line_comment(pos: usize, v: &[u8], events: &[Events]) -> bool {\n     if let Some(&Events::StartComment(_)) = events.last() {\n         return false;\n     }\n-    pos + 1 < v.len() && v[pos + 1] == b'/'\n+    v[pos + 1] == b'/'\n }\n \n fn load_css_events(v: &[u8]) -> Vec<Events> {\n@@ -112,7 +112,7 @@ fn load_css_events(v: &[u8]) -> Vec<Events> {\n \n     while pos + 1 < v.len() {\n         match v[pos] {\n-            b'/' if pos + 1 < v.len() && v[pos + 1] == b'*' => {\n+            b'/' if v[pos + 1] == b'*' => {\n                 events.push(Events::StartComment(pos));\n                 pos += 1;\n             }\n@@ -123,7 +123,7 @@ fn load_css_events(v: &[u8]) -> Vec<Events> {\n             b'\\n' if previous_is_line_comment(&events) => {\n                 events.push(Events::EndComment(pos));\n             }\n-            b'*' if pos + 1 < v.len() && v[pos + 1] == b'/' => {\n+            b'*' if v[pos + 1] == b'/' => {\n                 events.push(Events::EndComment(pos + 2));\n                 pos += 1;\n             }\n@@ -264,9 +264,11 @@ pub fn get_differences(against: &CssPath, other: &CssPath, v: &mut Vec<String>)\n     }\n }\n \n-pub fn test_theme_against<P: AsRef<Path>>(f: &P, against: &CssPath, diag: &Handler)\n-    -> (bool, Vec<String>)\n-{\n+pub fn test_theme_against<P: AsRef<Path>>(\n+    f: &P,\n+    against: &CssPath,\n+    diag: &Handler,\n+) -> (bool, Vec<String>) {\n     let data = try_something!(fs::read(f), diag, (false, vec![]));\n     let paths = load_css_paths(&data);\n     let mut ret = vec![];\n@@ -372,4 +374,10 @@ a {\n         let events = load_css_events(&[]);\n         assert_eq!(events.len(), 0);\n     }\n+\n+    #[test]\n+    fn check_invalid_css() {\n+        let events = load_css_events(b\"*\");\n+        assert_eq!(events.len(), 0);\n+    }\n }"}]}