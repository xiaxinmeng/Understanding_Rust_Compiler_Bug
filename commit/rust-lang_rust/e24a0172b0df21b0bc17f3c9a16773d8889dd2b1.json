{"sha": "e24a0172b0df21b0bc17f3c9a16773d8889dd2b1", "node_id": "MDY6Q29tbWl0NzI0NzEyOmUyNGEwMTcyYjBkZjIxYjBiYzE3ZjNjOWExNjc3M2Q4ODg5ZGQyYjE=", "commit": {"author": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2020-07-19T20:39:20Z"}, "committer": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2020-07-19T20:39:20Z"}, "message": "Only skip impls of foreign unstable traits\n\nPreviously unstable impls were skipped, which meant that any impl with an\nunstable method would get skipped.", "tree": {"sha": "bcf322e0b23754b0957267ddaf1e4cdaba52d362", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bcf322e0b23754b0957267ddaf1e4cdaba52d362"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e24a0172b0df21b0bc17f3c9a16773d8889dd2b1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e24a0172b0df21b0bc17f3c9a16773d8889dd2b1", "html_url": "https://github.com/rust-lang/rust/commit/e24a0172b0df21b0bc17f3c9a16773d8889dd2b1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e24a0172b0df21b0bc17f3c9a16773d8889dd2b1/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d7f94516345a36ddfcd68cbdf1df835d356795c3", "url": "https://api.github.com/repos/rust-lang/rust/commits/d7f94516345a36ddfcd68cbdf1df835d356795c3", "html_url": "https://github.com/rust-lang/rust/commit/d7f94516345a36ddfcd68cbdf1df835d356795c3"}], "stats": {"total": 45, "additions": 42, "deletions": 3}, "files": [{"sha": "1f576a17dd9d665cfe1d147e1ec0b7108b41773c", "filename": "src/librustdoc/clean/inline.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/e24a0172b0df21b0bc17f3c9a16773d8889dd2b1/src%2Flibrustdoc%2Fclean%2Finline.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e24a0172b0df21b0bc17f3c9a16773d8889dd2b1/src%2Flibrustdoc%2Fclean%2Finline.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Finline.rs?ref=e24a0172b0df21b0bc17f3c9a16773d8889dd2b1", "patch": "@@ -346,9 +346,11 @@ pub fn build_impl(\n         // such. This helps prevent dependencies of the standard library, for\n         // example, from getting documented as \"traits `u32` implements\" which\n         // isn't really too helpful.\n-        if let Some(stab) = cx.tcx.lookup_stability(did) {\n-            if stab.level.is_unstable() {\n-                return;\n+        if let Some(trait_did) = associated_trait {\n+            if let Some(stab) = cx.tcx.lookup_stability(trait_did.def_id) {\n+                if stab.level.is_unstable() {\n+                    return;\n+                }\n             }\n         }\n     }"}, {"sha": "6f06a6e2656d7b2077af1190619a07acb939a647", "filename": "src/test/rustdoc/auxiliary/unstable-trait.rs", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/e24a0172b0df21b0bc17f3c9a16773d8889dd2b1/src%2Ftest%2Frustdoc%2Fauxiliary%2Funstable-trait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e24a0172b0df21b0bc17f3c9a16773d8889dd2b1/src%2Ftest%2Frustdoc%2Fauxiliary%2Funstable-trait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fauxiliary%2Funstable-trait.rs?ref=e24a0172b0df21b0bc17f3c9a16773d8889dd2b1", "patch": "@@ -0,0 +1,26 @@\n+#![feature(staged_api)]\n+#![stable(feature = \"private_general\", since = \"1.0.0\")]\n+\n+#[unstable(feature = \"private_trait\", issue = \"none\")]\n+pub trait Bar {}\n+\n+#[stable(feature = \"private_general\", since = \"1.0.0\")]\n+pub struct Foo {\n+    // nothing\n+}\n+\n+impl Foo {\n+    #[stable(feature = \"private_general\", since = \"1.0.0\")]\n+    pub fn stable_impl() {}\n+}\n+\n+impl Foo {\n+    #[unstable(feature = \"private_trait\", issue = \"none\")]\n+    pub fn bar() {}\n+\n+    #[stable(feature = \"private_general\", since = \"1.0.0\")]\n+    pub fn bar2() {}\n+}\n+\n+#[stable(feature = \"private_general\", since = \"1.0.0\")]\n+impl Bar for Foo {}"}, {"sha": "c30d6ed7b52203d42f524a095311f3be286ea26c", "filename": "src/test/rustdoc/hide-unstable-trait.rs", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/e24a0172b0df21b0bc17f3c9a16773d8889dd2b1/src%2Ftest%2Frustdoc%2Fhide-unstable-trait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e24a0172b0df21b0bc17f3c9a16773d8889dd2b1/src%2Ftest%2Frustdoc%2Fhide-unstable-trait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fhide-unstable-trait.rs?ref=e24a0172b0df21b0bc17f3c9a16773d8889dd2b1", "patch": "@@ -0,0 +1,11 @@\n+// aux-build:unstable-trait.rs\n+\n+#![crate_name = \"foo\"]\n+#![feature(private_trait)]\n+\n+extern crate unstable_trait;\n+\n+// @has foo/struct.Foo.html 'bar'\n+// @has foo/struct.Foo.html 'bar2'\n+#[doc(inline)]\n+pub use unstable_trait::Foo;"}]}