{"sha": "0f3ae6218ef1d9e9b14bf983b463785b14abc205", "node_id": "C_kwDOAAsO6NoAKDBmM2FlNjIxOGVmMWQ5ZTliMTRiZjk4M2I0NjM3ODViMTRhYmMyMDU", "commit": {"author": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2022-11-10T23:51:14Z"}, "committer": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2022-11-11T00:22:37Z"}, "message": "rustdoc: use checkbox instead of switch for settings toggles\n\nThe switch is designed to give the application a \"physical\" feel, but\nnothing else in here really followed through. They didn't support the\n\"flick\" gesture that real iOS switches support, and the radio\nbuttons that were also used in Rustdoc Settings were a more \"classic\"\nform element anyway.\n\nAlso, while \"switches\" are the exclusive toggle design on iOS (since\n[Apple HIG] reserves checkboxes for Mac only), the [Google Material]\nguidelines say that lists of switches are bad, and you should just use\ncheck boxes.\n\n[Apple HIG]: https://developer.apple.com/design/human-interface-guidelines/components/selection-and-input/toggles\n[Google Material]: https://m3.material.io/components/checkbox/guidelines#6902f23d-ceba-4b19-ae3b-b78b9b01d185", "tree": {"sha": "859e2435f19e5e188d5b006690aa266746d3dddf", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/859e2435f19e5e188d5b006690aa266746d3dddf"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0f3ae6218ef1d9e9b14bf983b463785b14abc205", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0f3ae6218ef1d9e9b14bf983b463785b14abc205", "html_url": "https://github.com/rust-lang/rust/commit/0f3ae6218ef1d9e9b14bf983b463785b14abc205", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0f3ae6218ef1d9e9b14bf983b463785b14abc205/comments", "author": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "committer": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a3c0a023611fcaf5ae3ec242d7d60e356041d25f", "url": "https://api.github.com/repos/rust-lang/rust/commits/a3c0a023611fcaf5ae3ec242d7d60e356041d25f", "html_url": "https://github.com/rust-lang/rust/commit/a3c0a023611fcaf5ae3ec242d7d60e356041d25f"}], "stats": {"total": 103, "additions": 25, "deletions": 78}, "files": [{"sha": "1f6fb961e918d430a5ad45ba293819769717c982", "filename": "src/librustdoc/html/static/css/settings.css", "status": "modified", "additions": 19, "deletions": 38, "changes": 57, "blob_url": "https://github.com/rust-lang/rust/blob/0f3ae6218ef1d9e9b14bf983b463785b14abc205/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fsettings.css", "raw_url": "https://github.com/rust-lang/rust/raw/0f3ae6218ef1d9e9b14bf983b463785b14abc205/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fsettings.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fsettings.css?ref=0f3ae6218ef1d9e9b14bf983b463785b14abc205", "patch": "@@ -8,7 +8,8 @@\n \tflex-wrap: wrap;\n }\n \n-.setting-line .radio-line input {\n+.setting-line .radio-line input,\n+.setting-line .toggle input {\n \tmargin-right: 0.3em;\n \theight: 1.2rem;\n \twidth: 1.2rem;\n@@ -17,9 +18,18 @@\n \toutline: none;\n \t-webkit-appearance: none;\n \tcursor: pointer;\n+}\n+.setting-line .radio-line input {\n \tborder-radius: 50%;\n }\n-.setting-line .radio-line input + span {\n+.setting-line .toggle input:checked {\n+\tcontent: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 40 40\">\\\n+\t\t<path d=\"M7,25L17,32L33,12\" fill=\"none\" stroke=\"black\" stroke-width=\"5\"/>\\\n+\t\t<path d=\"M7,23L17,30L33,10\" fill=\"none\" stroke=\"white\" stroke-width=\"5\"/></svg>');\n+}\n+\n+.setting-line .radio-line input + span,\n+.setting-line .toggle span {\n \tpadding-bottom: 1px;\n }\n \n@@ -49,37 +59,6 @@\n \tcursor: pointer;\n }\n \n-.toggle input {\n-\topacity: 0;\n-\tposition: absolute;\n-}\n-\n-.slider {\n-\tposition: relative;\n-\twidth: 45px;\n-\tmin-width: 45px;\n-\tdisplay: block;\n-\theight: 28px;\n-\tmargin-right: 20px;\n-\tcursor: pointer;\n-\tbackground-color: #ccc;\n-\ttransition: .3s;\n-}\n-\n-.slider:before {\n-\tposition: absolute;\n-\tcontent: \"\";\n-\theight: 19px;\n-\twidth: 19px;\n-\tleft: 4px;\n-\tbottom: 4px;\n-\ttransition: .3s;\n-}\n-\n-input:checked + .slider:before {\n-\ttransform: translateX(19px);\n-}\n-\n .setting-line > .sub-settings {\n \tpadding-left: 42px;\n \twidth: 100%;\n@@ -94,17 +73,19 @@ input:checked + .slider:before {\n \tbox-shadow: inset 0 0 0 3px var(--main-background-color);\n \tbackground-color: var(--settings-input-color);\n }\n-.setting-line .radio-line input:focus {\n+.setting-line .toggle input:checked {\n+\tbackground-color: var(--settings-input-color);\n+}\n+.setting-line .radio-line input:focus,\n+.setting-line .toggle input:focus {\n \tbox-shadow: 0 0 1px 1px var(--settings-input-color);\n }\n /* In here we combine both `:focus` and `:checked` properties. */\n .setting-line .radio-line input:checked:focus {\n \tbox-shadow: inset 0 0 0 3px var(--main-background-color),\n \t\t0 0 2px 2px var(--settings-input-color);\n }\n-.setting-line .radio-line input:hover {\n+.setting-line .radio-line input:hover,\n+.setting-line .toggle input:hover {\n \tborder-color: var(--settings-input-color) !important;\n }\n-input:checked + .slider {\n-\tbackground-color: var(--settings-input-color);\n-}"}, {"sha": "63c0b78b2371cac7b3d74d815bcdd9e3bcda3974", "filename": "src/librustdoc/html/static/css/themes/ayu.css", "status": "modified", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/0f3ae6218ef1d9e9b14bf983b463785b14abc205/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "raw_url": "https://github.com/rust-lang/rust/raw/0f3ae6218ef1d9e9b14bf983b463785b14abc205/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css?ref=0f3ae6218ef1d9e9b14bf983b463785b14abc205", "patch": "@@ -75,16 +75,6 @@ Original by Dempfi (https://github.com/dempfi/ayu)\n \t--crate-search-hover-border: #e0e0e0;\n }\n \n-.slider {\n-\tbackground-color: #ccc;\n-}\n-.slider:before {\n-\tbackground-color: white;\n-}\n-input:focus + .slider {\n-\tbox-shadow: 0 0 0 2px #0a84ff, 0 0 0 6px rgba(10, 132, 255, 0.3);\n-}\n-\n h1, h2, h3, h4 {\n \tcolor: white;\n }"}, {"sha": "77f888330a42aa98249b090bf2a6f6b1f8240b0d", "filename": "src/librustdoc/html/static/css/themes/dark.css", "status": "modified", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/0f3ae6218ef1d9e9b14bf983b463785b14abc205/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/0f3ae6218ef1d9e9b14bf983b463785b14abc205/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css?ref=0f3ae6218ef1d9e9b14bf983b463785b14abc205", "patch": "@@ -70,16 +70,6 @@\n \t--crate-search-hover-border: #2196f3;\n }\n \n-.slider {\n-\tbackground-color: #ccc;\n-}\n-.slider:before {\n-\tbackground-color: white;\n-}\n-input:focus + .slider {\n-\tbox-shadow: 0 0 0 2px #0a84ff, 0 0 0 6px rgba(10, 132, 255, 0.3);\n-}\n-\n .content .item-info::before { color: #ccc; }\n \n body.source .example-wrap pre.rust a {"}, {"sha": "13ad38cf6e631308f2fa051c57fb9bb6d3b8fc74", "filename": "src/librustdoc/html/static/css/themes/light.css", "status": "modified", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/0f3ae6218ef1d9e9b14bf983b463785b14abc205/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "raw_url": "https://github.com/rust-lang/rust/raw/0f3ae6218ef1d9e9b14bf983b463785b14abc205/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css?ref=0f3ae6218ef1d9e9b14bf983b463785b14abc205", "patch": "@@ -67,15 +67,6 @@\n \t--crate-search-hover-border: #717171;\n }\n \n-.slider {\n-\tbackground-color: #ccc;\n-}\n-.slider:before {\n-\tbackground-color: white;\n-}\n-input:focus + .slider {\n-\tbox-shadow: 0 0 0 2px #0a84ff, 0 0 0 6px rgba(10, 132, 255, 0.3);\n-}\n \n .content .item-info::before { color: #ccc; }\n "}, {"sha": "95cc265f1bdf6b96d05fe637d1295e14b3b8d474", "filename": "src/librustdoc/html/static/js/settings.js", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/0f3ae6218ef1d9e9b14bf983b463785b14abc205/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js", "raw_url": "https://github.com/rust-lang/rust/raw/0f3ae6218ef1d9e9b14bf983b463785b14abc205/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js?ref=0f3ae6218ef1d9e9b14bf983b463785b14abc205", "patch": "@@ -66,8 +66,7 @@\n \n     function setEvents(settingsElement) {\n         updateLightAndDark();\n-        onEachLazy(settingsElement.getElementsByClassName(\"slider\"), elem => {\n-            const toggle = elem.previousElementSibling;\n+        onEachLazy(settingsElement.querySelectorAll(\"input[type=\\\"checkbox\\\"]\"), toggle => {\n             const settingId = toggle.id;\n             const settingValue = getSettingValue(settingId);\n             if (settingValue !== null) {\n@@ -139,7 +138,6 @@\n                 const checked = setting[\"default\"] === true ? \" checked\" : \"\";\n                 output += `<label class=\"toggle\">\\\n                         <input type=\"checkbox\" id=\"${js_data_name}\"${checked}>\\\n-                        <span class=\"slider\"></span>\\\n                         <span class=\"label\">${setting_name}</span>\\\n                     </label>`;\n             }"}, {"sha": "fec21ad35c3ebe098cbebcd4d24d7bf1e87d249f", "filename": "src/test/rustdoc-gui/docblock-code-block-line-number.goml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/0f3ae6218ef1d9e9b14bf983b463785b14abc205/src%2Ftest%2Frustdoc-gui%2Fdocblock-code-block-line-number.goml", "raw_url": "https://github.com/rust-lang/rust/raw/0f3ae6218ef1d9e9b14bf983b463785b14abc205/src%2Ftest%2Frustdoc-gui%2Fdocblock-code-block-line-number.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fdocblock-code-block-line-number.goml?ref=0f3ae6218ef1d9e9b14bf983b463785b14abc205", "patch": "@@ -30,10 +30,10 @@ wait-for: \"#settings\"\n assert-css: (\"#settings\", {\"display\": \"block\"})\n \n // Then, click the toggle button.\n-click: \"input#line-numbers + .slider\"\n+click: \"input#line-numbers\"\n wait-for: 100 // wait-for-false does not exist\n assert-false: \"pre.example-line-numbers\"\n \n // Finally, turn it on again.\n-click: \"input#line-numbers + .slider\"\n+click: \"input#line-numbers\"\n wait-for: \"pre.example-line-numbers\""}, {"sha": "a800cfc82d4c90d4e3d4b4472eec3a3dbfbf597a", "filename": "src/test/rustdoc-gui/settings.goml", "status": "modified", "additions": 3, "deletions": 6, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/0f3ae6218ef1d9e9b14bf983b463785b14abc205/src%2Ftest%2Frustdoc-gui%2Fsettings.goml", "raw_url": "https://github.com/rust-lang/rust/raw/0f3ae6218ef1d9e9b14bf983b463785b14abc205/src%2Ftest%2Frustdoc-gui%2Fsettings.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsettings.goml?ref=0f3ae6218ef1d9e9b14bf983b463785b14abc205", "patch": "@@ -118,7 +118,7 @@ assert: \".setting-line.hidden #theme\"\n assert-text: (\"#preferred-dark-theme .setting-name\", \"Preferred dark theme\")\n assert-text: (\"#preferred-light-theme .setting-name\", \"Preferred light theme\")\n \n-// We now check that clicking on the \"sliders\"' text is like clicking on the slider.\n+// We now check that clicking on the toggles' text is like clicking on the checkbox.\n // To test it, we use the \"Disable keyboard shortcuts\".\n local-storage: {\"rustdoc-disable-shortcuts\": \"false\"}\n click: \".setting-line:last-child .toggle .label\"\n@@ -141,10 +141,7 @@ assert-css: (\"#settings-menu .popover\", {\"display\": \"none\"})\n // Now we go to the settings page to check that the CSS is loaded as expected.\n goto: \"file://\" + |DOC_PATH| + \"/settings.html\"\n wait-for: \"#settings\"\n-assert-css: (\n-    \".setting-line .toggle .slider\",\n-    {\"width\": \"45px\", \"margin-right\": \"20px\", \"border\": \"0px none rgb(0, 0, 0)\"},\n-)\n+assert-css: (\".setting-line\", {\"position\": \"relative\"})\n \n assert-attribute-false: (\"#settings\", {\"class\": \"popover\"}, CONTAINS)\n compare-elements-position: (\".sub form\", \"#settings\", (\"x\"))\n@@ -162,4 +159,4 @@ reload:\n size: (300, 1000)\n click: \"#settings-menu\"\n wait-for: \"#settings\"\n-assert-css: (\"#settings .slider\", {\"width\": \"45px\"}, ALL)\n+assert-css: (\".setting-line\", {\"position\": \"relative\"})"}]}