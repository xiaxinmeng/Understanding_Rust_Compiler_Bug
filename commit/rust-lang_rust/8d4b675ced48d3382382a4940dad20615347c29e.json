{"sha": "8d4b675ced48d3382382a4940dad20615347c29e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhkNGI2NzVjZWQ0OGQzMzgyMzgyYTQ5NDBkYWQyMDYxNTM0N2MyOWU=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2014-02-15T03:17:50Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2014-02-15T03:17:50Z"}, "message": "mk: Address review feedback", "tree": {"sha": "26196c425078cbdc2da4a11ea206454973e9572e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/26196c425078cbdc2da4a11ea206454973e9572e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8d4b675ced48d3382382a4940dad20615347c29e", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8d4b675ced48d3382382a4940dad20615347c29e", "html_url": "https://github.com/rust-lang/rust/commit/8d4b675ced48d3382382a4940dad20615347c29e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8d4b675ced48d3382382a4940dad20615347c29e/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "24915c84e0d4764a7995039fac2b3f31c409d04c", "url": "https://api.github.com/repos/rust-lang/rust/commits/24915c84e0d4764a7995039fac2b3f31c409d04c", "html_url": "https://github.com/rust-lang/rust/commit/24915c84e0d4764a7995039fac2b3f31c409d04c"}], "stats": {"total": 62, "additions": 43, "deletions": 19}, "files": [{"sha": "ba1879a771327fb8f97cb4a369b02eef80b82a65", "filename": "Makefile.in", "status": "modified", "additions": 22, "deletions": 10, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/8d4b675ced48d3382382a4940dad20615347c29e/Makefile.in", "raw_url": "https://github.com/rust-lang/rust/raw/8d4b675ced48d3382382a4940dad20615347c29e/Makefile.in", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Makefile.in?ref=8d4b675ced48d3382382a4940dad20615347c29e", "patch": "@@ -31,17 +31,17 @@\n #\n #   * uninstall - Uninstall the binaries\n #\n-# For hot tips on working with The Rust Build System, just:\n+# For tips on working with The Rust Build System, just:\n #\n-#     type `make hot-tips`\n+#     run `make tips`\n #\n # Otherwise\n #\n-#     type `make`\n+#     run `make`\n #\n # </help>\n #\n-# <hottips>\n+# <tips>\n #\n # # The Rust Build System Tip Line\n #\n@@ -52,8 +52,9 @@\n #   * check-$(crate) - Test a crate, e.g. `check-std`\n #   * check-ref - Run the language reference tests\n #   * check-docs - Test the documentation examples\n-#\n-# TODO: Lots more\n+#   * check-stage$(stage)-$(crate) - Test a crate in a specific stage\n+#   * check-stage$(stage)-{rpass,rfail,cfail,rmake,...} - Run tests in src/test/\n+#   * check-stage1-T-$(target)-H-$(host) - Run cross-compiled-tests\n #\n # Then mix in some of these environment variables to harness the\n # ultimate power of The Rust Build System.\n@@ -71,25 +72,36 @@\n #\n #   * `NO_REBUILD=1` - Don't rebootstrap when testing std\n #                      (and possibly other crates)\n-#   * `NO_MKFILE_DEPS=1` - Don rebuild for modified .mk files\n+#   * `NO_MKFILE_DEPS=1` - Don't rebuild for modified .mk files\n #\n #   * `SAVE_TEMPS=1` - Use `--save-temps` flag on all `rustc` invocations\n #   * `ASM_COMMENTS=1` - Use `-Z asm-comments`\n #   * `TIME_PASSES=1` - Use `-Z time-passes`\n #   * `TIME_LLVM_PASSES=1` - Use `-Z time-llvm-passes`\n #   * `TRACE=1` - Use `-Z trace`\n #\n+# # Rust recipes for build system success\n+#\n+#     // Modifying libstd? Use this comment to run unit tests just on your change\n+#     make check-stage1-std NO_REBUILD=1 NO_BENCH=1\n+#\n+#     // Added a run-pass test? Use this to test running your test\n+#     make check-stage1-rpass TESTNAME=my-shiny-new-test\n+#\n+#     // Having trouble figuring out which test is failing? Turn off parallel tests\n+#     make check-stage1-std RUST_TEST_TASKS=1\n+#\n # This is hardly all there is to know of The Rust Build System's\n # mysteries. The tale continues on the wiki[1][2].\n #\n # [1]: https://github.com/mozilla/rust/wiki/Note-build-system\n # [2]: https://github.com/mozilla/rust/wiki/Note-testsuite\n #\n-# Unless you feel like getting your hands dirty, then:\n+# If you really feel like getting your hands dirty, then:\n #\n-#     don't type `make nitty-gritty`\n+#     run `make nitty-gritty`\n #\n-# </hottips>\n+# </tips>\n #\n # <nittygritty>\n #"}, {"sha": "75514ada973b49d1c44eba3ec671dc9cfd76ef03", "filename": "configure", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8d4b675ced48d3382382a4940dad20615347c29e/configure", "raw_url": "https://github.com/rust-lang/rust/raw/8d4b675ced48d3382382a4940dad20615347c29e/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=8d4b675ced48d3382382a4940dad20615347c29e", "patch": "@@ -1103,5 +1103,5 @@ rm -f config.tmp\n touch config.stamp\n \n step_msg \"complete\"\n-msg \"type \\`make help\\`\"\n+msg \"run \\`make help\\`\"\n msg"}, {"sha": "8ca4da85994fdfa218cb65299632f96296fb918c", "filename": "mk/tests.mk", "status": "modified", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/8d4b675ced48d3382382a4940dad20615347c29e/mk%2Ftests.mk", "raw_url": "https://github.com/rust-lang/rust/raw/8d4b675ced48d3382382a4940dad20615347c29e/mk%2Ftests.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftests.mk?ref=8d4b675ced48d3382382a4940dad20615347c29e", "patch": "@@ -194,6 +194,9 @@ check-ref: cleantestlibs cleantmptestlogs check-stage2-rpass \\\n \tcheck-stage2-rfail check-stage2-cfail check-stage2-rmake\n \t$(Q)$(CFG_PYTHON) $(S)src/etc/check-summary.py tmp/*.log\n \n+check-docs: cleantestlibs cleantmptestlogs check-stage2-docs\n+\t$(Q)$(CFG_PYTHON) $(S)src/etc/check-summary.py tmp/*.log\n+\n .PHONY: cleantmptestlogs cleantestlibs\n \n cleantmptestlogs:\n@@ -827,6 +830,23 @@ $(foreach stage,$(STAGES), \\\n   $(foreach group,$(TEST_GROUPS), \\\n    $(eval $(call DEF_CHECK_FOR_STAGE_AND_HOSTS_AND_GROUP,$(stage),$(host),$(group))))))\n \n+define DEF_CHECK_DOC_FOR_STAGE\n+check-stage$(1)-docs: $$(foreach docname,$$(DOC_TEST_NAMES),\\\n+                       check-stage$(1)-T-$$(CFG_BUILD)-H-$$(CFG_BUILD)-doc-$$(docname)) \\\n+                     $$(foreach crate,$$(DOC_CRATE_NAMES),\\\n+                       check-stage$(1)-T-$$(CFG_BUILD)-H-$$(CFG_BUILD)-doc-$$(crate))\n+endef\n+\n+$(foreach stage,$(STAGES), \\\n+ $(eval $(call DEF_CHECK_DOC_FOR_STAGE,$(stage))))\n+\n+define DEF_CHECK_CRATE\n+check-$(1): check-stage2-T-$$(CFG_BUILD)-H-$$(CFG_BUILD)-$(1)-exec\n+endef\n+\n+$(foreach crate,$(TEST_CRATES), \\\n+ $(eval $(call DEF_CHECK_CRATE,$(crate))))\n+\n ######################################################################\n # check-fast rules\n ######################################################################"}, {"sha": "3bbc8f413aec5c04da07138a0c410bda12f368d5", "filename": "mk/util.mk", "status": "modified", "additions": 0, "deletions": 8, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/8d4b675ced48d3382382a4940dad20615347c29e/mk%2Futil.mk", "raw_url": "https://github.com/rust-lang/rust/raw/8d4b675ced48d3382382a4940dad20615347c29e/mk%2Futil.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Futil.mk?ref=8d4b675ced48d3382382a4940dad20615347c29e", "patch": "@@ -16,13 +16,5 @@ else\n   E = echo $(1)\n endif\n \n-ifdef VERBOSE\n-  Q :=\n-  E =\n-else\n-  Q := @\n-  E = echo $(1)\n-endif\n-\n S := $(CFG_SRC_DIR)\n "}]}