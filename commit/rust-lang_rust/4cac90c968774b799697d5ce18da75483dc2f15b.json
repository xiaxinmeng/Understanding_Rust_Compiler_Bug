{"sha": "4cac90c968774b799697d5ce18da75483dc2f15b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRjYWM5MGM5Njg3NzRiNzk5Njk3ZDVjZTE4ZGE3NTQ4M2RjMmYxNWI=", "commit": {"author": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2020-09-23T19:38:21Z"}, "committer": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2020-09-25T17:39:09Z"}, "message": "Move const fn floating point test out of `min_const_fn`", "tree": {"sha": "116b0d2f3b8c5d32dc8df3ecb71ba513d5bac6f9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/116b0d2f3b8c5d32dc8df3ecb71ba513d5bac6f9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4cac90c968774b799697d5ce18da75483dc2f15b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4cac90c968774b799697d5ce18da75483dc2f15b", "html_url": "https://github.com/rust-lang/rust/commit/4cac90c968774b799697d5ce18da75483dc2f15b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4cac90c968774b799697d5ce18da75483dc2f15b/comments", "author": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b428f287c3ddb951450bc5f94cf3a5e38a59e3d6", "url": "https://api.github.com/repos/rust-lang/rust/commits/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6", "html_url": "https://github.com/rust-lang/rust/commit/b428f287c3ddb951450bc5f94cf3a5e38a59e3d6"}], "stats": {"total": 156, "additions": 94, "deletions": 62}, "files": [{"sha": "ae24f8f65009adf85bb099f6b0de13c25510f809", "filename": "src/test/ui/consts/const_fn_floating_point_arithmetic.gated.stderr", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/4cac90c968774b799697d5ce18da75483dc2f15b/src%2Ftest%2Fui%2Fconsts%2Fconst_fn_floating_point_arithmetic.gated.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4cac90c968774b799697d5ce18da75483dc2f15b/src%2Ftest%2Fui%2Fconsts%2Fconst_fn_floating_point_arithmetic.gated.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_fn_floating_point_arithmetic.gated.stderr?ref=4cac90c968774b799697d5ce18da75483dc2f15b", "patch": "@@ -0,0 +1,8 @@\n+error: fatal error triggered by #[rustc_error]\n+  --> $DIR/const_fn_floating_point_arithmetic.rs:20:1\n+   |\n+LL | fn main() {}\n+   | ^^^^^^^^^\n+\n+error: aborting due to previous error\n+"}, {"sha": "5e32482b21a52376e8ebf601681c52f3e22270b4", "filename": "src/test/ui/consts/const_fn_floating_point_arithmetic.rs", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/4cac90c968774b799697d5ce18da75483dc2f15b/src%2Ftest%2Fui%2Fconsts%2Fconst_fn_floating_point_arithmetic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4cac90c968774b799697d5ce18da75483dc2f15b/src%2Ftest%2Fui%2Fconsts%2Fconst_fn_floating_point_arithmetic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_fn_floating_point_arithmetic.rs?ref=4cac90c968774b799697d5ce18da75483dc2f15b", "patch": "@@ -0,0 +1,20 @@\n+// gate-test-const_fn_floating_point_arithmetic\n+\n+// revisions: stock gated\n+\n+#![feature(rustc_attrs)]\n+#![cfg_attr(gated, feature(const_fn_floating_point_arithmetic))]\n+\n+const fn add(f: f32) -> f32 { f + 2.0 }\n+//[stock]~^ floating point arithmetic\n+const fn sub(f: f32) -> f32 { 2.0 - f }\n+//[stock]~^ floating point arithmetic\n+const fn mul(f: f32, g: f32) -> f32 { f * g }\n+//[stock]~^ floating point arithmetic\n+const fn div(f: f32, g: f32) -> f32 { f / g }\n+//[stock]~^ floating point arithmetic\n+const fn neg(f: f32) -> f32 { -f }\n+//[stock]~^ floating point arithmetic\n+\n+#[rustc_error]\n+fn main() {} //[gated]~ fatal error triggered by #[rustc_error]"}, {"sha": "7461007fc2aa5fdeacc08e72ba5b512650d7475f", "filename": "src/test/ui/consts/const_fn_floating_point_arithmetic.stock.stderr", "status": "added", "additions": 48, "deletions": 0, "changes": 48, "blob_url": "https://github.com/rust-lang/rust/blob/4cac90c968774b799697d5ce18da75483dc2f15b/src%2Ftest%2Fui%2Fconsts%2Fconst_fn_floating_point_arithmetic.stock.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4cac90c968774b799697d5ce18da75483dc2f15b/src%2Ftest%2Fui%2Fconsts%2Fconst_fn_floating_point_arithmetic.stock.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_fn_floating_point_arithmetic.stock.stderr?ref=4cac90c968774b799697d5ce18da75483dc2f15b", "patch": "@@ -0,0 +1,48 @@\n+error[E0658]: floating point arithmetic is not allowed in constant functions\n+  --> $DIR/const_fn_floating_point_arithmetic.rs:8:31\n+   |\n+LL | const fn add(f: f32) -> f32 { f + 2.0 }\n+   |                               ^^^^^^^\n+   |\n+   = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n+   = help: add `#![feature(const_fn_floating_point_arithmetic)]` to the crate attributes to enable\n+\n+error[E0658]: floating point arithmetic is not allowed in constant functions\n+  --> $DIR/const_fn_floating_point_arithmetic.rs:10:31\n+   |\n+LL | const fn sub(f: f32) -> f32 { 2.0 - f }\n+   |                               ^^^^^^^\n+   |\n+   = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n+   = help: add `#![feature(const_fn_floating_point_arithmetic)]` to the crate attributes to enable\n+\n+error[E0658]: floating point arithmetic is not allowed in constant functions\n+  --> $DIR/const_fn_floating_point_arithmetic.rs:12:39\n+   |\n+LL | const fn mul(f: f32, g: f32) -> f32 { f * g }\n+   |                                       ^^^^^\n+   |\n+   = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n+   = help: add `#![feature(const_fn_floating_point_arithmetic)]` to the crate attributes to enable\n+\n+error[E0658]: floating point arithmetic is not allowed in constant functions\n+  --> $DIR/const_fn_floating_point_arithmetic.rs:14:39\n+   |\n+LL | const fn div(f: f32, g: f32) -> f32 { f / g }\n+   |                                       ^^^^^\n+   |\n+   = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n+   = help: add `#![feature(const_fn_floating_point_arithmetic)]` to the crate attributes to enable\n+\n+error[E0658]: floating point arithmetic is not allowed in constant functions\n+  --> $DIR/const_fn_floating_point_arithmetic.rs:16:31\n+   |\n+LL | const fn neg(f: f32) -> f32 { -f }\n+   |                               ^^\n+   |\n+   = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n+   = help: add `#![feature(const_fn_floating_point_arithmetic)]` to the crate attributes to enable\n+\n+error: aborting due to 5 previous errors\n+\n+For more information about this error, try `rustc --explain E0658`."}, {"sha": "55a999d5cdc040699c569574e1bbc4301be8f0b3", "filename": "src/test/ui/consts/min_const_fn/min_const_fn.rs", "status": "modified", "additions": 0, "deletions": 8, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/4cac90c968774b799697d5ce18da75483dc2f15b/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4cac90c968774b799697d5ce18da75483dc2f15b/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.rs?ref=4cac90c968774b799697d5ce18da75483dc2f15b", "patch": "@@ -77,14 +77,6 @@ const fn foo11<T: std::fmt::Display>(t: T) -> T { t }\n //~^ ERROR trait bounds other than `Sized` on const fn parameters are unstable\n const fn foo11_2<T: Send>(t: T) -> T { t }\n //~^ ERROR trait bounds other than `Sized` on const fn parameters are unstable\n-const fn foo19(f: f32) -> f32 { f * 2.0 }\n-//~^ ERROR floating point arithmetic\n-const fn foo19_2(f: f32) -> f32 { 2.0 - f }\n-//~^ ERROR floating point arithmetic\n-const fn foo19_3(f: f32) -> f32 { -f }\n-//~^ ERROR floating point arithmetic\n-const fn foo19_4(f: f32, g: f32) -> f32 { f / g }\n-//~^ ERROR floating point arithmetic\n \n static BAR: u32 = 42;\n const fn foo25() -> u32 { BAR } //~ ERROR cannot refer to statics"}, {"sha": "a37e5203eeef4b62c06fc159ccb123c0133c0449", "filename": "src/test/ui/consts/min_const_fn/min_const_fn.stderr", "status": "modified", "additions": 18, "deletions": 54, "changes": 72, "blob_url": "https://github.com/rust-lang/rust/blob/4cac90c968774b799697d5ce18da75483dc2f15b/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4cac90c968774b799697d5ce18da75483dc2f15b/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.stderr?ref=4cac90c968774b799697d5ce18da75483dc2f15b", "patch": "@@ -76,60 +76,24 @@ LL | const fn foo11_2<T: Send>(t: T) -> T { t }\n    = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n-error[E0658]: floating point arithmetic is not allowed in constant functions\n-  --> $DIR/min_const_fn.rs:80:33\n-   |\n-LL | const fn foo19(f: f32) -> f32 { f * 2.0 }\n-   |                                 ^^^^^^^\n-   |\n-   = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n-   = help: add `#![feature(const_fn_floating_point_arithmetic)]` to the crate attributes to enable\n-\n-error[E0658]: floating point arithmetic is not allowed in constant functions\n-  --> $DIR/min_const_fn.rs:82:35\n-   |\n-LL | const fn foo19_2(f: f32) -> f32 { 2.0 - f }\n-   |                                   ^^^^^^^\n-   |\n-   = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n-   = help: add `#![feature(const_fn_floating_point_arithmetic)]` to the crate attributes to enable\n-\n-error[E0658]: floating point arithmetic is not allowed in constant functions\n-  --> $DIR/min_const_fn.rs:84:35\n-   |\n-LL | const fn foo19_3(f: f32) -> f32 { -f }\n-   |                                   ^^\n-   |\n-   = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n-   = help: add `#![feature(const_fn_floating_point_arithmetic)]` to the crate attributes to enable\n-\n-error[E0658]: floating point arithmetic is not allowed in constant functions\n-  --> $DIR/min_const_fn.rs:86:43\n-   |\n-LL | const fn foo19_4(f: f32, g: f32) -> f32 { f / g }\n-   |                                           ^^^^^\n-   |\n-   = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n-   = help: add `#![feature(const_fn_floating_point_arithmetic)]` to the crate attributes to enable\n-\n error[E0013]: constant functions cannot refer to statics\n-  --> $DIR/min_const_fn.rs:90:27\n+  --> $DIR/min_const_fn.rs:82:27\n    |\n LL | const fn foo25() -> u32 { BAR }\n    |                           ^^^\n    |\n    = help: consider extracting the value of the `static` to a `const`, and referring to that\n \n error[E0013]: constant functions cannot refer to statics\n-  --> $DIR/min_const_fn.rs:91:37\n+  --> $DIR/min_const_fn.rs:83:37\n    |\n LL | const fn foo26() -> &'static u32 { &BAR }\n    |                                     ^^^\n    |\n    = help: consider extracting the value of the `static` to a `const`, and referring to that\n \n error[E0658]: casting pointers to integers in constant functions is unstable\n-  --> $DIR/min_const_fn.rs:92:42\n+  --> $DIR/min_const_fn.rs:84:42\n    |\n LL | const fn foo30(x: *const u32) -> usize { x as usize }\n    |                                          ^^^^^^^^^^\n@@ -138,7 +102,7 @@ LL | const fn foo30(x: *const u32) -> usize { x as usize }\n    = help: add `#![feature(const_raw_ptr_to_usize_cast)]` to the crate attributes to enable\n \n error[E0658]: casting pointers to integers in constant functions is unstable\n-  --> $DIR/min_const_fn.rs:94:63\n+  --> $DIR/min_const_fn.rs:86:63\n    |\n LL | const fn foo30_with_unsafe(x: *const u32) -> usize { unsafe { x as usize } }\n    |                                                               ^^^^^^^^^^\n@@ -147,7 +111,7 @@ LL | const fn foo30_with_unsafe(x: *const u32) -> usize { unsafe { x as usize }\n    = help: add `#![feature(const_raw_ptr_to_usize_cast)]` to the crate attributes to enable\n \n error[E0658]: casting pointers to integers in constant functions is unstable\n-  --> $DIR/min_const_fn.rs:96:42\n+  --> $DIR/min_const_fn.rs:88:42\n    |\n LL | const fn foo30_2(x: *mut u32) -> usize { x as usize }\n    |                                          ^^^^^^^^^^\n@@ -156,7 +120,7 @@ LL | const fn foo30_2(x: *mut u32) -> usize { x as usize }\n    = help: add `#![feature(const_raw_ptr_to_usize_cast)]` to the crate attributes to enable\n \n error[E0658]: casting pointers to integers in constant functions is unstable\n-  --> $DIR/min_const_fn.rs:98:63\n+  --> $DIR/min_const_fn.rs:90:63\n    |\n LL | const fn foo30_2_with_unsafe(x: *mut u32) -> usize { unsafe { x as usize } }\n    |                                                               ^^^^^^^^^^\n@@ -165,7 +129,7 @@ LL | const fn foo30_2_with_unsafe(x: *mut u32) -> usize { unsafe { x as usize }\n    = help: add `#![feature(const_raw_ptr_to_usize_cast)]` to the crate attributes to enable\n \n error[E0658]: mutable references are not allowed in constant functions\n-  --> $DIR/min_const_fn.rs:101:14\n+  --> $DIR/min_const_fn.rs:93:14\n    |\n LL | const fn inc(x: &mut i32) { *x += 1 }\n    |              ^\n@@ -174,7 +138,7 @@ LL | const fn inc(x: &mut i32) { *x += 1 }\n    = help: add `#![feature(const_mut_refs)]` to the crate attributes to enable\n \n error[E0723]: trait bounds other than `Sized` on const fn parameters are unstable\n-  --> $DIR/min_const_fn.rs:110:6\n+  --> $DIR/min_const_fn.rs:102:6\n    |\n LL | impl<T: std::fmt::Debug> Foo<T> {\n    |      ^\n@@ -183,7 +147,7 @@ LL | impl<T: std::fmt::Debug> Foo<T> {\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n error[E0723]: trait bounds other than `Sized` on const fn parameters are unstable\n-  --> $DIR/min_const_fn.rs:115:6\n+  --> $DIR/min_const_fn.rs:107:6\n    |\n LL | impl<T: std::fmt::Debug + Sized> Foo<T> {\n    |      ^\n@@ -192,7 +156,7 @@ LL | impl<T: std::fmt::Debug + Sized> Foo<T> {\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n error[E0723]: trait bounds other than `Sized` on const fn parameters are unstable\n-  --> $DIR/min_const_fn.rs:120:6\n+  --> $DIR/min_const_fn.rs:112:6\n    |\n LL | impl<T: Sync + Sized> Foo<T> {\n    |      ^\n@@ -201,7 +165,7 @@ LL | impl<T: Sync + Sized> Foo<T> {\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n error[E0723]: trait bounds other than `Sized` on const fn parameters are unstable\n-  --> $DIR/min_const_fn.rs:126:34\n+  --> $DIR/min_const_fn.rs:118:34\n    |\n LL | const fn no_apit2(_x: AlanTuring<impl std::fmt::Debug>) {}\n    |                                  ^^^^^^^^^^^^^^^^^^^^\n@@ -210,7 +174,7 @@ LL | const fn no_apit2(_x: AlanTuring<impl std::fmt::Debug>) {}\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n error[E0723]: trait bounds other than `Sized` on const fn parameters are unstable\n-  --> $DIR/min_const_fn.rs:128:22\n+  --> $DIR/min_const_fn.rs:120:22\n    |\n LL | const fn no_apit(_x: impl std::fmt::Debug) {}\n    |                      ^^^^^^^^^^^^^^^^^^^^\n@@ -219,7 +183,7 @@ LL | const fn no_apit(_x: impl std::fmt::Debug) {}\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n error[E0723]: trait bounds other than `Sized` on const fn parameters are unstable\n-  --> $DIR/min_const_fn.rs:129:23\n+  --> $DIR/min_const_fn.rs:121:23\n    |\n LL | const fn no_dyn_trait(_x: &dyn std::fmt::Debug) {}\n    |                       ^^\n@@ -228,7 +192,7 @@ LL | const fn no_dyn_trait(_x: &dyn std::fmt::Debug) {}\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n error[E0723]: trait bounds other than `Sized` on const fn parameters are unstable\n-  --> $DIR/min_const_fn.rs:130:32\n+  --> $DIR/min_const_fn.rs:122:32\n    |\n LL | const fn no_dyn_trait_ret() -> &'static dyn std::fmt::Debug { &() }\n    |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n@@ -237,7 +201,7 @@ LL | const fn no_dyn_trait_ret() -> &'static dyn std::fmt::Debug { &() }\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n error[E0723]: trait bounds other than `Sized` on const fn parameters are unstable\n-  --> $DIR/min_const_fn.rs:135:41\n+  --> $DIR/min_const_fn.rs:127:41\n    |\n LL | const fn really_no_traits_i_mean_it() { (&() as &dyn std::fmt::Debug, ()).1 }\n    |                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n@@ -246,7 +210,7 @@ LL | const fn really_no_traits_i_mean_it() { (&() as &dyn std::fmt::Debug, ()).1\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n error[E0723]: function pointers in const fn are unstable\n-  --> $DIR/min_const_fn.rs:138:21\n+  --> $DIR/min_const_fn.rs:130:21\n    |\n LL | const fn no_fn_ptrs(_x: fn()) {}\n    |                     ^^\n@@ -255,15 +219,15 @@ LL | const fn no_fn_ptrs(_x: fn()) {}\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n error[E0723]: function pointers in const fn are unstable\n-  --> $DIR/min_const_fn.rs:140:27\n+  --> $DIR/min_const_fn.rs:132:27\n    |\n LL | const fn no_fn_ptrs2() -> fn() { fn foo() {} foo }\n    |                           ^^^^\n    |\n    = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n-error: aborting due to 30 previous errors\n+error: aborting due to 26 previous errors\n \n Some errors have detailed explanations: E0013, E0493, E0658, E0723.\n For more information about an error, try `rustc --explain E0013`."}]}