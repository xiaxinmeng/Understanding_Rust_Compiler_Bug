{"sha": "6d195615872440798ac47ad7a4d8fd090fcbc24a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZkMTk1NjE1ODcyNDQwNzk4YWM0N2FkN2E0ZDhmZDA5MGZjYmMyNGE=", "commit": {"author": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2020-09-06T23:57:07Z"}, "committer": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2020-09-20T20:18:58Z"}, "message": "Set BUILD_TRIPLE via build script\n\nThis moves build triple discovery for rustbuild from bootstrap.py into a build\nscript, meaning it will \"just work\" if building rustbuild via Cargo rather than\nPython.", "tree": {"sha": "08a6b15b4a6ca9341f46893fb0bb67d0eda93f02", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/08a6b15b4a6ca9341f46893fb0bb67d0eda93f02"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6d195615872440798ac47ad7a4d8fd090fcbc24a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6d195615872440798ac47ad7a4d8fd090fcbc24a", "html_url": "https://github.com/rust-lang/rust/commit/6d195615872440798ac47ad7a4d8fd090fcbc24a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6d195615872440798ac47ad7a4d8fd090fcbc24a/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "81e02708f1f4760244756548981277d5199baa9a", "url": "https://api.github.com/repos/rust-lang/rust/commits/81e02708f1f4760244756548981277d5199baa9a", "html_url": "https://github.com/rust-lang/rust/commit/81e02708f1f4760244756548981277d5199baa9a"}], "stats": {"total": 7, "additions": 5, "deletions": 2}, "files": [{"sha": "890315a744e56cc93ca254927a75897b5a5614d2", "filename": "src/bootstrap/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/6d195615872440798ac47ad7a4d8fd090fcbc24a/src%2Fbootstrap%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/6d195615872440798ac47ad7a4d8fd090fcbc24a/src%2Fbootstrap%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2FCargo.toml?ref=6d195615872440798ac47ad7a4d8fd090fcbc24a", "patch": "@@ -3,6 +3,7 @@ authors = [\"The Rust Project Developers\"]\n name = \"bootstrap\"\n version = \"0.0.0\"\n edition = \"2018\"\n+build = \"build.rs\"\n \n [lib]\n path = \"lib.rs\""}, {"sha": "c9a9a484ee338cc253b1603e1af6afec657220e8", "filename": "src/bootstrap/bootstrap.py", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/6d195615872440798ac47ad7a4d8fd090fcbc24a/src%2Fbootstrap%2Fbootstrap.py", "raw_url": "https://github.com/rust-lang/rust/raw/6d195615872440798ac47ad7a4d8fd090fcbc24a/src%2Fbootstrap%2Fbootstrap.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbootstrap.py?ref=6d195615872440798ac47ad7a4d8fd090fcbc24a", "patch": "@@ -1032,7 +1032,6 @@ def bootstrap(help_triggered):\n     args = [build.bootstrap_binary()]\n     args.extend(sys.argv[1:])\n     env = os.environ.copy()\n-    env[\"BUILD\"] = build.build\n     env[\"SRC\"] = build.rust_root\n     env[\"BOOTSTRAP_PARENT_ID\"] = str(os.getpid())\n     env[\"BOOTSTRAP_PYTHON\"] = sys.executable"}, {"sha": "5e5c31de5b6dcbf586dd05f456242add47e21fdd", "filename": "src/bootstrap/build.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/6d195615872440798ac47ad7a4d8fd090fcbc24a/src%2Fbootstrap%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6d195615872440798ac47ad7a4d8fd090fcbc24a/src%2Fbootstrap%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbuild.rs?ref=6d195615872440798ac47ad7a4d8fd090fcbc24a", "patch": "@@ -0,0 +1,3 @@\n+fn main() {\n+    println!(\"cargo:rustc-env=BUILD_TRIPLE={}\", std::env::var(\"HOST\").unwrap());\n+}"}, {"sha": "1ec99ef30ffa552d851cbcc85334cfa33c702597", "filename": "src/bootstrap/config.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6d195615872440798ac47ad7a4d8fd090fcbc24a/src%2Fbootstrap%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6d195615872440798ac47ad7a4d8fd090fcbc24a/src%2Fbootstrap%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.rs?ref=6d195615872440798ac47ad7a4d8fd090fcbc24a", "patch": "@@ -487,7 +487,7 @@ impl Config {\n         config.missing_tools = false;\n \n         // set by bootstrap.py\n-        config.build = TargetSelection::from_user(&env::var(\"BUILD\").expect(\"'BUILD' to be set\"));\n+        config.build = TargetSelection::from_user(&env!(\"BUILD_TRIPLE\"));\n         config.src = Config::path_from_python(\"SRC\");\n         config.out = Config::path_from_python(\"BUILD_DIR\");\n "}]}