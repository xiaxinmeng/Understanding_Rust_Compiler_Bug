{"sha": "052887e4b4c86426423ecd6f244e3e25cd71dd49", "node_id": "C_kwDOAAsO6NoAKDA1Mjg4N2U0YjRjODY0MjY0MjNlY2Q2ZjI0NGUzZTI1Y2Q3MWRkNDk", "commit": {"author": {"name": "Yan Chen", "email": "ychen2@futurewei.com", "date": "2022-08-08T23:58:27Z"}, "committer": {"name": "Yan Chen", "email": "ychen2@futurewei.com", "date": "2022-09-09T15:00:47Z"}, "message": "Add inline-llvm option for disabling/enabling LLVM inlining", "tree": {"sha": "947937120338bbc19454a6e57f5f4045f4cfe5aa", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/947937120338bbc19454a6e57f5f4045f4cfe5aa"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/052887e4b4c86426423ecd6f244e3e25cd71dd49", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/052887e4b4c86426423ecd6f244e3e25cd71dd49", "html_url": "https://github.com/rust-lang/rust/commit/052887e4b4c86426423ecd6f244e3e25cd71dd49", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/052887e4b4c86426423ecd6f244e3e25cd71dd49/comments", "author": null, "committer": null, "parents": [{"sha": "24d69920201563f0ee7b530f1cda0f171b205cc2", "url": "https://api.github.com/repos/rust-lang/rust/commits/24d69920201563f0ee7b530f1cda0f171b205cc2", "html_url": "https://github.com/rust-lang/rust/commit/24d69920201563f0ee7b530f1cda0f171b205cc2"}], "stats": {"total": 7, "additions": 7, "deletions": 0}, "files": [{"sha": "eff2436d41cac65adbe930d1cd7a3e845ebafa65", "filename": "compiler/rustc_codegen_llvm/src/attributes.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/052887e4b4c86426423ecd6f244e3e25cd71dd49/compiler%2Frustc_codegen_llvm%2Fsrc%2Fattributes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/052887e4b4c86426423ecd6f244e3e25cd71dd49/compiler%2Frustc_codegen_llvm%2Fsrc%2Fattributes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_llvm%2Fsrc%2Fattributes.rs?ref=052887e4b4c86426423ecd6f244e3e25cd71dd49", "patch": "@@ -35,6 +35,10 @@ pub fn apply_to_callsite(callsite: &Value, idx: AttributePlace, attrs: &[&Attrib\n /// Get LLVM attribute for the provided inline heuristic.\n #[inline]\n fn inline_attr<'ll>(cx: &CodegenCx<'ll, '_>, inline: InlineAttr) -> Option<&'ll Attribute> {\n+    if !cx.tcx.sess.opts.unstable_opts.inline_llvm {\n+        // disable LLVM inlining\n+        return Some(AttributeKind::NoInline.create_attr(cx.llcx));\n+    }\n     match inline {\n         InlineAttr::Hint => Some(AttributeKind::InlineHint.create_attr(cx.llcx)),\n         InlineAttr::Always => Some(AttributeKind::AlwaysInline.create_attr(cx.llcx)),"}, {"sha": "a25e3362a0c33ed1966af5451c32265ba513e36d", "filename": "compiler/rustc_session/src/options.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/052887e4b4c86426423ecd6f244e3e25cd71dd49/compiler%2Frustc_session%2Fsrc%2Foptions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/052887e4b4c86426423ecd6f244e3e25cd71dd49/compiler%2Frustc_session%2Fsrc%2Foptions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_session%2Fsrc%2Foptions.rs?ref=052887e4b4c86426423ecd6f244e3e25cd71dd49", "patch": "@@ -1345,6 +1345,8 @@ options! {\n         \"hash spans relative to their parent item for incr. comp. (default: no)\"),\n     incremental_verify_ich: bool = (false, parse_bool, [UNTRACKED],\n         \"verify incr. comp. hashes of green query instances (default: no)\"),\n+    inline_llvm: bool = (true, parse_bool, [TRACKED],\n+        \"enable LLVM inlining (default: yes)\"),\n     inline_mir: Option<bool> = (None, parse_opt_bool, [TRACKED],\n         \"enable MIR inlining (default: no)\"),\n     inline_mir_threshold: Option<usize> = (None, parse_opt_number, [TRACKED],"}, {"sha": "73aa0a577c4d572cc5a287af87d125bda68a9b30", "filename": "src/test/rustdoc-ui/z-help.stdout", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/052887e4b4c86426423ecd6f244e3e25cd71dd49/src%2Ftest%2Frustdoc-ui%2Fz-help.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/052887e4b4c86426423ecd6f244e3e25cd71dd49/src%2Ftest%2Frustdoc-ui%2Fz-help.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fz-help.stdout?ref=052887e4b4c86426423ecd6f244e3e25cd71dd49", "patch": "@@ -54,6 +54,7 @@\n     -Z                        incremental-info=val -- print high-level information about incremental reuse (or the lack thereof) (default: no)\n     -Z              incremental-relative-spans=val -- hash spans relative to their parent item for incr. comp. (default: no)\n     -Z                  incremental-verify-ich=val -- verify incr. comp. hashes of green query instances (default: no)\n+    -Z                             inline-llvm=val -- enable LLVM inlining (default: yes)\n     -Z                              inline-mir=val -- enable MIR inlining (default: no)\n     -Z                    inline-mir-threshold=val -- a default MIR inlining threshold (default: 50)\n     -Z               inline-mir-hint-threshold=val -- inlining threshold for functions with inline hint (default: 100)"}]}