{"sha": "52dd0b6801c571bd9c294fe37436cd1a80b4da80", "node_id": "C_kwDOAAsO6NoAKDUyZGQwYjY4MDFjNTcxYmQ5YzI5NGZlMzc0MzZjZDFhODBiNGRhODA", "commit": {"author": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-02-22T01:53:31Z"}, "committer": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-02-22T01:58:26Z"}, "message": "reject compiler-flags as a compiletest attribute", "tree": {"sha": "74cc86d11087ca82f15b49052c4ede9c69601eea", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/74cc86d11087ca82f15b49052c4ede9c69601eea"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/52dd0b6801c571bd9c294fe37436cd1a80b4da80", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/52dd0b6801c571bd9c294fe37436cd1a80b4da80", "html_url": "https://github.com/rust-lang/rust/commit/52dd0b6801c571bd9c294fe37436cd1a80b4da80", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/52dd0b6801c571bd9c294fe37436cd1a80b4da80/comments", "author": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ad430f541cdef6925f7c9a9705d9fa9b6a219334", "url": "https://api.github.com/repos/rust-lang/rust/commits/ad430f541cdef6925f7c9a9705d9fa9b6a219334", "html_url": "https://github.com/rust-lang/rust/commit/ad430f541cdef6925f7c9a9705d9fa9b6a219334"}], "stats": {"total": 5, "additions": 5, "deletions": 0}, "files": [{"sha": "d39497a2c42c84fb10031dc91df751a682fe3c7d", "filename": "src/tools/compiletest/src/header.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/52dd0b6801c571bd9c294fe37436cd1a80b4da80/src%2Ftools%2Fcompiletest%2Fsrc%2Fheader.rs", "raw_url": "https://github.com/rust-lang/rust/raw/52dd0b6801c571bd9c294fe37436cd1a80b4da80/src%2Ftools%2Fcompiletest%2Fsrc%2Fheader.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fheader.rs?ref=52dd0b6801c571bd9c294fe37436cd1a80b4da80", "patch": "@@ -189,6 +189,8 @@ mod directives {\n     pub const STDERR_PER_BITWIDTH: &'static str = \"stderr-per-bitwidth\";\n     pub const INCREMENTAL: &'static str = \"incremental\";\n     pub const KNOWN_BUG: &'static str = \"known-bug\";\n+    // This isn't a real directive, just one that is probably mistyped often\n+    pub const INCORRECT_COMPILER_FLAGS: &'static str = \"compiler-flags\";\n }\n \n impl TestProps {\n@@ -282,6 +284,9 @@ impl TestProps {\n                 if let Some(flags) = config.parse_name_value_directive(ln, COMPILE_FLAGS) {\n                     self.compile_flags.extend(flags.split_whitespace().map(|s| s.to_owned()));\n                 }\n+                if config.parse_name_value_directive(ln, INCORRECT_COMPILER_FLAGS).is_some() {\n+                    panic!(\"`compiler-flags` directive should be spelled `compile-flags`\");\n+                }\n \n                 if let Some(edition) = config.parse_edition(ln) {\n                     self.compile_flags.push(format!(\"--edition={}\", edition));"}]}