{"sha": "f84b0b32425b18301cabcecb61a485ad4a5c8bd4", "node_id": "C_kwDOAAsO6NoAKGY4NGIwYjMyNDI1YjE4MzAxY2FiY2VjYjYxYTQ4NWFkNGE1YzhiZDQ", "commit": {"author": {"name": "Yoshua Wuyts", "email": "yoshuawuyts@gmail.com", "date": "2021-10-14T16:33:29Z"}, "committer": {"name": "Yoshua Wuyts", "email": "yoshuawuyts@gmail.com", "date": "2021-10-14T16:38:52Z"}, "message": "fix ret type in generic", "tree": {"sha": "408f7f0f2a381b33cffd2327587d585cc78dbecb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/408f7f0f2a381b33cffd2327587d585cc78dbecb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f84b0b32425b18301cabcecb61a485ad4a5c8bd4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f84b0b32425b18301cabcecb61a485ad4a5c8bd4", "html_url": "https://github.com/rust-lang/rust/commit/f84b0b32425b18301cabcecb61a485ad4a5c8bd4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f84b0b32425b18301cabcecb61a485ad4a5c8bd4/comments", "author": {"login": "yoshuawuyts", "id": 2467194, "node_id": "MDQ6VXNlcjI0NjcxOTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2467194?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yoshuawuyts", "html_url": "https://github.com/yoshuawuyts", "followers_url": "https://api.github.com/users/yoshuawuyts/followers", "following_url": "https://api.github.com/users/yoshuawuyts/following{/other_user}", "gists_url": "https://api.github.com/users/yoshuawuyts/gists{/gist_id}", "starred_url": "https://api.github.com/users/yoshuawuyts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yoshuawuyts/subscriptions", "organizations_url": "https://api.github.com/users/yoshuawuyts/orgs", "repos_url": "https://api.github.com/users/yoshuawuyts/repos", "events_url": "https://api.github.com/users/yoshuawuyts/events{/privacy}", "received_events_url": "https://api.github.com/users/yoshuawuyts/received_events", "type": "User", "site_admin": false}, "committer": {"login": "yoshuawuyts", "id": 2467194, "node_id": "MDQ6VXNlcjI0NjcxOTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2467194?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yoshuawuyts", "html_url": "https://github.com/yoshuawuyts", "followers_url": "https://api.github.com/users/yoshuawuyts/followers", "following_url": "https://api.github.com/users/yoshuawuyts/following{/other_user}", "gists_url": "https://api.github.com/users/yoshuawuyts/gists{/gist_id}", "starred_url": "https://api.github.com/users/yoshuawuyts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yoshuawuyts/subscriptions", "organizations_url": "https://api.github.com/users/yoshuawuyts/orgs", "repos_url": "https://api.github.com/users/yoshuawuyts/repos", "events_url": "https://api.github.com/users/yoshuawuyts/events{/privacy}", "received_events_url": "https://api.github.com/users/yoshuawuyts/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "987ab1feda701581dc0254453fbf80eaf39d169b", "url": "https://api.github.com/repos/rust-lang/rust/commits/987ab1feda701581dc0254453fbf80eaf39d169b", "html_url": "https://github.com/rust-lang/rust/commit/987ab1feda701581dc0254453fbf80eaf39d169b"}], "stats": {"total": 15, "additions": 3, "deletions": 12}, "files": [{"sha": "233f26ed63707181b342316bd32c0114f2c5bded", "filename": "crates/ide_assists/src/handlers/generate_delegate_methods.rs", "status": "modified", "additions": 3, "deletions": 12, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/f84b0b32425b18301cabcecb61a485ad4a5c8bd4/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fgenerate_delegate_methods.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f84b0b32425b18301cabcecb61a485ad4a5c8bd4/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fgenerate_delegate_methods.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fgenerate_delegate_methods.rs?ref=f84b0b32425b18301cabcecb61a485ad4a5c8bd4", "patch": "@@ -1,4 +1,4 @@\n-use hir::{self, HasCrate, HasSource, HirDisplay};\n+use hir::{self, HasCrate, HasSource};\n use syntax::ast::{self, make, AstNode, HasGenericParams, HasName, HasVisibility};\n \n use crate::{\n@@ -105,16 +105,7 @@ pub(crate) fn generate_delegate_methods(acc: &mut Assists, ctx: &AssistContext)\n                     arg_list,\n                 );\n                 let body = make::block_expr([], Some(tail_expr));\n-                let ret_type = method.ret_type(ctx.db());\n-                let ret_type = if ret_type.is_unknown() {\n-                    // FIXME: we currently can't resolve certain generics, and\n-                    // are returning placeholders instead. We should fix our\n-                    // type resolution here, so we return fewer placeholders.\n-                    Some(make::ret_type(make::ty_placeholder()))\n-                } else {\n-                    let ret_type = &ret_type.display(ctx.db()).to_string();\n-                    Some(make::ret_type(make::ty(ret_type)))\n-                };\n+                let ret_type = method_source.ret_type();\n                 let is_async = method_source.async_token().is_some();\n                 let f = make::fn_(vis, name, type_params, params, body, ret_type, is_async)\n                     .indent(ast::edit::IndentLevel(1))\n@@ -314,7 +305,7 @@ struct Person<T> {\n }\n \n impl<T> Person<T> {\n-    $0pub(crate) async fn age<J, 'a>(&'a mut self, ty: T, arg: J) -> _ {\n+    $0pub(crate) async fn age<J, 'a>(&'a mut self, ty: T, arg: J) -> T {\n         self.age.age(ty, arg)\n     }\n }\"#,"}]}