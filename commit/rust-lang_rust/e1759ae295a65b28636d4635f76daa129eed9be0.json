{"sha": "e1759ae295a65b28636d4635f76daa129eed9be0", "node_id": "MDY6Q29tbWl0NzI0NzEyOmUxNzU5YWUyOTVhNjViMjg2MzZkNDYzNWY3NmRhYTEyOWVlZDliZTA=", "commit": {"author": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2016-08-10T09:52:46Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2016-08-10T09:52:46Z"}, "message": "Merge pull request #1123 from juicejitsu/807\n\nDon't emit filename in diff mode, add filename to diff metadata", "tree": {"sha": "a568620f6773e0c2cb3a4e352344f8be3a2eedcf", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a568620f6773e0c2cb3a4e352344f8be3a2eedcf"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e1759ae295a65b28636d4635f76daa129eed9be0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e1759ae295a65b28636d4635f76daa129eed9be0", "html_url": "https://github.com/rust-lang/rust/commit/e1759ae295a65b28636d4635f76daa129eed9be0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e1759ae295a65b28636d4635f76daa129eed9be0/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4029b0e704bbb8300158eb5857d516614ef4ee23", "url": "https://api.github.com/repos/rust-lang/rust/commits/4029b0e704bbb8300158eb5857d516614ef4ee23", "html_url": "https://github.com/rust-lang/rust/commit/4029b0e704bbb8300158eb5857d516614ef4ee23"}, {"sha": "a0de408198d5f1e8e2d96b471450af3742dfdddc", "url": "https://api.github.com/repos/rust-lang/rust/commits/a0de408198d5f1e8e2d96b471450af3742dfdddc", "html_url": "https://github.com/rust-lang/rust/commit/a0de408198d5f1e8e2d96b471450af3742dfdddc"}], "stats": {"total": 10, "additions": 8, "deletions": 2}, "files": [{"sha": "5560e9aee852e14ea12e62d0e89c628746abf899", "filename": "src/filemap.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/e1759ae295a65b28636d4635f76daa129eed9be0/src%2Ffilemap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e1759ae295a65b28636d4635f76daa129eed9be0/src%2Ffilemap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ffilemap.rs?ref=e1759ae295a65b28636d4635f76daa129eed9be0", "patch": "@@ -144,11 +144,11 @@ pub fn write_file<T>(text: &StringBuffer,\n             try!(write_system_newlines(stdout, text, config));\n         }\n         WriteMode::Diff => {\n-            println!(\"Diff of {}:\\n\", filename);\n             if let Ok((ori, fmt)) = source_and_formatted_text(text, filename, config) {\n                 let mismatch = make_diff(&ori, &fmt, 3);\n                 let has_diff = !mismatch.is_empty();\n-                print_diff(mismatch, |line_num| format!(\"\\nDiff at line {}:\", line_num));\n+                print_diff(mismatch,\n+                           |line_num| format!(\"Diff in {} at line {}:\", filename, line_num));\n                 return Ok(has_diff);\n             }\n         }"}, {"sha": "3534052a1732ea05435d781f5b94a302ce390263", "filename": "tests/system.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/e1759ae295a65b28636d4635f76daa129eed9be0/tests%2Fsystem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e1759ae295a65b28636d4635f76daa129eed9be0/tests%2Fsystem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsystem.rs?ref=e1759ae295a65b28636d4635f76daa129eed9be0", "patch": "@@ -365,3 +365,9 @@ fn rustfmt_diff_make_diff_tests() {\n                                     DiffLine::Context(\"d\".into())],\n                     }]);\n }\n+\n+#[test]\n+fn rustfmt_diff_no_diff_test() {\n+    let diff = make_diff(\"a\\nb\\nc\\nd\", \"a\\nb\\nc\\nd\", 3);\n+    assert_eq!(diff, vec![]);\n+}"}]}