{"sha": "6095fa146ce994c1650376257ab488156e6e745a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYwOTVmYTE0NmNlOTk0YzE2NTAzNzYyNTdhYjQ4ODE1NmU2ZTc0NWE=", "commit": {"author": {"name": "Markus Westerlind", "email": "markus.westerlind@distilnetworks.com", "date": "2020-03-07T19:17:00Z"}, "committer": {"name": "Markus Westerlind", "email": "markus.westerlind@distilnetworks.com", "date": "2020-03-07T21:35:37Z"}, "message": "refactor: Move a borrow_mut and unwrap out of a loop", "tree": {"sha": "30e183afc29d468dab470379c9961a37c3ca089a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/30e183afc29d468dab470379c9961a37c3ca089a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6095fa146ce994c1650376257ab488156e6e745a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6095fa146ce994c1650376257ab488156e6e745a", "html_url": "https://github.com/rust-lang/rust/commit/6095fa146ce994c1650376257ab488156e6e745a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6095fa146ce994c1650376257ab488156e6e745a/comments", "author": null, "committer": null, "parents": [{"sha": "b1b558f1f0cf5caab5c44c88e7050cba71c6be0d", "url": "https://api.github.com/repos/rust-lang/rust/commits/b1b558f1f0cf5caab5c44c88e7050cba71c6be0d", "html_url": "https://github.com/rust-lang/rust/commit/b1b558f1f0cf5caab5c44c88e7050cba71c6be0d"}], "stats": {"total": 14, "additions": 8, "deletions": 6}, "files": [{"sha": "542a1ac4536c1804bc546b7625d54e9c464f7c40", "filename": "src/librustc_typeck/check/method/mod.rs", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/6095fa146ce994c1650376257ab488156e6e745a/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6095fa146ce994c1650376257ab488156e6e745a/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fmethod%2Fmod.rs?ref=6095fa146ce994c1650376257ab488156e6e745a", "patch": "@@ -459,12 +459,14 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n             ProbeScope::TraitsInScope,\n         )?;\n         debug!(\"resolve_ufcs: pick={:?}\", pick);\n-        for import_id in pick.import_ids {\n-            let import_def_id = tcx.hir().local_def_id(import_id);\n-            debug!(\"resolve_ufcs: used_trait_import: {:?}\", import_def_id);\n-            Lrc::get_mut(&mut self.tables.borrow_mut().used_trait_imports)\n-                .unwrap()\n-                .insert(import_def_id);\n+        {\n+            let mut tables = self.tables.borrow_mut();\n+            let used_trait_imports = Lrc::get_mut(&mut tables.used_trait_imports).unwrap();\n+            for import_id in pick.import_ids {\n+                let import_def_id = tcx.hir().local_def_id(import_id);\n+                debug!(\"resolve_ufcs: used_trait_import: {:?}\", import_def_id);\n+                used_trait_imports.insert(import_def_id);\n+            }\n         }\n \n         let def_kind = pick.item.def_kind();"}]}