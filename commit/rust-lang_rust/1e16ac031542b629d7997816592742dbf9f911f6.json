{"sha": "1e16ac031542b629d7997816592742dbf9f911f6", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFlMTZhYzAzMTU0MmI2MjlkNzk5NzgxNjU5Mjc0MmRiZjlmOTExZjY=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2019-09-18T11:24:20Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2019-09-18T11:24:20Z"}, "message": "tweak installation process", "tree": {"sha": "a907d71d440040f1371814cfed6af6f637e38b63", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a907d71d440040f1371814cfed6af6f637e38b63"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1e16ac031542b629d7997816592742dbf9f911f6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1e16ac031542b629d7997816592742dbf9f911f6", "html_url": "https://github.com/rust-lang/rust/commit/1e16ac031542b629d7997816592742dbf9f911f6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1e16ac031542b629d7997816592742dbf9f911f6/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "630d212525192c714d4fbab398031aa88c49e538", "url": "https://api.github.com/repos/rust-lang/rust/commits/630d212525192c714d4fbab398031aa88c49e538", "html_url": "https://github.com/rust-lang/rust/commit/630d212525192c714d4fbab398031aa88c49e538"}], "stats": {"total": 53, "additions": 32, "deletions": 21}, "files": [{"sha": "e249c6486352c654b22b3eca2c351738c08b498c", "filename": "README.md", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/1e16ac031542b629d7997816592742dbf9f911f6/README.md", "raw_url": "https://github.com/rust-lang/rust/raw/1e16ac031542b629d7997816592742dbf9f911f6/README.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/README.md?ref=1e16ac031542b629d7997816592742dbf9f911f6", "patch": "@@ -23,9 +23,10 @@ useful IDE experience and some people use it as a daily driver.\n To build rust-analyzer, you need:\n \n * latest stable rust for language server itself\n-* latest stable npm and VS Code for VS Code extension (`code` should be in path)\n+* latest stable npm and VS Code for VS Code extension\n \n-For setup for other editors, see [./docs/user](./docs/user).\n+To quickly install rust-analyzer with VS Code extension with standard setup\n+(`code` and `cargo` in `$PATH`, etc), use this:\n \n ```\n # clone the repo\n@@ -37,6 +38,9 @@ $ cargo install-ra\n # alternatively, install only the server. Binary name is `ra_lsp_server`.\n $ cargo install-ra --server\n ```\n+\n+For non-standard setup of VS Code and other editors, see [./docs/user](./docs/user).\n+\n ## Documentation\n \n If you want to **contribute** to rust-analyzer or just curious about how things work"}, {"sha": "9ba23caaa99278e8dede6dfe629131bd066da85f", "filename": "crates/ra_tools/src/lib.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/1e16ac031542b629d7997816592742dbf9f911f6/crates%2Fra_tools%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1e16ac031542b629d7997816592742dbf9f911f6/crates%2Fra_tools%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_tools%2Fsrc%2Flib.rs?ref=1e16ac031542b629d7997816592742dbf9f911f6", "patch": "@@ -79,13 +79,13 @@ pub fn project_root() -> PathBuf {\n     Path::new(&env!(\"CARGO_MANIFEST_DIR\")).ancestors().nth(2).unwrap().to_path_buf()\n }\n \n-pub struct Cmd {\n-    pub unix: &'static str,\n-    pub windows: &'static str,\n-    pub work_dir: &'static str,\n+pub struct Cmd<'a> {\n+    pub unix: &'a str,\n+    pub windows: &'a str,\n+    pub work_dir: &'a str,\n }\n \n-impl Cmd {\n+impl Cmd<'_> {\n     pub fn run(self) -> Result<()> {\n         if cfg!(windows) {\n             run(self.windows, self.work_dir)"}, {"sha": "65d211b44f3360105bb4436ec0df572bee0b7587", "filename": "crates/ra_tools/src/main.rs", "status": "modified", "additions": 21, "deletions": 14, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/1e16ac031542b629d7997816592742dbf9f911f6/crates%2Fra_tools%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1e16ac031542b629d7997816592742dbf9f911f6/crates%2Fra_tools%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_tools%2Fsrc%2Fmain.rs?ref=1e16ac031542b629d7997816592742dbf9f911f6", "patch": "@@ -167,27 +167,34 @@ fn install_client(ClientOpt::VsCode: ClientOpt) -> Result<()> {\n     }\n     .run()?;\n \n-    let code_in_path = Cmd {\n-        unix: r\"code --version\",\n-        windows: r\"cmd.exe /c code.cmd --version\",\n-        work_dir: \"./editors/code\",\n-    }\n-    .run()\n-    .is_ok();\n-    if !code_in_path {\n-        Err(\"Can't execute `code --version`. Perhaps it is not in $PATH?\")?;\n-    }\n+    let code_binary = [\"code\", \"code-insiders\"].iter().find(|bin| {\n+        Cmd {\n+            unix: &format!(\"{} --version\", bin),\n+            windows: &format!(\"cmd.exe /c {}.cmd --version\", bin),\n+            work_dir: \"./editors/code\",\n+        }\n+        .run()\n+        .is_ok()\n+    });\n+\n+    let code_binary = match code_binary {\n+        Some(it) => it,\n+        None => Err(\"Can't execute `code --version`. Perhaps it is not in $PATH?\")?,\n+    };\n \n     Cmd {\n-        unix: r\"code --install-extension ./ra-lsp-0.0.1.vsix --force\",\n-        windows: r\"cmd.exe /c code.cmd --install-extension ./ra-lsp-0.0.1.vsix --force\",\n+        unix: &format!(r\"{} --install-extension ./ra-lsp-0.0.1.vsix --force\", code_binary),\n+        windows: &format!(\n+            r\"cmd.exe /c {}.cmd --install-extension ./ra-lsp-0.0.1.vsix --force\",\n+            code_binary\n+        ),\n         work_dir: \"./editors/code\",\n     }\n     .run()?;\n \n     let output = Cmd {\n-        unix: r\"code --list-extensions\",\n-        windows: r\"cmd.exe /c code.cmd --list-extensions\",\n+        unix: &format!(r\"{} --list-extensions\", code_binary),\n+        windows: &format!(r\"cmd.exe /c {}.cmd --list-extensions\", code_binary),\n         work_dir: \".\",\n     }\n     .run_with_output()?;"}]}