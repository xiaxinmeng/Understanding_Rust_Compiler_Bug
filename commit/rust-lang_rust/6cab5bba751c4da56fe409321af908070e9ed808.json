{"sha": "6cab5bba751c4da56fe409321af908070e9ed808", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZjYWI1YmJhNzUxYzRkYTU2ZmU0MDkzMjFhZjkwODA3MGU5ZWQ4MDg=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2015-02-16T05:57:42Z"}, "committer": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2015-02-17T00:53:36Z"}, "message": "Rollup merge of #22341 - fhahn:issue-22291-PLEASE-FAIL, r=alexcrichton\n\nThis is a patch for #22291.\n\nPLEASE_BENCH=1 adds --bench to the arguments passed to the executable to be tested. At the moment, compiletest does not accept a --bench argument, because it is not needed for any test in src/test/, even the tests in src/test/bench do not use #[bench].\n\nI have updated the makefile to only add the --bench flag for crate tests. I do not think that changing compiletest add --bench to the run arguments of all compile tests makes sense, because it would mess up tests which check command line arguments. Also the bench option can be added as comment in a compile test as well.", "tree": {"sha": "3f9689621c7182309899ed04ea872fa85eff734e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3f9689621c7182309899ed04ea872fa85eff734e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6cab5bba751c4da56fe409321af908070e9ed808", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6cab5bba751c4da56fe409321af908070e9ed808", "html_url": "https://github.com/rust-lang/rust/commit/6cab5bba751c4da56fe409321af908070e9ed808", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6cab5bba751c4da56fe409321af908070e9ed808/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b0d2c6a71485dcba9952cc240b7cb73e85f10f10", "url": "https://api.github.com/repos/rust-lang/rust/commits/b0d2c6a71485dcba9952cc240b7cb73e85f10f10", "html_url": "https://github.com/rust-lang/rust/commit/b0d2c6a71485dcba9952cc240b7cb73e85f10f10"}, {"sha": "ff1181da15ff399846b57a90481f649d6563261b", "url": "https://api.github.com/repos/rust-lang/rust/commits/ff1181da15ff399846b57a90481f649d6563261b", "html_url": "https://github.com/rust-lang/rust/commit/ff1181da15ff399846b57a90481f649d6563261b"}], "stats": {"total": 10, "additions": 5, "deletions": 5}, "files": [{"sha": "c5bb6ef81f6dae59dbdd73e62c07fd02791b14b5", "filename": "mk/tests.mk", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/6cab5bba751c4da56fe409321af908070e9ed808/mk%2Ftests.mk", "raw_url": "https://github.com/rust-lang/rust/raw/6cab5bba751c4da56fe409321af908070e9ed808/mk%2Ftests.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftests.mk?ref=6cab5bba751c4da56fe409321af908070e9ed808", "patch": "@@ -38,23 +38,23 @@ ifdef CHECK_IGNORED\n   TESTARGS += --ignored\n endif\n \n-\n # Arguments to the cfail/rfail/rpass/bench tests\n ifdef CFG_VALGRIND\n   CTEST_RUNTOOL = --runtool \"$(CFG_VALGRIND)\"\n endif\n \n-ifdef PLEASE_BENCH\n-  TESTARGS += --bench\n-endif\n-\n # Arguments to the perf tests\n ifdef CFG_PERF_TOOL\n   CTEST_PERF_RUNTOOL = --runtool \"$(CFG_PERF_TOOL)\"\n endif\n \n CTEST_TESTARGS := $(TESTARGS)\n \n+# --bench is only relevant for crate tests, not for the compile tests\n+ifdef PLEASE_BENCH\n+  TESTARGS += --bench\n+endif\n+\n ifdef VERBOSE\n   CTEST_TESTARGS += --verbose\n endif"}]}