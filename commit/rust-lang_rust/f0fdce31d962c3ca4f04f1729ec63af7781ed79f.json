{"sha": "f0fdce31d962c3ca4f04f1729ec63af7781ed79f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYwZmRjZTMxZDk2MmMzY2E0ZjA0ZjE3MjllYzYzYWY3NzgxZWQ3OWY=", "commit": {"author": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2018-06-27T19:43:23Z"}, "committer": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2018-06-27T19:45:53Z"}, "message": "update comments", "tree": {"sha": "c5932be6508e34ab7ea25f1326b0e3ab9d1e6a44", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c5932be6508e34ab7ea25f1326b0e3ab9d1e6a44"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f0fdce31d962c3ca4f04f1729ec63af7781ed79f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f0fdce31d962c3ca4f04f1729ec63af7781ed79f", "html_url": "https://github.com/rust-lang/rust/commit/f0fdce31d962c3ca4f04f1729ec63af7781ed79f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f0fdce31d962c3ca4f04f1729ec63af7781ed79f/comments", "author": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5fd3b2628087f254de51074bede5f17765dc1373", "url": "https://api.github.com/repos/rust-lang/rust/commits/5fd3b2628087f254de51074bede5f17765dc1373", "html_url": "https://github.com/rust-lang/rust/commit/5fd3b2628087f254de51074bede5f17765dc1373"}], "stats": {"total": 18, "additions": 15, "deletions": 3}, "files": [{"sha": "3dfa66cd41a4f5813d41316ac2d6fc888401e760", "filename": "src/librustc/traits/query/type_op/mod.rs", "status": "modified", "additions": 15, "deletions": 3, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/f0fdce31d962c3ca4f04f1729ec63af7781ed79f/src%2Flibrustc%2Ftraits%2Fquery%2Ftype_op%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f0fdce31d962c3ca4f04f1729ec63af7781ed79f/src%2Flibrustc%2Ftraits%2Fquery%2Ftype_op%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Ftraits%2Fquery%2Ftype_op%2Fmod.rs?ref=f0fdce31d962c3ca4f04f1729ec63af7781ed79f", "patch": "@@ -26,6 +26,9 @@ pub mod prove_predicate;\n use self::prove_predicate::ProvePredicate;\n pub mod subtype;\n \n+/// \"Type ops\" are used in NLL to perform some particular action and\n+/// extract out the resulting region constraints (or an error if it\n+/// cannot be completed).\n pub trait TypeOp<'gcx, 'tcx>: Sized + fmt::Debug {\n     type Output;\n \n@@ -38,14 +41,23 @@ pub trait TypeOp<'gcx, 'tcx>: Sized + fmt::Debug {\n     ) -> Fallible<(Self::Output, Option<Rc<Vec<QueryRegionConstraint<'tcx>>>>)>;\n }\n \n+/// \"Query type ops\" are type ops that are implemented using a\n+/// [canonical query][c]. The `Self` type here contains the kernel of\n+/// information needed to do the operation -- `TypeOp` is actually\n+/// implemented for `ParamEnvAnd<Self>`, since we always need to bring\n+/// along a parameter environment as well. For query type-ops, we will\n+/// first canonicalize the key and then invoke the query on the tcx,\n+/// which produces the resulting query region constraints.\n+///\n+/// [c]: https://rust-lang-nursery.github.io/rustc-guide/traits/canonicalization.html\n pub trait QueryTypeOp<'gcx: 'tcx, 'tcx>:\n     fmt::Debug + Sized + TypeFoldable<'tcx> + Lift<'gcx>\n {\n     type QueryResult: TypeFoldable<'tcx> + Lift<'gcx>;\n \n-    /// Either converts `self` directly into a `QueryResult` (for\n-    /// simple cases) or into a `QueryKey` (for more complex cases\n-    /// where we actually have work to do).\n+    /// Give query the option for a simple fast path that never\n+    /// actually hits the tcx cache lookup etc. Return `Some(r)` with\n+    /// a final result or `None` to do the full path.\n     fn try_fast_path(\n         tcx: TyCtxt<'_, 'gcx, 'tcx>,\n         key: &ParamEnvAnd<'tcx, Self>,"}]}