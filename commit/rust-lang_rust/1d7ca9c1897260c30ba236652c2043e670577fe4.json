{"sha": "1d7ca9c1897260c30ba236652c2043e670577fe4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFkN2NhOWMxODk3MjYwYzMwYmEyMzY2NTJjMjA0M2U2NzA1NzdmZTQ=", "commit": {"author": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2011-08-17T18:42:51Z"}, "committer": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2011-08-17T18:43:45Z"}, "message": "rustc: Add the dynastack upcalls to upcall.rs", "tree": {"sha": "86401b58d9e921de2dc27d52fac6a7ce2a9bc175", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/86401b58d9e921de2dc27d52fac6a7ce2a9bc175"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1d7ca9c1897260c30ba236652c2043e670577fe4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1d7ca9c1897260c30ba236652c2043e670577fe4", "html_url": "https://github.com/rust-lang/rust/commit/1d7ca9c1897260c30ba236652c2043e670577fe4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1d7ca9c1897260c30ba236652c2043e670577fe4/comments", "author": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "556de425b3824933c73e6e9badb74079341de7c8", "url": "https://api.github.com/repos/rust-lang/rust/commits/556de425b3824933c73e6e9badb74079341de7c8", "html_url": "https://github.com/rust-lang/rust/commit/556de425b3824933c73e6e9badb74079341de7c8"}], "stats": {"total": 13, "additions": 11, "deletions": 2}, "files": [{"sha": "f5fa9b02f8c3584da7488a5c57730a9e2c4f624f", "filename": "src/comp/back/upcall.rs", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/1d7ca9c1897260c30ba236652c2043e670577fe4/src%2Fcomp%2Fback%2Fupcall.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1d7ca9c1897260c30ba236652c2043e670577fe4/src%2Fcomp%2Fback%2Fupcall.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fback%2Fupcall.rs?ref=1d7ca9c1897260c30ba236652c2043e670577fe4", "patch": "@@ -45,7 +45,10 @@ type upcalls =\n      ivec_resize_shared: ValueRef,\n      ivec_spill_shared: ValueRef,\n      cmp_type: ValueRef,\n-     log_type: ValueRef};\n+     log_type: ValueRef,\n+     dynastack_mark: ValueRef,\n+     dynastack_alloc: ValueRef,\n+     dynastack_free: ValueRef};\n \n fn declare_upcalls(tn: type_names, tydesc_type: TypeRef,\n                    taskptr_type: TypeRef, llmod: ModuleRef) -> @upcalls {\n@@ -111,7 +114,13 @@ fn declare_upcalls(tn: type_names, tydesc_type: TypeRef,\n           log_type:\n               dr(\"log_type\", ~[taskptr_type, T_ptr(tydesc_type),\n                  T_ptr(T_i8()), T_i32()],\n-                 T_void())};\n+                 T_void()),\n+          dynastack_mark:\n+              d(\"dynastack_mark\", ~[], T_ptr(T_i8())),\n+          dynastack_alloc:\n+              d(\"dynastack_alloc\", ~[T_size_t()], T_ptr(T_i8())),\n+          dynastack_free:\n+              d(\"dynastack_free\", ~[T_ptr(T_i8())], T_void())};\n }\n //\n // Local Variables:"}]}