{"sha": "a4b0481d1c21be290f587a85e8bb342b6d0b7093", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE0YjA0ODFkMWMyMWJlMjkwZjU4N2E4NWU4YmIzNDJiNmQwYjcwOTM=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2016-05-01T19:59:25Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2016-05-01T19:59:25Z"}, "message": "Auto merge of #33317 - michaelwoerister:fix-partitioning-tests-race, r=alexcrichton\n\nFix a race condition caused by concurrently executed codegen unit tests.\n\nThis hopefully fixes issue #33315.\n\nThis short-term solution just makes sure that every test uses its own directory so they can't get into conflict with each other.\n\nAs a more long-term solution, I'd probably prefer to make the partitioning scheme specifiable via `-Ccodegen-units` (e.g. like `-Ccodegen-units=per-module`) so that we don't have to rely on `-Zincremental` in these test cases.\n\nr? @alexcrichton", "tree": {"sha": "0d12947c403d91b6561d5e88bc7cb9fcbda674a0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0d12947c403d91b6561d5e88bc7cb9fcbda674a0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a4b0481d1c21be290f587a85e8bb342b6d0b7093", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a4b0481d1c21be290f587a85e8bb342b6d0b7093", "html_url": "https://github.com/rust-lang/rust/commit/a4b0481d1c21be290f587a85e8bb342b6d0b7093", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a4b0481d1c21be290f587a85e8bb342b6d0b7093/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2a815a26c8ce70e1aede585827c020d9775a8faf", "url": "https://api.github.com/repos/rust-lang/rust/commits/2a815a26c8ce70e1aede585827c020d9775a8faf", "html_url": "https://github.com/rust-lang/rust/commit/2a815a26c8ce70e1aede585827c020d9775a8faf"}, {"sha": "a4128e5950395993b3db1e0db095c07727f55991", "url": "https://api.github.com/repos/rust-lang/rust/commits/a4128e5950395993b3db1e0db095c07727f55991", "html_url": "https://github.com/rust-lang/rust/commit/a4128e5950395993b3db1e0db095c07727f55991"}], "stats": {"total": 41, "additions": 31, "deletions": 10}, "files": [{"sha": "5262d31ae0dcabbbd4db466d61f692b73b48a860", "filename": "src/test/codegen-units/partitioning/extern-drop-glue.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fextern-drop-glue.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fextern-drop-glue.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fextern-drop-glue.rs?ref=a4b0481d1c21be290f587a85e8bb342b6d0b7093", "patch": "@@ -9,7 +9,10 @@\n // except according to those terms.\n \n // ignore-tidy-linelength\n-// compile-flags:-Zprint-trans-items=lazy -Zincremental=tmp\n+\n+// We specify -Z incremental here because we want to test the partitioning for\n+// incremental compilation\n+// compile-flags:-Zprint-trans-items=lazy -Zincremental=tmp/partitioning-tests/extern-drop-glue\n \n #![allow(dead_code)]\n #![crate_type=\"lib\"]"}, {"sha": "6beed231df993704c3472b8e72c7e47030db173b", "filename": "src/test/codegen-units/partitioning/extern-generic.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fextern-generic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fextern-generic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fextern-generic.rs?ref=a4b0481d1c21be290f587a85e8bb342b6d0b7093", "patch": "@@ -9,7 +9,9 @@\n // except according to those terms.\n \n // ignore-tidy-linelength\n-// compile-flags:-Zprint-trans-items=eager -Zincremental=tmp\n+// We specify -Z incremental here because we want to test the partitioning for\n+// incremental compilation\n+// compile-flags:-Zprint-trans-items=eager -Zincremental=tmp/partitioning-tests/extern-generic\n \n #![allow(dead_code)]\n #![crate_type=\"lib\"]"}, {"sha": "967824f31d0456279a5396cded3edfafa7926741", "filename": "src/test/codegen-units/partitioning/inlining-from-extern-crate.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Finlining-from-extern-crate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Finlining-from-extern-crate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Finlining-from-extern-crate.rs?ref=a4b0481d1c21be290f587a85e8bb342b6d0b7093", "patch": "@@ -9,7 +9,9 @@\n // except according to those terms.\n \n // ignore-tidy-linelength\n-// compile-flags:-Zprint-trans-items=lazy -Zincremental=tmp\n+// We specify -Z incremental here because we want to test the partitioning for\n+// incremental compilation\n+// compile-flags:-Zprint-trans-items=lazy -Zincremental=tmp/partitioning-tests/inlining-from-extern-crate\n \n #![crate_type=\"lib\"]\n "}, {"sha": "1edc3d5d2e238f0a31905981112dbe9e61d3a877", "filename": "src/test/codegen-units/partitioning/local-drop-glue.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-drop-glue.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-drop-glue.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-drop-glue.rs?ref=a4b0481d1c21be290f587a85e8bb342b6d0b7093", "patch": "@@ -9,7 +9,9 @@\n // except according to those terms.\n \n // ignore-tidy-linelength\n-// compile-flags:-Zprint-trans-items=lazy -Zincremental=tmp\n+// We specify -Z incremental here because we want to test the partitioning for\n+// incremental compilation\n+// compile-flags:-Zprint-trans-items=lazy -Zincremental=tmp/partitioning-tests/local-drop-glue\n \n #![allow(dead_code)]\n #![crate_type=\"lib\"]"}, {"sha": "4c762ebdc2e54073d745a95b2517dc1767393932", "filename": "src/test/codegen-units/partitioning/local-generic.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-generic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-generic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-generic.rs?ref=a4b0481d1c21be290f587a85e8bb342b6d0b7093", "patch": "@@ -9,7 +9,9 @@\n // except according to those terms.\n \n // ignore-tidy-linelength\n-// compile-flags:-Zprint-trans-items=eager -Zincremental=tmp\n+// We specify -Z incremental here because we want to test the partitioning for\n+// incremental compilation\n+// compile-flags:-Zprint-trans-items=eager -Zincremental=tmp/partitioning-tests/local-generic\n \n #![allow(dead_code)]\n #![crate_type=\"lib\"]"}, {"sha": "880cc0a4fb47a003c75cbb719825687b1aab2044", "filename": "src/test/codegen-units/partitioning/local-inlining.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-inlining.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-inlining.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-inlining.rs?ref=a4b0481d1c21be290f587a85e8bb342b6d0b7093", "patch": "@@ -9,7 +9,9 @@\n // except according to those terms.\n \n // ignore-tidy-linelength\n-// compile-flags:-Zprint-trans-items=lazy -Zincremental=tmp\n+// We specify -Z incremental here because we want to test the partitioning for\n+// incremental compilation\n+// compile-flags:-Zprint-trans-items=lazy -Zincremental=tmp/partitioning-tests/local-inlining\n \n #![allow(dead_code)]\n #![crate_type=\"lib\"]"}, {"sha": "f3efa2587d3d5d3f7518e6294d52a0c91f97e5cb", "filename": "src/test/codegen-units/partitioning/local-transitive-inlining.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-transitive-inlining.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-transitive-inlining.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-transitive-inlining.rs?ref=a4b0481d1c21be290f587a85e8bb342b6d0b7093", "patch": "@@ -9,7 +9,9 @@\n // except according to those terms.\n \n // ignore-tidy-linelength\n-// compile-flags:-Zprint-trans-items=lazy -Zincremental=tmp\n+// We specify -Z incremental here because we want to test the partitioning for\n+// incremental compilation\n+// compile-flags:-Zprint-trans-items=lazy -Zincremental=tmp/partitioning-tests/local-transitive-inlining\n \n #![allow(dead_code)]\n #![crate_type=\"lib\"]"}, {"sha": "390bade153c5855261ce47c059640168366f46de", "filename": "src/test/codegen-units/partitioning/methods-are-with-self-type.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fmethods-are-with-self-type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fmethods-are-with-self-type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fmethods-are-with-self-type.rs?ref=a4b0481d1c21be290f587a85e8bb342b6d0b7093", "patch": "@@ -9,7 +9,9 @@\n // except according to those terms.\n \n // ignore-tidy-linelength\n-// compile-flags:-Zprint-trans-items=lazy -Zincremental=tmp\n+// We specify -Z incremental here because we want to test the partitioning for\n+// incremental compilation\n+// compile-flags:-Zprint-trans-items=lazy -Zincremental=tmp/partitioning-tests/methods-are-with-self-type\n \n #![allow(dead_code)]\n "}, {"sha": "c3af86f820f18f20a3045e14bd95607188fca004", "filename": "src/test/codegen-units/partitioning/regular-modules.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fregular-modules.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fregular-modules.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fregular-modules.rs?ref=a4b0481d1c21be290f587a85e8bb342b6d0b7093", "patch": "@@ -9,7 +9,9 @@\n // except according to those terms.\n \n // ignore-tidy-linelength\n-// compile-flags:-Zprint-trans-items=eager -Z incremental=tmp\n+// We specify -Z incremental here because we want to test the partitioning for\n+// incremental compilation\n+// compile-flags:-Zprint-trans-items=eager -Zincremental=tmp/partitioning-tests/regular-modules\n \n #![allow(dead_code)]\n #![crate_type=\"lib\"]"}, {"sha": "9e878b95a369a043c4c2f68eeb308fa68a6fe177", "filename": "src/test/codegen-units/partitioning/statics.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fstatics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a4b0481d1c21be290f587a85e8bb342b6d0b7093/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fstatics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fstatics.rs?ref=a4b0481d1c21be290f587a85e8bb342b6d0b7093", "patch": "@@ -9,7 +9,9 @@\n // except according to those terms.\n \n // ignore-tidy-linelength\n-// compile-flags:-Zprint-trans-items=lazy -Zincremental=tmp\n+// We specify -Z incremental here because we want to test the partitioning for\n+// incremental compilation\n+// compile-flags:-Zprint-trans-items=lazy -Zincremental=tmp/partitioning-tests/statics\n \n #![crate_type=\"lib\"]\n "}]}