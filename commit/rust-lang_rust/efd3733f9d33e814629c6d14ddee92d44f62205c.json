{"sha": "efd3733f9d33e814629c6d14ddee92d44f62205c", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVmZDM3MzNmOWQzM2U4MTQ2MjljNmQxNGRkZWU5MmQ0NGY2MjIwNWM=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-04-25T03:48:26Z"}, "committer": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-05-10T17:41:10Z"}, "message": "add test checking that 'if cond { .. }' where 'cond: &mut? bool' isn't accepted.", "tree": {"sha": "197eb529ad95059ee92cd8604c4d93ccc6920eff", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/197eb529ad95059ee92cd8604c4d93ccc6920eff"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/efd3733f9d33e814629c6d14ddee92d44f62205c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/efd3733f9d33e814629c6d14ddee92d44f62205c", "html_url": "https://github.com/rust-lang/rust/commit/efd3733f9d33e814629c6d14ddee92d44f62205c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/efd3733f9d33e814629c6d14ddee92d44f62205c/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8d1e5b8b396e06778583ad62177430d2b95015f5", "url": "https://api.github.com/repos/rust-lang/rust/commits/8d1e5b8b396e06778583ad62177430d2b95015f5", "html_url": "https://github.com/rust-lang/rust/commit/8d1e5b8b396e06778583ad62177430d2b95015f5"}], "stats": {"total": 61, "additions": 61, "deletions": 0}, "files": [{"sha": "581ce18c1d6146f9ae122163cb9de31a65c723b8", "filename": "src/test/ui/if/if-no-match-bindings.rs", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/efd3733f9d33e814629c6d14ddee92d44f62205c/src%2Ftest%2Fui%2Fif%2Fif-no-match-bindings.rs", "raw_url": "https://github.com/rust-lang/rust/raw/efd3733f9d33e814629c6d14ddee92d44f62205c/src%2Ftest%2Fui%2Fif%2Fif-no-match-bindings.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fif%2Fif-no-match-bindings.rs?ref=efd3733f9d33e814629c6d14ddee92d44f62205c", "patch": "@@ -0,0 +1,22 @@\n+// Checks for `if` expressions with respect to default match bindings.\n+// Specifically, we do not accept `if cond { ... }` where `cond: &mut? bool`.\n+// Meanwhile, `match cond { true => ..., _ => ... }` does accept that.\n+\n+// FIXME(@rust-lang/lang-team): consider relaxing this?\n+\n+fn b_ref<'a>() -> &'a bool { &true }\n+fn b_mut_ref<'a>() -> &'a mut bool { &mut true }\n+\n+fn main() {\n+    // This is OK:\n+    match b_ref() { true => {}, _ => {} }\n+    match b_mut_ref() { true => {}, _ => {} }\n+    match &true { true => {}, _ => {} }\n+    match &mut true { true => {}, _ => {} }\n+\n+    // This is NOT:\n+    if b_ref() {} //~ ERROR mismatched types [E0308]\n+    if b_mut_ref() {} //~ ERROR mismatched types [E0308]\n+    if &true {} //~ ERROR mismatched types [E0308]\n+    if &mut true {} //~ ERROR mismatched types [E0308]\n+}"}, {"sha": "7b0b472121fcec79b938859523b9100121fd3c35", "filename": "src/test/ui/if/if-no-match-bindings.stderr", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/efd3733f9d33e814629c6d14ddee92d44f62205c/src%2Ftest%2Fui%2Fif%2Fif-no-match-bindings.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/efd3733f9d33e814629c6d14ddee92d44f62205c/src%2Ftest%2Fui%2Fif%2Fif-no-match-bindings.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fif%2Fif-no-match-bindings.stderr?ref=efd3733f9d33e814629c6d14ddee92d44f62205c", "patch": "@@ -0,0 +1,39 @@\n+error[E0308]: mismatched types\n+  --> $DIR/if-no-match-bindings.rs:18:8\n+   |\n+LL |     if b_ref() {}\n+   |        ^^^^^^^ expected bool, found &bool\n+   |\n+   = note: expected type `bool`\n+              found type `&bool`\n+\n+error[E0308]: mismatched types\n+  --> $DIR/if-no-match-bindings.rs:19:8\n+   |\n+LL |     if b_mut_ref() {}\n+   |        ^^^^^^^^^^^ expected bool, found &mut bool\n+   |\n+   = note: expected type `bool`\n+              found type `&mut bool`\n+\n+error[E0308]: mismatched types\n+  --> $DIR/if-no-match-bindings.rs:20:8\n+   |\n+LL |     if &true {}\n+   |        ^^^^^ expected bool, found &bool\n+   |\n+   = note: expected type `bool`\n+              found type `&bool`\n+\n+error[E0308]: mismatched types\n+  --> $DIR/if-no-match-bindings.rs:21:8\n+   |\n+LL |     if &mut true {}\n+   |        ^^^^^^^^^ expected bool, found &mut bool\n+   |\n+   = note: expected type `bool`\n+              found type `&mut bool`\n+\n+error: aborting due to 4 previous errors\n+\n+For more information about this error, try `rustc --explain E0308`."}]}