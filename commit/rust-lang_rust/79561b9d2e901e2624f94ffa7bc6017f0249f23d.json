{"sha": "79561b9d2e901e2624f94ffa7bc6017f0249f23d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc5NTYxYjlkMmU5MDFlMjYyNGY5NGZmYTdiYzYwMTdmMDI0OWYyM2Q=", "commit": {"author": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2021-03-15T13:31:55Z"}, "committer": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2021-03-15T13:31:55Z"}, "message": "goto_implementation: Look at the entire crate graph for trait impls", "tree": {"sha": "ec3fe1d72af1162fbe5d9c948adac5260dc73f75", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ec3fe1d72af1162fbe5d9c948adac5260dc73f75"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/79561b9d2e901e2624f94ffa7bc6017f0249f23d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/79561b9d2e901e2624f94ffa7bc6017f0249f23d", "html_url": "https://github.com/rust-lang/rust/commit/79561b9d2e901e2624f94ffa7bc6017f0249f23d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/79561b9d2e901e2624f94ffa7bc6017f0249f23d/comments", "author": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6241567948b644739d2ae904e74f5f10cd5b2bb6", "url": "https://api.github.com/repos/rust-lang/rust/commits/6241567948b644739d2ae904e74f5f10cd5b2bb6", "html_url": "https://github.com/rust-lang/rust/commit/6241567948b644739d2ae904e74f5f10cd5b2bb6"}], "stats": {"total": 11, "additions": 3, "deletions": 8}, "files": [{"sha": "d13b4d5fd9d4e0358b04d1ed2e0884a4c5a0d40a", "filename": "crates/hir/src/lib.rs", "status": "modified", "additions": 3, "deletions": 8, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/79561b9d2e901e2624f94ffa7bc6017f0249f23d/crates%2Fhir%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/79561b9d2e901e2624f94ffa7bc6017f0249f23d/crates%2Fhir%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir%2Fsrc%2Flib.rs?ref=79561b9d2e901e2624f94ffa7bc6017f0249f23d", "patch": "@@ -1488,7 +1488,7 @@ impl Impl {\n     pub fn all_for_type(db: &dyn HirDatabase, Type { krate, ty }: Type) -> Vec<Impl> {\n         let def_crates = match ty.value.def_crates(db, krate) {\n             Some(def_crates) => def_crates,\n-            None => return vec![],\n+            None => return Vec::new(),\n         };\n \n         let filter = |impl_def: &Impl| {\n@@ -1498,16 +1498,11 @@ impl Impl {\n         };\n \n         let mut all = Vec::new();\n-        def_crates.iter().for_each(|&id| {\n+        def_crates.into_iter().for_each(|id| {\n             all.extend(db.inherent_impls_in_crate(id).all_impls().map(Self::from).filter(filter))\n         });\n         let fp = TyFingerprint::for_impl(&ty.value);\n-        for id in def_crates\n-            .iter()\n-            .flat_map(|&id| Crate { id }.reverse_dependencies(db))\n-            .map(|Crate { id }| id)\n-            .chain(def_crates.iter().copied())\n-        {\n+        for id in db.crate_graph().iter() {\n             match fp {\n                 Some(fp) => all.extend(\n                     db.trait_impls_in_crate(id).for_self_ty(fp).map(Self::from).filter(filter),"}]}