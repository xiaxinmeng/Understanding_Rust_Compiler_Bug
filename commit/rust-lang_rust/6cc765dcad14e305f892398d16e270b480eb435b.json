{"sha": "6cc765dcad14e305f892398d16e270b480eb435b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZjYzc2NWRjYWQxNGUzMDVmODkyMzk4ZDE2ZTI3MGI0ODBlYjQzNWI=", "commit": {"author": {"name": "est31", "email": "MTest31@outlook.com", "date": "2017-05-02T02:38:46Z"}, "committer": {"name": "est31", "email": "MTest31@outlook.com", "date": "2017-05-02T03:15:26Z"}, "message": "Add a lint to disallow anonymous parameters", "tree": {"sha": "0d1e8badb0d41873d7b49df8f5390b63bb60d3c4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0d1e8badb0d41873d7b49df8f5390b63bb60d3c4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6cc765dcad14e305f892398d16e270b480eb435b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6cc765dcad14e305f892398d16e270b480eb435b", "html_url": "https://github.com/rust-lang/rust/commit/6cc765dcad14e305f892398d16e270b480eb435b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6cc765dcad14e305f892398d16e270b480eb435b/comments", "author": {"login": "est31", "id": 8872119, "node_id": "MDQ6VXNlcjg4NzIxMTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/est31", "html_url": "https://github.com/est31", "followers_url": "https://api.github.com/users/est31/followers", "following_url": "https://api.github.com/users/est31/following{/other_user}", "gists_url": "https://api.github.com/users/est31/gists{/gist_id}", "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/est31/subscriptions", "organizations_url": "https://api.github.com/users/est31/orgs", "repos_url": "https://api.github.com/users/est31/repos", "events_url": "https://api.github.com/users/est31/events{/privacy}", "received_events_url": "https://api.github.com/users/est31/received_events", "type": "User", "site_admin": false}, "committer": {"login": "est31", "id": 8872119, "node_id": "MDQ6VXNlcjg4NzIxMTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/est31", "html_url": "https://github.com/est31", "followers_url": "https://api.github.com/users/est31/followers", "following_url": "https://api.github.com/users/est31/following{/other_user}", "gists_url": "https://api.github.com/users/est31/gists{/gist_id}", "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/est31/subscriptions", "organizations_url": "https://api.github.com/users/est31/orgs", "repos_url": "https://api.github.com/users/est31/repos", "events_url": "https://api.github.com/users/est31/events{/privacy}", "received_events_url": "https://api.github.com/users/est31/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4cb396c68088f38e517ac8890030d17a969e57ba", "url": "https://api.github.com/repos/rust-lang/rust/commits/4cb396c68088f38e517ac8890030d17a969e57ba", "html_url": "https://github.com/rust-lang/rust/commit/4cb396c68088f38e517ac8890030d17a969e57ba"}], "stats": {"total": 69, "additions": 69, "deletions": 0}, "files": [{"sha": "c9ec152841b2025a1e57e8b09344355aba06a405", "filename": "src/librustc_lint/builtin.rs", "status": "modified", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/6cc765dcad14e305f892398d16e270b480eb435b/src%2Flibrustc_lint%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6cc765dcad14e305f892398d16e270b480eb435b/src%2Flibrustc_lint%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Fbuiltin.rs?ref=6cc765dcad14e305f892398d16e270b480eb435b", "patch": "@@ -45,6 +45,7 @@ use syntax::ast;\n use syntax::attr;\n use syntax::feature_gate::{AttributeGate, AttributeType, Stability, deprecated_attributes};\n use syntax_pos::Span;\n+use syntax::symbol::keywords;\n \n use rustc::hir::{self, PatKind};\n use rustc::hir::intravisit::FnKind;\n@@ -605,6 +606,44 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for MissingDebugImplementations {\n     }\n }\n \n+declare_lint! {\n+    pub ANONYMOUS_PARAMETERS,\n+    Allow,\n+    \"detects anonymous parameters\"\n+}\n+\n+/// Checks for use of anonymous parameters (RFC 1685)\n+#[derive(Clone)]\n+pub struct AnonymousParameters;\n+\n+impl LintPass for AnonymousParameters {\n+    fn get_lints(&self) -> LintArray {\n+        lint_array!(ANONYMOUS_PARAMETERS)\n+    }\n+}\n+\n+impl EarlyLintPass for AnonymousParameters {\n+    fn check_trait_item(&mut self, cx: &EarlyContext, it: &ast::TraitItem) {\n+        match it.node {\n+            ast::TraitItemKind::Method(ref sig, _) => {\n+                for arg in sig.decl.inputs.iter() {\n+                    match arg.pat.node {\n+                        ast::PatKind::Ident(_, ident, None) => {\n+                            if ident.node.name == keywords::Invalid.name() {\n+                                cx.span_lint(ANONYMOUS_PARAMETERS,\n+                                             arg.pat.span,\n+                                             \"use of deprecated anonymous parameter\");\n+                            }\n+                        }\n+                        _ => (),\n+                    }\n+                }\n+            },\n+            _ => (),\n+        }\n+    }\n+}\n+\n declare_lint! {\n     DEPRECATED_ATTR,\n     Warn,"}, {"sha": "c1c14cb1fd29e3d8f3e6d6500a193d0f65fa4367", "filename": "src/librustc_lint/lib.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/6cc765dcad14e305f892398d16e270b480eb435b/src%2Flibrustc_lint%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6cc765dcad14e305f892398d16e270b480eb435b/src%2Flibrustc_lint%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Flib.rs?ref=6cc765dcad14e305f892398d16e270b480eb435b", "patch": "@@ -112,6 +112,7 @@ pub fn register_builtins(store: &mut lint::LintStore, sess: Option<&Session>) {\n     add_early_builtin!(sess,\n                        UnusedParens,\n                        UnusedImportBraces,\n+                       AnonymousParameters,\n                        );\n \n     add_early_builtin_with_new!(sess,\n@@ -244,6 +245,10 @@ pub fn register_builtins(store: &mut lint::LintStore, sess: Option<&Session>) {\n             id: LintId::of(MISSING_FRAGMENT_SPECIFIER),\n             reference: \"issue #40107 <https://github.com/rust-lang/rust/issues/40107>\",\n         },\n+        FutureIncompatibleInfo {\n+            id: LintId::of(ANONYMOUS_PARAMETERS),\n+            reference: \"issue #41686 <https://github.com/rust-lang/rust/issues/41686>\",\n+        },\n         ]);\n \n     // Register renamed and removed lints"}, {"sha": "76edae17dc104cd3b0336f47b2ae32f1a07dc3ea", "filename": "src/test/compile-fail/anon-params-deprecated.rs", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/6cc765dcad14e305f892398d16e270b480eb435b/src%2Ftest%2Fcompile-fail%2Fanon-params-deprecated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6cc765dcad14e305f892398d16e270b480eb435b/src%2Ftest%2Fcompile-fail%2Fanon-params-deprecated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fanon-params-deprecated.rs?ref=6cc765dcad14e305f892398d16e270b480eb435b", "patch": "@@ -0,0 +1,25 @@\n+// Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+#![forbid(anonymous_parameters)]\n+// Test for the anonymous_parameters deprecation lint (RFC 1685)\n+\n+trait T {\n+    fn foo(i32); //~ ERROR use of deprecated anonymous parameter\n+                 //~| WARNING hard error\n+\n+    fn bar_with_default_impl(String, String) {}\n+    //~^ ERROR use of deprecated anonymous parameter\n+    //~| WARNING hard error\n+    //~| ERROR use of deprecated anonymous parameter\n+    //~| WARNING hard error\n+}\n+\n+fn main() {}"}]}