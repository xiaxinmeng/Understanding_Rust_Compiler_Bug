{"sha": "8590b16d9b031014ddcda17b174645bb7ea8ebc4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg1OTBiMTZkOWIwMzEwMTRkZGNkYTE3YjE3NDY0NWJiN2VhOGViYzQ=", "commit": {"author": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2019-11-03T12:56:11Z"}, "committer": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2019-11-07T18:04:42Z"}, "message": "rustc_metadata: Move decoder/encoder/table into mod schema", "tree": {"sha": "36defde0a03294aee91a10b0d3f0facd3d3c2cc8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/36defde0a03294aee91a10b0d3f0facd3d3c2cc8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8590b16d9b031014ddcda17b174645bb7ea8ebc4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8590b16d9b031014ddcda17b174645bb7ea8ebc4", "html_url": "https://github.com/rust-lang/rust/commit/8590b16d9b031014ddcda17b174645bb7ea8ebc4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8590b16d9b031014ddcda17b174645bb7ea8ebc4/comments", "author": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "50f8aadd746ebc929a752e5ffb133936ee75c52f", "url": "https://api.github.com/repos/rust-lang/rust/commits/50f8aadd746ebc929a752e5ffb133936ee75c52f", "html_url": "https://github.com/rust-lang/rust/commit/50f8aadd746ebc929a752e5ffb133936ee75c52f"}], "stats": {"total": 23, "additions": 12, "deletions": 11}, "files": [{"sha": "2d3a6f4fa9f22a9bc20564e24071c9231678fe71", "filename": "src/librustc_metadata/cstore_impl.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/8590b16d9b031014ddcda17b174645bb7ea8ebc4/src%2Flibrustc_metadata%2Fcstore_impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8590b16d9b031014ddcda17b174645bb7ea8ebc4/src%2Flibrustc_metadata%2Fcstore_impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Fcstore_impl.rs?ref=8590b16d9b031014ddcda17b174645bb7ea8ebc4", "patch": "@@ -1,5 +1,4 @@\n use crate::cstore::{self, LoadedMacro};\n-use crate::encoder;\n use crate::link_args;\n use crate::native_libs;\n use crate::foreign_modules;\n@@ -524,7 +523,7 @@ impl CrateStore for cstore::CStore {\n     }\n \n     fn encode_metadata(&self, tcx: TyCtxt<'_>) -> EncodedMetadata {\n-        encoder::encode_metadata(tcx)\n+        schema::encode_metadata(tcx)\n     }\n \n     fn metadata_encoding_version(&self) -> &[u8]"}, {"sha": "be7925f9f529ef1ffa319ccaa481d05e7b6aec3a", "filename": "src/librustc_metadata/lib.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/8590b16d9b031014ddcda17b174645bb7ea8ebc4/src%2Flibrustc_metadata%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8590b16d9b031014ddcda17b174645bb7ea8ebc4/src%2Flibrustc_metadata%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Flib.rs?ref=8590b16d9b031014ddcda17b174645bb7ea8ebc4", "patch": "@@ -26,15 +26,12 @@ extern crate rustc_data_structures;\n \n pub mod error_codes;\n \n-mod encoder;\n-mod decoder;\n mod dependency_format;\n mod cstore_impl;\n mod foreign_modules;\n mod link_args;\n mod native_libs;\n mod schema;\n-mod table;\n \n pub mod creader;\n pub mod cstore;"}, {"sha": "89570fda68bcb1669f180c56fdb6ae952e4dbdeb", "filename": "src/librustc_metadata/schema.rs", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/8590b16d9b031014ddcda17b174645bb7ea8ebc4/src%2Flibrustc_metadata%2Fschema.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8590b16d9b031014ddcda17b174645bb7ea8ebc4/src%2Flibrustc_metadata%2Fschema.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Fschema.rs?ref=8590b16d9b031014ddcda17b174645bb7ea8ebc4", "patch": "@@ -1,4 +1,4 @@\n-use crate::table::PerDefTable;\n+use table::PerDefTable;\n \n use rustc::hir;\n use rustc::hir::def::{self, CtorKind};\n@@ -13,7 +13,6 @@ use rustc::ty::{self, Ty, ReprOptions};\n use rustc_target::spec::{PanicStrategy, TargetTriple};\n use rustc_index::vec::IndexVec;\n use rustc_data_structures::svh::Svh;\n-\n use rustc_serialize::Encodable;\n use syntax::{ast, attr};\n use syntax::edition::Edition;\n@@ -23,6 +22,13 @@ use syntax_pos::{self, Span};\n use std::marker::PhantomData;\n use std::num::NonZeroUsize;\n \n+crate use decoder::Metadata;\n+crate use encoder::encode_metadata;\n+\n+mod decoder;\n+mod encoder;\n+mod table;\n+\n crate fn rustc_version() -> String {\n     format!(\"rustc {}\",\n             option_env!(\"CFG_VERSION\").unwrap_or(\"unknown version\"))"}, {"sha": "33a75e909c7053679913454cf893d423b4e7c0b9", "filename": "src/librustc_metadata/schema/decoder.rs", "status": "renamed", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/8590b16d9b031014ddcda17b174645bb7ea8ebc4/src%2Flibrustc_metadata%2Fschema%2Fdecoder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8590b16d9b031014ddcda17b174645bb7ea8ebc4/src%2Flibrustc_metadata%2Fschema%2Fdecoder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Fschema%2Fdecoder.rs?ref=8590b16d9b031014ddcda17b174645bb7ea8ebc4", "patch": "@@ -2,7 +2,7 @@\n \n use crate::cstore::{self, CrateMetadata, MetadataBlob};\n use crate::schema::*;\n-use crate::table::{FixedSizeEncoding, PerDefTable};\n+use crate::schema::table::{FixedSizeEncoding, PerDefTable};\n \n use rustc_index::vec::IndexVec;\n use rustc_data_structures::sync::Lrc;\n@@ -1358,7 +1358,7 @@ impl<'a, 'tcx> CrateMetadata {\n \n     /// Get the `DepNodeIndex` corresponding this crate. The result of this\n     /// method is cached in the `dep_node_index` field.\n-    pub(super) fn get_crate_dep_node_index(&self, tcx: TyCtxt<'tcx>) -> DepNodeIndex {\n+    crate fn get_crate_dep_node_index(&self, tcx: TyCtxt<'tcx>) -> DepNodeIndex {\n         let mut dep_node_index = self.dep_node_index.load();\n \n         if unlikely!(dep_node_index == DepNodeIndex::INVALID) {", "previous_filename": "src/librustc_metadata/decoder.rs"}, {"sha": "2119ab9c2823e5e2401e7c9df8da8d5ad9e9d057", "filename": "src/librustc_metadata/schema/encoder.rs", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8590b16d9b031014ddcda17b174645bb7ea8ebc4/src%2Flibrustc_metadata%2Fschema%2Fencoder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8590b16d9b031014ddcda17b174645bb7ea8ebc4/src%2Flibrustc_metadata%2Fschema%2Fencoder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Fschema%2Fencoder.rs?ref=8590b16d9b031014ddcda17b174645bb7ea8ebc4", "patch": "@@ -1,5 +1,5 @@\n use crate::schema::*;\n-use crate::table::{FixedSizeEncoding, PerDefTable};\n+use crate::schema::table::{FixedSizeEncoding, PerDefTable};\n \n use rustc::middle::cstore::{LinkagePreference, NativeLibrary,\n                             EncodedMetadata, ForeignModule};", "previous_filename": "src/librustc_metadata/encoder.rs"}, {"sha": "3c2680c968c85c7b22645d96e703922abfc0b902", "filename": "src/librustc_metadata/schema/table.rs", "status": "renamed", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/8590b16d9b031014ddcda17b174645bb7ea8ebc4/src%2Flibrustc_metadata%2Fschema%2Ftable.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8590b16d9b031014ddcda17b174645bb7ea8ebc4/src%2Flibrustc_metadata%2Fschema%2Ftable.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Fschema%2Ftable.rs?ref=8590b16d9b031014ddcda17b174645bb7ea8ebc4", "patch": "@@ -1,4 +1,3 @@\n-use crate::decoder::Metadata;\n use crate::schema::*;\n \n use rustc::hir::def_id::{DefId, DefIndex};", "previous_filename": "src/librustc_metadata/table.rs"}]}