{"sha": "f3a79cf66722a917a59376b0ad60a0a370c48b8b", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYzYTc5Y2Y2NjcyMmE5MTdhNTkzNzZiMGFkNjBhMGEzNzBjNDhiOGI=", "commit": {"author": {"name": "Steven Fackler", "email": "sfackler@gmail.com", "date": "2013-08-10T18:09:30Z"}, "committer": {"name": "Steven Fackler", "email": "sfackler@gmail.com", "date": "2013-08-11T23:15:25Z"}, "message": "Fixed option_env! type\n\nThe type of the result of option_env! was not fully specified in the\nNone case, leading to type check failures in the case where the variable\nwas not defined (e.g. option_env!(\"FOO\").is_none()).", "tree": {"sha": "a6d95726defa54c2f3d6913f0740265feb69f035", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a6d95726defa54c2f3d6913f0740265feb69f035"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f3a79cf66722a917a59376b0ad60a0a370c48b8b", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f3a79cf66722a917a59376b0ad60a0a370c48b8b", "html_url": "https://github.com/rust-lang/rust/commit/f3a79cf66722a917a59376b0ad60a0a370c48b8b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f3a79cf66722a917a59376b0ad60a0a370c48b8b/comments", "author": {"login": "sfackler", "id": 1455697, "node_id": "MDQ6VXNlcjE0NTU2OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sfackler", "html_url": "https://github.com/sfackler", "followers_url": "https://api.github.com/users/sfackler/followers", "following_url": "https://api.github.com/users/sfackler/following{/other_user}", "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}", "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions", "organizations_url": "https://api.github.com/users/sfackler/orgs", "repos_url": "https://api.github.com/users/sfackler/repos", "events_url": "https://api.github.com/users/sfackler/events{/privacy}", "received_events_url": "https://api.github.com/users/sfackler/received_events", "type": "User", "site_admin": false}, "committer": {"login": "sfackler", "id": 1455697, "node_id": "MDQ6VXNlcjE0NTU2OTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1455697?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sfackler", "html_url": "https://github.com/sfackler", "followers_url": "https://api.github.com/users/sfackler/followers", "following_url": "https://api.github.com/users/sfackler/following{/other_user}", "gists_url": "https://api.github.com/users/sfackler/gists{/gist_id}", "starred_url": "https://api.github.com/users/sfackler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sfackler/subscriptions", "organizations_url": "https://api.github.com/users/sfackler/orgs", "repos_url": "https://api.github.com/users/sfackler/repos", "events_url": "https://api.github.com/users/sfackler/events{/privacy}", "received_events_url": "https://api.github.com/users/sfackler/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "63c62bea3ac2782ae421d5bd211f2e7393bad7a2", "url": "https://api.github.com/repos/rust-lang/rust/commits/63c62bea3ac2782ae421d5bd211f2e7393bad7a2", "html_url": "https://github.com/rust-lang/rust/commit/63c62bea3ac2782ae421d5bd211f2e7393bad7a2"}], "stats": {"total": 5, "additions": 2, "deletions": 3}, "files": [{"sha": "cb2d4f8ba2432b5ae0ec588087ebd84fcbd1af2f", "filename": "src/libsyntax/ext/env.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f3a79cf66722a917a59376b0ad60a0a370c48b8b/src%2Flibsyntax%2Fext%2Fenv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f3a79cf66722a917a59376b0ad60a0a370c48b8b/src%2Flibsyntax%2Fext%2Fenv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fext%2Fenv.rs?ref=f3a79cf66722a917a59376b0ad60a0a370c48b8b", "patch": "@@ -27,7 +27,7 @@ pub fn expand_option_env(ext_cx: @ExtCtxt, sp: span, tts: &[ast::token_tree])\n     let var = get_single_str_from_tts(ext_cx, sp, tts, \"option_env!\");\n \n     let e = match os::getenv(var) {\n-      None => quote_expr!(::std::option::None),\n+      None => quote_expr!(::std::option::None::<&'static str>),\n       Some(s) => quote_expr!(::std::option::Some($s))\n     };\n     MRExpr(e)"}, {"sha": "cbf4c36c5df3c9bddf0e082d9445bec8dd1d8064", "filename": "src/test/run-pass/extoption_env-not-defined.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/f3a79cf66722a917a59376b0ad60a0a370c48b8b/src%2Ftest%2Frun-pass%2Fextoption_env-not-defined.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f3a79cf66722a917a59376b0ad60a0a370c48b8b/src%2Ftest%2Frun-pass%2Fextoption_env-not-defined.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fextoption_env-not-defined.rs?ref=f3a79cf66722a917a59376b0ad60a0a370c48b8b", "patch": "@@ -9,6 +9,5 @@\n // except according to those terms.\n \n fn main() {\n-    let opt: Option<&'static str> = option_env!(\"__HOPEFULLY_DOESNT_EXIST__\");\n-    assert!(opt.is_none());\n+    assert!(option_env!(\"__HOPEFULLY_DOESNT_EXIST__\").is_none());\n }"}]}