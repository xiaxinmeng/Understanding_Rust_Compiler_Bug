{"sha": "42e5d451b7c3aacf6e6a589f4e67e23eda4cd3ad", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQyZTVkNDUxYjdjM2FhY2Y2ZTZhNTg5ZjRlNjdlMjNlZGE0Y2QzYWQ=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-01-19T07:54:56Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-01-19T08:04:59Z"}, "message": "rustdoc: Change the header scheme so that all mods are h2, fns h3", "tree": {"sha": "f83222d1b3480a754d2882df304cd2db6deb123b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f83222d1b3480a754d2882df304cd2db6deb123b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/42e5d451b7c3aacf6e6a589f4e67e23eda4cd3ad", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/42e5d451b7c3aacf6e6a589f4e67e23eda4cd3ad", "html_url": "https://github.com/rust-lang/rust/commit/42e5d451b7c3aacf6e6a589f4e67e23eda4cd3ad", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/42e5d451b7c3aacf6e6a589f4e67e23eda4cd3ad/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a5e0f037be17204c640e2941e576a9dca09efc90", "url": "https://api.github.com/repos/rust-lang/rust/commits/a5e0f037be17204c640e2941e576a9dca09efc90", "html_url": "https://github.com/rust-lang/rust/commit/a5e0f037be17204c640e2941e576a9dca09efc90"}], "stats": {"total": 36, "additions": 15, "deletions": 21}, "files": [{"sha": "6c42c476b2f517cc061bad942bf8bd80bf11fbd6", "filename": "src/rustdoc/gen.rs", "status": "modified", "additions": 15, "deletions": 21, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/42e5d451b7c3aacf6e6a589f4e67e23eda4cd3ad/src%2Frustdoc%2Fgen.rs", "raw_url": "https://github.com/rust-lang/rust/raw/42e5d451b7c3aacf6e6a589f4e67e23eda4cd3ad/src%2Frustdoc%2Fgen.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Fgen.rs?ref=42e5d451b7c3aacf6e6a589f4e67e23eda4cd3ad", "patch": "@@ -18,39 +18,37 @@ fn mk_pass(\n }\n \n type ctxt = {\n-    w: io::writer,\n-    mutable depth: uint\n+    w: io::writer\n };\n \n fn write_markdown(\n     doc: doc::cratedoc,\n     writer: io::writer\n ) {\n     let ctxt = {\n-        w: writer,\n-        mutable depth: 1u\n+        w: writer\n     };\n \n     write_crate(ctxt, doc);\n }\n \n-fn write_header(ctxt: ctxt, title: str) {\n-    let hashes = str::from_chars(vec::init_elt('#', ctxt.depth));\n-    ctxt.w.write_line(#fmt(\"%s %s\", hashes, title));\n-    ctxt.w.write_line(\"\");\n+tag hlvl {\n+    h1 = 1;\n+    h2 = 2;\n+    h3 = 3;\n }\n \n-fn subsection(ctxt: ctxt, f: fn&()) {\n-    ctxt.depth += 1u;\n-    f();\n-    ctxt.depth -= 1u;\n+fn write_header(ctxt: ctxt, lvl: hlvl, title: str) {\n+    let hashes = str::from_chars(vec::init_elt('#', lvl as uint));\n+    ctxt.w.write_line(#fmt(\"%s %s\", hashes, title));\n+    ctxt.w.write_line(\"\");\n }\n \n fn write_crate(\n     ctxt: ctxt,\n     doc: doc::cratedoc\n ) {\n-    write_header(ctxt, #fmt(\"Crate %s\", doc.topmod.name));\n+    write_header(ctxt, h1, #fmt(\"Crate %s\", doc.topmod.name));\n     write_top_module(ctxt, doc.topmod);\n }\n \n@@ -65,7 +63,7 @@ fn write_mod(\n     ctxt: ctxt,\n     moddoc: doc::moddoc\n ) {\n-    write_header(ctxt, #fmt(\"Module `%s`\", moddoc.name));\n+    write_header(ctxt, h2, #fmt(\"Module `%s`\", moddoc.name));\n     write_mod_contents(ctxt, moddoc);\n }\n \n@@ -77,15 +75,11 @@ fn write_mod_contents(\n     write_desc(ctxt, doc.desc);\n \n     for fndoc in *doc.fns {\n-        subsection(ctxt) {||\n-            write_fn(ctxt, fndoc);\n-        }\n+        write_fn(ctxt, fndoc);\n     }\n \n     for moddoc in *doc.mods {\n-        subsection(ctxt) {||\n-            write_mod(ctxt, moddoc);\n-        }\n+        write_mod(ctxt, moddoc);\n     }\n }\n \n@@ -105,7 +99,7 @@ fn write_fn(\n     ctxt: ctxt,\n     doc: doc::fndoc\n ) {\n-    write_header(ctxt, #fmt(\"Function `%s`\", doc.name));\n+    write_header(ctxt, h3, #fmt(\"Function `%s`\", doc.name));\n     write_brief(ctxt, doc.brief);\n     write_desc(ctxt, doc.desc);\n     write_args(ctxt, doc.args);"}]}