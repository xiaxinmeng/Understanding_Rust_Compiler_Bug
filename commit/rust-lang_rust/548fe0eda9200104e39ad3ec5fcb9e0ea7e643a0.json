{"sha": "548fe0eda9200104e39ad3ec5fcb9e0ea7e643a0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU0OGZlMGVkYTkyMDAxMDRlMzlhZDNlYzVmY2I5ZTBlYTdlNjQzYTA=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-12-13T18:54:48Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-12-13T18:54:48Z"}, "message": "Register new snapshots and teach snapshot script to deal with extracting new-style versioned snapshots.", "tree": {"sha": "8f82d68855110e3e8da49517250830b0a9098e3d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8f82d68855110e3e8da49517250830b0a9098e3d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/548fe0eda9200104e39ad3ec5fcb9e0ea7e643a0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/548fe0eda9200104e39ad3ec5fcb9e0ea7e643a0", "html_url": "https://github.com/rust-lang/rust/commit/548fe0eda9200104e39ad3ec5fcb9e0ea7e643a0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/548fe0eda9200104e39ad3ec5fcb9e0ea7e643a0/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1c1bc2f1cde93a27dbee690280ee81fde8b2ceeb", "url": "https://api.github.com/repos/rust-lang/rust/commits/1c1bc2f1cde93a27dbee690280ee81fde8b2ceeb", "html_url": "https://github.com/rust-lang/rust/commit/1c1bc2f1cde93a27dbee690280ee81fde8b2ceeb"}], "stats": {"total": 31, "additions": 10, "deletions": 21}, "files": [{"sha": "1b314a049d9732147753c6e63ea992f484087b48", "filename": "src/etc/get-snapshot.py", "status": "modified", "additions": 3, "deletions": 21, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/548fe0eda9200104e39ad3ec5fcb9e0ea7e643a0/src%2Fetc%2Fget-snapshot.py", "raw_url": "https://github.com/rust-lang/rust/raw/548fe0eda9200104e39ad3ec5fcb9e0ea7e643a0/src%2Fetc%2Fget-snapshot.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fget-snapshot.py?ref=548fe0eda9200104e39ad3ec5fcb9e0ea7e643a0", "patch": "@@ -3,34 +3,16 @@\n import os, tarfile, hashlib, re, shutil, sys\n from snapshot import *\n \n-old_snapshot_files = {\n-    \"linux\": [\"bin/rustc\",\n-              \"lib/libcore.so\",\n-              \"lib/libruststd.so\",\n-              \"lib/librustrt.so\",\n-              \"lib/librustllvm.so\"],\n-    \"macos\": [\"bin/rustc\",\n-              \"lib/libcore.dylib\",\n-              \"lib/libruststd.dylib\",\n-              \"lib/librustrt.dylib\",\n-              \"lib/librustllvm.dylib\"],\n-    \"winnt\": [\"bin/rustc.exe\",\n-              \"lib/core.dll\",\n-              \"lib/ruststd.dll\",\n-              \"lib/rustrt.dll\",\n-              \"lib/rustllvm.dll\"]\n-    }\n-\n def unpack_snapshot(triple, snap):\n   dl_path = os.path.join(download_dir_base, snap)\n   print(\"opening snapshot \" + dl_path)\n   tar = tarfile.open(dl_path)\n   kernel = get_kernel(triple)\n-  for name in old_snapshot_files[kernel]:\n-    p = \"rust-stage0/\" + name\n+  for p in tar.getnames():\n+    name = p.replace(\"rust-stage0/\", \"\", 1);\n     stagep = os.path.join(triple, \"stage0\")\n     fp = os.path.join(stagep, name)\n-    print(\"extracting \" + fp)\n+    print(\"extracting \" + p)\n     tar.extract(p, download_unpack_base)\n     tp = os.path.join(download_unpack_base, p)\n     shutil.move(tp, fp)"}, {"sha": "45666ad8a7707a900678bfc1cb6669bebbed9718", "filename": "src/snapshots.txt", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/548fe0eda9200104e39ad3ec5fcb9e0ea7e643a0/src%2Fsnapshots.txt", "raw_url": "https://github.com/rust-lang/rust/raw/548fe0eda9200104e39ad3ec5fcb9e0ea7e643a0/src%2Fsnapshots.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fsnapshots.txt?ref=548fe0eda9200104e39ad3ec5fcb9e0ea7e643a0", "patch": "@@ -1,3 +1,10 @@\n+S 2011-12-12 1c1bc2f\n+  winnt-i386 550dc539e8ab6837c52b3a35e6119061490190b1\n+  linux-i386 66c5e97e3072d8c88a52d986d1fadbd43de615a5\n+  macos-i386 c3db65606d7bbea2ae0482b20e177f7463dc58ef\n+  linux-x86_64 c5bbd08e423844ee938c8f6824ba2b3b4dc851b0\n+  macos-x86_64 29accda0ace162169408357371482ddd044b6dd3\n+\n S 2011-12-07 3ccdd2a\n   linux-i386 7c639851d8a4ae43f781ad4592b6d3b6e0f4837b\n   macos-i386 8fdf95481943aff1953d93eed31528c221d33373"}]}