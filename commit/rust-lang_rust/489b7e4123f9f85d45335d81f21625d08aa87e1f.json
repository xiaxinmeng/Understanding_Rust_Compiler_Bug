{"sha": "489b7e4123f9f85d45335d81f21625d08aa87e1f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ4OWI3ZTQxMjNmOWY4NWQ0NTMzNWQ4MWYyMTYyNWQwOGFhODdlMWY=", "commit": {"author": {"name": "Igor Matuszewski", "email": "xanewok@gmail.com", "date": "2020-05-28T08:44:01Z"}, "committer": {"name": "flip1995", "email": "hello@philkrones.com", "date": "2020-05-28T13:46:59Z"}, "message": "Set CFG_RELEASE for tools in bootstrap/tool.rs\n\nSince rustc-ap-* v659 we now need to set CFG_RELEASE for\nrustc-ap-rustc_attr for `#[cfg(version(...))]` to work.\n\nCo-authored-by: Eric Huss <ehuss@users.noreply.github.com>", "tree": {"sha": "d66c232c74e659075b48d7835b253219b29a95c3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d66c232c74e659075b48d7835b253219b29a95c3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/489b7e4123f9f85d45335d81f21625d08aa87e1f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEqv54U47RUUXZfOLnLO/Nsn7QvnkFAl7PwNMACgkQLO/Nsn7Q\nvnnX8A/+IIx0OVwz6STBdoLhGOtcRyOZQMhAkao8DlP/I8kR4psVe9l8o+e6i1Bh\nRmt27LiNdY48RZqb3wD0SlviXrzQkttgD+GTxVUbY6VuOYsGYuo1HrLFVSE/3jXK\nn/Sm/PikMpwkfWD5Cd2TUwcK1y+LN7Os2A1WwO6cqNhHY3CZrYpZeCID9dIL9Pw4\nqb6sFcaRjtzsY6DG1U8ggXkLk07pwb2aiDcl44at02+tCzE7DsyW8+ZqyO4Mmb22\nV65qXkKIjdPU+uMKxkbmXwQVidzy9kOA4qFtfnzzjHLk2vXzX6C32viZ4IGJmABb\nQd4G+gQ5DzzR3J58n7cd8oc2HU7ZBWRxYTjc5n4ovgx5DHus8K6PaQpPnm/QJsFo\nGJ7E8X51uXio5gcwYg+EYl9HQl97uC+gXVJnS/DQ+Z790ln1RNG9Et8bKmGcXOdB\noIQ8yAMFFoTxJ408cppJ1D0NAOvMBC6FwtUFDRK2twtMK/8kk0QNMgMN+ekNPTwz\n0TksnMW/oc+LAantfYWSRTsOUIkpvjkFv/SLpfQS4EA3pFb52ZBY81tv9iB0xkyM\njjeZaAPfjZaMY1MwvXF3zoSmN+lyGxt2dW3+zujScNSo96O1bQtCjDSn9PxnxgTE\n9mATa9oezszV+ovIuwKrEelyZ7xgaWqa9Bqf/SWGnVI4AyNlU88=\n=7Jvz\n-----END PGP SIGNATURE-----", "payload": "tree d66c232c74e659075b48d7835b253219b29a95c3\nparent 84eae777c1ea16bd0b1b8e86f344714edd31b35e\nauthor Igor Matuszewski <xanewok@gmail.com> 1590655441 +0200\ncommitter flip1995 <hello@philkrones.com> 1590673619 +0200\n\nSet CFG_RELEASE for tools in bootstrap/tool.rs\n\nSince rustc-ap-* v659 we now need to set CFG_RELEASE for\nrustc-ap-rustc_attr for `#[cfg(version(...))]` to work.\n\nCo-authored-by: Eric Huss <ehuss@users.noreply.github.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/489b7e4123f9f85d45335d81f21625d08aa87e1f", "html_url": "https://github.com/rust-lang/rust/commit/489b7e4123f9f85d45335d81f21625d08aa87e1f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/489b7e4123f9f85d45335d81f21625d08aa87e1f/comments", "author": {"login": "Xanewok", "id": 3093213, "node_id": "MDQ6VXNlcjMwOTMyMTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3093213?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Xanewok", "html_url": "https://github.com/Xanewok", "followers_url": "https://api.github.com/users/Xanewok/followers", "following_url": "https://api.github.com/users/Xanewok/following{/other_user}", "gists_url": "https://api.github.com/users/Xanewok/gists{/gist_id}", "starred_url": "https://api.github.com/users/Xanewok/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Xanewok/subscriptions", "organizations_url": "https://api.github.com/users/Xanewok/orgs", "repos_url": "https://api.github.com/users/Xanewok/repos", "events_url": "https://api.github.com/users/Xanewok/events{/privacy}", "received_events_url": "https://api.github.com/users/Xanewok/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "84eae777c1ea16bd0b1b8e86f344714edd31b35e", "url": "https://api.github.com/repos/rust-lang/rust/commits/84eae777c1ea16bd0b1b8e86f344714edd31b35e", "html_url": "https://github.com/rust-lang/rust/commit/84eae777c1ea16bd0b1b8e86f344714edd31b35e"}], "stats": {"total": 4, "additions": 4, "deletions": 0}, "files": [{"sha": "5f58f00a2a24d6dbce81af00b51e8a6b1177f1f1", "filename": "src/bootstrap/tool.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/489b7e4123f9f85d45335d81f21625d08aa87e1f/src%2Fbootstrap%2Ftool.rs", "raw_url": "https://github.com/rust-lang/rust/raw/489b7e4123f9f85d45335d81f21625d08aa87e1f/src%2Fbootstrap%2Ftool.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftool.rs?ref=489b7e4123f9f85d45335d81f21625d08aa87e1f", "patch": "@@ -252,6 +252,10 @@ pub fn prepare_tool_cargo(\n     // own copy\n     cargo.env(\"LZMA_API_STATIC\", \"1\");\n \n+    // CFG_RELEASE is needed by rustfmt (and possibly other tools) which\n+    // import rustc-ap-rustc_attr which requires this to be set for the\n+    // `#[cfg(version(...))]` attribute.\n+    cargo.env(\"CFG_RELEASE\", builder.rust_release());\n     cargo.env(\"CFG_RELEASE_CHANNEL\", &builder.config.channel);\n     cargo.env(\"CFG_VERSION\", builder.rust_version());\n     cargo.env(\"CFG_RELEASE_NUM\", channel::CFG_RELEASE_NUM);"}]}