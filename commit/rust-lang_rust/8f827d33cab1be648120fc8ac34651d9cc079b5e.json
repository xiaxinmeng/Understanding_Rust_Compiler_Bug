{"sha": "8f827d33cab1be648120fc8ac34651d9cc079b5e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhmODI3ZDMzY2FiMWJlNjQ4MTIwZmM4YWMzNDY1MWQ5Y2MwNzliNWU=", "commit": {"author": {"name": "Johannes Hoff", "email": "johshoff@gmail.com", "date": "2014-11-27T19:15:49Z"}, "committer": {"name": "Johannes Hoff", "email": "johshoff@gmail.com", "date": "2014-11-27T19:15:49Z"}, "message": "Fall back to hard coded download directory\n\nIf mktemp fails, fall back to a hard coded directory, per @nodakai's feedback.", "tree": {"sha": "4a14191debb07fc7523ab352b1fd03fd7868bbf2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4a14191debb07fc7523ab352b1fd03fd7868bbf2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8f827d33cab1be648120fc8ac34651d9cc079b5e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8f827d33cab1be648120fc8ac34651d9cc079b5e", "html_url": "https://github.com/rust-lang/rust/commit/8f827d33cab1be648120fc8ac34651d9cc079b5e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8f827d33cab1be648120fc8ac34651d9cc079b5e/comments", "author": {"login": "johshoff", "id": 353935, "node_id": "MDQ6VXNlcjM1MzkzNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/353935?v=4", "gravatar_id": "", "url": "https://api.github.com/users/johshoff", "html_url": "https://github.com/johshoff", "followers_url": "https://api.github.com/users/johshoff/followers", "following_url": "https://api.github.com/users/johshoff/following{/other_user}", "gists_url": "https://api.github.com/users/johshoff/gists{/gist_id}", "starred_url": "https://api.github.com/users/johshoff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/johshoff/subscriptions", "organizations_url": "https://api.github.com/users/johshoff/orgs", "repos_url": "https://api.github.com/users/johshoff/repos", "events_url": "https://api.github.com/users/johshoff/events{/privacy}", "received_events_url": "https://api.github.com/users/johshoff/received_events", "type": "User", "site_admin": false}, "committer": {"login": "johshoff", "id": 353935, "node_id": "MDQ6VXNlcjM1MzkzNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/353935?v=4", "gravatar_id": "", "url": "https://api.github.com/users/johshoff", "html_url": "https://github.com/johshoff", "followers_url": "https://api.github.com/users/johshoff/followers", "following_url": "https://api.github.com/users/johshoff/following{/other_user}", "gists_url": "https://api.github.com/users/johshoff/gists{/gist_id}", "starred_url": "https://api.github.com/users/johshoff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/johshoff/subscriptions", "organizations_url": "https://api.github.com/users/johshoff/orgs", "repos_url": "https://api.github.com/users/johshoff/repos", "events_url": "https://api.github.com/users/johshoff/events{/privacy}", "received_events_url": "https://api.github.com/users/johshoff/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cb501535b38ac40fc3d93aaee13d76eecd4fa6c9", "url": "https://api.github.com/repos/rust-lang/rust/commits/cb501535b38ac40fc3d93aaee13d76eecd4fa6c9", "html_url": "https://github.com/rust-lang/rust/commit/cb501535b38ac40fc3d93aaee13d76eecd4fa6c9"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "234699f49eb623b98ce9a829221a1700a81cc19e", "filename": "src/etc/rustup.sh", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/8f827d33cab1be648120fc8ac34651d9cc079b5e/src%2Fetc%2Frustup.sh", "raw_url": "https://github.com/rust-lang/rust/raw/8f827d33cab1be648120fc8ac34651d9cc079b5e/src%2Fetc%2Frustup.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Frustup.sh?ref=8f827d33cab1be648120fc8ac34651d9cc079b5e", "patch": "@@ -229,6 +229,18 @@ validate_opt () {\n     done\n }\n \n+create_tmp_dir() {\n+    local TMP_DIR=./rustup-tmp-install\n+\n+    rm -Rf \"${TMP_DIR}\"\n+    need_ok \"failed to remove temporary installation directory\"\n+\n+    mkdir -p \"${TMP_DIR}\"\n+    need_ok \"failed to create create temporary installation directory\"\n+\n+    echo $TMP_DIR\n+}\n+\n probe_need CFG_CURL  curl\n \n CFG_SRC_DIR=\"$(cd $(dirname $0) && pwd)/\"\n@@ -392,7 +404,7 @@ PACKAGE_NAME=rust-nightly\n PACKAGE_NAME_AND_TRIPLE=\"${PACKAGE_NAME}-${HOST_TRIPLE}\"\n TARBALL_NAME=\"${PACKAGE_NAME_AND_TRIPLE}.tar.gz\"\n REMOTE_TARBALL=\"https://static.rust-lang.org/dist/${TARBALL_NAME}\"\n-TMP_DIR=`mktemp -d 2>/dev/null || mktemp -d -t 'mytmpdir'`\n+TMP_DIR=`mktemp -d 2>/dev/null || mktemp -d -t 'mytmpdir' 2>/dev/null` || TMP_DIR=$(create_tmp_dir)\n LOCAL_TARBALL=\"${TMP_DIR}/${TARBALL_NAME}\"\n LOCAL_INSTALL_DIR=\"${TMP_DIR}/${PACKAGE_NAME_AND_TRIPLE}\"\n LOCAL_INSTALL_SCRIPT=\"${LOCAL_INSTALL_DIR}/install.sh\""}]}