{"sha": "b1567f4466388df8377512580d72513e1e4e0e48", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIxNTY3ZjQ0NjYzODhkZjgzNzc1MTI1ODBkNzI1MTNlMWU0ZTBlNDg=", "commit": {"author": {"name": "Takayuki", "email": "takoyaki0316@gmail.com", "date": "2021-05-04T21:18:58Z"}, "committer": {"name": "Takayuki", "email": "takoyaki0316@gmail.com", "date": "2021-05-04T21:18:58Z"}, "message": "move zero_prefixed_literal to its own module", "tree": {"sha": "c4482863920cb46ce0415c17b0c49dd2674603fb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c4482863920cb46ce0415c17b0c49dd2674603fb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b1567f4466388df8377512580d72513e1e4e0e48", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b1567f4466388df8377512580d72513e1e4e0e48", "html_url": "https://github.com/rust-lang/rust/commit/b1567f4466388df8377512580d72513e1e4e0e48", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b1567f4466388df8377512580d72513e1e4e0e48/comments", "author": {"login": "TaKO8Ki", "id": 41065217, "node_id": "MDQ6VXNlcjQxMDY1MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/41065217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TaKO8Ki", "html_url": "https://github.com/TaKO8Ki", "followers_url": "https://api.github.com/users/TaKO8Ki/followers", "following_url": "https://api.github.com/users/TaKO8Ki/following{/other_user}", "gists_url": "https://api.github.com/users/TaKO8Ki/gists{/gist_id}", "starred_url": "https://api.github.com/users/TaKO8Ki/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TaKO8Ki/subscriptions", "organizations_url": "https://api.github.com/users/TaKO8Ki/orgs", "repos_url": "https://api.github.com/users/TaKO8Ki/repos", "events_url": "https://api.github.com/users/TaKO8Ki/events{/privacy}", "received_events_url": "https://api.github.com/users/TaKO8Ki/received_events", "type": "User", "site_admin": false}, "committer": {"login": "TaKO8Ki", "id": 41065217, "node_id": "MDQ6VXNlcjQxMDY1MjE3", "avatar_url": "https://avatars.githubusercontent.com/u/41065217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TaKO8Ki", "html_url": "https://github.com/TaKO8Ki", "followers_url": "https://api.github.com/users/TaKO8Ki/followers", "following_url": "https://api.github.com/users/TaKO8Ki/following{/other_user}", "gists_url": "https://api.github.com/users/TaKO8Ki/gists{/gist_id}", "starred_url": "https://api.github.com/users/TaKO8Ki/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TaKO8Ki/subscriptions", "organizations_url": "https://api.github.com/users/TaKO8Ki/orgs", "repos_url": "https://api.github.com/users/TaKO8Ki/repos", "events_url": "https://api.github.com/users/TaKO8Ki/events{/privacy}", "received_events_url": "https://api.github.com/users/TaKO8Ki/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0773d8afdb792a3147de53ad590b620be9eef006", "url": "https://api.github.com/repos/rust-lang/rust/commits/0773d8afdb792a3147de53ad590b620be9eef006", "html_url": "https://github.com/rust-lang/rust/commit/0773d8afdb792a3147de53ad590b620be9eef006"}], "stats": {"total": 53, "additions": 32, "deletions": 21}, "files": [{"sha": "4b1d55beca8f595cd8f23651c1e0094db70b9f7c", "filename": "clippy_lints/src/misc_early/mod.rs", "status": "modified", "additions": 3, "deletions": 21, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/b1567f4466388df8377512580d72513e1e4e0e48/clippy_lints%2Fsrc%2Fmisc_early%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b1567f4466388df8377512580d72513e1e4e0e48/clippy_lints%2Fsrc%2Fmisc_early%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmisc_early%2Fmod.rs?ref=b1567f4466388df8377512580d72513e1e4e0e48", "patch": "@@ -5,8 +5,9 @@ mod redundant_pattern;\n mod unneeded_field_pattern;\n mod unneeded_wildcard_pattern;\n mod unseparated_literal_suffix;\n+mod zero_prefixed_literal;\n \n-use clippy_utils::diagnostics::{span_lint, span_lint_and_sugg, span_lint_and_then};\n+use clippy_utils::diagnostics::{span_lint, span_lint_and_sugg};\n use clippy_utils::source::snippet_opt;\n use rustc_ast::ast::{Expr, Generics, Lit, LitFloatType, LitIntType, LitKind, NodeId, Pat, PatKind};\n use rustc_ast::visit::FnKind;\n@@ -356,26 +357,7 @@ impl MiscEarlyLints {\n             } else if lit_snip.starts_with(\"0b\") || lit_snip.starts_with(\"0o\") {\n                 /* nothing to do */\n             } else if value != 0 && lit_snip.starts_with('0') {\n-                span_lint_and_then(\n-                    cx,\n-                    ZERO_PREFIXED_LITERAL,\n-                    lit.span,\n-                    \"this is a decimal constant\",\n-                    |diag| {\n-                        diag.span_suggestion(\n-                            lit.span,\n-                            \"if you mean to use a decimal constant, remove the `0` to avoid confusion\",\n-                            lit_snip.trim_start_matches(|c| c == '_' || c == '0').to_string(),\n-                            Applicability::MaybeIncorrect,\n-                        );\n-                        diag.span_suggestion(\n-                            lit.span,\n-                            \"if you mean to use an octal constant, use `0o`\",\n-                            format!(\"0o{}\", lit_snip.trim_start_matches(|c| c == '_' || c == '0')),\n-                            Applicability::MaybeIncorrect,\n-                        );\n-                    },\n-                );\n+                zero_prefixed_literal::check(cx, lit, lit_snip)\n             }\n         } else if let LitKind::Float(_, LitFloatType::Suffixed(float_ty)) = lit.kind {\n             unseparated_literal_suffix::check(cx, lit, float_ty, lit_snip)"}, {"sha": "16add0fa1b43b1089679bff9f48cad5de7abbffe", "filename": "clippy_lints/src/misc_early/zero_prefixed_literal.rs", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/b1567f4466388df8377512580d72513e1e4e0e48/clippy_lints%2Fsrc%2Fmisc_early%2Fzero_prefixed_literal.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b1567f4466388df8377512580d72513e1e4e0e48/clippy_lints%2Fsrc%2Fmisc_early%2Fzero_prefixed_literal.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmisc_early%2Fzero_prefixed_literal.rs?ref=b1567f4466388df8377512580d72513e1e4e0e48", "patch": "@@ -0,0 +1,29 @@\n+use clippy_utils::diagnostics::span_lint_and_then;\n+use rustc_ast::ast::Lit;\n+use rustc_errors::Applicability;\n+use rustc_lint::EarlyContext;\n+\n+use super::ZERO_PREFIXED_LITERAL;\n+\n+pub(super) fn check(cx: &EarlyContext<'_>, lit: &Lit, lit_snip: String) {\n+    span_lint_and_then(\n+        cx,\n+        ZERO_PREFIXED_LITERAL,\n+        lit.span,\n+        \"this is a decimal constant\",\n+        |diag| {\n+            diag.span_suggestion(\n+                lit.span,\n+                \"if you mean to use a decimal constant, remove the `0` to avoid confusion\",\n+                lit_snip.trim_start_matches(|c| c == '_' || c == '0').to_string(),\n+                Applicability::MaybeIncorrect,\n+            );\n+            diag.span_suggestion(\n+                lit.span,\n+                \"if you mean to use an octal constant, use `0o`\",\n+                format!(\"0o{}\", lit_snip.trim_start_matches(|c| c == '_' || c == '0')),\n+                Applicability::MaybeIncorrect,\n+            );\n+        },\n+    );\n+}"}]}