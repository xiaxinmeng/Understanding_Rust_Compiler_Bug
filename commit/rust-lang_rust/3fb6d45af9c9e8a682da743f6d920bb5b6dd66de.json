{"sha": "3fb6d45af9c9e8a682da743f6d920bb5b6dd66de", "node_id": "C_kwDOAAsO6NoAKDNmYjZkNDVhZjljOWU4YTY4MmRhNzQzZjZkOTIwYmI1YjZkZDY2ZGU", "commit": {"author": {"name": "Hood Chatham", "email": "roberthoodchatham@gmail.com", "date": "2022-06-15T19:33:27Z"}, "committer": {"name": "Hood Chatham", "email": "roberthoodchatham@gmail.com", "date": "2022-06-19T00:48:00Z"}, "message": "ENH Move --memory-init-file flag from EmLinker to asmjs target spec", "tree": {"sha": "907d559b27c7aa9ce4dd766251582daf67460403", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/907d559b27c7aa9ce4dd766251582daf67460403"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3fb6d45af9c9e8a682da743f6d920bb5b6dd66de", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3fb6d45af9c9e8a682da743f6d920bb5b6dd66de", "html_url": "https://github.com/rust-lang/rust/commit/3fb6d45af9c9e8a682da743f6d920bb5b6dd66de", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3fb6d45af9c9e8a682da743f6d920bb5b6dd66de/comments", "author": {"login": "hoodmane", "id": 8739626, "node_id": "MDQ6VXNlcjg3Mzk2MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/8739626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hoodmane", "html_url": "https://github.com/hoodmane", "followers_url": "https://api.github.com/users/hoodmane/followers", "following_url": "https://api.github.com/users/hoodmane/following{/other_user}", "gists_url": "https://api.github.com/users/hoodmane/gists{/gist_id}", "starred_url": "https://api.github.com/users/hoodmane/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hoodmane/subscriptions", "organizations_url": "https://api.github.com/users/hoodmane/orgs", "repos_url": "https://api.github.com/users/hoodmane/repos", "events_url": "https://api.github.com/users/hoodmane/events{/privacy}", "received_events_url": "https://api.github.com/users/hoodmane/received_events", "type": "User", "site_admin": false}, "committer": {"login": "hoodmane", "id": 8739626, "node_id": "MDQ6VXNlcjg3Mzk2MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/8739626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hoodmane", "html_url": "https://github.com/hoodmane", "followers_url": "https://api.github.com/users/hoodmane/followers", "following_url": "https://api.github.com/users/hoodmane/following{/other_user}", "gists_url": "https://api.github.com/users/hoodmane/gists{/gist_id}", "starred_url": "https://api.github.com/users/hoodmane/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hoodmane/subscriptions", "organizations_url": "https://api.github.com/users/hoodmane/orgs", "repos_url": "https://api.github.com/users/hoodmane/repos", "events_url": "https://api.github.com/users/hoodmane/events{/privacy}", "received_events_url": "https://api.github.com/users/hoodmane/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8e430bfa9a6a9d81b25bddf6325069d217dc6f3f", "url": "https://api.github.com/repos/rust-lang/rust/commits/8e430bfa9a6a9d81b25bddf6325069d217dc6f3f", "html_url": "https://github.com/rust-lang/rust/commit/8e430bfa9a6a9d81b25bddf6325069d217dc6f3f"}], "stats": {"total": 12, "additions": 5, "deletions": 7}, "files": [{"sha": "8ac5f094cf6ee0cbc36f5bf55448a5d404348717", "filename": "compiler/rustc_codegen_ssa/src/back/linker.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3fb6d45af9c9e8a682da743f6d920bb5b6dd66de/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Flinker.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3fb6d45af9c9e8a682da743f6d920bb5b6dd66de/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Flinker.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Flinker.rs?ref=3fb6d45af9c9e8a682da743f6d920bb5b6dd66de", "patch": "@@ -1120,8 +1120,6 @@ impl<'a> Linker for EmLinker<'a> {\n             OptLevel::Size => \"-Os\",\n             OptLevel::SizeMin => \"-Oz\",\n         });\n-        // Unusable until https://github.com/rust-lang/rust/issues/38454 is resolved\n-        self.cmd.args(&[\"--memory-init-file\", \"0\"]);\n     }\n \n     fn pgo_gen(&mut self) {"}, {"sha": "269bf8b8bcd49814a371c96d360562758396c4e5", "filename": "compiler/rustc_target/src/spec/asmjs_unknown_emscripten.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/3fb6d45af9c9e8a682da743f6d920bb5b6dd66de/compiler%2Frustc_target%2Fsrc%2Fspec%2Fasmjs_unknown_emscripten.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3fb6d45af9c9e8a682da743f6d920bb5b6dd66de/compiler%2Frustc_target%2Fsrc%2Fspec%2Fasmjs_unknown_emscripten.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Fasmjs_unknown_emscripten.rs?ref=3fb6d45af9c9e8a682da743f6d920bb5b6dd66de", "patch": "@@ -2,10 +2,10 @@ use super::{wasm32_unknown_emscripten, LinkerFlavor, Target};\n \n pub fn target() -> Target {\n     let mut target = wasm32_unknown_emscripten::target();\n-    target\n-        .post_link_args\n-        .entry(LinkerFlavor::Em)\n-        .or_default()\n-        .extend(vec![\"-s\".into(), \"WASM=0\".into()]);\n+    target.post_link_args.entry(LinkerFlavor::Em).or_default().extend(vec![\n+        \"-sWASM=0\".into(),\n+        \"--memory-init-file\".into(),\n+        \"0\".into(),\n+    ]);\n     target\n }"}]}