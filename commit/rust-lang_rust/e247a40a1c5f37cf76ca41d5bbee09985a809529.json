{"sha": "e247a40a1c5f37cf76ca41d5bbee09985a809529", "node_id": "MDY6Q29tbWl0NzI0NzEyOmUyNDdhNDBhMWM1ZjM3Y2Y3NmNhNDFkNWJiZWUwOTk4NWE4MDk1Mjk=", "commit": {"author": {"name": "Simon Sapin", "email": "simon.sapin@exyr.org", "date": "2019-07-03T11:02:47Z"}, "committer": {"name": "Oliver Scherer", "email": "github35764891676564198441@oli-obk.de", "date": "2019-10-11T08:43:54Z"}, "message": "Fixes #41073, it is no longer an ICE", "tree": {"sha": "7cd42415fc9ce534146cde0e48e147835aef22af", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7cd42415fc9ce534146cde0e48e147835aef22af"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e247a40a1c5f37cf76ca41d5bbee09985a809529", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e247a40a1c5f37cf76ca41d5bbee09985a809529", "html_url": "https://github.com/rust-lang/rust/commit/e247a40a1c5f37cf76ca41d5bbee09985a809529", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e247a40a1c5f37cf76ca41d5bbee09985a809529/comments", "author": {"login": "SimonSapin", "id": 291359, "node_id": "MDQ6VXNlcjI5MTM1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/291359?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SimonSapin", "html_url": "https://github.com/SimonSapin", "followers_url": "https://api.github.com/users/SimonSapin/followers", "following_url": "https://api.github.com/users/SimonSapin/following{/other_user}", "gists_url": "https://api.github.com/users/SimonSapin/gists{/gist_id}", "starred_url": "https://api.github.com/users/SimonSapin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SimonSapin/subscriptions", "organizations_url": "https://api.github.com/users/SimonSapin/orgs", "repos_url": "https://api.github.com/users/SimonSapin/repos", "events_url": "https://api.github.com/users/SimonSapin/events{/privacy}", "received_events_url": "https://api.github.com/users/SimonSapin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fe13bbd0648c4f7ad8f7cdfe540ca13bc93ade60", "url": "https://api.github.com/repos/rust-lang/rust/commits/fe13bbd0648c4f7ad8f7cdfe540ca13bc93ade60", "html_url": "https://github.com/rust-lang/rust/commit/fe13bbd0648c4f7ad8f7cdfe540ca13bc93ade60"}], "stats": {"total": 39, "additions": 39, "deletions": 0}, "files": [{"sha": "91e9a0d0b659c7e7cbc1a496f2adfed56d97fd8e", "filename": "src/test/ui/union/issue-41073.rs", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/e247a40a1c5f37cf76ca41d5bbee09985a809529/src%2Ftest%2Fui%2Funion%2Fissue-41073.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e247a40a1c5f37cf76ca41d5bbee09985a809529/src%2Ftest%2Fui%2Funion%2Fissue-41073.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Funion%2Fissue-41073.rs?ref=e247a40a1c5f37cf76ca41d5bbee09985a809529", "patch": "@@ -0,0 +1,24 @@\n+#![feature(untagged_unions)]\n+\n+union Test {\n+    a: A, //~ ERROR unions may not contain fields that need dropping\n+    b: B\n+}\n+\n+#[derive(Debug)]\n+struct A(i32);\n+impl Drop for A {\n+    fn drop(&mut self) { println!(\"A\"); }\n+}\n+\n+#[derive(Debug)]\n+struct B(f32);\n+impl Drop for B {\n+    fn drop(&mut self) { println!(\"B\"); }\n+}\n+\n+fn main() {\n+    let mut test = Test { a: A(3) };\n+    println!(\"{:?}\", unsafe { test.b });\n+    unsafe { test.b = B(0.5); }\n+}"}, {"sha": "2e9598b227124f9e07731f2a48ca956935bd7d4a", "filename": "src/test/ui/union/issue-41073.stderr", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/e247a40a1c5f37cf76ca41d5bbee09985a809529/src%2Ftest%2Fui%2Funion%2Fissue-41073.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e247a40a1c5f37cf76ca41d5bbee09985a809529/src%2Ftest%2Fui%2Funion%2Fissue-41073.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Funion%2Fissue-41073.stderr?ref=e247a40a1c5f37cf76ca41d5bbee09985a809529", "patch": "@@ -0,0 +1,15 @@\n+error[E0740]: unions may not contain fields that need dropping\n+  --> $DIR/issue-41073.rs:4:5\n+   |\n+LL |     a: A,\n+   |     ^^^^\n+   |\n+note: `std::mem::ManuallyDrop` can be used to wrap the type\n+  --> $DIR/issue-41073.rs:4:5\n+   |\n+LL |     a: A,\n+   |     ^^^^\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0740`."}]}