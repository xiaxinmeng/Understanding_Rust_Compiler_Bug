{"sha": "20f737966ec350e3cdc3b4193f2d000ad321d10e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjIwZjczNzk2NmVjMzUwZTNjZGMzYjQxOTNmMmQwMDBhZDMyMWQxMGU=", "commit": {"author": {"name": "Oli Scherer", "email": "github35764891676564198441@oli-obk.de", "date": "2021-03-10T11:45:22Z"}, "committer": {"name": "Oli Scherer", "email": "github35764891676564198441@oli-obk.de", "date": "2021-03-12T12:44:12Z"}, "message": "Replace a custom lift method with a Lift impl", "tree": {"sha": "b7f0b7b25e8a33ed72aa95bf2d60346be1c35b03", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b7f0b7b25e8a33ed72aa95bf2d60346be1c35b03"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/20f737966ec350e3cdc3b4193f2d000ad321d10e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/20f737966ec350e3cdc3b4193f2d000ad321d10e", "html_url": "https://github.com/rust-lang/rust/commit/20f737966ec350e3cdc3b4193f2d000ad321d10e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/20f737966ec350e3cdc3b4193f2d000ad321d10e/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3127a9c60f267c862d2b0f1250c28f38891b94aa", "url": "https://api.github.com/repos/rust-lang/rust/commits/3127a9c60f267c862d2b0f1250c28f38891b94aa", "html_url": "https://github.com/rust-lang/rust/commit/3127a9c60f267c862d2b0f1250c28f38891b94aa"}], "stats": {"total": 11, "additions": 7, "deletions": 4}, "files": [{"sha": "515aabd59bccdf3b2ff44f273ec188d598d5d662", "filename": "compiler/rustc_middle/src/mir/interpret/value.rs", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/20f737966ec350e3cdc3b4193f2d000ad321d10e/compiler%2Frustc_middle%2Fsrc%2Fmir%2Finterpret%2Fvalue.rs", "raw_url": "https://github.com/rust-lang/rust/raw/20f737966ec350e3cdc3b4193f2d000ad321d10e/compiler%2Frustc_middle%2Fsrc%2Fmir%2Finterpret%2Fvalue.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fmir%2Finterpret%2Fvalue.rs?ref=20f737966ec350e3cdc3b4193f2d000ad321d10e", "patch": "@@ -8,7 +8,7 @@ use rustc_apfloat::{\n use rustc_macros::HashStable;\n use rustc_target::abi::{HasDataLayout, Size, TargetDataLayout};\n \n-use crate::ty::{ParamEnv, ScalarInt, Ty, TyCtxt};\n+use crate::ty::{Lift, ParamEnv, ScalarInt, Ty, TyCtxt};\n \n use super::{AllocId, Allocation, InterpResult, Pointer, PointerArithmetic};\n \n@@ -53,8 +53,9 @@ impl From<Scalar> for ConstValue<'tcx> {\n     }\n }\n \n-impl<'tcx> ConstValue<'tcx> {\n-    pub fn lift<'lifted>(self, tcx: TyCtxt<'lifted>) -> Option<ConstValue<'lifted>> {\n+impl<'a, 'tcx> Lift<'tcx> for ConstValue<'a> {\n+    type Lifted = ConstValue<'tcx>;\n+    fn lift_to_tcx(self, tcx: TyCtxt<'tcx>) -> Option<ConstValue<'tcx>> {\n         Some(match self {\n             ConstValue::Scalar(s) => ConstValue::Scalar(s),\n             ConstValue::Slice { data, start, end } => {\n@@ -65,7 +66,9 @@ impl<'tcx> ConstValue<'tcx> {\n             }\n         })\n     }\n+}\n \n+impl<'tcx> ConstValue<'tcx> {\n     #[inline]\n     pub fn try_to_scalar(&self) -> Option<Scalar> {\n         match *self {"}, {"sha": "481d02fccf5478b5ea7991cc039fafd063e24132", "filename": "compiler/rustc_middle/src/mir/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/20f737966ec350e3cdc3b4193f2d000ad321d10e/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/20f737966ec350e3cdc3b4193f2d000ad321d10e/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fmod.rs?ref=20f737966ec350e3cdc3b4193f2d000ad321d10e", "patch": "@@ -2738,7 +2738,7 @@ fn pretty_print_const_value(\n ) -> fmt::Result {\n     use crate::ty::print::PrettyPrinter;\n     ty::tls::with(|tcx| {\n-        let val = val.lift(tcx).unwrap();\n+        let val = tcx.lift(val).unwrap();\n         let ty = tcx.lift(ty).unwrap();\n         let mut cx = FmtPrinter::new(tcx, fmt, Namespace::ValueNS);\n         cx.print_alloc_ids = true;"}]}