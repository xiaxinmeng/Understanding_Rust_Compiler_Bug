{"sha": "d159124dbd8066a29fbc826dd7793805cf29fba5", "node_id": "C_kwDOAAsO6NoAKGQxNTkxMjRkYmQ4MDY2YTI5ZmJjODI2ZGQ3NzkzODA1Y2YyOWZiYTU", "commit": {"author": {"name": "Dylan DPC", "email": "99973273+Dylan-DPC@users.noreply.github.com", "date": "2022-10-26T05:59:57Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-10-26T05:59:57Z"}, "message": "Rollup merge of #103536 - Enselic:remove-set_sigpipe_handler, r=tmiasko\n\nRemove `rustc_driver::set_sigpipe_handler()`\n\nIts usage was removed in https://github.com/rust-lang/rust/pull/102587 and https://github.com/rust-lang/rust/pull/103495, so we do not need to keep it around any longer. According to [preliminary input](https://rust-lang.zulipchat.com/#narrow/stream/182449-t-compiler.2Fhelp/topic/Find.20.60rustc_driver.60.20dependent.20projects.3F/near/304490764), we do not need to worry about any deprecation cycle for this explicitly unstable API, and can just straight up remove it.\n\nPR that added `set_sigpipe_handler`: https://github.com/rust-lang/rust/pull/49606\n\nTracking issue for `unix_sigpipe`: #97889\n\nMigration instructions for any remaining clients\n---\n\nChange from\n\n```rust\n#![feature(rustc_private)]\n\nextern crate rustc_driver;\n\nfn main() {\n    rustc_driver::set_sigpipe_handler();\n    // ...\n```\n\nto\n\n```rust\n#![feature(unix_sigpipe)]\n\n#[unix_sigpipe = \"sig_dfl\"]\nfn main() {\n    // ...\n```\n\n``@rustbot`` labels +T-compiler", "tree": {"sha": "cd620fe6407e52bfe1be9d40c5b6042e0a4445f3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cd620fe6407e52bfe1be9d40c5b6042e0a4445f3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d159124dbd8066a29fbc826dd7793805cf29fba5", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjWMzdCRBK7hj4Ov3rIwAABEcIAIBjsmsskZ4vy5O7WBkPvAsJ\nya3xPRZua5aU7/mKiE+EC98n9+98T3A55wUwOJwDMJoEGbCCBgMdYLUbY6YsFjok\n+rcczN8bbiG4ld6G/2un/j0Ss/L/tH2JWS7qo15hklIVYdsc/TYFN/oI2DpyA6fJ\npu7RiKF7o6PBptcSwlzRWYZQdKSkrJiYp7UP5SoVenHEmLqAju9LQ6Vrozw3nZhx\npPO9EklVcxQB1SQfqegrpc3AuDODQcep+48BN3ez3a2sOg/tgFqklEjNyiY3/hry\nZwZPzqHGsZi83oVmVHOcNxIPoB/B1piClDeDQSIEWn3yjnHUWJuRDwen/mLyaEc=\n=UqgM\n-----END PGP SIGNATURE-----\n", "payload": "tree cd620fe6407e52bfe1be9d40c5b6042e0a4445f3\nparent 39e0e2cc241c03b9550dc876d182f9977a45ba82\nparent 43e17454e2d8f650142cb671e13ca70fcbe42fcc\nauthor Dylan DPC <99973273+Dylan-DPC@users.noreply.github.com> 1666763997 +0530\ncommitter GitHub <noreply@github.com> 1666763997 +0530\n\nRollup merge of #103536 - Enselic:remove-set_sigpipe_handler, r=tmiasko\n\nRemove `rustc_driver::set_sigpipe_handler()`\n\nIts usage was removed in https://github.com/rust-lang/rust/pull/102587 and https://github.com/rust-lang/rust/pull/103495, so we do not need to keep it around any longer. According to [preliminary input](https://rust-lang.zulipchat.com/#narrow/stream/182449-t-compiler.2Fhelp/topic/Find.20.60rustc_driver.60.20dependent.20projects.3F/near/304490764), we do not need to worry about any deprecation cycle for this explicitly unstable API, and can just straight up remove it.\n\nPR that added `set_sigpipe_handler`: https://github.com/rust-lang/rust/pull/49606\n\nTracking issue for `unix_sigpipe`: #97889\n\nMigration instructions for any remaining clients\n---\n\nChange from\n\n```rust\n#![feature(rustc_private)]\n\nextern crate rustc_driver;\n\nfn main() {\n    rustc_driver::set_sigpipe_handler();\n    // ...\n```\n\nto\n\n```rust\n#![feature(unix_sigpipe)]\n\n#[unix_sigpipe = \"sig_dfl\"]\nfn main() {\n    // ...\n```\n\n``@rustbot`` labels +T-compiler\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d159124dbd8066a29fbc826dd7793805cf29fba5", "html_url": "https://github.com/rust-lang/rust/commit/d159124dbd8066a29fbc826dd7793805cf29fba5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d159124dbd8066a29fbc826dd7793805cf29fba5/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "39e0e2cc241c03b9550dc876d182f9977a45ba82", "url": "https://api.github.com/repos/rust-lang/rust/commits/39e0e2cc241c03b9550dc876d182f9977a45ba82", "html_url": "https://github.com/rust-lang/rust/commit/39e0e2cc241c03b9550dc876d182f9977a45ba82"}, {"sha": "43e17454e2d8f650142cb671e13ca70fcbe42fcc", "url": "https://api.github.com/repos/rust-lang/rust/commits/43e17454e2d8f650142cb671e13ca70fcbe42fcc", "html_url": "https://github.com/rust-lang/rust/commit/43e17454e2d8f650142cb671e13ca70fcbe42fcc"}], "stats": {"total": 12, "additions": 0, "deletions": 12}, "files": [{"sha": "cfa734c7df39c331a9eb39b1a482d003f9f6d62d", "filename": "compiler/rustc_driver/src/lib.rs", "status": "modified", "additions": 0, "deletions": 12, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/d159124dbd8066a29fbc826dd7793805cf29fba5/compiler%2Frustc_driver%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d159124dbd8066a29fbc826dd7793805cf29fba5/compiler%2Frustc_driver%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_driver%2Fsrc%2Flib.rs?ref=d159124dbd8066a29fbc826dd7793805cf29fba5", "patch": "@@ -427,18 +427,6 @@ fn run_compiler(\n     })\n }\n \n-#[cfg(unix)]\n-pub fn set_sigpipe_handler() {\n-    unsafe {\n-        // Set the SIGPIPE signal handler, so that an EPIPE\n-        // will cause rustc to terminate, as expected.\n-        assert_ne!(libc::signal(libc::SIGPIPE, libc::SIG_DFL), libc::SIG_ERR);\n-    }\n-}\n-\n-#[cfg(windows)]\n-pub fn set_sigpipe_handler() {}\n-\n // Extract output directory and file from matches.\n fn make_output(matches: &getopts::Matches) -> (Option<PathBuf>, Option<PathBuf>) {\n     let odir = matches.opt_str(\"out-dir\").map(|o| PathBuf::from(&o));"}]}