{"sha": "7f16d0ed54b3497e8b26bc68cdf9a7590f3be816", "node_id": "C_kwDOAAsO6NoAKDdmMTZkMGVkNTRiMzQ5N2U4YjI2YmM2OGNkZjlhNzU5MGYzYmU4MTY", "commit": {"author": {"name": "pierwill", "email": "pierwill@users.noreply.github.com", "date": "2022-01-19T19:12:26Z"}, "committer": {"name": "pierwill", "email": "pierwill@users.noreply.github.com", "date": "2022-01-19T19:12:26Z"}, "message": "Remove ordering traits from `rustc_borrowck::constraints::OutlivesConstraint`\n\nIn two cases where this ordering was used, I've replaced the sorting\nto use a key that does not include DefId. I'm not sure this is correct\nin terms of our goals from #90317, or otherwise.", "tree": {"sha": "ea249f56bd0c753203edf32411bcacbe31e985ca", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ea249f56bd0c753203edf32411bcacbe31e985ca"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7f16d0ed54b3497e8b26bc68cdf9a7590f3be816", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7f16d0ed54b3497e8b26bc68cdf9a7590f3be816", "html_url": "https://github.com/rust-lang/rust/commit/7f16d0ed54b3497e8b26bc68cdf9a7590f3be816", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7f16d0ed54b3497e8b26bc68cdf9a7590f3be816/comments", "author": {"login": "pierwill", "id": 19642016, "node_id": "MDQ6VXNlcjE5NjQyMDE2", "avatar_url": "https://avatars.githubusercontent.com/u/19642016?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pierwill", "html_url": "https://github.com/pierwill", "followers_url": "https://api.github.com/users/pierwill/followers", "following_url": "https://api.github.com/users/pierwill/following{/other_user}", "gists_url": "https://api.github.com/users/pierwill/gists{/gist_id}", "starred_url": "https://api.github.com/users/pierwill/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pierwill/subscriptions", "organizations_url": "https://api.github.com/users/pierwill/orgs", "repos_url": "https://api.github.com/users/pierwill/repos", "events_url": "https://api.github.com/users/pierwill/events{/privacy}", "received_events_url": "https://api.github.com/users/pierwill/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pierwill", "id": 19642016, "node_id": "MDQ6VXNlcjE5NjQyMDE2", "avatar_url": "https://avatars.githubusercontent.com/u/19642016?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pierwill", "html_url": "https://github.com/pierwill", "followers_url": "https://api.github.com/users/pierwill/followers", "following_url": "https://api.github.com/users/pierwill/following{/other_user}", "gists_url": "https://api.github.com/users/pierwill/gists{/gist_id}", "starred_url": "https://api.github.com/users/pierwill/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pierwill/subscriptions", "organizations_url": "https://api.github.com/users/pierwill/orgs", "repos_url": "https://api.github.com/users/pierwill/repos", "events_url": "https://api.github.com/users/pierwill/events{/privacy}", "received_events_url": "https://api.github.com/users/pierwill/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2f004d2d401682e553af3984ebd9a3976885e752", "url": "https://api.github.com/repos/rust-lang/rust/commits/2f004d2d401682e553af3984ebd9a3976885e752", "html_url": "https://github.com/rust-lang/rust/commit/2f004d2d401682e553af3984ebd9a3976885e752"}], "stats": {"total": 6, "additions": 3, "deletions": 3}, "files": [{"sha": "d41143ee763ad835709be88e3966595533913df5", "filename": "compiler/rustc_borrowck/src/constraints/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7f16d0ed54b3497e8b26bc68cdf9a7590f3be816/compiler%2Frustc_borrowck%2Fsrc%2Fconstraints%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7f16d0ed54b3497e8b26bc68cdf9a7590f3be816/compiler%2Frustc_borrowck%2Fsrc%2Fconstraints%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_borrowck%2Fsrc%2Fconstraints%2Fmod.rs?ref=7f16d0ed54b3497e8b26bc68cdf9a7590f3be816", "patch": "@@ -72,7 +72,7 @@ impl<'tcx> Index<OutlivesConstraintIndex> for OutlivesConstraintSet<'tcx> {\n     }\n }\n \n-#[derive(Clone, PartialEq, Eq, PartialOrd, Ord)]\n+#[derive(Clone, PartialEq, Eq)]\n pub struct OutlivesConstraint<'tcx> {\n     // NB. The ordering here is not significant for correctness, but\n     // it is for convenience. Before we dump the constraints in the"}, {"sha": "97233b930c395f839abe07d86a4b64640fc5ded7", "filename": "compiler/rustc_borrowck/src/region_infer/dump_mir.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7f16d0ed54b3497e8b26bc68cdf9a7590f3be816/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fdump_mir.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7f16d0ed54b3497e8b26bc68cdf9a7590f3be816/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fdump_mir.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fdump_mir.rs?ref=7f16d0ed54b3497e8b26bc68cdf9a7590f3be816", "patch": "@@ -72,7 +72,7 @@ impl<'tcx> RegionInferenceContext<'tcx> {\n         }\n \n         let mut constraints: Vec<_> = self.constraints.outlives().iter().collect();\n-        constraints.sort();\n+        constraints.sort_by_key(|c| (c.sup, c.sub));\n         for constraint in &constraints {\n             let OutlivesConstraint { sup, sub, locations, category, variance_info: _ } = constraint;\n             let (name, arg) = match locations {"}, {"sha": "d9120ff245735084f3d9dc2ca4050090d0287e05", "filename": "compiler/rustc_borrowck/src/region_infer/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7f16d0ed54b3497e8b26bc68cdf9a7590f3be816/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7f16d0ed54b3497e8b26bc68cdf9a7590f3be816/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_borrowck%2Fsrc%2Fregion_infer%2Fmod.rs?ref=7f16d0ed54b3497e8b26bc68cdf9a7590f3be816", "patch": "@@ -612,7 +612,7 @@ impl<'tcx> RegionInferenceContext<'tcx> {\n     fn propagate_constraints(&mut self, _body: &Body<'tcx>) {\n         debug!(\"constraints={:#?}\", {\n             let mut constraints: Vec<_> = self.constraints.outlives().iter().collect();\n-            constraints.sort();\n+            constraints.sort_by_key(|c| (c.sup, c.sub));\n             constraints\n                 .into_iter()\n                 .map(|c| (c, self.constraint_sccs.scc(c.sup), self.constraint_sccs.scc(c.sub)))"}]}