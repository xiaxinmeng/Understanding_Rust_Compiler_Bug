{"sha": "b8ca479a2e224ce415f086eb4841259c0e48f7c3", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI4Y2E0NzlhMmUyMjRjZTQxNWYwODZlYjQ4NDEyNTljMGU0OGY3YzM=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2020-01-07T16:17:31Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-01-07T16:17:31Z"}, "message": "Merge pull request #2756 from matklad/retasks\n\n:arrow_up: crates", "tree": {"sha": "7747ebb61848350672034b91f78d574543049184", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7747ebb61848350672034b91f78d574543049184"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b8ca479a2e224ce415f086eb4841259c0e48f7c3", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJeFK8bCRBK7hj4Ov3rIwAAdHIIAA4LWUqkAmm/jh0UrpO7SSpB\n0csI7/1azQH+0Ilkk+zpG/BCDdTo4gake54Q1/zpndAnYpnRLdvsRUD02bsaIkln\ncDM/PPoyhle286QFPwnjYifXhAdvImN3DXf5PdPQJMNef7182CLwx2CIBPbwJIET\nPFOVJ3E2dmsqXBeD6UyaEVvQeHGNyxx2E0z5o7vLmf0a6bnCOSzTzAjd2G8qJklD\n3qO/jC2O6+2a6FgTqlUSNy2GjXUHNrtOXlkpX8JiFiUAjnNZ3bbzpvvHwh472Ehd\nmyllwaahOV1BEhl63+Og2X/GXhsb7OwW95+f9PvOnRzreyZr5YgQT4WpCaWoKwM=\n=x3+a\n-----END PGP SIGNATURE-----\n", "payload": "tree 7747ebb61848350672034b91f78d574543049184\nparent 9df1663c12f48df7f4921e68c928016877390565\nparent 072f0d323b4946a7f722b2dbdb82ece85914efa3\nauthor Aleksey Kladov <aleksey.kladov@gmail.com> 1578413851 +0100\ncommitter GitHub <noreply@github.com> 1578413851 +0100\n\nMerge pull request #2756 from matklad/retasks\n\n:arrow_up: crates"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b8ca479a2e224ce415f086eb4841259c0e48f7c3", "html_url": "https://github.com/rust-lang/rust/commit/b8ca479a2e224ce415f086eb4841259c0e48f7c3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b8ca479a2e224ce415f086eb4841259c0e48f7c3/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9df1663c12f48df7f4921e68c928016877390565", "url": "https://api.github.com/repos/rust-lang/rust/commits/9df1663c12f48df7f4921e68c928016877390565", "html_url": "https://github.com/rust-lang/rust/commit/9df1663c12f48df7f4921e68c928016877390565"}, {"sha": "072f0d323b4946a7f722b2dbdb82ece85914efa3", "url": "https://api.github.com/repos/rust-lang/rust/commits/072f0d323b4946a7f722b2dbdb82ece85914efa3", "html_url": "https://github.com/rust-lang/rust/commit/072f0d323b4946a7f722b2dbdb82ece85914efa3"}], "stats": {"total": 115, "additions": 71, "deletions": 44}, "files": [{"sha": "84c04ee722f26dfb43725db2f57a19a3937a1a89", "filename": ".github/workflows/ci.yaml", "status": "modified", "additions": 5, "deletions": 20, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/b8ca479a2e224ce415f086eb4841259c0e48f7c3/.github%2Fworkflows%2Fci.yaml", "raw_url": "https://github.com/rust-lang/rust/raw/b8ca479a2e224ce415f086eb4841259c0e48f7c3/.github%2Fworkflows%2Fci.yaml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fci.yaml?ref=b8ca479a2e224ce415f086eb4841259c0e48f7c3", "patch": "@@ -56,28 +56,13 @@ jobs:\n         with:\n           command: test\n \n-      - name: Prepare build directory for cache (UNIX)\n-        if: matrix.os == 'ubuntu-latest' || matrix.os == 'macos-latest'\n-        run: |\n-          find ./target/debug -maxdepth 1 -type f -delete \\\n-          && rm -fr ./target/debug/{deps,.fingerprint}/{*ra_*,*heavy_test*,*gen_lsp*,*thread_worker*} \\\n-          && rm -f  ./target/.rustc_info.json \\\n-          && rm ./target/.slow_tests_cookie\n+      - name: Prepare cache\n+        run: cargo xtask pre-cache\n \n-      - name: Prepare build directory for cache (Windows)\n+      - name: Prepare cache 2\n         if: matrix.os == 'windows-latest'\n-        run: >-\n-          (Get-ChildItem ./target/debug -Recurse -Depth 1 -File | Remove-Item) -and\n-          (Remove-Item -Force -Recurse ./target/debug/deps/*ra_*) -and\n-          (Remove-Item -Force -Recurse ./target/debug/deps/*heavy_test*) -and\n-          (Remove-Item -Force -Recurse ./target/debug/deps/*gen_lsp*) -and\n-          (Remove-Item -Force -Recurse ./target/debug/deps/*thread_worker*) -and\n-          (Remove-Item -Force -Recurse ./target/debug/.fingerprint/*ra_*) -and\n-          (Remove-Item -Force -Recurse ./target/debug/.fingerprint/*heavy_test*) -and\n-          (Remove-Item -Force -Recurse ./target/debug/.fingerprint/*gen_lsp*) -and\n-          (Remove-Item -Force -Recurse ./target/debug/.fingerprint/*thread_worker*) -and\n-          (Remove-Item -Force ./target/.rustc_info.json) -and\n-          (Remove-Item ./target/.slow_tests_cookie)\n+        run: Remove-Item ./target/debug/xtask.exe\n+\n \n   type-script:\n     name: TypeScript"}, {"sha": "312240bd20f295ced04c4c79301659a9971d47e5", "filename": "Cargo.lock", "status": "modified", "additions": 21, "deletions": 22, "changes": 43, "blob_url": "https://github.com/rust-lang/rust/blob/b8ca479a2e224ce415f086eb4841259c0e48f7c3/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/b8ca479a2e224ce415f086eb4841259c0e48f7c3/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=b8ca479a2e224ce415f086eb4841259c0e48f7c3", "patch": "@@ -54,7 +54,7 @@ name = \"backtrace-sys\"\n version = \"0.1.32\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"cc 1.0.48 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"cc 1.0.49 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.66 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -115,7 +115,7 @@ dependencies = [\n \n [[package]]\n name = \"cc\"\n-version = \"1.0.48\"\n+version = \"1.0.49\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n@@ -402,12 +402,12 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"getrandom\"\n-version = \"0.1.13\"\n+version = \"0.1.14\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"cfg-if 0.1.10 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.66 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"wasi 0.7.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"wasi 0.9.0+wasi-snapshot-preview1 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -466,7 +466,7 @@ dependencies = [\n \n [[package]]\n name = \"inotify\"\n-version = \"0.6.1\"\n+version = \"0.7.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"bitflags 1.2.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -532,7 +532,7 @@ name = \"jemalloc-sys\"\n version = \"0.3.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"cc 1.0.48 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"cc 1.0.49 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"fs_extra 1.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.66 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n@@ -619,7 +619,7 @@ dependencies = [\n \n [[package]]\n name = \"lsp-types\"\n-version = \"0.68.0\"\n+version = \"0.68.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"base64 0.11.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -700,15 +700,14 @@ dependencies = [\n \n [[package]]\n name = \"notify\"\n-version = \"4.0.14\"\n+version = \"4.0.15\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"bitflags 1.2.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"filetime 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"fsevent 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"fsevent-sys 2.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"inotify 0.6.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"kernel32-sys 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"inotify 0.7.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.66 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"mio 0.6.21 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"mio-extras 2.0.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -900,7 +899,7 @@ dependencies = [\n  \"insta 0.12.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"jod-thread 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"lsp-types 0.68.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"lsp-types 0.68.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"parking_lot 0.10.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"serde_json 1.0.44 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n@@ -1064,7 +1063,7 @@ dependencies = [\n  \"jod-thread 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"lsp-server 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"lsp-types 0.68.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"lsp-types 0.68.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"parking_lot 0.10.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"ra_cargo_watch 0.1.0\",\n  \"ra_ide 0.1.0\",\n@@ -1170,7 +1169,7 @@ dependencies = [\n  \"crossbeam-channel 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"jod-thread 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"notify 4.0.14 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"notify 4.0.15 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"parking_lot 0.10.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"relative-path 1.0.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rustc-hash 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -1208,7 +1207,7 @@ name = \"rand\"\n version = \"0.7.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"getrandom 0.1.13 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"getrandom 0.1.14 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.66 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand_chacha 0.2.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand_core 0.5.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -1252,7 +1251,7 @@ name = \"rand_core\"\n version = \"0.5.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"getrandom 0.1.13 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"getrandom 0.1.14 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1698,7 +1697,7 @@ dependencies = [\n \n [[package]]\n name = \"wasi\"\n-version = \"0.7.0\"\n+version = \"0.9.0+wasi-snapshot-preview1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n@@ -1783,7 +1782,7 @@ dependencies = [\n \"checksum byteorder 1.3.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"a7c3dd8985a7111efc5c80b44e23ecdd8c007de8ade3b96595387e812b957cf5\"\n \"checksum c2-chacha 0.2.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"214238caa1bf3a496ec3392968969cab8549f96ff30652c9e56885329315f6bb\"\n \"checksum cargo_metadata 0.9.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"46e3374c604fb39d1a2f35ed5e4a4e30e60d01fab49446e08f1b3e9a90aef202\"\n-\"checksum cc 1.0.48 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f52a465a666ca3d838ebbf08b241383421412fe7ebb463527bba275526d89f76\"\n+\"checksum cc 1.0.49 (registry+https://github.com/rust-lang/crates.io-index)\" = \"e450b8da92aa6f274e7c6437692f9f2ce6d701fb73bacfcf87897b3f89a4c20e\"\n \"checksum cfg-if 0.1.10 (registry+https://github.com/rust-lang/crates.io-index)\" = \"4785bdd1c96b2a846b2bd7cc02e86b6b3dbf14e7e53446c4f54c92a361040822\"\n \"checksum chalk-derive 0.1.0 (git+https://github.com/rust-lang/chalk.git?rev=ff65b5ac9860f3c36bd892c865ab23d5ff0bbae5)\" = \"<none>\"\n \"checksum chalk-engine 0.9.0 (git+https://github.com/rust-lang/chalk.git?rev=ff65b5ac9860f3c36bd892c865ab23d5ff0bbae5)\" = \"<none>\"\n@@ -1818,14 +1817,14 @@ dependencies = [\n \"checksum fuchsia-cprng 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"a06f77d526c1a601b7c4cdd98f54b5eaabffc14d5f2f0296febdc7f357c6d3ba\"\n \"checksum fuchsia-zircon 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"2e9763c69ebaae630ba35f74888db465e49e259ba1bc0eda7d06f4a067615d82\"\n \"checksum fuchsia-zircon-sys 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"3dcaa9ae7725d12cdb85b3ad99a434db70b468c09ded17e012d86b5c1010f7a7\"\n-\"checksum getrandom 0.1.13 (registry+https://github.com/rust-lang/crates.io-index)\" = \"e7db7ca94ed4cd01190ceee0d8a8052f08a247aa1b469a7f68c6a3b71afcf407\"\n+\"checksum getrandom 0.1.14 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7abc8dd8451921606d809ba32e95b6111925cd2906060d2dcc29c070220503eb\"\n \"checksum globset 0.4.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"925aa2cac82d8834e2b2a4415b6f6879757fb5c0928fc445ae76461a12eed8f2\"\n \"checksum heck 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"20564e78d53d2bb135c343b3f47714a56af2061f1c928fdb541dc7b9fdd94205\"\n \"checksum hermit-abi 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"eff2656d88f158ce120947499e971d743c05dbcbed62e5bd2f38f1698bbc3772\"\n \"checksum humantime 1.3.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"df004cfca50ef23c36850aaaa59ad52cc70d0e90243c3c7737a4dd32dc7a3c4f\"\n \"checksum idna 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"02e2673c30ee86b5b96a9cb52ad15718aa1f966f5ab9ad54a8b95d5ca33120a9\"\n \"checksum indexmap 1.3.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"712d7b3ea5827fcb9d4fda14bf4da5f136f0db2ae9c8f4bd4e2d1c6fde4e6db2\"\n-\"checksum inotify 0.6.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"40b54539f3910d6f84fbf9a643efd6e3aa6e4f001426c0329576128255994718\"\n+\"checksum inotify 0.7.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"24e40d6fd5d64e2082e0c796495c8ef5ad667a96d03e5aaa0becfd9d47bcbfb8\"\n \"checksum inotify-sys 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"e74a1aa87c59aeff6ef2cc2fa62d41bc43f54952f55652656b18a02fd5e356c0\"\n \"checksum insta 0.12.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"0d499dc062e841590a67230d853bce62d0abeb91304927871670b7c55c461349\"\n \"checksum iovec 0.1.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b2b3ea6ff95e175473f8ffe6a7eb7c00d054240321b84c57051175fe3c1e075e\"\n@@ -1845,15 +1844,15 @@ dependencies = [\n \"checksum lock_api 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"79b2de95ecb4691949fea4716ca53cdbcfccb2c612e19644a8bad05edcf9f47b\"\n \"checksum log 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"14b6052be84e6b71ab17edffc2eeabf5c2c3ae1fdb464aae35ac50c67a44e1f7\"\n \"checksum lsp-server 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"5383e043329615624bbf45e1ba27bd75c176762b2592855c659bc28ac580a06b\"\n-\"checksum lsp-types 0.68.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"1b08121a463f43ee67f09da45c0a61d447793adc8dc23e52b009e8cf80278a16\"\n+\"checksum lsp-types 0.68.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"19b79f72914b929daa263483134b8974962cdebc731593b11508afb7f9acec80\"\n \"checksum matches 0.1.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7ffc5c5338469d4d3ea17d269fa8ea3512ad247247c30bd2df69e68309ed0a08\"\n \"checksum memchr 2.2.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"88579771288728879b57485cc7d6b07d648c9f0141eb955f8ab7f9d45394468e\"\n \"checksum memoffset 0.5.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"75189eb85871ea5c2e2c15abbdd541185f63b408415e5051f5cac122d8c774b9\"\n \"checksum mio 0.6.21 (registry+https://github.com/rust-lang/crates.io-index)\" = \"302dec22bcf6bae6dfb69c647187f4b4d0fb6f535521f7bc022430ce8e12008f\"\n \"checksum mio-extras 2.0.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"52403fe290012ce777c4626790c8951324a2b9e3316b3143779c72b029742f19\"\n \"checksum miow 0.2.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"8c1f2f3b1cf331de6896aabf6e9d55dca90356cc9960cca7eaaf408a355ae919\"\n \"checksum net2 0.2.33 (registry+https://github.com/rust-lang/crates.io-index)\" = \"42550d9fb7b6684a6d404d9fa7250c2eb2646df731d1c06afc06dcee9e1bcf88\"\n-\"checksum notify 4.0.14 (registry+https://github.com/rust-lang/crates.io-index)\" = \"199628fc33b21bc767baa057490b00b382ecbae030803a7b36292422d15b778b\"\n+\"checksum notify 4.0.15 (registry+https://github.com/rust-lang/crates.io-index)\" = \"80ae4a7688d1fab81c5bf19c64fc8db920be8d519ce6336ed4e7efe024724dbd\"\n \"checksum num-traits 0.2.10 (registry+https://github.com/rust-lang/crates.io-index)\" = \"d4c81ffc11c212fa327657cb19dd85eb7419e163b5b076bede2bdb5c974c07e4\"\n \"checksum num_cpus 1.11.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"76dac5ed2a876980778b8b85f75a71b6cbf0db0b1232ee12f826bccb00d09d72\"\n \"checksum once_cell 1.2.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"891f486f630e5c5a4916c7e16c4b24a53e78c860b646e9f8e005e4f16847bfed\"\n@@ -1932,7 +1931,7 @@ dependencies = [\n \"checksum uuid 0.8.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9fde2f6a4bea1d6e007c4ad38c6839fa71cbb63b6dbf5b595aa38dc9b1093c11\"\n \"checksum version_check 0.9.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"078775d0255232fb988e6fccf26ddc9d1ac274299aaedcedce21c6f72cc533ce\"\n \"checksum walkdir 2.2.9 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9658c94fa8b940eab2250bd5a457f9c48b748420d71293b165c8cdbe2f55f71e\"\n-\"checksum wasi 0.7.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b89c3ce4ce14bdc6fb6beaf9ec7928ca331de5df7e5ea278375642a2f478570d\"\n+\"checksum wasi 0.9.0+wasi-snapshot-preview1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"cccddf32554fecc6acb585f82a32a72e28b48f8c4c1883ddfeeeaa96f7d8e519\"\n \"checksum winapi 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"167dc9d6949a9b857f3451275e911c3f44255842c1f7a76f33c55103a909087a\"\n \"checksum winapi 0.3.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"8093091eeb260906a183e6ae1abdba2ef5ef2257a21801128899c3fc699229c6\"\n \"checksum winapi-build 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"2d315eee3b34aca4797b2da6b13ed88266e6d612562a0c46390af8299fc699bc\""}, {"sha": "db502c2007b0638edb33d65a20f3ef0a1d0c33b7", "filename": "crates/ra_lsp_server/src/caps.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b8ca479a2e224ce415f086eb4841259c0e48f7c3/crates%2Fra_lsp_server%2Fsrc%2Fcaps.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b8ca479a2e224ce415f086eb4841259c0e48f7c3/crates%2Fra_lsp_server%2Fsrc%2Fcaps.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fcaps.rs?ref=b8ca479a2e224ce415f086eb4841259c0e48f7c3", "patch": "@@ -56,6 +56,7 @@ pub fn server_capabilities() -> ServerCapabilities {\n         color_provider: None,\n         execute_command_provider: None,\n         workspace: None,\n+        call_hierarchy_provider: None,\n         experimental: Default::default(),\n     }\n }"}, {"sha": "e46c21db72738703d0a3637971b303c53c728db6", "filename": "xtask/src/lib.rs", "status": "modified", "additions": 39, "deletions": 1, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/b8ca479a2e224ce415f086eb4841259c0e48f7c3/xtask%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b8ca479a2e224ce415f086eb4841259c0e48f7c3/xtask%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/xtask%2Fsrc%2Flib.rs?ref=b8ca479a2e224ce415f086eb4841259c0e48f7c3", "patch": "@@ -9,7 +9,7 @@ mod ast_src;\n \n use anyhow::Context;\n use std::{\n-    env,\n+    env, fs,\n     path::{Path, PathBuf},\n     process::{Command, Stdio},\n };\n@@ -101,3 +101,41 @@ pub fn run_fuzzer() -> Result<()> {\n \n     run(\"rustup run nightly -- cargo fuzz run parser\", \"./crates/ra_syntax\")\n }\n+\n+/// Cleans the `./target` dir after the build such that only\n+/// dependencies are cached on CI.\n+pub fn run_pre_cache() -> Result<()> {\n+    let slow_tests_cookie = Path::new(\"./target/.slow_tests_cookie\");\n+    if !slow_tests_cookie.exists() {\n+        panic!(\"slow tests were skipped on CI!\")\n+    }\n+    rm_rf(slow_tests_cookie)?;\n+\n+    for entry in Path::new(\"./target/debug\").read_dir()? {\n+        let entry = entry?;\n+        if entry.file_type().map(|it| it.is_file()).ok() == Some(true) {\n+            // Can't delete yourself on windows :-(\n+            if !entry.path().ends_with(\"xtask.exe\") {\n+                rm_rf(&entry.path())?\n+            }\n+        }\n+    }\n+\n+    fs::remove_file(\"./target/.rustc_info.json\")?;\n+    let to_delete = [\"ra_\", \"heavy_test\"];\n+    for &dir in [\"./target/debug/deps\", \"target/debug/.fingerprint\"].iter() {\n+        for entry in Path::new(dir).read_dir()? {\n+            let entry = entry?;\n+            if to_delete.iter().any(|&it| entry.path().display().to_string().contains(it)) {\n+                rm_rf(&entry.path())?\n+            }\n+        }\n+    }\n+\n+    Ok(())\n+}\n+\n+fn rm_rf(path: &Path) -> Result<()> {\n+    if path.is_file() { fs::remove_file(path) } else { fs::remove_dir_all(path) }\n+        .with_context(|| format!(\"failed to remove {:?}\", path))\n+}"}, {"sha": "053453e6ebb11f2d61cc2cf29165302f5f7882b3", "filename": "xtask/src/main.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/b8ca479a2e224ce415f086eb4841259c0e48f7c3/xtask%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b8ca479a2e224ce415f086eb4841259c0e48f7c3/xtask%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/xtask%2Fsrc%2Fmain.rs?ref=b8ca479a2e224ce415f086eb4841259c0e48f7c3", "patch": "@@ -14,7 +14,7 @@ use pico_args::Arguments;\n use xtask::{\n     codegen::{self, Mode},\n     install::{ClientOpt, InstallCmd, ServerOpt},\n-    pre_commit, run_clippy, run_fuzzer, run_rustfmt, Result,\n+    pre_commit, run_clippy, run_fuzzer, run_pre_cache, run_rustfmt, Result,\n };\n \n fn main() -> Result<()> {\n@@ -88,6 +88,10 @@ FLAGS:\n             args.finish()?;\n             run_fuzzer()\n         }\n+        \"pre-cache\" => {\n+            args.finish()?;\n+            run_pre_cache()\n+        }\n         _ => {\n             eprintln!(\n                 \"\\"}]}