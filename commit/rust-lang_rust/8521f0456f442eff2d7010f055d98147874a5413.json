{"sha": "8521f0456f442eff2d7010f055d98147874a5413", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg1MjFmMDQ1NmY0NDJlZmYyZDcwMTBmMDU1ZDk4MTQ3ODc0YTU0MTM=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2019-08-21T08:09:27Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-08-21T08:09:27Z"}, "message": "Merge #1711\n\n1711: switch to jod threads r=matklad a=matklad\n\n\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>", "tree": {"sha": "0b1dcb3b4ba7ad73c1394aacf7145aa1db224274", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0b1dcb3b4ba7ad73c1394aacf7145aa1db224274"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8521f0456f442eff2d7010f055d98147874a5413", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdXPw3CRBK7hj4Ov3rIwAAdHIIAFtLHK2vy/+DUqhVA1LSYk8u\n27vFQnSuwYVpHSthuAdl7beVVc7dQS1d6fnQbj54HSAa1EsOZHZYBmOrN+9DJpPn\nH/KWvnpIisBxds6c6pSuTzDXrAnOcZgPfSC/psiwaR3OJIR+iLHHCuDWMnyQQhCY\ncC1oUcvEus+rzAvJftmmK4UvRTpqRQiXDIwt2EV7uUoQyRR8v5Xt9zHdvZczj841\nUE60sBFDJQ6SD7qpucTcnCS+0wQ+HprcBtBza4rA42IVZiGUrgONt1ClPuTwN7UE\neab4vykxV7d6CPDOD11h6mlw78Oypqtp8awj4mvfvBjzgOr8xIKGNyxLkdGqF74=\n=JCBP\n-----END PGP SIGNATURE-----\n", "payload": "tree 0b1dcb3b4ba7ad73c1394aacf7145aa1db224274\nparent bdf16d1b670959f35bcbadbfd11b5c1b5a396703\nparent 8844ed9697a385e1182bd58ed8a1068d52c370de\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1566374967 +0000\ncommitter GitHub <noreply@github.com> 1566374967 +0000\n\nMerge #1711\n\n1711: switch to jod threads r=matklad a=matklad\n\n\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8521f0456f442eff2d7010f055d98147874a5413", "html_url": "https://github.com/rust-lang/rust/commit/8521f0456f442eff2d7010f055d98147874a5413", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8521f0456f442eff2d7010f055d98147874a5413/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bdf16d1b670959f35bcbadbfd11b5c1b5a396703", "url": "https://api.github.com/repos/rust-lang/rust/commits/bdf16d1b670959f35bcbadbfd11b5c1b5a396703", "html_url": "https://github.com/rust-lang/rust/commit/bdf16d1b670959f35bcbadbfd11b5c1b5a396703"}, {"sha": "8844ed9697a385e1182bd58ed8a1068d52c370de", "url": "https://api.github.com/repos/rust-lang/rust/commits/8844ed9697a385e1182bd58ed8a1068d52c370de", "html_url": "https://github.com/rust-lang/rust/commit/8844ed9697a385e1182bd58ed8a1068d52c370de"}], "stats": {"total": 125, "additions": 52, "deletions": 73}, "files": [{"sha": "f28d117328cd9d67c961d6141b1cd3a7448e961a", "filename": "Cargo.lock", "status": "modified", "additions": 46, "deletions": 38, "changes": 84, "blob_url": "https://github.com/rust-lang/rust/blob/8521f0456f442eff2d7010f055d98147874a5413/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/8521f0456f442eff2d7010f055d98147874a5413/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=8521f0456f442eff2d7010f055d98147874a5413", "patch": "@@ -35,12 +35,12 @@ dependencies = [\n \n [[package]]\n name = \"autocfg\"\n-version = \"0.1.5\"\n+version = \"0.1.6\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"backtrace\"\n-version = \"0.3.34\"\n+version = \"0.3.35\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"backtrace-sys 0.1.31 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -198,7 +198,7 @@ dependencies = [\n  \"chalk-ir 0.1.0 (git+https://github.com/rust-lang/chalk.git)\",\n  \"chalk-macros 0.1.1 (git+https://github.com/rust-lang/chalk.git)\",\n  \"chalk-rust-ir 0.1.0 (git+https://github.com/rust-lang/chalk.git)\",\n- \"derive-new 0.5.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"derive-new 0.5.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"ena 0.10.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"failure 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"itertools 0.8.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -233,7 +233,7 @@ dependencies = [\n  \"bitflags 1.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"strsim 0.8.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"textwrap 0.11.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"unicode-width 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"unicode-width 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"vec_map 0.8.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -269,7 +269,7 @@ dependencies = [\n  \"parking_lot 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"regex 1.2.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"termios 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"unicode-width 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"unicode-width 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"winapi 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -344,12 +344,12 @@ dependencies = [\n \n [[package]]\n name = \"derive-new\"\n-version = \"0.5.7\"\n+version = \"0.5.8\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"proc-macro2 0.4.30 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"quote 0.6.13 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"syn 0.15.44 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"proc-macro2 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"quote 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"syn 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -406,7 +406,7 @@ name = \"failure\"\n version = \"0.1.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"backtrace 0.3.34 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"backtrace 0.3.35 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"failure_derive 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -579,7 +579,7 @@ dependencies = [\n \n [[package]]\n name = \"indexmap\"\n-version = \"1.0.2\"\n+version = \"1.1.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n@@ -683,6 +683,11 @@ dependencies = [\n  \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n+[[package]]\n+name = \"jod-thread\"\n+version = \"0.1.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+\n [[package]]\n name = \"join_to_string\"\n version = \"0.1.3\"\n@@ -850,7 +855,7 @@ name = \"num-integer\"\n version = \"0.1.41\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"autocfg 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"autocfg 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"num-traits 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -859,7 +864,7 @@ name = \"num-traits\"\n version = \"0.2.8\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"autocfg 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"autocfg 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -937,7 +942,7 @@ dependencies = [\n  \"proc-macro-hack 0.5.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"proc-macro2 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"quote 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"syn 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"syn 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1005,7 +1010,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"proc-macro2 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"quote 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"syn 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"syn 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1092,7 +1097,7 @@ dependencies = [\n  \"ra_hir 0.1.0\",\n  \"ra_ide_api 0.1.0\",\n  \"ra_project_model 0.1.0\",\n- \"ra_vfs 0.2.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"ra_vfs 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"ra_vfs_glob 0.1.0\",\n  \"rustc-hash 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n@@ -1198,7 +1203,7 @@ dependencies = [\n  \"ra_project_model 0.1.0\",\n  \"ra_syntax 0.1.0\",\n  \"ra_text_edit 0.1.0\",\n- \"ra_vfs 0.2.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"ra_vfs 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"ra_vfs_glob 0.1.0\",\n  \"relative-path 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rustc-hash 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -1234,7 +1239,7 @@ dependencies = [\n name = \"ra_prof\"\n version = \"0.1.0\"\n dependencies = [\n- \"backtrace 0.3.34 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"backtrace 0.3.35 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"itertools 0.8.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"jemalloc-ctl 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"jemallocator 0.3.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -1307,10 +1312,11 @@ dependencies = [\n \n [[package]]\n name = \"ra_vfs\"\n-version = \"0.2.7\"\n+version = \"0.2.8\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"crossbeam-channel 0.3.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"jod-thread 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"notify 4.0.12 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"parking_lot 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -1324,15 +1330,15 @@ name = \"ra_vfs_glob\"\n version = \"0.1.0\"\n dependencies = [\n  \"globset 0.4.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"ra_vfs 0.2.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"ra_vfs 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n name = \"rand\"\n version = \"0.6.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"autocfg 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"autocfg 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.62 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand_chacha 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand_core 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -1363,7 +1369,7 @@ name = \"rand_chacha\"\n version = \"0.1.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"autocfg 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"autocfg 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand_core 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -1449,7 +1455,7 @@ name = \"rand_pcg\"\n version = \"0.1.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"autocfg 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"autocfg 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand_core 0.4.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -1458,7 +1464,7 @@ name = \"rand_pcg\"\n version = \"0.2.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"autocfg 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"autocfg 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand_core 0.5.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -1596,8 +1602,8 @@ version = \"0.13.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"crossbeam 0.7.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"derive-new 0.5.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"indexmap 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"derive-new 0.5.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"indexmap 1.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"parking_lot 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand 0.7.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -1659,7 +1665,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"proc-macro2 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"quote 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"syn 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"syn 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1679,7 +1685,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"proc-macro2 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"quote 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"syn 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"syn 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1755,7 +1761,7 @@ dependencies = [\n \n [[package]]\n name = \"syn\"\n-version = \"1.0.2\"\n+version = \"1.0.3\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"proc-macro2 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -1814,7 +1820,7 @@ name = \"textwrap\"\n version = \"0.11.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"unicode-width 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"unicode-width 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1830,6 +1836,7 @@ name = \"thread_worker\"\n version = \"0.1.0\"\n dependencies = [\n  \"crossbeam-channel 0.3.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"jod-thread 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n@@ -1892,7 +1899,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"unicode-width\"\n-version = \"0.1.5\"\n+version = \"0.1.6\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n@@ -2014,8 +2021,8 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum ansi_term 0.11.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ee49baf6cb617b853aa8d93bf420db2383fab46d314482ca2803b40d5fde979b\"\n \"checksum arrayvec 0.4.11 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b8d73f9beda665eaa98ab9e4f7442bd4e7de6652587de55b2525e52e29c1b0ba\"\n \"checksum atty 0.2.13 (registry+https://github.com/rust-lang/crates.io-index)\" = \"1803c647a3ec87095e7ae7acfca019e98de5ec9a7d01343f611cf3152ed71a90\"\n-\"checksum autocfg 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"22130e92352b948e7e82a49cdb0aa94f2211761117f29e052dd397c1ac33542b\"\n-\"checksum backtrace 0.3.34 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b5164d292487f037ece34ec0de2fcede2faa162f085dd96d2385ab81b12765ba\"\n+\"checksum autocfg 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b671c8fb71b457dd4ae18c4ba1e59aa81793daacc361d82fcd410cef0d491875\"\n+\"checksum backtrace 0.3.35 (registry+https://github.com/rust-lang/crates.io-index)\" = \"1371048253fa3bac6704bfd6bbfc922ee9bdcee8881330d40f308b81cc5adc55\"\n \"checksum backtrace-sys 0.1.31 (registry+https://github.com/rust-lang/crates.io-index)\" = \"82a830b4ef2d1124a711c71d263c5abdc710ef8e907bd508c88be475cebc422b\"\n \"checksum base64 0.10.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"0b25d992356d2eb0ed82172f5248873db5560c4721f564b13cb5193bda5e668e\"\n \"checksum bit-set 0.5.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"e84c238982c4b1e1ee668d136c510c67a13465279c0cb367ea6baf6310620a80\"\n@@ -2048,7 +2055,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum crossbeam-epoch 0.7.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"fedcd6772e37f3da2a9af9bf12ebe046c0dfe657992377b4df982a2b54cd37a9\"\n \"checksum crossbeam-queue 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7c979cd6cfe72335896575c6b5688da489e420d36a27a0b9eb0c73db574b4a4b\"\n \"checksum crossbeam-utils 0.6.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"04973fa96e96579258a5091af6003abde64af786b860f18622b82e026cca60e6\"\n-\"checksum derive-new 0.5.7 (registry+https://github.com/rust-lang/crates.io-index)\" = \"c3fd04571b29c91cfbe1e7c9a228e069ac8635f180ffb4ccd6a6907617ee8bb0\"\n+\"checksum derive-new 0.5.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"71f31892cd5c62e414316f2963c5689242c43d8e7bbcaaeca97e5e28c95d91d9\"\n \"checksum difference 2.0.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"524cbf6897b527295dff137cec09ecf3a05f4fddffd7dfcd1585403449e74198\"\n \"checksum digest 0.8.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f3d0c8c8752312f9713efd397ff63acb9f85585afbf179282e720e7704954dd5\"\n \"checksum drop_bomb 0.1.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"69b26e475fd29098530e709294e94e661974c851aed42512793f120fed4e199f\"\n@@ -2078,7 +2085,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum globset 0.4.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"925aa2cac82d8834e2b2a4415b6f6879757fb5c0928fc445ae76461a12eed8f2\"\n \"checksum heck 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"20564e78d53d2bb135c343b3f47714a56af2061f1c928fdb541dc7b9fdd94205\"\n \"checksum idna 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"02e2673c30ee86b5b96a9cb52ad15718aa1f966f5ab9ad54a8b95d5ca33120a9\"\n-\"checksum indexmap 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7e81a7c05f79578dbc15793d8b619db9ba32b4577003ef3af1a91c416798c58d\"\n+\"checksum indexmap 1.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"a4d6d89e0948bf10c08b9ecc8ac5b83f07f857ebe2c0cbe38de15b4e4f510356\"\n \"checksum indicatif 0.11.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"2c60da1c9abea75996b70a931bba6c750730399005b61ccd853cee50ef3d0d0c\"\n \"checksum inotify 0.6.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"40b54539f3910d6f84fbf9a643efd6e3aa6e4f001426c0329576128255994718\"\n \"checksum inotify-sys 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"e74a1aa87c59aeff6ef2cc2fa62d41bc43f54952f55652656b18a02fd5e356c0\"\n@@ -2089,6 +2096,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum jemalloc-ctl 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"c502a5ff9dd2924f1ed32ba96e3b65735d837b4bfd978d3161b1702e66aca4b7\"\n \"checksum jemalloc-sys 0.3.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"0d3b9f3f5c9b31aa0f5ed3260385ac205db665baa41d49bb8338008ae94ede45\"\n \"checksum jemallocator 0.3.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"43ae63fcfc45e99ab3d1b29a46782ad679e98436c3169d15a167a1108a724b69\"\n+\"checksum jod-thread 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"2f52a11f73b88fab829a0e4d9e13ea5982c7ac457c72eb3541d82a4afdfce4ff\"\n \"checksum join_to_string 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"4dc7a5290e8c2606ce2be49f456d50f69173cb96d1541e4f66e34ac8b331a98f\"\n \"checksum kernel32-sys 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7507624b29483431c0ba2d82aece8ca6cdba9382bff4ddd0f7490560c056098d\"\n \"checksum lalrpop-intern 0.15.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"cc4fd87be4a815fd373e02773983940f0d75fb26fde8c098e9e45f7af03154c0\"\n@@ -2135,7 +2143,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum quote 0.6.13 (registry+https://github.com/rust-lang/crates.io-index)\" = \"6ce23b6b870e8f94f81fb0a363d65d86675884b34a09043c81e5562f11c1f8e1\"\n \"checksum quote 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"053a8c8bcc71fcce321828dc897a98ab9760bef03a4fc36693c231e5b3216cfe\"\n \"checksum ra_rustc_lexer 0.1.0-pre.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"04371af481820ff8d35c7d12b503eb09cf9e1bd246269bf4a33e3d8c54fa3a4a\"\n-\"checksum ra_vfs 0.2.7 (registry+https://github.com/rust-lang/crates.io-index)\" = \"6918c38f6ab45101f1ddd6110eda831a735b5e9ca6c96d1ceedb7d13ecaeb0f4\"\n+\"checksum ra_vfs 0.2.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9e891866e1bb03f50a28cc01e3f244a62107c301ae674ba06b2e7a9b310ae75a\"\n \"checksum rand 0.6.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"6d71dacdc3c88c1fde3885a3be3fbab9f35724e6ce99467f7d9c5026132184ca\"\n \"checksum rand 0.7.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"d47eab0e83d9693d40f825f86948aa16eff6750ead4bdffc4ab95b8b3a7f052c\"\n \"checksum rand_chacha 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"556d3a1ca6600bfcbab7c7c91ccb085ac7fbbcd70e008a98742e7847f4f7bcef\"\n@@ -2185,7 +2193,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum strsim 0.8.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"8ea5119cdb4c55b55d432abb513a0429384878c15dde60cc77b1c99de1a95a6a\"\n \"checksum superslice 1.0.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ab16ced94dbd8a46c82fd81e3ed9a8727dac2977ea869d217bcc4ea1f122e81f\"\n \"checksum syn 0.15.44 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9ca4b3b69a77cbe1ffc9e198781b7acb0c7365a883670e8f1c1bc66fba79a5c5\"\n-\"checksum syn 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"2ae5cd13590144ea968ba5d5520da7a4c08415861014399b5b349f74591c375f\"\n+\"checksum syn 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"158521e6f544e7e3dcfc370ac180794aa38cb34a1b1e07609376d4adcf429b93\"\n \"checksum synstructure 0.10.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"02353edf96d6e4dc81aea2d8490a7e9db177bf8acb0e951c24940bf866cb313f\"\n \"checksum tempfile 3.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7a6e24d9338a0a5be79593e2fa15a648add6138caa803e2d5bc782c371732ca9\"\n \"checksum termios 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"72b620c5ea021d75a735c943269bb07d30c9b77d6ac6b236bc8b5c496ef05625\"\n@@ -2200,7 +2208,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum unicode-bidi 0.3.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"49f2bd0c6468a8230e1db229cff8029217cf623c767ea5d60bfbd42729ea54d5\"\n \"checksum unicode-normalization 0.1.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"141339a08b982d942be2ca06ff8b076563cbe223d1befd5450716790d44e2426\"\n \"checksum unicode-segmentation 1.3.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"1967f4cdfc355b37fd76d2a954fb2ed3871034eb4f26d60537d88795cfc332a9\"\n-\"checksum unicode-width 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"882386231c45df4700b275c7ff55b6f3698780a650026380e72dabe76fa46526\"\n+\"checksum unicode-width 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7007dbd421b92cc6e28410fe7362e2e0a2503394908f417b68ec8d1c364c4e20\"\n \"checksum unicode-xid 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"fc72304796d0818e357ead4e000d19c9c174ab23dc11093ac919054d20a6a7fc\"\n \"checksum unicode-xid 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"826e7639553986605ec5979c7dd957c7895e93eabed50ab2ffa7f6128a75097c\"\n \"checksum url 2.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"75b414f6c464c879d7f9babf951f23bc3743fb7313c081b2e6ca719067ea9d61\""}, {"sha": "e3babbf8d130260bc2c435b26a30252065d14bf4", "filename": "crates/thread_worker/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8521f0456f442eff2d7010f055d98147874a5413/crates%2Fthread_worker%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/8521f0456f442eff2d7010f055d98147874a5413/crates%2Fthread_worker%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fthread_worker%2FCargo.toml?ref=8521f0456f442eff2d7010f055d98147874a5413", "patch": "@@ -5,6 +5,6 @@ version = \"0.1.0\"\n authors = [\"rust-analyzer developers\"]\n \n [dependencies]\n+jod-thread = \"0.1.0\"\n crossbeam-channel = \"0.3.5\"\n log = \"0.4.3\"\n-"}, {"sha": "68e5c124dc1943f048a83a208a5b8b951fbb9823", "filename": "crates/thread_worker/src/lib.rs", "status": "modified", "additions": 5, "deletions": 34, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/8521f0456f442eff2d7010f055d98147874a5413/crates%2Fthread_worker%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8521f0456f442eff2d7010f055d98147874a5413/crates%2Fthread_worker%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fthread_worker%2Fsrc%2Flib.rs?ref=8521f0456f442eff2d7010f055d98147874a5413", "patch": "@@ -1,39 +1,7 @@\n //! Small utility to correctly spawn crossbeam-channel based worker threads.\n \n-use std::thread;\n-\n use crossbeam_channel::{bounded, unbounded, Receiver, Sender};\n \n-/// Like `std::thread::JoinHandle<()>`, but joins thread in drop automatically.\n-pub struct ScopedThread {\n-    // Option for drop\n-    inner: Option<thread::JoinHandle<()>>,\n-}\n-\n-impl Drop for ScopedThread {\n-    fn drop(&mut self) {\n-        let inner = self.inner.take().unwrap();\n-        let name = inner.thread().name().unwrap().to_string();\n-        log::info!(\"waiting for {} to finish...\", name);\n-        let res = inner.join();\n-        log::info!(\".. {} terminated with {}\", name, if res.is_ok() { \"ok\" } else { \"err\" });\n-\n-        // escalate panic, but avoid aborting the process\n-        if let Err(e) = res {\n-            if !thread::panicking() {\n-                panic!(e)\n-            }\n-        }\n-    }\n-}\n-\n-impl ScopedThread {\n-    pub fn spawn(name: &'static str, f: impl FnOnce() + Send + 'static) -> ScopedThread {\n-        let inner = thread::Builder::new().name(name.into()).spawn(f).unwrap();\n-        ScopedThread { inner: Some(inner) }\n-    }\n-}\n-\n /// A wrapper around event-processing thread with automatic shutdown semantics.\n pub struct Worker<I, O> {\n     // XXX: field order is significant here.\n@@ -48,7 +16,7 @@ pub struct Worker<I, O> {\n     // single client, so, if we are shutting down, nobody is interested in the\n     // unfinished work anyway!\n     sender: Sender<I>,\n-    _thread: ScopedThread,\n+    _thread: jod_thread::JoinHandle<()>,\n     receiver: Receiver<O>,\n }\n \n@@ -63,7 +31,10 @@ impl<I, O> Worker<I, O> {\n         // and output buffers to a fixed size, a worker might get stuck.\n         let (sender, input_receiver) = bounded::<I>(buf);\n         let (output_sender, receiver) = unbounded::<O>();\n-        let _thread = ScopedThread::spawn(name, move || f(input_receiver, output_sender));\n+        let _thread = jod_thread::Builder::new()\n+            .name(name.to_string())\n+            .spawn(move || f(input_receiver, output_sender))\n+            .expect(\"failed to spawn a thread\");\n         Worker { sender, _thread, receiver }\n     }\n }"}]}