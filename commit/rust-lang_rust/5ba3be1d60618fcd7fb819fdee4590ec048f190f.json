{"sha": "5ba3be1d60618fcd7fb819fdee4590ec048f190f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjViYTNiZTFkNjA2MThmY2Q3ZmI4MTlmZGVlNDU5MGVjMDQ4ZjE5MGY=", "commit": {"author": {"name": "Gus Caplan", "email": "me@gus.host", "date": "2021-01-11T21:31:52Z"}, "committer": {"name": "Gus Caplan", "email": "me@gus.host", "date": "2021-01-11T21:31:52Z"}, "message": "squash! fix wasi", "tree": {"sha": "78c267c35c9a6fd572c224d4219ebfc0b8b2b93b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/78c267c35c9a6fd572c224d4219ebfc0b8b2b93b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5ba3be1d60618fcd7fb819fdee4590ec048f190f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCAAdFiEEXSkNpnBNseeWrjXy8AvRGIDoLw4FAl/8w+gACgkQ8AvRGIDo\nLw5Wkwf/f7dOU05UIK+d/OhpghX8a3kSASNPOFk3w+WUNjxzM0U+4xoP2wOne5ED\nO86DqHC9o7yL8/U/N6GJNrlwXZJ5fz5oQGDYp+8rAuG4RHP+SpecHYdaX1jLS8VR\nJGus+HHoDVXOJtpK64yminhtCE/j3SUXsyQz9mggDL4vA0qQJWzFxp748gimfgMM\nzr6dLDRtOytUDbcFuTEd1jtoT9k8ensvBhveAESDl38RYVOUQSyoLAmjNVO6RJv+\n/Kf9XP5O8O+Ci7CJ/piwTjs5Z2srXXjWlaPGl3WX4wCyqyLGGSnkTCOMhzwRTB2g\nBZzucdYpn+I9pkZ290nutDKwVZresA==\n=KsOi\n-----END PGP SIGNATURE-----", "payload": "tree 78c267c35c9a6fd572c224d4219ebfc0b8b2b93b\nparent 8f64cec02234a8971d547e7c610015fabc87162e\nauthor Gus Caplan <me@gus.host> 1610400712 -0600\ncommitter Gus Caplan <me@gus.host> 1610400712 -0600\n\nsquash! fix wasi\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5ba3be1d60618fcd7fb819fdee4590ec048f190f", "html_url": "https://github.com/rust-lang/rust/commit/5ba3be1d60618fcd7fb819fdee4590ec048f190f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5ba3be1d60618fcd7fb819fdee4590ec048f190f/comments", "author": {"login": "devsnek", "id": 5952481, "node_id": "MDQ6VXNlcjU5NTI0ODE=", "avatar_url": "https://avatars.githubusercontent.com/u/5952481?v=4", "gravatar_id": "", "url": "https://api.github.com/users/devsnek", "html_url": "https://github.com/devsnek", "followers_url": "https://api.github.com/users/devsnek/followers", "following_url": "https://api.github.com/users/devsnek/following{/other_user}", "gists_url": "https://api.github.com/users/devsnek/gists{/gist_id}", "starred_url": "https://api.github.com/users/devsnek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/devsnek/subscriptions", "organizations_url": "https://api.github.com/users/devsnek/orgs", "repos_url": "https://api.github.com/users/devsnek/repos", "events_url": "https://api.github.com/users/devsnek/events{/privacy}", "received_events_url": "https://api.github.com/users/devsnek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "devsnek", "id": 5952481, "node_id": "MDQ6VXNlcjU5NTI0ODE=", "avatar_url": "https://avatars.githubusercontent.com/u/5952481?v=4", "gravatar_id": "", "url": "https://api.github.com/users/devsnek", "html_url": "https://github.com/devsnek", "followers_url": "https://api.github.com/users/devsnek/followers", "following_url": "https://api.github.com/users/devsnek/following{/other_user}", "gists_url": "https://api.github.com/users/devsnek/gists{/gist_id}", "starred_url": "https://api.github.com/users/devsnek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/devsnek/subscriptions", "organizations_url": "https://api.github.com/users/devsnek/orgs", "repos_url": "https://api.github.com/users/devsnek/repos", "events_url": "https://api.github.com/users/devsnek/events{/privacy}", "received_events_url": "https://api.github.com/users/devsnek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8f64cec02234a8971d547e7c610015fabc87162e", "url": "https://api.github.com/repos/rust-lang/rust/commits/8f64cec02234a8971d547e7c610015fabc87162e", "html_url": "https://github.com/rust-lang/rust/commit/8f64cec02234a8971d547e7c610015fabc87162e"}], "stats": {"total": 20, "additions": 5, "deletions": 15}, "files": [{"sha": "a9e595d11e75976aec0b2e8bc039b4c187e858b6", "filename": "compiler/rustc_target/src/abi/call/mod.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/5ba3be1d60618fcd7fb819fdee4590ec048f190f/compiler%2Frustc_target%2Fsrc%2Fabi%2Fcall%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5ba3be1d60618fcd7fb819fdee4590ec048f190f/compiler%2Frustc_target%2Fsrc%2Fabi%2Fcall%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fabi%2Fcall%2Fmod.rs?ref=5ba3be1d60618fcd7fb819fdee4590ec048f190f", "patch": "@@ -605,10 +605,11 @@ impl<'a, Ty> FnAbi<'a, Ty> {\n             \"nvptx64\" => nvptx64::compute_abi_info(self),\n             \"hexagon\" => hexagon::compute_abi_info(self),\n             \"riscv32\" | \"riscv64\" => riscv::compute_abi_info(cx, self),\n-            \"wasm32\" if cx.target_spec().os == \"bindgen\" => {\n-                wasm32_bindgen_compat::compute_abi_info(self)\n-            }\n-            \"wasm32\" | \"asmjs\" => wasm32::compute_abi_info(cx, self),\n+            \"wasm32\" => match cx.target_spec().os.as_str() {\n+                \"emscripten\" | \"wasi\" => wasm32::compute_abi_info(cx, self),\n+                _ => wasm32_bindgen_compat::compute_abi_info(self),\n+            },\n+            \"asmjs\" => wasm32::compute_abi_info(cx, self),\n             a => return Err(format!(\"unrecognized arch \\\"{}\\\" in target specification\", a)),\n         }\n "}, {"sha": "abc96eb3322ec528a5301d44cb1d0eb354a94752", "filename": "compiler/rustc_target/src/spec/mod.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5ba3be1d60618fcd7fb819fdee4590ec048f190f/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5ba3be1d60618fcd7fb819fdee4590ec048f190f/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Fmod.rs?ref=5ba3be1d60618fcd7fb819fdee4590ec048f190f", "patch": "@@ -613,7 +613,6 @@ supported_targets! {\n     (\"thumbv7a-uwp-windows-msvc\", thumbv7a_uwp_windows_msvc),\n \n     (\"asmjs-unknown-emscripten\", asmjs_unknown_emscripten),\n-    (\"wasm32-unknown-bindgen\", wasm32_unknown_bindgen),\n     (\"wasm32-unknown-emscripten\", wasm32_unknown_emscripten),\n     (\"wasm32-unknown-unknown\", wasm32_unknown_unknown),\n     (\"wasm32-wasi\", wasm32_wasi),"}, {"sha": "67163fcb4175cbdb4f721c90c937ab8e664f0dc3", "filename": "compiler/rustc_target/src/spec/wasm32_unknown_bindgen.rs", "status": "removed", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/8f64cec02234a8971d547e7c610015fabc87162e/compiler%2Frustc_target%2Fsrc%2Fspec%2Fwasm32_unknown_bindgen.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8f64cec02234a8971d547e7c610015fabc87162e/compiler%2Frustc_target%2Fsrc%2Fspec%2Fwasm32_unknown_bindgen.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Fwasm32_unknown_bindgen.rs?ref=8f64cec02234a8971d547e7c610015fabc87162e", "patch": "@@ -1,9 +0,0 @@\n-//! This target is a variant of `wasm32-unknown-unknown` which uses the bindgen\n-//! ABI instead of the normal ABI.\n-use super::{wasm32_unknown_unknown, Target};\n-\n-pub fn target() -> Target {\n-    let mut target = wasm32_unknown_unknown::target();\n-    target.options.os = \"bindgen\".to_string();\n-    target\n-}"}, {"sha": "ce8caae375e98263d260604566374816826724a9", "filename": "src/doc/rustc/src/platform-support.md", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5ba3be1d60618fcd7fb819fdee4590ec048f190f/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md", "raw_url": "https://github.com/rust-lang/rust/raw/5ba3be1d60618fcd7fb819fdee4590ec048f190f/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Fplatform-support.md?ref=5ba3be1d60618fcd7fb819fdee4590ec048f190f", "patch": "@@ -126,7 +126,6 @@ target | std | host | notes\n `thumbv8m.base-none-eabi` | * |  | ARMv8-M Baseline\n `thumbv8m.main-none-eabi` | * |  | ARMv8-M Mainline\n `thumbv8m.main-none-eabihf` | * |  | ARMv8-M Mainline, hardfloat\n-`wasm32-unknown-bindgen` | \u2713 |  | WebAssembly via wasm-bindgen\n `wasm32-unknown-emscripten` | \u2713 |  | WebAssembly via Emscripten\n `wasm32-unknown-unknown` | \u2713 |  | WebAssembly\n `wasm32-wasi` | \u2713 |  | WebAssembly with WASI"}]}