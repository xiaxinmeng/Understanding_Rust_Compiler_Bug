{"sha": "f435f7185b634733834a61418dc4cba6a58aa1ec", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY0MzVmNzE4NWI2MzQ3MzM4MzRhNjE0MThkYzRjYmE2YTU4YWExZWM=", "commit": {"author": {"name": "Joshua Nelson", "email": "jyn514@gmail.com", "date": "2021-04-22T23:27:37Z"}, "committer": {"name": "Joshua Nelson", "email": "jyn514@gmail.com", "date": "2021-04-22T23:27:37Z"}, "message": "Remove unnecessary `crate_name` parameter to `after_krate`\n\nIt's always `tcx.crate_name(LOCAL_CRATE)`, it doesn't need to be passed\nin separately.", "tree": {"sha": "f630412571c4115aa8d06806b1986965f649d5ef", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f630412571c4115aa8d06806b1986965f649d5ef"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f435f7185b634733834a61418dc4cba6a58aa1ec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f435f7185b634733834a61418dc4cba6a58aa1ec", "html_url": "https://github.com/rust-lang/rust/commit/f435f7185b634733834a61418dc4cba6a58aa1ec", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f435f7185b634733834a61418dc4cba6a58aa1ec/comments", "author": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "25c15cdbe070f49d708f34750df2632e38bd4846", "url": "https://api.github.com/repos/rust-lang/rust/commits/25c15cdbe070f49d708f34750df2632e38bd4846", "html_url": "https://github.com/rust-lang/rust/commit/25c15cdbe070f49d708f34750df2632e38bd4846"}], "stats": {"total": 26, "additions": 7, "deletions": 19}, "files": [{"sha": "94f860739dfe43cb43b435af10478facb51d0770", "filename": "src/librustdoc/formats/renderer.rs", "status": "modified", "additions": 2, "deletions": 7, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/f435f7185b634733834a61418dc4cba6a58aa1ec/src%2Flibrustdoc%2Fformats%2Frenderer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f435f7185b634733834a61418dc4cba6a58aa1ec/src%2Flibrustdoc%2Fformats%2Frenderer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fformats%2Frenderer.rs?ref=f435f7185b634733834a61418dc4cba6a58aa1ec", "patch": "@@ -43,11 +43,7 @@ crate trait FormatRenderer<'tcx>: Sized {\n     /// Post processing hook for cleanup and dumping output to files.\n     ///\n     /// A handler is available if the renderer wants to report errors.\n-    fn after_krate(\n-        &mut self,\n-        crate_name: Symbol,\n-        diag: &rustc_errors::Handler,\n-    ) -> Result<(), Error>;\n+    fn after_krate(&mut self, diag: &rustc_errors::Handler) -> Result<(), Error>;\n \n     fn cache(&self) -> &Cache;\n }\n@@ -73,7 +69,6 @@ crate fn run_format<'tcx, T: FormatRenderer<'tcx>>(\n     }\n \n     // Render the crate documentation\n-    let crate_name = krate.name;\n     let mut work = vec![(format_renderer.make_child_renderer(), krate.module)];\n \n     let unknown = Symbol::intern(\"<unknown item>\");\n@@ -106,5 +101,5 @@ crate fn run_format<'tcx, T: FormatRenderer<'tcx>>(\n         }\n     }\n     prof.extra_verbose_generic_activity(\"renderer_after_krate\", T::descr())\n-        .run(|| format_renderer.after_krate(crate_name, diag))\n+        .run(|| format_renderer.after_krate(diag))\n }"}, {"sha": "9a4d02114ccafdc2acc176ca9900419409954858", "filename": "src/librustdoc/html/render/context.rs", "status": "modified", "additions": 3, "deletions": 6, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/f435f7185b634733834a61418dc4cba6a58aa1ec/src%2Flibrustdoc%2Fhtml%2Frender%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f435f7185b634733834a61418dc4cba6a58aa1ec/src%2Flibrustdoc%2Fhtml%2Frender%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fcontext.rs?ref=f435f7185b634733834a61418dc4cba6a58aa1ec", "patch": "@@ -11,7 +11,7 @@ use rustc_middle::ty::TyCtxt;\n use rustc_session::Session;\n use rustc_span::edition::Edition;\n use rustc_span::source_map::FileName;\n-use rustc_span::{symbol::sym, Symbol};\n+use rustc_span::symbol::sym;\n \n use super::cache::{build_index, ExternalLocation};\n use super::print_item::{full_path, item_path, print_item};\n@@ -494,11 +494,8 @@ impl<'tcx> FormatRenderer<'tcx> for Context<'tcx> {\n         }\n     }\n \n-    fn after_krate(\n-        &mut self,\n-        crate_name: Symbol,\n-        diag: &rustc_errors::Handler,\n-    ) -> Result<(), Error> {\n+    fn after_krate(&mut self, diag: &rustc_errors::Handler) -> Result<(), Error> {\n+        let crate_name = self.tcx().crate_name(LOCAL_CRATE);\n         let final_file = self.dst.join(&*crate_name.as_str()).join(\"all.html\");\n         let settings_file = self.dst.join(\"settings.html\");\n "}, {"sha": "da5a6d7af13e65efd62a81cf47e06a02190dd90c", "filename": "src/librustdoc/json/mod.rs", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/f435f7185b634733834a61418dc4cba6a58aa1ec/src%2Flibrustdoc%2Fjson%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f435f7185b634733834a61418dc4cba6a58aa1ec/src%2Flibrustdoc%2Fjson%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fjson%2Fmod.rs?ref=f435f7185b634733834a61418dc4cba6a58aa1ec", "patch": "@@ -14,7 +14,7 @@ use std::rc::Rc;\n use rustc_data_structures::fx::FxHashMap;\n use rustc_middle::ty::TyCtxt;\n use rustc_session::Session;\n-use rustc_span::{edition::Edition, Symbol};\n+use rustc_span::edition::Edition;\n \n use rustdoc_json_types as types;\n \n@@ -204,11 +204,7 @@ impl<'tcx> FormatRenderer<'tcx> for JsonRenderer<'tcx> {\n         Ok(())\n     }\n \n-    fn after_krate(\n-        &mut self,\n-        _crate_name: Symbol,\n-        _diag: &rustc_errors::Handler,\n-    ) -> Result<(), Error> {\n+    fn after_krate(&mut self, _diag: &rustc_errors::Handler) -> Result<(), Error> {\n         debug!(\"Done with crate\");\n         let mut index = (*self.index).clone().into_inner();\n         index.extend(self.get_trait_items());"}]}