{"sha": "649c648d6f0627df9ac272b1505e363c7dbd656f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY0OWM2NDhkNmYwNjI3ZGY5YWMyNzJiMTUwNWUzNjNjN2RiZDY1NmY=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2014-01-03T02:39:51Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2014-01-03T02:46:29Z"}, "message": "Abort on double-failure. #910\n\nPreviously this was an rtabort!, indicating a runtime bug. Promote\nthis to a more intentional abort and print a (slightly) more\ninformative error message.\n\nCan't test this sense our test suite can't handle an abort exit.", "tree": {"sha": "4678023fef48d87b0b7b06bcd39e9ac88df7fc7e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4678023fef48d87b0b7b06bcd39e9ac88df7fc7e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/649c648d6f0627df9ac272b1505e363c7dbd656f", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/649c648d6f0627df9ac272b1505e363c7dbd656f", "html_url": "https://github.com/rust-lang/rust/commit/649c648d6f0627df9ac272b1505e363c7dbd656f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/649c648d6f0627df9ac272b1505e363c7dbd656f/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "27ce4d3f79cdc021a6bfe0f7009977e07a368770", "url": "https://api.github.com/repos/rust-lang/rust/commits/27ce4d3f79cdc021a6bfe0f7009977e07a368770", "html_url": "https://github.com/rust-lang/rust/commit/27ce4d3f79cdc021a6bfe0f7009977e07a368770"}], "stats": {"total": 14, "additions": 9, "deletions": 5}, "files": [{"sha": "ea592d1fde557eab1cfeddaedde63922b417a639", "filename": "doc/rust.md", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/649c648d6f0627df9ac272b1505e363c7dbd656f/doc%2Frust.md", "raw_url": "https://github.com/rust-lang/rust/raw/649c648d6f0627df9ac272b1505e363c7dbd656f/doc%2Frust.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/doc%2Frust.md?ref=649c648d6f0627df9ac272b1505e363c7dbd656f", "patch": "@@ -3605,10 +3605,8 @@ failed destructor. Nonetheless, the outermost unwinding activity will continue\n until the stack is unwound and the task transitions to the *dead*\n state. There is no way to \"recover\" from task failure.  Once a task has\n temporarily suspended its unwinding in the *failing* state, failure\n-occurring from within this destructor results in *hard* failure.  The\n-unwinding procedure of hard failure frees resources but does not execute\n-destructors.  The original (soft) failure is still resumed at the point where\n-it was temporarily suspended.\n+occurring from within this destructor results in *hard* failure.\n+A hard failure currently results in the process aborting.\n \n A task in the *dead* state cannot transition to other states; it exists\n only to have its termination status inspected by other tasks, and/or to await"}, {"sha": "6be4ab97ee3e560a2e16104cdd10ffa00c44c703", "filename": "src/libstd/rt/unwind.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/649c648d6f0627df9ac272b1505e363c7dbd656f/src%2Flibstd%2Frt%2Funwind.rs", "raw_url": "https://github.com/rust-lang/rust/raw/649c648d6f0627df9ac272b1505e363c7dbd656f/src%2Flibstd%2Frt%2Funwind.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Frt%2Funwind.rs?ref=649c648d6f0627df9ac272b1505e363c7dbd656f", "patch": "@@ -354,7 +354,13 @@ pub fn begin_unwind<M: Any + Send>(msg: M, file: &'static str, line: uint) -> !\n             }\n \n             if (*task).unwinder.unwinding {\n-                rtabort!(\"unwinding again\");\n+                // If a task fails while it's already unwinding then we\n+                // have limited options. Currently our preference is to\n+                // just abort. In the future we may consider resuming\n+                // unwinding or otherwise exiting the task cleanly.\n+                rterrln!(\"task failed during unwinding (double-failure - total drag!)\")\n+                rterrln!(\"rust must abort now. so sorry.\");\n+                intrinsics::abort();\n             }\n         }\n "}]}