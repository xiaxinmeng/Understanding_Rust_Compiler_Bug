{"sha": "210e829010022d2a8e49a2519aec8ac6bee20ed1", "node_id": "C_kwDOAAsO6NoAKDIxMGU4MjkwMTAwMjJkMmE4ZTQ5YTI1MTlhZWM4YWM2YmVlMjBlZDE", "commit": {"author": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-03-04T06:04:23Z"}, "committer": {"name": "Michael Goulet", "email": "michael@errs.io", "date": "2022-03-04T06:04:23Z"}, "message": "add tests for metadata for unsized generics and opaques", "tree": {"sha": "bfc3fe177009aaf61a02738c118b1d92ed6b2015", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bfc3fe177009aaf61a02738c118b1d92ed6b2015"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/210e829010022d2a8e49a2519aec8ac6bee20ed1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/210e829010022d2a8e49a2519aec8ac6bee20ed1", "html_url": "https://github.com/rust-lang/rust/commit/210e829010022d2a8e49a2519aec8ac6bee20ed1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/210e829010022d2a8e49a2519aec8ac6bee20ed1/comments", "author": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "compiler-errors", "id": 3674314, "node_id": "MDQ6VXNlcjM2NzQzMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3674314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/compiler-errors", "html_url": "https://github.com/compiler-errors", "followers_url": "https://api.github.com/users/compiler-errors/followers", "following_url": "https://api.github.com/users/compiler-errors/following{/other_user}", "gists_url": "https://api.github.com/users/compiler-errors/gists{/gist_id}", "starred_url": "https://api.github.com/users/compiler-errors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/compiler-errors/subscriptions", "organizations_url": "https://api.github.com/users/compiler-errors/orgs", "repos_url": "https://api.github.com/users/compiler-errors/repos", "events_url": "https://api.github.com/users/compiler-errors/events{/privacy}", "received_events_url": "https://api.github.com/users/compiler-errors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1d834cb657d4911535a01af38e974d11d081e9f4", "url": "https://api.github.com/repos/rust-lang/rust/commits/1d834cb657d4911535a01af38e974d11d081e9f4", "html_url": "https://github.com/rust-lang/rust/commit/1d834cb657d4911535a01af38e974d11d081e9f4"}], "stats": {"total": 62, "additions": 62, "deletions": 0}, "files": [{"sha": "d081721aca275089adc8018be92c77150abf81ff", "filename": "src/test/ui/traits/pointee-tail-is-generic-errors.rs", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/210e829010022d2a8e49a2519aec8ac6bee20ed1/src%2Ftest%2Fui%2Ftraits%2Fpointee-tail-is-generic-errors.rs", "raw_url": "https://github.com/rust-lang/rust/raw/210e829010022d2a8e49a2519aec8ac6bee20ed1/src%2Ftest%2Fui%2Ftraits%2Fpointee-tail-is-generic-errors.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Fpointee-tail-is-generic-errors.rs?ref=210e829010022d2a8e49a2519aec8ac6bee20ed1", "patch": "@@ -0,0 +1,22 @@\n+// edition:2018\n+\n+#![feature(ptr_metadata)]\n+#![feature(type_alias_impl_trait)]\n+\n+type Opaque = impl std::fmt::Debug + ?Sized;\n+\n+fn opaque() -> &'static Opaque {\n+    &[1] as &[i32]\n+}\n+\n+fn a<T: ?Sized>() {\n+    is_thin::<T>();\n+    //~^ ERROR type mismatch resolving `<T as Pointee>::Metadata == ()`\n+\n+    is_thin::<Opaque>();\n+    //~^ ERROR type mismatch resolving `<impl Debug + ?Sized as Pointee>::Metadata == ()`\n+}\n+\n+fn is_thin<T: std::ptr::Pointee<Metadata = ()> + ?Sized>() {}\n+\n+fn main() {}"}, {"sha": "fa5fe67e53cb6b57232da0337e6412f23e697983", "filename": "src/test/ui/traits/pointee-tail-is-generic-errors.stderr", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/210e829010022d2a8e49a2519aec8ac6bee20ed1/src%2Ftest%2Fui%2Ftraits%2Fpointee-tail-is-generic-errors.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/210e829010022d2a8e49a2519aec8ac6bee20ed1/src%2Ftest%2Fui%2Ftraits%2Fpointee-tail-is-generic-errors.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftraits%2Fpointee-tail-is-generic-errors.stderr?ref=210e829010022d2a8e49a2519aec8ac6bee20ed1", "patch": "@@ -0,0 +1,40 @@\n+error[E0271]: type mismatch resolving `<T as Pointee>::Metadata == ()`\n+  --> $DIR/pointee-tail-is-generic-errors.rs:13:5\n+   |\n+LL |     is_thin::<T>();\n+   |     ^^^^^^^^^^^^ expected `()`, found associated type\n+   |\n+   = note:    expected unit type `()`\n+           found associated type `<T as Pointee>::Metadata`\n+   = help: consider constraining the associated type `<T as Pointee>::Metadata` to `()`\n+   = note: for more information, visit https://doc.rust-lang.org/book/ch19-03-advanced-traits.html\n+note: required by a bound in `is_thin`\n+  --> $DIR/pointee-tail-is-generic-errors.rs:20:33\n+   |\n+LL | fn is_thin<T: std::ptr::Pointee<Metadata = ()> + ?Sized>() {}\n+   |                                 ^^^^^^^^^^^^^ required by this bound in `is_thin`\n+\n+error[E0271]: type mismatch resolving `<impl Debug + ?Sized as Pointee>::Metadata == ()`\n+  --> $DIR/pointee-tail-is-generic-errors.rs:16:5\n+   |\n+LL | type Opaque = impl std::fmt::Debug + ?Sized;\n+   |               ----------------------------- the found opaque type\n+...\n+LL |     is_thin::<Opaque>();\n+   |     ^^^^^^^^^^^^^^^^^ expected `()`, found associated type\n+   |\n+   = note:    expected unit type `()`\n+           found associated type `<impl Debug + ?Sized as Pointee>::Metadata`\n+note: required by a bound in `is_thin`\n+  --> $DIR/pointee-tail-is-generic-errors.rs:20:33\n+   |\n+LL | fn is_thin<T: std::ptr::Pointee<Metadata = ()> + ?Sized>() {}\n+   |                                 ^^^^^^^^^^^^^ required by this bound in `is_thin`\n+help: consider constraining the associated type `<impl Debug + ?Sized as Pointee>::Metadata` to `()`\n+   |\n+LL | type Opaque = impl std::fmt::Debug<Metadata = ()> + ?Sized;\n+   |                                   +++++++++++++++\n+\n+error: aborting due to 2 previous errors\n+\n+For more information about this error, try `rustc --explain E0271`."}]}