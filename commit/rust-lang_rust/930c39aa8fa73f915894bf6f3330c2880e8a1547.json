{"sha": "930c39aa8fa73f915894bf6f3330c2880e8a1547", "node_id": "C_kwDOAAsO6NoAKDkzMGMzOWFhOGZhNzNmOTE1ODk0YmY2ZjMzMzBjMjg4MGU4YTE1NDc", "commit": {"author": {"name": "b-naber", "email": "b_naber@gmx.de", "date": "2023-04-28T07:17:19Z"}, "committer": {"name": "b-naber", "email": "b_naber@gmx.de", "date": "2023-04-28T07:17:19Z"}, "message": "dont expect normalization to succeed in elaborate_drops", "tree": {"sha": "ffac430abd26e47d866bdc6b29c2ee3cd21f8a1e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ffac430abd26e47d866bdc6b29c2ee3cd21f8a1e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/930c39aa8fa73f915894bf6f3330c2880e8a1547", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/930c39aa8fa73f915894bf6f3330c2880e8a1547", "html_url": "https://github.com/rust-lang/rust/commit/930c39aa8fa73f915894bf6f3330c2880e8a1547", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/930c39aa8fa73f915894bf6f3330c2880e8a1547/comments", "author": {"login": "b-naber", "id": 71934879, "node_id": "MDQ6VXNlcjcxOTM0ODc5", "avatar_url": "https://avatars.githubusercontent.com/u/71934879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/b-naber", "html_url": "https://github.com/b-naber", "followers_url": "https://api.github.com/users/b-naber/followers", "following_url": "https://api.github.com/users/b-naber/following{/other_user}", "gists_url": "https://api.github.com/users/b-naber/gists{/gist_id}", "starred_url": "https://api.github.com/users/b-naber/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/b-naber/subscriptions", "organizations_url": "https://api.github.com/users/b-naber/orgs", "repos_url": "https://api.github.com/users/b-naber/repos", "events_url": "https://api.github.com/users/b-naber/events{/privacy}", "received_events_url": "https://api.github.com/users/b-naber/received_events", "type": "User", "site_admin": false}, "committer": {"login": "b-naber", "id": 71934879, "node_id": "MDQ6VXNlcjcxOTM0ODc5", "avatar_url": "https://avatars.githubusercontent.com/u/71934879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/b-naber", "html_url": "https://github.com/b-naber", "followers_url": "https://api.github.com/users/b-naber/followers", "following_url": "https://api.github.com/users/b-naber/following{/other_user}", "gists_url": "https://api.github.com/users/b-naber/gists{/gist_id}", "starred_url": "https://api.github.com/users/b-naber/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/b-naber/subscriptions", "organizations_url": "https://api.github.com/users/b-naber/orgs", "repos_url": "https://api.github.com/users/b-naber/repos", "events_url": "https://api.github.com/users/b-naber/events{/privacy}", "received_events_url": "https://api.github.com/users/b-naber/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c14882f74e8feb3f76ae85ed5cd66afaccd1da67", "url": "https://api.github.com/repos/rust-lang/rust/commits/c14882f74e8feb3f76ae85ed5cd66afaccd1da67", "html_url": "https://github.com/rust-lang/rust/commit/c14882f74e8feb3f76ae85ed5cd66afaccd1da67"}], "stats": {"total": 12, "additions": 9, "deletions": 3}, "files": [{"sha": "e2f538e22b754fc39d7b917a3602deab12c0fd27", "filename": "compiler/rustc_mir_dataflow/src/elaborate_drops.rs", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/930c39aa8fa73f915894bf6f3330c2880e8a1547/compiler%2Frustc_mir_dataflow%2Fsrc%2Felaborate_drops.rs", "raw_url": "https://github.com/rust-lang/rust/raw/930c39aa8fa73f915894bf6f3330c2880e8a1547/compiler%2Frustc_mir_dataflow%2Fsrc%2Felaborate_drops.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_dataflow%2Fsrc%2Felaborate_drops.rs?ref=930c39aa8fa73f915894bf6f3330c2880e8a1547", "patch": "@@ -272,10 +272,16 @@ where\n                 let field = FieldIdx::new(i);\n                 let subpath = self.elaborator.field_subpath(variant_path, field);\n                 let tcx = self.tcx();\n-\n                 assert_eq!(self.elaborator.param_env().reveal(), Reveal::All);\n-                let field_ty =\n-                    tcx.normalize_erasing_regions(self.elaborator.param_env(), f.ty(tcx, substs));\n+\n+                let fty = f.ty(tcx, substs);\n+                let field_ty = match tcx\n+                    .try_normalize_erasing_regions(self.elaborator.param_env(), f.ty(tcx, substs))\n+                {\n+                    Ok(f_ty) => f_ty,\n+                    Err(_) => fty,\n+                };\n+\n                 (tcx.mk_place_field(base_place, field, field_ty), subpath)\n             })\n             .collect()"}]}