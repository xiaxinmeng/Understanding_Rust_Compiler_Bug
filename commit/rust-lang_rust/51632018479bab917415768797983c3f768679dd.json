{"sha": "51632018479bab917415768797983c3f768679dd", "node_id": "C_kwDOAAsO6NoAKDUxNjMyMDE4NDc5YmFiOTE3NDE1NzY4Nzk3OTgzYzNmNzY4Njc5ZGQ", "commit": {"author": {"name": "hamidreza kalbasi", "email": "hamidrezakalbasi@protonmail.com", "date": "2021-09-08T15:56:06Z"}, "committer": {"name": "hamidreza kalbasi", "email": "hamidrezakalbasi@protonmail.com", "date": "2021-09-26T06:34:02Z"}, "message": "use utf16 instead of utf8", "tree": {"sha": "eb7ddbd616bc859b963bca8f980f08e09178368b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/eb7ddbd616bc859b963bca8f980f08e09178368b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/51632018479bab917415768797983c3f768679dd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/51632018479bab917415768797983c3f768679dd", "html_url": "https://github.com/rust-lang/rust/commit/51632018479bab917415768797983c3f768679dd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/51632018479bab917415768797983c3f768679dd/comments", "author": {"login": "HKalbasi", "id": 45197576, "node_id": "MDQ6VXNlcjQ1MTk3NTc2", "avatar_url": "https://avatars.githubusercontent.com/u/45197576?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HKalbasi", "html_url": "https://github.com/HKalbasi", "followers_url": "https://api.github.com/users/HKalbasi/followers", "following_url": "https://api.github.com/users/HKalbasi/following{/other_user}", "gists_url": "https://api.github.com/users/HKalbasi/gists{/gist_id}", "starred_url": "https://api.github.com/users/HKalbasi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HKalbasi/subscriptions", "organizations_url": "https://api.github.com/users/HKalbasi/orgs", "repos_url": "https://api.github.com/users/HKalbasi/repos", "events_url": "https://api.github.com/users/HKalbasi/events{/privacy}", "received_events_url": "https://api.github.com/users/HKalbasi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "HKalbasi", "id": 45197576, "node_id": "MDQ6VXNlcjQ1MTk3NTc2", "avatar_url": "https://avatars.githubusercontent.com/u/45197576?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HKalbasi", "html_url": "https://github.com/HKalbasi", "followers_url": "https://api.github.com/users/HKalbasi/followers", "following_url": "https://api.github.com/users/HKalbasi/following{/other_user}", "gists_url": "https://api.github.com/users/HKalbasi/gists{/gist_id}", "starred_url": "https://api.github.com/users/HKalbasi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HKalbasi/subscriptions", "organizations_url": "https://api.github.com/users/HKalbasi/orgs", "repos_url": "https://api.github.com/users/HKalbasi/repos", "events_url": "https://api.github.com/users/HKalbasi/events{/privacy}", "received_events_url": "https://api.github.com/users/HKalbasi/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "557210a68839286ebafa1e1565b978566b38a6f1", "url": "https://api.github.com/repos/rust-lang/rust/commits/557210a68839286ebafa1e1565b978566b38a6f1", "html_url": "https://github.com/rust-lang/rust/commit/557210a68839286ebafa1e1565b978566b38a6f1"}], "stats": {"total": 20, "additions": 12, "deletions": 8}, "files": [{"sha": "806230544f3b461f746d0728977f10dd5ac443b3", "filename": "crates/ide/src/static_index.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/51632018479bab917415768797983c3f768679dd/crates%2Fide%2Fsrc%2Fstatic_index.rs", "raw_url": "https://github.com/rust-lang/rust/raw/51632018479bab917415768797983c3f768679dd/crates%2Fide%2Fsrc%2Fstatic_index.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fstatic_index.rs?ref=51632018479bab917415768797983c3f768679dd", "patch": "@@ -1,3 +1,6 @@\n+//! This module provides `StaticIndex` which is used for powering\n+//! read-only code browsers and emitting LSIF\n+\n use hir::{db::HirDatabase, Crate, Module};\n use ide_db::base_db::{FileId, SourceDatabaseExt};\n use ide_db::RootDatabase;"}, {"sha": "2ba965a15d403172d49f8dd4eef5cabdbc6ccc52", "filename": "crates/rust-analyzer/src/cli/lsif.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/51632018479bab917415768797983c3f768679dd/crates%2Frust-analyzer%2Fsrc%2Fcli%2Flsif.rs", "raw_url": "https://github.com/rust-lang/rust/raw/51632018479bab917415768797983c3f768679dd/crates%2Frust-analyzer%2Fsrc%2Fcli%2Flsif.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fcli%2Flsif.rs?ref=51632018479bab917415768797983c3f768679dd", "patch": "@@ -16,7 +16,7 @@ use crate::cli::{\n     load_cargo::{load_workspace, LoadCargoConfig},\n     Result,\n };\n-use crate::line_index::LineIndex;\n+use crate::line_index::{LineEndings, LineIndex, OffsetEncoding};\n use crate::to_proto;\n \n /// Need to wrap Snapshot to provide `Clone` impl for `map_with`\n@@ -99,7 +99,11 @@ impl flags::Lsif {\n                 .map(|it| {\n                     to_proto::folding_range(\n                         &*text,\n-                        &LineIndex::with_default_options(line_index.clone()),\n+                        &LineIndex {\n+                            index: line_index.clone(),\n+                            encoding: OffsetEncoding::Utf16,\n+                            endings: LineEndings::Unix,\n+                        },\n                         false,\n                         it,\n                     )"}, {"sha": "d84155d8a5b8dc90836a456665e0e23951cfb353", "filename": "crates/rust-analyzer/src/cli/lsif/lsif_types.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/51632018479bab917415768797983c3f768679dd/crates%2Frust-analyzer%2Fsrc%2Fcli%2Flsif%2Flsif_types.rs", "raw_url": "https://github.com/rust-lang/rust/raw/51632018479bab917415768797983c3f768679dd/crates%2Frust-analyzer%2Fsrc%2Fcli%2Flsif%2Flsif_types.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fcli%2Flsif%2Flsif_types.rs?ref=51632018479bab917415768797983c3f768679dd", "patch": "@@ -1,3 +1,6 @@\n+//! This module provides LSIF types. This module is a temporary solution\n+//! and it will go to its own repository in future\n+\n use lsp_types::FoldingRange;\n use serde::{Deserialize, Serialize};\n "}, {"sha": "c116414da01df110b7e20b21d0ebb4aa248b8d5a", "filename": "crates/rust-analyzer/src/line_index.rs", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/51632018479bab917415768797983c3f768679dd/crates%2Frust-analyzer%2Fsrc%2Fline_index.rs", "raw_url": "https://github.com/rust-lang/rust/raw/51632018479bab917415768797983c3f768679dd/crates%2Frust-analyzer%2Fsrc%2Fline_index.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fline_index.rs?ref=51632018479bab917415768797983c3f768679dd", "patch": "@@ -18,12 +18,6 @@ pub(crate) struct LineIndex {\n     pub(crate) encoding: OffsetEncoding,\n }\n \n-impl LineIndex {\n-    pub(crate) fn with_default_options(index: Arc<ide::LineIndex>) -> Self {\n-        Self { index, endings: LineEndings::Unix, encoding: OffsetEncoding::Utf8 }\n-    }\n-}\n-\n #[derive(Debug, Clone, Copy, PartialEq, Eq, PartialOrd, Ord, Hash)]\n pub(crate) enum LineEndings {\n     Unix,"}]}