{"sha": "d452744100203c9f75202079ce7c8ad8aa1bdf02", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ0NTI3NDQxMDAyMDNjOWY3NTIwMjA3OWNlN2M4YWQ4YWExYmRmMDI=", "commit": {"author": {"name": "Bastian Kauschke", "email": "bastian_kauschke@hotmail.de", "date": "2020-09-21T21:48:39Z"}, "committer": {"name": "Bastian Kauschke", "email": "bastian_kauschke@hotmail.de", "date": "2020-09-21T22:02:46Z"}, "message": "lint missing docs for extern items", "tree": {"sha": "29f41b0f016e2fc12be81d9a522ee3b6d7835231", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/29f41b0f016e2fc12be81d9a522ee3b6d7835231"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d452744100203c9f75202079ce7c8ad8aa1bdf02", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d452744100203c9f75202079ce7c8ad8aa1bdf02", "html_url": "https://github.com/rust-lang/rust/commit/d452744100203c9f75202079ce7c8ad8aa1bdf02", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d452744100203c9f75202079ce7c8ad8aa1bdf02/comments", "author": {"login": "lcnr", "id": 29864074, "node_id": "MDQ6VXNlcjI5ODY0MDc0", "avatar_url": "https://avatars.githubusercontent.com/u/29864074?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lcnr", "html_url": "https://github.com/lcnr", "followers_url": "https://api.github.com/users/lcnr/followers", "following_url": "https://api.github.com/users/lcnr/following{/other_user}", "gists_url": "https://api.github.com/users/lcnr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lcnr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lcnr/subscriptions", "organizations_url": "https://api.github.com/users/lcnr/orgs", "repos_url": "https://api.github.com/users/lcnr/repos", "events_url": "https://api.github.com/users/lcnr/events{/privacy}", "received_events_url": "https://api.github.com/users/lcnr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lcnr", "id": 29864074, "node_id": "MDQ6VXNlcjI5ODY0MDc0", "avatar_url": "https://avatars.githubusercontent.com/u/29864074?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lcnr", "html_url": "https://github.com/lcnr", "followers_url": "https://api.github.com/users/lcnr/followers", "following_url": "https://api.github.com/users/lcnr/following{/other_user}", "gists_url": "https://api.github.com/users/lcnr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lcnr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lcnr/subscriptions", "organizations_url": "https://api.github.com/users/lcnr/orgs", "repos_url": "https://api.github.com/users/lcnr/repos", "events_url": "https://api.github.com/users/lcnr/events{/privacy}", "received_events_url": "https://api.github.com/users/lcnr/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b01326ab033e41986d4a5c8b96ce4f40f3b38e30", "url": "https://api.github.com/repos/rust-lang/rust/commits/b01326ab033e41986d4a5c8b96ce4f40f3b38e30", "html_url": "https://github.com/rust-lang/rust/commit/b01326ab033e41986d4a5c8b96ce4f40f3b38e30"}], "stats": {"total": 52, "additions": 50, "deletions": 2}, "files": [{"sha": "abd899e8db4d33b6d9447bc7078dd15d296281b1", "filename": "compiler/rustc_lint/src/builtin.rs", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/d452744100203c9f75202079ce7c8ad8aa1bdf02/compiler%2Frustc_lint%2Fsrc%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d452744100203c9f75202079ce7c8ad8aa1bdf02/compiler%2Frustc_lint%2Fsrc%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Fbuiltin.rs?ref=d452744100203c9f75202079ce7c8ad8aa1bdf02", "patch": "@@ -613,6 +613,19 @@ impl<'tcx> LateLintPass<'tcx> for MissingDoc {\n         );\n     }\n \n+    fn check_foreign_item(&mut self, cx: &LateContext<'_>, foreign_item: &hir::ForeignItem<'_>) {\n+        let def_id = cx.tcx.hir().local_def_id(foreign_item.hir_id);\n+        let (article, desc) = cx.tcx.article_and_description(def_id.to_def_id());\n+        self.check_missing_docs_attrs(\n+            cx,\n+            Some(foreign_item.hir_id),\n+            &foreign_item.attrs,\n+            foreign_item.span,\n+            article,\n+            desc,\n+        );\n+    }\n+\n     fn check_struct_field(&mut self, cx: &LateContext<'_>, sf: &hir::StructField<'_>) {\n         if !sf.is_positional() {\n             self.check_missing_docs_attrs("}, {"sha": "2297257919ee14cbb52fe5e1d42a2a14240bda41", "filename": "src/test/ui/lint/lint-missing-doc.rs", "status": "modified", "additions": 18, "deletions": 1, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/d452744100203c9f75202079ce7c8ad8aa1bdf02/src%2Ftest%2Fui%2Flint%2Flint-missing-doc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d452744100203c9f75202079ce7c8ad8aa1bdf02/src%2Ftest%2Fui%2Flint%2Flint-missing-doc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-missing-doc.rs?ref=d452744100203c9f75202079ce7c8ad8aa1bdf02", "patch": "@@ -2,7 +2,7 @@\n // injected intrinsics by the compiler.\n #![deny(missing_docs)]\n #![allow(dead_code)]\n-#![feature(associated_type_defaults)]\n+#![feature(associated_type_defaults, extern_types)]\n \n //! Some garbage docs for the crate here\n #![doc=\"More garbage\"]\n@@ -183,4 +183,21 @@ pub mod public_interface {\n     pub use internal_impl::globbed::*;\n }\n \n+extern \"C\" {\n+    /// dox\n+    pub fn extern_fn_documented(f: f32) -> f32;\n+    pub fn extern_fn_undocumented(f: f32) -> f32;\n+    //~^ ERROR: missing documentation for a function\n+\n+    /// dox\n+    pub static EXTERN_STATIC_DOCUMENTED: u8;\n+    pub static EXTERN_STATIC_UNDOCUMENTED: u8;\n+    //~^ ERROR: missing documentation for a static\n+\n+    /// dox\n+    pub type ExternTyDocumented;\n+    pub type ExternTyUndocumented;\n+    //~^ ERROR: missing documentation for a foreign type\n+}\n+\n fn main() {}"}, {"sha": "56f8fc10e862320f3e55d899aa4cb7b912c98427", "filename": "src/test/ui/lint/lint-missing-doc.stderr", "status": "modified", "additions": 19, "deletions": 1, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/d452744100203c9f75202079ce7c8ad8aa1bdf02/src%2Ftest%2Fui%2Flint%2Flint-missing-doc.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d452744100203c9f75202079ce7c8ad8aa1bdf02/src%2Ftest%2Fui%2Flint%2Flint-missing-doc.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-missing-doc.stderr?ref=d452744100203c9f75202079ce7c8ad8aa1bdf02", "patch": "@@ -118,5 +118,23 @@ error: missing documentation for a function\n LL |         pub fn also_undocumented1() {}\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-error: aborting due to 19 previous errors\n+error: missing documentation for a function\n+  --> $DIR/lint-missing-doc.rs:189:5\n+   |\n+LL |     pub fn extern_fn_undocumented(f: f32) -> f32;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+error: missing documentation for a static\n+  --> $DIR/lint-missing-doc.rs:194:5\n+   |\n+LL |     pub static EXTERN_STATIC_UNDOCUMENTED: u8;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+error: missing documentation for a foreign type\n+  --> $DIR/lint-missing-doc.rs:199:5\n+   |\n+LL |     pub type ExternTyUndocumented;\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+error: aborting due to 22 previous errors\n "}]}