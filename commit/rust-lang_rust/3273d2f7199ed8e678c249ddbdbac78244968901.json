{"sha": "3273d2f7199ed8e678c249ddbdbac78244968901", "node_id": "MDY6Q29tbWl0NzI0NzEyOjMyNzNkMmY3MTk5ZWQ4ZTY3OGMyNDlkZGJkYmFjNzgyNDQ5Njg5MDE=", "commit": {"author": {"name": "Ali\u00e9nore Bouttefeux", "email": "alienore.bouttefeux@gmail.com", "date": "2021-04-30T10:36:22Z"}, "committer": {"name": "Ali\u00e9nore Bouttefeux", "email": "alienore.bouttefeux@gmail.com", "date": "2021-04-30T10:36:22Z"}, "message": "error when --no-run is present without --test", "tree": {"sha": "d0427577767b1f29e4307fec6a19faf2139e55d5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d0427577767b1f29e4307fec6a19faf2139e55d5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3273d2f7199ed8e678c249ddbdbac78244968901", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3273d2f7199ed8e678c249ddbdbac78244968901", "html_url": "https://github.com/rust-lang/rust/commit/3273d2f7199ed8e678c249ddbdbac78244968901", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3273d2f7199ed8e678c249ddbdbac78244968901/comments", "author": {"login": "ABouttefeux", "id": 77335613, "node_id": "MDQ6VXNlcjc3MzM1NjEz", "avatar_url": "https://avatars.githubusercontent.com/u/77335613?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ABouttefeux", "html_url": "https://github.com/ABouttefeux", "followers_url": "https://api.github.com/users/ABouttefeux/followers", "following_url": "https://api.github.com/users/ABouttefeux/following{/other_user}", "gists_url": "https://api.github.com/users/ABouttefeux/gists{/gist_id}", "starred_url": "https://api.github.com/users/ABouttefeux/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ABouttefeux/subscriptions", "organizations_url": "https://api.github.com/users/ABouttefeux/orgs", "repos_url": "https://api.github.com/users/ABouttefeux/repos", "events_url": "https://api.github.com/users/ABouttefeux/events{/privacy}", "received_events_url": "https://api.github.com/users/ABouttefeux/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ABouttefeux", "id": 77335613, "node_id": "MDQ6VXNlcjc3MzM1NjEz", "avatar_url": "https://avatars.githubusercontent.com/u/77335613?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ABouttefeux", "html_url": "https://github.com/ABouttefeux", "followers_url": "https://api.github.com/users/ABouttefeux/followers", "following_url": "https://api.github.com/users/ABouttefeux/following{/other_user}", "gists_url": "https://api.github.com/users/ABouttefeux/gists{/gist_id}", "starred_url": "https://api.github.com/users/ABouttefeux/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ABouttefeux/subscriptions", "organizations_url": "https://api.github.com/users/ABouttefeux/orgs", "repos_url": "https://api.github.com/users/ABouttefeux/repos", "events_url": "https://api.github.com/users/ABouttefeux/events{/privacy}", "received_events_url": "https://api.github.com/users/ABouttefeux/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "202659a43d2bf9444e3d14f5917bf9cc90f72b16", "url": "https://api.github.com/repos/rust-lang/rust/commits/202659a43d2bf9444e3d14f5917bf9cc90f72b16", "html_url": "https://github.com/rust-lang/rust/commit/202659a43d2bf9444e3d14f5917bf9cc90f72b16"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "76aa785636d2e9c51bed3cf1eb417045afa49d7c", "filename": "src/librustdoc/config.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/3273d2f7199ed8e678c249ddbdbac78244968901/src%2Flibrustdoc%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3273d2f7199ed8e678c249ddbdbac78244968901/src%2Flibrustdoc%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fconfig.rs?ref=3273d2f7199ed8e678c249ddbdbac78244968901", "patch": "@@ -459,6 +459,12 @@ impl Options {\n             test_args.iter().flat_map(|s| s.split_whitespace()).map(|s| s.to_string()).collect();\n \n         let should_test = matches.opt_present(\"test\");\n+        let no_run = matches.opt_present(\"no-run\");\n+\n+        if !should_test && no_run {\n+            diag.struct_err(\"option --no-run should be used with --test\").emit();\n+            return Err(1);\n+        }\n \n         let output =\n             matches.opt_str(\"o\").map(|s| PathBuf::from(&s)).unwrap_or_else(|| PathBuf::from(\"doc\"));\n@@ -629,7 +635,6 @@ impl Options {\n         let document_hidden = matches.opt_present(\"document-hidden-items\");\n         let run_check = matches.opt_present(\"check\");\n         let generate_redirect_map = matches.opt_present(\"generate-redirect-map\");\n-        let no_run = matches.opt_present(\"no-run\");\n \n         let (lint_opts, describe_lints, lint_cap) = get_cmd_lint_options(matches, error_format);\n "}, {"sha": "a42b5a9d684bb199ef93fdb339df49670798455a", "filename": "src/test/rustdoc-ui/no-run-flag-error.rs", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/3273d2f7199ed8e678c249ddbdbac78244968901/src%2Ftest%2Frustdoc-ui%2Fno-run-flag-error.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3273d2f7199ed8e678c249ddbdbac78244968901/src%2Ftest%2Frustdoc-ui%2Fno-run-flag-error.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fno-run-flag-error.rs?ref=3273d2f7199ed8e678c249ddbdbac78244968901", "patch": "@@ -0,0 +1,5 @@\n+// test the behavior of the --no-run flag without the --test flag\n+\n+// compile-flags:-Z unstable-options --no-run --test-args=--test-threads=1\n+\n+pub fn f() {}"}, {"sha": "3d34be8a4205ab6c83185138dcbfc566fc5c6ac6", "filename": "src/test/rustdoc-ui/no-run-flag-error.stderr", "status": "added", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3273d2f7199ed8e678c249ddbdbac78244968901/src%2Ftest%2Frustdoc-ui%2Fno-run-flag-error.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3273d2f7199ed8e678c249ddbdbac78244968901/src%2Ftest%2Frustdoc-ui%2Fno-run-flag-error.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-ui%2Fno-run-flag-error.stderr?ref=3273d2f7199ed8e678c249ddbdbac78244968901", "patch": "@@ -0,0 +1,2 @@\n+error: option --no-run should be used with --test\n+"}]}