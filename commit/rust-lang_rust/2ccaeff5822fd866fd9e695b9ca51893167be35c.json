{"sha": "2ccaeff5822fd866fd9e695b9ca51893167be35c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJjY2FlZmY1ODIyZmQ4NjZmZDllNjk1YjljYTUxODkzMTY3YmUzNWM=", "commit": {"author": {"name": "Tobias Schaffner", "email": "tschaff@genua.de", "date": "2017-08-16T09:06:58Z"}, "committer": {"name": "Tobias Schaffner", "email": "tschaff@genua.de", "date": "2017-08-16T11:27:20Z"}, "message": "Refactoring: move net specific fd imps to net\n\nMove the implementations of net specific file descriptior implementations\nto net. This makes it easier to exclude net at all if not needed for a\ntarget.", "tree": {"sha": "3ed5f509f8e93cc85d7827dc3e435010ec654a0d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3ed5f509f8e93cc85d7827dc3e435010ec654a0d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2ccaeff5822fd866fd9e695b9ca51893167be35c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2ccaeff5822fd866fd9e695b9ca51893167be35c", "html_url": "https://github.com/rust-lang/rust/commit/2ccaeff5822fd866fd9e695b9ca51893167be35c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2ccaeff5822fd866fd9e695b9ca51893167be35c/comments", "author": null, "committer": null, "parents": [{"sha": "4fc3765c5477f98cfdf325475b2b01c6c094ed2d", "url": "https://api.github.com/repos/rust-lang/rust/commits/4fc3765c5477f98cfdf325475b2b01c6c094ed2d", "html_url": "https://github.com/rust-lang/rust/commit/4fc3765c5477f98cfdf325475b2b01c6c094ed2d"}], "stats": {"total": 121, "additions": 62, "deletions": 59}, "files": [{"sha": "c9fe3590a64a05542c8946ba3308d9ce3e4ebba1", "filename": "src/libstd/sys/unix/ext/io.rs", "status": "modified", "additions": 1, "deletions": 56, "changes": 57, "blob_url": "https://github.com/rust-lang/rust/blob/2ccaeff5822fd866fd9e695b9ca51893167be35c/src%2Flibstd%2Fsys%2Funix%2Fext%2Fio.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2ccaeff5822fd866fd9e695b9ca51893167be35c/src%2Flibstd%2Fsys%2Funix%2Fext%2Fio.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Funix%2Fext%2Fio.rs?ref=2ccaeff5822fd866fd9e695b9ca51893167be35c", "patch": "@@ -13,11 +13,10 @@\n #![stable(feature = \"rust1\", since = \"1.0.0\")]\n \n use fs;\n-use net;\n use os::raw;\n use sys;\n use io;\n-use sys_common::{self, AsInner, FromInner, IntoInner};\n+use sys_common::{AsInner, FromInner, IntoInner};\n use libc;\n \n /// Raw file descriptors.\n@@ -93,19 +92,6 @@ impl IntoRawFd for fs::File {\n     }\n }\n \n-#[stable(feature = \"rust1\", since = \"1.0.0\")]\n-impl AsRawFd for net::TcpStream {\n-    fn as_raw_fd(&self) -> RawFd { *self.as_inner().socket().as_inner() }\n-}\n-#[stable(feature = \"rust1\", since = \"1.0.0\")]\n-impl AsRawFd for net::TcpListener {\n-    fn as_raw_fd(&self) -> RawFd { *self.as_inner().socket().as_inner() }\n-}\n-#[stable(feature = \"rust1\", since = \"1.0.0\")]\n-impl AsRawFd for net::UdpSocket {\n-    fn as_raw_fd(&self) -> RawFd { *self.as_inner().socket().as_inner() }\n-}\n-\n #[stable(feature = \"asraw_stdio\", since = \"1.21.0\")]\n impl AsRawFd for io::Stdin {\n     fn as_raw_fd(&self) -> RawFd { libc::STDIN_FILENO }\n@@ -120,44 +106,3 @@ impl AsRawFd for io::Stdout {\n impl AsRawFd for io::Stderr {\n     fn as_raw_fd(&self) -> RawFd { libc::STDERR_FILENO }\n }\n-\n-#[stable(feature = \"from_raw_os\", since = \"1.1.0\")]\n-impl FromRawFd for net::TcpStream {\n-    unsafe fn from_raw_fd(fd: RawFd) -> net::TcpStream {\n-        let socket = sys::net::Socket::from_inner(fd);\n-        net::TcpStream::from_inner(sys_common::net::TcpStream::from_inner(socket))\n-    }\n-}\n-#[stable(feature = \"from_raw_os\", since = \"1.1.0\")]\n-impl FromRawFd for net::TcpListener {\n-    unsafe fn from_raw_fd(fd: RawFd) -> net::TcpListener {\n-        let socket = sys::net::Socket::from_inner(fd);\n-        net::TcpListener::from_inner(sys_common::net::TcpListener::from_inner(socket))\n-    }\n-}\n-#[stable(feature = \"from_raw_os\", since = \"1.1.0\")]\n-impl FromRawFd for net::UdpSocket {\n-    unsafe fn from_raw_fd(fd: RawFd) -> net::UdpSocket {\n-        let socket = sys::net::Socket::from_inner(fd);\n-        net::UdpSocket::from_inner(sys_common::net::UdpSocket::from_inner(socket))\n-    }\n-}\n-\n-#[stable(feature = \"into_raw_os\", since = \"1.4.0\")]\n-impl IntoRawFd for net::TcpStream {\n-    fn into_raw_fd(self) -> RawFd {\n-        self.into_inner().into_socket().into_inner()\n-    }\n-}\n-#[stable(feature = \"into_raw_os\", since = \"1.4.0\")]\n-impl IntoRawFd for net::TcpListener {\n-    fn into_raw_fd(self) -> RawFd {\n-        self.into_inner().into_socket().into_inner()\n-    }\n-}\n-#[stable(feature = \"into_raw_os\", since = \"1.4.0\")]\n-impl IntoRawFd for net::UdpSocket {\n-    fn into_raw_fd(self) -> RawFd {\n-        self.into_inner().into_socket().into_inner()\n-    }\n-}"}, {"sha": "86b0f35be924dcfeca450bc5afd3ba31586f09e6", "filename": "src/libstd/sys/unix/ext/net.rs", "status": "modified", "additions": 61, "deletions": 3, "changes": 64, "blob_url": "https://github.com/rust-lang/rust/blob/2ccaeff5822fd866fd9e695b9ca51893167be35c/src%2Flibstd%2Fsys%2Funix%2Fext%2Fnet.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2ccaeff5822fd866fd9e695b9ca51893167be35c/src%2Flibstd%2Fsys%2Funix%2Fext%2Fnet.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Funix%2Fext%2Fnet.rs?ref=2ccaeff5822fd866fd9e695b9ca51893167be35c", "patch": "@@ -30,14 +30,14 @@ use ffi::OsStr;\n use fmt;\n use io::{self, Initializer};\n use mem;\n-use net::Shutdown;\n+use net::{self, Shutdown};\n use os::unix::ffi::OsStrExt;\n use os::unix::io::{RawFd, AsRawFd, FromRawFd, IntoRawFd};\n use path::Path;\n use time::Duration;\n-use sys::cvt;\n+use sys::{self, cvt};\n use sys::net::Socket;\n-use sys_common::{AsInner, FromInner, IntoInner};\n+use sys_common::{self, AsInner, FromInner, IntoInner};\n \n #[cfg(any(target_os = \"linux\", target_os = \"android\",\n           target_os = \"dragonfly\", target_os = \"freebsd\",\n@@ -588,6 +588,64 @@ impl IntoRawFd for UnixStream {\n     }\n }\n \n+#[stable(feature = \"rust1\", since = \"1.0.0\")]\n+impl AsRawFd for net::TcpStream {\n+    fn as_raw_fd(&self) -> RawFd { *self.as_inner().socket().as_inner() }\n+}\n+\n+#[stable(feature = \"rust1\", since = \"1.0.0\")]\n+impl AsRawFd for net::TcpListener {\n+    fn as_raw_fd(&self) -> RawFd { *self.as_inner().socket().as_inner() }\n+}\n+\n+#[stable(feature = \"rust1\", since = \"1.0.0\")]\n+impl AsRawFd for net::UdpSocket {\n+    fn as_raw_fd(&self) -> RawFd { *self.as_inner().socket().as_inner() }\n+}\n+\n+#[stable(feature = \"from_raw_os\", since = \"1.1.0\")]\n+impl FromRawFd for net::TcpStream {\n+    unsafe fn from_raw_fd(fd: RawFd) -> net::TcpStream {\n+        let socket = sys::net::Socket::from_inner(fd);\n+        net::TcpStream::from_inner(sys_common::net::TcpStream::from_inner(socket))\n+    }\n+}\n+\n+#[stable(feature = \"from_raw_os\", since = \"1.1.0\")]\n+impl FromRawFd for net::TcpListener {\n+    unsafe fn from_raw_fd(fd: RawFd) -> net::TcpListener {\n+        let socket = sys::net::Socket::from_inner(fd);\n+        net::TcpListener::from_inner(sys_common::net::TcpListener::from_inner(socket))\n+    }\n+}\n+\n+#[stable(feature = \"from_raw_os\", since = \"1.1.0\")]\n+impl FromRawFd for net::UdpSocket {\n+    unsafe fn from_raw_fd(fd: RawFd) -> net::UdpSocket {\n+        let socket = sys::net::Socket::from_inner(fd);\n+        net::UdpSocket::from_inner(sys_common::net::UdpSocket::from_inner(socket))\n+    }\n+}\n+\n+#[stable(feature = \"into_raw_os\", since = \"1.4.0\")]\n+impl IntoRawFd for net::TcpStream {\n+    fn into_raw_fd(self) -> RawFd {\n+        self.into_inner().into_socket().into_inner()\n+    }\n+}\n+#[stable(feature = \"into_raw_os\", since = \"1.4.0\")]\n+impl IntoRawFd for net::TcpListener {\n+    fn into_raw_fd(self) -> RawFd {\n+        self.into_inner().into_socket().into_inner()\n+    }\n+}\n+#[stable(feature = \"into_raw_os\", since = \"1.4.0\")]\n+impl IntoRawFd for net::UdpSocket {\n+    fn into_raw_fd(self) -> RawFd {\n+        self.into_inner().into_socket().into_inner()\n+    }\n+}\n+\n /// A structure representing a Unix domain socket server.\n ///\n /// # Examples"}]}