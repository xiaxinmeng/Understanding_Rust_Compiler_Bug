{"sha": "b89db83e6c6dd8186875188de049057d9743ba8a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI4OWRiODNlNmM2ZGQ4MTg2ODc1MTg4ZGUwNDkwNTdkOTc0M2JhOGE=", "commit": {"author": {"name": "Tommy Ip", "email": "hkmp7tommy@gmail.com", "date": "2017-06-10T09:55:19Z"}, "committer": {"name": "Tommy Ip", "email": "hkmp7tommy@gmail.com", "date": "2017-06-10T12:03:11Z"}, "message": "Only emit one error for `use foo::self;`\n\nCurrently `use foo::self;` would emit both E0429 and E0432. This\ncommit silence the latter one (assuming `foo` is a valid module).\n\nFixes #42559", "tree": {"sha": "1e5696c0e5a75cdb21ac0dec0cd4a10f23fca616", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1e5696c0e5a75cdb21ac0dec0cd4a10f23fca616"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b89db83e6c6dd8186875188de049057d9743ba8a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b89db83e6c6dd8186875188de049057d9743ba8a", "html_url": "https://github.com/rust-lang/rust/commit/b89db83e6c6dd8186875188de049057d9743ba8a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b89db83e6c6dd8186875188de049057d9743ba8a/comments", "author": {"login": "tommyip", "id": 18504232, "node_id": "MDQ6VXNlcjE4NTA0MjMy", "avatar_url": "https://avatars.githubusercontent.com/u/18504232?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tommyip", "html_url": "https://github.com/tommyip", "followers_url": "https://api.github.com/users/tommyip/followers", "following_url": "https://api.github.com/users/tommyip/following{/other_user}", "gists_url": "https://api.github.com/users/tommyip/gists{/gist_id}", "starred_url": "https://api.github.com/users/tommyip/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tommyip/subscriptions", "organizations_url": "https://api.github.com/users/tommyip/orgs", "repos_url": "https://api.github.com/users/tommyip/repos", "events_url": "https://api.github.com/users/tommyip/events{/privacy}", "received_events_url": "https://api.github.com/users/tommyip/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tommyip", "id": 18504232, "node_id": "MDQ6VXNlcjE4NTA0MjMy", "avatar_url": "https://avatars.githubusercontent.com/u/18504232?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tommyip", "html_url": "https://github.com/tommyip", "followers_url": "https://api.github.com/users/tommyip/followers", "following_url": "https://api.github.com/users/tommyip/following{/other_user}", "gists_url": "https://api.github.com/users/tommyip/gists{/gist_id}", "starred_url": "https://api.github.com/users/tommyip/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tommyip/subscriptions", "organizations_url": "https://api.github.com/users/tommyip/orgs", "repos_url": "https://api.github.com/users/tommyip/repos", "events_url": "https://api.github.com/users/tommyip/events{/privacy}", "received_events_url": "https://api.github.com/users/tommyip/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "60ac9f467cbbf8481a6f09e3e90e470dec85cf65", "url": "https://api.github.com/repos/rust-lang/rust/commits/60ac9f467cbbf8481a6f09e3e90e470dec85cf65", "html_url": "https://github.com/rust-lang/rust/commit/60ac9f467cbbf8481a6f09e3e90e470dec85cf65"}], "stats": {"total": 19, "additions": 15, "deletions": 4}, "files": [{"sha": "405b2ed6ba9c8684f114c701d8a76e04c6bbd4e5", "filename": "src/librustc_resolve/resolve_imports.rs", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/b89db83e6c6dd8186875188de049057d9743ba8a/src%2Flibrustc_resolve%2Fresolve_imports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b89db83e6c6dd8186875188de049057d9743ba8a/src%2Flibrustc_resolve%2Fresolve_imports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Fresolve_imports.rs?ref=b89db83e6c6dd8186875188de049057d9743ba8a", "patch": "@@ -482,6 +482,16 @@ impl<'a, 'b:'a> ImportResolver<'a, 'b> {\n             if let Some(err) = self.finalize_import(import) {\n                 errors = true;\n \n+                if let SingleImport { source, ref result, .. } = import.subclass {\n+                    if source.name == \"self\" {\n+                        // Silence `unresolved import` error if E0429 is already emitted\n+                        match result.value_ns.get() {\n+                            Err(Determined) => continue,\n+                            _ => {},\n+                        }\n+                    }\n+                }\n+\n                 // If the error is a single failed import then create a \"fake\" import\n                 // resolution for it so that later resolve stages won't complain.\n                 self.import_dummy_binding(import);"}, {"sha": "f1cad200be61a44a7801f0af797a651278ab4279", "filename": "src/test/compile-fail/E0429.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b89db83e6c6dd8186875188de049057d9743ba8a/src%2Ftest%2Fcompile-fail%2FE0429.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b89db83e6c6dd8186875188de049057d9743ba8a/src%2Ftest%2Fcompile-fail%2FE0429.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2FE0429.rs?ref=b89db83e6c6dd8186875188de049057d9743ba8a", "patch": "@@ -9,7 +9,6 @@\n // except according to those terms.\n \n use std::fmt::self; //~ ERROR E0429\n-                    //~^ ERROR E0432\n \n fn main () {\n }"}, {"sha": "aff54f18c19a32c51d1938015edf08e518fabd1a", "filename": "src/test/compile-fail/use-keyword.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/b89db83e6c6dd8186875188de049057d9743ba8a/src%2Ftest%2Fcompile-fail%2Fuse-keyword.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b89db83e6c6dd8186875188de049057d9743ba8a/src%2Ftest%2Fcompile-fail%2Fuse-keyword.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fuse-keyword.rs?ref=b89db83e6c6dd8186875188de049057d9743ba8a", "patch": "@@ -13,9 +13,8 @@\n \n mod a {\n     mod b {\n-        use self as A; //~ ERROR `self` imports are only allowed within a { } list\n-        //~^ ERROR unresolved import `self` [E0432]\n-        //~| no `self` in the root\n+        use self as A;\n+        //~^ ERROR `self` imports are only allowed within a { } list\n         use super as B;\n         //~^ ERROR unresolved import `super` [E0432]\n         //~| no `super` in the root"}, {"sha": "f102a68c2c5e253e89dda70f96e8a4b0c4b6585f", "filename": "src/test/compile-fail/use-mod-4.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/b89db83e6c6dd8186875188de049057d9743ba8a/src%2Ftest%2Fcompile-fail%2Fuse-mod-4.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b89db83e6c6dd8186875188de049057d9743ba8a/src%2Ftest%2Fcompile-fail%2Fuse-mod-4.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fuse-mod-4.rs?ref=b89db83e6c6dd8186875188de049057d9743ba8a", "patch": "@@ -11,4 +11,7 @@\n use foo::self; //~ ERROR unresolved import `foo::self`\n //~^ ERROR `self` imports are only allowed within a { } list\n \n+use std::mem::self;\n+//~^ ERROR `self` imports are only allowed within a { } list\n+\n fn main() {}"}]}