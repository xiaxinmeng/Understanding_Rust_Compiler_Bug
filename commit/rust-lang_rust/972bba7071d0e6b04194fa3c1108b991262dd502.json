{"sha": "972bba7071d0e6b04194fa3c1108b991262dd502", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk3MmJiYTcwNzFkMGU2YjA0MTk0ZmEzYzExMDhiOTkxMjYyZGQ1MDI=", "commit": {"author": {"name": "Jethro Beekman", "email": "jethro@fortanix.com", "date": "2019-01-09T08:00:34Z"}, "committer": {"name": "Jethro Beekman", "email": "jethro@fortanix.com", "date": "2019-01-14T09:03:04Z"}, "message": "Stabilize `cfg_target_vendor`, #29718", "tree": {"sha": "993603d8486e895d689c5aefb82fea43526d49b4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/993603d8486e895d689c5aefb82fea43526d49b4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/972bba7071d0e6b04194fa3c1108b991262dd502", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/972bba7071d0e6b04194fa3c1108b991262dd502", "html_url": "https://github.com/rust-lang/rust/commit/972bba7071d0e6b04194fa3c1108b991262dd502", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/972bba7071d0e6b04194fa3c1108b991262dd502/comments", "author": null, "committer": null, "parents": [{"sha": "608031888354d95fa613de6d487311b527d804d1", "url": "https://api.github.com/repos/rust-lang/rust/commits/608031888354d95fa613de6d487311b527d804d1", "html_url": "https://github.com/rust-lang/rust/commit/608031888354d95fa613de6d487311b527d804d1"}], "stats": {"total": 62, "additions": 6, "deletions": 56}, "files": [{"sha": "8832a16d4ca4eb2a2cafea38d0e4b17e5041b8ff", "filename": "src/libpanic_abort/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/972bba7071d0e6b04194fa3c1108b991262dd502/src%2Flibpanic_abort%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/972bba7071d0e6b04194fa3c1108b991262dd502/src%2Flibpanic_abort%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibpanic_abort%2Flib.rs?ref=972bba7071d0e6b04194fa3c1108b991262dd502", "patch": "@@ -12,7 +12,7 @@\n #![panic_runtime]\n #![allow(unused_features)]\n \n-#![feature(cfg_target_vendor)]\n+#![cfg_attr(stage0, feature(cfg_target_vendor))]\n #![feature(core_intrinsics)]\n #![feature(libc)]\n #![feature(nll)]"}, {"sha": "41f1ac867ed15a60f3e426cfab9a14b466940026", "filename": "src/libstd/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/972bba7071d0e6b04194fa3c1108b991262dd502/src%2Flibstd%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/972bba7071d0e6b04194fa3c1108b991262dd502/src%2Flibstd%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Flib.rs?ref=972bba7071d0e6b04194fa3c1108b991262dd502", "patch": "@@ -238,7 +238,7 @@\n #![feature(c_variadic)]\n #![feature(cfg_target_has_atomic)]\n #![feature(cfg_target_thread_local)]\n-#![feature(cfg_target_vendor)]\n+#![cfg_attr(stage0, feature(cfg_target_vendor))]\n #![feature(char_error_internals)]\n #![feature(compiler_builtins_lib)]\n #![feature(concat_idents)]"}, {"sha": "ac20a62f11787aeabd0ef8e83195ca5164dbbf68", "filename": "src/libsyntax/feature_gate.rs", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/972bba7071d0e6b04194fa3c1108b991262dd502/src%2Flibsyntax%2Ffeature_gate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/972bba7071d0e6b04194fa3c1108b991262dd502/src%2Flibsyntax%2Ffeature_gate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Ffeature_gate.rs?ref=972bba7071d0e6b04194fa3c1108b991262dd502", "patch": "@@ -244,9 +244,6 @@ declare_features! (\n     // rustc internal\n     (active, omit_gdb_pretty_printer_section, \"1.5.0\", None, None),\n \n-    // Allows `cfg(target_vendor = \"...\")`.\n-    (active, cfg_target_vendor, \"1.5.0\", Some(29718), None),\n-\n     // Allows attributes on expressions and non-item statements.\n     (active, stmt_expr_attributes, \"1.6.0\", Some(15701), None),\n \n@@ -686,6 +683,8 @@ declare_features! (\n     (accepted, if_while_or_patterns, \"1.33.0\", Some(48215), None),\n     // Allows `use x::y;` to search `x` in the current scope.\n     (accepted, uniform_paths, \"1.32.0\", Some(53130), None),\n+    // Allows `cfg(target_vendor = \"...\")`.\n+    (accepted, cfg_target_vendor, \"1.33.0\", Some(29718), None),\n );\n \n // If you change this, please modify `src/doc/unstable-book` as well. You must\n@@ -1181,7 +1180,6 @@ pub const BUILTIN_ATTRIBUTES: &[(&str, AttributeType, AttributeGate)] = &[\n // cfg(...)'s that are feature gated\n const GATED_CFGS: &[(&str, &str, fn(&Features) -> bool)] = &[\n     // (name in cfg, feature, function to check if the feature is enabled)\n-    (\"target_vendor\", \"cfg_target_vendor\", cfg_fn!(cfg_target_vendor)),\n     (\"target_thread_local\", \"cfg_target_thread_local\", cfg_fn!(cfg_target_thread_local)),\n     (\"target_has_atomic\", \"cfg_target_has_atomic\", cfg_fn!(cfg_target_has_atomic)),\n     (\"rustdoc\", \"doc_cfg\", cfg_fn!(doc_cfg)),"}, {"sha": "2cc80ddea2df4182a7b80bd7703f31cb98fa8834", "filename": "src/libtest/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/972bba7071d0e6b04194fa3c1108b991262dd502/src%2Flibtest%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/972bba7071d0e6b04194fa3c1108b991262dd502/src%2Flibtest%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibtest%2Flib.rs?ref=972bba7071d0e6b04194fa3c1108b991262dd502", "patch": "@@ -23,7 +23,7 @@\n        html_favicon_url = \"https://doc.rust-lang.org/favicon.ico\",\n        html_root_url = \"https://doc.rust-lang.org/nightly/\", test(attr(deny(warnings))))]\n #![feature(asm)]\n-#![feature(cfg_target_vendor)]\n+#![cfg_attr(stage0, feature(cfg_target_vendor))]\n #![feature(fnbox)]\n #![cfg_attr(any(unix, target_os = \"cloudabi\"), feature(libc))]\n #![feature(nll)]"}, {"sha": "7ed7837268dcd3fe94062b496f275808c7c17d66", "filename": "src/libunwind/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/972bba7071d0e6b04194fa3c1108b991262dd502/src%2Flibunwind%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/972bba7071d0e6b04194fa3c1108b991262dd502/src%2Flibunwind%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibunwind%2Flib.rs?ref=972bba7071d0e6b04194fa3c1108b991262dd502", "patch": "@@ -1,7 +1,7 @@\n #![no_std]\n #![unstable(feature = \"panic_unwind\", issue = \"32837\")]\n \n-#![feature(cfg_target_vendor)]\n+#![cfg_attr(stage0, feature(cfg_target_vendor))]\n #![feature(link_cfg)]\n #![feature(nll)]\n #![feature(staged_api)]"}, {"sha": "7824585162e5cc9098e9c23cd1303714b366d132", "filename": "src/test/run-pass/cfg/cfg-target-vendor.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/972bba7071d0e6b04194fa3c1108b991262dd502/src%2Ftest%2Frun-pass%2Fcfg%2Fcfg-target-vendor.rs", "raw_url": "https://github.com/rust-lang/rust/raw/972bba7071d0e6b04194fa3c1108b991262dd502/src%2Ftest%2Frun-pass%2Fcfg%2Fcfg-target-vendor.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fcfg%2Fcfg-target-vendor.rs?ref=972bba7071d0e6b04194fa3c1108b991262dd502", "patch": "@@ -1,6 +1,4 @@\n // run-pass\n-#![feature(cfg_target_vendor)]\n-\n #[cfg(target_vendor = \"unknown\")]\n pub fn main() {\n }"}, {"sha": "acd310e7e2e0795b8df81b4fdeaedf44f27e3771", "filename": "src/test/ui/feature-gates/feature-gate-cfg-target-vendor.rs", "status": "removed", "additions": 0, "deletions": 11, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/608031888354d95fa613de6d487311b527d804d1/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-cfg-target-vendor.rs", "raw_url": "https://github.com/rust-lang/rust/raw/608031888354d95fa613de6d487311b527d804d1/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-cfg-target-vendor.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-cfg-target-vendor.rs?ref=608031888354d95fa613de6d487311b527d804d1", "patch": "@@ -1,11 +0,0 @@\n-#[cfg(target_vendor = \"x\")] //~ ERROR `cfg(target_vendor)` is experimental\n-#[cfg_attr(target_vendor = \"x\", x)] //~ ERROR `cfg(target_vendor)` is experimental\n-struct Foo(u64, u64);\n-\n-#[cfg(not(any(all(target_vendor = \"x\"))))] //~ ERROR `cfg(target_vendor)` is experimental\n-fn foo() {}\n-\n-fn main() {\n-    cfg!(target_vendor = \"x\");\n-    //~^ ERROR `cfg(target_vendor)` is experimental and subject to change\n-}"}, {"sha": "dd514a5d90a0343612ee76c140c7e69b805fa9fe", "filename": "src/test/ui/feature-gates/feature-gate-cfg-target-vendor.stderr", "status": "removed", "additions": 0, "deletions": 35, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/608031888354d95fa613de6d487311b527d804d1/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-cfg-target-vendor.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/608031888354d95fa613de6d487311b527d804d1/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-cfg-target-vendor.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-cfg-target-vendor.stderr?ref=608031888354d95fa613de6d487311b527d804d1", "patch": "@@ -1,35 +0,0 @@\n-error[E0658]: `cfg(target_vendor)` is experimental and subject to change (see issue #29718)\n-  --> $DIR/feature-gate-cfg-target-vendor.rs:2:12\n-   |\n-LL | #[cfg_attr(target_vendor = \"x\", x)] //~ ERROR `cfg(target_vendor)` is experimental\n-   |            ^^^^^^^^^^^^^^^^^^^\n-   |\n-   = help: add #![feature(cfg_target_vendor)] to the crate attributes to enable\n-\n-error[E0658]: `cfg(target_vendor)` is experimental and subject to change (see issue #29718)\n-  --> $DIR/feature-gate-cfg-target-vendor.rs:1:7\n-   |\n-LL | #[cfg(target_vendor = \"x\")] //~ ERROR `cfg(target_vendor)` is experimental\n-   |       ^^^^^^^^^^^^^^^^^^^\n-   |\n-   = help: add #![feature(cfg_target_vendor)] to the crate attributes to enable\n-\n-error[E0658]: `cfg(target_vendor)` is experimental and subject to change (see issue #29718)\n-  --> $DIR/feature-gate-cfg-target-vendor.rs:5:19\n-   |\n-LL | #[cfg(not(any(all(target_vendor = \"x\"))))] //~ ERROR `cfg(target_vendor)` is experimental\n-   |                   ^^^^^^^^^^^^^^^^^^^\n-   |\n-   = help: add #![feature(cfg_target_vendor)] to the crate attributes to enable\n-\n-error[E0658]: `cfg(target_vendor)` is experimental and subject to change (see issue #29718)\n-  --> $DIR/feature-gate-cfg-target-vendor.rs:9:10\n-   |\n-LL |     cfg!(target_vendor = \"x\");\n-   |          ^^^^^^^^^^^^^^^^^^^\n-   |\n-   = help: add #![feature(cfg_target_vendor)] to the crate attributes to enable\n-\n-error: aborting due to 4 previous errors\n-\n-For more information about this error, try `rustc --explain E0658`."}]}