{"sha": "774e82a566c6c3349700a8bece44d6a8c6755039", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc3NGU4MmE1NjZjNmMzMzQ5NzAwYThiZWNlNDRkNmE4YzY3NTUwMzk=", "commit": {"author": {"name": "rail", "email": "12975677+rail-rain@users.noreply.github.com", "date": "2020-06-10T23:19:44Z"}, "committer": {"name": "rail", "email": "12975677+rail-rain@users.noreply.github.com", "date": "2020-09-24T21:02:05Z"}, "message": "Add the tests for `manual_memcpy` with loop counters", "tree": {"sha": "2130c4ab8e3c5d99b53756ac36faf3196aea79e1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2130c4ab8e3c5d99b53756ac36faf3196aea79e1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/774e82a566c6c3349700a8bece44d6a8c6755039", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/774e82a566c6c3349700a8bece44d6a8c6755039", "html_url": "https://github.com/rust-lang/rust/commit/774e82a566c6c3349700a8bece44d6a8c6755039", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/774e82a566c6c3349700a8bece44d6a8c6755039/comments", "author": {"login": "rail-rain", "id": 12975677, "node_id": "MDQ6VXNlcjEyOTc1Njc3", "avatar_url": "https://avatars.githubusercontent.com/u/12975677?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rail-rain", "html_url": "https://github.com/rail-rain", "followers_url": "https://api.github.com/users/rail-rain/followers", "following_url": "https://api.github.com/users/rail-rain/following{/other_user}", "gists_url": "https://api.github.com/users/rail-rain/gists{/gist_id}", "starred_url": "https://api.github.com/users/rail-rain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rail-rain/subscriptions", "organizations_url": "https://api.github.com/users/rail-rain/orgs", "repos_url": "https://api.github.com/users/rail-rain/repos", "events_url": "https://api.github.com/users/rail-rain/events{/privacy}", "received_events_url": "https://api.github.com/users/rail-rain/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rail-rain", "id": 12975677, "node_id": "MDQ6VXNlcjEyOTc1Njc3", "avatar_url": "https://avatars.githubusercontent.com/u/12975677?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rail-rain", "html_url": "https://github.com/rail-rain", "followers_url": "https://api.github.com/users/rail-rain/followers", "following_url": "https://api.github.com/users/rail-rain/following{/other_user}", "gists_url": "https://api.github.com/users/rail-rain/gists{/gist_id}", "starred_url": "https://api.github.com/users/rail-rain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rail-rain/subscriptions", "organizations_url": "https://api.github.com/users/rail-rain/orgs", "repos_url": "https://api.github.com/users/rail-rain/repos", "events_url": "https://api.github.com/users/rail-rain/events{/privacy}", "received_events_url": "https://api.github.com/users/rail-rain/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d9a88be0b05c2cfec0679caf428d129c9d46256d", "url": "https://api.github.com/repos/rust-lang/rust/commits/d9a88be0b05c2cfec0679caf428d129c9d46256d", "html_url": "https://github.com/rust-lang/rust/commit/d9a88be0b05c2cfec0679caf428d129c9d46256d"}], "stats": {"total": 114, "additions": 111, "deletions": 3}, "files": [{"sha": "87bfb4fdd163bb7a92cda7ab80f2797a906fe34f", "filename": "tests/ui/manual_memcpy.rs", "status": "modified", "additions": 54, "deletions": 0, "changes": 54, "blob_url": "https://github.com/rust-lang/rust/blob/774e82a566c6c3349700a8bece44d6a8c6755039/tests%2Fui%2Fmanual_memcpy.rs", "raw_url": "https://github.com/rust-lang/rust/raw/774e82a566c6c3349700a8bece44d6a8c6755039/tests%2Fui%2Fmanual_memcpy.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmanual_memcpy.rs?ref=774e82a566c6c3349700a8bece44d6a8c6755039", "patch": "@@ -115,6 +115,60 @@ pub fn manual_copy(src: &[i32], dst: &mut [i32], dst2: &mut [i32]) {\n     }\n }\n \n+#[allow(clippy::needless_range_loop, clippy::explicit_counter_loop)]\n+pub fn manual_copy_with_counters(src: &[i32], dst: &mut [i32], dst2: &mut [i32]) {\n+    let mut count = 0;\n+    for i in 3..src.len() {\n+        dst[i] = src[count];\n+        count += 1;\n+    }\n+\n+    let mut count = 0;\n+    for i in 3..src.len() {\n+        dst[count] = src[i];\n+        count += 1;\n+    }\n+\n+    let mut count = 3;\n+    for i in 0..src.len() {\n+        dst[count] = src[i];\n+        count += 1;\n+    }\n+\n+    let mut count = 3;\n+    for i in 0..src.len() {\n+        dst[i] = src[count];\n+        count += 1;\n+    }\n+\n+    let mut count = 0;\n+    for i in 3..(3 + src.len()) {\n+        dst[i] = src[count];\n+        count += 1;\n+    }\n+\n+    let mut count = 3;\n+    for i in 5..src.len() {\n+        dst[i] = src[count - 2];\n+        count += 1;\n+    }\n+\n+    let mut count = 5;\n+    for i in 3..10 {\n+        dst[i] = src[count];\n+        count += 1;\n+    }\n+\n+    let mut count = 3;\n+    let mut count = 30;\n+    for i in 0..src.len() {\n+        dst[count] = src[i];\n+        dst2[count] = src[i];\n+        count += 1;\n+        count += 1;\n+    }\n+}\n+\n #[warn(clippy::needless_range_loop, clippy::manual_memcpy)]\n pub fn manual_clone(src: &[String], dst: &mut [String]) {\n     for i in 0..src.len() {"}, {"sha": "a5698b08103b6fbffa9f56b6a95a0404a6526af2", "filename": "tests/ui/manual_memcpy.stderr", "status": "modified", "additions": 57, "deletions": 3, "changes": 60, "blob_url": "https://github.com/rust-lang/rust/blob/774e82a566c6c3349700a8bece44d6a8c6755039/tests%2Fui%2Fmanual_memcpy.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/774e82a566c6c3349700a8bece44d6a8c6755039/tests%2Fui%2Fmanual_memcpy.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmanual_memcpy.stderr?ref=774e82a566c6c3349700a8bece44d6a8c6755039", "patch": "@@ -16,7 +16,7 @@ error: it looks like you're manually copying between slices\n   --> $DIR/manual_memcpy.rs:17:14\n    |\n LL |     for i in 0..src.len() {\n-   |              ^^^^^^^^^^^^ help: try replacing the loop by: `dst[..src.len()].clone_from_slice(&src[10..])`\n+   |              ^^^^^^^^^^^^ help: try replacing the loop by: `dst[..src.len()].clone_from_slice(&src[10..(src.len() + 10)])`\n \n error: it looks like you're manually copying between slices\n   --> $DIR/manual_memcpy.rs:22:14\n@@ -79,10 +79,64 @@ LL |     for i in 0..0 {\n    |              ^^^^ help: try replacing the loop by: `dst[..0].clone_from_slice(&src[..0])`\n \n error: it looks like you're manually copying between slices\n-  --> $DIR/manual_memcpy.rs:120:14\n+  --> $DIR/manual_memcpy.rs:121:14\n+   |\n+LL |     for i in 3..src.len() {\n+   |              ^^^^^^^^^^^^ help: try replacing the loop by: `dst[3..src.len()].clone_from_slice(&src[..(src.len() - 3)])`\n+\n+error: it looks like you're manually copying between slices\n+  --> $DIR/manual_memcpy.rs:127:14\n+   |\n+LL |     for i in 3..src.len() {\n+   |              ^^^^^^^^^^^^ help: try replacing the loop by: `dst[..(src.len() - 3)].clone_from_slice(&src[3..])`\n+\n+error: it looks like you're manually copying between slices\n+  --> $DIR/manual_memcpy.rs:133:14\n+   |\n+LL |     for i in 0..src.len() {\n+   |              ^^^^^^^^^^^^ help: try replacing the loop by: `dst[3..(src.len() + 3)].clone_from_slice(&src[..])`\n+\n+error: it looks like you're manually copying between slices\n+  --> $DIR/manual_memcpy.rs:139:14\n+   |\n+LL |     for i in 0..src.len() {\n+   |              ^^^^^^^^^^^^ help: try replacing the loop by: `dst[..src.len()].clone_from_slice(&src[3..(src.len() + 3)])`\n+\n+error: it looks like you're manually copying between slices\n+  --> $DIR/manual_memcpy.rs:145:14\n+   |\n+LL |     for i in 3..(3 + src.len()) {\n+   |              ^^^^^^^^^^^^^^^^^^ help: try replacing the loop by: `dst[3..(3 + src.len())].clone_from_slice(&src[..((3 + src.len()) - 3)])`\n+\n+error: it looks like you're manually copying between slices\n+  --> $DIR/manual_memcpy.rs:151:14\n+   |\n+LL |     for i in 5..src.len() {\n+   |              ^^^^^^^^^^^^ help: try replacing the loop by: `dst[5..src.len()].clone_from_slice(&src[(3 - 2)..((src.len() - 2) + 3 - 5)])`\n+\n+error: it looks like you're manually copying between slices\n+  --> $DIR/manual_memcpy.rs:157:14\n+   |\n+LL |     for i in 3..10 {\n+   |              ^^^^^ help: try replacing the loop by: `dst[3..10].clone_from_slice(&src[5..(10 + 5 - 3)])`\n+\n+error: it looks like you're manually copying between slices\n+  --> $DIR/manual_memcpy.rs:164:14\n+   |\n+LL |     for i in 0..src.len() {\n+   |              ^^^^^^^^^^^^\n+   |\n+help: try replacing the loop by\n+   |\n+LL |     for i in dst[3..(src.len() + 3)].clone_from_slice(&src[..])\n+LL |     dst2[30..(src.len() + 30)].clone_from_slice(&src[..]) {\n+   |\n+\n+error: it looks like you're manually copying between slices\n+  --> $DIR/manual_memcpy.rs:174:14\n    |\n LL |     for i in 0..src.len() {\n    |              ^^^^^^^^^^^^ help: try replacing the loop by: `dst[..src.len()].clone_from_slice(&src[..])`\n \n-error: aborting due to 13 previous errors\n+error: aborting due to 21 previous errors\n "}]}