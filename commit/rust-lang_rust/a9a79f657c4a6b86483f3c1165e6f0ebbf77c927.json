{"sha": "a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "node_id": "C_kwDOAAsO6NoAKGE5YTc5ZjY1N2M0YTZiODY0ODNmM2MxMTY1ZTZmMGViYmY3N2M5Mjc", "commit": {"author": {"name": "Oli Scherer", "email": "git-spam-no-reply9815368754983@oli-obk.de", "date": "2021-10-25T15:58:41Z"}, "committer": {"name": "Deadbeef", "email": "ent3rm4n@gmail.com", "date": "2021-11-29T13:19:49Z"}, "message": "Completely remove ConstnessAnd", "tree": {"sha": "8dac03e93e6a0bed2f0c273f3020112d7aadf188", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8dac03e93e6a0bed2f0c273f3020112d7aadf188"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE3RQPHNISvvEnSKtjbQF6ltjmwvkFAmGk03UACgkQbQF6ltjm\nwvllOxAAhTwSlvCSxiDMo5mzeWRcHnArKukXFvtV/7YiAvNXOr+X5v9uACWPaMuq\nUfpT7gIQAB6ZzdPrIcEaTnCWedOsVQwugcYbFNkwa/nkyDOONXsVgUpxwYsRB41z\nGHlIEHLM9ZgTaoFviGBTsCBpe/bJPxz/EWjGTgBJeLTggh2gckEhQI7TOGJcc+S6\nrFLvS4httknR+KV8QhJxV7JJTmaIpt2SBhEpNQyKC7lYi+b724taP+O/2HZqBpDH\n7zdDD7dp/9/wfAj7NJXhvIvKLRH1IxCrrwZ1RWrChPAnVKfop2eVoaEUwFMr96ya\nr+Bw0Xr2s+iZA1QVjFYtVKw7BsMDME3GhuC3lZdYKw1avm8HqpqhyhnLLly9/grd\naQpd6OhYxuFG4w1o28YN1AvWwQpOr0ZG9tv5KLKumXEoHGYPebpwitSdptWYkFzI\n9rOrn9YI3DipNcYYXVh2vW5HuBUVzecojoUdandFMhnRZec+NE6h2dr73PJZn+Id\n4V8Vg/jFHhMMsnZkki0jYf/yujKdyFSSrq9AyxWyCEXRQd798UFoYBb0Hkc+1995\n5rcp48lIBEzHPe62UPE/9ln4D0iJMrsOH1dyhoBG4tJpcazwPKqoE0jFq7vBRcwB\nU4r1VUrdytgLy9vkeeICsjFGatoR7B4r2PSJzVubfh8C0YcNG1c=\n=K1wY\n-----END PGP SIGNATURE-----", "payload": "tree 8dac03e93e6a0bed2f0c273f3020112d7aadf188\nparent a848c4ba3ff69c2cb0cb66a59dc37fd53bbcb70b\nauthor Oli Scherer <git-spam-no-reply9815368754983@oli-obk.de> 1635177521 +0000\ncommitter Deadbeef <ent3rm4n@gmail.com> 1638191989 +0800\n\nCompletely remove ConstnessAnd\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "html_url": "https://github.com/rust-lang/rust/commit/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a848c4ba3ff69c2cb0cb66a59dc37fd53bbcb70b", "url": "https://api.github.com/repos/rust-lang/rust/commits/a848c4ba3ff69c2cb0cb66a59dc37fd53bbcb70b", "html_url": "https://github.com/rust-lang/rust/commit/a848c4ba3ff69c2cb0cb66a59dc37fd53bbcb70b"}], "stats": {"total": 100, "additions": 28, "deletions": 72}, "files": [{"sha": "d90154f16438675ce0fa34429d1d7f64b31800dd", "filename": "compiler/rustc_borrowck/src/type_check/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_borrowck%2Fsrc%2Ftype_check%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_borrowck%2Fsrc%2Ftype_check%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_borrowck%2Fsrc%2Ftype_check%2Fmod.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -31,7 +31,7 @@ use rustc_middle::ty::fold::TypeFoldable;\n use rustc_middle::ty::subst::{GenericArgKind, SubstsRef, UserSubsts};\n use rustc_middle::ty::{\n     self, CanonicalUserTypeAnnotation, CanonicalUserTypeAnnotations, OpaqueTypeKey, RegionVid,\n-    ToPredicate, Ty, TyCtxt, UserType, UserTypeAnnotationIndex, WithConstness,\n+    ToPredicate, Ty, TyCtxt, UserType, UserTypeAnnotationIndex,\n };\n use rustc_span::def_id::CRATE_DEF_ID;\n use rustc_span::{Span, DUMMY_SP};"}, {"sha": "2f5615827882079737763b5af1b72184d28ab2d5", "filename": "compiler/rustc_infer/src/traits/engine.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_infer%2Fsrc%2Ftraits%2Fengine.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_infer%2Fsrc%2Ftraits%2Fengine.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_infer%2Fsrc%2Ftraits%2Fengine.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -2,7 +2,7 @@ use crate::infer::InferCtxt;\n use crate::traits::Obligation;\n use rustc_data_structures::fx::FxHashMap;\n use rustc_hir::def_id::DefId;\n-use rustc_middle::ty::{self, ToPredicate, Ty, WithConstness};\n+use rustc_middle::ty::{self, ToPredicate, Ty};\n \n use super::FulfillmentError;\n use super::{ObligationCause, PredicateObligation};"}, {"sha": "61588147364a9c37aaecb053fffb7dc62a8a5c70", "filename": "compiler/rustc_infer/src/traits/util.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_infer%2Fsrc%2Ftraits%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_infer%2Fsrc%2Ftraits%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_infer%2Fsrc%2Ftraits%2Futil.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -3,7 +3,7 @@ use smallvec::smallvec;\n use crate::infer::outlives::components::{push_outlives_components, Component};\n use crate::traits::{Obligation, ObligationCause, PredicateObligation};\n use rustc_data_structures::fx::{FxHashSet, FxIndexSet};\n-use rustc_middle::ty::{self, ToPredicate, TyCtxt, WithConstness};\n+use rustc_middle::ty::{self, ToPredicate, TyCtxt};\n use rustc_span::symbol::Ident;\n use rustc_span::Span;\n "}, {"sha": "8031eb8a1ec203e35612bc1460f2b8a4019f421c", "filename": "compiler/rustc_middle/src/ty/mod.rs", "status": "modified", "additions": 8, "deletions": 32, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_middle%2Fsrc%2Fty%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_middle%2Fsrc%2Fty%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fty%2Fmod.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -846,20 +846,6 @@ impl ToPredicate<'tcx> for Binder<'tcx, PredicateKind<'tcx>> {\n     }\n }\n \n-impl<'tcx> ToPredicate<'tcx> for ConstnessAnd<PolyTraitRef<'tcx>> {\n-    fn to_predicate(self, tcx: TyCtxt<'tcx>) -> Predicate<'tcx> {\n-        self.value\n-            .map_bound(|trait_ref| {\n-                PredicateKind::Trait(ty::TraitPredicate {\n-                    trait_ref,\n-                    constness: self.constness,\n-                    polarity: ty::ImplPolarity::Positive,\n-                })\n-            })\n-            .to_predicate(tcx)\n-    }\n-}\n-\n impl<'tcx> ToPredicate<'tcx> for PolyTraitPredicate<'tcx> {\n     fn to_predicate(self, tcx: TyCtxt<'tcx>) -> Predicate<'tcx> {\n         self.map_bound(PredicateKind::Trait).to_predicate(tcx)\n@@ -1391,33 +1377,23 @@ impl<'tcx> ParamEnv<'tcx> {\n     }\n }\n \n-#[derive(Copy, Clone, Debug, PartialEq, Eq, Hash, TypeFoldable)]\n-pub struct ConstnessAnd<T> {\n-    pub constness: BoundConstness,\n-    pub value: T,\n-}\n-\n // FIXME(ecstaticmorse): Audit all occurrences of `without_const().to_predicate(tcx)` to ensure that\n // the constness of trait bounds is being propagated correctly.\n-pub trait WithConstness: Sized {\n-    #[inline]\n-    fn with_constness(self, constness: BoundConstness) -> ConstnessAnd<Self> {\n-        ConstnessAnd { constness, value: self }\n-    }\n-\n+impl PolyTraitRef<'tcx> {\n     #[inline]\n-    fn with_const_if_const(self) -> ConstnessAnd<Self> {\n-        self.with_constness(BoundConstness::ConstIfConst)\n+    pub fn with_constness(self, constness: BoundConstness) -> PolyTraitPredicate<'tcx> {\n+        self.map_bound(|trait_ref| ty::TraitPredicate {\n+            trait_ref,\n+            constness,\n+            polarity: ty::ImplPolarity::Positive,\n+        })\n     }\n-\n     #[inline]\n-    fn without_const(self) -> ConstnessAnd<Self> {\n+    pub fn without_const(self) -> PolyTraitPredicate<'tcx> {\n         self.with_constness(BoundConstness::NotConst)\n     }\n }\n \n-impl<T> WithConstness for T {}\n-\n #[derive(Copy, Clone, Debug, PartialEq, Eq, Hash, TypeFoldable)]\n pub struct ParamEnvAnd<'tcx, T> {\n     pub param_env: ParamEnv<'tcx>,"}, {"sha": "b6aadf27bb08b728ce2b06e564c0f572af4749f3", "filename": "compiler/rustc_middle/src/ty/relate.rs", "status": "modified", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_middle%2Fsrc%2Fty%2Frelate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_middle%2Fsrc%2Fty%2Frelate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fty%2Frelate.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -218,19 +218,6 @@ impl<'tcx> Relate<'tcx> for ty::BoundConstness {\n     }\n }\n \n-impl<'tcx, T: Relate<'tcx>> Relate<'tcx> for ty::ConstnessAnd<T> {\n-    fn relate<R: TypeRelation<'tcx>>(\n-        relation: &mut R,\n-        a: ty::ConstnessAnd<T>,\n-        b: ty::ConstnessAnd<T>,\n-    ) -> RelateResult<'tcx, ty::ConstnessAnd<T>> {\n-        Ok(ty::ConstnessAnd {\n-            constness: relation.relate(a.constness, b.constness)?,\n-            value: relation.relate(a.value, b.value)?,\n-        })\n-    }\n-}\n-\n impl<'tcx> Relate<'tcx> for ast::Unsafety {\n     fn relate<R: TypeRelation<'tcx>>(\n         relation: &mut R,"}, {"sha": "29ba75e1a7dadff7943d6c47b9f1c059bae291f6", "filename": "compiler/rustc_middle/src/ty/sty.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_middle%2Fsrc%2Fty%2Fsty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_middle%2Fsrc%2Fty%2Fsty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fty%2Fsty.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -8,9 +8,7 @@ use crate::infer::canonical::Canonical;\n use crate::ty::fold::ValidateBoundVars;\n use crate::ty::subst::{GenericArg, InternalSubsts, Subst, SubstsRef};\n use crate::ty::InferTy::{self, *};\n-use crate::ty::{\n-    self, AdtDef, DefIdTree, Discr, Ty, TyCtxt, TypeFlags, TypeFoldable, WithConstness,\n-};\n+use crate::ty::{self, AdtDef, DefIdTree, Discr, Ty, TyCtxt, TypeFlags, TypeFoldable};\n use crate::ty::{DelaySpanBugEmitted, List, ParamEnv, TyS};\n use polonius_engine::Atom;\n use rustc_data_structures::captures::Captures;"}, {"sha": "46c74660f86a1364b21959744cfde3f75cad92b0", "filename": "compiler/rustc_trait_selection/src/autoderef.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Fautoderef.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Fautoderef.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Fautoderef.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -3,7 +3,7 @@ use crate::traits::{self, TraitEngine};\n use rustc_errors::struct_span_err;\n use rustc_hir as hir;\n use rustc_infer::infer::InferCtxt;\n-use rustc_middle::ty::{self, TraitRef, Ty, TyCtxt, WithConstness};\n+use rustc_middle::ty::{self, TraitRef, Ty, TyCtxt};\n use rustc_middle::ty::{ToPredicate, TypeFoldable};\n use rustc_session::{DiagnosticMessageId, Limit};\n use rustc_span::def_id::LOCAL_CRATE;"}, {"sha": "f135f0c1b13d2d0da0707eead4c68b82d33bce60", "filename": "compiler/rustc_trait_selection/src/infer.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Finfer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Finfer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Finfer.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -9,7 +9,6 @@ use rustc_middle::infer::canonical::{Canonical, CanonicalizedQueryResponse, Quer\n use rustc_middle::traits::query::Fallible;\n use rustc_middle::ty::subst::SubstsRef;\n use rustc_middle::ty::ToPredicate;\n-use rustc_middle::ty::WithConstness;\n use rustc_middle::ty::{self, Ty, TypeFoldable};\n use rustc_span::{Span, DUMMY_SP};\n "}, {"sha": "37d42e84cde889674e8669f991a82573868df227", "filename": "compiler/rustc_trait_selection/src/traits/error_reporting/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ferror_reporting%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ferror_reporting%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ferror_reporting%2Fmod.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -24,7 +24,7 @@ use rustc_middle::ty::error::ExpectedFound;\n use rustc_middle::ty::fold::TypeFolder;\n use rustc_middle::ty::{\n     self, fast_reject, AdtKind, SubtypePredicate, ToPolyTraitRef, ToPredicate, Ty, TyCtxt,\n-    TypeFoldable, WithConstness,\n+    TypeFoldable,\n };\n use rustc_session::DiagnosticMessageId;\n use rustc_span::symbol::{kw, sym};"}, {"sha": "af0a39b239fc44c8a8601f4e081e5403145ad2ad", "filename": "compiler/rustc_trait_selection/src/traits/error_reporting/suggestions.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ferror_reporting%2Fsuggestions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ferror_reporting%2Fsuggestions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Ferror_reporting%2Fsuggestions.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -21,7 +21,7 @@ use rustc_hir::lang_items::LangItem;\n use rustc_hir::{AsyncGeneratorKind, GeneratorKind, Node};\n use rustc_middle::ty::{\n     self, suggest_arbitrary_trait_bound, suggest_constraining_type_param, AdtKind, DefIdTree,\n-    Infer, InferTy, ToPredicate, Ty, TyCtxt, TypeFoldable, WithConstness,\n+    Infer, InferTy, ToPredicate, Ty, TyCtxt, TypeFoldable,\n };\n use rustc_middle::ty::{TypeAndMut, TypeckResults};\n use rustc_session::Limit;"}, {"sha": "d81b6949cae62a7a0462bf4c27ab5c619be16696", "filename": "compiler/rustc_trait_selection/src/traits/mod.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fmod.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -33,8 +33,7 @@ use rustc_hir::lang_items::LangItem;\n use rustc_middle::ty::fold::TypeFoldable;\n use rustc_middle::ty::subst::{InternalSubsts, SubstsRef};\n use rustc_middle::ty::{\n-    self, GenericParamDefKind, ToPredicate, Ty, TyCtxt, VtblEntry, WithConstness,\n-    COMMON_VTABLE_ENTRIES,\n+    self, GenericParamDefKind, ToPredicate, Ty, TyCtxt, VtblEntry, COMMON_VTABLE_ENTRIES,\n };\n use rustc_span::{sym, Span};\n use smallvec::SmallVec;"}, {"sha": "412f7923fb586dc801628b0d66d48981d39a3c69", "filename": "compiler/rustc_trait_selection/src/traits/object_safety.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fobject_safety.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fobject_safety.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fobject_safety.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -18,7 +18,7 @@ use rustc_errors::FatalError;\n use rustc_hir as hir;\n use rustc_hir::def_id::DefId;\n use rustc_middle::ty::subst::{GenericArg, InternalSubsts, Subst};\n-use rustc_middle::ty::{self, Ty, TyCtxt, TypeFoldable, TypeVisitor, WithConstness};\n+use rustc_middle::ty::{self, Ty, TyCtxt, TypeFoldable, TypeVisitor};\n use rustc_middle::ty::{Predicate, ToPredicate};\n use rustc_session::lint::builtin::WHERE_CLAUSES_OBJECT_SAFETY;\n use rustc_span::symbol::Symbol;"}, {"sha": "26398bfd810008febe2505baec19a776dc986d13", "filename": "compiler/rustc_trait_selection/src/traits/project.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fproject.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fproject.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fproject.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -27,7 +27,7 @@ use rustc_hir::lang_items::LangItem;\n use rustc_infer::infer::resolve::OpportunisticRegionResolver;\n use rustc_middle::ty::fold::{TypeFoldable, TypeFolder};\n use rustc_middle::ty::subst::Subst;\n-use rustc_middle::ty::{self, ToPredicate, Ty, TyCtxt, WithConstness};\n+use rustc_middle::ty::{self, ToPredicate, Ty, TyCtxt};\n use rustc_span::symbol::sym;\n \n use std::collections::BTreeMap;"}, {"sha": "89c01fe34400dc5490e21eb3253b2cee6f463f3e", "filename": "compiler/rustc_trait_selection/src/traits/select/candidate_assembly.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fselect%2Fcandidate_assembly.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fselect%2Fcandidate_assembly.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fselect%2Fcandidate_assembly.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -11,7 +11,7 @@ use rustc_infer::traits::TraitEngine;\n use rustc_infer::traits::{Obligation, SelectionError, TraitObligation};\n use rustc_lint_defs::builtin::DEREF_INTO_DYN_SUPERTRAIT;\n use rustc_middle::ty::print::with_no_trimmed_paths;\n-use rustc_middle::ty::{self, ToPredicate, Ty, TypeFoldable, WithConstness};\n+use rustc_middle::ty::{self, ToPredicate, Ty, TypeFoldable};\n use rustc_target::spec::abi::Abi;\n \n use crate::traits;"}, {"sha": "e9b368f683e5b8fd8ea1832488afc52f2b80247e", "filename": "compiler/rustc_trait_selection/src/traits/select/confirmation.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fselect%2Fconfirmation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fselect%2Fconfirmation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fselect%2Fconfirmation.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -13,7 +13,7 @@ use rustc_infer::infer::InferOk;\n use rustc_infer::infer::LateBoundRegionConversionTime::HigherRankedType;\n use rustc_middle::ty::subst::{GenericArg, GenericArgKind, Subst, SubstsRef};\n use rustc_middle::ty::{self, Ty};\n-use rustc_middle::ty::{ToPolyTraitRef, ToPredicate, WithConstness};\n+use rustc_middle::ty::{ToPolyTraitRef, ToPredicate};\n use rustc_span::def_id::DefId;\n \n use crate::traits::project::{normalize_with_depth, normalize_with_depth_to};"}, {"sha": "5577e98e89321fe5ee0265cddc311dc6d112a5f1", "filename": "compiler/rustc_trait_selection/src/traits/util.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Futil.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -6,7 +6,7 @@ use smallvec::SmallVec;\n use rustc_data_structures::fx::FxHashSet;\n use rustc_hir::def_id::DefId;\n use rustc_middle::ty::subst::{GenericArg, Subst, SubstsRef};\n-use rustc_middle::ty::{self, ToPredicate, Ty, TyCtxt, TypeFoldable, WithConstness};\n+use rustc_middle::ty::{self, ToPredicate, Ty, TyCtxt, TypeFoldable};\n \n use super::{Normalized, Obligation, ObligationCause, PredicateObligation, SelectionContext};\n pub use rustc_infer::traits::{self, util::*};"}, {"sha": "2197dcc0486412b93d4758436cd4c4772f0854c9", "filename": "compiler/rustc_trait_selection/src/traits/wf.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fwf.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fwf.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fwf.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -6,7 +6,7 @@ use rustc_hir as hir;\n use rustc_hir::def_id::DefId;\n use rustc_hir::lang_items::LangItem;\n use rustc_middle::ty::subst::{GenericArg, GenericArgKind, SubstsRef};\n-use rustc_middle::ty::{self, ToPredicate, Ty, TyCtxt, TypeFoldable, WithConstness};\n+use rustc_middle::ty::{self, ToPredicate, Ty, TyCtxt, TypeFoldable};\n use rustc_span::Span;\n \n use std::iter;"}, {"sha": "9a4639b088600254c0a3d33ae4980a9856abe523", "filename": "compiler/rustc_ty_utils/src/ty.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_ty_utils%2Fsrc%2Fty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_ty_utils%2Fsrc%2Fty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ty_utils%2Fsrc%2Fty.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -2,9 +2,7 @@ use rustc_data_structures::fx::FxIndexSet;\n use rustc_hir as hir;\n use rustc_hir::def_id::{DefId, LocalDefId};\n use rustc_middle::ty::subst::Subst;\n-use rustc_middle::ty::{\n-    self, Binder, Predicate, PredicateKind, ToPredicate, Ty, TyCtxt, WithConstness,\n-};\n+use rustc_middle::ty::{self, Binder, Predicate, PredicateKind, ToPredicate, Ty, TyCtxt};\n use rustc_span::Span;\n use rustc_trait_selection::traits;\n "}, {"sha": "8bc3a48e5b506d4d406f02062893c2cff081b2b7", "filename": "compiler/rustc_typeck/src/bounds.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_typeck%2Fsrc%2Fbounds.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_typeck%2Fsrc%2Fbounds.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fbounds.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -1,7 +1,7 @@\n //! Bounds are restrictions applied to some types after they've been converted into the\n //! `ty` form from the HIR.\n \n-use rustc_middle::ty::{self, ToPredicate, Ty, TyCtxt, WithConstness};\n+use rustc_middle::ty::{self, ToPredicate, Ty, TyCtxt};\n use rustc_span::Span;\n \n /// Collects together a list of type bounds. These lists of bounds occur in many places"}, {"sha": "03518dc8d127e788e73267e7aae751a58d1bd8a5", "filename": "compiler/rustc_typeck/src/check/method/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fmod.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -22,7 +22,7 @@ use rustc_infer::infer::{self, InferOk};\n use rustc_middle::ty::subst::Subst;\n use rustc_middle::ty::subst::{InternalSubsts, SubstsRef};\n use rustc_middle::ty::GenericParamDefKind;\n-use rustc_middle::ty::{self, ToPredicate, Ty, TypeFoldable, WithConstness};\n+use rustc_middle::ty::{self, ToPredicate, Ty, TypeFoldable};\n use rustc_span::symbol::Ident;\n use rustc_span::Span;\n use rustc_trait_selection::traits;"}, {"sha": "9f9f0df97a89461d36f7e2cb768fc2f34dbc9e20", "filename": "compiler/rustc_typeck/src/check/method/probe.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fprobe.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fprobe.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fprobe.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -21,7 +21,7 @@ use rustc_infer::infer::{self, InferOk, TyCtxtInferExt};\n use rustc_middle::middle::stability;\n use rustc_middle::ty::subst::{InternalSubsts, Subst, SubstsRef};\n use rustc_middle::ty::GenericParamDefKind;\n-use rustc_middle::ty::{self, ParamEnvAnd, ToPredicate, Ty, TyCtxt, TypeFoldable, WithConstness};\n+use rustc_middle::ty::{self, ParamEnvAnd, ToPredicate, Ty, TyCtxt, TypeFoldable};\n use rustc_session::lint;\n use rustc_span::def_id::LocalDefId;\n use rustc_span::lev_distance::{find_best_match_for_name, lev_distance};"}, {"sha": "6a3ce2132f815c4f97806aa45dc4229ef7915376", "filename": "compiler/rustc_typeck/src/check/method/suggest.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fsuggest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fsuggest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fmethod%2Fsuggest.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -12,7 +12,7 @@ use rustc_hir::{ExprKind, Node, QPath};\n use rustc_infer::infer::type_variable::{TypeVariableOrigin, TypeVariableOriginKind};\n use rustc_middle::ty::fast_reject::simplify_type;\n use rustc_middle::ty::print::with_crate_prefix;\n-use rustc_middle::ty::{self, ToPredicate, Ty, TyCtxt, TypeFoldable, WithConstness};\n+use rustc_middle::ty::{self, ToPredicate, Ty, TyCtxt, TypeFoldable};\n use rustc_span::lev_distance;\n use rustc_span::symbol::{kw, sym, Ident};\n use rustc_span::{source_map, FileName, MultiSpan, Span, Symbol};"}, {"sha": "9f6a411f24ba39f22bd73fc0499a414e121abc99", "filename": "compiler/rustc_typeck/src/check/wfcheck.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fwfcheck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fwfcheck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fwfcheck.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -21,7 +21,6 @@ use rustc_middle::ty::subst::{GenericArgKind, InternalSubsts, Subst};\n use rustc_middle::ty::trait_def::TraitSpecializationKind;\n use rustc_middle::ty::{\n     self, AdtKind, GenericParamDefKind, ToPredicate, Ty, TyCtxt, TypeFoldable, TypeVisitor,\n-    WithConstness,\n };\n use rustc_session::parse::feature_err;\n use rustc_span::symbol::{sym, Ident, Symbol};"}, {"sha": "19dcdbdff22a012afacb0afd7780fa6da03297ff", "filename": "compiler/rustc_typeck/src/collect.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_typeck%2Fsrc%2Fcollect.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a9a79f657c4a6b86483f3c1165e6f0ebbf77c927/compiler%2Frustc_typeck%2Fsrc%2Fcollect.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcollect.rs?ref=a9a79f657c4a6b86483f3c1165e6f0ebbf77c927", "patch": "@@ -41,7 +41,7 @@ use rustc_middle::ty::subst::InternalSubsts;\n use rustc_middle::ty::util::Discr;\n use rustc_middle::ty::util::IntTypeExt;\n use rustc_middle::ty::{self, AdtKind, Const, DefIdTree, Ty, TyCtxt};\n-use rustc_middle::ty::{ReprOptions, ToPredicate, WithConstness};\n+use rustc_middle::ty::{ReprOptions, ToPredicate};\n use rustc_session::lint;\n use rustc_session::parse::feature_err;\n use rustc_span::symbol::{kw, sym, Ident, Symbol};"}]}