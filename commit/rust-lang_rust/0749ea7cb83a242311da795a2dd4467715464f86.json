{"sha": "0749ea7cb83a242311da795a2dd4467715464f86", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA3NDllYTdjYjgzYTI0MjMxMWRhNzk1YTJkZDQ0Njc3MTU0NjRmODY=", "commit": {"author": {"name": "Mara Bos", "email": "m-ou.se@m-ou.se", "date": "2021-04-21T21:06:23Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-04-21T21:06:23Z"}, "message": "Rollup merge of #84393 - GuillaumeGomez:better-open-handling, r=jyn514\n\nSupport `x.py doc std --open`\n\nI usually run this command:\n\n```\n./x.py doc std --stage 1 --jobs 8\n```\n\nThen I gave a try to `--open` and realized it wasn't working. I finally realized it was simply because it was only handling paths starting with `library`. This PR allows to handle both kinds of paths.\n\ncc ``@jyn514``\nr? ``@Mark-Simulacrum``", "tree": {"sha": "a72ec8ade6cb7c9756bcf6d56a5616700755d6ff", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a72ec8ade6cb7c9756bcf6d56a5616700755d6ff"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0749ea7cb83a242311da795a2dd4467715464f86", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJggJPPCRBK7hj4Ov3rIwAAflgIABjMV++HcOxoxkiJw3BCKco4\nLNjtX0Z64BO1w1H2fxYPAMKFG4p0z9ov75FdUswxcVaTNr3Xor8YvtST+ikGMBy1\ncYix0xHnLoJvM9DQmwsZrXGPTewsh9jF0Wx2JvJNnKvidFAE6NuwzhAO5suDSykx\nqobgjQz6s6bBNUXL+Fryr3LQlZ+9YSxXmxa1OWulvatMRqCx1SsZhbfn8iXmYX5U\npkdBaSCor2aBuEWWu0nJ0gMim+iv9qmk3YJd1IopFv+se/1FH8iI9iGFDfQTuDAM\nHVTcon/OatNj/f9JUocce6SCHZ6htU56YScaLh+hVQ1QIQcnkEeSeV/Ck6Iut3s=\n=7Jzo\n-----END PGP SIGNATURE-----\n", "payload": "tree a72ec8ade6cb7c9756bcf6d56a5616700755d6ff\nparent 49a5c80a3bbe96903be207ec04bb08bfd14cb9e4\nparent cc44ce0a3f379bc6e8a4078ee6f0b1a4237fa975\nauthor Mara Bos <m-ou.se@m-ou.se> 1619039183 +0200\ncommitter GitHub <noreply@github.com> 1619039183 +0200\n\nRollup merge of #84393 - GuillaumeGomez:better-open-handling, r=jyn514\n\nSupport `x.py doc std --open`\n\nI usually run this command:\n\n```\n./x.py doc std --stage 1 --jobs 8\n```\n\nThen I gave a try to `--open` and realized it wasn't working. I finally realized it was simply because it was only handling paths starting with `library`. This PR allows to handle both kinds of paths.\n\ncc ``@jyn514``\nr? ``@Mark-Simulacrum``\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0749ea7cb83a242311da795a2dd4467715464f86", "html_url": "https://github.com/rust-lang/rust/commit/0749ea7cb83a242311da795a2dd4467715464f86", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0749ea7cb83a242311da795a2dd4467715464f86/comments", "author": {"login": "m-ou-se", "id": 783247, "node_id": "MDQ6VXNlcjc4MzI0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/783247?v=4", "gravatar_id": "", "url": "https://api.github.com/users/m-ou-se", "html_url": "https://github.com/m-ou-se", "followers_url": "https://api.github.com/users/m-ou-se/followers", "following_url": "https://api.github.com/users/m-ou-se/following{/other_user}", "gists_url": "https://api.github.com/users/m-ou-se/gists{/gist_id}", "starred_url": "https://api.github.com/users/m-ou-se/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/m-ou-se/subscriptions", "organizations_url": "https://api.github.com/users/m-ou-se/orgs", "repos_url": "https://api.github.com/users/m-ou-se/repos", "events_url": "https://api.github.com/users/m-ou-se/events{/privacy}", "received_events_url": "https://api.github.com/users/m-ou-se/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "49a5c80a3bbe96903be207ec04bb08bfd14cb9e4", "url": "https://api.github.com/repos/rust-lang/rust/commits/49a5c80a3bbe96903be207ec04bb08bfd14cb9e4", "html_url": "https://github.com/rust-lang/rust/commit/49a5c80a3bbe96903be207ec04bb08bfd14cb9e4"}, {"sha": "cc44ce0a3f379bc6e8a4078ee6f0b1a4237fa975", "url": "https://api.github.com/repos/rust-lang/rust/commits/cc44ce0a3f379bc6e8a4078ee6f0b1a4237fa975", "html_url": "https://github.com/rust-lang/rust/commit/cc44ce0a3f379bc6e8a4078ee6f0b1a4237fa975"}], "stats": {"total": 16, "additions": 10, "deletions": 6}, "files": [{"sha": "a32b92ef1af83d0da472cad66b3e9a6ce0141d79", "filename": "src/bootstrap/doc.rs", "status": "modified", "additions": 10, "deletions": 6, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/0749ea7cb83a242311da795a2dd4467715464f86/src%2Fbootstrap%2Fdoc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0749ea7cb83a242311da795a2dd4467715464f86/src%2Fbootstrap%2Fdoc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdoc.rs?ref=0749ea7cb83a242311da795a2dd4467715464f86", "patch": "@@ -470,12 +470,16 @@ impl Step for Std {\n         // Look for library/std, library/core etc in the `x.py doc` arguments and\n         // open the corresponding rendered docs.\n         for path in builder.paths.iter().map(components_simplified) {\n-            if path.get(0) == Some(&\"library\") {\n-                let requested_crate = &path[1];\n-                if krates.contains(&requested_crate) {\n-                    let index = out.join(requested_crate).join(\"index.html\");\n-                    open(builder, &index);\n-                }\n+            let requested_crate = if path.get(0) == Some(&\"library\") {\n+                &path[1]\n+            } else if !path.is_empty() {\n+                &path[0]\n+            } else {\n+                continue;\n+            };\n+            if krates.contains(&requested_crate) {\n+                let index = out.join(requested_crate).join(\"index.html\");\n+                open(builder, &index);\n             }\n         }\n     }"}]}