{"sha": "7bf0736e130e2203c58654f7353dbf9575e49d5c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdiZjA3MzZlMTMwZTIyMDNjNTg2NTRmNzM1M2RiZjk1NzVlNDlkNWM=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-09-10T12:26:55Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-09-10T12:26:55Z"}, "message": "Auto merge of #88797 - m-ou-se:uhhhh, r=pietroalbini\n\nWork around CI issue with windows sdk 10.0.20348.0.\n\nSee https://github.com/rust-lang/rust/issues/88796#issuecomment-916844522", "tree": {"sha": "bc6e76c9882a8471729177dac161dc49d0df9bae", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bc6e76c9882a8471729177dac161dc49d0df9bae"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7bf0736e130e2203c58654f7353dbf9575e49d5c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7bf0736e130e2203c58654f7353dbf9575e49d5c", "html_url": "https://github.com/rust-lang/rust/commit/7bf0736e130e2203c58654f7353dbf9575e49d5c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7bf0736e130e2203c58654f7353dbf9575e49d5c/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "497ee321af3b8496eaccd7af7b437f18bab81abf", "url": "https://api.github.com/repos/rust-lang/rust/commits/497ee321af3b8496eaccd7af7b437f18bab81abf", "html_url": "https://github.com/rust-lang/rust/commit/497ee321af3b8496eaccd7af7b437f18bab81abf"}, {"sha": "8059bc1069b88a51ec2dfc2483854b9a854b1994", "url": "https://api.github.com/repos/rust-lang/rust/commits/8059bc1069b88a51ec2dfc2483854b9a854b1994", "html_url": "https://github.com/rust-lang/rust/commit/8059bc1069b88a51ec2dfc2483854b9a854b1994"}], "stats": {"total": 22, "additions": 22, "deletions": 0}, "files": [{"sha": "78ff874e7550114f3919a77a108a9fd93514b788", "filename": ".github/workflows/ci.yml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/7bf0736e130e2203c58654f7353dbf9575e49d5c/.github%2Fworkflows%2Fci.yml", "raw_url": "https://github.com/rust-lang/rust/raw/7bf0736e130e2203c58654f7353dbf9575e49d5c/.github%2Fworkflows%2Fci.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.github%2Fworkflows%2Fci.yml?ref=7bf0736e130e2203c58654f7353dbf9575e49d5c", "patch": "@@ -404,6 +404,7 @@ jobs:\n               RUST_CONFIGURE_ARGS: \"--build=x86_64-pc-windows-msvc --host=aarch64-pc-windows-msvc --enable-full-tools --enable-profiler\"\n               SCRIPT: python x.py dist\n               DIST_REQUIRE_ALL_TOOLS: 0\n+              WINDOWS_SDK_20348_HACK: 1\n             os: windows-latest-xl\n           - name: dist-i686-mingw\n             env:"}, {"sha": "c9f8692d41887e1546d32836cece40f546f421cf", "filename": "src/ci/github-actions/ci.yml", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/7bf0736e130e2203c58654f7353dbf9575e49d5c/src%2Fci%2Fgithub-actions%2Fci.yml", "raw_url": "https://github.com/rust-lang/rust/raw/7bf0736e130e2203c58654f7353dbf9575e49d5c/src%2Fci%2Fgithub-actions%2Fci.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fgithub-actions%2Fci.yml?ref=7bf0736e130e2203c58654f7353dbf9575e49d5c", "patch": "@@ -635,6 +635,9 @@ jobs:\n               SCRIPT: python x.py dist\n               # RLS does not build for aarch64-pc-windows-msvc. See rust-lang/rls#1693\n               DIST_REQUIRE_ALL_TOOLS: 0\n+              # Hack around this SDK version, because it doesn't work with clang.\n+              # See https://github.com/rust-lang/rust/issues/88796\n+              WINDOWS_SDK_20348_HACK: 1\n             <<: *job-windows-xl\n \n           - name: dist-i686-mingw"}, {"sha": "fd29d3a022ad3860be66cbb67bf69415daee65a7", "filename": "src/ci/scripts/install-clang.sh", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/7bf0736e130e2203c58654f7353dbf9575e49d5c/src%2Fci%2Fscripts%2Finstall-clang.sh", "raw_url": "https://github.com/rust-lang/rust/raw/7bf0736e130e2203c58654f7353dbf9575e49d5c/src%2Fci%2Fscripts%2Finstall-clang.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fscripts%2Finstall-clang.sh?ref=7bf0736e130e2203c58654f7353dbf9575e49d5c", "patch": "@@ -37,6 +37,12 @@ if isMacOS; then\n     # `clang-ar` by accident.\n     ciCommandSetEnv AR \"ar\"\n elif isWindows && [[ ${CUSTOM_MINGW-0} -ne 1 ]]; then\n+\n+    if [[ ${WINDOWS_SDK_20348_HACK-0} -eq 1 ]]; then\n+        rm -rf '/c/Program Files (x86)/Windows Kits/10/include/10.0.20348.0'\n+        mv '/c/Program Files (x86)/Windows Kits/10/include/'10.0.{19041,20348}.0\n+    fi\n+\n     # If we're compiling for MSVC then we, like most other distribution builders,\n     # switch to clang as the compiler. This'll allow us eventually to enable LTO\n     # amongst LLVM and rustc. Note that we only do this on MSVC as I don't think"}, {"sha": "d300e374bec909e22d0b8356f566b680f13f67ef", "filename": "src/test/debuginfo/basic-types.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/7bf0736e130e2203c58654f7353dbf9575e49d5c/src%2Ftest%2Fdebuginfo%2Fbasic-types.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7bf0736e130e2203c58654f7353dbf9575e49d5c/src%2Ftest%2Fdebuginfo%2Fbasic-types.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fdebuginfo%2Fbasic-types.rs?ref=7bf0736e130e2203c58654f7353dbf9575e49d5c", "patch": "@@ -9,6 +9,10 @@\n // This fails on lldb 6.0.1 on x86-64 Fedora 28; so ignore Linux for now.\n // ignore-linux\n \n+// This started failing in windows too. See https://github.com/rust-lang/rust/issues/88796\n+// FIXME: fix and unignore this on windows\n+// ignore-windows\n+\n // compile-flags:-g\n \n // === GDB TESTS ==================================================================================="}, {"sha": "67b5da510f843e5d8c55f64785a8d5a697616f68", "filename": "src/test/debuginfo/msvc-pretty-enums.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/7bf0736e130e2203c58654f7353dbf9575e49d5c/src%2Ftest%2Fdebuginfo%2Fmsvc-pretty-enums.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7bf0736e130e2203c58654f7353dbf9575e49d5c/src%2Ftest%2Fdebuginfo%2Fmsvc-pretty-enums.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fdebuginfo%2Fmsvc-pretty-enums.rs?ref=7bf0736e130e2203c58654f7353dbf9575e49d5c", "patch": "@@ -2,6 +2,10 @@\n // ignore-tidy-linelength\n // compile-flags:-g\n \n+// This started failing recently. See https://github.com/rust-lang/rust/issues/88796\n+// FIXME: fix and unignore this\n+// ignore-windows\n+\n // cdb-command: g\n \n // Note: The natvis used to visualize niche-layout enums don't work correctly in cdb"}, {"sha": "cb2e6c618b1ab209ba016a1711bfee9e9cf4e72d", "filename": "src/test/debuginfo/pretty-std.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/7bf0736e130e2203c58654f7353dbf9575e49d5c/src%2Ftest%2Fdebuginfo%2Fpretty-std.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7bf0736e130e2203c58654f7353dbf9575e49d5c/src%2Ftest%2Fdebuginfo%2Fpretty-std.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fdebuginfo%2Fpretty-std.rs?ref=7bf0736e130e2203c58654f7353dbf9575e49d5c", "patch": "@@ -6,6 +6,10 @@\n // min-lldb-version: 310\n // min-cdb-version: 10.0.18317.1001\n \n+// This started failing recently. See https://github.com/rust-lang/rust/issues/88796\n+// FIXME: fix and unignore this\n+// ignore-windows\n+\n // === GDB TESTS ===================================================================================\n \n // gdb-command: run"}]}