{"sha": "b053da3a68d5185fdab10ca7fd4b17c1552d88ca", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIwNTNkYTNhNjhkNTE4NWZkYWIxMGNhN2ZkNGIxN2MxNTUyZDg4Y2E=", "commit": {"author": {"name": "Eduard-Mihai Burtescu", "email": "edy.burt@gmail.com", "date": "2016-08-06T12:01:22Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2016-08-06T12:01:22Z"}, "message": "Rollup merge of #35373 - oijazsh:E0107, r=jonathandturner\n\nUpdate E0107 message to new format\n\nFixes #35246 as part of #35233.\n\nr? @jonathandturner", "tree": {"sha": "6454b9e788b6cfe4275576f26818d67a65a462b5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6454b9e788b6cfe4275576f26818d67a65a462b5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b053da3a68d5185fdab10ca7fd4b17c1552d88ca", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b053da3a68d5185fdab10ca7fd4b17c1552d88ca", "html_url": "https://github.com/rust-lang/rust/commit/b053da3a68d5185fdab10ca7fd4b17c1552d88ca", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b053da3a68d5185fdab10ca7fd4b17c1552d88ca/comments", "author": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "aba49ac981bf7bf980f3ba21227ffaf1424c1813", "url": "https://api.github.com/repos/rust-lang/rust/commits/aba49ac981bf7bf980f3ba21227ffaf1424c1813", "html_url": "https://github.com/rust-lang/rust/commit/aba49ac981bf7bf980f3ba21227ffaf1424c1813"}, {"sha": "2061d656e5ba2225a58e1073c9a0a22eef4f0ece", "url": "https://api.github.com/repos/rust-lang/rust/commits/2061d656e5ba2225a58e1073c9a0a22eef4f0ece", "html_url": "https://github.com/rust-lang/rust/commit/2061d656e5ba2225a58e1073c9a0a22eef4f0ece"}], "stats": {"total": 39, "additions": 33, "deletions": 6}, "files": [{"sha": "50ffa52e88ba497e5c6833635470a78a7ed6a4b8", "filename": "src/librustc_typeck/astconv.rs", "status": "modified", "additions": 19, "deletions": 3, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/b053da3a68d5185fdab10ca7fd4b17c1552d88ca/src%2Flibrustc_typeck%2Fastconv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b053da3a68d5185fdab10ca7fd4b17c1552d88ca/src%2Flibrustc_typeck%2Fastconv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fastconv.rs?ref=b053da3a68d5185fdab10ca7fd4b17c1552d88ca", "patch": "@@ -2273,9 +2273,25 @@ fn check_type_argument_count(tcx: TyCtxt, span: Span, supplied: usize,\n }\n \n fn report_lifetime_number_error(tcx: TyCtxt, span: Span, number: usize, expected: usize) {\n-    span_err!(tcx.sess, span, E0107,\n-              \"wrong number of lifetime parameters: expected {}, found {}\",\n-              expected, number);\n+    let label = if number < expected {\n+        if expected == 1 {\n+            format!(\"expected {} lifetime parameter\", expected)\n+        } else {\n+            format!(\"expected {} lifetime parameters\", expected)\n+        }\n+    } else {\n+        let additional = number - expected;\n+        if additional == 1 {\n+            \"unexpected lifetime parameter\".to_string()\n+        } else {\n+            format!(\"{} unexpected lifetime parameters\", additional)\n+        }\n+    };\n+    struct_span_err!(tcx.sess, span, E0107,\n+                     \"wrong number of lifetime parameters: expected {}, found {}\",\n+                     expected, number)\n+        .span_label(span, &label)\n+        .emit();\n }\n \n // A helper struct for conveniently grouping a set of bounds which we pass to"}, {"sha": "5f333e17c478efeabaeec150842e1bd4530df4ff", "filename": "src/test/compile-fail/E0107.rs", "status": "modified", "additions": 14, "deletions": 3, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/b053da3a68d5185fdab10ca7fd4b17c1552d88ca/src%2Ftest%2Fcompile-fail%2FE0107.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b053da3a68d5185fdab10ca7fd4b17c1552d88ca/src%2Ftest%2Fcompile-fail%2FE0107.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2FE0107.rs?ref=b053da3a68d5185fdab10ca7fd4b17c1552d88ca", "patch": "@@ -9,16 +9,27 @@\n // except according to those terms.\n \n struct Foo<'a>(&'a str);\n+struct Buzz<'a, 'b>(&'a str, &'b str);\n \n enum Bar {\n     A,\n     B,\n     C,\n }\n \n-struct Baz<'a> {\n-    foo: Foo, //~ ERROR E0107\n-    bar: Bar<'a>, //~ ERROR E0107\n+struct Baz<'a, 'b, 'c> {\n+    foo: Foo,\n+    //~^ ERROR E0107\n+    //~| expected 1 lifetime parameter\n+    buzz: Buzz<'a>,\n+    //~^ ERROR E0107\n+    //~| expected 2 lifetime parameters\n+    bar: Bar<'a>,\n+    //~^ ERROR E0107\n+    //~| unexpected lifetime parameter\n+    foo2: Foo<'a, 'b, 'c>,\n+    //~^ ERROR E0107\n+    //~| 2 unexpected lifetime parameters\n }\n \n fn main() {"}]}