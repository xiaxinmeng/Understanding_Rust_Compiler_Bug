{"sha": "55caf1dcd35789bee98a4fd2b537f57cf7edd77a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU1Y2FmMWRjZDM1Nzg5YmVlOThhNGZkMmI1MzdmNTdjZjdlZGQ3N2E=", "commit": {"author": {"name": "Joel Galenson", "email": "jgalenson@google.com", "date": "2019-08-14T15:30:59Z"}, "committer": {"name": "Joel Galenson", "email": "jgalenson@google.com", "date": "2019-08-14T15:30:59Z"}, "message": "Remap paths for proc-macro crates.\n\nThe remap-debuginfo config option remaps paths in most crates, but it\ndoes not apply to proc-macros, so they are still non-reproducible.\nThis patch fixes that.", "tree": {"sha": "29e0a0867e60659e568318fd440f95689b1c67a1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/29e0a0867e60659e568318fd440f95689b1c67a1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/55caf1dcd35789bee98a4fd2b537f57cf7edd77a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/55caf1dcd35789bee98a4fd2b537f57cf7edd77a", "html_url": "https://github.com/rust-lang/rust/commit/55caf1dcd35789bee98a4fd2b537f57cf7edd77a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/55caf1dcd35789bee98a4fd2b537f57cf7edd77a/comments", "author": {"login": "jgalenson", "id": 505819, "node_id": "MDQ6VXNlcjUwNTgxOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/505819?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jgalenson", "html_url": "https://github.com/jgalenson", "followers_url": "https://api.github.com/users/jgalenson/followers", "following_url": "https://api.github.com/users/jgalenson/following{/other_user}", "gists_url": "https://api.github.com/users/jgalenson/gists{/gist_id}", "starred_url": "https://api.github.com/users/jgalenson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jgalenson/subscriptions", "organizations_url": "https://api.github.com/users/jgalenson/orgs", "repos_url": "https://api.github.com/users/jgalenson/repos", "events_url": "https://api.github.com/users/jgalenson/events{/privacy}", "received_events_url": "https://api.github.com/users/jgalenson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jgalenson", "id": 505819, "node_id": "MDQ6VXNlcjUwNTgxOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/505819?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jgalenson", "html_url": "https://github.com/jgalenson", "followers_url": "https://api.github.com/users/jgalenson/followers", "following_url": "https://api.github.com/users/jgalenson/following{/other_user}", "gists_url": "https://api.github.com/users/jgalenson/gists{/gist_id}", "starred_url": "https://api.github.com/users/jgalenson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jgalenson/subscriptions", "organizations_url": "https://api.github.com/users/jgalenson/orgs", "repos_url": "https://api.github.com/users/jgalenson/repos", "events_url": "https://api.github.com/users/jgalenson/events{/privacy}", "received_events_url": "https://api.github.com/users/jgalenson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c01be67ea40266d6a4c3289654a07ddd7ce2a172", "url": "https://api.github.com/repos/rust-lang/rust/commits/c01be67ea40266d6a4c3289654a07ddd7ce2a172", "html_url": "https://github.com/rust-lang/rust/commit/c01be67ea40266d6a4c3289654a07ddd7ce2a172"}], "stats": {"total": 10, "additions": 10, "deletions": 0}, "files": [{"sha": "c524cf646dd57bf99a3544f825abdc67635321a1", "filename": "src/bootstrap/bin/rustc.rs", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/55caf1dcd35789bee98a4fd2b537f57cf7edd77a/src%2Fbootstrap%2Fbin%2Frustc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/55caf1dcd35789bee98a4fd2b537f57cf7edd77a/src%2Fbootstrap%2Fbin%2Frustc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbin%2Frustc.rs?ref=55caf1dcd35789bee98a4fd2b537f57cf7edd77a", "patch": "@@ -305,6 +305,16 @@ fn main() {\n                 cmd.arg(\"-C\").arg(\"target-feature=-crt-static\");\n             }\n         }\n+\n+        let crate_type = args.windows(2)\n+            .find(|w| &*w[0] == \"--crate-type\")\n+            .and_then(|w| w[1].to_str());\n+\n+        if let Some(\"proc-macro\") = crate_type {\n+            if let Ok(map) = env::var(\"RUSTC_DEBUGINFO_MAP\") {\n+                cmd.arg(\"--remap-path-prefix\").arg(&map);\n+            }\n+        }\n     }\n \n     // Force all crates compiled by this compiler to (a) be unstable and (b)"}]}