{"sha": "d3be26d6a8eaf3b5a7c22ba2324ef0751835ce26", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQzYmUyNmQ2YThlYWYzYjVhN2MyMmJhMjMyNGVmMDc1MTgzNWNlMjY=", "commit": {"author": {"name": "Jonas Schievink", "email": "jonasschievink@gmail.com", "date": "2019-06-14T19:59:11Z"}, "committer": {"name": "Jonas Schievink", "email": "jonasschievink@gmail.com", "date": "2020-02-21T18:41:21Z"}, "message": "Improve test", "tree": {"sha": "98d58d19c1f9136fd2ccb75b9a5b5bda7aed97e7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/98d58d19c1f9136fd2ccb75b9a5b5bda7aed97e7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d3be26d6a8eaf3b5a7c22ba2324ef0751835ce26", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d3be26d6a8eaf3b5a7c22ba2324ef0751835ce26", "html_url": "https://github.com/rust-lang/rust/commit/d3be26d6a8eaf3b5a7c22ba2324ef0751835ce26", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d3be26d6a8eaf3b5a7c22ba2324ef0751835ce26/comments", "author": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1e3c02006372ca68d07d32493660583cc1c9e12c", "url": "https://api.github.com/repos/rust-lang/rust/commits/1e3c02006372ca68d07d32493660583cc1c9e12c", "html_url": "https://github.com/rust-lang/rust/commit/1e3c02006372ca68d07d32493660583cc1c9e12c"}], "stats": {"total": 49, "additions": 45, "deletions": 4}, "files": [{"sha": "e3a5db0960cf0ff8ed8d01f956127cae7dfeba16", "filename": "src/test/ui/associated-types/defaults-specialization.rs", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/d3be26d6a8eaf3b5a7c22ba2324ef0751835ce26/src%2Ftest%2Fui%2Fassociated-types%2Fdefaults-specialization.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d3be26d6a8eaf3b5a7c22ba2324ef0751835ce26/src%2Ftest%2Fui%2Fassociated-types%2Fdefaults-specialization.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fassociated-types%2Fdefaults-specialization.rs?ref=d3be26d6a8eaf3b5a7c22ba2324ef0751835ce26", "patch": "@@ -1,3 +1,5 @@\n+//! Tests the interaction of associated type defaults and specialization.\n+\n // compile-fail\n \n #![feature(associated_type_defaults, specialization)]\n@@ -16,6 +18,13 @@ default impl<T> Tr for A<T> {\n     //~^ ERROR method `make` has an incompatible type for trait\n }\n \n+struct A2<T>(T);\n+// ...same, but in the method body\n+default impl<T> Tr for A2<T> {\n+    fn make() -> Self::Ty { 0u8 }\n+    //~^ ERROR mismatched types\n+}\n+\n struct B<T>(T);\n // Explicitly defaulting the type does the same.\n impl<T> Tr for B<T> {\n@@ -25,6 +34,15 @@ impl<T> Tr for B<T> {\n     //~^ ERROR method `make` has an incompatible type for trait\n }\n \n+struct B2<T>(T);\n+// ...same, but in the method body\n+impl<T> Tr for B2<T> {\n+    default type Ty = bool;\n+\n+    fn make() -> Self::Ty { true }\n+    //~^ ERROR mismatched types\n+}\n+\n struct C<T>(T);\n // Only the method is defaulted, so this is fine.\n impl<T> Tr for C<T> {"}, {"sha": "2b2adfdb7c9650e8df9885f2500893939ddb11b0", "filename": "src/test/ui/associated-types/defaults-specialization.stderr", "status": "modified", "additions": 27, "deletions": 4, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/d3be26d6a8eaf3b5a7c22ba2324ef0751835ce26/src%2Ftest%2Fui%2Fassociated-types%2Fdefaults-specialization.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d3be26d6a8eaf3b5a7c22ba2324ef0751835ce26/src%2Ftest%2Fui%2Fassociated-types%2Fdefaults-specialization.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fassociated-types%2Fdefaults-specialization.stderr?ref=d3be26d6a8eaf3b5a7c22ba2324ef0751835ce26", "patch": "@@ -1,5 +1,5 @@\n error[E0053]: method `make` has an incompatible type for trait\n-  --> $DIR/defaults-specialization.rs:15:18\n+  --> $DIR/defaults-specialization.rs:17:18\n    |\n LL |     fn make() -> Self::Ty;\n    |                  -------- type in trait\n@@ -11,7 +11,7 @@ LL |     fn make() -> u8 { 0 }\n               found type `fn() -> u8`\n \n error[E0053]: method `make` has an incompatible type for trait\n-  --> $DIR/defaults-specialization.rs:24:18\n+  --> $DIR/defaults-specialization.rs:33:18\n    |\n LL |     fn make() -> Self::Ty;\n    |                  -------- type in trait\n@@ -22,6 +22,29 @@ LL |     fn make() -> bool { true }\n    = note: expected type `fn() -> <B<T> as Tr>::Ty`\n               found type `fn() -> bool`\n \n-error: aborting due to 2 previous errors\n+error[E0308]: mismatched types\n+  --> $DIR/defaults-specialization.rs:24:29\n+   |\n+LL |     fn make() -> Self::Ty { 0u8 }\n+   |                  --------   ^^^ expected associated type, found u8\n+   |                  |\n+   |                  expected `<A2<T> as Tr>::Ty` because of return type\n+   |\n+   = note: expected type `<A2<T> as Tr>::Ty`\n+              found type `u8`\n+\n+error[E0308]: mismatched types\n+  --> $DIR/defaults-specialization.rs:42:29\n+   |\n+LL |     fn make() -> Self::Ty { true }\n+   |                  --------   ^^^^ expected associated type, found bool\n+   |                  |\n+   |                  expected `<B2<T> as Tr>::Ty` because of return type\n+   |\n+   = note: expected type `<B2<T> as Tr>::Ty`\n+              found type `bool`\n+\n+error: aborting due to 4 previous errors\n \n-For more information about this error, try `rustc --explain E0053`.\n+Some errors have detailed explanations: E0053, E0308.\n+For more information about an error, try `rustc --explain E0053`."}]}