{"sha": "7bbfac60e3cf502c34809a3572e108ca4dde2ef5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdiYmZhYzYwZTNjZjUwMmMzNDgwOWEzNTcyZTEwOGNhNGRkZTJlZjU=", "commit": {"author": {"name": "Eric Roshan-Eisner", "email": "edre@google.com", "date": "2016-10-04T21:33:16Z"}, "committer": {"name": "Eric Roshan-Eisner", "email": "edre@google.com", "date": "2016-10-04T21:48:03Z"}, "message": "update sip.rs for new intrinsics and defaults", "tree": {"sha": "31f2f7df9bb14759cb3733972362044414907dc5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/31f2f7df9bb14759cb3733972362044414907dc5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7bbfac60e3cf502c34809a3572e108ca4dde2ef5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7bbfac60e3cf502c34809a3572e108ca4dde2ef5", "html_url": "https://github.com/rust-lang/rust/commit/7bbfac60e3cf502c34809a3572e108ca4dde2ef5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7bbfac60e3cf502c34809a3572e108ca4dde2ef5/comments", "author": {"login": "edre", "id": 1291499, "node_id": "MDQ6VXNlcjEyOTE0OTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1291499?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edre", "html_url": "https://github.com/edre", "followers_url": "https://api.github.com/users/edre/followers", "following_url": "https://api.github.com/users/edre/following{/other_user}", "gists_url": "https://api.github.com/users/edre/gists{/gist_id}", "starred_url": "https://api.github.com/users/edre/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edre/subscriptions", "organizations_url": "https://api.github.com/users/edre/orgs", "repos_url": "https://api.github.com/users/edre/repos", "events_url": "https://api.github.com/users/edre/events{/privacy}", "received_events_url": "https://api.github.com/users/edre/received_events", "type": "User", "site_admin": false}, "committer": {"login": "edre", "id": 1291499, "node_id": "MDQ6VXNlcjEyOTE0OTk=", "avatar_url": "https://avatars.githubusercontent.com/u/1291499?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edre", "html_url": "https://github.com/edre", "followers_url": "https://api.github.com/users/edre/followers", "following_url": "https://api.github.com/users/edre/following{/other_user}", "gists_url": "https://api.github.com/users/edre/gists{/gist_id}", "starred_url": "https://api.github.com/users/edre/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edre/subscriptions", "organizations_url": "https://api.github.com/users/edre/orgs", "repos_url": "https://api.github.com/users/edre/repos", "events_url": "https://api.github.com/users/edre/events{/privacy}", "received_events_url": "https://api.github.com/users/edre/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a5dac7a2af3ee444817eb7bfbba3539be8c06cf1", "url": "https://api.github.com/repos/rust-lang/rust/commits/a5dac7a2af3ee444817eb7bfbba3539be8c06cf1", "html_url": "https://github.com/rust-lang/rust/commit/a5dac7a2af3ee444817eb7bfbba3539be8c06cf1"}], "stats": {"total": 23, "additions": 9, "deletions": 14}, "files": [{"sha": "fc74669635934b6fae563c8b2241721aeb96d0eb", "filename": "src/libcore/hash/sip.rs", "status": "modified", "additions": 9, "deletions": 14, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/7bbfac60e3cf502c34809a3572e108ca4dde2ef5/src%2Flibcore%2Fhash%2Fsip.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7bbfac60e3cf502c34809a3572e108ca4dde2ef5/src%2Flibcore%2Fhash%2Fsip.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fhash%2Fsip.rs?ref=7bbfac60e3cf502c34809a3572e108ca4dde2ef5", "patch": "@@ -17,6 +17,9 @@ use ptr;\n \n /// An implementation of SipHash 1-3.\n ///\n+/// This is currently the default hashing function used by standard library\n+/// (eg. `collections::HashMap` uses it by default).\n+///\n /// See: https://131002.net/siphash/\n #[unstable(feature = \"sip_hash_13\", issue = \"34767\")]\n #[rustc_deprecated(since = \"1.13.0\", reason = \"use `DefaultHasher` instead\")]\n@@ -39,9 +42,6 @@ pub struct SipHasher24 {\n ///\n /// See: https://131002.net/siphash/\n ///\n-/// This is currently the default hashing function used by standard library\n-/// (eg. `collections::HashMap` uses it by default).\n-///\n /// SipHash is a general-purpose hashing function: it runs at a good\n /// speed (competitive with Spooky and City) and permits strong _keyed_\n /// hashing. This lets you key your hashtables from a strong RNG, such as\n@@ -117,23 +117,18 @@ unsafe fn load_u64_le(buf: &[u8], i: usize) -> u64 {\n     data.to_le()\n }\n \n-macro_rules! rotl {\n-    ($x:expr, $b:expr) =>\n-    (($x << $b) | ($x >> (64_i32.wrapping_sub($b))))\n-}\n-\n macro_rules! compress {\n     ($state:expr) => ({\n         compress!($state.v0, $state.v1, $state.v2, $state.v3)\n     });\n     ($v0:expr, $v1:expr, $v2:expr, $v3:expr) =>\n     ({\n-        $v0 = $v0.wrapping_add($v1); $v1 = rotl!($v1, 13); $v1 ^= $v0;\n-        $v0 = rotl!($v0, 32);\n-        $v2 = $v2.wrapping_add($v3); $v3 = rotl!($v3, 16); $v3 ^= $v2;\n-        $v0 = $v0.wrapping_add($v3); $v3 = rotl!($v3, 21); $v3 ^= $v0;\n-        $v2 = $v2.wrapping_add($v1); $v1 = rotl!($v1, 17); $v1 ^= $v2;\n-        $v2 = rotl!($v2, 32);\n+        $v0 = $v0.wrapping_add($v1); $v1 = $v1.rotate_left(13); $v1 ^= $v0;\n+        $v0 = $v0.rotate_left(32);\n+        $v2 = $v2.wrapping_add($v3); $v3 = $v3.rotate_left(16); $v3 ^= $v2;\n+        $v0 = $v0.wrapping_add($v3); $v3 = $v3.rotate_left(21); $v3 ^= $v0;\n+        $v2 = $v2.wrapping_add($v1); $v1 = $v1.rotate_left(17); $v1 ^= $v2;\n+        $v2 = $v2.rotate_left(32);\n     });\n }\n "}]}