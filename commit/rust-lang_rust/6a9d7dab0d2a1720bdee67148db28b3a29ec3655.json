{"sha": "6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZhOWQ3ZGFiMGQyYTE3MjBiZGVlNjcxNDhkYjI4YjNhMjllYzM2NTU=", "commit": {"author": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2017-06-06T04:20:16Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2017-06-06T04:20:16Z"}, "message": "Merge pull request #1637 from est31/master\n\nAdd config options for spaces around the colon in struct literal fields", "tree": {"sha": "fd0b1ec19dc74c9a98c3ad3c29d82b90484efc60", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fd0b1ec19dc74c9a98c3ad3c29d82b90484efc60"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "html_url": "https://github.com/rust-lang/rust/commit/6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "450631ae67728e1e8ac84d4ba8f14637b6b0e603", "url": "https://api.github.com/repos/rust-lang/rust/commits/450631ae67728e1e8ac84d4ba8f14637b6b0e603", "html_url": "https://github.com/rust-lang/rust/commit/450631ae67728e1e8ac84d4ba8f14637b6b0e603"}, {"sha": "aa4cd311bb07ea25d89096e8fdd5d64b73666c28", "url": "https://api.github.com/repos/rust-lang/rust/commits/aa4cd311bb07ea25d89096e8fdd5d64b73666c28", "html_url": "https://github.com/rust-lang/rust/commit/aa4cd311bb07ea25d89096e8fdd5d64b73666c28"}], "stats": {"total": 130, "additions": 121, "deletions": 9}, "files": [{"sha": "73e7cb101c7b0431bf0049a276dd6fa760a38c3f", "filename": "Configurations.md", "status": "modified", "additions": 54, "deletions": 0, "changes": 54, "blob_url": "https://github.com/rust-lang/rust/blob/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/Configurations.md", "raw_url": "https://github.com/rust-lang/rust/raw/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/Configurations.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Configurations.md?ref=6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "patch": "@@ -1179,6 +1179,33 @@ fn lorem<T: Eq>(t: T) {\n \n See also: [`space_before_bound`](#space_before_bound).\n \n+## `space_after_struct_lit_field_colon`\n+\n+Leave a space after the colon in a struct literal field\n+\n+- **Default value**: `true`\n+- **Possible values**: `true`, `false`\n+\n+#### `false`:\n+\n+```rust\n+let lorem = Lorem {\n+    ipsum:dolor,\n+    sit:amet,\n+};\n+```\n+\n+#### `true`:\n+\n+```rust\n+let lorem = Lorem {\n+    ipsum: dolor,\n+    sit: amet,\n+};\n+```\n+\n+See also: [`space_before_struct_lit_field_colon`](#space_before_struct_lit_field_colon).\n+\n ## `space_after_type_annotation_colon`\n \n Leave a space after the colon in a type annotation\n@@ -1229,6 +1256,33 @@ fn lorem<T : Eq>(t: T) {\n \n See also: [`space_after_bound_colon`](#space_after_bound_colon).\n \n+## `space_before_struct_lit_field_colon`\n+\n+Leave a space before the colon in a struct literal field\n+\n+- **Default value**: `true`\n+- **Possible values**: `true`, `false`\n+\n+#### `false`:\n+\n+```rust\n+let lorem = Lorem {\n+    ipsum: dolor,\n+    sit: amet,\n+};\n+```\n+\n+#### `true`:\n+\n+```rust\n+let lorem = Lorem {\n+    ipsum : dolor,\n+    sit : amet,\n+};\n+```\n+\n+See also: [`space_after_struct_lit_field_colon`](#space_after_struct_lit_field_colon).\n+\n ## `space_before_type_annotation`\n \n Leave a space before the colon in a type annotation"}, {"sha": "082b731a00260a366e14ce0d0d8726e7704fe960", "filename": "src/config.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/src%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/src%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fconfig.rs?ref=6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "patch": "@@ -564,6 +564,10 @@ create_config! {\n         \"Leave a space before the colon in a type annotation\";\n     space_after_type_annotation_colon: bool, true,\n         \"Leave a space after the colon in a type annotation\";\n+    space_before_struct_lit_field_colon: bool, false,\n+        \"Leave a space before the colon in a struct literal field\";\n+    space_after_struct_lit_field_colon: bool, true,\n+        \"Leave a space after the colon in a struct literal field\";\n     space_before_bound: bool, false, \"Leave a space before the colon in a trait or lifetime bound\";\n     space_after_bound_colon: bool, true,\n         \"Leave a space after the colon in a trait or lifetime bound\";"}, {"sha": "72c10619ea292a270c7e3eeedbb461f155c3a6e4", "filename": "src/expr.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/src%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/src%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fexpr.rs?ref=6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "patch": "@@ -2050,18 +2050,18 @@ fn rewrite_struct_lit<'a>(context: &RewriteContext,\n     // FIXME if context.config.struct_lit_style() == Visual, but we run out\n     // of space, we should fall back to BlockIndent.\n }\n-\n-pub fn type_annotation_separator(config: &Config) -> &str {\n-    colon_spaces(config.space_before_type_annotation(),\n-                 config.space_after_type_annotation_colon())\n+pub fn struct_lit_field_separator(config: &Config) -> &str {\n+    colon_spaces(config.space_before_struct_lit_field_colon(),\n+                 config.space_after_struct_lit_field_colon())\n }\n \n+\n fn rewrite_field(context: &RewriteContext, field: &ast::Field, shape: Shape) -> Option<String> {\n     let name = &field.ident.node.to_string();\n     if field.is_shorthand {\n         Some(name.to_string())\n     } else {\n-        let separator = type_annotation_separator(context.config);\n+        let separator = struct_lit_field_separator(context.config);\n         let overhead = name.len() + separator.len();\n         let mut expr_shape = try_opt!(shape.sub_width(overhead));\n         expr_shape.offset += overhead;"}, {"sha": "c9d9f7a12fc7113fd2ee03b45fc5e1653987bbc5", "filename": "src/items.rs", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/src%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/src%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fitems.rs?ref=6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "patch": "@@ -14,10 +14,10 @@ use {Indent, Shape};\n use codemap::SpanUtils;\n use utils::{format_mutability, format_visibility, contains_skip, end_typaram, wrap_str,\n             last_line_width, format_unsafety, trim_newlines, stmt_expr, semicolon_for_expr,\n-            trimmed_last_line_width};\n+            trimmed_last_line_width, colon_spaces};\n use lists::{write_list, itemize_list, ListItem, ListFormatting, SeparatorTactic, list_helper,\n             DefinitiveListTactic, ListTactic, definitive_tactic, format_item_list};\n-use expr::{is_empty_block, is_simple_block_stmt, rewrite_assign_rhs, type_annotation_separator};\n+use expr::{is_empty_block, is_simple_block_stmt, rewrite_assign_rhs};\n use comment::{FindUncommented, contains_comment, rewrite_comment, recover_comment_removed};\n use visitor::FmtVisitor;\n use rewrite::{Rewrite, RewriteContext};\n@@ -27,6 +27,12 @@ use syntax::{ast, abi, codemap, ptr, symbol};\n use syntax::codemap::{Span, BytePos, mk_sp};\n use syntax::ast::ImplItem;\n \n+fn type_annotation_separator(config: &Config) -> &str {\n+    colon_spaces(config.space_before_type_annotation(),\n+                 config.space_after_type_annotation_colon())\n+}\n+\n+\n // Statements of the form\n // let pat: ty = init;\n impl Rewrite for ast::Local {"}, {"sha": "3ee99fa5d1d8035a8843bec415f3800a4f547eaf", "filename": "tests/source/configs-space_after_struct_lit_field_colon-false.rs", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Fsource%2Fconfigs-space_after_struct_lit_field_colon-false.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Fsource%2Fconfigs-space_after_struct_lit_field_colon-false.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fconfigs-space_after_struct_lit_field_colon-false.rs?ref=6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "patch": "@@ -0,0 +1,6 @@\n+// rustfmt-space_after_struct_lit_field_colon: false\n+\n+const LOREM: Lorem = Lorem {\n+    ipsum:dolor,\n+    sit :  amet,\n+};"}, {"sha": "6105d4725d8ad1abaeb5214b78e24b5b5fe5ff70", "filename": "tests/source/configs-space_after_struct_lit_field_colon-true.rs", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Fsource%2Fconfigs-space_after_struct_lit_field_colon-true.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Fsource%2Fconfigs-space_after_struct_lit_field_colon-true.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fconfigs-space_after_struct_lit_field_colon-true.rs?ref=6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "patch": "@@ -0,0 +1,6 @@\n+// rustfmt-space_after_struct_lit_field_colon: true\n+\n+const LOREM: Lorem = Lorem {\n+    ipsum:dolor,\n+    sit :  amet,\n+};"}, {"sha": "a2d71c8bf0bcb10f41a1964107905af5afe7a770", "filename": "tests/source/configs-space_before_struct_lit_field_colon-false.rs", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Fsource%2Fconfigs-space_before_struct_lit_field_colon-false.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Fsource%2Fconfigs-space_before_struct_lit_field_colon-false.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fconfigs-space_before_struct_lit_field_colon-false.rs?ref=6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "patch": "@@ -0,0 +1,6 @@\n+// rustfmt-space_before_struct_lit_field_colon: false\n+\n+const LOREM: Lorem = Lorem {\n+    ipsum:dolor,\n+    sit  : amet,\n+};"}, {"sha": "50e4ba12d82bc010a6393821493294918cb030e4", "filename": "tests/source/configs-space_before_struct_lit_field_colon-true.rs", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Fsource%2Fconfigs-space_before_struct_lit_field_colon-true.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Fsource%2Fconfigs-space_before_struct_lit_field_colon-true.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fconfigs-space_before_struct_lit_field_colon-true.rs?ref=6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "patch": "@@ -0,0 +1,6 @@\n+// rustfmt-space_before_struct_lit_field_colon: true\n+\n+const LOREM: Lorem = Lorem {\n+    ipsum:dolor,\n+    sit  : amet,\n+};"}, {"sha": "8f4750594646ec41012d8978e46bc8de65e6c782", "filename": "tests/target/configs-space_after_struct_lit_field_colon-false.rs", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Ftarget%2Fconfigs-space_after_struct_lit_field_colon-false.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Ftarget%2Fconfigs-space_after_struct_lit_field_colon-false.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fconfigs-space_after_struct_lit_field_colon-false.rs?ref=6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "patch": "@@ -0,0 +1,6 @@\n+// rustfmt-space_after_struct_lit_field_colon: false\n+\n+const LOREM: Lorem = Lorem {\n+    ipsum:dolor,\n+    sit:amet,\n+};"}, {"sha": "34fb792dcb550e90fb1aba8af9b715c617a76fd0", "filename": "tests/target/configs-space_after_struct_lit_field_colon-true.rs", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Ftarget%2Fconfigs-space_after_struct_lit_field_colon-true.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Ftarget%2Fconfigs-space_after_struct_lit_field_colon-true.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fconfigs-space_after_struct_lit_field_colon-true.rs?ref=6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "patch": "@@ -0,0 +1,6 @@\n+// rustfmt-space_after_struct_lit_field_colon: true\n+\n+const LOREM: Lorem = Lorem {\n+    ipsum: dolor,\n+    sit: amet,\n+};"}, {"sha": "48336954786b25e439ceae53442ae7167e4e0e7a", "filename": "tests/target/configs-space_before_struct_lit_field_colon-false.rs", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Ftarget%2Fconfigs-space_before_struct_lit_field_colon-false.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Ftarget%2Fconfigs-space_before_struct_lit_field_colon-false.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fconfigs-space_before_struct_lit_field_colon-false.rs?ref=6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "patch": "@@ -0,0 +1,6 @@\n+// rustfmt-space_before_struct_lit_field_colon: false\n+\n+const LOREM: Lorem = Lorem {\n+    ipsum: dolor,\n+    sit: amet,\n+};"}, {"sha": "e4f1cdb4575f84846615ed4b88c941fab293f2b7", "filename": "tests/target/configs-space_before_struct_lit_field_colon-true.rs", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Ftarget%2Fconfigs-space_before_struct_lit_field_colon-true.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Ftarget%2Fconfigs-space_before_struct_lit_field_colon-true.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fconfigs-space_before_struct_lit_field_colon-true.rs?ref=6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "patch": "@@ -0,0 +1,6 @@\n+// rustfmt-space_before_struct_lit_field_colon: true\n+\n+const LOREM: Lorem = Lorem {\n+    ipsum : dolor,\n+    sit : amet,\n+};"}, {"sha": "0ad06dbb70c37efa46648b25e66014510045d59a", "filename": "tests/target/space-before-type-annotation.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Ftarget%2Fspace-before-type-annotation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Ftarget%2Fspace-before-type-annotation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fspace-before-type-annotation.rs?ref=6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "patch": "@@ -9,5 +9,5 @@ struct S {\n     fieldVar : i32,\n }\n fn f() {\n-    S { fieldVar : 42 }\n+    S { fieldVar: 42 }\n }"}, {"sha": "b07620fb4c17e67ba726f8982bce87ef305bdf25", "filename": "tests/target/space-not-after-type-annotation-colon.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Ftarget%2Fspace-not-after-type-annotation-colon.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a9d7dab0d2a1720bdee67148db28b3a29ec3655/tests%2Ftarget%2Fspace-not-after-type-annotation-colon.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fspace-not-after-type-annotation-colon.rs?ref=6a9d7dab0d2a1720bdee67148db28b3a29ec3655", "patch": "@@ -10,5 +10,5 @@ struct S {\n     fieldVar :i32,\n }\n fn f() {\n-    S { fieldVar :42 }\n+    S { fieldVar: 42 }\n }"}]}