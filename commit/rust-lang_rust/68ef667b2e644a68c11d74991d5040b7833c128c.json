{"sha": "68ef667b2e644a68c11d74991d5040b7833c128c", "node_id": "C_kwDOAAsO6NoAKDY4ZWY2NjdiMmU2NDRhNjhjMTFkNzQ5OTFkNTA0MGI3ODMzYzEyOGM", "commit": {"author": {"name": "Joshua Nelson", "email": "jnelson@cloudflare.com", "date": "2022-04-24T19:53:49Z"}, "committer": {"name": "Joshua Nelson", "email": "jnelson@cloudflare.com", "date": "2022-04-24T19:53:49Z"}, "message": "Remove dead code in rustdoc shim\n\nThe `RUSTDOC_RESOURCE_SUFFIX` variable was never actually set.", "tree": {"sha": "e180b26a00db96beaf905f1d4a5967eef54588bf", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e180b26a00db96beaf905f1d4a5967eef54588bf"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/68ef667b2e644a68c11d74991d5040b7833c128c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/68ef667b2e644a68c11d74991d5040b7833c128c", "html_url": "https://github.com/rust-lang/rust/commit/68ef667b2e644a68c11d74991d5040b7833c128c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/68ef667b2e644a68c11d74991d5040b7833c128c/comments", "author": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c212fc4aa7719613e5254e9051ea03a93558fef4", "url": "https://api.github.com/repos/rust-lang/rust/commits/c212fc4aa7719613e5254e9051ea03a93558fef4", "html_url": "https://github.com/rust-lang/rust/commit/c212fc4aa7719613e5254e9051ea03a93558fef4"}], "stats": {"total": 11, "additions": 2, "deletions": 9}, "files": [{"sha": "5f85fc5aa5903d0cbcc61bf265e1974ea7b20eaa", "filename": "src/bootstrap/bin/rustdoc.rs", "status": "modified", "additions": 2, "deletions": 9, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/68ef667b2e644a68c11d74991d5040b7833c128c/src%2Fbootstrap%2Fbin%2Frustdoc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/68ef667b2e644a68c11d74991d5040b7833c128c/src%2Fbootstrap%2Fbin%2Frustdoc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbin%2Frustdoc.rs?ref=68ef667b2e644a68c11d74991d5040b7833c128c", "patch": "@@ -31,8 +31,8 @@ fn main() {\n \n     let mut cmd = Command::new(rustdoc);\n \n-    // I am not actually sure why it's necessary to pass the sysroot for `--test`,\n-    // but `test --doc --stage 0` is broken without it :(\n+    // cfg(bootstrap)\n+    // NOTE: the `--test` special-casing can be removed when https://github.com/rust-lang/cargo/pull/10594 lands on beta.\n     if target.is_some() || args.iter().any(|x| x == \"--test\") {\n         // The stage0 compiler has a special sysroot distinct from what we\n         // actually downloaded, so we just always pass the `--sysroot` option,\n@@ -65,13 +65,6 @@ fn main() {\n         }\n     }\n \n-    // Needed to be able to run all rustdoc tests.\n-    if let Some(ref x) = env::var_os(\"RUSTDOC_RESOURCE_SUFFIX\") {\n-        // This \"unstable-options\" can be removed when `--resource-suffix` is stabilized\n-        cmd.arg(\"-Z\").arg(\"unstable-options\");\n-        cmd.arg(\"--resource-suffix\").arg(x);\n-    }\n-\n     if verbose > 1 {\n         eprintln!(\n             \"rustdoc command: {:?}={:?} {:?}\","}]}