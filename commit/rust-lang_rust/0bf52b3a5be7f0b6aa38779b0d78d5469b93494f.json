{"sha": "0bf52b3a5be7f0b6aa38779b0d78d5469b93494f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBiZjUyYjNhNWJlN2YwYjZhYTM4Nzc5YjBkNzhkNTQ2OWI5MzQ5NGY=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2018-09-22T07:56:39Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-09-22T07:56:39Z"}, "message": "Rollup merge of #54413 - memoryruins:deref-error-twice, r=estebank\n\nAdd UI test for deref recursion limit printing twice\n\nCloses #38940\n\nDoes ``NOTE`` in the test need to be changed to ``HELP`` if its in the stderr?\n``help: consider adding a `#![recursion_limit=\"20\"]` attribute to your crate``\n\nIt doesn't appear to complaining locally that the line isn't set to ``HELP`` in the test, and the guide says\n > HELP and SUGGESTION*\n> * Note: SUGGESTION must follow immediately after HELP.\n\nyet there's no concrete suggestion emitted.\n\nr? @estebank", "tree": {"sha": "16bd73caa374ccbeedd0d2ad33ddadc60e003786", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/16bd73caa374ccbeedd0d2ad33ddadc60e003786"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0bf52b3a5be7f0b6aa38779b0d78d5469b93494f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJbpfW3CRBK7hj4Ov3rIwAAdHIIADJ0YcMz6aaZVJqYfveIGz6M\nzCNuDpFIoeIAlRbSu5Cs3GUChJ2uAkyQJq+INR0nsylXyWrS1aVhA5z2mTHkieXI\nly0VWRA2furRwApgJbvBNKSqmmbvQAfQfGSWDBYvzDHq1fo0qDe0udjswPvjfe62\n79TIwhhB3Q9swxLHFqENC1AFWthcLsl3pA7GZRdcDD/SYtdJsxHMzDz3Uw6vczo4\nNLL36kBHBRD0x5PIaEQLM1TyAhwiLjFqPkm7n8lQ6AUTYA4TiWKt0gr8dyRM4GXR\nbRWZgOBdmJJwVPNlu0CMXgkipmvJ4YOaD5waC/t1312LJB7wUj+rjbnd4VELllw=\n=1lyT\n-----END PGP SIGNATURE-----\n", "payload": "tree 16bd73caa374ccbeedd0d2ad33ddadc60e003786\nparent 394d687121edbef644c158e6dcfacdb0f88c9618\nparent 70da203259360b12d871c043d9eab327034785d6\nauthor Pietro Albini <pietro@pietroalbini.org> 1537602999 +0200\ncommitter GitHub <noreply@github.com> 1537602999 +0200\n\nRollup merge of #54413 - memoryruins:deref-error-twice, r=estebank\n\nAdd UI test for deref recursion limit printing twice\n\nCloses #38940\n\nDoes ``NOTE`` in the test need to be changed to ``HELP`` if its in the stderr?\n``help: consider adding a `#![recursion_limit=\"20\"]` attribute to your crate``\n\nIt doesn't appear to complaining locally that the line isn't set to ``HELP`` in the test, and the guide says\n > HELP and SUGGESTION*\n> * Note: SUGGESTION must follow immediately after HELP.\n\nyet there's no concrete suggestion emitted.\n\nr? @estebank\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0bf52b3a5be7f0b6aa38779b0d78d5469b93494f", "html_url": "https://github.com/rust-lang/rust/commit/0bf52b3a5be7f0b6aa38779b0d78d5469b93494f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0bf52b3a5be7f0b6aa38779b0d78d5469b93494f/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "394d687121edbef644c158e6dcfacdb0f88c9618", "url": "https://api.github.com/repos/rust-lang/rust/commits/394d687121edbef644c158e6dcfacdb0f88c9618", "html_url": "https://github.com/rust-lang/rust/commit/394d687121edbef644c158e6dcfacdb0f88c9618"}, {"sha": "70da203259360b12d871c043d9eab327034785d6", "url": "https://api.github.com/repos/rust-lang/rust/commits/70da203259360b12d871c043d9eab327034785d6", "html_url": "https://github.com/rust-lang/rust/commit/70da203259360b12d871c043d9eab327034785d6"}], "stats": {"total": 67, "additions": 67, "deletions": 0}, "files": [{"sha": "7f9b141e02e3ca84164101e30733c92c9a40bd29", "filename": "src/test/ui/issues/issue-38940.rs", "status": "added", "additions": 46, "deletions": 0, "changes": 46, "blob_url": "https://github.com/rust-lang/rust/blob/0bf52b3a5be7f0b6aa38779b0d78d5469b93494f/src%2Ftest%2Fui%2Fissues%2Fissue-38940.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0bf52b3a5be7f0b6aa38779b0d78d5469b93494f/src%2Ftest%2Fui%2Fissues%2Fissue-38940.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-38940.rs?ref=0bf52b3a5be7f0b6aa38779b0d78d5469b93494f", "patch": "@@ -0,0 +1,46 @@\n+// issue-38940: error printed twice for deref recursion limit exceeded\n+// Test that the recursion limit can be changed. In this case, we have\n+// deeply nested types that will fail the `Send` check by overflow\n+// when the recursion limit is set very low.\n+#![allow(dead_code)]\n+#![recursion_limit=\"10\"]\n+macro_rules! link {\n+    ($outer:ident, $inner:ident) => {\n+        struct $outer($inner);\n+        impl $outer {\n+            fn new() -> $outer {\n+                $outer($inner::new())\n+            }\n+        }\n+        impl std::ops::Deref for $outer {\n+            type Target = $inner;\n+            fn deref(&self) -> &$inner {\n+                &self.0\n+            }\n+        }\n+    }\n+}\n+struct Bottom;\n+impl Bottom {\n+    fn new() -> Bottom {\n+        Bottom\n+    }\n+}\n+link!(Top, A);\n+link!(A, B);\n+link!(B, C);\n+link!(C, D);\n+link!(D, E);\n+link!(E, F);\n+link!(F, G);\n+link!(G, H);\n+link!(H, I);\n+link!(I, J);\n+link!(J, K);\n+link!(K, Bottom);\n+fn main() {\n+    let t = Top::new();\n+    let x: &Bottom = &t;\n+    //~^ ERROR mismatched types\n+    //~| ERROR reached the recursion limit while auto-dereferencing I\n+}"}, {"sha": "2d3cfda9a5f7272c787357c34a6d21d1bb41a52c", "filename": "src/test/ui/issues/issue-38940.stderr", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/0bf52b3a5be7f0b6aa38779b0d78d5469b93494f/src%2Ftest%2Fui%2Fissues%2Fissue-38940.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0bf52b3a5be7f0b6aa38779b0d78d5469b93494f/src%2Ftest%2Fui%2Fissues%2Fissue-38940.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-38940.stderr?ref=0bf52b3a5be7f0b6aa38779b0d78d5469b93494f", "patch": "@@ -0,0 +1,21 @@\n+error[E0055]: reached the recursion limit while auto-dereferencing I\n+  --> $DIR/issue-38940.rs:43:22\n+   |\n+LL |     let x: &Bottom = &t;\n+   |                      ^^ deref recursion limit reached\n+   |\n+   = help: consider adding a `#![recursion_limit=\"20\"]` attribute to your crate\n+\n+error[E0308]: mismatched types\n+  --> $DIR/issue-38940.rs:43:22\n+   |\n+LL |     let x: &Bottom = &t;\n+   |                      ^^ expected struct `Bottom`, found struct `Top`\n+   |\n+   = note: expected type `&Bottom`\n+              found type `&Top`\n+\n+error: aborting due to 2 previous errors\n+\n+Some errors occurred: E0055, E0308.\n+For more information about an error, try `rustc --explain E0055`."}]}