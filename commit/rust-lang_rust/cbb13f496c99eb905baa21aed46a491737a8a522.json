{"sha": "cbb13f496c99eb905baa21aed46a491737a8a522", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNiYjEzZjQ5NmM5OWViOTA1YmFhMjFhZWQ0NmE0OTE3MzdhOGE1MjI=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2019-03-26T21:26:46Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-03-26T21:26:46Z"}, "message": "Rollup merge of #59432 - phansch:compiletest_docs, r=alexcrichton\n\nImprove some compiletest documentation\n\nThis adds some missing documentation for rustfix related things and adds\na test for the `is_test` function.", "tree": {"sha": "3a214ebebe77b18b23df90b3c00cfa894d235f96", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3a214ebebe77b18b23df90b3c00cfa894d235f96"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cbb13f496c99eb905baa21aed46a491737a8a522", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJcmpkWCRBK7hj4Ov3rIwAAdHIIAEFJUi5EvUcskxBn5ht7nAQ3\n9nMIsyXxBin7hmOTWaK9uLtiqHLZMOT3HlK5rGFkSvENSvQWxB22cG+Q/CX2WgM9\nNGNbgs0snPc+A5Bh8I/ki1FD5xZS8Oq79VMZSRSSGosaUyJ1Ln7dDxAGS673Qull\naGJA0/wYZHsxCQUPuZdlKbKWuJ11GJUipOsJg4EDfZLTOqiAjQQWEmDfVNe1oYEu\ntEOEWs/NUGJ/QYUAMIVuR3nR9P6lhfTH1sTP8VFJaf4ZCbaGw0K+9GKe10F7fZvB\n/9X8yF88mk+UVf8Fgkt5cuexxnIAXziP6pDy3w9aJYoSpgnref+m2SMCNu8G3/w=\n=fpWI\n-----END PGP SIGNATURE-----\n", "payload": "tree 3a214ebebe77b18b23df90b3c00cfa894d235f96\nparent 616ee876c1767a2b934c55e90fd571f7476a1f45\nparent 8a9c6203404404f0f7699d6a5da64c613b2b5a8b\nauthor Guillaume Gomez <guillaume1.gomez@gmail.com> 1553635606 +0100\ncommitter GitHub <noreply@github.com> 1553635606 +0100\n\nRollup merge of #59432 - phansch:compiletest_docs, r=alexcrichton\n\nImprove some compiletest documentation\n\nThis adds some missing documentation for rustfix related things and adds\na test for the `is_test` function.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cbb13f496c99eb905baa21aed46a491737a8a522", "html_url": "https://github.com/rust-lang/rust/commit/cbb13f496c99eb905baa21aed46a491737a8a522", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cbb13f496c99eb905baa21aed46a491737a8a522/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "616ee876c1767a2b934c55e90fd571f7476a1f45", "url": "https://api.github.com/repos/rust-lang/rust/commits/616ee876c1767a2b934c55e90fd571f7476a1f45", "html_url": "https://github.com/rust-lang/rust/commit/616ee876c1767a2b934c55e90fd571f7476a1f45"}, {"sha": "8a9c6203404404f0f7699d6a5da64c613b2b5a8b", "url": "https://api.github.com/repos/rust-lang/rust/commits/8a9c6203404404f0f7699d6a5da64c613b2b5a8b", "html_url": "https://github.com/rust-lang/rust/commit/8a9c6203404404f0f7699d6a5da64c613b2b5a8b"}], "stats": {"total": 23, "additions": 20, "deletions": 3}, "files": [{"sha": "c1920dde5b1fe059b3ac14cc6c5886fecfbee4c9", "filename": "src/tools/compiletest/src/common.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/cbb13f496c99eb905baa21aed46a491737a8a522/src%2Ftools%2Fcompiletest%2Fsrc%2Fcommon.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbb13f496c99eb905baa21aed46a491737a8a522/src%2Ftools%2Fcompiletest%2Fsrc%2Fcommon.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fcommon.rs?ref=cbb13f496c99eb905baa21aed46a491737a8a522", "patch": "@@ -117,6 +117,7 @@ impl CompareMode {\n     }\n }\n \n+/// Configuration for compiletest\n #[derive(Clone)]\n pub struct Config {\n     /// `true` to to overwrite stderr/stdout files instead of complaining about changes in output.\n@@ -254,6 +255,8 @@ pub struct Config {\n     pub linker: Option<String>,\n     pub llvm_components: String,\n     pub llvm_cxxflags: String,\n+\n+    /// Path to a NodeJS executable. Used for JS doctests, emscripten and WASM tests\n     pub nodejs: Option<String>,\n }\n "}, {"sha": "d735d3351e6669bd862e2af872f65b0ccf26ce76", "filename": "src/tools/compiletest/src/header.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/cbb13f496c99eb905baa21aed46a491737a8a522/src%2Ftools%2Fcompiletest%2Fsrc%2Fheader.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbb13f496c99eb905baa21aed46a491737a8a522/src%2Ftools%2Fcompiletest%2Fsrc%2Fheader.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fheader.rs?ref=cbb13f496c99eb905baa21aed46a491737a8a522", "patch": "@@ -333,7 +333,10 @@ pub struct TestProps {\n     pub normalize_stdout: Vec<(String, String)>,\n     pub normalize_stderr: Vec<(String, String)>,\n     pub failure_status: i32,\n+    // Whether or not `rustfix` should apply the `CodeSuggestion`s of this test and compile the\n+    // resulting Rust code.\n     pub run_rustfix: bool,\n+    // If true, `rustfix` will only apply `MachineApplicable` suggestions.\n     pub rustfix_only_machine_applicable: bool,\n     pub assembly_output: Option<String>,\n }"}, {"sha": "15d449260efa0b445ac123ae28632db5ff5d3560", "filename": "src/tools/compiletest/src/json.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cbb13f496c99eb905baa21aed46a491737a8a522/src%2Ftools%2Fcompiletest%2Fsrc%2Fjson.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbb13f496c99eb905baa21aed46a491737a8a522/src%2Ftools%2Fcompiletest%2Fsrc%2Fjson.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fjson.rs?ref=cbb13f496c99eb905baa21aed46a491737a8a522", "patch": "@@ -1,12 +1,12 @@\n+//! These structs are a subset of the ones found in `syntax::json`.\n+//! They are only used for deserialization of JSON output provided by libtest.\n+\n use crate::errors::{Error, ErrorKind};\n use crate::runtest::ProcRes;\n use serde_json;\n use std::path::Path;\n use std::str::FromStr;\n \n-// These structs are a subset of the ones found in\n-// `syntax::json`.\n-\n #[derive(Deserialize)]\n struct Diagnostic {\n     message: String,"}, {"sha": "d91710dda52397f9bd94153eb67fda0331c0071c", "filename": "src/tools/compiletest/src/main.rs", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/cbb13f496c99eb905baa21aed46a491737a8a522/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbb13f496c99eb905baa21aed46a491737a8a522/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs?ref=cbb13f496c99eb905baa21aed46a491737a8a522", "patch": "@@ -598,6 +598,8 @@ fn collect_tests_from_dir(\n     Ok(())\n }\n \n+\n+/// Returns true if `file_name` looks like a proper test file name.\n pub fn is_test(file_name: &OsString) -> bool {\n     let file_name = file_name.to_str().unwrap();\n \n@@ -1048,3 +1050,12 @@ fn test_extract_gdb_version() {\n         7012050: \"GNU gdb (GDB) 7.12.50.20161027-git\",\n     }\n }\n+\n+#[test]\n+fn is_test_test() {\n+    assert_eq!(true, is_test(&OsString::from(\"a_test.rs\")));\n+    assert_eq!(false, is_test(&OsString::from(\".a_test.rs\")));\n+    assert_eq!(false, is_test(&OsString::from(\"a_cat.gif\")));\n+    assert_eq!(false, is_test(&OsString::from(\"#a_dog_gif\")));\n+    assert_eq!(false, is_test(&OsString::from(\"~a_temp_file\")));\n+}"}]}