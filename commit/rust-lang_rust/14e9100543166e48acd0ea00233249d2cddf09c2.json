{"sha": "14e9100543166e48acd0ea00233249d2cddf09c2", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE0ZTkxMDA1NDMxNjZlNDhhY2QwZWEwMDIzMzI0OWQyY2RkZjA5YzI=", "commit": {"author": {"name": "Eduardo Broto", "email": "ebroto@tutanota.com", "date": "2020-05-24T22:41:13Z"}, "committer": {"name": "Eduardo Broto", "email": "ebroto@tutanota.com", "date": "2020-05-31T18:38:48Z"}, "message": "cargo-ui tests: check that <dir>/src exists before processing test", "tree": {"sha": "9b55434aa0a1cff4f77f6d14361b178ede0e2bab", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9b55434aa0a1cff4f77f6d14361b178ede0e2bab"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/14e9100543166e48acd0ea00233249d2cddf09c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/14e9100543166e48acd0ea00233249d2cddf09c2", "html_url": "https://github.com/rust-lang/rust/commit/14e9100543166e48acd0ea00233249d2cddf09c2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/14e9100543166e48acd0ea00233249d2cddf09c2/comments", "author": {"login": "ebroto", "id": 816908, "node_id": "MDQ6VXNlcjgxNjkwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/816908?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebroto", "html_url": "https://github.com/ebroto", "followers_url": "https://api.github.com/users/ebroto/followers", "following_url": "https://api.github.com/users/ebroto/following{/other_user}", "gists_url": "https://api.github.com/users/ebroto/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebroto/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebroto/subscriptions", "organizations_url": "https://api.github.com/users/ebroto/orgs", "repos_url": "https://api.github.com/users/ebroto/repos", "events_url": "https://api.github.com/users/ebroto/events{/privacy}", "received_events_url": "https://api.github.com/users/ebroto/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ebroto", "id": 816908, "node_id": "MDQ6VXNlcjgxNjkwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/816908?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebroto", "html_url": "https://github.com/ebroto", "followers_url": "https://api.github.com/users/ebroto/followers", "following_url": "https://api.github.com/users/ebroto/following{/other_user}", "gists_url": "https://api.github.com/users/ebroto/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebroto/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebroto/subscriptions", "organizations_url": "https://api.github.com/users/ebroto/orgs", "repos_url": "https://api.github.com/users/ebroto/repos", "events_url": "https://api.github.com/users/ebroto/events{/privacy}", "received_events_url": "https://api.github.com/users/ebroto/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fcc3ed2cdc442b4d3b8f1cb2be5ef7686ff89b3c", "url": "https://api.github.com/repos/rust-lang/rust/commits/fcc3ed2cdc442b4d3b8f1cb2be5ef7686ff89b3c", "html_url": "https://github.com/rust-lang/rust/commit/fcc3ed2cdc442b4d3b8f1cb2be5ef7686ff89b3c"}], "stats": {"total": 9, "additions": 8, "deletions": 1}, "files": [{"sha": "194354b291fdab97ade070c0a84badc3c846233b", "filename": "tests/compile-test.rs", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/14e9100543166e48acd0ea00233249d2cddf09c2/tests%2Fcompile-test.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14e9100543166e48acd0ea00233249d2cddf09c2/tests%2Fcompile-test.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-test.rs?ref=14e9100543166e48acd0ea00233249d2cddf09c2", "patch": "@@ -181,8 +181,15 @@ fn run_ui_cargo(config: &mut compiletest::Config) {\n                 }\n \n                 let src_path = case.path().join(\"src\");\n-                env::set_current_dir(&src_path)?;\n \n+                // When switching between branches, if the previous branch had a test\n+                // that the current branch does not have, the directory is not removed\n+                // because an ignored Cargo.lock file exists.\n+                if !src_path.exists() {\n+                    continue;\n+                }\n+\n+                env::set_current_dir(&src_path)?;\n                 for file in fs::read_dir(&src_path)? {\n                     let file = file?;\n                     if file.file_type()?.is_dir() {"}]}