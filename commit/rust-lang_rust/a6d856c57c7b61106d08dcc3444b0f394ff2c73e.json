{"sha": "a6d856c57c7b61106d08dcc3444b0f394ff2c73e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE2ZDg1NmM1N2M3YjYxMTA2ZDA4ZGNjMzQ0NGIwZjM5NGZmMmM3M2U=", "commit": {"author": {"name": "Marijn Haverbeke", "email": "marijnh@gmail.com", "date": "2011-11-01T14:16:50Z"}, "committer": {"name": "Marijn Haverbeke", "email": "marijnh@gmail.com", "date": "2011-11-01T14:16:50Z"}, "message": "Improve syntax highlighting in tutorial", "tree": {"sha": "8d8e0d2e3e76d846c85a9540ca209cae742cb23f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8d8e0d2e3e76d846c85a9540ca209cae742cb23f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a6d856c57c7b61106d08dcc3444b0f394ff2c73e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a6d856c57c7b61106d08dcc3444b0f394ff2c73e", "html_url": "https://github.com/rust-lang/rust/commit/a6d856c57c7b61106d08dcc3444b0f394ff2c73e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a6d856c57c7b61106d08dcc3444b0f394ff2c73e/comments", "author": {"login": "marijnh", "id": 144427, "node_id": "MDQ6VXNlcjE0NDQyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/144427?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marijnh", "html_url": "https://github.com/marijnh", "followers_url": "https://api.github.com/users/marijnh/followers", "following_url": "https://api.github.com/users/marijnh/following{/other_user}", "gists_url": "https://api.github.com/users/marijnh/gists{/gist_id}", "starred_url": "https://api.github.com/users/marijnh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marijnh/subscriptions", "organizations_url": "https://api.github.com/users/marijnh/orgs", "repos_url": "https://api.github.com/users/marijnh/repos", "events_url": "https://api.github.com/users/marijnh/events{/privacy}", "received_events_url": "https://api.github.com/users/marijnh/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marijnh", "id": 144427, "node_id": "MDQ6VXNlcjE0NDQyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/144427?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marijnh", "html_url": "https://github.com/marijnh", "followers_url": "https://api.github.com/users/marijnh/followers", "following_url": "https://api.github.com/users/marijnh/following{/other_user}", "gists_url": "https://api.github.com/users/marijnh/gists{/gist_id}", "starred_url": "https://api.github.com/users/marijnh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marijnh/subscriptions", "organizations_url": "https://api.github.com/users/marijnh/orgs", "repos_url": "https://api.github.com/users/marijnh/repos", "events_url": "https://api.github.com/users/marijnh/events{/privacy}", "received_events_url": "https://api.github.com/users/marijnh/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "59cc8636b72e944d22b065874646ad14d44010a9", "url": "https://api.github.com/repos/rust-lang/rust/commits/59cc8636b72e944d22b065874646ad14d44010a9", "html_url": "https://github.com/rust-lang/rust/commit/59cc8636b72e944d22b065874646ad14d44010a9"}], "stats": {"total": 21, "additions": 13, "deletions": 8}, "files": [{"sha": "70091470e806bc7aa4a4df16b9d757eda7ebac78", "filename": "doc/tutorial/lib/codemirror-rust.js", "status": "modified", "additions": 13, "deletions": 8, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/a6d856c57c7b61106d08dcc3444b0f394ff2c73e/doc%2Ftutorial%2Flib%2Fcodemirror-rust.js", "raw_url": "https://github.com/rust-lang/rust/raw/a6d856c57c7b61106d08dcc3444b0f394ff2c73e/doc%2Ftutorial%2Flib%2Fcodemirror-rust.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/doc%2Ftutorial%2Flib%2Fcodemirror-rust.js?ref=a6d856c57c7b61106d08dcc3444b0f394ff2c73e", "patch": "@@ -213,15 +213,19 @@ CodeMirror.defineMode(\"rust\", function() {\n       if (content == \"||\") return cont(poplex, pushlex(\"}\", \"block\"), block);\n     }\n     if (content == \"mutable\" || (content.match(/^\\w+$/) && cx.stream.peek() == \":\"\n-                                 && !cx.stream.match(\"::\", false))) return pass(recliteral);\n+                                 && !cx.stream.match(\"::\", false)))\n+      return pass(record_of(expression));\n     return pass(block);\n   }\n-  function recliteral(type) {\n-    if (content == \"mutable\" || content == \"with\") {cx.marked = \"keyword\"; return cont(recliteral);}\n-    if (content.match(/^\\w*$/)) {cx.marked = \"variable\"; return cont(recliteral);}\n-    if (type == \":\") return cont(expression, recliteral);\n-    if (type == \"}\") return cont();\n-    return cont(recliteral);\n+  function record_of(comb) {\n+    function ro(type) {\n+      if (content == \"mutable\" || content == \"with\") {cx.marked = \"keyword\"; return cont(ro);}\n+      if (content.match(/^\\w*$/)) {cx.marked = \"variable\"; return cont(ro);}\n+      if (type == \":\") return cont(comb, ro);\n+      if (type == \"}\") return cont();\n+      return cont(ro);\n+    }\n+    return ro;\n   }\n   function blockvars(type) {\n     if (type == \"name\") {cx.marked = \"def\"; return cont(blockvars);}\n@@ -230,7 +234,7 @@ CodeMirror.defineMode(\"rust\", function() {\n   }\n \n   function letdef1(type) {\n-    if (type == \";\") return cont();\n+    if (type.match(/[\\]\\)\\};]/)) return cont();\n     if (content == \"=\") return cont(expression, letdef2);\n     if (type == \",\") return cont(letdef1);\n     return pass(pattern, maybetype, letdef1);\n@@ -295,6 +299,7 @@ CodeMirror.defineMode(\"rust\", function() {\n     if (type == \"atom\") return cont(rtypemaybeparam);\n     if (type == \"op\" || type == \"obj\") return cont(rtype);\n     if (type == \"fn\") return cont(fntype);\n+    if (type == \"{\") return cont(pushlex(\"{\"), record_of(rtype), poplex);\n     return matchBrackets(type, rtype);\n   }\n   function rtypemaybeparam(type) {"}]}