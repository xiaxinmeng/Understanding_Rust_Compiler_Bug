{"sha": "87334fb05ff2a665419241d877c13d6c4770a3f4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg3MzM0ZmIwNWZmMmE2NjU0MTkyNDFkODc3YzEzZDZjNDc3MGEzZjQ=", "commit": {"author": {"name": "Dmitry Promsky", "email": "dmitry@willworkforcookies.com", "date": "2014-04-04T16:17:30Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2014-04-08T07:03:12Z"}, "message": "Made 'make install' include libs for additional targets", "tree": {"sha": "364b98089b9e03fd18f7f0a2d33660ea8876c4cf", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/364b98089b9e03fd18f7f0a2d33660ea8876c4cf"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/87334fb05ff2a665419241d877c13d6c4770a3f4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/87334fb05ff2a665419241d877c13d6c4770a3f4", "html_url": "https://github.com/rust-lang/rust/commit/87334fb05ff2a665419241d877c13d6c4770a3f4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/87334fb05ff2a665419241d877c13d6c4770a3f4/comments", "author": {"login": "dmski", "id": 1293095, "node_id": "MDQ6VXNlcjEyOTMwOTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1293095?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dmski", "html_url": "https://github.com/dmski", "followers_url": "https://api.github.com/users/dmski/followers", "following_url": "https://api.github.com/users/dmski/following{/other_user}", "gists_url": "https://api.github.com/users/dmski/gists{/gist_id}", "starred_url": "https://api.github.com/users/dmski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dmski/subscriptions", "organizations_url": "https://api.github.com/users/dmski/orgs", "repos_url": "https://api.github.com/users/dmski/repos", "events_url": "https://api.github.com/users/dmski/events{/privacy}", "received_events_url": "https://api.github.com/users/dmski/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "22b632560f9dc1d11121a8c129181b87ea80d7d7", "url": "https://api.github.com/repos/rust-lang/rust/commits/22b632560f9dc1d11121a8c129181b87ea80d7d7", "html_url": "https://github.com/rust-lang/rust/commit/22b632560f9dc1d11121a8c129181b87ea80d7d7"}], "stats": {"total": 38, "additions": 23, "deletions": 15}, "files": [{"sha": "b96d5bee3af9160fae0817e65f5d994f675ddd2a", "filename": "mk/dist.mk", "status": "modified", "additions": 21, "deletions": 13, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/87334fb05ff2a665419241d877c13d6c4770a3f4/mk%2Fdist.mk", "raw_url": "https://github.com/rust-lang/rust/raw/87334fb05ff2a665419241d877c13d6c4770a3f4/mk%2Fdist.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fdist.mk?ref=87334fb05ff2a665419241d877c13d6c4770a3f4", "patch": "@@ -203,19 +203,17 @@ distcheck-osx: dist-osx\n # Unix binary installer tarballs\n ######################################################################\n \n-define DEF_INSTALLER\n-\n-$$(eval $$(call DEF_PREPARE,dir-$(1)))\n-\n-dist-install-dir-$(1): PREPARE_HOST=$(1)\n-dist-install-dir-$(1): PREPARE_TARGETS=$(1)\n-dist-install-dir-$(1): PREPARE_DEST_DIR=tmp/dist/$$(PKG_NAME)-$(1)\n-dist-install-dir-$(1): PREPARE_DIR_CMD=$(DEFAULT_PREPARE_DIR_CMD)\n-dist-install-dir-$(1): PREPARE_BIN_CMD=$(DEFAULT_PREPARE_BIN_CMD)\n-dist-install-dir-$(1): PREPARE_LIB_CMD=$(DEFAULT_PREPARE_LIB_CMD)\n-dist-install-dir-$(1): PREPARE_MAN_CMD=$(DEFAULT_PREPARE_MAN_CMD)\n-dist-install-dir-$(1): PREPARE_CLEAN=true\n-dist-install-dir-$(1): prepare-base-dir-$(1) docs compiler-docs\n+define DEF_PREPARE_DIST_DIR\n+\n+dist-install-dir-$(1)$(3): PREPARE_HOST=$(1)\n+dist-install-dir-$(1)$(3): PREPARE_TARGETS=$(2)\n+dist-install-dir-$(1)$(3): PREPARE_DEST_DIR=tmp/dist/$$(PKG_NAME)-$(1)\n+dist-install-dir-$(1)$(3): PREPARE_DIR_CMD=$(DEFAULT_PREPARE_DIR_CMD)\n+dist-install-dir-$(1)$(3): PREPARE_BIN_CMD=$(DEFAULT_PREPARE_BIN_CMD)\n+dist-install-dir-$(1)$(3): PREPARE_LIB_CMD=$(DEFAULT_PREPARE_LIB_CMD)\n+dist-install-dir-$(1)$(3): PREPARE_MAN_CMD=$(DEFAULT_PREPARE_MAN_CMD)\n+dist-install-dir-$(1)$(3): PREPARE_CLEAN=true\n+dist-install-dir-$(1)$(3): prepare-base-dir-$(1) docs compiler-docs\n \t$$(Q)(cd $$(PREPARE_DEST_DIR)/ && find . -type f | sed 's/^\\.\\///') \\\n       > tmp/dist/manifest-$(1).in\n \t$$(Q)mv tmp/dist/manifest-$(1).in $$(PREPARE_DEST_DIR)/$$(CFG_LIBDIR_RELATIVE)/rustlib/manifest.in\n@@ -227,6 +225,16 @@ dist-install-dir-$(1): prepare-base-dir-$(1) docs compiler-docs\n \t$$(Q)cp -r doc $$(PREPARE_DEST_DIR)\n \t$$(Q)$$(PREPARE_BIN_CMD) $$(S)src/etc/install.sh $$(PREPARE_DEST_DIR)\n \n+endef\n+\n+define DEF_INSTALLER\n+\n+$$(eval $$(call DEF_PREPARE,dir-$(1)))\n+\n+$$(eval $$(call DEF_PREPARE_DIST_DIR,$(1),$(1),))\n+\n+$$(eval $$(call DEF_PREPARE_DIST_DIR,$(1),$(CFG_TARGET),-with-target-libs))\n+\n dist/$$(PKG_NAME)-$(1).tar.gz: dist-install-dir-$(1)\n \t@$(call E, build: $$@)\n \t$$(Q)tar -czf dist/$$(PKG_NAME)-$(1).tar.gz -C tmp/dist $$(PKG_NAME)-$(1)"}, {"sha": "206046faeb6ef34e52c9715e4c9ed2d42bd380ef", "filename": "mk/install.mk", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/87334fb05ff2a665419241d877c13d6c4770a3f4/mk%2Finstall.mk", "raw_url": "https://github.com/rust-lang/rust/raw/87334fb05ff2a665419241d877c13d6c4770a3f4/mk%2Finstall.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Finstall.mk?ref=87334fb05ff2a665419241d877c13d6c4770a3f4", "patch": "@@ -14,12 +14,12 @@ else\n MAYBE_DISABLE_VERIFY=\n endif\n \n-install: dist-install-dir-$(CFG_BUILD)\n+install: dist-install-dir-$(CFG_BUILD)-with-target-libs\n \t$(Q)sh tmp/dist/$(PKG_NAME)-$(CFG_BUILD)/install.sh --prefix=\"$(DESTDIR)$(CFG_PREFIX)\" --libdir=\"$(DESTDIR)$(CFG_LIBDIR)\" --mandir=\"$(DESTDIR)$(CFG_MANDIR)\" \"$(MAYBE_DISABLE_VERIFY)\"\n # Remove tmp files while we can because they may have been created under sudo\n \t$(Q)rm -R tmp/dist\n \n-uninstall: dist-install-dir-$(CFG_BUILD)\n+uninstall: dist-install-dir-$(CFG_BUILD)-with-target-libs\n \t$(Q)sh tmp/dist/$(PKG_NAME)-$(CFG_BUILD)/install.sh --uninstall --prefix=\"$(DESTDIR)$(CFG_PREFIX)\" --libdir=\"$(DESTDIR)$(CFG_LIBDIR)\" --mandir=\"$(DESTDIR)$(CFG_MANDIR)\"\n # Remove tmp files while we can because they may have been created under sudo\n \t$(Q)rm -R tmp/dist"}]}