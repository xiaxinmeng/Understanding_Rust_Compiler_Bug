{"sha": "c0513097ab648f497e18e565bf00b71edd60c65c", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMwNTEzMDk3YWI2NDhmNDk3ZTE4ZTU2NWJmMDBiNzFlZGQ2MGM2NWM=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2018-09-03T15:24:33Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-09-03T15:24:33Z"}, "message": "Merge pull request #3092 from illicitonion/issue-2879\n\ndefault_trait_access skips <F as Default>::default()", "tree": {"sha": "fde050bfb239031d77d125d7bb42438316552d06", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fde050bfb239031d77d125d7bb42438316552d06"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c0513097ab648f497e18e565bf00b71edd60c65c", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJbjVIxCRBK7hj4Ov3rIwAAdHIIACe4xIPZYwe/WY+9uOpJHnrJ\nqXkZGvMIoRKKn7uVRK0rI41SHbDYFtlZI2xM/zzNp3knvTYI7+M7O2OSYDdHnXZz\n9TZLVAfVeKX5VymLVYxzNItstRZoNkJWu+Fy6rl15Pn9UfQ+It+eDct/gX2SPeqA\nHo4/4St47wLX1LFacSVB+p9L3IhIpFCxFR1H+IbYZ+dxhGEbE6dytxl4Hjmx/dlF\nsY7lzDCc13SwL2XPTRicbsGWclKiM47V0A0XFBK7fE/l8krNr8VJqwGVqq67gg/M\ncstkokzc+ElqvTubSP2NRpuY38ERoyeuiJkcW4H/n932q5MfqKVpga3D8OKzU1E=\n=kjsX\n-----END PGP SIGNATURE-----\n", "payload": "tree fde050bfb239031d77d125d7bb42438316552d06\nparent 78ec6e38b4b5abcad856f936a998974cf4bc3947\nparent 9f0216d52070faeb4f49b7a7f1c898b8f053622f\nauthor Philipp Hansch <dev@phansch.net> 1535988273 +0200\ncommitter GitHub <noreply@github.com> 1535988273 +0200\n\nMerge pull request #3092 from illicitonion/issue-2879\n\ndefault_trait_access skips <F as Default>::default()"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c0513097ab648f497e18e565bf00b71edd60c65c", "html_url": "https://github.com/rust-lang/rust/commit/c0513097ab648f497e18e565bf00b71edd60c65c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c0513097ab648f497e18e565bf00b71edd60c65c/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "78ec6e38b4b5abcad856f936a998974cf4bc3947", "url": "https://api.github.com/repos/rust-lang/rust/commits/78ec6e38b4b5abcad856f936a998974cf4bc3947", "html_url": "https://github.com/rust-lang/rust/commit/78ec6e38b4b5abcad856f936a998974cf4bc3947"}, {"sha": "9f0216d52070faeb4f49b7a7f1c898b8f053622f", "url": "https://api.github.com/repos/rust-lang/rust/commits/9f0216d52070faeb4f49b7a7f1c898b8f053622f", "html_url": "https://github.com/rust-lang/rust/commit/9f0216d52070faeb4f49b7a7f1c898b8f053622f"}], "stats": {"total": 16, "additions": 15, "deletions": 1}, "files": [{"sha": "e7c90f041889a591627fc3053f295428397ec167", "filename": "clippy_lints/src/default_trait_access.rs", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/c0513097ab648f497e18e565bf00b71edd60c65c/clippy_lints%2Fsrc%2Fdefault_trait_access.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c0513097ab648f497e18e565bf00b71edd60c65c/clippy_lints%2Fsrc%2Fdefault_trait_access.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fdefault_trait_access.rs?ref=c0513097ab648f497e18e565bf00b71edd60c65c", "patch": "@@ -48,6 +48,17 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for DefaultTraitAccess {\n             then {\n                 match qpath {\n                     QPath::Resolved(..) => {\n+                        if_chain! {\n+                            // Detect and ignore <Foo as Default>::default() because these calls do\n+                            // explicitly name the type.\n+                            if let ExprKind::Call(ref method, ref _args) = expr.node;\n+                            if let ExprKind::Path(ref p) = method.node;\n+                            if let QPath::Resolved(Some(_ty), _path) = p;\n+                            then {\n+                                return;\n+                            }\n+                        }\n+\n                         // TODO: Work out a way to put \"whatever the imported way of referencing\n                         // this type in this file\" rather than a fully-qualified type.\n                         let expr_ty = cx.tables.expr_ty(expr);"}, {"sha": "248b4ec0066ee2090d7032a8d0884a09baa9ddc7", "filename": "tests/ui/default_trait_access.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/c0513097ab648f497e18e565bf00b71edd60c65c/tests%2Fui%2Fdefault_trait_access.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c0513097ab648f497e18e565bf00b71edd60c65c/tests%2Fui%2Fdefault_trait_access.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fdefault_trait_access.rs?ref=c0513097ab648f497e18e565bf00b71edd60c65c", "patch": "@@ -43,8 +43,10 @@ fn main() {\n \n     let s18 = TupleStructDerivedDefault::default();\n \n+    let s19 = <DerivedDefault as Default>::default();\n+\n     println!(\n-        \"[{}] [{}] [{}] [{}] [{}] [{}] [{}] [{}] [{}] [{:?}] [{:?}] [{:?}] [{:?}] [{:?}] [{:?}] [{:?}] [{:?}] [{:?}]\",\n+        \"[{}] [{}] [{}] [{}] [{}] [{}] [{}] [{}] [{}] [{:?}] [{:?}] [{:?}] [{:?}] [{:?}] [{:?}] [{:?}] [{:?}] [{:?}], [{:?}]\",\n         s1,\n         s2,\n         s3,\n@@ -63,6 +65,7 @@ fn main() {\n         s16,\n         s17,\n         s18,\n+        s19,\n     );\n }\n "}]}