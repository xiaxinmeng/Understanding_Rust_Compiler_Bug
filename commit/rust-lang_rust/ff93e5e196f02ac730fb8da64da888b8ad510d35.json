{"sha": "ff93e5e196f02ac730fb8da64da888b8ad510d35", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZmOTNlNWUxOTZmMDJhYzczMGZiOGRhNjRkYTg4OGI4YWQ1MTBkMzU=", "commit": {"author": {"name": "Michael Bebenita", "email": "mbebenita@mozilla.com", "date": "2010-08-11T21:04:36Z"}, "committer": {"name": "Michael Bebenita", "email": "mbebenita@mozilla.com", "date": "2010-08-11T23:08:45Z"}, "message": "Print domain and task names in log prefix.", "tree": {"sha": "b425a929cdc1800bc1316a28f386634dbed15d48", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b425a929cdc1800bc1316a28f386634dbed15d48"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ff93e5e196f02ac730fb8da64da888b8ad510d35", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ff93e5e196f02ac730fb8da64da888b8ad510d35", "html_url": "https://github.com/rust-lang/rust/commit/ff93e5e196f02ac730fb8da64da888b8ad510d35", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ff93e5e196f02ac730fb8da64da888b8ad510d35/comments", "author": {"login": "mbebenita", "id": 311082, "node_id": "MDQ6VXNlcjMxMTA4Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/311082?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mbebenita", "html_url": "https://github.com/mbebenita", "followers_url": "https://api.github.com/users/mbebenita/followers", "following_url": "https://api.github.com/users/mbebenita/following{/other_user}", "gists_url": "https://api.github.com/users/mbebenita/gists{/gist_id}", "starred_url": "https://api.github.com/users/mbebenita/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mbebenita/subscriptions", "organizations_url": "https://api.github.com/users/mbebenita/orgs", "repos_url": "https://api.github.com/users/mbebenita/repos", "events_url": "https://api.github.com/users/mbebenita/events{/privacy}", "received_events_url": "https://api.github.com/users/mbebenita/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mbebenita", "id": 311082, "node_id": "MDQ6VXNlcjMxMTA4Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/311082?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mbebenita", "html_url": "https://github.com/mbebenita", "followers_url": "https://api.github.com/users/mbebenita/followers", "following_url": "https://api.github.com/users/mbebenita/following{/other_user}", "gists_url": "https://api.github.com/users/mbebenita/gists{/gist_id}", "starred_url": "https://api.github.com/users/mbebenita/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mbebenita/subscriptions", "organizations_url": "https://api.github.com/users/mbebenita/orgs", "repos_url": "https://api.github.com/users/mbebenita/repos", "events_url": "https://api.github.com/users/mbebenita/events{/privacy}", "received_events_url": "https://api.github.com/users/mbebenita/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f307688bf44404b371b91b3b2a67048088695fe1", "url": "https://api.github.com/repos/rust-lang/rust/commits/f307688bf44404b371b91b3b2a67048088695fe1", "html_url": "https://github.com/rust-lang/rust/commit/f307688bf44404b371b91b3b2a67048088695fe1"}], "stats": {"total": 17, "additions": 13, "deletions": 4}, "files": [{"sha": "50a107d59df2fe9b832b43bbecc3fc1bf8e9e8ca", "filename": "src/rt/rust_log.cpp", "status": "modified", "additions": 13, "deletions": 4, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/ff93e5e196f02ac730fb8da64da888b8ad510d35/src%2Frt%2Frust_log.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/ff93e5e196f02ac730fb8da64da888b8ad510d35/src%2Frt%2Frust_log.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_log.cpp?ref=ff93e5e196f02ac730fb8da64da888b8ad510d35", "patch": "@@ -145,13 +145,22 @@ rust_log::trace_ln(rust_task *task, char *message) {\n #if defined(__WIN32__)\n     uint32_t thread_id = 0;\n #else\n-    uint32_t thread_id = (uint32_t) pthread_self();\n+    uint32_t thread_id = hash((uint32_t) pthread_self());\n #endif\n     char prefix[1024] = \"\";\n-    append_string(prefix, \"0x%08\" PRIxPTR \":0x%08\" PRIxPTR \":\",\n-                  thread_id, (uintptr_t) _dom);\n+    if (_dom->name) {\n+        append_string(prefix, \"%04\" PRIxPTR \":%.10s:\",\n+                      thread_id, _dom->name);\n+    } else {\n+        append_string(prefix, \"%04\" PRIxPTR \":0x%08\" PRIxPTR \":\",\n+                      thread_id, (uintptr_t) _dom);\n+    }\n     if (task) {\n-        append_string(prefix, \"0x%08\" PRIxPTR \":\", (uintptr_t) task);\n+        if (task->name) {\n+            append_string(prefix, \"%.10s:\", task->name);\n+        } else {\n+            append_string(prefix, \"0x%08\" PRIxPTR \":\", (uintptr_t) task);\n+        }\n     }\n     trace_ln(thread_id, prefix, message);\n }"}]}