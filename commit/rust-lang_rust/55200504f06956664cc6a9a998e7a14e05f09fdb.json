{"sha": "55200504f06956664cc6a9a998e7a14e05f09fdb", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU1MjAwNTA0ZjA2OTU2NjY0Y2M2YTlhOTk4ZTdhMTRlMDVmMDlmZGI=", "commit": {"author": {"name": "Victor Berger", "email": "victor.berger@m4x.org", "date": "2014-11-17T10:37:07Z"}, "committer": {"name": "Victor Berger", "email": "victor.berger@m4x.org", "date": "2014-11-17T17:14:42Z"}, "message": "Don't inherit stability to items in a function body.\n\nItems defined in the body of a function has no visibility\noutside it, and thus have no reason to be marked with\nstability attributes.\n\nCloses #17488", "tree": {"sha": "f1645cda5f0f2471bf5ff26f998db1d2162f28b3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f1645cda5f0f2471bf5ff26f998db1d2162f28b3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/55200504f06956664cc6a9a998e7a14e05f09fdb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/55200504f06956664cc6a9a998e7a14e05f09fdb", "html_url": "https://github.com/rust-lang/rust/commit/55200504f06956664cc6a9a998e7a14e05f09fdb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/55200504f06956664cc6a9a998e7a14e05f09fdb/comments", "author": {"login": "elinorbgr", "id": 3009227, "node_id": "MDQ6VXNlcjMwMDkyMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/3009227?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elinorbgr", "html_url": "https://github.com/elinorbgr", "followers_url": "https://api.github.com/users/elinorbgr/followers", "following_url": "https://api.github.com/users/elinorbgr/following{/other_user}", "gists_url": "https://api.github.com/users/elinorbgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/elinorbgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elinorbgr/subscriptions", "organizations_url": "https://api.github.com/users/elinorbgr/orgs", "repos_url": "https://api.github.com/users/elinorbgr/repos", "events_url": "https://api.github.com/users/elinorbgr/events{/privacy}", "received_events_url": "https://api.github.com/users/elinorbgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "elinorbgr", "id": 3009227, "node_id": "MDQ6VXNlcjMwMDkyMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/3009227?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elinorbgr", "html_url": "https://github.com/elinorbgr", "followers_url": "https://api.github.com/users/elinorbgr/followers", "following_url": "https://api.github.com/users/elinorbgr/following{/other_user}", "gists_url": "https://api.github.com/users/elinorbgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/elinorbgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elinorbgr/subscriptions", "organizations_url": "https://api.github.com/users/elinorbgr/orgs", "repos_url": "https://api.github.com/users/elinorbgr/repos", "events_url": "https://api.github.com/users/elinorbgr/events{/privacy}", "received_events_url": "https://api.github.com/users/elinorbgr/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "803aacd5aef78f90fdd06ae7653fc20eec224992", "url": "https://api.github.com/repos/rust-lang/rust/commits/803aacd5aef78f90fdd06ae7653fc20eec224992", "html_url": "https://github.com/rust-lang/rust/commit/803aacd5aef78f90fdd06ae7653fc20eec224992"}], "stats": {"total": 21, "additions": 19, "deletions": 2}, "files": [{"sha": "4df5d23e91d0d6e70e52f54418b925990ca060d0", "filename": "src/librustc/middle/stability.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/55200504f06956664cc6a9a998e7a14e05f09fdb/src%2Flibrustc%2Fmiddle%2Fstability.rs", "raw_url": "https://github.com/rust-lang/rust/raw/55200504f06956664cc6a9a998e7a14e05f09fdb/src%2Flibrustc%2Fmiddle%2Fstability.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fstability.rs?ref=55200504f06956664cc6a9a998e7a14e05f09fdb", "patch": "@@ -83,10 +83,13 @@ impl<'v> Visitor<'v> for Annotator {\n                 b: &'v Block, s: Span, _: NodeId) {\n         match fk {\n             FkMethod(_, _, meth) => {\n-                self.annotate(meth.id, &meth.attrs, |v| visit::walk_fn(v, fk, fd, b, s));\n+                // Methods are not already annotated, so we annotate it\n+                self.annotate(meth.id, &meth.attrs, |_| {});\n             }\n-            _ => visit::walk_fn(self, fk, fd, b, s)\n+            _ => {}\n         }\n+        // Items defined in a function body have no reason to have\n+        // a stability attribute, so we don't recurse.\n     }\n \n     fn visit_trait_item(&mut self, t: &TraitItem) {"}, {"sha": "a3e99ad1e5b71978e57d7fba5eada183e4ac750d", "filename": "src/test/compile-fail/lint-stability.rs", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/55200504f06956664cc6a9a998e7a14e05f09fdb/src%2Ftest%2Fcompile-fail%2Flint-stability.rs", "raw_url": "https://github.com/rust-lang/rust/raw/55200504f06956664cc6a9a998e7a14e05f09fdb/src%2Ftest%2Fcompile-fail%2Flint-stability.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Flint-stability.rs?ref=55200504f06956664cc6a9a998e7a14e05f09fdb", "patch": "@@ -459,6 +459,20 @@ mod this_crate {\n         foo.trait_stable();\n     }\n \n+    #[deprecated]\n+    fn test_fn_body() {\n+        fn fn_in_body() {}\n+        fn_in_body();\n+    }\n+\n+    impl MethodTester {\n+        #[deprecated]\n+        fn test_method_body(&self) {\n+            fn fn_in_body() {}\n+            fn_in_body();\n+        }\n+    }\n+\n     #[deprecated]\n     pub trait DeprecatedTrait {}\n "}]}