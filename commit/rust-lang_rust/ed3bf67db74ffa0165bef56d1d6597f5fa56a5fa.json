{"sha": "ed3bf67db74ffa0165bef56d1d6597f5fa56a5fa", "node_id": "C_kwDOAAsO6NoAKGVkM2JmNjdkYjc0ZmZhMDE2NWJlZjU2ZDFkNjU5N2Y1ZmE1NmE1ZmE", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-01-20T16:10:39Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-01-20T16:10:39Z"}, "message": "Rollup merge of #92861 - jsha:mobile-column-flex, r=GuillaumeGomez\n\nRustdoc mobile: put out-of-band info on its own line\n\nBefore this, the item name and the stability, source link, and \"collapse\nall docs\" would compete for room on a single line, resulting in awkward\nwrapping behavior on mobile. This gives a separate line for that\nout-of-band information. It also removes the \"copy path\" icon on mobile\nto make a little more room.\n\nDemo: https://rustdoc.crud.net/jsha/mobile-column-flex/std/string/struct.String.html\n\nr? `@GuillaumeGomez`", "tree": {"sha": "80b82e7a443ee6f7284f2d805ff1070dcda6ee44", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/80b82e7a443ee6f7284f2d805ff1070dcda6ee44"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ed3bf67db74ffa0165bef56d1d6597f5fa56a5fa", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJh6Yl/CRBK7hj4Ov3rIwAArUkIAEn17J3vBZ2FkDG0tco1Fi+j\n/yFHNHevAeyKYKCPHWM12ERdtsKC76mXAtEscpfABXsX4gjymeK3KwF6QzhsQpJG\nFdRrs00gBJ4pA91K5GDkvvEpm0FG5AHDFVDFAcQYF2ojpMo2eFUzV4yZZMSFp+xE\nUfQ3MP4IwnEa65cExs0cSfB5JLIame7x0+UsBWO55fxf2rfkD8MHKOM6pSnuhDPP\nY7Z+q6mD0Zp9x7prJFzkdl1gSZE9ccksKxUhxdaKRh/YHOf5OnrkoiY8y0o3UTzA\n/i0NN52oZrg9XKy61bfYFmjPRRU8rqLb/ekTvjAIaz/fFckdERf6APBaDwMMqnA=\n=n9k1\n-----END PGP SIGNATURE-----\n", "payload": "tree 80b82e7a443ee6f7284f2d805ff1070dcda6ee44\nparent 5c10dbd85f962e4fc1ed16f4e157f00e5e7b6a8a\nparent 152e8889052adaaa6c12652486292be34059713c\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1642695039 +0100\ncommitter GitHub <noreply@github.com> 1642695039 +0100\n\nRollup merge of #92861 - jsha:mobile-column-flex, r=GuillaumeGomez\n\nRustdoc mobile: put out-of-band info on its own line\n\nBefore this, the item name and the stability, source link, and \"collapse\nall docs\" would compete for room on a single line, resulting in awkward\nwrapping behavior on mobile. This gives a separate line for that\nout-of-band information. It also removes the \"copy path\" icon on mobile\nto make a little more room.\n\nDemo: https://rustdoc.crud.net/jsha/mobile-column-flex/std/string/struct.String.html\n\nr? `@GuillaumeGomez`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ed3bf67db74ffa0165bef56d1d6597f5fa56a5fa", "html_url": "https://github.com/rust-lang/rust/commit/ed3bf67db74ffa0165bef56d1d6597f5fa56a5fa", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ed3bf67db74ffa0165bef56d1d6597f5fa56a5fa/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5c10dbd85f962e4fc1ed16f4e157f00e5e7b6a8a", "url": "https://api.github.com/repos/rust-lang/rust/commits/5c10dbd85f962e4fc1ed16f4e157f00e5e7b6a8a", "html_url": "https://github.com/rust-lang/rust/commit/5c10dbd85f962e4fc1ed16f4e157f00e5e7b6a8a"}, {"sha": "152e8889052adaaa6c12652486292be34059713c", "url": "https://api.github.com/repos/rust-lang/rust/commits/152e8889052adaaa6c12652486292be34059713c", "html_url": "https://github.com/rust-lang/rust/commit/152e8889052adaaa6c12652486292be34059713c"}], "stats": {"total": 58, "additions": 43, "deletions": 15}, "files": [{"sha": "d0244351b5973d907995aee75ba8ce37d2582f07", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 20, "deletions": 9, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/ed3bf67db74ffa0165bef56d1d6597f5fa56a5fa/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/ed3bf67db74ffa0165bef56d1d6597f5fa56a5fa/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=ed3bf67db74ffa0165bef56d1d6597f5fa56a5fa", "patch": "@@ -148,11 +148,11 @@ h1.fqn {\n }\n .main-heading {\n \tdisplay: flex;\n+\tflex-wrap: wrap;\n+\tjustify-content: space-between;\n+\tborder-bottom: 1px dashed #DDDDDD;\n+\tpadding-bottom: 6px;\n \tmargin-bottom: 15px;\n-\n-\t/* workaround to keep flex from breaking below 700 px width due to the float: right on the nav\n-\t   above the h1 */\n-\tpadding-left: 1px;\n }\n .main-heading a:hover {\n \ttext-decoration: underline;\n@@ -623,11 +623,7 @@ nav.sub {\n \n .content .out-of-band {\n \tflex-grow: 0;\n-\ttext-align: right;\n-\tmargin-left: auto;\n-\tmargin-right: 0;\n \tfont-size: 1.15rem;\n-\tpadding: 0 0 0 12px;\n \tfont-weight: normal;\n \tfloat: right;\n }\n@@ -1748,10 +1744,25 @@ details.rustdoc-toggle[open] > summary.hideme::after {\n \t\tpadding-top: 0px;\n \t}\n \n-\t.rustdoc {\n+\t.rustdoc,\n+\t.main-heading {\n \t\tflex-direction: column;\n \t}\n \n+\t.content .out-of-band {\n+\t\ttext-align: left;\n+\t\tmargin-left: initial;\n+\t\tpadding: initial;\n+\t}\n+\n+\t.content .out-of-band .since::before {\n+\t\tcontent: \"Since \";\n+\t}\n+\n+\t#copy-path {\n+\t\tdisplay: none;\n+\t}\n+\n \t/* Hide the logo and item name from the sidebar. Those are displayed\n \t   in the mobile-topbar instead. */\n \t.sidebar .sidebar-logo,"}, {"sha": "acde112392521caf3be383a9c11ce7c76d4ece7d", "filename": "src/test/rustdoc-gui/mobile.goml", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/ed3bf67db74ffa0165bef56d1d6597f5fa56a5fa/src%2Ftest%2Frustdoc-gui%2Fmobile.goml", "raw_url": "https://github.com/rust-lang/rust/raw/ed3bf67db74ffa0165bef56d1d6597f5fa56a5fa/src%2Ftest%2Frustdoc-gui%2Fmobile.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fmobile.goml?ref=ed3bf67db74ffa0165bef56d1d6597f5fa56a5fa", "patch": "@@ -0,0 +1,17 @@\n+// Test various properties of the mobile UI\n+goto: file://|DOC_PATH|/staged_api/struct.Foo.html\n+size: (400, 600)\n+\n+// The out-of-band info (source, stable version, collapse) should be below the\n+// h1 when the screen gets narrow enough.\n+assert-css: (\".main-heading\", {\n+  \"display\": \"flex\",\n+  \"flex-direction\": \"column\"\n+})\n+\n+// Note: We can't use assert-text here because the 'Since' is set by CSS and\n+// is therefore not part of the DOM.\n+assert-css: (\".content .out-of-band .since::before\", { \"content\": \"\\\"Since \\\"\" })\n+\n+size: (1000, 1000)\n+assert-css-false: (\".content .out-of-band .since::before\", { \"content\": \"\\\"Since \\\"\" })"}, {"sha": "e7a75b43c5a02abca8294d4cf1dc061608c4d9ab", "filename": "src/test/rustdoc-gui/toggle-docs-mobile.goml", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/ed3bf67db74ffa0165bef56d1d6597f5fa56a5fa/src%2Ftest%2Frustdoc-gui%2Ftoggle-docs-mobile.goml", "raw_url": "https://github.com/rust-lang/rust/raw/ed3bf67db74ffa0165bef56d1d6597f5fa56a5fa/src%2Ftest%2Frustdoc-gui%2Ftoggle-docs-mobile.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Ftoggle-docs-mobile.goml?ref=ed3bf67db74ffa0165bef56d1d6597f5fa56a5fa", "patch": "@@ -1,12 +1,12 @@\n goto: file://|DOC_PATH|/test_docs/struct.Foo.html\n size: (433, 600)\n assert-attribute: (\".top-doc\", {\"open\": \"\"})\n-click: (4, 250) // This is the position of the top doc comment toggle\n+click: (4, 270) // This is the position of the top doc comment toggle\n assert-attribute-false: (\".top-doc\", {\"open\": \"\"})\n-click: (4, 250)\n+click: (4, 270)\n assert-attribute: (\".top-doc\", {\"open\": \"\"})\n // To ensure that the toggle isn't over the text, we check that the toggle isn't clicked.\n-click: (3, 250)\n+click: (3, 270)\n assert-attribute: (\".top-doc\", {\"open\": \"\"})\n \n // Assert the position of the toggle on the top doc block.\n@@ -22,10 +22,10 @@ assert-position: (\n // Now we do the same but with a little bigger width\n size: (600, 600)\n assert-attribute: (\".top-doc\", {\"open\": \"\"})\n-click: (4, 250) // New Y position since all search elements are back on one line.\n+click: (4, 270) // New Y position since all search elements are back on one line.\n assert-attribute-false: (\".top-doc\", {\"open\": \"\"})\n-click: (4, 250)\n+click: (4, 270)\n assert-attribute: (\".top-doc\", {\"open\": \"\"})\n // To ensure that the toggle isn't over the text, we check that the toggle isn't clicked.\n-click: (3, 250)\n+click: (3, 270)\n assert-attribute: (\".top-doc\", {\"open\": \"\"})"}]}