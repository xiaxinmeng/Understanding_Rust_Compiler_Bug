{"sha": "b82949b36e7fb66162e31066d3d6f6174f680b5b", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI4Mjk0OWIzNmU3ZmI2NjE2MmUzMTA2NmQzZDZmNjE3NGY2ODBiNWI=", "commit": {"author": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2018-10-11T21:55:45Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-10-11T21:55:45Z"}, "message": "Merge pull request #3089 from topecongiro/format-comment\n\nAdd format_doc_comments", "tree": {"sha": "a30c949a1bfad83162ab400a305e90c9c60bdade", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a30c949a1bfad83162ab400a305e90c9c60bdade"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b82949b36e7fb66162e31066d3d6f6174f680b5b", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJbv8bhCRBK7hj4Ov3rIwAAdHIIAAoI+VbOSHGE97z2/pxC5j/X\n853T89eQE5IZj8WRy/fsX71dEn6nT7waXeD0sbuxQ1wJpXaj08riXZbcr2i3XHqi\nprqXRHn0mELUxIpOgTWdQKXDA+Hk7hrB8Nlj81YpMY5Oavc0kmdKCkq7SUZ/6njV\n/HQPgM6Ssd3+baJnKTwBJ5Ff57BoClRNewQnls6FQnFhB0R9WqAxqJk7RDo53H7/\nPH/5D3HNDn3B/RMo/5lMbMNYq1rCqC7FXjt6XA7cvQHh56LzBIbWO5HBF9GyhLCQ\ni6vK5nK9DqY/f0m/pQdvLpx+1e6Yi0qrwaVvcOgM9s+B4D5Gx/vjPy1IdD6xjOk=\n=xE9y\n-----END PGP SIGNATURE-----\n", "payload": "tree a30c949a1bfad83162ab400a305e90c9c60bdade\nparent d74947c65e3ddc79071f0c9eaede0a8d602ca79c\nparent b2de57484835ee42567db3a1bf59f13ecc7fab33\nauthor Nick Cameron <nrc@ncameron.org> 1539294945 +1200\ncommitter GitHub <noreply@github.com> 1539294945 +1200\n\nMerge pull request #3089 from topecongiro/format-comment\n\nAdd format_doc_comments"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b82949b36e7fb66162e31066d3d6f6174f680b5b", "html_url": "https://github.com/rust-lang/rust/commit/b82949b36e7fb66162e31066d3d6f6174f680b5b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b82949b36e7fb66162e31066d3d6f6174f680b5b/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d74947c65e3ddc79071f0c9eaede0a8d602ca79c", "url": "https://api.github.com/repos/rust-lang/rust/commits/d74947c65e3ddc79071f0c9eaede0a8d602ca79c", "html_url": "https://github.com/rust-lang/rust/commit/d74947c65e3ddc79071f0c9eaede0a8d602ca79c"}, {"sha": "b2de57484835ee42567db3a1bf59f13ecc7fab33", "url": "https://api.github.com/repos/rust-lang/rust/commits/b2de57484835ee42567db3a1bf59f13ecc7fab33", "html_url": "https://github.com/rust-lang/rust/commit/b2de57484835ee42567db3a1bf59f13ecc7fab33"}], "stats": {"total": 64, "additions": 59, "deletions": 5}, "files": [{"sha": "f23506d5fe8d28e02d2aa0cf533e906ebd725de4", "filename": "Configurations.md", "status": "modified", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/rust-lang/rust/blob/b82949b36e7fb66162e31066d3d6f6174f680b5b/Configurations.md", "raw_url": "https://github.com/rust-lang/rust/raw/b82949b36e7fb66162e31066d3d6f6174f680b5b/Configurations.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Configurations.md?ref=b82949b36e7fb66162e31066d3d6f6174f680b5b", "patch": "@@ -1979,6 +1979,56 @@ fn main() {\n }\n ```\n \n+## `format_doc_comments`\n+\n+Format doc comments.\n+\n+- **Default value**: `false`\n+- **Possible values**: `true`, `false`\n+- **Stable**: No\n+\n+#### `false` (default):\n+\n+```rust\n+/// Adds one to the number given.\n+///\n+/// # Examples\n+///\n+/// ```rust\n+/// let five=5;\n+///\n+/// assert_eq!(\n+///     6,\n+///     add_one(5)\n+/// );\n+/// # fn add_one(x: i32) -> i32 {\n+/// #     x + 1\n+/// # }\n+/// ```\n+fn add_one(x: i32) -> i32 {\n+    x + 1\n+}\n+```\n+\n+#### `true`\n+\n+```rust\n+/// Adds one to the number given.\n+///\n+/// # Examples\n+///\n+/// ```rust\n+/// let five = 5;\n+///\n+/// assert_eq!(6, add_one(5));\n+/// # fn add_one(x: i32) -> i32 {\n+/// #     x + 1\n+/// # }\n+/// ```\n+fn add_one(x: i32) -> i32 {\n+    x + 1\n+}\n+```\n \n ## `wrap_comments`\n "}, {"sha": "213879e50a1948a0fef958fa194c9aafa8581920", "filename": "src/comment.rs", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/b82949b36e7fb66162e31066d3d6f6174f680b5b/src%2Fcomment.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b82949b36e7fb66162e31066d3d6f6174f680b5b/src%2Fcomment.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomment.rs?ref=b82949b36e7fb66162e31066d3d6f6174f680b5b", "patch": "@@ -333,7 +333,10 @@ fn identify_comment(\n     let rewritten_first_group =\n         if !config.normalize_comments() && has_bare_lines && style.is_block_comment() {\n             light_rewrite_block_comment_with_bare_lines(first_group, shape, config)?\n-        } else if !config.normalize_comments() && !config.wrap_comments() {\n+        } else if !config.normalize_comments()\n+            && !config.wrap_comments()\n+            && !config.format_doc_comments()\n+        {\n             light_rewrite_comment(first_group, shape.indent, config, is_doc_comment)?\n         } else {\n             rewrite_comment_inner(\n@@ -593,7 +596,7 @@ fn rewrite_comment_inner(\n                     _ if code_block_buffer.is_empty() => String::new(),\n                     _ => {\n                         let mut config = config.clone();\n-                        config.set().wrap_comments(false);\n+                        config.set().format_doc_comments(false);\n                         match ::format_code_block(&code_block_buffer, &config) {\n                             Some(ref s) => trim_custom_comment_prefix(s),\n                             None => trim_custom_comment_prefix(&code_block_buffer),\n@@ -1622,7 +1625,7 @@ mod test {\n \n     #[test]\n     #[rustfmt::skip]\n-    fn format_comments() {\n+    fn format_doc_comments() {\n         let mut wrap_normalize_config: ::config::Config = Default::default();\n         wrap_normalize_config.set().wrap_comments(true);\n         wrap_normalize_config.set().normalize_comments(true);"}, {"sha": "98754eb0b60a75275de5d65d9808a52e2878815b", "filename": "src/config/mod.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b82949b36e7fb66162e31066d3d6f6174f680b5b/src%2Fconfig%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b82949b36e7fb66162e31066d3d6f6174f680b5b/src%2Fconfig%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fconfig%2Fmod.rs?ref=b82949b36e7fb66162e31066d3d6f6174f680b5b", "patch": "@@ -46,6 +46,7 @@ create_config! {\n \n     // Comments. macros, and strings\n     wrap_comments: bool, false, false, \"Break comments to fit on the line\";\n+    format_doc_comments: bool, false, false, \"Format doc comments.\";\n     comment_width: usize, 80, false,\n         \"Maximum length of comments. No effect unless wrap_comments = true\";\n     normalize_comments: bool, false, false, \"Convert /* */ comments to // comments where possible\";"}, {"sha": "58d98acfa2556ea40a0dd115db04206ee6cde36a", "filename": "tests/source/doc-comment-with-example.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b82949b36e7fb66162e31066d3d6f6174f680b5b/tests%2Fsource%2Fdoc-comment-with-example.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b82949b36e7fb66162e31066d3d6f6174f680b5b/tests%2Fsource%2Fdoc-comment-with-example.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fdoc-comment-with-example.rs?ref=b82949b36e7fb66162e31066d3d6f6174f680b5b", "patch": "@@ -1,4 +1,4 @@\n-// rustfmt-wrap_comments: true\n+// rustfmt-format_doc_comments: true\n \n /// Foo\n ///"}, {"sha": "bec931d13c7879f59386001135b84aa0565cb091", "filename": "tests/target/doc-comment-with-example.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b82949b36e7fb66162e31066d3d6f6174f680b5b/tests%2Ftarget%2Fdoc-comment-with-example.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b82949b36e7fb66162e31066d3d6f6174f680b5b/tests%2Ftarget%2Fdoc-comment-with-example.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fdoc-comment-with-example.rs?ref=b82949b36e7fb66162e31066d3d6f6174f680b5b", "patch": "@@ -1,4 +1,4 @@\n-// rustfmt-wrap_comments: true\n+// rustfmt-format_doc_comments: true\n \n /// Foo\n ///"}]}