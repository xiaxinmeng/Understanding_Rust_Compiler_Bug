{"sha": "b75f81c9b3f996100c72f9141dcf6161f8fc90f4", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI3NWY4MWM5YjNmOTk2MTAwYzcyZjkxNDFkY2Y2MTYxZjhmYzkwZjQ=", "commit": {"author": {"name": "Georg Brandl", "email": "georg@python.org", "date": "2016-05-02T06:45:38Z"}, "committer": {"name": "Georg Brandl", "email": "georg@python.org", "date": "2016-05-02T10:49:31Z"}, "message": "parser: do not try to continue with `unsafe` on foreign fns\n\nThe changed line makes it look like `unsafe` is allowed, but the\nfirst statement of `parse_item_foreign_fn` is:\n\n`self.expect_keyword(keywords::Fn)?;`\n\nSo we get the strange \"expected one of `fn`, `pub`, `static`, or\n`unsafe`, found `unsafe`\".\n\nFixes: #27361", "tree": {"sha": "ea25571a1f22bc63f436a1791925125e4fe7e7f1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ea25571a1f22bc63f436a1791925125e4fe7e7f1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b75f81c9b3f996100c72f9141dcf6161f8fc90f4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b75f81c9b3f996100c72f9141dcf6161f8fc90f4", "html_url": "https://github.com/rust-lang/rust/commit/b75f81c9b3f996100c72f9141dcf6161f8fc90f4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b75f81c9b3f996100c72f9141dcf6161f8fc90f4/comments", "author": {"login": "birkenfeld", "id": 144359, "node_id": "MDQ6VXNlcjE0NDM1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/144359?v=4", "gravatar_id": "", "url": "https://api.github.com/users/birkenfeld", "html_url": "https://github.com/birkenfeld", "followers_url": "https://api.github.com/users/birkenfeld/followers", "following_url": "https://api.github.com/users/birkenfeld/following{/other_user}", "gists_url": "https://api.github.com/users/birkenfeld/gists{/gist_id}", "starred_url": "https://api.github.com/users/birkenfeld/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/birkenfeld/subscriptions", "organizations_url": "https://api.github.com/users/birkenfeld/orgs", "repos_url": "https://api.github.com/users/birkenfeld/repos", "events_url": "https://api.github.com/users/birkenfeld/events{/privacy}", "received_events_url": "https://api.github.com/users/birkenfeld/received_events", "type": "User", "site_admin": false}, "committer": {"login": "birkenfeld", "id": 144359, "node_id": "MDQ6VXNlcjE0NDM1OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/144359?v=4", "gravatar_id": "", "url": "https://api.github.com/users/birkenfeld", "html_url": "https://github.com/birkenfeld", "followers_url": "https://api.github.com/users/birkenfeld/followers", "following_url": "https://api.github.com/users/birkenfeld/following{/other_user}", "gists_url": "https://api.github.com/users/birkenfeld/gists{/gist_id}", "starred_url": "https://api.github.com/users/birkenfeld/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/birkenfeld/subscriptions", "organizations_url": "https://api.github.com/users/birkenfeld/orgs", "repos_url": "https://api.github.com/users/birkenfeld/repos", "events_url": "https://api.github.com/users/birkenfeld/events{/privacy}", "received_events_url": "https://api.github.com/users/birkenfeld/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "855fb6192263a5c059325bb4b4e10b55e4e8ddbb", "url": "https://api.github.com/repos/rust-lang/rust/commits/855fb6192263a5c059325bb4b4e10b55e4e8ddbb", "html_url": "https://github.com/rust-lang/rust/commit/855fb6192263a5c059325bb4b4e10b55e4e8ddbb"}], "stats": {"total": 6, "additions": 3, "deletions": 3}, "files": [{"sha": "c22a36739d678aed5b52be158feb5c521a440ff2", "filename": "src/libsyntax/parse/parser.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b75f81c9b3f996100c72f9141dcf6161f8fc90f4/src%2Flibsyntax%2Fparse%2Fparser.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b75f81c9b3f996100c72f9141dcf6161f8fc90f4/src%2Flibsyntax%2Fparse%2Fparser.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Fparser.rs?ref=b75f81c9b3f996100c72f9141dcf6161f8fc90f4", "patch": "@@ -6025,7 +6025,7 @@ impl<'a> Parser<'a> {\n             // FOREIGN STATIC ITEM\n             return Ok(Some(self.parse_item_foreign_static(visibility, lo, attrs)?));\n         }\n-        if self.check_keyword(keywords::Fn) || self.check_keyword(keywords::Unsafe) {\n+        if self.check_keyword(keywords::Fn) {\n             // FOREIGN FUNCTION ITEM\n             return Ok(Some(self.parse_item_foreign_fn(visibility, lo, attrs)?));\n         }"}, {"sha": "acf7187cf436ff0d6ee06e40975c017099cc074f", "filename": "src/test/parse-fail/extern-no-fn.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b75f81c9b3f996100c72f9141dcf6161f8fc90f4/src%2Ftest%2Fparse-fail%2Fextern-no-fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b75f81c9b3f996100c72f9141dcf6161f8fc90f4/src%2Ftest%2Fparse-fail%2Fextern-no-fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fparse-fail%2Fextern-no-fn.rs?ref=b75f81c9b3f996100c72f9141dcf6161f8fc90f4", "patch": "@@ -11,7 +11,7 @@\n // compile-flags: -Z parse-only\n \n extern {\n-    f(); //~ ERROR expected one of `fn`, `pub`, `static`, `unsafe`, or `}`, found `f`\n+    f(); //~ ERROR expected one of `fn`, `pub`, `static`, or `}`, found `f`\n }\n \n fn main() {"}, {"sha": "e632af6c83b1d4f7950fd66e5d38da658321053d", "filename": "src/test/parse-fail/removed-syntax-extern-const.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b75f81c9b3f996100c72f9141dcf6161f8fc90f4/src%2Ftest%2Fparse-fail%2Fremoved-syntax-extern-const.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b75f81c9b3f996100c72f9141dcf6161f8fc90f4/src%2Ftest%2Fparse-fail%2Fremoved-syntax-extern-const.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fparse-fail%2Fremoved-syntax-extern-const.rs?ref=b75f81c9b3f996100c72f9141dcf6161f8fc90f4", "patch": "@@ -12,5 +12,5 @@\n \n extern {\n     const i: isize;\n-    //~^ ERROR expected one of `fn`, `pub`, `static`, `unsafe`, or `}`, found `const`\n+    //~^ ERROR expected one of `fn`, `pub`, `static`, or `}`, found `const`\n }"}]}