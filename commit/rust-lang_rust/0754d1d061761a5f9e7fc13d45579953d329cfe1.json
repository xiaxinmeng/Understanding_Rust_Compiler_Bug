{"sha": "0754d1d061761a5f9e7fc13d45579953d329cfe1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA3NTRkMWQwNjE3NjFhNWY5ZTdmYzEzZDQ1NTc5OTUzZDMyOWNmZTE=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2014-04-15T13:27:09Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2014-04-16T02:47:03Z"}, "message": "green: Add a helper macro for booting libgreen\n\nThis one-liner should help booting libgreen with librustuv without having to\nworry about all the fiddly bits of argc/argv and whatnot.", "tree": {"sha": "3bb56eadf7fb81ccd060ebd8e89de21f49681a80", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3bb56eadf7fb81ccd060ebd8e89de21f49681a80"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0754d1d061761a5f9e7fc13d45579953d329cfe1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0754d1d061761a5f9e7fc13d45579953d329cfe1", "html_url": "https://github.com/rust-lang/rust/commit/0754d1d061761a5f9e7fc13d45579953d329cfe1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0754d1d061761a5f9e7fc13d45579953d329cfe1/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "55f02b2c1bdb6a8947478b1bdfd16423bfa7e2f5", "url": "https://api.github.com/repos/rust-lang/rust/commits/55f02b2c1bdb6a8947478b1bdfd16423bfa7e2f5", "html_url": "https://github.com/rust-lang/rust/commit/55f02b2c1bdb6a8947478b1bdfd16423bfa7e2f5"}], "stats": {"total": 40, "additions": 40, "deletions": 0}, "files": [{"sha": "dd897b9db4bafe8564a40f35044d4f0f2588541b", "filename": "src/libgreen/lib.rs", "status": "modified", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/0754d1d061761a5f9e7fc13d45579953d329cfe1/src%2Flibgreen%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0754d1d061761a5f9e7fc13d45579953d329cfe1/src%2Flibgreen%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibgreen%2Flib.rs?ref=0754d1d061761a5f9e7fc13d45579953d329cfe1", "patch": "@@ -144,6 +144,19 @@\n //! }\n //! ```\n //!\n+//! The above code can also be shortened with a macro from libgreen.\n+//!\n+//! ```\n+//! #![feature(phase)]\n+//! #[phase(syntax)] extern crate green;\n+//!\n+//! green_start!(main)\n+//!\n+//! fn main() {\n+//!     // run inside of a green pool\n+//! }\n+//! ```\n+//!\n //! # Using a scheduler pool\n //!\n //! ```rust\n@@ -229,6 +242,33 @@ pub mod sleeper_list;\n pub mod stack;\n pub mod task;\n \n+/// A helper macro for booting a program with libgreen\n+///\n+/// # Example\n+///\n+/// ```\n+/// #![feature(phase)]\n+/// #[phase(syntax)] extern crate green;\n+///\n+/// green_start!(main)\n+///\n+/// fn main() {\n+///     // running with libgreen\n+/// }\n+/// ```\n+#[macro_export]\n+macro_rules! green_start( ($f:ident) => (\n+    mod __start {\n+        extern crate green;\n+        extern crate rustuv;\n+\n+        #[start]\n+        fn start(argc: int, argv: **u8) -> int {\n+            green::start(argc, argv, rustuv::event_loop, super::$f)\n+        }\n+    }\n+) )\n+\n /// Set up a default runtime configuration, given compiler-supplied arguments.\n ///\n /// This function will block until the entire pool of M:N schedulers have"}]}