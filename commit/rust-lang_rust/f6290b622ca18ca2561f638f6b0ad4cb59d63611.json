{"sha": "f6290b622ca18ca2561f638f6b0ad4cb59d63611", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY2MjkwYjYyMmNhMThjYTI1NjFmNjM4ZjZiMGFkNGNiNTlkNjM2MTE=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2016-05-02T09:13:11Z"}, "committer": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2016-05-02T09:13:11Z"}, "message": "Merge branch 'pr-890'", "tree": {"sha": "a6983cbcaf9478c0a557e28df6a3bbb8226ed7d2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a6983cbcaf9478c0a557e28df6a3bbb8226ed7d2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f6290b622ca18ca2561f638f6b0ad4cb59d63611", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f6290b622ca18ca2561f638f6b0ad4cb59d63611", "html_url": "https://github.com/rust-lang/rust/commit/f6290b622ca18ca2561f638f6b0ad4cb59d63611", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f6290b622ca18ca2561f638f6b0ad4cb59d63611/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "469b3d51b48cccf0b12240b8b20447a8d1369254", "url": "https://api.github.com/repos/rust-lang/rust/commits/469b3d51b48cccf0b12240b8b20447a8d1369254", "html_url": "https://github.com/rust-lang/rust/commit/469b3d51b48cccf0b12240b8b20447a8d1369254"}, {"sha": "ee35c3722a25dda475a4828c5474795ddde285e2", "url": "https://api.github.com/repos/rust-lang/rust/commits/ee35c3722a25dda475a4828c5474795ddde285e2", "html_url": "https://github.com/rust-lang/rust/commit/ee35c3722a25dda475a4828c5474795ddde285e2"}], "stats": {"total": 41, "additions": 23, "deletions": 18}, "files": [{"sha": "9de4eef72edd3dbfda63cb26312c888e79f7beb7", "filename": "README.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f6290b622ca18ca2561f638f6b0ad4cb59d63611/README.md", "raw_url": "https://github.com/rust-lang/rust/raw/f6290b622ca18ca2561f638f6b0ad4cb59d63611/README.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/README.md?ref=f6290b622ca18ca2561f638f6b0ad4cb59d63611", "patch": "@@ -129,7 +129,7 @@ name\n [shadow_same](https://github.com/Manishearth/rust-clippy/wiki#shadow_same)                                           | allow   | rebinding a name to itself, e.g. `let mut x = &mut x`\n [shadow_unrelated](https://github.com/Manishearth/rust-clippy/wiki#shadow_unrelated)                                 | allow   | The name is re-bound without even using the original value\n [should_implement_trait](https://github.com/Manishearth/rust-clippy/wiki#should_implement_trait)                     | warn    | defining a method that should be implementing a std trait\n-[similar_names](https://github.com/Manishearth/rust-clippy/wiki#similar_names)                                       | warn    | similarly named items and bindings\n+[similar_names](https://github.com/Manishearth/rust-clippy/wiki#similar_names)                                       | allow   | similarly named items and bindings\n [single_char_pattern](https://github.com/Manishearth/rust-clippy/wiki#single_char_pattern)                           | warn    | using a single-character str where a char could be used, e.g. `_.split(\"x\")`\n [single_match](https://github.com/Manishearth/rust-clippy/wiki#single_match)                                         | warn    | a match statement with a single nontrivial arm (i.e, where the other arm is `_ => {}`) is used; recommends `if let` instead\n [single_match_else](https://github.com/Manishearth/rust-clippy/wiki#single_match_else)                               | allow   | a match statement with a two arms where the second arm's pattern is a wildcard; recommends `if let` instead"}, {"sha": "435e6998c169904882d25823d2c7739988185771", "filename": "src/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f6290b622ca18ca2561f638f6b0ad4cb59d63611/src%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f6290b622ca18ca2561f638f6b0ad4cb59d63611/src%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib.rs?ref=f6290b622ca18ca2561f638f6b0ad4cb59d63611", "patch": "@@ -266,6 +266,7 @@ pub fn plugin_registrar(reg: &mut Registry) {\n         methods::WRONG_PUB_SELF_CONVENTION,\n         mut_mut::MUT_MUT,\n         mutex_atomic::MUTEX_INTEGER,\n+        non_expressive_names::SIMILAR_NAMES,\n         print::PRINT_STDOUT,\n         print::USE_DEBUG,\n         shadow::SHADOW_REUSE,\n@@ -368,7 +369,6 @@ pub fn plugin_registrar(reg: &mut Registry) {\n         new_without_default::NEW_WITHOUT_DEFAULT,\n         no_effect::NO_EFFECT,\n         non_expressive_names::MANY_SINGLE_CHAR_NAMES,\n-        non_expressive_names::SIMILAR_NAMES,\n         open_options::NONSENSICAL_OPEN_OPTIONS,\n         overflow_check_conditional::OVERFLOW_CHECK_CONDITIONAL,\n         panic::PANIC_PARAMS,"}, {"sha": "0c6fdc37066824fddf7c99d7bacba63516a4bf6a", "filename": "src/non_expressive_names.rs", "status": "modified", "additions": 20, "deletions": 15, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/f6290b622ca18ca2561f638f6b0ad4cb59d63611/src%2Fnon_expressive_names.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f6290b622ca18ca2561f638f6b0ad4cb59d63611/src%2Fnon_expressive_names.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fnon_expressive_names.rs?ref=f6290b622ca18ca2561f638f6b0ad4cb59d63611", "patch": "@@ -2,7 +2,8 @@ use rustc::lint::*;\n use syntax::codemap::Span;\n use syntax::parse::token::InternedString;\n use syntax::ast::*;\n-use syntax::visit::{self, FnKind};\n+use syntax::attr;\n+use syntax::visit;\n use utils::{span_lint_and_then, in_macro, span_lint};\n \n /// **What it does:** This lint warns about names that are very similar and thus confusing\n@@ -14,7 +15,7 @@ use utils::{span_lint_and_then, in_macro, span_lint};\n /// **Example:** `checked_exp` and `checked_expr`\n declare_lint! {\n     pub SIMILAR_NAMES,\n-    Warn,\n+    Allow,\n     \"similarly named items and bindings\"\n }\n \n@@ -237,24 +238,28 @@ impl<'v, 'a, 'b> visit::Visitor<'v> for SimilarNamesLocalVisitor<'a, 'b> {\n         });\n     }\n     fn visit_item(&mut self, _: &'v Item) {\n-        // do nothing\n+        // do not recurse into inner items\n     }\n }\n \n impl EarlyLintPass for NonExpressiveNames {\n-    fn check_fn(&mut self, cx: &EarlyContext, _: FnKind, decl: &FnDecl, blk: &Block, _: Span, _: NodeId) {\n-        let mut visitor = SimilarNamesLocalVisitor {\n-            names: Vec::new(),\n-            cx: cx,\n-            lint: &self,\n-            single_char_names: Vec::new(),\n-        };\n-        // initialize with function arguments\n-        for arg in &decl.inputs {\n-            visit::walk_pat(&mut SimilarNamesNameVisitor(&mut visitor), &arg.pat);\n+    fn check_item(&mut self, cx: &EarlyContext, item: &Item) {\n+        if let ItemKind::Fn(ref decl, _, _, _, _, ref blk) = item.node {\n+            if !attr::contains_name(&item.attrs, \"test\") {\n+                let mut visitor = SimilarNamesLocalVisitor {\n+                    names: Vec::new(),\n+                    cx: cx,\n+                    lint: &self,\n+                    single_char_names: Vec::new(),\n+                };\n+                // initialize with function arguments\n+                for arg in &decl.inputs {\n+                    visit::walk_pat(&mut SimilarNamesNameVisitor(&mut visitor), &arg.pat);\n+                }\n+                // walk all other bindings\n+                visit::walk_block(&mut visitor, blk);\n+            }\n         }\n-        // walk all other bindings\n-        visit::walk_block(&mut visitor, blk);\n     }\n }\n "}, {"sha": "61fe0067a274d969968e0fc15e7bd86a993f8d71", "filename": "tests/compile-fail/non_expressive_names.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f6290b622ca18ca2561f638f6b0ad4cb59d63611/tests%2Fcompile-fail%2Fnon_expressive_names.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f6290b622ca18ca2561f638f6b0ad4cb59d63611/tests%2Fcompile-fail%2Fnon_expressive_names.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-fail%2Fnon_expressive_names.rs?ref=f6290b622ca18ca2561f638f6b0ad4cb59d63611", "patch": "@@ -1,6 +1,6 @@\n #![feature(plugin)]\n #![plugin(clippy)]\n-#![deny(clippy)]\n+#![deny(clippy,similar_names)]\n //~^ NOTE: lint level defined here\n //~| NOTE: lint level defined here\n //~| NOTE: lint level defined here"}]}