{"sha": "d8ef8acb47b1be92da97a2d5cd4334bceed5b919", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ4ZWY4YWNiNDdiMWJlOTJkYTk3YTJkNWNkNDMzNGJjZWVkNWI5MTk=", "commit": {"author": {"name": "Florian Diebold", "email": "flodiebold@gmail.com", "date": "2019-02-01T23:23:59Z"}, "committer": {"name": "Florian Diebold", "email": "flodiebold@gmail.com", "date": "2019-02-01T23:23:59Z"}, "message": "Use aliases in import resolution", "tree": {"sha": "b3df38ae7b749178d854be9f2e6b16070a373216", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b3df38ae7b749178d854be9f2e6b16070a373216"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d8ef8acb47b1be92da97a2d5cd4334bceed5b919", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d8ef8acb47b1be92da97a2d5cd4334bceed5b919", "html_url": "https://github.com/rust-lang/rust/commit/d8ef8acb47b1be92da97a2d5cd4334bceed5b919", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d8ef8acb47b1be92da97a2d5cd4334bceed5b919/comments", "author": {"login": "flodiebold", "id": 906069, "node_id": "MDQ6VXNlcjkwNjA2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/906069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flodiebold", "html_url": "https://github.com/flodiebold", "followers_url": "https://api.github.com/users/flodiebold/followers", "following_url": "https://api.github.com/users/flodiebold/following{/other_user}", "gists_url": "https://api.github.com/users/flodiebold/gists{/gist_id}", "starred_url": "https://api.github.com/users/flodiebold/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flodiebold/subscriptions", "organizations_url": "https://api.github.com/users/flodiebold/orgs", "repos_url": "https://api.github.com/users/flodiebold/repos", "events_url": "https://api.github.com/users/flodiebold/events{/privacy}", "received_events_url": "https://api.github.com/users/flodiebold/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flodiebold", "id": 906069, "node_id": "MDQ6VXNlcjkwNjA2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/906069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flodiebold", "html_url": "https://github.com/flodiebold", "followers_url": "https://api.github.com/users/flodiebold/followers", "following_url": "https://api.github.com/users/flodiebold/following{/other_user}", "gists_url": "https://api.github.com/users/flodiebold/gists{/gist_id}", "starred_url": "https://api.github.com/users/flodiebold/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flodiebold/subscriptions", "organizations_url": "https://api.github.com/users/flodiebold/orgs", "repos_url": "https://api.github.com/users/flodiebold/repos", "events_url": "https://api.github.com/users/flodiebold/events{/privacy}", "received_events_url": "https://api.github.com/users/flodiebold/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5a7fce4e4cd8846a49ce007910f72340007d9c8c", "url": "https://api.github.com/repos/rust-lang/rust/commits/5a7fce4e4cd8846a49ce007910f72340007d9c8c", "html_url": "https://github.com/rust-lang/rust/commit/5a7fce4e4cd8846a49ce007910f72340007d9c8c"}], "stats": {"total": 21, "additions": 12, "deletions": 9}, "files": [{"sha": "04cc693b37727926709beabe0e8a9bc60c70d7ec", "filename": "crates/ra_hir/src/nameres.rs", "status": "modified", "additions": 12, "deletions": 9, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/d8ef8acb47b1be92da97a2d5cd4334bceed5b919/crates%2Fra_hir%2Fsrc%2Fnameres.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d8ef8acb47b1be92da97a2d5cd4334bceed5b919/crates%2Fra_hir%2Fsrc%2Fnameres.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Fnameres.rs?ref=d8ef8acb47b1be92da97a2d5cd4334bceed5b919", "patch": "@@ -251,10 +251,14 @@ where\n             };\n         }\n         for (import_id, import_data) in input.imports.iter() {\n-            if let Some(segment) = import_data.path.segments.iter().last() {\n+            if let Some(last_segment) = import_data.path.segments.iter().last() {\n                 if !import_data.is_glob {\n+                    let name = import_data\n+                        .alias\n+                        .clone()\n+                        .unwrap_or_else(|| last_segment.name.clone());\n                     module_items.items.insert(\n-                        segment.name.clone(),\n+                        name,\n                         Resolution {\n                             def: PerNs::none(),\n                             import: Some(import_id),\n@@ -319,19 +323,18 @@ where\n \n         if reached_fixedpoint == ReachedFixedPoint::Yes {\n             let last_segment = import.path.segments.last().unwrap();\n+            let name = import\n+                .alias\n+                .clone()\n+                .unwrap_or_else(|| last_segment.name.clone());\n+            log::debug!(\"resolved import {:?} ({:?}) to {:?}\", name, import, def,);\n             self.update(module_id, |items| {\n                 let res = Resolution {\n                     def,\n                     import: Some(import_id),\n                 };\n-                items.items.insert(last_segment.name.clone(), res);\n+                items.items.insert(name, res);\n             });\n-            log::debug!(\n-                \"resolved import {:?} ({:?}) cross-source root to {:?}\",\n-                last_segment.name,\n-                import,\n-                def,\n-            );\n         }\n         reached_fixedpoint\n     }"}]}