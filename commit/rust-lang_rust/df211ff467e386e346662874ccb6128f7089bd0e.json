{"sha": "df211ff467e386e346662874ccb6128f7089bd0e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRmMjExZmY0NjdlMzg2ZTM0NjY2Mjg3NGNjYjYxMjhmNzA4OWJkMGU=", "commit": {"author": {"name": "Jeremy Stucki", "email": "jeremy@myelin.ch", "date": "2019-08-18T16:04:18Z"}, "committer": {"name": "Jeremy Stucki", "email": "jeremy@myelin.ch", "date": "2019-08-18T16:04:18Z"}, "message": "Ignore lines starting with '#'", "tree": {"sha": "2e6f1e405dd65c1cf80d97d60a66122c12acd132", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2e6f1e405dd65c1cf80d97d60a66122c12acd132"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/df211ff467e386e346662874ccb6128f7089bd0e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEENfZy0Nd1FLYaZCRY7vypMUgEJlUFAl1ZdwIACgkQ7vypMUgE\nJlXaihAAjzwI51Cf/x3/ohDHKm8dze3eJupGzwkkQtwOx6z+V2UHRg8Xcb4mRngr\nDckQwLr4VeDMxlkx+nYDm1vM54A0UjyExt2Yl5/z8cKet/07vK3wjlOXXmRLFbMt\n997xPtszG7r5kC6enJnnbIhSbiOG45EuCmDmSIDJDLBEXy6PawObSsdkx4Ou3Hye\ncqZxttMrT1UKR5v74ON6Mpy21Z3okw4yzhWCfboB0P/LhN1L8JitpLL3iTZN9Qy2\ns7yOl1KnGdmFU9Z3Kvl+II30nLWk6/s1psDm6V6NNDoTXTpcjlqt8RbKYIbQmPRx\nVumfGuFNMp8Fxypau3HhyBaZ0azP0jpj8zjgfjl/4I7+MDGpS0/re+vVRbwtufGB\n5lXpd9l7/7tWiDAA2thPPu5bn5vcHuo/+Llcy7vKlkAXHfxB1+o8XBeSINomvZWH\nthDLRzaiPuZyt4i5TuPuYHzZ+BGJjtqnXZiDqN+p1Oc5CdqFizh0qRib/Mqm2DyB\nYNLLBpNTjLsJBJVa5xXREu5cD/JTb5qm14nd1oubxXYrEHKybH1d/RQ3ymCX0uUj\nOVEo03hzE8tSq/vmaYyVTFhbtp4XKUbhz25CgJ+wqcMSQ1tj5iePEKvhQc3GogB1\nAsbDU4D61UnX9rgOMT1Usqn9C+j+/Z3PFPRZ5gmMUGIxzkmdlHM=\n=seKl\n-----END PGP SIGNATURE-----", "payload": "tree 2e6f1e405dd65c1cf80d97d60a66122c12acd132\nparent e92c48989f1c8a3356cde3829c88408da9d8c983\nauthor Jeremy Stucki <jeremy@myelin.ch> 1566144258 +0200\ncommitter Jeremy Stucki <jeremy@myelin.ch> 1566144258 +0200\n\nIgnore lines starting with '#'\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/df211ff467e386e346662874ccb6128f7089bd0e", "html_url": "https://github.com/rust-lang/rust/commit/df211ff467e386e346662874ccb6128f7089bd0e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/df211ff467e386e346662874ccb6128f7089bd0e/comments", "author": {"login": "jeremystucki", "id": 7629727, "node_id": "MDQ6VXNlcjc2Mjk3Mjc=", "avatar_url": "https://avatars.githubusercontent.com/u/7629727?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jeremystucki", "html_url": "https://github.com/jeremystucki", "followers_url": "https://api.github.com/users/jeremystucki/followers", "following_url": "https://api.github.com/users/jeremystucki/following{/other_user}", "gists_url": "https://api.github.com/users/jeremystucki/gists{/gist_id}", "starred_url": "https://api.github.com/users/jeremystucki/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jeremystucki/subscriptions", "organizations_url": "https://api.github.com/users/jeremystucki/orgs", "repos_url": "https://api.github.com/users/jeremystucki/repos", "events_url": "https://api.github.com/users/jeremystucki/events{/privacy}", "received_events_url": "https://api.github.com/users/jeremystucki/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jeremystucki", "id": 7629727, "node_id": "MDQ6VXNlcjc2Mjk3Mjc=", "avatar_url": "https://avatars.githubusercontent.com/u/7629727?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jeremystucki", "html_url": "https://github.com/jeremystucki", "followers_url": "https://api.github.com/users/jeremystucki/followers", "following_url": "https://api.github.com/users/jeremystucki/following{/other_user}", "gists_url": "https://api.github.com/users/jeremystucki/gists{/gist_id}", "starred_url": "https://api.github.com/users/jeremystucki/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jeremystucki/subscriptions", "organizations_url": "https://api.github.com/users/jeremystucki/orgs", "repos_url": "https://api.github.com/users/jeremystucki/repos", "events_url": "https://api.github.com/users/jeremystucki/events{/privacy}", "received_events_url": "https://api.github.com/users/jeremystucki/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e92c48989f1c8a3356cde3829c88408da9d8c983", "url": "https://api.github.com/repos/rust-lang/rust/commits/e92c48989f1c8a3356cde3829c88408da9d8c983", "html_url": "https://github.com/rust-lang/rust/commit/e92c48989f1c8a3356cde3829c88408da9d8c983"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "e8fc4d84ea4f3b878fc88fdf727c7694c9a30f31", "filename": "util/export.py", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/df211ff467e386e346662874ccb6128f7089bd0e/util%2Fexport.py", "raw_url": "https://github.com/rust-lang/rust/raw/df211ff467e386e346662874ccb6128f7089bd0e/util%2Fexport.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/util%2Fexport.py?ref=df211ff467e386e346662874ccb6128f7089bd0e", "patch": "@@ -10,13 +10,24 @@\n from lintlib import parse_all, log\n \n lint_subheadline = re.compile(r'''^\\*\\*([\\w\\s]+?)[:?.!]?\\*\\*(.*)''')\n+rust_code_block = re.compile(r'''```rust.+?```''', flags=re.DOTALL)\n \n CONF_TEMPLATE = \"\"\"\\\n This lint has the following configuration variables:\n \n * `%s: %s`: %s (defaults to `%s`).\"\"\"\n \n \n+def parse_code_block(match):\n+    lines = []\n+\n+    for line in match.group(0).split('\\n'):\n+        if not line.startswith('# '):\n+            lines.append(line)\n+\n+    return '\\n'.join(lines)\n+\n+\n def parse_lint_def(lint):\n     lint_dict = {}\n     lint_dict['id'] = lint.name\n@@ -44,7 +55,7 @@ def parse_lint_def(lint):\n         lint_dict['docs'][last_section] += text + \"\\n\"\n \n     for section in lint_dict['docs']:\n-        lint_dict['docs'][section] = lint_dict['docs'][section].strip()\n+        lint_dict['docs'][section] = re.sub(rust_code_block, parse_code_block, lint_dict['docs'][section].strip())\n \n     return lint_dict\n "}]}