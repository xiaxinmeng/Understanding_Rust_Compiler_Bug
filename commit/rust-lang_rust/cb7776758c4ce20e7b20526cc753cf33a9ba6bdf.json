{"sha": "cb7776758c4ce20e7b20526cc753cf33a9ba6bdf", "node_id": "C_kwDOAAsO6NoAKGNiNzc3Njc1OGM0Y2UyMGU3YjIwNTI2Y2M3NTNjZjMzYTliYTZiZGY", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2021-11-22T22:30:29Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-11-22T22:30:29Z"}, "message": "Rollup merge of #91102 - jsha:theme-anchor, r=GuillaumeGomez\n\nSet color for <a> in a more straightforward way.\n\nPreviously, we set the default color for <a> tags to black, and then had an override with a bunch of not() clauses to set anchors in\ndocblocks to blue.\n\nInstead, we should set the default color for <a> to blue (or equivalent in other themes), and override it for places like the sidebar or search results, where we don't want them to be styled as links.\n\nDemo at https://rustdoc.crud.net/jsha/theme-anchor/std/string/struct.String.html. This should result in no visible changes.\n\nr? `@GuillaumeGomez`", "tree": {"sha": "1edf962825a808486de00ef5a609a726d609ec56", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1edf962825a808486de00ef5a609a726d609ec56"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cb7776758c4ce20e7b20526cc753cf33a9ba6bdf", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhnBoFCRBK7hj4Ov3rIwAAa2oIAHAHW4UYaQYSerZK/i8GplRW\n0+9KyJ25KgsHgcEFt0qkLE5BmhBON34pPQl8eW9TTXZxbZaMKh1vXc8BeG0ofh1J\nnVtwQMe2ceo4WgUN4a7fJHgFJ+4zxYU9p+VrhsaOlHQ2s8u+XDZymOzBk1Kv8ETx\nm4kc9MusCntkB/9rgt5MnJgWwKHMy2tRKjLvLf/2nGVbCgqlZ2FmMl827YnmPy9G\nve46gLXXXBo+NQM7gQ3Q36meB96cAO5mI5UWahmwVq8yBazMn+h0dtBnPrKnZKtw\nQQAJufhAq2C75dDD1s+4usCrZemzFXpgYJ61QhapYrHBpfFZX9URtucCnnVb20g=\n=IYjO\n-----END PGP SIGNATURE-----\n", "payload": "tree 1edf962825a808486de00ef5a609a726d609ec56\nparent 936f2600b6c903b04387f74ed5cbce88bb06d243\nparent a56559df1346c44aa058f3a82785f20230a0468f\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1637620229 +0100\ncommitter GitHub <noreply@github.com> 1637620229 +0100\n\nRollup merge of #91102 - jsha:theme-anchor, r=GuillaumeGomez\n\nSet color for <a> in a more straightforward way.\n\nPreviously, we set the default color for <a> tags to black, and then had an override with a bunch of not() clauses to set anchors in\ndocblocks to blue.\n\nInstead, we should set the default color for <a> to blue (or equivalent in other themes), and override it for places like the sidebar or search results, where we don't want them to be styled as links.\n\nDemo at https://rustdoc.crud.net/jsha/theme-anchor/std/string/struct.String.html. This should result in no visible changes.\n\nr? `@GuillaumeGomez`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cb7776758c4ce20e7b20526cc753cf33a9ba6bdf", "html_url": "https://github.com/rust-lang/rust/commit/cb7776758c4ce20e7b20526cc753cf33a9ba6bdf", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cb7776758c4ce20e7b20526cc753cf33a9ba6bdf/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "936f2600b6c903b04387f74ed5cbce88bb06d243", "url": "https://api.github.com/repos/rust-lang/rust/commits/936f2600b6c903b04387f74ed5cbce88bb06d243", "html_url": "https://github.com/rust-lang/rust/commit/936f2600b6c903b04387f74ed5cbce88bb06d243"}, {"sha": "a56559df1346c44aa058f3a82785f20230a0468f", "url": "https://api.github.com/repos/rust-lang/rust/commits/a56559df1346c44aa058f3a82785f20230a0468f", "html_url": "https://github.com/rust-lang/rust/commit/a56559df1346c44aa058f3a82785f20230a0468f"}], "stats": {"total": 92, "additions": 60, "deletions": 32}, "files": [{"sha": "27f9c183b8e6fee701faf538e17eb7a341986f82", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cb7776758c4ce20e7b20526cc753cf33a9ba6bdf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/cb7776758c4ce20e7b20526cc753cf33a9ba6bdf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=cb7776758c4ce20e7b20526cc753cf33a9ba6bdf", "patch": "@@ -1078,10 +1078,6 @@ a.test-arrow:hover{\n \ttext-decoration: none;\n }\n \n-.section-header a {\n-\tcolor: inherit;\n-}\n-\n .code-attribute {\n \tfont-weight: 300;\n }"}, {"sha": "85fb34b39595cfade58fc7e04caf26dd092d48b6", "filename": "src/librustdoc/html/static/css/themes/ayu.css", "status": "modified", "additions": 11, "deletions": 6, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/cb7776758c4ce20e7b20526cc753cf33a9ba6bdf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "raw_url": "https://github.com/rust-lang/rust/raw/cb7776758c4ce20e7b20526cc753cf33a9ba6bdf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css?ref=cb7776758c4ce20e7b20526cc753cf33a9ba6bdf", "patch": "@@ -214,18 +214,23 @@ nav.main .separator {\n \tborder: 1px solid #5c6773;\n }\n a {\n+\tcolor: #39AFD7;\n+}\n+a.srclink,\n+a#toggle-all-docs,\n+#source-sidebar a,\n+pre.rust a,\n+.sidebar a,\n+.in-band a {\n \tcolor: #c5c5c5;\n }\n+.search-results a {\n+\tcolor: #0096cf;\n+}\n body.source .example-wrap pre.rust a {\n \tbackground: #333;\n }\n \n-.docblock:not(.item-decl) a:not(.srclink):not(.test-arrow),\n-.docblock-short a:not(.srclink):not(.test-arrow), .item-info a,\n-#help a {\n-\tcolor: #39AFD7;\n-}\n-\n details.rustdoc-toggle > summary.hideme > span,\n details.rustdoc-toggle > summary::before,\n details.undocumented > summary::before {"}, {"sha": "5a6c08bafd24062939ae1cc4507ef89d9a901796", "filename": "src/librustdoc/html/static/css/themes/dark.css", "status": "modified", "additions": 14, "deletions": 9, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/cb7776758c4ce20e7b20526cc753cf33a9ba6bdf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/cb7776758c4ce20e7b20526cc753cf33a9ba6bdf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css?ref=cb7776758c4ce20e7b20526cc753cf33a9ba6bdf", "patch": "@@ -174,22 +174,27 @@ nav.main .current {\n nav.main .separator {\n \tborder-color: #eee;\n }\n+\n a {\n-\tcolor: #ddd;\n+\tcolor: #D2991D;\n }\n-body.source .example-wrap pre.rust a {\n-\tbackground: #333;\n+a.srclink,\n+a#toggle-all-docs,\n+#source-sidebar a,\n+pre.rust a,\n+.sidebar a,\n+.in-band a {\n+\tcolor: #ddd;\n }\n-\n-.docblock:not(.item-decl) a:not(.srclink):not(.test-arrow),\n-.docblock-short a:not(.srclink):not(.test-arrow), .item-info a,\n-#help a {\n-\tcolor: #D2991D;\n+.search-results a {\n+\tcolor: #ddd;\n }\n-\n a.test-arrow {\n \tcolor: #dedede;\n }\n+body.source .example-wrap pre.rust a {\n+\tbackground: #333;\n+}\n \n details.rustdoc-toggle > summary.hideme > span,\n details.rustdoc-toggle > summary::before,"}, {"sha": "05f12fc365d74855adaf7e3b60d8b7956a57e306", "filename": "src/librustdoc/html/static/css/themes/light.css", "status": "modified", "additions": 14, "deletions": 9, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/cb7776758c4ce20e7b20526cc753cf33a9ba6bdf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "raw_url": "https://github.com/rust-lang/rust/raw/cb7776758c4ce20e7b20526cc753cf33a9ba6bdf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css?ref=cb7776758c4ce20e7b20526cc753cf33a9ba6bdf", "patch": "@@ -169,22 +169,27 @@ nav.main .current {\n nav.main .separator {\n \tborder: 1px solid #000;\n }\n+\n a {\n-\tcolor: #000;\n+\tcolor: #3873AD;\n }\n-body.source .example-wrap pre.rust a {\n-\tbackground: #eee;\n+a.srclink,\n+a#toggle-all-docs,\n+#source-sidebar a,\n+pre.rust a,\n+.sidebar a,\n+.in-band a {\n+\tcolor: #000;\n }\n-\n-.docblock:not(.item-decl) a:not(.srclink):not(.test-arrow),\n-.docblock-short a:not(.srclink):not(.test-arrow), .item-info a,\n-#help a {\n-\tcolor: #3873AD;\n+.search-results a {\n+\tcolor: initial;\n }\n-\n a.test-arrow {\n \tcolor: #f5f5f5;\n }\n+body.source .example-wrap pre.rust a {\n+\tbackground: #eee;\n+}\n \n details.rustdoc-toggle > summary.hideme > span,\n details.rustdoc-toggle > summary::before,"}, {"sha": "6953009604c5e6490cda7f3a17e69d906f31f5da", "filename": "src/test/rustdoc-gui/anchors.goml", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/cb7776758c4ce20e7b20526cc753cf33a9ba6bdf/src%2Ftest%2Frustdoc-gui%2Fanchors.goml", "raw_url": "https://github.com/rust-lang/rust/raw/cb7776758c4ce20e7b20526cc753cf33a9ba6bdf/src%2Ftest%2Frustdoc-gui%2Fanchors.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fanchors.goml?ref=cb7776758c4ce20e7b20526cc753cf33a9ba6bdf", "patch": "@@ -0,0 +1,17 @@\n+goto: file://|DOC_PATH|/test_docs/struct.HeavilyDocumentedStruct.html\n+\n+// Set the theme to light.\n+local-storage: {\"rustdoc-theme\": \"light\", \"rustdoc-use-system-theme\": \"false\"}\n+// We reload the page so the local storage settings are being used.\n+reload:\n+\n+assert-css: (\"#toggle-all-docs\", {\"color\": \"rgba(0, 0, 0, 0)\"})\n+assert-css: (\".fqn .in-band a:nth-of-type(1)\", {\"color\": \"rgba(0, 0, 0, 0)\"})\n+assert-css: (\".fqn .in-band a:nth-of-type(2)\", {\"color\": \"rgba(0, 0, 0, 0)\"})\n+assert-css: (\".srclink\", {\"color\": \"rgba(0, 0, 0, 0)\"})\n+assert-css: (\".srclink\", {\"color\": \"rgba(0, 0, 0, 0)\"})\n+\n+assert-css: (\"#top-doc-prose-title\", {\"color\": \"rgba(0, 0, 0, 0)\"})\n+\n+assert-css: (\".sidebar a\", {\"color\": \"rgba(0, 0, 0, 0)\"})\n+assert-css: (\".in-band a\", {\"color\": \"rgba(0, 0, 0, 0)\"})"}, {"sha": "0d6a2605d4f2aabb09a0f76635c6d918de5569ec", "filename": "src/tools/rustdoc-gui/tester.js", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/cb7776758c4ce20e7b20526cc753cf33a9ba6bdf/src%2Ftools%2Frustdoc-gui%2Ftester.js", "raw_url": "https://github.com/rust-lang/rust/raw/cb7776758c4ce20e7b20526cc753cf33a9ba6bdf/src%2Ftools%2Frustdoc-gui%2Ftester.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustdoc-gui%2Ftester.js?ref=cb7776758c4ce20e7b20526cc753cf33a9ba6bdf", "patch": "@@ -194,7 +194,7 @@ async function main(argv) {\n             .then(out => {\n                 const [output, nb_failures] = out;\n                 results[nb_failures === 0 ? \"successful\" : \"failed\"].push({\n-                    file_name: file_name,\n+                    file_name: testPath,\n                     output: output,\n                 });\n                 if (nb_failures > 0) {\n@@ -206,7 +206,7 @@ async function main(argv) {\n             })\n             .catch(err => {\n                 results.errored.push({\n-                    file_name: file_name,\n+                    file_name: testPath + file_name,\n                     output: err,\n                 });\n                 status_bar.erroneous();\n@@ -239,15 +239,15 @@ async function main(argv) {\n         console.log(\"\");\n         results.failed.sort(by_filename);\n         results.failed.forEach(r => {\n-            console.log(r.output);\n+            console.log(r.file_name, r.output);\n         });\n     }\n     if (results.errored.length > 0) {\n         console.log(os.EOL);\n         // print run errors on the bottom so developers see them better\n         results.errored.sort(by_filename);\n         results.errored.forEach(r => {\n-            console.error(r.output);\n+            console.error(r.file_name, r.output);\n         });\n     }\n "}]}