{"sha": "713578b82791523afa62803f02a9fc7eef2c3368", "node_id": "C_kwDOAAsO6NoAKDcxMzU3OGI4Mjc5MTUyM2FmYTYyODAzZjAyYTlmYzdlZWYyYzMzNjg", "commit": {"author": {"name": "Sprite", "email": "SpriteOvO@gmail.com", "date": "2022-06-14T19:34:00Z"}, "committer": {"name": "Sprite", "email": "SpriteOvO@gmail.com", "date": "2022-06-15T17:11:29Z"}, "message": "Exclude cfg \"doc\" and \"doctest\" from feature `doc_auto_cfg`", "tree": {"sha": "476c41a914e0e7b589a1befa972a9a833305f396", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/476c41a914e0e7b589a1befa972a9a833305f396"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/713578b82791523afa62803f02a9fc7eef2c3368", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/713578b82791523afa62803f02a9fc7eef2c3368", "html_url": "https://github.com/rust-lang/rust/commit/713578b82791523afa62803f02a9fc7eef2c3368", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/713578b82791523afa62803f02a9fc7eef2c3368/comments", "author": {"login": "SpriteOvO", "id": 33660554, "node_id": "MDQ6VXNlcjMzNjYwNTU0", "avatar_url": "https://avatars.githubusercontent.com/u/33660554?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SpriteOvO", "html_url": "https://github.com/SpriteOvO", "followers_url": "https://api.github.com/users/SpriteOvO/followers", "following_url": "https://api.github.com/users/SpriteOvO/following{/other_user}", "gists_url": "https://api.github.com/users/SpriteOvO/gists{/gist_id}", "starred_url": "https://api.github.com/users/SpriteOvO/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SpriteOvO/subscriptions", "organizations_url": "https://api.github.com/users/SpriteOvO/orgs", "repos_url": "https://api.github.com/users/SpriteOvO/repos", "events_url": "https://api.github.com/users/SpriteOvO/events{/privacy}", "received_events_url": "https://api.github.com/users/SpriteOvO/received_events", "type": "User", "site_admin": false}, "committer": {"login": "SpriteOvO", "id": 33660554, "node_id": "MDQ6VXNlcjMzNjYwNTU0", "avatar_url": "https://avatars.githubusercontent.com/u/33660554?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SpriteOvO", "html_url": "https://github.com/SpriteOvO", "followers_url": "https://api.github.com/users/SpriteOvO/followers", "following_url": "https://api.github.com/users/SpriteOvO/following{/other_user}", "gists_url": "https://api.github.com/users/SpriteOvO/gists{/gist_id}", "starred_url": "https://api.github.com/users/SpriteOvO/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SpriteOvO/subscriptions", "organizations_url": "https://api.github.com/users/SpriteOvO/orgs", "repos_url": "https://api.github.com/users/SpriteOvO/repos", "events_url": "https://api.github.com/users/SpriteOvO/events{/privacy}", "received_events_url": "https://api.github.com/users/SpriteOvO/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9aa1ccdae85b9d5b1575f7a2e48cf31196462e0f", "url": "https://api.github.com/repos/rust-lang/rust/commits/9aa1ccdae85b9d5b1575f7a2e48cf31196462e0f", "html_url": "https://github.com/rust-lang/rust/commit/9aa1ccdae85b9d5b1575f7a2e48cf31196462e0f"}], "stats": {"total": 30, "additions": 19, "deletions": 11}, "files": [{"sha": "ac934f6925d0bd24082fb1cd688ee6d15d43ad2c", "filename": "src/librustdoc/visit_ast.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/713578b82791523afa62803f02a9fc7eef2c3368/src%2Flibrustdoc%2Fvisit_ast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/713578b82791523afa62803f02a9fc7eef2c3368/src%2Flibrustdoc%2Fvisit_ast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fvisit_ast.rs?ref=713578b82791523afa62803f02a9fc7eef2c3368", "patch": "@@ -141,7 +141,10 @@ impl<'a, 'tcx> RustdocVisitor<'a, 'tcx> {\n                     })\n                     .collect::<Vec<_>>()\n             })\n-            .chain([Cfg::Cfg(sym::test, None)].into_iter())\n+            .chain(\n+                [Cfg::Cfg(sym::test, None), Cfg::Cfg(sym::doc, None), Cfg::Cfg(sym::doctest, None)]\n+                    .into_iter(),\n+            )\n             .collect();\n \n         self.cx.cache.exact_paths = self.exact_paths;"}, {"sha": "7842ee69c9f67241a99623cf7bbd752b6c40fa60", "filename": "src/test/rustdoc/doc-auto-cfg.rs", "status": "modified", "additions": 15, "deletions": 10, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/713578b82791523afa62803f02a9fc7eef2c3368/src%2Ftest%2Frustdoc%2Fdoc-auto-cfg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/713578b82791523afa62803f02a9fc7eef2c3368/src%2Ftest%2Frustdoc%2Fdoc-auto-cfg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fdoc-auto-cfg.rs?ref=713578b82791523afa62803f02a9fc7eef2c3368", "patch": "@@ -2,29 +2,34 @@\n #![crate_name = \"foo\"]\n \n // @has foo/fn.foo.html\n-// @has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'non-doctest'\n-#[cfg(not(doctest))]\n+// @has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'non-meowmeow'\n+#[cfg(not(meowmeow))]\n pub fn foo() {}\n \n // @has foo/fn.bar.html\n-// @has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'doc'\n+// @has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'meowmeow'\n // @!has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'test'\n-#[cfg(any(test, doc))]\n+// @!has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'doc'\n+// @!has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'doctest'\n+#[cfg(any(meowmeow, test, doc, doctest))]\n pub fn bar() {}\n \n // @has foo/fn.appear_1.html\n-// @has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'doc'\n+// @has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'meowmeow'\n+// @!has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'doc'\n // @!has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'non-test'\n-#[cfg(any(doc, not(test)))]\n+#[cfg(any(meowmeow, doc, not(test)))]\n pub fn appear_1() {} // issue #98065\n \n // @has foo/fn.appear_2.html\n-// @has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'doc'\n+// @has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'meowmeow'\n+// @!has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'doc'\n // @!has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'test'\n-#[cfg(any(doc, all(test)))]\n+#[cfg(any(meowmeow, doc, all(test)))]\n pub fn appear_2() {} // issue #98065\n \n // @has foo/fn.appear_3.html\n-// @has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'doc'\n-#[cfg(any(doc, all()))]\n+// @has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'meowmeow'\n+// @!has - '//*[@class=\"item-info\"]/*[@class=\"stab portability\"]' 'doc'\n+#[cfg(any(meowmeow, doc, all()))]\n pub fn appear_3() {} // issue #98065"}]}