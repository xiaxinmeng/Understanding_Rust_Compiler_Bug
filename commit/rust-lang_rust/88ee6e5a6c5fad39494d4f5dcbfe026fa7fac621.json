{"sha": "88ee6e5a6c5fad39494d4f5dcbfe026fa7fac621", "node_id": "C_kwDOAAsO6NoAKDg4ZWU2ZTVhNmM1ZmFkMzk0OTRkNGY1ZGNiZmUwMjZmYTdmYWM2MjE", "commit": {"author": {"name": "Joshua Nelson", "email": "github@jyn.dev", "date": "2023-04-09T14:11:00Z"}, "committer": {"name": "jyn", "email": "github@jyn.dev", "date": "2023-04-14T03:10:26Z"}, "message": "Fix tests on wasm\n\nThe `std` test straightforwardly can't work without file descriptors;\n #99417 tracks moving it out of tests/ui.\n\n`issue-13560.rs` requires the target to support dynamic linking.\n\n`extern-mod-syntax` is interesting. The original test was added to check\nif `extern mod` could be parsed correctly and used `extern mod std` and\nan import:\nhttps://github.com/rust-lang/rust/commit/138dc3048af36f0a20f857542c357fe8df563013#diff-73700e1e851b7a37bc92174635dab726124c82e5bfabbbc45b4a3c2e8e14fadd\nAt some point `std::json::Object` was moved out of std to an unstable\nrustc-only `extras` crate, and rather than just changing the import it\ngot changed to use the unstable crate. When `extras` was removed, people\nassumed the test was meant to also test rustc_private and changed it to\nanother unstable crate rather than using something in std.\n\nThis changes the test to remove the `rustc_private` import, to allow it\nto work properly when cross-compiling.", "tree": {"sha": "10b8215a12a2dfca9a60ed3292acda829518448a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/10b8215a12a2dfca9a60ed3292acda829518448a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/88ee6e5a6c5fad39494d4f5dcbfe026fa7fac621", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/88ee6e5a6c5fad39494d4f5dcbfe026fa7fac621", "html_url": "https://github.com/rust-lang/rust/commit/88ee6e5a6c5fad39494d4f5dcbfe026fa7fac621", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/88ee6e5a6c5fad39494d4f5dcbfe026fa7fac621/comments", "author": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2ffb0de8cfda57cafdfd71a690f14c2e17216d85", "url": "https://api.github.com/repos/rust-lang/rust/commits/2ffb0de8cfda57cafdfd71a690f14c2e17216d85", "html_url": "https://github.com/rust-lang/rust/commit/2ffb0de8cfda57cafdfd71a690f14c2e17216d85"}], "stats": {"total": 10, "additions": 6, "deletions": 4}, "files": [{"sha": "65dfa6a0f579034c16d30c307ebe7f8c68cf3309", "filename": "tests/ui/extern-mod-syntax.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/88ee6e5a6c5fad39494d4f5dcbfe026fa7fac621/tests%2Fui%2Fextern-mod-syntax.rs", "raw_url": "https://github.com/rust-lang/rust/raw/88ee6e5a6c5fad39494d4f5dcbfe026fa7fac621/tests%2Fui%2Fextern-mod-syntax.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fextern-mod-syntax.rs?ref=88ee6e5a6c5fad39494d4f5dcbfe026fa7fac621", "patch": "@@ -1,11 +1,11 @@\n // run-pass\n \n #![allow(unused_imports)]\n-#![feature(rustc_private)]\n+#![no_std]\n \n-extern crate libc;\n-use libc::c_void;\n+extern crate std;\n+use std::ffi::c_void;\n \n pub fn main() {\n-    println!(\"Hello world!\");\n+    std::println!(\"Hello world!\");\n }"}, {"sha": "3397202bef2fda2c054b45c5fc95a3d05ac7a873", "filename": "tests/ui/issue-13560.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/88ee6e5a6c5fad39494d4f5dcbfe026fa7fac621/tests%2Fui%2Fissue-13560.rs", "raw_url": "https://github.com/rust-lang/rust/raw/88ee6e5a6c5fad39494d4f5dcbfe026fa7fac621/tests%2Fui%2Fissue-13560.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fissue-13560.rs?ref=88ee6e5a6c5fad39494d4f5dcbfe026fa7fac621", "patch": "@@ -1,4 +1,5 @@\n // run-pass\n+// ignore-cross-compile (needs dylibs and compiletest doesn't have a more specific header)\n // aux-build:issue-13560-1.rs\n // aux-build:issue-13560-2.rs\n // aux-build:issue-13560-3.rs"}, {"sha": "2d936d96b0596243a3d07f807c57a74af455998d", "filename": "tests/ui/std/switch-stdout.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/88ee6e5a6c5fad39494d4f5dcbfe026fa7fac621/tests%2Fui%2Fstd%2Fswitch-stdout.rs", "raw_url": "https://github.com/rust-lang/rust/raw/88ee6e5a6c5fad39494d4f5dcbfe026fa7fac621/tests%2Fui%2Fstd%2Fswitch-stdout.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fstd%2Fswitch-stdout.rs?ref=88ee6e5a6c5fad39494d4f5dcbfe026fa7fac621", "patch": "@@ -1,4 +1,5 @@\n // run-pass\n+// ignore-wasm (needs file descriptors and env variables)\n \n use std::env;\n use std::fs::File;"}]}