{"sha": "c02baba1dcd9847d07762f42412d10eed7cff3e9", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMwMmJhYmExZGNkOTg0N2QwNzc2MmY0MjQxMmQxMGVlZDdjZmYzZTk=", "commit": {"author": {"name": "Jason Newcomb", "email": "jsnewcomb@pm.me", "date": "2021-04-02T23:04:45Z"}, "committer": {"name": "Jason Newcomb", "email": "jsnewcomb@pm.me", "date": "2021-04-16T00:37:20Z"}, "message": "`redundant_pattern_matching` fix inverted boolean when missing `Drop` trait\r\r# Please enter the commit message for your changes. Lines starting\r# with '#' will be ignored, and an empty message aborts the commit.\r#\r# Date:      Fri Apr 2 19:04:45 2021 -0400\r#\r# On branch redundant_pattern_matching\r# Your branch is ahead of 'origin/redundant_pattern_matching' by 1 commit.\r#   (use \"git push\" to publish your local commits)\r#\r# Changes to be committed:\r#\tmodified:   clippy_lints/src/matches.rs\r#\r\r# Please enter the commit message for your changes. Lines starting\r# with '#' will be ignored, and an empty message aborts the commit.\r#\r# Date:      Fri Apr 2 19:04:45 2021 -0400\r#\r# interactive rebase in progress; onto ebc64690d\r# Last commands done (6 commands done):\r#    pick 25d211ad8 Code cleanup and additional std types checked\r#    r 0c71ce56f `redundant_pattern_matching` fix inverted boolean when missing `Drop` trait\r# No commands remaining.\r# You are currently editing a commit while rebasing branch 'redundant_pattern_matching' on 'ebc64690d'.\r#\r# Changes to be committed:\r#\tmodified:   clippy_lints/src/matches.rs\r#", "tree": {"sha": "67f1dcfdb65d9cf3d14f575bbf408feca3d194e7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/67f1dcfdb65d9cf3d14f575bbf408feca3d194e7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c02baba1dcd9847d07762f42412d10eed7cff3e9", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\nComment: Created with Krypton\n\niF4EABYKAAYFAmB43EQACgkQ2lnoZDo37QbB6wEAkMi28EHt15c6iilKvGvinehA\nEBkIdvMOgxSVOnSKlKwBAOjTzp02FW8pDSvg4n9W+/TkBYNQI+xfeEVLFlAh54UE\n=zUBY\n-----END PGP SIGNATURE-----", "payload": "tree 67f1dcfdb65d9cf3d14f575bbf408feca3d194e7\nparent b6581636bd9cfb16337a9ffcecd1b38e68a6abce\nauthor Jason Newcomb <jsnewcomb@pm.me> 1617404685 -0400\ncommitter Jason Newcomb <jsnewcomb@pm.me> 1618533440 -0400\n\n`redundant_pattern_matching` fix inverted boolean when missing `Drop` trait\r\r# Please enter the commit message for your changes. Lines starting\r# with '#' will be ignored, and an empty message aborts the commit.\r#\r# Date:      Fri Apr 2 19:04:45 2021 -0400\r#\r# On branch redundant_pattern_matching\r# Your branch is ahead of 'origin/redundant_pattern_matching' by 1 commit.\r#   (use \"git push\" to publish your local commits)\r#\r# Changes to be committed:\r#\tmodified:   clippy_lints/src/matches.rs\r#\r\r# Please enter the commit message for your changes. Lines starting\r# with '#' will be ignored, and an empty message aborts the commit.\r#\r# Date:      Fri Apr 2 19:04:45 2021 -0400\r#\r# interactive rebase in progress; onto ebc64690d\r# Last commands done (6 commands done):\r#    pick 25d211ad8 Code cleanup and additional std types checked\r#    r 0c71ce56f `redundant_pattern_matching` fix inverted boolean when missing `Drop` trait\r# No commands remaining.\r# You are currently editing a commit while rebasing branch 'redundant_pattern_matching' on 'ebc64690d'.\r#\r# Changes to be committed:\r#\tmodified:   clippy_lints/src/matches.rs\r#\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c02baba1dcd9847d07762f42412d10eed7cff3e9", "html_url": "https://github.com/rust-lang/rust/commit/c02baba1dcd9847d07762f42412d10eed7cff3e9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c02baba1dcd9847d07762f42412d10eed7cff3e9/comments", "author": {"login": "Jarcho", "id": 7761774, "node_id": "MDQ6VXNlcjc3NjE3NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/7761774?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jarcho", "html_url": "https://github.com/Jarcho", "followers_url": "https://api.github.com/users/Jarcho/followers", "following_url": "https://api.github.com/users/Jarcho/following{/other_user}", "gists_url": "https://api.github.com/users/Jarcho/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jarcho/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jarcho/subscriptions", "organizations_url": "https://api.github.com/users/Jarcho/orgs", "repos_url": "https://api.github.com/users/Jarcho/repos", "events_url": "https://api.github.com/users/Jarcho/events{/privacy}", "received_events_url": "https://api.github.com/users/Jarcho/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Jarcho", "id": 7761774, "node_id": "MDQ6VXNlcjc3NjE3NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/7761774?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jarcho", "html_url": "https://github.com/Jarcho", "followers_url": "https://api.github.com/users/Jarcho/followers", "following_url": "https://api.github.com/users/Jarcho/following{/other_user}", "gists_url": "https://api.github.com/users/Jarcho/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jarcho/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jarcho/subscriptions", "organizations_url": "https://api.github.com/users/Jarcho/orgs", "repos_url": "https://api.github.com/users/Jarcho/repos", "events_url": "https://api.github.com/users/Jarcho/events{/privacy}", "received_events_url": "https://api.github.com/users/Jarcho/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b6581636bd9cfb16337a9ffcecd1b38e68a6abce", "url": "https://api.github.com/repos/rust-lang/rust/commits/b6581636bd9cfb16337a9ffcecd1b38e68a6abce", "html_url": "https://github.com/rust-lang/rust/commit/b6581636bd9cfb16337a9ffcecd1b38e68a6abce"}], "stats": {"total": 8, "additions": 5, "deletions": 3}, "files": [{"sha": "ddfc27e84605070eba088f3242c6d8704ba18180", "filename": "clippy_lints/src/matches.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/c02baba1dcd9847d07762f42412d10eed7cff3e9/clippy_lints%2Fsrc%2Fmatches.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c02baba1dcd9847d07762f42412d10eed7cff3e9/clippy_lints%2Fsrc%2Fmatches.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fmatches.rs?ref=c02baba1dcd9847d07762f42412d10eed7cff3e9", "patch": "@@ -1733,15 +1733,17 @@ mod redundant_pattern_match {\n         }\n     }\n \n-    // Check if the drop order for a type matters\n+    /// Checks if the drop order for a type matters. Some std types implement drop solely to\n+    /// deallocate memory. For these types, and composites containing them, changing the drop order\n+    /// won't result in any observable side effects.\n     fn type_needs_ordered_drop(cx: &LateContext<'tcx>, ty: Ty<'tcx>) -> bool {\n         if !ty.needs_drop(cx.tcx, cx.param_env) {\n             false\n-        } else if cx\n+        } else if !cx\n             .tcx\n             .lang_items()\n             .drop_trait()\n-            .map_or(false, |id| !implements_trait(cx, ty, id, &[]))\n+            .map_or(false, |id| implements_trait(cx, ty, id, &[]))\n         {\n             // This type doesn't implement drop, so no side effects here.\n             // Check if any component type has any."}]}