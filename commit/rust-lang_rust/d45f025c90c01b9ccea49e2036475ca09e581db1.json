{"sha": "d45f025c90c01b9ccea49e2036475ca09e581db1", "node_id": "C_kwDOAAsO6NoAKGQ0NWYwMjVjOTBjMDFiOWNjZWE0OWUyMDM2NDc1Y2EwOWU1ODFkYjE", "commit": {"author": {"name": "nils", "email": "48135649+Nilstrieb@users.noreply.github.com", "date": "2022-10-18T20:13:26Z"}, "committer": {"name": "nils", "email": "48135649+Nilstrieb@users.noreply.github.com", "date": "2022-10-19T10:50:28Z"}, "message": "Use Set instead of Vec in transitive_relation", "tree": {"sha": "3b0a188b197c9e44906af0868a3deeb0e4d860f0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3b0a188b197c9e44906af0868a3deeb0e4d860f0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d45f025c90c01b9ccea49e2036475ca09e581db1", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN SSH SIGNATURE-----\nU1NIU0lHAAAAAQAAADMAAAALc3NoLWVkMjU1MTkAAAAgWnoWpkMvJlSFxMiZfPmQ9OBZ0B\nzicY1KArCIU18CM8IAAAADZ2l0AAAAAAAAAAZzaGE1MTIAAABTAAAAC3NzaC1lZDI1NTE5\nAAAAQOJMaRYbcnpoH28jHEUTjWFhC2jUdhsBrjzUgZy8oa6mim1vsbUCQSYeEFx4TxGVnp\niBGvgCkqB/fFeCm9J9UQg=\n-----END SSH SIGNATURE-----", "payload": "tree 3b0a188b197c9e44906af0868a3deeb0e4d860f0\nparent a9d1cafa878ecc04a4aa7aaa7df0414a29a2bd0b\nauthor nils <48135649+Nilstrieb@users.noreply.github.com> 1666124006 +0200\ncommitter nils <48135649+Nilstrieb@users.noreply.github.com> 1666176628 +0200\n\nUse Set instead of Vec in transitive_relation\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d45f025c90c01b9ccea49e2036475ca09e581db1", "html_url": "https://github.com/rust-lang/rust/commit/d45f025c90c01b9ccea49e2036475ca09e581db1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d45f025c90c01b9ccea49e2036475ca09e581db1/comments", "author": {"login": "Nilstrieb", "id": 48135649, "node_id": "MDQ6VXNlcjQ4MTM1NjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/48135649?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nilstrieb", "html_url": "https://github.com/Nilstrieb", "followers_url": "https://api.github.com/users/Nilstrieb/followers", "following_url": "https://api.github.com/users/Nilstrieb/following{/other_user}", "gists_url": "https://api.github.com/users/Nilstrieb/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nilstrieb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nilstrieb/subscriptions", "organizations_url": "https://api.github.com/users/Nilstrieb/orgs", "repos_url": "https://api.github.com/users/Nilstrieb/repos", "events_url": "https://api.github.com/users/Nilstrieb/events{/privacy}", "received_events_url": "https://api.github.com/users/Nilstrieb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Nilstrieb", "id": 48135649, "node_id": "MDQ6VXNlcjQ4MTM1NjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/48135649?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nilstrieb", "html_url": "https://github.com/Nilstrieb", "followers_url": "https://api.github.com/users/Nilstrieb/followers", "following_url": "https://api.github.com/users/Nilstrieb/following{/other_user}", "gists_url": "https://api.github.com/users/Nilstrieb/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nilstrieb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nilstrieb/subscriptions", "organizations_url": "https://api.github.com/users/Nilstrieb/orgs", "repos_url": "https://api.github.com/users/Nilstrieb/repos", "events_url": "https://api.github.com/users/Nilstrieb/events{/privacy}", "received_events_url": "https://api.github.com/users/Nilstrieb/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a9d1cafa878ecc04a4aa7aaa7df0414a29a2bd0b", "url": "https://api.github.com/repos/rust-lang/rust/commits/a9d1cafa878ecc04a4aa7aaa7df0414a29a2bd0b", "html_url": "https://github.com/rust-lang/rust/commit/a9d1cafa878ecc04a4aa7aaa7df0414a29a2bd0b"}], "stats": {"total": 12, "additions": 5, "deletions": 7}, "files": [{"sha": "cf616203842a69d6a613704ad7c968b11d02e405", "filename": "compiler/rustc_data_structures/src/transitive_relation.rs", "status": "modified", "additions": 5, "deletions": 7, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/d45f025c90c01b9ccea49e2036475ca09e581db1/compiler%2Frustc_data_structures%2Fsrc%2Ftransitive_relation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d45f025c90c01b9ccea49e2036475ca09e581db1/compiler%2Frustc_data_structures%2Fsrc%2Ftransitive_relation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_data_structures%2Fsrc%2Ftransitive_relation.rs?ref=d45f025c90c01b9ccea49e2036475ca09e581db1", "patch": "@@ -1,5 +1,5 @@\n use crate::frozen::Frozen;\n-use crate::fx::FxIndexSet;\n+use crate::fx::{FxHashSet, FxIndexSet};\n use rustc_index::bit_set::BitMatrix;\n use std::fmt::Debug;\n use std::hash::Hash;\n@@ -16,7 +16,7 @@ pub struct TransitiveRelationBuilder<T> {\n \n     // List of base edges in the graph. Require to compute transitive\n     // closure.\n-    edges: Vec<Edge>,\n+    edges: FxHashSet<Edge>,\n }\n \n #[derive(Debug)]\n@@ -52,10 +52,10 @@ impl<T: Eq + Hash> Default for TransitiveRelationBuilder<T> {\n     }\n }\n \n-#[derive(Copy, Clone, PartialEq, Eq, PartialOrd, Debug)]\n+#[derive(Copy, Clone, PartialEq, Eq, PartialOrd, Debug, Hash)]\n struct Index(usize);\n \n-#[derive(Clone, PartialEq, Eq, Debug)]\n+#[derive(Clone, PartialEq, Eq, Debug, Hash)]\n struct Edge {\n     source: Index,\n     target: Index,\n@@ -99,9 +99,7 @@ impl<T: Eq + Hash + Copy> TransitiveRelationBuilder<T> {\n         let a = self.add_index(a);\n         let b = self.add_index(b);\n         let edge = Edge { source: a, target: b };\n-        if !self.edges.contains(&edge) {\n-            self.edges.push(edge);\n-        }\n+        self.edges.insert(edge);\n     }\n \n     /// Compute the transitive closure derived from the edges, and converted to"}]}