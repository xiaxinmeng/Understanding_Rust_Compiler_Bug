{"sha": "f93a62b68def853ee86dec4e27fbc4068c25dd32", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY5M2E2MmI2OGRlZjg1M2VlODZkZWM0ZTI3ZmJjNDA2OGMyNWRkMzI=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2016-02-21T19:24:02Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2016-02-21T19:24:02Z"}, "message": "Auto merge of #31792 - Zoxc:sysroot, r=alexcrichton\n\nWith these changes you can build a freestanding sysroot without using floating points using a Cargo.toml and copying the `deps` folder cargo outputs.\n```\n[package]\nname = \"sysroot\"\nversion = \"0.1.0\"\n\n[lib]\npath = \"lib.rs\"\ncrate-type = [\"rlib\"]\n\n[dependencies.core]\npath = \"../vendor/rust/src/src/libcore\"\nfeatures = [\"disable_float\"]\n\n[dependencies]\ncollections = { path = \"../vendor/rust/src/src/libcollections\" }\n```", "tree": {"sha": "73353fafc4c299a0846dda3672dbddd090464a3e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/73353fafc4c299a0846dda3672dbddd090464a3e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f93a62b68def853ee86dec4e27fbc4068c25dd32", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f93a62b68def853ee86dec4e27fbc4068c25dd32", "html_url": "https://github.com/rust-lang/rust/commit/f93a62b68def853ee86dec4e27fbc4068c25dd32", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f93a62b68def853ee86dec4e27fbc4068c25dd32/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0f62d219fbc02fc39f2fc4222d58ffb875c4900f", "url": "https://api.github.com/repos/rust-lang/rust/commits/0f62d219fbc02fc39f2fc4222d58ffb875c4900f", "html_url": "https://github.com/rust-lang/rust/commit/0f62d219fbc02fc39f2fc4222d58ffb875c4900f"}, {"sha": "8ade08041294446fd44978a9a068cb3b30ca4001", "url": "https://api.github.com/repos/rust-lang/rust/commits/8ade08041294446fd44978a9a068cb3b30ca4001", "html_url": "https://github.com/rust-lang/rust/commit/8ade08041294446fd44978a9a068cb3b30ca4001"}], "stats": {"total": 16, "additions": 7, "deletions": 9}, "files": [{"sha": "5da0f1a10b9775836c6d4aaea2ccacdbcf912f2d", "filename": "src/liballoc/Cargo.toml", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f93a62b68def853ee86dec4e27fbc4068c25dd32/src%2Fliballoc%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/f93a62b68def853ee86dec4e27fbc4068c25dd32/src%2Fliballoc%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2FCargo.toml?ref=f93a62b68def853ee86dec4e27fbc4068c25dd32", "patch": "@@ -10,5 +10,3 @@ test = false\n \n [dependencies]\n core = { path = \"../libcore\" }\n-libc = { path = \"../rustc/libc_shim\" }\n-alloc_system = { path = \"../liballoc_system\" }"}, {"sha": "1d928a922c7e053570b9f47da020c60d26ee04cf", "filename": "src/liballoc/lib.rs", "status": "modified", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/f93a62b68def853ee86dec4e27fbc4068c25dd32/src%2Fliballoc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f93a62b68def853ee86dec4e27fbc4068c25dd32/src%2Fliballoc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Flib.rs?ref=f93a62b68def853ee86dec4e27fbc4068c25dd32", "patch": "@@ -92,16 +92,9 @@\n #![feature(unsafe_no_drop_flag, filling_drop)]\n #![feature(unsize)]\n \n-// Issue# 30592: Systematically use alloc_system during stage0 since jemalloc\n-// might be unavailable or disabled\n-#![cfg_attr(stage0, feature(alloc_system))]\n-\n #![cfg_attr(not(test), feature(raw, fn_traits, placement_new_protocol))]\n #![cfg_attr(test, feature(test, rustc_private, box_heap))]\n \n-#[cfg(stage0)]\n-extern crate alloc_system;\n-\n // Allow testing this library\n \n #[cfg(test)]"}, {"sha": "d8ecddcbe422c6ff20f7daab0f955c031b7b562c", "filename": "src/libstd/lib.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/f93a62b68def853ee86dec4e27fbc4068c25dd32/src%2Flibstd%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f93a62b68def853ee86dec4e27fbc4068c25dd32/src%2Flibstd%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Flib.rs?ref=f93a62b68def853ee86dec4e27fbc4068c25dd32", "patch": "@@ -269,6 +269,10 @@\n #![feature(vec_push_all)]\n #![feature(zero_one)]\n \n+// Issue# 30592: Systematically use alloc_system during stage0 since jemalloc\n+// might be unavailable or disabled\n+#![cfg_attr(stage0, feature(alloc_system))]\n+\n // Don't link to std. We are std.\n #![no_std]\n \n@@ -295,6 +299,9 @@ extern crate alloc;\n extern crate rustc_unicode;\n extern crate libc;\n \n+#[cfg(stage0)]\n+extern crate alloc_system;\n+\n // Make std testable by not duplicating lang items and other globals. See #2912\n #[cfg(test)] extern crate std as realstd;\n "}]}