{"sha": "d3e7ffa7f548801d4a5784d314aabdafe9186af7", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQzZTdmZmE3ZjU0ODgwMWQ0YTU3ODRkMzE0YWFiZGFmZTkxODZhZjc=", "commit": {"author": {"name": "Jacob Hoffman-Andrews", "email": "github@hoffman-andrews.com", "date": "2021-02-20T01:54:41Z"}, "committer": {"name": "Jacob Hoffman-Andrews", "email": "github@hoffman-andrews.com", "date": "2021-03-03T01:23:51Z"}, "message": "Improve page load performance in rustdoc.\n\nAdd font-display: swap. Per https://web.dev/font-display/, this prevents\n\"flash of invisible text\" during load by using a system font until the\ncustom font is available. I've noticed this flash of invisible text\noccasionally when reading Rust docs.\n\nAdd an explicit height to icons (which already had an explicit width)\nto allow browsers to lay out the page more accurately before the icons\nhave been loaded. https://web.dev/optimize-cls/.\n\nAdd min-width: 115px to the crate search dropdown. When the HTML first\nloads, this dropdown includes only the text \"All crates.\" Later, JS\nloads the items underneath it, some of which are wider. That causes\nthe dropdown to get wider, causing a distracting reflow. This sets a\nmin-width based on the size that the dropdown eventually becomes based\non the crates on doc.rust-lang.org, reducing page movement during load.", "tree": {"sha": "5175d64f234c1806da401f4123c0614cc09d9d03", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5175d64f234c1806da401f4123c0614cc09d9d03"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d3e7ffa7f548801d4a5784d314aabdafe9186af7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d3e7ffa7f548801d4a5784d314aabdafe9186af7", "html_url": "https://github.com/rust-lang/rust/commit/d3e7ffa7f548801d4a5784d314aabdafe9186af7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d3e7ffa7f548801d4a5784d314aabdafe9186af7/comments", "author": {"login": "jsha", "id": 220205, "node_id": "MDQ6VXNlcjIyMDIwNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/220205?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsha", "html_url": "https://github.com/jsha", "followers_url": "https://api.github.com/users/jsha/followers", "following_url": "https://api.github.com/users/jsha/following{/other_user}", "gists_url": "https://api.github.com/users/jsha/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsha/subscriptions", "organizations_url": "https://api.github.com/users/jsha/orgs", "repos_url": "https://api.github.com/users/jsha/repos", "events_url": "https://api.github.com/users/jsha/events{/privacy}", "received_events_url": "https://api.github.com/users/jsha/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jsha", "id": 220205, "node_id": "MDQ6VXNlcjIyMDIwNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/220205?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsha", "html_url": "https://github.com/jsha", "followers_url": "https://api.github.com/users/jsha/followers", "following_url": "https://api.github.com/users/jsha/following{/other_user}", "gists_url": "https://api.github.com/users/jsha/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsha/subscriptions", "organizations_url": "https://api.github.com/users/jsha/orgs", "repos_url": "https://api.github.com/users/jsha/repos", "events_url": "https://api.github.com/users/jsha/events{/privacy}", "received_events_url": "https://api.github.com/users/jsha/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "94736c434ee154b30e2ec22ec112b79e3f6c5884", "url": "https://api.github.com/repos/rust-lang/rust/commits/94736c434ee154b30e2ec22ec112b79e3f6c5884", "html_url": "https://github.com/rust-lang/rust/commit/94736c434ee154b30e2ec22ec112b79e3f6c5884"}], "stats": {"total": 18, "additions": 16, "deletions": 2}, "files": [{"sha": "ff18e1a8f51ccb008be5f7da63524f24214cfe7b", "filename": "src/doc/rust.css", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/d3e7ffa7f548801d4a5784d314aabdafe9186af7/src%2Fdoc%2Frust.css", "raw_url": "https://github.com/rust-lang/rust/raw/d3e7ffa7f548801d4a5784d314aabdafe9186af7/src%2Fdoc%2Frust.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frust.css?ref=d3e7ffa7f548801d4a5784d314aabdafe9186af7", "patch": "@@ -3,30 +3,35 @@\n \tfont-style: normal;\n \tfont-weight: 400;\n \tsrc: local('Fira Sans'), url(\"FiraSans-Regular.woff\") format('woff');\n+\tfont-display: swap;\n }\n @font-face {\n \tfont-family: 'Fira Sans';\n \tfont-style: normal;\n \tfont-weight: 500;\n \tsrc: local('Fira Sans Medium'), url(\"FiraSans-Medium.woff\") format('woff');\n+\tfont-display: swap;\n }\n @font-face {\n \tfont-family: 'Source Serif Pro';\n \tfont-style: normal;\n \tfont-weight: 400;\n \tsrc: local('Source Serif Pro'), url(\"SourceSerifPro-Regular.ttf.woff\") format('woff');\n+\tfont-display: swap;\n }\n @font-face {\n \tfont-family: 'Source Serif Pro';\n \tfont-style: italic;\n \tfont-weight: 400;\n \tsrc: url(\"SourceSerifPro-It.ttf.woff\") format('woff');\n+\tfont-display: swap;\n }\n @font-face {\n \tfont-family: 'Source Serif Pro';\n \tfont-style: normal;\n \tfont-weight: 700;\n \tsrc: local('Source Serif Pro Bold'), url(\"SourceSerifPro-Bold.ttf.woff\") format('woff');\n+\tfont-display: swap;\n }\n @font-face {\n \tfont-family: 'Source Code Pro';\n@@ -35,6 +40,7 @@\n \t/* Avoid using locally installed font because bad versions are in circulation:\n \t * see https://github.com/rust-lang/rust/issues/24355 */\n \tsrc: url(\"SourceCodePro-Regular.woff\") format('woff');\n+\tfont-display: swap;\n }\n \n *:not(body) {"}, {"sha": "64b209a46c01d5b4fd2bdfb3861a2ba9e85e77fd", "filename": "src/librustdoc/html/layout.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d3e7ffa7f548801d4a5784d314aabdafe9186af7/src%2Flibrustdoc%2Fhtml%2Flayout.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d3e7ffa7f548801d4a5784d314aabdafe9186af7/src%2Flibrustdoc%2Fhtml%2Flayout.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Flayout.rs?ref=d3e7ffa7f548801d4a5784d314aabdafe9186af7", "patch": "@@ -82,7 +82,7 @@ crate fn render<T: Print, S: Print>(\n     <div class=\\\"theme-picker\\\">\\\n         <button id=\\\"theme-picker\\\" aria-label=\\\"Pick another theme!\\\" aria-haspopup=\\\"menu\\\">\\\n             <img src=\\\"{static_root_path}brush{suffix}.svg\\\" \\\n-                 width=\\\"18\\\" \\\n+                 width=\\\"18\\\" height=\\\"18\\\" \\\n                  alt=\\\"Pick another theme!\\\">\\\n         </button>\\\n         <div id=\\\"theme-choices\\\" role=\\\"menu\\\"></div>\\\n@@ -102,7 +102,7 @@ crate fn render<T: Print, S: Print>(\n                 <button type=\\\"button\\\" class=\\\"help-button\\\">?</button>\n                 <a id=\\\"settings-menu\\\" href=\\\"{root_path}settings.html\\\">\\\n                     <img src=\\\"{static_root_path}wheel{suffix}.svg\\\" \\\n-                         width=\\\"18\\\" \\\n+                         width=\\\"18\\\" height=\\\"18\\\" \\\n                          alt=\\\"Change settings\\\">\\\n                 </a>\\\n             </div>\\"}, {"sha": "7da18409d5e0e73c9e979b51cec7f4d8dab514e4", "filename": "src/librustdoc/html/static/rustdoc.css", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/d3e7ffa7f548801d4a5784d314aabdafe9186af7/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/d3e7ffa7f548801d4a5784d314aabdafe9186af7/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css?ref=d3e7ffa7f548801d4a5784d314aabdafe9186af7", "patch": "@@ -6,6 +6,7 @@\n \tsrc: local('Fira Sans'),\n \t\turl(\"FiraSans-Regular.woff2\") format(\"woff2\"),\n \t\turl(\"FiraSans-Regular.woff\") format('woff');\n+\tfont-display: swap;\n }\n @font-face {\n \tfont-family: 'Fira Sans';\n@@ -14,6 +15,7 @@\n \tsrc: local('Fira Sans Medium'),\n \t\turl(\"FiraSans-Medium.woff2\") format(\"woff2\"),\n \t\turl(\"FiraSans-Medium.woff\") format('woff');\n+\tfont-display: swap;\n }\n \n /* See SourceSerifPro-LICENSE.txt for the Source Serif Pro license. */\n@@ -22,18 +24,21 @@\n \tfont-style: normal;\n \tfont-weight: 400;\n \tsrc: local('Source Serif Pro'), url(\"SourceSerifPro-Regular.ttf.woff\") format('woff');\n+\tfont-display: swap;\n }\n @font-face {\n \tfont-family: 'Source Serif Pro';\n \tfont-style: italic;\n \tfont-weight: 400;\n \tsrc: local('Source Serif Pro Italic'), url(\"SourceSerifPro-It.ttf.woff\") format('woff');\n+\tfont-display: swap;\n }\n @font-face {\n \tfont-family: 'Source Serif Pro';\n \tfont-style: normal;\n \tfont-weight: 700;\n \tsrc: local('Source Serif Pro Bold'), url(\"SourceSerifPro-Bold.ttf.woff\") format('woff');\n+\tfont-display: swap;\n }\n \n /* See SourceCodePro-LICENSE.txt for the Source Code Pro license. */\n@@ -44,12 +49,14 @@\n \t/* Avoid using locally installed font because bad versions are in circulation:\n \t * see https://github.com/rust-lang/rust/issues/24355 */\n \tsrc: url(\"SourceCodePro-Regular.woff\") format('woff');\n+\tfont-display: swap;\n }\n @font-face {\n \tfont-family: 'Source Code Pro';\n \tfont-style: normal;\n \tfont-weight: 600;\n \tsrc: url(\"SourceCodePro-Semibold.woff\") format('woff');\n+\tfont-display: swap;\n }\n \n * {\n@@ -684,6 +691,7 @@ a {\n \twidth: calc(100% - 63px);\n }\n #crate-search {\n+\tmin-width: 115px;\n \tmargin-top: 5px;\n \tpadding: 6px;\n \tpadding-right: 19px;"}]}