{"sha": "343a0bf5c2aebaaa422bd1f92563b606131cb6bd", "node_id": "C_kwDOAAsO6NoAKDM0M2EwYmY1YzJhZWJhYWE0MjJiZDFmOTI1NjNiNjA2MTMxY2I2YmQ", "commit": {"author": {"name": "liushuyu", "email": "liushuyu011@gmail.com", "date": "2023-05-20T23:24:14Z"}, "committer": {"name": "liushuyu", "email": "liushuyu011@gmail.com", "date": "2023-05-21T00:33:17Z"}, "message": "bootstrap: add test cases for beta revision extraction", "tree": {"sha": "6a0e99fe7a2b340d9cad46b613b5cf63555e7b7e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6a0e99fe7a2b340d9cad46b613b5cf63555e7b7e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/343a0bf5c2aebaaa422bd1f92563b606131cb6bd", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE6x/rcKrl3aOwzUVJI9HORTRBlDcFAmRpZs8ACgkQI9HORTRB\nlDeHEhAAhtZ7Njgi+6HdthfssMqIHo1csQ3m9l6PNmw5Au+4VJJdB7kfhGvAgyWp\niaOKP12c9QGoIm6YoF3Om6nkBJRmeDNRVlYjowA6Zn3xZBngvbot8rxcsqr2iqSb\nQn/IDaqfC9HqiHshn1Z9AC7IDI8nz3TINRwNa/4uNGdGvU6ZIqZUIPKxSf6KIZi3\n+QPEZQjn5zyYeSJ3/IXn9Iz0dX6GmQDeJEIQ92QcrRZJz2/4F4x/JqdZguY/u0vW\nm1SctJKTNK4YAEzw4H9kO+Xug7xim5POc4QbJZsx4WC9trm8Jv/0w/dmafafMF7g\nnzdeKFK/Vr8y535UpblH47sAIhNz4+5uDiLd4aw89vnIYMVo6gqgcMvfZhXYuAbs\nhDgkrGwjnHZnIencOIwCwKkHx8NYkrQL/pCqhFGgEgKxb+hY6475dMATepoOOTro\ncQHivhjHDPIovmvdAee2dJM2jceK3gWz+IDTPpHJn5dywp1xmZMnVCoNS7AJk2Lm\nUwp1HkcaJa+0/hUZTk1tRUVHgfBRG4YsYH3pIyOLJOAAwES3ZaU5zKUzE5tqTmQn\nwxxL5MrddkGtIWx003Z9pz9nnOwDIM+U4NVYipYJoJLjJ9P30C6/retmG357rvjI\nxmJWhItsIbOUddY67uy8IGpextGPNGIvc7RsY+c4DgRNbcbpjdQ=\n=CmVY\n-----END PGP SIGNATURE-----", "payload": "tree 6a0e99fe7a2b340d9cad46b613b5cf63555e7b7e\nparent 50e38e928ec4f01018baa83bb101d1c5e3531a83\nauthor liushuyu <liushuyu011@gmail.com> 1684625054 -0600\ncommitter liushuyu <liushuyu011@gmail.com> 1684629197 -0600\n\nbootstrap: add test cases for beta revision extraction\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/343a0bf5c2aebaaa422bd1f92563b606131cb6bd", "html_url": "https://github.com/rust-lang/rust/commit/343a0bf5c2aebaaa422bd1f92563b606131cb6bd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/343a0bf5c2aebaaa422bd1f92563b606131cb6bd/comments", "author": {"login": "liushuyu", "id": 6829345, "node_id": "MDQ6VXNlcjY4MjkzNDU=", "avatar_url": "https://avatars.githubusercontent.com/u/6829345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liushuyu", "html_url": "https://github.com/liushuyu", "followers_url": "https://api.github.com/users/liushuyu/followers", "following_url": "https://api.github.com/users/liushuyu/following{/other_user}", "gists_url": "https://api.github.com/users/liushuyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/liushuyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liushuyu/subscriptions", "organizations_url": "https://api.github.com/users/liushuyu/orgs", "repos_url": "https://api.github.com/users/liushuyu/repos", "events_url": "https://api.github.com/users/liushuyu/events{/privacy}", "received_events_url": "https://api.github.com/users/liushuyu/received_events", "type": "User", "site_admin": false}, "committer": {"login": "liushuyu", "id": 6829345, "node_id": "MDQ6VXNlcjY4MjkzNDU=", "avatar_url": "https://avatars.githubusercontent.com/u/6829345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liushuyu", "html_url": "https://github.com/liushuyu", "followers_url": "https://api.github.com/users/liushuyu/followers", "following_url": "https://api.github.com/users/liushuyu/following{/other_user}", "gists_url": "https://api.github.com/users/liushuyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/liushuyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liushuyu/subscriptions", "organizations_url": "https://api.github.com/users/liushuyu/orgs", "repos_url": "https://api.github.com/users/liushuyu/repos", "events_url": "https://api.github.com/users/liushuyu/events{/privacy}", "received_events_url": "https://api.github.com/users/liushuyu/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "50e38e928ec4f01018baa83bb101d1c5e3531a83", "url": "https://api.github.com/repos/rust-lang/rust/commits/50e38e928ec4f01018baa83bb101d1c5e3531a83", "html_url": "https://github.com/rust-lang/rust/commit/50e38e928ec4f01018baa83bb101d1c5e3531a83"}], "stats": {"total": 16, "additions": 16, "deletions": 0}, "files": [{"sha": "edca8fe9b13afd2e51a624205f8fd046c61e8a75", "filename": "src/bootstrap/builder/tests.rs", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/343a0bf5c2aebaaa422bd1f92563b606131cb6bd/src%2Fbootstrap%2Fbuilder%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/343a0bf5c2aebaaa422bd1f92563b606131cb6bd/src%2Fbootstrap%2Fbuilder%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbuilder%2Ftests.rs?ref=343a0bf5c2aebaaa422bd1f92563b606131cb6bd", "patch": "@@ -146,6 +146,22 @@ fn alias_and_path_for_library() {\n     );\n }\n \n+#[test]\n+fn test_beta_rev_parsing() {\n+    use crate::extract_beta_rev;\n+\n+    // single digit revision\n+    assert_eq!(extract_beta_rev(\"1.99.9-beta.7 (xxxxxx)\"), Some(\"7\".to_string()));\n+    // multiple digits\n+    assert_eq!(extract_beta_rev(\"1.99.9-beta.777 (xxxxxx)\"), Some(\"777\".to_string()));\n+    // nightly channel (no beta revision)\n+    assert_eq!(extract_beta_rev(\"1.99.9-nightly (xxxxxx)\"), None);\n+    // stable channel (no beta revision)\n+    assert_eq!(extract_beta_rev(\"1.99.9 (xxxxxxx)\"), None);\n+    // invalid string\n+    assert_eq!(extract_beta_rev(\"invalid\"), None);\n+}\n+\n mod defaults {\n     use super::{configure, first, run_build};\n     use crate::builder::*;"}]}