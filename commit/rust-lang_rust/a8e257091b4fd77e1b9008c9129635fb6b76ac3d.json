{"sha": "a8e257091b4fd77e1b9008c9129635fb6b76ac3d", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE4ZTI1NzA5MWI0ZmQ3N2UxYjkwMDhjOTEyOTYzNWZiNmI3NmFjM2Q=", "commit": {"author": {"name": "Corey Farwell", "email": "coreyf@rwell.org", "date": "2016-10-10T23:35:22Z"}, "committer": {"name": "Corey Farwell", "email": "coreyf@rwell.org", "date": "2016-10-10T23:35:22Z"}, "message": "Use `Cow` instead of `String` to avoid unnecessary allocations.", "tree": {"sha": "1a2d6690dc9a00ba36bc0f97a84ac0e5448b0a12", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1a2d6690dc9a00ba36bc0f97a84ac0e5448b0a12"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a8e257091b4fd77e1b9008c9129635fb6b76ac3d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a8e257091b4fd77e1b9008c9129635fb6b76ac3d", "html_url": "https://github.com/rust-lang/rust/commit/a8e257091b4fd77e1b9008c9129635fb6b76ac3d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a8e257091b4fd77e1b9008c9129635fb6b76ac3d/comments", "author": {"login": "frewsxcv", "id": 416575, "node_id": "MDQ6VXNlcjQxNjU3NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/416575?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frewsxcv", "html_url": "https://github.com/frewsxcv", "followers_url": "https://api.github.com/users/frewsxcv/followers", "following_url": "https://api.github.com/users/frewsxcv/following{/other_user}", "gists_url": "https://api.github.com/users/frewsxcv/gists{/gist_id}", "starred_url": "https://api.github.com/users/frewsxcv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frewsxcv/subscriptions", "organizations_url": "https://api.github.com/users/frewsxcv/orgs", "repos_url": "https://api.github.com/users/frewsxcv/repos", "events_url": "https://api.github.com/users/frewsxcv/events{/privacy}", "received_events_url": "https://api.github.com/users/frewsxcv/received_events", "type": "User", "site_admin": false}, "committer": {"login": "frewsxcv", "id": 416575, "node_id": "MDQ6VXNlcjQxNjU3NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/416575?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frewsxcv", "html_url": "https://github.com/frewsxcv", "followers_url": "https://api.github.com/users/frewsxcv/followers", "following_url": "https://api.github.com/users/frewsxcv/following{/other_user}", "gists_url": "https://api.github.com/users/frewsxcv/gists{/gist_id}", "starred_url": "https://api.github.com/users/frewsxcv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frewsxcv/subscriptions", "organizations_url": "https://api.github.com/users/frewsxcv/orgs", "repos_url": "https://api.github.com/users/frewsxcv/repos", "events_url": "https://api.github.com/users/frewsxcv/events{/privacy}", "received_events_url": "https://api.github.com/users/frewsxcv/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3a15475d363d60ba5ab947c6f8595c0a437623b4", "url": "https://api.github.com/repos/rust-lang/rust/commits/3a15475d363d60ba5ab947c6f8595c0a437623b4", "html_url": "https://github.com/rust-lang/rust/commit/3a15475d363d60ba5ab947c6f8595c0a437623b4"}], "stats": {"total": 7, "additions": 4, "deletions": 3}, "files": [{"sha": "bc38901422c0d68f959074a245bea9dd3596d1ab", "filename": "src/librustc/session/filesearch.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/a8e257091b4fd77e1b9008c9129635fb6b76ac3d/src%2Flibrustc%2Fsession%2Ffilesearch.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8e257091b4fd77e1b9008c9129635fb6b76ac3d/src%2Flibrustc%2Fsession%2Ffilesearch.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fsession%2Ffilesearch.rs?ref=a8e257091b4fd77e1b9008c9129635fb6b76ac3d", "patch": "@@ -12,6 +12,7 @@\n \n pub use self::FileMatch::*;\n \n+use std::borrow::Cow;\n use std::collections::HashSet;\n use std::env;\n use std::fs;\n@@ -123,7 +124,7 @@ impl<'a> FileSearch<'a> {\n     // Returns a list of directories where target-specific tool binaries are located.\n     pub fn get_tools_search_paths(&self) -> Vec<PathBuf> {\n         let mut p = PathBuf::from(self.sysroot);\n-        p.push(&find_libdir(self.sysroot));\n+        p.push(find_libdir(self.sysroot).as_ref());\n         p.push(RUST_LIB_DIR);\n         p.push(&self.triple);\n         p.push(\"bin\");\n@@ -132,7 +133,7 @@ impl<'a> FileSearch<'a> {\n }\n \n pub fn relative_target_lib_path(sysroot: &Path, target_triple: &str) -> PathBuf {\n-    let mut p = PathBuf::from(&find_libdir(sysroot));\n+    let mut p = PathBuf::from(find_libdir(sysroot).as_ref());\n     assert!(p.is_relative());\n     p.push(RUST_LIB_DIR);\n     p.push(target_triple);\n@@ -166,7 +167,7 @@ pub fn get_or_default_sysroot() -> PathBuf {\n }\n \n // The name of the directory rustc expects libraries to be located.\n-fn find_libdir(sysroot: &Path) -> String {\n+fn find_libdir(sysroot: &Path) -> Cow<'static, str> {\n     // FIXME: This is a quick hack to make the rustc binary able to locate\n     // Rust libraries in Linux environments where libraries might be installed\n     // to lib64/lib32. This would be more foolproof by basing the sysroot off"}]}