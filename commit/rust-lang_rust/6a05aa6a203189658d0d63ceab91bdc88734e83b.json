{"sha": "6a05aa6a203189658d0d63ceab91bdc88734e83b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZhMDVhYTZhMjAzMTg5NjU4ZDBkNjNjZWFiOTFiZGM4ODczNGU4M2I=", "commit": {"author": {"name": "Luqman Aden", "email": "laden@csclub.uwaterloo.ca", "date": "2013-08-24T17:54:42Z"}, "committer": {"name": "Luqman Aden", "email": "laden@csclub.uwaterloo.ca", "date": "2013-08-24T17:54:42Z"}, "message": "librustc: Always use session target triple.", "tree": {"sha": "7697ae641e43bbae0c694ae98579c8f4861f6c2c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7697ae641e43bbae0c694ae98579c8f4861f6c2c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6a05aa6a203189658d0d63ceab91bdc88734e83b", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6a05aa6a203189658d0d63ceab91bdc88734e83b", "html_url": "https://github.com/rust-lang/rust/commit/6a05aa6a203189658d0d63ceab91bdc88734e83b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6a05aa6a203189658d0d63ceab91bdc88734e83b/comments", "author": {"login": "luqmana", "id": 287063, "node_id": "MDQ6VXNlcjI4NzA2Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/287063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luqmana", "html_url": "https://github.com/luqmana", "followers_url": "https://api.github.com/users/luqmana/followers", "following_url": "https://api.github.com/users/luqmana/following{/other_user}", "gists_url": "https://api.github.com/users/luqmana/gists{/gist_id}", "starred_url": "https://api.github.com/users/luqmana/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luqmana/subscriptions", "organizations_url": "https://api.github.com/users/luqmana/orgs", "repos_url": "https://api.github.com/users/luqmana/repos", "events_url": "https://api.github.com/users/luqmana/events{/privacy}", "received_events_url": "https://api.github.com/users/luqmana/received_events", "type": "User", "site_admin": false}, "committer": {"login": "luqmana", "id": 287063, "node_id": "MDQ6VXNlcjI4NzA2Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/287063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luqmana", "html_url": "https://github.com/luqmana", "followers_url": "https://api.github.com/users/luqmana/followers", "following_url": "https://api.github.com/users/luqmana/following{/other_user}", "gists_url": "https://api.github.com/users/luqmana/gists{/gist_id}", "starred_url": "https://api.github.com/users/luqmana/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luqmana/subscriptions", "organizations_url": "https://api.github.com/users/luqmana/orgs", "repos_url": "https://api.github.com/users/luqmana/repos", "events_url": "https://api.github.com/users/luqmana/events{/privacy}", "received_events_url": "https://api.github.com/users/luqmana/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cfd0bfbd1165294fd33b1ac24e6696d4c6ceb0ca", "url": "https://api.github.com/repos/rust-lang/rust/commits/cfd0bfbd1165294fd33b1ac24e6696d4c6ceb0ca", "html_url": "https://github.com/rust-lang/rust/commit/cfd0bfbd1165294fd33b1ac24e6696d4c6ceb0ca"}], "stats": {"total": 49, "additions": 13, "deletions": 36}, "files": [{"sha": "94f4adb590ab2c8bdc8336dbaf5b0e04cda7f894", "filename": "src/librustc/back/arm.rs", "status": "modified", "additions": 2, "deletions": 8, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/6a05aa6a203189658d0d63ceab91bdc88734e83b/src%2Flibrustc%2Fback%2Farm.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a05aa6a203189658d0d63ceab91bdc88734e83b/src%2Flibrustc%2Fback%2Farm.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fback%2Farm.rs?ref=6a05aa6a203189658d0d63ceab91bdc88734e83b", "patch": "@@ -13,7 +13,7 @@ use driver::session::sess_os_to_meta_os;\n use driver::session;\n use metadata::loader::meta_section_name;\n \n-pub fn get_target_strs(target_os: session::os) -> target_strs::t {\n+pub fn get_target_strs(target_triple: ~str, target_os: session::os) -> target_strs::t {\n     return target_strs::t {\n         module_asm: ~\"\",\n \n@@ -61,13 +61,7 @@ pub fn get_target_strs(target_os: session::os) -> target_strs::t {\n           }\n         },\n \n-        target_triple: match target_os {\n-          session::os_macos => ~\"arm-apple-darwin\",\n-          session::os_win32 => ~\"arm-pc-mingw32\",\n-          session::os_linux => ~\"arm-unknown-linux-gnueabihf\",\n-          session::os_android => ~\"arm-linux-androideabi\",\n-          session::os_freebsd => ~\"arm-unknown-freebsd\"\n-        },\n+        target_triple: target_triple,\n \n         cc_args: ~[~\"-marm\"]\n     };"}, {"sha": "e19b3c78623a61ed681fbdfc512ec1401c759b93", "filename": "src/librustc/back/mips.rs", "status": "modified", "additions": 2, "deletions": 8, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/6a05aa6a203189658d0d63ceab91bdc88734e83b/src%2Flibrustc%2Fback%2Fmips.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a05aa6a203189658d0d63ceab91bdc88734e83b/src%2Flibrustc%2Fback%2Fmips.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fback%2Fmips.rs?ref=6a05aa6a203189658d0d63ceab91bdc88734e83b", "patch": "@@ -13,7 +13,7 @@ use driver::session;\n use driver::session::sess_os_to_meta_os;\n use metadata::loader::meta_section_name;\n \n-pub fn get_target_strs(target_os: session::os) -> target_strs::t {\n+pub fn get_target_strs(target_triple: ~str, target_os: session::os) -> target_strs::t {\n     return target_strs::t {\n         module_asm: ~\"\",\n \n@@ -61,13 +61,7 @@ pub fn get_target_strs(target_os: session::os) -> target_strs::t {\n           }\n         },\n \n-        target_triple: match target_os {\n-          session::os_macos => ~\"mips-apple-darwin\",\n-          session::os_win32 => ~\"mips-pc-mingw32\",\n-          session::os_linux => ~\"mips-unknown-linux-gnu\",\n-          session::os_android => ~\"mips-unknown-android-gnu\",\n-          session::os_freebsd => ~\"mips-unknown-freebsd\"\n-        },\n+        target_triple: target_triple,\n \n         cc_args: ~[]\n     };"}, {"sha": "968c5ba161b1de1cf64393be5db7d2b626af8aef", "filename": "src/librustc/back/x86.rs", "status": "modified", "additions": 2, "deletions": 8, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/6a05aa6a203189658d0d63ceab91bdc88734e83b/src%2Flibrustc%2Fback%2Fx86.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a05aa6a203189658d0d63ceab91bdc88734e83b/src%2Flibrustc%2Fback%2Fx86.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fback%2Fx86.rs?ref=6a05aa6a203189658d0d63ceab91bdc88734e83b", "patch": "@@ -14,7 +14,7 @@ use driver::session::sess_os_to_meta_os;\n use driver::session;\n use metadata::loader::meta_section_name;\n \n-pub fn get_target_strs(target_os: session::os) -> target_strs::t {\n+pub fn get_target_strs(target_triple: ~str, target_os: session::os) -> target_strs::t {\n     return target_strs::t {\n         module_asm: ~\"\",\n \n@@ -44,13 +44,7 @@ pub fn get_target_strs(target_os: session::os) -> target_strs::t {\n           }\n         },\n \n-        target_triple: match target_os {\n-          session::os_macos => ~\"i686-apple-darwin\",\n-          session::os_win32 => ~\"i686-pc-mingw32\",\n-          session::os_linux => ~\"i686-unknown-linux-gnu\",\n-          session::os_android => ~\"i686-unknown-android-gnu\",\n-          session::os_freebsd => ~\"i686-unknown-freebsd\"\n-        },\n+        target_triple: target_triple,\n \n         cc_args: ~[~\"-m32\"]\n     };"}, {"sha": "87aad7a108cebbf5e3c55d1b0c8f1eca1a651c62", "filename": "src/librustc/back/x86_64.rs", "status": "modified", "additions": 2, "deletions": 8, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/6a05aa6a203189658d0d63ceab91bdc88734e83b/src%2Flibrustc%2Fback%2Fx86_64.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a05aa6a203189658d0d63ceab91bdc88734e83b/src%2Flibrustc%2Fback%2Fx86_64.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fback%2Fx86_64.rs?ref=6a05aa6a203189658d0d63ceab91bdc88734e83b", "patch": "@@ -14,7 +14,7 @@ use driver::session::sess_os_to_meta_os;\n use driver::session;\n use metadata::loader::meta_section_name;\n \n-pub fn get_target_strs(target_os: session::os) -> target_strs::t {\n+pub fn get_target_strs(target_triple: ~str, target_os: session::os) -> target_strs::t {\n     return target_strs::t {\n         module_asm: ~\"\",\n \n@@ -52,13 +52,7 @@ pub fn get_target_strs(target_os: session::os) -> target_strs::t {\n           }\n         },\n \n-        target_triple: match target_os {\n-          session::os_macos => ~\"x86_64-apple-darwin\",\n-          session::os_win32 => ~\"x86_64-pc-mingw32\",\n-          session::os_linux => ~\"x86_64-unknown-linux-gnu\",\n-          session::os_android => ~\"x86_64-unknown-android-gnu\",\n-          session::os_freebsd => ~\"x86_64-unknown-freebsd\",\n-        },\n+        target_triple: target_triple,\n \n         cc_args: ~[~\"-m64\"]\n     };"}, {"sha": "e0c5a729b3f88116804e629eb3c7df6b9d890cdc", "filename": "src/librustc/driver/driver.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/6a05aa6a203189658d0d63ceab91bdc88734e83b/src%2Flibrustc%2Fdriver%2Fdriver.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a05aa6a203189658d0d63ceab91bdc88734e83b/src%2Flibrustc%2Fdriver%2Fdriver.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fdriver%2Fdriver.rs?ref=6a05aa6a203189658d0d63ceab91bdc88734e83b", "patch": "@@ -570,11 +570,12 @@ pub fn build_target_config(sopts: @session::options,\n       abi::Arm => (ast::ty_i32, ast::ty_u32, ast::ty_f64),\n       abi::Mips => (ast::ty_i32, ast::ty_u32, ast::ty_f64)\n     };\n+    let target_triple = sopts.target_triple.clone();\n     let target_strs = match arch {\n-      abi::X86 => x86::get_target_strs(os),\n-      abi::X86_64 => x86_64::get_target_strs(os),\n-      abi::Arm => arm::get_target_strs(os),\n-      abi::Mips => mips::get_target_strs(os)\n+      abi::X86 => x86::get_target_strs(target_triple, os),\n+      abi::X86_64 => x86_64::get_target_strs(target_triple, os),\n+      abi::Arm => arm::get_target_strs(target_triple, os),\n+      abi::Mips => mips::get_target_strs(target_triple, os)\n     };\n     let target_cfg = @session::config {\n         os: os,"}]}