{"sha": "67d13577aac2e47a0f40292c5c966469cbc610d7", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY3ZDEzNTc3YWFjMmU0N2EwZjQwMjkyYzVjOTY2NDY5Y2JjNjEwZDc=", "commit": {"author": {"name": "Christian Poveda", "email": "christianpoveda@protonmail.com", "date": "2019-08-13T17:10:24Z"}, "committer": {"name": "Christian Poveda", "email": "christianpoveda@protonmail.com", "date": "2019-08-13T17:10:24Z"}, "message": "Move test env var to test_runner", "tree": {"sha": "395542015148363226c8490d31e7c56ab4ec96f4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/395542015148363226c8490d31e7c56ab4ec96f4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/67d13577aac2e47a0f40292c5c966469cbc610d7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/67d13577aac2e47a0f40292c5c966469cbc610d7", "html_url": "https://github.com/rust-lang/rust/commit/67d13577aac2e47a0f40292c5c966469cbc610d7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/67d13577aac2e47a0f40292c5c966469cbc610d7/comments", "author": {"login": "pvdrz", "id": 31802960, "node_id": "MDQ6VXNlcjMxODAyOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/31802960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pvdrz", "html_url": "https://github.com/pvdrz", "followers_url": "https://api.github.com/users/pvdrz/followers", "following_url": "https://api.github.com/users/pvdrz/following{/other_user}", "gists_url": "https://api.github.com/users/pvdrz/gists{/gist_id}", "starred_url": "https://api.github.com/users/pvdrz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pvdrz/subscriptions", "organizations_url": "https://api.github.com/users/pvdrz/orgs", "repos_url": "https://api.github.com/users/pvdrz/repos", "events_url": "https://api.github.com/users/pvdrz/events{/privacy}", "received_events_url": "https://api.github.com/users/pvdrz/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pvdrz", "id": 31802960, "node_id": "MDQ6VXNlcjMxODAyOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/31802960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pvdrz", "html_url": "https://github.com/pvdrz", "followers_url": "https://api.github.com/users/pvdrz/followers", "following_url": "https://api.github.com/users/pvdrz/following{/other_user}", "gists_url": "https://api.github.com/users/pvdrz/gists{/gist_id}", "starred_url": "https://api.github.com/users/pvdrz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pvdrz/subscriptions", "organizations_url": "https://api.github.com/users/pvdrz/orgs", "repos_url": "https://api.github.com/users/pvdrz/repos", "events_url": "https://api.github.com/users/pvdrz/events{/privacy}", "received_events_url": "https://api.github.com/users/pvdrz/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "666cd22fa64ee318edc3b6292efa507442eb2554", "url": "https://api.github.com/repos/rust-lang/rust/commits/666cd22fa64ee318edc3b6292efa507442eb2554", "html_url": "https://github.com/rust-lang/rust/commit/666cd22fa64ee318edc3b6292efa507442eb2554"}], "stats": {"total": 7, "additions": 3, "deletions": 4}, "files": [{"sha": "9ef64c38638b7033fd22e20c1d1c7342f3baf3e5", "filename": "src/bin/miri-rustc-tests.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/67d13577aac2e47a0f40292c5c966469cbc610d7/src%2Fbin%2Fmiri-rustc-tests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/67d13577aac2e47a0f40292c5c966469cbc610d7/src%2Fbin%2Fmiri-rustc-tests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbin%2Fmiri-rustc-tests.rs?ref=67d13577aac2e47a0f40292c5c966469cbc610d7", "patch": "@@ -66,7 +66,6 @@ impl rustc_driver::Callbacks for MiriCompilerCalls {\n                 }\n                 tcx.hir().krate().visit_all_item_likes(&mut Visitor(tcx));\n             } else if let Some((entry_def_id, _)) = tcx.entry_fn(LOCAL_CRATE) {\n-\n                 let config = MiriConfig {\n                     validate: true,\n                     communicate: false,"}, {"sha": "702c6026ecedc64f985af5ab3dd84d141aaf9cf1", "filename": "tests/compiletest.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/67d13577aac2e47a0f40292c5c966469cbc610d7/tests%2Fcompiletest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/67d13577aac2e47a0f40292c5c966469cbc610d7/tests%2Fcompiletest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompiletest.rs?ref=67d13577aac2e47a0f40292c5c966469cbc610d7", "patch": "@@ -37,9 +37,6 @@ fn run_tests(mode: &str, path: &str, target: &str, mut flags: Vec<String>) {\n         flags.push(format!(\"--sysroot {}\", sysroot));\n     }\n \n-    // Add a test env var to do environment communication tests\n-    std::env::set_var(\"MIRI_ENV_VAR_TEST\", \"0\");\n-\n     // The rest of the configuration.\n     let mut config = compiletest::Config::default().tempdir();\n     config.mode = mode.parse().expect(\"Invalid mode\");\n@@ -126,6 +123,9 @@ fn compile_fail_miri(opt: bool) {\n }\n \n fn test_runner(_tests: &[&()]) {\n+    // Add a test env var to do environment communication tests\n+    std::env::set_var(\"MIRI_ENV_VAR_TEST\", \"0\");\n+\n     run_pass_miri(false);\n     run_pass_miri(true);\n "}]}