{"sha": "416182347589e9503408136747593ff95fb9dd13", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQxNjE4MjM0NzU4OWU5NTAzNDA4MTM2NzQ3NTkzZmY5NWZiOWRkMTM=", "commit": {"author": {"name": "Eduardo Broto", "email": "ebroto@tutanota.com", "date": "2020-05-26T22:06:50Z"}, "committer": {"name": "Eduardo Broto", "email": "ebroto@tutanota.com", "date": "2020-05-26T22:06:50Z"}, "message": "Avoid triggering similar names on code from expansion", "tree": {"sha": "02654fd4e80bb9facca5980a6376b03823a463bb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/02654fd4e80bb9facca5980a6376b03823a463bb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/416182347589e9503408136747593ff95fb9dd13", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/416182347589e9503408136747593ff95fb9dd13", "html_url": "https://github.com/rust-lang/rust/commit/416182347589e9503408136747593ff95fb9dd13", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/416182347589e9503408136747593ff95fb9dd13/comments", "author": {"login": "ebroto", "id": 816908, "node_id": "MDQ6VXNlcjgxNjkwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/816908?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebroto", "html_url": "https://github.com/ebroto", "followers_url": "https://api.github.com/users/ebroto/followers", "following_url": "https://api.github.com/users/ebroto/following{/other_user}", "gists_url": "https://api.github.com/users/ebroto/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebroto/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebroto/subscriptions", "organizations_url": "https://api.github.com/users/ebroto/orgs", "repos_url": "https://api.github.com/users/ebroto/repos", "events_url": "https://api.github.com/users/ebroto/events{/privacy}", "received_events_url": "https://api.github.com/users/ebroto/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ebroto", "id": 816908, "node_id": "MDQ6VXNlcjgxNjkwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/816908?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebroto", "html_url": "https://github.com/ebroto", "followers_url": "https://api.github.com/users/ebroto/followers", "following_url": "https://api.github.com/users/ebroto/following{/other_user}", "gists_url": "https://api.github.com/users/ebroto/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebroto/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebroto/subscriptions", "organizations_url": "https://api.github.com/users/ebroto/orgs", "repos_url": "https://api.github.com/users/ebroto/repos", "events_url": "https://api.github.com/users/ebroto/events{/privacy}", "received_events_url": "https://api.github.com/users/ebroto/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "04db13eb564f6e3264a0d376ef95365b1de44797", "url": "https://api.github.com/repos/rust-lang/rust/commits/04db13eb564f6e3264a0d376ef95365b1de44797", "html_url": "https://github.com/rust-lang/rust/commit/04db13eb564f6e3264a0d376ef95365b1de44797"}], "stats": {"total": 16, "additions": 10, "deletions": 6}, "files": [{"sha": "e556e5d59c188d02031ace0d36f258953e7a3ab4", "filename": "clippy_lints/src/new_without_default.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/416182347589e9503408136747593ff95fb9dd13/clippy_lints%2Fsrc%2Fnew_without_default.rs", "raw_url": "https://github.com/rust-lang/rust/raw/416182347589e9503408136747593ff95fb9dd13/clippy_lints%2Fsrc%2Fnew_without_default.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fnew_without_default.rs?ref=416182347589e9503408136747593ff95fb9dd13", "patch": "@@ -90,8 +90,8 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for NewWithoutDefault {\n                             return;\n                         }\n                         if sig.decl.inputs.is_empty() && name == sym!(new) && cx.access_levels.is_reachable(id) {\n-                            let self_did = cx.tcx.hir().local_def_id(cx.tcx.hir().get_parent_item(id));\n-                            let self_ty = cx.tcx.type_of(self_did);\n+                            let self_def_id = cx.tcx.hir().local_def_id(cx.tcx.hir().get_parent_item(id));\n+                            let self_ty = cx.tcx.type_of(self_def_id);\n                             if_chain! {\n                                 if same_tys(cx, self_ty, return_ty(cx, id));\n                                 if let Some(default_trait_id) = get_trait_def_id(cx, &paths::DEFAULT_TRAIT);\n@@ -112,10 +112,10 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for NewWithoutDefault {\n                                     // generics\n                                     if_chain! {\n                                         if let Some(ref impling_types) = self.impling_types;\n-                                        if let Some(self_def) = cx.tcx.type_of(self_did).ty_adt_def();\n-                                        if let Some(self_def_id) = self_def.did.as_local();\n+                                        if let Some(self_def) = cx.tcx.type_of(self_def_id).ty_adt_def();\n+                                        if let Some(self_local_did) = self_def.did.as_local();\n                                         then {\n-                                            let self_id = cx.tcx.hir().local_def_id_to_hir_id(self_def_id);\n+                                            let self_id = cx.tcx.hir().local_def_id_to_hir_id(self_local_did);\n                                             if impling_types.contains(&self_id) {\n                                                 return;\n                                             }"}, {"sha": "5f14fe97afefad36255744823e9fe5799ea680d5", "filename": "clippy_lints/src/non_expressive_names.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/416182347589e9503408136747593ff95fb9dd13/clippy_lints%2Fsrc%2Fnon_expressive_names.rs", "raw_url": "https://github.com/rust-lang/rust/raw/416182347589e9503408136747593ff95fb9dd13/clippy_lints%2Fsrc%2Fnon_expressive_names.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fnon_expressive_names.rs?ref=416182347589e9503408136747593ff95fb9dd13", "patch": "@@ -132,7 +132,11 @@ struct SimilarNamesNameVisitor<'a, 'tcx, 'b>(&'b mut SimilarNamesLocalVisitor<'a\n impl<'a, 'tcx, 'b> Visitor<'tcx> for SimilarNamesNameVisitor<'a, 'tcx, 'b> {\n     fn visit_pat(&mut self, pat: &'tcx Pat) {\n         match pat.kind {\n-            PatKind::Ident(_, ident, _) => self.check_ident(ident),\n+            PatKind::Ident(_, ident, _) => {\n+                if !pat.span.from_expansion() {\n+                    self.check_ident(ident);\n+                }\n+            },\n             PatKind::Struct(_, ref fields, _) => {\n                 for field in fields {\n                     if !field.is_shorthand {"}]}