{"sha": "d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ2MTM5Zjc2YzA3MmUyODFhNzdhNWVhYzliYTU3YTBlYjNhMTkzNmY=", "commit": {"author": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2020-05-21T19:49:38Z"}, "committer": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2020-06-28T17:08:10Z"}, "message": "Update tests", "tree": {"sha": "04fc6967800435ac849805ba18b6bbe2971df18b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/04fc6967800435ac849805ba18b6bbe2971df18b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "html_url": "https://github.com/rust-lang/rust/commit/d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/comments", "author": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "696084c764e5fe3a318eb75a180763fdeab194da", "url": "https://api.github.com/repos/rust-lang/rust/commits/696084c764e5fe3a318eb75a180763fdeab194da", "html_url": "https://github.com/rust-lang/rust/commit/696084c764e5fe3a318eb75a180763fdeab194da"}], "stats": {"total": 1420, "additions": 228, "deletions": 1192}, "files": [{"sha": "d8a9ae6ca20307363f872a753270fe254d8e4fd9", "filename": "src/test/ui/array-slice-vec/subslice-patterns-const-eval-match.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Farray-slice-vec%2Fsubslice-patterns-const-eval-match.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Farray-slice-vec%2Fsubslice-patterns-const-eval-match.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Farray-slice-vec%2Fsubslice-patterns-const-eval-match.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -2,7 +2,8 @@\n \n // run-pass\n \n-#![feature(const_fn, const_if_match)]\n+#![feature(const_fn)]\n+\n #[derive(PartialEq, Debug, Clone)]\n struct N(u8);\n "}, {"sha": "3e803f3b6d8b2d4901fad28f77964036dfa73d14", "filename": "src/test/ui/borrowck/issue-64453.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fborrowck%2Fissue-64453.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fborrowck%2Fissue-64453.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fissue-64453.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -2,7 +2,8 @@ struct Project;\n struct Value;\n \n static settings_dir: String = format!(\"\");\n-//~^ ERROR `match` is not allowed in a `static`\n+//~^ ERROR calls in statics are limited to constant functions\n+//~| ERROR calls in statics are limited to constant functions\n \n fn from_string(_: String) -> Value {\n     Value\n@@ -11,6 +12,7 @@ fn set_editor(_: Value) {}\n \n fn main() {\n     let settings_data = from_string(settings_dir);\n+    //~^ ERROR cannot move out of static item\n     let args: i32 = 0;\n \n     match args {"}, {"sha": "081ccd37861cb29df50ca16402882a0b3c37b8a8", "filename": "src/test/ui/borrowck/issue-64453.stderr", "status": "modified", "additions": 18, "deletions": 5, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fborrowck%2Fissue-64453.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fborrowck%2Fissue-64453.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fissue-64453.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,13 +1,26 @@\n-error[E0658]: `match` is not allowed in a `static`\n+error[E0507]: cannot move out of static item `settings_dir`\n+  --> $DIR/issue-64453.rs:14:37\n+   |\n+LL |     let settings_data = from_string(settings_dir);\n+   |                                     ^^^^^^^^^^^^ move occurs because `settings_dir` has type `std::string::String`, which does not implement the `Copy` trait\n+\n+error[E0015]: calls in statics are limited to constant functions, tuple structs and tuple variants\n+  --> $DIR/issue-64453.rs:4:31\n+   |\n+LL | static settings_dir: String = format!(\"\");\n+   |                               ^^^^^^^^^^^\n+   |\n+   = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\n+\n+error[E0015]: calls in statics are limited to constant functions, tuple structs and tuple variants\n   --> $DIR/issue-64453.rs:4:31\n    |\n LL | static settings_dir: String = format!(\"\");\n    |                               ^^^^^^^^^^^\n    |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n    = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\n \n-error: aborting due to previous error\n+error: aborting due to 3 previous errors\n \n-For more information about this error, try `rustc --explain E0658`.\n+Some errors have detailed explanations: E0015, E0507.\n+For more information about an error, try `rustc --explain E0015`."}, {"sha": "7c2c40dd6fc03a13a35a76100af5a7c98d4b4e62", "filename": "src/test/ui/consts/const-eval/infinite_loop.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Finfinite_loop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Finfinite_loop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Finfinite_loop.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -7,7 +7,6 @@ fn main() {\n         //~^ ERROR `while` is not allowed in a `const`\n             n = if n % 2 == 0 { n/2 } else { 3*n + 1 };\n             //~^ ERROR evaluation of constant value failed\n-            //~| ERROR `if` is not allowed in a `const`\n         }\n         n\n     }];"}, {"sha": "df96f32516c4ac9e34841336a26545cdf6b15bad", "filename": "src/test/ui/consts/const-eval/infinite_loop.stderr", "status": "modified", "additions": 1, "deletions": 12, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Finfinite_loop.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Finfinite_loop.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Finfinite_loop.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -5,30 +5,19 @@ LL | /         while n != 0 {\n LL | |\n LL | |             n = if n % 2 == 0 { n/2 } else { 3*n + 1 };\n LL | |\n-LL | |\n LL | |         }\n    | |_________^\n    |\n    = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n    = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/infinite_loop.rs:8:17\n-   |\n-LL |             n = if n % 2 == 0 { n/2 } else { 3*n + 1 };\n-   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n \n error[E0080]: evaluation of constant value failed\n   --> $DIR/infinite_loop.rs:8:17\n    |\n LL |             n = if n % 2 == 0 { n/2 } else { 3*n + 1 };\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ exceeded interpreter step limit (see `#[const_eval_limit]`)\n \n-error: aborting due to 3 previous errors\n+error: aborting due to 2 previous errors\n \n Some errors have detailed explanations: E0080, E0658.\n For more information about an error, try `rustc --explain E0080`."}, {"sha": "c41000e7135161c072b45b52b6ce034bf40169e1", "filename": "src/test/ui/consts/const-eval/issue-52475.stderr", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fissue-52475.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fissue-52475.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fissue-52475.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -10,7 +10,6 @@ LL | |         }\n    |\n    = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n    = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n \n error[E0080]: evaluation of constant value failed\n   --> $DIR/issue-52475.rs:7:17"}, {"sha": "f6b5ad005a8841430515c5129a46883de2f094e1", "filename": "src/test/ui/consts/const-eval/match-test-ptr-null.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fmatch-test-ptr-null.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fmatch-test-ptr-null.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fmatch-test-ptr-null.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -5,7 +5,6 @@ fn main() {\n     let _: [u8; 0] = [4; {\n         match &1 as *const i32 as usize {\n             //~^ ERROR casting pointers to integers in constants\n-            //~| ERROR `match` is not allowed in a `const`\n             //~| ERROR evaluation of constant value failed\n             0 => 42,\n             n => n,"}, {"sha": "48dbe661492d408f87dd327aa37acad435e92df4", "filename": "src/test/ui/consts/const-eval/match-test-ptr-null.stderr", "status": "modified", "additions": 1, "deletions": 16, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fmatch-test-ptr-null.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fmatch-test-ptr-null.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fmatch-test-ptr-null.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,18 +1,3 @@\n-error[E0658]: `match` is not allowed in a `const`\n-  --> $DIR/match-test-ptr-null.rs:6:9\n-   |\n-LL | /         match &1 as *const i32 as usize {\n-LL | |\n-LL | |\n-LL | |\n-LL | |             0 => 42,\n-LL | |             n => n,\n-LL | |         }\n-   | |_________^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n error[E0658]: casting pointers to integers in constants is unstable\n   --> $DIR/match-test-ptr-null.rs:6:15\n    |\n@@ -28,7 +13,7 @@ error[E0080]: evaluation of constant value failed\n LL |         match &1 as *const i32 as usize {\n    |               ^^^^^^^^^^^^^^^^^^^^^^^^^ \"pointer-to-integer cast\" needs an rfc before being allowed inside constants\n \n-error: aborting due to 3 previous errors\n+error: aborting due to 2 previous errors\n \n Some errors have detailed explanations: E0080, E0658.\n For more information about an error, try `rustc --explain E0080`."}, {"sha": "1e24bb4ab98d6ce873fdb40e1d56fc005bdd499c", "filename": "src/test/ui/consts/const-labeled-break.stderr", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst-labeled-break.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst-labeled-break.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-labeled-break.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -6,7 +6,6 @@ LL | const CRASH: () = 'a: while break 'a {};\n    |\n    = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n    = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n \n error: aborting due to previous error\n "}, {"sha": "90680c0194c554735b1cfd9043d5c7c7e020e96a", "filename": "src/test/ui/consts/const-match-pattern-arm.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst-match-pattern-arm.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst-match-pattern-arm.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-match-pattern-arm.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,12 +1,12 @@\n-#![allow(warnings)]\n+// check-pass\n \n-const x: bool = match Some(true) { //~ ERROR `match` is not allowed in a `const`\n+const _: bool = match Some(true) {\n     Some(value) => true,\n     _ => false\n };\n \n-const y: bool = {\n-    match Some(true) { //~ ERROR `match` is not allowed in a `const`\n+const _: bool = {\n+    match Some(true) {\n         Some(value) => true,\n         _ => false\n     }"}, {"sha": "412e1609ccfab8c138a4f2ebd3455b8534122783", "filename": "src/test/ui/consts/const-match-pattern-arm.stderr", "status": "removed", "additions": 0, "deletions": 28, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fconst-match-pattern-arm.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fconst-match-pattern-arm.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-match-pattern-arm.stderr?ref=696084c764e5fe3a318eb75a180763fdeab194da", "patch": "@@ -1,28 +0,0 @@\n-error[E0658]: `match` is not allowed in a `const`\n-  --> $DIR/const-match-pattern-arm.rs:3:17\n-   |\n-LL |   const x: bool = match Some(true) {\n-   |  _________________^\n-LL | |     Some(value) => true,\n-LL | |     _ => false\n-LL | | };\n-   | |_^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `match` is not allowed in a `const`\n-  --> $DIR/const-match-pattern-arm.rs:9:5\n-   |\n-LL | /     match Some(true) {\n-LL | |         Some(value) => true,\n-LL | |         _ => false\n-LL | |     }\n-   | |_____^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error: aborting due to 2 previous errors\n-\n-For more information about this error, try `rustc --explain E0658`."}, {"sha": "a38731ceb8a860995727c9ef926454e75410b905", "filename": "src/test/ui/consts/const_in_pattern/custom-eq-branch-pass.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcustom-eq-branch-pass.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcustom-eq-branch-pass.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcustom-eq-branch-pass.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,6 +1,5 @@\n // run-pass\n \n-#![feature(const_if_match)]\n #![warn(indirect_structural_match)]\n \n struct CustomEq;"}, {"sha": "a1f9838ca088573ba7c595c2e7ac0512cdfacbfc", "filename": "src/test/ui/consts/const_in_pattern/custom-eq-branch-warn.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcustom-eq-branch-warn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcustom-eq-branch-warn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcustom-eq-branch-warn.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,6 +1,5 @@\n // check-pass\n \n-#![feature(const_if_match)]\n #![warn(indirect_structural_match)]\n //~^ NOTE lint level is defined here\n "}, {"sha": "0be1cca806ed1bedcbbe6794a7c4e42796063501", "filename": "src/test/ui/consts/const_in_pattern/custom-eq-branch-warn.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcustom-eq-branch-warn.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcustom-eq-branch-warn.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fcustom-eq-branch-warn.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,11 +1,11 @@\n warning: to use a constant of type `CustomEq` in a pattern, `CustomEq` must be annotated with `#[derive(PartialEq, Eq)]`\n-  --> $DIR/custom-eq-branch-warn.rs:33:9\n+  --> $DIR/custom-eq-branch-warn.rs:32:9\n    |\n LL |         BAR_BAZ => panic!(),\n    |         ^^^^^^^\n    |\n note: the lint level is defined here\n-  --> $DIR/custom-eq-branch-warn.rs:4:9\n+  --> $DIR/custom-eq-branch-warn.rs:3:9\n    |\n LL | #![warn(indirect_structural_match)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^"}, {"sha": "c7f02c615a02a75bff67836a40bed0a5e0309fff", "filename": "src/test/ui/consts/const_in_pattern/no-eq-branch-fail.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fno-eq-branch-fail.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fno-eq-branch-fail.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fno-eq-branch-fail.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,4 +1,3 @@\n-#![feature(const_if_match)]\n #![warn(indirect_structural_match)]\n \n struct NoEq;"}, {"sha": "ee78c6f5c3e9f9206b603857e0372ed5d104027d", "filename": "src/test/ui/consts/const_in_pattern/no-eq-branch-fail.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fno-eq-branch-fail.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fno-eq-branch-fail.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_in_pattern%2Fno-eq-branch-fail.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,11 +1,11 @@\n error: to use a constant of type `Foo` in a pattern, `Foo` must be annotated with `#[derive(PartialEq, Eq)]`\n-  --> $DIR/no-eq-branch-fail.rs:22:9\n+  --> $DIR/no-eq-branch-fail.rs:21:9\n    |\n LL |         BAR_BAZ => panic!(),\n    |         ^^^^^^^\n \n error: to use a constant of type `Foo` in a pattern, `Foo` must be annotated with `#[derive(PartialEq, Eq)]`\n-  --> $DIR/no-eq-branch-fail.rs:22:9\n+  --> $DIR/no-eq-branch-fail.rs:21:9\n    |\n LL |         BAR_BAZ => panic!(),\n    |         ^^^^^^^"}, {"sha": "efb134d2eef1ad5049c235ca0ff318bd26e65eb5", "filename": "src/test/ui/consts/const_let_refutable.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_let_refutable.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_let_refutable.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_let_refutable.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -2,6 +2,5 @@ fn main() {}\n \n const fn slice(&[a, b]: &[i32]) -> i32 {\n     //~^ ERROR refutable pattern in function argument\n-    //~| ERROR loops and conditional expressions are not stable in const fn\n     a + b\n }"}, {"sha": "d7e8c048f7dcce7ae8ad7c4b4a7f10f1707ee29e", "filename": "src/test/ui/consts/const_let_refutable.stderr", "status": "modified", "additions": 2, "deletions": 12, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_let_refutable.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_let_refutable.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_let_refutable.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -6,16 +6,6 @@ LL | const fn slice(&[a, b]: &[i32]) -> i32 {\n    |\n    = note: the matched value is of type `&[i32]`\n \n-error[E0723]: loops and conditional expressions are not stable in const fn\n-  --> $DIR/const_let_refutable.rs:3:17\n-   |\n-LL | const fn slice(&[a, b]: &[i32]) -> i32 {\n-   |                 ^^^^^^\n-   |\n-   = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n-   = help: add `#![feature(const_fn)]` to the crate attributes to enable\n-\n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n \n-Some errors have detailed explanations: E0005, E0723.\n-For more information about an error, try `rustc --explain E0005`.\n+For more information about this error, try `rustc --explain E0005`."}, {"sha": "fa56de065ae8728939e314802f9f464338013ba3", "filename": "src/test/ui/consts/const_limit/const_eval_limit_not_reached.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_not_reached.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_not_reached.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_not_reached.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,7 +1,7 @@\n // check-pass\n \n #![feature(const_eval_limit)]\n-#![feature(const_loop, const_if_match)]\n+#![feature(const_loop)]\n \n // This needs to be higher than the number of loop iterations since each pass through the loop may\n // hit more than one terminator."}, {"sha": "a98a17f95d21f87595cbe4435c8286591f89f076", "filename": "src/test/ui/consts/const_limit/const_eval_limit_reached.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_reached.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_reached.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_reached.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,7 +1,6 @@\n #![feature(const_eval_limit)]\n-#![feature(const_loop, const_if_match)]\n-\n-#![const_eval_limit=\"500\"]\n+#![feature(const_loop)]\n+#![const_eval_limit = \"500\"]\n \n const X: usize = {\n     let mut x = 0;"}, {"sha": "2c4f4ebd99ae6ae65dcb5079b98f91406dff7e23", "filename": "src/test/ui/consts/const_limit/const_eval_limit_reached.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_reached.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_reached.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_limit%2Fconst_eval_limit_reached.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,5 +1,5 @@\n error: any use of this value will cause an error\n-  --> $DIR/const_eval_limit_reached.rs:8:5\n+  --> $DIR/const_eval_limit_reached.rs:7:11\n    |\n LL |  / const X: usize = {\n LL |  |     let mut x = 0;"}, {"sha": "6403fbb17dd58ded8f5781992effcee065ba970a", "filename": "src/test/ui/consts/const_short_circuit.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_short_circuit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fconst_short_circuit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_short_circuit.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,13 +1,13 @@\n+// check-pass\n+\n const _: bool = false && false;\n const _: bool = true && false;\n const _: bool = {\n     let mut x = true && false;\n-    //~^ ERROR new features like let bindings are not permitted\n     x\n };\n const _: bool = {\n     let x = true && false;\n-    //~^ ERROR new features like let bindings are not permitted\n     x\n };\n "}, {"sha": "b020382af07c87621af056c72792b2cdc4d4915e", "filename": "src/test/ui/consts/const_short_circuit.stderr", "status": "removed", "additions": 0, "deletions": 26, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fconst_short_circuit.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fconst_short_circuit.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst_short_circuit.stderr?ref=696084c764e5fe3a318eb75a180763fdeab194da", "patch": "@@ -1,26 +0,0 @@\n-error: new features like let bindings are not permitted in constants which also use short circuiting operators\n-  --> $DIR/const_short_circuit.rs:4:9\n-   |\n-LL |     let mut x = true && false;\n-   |         ^^^^^\n-   |\n-note: use of `&&` operator here does not actually short circuit due to the const evaluator presently not being able to do control flow. See issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information.\n-  --> $DIR/const_short_circuit.rs:4:22\n-   |\n-LL |     let mut x = true && false;\n-   |                      ^^\n-\n-error: new features like let bindings are not permitted in constants which also use short circuiting operators\n-  --> $DIR/const_short_circuit.rs:9:9\n-   |\n-LL |     let x = true && false;\n-   |         ^\n-   |\n-note: use of `&&` operator here does not actually short circuit due to the const evaluator presently not being able to do control flow. See issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information.\n-  --> $DIR/const_short_circuit.rs:9:18\n-   |\n-LL |     let x = true && false;\n-   |                  ^^\n-\n-error: aborting due to 2 previous errors\n-"}, {"sha": "7dd60cfb5458fd6973bbda97ea0b01569638fc0b", "filename": "src/test/ui/consts/control-flow/assert.both.stderr", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fassert.both.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fassert.both.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fassert.both.stderr?ref=696084c764e5fe3a318eb75a180763fdeab194da", "patch": "@@ -1,13 +0,0 @@\n-error: any use of this value will cause an error\n-  --> $DIR/assert.rs:12:15\n-   |\n-LL | const _: () = assert!(false);\n-   | --------------^^^^^^^^^^^^^^-\n-   |               |\n-   |               the evaluated program panicked at 'assertion failed: false', $DIR/assert.rs:12:15\n-   |\n-   = note: `#[deny(const_err)]` on by default\n-   = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\n-\n-error: aborting due to previous error\n-"}, {"sha": "466fb7c3ec5b1a1c28af9bf7ebb6a94bb83954a2", "filename": "src/test/ui/consts/control-flow/assert.if_match.stderr", "status": "removed", "additions": 0, "deletions": 23, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fassert.if_match.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fassert.if_match.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fassert.if_match.stderr?ref=696084c764e5fe3a318eb75a180763fdeab194da", "patch": "@@ -1,23 +0,0 @@\n-error[E0658]: panicking in constants is unstable\n-  --> $DIR/assert.rs:8:15\n-   |\n-LL | const _: () = assert!(true);\n-   |               ^^^^^^^^^^^^^\n-   |\n-   = note: see issue #51999 <https://github.com/rust-lang/rust/issues/51999> for more information\n-   = help: add `#![feature(const_panic)]` to the crate attributes to enable\n-   = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\n-\n-error[E0658]: panicking in constants is unstable\n-  --> $DIR/assert.rs:12:15\n-   |\n-LL | const _: () = assert!(false);\n-   |               ^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #51999 <https://github.com/rust-lang/rust/issues/51999> for more information\n-   = help: add `#![feature(const_panic)]` to the crate attributes to enable\n-   = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\n-\n-error: aborting due to 2 previous errors\n-\n-For more information about this error, try `rustc --explain E0658`."}, {"sha": "03662a352090927a1e25d7504c08c43e7bcfd029", "filename": "src/test/ui/consts/control-flow/assert.panic.stderr", "status": "modified", "additions": 7, "deletions": 17, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fassert.panic.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fassert.panic.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fassert.panic.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,23 +1,13 @@\n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/assert.rs:8:15\n-   |\n-LL | const _: () = assert!(true);\n-   |               ^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-   = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\n-\n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/assert.rs:12:15\n+error: any use of this value will cause an error\n+  --> $DIR/assert.rs:10:15\n    |\n LL | const _: () = assert!(false);\n-   |               ^^^^^^^^^^^^^^\n+   | --------------^^^^^^^^^^^^^^-\n+   |               |\n+   |               the evaluated program panicked at 'assertion failed: false', $DIR/assert.rs:10:15\n    |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n+   = note: `#[deny(const_err)]` on by default\n    = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\n \n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0658`."}, {"sha": "30cd31ee8a734bcb9eea457e8f8d6c7be06d61d7", "filename": "src/test/ui/consts/control-flow/assert.rs", "status": "modified", "additions": 6, "deletions": 9, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fassert.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fassert.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fassert.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,17 +1,14 @@\n-// Test that `assert` works only when both `const_if_match` and `const_panic` are enabled.\n+// Test that `assert` works when `const_panic` is enabled.\n \n-// revisions: stock if_match panic both\n+// revisions: stock panic\n \n-#![cfg_attr(any(both, if_match), feature(const_if_match))]\n-#![cfg_attr(any(both, panic), feature(const_panic))]\n+#![cfg_attr(panic, feature(const_panic))]\n \n const _: () = assert!(true);\n-//[stock,panic]~^ ERROR `if` is not allowed in a `const`\n-//[if_match]~^^ ERROR panicking in constants is unstable\n+//[stock]~^ ERROR panicking in constants is unstable\n \n const _: () = assert!(false);\n-//[stock,panic]~^ ERROR `if` is not allowed in a `const`\n-//[if_match]~^^ ERROR panicking in constants is unstable\n-//[both]~^^^ ERROR any use of this value will cause an error\n+//[stock]~^ ERROR panicking in constants is unstable\n+//[panic]~^^ ERROR any use of this value will cause an error\n \n fn main() {}"}, {"sha": "fd344533ce10fe4f19677982f9d81fd0de0897ba", "filename": "src/test/ui/consts/control-flow/assert.stock.stderr", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fassert.stock.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fassert.stock.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fassert.stock.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,21 +1,21 @@\n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/assert.rs:8:15\n+error[E0658]: panicking in constants is unstable\n+  --> $DIR/assert.rs:7:15\n    |\n LL | const _: () = assert!(true);\n    |               ^^^^^^^^^^^^^\n    |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n+   = note: see issue #51999 <https://github.com/rust-lang/rust/issues/51999> for more information\n+   = help: add `#![feature(const_panic)]` to the crate attributes to enable\n    = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\n \n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/assert.rs:12:15\n+error[E0658]: panicking in constants is unstable\n+  --> $DIR/assert.rs:10:15\n    |\n LL | const _: () = assert!(false);\n    |               ^^^^^^^^^^^^^^\n    |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n+   = note: see issue #51999 <https://github.com/rust-lang/rust/issues/51999> for more information\n+   = help: add `#![feature(const_panic)]` to the crate attributes to enable\n    = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\n \n error: aborting due to 2 previous errors"}, {"sha": "3701f349d0703b98b4e1e34f9209489a22f5e297", "filename": "src/test/ui/consts/control-flow/basics.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fbasics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fbasics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fbasics.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -3,7 +3,6 @@\n // run-pass\n \n #![feature(const_panic)]\n-#![feature(const_if_match)]\n #![feature(const_loop)]\n #![feature(const_fn)]\n "}, {"sha": "f4edfaf72bed5b8eec47c4dafec90465b0a4c147", "filename": "src/test/ui/consts/control-flow/drop-fail.precise.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fdrop-fail.precise.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fdrop-fail.precise.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fdrop-fail.precise.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,11 +1,11 @@\n error[E0493]: destructors cannot be evaluated at compile-time\n-  --> $DIR/drop-fail.rs:10:9\n+  --> $DIR/drop-fail.rs:9:9\n    |\n LL |     let x = Some(Vec::new());\n    |         ^ constants cannot evaluate destructors\n \n error[E0493]: destructors cannot be evaluated at compile-time\n-  --> $DIR/drop-fail.rs:41:9\n+  --> $DIR/drop-fail.rs:40:9\n    |\n LL |     let mut tmp = None;\n    |         ^^^^^^^ constants cannot evaluate destructors"}, {"sha": "94deeb8c54ca59980d19c12f0db59e10619bfe72", "filename": "src/test/ui/consts/control-flow/drop-fail.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fdrop-fail.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fdrop-fail.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fdrop-fail.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,6 +1,5 @@\n // revisions: stock precise\n \n-#![feature(const_if_match)]\n #![feature(const_loop)]\n #![cfg_attr(precise, feature(const_precise_live_drops))]\n "}, {"sha": "94734222117f5c824743c1743157c4fd053c0c76", "filename": "src/test/ui/consts/control-flow/drop-fail.stock.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fdrop-fail.stock.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fdrop-fail.stock.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fdrop-fail.stock.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,5 +1,5 @@\n error[E0493]: destructors cannot be evaluated at compile-time\n-  --> $DIR/drop-fail.rs:10:9\n+  --> $DIR/drop-fail.rs:9:9\n    |\n LL |     let x = Some(Vec::new());\n    |         ^ constants cannot evaluate destructors\n@@ -8,7 +8,7 @@ LL | };\n    | - value is dropped here\n \n error[E0493]: destructors cannot be evaluated at compile-time\n-  --> $DIR/drop-fail.rs:23:9\n+  --> $DIR/drop-fail.rs:22:9\n    |\n LL |     let vec_tuple = (Vec::new(),);\n    |         ^^^^^^^^^ constants cannot evaluate destructors\n@@ -17,7 +17,7 @@ LL | };\n    | - value is dropped here\n \n error[E0493]: destructors cannot be evaluated at compile-time\n-  --> $DIR/drop-fail.rs:31:9\n+  --> $DIR/drop-fail.rs:30:9\n    |\n LL |     let x: Result<_, Vec<i32>> = Ok(Vec::new());\n    |         ^ constants cannot evaluate destructors\n@@ -26,7 +26,7 @@ LL | };\n    | - value is dropped here\n \n error[E0493]: destructors cannot be evaluated at compile-time\n-  --> $DIR/drop-fail.rs:41:9\n+  --> $DIR/drop-fail.rs:40:9\n    |\n LL |     let mut tmp = None;\n    |         ^^^^^^^ constants cannot evaluate destructors"}, {"sha": "2ef8e08d7449881b0cd19041751c0b0d603bc2ab", "filename": "src/test/ui/consts/control-flow/drop-pass.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fdrop-pass.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fdrop-pass.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fdrop-pass.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,7 +1,6 @@\n // run-pass\n // revisions: stock precise\n \n-#![feature(const_if_match)]\n #![feature(const_loop)]\n #![cfg_attr(precise, feature(const_precise_live_drops))]\n "}, {"sha": "058c5608ec1b10b3d19f4cb502f24ccddeb04d0a", "filename": "src/test/ui/consts/control-flow/drop-precise.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fdrop-precise.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fdrop-precise.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fdrop-precise.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,7 +1,6 @@\n // run-pass\n // gate-test-const_precise_live_drops\n \n-#![feature(const_if_match)]\n #![feature(const_loop)]\n #![feature(const_precise_live_drops)]\n "}, {"sha": "4320133dfdbcc8a4709dcc8de70f6071fd32054d", "filename": "src/test/ui/consts/control-flow/exhaustive-c-like-enum-match.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fexhaustive-c-like-enum-match.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fexhaustive-c-like-enum-match.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fexhaustive-c-like-enum-match.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -2,8 +2,6 @@\n \n // check-pass\n \n-#![feature(const_if_match)]\n-\n enum E {\n     A,\n     B,"}, {"sha": "21e3f2af15ad6280ce4ca9b38300f7a023126f5f", "filename": "src/test/ui/consts/control-flow/feature-gate-const-if-match.if_match.stderr", "status": "removed", "additions": 0, "deletions": 14, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Ffeature-gate-const-if-match.if_match.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Ffeature-gate-const-if-match.if_match.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Ffeature-gate-const-if-match.if_match.stderr?ref=696084c764e5fe3a318eb75a180763fdeab194da", "patch": "@@ -1,14 +0,0 @@\n-error: fatal error triggered by #[rustc_error]\n-  --> $DIR/feature-gate-const-if-match.rs:108:1\n-   |\n-LL | / fn main() {\n-LL | |     let _ = [0; {\n-LL | |         let x = if false { 0 } else { 1 };\n-LL | |\n-...  |\n-LL | |     }];\n-LL | | }\n-   | |_^\n-\n-error: aborting due to previous error\n-"}, {"sha": "cb66bc75309b63447612744c4a239e29380f01e0", "filename": "src/test/ui/consts/control-flow/feature-gate-const-if-match.rs", "status": "modified", "additions": 37, "deletions": 58, "changes": 95, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Ffeature-gate-const-if-match.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Ffeature-gate-const-if-match.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Ffeature-gate-const-if-match.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,117 +1,96 @@\n-// Ensure that `if`, `if let` and `match` are only allowed in the various const contexts when\n-// `#![feature(const_if_match)]` is enabled. When the feature gate is removed, the `#[rustc_error]`\n-// on `main` should be removed and this test converted to `check-pass`.\n+// check-pass\n \n-// revisions: stock if_match\n+const _: i32 = if true { 5 } else { 6 };\n \n-#![feature(rustc_attrs)]\n-#![cfg_attr(if_match, feature(const_if_match))]\n+const _: i32 = if let Some(true) = Some(false) { 0 } else { 1 };\n \n-const _: i32 = if true { //[stock]~ ERROR `if` is not allowed in a `const`\n-    5\n-} else {\n-    6\n-};\n-\n-const _: i32 = if let Some(true) = Some(false) { //[stock]~ ERROR `if` is not allowed in a `const`\n-    0\n-} else {\n-    1\n-};\n-\n-const _: i32 = match 1 { //[stock]~ ERROR `match` is not allowed in a `const`\n+const _: i32 = match 1 {\n     2 => 3,\n     4 => 5,\n     _ => 0,\n };\n \n static FOO: i32 = {\n     let x = if true { 0 } else { 1 };\n-    //[stock]~^ ERROR `if` is not allowed in a `static`\n-    let x = match x { 0 => 1, _ => 0 };\n-    //[stock]~^ ERROR `match` is not allowed in a `static`\n+    let x = match x {\n+        0 => 1,\n+        _ => 0,\n+    };\n     if let Some(x) = Some(x) { x } else { 1 }\n-    //[stock]~^ ERROR `if` is not allowed in a `static`\n };\n \n static mut BAR: i32 = {\n     let x = if true { 0 } else { 1 };\n-    //[stock]~^ ERROR `if` is not allowed in a `static mut`\n-    let x = match x { 0 => 1, _ => 0 };\n-    //[stock]~^ ERROR `match` is not allowed in a `static mut`\n+    let x = match x {\n+        0 => 1,\n+        _ => 0,\n+    };\n     if let Some(x) = Some(x) { x } else { 1 }\n-    //[stock]~^ ERROR `if` is not allowed in a `static mut`\n };\n \n const fn if_() -> i32 {\n-    if true { 5 } else { 6 } //[stock]~ ERROR `if` is not allowed in a `const fn`\n+    if true { 5 } else { 6 }\n }\n \n const fn if_let(a: Option<bool>) -> i32 {\n-    if let Some(true) = a { //[stock]~ ERROR `if` is not allowed in a `const fn`\n-        0\n-    } else {\n-        1\n-    }\n+    if let Some(true) = a { 0 } else { 1 }\n }\n \n const fn match_(i: i32) -> i32 {\n-    match i { //[stock]~ ERROR `match` is not allowed in a `const fn`\n+    match i {\n         i if i > 10 => i,\n         1 => 2,\n-        _ => 0\n+        _ => 0,\n     }\n }\n \n pub trait Foo {\n     const IF: i32 = if true { 5 } else { 6 };\n-    //[stock]~^ ERROR `if` is not allowed in a `const`\n-\n     const IF_LET: i32 = if let Some(true) = None { 5 } else { 6 };\n-    //[stock]~^ ERROR `if` is not allowed in a `const`\n-\n-    const MATCH: i32 = match 0 { 1 => 2, _ => 0 };\n-    //[stock]~^ ERROR `match` is not allowed in a `const`\n+    const MATCH: i32 = match 0 {\n+        1 => 2,\n+        _ => 0,\n+    };\n }\n \n impl Foo for () {\n     const IF: i32 = if true { 5 } else { 6 };\n-    //[stock]~^ ERROR `if` is not allowed in a `const`\n-\n     const IF_LET: i32 = if let Some(true) = None { 5 } else { 6 };\n-    //[stock]~^ ERROR `if` is not allowed in a `const`\n-\n-    const MATCH: i32 = match 0 { 1 => 2, _ => 0 };\n-    //[stock]~^ ERROR `match` is not allowed in a `const`\n+    const MATCH: i32 = match 0 {\n+        1 => 2,\n+        _ => 0,\n+    };\n }\n \n fn non_const_outside() {\n     const fn const_inside(y: bool) -> i32 {\n         let x = if y { 0 } else { 1 };\n-        //[stock]~^ ERROR `if` is not allowed in a `const fn`\n-        let x = match x { 0 => 1, _ => 0 };\n-        //[stock]~^ ERROR `match` is not allowed in a `const fn`\n+        let x = match x {\n+            0 => 1,\n+            _ => 0,\n+        };\n         if let Some(x) = Some(x) { x } else { 1 }\n-        //[stock]~^ ERROR `if` is not allowed in a `const fn`\n     }\n }\n \n const fn const_outside() {\n     fn non_const_inside(y: bool) -> i32 {\n         let x = if y { 0 } else { 1 };\n-        let x = match x { 0 => 1, _ => 0 };\n+        let x = match x {\n+            0 => 1,\n+            _ => 0,\n+        };\n         if let Some(x) = Some(x) { x } else { 1 }\n     }\n }\n \n-#[rustc_error]\n-fn main() { //[if_match]~ ERROR fatal error triggered by #[rustc_error]\n+fn main() {\n     let _ = [0; {\n         let x = if false { 0 } else { 1 };\n-        //[stock]~^ ERROR `if` is not allowed in a `const`\n-        let x = match x { 0 => 1, _ => 0 };\n-        //[stock]~^ ERROR `match` is not allowed in a `const`\n+        let x = match x {\n+            0 => 1,\n+            _ => 0,\n+        };\n         if let Some(x) = Some(x) { x } else { 1 }\n-        //[stock]~^ ERROR `if` is not allowed in a `const`\n     }];\n }"}, {"sha": "b27971dccac6c3766f61725851848fb8a201195e", "filename": "src/test/ui/consts/control-flow/feature-gate-const-if-match.stock.stderr", "status": "removed", "additions": 0, "deletions": 242, "changes": 242, "blob_url": "https://github.com/rust-lang/rust/blob/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Ffeature-gate-const-if-match.stock.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Ffeature-gate-const-if-match.stock.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Ffeature-gate-const-if-match.stock.stderr?ref=696084c764e5fe3a318eb75a180763fdeab194da", "patch": "@@ -1,242 +0,0 @@\n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/feature-gate-const-if-match.rs:10:16\n-   |\n-LL |   const _: i32 = if true {\n-   |  ________________^\n-LL | |     5\n-LL | | } else {\n-LL | |     6\n-LL | | };\n-   | |_^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/feature-gate-const-if-match.rs:16:16\n-   |\n-LL |   const _: i32 = if let Some(true) = Some(false) {\n-   |  ________________^\n-LL | |     0\n-LL | | } else {\n-LL | |     1\n-LL | | };\n-   | |_^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `match` is not allowed in a `const`\n-  --> $DIR/feature-gate-const-if-match.rs:22:16\n-   |\n-LL |   const _: i32 = match 1 {\n-   |  ________________^\n-LL | |     2 => 3,\n-LL | |     4 => 5,\n-LL | |     _ => 0,\n-LL | | };\n-   | |_^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `if` is not allowed in a `static`\n-  --> $DIR/feature-gate-const-if-match.rs:29:13\n-   |\n-LL |     let x = if true { 0 } else { 1 };\n-   |             ^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `match` is not allowed in a `static`\n-  --> $DIR/feature-gate-const-if-match.rs:31:13\n-   |\n-LL |     let x = match x { 0 => 1, _ => 0 };\n-   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `if` is not allowed in a `static`\n-  --> $DIR/feature-gate-const-if-match.rs:33:5\n-   |\n-LL |     if let Some(x) = Some(x) { x } else { 1 }\n-   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `if` is not allowed in a `static mut`\n-  --> $DIR/feature-gate-const-if-match.rs:38:13\n-   |\n-LL |     let x = if true { 0 } else { 1 };\n-   |             ^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `match` is not allowed in a `static mut`\n-  --> $DIR/feature-gate-const-if-match.rs:40:13\n-   |\n-LL |     let x = match x { 0 => 1, _ => 0 };\n-   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `if` is not allowed in a `static mut`\n-  --> $DIR/feature-gate-const-if-match.rs:42:5\n-   |\n-LL |     if let Some(x) = Some(x) { x } else { 1 }\n-   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `if` is not allowed in a `const fn`\n-  --> $DIR/feature-gate-const-if-match.rs:47:5\n-   |\n-LL |     if true { 5 } else { 6 }\n-   |     ^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `if` is not allowed in a `const fn`\n-  --> $DIR/feature-gate-const-if-match.rs:51:5\n-   |\n-LL | /     if let Some(true) = a {\n-LL | |         0\n-LL | |     } else {\n-LL | |         1\n-LL | |     }\n-   | |_____^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `match` is not allowed in a `const fn`\n-  --> $DIR/feature-gate-const-if-match.rs:59:5\n-   |\n-LL | /     match i {\n-LL | |         i if i > 10 => i,\n-LL | |         1 => 2,\n-LL | |         _ => 0\n-LL | |     }\n-   | |_____^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `if` is not allowed in a `const fn`\n-  --> $DIR/feature-gate-const-if-match.rs:90:17\n-   |\n-LL |         let x = if y { 0 } else { 1 };\n-   |                 ^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `match` is not allowed in a `const fn`\n-  --> $DIR/feature-gate-const-if-match.rs:92:17\n-   |\n-LL |         let x = match x { 0 => 1, _ => 0 };\n-   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `if` is not allowed in a `const fn`\n-  --> $DIR/feature-gate-const-if-match.rs:94:9\n-   |\n-LL |         if let Some(x) = Some(x) { x } else { 1 }\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/feature-gate-const-if-match.rs:110:17\n-   |\n-LL |         let x = if false { 0 } else { 1 };\n-   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `match` is not allowed in a `const`\n-  --> $DIR/feature-gate-const-if-match.rs:112:17\n-   |\n-LL |         let x = match x { 0 => 1, _ => 0 };\n-   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/feature-gate-const-if-match.rs:114:9\n-   |\n-LL |         if let Some(x) = Some(x) { x } else { 1 }\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/feature-gate-const-if-match.rs:67:21\n-   |\n-LL |     const IF: i32 = if true { 5 } else { 6 };\n-   |                     ^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/feature-gate-const-if-match.rs:70:25\n-   |\n-LL |     const IF_LET: i32 = if let Some(true) = None { 5 } else { 6 };\n-   |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `match` is not allowed in a `const`\n-  --> $DIR/feature-gate-const-if-match.rs:73:24\n-   |\n-LL |     const MATCH: i32 = match 0 { 1 => 2, _ => 0 };\n-   |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/feature-gate-const-if-match.rs:78:21\n-   |\n-LL |     const IF: i32 = if true { 5 } else { 6 };\n-   |                     ^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/feature-gate-const-if-match.rs:81:25\n-   |\n-LL |     const IF_LET: i32 = if let Some(true) = None { 5 } else { 6 };\n-   |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `match` is not allowed in a `const`\n-  --> $DIR/feature-gate-const-if-match.rs:84:24\n-   |\n-LL |     const MATCH: i32 = match 0 { 1 => 2, _ => 0 };\n-   |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error: aborting due to 24 previous errors\n-\n-For more information about this error, try `rustc --explain E0658`."}, {"sha": "cabdf4a929b1af4b22d128c3e88911097c5747f1", "filename": "src/test/ui/consts/control-flow/interior-mutability.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Finterior-mutability.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Finterior-mutability.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Finterior-mutability.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,7 +1,6 @@\n // Ensure that *any* assignment to the return place of a value with interior mutability\n // disqualifies it from promotion.\n \n-#![feature(const_if_match)]\n #![feature(const_loop)]\n \n use std::cell::Cell;\n@@ -39,7 +38,6 @@ const Z: Option<Cell<i32>> = {\n     z\n };\n \n-\n fn main() {\n     let x: &'static _ = &X; //~ ERROR temporary value dropped while borrowed\n     let y: &'static _ = &Y; //~ ERROR temporary value dropped while borrowed"}, {"sha": "8f18ae1816a4073d33295e082fad0fade96d0df4", "filename": "src/test/ui/consts/control-flow/interior-mutability.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Finterior-mutability.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Finterior-mutability.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Finterior-mutability.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,5 +1,5 @@\n error[E0716]: temporary value dropped while borrowed\n-  --> $DIR/interior-mutability.rs:44:26\n+  --> $DIR/interior-mutability.rs:42:26\n    |\n LL |     let x: &'static _ = &X;\n    |            ----------    ^ creates a temporary which is freed while still in use\n@@ -10,7 +10,7 @@ LL | }\n    | - temporary value is freed at the end of this statement\n \n error[E0716]: temporary value dropped while borrowed\n-  --> $DIR/interior-mutability.rs:45:26\n+  --> $DIR/interior-mutability.rs:43:26\n    |\n LL |     let y: &'static _ = &Y;\n    |            ----------    ^ creates a temporary which is freed while still in use\n@@ -21,7 +21,7 @@ LL | }\n    | - temporary value is freed at the end of this statement\n \n error[E0716]: temporary value dropped while borrowed\n-  --> $DIR/interior-mutability.rs:46:26\n+  --> $DIR/interior-mutability.rs:44:26\n    |\n LL |     let z: &'static _ = &Z;\n    |            ----------    ^ creates a temporary which is freed while still in use"}, {"sha": "edf62f23266193b667da1d761005cd65908943de", "filename": "src/test/ui/consts/control-flow/issue-46843.rs", "status": "modified", "additions": 5, "deletions": 7, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-46843.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-46843.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-46843.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,16 +1,14 @@\n-// revisions: stock if_match\n-\n-#![cfg_attr(if_match, feature(const_if_match))]\n-\n-enum Thing { This, That }\n+enum Thing {\n+    This,\n+    That,\n+}\n \n fn non_const() -> Thing {\n     Thing::This\n }\n \n pub const Q: i32 = match non_const() {\n-    //[stock]~^ ERROR `match` is not allowed in a `const`\n-    //[if_match]~^^ ERROR calls in constants are limited to constant functions\n+    //~^ ERROR calls in constants are limited to constant functions\n     Thing::This => 1,\n     Thing::That => 0\n };"}, {"sha": "ea9ea25f9e12d34d6bf1e0af16d6b7dda88b9fcf", "filename": "src/test/ui/consts/control-flow/issue-46843.stderr", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-46843.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-46843.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-46843.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,5 +1,5 @@\n error[E0015]: calls in constants are limited to constant functions, tuple structs and tuple variants\n-  --> $DIR/issue-46843.rs:11:26\n+  --> $DIR/issue-46843.rs:10:26\n    |\n LL | pub const Q: i32 = match non_const() {\n    |                          ^^^^^^^^^^^", "previous_filename": "src/test/ui/consts/control-flow/issue-46843.if_match.stderr"}, {"sha": "e4650da2075bdedcd56b287d621a77123fa67c8a", "filename": "src/test/ui/consts/control-flow/issue-46843.stock.stderr", "status": "removed", "additions": 0, "deletions": 18, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-46843.stock.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-46843.stock.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-46843.stock.stderr?ref=696084c764e5fe3a318eb75a180763fdeab194da", "patch": "@@ -1,18 +0,0 @@\n-error[E0658]: `match` is not allowed in a `const`\n-  --> $DIR/issue-46843.rs:11:20\n-   |\n-LL |   pub const Q: i32 = match non_const() {\n-   |  ____________________^\n-LL | |\n-LL | |\n-LL | |     Thing::This => 1,\n-LL | |     Thing::That => 0\n-LL | | };\n-   | |_^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error: aborting due to previous error\n-\n-For more information about this error, try `rustc --explain E0658`."}, {"sha": "beb9a44fca52d28b49094cc850e5ce57dc1f67ff", "filename": "src/test/ui/consts/control-flow/issue-50577.rs", "status": "modified", "additions": 2, "deletions": 9, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-50577.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-50577.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-50577.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,13 +1,6 @@\n-// revisions: stock if_match\n-\n-#![cfg_attr(if_match, feature(const_if_match))]\n-\n fn main() {\n     enum Foo {\n-        Drop = assert_eq!(1, 1)\n-        //[stock,if_match]~^ ERROR `if` may be missing an `else` clause\n-        //[stock]~^^ ERROR `match` is not allowed in a `const`\n-        //[stock]~| ERROR `match` is not allowed in a `const`\n-        //[stock]~| ERROR `if` is not allowed in a `const`\n+        Drop = assert_eq!(1, 1),\n+        //~^ ERROR `if` may be missing an `else` clause\n     }\n }"}, {"sha": "b7b4c3a30d1bf80df11fb746db041b46fb3925f0", "filename": "src/test/ui/consts/control-flow/issue-50577.stderr", "status": "renamed", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-50577.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-50577.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-50577.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,7 +1,7 @@\n error[E0317]: `if` may be missing an `else` clause\n-  --> $DIR/issue-50577.rs:7:16\n+  --> $DIR/issue-50577.rs:3:16\n    |\n-LL |         Drop = assert_eq!(1, 1)\n+LL |         Drop = assert_eq!(1, 1),\n    |                ^^^^^^^^^^^^^^^^\n    |                |\n    |                expected `()`, found `isize`", "previous_filename": "src/test/ui/consts/control-flow/issue-50577.if_match.stderr"}, {"sha": "9d0d2831d9af3a996215fb08670000a913c63b5b", "filename": "src/test/ui/consts/control-flow/issue-50577.stock.stderr", "status": "removed", "additions": 0, "deletions": 47, "changes": 47, "blob_url": "https://github.com/rust-lang/rust/blob/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-50577.stock.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-50577.stock.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fissue-50577.stock.stderr?ref=696084c764e5fe3a318eb75a180763fdeab194da", "patch": "@@ -1,47 +0,0 @@\n-error[E0658]: `match` is not allowed in a `const`\n-  --> $DIR/issue-50577.rs:7:16\n-   |\n-LL |         Drop = assert_eq!(1, 1)\n-   |                ^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-   = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\n-\n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/issue-50577.rs:7:16\n-   |\n-LL |         Drop = assert_eq!(1, 1)\n-   |                ^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-   = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\n-\n-error[E0658]: `match` is not allowed in a `const`\n-  --> $DIR/issue-50577.rs:7:16\n-   |\n-LL |         Drop = assert_eq!(1, 1)\n-   |                ^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-   = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\n-\n-error[E0317]: `if` may be missing an `else` clause\n-  --> $DIR/issue-50577.rs:7:16\n-   |\n-LL |         Drop = assert_eq!(1, 1)\n-   |                ^^^^^^^^^^^^^^^^\n-   |                |\n-   |                expected `()`, found `isize`\n-   |                found here\n-   |\n-   = note: `if` expressions without `else` evaluate to `()`\n-   = help: consider adding an `else` block that evaluates to the expected type\n-   = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\n-\n-error: aborting due to 4 previous errors\n-\n-Some errors have detailed explanations: E0317, E0658.\n-For more information about an error, try `rustc --explain E0317`."}, {"sha": "71d96b216f974a0419cc6c18518c91e2db142adf", "filename": "src/test/ui/consts/control-flow/loop.both.stderr", "status": "removed", "additions": 0, "deletions": 19, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Floop.both.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Floop.both.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Floop.both.stderr?ref=696084c764e5fe3a318eb75a180763fdeab194da", "patch": "@@ -1,19 +0,0 @@\n-error[E0744]: `for` is not allowed in a `const`\n-  --> $DIR/loop.rs:63:5\n-   |\n-LL | /     for i in 0..4 {\n-LL | |         x += i;\n-LL | |     }\n-   | |_____^\n-\n-error[E0744]: `for` is not allowed in a `const`\n-  --> $DIR/loop.rs:67:5\n-   |\n-LL | /     for i in 0..4 {\n-LL | |         x += i;\n-LL | |     }\n-   | |_____^\n-\n-error: aborting due to 2 previous errors\n-\n-For more information about this error, try `rustc --explain E0744`."}, {"sha": "e8ff3624b7720a38e9188013c2b1faad857b8ea2", "filename": "src/test/ui/consts/control-flow/loop.if_match.stderr", "status": "removed", "additions": 0, "deletions": 151, "changes": 151, "blob_url": "https://github.com/rust-lang/rust/blob/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Floop.if_match.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Floop.if_match.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Floop.if_match.stderr?ref=696084c764e5fe3a318eb75a180763fdeab194da", "patch": "@@ -1,151 +0,0 @@\n-error[E0658]: `loop` is not allowed in a `const`\n-  --> $DIR/loop.rs:10:15\n-   |\n-LL | const _: () = loop {};\n-   |               ^^^^^^^\n-   |\n-   = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n-   = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-\n-error[E0658]: `loop` is not allowed in a `static`\n-  --> $DIR/loop.rs:12:19\n-   |\n-LL | static FOO: i32 = loop { break 4; };\n-   |                   ^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n-   = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-\n-error[E0658]: `loop` is not allowed in a `const fn`\n-  --> $DIR/loop.rs:15:5\n-   |\n-LL |     loop {}\n-   |     ^^^^^^^\n-   |\n-   = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n-   = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-\n-error[E0658]: `loop` is not allowed in a `const fn`\n-  --> $DIR/loop.rs:28:9\n-   |\n-LL |         loop {}\n-   |         ^^^^^^^\n-   |\n-   = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n-   = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-\n-error[E0658]: `while` is not allowed in a `const`\n-  --> $DIR/loop.rs:40:9\n-   |\n-LL |         while false {}\n-   |         ^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n-   = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-\n-error[E0658]: `while` is not allowed in a `const`\n-  --> $DIR/loop.rs:49:5\n-   |\n-LL | /     while x < 4 {\n-LL | |         x += 1;\n-LL | |     }\n-   | |_____^\n-   |\n-   = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n-   = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-\n-error[E0658]: `while` is not allowed in a `const`\n-  --> $DIR/loop.rs:53:5\n-   |\n-LL | /     while x < 8 {\n-LL | |         x += 1;\n-LL | |     }\n-   | |_____^\n-   |\n-   = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n-   = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-\n-error[E0744]: `for` is not allowed in a `const`\n-  --> $DIR/loop.rs:63:5\n-   |\n-LL | /     for i in 0..4 {\n-LL | |         x += i;\n-LL | |     }\n-   | |_____^\n-\n-error[E0744]: `for` is not allowed in a `const`\n-  --> $DIR/loop.rs:67:5\n-   |\n-LL | /     for i in 0..4 {\n-LL | |         x += i;\n-LL | |     }\n-   | |_____^\n-\n-error[E0658]: `loop` is not allowed in a `const`\n-  --> $DIR/loop.rs:77:5\n-   |\n-LL | /     loop {\n-LL | |         x += 1;\n-LL | |         if x == 4 {\n-LL | |             break;\n-LL | |         }\n-LL | |     }\n-   | |_____^\n-   |\n-   = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n-   = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-\n-error[E0658]: `loop` is not allowed in a `const`\n-  --> $DIR/loop.rs:84:5\n-   |\n-LL | /     loop {\n-LL | |         x += 1;\n-LL | |         if x == 8 {\n-LL | |             break;\n-LL | |         }\n-LL | |     }\n-   | |_____^\n-   |\n-   = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n-   = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-\n-error[E0658]: `while` is not allowed in a `const`\n-  --> $DIR/loop.rs:96:5\n-   |\n-LL |     while let None = Some(x) { }\n-   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n-   = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-\n-error[E0658]: `while` is not allowed in a `const`\n-  --> $DIR/loop.rs:97:5\n-   |\n-LL |     while let None = Some(x) { }\n-   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n-   = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-\n-error[E0658]: `loop` is not allowed in a `const`\n-  --> $DIR/loop.rs:19:22\n-   |\n-LL |     const BAR: i32 = loop { break 4; };\n-   |                      ^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n-   = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-\n-error[E0658]: `loop` is not allowed in a `const`\n-  --> $DIR/loop.rs:23:22\n-   |\n-LL |     const BAR: i32 = loop { break 4; };\n-   |                      ^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n-   = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-\n-error: aborting due to 15 previous errors\n-\n-Some errors have detailed explanations: E0658, E0744.\n-For more information about an error, try `rustc --explain E0658`."}, {"sha": "c40cee6620e19ac420ff8dabc957d5e08a845ee4", "filename": "src/test/ui/consts/control-flow/loop.loop_.stderr", "status": "modified", "additions": 4, "deletions": 81, "changes": 85, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Floop.loop_.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Floop.loop_.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Floop.loop_.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,96 +1,19 @@\n-error[E0658]: `while` is not allowed in a `const`\n-  --> $DIR/loop.rs:40:9\n-   |\n-LL |         while false {}\n-   |         ^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-   = note: `#![feature(const_loop)]` alone is not sufficient, since this loop expression contains an implicit conditional\n-\n-error[E0658]: `while` is not allowed in a `const`\n-  --> $DIR/loop.rs:49:5\n-   |\n-LL | /     while x < 4 {\n-LL | |         x += 1;\n-LL | |     }\n-   | |_____^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-   = note: `#![feature(const_loop)]` alone is not sufficient, since this loop expression contains an implicit conditional\n-\n-error[E0658]: `while` is not allowed in a `const`\n-  --> $DIR/loop.rs:53:5\n-   |\n-LL | /     while x < 8 {\n-LL | |         x += 1;\n-LL | |     }\n-   | |_____^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-   = note: `#![feature(const_loop)]` alone is not sufficient, since this loop expression contains an implicit conditional\n-\n error[E0744]: `for` is not allowed in a `const`\n-  --> $DIR/loop.rs:63:5\n+  --> $DIR/loop.rs:61:5\n    |\n LL | /     for i in 0..4 {\n LL | |         x += i;\n LL | |     }\n    | |_____^\n \n error[E0744]: `for` is not allowed in a `const`\n-  --> $DIR/loop.rs:67:5\n+  --> $DIR/loop.rs:65:5\n    |\n LL | /     for i in 0..4 {\n LL | |         x += i;\n LL | |     }\n    | |_____^\n \n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/loop.rs:79:9\n-   |\n-LL | /         if x == 4 {\n-LL | |             break;\n-LL | |         }\n-   | |_________^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/loop.rs:86:9\n-   |\n-LL | /         if x == 8 {\n-LL | |             break;\n-LL | |         }\n-   | |_________^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `while` is not allowed in a `const`\n-  --> $DIR/loop.rs:96:5\n-   |\n-LL |     while let None = Some(x) { }\n-   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-   = note: `#![feature(const_loop)]` alone is not sufficient, since this loop expression contains an implicit conditional\n-\n-error[E0658]: `while` is not allowed in a `const`\n-  --> $DIR/loop.rs:97:5\n-   |\n-LL |     while let None = Some(x) { }\n-   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-   = note: `#![feature(const_loop)]` alone is not sufficient, since this loop expression contains an implicit conditional\n-\n-error: aborting due to 9 previous errors\n+error: aborting due to 2 previous errors\n \n-Some errors have detailed explanations: E0658, E0744.\n-For more information about an error, try `rustc --explain E0658`.\n+For more information about this error, try `rustc --explain E0744`."}, {"sha": "30cc3d1b1aff6f5cbfc5cf3bf472629c53745796", "filename": "src/test/ui/consts/control-flow/loop.rs", "status": "modified", "additions": 19, "deletions": 21, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Floop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Floop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Floop.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,31 +1,29 @@\n // Ensure that loops are forbidden in a const context unless `#![feature(const_loop)]` is enabled.\n-// `while` loops require `#![feature(const_if_match)]` to be enabled as well.\n \n // gate-test-const_loop\n-// revisions: stock if_match loop_ both\n+// revisions: stock loop_\n \n-#![cfg_attr(any(both, if_match), feature(const_if_match))]\n-#![cfg_attr(any(both, loop_), feature(const_loop))]\n+#![cfg_attr(loop_, feature(const_loop))]\n \n-const _: () = loop {}; //[stock,if_match]~ ERROR `loop` is not allowed in a `const`\n+const _: () = loop {}; //[stock]~ ERROR `loop` is not allowed in a `const`\n \n-static FOO: i32 = loop { break 4; }; //[stock,if_match]~ ERROR `loop` is not allowed in a `static`\n+static FOO: i32 = loop { break 4; }; //[stock]~ ERROR `loop` is not allowed in a `static`\n \n const fn foo() {\n-    loop {} //[stock,if_match]~ ERROR `loop` is not allowed in a `const fn`\n+    loop {} //[stock]~ ERROR `loop` is not allowed in a `const fn`\n }\n \n pub trait Foo {\n-    const BAR: i32 = loop { break 4; }; //[stock,if_match]~ ERROR `loop` is not allowed in a `const`\n+    const BAR: i32 = loop { break 4; }; //[stock]~ ERROR `loop` is not allowed in a `const`\n }\n \n impl Foo for () {\n-    const BAR: i32 = loop { break 4; }; //[stock,if_match]~ ERROR `loop` is not allowed in a `const`\n+    const BAR: i32 = loop { break 4; }; //[stock]~ ERROR `loop` is not allowed in a `const`\n }\n \n fn non_const_outside() {\n     const fn const_inside() {\n-        loop {} //[stock,if_match]~ ERROR `loop` is not allowed in a `const fn`\n+        loop {} //[stock]~ ERROR `loop` is not allowed in a `const fn`\n     }\n }\n \n@@ -38,19 +36,19 @@ const fn const_outside() {\n fn main() {\n     let x = [0; {\n         while false {}\n-        //[stock,if_match,loop_]~^ ERROR `while` is not allowed in a `const`\n+        //[stock]~^ ERROR `while` is not allowed in a `const`\n         4\n     }];\n }\n \n const _: i32 = {\n     let mut x = 0;\n \n-    while x < 4 { //[stock,if_match,loop_]~ ERROR `while` is not allowed in a `const`\n+    while x < 4 { //[stock]~ ERROR `while` is not allowed in a `const`\n         x += 1;\n     }\n \n-    while x < 8 { //[stock,if_match,loop_]~ ERROR `while` is not allowed in a `const`\n+    while x < 8 { //[stock]~ ERROR `while` is not allowed in a `const`\n         x += 1;\n     }\n \n@@ -60,11 +58,11 @@ const _: i32 = {\n const _: i32 = {\n     let mut x = 0;\n \n-    for i in 0..4 { //[stock,if_match,loop_,both]~ ERROR `for` is not allowed in a `const`\n+    for i in 0..4 { //[stock,loop_]~ ERROR `for` is not allowed in a `const`\n         x += i;\n     }\n \n-    for i in 0..4 { //[stock,if_match,loop_,both]~ ERROR `for` is not allowed in a `const`\n+    for i in 0..4 { //[stock,loop_]~ ERROR `for` is not allowed in a `const`\n         x += i;\n     }\n \n@@ -74,16 +72,16 @@ const _: i32 = {\n const _: i32 = {\n     let mut x = 0;\n \n-    loop { //[stock,if_match]~ ERROR `loop` is not allowed in a `const`\n+    loop { //[stock]~ ERROR `loop` is not allowed in a `const`\n         x += 1;\n-        if x == 4 { //[stock,loop_]~ ERROR `if` is not allowed in a `const`\n+        if x == 4 {\n             break;\n         }\n     }\n \n-    loop { //[stock,if_match]~ ERROR `loop` is not allowed in a `const`\n+    loop { //[stock]~ ERROR `loop` is not allowed in a `const`\n         x += 1;\n-        if x == 8 { //[stock,loop_]~ ERROR `if` is not allowed in a `const`\n+        if x == 8 {\n             break;\n         }\n     }\n@@ -93,7 +91,7 @@ const _: i32 = {\n \n const _: i32 = {\n     let mut x = 0;\n-    while let None = Some(x) { } //[stock,if_match,loop_]~ ERROR `while` is not allowed in a `const`\n-    while let None = Some(x) { } //[stock,if_match,loop_]~ ERROR `while` is not allowed in a `const`\n+    while let None = Some(x) { } //[stock]~ ERROR `while` is not allowed in a `const`\n+    while let None = Some(x) { } //[stock]~ ERROR `while` is not allowed in a `const`\n     x\n };"}, {"sha": "a9ac3929bba18de7eccec93c517142d92bf5b6f4", "filename": "src/test/ui/consts/control-flow/loop.stock.stderr", "status": "modified", "additions": 16, "deletions": 43, "changes": 59, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Floop.stock.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Floop.stock.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Floop.stock.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,5 +1,5 @@\n error[E0658]: `loop` is not allowed in a `const`\n-  --> $DIR/loop.rs:10:15\n+  --> $DIR/loop.rs:8:15\n    |\n LL | const _: () = loop {};\n    |               ^^^^^^^\n@@ -8,7 +8,7 @@ LL | const _: () = loop {};\n    = help: add `#![feature(const_loop)]` to the crate attributes to enable\n \n error[E0658]: `loop` is not allowed in a `static`\n-  --> $DIR/loop.rs:12:19\n+  --> $DIR/loop.rs:10:19\n    |\n LL | static FOO: i32 = loop { break 4; };\n    |                   ^^^^^^^^^^^^^^^^^\n@@ -17,7 +17,7 @@ LL | static FOO: i32 = loop { break 4; };\n    = help: add `#![feature(const_loop)]` to the crate attributes to enable\n \n error[E0658]: `loop` is not allowed in a `const fn`\n-  --> $DIR/loop.rs:15:5\n+  --> $DIR/loop.rs:13:5\n    |\n LL |     loop {}\n    |     ^^^^^^^\n@@ -26,7 +26,7 @@ LL |     loop {}\n    = help: add `#![feature(const_loop)]` to the crate attributes to enable\n \n error[E0658]: `loop` is not allowed in a `const fn`\n-  --> $DIR/loop.rs:28:9\n+  --> $DIR/loop.rs:26:9\n    |\n LL |         loop {}\n    |         ^^^^^^^\n@@ -35,17 +35,16 @@ LL |         loop {}\n    = help: add `#![feature(const_loop)]` to the crate attributes to enable\n \n error[E0658]: `while` is not allowed in a `const`\n-  --> $DIR/loop.rs:40:9\n+  --> $DIR/loop.rs:38:9\n    |\n LL |         while false {}\n    |         ^^^^^^^^^^^^^^\n    |\n    = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n    = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n \n error[E0658]: `while` is not allowed in a `const`\n-  --> $DIR/loop.rs:49:5\n+  --> $DIR/loop.rs:47:5\n    |\n LL | /     while x < 4 {\n LL | |         x += 1;\n@@ -54,10 +53,9 @@ LL | |     }\n    |\n    = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n    = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n \n error[E0658]: `while` is not allowed in a `const`\n-  --> $DIR/loop.rs:53:5\n+  --> $DIR/loop.rs:51:5\n    |\n LL | /     while x < 8 {\n LL | |         x += 1;\n@@ -66,26 +64,25 @@ LL | |     }\n    |\n    = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n    = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n \n error[E0744]: `for` is not allowed in a `const`\n-  --> $DIR/loop.rs:63:5\n+  --> $DIR/loop.rs:61:5\n    |\n LL | /     for i in 0..4 {\n LL | |         x += i;\n LL | |     }\n    | |_____^\n \n error[E0744]: `for` is not allowed in a `const`\n-  --> $DIR/loop.rs:67:5\n+  --> $DIR/loop.rs:65:5\n    |\n LL | /     for i in 0..4 {\n LL | |         x += i;\n LL | |     }\n    | |_____^\n \n error[E0658]: `loop` is not allowed in a `const`\n-  --> $DIR/loop.rs:77:5\n+  --> $DIR/loop.rs:75:5\n    |\n LL | /     loop {\n LL | |         x += 1;\n@@ -98,19 +95,8 @@ LL | |     }\n    = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n    = help: add `#![feature(const_loop)]` to the crate attributes to enable\n \n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/loop.rs:79:9\n-   |\n-LL | /         if x == 4 {\n-LL | |             break;\n-LL | |         }\n-   | |_________^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n error[E0658]: `loop` is not allowed in a `const`\n-  --> $DIR/loop.rs:84:5\n+  --> $DIR/loop.rs:82:5\n    |\n LL | /     loop {\n LL | |         x += 1;\n@@ -123,39 +109,26 @@ LL | |     }\n    = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n    = help: add `#![feature(const_loop)]` to the crate attributes to enable\n \n-error[E0658]: `if` is not allowed in a `const`\n-  --> $DIR/loop.rs:86:9\n-   |\n-LL | /         if x == 8 {\n-LL | |             break;\n-LL | |         }\n-   | |_________^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n error[E0658]: `while` is not allowed in a `const`\n-  --> $DIR/loop.rs:96:5\n+  --> $DIR/loop.rs:94:5\n    |\n LL |     while let None = Some(x) { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |\n    = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n    = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n \n error[E0658]: `while` is not allowed in a `const`\n-  --> $DIR/loop.rs:97:5\n+  --> $DIR/loop.rs:95:5\n    |\n LL |     while let None = Some(x) { }\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |\n    = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n    = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n \n error[E0658]: `loop` is not allowed in a `const`\n-  --> $DIR/loop.rs:19:22\n+  --> $DIR/loop.rs:17:22\n    |\n LL |     const BAR: i32 = loop { break 4; };\n    |                      ^^^^^^^^^^^^^^^^^\n@@ -164,15 +137,15 @@ LL |     const BAR: i32 = loop { break 4; };\n    = help: add `#![feature(const_loop)]` to the crate attributes to enable\n \n error[E0658]: `loop` is not allowed in a `const`\n-  --> $DIR/loop.rs:23:22\n+  --> $DIR/loop.rs:21:22\n    |\n LL |     const BAR: i32 = loop { break 4; };\n    |                      ^^^^^^^^^^^^^^^^^\n    |\n    = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n    = help: add `#![feature(const_loop)]` to the crate attributes to enable\n \n-error: aborting due to 17 previous errors\n+error: aborting due to 15 previous errors\n \n Some errors have detailed explanations: E0658, E0744.\n For more information about an error, try `rustc --explain E0658`."}, {"sha": "4dfa22b8ebaf6310da8333e30a337114288604cd", "filename": "src/test/ui/consts/control-flow/short-circuit-let.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fshort-circuit-let.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fshort-circuit-let.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fshort-circuit-let.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -2,7 +2,6 @@\n \n // run-pass\n \n-#![feature(const_if_match)]\n #![feature(const_panic)]\n \n const X: i32 = {"}, {"sha": "f6ba28e7b7246e64945af31c6e0a75277d50d445", "filename": "src/test/ui/consts/control-flow/short-circuit.if_match.stderr", "status": "removed", "additions": 0, "deletions": 8, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fshort-circuit.if_match.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fshort-circuit.if_match.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fshort-circuit.if_match.stderr?ref=696084c764e5fe3a318eb75a180763fdeab194da", "patch": "@@ -1,8 +0,0 @@\n-error: fatal error triggered by #[rustc_error]\n-  --> $DIR/short-circuit.rs:14:1\n-   |\n-LL | fn main() {}\n-   | ^^^^^^^^^^^^\n-\n-error: aborting due to previous error\n-"}, {"sha": "f6a0f03a4a6b89905560524f34200ae98d03e86f", "filename": "src/test/ui/consts/control-flow/short-circuit.rs", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fshort-circuit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fshort-circuit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fshort-circuit.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,14 +1,14 @@\n-// Test that both `&&` and `||` actually short-circuit when the `const_if_match` feature flag is\n-// enabled. Without the feature flag, both sides are evaluated unconditionally.\n+// run-pass\n \n-// revisions: stock if_match\n+// Test that both `&&` and `||` actually short-circuit.\n+// Formerly, both sides were evaluated unconditionally\n \n-#![feature(rustc_attrs)]\n #![feature(const_panic)]\n-#![cfg_attr(if_match, feature(const_if_match))]\n \n-const _: bool = true || panic!();  //[stock]~ ERROR any use of this value will cause an error\n-const _: bool = false && panic!(); //[stock]~ ERROR any use of this value will cause an error\n+const TRUE: bool = true || panic!();\n+const FALSE: bool = false && panic!();\n \n-#[rustc_error]\n-fn main() {} //[if_match]~ ERROR fatal error triggered by #[rustc_error]\n+fn main() {\n+    assert!(TRUE);\n+    assert!(!FALSE);\n+}"}, {"sha": "f32f248af4557a0255fc7b3485ed52a8423dd6ef", "filename": "src/test/ui/consts/control-flow/short-circuit.stock.stderr", "status": "removed", "additions": 0, "deletions": 23, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fshort-circuit.stock.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fshort-circuit.stock.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fshort-circuit.stock.stderr?ref=696084c764e5fe3a318eb75a180763fdeab194da", "patch": "@@ -1,23 +0,0 @@\n-error: any use of this value will cause an error\n-  --> $DIR/short-circuit.rs:10:25\n-   |\n-LL | const _: bool = true || panic!();\n-   | ------------------------^^^^^^^^-\n-   |                         |\n-   |                         the evaluated program panicked at 'explicit panic', $DIR/short-circuit.rs:10:25\n-   |\n-   = note: `#[deny(const_err)]` on by default\n-   = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\n-\n-error: any use of this value will cause an error\n-  --> $DIR/short-circuit.rs:11:26\n-   |\n-LL | const _: bool = false && panic!();\n-   | -------------------------^^^^^^^^-\n-   |                          |\n-   |                          the evaluated program panicked at 'explicit panic', $DIR/short-circuit.rs:11:26\n-   |\n-   = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)\n-\n-error: aborting due to 2 previous errors\n-"}, {"sha": "b59be00ffb7885943f8be3574fd0de511461c5ce", "filename": "src/test/ui/consts/control-flow/single_variant_match_ice.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fsingle_variant_match_ice.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fsingle_variant_match_ice.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Fsingle_variant_match_ice.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,7 +1,5 @@\n // check-pass\n \n-#![feature(const_if_match)]\n-\n enum Foo {\n     Prob,\n }"}, {"sha": "7d85a412b47226a3015444f6f6bb9b58632de40d", "filename": "src/test/ui/consts/control-flow/try.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Ftry.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Ftry.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Ftry.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,8 +1,6 @@\n // The `?` operator is still not const-evaluatable because it calls `From::from` on the error\n // variant.\n \n-#![feature(const_if_match)]\n-\n const fn opt() -> Option<i32> {\n     let x = Some(2);\n     x?; //~ ERROR `?` is not allowed in a `const fn`"}, {"sha": "35075a3e60b98d3cba64200099064eecf64cbe6e", "filename": "src/test/ui/consts/control-flow/try.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Ftry.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Ftry.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fcontrol-flow%2Ftry.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,5 +1,5 @@\n error[E0744]: `?` is not allowed in a `const fn`\n-  --> $DIR/try.rs:8:5\n+  --> $DIR/try.rs:6:5\n    |\n LL |     x?;\n    |     ^^"}, {"sha": "2ebd9dd10c5123014b2b3b4c6d1c4a72971d8098", "filename": "src/test/ui/consts/min_const_fn/min_const_fn.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -98,13 +98,13 @@ const fn foo30_2(x: *mut u32) -> usize { x as usize }\n const fn foo30_2_with_unsafe(x: *mut u32) -> usize { unsafe { x as usize } }\n //~^ ERROR casting pointers to ints is unstable\n const fn foo30_6() -> bool { let x = true; x }\n-const fn foo36(a: bool, b: bool) -> bool { a && b }\n-//~^ ERROR loops and conditional expressions are not stable in const fn\n-const fn foo37(a: bool, b: bool) -> bool { a || b }\n-//~^ ERROR loops and conditional expressions are not stable in const fn\n const fn inc(x: &mut i32) { *x += 1 }\n //~^ ERROR mutable references in const fn are unstable\n \n+// ok\n+const fn foo36(a: bool, b: bool) -> bool { a && b }\n+const fn foo37(a: bool, b: bool) -> bool { a || b }\n+\n fn main() {}\n \n impl<T: std::fmt::Debug> Foo<T> {"}, {"sha": "9b55b6c6f3bbc97bad469192d7230db86eb9093f", "filename": "src/test/ui/consts/min_const_fn/min_const_fn.stderr", "status": "modified", "additions": 2, "deletions": 20, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -166,26 +166,8 @@ LL | const fn foo30_2_with_unsafe(x: *mut u32) -> usize { unsafe { x as usize }\n    = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n-error[E0723]: loops and conditional expressions are not stable in const fn\n-  --> $DIR/min_const_fn.rs:101:44\n-   |\n-LL | const fn foo36(a: bool, b: bool) -> bool { a && b }\n-   |                                            ^^^^^^\n-   |\n-   = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n-   = help: add `#![feature(const_fn)]` to the crate attributes to enable\n-\n-error[E0723]: loops and conditional expressions are not stable in const fn\n-  --> $DIR/min_const_fn.rs:103:44\n-   |\n-LL | const fn foo37(a: bool, b: bool) -> bool { a || b }\n-   |                                            ^^^^^^\n-   |\n-   = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n-   = help: add `#![feature(const_fn)]` to the crate attributes to enable\n-\n error[E0723]: mutable references in const fn are unstable\n-  --> $DIR/min_const_fn.rs:105:14\n+  --> $DIR/min_const_fn.rs:101:14\n    |\n LL | const fn inc(x: &mut i32) { *x += 1 }\n    |              ^\n@@ -283,7 +265,7 @@ LL | const fn no_fn_ptrs2() -> fn() { fn foo() {} foo }\n    = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n    = help: add `#![feature(const_fn)]` to the crate attributes to enable\n \n-error: aborting due to 32 previous errors\n+error: aborting due to 30 previous errors\n \n Some errors have detailed explanations: E0493, E0723.\n For more information about an error, try `rustc --explain E0493`."}, {"sha": "08d68b039bead295625a4d615868b5ad71cde644", "filename": "src/test/ui/consts/miri_unleashed/const_refers_to_static_cross_crate.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fmiri_unleashed%2Fconst_refers_to_static_cross_crate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fmiri_unleashed%2Fconst_refers_to_static_cross_crate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmiri_unleashed%2Fconst_refers_to_static_cross_crate.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -2,8 +2,7 @@\n // aux-build:static_cross_crate.rs\n #![allow(const_err)]\n \n-// `const_if_match` is a HIR check and thus needed even when unleashed.\n-#![feature(exclusive_range_pattern, half_open_range_patterns, const_if_match)]\n+#![feature(exclusive_range_pattern, half_open_range_patterns)]\n \n extern crate static_cross_crate;\n "}, {"sha": "52662ef9eaf5a0ec1a2aacc78bc0d68149e1f379", "filename": "src/test/ui/consts/miri_unleashed/const_refers_to_static_cross_crate.stderr", "status": "modified", "additions": 24, "deletions": 29, "changes": 53, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fmiri_unleashed%2Fconst_refers_to_static_cross_crate.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Fmiri_unleashed%2Fconst_refers_to_static_cross_crate.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmiri_unleashed%2Fconst_refers_to_static_cross_crate.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,5 +1,5 @@\n error[E0080]: it is undefined behavior to use this value\n-  --> $DIR/const_refers_to_static_cross_crate.rs:12:1\n+  --> $DIR/const_refers_to_static_cross_crate.rs:11:1\n    |\n LL | / const SLICE_MUT: &[u8; 1] = {\n LL | |\n@@ -11,13 +11,13 @@ LL | | };\n    = note: The rules on what exactly is undefined behavior aren't clear, so this check might be overzealous. Please open an issue on the rustc repository if you believe it should not be considered undefined behavior.\n \n error: could not evaluate constant pattern\n-  --> $DIR/const_refers_to_static_cross_crate.rs:40:9\n+  --> $DIR/const_refers_to_static_cross_crate.rs:39:9\n    |\n LL |         SLICE_MUT => true,\n    |         ^^^^^^^^^\n \n error[E0080]: it is undefined behavior to use this value\n-  --> $DIR/const_refers_to_static_cross_crate.rs:18:1\n+  --> $DIR/const_refers_to_static_cross_crate.rs:17:1\n    |\n LL | / const U8_MUT: &u8 = {\n LL | |\n@@ -29,13 +29,13 @@ LL | | };\n    = note: The rules on what exactly is undefined behavior aren't clear, so this check might be overzealous. Please open an issue on the rustc repository if you believe it should not be considered undefined behavior.\n \n error: could not evaluate constant pattern\n-  --> $DIR/const_refers_to_static_cross_crate.rs:49:9\n+  --> $DIR/const_refers_to_static_cross_crate.rs:48:9\n    |\n LL |         U8_MUT => true,\n    |         ^^^^^^\n \n warning: any use of this value will cause an error\n-  --> $DIR/const_refers_to_static_cross_crate.rs:27:14\n+  --> $DIR/const_refers_to_static_cross_crate.rs:26:14\n    |\n LL | / const U8_MUT2: &u8 = {\n LL | |     unsafe { &(*static_cross_crate::ZERO_REF)[0] }\n@@ -46,19 +46,19 @@ LL | | };\n    | |__-\n    |\n note: the lint level is defined here\n-  --> $DIR/const_refers_to_static_cross_crate.rs:25:8\n+  --> $DIR/const_refers_to_static_cross_crate.rs:24:8\n    |\n LL | #[warn(const_err)]\n    |        ^^^^^^^^^\n \n error: could not evaluate constant pattern\n-  --> $DIR/const_refers_to_static_cross_crate.rs:60:9\n+  --> $DIR/const_refers_to_static_cross_crate.rs:59:9\n    |\n LL |         U8_MUT2 => true,\n    |         ^^^^^^^\n \n warning: any use of this value will cause an error\n-  --> $DIR/const_refers_to_static_cross_crate.rs:33:51\n+  --> $DIR/const_refers_to_static_cross_crate.rs:32:51\n    |\n LL | / const U8_MUT3: &u8 = {\n LL | |     unsafe { match static_cross_crate::OPT_ZERO { Some(ref u) => u, None => panic!() } }\n@@ -69,95 +69,90 @@ LL | | };\n    | |__-\n    |\n note: the lint level is defined here\n-  --> $DIR/const_refers_to_static_cross_crate.rs:31:8\n+  --> $DIR/const_refers_to_static_cross_crate.rs:30:8\n    |\n LL | #[warn(const_err)]\n    |        ^^^^^^^^^\n \n error: could not evaluate constant pattern\n-  --> $DIR/const_refers_to_static_cross_crate.rs:68:9\n+  --> $DIR/const_refers_to_static_cross_crate.rs:67:9\n    |\n LL |         U8_MUT3 => true,\n    |         ^^^^^^^\n \n error: could not evaluate constant pattern\n-  --> $DIR/const_refers_to_static_cross_crate.rs:40:9\n+  --> $DIR/const_refers_to_static_cross_crate.rs:39:9\n    |\n LL |         SLICE_MUT => true,\n    |         ^^^^^^^^^\n \n error: could not evaluate constant pattern\n-  --> $DIR/const_refers_to_static_cross_crate.rs:49:9\n+  --> $DIR/const_refers_to_static_cross_crate.rs:48:9\n    |\n LL |         U8_MUT => true,\n    |         ^^^^^^\n \n error: could not evaluate constant pattern\n-  --> $DIR/const_refers_to_static_cross_crate.rs:60:9\n+  --> $DIR/const_refers_to_static_cross_crate.rs:59:9\n    |\n LL |         U8_MUT2 => true,\n    |         ^^^^^^^\n \n error: could not evaluate constant pattern\n-  --> $DIR/const_refers_to_static_cross_crate.rs:68:9\n+  --> $DIR/const_refers_to_static_cross_crate.rs:67:9\n    |\n LL |         U8_MUT3 => true,\n    |         ^^^^^^^\n \n warning: skipping const checks\n    |\n help: skipping check that does not even have a feature gate\n-  --> $DIR/const_refers_to_static_cross_crate.rs:15:15\n+  --> $DIR/const_refers_to_static_cross_crate.rs:14:15\n    |\n LL |     unsafe { &static_cross_crate::ZERO }\n    |               ^^^^^^^^^^^^^^^^^^^^^^^^\n help: skipping check that does not even have a feature gate\n-  --> $DIR/const_refers_to_static_cross_crate.rs:15:15\n+  --> $DIR/const_refers_to_static_cross_crate.rs:14:15\n    |\n LL |     unsafe { &static_cross_crate::ZERO }\n    |               ^^^^^^^^^^^^^^^^^^^^^^^^\n help: skipping check that does not even have a feature gate\n-  --> $DIR/const_refers_to_static_cross_crate.rs:21:15\n+  --> $DIR/const_refers_to_static_cross_crate.rs:20:15\n    |\n LL |     unsafe { &static_cross_crate::ZERO[0] }\n    |               ^^^^^^^^^^^^^^^^^^^^^^^^\n help: skipping check that does not even have a feature gate\n-  --> $DIR/const_refers_to_static_cross_crate.rs:21:15\n+  --> $DIR/const_refers_to_static_cross_crate.rs:20:15\n    |\n LL |     unsafe { &static_cross_crate::ZERO[0] }\n    |               ^^^^^^^^^^^^^^^^^^^^^^^^\n help: skipping check that does not even have a feature gate\n-  --> $DIR/const_refers_to_static_cross_crate.rs:21:15\n+  --> $DIR/const_refers_to_static_cross_crate.rs:20:15\n    |\n LL |     unsafe { &static_cross_crate::ZERO[0] }\n    |               ^^^^^^^^^^^^^^^^^^^^^^^^\n help: skipping check that does not even have a feature gate\n-  --> $DIR/const_refers_to_static_cross_crate.rs:27:17\n+  --> $DIR/const_refers_to_static_cross_crate.rs:26:17\n    |\n LL |     unsafe { &(*static_cross_crate::ZERO_REF)[0] }\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n help: skipping check that does not even have a feature gate\n-  --> $DIR/const_refers_to_static_cross_crate.rs:33:20\n+  --> $DIR/const_refers_to_static_cross_crate.rs:32:20\n    |\n LL |     unsafe { match static_cross_crate::OPT_ZERO { Some(ref u) => u, None => panic!() } }\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n help: skipping check that does not even have a feature gate\n-  --> $DIR/const_refers_to_static_cross_crate.rs:33:20\n-   |\n-LL |     unsafe { match static_cross_crate::OPT_ZERO { Some(ref u) => u, None => panic!() } }\n-   |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-help: skipping check that does not even have a feature gate\n-  --> $DIR/const_refers_to_static_cross_crate.rs:33:20\n+  --> $DIR/const_refers_to_static_cross_crate.rs:32:20\n    |\n LL |     unsafe { match static_cross_crate::OPT_ZERO { Some(ref u) => u, None => panic!() } }\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n help: skipping check for `const_panic` feature\n-  --> $DIR/const_refers_to_static_cross_crate.rs:33:77\n+  --> $DIR/const_refers_to_static_cross_crate.rs:32:77\n    |\n LL |     unsafe { match static_cross_crate::OPT_ZERO { Some(ref u) => u, None => panic!() } }\n    |                                                                             ^^^^^^^^\n help: skipping check that does not even have a feature gate\n-  --> $DIR/const_refers_to_static_cross_crate.rs:33:20\n+  --> $DIR/const_refers_to_static_cross_crate.rs:32:20\n    |\n LL |     unsafe { match static_cross_crate::OPT_ZERO { Some(ref u) => u, None => panic!() } }\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^"}, {"sha": "29d3dc18fa7cc06bdfd1ca168d78073850b9e70b", "filename": "src/test/ui/consts/unstable-const-fn-in-libcore.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Funstable-const-fn-in-libcore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Funstable-const-fn-in-libcore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Funstable-const-fn-in-libcore.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -4,7 +4,6 @@\n // gate was not enabled in libcore.\n \n #![stable(feature = \"core\", since = \"1.6.0\")]\n-#![feature(const_if_match)]\n #![feature(rustc_const_unstable)]\n #![feature(staged_api)]\n "}, {"sha": "be797cae7ca97cfc65320645c77be589f834461c", "filename": "src/test/ui/consts/unstable-const-fn-in-libcore.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Funstable-const-fn-in-libcore.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fconsts%2Funstable-const-fn-in-libcore.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Funstable-const-fn-in-libcore.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,11 +1,11 @@\n error[E0015]: calls in constant functions are limited to constant functions, tuple structs and tuple variants\n-  --> $DIR/unstable-const-fn-in-libcore.rs:24:26\n+  --> $DIR/unstable-const-fn-in-libcore.rs:23:26\n    |\n LL |             Opt::None => f(),\n    |                          ^^^\n \n error[E0493]: destructors cannot be evaluated at compile-time\n-  --> $DIR/unstable-const-fn-in-libcore.rs:19:53\n+  --> $DIR/unstable-const-fn-in-libcore.rs:18:53\n    |\n LL |     const fn unwrap_or_else<F: FnOnce() -> T>(self, f: F) -> T {\n    |                                                     ^ constant functions cannot evaluate destructors\n@@ -14,7 +14,7 @@ LL |     }\n    |     - value is dropped here\n \n error[E0493]: destructors cannot be evaluated at compile-time\n-  --> $DIR/unstable-const-fn-in-libcore.rs:19:47\n+  --> $DIR/unstable-const-fn-in-libcore.rs:18:47\n    |\n LL |     const fn unwrap_or_else<F: FnOnce() -> T>(self, f: F) -> T {\n    |                                               ^^^^ constant functions cannot evaluate destructors"}, {"sha": "b3694bb4216c67eee40e259acab2db9e9e803879", "filename": "src/test/ui/enum-discriminant/niche.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fenum-discriminant%2Fniche.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fenum-discriminant%2Fniche.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fenum-discriminant%2Fniche.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,7 +1,6 @@\n // run-pass\n \n #![feature(const_panic)]\n-#![feature(const_if_match)]\n \n //! Make sure that we read and write enum discriminants correctly for corner cases caused\n //! by layout optimizations."}, {"sha": "a32338c6546cf1e1c0a284aef81fc9a312595f25", "filename": "src/test/ui/internal/internal-unstable-const.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Finternal%2Finternal-unstable-const.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Finternal%2Finternal-unstable-const.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finternal%2Finternal-unstable-const.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,10 +1,12 @@\n+#![stable(feature = \"rust1\", since = \"1.0.0\")]\n+\n #![feature(staged_api)]\n-#![feature(const_if_match)]\n+#![feature(const_loop, const_fn)]\n \n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n #[rustc_const_stable(feature = \"rust1\", since = \"1.0.0\")]\n const fn foo() -> i32 {\n-    if true { 4 } else { 5 } //~ loops and conditional expressions are not stable in const fn\n+    loop { return 42; } //~ ERROR `loop` is not allowed in a `const fn`\n }\n \n fn main() {}"}, {"sha": "a43e014b1c64615d6664bbd8ccb667e106b330ab", "filename": "src/test/ui/internal/internal-unstable-const.stderr", "status": "modified", "additions": 5, "deletions": 8, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Finternal%2Finternal-unstable-const.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Finternal%2Finternal-unstable-const.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Finternal%2Finternal-unstable-const.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,12 +1,9 @@\n-error[E0723]: loops and conditional expressions are not stable in const fn\n-  --> $DIR/internal-unstable-const.rs:7:5\n+error[E0744]: `loop` is not allowed in a `const fn`\n+  --> $DIR/internal-unstable-const.rs:9:5\n    |\n-LL |     if true { 4 } else { 5 }\n-   |     ^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #57563 <https://github.com/rust-lang/rust/issues/57563> for more information\n-   = help: add `#![feature(const_fn)]` to the crate attributes to enable\n+LL |     loop { return 42; }\n+   |     ^^^^^^^^^^^^^^^^^^^\n \n error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0723`.\n+For more information about this error, try `rustc --explain E0744`."}, {"sha": "71d4022a6d4174860ffe1c3ccb85329461d79e5e", "filename": "src/test/ui/issues/issue-51714.stderr", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fissues%2Fissue-51714.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fissues%2Fissue-51714.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-51714.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -6,7 +6,6 @@ LL |     [(); return while let Some(n) = Some(0) {}];\n    |\n    = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n    = help: add `#![feature(const_loop)]` to the crate attributes to enable\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n \n error[E0572]: return statement outside of function body\n   --> $DIR/issue-51714.rs:2:14"}, {"sha": "4585bcc8cd57fac92d54a14143465527e85b8259", "filename": "src/test/ui/issues/issue-66706.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fissues%2Fissue-66706.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fissues%2Fissue-66706.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-66706.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -19,7 +19,6 @@ fn c() {\n fn d() {\n     [0; match [|f @ &ref _| () ] {} ]\n     //~^ ERROR expected identifier, found reserved identifier `_`\n-    //~| ERROR `match` is not allowed in a `const`\n     //~| ERROR mismatched types\n }\n "}, {"sha": "f0b93ac91111a88bbcea399c7b418593826d3e50", "filename": "src/test/ui/issues/issue-66706.stderr", "status": "modified", "additions": 2, "deletions": 11, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fissues%2Fissue-66706.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Fissues%2Fissue-66706.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-66706.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -26,15 +26,6 @@ error: expected identifier, found reserved identifier `_`\n LL |     [0; match [|f @ &ref _| () ] {} ]\n    |                          ^ expected identifier, found reserved identifier\n \n-error[E0658]: `match` is not allowed in a `const`\n-  --> $DIR/issue-66706.rs:20:9\n-   |\n-LL |     [0; match [|f @ &ref _| () ] {} ]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n error[E0282]: type annotations needed\n   --> $DIR/issue-66706.rs:2:11\n    |\n@@ -65,7 +56,7 @@ LL | fn d() {\n LL |     [0; match [|f @ &ref _| () ] {} ]\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected `()`, found array `[{integer}; _]`\n \n-error: aborting due to 9 previous errors\n+error: aborting due to 8 previous errors\n \n-Some errors have detailed explanations: E0282, E0308, E0658.\n+Some errors have detailed explanations: E0282, E0308.\n For more information about an error, try `rustc --explain E0282`."}, {"sha": "f4af2f0d2dd4059224981dfef34229842f4fc145", "filename": "src/test/ui/or-patterns/const-fn.rs", "status": "renamed", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2For-patterns%2Fconst-fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2For-patterns%2Fconst-fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2For-patterns%2Fconst-fn.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,35 +1,30 @@\n+// check-pass\n #![feature(or_patterns)]\n \n const fn foo((Ok(a) | Err(a)): Result<i32, i32>) {\n-    //~^ ERROR or-pattern is not allowed in a `const fn`\n     let x = Ok(3);\n     let Ok(y) | Err(y) = x;\n-    //~^ ERROR or-pattern is not allowed in a `const fn`\n }\n \n const X: () = {\n     let x = Ok(3);\n     let Ok(y) | Err(y) = x;\n-    //~^ ERROR or-pattern is not allowed in a `const`\n };\n \n static Y: () = {\n     let x = Ok(3);\n     let Ok(y) | Err(y) = x;\n-    //~^ ERROR or-pattern is not allowed in a `static`\n };\n \n static mut Z: () = {\n     let x = Ok(3);\n     let Ok(y) | Err(y) = x;\n-    //~^ ERROR or-pattern is not allowed in a `static mut`\n };\n \n fn main() {\n     let _: [(); {\n         let x = Ok(3);\n         let Ok(y) | Err(y) = x;\n-        //~^ ERROR or-pattern is not allowed in a `const`\n         2\n     }];\n }", "previous_filename": "src/test/ui/or-patterns/feature-gate-const-fn.rs"}, {"sha": "345d6c7098112da8b1ef1b0d260909b255f25a81", "filename": "src/test/ui/or-patterns/feature-gate-const-fn.stderr", "status": "removed", "additions": 0, "deletions": 57, "changes": 57, "blob_url": "https://github.com/rust-lang/rust/blob/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2For-patterns%2Ffeature-gate-const-fn.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/696084c764e5fe3a318eb75a180763fdeab194da/src%2Ftest%2Fui%2For-patterns%2Ffeature-gate-const-fn.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2For-patterns%2Ffeature-gate-const-fn.stderr?ref=696084c764e5fe3a318eb75a180763fdeab194da", "patch": "@@ -1,57 +0,0 @@\n-error[E0658]: or-pattern is not allowed in a `const fn`\n-  --> $DIR/feature-gate-const-fn.rs:3:15\n-   |\n-LL | const fn foo((Ok(a) | Err(a)): Result<i32, i32>) {\n-   |               ^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: or-pattern is not allowed in a `const fn`\n-  --> $DIR/feature-gate-const-fn.rs:6:9\n-   |\n-LL |     let Ok(y) | Err(y) = x;\n-   |         ^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: or-pattern is not allowed in a `const`\n-  --> $DIR/feature-gate-const-fn.rs:12:9\n-   |\n-LL |     let Ok(y) | Err(y) = x;\n-   |         ^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: or-pattern is not allowed in a `static`\n-  --> $DIR/feature-gate-const-fn.rs:18:9\n-   |\n-LL |     let Ok(y) | Err(y) = x;\n-   |         ^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: or-pattern is not allowed in a `static mut`\n-  --> $DIR/feature-gate-const-fn.rs:24:9\n-   |\n-LL |     let Ok(y) | Err(y) = x;\n-   |         ^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: or-pattern is not allowed in a `const`\n-  --> $DIR/feature-gate-const-fn.rs:31:13\n-   |\n-LL |         let Ok(y) | Err(y) = x;\n-   |             ^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error: aborting due to 6 previous errors\n-\n-For more information about this error, try `rustc --explain E0658`."}, {"sha": "f21eac37c17b5325405b37638ee5fba497d0d15c", "filename": "src/test/ui/return/return-match-array-const.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Freturn%2Freturn-match-array-const.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Freturn%2Freturn-match-array-const.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Freturn%2Freturn-match-array-const.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,13 +1,10 @@\n fn main() {\n     [(); return match 0 { n => n }];\n     //~^ ERROR: return statement outside of function body\n-    //~| ERROR: `match` is not allowed in a `const`\n \n     [(); return match 0 { 0 => 0 }];\n     //~^ ERROR: return statement outside of function body\n-    //~| ERROR: `match` is not allowed in a `const`\n \n     [(); return match () { 'a' => 0, _ => 0 }];\n     //~^ ERROR: return statement outside of function body\n-    //~| ERROR: `match` is not allowed in a `const`\n }"}, {"sha": "8e801e3fbb7abd9f030b1b2ad719008205f5f860", "filename": "src/test/ui/return/return-match-array-const.stderr", "status": "modified", "additions": 4, "deletions": 32, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Freturn%2Freturn-match-array-const.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Freturn%2Freturn-match-array-const.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Freturn%2Freturn-match-array-const.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,49 +1,21 @@\n-error[E0658]: `match` is not allowed in a `const`\n-  --> $DIR/return-match-array-const.rs:2:17\n-   |\n-LL |     [(); return match 0 { n => n }];\n-   |                 ^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `match` is not allowed in a `const`\n-  --> $DIR/return-match-array-const.rs:6:17\n-   |\n-LL |     [(); return match 0 { 0 => 0 }];\n-   |                 ^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `match` is not allowed in a `const`\n-  --> $DIR/return-match-array-const.rs:10:17\n-   |\n-LL |     [(); return match () { 'a' => 0, _ => 0 }];\n-   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n error[E0572]: return statement outside of function body\n   --> $DIR/return-match-array-const.rs:2:10\n    |\n LL |     [(); return match 0 { n => n }];\n    |          ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error[E0572]: return statement outside of function body\n-  --> $DIR/return-match-array-const.rs:6:10\n+  --> $DIR/return-match-array-const.rs:5:10\n    |\n LL |     [(); return match 0 { 0 => 0 }];\n    |          ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error[E0572]: return statement outside of function body\n-  --> $DIR/return-match-array-const.rs:10:10\n+  --> $DIR/return-match-array-const.rs:8:10\n    |\n LL |     [(); return match () { 'a' => 0, _ => 0 }];\n    |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-error: aborting due to 6 previous errors\n+error: aborting due to 3 previous errors\n \n-Some errors have detailed explanations: E0572, E0658.\n-For more information about an error, try `rustc --explain E0572`.\n+For more information about this error, try `rustc --explain E0572`."}, {"sha": "71af704c69f0d1e7865b0b9e870ad91c90027c5c", "filename": "src/test/ui/rfc-2497-if-let-chains/disallowed-positions.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Frfc-2497-if-let-chains%2Fdisallowed-positions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Frfc-2497-if-let-chains%2Fdisallowed-positions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2497-if-let-chains%2Fdisallowed-positions.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -216,17 +216,14 @@ fn inside_const_generic_arguments() {\n \n     if let A::<{\n         true && let 1 = 1 //~ ERROR `let` expressions are not supported here\n-        //~| ERROR `match` is not allowed in a `const`\n     }>::O = 5 {}\n \n     while let A::<{\n         true && let 1 = 1 //~ ERROR `let` expressions are not supported here\n-        //~| ERROR `match` is not allowed in a `const`\n     }>::O = 5 {}\n \n     if A::<{\n         true && let 1 = 1 //~ ERROR `let` expressions are not supported here\n-        //~| ERROR `match` is not allowed in a `const`\n     }>::O == 5 {}\n \n     // In the cases above we have `ExprKind::Block` to help us out."}, {"sha": "7f343d1a853ac95bb6d205581a7f147a089ba2ec", "filename": "src/test/ui/rfc-2497-if-let-chains/disallowed-positions.stderr", "status": "modified", "additions": 5, "deletions": 32, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Frfc-2497-if-let-chains%2Fdisallowed-positions.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Frfc-2497-if-let-chains%2Fdisallowed-positions.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2497-if-let-chains%2Fdisallowed-positions.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,5 +1,5 @@\n error: expected one of `,` or `>`, found `&&`\n-  --> $DIR/disallowed-positions.rs:239:14\n+  --> $DIR/disallowed-positions.rs:236:14\n    |\n LL |         true && let 1 = 1\n    |              ^^ expected one of `,` or `>`\n@@ -482,7 +482,7 @@ LL |         true && let 1 = 1\n    = note: as well as when nested within `&&` and parenthesis in those conditions\n \n error: `let` expressions are not supported here\n-  --> $DIR/disallowed-positions.rs:223:17\n+  --> $DIR/disallowed-positions.rs:222:17\n    |\n LL |         true && let 1 = 1\n    |                 ^^^^^^^^^\n@@ -491,7 +491,7 @@ LL |         true && let 1 = 1\n    = note: as well as when nested within `&&` and parenthesis in those conditions\n \n error: `let` expressions are not supported here\n-  --> $DIR/disallowed-positions.rs:228:17\n+  --> $DIR/disallowed-positions.rs:226:17\n    |\n LL |         true && let 1 = 1\n    |                 ^^^^^^^^^\n@@ -516,33 +516,6 @@ LL | #![feature(let_chains)] // Avoid inflating `.stderr` with overzealous gates\n    |\n    = note: see issue #53667 <https://github.com/rust-lang/rust/issues/53667> for more information\n \n-error[E0658]: `match` is not allowed in a `const`\n-  --> $DIR/disallowed-positions.rs:218:17\n-   |\n-LL |         true && let 1 = 1\n-   |                 ^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `match` is not allowed in a `const`\n-  --> $DIR/disallowed-positions.rs:223:17\n-   |\n-LL |         true && let 1 = 1\n-   |                 ^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n-error[E0658]: `match` is not allowed in a `const`\n-  --> $DIR/disallowed-positions.rs:228:17\n-   |\n-LL |         true && let 1 = 1\n-   |                 ^^^^^^^^^\n-   |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n-\n error[E0308]: mismatched types\n   --> $DIR/disallowed-positions.rs:32:8\n    |\n@@ -983,7 +956,7 @@ LL |         let 0 = 0?;\n    = help: the trait `std::ops::Try` is not implemented for `{integer}`\n    = note: required by `std::ops::Try::into_result`\n \n-error: aborting due to 106 previous errors; 2 warnings emitted\n+error: aborting due to 103 previous errors; 2 warnings emitted\n \n-Some errors have detailed explanations: E0277, E0308, E0600, E0614, E0658.\n+Some errors have detailed explanations: E0277, E0308, E0600, E0614.\n For more information about an error, try `rustc --explain E0277`."}, {"sha": "6154b484d343a3b4c56df7f1fdd0e92a1a88e5f2", "filename": "src/test/ui/rfc-2632-const-trait-impl/hir-const-check.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fhir-const-check.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fhir-const-check.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fhir-const-check.rs?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -9,7 +9,7 @@ pub trait MyTrait {\n \n impl const MyTrait for () {\n     fn method(&self) {\n-        match *self {} //~ ERROR `match` is not allowed in a `const fn`\n+        loop {} //~ ERROR `loop` is not allowed in a `const fn`\n     }\n }\n "}, {"sha": "ec40406053533cdbcd956d272f3105c038d3f124", "filename": "src/test/ui/rfc-2632-const-trait-impl/hir-const-check.stderr", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fhir-const-check.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d6139f76c072e281a77a5eac9ba57a0eb3a1936f/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fhir-const-check.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2632-const-trait-impl%2Fhir-const-check.stderr?ref=d6139f76c072e281a77a5eac9ba57a0eb3a1936f", "patch": "@@ -1,11 +1,11 @@\n-error[E0658]: `match` is not allowed in a `const fn`\n+error[E0658]: `loop` is not allowed in a `const fn`\n   --> $DIR/hir-const-check.rs:12:9\n    |\n-LL |         match *self {}\n-   |         ^^^^^^^^^^^^^^\n+LL |         loop {}\n+   |         ^^^^^^^\n    |\n-   = note: see issue #49146 <https://github.com/rust-lang/rust/issues/49146> for more information\n-   = help: add `#![feature(const_if_match)]` to the crate attributes to enable\n+   = note: see issue #52000 <https://github.com/rust-lang/rust/issues/52000> for more information\n+   = help: add `#![feature(const_loop)]` to the crate attributes to enable\n \n error: aborting due to previous error\n "}]}