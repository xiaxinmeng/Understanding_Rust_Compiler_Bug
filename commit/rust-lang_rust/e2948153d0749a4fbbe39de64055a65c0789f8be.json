{"sha": "e2948153d0749a4fbbe39de64055a65c0789f8be", "node_id": "MDY6Q29tbWl0NzI0NzEyOmUyOTQ4MTUzZDA3NDlhNGZiYmUzOWRlNjQwNTVhNjVjMDc4OWY4YmU=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2019-07-15T23:18:42Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2019-07-15T23:18:42Z"}, "message": "Auto merge of #4211 - flip1995:check_changelog, r=matthiaskrgr\n\nCheck for changelog entry in PR bodies\n\ncc #4031 but now on the auto and try branches. (https://github.com/rust-lang/rust-clippy/issues/3955#issuecomment-502230021)\n\nchangelog: none", "tree": {"sha": "5fd9bd9db33c1dd45f98b9c7d9381981fe182a97", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5fd9bd9db33c1dd45f98b9c7d9381981fe182a97"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e2948153d0749a4fbbe39de64055a65c0789f8be", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e2948153d0749a4fbbe39de64055a65c0789f8be", "html_url": "https://github.com/rust-lang/rust/commit/e2948153d0749a4fbbe39de64055a65c0789f8be", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e2948153d0749a4fbbe39de64055a65c0789f8be/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a73bb33399fcf5684450a2088fc961cf9aa0285b", "url": "https://api.github.com/repos/rust-lang/rust/commits/a73bb33399fcf5684450a2088fc961cf9aa0285b", "html_url": "https://github.com/rust-lang/rust/commit/a73bb33399fcf5684450a2088fc961cf9aa0285b"}, {"sha": "1c87df486e44f46ef1860b497e9cc538bae09545", "url": "https://api.github.com/repos/rust-lang/rust/commits/1c87df486e44f46ef1860b497e9cc538bae09545", "html_url": "https://github.com/rust-lang/rust/commit/1c87df486e44f46ef1860b497e9cc538bae09545"}], "stats": {"total": 15, "additions": 15, "deletions": 0}, "files": [{"sha": "0a1bd0ea2750cbb78104cd4c4af1463e2ce5c68d", "filename": ".travis.yml", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/e2948153d0749a4fbbe39de64055a65c0789f8be/.travis.yml", "raw_url": "https://github.com/rust-lang/rust/raw/e2948153d0749a4fbbe39de64055a65c0789f8be/.travis.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.travis.yml?ref=e2948153d0749a4fbbe39de64055a65c0789f8be", "patch": "@@ -17,6 +17,7 @@ branches:\n env:\n  global:\n    - RUST_BACKTRACE=1\n+   - secure: \"OKulfkA5OGd/d1IhvBKzRkHQwMcWjzrzbimo7+5NhkUkWxndAzl+719TB3wWvIh1i2wXXrEXsyZkXM5FtRrHm55v1VKQ5ibjEvFg1w3NIg81iDyoLq186fLqywvxGkOAFPrsePPsBj5USd5xvhwwbrjO6L7/RK6Z8shBwOSc41s=\"\n \n install:\n   - |\n@@ -88,6 +89,20 @@ matrix:\n     - os: windows\n \n script:\n+  - |\n+    if [ \"$TRAVIS_BRANCH\" == \"auto\" ] || [ \"$TRAVIS_BRANCH\" == \"try\" ]; then\n+      pr=$(echo $TRAVIS_COMMIT_MESSAGE | grep -o \"#[0-9]*\" | head -1 | sed 's/^#//g')\n+      output=$(curl -H \"Authorization: token $GITHUB_API_TOKEN\" -s \"https://api.github.com/repos/rust-lang/rust-clippy/pulls/$pr\" | \\\n+        python -c \"import sys, json; print(json.load(sys.stdin)['body'])\" | \\\n+        grep \"^changelog: \" | \\\n+        sed \"s/changelog: //g\")\n+      if [ -z \"$output\" ]; then\n+        echo \"ERROR: PR body must contain 'changelog: ...'\"\n+        exit 1\n+      elif [ \"$output\" = \"none\" ]; then\n+        echo \"WARNING: changelog is 'none'\"\n+      fi\n+    fi\n   - |\n       rm rust-toolchain\n       ./setup-toolchain.sh"}]}