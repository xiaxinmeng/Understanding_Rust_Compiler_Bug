{"sha": "097b3823ddef9b29c62d62a3163e912498790b22", "node_id": "C_kwDOAAsO6NoAKDA5N2IzODIzZGRlZjliMjljNjJkNjJhMzE2M2U5MTI0OTg3OTBiMjI", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-08-24T13:10:26Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-08-24T13:10:26Z"}, "message": "Unify rightside rendering", "tree": {"sha": "959298c53836d6040b01e3d6336ba47398e25188", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/959298c53836d6040b01e3d6336ba47398e25188"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/097b3823ddef9b29c62d62a3163e912498790b22", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/097b3823ddef9b29c62d62a3163e912498790b22", "html_url": "https://github.com/rust-lang/rust/commit/097b3823ddef9b29c62d62a3163e912498790b22", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/097b3823ddef9b29c62d62a3163e912498790b22/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4a24f08ba43166cfee86d868b3fe8612aec6faca", "url": "https://api.github.com/repos/rust-lang/rust/commits/4a24f08ba43166cfee86d868b3fe8612aec6faca", "html_url": "https://github.com/rust-lang/rust/commit/4a24f08ba43166cfee86d868b3fe8612aec6faca"}], "stats": {"total": 44, "additions": 12, "deletions": 32}, "files": [{"sha": "04be6dbb6f712c3039f640d02288384e52288e25", "filename": "src/librustdoc/html/render/mod.rs", "status": "modified", "additions": 3, "deletions": 7, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/097b3823ddef9b29c62d62a3163e912498790b22/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/097b3823ddef9b29c62d62a3163e912498790b22/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs?ref=097b3823ddef9b29c62d62a3163e912498790b22", "patch": "@@ -191,12 +191,6 @@ impl StylePath {\n     }\n }\n \n-fn write_srclink(cx: &Context<'_>, item: &clean::Item, buf: &mut Buffer) {\n-    if let Some(l) = cx.src_href(item) {\n-        write!(buf, \"<a class=\\\"srclink\\\" href=\\\"{}\\\">source</a>\", l)\n-    }\n-}\n-\n #[derive(Debug, Eq, PartialEq, Hash)]\n struct ItemEntry {\n     url: String,\n@@ -1691,7 +1685,9 @@ fn render_rightside(\n         const_stable_since,\n     );\n     let mut srclink = Buffer::empty_from(w);\n-    write_srclink(cx, item, &mut srclink);\n+    if let Some(l) = cx.src_href(item) {\n+        write!(srclink, \"<a class=\\\"srclink\\\" href=\\\"{}\\\">source</a>\", l)\n+    }\n     if has_stability && !srclink.is_empty() {\n         rightside.write_str(\" \u00b7 \");\n     }"}, {"sha": "a5668b318dcdc8f18a60e560e6754af8db65b54a", "filename": "src/librustdoc/html/render/print_item.rs", "status": "modified", "additions": 9, "deletions": 25, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/097b3823ddef9b29c62d62a3163e912498790b22/src%2Flibrustdoc%2Fhtml%2Frender%2Fprint_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/097b3823ddef9b29c62d62a3163e912498790b22/src%2Flibrustdoc%2Fhtml%2Frender%2Fprint_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fprint_item.rs?ref=097b3823ddef9b29c62d62a3163e912498790b22", "patch": "@@ -18,7 +18,7 @@ use std::rc::Rc;\n use super::{\n     collect_paths_for_type, document, ensure_trailing_slash, item_ty_to_section,\n     notable_traits_decl, render_assoc_item, render_assoc_items, render_attributes_in_code,\n-    render_attributes_in_pre, render_impl, render_stability_since_raw, write_srclink,\n+    render_attributes_in_pre, render_impl, render_rightside, render_stability_since_raw,\n     AssocItemLink, Context, ImplRenderingParameters,\n };\n use crate::clean;\n@@ -709,14 +709,7 @@ fn item_trait(w: &mut Buffer, cx: &mut Context<'_>, it: &clean::Item, t: &clean:\n             write!(w, \"<details class=\\\"rustdoc-toggle\\\" open><summary>\");\n         }\n         write!(w, \"<div id=\\\"{}\\\" class=\\\"method has-srclink\\\">\", id);\n-        write!(w, \"<div class=\\\"rightside\\\">\");\n-\n-        let has_stability = render_stability_since(w, m, t, cx.tcx());\n-        if has_stability {\n-            w.write_str(\" \u00b7 \");\n-        }\n-        write_srclink(cx, m, w);\n-        write!(w, \"</div>\");\n+        render_rightside(w, cx, m, t, RenderMode::Normal);\n         write!(w, \"<h4 class=\\\"code-header\\\">\");\n         render_assoc_item(\n             w,\n@@ -1260,7 +1253,13 @@ fn item_enum(w: &mut Buffer, cx: &mut Context<'_>, it: &clean::Item, e: &clean::\n                 w.write_str(\")\");\n             }\n             w.write_str(\"</code>\");\n-            render_stability_since(w, variant, it, cx.tcx());\n+            render_stability_since_raw(\n+                w,\n+                variant.stable_since(cx.tcx()),\n+                variant.const_stability(cx.tcx()),\n+                it.stable_since(cx.tcx()),\n+                it.const_stable_since(cx.tcx()),\n+            );\n             w.write_str(\"</h3>\");\n \n             use crate::clean::Variant;\n@@ -1591,21 +1590,6 @@ where\n     w.write_str(\"</code></pre>\");\n }\n \n-fn render_stability_since(\n-    w: &mut Buffer,\n-    item: &clean::Item,\n-    containing_item: &clean::Item,\n-    tcx: TyCtxt<'_>,\n-) -> bool {\n-    render_stability_since_raw(\n-        w,\n-        item.stable_since(tcx),\n-        item.const_stability(tcx),\n-        containing_item.stable_since(tcx),\n-        containing_item.const_stable_since(tcx),\n-    )\n-}\n-\n fn compare_impl<'a, 'b>(lhs: &'a &&Impl, rhs: &'b &&Impl, cx: &Context<'_>) -> Ordering {\n     let lhss = format!(\"{}\", lhs.inner_impl().print(false, cx));\n     let rhss = format!(\"{}\", rhs.inner_impl().print(false, cx));"}]}