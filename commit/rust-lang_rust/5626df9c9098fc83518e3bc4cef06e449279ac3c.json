{"sha": "5626df9c9098fc83518e3bc4cef06e449279ac3c", "node_id": "C_kwDOAAsO6NoAKDU2MjZkZjljOTA5OGZjODM1MThlM2JjNGNlZjA2ZTQ0OTI3OWFjM2M", "commit": {"author": {"name": "Nixon Enraght-Moony", "email": "nixon.emoony@gmail.com", "date": "2022-12-04T18:46:57Z"}, "committer": {"name": "Nixon Enraght-Moony", "email": "nixon.emoony@gmail.com", "date": "2022-12-08T23:07:54Z"}, "message": "Add `rustc_on_unimplemented` to `Sum` and `Product` trait.", "tree": {"sha": "a0a1fa2941b23b81378ac028ed8a0208a14f9515", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a0a1fa2941b23b81378ac028ed8a0208a14f9515"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5626df9c9098fc83518e3bc4cef06e449279ac3c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5626df9c9098fc83518e3bc4cef06e449279ac3c", "html_url": "https://github.com/rust-lang/rust/commit/5626df9c9098fc83518e3bc4cef06e449279ac3c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5626df9c9098fc83518e3bc4cef06e449279ac3c/comments", "author": {"login": "aDotInTheVoid", "id": 28781354, "node_id": "MDQ6VXNlcjI4NzgxMzU0", "avatar_url": "https://avatars.githubusercontent.com/u/28781354?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aDotInTheVoid", "html_url": "https://github.com/aDotInTheVoid", "followers_url": "https://api.github.com/users/aDotInTheVoid/followers", "following_url": "https://api.github.com/users/aDotInTheVoid/following{/other_user}", "gists_url": "https://api.github.com/users/aDotInTheVoid/gists{/gist_id}", "starred_url": "https://api.github.com/users/aDotInTheVoid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aDotInTheVoid/subscriptions", "organizations_url": "https://api.github.com/users/aDotInTheVoid/orgs", "repos_url": "https://api.github.com/users/aDotInTheVoid/repos", "events_url": "https://api.github.com/users/aDotInTheVoid/events{/privacy}", "received_events_url": "https://api.github.com/users/aDotInTheVoid/received_events", "type": "User", "site_admin": false}, "committer": {"login": "aDotInTheVoid", "id": 28781354, "node_id": "MDQ6VXNlcjI4NzgxMzU0", "avatar_url": "https://avatars.githubusercontent.com/u/28781354?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aDotInTheVoid", "html_url": "https://github.com/aDotInTheVoid", "followers_url": "https://api.github.com/users/aDotInTheVoid/followers", "following_url": "https://api.github.com/users/aDotInTheVoid/following{/other_user}", "gists_url": "https://api.github.com/users/aDotInTheVoid/gists{/gist_id}", "starred_url": "https://api.github.com/users/aDotInTheVoid/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aDotInTheVoid/subscriptions", "organizations_url": "https://api.github.com/users/aDotInTheVoid/orgs", "repos_url": "https://api.github.com/users/aDotInTheVoid/repos", "events_url": "https://api.github.com/users/aDotInTheVoid/events{/privacy}", "received_events_url": "https://api.github.com/users/aDotInTheVoid/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7632db0e87d8adccc9a83a47795c9411b1455855", "url": "https://api.github.com/repos/rust-lang/rust/commits/7632db0e87d8adccc9a83a47795c9411b1455855", "html_url": "https://github.com/rust-lang/rust/commit/7632db0e87d8adccc9a83a47795c9411b1455855"}], "stats": {"total": 56, "additions": 56, "deletions": 0}, "files": [{"sha": "e31669b3924202db05ee2cceb8289ceae1075105", "filename": "library/core/src/iter/traits/accum.rs", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/5626df9c9098fc83518e3bc4cef06e449279ac3c/library%2Fcore%2Fsrc%2Fiter%2Ftraits%2Faccum.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5626df9c9098fc83518e3bc4cef06e449279ac3c/library%2Fcore%2Fsrc%2Fiter%2Ftraits%2Faccum.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fiter%2Ftraits%2Faccum.rs?ref=5626df9c9098fc83518e3bc4cef06e449279ac3c", "patch": "@@ -10,6 +10,10 @@ use crate::num::Wrapping;\n /// [`sum()`]: Iterator::sum\n /// [`FromIterator`]: iter::FromIterator\n #[stable(feature = \"iter_arith_traits\", since = \"1.12.0\")]\n+#[rustc_on_unimplemented(\n+    message = \"a value of type `{Self}` cannot be made by summing an iterator over elements of type `{A}`\",\n+    label = \"value of type `{Self}` cannot be made by summing a `std::iter::Iterator<Item={A}>`\"\n+)]\n pub trait Sum<A = Self>: Sized {\n     /// Method which takes an iterator and generates `Self` from the elements by\n     /// \"summing up\" the items.\n@@ -27,6 +31,10 @@ pub trait Sum<A = Self>: Sized {\n /// [`product()`]: Iterator::product\n /// [`FromIterator`]: iter::FromIterator\n #[stable(feature = \"iter_arith_traits\", since = \"1.12.0\")]\n+#[rustc_on_unimplemented(\n+    message = \"a value of type `{Self}` cannot be made by multiplying all elements of type `{A}` from an iterator\",\n+    label = \"value of type `{Self}` cannot be made by multiplying all elements from a `std::iter::Iterator<Item={A}>`\"\n+)]\n pub trait Product<A = Self>: Sized {\n     /// Method which takes an iterator and generates `Self` from the elements by\n     /// multiplying the items."}, {"sha": "4f1c521d9fe8e6b156aeea9c291326b15e56878e", "filename": "src/test/ui/on-unimplemented/sum.rs", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/5626df9c9098fc83518e3bc4cef06e449279ac3c/src%2Ftest%2Fui%2Fon-unimplemented%2Fsum.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5626df9c9098fc83518e3bc4cef06e449279ac3c/src%2Ftest%2Fui%2Fon-unimplemented%2Fsum.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fon-unimplemented%2Fsum.rs?ref=5626df9c9098fc83518e3bc4cef06e449279ac3c", "patch": "@@ -0,0 +1,9 @@\n+// <https://github.com/rust-lang/rust/issues/105184>\n+\n+fn main() {\n+    vec![(), ()].iter().sum::<i32>();\n+    //~^ ERROR\n+\n+    vec![(), ()].iter().product::<i32>();\n+    //~^ ERROR\n+}"}, {"sha": "0c99e63f0e518e7f730601e38b8c0234c275aaaa", "filename": "src/test/ui/on-unimplemented/sum.stderr", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/5626df9c9098fc83518e3bc4cef06e449279ac3c/src%2Ftest%2Fui%2Fon-unimplemented%2Fsum.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5626df9c9098fc83518e3bc4cef06e449279ac3c/src%2Ftest%2Fui%2Fon-unimplemented%2Fsum.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fon-unimplemented%2Fsum.stderr?ref=5626df9c9098fc83518e3bc4cef06e449279ac3c", "patch": "@@ -0,0 +1,39 @@\n+error[E0277]: a value of type `i32` cannot be made by summing an iterator over elements of type `&()`\n+  --> $DIR/sum.rs:4:5\n+   |\n+LL |     vec![(), ()].iter().sum::<i32>();\n+   |     ^^^^^^^^^^^^^^^^^^^ --- required by a bound introduced by this call\n+   |     |\n+   |     value of type `i32` cannot be made by summing a `std::iter::Iterator<Item=&()>`\n+   |\n+   = help: the trait `Sum<&()>` is not implemented for `i32`\n+   = help: the following other types implement trait `Sum<A>`:\n+             <i32 as Sum<&'a i32>>\n+             <i32 as Sum>\n+note: required by a bound in `std::iter::Iterator::sum`\n+  --> $SRC_DIR/core/src/iter/traits/iterator.rs:LL:COL\n+   |\n+LL |         S: Sum<Self::Item>,\n+   |            ^^^^^^^^^^^^^^^ required by this bound in `std::iter::Iterator::sum`\n+\n+error[E0277]: a value of type `i32` cannot be made by multiplying all elements of type `&()` from an iterator\n+  --> $DIR/sum.rs:7:5\n+   |\n+LL |     vec![(), ()].iter().product::<i32>();\n+   |     ^^^^^^^^^^^^^^^^^^^ ------- required by a bound introduced by this call\n+   |     |\n+   |     value of type `i32` cannot be made by multiplying all elements from a `std::iter::Iterator<Item=&()>`\n+   |\n+   = help: the trait `Product<&()>` is not implemented for `i32`\n+   = help: the following other types implement trait `Product<A>`:\n+             <i32 as Product<&'a i32>>\n+             <i32 as Product>\n+note: required by a bound in `std::iter::Iterator::product`\n+  --> $SRC_DIR/core/src/iter/traits/iterator.rs:LL:COL\n+   |\n+LL |         P: Product<Self::Item>,\n+   |            ^^^^^^^^^^^^^^^^^^^ required by this bound in `std::iter::Iterator::product`\n+\n+error: aborting due to 2 previous errors\n+\n+For more information about this error, try `rustc --explain E0277`."}]}