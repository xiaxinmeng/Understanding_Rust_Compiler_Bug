{"sha": "6a66491883452df0ee769f052ae0bde72bafb040", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZhNjY0OTE4ODM0NTJkZjBlZTc2OWYwNTJhZTBiZGU3MmJhZmIwNDA=", "commit": {"author": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2019-06-08T14:35:54Z"}, "committer": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2019-06-08T20:55:25Z"}, "message": "Remove some more `#![feature(custom_attribute)]`s", "tree": {"sha": "028cc4b24030d5486158ee541ddfc13e4b0a9aba", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/028cc4b24030d5486158ee541ddfc13e4b0a9aba"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6a66491883452df0ee769f052ae0bde72bafb040", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6a66491883452df0ee769f052ae0bde72bafb040", "html_url": "https://github.com/rust-lang/rust/commit/6a66491883452df0ee769f052ae0bde72bafb040", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6a66491883452df0ee769f052ae0bde72bafb040/comments", "author": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ea4ad555d76d2eb8e6eb749e1b4c163e16077985", "url": "https://api.github.com/repos/rust-lang/rust/commits/ea4ad555d76d2eb8e6eb749e1b4c163e16077985", "html_url": "https://github.com/rust-lang/rust/commit/ea4ad555d76d2eb8e6eb749e1b4c163e16077985"}], "stats": {"total": 152, "additions": 89, "deletions": 63}, "files": [{"sha": "6d4aa024c75b4ffa1ad23055e0f0af4fca25b400", "filename": "src/doc/rustc/src/lints/listing/warn-by-default.md", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/6a66491883452df0ee769f052ae0bde72bafb040/src%2Fdoc%2Frustc%2Fsrc%2Flints%2Flisting%2Fwarn-by-default.md", "raw_url": "https://github.com/rust-lang/rust/raw/6a66491883452df0ee769f052ae0bde72bafb040/src%2Fdoc%2Frustc%2Fsrc%2Flints%2Flisting%2Fwarn-by-default.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc%2Fsrc%2Flints%2Flisting%2Fwarn-by-default.md?ref=6a66491883452df0ee769f052ae0bde72bafb040", "patch": "@@ -728,19 +728,17 @@ This lint detects attributes that were not used by the compiler. Some\n example code that triggers this lint:\n \n ```rust\n-#![feature(custom_attribute)]\n-\n-#![mutable_doc]\n+#![macro_export]\n ```\n \n This will produce:\n \n ```text\n warning: unused attribute\n- --> src/main.rs:4:1\n+ --> src/main.rs:1:1\n   |\n-4 | #![mutable_doc]\n-  | ^^^^^^^^^^^^^^^\n+1 | #![macro_export]\n+  | ^^^^^^^^^^^^^^^^\n   |\n ```\n "}, {"sha": "49a8dde5da84f3d94118c52b52220ea68db5a07a", "filename": "src/test/ui/lint/lint-obsolete-attr.rs", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/6a66491883452df0ee769f052ae0bde72bafb040/src%2Ftest%2Fui%2Flint%2Flint-obsolete-attr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a66491883452df0ee769f052ae0bde72bafb040/src%2Ftest%2Fui%2Flint%2Flint-obsolete-attr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-obsolete-attr.rs?ref=6a66491883452df0ee769f052ae0bde72bafb040", "patch": "@@ -1,12 +1,8 @@\n // When denying at the crate level, be sure to not get random warnings from the\n // injected intrinsics by the compiler.\n \n-#![deny(unused_attributes)]\n-#![allow(dead_code)]\n-#![feature(custom_attribute)]\n+#[ab_isize=\"stdcall\"] extern {} //~ ERROR attribute `ab_isize` is currently unknown\n \n-#[ab_isize=\"stdcall\"] extern {} //~ ERROR unused attribute\n-\n-#[fixed_stack_segment] fn f() {} //~ ERROR unused attribute\n+#[fixed_stack_segment] fn f() {} //~ ERROR attribute `fixed_stack_segment` is currently unknown\n \n fn main() {}"}, {"sha": "039b07e6ea5444bed3ce853c59616a4ed5e3c9fd", "filename": "src/test/ui/lint/lint-obsolete-attr.stderr", "status": "modified", "additions": 14, "deletions": 13, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/6a66491883452df0ee769f052ae0bde72bafb040/src%2Ftest%2Fui%2Flint%2Flint-obsolete-attr.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/6a66491883452df0ee769f052ae0bde72bafb040/src%2Ftest%2Fui%2Flint%2Flint-obsolete-attr.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-obsolete-attr.stderr?ref=6a66491883452df0ee769f052ae0bde72bafb040", "patch": "@@ -1,20 +1,21 @@\n-error: unused attribute\n-  --> $DIR/lint-obsolete-attr.rs:8:1\n+error[E0658]: The attribute `fixed_stack_segment` is currently unknown to the compiler and may have meaning added to it in the future\n+  --> $DIR/lint-obsolete-attr.rs:6:3\n    |\n-LL | #[ab_isize=\"stdcall\"] extern {}\n-   | ^^^^^^^^^^^^^^^^^^^^^\n-   |\n-note: lint level defined here\n-  --> $DIR/lint-obsolete-attr.rs:4:9\n+LL | #[fixed_stack_segment] fn f() {}\n+   |   ^^^^^^^^^^^^^^^^^^^\n    |\n-LL | #![deny(unused_attributes)]\n-   |         ^^^^^^^^^^^^^^^^^\n+   = note: for more information, see https://github.com/rust-lang/rust/issues/29642\n+   = help: add #![feature(custom_attribute)] to the crate attributes to enable\n \n-error: unused attribute\n-  --> $DIR/lint-obsolete-attr.rs:10:1\n+error[E0658]: The attribute `ab_isize` is currently unknown to the compiler and may have meaning added to it in the future\n+  --> $DIR/lint-obsolete-attr.rs:4:3\n    |\n-LL | #[fixed_stack_segment] fn f() {}\n-   | ^^^^^^^^^^^^^^^^^^^^^^\n+LL | #[ab_isize=\"stdcall\"] extern {}\n+   |   ^^^^^^^^\n+   |\n+   = note: for more information, see https://github.com/rust-lang/rust/issues/29642\n+   = help: add #![feature(custom_attribute)] to the crate attributes to enable\n \n error: aborting due to 2 previous errors\n \n+For more information about this error, try `rustc --explain E0658`."}, {"sha": "cddac850c59f53d3d898fd376cb06477170fb32f", "filename": "src/test/ui/lint/lint-unknown-attr.rs", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/6a66491883452df0ee769f052ae0bde72bafb040/src%2Ftest%2Fui%2Flint%2Flint-unknown-attr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a66491883452df0ee769f052ae0bde72bafb040/src%2Ftest%2Fui%2Flint%2Flint-unknown-attr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-unknown-attr.rs?ref=6a66491883452df0ee769f052ae0bde72bafb040", "patch": "@@ -1,11 +1,10 @@\n // When denying at the crate level, be sure to not get random warnings from the\n // injected intrinsics by the compiler.\n \n-#![feature(custom_attribute)]\n-#![deny(unused_attributes)]\n+#![feature(custom_inner_attributes)]\n \n-#![mutable_doc] //~ ERROR unused attribute\n+#![mutable_doc] //~ ERROR attribute `mutable_doc` is currently unknown\n \n-#[dance] mod a {} //~ ERROR unused attribute\n+#[dance] mod a {} //~ ERROR attribute `dance` is currently unknown\n \n-#[dance] fn main() {} //~ ERROR unused attribute\n+#[dance] fn main() {} //~ ERROR attribute `dance` is currently unknown"}, {"sha": "4f00a51a5db96e955f1c4701db5d21f954db720e", "filename": "src/test/ui/lint/lint-unknown-attr.stderr", "status": "modified", "additions": 20, "deletions": 16, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/6a66491883452df0ee769f052ae0bde72bafb040/src%2Ftest%2Fui%2Flint%2Flint-unknown-attr.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/6a66491883452df0ee769f052ae0bde72bafb040/src%2Ftest%2Fui%2Flint%2Flint-unknown-attr.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Flint-unknown-attr.stderr?ref=6a66491883452df0ee769f052ae0bde72bafb040", "patch": "@@ -1,26 +1,30 @@\n-error: unused attribute\n-  --> $DIR/lint-unknown-attr.rs:9:1\n+error[E0658]: The attribute `mutable_doc` is currently unknown to the compiler and may have meaning added to it in the future\n+  --> $DIR/lint-unknown-attr.rs:6:4\n    |\n-LL | #[dance] mod a {}\n-   | ^^^^^^^^\n+LL | #![mutable_doc]\n+   |    ^^^^^^^^^^^\n    |\n-note: lint level defined here\n-  --> $DIR/lint-unknown-attr.rs:5:9\n+   = note: for more information, see https://github.com/rust-lang/rust/issues/29642\n+   = help: add #![feature(custom_attribute)] to the crate attributes to enable\n+\n+error[E0658]: The attribute `dance` is currently unknown to the compiler and may have meaning added to it in the future\n+  --> $DIR/lint-unknown-attr.rs:8:3\n    |\n-LL | #![deny(unused_attributes)]\n-   |         ^^^^^^^^^^^^^^^^^\n+LL | #[dance] mod a {}\n+   |   ^^^^^\n+   |\n+   = note: for more information, see https://github.com/rust-lang/rust/issues/29642\n+   = help: add #![feature(custom_attribute)] to the crate attributes to enable\n \n-error: unused attribute\n-  --> $DIR/lint-unknown-attr.rs:11:1\n+error[E0658]: The attribute `dance` is currently unknown to the compiler and may have meaning added to it in the future\n+  --> $DIR/lint-unknown-attr.rs:10:3\n    |\n LL | #[dance] fn main() {}\n-   | ^^^^^^^^\n-\n-error: unused attribute\n-  --> $DIR/lint-unknown-attr.rs:7:1\n+   |   ^^^^^\n    |\n-LL | #![mutable_doc]\n-   | ^^^^^^^^^^^^^^^\n+   = note: for more information, see https://github.com/rust-lang/rust/issues/29642\n+   = help: add #![feature(custom_attribute)] to the crate attributes to enable\n \n error: aborting due to 3 previous errors\n \n+For more information about this error, try `rustc --explain E0658`."}, {"sha": "1298c08df846df8994685f19c1ee2f433bc77947", "filename": "src/test/ui/proc-macro/resolve-error.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/6a66491883452df0ee769f052ae0bde72bafb040/src%2Ftest%2Fui%2Fproc-macro%2Fresolve-error.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a66491883452df0ee769f052ae0bde72bafb040/src%2Ftest%2Fui%2Fproc-macro%2Fresolve-error.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Fresolve-error.rs?ref=6a66491883452df0ee769f052ae0bde72bafb040", "patch": "@@ -2,8 +2,6 @@\n // aux-build:derive-clona.rs\n // aux-build:test-macros.rs\n \n-#![feature(custom_attribute)]\n-\n #[macro_use]\n extern crate derive_foo;\n #[macro_use]\n@@ -25,10 +23,12 @@ macro_rules! attr_proc_mac {\n //~^ ERROR cannot find\n struct Foo;\n \n-#[attr_proc_macra] // OK, interpreted as a custom attribute\n+// Interpreted as a feature gated custom attribute\n+#[attr_proc_macra] //~ ERROR attribute `attr_proc_macra` is currently unknown\n struct Bar;\n \n-#[FooWithLongNan]  // OK, interpreted as a custom attribute\n+// Interpreted as a feature gated custom attribute\n+#[FooWithLongNan] //~ ERROR attribute `FooWithLongNan` is currently unknown\n struct Asdf;\n \n #[derive(Dlone)]"}, {"sha": "f9f116c15dcc7fff9905a6018b560837dc99f5ed", "filename": "src/test/ui/proc-macro/resolve-error.stderr", "status": "modified", "additions": 21, "deletions": 2, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/6a66491883452df0ee769f052ae0bde72bafb040/src%2Ftest%2Fui%2Fproc-macro%2Fresolve-error.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/6a66491883452df0ee769f052ae0bde72bafb040/src%2Ftest%2Fui%2Fproc-macro%2Fresolve-error.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Fresolve-error.stderr?ref=6a66491883452df0ee769f052ae0bde72bafb040", "patch": "@@ -1,5 +1,23 @@\n+error[E0658]: The attribute `attr_proc_macra` is currently unknown to the compiler and may have meaning added to it in the future\n+  --> $DIR/resolve-error.rs:27:3\n+   |\n+LL | #[attr_proc_macra]\n+   |   ^^^^^^^^^^^^^^^\n+   |\n+   = note: for more information, see https://github.com/rust-lang/rust/issues/29642\n+   = help: add #![feature(custom_attribute)] to the crate attributes to enable\n+\n+error[E0658]: The attribute `FooWithLongNan` is currently unknown to the compiler and may have meaning added to it in the future\n+  --> $DIR/resolve-error.rs:31:3\n+   |\n+LL | #[FooWithLongNan]\n+   |   ^^^^^^^^^^^^^^\n+   |\n+   = note: for more information, see https://github.com/rust-lang/rust/issues/29642\n+   = help: add #![feature(custom_attribute)] to the crate attributes to enable\n+\n error: cannot find derive macro `FooWithLongNan` in this scope\n-  --> $DIR/resolve-error.rs:24:10\n+  --> $DIR/resolve-error.rs:22:10\n    |\n LL | #[derive(FooWithLongNan)]\n    |          ^^^^^^^^^^^^^^ help: try: `FooWithLongName`\n@@ -46,5 +64,6 @@ error: cannot find macro `bang_proc_macrp!` in this scope\n LL |     bang_proc_macrp!();\n    |     ^^^^^^^^^^^^^^^ help: you could try the macro: `bang_proc_macro`\n \n-error: aborting due to 8 previous errors\n+error: aborting due to 10 previous errors\n \n+For more information about this error, try `rustc --explain E0658`."}, {"sha": "ce902b7e7d28a8d9fb7513114f1c1e985b58b130", "filename": "src/test/ui/tool-attributes/tool-attributes-misplaced-1.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/6a66491883452df0ee769f052ae0bde72bafb040/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-misplaced-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a66491883452df0ee769f052ae0bde72bafb040/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-misplaced-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-misplaced-1.rs?ref=6a66491883452df0ee769f052ae0bde72bafb040", "patch": "@@ -1,12 +1,11 @@\n-#![feature(custom_attribute)]\n-\n type A = rustfmt; //~ ERROR expected type, found tool module `rustfmt`\n type B = rustfmt::skip; //~ ERROR expected type, found tool attribute `rustfmt::skip`\n \n #[derive(rustfmt)] //~ ERROR cannot find derive macro `rustfmt` in this scope\n struct S;\n \n-#[rustfmt] // OK, interpreted as a custom attribute\n+// Interpreted as a feature gated custom attribute\n+#[rustfmt] //~ ERROR attribute `rustfmt` is currently unknown\n fn check() {}\n \n #[rustfmt::skip] // OK"}, {"sha": "1df9821f2444092a0f05e9a917b1d0502cb60977", "filename": "src/test/ui/tool-attributes/tool-attributes-misplaced-1.stderr", "status": "modified", "additions": 18, "deletions": 8, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/6a66491883452df0ee769f052ae0bde72bafb040/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-misplaced-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/6a66491883452df0ee769f052ae0bde72bafb040/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-misplaced-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftool-attributes%2Ftool-attributes-misplaced-1.stderr?ref=6a66491883452df0ee769f052ae0bde72bafb040", "patch": "@@ -1,39 +1,49 @@\n+error[E0658]: The attribute `rustfmt` is currently unknown to the compiler and may have meaning added to it in the future\n+  --> $DIR/tool-attributes-misplaced-1.rs:8:3\n+   |\n+LL | #[rustfmt]\n+   |   ^^^^^^^\n+   |\n+   = note: for more information, see https://github.com/rust-lang/rust/issues/29642\n+   = help: add #![feature(custom_attribute)] to the crate attributes to enable\n+\n error: cannot find derive macro `rustfmt` in this scope\n-  --> $DIR/tool-attributes-misplaced-1.rs:6:10\n+  --> $DIR/tool-attributes-misplaced-1.rs:4:10\n    |\n LL | #[derive(rustfmt)]\n    |          ^^^^^^^\n \n error: cannot find macro `rustfmt!` in this scope\n-  --> $DIR/tool-attributes-misplaced-1.rs:15:5\n+  --> $DIR/tool-attributes-misplaced-1.rs:14:5\n    |\n LL |     rustfmt!();\n    |     ^^^^^^^\n \n error[E0573]: expected type, found tool module `rustfmt`\n-  --> $DIR/tool-attributes-misplaced-1.rs:3:10\n+  --> $DIR/tool-attributes-misplaced-1.rs:1:10\n    |\n LL | type A = rustfmt;\n    |          ^^^^^^^ not a type\n \n error[E0573]: expected type, found tool attribute `rustfmt::skip`\n-  --> $DIR/tool-attributes-misplaced-1.rs:4:10\n+  --> $DIR/tool-attributes-misplaced-1.rs:2:10\n    |\n LL | type B = rustfmt::skip;\n    |          ^^^^^^^^^^^^^ not a type\n \n error[E0423]: expected value, found tool module `rustfmt`\n-  --> $DIR/tool-attributes-misplaced-1.rs:14:5\n+  --> $DIR/tool-attributes-misplaced-1.rs:13:5\n    |\n LL |     rustfmt;\n    |     ^^^^^^^ not a value\n \n error[E0423]: expected value, found tool attribute `rustfmt::skip`\n-  --> $DIR/tool-attributes-misplaced-1.rs:17:5\n+  --> $DIR/tool-attributes-misplaced-1.rs:16:5\n    |\n LL |     rustfmt::skip;\n    |     ^^^^^^^^^^^^^ not a value\n \n-error: aborting due to 6 previous errors\n+error: aborting due to 7 previous errors\n \n-For more information about this error, try `rustc --explain E0423`.\n+Some errors have detailed explanations: E0423, E0658.\n+For more information about an error, try `rustc --explain E0423`."}]}