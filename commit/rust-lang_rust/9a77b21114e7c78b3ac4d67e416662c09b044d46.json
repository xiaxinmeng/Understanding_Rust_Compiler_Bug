{"sha": "9a77b21114e7c78b3ac4d67e416662c09b044d46", "node_id": "C_kwDOAAsO6NoAKDlhNzdiMjExMTRlN2M3OGIzYWM0ZDY3ZTQxNjY2MmMwOWIwNDRkNDY", "commit": {"author": {"name": "Eric Huss", "email": "eric@huss.org", "date": "2021-09-30T02:33:43Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-09-30T02:33:43Z"}, "message": "Rollup merge of #89366 - GuillaumeGomez:remove-lazy-static, r=jyn514\n\nrustdoc: Remove lazy_static dependency\n\nThe macro was used in only one place and there are equivalents in the std, so it seemed weird to keep it around...\n\nI think running a perf check would be a good idea though, just in case.\n\nr? ``@jyn514``", "tree": {"sha": "a3fa559d863e91b713e979a15e0bef6d2262fc5e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a3fa559d863e91b713e979a15e0bef6d2262fc5e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9a77b21114e7c78b3ac4d67e416662c09b044d46", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhVSIHCRBK7hj4Ov3rIwAAggEIAAHF0Mf/hK6mkvNsnm8uIPve\n3qC+xWSTaNBqIJBQnGYtuPIG7+BPnACXlIJX07HA2zpEsa/dN7eMbbK/wzhR2/7A\nUXcEeUj5svIPj/7xAFXZv+7Hqyrg+psyxEEMAwpN6STs9xX8GYEODLty3eJRliZD\ndcIXXs1ZWPUXYa1pN31Un157GnhalZiFxOVqOKRCnjCViJg2DTkrkvBZj4fsoy9N\nnNSx9ACmcMumBFKV9xs4JnSL5a00+sEIhJ4EwQeXYBP5y9olF4YM0Xck5Lf5if0w\nfGzlRhL5Ph7/PlNJhIyWVzM2CT6X29Z+34un3XVmw17id0FvjitOLLlUYpfB1ms=\n=vnZN\n-----END PGP SIGNATURE-----\n", "payload": "tree a3fa559d863e91b713e979a15e0bef6d2262fc5e\nparent 8f9f3aa04d0fc5dff13f8e045f30fc96a4928703\nparent a0f4e783fcf2c5942580d50199a5cae97085c150\nauthor Eric Huss <eric@huss.org> 1632969223 -0700\ncommitter GitHub <noreply@github.com> 1632969223 -0700\n\nRollup merge of #89366 - GuillaumeGomez:remove-lazy-static, r=jyn514\n\nrustdoc: Remove lazy_static dependency\n\nThe macro was used in only one place and there are equivalents in the std, so it seemed weird to keep it around...\n\nI think running a perf check would be a good idea though, just in case.\n\nr? ``@jyn514``\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9a77b21114e7c78b3ac4d67e416662c09b044d46", "html_url": "https://github.com/rust-lang/rust/commit/9a77b21114e7c78b3ac4d67e416662c09b044d46", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9a77b21114e7c78b3ac4d67e416662c09b044d46/comments", "author": {"login": "ehuss", "id": 43198, "node_id": "MDQ6VXNlcjQzMTk4", "avatar_url": "https://avatars.githubusercontent.com/u/43198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ehuss", "html_url": "https://github.com/ehuss", "followers_url": "https://api.github.com/users/ehuss/followers", "following_url": "https://api.github.com/users/ehuss/following{/other_user}", "gists_url": "https://api.github.com/users/ehuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/ehuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ehuss/subscriptions", "organizations_url": "https://api.github.com/users/ehuss/orgs", "repos_url": "https://api.github.com/users/ehuss/repos", "events_url": "https://api.github.com/users/ehuss/events{/privacy}", "received_events_url": "https://api.github.com/users/ehuss/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8f9f3aa04d0fc5dff13f8e045f30fc96a4928703", "url": "https://api.github.com/repos/rust-lang/rust/commits/8f9f3aa04d0fc5dff13f8e045f30fc96a4928703", "html_url": "https://github.com/rust-lang/rust/commit/8f9f3aa04d0fc5dff13f8e045f30fc96a4928703"}, {"sha": "a0f4e783fcf2c5942580d50199a5cae97085c150", "url": "https://api.github.com/repos/rust-lang/rust/commits/a0f4e783fcf2c5942580d50199a5cae97085c150", "html_url": "https://github.com/rust-lang/rust/commit/a0f4e783fcf2c5942580d50199a5cae97085c150"}], "stats": {"total": 8, "additions": 3, "deletions": 5}, "files": [{"sha": "074744b3d11e2443cb4f9cf4a2b5a7ce99e8a251", "filename": "src/librustdoc/core.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/9a77b21114e7c78b3ac4d67e416662c09b044d46/src%2Flibrustdoc%2Fcore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9a77b21114e7c78b3ac4d67e416662c09b044d46/src%2Flibrustdoc%2Fcore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fcore.rs?ref=9a77b21114e7c78b3ac4d67e416662c09b044d46", "patch": "@@ -25,6 +25,7 @@ use rustc_span::symbol::sym;\n use rustc_span::Span;\n \n use std::cell::RefCell;\n+use std::lazy::SyncLazy;\n use std::mem;\n use std::rc::Rc;\n \n@@ -271,9 +272,8 @@ crate fn create_config(\n             providers.typeck_item_bodies = |_, _| {};\n             // hack so that `used_trait_imports` won't try to call typeck\n             providers.used_trait_imports = |_, _| {\n-                lazy_static! {\n-                    static ref EMPTY_SET: FxHashSet<LocalDefId> = FxHashSet::default();\n-                }\n+                static EMPTY_SET: SyncLazy<FxHashSet<LocalDefId>> =\n+                    SyncLazy::new(FxHashSet::default);\n                 &EMPTY_SET\n             };\n             // In case typeck does end up being called, don't ICE in case there were name resolution errors"}, {"sha": "efc8e31498a9c9c50d09fa75ddf1eb049e03f876", "filename": "src/librustdoc/lib.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9a77b21114e7c78b3ac4d67e416662c09b044d46/src%2Flibrustdoc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9a77b21114e7c78b3ac4d67e416662c09b044d46/src%2Flibrustdoc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Flib.rs?ref=9a77b21114e7c78b3ac4d67e416662c09b044d46", "patch": "@@ -18,8 +18,6 @@\n #![recursion_limit = \"256\"]\n #![warn(rustc::internal)]\n \n-#[macro_use]\n-extern crate lazy_static;\n #[macro_use]\n extern crate tracing;\n "}]}