{"sha": "9428e2e25e95009648b63fa142e85f643a6fbf2d", "node_id": "C_kwDOAAsO6NoAKDk0MjhlMmUyNWU5NTAwOTY0OGI2M2ZhMTQyZTg1ZjY0M2E2ZmJmMmQ", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-06-02T12:05:27Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-06-02T12:05:27Z"}, "message": "Auto merge of #8905 - c410-f3r:arith, r=llogiq\n\n[1/N] Implement Arithmetic lint\n\nAssuming that https://github.com/rust-lang/rust-clippy/issues/8903 is OK, this PR starts the creation of the `Arithmetic` lint with configurable types.\n\nMy current struggle to get a rustc review inspired me to create smaller PRs in order to easy review and make merges as fast as possible. So the first step here only moves the `arithmetic.rs` file to `numeric_arithmetic.rs` to make room for the new lint.\n\n--\nchangelog: none", "tree": {"sha": "bae69a37868ce5ebce8ebd223b28c9a75951098c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bae69a37868ce5ebce8ebd223b28c9a75951098c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9428e2e25e95009648b63fa142e85f643a6fbf2d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9428e2e25e95009648b63fa142e85f643a6fbf2d", "html_url": "https://github.com/rust-lang/rust/commit/9428e2e25e95009648b63fa142e85f643a6fbf2d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9428e2e25e95009648b63fa142e85f643a6fbf2d/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0d5ace3ed22fdd6ee25ee1dda42139d36c0aeec4", "url": "https://api.github.com/repos/rust-lang/rust/commits/0d5ace3ed22fdd6ee25ee1dda42139d36c0aeec4", "html_url": "https://github.com/rust-lang/rust/commit/0d5ace3ed22fdd6ee25ee1dda42139d36c0aeec4"}, {"sha": "4fc0ee6260d686efc128e44b7b0d0e3d820fff20", "url": "https://api.github.com/repos/rust-lang/rust/commits/4fc0ee6260d686efc128e44b7b0d0e3d820fff20", "html_url": "https://github.com/rust-lang/rust/commit/4fc0ee6260d686efc128e44b7b0d0e3d820fff20"}], "stats": {"total": 18, "additions": 9, "deletions": 9}, "files": [{"sha": "ea8040a319b44ef3187ab69e547cfdb97309137a", "filename": "clippy_lints/src/lib.register_lints.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9428e2e25e95009648b63fa142e85f643a6fbf2d/clippy_lints%2Fsrc%2Flib.register_lints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9428e2e25e95009648b63fa142e85f643a6fbf2d/clippy_lints%2Fsrc%2Flib.register_lints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.register_lints.rs?ref=9428e2e25e95009648b63fa142e85f643a6fbf2d", "patch": "@@ -36,8 +36,6 @@ store.register_lints(&[\n     absurd_extreme_comparisons::ABSURD_EXTREME_COMPARISONS,\n     almost_complete_letter_range::ALMOST_COMPLETE_LETTER_RANGE,\n     approx_const::APPROX_CONSTANT,\n-    arithmetic::FLOAT_ARITHMETIC,\n-    arithmetic::INTEGER_ARITHMETIC,\n     as_conversions::AS_CONVERSIONS,\n     asm_syntax::INLINE_ASM_X86_ATT_SYNTAX,\n     asm_syntax::INLINE_ASM_X86_INTEL_SYNTAX,\n@@ -423,6 +421,8 @@ store.register_lints(&[\n     non_octal_unix_permissions::NON_OCTAL_UNIX_PERMISSIONS,\n     non_send_fields_in_send_ty::NON_SEND_FIELDS_IN_SEND_TY,\n     nonstandard_macro_braces::NONSTANDARD_MACRO_BRACES,\n+    numeric_arithmetic::FLOAT_ARITHMETIC,\n+    numeric_arithmetic::INTEGER_ARITHMETIC,\n     octal_escapes::OCTAL_ESCAPES,\n     only_used_in_recursion::ONLY_USED_IN_RECURSION,\n     open_options::NONSENSICAL_OPEN_OPTIONS,"}, {"sha": "304b595541aa66cc92da17a33e5e37e1145476c2", "filename": "clippy_lints/src/lib.register_restriction.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9428e2e25e95009648b63fa142e85f643a6fbf2d/clippy_lints%2Fsrc%2Flib.register_restriction.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9428e2e25e95009648b63fa142e85f643a6fbf2d/clippy_lints%2Fsrc%2Flib.register_restriction.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.register_restriction.rs?ref=9428e2e25e95009648b63fa142e85f643a6fbf2d", "patch": "@@ -3,8 +3,6 @@\n // Manual edits will be overwritten.\n \n store.register_group(true, \"clippy::restriction\", Some(\"clippy_restriction\"), vec![\n-    LintId::of(arithmetic::FLOAT_ARITHMETIC),\n-    LintId::of(arithmetic::INTEGER_ARITHMETIC),\n     LintId::of(as_conversions::AS_CONVERSIONS),\n     LintId::of(asm_syntax::INLINE_ASM_X86_ATT_SYNTAX),\n     LintId::of(asm_syntax::INLINE_ASM_X86_INTEL_SYNTAX),\n@@ -50,6 +48,8 @@ store.register_group(true, \"clippy::restriction\", Some(\"clippy_restriction\"), ve\n     LintId::of(module_style::MOD_MODULE_FILES),\n     LintId::of(module_style::SELF_NAMED_MODULE_FILES),\n     LintId::of(modulo_arithmetic::MODULO_ARITHMETIC),\n+    LintId::of(numeric_arithmetic::FLOAT_ARITHMETIC),\n+    LintId::of(numeric_arithmetic::INTEGER_ARITHMETIC),\n     LintId::of(panic_in_result_fn::PANIC_IN_RESULT_FN),\n     LintId::of(panic_unimplemented::PANIC),\n     LintId::of(panic_unimplemented::TODO),"}, {"sha": "89b65ce5469710fa7f1e5c7c2768f1f4b0e40710", "filename": "clippy_lints/src/lib.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9428e2e25e95009648b63fa142e85f643a6fbf2d/clippy_lints%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9428e2e25e95009648b63fa142e85f643a6fbf2d/clippy_lints%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.rs?ref=9428e2e25e95009648b63fa142e85f643a6fbf2d", "patch": "@@ -170,7 +170,6 @@ mod renamed_lints;\n mod absurd_extreme_comparisons;\n mod almost_complete_letter_range;\n mod approx_const;\n-mod arithmetic;\n mod as_conversions;\n mod asm_syntax;\n mod assertions_on_constants;\n@@ -331,6 +330,7 @@ mod non_expressive_names;\n mod non_octal_unix_permissions;\n mod non_send_fields_in_send_ty;\n mod nonstandard_macro_braces;\n+mod numeric_arithmetic;\n mod octal_escapes;\n mod only_used_in_recursion;\n mod open_options;\n@@ -683,7 +683,7 @@ pub fn register_plugins(store: &mut rustc_lint::LintStore, sess: &Session, conf:\n     store.register_late_pass(move || Box::new(doc::DocMarkdown::new(doc_valid_idents.clone())));\n     store.register_late_pass(|| Box::new(neg_multiply::NegMultiply));\n     store.register_late_pass(|| Box::new(mem_forget::MemForget));\n-    store.register_late_pass(|| Box::new(arithmetic::Arithmetic::default()));\n+    store.register_late_pass(|| Box::new(numeric_arithmetic::NumericArithmetic::default()));\n     store.register_late_pass(|| Box::new(assign_ops::AssignOps));\n     store.register_late_pass(|| Box::new(let_if_seq::LetIfSeq));\n     store.register_late_pass(|| Box::new(mixed_read_write_in_expression::EvalOrderDependence));"}, {"sha": "5c4de3381496cd839567ba17a5b2de1eef2e2b99", "filename": "clippy_lints/src/numeric_arithmetic.rs", "status": "renamed", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/9428e2e25e95009648b63fa142e85f643a6fbf2d/clippy_lints%2Fsrc%2Fnumeric_arithmetic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9428e2e25e95009648b63fa142e85f643a6fbf2d/clippy_lints%2Fsrc%2Fnumeric_arithmetic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fnumeric_arithmetic.rs?ref=9428e2e25e95009648b63fa142e85f643a6fbf2d", "patch": "@@ -51,16 +51,16 @@ declare_clippy_lint! {\n }\n \n #[derive(Copy, Clone, Default)]\n-pub struct Arithmetic {\n+pub struct NumericArithmetic {\n     expr_span: Option<Span>,\n     /// This field is used to check whether expressions are constants, such as in enum discriminants\n     /// and consts\n     const_span: Option<Span>,\n }\n \n-impl_lint_pass!(Arithmetic => [INTEGER_ARITHMETIC, FLOAT_ARITHMETIC]);\n+impl_lint_pass!(NumericArithmetic => [INTEGER_ARITHMETIC, FLOAT_ARITHMETIC]);\n \n-impl<'tcx> LateLintPass<'tcx> for Arithmetic {\n+impl<'tcx> LateLintPass<'tcx> for NumericArithmetic {\n     fn check_expr(&mut self, cx: &LateContext<'tcx>, expr: &'tcx hir::Expr<'_>) {\n         if self.expr_span.is_some() {\n             return;", "previous_filename": "clippy_lints/src/arithmetic.rs"}]}