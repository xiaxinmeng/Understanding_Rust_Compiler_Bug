{"sha": "d107ca12b83b679ed7aab54a72fcd0d01b511ed8", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQxMDdjYTEyYjgzYjY3OWVkN2FhYjU0YTcyZmNkMGQwMWI1MTFlZDg=", "commit": {"author": {"name": "Nick Cameron", "email": "ncameron@mozilla.com", "date": "2017-03-09T01:47:29Z"}, "committer": {"name": "Nick Cameron", "email": "ncameron@mozilla.com", "date": "2017-03-09T01:47:29Z"}, "message": "Use trailing commas if block formatting fn args\n\nFixes #1330", "tree": {"sha": "ebe3b19e419fb592b4030cc6e124e124d8aebdbb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ebe3b19e419fb592b4030cc6e124e124d8aebdbb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d107ca12b83b679ed7aab54a72fcd0d01b511ed8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d107ca12b83b679ed7aab54a72fcd0d01b511ed8", "html_url": "https://github.com/rust-lang/rust/commit/d107ca12b83b679ed7aab54a72fcd0d01b511ed8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d107ca12b83b679ed7aab54a72fcd0d01b511ed8/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6025492245ec0028b09477261418176a197b3ebc", "url": "https://api.github.com/repos/rust-lang/rust/commits/6025492245ec0028b09477261418176a197b3ebc", "html_url": "https://github.com/rust-lang/rust/commit/6025492245ec0028b09477261418176a197b3ebc"}], "stats": {"total": 80, "additions": 40, "deletions": 40}, "files": [{"sha": "8f35d58e9193b20aa04686e31c2b7a59a73478f6", "filename": "src/items.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/d107ca12b83b679ed7aab54a72fcd0d01b511ed8/src%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d107ca12b83b679ed7aab54a72fcd0d01b511ed8/src%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fitems.rs?ref=d107ca12b83b679ed7aab54a72fcd0d01b511ed8", "patch": "@@ -1776,16 +1776,16 @@ fn rewrite_args(context: &RewriteContext,\n \n     debug!(\"rewrite_args: budget: {}, tactic: {:?}\", budget, tactic);\n \n-    let end_with_newline = match context.config.fn_args_layout {\n-        FnArgLayoutStyle::Block |\n-        FnArgLayoutStyle::BlockAlways => true,\n-        _ => false,\n+    let (trailing_comma, end_with_newline) = match context.config.fn_args_layout {\n+        FnArgLayoutStyle::Block => (SeparatorTactic::Vertical, true),\n+        FnArgLayoutStyle::BlockAlways => (SeparatorTactic::Always, true),\n+        _ => (SeparatorTactic::Never, false),\n     };\n \n     let fmt = ListFormatting {\n         tactic: tactic,\n         separator: \",\",\n-        trailing_separator: SeparatorTactic::Never,\n+        trailing_separator: trailing_comma,\n         shape: Shape::legacy(budget, indent),\n         ends_with_newline: end_with_newline,\n         config: context.config,"}, {"sha": "2da0d5c28d66be81039ece621efe221ef0d8ea82", "filename": "tests/target/fn-custom-6.rs", "status": "modified", "additions": 10, "deletions": 10, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/d107ca12b83b679ed7aab54a72fcd0d01b511ed8/tests%2Ftarget%2Ffn-custom-6.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d107ca12b83b679ed7aab54a72fcd0d01b511ed8/tests%2Ftarget%2Ffn-custom-6.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Ffn-custom-6.rs?ref=d107ca12b83b679ed7aab54a72fcd0d01b511ed8", "patch": "@@ -4,7 +4,7 @@\n // Test different indents.\n \n fn foo(\n-    a: Aaaaaaaaaaaaaa, b: Bbbbbbbbbbbbbb\n+    a: Aaaaaaaaaaaaaa, b: Bbbbbbbbbbbbbb,\n ) {\n     foo();\n }\n@@ -14,13 +14,13 @@ fn bar(\n     b: Bbbbbbbbbbbbbb,\n     c: Cccccccccccccccccc,\n     d: Dddddddddddddddd,\n-    e: Eeeeeeeeeeeeeee\n+    e: Eeeeeeeeeeeeeee,\n ) {\n     bar();\n }\n \n fn foo(\n-    a: Aaaaaaaaaaaaaa, b: Bbbbbbbbbbbbbb\n+    a: Aaaaaaaaaaaaaa, b: Bbbbbbbbbbbbbb,\n ) -> String {\n     foo();\n }\n@@ -30,13 +30,13 @@ fn bar(\n     b: Bbbbbbbbbbbbbb,\n     c: Cccccccccccccccccc,\n     d: Dddddddddddddddd,\n-    e: Eeeeeeeeeeeeeee\n+    e: Eeeeeeeeeeeeeee,\n ) -> String {\n     bar();\n }\n \n fn foo(\n-    a: Aaaaaaaaaaaaaa, b: Bbbbbbbbbbbbbb\n+    a: Aaaaaaaaaaaaaa, b: Bbbbbbbbbbbbbb,\n ) where T: UUUUUUUUUUU {\n     foo();\n }\n@@ -46,13 +46,13 @@ fn bar(\n     b: Bbbbbbbbbbbbbb,\n     c: Cccccccccccccccccc,\n     d: Dddddddddddddddd,\n-    e: Eeeeeeeeeeeeeee\n+    e: Eeeeeeeeeeeeeee,\n ) where T: UUUUUUUUUUU {\n     bar();\n }\n \n fn foo(\n-    a: Aaaaaaaaaaaaaa, b: Bbbbbbbbbbbbbb\n+    a: Aaaaaaaaaaaaaa, b: Bbbbbbbbbbbbbb,\n ) -> String\n where T: UUUUUUUUUUU {\n     foo();\n@@ -63,20 +63,20 @@ fn bar(\n     b: Bbbbbbbbbbbbbb,\n     c: Cccccccccccccccccc,\n     d: Dddddddddddddddd,\n-    e: Eeeeeeeeeeeeeee\n+    e: Eeeeeeeeeeeeeee,\n ) -> String\n where T: UUUUUUUUUUU {\n     bar();\n }\n \n trait Test {\n     fn foo(\n-        a: u8\n+        a: u8,\n     ) {\n     }\n \n     fn bar(\n-        a: u8\n+        a: u8,\n     ) -> String {\n     }\n }"}, {"sha": "c0c1b9a8aa11997987a680787c356eafc717f06c", "filename": "tests/target/fn-custom-7.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/d107ca12b83b679ed7aab54a72fcd0d01b511ed8/tests%2Ftarget%2Ffn-custom-7.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d107ca12b83b679ed7aab54a72fcd0d01b511ed8/tests%2Ftarget%2Ffn-custom-7.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Ffn-custom-7.rs?ref=d107ca12b83b679ed7aab54a72fcd0d01b511ed8", "patch": "@@ -6,7 +6,7 @@\n \n // Case with only one variable.\n fn foo(\n-    a: u8\n+    a: u8,\n ) -> u8\n {\n     bar()\n@@ -15,7 +15,7 @@ fn foo(\n // Case with 2 variables and some pre-comments.\n fn foo(\n     a: u8, // Comment 1\n-    b: u8 // Comment 2\n+    b: u8, // Comment 2\n ) -> u8\n {\n     bar()\n@@ -26,21 +26,21 @@ fn foo(\n     // Comment 1\n     a: u8,\n     // Comment 2\n-    b: u8\n+    b: u8,\n ) -> u8\n {\n     bar()\n }\n \n trait Test {\n     fn foo(\n-        a: u8\n+        a: u8,\n     )\n     {\n     }\n \n     fn bar(\n-        a: u8\n+        a: u8,\n     ) -> String\n     {\n     }"}, {"sha": "7ed0f8011407e13394e8670914abded0b9982f26", "filename": "tests/target/fn-custom-8.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/d107ca12b83b679ed7aab54a72fcd0d01b511ed8/tests%2Ftarget%2Ffn-custom-8.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d107ca12b83b679ed7aab54a72fcd0d01b511ed8/tests%2Ftarget%2Ffn-custom-8.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Ffn-custom-8.rs?ref=d107ca12b83b679ed7aab54a72fcd0d01b511ed8", "patch": "@@ -12,7 +12,7 @@ fn bar(\n     b: Bbbbbbbbbbbbbb,\n     c: Cccccccccccccccccc,\n     d: Dddddddddddddddd,\n-    e: Eeeeeeeeeeeeeee\n+    e: Eeeeeeeeeeeeeee,\n ) {\n     bar();\n }\n@@ -26,7 +26,7 @@ fn bar(\n     b: Bbbbbbbbbbbbbb,\n     c: Cccccccccccccccccc,\n     d: Dddddddddddddddd,\n-    e: Eeeeeeeeeeeeeee\n+    e: Eeeeeeeeeeeeeee,\n ) -> String {\n     bar();\n }\n@@ -41,7 +41,7 @@ fn bar(\n     b: Bbbbbbbbbbbbbb,\n     c: Cccccccccccccccccc,\n     d: Dddddddddddddddd,\n-    e: Eeeeeeeeeeeeeee\n+    e: Eeeeeeeeeeeeeee,\n ) where T: UUUUUUUUUUU {\n     bar();\n }\n@@ -56,7 +56,7 @@ fn bar(\n     b: Bbbbbbbbbbbbbb,\n     c: Cccccccccccccccccc,\n     d: Dddddddddddddddd,\n-    e: Eeeeeeeeeeeeeee\n+    e: Eeeeeeeeeeeeeee,\n ) -> String\n where T: UUUUUUUUUUU {\n     bar();"}, {"sha": "27a98cfe7f9e2a210a59b37907eaf9d725a814df", "filename": "tests/target/fn_args_layout-block.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/d107ca12b83b679ed7aab54a72fcd0d01b511ed8/tests%2Ftarget%2Ffn_args_layout-block.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d107ca12b83b679ed7aab54a72fcd0d01b511ed8/tests%2Ftarget%2Ffn_args_layout-block.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Ffn_args_layout-block.rs?ref=d107ca12b83b679ed7aab54a72fcd0d01b511ed8", "patch": "@@ -14,7 +14,7 @@ fn bar(\n     b: Bbbbbbbbbbbbbb,\n     c: Cccccccccccccccccc,\n     d: Dddddddddddddddd,\n-    e: Eeeeeeeeeeeeeee\n+    e: Eeeeeeeeeeeeeee,\n ) {\n     bar();\n }\n@@ -28,7 +28,7 @@ fn bar(\n     b: Bbbbbbbbbbbbbb,\n     c: Cccccccccccccccccc,\n     d: Dddddddddddddddd,\n-    e: Eeeeeeeeeeeeeee\n+    e: Eeeeeeeeeeeeeee,\n ) -> String {\n     bar();\n }\n@@ -42,7 +42,7 @@ fn foo(\n     b: Bbbbbbbbbbbbbb,\n     c: Cccccccccccccccccc,\n     d: Dddddddddddddddd,\n-    e: Eeeeeeeeeeeeeee // Comment 2\n+    e: Eeeeeeeeeeeeeee, // Comment 2\n ) -> u8 {\n     bar()\n }\n@@ -52,7 +52,7 @@ fn bar(\n     b: Bbbbbbbbbbbbbb,\n     c: Cccccccccccccccccc,\n     d: Dddddddddddddddd,\n-    e: Eeeeeeeeeeeeeee\n+    e: Eeeeeeeeeeeeeee,\n ) -> String\n     where X: Fooooo,\n           Y: Baaar\n@@ -107,7 +107,7 @@ trait Test {\n         b: Bbbbbbbbbbbbbb,\n         c: Cccccccccccccccccc,\n         d: Dddddddddddddddd,\n-        e: Eeeeeeeeeeeeeee\n+        e: Eeeeeeeeeeeeeee,\n     ) -> String {\n     }\n }\n@@ -116,7 +116,7 @@ fn foo<L: Loooooooooooooooooooong, G: Geeeeeeeeeeneric, I: iiiiiiiiis, L: Looooo\n     a: Aaaaaaaaaaaaaaaaaaaa,\n     b: Bbbbbbbbbbbbbbbbb,\n     c: Cccccccccccccccccc,\n-    d: Dddddddddddddddd\n+    d: Dddddddddddddddd,\n ) {\n     foo();\n }"}, {"sha": "eb5caec65201281bc6a6787c16e2bc9e5add7d63", "filename": "tests/target/fn_args_layout-blockalways.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/d107ca12b83b679ed7aab54a72fcd0d01b511ed8/tests%2Ftarget%2Ffn_args_layout-blockalways.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d107ca12b83b679ed7aab54a72fcd0d01b511ed8/tests%2Ftarget%2Ffn_args_layout-blockalways.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Ffn_args_layout-blockalways.rs?ref=d107ca12b83b679ed7aab54a72fcd0d01b511ed8", "patch": "@@ -5,7 +5,7 @@ fn foo() {\n }\n \n fn foo(\n-    a: Aaaaaaaaaaaaaa, b: Bbbbbbbbbbbbbb\n+    a: Aaaaaaaaaaaaaa, b: Bbbbbbbbbbbbbb,\n ) {\n     foo();\n }\n@@ -15,13 +15,13 @@ fn bar(\n     b: Bbbbbbbbbbbbbb,\n     c: Cccccccccccccccccc,\n     d: Dddddddddddddddd,\n-    e: Eeeeeeeeeeeeeee\n+    e: Eeeeeeeeeeeeeee,\n ) {\n     bar();\n }\n \n fn foo(\n-    a: Aaaaaaaaaaaaaa, b: Bbbbbbbbbbbbbb\n+    a: Aaaaaaaaaaaaaa, b: Bbbbbbbbbbbbbb,\n ) -> String {\n     foo();\n }\n@@ -31,19 +31,19 @@ fn bar(\n     b: Bbbbbbbbbbbbbb,\n     c: Cccccccccccccccccc,\n     d: Dddddddddddddddd,\n-    e: Eeeeeeeeeeeeeee\n+    e: Eeeeeeeeeeeeeee,\n ) -> String {\n     bar();\n }\n \n trait Test {\n     fn foo(\n-        a: u8\n+        a: u8,\n     ) {\n     }\n \n     fn bar(\n-        a: u8\n+        a: u8,\n     ) -> String {\n     }\n }"}, {"sha": "5a5892808871e4c3c1e9ac52f20e302b3a0301d5", "filename": "tests/target/where-clause-rfc.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/d107ca12b83b679ed7aab54a72fcd0d01b511ed8/tests%2Ftarget%2Fwhere-clause-rfc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d107ca12b83b679ed7aab54a72fcd0d01b511ed8/tests%2Ftarget%2Fwhere-clause-rfc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fwhere-clause-rfc.rs?ref=d107ca12b83b679ed7aab54a72fcd0d01b511ed8", "patch": "@@ -21,7 +21,7 @@ fn reflow_list_node_with_rule(\n     rule: &Rule,\n     args: &[Arg],\n     shape: &Shape,\n-    shape: &Shape\n+    shape: &Shape,\n ) where\n     T: FOo,\n     U: Bar,\n@@ -34,7 +34,7 @@ fn reflow_list_node_with_rule(\n     rule: &Rule,\n     args: &[Arg],\n     shape: &Shape,\n-    shape: &Shape\n+    shape: &Shape,\n ) where\n     T: FOo,\n {\n@@ -45,7 +45,7 @@ fn reflow_list_node_with_rule(\n     node: &CompoundNode,\n     rule: &Rule,\n     args: &[Arg],\n-    shape: &Shape\n+    shape: &Shape,\n ) -> Option<String>\n where\n     T: FOo,\n@@ -58,7 +58,7 @@ fn reflow_list_node_with_rule(\n     node: &CompoundNode,\n     rule: &Rule,\n     args: &[Arg],\n-    shape: &Shape\n+    shape: &Shape,\n ) -> Option<String>\n where\n     T: FOo,"}]}