{"sha": "9270ca193f58d287d75f0115c59667792cec1e19", "node_id": "C_kwDOAAsO6NoAKDkyNzBjYTE5M2Y1OGQyODdkNzVmMDExNWM1OTY2Nzc5MmNlYzFlMTk", "commit": {"author": {"name": "Chris Denton", "email": "christophersdenton@gmail.com", "date": "2022-03-23T04:51:26Z"}, "committer": {"name": "Chris Denton", "email": "christophersdenton@gmail.com", "date": "2022-03-23T05:33:44Z"}, "message": "Add test for issue #95178", "tree": {"sha": "d0a509a56e2eeccf88d9a2805d9dc0766447415e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d0a509a56e2eeccf88d9a2805d9dc0766447415e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9270ca193f58d287d75f0115c59667792cec1e19", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE+p/jD6jrzmnSIWJLcTRy8vRWJ94FAmI6sTkACgkQcTRy8vRW\nJ95DJQ/+MgiPiI90LHoTtN2+sIAgxZG2ebazMn+1Jgi3i27PGWAb2yZp9yA6jCUB\n+8cbdVxI9jJerLdsRXwI+0KAFn432V/EPMvJpz1lU7QbcMdaaUKjaTH7IhWdH1e3\nJS7XPnb4j7Cp0UwVUPM/29tdjCOj9whbnibVDOSJsx87AW/xVZG/Zr3Rx3uMH6SY\nbCBUsZYpZx2m44w4VGrEZBve5zMvicQP+Wf3PudK6pEZOGDO56u9XiFwieQJoPvz\n/obB5AlcMl9nWc/zJIibU4otvyTIXCxDD8rwCRrQlHMxUEozOK+B8OoLq3wWzUs+\nA3ZDD9vMJr2f7E3L6ljJUIX95Vp51T1E5ZcllTswOJiAAkqmOQQwEjo2u+7dBhch\nBml9Z2QuEBZYE5F+QNJd0A9OTlr40hemDkSNiCLdyoIBoBh6y88ZJiN9Fc+sX1Ye\nnvQkUNMrSxgTetD3gCsHxzk0deGEVgteeAPJnW55T9UomAx5xX1DRniTj12jkcQl\ngpzXJCaOsM6cpMhbEpJq48w9xweOolYv7vLZ26DZZ1oIyDK9Cky8G4teojijkA4g\nLXjjTCLBj8rA+DPEZi0B5QOuPv8ga5GoBk/YhTZPdZofG2vFCrM9GEBxI0SvFy5O\nory+rDI2FS1ELThhAHQRIbustaM/c/vG6VZukC6sCIzc9WihI+4=\n=vLay\n-----END PGP SIGNATURE-----", "payload": "tree d0a509a56e2eeccf88d9a2805d9dc0766447415e\nparent 23320a2f8314a929020ea08b2e8d9e45116cf7d5\nauthor Chris Denton <christophersdenton@gmail.com> 1648011086 +0000\ncommitter Chris Denton <christophersdenton@gmail.com> 1648013624 +0000\n\nAdd test for issue #95178\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9270ca193f58d287d75f0115c59667792cec1e19", "html_url": "https://github.com/rust-lang/rust/commit/9270ca193f58d287d75f0115c59667792cec1e19", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9270ca193f58d287d75f0115c59667792cec1e19/comments", "author": {"login": "ChrisDenton", "id": 4459874, "node_id": "MDQ6VXNlcjQ0NTk4NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4459874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChrisDenton", "html_url": "https://github.com/ChrisDenton", "followers_url": "https://api.github.com/users/ChrisDenton/followers", "following_url": "https://api.github.com/users/ChrisDenton/following{/other_user}", "gists_url": "https://api.github.com/users/ChrisDenton/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChrisDenton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChrisDenton/subscriptions", "organizations_url": "https://api.github.com/users/ChrisDenton/orgs", "repos_url": "https://api.github.com/users/ChrisDenton/repos", "events_url": "https://api.github.com/users/ChrisDenton/events{/privacy}", "received_events_url": "https://api.github.com/users/ChrisDenton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ChrisDenton", "id": 4459874, "node_id": "MDQ6VXNlcjQ0NTk4NzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4459874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChrisDenton", "html_url": "https://github.com/ChrisDenton", "followers_url": "https://api.github.com/users/ChrisDenton/followers", "following_url": "https://api.github.com/users/ChrisDenton/following{/other_user}", "gists_url": "https://api.github.com/users/ChrisDenton/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChrisDenton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChrisDenton/subscriptions", "organizations_url": "https://api.github.com/users/ChrisDenton/orgs", "repos_url": "https://api.github.com/users/ChrisDenton/repos", "events_url": "https://api.github.com/users/ChrisDenton/events{/privacy}", "received_events_url": "https://api.github.com/users/ChrisDenton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "23320a2f8314a929020ea08b2e8d9e45116cf7d5", "url": "https://api.github.com/repos/rust-lang/rust/commits/23320a2f8314a929020ea08b2e8d9e45116cf7d5", "html_url": "https://github.com/rust-lang/rust/commit/23320a2f8314a929020ea08b2e8d9e45116cf7d5"}], "stats": {"total": 21, "additions": 21, "deletions": 0}, "files": [{"sha": "955ad68916c216ae5fc7493cbca3781309b1e6fe", "filename": "library/std/src/process/tests.rs", "status": "modified", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/9270ca193f58d287d75f0115c59667792cec1e19/library%2Fstd%2Fsrc%2Fprocess%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9270ca193f58d287d75f0115c59667792cec1e19/library%2Fstd%2Fsrc%2Fprocess%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fprocess%2Ftests.rs?ref=9270ca193f58d287d75f0115c59667792cec1e19", "patch": "@@ -435,3 +435,24 @@ fn run_bat_script() {\n     assert!(output.status.success());\n     assert_eq!(String::from_utf8_lossy(&output.stdout).trim(), \"Hello, fellow Rustaceans!\");\n }\n+\n+// See issue #95178\n+#[test]\n+#[cfg(windows)]\n+fn run_canonical_bat_script() {\n+    let tempdir = crate::sys_common::io::test::tmpdir();\n+    let script_path = tempdir.join(\"hello.cmd\");\n+\n+    crate::fs::write(&script_path, \"@echo Hello, %~1!\").unwrap();\n+\n+    // Try using a canonical path\n+    let output = Command::new(&script_path.canonicalize().unwrap())\n+        .arg(\"fellow Rustaceans\")\n+        .stdout(crate::process::Stdio::piped())\n+        .spawn()\n+        .unwrap()\n+        .wait_with_output()\n+        .unwrap();\n+    assert!(output.status.success());\n+    assert_eq!(String::from_utf8_lossy(&output.stdout).trim(), \"Hello, fellow Rustaceans!\");\n+}"}]}