{"sha": "c052a491f15c917bd8a7b65983ecb422ef529ea4", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMwNTJhNDkxZjE1YzkxN2JkOGE3YjY1OTgzZWNiNDIyZWY1MjllYTQ=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-07-17T10:15:37Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-07-17T11:24:55Z"}, "message": "Rollup merge of #52446 - kennytm:block-beta-on-clippy, r=nrc\n\nBlock beta if clippy breaks.\n\nAlso, don't fail master pull request when an unrelated tool is not test-pass.", "tree": {"sha": "5cd1caa1e442b7bae53715eeb6599b3be2726cd6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5cd1caa1e442b7bae53715eeb6599b3be2726cd6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c052a491f15c917bd8a7b65983ecb422ef529ea4", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAltN0ggACgkQ/vbIBR0O\nATzdew//Qm/+XUDg7oVixGxNcFWAh8IWTL9VTDpLDCCZkHOgIHGooqOVtZsU1NR2\nobG0Y2tT+OK5O4M6/5ywAwTqQFgzYYsD1b1pZG2bVDORoj8Klt6IdJK/60/HIK4F\nS/R0oLSJlA33SJkyrWFNeORXeTP/vXWUlU+A50skLtM3aE0KqNV5SHDDc9qb3mD0\nU3rHVYYuv+0chhfNLaYRqdlFXVakI9kPzgZ112uo1sllPAgoZyuqqcVD+lfUqGXY\n8+AnPDY/oGvmkBuxVOFdmOjsd+keqcbeUUeS5MDDp3Pwy9p4pzUAQsI+qlhKU1OV\njFRelN4q8vkBN7/pUwYRnGTahScDcIvGgL6nrkDSj0FhNXdwYiitRtH9uwDl3GKN\nd0+X0IM1XtHNIeR7YW3AicWQFsrSe8kLHXjaVoLemnXwAY/E2BF+Lil06nCoySvX\nJXNJFetOlme/0fKhvk8VTSIAll6YFzy5RJoUqniEvshennxSqEht2bcA2stDg6gk\nxFjIxI73kN1rbU+XZKwS+tYxUbkMik9CeW/PHL07AcgPn2N3LZT/P2T0/8FxHmGa\nIY3heAI7ADTM5tWOcdIIB14lLU6mQSj7aqzrAJD8956FV89CxM3zqI7oaeb1H9bZ\nvTjKrtlkg9XQYEfkSX5DOi5BPcrs1QqduCUCUZJEoPHahsmDZK8=\n=dNFv\n-----END PGP SIGNATURE-----", "payload": "tree 5cd1caa1e442b7bae53715eeb6599b3be2726cd6\nparent 9ea0a8533e4e1708a4f412895ab51a4cb69492a4\nparent a9bcbb27b8d0cc3331ada98bc8cadcbb4073ff10\nauthor kennytm <kennytm@gmail.com> 1531822537 +0800\ncommitter kennytm <kennytm@gmail.com> 1531826695 +0800\n\nRollup merge of #52446 - kennytm:block-beta-on-clippy, r=nrc\n\nBlock beta if clippy breaks.\n\nAlso, don't fail master pull request when an unrelated tool is not test-pass.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c052a491f15c917bd8a7b65983ecb422ef529ea4", "html_url": "https://github.com/rust-lang/rust/commit/c052a491f15c917bd8a7b65983ecb422ef529ea4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c052a491f15c917bd8a7b65983ecb422ef529ea4/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9ea0a8533e4e1708a4f412895ab51a4cb69492a4", "url": "https://api.github.com/repos/rust-lang/rust/commits/9ea0a8533e4e1708a4f412895ab51a4cb69492a4", "html_url": "https://github.com/rust-lang/rust/commit/9ea0a8533e4e1708a4f412895ab51a4cb69492a4"}, {"sha": "a9bcbb27b8d0cc3331ada98bc8cadcbb4073ff10", "url": "https://api.github.com/repos/rust-lang/rust/commits/a9bcbb27b8d0cc3331ada98bc8cadcbb4073ff10", "html_url": "https://github.com/rust-lang/rust/commit/a9bcbb27b8d0cc3331ada98bc8cadcbb4073ff10"}], "stats": {"total": 16, "additions": 9, "deletions": 7}, "files": [{"sha": "f6d375058a77205c5d23d405218ea128ef40ae9d", "filename": "src/ci/docker/x86_64-gnu-tools/checktools.sh", "status": "modified", "additions": 9, "deletions": 7, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/c052a491f15c917bd8a7b65983ecb422ef529ea4/src%2Fci%2Fdocker%2Fx86_64-gnu-tools%2Fchecktools.sh", "raw_url": "https://github.com/rust-lang/rust/raw/c052a491f15c917bd8a7b65983ecb422ef529ea4/src%2Fci%2Fdocker%2Fx86_64-gnu-tools%2Fchecktools.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fx86_64-gnu-tools%2Fchecktools.sh?ref=c052a491f15c917bd8a7b65983ecb422ef529ea4", "patch": "@@ -81,8 +81,8 @@ status_check() {\n     check_dispatch $1 beta rust-by-example src/doc/rust-by-example\n     check_dispatch $1 beta rls src/tools/rls\n     check_dispatch $1 beta rustfmt src/tools/rustfmt\n+    check_dispatch $1 beta clippy-driver src/tools/clippy\n     # these tools are not required for beta to successfully branch\n-    check_dispatch $1 nightly clippy-driver src/tools/clippy\n     check_dispatch $1 nightly miri src/tools/miri\n }\n \n@@ -106,12 +106,14 @@ $COMMIT\\t$(cat \"$TOOLSTATE_FILE\")\n     fi\n }\n \n-if [ \"$RUST_RELEASE_CHANNEL\" = nightly -a -n \"${TOOLSTATE_REPO_ACCESS_TOKEN+is_set}\" ]; then\n-    . \"$(dirname $0)/repo.sh\"\n-    MESSAGE_FILE=$(mktemp -t msg.XXXXXX)\n-    echo \"($OS CI update)\" > \"$MESSAGE_FILE\"\n-    commit_toolstate_change \"$MESSAGE_FILE\" change_toolstate\n-    rm -f \"$MESSAGE_FILE\"\n+if [ \"$RUST_RELEASE_CHANNEL\" = nightly ]; then\n+    if [ -n \"${TOOLSTATE_REPO_ACCESS_TOKEN+is_set}\" ]; then\n+        . \"$(dirname $0)/repo.sh\"\n+        MESSAGE_FILE=$(mktemp -t msg.XXXXXX)\n+        echo \"($OS CI update)\" > \"$MESSAGE_FILE\"\n+        commit_toolstate_change \"$MESSAGE_FILE\" change_toolstate\n+        rm -f \"$MESSAGE_FILE\"\n+    fi\n     exit 0\n fi\n "}]}