{"sha": "ca757183fedf8e89286372b91ca074c11d99c4f4", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNhNzU3MTgzZmVkZjhlODkyODYzNzJiOTFjYTA3NGMxMWQ5OWM0ZjQ=", "commit": {"author": {"name": "Marcus Klaas de Vries", "email": "mail@marcusklaas.nl", "date": "2016-03-22T09:14:04Z"}, "committer": {"name": "Marcus Klaas de Vries", "email": "mail@marcusklaas.nl", "date": "2016-03-22T09:14:04Z"}, "message": "Merge pull request #864 from Venti-/fn-density\n\nAdd option for vertical function argument list", "tree": {"sha": "0637fd97e554176c2cb6180202f12d57edc830d1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0637fd97e554176c2cb6180202f12d57edc830d1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ca757183fedf8e89286372b91ca074c11d99c4f4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ca757183fedf8e89286372b91ca074c11d99c4f4", "html_url": "https://github.com/rust-lang/rust/commit/ca757183fedf8e89286372b91ca074c11d99c4f4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ca757183fedf8e89286372b91ca074c11d99c4f4/comments", "author": {"login": "marcusklaas", "id": 1255413, "node_id": "MDQ6VXNlcjEyNTU0MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1255413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marcusklaas", "html_url": "https://github.com/marcusklaas", "followers_url": "https://api.github.com/users/marcusklaas/followers", "following_url": "https://api.github.com/users/marcusklaas/following{/other_user}", "gists_url": "https://api.github.com/users/marcusklaas/gists{/gist_id}", "starred_url": "https://api.github.com/users/marcusklaas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marcusklaas/subscriptions", "organizations_url": "https://api.github.com/users/marcusklaas/orgs", "repos_url": "https://api.github.com/users/marcusklaas/repos", "events_url": "https://api.github.com/users/marcusklaas/events{/privacy}", "received_events_url": "https://api.github.com/users/marcusklaas/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marcusklaas", "id": 1255413, "node_id": "MDQ6VXNlcjEyNTU0MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1255413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marcusklaas", "html_url": "https://github.com/marcusklaas", "followers_url": "https://api.github.com/users/marcusklaas/followers", "following_url": "https://api.github.com/users/marcusklaas/following{/other_user}", "gists_url": "https://api.github.com/users/marcusklaas/gists{/gist_id}", "starred_url": "https://api.github.com/users/marcusklaas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marcusklaas/subscriptions", "organizations_url": "https://api.github.com/users/marcusklaas/orgs", "repos_url": "https://api.github.com/users/marcusklaas/repos", "events_url": "https://api.github.com/users/marcusklaas/events{/privacy}", "received_events_url": "https://api.github.com/users/marcusklaas/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4cb043112bb3d4f6212678eb6cf97952f0d68350", "url": "https://api.github.com/repos/rust-lang/rust/commits/4cb043112bb3d4f6212678eb6cf97952f0d68350", "html_url": "https://github.com/rust-lang/rust/commit/4cb043112bb3d4f6212678eb6cf97952f0d68350"}, {"sha": "8d299210a6bee1ead0301073c72b5671ce4d8c84", "url": "https://api.github.com/repos/rust-lang/rust/commits/8d299210a6bee1ead0301073c72b5671ce4d8c84", "html_url": "https://github.com/rust-lang/rust/commit/8d299210a6bee1ead0301073c72b5671ce4d8c84"}], "stats": {"total": 130, "additions": 129, "deletions": 1}, "files": [{"sha": "32eb9af4b118378b0111086f518b0bae9e6c656a", "filename": "src/config.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/ca757183fedf8e89286372b91ca074c11d99c4f4/src%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ca757183fedf8e89286372b91ca074c11d99c4f4/src%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fconfig.rs?ref=ca757183fedf8e89286372b91ca074c11d99c4f4", "patch": "@@ -71,6 +71,8 @@ configuration_option_enum! { Density:\n     Tall,\n     // Try to compress if the body is empty.\n     CompressedIfEmpty,\n+    // Place every item on a separate line.\n+    Vertical,\n }\n \n configuration_option_enum! { TypeDensity:\n@@ -85,6 +87,7 @@ impl Density {\n         match self {\n             Density::Compressed => ListTactic::Mixed,\n             Density::Tall | Density::CompressedIfEmpty => ListTactic::HorizontalVertical,\n+            Density::Vertical => ListTactic::Vertical,\n         }\n     }\n }"}, {"sha": "04382489b2808442eb3c5eea264ba9ab72a6fb92", "filename": "src/items.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/ca757183fedf8e89286372b91ca074c11d99c4f4/src%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ca757183fedf8e89286372b91ca074c11d99c4f4/src%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fitems.rs?ref=ca757183fedf8e89286372b91ca074c11d99c4f4", "patch": "@@ -1544,13 +1544,18 @@ fn rewrite_args(context: &RewriteContext,\n         _ => multi_line_budget,\n     };\n \n+    let end_with_newline = match context.config.fn_args_layout {\n+        StructLitStyle::Block => true,\n+        _ => false,\n+    };\n+\n     let fmt = ListFormatting {\n         tactic: tactic,\n         separator: \",\",\n         trailing_separator: SeparatorTactic::Never,\n         indent: indent,\n         width: budget,\n-        ends_with_newline: false,\n+        ends_with_newline: end_with_newline,\n         config: context.config,\n     };\n "}, {"sha": "6a56c440d331d178c9c6863f7daf2a5c7f74e14d", "filename": "tests/source/fn-custom-7.rs", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/ca757183fedf8e89286372b91ca074c11d99c4f4/tests%2Fsource%2Ffn-custom-7.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ca757183fedf8e89286372b91ca074c11d99c4f4/tests%2Fsource%2Ffn-custom-7.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Ffn-custom-7.rs?ref=ca757183fedf8e89286372b91ca074c11d99c4f4", "patch": "@@ -0,0 +1,19 @@\n+// rustfmt-fn_args_layout: Block\n+// rustfmt-fn_args_density: Vertical\n+// rustfmt-fn_arg_indent: Tabbed\n+// rustfmt-fn_brace_style: AlwaysNextLine\n+\n+// Case with only one variable.\n+fn foo(a: u8) -> u8 {\n+    bar()\n+}\n+\n+// Case with 2 variables and some pre-comments.\n+fn foo(a: u8 /* Comment 1 */, b: u8 /* Comment 2 */) -> u8 {\n+    bar()\n+}\n+\n+// Case with 2 variables and some post-comments.\n+fn foo(/* Comment 1 */ a: u8, /* Comment 2 */ b: u8) -> u8 {\n+    bar()\n+}"}, {"sha": "7dd4dcbfc4dd8da56cf4e8a6cc04e67642642ed2", "filename": "tests/source/fn_args_density-vertical.rs", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/ca757183fedf8e89286372b91ca074c11d99c4f4/tests%2Fsource%2Ffn_args_density-vertical.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ca757183fedf8e89286372b91ca074c11d99c4f4/tests%2Fsource%2Ffn_args_density-vertical.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Ffn_args_density-vertical.rs?ref=ca757183fedf8e89286372b91ca074c11d99c4f4", "patch": "@@ -0,0 +1,33 @@\n+// rustfmt-fn_args_density: Vertical\n+\n+// Empty list shoul stay on one line.\n+fn do_bar(\n+\n+) -> u8 {\n+    bar()\n+}\n+\n+// A single argument should stay on the same line.\n+fn do_bar(\n+        a: u8) -> u8 {\n+    bar()\n+}\n+\n+// Multiple arguments should each get their own line.\n+fn do_bar(a: u8, mut b: u8, c: &u8, d: &mut u8, closure: &Fn(i32) -> i32) -> i32 {\n+    // This feature should not affect closures.\n+    let bar = |x: i32, y: i32| -> i32 { x + y };\n+    bar(a, b)\n+}\n+\n+// If the first argument doesn't fit on the same line with the function name,\n+// the whole list should probably be pushed to the next line with hanging\n+// indent. That's not what happens though, so check current behaviour instead.\n+// In any case, it should maintain single argument per line.\n+fn do_this_that_and_the_other_thing(\n+        aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa: u8,\n+        b: u8, c: u8, d: u8) {\n+    this();\n+    that();\n+    the_other_thing();\n+}"}, {"sha": "1c4cbde24b852135b58faee2d0a7dc7767682e88", "filename": "tests/target/fn-custom-7.rs", "status": "added", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/ca757183fedf8e89286372b91ca074c11d99c4f4/tests%2Ftarget%2Ffn-custom-7.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ca757183fedf8e89286372b91ca074c11d99c4f4/tests%2Ftarget%2Ffn-custom-7.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Ffn-custom-7.rs?ref=ca757183fedf8e89286372b91ca074c11d99c4f4", "patch": "@@ -0,0 +1,32 @@\n+// rustfmt-fn_args_layout: Block\n+// rustfmt-fn_args_density: Vertical\n+// rustfmt-fn_arg_indent: Tabbed\n+// rustfmt-fn_brace_style: AlwaysNextLine\n+\n+// Case with only one variable.\n+fn foo(\n+    a: u8\n+) -> u8\n+{\n+    bar()\n+}\n+\n+// Case with 2 variables and some pre-comments.\n+fn foo(\n+    a: u8, // Comment 1\n+    b: u8 // Comment 2\n+) -> u8\n+{\n+    bar()\n+}\n+\n+// Case with 2 variables and some post-comments.\n+fn foo(\n+    // Comment 1\n+    a: u8,\n+    // Comment 2\n+    b: u8\n+) -> u8\n+{\n+    bar()\n+}"}, {"sha": "250d32654e56ac4696e629deaa962d861ef00892", "filename": "tests/target/fn_args_density-vertical.rs", "status": "added", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/ca757183fedf8e89286372b91ca074c11d99c4f4/tests%2Ftarget%2Ffn_args_density-vertical.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ca757183fedf8e89286372b91ca074c11d99c4f4/tests%2Ftarget%2Ffn_args_density-vertical.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Ffn_args_density-vertical.rs?ref=ca757183fedf8e89286372b91ca074c11d99c4f4", "patch": "@@ -0,0 +1,36 @@\n+// rustfmt-fn_args_density: Vertical\n+\n+// Empty list shoul stay on one line.\n+fn do_bar() -> u8 {\n+    bar()\n+}\n+\n+// A single argument should stay on the same line.\n+fn do_bar(a: u8) -> u8 {\n+    bar()\n+}\n+\n+// Multiple arguments should each get their own line.\n+fn do_bar(a: u8,\n+          mut b: u8,\n+          c: &u8,\n+          d: &mut u8,\n+          closure: &Fn(i32) -> i32)\n+          -> i32 {\n+    // This feature should not affect closures.\n+    let bar = |x: i32, y: i32| -> i32 { x + y };\n+    bar(a, b)\n+}\n+\n+// If the first argument doesn't fit on the same line with the function name,\n+// the whole list should probably be pushed to the next line with hanging\n+// indent. That's not what happens though, so check current behaviour instead.\n+// In any case, it should maintain single argument per line.\n+fn do_this_that_and_the_other_thing(aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa: u8,\n+                                    b: u8,\n+                                    c: u8,\n+                                    d: u8) {\n+    this();\n+    that();\n+    the_other_thing();\n+}"}]}