{"sha": "7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdlYjA0N2ExMDVlZTQyYjVkYmQ4ZjVjZjdkOTU2Y2E3YmRmZDU1MWE=", "commit": {"author": {"name": "bors[bot]", "email": "bors[bot]@users.noreply.github.com", "date": "2018-09-25T11:43:48Z"}, "committer": {"name": "bors[bot]", "email": "bors[bot]@users.noreply.github.com", "date": "2018-09-25T11:43:48Z"}, "message": "Merge #79\n\n79: Implement Folding Ranges r=matklad a=kjeremy\n\nImplements folding ranges for comments and imports.\r\n\r\nBumps LSP to 3.13\n\nCo-authored-by: Jeremy A. Kolb <jkolb@ara.com>", "tree": {"sha": "7edf00b8f1e7416b364127c31dafe02df1685587", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7edf00b8f1e7416b364127c31dafe02df1685587"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a", "html_url": "https://github.com/rust-lang/rust/commit/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "parents": [{"sha": "c2ab6ad73d2a7cd9a54dd8ee9f96dab25ec89600", "url": "https://api.github.com/repos/rust-lang/rust/commits/c2ab6ad73d2a7cd9a54dd8ee9f96dab25ec89600", "html_url": "https://github.com/rust-lang/rust/commit/c2ab6ad73d2a7cd9a54dd8ee9f96dab25ec89600"}, {"sha": "4d52d004d58ff8d0479220d22bd0adfcfd7ffa9f", "url": "https://api.github.com/repos/rust-lang/rust/commits/4d52d004d58ff8d0479220d22bd0adfcfd7ffa9f", "html_url": "https://github.com/rust-lang/rust/commit/4d52d004d58ff8d0479220d22bd0adfcfd7ffa9f"}], "stats": {"total": 284, "additions": 236, "deletions": 48}, "files": [{"sha": "815c97483ff9c2017631f5c81ca9e10131eb7d9f", "filename": "Cargo.lock", "status": "modified", "additions": 41, "deletions": 39, "changes": 80, "blob_url": "https://github.com/rust-lang/rust/blob/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a", "patch": "@@ -3,15 +3,15 @@ name = \"aho-corasick\"\n version = \"0.6.8\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"memchr 2.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"memchr 2.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n name = \"ansi_term\"\n version = \"0.11.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"winapi 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -29,7 +29,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"libc 0.2.43 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"termion 1.5.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -41,7 +41,7 @@ dependencies = [\n  \"cfg-if 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.43 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rustc-demangle 0.1.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -81,7 +81,7 @@ dependencies = [\n  \"semver 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"serde 1.0.79 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"serde_derive 1.0.79 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"serde_json 1.0.27 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"serde_json 1.0.28 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -128,7 +128,7 @@ dependencies = [\n \n [[package]]\n name = \"crossbeam-channel\"\n-version = \"0.2.5\"\n+version = \"0.2.6\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"crossbeam-epoch 0.6.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -273,13 +273,13 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n name = \"gen_lsp_server\"\n version = \"0.1.0\"\n dependencies = [\n- \"crossbeam-channel 0.2.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"crossbeam-channel 0.2.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"failure 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"languageserver-types 0.50.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"languageserver-types 0.51.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.4.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"serde 1.0.79 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"serde_derive 1.0.79 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"serde_json 1.0.27 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"serde_json 1.0.28 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -339,15 +339,15 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"languageserver-types\"\n-version = \"0.50.0\"\n+version = \"0.51.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"bitflags 1.0.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"num-derive 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"num-traits 0.2.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"serde 1.0.79 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"serde_derive 1.0.79 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"serde_json 1.0.27 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"serde_json 1.0.28 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"url 1.7.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"url_serde 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n@@ -389,10 +389,12 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n [[package]]\n name = \"memchr\"\n-version = \"2.0.2\"\n+version = \"2.1.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n+ \"cfg-if 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.43 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"version_check 0.1.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -401,7 +403,7 @@ version = \"0.6.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"libc 0.2.43 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -448,7 +450,7 @@ dependencies = [\n \n [[package]]\n name = \"once_cell\"\n-version = \"0.1.5\"\n+version = \"0.1.6\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"parking_lot 0.6.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -480,7 +482,7 @@ dependencies = [\n  \"rand 0.5.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rustc_version 0.2.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"smallvec 0.6.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -528,11 +530,11 @@ dependencies = [\n name = \"ra_analysis\"\n version = \"0.1.0\"\n dependencies = [\n- \"crossbeam-channel 0.2.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"crossbeam-channel 0.2.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"fst 0.3.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"im 12.0.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.4.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"once_cell 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"once_cell 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"parking_lot 0.6.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"ra_editor 0.1.0\",\n  \"ra_syntax 0.1.0\",\n@@ -570,13 +572,13 @@ name = \"ra_lsp_server\"\n version = \"0.1.0\"\n dependencies = [\n  \"cargo_metadata 0.6.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"crossbeam-channel 0.2.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"crossbeam-channel 0.2.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"drop_bomb 0.1.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"failure 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"flexi_logger 0.9.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"gen_lsp_server 0.1.0\",\n  \"im 12.0.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"languageserver-types 0.50.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"languageserver-types 0.51.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"log 0.4.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"ra_analysis 0.1.0\",\n  \"ra_editor 0.1.0\",\n@@ -585,7 +587,7 @@ dependencies = [\n  \"relative-path 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"serde 1.0.79 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"serde_derive 1.0.79 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"serde_json 1.0.27 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"serde_json 1.0.28 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"smol_str 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"tempdir 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"text_unit 0.1.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -614,7 +616,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"fuchsia-zircon 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.43 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -626,7 +628,7 @@ dependencies = [\n  \"fuchsia-zircon 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"libc 0.2.43 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"rand_core 0.2.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -674,7 +676,7 @@ version = \"1.0.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"aho-corasick 0.6.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"memchr 2.0.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"memchr 2.1.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"regex-syntax 0.6.2 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"thread_local 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"utf8-ranges 1.0.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -698,7 +700,7 @@ name = \"remove_dir_all\"\n version = \"0.5.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"winapi 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -784,12 +786,12 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"proc-macro2 0.4.19 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"quote 0.6.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"syn 0.15.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"syn 0.15.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n name = \"serde_json\"\n-version = \"1.0.27\"\n+version = \"1.0.28\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"itoa 0.4.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -858,7 +860,7 @@ dependencies = [\n \n [[package]]\n name = \"syn\"\n-version = \"0.15.4\"\n+version = \"0.15.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"proc-macro2 0.4.19 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -908,7 +910,7 @@ dependencies = [\n  \"pest_derive 1.0.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"regex 1.0.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"serde 1.0.79 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"serde_json 1.0.27 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"serde_json 1.0.28 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"slug 0.1.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"unic-segment 0.7.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"url 1.7.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -964,7 +966,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"libc 0.2.43 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"redox_syscall 0.1.40 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1120,13 +1122,13 @@ version = \"2.2.5\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"same-file 1.0.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n- \"winapi 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"winapi-util 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n name = \"winapi\"\n-version = \"0.3.5\"\n+version = \"0.3.6\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n  \"winapi-i686-pc-windows-gnu 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -1143,7 +1145,7 @@ name = \"winapi-util\"\n version = \"0.1.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n dependencies = [\n- \"winapi 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n [[package]]\n@@ -1167,7 +1169,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum chrono 0.4.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"45912881121cb26fad7c38c17ba7daa18764771836b34fab7d3fbd93ed633878\"\n \"checksum clap 2.32.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b957d88f4b6a63b9d70d5f454ac8011819c6efa7727858f458ab71c756ce2d3e\"\n \"checksum cloudabi 0.0.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ddfc5b9aa5d4507acaf872de71051dfd0e309860e88966e1051e462a077aac4f\"\n-\"checksum crossbeam-channel 0.2.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"a5716fadb87a5633db34c5e83ee6e036e6edc229f8a6bfb7c7c84ed340ba95df\"\n+\"checksum crossbeam-channel 0.2.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7b85741761b7f160bc5e7e0c14986ef685b7f8bf9b7ad081c60c604bb4649827\"\n \"checksum crossbeam-deque 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f739f8c5363aca78cfb059edf753d8f0d36908c348f3d8d1503f03d8b75d9cf3\"\n \"checksum crossbeam-epoch 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"927121f5407de9956180ff5e936fe3cf4324279280001cd56b669d28ee7e9150\"\n \"checksum crossbeam-epoch 0.6.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9c90f1474584f38e270b5b613e898c8c328aa4f3dea85e0a27ac2e642f009416\"\n@@ -1192,21 +1194,21 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum itertools 0.7.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f58856976b776fedd95533137617a02fb25719f40e7d9b01c7043cd65474f450\"\n \"checksum itoa 0.4.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"1306f3464951f30e30d12373d31c79fbd52d236e5e896fd92f96ec7babbbe60b\"\n \"checksum join_to_string 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7bddc885f3fd69dd4b5d747c2efe6dd2c36d795ea9938281ed50910e32c95e31\"\n-\"checksum languageserver-types 0.50.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"6866bed90d044147c6d71d3e4d31339e356164ab7b76b9fd13ccb1211528e166\"\n+\"checksum languageserver-types 0.51.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"caecadd973c43c93f5ce96fa457da310113d867af28808a8ed74023e9887a39e\"\n \"checksum lazy_static 1.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ca488b89a5657b0a2ecd45b95609b3e848cf1755da332a0da46e2b2b1cb371a7\"\n \"checksum libc 0.2.43 (registry+https://github.com/rust-lang/crates.io-index)\" = \"76e3a3ef172f1a0b9a9ff0dd1491ae5e6c948b94479a3021819ba7d860c8645d\"\n \"checksum lock_api 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"949826a5ccf18c1b3a7c3d57692778d21768b79e46eb9dd07bfc4c2160036c54\"\n \"checksum log 0.4.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"d4fcce5fa49cc693c312001daf1d13411c4a5283796bac1084299ea3e567113f\"\n \"checksum matches 0.1.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7ffc5c5338469d4d3ea17d269fa8ea3512ad247247c30bd2df69e68309ed0a08\"\n-\"checksum memchr 2.0.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"a3b4142ab8738a78c51896f704f83c11df047ff1bda9a92a661aa6361552d93d\"\n+\"checksum memchr 2.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"4b3629fe9fdbff6daa6c33b90f7c08355c1aca05a3d01fa8063b822fcf185f3b\"\n \"checksum memmap 0.6.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"e2ffa2c986de11a9df78620c01eeaaf27d94d3ff02bf81bfcca953102dd0c6ff\"\n \"checksum memoffset 0.2.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"0f9dc261e2b62d7a622bf416ea3c5245cdd5d9a7fcc428c0d06804dfce1775b3\"\n \"checksum nodrop 0.1.12 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9a2228dca57108069a5262f2ed8bd2e82496d2e074a06d1ccc7ce1687b6ae0a2\"\n \"checksum num-derive 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"0d2c31b75c36a993d30c7a13d70513cb93f02acafdd5b7ba250f9b0e18615de7\"\n \"checksum num-integer 0.1.39 (registry+https://github.com/rust-lang/crates.io-index)\" = \"e83d528d2677f0518c570baf2b7abdcf0cd2d248860b68507bdcb3e91d4c0cea\"\n \"checksum num-traits 0.2.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"0b3a5d7cc97d6d30d8b9bc8fa19bf45349ffe46241e8816f50f62f6d6aaabee1\"\n \"checksum num_cpus 1.8.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"c51a3322e4bca9d212ad9a158a02abc6934d005490c054a2778df73a70aa0a30\"\n-\"checksum once_cell 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"cecf059b719a56d137b66fadaee0781c08b1f61c040c36f5c6851d6769bab0af\"\n+\"checksum once_cell 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"d7ce3535d54560c937c1652ba4a0da66bfc63e0f8e07bed127483afb6e5ee925\"\n \"checksum owning_ref 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"cdf84f41639e037b484f93433aa3897863b561ed65c6e59c7073d7c561710f37\"\n \"checksum parking_lot 0.6.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f0802bff09003b291ba756dc7e79313e51cc31667e94afbe847def490424cde5\"\n \"checksum parking_lot_core 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ad7f7e6ebdc79edff6fdcb87a55b620174f7a989e3eb31b65231f4af57f00b8c\"\n@@ -1238,7 +1240,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum semver-parser 0.7.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"388a1df253eca08550bef6c72392cfe7c30914bf41df5269b68cbd6ff8f570a3\"\n \"checksum serde 1.0.79 (registry+https://github.com/rust-lang/crates.io-index)\" = \"84257ccd054dc351472528c8587b4de2dbf0dc0fe2e634030c1a90bfdacebaa9\"\n \"checksum serde_derive 1.0.79 (registry+https://github.com/rust-lang/crates.io-index)\" = \"31569d901045afbff7a9479f793177fe9259819aff10ab4f89ef69bbc5f567fe\"\n-\"checksum serde_json 1.0.27 (registry+https://github.com/rust-lang/crates.io-index)\" = \"59790990c5115d16027f00913e2e66de23a51f70422e549d2ad68c8c5f268f1c\"\n+\"checksum serde_json 1.0.28 (registry+https://github.com/rust-lang/crates.io-index)\" = \"d30ec34ac923489285d24688c7a9c0898d16edff27fc1f1bd854edeff6ca3b7f\"\n \"checksum slug 0.1.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b3bc762e6a4b6c6fcaade73e77f9ebc6991b676f88bb2358bddb56560f073373\"\n \"checksum smallvec 0.6.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"153ffa32fd170e9944f7e0838edf824a754ec4c1fc64746fcc9fe1f8fa602e5d\"\n \"checksum smol_str 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"248055d41f4c53f8ee7048e8a578a5190d0cca306630718091e4d481735e44b9\"\n@@ -1247,7 +1249,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum superslice 0.1.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"b50b13d42370e0f5fc62eafdd5c2d20065eaf5458dab215ff3e20e63eea96b30\"\n \"checksum syn 0.11.11 (registry+https://github.com/rust-lang/crates.io-index)\" = \"d3b891b9015c88c576343b9b3e41c2c11a51c219ef067b264bd9c8aa9b441dad\"\n \"checksum syn 0.14.9 (registry+https://github.com/rust-lang/crates.io-index)\" = \"261ae9ecaa397c42b960649561949d69311f08eeaea86a65696e6e46517cf741\"\n-\"checksum syn 0.15.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9056ebe7f2d6a38bc63171816fd1d3430da5a43896de21676dc5c0a4b8274a11\"\n+\"checksum syn 0.15.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"5522da8e493dbd7703e88ec5518546ed45c30efa2699f291a7bd0a08fb0a6ab6\"\n \"checksum synom 0.11.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"a393066ed9010ebaed60b9eafa373d4b1baac186dd7e008555b0f702b51945b6\"\n \"checksum synstructure 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"85bb9b7550d063ea184027c9b8c20ac167cd36d3e06b3a40bceb9d746dc1a7b7\"\n \"checksum tempdir 0.3.7 (registry+https://github.com/rust-lang/crates.io-index)\" = \"15f2b5fb00ccdf689e0149d1b1b3c03fead81c2b37735d812fa8bddbbf41b6d8\"\n@@ -1279,7 +1281,7 @@ source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \"checksum version_check 0.1.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7716c242968ee87e5542f8021178248f267f295a5c4803beae8b8b7fd9bc6051\"\n \"checksum void 1.0.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"6a02e4885ed3bc0f2de90ea6dd45ebcbb66dacffe03547fadbb0eeae2770887d\"\n \"checksum walkdir 2.2.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"af464bc7be7b785c7ac72e266a6b67c4c9070155606f51655a650a6686204e35\"\n-\"checksum winapi 0.3.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"773ef9dcc5f24b7d850d0ff101e542ff24c3b090a9768e03ff889fdef41f00fd\"\n+\"checksum winapi 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"92c1eb33641e276cfa214a0522acad57be5c56b10cb348b3c5117db75f3ac4b0\"\n \"checksum winapi-i686-pc-windows-gnu 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ac3b87c63620426dd9b991e5ce0329eff545bccbbb34f3be09ff6fb6ab51b7b6\"\n \"checksum winapi-util 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"afc5508759c5bf4285e61feb862b6083c8480aec864fa17a81fdec6f69b461ab\"\n \"checksum winapi-x86_64-pc-windows-gnu 0.4.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"712e227841d057c1ee1cd2fb22fa7e5a5461ae8e48fa2ca79ec42cfc1931183f\""}, {"sha": "6580ba6e43d2f75bbf77c664e26b9ac8dbb74250", "filename": "crates/gen_lsp_server/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/crates%2Fgen_lsp_server%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/crates%2Fgen_lsp_server%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fgen_lsp_server%2FCargo.toml?ref=7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a", "patch": "@@ -4,7 +4,7 @@ version = \"0.1.0\"\n authors = [\"Aleksey Kladov <aleksey.kladov@gmail.com>\"]\n \n [dependencies]\n-languageserver-types = \"0.50.0\"\n+languageserver-types = \"0.51.0\"\n log = \"0.4.3\"\n \n failure = \"0.1.2\""}, {"sha": "b4c7db476bccecde681ff8657543ec7a9ee57084", "filename": "crates/ra_analysis/src/lib.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/crates%2Fra_analysis%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/crates%2Fra_analysis%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_analysis%2Fsrc%2Flib.rs?ref=7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a", "patch": "@@ -34,6 +34,7 @@ use imp::{AnalysisImpl, AnalysisHostImpl, FileResolverImp};\n pub use ra_editor::{\n     StructureNode, LineIndex, FileSymbol,\n     Runnable, RunnableKind, HighlightedRange, CompletionItem,\n+    Fold, FoldKind\n };\n pub use job::{JobToken, JobHandle};\n \n@@ -224,6 +225,10 @@ impl Analysis {\n     pub fn diagnostics(&self, file_id: FileId) -> Vec<Diagnostic> {\n         self.imp.diagnostics(file_id)\n     }\n+    pub fn folding_ranges(&self, file_id: FileId) -> Vec<Fold> {\n+        let file = self.imp.file_syntax(file_id);\n+        ra_editor::folding_ranges(&file)\n+    }\n }\n \n #[derive(Debug)]"}, {"sha": "817da28d1a5a49329f80378f475489a42bbf079b", "filename": "crates/ra_editor/src/folding_ranges.rs", "status": "added", "additions": 142, "deletions": 0, "changes": 142, "blob_url": "https://github.com/rust-lang/rust/blob/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/crates%2Fra_editor%2Fsrc%2Ffolding_ranges.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/crates%2Fra_editor%2Fsrc%2Ffolding_ranges.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_editor%2Fsrc%2Ffolding_ranges.rs?ref=7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a", "patch": "@@ -0,0 +1,142 @@\n+use std::collections::HashSet;\n+\n+use ra_syntax::{\n+    File, TextRange, SyntaxNodeRef,\n+    SyntaxKind,\n+    algo::{walk, Direction, siblings},\n+};\n+\n+#[derive(Debug, PartialEq, Eq)]\n+pub enum FoldKind {\n+    Comment,\n+    Imports,\n+}\n+\n+#[derive(Debug)]\n+pub struct Fold {\n+    pub range: TextRange,\n+    pub kind: FoldKind,\n+}\n+\n+pub fn folding_ranges(file: &File) -> Vec<Fold> {\n+    let syntax = file.syntax();\n+\n+    let mut res = vec![];\n+    let mut visited = HashSet::new();\n+\n+    for node in walk::preorder(syntax) {\n+        if visited.contains(&node) {\n+            continue;\n+        }\n+\n+        let range_and_kind = match node.kind() {\n+            SyntaxKind::COMMENT => (\n+                contiguous_range_for(SyntaxKind::COMMENT, node, &mut visited),\n+                Some(FoldKind::Comment),\n+            ),\n+            SyntaxKind::USE_ITEM => (\n+                contiguous_range_for(SyntaxKind::USE_ITEM, node, &mut visited),\n+                Some(FoldKind::Imports),\n+            ),\n+            _ => (None, None),\n+        };\n+\n+        match range_and_kind {\n+            (Some(range), Some(kind)) => {\n+                res.push(Fold {\n+                    range: range,\n+                    kind: kind\n+                });\n+            }\n+            _ => {}\n+        }\n+    }\n+\n+    res\n+}\n+\n+fn contiguous_range_for<'a>(\n+    kind: SyntaxKind,\n+    node: SyntaxNodeRef<'a>,\n+    visited: &mut HashSet<SyntaxNodeRef<'a>>,\n+) -> Option<TextRange> {\n+    visited.insert(node);\n+\n+    let left = node;\n+    let mut right = node;\n+    for node in siblings(node, Direction::Forward) {\n+        visited.insert(node);\n+        match node.kind() {\n+            SyntaxKind::WHITESPACE if !node.leaf_text().unwrap().as_str().contains(\"\\n\\n\") => (),\n+            k => {\n+                if k == kind {\n+                    right = node\n+                } else {\n+                    break;\n+                }\n+            }\n+        }\n+    }\n+    if left != right {\n+        Some(TextRange::from_to(\n+            left.range().start(),\n+            right.range().end(),\n+        ))\n+    } else {\n+        None\n+    }\n+}\n+\n+#[cfg(test)]\n+mod tests {\n+    use super::*;\n+\n+    #[test]\n+    fn test_fold_comments() {\n+        let text = r#\"\n+// Hello\n+// this is a multiline\n+// comment\n+//\n+\n+// But this is not\n+\n+fn main() {\n+    // We should\n+    // also\n+    // fold\n+    // this one.\n+}\"#;\n+\n+        let file = File::parse(&text);\n+        let folds = folding_ranges(&file);\n+        assert_eq!(folds.len(), 2);\n+        assert_eq!(folds[0].range.start(), 1.into());\n+        assert_eq!(folds[0].range.end(), 46.into());\n+        assert_eq!(folds[0].kind, FoldKind::Comment);\n+\n+        assert_eq!(folds[1].range.start(), 84.into());\n+        assert_eq!(folds[1].range.end(), 137.into());\n+        assert_eq!(folds[1].kind, FoldKind::Comment);\n+    }\n+\n+    #[test]\n+    fn test_fold_imports() {\n+        let text = r#\"\n+use std::str;\n+use std::vec;\n+use std::io as iop;\n+\n+fn main() {\n+}\"#;\n+\n+        let file = File::parse(&text);\n+        let folds = folding_ranges(&file);\n+        assert_eq!(folds.len(), 1);\n+        assert_eq!(folds[0].range.start(), 1.into());\n+        assert_eq!(folds[0].range.end(), 48.into());\n+        assert_eq!(folds[0].kind, FoldKind::Imports);\n+    }\n+\n+\n+}\n\\ No newline at end of file"}, {"sha": "de929d73a6f90cf7e5060dee2b790cb66add54b8", "filename": "crates/ra_editor/src/lib.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/crates%2Fra_editor%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/crates%2Fra_editor%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_editor%2Fsrc%2Flib.rs?ref=7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a", "patch": "@@ -10,6 +10,7 @@ mod extend_selection;\n mod symbols;\n mod line_index;\n mod edit;\n+mod folding_ranges;\n mod code_actions;\n mod typing;\n mod completion;\n@@ -36,6 +37,7 @@ pub use self::{\n     },\n     typing::{join_lines, on_eq_typed},\n     completion::{scope_completion, CompletionItem},\n+    folding_ranges::{Fold, FoldKind, folding_ranges}\n };\n \n #[derive(Debug)]"}, {"sha": "32463e499f32f4c864a6f98db131687f5adb5881", "filename": "crates/ra_lsp_server/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/crates%2Fra_lsp_server%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/crates%2Fra_lsp_server%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2FCargo.toml?ref=7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a", "patch": "@@ -15,7 +15,7 @@ crossbeam-channel = \"0.2.4\"\n flexi_logger = \"0.9.1\"\n log = \"0.4.3\"\n url_serde = \"0.2.0\"\n-languageserver-types = \"0.50.0\"\n+languageserver-types = \"0.51.0\"\n walkdir = \"2.2.0\"\n im = \"12.0.0\"\n cargo_metadata = \"0.6.0\""}, {"sha": "3c628f29c58c2ad500b8fbd5b96cbb550e19bb7a", "filename": "crates/ra_lsp_server/src/caps.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/crates%2Fra_lsp_server%2Fsrc%2Fcaps.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/crates%2Fra_lsp_server%2Fsrc%2Fcaps.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fcaps.rs?ref=7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a", "patch": "@@ -1,5 +1,7 @@\n use languageserver_types::{\n     ServerCapabilities,\n+    CodeActionProviderCapability,\n+    FoldingRangeProviderCapability,\n     TextDocumentSyncCapability,\n     TextDocumentSyncOptions,\n     TextDocumentSyncKind,\n@@ -32,18 +34,20 @@ pub fn server_capabilities() -> ServerCapabilities {\n         document_highlight_provider: None,\n         document_symbol_provider: Some(true),\n         workspace_symbol_provider: Some(true),\n-        code_action_provider: Some(true),\n+        code_action_provider: Some(CodeActionProviderCapability::Simple(true)),\n         code_lens_provider: None,\n         document_formatting_provider: None,\n         document_range_formatting_provider: None,\n         document_on_type_formatting_provider: Some(DocumentOnTypeFormattingOptions {\n             first_trigger_character: \"=\".to_string(),\n             more_trigger_character: None,\n         }),\n+        folding_range_provider: Some(FoldingRangeProviderCapability::Simple(true)),\n         rename_provider: None,\n         color_provider: None,\n         execute_command_provider: Some(ExecuteCommandOptions {\n             commands: vec![\"apply_code_action\".to_string()],\n         }),\n+        workspace: None,\n     }\n }"}, {"sha": "51061543c29b4fb0a50670561bb447c7f630c907", "filename": "crates/ra_lsp_server/src/main_loop/handlers.rs", "status": "modified", "additions": 38, "deletions": 6, "changes": 44, "blob_url": "https://github.com/rust-lang/rust/blob/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop%2Fhandlers.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop%2Fhandlers.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop%2Fhandlers.rs?ref=7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a", "patch": "@@ -1,15 +1,16 @@\n-use std::collections::HashMap;\n+use std::collections::{HashMap};\n \n use languageserver_types::{\n     Diagnostic, DiagnosticSeverity, DocumentSymbol,\n-    Command, TextDocumentIdentifier,\n+    CodeActionResponse, Command, TextDocumentIdentifier,\n     SymbolInformation, Position, Location, TextEdit,\n     CompletionItem, InsertTextFormat, CompletionItemKind,\n+    FoldingRange, FoldingRangeParams, FoldingRangeKind\n };\n use serde_json::to_value;\n-use ra_analysis::{Query, FileId, RunnableKind, JobToken};\n+use ra_analysis::{Query, FileId, RunnableKind, JobToken, FoldKind};\n use ra_syntax::{\n-    text_utils::contains_offset_nonstrict,\n+    text_utils::contains_offset_nonstrict\n };\n \n use ::{\n@@ -177,6 +178,7 @@ pub fn handle_workspace_symbol(\n                     world, &line_index\n                 )?,\n                 container_name: None,\n+                deprecated: None,\n             };\n             res.push(info);\n         };\n@@ -365,11 +367,41 @@ pub fn handle_completion(\n     Ok(Some(req::CompletionResponse::Array(items)))\n }\n \n+pub fn handle_folding_range(\n+    world: ServerWorld,\n+    params: FoldingRangeParams,\n+    _token: JobToken,\n+) -> Result<Option<Vec<FoldingRange>>> {\n+    let file_id = params.text_document.try_conv_with(&world)?;\n+    let line_index = world.analysis().file_line_index(file_id);\n+\n+    let res = Some(world.analysis()\n+        .folding_ranges(file_id)\n+        .into_iter()\n+        .map(|fold| {\n+            let kind = match fold.kind {\n+                FoldKind::Comment => FoldingRangeKind::Comment,\n+                FoldKind::Imports => FoldingRangeKind::Imports\n+            };\n+            let range = fold.range.conv_with(&line_index);\n+            FoldingRange {\n+                start_line: range.start.line,\n+                start_character: Some(range.start.character),\n+                end_line: range.end.line,\n+                end_character: Some(range.start.character),\n+                kind: Some(kind)\n+            }\n+        })\n+        .collect());\n+\n+    Ok(res)\n+}\n+\n pub fn handle_code_action(\n     world: ServerWorld,\n     params: req::CodeActionParams,\n     _token: JobToken,\n-) -> Result<Option<Vec<Command>>> {\n+) -> Result<Option<CodeActionResponse>> {\n     let file_id = params.text_document.try_conv_with(&world)?;\n     let line_index = world.analysis().file_line_index(file_id);\n     let range = params.range.conv_with(&line_index);\n@@ -392,7 +424,7 @@ pub fn handle_code_action(\n         res.push(cmd);\n     }\n \n-    Ok(Some(res))\n+    Ok(Some(CodeActionResponse::Commands(res)))\n }\n \n pub fn publish_diagnostics("}, {"sha": "abc58b70ec807bffe0185c670337fbcaca2a6005", "filename": "crates/ra_lsp_server/src/main_loop/mod.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fmain_loop%2Fmod.rs?ref=7eb047a105ee42b5dbd8f5cf7d956ca7bdfd551a", "patch": "@@ -253,6 +253,7 @@ fn on_request(\n         .on::<req::DecorationsRequest>(handlers::handle_decorations)?\n         .on::<req::Completion>(handlers::handle_completion)?\n         .on::<req::CodeActionRequest>(handlers::handle_code_action)?\n+        .on::<req::FoldingRangeRequest>(handlers::handle_folding_range)?\n         .finish();\n     match req {\n         Ok((id, handle)) => {"}]}