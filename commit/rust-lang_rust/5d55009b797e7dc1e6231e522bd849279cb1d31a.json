{"sha": "5d55009b797e7dc1e6231e522bd849279cb1d31a", "node_id": "C_kwDOAAsO6NoAKDVkNTUwMDliNzk3ZTdkYzFlNjIzMWU1MjJiZDg0OTI3OWNiMWQzMWE", "commit": {"author": {"name": "Dylan DPC", "email": "99973273+Dylan-DPC@users.noreply.github.com", "date": "2022-09-05T08:45:51Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-09-05T08:45:51Z"}, "message": "Rollup merge of #101142 - nnethercote:improve-hir-stats, r=davidtwco\n\nImprove HIR stats\n\n#100398 improve the AST stats collection done by `-Zhir-stats`. This PR does the same for HIR stats collection.\n\nr? `@davidtwco`", "tree": {"sha": "e379c0e7e5fcda3c8d817925231d8e0e12a359ef", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e379c0e7e5fcda3c8d817925231d8e0e12a359ef"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5d55009b797e7dc1e6231e522bd849279cb1d31a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjFbc/CRBK7hj4Ov3rIwAANoMIAIJWuU6m9OR6gmwoaOsfNdBj\nzW3Q28DVFije+kv9vFmgBmlcCtK11MHEXk8Ed9VbIAtwGu6WmElRiDWQEsEWeANW\nJoTdnlWHdUobssD9LBCMne/EGYjgWuKk8Uv2STZCZtMTsc2u2JgAprMJICrB0GdJ\nNcddCX4ZlylnY5qI0yDbLohK7gvFWCUq10uje2/iXCHj0LlW8Qhcgc73agISqtIj\nBfcG8Nt8VVckB7ved7FxoT1eTFQDpcHS0rRgGjxJSUTYZVMI6sfKuDtIIIKYGPia\nXhUAApaL22EHXsIc/QNf1RgAS244+w3fIYwkdCSiTmTFxzBH4ryWvwjEqSItXKM=\n=ZnP5\n-----END PGP SIGNATURE-----\n", "payload": "tree e379c0e7e5fcda3c8d817925231d8e0e12a359ef\nparent 406e03fd02faf5cc8409a8b6b04c26990d6227e6\nparent f26fdce9917992f71e561cef44a52fb5bd2e6de9\nauthor Dylan DPC <99973273+Dylan-DPC@users.noreply.github.com> 1662367551 +0530\ncommitter GitHub <noreply@github.com> 1662367551 +0530\n\nRollup merge of #101142 - nnethercote:improve-hir-stats, r=davidtwco\n\nImprove HIR stats\n\n#100398 improve the AST stats collection done by `-Zhir-stats`. This PR does the same for HIR stats collection.\n\nr? `@davidtwco`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5d55009b797e7dc1e6231e522bd849279cb1d31a", "html_url": "https://github.com/rust-lang/rust/commit/5d55009b797e7dc1e6231e522bd849279cb1d31a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5d55009b797e7dc1e6231e522bd849279cb1d31a/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "406e03fd02faf5cc8409a8b6b04c26990d6227e6", "url": "https://api.github.com/repos/rust-lang/rust/commits/406e03fd02faf5cc8409a8b6b04c26990d6227e6", "html_url": "https://github.com/rust-lang/rust/commit/406e03fd02faf5cc8409a8b6b04c26990d6227e6"}, {"sha": "f26fdce9917992f71e561cef44a52fb5bd2e6de9", "url": "https://api.github.com/repos/rust-lang/rust/commits/f26fdce9917992f71e561cef44a52fb5bd2e6de9", "html_url": "https://github.com/rust-lang/rust/commit/f26fdce9917992f71e561cef44a52fb5bd2e6de9"}], "stats": {"total": 730, "additions": 466, "deletions": 264}, "files": [{"sha": "097a59d027bb2906c139cd7a82f2c402a518a551", "filename": "compiler/rustc_ast/src/ast.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_ast%2Fsrc%2Fast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_ast%2Fsrc%2Fast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast%2Fsrc%2Fast.rs?ref=5d55009b797e7dc1e6231e522bd849279cb1d31a", "patch": "@@ -3045,13 +3045,16 @@ mod size_asserts {\n     static_assert_size!(Fn, 192);\n     static_assert_size!(ForeignItem, 96);\n     static_assert_size!(ForeignItemKind, 24);\n+    static_assert_size!(GenericArg, 24);\n     static_assert_size!(GenericBound, 88);\n     static_assert_size!(Generics, 72);\n     static_assert_size!(Impl, 200);\n     static_assert_size!(Item, 184);\n     static_assert_size!(ItemKind, 112);\n     static_assert_size!(Lit, 48);\n     static_assert_size!(LitKind, 24);\n+    static_assert_size!(Local, 72);\n+    static_assert_size!(Param, 40);\n     static_assert_size!(Pat, 120);\n     static_assert_size!(PatKind, 96);\n     static_assert_size!(Path, 40);"}, {"sha": "b0e9fe0469c41baab379f1b599301efda043f76f", "filename": "compiler/rustc_ast_lowering/src/asm.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_ast_lowering%2Fsrc%2Fasm.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_ast_lowering%2Fsrc%2Fasm.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Fasm.rs?ref=5d55009b797e7dc1e6231e522bd849279cb1d31a", "patch": "@@ -155,26 +155,26 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                 let op = match *op {\n                     InlineAsmOperand::In { reg, ref expr } => hir::InlineAsmOperand::In {\n                         reg: lower_reg(reg),\n-                        expr: self.lower_expr_mut(expr),\n+                        expr: self.lower_expr(expr),\n                     },\n                     InlineAsmOperand::Out { reg, late, ref expr } => hir::InlineAsmOperand::Out {\n                         reg: lower_reg(reg),\n                         late,\n-                        expr: expr.as_ref().map(|expr| self.lower_expr_mut(expr)),\n+                        expr: expr.as_ref().map(|expr| self.lower_expr(expr)),\n                     },\n                     InlineAsmOperand::InOut { reg, late, ref expr } => {\n                         hir::InlineAsmOperand::InOut {\n                             reg: lower_reg(reg),\n                             late,\n-                            expr: self.lower_expr_mut(expr),\n+                            expr: self.lower_expr(expr),\n                         }\n                     }\n                     InlineAsmOperand::SplitInOut { reg, late, ref in_expr, ref out_expr } => {\n                         hir::InlineAsmOperand::SplitInOut {\n                             reg: lower_reg(reg),\n                             late,\n-                            in_expr: self.lower_expr_mut(in_expr),\n-                            out_expr: out_expr.as_ref().map(|expr| self.lower_expr_mut(expr)),\n+                            in_expr: self.lower_expr(in_expr),\n+                            out_expr: out_expr.as_ref().map(|expr| self.lower_expr(expr)),\n                         }\n                     }\n                     InlineAsmOperand::Const { ref anon_const } => {"}, {"sha": "269091c89e9fb4ff141c388af0421b49b3da326d", "filename": "compiler/rustc_ast_lowering/src/item.rs", "status": "modified", "additions": 13, "deletions": 5, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_ast_lowering%2Fsrc%2Fitem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_ast_lowering%2Fsrc%2Fitem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Fitem.rs?ref=5d55009b797e7dc1e6231e522bd849279cb1d31a", "patch": "@@ -120,7 +120,7 @@ impl<'a, 'hir> ItemLowerer<'a, 'hir> {\n         self.with_lctx(CRATE_NODE_ID, |lctx| {\n             let module = lctx.lower_mod(&c.items, &c.spans);\n             lctx.lower_attrs(hir::CRATE_HIR_ID, &c.attrs);\n-            hir::OwnerNode::Crate(lctx.arena.alloc(module))\n+            hir::OwnerNode::Crate(module)\n         })\n     }\n \n@@ -158,14 +158,18 @@ impl<'a, 'hir> ItemLowerer<'a, 'hir> {\n }\n \n impl<'hir> LoweringContext<'_, 'hir> {\n-    pub(super) fn lower_mod(&mut self, items: &[P<Item>], spans: &ModSpans) -> hir::Mod<'hir> {\n-        hir::Mod {\n+    pub(super) fn lower_mod(\n+        &mut self,\n+        items: &[P<Item>],\n+        spans: &ModSpans,\n+    ) -> &'hir hir::Mod<'hir> {\n+        self.arena.alloc(hir::Mod {\n             spans: hir::ModSpans {\n                 inner_span: self.lower_span(spans.inner_span),\n                 inject_use_span: self.lower_span(spans.inject_use_span),\n             },\n             item_ids: self.arena.alloc_from_iter(items.iter().flat_map(|x| self.lower_item_ref(x))),\n-        }\n+        })\n     }\n \n     pub(super) fn lower_item_ref(&mut self, i: &Item) -> SmallVec<[hir::ItemId; 1]> {\n@@ -947,7 +951,11 @@ impl<'hir> LoweringContext<'_, 'hir> {\n         params: &'hir [hir::Param<'hir>],\n         value: hir::Expr<'hir>,\n     ) -> hir::BodyId {\n-        let body = hir::Body { generator_kind: self.generator_kind, params, value };\n+        let body = hir::Body {\n+            generator_kind: self.generator_kind,\n+            params,\n+            value: self.arena.alloc(value),\n+        };\n         let id = body.id();\n         debug_assert_eq!(id.hir_id.owner, self.current_hir_id_owner);\n         self.bodies.push((id.hir_id.local_id, self.arena.alloc(body)));"}, {"sha": "55f117ef01b658844c1ffc4f5442ffe5b3390e44", "filename": "compiler/rustc_ast_lowering/src/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs?ref=5d55009b797e7dc1e6231e522bd849279cb1d31a", "patch": "@@ -1155,7 +1155,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                     }\n                     _ => {}\n                 }\n-                GenericArg::Type(self.lower_ty_direct(&ty, itctx))\n+                GenericArg::Type(self.lower_ty(&ty, itctx))\n             }\n             ast::GenericArg::Const(ct) => GenericArg::Const(ConstArg {\n                 value: self.lower_anon_const(&ct),"}, {"sha": "f071012d01ed5079cefe1b91cb0b5a4838cc796c", "filename": "compiler/rustc_ast_lowering/src/path.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_ast_lowering%2Fsrc%2Fpath.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_ast_lowering%2Fsrc%2Fpath.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Fpath.rs?ref=5d55009b797e7dc1e6231e522bd849279cb1d31a", "patch": "@@ -358,7 +358,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n             }\n             FnRetTy::Default(_) => self.arena.alloc(self.ty_tup(*span, &[])),\n         };\n-        let args = smallvec![GenericArg::Type(self.ty_tup(*inputs_span, inputs))];\n+        let args = smallvec![GenericArg::Type(self.arena.alloc(self.ty_tup(*inputs_span, inputs)))];\n         let binding = self.output_ty_binding(output_ty.span, output_ty);\n         (\n             GenericArgsCtor {"}, {"sha": "637709c764ccb6d534ac4958d5e022bbd2676ad0", "filename": "compiler/rustc_hir/src/hir.rs", "status": "modified", "additions": 36, "deletions": 20, "changes": 56, "blob_url": "https://github.com/rust-lang/rust/blob/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_hir%2Fsrc%2Fhir.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_hir%2Fsrc%2Fhir.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir%2Fsrc%2Fhir.rs?ref=5d55009b797e7dc1e6231e522bd849279cb1d31a", "patch": "@@ -265,7 +265,7 @@ impl InferArg {\n #[derive(Debug, HashStable_Generic)]\n pub enum GenericArg<'hir> {\n     Lifetime(Lifetime),\n-    Type(Ty<'hir>),\n+    Type(&'hir Ty<'hir>),\n     Const(ConstArg),\n     Infer(InferArg),\n }\n@@ -280,7 +280,7 @@ impl GenericArg<'_> {\n         }\n     }\n \n-    pub fn id(&self) -> HirId {\n+    pub fn hir_id(&self) -> HirId {\n         match self {\n             GenericArg::Lifetime(l) => l.hir_id,\n             GenericArg::Type(t) => t.hir_id,\n@@ -1438,7 +1438,7 @@ pub struct BodyId {\n #[derive(Debug, HashStable_Generic)]\n pub struct Body<'hir> {\n     pub params: &'hir [Param<'hir>],\n-    pub value: Expr<'hir>,\n+    pub value: &'hir Expr<'hir>,\n     pub generator_kind: Option<GeneratorKind>,\n }\n \n@@ -2561,23 +2561,23 @@ pub enum TyKind<'hir> {\n pub enum InlineAsmOperand<'hir> {\n     In {\n         reg: InlineAsmRegOrRegClass,\n-        expr: Expr<'hir>,\n+        expr: &'hir Expr<'hir>,\n     },\n     Out {\n         reg: InlineAsmRegOrRegClass,\n         late: bool,\n-        expr: Option<Expr<'hir>>,\n+        expr: Option<&'hir Expr<'hir>>,\n     },\n     InOut {\n         reg: InlineAsmRegOrRegClass,\n         late: bool,\n-        expr: Expr<'hir>,\n+        expr: &'hir Expr<'hir>,\n     },\n     SplitInOut {\n         reg: InlineAsmRegOrRegClass,\n         late: bool,\n-        in_expr: Expr<'hir>,\n-        out_expr: Option<Expr<'hir>>,\n+        in_expr: &'hir Expr<'hir>,\n+        out_expr: Option<&'hir Expr<'hir>>,\n     },\n     Const {\n         anon_const: AnonConst,\n@@ -2991,7 +2991,7 @@ pub enum ItemKind<'hir> {\n     /// A MBE macro definition (`macro_rules!` or `macro`).\n     Macro(ast::MacroDef, MacroKind),\n     /// A module.\n-    Mod(Mod<'hir>),\n+    Mod(&'hir Mod<'hir>),\n     /// An external module, e.g. `extern { .. }`.\n     ForeignMod { abi: Abi, items: &'hir [ForeignItemRef] },\n     /// Module-level inline assembly (from `global_asm!`).\n@@ -3495,16 +3495,32 @@ impl<'hir> Node<'hir> {\n mod size_asserts {\n     use super::*;\n     // These are in alphabetical order, which is easy to maintain.\n-    static_assert_size!(Block<'static>, 48);\n-    static_assert_size!(Expr<'static>, 56);\n-    static_assert_size!(ForeignItem<'static>, 72);\n+    static_assert_size!(Block<'_>, 48);\n+    static_assert_size!(Body<'_>, 32);\n+    static_assert_size!(Expr<'_>, 56);\n+    static_assert_size!(ExprKind<'_>, 40);\n+    static_assert_size!(FnDecl<'_>, 40);\n+    static_assert_size!(ForeignItem<'_>, 72);\n+    static_assert_size!(ForeignItemKind<'_>, 40);\n+    static_assert_size!(GenericArg<'_>, 40);\n     static_assert_size!(GenericBound<'_>, 48);\n-    static_assert_size!(Generics<'static>, 56);\n-    static_assert_size!(ImplItem<'static>, 88);\n-    static_assert_size!(Impl<'static>, 80);\n-    static_assert_size!(Item<'static>, 80);\n-    static_assert_size!(Pat<'static>, 88);\n-    static_assert_size!(QPath<'static>, 24);\n-    static_assert_size!(TraitItem<'static>, 96);\n-    static_assert_size!(Ty<'static>, 72);\n+    static_assert_size!(Generics<'_>, 56);\n+    static_assert_size!(Impl<'_>, 80);\n+    static_assert_size!(ImplItem<'_>, 88);\n+    static_assert_size!(ImplItemKind<'_>, 40);\n+    static_assert_size!(Item<'_>, 80);\n+    static_assert_size!(ItemKind<'_>, 48);\n+    static_assert_size!(Local<'_>, 64);\n+    static_assert_size!(Param<'_>, 32);\n+    static_assert_size!(Pat<'_>, 88);\n+    static_assert_size!(PatKind<'_>, 64);\n+    static_assert_size!(Path<'_>, 48);\n+    static_assert_size!(PathSegment<'_>, 56);\n+    static_assert_size!(QPath<'_>, 24);\n+    static_assert_size!(Stmt<'_>, 32);\n+    static_assert_size!(StmtKind<'_>, 16);\n+    static_assert_size!(TraitItem<'_>, 96);\n+    static_assert_size!(TraitItemKind<'_>, 56);\n+    static_assert_size!(Ty<'_>, 72);\n+    static_assert_size!(TyKind<'_>, 56);\n }"}, {"sha": "bb534a3c7afce6399abb885ae5dfe2984e22aab9", "filename": "compiler/rustc_interface/src/passes.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_interface%2Fsrc%2Fpasses.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_interface%2Fsrc%2Fpasses.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_interface%2Fsrc%2Fpasses.rs?ref=5d55009b797e7dc1e6231e522bd849279cb1d31a", "patch": "@@ -68,7 +68,7 @@ pub fn parse<'a>(sess: &'a Session, input: &Input) -> PResult<'a, ast::Crate> {\n     }\n \n     if sess.opts.unstable_opts.hir_stats {\n-        hir_stats::print_ast_stats(&krate, \"PRE EXPANSION AST STATS\");\n+        hir_stats::print_ast_stats(&krate, \"PRE EXPANSION AST STATS\", \"ast-stats-1\");\n     }\n \n     Ok(krate)\n@@ -415,7 +415,7 @@ pub fn configure_and_expand(\n     }\n \n     if sess.opts.unstable_opts.hir_stats {\n-        hir_stats::print_ast_stats(&krate, \"POST EXPANSION AST STATS\");\n+        hir_stats::print_ast_stats(&krate, \"POST EXPANSION AST STATS\", \"ast-stats-2\");\n     }\n \n     resolver.resolve_crate(&krate);"}, {"sha": "81ac0e1b6d445a5455a69a9e9782ff788a62728b", "filename": "compiler/rustc_passes/src/hir_stats.rs", "status": "modified", "additions": 215, "deletions": 66, "changes": 281, "blob_url": "https://github.com/rust-lang/rust/blob/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_passes%2Fsrc%2Fhir_stats.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_passes%2Fsrc%2Fhir_stats.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_passes%2Fsrc%2Fhir_stats.rs?ref=5d55009b797e7dc1e6231e522bd849279cb1d31a", "patch": "@@ -74,16 +74,16 @@ pub fn print_hir_stats(tcx: TyCtxt<'_>) {\n     };\n     tcx.hir().walk_toplevel_module(&mut collector);\n     tcx.hir().walk_attributes(&mut collector);\n-    collector.print(\"HIR STATS\");\n+    collector.print(\"HIR STATS\", \"hir-stats\");\n }\n \n-pub fn print_ast_stats(krate: &ast::Crate, title: &str) {\n+pub fn print_ast_stats(krate: &ast::Crate, title: &str, prefix: &str) {\n     use rustc_ast::visit::Visitor;\n \n     let mut collector =\n         StatCollector { krate: None, nodes: FxHashMap::default(), seen: FxHashSet::default() };\n     collector.visit_crate(krate);\n-    collector.print(title);\n+    collector.print(title, prefix);\n }\n \n impl<'k> StatCollector<'k> {\n@@ -119,23 +119,26 @@ impl<'k> StatCollector<'k> {\n         }\n     }\n \n-    fn print(&self, title: &str) {\n+    fn print(&self, title: &str, prefix: &str) {\n         let mut nodes: Vec<_> = self.nodes.iter().collect();\n         nodes.sort_by_key(|&(_, ref node)| node.stats.count * node.stats.size);\n \n         let total_size = nodes.iter().map(|(_, node)| node.stats.count * node.stats.size).sum();\n \n-        eprintln!(\"\\n{}\\n\", title);\n-\n-        eprintln!(\"{:<18}{:>18}{:>14}{:>14}\", \"Name\", \"Accumulated Size\", \"Count\", \"Item Size\");\n-        eprintln!(\"----------------------------------------------------------------\");\n+        eprintln!(\"{} {}\", prefix, title);\n+        eprintln!(\n+            \"{} {:<18}{:>18}{:>14}{:>14}\",\n+            prefix, \"Name\", \"Accumulated Size\", \"Count\", \"Item Size\"\n+        );\n+        eprintln!(\"{} ----------------------------------------------------------------\", prefix);\n \n         let percent = |m, n| (m * 100) as f64 / n as f64;\n \n         for (label, node) in nodes {\n             let size = node.stats.count * node.stats.size;\n             eprintln!(\n-                \"{:<18}{:>10} ({:4.1}%){:>14}{:>14}\",\n+                \"{} {:<18}{:>10} ({:4.1}%){:>14}{:>14}\",\n+                prefix,\n                 label,\n                 to_readable_str(size),\n                 percent(size, total_size),\n@@ -149,7 +152,8 @@ impl<'k> StatCollector<'k> {\n                 for (label, subnode) in subnodes {\n                     let size = subnode.count * subnode.size;\n                     eprintln!(\n-                        \"- {:<18}{:>10} ({:4.1}%){:>14}\",\n+                        \"{} - {:<18}{:>10} ({:4.1}%){:>14}\",\n+                        prefix,\n                         label,\n                         to_readable_str(size),\n                         percent(size, total_size),\n@@ -158,11 +162,28 @@ impl<'k> StatCollector<'k> {\n                 }\n             }\n         }\n-        eprintln!(\"----------------------------------------------------------------\");\n-        eprintln!(\"{:<18}{:>10}\\n\", \"Total\", to_readable_str(total_size));\n+        eprintln!(\"{} ----------------------------------------------------------------\", prefix);\n+        eprintln!(\"{} {:<18}{:>10}\", prefix, \"Total\", to_readable_str(total_size));\n+        eprintln!(\"{}\", prefix);\n     }\n }\n \n+// Used to avoid boilerplate for types with many variants.\n+macro_rules! record_variants {\n+    (\n+        ($self:ident, $val:expr, $kind:expr, $id:expr, $mod:ident, $ty:ty, $tykind:ident),\n+        [$($variant:ident),*]\n+    ) => {\n+        match $kind {\n+            $(\n+                $mod::$tykind::$variant { .. } => {\n+                    $self.record_variant(stringify!($ty), stringify!($variant), $id, $val)\n+                }\n+            )*\n+        }\n+    };\n+}\n+\n impl<'v> hir_visit::Visitor<'v> for StatCollector<'v> {\n     fn visit_param(&mut self, param: &'v hir::Param<'v>) {\n         self.record(\"Param\", Id::Node(param.hir_id), param);\n@@ -195,12 +216,46 @@ impl<'v> hir_visit::Visitor<'v> for StatCollector<'v> {\n     }\n \n     fn visit_item(&mut self, i: &'v hir::Item<'v>) {\n-        self.record(\"Item\", Id::Node(i.hir_id()), i);\n+        record_variants!(\n+            (self, i, i.kind, Id::Node(i.hir_id()), hir, Item, ItemKind),\n+            [\n+                ExternCrate,\n+                Use,\n+                Static,\n+                Const,\n+                Fn,\n+                Macro,\n+                Mod,\n+                ForeignMod,\n+                GlobalAsm,\n+                TyAlias,\n+                OpaqueTy,\n+                Enum,\n+                Struct,\n+                Union,\n+                Trait,\n+                TraitAlias,\n+                Impl\n+            ]\n+        );\n         hir_visit::walk_item(self, i)\n     }\n \n+    fn visit_body(&mut self, b: &'v hir::Body<'v>) {\n+        self.record(\"Body\", Id::None, b);\n+        hir_visit::walk_body(self, b);\n+    }\n+\n+    fn visit_mod(&mut self, m: &'v hir::Mod<'v>, _s: Span, n: HirId) {\n+        self.record(\"Mod\", Id::None, m);\n+        hir_visit::walk_mod(self, m, n)\n+    }\n+\n     fn visit_foreign_item(&mut self, i: &'v hir::ForeignItem<'v>) {\n-        self.record(\"ForeignItem\", Id::Node(i.hir_id()), i);\n+        record_variants!(\n+            (self, i, i.kind, Id::Node(i.hir_id()), hir, ForeignItem, ForeignItemKind),\n+            [Fn, Static, Type]\n+        );\n         hir_visit::walk_foreign_item(self, i)\n     }\n \n@@ -215,7 +270,10 @@ impl<'v> hir_visit::Visitor<'v> for StatCollector<'v> {\n     }\n \n     fn visit_stmt(&mut self, s: &'v hir::Stmt<'v>) {\n-        self.record(\"Stmt\", Id::Node(s.hir_id), s);\n+        record_variants!(\n+            (self, s, s.kind, Id::Node(s.hir_id), hir, Stmt, StmtKind),\n+            [Local, Item, Expr, Semi]\n+        );\n         hir_visit::walk_stmt(self, s)\n     }\n \n@@ -225,20 +283,80 @@ impl<'v> hir_visit::Visitor<'v> for StatCollector<'v> {\n     }\n \n     fn visit_pat(&mut self, p: &'v hir::Pat<'v>) {\n-        self.record(\"Pat\", Id::Node(p.hir_id), p);\n+        record_variants!(\n+            (self, p, p.kind, Id::Node(p.hir_id), hir, Pat, PatKind),\n+            [Wild, Binding, Struct, TupleStruct, Or, Path, Tuple, Box, Ref, Lit, Range, Slice]\n+        );\n         hir_visit::walk_pat(self, p)\n     }\n \n-    fn visit_expr(&mut self, ex: &'v hir::Expr<'v>) {\n-        self.record(\"Expr\", Id::Node(ex.hir_id), ex);\n-        hir_visit::walk_expr(self, ex)\n+    fn visit_pat_field(&mut self, f: &'v hir::PatField<'v>) {\n+        self.record(\"PatField\", Id::Node(f.hir_id), f);\n+        hir_visit::walk_pat_field(self, f)\n+    }\n+\n+    fn visit_expr(&mut self, e: &'v hir::Expr<'v>) {\n+        record_variants!(\n+            (self, e, e.kind, Id::Node(e.hir_id), hir, Expr, ExprKind),\n+            [\n+                Box, ConstBlock, Array, Call, MethodCall, Tup, Binary, Unary, Lit, Cast, Type,\n+                DropTemps, Let, If, Loop, Match, Closure, Block, Assign, AssignOp, Field, Index,\n+                Path, AddrOf, Break, Continue, Ret, InlineAsm, Struct, Repeat, Yield, Err\n+            ]\n+        );\n+        hir_visit::walk_expr(self, e)\n+    }\n+\n+    fn visit_let_expr(&mut self, lex: &'v hir::Let<'v>) {\n+        self.record(\"Let\", Id::Node(lex.hir_id), lex);\n+        hir_visit::walk_let_expr(self, lex)\n+    }\n+\n+    fn visit_expr_field(&mut self, f: &'v hir::ExprField<'v>) {\n+        self.record(\"ExprField\", Id::Node(f.hir_id), f);\n+        hir_visit::walk_expr_field(self, f)\n     }\n \n     fn visit_ty(&mut self, t: &'v hir::Ty<'v>) {\n-        self.record(\"Ty\", Id::Node(t.hir_id), t);\n+        record_variants!(\n+            (self, t, t.kind, Id::Node(t.hir_id), hir, Ty, TyKind),\n+            [\n+                Slice,\n+                Array,\n+                Ptr,\n+                Rptr,\n+                BareFn,\n+                Never,\n+                Tup,\n+                Path,\n+                OpaqueDef,\n+                TraitObject,\n+                Typeof,\n+                Infer,\n+                Err\n+            ]\n+        );\n         hir_visit::walk_ty(self, t)\n     }\n \n+    fn visit_generic_param(&mut self, p: &'v hir::GenericParam<'v>) {\n+        self.record(\"GenericParam\", Id::Node(p.hir_id), p);\n+        hir_visit::walk_generic_param(self, p)\n+    }\n+\n+    fn visit_generics(&mut self, g: &'v hir::Generics<'v>) {\n+        self.record(\"Generics\", Id::None, g);\n+        hir_visit::walk_generics(self, g)\n+    }\n+\n+    fn visit_where_predicate(&mut self, p: &'v hir::WherePredicate<'v>) {\n+        record_variants!(\n+            (self, p, p, Id::None, hir, WherePredicate, WherePredicate),\n+            [BoundPredicate, RegionPredicate, EqPredicate]\n+        );\n+        hir_visit::walk_where_predicate(self, p)\n+    }\n+\n     fn visit_fn(\n         &mut self,\n         fk: hir_visit::FnKind<'v>,\n@@ -251,24 +369,49 @@ impl<'v> hir_visit::Visitor<'v> for StatCollector<'v> {\n         hir_visit::walk_fn(self, fk, fd, b, s, id)\n     }\n \n-    fn visit_where_predicate(&mut self, predicate: &'v hir::WherePredicate<'v>) {\n-        self.record(\"WherePredicate\", Id::None, predicate);\n-        hir_visit::walk_where_predicate(self, predicate)\n+    fn visit_use(&mut self, p: &'v hir::Path<'v>, hir_id: hir::HirId) {\n+        // This is `visit_use`, but the type is `Path` so record it that way.\n+        self.record(\"Path\", Id::None, p);\n+        hir_visit::walk_use(self, p, hir_id)\n     }\n \n     fn visit_trait_item(&mut self, ti: &'v hir::TraitItem<'v>) {\n-        self.record(\"TraitItem\", Id::Node(ti.hir_id()), ti);\n+        record_variants!(\n+            (self, ti, ti.kind, Id::Node(ti.hir_id()), hir, TraitItem, TraitItemKind),\n+            [Const, Fn, Type]\n+        );\n         hir_visit::walk_trait_item(self, ti)\n     }\n \n+    fn visit_trait_item_ref(&mut self, ti: &'v hir::TraitItemRef) {\n+        self.record(\"TraitItemRef\", Id::Node(ti.id.hir_id()), ti);\n+        hir_visit::walk_trait_item_ref(self, ti)\n+    }\n+\n     fn visit_impl_item(&mut self, ii: &'v hir::ImplItem<'v>) {\n-        self.record(\"ImplItem\", Id::Node(ii.hir_id()), ii);\n+        record_variants!(\n+            (self, ii, ii.kind, Id::Node(ii.hir_id()), hir, ImplItem, ImplItemKind),\n+            [Const, Fn, TyAlias]\n+        );\n         hir_visit::walk_impl_item(self, ii)\n     }\n \n-    fn visit_param_bound(&mut self, bounds: &'v hir::GenericBound<'v>) {\n-        self.record(\"GenericBound\", Id::None, bounds);\n-        hir_visit::walk_param_bound(self, bounds)\n+    fn visit_foreign_item_ref(&mut self, fi: &'v hir::ForeignItemRef) {\n+        self.record(\"ForeignItemRef\", Id::Node(fi.id.hir_id()), fi);\n+        hir_visit::walk_foreign_item_ref(self, fi)\n+    }\n+\n+    fn visit_impl_item_ref(&mut self, ii: &'v hir::ImplItemRef) {\n+        self.record(\"ImplItemRef\", Id::Node(ii.id.hir_id()), ii);\n+        hir_visit::walk_impl_item_ref(self, ii)\n+    }\n+\n+    fn visit_param_bound(&mut self, b: &'v hir::GenericBound<'v>) {\n+        record_variants!(\n+            (self, b, b, Id::None, hir, GenericBound, GenericBound),\n+            [Trait, LangItemTrait, Outlives]\n+        );\n+        hir_visit::walk_param_bound(self, b)\n     }\n \n     fn visit_field_def(&mut self, s: &'v hir::FieldDef<'v>) {\n@@ -281,30 +424,34 @@ impl<'v> hir_visit::Visitor<'v> for StatCollector<'v> {\n         hir_visit::walk_variant(self, v)\n     }\n \n-    fn visit_lifetime(&mut self, lifetime: &'v hir::Lifetime) {\n-        self.record(\"Lifetime\", Id::Node(lifetime.hir_id), lifetime);\n-        hir_visit::walk_lifetime(self, lifetime)\n-    }\n-\n-    fn visit_qpath(&mut self, qpath: &'v hir::QPath<'v>, id: hir::HirId, span: Span) {\n-        self.record(\"QPath\", Id::None, qpath);\n-        hir_visit::walk_qpath(self, qpath, id, span)\n+    fn visit_generic_arg(&mut self, ga: &'v hir::GenericArg<'v>) {\n+        record_variants!(\n+            (self, ga, ga, Id::Node(ga.hir_id()), hir, GenericArg, GenericArg),\n+            [Lifetime, Type, Const, Infer]\n+        );\n+        match ga {\n+            hir::GenericArg::Lifetime(lt) => self.visit_lifetime(lt),\n+            hir::GenericArg::Type(ty) => self.visit_ty(ty),\n+            hir::GenericArg::Const(ct) => self.visit_anon_const(&ct.value),\n+            hir::GenericArg::Infer(inf) => self.visit_infer(inf),\n+        }\n     }\n \n     fn visit_path(&mut self, path: &'v hir::Path<'v>, _id: hir::HirId) {\n         self.record(\"Path\", Id::None, path);\n         hir_visit::walk_path(self, path)\n     }\n \n-    // `PathSegment` has one inline use (in `ast::ExprKind::MethodCall`) and\n-    // one non-inline use (in `Path::segments`). The latter case is more common\n-    // than the former case, so we implement this visitor and tolerate the\n-    // double counting in the former case.\n     fn visit_path_segment(&mut self, path_span: Span, path_segment: &'v hir::PathSegment<'v>) {\n         self.record(\"PathSegment\", Id::None, path_segment);\n         hir_visit::walk_path_segment(self, path_span, path_segment)\n     }\n \n+    fn visit_generic_args(&mut self, sp: Span, ga: &'v hir::GenericArgs<'v>) {\n+        self.record(\"GenericArgs\", Id::None, ga);\n+        hir_visit::walk_generic_args(self, sp, ga)\n+    }\n+\n     fn visit_assoc_type_binding(&mut self, type_binding: &'v hir::TypeBinding<'v>) {\n         self.record(\"TypeBinding\", Id::Node(type_binding.hir_id), type_binding);\n         hir_visit::walk_assoc_type_binding(self, type_binding)\n@@ -313,36 +460,25 @@ impl<'v> hir_visit::Visitor<'v> for StatCollector<'v> {\n     fn visit_attribute(&mut self, attr: &'v ast::Attribute) {\n         self.record(\"Attribute\", Id::Attr(attr.id), attr);\n     }\n-}\n \n-// Used to avoid boilerplate for types with many variants.\n-macro_rules! record_variants {\n-    (\n-        ($self:ident, $val:expr, $kind:expr, $ty:ty, $tykind:ident), // mandatory pieces\n-        [$($variant:ident),*]\n-    ) => {\n-        match $kind {\n-            $(\n-                ast::$tykind::$variant { .. } => {\n-                    $self.record_variant(stringify!($ty), stringify!($variant), Id::None, $val)\n-                }\n-            )*\n-        }\n-    };\n+    fn visit_inline_asm(&mut self, asm: &'v hir::InlineAsm<'v>, id: HirId) {\n+        self.record(\"InlineAsm\", Id::None, asm);\n+        hir_visit::walk_inline_asm(self, asm, id);\n+    }\n }\n \n impl<'v> ast_visit::Visitor<'v> for StatCollector<'v> {\n     fn visit_foreign_item(&mut self, i: &'v ast::ForeignItem) {\n         record_variants!(\n-            (self, i, i.kind, ForeignItem, ForeignItemKind),\n+            (self, i, i.kind, Id::None, ast, ForeignItem, ForeignItemKind),\n             [Static, Fn, TyAlias, MacCall]\n         );\n         ast_visit::walk_foreign_item(self, i)\n     }\n \n     fn visit_item(&mut self, i: &'v ast::Item) {\n         record_variants!(\n-            (self, i, i.kind, Item, ItemKind),\n+            (self, i, i.kind, Id::None, ast, Item, ItemKind),\n             [\n                 ExternCrate,\n                 Use,\n@@ -378,7 +514,7 @@ impl<'v> ast_visit::Visitor<'v> for StatCollector<'v> {\n \n     fn visit_stmt(&mut self, s: &'v ast::Stmt) {\n         record_variants!(\n-            (self, s, s.kind, Stmt, StmtKind),\n+            (self, s, s.kind, Id::None, ast, Stmt, StmtKind),\n             [Local, Item, Expr, Semi, Empty, MacCall]\n         );\n         ast_visit::walk_stmt(self, s)\n@@ -396,7 +532,7 @@ impl<'v> ast_visit::Visitor<'v> for StatCollector<'v> {\n \n     fn visit_pat(&mut self, p: &'v ast::Pat) {\n         record_variants!(\n-            (self, p, p.kind, Pat, PatKind),\n+            (self, p, p.kind, Id::None, ast, Pat, PatKind),\n             [\n                 Wild,\n                 Ident,\n@@ -420,7 +556,7 @@ impl<'v> ast_visit::Visitor<'v> for StatCollector<'v> {\n \n     fn visit_expr(&mut self, e: &'v ast::Expr) {\n         record_variants!(\n-            (self, e, e.kind, Expr, ExprKind),\n+            (self, e, e.kind, Id::None, ast, Expr, ExprKind),\n             [\n                 Box, Array, ConstBlock, Call, MethodCall, Tup, Binary, Unary, Lit, Cast, Type, Let,\n                 If, While, ForLoop, Loop, Match, Closure, Block, Async, Await, TryBlock, Assign,\n@@ -433,7 +569,7 @@ impl<'v> ast_visit::Visitor<'v> for StatCollector<'v> {\n \n     fn visit_ty(&mut self, t: &'v ast::Ty) {\n         record_variants!(\n-            (self, t, t.kind, Ty, TyKind),\n+            (self, t, t.kind, Id::None, ast, Ty, TyKind),\n             [\n                 Slice,\n                 Array,\n@@ -465,7 +601,7 @@ impl<'v> ast_visit::Visitor<'v> for StatCollector<'v> {\n \n     fn visit_where_predicate(&mut self, p: &'v ast::WherePredicate) {\n         record_variants!(\n-            (self, p, p, WherePredicate, WherePredicate),\n+            (self, p, p, Id::None, ast, WherePredicate, WherePredicate),\n             [BoundPredicate, RegionPredicate, EqPredicate]\n         );\n         ast_visit::walk_where_predicate(self, p)\n@@ -478,14 +614,17 @@ impl<'v> ast_visit::Visitor<'v> for StatCollector<'v> {\n \n     fn visit_assoc_item(&mut self, i: &'v ast::AssocItem, ctxt: ast_visit::AssocCtxt) {\n         record_variants!(\n-            (self, i, i.kind, AssocItem, AssocItemKind),\n+            (self, i, i.kind, Id::None, ast, AssocItem, AssocItemKind),\n             [Const, Fn, TyAlias, MacCall]\n         );\n         ast_visit::walk_assoc_item(self, i, ctxt);\n     }\n \n     fn visit_param_bound(&mut self, b: &'v ast::GenericBound, _ctxt: BoundKind) {\n-        record_variants!((self, b, b, GenericBound, GenericBound), [Trait, Outlives]);\n+        record_variants!(\n+            (self, b, b, Id::None, ast, GenericBound, GenericBound),\n+            [Trait, Outlives]\n+        );\n         ast_visit::walk_param_bound(self, b)\n     }\n \n@@ -504,6 +643,10 @@ impl<'v> ast_visit::Visitor<'v> for StatCollector<'v> {\n     // common, so we don't implement `visit_use_tree` and tolerate the missed\n     // coverage in the latter case.\n \n+    // `PathSegment` has one inline use (in `ast::ExprKind::MethodCall`) and\n+    // one non-inline use (in `ast::Path::segments`). The latter case is more\n+    // common than the former case, so we implement this visitor and tolerate\n+    // the double counting in the former case.\n     fn visit_path_segment(&mut self, path_span: Span, path_segment: &'v ast::PathSegment) {\n         self.record(\"PathSegment\", Id::None, path_segment);\n         ast_visit::walk_path_segment(self, path_span, path_segment)\n@@ -514,12 +657,18 @@ impl<'v> ast_visit::Visitor<'v> for StatCollector<'v> {\n     // common, so we implement `visit_generic_args` and tolerate the double\n     // counting in the former case.\n     fn visit_generic_args(&mut self, sp: Span, g: &'v ast::GenericArgs) {\n-        record_variants!((self, g, g, GenericArgs, GenericArgs), [AngleBracketed, Parenthesized]);\n+        record_variants!(\n+            (self, g, g, Id::None, ast, GenericArgs, GenericArgs),\n+            [AngleBracketed, Parenthesized]\n+        );\n         ast_visit::walk_generic_args(self, sp, g)\n     }\n \n     fn visit_attribute(&mut self, attr: &'v ast::Attribute) {\n-        record_variants!((self, attr, attr.kind, Attribute, AttrKind), [Normal, DocComment]);\n+        record_variants!(\n+            (self, attr, attr.kind, Id::None, ast, Attribute, AttrKind),\n+            [Normal, DocComment]\n+        );\n         ast_visit::walk_attribute(self, attr)\n     }\n "}, {"sha": "c9fc6b9e47ac56fd365af28cf0ad25974dbdaaa8", "filename": "compiler/rustc_save_analysis/src/dump_visitor.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_save_analysis%2Fsrc%2Fdump_visitor.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_save_analysis%2Fsrc%2Fdump_visitor.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_save_analysis%2Fsrc%2Fdump_visitor.rs?ref=5d55009b797e7dc1e6231e522bd849279cb1d31a", "patch": "@@ -972,7 +972,7 @@ impl<'tcx> DumpVisitor<'tcx> {\n         self.process_macro_use(trait_item.span);\n         match trait_item.kind {\n             hir::TraitItemKind::Const(ref ty, body) => {\n-                let body = body.map(|b| &self.tcx.hir().body(b).value);\n+                let body = body.map(|b| self.tcx.hir().body(b).value);\n                 let attrs = self.tcx.hir().attrs(trait_item.hir_id());\n                 self.process_assoc_const(\n                     trait_item.def_id,"}, {"sha": "afac75de2d96d8e831fab717695e89e896938bd7", "filename": "compiler/rustc_typeck/src/astconv/generics.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fgenerics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fgenerics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fgenerics.rs?ref=5d55009b797e7dc1e6231e522bd849279cb1d31a", "patch": "@@ -647,7 +647,7 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n                 multispan.push_span_label(span_late, note);\n                 tcx.struct_span_lint_hir(\n                     LATE_BOUND_LIFETIME_ARGUMENTS,\n-                    args.args[0].id(),\n+                    args.args[0].hir_id(),\n                     multispan,\n                     |lint| {\n                         lint.build(msg).emit();"}, {"sha": "28e4f8ad0ef6ca01d7b98c7db2726efad3f80bc6", "filename": "compiler/rustc_typeck/src/astconv/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fastconv%2Fmod.rs?ref=5d55009b797e7dc1e6231e522bd849279cb1d31a", "patch": "@@ -397,7 +397,7 @@ impl<'o, 'tcx> dyn AstConv<'tcx> + 'o {\n                     if has_default {\n                         tcx.check_optional_stability(\n                             param.def_id,\n-                            Some(arg.id()),\n+                            Some(arg.hir_id()),\n                             arg.span(),\n                             None,\n                             AllowUnstable::No,"}, {"sha": "2435426873bcb32c3504951adbe89db2933a8f19", "filename": "compiler/rustc_typeck/src/collect/type_of.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_typeck%2Fsrc%2Fcollect%2Ftype_of.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d55009b797e7dc1e6231e522bd849279cb1d31a/compiler%2Frustc_typeck%2Fsrc%2Fcollect%2Ftype_of.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcollect%2Ftype_of.rs?ref=5d55009b797e7dc1e6231e522bd849279cb1d31a", "patch": "@@ -78,7 +78,7 @@ pub(super) fn opt_const_param_of(tcx: TyCtxt<'_>, def_id: LocalDefId) -> Option<\n                         args.args\n                             .iter()\n                             .filter(|arg| arg.is_ty_or_const())\n-                            .position(|arg| arg.id() == hir_id)\n+                            .position(|arg| arg.hir_id() == hir_id)\n                     })\n                     .unwrap_or_else(|| {\n                         bug!(\"no arg matching AnonConst in segment\");\n@@ -111,7 +111,7 @@ pub(super) fn opt_const_param_of(tcx: TyCtxt<'_>, def_id: LocalDefId) -> Option<\n                     args.args\n                         .iter()\n                         .filter(|arg| arg.is_ty_or_const())\n-                        .position(|arg| arg.id() == hir_id)\n+                        .position(|arg| arg.hir_id() == hir_id)\n                 })\n                 .unwrap_or_else(|| {\n                     bug!(\"no arg matching AnonConst in segment\");\n@@ -165,7 +165,7 @@ pub(super) fn opt_const_param_of(tcx: TyCtxt<'_>, def_id: LocalDefId) -> Option<\n                 args.args\n                 .iter()\n                 .filter(|arg| arg.is_ty_or_const())\n-                .position(|arg| arg.id() == hir_id)\n+                .position(|arg| arg.hir_id() == hir_id)\n                 .map(|index| (index, seg)).or_else(|| args.bindings\n                     .iter()\n                     .filter_map(TypeBinding::opt_const)\n@@ -228,7 +228,7 @@ fn get_path_containing_arg_in_pat<'hir>(\n             .iter()\n             .filter_map(|seg| seg.args)\n             .flat_map(|args| args.args)\n-            .any(|arg| arg.id() == arg_id)\n+            .any(|arg| arg.hir_id() == arg_id)\n     };\n     let mut arg_path = None;\n     pat.walk(|pat| match pat.kind {"}, {"sha": "78f709975556fd4858334fff99e87d9bd1b09088", "filename": "src/test/ui/stats/hir-stats.stderr", "status": "modified", "additions": 177, "deletions": 151, "changes": 328, "blob_url": "https://github.com/rust-lang/rust/blob/5d55009b797e7dc1e6231e522bd849279cb1d31a/src%2Ftest%2Fui%2Fstats%2Fhir-stats.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5d55009b797e7dc1e6231e522bd849279cb1d31a/src%2Ftest%2Fui%2Fstats%2Fhir-stats.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fstats%2Fhir-stats.stderr?ref=5d55009b797e7dc1e6231e522bd849279cb1d31a", "patch": "@@ -1,151 +1,177 @@\n-\n-PRE EXPANSION AST STATS\n-\n-Name                Accumulated Size         Count     Item Size\n-----------------------------------------------------------------\n-ExprField                 48 ( 0.6%)             1            48\n-Crate                     56 ( 0.7%)             1            56\n-Attribute                 64 ( 0.8%)             2            32\n-- Normal                    32 ( 0.4%)             1\n-- DocComment                32 ( 0.4%)             1\n-GenericArgs               64 ( 0.8%)             1            64\n-- AngleBracketed            64 ( 0.8%)             1\n-Local                     72 ( 0.9%)             1            72\n-WherePredicate            72 ( 0.9%)             1            72\n-- BoundPredicate            72 ( 0.9%)             1\n-Arm                       96 ( 1.1%)             2            48\n-ForeignItem               96 ( 1.1%)             1            96\n-- Fn                        96 ( 1.1%)             1\n-FieldDef                 160 ( 1.9%)             2            80\n-Stmt                     160 ( 1.9%)             5            32\n-- Local                     32 ( 0.4%)             1\n-- MacCall                   32 ( 0.4%)             1\n-- Expr                      96 ( 1.1%)             3\n-Param                    160 ( 1.9%)             4            40\n-FnDecl                   200 ( 2.4%)             5            40\n-Variant                  240 ( 2.8%)             2           120\n-Block                    288 ( 3.4%)             6            48\n-GenericBound             352 ( 4.2%)             4            88\n-- Trait                    352 ( 4.2%)             4\n-AssocItem                416 ( 4.9%)             4           104\n-- TyAlias                  208 ( 2.5%)             2\n-- Fn                       208 ( 2.5%)             2\n-GenericParam             520 ( 6.1%)             5           104\n-PathSegment              720 ( 8.5%)            30            24\n-Expr                     832 ( 9.8%)             8           104\n-- Path                     104 ( 1.2%)             1\n-- Match                    104 ( 1.2%)             1\n-- Struct                   104 ( 1.2%)             1\n-- Lit                      208 ( 2.5%)             2\n-- Block                    312 ( 3.7%)             3\n-Pat                      840 ( 9.9%)             7           120\n-- Struct                   120 ( 1.4%)             1\n-- Wild                     120 ( 1.4%)             1\n-- Ident                    600 ( 7.1%)             5\n-Ty                     1_344 (15.9%)            14            96\n-- Rptr                      96 ( 1.1%)             1\n-- Ptr                       96 ( 1.1%)             1\n-- ImplicitSelf             192 ( 2.3%)             2\n-- Path                     960 (11.4%)            10\n-Item                   1_656 (19.6%)             9           184\n-- Trait                    184 ( 2.2%)             1\n-- Enum                     184 ( 2.2%)             1\n-- ForeignMod               184 ( 2.2%)             1\n-- Impl                     184 ( 2.2%)             1\n-- Fn                       368 ( 4.4%)             2\n-- Use                      552 ( 6.5%)             3\n-----------------------------------------------------------------\n-Total                  8_456\n-\n-\n-POST EXPANSION AST STATS\n-\n-Name                Accumulated Size         Count     Item Size\n-----------------------------------------------------------------\n-ExprField                 48 ( 0.5%)             1            48\n-Crate                     56 ( 0.6%)             1            56\n-GenericArgs               64 ( 0.7%)             1            64\n-- AngleBracketed            64 ( 0.7%)             1\n-Local                     72 ( 0.8%)             1            72\n-WherePredicate            72 ( 0.8%)             1            72\n-- BoundPredicate            72 ( 0.8%)             1\n-Arm                       96 ( 1.0%)             2            48\n-ForeignItem               96 ( 1.0%)             1            96\n-- Fn                        96 ( 1.0%)             1\n-InlineAsm                120 ( 1.3%)             1           120\n-Attribute                128 ( 1.4%)             4            32\n-- DocComment                32 ( 0.3%)             1\n-- Normal                    96 ( 1.0%)             3\n-FieldDef                 160 ( 1.7%)             2            80\n-Stmt                     160 ( 1.7%)             5            32\n-- Local                     32 ( 0.3%)             1\n-- Semi                      32 ( 0.3%)             1\n-- Expr                      96 ( 1.0%)             3\n-Param                    160 ( 1.7%)             4            40\n-FnDecl                   200 ( 2.2%)             5            40\n-Variant                  240 ( 2.6%)             2           120\n-Block                    288 ( 3.1%)             6            48\n-GenericBound             352 ( 3.8%)             4            88\n-- Trait                    352 ( 3.8%)             4\n-AssocItem                416 ( 4.5%)             4           104\n-- TyAlias                  208 ( 2.3%)             2\n-- Fn                       208 ( 2.3%)             2\n-GenericParam             520 ( 5.7%)             5           104\n-PathSegment              792 ( 8.6%)            33            24\n-Pat                      840 ( 9.1%)             7           120\n-- Struct                   120 ( 1.3%)             1\n-- Wild                     120 ( 1.3%)             1\n-- Ident                    600 ( 6.5%)             5\n-Expr                     936 (10.2%)             9           104\n-- Path                     104 ( 1.1%)             1\n-- Match                    104 ( 1.1%)             1\n-- Struct                   104 ( 1.1%)             1\n-- InlineAsm                104 ( 1.1%)             1\n-- Lit                      208 ( 2.3%)             2\n-- Block                    312 ( 3.4%)             3\n-Ty                     1_344 (14.6%)            14            96\n-- Rptr                      96 ( 1.0%)             1\n-- Ptr                       96 ( 1.0%)             1\n-- ImplicitSelf             192 ( 2.1%)             2\n-- Path                     960 (10.5%)            10\n-Item                   2_024 (22.0%)            11           184\n-- Trait                    184 ( 2.0%)             1\n-- Enum                     184 ( 2.0%)             1\n-- ExternCrate              184 ( 2.0%)             1\n-- ForeignMod               184 ( 2.0%)             1\n-- Impl                     184 ( 2.0%)             1\n-- Fn                       368 ( 4.0%)             2\n-- Use                      736 ( 8.0%)             4\n-----------------------------------------------------------------\n-Total                  9_184\n-\n-\n-HIR STATS\n-\n-Name                Accumulated Size         Count     Item Size\n-----------------------------------------------------------------\n-Param                     64 ( 0.7%)             2            32\n-Local                     64 ( 0.7%)             1            64\n-ForeignItem               72 ( 0.8%)             1            72\n-FieldDef                  96 ( 1.0%)             2            48\n-Arm                       96 ( 1.0%)             2            48\n-Stmt                      96 ( 1.0%)             3            32\n-FnDecl                   120 ( 1.3%)             3            40\n-Attribute                128 ( 1.4%)             4            32\n-Lifetime                 128 ( 1.4%)             4            32\n-Variant                  160 ( 1.7%)             2            80\n-ImplItem                 176 ( 1.9%)             2            88\n-GenericBound             192 ( 2.1%)             4            48\n-TraitItem                192 ( 2.1%)             2            96\n-WherePredicate           216 ( 2.3%)             3            72\n-Block                    288 ( 3.1%)             6            48\n-QPath                    408 ( 4.4%)            17            24\n-Pat                      440 ( 4.8%)             5            88\n-Expr                     672 ( 7.3%)            12            56\n-Item                     960 (10.4%)            12            80\n-Ty                     1_152 (12.4%)            16            72\n-Path                   1_296 (14.0%)            27            48\n-PathSegment            2_240 (24.2%)            40            56\n-----------------------------------------------------------------\n-Total                  9_256\n-\n+ast-stats-1 PRE EXPANSION AST STATS\n+ast-stats-1 Name                Accumulated Size         Count     Item Size\n+ast-stats-1 ----------------------------------------------------------------\n+ast-stats-1 ExprField                 48 ( 0.6%)             1            48\n+ast-stats-1 Crate                     56 ( 0.7%)             1            56\n+ast-stats-1 Attribute                 64 ( 0.8%)             2            32\n+ast-stats-1 - Normal                    32 ( 0.4%)             1\n+ast-stats-1 - DocComment                32 ( 0.4%)             1\n+ast-stats-1 GenericArgs               64 ( 0.8%)             1            64\n+ast-stats-1 - AngleBracketed            64 ( 0.8%)             1\n+ast-stats-1 Local                     72 ( 0.9%)             1            72\n+ast-stats-1 WherePredicate            72 ( 0.9%)             1            72\n+ast-stats-1 - BoundPredicate            72 ( 0.9%)             1\n+ast-stats-1 Arm                       96 ( 1.1%)             2            48\n+ast-stats-1 ForeignItem               96 ( 1.1%)             1            96\n+ast-stats-1 - Fn                        96 ( 1.1%)             1\n+ast-stats-1 FieldDef                 160 ( 1.9%)             2            80\n+ast-stats-1 Stmt                     160 ( 1.9%)             5            32\n+ast-stats-1 - Local                     32 ( 0.4%)             1\n+ast-stats-1 - MacCall                   32 ( 0.4%)             1\n+ast-stats-1 - Expr                      96 ( 1.1%)             3\n+ast-stats-1 Param                    160 ( 1.9%)             4            40\n+ast-stats-1 FnDecl                   200 ( 2.4%)             5            40\n+ast-stats-1 Variant                  240 ( 2.8%)             2           120\n+ast-stats-1 Block                    288 ( 3.4%)             6            48\n+ast-stats-1 GenericBound             352 ( 4.2%)             4            88\n+ast-stats-1 - Trait                    352 ( 4.2%)             4\n+ast-stats-1 AssocItem                416 ( 4.9%)             4           104\n+ast-stats-1 - TyAlias                  208 ( 2.5%)             2\n+ast-stats-1 - Fn                       208 ( 2.5%)             2\n+ast-stats-1 GenericParam             520 ( 6.1%)             5           104\n+ast-stats-1 PathSegment              720 ( 8.5%)            30            24\n+ast-stats-1 Expr                     832 ( 9.8%)             8           104\n+ast-stats-1 - Path                     104 ( 1.2%)             1\n+ast-stats-1 - Match                    104 ( 1.2%)             1\n+ast-stats-1 - Struct                   104 ( 1.2%)             1\n+ast-stats-1 - Lit                      208 ( 2.5%)             2\n+ast-stats-1 - Block                    312 ( 3.7%)             3\n+ast-stats-1 Pat                      840 ( 9.9%)             7           120\n+ast-stats-1 - Struct                   120 ( 1.4%)             1\n+ast-stats-1 - Wild                     120 ( 1.4%)             1\n+ast-stats-1 - Ident                    600 ( 7.1%)             5\n+ast-stats-1 Ty                     1_344 (15.9%)            14            96\n+ast-stats-1 - Rptr                      96 ( 1.1%)             1\n+ast-stats-1 - Ptr                       96 ( 1.1%)             1\n+ast-stats-1 - ImplicitSelf             192 ( 2.3%)             2\n+ast-stats-1 - Path                     960 (11.4%)            10\n+ast-stats-1 Item                   1_656 (19.6%)             9           184\n+ast-stats-1 - Trait                    184 ( 2.2%)             1\n+ast-stats-1 - Enum                     184 ( 2.2%)             1\n+ast-stats-1 - ForeignMod               184 ( 2.2%)             1\n+ast-stats-1 - Impl                     184 ( 2.2%)             1\n+ast-stats-1 - Fn                       368 ( 4.4%)             2\n+ast-stats-1 - Use                      552 ( 6.5%)             3\n+ast-stats-1 ----------------------------------------------------------------\n+ast-stats-1 Total                  8_456\n+ast-stats-1\n+ast-stats-2 POST EXPANSION AST STATS\n+ast-stats-2 Name                Accumulated Size         Count     Item Size\n+ast-stats-2 ----------------------------------------------------------------\n+ast-stats-2 ExprField                 48 ( 0.5%)             1            48\n+ast-stats-2 Crate                     56 ( 0.6%)             1            56\n+ast-stats-2 GenericArgs               64 ( 0.7%)             1            64\n+ast-stats-2 - AngleBracketed            64 ( 0.7%)             1\n+ast-stats-2 Local                     72 ( 0.8%)             1            72\n+ast-stats-2 WherePredicate            72 ( 0.8%)             1            72\n+ast-stats-2 - BoundPredicate            72 ( 0.8%)             1\n+ast-stats-2 Arm                       96 ( 1.0%)             2            48\n+ast-stats-2 ForeignItem               96 ( 1.0%)             1            96\n+ast-stats-2 - Fn                        96 ( 1.0%)             1\n+ast-stats-2 InlineAsm                120 ( 1.3%)             1           120\n+ast-stats-2 Attribute                128 ( 1.4%)             4            32\n+ast-stats-2 - DocComment                32 ( 0.3%)             1\n+ast-stats-2 - Normal                    96 ( 1.0%)             3\n+ast-stats-2 FieldDef                 160 ( 1.7%)             2            80\n+ast-stats-2 Stmt                     160 ( 1.7%)             5            32\n+ast-stats-2 - Local                     32 ( 0.3%)             1\n+ast-stats-2 - Semi                      32 ( 0.3%)             1\n+ast-stats-2 - Expr                      96 ( 1.0%)             3\n+ast-stats-2 Param                    160 ( 1.7%)             4            40\n+ast-stats-2 FnDecl                   200 ( 2.2%)             5            40\n+ast-stats-2 Variant                  240 ( 2.6%)             2           120\n+ast-stats-2 Block                    288 ( 3.1%)             6            48\n+ast-stats-2 GenericBound             352 ( 3.8%)             4            88\n+ast-stats-2 - Trait                    352 ( 3.8%)             4\n+ast-stats-2 AssocItem                416 ( 4.5%)             4           104\n+ast-stats-2 - TyAlias                  208 ( 2.3%)             2\n+ast-stats-2 - Fn                       208 ( 2.3%)             2\n+ast-stats-2 GenericParam             520 ( 5.7%)             5           104\n+ast-stats-2 PathSegment              792 ( 8.6%)            33            24\n+ast-stats-2 Pat                      840 ( 9.1%)             7           120\n+ast-stats-2 - Struct                   120 ( 1.3%)             1\n+ast-stats-2 - Wild                     120 ( 1.3%)             1\n+ast-stats-2 - Ident                    600 ( 6.5%)             5\n+ast-stats-2 Expr                     936 (10.2%)             9           104\n+ast-stats-2 - Path                     104 ( 1.1%)             1\n+ast-stats-2 - Match                    104 ( 1.1%)             1\n+ast-stats-2 - Struct                   104 ( 1.1%)             1\n+ast-stats-2 - InlineAsm                104 ( 1.1%)             1\n+ast-stats-2 - Lit                      208 ( 2.3%)             2\n+ast-stats-2 - Block                    312 ( 3.4%)             3\n+ast-stats-2 Ty                     1_344 (14.6%)            14            96\n+ast-stats-2 - Rptr                      96 ( 1.0%)             1\n+ast-stats-2 - Ptr                       96 ( 1.0%)             1\n+ast-stats-2 - ImplicitSelf             192 ( 2.1%)             2\n+ast-stats-2 - Path                     960 (10.5%)            10\n+ast-stats-2 Item                   2_024 (22.0%)            11           184\n+ast-stats-2 - Trait                    184 ( 2.0%)             1\n+ast-stats-2 - Enum                     184 ( 2.0%)             1\n+ast-stats-2 - ExternCrate              184 ( 2.0%)             1\n+ast-stats-2 - ForeignMod               184 ( 2.0%)             1\n+ast-stats-2 - Impl                     184 ( 2.0%)             1\n+ast-stats-2 - Fn                       368 ( 4.0%)             2\n+ast-stats-2 - Use                      736 ( 8.0%)             4\n+ast-stats-2 ----------------------------------------------------------------\n+ast-stats-2 Total                  9_184\n+ast-stats-2\n+hir-stats HIR STATS\n+hir-stats Name                Accumulated Size         Count     Item Size\n+hir-stats ----------------------------------------------------------------\n+hir-stats ForeignItemRef            24 ( 0.2%)             1            24\n+hir-stats Mod                       32 ( 0.3%)             1            32\n+hir-stats ExprField                 40 ( 0.4%)             1            40\n+hir-stats TraitItemRef              56 ( 0.6%)             2            28\n+hir-stats Param                     64 ( 0.6%)             2            32\n+hir-stats Local                     64 ( 0.6%)             1            64\n+hir-stats InlineAsm                 72 ( 0.7%)             1            72\n+hir-stats ImplItemRef               72 ( 0.7%)             2            36\n+hir-stats FieldDef                  96 ( 1.0%)             2            48\n+hir-stats Arm                       96 ( 1.0%)             2            48\n+hir-stats Body                      96 ( 1.0%)             3            32\n+hir-stats Stmt                      96 ( 1.0%)             3            32\n+hir-stats - Local                     32 ( 0.3%)             1\n+hir-stats - Semi                      32 ( 0.3%)             1\n+hir-stats - Expr                      32 ( 0.3%)             1\n+hir-stats FnDecl                   120 ( 1.2%)             3            40\n+hir-stats Attribute                128 ( 1.3%)             4            32\n+hir-stats GenericArgs              144 ( 1.4%)             3            48\n+hir-stats Variant                  160 ( 1.6%)             2            80\n+hir-stats GenericArg               160 ( 1.6%)             4            40\n+hir-stats - Type                      40 ( 0.4%)             1\n+hir-stats - Lifetime                 120 ( 1.2%)             3\n+hir-stats GenericBound             192 ( 1.9%)             4            48\n+hir-stats - Trait                    192 ( 1.9%)             4\n+hir-stats WherePredicate           216 ( 2.1%)             3            72\n+hir-stats - BoundPredicate           216 ( 2.1%)             3\n+hir-stats Block                    288 ( 2.9%)             6            48\n+hir-stats GenericParam             400 ( 4.0%)             5            80\n+hir-stats Pat                      440 ( 4.4%)             5            88\n+hir-stats - Wild                      88 ( 0.9%)             1\n+hir-stats - Struct                    88 ( 0.9%)             1\n+hir-stats - Binding                  264 ( 2.6%)             3\n+hir-stats Generics                 560 ( 5.5%)            10            56\n+hir-stats Expr                     672 ( 6.7%)            12            56\n+hir-stats - Path                      56 ( 0.6%)             1\n+hir-stats - Struct                    56 ( 0.6%)             1\n+hir-stats - Match                     56 ( 0.6%)             1\n+hir-stats - InlineAsm                 56 ( 0.6%)             1\n+hir-stats - Lit                      112 ( 1.1%)             2\n+hir-stats - Block                    336 ( 3.3%)             6\n+hir-stats Item                     960 ( 9.5%)            12            80\n+hir-stats - Trait                     80 ( 0.8%)             1\n+hir-stats - Enum                      80 ( 0.8%)             1\n+hir-stats - ExternCrate               80 ( 0.8%)             1\n+hir-stats - ForeignMod                80 ( 0.8%)             1\n+hir-stats - Impl                      80 ( 0.8%)             1\n+hir-stats - Fn                       160 ( 1.6%)             2\n+hir-stats - Use                      400 ( 4.0%)             5\n+hir-stats Ty                     1_080 (10.7%)            15            72\n+hir-stats - Ptr                       72 ( 0.7%)             1\n+hir-stats - Rptr                      72 ( 0.7%)             1\n+hir-stats - Path                     936 ( 9.3%)            13\n+hir-stats Path                   1_536 (15.2%)            32            48\n+hir-stats PathSegment            2_240 (22.2%)            40            56\n+hir-stats ----------------------------------------------------------------\n+hir-stats Total                 10_104\n+hir-stats"}, {"sha": "5448360049d2e2bd62c8faabf7552ff0f8acbee4", "filename": "src/tools/clippy/clippy_lints/src/loops/never_loop.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/5d55009b797e7dc1e6231e522bd849279cb1d31a/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Fnever_loop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d55009b797e7dc1e6231e522bd849279cb1d31a/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Fnever_loop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Floops%2Fnever_loop.rs?ref=5d55009b797e7dc1e6231e522bd849279cb1d31a", "patch": "@@ -178,9 +178,9 @@ fn never_loop_expr(expr: &Expr<'_>, main_loop_id: HirId) -> NeverLoopResult {\n                 InlineAsmOperand::In { expr, .. } | InlineAsmOperand::InOut { expr, .. } => {\n                     never_loop_expr(expr, main_loop_id)\n                 },\n-                InlineAsmOperand::Out { expr, .. } => never_loop_expr_all(&mut expr.iter(), main_loop_id),\n+                InlineAsmOperand::Out { expr, .. } => never_loop_expr_all(&mut expr.iter().copied(), main_loop_id),\n                 InlineAsmOperand::SplitInOut { in_expr, out_expr, .. } => {\n-                    never_loop_expr_all(&mut once(in_expr).chain(out_expr.iter()), main_loop_id)\n+                    never_loop_expr_all(&mut once(*in_expr).chain(out_expr.iter().copied()), main_loop_id)\n                 },\n                 InlineAsmOperand::Const { .. }\n                 | InlineAsmOperand::SymFn { .. }"}, {"sha": "940601a44fb072c370e82e1d435c8acde6bc6dbf", "filename": "src/tools/clippy/clippy_lints/src/manual_bits.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5d55009b797e7dc1e6231e522bd849279cb1d31a/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Fmanual_bits.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d55009b797e7dc1e6231e522bd849279cb1d31a/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Fmanual_bits.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Fmanual_bits.rs?ref=5d55009b797e7dc1e6231e522bd849279cb1d31a", "patch": "@@ -105,7 +105,7 @@ fn get_size_of_ty<'tcx>(cx: &LateContext<'tcx>, expr: &'tcx Expr<'_>) -> Option<\n         if let Some(def_id) = cx.qpath_res(count_func_qpath, count_func.hir_id).opt_def_id();\n         if cx.tcx.is_diagnostic_item(sym::mem_size_of, def_id);\n         then {\n-            cx.typeck_results().node_substs(count_func.hir_id).types().next().map(|resolved_ty| (real_ty, resolved_ty))\n+            cx.typeck_results().node_substs(count_func.hir_id).types().next().map(|resolved_ty| (*real_ty, resolved_ty))\n         } else {\n             None\n         }"}, {"sha": "3ffcaa90af3e57dd3b37cc97cfc65a882a6d282a", "filename": "src/tools/clippy/clippy_lints/src/utils/author.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5d55009b797e7dc1e6231e522bd849279cb1d31a/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Futils%2Fauthor.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d55009b797e7dc1e6231e522bd849279cb1d31a/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Futils%2Fauthor.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_lints%2Fsrc%2Futils%2Fauthor.rs?ref=5d55009b797e7dc1e6231e522bd849279cb1d31a", "patch": "@@ -595,7 +595,7 @@ impl<'a, 'tcx> PrintVisitor<'a, 'tcx> {\n     }\n \n     fn body(&self, body_id: &Binding<hir::BodyId>) {\n-        let expr = &self.cx.tcx.hir().body(body_id.value).value;\n+        let expr = self.cx.tcx.hir().body(body_id.value).value;\n         bind!(self, expr);\n         out!(\"let {expr} = &cx.tcx.hir().body({body_id}).value;\");\n         self.expr(expr);"}, {"sha": "f3a08e98688e9dbae1a120d20d7eeaf48f02d26a", "filename": "src/tools/clippy/clippy_utils/src/lib.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/5d55009b797e7dc1e6231e522bd849279cb1d31a/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d55009b797e7dc1e6231e522bd849279cb1d31a/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fclippy%2Fclippy_utils%2Fsrc%2Flib.rs?ref=5d55009b797e7dc1e6231e522bd849279cb1d31a", "patch": "@@ -337,7 +337,7 @@ pub fn qpath_generic_tys<'tcx>(qpath: &QPath<'tcx>) -> impl Iterator<Item = &'tc\n         .map_or(&[][..], |a| a.args)\n         .iter()\n         .filter_map(|a| match a {\n-            hir::GenericArg::Type(ty) => Some(ty),\n+            hir::GenericArg::Type(ty) => Some(*ty),\n             _ => None,\n         })\n }\n@@ -1812,7 +1812,7 @@ pub fn is_expr_identity_function(cx: &LateContext<'_>, expr: &Expr<'_>) -> bool\n             }\n         };\n \n-        let mut expr = &func.value;\n+        let mut expr = func.value;\n         loop {\n             match expr.kind {\n                 #[rustfmt::skip]"}]}