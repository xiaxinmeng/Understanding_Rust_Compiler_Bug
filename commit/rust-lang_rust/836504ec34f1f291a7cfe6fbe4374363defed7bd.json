{"sha": "836504ec34f1f291a7cfe6fbe4374363defed7bd", "node_id": "C_kwDOAAsO6NoAKDgzNjUwNGVjMzRmMWYyOTFhN2NmZTZmYmU0Mzc0MzYzZGVmZWQ3YmQ", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2023-04-05T22:18:30Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-04-05T22:18:30Z"}, "message": "Rollup merge of #109922 - Amanieu:ohos-no_thread_local, r=wesleywiser\n\nDisable `has_thread_local` on OpenHarmony\n\nOpenHarmony uses emulated TLS, which doesn't link properly when using thread-local variables across crate boundaries with `-C prefer-dynamic`. This PR makes thread_local! use pthreads directly instead.", "tree": {"sha": "1512940784ff27d88dc0260242afa6d23495c9b1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1512940784ff27d88dc0260242afa6d23495c9b1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/836504ec34f1f291a7cfe6fbe4374363defed7bd", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkLfO2CRBK7hj4Ov3rIwAAi00IAJa+pNJAzgINbLxKnueou0TR\ncApiKwFzvBzXWVjyeL2up8VAJeWoqzkGpjsxBY/xq48E7/FLFwg+hygzJ22WLKZ8\nDsHCYOVJZexIdzJbdQyXoRYRlbtoCXx/25LlHrmEJmOK0W0r5PrnUmby6QxdITPw\n4+27EdRsCdU1Xeg5Dlv3if8TujIiUT6IJCUnhIlkt+qoihEzxs3BtHUaacEXip/n\nPNWq0Ey7tjcMWDVBd5YG5jAZw0w1sOqKcDA0OJs2i1q4/VxDO5OH8vO+xGZQVMCz\nbA/NiHrrhuNlF/x0zjcetVMjeyDfh6q2dt9dscNy4iN/qKXXv8VE3TgQnnx50IY=\n=/yhz\n-----END PGP SIGNATURE-----\n", "payload": "tree 1512940784ff27d88dc0260242afa6d23495c9b1\nparent 4b8725b854050aa1c90109c6a9515be893aaa946\nparent 69e3f7a30dc4858d951473d8e4c2540a063e5350\nauthor Yuki Okushi <jtitor@2k36.org> 1680733110 +0900\ncommitter GitHub <noreply@github.com> 1680733110 +0900\n\nRollup merge of #109922 - Amanieu:ohos-no_thread_local, r=wesleywiser\n\nDisable `has_thread_local` on OpenHarmony\n\nOpenHarmony uses emulated TLS, which doesn't link properly when using thread-local variables across crate boundaries with `-C prefer-dynamic`. This PR makes thread_local! use pthreads directly instead.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/836504ec34f1f291a7cfe6fbe4374363defed7bd", "html_url": "https://github.com/rust-lang/rust/commit/836504ec34f1f291a7cfe6fbe4374363defed7bd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/836504ec34f1f291a7cfe6fbe4374363defed7bd/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4b8725b854050aa1c90109c6a9515be893aaa946", "url": "https://api.github.com/repos/rust-lang/rust/commits/4b8725b854050aa1c90109c6a9515be893aaa946", "html_url": "https://github.com/rust-lang/rust/commit/4b8725b854050aa1c90109c6a9515be893aaa946"}, {"sha": "69e3f7a30dc4858d951473d8e4c2540a063e5350", "url": "https://api.github.com/repos/rust-lang/rust/commits/69e3f7a30dc4858d951473d8e4c2540a063e5350", "html_url": "https://github.com/rust-lang/rust/commit/69e3f7a30dc4858d951473d8e4c2540a063e5350"}], "stats": {"total": 2, "additions": 2, "deletions": 0}, "files": [{"sha": "bf1b089f657b49d8ab79e3d462d65540ec0fce44", "filename": "compiler/rustc_target/src/spec/aarch64_unknown_linux_ohos.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/836504ec34f1f291a7cfe6fbe4374363defed7bd/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_unknown_linux_ohos.rs", "raw_url": "https://github.com/rust-lang/rust/raw/836504ec34f1f291a7cfe6fbe4374363defed7bd/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_unknown_linux_ohos.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_unknown_linux_ohos.rs?ref=836504ec34f1f291a7cfe6fbe4374363defed7bd", "patch": "@@ -18,6 +18,7 @@ pub fn target() -> Target {\n             features: \"+reserve-x18\".into(),\n             mcount: \"\\u{1}_mcount\".into(),\n             force_emulated_tls: true,\n+            has_thread_local: false,\n             supported_sanitizers: SanitizerSet::ADDRESS\n                 | SanitizerSet::CFI\n                 | SanitizerSet::LEAK"}, {"sha": "16da2453367735fdb91fd3fd8e85d55643422fdb", "filename": "compiler/rustc_target/src/spec/armv7_unknown_linux_ohos.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/836504ec34f1f291a7cfe6fbe4374363defed7bd/compiler%2Frustc_target%2Fsrc%2Fspec%2Farmv7_unknown_linux_ohos.rs", "raw_url": "https://github.com/rust-lang/rust/raw/836504ec34f1f291a7cfe6fbe4374363defed7bd/compiler%2Frustc_target%2Fsrc%2Fspec%2Farmv7_unknown_linux_ohos.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Farmv7_unknown_linux_ohos.rs?ref=836504ec34f1f291a7cfe6fbe4374363defed7bd", "patch": "@@ -21,6 +21,7 @@ pub fn target() -> Target {\n             crt_static_default: false,\n             mcount: \"\\u{1}mcount\".into(),\n             force_emulated_tls: true,\n+            has_thread_local: false,\n             ..super::linux_musl_base::opts()\n         },\n     }"}]}