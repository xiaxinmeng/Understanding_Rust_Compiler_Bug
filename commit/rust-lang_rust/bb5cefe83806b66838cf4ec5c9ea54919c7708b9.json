{"sha": "bb5cefe83806b66838cf4ec5c9ea54919c7708b9", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJiNWNlZmU4MzgwNmI2NjgzOGNmNGVjNWM5ZWE1NDkxOWM3NzA4Yjk=", "commit": {"author": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2019-10-19T08:56:35Z"}, "committer": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2019-10-19T08:56:35Z"}, "message": "Test object::write backend on travis", "tree": {"sha": "3e5119a5b39dc2cbfc3f3e235fc00a386729c950", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3e5119a5b39dc2cbfc3f3e235fc00a386729c950"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bb5cefe83806b66838cf4ec5c9ea54919c7708b9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bb5cefe83806b66838cf4ec5c9ea54919c7708b9", "html_url": "https://github.com/rust-lang/rust/commit/bb5cefe83806b66838cf4ec5c9ea54919c7708b9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bb5cefe83806b66838cf4ec5c9ea54919c7708b9/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ecd9c4f2e32e88ec7fc06eaf85f758917494e632", "url": "https://api.github.com/repos/rust-lang/rust/commits/ecd9c4f2e32e88ec7fc06eaf85f758917494e632", "html_url": "https://github.com/rust-lang/rust/commit/ecd9c4f2e32e88ec7fc06eaf85f758917494e632"}], "stats": {"total": 14, "additions": 12, "deletions": 2}, "files": [{"sha": "548230651ccb2037320012a576a2b901078bc4ef", "filename": ".travis.yml", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/bb5cefe83806b66838cf4ec5c9ea54919c7708b9/.travis.yml", "raw_url": "https://github.com/rust-lang/rust/raw/bb5cefe83806b66838cf4ec5c9ea54919c7708b9/.travis.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.travis.yml?ref=bb5cefe83806b66838cf4ec5c9ea54919c7708b9", "patch": "@@ -21,3 +21,6 @@ env:\n     - RUST_BACKTRACE=1\n     # Reduce amount of benchmark runs as they are slow.\n     - COMPILE_RUNS=2 RUN_RUNS=2\n+  CG_CLIF_COMPILE_FLAGS:\n+    - \"\"\n+    - \"--features backend_object\""}, {"sha": "86347a006d7d928003befdd3456b45870dfd8af5", "filename": "Cargo.toml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/bb5cefe83806b66838cf4ec5c9ea54919c7708b9/Cargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/bb5cefe83806b66838cf4ec5c9ea54919c7708b9/Cargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.toml?ref=bb5cefe83806b66838cf4ec5c9ea54919c7708b9", "patch": "@@ -10,14 +10,14 @@ edition = \"2018\"\n crate-type = [\"dylib\"]\n \n [features]\n-backend_object = [\"object/write\"]\n+backend_object = [\"object/write\", \"cranelift-object\"]\n \n [dependencies]\n # These have to be in sync with each other\n cranelift = { git = \"https://github.com/CraneStation/cranelift.git\" }\n cranelift-module = { git = \"https://github.com/CraneStation/cranelift.git\" }\n cranelift-faerie = { git = \"https://github.com/CraneStation/cranelift.git\" }\n-cranelift-object = { git = \"https://github.com/CraneStation/cranelift.git\" }\n+cranelift-object = { git = \"https://github.com/CraneStation/cranelift.git\", optional = true }\n target-lexicon = \"0.8.1\"\n faerie = \"0.11.0\"\n "}, {"sha": "94b1cd7d583409539f77f1244fdaf168bc98e080", "filename": "src/backend.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/bb5cefe83806b66838cf4ec5c9ea54919c7708b9/src%2Fbackend.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bb5cefe83806b66838cf4ec5c9ea54919c7708b9/src%2Fbackend.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbackend.rs?ref=bb5cefe83806b66838cf4ec5c9ea54919c7708b9", "patch": "@@ -5,9 +5,13 @@ use rustc::session::Session;\n use cranelift_module::{FuncId, Module};\n \n use faerie::*;\n+#[cfg(feature = \"backend_object\")]\n use object::{SectionKind, RelocationKind, RelocationEncoding};\n+#[cfg(feature = \"backend_object\")]\n use object::write::*;\n use cranelift_faerie::{FaerieBackend, FaerieBuilder, FaerieProduct, FaerieTrapCollection};\n+\n+#[cfg(feature = \"backend_object\")]\n use cranelift_object::*;\n \n use gimli::SectionId;\n@@ -41,6 +45,7 @@ impl WriteMetadata for faerie::Artifact {\n     }\n }\n \n+#[cfg(feature = \"backend_object\")]\n impl WriteMetadata for object::write::Object {\n     fn add_rustc_section(&mut self, symbol_name: String, data: Vec<u8>, _is_like_osx: bool) {\n         let segment = self.segment_name(object::write::StandardSegment::Data).to_vec();\n@@ -108,6 +113,7 @@ impl WriteDebugInfo for FaerieProduct {\n     }\n }\n \n+#[cfg(feature = \"backend_object\")]\n impl WriteDebugInfo for ObjectProduct {\n     type SectionId = (object::write::SectionId, object::write::SymbolId);\n \n@@ -158,6 +164,7 @@ impl Emit for FaerieProduct {\n     }\n }\n \n+#[cfg(feature = \"backend_object\")]\n impl Emit for ObjectProduct {\n     fn emit(self) -> Vec<u8> {\n         self.object.write().unwrap()"}]}