{"sha": "5ae40be85191c365985e9231f5c015fddbadd6c0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVhZTQwYmU4NTE5MWMzNjU5ODVlOTIzMWY1YzAxNWZkZGJhZGQ2YzA=", "commit": {"author": {"name": "Collins Abitekaniza", "email": "abtcolns@gmail.com", "date": "2018-09-17T11:19:44Z"}, "committer": {"name": "Collins Abitekaniza", "email": "abtcolns@gmail.com", "date": "2018-09-17T11:34:42Z"}, "message": "refactor Builder::cargo, clean deps for cmd!=test", "tree": {"sha": "64e496fdb63f7484880d1f4d350d667bc4c68760", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/64e496fdb63f7484880d1f4d350d667bc4c68760"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5ae40be85191c365985e9231f5c015fddbadd6c0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5ae40be85191c365985e9231f5c015fddbadd6c0", "html_url": "https://github.com/rust-lang/rust/commit/5ae40be85191c365985e9231f5c015fddbadd6c0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5ae40be85191c365985e9231f5c015fddbadd6c0/comments", "author": {"login": "collin5", "id": 11579108, "node_id": "MDQ6VXNlcjExNTc5MTA4", "avatar_url": "https://avatars.githubusercontent.com/u/11579108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/collin5", "html_url": "https://github.com/collin5", "followers_url": "https://api.github.com/users/collin5/followers", "following_url": "https://api.github.com/users/collin5/following{/other_user}", "gists_url": "https://api.github.com/users/collin5/gists{/gist_id}", "starred_url": "https://api.github.com/users/collin5/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/collin5/subscriptions", "organizations_url": "https://api.github.com/users/collin5/orgs", "repos_url": "https://api.github.com/users/collin5/repos", "events_url": "https://api.github.com/users/collin5/events{/privacy}", "received_events_url": "https://api.github.com/users/collin5/received_events", "type": "User", "site_admin": false}, "committer": {"login": "collin5", "id": 11579108, "node_id": "MDQ6VXNlcjExNTc5MTA4", "avatar_url": "https://avatars.githubusercontent.com/u/11579108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/collin5", "html_url": "https://github.com/collin5", "followers_url": "https://api.github.com/users/collin5/followers", "following_url": "https://api.github.com/users/collin5/following{/other_user}", "gists_url": "https://api.github.com/users/collin5/gists{/gist_id}", "starred_url": "https://api.github.com/users/collin5/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/collin5/subscriptions", "organizations_url": "https://api.github.com/users/collin5/orgs", "repos_url": "https://api.github.com/users/collin5/repos", "events_url": "https://api.github.com/users/collin5/events{/privacy}", "received_events_url": "https://api.github.com/users/collin5/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9681e13bb236025577c588fdbbadbd6b5c87c451", "url": "https://api.github.com/repos/rust-lang/rust/commits/9681e13bb236025577c588fdbbadbd6b5c87c451", "html_url": "https://github.com/rust-lang/rust/commit/9681e13bb236025577c588fdbbadbd6b5c87c451"}], "stats": {"total": 8, "additions": 2, "deletions": 6}, "files": [{"sha": "861f47484b96e9c6530222f314036cb0c8db4495", "filename": "src/bootstrap/builder.rs", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/5ae40be85191c365985e9231f5c015fddbadd6c0/src%2Fbootstrap%2Fbuilder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5ae40be85191c365985e9231f5c015fddbadd6c0/src%2Fbootstrap%2Fbuilder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbuilder.rs?ref=5ae40be85191c365985e9231f5c015fddbadd6c0", "patch": "@@ -750,11 +750,10 @@ impl<'a> Builder<'a> {\n             }\n             let rustdoc = self.rustdoc(compiler.host);\n             self.clear_if_dirty(&my_out, &rustdoc);\n-        } else {\n+        } else if cmd != \"test\" {\n             match mode {\n                 Mode::Std => {\n                     self.clear_if_dirty(&my_out, &self.rustc(compiler));\n-                    self.clear_if_dirty(&my_out, &libstd_stamp);\n                 },\n                 Mode::Test => {\n                     self.clear_if_dirty(&my_out, &libstd_stamp);\n@@ -765,9 +764,7 @@ impl<'a> Builder<'a> {\n                     self.clear_if_dirty(&my_out, &libtest_stamp);\n                 },\n                 Mode::Codegen => {\n-                    self.clear_if_dirty(&my_out, &self.rustc(compiler));\n-                    self.clear_if_dirty(&my_out, &libstd_stamp);\n-                    self.clear_if_dirty(&my_out, &libtest_stamp);\n+                    self.clear_if_dirty(&my_out, &librustc_stamp);\n                 },\n                 Mode::ToolBootstrap => { },\n                 Mode::ToolStd => {"}, {"sha": "287b03f6c491da8b245b01a3343fdf9ed5613d20", "filename": "src/bootstrap/compile.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5ae40be85191c365985e9231f5c015fddbadd6c0/src%2Fbootstrap%2Fcompile.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5ae40be85191c365985e9231f5c015fddbadd6c0/src%2Fbootstrap%2Fcompile.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fcompile.rs?ref=5ae40be85191c365985e9231f5c015fddbadd6c0", "patch": "@@ -655,7 +655,6 @@ impl Step for CodegenBackend {\n         }\n \n         let out_dir = builder.cargo_out(compiler, Mode::Codegen, target);\n-        builder.clear_if_dirty(&out_dir, &librustc_stamp(builder, compiler, target));\n \n         let mut cargo = builder.cargo(compiler, Mode::Codegen, target, \"rustc\");\n         cargo.arg(\"--manifest-path\")"}]}