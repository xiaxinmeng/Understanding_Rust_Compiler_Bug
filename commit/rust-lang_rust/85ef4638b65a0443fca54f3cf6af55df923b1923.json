{"sha": "85ef4638b65a0443fca54f3cf6af55df923b1923", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg1ZWY0NjM4YjY1YTA0NDNmY2E1NGYzY2Y2YWY1NWRmOTIzYjE5MjM=", "commit": {"author": {"name": "Seiichi Uchida", "email": "seuchida@gmail.com", "date": "2017-12-20T13:46:24Z"}, "committer": {"name": "Seiichi Uchida", "email": "seuchida@gmail.com", "date": "2017-12-20T13:47:51Z"}, "message": "Make 'cargo fmt' formats every workspace member", "tree": {"sha": "cefe128820c7cba24c8e52639c8cf03c6c334d27", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cefe128820c7cba24c8e52639c8cf03c6c334d27"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/85ef4638b65a0443fca54f3cf6af55df923b1923", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/85ef4638b65a0443fca54f3cf6af55df923b1923", "html_url": "https://github.com/rust-lang/rust/commit/85ef4638b65a0443fca54f3cf6af55df923b1923", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/85ef4638b65a0443fca54f3cf6af55df923b1923/comments", "author": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "committer": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8998c1d5b580bbff99a6d63d0477daeecec4a1ac", "url": "https://api.github.com/repos/rust-lang/rust/commits/8998c1d5b580bbff99a6d63d0477daeecec4a1ac", "html_url": "https://github.com/rust-lang/rust/commit/8998c1d5b580bbff99a6d63d0477daeecec4a1ac"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "0cf1ec7674956f365ebc07c15fb585971c2d8a9c", "filename": "CHANGELOG.md", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/85ef4638b65a0443fca54f3cf6af55df923b1923/CHANGELOG.md", "raw_url": "https://github.com/rust-lang/rust/raw/85ef4638b65a0443fca54f3cf6af55df923b1923/CHANGELOG.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/CHANGELOG.md?ref=85ef4638b65a0443fca54f3cf6af55df923b1923", "patch": "@@ -2,6 +2,10 @@\n \n ## [Unreleased]\n \n+### Changed\n+\n+- `cargo fmt` will format every workspace member.\n+\n ## [0.3.2] 2017-12-15\n \n ### Changed"}, {"sha": "e45521de30b273ff816410e5af5022fd6f97d0fa", "filename": "src/bin/cargo-fmt.rs", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/85ef4638b65a0443fca54f3cf6af55df923b1923/src%2Fbin%2Fcargo-fmt.rs", "raw_url": "https://github.com/rust-lang/rust/raw/85ef4638b65a0443fca54f3cf6af55df923b1923/src%2Fbin%2Fcargo-fmt.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbin%2Fcargo-fmt.rs?ref=85ef4638b65a0443fca54f3cf6af55df923b1923", "patch": "@@ -240,7 +240,7 @@ fn get_targets_root_only(targets: &mut HashSet<Target>) -> Result<(), io::Error>\n \n     for package in metadata.packages {\n         for target in package.targets {\n-            if target.name == package.name {\n+            if is_target_workspace_members(&target.name, &metadata.workspace_members) {\n                 targets.insert(Target::from_target(&target));\n             }\n         }\n@@ -249,6 +249,15 @@ fn get_targets_root_only(targets: &mut HashSet<Target>) -> Result<(), io::Error>\n     Ok(())\n }\n \n+fn is_target_workspace_members(target: &str, workspace_members: &[String]) -> bool {\n+    workspace_members.iter().any(|member| {\n+        member\n+            .split_whitespace()\n+            .nth(0)\n+            .map_or(false, |name| name == target)\n+    })\n+}\n+\n fn get_targets_recursive(\n     manifest_path: Option<&Path>,\n     mut targets: &mut HashSet<Target>,"}]}