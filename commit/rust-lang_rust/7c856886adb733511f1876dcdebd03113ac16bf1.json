{"sha": "7c856886adb733511f1876dcdebd03113ac16bf1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdjODU2ODg2YWRiNzMzNTExZjE4NzZkY2RlYmQwMzExM2FjMTZiZjE=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2017-08-22T11:36:20Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2017-08-22T11:36:20Z"}, "message": "Rollup merge of #44014 - Mark-Simulacrum:update-readme, r=alexcrichton\n\nUpdate rustbuild README\n\nFixes https://github.com/rust-lang/rust/issues/44007.\n\nr? @alexcrichton", "tree": {"sha": "9b42a2a00250fe59e315a4833289d7428aa0a572", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9b42a2a00250fe59e315a4833289d7428aa0a572"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7c856886adb733511f1876dcdebd03113ac16bf1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7c856886adb733511f1876dcdebd03113ac16bf1", "html_url": "https://github.com/rust-lang/rust/commit/7c856886adb733511f1876dcdebd03113ac16bf1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7c856886adb733511f1876dcdebd03113ac16bf1/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6b62f34ecdddb152cbbf03169fc1f393d28fb3e4", "url": "https://api.github.com/repos/rust-lang/rust/commits/6b62f34ecdddb152cbbf03169fc1f393d28fb3e4", "html_url": "https://github.com/rust-lang/rust/commit/6b62f34ecdddb152cbbf03169fc1f393d28fb3e4"}, {"sha": "1db158d4989c8aae46a8d14713a8594a775d5f96", "url": "https://api.github.com/repos/rust-lang/rust/commits/1db158d4989c8aae46a8d14713a8594a775d5f96", "html_url": "https://github.com/rust-lang/rust/commit/1db158d4989c8aae46a8d14713a8594a775d5f96"}], "stats": {"total": 36, "additions": 20, "deletions": 16}, "files": [{"sha": "2e844ceb17831d59edd6f7481e8de525a7e54748", "filename": "src/bootstrap/README.md", "status": "modified", "additions": 20, "deletions": 16, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/7c856886adb733511f1876dcdebd03113ac16bf1/src%2Fbootstrap%2FREADME.md", "raw_url": "https://github.com/rust-lang/rust/raw/7c856886adb733511f1876dcdebd03113ac16bf1/src%2Fbootstrap%2FREADME.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2FREADME.md?ref=7c856886adb733511f1876dcdebd03113ac16bf1", "patch": "@@ -73,16 +73,19 @@ The script accepts commands, flags, and arguments to determine what to do:\n \n ## Configuring rustbuild\n \n-There are currently two primary methods for configuring the rustbuild build\n-system. First, the `./configure` options serialized in `config.mk` will be\n-parsed and read. That is, if any `./configure` options are passed, they'll be\n-handled naturally.\n+There are currently two methods for configuring the rustbuild build system.\n \n-Next, rustbuild offers a TOML-based configuration system with a `config.toml`\n+First, rustbuild offers a TOML-based configuration system with a `config.toml`\n file in the same location as `config.mk`. An example of this configuration can\n-be found at `config.toml.example`, and the configuration file\n-can also be passed as `--config path/to/config.toml` if the build system is\n-being invoked manually (via the python script).\n+be found at `config.toml.example`, and the configuration file can also be passed\n+as `--config path/to/config.toml` if the build system is being invoked manually\n+(via the python script).\n+\n+Next, the `./configure` options serialized in `config.mk` will be\n+parsed and read. That is, if any `./configure` options are passed, they'll be\n+handled naturally. `./configure` should almost never be used for local\n+installations, and is primarily useful for CI. Prefer to customize behavior\n+using `config.toml`.\n \n Finally, rustbuild makes use of the [gcc-rs crate] which has [its own\n method][env-vars] of configuring C compilers and C flags via environment\n@@ -310,17 +313,18 @@ After that, each module in rustbuild should have enough documentation to keep\n you up and running. Some general areas that you may be interested in modifying\n are:\n \n-* Adding a new build tool? Take a look at `bootstrap/step.rs` for examples of\n+* Adding a new build tool? Take a look at `bootstrap/tool.rs` for examples of\n   other tools.\n * Adding a new compiler crate? Look no further! Adding crates can be done by\n   adding a new directory with `Cargo.toml` followed by configuring all\n   `Cargo.toml` files accordingly.\n-* Adding a new dependency from crates.io? We're still working on that, so hold\n-  off on that for now.\n-* Adding a new configuration option? Take a look at `bootstrap/config.rs` or\n-  perhaps `bootstrap/flags.rs` and then modify the build elsewhere to read that\n-  option.\n+* Adding a new dependency from crates.io? This should just work inside the\n+  compiler artifacts stage (everything other than libtest and libstd).\n+* Adding a new configuration option? You'll want to modify `bootstrap/flags.rs`\n+  for command line flags and then `bootstrap/config.rs` to copy the flags to the\n+  `Config` struct.\n * Adding a sanity check? Take a look at `bootstrap/sanity.rs`.\n \n-If you have any questions feel free to reach out on `#rust-internals` on IRC or\n-open an issue in the bug tracker!\n+If you have any questions feel free to reach out on `#rust-infra` on IRC or ask on\n+internals.rust-lang.org. When you encounter bugs, please file issues on the\n+rust-lang/rust issue tracker."}]}