{"sha": "aa6bd117bbe05930476b4aec1001fff77ce66348", "node_id": "MDY6Q29tbWl0NzI0NzEyOmFhNmJkMTE3YmJlMDU5MzA0NzZiNGFlYzEwMDFmZmY3N2NlNjYzNDg=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2017-09-03T16:52:31Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2017-09-05T00:41:43Z"}, "message": "Fix missing line numbers on i686.", "tree": {"sha": "b20965eb0fce21db9f2c8897e6bb05a7e669a0cd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b20965eb0fce21db9f2c8897e6bb05a7e669a0cd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/aa6bd117bbe05930476b4aec1001fff77ce66348", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIcBAABCAAGBQJZrfLOAAoJEP72yAUdDgE84MwP/18+aa1zELqOx0CKixFJDLIq\njZirrCMeo/gqs9zwTaQXyzvzHzt4C9g0VG1DRfS0ZR6q7CXTjgP0UbWgGCbcAnwA\nq3qKe5qedYogJAMEkTH+WiDOOmwosQDvP74ghHu5FphfYUirGvye5KT1cYo0QTpd\ns35LU4YkzR3jxkk/qa3EK4xyiBZTjcurtgnAkjModuTjF01Sbhiv6yJTj6N2JBVK\nzz3zubYVkzbX6DMRcDDFLguab264efADRXFrxnU6X2cv4KzxTMT5eyeXS1jLWXXC\npljmYoyzKpRHu9WhWGv2HDGWbGqMVPPb0k9dqqA3nS/9pLymhDienLLVs/zs+o7n\nxC+GfH62dUjRoHGtysYiClFuyYUZVZ5CuUB0wvM73wcJoMogEvIbZSNI2kGtubWP\noAFxqsKi7fgPWhOmvjlR44pljGG0DSr5rsKbiybIhEIj5EefvjrxN4noBDC+0elF\nUCjfjo1aouVju2jNvo+6zewKWkFQNGBvIgD3e4HdLu9tg47eJhxMDwiSjwsH10J4\ndW/XvPq8/TMfRqx8PrTEOfaUASToxoap8cJWeXMr5rPg9KmxeXDCV7rB7oegNcru\nwMMeN090TQN1gLDWxWHCI4AZdEb+aVJt8+2JMIp3hf/RrQNi05Qys4sfFFxblYuJ\nsjP5Ni9CnwVmqzfTPoqY\n=KPtu\n-----END PGP SIGNATURE-----", "payload": "tree b20965eb0fce21db9f2c8897e6bb05a7e669a0cd\nparent 7169fe57d66dedad21f2dcf4c615feb9ab7d3f5a\nauthor kennytm <kennytm@gmail.com> 1504457551 +0800\ncommitter kennytm <kennytm@gmail.com> 1504572103 +0800\n\nFix missing line numbers on i686.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/aa6bd117bbe05930476b4aec1001fff77ce66348", "html_url": "https://github.com/rust-lang/rust/commit/aa6bd117bbe05930476b4aec1001fff77ce66348", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/aa6bd117bbe05930476b4aec1001fff77ce66348/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7169fe57d66dedad21f2dcf4c615feb9ab7d3f5a", "url": "https://api.github.com/repos/rust-lang/rust/commits/7169fe57d66dedad21f2dcf4c615feb9ab7d3f5a", "html_url": "https://github.com/rust-lang/rust/commit/7169fe57d66dedad21f2dcf4c615feb9ab7d3f5a"}], "stats": {"total": 13, "additions": 6, "deletions": 7}, "files": [{"sha": "9af14e724b40d8b292f5b9683e5ad7a51c07ee2b", "filename": "src/libbacktrace/macho.c", "status": "modified", "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/aa6bd117bbe05930476b4aec1001fff77ce66348/src%2Flibbacktrace%2Fmacho.c", "raw_url": "https://github.com/rust-lang/rust/raw/aa6bd117bbe05930476b4aec1001fff77ce66348/src%2Flibbacktrace%2Fmacho.c", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibbacktrace%2Fmacho.c?ref=aa6bd117bbe05930476b4aec1001fff77ce66348", "patch": "@@ -1,7 +1,7 @@\n /* macho.c -- Get debug data from an Mach-O file for backtraces.\n    Copyright (C) 2012-2016 Free Software Foundation, Inc.\n    Written by John Colanduoni.\n-   \n+\n    Pending upstream pull request:\n    https://github.com/ianlancetaylor/libbacktrace/pull/2\n \n@@ -288,7 +288,7 @@ macho_get_commands (struct backtrace_state *state, int descriptor,\n \n       archs_total_size = arch_count * sizeof (struct fat_arch);\n \n-      if (!backtrace_get_view (state, descriptor, sizeof (fat_header),\n+      if (!backtrace_get_view (state, descriptor, sizeof (struct fat_header),\n                                archs_total_size, error_callback,\n                                data, &fat_archs_view))\n         goto end;\n@@ -1361,7 +1361,7 @@ backtrace_initialize (struct backtrace_state *state, int descriptor,\n       current_vmslide = _dyld_get_image_vmaddr_slide (i);\n       current_name = _dyld_get_image_name (i);\n \n-      if (current_name == NULL)\n+      if (current_name == NULL || (i != 0 && current_vmslide == 0))\n         continue;\n \n       if (!(current_descriptor =\n@@ -1370,16 +1370,15 @@ backtrace_initialize (struct backtrace_state *state, int descriptor,\n           continue;\n         }\n \n-      if (!macho_add (state, error_callback, data, current_descriptor,\n+      if (macho_add (state, error_callback, data, current_descriptor,\n                       current_name, &macho_fileline_fn, current_vmslide,\n                       &current_found_sym, &current_found_dwarf))\n         {\n-          return 0;\n+          found_sym = found_sym || current_found_sym;\n+          found_dwarf = found_dwarf || current_found_dwarf;\n         }\n \n       backtrace_close (current_descriptor, error_callback, data);\n-      found_sym = found_sym || current_found_sym;\n-      found_dwarf = found_dwarf || current_found_dwarf;\n     }\n \n   if (!state->threaded)"}]}