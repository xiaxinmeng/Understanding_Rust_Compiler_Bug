{"sha": "5e6dc927f7a935874a08c2c3913f24295711d8f2", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVlNmRjOTI3ZjdhOTM1ODc0YTA4YzJjMzkxM2YyNDI5NTcxMWQ4ZjI=", "commit": {"author": {"name": "ThePuzzlemaker", "email": "tpzker@thepuzzlemaker.info", "date": "2020-12-22T19:25:37Z"}, "committer": {"name": "ThePuzzlemaker", "email": "tpzker@thepuzzlemaker.info", "date": "2020-12-22T19:26:28Z"}, "message": "Add regression test for #80179", "tree": {"sha": "96915bfc0c26432bf2ca7debfa17c5df88477068", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/96915bfc0c26432bf2ca7debfa17c5df88477068"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5e6dc927f7a935874a08c2c3913f24295711d8f2", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCAAdFiEEcJXCCpIkPbZRdwewlozZ1xyfu2wFAl/iSGQACgkQlozZ1xyf\nu2ylgQwAhnC7SCykyEdl5hNl8ki0SjgQ0Dr7zw2GecZtWQvI41nP8sMnf5mfeWfL\ncraKUsxYmduGUvggPA8rLzHr857Dqj2aZ8Ck7AUCPf80govzN6DyJSOxd8eIrS7h\ngeIwrY2mJ/UxqFBkXfRIuSxbV7TSxBB0SLGYXxq/b4SfWrwVnMRx+rRDjG894Vss\nGRubOumGjIBeEc0BeyuZM7HvRT5sBFywQuLGz5On+DmpW1DXcmge9mqVnYKdBpqf\nhFx3w6BCr2sRw/Wk2x/0ASU3Ygo35Zx1LwGH4F9fpanXD7Uqx8K2MQ8Z3tpcimSX\n6V5uTj6HdfQWZGJIYQ1oqk08UqGyx52zOm3wtFknbYy7/syEp3QzZiybyGC0NKoZ\n0VyNF7v3+yevMym5+GVe8DKhtkPMe/aJ7ssY29fmoUsENTQSqUR9hXzrEMX7pzQu\noKtNiJ9tKPrdFwZ4TXRmVSoDWKgT1Pxm02EHRDRWt9CnPv9x5yMPcHEsYjzvT+Oc\ns6tBYXXG\n=cxzf\n-----END PGP SIGNATURE-----", "payload": "tree 96915bfc0c26432bf2ca7debfa17c5df88477068\nparent 4f6be466fdec69dbf6ce768d41a43acf0fc3b47b\nauthor ThePuzzlemaker <tpzker@thepuzzlemaker.info> 1608665137 -0600\ncommitter ThePuzzlemaker <tpzker@thepuzzlemaker.info> 1608665188 -0600\n\nAdd regression test for #80179\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5e6dc927f7a935874a08c2c3913f24295711d8f2", "html_url": "https://github.com/rust-lang/rust/commit/5e6dc927f7a935874a08c2c3913f24295711d8f2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5e6dc927f7a935874a08c2c3913f24295711d8f2/comments", "author": {"login": "ThePuzzlemaker", "id": 12666617, "node_id": "MDQ6VXNlcjEyNjY2NjE3", "avatar_url": "https://avatars.githubusercontent.com/u/12666617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ThePuzzlemaker", "html_url": "https://github.com/ThePuzzlemaker", "followers_url": "https://api.github.com/users/ThePuzzlemaker/followers", "following_url": "https://api.github.com/users/ThePuzzlemaker/following{/other_user}", "gists_url": "https://api.github.com/users/ThePuzzlemaker/gists{/gist_id}", "starred_url": "https://api.github.com/users/ThePuzzlemaker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ThePuzzlemaker/subscriptions", "organizations_url": "https://api.github.com/users/ThePuzzlemaker/orgs", "repos_url": "https://api.github.com/users/ThePuzzlemaker/repos", "events_url": "https://api.github.com/users/ThePuzzlemaker/events{/privacy}", "received_events_url": "https://api.github.com/users/ThePuzzlemaker/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ThePuzzlemaker", "id": 12666617, "node_id": "MDQ6VXNlcjEyNjY2NjE3", "avatar_url": "https://avatars.githubusercontent.com/u/12666617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ThePuzzlemaker", "html_url": "https://github.com/ThePuzzlemaker", "followers_url": "https://api.github.com/users/ThePuzzlemaker/followers", "following_url": "https://api.github.com/users/ThePuzzlemaker/following{/other_user}", "gists_url": "https://api.github.com/users/ThePuzzlemaker/gists{/gist_id}", "starred_url": "https://api.github.com/users/ThePuzzlemaker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ThePuzzlemaker/subscriptions", "organizations_url": "https://api.github.com/users/ThePuzzlemaker/orgs", "repos_url": "https://api.github.com/users/ThePuzzlemaker/repos", "events_url": "https://api.github.com/users/ThePuzzlemaker/events{/privacy}", "received_events_url": "https://api.github.com/users/ThePuzzlemaker/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4f6be466fdec69dbf6ce768d41a43acf0fc3b47b", "url": "https://api.github.com/repos/rust-lang/rust/commits/4f6be466fdec69dbf6ce768d41a43acf0fc3b47b", "html_url": "https://github.com/rust-lang/rust/commit/4f6be466fdec69dbf6ce768d41a43acf0fc3b47b"}], "stats": {"total": 48, "additions": 48, "deletions": 0}, "files": [{"sha": "7609b1525cc90a286922949b75278d6d75e2aee8", "filename": "src/test/ui/fn/issue-80179.rs", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/5e6dc927f7a935874a08c2c3913f24295711d8f2/src%2Ftest%2Fui%2Ffn%2Fissue-80179.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e6dc927f7a935874a08c2c3913f24295711d8f2/src%2Ftest%2Fui%2Ffn%2Fissue-80179.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffn%2Fissue-80179.rs?ref=5e6dc927f7a935874a08c2c3913f24295711d8f2", "patch": "@@ -0,0 +1,27 @@\n+// Functions with a type placeholder `_` as the return type should\n+// show a function pointer suggestion when given a function item\n+// and suggest how to return closures correctly from a function.\n+// This is a regression test of #80179\n+\n+fn returns_i32() -> i32 {\n+    0\n+}\n+\n+fn returns_fn_ptr() -> _ {\n+//~^ ERROR the type placeholder `_` is not allowed within types on item signatures [E0121]\n+//~| NOTE not allowed in type signatures\n+//~| HELP replace with the correct return type\n+//~| SUGGESTION fn() -> i32\n+    returns_i32\n+}\n+\n+fn returns_closure() -> _ {\n+//~^ ERROR the type placeholder `_` is not allowed within types on item signatures [E0121]\n+//~| NOTE not allowed in type signatures\n+//~| HELP consider using an `Fn`, `FnMut`, or `FnOnce` trait bound\n+//~| NOTE for more information on `Fn` traits and closure types, see\n+//        https://doc.rust-lang.org/book/ch13-01-closures.html\n+    || 0\n+}\n+\n+fn main() {}"}, {"sha": "63571e71b34f49415cbbe450c1123f219ef51658", "filename": "src/test/ui/fn/issue-80179.stderr", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/5e6dc927f7a935874a08c2c3913f24295711d8f2/src%2Ftest%2Fui%2Ffn%2Fissue-80179.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5e6dc927f7a935874a08c2c3913f24295711d8f2/src%2Ftest%2Fui%2Ffn%2Fissue-80179.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffn%2Fissue-80179.stderr?ref=5e6dc927f7a935874a08c2c3913f24295711d8f2", "patch": "@@ -0,0 +1,21 @@\n+error[E0121]: the type placeholder `_` is not allowed within types on item signatures\n+  --> $DIR/issue-80179.rs:10:24\n+   |\n+LL | fn returns_fn_ptr() -> _ {\n+   |                        ^\n+   |                        |\n+   |                        not allowed in type signatures\n+   |                        help: replace with the correct return type: `fn() -> i32`\n+\n+error[E0121]: the type placeholder `_` is not allowed within types on item signatures\n+  --> $DIR/issue-80179.rs:18:25\n+   |\n+LL | fn returns_closure() -> _ {\n+   |                         ^ not allowed in type signatures\n+   |\n+   = help: consider using an `Fn`, `FnMut`, or `FnOnce` trait bound\n+   = note: for more information on `Fn` traits and closure types, see https://doc.rust-lang.org/book/ch13-01-closures.html\n+\n+error: aborting due to 2 previous errors\n+\n+For more information about this error, try `rustc --explain E0121`."}]}