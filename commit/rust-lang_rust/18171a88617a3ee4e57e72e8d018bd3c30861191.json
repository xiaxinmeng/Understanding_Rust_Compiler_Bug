{"sha": "18171a88617a3ee4e57e72e8d018bd3c30861191", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE4MTcxYTg4NjE3YTNlZTRlNTdlNzJlOGQwMThiZDNjMzA4NjExOTE=", "commit": {"author": {"name": "Mark Simulacrum", "email": "mark.simulacrum@gmail.com", "date": "2017-05-16T14:18:30Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2017-05-16T14:18:30Z"}, "message": "Rollup merge of #41994 - gamazeps:thread-builder, r=GuillaumeGomez\n\n[Doc] Implrove `thread::Builder`'s doc.\n\nPart of #29378 .\n\n- Explains *why* we would use the builder instead ofthe free function.\n- Changes the parent-child explanation for a spawned-caller in `thread::Builder::spawn`\n- Adds a link to `io::Result` in `thread::Builder`\n- Corrects the return type doc in `thread::Builder::spawn`\n\nr? @rust-lang/docs", "tree": {"sha": "dc4f0187e42754b2152798c31f029f6640149a7e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/dc4f0187e42754b2152798c31f029f6640149a7e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/18171a88617a3ee4e57e72e8d018bd3c30861191", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/18171a88617a3ee4e57e72e8d018bd3c30861191", "html_url": "https://github.com/rust-lang/rust/commit/18171a88617a3ee4e57e72e8d018bd3c30861191", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/18171a88617a3ee4e57e72e8d018bd3c30861191/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "efe285e0ff2007206fd23d7d2b6b21720a52e610", "url": "https://api.github.com/repos/rust-lang/rust/commits/efe285e0ff2007206fd23d7d2b6b21720a52e610", "html_url": "https://github.com/rust-lang/rust/commit/efe285e0ff2007206fd23d7d2b6b21720a52e610"}, {"sha": "a51777ec874e31b29d85efaa186fe4841257b168", "url": "https://api.github.com/repos/rust-lang/rust/commits/a51777ec874e31b29d85efaa186fe4841257b168", "html_url": "https://github.com/rust-lang/rust/commit/a51777ec874e31b29d85efaa186fe4841257b168"}], "stats": {"total": 49, "additions": 38, "deletions": 11}, "files": [{"sha": "154406a1d8bd78ca29965e9f54f49f4af51fc896", "filename": "src/libstd/thread/mod.rs", "status": "modified", "additions": 38, "deletions": 11, "changes": 49, "blob_url": "https://github.com/rust-lang/rust/blob/18171a88617a3ee4e57e72e8d018bd3c30861191/src%2Flibstd%2Fthread%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18171a88617a3ee4e57e72e8d018bd3c30861191/src%2Flibstd%2Fthread%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fthread%2Fmod.rs?ref=18171a88617a3ee4e57e72e8d018bd3c30861191", "patch": "@@ -180,8 +180,33 @@ pub use self::local::{LocalKey, LocalKeyState};\n // Builder\n ////////////////////////////////////////////////////////////////////////////////\n \n-/// Thread configuration. Provides detailed control over the properties\n-/// and behavior of new threads.\n+/// Thread factory, which can be used in order to configure the properties of\n+/// a new thread.\n+///\n+/// Methods can be chained on it in order to configure it.\n+///\n+/// The two configurations available are:\n+///\n+/// - [`name`]: allows to give a name to the thread which is currently\n+///   only used in `panic` messages.\n+/// - [`stack_size`]: specifies the desired stack size. Note that this can\n+///   be overriden by the OS.\n+///\n+/// If the [`stack_size`] field is not specified, the stack size\n+/// will be the `RUST_MIN_STACK` environment variable. If it is\n+/// not specified either, a sensible default will be set.\n+///\n+/// If the [`name`] field is not specified, the thread will not be named.\n+///\n+/// The [`spawn`] method will take ownership of the builder and create an\n+/// [`io::Result`] to the thread handle with the given configuration.\n+///\n+/// The [`thread::spawn`] free function uses a `Builder` with default\n+/// configuration and [`unwrap`]s its return value.\n+///\n+/// You may want to use [`spawn`] instead of [`thread::spawn`], when you want\n+/// to recover from a failure to launch a thread, indeed the free function will\n+/// panick where the `Builder` method will return a [`io::Result`].\n ///\n /// # Examples\n ///\n@@ -196,6 +221,13 @@ pub use self::local::{LocalKey, LocalKeyState};\n ///\n /// handler.join().unwrap();\n /// ```\n+///\n+/// [`thread::spawn`]: ../../std/thread/fn.spawn.html\n+/// [`stack_size`]: ../../std/thread/struct.Builder.html#method.stack_size\n+/// [`name`]: ../../std/thread/struct.Builder.html#method.name\n+/// [`spawn`]: ../../std/thread/struct.Builder.html#method.spawn\n+/// [`io::Result`]: ../../std/io/type.Result.html\n+/// [`unwrap`]: ../../std/result/enum.Result.html#method.unwrap\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n #[derive(Debug)]\n pub struct Builder {\n@@ -209,11 +241,6 @@ impl Builder {\n     /// Generates the base configuration for spawning a thread, from which\n     /// configuration methods can be chained.\n     ///\n-    /// If the [`stack_size`] field is not specified, the stack size\n-    /// will be the `RUST_MIN_STACK` environment variable.  If it is\n-    /// not specified either, a sensible default will be set (2MB as\n-    /// of the writting of this doc).\n-    ///\n     /// # Examples\n     ///\n     /// ```\n@@ -229,8 +256,6 @@ impl Builder {\n     ///\n     /// handler.join().unwrap();\n     /// ```\n-    ///\n-    /// [`stack_size`]: ../../std/thread/struct.Builder.html#method.stack_size\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     pub fn new() -> Builder {\n         Builder {\n@@ -280,9 +305,10 @@ impl Builder {\n         self\n     }\n \n-    /// Spawns a new thread, and returns a join handle for it.\n+    /// Spawns a new thread by taking ownership of the `Builder`, and returns an\n+    /// [`io::Result`] to its [`JoinHandle`].\n     ///\n-    /// The child thread may outlive the parent (unless the parent thread\n+    /// The spawned thread may outlive the caller (unless the caller thread\n     /// is the main thread; the whole process is terminated when the main\n     /// thread finishes). The join handle can be used to block on\n     /// termination of the child thread, including recovering its panics.\n@@ -297,6 +323,7 @@ impl Builder {\n     ///\n     /// [`spawn`]: ../../std/thread/fn.spawn.html\n     /// [`io::Result`]: ../../std/io/type.Result.html\n+    /// [`JoinHandle`]: ../../std/thread/struct.JoinHandle.html\n     ///\n     /// # Examples\n     ///"}]}