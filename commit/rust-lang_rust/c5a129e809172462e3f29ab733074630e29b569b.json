{"sha": "c5a129e809172462e3f29ab733074630e29b569b", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM1YTEyOWU4MDkxNzI0NjJlM2YyOWFiNzMzMDc0NjMwZTI5YjU2OWI=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2018-06-10T15:48:14Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2018-06-10T15:48:14Z"}, "message": "Auto merge of #51200 - tmccombs:stable-iter-repeat-with, r=Centril,kennytm\n\nStabilize iterator_repeat_with\n\nFixes #48169", "tree": {"sha": "3909ea21a76f0b2a6b3f6b87ba75007ea7bdba6d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3909ea21a76f0b2a6b3f6b87ba75007ea7bdba6d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c5a129e809172462e3f29ab733074630e29b569b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c5a129e809172462e3f29ab733074630e29b569b", "html_url": "https://github.com/rust-lang/rust/commit/c5a129e809172462e3f29ab733074630e29b569b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c5a129e809172462e3f29ab733074630e29b569b/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "900037e3c35d822a0487f74d2866433a7ca2f19c", "url": "https://api.github.com/repos/rust-lang/rust/commits/900037e3c35d822a0487f74d2866433a7ca2f19c", "html_url": "https://github.com/rust-lang/rust/commit/900037e3c35d822a0487f74d2866433a7ca2f19c"}, {"sha": "87941b079ab29a3831c659bf467d7fb87d347c36", "url": "https://api.github.com/repos/rust-lang/rust/commits/87941b079ab29a3831c659bf467d7fb87d347c36", "html_url": "https://github.com/rust-lang/rust/commit/87941b079ab29a3831c659bf467d7fb87d347c36"}], "stats": {"total": 42, "additions": 8, "deletions": 34}, "files": [{"sha": "f152ee73b6996fa14c5d432c29c0dcdbff446f48", "filename": "src/libcore/iter/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c5a129e809172462e3f29ab733074630e29b569b/src%2Flibcore%2Fiter%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c5a129e809172462e3f29ab733074630e29b569b/src%2Flibcore%2Fiter%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fiter%2Fmod.rs?ref=c5a129e809172462e3f29ab733074630e29b569b", "patch": "@@ -333,7 +333,7 @@ pub use self::range::Step;\n \n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n pub use self::sources::{Repeat, repeat};\n-#[unstable(feature = \"iterator_repeat_with\", issue = \"48169\")]\n+#[stable(feature = \"iterator_repeat_with\", since = \"1.28.0\")]\n pub use self::sources::{RepeatWith, repeat_with};\n #[stable(feature = \"iter_empty\", since = \"1.2.0\")]\n pub use self::sources::{Empty, empty};"}, {"sha": "d500cc99fa13c2641dabc0e3bfc3d898e4fd194e", "filename": "src/libcore/iter/sources.rs", "status": "modified", "additions": 7, "deletions": 19, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/c5a129e809172462e3f29ab733074630e29b569b/src%2Flibcore%2Fiter%2Fsources.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c5a129e809172462e3f29ab733074630e29b569b/src%2Flibcore%2Fiter%2Fsources.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fiter%2Fsources.rs?ref=c5a129e809172462e3f29ab733074630e29b569b", "patch": "@@ -113,12 +113,12 @@ pub fn repeat<T: Clone>(elt: T) -> Repeat<T> {\n ///\n /// [`repeat_with`]: fn.repeat_with.html\n #[derive(Copy, Clone, Debug)]\n-#[unstable(feature = \"iterator_repeat_with\", issue = \"48169\")]\n+#[stable(feature = \"iterator_repeat_with\", since = \"1.28.0\")]\n pub struct RepeatWith<F> {\n     repeater: F\n }\n \n-#[unstable(feature = \"iterator_repeat_with\", issue = \"48169\")]\n+#[stable(feature = \"iterator_repeat_with\", since = \"1.28.0\")]\n impl<A, F: FnMut() -> A> Iterator for RepeatWith<F> {\n     type Item = A;\n \n@@ -129,13 +129,7 @@ impl<A, F: FnMut() -> A> Iterator for RepeatWith<F> {\n     fn size_hint(&self) -> (usize, Option<usize>) { (usize::MAX, None) }\n }\n \n-#[unstable(feature = \"iterator_repeat_with\", issue = \"48169\")]\n-impl<A, F: FnMut() -> A> DoubleEndedIterator for RepeatWith<F> {\n-    #[inline]\n-    fn next_back(&mut self) -> Option<A> { self.next() }\n-}\n-\n-#[unstable(feature = \"iterator_repeat_with\", issue = \"48169\")]\n+#[stable(feature = \"iterator_repeat_with\", since = \"1.28.0\")]\n impl<A, F: FnMut() -> A> FusedIterator for RepeatWith<F> {}\n \n #[unstable(feature = \"trusted_len\", issue = \"37572\")]\n@@ -158,19 +152,15 @@ unsafe impl<A, F: FnMut() -> A> TrustedLen for RepeatWith<F> {}\n ///\n /// [`repeat`]: fn.repeat.html\n ///\n-/// An iterator produced by `repeat_with()` is a `DoubleEndedIterator`.\n-/// It is important to note that reversing `repeat_with(f)` will produce\n-/// the exact same sequence as the non-reversed iterator. In other words,\n-/// `repeat_with(f).rev().collect::<Vec<_>>()` is equivalent to\n-/// `repeat_with(f).collect::<Vec<_>>()`.\n+/// An iterator produced by `repeat_with()` is not a `DoubleEndedIterator`.\n+/// If you need `repeat_with()` to return a `DoubleEndedIterator`,\n+/// please open a GitHub issue explaining your use case.\n ///\n /// # Examples\n ///\n /// Basic usage:\n ///\n /// ```\n-/// #![feature(iterator_repeat_with)]\n-///\n /// use std::iter;\n ///\n /// // let's assume we have some value of a type that is not `Clone`\n@@ -191,8 +181,6 @@ unsafe impl<A, F: FnMut() -> A> TrustedLen for RepeatWith<F> {}\n /// Using mutation and going finite:\n ///\n /// ```rust\n-/// #![feature(iterator_repeat_with)]\n-///\n /// use std::iter;\n ///\n /// // From the zeroth to the third power of two:\n@@ -209,7 +197,7 @@ unsafe impl<A, F: FnMut() -> A> TrustedLen for RepeatWith<F> {}\n /// assert_eq!(None, pow2.next());\n /// ```\n #[inline]\n-#[unstable(feature = \"iterator_repeat_with\", issue = \"48169\")]\n+#[stable(feature = \"iterator_repeat_with\", since = \"1.28.0\")]\n pub fn repeat_with<A, F: FnMut() -> A>(repeater: F) -> RepeatWith<F> {\n     RepeatWith { repeater }\n }"}, {"sha": "a2ee0033872d3120416970cd9174e64be6ed696d", "filename": "src/libcore/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c5a129e809172462e3f29ab733074630e29b569b/src%2Flibcore%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c5a129e809172462e3f29ab733074630e29b569b/src%2Flibcore%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Flib.rs?ref=c5a129e809172462e3f29ab733074630e29b569b", "patch": "@@ -90,7 +90,6 @@\n #![feature(fundamental)]\n #![feature(intrinsics)]\n #![feature(iterator_flatten)]\n-#![feature(iterator_repeat_with)]\n #![feature(lang_items)]\n #![feature(link_llvm_intrinsics)]\n #![feature(never_type)]"}, {"sha": "9b8d7031f8e7507d7cfacbbc89deef69637a84ec", "filename": "src/libcore/tests/iter.rs", "status": "modified", "additions": 0, "deletions": 12, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/c5a129e809172462e3f29ab733074630e29b569b/src%2Flibcore%2Ftests%2Fiter.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c5a129e809172462e3f29ab733074630e29b569b/src%2Flibcore%2Ftests%2Fiter.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Ftests%2Fiter.rs?ref=c5a129e809172462e3f29ab733074630e29b569b", "patch": "@@ -1722,18 +1722,6 @@ fn test_repeat_with() {\n     assert_eq!(repeat_with(|| NotClone(42)).size_hint(), (usize::MAX, None));\n }\n \n-#[test]\n-fn test_repeat_with_rev() {\n-    let mut curr = 1;\n-    let mut pow2 = repeat_with(|| { let tmp = curr; curr *= 2; tmp })\n-                    .rev().take(4);\n-    assert_eq!(pow2.next(), Some(1));\n-    assert_eq!(pow2.next(), Some(2));\n-    assert_eq!(pow2.next(), Some(4));\n-    assert_eq!(pow2.next(), Some(8));\n-    assert_eq!(pow2.next(), None);\n-}\n-\n #[test]\n fn test_repeat_with_take() {\n     let mut it = repeat_with(|| 42).take(3);"}, {"sha": "11765e3ef56eedeeca9df57c3d7de8a0c6e2ad24", "filename": "src/libcore/tests/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c5a129e809172462e3f29ab733074630e29b569b/src%2Flibcore%2Ftests%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c5a129e809172462e3f29ab733074630e29b569b/src%2Flibcore%2Ftests%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Ftests%2Flib.rs?ref=c5a129e809172462e3f29ab733074630e29b569b", "patch": "@@ -24,7 +24,6 @@\n #![feature(fmt_internals)]\n #![feature(hashmap_internals)]\n #![feature(iterator_flatten)]\n-#![feature(iterator_repeat_with)]\n #![feature(pattern)]\n #![feature(range_is_empty)]\n #![feature(raw)]"}]}