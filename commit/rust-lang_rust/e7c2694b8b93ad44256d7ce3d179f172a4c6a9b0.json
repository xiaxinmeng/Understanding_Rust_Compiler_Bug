{"sha": "e7c2694b8b93ad44256d7ce3d179f172a4c6a9b0", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU3YzI2OTRiOGI5M2FkNDQyNTZkN2NlM2QxNzlmMTcyYTRjNmE5YjA=", "commit": {"author": {"name": "Vytautas Astrauskas", "email": "astrauv@amazon.com", "date": "2020-04-20T20:22:28Z"}, "committer": {"name": "Vytautas Astrauskas", "email": "astrauv@amazon.com", "date": "2020-04-27T21:26:36Z"}, "message": "Make the main thread detached.", "tree": {"sha": "a255c9705747aa3ae52eaa9b0b11d9124c050517", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a255c9705747aa3ae52eaa9b0b11d9124c050517"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e7c2694b8b93ad44256d7ce3d179f172a4c6a9b0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e7c2694b8b93ad44256d7ce3d179f172a4c6a9b0", "html_url": "https://github.com/rust-lang/rust/commit/e7c2694b8b93ad44256d7ce3d179f172a4c6a9b0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e7c2694b8b93ad44256d7ce3d179f172a4c6a9b0/comments", "author": null, "committer": null, "parents": [{"sha": "69eaaadc28e027fd749c2f6e500daa48f8c2aba3", "url": "https://api.github.com/repos/rust-lang/rust/commits/69eaaadc28e027fd749c2f6e500daa48f8c2aba3", "html_url": "https://github.com/rust-lang/rust/commit/69eaaadc28e027fd749c2f6e500daa48f8c2aba3"}], "stats": {"total": 18, "additions": 12, "deletions": 6}, "files": [{"sha": "80c9965aa1d8eb67961308860644b6c9c74b9a24", "filename": "src/thread.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/e7c2694b8b93ad44256d7ce3d179f172a4c6a9b0/src%2Fthread.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e7c2694b8b93ad44256d7ce3d179f172a4c6a9b0/src%2Fthread.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fthread.rs?ref=e7c2694b8b93ad44256d7ce3d179f172a4c6a9b0", "patch": "@@ -177,7 +177,9 @@ impl<'mir, 'tcx> Default for ThreadManager<'mir, 'tcx> {\n     fn default() -> Self {\n         let mut threads = IndexVec::new();\n         // Create the main thread and add it to the list of threads.\n-        threads.push(Default::default());\n+        let mut main_thread = Thread::default();\n+        main_thread.join_status = ThreadJoinStatus::Detached;\n+        threads.push(main_thread);\n         Self {\n             active_thread: ThreadId::new(0),\n             threads: threads,"}, {"sha": "d765a95d8be7a31afac6cb348a4c0c65b1c3d8e2", "filename": "tests/compile-fail/concurrency/libc_pthread_join_self.rs", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/e7c2694b8b93ad44256d7ce3d179f172a4c6a9b0/tests%2Fcompile-fail%2Fconcurrency%2Flibc_pthread_join_self.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e7c2694b8b93ad44256d7ce3d179f172a4c6a9b0/tests%2Fcompile-fail%2Fconcurrency%2Flibc_pthread_join_self.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-fail%2Fconcurrency%2Flibc_pthread_join_self.rs?ref=e7c2694b8b93ad44256d7ce3d179f172a4c6a9b0", "patch": "@@ -6,11 +6,15 @@\n \n extern crate libc;\n \n-use std::ptr;\n+use std::{ptr, thread};\n \n fn main() {\n-    unsafe {\n-        let native: libc::pthread_t = libc::pthread_self();\n-        assert_eq!(libc::pthread_join(native, ptr::null_mut()), 0); //~ ERROR: Undefined Behavior: trying to join itself\n-    }\n+    let handle = thread::spawn(|| {\n+        unsafe {\n+            let native: libc::pthread_t = libc::pthread_self();\n+            assert_eq!(libc::pthread_join(native, ptr::null_mut()), 0); //~ ERROR: Undefined Behavior: trying to join itself\n+        }\n+    });\n+    thread::yield_now();\n+    handle.join().unwrap();\n }"}]}