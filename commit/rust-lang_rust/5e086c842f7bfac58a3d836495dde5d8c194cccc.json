{"sha": "5e086c842f7bfac58a3d836495dde5d8c194cccc", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVlMDg2Yzg0MmY3YmZhYzU4YTNkODM2NDk1ZGRlNWQ4YzE5NGNjY2M=", "commit": {"author": {"name": "Mark Mansi", "email": "markm@cs.wisc.edu", "date": "2020-02-03T19:45:46Z"}, "committer": {"name": "Mark Mansi", "email": "markm@cs.wisc.edu", "date": "2020-02-03T19:45:46Z"}, "message": "some cleanup/fixes", "tree": {"sha": "3298364241c4a1c2ddf56c6d2099e546be7da8ec", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3298364241c4a1c2ddf56c6d2099e546be7da8ec"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5e086c842f7bfac58a3d836495dde5d8c194cccc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5e086c842f7bfac58a3d836495dde5d8c194cccc", "html_url": "https://github.com/rust-lang/rust/commit/5e086c842f7bfac58a3d836495dde5d8c194cccc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5e086c842f7bfac58a3d836495dde5d8c194cccc/comments", "author": {"login": "mark-i-m", "id": 8827840, "node_id": "MDQ6VXNlcjg4Mjc4NDA=", "avatar_url": "https://avatars.githubusercontent.com/u/8827840?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mark-i-m", "html_url": "https://github.com/mark-i-m", "followers_url": "https://api.github.com/users/mark-i-m/followers", "following_url": "https://api.github.com/users/mark-i-m/following{/other_user}", "gists_url": "https://api.github.com/users/mark-i-m/gists{/gist_id}", "starred_url": "https://api.github.com/users/mark-i-m/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mark-i-m/subscriptions", "organizations_url": "https://api.github.com/users/mark-i-m/orgs", "repos_url": "https://api.github.com/users/mark-i-m/repos", "events_url": "https://api.github.com/users/mark-i-m/events{/privacy}", "received_events_url": "https://api.github.com/users/mark-i-m/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mark-i-m", "id": 8827840, "node_id": "MDQ6VXNlcjg4Mjc4NDA=", "avatar_url": "https://avatars.githubusercontent.com/u/8827840?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mark-i-m", "html_url": "https://github.com/mark-i-m", "followers_url": "https://api.github.com/users/mark-i-m/followers", "following_url": "https://api.github.com/users/mark-i-m/following{/other_user}", "gists_url": "https://api.github.com/users/mark-i-m/gists{/gist_id}", "starred_url": "https://api.github.com/users/mark-i-m/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mark-i-m/subscriptions", "organizations_url": "https://api.github.com/users/mark-i-m/orgs", "repos_url": "https://api.github.com/users/mark-i-m/repos", "events_url": "https://api.github.com/users/mark-i-m/events{/privacy}", "received_events_url": "https://api.github.com/users/mark-i-m/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "adc8cd9680228c7d3d389387ce585e13f616ba93", "url": "https://api.github.com/repos/rust-lang/rust/commits/adc8cd9680228c7d3d389387ce585e13f616ba93", "html_url": "https://github.com/rust-lang/rust/commit/adc8cd9680228c7d3d389387ce585e13f616ba93"}], "stats": {"total": 9, "additions": 2, "deletions": 7}, "files": [{"sha": "023f5aa1e284bee6122650bcfde8d157d9cab685", "filename": "src/tools/rustbook/src/main.rs", "status": "modified", "additions": 2, "deletions": 7, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/5e086c842f7bfac58a3d836495dde5d8c194cccc/src%2Ftools%2Frustbook%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e086c842f7bfac58a3d836495dde5d8c194cccc/src%2Ftools%2Frustbook%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Frustbook%2Fsrc%2Fmain.rs?ref=5e086c842f7bfac58a3d836495dde5d8c194cccc", "patch": "@@ -8,9 +8,6 @@ use clap::{App, AppSettings, ArgMatches, SubCommand};\n use mdbook::errors::Result as Result3;\n use mdbook::MDBook;\n \n-#[cfg(feature = \"linkcheck\")]\n-use mdbook::renderer::RenderContext;\n-\n fn main() {\n     let d_message = \"-d, --dest-dir=[dest-dir]\n 'The output directory for your book{n}(Defaults to ./book when omitted)'\";\n@@ -87,14 +84,12 @@ pub fn linkcheck(\n     use mdbook_linkcheck::Reason;\n \n     let book_dir = get_book_dir(args);\n-    let src_dir = get_book_dir(args).join(\"src\");\n+    let src_dir = book_dir.join(\"src\");\n     let book = MDBook::load(&book_dir).unwrap();\n     let linkck_cfg = mdbook_linkcheck::get_config(&book.config)?;\n     let mut files = codespan::Files::new();\n     let target_files = mdbook_linkcheck::load_files_into_memory(&book.book, &mut files);\n-    let render_ctx = RenderContext::new(&book_dir, book.book, book.config, &book_dir);\n-    let cache_file = render_ctx.destination.join(\"cache.json\");\n-    let cache = mdbook_linkcheck::Cache::load(std::fs::File::open(cache_file)?)?;\n+    let cache = mdbook_linkcheck::Cache::default();\n \n     let (links, incomplete) = mdbook_linkcheck::extract_links(target_files, &files);\n "}]}