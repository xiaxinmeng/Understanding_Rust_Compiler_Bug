{"sha": "4f7c257fd8421392cbe4b1502985d9829cbed37e", "node_id": "C_kwDOAAsO6NoAKDRmN2MyNTdmZDg0MjEzOTJjYmU0YjE1MDI5ODVkOTgyOWNiZWQzN2U", "commit": {"author": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2022-12-08T17:31:57Z"}, "committer": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2022-12-13T18:06:13Z"}, "message": "Do not suggest borrowing binding in pattern in let else\n\nFix #104838.", "tree": {"sha": "bfa8ab2bada17b54e13e809894427f92b6b5f3e3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bfa8ab2bada17b54e13e809894427f92b6b5f3e3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4f7c257fd8421392cbe4b1502985d9829cbed37e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4f7c257fd8421392cbe4b1502985d9829cbed37e", "html_url": "https://github.com/rust-lang/rust/commit/4f7c257fd8421392cbe4b1502985d9829cbed37e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4f7c257fd8421392cbe4b1502985d9829cbed37e/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e46416eed689655b9d395cb2fb7089bb7ec8aa9c", "url": "https://api.github.com/repos/rust-lang/rust/commits/e46416eed689655b9d395cb2fb7089bb7ec8aa9c", "html_url": "https://github.com/rust-lang/rust/commit/e46416eed689655b9d395cb2fb7089bb7ec8aa9c"}], "stats": {"total": 29, "additions": 15, "deletions": 14}, "files": [{"sha": "7b19acf70737f66a2451cd75634c54b9de26fb34", "filename": "compiler/rustc_mir_build/src/build/block.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4f7c257fd8421392cbe4b1502985d9829cbed37e/compiler%2Frustc_mir_build%2Fsrc%2Fbuild%2Fblock.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f7c257fd8421392cbe4b1502985d9829cbed37e/compiler%2Frustc_mir_build%2Fsrc%2Fbuild%2Fblock.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_build%2Fsrc%2Fbuild%2Fblock.rs?ref=4f7c257fd8421392cbe4b1502985d9829cbed37e", "patch": "@@ -231,7 +231,7 @@ impl<'a, 'tcx> Builder<'a, 'tcx> {\n                                         remainder_span,\n                                         pattern,\n                                         None,\n-                                        Some((None, initializer_span)),\n+                                        Some((Some(&destination), initializer_span)),\n                                     );\n                                     this.visit_primary_bindings(\n                                         pattern,"}, {"sha": "203e37dc387c1526798c544ae1dec9e3c36b4963", "filename": "src/test/ui/by-move-pattern-binding.stderr", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/4f7c257fd8421392cbe4b1502985d9829cbed37e/src%2Ftest%2Fui%2Fby-move-pattern-binding.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4f7c257fd8421392cbe4b1502985d9829cbed37e/src%2Ftest%2Fui%2Fby-move-pattern-binding.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fby-move-pattern-binding.stderr?ref=4f7c257fd8421392cbe4b1502985d9829cbed37e", "patch": "@@ -32,15 +32,19 @@ LL +     if let E::Bar(identifier) = &s.x {\n    |\n \n error[E0507]: cannot move out of a shared reference\n-  --> $DIR/by-move-pattern-binding.rs:25:17\n+  --> $DIR/by-move-pattern-binding.rs:25:31\n    |\n LL |     let &E::Bar(identifier) = &s.x else {\n-   |                 ^^^^^^^^^^ move occurs because value has type `String`, which does not implement the `Copy` trait\n+   |                 ----------    ^^^^\n+   |                 |\n+   |                 data moved here\n+   |                 move occurs because `identifier` has type `String`, which does not implement the `Copy` trait\n+   |\n+help: consider removing the borrow\n    |\n-help: consider borrowing here\n+LL -     let &E::Bar(identifier) = &s.x else {\n+LL +     let E::Bar(identifier) = &s.x else {\n    |\n-LL |     let &E::Bar(&identifier) = &s.x else {\n-   |                 +\n \n error: aborting due to 3 previous errors\n "}, {"sha": "1de612abbcdc62019b953674db6ab2fccb24e50e", "filename": "src/test/ui/suggestions/dont-suggest-ref/simple.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/4f7c257fd8421392cbe4b1502985d9829cbed37e/src%2Ftest%2Fui%2Fsuggestions%2Fdont-suggest-ref%2Fsimple.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4f7c257fd8421392cbe4b1502985d9829cbed37e/src%2Ftest%2Fui%2Fsuggestions%2Fdont-suggest-ref%2Fsimple.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsuggestions%2Fdont-suggest-ref%2Fsimple.rs?ref=4f7c257fd8421392cbe4b1502985d9829cbed37e", "patch": "@@ -319,7 +319,6 @@ struct Testing {\n fn testing(a: &Testing) {\n     let Some(_s) = a.a else {\n         //~^ ERROR cannot move\n-        //~| HELP consider borrowing\n         return;\n     };\n }"}, {"sha": "400eee833113259593f5a35100aa29beadf814a2", "filename": "src/test/ui/suggestions/dont-suggest-ref/simple.stderr", "status": "modified", "additions": 5, "deletions": 7, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/4f7c257fd8421392cbe4b1502985d9829cbed37e/src%2Ftest%2Fui%2Fsuggestions%2Fdont-suggest-ref%2Fsimple.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4f7c257fd8421392cbe4b1502985d9829cbed37e/src%2Ftest%2Fui%2Fsuggestions%2Fdont-suggest-ref%2Fsimple.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsuggestions%2Fdont-suggest-ref%2Fsimple.stderr?ref=4f7c257fd8421392cbe4b1502985d9829cbed37e", "patch": "@@ -902,15 +902,13 @@ LL |     fn f4((&mut X(_t),): (&mut X,)) { }\n    |                   move occurs because `_t` has type `Y`, which does not implement the `Copy` trait\n \n error[E0507]: cannot move out of `a.a` as enum variant `Some` which is behind a shared reference\n-  --> $DIR/simple.rs:320:14\n+  --> $DIR/simple.rs:320:20\n    |\n LL |     let Some(_s) = a.a else {\n-   |              ^^ move occurs because `a.a.0` has type `String`, which does not implement the `Copy` trait\n-   |\n-help: consider borrowing here\n-   |\n-LL |     let Some(&_s) = a.a else {\n-   |              +\n+   |              --    ^^^\n+   |              |\n+   |              data moved here\n+   |              move occurs because `_s` has type `String`, which does not implement the `Copy` trait\n \n error: aborting due to 61 previous errors\n "}]}