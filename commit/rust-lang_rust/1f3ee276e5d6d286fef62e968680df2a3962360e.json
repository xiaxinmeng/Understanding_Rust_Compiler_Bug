{"sha": "1f3ee276e5d6d286fef62e968680df2a3962360e", "node_id": "C_kwDOAAsO6NoAKDFmM2VlMjc2ZTVkNmQyODZmZWY2MmU5Njg2ODBkZjJhMzk2MjM2MGU", "commit": {"author": {"name": "klensy", "email": "klensy@users.noreply.github.com", "date": "2023-04-01T14:54:52Z"}, "committer": {"name": "klensy", "email": "klensy@users.noreply.github.com", "date": "2023-04-01T14:54:52Z"}, "message": "bootstrap replace atty with is-terminal, dedupe few deps", "tree": {"sha": "2aefba9813d6112084ba1d6f2c9cff3bd2ea0930", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2aefba9813d6112084ba1d6f2c9cff3bd2ea0930"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1f3ee276e5d6d286fef62e968680df2a3962360e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1f3ee276e5d6d286fef62e968680df2a3962360e", "html_url": "https://github.com/rust-lang/rust/commit/1f3ee276e5d6d286fef62e968680df2a3962360e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1f3ee276e5d6d286fef62e968680df2a3962360e/comments", "author": {"login": "klensy", "id": 1782831, "node_id": "MDQ6VXNlcjE3ODI4MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1782831?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klensy", "html_url": "https://github.com/klensy", "followers_url": "https://api.github.com/users/klensy/followers", "following_url": "https://api.github.com/users/klensy/following{/other_user}", "gists_url": "https://api.github.com/users/klensy/gists{/gist_id}", "starred_url": "https://api.github.com/users/klensy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klensy/subscriptions", "organizations_url": "https://api.github.com/users/klensy/orgs", "repos_url": "https://api.github.com/users/klensy/repos", "events_url": "https://api.github.com/users/klensy/events{/privacy}", "received_events_url": "https://api.github.com/users/klensy/received_events", "type": "User", "site_admin": false}, "committer": {"login": "klensy", "id": 1782831, "node_id": "MDQ6VXNlcjE3ODI4MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1782831?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klensy", "html_url": "https://github.com/klensy", "followers_url": "https://api.github.com/users/klensy/followers", "following_url": "https://api.github.com/users/klensy/following{/other_user}", "gists_url": "https://api.github.com/users/klensy/gists{/gist_id}", "starred_url": "https://api.github.com/users/klensy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klensy/subscriptions", "organizations_url": "https://api.github.com/users/klensy/orgs", "repos_url": "https://api.github.com/users/klensy/repos", "events_url": "https://api.github.com/users/klensy/events{/privacy}", "received_events_url": "https://api.github.com/users/klensy/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b9535c0b7d64290b27c4a116262402cd12f77833", "url": "https://api.github.com/repos/rust-lang/rust/commits/b9535c0b7d64290b27c4a116262402cd12f77833", "html_url": "https://github.com/rust-lang/rust/commit/b9535c0b7d64290b27c4a116262402cd12f77833"}], "stats": {"total": 80, "additions": 42, "deletions": 38}, "files": [{"sha": "965dfa5f39867762cecb08ace2c4f23234e73b91", "filename": "src/bootstrap/Cargo.lock", "status": "modified", "additions": 37, "deletions": 35, "changes": 72, "blob_url": "https://github.com/rust-lang/rust/blob/1f3ee276e5d6d286fef62e968680df2a3962360e/src%2Fbootstrap%2FCargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/1f3ee276e5d6d286fef62e968680df2a3962360e/src%2Fbootstrap%2FCargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2FCargo.lock?ref=1f3ee276e5d6d286fef62e968680df2a3962360e", "patch": "@@ -11,17 +11,6 @@ dependencies = [\n  \"memchr\",\n ]\n \n-[[package]]\n-name = \"atty\"\n-version = \"0.2.14\"\n-source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"d9b39be18770d11421cdb1b9947a45dd3f37e93092cbf377614828a319d5fee8\"\n-dependencies = [\n- \"hermit-abi\",\n- \"libc\",\n- \"winapi\",\n-]\n-\n [[package]]\n name = \"autocfg\"\n version = \"1.1.0\"\n@@ -47,7 +36,6 @@ dependencies = [\n name = \"bootstrap\"\n version = \"0.0.0\"\n dependencies = [\n- \"atty\",\n  \"build_helper\",\n  \"cc\",\n  \"cmake\",\n@@ -56,6 +44,7 @@ dependencies = [\n  \"getopts\",\n  \"hex\",\n  \"ignore\",\n+ \"is-terminal\",\n  \"libc\",\n  \"object\",\n  \"once_cell\",\n@@ -212,13 +201,13 @@ checksum = \"e78d4f1cc4ae33bbfc157ed5d5a5ef3bc29227303d595861deb238fcec4e9457\"\n \n [[package]]\n name = \"errno\"\n-version = \"0.2.8\"\n+version = \"0.3.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"f639046355ee4f37944e44f60642c6f3a7efa3cf6b78c78a0d989a8ce6c396a1\"\n+checksum = \"50d6a0976c999d473fe89ad888d5a284e55366d9dc9038b1ba2aa15128c4afa0\"\n dependencies = [\n  \"errno-dragonfly\",\n  \"libc\",\n- \"winapi\",\n+ \"windows-sys\",\n ]\n \n [[package]]\n@@ -233,9 +222,9 @@ dependencies = [\n \n [[package]]\n name = \"fd-lock\"\n-version = \"3.0.8\"\n+version = \"3.0.11\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"bb21c69b9fea5e15dbc1049e4b77145dd0ba1c84019c488102de0dc4ea4b0a27\"\n+checksum = \"9799aefb4a2e4a01cc47610b1dd47c18ab13d991f27bbcaed9296f5a53d5cbad\"\n dependencies = [\n  \"cfg-if\",\n  \"rustix\",\n@@ -301,6 +290,12 @@ dependencies = [\n  \"libc\",\n ]\n \n+[[package]]\n+name = \"hermit-abi\"\n+version = \"0.3.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"fed44880c466736ef9a5c5b5facefb5ed0785676d0c02d612db14e54f0d84286\"\n+\n [[package]]\n name = \"hex\"\n version = \"0.4.3\"\n@@ -327,14 +322,27 @@ dependencies = [\n \n [[package]]\n name = \"io-lifetimes\"\n-version = \"1.0.1\"\n+version = \"1.0.9\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"a7d367024b3f3414d8e01f437f704f41a9f64ab36f9067fa73e526ad4c763c87\"\n+checksum = \"09270fd4fa1111bc614ed2246c7ef56239a3063d5be0d1ec3b589c505d400aeb\"\n dependencies = [\n+ \"hermit-abi 0.3.1\",\n  \"libc\",\n  \"windows-sys\",\n ]\n \n+[[package]]\n+name = \"is-terminal\"\n+version = \"0.4.6\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"256017f749ab3117e93acb91063009e1f1bb56d03965b14c2c8df4eb02c524d8\"\n+dependencies = [\n+ \"hermit-abi 0.3.1\",\n+ \"io-lifetimes\",\n+ \"rustix\",\n+ \"windows-sys\",\n+]\n+\n [[package]]\n name = \"itoa\"\n version = \"1.0.2\"\n@@ -349,15 +357,15 @@ checksum = \"e2abad23fbc42b3700f2f279844dc832adb2b2eb069b2df918f455c4e18cc646\"\n \n [[package]]\n name = \"libc\"\n-version = \"0.2.137\"\n+version = \"0.2.140\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"fc7fcc620a3bff7cdd7a365be3376c97191aeaccc2a603e600951e452615bf89\"\n+checksum = \"99227334921fae1a979cf0bfdfcc6b3e5ce376ef57e16fb6fb3ea2ed6095f80c\"\n \n [[package]]\n name = \"linux-raw-sys\"\n-version = \"0.1.3\"\n+version = \"0.3.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"8f9f08d8963a6c613f4b1a78f4f4a4dbfadf8e6545b2d72861731e4858b8b47f\"\n+checksum = \"d59d8c75012853d2e872fb56bc8a2e53718e2cafe1a4c823143141c6d90c322f\"\n \n [[package]]\n name = \"log\"\n@@ -409,7 +417,7 @@ version = \"1.13.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"19e64526ebdee182341572e50e9ad03965aa510cd94427a4549448f285e957a1\"\n dependencies = [\n- \"hermit-abi\",\n+ \"hermit-abi 0.1.19\",\n  \"libc\",\n ]\n \n@@ -540,9 +548,9 @@ checksum = \"49b3de9ec5dc0a3417da371aab17d729997c15010e7fd24ff707773a33bddb64\"\n \n [[package]]\n name = \"rustix\"\n-version = \"0.36.3\"\n+version = \"0.37.6\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"0b1fbb4dfc4eb1d390c02df47760bb19a84bb80b301ecc947ab5406394d8223e\"\n+checksum = \"d097081ed288dfe45699b72f5b5d648e5f15d64d900c7080273baa20c16a6849\"\n dependencies = [\n  \"bitflags\",\n  \"errno\",\n@@ -753,17 +761,11 @@ dependencies = [\n \n [[package]]\n name = \"windows-sys\"\n-version = \"0.42.0\"\n+version = \"0.45.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"5a3e1820f08b8513f676f7ab6c1f99ff312fb97b553d30ff4dd86f9f15728aa7\"\n+checksum = \"75283be5efb2831d37ea142365f009c02ec203cd29a3ebecbc093d52315b66d0\"\n dependencies = [\n- \"windows_aarch64_gnullvm\",\n- \"windows_aarch64_msvc\",\n- \"windows_i686_gnu\",\n- \"windows_i686_msvc\",\n- \"windows_x86_64_gnu\",\n- \"windows_x86_64_gnullvm\",\n- \"windows_x86_64_msvc\",\n+ \"windows-targets\",\n ]\n \n [[package]]"}, {"sha": "2fbe7aa57aa52854e7ecdbf69b41e66cfbf91b99", "filename": "src/bootstrap/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1f3ee276e5d6d286fef62e968680df2a3962360e/src%2Fbootstrap%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/1f3ee276e5d6d286fef62e968680df2a3962360e/src%2Fbootstrap%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2FCargo.toml?ref=1f3ee276e5d6d286fef62e968680df2a3962360e", "patch": "@@ -30,7 +30,7 @@ path = \"bin/sccache-plus-cl.rs\"\n test = false\n \n [dependencies]\n-atty = \"0.2.14\"\n+is-terminal = \"0.4\"\n build_helper = { path = \"../tools/build_helper\" }\n cmake = \"0.1.38\"\n filetime = \"0.2\""}, {"sha": "b8b6b7b2d4e9af831b25df5e1ab0d678081f2e9b", "filename": "src/bootstrap/config.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/1f3ee276e5d6d286fef62e968680df2a3962360e/src%2Fbootstrap%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1f3ee276e5d6d286fef62e968680df2a3962360e/src%2Fbootstrap%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.rs?ref=1f3ee276e5d6d286fef62e968680df2a3962360e", "patch": "@@ -808,6 +808,8 @@ define_config! {\n \n impl Config {\n     pub fn default_opts() -> Config {\n+        use is_terminal::IsTerminal;\n+\n         let mut config = Config::default();\n         config.llvm_optimize = true;\n         config.ninja_in_file = true;\n@@ -828,8 +830,8 @@ impl Config {\n         config.dist_include_mingw_linker = true;\n         config.dist_compression_profile = \"fast\".into();\n \n-        config.stdout_is_tty = atty::is(atty::Stream::Stdout);\n-        config.stderr_is_tty = atty::is(atty::Stream::Stderr);\n+        config.stdout_is_tty = std::io::stdout().is_terminal();\n+        config.stderr_is_tty = std::io::stderr().is_terminal();\n \n         // set by build.rs\n         config.build = TargetSelection::from_user(&env!(\"BUILD_TRIPLE\"));"}]}