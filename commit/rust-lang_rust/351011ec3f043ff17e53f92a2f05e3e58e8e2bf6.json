{"sha": "351011ec3f043ff17e53f92a2f05e3e58e8e2bf6", "node_id": "C_kwDOAAsO6NoAKDM1MTAxMWVjM2YwNDNmZjE3ZTUzZjkyYTJmMDVlM2U1OGU4ZTJiZjY", "commit": {"author": {"name": "David Tolnay", "email": "dtolnay@gmail.com", "date": "2022-01-20T02:36:29Z"}, "committer": {"name": "David Tolnay", "email": "dtolnay@gmail.com", "date": "2022-01-20T03:02:56Z"}, "message": "Simplify left_total tracking", "tree": {"sha": "231976345bfc10c6914c4fefdece5750585980a4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/231976345bfc10c6914c4fefdece5750585980a4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/351011ec3f043ff17e53f92a2f05e3e58e8e2bf6", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEERijF2Cz/ZdaBZKeK+boUO5X/bYIFAmHo0OAACgkQ+boUO5X/\nbYKXmw//Q/kGcUuNoRI5JWNiVw6I4e5x1uJ2fB6yoVxCjLf1OfjiFbcsSaAG/5H2\nikkILkOhudR7JC+FetK3eH9I85UjI59V5PUfTt3BhsKSCAmyonX0WPiCfAifyLRZ\njkGjkwvi783BoOdf1OqWGnQ4r6bSb522lTecqXZGrQ9inWzK3E/Hgm75RrZeCGO2\ns9pgrylLKP+fLGXDW9eh8KqxeXGnFnxsNx3k8TxuvxizlpJDKQO6Q/InDol85gLL\ngrFELPD0qL07dmxOwUlhw4ANPkdbt9NGoEL4uLNSOARUZBMzhOlB6ZPVQgfYrIDq\npXf4MgotmDVXQo8UpePvmFIpfUZXGc5b+gZk2LCQzc0HyaorB9+n39Mm62UD/Ond\nMykQm1v3EL07n87MdFMs6jyUh9aa6YS/sxAzeOmYOFGxpG2dJ1LmTWiWYIywFU9M\nyrT5Qqp81ywyXBPDauk/oU5fKd3HiOaBeQKQAcFCI/0kwlg5AOZTBoc0ROve7GP2\nyJ4iQzzk+9shePj7ML7BLJ4KIoMrRC14q4nwSS+qGJeP/ydKuGf8Eo7YWBZU867g\neGcEnxB66J10gupKkTZq4Esbdab8XYzIrpfMMY6wamxCKLYLxYdpYgLn9egm45j9\n7Leq5qZnKrhnQFhG8sqbhxfmbYQj1WA9cJLI80gJ6BkLd3r8GUI=\n=CXYQ\n-----END PGP SIGNATURE-----", "payload": "tree 231976345bfc10c6914c4fefdece5750585980a4\nparent d981c5b354c40a6097c83a72173ae8a5569db2e1\nauthor David Tolnay <dtolnay@gmail.com> 1642646189 -0800\ncommitter David Tolnay <dtolnay@gmail.com> 1642647776 -0800\n\nSimplify left_total tracking\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/351011ec3f043ff17e53f92a2f05e3e58e8e2bf6", "html_url": "https://github.com/rust-lang/rust/commit/351011ec3f043ff17e53f92a2f05e3e58e8e2bf6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/351011ec3f043ff17e53f92a2f05e3e58e8e2bf6/comments", "author": {"login": "dtolnay", "id": 1940490, "node_id": "MDQ6VXNlcjE5NDA0OTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1940490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtolnay", "html_url": "https://github.com/dtolnay", "followers_url": "https://api.github.com/users/dtolnay/followers", "following_url": "https://api.github.com/users/dtolnay/following{/other_user}", "gists_url": "https://api.github.com/users/dtolnay/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtolnay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtolnay/subscriptions", "organizations_url": "https://api.github.com/users/dtolnay/orgs", "repos_url": "https://api.github.com/users/dtolnay/repos", "events_url": "https://api.github.com/users/dtolnay/events{/privacy}", "received_events_url": "https://api.github.com/users/dtolnay/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dtolnay", "id": 1940490, "node_id": "MDQ6VXNlcjE5NDA0OTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1940490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtolnay", "html_url": "https://github.com/dtolnay", "followers_url": "https://api.github.com/users/dtolnay/followers", "following_url": "https://api.github.com/users/dtolnay/following{/other_user}", "gists_url": "https://api.github.com/users/dtolnay/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtolnay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtolnay/subscriptions", "organizations_url": "https://api.github.com/users/dtolnay/orgs", "repos_url": "https://api.github.com/users/dtolnay/repos", "events_url": "https://api.github.com/users/dtolnay/events{/privacy}", "received_events_url": "https://api.github.com/users/dtolnay/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d981c5b354c40a6097c83a72173ae8a5569db2e1", "url": "https://api.github.com/repos/rust-lang/rust/commits/d981c5b354c40a6097c83a72173ae8a5569db2e1", "html_url": "https://github.com/rust-lang/rust/commit/d981c5b354c40a6097c83a72173ae8a5569db2e1"}], "stats": {"total": 22, "additions": 6, "deletions": 16}, "files": [{"sha": "583bdc616cb919ca8f95501d4ca8f0387614ba11", "filename": "compiler/rustc_ast_pretty/src/pp.rs", "status": "modified", "additions": 6, "deletions": 16, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/351011ec3f043ff17e53f92a2f05e3e58e8e2bf6/compiler%2Frustc_ast_pretty%2Fsrc%2Fpp.rs", "raw_url": "https://github.com/rust-lang/rust/raw/351011ec3f043ff17e53f92a2f05e3e58e8e2bf6/compiler%2Frustc_ast_pretty%2Fsrc%2Fpp.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_pretty%2Fsrc%2Fpp.rs?ref=351011ec3f043ff17e53f92a2f05e3e58e8e2bf6", "patch": "@@ -321,20 +321,14 @@ impl Printer {\n         while left_size >= 0 {\n             let left = self.buf.pop_first().unwrap().token;\n \n-            let len = match left {\n-                Token::Break(b) => b.blank_space,\n-                Token::String(ref s) => {\n-                    let len = s.len() as isize;\n-                    assert_eq!(len, left_size);\n-                    len\n-                }\n-                _ => 0,\n-            };\n+            match &left {\n+                Token::Break(b) => self.left_total += b.blank_space,\n+                Token::String(s) => self.left_total += s.len() as isize,\n+                _ => {}\n+            }\n \n             self.print(left, left_size);\n \n-            self.left_total += len;\n-\n             if self.buf.is_empty() {\n                 break;\n             }\n@@ -447,11 +441,7 @@ impl Printer {\n             Token::Begin(b) => self.print_begin(*b, l),\n             Token::End => self.print_end(),\n             Token::Break(b) => self.print_break(*b, l),\n-            Token::String(s) => {\n-                let len = s.len() as isize;\n-                assert_eq!(len, l);\n-                self.print_string(s);\n-            }\n+            Token::String(s) => self.print_string(s),\n         }\n         self.last_printed = Some(token);\n     }"}]}