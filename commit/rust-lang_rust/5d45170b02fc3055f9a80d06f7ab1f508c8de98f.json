{"sha": "5d45170b02fc3055f9a80d06f7ab1f508c8de98f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVkNDUxNzBiMDJmYzMwNTVmOWE4MGQwNmY3YWIxZjUwOGM4ZGU5OGY=", "commit": {"author": {"name": "Corey Richardson", "email": "corey@octayn.net", "date": "2013-12-17T17:05:36Z"}, "committer": {"name": "Corey Richardson", "email": "corey@octayn.net", "date": "2013-12-18T20:21:30Z"}, "message": "Add a rustdoc test\n\nThis is just a smoke test which verifies that the expected files are\ngenerated. Also makes the rmake tests have the right deps.", "tree": {"sha": "e54ba4365ebf9fcc4787509b2b1b26d3f15b625b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e54ba4365ebf9fcc4787509b2b1b26d3f15b625b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5d45170b02fc3055f9a80d06f7ab1f508c8de98f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5d45170b02fc3055f9a80d06f7ab1f508c8de98f", "html_url": "https://github.com/rust-lang/rust/commit/5d45170b02fc3055f9a80d06f7ab1f508c8de98f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5d45170b02fc3055f9a80d06f7ab1f508c8de98f/comments", "author": {"login": "emberian", "id": 704250, "node_id": "MDQ6VXNlcjcwNDI1MA==", "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emberian", "html_url": "https://github.com/emberian", "followers_url": "https://api.github.com/users/emberian/followers", "following_url": "https://api.github.com/users/emberian/following{/other_user}", "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}", "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emberian/subscriptions", "organizations_url": "https://api.github.com/users/emberian/orgs", "repos_url": "https://api.github.com/users/emberian/repos", "events_url": "https://api.github.com/users/emberian/events{/privacy}", "received_events_url": "https://api.github.com/users/emberian/received_events", "type": "User", "site_admin": false}, "committer": {"login": "emberian", "id": 704250, "node_id": "MDQ6VXNlcjcwNDI1MA==", "avatar_url": "https://avatars.githubusercontent.com/u/704250?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emberian", "html_url": "https://github.com/emberian", "followers_url": "https://api.github.com/users/emberian/followers", "following_url": "https://api.github.com/users/emberian/following{/other_user}", "gists_url": "https://api.github.com/users/emberian/gists{/gist_id}", "starred_url": "https://api.github.com/users/emberian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emberian/subscriptions", "organizations_url": "https://api.github.com/users/emberian/orgs", "repos_url": "https://api.github.com/users/emberian/repos", "events_url": "https://api.github.com/users/emberian/events{/privacy}", "received_events_url": "https://api.github.com/users/emberian/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c33573440b61acf154a1cee55413d02f9835c9aa", "url": "https://api.github.com/repos/rust-lang/rust/commits/c33573440b61acf154a1cee55413d02f9835c9aa", "html_url": "https://github.com/rust-lang/rust/commit/c33573440b61acf154a1cee55413d02f9835c9aa"}], "stats": {"total": 43, "additions": 41, "deletions": 2}, "files": [{"sha": "b026055ab25b45eebb59b48df3403096de16bf6f", "filename": "mk/tests.mk", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5d45170b02fc3055f9a80d06f7ab1f508c8de98f/mk%2Ftests.mk", "raw_url": "https://github.com/rust-lang/rust/raw/5d45170b02fc3055f9a80d06f7ab1f508c8de98f/mk%2Ftests.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftests.mk?ref=5d45170b02fc3055f9a80d06f7ab1f508c8de98f", "patch": "@@ -920,14 +920,15 @@ $$(call TEST_OK_FILE,$(1),$(2),$(3),rmake): \\\n \n $(3)/test/run-make/%-$(1)-T-$(2)-H-$(3).ok: \\\n \t\t$(S)src/test/run-make/%/Makefile \\\n-\t\t$$(HSREQ$(1)_H_$(3))\n+\t\t$$(CSREQ$(1)_T_$(2)_H_$(3))\n \t@rm -rf $(3)/test/run-make/$$*\n \t@mkdir -p $(3)/test/run-make/$$*\n \t@echo maketest: $$*\n \t$$(Q)$$(CFG_PYTHON) $(S)src/etc/maketest.py $$(dir $$<) \\\n \t    $$(HBIN$(1)_H_$(3))/rustc$$(X_$(3)) \\\n \t    $(3)/test/run-make/$$* \\\n-\t    \"$$(CC_$(3)) $$(CFG_GCCISH_CFLAGS_$(3))\"\n+\t    \"$$(CC_$(3)) $$(CFG_GCCISH_CFLAGS_$(3))\" \\\n+\t    $$(HBIN$(1)_H_$(3))/rustdoc$$(X_$(3))\n \t@touch $$@\n \n endef"}, {"sha": "00d80e1bf4d1d7f0180de54d9d25164fba1d00e1", "filename": "src/etc/maketest.py", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5d45170b02fc3055f9a80d06f7ab1f508c8de98f/src%2Fetc%2Fmaketest.py", "raw_url": "https://github.com/rust-lang/rust/raw/5d45170b02fc3055f9a80d06f7ab1f508c8de98f/src%2Fetc%2Fmaketest.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fetc%2Fmaketest.py?ref=5d45170b02fc3055f9a80d06f7ab1f508c8de98f", "patch": "@@ -7,6 +7,7 @@\n os.putenv('RUSTC', os.path.abspath(sys.argv[2]))\n os.putenv('TMPDIR', os.path.abspath(sys.argv[3]))\n os.putenv('CC', sys.argv[4])\n+os.putenv('RUSTDOC', os.path.abspath(sys.argv[5]))\n \n proc = subprocess.Popen(['make', '-C', sys.argv[1]],\n                         stdout = subprocess.PIPE,"}, {"sha": "0de678e72488b85e29ad2752f2fedc098ea9550c", "filename": "src/test/run-make/rustdoc-smoke/Makefile", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5d45170b02fc3055f9a80d06f7ab1f508c8de98f/src%2Ftest%2Frun-make%2Frustdoc-smoke%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/5d45170b02fc3055f9a80d06f7ab1f508c8de98f/src%2Ftest%2Frun-make%2Frustdoc-smoke%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Frustdoc-smoke%2FMakefile?ref=5d45170b02fc3055f9a80d06f7ab1f508c8de98f", "patch": "@@ -0,0 +1,5 @@\n+-include ../tools.mk\n+all:\n+\t$(RUSTDOC) -w html -o $(TMPDIR)/doc foo.rs\n+\tcp verify.sh $(TMPDIR)\n+\t$(call RUN,verify.sh) $(TMPDIR)"}, {"sha": "7a86bf4d1e86f479db62dc83b5acc2916724b06c", "filename": "src/test/run-make/rustdoc-smoke/foo.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/5d45170b02fc3055f9a80d06f7ab1f508c8de98f/src%2Ftest%2Frun-make%2Frustdoc-smoke%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5d45170b02fc3055f9a80d06f7ab1f508c8de98f/src%2Ftest%2Frun-make%2Frustdoc-smoke%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Frustdoc-smoke%2Ffoo.rs?ref=5d45170b02fc3055f9a80d06f7ab1f508c8de98f", "patch": "@@ -0,0 +1,15 @@\n+#[pkgid = \"foo#0.1\"];\n+\n+//! Very docs\n+\n+pub mod bar {\n+\n+    /// So correct\n+    pub mod baz {\n+        /// Much detail\n+        pub fn baz() { }\n+    }\n+\n+    /// *wow*\n+    pub trait Doge { }\n+}"}, {"sha": "18f3939794e47d5ed1b2a6f00d5248510e4fb71e", "filename": "src/test/run-make/rustdoc-smoke/verify.sh", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/5d45170b02fc3055f9a80d06f7ab1f508c8de98f/src%2Ftest%2Frun-make%2Frustdoc-smoke%2Fverify.sh", "raw_url": "https://github.com/rust-lang/rust/raw/5d45170b02fc3055f9a80d06f7ab1f508c8de98f/src%2Ftest%2Frun-make%2Frustdoc-smoke%2Fverify.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Frustdoc-smoke%2Fverify.sh?ref=5d45170b02fc3055f9a80d06f7ab1f508c8de98f", "patch": "@@ -0,0 +1,17 @@\n+#!/bin/sh\n+\n+# $1 is the TMPDIR\n+\n+dirs=\"doc doc/foo doc/foo/bar doc/foo/bar/baz doc/src doc/src/foo\"\n+\n+for dir in $dirs; do if [ ! -d $1/$dir ]; then\n+\techo \"$1/$dir is not a directory!\"\n+\texit 1\n+fi done\n+\n+files=\"doc/foo/index.html doc/foo/bar/index.html doc/foo/bar/baz/fn.baz.html doc/foo/bar/trait.Doge.html doc/src/foo/foo.rs.html\"\n+\n+for file in $files; do if [ ! -f $1/$file ]; then\n+\techo \"$1/$file is not a file!\"\n+\texit 1\n+fi done"}]}