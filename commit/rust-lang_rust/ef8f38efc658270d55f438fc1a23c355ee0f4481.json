{"sha": "ef8f38efc658270d55f438fc1a23c355ee0f4481", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVmOGYzOGVmYzY1ODI3MGQ1NWY0MzhmYzFhMjNjMzU1ZWUwZjQ0ODE=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2021-02-09T15:21:09Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2021-02-09T15:21:09Z"}, "message": "More precise navigation to parent", "tree": {"sha": "00b4f3105d87956f26080239868a256fcf818a80", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/00b4f3105d87956f26080239868a256fcf818a80"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ef8f38efc658270d55f438fc1a23c355ee0f4481", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ef8f38efc658270d55f438fc1a23c355ee0f4481", "html_url": "https://github.com/rust-lang/rust/commit/ef8f38efc658270d55f438fc1a23c355ee0f4481", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ef8f38efc658270d55f438fc1a23c355ee0f4481/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2ac20b05f18895654ced1d243e99092441a94f86", "url": "https://api.github.com/repos/rust-lang/rust/commits/2ac20b05f18895654ced1d243e99092441a94f86", "html_url": "https://github.com/rust-lang/rust/commit/2ac20b05f18895654ced1d243e99092441a94f86"}], "stats": {"total": 23, "additions": 13, "deletions": 10}, "files": [{"sha": "1982434663ed84975e79a2591da0d2e6c1099d87", "filename": "crates/ide/src/display/navigation_target.rs", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/ef8f38efc658270d55f438fc1a23c355ee0f4481/crates%2Fide%2Fsrc%2Fdisplay%2Fnavigation_target.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ef8f38efc658270d55f438fc1a23c355ee0f4481/crates%2Fide%2Fsrc%2Fdisplay%2Fnavigation_target.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fdisplay%2Fnavigation_target.rs?ref=ef8f38efc658270d55f438fc1a23c355ee0f4481", "patch": "@@ -85,12 +85,16 @@ impl NavigationTarget {\n         let name = module.name(db).map(|it| it.to_string().into()).unwrap_or_default();\n         if let Some(src) = module.declaration_source(db) {\n             let node = src.as_ref().map(|it| it.syntax());\n-            let frange = node.original_file_range(db);\n+            let full_range = node.original_file_range(db);\n+            let focus_range = src\n+                .value\n+                .name()\n+                .map(|name| src.with_value(name.syntax()).original_file_range(db).range);\n             let mut res = NavigationTarget::from_syntax(\n-                frange.file_id,\n+                full_range.file_id,\n                 name,\n-                None,\n-                frange.range,\n+                focus_range,\n+                full_range.range,\n                 SymbolKind::Module,\n             );\n             res.docs = module.attrs(db).docs();"}, {"sha": "e86ae2a18856e2624acd98901d2f715e0683a7ae", "filename": "crates/ide/src/goto_definition.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/ef8f38efc658270d55f438fc1a23c355ee0f4481/crates%2Fide%2Fsrc%2Fgoto_definition.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ef8f38efc658270d55f438fc1a23c355ee0f4481/crates%2Fide%2Fsrc%2Fgoto_definition.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fgoto_definition.rs?ref=ef8f38efc658270d55f438fc1a23c355ee0f4481", "patch": "@@ -131,7 +131,6 @@ pub(crate) fn reference_definition(\n #[cfg(test)]\n mod tests {\n     use ide_db::base_db::FileRange;\n-    use syntax::{TextRange, TextSize};\n \n     use crate::fixture;\n "}, {"sha": "7b08bc27bfb67677793d438c12a95a8a5a819b87", "filename": "crates/ide/src/parent_module.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/ef8f38efc658270d55f438fc1a23c355ee0f4481/crates%2Fide%2Fsrc%2Fparent_module.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ef8f38efc658270d55f438fc1a23c355ee0f4481/crates%2Fide%2Fsrc%2Fparent_module.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fparent_module.rs?ref=ef8f38efc658270d55f438fc1a23c355ee0f4481", "patch": "@@ -81,8 +81,8 @@ mod tests {\n         check(\n             r#\"\n //- /lib.rs\n-  mod foo;\n-//^^^^^^^^\n+mod foo;\n+  //^^^\n \n //- /foo.rs\n $0// empty\n@@ -96,8 +96,8 @@ $0// empty\n         check(\n             r#\"\n //- /lib.rs\n-  mod foo;\n-//^^^^^^^^\n+mod foo;\n+  //^^^\n //- /foo.rs\n mod $0bar;\n \n@@ -115,7 +115,7 @@ mod $0bar;\n mod foo {\n     mod bar {\n         mod baz { $0 }\n-    } //^^^^^^^^^^^^\n+    }     //^^^\n }\n \"#,\n         );"}]}