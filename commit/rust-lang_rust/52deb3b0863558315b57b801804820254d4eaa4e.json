{"sha": "52deb3b0863558315b57b801804820254d4eaa4e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUyZGViM2IwODYzNTU4MzE1YjU3YjgwMTgwNDgyMDI1NGQ0ZWFhNGU=", "commit": {"author": {"name": "Mateusz Miku\u0142a", "email": "mati865@gmail.com", "date": "2018-06-07T17:16:41Z"}, "committer": {"name": "Mateusz Miku\u0142a", "email": "mati865@gmail.com", "date": "2018-06-07T17:16:41Z"}, "message": "Prepare for upcoming breakage", "tree": {"sha": "5aa0091ab350eab6700f0364da0fca1bcabcf27f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5aa0091ab350eab6700f0364da0fca1bcabcf27f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/52deb3b0863558315b57b801804820254d4eaa4e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/52deb3b0863558315b57b801804820254d4eaa4e", "html_url": "https://github.com/rust-lang/rust/commit/52deb3b0863558315b57b801804820254d4eaa4e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/52deb3b0863558315b57b801804820254d4eaa4e/comments", "author": {"login": "mati865", "id": 1174646, "node_id": "MDQ6VXNlcjExNzQ2NDY=", "avatar_url": "https://avatars.githubusercontent.com/u/1174646?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mati865", "html_url": "https://github.com/mati865", "followers_url": "https://api.github.com/users/mati865/followers", "following_url": "https://api.github.com/users/mati865/following{/other_user}", "gists_url": "https://api.github.com/users/mati865/gists{/gist_id}", "starred_url": "https://api.github.com/users/mati865/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mati865/subscriptions", "organizations_url": "https://api.github.com/users/mati865/orgs", "repos_url": "https://api.github.com/users/mati865/repos", "events_url": "https://api.github.com/users/mati865/events{/privacy}", "received_events_url": "https://api.github.com/users/mati865/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mati865", "id": 1174646, "node_id": "MDQ6VXNlcjExNzQ2NDY=", "avatar_url": "https://avatars.githubusercontent.com/u/1174646?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mati865", "html_url": "https://github.com/mati865", "followers_url": "https://api.github.com/users/mati865/followers", "following_url": "https://api.github.com/users/mati865/following{/other_user}", "gists_url": "https://api.github.com/users/mati865/gists{/gist_id}", "starred_url": "https://api.github.com/users/mati865/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mati865/subscriptions", "organizations_url": "https://api.github.com/users/mati865/orgs", "repos_url": "https://api.github.com/users/mati865/repos", "events_url": "https://api.github.com/users/mati865/events{/privacy}", "received_events_url": "https://api.github.com/users/mati865/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2a2e602f2a6ebb1984817e802bb529415f35a574", "url": "https://api.github.com/repos/rust-lang/rust/commits/2a2e602f2a6ebb1984817e802bb529415f35a574", "html_url": "https://github.com/rust-lang/rust/commit/2a2e602f2a6ebb1984817e802bb529415f35a574"}], "stats": {"total": 12, "additions": 6, "deletions": 6}, "files": [{"sha": "217bcca45de77ea31d0bfc9bd8ca5557d05e6666", "filename": "src/driver.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/52deb3b0863558315b57b801804820254d4eaa4e/src%2Fdriver.rs", "raw_url": "https://github.com/rust-lang/rust/raw/52deb3b0863558315b57b801804820254d4eaa4e/src%2Fdriver.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdriver.rs?ref=52deb3b0863558315b57b801804820254d4eaa4e", "patch": "@@ -21,14 +21,14 @@ use std::process::Command;\n use syntax::ast;\n \n struct ClippyCompilerCalls {\n-    default: RustcDefaultCalls,\n+    default: Box<RustcDefaultCalls>,\n     run_lints: bool,\n }\n \n impl ClippyCompilerCalls {\n     fn new(run_lints: bool) -> Self {\n         Self {\n-            default: RustcDefaultCalls,\n+            default: Box::new(RustcDefaultCalls),\n             run_lints,\n         }\n     }\n@@ -69,8 +69,8 @@ impl<'a> CompilerCalls<'a> for ClippyCompilerCalls {\n         self.default\n             .late_callback(trans_crate, matches, sess, crate_stores, input, odir, ofile)\n     }\n-    fn build_controller(&mut self, sess: &Session, matches: &getopts::Matches) -> driver::CompileController<'a> {\n-        let mut control = self.default.build_controller(sess, matches);\n+    fn build_controller(self: Box<Self>, sess: &Session, matches: &getopts::Matches) -> driver::CompileController<'a> {\n+        let mut control = self.default.clone().build_controller(sess, matches);\n \n         if self.run_lints {\n             let old = std::mem::replace(&mut control.after_parse.callback, box |_| {});\n@@ -198,6 +198,6 @@ pub fn main() {\n         }\n     }\n \n-    let mut ccc = ClippyCompilerCalls::new(clippy_enabled);\n-    rustc_driver::run(move || rustc_driver::run_compiler(&args, &mut ccc, None, None));\n+    let ccc = ClippyCompilerCalls::new(clippy_enabled);\n+    rustc_driver::run(move || rustc_driver::run_compiler(&args, Box::new(ccc), None, None));\n }"}]}