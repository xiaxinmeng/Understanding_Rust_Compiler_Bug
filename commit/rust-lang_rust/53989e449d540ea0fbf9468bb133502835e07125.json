{"sha": "53989e449d540ea0fbf9468bb133502835e07125", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUzOTg5ZTQ0OWQ1NDBlYTBmYmY5NDY4YmIxMzM1MDI4MzVlMDcxMjU=", "commit": {"author": {"name": "Joshua Nelson", "email": "jyn514@gmail.com", "date": "2021-01-16T03:41:39Z"}, "committer": {"name": "Mark Rousskov", "email": "mark.simulacrum@gmail.com", "date": "2021-01-16T15:07:09Z"}, "message": "Allow configuring the default stage for `x.py check`", "tree": {"sha": "22d6eac6038303df5e1a9ccc8f6831a728a11fe2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/22d6eac6038303df5e1a9ccc8f6831a728a11fe2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/53989e449d540ea0fbf9468bb133502835e07125", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/53989e449d540ea0fbf9468bb133502835e07125", "html_url": "https://github.com/rust-lang/rust/commit/53989e449d540ea0fbf9468bb133502835e07125", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/53989e449d540ea0fbf9468bb133502835e07125/comments", "author": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c17ed34da1b3298ec428aa9655fd5a0e18ecbaf8", "url": "https://api.github.com/repos/rust-lang/rust/commits/c17ed34da1b3298ec428aa9655fd5a0e18ecbaf8", "html_url": "https://github.com/rust-lang/rust/commit/c17ed34da1b3298ec428aa9655fd5a0e18ecbaf8"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "8072df795cac3802ab7fcf1c6fe6b75e0cfa48f7", "filename": "src/bootstrap/config.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/53989e449d540ea0fbf9468bb133502835e07125/src%2Fbootstrap%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/53989e449d540ea0fbf9468bb133502835e07125/src%2Fbootstrap%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.rs?ref=53989e449d540ea0fbf9468bb133502835e07125", "patch": "@@ -377,6 +377,7 @@ struct Build {\n     configure_args: Option<Vec<String>>,\n     local_rebuild: Option<bool>,\n     print_step_timings: Option<bool>,\n+    check_stage: Option<u32>,\n     doc_stage: Option<u32>,\n     build_stage: Option<u32>,\n     test_stage: Option<u32>,\n@@ -676,6 +677,7 @@ impl Config {\n \n         // See https://github.com/rust-lang/compiler-team/issues/326\n         config.stage = match config.cmd {\n+            Subcommand::Check { .. } => flags.stage.or(build.check_stage).unwrap_or(0),\n             Subcommand::Doc { .. } => flags.stage.or(build.doc_stage).unwrap_or(0),\n             Subcommand::Build { .. } => flags.stage.or(build.build_stage).unwrap_or(1),\n             Subcommand::Test { .. } => flags.stage.or(build.test_stage).unwrap_or(1),\n@@ -685,7 +687,6 @@ impl Config {\n             // These are all bootstrap tools, which don't depend on the compiler.\n             // The stage we pass shouldn't matter, but use 0 just in case.\n             Subcommand::Clean { .. }\n-            | Subcommand::Check { .. }\n             | Subcommand::Clippy { .. }\n             | Subcommand::Fix { .. }\n             | Subcommand::Run { .. }"}]}