{"sha": "a2a810f118bb2ec541f852bf02eebdf02c7326f7", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEyYTgxMGYxMThiYjJlYzU0MWY4NTJiZjAyZWViZGYwMmM3MzI2Zjc=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-07-30T09:44:14Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-07-30T09:44:14Z"}, "message": "Add parent links", "tree": {"sha": "1b48a5b2f10e0f4a706e496eabd27e8490c332be", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1b48a5b2f10e0f4a706e496eabd27e8490c332be"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a2a810f118bb2ec541f852bf02eebdf02c7326f7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a2a810f118bb2ec541f852bf02eebdf02c7326f7", "html_url": "https://github.com/rust-lang/rust/commit/a2a810f118bb2ec541f852bf02eebdf02c7326f7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a2a810f118bb2ec541f852bf02eebdf02c7326f7/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "423298dddd50d28ce891b10695417401226235a3", "url": "https://api.github.com/repos/rust-lang/rust/commits/423298dddd50d28ce891b10695417401226235a3", "html_url": "https://github.com/rust-lang/rust/commit/423298dddd50d28ce891b10695417401226235a3"}], "stats": {"total": 18, "additions": 15, "deletions": 3}, "files": [{"sha": "e0fa27e5f7bf1f64fd3da32a56a5156bb5e00a4c", "filename": "src/yellow/red.rs", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/a2a810f118bb2ec541f852bf02eebdf02c7326f7/src%2Fyellow%2Fred.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a2a810f118bb2ec541f852bf02eebdf02c7326f7/src%2Fyellow%2Fred.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fyellow%2Fred.rs?ref=a2a810f118bb2ec541f852bf02eebdf02c7326f7", "patch": "@@ -16,7 +16,7 @@ pub(crate) struct RedNode {\n \n #[derive(Debug)]\n struct ParentData {\n-    parent: *const RedNode,\n+    parent: ptr::NonNull<RedNode>,\n     start_offset: TextUnit,\n     index_in_parent: usize,\n }\n@@ -30,7 +30,7 @@ impl RedNode {\n \n     fn new_child(\n         green: GreenNode,\n-        parent: *const RedNode,\n+        parent: ptr::NonNull<RedNode>,\n         start_offset: TextUnit,\n         index_in_parent: usize,\n     ) -> RedNode {\n@@ -76,10 +76,14 @@ impl RedNode {\n             let green_children = self.green.children();\n             let start_offset = self.start_offset()\n                 + green_children[..idx].iter().map(|x| x.text_len()).sum::<TextUnit>();\n-            let child = RedNode::new_child(green_children[idx].clone(), self, start_offset, idx);\n+            let child = RedNode::new_child(green_children[idx].clone(), self.into(), start_offset, idx);\n             children[idx] = Some(Box::new(child))\n         }\n         let child = children[idx].as_ref().unwrap();\n         ptr::NonNull::from(&**child)\n     }\n+\n+    pub(crate) fn parent(&self) -> Option<ptr::NonNull<RedNode>> {\n+        Some(self.parent.as_ref()?.parent)\n+    }\n }"}, {"sha": "ae3302ed90ea467635ef5b58bf4257156ba64c29", "filename": "src/yellow/syntax.rs", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/a2a810f118bb2ec541f852bf02eebdf02c7326f7/src%2Fyellow%2Fsyntax.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a2a810f118bb2ec541f852bf02eebdf02c7326f7/src%2Fyellow%2Fsyntax.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fyellow%2Fsyntax.rs?ref=a2a810f118bb2ec541f852bf02eebdf02c7326f7", "patch": "@@ -90,6 +90,14 @@ impl<ROOT: TreeRoot> SyntaxNode<ROOT> {\n         res\n     }\n \n+    pub fn parent(&self) -> Option<SyntaxNode<ROOT>> {\n+        let parent = self.red().parent()?;\n+        Some(SyntaxNode {\n+            root: self.root.clone(),\n+            red: parent,\n+        })\n+    }\n+\n     fn red(&self) -> &RedNode {\n         unsafe { self.red.as_ref() }\n     }"}]}