{"sha": "a0b7bad00e5134e26fea08d2e4691360c61e68f0", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEwYjdiYWQwMGU1MTM0ZTI2ZmVhMDhkMmU0NjkxMzYwYzYxZTY4ZjA=", "commit": {"author": {"name": "James Miller", "email": "james@aatch.net", "date": "2015-02-19T14:33:53Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2015-02-22T11:01:59Z"}, "message": "remove the `exit_map` field, it is unnecessary.\n\n(Factoring of aatch CFG code, Part 2.)", "tree": {"sha": "92e3d11805d5cda87901a99cd676baec113aba86", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/92e3d11805d5cda87901a99cd676baec113aba86"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a0b7bad00e5134e26fea08d2e4691360c61e68f0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a0b7bad00e5134e26fea08d2e4691360c61e68f0", "html_url": "https://github.com/rust-lang/rust/commit/a0b7bad00e5134e26fea08d2e4691360c61e68f0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a0b7bad00e5134e26fea08d2e4691360c61e68f0/comments", "author": {"login": "Aatch", "id": 342416, "node_id": "MDQ6VXNlcjM0MjQxNg==", "avatar_url": "https://avatars.githubusercontent.com/u/342416?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aatch", "html_url": "https://github.com/Aatch", "followers_url": "https://api.github.com/users/Aatch/followers", "following_url": "https://api.github.com/users/Aatch/following{/other_user}", "gists_url": "https://api.github.com/users/Aatch/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aatch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aatch/subscriptions", "organizations_url": "https://api.github.com/users/Aatch/orgs", "repos_url": "https://api.github.com/users/Aatch/repos", "events_url": "https://api.github.com/users/Aatch/events{/privacy}", "received_events_url": "https://api.github.com/users/Aatch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "97c1711894ec3d8dfabe04f8e7218e86496b1ff9", "url": "https://api.github.com/repos/rust-lang/rust/commits/97c1711894ec3d8dfabe04f8e7218e86496b1ff9", "html_url": "https://github.com/rust-lang/rust/commit/97c1711894ec3d8dfabe04f8e7218e86496b1ff9"}], "stats": {"total": 15, "additions": 2, "deletions": 13}, "files": [{"sha": "4b06eecaffecf416640a7d8235cb1cadde6cc57f", "filename": "src/librustc/middle/cfg/construct.rs", "status": "modified", "additions": 2, "deletions": 11, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/a0b7bad00e5134e26fea08d2e4691360c61e68f0/src%2Flibrustc%2Fmiddle%2Fcfg%2Fconstruct.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a0b7bad00e5134e26fea08d2e4691360c61e68f0/src%2Flibrustc%2Fmiddle%2Fcfg%2Fconstruct.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fcfg%2Fconstruct.rs?ref=a0b7bad00e5134e26fea08d2e4691360c61e68f0", "patch": "@@ -16,11 +16,9 @@ use middle::ty;\n use syntax::ast;\n use syntax::ast_util;\n use syntax::ptr::P;\n-use util::nodemap::NodeMap;\n \n struct CFGBuilder<'a, 'tcx: 'a> {\n     tcx: &'a ty::ctxt<'tcx>,\n-    exit_map: NodeMap<CFGIndex>,\n     graph: CFGGraph,\n     fn_exit: CFGIndex,\n     loop_scopes: Vec<LoopScope>,\n@@ -46,17 +44,15 @@ pub fn construct(tcx: &ty::ctxt,\n     let block_exit;\n \n     let mut cfg_builder = CFGBuilder {\n-        exit_map: NodeMap(),\n         graph: graph,\n         fn_exit: fn_exit,\n         tcx: tcx,\n         loop_scopes: Vec::new()\n     };\n     block_exit = cfg_builder.block(blk, entry);\n     cfg_builder.add_contained_edge(block_exit, fn_exit);\n-    let CFGBuilder {exit_map, graph, ..} = cfg_builder;\n-    CFG {exit_map: exit_map,\n-         graph: graph,\n+    let CFGBuilder {graph, ..} = cfg_builder;\n+    CFG {graph: graph,\n          entry: entry,\n          exit: fn_exit}\n }\n@@ -512,7 +508,6 @@ impl<'a, 'tcx> CFGBuilder<'a, 'tcx> {\n     }\n \n     fn add_ast_node(&mut self, id: ast::NodeId, preds: &[CFGIndex]) -> CFGIndex {\n-        assert!(!self.exit_map.contains_key(&id));\n         assert!(id != ast::DUMMY_NODE_ID);\n         self.add_node(CFGNodeData::AST(id), preds)\n     }\n@@ -523,10 +518,6 @@ impl<'a, 'tcx> CFGBuilder<'a, 'tcx> {\n \n     fn add_node(&mut self, data: CFGNodeData, preds: &[CFGIndex]) -> CFGIndex {\n         let node = self.graph.add_node(data);\n-        if let CFGNodeData::AST(id) = data {\n-            assert!(!self.exit_map.contains_key(&id));\n-            self.exit_map.insert(id, node);\n-        }\n         for &pred in preds {\n             self.add_contained_edge(pred, node);\n         }"}, {"sha": "e8a99f59b1e95b365c9c0e4184757608978b8638", "filename": "src/librustc/middle/cfg/mod.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a0b7bad00e5134e26fea08d2e4691360c61e68f0/src%2Flibrustc%2Fmiddle%2Fcfg%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a0b7bad00e5134e26fea08d2e4691360c61e68f0/src%2Flibrustc%2Fmiddle%2Fcfg%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fcfg%2Fmod.rs?ref=a0b7bad00e5134e26fea08d2e4691360c61e68f0", "patch": "@@ -14,13 +14,11 @@\n use middle::graph;\n use middle::ty;\n use syntax::ast;\n-use util::nodemap::NodeMap;\n \n mod construct;\n pub mod graphviz;\n \n pub struct CFG {\n-    pub exit_map: NodeMap<CFGIndex>,\n     pub graph: CFGGraph,\n     pub entry: CFGIndex,\n     pub exit: CFGIndex,"}]}