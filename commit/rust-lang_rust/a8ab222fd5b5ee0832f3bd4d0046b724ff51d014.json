{"sha": "a8ab222fd5b5ee0832f3bd4d0046b724ff51d014", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE4YWIyMjJmZDViNWVlMDgzMmYzYmQ0ZDAwNDZiNzI0ZmY1MWQwMTQ=", "commit": {"author": {"name": "Eduard-Mihai Burtescu", "email": "edy.burt@gmail.com", "date": "2017-02-25T12:13:20Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2017-02-25T12:13:20Z"}, "message": "Rollup merge of #39914 - raphlinus:mx_handle_wait, r=alexcrichton\n\nFollow rename of mx_handle_wait Magenta syscalls\n\nThe mx_handle_wait_* syscalls in Magenta were renamed to\nmx_object_wait. The syscall is used in the Magenta/Fuchsia\nimplementation of std::process, to wait on child processes.\n\nIn addition, this patch enables the use of the system provided\nlibbacktrace library on Fuchsia targets. Symbolization is not yet\nworking, but at least it allows printing hex addresses in a backtrace\nand makes building succeed when the backtrace feature is not disabled.", "tree": {"sha": "b1d8d2c97bc2a28996eec139d2992cacd7b0d742", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b1d8d2c97bc2a28996eec139d2992cacd7b0d742"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a8ab222fd5b5ee0832f3bd4d0046b724ff51d014", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a8ab222fd5b5ee0832f3bd4d0046b724ff51d014", "html_url": "https://github.com/rust-lang/rust/commit/a8ab222fd5b5ee0832f3bd4d0046b724ff51d014", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a8ab222fd5b5ee0832f3bd4d0046b724ff51d014/comments", "author": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "aa7eb6512315ae3340969a53c9161e91361d074c", "url": "https://api.github.com/repos/rust-lang/rust/commits/aa7eb6512315ae3340969a53c9161e91361d074c", "html_url": "https://github.com/rust-lang/rust/commit/aa7eb6512315ae3340969a53c9161e91361d074c"}, {"sha": "609133098bfbeae69fb9c65ca5438c411d27dfd6", "url": "https://api.github.com/repos/rust-lang/rust/commits/609133098bfbeae69fb9c65ca5438c411d27dfd6", "html_url": "https://github.com/rust-lang/rust/commit/609133098bfbeae69fb9c65ca5438c411d27dfd6"}], "stats": {"total": 10, "additions": 7, "deletions": 3}, "files": [{"sha": "038dea77f3ead8d570483a299e02a99059ece819", "filename": "src/libstd/build.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a8ab222fd5b5ee0832f3bd4d0046b724ff51d014/src%2Flibstd%2Fbuild.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8ab222fd5b5ee0832f3bd4d0046b724ff51d014/src%2Flibstd%2Fbuild.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fbuild.rs?ref=a8ab222fd5b5ee0832f3bd4d0046b724ff51d014", "patch": "@@ -59,6 +59,10 @@ fn main() {\n         println!(\"cargo:rustc-link-lib=userenv\");\n         println!(\"cargo:rustc-link-lib=shell32\");\n     } else if target.contains(\"fuchsia\") {\n+        // use system-provided libbacktrace\n+        if cfg!(feature = \"backtrace\") {\n+            println!(\"cargo:rustc-link-lib=backtrace\");\n+        }\n         println!(\"cargo:rustc-link-lib=magenta\");\n         println!(\"cargo:rustc-link-lib=mxio\");\n         println!(\"cargo:rustc-link-lib=launchpad\"); // for std::process"}, {"sha": "08a827ce08142ee9ad208a7da71d25d39a07dc50", "filename": "src/libstd/sys/unix/process/magenta.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a8ab222fd5b5ee0832f3bd4d0046b724ff51d014/src%2Flibstd%2Fsys%2Funix%2Fprocess%2Fmagenta.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8ab222fd5b5ee0832f3bd4d0046b724ff51d014/src%2Flibstd%2Fsys%2Funix%2Fprocess%2Fmagenta.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Funix%2Fprocess%2Fmagenta.rs?ref=a8ab222fd5b5ee0832f3bd4d0046b724ff51d014", "patch": "@@ -111,7 +111,7 @@ extern {\n     pub fn mx_handle_duplicate(handle: mx_handle_t, rights: mx_rights_t,\n                                out: *const mx_handle_t) -> mx_handle_t;\n \n-    pub fn mx_handle_wait_one(handle: mx_handle_t, signals: mx_signals_t, timeout: mx_time_t,\n+    pub fn mx_object_wait_one(handle: mx_handle_t, signals: mx_signals_t, timeout: mx_time_t,\n                               pending: *mut mx_signals_t) -> mx_status_t;\n \n     pub fn mx_object_get_info(handle: mx_handle_t, topic: u32, buffer: *mut c_void,"}, {"sha": "608e44ca9e86e1641ac957b2c36a7ebf46bfb5ff", "filename": "src/libstd/sys/unix/process/process_fuchsia.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a8ab222fd5b5ee0832f3bd4d0046b724ff51d014/src%2Flibstd%2Fsys%2Funix%2Fprocess%2Fprocess_fuchsia.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8ab222fd5b5ee0832f3bd4d0046b724ff51d014/src%2Flibstd%2Fsys%2Funix%2Fprocess%2Fprocess_fuchsia.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Funix%2Fprocess%2Fprocess_fuchsia.rs?ref=a8ab222fd5b5ee0832f3bd4d0046b724ff51d014", "patch": "@@ -151,7 +151,7 @@ impl Process {\n         let mut avail: mx_size_t = 0;\n \n         unsafe {\n-            mx_cvt(mx_handle_wait_one(self.handle.raw(), MX_TASK_TERMINATED,\n+            mx_cvt(mx_object_wait_one(self.handle.raw(), MX_TASK_TERMINATED,\n                                       MX_TIME_INFINITE, ptr::null_mut()))?;\n             mx_cvt(mx_object_get_info(self.handle.raw(), MX_INFO_PROCESS,\n                                       &mut proc_info as *mut _ as *mut libc::c_void,\n@@ -174,7 +174,7 @@ impl Process {\n         let mut avail: mx_size_t = 0;\n \n         unsafe {\n-            let status = mx_handle_wait_one(self.handle.raw(), MX_TASK_TERMINATED,\n+            let status = mx_object_wait_one(self.handle.raw(), MX_TASK_TERMINATED,\n                                             0, ptr::null_mut());\n             match status {\n                 0 => { }, // Success"}]}