{"sha": "30ba6fd99c56ba618387282660abf944e05c1a58", "node_id": "MDY6Q29tbWl0NzI0NzEyOjMwYmE2ZmQ5OWM1NmJhNjE4Mzg3MjgyNjYwYWJmOTQ0ZTA1YzFhNTg=", "commit": {"author": {"name": "Tyler Mandry", "email": "tmandry@gmail.com", "date": "2019-09-30T21:38:19Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-09-30T21:38:19Z"}, "message": "Rollup merge of #64377 - GuillaumeGomez:E0493, r=estebank\n\nAdd long error explanation for E0493\n\nPart of #61137.", "tree": {"sha": "c4c6a79ef79c6fde722331dd5781b24fe2ff90cd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c4c6a79ef79c6fde722331dd5781b24fe2ff90cd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/30ba6fd99c56ba618387282660abf944e05c1a58", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdknXLCRBK7hj4Ov3rIwAAdHIIACFO8hoNB9xDzD4cGr+K2Hg5\nB9QPaiQrIstegplV1mg1OFqGNGMRRHEAgIchkoWMos82yTfiG2bMSIg4jZrAq22f\nS6ijdQ2PfXhQohJLFxM61S7kdj9HceEzyQCeXxz4thshvk4FI0aj8qyUYTdQQqx0\nqMz9sj+9PjaFZEiGBNTDFnlNfIgWigjCKx6iq42Sa9DDgssX9oiYebmZi0jT6EmI\nfIPFieo4LmCH/WVU4g+tD2o9wJ2BcRDIKu3phdAfEOjTHZyetQ1RK+VPUCtEZX4r\nC8e2p4EpbPsefWurAY1vp9Dp/omVTOA5cAAEIlhfovCm8V5ZM1z2my+ayjWLy/A=\n=uHfg\n-----END PGP SIGNATURE-----\n", "payload": "tree c4c6a79ef79c6fde722331dd5781b24fe2ff90cd\nparent 22bc9e1d9ca49ee4f5cd953088ab09c238a6dd26\nparent 9f978b7f17c3e40b1fb5eb42bc1cfd8cf8338124\nauthor Tyler Mandry <tmandry@gmail.com> 1569879499 -0700\ncommitter GitHub <noreply@github.com> 1569879499 -0700\n\nRollup merge of #64377 - GuillaumeGomez:E0493, r=estebank\n\nAdd long error explanation for E0493\n\nPart of #61137.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/30ba6fd99c56ba618387282660abf944e05c1a58", "html_url": "https://github.com/rust-lang/rust/commit/30ba6fd99c56ba618387282660abf944e05c1a58", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/30ba6fd99c56ba618387282660abf944e05c1a58/comments", "author": {"login": "tmandry", "id": 2280544, "node_id": "MDQ6VXNlcjIyODA1NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2280544?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tmandry", "html_url": "https://github.com/tmandry", "followers_url": "https://api.github.com/users/tmandry/followers", "following_url": "https://api.github.com/users/tmandry/following{/other_user}", "gists_url": "https://api.github.com/users/tmandry/gists{/gist_id}", "starred_url": "https://api.github.com/users/tmandry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tmandry/subscriptions", "organizations_url": "https://api.github.com/users/tmandry/orgs", "repos_url": "https://api.github.com/users/tmandry/repos", "events_url": "https://api.github.com/users/tmandry/events{/privacy}", "received_events_url": "https://api.github.com/users/tmandry/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "22bc9e1d9ca49ee4f5cd953088ab09c238a6dd26", "url": "https://api.github.com/repos/rust-lang/rust/commits/22bc9e1d9ca49ee4f5cd953088ab09c238a6dd26", "html_url": "https://github.com/rust-lang/rust/commit/22bc9e1d9ca49ee4f5cd953088ab09c238a6dd26"}, {"sha": "9f978b7f17c3e40b1fb5eb42bc1cfd8cf8338124", "url": "https://api.github.com/repos/rust-lang/rust/commits/9f978b7f17c3e40b1fb5eb42bc1cfd8cf8338124", "html_url": "https://github.com/rust-lang/rust/commit/9f978b7f17c3e40b1fb5eb42bc1cfd8cf8338124"}], "stats": {"total": 58, "additions": 53, "deletions": 5}, "files": [{"sha": "fb1311de9a70659bf14855cfc9fa9f1bc302e176", "filename": "src/librustc_mir/error_codes.rs", "status": "modified", "additions": 45, "deletions": 1, "changes": 46, "blob_url": "https://github.com/rust-lang/rust/blob/30ba6fd99c56ba618387282660abf944e05c1a58/src%2Flibrustc_mir%2Ferror_codes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/30ba6fd99c56ba618387282660abf944e05c1a58/src%2Flibrustc_mir%2Ferror_codes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Ferror_codes.rs?ref=30ba6fd99c56ba618387282660abf944e05c1a58", "patch": "@@ -1128,6 +1128,51 @@ Remember this solution is unsafe! You will have to ensure that accesses to the\n cell are synchronized.\n \"##,\n \n+E0493: r##\"\n+A type with a `Drop` implementation was destructured when trying to initialize\n+a static item.\n+\n+Erroneous code example:\n+\n+```compile_fail,E0493\n+enum DropType {\n+    A,\n+}\n+\n+impl Drop for DropType {\n+    fn drop(&mut self) {}\n+}\n+\n+struct Foo {\n+    field1: DropType,\n+}\n+\n+static FOO: Foo = Foo { ..Foo { field1: DropType::A } }; // error!\n+```\n+\n+The problem here is that if the given type or one of its fields implements the\n+`Drop` trait, this `Drop` implementation cannot be called during the static\n+type initialization which might cause a memory leak. To prevent this issue,\n+you need to instantiate all the static type's fields by hand.\n+\n+```\n+enum DropType {\n+    A,\n+}\n+\n+impl Drop for DropType {\n+    fn drop(&mut self) {}\n+}\n+\n+struct Foo {\n+    field1: DropType,\n+}\n+\n+static FOO: Foo = Foo { field1: DropType::A }; // We initialize all fields\n+                                               // by hand.\n+```\n+\"##,\n+\n E0499: r##\"\n A variable was borrowed as mutable more than once. Erroneous code example:\n \n@@ -2454,7 +2499,6 @@ There are some known bugs that trigger this message.\n //  E0299, // mismatched types between arms\n //  E0471, // constant evaluation error (in pattern)\n //  E0385, // {} in an aliasable location\n-    E0493, // destructors cannot be evaluated at compile-time\n     E0521, // borrowed data escapes outside of closure\n     E0526, // shuffle indices are not constant\n     E0594, // cannot assign to {}"}, {"sha": "7d7ecbd1a26a579eaeb289f7a994f2bedcdc0b6d", "filename": "src/test/ui/check-static-values-constraints.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/30ba6fd99c56ba618387282660abf944e05c1a58/src%2Ftest%2Fui%2Fcheck-static-values-constraints.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/30ba6fd99c56ba618387282660abf944e05c1a58/src%2Ftest%2Fui%2Fcheck-static-values-constraints.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcheck-static-values-constraints.stderr?ref=30ba6fd99c56ba618387282660abf944e05c1a58", "patch": "@@ -108,5 +108,5 @@ LL |     let y = { static x: Box<isize> = box 3; x };\n \n error: aborting due to 17 previous errors\n \n-Some errors have detailed explanations: E0010, E0015, E0019, E0507.\n+Some errors have detailed explanations: E0010, E0015, E0019, E0493, E0507.\n For more information about an error, try `rustc --explain E0010`."}, {"sha": "4753222a7c07d816fb5f49190e58dcdb891b02fb", "filename": "src/test/ui/consts/const-eval/const_let.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/30ba6fd99c56ba618387282660abf944e05c1a58/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst_let.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/30ba6fd99c56ba618387282660abf944e05c1a58/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst_let.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst_let.stderr?ref=30ba6fd99c56ba618387282660abf944e05c1a58", "patch": "@@ -24,3 +24,4 @@ LL | const Z2: () = { let mut x; x = None; x = Some(FakeNeedsDrop); };\n \n error: aborting due to 4 previous errors\n \n+For more information about this error, try `rustc --explain E0493`."}, {"sha": "3158b6284db94761732509b56d93137268249d9f", "filename": "src/test/ui/consts/min_const_fn/min_const_fn.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/30ba6fd99c56ba618387282660abf944e05c1a58/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/30ba6fd99c56ba618387282660abf944e05c1a58/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmin_const_fn%2Fmin_const_fn.stderr?ref=30ba6fd99c56ba618387282660abf944e05c1a58", "patch": "@@ -324,5 +324,5 @@ LL | const fn no_fn_ptrs2() -> fn() { fn foo() {} foo }\n \n error: aborting due to 37 previous errors\n \n-Some errors have detailed explanations: E0515, E0723.\n-For more information about an error, try `rustc --explain E0515`.\n+Some errors have detailed explanations: E0493, E0515, E0723.\n+For more information about an error, try `rustc --explain E0493`."}, {"sha": "37016664ac58f38c913b3d1dbd36cf8ddd243c99", "filename": "src/test/ui/consts/miri_unleashed/feature-gate-unleash_the_miri_inside_of_you.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/30ba6fd99c56ba618387282660abf944e05c1a58/src%2Ftest%2Fui%2Fconsts%2Fmiri_unleashed%2Ffeature-gate-unleash_the_miri_inside_of_you.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/30ba6fd99c56ba618387282660abf944e05c1a58/src%2Ftest%2Fui%2Fconsts%2Fmiri_unleashed%2Ffeature-gate-unleash_the_miri_inside_of_you.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fmiri_unleashed%2Ffeature-gate-unleash_the_miri_inside_of_you.stderr?ref=30ba6fd99c56ba618387282660abf944e05c1a58", "patch": "@@ -6,3 +6,4 @@ LL |     const F: u32 = (U::X, 42).1;\n \n error: aborting due to previous error\n \n+For more information about this error, try `rustc --explain E0493`."}, {"sha": "d05e89e257f459fc293a73ba9b6d536e97c56240", "filename": "src/test/ui/span/E0493.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/30ba6fd99c56ba618387282660abf944e05c1a58/src%2Ftest%2Fui%2Fspan%2FE0493.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/30ba6fd99c56ba618387282660abf944e05c1a58/src%2Ftest%2Fui%2Fspan%2FE0493.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspan%2FE0493.stderr?ref=30ba6fd99c56ba618387282660abf944e05c1a58", "patch": "@@ -6,3 +6,4 @@ LL | const F : Foo = (Foo { a : 0 }, Foo { a : 1 }).1;\n \n error: aborting due to previous error\n \n+For more information about this error, try `rustc --explain E0493`."}, {"sha": "bc08f33f8209371b7cf1af73fe34a199e5ef4fe0", "filename": "src/test/ui/static/static-drop-scope.stderr", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/30ba6fd99c56ba618387282660abf944e05c1a58/src%2Ftest%2Fui%2Fstatic%2Fstatic-drop-scope.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/30ba6fd99c56ba618387282660abf944e05c1a58/src%2Ftest%2Fui%2Fstatic%2Fstatic-drop-scope.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fstatic%2Fstatic-drop-scope.stderr?ref=30ba6fd99c56ba618387282660abf944e05c1a58", "patch": "@@ -68,4 +68,5 @@ LL | const EARLY_DROP_C_OPTION_CONSTANT: i32 = (HELPER, 0).1;\n \n error: aborting due to 10 previous errors\n \n-For more information about this error, try `rustc --explain E0716`.\n+Some errors have detailed explanations: E0493, E0716.\n+For more information about an error, try `rustc --explain E0493`."}]}