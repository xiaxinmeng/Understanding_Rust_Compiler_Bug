{"sha": "3f5c9920d65c51f90c2d41134cdc600e0262a47a", "node_id": "C_kwDOAAsO6NoAKDNmNWM5OTIwZDY1YzUxZjkwYzJkNDExMzRjZGM2MDBlMDI2MmE0N2E", "commit": {"author": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2023-04-06T17:55:49Z"}, "committer": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2023-04-06T17:55:49Z"}, "message": "Move hir_def::builtin_attr to hir_def::attr::builtin", "tree": {"sha": "62676c0eca5ba50e1325b8e812d8d9ed5ad60f18", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/62676c0eca5ba50e1325b8e812d8d9ed5ad60f18"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3f5c9920d65c51f90c2d41134cdc600e0262a47a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3f5c9920d65c51f90c2d41134cdc600e0262a47a", "html_url": "https://github.com/rust-lang/rust/commit/3f5c9920d65c51f90c2d41134cdc600e0262a47a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3f5c9920d65c51f90c2d41134cdc600e0262a47a/comments", "author": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "12b069f43414f6bcc71bf4d77af05b3300797c1a", "url": "https://api.github.com/repos/rust-lang/rust/commits/12b069f43414f6bcc71bf4d77af05b3300797c1a", "html_url": "https://github.com/rust-lang/rust/commit/12b069f43414f6bcc71bf4d77af05b3300797c1a"}], "stats": {"total": 24, "additions": 12, "deletions": 12}, "files": [{"sha": "9224773aa8044055869d103d06d8c7e857af3499", "filename": "crates/hir-def/src/attr.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3f5c9920d65c51f90c2d41134cdc600e0262a47a/crates%2Fhir-def%2Fsrc%2Fattr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3f5c9920d65c51f90c2d41134cdc600e0262a47a/crates%2Fhir-def%2Fsrc%2Fattr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir-def%2Fsrc%2Fattr.rs?ref=3f5c9920d65c51f90c2d41134cdc600e0262a47a", "patch": "@@ -1,5 +1,7 @@\n //! A higher level attributes based on TokenTree, with also some shortcuts.\n \n+pub mod builtin;\n+\n #[cfg(test)]\n mod tests;\n "}, {"sha": "f7c1e683d0d20366df5ba7e87c910934deadca89", "filename": "crates/hir-def/src/attr/builtin.rs", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/3f5c9920d65c51f90c2d41134cdc600e0262a47a/crates%2Fhir-def%2Fsrc%2Fattr%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3f5c9920d65c51f90c2d41134cdc600e0262a47a/crates%2Fhir-def%2Fsrc%2Fattr%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir-def%2Fsrc%2Fattr%2Fbuiltin.rs?ref=3f5c9920d65c51f90c2d41134cdc600e0262a47a", "previous_filename": "crates/hir-def/src/builtin_attr.rs"}, {"sha": "65c33322b1dc77d1bb29a297a1f2ead53a238fa4", "filename": "crates/hir-def/src/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/3f5c9920d65c51f90c2d41134cdc600e0262a47a/crates%2Fhir-def%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3f5c9920d65c51f90c2d41134cdc600e0262a47a/crates%2Fhir-def%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir-def%2Fsrc%2Flib.rs?ref=3f5c9920d65c51f90c2d41134cdc600e0262a47a", "patch": "@@ -19,7 +19,6 @@ pub mod db;\n pub mod attr;\n pub mod path;\n pub mod builtin_type;\n-pub mod builtin_attr;\n pub mod per_ns;\n pub mod item_scope;\n "}, {"sha": "6fad01ec2f75de4676923ed29fa0a25d20986e45", "filename": "crates/hir-def/src/nameres/attr_resolution.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/3f5c9920d65c51f90c2d41134cdc600e0262a47a/crates%2Fhir-def%2Fsrc%2Fnameres%2Fattr_resolution.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3f5c9920d65c51f90c2d41134cdc600e0262a47a/crates%2Fhir-def%2Fsrc%2Fnameres%2Fattr_resolution.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir-def%2Fsrc%2Fnameres%2Fattr_resolution.rs?ref=3f5c9920d65c51f90c2d41134cdc600e0262a47a", "patch": "@@ -4,7 +4,8 @@ use hir_expand::{attrs::Attr, MacroCallId};\n use syntax::{ast, SmolStr};\n \n use crate::{\n-    attr_macro_as_call_id, builtin_attr,\n+    attr::builtin::{find_builtin_attr_idx, TOOL_MODULES},\n+    attr_macro_as_call_id,\n     db::DefDatabase,\n     item_scope::BuiltinShadowMode,\n     macro_id_to_def_id,\n@@ -76,16 +77,15 @@ impl DefMap {\n             let pred = |n: &_| *n == name;\n \n             let registered = self.registered_tools.iter().map(SmolStr::as_str);\n-            let is_tool = builtin_attr::TOOL_MODULES.iter().copied().chain(registered).any(pred);\n+            let is_tool = TOOL_MODULES.iter().copied().chain(registered).any(pred);\n             // FIXME: tool modules can be shadowed by actual modules\n             if is_tool {\n                 return true;\n             }\n \n             if segments.len() == 1 {\n                 let mut registered = self.registered_attrs.iter().map(SmolStr::as_str);\n-                let is_inert =\n-                    builtin_attr::find_builtin_attr_idx(&name).is_some() || registered.any(pred);\n+                let is_inert = find_builtin_attr_idx(&name).is_some() || registered.any(pred);\n                 return is_inert;\n             }\n         }"}, {"sha": "a355ea1642296c74b719e2db83e76e95effbcfce", "filename": "crates/hir/src/lib.rs", "status": "modified", "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/3f5c9920d65c51f90c2d41134cdc600e0262a47a/crates%2Fhir%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3f5c9920d65c51f90c2d41134cdc600e0262a47a/crates%2Fhir%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir%2Fsrc%2Flib.rs?ref=3f5c9920d65c51f90c2d41134cdc600e0262a47a", "patch": "@@ -109,8 +109,7 @@ pub use crate::{\n pub use {\n     cfg::{CfgAtom, CfgExpr, CfgOptions},\n     hir_def::{\n-        attr::{Attrs, AttrsWithOwner, Documentation},\n-        builtin_attr::AttributeTemplate,\n+        attr::{builtin::AttributeTemplate, Attrs, AttrsWithOwner, Documentation},\n         data::adt::StructKind,\n         find_path::PrefixKind,\n         import_map,\n@@ -2697,22 +2696,22 @@ impl BuiltinAttr {\n     }\n \n     fn builtin(name: &str) -> Option<Self> {\n-        hir_def::builtin_attr::find_builtin_attr_idx(name)\n+        hir_def::attr::builtin::find_builtin_attr_idx(name)\n             .map(|idx| BuiltinAttr { krate: None, idx: idx as u32 })\n     }\n \n     pub fn name(&self, db: &dyn HirDatabase) -> SmolStr {\n         // FIXME: Return a `Name` here\n         match self.krate {\n             Some(krate) => db.crate_def_map(krate).registered_attrs()[self.idx as usize].clone(),\n-            None => SmolStr::new(hir_def::builtin_attr::INERT_ATTRIBUTES[self.idx as usize].name),\n+            None => SmolStr::new(hir_def::attr::builtin::INERT_ATTRIBUTES[self.idx as usize].name),\n         }\n     }\n \n     pub fn template(&self, _: &dyn HirDatabase) -> Option<AttributeTemplate> {\n         match self.krate {\n             Some(_) => None,\n-            None => Some(hir_def::builtin_attr::INERT_ATTRIBUTES[self.idx as usize].template),\n+            None => Some(hir_def::attr::builtin::INERT_ATTRIBUTES[self.idx as usize].template),\n         }\n     }\n }\n@@ -2735,7 +2734,7 @@ impl ToolModule {\n     }\n \n     fn builtin(name: &str) -> Option<Self> {\n-        hir_def::builtin_attr::TOOL_MODULES\n+        hir_def::attr::builtin::TOOL_MODULES\n             .iter()\n             .position(|&tool| tool == name)\n             .map(|idx| ToolModule { krate: None, idx: idx as u32 })\n@@ -2745,7 +2744,7 @@ impl ToolModule {\n         // FIXME: Return a `Name` here\n         match self.krate {\n             Some(krate) => db.crate_def_map(krate).registered_tools()[self.idx as usize].clone(),\n-            None => SmolStr::new(hir_def::builtin_attr::TOOL_MODULES[self.idx as usize]),\n+            None => SmolStr::new(hir_def::attr::builtin::TOOL_MODULES[self.idx as usize]),\n         }\n     }\n }"}]}