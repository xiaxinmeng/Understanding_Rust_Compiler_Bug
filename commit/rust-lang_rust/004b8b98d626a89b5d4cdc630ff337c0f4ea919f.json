{"sha": "004b8b98d626a89b5d4cdc630ff337c0f4ea919f", "node_id": "C_kwDOAAsO6NoAKDAwNGI4Yjk4ZDYyNmE4OWI1ZDRjZGM2MzBmZjMzN2MwZjRlYTkxOWY", "commit": {"author": {"name": "Pietro Albini", "email": "pietro.albini@ferrous-systems.com", "date": "2022-10-05T10:45:52Z"}, "committer": {"name": "Pietro Albini", "email": "pietro.albini@ferrous-systems.com", "date": "2022-10-05T12:32:09Z"}, "message": "add a \"standalone\" path for doc::Standalone to be able to exclude it\n\nBefore this commit, the path for the doc::Standalone step was \"src/doc\",\nwhich is accurate as the standalone docs source files live at the root\nof the \"src/doc\" directory tree.\n\nUnfortunately, that caused bad interactions when trying to exclude it\nwith `--exclude src/doc`. When an exclusion is passed to bootstrap, it\nwill exclude all steps whose path *ends with* the exclusion, which\nresults in the Cargo book (src/tools/cargo/src/doc) to also be excluded.\n\nTo work around this problem, this commit adds the \"standalone\" path as\nan alternate path for doc::Standalone, allowing `--exclude standalone`\nto work without side effects.", "tree": {"sha": "96e9c13a87a142af94b2f805b65c0812bb712fda", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/96e9c13a87a142af94b2f805b65c0812bb712fda"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/004b8b98d626a89b5d4cdc630ff337c0f4ea919f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEMycKYjxLY0eb13b7zXazX3c0dp4FAmM9efgACgkQzXazX3c0\ndp4vIw/8D5A/rS7oGzmTy8lfdZpHz2uTCsbFGGfWvBz+QfQREgHhmQAXtr9mObQB\n+MU2ivkvTV1g/3NOZlQzNHxu1F+DXYQ4cfYhL+U7uWHpw7gZHuM83SypGhqe6vus\nUWOKf/HOkQHB6886Q61y/z/81Hh/mgd+ZUFLiVpbkVvEhYOpW9eHkiL5Sw9283mw\nzTWFT+MUpCbYqDgm5G9QhdjIFNeJ7Q3H+pywb1igK2MMbWwLHTKg+OuttHn6U0eL\ntzktjXYrB8f+ooLAd3OpPpshkraZBw0FLIIVs1lEPcp9gCuB7w1SFpLRo5hXkzpv\nshn3DBcSx+eoQ5gAaPfbJR3mGMkrpFpjUS/KiBmFUMvo0l6k0qBbYSoxMd14lSht\nMhDiaB1dGlZBzSL30q/WeMdf8BBFzOL+89PRbBY/Z6yAO0IGyRwX4+5P4Q0rWPK1\nNLLaP14SYgLk+NAC3beKzKiOisj5JPLEB3A0gBHdb92zmo4BzH8DpOGU3Ua3Q7qp\nlSVktylDg7LeZvIFmxr//1OqiUZFnfuIFEL/l1dA3vHSoM3iUtf/LJPF20ODuhmN\ngsbTQSCQvR+qYGFiSC9IV/T87VrQZ3nThXu/o0V4A5JuyM9glP8nc+2xjpqKUSyi\nnu1XnNjw0SQKOIbgDHmnR+7IHJJb0HuHIxNg0+AeAlK5kqYdnOQ=\n=+7zf\n-----END PGP SIGNATURE-----", "payload": "tree 96e9c13a87a142af94b2f805b65c0812bb712fda\nparent afe29e48bc4d57c1bb73228ba8d70dc8f42436fc\nauthor Pietro Albini <pietro.albini@ferrous-systems.com> 1664966752 +0200\ncommitter Pietro Albini <pietro.albini@ferrous-systems.com> 1664973129 +0200\n\nadd a \"standalone\" path for doc::Standalone to be able to exclude it\n\nBefore this commit, the path for the doc::Standalone step was \"src/doc\",\nwhich is accurate as the standalone docs source files live at the root\nof the \"src/doc\" directory tree.\n\nUnfortunately, that caused bad interactions when trying to exclude it\nwith `--exclude src/doc`. When an exclusion is passed to bootstrap, it\nwill exclude all steps whose path *ends with* the exclusion, which\nresults in the Cargo book (src/tools/cargo/src/doc) to also be excluded.\n\nTo work around this problem, this commit adds the \"standalone\" path as\nan alternate path for doc::Standalone, allowing `--exclude standalone`\nto work without side effects.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/004b8b98d626a89b5d4cdc630ff337c0f4ea919f", "html_url": "https://github.com/rust-lang/rust/commit/004b8b98d626a89b5d4cdc630ff337c0f4ea919f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/004b8b98d626a89b5d4cdc630ff337c0f4ea919f/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "afe29e48bc4d57c1bb73228ba8d70dc8f42436fc", "url": "https://api.github.com/repos/rust-lang/rust/commits/afe29e48bc4d57c1bb73228ba8d70dc8f42436fc", "html_url": "https://github.com/rust-lang/rust/commit/afe29e48bc4d57c1bb73228ba8d70dc8f42436fc"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "a8524fea1b2a0b91aa16fb22d74af741ae87835f", "filename": "src/bootstrap/doc.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/004b8b98d626a89b5d4cdc630ff337c0f4ea919f/src%2Fbootstrap%2Fdoc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/004b8b98d626a89b5d4cdc630ff337c0f4ea919f/src%2Fbootstrap%2Fdoc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdoc.rs?ref=004b8b98d626a89b5d4cdc630ff337c0f4ea919f", "patch": "@@ -299,7 +299,7 @@ impl Step for Standalone {\n \n     fn should_run(run: ShouldRun<'_>) -> ShouldRun<'_> {\n         let builder = run.builder;\n-        run.path(\"src/doc\").default_condition(builder.config.docs)\n+        run.path(\"src/doc\").path(\"standalone\").default_condition(builder.config.docs)\n     }\n \n     fn make_run(run: RunConfig<'_>) {"}]}