{"sha": "1d49658f5c7adc403311b815c9ec8d23e4551de2", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFkNDk2NThmNWM3YWRjNDAzMzExYjgxNWM5ZWM4ZDIzZTQ1NTFkZTI=", "commit": {"author": {"name": "Ryan Levick", "email": "me@ryanlevick.com", "date": "2021-06-29T14:39:19Z"}, "committer": {"name": "Ryan Levick", "email": "me@ryanlevick.com", "date": "2021-07-06T18:11:45Z"}, "message": "Change or_patterns_back_compat lint to rust_2021_incompatible_or_patterns", "tree": {"sha": "67a25eecc2004c2f4eec49d07e4e93a9544cb1b8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/67a25eecc2004c2f4eec49d07e4e93a9544cb1b8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1d49658f5c7adc403311b815c9ec8d23e4551de2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1d49658f5c7adc403311b815c9ec8d23e4551de2", "html_url": "https://github.com/rust-lang/rust/commit/1d49658f5c7adc403311b815c9ec8d23e4551de2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1d49658f5c7adc403311b815c9ec8d23e4551de2/comments", "author": {"login": "rylev", "id": 1327285, "node_id": "MDQ6VXNlcjEzMjcyODU=", "avatar_url": "https://avatars.githubusercontent.com/u/1327285?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rylev", "html_url": "https://github.com/rylev", "followers_url": "https://api.github.com/users/rylev/followers", "following_url": "https://api.github.com/users/rylev/following{/other_user}", "gists_url": "https://api.github.com/users/rylev/gists{/gist_id}", "starred_url": "https://api.github.com/users/rylev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rylev/subscriptions", "organizations_url": "https://api.github.com/users/rylev/orgs", "repos_url": "https://api.github.com/users/rylev/repos", "events_url": "https://api.github.com/users/rylev/events{/privacy}", "received_events_url": "https://api.github.com/users/rylev/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rylev", "id": 1327285, "node_id": "MDQ6VXNlcjEzMjcyODU=", "avatar_url": "https://avatars.githubusercontent.com/u/1327285?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rylev", "html_url": "https://github.com/rylev", "followers_url": "https://api.github.com/users/rylev/followers", "following_url": "https://api.github.com/users/rylev/following{/other_user}", "gists_url": "https://api.github.com/users/rylev/gists{/gist_id}", "starred_url": "https://api.github.com/users/rylev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rylev/subscriptions", "organizations_url": "https://api.github.com/users/rylev/orgs", "repos_url": "https://api.github.com/users/rylev/repos", "events_url": "https://api.github.com/users/rylev/events{/privacy}", "received_events_url": "https://api.github.com/users/rylev/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "df71a99a0ea8d89cb1ec9281a6a24a8710c37c9d", "url": "https://api.github.com/repos/rust-lang/rust/commits/df71a99a0ea8d89cb1ec9281a6a24a8710c37c9d", "html_url": "https://github.com/rust-lang/rust/commit/df71a99a0ea8d89cb1ec9281a6a24a8710c37c9d"}], "stats": {"total": 24, "additions": 14, "deletions": 10}, "files": [{"sha": "8b68c94e61a384c19603352176b09e396236e31e", "filename": "compiler/rustc_expand/src/mbe/macro_rules.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/1d49658f5c7adc403311b815c9ec8d23e4551de2/compiler%2Frustc_expand%2Fsrc%2Fmbe%2Fmacro_rules.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1d49658f5c7adc403311b815c9ec8d23e4551de2/compiler%2Frustc_expand%2Fsrc%2Fmbe%2Fmacro_rules.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_expand%2Fsrc%2Fmbe%2Fmacro_rules.rs?ref=1d49658f5c7adc403311b815c9ec8d23e4551de2", "patch": "@@ -18,7 +18,9 @@ use rustc_data_structures::fx::FxHashMap;\n use rustc_data_structures::sync::Lrc;\n use rustc_errors::{Applicability, DiagnosticBuilder};\n use rustc_feature::Features;\n-use rustc_lint_defs::builtin::{OR_PATTERNS_BACK_COMPAT, SEMICOLON_IN_EXPRESSIONS_FROM_MACROS};\n+use rustc_lint_defs::builtin::{\n+    RUST_2021_INCOMPATIBLE_OR_PATTERNS, SEMICOLON_IN_EXPRESSIONS_FROM_MACROS,\n+};\n use rustc_lint_defs::BuiltinLintDiagnostics;\n use rustc_parse::parser::Parser;\n use rustc_session::parse::ParseSess;\n@@ -975,7 +977,7 @@ fn check_matcher_core(\n                             Some(NonterminalKind::PatParam { inferred: false }),\n                         ));\n                         sess.buffer_lint_with_diagnostic(\n-                            &OR_PATTERNS_BACK_COMPAT,\n+                            &RUST_2021_INCOMPATIBLE_OR_PATTERNS,\n                             span,\n                             ast::CRATE_NODE_ID,\n                             \"the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\","}, {"sha": "2e5ef8daf14635a270c20928888ead22a2ba6eb4", "filename": "compiler/rustc_lint/src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/1d49658f5c7adc403311b815c9ec8d23e4551de2/compiler%2Frustc_lint%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1d49658f5c7adc403311b815c9ec8d23e4551de2/compiler%2Frustc_lint%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Flib.rs?ref=1d49658f5c7adc403311b815c9ec8d23e4551de2", "patch": "@@ -326,6 +326,7 @@ fn register_builtins(store: &mut LintStore, no_interleave_lints: bool) {\n     store.register_renamed(\"overlapping_patterns\", \"overlapping_range_endpoints\");\n     store.register_renamed(\"safe_packed_borrows\", \"unaligned_references\");\n     store.register_renamed(\"disjoint_capture_migration\", \"rust_2021_incompatible_closure_captures\");\n+    store.register_renamed(\"or_patterns_back_compat\", \"rust_2021_incompatible_or_patterns\");\n \n     // These were moved to tool lints, but rustc still sees them when compiling normally, before\n     // tool lints are registered, so `check_tool_name_for_backwards_compat` doesn't work. Use"}, {"sha": "ed39815ff561b6d3636de8a38e7eee3bd057605d", "filename": "compiler/rustc_lint_defs/src/builtin.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/1d49658f5c7adc403311b815c9ec8d23e4551de2/compiler%2Frustc_lint_defs%2Fsrc%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1d49658f5c7adc403311b815c9ec8d23e4551de2/compiler%2Frustc_lint_defs%2Fsrc%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint_defs%2Fsrc%2Fbuiltin.rs?ref=1d49658f5c7adc403311b815c9ec8d23e4551de2", "patch": "@@ -2970,7 +2970,7 @@ declare_lint_pass! {\n         RUST_2021_INCOMPATIBLE_CLOSURE_CAPTURES,\n         LEGACY_DERIVE_HELPERS,\n         PROC_MACRO_BACK_COMPAT,\n-        OR_PATTERNS_BACK_COMPAT,\n+        RUST_2021_INCOMPATIBLE_OR_PATTERNS,\n         LARGE_ASSIGNMENTS,\n         FUTURE_PRELUDE_COLLISION,\n         RESERVED_PREFIX,\n@@ -3183,12 +3183,12 @@ declare_lint! {\n }\n \n declare_lint! {\n-    /// The `or_patterns_back_compat` lint detects usage of old versions of or-patterns.\n+    /// The `rust_2021_incompatible_or_patterns` lint detects usage of old versions of or-patterns.\n     ///\n     /// ### Example\n     ///\n     /// ```rust,compile_fail\n-    /// #![deny(or_patterns_back_compat)]\n+    /// #![deny(rust_2021_incompatible_or_patterns)]\n     /// macro_rules! match_any {\n     ///     ( $expr:expr , $( $( $pat:pat )|+ => $expr_arm:expr ),+ ) => {\n     ///         match $expr {\n@@ -3211,7 +3211,7 @@ declare_lint! {\n     /// ### Explanation\n     ///\n     /// In Rust 2021, the pat matcher will match new patterns, which include the | character.\n-    pub OR_PATTERNS_BACK_COMPAT,\n+    pub RUST_2021_INCOMPATIBLE_OR_PATTERNS,\n     Allow,\n     \"detects usage of old versions of or-patterns\",\n     @future_incompatible = FutureIncompatibleInfo {"}, {"sha": "f0f0ba2e92f4f1cb1dbf49683002d56a6d7bae3b", "filename": "library/core/src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/1d49658f5c7adc403311b815c9ec8d23e4551de2/library%2Fcore%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1d49658f5c7adc403311b815c9ec8d23e4551de2/library%2Fcore%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Flib.rs?ref=1d49658f5c7adc403311b815c9ec8d23e4551de2", "patch": "@@ -164,6 +164,7 @@\n #![feature(no_niche)] // rust-lang/rust#68303\n #![feature(no_coverage)] // rust-lang/rust#84605\n #![deny(unsafe_op_in_unsafe_fn)]\n+#![allow(renamed_and_removed_lints)]\n #![deny(or_patterns_back_compat)]\n \n // allow using `core::` in intra-doc links"}, {"sha": "b0d56e9bb1ef0a5bd97923bf1b572401c1df7e38", "filename": "src/test/ui/macros/macro-or-patterns-back-compat.fixed", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1d49658f5c7adc403311b815c9ec8d23e4551de2/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/1d49658f5c7adc403311b815c9ec8d23e4551de2/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.fixed?ref=1d49658f5c7adc403311b815c9ec8d23e4551de2", "patch": "@@ -1,7 +1,7 @@\n // run-rustfix\n // aux-build:or-pattern.rs\n \n-#![deny(or_patterns_back_compat)]\n+#![deny(rust_2021_incompatible_or_patterns)]\n #![allow(unused_macros)]\n \n #[macro_use]"}, {"sha": "9e24b5106b8bf528fbf3b5fdfdc71745a19ac4d5", "filename": "src/test/ui/macros/macro-or-patterns-back-compat.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1d49658f5c7adc403311b815c9ec8d23e4551de2/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1d49658f5c7adc403311b815c9ec8d23e4551de2/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.rs?ref=1d49658f5c7adc403311b815c9ec8d23e4551de2", "patch": "@@ -1,7 +1,7 @@\n // run-rustfix\n // aux-build:or-pattern.rs\n \n-#![deny(or_patterns_back_compat)]\n+#![deny(rust_2021_incompatible_or_patterns)]\n #![allow(unused_macros)]\n \n #[macro_use]"}, {"sha": "eb6204fa02e69221dc89aee8af589b70bbbc1d97", "filename": "src/test/ui/macros/macro-or-patterns-back-compat.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/1d49658f5c7adc403311b815c9ec8d23e4551de2/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/1d49658f5c7adc403311b815c9ec8d23e4551de2/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.stderr?ref=1d49658f5c7adc403311b815c9ec8d23e4551de2", "patch": "@@ -7,8 +7,8 @@ LL | macro_rules! foo { ($x:pat | $y:pat) => {} }\n note: the lint level is defined here\n   --> $DIR/macro-or-patterns-back-compat.rs:4:9\n    |\n-LL | #![deny(or_patterns_back_compat)]\n-   |         ^^^^^^^^^^^^^^^^^^^^^^^\n+LL | #![deny(rust_2021_incompatible_or_patterns)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    = warning: this is accepted in the current edition (Rust 2015) but is a hard error in Rust 2021!\n    = note: for more information, see issue #84869 <https://github.com/rust-lang/rust/issues/84869>\n "}]}