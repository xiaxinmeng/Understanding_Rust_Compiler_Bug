{"sha": "f7d53a96ca9e74f00355951c03384184464ebbc2", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY3ZDUzYTk2Y2E5ZTc0ZjAwMzU1OTUxYzAzMzg0MTg0NDY0ZWJiYzI=", "commit": {"author": {"name": "Jeremy Fitzhardinge", "email": "jeremy@goop.org", "date": "2019-07-18T08:02:22Z"}, "committer": {"name": "Jeremy Fitzhardinge", "email": "jeremy@goop.org", "date": "2019-07-18T08:02:22Z"}, "message": "Emit artifact notifications for dependency files", "tree": {"sha": "3665f0a30f9a24129a1af4925090485de9dca913", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3665f0a30f9a24129a1af4925090485de9dca913"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f7d53a96ca9e74f00355951c03384184464ebbc2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f7d53a96ca9e74f00355951c03384184464ebbc2", "html_url": "https://github.com/rust-lang/rust/commit/f7d53a96ca9e74f00355951c03384184464ebbc2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f7d53a96ca9e74f00355951c03384184464ebbc2/comments", "author": {"login": "jsgf", "id": 147966, "node_id": "MDQ6VXNlcjE0Nzk2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/147966?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsgf", "html_url": "https://github.com/jsgf", "followers_url": "https://api.github.com/users/jsgf/followers", "following_url": "https://api.github.com/users/jsgf/following{/other_user}", "gists_url": "https://api.github.com/users/jsgf/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsgf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsgf/subscriptions", "organizations_url": "https://api.github.com/users/jsgf/orgs", "repos_url": "https://api.github.com/users/jsgf/repos", "events_url": "https://api.github.com/users/jsgf/events{/privacy}", "received_events_url": "https://api.github.com/users/jsgf/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jsgf", "id": 147966, "node_id": "MDQ6VXNlcjE0Nzk2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/147966?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsgf", "html_url": "https://github.com/jsgf", "followers_url": "https://api.github.com/users/jsgf/followers", "following_url": "https://api.github.com/users/jsgf/following{/other_user}", "gists_url": "https://api.github.com/users/jsgf/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsgf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsgf/subscriptions", "organizations_url": "https://api.github.com/users/jsgf/orgs", "repos_url": "https://api.github.com/users/jsgf/repos", "events_url": "https://api.github.com/users/jsgf/events{/privacy}", "received_events_url": "https://api.github.com/users/jsgf/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "efb74579150a6ea0ad99a8568aa02a1aa23f6dd5", "url": "https://api.github.com/repos/rust-lang/rust/commits/efb74579150a6ea0ad99a8568aa02a1aa23f6dd5", "html_url": "https://github.com/rust-lang/rust/commit/efb74579150a6ea0ad99a8568aa02a1aa23f6dd5"}], "stats": {"total": 20, "additions": 14, "deletions": 6}, "files": [{"sha": "bb11657d0c40c270f09bd5944ccccbff15436775", "filename": "src/librustc_interface/passes.rs", "status": "modified", "additions": 14, "deletions": 6, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/f7d53a96ca9e74f00355951c03384184464ebbc2/src%2Flibrustc_interface%2Fpasses.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f7d53a96ca9e74f00355951c03384184464ebbc2/src%2Flibrustc_interface%2Fpasses.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_interface%2Fpasses.rs?ref=f7d53a96ca9e74f00355951c03384184464ebbc2", "patch": "@@ -688,12 +688,20 @@ fn write_out_deps(sess: &Session, outputs: &OutputFilenames, out_filenames: &[Pa\n         Ok(())\n     })();\n \n-    if let Err(e) = result {\n-        sess.fatal(&format!(\n-            \"error writing dependencies to `{}`: {}\",\n-            deps_filename.display(),\n-            e\n-        ));\n+    match result {\n+        Ok(_) => {\n+            if sess.opts.debugging_opts.emit_artifact_notifications {\n+                 sess.parse_sess.span_diagnostic\n+                    .emit_artifact_notification(&deps_filename, \"dep-info\");\n+            }\n+        },\n+        Err(e) => {\n+            sess.fatal(&format!(\n+                \"error writing dependencies to `{}`: {}\",\n+                deps_filename.display(),\n+                e\n+            ))\n+        }\n     }\n }\n "}]}