{"sha": "02e8839cbd6d5df2019cd22cd42aea48c3aecf2a", "node_id": "C_kwDOAAsO6NoAKDAyZTg4MzljYmQ2ZDVkZjIwMTljZDIyY2Q0MmFlYTQ4YzNhZWNmMmE", "commit": {"author": {"name": "fee1-dead", "email": "ent3rm4n@gmail.com", "date": "2022-03-06T11:35:30Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-03-06T11:35:30Z"}, "message": "Rollup merge of #94621 - ridwanabdillahi:lld-rel-dbg, r=Mark-Simulacrum\n\nrustbuild: support RelWithDebInfo for lld\n\nr? ``@alexcrichton``\n\nLLVM has flags that control the level of debuginfo generated when building via rustbuild. Since LLD is built separately, it currently has no way of generating any debuginfo. This change re-uses the same flags as LLVM for LLD to ensure it has the same level of debuginfo generated as LLVM.", "tree": {"sha": "ad64c547118efc47ce0d08db98dd48be031550cc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ad64c547118efc47ce0d08db98dd48be031550cc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/02e8839cbd6d5df2019cd22cd42aea48c3aecf2a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJiJJyCCRBK7hj4Ov3rIwAA3LkIAG3tF6UmlrmivQQeTZ35yRPH\n7QiK8h03iIoUvwSW6dtQZ99rYExgE9uq4xKtogY7o/BTOGyBYTR6vpLIjjf80eog\nwTkHtNdQhWkCep37Lqu9gHmn771+8xcVmPdKAW9WZBl3iGuFjbk3iUaSCUU+p+2g\nXoRGrLEmEYiAPwCnOnEo6TrPT4U5mHWveiy4FIajz4/LAv0vV8Lnexb0Bq7FPL9M\ntRa4JORhpnVEKD69+QbtZ5KpqihfP1/loqOMtymnCwMEfhQyXQJZWxMIvz4PAMsk\nLHUK5+bX834ZEjVl8BnBmbjjSco0Sl4cMJQAV5mbc3c7ZDzG/171WQC7VEeZyng=\n=9KyK\n-----END PGP SIGNATURE-----\n", "payload": "tree ad64c547118efc47ce0d08db98dd48be031550cc\nparent d85e4b1e359be89ff6e55b71f54ed84c5a85d1f1\nparent 6a50572c51d81e0aba542f0b0e73c376c7cbb9c2\nauthor fee1-dead <ent3rm4n@gmail.com> 1646566530 +1100\ncommitter GitHub <noreply@github.com> 1646566530 +1100\n\nRollup merge of #94621 - ridwanabdillahi:lld-rel-dbg, r=Mark-Simulacrum\n\nrustbuild: support RelWithDebInfo for lld\n\nr? ``@alexcrichton``\n\nLLVM has flags that control the level of debuginfo generated when building via rustbuild. Since LLD is built separately, it currently has no way of generating any debuginfo. This change re-uses the same flags as LLVM for LLD to ensure it has the same level of debuginfo generated as LLVM.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/02e8839cbd6d5df2019cd22cd42aea48c3aecf2a", "html_url": "https://github.com/rust-lang/rust/commit/02e8839cbd6d5df2019cd22cd42aea48c3aecf2a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/02e8839cbd6d5df2019cd22cd42aea48c3aecf2a/comments", "author": {"login": "fee1-dead", "id": 43851243, "node_id": "MDQ6VXNlcjQzODUxMjQz", "avatar_url": "https://avatars.githubusercontent.com/u/43851243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fee1-dead", "html_url": "https://github.com/fee1-dead", "followers_url": "https://api.github.com/users/fee1-dead/followers", "following_url": "https://api.github.com/users/fee1-dead/following{/other_user}", "gists_url": "https://api.github.com/users/fee1-dead/gists{/gist_id}", "starred_url": "https://api.github.com/users/fee1-dead/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fee1-dead/subscriptions", "organizations_url": "https://api.github.com/users/fee1-dead/orgs", "repos_url": "https://api.github.com/users/fee1-dead/repos", "events_url": "https://api.github.com/users/fee1-dead/events{/privacy}", "received_events_url": "https://api.github.com/users/fee1-dead/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d85e4b1e359be89ff6e55b71f54ed84c5a85d1f1", "url": "https://api.github.com/repos/rust-lang/rust/commits/d85e4b1e359be89ff6e55b71f54ed84c5a85d1f1", "html_url": "https://github.com/rust-lang/rust/commit/d85e4b1e359be89ff6e55b71f54ed84c5a85d1f1"}, {"sha": "6a50572c51d81e0aba542f0b0e73c376c7cbb9c2", "url": "https://api.github.com/repos/rust-lang/rust/commits/6a50572c51d81e0aba542f0b0e73c376c7cbb9c2", "html_url": "https://github.com/rust-lang/rust/commit/6a50572c51d81e0aba542f0b0e73c376c7cbb9c2"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "f00c5ce5aa6f03fff9885a022260c1d4df076014", "filename": "src/bootstrap/native.rs", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/02e8839cbd6d5df2019cd22cd42aea48c3aecf2a/src%2Fbootstrap%2Fnative.rs", "raw_url": "https://github.com/rust-lang/rust/raw/02e8839cbd6d5df2019cd22cd42aea48c3aecf2a/src%2Fbootstrap%2Fnative.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fnative.rs?ref=02e8839cbd6d5df2019cd22cd42aea48c3aecf2a", "patch": "@@ -650,8 +650,16 @@ impl Step for Lld {\n         // there's probably a lot of reasons you can't do that other than this.\n         let llvm_config_shim = env::current_exe().unwrap().with_file_name(\"llvm-config-wrapper\");\n \n+        // Re-use the same flags as llvm to control the level of debug information\n+        // generated for lld.\n+        let profile = match (builder.config.llvm_optimize, builder.config.llvm_release_debuginfo) {\n+            (false, _) => \"Debug\",\n+            (true, false) => \"Release\",\n+            (true, true) => \"RelWithDebInfo\",\n+        };\n+\n         cfg.out_dir(&out_dir)\n-            .profile(\"Release\")\n+            .profile(profile)\n             .env(\"LLVM_CONFIG_REAL\", &llvm_config)\n             .define(\"LLVM_CONFIG_PATH\", llvm_config_shim)\n             .define(\"LLVM_INCLUDE_TESTS\", \"OFF\");"}]}