{"sha": "f4c87c58a83406207a232d8f9f00f604a6d657b7", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY0Yzg3YzU4YTgzNDA2MjA3YTIzMmQ4ZjlmMDBmNjA0YTZkNjU3Yjc=", "commit": {"author": {"name": "Joshua Nelson", "email": "jyn514@gmail.com", "date": "2021-04-05T09:09:37Z"}, "committer": {"name": "Joshua Nelson", "email": "jyn514@gmail.com", "date": "2021-04-05T18:32:13Z"}, "message": "Take `DiagnosticInfo` in `ambiguity_error`", "tree": {"sha": "06bb6bd16f028cf2af2bc3106c83def8c97ad51b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/06bb6bd16f028cf2af2bc3106c83def8c97ad51b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f4c87c58a83406207a232d8f9f00f604a6d657b7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f4c87c58a83406207a232d8f9f00f604a6d657b7", "html_url": "https://github.com/rust-lang/rust/commit/f4c87c58a83406207a232d8f9f00f604a6d657b7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f4c87c58a83406207a232d8f9f00f604a6d657b7/comments", "author": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "58f9c5b74a77eb339d747dfead08cbafad823923", "url": "https://api.github.com/repos/rust-lang/rust/commits/58f9c5b74a77eb339d747dfead08cbafad823923", "html_url": "https://github.com/rust-lang/rust/commit/58f9c5b74a77eb339d747dfead08cbafad823923"}], "stats": {"total": 15, "additions": 3, "deletions": 12}, "files": [{"sha": "d0ece91f014628c96f95b05465717927ed3070a6", "filename": "src/librustdoc/passes/collect_intra_doc_links.rs", "status": "modified", "additions": 3, "deletions": 12, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/f4c87c58a83406207a232d8f9f00f604a6d657b7/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f4c87c58a83406207a232d8f9f00f604a6d657b7/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs?ref=f4c87c58a83406207a232d8f9f00f604a6d657b7", "patch": "@@ -1124,7 +1124,7 @@ impl LinkCollector<'_, '_> {\n                 } else {\n                     // `[char]` when a `char` module is in scope\n                     let candidates = vec![res, prim];\n-                    ambiguity_error(self.cx, &item, path_str, dox, ori_link.range, candidates);\n+                    ambiguity_error(self.cx, diag_info, path_str, candidates);\n                     return None;\n                 }\n             }\n@@ -1413,14 +1413,7 @@ impl LinkCollector<'_, '_> {\n                     }\n                     // If we're reporting an ambiguity, don't mention the namespaces that failed\n                     let candidates = candidates.map(|candidate| candidate.ok().map(|(res, _)| res));\n-                    ambiguity_error(\n-                        self.cx,\n-                        diag.item,\n-                        path_str,\n-                        diag.dox,\n-                        diag.link_range,\n-                        candidates.present_items().collect(),\n-                    );\n+                    ambiguity_error(self.cx, diag, path_str, candidates.present_items().collect());\n                     None\n                 }\n             }\n@@ -1983,10 +1976,8 @@ fn disambiguator_error(\n /// Report an ambiguity error, where there were multiple possible resolutions.\n fn ambiguity_error(\n     cx: &DocContext<'_>,\n-    item: &Item,\n+    DiagnosticInfo { item, ori_link: _, dox, link_range }: DiagnosticInfo<'_>,\n     path_str: &str,\n-    dox: &str,\n-    link_range: Range<usize>,\n     candidates: Vec<Res>,\n ) {\n     let mut msg = format!(\"`{}` is \", path_str);"}]}