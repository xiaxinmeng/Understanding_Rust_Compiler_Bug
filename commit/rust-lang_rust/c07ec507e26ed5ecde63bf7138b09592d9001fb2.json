{"sha": "c07ec507e26ed5ecde63bf7138b09592d9001fb2", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMwN2VjNTA3ZTI2ZWQ1ZWNkZTYzYmY3MTM4YjA5NTkyZDkwMDFmYjI=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2015-02-18T22:31:55Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2015-02-18T22:31:55Z"}, "message": "rollup merge of #22287: Ryman/purge_carthographers\n\nThis overlaps with #22276 (I left make check running overnight) but covers a number of additional cases and has a few rewrites where the clones are not even necessary.\n\nThis also implements `RandomAccessIterator` for `iter::Cloned`\n\ncc @steveklabnik, you may want to glance at this before #22281 gets the bors treatment", "tree": {"sha": "25b5b50cf3c9a1b73455e3cc629acd6abb3be990", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/25b5b50cf3c9a1b73455e3cc629acd6abb3be990"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c07ec507e26ed5ecde63bf7138b09592d9001fb2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c07ec507e26ed5ecde63bf7138b09592d9001fb2", "html_url": "https://github.com/rust-lang/rust/commit/c07ec507e26ed5ecde63bf7138b09592d9001fb2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c07ec507e26ed5ecde63bf7138b09592d9001fb2/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c5fddd81ab47ddbfd5525210fb1536472de399b8", "url": "https://api.github.com/repos/rust-lang/rust/commits/c5fddd81ab47ddbfd5525210fb1536472de399b8", "html_url": "https://github.com/rust-lang/rust/commit/c5fddd81ab47ddbfd5525210fb1536472de399b8"}, {"sha": "d2f54e663400b98c368710669ad9a966fa950803", "url": "https://api.github.com/repos/rust-lang/rust/commits/d2f54e663400b98c368710669ad9a966fa950803", "html_url": "https://github.com/rust-lang/rust/commit/d2f54e663400b98c368710669ad9a966fa950803"}], "stats": {"total": 257, "additions": 130, "deletions": 127}, "files": [{"sha": "278ce5565d9fc38d8ce9bec899e5fcf3109d0ab1", "filename": "src/compiletest/compiletest.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Fcompiletest%2Fcompiletest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Fcompiletest%2Fcompiletest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcompiletest%2Fcompiletest.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -21,6 +21,7 @@\n #![feature(test)]\n #![feature(unicode)]\n #![feature(env)]\n+#![feature(core)]\n \n #![deny(warnings)]\n "}, {"sha": "be26a7caaffe3a306feb7131058ef0bfdd4bae2e", "filename": "src/compiletest/runtest.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Fcompiletest%2Fruntest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Fcompiletest%2Fruntest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcompiletest%2Fruntest.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -1134,7 +1134,7 @@ fn compile_test_(config: &Config, props: &TestProps,\n     // FIXME (#9639): This needs to handle non-utf8 paths\n     let mut link_args = vec!(\"-L\".to_string(),\n                              aux_dir.as_str().unwrap().to_string());\n-    link_args.extend(extra_args.iter().map(|s| s.clone()));\n+    link_args.extend(extra_args.iter().cloned());\n     let args = make_compile_args(config,\n                                  props,\n                                  link_args,"}, {"sha": "1e49679d116e641222cb91984cddc69797de3b8b", "filename": "src/libcollections/bit.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibcollections%2Fbit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibcollections%2Fbit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcollections%2Fbit.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -2286,7 +2286,7 @@ mod tests {\n     #[test]\n     fn test_from_bools() {\n         let bools = vec![true, false, true, true];\n-        let bitv: Bitv = bools.iter().map(|n| *n).collect();\n+        let bitv: Bitv = bools.iter().cloned().collect();\n         assert_eq!(format!(\"{:?}\", bitv), \"1011\");\n     }\n \n@@ -2299,12 +2299,12 @@ mod tests {\n     #[test]\n     fn test_bitv_iterator() {\n         let bools = vec![true, false, true, true];\n-        let bitv: Bitv = bools.iter().map(|n| *n).collect();\n+        let bitv: Bitv = bools.iter().cloned().collect();\n \n         assert_eq!(bitv.iter().collect::<Vec<bool>>(), bools);\n \n         let long: Vec<_> = (0i32..10000).map(|i| i % 2 == 0).collect();\n-        let bitv: Bitv = long.iter().map(|n| *n).collect();\n+        let bitv: Bitv = long.iter().cloned().collect();\n         assert_eq!(bitv.iter().collect::<Vec<bool>>(), long)\n     }\n "}, {"sha": "9b05975470e86185dc621e72f5eebc917599b78e", "filename": "src/libcollections/dlist.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibcollections%2Fdlist.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibcollections%2Fdlist.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcollections%2Fdlist.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -907,7 +907,7 @@ impl<A: Ord> Ord for DList<A> {\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n impl<A: Clone> Clone for DList<A> {\n     fn clone(&self) -> DList<A> {\n-        self.iter().map(|x| x.clone()).collect()\n+        self.iter().cloned().collect()\n     }\n }\n \n@@ -1025,7 +1025,7 @@ mod tests {\n \n     #[cfg(test)]\n     fn list_from<T: Clone>(v: &[T]) -> DList<T> {\n-        v.iter().map(|x| (*x).clone()).collect()\n+        v.iter().cloned().collect()\n     }\n \n     #[test]"}, {"sha": "8e5396f2229e201b2353d987adc21f09b242ce46", "filename": "src/libcore/iter.rs", "status": "modified", "additions": 22, "deletions": 5, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibcore%2Fiter.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibcore%2Fiter.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fiter.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -332,7 +332,7 @@ pub trait IteratorExt: Iterator + Sized {\n     ///\n     /// ```\n     /// let xs = [100, 200, 300];\n-    /// let mut it = xs.iter().map(|x| *x).peekable();\n+    /// let mut it = xs.iter().cloned().peekable();\n     /// assert_eq!(*it.peek().unwrap(), 100);\n     /// assert_eq!(it.next().unwrap(), 100);\n     /// assert_eq!(it.next().unwrap(), 200);\n@@ -522,7 +522,7 @@ pub trait IteratorExt: Iterator + Sized {\n     ///\n     /// let a = [1, 4, 2, 3, 8, 9, 6];\n     /// let sum = a.iter()\n-    ///             .map(|&x| x)\n+    ///             .cloned()\n     ///             .inspect(|&x| println!(\"filtering {}\", x))\n     ///             .filter(|&x| x % 2 == 0)\n     ///             .inspect(|&x| println!(\"{} made it through\", x))\n@@ -561,7 +561,7 @@ pub trait IteratorExt: Iterator + Sized {\n     ///\n     /// ```\n     /// let a = [1, 2, 3, 4, 5];\n-    /// let b: Vec<_> = a.iter().map(|&x| x).collect();\n+    /// let b: Vec<_> = a.iter().cloned().collect();\n     /// assert_eq!(a, b);\n     /// ```\n     #[inline]\n@@ -937,7 +937,7 @@ pub trait IteratorExt: Iterator + Sized {\n     ///\n     /// ```\n     /// let a = [(1, 2), (3, 4)];\n-    /// let (left, right): (Vec<_>, Vec<_>) = a.iter().map(|&x| x).unzip();\n+    /// let (left, right): (Vec<_>, Vec<_>) = a.iter().cloned().unzip();\n     /// assert_eq!([1, 3], left);\n     /// assert_eq!([2, 4], right);\n     /// ```\n@@ -1142,7 +1142,7 @@ pub trait AdditiveIterator<A> {\n     /// use std::iter::AdditiveIterator;\n     ///\n     /// let a = [1i32, 2, 3, 4, 5];\n-    /// let mut it = a.iter().map(|&x| x);\n+    /// let mut it = a.iter().cloned();\n     /// assert!(it.sum() == 15);\n     /// ```\n     fn sum(self) -> A;\n@@ -1305,6 +1305,23 @@ impl<T, D, I> ExactSizeIterator for Cloned<I> where\n     I: ExactSizeIterator<Item=D>,\n {}\n \n+#[unstable(feature = \"core\", reason = \"trait is experimental\")]\n+impl<T, D, I> RandomAccessIterator for Cloned<I> where\n+    T: Clone,\n+    D: Deref<Target=T>,\n+    I: RandomAccessIterator<Item=D>\n+{\n+    #[inline]\n+    fn indexable(&self) -> usize {\n+        self.it.indexable()\n+    }\n+\n+    #[inline]\n+    fn idx(&mut self, index: usize) -> Option<T> {\n+        self.it.idx(index).cloned()\n+    }\n+}\n+\n /// An iterator that repeats endlessly\n #[derive(Clone)]\n #[must_use = \"iterator adaptors are lazy and do nothing unless consumed\"]"}, {"sha": "4eee0454f5d255cf9f2f8b0ed11d3ce58bb82e8f", "filename": "src/libcoretest/iter.rs", "status": "modified", "additions": 22, "deletions": 22, "changes": 44, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibcoretest%2Fiter.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibcoretest%2Fiter.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcoretest%2Fiter.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -91,7 +91,7 @@ fn test_iterator_chain() {\n     assert_eq!(i, expected.len());\n \n     let ys = count(30, 10).take(4);\n-    let mut it = xs.iter().map(|&x| x).chain(ys);\n+    let mut it = xs.iter().cloned().chain(ys);\n     let mut i = 0;\n     for x in it {\n         assert_eq!(x, expected[i]);\n@@ -119,7 +119,7 @@ fn test_iterator_enumerate() {\n #[test]\n fn test_iterator_peekable() {\n     let xs = vec![0, 1, 2, 3, 4, 5];\n-    let mut it = xs.iter().map(|&x|x).peekable();\n+    let mut it = xs.iter().cloned().peekable();\n \n     assert_eq!(it.len(), 6);\n     assert_eq!(it.peek().unwrap(), &0);\n@@ -259,7 +259,7 @@ fn test_inspect() {\n     let mut n = 0;\n \n     let ys = xs.iter()\n-               .map(|&x| x)\n+               .cloned()\n                .inspect(|_| n += 1)\n                .collect::<Vec<uint>>();\n \n@@ -329,33 +329,33 @@ fn test_iterator_len() {\n #[test]\n fn test_iterator_sum() {\n     let v: &[i32] = &[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10];\n-    assert_eq!(v[..4].iter().map(|&x| x).sum(), 6);\n-    assert_eq!(v.iter().map(|&x| x).sum(), 55);\n-    assert_eq!(v[..0].iter().map(|&x| x).sum(), 0);\n+    assert_eq!(v[..4].iter().cloned().sum(), 6);\n+    assert_eq!(v.iter().cloned().sum(), 55);\n+    assert_eq!(v[..0].iter().cloned().sum(), 0);\n }\n \n #[test]\n fn test_iterator_product() {\n     let v: &[i32] = &[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10];\n-    assert_eq!(v[..4].iter().map(|&x| x).product(), 0);\n-    assert_eq!(v[1..5].iter().map(|&x| x).product(), 24);\n-    assert_eq!(v[..0].iter().map(|&x| x).product(), 1);\n+    assert_eq!(v[..4].iter().cloned().product(), 0);\n+    assert_eq!(v[1..5].iter().cloned().product(), 24);\n+    assert_eq!(v[..0].iter().cloned().product(), 1);\n }\n \n #[test]\n fn test_iterator_max() {\n     let v: &[_] = &[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10];\n-    assert_eq!(v[..4].iter().map(|&x| x).max(), Some(3));\n-    assert_eq!(v.iter().map(|&x| x).max(), Some(10));\n-    assert_eq!(v[..0].iter().map(|&x| x).max(), None);\n+    assert_eq!(v[..4].iter().cloned().max(), Some(3));\n+    assert_eq!(v.iter().cloned().max(), Some(10));\n+    assert_eq!(v[..0].iter().cloned().max(), None);\n }\n \n #[test]\n fn test_iterator_min() {\n     let v: &[_] = &[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10];\n-    assert_eq!(v[..4].iter().map(|&x| x).min(), Some(0));\n-    assert_eq!(v.iter().map(|&x| x).min(), Some(0));\n-    assert_eq!(v[..0].iter().map(|&x| x).min(), None);\n+    assert_eq!(v[..4].iter().cloned().min(), Some(0));\n+    assert_eq!(v.iter().cloned().min(), Some(0));\n+    assert_eq!(v[..0].iter().cloned().min(), None);\n }\n \n #[test]\n@@ -373,7 +373,7 @@ fn test_iterator_size_hint() {\n     assert_eq!(c.clone().take_while(|_| false).size_hint(), (0, None));\n     assert_eq!(c.clone().skip_while(|_| false).size_hint(), (0, None));\n     assert_eq!(c.clone().enumerate().size_hint(), (uint::MAX, None));\n-    assert_eq!(c.clone().chain(vi.clone().map(|&i| i)).size_hint(), (uint::MAX, None));\n+    assert_eq!(c.clone().chain(vi.clone().cloned()).size_hint(), (uint::MAX, None));\n     assert_eq!(c.clone().zip(vi.clone()).size_hint(), (10, Some(10)));\n     assert_eq!(c.clone().scan(0, |_,_| Some(0)).size_hint(), (0, None));\n     assert_eq!(c.clone().filter(|_| false).size_hint(), (0, None));\n@@ -398,7 +398,7 @@ fn test_iterator_size_hint() {\n #[test]\n fn test_collect() {\n     let a = vec![1, 2, 3, 4, 5];\n-    let b: Vec<int> = a.iter().map(|&x| x).collect();\n+    let b: Vec<int> = a.iter().cloned().collect();\n     assert!(a == b);\n }\n \n@@ -471,7 +471,7 @@ fn test_rev() {\n     let mut it = xs.iter();\n     it.next();\n     it.next();\n-    assert!(it.rev().map(|&x| x).collect::<Vec<int>>() ==\n+    assert!(it.rev().cloned().collect::<Vec<int>>() ==\n             vec![16, 14, 12, 10, 8, 6]);\n }\n \n@@ -508,7 +508,7 @@ fn test_double_ended_map() {\n #[test]\n fn test_double_ended_enumerate() {\n     let xs = [1, 2, 3, 4, 5, 6];\n-    let mut it = xs.iter().map(|&x| x).enumerate();\n+    let mut it = xs.iter().cloned().enumerate();\n     assert_eq!(it.next(), Some((0, 1)));\n     assert_eq!(it.next(), Some((1, 2)));\n     assert_eq!(it.next_back(), Some((5, 6)));\n@@ -522,8 +522,8 @@ fn test_double_ended_enumerate() {\n fn test_double_ended_zip() {\n     let xs = [1, 2, 3, 4, 5, 6];\n     let ys = [1, 2, 3, 7];\n-    let a = xs.iter().map(|&x| x);\n-    let b = ys.iter().map(|&x| x);\n+    let a = xs.iter().cloned();\n+    let b = ys.iter().cloned();\n     let mut it = a.zip(b);\n     assert_eq!(it.next(), Some((1, 1)));\n     assert_eq!(it.next(), Some((2, 2)));\n@@ -713,7 +713,7 @@ fn test_random_access_inspect() {\n fn test_random_access_map() {\n     let xs = [1, 2, 3, 4, 5];\n \n-    let mut it = xs.iter().map(|x| *x);\n+    let mut it = xs.iter().cloned();\n     assert_eq!(xs.len(), it.indexable());\n     for (i, elt) in xs.iter().enumerate() {\n         assert_eq!(Some(*elt), it.idx(i));"}, {"sha": "701749ff3443f6e0280ad1308001854ea645cfe2", "filename": "src/librand/isaac.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrand%2Fisaac.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrand%2Fisaac.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrand%2Fisaac.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -215,7 +215,7 @@ impl<'a> SeedableRng<&'a [u32]> for IsaacRng {\n     fn reseed(&mut self, seed: &'a [u32]) {\n         // make the seed into [seed[0], seed[1], ..., seed[seed.len()\n         // - 1], 0, 0, ...], to fill rng.rsl.\n-        let seed_iter = seed.iter().map(|&x| x).chain(repeat(0u32));\n+        let seed_iter = seed.iter().cloned().chain(repeat(0u32));\n \n         for (rsl_elem, seed_elem) in self.rsl.iter_mut().zip(seed_iter) {\n             *rsl_elem = seed_elem;\n@@ -458,7 +458,7 @@ impl<'a> SeedableRng<&'a [u64]> for Isaac64Rng {\n     fn reseed(&mut self, seed: &'a [u64]) {\n         // make the seed into [seed[0], seed[1], ..., seed[seed.len()\n         // - 1], 0, 0, ...], to fill rng.rsl.\n-        let seed_iter = seed.iter().map(|&x| x).chain(repeat(0u64));\n+        let seed_iter = seed.iter().cloned().chain(repeat(0u64));\n \n         for (rsl_elem, seed_elem) in self.rsl.iter_mut().zip(seed_iter) {\n             *rsl_elem = seed_elem;"}, {"sha": "a3f7d57da67486b39a976a8289743612960ef5b4", "filename": "src/librustc/metadata/cstore.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmetadata%2Fcstore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmetadata%2Fcstore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmetadata%2Fcstore.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -139,8 +139,7 @@ impl CStore {\n     pub fn get_used_crate_source(&self, cnum: ast::CrateNum)\n                                      -> Option<CrateSource> {\n         self.used_crate_sources.borrow_mut()\n-            .iter().find(|source| source.cnum == cnum)\n-            .map(|source| source.clone())\n+            .iter().find(|source| source.cnum == cnum).cloned()\n     }\n \n     pub fn reset(&self) {\n@@ -218,7 +217,7 @@ impl CStore {\n \n     pub fn find_extern_mod_stmt_cnum(&self, emod_id: ast::NodeId)\n                                      -> Option<ast::CrateNum> {\n-        self.extern_mod_crate_map.borrow().get(&emod_id).map(|x| *x)\n+        self.extern_mod_crate_map.borrow().get(&emod_id).cloned()\n     }\n }\n "}, {"sha": "4544f283e1cc2ccfceaedc2f27c114890fe9f0f1", "filename": "src/librustc/middle/check_match.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Fcheck_match.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Fcheck_match.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fcheck_match.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -76,7 +76,7 @@ impl<'a> fmt::Debug for Matrix<'a> {\n             pretty_printed_matrix.iter().map(|row| row[col].len()).max().unwrap_or(0)\n         }).collect();\n \n-        let total_width = column_widths.iter().map(|n| *n).sum() + column_count * 3 + 1;\n+        let total_width = column_widths.iter().cloned().sum() + column_count * 3 + 1;\n         let br = repeat('+').take(total_width).collect::<String>();\n         try!(write!(f, \"{}\\n\", br));\n         for row in pretty_printed_matrix {"}, {"sha": "456d4a3a86e39336f57bad24ba88dcbdd6fba1bd", "filename": "src/librustc/middle/const_eval.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Fconst_eval.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Fconst_eval.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fconst_eval.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -501,7 +501,7 @@ fn lit_to_const(lit: &ast::Lit, ty_hint: Option<Ty>) -> const_val {\n     match lit.node {\n         ast::LitStr(ref s, _) => const_str((*s).clone()),\n         ast::LitBinary(ref data) => {\n-            const_binary(Rc::new(data.iter().map(|x| *x).collect()))\n+            const_binary(data.clone())\n         }\n         ast::LitByte(n) => const_uint(n as u64),\n         ast::LitChar(n) => const_uint(n as u64),"}, {"sha": "307423734b3bf7a932d97cb3f378636d58974ba4", "filename": "src/librustc/middle/dataflow.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Fdataflow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Fdataflow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fdataflow.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -89,7 +89,7 @@ struct PropagationContext<'a, 'b: 'a, 'tcx: 'b, O: 'a> {\n }\n \n fn to_cfgidx_or_die(id: ast::NodeId, index: &NodeMap<CFGIndex>) -> CFGIndex {\n-    let opt_cfgindex = index.get(&id).map(|&i|i);\n+    let opt_cfgindex = index.get(&id).cloned();\n     opt_cfgindex.unwrap_or_else(|| {\n         panic!(\"nodeid_to_index does not have entry for NodeId {}\", id);\n     })\n@@ -400,7 +400,7 @@ impl<'a, 'tcx, O:DataFlowOperator> DataFlowContext<'a, 'tcx, O> {\n \n             let mut changed = false;\n             for &node_id in &edge.data.exiting_scopes {\n-                let opt_cfg_idx = self.nodeid_to_index.get(&node_id).map(|&i|i);\n+                let opt_cfg_idx = self.nodeid_to_index.get(&node_id).cloned();\n                 match opt_cfg_idx {\n                     Some(cfg_idx) => {\n                         let (start, end) = self.compute_id_range(cfg_idx);"}, {"sha": "ad9f4eade5c90d25538240080640f300aace049a", "filename": "src/librustc/middle/dependency_format.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Fdependency_format.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Fdependency_format.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fdependency_format.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -158,7 +158,7 @@ fn calculate_type(sess: &session::Session,\n \n     // Collect what we've got so far in the return vector.\n     let mut ret = (1..sess.cstore.next_crate_num()).map(|i| {\n-        match formats.get(&i).map(|v| *v) {\n+        match formats.get(&i).cloned() {\n             v @ Some(cstore::RequireDynamic) => v,\n             _ => None,\n         }"}, {"sha": "49bd2e67a19181dfd45115e341488c7c58f45573", "filename": "src/librustc/middle/infer/error_reporting.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Finfer%2Ferror_reporting.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Finfer%2Ferror_reporting.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Finfer%2Ferror_reporting.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -924,7 +924,7 @@ impl<'a, 'tcx> Rebuilder<'a, 'tcx> {\n \n     fn rebuild(&self)\n                -> (ast::FnDecl, Option<ast::ExplicitSelf_>, ast::Generics) {\n-        let mut expl_self_opt = self.expl_self_opt.map(|x| x.clone());\n+        let mut expl_self_opt = self.expl_self_opt.cloned();\n         let mut inputs = self.fn_decl.inputs.clone();\n         let mut output = self.fn_decl.output.clone();\n         let mut ty_params = self.generics.ty_params.clone();"}, {"sha": "ce8f0d87e564c24511c7a3a7cddbf0a8e7231a96", "filename": "src/librustc/middle/lang_items.rs", "status": "modified", "additions": 5, "deletions": 11, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Flang_items.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Flang_items.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Flang_items.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -147,18 +147,12 @@ struct LanguageItemCollector<'a> {\n \n impl<'a, 'v> Visitor<'v> for LanguageItemCollector<'a> {\n     fn visit_item(&mut self, item: &ast::Item) {\n-        match extract(&item.attrs) {\n-            Some(value) => {\n-                let item_index = self.item_refs.get(&value[]).map(|x| *x);\n-\n-                match item_index {\n-                    Some(item_index) => {\n-                        self.collect_item(item_index, local_def(item.id), item.span)\n-                    }\n-                    None => {}\n-                }\n+        if let Some(value) = extract(&item.attrs) {\n+            let item_index = self.item_refs.get(&value[]).cloned();\n+\n+            if let Some(item_index) = item_index {\n+                self.collect_item(item_index, local_def(item.id), item.span)\n             }\n-            None => {}\n         }\n \n         visit::walk_item(self, item);"}, {"sha": "e539f6ae6cb9382898b2167093e91fe5b288e3db", "filename": "src/librustc/middle/region.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Fregion.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Fregion.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fregion.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -407,7 +407,7 @@ impl RegionMaps {\n \n     pub fn opt_encl_scope(&self, id: CodeExtent) -> Option<CodeExtent> {\n         //! Returns the narrowest scope that encloses `id`, if any.\n-        self.scope_map.borrow().get(&id).map(|x| *x)\n+        self.scope_map.borrow().get(&id).cloned()\n     }\n \n     #[allow(dead_code)] // used in middle::cfg"}, {"sha": "3ba08c1032031075224aaa0dddcd1ac67902f5d4", "filename": "src/librustc/middle/resolve_lifetime.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Fresolve_lifetime.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Fresolve_lifetime.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fresolve_lifetime.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -562,7 +562,7 @@ pub fn early_bound_lifetimes<'a>(generics: &'a ast::Generics) -> Vec<ast::Lifeti\n \n     generics.lifetimes.iter()\n         .filter(|l| referenced_idents.iter().any(|&i| i == l.lifetime.name))\n-        .map(|l| (*l).clone())\n+        .cloned()\n         .collect()\n }\n "}, {"sha": "04fd03ab34224a3af51bfeed5ab69aad2c355bf4", "filename": "src/librustc/middle/subst.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Fsubst.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Fsubst.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fsubst.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -113,7 +113,7 @@ impl<'tcx> Substs<'tcx> {\n     }\n \n     pub fn self_ty(&self) -> Option<Ty<'tcx>> {\n-        self.types.get_self().map(|&t| t)\n+        self.types.get_self().cloned()\n     }\n \n     pub fn with_self_ty(&self, self_ty: Ty<'tcx>) -> Substs<'tcx> {"}, {"sha": "7442dd47f7bb7fab3e0794fc23b449806d3c44c8", "filename": "src/librustc/middle/traits/object_safety.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Ftraits%2Fobject_safety.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Ftraits%2Fobject_safety.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Ftraits%2Fobject_safety.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -57,7 +57,7 @@ pub fn is_object_safe<'tcx>(tcx: &ty::ctxt<'tcx>,\n {\n     // Because we query yes/no results frequently, we keep a cache:\n     let cached_result =\n-        tcx.object_safety_cache.borrow().get(&trait_ref.def_id()).map(|&r| r);\n+        tcx.object_safety_cache.borrow().get(&trait_ref.def_id()).cloned();\n \n     let result =\n         cached_result.unwrap_or_else(|| {"}, {"sha": "2c4aad4663b832b93e3e2ea3d3160e2f68c969c5", "filename": "src/librustc/middle/traits/select.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Ftraits%2Fselect.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Ftraits%2Fselect.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Ftraits%2Fselect.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -738,7 +738,7 @@ impl<'cx, 'tcx> SelectionContext<'cx, 'tcx> {\n     {\n         let cache = self.pick_candidate_cache();\n         let hashmap = cache.hashmap.borrow();\n-        hashmap.get(&cache_fresh_trait_pred.0.trait_ref).map(|c| (*c).clone())\n+        hashmap.get(&cache_fresh_trait_pred.0.trait_ref).cloned()\n     }\n \n     fn insert_candidate_cache(&mut self,\n@@ -1565,7 +1565,7 @@ impl<'cx, 'tcx> SelectionContext<'cx, 'tcx> {\n                     ty::substd_enum_variants(self.tcx(), def_id, substs)\n                     .iter()\n                     .flat_map(|variant| variant.args.iter())\n-                    .map(|&ty| ty)\n+                    .cloned()\n                     .collect();\n                 nominal(self, bound, def_id, types)\n             }"}, {"sha": "df30db2e7047bbbc70e632237ca54614434c0fba", "filename": "src/librustc/middle/ty.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Fty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Fmiddle%2Fty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fty.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -2832,7 +2832,7 @@ pub fn mk_ctor_fn<'tcx>(cx: &ctxt<'tcx>,\n                         def_id: ast::DefId,\n                         input_tys: &[Ty<'tcx>],\n                         output: Ty<'tcx>) -> Ty<'tcx> {\n-    let input_args = input_tys.iter().map(|ty| *ty).collect();\n+    let input_args = input_tys.iter().cloned().collect();\n     mk_bare_fn(cx,\n                Some(def_id),\n                cx.mk_bare_fn(BareFnTy {\n@@ -3801,7 +3801,7 @@ pub fn is_type_representable<'tcx>(cx: &ctxt<'tcx>, sp: Span, ty: Ty<'tcx>)\n                                        -> Representability {\n         match ty.sty {\n             ty_tup(ref ts) => {\n-                find_nonrepresentable(cx, sp, seen, ts.iter().map(|ty| *ty))\n+                find_nonrepresentable(cx, sp, seen, ts.iter().cloned())\n             }\n             // Fixed-length vectors.\n             // FIXME(#11924) Behavior undecided for zero-length vectors.\n@@ -4108,7 +4108,7 @@ pub fn positional_element_ty<'tcx>(cx: &ctxt<'tcx>,\n                                    variant: Option<ast::DefId>) -> Option<Ty<'tcx>> {\n \n     match (&ty.sty, variant) {\n-        (&ty_tup(ref v), None) => v.get(i).map(|&t| t),\n+        (&ty_tup(ref v), None) => v.get(i).cloned(),\n \n \n         (&ty_struct(def_id, substs), None) => lookup_struct_fields(cx, def_id)\n@@ -4929,7 +4929,7 @@ pub fn note_and_explain_type_err(cx: &ctxt, err: &type_err) {\n }\n \n pub fn provided_source(cx: &ctxt, id: ast::DefId) -> Option<ast::DefId> {\n-    cx.provided_method_sources.borrow().get(&id).map(|x| *x)\n+    cx.provided_method_sources.borrow().get(&id).cloned()\n }\n \n pub fn provided_trait_methods<'tcx>(cx: &ctxt<'tcx>, id: ast::DefId)\n@@ -6600,7 +6600,7 @@ pub fn accumulate_lifetimes_in_type(accumulator: &mut Vec<ty::Region>,\n }\n \n /// A free variable referred to in a function.\n-#[derive(Copy, RustcEncodable, RustcDecodable)]\n+#[derive(Copy, Clone, RustcEncodable, RustcDecodable)]\n pub struct Freevar {\n     /// The variable being accessed free.\n     pub def: def::Def,"}, {"sha": "a6d8bc24da76f501eac9e2cd2a63ecaa35cd12a4", "filename": "src/librustc/util/common.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Futil%2Fcommon.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc%2Futil%2Fcommon.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Futil%2Fcommon.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -214,7 +214,7 @@ pub fn memoized<T, U, S, F>(cache: &RefCell<HashMap<T, U, S>>, arg: T, f: F) ->\n           F: FnOnce(T) -> U,\n {\n     let key = arg.clone();\n-    let result = cache.borrow().get(&key).map(|result| result.clone());\n+    let result = cache.borrow().get(&key).cloned();\n     match result {\n         Some(result) => result,\n         None => {"}, {"sha": "3de69bd72e1e43d87bfc55e6a0558ab2f8cb99f1", "filename": "src/librustc_back/rpath.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc_back%2Frpath.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc_back%2Frpath.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Frpath.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -40,10 +40,7 @@ pub fn get_rpath_flags<F, G>(config: RPathConfig<F, G>) -> Vec<String> where\n     debug!(\"preparing the RPATH!\");\n \n     let libs = config.used_crates.clone();\n-    let libs = libs.into_iter().filter_map(|(_, l)| {\n-        l.map(|p| p.clone())\n-    }).collect::<Vec<_>>();\n-\n+    let libs = libs.into_iter().filter_map(|(_, l)| l).collect::<Vec<_>>();\n     let rpaths = get_rpaths(config, &libs[]);\n     flags.push_all(&rpaths_to_flags(&rpaths[])[]);\n     flags"}, {"sha": "e614f87c9809997afcb6d3f667f975f0e6ee8a4f", "filename": "src/librustc_driver/test.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc_driver%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc_driver%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_driver%2Ftest.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -254,7 +254,7 @@ impl<'a, 'tcx> Env<'a, 'tcx> {\n                 output_ty: Ty<'tcx>)\n                 -> Ty<'tcx>\n     {\n-        let input_args = input_tys.iter().map(|ty| *ty).collect();\n+        let input_args = input_tys.iter().cloned().collect();\n         ty::mk_bare_fn(self.infcx.tcx,\n                        None,\n                        self.infcx.tcx.mk_bare_fn(ty::BareFnTy {"}, {"sha": "337ba77fe7fbb9a31c18755e5036f7c483a1ee1e", "filename": "src/librustc_resolve/lib.rs", "status": "modified", "additions": 6, "deletions": 9, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc_resolve%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc_resolve%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Flib.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -1920,18 +1920,15 @@ impl<'a, 'tcx> Resolver<'a, 'tcx> {\n                                 -> ResolveResult<(Rc<Module>, LastPrivate)> {\n         fn search_parent_externals(needle: Name, module: &Rc<Module>)\n                                 -> Option<Rc<Module>> {\n-            module.external_module_children.borrow()\n-                                            .get(&needle).cloned()\n-                                            .map(|_| module.clone())\n-                                            .or_else(|| {\n-                match module.parent_link.clone() {\n-                    ModuleParentLink(parent, _) => {\n-                        search_parent_externals(needle,\n-                                                &parent.upgrade().unwrap())\n+            match module.external_module_children.borrow().get(&needle) {\n+                Some(_) => Some(module.clone()),\n+                None => match module.parent_link {\n+                    ModuleParentLink(ref parent, _) => {\n+                        search_parent_externals(needle, &parent.upgrade().unwrap())\n                     }\n                    _ => None\n                 }\n-            })\n+            }\n         }\n \n         let mut search_module = module_;"}, {"sha": "62d4dbeb0ad0c94c659206b6b05f48657667724e", "filename": "src/librustc_trans/trans/base.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc_trans%2Ftrans%2Fbase.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc_trans%2Ftrans%2Fbase.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Ftrans%2Fbase.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -3211,7 +3211,7 @@ pub fn trans_crate<'tcx>(analysis: ty::CrateAnalysis<'tcx>)\n     reachable.push(\"rust_eh_personality_catch\".to_string());\n \n     if codegen_units > 1 {\n-        internalize_symbols(&shared_ccx, &reachable.iter().map(|x| x.clone()).collect());\n+        internalize_symbols(&shared_ccx, &reachable.iter().cloned().collect());\n     }\n \n     let metadata_module = ModuleTranslation {"}, {"sha": "ed75330ffcc70b46402258308e90f2288ec7e50a", "filename": "src/librustc_trans/trans/closure.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc_trans%2Ftrans%2Fclosure.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc_trans%2Ftrans%2Fclosure.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Ftrans%2Fclosure.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -208,7 +208,7 @@ pub fn trans_closure_expr<'a, 'tcx>(dest: Dest<'a, 'tcx>,\n     let function_type = typer.closure_type(closure_id, param_substs);\n \n     let freevars: Vec<ty::Freevar> =\n-        ty::with_freevars(tcx, id, |fv| fv.iter().map(|&fv| fv).collect());\n+        ty::with_freevars(tcx, id, |fv| fv.iter().cloned().collect());\n \n     let sig = ty::erase_late_bound_regions(tcx, &function_type.sig);\n "}, {"sha": "306d0f610c6577dd3156ef8159d19052365920e5", "filename": "src/librustc_trans/trans/expr.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc_trans%2Ftrans%2Fexpr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc_trans%2Ftrans%2Fexpr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Ftrans%2Fexpr.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -1197,7 +1197,7 @@ fn trans_rvalue_dps_unadjusted<'blk, 'tcx>(bcx: Block<'blk, 'tcx>,\n                 let trait_ref =\n                     bcx.tcx().object_cast_map.borrow()\n                                              .get(&expr.id)\n-                                             .map(|t| (*t).clone())\n+                                             .cloned()\n                                              .unwrap();\n                 let trait_ref = bcx.monomorphize(&trait_ref);\n                 let datum = unpack_datum!(bcx, trans(bcx, &**val));"}, {"sha": "546c62e5dd24743b3f6b108a6dec3eba67512096", "filename": "src/librustc_trans/trans/type_of.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc_trans%2Ftrans%2Ftype_of.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc_trans%2Ftrans%2Ftype_of.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Ftrans%2Ftype_of.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -67,7 +67,7 @@ pub fn untuple_arguments_if_necessary<'a, 'tcx>(ccx: &CrateContext<'a, 'tcx>,\n                                                 abi: abi::Abi)\n                                                 -> Vec<Ty<'tcx>> {\n     if abi != abi::RustCall {\n-        return inputs.iter().map(|x| (*x).clone()).collect()\n+        return inputs.iter().cloned().collect()\n     }\n \n     if inputs.len() == 0 {"}, {"sha": "f6764de97b78e4f5c8e520fe229337739d473b12", "filename": "src/librustc_typeck/check/mod.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fmod.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -640,7 +640,7 @@ fn check_fn<'a, 'tcx>(ccx: &'a CrateCtxt<'a, 'tcx>,\n     // Remember return type so that regionck can access it later.\n     let mut fn_sig_tys: Vec<Ty> =\n         arg_tys.iter()\n-        .map(|&ty| ty)\n+        .cloned()\n         .collect();\n \n     if let ty::FnConverging(ret_ty) = ret_ty {\n@@ -3220,7 +3220,7 @@ fn check_expr_with_unifier<'a, 'tcx, F>(fcx: &FnCtxt<'a, 'tcx>,\n         for field in ast_fields {\n             let mut expected_field_type = tcx.types.err;\n \n-            let pair = class_field_map.get(&field.ident.node.name).map(|x| *x);\n+            let pair = class_field_map.get(&field.ident.node.name).cloned();\n             match pair {\n                 None => {\n                     fcx.type_error_message(\n@@ -3852,7 +3852,7 @@ fn check_expr_with_unifier<'a, 'tcx, F>(fcx: &FnCtxt<'a, 'tcx>,\n       }\n       ast::ExprStruct(ref path, ref fields, ref base_expr) => {\n         // Resolve the path.\n-        let def = tcx.def_map.borrow().get(&id).map(|i| *i);\n+        let def = tcx.def_map.borrow().get(&id).cloned();\n         let struct_id = match def {\n             Some(def::DefVariant(enum_id, variant_id, true)) => {\n                 check_struct_enum_variant(fcx, id, expr.span, enum_id,"}, {"sha": "722f14fa6d4c7b0dcff44ad75f8d7f7bfa8686c2", "filename": "src/librustdoc/passes.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustdoc%2Fpasses.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustdoc%2Fpasses.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -293,7 +293,7 @@ pub fn collapse_docs(krate: clean::Crate) -> plugins::PluginResult {\n             let mut a: Vec<clean::Attribute> = i.attrs.iter().filter(|&a| match a {\n                 &clean::NameValue(ref x, _) if \"doc\" == *x => false,\n                 _ => true\n-            }).map(|x| x.clone()).collect();\n+            }).cloned().collect();\n             if docstr.len() > 0 {\n                 a.push(clean::NameValue(\"doc\".to_string(), docstr));\n             }"}, {"sha": "c52b0bab1fa8b800129e3688e7423bca40dba82d", "filename": "src/librustdoc/visit_ast.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustdoc%2Fvisit_ast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibrustdoc%2Fvisit_ast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fvisit_ast.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -333,7 +333,7 @@ impl<'a, 'tcx> RustdocVisitor<'a, 'tcx> {\n                     name: name,\n                     items: items.clone(),\n                     generics: gen.clone(),\n-                    bounds: b.iter().map(|x| (*x).clone()).collect(),\n+                    bounds: b.iter().cloned().collect(),\n                     id: item.id,\n                     attrs: item.attrs.clone(),\n                     whence: item.span,"}, {"sha": "8676586e7dc2a7e32971773e026af9537bdbea25", "filename": "src/libstd/env.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibstd%2Fenv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibstd%2Fenv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fenv.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -926,7 +926,7 @@ mod tests {\n     #[cfg(unix)]\n     fn join_paths_unix() {\n         fn test_eq(input: &[&str], output: &str) -> bool {\n-            &*join_paths(input.iter().map(|s| *s)).unwrap() ==\n+            &*join_paths(input.iter().cloned()).unwrap() ==\n                 OsStr::from_str(output)\n         }\n \n@@ -935,14 +935,14 @@ mod tests {\n                          \"/bin:/usr/bin:/usr/local/bin\"));\n         assert!(test_eq(&[\"\", \"/bin\", \"\", \"\", \"/usr/bin\", \"\"],\n                          \":/bin:::/usr/bin:\"));\n-        assert!(join_paths([\"/te:st\"].iter().map(|s| *s)).is_err());\n+        assert!(join_paths([\"/te:st\"].iter().cloned()).is_err());\n     }\n \n     #[test]\n     #[cfg(windows)]\n     fn join_paths_windows() {\n         fn test_eq(input: &[&str], output: &str) -> bool {\n-            &*join_paths(input.iter().map(|s| *s)).unwrap() ==\n+            &*join_paths(input.iter().cloned()).unwrap() ==\n                 OsStr::from_str(output)\n         }\n \n@@ -953,6 +953,6 @@ mod tests {\n                         r\";c:\\windows;;;c:\\;\"));\n         assert!(test_eq(&[r\"c:\\te;st\", r\"c:\\\"],\n                         r#\"\"c:\\te;st\";c:\\\"#));\n-        assert!(join_paths([r#\"c:\\te\"st\"#].iter().map(|s| *s)).is_err());\n+        assert!(join_paths([r#\"c:\\te\"st\"#].iter().cloned()).is_err());\n     }\n     }"}, {"sha": "35bffa689f31e66a8ff3d4d894310613b984d932", "filename": "src/libstd/old_path/posix.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibstd%2Fold_path%2Fposix.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibstd%2Fold_path%2Fposix.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fold_path%2Fposix.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -1172,7 +1172,7 @@ mod tests {\n                     let exp: &[&[u8]] = &[$($exp),*];\n                     assert_eq!(comps, exp);\n                     let comps = path.components().rev().collect::<Vec<&[u8]>>();\n-                    let exp = exp.iter().rev().map(|&x|x).collect::<Vec<&[u8]>>();\n+                    let exp = exp.iter().rev().cloned().collect::<Vec<&[u8]>>();\n                     assert_eq!(comps, exp)\n                 }\n             )\n@@ -1204,7 +1204,7 @@ mod tests {\n                     let exp: &[Option<&str>] = &$exp;\n                     assert_eq!(comps, exp);\n                     let comps = path.str_components().rev().collect::<Vec<Option<&str>>>();\n-                    let exp = exp.iter().rev().map(|&x|x).collect::<Vec<Option<&str>>>();\n+                    let exp = exp.iter().rev().cloned().collect::<Vec<Option<&str>>>();\n                     assert_eq!(comps, exp);\n                 }\n             )"}, {"sha": "c9d6eeda7620ab4542375615357def56a8b2e503", "filename": "src/libstd/old_path/windows.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibstd%2Fold_path%2Fwindows.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibstd%2Fold_path%2Fwindows.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fold_path%2Fwindows.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -2226,7 +2226,7 @@ mod tests {\n                     assert_eq!(comps, exp);\n                     let comps = path.str_components().rev().map(|x|x.unwrap())\n                                 .collect::<Vec<&str>>();\n-                    let exp = exp.iter().rev().map(|&x|x).collect::<Vec<&str>>();\n+                    let exp = exp.iter().rev().cloned().collect::<Vec<&str>>();\n                     assert_eq!(comps, exp);\n                 }\n             );\n@@ -2282,7 +2282,7 @@ mod tests {\n                     let exp: &[&[u8]] = &$exp;\n                     assert_eq!(comps, exp);\n                     let comps = path.components().rev().collect::<Vec<&[u8]>>();\n-                    let exp = exp.iter().rev().map(|&x|x).collect::<Vec<&[u8]>>();\n+                    let exp = exp.iter().rev().cloned().collect::<Vec<&[u8]>>();\n                     assert_eq!(comps, exp);\n                 }\n             )"}, {"sha": "5b888c7612d195e214d59f60d9b0467b3593f124", "filename": "src/libstd/rand/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibstd%2Frand%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibstd%2Frand%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Frand%2Fmod.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -547,7 +547,7 @@ mod test {\n     #[test]\n     fn test_choose() {\n         let mut r = thread_rng();\n-        assert_eq!(r.choose(&[1, 1, 1]).map(|&x|x), Some(1));\n+        assert_eq!(r.choose(&[1, 1, 1]).cloned(), Some(1));\n \n         let v: &[int] = &[];\n         assert_eq!(r.choose(v), None);"}, {"sha": "6535705388d0104437377181a351bd19ac87660a", "filename": "src/libsyntax/ast_map/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fast_map%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fast_map%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fast_map%2Fmod.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -251,7 +251,7 @@ impl<'ast> Map<'ast> {\n     }\n \n     fn find_entry(&self, id: NodeId) -> Option<MapEntry<'ast>> {\n-        self.map.borrow().get(id as usize).map(|e| *e)\n+        self.map.borrow().get(id as usize).cloned()\n     }\n \n     pub fn krate(&self) -> &'ast Crate {"}, {"sha": "a6cfd1a5a9ac3c1e612b02995457433ee344987d", "filename": "src/libsyntax/diagnostics/registry.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fdiagnostics%2Fregistry.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fdiagnostics%2Fregistry.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fdiagnostics%2Fregistry.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -17,10 +17,10 @@ pub struct Registry {\n \n impl Registry {\n     pub fn new(descriptions: &[(&'static str, &'static str)]) -> Registry {\n-        Registry { descriptions: descriptions.iter().map(|&tuple| tuple).collect() }\n+        Registry { descriptions: descriptions.iter().cloned().collect() }\n     }\n \n     pub fn find_description(&self, code: &str) -> Option<&'static str> {\n-        self.descriptions.get(code).map(|desc| *desc)\n+        self.descriptions.get(code).cloned()\n     }\n }"}, {"sha": "d4ccabbd63b4a2edfb5f411a13b06b317e27440c", "filename": "src/libsyntax/ext/base.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fext%2Fbase.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fext%2Fbase.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fext%2Fbase.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -640,7 +640,7 @@ impl<'a> ExtCtxt<'a> {\n     pub fn mod_path(&self) -> Vec<ast::Ident> {\n         let mut v = Vec::new();\n         v.push(token::str_to_ident(&self.ecfg.crate_name[]));\n-        v.extend(self.mod_path.iter().map(|a| *a));\n+        v.extend(self.mod_path.iter().cloned());\n         return v;\n     }\n     pub fn bt_push(&mut self, ei: ExpnInfo) {"}, {"sha": "8b4eaab386d007c867f57ee4e6014d765df44f6e", "filename": "src/libsyntax/ext/deriving/generic/mod.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fext%2Fderiving%2Fgeneric%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fext%2Fderiving%2Fgeneric%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fext%2Fderiving%2Fgeneric%2Fmod.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -367,7 +367,7 @@ impl<'a> TraitDef<'a> {\n                 \"allow\" | \"warn\" | \"deny\" | \"forbid\" => true,\n                 _ => false,\n             }\n-        }).map(|a| a.clone()));\n+        }).cloned());\n         push(P(ast::Item {\n             attrs: attrs,\n             ..(*newitem).clone()\n@@ -410,7 +410,7 @@ impl<'a> TraitDef<'a> {\n         let mut ty_params = ty_params.into_vec();\n \n         // Copy the lifetimes\n-        lifetimes.extend(generics.lifetimes.iter().map(|l| (*l).clone()));\n+        lifetimes.extend(generics.lifetimes.iter().cloned());\n \n         // Create the type parameters.\n         ty_params.extend(generics.ty_params.iter().map(|ty_param| {\n@@ -445,14 +445,14 @@ impl<'a> TraitDef<'a> {\n                         span: self.span,\n                         bound_lifetimes: wb.bound_lifetimes.clone(),\n                         bounded_ty: wb.bounded_ty.clone(),\n-                        bounds: OwnedSlice::from_vec(wb.bounds.iter().map(|b| b.clone()).collect())\n+                        bounds: OwnedSlice::from_vec(wb.bounds.iter().cloned().collect())\n                     })\n                 }\n                 ast::WherePredicate::RegionPredicate(ref rb) => {\n                     ast::WherePredicate::RegionPredicate(ast::WhereRegionPredicate {\n                         span: self.span,\n                         lifetime: rb.lifetime,\n-                        bounds: rb.bounds.iter().map(|b| b.clone()).collect()\n+                        bounds: rb.bounds.iter().cloned().collect()\n                     })\n                 }\n                 ast::WherePredicate::EqPredicate(ref we) => {\n@@ -500,7 +500,7 @@ impl<'a> TraitDef<'a> {\n         let opt_trait_ref = Some(trait_ref);\n         let ident = ast_util::impl_pretty_name(&opt_trait_ref, &*self_type);\n         let mut a = vec![attr];\n-        a.extend(self.attributes.iter().map(|a| a.clone()));\n+        a.extend(self.attributes.iter().cloned());\n         cx.item(\n             self.span,\n             ident,"}, {"sha": "d1dee115b6bcdf247054cb829dc21459c72b3246", "filename": "src/libsyntax/ext/source_util.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fext%2Fsource_util.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fext%2Fsource_util.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fext%2Fsource_util.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -179,7 +179,7 @@ pub fn expand_include_bytes(cx: &mut ExtCtxt, sp: Span, tts: &[ast::TokenTree])\n             return DummyResult::expr(sp);\n         }\n         Ok(bytes) => {\n-            let bytes = bytes.iter().map(|x| *x).collect();\n+            let bytes = bytes.iter().cloned().collect();\n             base::MacExpr::new(cx.expr_lit(sp, ast::LitBinary(Rc::new(bytes))))\n         }\n     }"}, {"sha": "a3224c25d09579752e78d2642acb941d64fc1f60", "filename": "src/libsyntax/ext/tt/macro_parser.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fext%2Ftt%2Fmacro_parser.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fext%2Ftt%2Fmacro_parser.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fext%2Ftt%2Fmacro_parser.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -283,7 +283,7 @@ pub fn parse(sess: &ParseSess,\n              -> ParseResult {\n     let mut cur_eis = Vec::new();\n     cur_eis.push(initial_matcher_pos(Rc::new(ms.iter()\n-                                                .map(|x| (*x).clone())\n+                                                .cloned()\n                                                 .collect()),\n                                      None,\n                                      rdr.peek().sp.lo));"}, {"sha": "1a6cf7d07f19da2820520a4b40334d33071c7e51", "filename": "src/libsyntax/ext/tt/macro_rules.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fext%2Ftt%2Fmacro_rules.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fext%2Ftt%2Fmacro_rules.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fext%2Ftt%2Fmacro_rules.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -159,7 +159,7 @@ fn generic_extension<'cx>(cx: &'cx ExtCtxt,\n                                                       None,\n                                                       None,\n                                                       arg.iter()\n-                                                         .map(|x| (*x).clone())\n+                                                         .cloned()\n                                                          .collect(),\n                                                       true);\n             match parse(cx.parse_sess(), cx.cfg(), arg_rdr, lhs_tt) {"}, {"sha": "c0823e04288e31bb078dd6e66607bdd1fc00831b", "filename": "src/libsyntax/parse/lexer/comments.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fparse%2Flexer%2Fcomments.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fparse%2Flexer%2Fcomments.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Flexer%2Fcomments.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -61,7 +61,7 @@ pub fn doc_comment_style(comment: &str) -> ast::AttrStyle {\n \n pub fn strip_doc_comment_decoration(comment: &str) -> String {\n     /// remove whitespace-only lines from the start/end of lines\n-    fn vertical_trim(lines: Vec<String> ) -> Vec<String> {\n+    fn vertical_trim(lines: Vec<String>) -> Vec<String> {\n         let mut i = 0;\n         let mut j = lines.len();\n         // first line of all-stars should be omitted\n@@ -82,7 +82,7 @@ pub fn strip_doc_comment_decoration(comment: &str) -> String {\n         while j > i && lines[j - 1].trim().is_empty() {\n             j -= 1;\n         }\n-        return lines[i..j].iter().map(|x| (*x).clone()).collect();\n+        lines[i..j].iter().cloned().collect()\n     }\n \n     /// remove a \"[ \\t]*\\*\" block from each line, if possible"}, {"sha": "f6ec4816b63fc5ac442c8c5b3ba51fa41f57b825", "filename": "src/libsyntax/parse/parser.rs", "status": "modified", "additions": 5, "deletions": 6, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fparse%2Fparser.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fparse%2Fparser.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Fparser.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -240,9 +240,8 @@ macro_rules! maybe_whole {\n \n fn maybe_append(mut lhs: Vec<Attribute>, rhs: Option<Vec<Attribute>>)\n                 -> Vec<Attribute> {\n-    match rhs {\n-        Some(ref attrs) => lhs.extend(attrs.iter().map(|a| a.clone())),\n-        None => {}\n+    if let Some(ref attrs) = rhs {\n+        lhs.extend(attrs.iter().cloned())\n     }\n     lhs\n }\n@@ -467,7 +466,7 @@ impl<'a> Parser<'a> {\n         debug!(\"commit_expr {:?}\", e);\n         if let ExprPath(..) = e.node {\n             // might be unit-struct construction; check for recoverableinput error.\n-            let mut expected = edible.iter().map(|x| x.clone()).collect::<Vec<_>>();\n+            let mut expected = edible.iter().cloned().collect::<Vec<_>>();\n             expected.push_all(inedible);\n             self.check_for_erroneous_unit_struct_expecting(&expected[]);\n         }\n@@ -485,7 +484,7 @@ impl<'a> Parser<'a> {\n         if self.last_token\n                .as_ref()\n                .map_or(false, |t| t.is_ident() || t.is_path()) {\n-            let mut expected = edible.iter().map(|x| x.clone()).collect::<Vec<_>>();\n+            let mut expected = edible.iter().cloned().collect::<Vec<_>>();\n             expected.push_all(&inedible[]);\n             self.check_for_erroneous_unit_struct_expecting(\n                 &expected[]);\n@@ -1706,7 +1705,7 @@ impl<'a> Parser<'a> {\n                         (true, LitBinary(parse::binary_lit(i.as_str()))),\n                     token::BinaryRaw(i, _) =>\n                         (true,\n-                         LitBinary(Rc::new(i.as_str().as_bytes().iter().map(|&x| x).collect()))),\n+                         LitBinary(Rc::new(i.as_str().as_bytes().iter().cloned().collect()))),\n                 };\n \n                 if suffix_illegal {"}, {"sha": "7742185897612adbfbdb02a5c7208afac96e9042", "filename": "src/libsyntax/print/pprust.rs", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fprint%2Fpprust.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibsyntax%2Fprint%2Fpprust.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fprint%2Fpprust.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -983,15 +983,14 @@ impl<'a> State<'a> {\n                 try!(self.word_nbsp(\"trait\"));\n                 try!(self.print_ident(item.ident));\n                 try!(self.print_generics(generics));\n-                let bounds: Vec<_> = bounds.iter().map(|b| b.clone()).collect();\n                 let mut real_bounds = Vec::with_capacity(bounds.len());\n-                for b in bounds {\n-                    if let TraitTyParamBound(ref ptr, ast::TraitBoundModifier::Maybe) = b {\n+                for b in bounds.iter() {\n+                    if let TraitTyParamBound(ref ptr, ast::TraitBoundModifier::Maybe) = *b {\n                         try!(space(&mut self.s));\n                         try!(self.word_space(\"for ?\"));\n                         try!(self.print_trait_ref(&ptr.trait_ref));\n                     } else {\n-                        real_bounds.push(b);\n+                        real_bounds.push(b.clone());\n                     }\n                 }\n                 try!(self.print_bounds(\":\", &real_bounds[]));"}, {"sha": "0b577f8de74c2a9b2e8178584173c29e8d134b7a", "filename": "src/libterm/terminfo/parm.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibterm%2Fterminfo%2Fparm.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Flibterm%2Fterminfo%2Fparm.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibterm%2Fterminfo%2Fparm.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -608,7 +608,7 @@ mod test {\n             Result<Vec<u8>, String>\n         {\n             let mut u8v: Vec<_> = fmt.bytes().collect();\n-            u8v.extend(cap.as_bytes().iter().map(|&b| b));\n+            u8v.extend(cap.bytes());\n             expand(&u8v, params, vars)\n         }\n "}, {"sha": "2c640c4b092556cab96df76819b992575a0fbf66", "filename": "src/test/bench/shootout-fasta.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Ftest%2Fbench%2Fshootout-fasta.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Ftest%2Fbench%2Fshootout-fasta.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fbench%2Fshootout-fasta.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -132,7 +132,7 @@ fn run<W: Writer>(writer: &mut W) -> std::old_io::IoResult<()> {\n                         ('t', 0.3015094502008)];\n \n     try!(make_fasta(writer, \">ONE Homo sapiens alu\\n\",\n-                    alu.as_bytes().iter().cycle().map(|c| *c), n * 2));\n+                    alu.as_bytes().iter().cycle().cloned(), n * 2));\n     try!(make_fasta(writer, \">TWO IUB ambiguity codes\\n\",\n                     AAGen::new(rng, iub), n * 3));\n     try!(make_fasta(writer, \">THREE Homo sapiens frequency\\n\","}, {"sha": "20249b47d089a0ca87676efecb139e6ac0a0cfe0", "filename": "src/test/bench/shootout-meteor.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Ftest%2Fbench%2Fshootout-meteor.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c07ec507e26ed5ecde63bf7138b09592d9001fb2/src%2Ftest%2Fbench%2Fshootout-meteor.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fbench%2Fshootout-meteor.rs?ref=c07ec507e26ed5ecde63bf7138b09592d9001fb2", "patch": "@@ -202,7 +202,7 @@ fn filter_masks(masks: &mut Vec<Vec<Vec<u64>>>) {\n     for i in 0..masks.len() {\n         for j in 0..(*masks)[i].len() {\n             masks[i][j] =\n-                (*masks)[i][j].iter().map(|&m| m)\n+                (*masks)[i][j].iter().cloned()\n                 .filter(|&m| !is_board_unfeasible(m, masks))\n                 .collect();\n         }\n@@ -270,7 +270,7 @@ fn handle_sol(raw_sol: &List<u64>, data: &mut Data) {\n     // reverse order, i.e. the board rotated by half a turn.\n     data.nb += 2;\n     let sol1 = to_vec(raw_sol);\n-    let sol2: Vec<u8> = sol1.iter().rev().map(|x| *x).collect();\n+    let sol2: Vec<u8> = sol1.iter().rev().cloned().collect();\n \n     if data.nb == 2 {\n         data.min = sol1.clone();"}]}