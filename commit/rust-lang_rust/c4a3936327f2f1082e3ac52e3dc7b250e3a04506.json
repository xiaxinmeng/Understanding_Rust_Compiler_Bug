{"sha": "c4a3936327f2f1082e3ac52e3dc7b250e3a04506", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM0YTM5MzYzMjdmMmYxMDgyZTNhYzUyZTNkYzdiMjUwZTNhMDQ1MDY=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2015-09-09T09:08:35Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2015-09-09T09:08:35Z"}, "message": "Add error code for privacy error on exported signature", "tree": {"sha": "0d04e998ed71acd0d33f19dd81aed89f93a41385", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0d04e998ed71acd0d33f19dd81aed89f93a41385"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c4a3936327f2f1082e3ac52e3dc7b250e3a04506", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c4a3936327f2f1082e3ac52e3dc7b250e3a04506", "html_url": "https://github.com/rust-lang/rust/commit/c4a3936327f2f1082e3ac52e3dc7b250e3a04506", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c4a3936327f2f1082e3ac52e3dc7b250e3a04506/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5e9bfcd6d6342240200ec38f65ef75e96daa1b7a", "url": "https://api.github.com/repos/rust-lang/rust/commits/5e9bfcd6d6342240200ec38f65ef75e96daa1b7a", "html_url": "https://github.com/rust-lang/rust/commit/5e9bfcd6d6342240200ec38f65ef75e96daa1b7a"}], "stats": {"total": 30, "additions": 29, "deletions": 1}, "files": [{"sha": "cdd6af2d13d93e27dc45f5453bc2bb4406659009", "filename": "src/librustc_privacy/diagnostics.rs", "status": "modified", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/c4a3936327f2f1082e3ac52e3dc7b250e3a04506/src%2Flibrustc_privacy%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c4a3936327f2f1082e3ac52e3dc7b250e3a04506/src%2Flibrustc_privacy%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_privacy%2Fdiagnostics.rs?ref=c4a3936327f2f1082e3ac52e3dc7b250e3a04506", "patch": "@@ -35,4 +35,31 @@ pub trait Bar : Foo {} // ok!\n ```\n \"##,\n \n+E0446: r##\"\n+A private type was used in an exported type signature. Erroneous code example:\n+\n+```\n+mod Foo {\n+    struct Bar(u32);\n+\n+    pub fn bar() -> Bar { // error: private type in exported type signature\n+        Bar(0)\n+    }\n+}\n+```\n+\n+To solve this error, please ensure the type is accessible at the same level of\n+the exported type signature. Example:\n+\n+```\n+mod Foo {\n+    pub struct Bar(u32); // we set the Bar type public\n+\n+    pub fn bar() -> Bar { // ok!\n+        Bar(0)\n+    }\n+}\n+```\n+\"##,\n+\n }\n\\ No newline at end of file"}, {"sha": "7b14ef134eb1cb9b8605c0a7d52c91e8ca069a4a", "filename": "src/librustc_privacy/lib.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/c4a3936327f2f1082e3ac52e3dc7b250e3a04506/src%2Flibrustc_privacy%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c4a3936327f2f1082e3ac52e3dc7b250e3a04506/src%2Flibrustc_privacy%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_privacy%2Flib.rs?ref=c4a3936327f2f1082e3ac52e3dc7b250e3a04506", "patch": "@@ -1435,7 +1435,8 @@ impl<'a, 'tcx, 'v> Visitor<'v> for VisiblePrivateTypesVisitor<'a, 'tcx> {\n         if let hir::TyPath(_, ref p) = t.node {\n             if !self.tcx.sess.features.borrow().visible_private_types &&\n                 self.path_is_private_type(t.id) {\n-                self.tcx.sess.span_err(p.span, \"private type in exported type signature\");\n+                span_err!(self.tcx.sess, p.span, E0446,\n+                          \"private type in exported type signature\");\n             }\n         }\n         visit::walk_ty(self, t)"}]}