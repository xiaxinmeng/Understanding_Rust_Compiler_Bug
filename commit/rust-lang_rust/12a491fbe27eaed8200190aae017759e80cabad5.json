{"sha": "12a491fbe27eaed8200190aae017759e80cabad5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjEyYTQ5MWZiZTI3ZWFlZDgyMDAxOTBhYWUwMTc3NTllODBjYWJhZDU=", "commit": {"author": {"name": "John K\u00e5re Alsaker", "email": "john.kare.alsaker@gmail.com", "date": "2019-03-05T18:27:50Z"}, "committer": {"name": "John K\u00e5re Alsaker", "email": "john.kare.alsaker@gmail.com", "date": "2019-03-05T19:46:45Z"}, "message": "Make rustc_macro a Rust 2018 crate", "tree": {"sha": "48696eb23df681dc05bfb197ff469b4963e63c8e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/48696eb23df681dc05bfb197ff469b4963e63c8e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/12a491fbe27eaed8200190aae017759e80cabad5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/12a491fbe27eaed8200190aae017759e80cabad5", "html_url": "https://github.com/rust-lang/rust/commit/12a491fbe27eaed8200190aae017759e80cabad5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/12a491fbe27eaed8200190aae017759e80cabad5/comments", "author": {"login": "Zoxc", "id": 25784, "node_id": "MDQ6VXNlcjI1Nzg0", "avatar_url": "https://avatars.githubusercontent.com/u/25784?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Zoxc", "html_url": "https://github.com/Zoxc", "followers_url": "https://api.github.com/users/Zoxc/followers", "following_url": "https://api.github.com/users/Zoxc/following{/other_user}", "gists_url": "https://api.github.com/users/Zoxc/gists{/gist_id}", "starred_url": "https://api.github.com/users/Zoxc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Zoxc/subscriptions", "organizations_url": "https://api.github.com/users/Zoxc/orgs", "repos_url": "https://api.github.com/users/Zoxc/repos", "events_url": "https://api.github.com/users/Zoxc/events{/privacy}", "received_events_url": "https://api.github.com/users/Zoxc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Zoxc", "id": 25784, "node_id": "MDQ6VXNlcjI1Nzg0", "avatar_url": "https://avatars.githubusercontent.com/u/25784?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Zoxc", "html_url": "https://github.com/Zoxc", "followers_url": "https://api.github.com/users/Zoxc/followers", "following_url": "https://api.github.com/users/Zoxc/following{/other_user}", "gists_url": "https://api.github.com/users/Zoxc/gists{/gist_id}", "starred_url": "https://api.github.com/users/Zoxc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Zoxc/subscriptions", "organizations_url": "https://api.github.com/users/Zoxc/orgs", "repos_url": "https://api.github.com/users/Zoxc/repos", "events_url": "https://api.github.com/users/Zoxc/events{/privacy}", "received_events_url": "https://api.github.com/users/Zoxc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1675212eceb759039229834768e4c4b630998245", "url": "https://api.github.com/repos/rust-lang/rust/commits/1675212eceb759039229834768e4c4b630998245", "html_url": "https://github.com/rust-lang/rust/commit/1675212eceb759039229834768e4c4b630998245"}], "stats": {"total": 29, "additions": 9, "deletions": 20}, "files": [{"sha": "6adfaa53946ac29615932017d041d8d49fd83840", "filename": "src/librustc/lib.rs", "status": "modified", "additions": 2, "deletions": 9, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/12a491fbe27eaed8200190aae017759e80cabad5/src%2Flibrustc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/12a491fbe27eaed8200190aae017759e80cabad5/src%2Flibrustc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Flib.rs?ref=12a491fbe27eaed8200190aae017759e80cabad5", "patch": "@@ -141,15 +141,8 @@ pub mod util {\n     pub mod bug;\n }\n \n-// A private module so that macro-expanded idents like\n-// `::rustc::lint::Lint` will also work in `rustc` itself.\n-//\n-// `libstd` uses the same trick.\n-#[doc(hidden)]\n-mod rustc {\n-    pub use crate::lint;\n-    pub use crate::ich;\n-}\n+// Allows macros to refer to this crate as `::rustc`\n+extern crate self as rustc;\n \n // FIXME(#27438): right now the unit tests of librustc don't refer to any actual\n //                functions generated in librustc_data_structures (all"}, {"sha": "2fe51a22fb4845463e49754264e764309949e278", "filename": "src/librustc_macros/Cargo.toml", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/12a491fbe27eaed8200190aae017759e80cabad5/src%2Flibrustc_macros%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/12a491fbe27eaed8200190aae017759e80cabad5/src%2Flibrustc_macros%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_macros%2FCargo.toml?ref=12a491fbe27eaed8200190aae017759e80cabad5", "patch": "@@ -2,6 +2,7 @@\n name = \"rustc_macros\"\n version = \"0.1.0\"\n authors = [\"The Rust Project Developers\"]\n+edition = \"2018\"\n \n [lib]\n proc-macro = true\n@@ -10,4 +11,4 @@ proc-macro = true\n synstructure = \"0.10.1\"\n syn = { version = \"0.15.22\", features = [\"full\"] }\n proc-macro2 = \"0.4.24\"\n-quote = \"0.6.10\"\n\\ No newline at end of file\n+quote = \"0.6.10\""}, {"sha": "6d7590c7d1cd3928b4ecaaa7dec467fe895b0796", "filename": "src/librustc_macros/src/hash_stable.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/12a491fbe27eaed8200190aae017759e80cabad5/src%2Flibrustc_macros%2Fsrc%2Fhash_stable.rs", "raw_url": "https://github.com/rust-lang/rust/raw/12a491fbe27eaed8200190aae017759e80cabad5/src%2Flibrustc_macros%2Fsrc%2Fhash_stable.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_macros%2Fsrc%2Fhash_stable.rs?ref=12a491fbe27eaed8200190aae017759e80cabad5", "patch": "@@ -1,6 +1,7 @@\n use synstructure;\n-use syn::{self, Meta, NestedMeta};\n+use syn::{self, Meta, NestedMeta, parse_quote};\n use proc_macro2::{self, Ident};\n+use quote::quote;\n \n struct Attributes {\n     ignore: bool,\n@@ -46,7 +47,7 @@ fn parse_attributes(field: &syn::Field) -> Attributes {\n     attrs\n }\n \n-pub fn hash_stable_derive(mut s: synstructure::Structure) -> proc_macro2::TokenStream {\n+pub fn hash_stable_derive(mut s: synstructure::Structure<'_>) -> proc_macro2::TokenStream {\n     let generic: syn::GenericParam = parse_quote!('__ctx);\n     s.add_bounds(synstructure::AddBounds::Generics);\n     s.add_impl_generic(generic);"}, {"sha": "cad31264b05a415c16628077e0eb079194b74a64", "filename": "src/librustc_macros/src/lib.rs", "status": "modified", "additions": 2, "deletions": 8, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/12a491fbe27eaed8200190aae017759e80cabad5/src%2Flibrustc_macros%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/12a491fbe27eaed8200190aae017759e80cabad5/src%2Flibrustc_macros%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_macros%2Fsrc%2Flib.rs?ref=12a491fbe27eaed8200190aae017759e80cabad5", "patch": "@@ -1,13 +1,7 @@\n #![feature(proc_macro_hygiene)]\n+#![deny(rust_2018_idioms)]\n \n-#[macro_use]\n-extern crate syn;\n-#[macro_use]\n-extern crate synstructure;\n-#[macro_use]\n-extern crate quote;\n-extern crate proc_macro;\n-extern crate proc_macro2;\n+use synstructure::decl_derive;\n \n mod hash_stable;\n "}]}