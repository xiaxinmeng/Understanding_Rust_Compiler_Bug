{"sha": "09e59c2875e351cacd2f9cb653fee383acf02121", "node_id": "C_kwDOAAsO6NoAKDA5ZTU5YzI4NzVlMzUxY2FjZDJmOWNiNjUzZmVlMzgzYWNmMDIxMjE", "commit": {"author": {"name": "5225225", "email": "5225225@mailbox.org", "date": "2021-11-13T15:08:20Z"}, "committer": {"name": "5225225", "email": "5225225@mailbox.org", "date": "2021-11-16T08:06:31Z"}, "message": "Inline printable function", "tree": {"sha": "b680fb6981f782364029d6bc503c1ea5edabe968", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b680fb6981f782364029d6bc503c1ea5edabe968"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/09e59c2875e351cacd2f9cb653fee383acf02121", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/09e59c2875e351cacd2f9cb653fee383acf02121", "html_url": "https://github.com/rust-lang/rust/commit/09e59c2875e351cacd2f9cb653fee383acf02121", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/09e59c2875e351cacd2f9cb653fee383acf02121/comments", "author": {"login": "5225225", "id": 8584210, "node_id": "MDQ6VXNlcjg1ODQyMTA=", "avatar_url": "https://avatars.githubusercontent.com/u/8584210?v=4", "gravatar_id": "", "url": "https://api.github.com/users/5225225", "html_url": "https://github.com/5225225", "followers_url": "https://api.github.com/users/5225225/followers", "following_url": "https://api.github.com/users/5225225/following{/other_user}", "gists_url": "https://api.github.com/users/5225225/gists{/gist_id}", "starred_url": "https://api.github.com/users/5225225/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/5225225/subscriptions", "organizations_url": "https://api.github.com/users/5225225/orgs", "repos_url": "https://api.github.com/users/5225225/repos", "events_url": "https://api.github.com/users/5225225/events{/privacy}", "received_events_url": "https://api.github.com/users/5225225/received_events", "type": "User", "site_admin": false}, "committer": {"login": "5225225", "id": 8584210, "node_id": "MDQ6VXNlcjg1ODQyMTA=", "avatar_url": "https://avatars.githubusercontent.com/u/8584210?v=4", "gravatar_id": "", "url": "https://api.github.com/users/5225225", "html_url": "https://github.com/5225225", "followers_url": "https://api.github.com/users/5225225/followers", "following_url": "https://api.github.com/users/5225225/following{/other_user}", "gists_url": "https://api.github.com/users/5225225/gists{/gist_id}", "starred_url": "https://api.github.com/users/5225225/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/5225225/subscriptions", "organizations_url": "https://api.github.com/users/5225225/orgs", "repos_url": "https://api.github.com/users/5225225/repos", "events_url": "https://api.github.com/users/5225225/events{/privacy}", "received_events_url": "https://api.github.com/users/5225225/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "17b5e2d167e8dec14117f0722c72444d2e3a5b2e", "url": "https://api.github.com/repos/rust-lang/rust/commits/17b5e2d167e8dec14117f0722c72444d2e3a5b2e", "html_url": "https://github.com/rust-lang/rust/commit/17b5e2d167e8dec14117f0722c72444d2e3a5b2e"}], "stats": {"total": 12, "additions": 7, "deletions": 5}, "files": [{"sha": "7f68112a427ba1be2270c2bf58dfe06b6c09cdc2", "filename": "compiler/rustc_parse/src/lexer/unescape_error_reporting.rs", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/09e59c2875e351cacd2f9cb653fee383acf02121/compiler%2Frustc_parse%2Fsrc%2Flexer%2Funescape_error_reporting.rs", "raw_url": "https://github.com/rust-lang/rust/raw/09e59c2875e351cacd2f9cb653fee383acf02121/compiler%2Frustc_parse%2Fsrc%2Flexer%2Funescape_error_reporting.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Flexer%2Funescape_error_reporting.rs?ref=09e59c2875e351cacd2f9cb653fee383acf02121", "patch": "@@ -7,10 +7,6 @@ use rustc_errors::{pluralize, Applicability, Handler};\n use rustc_lexer::unescape::{EscapeError, Mode};\n use rustc_span::{BytePos, Span};\n \n-fn printing(ch: char) -> bool {\n-    unicode_width::UnicodeWidthChar::width(ch).unwrap_or(0) != 0 && !ch.is_whitespace()\n-}\n-\n pub(crate) fn emit_unescape_error(\n     handler: &Handler,\n     // interior part of the literal, without quotes\n@@ -87,7 +83,13 @@ pub(crate) fn emit_unescape_error(\n                     );\n                 }\n             } else {\n-                let printable: Vec<char> = lit.chars().filter(|x| printing(*x)).collect();\n+                let printable: Vec<char> = lit\n+                    .chars()\n+                    .filter(|&x| {\n+                        unicode_width::UnicodeWidthChar::width(x).unwrap_or(0) != 0\n+                            && !x.is_whitespace()\n+                    })\n+                    .collect();\n \n                 if let [ch] = printable.as_slice() {\n                     has_help = true;"}]}