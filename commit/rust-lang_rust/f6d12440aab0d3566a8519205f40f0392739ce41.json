{"sha": "f6d12440aab0d3566a8519205f40f0392739ce41", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY2ZDEyNDQwYWFiMGQzNTY2YTg1MTkyMDVmNDBmMDM5MjczOWNlNDE=", "commit": {"author": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2020-03-28T13:01:48Z"}, "committer": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2020-03-28T13:01:48Z"}, "message": "Update Cranelift", "tree": {"sha": "26325de3f47e980fe3dbc67c70e111df21fa48cb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/26325de3f47e980fe3dbc67c70e111df21fa48cb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f6d12440aab0d3566a8519205f40f0392739ce41", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f6d12440aab0d3566a8519205f40f0392739ce41", "html_url": "https://github.com/rust-lang/rust/commit/f6d12440aab0d3566a8519205f40f0392739ce41", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f6d12440aab0d3566a8519205f40f0392739ce41/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "33fd4c47aaf5193c67366cc82a5c678ebeba8964", "url": "https://api.github.com/repos/rust-lang/rust/commits/33fd4c47aaf5193c67366cc82a5c678ebeba8964", "html_url": "https://github.com/rust-lang/rust/commit/33fd4c47aaf5193c67366cc82a5c678ebeba8964"}], "stats": {"total": 62, "additions": 38, "deletions": 24}, "files": [{"sha": "f9f5e13d225a78a0d7e7b442e4ab15c1110f47bc", "filename": "Cargo.lock", "status": "modified", "additions": 20, "deletions": 20, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/f6d12440aab0d3566a8519205f40f0392739ce41/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/f6d12440aab0d3566a8519205f40f0392739ce41/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=f6d12440aab0d3566a8519205f40f0392739ce41", "patch": "@@ -44,16 +44,16 @@ checksum = \"4785bdd1c96b2a846b2bd7cc02e86b6b3dbf14e7e53446c4f54c92a361040822\"\n \n [[package]]\n name = \"cranelift-bforest\"\n-version = \"0.60.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/#0d4bde4ab30f202c888888db7a8eb2d905c0119f\"\n+version = \"0.61.0\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/#08e5484cdb158b7795587ff7ad0cb04beef6dcd3\"\n dependencies = [\n  \"cranelift-entity\",\n ]\n \n [[package]]\n name = \"cranelift-codegen\"\n-version = \"0.60.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/#0d4bde4ab30f202c888888db7a8eb2d905c0119f\"\n+version = \"0.61.0\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/#08e5484cdb158b7795587ff7ad0cb04beef6dcd3\"\n dependencies = [\n  \"byteorder\",\n  \"cranelift-bforest\",\n@@ -69,27 +69,27 @@ dependencies = [\n \n [[package]]\n name = \"cranelift-codegen-meta\"\n-version = \"0.60.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/#0d4bde4ab30f202c888888db7a8eb2d905c0119f\"\n+version = \"0.61.0\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/#08e5484cdb158b7795587ff7ad0cb04beef6dcd3\"\n dependencies = [\n  \"cranelift-codegen-shared\",\n  \"cranelift-entity\",\n ]\n \n [[package]]\n name = \"cranelift-codegen-shared\"\n-version = \"0.60.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/#0d4bde4ab30f202c888888db7a8eb2d905c0119f\"\n+version = \"0.61.0\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/#08e5484cdb158b7795587ff7ad0cb04beef6dcd3\"\n \n [[package]]\n name = \"cranelift-entity\"\n-version = \"0.60.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/#0d4bde4ab30f202c888888db7a8eb2d905c0119f\"\n+version = \"0.61.0\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/#08e5484cdb158b7795587ff7ad0cb04beef6dcd3\"\n \n [[package]]\n name = \"cranelift-frontend\"\n-version = \"0.60.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/#0d4bde4ab30f202c888888db7a8eb2d905c0119f\"\n+version = \"0.61.0\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/#08e5484cdb158b7795587ff7ad0cb04beef6dcd3\"\n dependencies = [\n  \"cranelift-codegen\",\n  \"log\",\n@@ -99,8 +99,8 @@ dependencies = [\n \n [[package]]\n name = \"cranelift-module\"\n-version = \"0.60.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/#0d4bde4ab30f202c888888db7a8eb2d905c0119f\"\n+version = \"0.61.0\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/#08e5484cdb158b7795587ff7ad0cb04beef6dcd3\"\n dependencies = [\n  \"anyhow\",\n  \"cranelift-codegen\",\n@@ -111,8 +111,8 @@ dependencies = [\n \n [[package]]\n name = \"cranelift-native\"\n-version = \"0.60.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/#0d4bde4ab30f202c888888db7a8eb2d905c0119f\"\n+version = \"0.61.0\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/#08e5484cdb158b7795587ff7ad0cb04beef6dcd3\"\n dependencies = [\n  \"cranelift-codegen\",\n  \"raw-cpuid\",\n@@ -121,8 +121,8 @@ dependencies = [\n \n [[package]]\n name = \"cranelift-object\"\n-version = \"0.60.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/#0d4bde4ab30f202c888888db7a8eb2d905c0119f\"\n+version = \"0.61.0\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/#08e5484cdb158b7795587ff7ad0cb04beef6dcd3\"\n dependencies = [\n  \"cranelift-codegen\",\n  \"cranelift-module\",\n@@ -132,8 +132,8 @@ dependencies = [\n \n [[package]]\n name = \"cranelift-simplejit\"\n-version = \"0.60.0\"\n-source = \"git+https://github.com/bytecodealliance/wasmtime/#0d4bde4ab30f202c888888db7a8eb2d905c0119f\"\n+version = \"0.61.0\"\n+source = \"git+https://github.com/bytecodealliance/wasmtime/#08e5484cdb158b7795587ff7ad0cb04beef6dcd3\"\n dependencies = [\n  \"cranelift-codegen\",\n  \"cranelift-module\","}, {"sha": "0b40af9de54cb778ed5ea9fcc480fc792743f4c3", "filename": "src/allocator.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/f6d12440aab0d3566a8519205f40f0392739ce41/src%2Fallocator.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f6d12440aab0d3566a8519205f40f0392739ce41/src%2Fallocator.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fallocator.rs?ref=f6d12440aab0d3566a8519205f40f0392739ce41", "patch": "@@ -94,6 +94,10 @@ fn codegen_inner(module: &mut Module<impl Backend + 'static>, kind: AllocatorKin\n             bcx.seal_all_blocks();\n             bcx.finalize();\n         }\n-        module.define_function(func_id, &mut ctx).unwrap();\n+        module.define_function(\n+            func_id,\n+            &mut ctx,\n+            &mut cranelift_codegen::binemit::NullTrapSink {},\n+        ).unwrap();\n     }\n }"}, {"sha": "3612ec63340e448d8276e330dd10673021e4d5f2", "filename": "src/backend.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/f6d12440aab0d3566a8519205f40f0392739ce41/src%2Fbackend.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f6d12440aab0d3566a8519205f40f0392739ce41/src%2Fbackend.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbackend.rs?ref=f6d12440aab0d3566a8519205f40f0392739ce41", "patch": "@@ -125,7 +125,6 @@ pub(crate) fn make_module(sess: &Session, name: String) -> Module<Backend> {\n         ObjectBuilder::new(\n             crate::build_isa(sess, true),\n             name + \".o\",\n-            ObjectTrapCollection::Disabled,\n             cranelift_module::default_libcall_names(),\n         ),\n     );"}, {"sha": "9709dce697f5cf3d996ec4fa270523e41b0d9406", "filename": "src/base.rs", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/f6d12440aab0d3566a8519205f40f0392739ce41/src%2Fbase.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f6d12440aab0d3566a8519205f40f0392739ce41/src%2Fbase.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbase.rs?ref=f6d12440aab0d3566a8519205f40f0392739ce41", "patch": "@@ -171,7 +171,14 @@ pub(crate) fn trans_fn<'clif, 'tcx, B: Backend + 'static>(\n \n     // Define function\n     let module = &mut cx.module;\n-    tcx.sess.time(\"define function\", || module.define_function(func_id, context).unwrap());\n+    tcx.sess.time(\n+        \"define function\",\n+        || module.define_function(\n+            func_id,\n+            context,\n+            &mut cranelift_codegen::binemit::NullTrapSink {},\n+        ).unwrap(),\n+    );\n \n     // Write optimized function to file for debugging\n     #[cfg(debug_assertions)]"}, {"sha": "ab264f2e85aae8a3a155b1c27c7349dc729135e3", "filename": "src/main_shim.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/f6d12440aab0d3566a8519205f40f0392739ce41/src%2Fmain_shim.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f6d12440aab0d3566a8519205f40f0392739ce41/src%2Fmain_shim.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmain_shim.rs?ref=f6d12440aab0d3566a8519205f40f0392739ce41", "patch": "@@ -103,6 +103,10 @@ pub(crate) fn maybe_create_entry_wrapper(tcx: TyCtxt<'_>, module: &mut Module<im\n             bcx.seal_all_blocks();\n             bcx.finalize();\n         }\n-        m.define_function(cmain_func_id, &mut ctx).unwrap();\n+        m.define_function(\n+            cmain_func_id,\n+            &mut ctx,\n+            &mut cranelift_codegen::binemit::NullTrapSink {},\n+        ).unwrap();\n     }\n }"}]}