{"sha": "3f46fbf31b10cd93dd95d761eece38eb0864e69c", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNmNDZmYmYzMWIxMGNkOTNkZDk1ZDc2MWVlY2UzOGViMDg2NGU2OWM=", "commit": {"author": {"name": "Nikita Popov", "email": "nikita.ppv@gmail.com", "date": "2021-01-29T22:50:46Z"}, "committer": {"name": "Nikita Popov", "email": "nikita.ppv@gmail.com", "date": "2021-01-29T23:33:02Z"}, "message": "Update armhf-gnu to Ubuntu 20.04\n\nThis requires updating the used Linux kernel to avoid an assembler\nerror, the used busybox version to avoid a linker error, the used\nrootfs to match the host version and the qemu flags to work with\nthe newer version.", "tree": {"sha": "c3b4d8082debbd0c9c28cef0b18ac0e0ebbc75e9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c3b4d8082debbd0c9c28cef0b18ac0e0ebbc75e9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3f46fbf31b10cd93dd95d761eece38eb0864e69c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3f46fbf31b10cd93dd95d761eece38eb0864e69c", "html_url": "https://github.com/rust-lang/rust/commit/3f46fbf31b10cd93dd95d761eece38eb0864e69c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3f46fbf31b10cd93dd95d761eece38eb0864e69c/comments", "author": {"login": "nikic", "id": 216080, "node_id": "MDQ6VXNlcjIxNjA4MA==", "avatar_url": "https://avatars.githubusercontent.com/u/216080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikic", "html_url": "https://github.com/nikic", "followers_url": "https://api.github.com/users/nikic/followers", "following_url": "https://api.github.com/users/nikic/following{/other_user}", "gists_url": "https://api.github.com/users/nikic/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikic/subscriptions", "organizations_url": "https://api.github.com/users/nikic/orgs", "repos_url": "https://api.github.com/users/nikic/repos", "events_url": "https://api.github.com/users/nikic/events{/privacy}", "received_events_url": "https://api.github.com/users/nikic/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikic", "id": 216080, "node_id": "MDQ6VXNlcjIxNjA4MA==", "avatar_url": "https://avatars.githubusercontent.com/u/216080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikic", "html_url": "https://github.com/nikic", "followers_url": "https://api.github.com/users/nikic/followers", "following_url": "https://api.github.com/users/nikic/following{/other_user}", "gists_url": "https://api.github.com/users/nikic/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikic/subscriptions", "organizations_url": "https://api.github.com/users/nikic/orgs", "repos_url": "https://api.github.com/users/nikic/repos", "events_url": "https://api.github.com/users/nikic/events{/privacy}", "received_events_url": "https://api.github.com/users/nikic/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b122908617436af187252572ed5db96850551380", "url": "https://api.github.com/repos/rust-lang/rust/commits/b122908617436af187252572ed5db96850551380", "html_url": "https://github.com/rust-lang/rust/commit/b122908617436af187252572ed5db96850551380"}], "stats": {"total": 52, "additions": 29, "deletions": 23}, "files": [{"sha": "8a91859379b33af3c08301f4ccee277959055c56", "filename": "src/ci/docker/host-x86_64/armhf-gnu/Dockerfile", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/3f46fbf31b10cd93dd95d761eece38eb0864e69c/src%2Fci%2Fdocker%2Fhost-x86_64%2Farmhf-gnu%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/3f46fbf31b10cd93dd95d761eece38eb0864e69c/src%2Fci%2Fdocker%2Fhost-x86_64%2Farmhf-gnu%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Farmhf-gnu%2FDockerfile?ref=3f46fbf31b10cd93dd95d761eece38eb0864e69c", "patch": "@@ -1,6 +1,6 @@\n-FROM ubuntu:16.04\n+FROM ubuntu:20.04\n \n-RUN apt-get update -y && apt-get install -y --no-install-recommends \\\n+RUN apt-get update -y && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \\\n       bc \\\n       bzip2 \\\n       ca-certificates \\\n@@ -33,32 +33,32 @@ WORKDIR /build\n # the kernel. This file was generated by running `make vexpress_defconfig`\n # followed by `make menuconfig` and then enabling the IPv6 protocol page.\n COPY host-x86_64/armhf-gnu/vexpress_config /build/.config\n-RUN curl https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-4.4.42.tar.xz | \\\n+RUN curl https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-4.4.253.tar.xz | \\\n       tar xJf - && \\\n-      cd /build/linux-4.4.42 && \\\n+      cd /build/linux-4.4.253 && \\\n       cp /build/.config . && \\\n       make -j$(nproc) all && \\\n       cp arch/arm/boot/zImage /tmp && \\\n       cd /build &&  \\\n-      rm -rf linux-4.4.42\n+      rm -rf linux-4.4.253\n \n # Compile an instance of busybox as this provides a lightweight system and init\n # binary which we will boot into. Only trick here is configuring busybox to\n # build static binaries.\n-RUN curl https://www.busybox.net/downloads/busybox-1.21.1.tar.bz2 | tar xjf - && \\\n-      cd busybox-1.21.1 && \\\n+RUN curl https://www.busybox.net/downloads/busybox-1.32.1.tar.bz2 | tar xjf - && \\\n+      cd busybox-1.32.1 && \\\n       make defconfig && \\\n       sed -i 's/.*CONFIG_STATIC.*/CONFIG_STATIC=y/' .config && \\\n       make -j$(nproc) && \\\n       make install && \\\n       mv _install /tmp/rootfs && \\\n       cd /build && \\\n-      rm -rf busybox-1.12.1\n+      rm -rf busybox-1.32.1\n \n # Download the ubuntu rootfs, which we'll use as a chroot for all our tests.\n WORKDIR /tmp\n RUN mkdir rootfs/ubuntu\n-RUN curl http://cdimage.ubuntu.com/ubuntu-base/releases/16.04/release/ubuntu-base-16.04.6-base-armhf.tar.gz | \\\n+RUN curl http://cdimage.ubuntu.com/ubuntu-base/releases/20.04/release/ubuntu-base-20.04.1-base-armhf.tar.gz | \\\n       tar xzf - -C rootfs/ubuntu && \\\n       cd rootfs && mkdir proc sys dev etc etc/init.d\n "}, {"sha": "b39e5dcf38d70cde3bafab2798dab1a579645de4", "filename": "src/ci/docker/host-x86_64/armhf-gnu/vexpress_config", "status": "modified", "additions": 16, "deletions": 12, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/3f46fbf31b10cd93dd95d761eece38eb0864e69c/src%2Fci%2Fdocker%2Fhost-x86_64%2Farmhf-gnu%2Fvexpress_config", "raw_url": "https://github.com/rust-lang/rust/raw/3f46fbf31b10cd93dd95d761eece38eb0864e69c/src%2Fci%2Fdocker%2Fhost-x86_64%2Farmhf-gnu%2Fvexpress_config", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Farmhf-gnu%2Fvexpress_config?ref=3f46fbf31b10cd93dd95d761eece38eb0864e69c", "patch": "@@ -1,6 +1,6 @@\n #\n # Automatically generated file; DO NOT EDIT.\n-# Linux/arm 4.4.42 Kernel Configuration\n+# Linux/arm 4.4.253 Kernel Configuration\n #\n CONFIG_ARM=y\n CONFIG_ARM_HAS_SG_CHAIN=y\n@@ -60,6 +60,7 @@ CONFIG_HAVE_ARCH_AUDITSYSCALL=y\n CONFIG_GENERIC_IRQ_PROBE=y\n CONFIG_GENERIC_IRQ_SHOW=y\n CONFIG_GENERIC_IRQ_SHOW_LEVEL=y\n+CONFIG_GENERIC_IRQ_MIGRATION=y\n CONFIG_HARDIRQS_SW_RESEND=y\n CONFIG_IRQ_DOMAIN=y\n CONFIG_IRQ_DOMAIN_HIERARCHY=y\n@@ -136,6 +137,7 @@ CONFIG_RD_LZMA=y\n CONFIG_RD_XZ=y\n CONFIG_RD_LZO=y\n CONFIG_RD_LZ4=y\n+CONFIG_CC_OPTIMIZE_FOR_PERFORMANCE=y\n # CONFIG_CC_OPTIMIZE_FOR_SIZE is not set\n CONFIG_SYSCTL=y\n CONFIG_ANON_INODES=y\n@@ -389,6 +391,8 @@ CONFIG_SWP_EMULATE=y\n # CONFIG_CPU_BIG_ENDIAN is not set\n # CONFIG_CPU_ICACHE_DISABLE is not set\n # CONFIG_CPU_BPREDICT_DISABLE is not set\n+CONFIG_CPU_SPECTRE=y\n+CONFIG_HARDEN_BRANCH_PREDICTOR=y\n CONFIG_KUSER_HELPERS=y\n CONFIG_VDSO=y\n CONFIG_OUTER_CACHE=y\n@@ -611,7 +615,7 @@ CONFIG_IP_PNP_BOOTP=y\n # CONFIG_IP_PNP_RARP is not set\n # CONFIG_NET_IPIP is not set\n # CONFIG_NET_IPGRE_DEMUX is not set\n-CONFIG_NET_IP_TUNNEL=m\n+CONFIG_NET_IP_TUNNEL=y\n # CONFIG_SYN_COOKIES is not set\n # CONFIG_NET_IPVTI is not set\n # CONFIG_NET_UDP_TUNNEL is not set\n@@ -621,7 +625,7 @@ CONFIG_NET_IP_TUNNEL=m\n # CONFIG_INET_ESP is not set\n # CONFIG_INET_IPCOMP is not set\n # CONFIG_INET_XFRM_TUNNEL is not set\n-CONFIG_INET_TUNNEL=m\n+CONFIG_INET_TUNNEL=y\n CONFIG_INET_XFRM_MODE_TRANSPORT=y\n CONFIG_INET_XFRM_MODE_TUNNEL=y\n CONFIG_INET_XFRM_MODE_BEET=y\n@@ -643,12 +647,12 @@ CONFIG_IPV6=y\n # CONFIG_IPV6_ILA is not set\n # CONFIG_INET6_XFRM_TUNNEL is not set\n # CONFIG_INET6_TUNNEL is not set\n-CONFIG_INET6_XFRM_MODE_TRANSPORT=m\n-CONFIG_INET6_XFRM_MODE_TUNNEL=m\n-CONFIG_INET6_XFRM_MODE_BEET=m\n+CONFIG_INET6_XFRM_MODE_TRANSPORT=y\n+CONFIG_INET6_XFRM_MODE_TUNNEL=y\n+CONFIG_INET6_XFRM_MODE_BEET=y\n # CONFIG_INET6_XFRM_MODE_ROUTEOPTIMIZATION is not set\n # CONFIG_IPV6_VTI is not set\n-CONFIG_IPV6_SIT=m\n+CONFIG_IPV6_SIT=y\n # CONFIG_IPV6_SIT_6RD is not set\n CONFIG_IPV6_NDISC_NODETYPE=y\n # CONFIG_IPV6_TUNNEL is not set\n@@ -667,6 +671,7 @@ CONFIG_IPV6_NDISC_NODETYPE=y\n # CONFIG_L2TP is not set\n # CONFIG_BRIDGE is not set\n CONFIG_HAVE_NET_DSA=y\n+# CONFIG_NET_DSA is not set\n # CONFIG_VLAN_8021Q is not set\n # CONFIG_DECNET is not set\n # CONFIG_LLC2 is not set\n@@ -682,7 +687,6 @@ CONFIG_HAVE_NET_DSA=y\n # CONFIG_BATMAN_ADV is not set\n # CONFIG_OPENVSWITCH is not set\n # CONFIG_VSOCKETS is not set\n-# CONFIG_NETLINK_MMAP is not set\n # CONFIG_NETLINK_DIAG is not set\n # CONFIG_MPLS is not set\n # CONFIG_HSR is not set\n@@ -718,6 +722,7 @@ CONFIG_NET_9P_VIRTIO=y\n # CONFIG_CEPH_LIB is not set\n # CONFIG_NFC is not set\n # CONFIG_LWTUNNEL is not set\n+CONFIG_DST_CACHE=y\n CONFIG_HAVE_BPF_JIT=y\n \n #\n@@ -1267,6 +1272,7 @@ CONFIG_LEGACY_PTY_COUNT=16\n # CONFIG_SERIAL_NONSTANDARD is not set\n # CONFIG_N_GSM is not set\n # CONFIG_TRACE_SINK is not set\n+CONFIG_LDISC_AUTOLOAD=y\n CONFIG_DEVMEM=y\n CONFIG_DEVKMEM=y\n \n@@ -1304,7 +1310,6 @@ CONFIG_VIRTIO_CONSOLE=y\n CONFIG_HW_RANDOM=y\n # CONFIG_HW_RANDOM_TIMERIOMEM is not set\n CONFIG_HW_RANDOM_VIRTIO=y\n-# CONFIG_R3964 is not set\n # CONFIG_RAW_DRIVER is not set\n # CONFIG_TCG_TPM is not set\n # CONFIG_XILLYBUS is not set\n@@ -2009,7 +2014,6 @@ CONFIG_USB_ISP1760_HOST_ROLE=y\n # CONFIG_USB_EMI26 is not set\n # CONFIG_USB_ADUTUX is not set\n # CONFIG_USB_SEVSEG is not set\n-# CONFIG_USB_RIO500 is not set\n # CONFIG_USB_LEGOTOWER is not set\n # CONFIG_USB_LCD is not set\n # CONFIG_USB_LED is not set\n@@ -2318,8 +2322,6 @@ CONFIG_ARM_PMU=y\n # CONFIG_ANDROID is not set\n # CONFIG_NVMEM is not set\n # CONFIG_STM is not set\n-# CONFIG_STM_DUMMY is not set\n-# CONFIG_STM_SOURCE_CONSOLE is not set\n # CONFIG_INTEL_TH is not set\n \n #\n@@ -2332,6 +2334,7 @@ CONFIG_ARM_PMU=y\n #\n CONFIG_ARM_PSCI_FW=y\n # CONFIG_FIRMWARE_MEMMAP is not set\n+CONFIG_HAVE_ARM_SMCCC=y\n \n #\n # File systems\n@@ -2676,6 +2679,7 @@ CONFIG_TRACING_EVENTS_GPIO=y\n # CONFIG_TEST_KSTRTOX is not set\n # CONFIG_TEST_PRINTF is not set\n # CONFIG_TEST_RHASHTABLE is not set\n+# CONFIG_TEST_HASH is not set\n # CONFIG_DMA_API_DEBUG is not set\n # CONFIG_TEST_LKM is not set\n # CONFIG_TEST_USER_COPY is not set"}, {"sha": "2d99f2cb8e2ca57c47419a392252526a55aea406", "filename": "src/tools/remote-test-client/src/main.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/3f46fbf31b10cd93dd95d761eece38eb0864e69c/src%2Ftools%2Fremote-test-client%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3f46fbf31b10cd93dd95d761eece38eb0864e69c/src%2Ftools%2Fremote-test-client%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fremote-test-client%2Fsrc%2Fmain.rs?ref=3f46fbf31b10cd93dd95d761eece38eb0864e69c", "patch": "@@ -185,8 +185,10 @@ fn start_qemu_emulator(target: &str, rootfs: &Path, server: &Path, tmpdir: &Path\n                 .arg(\"-append\")\n                 .arg(\"console=ttyAMA0 root=/dev/ram rdinit=/sbin/init init=/sbin/init\")\n                 .arg(\"-nographic\")\n-                .arg(\"-redir\")\n-                .arg(\"tcp:12345::12345\");\n+                .arg(\"-netdev\")\n+                .arg(\"user,id=net0,hostfwd=tcp::12345-:12345\")\n+                .arg(\"-device\")\n+                .arg(\"virtio-net-device,netdev=net0,mac=00:00:00:00:00:00\");\n             t!(cmd.spawn());\n         }\n         \"aarch64-unknown-linux-gnu\" => {"}]}