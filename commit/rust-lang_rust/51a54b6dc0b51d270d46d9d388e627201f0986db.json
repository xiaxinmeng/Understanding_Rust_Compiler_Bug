{"sha": "51a54b6dc0b51d270d46d9d388e627201f0986db", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUxYTU0YjZkYzBiNTFkMjcwZDQ2ZDlkMzg4ZTYyNzIwMWYwOTg2ZGI=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-08-30T15:43:09Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-08-30T15:43:09Z"}, "message": "Auto merge of #43895 - JeremySorensen:master, r=alexcrichton\n\nmake ignore-git true by default when channel is dev\n\nFixes #43771\n(Handle git info in rustbuild differently)", "tree": {"sha": "1238ef4ae630c3dc65756daaf928bf144649dbae", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1238ef4ae630c3dc65756daaf928bf144649dbae"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/51a54b6dc0b51d270d46d9d388e627201f0986db", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/51a54b6dc0b51d270d46d9d388e627201f0986db", "html_url": "https://github.com/rust-lang/rust/commit/51a54b6dc0b51d270d46d9d388e627201f0986db", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/51a54b6dc0b51d270d46d9d388e627201f0986db/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ca9cf3594ab25d2809ac576dfc9defb8e87b45b8", "url": "https://api.github.com/repos/rust-lang/rust/commits/ca9cf3594ab25d2809ac576dfc9defb8e87b45b8", "html_url": "https://github.com/rust-lang/rust/commit/ca9cf3594ab25d2809ac576dfc9defb8e87b45b8"}, {"sha": "4f591a47d5c165785a8715f39fc6474c4e33a57f", "url": "https://api.github.com/repos/rust-lang/rust/commits/4f591a47d5c165785a8715f39fc6474c4e33a57f", "html_url": "https://github.com/rust-lang/rust/commit/4f591a47d5c165785a8715f39fc6474c4e33a57f"}], "stats": {"total": 23, "additions": 18, "deletions": 5}, "files": [{"sha": "3f5101ebf342f59a8faf00e1b50011519a3a91a8", "filename": "config.toml.example", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/51a54b6dc0b51d270d46d9d388e627201f0986db/config.toml.example", "raw_url": "https://github.com/rust-lang/rust/raw/51a54b6dc0b51d270d46d9d388e627201f0986db/config.toml.example", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/config.toml.example?ref=51a54b6dc0b51d270d46d9d388e627201f0986db", "patch": "@@ -283,7 +283,10 @@\n #codegen-tests = true\n \n # Flag indicating whether git info will be retrieved from .git automatically.\n-#ignore-git = false\n+# Having the git information can cause a lot of rebuilds during development.\n+# Note: If this attribute is not explicity set (e.g. if left commented out) it\n+# will default to true if channel = \"dev\", but will default to false otherwise.\n+#ignore-git = true\n \n # When creating source tarballs whether or not to create a source tarball.\n #dist-src = false"}, {"sha": "372e0906cc61e5d10f908017ccd5c65760cd35af", "filename": "src/bootstrap/config.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/51a54b6dc0b51d270d46d9d388e627201f0986db/src%2Fbootstrap%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/51a54b6dc0b51d270d46d9d388e627201f0986db/src%2Fbootstrap%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.rs?ref=51a54b6dc0b51d270d46d9d388e627201f0986db", "patch": "@@ -401,6 +401,7 @@ impl Config {\n         let mut debuginfo = None;\n         let mut debug_assertions = None;\n         let mut optimize = None;\n+        let mut ignore_git = None;\n \n         if let Some(ref llvm) = toml.llvm {\n             match llvm.ccache {\n@@ -432,6 +433,7 @@ impl Config {\n             debuginfo_lines = rust.debuginfo_lines;\n             debuginfo_only_std = rust.debuginfo_only_std;\n             optimize = rust.optimize;\n+            ignore_git = rust.ignore_git;\n             debug_jemalloc = rust.debug_jemalloc;\n             set(&mut config.rust_optimize_tests, rust.optimize_tests);\n             set(&mut config.rust_debuginfo_tests, rust.debuginfo_tests);\n@@ -440,7 +442,6 @@ impl Config {\n             set(&mut config.use_jemalloc, rust.use_jemalloc);\n             set(&mut config.backtrace, rust.backtrace);\n             set(&mut config.channel, rust.channel.clone());\n-            set(&mut config.ignore_git, rust.ignore_git);\n             set(&mut config.rust_dist_src, rust.dist_src);\n             set(&mut config.quiet_tests, rust.quiet_tests);\n             config.rustc_default_linker = rust.default_linker.clone();\n@@ -516,6 +517,9 @@ impl Config {\n         config.rust_debug_assertions = debug_assertions.unwrap_or(default);\n         config.rust_optimize = optimize.unwrap_or(!default);\n \n+        let default = config.channel == \"dev\";\n+        config.ignore_git = ignore_git.unwrap_or(default);\n+\n         config\n     }\n "}, {"sha": "fa8b7613360687c813cd935d2166810c2cdc06df", "filename": "src/bootstrap/configure.py", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/51a54b6dc0b51d270d46d9d388e627201f0986db/src%2Fbootstrap%2Fconfigure.py", "raw_url": "https://github.com/rust-lang/rust/raw/51a54b6dc0b51d270d46d9d388e627201f0986db/src%2Fbootstrap%2Fconfigure.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfigure.py?ref=51a54b6dc0b51d270d46d9d388e627201f0986db", "patch": "@@ -247,11 +247,17 @@ def set(key, value):\n               arr = arr[part]\n \n for key in known_args:\n-    # The `set` option is special and an be passed a bunch of times\n+    # The `set` option is special and can be passed a bunch of times\n     if key == 'set':\n         for option, value in known_args[key]:\n             keyval = value.split('=', 1)\n-            set(keyval[0], True if len(keyval) == 1 else keyval[1])\n+            if len(keyval) == 1 or keyval[1] == \"true\":\n+                value = True\n+            elif keyval[1] == \"false\":\n+                value = False\n+            else:\n+                value = keyval[1]\n+            set(keyval[0], value)\n         continue\n \n     # Ensure each option is only passed once"}, {"sha": "f16dd9809981eed4ca9714dd3dc5741d2c6dacb7", "filename": "src/ci/docker/x86_64-gnu-distcheck/Dockerfile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/51a54b6dc0b51d270d46d9d388e627201f0986db/src%2Fci%2Fdocker%2Fx86_64-gnu-distcheck%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/51a54b6dc0b51d270d46d9d388e627201f0986db/src%2Fci%2Fdocker%2Fx86_64-gnu-distcheck%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fx86_64-gnu-distcheck%2FDockerfile?ref=51a54b6dc0b51d270d46d9d388e627201f0986db", "patch": "@@ -18,6 +18,6 @@ RUN apt-get update && apt-get install -y --no-install-recommends \\\n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n \n-ENV RUST_CONFIGURE_ARGS --build=x86_64-unknown-linux-gnu\n+ENV RUST_CONFIGURE_ARGS --build=x86_64-unknown-linux-gnu --set rust.ignore-git=false\n ENV SCRIPT python2.7 ../x.py test distcheck\n ENV DIST_SRC 1"}]}