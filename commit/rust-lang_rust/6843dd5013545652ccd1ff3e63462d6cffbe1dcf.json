{"sha": "6843dd5013545652ccd1ff3e63462d6cffbe1dcf", "node_id": "C_kwDOAAsO6NoAKDY4NDNkZDUwMTM1NDU2NTJjY2QxZmYzZTYzNDYyZDZjZmZiZTFkY2Y", "commit": {"author": {"name": "Lewis Clark", "email": "me@lewis.to", "date": "2022-03-04T18:04:43Z"}, "committer": {"name": "Lewis Clark", "email": "me@lewis.to", "date": "2022-03-04T18:04:43Z"}, "message": "Don't round stack size up for created threads", "tree": {"sha": "5e8793a4fb6ec8825820fd5390e0a19fef5150aa", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5e8793a4fb6ec8825820fd5390e0a19fef5150aa"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6843dd5013545652ccd1ff3e63462d6cffbe1dcf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6843dd5013545652ccd1ff3e63462d6cffbe1dcf", "html_url": "https://github.com/rust-lang/rust/commit/6843dd5013545652ccd1ff3e63462d6cffbe1dcf", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6843dd5013545652ccd1ff3e63462d6cffbe1dcf/comments", "author": {"login": "lewisclark", "id": 25719980, "node_id": "MDQ6VXNlcjI1NzE5OTgw", "avatar_url": "https://avatars.githubusercontent.com/u/25719980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lewisclark", "html_url": "https://github.com/lewisclark", "followers_url": "https://api.github.com/users/lewisclark/followers", "following_url": "https://api.github.com/users/lewisclark/following{/other_user}", "gists_url": "https://api.github.com/users/lewisclark/gists{/gist_id}", "starred_url": "https://api.github.com/users/lewisclark/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lewisclark/subscriptions", "organizations_url": "https://api.github.com/users/lewisclark/orgs", "repos_url": "https://api.github.com/users/lewisclark/repos", "events_url": "https://api.github.com/users/lewisclark/events{/privacy}", "received_events_url": "https://api.github.com/users/lewisclark/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lewisclark", "id": 25719980, "node_id": "MDQ6VXNlcjI1NzE5OTgw", "avatar_url": "https://avatars.githubusercontent.com/u/25719980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lewisclark", "html_url": "https://github.com/lewisclark", "followers_url": "https://api.github.com/users/lewisclark/followers", "following_url": "https://api.github.com/users/lewisclark/following{/other_user}", "gists_url": "https://api.github.com/users/lewisclark/gists{/gist_id}", "starred_url": "https://api.github.com/users/lewisclark/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lewisclark/subscriptions", "organizations_url": "https://api.github.com/users/lewisclark/orgs", "repos_url": "https://api.github.com/users/lewisclark/repos", "events_url": "https://api.github.com/users/lewisclark/events{/privacy}", "received_events_url": "https://api.github.com/users/lewisclark/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "08504c64aa7c4163a51c1982ed10075bb89cec0e", "url": "https://api.github.com/repos/rust-lang/rust/commits/08504c64aa7c4163a51c1982ed10075bb89cec0e", "html_url": "https://github.com/rust-lang/rust/commit/08504c64aa7c4163a51c1982ed10075bb89cec0e"}], "stats": {"total": 5, "additions": 1, "deletions": 4}, "files": [{"sha": "fdbf7d4fdeddda0cc7956c900d73ce204b385299", "filename": "library/std/src/sys/windows/thread.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/6843dd5013545652ccd1ff3e63462d6cffbe1dcf/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fthread.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6843dd5013545652ccd1ff3e63462d6cffbe1dcf/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fthread.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fsys%2Fwindows%2Fthread.rs?ref=6843dd5013545652ccd1ff3e63462d6cffbe1dcf", "patch": "@@ -28,12 +28,9 @@ impl Thread {\n         // PTHREAD_STACK_MIN bytes big.  Windows has no such lower limit, it's\n         // just that below a certain threshold you can't do anything useful.\n         // That threshold is application and architecture-specific, however.\n-        // Round up to the next 64 kB because that's what the NT kernel does,\n-        // might as well make it explicit.\n-        let stack_size = (stack + 0xfffe) & (!0xfffe);\n         let ret = c::CreateThread(\n             ptr::null_mut(),\n-            stack_size,\n+            stack,\n             thread_start,\n             p as *mut _,\n             c::STACK_SIZE_PARAM_IS_A_RESERVATION,"}]}