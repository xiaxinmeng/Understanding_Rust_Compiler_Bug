{"sha": "cc6180c2f4bf53a235a139be0ba604dacda618a9", "node_id": "C_kwDOAAsO6NoAKGNjNjE4MGMyZjRiZjUzYTIzNWExMzliZTBiYTYwNGRhY2RhNjE4YTk", "commit": {"author": {"name": "David Tolnay", "email": "dtolnay@gmail.com", "date": "2023-03-04T02:50:53Z"}, "committer": {"name": "David Tolnay", "email": "dtolnay@gmail.com", "date": "2023-03-04T03:03:54Z"}, "message": "Include former name of renamed lints in lints.json", "tree": {"sha": "f7f3965479d6a8cf6771683fe95d01d8e9ce2751", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f7f3965479d6a8cf6771683fe95d01d8e9ce2751"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cc6180c2f4bf53a235a139be0ba604dacda618a9", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEERijF2Cz/ZdaBZKeK+boUO5X/bYIFAmQCtRoACgkQ+boUO5X/\nbYIy0A//fkVYnjw9bxqCyfD0vCFsuXq+MVw9OuiDZBYa3if9y5zWlraKPAl13vY/\n29kDAtgC4gxlz4PpMPKebaYhf7uEqTd4NJLKDXbnZffn+q/wpJQqrS6FDLs3Janz\n7PUIsYFO6yLTKsPj/XjvZaA59V6zrTVeqErXUFUHPiJlitG+CqWjLdOnKZp/t8bG\n781FXQ3orkwPffZBnOEKy3+5arLRl+/dl+pz5zD16+o32bh3RG9RS+ArPlfZzACT\nhwjcazWnxkDxWp/G7Itn9gKCPfxqNV/gLvzI81iOQRP4TALSqUydY0IHdgNBrCNR\ngwlsaW2IHGobbaQsX07aPu8X/cpAaul0vo7zbEy8jODtA9EWxNxYXh0R0YtisVpY\nWtdbtHElD/SQT0EzbNCSHbVo1T1fFynEwsLCoWdyRGlTi1t0/XmbgAQjMXFsgBgH\n9rRTlKiaQffq1PVxlM1Ggcx11j3DkUOPn3eb+wfWA4yKUYR9LdzhcSVls1Z9HoHz\nLpOakuZQKDNJYm/uCraZqXU0Y40f0Gi7I61ohRmyKcjBYV5c/flZVR5c2Nb6GaFh\nBX7lmPZrAQ9gLhTjHdlN1LWe1ztLvgeJAdWbx2RHqRp8j/EaD5ylIrB/ovA502SL\nC5nZKBwOEsf4PC+c9lJpwzbg5Uxfqyz8e1k65sig7lMpcSIqtC4=\n=9YKa\n-----END PGP SIGNATURE-----", "payload": "tree f7f3965479d6a8cf6771683fe95d01d8e9ce2751\nparent 113c704d225c63c1a0eec29cfa9478b7537e7d73\nauthor David Tolnay <dtolnay@gmail.com> 1677898253 -0800\ncommitter David Tolnay <dtolnay@gmail.com> 1677899034 -0800\n\nInclude former name of renamed lints in lints.json\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cc6180c2f4bf53a235a139be0ba604dacda618a9", "html_url": "https://github.com/rust-lang/rust/commit/cc6180c2f4bf53a235a139be0ba604dacda618a9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cc6180c2f4bf53a235a139be0ba604dacda618a9/comments", "author": {"login": "dtolnay", "id": 1940490, "node_id": "MDQ6VXNlcjE5NDA0OTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1940490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtolnay", "html_url": "https://github.com/dtolnay", "followers_url": "https://api.github.com/users/dtolnay/followers", "following_url": "https://api.github.com/users/dtolnay/following{/other_user}", "gists_url": "https://api.github.com/users/dtolnay/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtolnay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtolnay/subscriptions", "organizations_url": "https://api.github.com/users/dtolnay/orgs", "repos_url": "https://api.github.com/users/dtolnay/repos", "events_url": "https://api.github.com/users/dtolnay/events{/privacy}", "received_events_url": "https://api.github.com/users/dtolnay/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dtolnay", "id": 1940490, "node_id": "MDQ6VXNlcjE5NDA0OTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1940490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtolnay", "html_url": "https://github.com/dtolnay", "followers_url": "https://api.github.com/users/dtolnay/followers", "following_url": "https://api.github.com/users/dtolnay/following{/other_user}", "gists_url": "https://api.github.com/users/dtolnay/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtolnay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtolnay/subscriptions", "organizations_url": "https://api.github.com/users/dtolnay/orgs", "repos_url": "https://api.github.com/users/dtolnay/repos", "events_url": "https://api.github.com/users/dtolnay/events{/privacy}", "received_events_url": "https://api.github.com/users/dtolnay/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "113c704d225c63c1a0eec29cfa9478b7537e7d73", "url": "https://api.github.com/repos/rust-lang/rust/commits/113c704d225c63c1a0eec29cfa9478b7537e7d73", "html_url": "https://github.com/rust-lang/rust/commit/113c704d225c63c1a0eec29cfa9478b7537e7d73"}], "stats": {"total": 7, "additions": 6, "deletions": 1}, "files": [{"sha": "3d0d4a52511a8365f1ca27781f51153ad499e79e", "filename": "clippy_lints/src/utils/internal_lints/metadata_collector.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/cc6180c2f4bf53a235a139be0ba604dacda618a9/clippy_lints%2Fsrc%2Futils%2Finternal_lints%2Fmetadata_collector.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cc6180c2f4bf53a235a139be0ba604dacda618a9/clippy_lints%2Fsrc%2Futils%2Finternal_lints%2Fmetadata_collector.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Finternal_lints%2Fmetadata_collector.rs?ref=cc6180c2f4bf53a235a139be0ba604dacda618a9", "patch": "@@ -26,7 +26,7 @@ use rustc_session::{declare_tool_lint, impl_lint_pass};\n use rustc_span::symbol::Ident;\n use rustc_span::{sym, Loc, Span, Symbol};\n use serde::{ser::SerializeStruct, Serialize, Serializer};\n-use std::collections::BinaryHeap;\n+use std::collections::{BTreeSet, BinaryHeap};\n use std::fmt;\n use std::fmt::Write as _;\n use std::fs::{self, OpenOptions};\n@@ -264,6 +264,9 @@ struct LintMetadata {\n     /// This field is only used in the output and will only be\n     /// mapped shortly before the actual output.\n     applicability: Option<ApplicabilityInfo>,\n+    /// All the past names of lints which have been renamed.\n+    #[serde(skip_serializing_if = \"BTreeSet::is_empty\")]\n+    former_ids: BTreeSet<String>,\n }\n \n impl LintMetadata {\n@@ -283,6 +286,7 @@ impl LintMetadata {\n             version,\n             docs,\n             applicability: None,\n+            former_ids: BTreeSet::new(),\n         }\n     }\n }\n@@ -901,6 +905,7 @@ fn collect_renames(lints: &mut Vec<LintMetadata>) {\n                         if name == lint_name;\n                         if let Some(past_name) = k.strip_prefix(CLIPPY_LINT_GROUP_PREFIX);\n                         then {\n+                            lint.former_ids.insert(past_name.to_owned());\n                             writeln!(collected, \"* `{past_name}`\").unwrap();\n                             names.push(past_name.to_string());\n                         }"}]}