{"sha": "5ffaf4c291e179198045659a8554114064ab98ce", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVmZmFmNGMyOTFlMTc5MTk4MDQ1NjU5YTg1NTQxMTQwNjRhYjk4Y2U=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-01-08T17:58:52Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-01-08T19:37:18Z"}, "message": "Rollup merge of #47259 - sfackler:map-remove-entry, r=dtolnay\n\nAdd HashMap::remove_entry\n\nImplements #46344\n\nr? @dtolnay", "tree": {"sha": "a252b43649e8e84447506d11daf79ce12b551050", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a252b43649e8e84447506d11daf79ce12b551050"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5ffaf4c291e179198045659a8554114064ab98ce", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlpTyG4ACgkQ/vbIBR0O\nATxFPw/8CKF0TYHHlWzk3KEAYeCvZKY0rNlXZfog1c6hkacNQsmYbzAXAZNGPUyN\n1GdkobM9xQXARP30DVP1zD3tmknKXnIpMTO8GBSVcbg8W6bVHKi2/Zw5bp0d9jq+\nktHGrvBIfsmouNnuzF4FFpywoL1tbWZhAK10yB0u9B2vlNL5iLJg58VyqugaqNe/\n0McY39osXaTFnMT2j8vngZ5PuVb/NTSfUCUNrrGW86slIg8Tee47NhwW55TsBEH5\nYPS+HT1T21s6AnIQ5Rs/6bq2YC9d6le5NRLit7oxJPIJstA8ACqw077ag5InvaQE\nz3+VDFXFaW3COAArtoaB4bF0CCurzSZcsmh6VlHEr/ZMaVtZjS7LrcXL8IKinx1U\nHrPpVWlHQ8gWv2EieSMHOy2PzbSJRksv7OldC8cE54CaYbf7NO/8ENjZFyXtL9q2\n3cFt3w89a/nDuSyb5B9R+lJBJO21Xs/iOFDsQ2s612uUhQ2QxPgOD08HlK8YWh3U\nChYBk9ItTWzGyCN2SX/GQQ0Cs9QBfxq705wxsoBDhZAXN2cNzm9NKZxobRLXoupt\nxSgKA80DFzANFNWxKXzIeiryDqtZvfLD47/40twPQmu4rjtGIefZNt37k8Z4jdX1\ncuc976wf3yUaRwNdbRPnTrJGEFOHRmbOnNTJRDHPCTPcVjgDsrE=\n=nEB9\n-----END PGP SIGNATURE-----", "payload": "tree a252b43649e8e84447506d11daf79ce12b551050\nparent 6648dcd353ecad51886e30274c0f07dac4f41573\nparent 1fc6ad56cd6ad4ea4231cd95af14ccd98f6a8960\nauthor kennytm <kennytm@gmail.com> 1515434332 +0800\ncommitter kennytm <kennytm@gmail.com> 1515440238 +0800\n\nRollup merge of #47259 - sfackler:map-remove-entry, r=dtolnay\n\nAdd HashMap::remove_entry\n\nImplements #46344\n\nr? @dtolnay\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5ffaf4c291e179198045659a8554114064ab98ce", "html_url": "https://github.com/rust-lang/rust/commit/5ffaf4c291e179198045659a8554114064ab98ce", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5ffaf4c291e179198045659a8554114064ab98ce/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6648dcd353ecad51886e30274c0f07dac4f41573", "url": "https://api.github.com/repos/rust-lang/rust/commits/6648dcd353ecad51886e30274c0f07dac4f41573", "html_url": "https://github.com/rust-lang/rust/commit/6648dcd353ecad51886e30274c0f07dac4f41573"}, {"sha": "1fc6ad56cd6ad4ea4231cd95af14ccd98f6a8960", "url": "https://api.github.com/repos/rust-lang/rust/commits/1fc6ad56cd6ad4ea4231cd95af14ccd98f6a8960", "html_url": "https://github.com/rust-lang/rust/commit/1fc6ad56cd6ad4ea4231cd95af14ccd98f6a8960"}], "stats": {"total": 50, "additions": 49, "deletions": 1}, "files": [{"sha": "4e5385c17e9857678b07a04be842e4930288d814", "filename": "src/libstd/collections/hash/map.rs", "status": "modified", "additions": 49, "deletions": 1, "changes": 50, "blob_url": "https://github.com/rust-lang/rust/blob/5ffaf4c291e179198045659a8554114064ab98ce/src%2Flibstd%2Fcollections%2Fhash%2Fmap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5ffaf4c291e179198045659a8554114064ab98ce/src%2Flibstd%2Fcollections%2Fhash%2Fmap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fcollections%2Fhash%2Fmap.rs?ref=5ffaf4c291e179198045659a8554114064ab98ce", "patch": "@@ -1241,6 +1241,46 @@ impl<K, V, S> HashMap<K, V, S>\n         self.search_mut(k).into_occupied_bucket().map(|bucket| pop_internal(bucket).1)\n     }\n \n+    /// Removes a key from the map, returning the stored key and value if the\n+    /// key was previously in the map.\n+    ///\n+    /// The key may be any borrowed form of the map's key type, but\n+    /// [`Hash`] and [`Eq`] on the borrowed form *must* match those for\n+    /// the key type.\n+    ///\n+    /// [`Eq`]: ../../std/cmp/trait.Eq.html\n+    /// [`Hash`]: ../../std/hash/trait.Hash.html\n+    ///\n+    /// # Examples\n+    ///\n+    /// ```\n+    /// #![feature(hash_map_remove_entry)]\n+    /// use std::collections::HashMap;\n+    ///\n+    /// # fn main() {\n+    /// let mut map = HashMap::new();\n+    /// map.insert(1, \"a\");\n+    /// assert_eq!(map.remove_entry(&1), Some((1, \"a\")));\n+    /// assert_eq!(map.remove(&1), None);\n+    /// # }\n+    /// ```\n+    #[unstable(feature = \"hash_map_remove_entry\", issue = \"46344\")]\n+    pub fn remove_entry<Q: ?Sized>(&mut self, k: &Q) -> Option<(K, V)>\n+        where K: Borrow<Q>,\n+              Q: Hash + Eq\n+    {\n+        if self.table.size() == 0 {\n+            return None;\n+        }\n+\n+        self.search_mut(k)\n+            .into_occupied_bucket()\n+            .map(|bucket| {\n+                let (k, v, _) = pop_internal(bucket);\n+                (k, v)\n+            })\n+    }\n+\n     /// Retains only the elements specified by the predicate.\n     ///\n     /// In other words, remove all pairs `(k, v)` such that `f(&k,&mut v)` returns `false`.\n@@ -3040,13 +3080,21 @@ mod test_map {\n     }\n \n     #[test]\n-    fn test_pop() {\n+    fn test_remove() {\n         let mut m = HashMap::new();\n         m.insert(1, 2);\n         assert_eq!(m.remove(&1), Some(2));\n         assert_eq!(m.remove(&1), None);\n     }\n \n+    #[test]\n+    fn test_remove_entry() {\n+        let mut m = HashMap::new();\n+        m.insert(1, 2);\n+        assert_eq!(m.remove_entry(&1), Some((1, 2)));\n+        assert_eq!(m.remove(&1), None);\n+    }\n+\n     #[test]\n     fn test_iterate() {\n         let mut m = HashMap::with_capacity(4);"}]}