{"sha": "e3ad1b58f560ba0557d21c1aceb25da3442ba3f6", "node_id": "MDY6Q29tbWl0NzI0NzEyOmUzYWQxYjU4ZjU2MGJhMDU1N2QyMWMxYWNlYjI1ZGEzNDQyYmEzZjY=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2017-04-18T00:17:11Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2017-04-18T01:16:53Z"}, "message": "Disable debuginfo when compiling tools\n\nCurrently the Cargo binary has jumped from 14M to 34M on the beta channel, which\nappears to be due to the fact that we're compiling tools with debug information\ninside them. This additionally means that the `rls` binary is 62M right now!\n\nThis wasn't an intentional change, so be sure to disable debuginfo when\ncompiling tools as it's just intended for the standard library and compile for\nnow.", "tree": {"sha": "ab8b1600b6222d656b76361e0de3edf1602d4b77", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ab8b1600b6222d656b76361e0de3edf1602d4b77"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e3ad1b58f560ba0557d21c1aceb25da3442ba3f6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e3ad1b58f560ba0557d21c1aceb25da3442ba3f6", "html_url": "https://github.com/rust-lang/rust/commit/e3ad1b58f560ba0557d21c1aceb25da3442ba3f6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e3ad1b58f560ba0557d21c1aceb25da3442ba3f6/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5516bcc4588ea6192298b4e3682eb1d09581912a", "url": "https://api.github.com/repos/rust-lang/rust/commits/5516bcc4588ea6192298b4e3682eb1d09581912a", "html_url": "https://github.com/rust-lang/rust/commit/5516bcc4588ea6192298b4e3682eb1d09581912a"}], "stats": {"total": 9, "additions": 7, "deletions": 2}, "files": [{"sha": "5e046f41673e870235c6964e656c4f2b6a24ada0", "filename": "src/bootstrap/lib.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/e3ad1b58f560ba0557d21c1aceb25da3442ba3f6/src%2Fbootstrap%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e3ad1b58f560ba0557d21c1aceb25da3442ba3f6/src%2Fbootstrap%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Flib.rs?ref=e3ad1b58f560ba0557d21c1aceb25da3442ba3f6", "patch": "@@ -464,8 +464,6 @@ impl Build {\n              .env(\"RUSTC\", self.out.join(\"bootstrap/debug/rustc\"))\n              .env(\"RUSTC_REAL\", self.compiler_path(compiler))\n              .env(\"RUSTC_STAGE\", stage.to_string())\n-             .env(\"RUSTC_DEBUGINFO\", self.config.rust_debuginfo.to_string())\n-             .env(\"RUSTC_DEBUGINFO_LINES\", self.config.rust_debuginfo_lines.to_string())\n              .env(\"RUSTC_CODEGEN_UNITS\",\n                   self.config.rust_codegen_units.to_string())\n              .env(\"RUSTC_DEBUG_ASSERTIONS\",\n@@ -477,6 +475,13 @@ impl Build {\n              .env(\"RUSTDOC_REAL\", self.rustdoc(compiler))\n              .env(\"RUSTC_FLAGS\", self.rustc_flags(target).join(\" \"));\n \n+        // Tools don't get debuginfo right now, e.g. cargo and rls don't get\n+        // compiled with debuginfo.\n+        if mode != Mode::Tool {\n+             cargo.env(\"RUSTC_DEBUGINFO\", self.config.rust_debuginfo.to_string())\n+                  .env(\"RUSTC_DEBUGINFO_LINES\", self.config.rust_debuginfo_lines.to_string());\n+        }\n+\n         // Enable usage of unstable features\n         cargo.env(\"RUSTC_BOOTSTRAP\", \"1\");\n         self.add_rust_test_threads(&mut cargo);"}]}