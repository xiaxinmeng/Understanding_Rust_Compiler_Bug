{"sha": "edadbff4eadae43ec5f6845c69ad653566c0e6f3", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVkYWRiZmY0ZWFkYWU0M2VjNWY2ODQ1YzY5YWQ2NTM1NjZjMGU2ZjM=", "commit": {"author": {"name": "messense", "email": "messense@icloud.com", "date": "2017-07-03T04:26:03Z"}, "committer": {"name": "messense", "email": "messense@icloud.com", "date": "2017-07-03T04:26:03Z"}, "message": "Fix compilation on rustc 1.20.0-nightly (067971139 2017-07-02)", "tree": {"sha": "2e7ba2b94c0f1b17cb40bb1241b5d5142c036fed", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2e7ba2b94c0f1b17cb40bb1241b5d5142c036fed"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/edadbff4eadae43ec5f6845c69ad653566c0e6f3", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEGWGgMoNGfisvor0Vu0GooscWzKkFAllZx1sACgkQu0GooscW\nzKmC+xAAjAMbotfxyuev1Lm1iCcfCXWddkbGCuJsD8dHUgaCl2ccwIgLD1A/gu9s\nQJWkmmkzLAHBVuueHuguRrTx1SzgCGgJcYbiwgJeL0V6DoMwhkDyHmsTKmSPUPym\nmmmbazPLaHuMNyNBDSKBrKY6G3u24VXMZ5KSAkUeR7Ck2y59eeXPVv4sIb057ifL\nOj38DZlGMNGvpbXvpOuy+qAr9HIW9l+kOu9q0IfbWMEpd1MVpHpdWwcyhj5BKwn2\n5LZfRFHW3sVVDTRUKnpkw3uXeMRNN+8h0AT3vZLOd84Uv2JW+YxXmQMhLmJewy51\nAP8M60S1FWpvzfuwj/GF2DAIS2X0+3dr9rIXztZG0I0jMVnp7c+yYcRDZvzmkon0\nV1UFq/OO9CaMgY8uZE5CNr2z44B8Js64qjRsRQP1XcCBvG7x2lew49u0HbyBVuVC\nW040GlRYnI2helE9l+lge8pwxkeAZTsJzid7q418uKgoD6vfJb/Itf11IV53ib7H\nrdLaBET/BdDtJAZP6J1QmQ/Fqh+yqPFS7uC4Z2M4bJV2SS1sl6PeBXMj8flbK0EC\nTWMINXICGoGk3qFPYpZxVya0AOryDAgO5BMCt5x5sHJxVwTrlentRc2AaPzhcBgO\nzL/IDQVS2E5uyaJCNCTCka+cNTiv5xy3Ml66v6bpeYX53eW52HQ=\n=nwOS\n-----END PGP SIGNATURE-----", "payload": "tree 2e7ba2b94c0f1b17cb40bb1241b5d5142c036fed\nparent d9b5f795fa459ba55b760965615266f1607601aa\nauthor messense <messense@icloud.com> 1499055963 +0800\ncommitter messense <messense@icloud.com> 1499055963 +0800\n\nFix compilation on rustc 1.20.0-nightly (067971139 2017-07-02)\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/edadbff4eadae43ec5f6845c69ad653566c0e6f3", "html_url": "https://github.com/rust-lang/rust/commit/edadbff4eadae43ec5f6845c69ad653566c0e6f3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/edadbff4eadae43ec5f6845c69ad653566c0e6f3/comments", "author": {"login": "messense", "id": 1556054, "node_id": "MDQ6VXNlcjE1NTYwNTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1556054?v=4", "gravatar_id": "", "url": "https://api.github.com/users/messense", "html_url": "https://github.com/messense", "followers_url": "https://api.github.com/users/messense/followers", "following_url": "https://api.github.com/users/messense/following{/other_user}", "gists_url": "https://api.github.com/users/messense/gists{/gist_id}", "starred_url": "https://api.github.com/users/messense/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/messense/subscriptions", "organizations_url": "https://api.github.com/users/messense/orgs", "repos_url": "https://api.github.com/users/messense/repos", "events_url": "https://api.github.com/users/messense/events{/privacy}", "received_events_url": "https://api.github.com/users/messense/received_events", "type": "User", "site_admin": false}, "committer": {"login": "messense", "id": 1556054, "node_id": "MDQ6VXNlcjE1NTYwNTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1556054?v=4", "gravatar_id": "", "url": "https://api.github.com/users/messense", "html_url": "https://github.com/messense", "followers_url": "https://api.github.com/users/messense/followers", "following_url": "https://api.github.com/users/messense/following{/other_user}", "gists_url": "https://api.github.com/users/messense/gists{/gist_id}", "starred_url": "https://api.github.com/users/messense/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/messense/subscriptions", "organizations_url": "https://api.github.com/users/messense/orgs", "repos_url": "https://api.github.com/users/messense/repos", "events_url": "https://api.github.com/users/messense/events{/privacy}", "received_events_url": "https://api.github.com/users/messense/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d9b5f795fa459ba55b760965615266f1607601aa", "url": "https://api.github.com/repos/rust-lang/rust/commits/d9b5f795fa459ba55b760965615266f1607601aa", "html_url": "https://github.com/rust-lang/rust/commit/d9b5f795fa459ba55b760965615266f1607601aa"}], "stats": {"total": 8, "additions": 3, "deletions": 5}, "files": [{"sha": "b8cc7adb083cd4ea0b9e305dfa29e401c68e22d2", "filename": "src/main.rs", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/edadbff4eadae43ec5f6845c69ad653566c0e6f3/src%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/edadbff4eadae43ec5f6845c69ad653566c0e6f3/src%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmain.rs?ref=edadbff4eadae43ec5f6845c69ad653566c0e6f3", "patch": "@@ -13,7 +13,7 @@ extern crate rustc_plugin;\n extern crate syntax;\n \n use rustc_driver::{driver, CompilerCalls, RustcDefaultCalls, Compilation};\n-use rustc::session::{config, Session};\n+use rustc::session::{config, Session, CompileIncomplete};\n use rustc::session::config::{Input, ErrorOutputType};\n use std::path::PathBuf;\n use std::process::{self, Command};\n@@ -278,10 +278,8 @@ pub fn main() {\n \n             let mut ccc = ClippyCompilerCalls::new(clippy_enabled);\n             let (result, _) = rustc_driver::run_compiler(&args, &mut ccc, None, None);\n-            if let Err(err_count) = result {\n-                if err_count > 0 {\n-                    std::process::exit(1);\n-                }\n+            if let Err(CompileIncomplete::Errored(_)) = result {\n+                std::process::exit(1);\n             }\n         })\n                 .expect(\"rustc_thread failed\");"}]}