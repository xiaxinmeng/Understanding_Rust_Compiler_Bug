{"sha": "9b1e105ade3cb5b467c94411bbb37168981a02ec", "node_id": "MDY6Q29tbWl0NzI0NzEyOjliMWUxMDVhZGUzY2I1YjQ2N2M5NDQxMWJiYjM3MTY4OTgxYTAyZWM=", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2021-06-03T05:35:28Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-06-03T05:35:28Z"}, "message": "Rollup merge of #85706 - jrmuizel:fpe, r=nagisa\n\nTurn off frame pointer elimination on all Apple platforms.\n\nThis ends up disabling frame pointer elimination on aarch64_apple_darwin\nwhich matches what clang does by default along with the\naarch64_apple_ios and x86_64_apple_darwin targets.\n\nFurther, the Apple docs \"Writing ARM64 Code for Apple Platforms\" has a section\ncalled \"Respect the Purpose of Specific CPU Registers\" which\nspecifically calls out the frame pointer register (x29):\n\n   The frame pointer register (x29) must always address a valid frame\n   record. Some functions \u2014 such as leaf functions or tail calls \u2014 may\n   opt not to create an entry in this list As a result, stack traces\n   are always meaningful, even without debug information.\n\nOther platforms are updated to not override the default.", "tree": {"sha": "3c2ebd468685ef28ed2389e4b3d2180f14106f47", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3c2ebd468685ef28ed2389e4b3d2180f14106f47"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9b1e105ade3cb5b467c94411bbb37168981a02ec", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJguGogCRBK7hj4Ov3rIwAAklAIABT9VPOq+Mu9+Wg/sIOvvqQI\n2Q1sRZw+WFplTKJGjlmqrPQPV2NaD8fxlWssFLCaQ0rS0cy5SBd3lnaIlzbcja1p\nqyuylCw86GnBRT4MZgk2+rzfZBTCywsY2CbUeUs5J/j3XLcYliSVliaKOhDpElhx\ntMJHij5PiliyTlArE9iQz3vj6DWGPQUjI1p4IMzbp/qexWNOhlFou0Vyfmf2w8gx\nhPim4UkueFD6ukZj5nHPVXK8I7/WLJU6GX4T1qtflpC7kq7FWyR/9scbapZnH8dT\nPmnb7gfwJFIT0wQ+r6M5TbA88jTAzUf4ZFOCWprU38BRIlNMnD4OLpLrF9Ukbt4=\n=hFgz\n-----END PGP SIGNATURE-----\n", "payload": "tree 3c2ebd468685ef28ed2389e4b3d2180f14106f47\nparent 9a06f653f72819dd4ac63f1f6bc2d7ff055fc487\nparent aab854596fbd5aaea94c827257988a238c60e38e\nauthor Yuki Okushi <jtitor@2k36.org> 1622698528 +0900\ncommitter GitHub <noreply@github.com> 1622698528 +0900\n\nRollup merge of #85706 - jrmuizel:fpe, r=nagisa\n\nTurn off frame pointer elimination on all Apple platforms.\n\nThis ends up disabling frame pointer elimination on aarch64_apple_darwin\nwhich matches what clang does by default along with the\naarch64_apple_ios and x86_64_apple_darwin targets.\n\nFurther, the Apple docs \"Writing ARM64 Code for Apple Platforms\" has a section\ncalled \"Respect the Purpose of Specific CPU Registers\" which\nspecifically calls out the frame pointer register (x29):\n\n   The frame pointer register (x29) must always address a valid frame\n   record. Some functions \u2014 such as leaf functions or tail calls \u2014 may\n   opt not to create an entry in this list As a result, stack traces\n   are always meaningful, even without debug information.\n\nOther platforms are updated to not override the default.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9b1e105ade3cb5b467c94411bbb37168981a02ec", "html_url": "https://github.com/rust-lang/rust/commit/9b1e105ade3cb5b467c94411bbb37168981a02ec", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9b1e105ade3cb5b467c94411bbb37168981a02ec/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9a06f653f72819dd4ac63f1f6bc2d7ff055fc487", "url": "https://api.github.com/repos/rust-lang/rust/commits/9a06f653f72819dd4ac63f1f6bc2d7ff055fc487", "html_url": "https://github.com/rust-lang/rust/commit/9a06f653f72819dd4ac63f1f6bc2d7ff055fc487"}, {"sha": "aab854596fbd5aaea94c827257988a238c60e38e", "url": "https://api.github.com/repos/rust-lang/rust/commits/aab854596fbd5aaea94c827257988a238c60e38e", "html_url": "https://github.com/rust-lang/rust/commit/aab854596fbd5aaea94c827257988a238c60e38e"}], "stats": {"total": 6, "additions": 1, "deletions": 5}, "files": [{"sha": "5682039b86512aa6b0f3feb98846aa78c6319bcf", "filename": "compiler/rustc_target/src/spec/aarch64_apple_ios.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/9b1e105ade3cb5b467c94411bbb37168981a02ec/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_apple_ios.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9b1e105ade3cb5b467c94411bbb37168981a02ec/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_apple_ios.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_apple_ios.rs?ref=9b1e105ade3cb5b467c94411bbb37168981a02ec", "patch": "@@ -10,7 +10,6 @@ pub fn target() -> Target {\n         arch: \"aarch64\".to_string(),\n         options: TargetOptions {\n             features: \"+neon,+fp-armv8,+apple-a7\".to_string(),\n-            eliminate_frame_pointer: false,\n             max_atomic_width: Some(128),\n             unsupported_abis: super::arm_base::unsupported_abis(),\n             forces_embed_bitcode: true,"}, {"sha": "8a832546d09526334877090c86a9e31cb87a1edc", "filename": "compiler/rustc_target/src/spec/aarch64_apple_ios_macabi.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/9b1e105ade3cb5b467c94411bbb37168981a02ec/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_apple_ios_macabi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9b1e105ade3cb5b467c94411bbb37168981a02ec/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_apple_ios_macabi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_apple_ios_macabi.rs?ref=9b1e105ade3cb5b467c94411bbb37168981a02ec", "patch": "@@ -10,7 +10,6 @@ pub fn target() -> Target {\n         arch: \"aarch64\".to_string(),\n         options: TargetOptions {\n             features: \"+neon,+fp-armv8,+apple-a12\".to_string(),\n-            eliminate_frame_pointer: false,\n             max_atomic_width: Some(128),\n             unsupported_abis: super::arm_base::unsupported_abis(),\n             forces_embed_bitcode: true,"}, {"sha": "2187015b627d3a19e12dde51d0f00af62bbe8381", "filename": "compiler/rustc_target/src/spec/aarch64_apple_ios_sim.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/9b1e105ade3cb5b467c94411bbb37168981a02ec/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_apple_ios_sim.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9b1e105ade3cb5b467c94411bbb37168981a02ec/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_apple_ios_sim.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_apple_ios_sim.rs?ref=9b1e105ade3cb5b467c94411bbb37168981a02ec", "patch": "@@ -18,7 +18,6 @@ pub fn target() -> Target {\n         arch: \"aarch64\".to_string(),\n         options: TargetOptions {\n             features: \"+neon,+fp-armv8,+apple-a7\".to_string(),\n-            eliminate_frame_pointer: false,\n             max_atomic_width: Some(128),\n             unsupported_abis: super::arm_base::unsupported_abis(),\n             forces_embed_bitcode: true,"}, {"sha": "cb6c06b371183f61bcf0e5d8b3b5bda2f2c01c2e", "filename": "compiler/rustc_target/src/spec/aarch64_apple_tvos.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/9b1e105ade3cb5b467c94411bbb37168981a02ec/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_apple_tvos.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9b1e105ade3cb5b467c94411bbb37168981a02ec/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_apple_tvos.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Faarch64_apple_tvos.rs?ref=9b1e105ade3cb5b467c94411bbb37168981a02ec", "patch": "@@ -10,7 +10,6 @@ pub fn target() -> Target {\n         arch: \"aarch64\".to_string(),\n         options: TargetOptions {\n             features: \"+neon,+fp-armv8,+apple-a7\".to_string(),\n-            eliminate_frame_pointer: false,\n             max_atomic_width: Some(128),\n             unsupported_abis: super::arm_base::unsupported_abis(),\n             forces_embed_bitcode: true,"}, {"sha": "8530db179d9919060cfc17886d3ab2726c318ffd", "filename": "compiler/rustc_target/src/spec/apple_base.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/9b1e105ade3cb5b467c94411bbb37168981a02ec/compiler%2Frustc_target%2Fsrc%2Fspec%2Fapple_base.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9b1e105ade3cb5b467c94411bbb37168981a02ec/compiler%2Frustc_target%2Fsrc%2Fspec%2Fapple_base.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Fapple_base.rs?ref=9b1e105ade3cb5b467c94411bbb37168981a02ec", "patch": "@@ -27,6 +27,7 @@ pub fn opts(os: &str) -> TargetOptions {\n         families: vec![\"unix\".to_string()],\n         is_like_osx: true,\n         dwarf_version: Some(2),\n+        eliminate_frame_pointer: false,\n         has_rpath: true,\n         dll_suffix: \".dylib\".to_string(),\n         archive_format: \"darwin\".to_string(),"}, {"sha": "e7f7bb343d0c534541dd31261b886b7a0870efe7", "filename": "compiler/rustc_target/src/spec/apple_sdk_base.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/9b1e105ade3cb5b467c94411bbb37168981a02ec/compiler%2Frustc_target%2Fsrc%2Fspec%2Fapple_sdk_base.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9b1e105ade3cb5b467c94411bbb37168981a02ec/compiler%2Frustc_target%2Fsrc%2Fspec%2Fapple_sdk_base.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_target%2Fsrc%2Fspec%2Fapple_sdk_base.rs?ref=9b1e105ade3cb5b467c94411bbb37168981a02ec", "patch": "@@ -44,7 +44,6 @@ pub fn opts(os: &str, arch: Arch) -> TargetOptions {\n         executables: true,\n         link_env_remove: link_env_remove(arch),\n         has_elf_tls: false,\n-        eliminate_frame_pointer: false,\n         ..super::apple_base::opts(os)\n     }\n }"}]}