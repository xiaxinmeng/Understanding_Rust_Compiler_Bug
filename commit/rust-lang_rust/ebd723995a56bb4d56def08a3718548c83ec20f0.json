{"sha": "ebd723995a56bb4d56def08a3718548c83ec20f0", "node_id": "C_kwDOAAsO6NoAKGViZDcyMzk5NWE1NmJiNGQ1NmRlZjA4YTM3MTg1NDhjODNlYzIwZjA", "commit": {"author": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2022-01-23T16:29:31Z"}, "committer": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2022-01-23T16:42:38Z"}, "message": "fix: don't panic in semantics due to `cfg_attr` disrupting offsets", "tree": {"sha": "111c78818f824ac05e41e33002410c0682c1ecc0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/111c78818f824ac05e41e33002410c0682c1ecc0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ebd723995a56bb4d56def08a3718548c83ec20f0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ebd723995a56bb4d56def08a3718548c83ec20f0", "html_url": "https://github.com/rust-lang/rust/commit/ebd723995a56bb4d56def08a3718548c83ec20f0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ebd723995a56bb4d56def08a3718548c83ec20f0/comments", "author": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "baa5cd95278f36ec9c851c72d6042ed13ab3efac", "url": "https://api.github.com/repos/rust-lang/rust/commits/baa5cd95278f36ec9c851c72d6042ed13ab3efac", "html_url": "https://github.com/rust-lang/rust/commit/baa5cd95278f36ec9c851c72d6042ed13ab3efac"}], "stats": {"total": 8, "additions": 7, "deletions": 1}, "files": [{"sha": "2bffb12deeea7f7db42f7dbaec5d18ab92426383", "filename": "crates/hir/src/semantics.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/ebd723995a56bb4d56def08a3718548c83ec20f0/crates%2Fhir%2Fsrc%2Fsemantics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ebd723995a56bb4d56def08a3718548c83ec20f0/crates%2Fhir%2Fsrc%2Fsemantics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir%2Fsrc%2Fsemantics.rs?ref=ebd723995a56bb4d56def08a3718548c83ec20f0", "patch": "@@ -931,7 +931,8 @@ impl<'db> SemanticsImpl<'db> {\n                 file.with_value(derive.clone()),\n             )?;\n             let attrs = adt_def.attrs(self.db);\n-            let mut derive_paths = attrs[attr_id].parse_path_comma_token_tree()?;\n+            // FIXME: https://github.com/rust-analyzer/rust-analyzer/issues/11298\n+            let mut derive_paths = attrs.get(attr_id)?.parse_path_comma_token_tree()?;\n \n             let derive_idx = tt\n                 .syntax()"}, {"sha": "98177f43014e58d91d231e0ecb929607990f661e", "filename": "crates/hir_def/src/attr.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/ebd723995a56bb4d56def08a3718548c83ec20f0/crates%2Fhir_def%2Fsrc%2Fattr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ebd723995a56bb4d56def08a3718548c83ec20f0/crates%2Fhir_def%2Fsrc%2Fattr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_def%2Fsrc%2Fattr.rs?ref=ebd723995a56bb4d56def08a3718548c83ec20f0", "patch": "@@ -72,6 +72,11 @@ impl ops::Deref for RawAttrs {\n         }\n     }\n }\n+impl Attrs {\n+    pub fn get(&self, AttrId { ast_index, .. }: AttrId) -> Option<&Attr> {\n+        (**self).get(ast_index as usize)\n+    }\n+}\n \n impl ops::Deref for Attrs {\n     type Target = [Attr];"}]}