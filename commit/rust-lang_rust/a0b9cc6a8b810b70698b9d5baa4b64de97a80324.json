{"sha": "a0b9cc6a8b810b70698b9d5baa4b64de97a80324", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEwYjljYzZhOGI4MTBiNzA2OThiOWQ1YmFhNGI2NGRlOTdhODAzMjQ=", "commit": {"author": {"name": "Steve Klabnik", "email": "steve@steveklabnik.com", "date": "2013-09-16T23:30:49Z"}, "committer": {"name": "Steve Klabnik", "email": "steve@steveklabnik.com", "date": "2013-09-16T23:30:49Z"}, "message": "New rustpkg tutorial.", "tree": {"sha": "e5a4b8f4772bcdee5d8bf0465c8a2c64b6c05775", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e5a4b8f4772bcdee5d8bf0465c8a2c64b6c05775"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a0b9cc6a8b810b70698b9d5baa4b64de97a80324", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a0b9cc6a8b810b70698b9d5baa4b64de97a80324", "html_url": "https://github.com/rust-lang/rust/commit/a0b9cc6a8b810b70698b9d5baa4b64de97a80324", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a0b9cc6a8b810b70698b9d5baa4b64de97a80324/comments", "author": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "committer": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0ec4d34b3f0fa1897ace96475a32ff0c8e15b33b", "url": "https://api.github.com/repos/rust-lang/rust/commits/0ec4d34b3f0fa1897ace96475a32ff0c8e15b33b", "html_url": "https://github.com/rust-lang/rust/commit/0ec4d34b3f0fa1897ace96475a32ff0c8e15b33b"}], "stats": {"total": 246, "additions": 246, "deletions": 0}, "files": [{"sha": "d419317745be31f88040ca2226f99539615bbfea", "filename": "doc/tutorial-rustpkg.md", "status": "added", "additions": 244, "deletions": 0, "changes": 244, "blob_url": "https://github.com/rust-lang/rust/blob/a0b9cc6a8b810b70698b9d5baa4b64de97a80324/doc%2Ftutorial-rustpkg.md", "raw_url": "https://github.com/rust-lang/rust/raw/a0b9cc6a8b810b70698b9d5baa4b64de97a80324/doc%2Ftutorial-rustpkg.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/doc%2Ftutorial-rustpkg.md?ref=a0b9cc6a8b810b70698b9d5baa4b64de97a80324", "patch": "@@ -0,0 +1,244 @@\n+% Rust Packaging Tutorial\n+\n+# Introduction\n+\n+Sharing is caring. Rust comes with a tool, `rustpkg`, which allows you to\n+package up your Rust code and share it with other people. This tutorial will\n+get you started on all of the concepts and commands you need to give the gift\n+of Rust code to someone else.\n+\n+## Installing External Packages\n+\n+First, let's try to use an external package somehow. I've made a sample package\n+called `hello` to demonstrate how to do so.  Here's how `hello` is used:\n+\n+~~~~\n+extern mod hello;\n+\n+fn main() {\n+    hello::world();\n+}\n+~~~~\n+\n+Easy! But if you try to compile this, you'll get an error:\n+\n+~~~~ {.notrust}\n+$ rustc main.rs \n+main.rs:1:0: 1:17 error: can't find crate for `hello`\n+main.rs:1 extern mod hello;\n+          ^~~~~~~~~~~~~~~~~\n+\n+~~~~\n+\n+This makes sense, as we haven't gotten it from anywhere yet!  Luckily for us,\n+`rustpkg` has an easy way to fetch others' code: the `install` command. It's\n+used like this:\n+\n+~~~ {.notrust}\n+$ rustpkg install fragment\n+~~~\n+\n+This will install a package named 'fragment' into your current Rust\n+environment. I called it 'fragment' in this example because when using it with\n+an external package like this, it's often a URI fragment. You see, Rust has no\n+central authority for packages. You can build your own `hello` library if you\n+want, and that's fine. We'd both host them in different places and different\n+projects would rely on whichever version they preferred.\n+\n+To install the `hello` library, simply run this in your terminal:\n+\n+~~~ {.notrust}\n+$ rustpkg install github.com/steveklabnik/hello\n+~~~\n+\n+You should see a message that looks like this:\n+\n+~~~ {.notrust}\n+note: Installed package github.com/steveklabnik/hello-0.1 to /some/path/.rust\n+~~~\n+\n+Now, compiling our example should work:\n+\n+~~~ {.notrust}\n+$ rustc main.rs\n+$ ./main \n+Hello, world.\n+~~~\n+\n+Simple! That's all it takes.\n+\n+## Workspaces\n+\n+Before we can talk about how to make packages of your own, you have to\n+understand the big concept with `rustpkg`: workspaces. A 'workspace' is simply\n+a directory that has certain folders that `rustpkg` expects. Different Rust\n+projects will go into different workspaces.\n+\n+A workspace consists of any folder that has the following\n+directories:\n+\n+* `src`: The directory where all the source code goes.\n+* `build`: This directory contains all of the build output.\n+* `lib`: The directory where any libraries distributed with the package go.\n+* `bin`: This directory holds any binaries distributed with the package.\n+\n+There are also default file names you'll want to follow as well:\n+\n+* `main.rs`: A file that's going to become an executable.\n+* `lib.rs`: A file that's going to become a library.\n+\n+## Building your own Package\n+\n+Now that you've got workspaces down, let's build your own copy of `hello`. Go\n+to wherever you keep your personal projects, and let's make all of the\n+directories we'll need. I'll refer to this personal project directory as\n+`~/src` for the rest of this tutorial.\n+\n+### Creating neccesary files\n+\n+~~~ {.notrust}\n+$ cd ~/src\n+$ mkdir -p hello/{src/hello,build,lib,bin}\n+$ cd hello\n+~~~\n+\n+Easy enough! Let's do one or two more things that are nice to do:\n+\n+~~~ {.notrust}\n+$ git init .\n+$ cat > README.md\n+# hello\n+\n+A simple package for Rust.\n+\n+## Installation\n+\n+```\n+$ rustpkg install github.com/YOUR_USERNAME/hello\n+```\n+^D\n+$ cat > .gitignore\n+.rust\n+build\n+^D\n+$ git commit -am \"Initial commit.\"\n+~~~\n+\n+If you're not familliar with the `cat >` idiom, it will make files with the\n+text you type insie. Control-D (`^D`) ends the text for the file.\n+\n+Anyway, we've got a README and a `.gitignore`. Let's talk about that\n+`.gitignore` for a minute: we are ignoring two directories, `build` and\n+`.rust`. `build`, as we discussed earlier, is for build artifacts, and we don't\n+want to check those into a repository. `.rust` is a folder that `rustpkg` uses\n+to keep track of its own settings, as well as the source code of any other\n+external packages that this workspace uses. This is where that `rustpkg\n+install` puts all of its files. Those are also not to go into our repository,\n+so we ignore it all as well.\n+\n+Next, let's add a source file:\n+\n+~~~\n+#[link(name = \"hello\",\n+       vers = \"0.1.0\",\n+       uuid = \"0028fbe0-1f1f-11e3-8224-0800200c9a66\",\n+       url = \"https://github.com/YOUR_USERNAME/hello\")]; \n+\n+#[desc = \"A hello world Rust package.\"];\n+#[license = \"MIT\"];\n+#[crate_type = \"lib\"];\n+\n+pub fn world() {\n+    println(\"Hello, world.\");\n+}\n+~~~\n+\n+Put this into `src/hello/lib.rs`. Let's talk about each of these attributes:\n+\n+### Crate attributes for packages\n+\n+`crate_type` is the simplest: we're building a library here, so we set it to\n+`\"lib\"`. If we were making an executable of some kind, we'd set this to `\"bin\"`\n+instead.\n+\n+`license` is equally simple: the license we want this code to have. I chose MIT\n+here, but you should pick whatever license makes the most sense for you.\n+\n+`desc` is a description of the package and what it does. This should just be a\n+sentence or two.\n+\n+`link` is the big complex attribute here. It's still not too complex: `name` is\n+the name of the package, and `vers` is the version. If you're building a\n+library, consider using [Semantic Versioning](http://semver.org/) as your\n+versioning scheme. Future versions of `rustpkg` will assume SemVer.\n+\n+`uuid` is simply a unique identifier. You can generate a UUID by visiting [this\n+page](http://www.famkruithof.net/uuid/uuidgen). Just copy whatever it puts out\n+into the value for `uuid`. For more on UUIDs, see\n+[RFC4122](http://www.ietf.org/rfc/rfc4122.txt).\n+\n+Finally, `url` is a URL where this package is located. Easy.\n+\n+### Building your package\n+\n+Building your package is simple:\n+\n+~~~ {.notrust}\n+$ rustpkg build hello\n+~~~\n+\n+This will compile `src/hello/lib.rs` into a library. After this process\n+completes, you'll want to check out `build`:\n+\n+~~~ {.notrust}\n+$ ls build/x86_64-unknown-linux-gnu/hello/\n+libhello-ed8619dad9ce7d58-0.1.0.so\n+~~~\n+\n+This directory naming structure is called a 'build triple,' and is because I'm\n+on 64 bit Linux. Yours may differ based on platform.\n+\n+You'll also notice that `src/hello/lib.rs` turned into\n+`libhello-ed8619dad9ce7d58-0.1.0.so`. This is a simple combination of the\n+library name, a hash of its content, and the version.\n+\n+Now that your library builds, you'll want to commit:\n+\n+~~~ {.notrust}\n+$ git add src\n+$ git commit -m \"Adding source code.\"\n+~~~\n+\n+If you're using GitHub, after creating the project, do this:\n+\n+~~~ {.notrust}\n+$ git remote add origin git@github.com:YOUR_USERNAME/hello.git\n+$ git push origin -u master\n+~~~\n+\n+Now you can install and use it! Go anywhere else in your filesystem:\n+\n+~~~ {.notrust}\n+$ cd ~/src/foo\n+$ rustpkg install github/YOUR_USERNAME/hello\n+WARNING: The Rust package manager is experimental and may be unstable\n+note: Installed package github.com/YOUR_USERNAME/hello-0.1 to /home/yourusername/src/hello/.rust\n+~~~\n+\n+That's it!\n+\n+## More resources\n+\n+There's a lot more going on with `rustpkg`, this is just to get you started.\n+Check out [the rustpkg manual](rustpkg.html) for the full details on how to\n+customize `rustpkg`.\n+\n+A tag was created on GitHub specifically for `rustpkg`-related issues. You can\n+[see all the Issues for rustpkg\n+here](https://github.com/mozilla/rust/issues?direction=desc&labels=A-pkg&sort=created&state=open),\n+with bugs as well as new feature plans. `rustpkg` is still under development,\n+and so may be a bit flaky at the moment.\n+\n+You may also want to check out [this blog\n+post](http://tim.dreamwidth.org/1820526.html), which contains some of the early\n+design decisions and justifications."}, {"sha": "7a9bb4adf65e352cb40533e7ffcae57a6b8fcbd5", "filename": "doc/tutorial.md", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a0b9cc6a8b810b70698b9d5baa4b64de97a80324/doc%2Ftutorial.md", "raw_url": "https://github.com/rust-lang/rust/raw/a0b9cc6a8b810b70698b9d5baa4b64de97a80324/doc%2Ftutorial.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/doc%2Ftutorial.md?ref=a0b9cc6a8b810b70698b9d5baa4b64de97a80324", "patch": "@@ -2979,13 +2979,15 @@ tutorials on individual topics.\n * [The foreign function interface][ffi]\n * [Containers and iterators](tutorial-container.html)\n * [Error-handling and Conditions](tutorial-conditions.html)\n+* [Packaging up Rust code](rustpkg)\n \n There is further documentation on the [wiki], however those tend to be even more out of date as this document.\n \n [borrow]: tutorial-borrowed-ptr.html\n [tasks]: tutorial-tasks.html\n [macros]: tutorial-macros.html\n [ffi]: tutorial-ffi.html\n+[rustpkg]: tutorial-rustpkg.html\n \n [wiki]: https://github.com/mozilla/rust/wiki/Docs\n "}]}