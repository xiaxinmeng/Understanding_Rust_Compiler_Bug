{"sha": "b7414fa14a85f4acd37b5bdfdc2a4ab97a072bd2", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI3NDE0ZmExNGE4NWY0YWNkMzdiNWJkZmRjMmE0YWI5N2EwNzJiZDI=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2021-05-25T11:25:00Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-05-25T11:25:00Z"}, "message": "Merge #8986\n\n8986: Add go to type definition for struct fields within struct r=matklad a=lf-\n\nExample:\r\n\r\n```rust\r\nstruct A;\r\n\r\nstruct B {\r\n    a/*<- cursor*/: A,\r\n}\r\n```\r\n\r\nGo to type definition used to not work on this position. It now goes to\r\n`A` as expected.\n\nCo-authored-by: Jade <software@lfcode.ca>", "tree": {"sha": "06a55af22e32a059cd34e8558a79b69960faaf9f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/06a55af22e32a059cd34e8558a79b69960faaf9f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b7414fa14a85f4acd37b5bdfdc2a4ab97a072bd2", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgrN6NCRBK7hj4Ov3rIwAAfdYIABGt6RVSRFH1ewp9Xc9f7ZlK\nH/PwcNhXphT5mXjDF1eZa1c077ON99vQV/tVVeLBzkg1EHGwsdXQCsenW+671VyC\nm9r1+bHzUM5AM27YTAXR9mgSLV/C14/x/cuK+7/lx3pfyL1qcjhJYduq7IwnhGK/\n8bbrcwSZXrtYf5YlMkZVnFehW/4DeXTT/CsgWKLd6cdbX1lIPzYZ1cYFwuU1DyWR\nzc3WzGoxrUG7lT6RKSKLrbmBDLuTXomdQMdwoHW+B5mV80vkbihaOWgQ4cMfkh1c\ntGU0ALbil9hb2LzMPOF9YGBGUvL/awOig/4Xpz4BsbTnzOQNJ0IpSZI2fRvd76s=\n=Z8Oj\n-----END PGP SIGNATURE-----\n", "payload": "tree 06a55af22e32a059cd34e8558a79b69960faaf9f\nparent b250d5e6bfab92c1fe21635536c89e556b8f72d4\nparent ff585e4730a867e7bb68c65ff45867a501841ae4\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1621941900 +0000\ncommitter GitHub <noreply@github.com> 1621941900 +0000\n\nMerge #8986\n\n8986: Add go to type definition for struct fields within struct r=matklad a=lf-\n\nExample:\r\n\r\n```rust\r\nstruct A;\r\n\r\nstruct B {\r\n    a/*<- cursor*/: A,\r\n}\r\n```\r\n\r\nGo to type definition used to not work on this position. It now goes to\r\n`A` as expected.\n\nCo-authored-by: Jade <software@lfcode.ca>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b7414fa14a85f4acd37b5bdfdc2a4ab97a072bd2", "html_url": "https://github.com/rust-lang/rust/commit/b7414fa14a85f4acd37b5bdfdc2a4ab97a072bd2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b7414fa14a85f4acd37b5bdfdc2a4ab97a072bd2/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b250d5e6bfab92c1fe21635536c89e556b8f72d4", "url": "https://api.github.com/repos/rust-lang/rust/commits/b250d5e6bfab92c1fe21635536c89e556b8f72d4", "html_url": "https://github.com/rust-lang/rust/commit/b250d5e6bfab92c1fe21635536c89e556b8f72d4"}, {"sha": "ff585e4730a867e7bb68c65ff45867a501841ae4", "url": "https://api.github.com/repos/rust-lang/rust/commits/ff585e4730a867e7bb68c65ff45867a501841ae4", "html_url": "https://github.com/rust-lang/rust/commit/ff585e4730a867e7bb68c65ff45867a501841ae4"}], "stats": {"total": 32, "additions": 32, "deletions": 0}, "files": [{"sha": "004d9cb688e04806a909272ccb8585c7ffa8cb4d", "filename": "crates/ide/src/goto_type_definition.rs", "status": "modified", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/b7414fa14a85f4acd37b5bdfdc2a4ab97a072bd2/crates%2Fide%2Fsrc%2Fgoto_type_definition.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b7414fa14a85f4acd37b5bdfdc2a4ab97a072bd2/crates%2Fide%2Fsrc%2Fgoto_type_definition.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fgoto_type_definition.rs?ref=b7414fa14a85f4acd37b5bdfdc2a4ab97a072bd2", "patch": "@@ -1,3 +1,4 @@\n+use ide_db::base_db::Upcast;\n use ide_db::RootDatabase;\n use syntax::{ast, match_ast, AstNode, SyntaxKind::*, SyntaxToken, TokenAtOffset, T};\n \n@@ -31,6 +32,7 @@ pub(crate) fn goto_type_definition(\n                 ast::Pat(it) => sema.type_of_pat(&it)?,\n                 ast::SelfParam(it) => sema.type_of_self(&it)?,\n                 ast::Type(it) => sema.resolve_type(&it)?,\n+                ast::RecordField(it) => sema.to_def(&it).map(|d| d.ty(db.upcast()))?,\n                 _ => return None,\n             }\n         };\n@@ -161,4 +163,34 @@ impl Foo$0 {}\n \"#,\n         )\n     }\n+\n+    #[test]\n+    fn goto_def_for_struct_field() {\n+        check(\n+            r#\"\n+struct Bar;\n+     //^^^\n+\n+struct Foo {\n+    bar$0: Bar,\n+}\n+\"#,\n+        );\n+    }\n+\n+    #[test]\n+    fn goto_def_for_enum_struct_field() {\n+        check(\n+            r#\"\n+struct Bar;\n+     //^^^\n+\n+enum Foo {\n+    Bar {\n+        bar$0: Bar\n+    },\n+}\n+\"#,\n+        );\n+    }\n }"}]}