{"sha": "b9671ae5f81cf20536b58869a7fad1363a78b375", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI5NjcxYWU1ZjgxY2YyMDUzNmI1ODg2OWE3ZmFkMTM2M2E3OGIzNzU=", "commit": {"author": {"name": "Dylan DPC", "email": "dylan.dpc@gmail.com", "date": "2020-11-09T00:13:31Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-11-09T00:13:31Z"}, "message": "Rollup merge of #78114 - jyn514:private, r=oli-obk\n\nRecognize `private_intra_doc_links` as a lint\n\nPreviously, trying to allow this would give another error!\n\n```\nwarning: unknown lint: `private_intra_doc_links`\n --> private.rs:1:10\n  |\n1 | #![allow(private_intra_doc_links)]\n  |          ^^^^^^^^^^^^^^^^^^^^^^^ help: did you mean: `broken_intra_doc_links`\n  |\n  = note: `#[warn(unknown_lints)]` on by default\n\nwarning: public documentation for `DocMe` links to private item `DontDocMe`\n --> private.rs:2:11\n  |\n2 | /// docs [DontDocMe]\n  |           ^^^^^^^^^ this item is private\n  |\n  = note: `#[warn(private_intra_doc_links)]` on by default\n  = note: this link will resolve properly if you pass `--document-private-items`\n```\n\nFixes the issue found in https://github.com/rust-lang/rust/pull/77249#issuecomment-712339227.\n\nr? ````````@Manishearth````````\n\nDoes anyone know why this additional step is necessary? It seems weird this has to be declared in 3 different places.", "tree": {"sha": "eb339b34c9dbd78fbc6d18433253efb4316b234b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/eb339b34c9dbd78fbc6d18433253efb4316b234b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b9671ae5f81cf20536b58869a7fad1363a78b375", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfqImsCRBK7hj4Ov3rIwAAdHIIABUol/4euaWJoAN+pe2mVMxl\nFA98ATGuLpVyRPm3M7YzM61Vwxg9O+BzLMIiS+KO3QA8DaefqJ4/BvJU3VJcfO9h\naa9zh4lEuDFOpzNQo/wu2lL4gnk0IAL0MhOg/ihlRuAp3zMN8n/VphI482QilJl4\nHlIlbI6CzWBxlThwLvkyoERdYVYEWVsxG4oKNofBgOS6sYOw5Q0kF+kF1fqyr8ZK\n+UQ5N6HBe8t260C82YyfNjQPpdXIB3ieKPPiBt3JB6XJ8CoTP1il9rPlddG15Otk\nS2/tApZL23JdbrzYCLvKwfSA7lqyA/+MrivVEwNgJ1sS1Roz2eTsciw6d3TK11g=\n=YBR7\n-----END PGP SIGNATURE-----\n", "payload": "tree eb339b34c9dbd78fbc6d18433253efb4316b234b\nparent 41134be153ec0e152b0bb5cf79731abdde7c4e04\nparent 47b21b84f3ed88cff31fccc78a57a66241a26496\nauthor Dylan DPC <dylan.dpc@gmail.com> 1604880811 +0100\ncommitter GitHub <noreply@github.com> 1604880811 +0100\n\nRollup merge of #78114 - jyn514:private, r=oli-obk\n\nRecognize `private_intra_doc_links` as a lint\n\nPreviously, trying to allow this would give another error!\n\n```\nwarning: unknown lint: `private_intra_doc_links`\n --> private.rs:1:10\n  |\n1 | #![allow(private_intra_doc_links)]\n  |          ^^^^^^^^^^^^^^^^^^^^^^^ help: did you mean: `broken_intra_doc_links`\n  |\n  = note: `#[warn(unknown_lints)]` on by default\n\nwarning: public documentation for `DocMe` links to private item `DontDocMe`\n --> private.rs:2:11\n  |\n2 | /// docs [DontDocMe]\n  |           ^^^^^^^^^ this item is private\n  |\n  = note: `#[warn(private_intra_doc_links)]` on by default\n  = note: this link will resolve properly if you pass `--document-private-items`\n```\n\nFixes the issue found in https://github.com/rust-lang/rust/pull/77249#issuecomment-712339227.\n\nr? ````````@Manishearth````````\n\nDoes anyone know why this additional step is necessary? It seems weird this has to be declared in 3 different places.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b9671ae5f81cf20536b58869a7fad1363a78b375", "html_url": "https://github.com/rust-lang/rust/commit/b9671ae5f81cf20536b58869a7fad1363a78b375", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b9671ae5f81cf20536b58869a7fad1363a78b375/comments", "author": {"login": "Dylan-DPC", "id": 99973273, "node_id": "U_kgDOBfV4mQ", "avatar_url": "https://avatars.githubusercontent.com/u/99973273?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dylan-DPC", "html_url": "https://github.com/Dylan-DPC", "followers_url": "https://api.github.com/users/Dylan-DPC/followers", "following_url": "https://api.github.com/users/Dylan-DPC/following{/other_user}", "gists_url": "https://api.github.com/users/Dylan-DPC/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dylan-DPC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dylan-DPC/subscriptions", "organizations_url": "https://api.github.com/users/Dylan-DPC/orgs", "repos_url": "https://api.github.com/users/Dylan-DPC/repos", "events_url": "https://api.github.com/users/Dylan-DPC/events{/privacy}", "received_events_url": "https://api.github.com/users/Dylan-DPC/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "41134be153ec0e152b0bb5cf79731abdde7c4e04", "url": "https://api.github.com/repos/rust-lang/rust/commits/41134be153ec0e152b0bb5cf79731abdde7c4e04", "html_url": "https://github.com/rust-lang/rust/commit/41134be153ec0e152b0bb5cf79731abdde7c4e04"}, {"sha": "47b21b84f3ed88cff31fccc78a57a66241a26496", "url": "https://api.github.com/repos/rust-lang/rust/commits/47b21b84f3ed88cff31fccc78a57a66241a26496", "html_url": "https://github.com/rust-lang/rust/commit/47b21b84f3ed88cff31fccc78a57a66241a26496"}], "stats": {"total": 12, "additions": 7, "deletions": 5}, "files": [{"sha": "1d0d6980b7a89dea87a10e1715654c9018e4cb5b", "filename": "compiler/rustc_lint_defs/src/builtin.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b9671ae5f81cf20536b58869a7fad1363a78b375/compiler%2Frustc_lint_defs%2Fsrc%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b9671ae5f81cf20536b58869a7fad1363a78b375/compiler%2Frustc_lint_defs%2Fsrc%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint_defs%2Fsrc%2Fbuiltin.rs?ref=b9671ae5f81cf20536b58869a7fad1363a78b375", "patch": "@@ -2801,6 +2801,7 @@ declare_lint_pass! {\n         UNSTABLE_NAME_COLLISIONS,\n         IRREFUTABLE_LET_PATTERNS,\n         BROKEN_INTRA_DOC_LINKS,\n+        PRIVATE_INTRA_DOC_LINKS,\n         INVALID_CODEBLOCK_ATTRIBUTES,\n         MISSING_CRATE_LEVEL_DOCS,\n         MISSING_DOC_CODE_EXAMPLES,"}, {"sha": "4cad6418d6a5a886416f4bac27981a5e90e15d38", "filename": "src/librustdoc/core.rs", "status": "modified", "additions": 6, "deletions": 5, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/b9671ae5f81cf20536b58869a7fad1363a78b375/src%2Flibrustdoc%2Fcore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b9671ae5f81cf20536b58869a7fad1363a78b375/src%2Flibrustdoc%2Fcore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fcore.rs?ref=b9671ae5f81cf20536b58869a7fad1363a78b375", "patch": "@@ -322,7 +322,8 @@ pub fn run_core(\n     let cpath = Some(input.clone());\n     let input = Input::File(input);\n \n-    let intra_link_resolution_failure_name = lint::builtin::BROKEN_INTRA_DOC_LINKS.name;\n+    let broken_intra_doc_links = lint::builtin::BROKEN_INTRA_DOC_LINKS.name;\n+    let private_intra_doc_links = lint::builtin::PRIVATE_INTRA_DOC_LINKS.name;\n     let missing_docs = rustc_lint::builtin::MISSING_DOCS.name;\n     let missing_doc_example = rustc_lint::builtin::MISSING_DOC_CODE_EXAMPLES.name;\n     let private_doc_tests = rustc_lint::builtin::PRIVATE_DOC_TESTS.name;\n@@ -336,7 +337,8 @@ pub fn run_core(\n     // In addition to those specific lints, we also need to allow those given through\n     // command line, otherwise they'll get ignored and we don't want that.\n     let lints_to_show = vec![\n-        intra_link_resolution_failure_name.to_owned(),\n+        broken_intra_doc_links.to_owned(),\n+        private_intra_doc_links.to_owned(),\n         missing_docs.to_owned(),\n         missing_doc_example.to_owned(),\n         private_doc_tests.to_owned(),\n@@ -349,9 +351,8 @@ pub fn run_core(\n     ];\n \n     let (lint_opts, lint_caps) = init_lints(lints_to_show, lint_opts, |lint| {\n-        if lint.name == intra_link_resolution_failure_name\n-            || lint.name == invalid_codeblock_attributes_name\n-        {\n+        // FIXME: why is this necessary?\n+        if lint.name == broken_intra_doc_links || lint.name == invalid_codeblock_attributes_name {\n             None\n         } else {\n             Some((lint.name_lower(), lint::Allow))"}]}