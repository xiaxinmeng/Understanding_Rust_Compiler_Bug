{"sha": "61249b360e9aef29413516e07a57d3056648e9b3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYxMjQ5YjM2MGU5YWVmMjk0MTM1MTZlMDdhNTdkMzA1NjY0OGU5YjM=", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2018-09-09T21:40:26Z"}, "committer": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2018-09-09T21:45:29Z"}, "message": "impl std::fmt::Debug for VersionInfo\n\nFor clippy, this would print:\nVersionInfo { crate_name: \"clippy\", major: 0, minor: 0, patch: 212, commit_hash: \"084be7ba\", commit_date: \"2018-09-09\" }", "tree": {"sha": "fb273bd70cb2e35bed8137961012455d85e3a526", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fb273bd70cb2e35bed8137961012455d85e3a526"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/61249b360e9aef29413516e07a57d3056648e9b3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/61249b360e9aef29413516e07a57d3056648e9b3", "html_url": "https://github.com/rust-lang/rust/commit/61249b360e9aef29413516e07a57d3056648e9b3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/61249b360e9aef29413516e07a57d3056648e9b3/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2d3298b8c4df8da4b597b33104e235b0fafbe1e9", "url": "https://api.github.com/repos/rust-lang/rust/commits/2d3298b8c4df8da4b597b33104e235b0fafbe1e9", "html_url": "https://github.com/rust-lang/rust/commit/2d3298b8c4df8da4b597b33104e235b0fafbe1e9"}], "stats": {"total": 37, "additions": 35, "deletions": 2}, "files": [{"sha": "33e1d979dce405cc84a8dd8eb12559b7bea132c5", "filename": "rustc_tools_util/src/lib.rs", "status": "modified", "additions": 35, "deletions": 2, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/61249b360e9aef29413516e07a57d3056648e9b3/rustc_tools_util%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/61249b360e9aef29413516e07a57d3056648e9b3/rustc_tools_util%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/rustc_tools_util%2Fsrc%2Flib.rs?ref=61249b360e9aef29413516e07a57d3056648e9b3", "patch": "@@ -61,6 +61,30 @@ impl std::fmt::Display for VersionInfo {\n     }\n }\n \n+impl std::fmt::Debug for VersionInfo {\n+    fn fmt(&self, f: &mut std::fmt::Formatter) -> std::fmt::Result {\n+        write!(\n+            f,\n+            \"VersionInfo {{ crate_name: \\\"{}\\\", major: {}, minor: {}, patch: {}\",\n+            self.crate_name, self.major, self.minor, self.patch,\n+        )?;\n+        match self.commit_hash {\n+            Some(_) => {\n+                write!(\n+                    f,\n+                    \", commit_hash: \\\"{}\\\", commit_date: \\\"{}\\\" }}\",\n+                    self.commit_hash.clone().unwrap_or_default().trim(),\n+                    self.commit_date.clone().unwrap_or_default().trim()\n+                )?;\n+            },\n+            None => {\n+                write!(f, \" }}\")?;\n+            },\n+        }\n+        Ok(())\n+    }\n+}\n+\n pub fn get_channel() -> Option<String> {\n     if let Ok(channel) = env::var(\"CFG_RELEASE_CHANNEL\") {\n         Some(channel)\n@@ -105,8 +129,17 @@ mod test {\n     #[test]\n     fn test_display_local() {\n         let vi = get_version_info!();\n-        let fmt = format!(\"{}\", vi);\n-        assert_eq!(fmt, \"rustc_tools_util 0.1.0\");\n+        assert_eq!(vi.to_string(), \"rustc_tools_util 0.1.0\");\n+    }\n+\n+    #[test]\n+    fn test_debug_local() {\n+        let vi = get_version_info!();\n+        let s = format!(\"{:?}\", vi);\n+        assert_eq!(\n+            s,\n+            \"VersionInfo { crate_name: \\\"rustc_tools_util\\\", major: 0, minor: 1, patch: 0 }\"\n+        );\n     }\n \n }"}]}