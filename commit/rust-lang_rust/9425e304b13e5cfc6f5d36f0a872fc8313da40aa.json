{"sha": "9425e304b13e5cfc6f5d36f0a872fc8313da40aa", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk0MjVlMzA0YjEzZTVjZmM2ZjVkMzZmMGE4NzJmYzgzMTNkYTQwYWE=", "commit": {"author": {"name": "Caleb Sander", "email": "caleb.sander@gmail.com", "date": "2020-12-28T20:45:36Z"}, "committer": {"name": "Caleb Sander", "email": "caleb.sander@gmail.com", "date": "2021-03-03T17:26:20Z"}, "message": "Avoid unnecessary Vec construction in BufReader", "tree": {"sha": "b96692bebecd5ef529f2cd8ec7d50c298917ead1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b96692bebecd5ef529f2cd8ec7d50c298917ead1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9425e304b13e5cfc6f5d36f0a872fc8313da40aa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9425e304b13e5cfc6f5d36f0a872fc8313da40aa", "html_url": "https://github.com/rust-lang/rust/commit/9425e304b13e5cfc6f5d36f0a872fc8313da40aa", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9425e304b13e5cfc6f5d36f0a872fc8313da40aa/comments", "author": {"login": "calebsander", "id": 4256376, "node_id": "MDQ6VXNlcjQyNTYzNzY=", "avatar_url": "https://avatars.githubusercontent.com/u/4256376?v=4", "gravatar_id": "", "url": "https://api.github.com/users/calebsander", "html_url": "https://github.com/calebsander", "followers_url": "https://api.github.com/users/calebsander/followers", "following_url": "https://api.github.com/users/calebsander/following{/other_user}", "gists_url": "https://api.github.com/users/calebsander/gists{/gist_id}", "starred_url": "https://api.github.com/users/calebsander/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/calebsander/subscriptions", "organizations_url": "https://api.github.com/users/calebsander/orgs", "repos_url": "https://api.github.com/users/calebsander/repos", "events_url": "https://api.github.com/users/calebsander/events{/privacy}", "received_events_url": "https://api.github.com/users/calebsander/received_events", "type": "User", "site_admin": false}, "committer": {"login": "calebsander", "id": 4256376, "node_id": "MDQ6VXNlcjQyNTYzNzY=", "avatar_url": "https://avatars.githubusercontent.com/u/4256376?v=4", "gravatar_id": "", "url": "https://api.github.com/users/calebsander", "html_url": "https://github.com/calebsander", "followers_url": "https://api.github.com/users/calebsander/followers", "following_url": "https://api.github.com/users/calebsander/following{/other_user}", "gists_url": "https://api.github.com/users/calebsander/gists{/gist_id}", "starred_url": "https://api.github.com/users/calebsander/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/calebsander/subscriptions", "organizations_url": "https://api.github.com/users/calebsander/orgs", "repos_url": "https://api.github.com/users/calebsander/repos", "events_url": "https://api.github.com/users/calebsander/events{/privacy}", "received_events_url": "https://api.github.com/users/calebsander/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "939b14334dfec68d85b01b62c1be0172cee03339", "url": "https://api.github.com/repos/rust-lang/rust/commits/939b14334dfec68d85b01b62c1be0172cee03339", "html_url": "https://github.com/rust-lang/rust/commit/939b14334dfec68d85b01b62c1be0172cee03339"}], "stats": {"total": 8, "additions": 4, "deletions": 4}, "files": [{"sha": "152bd34ffbaf204d2fad7fcab00827b64f3ff4c5", "filename": "library/std/src/io/buffered/bufreader.rs", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/9425e304b13e5cfc6f5d36f0a872fc8313da40aa/library%2Fstd%2Fsrc%2Fio%2Fbuffered%2Fbufreader.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9425e304b13e5cfc6f5d36f0a872fc8313da40aa/library%2Fstd%2Fsrc%2Fio%2Fbuffered%2Fbufreader.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fio%2Fbuffered%2Fbufreader.rs?ref=9425e304b13e5cfc6f5d36f0a872fc8313da40aa", "patch": "@@ -90,10 +90,9 @@ impl<R: Read> BufReader<R> {\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     pub fn with_capacity(capacity: usize, inner: R) -> BufReader<R> {\n         unsafe {\n-            let mut buffer = Vec::with_capacity(capacity);\n-            buffer.set_len(capacity);\n-            inner.initializer().initialize(&mut buffer);\n-            BufReader { inner, buf: buffer.into_boxed_slice(), pos: 0, cap: 0 }\n+            let mut buf = Box::new_uninit_slice(capacity).assume_init();\n+            inner.initializer().initialize(&mut buf);\n+            BufReader { inner, buf, pos: 0, cap: 0 }\n         }\n     }\n }"}, {"sha": "f62fb83533ca2e3a61660027aa0278c461683f97", "filename": "library/std/src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/9425e304b13e5cfc6f5d36f0a872fc8313da40aa/library%2Fstd%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9425e304b13e5cfc6f5d36f0a872fc8313da40aa/library%2Fstd%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Flib.rs?ref=9425e304b13e5cfc6f5d36f0a872fc8313da40aa", "patch": "@@ -289,6 +289,7 @@\n #![feature(needs_panic_runtime)]\n #![feature(negative_impls)]\n #![feature(never_type)]\n+#![feature(new_uninit)]\n #![feature(nll)]\n #![feature(nonnull_slice_from_raw_parts)]\n #![feature(once_cell)]"}]}