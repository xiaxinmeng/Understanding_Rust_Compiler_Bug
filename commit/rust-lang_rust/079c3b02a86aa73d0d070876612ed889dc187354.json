{"sha": "079c3b02a86aa73d0d070876612ed889dc187354", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA3OWMzYjAyYTg2YWE3M2QwZDA3MDg3NjYxMmVkODg5ZGMxODczNTQ=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2012-04-30T22:40:04Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2012-05-01T00:48:38Z"}, "message": "Update llvm and integrate clang and compiler-rt.", "tree": {"sha": "be382e45986e839bc6751da477008bb017f3d851", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/be382e45986e839bc6751da477008bb017f3d851"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/079c3b02a86aa73d0d070876612ed889dc187354", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/079c3b02a86aa73d0d070876612ed889dc187354", "html_url": "https://github.com/rust-lang/rust/commit/079c3b02a86aa73d0d070876612ed889dc187354", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/079c3b02a86aa73d0d070876612ed889dc187354/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5b98000279e058a390670c3b6f304af7aa02e46a", "url": "https://api.github.com/repos/rust-lang/rust/commits/5b98000279e058a390670c3b6f304af7aa02e46a", "html_url": "https://github.com/rust-lang/rust/commit/5b98000279e058a390670c3b6f304af7aa02e46a"}], "stats": {"total": 53, "additions": 23, "deletions": 30}, "files": [{"sha": "7ee140e60692219d1b48015ac2b74123b8f6e7d4", "filename": "configure", "status": "modified", "additions": 21, "deletions": 28, "changes": 49, "blob_url": "https://github.com/rust-lang/rust/blob/079c3b02a86aa73d0d070876612ed889dc187354/configure", "raw_url": "https://github.com/rust-lang/rust/raw/079c3b02a86aa73d0d070876612ed889dc187354/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=079c3b02a86aa73d0d070876612ed889dc187354", "patch": "@@ -259,9 +259,9 @@ esac\n \n DEFAULT_HOST_TRIPLE=\"${CFG_CPUTYPE}-${CFG_OSTYPE}\"\n \n-CFG_SELF=$(echo $0 | tr '\\\\' '/')\n-CFG_SRC_DIR=\"$(dirname $CFG_SELF)/\"\n-CFG_BUILD_DIR=\"$(echo $PWD | tr '\\\\' '/')/\"\n+CFG_SRC_DIR=\"$(cd $(dirname $0) && pwd)/\"\n+CFG_BUILD_DIR=\"$(pwd)/\"\n+CFG_SELF=${CFG_SRC_DIR}$(basename $0)\n CFG_CONFIGURE_ARGS=\"$@\"\n \n OPTIONS=\"\"\n@@ -509,32 +509,25 @@ step_msg \"configuring submodules\"\n if [ -z $CFG_DISABLE_MANAGE_SUBMODULES ]\n then\n     cd ${CFG_SRC_DIR}\n+\n     msg \"git: submodule sync\"\n-    \"${CFG_GIT}\" submodule sync --quiet\n-    SUBMODULES=$(\"${CFG_GIT}\" submodule status | awk '{print $2}')\n-    for s in $SUBMODULES\n-    do\n-        msg \"git: submodule status ${s}\"\n-        status=$(\"${CFG_GIT}\" submodule status ${s} | awk '{print $1}')\n-        case ${status} in\n-            -*)\n-                msg \"${s} is not initialized, initializing\"\n-                \"${CFG_GIT}\" submodule init --quiet ${s}\n-                need_ok \"git failed\"\n-                msg \"${s} updating\"\n-                \"${CFG_GIT}\" submodule update --quiet ${s}\n-                need_ok \"git failed\"\n-                ;;\n-            +*)\n-                msg \"${s} is not up to date, updating\"\n-                \"${CFG_GIT}\" submodule update --quiet ${s}\n-                need_ok \"git failed\"\n-                ;;\n-            *)\n-                msg \"${s} is clean\"\n-                ;;\n-        esac\n-    done\n+    \"${CFG_GIT}\" submodule --quiet sync\n+\n+    # NB: this is just for the sake of getting the submodule SHA1 values\n+    # and status written into the build log.\n+    msg \"git: submodule status\"\n+    \"${CFG_GIT}\" submodule status --recursive\n+\n+    msg \"git: submodule update\"\n+    \"${CFG_GIT}\" submodule --quiet update --init --recursive\n+    need_ok \"git failed\"\n+\n+    msg \"git: submodule clobber\"\n+    \"${CFG_GIT}\" submodule --quiet foreach --recursive git clean -dxf\n+    need_ok \"git failed\"\n+    \"${CFG_GIT}\" submodule --quiet foreach --recursive git checkout .\n+    need_ok \"git failed\"\n+\n     cd ${CFG_BUILD_DIR}\n fi\n "}, {"sha": "3a57b672f89adcb2d2d06adc564dc15ca4e276d6", "filename": "src/llvm", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": null, "raw_url": null, "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fllvm?ref=079c3b02a86aa73d0d070876612ed889dc187354", "patch": "@@ -1 +1 @@\n-Subproject commit 8b035b5fe83ca15df171e581681bbc9cbd7e2ae0\n+Subproject commit 3a57b672f89adcb2d2d06adc564dc15ca4e276d6"}, {"sha": "bdf16266d2e681595ece8baa6a0f347680ad0892", "filename": "src/rustllvm/RustWrapper.cpp", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/079c3b02a86aa73d0d070876612ed889dc187354/src%2Frustllvm%2FRustWrapper.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/079c3b02a86aa73d0d070876612ed889dc187354/src%2Frustllvm%2FRustWrapper.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustllvm%2FRustWrapper.cpp?ref=079c3b02a86aa73d0d070876612ed889dc187354", "patch": "@@ -97,7 +97,7 @@ LLVMRustWriteOutputFile(LLVMPassManagerRef PMR,\n   const Target *TheTarget = TargetRegistry::lookupTarget(triple, Err);\n   std::string FeaturesStr;\n   std::string Trip(triple);\n-  std::string CPUStr = llvm::sys::getHostCPUName();\n+  std::string CPUStr(\"generic\");\n   TargetMachine *Target =\n     TheTarget->createTargetMachine(Trip, CPUStr, FeaturesStr,\n \t\t\t\t   Options, Reloc::PIC_,"}]}