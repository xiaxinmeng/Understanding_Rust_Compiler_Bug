{"sha": "14f477e78adb9960f760e9bac812673f993d8dc2", "node_id": "C_kwDOAAsO6NoAKDE0ZjQ3N2U3OGFkYjk5NjBmNzYwZTliYWM4MTI2NzNmOTkzZDhkYzI", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-05-28T22:24:53Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-05-28T22:24:53Z"}, "message": "Auto merge of #97472 - cuviper:rebase-rustc-rayon, r=Mark-Simulacrum\n\nUpdate to rebased rustc-rayon 0.4\n\nIn rayon-rs/rayon#938, miri uncovered a race in `rustc-rayon-core` that had already been fixed in the regular `rayon-core`. I have now rebased that fork onto the latest rayon branch, and published as 0.4. I also updated `indexmap` to bump the dependency.\n\n`Cargo.lock` changes:\n\n    Updating indexmap v1.8.0 -> v1.8.2\n    Updating rayon v1.5.1 -> v1.5.3\n    Updating rayon-core v1.9.1 -> v1.9.3\n    Updating rustc-rayon v0.3.2 -> v0.4.0\n    Updating rustc-rayon-core v0.3.2 -> v0.4.1", "tree": {"sha": "6c96e452672687c8dc1239c1b79f616fc37bceec", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6c96e452672687c8dc1239c1b79f616fc37bceec"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/14f477e78adb9960f760e9bac812673f993d8dc2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/14f477e78adb9960f760e9bac812673f993d8dc2", "html_url": "https://github.com/rust-lang/rust/commit/14f477e78adb9960f760e9bac812673f993d8dc2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/14f477e78adb9960f760e9bac812673f993d8dc2/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1fede1753c33f4ce0660ad9b8edbd618d9733daf", "url": "https://api.github.com/repos/rust-lang/rust/commits/1fede1753c33f4ce0660ad9b8edbd618d9733daf", "html_url": "https://github.com/rust-lang/rust/commit/1fede1753c33f4ce0660ad9b8edbd618d9733daf"}, {"sha": "ab57e36268858bd4f1e3de571da94ecdb670c08c", "url": "https://api.github.com/repos/rust-lang/rust/commits/ab57e36268858bd4f1e3de571da94ecdb670c08c", "html_url": "https://github.com/rust-lang/rust/commit/ab57e36268858bd4f1e3de571da94ecdb670c08c"}], "stats": {"total": 43, "additions": 22, "deletions": 21}, "files": [{"sha": "eb0197d770fe8f34048242f740376be3efbed73d", "filename": "Cargo.lock", "status": "modified", "additions": 12, "deletions": 12, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/14f477e78adb9960f760e9bac812673f993d8dc2/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/14f477e78adb9960f760e9bac812673f993d8dc2/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=14f477e78adb9960f760e9bac812673f993d8dc2", "patch": "@@ -1817,9 +1817,9 @@ dependencies = [\n \n [[package]]\n name = \"indexmap\"\n-version = \"1.8.0\"\n+version = \"1.8.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"282a6247722caba404c065016bbfa522806e51714c34f5dfc3e4a3a46fcb4223\"\n+checksum = \"e6012d540c5baa3589337a98ce73408de9b5a25ec9fc2c6fd6be8f0d39e0ca5a\"\n dependencies = [\n  \"autocfg\",\n  \"hashbrown 0.11.2\",\n@@ -3126,9 +3126,9 @@ dependencies = [\n \n [[package]]\n name = \"rayon\"\n-version = \"1.5.1\"\n+version = \"1.5.3\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"c06aca804d41dbc8ba42dfd964f0d01334eceb64314b9ecf7c5fad5188a06d90\"\n+checksum = \"bd99e5772ead8baa5215278c9b15bf92087709e9c1b2d1f97cdb5a183c933a7d\"\n dependencies = [\n  \"autocfg\",\n  \"crossbeam-deque\",\n@@ -3138,14 +3138,13 @@ dependencies = [\n \n [[package]]\n name = \"rayon-core\"\n-version = \"1.9.1\"\n+version = \"1.9.3\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"d78120e2c850279833f1dd3582f730c4ab53ed95aeaaaa862a2a5c71b1656d8e\"\n+checksum = \"258bcdb5ac6dad48491bb2992db6b7cf74878b0384908af124823d118c99683f\"\n dependencies = [\n  \"crossbeam-channel\",\n  \"crossbeam-deque\",\n  \"crossbeam-utils\",\n- \"lazy_static\",\n  \"num_cpus\",\n ]\n \n@@ -3378,24 +3377,25 @@ dependencies = [\n \n [[package]]\n name = \"rustc-rayon\"\n-version = \"0.3.2\"\n+version = \"0.4.0\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"9974ab223660e61c1b4e7b43b827379df286736ca988308ce7e16f59f2d89246\"\n+checksum = \"1a79f0b0b2609e2eacf9758013f50e7176cb4b29fd6436a747b14a5362c8727a\"\n dependencies = [\n+ \"autocfg\",\n  \"crossbeam-deque\",\n  \"either\",\n  \"rustc-rayon-core\",\n ]\n \n [[package]]\n name = \"rustc-rayon-core\"\n-version = \"0.3.2\"\n+version = \"0.4.1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n-checksum = \"564bfd27be8db888d0fa76aa4335e7851aaed0c2c11ad1e93aeb9349f6b88500\"\n+checksum = \"02269144a0db9bb55cf5d4a41a5a0e95b334b0b78b08269018ca9b0250718c30\"\n dependencies = [\n+ \"crossbeam-channel\",\n  \"crossbeam-deque\",\n  \"crossbeam-utils\",\n- \"lazy_static\",\n  \"num_cpus\",\n ]\n "}, {"sha": "33deadb32d447783659449c7bdadfbfa6fc4174a", "filename": "compiler/rustc_data_structures/Cargo.toml", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/14f477e78adb9960f760e9bac812673f993d8dc2/compiler%2Frustc_data_structures%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/14f477e78adb9960f760e9bac812673f993d8dc2/compiler%2Frustc_data_structures%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_data_structures%2FCargo.toml?ref=14f477e78adb9960f760e9bac812673f993d8dc2", "patch": "@@ -9,16 +9,16 @@ doctest = false\n [dependencies]\n arrayvec = { version = \"0.7\", default-features = false }\n ena = \"0.14\"\n-indexmap = { version = \"1.8.0\" }\n+indexmap = { version = \"1.8.2\" }\n tracing = \"0.1\"\n jobserver_crate = { version = \"0.1.13\", package = \"jobserver\" }\n rustc_serialize = { path = \"../rustc_serialize\" }\n rustc_macros = { path = \"../rustc_macros\" }\n rustc_graphviz = { path = \"../rustc_graphviz\" }\n cfg-if = \"0.1.2\"\n stable_deref_trait = \"1.0.0\"\n-rayon = { version = \"0.3.2\", package = \"rustc-rayon\", optional = true }\n-rayon-core = { version = \"0.3.2\", package = \"rustc-rayon-core\", optional = true }\n+rayon = { version = \"0.4.0\", package = \"rustc-rayon\", optional = true }\n+rayon-core = { version = \"0.4.0\", package = \"rustc-rayon-core\", optional = true }\n rustc-hash = \"1.1.0\"\n smallvec = { version = \"1.6.1\", features = [\"const_generics\", \"union\", \"may_dangle\"] }\n rustc_index = { path = \"../rustc_index\", package = \"rustc_index\" }"}, {"sha": "47dc5f2ef86704e052c2bb1bcca924de76f2cedd", "filename": "compiler/rustc_interface/Cargo.toml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/14f477e78adb9960f760e9bac812673f993d8dc2/compiler%2Frustc_interface%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/14f477e78adb9960f760e9bac812673f993d8dc2/compiler%2Frustc_interface%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_interface%2FCargo.toml?ref=14f477e78adb9960f760e9bac812673f993d8dc2", "patch": "@@ -10,8 +10,8 @@ doctest = false\n libc = \"0.2\"\n libloading = \"0.7.1\"\n tracing = \"0.1\"\n-rustc-rayon-core = { version = \"0.3.2\", optional = true }\n-rayon = { version = \"0.3.2\", package = \"rustc-rayon\", optional = true }\n+rustc-rayon-core = { version = \"0.4.0\", optional = true }\n+rayon = { version = \"0.4.0\", package = \"rustc-rayon\", optional = true }\n smallvec = { version = \"1.6.1\", features = [\"union\", \"may_dangle\"] }\n rustc_ast = { path = \"../rustc_ast\" }\n rustc_attr = { path = \"../rustc_attr\" }"}, {"sha": "cee80823443f53c29e55cbfe49c21c569a4fd4f1", "filename": "compiler/rustc_middle/Cargo.toml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/14f477e78adb9960f760e9bac812673f993d8dc2/compiler%2Frustc_middle%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/14f477e78adb9960f760e9bac812673f993d8dc2/compiler%2Frustc_middle%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2FCargo.toml?ref=14f477e78adb9960f760e9bac812673f993d8dc2", "patch": "@@ -12,8 +12,8 @@ bitflags = \"1.2.1\"\n either = \"1.5.0\"\n gsgdt = \"0.1.2\"\n tracing = \"0.1\"\n-rustc-rayon = { version = \"0.3.2\", optional = true }\n-rustc-rayon-core = { version = \"0.3.2\", optional = true }\n+rustc-rayon = { version = \"0.4.0\", optional = true }\n+rustc-rayon-core = { version = \"0.4.0\", optional = true }\n polonius-engine = \"0.13.0\"\n rustc_apfloat = { path = \"../rustc_apfloat\" }\n rustc_attr = { path = \"../rustc_attr\" }"}, {"sha": "5673bb83b15f47bb7cf0e1d6e6ccb71e6b82ff0e", "filename": "compiler/rustc_query_impl/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/14f477e78adb9960f760e9bac812673f993d8dc2/compiler%2Frustc_query_impl%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/14f477e78adb9960f760e9bac812673f993d8dc2/compiler%2Frustc_query_impl%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_query_impl%2FCargo.toml?ref=14f477e78adb9960f760e9bac812673f993d8dc2", "patch": "@@ -8,7 +8,7 @@ doctest = false\n \n [dependencies]\n measureme = \"10.0.0\"\n-rustc-rayon-core = { version = \"0.3.2\", optional = true }\n+rustc-rayon-core = { version = \"0.4.0\", optional = true }\n rustc_ast = { path = \"../rustc_ast\" }\n rustc_data_structures = { path = \"../rustc_data_structures\" }\n rustc_errors = { path = \"../rustc_errors\" }"}, {"sha": "b5a37cf324b008fa10c4351cec36e95adecc34e5", "filename": "compiler/rustc_query_system/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/14f477e78adb9960f760e9bac812673f993d8dc2/compiler%2Frustc_query_system%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/14f477e78adb9960f760e9bac812673f993d8dc2/compiler%2Frustc_query_system%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_query_system%2FCargo.toml?ref=14f477e78adb9960f760e9bac812673f993d8dc2", "patch": "@@ -9,7 +9,7 @@ doctest = false\n [dependencies]\n rustc_arena = { path = \"../rustc_arena\" }\n tracing = \"0.1\"\n-rustc-rayon-core = { version = \"0.3.2\", optional = true }\n+rustc-rayon-core = { version = \"0.4.0\", optional = true }\n rustc_ast = { path = \"../rustc_ast\" }\n rustc_data_structures = { path = \"../rustc_data_structures\" }\n rustc_errors = { path = \"../rustc_errors\" }"}, {"sha": "7775bbb13e88a02aad8e5150fcdbd47ea0b944d2", "filename": "src/tools/tidy/src/deps.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/14f477e78adb9960f760e9bac812673f993d8dc2/src%2Ftools%2Ftidy%2Fsrc%2Fdeps.rs", "raw_url": "https://github.com/rust-lang/rust/raw/14f477e78adb9960f760e9bac812673f993d8dc2/src%2Ftools%2Ftidy%2Fsrc%2Fdeps.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Ftidy%2Fsrc%2Fdeps.rs?ref=14f477e78adb9960f760e9bac812673f993d8dc2", "patch": "@@ -100,6 +100,7 @@ const PERMITTED_DEPENDENCIES: &[&str] = &[\n     \"compiler_builtins\",\n     \"cpufeatures\",\n     \"crc32fast\",\n+    \"crossbeam-channel\",\n     \"crossbeam-deque\",\n     \"crossbeam-epoch\",\n     \"crossbeam-utils\","}]}