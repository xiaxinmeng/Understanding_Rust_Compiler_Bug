{"sha": "23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "node_id": "C_kwDOAAsO6NoAKDIzY2U1ZmM0NjU1ZWQ1NDZmNzRhODVmYzg4MzZlOTViZWMwYzY0ZmQ", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-01-08T21:41:48Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-01-08T21:41:48Z"}, "message": "Auto merge of #92068 - fee1-dead:libcore2021, r=m-ou-se\n\nSwitch all libraries to the 2021 edition\n\nThe fix for https://github.com/rust-lang/rust/issues/88638#issuecomment-996620107 is to simply add const-stability for these functions.\n\nr? `@m-ou-se`\n\nCloses #88638.", "tree": {"sha": "de1cb5360f9fe14a7f7cedb87998da56e9268981", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/de1cb5360f9fe14a7f7cedb87998da56e9268981"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "html_url": "https://github.com/rust-lang/rust/commit/23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a7e2e33960e95d2eb1a2a2aeec169dba5f73de05", "url": "https://api.github.com/repos/rust-lang/rust/commits/a7e2e33960e95d2eb1a2a2aeec169dba5f73de05", "html_url": "https://github.com/rust-lang/rust/commit/a7e2e33960e95d2eb1a2a2aeec169dba5f73de05"}, {"sha": "3ae0dabddbec41422549d2f0f4512c3d3415d0af", "url": "https://api.github.com/repos/rust-lang/rust/commits/3ae0dabddbec41422549d2f0f4512c3d3415d0af", "html_url": "https://github.com/rust-lang/rust/commit/3ae0dabddbec41422549d2f0f4512c3d3415d0af"}], "stats": {"total": 90, "additions": 22, "deletions": 68}, "files": [{"sha": "265020209eb12742c64b4c8c48a98856bc55ed7b", "filename": "library/alloc/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Falloc%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Falloc%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2FCargo.toml?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -6,7 +6,7 @@ repository = \"https://github.com/rust-lang/rust.git\"\n description = \"The Rust core allocation and collections library\"\n autotests = false\n autobenches = false\n-edition = \"2018\"\n+edition = \"2021\"\n \n [dependencies]\n core = { path = \"../core\" }"}, {"sha": "78f989e730d2474e41b9f7ab80135cdbfb026275", "filename": "library/alloc/src/vec/mod.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Falloc%2Fsrc%2Fvec%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Falloc%2Fsrc%2Fvec%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Fvec%2Fmod.rs?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -3004,22 +3004,19 @@ impl<T, A: Allocator, const N: usize> TryFrom<Vec<T, A>> for [T; N] {\n     /// # Examples\n     ///\n     /// ```\n-    /// use std::convert::TryInto;\n     /// assert_eq!(vec![1, 2, 3].try_into(), Ok([1, 2, 3]));\n     /// assert_eq!(<Vec<i32>>::new().try_into(), Ok([]));\n     /// ```\n     ///\n     /// If the length doesn't match, the input comes back in `Err`:\n     /// ```\n-    /// use std::convert::TryInto;\n     /// let r: Result<[i32; 4], _> = (0..10).collect::<Vec<_>>().try_into();\n     /// assert_eq!(r, Err(vec![0, 1, 2, 3, 4, 5, 6, 7, 8, 9]));\n     /// ```\n     ///\n     /// If you're fine with just getting a prefix of the `Vec<T>`,\n     /// you can call [`.truncate(N)`](Vec::truncate) first.\n     /// ```\n-    /// use std::convert::TryInto;\n     /// let mut v = String::from(\"hello world\").into_bytes();\n     /// v.sort();\n     /// v.truncate(2);"}, {"sha": "6bc4ba3cc0edf24dd75e18062d636c6debb1315b", "filename": "library/core/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fcore%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fcore%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2FCargo.toml?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -6,7 +6,7 @@ repository = \"https://github.com/rust-lang/rust.git\"\n description = \"The Rust Core Library\"\n autotests = false\n autobenches = false\n-edition = \"2018\"\n+edition = \"2021\"\n \n [lib]\n test = false"}, {"sha": "121aa634deb330988fb3c4ad224e11e619677d1b", "filename": "library/core/src/array/mod.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fcore%2Fsrc%2Farray%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fcore%2Fsrc%2Farray%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Farray%2Fmod.rs?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -66,8 +66,6 @@ where\n ///\n /// ```rust\n /// #![feature(array_from_fn)]\n-/// # // Apparently these doc tests are still on edition2018\n-/// # use std::convert::TryInto;\n ///\n /// let array: Result<[u8; 5], _> = std::array::try_from_fn(|i| i.try_into());\n /// assert_eq!(array, Ok([0, 1, 2, 3, 4]));"}, {"sha": "d40f69f8b35743d3bd5c662d86401b83a35fecef", "filename": "library/core/src/convert/mod.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fcore%2Fsrc%2Fconvert%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fcore%2Fsrc%2Fconvert%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fconvert%2Fmod.rs?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -426,8 +426,6 @@ pub trait TryInto<T>: Sized {\n /// `TryFrom<T>` can be implemented as follows:\n ///\n /// ```\n-/// use std::convert::TryFrom;\n-///\n /// struct GreaterThanZero(i32);\n ///\n /// impl TryFrom<i32> for GreaterThanZero {\n@@ -448,8 +446,6 @@ pub trait TryInto<T>: Sized {\n /// As described, [`i32`] implements `TryFrom<`[`i64`]`>`:\n ///\n /// ```\n-/// use std::convert::TryFrom;\n-///\n /// let big_number = 1_000_000_000_000i64;\n /// // Silently truncates `big_number`, requires detecting\n /// // and handling the truncation after the fact."}, {"sha": "26c97b8ed785dd992f2a316147060b9628b51c07", "filename": "library/core/src/iter/traits/collect.rs", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fcore%2Fsrc%2Fiter%2Ftraits%2Fcollect.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fcore%2Fsrc%2Fiter%2Ftraits%2Fcollect.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fiter%2Ftraits%2Fcollect.rs?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -15,8 +15,6 @@\n /// Basic usage:\n ///\n /// ```\n-/// use std::iter::FromIterator;\n-///\n /// let five_fives = std::iter::repeat(5).take(5);\n ///\n /// let v = Vec::from_iter(five_fives);\n@@ -37,8 +35,6 @@\n /// Implementing `FromIterator` for your type:\n ///\n /// ```\n-/// use std::iter::FromIterator;\n-///\n /// // A sample collection, that's just a wrapper over Vec<T>\n /// #[derive(Debug)]\n /// struct MyCollection(Vec<i32>);\n@@ -102,8 +98,6 @@ pub trait FromIterator<A>: Sized {\n     /// Basic usage:\n     ///\n     /// ```\n-    /// use std::iter::FromIterator;\n-    ///\n     /// let five_fives = std::iter::repeat(5).take(5);\n     ///\n     /// let v = Vec::from_iter(five_fives);"}, {"sha": "2049adafa2fed9a02ad6f950dddba51eeb81f89b", "filename": "library/core/src/iter/traits/iterator.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fcore%2Fsrc%2Fiter%2Ftraits%2Fiterator.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fcore%2Fsrc%2Fiter%2Ftraits%2Fiterator.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fiter%2Ftraits%2Fiterator.rs?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -1155,8 +1155,6 @@ pub trait Iterator {\n     /// Stopping after an initial [`None`]:\n     ///\n     /// ```\n-    /// use std::convert::TryFrom;\n-    ///\n     /// let a = [0, 1, 2, -3, 4, 5, -6];\n     ///\n     /// let iter = a.iter().map_while(|x| u32::try_from(*x).ok());\n@@ -1172,8 +1170,6 @@ pub trait Iterator {\n     /// removed:\n     ///\n     /// ```\n-    /// use std::convert::TryFrom;\n-    ///\n     /// let a = [1, 2, -3, 4];\n     /// let mut iter = a.iter();\n     ///"}, {"sha": "6f7c5a6d119945fe5acc75bf55d09b2a90b0e694", "filename": "library/core/src/num/int_macros.rs", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fcore%2Fsrc%2Fnum%2Fint_macros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fcore%2Fsrc%2Fnum%2Fint_macros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fnum%2Fint_macros.rs?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -2602,8 +2602,6 @@ macro_rules! int_impl {\n         /// When starting from a slice rather than an array, fallible conversion APIs can be used:\n         ///\n         /// ```\n-        /// use std::convert::TryInto;\n-        ///\n         #[doc = concat!(\"fn read_be_\", stringify!($SelfT), \"(input: &mut &[u8]) -> \", stringify!($SelfT), \" {\")]\n         #[doc = concat!(\"    let (int_bytes, rest) = input.split_at(std::mem::size_of::<\", stringify!($SelfT), \">());\")]\n         ///     *input = rest;\n@@ -2633,8 +2631,6 @@ macro_rules! int_impl {\n         /// When starting from a slice rather than an array, fallible conversion APIs can be used:\n         ///\n         /// ```\n-        /// use std::convert::TryInto;\n-        ///\n         #[doc = concat!(\"fn read_le_\", stringify!($SelfT), \"(input: &mut &[u8]) -> \", stringify!($SelfT), \" {\")]\n         #[doc = concat!(\"    let (int_bytes, rest) = input.split_at(std::mem::size_of::<\", stringify!($SelfT), \">());\")]\n         ///     *input = rest;\n@@ -2675,8 +2671,6 @@ macro_rules! int_impl {\n         /// When starting from a slice rather than an array, fallible conversion APIs can be used:\n         ///\n         /// ```\n-        /// use std::convert::TryInto;\n-        ///\n         #[doc = concat!(\"fn read_ne_\", stringify!($SelfT), \"(input: &mut &[u8]) -> \", stringify!($SelfT), \" {\")]\n         #[doc = concat!(\"    let (int_bytes, rest) = input.split_at(std::mem::size_of::<\", stringify!($SelfT), \">());\")]\n         ///     *input = rest;"}, {"sha": "1dd8b0a18ab1bd5e81a9f16b872161994d758914", "filename": "library/core/src/num/uint_macros.rs", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fcore%2Fsrc%2Fnum%2Fuint_macros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fcore%2Fsrc%2Fnum%2Fuint_macros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fnum%2Fuint_macros.rs?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -2323,8 +2323,6 @@ macro_rules! uint_impl {\n         /// When starting from a slice rather than an array, fallible conversion APIs can be used:\n         ///\n         /// ```\n-        /// use std::convert::TryInto;\n-        ///\n         #[doc = concat!(\"fn read_be_\", stringify!($SelfT), \"(input: &mut &[u8]) -> \", stringify!($SelfT), \" {\")]\n         #[doc = concat!(\"    let (int_bytes, rest) = input.split_at(std::mem::size_of::<\", stringify!($SelfT), \">());\")]\n         ///     *input = rest;\n@@ -2354,8 +2352,6 @@ macro_rules! uint_impl {\n         /// When starting from a slice rather than an array, fallible conversion APIs can be used:\n         ///\n         /// ```\n-        /// use std::convert::TryInto;\n-        ///\n         #[doc = concat!(\"fn read_le_\", stringify!($SelfT), \"(input: &mut &[u8]) -> \", stringify!($SelfT), \" {\")]\n         #[doc = concat!(\"    let (int_bytes, rest) = input.split_at(std::mem::size_of::<\", stringify!($SelfT), \">());\")]\n         ///     *input = rest;\n@@ -2396,8 +2392,6 @@ macro_rules! uint_impl {\n         /// When starting from a slice rather than an array, fallible conversion APIs can be used:\n         ///\n         /// ```\n-        /// use std::convert::TryInto;\n-        ///\n         #[doc = concat!(\"fn read_ne_\", stringify!($SelfT), \"(input: &mut &[u8]) -> \", stringify!($SelfT), \" {\")]\n         #[doc = concat!(\"    let (int_bytes, rest) = input.split_at(std::mem::size_of::<\", stringify!($SelfT), \">());\")]\n         ///     *input = rest;"}, {"sha": "ccb82cda54ef7499845877cbd8a0f6a2a665cc74", "filename": "library/core/src/panicking.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fcore%2Fsrc%2Fpanicking.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fcore%2Fsrc%2Fpanicking.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fpanicking.rs?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -51,6 +51,7 @@ pub const fn panic(expr: &'static str) -> ! {\n #[inline]\n #[track_caller]\n #[lang = \"panic_str\"] // needed for `non-fmt-panics` lint\n+#[rustc_const_unstable(feature = \"core_panic\", issue = \"none\")]\n pub const fn panic_str(expr: &str) -> ! {\n     panic_display(&expr);\n }\n@@ -59,6 +60,7 @@ pub const fn panic_str(expr: &str) -> ! {\n #[track_caller]\n #[lang = \"panic_display\"] // needed for const-evaluated panics\n #[rustc_do_not_const_check] // hooked by const-eval\n+#[rustc_const_unstable(feature = \"core_panic\", issue = \"none\")]\n pub const fn panic_display<T: fmt::Display>(x: &T) -> ! {\n     panic_fmt(format_args!(\"{}\", *x));\n }\n@@ -89,6 +91,7 @@ fn panic_bounds_check(index: usize, len: usize) -> ! {\n #[track_caller]\n #[lang = \"panic_fmt\"] // needed for const-evaluated panics\n #[rustc_do_not_const_check] // hooked by const-eval\n+#[rustc_const_unstable(feature = \"core_panic\", issue = \"none\")]\n pub const fn panic_fmt(fmt: fmt::Arguments<'_>) -> ! {\n     if cfg!(feature = \"panic_immediate_abort\") {\n         super::intrinsics::abort()\n@@ -109,6 +112,7 @@ pub const fn panic_fmt(fmt: fmt::Arguments<'_>) -> ! {\n \n /// This function is used instead of panic_fmt in const eval.\n #[lang = \"const_panic_fmt\"]\n+#[rustc_const_unstable(feature = \"core_panic\", issue = \"none\")]\n pub const fn const_panic_fmt(fmt: fmt::Arguments<'_>) -> ! {\n     if let Some(msg) = fmt.as_str() {\n         panic_str(msg);"}, {"sha": "46183d1ad00665fdf6da15728ec3cb3c13591b9f", "filename": "library/panic_abort/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fpanic_abort%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fpanic_abort%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fpanic_abort%2FCargo.toml?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -4,7 +4,7 @@ version = \"0.0.0\"\n license = \"MIT OR Apache-2.0\"\n repository = \"https://github.com/rust-lang/rust.git\"\n description = \"Implementation of Rust panics via process aborts\"\n-edition = \"2018\"\n+edition = \"2021\"\n \n [lib]\n test = false"}, {"sha": "d720cc7bcbdf1c3c0067b3232dc4fcd7c1d6e51a", "filename": "library/panic_unwind/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fpanic_unwind%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fpanic_unwind%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fpanic_unwind%2FCargo.toml?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -4,7 +4,7 @@ version = \"0.0.0\"\n license = \"MIT OR Apache-2.0\"\n repository = \"https://github.com/rust-lang/rust.git\"\n description = \"Implementation of Rust panics via stack unwinding\"\n-edition = \"2018\"\n+edition = \"2021\"\n \n [lib]\n test = false"}, {"sha": "db5e2e4e245ea59f84c5828116a313d543f29c4c", "filename": "library/proc_macro/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fproc_macro%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fproc_macro%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fproc_macro%2FCargo.toml?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -1,7 +1,7 @@\n [package]\n name = \"proc_macro\"\n version = \"0.0.0\"\n-edition = \"2018\"\n+edition = \"2021\"\n \n [dependencies]\n std = { path = \"../std\" }"}, {"sha": "3371dfa124253ee29c4971be8544a5030fc95ba4", "filename": "library/profiler_builtins/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fprofiler_builtins%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Fprofiler_builtins%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fprofiler_builtins%2FCargo.toml?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -1,7 +1,7 @@\n [package]\n name = \"profiler_builtins\"\n version = \"0.0.0\"\n-edition = \"2018\"\n+edition = \"2021\"\n \n [lib]\n test = false"}, {"sha": "049ca3e46b57d784c045f5e1ad7d19afa57c779b", "filename": "library/rustc-std-workspace-alloc/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Frustc-std-workspace-alloc%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Frustc-std-workspace-alloc%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Frustc-std-workspace-alloc%2FCargo.toml?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -5,7 +5,7 @@ license = 'MIT OR Apache-2.0'\n description = \"\"\"\n Hack for the compiler's own build system\n \"\"\"\n-edition = \"2018\"\n+edition = \"2021\"\n \n [lib]\n path = \"lib.rs\""}, {"sha": "ff5cfcbd641443fc1dd91cec70c6308c476eaaae", "filename": "library/rustc-std-workspace-core/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Frustc-std-workspace-core%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Frustc-std-workspace-core%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Frustc-std-workspace-core%2FCargo.toml?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -5,7 +5,7 @@ license = 'MIT OR Apache-2.0'\n description = \"\"\"\n Hack for the compiler's own build system\n \"\"\"\n-edition = \"2018\"\n+edition = \"2021\"\n \n [lib]\n path = \"lib.rs\""}, {"sha": "3a1dc2a02b557abf7b16cf2400084542432e4c0a", "filename": "library/rustc-std-workspace-std/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Frustc-std-workspace-std%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Frustc-std-workspace-std%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Frustc-std-workspace-std%2FCargo.toml?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -5,7 +5,7 @@ license = 'MIT OR Apache-2.0'\n description = \"\"\"\n Hack for the compiler's own build system\n \"\"\"\n-edition = \"2018\"\n+edition = \"2021\"\n \n [lib]\n path = \"lib.rs\""}, {"sha": "2da41484ca564afc15543d16a356502d3a3b49b2", "filename": "library/test/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Ftest%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Ftest%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Ftest%2FCargo.toml?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -1,7 +1,7 @@\n [package]\n name = \"test\"\n version = \"0.0.0\"\n-edition = \"2018\"\n+edition = \"2021\"\n \n [lib]\n crate-type = [\"dylib\", \"rlib\"]"}, {"sha": "69fce8d7795c17e442a6a65e2405f5b95ad14ba4", "filename": "library/unwind/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Funwind%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/library%2Funwind%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Funwind%2FCargo.toml?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -3,7 +3,7 @@ name = \"unwind\"\n version = \"0.0.0\"\n license = \"MIT OR Apache-2.0\"\n repository = \"https://github.com/rust-lang/rust.git\"\n-edition = \"2018\"\n+edition = \"2021\"\n include = [\n   '/libunwind/*',\n ]"}, {"sha": "b0abee459869cc5d5b4981c2fe44f660f72a231f", "filename": "src/tools/tidy/src/edition.rs", "status": "modified", "additions": 7, "deletions": 26, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/src%2Ftools%2Ftidy%2Fsrc%2Fedition.rs", "raw_url": "https://github.com/rust-lang/rust/raw/23ce5fc4655ed546f74a85fc8836e95bec0c64fd/src%2Ftools%2Ftidy%2Fsrc%2Fedition.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Ftidy%2Fsrc%2Fedition.rs?ref=23ce5fc4655ed546f74a85fc8836e95bec0c64fd", "patch": "@@ -2,11 +2,6 @@\n \n use std::path::Path;\n \n-fn is_edition_2018(mut line: &str) -> bool {\n-    line = line.trim();\n-    line == \"edition = \\\"2018\\\"\"\n-}\n-\n fn is_edition_2021(mut line: &str) -> bool {\n     line = line.trim();\n     line == \"edition = \\\"2021\\\"\"\n@@ -23,27 +18,13 @@ pub fn check(path: &Path, bad: &mut bool) {\n                 return;\n             }\n \n-            // Not all library crates are ready to migrate to 2021.\n-            if file.components().any(|c| c.as_os_str() == \"library\")\n-                && file.components().all(|c| c.as_os_str() != \"std\")\n-            {\n-                let has = contents.lines().any(is_edition_2018);\n-                if !has {\n-                    tidy_error!(\n-                        bad,\n-                        \"{} doesn't have `edition = \\\"2018\\\"` on a separate line\",\n-                        file.display()\n-                    );\n-                }\n-            } else {\n-                let is_2021 = contents.lines().any(is_edition_2021);\n-                if !is_2021 {\n-                    tidy_error!(\n-                        bad,\n-                        \"{} doesn't have `edition = \\\"2021\\\"` on a separate line\",\n-                        file.display()\n-                    );\n-                }\n+            let is_2021 = contents.lines().any(is_edition_2021);\n+            if !is_2021 {\n+                tidy_error!(\n+                    bad,\n+                    \"{} doesn't have `edition = \\\"2021\\\"` on a separate line\",\n+                    file.display()\n+                );\n             }\n         },\n     );"}]}