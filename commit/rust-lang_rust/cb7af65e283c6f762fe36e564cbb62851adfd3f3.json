{"sha": "cb7af65e283c6f762fe36e564cbb62851adfd3f3", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNiN2FmNjVlMjgzYzZmNzYyZmUzNmU1NjRjYmI2Mjg1MWFkZmQzZjM=", "commit": {"author": {"name": "Oliver Schneider", "email": "oli-obk@users.noreply.github.com", "date": "2018-03-17T22:20:51Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-03-17T22:20:51Z"}, "message": "Merge pull request #2545 from flip1995/sus_arith\n\nDon't lint comparison operators in arithmetic impls", "tree": {"sha": "ca9f64673a016d35d739b7a1f91215d61084c319", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ca9f64673a016d35d739b7a1f91215d61084c319"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cb7af65e283c6f762fe36e564cbb62851adfd3f3", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJarZTDCRBK7hj4Ov3rIwAAdHIIAEBCeWH/osJtCPYIF+3C5Lcp\nE9diGmlE9VjbZM/wJA5y/DRDVCEL3Sa6JRayXoDXL19dRiU6Yd/c1Tq8tDmM7nTW\nm8ZXsqgwgQ4KzxGVgYtQ1FqUenN3dLmYK1TKfxIU47a2Ri80t34Lmey6uGC9OCl8\nr3dtxoXemhLUgaeRh3chgC2Fzm5Wz9ZgcwnTosijLNiX7jDXUBC2hJbaX231lcvB\n+qXSQo0zge1QSBGcGwL+sZgC8vBD7SingHRXC84wzkVfcwsOCGEL5muXKObU4dvt\nM3796CJsKG1SrWKmbo7RihXUFF+uL97JdfDTkJOSAkXyRaDRSHuZeqea7W3qdnU=\n=0irh\n-----END PGP SIGNATURE-----\n", "payload": "tree ca9f64673a016d35d739b7a1f91215d61084c319\nparent 03f4ae062d8ec16cec2a4bd086e66c61fc975f97\nparent ad459184a311e4764072bec33f5cef95b63b838c\nauthor Oliver Schneider <oli-obk@users.noreply.github.com> 1521325251 +0100\ncommitter GitHub <noreply@github.com> 1521325251 +0100\n\nMerge pull request #2545 from flip1995/sus_arith\n\nDon't lint comparison operators in arithmetic impls"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cb7af65e283c6f762fe36e564cbb62851adfd3f3", "html_url": "https://github.com/rust-lang/rust/commit/cb7af65e283c6f762fe36e564cbb62851adfd3f3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cb7af65e283c6f762fe36e564cbb62851adfd3f3/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "03f4ae062d8ec16cec2a4bd086e66c61fc975f97", "url": "https://api.github.com/repos/rust-lang/rust/commits/03f4ae062d8ec16cec2a4bd086e66c61fc975f97", "html_url": "https://github.com/rust-lang/rust/commit/03f4ae062d8ec16cec2a4bd086e66c61fc975f97"}, {"sha": "ad459184a311e4764072bec33f5cef95b63b838c", "url": "https://api.github.com/repos/rust-lang/rust/commits/ad459184a311e4764072bec33f5cef95b63b838c", "html_url": "https://github.com/rust-lang/rust/commit/ad459184a311e4764072bec33f5cef95b63b838c"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "2c3abc512bbf4c6aa1ffced712aee0e92bb20fdb", "filename": "clippy_lints/src/suspicious_trait_impl.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cb7af65e283c6f762fe36e564cbb62851adfd3f3/clippy_lints%2Fsrc%2Fsuspicious_trait_impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cb7af65e283c6f762fe36e564cbb62851adfd3f3/clippy_lints%2Fsrc%2Fsuspicious_trait_impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fsuspicious_trait_impl.rs?ref=cb7af65e283c6f762fe36e564cbb62851adfd3f3", "patch": "@@ -61,6 +61,10 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for SuspiciousImpl {\n     fn check_expr(&mut self, cx: &LateContext<'a, 'tcx>, expr: &'tcx hir::Expr) {\n         use rustc::hir::BinOp_::*;\n         if let hir::ExprBinary(binop, _, _) = expr.node {\n+            match binop.node {\n+                BiEq | BiLt | BiLe | BiNe | BiGe | BiGt => return,\n+                _ => {},\n+            }\n             // Check if the binary expression is part of another bi/unary expression\n             // as a child node\n             let mut parent_expr = cx.tcx.hir.get_parent_node(expr.id);"}, {"sha": "d5982efe12fbc8c7c722771d6c945940a0d85c9a", "filename": "tests/ui/suspicious_arithmetic_impl.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/cb7af65e283c6f762fe36e564cbb62851adfd3f3/tests%2Fui%2Fsuspicious_arithmetic_impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cb7af65e283c6f762fe36e564cbb62851adfd3f3/tests%2Fui%2Fsuspicious_arithmetic_impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsuspicious_arithmetic_impl.rs?ref=cb7af65e283c6f762fe36e564cbb62851adfd3f3", "patch": "@@ -59,7 +59,11 @@ impl Sub for Bar {\n     type Output = Bar;\n \n     fn sub(self, other: Self) -> Self {\n-        Bar(-(self.0 & other.0)) // OK: UnNeg part of BiExpr as parent node\n+        if self.0 <= other.0 {\n+            Bar(-(self.0 & other.0)) // OK: UnNeg part of BiExpr as parent node\n+        } else {\n+            Bar(0)\n+        }\n     }\n }\n "}]}