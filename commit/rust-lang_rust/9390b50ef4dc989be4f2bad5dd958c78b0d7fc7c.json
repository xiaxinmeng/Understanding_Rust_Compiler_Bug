{"sha": "9390b50ef4dc989be4f2bad5dd958c78b0d7fc7c", "node_id": "C_kwDOAAsO6NoAKDkzOTBiNTBlZjRkYzk4OWJlNGYyYmFkNWRkOTU4Yzc4YjBkN2ZjN2M", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-11-24T21:56:37Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-11-24T21:56:37Z"}, "message": "Rollup merge of #91075 - jsha:chill-item-info, r=GuillaumeGomez\n\nReduce prominence of item-infos\n\nFixes #59853\n\n - Remove border.\n - Reduce size of emoji slightly.\n - Remove details disclosure for unstable reason. This was inconsistent with our other details disclosures, and the detail revealed was usually better explained by clicking on the issue link.\n\nDemo: https://rustdoc.crud.net/jsha/chill-item-info/std/mem/union.MaybeUninit.html#method.slice_assume_init_ref\n\nCompare vs: https://doc.rust-lang.org/nightly/std/mem/union.MaybeUninit.html#method.slice_assume_init_ref\n\n<img src=\"https://user-images.githubusercontent.com/220205/142717815-09828c9e-6ff4-445a-8ccc-31e028fd4985.png\" width=700>", "tree": {"sha": "cb788ed4c42ff9264280f666e51b2455f5feed19", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cb788ed4c42ff9264280f666e51b2455f5feed19"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9390b50ef4dc989be4f2bad5dd958c78b0d7fc7c", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhnrUWCRBK7hj4Ov3rIwAAdD0IACSe9NFRLfS3AiBW+UCTf2BR\nyMgJ5m5Fpz4I6zQbY+C/v3QSgoNL33RPZEbK+Xsdl/W3hMVftaZoWmaGcCYPvZ1Y\nMpyd8G9lyx3GGDgOyE6/1UynR5vr6hJnZ/nL+KLSJ9x5KBWN1nbrY9L9ioMy8rbo\nZCNZ8V/HpaUjQUDzrzX4q7GYGoxamLymxA+G99Zfleq7aWr3/laomPXWRIz4VgM5\njqb+LClkqtpR9qPwLRuMNOW7bkWh+PiueNG0z6e2szw86sR1kcjV7NUqFYjgejrH\nY4VXsoCqrDeva0ScuNNSSdivPRN8sRQhJdBbsg3p+rGDwERhi4u5g376mMg7wr8=\n=ohB+\n-----END PGP SIGNATURE-----\n", "payload": "tree cb788ed4c42ff9264280f666e51b2455f5feed19\nparent a6a1d7ca2936ddb33dbaad69ae3a8a47b9208498\nparent e6ab982d462994dc21a81561ae03bac476431b96\nauthor Guillaume Gomez <guillaume1.gomez@gmail.com> 1637790997 +0100\ncommitter GitHub <noreply@github.com> 1637790997 +0100\n\nRollup merge of #91075 - jsha:chill-item-info, r=GuillaumeGomez\n\nReduce prominence of item-infos\n\nFixes #59853\n\n - Remove border.\n - Reduce size of emoji slightly.\n - Remove details disclosure for unstable reason. This was inconsistent with our other details disclosures, and the detail revealed was usually better explained by clicking on the issue link.\n\nDemo: https://rustdoc.crud.net/jsha/chill-item-info/std/mem/union.MaybeUninit.html#method.slice_assume_init_ref\n\nCompare vs: https://doc.rust-lang.org/nightly/std/mem/union.MaybeUninit.html#method.slice_assume_init_ref\n\n<img src=\"https://user-images.githubusercontent.com/220205/142717815-09828c9e-6ff4-445a-8ccc-31e028fd4985.png\" width=700>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9390b50ef4dc989be4f2bad5dd958c78b0d7fc7c", "html_url": "https://github.com/rust-lang/rust/commit/9390b50ef4dc989be4f2bad5dd958c78b0d7fc7c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9390b50ef4dc989be4f2bad5dd958c78b0d7fc7c/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a6a1d7ca2936ddb33dbaad69ae3a8a47b9208498", "url": "https://api.github.com/repos/rust-lang/rust/commits/a6a1d7ca2936ddb33dbaad69ae3a8a47b9208498", "html_url": "https://github.com/rust-lang/rust/commit/a6a1d7ca2936ddb33dbaad69ae3a8a47b9208498"}, {"sha": "e6ab982d462994dc21a81561ae03bac476431b96", "url": "https://api.github.com/repos/rust-lang/rust/commits/e6ab982d462994dc21a81561ae03bac476431b96", "html_url": "https://github.com/rust-lang/rust/commit/e6ab982d462994dc21a81561ae03bac476431b96"}], "stats": {"total": 33, "additions": 4, "deletions": 29}, "files": [{"sha": "24baca285c6ff2fce8e5d3b7a630882f5f83a0ab", "filename": "src/librustdoc/html/render/mod.rs", "status": "modified", "additions": 1, "deletions": 17, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/9390b50ef4dc989be4f2bad5dd958c78b0d7fc7c/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9390b50ef4dc989be4f2bad5dd958c78b0d7fc7c/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs?ref=9390b50ef4dc989be4f2bad5dd958c78b0d7fc7c", "patch": "@@ -682,7 +682,7 @@ fn short_item_info(\n \n     // Render unstable items. But don't render \"rustc_private\" crates (internal compiler crates).\n     // Those crates are permanently unstable so it makes no sense to render \"unstable\" everywhere.\n-    if let Some((StabilityLevel::Unstable { reason, issue, .. }, feature)) = item\n+    if let Some((StabilityLevel::Unstable { reason: _, issue, .. }, feature)) = item\n         .stability(cx.tcx())\n         .as_ref()\n         .filter(|stab| stab.feature != sym::rustc_private)\n@@ -702,22 +702,6 @@ fn short_item_info(\n \n         message.push_str(&format!(\" ({})\", feature));\n \n-        if let Some(unstable_reason) = reason {\n-            let mut ids = cx.id_map.borrow_mut();\n-            message = format!(\n-                \"<details><summary>{}</summary>{}</details>\",\n-                message,\n-                MarkdownHtml(\n-                    &unstable_reason.as_str(),\n-                    &mut ids,\n-                    error_codes,\n-                    cx.shared.edition(),\n-                    &cx.shared.playground,\n-                )\n-                .into_string()\n-            );\n-        }\n-\n         extra_info.push(format!(\"<div class=\\\"stab unstable\\\">{}</div>\", message));\n     }\n "}, {"sha": "0f3eb2ca07d23522c8da5126bec8661602ec74af", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/9390b50ef4dc989be4f2bad5dd958c78b0d7fc7c/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/9390b50ef4dc989be4f2bad5dd958c78b0d7fc7c/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=9390b50ef4dc989be4f2bad5dd958c78b0d7fc7c", "patch": "@@ -964,8 +964,6 @@ body.blur > :not(#help) {\n \tdisplay: table;\n }\n .stab {\n-\tborder-width: 1px;\n-\tborder-style: solid;\n \tpadding: 3px;\n \tmargin-bottom: 5px;\n \tfont-size: 90%;\n@@ -976,7 +974,7 @@ body.blur > :not(#help) {\n }\n \n .stab .emoji {\n-\tfont-size: 1.5em;\n+\tfont-size: 1.2em;\n }\n \n /* Black one-pixel outline around emoji shapes */"}, {"sha": "cdc00d341140332246dc0e3355472dc3bb45a651", "filename": "src/test/rustdoc-gui/item-info-width.goml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/9390b50ef4dc989be4f2bad5dd958c78b0d7fc7c/src%2Ftest%2Frustdoc-gui%2Fitem-info-width.goml", "raw_url": "https://github.com/rust-lang/rust/raw/9390b50ef4dc989be4f2bad5dd958c78b0d7fc7c/src%2Ftest%2Frustdoc-gui%2Fitem-info-width.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fitem-info-width.goml?ref=9390b50ef4dc989be4f2bad5dd958c78b0d7fc7c", "patch": "@@ -4,4 +4,4 @@ goto: file://|DOC_PATH|/lib2/struct.Foo.html\n size: (1100, 800)\n // We check that \".item-info\" is bigger than its content.\n assert-css: (\".item-info\", {\"width\": \"807px\"})\n-assert-css: (\".item-info .stab\", {\"width\": \"343px\"})\n+assert-css: (\".item-info .stab\", {\"width\": \"341px\"})"}, {"sha": "7654a5615275ac17e4d074ed04e42df5c2e88d48", "filename": "src/test/rustdoc/issue-32374.rs", "status": "modified", "additions": 1, "deletions": 8, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/9390b50ef4dc989be4f2bad5dd958c78b0d7fc7c/src%2Ftest%2Frustdoc%2Fissue-32374.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9390b50ef4dc989be4f2bad5dd958c78b0d7fc7c/src%2Ftest%2Frustdoc%2Fissue-32374.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fissue-32374.rs?ref=9390b50ef4dc989be4f2bad5dd958c78b0d7fc7c", "patch": "@@ -1,7 +1,6 @@\n #![feature(staged_api)]\n #![doc(issue_tracker_base_url = \"https://issue_url/\")]\n-\n-#![unstable(feature=\"test\", issue = \"32374\")]\n+#![unstable(feature = \"test\", issue = \"32374\")]\n \n // @matches issue_32374/index.html '//*[@class=\"item-left unstable deprecated module-item\"]/span[@class=\"stab deprecated\"]' \\\n //      'Deprecated'\n@@ -23,12 +22,6 @@ pub struct T;\n //      '\ud83d\udc4e Deprecated since 1.0.0: deprecated'\n // @has issue_32374/struct.U.html '//*[@class=\"stab unstable\"]' \\\n //      '\ud83d\udd2c This is a nightly-only experimental API. (test #32374)'\n-// @has issue_32374/struct.U.html '//details' \\\n-//      '\ud83d\udd2c This is a nightly-only experimental API. (test #32374)'\n-// @has issue_32374/struct.U.html '//summary' \\\n-//      '\ud83d\udd2c This is a nightly-only experimental API. (test #32374)'\n-// @has issue_32374/struct.U.html '//details/p' \\\n-//      'unstable'\n #[rustc_deprecated(since = \"1.0.0\", reason = \"deprecated\")]\n #[unstable(feature = \"test\", issue = \"32374\", reason = \"unstable\")]\n pub struct U;"}]}