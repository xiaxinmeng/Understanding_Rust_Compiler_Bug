{"sha": "3183afb6b5fcbf688bb90cf1db3f635406f868dc", "node_id": "C_kwDOAAsO6NoAKDMxODNhZmI2YjVmY2JmNjg4YmI5MGNmMWRiM2Y2MzU0MDZmODY4ZGM", "commit": {"author": {"name": "Caleb Zulawski", "email": "caleb.zulawski@gmail.com", "date": "2022-07-29T15:57:05Z"}, "committer": {"name": "Caleb Zulawski", "email": "caleb.zulawski@gmail.com", "date": "2022-07-29T15:57:05Z"}, "message": "Fix interleave/deinterleave for vectors with only one lane", "tree": {"sha": "bf88475cae84c564a3c7bf7456c3a37ce420574d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bf88475cae84c564a3c7bf7456c3a37ce420574d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3183afb6b5fcbf688bb90cf1db3f635406f868dc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3183afb6b5fcbf688bb90cf1db3f635406f868dc", "html_url": "https://github.com/rust-lang/rust/commit/3183afb6b5fcbf688bb90cf1db3f635406f868dc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3183afb6b5fcbf688bb90cf1db3f635406f868dc/comments", "author": {"login": "calebzulawski", "id": 563826, "node_id": "MDQ6VXNlcjU2MzgyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/563826?v=4", "gravatar_id": "", "url": "https://api.github.com/users/calebzulawski", "html_url": "https://github.com/calebzulawski", "followers_url": "https://api.github.com/users/calebzulawski/followers", "following_url": "https://api.github.com/users/calebzulawski/following{/other_user}", "gists_url": "https://api.github.com/users/calebzulawski/gists{/gist_id}", "starred_url": "https://api.github.com/users/calebzulawski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/calebzulawski/subscriptions", "organizations_url": "https://api.github.com/users/calebzulawski/orgs", "repos_url": "https://api.github.com/users/calebzulawski/repos", "events_url": "https://api.github.com/users/calebzulawski/events{/privacy}", "received_events_url": "https://api.github.com/users/calebzulawski/received_events", "type": "User", "site_admin": false}, "committer": {"login": "calebzulawski", "id": 563826, "node_id": "MDQ6VXNlcjU2MzgyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/563826?v=4", "gravatar_id": "", "url": "https://api.github.com/users/calebzulawski", "html_url": "https://github.com/calebzulawski", "followers_url": "https://api.github.com/users/calebzulawski/followers", "following_url": "https://api.github.com/users/calebzulawski/following{/other_user}", "gists_url": "https://api.github.com/users/calebzulawski/gists{/gist_id}", "starred_url": "https://api.github.com/users/calebzulawski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/calebzulawski/subscriptions", "organizations_url": "https://api.github.com/users/calebzulawski/orgs", "repos_url": "https://api.github.com/users/calebzulawski/repos", "events_url": "https://api.github.com/users/calebzulawski/events{/privacy}", "received_events_url": "https://api.github.com/users/calebzulawski/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b5f9d43ff1139fb5dbd1a919dbf63e48c2c56012", "url": "https://api.github.com/repos/rust-lang/rust/commits/b5f9d43ff1139fb5dbd1a919dbf63e48c2c56012", "html_url": "https://github.com/rust-lang/rust/commit/b5f9d43ff1139fb5dbd1a919dbf63e48c2c56012"}], "stats": {"total": 26, "additions": 24, "deletions": 2}, "files": [{"sha": "02567252a63755b32817377dba072134065640d3", "filename": "crates/core_simd/src/swizzle.rs", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/3183afb6b5fcbf688bb90cf1db3f635406f868dc/crates%2Fcore_simd%2Fsrc%2Fswizzle.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3183afb6b5fcbf688bb90cf1db3f635406f868dc/crates%2Fcore_simd%2Fsrc%2Fswizzle.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcore_simd%2Fsrc%2Fswizzle.rs?ref=3183afb6b5fcbf688bb90cf1db3f635406f868dc", "patch": "@@ -325,7 +325,11 @@ where\n             const INDEX: [Which; LANES] = hi::<LANES>();\n         }\n \n-        (Lo::swizzle2(self, other), Hi::swizzle2(self, other))\n+        if LANES == 1 {\n+            (self, other)\n+        } else {\n+            (Lo::swizzle2(self, other), Hi::swizzle2(self, other))\n+        }\n     }\n \n     /// Deinterleave two vectors.\n@@ -380,6 +384,10 @@ where\n             const INDEX: [Which; LANES] = odd::<LANES>();\n         }\n \n-        (Even::swizzle2(self, other), Odd::swizzle2(self, other))\n+        if LANES == 1 {\n+            (self, other)\n+        } else {\n+            (Even::swizzle2(self, other), Odd::swizzle2(self, other))\n+        }\n     }\n }"}, {"sha": "33a7becb4212886dfdb6dfd13bab31090c45fe2b", "filename": "crates/core_simd/tests/swizzle.rs", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/3183afb6b5fcbf688bb90cf1db3f635406f868dc/crates%2Fcore_simd%2Ftests%2Fswizzle.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3183afb6b5fcbf688bb90cf1db3f635406f868dc/crates%2Fcore_simd%2Ftests%2Fswizzle.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcore_simd%2Ftests%2Fswizzle.rs?ref=3183afb6b5fcbf688bb90cf1db3f635406f868dc", "patch": "@@ -60,3 +60,17 @@ fn interleave() {\n     assert_eq!(even, a);\n     assert_eq!(odd, b);\n }\n+\n+// portable-simd#298\n+#[test]\n+#[cfg_attr(target_arch = \"wasm32\", wasm_bindgen_test)]\n+fn interleave_one() {\n+    let a = Simd::from_array([0]);\n+    let b = Simd::from_array([1]);\n+    let (lo, hi) = a.interleave(b);\n+    assert_eq!(lo.to_array(), [0]);\n+    assert_eq!(hi.to_array(), [1]);\n+    let (even, odd) = lo.deinterleave(hi);\n+    assert_eq!(even, a);\n+    assert_eq!(odd, b);\n+}"}]}