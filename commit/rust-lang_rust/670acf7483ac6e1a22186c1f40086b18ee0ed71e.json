{"sha": "670acf7483ac6e1a22186c1f40086b18ee0ed71e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjY3MGFjZjc0ODNhYzZlMWEyMjE4NmMxZjQwMDg2YjE4ZWUwZWQ3MWU=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-01-19T09:27:50Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-01-19T09:27:50Z"}, "message": "Rollup merge of #80382 - GuillaumeGomez:search-result-tab-picking, r=Nemo157,pickfire\n\nImprove search result tab handling\n\nFixes #80378.\n\nIf the current search result tab is empty, it picks the first non-empty one. If all are empty, the current one doesn't change. It can be tested with \"-> string\" (where only the \"returned elements\" tab is not empty).\n\nr? `@jyn514`", "tree": {"sha": "022fa6e898a2f87f8b3a6aba12a096ab5b97acaa", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/022fa6e898a2f87f8b3a6aba12a096ab5b97acaa"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/670acf7483ac6e1a22186c1f40086b18ee0ed71e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgBqYXCRBK7hj4Ov3rIwAAdHIIAHweA5+9G6WkAaBzOkneVj1X\nqozrk9nhpBdVVwK3hf9jkGtBA6WRAgj4zNyE8gIAmB4DLkyM0vPdo1X7CWdG05hI\n+39qFMmpn5C6pzmG+hVgQwa6JFdQmzRMVpXd3ag0L9vX1DyeHittFpeSVBfPZbYu\nM34P2oX856+8F3EFIKBnPtCRLBqDj/hBaPCNIWe8+BKQBQgzEnya6lP2O0535ioo\nEP9xL7A5XVYykZqGkQS4RZSvbl+sgFsowhHJBg5LxNycLK7c0/nyzgRqH9xeaPK8\nAssKdQIhi1UersIBdeZlOvQMKhUcGICeW/QjDih2dUlwB4FXOzMTNFD3nD+nkcc=\n=cBWR\n-----END PGP SIGNATURE-----\n", "payload": "tree 022fa6e898a2f87f8b3a6aba12a096ab5b97acaa\nparent 7d7b22d78fa71cf18109dc9d186611f2ddf60d8e\nparent 33377670773e07cc75a0a28424413ba74fc2bfb8\nauthor Guillaume Gomez <guillaume1.gomez@gmail.com> 1611048470 +0100\ncommitter GitHub <noreply@github.com> 1611048470 +0100\n\nRollup merge of #80382 - GuillaumeGomez:search-result-tab-picking, r=Nemo157,pickfire\n\nImprove search result tab handling\n\nFixes #80378.\n\nIf the current search result tab is empty, it picks the first non-empty one. If all are empty, the current one doesn't change. It can be tested with \"-> string\" (where only the \"returned elements\" tab is not empty).\n\nr? `@jyn514`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/670acf7483ac6e1a22186c1f40086b18ee0ed71e", "html_url": "https://github.com/rust-lang/rust/commit/670acf7483ac6e1a22186c1f40086b18ee0ed71e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/670acf7483ac6e1a22186c1f40086b18ee0ed71e/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7d7b22d78fa71cf18109dc9d186611f2ddf60d8e", "url": "https://api.github.com/repos/rust-lang/rust/commits/7d7b22d78fa71cf18109dc9d186611f2ddf60d8e", "html_url": "https://github.com/rust-lang/rust/commit/7d7b22d78fa71cf18109dc9d186611f2ddf60d8e"}, {"sha": "33377670773e07cc75a0a28424413ba74fc2bfb8", "url": "https://api.github.com/repos/rust-lang/rust/commits/33377670773e07cc75a0a28424413ba74fc2bfb8", "html_url": "https://github.com/rust-lang/rust/commit/33377670773e07cc75a0a28424413ba74fc2bfb8"}], "stats": {"total": 15, "additions": 15, "deletions": 0}, "files": [{"sha": "035de64c7ccdc8d532a334bbba131455e14b7288", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/670acf7483ac6e1a22186c1f40086b18ee0ed71e/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/670acf7483ac6e1a22186c1f40086b18ee0ed71e/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=670acf7483ac6e1a22186c1f40086b18ee0ed71e", "patch": "@@ -1650,6 +1650,21 @@ function defocusSearchBar() {\n             var ret_in_args = addTab(results.in_args, query, false);\n             var ret_returned = addTab(results.returned, query, false);\n \n+            // Navigate to the relevant tab if the current tab is empty, like in case users search\n+            // for \"-> String\". If they had selected another tab previously, they have to click on\n+            // it again.\n+            if ((currentTab === 0 && ret_others[1] === 0) ||\n+                    (currentTab === 1 && ret_in_args[1] === 0) ||\n+                    (currentTab === 2 && ret_returned[1] === 0)) {\n+                if (ret_others[1] !== 0) {\n+                    currentTab = 0;\n+                } else if (ret_in_args[1] !== 0) {\n+                    currentTab = 1;\n+                } else if (ret_returned[1] !== 0) {\n+                    currentTab = 2;\n+                }\n+            }\n+\n             var output = \"<h1>Results for \" + escape(query.query) +\n                 (query.type ? \" (type: \" + escape(query.type) + \")\" : \"\") + \"</h1>\" +\n                 \"<div id=\\\"titles\\\">\" +"}]}