{"sha": "72718bc2d7113874536b8bcd486aa5bd7dacafe6", "node_id": "MDY6Q29tbWl0NzI0NzEyOjcyNzE4YmMyZDcxMTM4NzQ1MzZiOGJjZDQ4NmFhNWJkN2RhY2FmZTY=", "commit": {"author": {"name": "James Leitch", "email": "rickvanprim@gmail.com", "date": "2021-04-21T22:09:37Z"}, "committer": {"name": "James Leitch", "email": "rickvanprim@gmail.com", "date": "2021-04-21T22:10:53Z"}, "message": "Code review feedback.", "tree": {"sha": "c5859e4eb7334478b5e9ba58329b67df43e39305", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c5859e4eb7334478b5e9ba58329b67df43e39305"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/72718bc2d7113874536b8bcd486aa5bd7dacafe6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/72718bc2d7113874536b8bcd486aa5bd7dacafe6", "html_url": "https://github.com/rust-lang/rust/commit/72718bc2d7113874536b8bcd486aa5bd7dacafe6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/72718bc2d7113874536b8bcd486aa5bd7dacafe6/comments", "author": {"login": "rickvanprim", "id": 13792812, "node_id": "MDQ6VXNlcjEzNzkyODEy", "avatar_url": "https://avatars.githubusercontent.com/u/13792812?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rickvanprim", "html_url": "https://github.com/rickvanprim", "followers_url": "https://api.github.com/users/rickvanprim/followers", "following_url": "https://api.github.com/users/rickvanprim/following{/other_user}", "gists_url": "https://api.github.com/users/rickvanprim/gists{/gist_id}", "starred_url": "https://api.github.com/users/rickvanprim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rickvanprim/subscriptions", "organizations_url": "https://api.github.com/users/rickvanprim/orgs", "repos_url": "https://api.github.com/users/rickvanprim/repos", "events_url": "https://api.github.com/users/rickvanprim/events{/privacy}", "received_events_url": "https://api.github.com/users/rickvanprim/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rickvanprim", "id": 13792812, "node_id": "MDQ6VXNlcjEzNzkyODEy", "avatar_url": "https://avatars.githubusercontent.com/u/13792812?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rickvanprim", "html_url": "https://github.com/rickvanprim", "followers_url": "https://api.github.com/users/rickvanprim/followers", "following_url": "https://api.github.com/users/rickvanprim/following{/other_user}", "gists_url": "https://api.github.com/users/rickvanprim/gists{/gist_id}", "starred_url": "https://api.github.com/users/rickvanprim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rickvanprim/subscriptions", "organizations_url": "https://api.github.com/users/rickvanprim/orgs", "repos_url": "https://api.github.com/users/rickvanprim/repos", "events_url": "https://api.github.com/users/rickvanprim/events{/privacy}", "received_events_url": "https://api.github.com/users/rickvanprim/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9fcad829807a0306fbf4eb2ebc1603a11a6df182", "url": "https://api.github.com/repos/rust-lang/rust/commits/9fcad829807a0306fbf4eb2ebc1603a11a6df182", "html_url": "https://github.com/rust-lang/rust/commit/9fcad829807a0306fbf4eb2ebc1603a11a6df182"}], "stats": {"total": 26, "additions": 14, "deletions": 12}, "files": [{"sha": "1109d2dafd9ea55eb3da3983e553aacee6195c5b", "filename": "crates/rust-analyzer/src/config.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/72718bc2d7113874536b8bcd486aa5bd7dacafe6/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/72718bc2d7113874536b8bcd486aa5bd7dacafe6/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fconfig.rs?ref=72718bc2d7113874536b8bcd486aa5bd7dacafe6", "patch": "@@ -99,9 +99,9 @@ config_data! {\n         diagnostics_enableExperimental: bool    = \"true\",\n         /// List of rust-analyzer diagnostics to disable.\n         diagnostics_disabled: FxHashSet<String> = \"[]\",\n-        /// Map of path prefixes to be substituted when parsing diagnostic file paths.\n+        /// Map of prefixes to be substituted when parsing diagnostic file paths.\n         /// This should be the reverse mapping of what is passed to `rustc` as `--remap-path-prefix`.\n-        diagnostics_remapPathPrefixes: FxHashMap<String, String> = \"{}\",\n+        diagnostics_remapPrefix: FxHashMap<String, String> = \"{}\",\n         /// List of warnings that should be displayed with info severity.\n         ///\n         /// The warnings will be indicated by a blue squiggly underline in code\n@@ -477,7 +477,7 @@ impl Config {\n     }\n     pub fn diagnostics_map(&self) -> DiagnosticsMapConfig {\n         DiagnosticsMapConfig {\n-            remap_path_prefixes: self.data.diagnostics_remapPathPrefixes.clone(),\n+            remap_prefix: self.data.diagnostics_remapPrefix.clone(),\n             warnings_as_info: self.data.diagnostics_warningsAsInfo.clone(),\n             warnings_as_hint: self.data.diagnostics_warningsAsHint.clone(),\n         }"}, {"sha": "d4b9db362b0e8d3d087edee6054c4681089b8c4a", "filename": "crates/rust-analyzer/src/diagnostics.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/72718bc2d7113874536b8bcd486aa5bd7dacafe6/crates%2Frust-analyzer%2Fsrc%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/72718bc2d7113874536b8bcd486aa5bd7dacafe6/crates%2Frust-analyzer%2Fsrc%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fdiagnostics.rs?ref=72718bc2d7113874536b8bcd486aa5bd7dacafe6", "patch": "@@ -12,7 +12,7 @@ pub(crate) type CheckFixes = Arc<FxHashMap<FileId, Vec<Fix>>>;\n \n #[derive(Debug, Default, Clone)]\n pub struct DiagnosticsMapConfig {\n-    pub remap_path_prefixes: FxHashMap<String, String>,\n+    pub remap_prefix: FxHashMap<String, String>,\n     pub warnings_as_info: Vec<String>,\n     pub warnings_as_hint: Vec<String>,\n }"}, {"sha": "82dd0da9a444b8f567a937b00aa09621dbb2266f", "filename": "crates/rust-analyzer/src/diagnostics/to_proto.rs", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/72718bc2d7113874536b8bcd486aa5bd7dacafe6/crates%2Frust-analyzer%2Fsrc%2Fdiagnostics%2Fto_proto.rs", "raw_url": "https://github.com/rust-lang/rust/raw/72718bc2d7113874536b8bcd486aa5bd7dacafe6/crates%2Frust-analyzer%2Fsrc%2Fdiagnostics%2Fto_proto.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fdiagnostics%2Fto_proto.rs?ref=72718bc2d7113874536b8bcd486aa5bd7dacafe6", "patch": "@@ -99,10 +99,12 @@ fn diagnostic_related_information(\n /// Resolves paths applying any matching path prefix remappings, and then\n /// joining the path to the workspace root.\n fn resolve_path(config: &DiagnosticsMapConfig, workspace_root: &Path, file_name: &str) -> PathBuf {\n-    match config.remap_path_prefixes.iter().find(|(from, _)| file_name.starts_with(*from)) {\n-        Some((from, to)) => {\n-            workspace_root.join(format!(\"{}{}\", to, file_name.strip_prefix(from).unwrap()))\n-        }\n+    match config\n+        .remap_prefix\n+        .iter()\n+        .find_map(|(from, to)| file_name.strip_prefix(from).map(|file_name| (to, file_name)))\n+    {\n+        Some((to, file_name)) => workspace_root.join(format!(\"{}{}\", to, file_name)),\n         None => workspace_root.join(file_name),\n     }\n }"}, {"sha": "e28423e993273f15b95c9a5e6346bf734cb4f85c", "filename": "docs/user/generated_config.adoc", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/72718bc2d7113874536b8bcd486aa5bd7dacafe6/docs%2Fuser%2Fgenerated_config.adoc", "raw_url": "https://github.com/rust-lang/rust/raw/72718bc2d7113874536b8bcd486aa5bd7dacafe6/docs%2Fuser%2Fgenerated_config.adoc", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/docs%2Fuser%2Fgenerated_config.adoc?ref=72718bc2d7113874536b8bcd486aa5bd7dacafe6", "patch": "@@ -147,10 +147,10 @@ have more false positives than usual.\n --\n List of rust-analyzer diagnostics to disable.\n --\n-[[rust-analyzer.diagnostics.remapPathPrefixes]]rust-analyzer.diagnostics.remapPathPrefixes (default: `{}`)::\n+[[rust-analyzer.diagnostics.remapPrefix]]rust-analyzer.diagnostics.remapPrefix (default: `{}`)::\n +\n --\n-Map of path prefixes to be substituted when parsing diagnostic file paths.\n+Map of prefixes to be substituted when parsing diagnostic file paths.\n This should be the reverse mapping of what is passed to `rustc` as `--remap-path-prefix`.\n --\n [[rust-analyzer.diagnostics.warningsAsHint]]rust-analyzer.diagnostics.warningsAsHint (default: `[]`)::"}, {"sha": "fa5632f900750790d35c408cb9fb9b04c006185a", "filename": "editors/code/package.json", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/72718bc2d7113874536b8bcd486aa5bd7dacafe6/editors%2Fcode%2Fpackage.json", "raw_url": "https://github.com/rust-lang/rust/raw/72718bc2d7113874536b8bcd486aa5bd7dacafe6/editors%2Fcode%2Fpackage.json", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Fpackage.json?ref=72718bc2d7113874536b8bcd486aa5bd7dacafe6", "patch": "@@ -565,8 +565,8 @@\n                     },\n                     \"uniqueItems\": true\n                 },\n-                \"rust-analyzer.diagnostics.remapPathPrefixes\": {\n-                    \"markdownDescription\": \"Map of path prefixes to be substituted when parsing diagnostic file paths.\\nThis should be the reverse mapping of what is passed to `rustc` as `--remap-path-prefix`.\",\n+                \"rust-analyzer.diagnostics.remapPrefix\": {\n+                    \"markdownDescription\": \"Map of prefixes to be substituted when parsing diagnostic file paths.\\nThis should be the reverse mapping of what is passed to `rustc` as `--remap-path-prefix`.\",\n                     \"default\": {},\n                     \"type\": \"object\"\n                 },"}]}