{"sha": "b0f98c60a6ce6d71e244b355e1a602d6994fa8ed", "node_id": "MDY6Q29tbWl0NzI0NzEyOmIwZjk4YzYwYTZjZTZkNzFlMjQ0YjM1NWUxYTYwMmQ2OTk0ZmE4ZWQ=", "commit": {"author": {"name": "Trevor Spiteri", "email": "tspiteri@ieee.org", "date": "2021-07-07T11:13:58Z"}, "committer": {"name": "Trevor Spiteri", "email": "tspiteri@ieee.org", "date": "2021-07-07T12:07:32Z"}, "message": "test integer log10 values close to all powers of 10", "tree": {"sha": "1a99a717c1c60613a438994c156c03722327e3be", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1a99a717c1c60613a438994c156c03722327e3be"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b0f98c60a6ce6d71e244b355e1a602d6994fa8ed", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b0f98c60a6ce6d71e244b355e1a602d6994fa8ed", "html_url": "https://github.com/rust-lang/rust/commit/b0f98c60a6ce6d71e244b355e1a602d6994fa8ed", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b0f98c60a6ce6d71e244b355e1a602d6994fa8ed/comments", "author": {"login": "tspiteri", "id": 18604588, "node_id": "MDQ6VXNlcjE4NjA0NTg4", "avatar_url": "https://avatars.githubusercontent.com/u/18604588?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tspiteri", "html_url": "https://github.com/tspiteri", "followers_url": "https://api.github.com/users/tspiteri/followers", "following_url": "https://api.github.com/users/tspiteri/following{/other_user}", "gists_url": "https://api.github.com/users/tspiteri/gists{/gist_id}", "starred_url": "https://api.github.com/users/tspiteri/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tspiteri/subscriptions", "organizations_url": "https://api.github.com/users/tspiteri/orgs", "repos_url": "https://api.github.com/users/tspiteri/repos", "events_url": "https://api.github.com/users/tspiteri/events{/privacy}", "received_events_url": "https://api.github.com/users/tspiteri/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tspiteri", "id": 18604588, "node_id": "MDQ6VXNlcjE4NjA0NTg4", "avatar_url": "https://avatars.githubusercontent.com/u/18604588?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tspiteri", "html_url": "https://github.com/tspiteri", "followers_url": "https://api.github.com/users/tspiteri/followers", "following_url": "https://api.github.com/users/tspiteri/following{/other_user}", "gists_url": "https://api.github.com/users/tspiteri/gists{/gist_id}", "starred_url": "https://api.github.com/users/tspiteri/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tspiteri/subscriptions", "organizations_url": "https://api.github.com/users/tspiteri/orgs", "repos_url": "https://api.github.com/users/tspiteri/repos", "events_url": "https://api.github.com/users/tspiteri/events{/privacy}", "received_events_url": "https://api.github.com/users/tspiteri/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c5e344f7747dbd7e7d4b209e3c480deb5979a56f", "url": "https://api.github.com/repos/rust-lang/rust/commits/c5e344f7747dbd7e7d4b209e3c480deb5979a56f", "html_url": "https://github.com/rust-lang/rust/commit/c5e344f7747dbd7e7d4b209e3c480deb5979a56f"}], "stats": {"total": 54, "additions": 54, "deletions": 0}, "files": [{"sha": "51122c11ce1e29bc19a40e37091e4b1bc1b3cf8e", "filename": "library/core/tests/num/int_log.rs", "status": "modified", "additions": 54, "deletions": 0, "changes": 54, "blob_url": "https://github.com/rust-lang/rust/blob/b0f98c60a6ce6d71e244b355e1a602d6994fa8ed/library%2Fcore%2Ftests%2Fnum%2Fint_log.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b0f98c60a6ce6d71e244b355e1a602d6994fa8ed/library%2Fcore%2Ftests%2Fnum%2Fint_log.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Ftests%2Fnum%2Fint_log.rs?ref=b0f98c60a6ce6d71e244b355e1a602d6994fa8ed", "patch": "@@ -97,3 +97,57 @@ fn checked_log10() {\n         assert_eq!(i.checked_log10(), Some((i as f32).log10() as u16));\n     }\n }\n+\n+macro_rules! log10_loop {\n+    ($T:ty, $log10_max:expr) => {\n+        assert_eq!(<$T>::MAX.log10(), $log10_max);\n+        for i in 0..=$log10_max {\n+            let p = (10 as $T).pow(i as u32);\n+            if p >= 10 {\n+                assert_eq!((p - 9).log10(), i - 1);\n+                assert_eq!((p - 1).log10(), i - 1);\n+            }\n+            assert_eq!(p.log10(), i);\n+            assert_eq!((p + 1).log10(), i);\n+            if p >= 10 {\n+                assert_eq!((p + 9).log10(), i);\n+            }\n+\n+            // also check `x.log(10)`\n+            if p >= 10 {\n+                assert_eq!((p - 9).log(10), i - 1);\n+                assert_eq!((p - 1).log(10), i - 1);\n+            }\n+            assert_eq!(p.log(10), i);\n+            assert_eq!((p + 1).log(10), i);\n+            if p >= 10 {\n+                assert_eq!((p + 9).log(10), i);\n+            }\n+        }\n+    };\n+}\n+\n+#[test]\n+fn log10_u8() {\n+    log10_loop! { u8, 2 }\n+}\n+\n+#[test]\n+fn log10_u16() {\n+    log10_loop! { u16, 4 }\n+}\n+\n+#[test]\n+fn log10_u32() {\n+    log10_loop! { u32, 9 }\n+}\n+\n+#[test]\n+fn log10_u64() {\n+    log10_loop! { u64, 19 }\n+}\n+\n+#[test]\n+fn log10_u128() {\n+    log10_loop! { u128, 38 }\n+}"}]}