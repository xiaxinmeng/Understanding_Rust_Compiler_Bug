{"sha": "a2cc014231537d913cc51984a6ec11090d62e787", "node_id": "C_kwDOAAsO6NoAKGEyY2MwMTQyMzE1MzdkOTEzY2M1MTk4NGE2ZWMxMTA5MGQ2MmU3ODc", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-06-06T22:53:19Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-06-13T16:07:02Z"}, "message": "test files in a deterministic order", "tree": {"sha": "edc78e283b1a242c01d2e66bf273868969926004", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/edc78e283b1a242c01d2e66bf273868969926004"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a2cc014231537d913cc51984a6ec11090d62e787", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a2cc014231537d913cc51984a6ec11090d62e787", "html_url": "https://github.com/rust-lang/rust/commit/a2cc014231537d913cc51984a6ec11090d62e787", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a2cc014231537d913cc51984a6ec11090d62e787/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0648f03133a899269a86cdd204d45582871bbb61", "url": "https://api.github.com/repos/rust-lang/rust/commits/0648f03133a899269a86cdd204d45582871bbb61", "html_url": "https://github.com/rust-lang/rust/commit/0648f03133a899269a86cdd204d45582871bbb61"}], "stats": {"total": 8, "additions": 6, "deletions": 2}, "files": [{"sha": "d6938b19bfe490c37ade5c9258475078f288615e", "filename": "ui_test/src/lib.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/a2cc014231537d913cc51984a6ec11090d62e787/ui_test%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a2cc014231537d913cc51984a6ec11090d62e787/ui_test%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/ui_test%2Fsrc%2Flib.rs?ref=a2cc014231537d913cc51984a6ec11090d62e787", "patch": "@@ -73,8 +73,12 @@ pub fn run_tests(config: Config) {\n             while let Some(path) = todo.pop_front() {\n                 if path.is_dir() {\n                     // Enqueue everything inside this directory.\n-                    for entry in std::fs::read_dir(path).unwrap() {\n-                        todo.push_back(entry.unwrap().path());\n+                    // We want it sorted, to have some control over scheduling of slow tests.\n+                    let mut entries =\n+                        std::fs::read_dir(path).unwrap().collect::<Result<Vec<_>, _>>().unwrap();\n+                    entries.sort_by_key(|e| e.file_name());\n+                    for entry in entries {\n+                        todo.push_back(entry.path());\n                     }\n                 } else if path.extension().map(|ext| ext == \"rs\").unwrap_or(false) {\n                     // Forward .rs files to the test workers."}]}