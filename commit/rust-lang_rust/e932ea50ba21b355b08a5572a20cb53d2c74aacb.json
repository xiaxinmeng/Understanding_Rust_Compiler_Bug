{"sha": "e932ea50ba21b355b08a5572a20cb53d2c74aacb", "node_id": "C_kwDOAAsO6NoAKGU5MzJlYTUwYmEyMWIzNTViMDhhNTU3MmEyMGNiNTNkMmM3NGFhY2I", "commit": {"author": {"name": "Mateusz Gienieczko", "email": "mat@gienieczko.com", "date": "2022-05-21T14:10:08Z"}, "committer": {"name": "Mateusz Gienieczko", "email": "mat@gienieczko.com", "date": "2022-05-21T14:10:08Z"}, "message": "Add failing page_size test.", "tree": {"sha": "9958d2e8e7d816f4f8c39d70398a5aabd19c118f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9958d2e8e7d816f4f8c39d70398a5aabd19c118f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e932ea50ba21b355b08a5572a20cb53d2c74aacb", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niHUEABYIAB0WIQS6ttWmD/dycqbuYdU4bLXkFRN0aQUCYojywAAKCRA4bLXkFRN0\naXjCAP4688c/dMhLWrUdGiqxgvFK/KSe9QClLGLMKoOlFhTePAEAqMwRnYsghDVk\nzs1dscPdijENHdGi+Mo0rOYDvjw6bww=\n=zLu2\n-----END PGP SIGNATURE-----", "payload": "tree 9958d2e8e7d816f4f8c39d70398a5aabd19c118f\nparent b96610b3de5bc9fd346d90700ba881aca8d503f0\nauthor Mateusz Gienieczko <mat@gienieczko.com> 1653142208 +0200\ncommitter Mateusz Gienieczko <mat@gienieczko.com> 1653142208 +0200\n\nAdd failing page_size test.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e932ea50ba21b355b08a5572a20cb53d2c74aacb", "html_url": "https://github.com/rust-lang/rust/commit/e932ea50ba21b355b08a5572a20cb53d2c74aacb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e932ea50ba21b355b08a5572a20cb53d2c74aacb/comments", "author": {"login": "V0ldek", "id": 20441980, "node_id": "MDQ6VXNlcjIwNDQxOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/20441980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/V0ldek", "html_url": "https://github.com/V0ldek", "followers_url": "https://api.github.com/users/V0ldek/followers", "following_url": "https://api.github.com/users/V0ldek/following{/other_user}", "gists_url": "https://api.github.com/users/V0ldek/gists{/gist_id}", "starred_url": "https://api.github.com/users/V0ldek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/V0ldek/subscriptions", "organizations_url": "https://api.github.com/users/V0ldek/orgs", "repos_url": "https://api.github.com/users/V0ldek/repos", "events_url": "https://api.github.com/users/V0ldek/events{/privacy}", "received_events_url": "https://api.github.com/users/V0ldek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "V0ldek", "id": 20441980, "node_id": "MDQ6VXNlcjIwNDQxOTgw", "avatar_url": "https://avatars.githubusercontent.com/u/20441980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/V0ldek", "html_url": "https://github.com/V0ldek", "followers_url": "https://api.github.com/users/V0ldek/followers", "following_url": "https://api.github.com/users/V0ldek/following{/other_user}", "gists_url": "https://api.github.com/users/V0ldek/gists{/gist_id}", "starred_url": "https://api.github.com/users/V0ldek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/V0ldek/subscriptions", "organizations_url": "https://api.github.com/users/V0ldek/orgs", "repos_url": "https://api.github.com/users/V0ldek/repos", "events_url": "https://api.github.com/users/V0ldek/events{/privacy}", "received_events_url": "https://api.github.com/users/V0ldek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b96610b3de5bc9fd346d90700ba881aca8d503f0", "url": "https://api.github.com/repos/rust-lang/rust/commits/b96610b3de5bc9fd346d90700ba881aca8d503f0", "html_url": "https://github.com/rust-lang/rust/commit/b96610b3de5bc9fd346d90700ba881aca8d503f0"}], "stats": {"total": 75, "additions": 61, "deletions": 14}, "files": [{"sha": "4bece389dc87f227cf5d10009f7b956b965d0c92", "filename": "test-cargo-miri/Cargo.lock", "status": "modified", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/e932ea50ba21b355b08a5572a20cb53d2c74aacb/test-cargo-miri%2FCargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/e932ea50ba21b355b08a5572a20cb53d2c74aacb/test-cargo-miri%2FCargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2FCargo.lock?ref=e932ea50ba21b355b08a5572a20cb53d2c74aacb", "patch": "@@ -22,6 +22,7 @@ dependencies = [\n  \"issue_1705\",\n  \"issue_1760\",\n  \"issue_rust_86261\",\n+ \"page_size\",\n  \"rand\",\n  \"serde_derive\",\n ]\n@@ -123,6 +124,16 @@ dependencies = [\n  \"libc\",\n ]\n \n+[[package]]\n+name = \"page_size\"\n+version = \"0.4.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"eebde548fbbf1ea81a99b128872779c437752fb99f217c45245e1a61dcd9edcd\"\n+dependencies = [\n+ \"libc\",\n+ \"winapi\",\n+]\n+\n [[package]]\n name = \"ppv-lite86\"\n version = \"0.2.10\"\n@@ -233,3 +244,25 @@ name = \"wasi\"\n version = \"0.10.2+wasi-snapshot-preview1\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n checksum = \"fd6fbd9a79829dd1ad0cc20627bf1ed606756a7f77edff7b66b7064f9cb327c6\"\n+\n+[[package]]\n+name = \"winapi\"\n+version = \"0.3.9\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"5c839a674fcd7a98952e593242ea400abe93992746761e38641405d28b00f419\"\n+dependencies = [\n+ \"winapi-i686-pc-windows-gnu\",\n+ \"winapi-x86_64-pc-windows-gnu\",\n+]\n+\n+[[package]]\n+name = \"winapi-i686-pc-windows-gnu\"\n+version = \"0.4.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"ac3b87c63620426dd9b991e5ce0329eff545bccbbb34f3be09ff6fb6ab51b7b6\"\n+\n+[[package]]\n+name = \"winapi-x86_64-pc-windows-gnu\"\n+version = \"0.4.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"712e227841d057c1ee1cd2fb22fa7e5a5461ae8e48fa2ca79ec42cfc1931183f\""}, {"sha": "2193d354d5d21ca9b4ce867c4ef1c52d861f4b29", "filename": "test-cargo-miri/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/e932ea50ba21b355b08a5572a20cb53d2c74aacb/test-cargo-miri%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/e932ea50ba21b355b08a5572a20cb53d2c74aacb/test-cargo-miri%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2FCargo.toml?ref=e932ea50ba21b355b08a5572a20cb53d2c74aacb", "patch": "@@ -22,6 +22,7 @@ rand = { version = \"0.8\", features = [\"small_rng\"] }\n getrandom_1 = { package = \"getrandom\", version = \"0.1\" }\n getrandom_2 = { package = \"getrandom\", version = \"0.2\" }\n serde_derive = \"1.0\" # not actually used, but exercises some unique code path (`--extern` .so file)\n+page_size = \"0.4.1\"\n \n [lib]\n test = false # test that this is respected (will show in the output)"}, {"sha": "3673e5549d8c28532d746f8c5fe1350242242e49", "filename": "test-cargo-miri/test.cross-target.stdout.ref", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/e932ea50ba21b355b08a5572a20cb53d2c74aacb/test-cargo-miri%2Ftest.cross-target.stdout.ref", "raw_url": "https://github.com/rust-lang/rust/raw/e932ea50ba21b355b08a5572a20cb53d2c74aacb/test-cargo-miri%2Ftest.cross-target.stdout.ref", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2Ftest.cross-target.stdout.ref?ref=e932ea50ba21b355b08a5572a20cb53d2c74aacb", "patch": "@@ -5,7 +5,7 @@ test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out\n \n imported main\n \n-running 7 tests\n-..i....\n-test result: ok. 6 passed; 0 failed; 1 ignored; 0 measured; 0 filtered out\n+running 8 tests\n+..i.....\n+test result: ok. 7 passed; 0 failed; 1 ignored; 0 measured; 0 filtered out\n "}, {"sha": "a59108efb3323c0e5dbd4a03d94863e2c3076230", "filename": "test-cargo-miri/test.default.stdout.ref", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/e932ea50ba21b355b08a5572a20cb53d2c74aacb/test-cargo-miri%2Ftest.default.stdout.ref", "raw_url": "https://github.com/rust-lang/rust/raw/e932ea50ba21b355b08a5572a20cb53d2c74aacb/test-cargo-miri%2Ftest.default.stdout.ref", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2Ftest.default.stdout.ref?ref=e932ea50ba21b355b08a5572a20cb53d2c74aacb", "patch": "@@ -5,9 +5,9 @@ test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out\n \n imported main\n \n-running 7 tests\n-..i....\n-test result: ok. 6 passed; 0 failed; 1 ignored; 0 measured; 0 filtered out\n+running 8 tests\n+..i.....\n+test result: ok. 7 passed; 0 failed; 1 ignored; 0 measured; 0 filtered out\n \n \n running 4 tests"}, {"sha": "9fb7670d06495634039f78c0b0e07af187bc6398", "filename": "test-cargo-miri/test.filter.cross-target.stdout.ref", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e932ea50ba21b355b08a5572a20cb53d2c74aacb/test-cargo-miri%2Ftest.filter.cross-target.stdout.ref", "raw_url": "https://github.com/rust-lang/rust/raw/e932ea50ba21b355b08a5572a20cb53d2c74aacb/test-cargo-miri%2Ftest.filter.cross-target.stdout.ref", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2Ftest.filter.cross-target.stdout.ref?ref=e932ea50ba21b355b08a5572a20cb53d2c74aacb", "patch": "@@ -8,5 +8,5 @@ imported main\n running 1 test\n test simple1 ... ok\n \n-test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 6 filtered out\n+test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 7 filtered out\n "}, {"sha": "4b598960a0963ba657721746a1ce57b96976f4b3", "filename": "test-cargo-miri/test.filter.stdout.ref", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/e932ea50ba21b355b08a5572a20cb53d2c74aacb/test-cargo-miri%2Ftest.filter.stdout.ref", "raw_url": "https://github.com/rust-lang/rust/raw/e932ea50ba21b355b08a5572a20cb53d2c74aacb/test-cargo-miri%2Ftest.filter.stdout.ref", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2Ftest.filter.stdout.ref?ref=e932ea50ba21b355b08a5572a20cb53d2c74aacb", "patch": "@@ -8,7 +8,7 @@ imported main\n running 1 test\n test simple1 ... ok\n \n-test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 6 filtered out\n+test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 7 filtered out\n \n \n running 0 tests"}, {"sha": "ca069b702eba44c4d501e6aa40813b4b38062e62", "filename": "test-cargo-miri/test.test-target.stdout.ref", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/e932ea50ba21b355b08a5572a20cb53d2c74aacb/test-cargo-miri%2Ftest.test-target.stdout.ref", "raw_url": "https://github.com/rust-lang/rust/raw/e932ea50ba21b355b08a5572a20cb53d2c74aacb/test-cargo-miri%2Ftest.test-target.stdout.ref", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2Ftest.test-target.stdout.ref?ref=e932ea50ba21b355b08a5572a20cb53d2c74aacb", "patch": "@@ -1,12 +1,13 @@\n \n-running 7 tests\n+running 8 tests\n test cargo_env ... ok\n test do_panic - should panic ... ok\n test does_not_work_on_miri ... ignored\n test entropy_rng ... ok\n test fail_index_check - should panic ... ok\n+test page_size ... ok\n test simple1 ... ok\n test simple2 ... ok\n \n-test result: ok. 6 passed; 0 failed; 1 ignored; 0 measured; 0 filtered out\n+test result: ok. 7 passed; 0 failed; 1 ignored; 0 measured; 0 filtered out\n "}, {"sha": "6758e99703cce53ee12dbd8e7f64d698eb6eb61c", "filename": "test-cargo-miri/tests/test.rs", "status": "modified", "additions": 16, "deletions": 4, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/e932ea50ba21b355b08a5572a20cb53d2c74aacb/test-cargo-miri%2Ftests%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e932ea50ba21b355b08a5572a20cb53d2c74aacb/test-cargo-miri%2Ftests%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/test-cargo-miri%2Ftests%2Ftest.rs?ref=e932ea50ba21b355b08a5572a20cb53d2c74aacb", "patch": "@@ -1,4 +1,4 @@\n-use rand::{SeedableRng, Rng, rngs::SmallRng};\n+use rand::{rngs::SmallRng, Rng, SeedableRng};\n \n // Having more than 1 test does seem to make a difference\n // (i.e., this calls ptr::swap which having just one test does not).\n@@ -49,14 +49,26 @@ fn cargo_env() {\n }\n \n #[test]\n-#[should_panic(expected=\"Explicit panic\")]\n-fn do_panic() { // In large, friendly letters :)\n+#[should_panic(expected = \"Explicit panic\")]\n+fn do_panic() {\n+    // In large, friendly letters :)\n     panic!(\"Explicit panic from test!\");\n }\n \n #[test]\n #[allow(unconditional_panic)]\n-#[should_panic(expected=\"the len is 0 but the index is 42\")]\n+#[should_panic(expected = \"the len is 0 but the index is 42\")]\n fn fail_index_check() {\n     [][42]\n }\n+\n+#[test]\n+fn page_size() {\n+    let page_size = page_size::get();\n+\n+    assert!(\n+        page_size.next_power_of_two() == page_size,\n+        \"page size not a power of two: {}\",\n+        page_size\n+    );\n+}"}]}