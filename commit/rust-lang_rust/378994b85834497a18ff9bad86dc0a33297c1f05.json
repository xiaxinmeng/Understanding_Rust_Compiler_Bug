{"sha": "378994b85834497a18ff9bad86dc0a33297c1f05", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM3ODk5NGI4NTgzNDQ5N2ExOGZmOWJhZDg2ZGMwYTMzMjk3YzFmMDU=", "commit": {"author": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2018-11-27T01:04:48Z"}, "committer": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2018-11-27T01:18:14Z"}, "message": "Add a version option", "tree": {"sha": "132aebad03c0cfdf438d1382fb72cfc2d7c09a79", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/132aebad03c0cfdf438d1382fb72cfc2d7c09a79"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/378994b85834497a18ff9bad86dc0a33297c1f05", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/378994b85834497a18ff9bad86dc0a33297c1f05", "html_url": "https://github.com/rust-lang/rust/commit/378994b85834497a18ff9bad86dc0a33297c1f05", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/378994b85834497a18ff9bad86dc0a33297c1f05/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "460925261cf6ccf422a4424523d8bda64fde8b5a", "url": "https://api.github.com/repos/rust-lang/rust/commits/460925261cf6ccf422a4424523d8bda64fde8b5a", "html_url": "https://github.com/rust-lang/rust/commit/460925261cf6ccf422a4424523d8bda64fde8b5a"}], "stats": {"total": 57, "additions": 41, "deletions": 16}, "files": [{"sha": "b15fb999fcd2b9f25f83189100c0ad1f3a91d792", "filename": "Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/378994b85834497a18ff9bad86dc0a33297c1f05/Cargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/378994b85834497a18ff9bad86dc0a33297c1f05/Cargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.toml?ref=378994b85834497a18ff9bad86dc0a33297c1f05", "patch": "@@ -4,7 +4,7 @@ name = \"rustfmt-nightly\"\n version = \"1.0.0\"\n authors = [\"Nicholas Cameron <ncameron@mozilla.com>\", \"The Rustfmt developers\"]\n description = \"Tool to find and fix Rust formatting issues\"\n-repository = \"https://github.com/rust-lang-nursery/rustfmt\"\n+repository = \"https://github.com/rust-lang/rustfmt\"\n readme = \"README.md\"\n license = \"Apache-2.0/MIT\"\n build = \"build.rs\""}, {"sha": "9b59b19acc5f18f5a90ce0d78cef7cd9941f67c6", "filename": "Configurations.md", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/378994b85834497a18ff9bad86dc0a33297c1f05/Configurations.md", "raw_url": "https://github.com/rust-lang/rust/raw/378994b85834497a18ff9bad86dc0a33297c1f05/Configurations.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Configurations.md?ref=378994b85834497a18ff9bad86dc0a33297c1f05", "patch": "@@ -2367,6 +2367,22 @@ If you want to format code that requires edition 2018, add the following to your\n edition = \"2018\"\n ```\n \n+## `version`\n+\n+Which version of the formatting rules to use. `Version::One` is backwards-compatible\n+with Rustfmt 1.0. Other versions are only backwards compatible within a major\n+version number.\n+\n+- **Default value**: `One`\n+- **Possible values**: `One`, `Two`\n+- **Stable**: No\n+\n+### Example\n+\n+```toml\n+version = \"Two\"\n+```\n+\n ## `normalize_doc_attributes`\n \n Convert `#![doc]` and `#[doc]` attributes to `//!` and `///` doc comments."}, {"sha": "23b3de3e8fa006526cc693546492a74594f5c095", "filename": "Contributing.md", "status": "modified", "additions": 13, "deletions": 12, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/378994b85834497a18ff9bad86dc0a33297c1f05/Contributing.md", "raw_url": "https://github.com/rust-lang/rust/raw/378994b85834497a18ff9bad86dc0a33297c1f05/Contributing.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Contributing.md?ref=378994b85834497a18ff9bad86dc0a33297c1f05", "patch": "@@ -2,8 +2,8 @@\n \n There are many ways to contribute to Rustfmt. This document lays out what they\n are and has information for how to get started. If you have any questions about\n-contributing or need help with anything, please ping nrc on irc, #rust-dev-tools\n-on irc.mozilla.org is probably the best channel. Feel free to also ask questions\n+contributing or need help with anything, please ask in the WG-Rustfmt channel\n+on [Discord](https://discordapp.com/invite/rust-lang). Feel free to also ask questions\n on issues, or file new issues specifically to get help.\n \n All contributors are expected to follow our [Code of\n@@ -14,14 +14,6 @@ Conduct](CODE_OF_CONDUCT.md).\n It would be really useful to have people use rustfmt on their projects and file\n issues where it does something you don't expect.\n \n-A really useful thing to do that on a crate from the Rust repo. If it does\n-something unexpected, file an issue; if not, make a PR to the Rust repo with the\n-reformatted code. We hope to get the whole repo consistently rustfmt'ed and to\n-replace `make tidy` with rustfmt as a medium-term goal. Issues with stack traces\n-for bugs and/or minimal test cases are especially useful.\n-\n-See this [blog post](http://ncameron.org/blog/rustfmt-ing-rust/) for more details.\n-\n \n ## Create test cases\n \n@@ -66,11 +58,14 @@ example, the `issue-1111.rs` test file is configured by the file\n \n ## Debugging\n \n-Some `rewrite_*` methods use the `debug!` macro for printing useful information. These messages can be printed by using the environment variable `RUST_LOG=rustfmt=DEBUG`. These traces can be helpful in understanding which part of the code was used and get a better grasp on the execution flow.\n+Some `rewrite_*` methods use the `debug!` macro for printing useful information.\n+These messages can be printed by using the environment variable `RUST_LOG=rustfmt=DEBUG`.\n+These traces can be helpful in understanding which part of the code was used\n+and get a better grasp on the execution flow.\n \n ## Hack!\n \n-Here are some [good starting issues](https://github.com/rust-lang-nursery/rustfmt/issues?q=is%3Aopen+is%3Aissue+label%3Agood-first-issue).\n+Here are some [good starting issues](https://github.com/rust-lang/rustfmt/issues?q=is%3Aopen+is%3Aissue+label%3Agood-first-issue).\n \n If you've found areas which need polish and don't have issues, please submit a\n PR, don't feel there needs to be an issue.\n@@ -86,6 +81,12 @@ Talking of tests, if you add a new feature or fix a bug, please also add a test.\n It's really easy, see above for details. Please run `cargo test` before\n submitting a PR to ensure your patch passes all tests, it's pretty quick.\n \n+Rustfmt is post-1.0 and within major version releases we strive for backwards\n+compatibility (at least when using the default options). That means any code\n+which changes Rustfmt's output must be guarded by either an option or a version\n+check. The latter is implemented as an option called `option`. See the section on\n+[configuration](#Configuration) below.\n+\n Please try to avoid leaving `TODO`s in the code. There are a few around, but I\n wish there weren't. You can leave `FIXME`s, preferably with an issue number.\n "}, {"sha": "17d5a5bd3e6f90a439b6c4bf83d72b02e52c4220", "filename": "README.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/378994b85834497a18ff9bad86dc0a33297c1f05/README.md", "raw_url": "https://github.com/rust-lang/rust/raw/378994b85834497a18ff9bad86dc0a33297c1f05/README.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/README.md?ref=378994b85834497a18ff9bad86dc0a33297c1f05", "patch": "@@ -1,4 +1,4 @@\n-# rustfmt [![Build Status](https://travis-ci.org/rust-lang-nursery/rustfmt.svg)](https://travis-ci.org/rust-lang-nursery/rustfmt) [![Build Status](https://ci.appveyor.com/api/projects/status/github/rust-lang-nursery/rustfmt?svg=true)](https://ci.appveyor.com/project/nrc/rustfmt) [![crates.io](https://img.shields.io/crates/v/rustfmt-nightly.svg)](https://crates.io/crates/rustfmt-nightly) [![Travis Configuration Status](https://img.shields.io/travis/davidalber/rustfmt-travis.svg?label=travis%20example)](https://travis-ci.org/davidalber/rustfmt-travis)\n+# rustfmt [![Build Status](https://travis-ci.org/rust-lang/rustfmt.svg)](https://travis-ci.org/rust-lang/rustfmt) [![Build Status](https://ci.appveyor.com/api/projects/status/github/rust-lang/rustfmt?svg=true)](https://ci.appveyor.com/project/nrc/rustfmt) [![crates.io](https://img.shields.io/crates/v/rustfmt-nightly.svg)](https://crates.io/crates/rustfmt-nightly) [![Travis Configuration Status](https://img.shields.io/travis/davidalber/rustfmt-travis.svg?label=travis%20example)](https://travis-ci.org/davidalber/rustfmt-travis)\n \n A tool for formatting Rust code according to style guidelines.\n "}, {"sha": "1aec0d5bfcd507ab24e7d1522efef2700be314aa", "filename": "src/config/mod.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/378994b85834497a18ff9bad86dc0a33297c1f05/src%2Fconfig%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/378994b85834497a18ff9bad86dc0a33297c1f05/src%2Fconfig%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fconfig%2Fmod.rs?ref=378994b85834497a18ff9bad86dc0a33297c1f05", "patch": "@@ -113,6 +113,7 @@ create_config! {\n     blank_lines_lower_bound: usize, 0, false,\n         \"Minimum number of blank lines which must be put between items\";\n     edition: Edition, Edition::Edition2015, true, \"The edition of the parser (RFC 2052)\";\n+    version: Version, Version::One, false, \"Version of formatting rules\";\n \n     // Options that can change the source code beyond whitespace/blocks (somewhat linty things)\n     merge_derives: bool, true, true, \"Merge multiple `#[derive(...)]` into a single one\";"}, {"sha": "ed3e87a27fd7281947d349718ac87ddc02d68533", "filename": "src/config/options.rs", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/378994b85834497a18ff9bad86dc0a33297c1f05/src%2Fconfig%2Foptions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/378994b85834497a18ff9bad86dc0a33297c1f05/src%2Fconfig%2Foptions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fconfig%2Foptions.rs?ref=378994b85834497a18ff9bad86dc0a33297c1f05", "patch": "@@ -291,6 +291,13 @@ configuration_option_enum! { Color:\n     Auto,\n }\n \n+configuration_option_enum! { Version:\n+    // 1.x.y\n+    One,\n+    // 2.x.y\n+    Two,\n+}\n+\n impl Color {\n     /// Whether we should use a coloured terminal.\n     pub fn use_colored_tty(self) -> bool {"}, {"sha": "b44d8e1b7758348ba8f2e62d80f364231863d135", "filename": "tests/target/configs/combine_control_expr/false.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/378994b85834497a18ff9bad86dc0a33297c1f05/tests%2Ftarget%2Fconfigs%2Fcombine_control_expr%2Ffalse.rs", "raw_url": "https://github.com/rust-lang/rust/raw/378994b85834497a18ff9bad86dc0a33297c1f05/tests%2Ftarget%2Fconfigs%2Fcombine_control_expr%2Ffalse.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fconfigs%2Fcombine_control_expr%2Ffalse.rs?ref=378994b85834497a18ff9bad86dc0a33297c1f05", "patch": "@@ -1,6 +1,6 @@\n // rustfmt-indent_style: Block\n // rustfmt-combine_control_expr: false\n-// Combining openings and closings. See https://github.com/rust-lang-nursery/fmt-rfcs/issues/61.\n+// Combining openings and closings. See https://github.com/rust-lang/fmt-rfcs/issues/61.\n \n fn main() {\n     // Call"}, {"sha": "ea7c61ef39696d906be49a056c8ba4ea44b577b9", "filename": "tests/target/configs/combine_control_expr/true.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/378994b85834497a18ff9bad86dc0a33297c1f05/tests%2Ftarget%2Fconfigs%2Fcombine_control_expr%2Ftrue.rs", "raw_url": "https://github.com/rust-lang/rust/raw/378994b85834497a18ff9bad86dc0a33297c1f05/tests%2Ftarget%2Fconfigs%2Fcombine_control_expr%2Ftrue.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fconfigs%2Fcombine_control_expr%2Ftrue.rs?ref=378994b85834497a18ff9bad86dc0a33297c1f05", "patch": "@@ -1,6 +1,6 @@\n // rustfmt-indent_style: Block\n // rustfmt-combine_control_expr: true\n-// Combining openings and closings. See https://github.com/rust-lang-nursery/fmt-rfcs/issues/61.\n+// Combining openings and closings. See https://github.com/rust-lang/fmt-rfcs/issues/61.\n \n fn main() {\n     // Call"}]}