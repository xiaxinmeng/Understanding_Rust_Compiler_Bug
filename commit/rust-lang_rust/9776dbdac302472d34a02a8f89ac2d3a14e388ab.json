{"sha": "9776dbdac302472d34a02a8f89ac2d3a14e388ab", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk3NzZkYmRhYzMwMjQ3MmQzNGEwMmE4Zjg5YWMyZDNhMTRlMzg4YWI=", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2019-08-05T20:27:00Z"}, "committer": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2019-08-15T10:51:58Z"}, "message": "test Retag in drop shim", "tree": {"sha": "be475fd5da46f19e22e8ea4f09af6ef5dc4ba8d0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/be475fd5da46f19e22e8ea4f09af6ef5dc4ba8d0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/9776dbdac302472d34a02a8f89ac2d3a14e388ab", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/9776dbdac302472d34a02a8f89ac2d3a14e388ab", "html_url": "https://github.com/rust-lang/rust/commit/9776dbdac302472d34a02a8f89ac2d3a14e388ab", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/9776dbdac302472d34a02a8f89ac2d3a14e388ab/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "15810af0d67e9e791c7e6f8c0dba389bbb702b1c", "url": "https://api.github.com/repos/rust-lang/rust/commits/15810af0d67e9e791c7e6f8c0dba389bbb702b1c", "html_url": "https://github.com/rust-lang/rust/commit/15810af0d67e9e791c7e6f8c0dba389bbb702b1c"}], "stats": {"total": 37, "additions": 26, "deletions": 11}, "files": [{"sha": "34559a8181da79af5683bfbee8128451f0f31803", "filename": "src/test/mir-opt/retag.rs", "status": "modified", "additions": 26, "deletions": 11, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/9776dbdac302472d34a02a8f89ac2d3a14e388ab/src%2Ftest%2Fmir-opt%2Fretag.rs", "raw_url": "https://github.com/rust-lang/rust/raw/9776dbdac302472d34a02a8f89ac2d3a14e388ab/src%2Ftest%2Fmir-opt%2Fretag.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fmir-opt%2Fretag.rs?ref=9776dbdac302472d34a02a8f89ac2d3a14e388ab", "patch": "@@ -11,6 +11,10 @@ impl Test {\n     fn foo_shr<'x>(&self, x: &'x i32) -> &'x i32 { x }\n }\n \n+impl Drop for Test {\n+    fn drop(&mut self) {}\n+}\n+\n fn main() {\n     let mut x = 0;\n     {\n@@ -60,10 +64,12 @@ fn main() {\n //     ...\n //     bb0: {\n //         ...\n-//         _3 = const Test::foo(move _4, move _6) -> bb1;\n+//         _3 = const Test::foo(move _4, move _6) -> [return: bb2, unwind: bb3];\n //     }\n //\n-//     bb1: {\n+//     ...\n+//\n+//     bb2: {\n //         Retag(_3);\n //         ...\n //         _9 = move _3;\n@@ -80,25 +86,20 @@ fn main() {\n //         _12 = move _13 as *mut i32 (Misc);\n //         Retag([raw] _12);\n //         ...\n-//         _16 = move _17(move _18) -> bb2;\n+//         _16 = move _17(move _18) -> bb5;\n //     }\n //\n-//     bb2: {\n+//     bb5: {\n //         Retag(_16);\n //         ...\n-//         _20 = const Test::foo_shr(move _21, move _23) -> bb3;\n-//     }\n-//\n-//     bb3: {\n-//         ...\n-//         return;\n+//         _20 = const Test::foo_shr(move _21, move _23) -> [return: bb6, unwind: bb7];\n //     }\n //\n //     ...\n // }\n // END rustc.main.EraseRegions.after.mir\n // START rustc.main-{{closure}}.EraseRegions.after.mir\n-// fn main::{{closure}}#0(_1: &[closure@HirId { owner: DefIndex(20), local_id: 72 }], _2: &i32) -> &i32 {\n+// fn main::{{closure}}#0(_1: &[closure@HirId { owner: DefIndex(22), local_id: 72 }], _2: &i32) -> &i32 {\n //     ...\n //     bb0: {\n //         Retag([fn entry] _1);\n@@ -113,3 +114,17 @@ fn main() {\n //     }\n // }\n // END rustc.main-{{closure}}.EraseRegions.after.mir\n+// START rustc.ptr-real_drop_in_place.Test.SimplifyCfg-make_shim.after.mir\n+// fn  std::ptr::real_drop_in_place(_1: &mut Test) -> () {\n+//     ...\n+//     bb0: {\n+//         Retag([raw] _1);\n+//         _2 = &mut (*_1);\n+//         _3 = const <Test as std::ops::Drop>::drop(move _2) -> bb1;\n+//     }\n+//\n+//     bb1: {\n+//         return;\n+//     }\n+// }\n+// END rustc.ptr-real_drop_in_place.Test.SimplifyCfg-make_shim.after.mir"}]}