{"sha": "ff014a3a10c3ae2bcf52744736d7c0e3f095612a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZmMDE0YTNhMTBjM2FlMmJjZjUyNzQ0NzM2ZDdjMGUzZjA5NTYxMmE=", "commit": {"author": {"name": "Jeffrey Seyfried", "email": "jeffrey.seyfried@gmail.com", "date": "2016-03-01T02:36:31Z"}, "committer": {"name": "Jeffrey Seyfried", "email": "jeffrey.seyfried@gmail.com", "date": "2016-03-26T18:22:33Z"}, "message": "Refactor away populate_external_module", "tree": {"sha": "a5296a4424a311a97f094b2481e1c1235ae56479", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a5296a4424a311a97f094b2481e1c1235ae56479"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ff014a3a10c3ae2bcf52744736d7c0e3f095612a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ff014a3a10c3ae2bcf52744736d7c0e3f095612a", "html_url": "https://github.com/rust-lang/rust/commit/ff014a3a10c3ae2bcf52744736d7c0e3f095612a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ff014a3a10c3ae2bcf52744736d7c0e3f095612a/comments", "author": {"login": "jseyfried", "id": 8652869, "node_id": "MDQ6VXNlcjg2NTI4Njk=", "avatar_url": "https://avatars.githubusercontent.com/u/8652869?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jseyfried", "html_url": "https://github.com/jseyfried", "followers_url": "https://api.github.com/users/jseyfried/followers", "following_url": "https://api.github.com/users/jseyfried/following{/other_user}", "gists_url": "https://api.github.com/users/jseyfried/gists{/gist_id}", "starred_url": "https://api.github.com/users/jseyfried/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jseyfried/subscriptions", "organizations_url": "https://api.github.com/users/jseyfried/orgs", "repos_url": "https://api.github.com/users/jseyfried/repos", "events_url": "https://api.github.com/users/jseyfried/events{/privacy}", "received_events_url": "https://api.github.com/users/jseyfried/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jseyfried", "id": 8652869, "node_id": "MDQ6VXNlcjg2NTI4Njk=", "avatar_url": "https://avatars.githubusercontent.com/u/8652869?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jseyfried", "html_url": "https://github.com/jseyfried", "followers_url": "https://api.github.com/users/jseyfried/followers", "following_url": "https://api.github.com/users/jseyfried/following{/other_user}", "gists_url": "https://api.github.com/users/jseyfried/gists{/gist_id}", "starred_url": "https://api.github.com/users/jseyfried/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jseyfried/subscriptions", "organizations_url": "https://api.github.com/users/jseyfried/orgs", "repos_url": "https://api.github.com/users/jseyfried/repos", "events_url": "https://api.github.com/users/jseyfried/events{/privacy}", "received_events_url": "https://api.github.com/users/jseyfried/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7bc6c75d0f6ec012e8baa1f59f80d2c53faefd3b", "url": "https://api.github.com/repos/rust-lang/rust/commits/7bc6c75d0f6ec012e8baa1f59f80d2c53faefd3b", "html_url": "https://github.com/rust-lang/rust/commit/7bc6c75d0f6ec012e8baa1f59f80d2c53faefd3b"}], "stats": {"total": 29, "additions": 4, "deletions": 25}, "files": [{"sha": "9e955a7f37990c2d777d2215ac5cf10453182a1e", "filename": "src/librustc_resolve/build_reduced_graph.rs", "status": "modified", "additions": 4, "deletions": 25, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/ff014a3a10c3ae2bcf52744736d7c0e3f095612a/src%2Flibrustc_resolve%2Fbuild_reduced_graph.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff014a3a10c3ae2bcf52744736d7c0e3f095612a/src%2Flibrustc_resolve%2Fbuild_reduced_graph.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Fbuild_reduced_graph.rs?ref=ff014a3a10c3ae2bcf52744736d7c0e3f095612a", "patch": "@@ -19,7 +19,6 @@ use resolve_imports::ImportDirectiveSubclass::{self, SingleImport, GlobImport};\n use Module;\n use Namespace::{self, TypeNS, ValueNS};\n use {NameBinding, NameBindingKind};\n-use module_to_string;\n use ParentLink::{ModuleParentLink, BlockParentLink};\n use Resolver;\n use {resolve_error, resolve_struct_error, ResolutionError};\n@@ -547,34 +546,14 @@ impl<'a, 'b:'a, 'tcx:'b> GraphBuilder<'a, 'b, 'tcx> {\n         }\n     }\n \n-    /// Builds the reduced graph rooted at the given external module.\n-    fn populate_external_module(&mut self, module: Module<'b>) {\n-        debug!(\"(populating external module) attempting to populate {}\",\n-               module_to_string(module));\n-\n-        let def_id = match module.def_id() {\n-            None => {\n-                debug!(\"(populating external module) ... no def ID!\");\n-                return;\n-            }\n-            Some(def_id) => def_id,\n-        };\n-\n-        for child in self.session.cstore.item_children(def_id) {\n-            debug!(\"(populating external module) ... found ident: {}\",\n-                   child.name);\n-            self.build_reduced_graph_for_external_crate_def(module, child);\n-        }\n-        module.populated.set(true)\n-    }\n-\n     /// Ensures that the reduced graph rooted at the given external module\n     /// is built, building it if it is not.\n     fn populate_module_if_necessary(&mut self, module: Module<'b>) {\n-        if !module.populated.get() {\n-            self.populate_external_module(module)\n+        if module.populated.get() { return }\n+        for child in self.session.cstore.item_children(module.def_id().unwrap()) {\n+            self.build_reduced_graph_for_external_crate_def(module, child);\n         }\n-        assert!(module.populated.get())\n+        module.populated.set(true)\n     }\n \n     /// Builds the reduced graph rooted at the 'use' directive for an external"}]}