{"sha": "4fce9c27fbd7e0b54ebf3b5ad7620d95dea2f982", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRmY2U5YzI3ZmJkN2UwYjU0ZWJmM2I1YWQ3NjIwZDk1ZGVhMmY5ODI=", "commit": {"author": {"name": "Yuki Okushi", "email": "huyuumi.dev@gmail.com", "date": "2020-01-07T07:51:34Z"}, "committer": {"name": "Yuki Okushi", "email": "huyuumi.dev@gmail.com", "date": "2020-01-08T20:57:28Z"}, "message": "Delay bug to prevent ICE in MIR borrowck", "tree": {"sha": "52704a8388077dcc30374518064059817de613f2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/52704a8388077dcc30374518064059817de613f2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4fce9c27fbd7e0b54ebf3b5ad7620d95dea2f982", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4fce9c27fbd7e0b54ebf3b5ad7620d95dea2f982", "html_url": "https://github.com/rust-lang/rust/commit/4fce9c27fbd7e0b54ebf3b5ad7620d95dea2f982", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4fce9c27fbd7e0b54ebf3b5ad7620d95dea2f982/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ed6468da160bd67a2ce0573427f09a98daff8c07", "url": "https://api.github.com/repos/rust-lang/rust/commits/ed6468da160bd67a2ce0573427f09a98daff8c07", "html_url": "https://github.com/rust-lang/rust/commit/ed6468da160bd67a2ce0573427f09a98daff8c07"}], "stats": {"total": 31, "additions": 30, "deletions": 1}, "files": [{"sha": "b9d9ed592fc72856ad3da1fb16d6d31aecf26b14", "filename": "src/librustc_mir/transform/elaborate_drops.rs", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/4fce9c27fbd7e0b54ebf3b5ad7620d95dea2f982/src%2Flibrustc_mir%2Ftransform%2Felaborate_drops.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4fce9c27fbd7e0b54ebf3b5ad7620d95dea2f982/src%2Flibrustc_mir%2Ftransform%2Felaborate_drops.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Ftransform%2Felaborate_drops.rs?ref=4fce9c27fbd7e0b54ebf3b5ad7620d95dea2f982", "patch": "@@ -28,7 +28,13 @@ impl<'tcx> MirPass<'tcx> for ElaborateDrops {\n         let param_env = tcx.param_env(src.def_id()).with_reveal_all();\n         let move_data = match MoveData::gather_moves(body, tcx, param_env) {\n             Ok(move_data) => move_data,\n-            Err(_) => bug!(\"No `move_errors` should be allowed in MIR borrowck\"),\n+            Err((move_data, _)) => {\n+                tcx.sess.delay_span_bug(\n+                    body.span,\n+                    \"No `move_errors` should be allowed in MIR borrowck\",\n+                );\n+                move_data\n+            }\n         };\n         let elaborate_patch = {\n             let body = &*body;"}, {"sha": "79e75e655ff1f4574420dd0db7319984ef5c7bf2", "filename": "src/test/ui/mir/issue-67947.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/4fce9c27fbd7e0b54ebf3b5ad7620d95dea2f982/src%2Ftest%2Fui%2Fmir%2Fissue-67947.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4fce9c27fbd7e0b54ebf3b5ad7620d95dea2f982/src%2Ftest%2Fui%2Fmir%2Fissue-67947.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmir%2Fissue-67947.rs?ref=4fce9c27fbd7e0b54ebf3b5ad7620d95dea2f982", "patch": "@@ -0,0 +1,7 @@\n+struct Bug {\n+    A: [(); { *\"\" }.len()],\n+    //~^ ERROR: cannot move a value of type str\n+    //~| ERROR: cannot move out of a shared reference\n+}\n+\n+fn main() {}"}, {"sha": "d5262181620762c461f2b62ad2af0a35ef4dd5e1", "filename": "src/test/ui/mir/issue-67947.stderr", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/4fce9c27fbd7e0b54ebf3b5ad7620d95dea2f982/src%2Ftest%2Fui%2Fmir%2Fissue-67947.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4fce9c27fbd7e0b54ebf3b5ad7620d95dea2f982/src%2Ftest%2Fui%2Fmir%2Fissue-67947.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmir%2Fissue-67947.stderr?ref=4fce9c27fbd7e0b54ebf3b5ad7620d95dea2f982", "patch": "@@ -0,0 +1,16 @@\n+error[E0161]: cannot move a value of type str: the size of str cannot be statically determined\n+  --> $DIR/issue-67947.rs:2:13\n+   |\n+LL |     A: [(); { *\"\" }.len()],\n+   |             ^^^^^^^\n+\n+error[E0507]: cannot move out of a shared reference\n+  --> $DIR/issue-67947.rs:2:15\n+   |\n+LL |     A: [(); { *\"\" }.len()],\n+   |               ^^^ move occurs because value has type `str`, which does not implement the `Copy` trait\n+\n+error: aborting due to 2 previous errors\n+\n+Some errors have detailed explanations: E0161, E0507.\n+For more information about an error, try `rustc --explain E0161`."}]}