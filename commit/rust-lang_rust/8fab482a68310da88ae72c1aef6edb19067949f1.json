{"sha": "8fab482a68310da88ae72c1aef6edb19067949f1", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhmYWI0ODJhNjgzMTBkYTg4YWU3MmMxYWVmNmVkYjE5MDY3OTQ5ZjE=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2018-05-12T11:52:25Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2018-05-12T17:16:37Z"}, "message": "Fix items counts in search results", "tree": {"sha": "c6d3525cb9dd4fba0ec4fe9438daff729b1ea1f2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c6d3525cb9dd4fba0ec4fe9438daff729b1ea1f2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8fab482a68310da88ae72c1aef6edb19067949f1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8fab482a68310da88ae72c1aef6edb19067949f1", "html_url": "https://github.com/rust-lang/rust/commit/8fab482a68310da88ae72c1aef6edb19067949f1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8fab482a68310da88ae72c1aef6edb19067949f1/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6a4bdda87bc09ba080f42ffe30cb488b3740ca9e", "url": "https://api.github.com/repos/rust-lang/rust/commits/6a4bdda87bc09ba080f42ffe30cb488b3740ca9e", "html_url": "https://github.com/rust-lang/rust/commit/6a4bdda87bc09ba080f42ffe30cb488b3740ca9e"}], "stats": {"total": 27, "additions": 15, "deletions": 12}, "files": [{"sha": "e08f3261871796fa343af6526a8ee753ed8b6783", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 15, "deletions": 12, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/8fab482a68310da88ae72c1aef6edb19067949f1/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/8fab482a68310da88ae72c1aef6edb19067949f1/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=8fab482a68310da88ae72c1aef6edb19067949f1", "patch": "@@ -1256,6 +1256,7 @@\n \n             var output = '';\n             var duplicates = {};\n+            var length = 0;\n             if (array.length > 0) {\n                 output = '<table class=\"search-results\"' + extraStyle + '>';\n                 var shown = [];\n@@ -1280,6 +1281,7 @@\n                         }\n                         duplicates[fullPath] = true;\n                     }\n+                    length += 1;\n \n                     output += '<tr class=\"' + type + ' result\"><td>' +\n                               '<a href=\"' + item.href + '\">' +\n@@ -1299,7 +1301,7 @@\n                     encodeURIComponent('rust ' + query.query) +\n                     '\">DuckDuckGo</a>?</div>';\n             }\n-            return output;\n+            return [output, length];\n         }\n \n         function makeTabHeader(tabNb, text, nbElems) {\n@@ -1320,21 +1322,22 @@\n                 document.body.appendChild(elem);\n                 elem.click();\n             }\n-            var output, query = getQuery(search_input.value);\n+            var query = getQuery(search_input.value);\n \n             currentResults = query.id;\n-            output = '<h1>Results for ' + escape(query.query) +\n+\n+            var ret_others = addTab(results['others'], query);\n+            var ret_in_args = addTab(results['in_args'], query, false);\n+            var ret_returned = addTab(results['returned'], query, false);\n+\n+            var output = '<h1>Results for ' + escape(query.query) +\n                 (query.type ? ' (type: ' + escape(query.type) + ')' : '') + '</h1>' +\n                 '<div id=\"titles\">' +\n-                makeTabHeader(0, \"In Names\", results['others'].length) +\n-                makeTabHeader(1, \"In Parameters\", results['in_args'].length) +\n-                makeTabHeader(2, \"In Return Types\", results['returned'].length) +\n-                '</div><div id=\"results\">';\n-\n-            output += addTab(results['others'], query);\n-            output += addTab(results['in_args'], query, false);\n-            output += addTab(results['returned'], query, false);\n-            output += '</div>';\n+                makeTabHeader(0, \"In Names\", ret_others[1]) +\n+                makeTabHeader(1, \"In Parameters\", ret_in_args[1]) +\n+                makeTabHeader(2, \"In Return Types\", ret_returned[1]) +\n+                '</div><div id=\"results\">' +\n+                ret_others[0] + ret_in_args[0] + ret_returned[0] + '</div>';\n \n             addClass(document.getElementById('main'), 'hidden');\n             var search = document.getElementById('search');"}]}