{"sha": "b01f0d392864fd581fd6cb4cd1648959bdfbfc5f", "node_id": "C_kwDOAAsO6NoAKGIwMWYwZDM5Mjg2NGZkNTgxZmQ2Y2I0Y2QxNjQ4OTU5YmRmYmZjNWY", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-04-12T20:04:35Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-04-12T20:04:35Z"}, "message": "Rollup merge of #110235 - GuillaumeGomez:fix-extend-css, r=notriddle\n\nFix `--extend-css` option\n\nFixes #110002.\n\nThe file was generated in the wrong folder so I moved it into `static.files` as it made more sense to have there instead of changing the path in the templates.\n\nI also added a GUI test to ensure that this option won't break unexpectedly again.", "tree": {"sha": "a6a7b3822dfffd06078b32ff7b29b992eef825d5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a6a7b3822dfffd06078b32ff7b29b992eef825d5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkNw7TCRBK7hj4Ov3rIwAAX1YIAB1XO6hzfwE9jkO8dXLb4kGM\nHUJGUBxdbp3lJJsfnacgtqiVf0IKbxNg6OE+KKz3hfBQftIu+SDJIgGDbgr+xW96\nR7K4SVJGzCpgt6JaVz/PSWQOqK6V9ma7hAwoydtWIKkuxVnYzqsooxEiWNjyxACm\nyPdNQ87cnZHOaUu+ps94cBaUfIvnVw+IbFQXR7ouIO68qywCIkgQQruWzMaeUMGG\nZlbRbPW9moPXC0V433Gi2KRcGMtC5HDL1bzkZRkr9VCvcAdF63EdtFxJSZYPBBBN\nyRNz5XVYSfCMpDD8LOJgaidrXORuBujiJl7TlxuY5AH5tqB4m3n7G404c/Yml3o=\n=jMte\n-----END PGP SIGNATURE-----\n", "payload": "tree a6a7b3822dfffd06078b32ff7b29b992eef825d5\nparent 57393be6fba9bc6f09aa4ba6587da9633edac675\nparent b76821b4de51fa79c4f593079679f63b7476f737\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1681329875 +0200\ncommitter GitHub <noreply@github.com> 1681329875 +0200\n\nRollup merge of #110235 - GuillaumeGomez:fix-extend-css, r=notriddle\n\nFix `--extend-css` option\n\nFixes #110002.\n\nThe file was generated in the wrong folder so I moved it into `static.files` as it made more sense to have there instead of changing the path in the templates.\n\nI also added a GUI test to ensure that this option won't break unexpectedly again.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f", "html_url": "https://github.com/rust-lang/rust/commit/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "57393be6fba9bc6f09aa4ba6587da9633edac675", "url": "https://api.github.com/repos/rust-lang/rust/commits/57393be6fba9bc6f09aa4ba6587da9633edac675", "html_url": "https://github.com/rust-lang/rust/commit/57393be6fba9bc6f09aa4ba6587da9633edac675"}, {"sha": "b76821b4de51fa79c4f593079679f63b7476f737", "url": "https://api.github.com/repos/rust-lang/rust/commits/b76821b4de51fa79c4f593079679f63b7476f737", "html_url": "https://github.com/rust-lang/rust/commit/b76821b4de51fa79c4f593079679f63b7476f737"}], "stats": {"total": 38, "additions": 31, "deletions": 7}, "files": [{"sha": "cc0e34c6035fdb1f46401b79e861f0d50cf2821e", "filename": "src/bootstrap/test.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/src%2Fbootstrap%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/src%2Fbootstrap%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftest.rs?ref=b01f0d392864fd581fd6cb4cd1648959bdfbfc5f", "patch": "@@ -1064,6 +1064,8 @@ impl Step for RustdocGUI {\n                     cargo.env(\"RUSTDOCFLAGS\", \"-Zunstable-options --generate-link-to-definition\");\n                 } else if entry.file_name() == \"scrape_examples\" {\n                     cargo.arg(\"-Zrustdoc-scrape-examples\");\n+                } else if entry.file_name() == \"extend_css\" {\n+                    cargo.env(\"RUSTDOCFLAGS\", &format!(\"--extend-css extra.css\"));\n                 }\n                 builder.run(&mut cargo);\n             }"}, {"sha": "dfc8042637232a924942f63d790b5cade3749cf7", "filename": "src/doc/rustdoc/src/command-line-arguments.md", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/src%2Fdoc%2Frustdoc%2Fsrc%2Fcommand-line-arguments.md", "raw_url": "https://github.com/rust-lang/rust/raw/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/src%2Fdoc%2Frustdoc%2Fsrc%2Fcommand-line-arguments.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustdoc%2Fsrc%2Fcommand-line-arguments.md?ref=b01f0d392864fd581fd6cb4cd1648959bdfbfc5f", "patch": "@@ -320,10 +320,7 @@ $ rustdoc src/lib.rs --extend-css extra.css\n ```\n \n With this flag, the contents of the files you pass are included at the bottom\n-of Rustdoc's `theme.css` file.\n-\n-While this flag is stable, the contents of `theme.css` are not, so be careful!\n-Updates may break your theme extensions.\n+of the `theme.css` file.\n \n ## `--sysroot`: override the system root\n "}, {"sha": "9133f899af60d79131c1c3969eb418ba53ff295d", "filename": "src/librustdoc/html/templates/page.html", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/src%2Flibrustdoc%2Fhtml%2Ftemplates%2Fpage.html", "raw_url": "https://github.com/rust-lang/rust/raw/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/src%2Flibrustdoc%2Fhtml%2Ftemplates%2Fpage.html", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Ftemplates%2Fpage.html?ref=b01f0d392864fd581fd6cb4cd1648959bdfbfc5f", "patch": "@@ -64,7 +64,7 @@\n     </noscript> {# #}\n     {% if layout.css_file_extension.is_some() %}\n         <link rel=\"stylesheet\" {#+ #}\n-            href=\"{{static_root_path|safe}}theme{{page.resource_suffix}}.css\"> {# #}\n+            href=\"{{page.root_path|safe}}theme{{page.resource_suffix}}.css\"> {# #}\n     {% endif %}\n     {% if !layout.favicon.is_empty() %}\n         <link rel=\"icon\" href=\"{{layout.favicon}}\"> {# #}"}, {"sha": "fb34469df6c522367014510a653ce46d961eccfb", "filename": "tests/rustdoc-gui/extend-css.goml", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/tests%2Frustdoc-gui%2Fextend-css.goml", "raw_url": "https://github.com/rust-lang/rust/raw/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/tests%2Frustdoc-gui%2Fextend-css.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc-gui%2Fextend-css.goml?ref=b01f0d392864fd581fd6cb4cd1648959bdfbfc5f", "patch": "@@ -0,0 +1,5 @@\n+// Test to ensure that the `--extend-css` option is working as expected.\n+go-to: \"file://\" + |DOC_PATH| + \"/extend_css/index.html\"\n+show-text: true\n+// The text from the `.extend` element should be red.\n+assert-css: (\".extend\", {\"color\": \"rgb(255, 0, 0)\"})"}, {"sha": "d739471a625a423439e48fe5f0bb71c4ce282d55", "filename": "tests/rustdoc-gui/search-filter.goml", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/tests%2Frustdoc-gui%2Fsearch-filter.goml", "raw_url": "https://github.com/rust-lang/rust/raw/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/tests%2Frustdoc-gui%2Fsearch-filter.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc-gui%2Fsearch-filter.goml?ref=b01f0d392864fd581fd6cb4cd1648959bdfbfc5f", "patch": "@@ -16,6 +16,7 @@ press-key: \"ArrowDown\"\n press-key: \"ArrowDown\"\n press-key: \"ArrowDown\"\n press-key: \"ArrowDown\"\n+press-key: \"ArrowDown\"\n press-key: \"Enter\"\n // Waiting for the search results to appear...\n wait-for: \"#search-tabs\"\n@@ -41,6 +42,7 @@ press-key: \"ArrowUp\"\n press-key: \"ArrowUp\"\n press-key: \"ArrowUp\"\n press-key: \"ArrowUp\"\n+press-key: \"ArrowUp\"\n press-key: \"Enter\"\n // Waiting for the search results to appear...\n wait-for: \"#search-tabs\""}, {"sha": "520b2c59b0f89079c4170100b6a80f762cfc9eb0", "filename": "tests/rustdoc-gui/sidebar-source-code.goml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/tests%2Frustdoc-gui%2Fsidebar-source-code.goml", "raw_url": "https://github.com/rust-lang/rust/raw/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/tests%2Frustdoc-gui%2Fsidebar-source-code.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc-gui%2Fsidebar-source-code.goml?ref=b01f0d392864fd581fd6cb4cd1648959bdfbfc5f", "patch": "@@ -73,7 +73,7 @@ assert: \"//*[@class='dir-entry' and @open]/*[text()='sub_mod']\"\n // Only \"another_folder\" should be \"open\" in \"lib2\".\n assert: \"//*[@class='dir-entry' and not(@open)]/*[text()='another_mod']\"\n // All other trees should be collapsed.\n-assert-count: (\"//*[@id='source-sidebar']/details[not(text()='lib2') and not(@open)]\", 8)\n+assert-count: (\"//*[@id='source-sidebar']/details[not(text()='lib2') and not(@open)]\", 9)\n \n // We now switch to mobile mode.\n set-window-size: (600, 600)"}, {"sha": "42f3200e9679ace5c9a60cecf5f4a6f11947d3aa", "filename": "tests/rustdoc-gui/source-code-page.goml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/tests%2Frustdoc-gui%2Fsource-code-page.goml", "raw_url": "https://github.com/rust-lang/rust/raw/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/tests%2Frustdoc-gui%2Fsource-code-page.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc-gui%2Fsource-code-page.goml?ref=b01f0d392864fd581fd6cb4cd1648959bdfbfc5f", "patch": "@@ -102,7 +102,7 @@ assert: \".source-sidebar-expanded\"\n \n // We check that the first entry of the sidebar is collapsed\n assert-property: (\"#source-sidebar details:first-of-type\", {\"open\": \"false\"})\n-assert-text: (\"#source-sidebar details:first-of-type > summary\", \"http\")\n+assert-text: (\"#source-sidebar details:first-of-type > summary\", \"extend_css\")\n // We now click on it.\n click: \"#source-sidebar details:first-of-type > summary\"\n assert-property: (\"#source-sidebar details:first-of-type\", {\"open\": \"true\"})"}, {"sha": "7101a6f0ffbb96d273ee3da37bd37d80919dce63", "filename": "tests/rustdoc-gui/src/extend_css/Cargo.lock", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/tests%2Frustdoc-gui%2Fsrc%2Fextend_css%2FCargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/tests%2Frustdoc-gui%2Fsrc%2Fextend_css%2FCargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc-gui%2Fsrc%2Fextend_css%2FCargo.lock?ref=b01f0d392864fd581fd6cb4cd1648959bdfbfc5f", "patch": "@@ -0,0 +1,7 @@\n+# This file is automatically @generated by Cargo.\n+# It is not intended for manual editing.\n+version = 3\n+\n+[[package]]\n+name = \"extend_css\"\n+version = \"0.1.0\""}, {"sha": "91683fe896488e44924c867217814dc7ed50b2e3", "filename": "tests/rustdoc-gui/src/extend_css/Cargo.toml", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/tests%2Frustdoc-gui%2Fsrc%2Fextend_css%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/tests%2Frustdoc-gui%2Fsrc%2Fextend_css%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc-gui%2Fsrc%2Fextend_css%2FCargo.toml?ref=b01f0d392864fd581fd6cb4cd1648959bdfbfc5f", "patch": "@@ -0,0 +1,7 @@\n+[package]\n+name = \"extend_css\"\n+version = \"0.1.0\"\n+edition = \"2018\"\n+\n+[lib]\n+path = \"lib.rs\""}, {"sha": "ee7062d9621ab3c3fc8a4967468b3bd5cf32384a", "filename": "tests/rustdoc-gui/src/extend_css/extra.css", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/tests%2Frustdoc-gui%2Fsrc%2Fextend_css%2Fextra.css", "raw_url": "https://github.com/rust-lang/rust/raw/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/tests%2Frustdoc-gui%2Fsrc%2Fextend_css%2Fextra.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc-gui%2Fsrc%2Fextend_css%2Fextra.css?ref=b01f0d392864fd581fd6cb4cd1648959bdfbfc5f", "patch": "@@ -0,0 +1,3 @@\n+.extend {\n+    color: red !important;\n+}"}, {"sha": "3a3babf8984050298c0ae61364c3e264512b5274", "filename": "tests/rustdoc-gui/src/extend_css/lib.rs", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/tests%2Frustdoc-gui%2Fsrc%2Fextend_css%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b01f0d392864fd581fd6cb4cd1648959bdfbfc5f/tests%2Frustdoc-gui%2Fsrc%2Fextend_css%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc-gui%2Fsrc%2Fextend_css%2Flib.rs?ref=b01f0d392864fd581fd6cb4cd1648959bdfbfc5f", "patch": "@@ -0,0 +1 @@\n+//! <div class=\"extend\">text in red</div>"}]}