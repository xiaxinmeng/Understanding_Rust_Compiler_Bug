{"sha": "180ad53576dac2455d48ba9e57678f51e6bc8808", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE4MGFkNTM1NzZkYWMyNDU1ZDQ4YmE5ZTU3Njc4ZjUxZTZiYzg4MDg=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-07-22T14:10:10Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-07-22T14:10:10Z"}, "message": "Rollup merge of #52465 - sekineh:add-ci-thumb, r=alexcrichton\n\nAdd CI test harness for `thumb*` targets. [IRR-2018-embedded]\n\nThis pull request will do the following (rather trivial) changes:\n- Fix #52163. In other words, we enabled `./x.py test src/test/run-make` for `no_std` targets.\n- Modify `dist-various-1` Dockerfile.\n  - CI now performs `run-make` test run on the targets below:\n    - `thumbv6m-none-eabi`\n    - `thumbv7m-none-eabi`\n    - `thumbv7em-none-eabi`\n    - `thumbv7em-none-eabihf`.\n- ~~Add `thumb-none` Dockerfile.~~\n  - ~~Initially, `thumbv7m-none-eabi`, `thumbv7em-none-eabi` and `thumbv7em-none-eabihf` are included as the tested target. `thumbv6m-none-eabi` is disabled for now because LLVM support is not certain.~~\n- ~~Add `thumb-none` to .travis.yml~~\n\nNote:\n- `run-make` tests are not implemented yet. This PR is test harness only.\n\nThe amount of change is very small, but I'd like to open the pull request while the change is trivial.\nBecause I'm not very used to pull request process, I want to make a small progress first.  This PR will be a foundation for later additions.\n\nCC @kennytm @jamesmunns @nerdyvaishali", "tree": {"sha": "9aebe226a60081ffa720401f060ea41a2441390d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9aebe226a60081ffa720401f060ea41a2441390d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/180ad53576dac2455d48ba9e57678f51e6bc8808", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJbVJBCCRBK7hj4Ov3rIwAAdHIIACOGAwMG4V92Mbnpa056W5XH\nJJUNFg6tFDL97NhyxJca/NlLcymDBi4vgwdvt4Ay6yZvVqbV0KZ5rWEfdgsCtX+D\naXjpdXoCDY5xx0sC67UbGA4d5J0jOkrISF6Up54YladEI8SmYB7Puqs12/qyOfdO\nIoIhW8EwhcUsUDzgUaDFyeiZIAvBxzujdwsttSEldEmWcNL7+BcwRsV0vVeKMhJV\nA2qoOoOJLlqn5DEqRQLO16VwgYsd/Couipn/JeuAFp8qnPltChewx8v3+BeSZv43\n+II2v5pjb+sn56Qh/6TgmPsF+P48a3ApDlQUq0tSUFLnAPvEPwqz46hMq8pEu9Y=\n=EJUA\n-----END PGP SIGNATURE-----\n", "payload": "tree 9aebe226a60081ffa720401f060ea41a2441390d\nparent 67cf3ba528ac99dbec7753f81ed93eccd1a5a730\nparent 3f00b1c07b30c711777132744ec27bf8bb28609d\nauthor kennytm <kennytm@gmail.com> 1532268610 +0800\ncommitter GitHub <noreply@github.com> 1532268610 +0800\n\nRollup merge of #52465 - sekineh:add-ci-thumb, r=alexcrichton\n\nAdd CI test harness for `thumb*` targets. [IRR-2018-embedded]\n\nThis pull request will do the following (rather trivial) changes:\n- Fix #52163. In other words, we enabled `./x.py test src/test/run-make` for `no_std` targets.\n- Modify `dist-various-1` Dockerfile.\n  - CI now performs `run-make` test run on the targets below:\n    - `thumbv6m-none-eabi`\n    - `thumbv7m-none-eabi`\n    - `thumbv7em-none-eabi`\n    - `thumbv7em-none-eabihf`.\n- ~~Add `thumb-none` Dockerfile.~~\n  - ~~Initially, `thumbv7m-none-eabi`, `thumbv7em-none-eabi` and `thumbv7em-none-eabihf` are included as the tested target. `thumbv6m-none-eabi` is disabled for now because LLVM support is not certain.~~\n- ~~Add `thumb-none` to .travis.yml~~\n\nNote:\n- `run-make` tests are not implemented yet. This PR is test harness only.\n\nThe amount of change is very small, but I'd like to open the pull request while the change is trivial.\nBecause I'm not very used to pull request process, I want to make a small progress first.  This PR will be a foundation for later additions.\n\nCC @kennytm @jamesmunns @nerdyvaishali\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/180ad53576dac2455d48ba9e57678f51e6bc8808", "html_url": "https://github.com/rust-lang/rust/commit/180ad53576dac2455d48ba9e57678f51e6bc8808", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/180ad53576dac2455d48ba9e57678f51e6bc8808/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "67cf3ba528ac99dbec7753f81ed93eccd1a5a730", "url": "https://api.github.com/repos/rust-lang/rust/commits/67cf3ba528ac99dbec7753f81ed93eccd1a5a730", "html_url": "https://github.com/rust-lang/rust/commit/67cf3ba528ac99dbec7753f81ed93eccd1a5a730"}, {"sha": "3f00b1c07b30c711777132744ec27bf8bb28609d", "url": "https://api.github.com/repos/rust-lang/rust/commits/3f00b1c07b30c711777132744ec27bf8bb28609d", "html_url": "https://github.com/rust-lang/rust/commit/3f00b1c07b30c711777132744ec27bf8bb28609d"}], "stats": {"total": 13, "additions": 11, "deletions": 2}, "files": [{"sha": "38bba40aa654bda8b8b34a39455540acdff9c708", "filename": "src/bootstrap/test.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/180ad53576dac2455d48ba9e57678f51e6bc8808/src%2Fbootstrap%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/180ad53576dac2455d48ba9e57678f51e6bc8808/src%2Fbootstrap%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftest.rs?ref=180ad53576dac2455d48ba9e57678f51e6bc8808", "patch": "@@ -966,7 +966,9 @@ impl Step for Compiletest {\n             builder.ensure(compile::Rustc { compiler, target });\n         }\n \n-        builder.ensure(compile::Test { compiler, target });\n+        if builder.no_std(target) != Some(true) {\n+            builder.ensure(compile::Test { compiler, target });\n+        }\n         builder.ensure(native::TestHelpers { target });\n         builder.ensure(RemoteCopyLibs { compiler, target });\n "}, {"sha": "702f9b2886e708d14aac472e6d3674d72e2c16be", "filename": "src/ci/docker/dist-various-1/Dockerfile", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/180ad53576dac2455d48ba9e57678f51e6bc8808/src%2Fci%2Fdocker%2Fdist-various-1%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/180ad53576dac2455d48ba9e57678f51e6bc8808/src%2Fci%2Fdocker%2Fdist-various-1%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-various-1%2FDockerfile?ref=180ad53576dac2455d48ba9e57678f51e6bc8808", "patch": "@@ -80,6 +80,11 @@ RUN \\\n   echo \"# a\" >> /usr/local/mips-linux-musl/bin/mips-openwrt-linux-musl-wrapper.sh && \\\n   echo \"# b\" >> /usr/local/mipsel-linux-musl/bin/mipsel-openwrt-linux-musl-wrapper.sh\n \n+ENV RUN_MAKE_TARGETS=thumbv6m-none-eabi\n+ENV RUN_MAKE_TARGETS=$RUN_MAKE_TARGETS,thumbv7m-none-eabi\n+ENV RUN_MAKE_TARGETS=$RUN_MAKE_TARGETS,thumbv7em-none-eabi\n+ENV RUN_MAKE_TARGETS=$RUN_MAKE_TARGETS,thumbv7em-none-eabihf\n+\n ENV TARGETS=asmjs-unknown-emscripten\n ENV TARGETS=$TARGETS,wasm32-unknown-emscripten\n ENV TARGETS=$TARGETS,x86_64-rumprun-netbsd\n@@ -120,7 +125,9 @@ ENV RUST_CONFIGURE_ARGS \\\n       --enable-emscripten \\\n       --disable-docs\n \n-ENV SCRIPT python2.7 ../x.py dist --target $TARGETS\n+ENV SCRIPT \\ \n+      python2.7 ../x.py test --target $RUN_MAKE_TARGETS src/test/run-make && \\\n+      python2.7 ../x.py dist --target $TARGETS\n \n # sccache\n COPY scripts/sccache.sh /scripts/"}]}