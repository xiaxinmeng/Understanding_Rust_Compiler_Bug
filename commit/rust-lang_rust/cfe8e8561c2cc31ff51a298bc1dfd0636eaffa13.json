{"sha": "cfe8e8561c2cc31ff51a298bc1dfd0636eaffa13", "node_id": "C_kwDOAAsO6NoAKGNmZThlODU2MWMyY2MzMWZmNTFhMjk4YmMxZGZkMDYzNmVhZmZhMTM", "commit": {"author": {"name": "jyn", "email": "github@jyn.dev", "date": "2023-05-20T15:40:30Z"}, "committer": {"name": "jyn", "email": "github@jyn.dev", "date": "2023-05-20T15:53:49Z"}, "message": "Make `x test --dry-run` less verbose\n\nPreviously, this would print a message for each doctest, which was quite\nverbose:\n```\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/exploit-mitigations.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/instrument-coverage.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/json.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/linker-plugin-lto.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/lints/groups.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/lints/index.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/lints/levels.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/aarch64-apple-ios-sim.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/aarch64-nintendo-switch-freestanding.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/apple-watchos.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/armeb-unknown-linux-gnueabi.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/armv4t-none-eabi.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/armv5te-none-eabi.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/armv6k-nintendo-3ds.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/armv7-sony-vita-newlibeabihf.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/armv7-unknown-linux-uclibceabi.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/armv7-unknown-linux-uclibceabihf.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/esp-idf.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/fuchsia.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/kmc-solid.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/loongarch-linux.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/m68k-unknown-linux-gnu.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/mipsel-sony-psx.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/nto-qnx.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/openbsd.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/openharmony.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/riscv32imac-unknown-xous-elf.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/unknown-uefi.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/wasm64-unknown-unknown.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/x86_64-fortanix-unknown-sgx.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/platform-support/x86_64-unknown-none.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/profile-guided-optimization.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/target-tier-policy.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/targets/custom.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/targets/index.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/tests/index.md\ndoc tests for: /home/jyn/src/rust/src/doc/rustc/src/what-is-rustc.md\n```", "tree": {"sha": "c730ea15facf0994bdc475e3eaccf2b8b072ae91", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c730ea15facf0994bdc475e3eaccf2b8b072ae91"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cfe8e8561c2cc31ff51a298bc1dfd0636eaffa13", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cfe8e8561c2cc31ff51a298bc1dfd0636eaffa13", "html_url": "https://github.com/rust-lang/rust/commit/cfe8e8561c2cc31ff51a298bc1dfd0636eaffa13", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cfe8e8561c2cc31ff51a298bc1dfd0636eaffa13/comments", "author": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ba6f5e3b4d60ea5a847cd4402cca594cd40b218f", "url": "https://api.github.com/repos/rust-lang/rust/commits/ba6f5e3b4d60ea5a847cd4402cca594cd40b218f", "html_url": "https://github.com/rust-lang/rust/commit/ba6f5e3b4d60ea5a847cd4402cca594cd40b218f"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "27b1f76a0692c9ba1e63a91cfaf2153e4fddd53f", "filename": "src/bootstrap/test.rs", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/cfe8e8561c2cc31ff51a298bc1dfd0636eaffa13/src%2Fbootstrap%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cfe8e8561c2cc31ff51a298bc1dfd0636eaffa13/src%2Fbootstrap%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftest.rs?ref=cfe8e8561c2cc31ff51a298bc1dfd0636eaffa13", "patch": "@@ -1796,6 +1796,14 @@ impl Step for BookTest {\n     ///\n     /// This uses the `rustdoc` that sits next to `compiler`.\n     fn run(self, builder: &Builder<'_>) {\n+        let host = self.compiler.host;\n+        let _guard = builder.msg(\n+            Kind::Test,\n+            self.compiler.stage,\n+            &format!(\"book {}\", self.name),\n+            host,\n+            host,\n+        );\n         // External docs are different from local because:\n         // - Some books need pre-processing by mdbook before being tested.\n         // - They need to save their state to toolstate.\n@@ -1987,7 +1995,7 @@ fn markdown_test(builder: &Builder<'_>, compiler: Compiler, markdown: &Path) ->\n         }\n     }\n \n-    builder.info(&format!(\"doc tests for: {}\", markdown.display()));\n+    builder.verbose(&format!(\"doc tests for: {}\", markdown.display()));\n     let mut cmd = builder.rustdoc_cmd(compiler);\n     builder.add_rust_test_threads(&mut cmd);\n     // allow for unstable options such as new editions"}]}