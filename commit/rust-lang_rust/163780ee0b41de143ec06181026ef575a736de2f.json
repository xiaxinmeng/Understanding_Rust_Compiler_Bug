{"sha": "163780ee0b41de143ec06181026ef575a736de2f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE2Mzc4MGVlMGI0MWRlMTQzZWMwNjE4MTAyNmVmNTc1YTczNmRlMmY=", "commit": {"author": {"name": "Joel Gallant", "email": "joel@joelgallant.me", "date": "2018-10-04T23:30:45Z"}, "committer": {"name": "Joel Gallant", "email": "joel@joelgallant.me", "date": "2018-10-05T00:49:03Z"}, "message": "Solves #3222 by checking the BareFnTy Abi type", "tree": {"sha": "455edf36f2cca2ad205ca883ac579b4efadfdc6d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/455edf36f2cca2ad205ca883ac579b4efadfdc6d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/163780ee0b41de143ec06181026ef575a736de2f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/163780ee0b41de143ec06181026ef575a736de2f", "html_url": "https://github.com/rust-lang/rust/commit/163780ee0b41de143ec06181026ef575a736de2f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/163780ee0b41de143ec06181026ef575a736de2f/comments", "author": {"login": "joelgallant", "id": 1429994, "node_id": "MDQ6VXNlcjE0Mjk5OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1429994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joelgallant", "html_url": "https://github.com/joelgallant", "followers_url": "https://api.github.com/users/joelgallant/followers", "following_url": "https://api.github.com/users/joelgallant/following{/other_user}", "gists_url": "https://api.github.com/users/joelgallant/gists{/gist_id}", "starred_url": "https://api.github.com/users/joelgallant/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joelgallant/subscriptions", "organizations_url": "https://api.github.com/users/joelgallant/orgs", "repos_url": "https://api.github.com/users/joelgallant/repos", "events_url": "https://api.github.com/users/joelgallant/events{/privacy}", "received_events_url": "https://api.github.com/users/joelgallant/received_events", "type": "User", "site_admin": false}, "committer": {"login": "joelgallant", "id": 1429994, "node_id": "MDQ6VXNlcjE0Mjk5OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1429994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joelgallant", "html_url": "https://github.com/joelgallant", "followers_url": "https://api.github.com/users/joelgallant/followers", "following_url": "https://api.github.com/users/joelgallant/following{/other_user}", "gists_url": "https://api.github.com/users/joelgallant/gists{/gist_id}", "starred_url": "https://api.github.com/users/joelgallant/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joelgallant/subscriptions", "organizations_url": "https://api.github.com/users/joelgallant/orgs", "repos_url": "https://api.github.com/users/joelgallant/repos", "events_url": "https://api.github.com/users/joelgallant/events{/privacy}", "received_events_url": "https://api.github.com/users/joelgallant/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "eb2cfe62b523c34dc2ec5990b0113001c936db7e", "url": "https://api.github.com/repos/rust-lang/rust/commits/eb2cfe62b523c34dc2ec5990b0113001c936db7e", "html_url": "https://github.com/rust-lang/rust/commit/eb2cfe62b523c34dc2ec5990b0113001c936db7e"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "6f024e596107976e5097086567778792d49e22e0", "filename": "clippy_lints/src/types.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/163780ee0b41de143ec06181026ef575a736de2f/clippy_lints%2Fsrc%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/163780ee0b41de143ec06181026ef575a736de2f/clippy_lints%2Fsrc%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Ftypes.rs?ref=163780ee0b41de143ec06181026ef575a736de2f", "patch": "@@ -16,6 +16,7 @@ use std::borrow::Cow;\n use crate::syntax::ast::{FloatTy, IntTy, UintTy};\n use crate::syntax::source_map::Span;\n use crate::syntax::errors::DiagnosticBuilder;\n+use crate::rustc_target::spec::abi::Abi;\n use crate::utils::{comparisons, differing_macro_contexts, higher, in_constant, in_macro, last_path_segment, match_def_path, match_path,\n             match_type, multispan_sugg, opt_def_id, same_tys, snippet, snippet_opt, span_help_and_lint, span_lint,\n             span_lint_and_sugg, span_lint_and_then, clip, unsext, sext, int_bits};\n@@ -1224,7 +1225,7 @@ impl<'tcx> Visitor<'tcx> for TypeComplexityVisitor {\n             TyKind::Path(..) | TyKind::Slice(..) | TyKind::Tup(..) | TyKind::Array(..) => (10 * self.nest, 1),\n \n             // function types bring a lot of overhead\n-            TyKind::BareFn(..) => (50 * self.nest, 1),\n+            TyKind::BareFn(ref bare) if bare.abi == Abi::Rust => (50 * self.nest, 1),\n \n             TyKind::TraitObject(ref param_bounds, _) => {\n                 let has_lifetime_parameters = param_bounds"}, {"sha": "eac2c07c12ea9a4d7fb56bb756f137a50a910ea7", "filename": "tests/ui/complex_types.rs", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/163780ee0b41de143ec06181026ef575a736de2f/tests%2Fui%2Fcomplex_types.rs", "raw_url": "https://github.com/rust-lang/rust/raw/163780ee0b41de143ec06181026ef575a736de2f/tests%2Fui%2Fcomplex_types.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcomplex_types.rs?ref=163780ee0b41de143ec06181026ef575a736de2f", "patch": "@@ -40,5 +40,22 @@ fn test3() {\n     let _y: Vec<Vec<Box<(u32, u32, u32, u32)>>> = vec![];\n }\n \n+#[repr(C)]\n+struct D {\n+    // should not warn, since we don't have control over the signature (#3222)\n+    test4: extern \"C\" fn(\n+        itself: &D,\n+        a: usize,\n+        b: usize,\n+        c: usize,\n+        d: usize,\n+        e: usize,\n+        f: usize,\n+        g: usize,\n+        h: usize,\n+        i: usize,\n+    ),\n+}\n+\n fn main() {\n }"}]}