{"sha": "a263a78b28dd1cef60025b0681689d7b6188d693", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEyNjNhNzhiMjhkZDFjZWY2MDAyNWIwNjgxNjg5ZDdiNjE4OGQ2OTM=", "commit": {"author": {"name": "johnthagen", "email": "johnthagen@gmail.com", "date": "2017-10-09T00:08:11Z"}, "committer": {"name": "johnthagen", "email": "johnthagen@gmail.com", "date": "2017-10-09T00:08:11Z"}, "message": "Fix PEP8 style issues in bootstrap code", "tree": {"sha": "3cea64079377981745486f1f845793fc5086a34b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3cea64079377981745486f1f845793fc5086a34b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a263a78b28dd1cef60025b0681689d7b6188d693", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a263a78b28dd1cef60025b0681689d7b6188d693", "html_url": "https://github.com/rust-lang/rust/commit/a263a78b28dd1cef60025b0681689d7b6188d693", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a263a78b28dd1cef60025b0681689d7b6188d693/comments", "author": {"login": "johnthagen", "id": 10340167, "node_id": "MDQ6VXNlcjEwMzQwMTY3", "avatar_url": "https://avatars.githubusercontent.com/u/10340167?v=4", "gravatar_id": "", "url": "https://api.github.com/users/johnthagen", "html_url": "https://github.com/johnthagen", "followers_url": "https://api.github.com/users/johnthagen/followers", "following_url": "https://api.github.com/users/johnthagen/following{/other_user}", "gists_url": "https://api.github.com/users/johnthagen/gists{/gist_id}", "starred_url": "https://api.github.com/users/johnthagen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/johnthagen/subscriptions", "organizations_url": "https://api.github.com/users/johnthagen/orgs", "repos_url": "https://api.github.com/users/johnthagen/repos", "events_url": "https://api.github.com/users/johnthagen/events{/privacy}", "received_events_url": "https://api.github.com/users/johnthagen/received_events", "type": "User", "site_admin": false}, "committer": {"login": "johnthagen", "id": 10340167, "node_id": "MDQ6VXNlcjEwMzQwMTY3", "avatar_url": "https://avatars.githubusercontent.com/u/10340167?v=4", "gravatar_id": "", "url": "https://api.github.com/users/johnthagen", "html_url": "https://github.com/johnthagen", "followers_url": "https://api.github.com/users/johnthagen/followers", "following_url": "https://api.github.com/users/johnthagen/following{/other_user}", "gists_url": "https://api.github.com/users/johnthagen/gists{/gist_id}", "starred_url": "https://api.github.com/users/johnthagen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/johnthagen/subscriptions", "organizations_url": "https://api.github.com/users/johnthagen/orgs", "repos_url": "https://api.github.com/users/johnthagen/repos", "events_url": "https://api.github.com/users/johnthagen/events{/privacy}", "received_events_url": "https://api.github.com/users/johnthagen/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "650b1b1f3a41aa747da37dea3b32108b08146075", "url": "https://api.github.com/repos/rust-lang/rust/commits/650b1b1f3a41aa747da37dea3b32108b08146075", "html_url": "https://github.com/rust-lang/rust/commit/650b1b1f3a41aa747da37dea3b32108b08146075"}], "stats": {"total": 49, "additions": 32, "deletions": 17}, "files": [{"sha": "918314804ccfcdd82258b120f81292f46f2027b8", "filename": "src/bootstrap/bootstrap.py", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/a263a78b28dd1cef60025b0681689d7b6188d693/src%2Fbootstrap%2Fbootstrap.py", "raw_url": "https://github.com/rust-lang/rust/raw/a263a78b28dd1cef60025b0681689d7b6188d693/src%2Fbootstrap%2Fbootstrap.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbootstrap.py?ref=a263a78b28dd1cef60025b0681689d7b6188d693", "patch": "@@ -302,6 +302,7 @@ def default_build_triple():\n \n     return \"{}-{}\".format(cputype, ostype)\n \n+\n class RustBuild(object):\n     \"\"\"Provide all the methods required to build Rust\"\"\"\n     def __init__(self):"}, {"sha": "6b9356dec56b7226269cfbf3932091d31255c469", "filename": "src/bootstrap/configure.py", "status": "modified", "additions": 31, "deletions": 17, "changes": 48, "blob_url": "https://github.com/rust-lang/rust/blob/a263a78b28dd1cef60025b0681689d7b6188d693/src%2Fbootstrap%2Fconfigure.py", "raw_url": "https://github.com/rust-lang/rust/raw/a263a78b28dd1cef60025b0681689d7b6188d693/src%2Fbootstrap%2Fconfigure.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfigure.py?ref=a263a78b28dd1cef60025b0681689d7b6188d693", "patch": "@@ -19,21 +19,26 @@\n sys.path.append(os.path.join(rust_dir, \"src\", \"bootstrap\"))\n import bootstrap\n \n+\n class Option:\n     def __init__(self, name, rustbuild, desc, value):\n         self.name = name\n         self.rustbuild = rustbuild\n         self.desc = desc\n         self.value = value\n \n+\n options = []\n \n+\n def o(*args):\n     options.append(Option(*args, value=False))\n \n+\n def v(*args):\n     options.append(Option(*args, value=True))\n \n+\n o(\"debug\", \"rust.debug\", \"debug mode; disables optimization unless `--enable-optimize` given\")\n o(\"docs\", \"build.docs\", \"build standard library documentation\")\n o(\"compiler-docs\", \"build.compiler-docs\", \"build compiler documentation\")\n@@ -136,13 +141,16 @@ def v(*args):\n \n v(\"set\", None, \"set arbitrary key/value pairs in TOML configuration\")\n \n+\n def p(msg):\n     print(\"configure: \" + msg)\n \n+\n def err(msg):\n     print(\"configure: error: \" + msg)\n     sys.exit(1)\n \n+\n if '--help' in sys.argv or '-h' in sys.argv:\n     print('Usage: ./configure [options]')\n     print('')\n@@ -208,7 +216,7 @@ def err(msg):\n                 continue\n \n         found = True\n-        if not option.name in known_args:\n+        if option.name not in known_args:\n             known_args[option.name] = []\n         known_args[option.name].append((option, value))\n         break\n@@ -227,27 +235,30 @@ def err(msg):\n # TOML we're going to write out\n config = {}\n \n+\n def build():\n     if 'build' in known_args:\n         return known_args['build'][0][1]\n     return bootstrap.default_build_triple()\n \n+\n def set(key, value):\n-      s = \"{:20} := {}\".format(key, value)\n-      if len(s) < 70:\n-          p(s)\n-      else:\n-          p(s[:70] + \" ...\")\n-\n-      arr = config\n-      parts = key.split('.')\n-      for i, part in enumerate(parts):\n-          if i == len(parts) - 1:\n-              arr[part] = value\n-          else:\n-              if not part in arr:\n-                  arr[part] = {}\n-              arr = arr[part]\n+    s = \"{:20} := {}\".format(key, value)\n+    if len(s) < 70:\n+        p(s)\n+    else:\n+        p(s[:70] + \" ...\")\n+\n+    arr = config\n+    parts = key.split('.')\n+    for i, part in enumerate(parts):\n+        if i == len(parts) - 1:\n+            arr[part] = value\n+        else:\n+            if part not in arr:\n+                arr[part] = {}\n+            arr = arr[part]\n+\n \n for key in known_args:\n     # The `set` option is special and can be passed a bunch of times\n@@ -345,6 +356,7 @@ def set(key, value):\n     targets[target] = sections['target'][:]\n     targets[target][0] = targets[target][0].replace(\"x86_64-unknown-linux-gnu\", target)\n \n+\n # Here we walk through the constructed configuration we have from the parsed\n # command line arguemnts. We then apply each piece of configuration by\n # basically just doing a `sed` to change the various configuration line to what\n@@ -362,6 +374,7 @@ def to_toml(value):\n     else:\n         raise 'no toml'\n \n+\n def configure_section(lines, config):\n     for key in config:\n         value = config[key]\n@@ -375,9 +388,10 @@ def configure_section(lines, config):\n         if not found:\n             raise RuntimeError(\"failed to find config line for {}\".format(key))\n \n+\n for section_key in config:\n     section_config = config[section_key]\n-    if not section_key in sections:\n+    if section_key not in sections:\n         raise RuntimeError(\"config key {} not in sections\".format(key))\n \n     if section_key == 'target':"}]}