{"sha": "cbb967f3169181f2afdd4bdcd3af4ff448008b2c", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNiYjk2N2YzMTY5MTgxZjJhZmRkNGJkY2QzYWY0ZmY0NDgwMDhiMmM=", "commit": {"author": {"name": "Jorge Aparicio", "email": "japaricious@gmail.com", "date": "2016-09-28T02:26:08Z"}, "committer": {"name": "Jorge Aparicio", "email": "japaricious@gmail.com", "date": "2016-09-28T02:26:08Z"}, "message": "add a panic-strategy field to the target specification\n\nNow a target can define its panic strategy in its specification. If a\nuser doesn't specify a panic strategy via the command line, i.e. '-C\npanic', then the compiler will use the panic strategy defined by the\ntarget specification.\n\nCustom targets can pick their panic strategy via the \"panic-strategy\"\nfield of their target specification JSON file. If omitted in the\nspecification, the strategy defaults to \"unwind\".\n\ncloses #36647", "tree": {"sha": "4571dac026513a36b9f0f8f8f096eb684634c363", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4571dac026513a36b9f0f8f8f096eb684634c363"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cbb967f3169181f2afdd4bdcd3af4ff448008b2c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cbb967f3169181f2afdd4bdcd3af4ff448008b2c", "html_url": "https://github.com/rust-lang/rust/commit/cbb967f3169181f2afdd4bdcd3af4ff448008b2c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/comments", "author": null, "committer": null, "parents": [{"sha": "49dd95b07807a26f94bf11eb4771bbb7d79ef02c", "url": "https://api.github.com/repos/rust-lang/rust/commits/49dd95b07807a26f94bf11eb4771bbb7d79ef02c", "html_url": "https://github.com/rust-lang/rust/commit/49dd95b07807a26f94bf11eb4771bbb7d79ef02c"}], "stats": {"total": 118, "additions": 82, "deletions": 36}, "files": [{"sha": "d4a69627109fbca5643a0856b8042e9740786593", "filename": "src/librustc/middle/cstore.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc%2Fmiddle%2Fcstore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc%2Fmiddle%2Fcstore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fcstore.rs?ref=cbb967f3169181f2afdd4bdcd3af4ff448008b2c", "patch": "@@ -32,7 +32,6 @@ use ty::{self, Ty, TyCtxt};\n use mir::repr::Mir;\n use mir::mir_map::MirMap;\n use session::Session;\n-use session::config::PanicStrategy;\n use session::search_paths::PathKind;\n use util::nodemap::{NodeSet, DefIdMap};\n use std::path::PathBuf;\n@@ -45,6 +44,7 @@ use syntax_pos::Span;\n use rustc_back::target::Target;\n use hir;\n use hir::intravisit::Visitor;\n+use rustc_back::PanicStrategy;\n \n pub use self::NativeLibraryKind::{NativeStatic, NativeFramework, NativeUnknown};\n "}, {"sha": "159b7256c7a27a92f369419f1df37f71dcc04c7d", "filename": "src/librustc/middle/dependency_format.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc%2Fmiddle%2Fdependency_format.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc%2Fmiddle%2Fdependency_format.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fdependency_format.rs?ref=cbb967f3169181f2afdd4bdcd3af4ff448008b2c", "patch": "@@ -64,9 +64,10 @@\n use hir::def_id::CrateNum;\n \n use session;\n-use session::config::{self, PanicStrategy};\n+use session::config;\n use middle::cstore::LinkagePreference::{self, RequireStatic, RequireDynamic};\n use util::nodemap::FnvHashMap;\n+use rustc_back::PanicStrategy;\n \n /// A list of dependencies for a certain crate type.\n ///\n@@ -357,7 +358,7 @@ fn verify_ok(sess: &session::Session, list: &[Linkage]) {\n     // only one, but we perform validation here that all the panic strategy\n     // compilation modes for the whole DAG are valid.\n     if let Some((cnum, found_strategy)) = panic_runtime {\n-        let desired_strategy = sess.opts.cg.panic.clone();\n+        let desired_strategy = sess.panic_strategy();\n \n         // First up, validate that our selected panic runtime is indeed exactly\n         // our same strategy."}, {"sha": "aa75c7a572bc5ba322f9d3d6219cfc438879f0d8", "filename": "src/librustc/middle/weak_lang_items.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc%2Fmiddle%2Fweak_lang_items.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc%2Fmiddle%2Fweak_lang_items.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Fweak_lang_items.rs?ref=cbb967f3169181f2afdd4bdcd3af4ff448008b2c", "patch": "@@ -10,10 +10,11 @@\n \n //! Validity checking for weak lang items\n \n-use session::config::{self, PanicStrategy};\n+use session::config;\n use session::Session;\n use middle::lang_items;\n \n+use rustc_back::PanicStrategy;\n use syntax::ast;\n use syntax::parse::token::InternedString;\n use syntax_pos::Span;\n@@ -92,7 +93,7 @@ fn verify(sess: &Session, items: &lang_items::LanguageItems) {\n     // symbols. Other panic runtimes ensure that the relevant symbols are\n     // available to link things together, but they're never exercised.\n     let mut whitelisted = HashSet::new();\n-    if sess.opts.cg.panic != PanicStrategy::Unwind {\n+    if sess.panic_strategy() != PanicStrategy::Unwind {\n         whitelisted.insert(lang_items::EhPersonalityLangItem);\n         whitelisted.insert(lang_items::EhUnwindResumeLangItem);\n     }"}, {"sha": "d4fa0f7d1f080356fedcf99cc302ac1bcc353381", "filename": "src/librustc/session/config.rs", "status": "modified", "additions": 12, "deletions": 22, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc%2Fsession%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc%2Fsession%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fsession%2Fconfig.rs?ref=cbb967f3169181f2afdd4bdcd3af4ff448008b2c", "patch": "@@ -19,6 +19,7 @@ pub use self::DebugInfoLevel::*;\n use session::{early_error, early_warn, Session};\n use session::search_paths::SearchPaths;\n \n+use rustc_back::PanicStrategy;\n use rustc_back::target::Target;\n use lint;\n use middle::cstore;\n@@ -493,21 +494,6 @@ impl Passes {\n     }\n }\n \n-#[derive(Clone, PartialEq, Hash, RustcEncodable, RustcDecodable)]\n-pub enum PanicStrategy {\n-    Unwind,\n-    Abort,\n-}\n-\n-impl PanicStrategy {\n-    pub fn desc(&self) -> &str {\n-        match *self {\n-            PanicStrategy::Unwind => \"unwind\",\n-            PanicStrategy::Abort => \"abort\",\n-        }\n-    }\n-}\n-\n /// Declare a macro that will define all CodegenOptions/DebuggingOptions fields and parsers all\n /// at once. The goal of this macro is to define an interface that can be\n /// programmatically used by the option parser in order to initialize the struct\n@@ -620,7 +606,8 @@ macro_rules! options {\n \n     #[allow(dead_code)]\n     mod $mod_set {\n-        use super::{$struct_name, Passes, SomePasses, AllPasses, PanicStrategy};\n+        use super::{$struct_name, Passes, SomePasses, AllPasses};\n+        use rustc_back::PanicStrategy;\n \n         $(\n             pub fn $opt(cg: &mut $struct_name, v: Option<&str>) -> bool {\n@@ -725,10 +712,10 @@ macro_rules! options {\n             }\n         }\n \n-        fn parse_panic_strategy(slot: &mut PanicStrategy, v: Option<&str>) -> bool {\n+        fn parse_panic_strategy(slot: &mut Option<PanicStrategy>, v: Option<&str>) -> bool {\n             match v {\n-                Some(\"unwind\") => *slot = PanicStrategy::Unwind,\n-                Some(\"abort\") => *slot = PanicStrategy::Abort,\n+                Some(\"unwind\") => *slot = Some(PanicStrategy::Unwind),\n+                Some(\"abort\") => *slot = Some(PanicStrategy::Abort),\n                 _ => return false\n             }\n             true\n@@ -800,7 +787,7 @@ options! {CodegenOptions, CodegenSetter, basic_codegen_options,\n         \"explicitly enable the cfg(debug_assertions) directive\"),\n     inline_threshold: Option<usize> = (None, parse_opt_uint, [TRACKED],\n         \"set the inlining threshold for\"),\n-    panic: PanicStrategy = (PanicStrategy::Unwind, parse_panic_strategy,\n+    panic: Option<PanicStrategy> = (None, parse_panic_strategy,\n         [TRACKED], \"panic strategy to compile crate with\"),\n }\n \n@@ -1676,9 +1663,10 @@ mod dep_tracking {\n     use std::collections::BTreeMap;\n     use std::hash::{Hash, SipHasher};\n     use std::path::PathBuf;\n-    use super::{Passes, PanicStrategy, CrateType, OptLevel, DebugInfoLevel,\n+    use super::{Passes, CrateType, OptLevel, DebugInfoLevel,\n                 OutputTypes, Externs, ErrorOutputType};\n     use syntax::feature_gate::UnstableFeatures;\n+    use rustc_back::PanicStrategy;\n \n     pub trait DepTrackingHash {\n         fn hash(&self, &mut SipHasher, ErrorOutputType);\n@@ -1717,6 +1705,7 @@ mod dep_tracking {\n     impl_dep_tracking_hash_via_hash!(Option<bool>);\n     impl_dep_tracking_hash_via_hash!(Option<usize>);\n     impl_dep_tracking_hash_via_hash!(Option<String>);\n+    impl_dep_tracking_hash_via_hash!(Option<PanicStrategy>);\n     impl_dep_tracking_hash_via_hash!(Option<lint::Level>);\n     impl_dep_tracking_hash_via_hash!(Option<PathBuf>);\n     impl_dep_tracking_hash_via_hash!(CrateType);\n@@ -1783,7 +1772,8 @@ mod tests {\n     use std::iter::FromIterator;\n     use std::path::PathBuf;\n     use std::rc::Rc;\n-    use super::{OutputType, OutputTypes, Externs, PanicStrategy};\n+    use super::{OutputType, OutputTypes, Externs};\n+    use rustc_back::PanicStrategy;\n     use syntax::{ast, attr};\n     use syntax::parse::token::InternedString;\n     use syntax::codemap::dummy_spanned;"}, {"sha": "f048da49777651acf570e1c43316b60d9a9591f5", "filename": "src/librustc/session/mod.rs", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc%2Fsession%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc%2Fsession%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fsession%2Fmod.rs?ref=cbb967f3169181f2afdd4bdcd3af4ff448008b2c", "patch": "@@ -15,7 +15,7 @@ use lint;\n use middle::cstore::CrateStore;\n use middle::dependency_format;\n use session::search_paths::PathKind;\n-use session::config::{DebugInfoLevel, PanicStrategy};\n+use session::config::DebugInfoLevel;\n use ty::tls;\n use util::nodemap::{NodeMap, FnvHashMap};\n use util::common::duration_to_secs_str;\n@@ -33,6 +33,7 @@ use syntax::{ast, codemap};\n use syntax::feature_gate::AttributeType;\n use syntax_pos::{Span, MultiSpan};\n \n+use rustc_back::PanicStrategy;\n use rustc_back::target::Target;\n use rustc_data_structures::flock;\n use llvm;\n@@ -306,9 +307,13 @@ impl Session {\n     pub fn lto(&self) -> bool {\n         self.opts.cg.lto\n     }\n+    /// Returns the panic strategy for this compile session. If the user explicitly selected one\n+    /// using '-C panic', use that, otherwise use the panic strategy defined by the target.\n+    pub fn panic_strategy(&self) -> PanicStrategy {\n+        self.opts.cg.panic.unwrap_or(self.target.target.options.panic_strategy)\n+    }\n     pub fn no_landing_pads(&self) -> bool {\n-        self.opts.debugging_opts.no_landing_pads ||\n-            self.opts.cg.panic == PanicStrategy::Abort\n+        self.opts.debugging_opts.no_landing_pads || self.panic_strategy() == PanicStrategy::Abort\n     }\n     pub fn unstable_options(&self) -> bool {\n         self.opts.debugging_opts.unstable_options"}, {"sha": "c0f358ca8017bd884c3bfa53a892ee58a2e67a95", "filename": "src/librustc_back/lib.rs", "status": "modified", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc_back%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc_back%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Flib.rs?ref=cbb967f3169181f2afdd4bdcd3af4ff448008b2c", "patch": "@@ -45,8 +45,36 @@ extern crate libc;\n extern crate serialize;\n #[macro_use] extern crate log;\n \n+extern crate serialize as rustc_serialize; // used by deriving\n+\n pub mod tempdir;\n pub mod sha2;\n pub mod target;\n pub mod slice;\n pub mod dynamic_lib;\n+\n+use serialize::json::{Json, ToJson};\n+\n+#[derive(Clone, Copy, Debug, PartialEq, Hash, RustcEncodable, RustcDecodable)]\n+pub enum PanicStrategy {\n+    Unwind,\n+    Abort,\n+}\n+\n+impl PanicStrategy {\n+    pub fn desc(&self) -> &str {\n+        match *self {\n+            PanicStrategy::Unwind => \"unwind\",\n+            PanicStrategy::Abort => \"abort\",\n+        }\n+    }\n+}\n+\n+impl ToJson for PanicStrategy {\n+    fn to_json(&self) -> Json {\n+        match *self {\n+            PanicStrategy::Abort => \"abort\".to_json(),\n+            PanicStrategy::Unwind => \"unwind\".to_json(),\n+        }\n+    }\n+}"}, {"sha": "f085023de0f5c55ec7c63edc46421745e01d44ea", "filename": "src/librustc_back/target/mod.rs", "status": "modified", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc_back%2Ftarget%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc_back%2Ftarget%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fmod.rs?ref=cbb967f3169181f2afdd4bdcd3af4ff448008b2c", "patch": "@@ -50,6 +50,8 @@ use std::default::Default;\n use std::io::prelude::*;\n use syntax::abi::Abi;\n \n+use PanicStrategy;\n+\n mod android_base;\n mod apple_base;\n mod apple_ios_base;\n@@ -343,6 +345,9 @@ pub struct TargetOptions {\n     /// Maximum integer size in bits that this target can perform atomic\n     /// operations on.\n     pub max_atomic_width: u64,\n+\n+    /// Panic strategy: \"unwind\" or \"abort\"\n+    pub panic_strategy: PanicStrategy,\n }\n \n impl Default for TargetOptions {\n@@ -392,6 +397,7 @@ impl Default for TargetOptions {\n             has_elf_tls: false,\n             obj_is_bitcode: false,\n             max_atomic_width: 0,\n+            panic_strategy: PanicStrategy::Unwind,\n         }\n     }\n }\n@@ -470,6 +476,19 @@ impl Target {\n                     .map(|o| o.as_u64()\n                          .map(|s| base.options.$key_name = s));\n             } );\n+            ($key_name:ident, PanicStrategy) => ( {\n+                let name = (stringify!($key_name)).replace(\"_\", \"-\");\n+                obj.find(&name[..]).and_then(|o| o.as_string().and_then(|s| {\n+                    match s {\n+                        \"unwind\" => base.options.$key_name = PanicStrategy::Unwind,\n+                        \"abort\" => base.options.$key_name = PanicStrategy::Abort,\n+                        _ => return Some(Err(format!(\"'{}' is not a valid value for \\\n+                                                      panic-strategy. Use 'unwind' or 'abort'.\",\n+                                                     s))),\n+                }\n+                Some(Ok(()))\n+            })).unwrap_or(Ok(()))\n+            } );\n             ($key_name:ident, list) => ( {\n                 let name = (stringify!($key_name)).replace(\"_\", \"-\");\n                 obj.find(&name[..]).map(|o| o.as_array()\n@@ -530,6 +549,7 @@ impl Target {\n         key!(has_elf_tls, bool);\n         key!(obj_is_bitcode, bool);\n         key!(max_atomic_width, u64);\n+        try!(key!(panic_strategy, PanicStrategy));\n \n         Ok(base)\n     }\n@@ -672,6 +692,7 @@ impl ToJson for Target {\n         target_option_val!(has_elf_tls);\n         target_option_val!(obj_is_bitcode);\n         target_option_val!(max_atomic_width);\n+        target_option_val!(panic_strategy);\n \n         Json::Object(d)\n     }"}, {"sha": "be908ff9d19d90e1fa7c84a7e76dd6ad0facf325", "filename": "src/librustc_metadata/creader.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc_metadata%2Fcreader.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc_metadata%2Fcreader.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Fcreader.rs?ref=cbb967f3169181f2afdd4bdcd3af4ff448008b2c", "patch": "@@ -18,7 +18,7 @@ use schema::CrateRoot;\n use rustc::hir::def_id::{CrateNum, DefIndex};\n use rustc::hir::svh::Svh;\n use rustc::session::{config, Session};\n-use rustc::session::config::PanicStrategy;\n+use rustc_back::PanicStrategy;\n use rustc::session::search_paths::PathKind;\n use rustc::middle;\n use rustc::middle::cstore::{CrateStore, validate_crate_name, ExternCrate};\n@@ -710,7 +710,7 @@ impl<'a> CrateReader<'a> {\n         // The logic for finding the panic runtime here is pretty much the same\n         // as the allocator case with the only addition that the panic strategy\n         // compilation mode also comes into play.\n-        let desired_strategy = self.sess.opts.cg.panic.clone();\n+        let desired_strategy = self.sess.panic_strategy();\n         let mut runtime_found = false;\n         let mut needs_panic_runtime = attr::contains_name(&krate.attrs,\n                                                           \"needs_panic_runtime\");"}, {"sha": "16a5b5402fbe30fc431939cf614f5774dcf32bc1", "filename": "src/librustc_metadata/csearch.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc_metadata%2Fcsearch.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc_metadata%2Fcsearch.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Fcsearch.rs?ref=cbb967f3169181f2afdd4bdcd3af4ff448008b2c", "patch": "@@ -26,7 +26,7 @@ use rustc::hir::map::DefKey;\n use rustc::mir::repr::Mir;\n use rustc::mir::mir_map::MirMap;\n use rustc::util::nodemap::{NodeSet, DefIdMap};\n-use rustc::session::config::PanicStrategy;\n+use rustc_back::PanicStrategy;\n \n use std::path::PathBuf;\n use syntax::ast;"}, {"sha": "038d0f73d5ce8fd579b6b001e48d8387d00ef14e", "filename": "src/librustc_metadata/cstore.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc_metadata%2Fcstore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc_metadata%2Fcstore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Fcstore.rs?ref=cbb967f3169181f2afdd4bdcd3af4ff448008b2c", "patch": "@@ -19,7 +19,7 @@ use rustc::hir::def_id::{CRATE_DEF_INDEX, CrateNum, DefIndex, DefId};\n use rustc::hir::map::DefKey;\n use rustc::hir::svh::Svh;\n use rustc::middle::cstore::ExternCrate;\n-use rustc::session::config::PanicStrategy;\n+use rustc_back::PanicStrategy;\n use rustc_data_structures::indexed_vec::IndexVec;\n use rustc::util::nodemap::{FnvHashMap, NodeMap, NodeSet, DefIdMap, FnvHashSet};\n "}, {"sha": "ca4fb77d95ad62dd8941a2641096df7747185e2d", "filename": "src/librustc_metadata/encoder.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc_metadata%2Fencoder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc_metadata%2Fencoder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Fencoder.rs?ref=cbb967f3169181f2afdd4bdcd3af4ff448008b2c", "patch": "@@ -1293,7 +1293,7 @@ impl<'a, 'tcx> EncodeContext<'a, 'tcx> {\n             triple: tcx.sess.opts.target_triple.clone(),\n             hash: link_meta.crate_hash,\n             disambiguator: tcx.sess.local_crate_disambiguator().to_string(),\n-            panic_strategy: tcx.sess.opts.cg.panic.clone(),\n+            panic_strategy: tcx.sess.panic_strategy(),\n             plugin_registrar_fn: tcx.sess.plugin_registrar_fn.get().map(|id| {\n                 tcx.map.local_def_id(id).index\n             }),"}, {"sha": "58e18bc709e3c41a5dd2cfdb1be6d7227fcbc202", "filename": "src/librustc_metadata/schema.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc_metadata%2Fschema.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cbb967f3169181f2afdd4bdcd3af4ff448008b2c/src%2Flibrustc_metadata%2Fschema.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2Fschema.rs?ref=cbb967f3169181f2afdd4bdcd3af4ff448008b2c", "patch": "@@ -18,7 +18,7 @@ use rustc::middle::cstore::{LinkagePreference, NativeLibraryKind};\n use rustc::middle::lang_items;\n use rustc::mir;\n use rustc::ty::{self, Ty};\n-use rustc::session::config::PanicStrategy;\n+use rustc_back::PanicStrategy;\n \n use rustc_serialize as serialize;\n use syntax::{ast, attr};"}]}