{"sha": "d04ed0c4931f36f15e18f46b233d13572f4c9107", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQwNGVkMGM0OTMxZjM2ZjE1ZTE4ZjQ2YjIzM2QxMzU3MmY0YzkxMDc=", "commit": {"author": {"name": "Michael Sullivan", "email": "sully@msully.net", "date": "2012-06-12T17:29:17Z"}, "committer": {"name": "Michael Sullivan", "email": "sully@msully.net", "date": "2012-06-12T17:58:00Z"}, "message": "Reorder things in hash_type_structure to make more sense.", "tree": {"sha": "b8b9348acc59547e3d556c669eb94fa8a1ecd833", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b8b9348acc59547e3d556c669eb94fa8a1ecd833"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d04ed0c4931f36f15e18f46b233d13572f4c9107", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d04ed0c4931f36f15e18f46b233d13572f4c9107", "html_url": "https://github.com/rust-lang/rust/commit/d04ed0c4931f36f15e18f46b233d13572f4c9107", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d04ed0c4931f36f15e18f46b233d13572f4c9107/comments", "author": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "committer": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "07bba397c5b46c96cfb8de23c34b9bae47e07947", "url": "https://api.github.com/repos/rust-lang/rust/commits/07bba397c5b46c96cfb8de23c34b9bae47e07947", "html_url": "https://github.com/rust-lang/rust/commit/07bba397c5b46c96cfb8de23c34b9bae47e07947"}], "stats": {"total": 20, "additions": 10, "deletions": 10}, "files": [{"sha": "ca88ea927e2fb4060a152379b58f0971cee1418c", "filename": "src/rustc/middle/ty.rs", "status": "modified", "additions": 10, "deletions": 10, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/d04ed0c4931f36f15e18f46b233d13572f4c9107/src%2Frustc%2Fmiddle%2Fty.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d04ed0c4931f36f15e18f46b233d13572f4c9107/src%2Frustc%2Fmiddle%2Fty.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustc%2Fmiddle%2Fty.rs?ref=d04ed0c4931f36f15e18f46b233d13572f4c9107", "patch": "@@ -2052,38 +2052,34 @@ fn hash_type_structure(st: sty) -> uint {\n       ty_box(mt) { hash_subty(19u, mt.ty) }\n       ty_evec(mt, _) { hash_subty(20u, mt.ty) }\n       ty_vec(mt) { hash_subty(21u, mt.ty) }\n+      ty_tup(ts) { hash_subtys(25u, ts) }\n       ty_rec(fields) {\n         let mut h = 26u;\n         for fields.each {|f| h = hash_subty(h, f.mt.ty); }\n         h\n       }\n-      ty_tup(ts) { hash_subtys(25u, ts) }\n       ty_fn(f) {\n         let mut h = 27u;\n         for f.inputs.each {|a| h = hash_subty(h, a.ty); }\n         hash_subty(h, f.output)\n       }\n+      ty_self { 28u }\n       ty_var(v) { hash_uint(29u, v.to_uint()) }\n       ty_var_integral(v) { hash_uint(30u, v.to_uint()) }\n       ty_param(pid, did) { hash_def(hash_uint(31u, pid), did) }\n-      ty_self { 28u }\n       ty_type { 32u }\n       ty_bot { 34u }\n       ty_ptr(mt) { hash_subty(35u, mt.ty) }\n-      ty_rptr(region, mt) {\n-        let mut h = (46u << 2u) + hash_region(region);\n-        hash_subty(h, mt.ty)\n-      }\n-      ty_res(did, sub, substs) {\n-        let mut h = hash_subty(hash_def(18u, did), sub);\n-        hash_substs(h, substs)\n-      }\n       ty_constr(t, cs) {\n         let mut h = hash_subty(36u, t);\n         for cs.each {|c| h = (h << 2u) + hash_type_constr(h, c); }\n         h\n       }\n       ty_uniq(mt) { hash_subty(37u, mt.ty) }\n+      ty_res(did, sub, substs) {\n+        let mut h = hash_subty(hash_def(38u, did), sub);\n+        hash_substs(h, substs)\n+      }\n       ty_iface(did, substs) {\n         let mut h = hash_def(40u, did);\n         hash_substs(h, substs)\n@@ -2096,6 +2092,10 @@ fn hash_type_structure(st: sty) -> uint {\n         let mut h = hash_def(45u, did);\n         hash_substs(h, substs)\n       }\n+      ty_rptr(region, mt) {\n+        let mut h = (46u << 2u) + hash_region(region);\n+        hash_subty(h, mt.ty)\n+      }\n     }\n }\n "}]}