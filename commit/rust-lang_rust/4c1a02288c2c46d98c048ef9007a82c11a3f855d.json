{"sha": "4c1a02288c2c46d98c048ef9007a82c11a3f855d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRjMWEwMjI4OGMyYzQ2ZDk4YzA0OGVmOTAwN2E4MmMxMWEzZjg1NWQ=", "commit": {"author": {"name": "Maan2003", "email": "manmeetmann2003@gmail.com", "date": "2021-06-11T13:40:56Z"}, "committer": {"name": "Maan2003", "email": "manmeetmann2003@gmail.com", "date": "2021-06-11T13:40:56Z"}, "message": "change visibility for use and macro items", "tree": {"sha": "136d4680273d34f96bd0d8c7e674aa2557d7dc8f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/136d4680273d34f96bd0d8c7e674aa2557d7dc8f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4c1a02288c2c46d98c048ef9007a82c11a3f855d", "comment_count": 0, "verification": {"verified": false, "reason": "unknown_key", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEVt0Hfgx04mDvJfYh6a8CS6Y8cO0FAmDDaAAACgkQ6a8CS6Y8\ncO167A/9HmaRPf4Bs+z7M71qFaSioA9oE9jGQVofPlAaXx8bm/W3MkqeUrwWjR/6\nXR71Uuv78T0zfw+j6iPDAC3R4sMy4BUefLObX7DZm/2UDd/TLVkYqlJ4Xkm92ZMp\nwWwy0767JzjWTnKE7yW6vQVeB4tLwqpLELffyecvnpX0Iy6+eaoj8C1EOwCUdghi\nMSrgWPBEwrFhBVTAaAgVxAAIyH6dhQ1ibS5pPnwU7itIh84PVybe7QKg6heZvbtD\nVA7/fccCwJRk2KtSrB9n5lmfp/JZdHVNjsjR2MoyZEEo7bA8qJdNTkyge/cB8PYB\nMzhZPBNRCJ20HU2OFq7OsZVJCUEc7TixXVWHaFHj6uifkp3UzfGPNnRfUhMuugTB\n/X1hE0EDEvosmIBOH9eoNCIL9ZmOEQKHkVqeDS7JKbfCX5NlQTrqoEParGLiqWcH\nt5eacopFCnnlcNq6uQKVEsq13E56dGuHS4U3s0+lDdT3xeyuPHzTvoNiGd4dhbgc\nvQ7Q0TSA2lGvIww/QU2sSfdQvBiRBZ+vL1AD3ndTDMueJ4mfx/Qb7Ob5z/5eGYZt\nvgRHHzWBKKaUWJYcfv0saBsO9yFKw6QDoFgToNHUJw2ekWyUyWSsQ1XX2bBJW/20\nG31MzRE48q2iOiqWqJ5wlx9ty/RDlhOjThsO++qGlsDR+4VONhs=\n=4eoV\n-----END PGP SIGNATURE-----", "payload": "tree 136d4680273d34f96bd0d8c7e674aa2557d7dc8f\nparent c62ec3d9986d45224d4c64ba9b7b22c1d1d0afb2\nauthor Maan2003 <manmeetmann2003@gmail.com> 1623418856 +0530\ncommitter Maan2003 <manmeetmann2003@gmail.com> 1623418856 +0530\n\nchange visibility for use and macro items\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4c1a02288c2c46d98c048ef9007a82c11a3f855d", "html_url": "https://github.com/rust-lang/rust/commit/4c1a02288c2c46d98c048ef9007a82c11a3f855d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4c1a02288c2c46d98c048ef9007a82c11a3f855d/comments", "author": {"login": "Maan2003", "id": 49202620, "node_id": "MDQ6VXNlcjQ5MjAyNjIw", "avatar_url": "https://avatars.githubusercontent.com/u/49202620?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Maan2003", "html_url": "https://github.com/Maan2003", "followers_url": "https://api.github.com/users/Maan2003/followers", "following_url": "https://api.github.com/users/Maan2003/following{/other_user}", "gists_url": "https://api.github.com/users/Maan2003/gists{/gist_id}", "starred_url": "https://api.github.com/users/Maan2003/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Maan2003/subscriptions", "organizations_url": "https://api.github.com/users/Maan2003/orgs", "repos_url": "https://api.github.com/users/Maan2003/repos", "events_url": "https://api.github.com/users/Maan2003/events{/privacy}", "received_events_url": "https://api.github.com/users/Maan2003/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Maan2003", "id": 49202620, "node_id": "MDQ6VXNlcjQ5MjAyNjIw", "avatar_url": "https://avatars.githubusercontent.com/u/49202620?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Maan2003", "html_url": "https://github.com/Maan2003", "followers_url": "https://api.github.com/users/Maan2003/followers", "following_url": "https://api.github.com/users/Maan2003/following{/other_user}", "gists_url": "https://api.github.com/users/Maan2003/gists{/gist_id}", "starred_url": "https://api.github.com/users/Maan2003/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Maan2003/subscriptions", "organizations_url": "https://api.github.com/users/Maan2003/orgs", "repos_url": "https://api.github.com/users/Maan2003/repos", "events_url": "https://api.github.com/users/Maan2003/events{/privacy}", "received_events_url": "https://api.github.com/users/Maan2003/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c62ec3d9986d45224d4c64ba9b7b22c1d1d0afb2", "url": "https://api.github.com/repos/rust-lang/rust/commits/c62ec3d9986d45224d4c64ba9b7b22c1d1d0afb2", "html_url": "https://github.com/rust-lang/rust/commit/c62ec3d9986d45224d4c64ba9b7b22c1d1d0afb2"}], "stats": {"total": 11, "additions": 9, "deletions": 2}, "files": [{"sha": "ed936667f8c07bb6566f0ba94325b94bb746eb03", "filename": "crates/ide_assists/src/handlers/change_visibility.rs", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/4c1a02288c2c46d98c048ef9007a82c11a3f855d/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fchange_visibility.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4c1a02288c2c46d98c048ef9007a82c11a3f855d/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fchange_visibility.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_assists%2Fsrc%2Fhandlers%2Fchange_visibility.rs?ref=4c1a02288c2c46d98c048ef9007a82c11a3f855d", "patch": "@@ -1,7 +1,9 @@\n use syntax::{\n     ast::{self, NameOwner, VisibilityOwner},\n     AstNode,\n-    SyntaxKind::{CONST, ENUM, FN, MODULE, STATIC, STRUCT, TRAIT, TYPE_ALIAS, VISIBILITY},\n+    SyntaxKind::{\n+        CONST, ENUM, FN, MACRO_DEF, MODULE, STATIC, STRUCT, TRAIT, TYPE_ALIAS, USE, VISIBILITY,\n+    },\n     T,\n };\n \n@@ -37,12 +39,15 @@ fn add_vis(acc: &mut Assists, ctx: &AssistContext) -> Option<()> {\n                 | T![enum]\n                 | T![trait]\n                 | T![type]\n+                | T![use]\n+                | T![macro]\n         )\n     });\n \n     let (offset, target) = if let Some(keyword) = item_keyword {\n         let parent = keyword.parent()?;\n-        let def_kws = vec![CONST, STATIC, TYPE_ALIAS, FN, MODULE, STRUCT, ENUM, TRAIT];\n+        let def_kws =\n+            vec![CONST, STATIC, TYPE_ALIAS, FN, MODULE, STRUCT, ENUM, TRAIT, USE, MACRO_DEF];\n         // Parent is not a definition, can't add visibility\n         if !def_kws.iter().any(|&def_kw| def_kw == parent.kind()) {\n             return None;\n@@ -122,6 +127,8 @@ mod tests {\n         check_assist(change_visibility, \"$0trait Foo {}\", \"pub(crate) trait Foo {}\");\n         check_assist(change_visibility, \"m$0od {}\", \"pub(crate) mod {}\");\n         check_assist(change_visibility, \"unsafe f$0n foo() {}\", \"pub(crate) unsafe fn foo() {}\");\n+        check_assist(change_visibility, \"$0macro foo() {}\", \"pub(crate) macro foo() {}\");\n+        check_assist(change_visibility, \"$0use foo;\", \"pub(crate) use foo;\");\n     }\n \n     #[test]"}]}