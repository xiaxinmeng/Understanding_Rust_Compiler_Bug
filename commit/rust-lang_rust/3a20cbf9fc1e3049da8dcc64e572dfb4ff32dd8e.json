{"sha": "3a20cbf9fc1e3049da8dcc64e572dfb4ff32dd8e", "node_id": "C_kwDOAAsO6NoAKDNhMjBjYmY5ZmMxZTMwNDlkYThkY2M2NGU1NzJkZmI0ZmYzMmRkOGU", "commit": {"author": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2023-01-30T22:55:47Z"}, "committer": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2023-01-31T17:12:13Z"}, "message": "rustdoc: remove inconsistently-present sidebar tooltips\n\nDiscussed in\nhttps://rust-lang.zulipchat.com/#narrow/stream/266220-rustdoc/topic/Inconsistent.20sidebar.20tooltips/near/323565625", "tree": {"sha": "f0289ae9c87ca3eb720c89c4a5f634c359729d9a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f0289ae9c87ca3eb720c89c4a5f634c359729d9a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3a20cbf9fc1e3049da8dcc64e572dfb4ff32dd8e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3a20cbf9fc1e3049da8dcc64e572dfb4ff32dd8e", "html_url": "https://github.com/rust-lang/rust/commit/3a20cbf9fc1e3049da8dcc64e572dfb4ff32dd8e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3a20cbf9fc1e3049da8dcc64e572dfb4ff32dd8e/comments", "author": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "committer": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a64ef7d07d0411315be85a646586cb85eeb9c136", "url": "https://api.github.com/repos/rust-lang/rust/commits/a64ef7d07d0411315be85a646586cb85eeb9c136", "html_url": "https://github.com/rust-lang/rust/commit/a64ef7d07d0411315be85a646586cb85eeb9c136"}], "stats": {"total": 45, "additions": 4, "deletions": 41}, "files": [{"sha": "1216a8d71c8cfa51bce3bace9577f7760de4ee1c", "filename": "src/librustdoc/html/render/context.rs", "status": "modified", "additions": 3, "deletions": 6, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/3a20cbf9fc1e3049da8dcc64e572dfb4ff32dd8e/src%2Flibrustdoc%2Fhtml%2Frender%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3a20cbf9fc1e3049da8dcc64e572dfb4ff32dd8e/src%2Flibrustdoc%2Fhtml%2Frender%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fcontext.rs?ref=3a20cbf9fc1e3049da8dcc64e572dfb4ff32dd8e", "patch": "@@ -18,7 +18,7 @@ use super::search_index::build_index;\n use super::write_shared::write_shared;\n use super::{\n     collect_spans_and_sources, print_sidebar, scrape_examples_help, sidebar_module_like, AllTypes,\n-    LinkFromSrc, NameDoc, StylePath,\n+    LinkFromSrc, StylePath,\n };\n \n use crate::clean::{self, types::ExternalLocation, ExternalCrate};\n@@ -256,7 +256,7 @@ impl<'tcx> Context<'tcx> {\n     }\n \n     /// Construct a map of items shown in the sidebar to a plain-text summary of their docs.\n-    fn build_sidebar_items(&self, m: &clean::Module) -> BTreeMap<String, Vec<NameDoc>> {\n+    fn build_sidebar_items(&self, m: &clean::Module) -> BTreeMap<String, Vec<String>> {\n         // BTreeMap instead of HashMap to get a sorted output\n         let mut map: BTreeMap<_, Vec<_>> = BTreeMap::new();\n         let mut inserted: FxHashMap<ItemType, FxHashSet<Symbol>> = FxHashMap::default();\n@@ -274,10 +274,7 @@ impl<'tcx> Context<'tcx> {\n             if inserted.entry(short).or_default().insert(myname) {\n                 let short = short.to_string();\n                 let myname = myname.to_string();\n-                map.entry(short).or_default().push((\n-                    myname,\n-                    Some(item.doc_value().map_or_else(String::new, |s| plain_text_summary(&s))),\n-                ));\n+                map.entry(short).or_default().push(myname);\n             }\n         }\n "}, {"sha": "deebab1f0e80e00936baba43b5b27746f82c01e8", "filename": "src/librustdoc/html/render/mod.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/3a20cbf9fc1e3049da8dcc64e572dfb4ff32dd8e/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3a20cbf9fc1e3049da8dcc64e572dfb4ff32dd8e/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs?ref=3a20cbf9fc1e3049da8dcc64e572dfb4ff32dd8e", "patch": "@@ -83,9 +83,6 @@ use crate::scrape_examples::{CallData, CallLocation};\n use crate::try_none;\n use crate::DOC_RUST_LANG_ORG_CHANNEL;\n \n-/// A pair of name and its optional document.\n-pub(crate) type NameDoc = (String, Option<String>);\n-\n pub(crate) fn ensure_trailing_slash(v: &str) -> impl fmt::Display + '_ {\n     crate::html::format::display_fn(move |f| {\n         if !v.ends_with('/') && !v.is_empty() { write!(f, \"{}/\", v) } else { f.write_str(v) }"}, {"sha": "b5cbc484601ca5d08786ad8db01cb0c816321698", "filename": "src/librustdoc/html/static/js/main.js", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/3a20cbf9fc1e3049da8dcc64e572dfb4ff32dd8e/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/3a20cbf9fc1e3049da8dcc64e572dfb4ff32dd8e/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js?ref=3a20cbf9fc1e3049da8dcc64e572dfb4ff32dd8e", "patch": "@@ -456,10 +456,7 @@ function loadCss(cssUrl) {\n             const ul = document.createElement(\"ul\");\n             ul.className = \"block \" + shortty;\n \n-            for (const item of filtered) {\n-                const name = item[0];\n-                const desc = item[1]; // can be null\n-\n+            for (const name of filtered) {\n                 let path;\n                 if (shortty === \"mod\") {\n                     path = name + \"/index.html\";\n@@ -469,7 +466,6 @@ function loadCss(cssUrl) {\n                 const current_page = document.location.href.split(\"/\").pop();\n                 const link = document.createElement(\"a\");\n                 link.href = path;\n-                link.title = desc;\n                 if (path === current_page) {\n                     link.className = \"current\";\n                 }"}, {"sha": "31e7072b5ce9bc7e05c4b596d777aaf991ad2d6d", "filename": "tests/rustdoc/markdown-summaries.rs", "status": "removed", "additions": 0, "deletions": 27, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/a64ef7d07d0411315be85a646586cb85eeb9c136/tests%2Frustdoc%2Fmarkdown-summaries.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a64ef7d07d0411315be85a646586cb85eeb9c136/tests%2Frustdoc%2Fmarkdown-summaries.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fmarkdown-summaries.rs?ref=a64ef7d07d0411315be85a646586cb85eeb9c136", "patch": "@@ -1,27 +0,0 @@\n-#![crate_type = \"lib\"]\n-#![crate_name = \"summaries\"]\n-\n-//! This *summary* has a [link] and `code`.\n-//!\n-//! This is the second paragraph.\n-//!\n-//! [link]: https://example.com\n-\n-// @hasraw search-index.js 'This <em>summary</em> has a link and <code>code</code>.'\n-// @!hasraw - 'second paragraph'\n-\n-/// This `code` will be rendered in a code tag.\n-///\n-/// This text should not be rendered.\n-pub struct Sidebar;\n-\n-// @hasraw search-index.js 'This <code>code</code> will be rendered in a code tag.'\n-// @hasraw summaries/sidebar-items.js 'This `code` will be rendered in a code tag.'\n-// @!hasraw - 'text should not be rendered'\n-\n-/// ```text\n-/// this block should not be rendered\n-/// ```\n-pub struct Sidebar2;\n-\n-// @!hasraw summaries/sidebar-items.js 'block should not be rendered'"}]}