{"sha": "ea09b7d8c6eeeb8433bbdda50ffcc989d4f82fdf", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVhMDliN2Q4YzZlZWViODQzM2JiZGRhNTBmZmNjOTg5ZDRmODJmZGY=", "commit": {"author": {"name": "Jonathan Turner", "email": "jonathandturner@users.noreply.github.com", "date": "2016-08-17T13:25:25Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2016-08-17T13:25:25Z"}, "message": "Rollup merge of #35663 - CryZe:no-stdlib, r=Manishearth\n\nImprove `No stdlib` and related Documentation\n\nThis renames all lang item function names to the ones used in `libstd` and `libpanic_unwind`. It also explains the `eh_unwind_resume` lang item in the `libcore` documentation, where it was missing. A third function is also needed on certain compilation targets, so this was also added to the `No stdlib` documentation.", "tree": {"sha": "c8b5cd73c2cde92070408a681731b6a163bf1134", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c8b5cd73c2cde92070408a681731b6a163bf1134"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ea09b7d8c6eeeb8433bbdda50ffcc989d4f82fdf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ea09b7d8c6eeeb8433bbdda50ffcc989d4f82fdf", "html_url": "https://github.com/rust-lang/rust/commit/ea09b7d8c6eeeb8433bbdda50ffcc989d4f82fdf", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ea09b7d8c6eeeb8433bbdda50ffcc989d4f82fdf/comments", "author": {"login": "jonathandturner", "id": 111457284, "node_id": "O_kgDOBqS0BA", "avatar_url": "https://avatars.githubusercontent.com/u/111457284?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonathandturner", "html_url": "https://github.com/jonathandturner", "followers_url": "https://api.github.com/users/jonathandturner/followers", "following_url": "https://api.github.com/users/jonathandturner/following{/other_user}", "gists_url": "https://api.github.com/users/jonathandturner/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonathandturner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonathandturner/subscriptions", "organizations_url": "https://api.github.com/users/jonathandturner/orgs", "repos_url": "https://api.github.com/users/jonathandturner/repos", "events_url": "https://api.github.com/users/jonathandturner/events{/privacy}", "received_events_url": "https://api.github.com/users/jonathandturner/received_events", "type": "Organization", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a9e3cffde1fa0bbe61cd9d34f2a9c45c78249738", "url": "https://api.github.com/repos/rust-lang/rust/commits/a9e3cffde1fa0bbe61cd9d34f2a9c45c78249738", "html_url": "https://github.com/rust-lang/rust/commit/a9e3cffde1fa0bbe61cd9d34f2a9c45c78249738"}, {"sha": "e586d2174bd732bcc4a430266f371fbb82b39398", "url": "https://api.github.com/repos/rust-lang/rust/commits/e586d2174bd732bcc4a430266f371fbb82b39398", "html_url": "https://github.com/rust-lang/rust/commit/e586d2174bd732bcc4a430266f371fbb82b39398"}], "stats": {"total": 46, "additions": 34, "deletions": 12}, "files": [{"sha": "de7dbab3f12ea665ffc2fbb5fad5bb038b0a77b1", "filename": "src/doc/book/lang-items.md", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/ea09b7d8c6eeeb8433bbdda50ffcc989d4f82fdf/src%2Fdoc%2Fbook%2Flang-items.md", "raw_url": "https://github.com/rust-lang/rust/raw/ea09b7d8c6eeeb8433bbdda50ffcc989d4f82fdf/src%2Fdoc%2Fbook%2Flang-items.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Fbook%2Flang-items.md?ref=ea09b7d8c6eeeb8433bbdda50ffcc989d4f82fdf", "patch": "@@ -57,8 +57,8 @@ fn main(argc: isize, argv: *const *const u8) -> isize {\n     0\n }\n \n-#[lang = \"eh_personality\"] extern fn eh_personality() {}\n-#[lang = \"panic_fmt\"] fn panic_fmt() -> ! { loop {} }\n+#[lang = \"eh_personality\"] extern fn rust_eh_personality() {}\n+#[lang = \"panic_fmt\"] extern fn rust_begin_panic() -> ! { loop {} }\n # #[lang = \"eh_unwind_resume\"] extern fn rust_eh_unwind_resume() {}\n # #[no_mangle] pub extern fn rust_eh_register_frames () {}\n # #[no_mangle] pub extern fn rust_eh_unregister_frames () {}\n@@ -73,8 +73,8 @@ Other features provided by lang items include:\n   `==`, `<`, dereferencing (`*`) and `+` (etc.) operators are all\n   marked with lang items; those specific four are `eq`, `ord`,\n   `deref`, and `add` respectively.\n-- stack unwinding and general failure; the `eh_personality`, `fail`\n-  and `fail_bounds_checks` lang items.\n+- stack unwinding and general failure; the `eh_personality`,\n+  `eh_unwind_resume`, `fail` and `fail_bounds_checks` lang items.\n - the traits in `std::marker` used to indicate types of\n   various kinds; lang items `send`, `sync` and `copy`.\n - the marker types and variance indicators found in"}, {"sha": "2604ca8d4cab7a269ed4eeacca2ea9b4f6f0e7e5", "filename": "src/doc/book/no-stdlib.md", "status": "modified", "additions": 25, "deletions": 8, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/ea09b7d8c6eeeb8433bbdda50ffcc989d4f82fdf/src%2Fdoc%2Fbook%2Fno-stdlib.md", "raw_url": "https://github.com/rust-lang/rust/raw/ea09b7d8c6eeeb8433bbdda50ffcc989d4f82fdf/src%2Fdoc%2Fbook%2Fno-stdlib.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Fbook%2Fno-stdlib.md?ref=ea09b7d8c6eeeb8433bbdda50ffcc989d4f82fdf", "patch": "@@ -55,7 +55,13 @@ fn start(_argc: isize, _argv: *const *const u8) -> isize {\n // provided by libstd.\n #[lang = \"eh_personality\"]\n #[no_mangle]\n-pub extern fn eh_personality() {\n+pub extern fn rust_eh_personality() {\n+}\n+\n+// This function may be needed based on the compilation target.\n+#[lang = \"eh_unwind_resume\"]\n+#[no_mangle]\n+pub extern fn rust_eh_unwind_resume() {\n }\n \n #[lang = \"panic_fmt\"]\n@@ -87,12 +93,18 @@ pub extern fn main(_argc: i32, _argv: *const *const u8) -> i32 {\n     0\n }\n \n-// These functions and traits are used by the compiler, but not\n+// These functions are used by the compiler, but not\n // for a bare-bones hello world. These are normally\n // provided by libstd.\n #[lang = \"eh_personality\"]\n #[no_mangle]\n-pub extern fn eh_personality() {\n+pub extern fn rust_eh_personality() {\n+}\n+\n+// This function may be needed based on the compilation target.\n+#[lang = \"eh_unwind_resume\"]\n+#[no_mangle]\n+pub extern fn rust_eh_unwind_resume() {\n }\n \n #[lang = \"panic_fmt\"]\n@@ -104,23 +116,28 @@ pub extern fn rust_begin_panic(_msg: core::fmt::Arguments,\n }\n ```\n \n-## More about the langauge items\n+## More about the language items\n \n The compiler currently makes a few assumptions about symbols which are\n available in the executable to call. Normally these functions are provided by\n the standard library, but without it you must define your own. These symbols\n are called \"language items\", and they each have an internal name, and then a\n signature that an implementation must conform to.\n \n-The first of these two functions, `eh_personality`, is used by the failure\n+The first of these functions, `rust_eh_personality`, is used by the failure\n mechanisms of the compiler. This is often mapped to GCC's personality function\n (see the [libstd implementation][unwind] for more information), but crates\n which do not trigger a panic can be assured that this function is never\n-called. Both the language item and the symbol name are `eh_personality`.\n- \n+called. The language item's name is `eh_personality`.\n+\n [unwind]: https://github.com/rust-lang/rust/blob/master/src/libpanic_unwind/gcc.rs\n \n-The second function, `panic_fmt`, is also used by the failure mechanisms of the\n+The second function, `rust_begin_panic`, is also used by the failure mechanisms of the\n compiler. When a panic happens, this controls the message that's displayed on\n the screen. While the language item's name is `panic_fmt`, the symbol name is\n `rust_begin_panic`.\n+\n+A third function, `rust_eh_unwind_resume`, is also needed if the `custom_unwind_resume`\n+flag is set in the options of the compilation target. It allows customizing the\n+process of resuming unwind at the end of the landing pads. The language item's name\n+is `eh_unwind_resume`."}, {"sha": "2a9678203e17805004d88aa07e4b1773810bda01", "filename": "src/libcore/lib.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/ea09b7d8c6eeeb8433bbdda50ffcc989d4f82fdf/src%2Flibcore%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ea09b7d8c6eeeb8433bbdda50ffcc989d4f82fdf/src%2Flibcore%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Flib.rs?ref=ea09b7d8c6eeeb8433bbdda50ffcc989d4f82fdf", "patch": "@@ -42,6 +42,11 @@\n //!   line. It is up to consumers of this core library to define this panic\n //!   function; it is only required to never return. This requires a `lang`\n //!   attribute named `panic_fmt`.\n+//!\n+//! * `rust_eh_personality` - is used by the failure mechanisms of the\n+//!    compiler. This is often mapped to GCC's personality function, but crates\n+//!    which do not trigger a panic can be assured that this function is never\n+//!    called. The `lang` attribute is called `eh_personality`.\n \n // Since libcore defines many fundamental lang items, all tests live in a\n // separate crate, libcoretest, to avoid bizarre issues."}]}