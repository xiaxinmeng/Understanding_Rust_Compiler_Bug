{"sha": "785309b8b19601e3cf38955c0cbedcd682c7487b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc4NTMwOWI4YjE5NjAxZTNjZjM4OTU1YzBjYmVkY2Q2ODJjNzQ4N2I=", "commit": {"author": {"name": "Patrick Conrad", "email": "patrick.conrad@cherishhealth.com", "date": "2021-08-25T16:03:41Z"}, "committer": {"name": "Patrick Conrad", "email": "patrick.conrad@cherishhealth.com", "date": "2021-08-25T16:21:56Z"}, "message": "Add make tests for preserving test binaries\n\nfix: #88110", "tree": {"sha": "7d6f1d0aa16a18e16b3b4a0385c1263be431d5e7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7d6f1d0aa16a18e16b3b4a0385c1263be431d5e7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/785309b8b19601e3cf38955c0cbedcd682c7487b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/785309b8b19601e3cf38955c0cbedcd682c7487b", "html_url": "https://github.com/rust-lang/rust/commit/785309b8b19601e3cf38955c0cbedcd682c7487b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/785309b8b19601e3cf38955c0cbedcd682c7487b/comments", "author": null, "committer": null, "parents": [{"sha": "4b45bb92cbb33d17b7d2b86bb81bad6963e53b48", "url": "https://api.github.com/repos/rust-lang/rust/commits/4b45bb92cbb33d17b7d2b86bb81bad6963e53b48", "html_url": "https://github.com/rust-lang/rust/commit/4b45bb92cbb33d17b7d2b86bb81bad6963e53b48"}], "stats": {"total": 32, "additions": 32, "deletions": 0}, "files": [{"sha": "273c8980b02242d80332e582bd6943beafef31fe", "filename": "src/test/run-make/doctests-keep-binaries/Makefile", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/785309b8b19601e3cf38955c0cbedcd682c7487b/src%2Ftest%2Frun-make%2Fdoctests-keep-binaries%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/785309b8b19601e3cf38955c0cbedcd682c7487b/src%2Ftest%2Frun-make%2Fdoctests-keep-binaries%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fdoctests-keep-binaries%2FMakefile?ref=785309b8b19601e3cf38955c0cbedcd682c7487b", "patch": "@@ -0,0 +1,21 @@\n+include ../../run-make-fulldeps/tools.mk\n+\n+# Check that valid binaries are persisted by running them, regardless of whether the --run or --no-run option is used.\n+\n+all: run no_run\n+\n+run:\n+\tmkdir -p $(TMPDIR)/doctests\n+\t$(RUSTC) --crate-type rlib t.rs\n+\t$(RUSTDOC) -Zunstable-options --test --persist-doctests $(TMPDIR)/doctests --extern t=$(TMPDIR)/libt.rlib t.rs\n+\t$(TMPDIR)/doctests/t_rs_2_0/rust_out\n+\t$(TMPDIR)/doctests/t_rs_8_0/rust_out\n+\trm -rf $(TMPDIR)/doctests\n+\n+no_run:\n+\tmkdir -p $(TMPDIR)/doctests\n+\t$(RUSTC) --crate-type rlib t.rs\n+\t$(RUSTDOC) -Zunstable-options --test --persist-doctests $(TMPDIR)/doctests --extern t=$(TMPDIR)/libt.rlib t.rs --no-run\n+\t$(TMPDIR)/doctests/t_rs_2_0/rust_out\n+\t$(TMPDIR)/doctests/t_rs_8_0/rust_out\n+\trm -rf $(TMPDIR)/doctests"}, {"sha": "c38cf0a0b25d4020b3a61cb10e759846c2dc2d24", "filename": "src/test/run-make/doctests-keep-binaries/t.rs", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/785309b8b19601e3cf38955c0cbedcd682c7487b/src%2Ftest%2Frun-make%2Fdoctests-keep-binaries%2Ft.rs", "raw_url": "https://github.com/rust-lang/rust/raw/785309b8b19601e3cf38955c0cbedcd682c7487b/src%2Ftest%2Frun-make%2Fdoctests-keep-binaries%2Ft.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fdoctests-keep-binaries%2Ft.rs?ref=785309b8b19601e3cf38955c0cbedcd682c7487b", "patch": "@@ -0,0 +1,11 @@\n+/// Fungle the foople.\n+/// ```\n+/// t::foople();\n+/// ```\n+pub fn foople() {}\n+\n+/// Flomble the florp\n+/// ```\n+/// t::florp();\n+/// ```\n+pub fn florp() {}"}]}