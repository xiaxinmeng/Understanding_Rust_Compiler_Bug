{"sha": "6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZjNTNhMGMyYjVjNzNhMGVhMDc1MGRkNmM4NDI5OGNlOTM0OGVjZmY=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2020-06-18T22:21:04Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-06-18T22:21:04Z"}, "message": "Rollup merge of #73476 - JakobDegen:should_panic_rustdoc, r=GuillaumeGomez\n\nAdded tooltip for should_panic code examples\n\nThis change adds a tooltip to the documentation for `should_panic` examples. It currently displays identically to `compile_fail` examples, save for the changed text. It may be helpful to change the color that this displays in to make it visually more clear what is going on, but I'm unsure if additional colors wouldn't just be distracting.\n\nI brought this [up on internals](https://internals.rust-lang.org/t/indicating-that-an-example-is-should-panic-in-docs/12544) a few days ago, and there seemed to be a mild positive response to it.", "tree": {"sha": "b900ed72fa0d4ee9b66c2dd41b164620fe07c6cb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b900ed72fa0d4ee9b66c2dd41b164620fe07c6cb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJe6+jRCRBK7hj4Ov3rIwAAdHIIAHBXA7eNPLPwfNvkOI2J/WH7\nMFIRdeFycnydnjfW8TkuIU+rgCDYZXiMjHD9sFcbut1wGgP8CluSQW4yxw936ShD\n24VHcwp+jeWd/uVEsV+CAvd7yHVBXiafwfMliT8cshKgk6uD0BTRbLv9jyKVJWi4\nafMCmZG+lQcQBAJk9NY19Vd2+EbcMwH9sgh7gs6P+p2rdH8ERedzEQwhWNwJyznk\ns8NAsc4UYWiFsdThDA5nXQvpIF6gHOo7OEJR+ByVptHED+m+iUsaDHTRfNw1X8gE\nlILMAfeCNupP+KAbOmH/6qviw5B3Hxejw9osdIMoA4POH4ZaW7y8x1DZOnHy0pI=\n=QtxQ\n-----END PGP SIGNATURE-----\n", "payload": "tree b900ed72fa0d4ee9b66c2dd41b164620fe07c6cb\nparent f15b346f3adf03a976e9468401e443a3ecb61a71\nparent 721facf29c4ba7bc1d75acafce1b4916d5feafa5\nauthor Manish Goregaokar <manishsmail@gmail.com> 1592518864 -0700\ncommitter GitHub <noreply@github.com> 1592518864 -0700\n\nRollup merge of #73476 - JakobDegen:should_panic_rustdoc, r=GuillaumeGomez\n\nAdded tooltip for should_panic code examples\n\nThis change adds a tooltip to the documentation for `should_panic` examples. It currently displays identically to `compile_fail` examples, save for the changed text. It may be helpful to change the color that this displays in to make it visually more clear what is going on, but I'm unsure if additional colors wouldn't just be distracting.\n\nI brought this [up on internals](https://internals.rust-lang.org/t/indicating-that-an-example-is-should-panic-in-docs/12544) a few days ago, and there seemed to be a mild positive response to it.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff", "html_url": "https://github.com/rust-lang/rust/commit/6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f15b346f3adf03a976e9468401e443a3ecb61a71", "url": "https://api.github.com/repos/rust-lang/rust/commits/f15b346f3adf03a976e9468401e443a3ecb61a71", "html_url": "https://github.com/rust-lang/rust/commit/f15b346f3adf03a976e9468401e443a3ecb61a71"}, {"sha": "721facf29c4ba7bc1d75acafce1b4916d5feafa5", "url": "https://api.github.com/repos/rust-lang/rust/commits/721facf29c4ba7bc1d75acafce1b4916d5feafa5", "html_url": "https://github.com/rust-lang/rust/commit/721facf29c4ba7bc1d75acafce1b4916d5feafa5"}], "stats": {"total": 47, "additions": 46, "deletions": 1}, "files": [{"sha": "7a6626766d38830c27283ad336f69ee03aae2435", "filename": "src/librustdoc/html/markdown.rs", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fmarkdown.rs?ref=6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff", "patch": "@@ -192,6 +192,7 @@ impl<'a, I: Iterator<Item = Event<'a>>> Iterator for CodeBlocks<'_, 'a, I> {\n     fn next(&mut self) -> Option<Self::Item> {\n         let event = self.inner.next();\n         let compile_fail;\n+        let should_panic;\n         let ignore;\n         let edition;\n         if let Some(Event::Start(Tag::CodeBlock(kind))) = event {\n@@ -205,6 +206,7 @@ impl<'a, I: Iterator<Item = Event<'a>>> Iterator for CodeBlocks<'_, 'a, I> {\n                 return Some(Event::Start(Tag::CodeBlock(kind)));\n             }\n             compile_fail = parse_result.compile_fail;\n+            should_panic = parse_result.should_panic;\n             ignore = parse_result.ignore;\n             edition = parse_result.edition;\n         } else {\n@@ -280,6 +282,8 @@ impl<'a, I: Iterator<Item = Event<'a>>> Iterator for CodeBlocks<'_, 'a, I> {\n             Some((\"This example is not tested\".to_owned(), \"ignore\"))\n         } else if compile_fail {\n             Some((\"This example deliberately fails to compile\".to_owned(), \"compile_fail\"))\n+        } else if should_panic {\n+            Some((\"This example panics\".to_owned(), \"should_panic\"))\n         } else if explicit_edition {\n             Some((format!(\"This code runs with edition {}\", edition), \"edition\"))\n         } else {\n@@ -295,6 +299,8 @@ impl<'a, I: Iterator<Item = Event<'a>>> Iterator for CodeBlocks<'_, 'a, I> {\n                         \" ignore\"\n                     } else if compile_fail {\n                         \" compile_fail\"\n+                    } else if should_panic {\n+                        \" should_panic\"\n                     } else if explicit_edition {\n                         \" edition \"\n                     } else {\n@@ -314,6 +320,8 @@ impl<'a, I: Iterator<Item = Event<'a>>> Iterator for CodeBlocks<'_, 'a, I> {\n                         \" ignore\"\n                     } else if compile_fail {\n                         \" compile_fail\"\n+                    } else if should_panic {\n+                        \" should_panic\"\n                     } else if explicit_edition {\n                         \" edition \"\n                     } else {"}, {"sha": "9c6dd25394db0e8ed4d1c1c0beffbf9cd36eaa3e", "filename": "src/librustdoc/html/static/rustdoc.css", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css?ref=6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff", "patch": "@@ -1089,7 +1089,7 @@ h3 > .collapse-toggle, h4 > .collapse-toggle {\n \tborder-style: solid;\n }\n \n-.tooltip.compile_fail, .tooltip.ignore {\n+.tooltip.compile_fail, .tooltip.should_panic, .tooltip.ignore {\n \tfont-weight: bold;\n \tfont-size: 20px;\n }"}, {"sha": "41dcb5c24507c6c38dfe99a66bd3f84ac20cde81", "filename": "src/librustdoc/html/static/themes/dark.css", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Fdark.css?ref=6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff", "patch": "@@ -283,6 +283,14 @@ pre.compile_fail:hover, .information:hover + pre.compile_fail {\n \tborder-left: 2px solid #f00;\n }\n \n+pre.should_panic {\n+\tborder-left: 2px solid rgba(255,0,0,.8);\n+}\n+\n+pre.should_panic:hover, .information:hover + pre.should_panic {\n+\tborder-left: 2px solid #f00;\n+}\n+\n pre.ignore {\n \tborder-left: 2px solid rgba(255,142,0,.6);\n }\n@@ -299,6 +307,14 @@ pre.ignore:hover, .information:hover + pre.ignore {\n \tcolor: #f00;\n }\n \n+.tooltip.should_panic {\n+\tcolor: rgba(255,0,0,.8);\n+}\n+\n+.information > .should_panic:hover {\n+\tcolor: #f00;\n+}\n+\n .tooltip.ignore {\n \tcolor: rgba(255,142,0,.6);\n }"}, {"sha": "386fe2398e63aec931bb665ea82dea7db5c0f0ef", "filename": "src/librustdoc/html/static/themes/light.css", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Flight.css", "raw_url": "https://github.com/rust-lang/rust/raw/6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Flight.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fthemes%2Flight.css?ref=6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff", "patch": "@@ -278,6 +278,14 @@ pre.compile_fail:hover, .information:hover + pre.compile_fail {\n \tborder-left: 2px solid #f00;\n }\n \n+pre.should_panic {\n+\tborder-left: 2px solid rgba(255,0,0,.5);\n+}\n+\n+pre.should_panic:hover, .information:hover + pre.should_panic {\n+\tborder-left: 2px solid #f00;\n+}\n+\n pre.ignore {\n \tborder-left: 2px solid rgba(255,142,0,.6);\n }\n@@ -294,6 +302,14 @@ pre.ignore:hover, .information:hover + pre.ignore {\n \tcolor: #f00;\n }\n \n+.tooltip.should_panic {\n+\tcolor: rgba(255,0,0,.5);\n+}\n+\n+.information > .should_panic:hover {\n+\tcolor: #f00;\n+}\n+\n .tooltip.ignore {\n \tcolor: rgba(255,142,0,.6);\n }"}, {"sha": "b59b21111b009740350b5f5db4a6a1d941a3a231", "filename": "src/test/rustdoc/codeblock-title.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff/src%2Ftest%2Frustdoc%2Fcodeblock-title.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff/src%2Ftest%2Frustdoc%2Fcodeblock-title.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fcodeblock-title.rs?ref=6c53a0c2b5c73a0ea0750dd6c84298ce9348ecff", "patch": "@@ -4,6 +4,7 @@\n \n // @has foo/fn.bar.html '//*[@class=\"tooltip compile_fail\"]/span' \"This example deliberately fails to compile\"\n // @has foo/fn.bar.html '//*[@class=\"tooltip ignore\"]/span' \"This example is not tested\"\n+// @has foo/fn.bar.html '//*[@class=\"tooltip should_panic\"]/span' \"This example panics\"\n \n /// foo\n ///\n@@ -15,6 +16,10 @@\n /// goo();\n /// ```\n ///\n+/// ```should_panic\n+/// hoo();\n+/// ```\n+///\n /// ```\n /// let x = 0;\n /// ```"}]}