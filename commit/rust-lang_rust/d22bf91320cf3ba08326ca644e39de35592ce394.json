{"sha": "d22bf91320cf3ba08326ca644e39de35592ce394", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQyMmJmOTEzMjBjZjNiYTA4MzI2Y2E2NDRlMzlkZTM1NTkyY2UzOTQ=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-11-24T02:17:03Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-11-24T02:17:03Z"}, "message": "Rollup merge of #66659 - Centril:fix-bench, r=Mark-Simulacrum\n\nmake `./x.py bench` again\n\nFixes #54016", "tree": {"sha": "7d1fb15021ff6320393277ab0aeb5ce5ac5a566c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7d1fb15021ff6320393277ab0aeb5ce5ac5a566c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d22bf91320cf3ba08326ca644e39de35592ce394", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJd2eggCRBK7hj4Ov3rIwAAdHIIAISCErix4ZZQ6eqQASChAkS9\nYQxXiV2+NMYLJ8ja9XpV4nqG9887+kStFu1rbryTv8aiMwGUSLv+UuL4QmM6fME3\nFMqzhfnY2Ti3ZiaGawFwsE9aTyNUNpbKuEJNFKNY0Co5oIFzZqOk0oOogaeDbW0z\ntpiGwBCOFFlukfKxXiXZubbN0oXigysWnRn2ihZ+2tJhgDEfy5UZwew0wG987yV8\nFC899TYiyAhLY4aEQKyNYSyUMJTCtqv/Njj3Vyc5Ku/6yZkfw4RJ93V2aLTyoJan\n2vypOwN3QLJAPuIzQLpCEfK2lzjJ23fZqsOONtaQVYH46/xbBjomWDOGgbCnNzY=\n=YDzv\n-----END PGP SIGNATURE-----\n", "payload": "tree 7d1fb15021ff6320393277ab0aeb5ce5ac5a566c\nparent 980ccaa7339a367b4054ef8064d5b1a8004c6ccf\nparent 59257e6e88cc09697642cce889445d0fd6572ec1\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1574561823 +0100\ncommitter GitHub <noreply@github.com> 1574561823 +0100\n\nRollup merge of #66659 - Centril:fix-bench, r=Mark-Simulacrum\n\nmake `./x.py bench` again\n\nFixes #54016\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d22bf91320cf3ba08326ca644e39de35592ce394", "html_url": "https://github.com/rust-lang/rust/commit/d22bf91320cf3ba08326ca644e39de35592ce394", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d22bf91320cf3ba08326ca644e39de35592ce394/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "980ccaa7339a367b4054ef8064d5b1a8004c6ccf", "url": "https://api.github.com/repos/rust-lang/rust/commits/980ccaa7339a367b4054ef8064d5b1a8004c6ccf", "html_url": "https://github.com/rust-lang/rust/commit/980ccaa7339a367b4054ef8064d5b1a8004c6ccf"}, {"sha": "59257e6e88cc09697642cce889445d0fd6572ec1", "url": "https://api.github.com/repos/rust-lang/rust/commits/59257e6e88cc09697642cce889445d0fd6572ec1", "html_url": "https://github.com/rust-lang/rust/commit/59257e6e88cc09697642cce889445d0fd6572ec1"}], "stats": {"total": 128, "additions": 63, "deletions": 65}, "files": [{"sha": "2dcdf2b6fe9f71e60080c0e66cf07abaa2f408fe", "filename": "src/libcore/benches/num/mod.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d22bf91320cf3ba08326ca644e39de35592ce394/src%2Flibcore%2Fbenches%2Fnum%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d22bf91320cf3ba08326ca644e39de35592ce394/src%2Flibcore%2Fbenches%2Fnum%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fbenches%2Fnum%2Fmod.rs?ref=d22bf91320cf3ba08326ca644e39de35592ce394", "patch": "@@ -35,7 +35,7 @@ macro_rules! from_str_bench {\n                     .iter()\n                     .cycle()\n                     .take(5_000)\n-                    .filter_map(|s| <($t)>::from_str(s).ok())\n+                    .filter_map(|s| <$t>::from_str(s).ok())\n                     .max()\n             })\n         }\n@@ -51,7 +51,7 @@ macro_rules! from_str_radix_bench {\n                     .iter()\n                     .cycle()\n                     .take(5_000)\n-                    .filter_map(|s| <($t)>::from_str_radix(s, $radix).ok())\n+                    .filter_map(|s| <$t>::from_str_radix(s, $radix).ok())\n                     .max()\n             })\n         }"}, {"sha": "e3b36be5696b3ca1d44d1fa35b46ee2f57b4a85c", "filename": "src/librustc/benches/dispatch.rs", "status": "removed", "additions": 0, "deletions": 34, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/980ccaa7339a367b4054ef8064d5b1a8004c6ccf/src%2Flibrustc%2Fbenches%2Fdispatch.rs", "raw_url": "https://github.com/rust-lang/rust/raw/980ccaa7339a367b4054ef8064d5b1a8004c6ccf/src%2Flibrustc%2Fbenches%2Fdispatch.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fbenches%2Fdispatch.rs?ref=980ccaa7339a367b4054ef8064d5b1a8004c6ccf", "patch": "@@ -1,34 +0,0 @@\n-use test::Bencher;\n-\n-// Static/dynamic method dispatch\n-\n-struct Struct {\n-    field: isize\n-}\n-\n-trait Trait {\n-    fn method(&self) -> isize;\n-}\n-\n-impl Trait for Struct {\n-    fn method(&self) -> isize {\n-        self.field\n-    }\n-}\n-\n-#[bench]\n-fn trait_vtable_method_call(b: &mut Bencher) {\n-    let s = Struct { field: 10 };\n-    let t = &s as &Trait;\n-    b.iter(|| {\n-        t.method()\n-    });\n-}\n-\n-#[bench]\n-fn trait_static_method_call(b: &mut Bencher) {\n-    let s = Struct { field: 10 };\n-    b.iter(|| {\n-        s.method()\n-    });\n-}"}, {"sha": "6b624028896ac15c8628e1c1d8135cbca02d5995", "filename": "src/librustc/benches/lib.rs", "status": "modified", "additions": 59, "deletions": 2, "changes": 61, "blob_url": "https://github.com/rust-lang/rust/blob/d22bf91320cf3ba08326ca644e39de35592ce394/src%2Flibrustc%2Fbenches%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d22bf91320cf3ba08326ca644e39de35592ce394/src%2Flibrustc%2Fbenches%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fbenches%2Flib.rs?ref=d22bf91320cf3ba08326ca644e39de35592ce394", "patch": "@@ -1,6 +1,63 @@\n+#![feature(slice_patterns)]\n #![feature(test)]\n \n extern crate test;\n \n-mod dispatch;\n-mod pattern;\n+use test::Bencher;\n+\n+// Static/dynamic method dispatch\n+\n+struct Struct {\n+    field: isize\n+}\n+\n+trait Trait {\n+    fn method(&self) -> isize;\n+}\n+\n+impl Trait for Struct {\n+    fn method(&self) -> isize {\n+        self.field\n+    }\n+}\n+\n+#[bench]\n+fn trait_vtable_method_call(b: &mut Bencher) {\n+    let s = Struct { field: 10 };\n+    let t = &s as &dyn Trait;\n+    b.iter(|| {\n+        t.method()\n+    });\n+}\n+\n+#[bench]\n+fn trait_static_method_call(b: &mut Bencher) {\n+    let s = Struct { field: 10 };\n+    b.iter(|| {\n+        s.method()\n+    });\n+}\n+\n+// Overhead of various match forms\n+\n+#[bench]\n+fn option_some(b: &mut Bencher) {\n+    let x = Some(10);\n+    b.iter(|| {\n+        match x {\n+            Some(y) => y,\n+            None => 11\n+        }\n+    });\n+}\n+\n+#[bench]\n+fn vec_pattern(b: &mut Bencher) {\n+    let x = [1,2,3,4,5,6];\n+    b.iter(|| {\n+        match x {\n+            [1,2,3,..] => 10,\n+            _ => 11,\n+        }\n+    });\n+}"}, {"sha": "fd8cc5b83fd5a85ce2cbdd18642c3dfba17a4226", "filename": "src/librustc/benches/pattern.rs", "status": "removed", "additions": 0, "deletions": 25, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/980ccaa7339a367b4054ef8064d5b1a8004c6ccf/src%2Flibrustc%2Fbenches%2Fpattern.rs", "raw_url": "https://github.com/rust-lang/rust/raw/980ccaa7339a367b4054ef8064d5b1a8004c6ccf/src%2Flibrustc%2Fbenches%2Fpattern.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fbenches%2Fpattern.rs?ref=980ccaa7339a367b4054ef8064d5b1a8004c6ccf", "patch": "@@ -1,25 +0,0 @@\n-use test::Bencher;\n-\n-// Overhead of various match forms\n-\n-#[bench]\n-fn option_some(b: &mut Bencher) {\n-    let x = Some(10);\n-    b.iter(|| {\n-        match x {\n-            Some(y) => y,\n-            None => 11\n-        }\n-    });\n-}\n-\n-#[bench]\n-fn vec_pattern(b: &mut Bencher) {\n-    let x = [1,2,3,4,5,6];\n-    b.iter(|| {\n-        match x {\n-            [1,2,3,..] => 10,\n-            _ => 11,\n-        }\n-    });\n-}"}, {"sha": "e8457fe0e19eadfebcf2336d4dbd269e907589b7", "filename": "src/librustc_codegen_ssa/back/rpath/tests.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d22bf91320cf3ba08326ca644e39de35592ce394/src%2Flibrustc_codegen_ssa%2Fback%2Frpath%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d22bf91320cf3ba08326ca644e39de35592ce394/src%2Flibrustc_codegen_ssa%2Fback%2Frpath%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2Fback%2Frpath%2Ftests.rs?ref=d22bf91320cf3ba08326ca644e39de35592ce394", "patch": "@@ -52,7 +52,7 @@ fn test_minimize2() {\n fn test_rpath_relative() {\n     if cfg!(target_os = \"macos\") {\n         let config = &mut RPathConfig {\n-            used_crates: Vec::new(),\n+            used_crates: &[],\n             has_rpath: true,\n             is_like_osx: true,\n             linker_is_gnu: false,\n@@ -64,7 +64,7 @@ fn test_rpath_relative() {\n         assert_eq!(res, \"@loader_path/../lib\");\n     } else {\n         let config = &mut RPathConfig {\n-            used_crates: Vec::new(),\n+            used_crates: &[],\n             out_filename: PathBuf::from(\"bin/rustc\"),\n             get_install_prefix_lib_path: &mut || panic!(),\n             has_rpath: true,"}]}