{"sha": "0254f12224032be95dd97441a866e63c8e15a0e3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAyNTRmMTIyMjQwMzJiZTk1ZGQ5NzQ0MWE4NjZlNjNjOGUxNWEwZTM=", "commit": {"author": {"name": "Tim Neumann", "email": "mail@timnn.me", "date": "2016-11-10T16:30:06Z"}, "committer": {"name": "Tim Neumann", "email": "mail@timnn.me", "date": "2016-11-10T16:30:06Z"}, "message": "rustbuild: support RelWithDebInfo for llvm", "tree": {"sha": "07ea15d862e9b1104130a7d33317403422c19bd0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/07ea15d862e9b1104130a7d33317403422c19bd0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0254f12224032be95dd97441a866e63c8e15a0e3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0254f12224032be95dd97441a866e63c8e15a0e3", "html_url": "https://github.com/rust-lang/rust/commit/0254f12224032be95dd97441a866e63c8e15a0e3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0254f12224032be95dd97441a866e63c8e15a0e3/comments", "author": {"login": "TimNN", "id": 1178249, "node_id": "MDQ6VXNlcjExNzgyNDk=", "avatar_url": "https://avatars.githubusercontent.com/u/1178249?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TimNN", "html_url": "https://github.com/TimNN", "followers_url": "https://api.github.com/users/TimNN/followers", "following_url": "https://api.github.com/users/TimNN/following{/other_user}", "gists_url": "https://api.github.com/users/TimNN/gists{/gist_id}", "starred_url": "https://api.github.com/users/TimNN/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TimNN/subscriptions", "organizations_url": "https://api.github.com/users/TimNN/orgs", "repos_url": "https://api.github.com/users/TimNN/repos", "events_url": "https://api.github.com/users/TimNN/events{/privacy}", "received_events_url": "https://api.github.com/users/TimNN/received_events", "type": "User", "site_admin": false}, "committer": {"login": "TimNN", "id": 1178249, "node_id": "MDQ6VXNlcjExNzgyNDk=", "avatar_url": "https://avatars.githubusercontent.com/u/1178249?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TimNN", "html_url": "https://github.com/TimNN", "followers_url": "https://api.github.com/users/TimNN/followers", "following_url": "https://api.github.com/users/TimNN/following{/other_user}", "gists_url": "https://api.github.com/users/TimNN/gists{/gist_id}", "starred_url": "https://api.github.com/users/TimNN/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TimNN/subscriptions", "organizations_url": "https://api.github.com/users/TimNN/orgs", "repos_url": "https://api.github.com/users/TimNN/repos", "events_url": "https://api.github.com/users/TimNN/events{/privacy}", "received_events_url": "https://api.github.com/users/TimNN/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "187d9896028f1d0b79db3010f2a546334212838b", "url": "https://api.github.com/repos/rust-lang/rust/commits/187d9896028f1d0b79db3010f2a546334212838b", "html_url": "https://github.com/rust-lang/rust/commit/187d9896028f1d0b79db3010f2a546334212838b"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "a630aaf8af48439165b8d0030c3c8513f6e36ba1", "filename": "src/bootstrap/config.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/0254f12224032be95dd97441a866e63c8e15a0e3/src%2Fbootstrap%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0254f12224032be95dd97441a866e63c8e15a0e3/src%2Fbootstrap%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.rs?ref=0254f12224032be95dd97441a866e63c8e15a0e3", "patch": "@@ -50,6 +50,7 @@ pub struct Config {\n     // llvm codegen options\n     pub llvm_assertions: bool,\n     pub llvm_optimize: bool,\n+    pub llvm_release_debuginfo: bool,\n     pub llvm_version_check: bool,\n     pub llvm_static_stdcpp: bool,\n \n@@ -137,6 +138,7 @@ struct Llvm {\n     ninja: Option<bool>,\n     assertions: Option<bool>,\n     optimize: Option<bool>,\n+    release_debuginfo: Option<bool>,\n     version_check: Option<bool>,\n     static_libstdcpp: Option<bool>,\n }\n@@ -243,6 +245,7 @@ impl Config {\n             set(&mut config.ninja, llvm.ninja);\n             set(&mut config.llvm_assertions, llvm.assertions);\n             set(&mut config.llvm_optimize, llvm.optimize);\n+            set(&mut config.llvm_release_debuginfo, llvm.release_debuginfo);\n             set(&mut config.llvm_version_check, llvm.version_check);\n             set(&mut config.llvm_static_stdcpp, llvm.static_libstdcpp);\n         }"}, {"sha": "1388dab303a44ee6755ebe495afc7ccf425ac135", "filename": "src/bootstrap/config.toml.example", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/0254f12224032be95dd97441a866e63c8e15a0e3/src%2Fbootstrap%2Fconfig.toml.example", "raw_url": "https://github.com/rust-lang/rust/raw/0254f12224032be95dd97441a866e63c8e15a0e3/src%2Fbootstrap%2Fconfig.toml.example", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.toml.example?ref=0254f12224032be95dd97441a866e63c8e15a0e3", "patch": "@@ -17,6 +17,9 @@\n # Indicates whether the LLVM build is a Release or Debug build\n #optimize = true\n \n+# Indicates whether an LLVM Release build should include debug info\n+#release-debuginfo = false\n+\n # Indicates whether the LLVM assertions are enabled or not\n #assertions = false\n "}, {"sha": "358cfac74277778497d6476ee0f1e918d320fa17", "filename": "src/bootstrap/native.rs", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/0254f12224032be95dd97441a866e63c8e15a0e3/src%2Fbootstrap%2Fnative.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0254f12224032be95dd97441a866e63c8e15a0e3/src%2Fbootstrap%2Fnative.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fnative.rs?ref=0254f12224032be95dd97441a866e63c8e15a0e3", "patch": "@@ -67,10 +67,17 @@ pub fn llvm(build: &Build, target: &str) {\n     if build.config.ninja {\n         cfg.generator(\"Ninja\");\n     }\n+\n+    let profile = match (build.config.llvm_optimize, build.config.llvm_release_debuginfo) {\n+        (false, _) => \"Debug\",\n+        (true, false) => \"Release\",\n+        (true, true) => \"RelWithDebInfo\",\n+    };\n+\n     cfg.target(target)\n        .host(&build.config.build)\n        .out_dir(&dst)\n-       .profile(if build.config.llvm_optimize {\"Release\"} else {\"Debug\"})\n+       .profile(profile)\n        .define(\"LLVM_ENABLE_ASSERTIONS\", assertions)\n        .define(\"LLVM_TARGETS_TO_BUILD\", \"X86;ARM;AArch64;Mips;PowerPC;SystemZ;JSBackend\")\n        .define(\"LLVM_INCLUDE_EXAMPLES\", \"OFF\")"}]}