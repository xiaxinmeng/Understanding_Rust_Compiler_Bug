{"sha": "6247a529e3af664f885ac0bb05bf6be2c102ec6a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYyNDdhNTI5ZTNhZjY2NGY4ODVhYzBiYjA1YmY2YmUyYzEwMmVjNmE=", "commit": {"author": {"name": "Michael Sullivan", "email": "sully@msully.net", "date": "2012-07-14T02:08:18Z"}, "committer": {"name": "Michael Sullivan", "email": "sully@msully.net", "date": "2012-07-14T02:08:18Z"}, "message": "Handle prefix notations for strings in patterns. This is kind of gross.", "tree": {"sha": "cdcd1ce105398ece5ff6eddc8fd9f3350df93ab6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cdcd1ce105398ece5ff6eddc8fd9f3350df93ab6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6247a529e3af664f885ac0bb05bf6be2c102ec6a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6247a529e3af664f885ac0bb05bf6be2c102ec6a", "html_url": "https://github.com/rust-lang/rust/commit/6247a529e3af664f885ac0bb05bf6be2c102ec6a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6247a529e3af664f885ac0bb05bf6be2c102ec6a/comments", "author": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "committer": {"login": "msullivan", "id": 340349, "node_id": "MDQ6VXNlcjM0MDM0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/340349?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msullivan", "html_url": "https://github.com/msullivan", "followers_url": "https://api.github.com/users/msullivan/followers", "following_url": "https://api.github.com/users/msullivan/following{/other_user}", "gists_url": "https://api.github.com/users/msullivan/gists{/gist_id}", "starred_url": "https://api.github.com/users/msullivan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msullivan/subscriptions", "organizations_url": "https://api.github.com/users/msullivan/orgs", "repos_url": "https://api.github.com/users/msullivan/repos", "events_url": "https://api.github.com/users/msullivan/events{/privacy}", "received_events_url": "https://api.github.com/users/msullivan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "eaf8b7675ea3989cce9ecfe845c44e13c135d1d0", "url": "https://api.github.com/repos/rust-lang/rust/commits/eaf8b7675ea3989cce9ecfe845c44e13c135d1d0", "html_url": "https://github.com/rust-lang/rust/commit/eaf8b7675ea3989cce9ecfe845c44e13c135d1d0"}], "stats": {"total": 23, "additions": 21, "deletions": 2}, "files": [{"sha": "784044a2df0e25e0fa5e55fe726d3542b5151ed6", "filename": "src/libsyntax/parse/parser.rs", "status": "modified", "additions": 21, "deletions": 2, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/6247a529e3af664f885ac0bb05bf6be2c102ec6a/src%2Flibsyntax%2Fparse%2Fparser.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6247a529e3af664f885ac0bb05bf6be2c102ec6a/src%2Flibsyntax%2Fparse%2Fparser.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fparse%2Fparser.rs?ref=6247a529e3af664f885ac0bb05bf6be2c102ec6a", "patch": "@@ -1696,14 +1696,33 @@ class parser {\n           token::AT {\n             self.bump();\n             let sub = self.parse_pat();\n-            pat = pat_box(sub);\n             hi = sub.span.hi;\n+            // HACK: parse @\"...\" as a literal of a vstore @str\n+            pat = alt sub.node {\n+              pat_lit(e@@{node: expr_lit(@{node: lit_str(_), span: _}), _}) {\n+                let vst = @{id: self.get_id(), callee_id: self.get_id(),\n+                            node: expr_vstore(e, vstore_box),\n+                            span: mk_sp(lo, hi)};\n+                pat_lit(vst)\n+              }\n+              _ { pat_box(sub) }\n+            };\n           }\n           token::TILDE {\n             self.bump();\n             let sub = self.parse_pat();\n-            pat = pat_uniq(sub);\n             hi = sub.span.hi;\n+            // HACK: parse ~\"...\" as a literal of a vstore ~str\n+            pat = alt sub.node {\n+              pat_lit(e@@{node: expr_lit(@{node: lit_str(_), span: _}), _}) {\n+                let vst = @{id: self.get_id(), callee_id: self.get_id(),\n+                            node: expr_vstore(e, vstore_uniq),\n+                            span: mk_sp(lo, hi)};\n+                pat_lit(vst)\n+              }\n+              _ { pat_uniq(sub) }\n+            };\n+\n           }\n           token::LBRACE {\n             self.bump();"}]}