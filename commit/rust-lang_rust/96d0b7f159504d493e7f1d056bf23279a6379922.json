{"sha": "96d0b7f159504d493e7f1d056bf23279a6379922", "node_id": "C_kwDOAAsO6NoAKDk2ZDBiN2YxNTk1MDRkNDkzZTdmMWQwNTZiZjIzMjc5YTYzNzk5MjI", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-11-21T23:01:11Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-11-21T23:01:11Z"}, "message": "Rollup merge of #104666 - GuillaumeGomez:migrate-alias-search-result, r=notriddle\n\nMigrate alias search result to CSS variables\n\nr? `@notriddle`", "tree": {"sha": "49434f53a4e9b6257c54d98413f66d7e0a08552d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/49434f53a4e9b6257c54d98413f66d7e0a08552d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/96d0b7f159504d493e7f1d056bf23279a6379922", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjfAM3CRBK7hj4Ov3rIwAA73YIADlQFkFRYWQhpa5ARW45+tEh\niJL1SmJ/jz9eoRbFPT20odlsjZ1+GvPGTYsFLRyA3tcXSHOzfTN48Aqu29mPZXxn\nt8JtBZxo3nai/iPXjcqvDCdsDGf9JorRvg1WUAHjYYYLX1m/tn6AO6N2BRmAem7k\nqHNdwwiuX5uXL9eOo3Bblsa8nUuf93t3ar7bvdGOOpJ0x5Y6/vKr6G4QpZ0iKBWQ\nXIvy3UNuPQMoepQHcsfaAyEhVxw66h/EHxC9kv2E8jrbS3VBG0r9Mk8Mbs1ZndL8\nX7RHmQXtpc1zatEkGJLEjFB1bk2salWF1aryjOoC+4NusZRfe1NFHMNqyGq1cjE=\n=HRNb\n-----END PGP SIGNATURE-----\n", "payload": "tree 49434f53a4e9b6257c54d98413f66d7e0a08552d\nparent 78cbe9ce84775c3fa73ac4735aa3ef99b8fa5656\nparent 90d7beb624324bd60d52260bd301689fdac84504\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1669071671 +0100\ncommitter GitHub <noreply@github.com> 1669071671 +0100\n\nRollup merge of #104666 - GuillaumeGomez:migrate-alias-search-result, r=notriddle\n\nMigrate alias search result to CSS variables\n\nr? `@notriddle`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/96d0b7f159504d493e7f1d056bf23279a6379922", "html_url": "https://github.com/rust-lang/rust/commit/96d0b7f159504d493e7f1d056bf23279a6379922", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/96d0b7f159504d493e7f1d056bf23279a6379922/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "78cbe9ce84775c3fa73ac4735aa3ef99b8fa5656", "url": "https://api.github.com/repos/rust-lang/rust/commits/78cbe9ce84775c3fa73ac4735aa3ef99b8fa5656", "html_url": "https://github.com/rust-lang/rust/commit/78cbe9ce84775c3fa73ac4735aa3ef99b8fa5656"}, {"sha": "90d7beb624324bd60d52260bd301689fdac84504", "url": "https://api.github.com/repos/rust-lang/rust/commits/90d7beb624324bd60d52260bd301689fdac84504", "html_url": "https://github.com/rust-lang/rust/commit/90d7beb624324bd60d52260bd301689fdac84504"}], "stats": {"total": 93, "additions": 52, "deletions": 41}, "files": [{"sha": "2335f3ff1ce96a3c3026f900c5c11c5708c45a9f", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/96d0b7f159504d493e7f1d056bf23279a6379922/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/96d0b7f159504d493e7f1d056bf23279a6379922/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=96d0b7f159504d493e7f1d056bf23279a6379922", "patch": "@@ -907,6 +907,13 @@ so that we can apply CSS-filters to change the arrow color in themes */\n \tbackground-color: var(--search-result-link-focus-background-color);\n }\n \n+.search-results .result-name span.alias {\n+\tcolor: var(--search-results-alias-color);\n+}\n+.search-results .result-name span.grey {\n+\tcolor: var(--search-results-grey-color);\n+}\n+\n .popover {\n \tposition: absolute;\n \tright: 0;"}, {"sha": "eb66377670c6bc1b8c2b3f7134a8a3e9383b0ad6", "filename": "src/librustdoc/html/static/css/themes/ayu.css", "status": "modified", "additions": 3, "deletions": 8, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/96d0b7f159504d493e7f1d056bf23279a6379922/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "raw_url": "https://github.com/rust-lang/rust/raw/96d0b7f159504d493e7f1d056bf23279a6379922/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css?ref=96d0b7f159504d493e7f1d056bf23279a6379922", "patch": "@@ -41,9 +41,11 @@ Original by Dempfi (https://github.com/dempfi/ayu)\n \t--sidebar-current-link-background-color: transparent;\n \t--search-result-link-focus-background-color: #3c3c3c;\n \t--search-result-border-color: #aaa3;\n+\t--search-color: #fff;\n+\t--search-results-alias-color: #c5c5c5;\n+\t--search-results-grey-color: #999;\n \t--stab-background-color: #314559;\n \t--stab-code-color: #e6e1cf;\n-\t--search-color: #fff;\n \t--code-highlight-kw-color: #ff7733;\n \t--code-highlight-kw-2-color: #ff7733;\n \t--code-highlight-lifetime-color: #ff7733;\n@@ -202,13 +204,6 @@ pre.rust .kw-2, pre.rust .prelude-ty {}\n \tfilter: invert(100);\n }\n \n-.search-results .result-name span.alias {\n-\tcolor: #c5c5c5;\n-}\n-.search-results .result-name span.grey {\n-\tcolor: #999;\n-}\n-\n #source-sidebar > .title {\n \tcolor: #fff;\n }"}, {"sha": "44598a6b77866b142f68498840c095064ee96eb2", "filename": "src/librustdoc/html/static/css/themes/dark.css", "status": "modified", "additions": 3, "deletions": 8, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/96d0b7f159504d493e7f1d056bf23279a6379922/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/96d0b7f159504d493e7f1d056bf23279a6379922/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css?ref=96d0b7f159504d493e7f1d056bf23279a6379922", "patch": "@@ -36,9 +36,11 @@\n \t--sidebar-current-link-background-color: #444;\n \t--search-result-link-focus-background-color: #616161;\n \t--search-result-border-color: #aaa3;\n+\t--search-color: #111;\n+\t--search-results-alias-color: #fff;\n+\t--search-results-grey-color: #ccc;\n \t--stab-background-color: #314559;\n \t--stab-code-color: #e6e1cf;\n-\t--search-color: #111;\n \t--code-highlight-kw-color: #ab8ac1;\n \t--code-highlight-kw-2-color: #769acb;\n \t--code-highlight-lifetime-color: #d97f26;\n@@ -103,13 +105,6 @@ details.rustdoc-toggle > summary::before {\n \tcolor: #888;\n }\n \n-.search-results .result-name span.alias {\n-\tcolor: #fff;\n-}\n-.search-results .result-name span.grey {\n-\tcolor: #ccc;\n-}\n-\n #source-sidebar div.files > a:hover, details.dir-entry summary:hover,\n #source-sidebar div.files > a:focus, details.dir-entry summary:focus {\n \tbackground-color: #444;"}, {"sha": "f0db14fd59f53aa82e19862ba991b2811259edf3", "filename": "src/librustdoc/html/static/css/themes/light.css", "status": "modified", "additions": 3, "deletions": 8, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/96d0b7f159504d493e7f1d056bf23279a6379922/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "raw_url": "https://github.com/rust-lang/rust/raw/96d0b7f159504d493e7f1d056bf23279a6379922/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css?ref=96d0b7f159504d493e7f1d056bf23279a6379922", "patch": "@@ -36,9 +36,11 @@\n \t--sidebar-current-link-background-color: #fff;\n \t--search-result-link-focus-background-color: #ccc;\n \t--search-result-border-color: #aaa3;\n+\t--search-color: #000;\n+\t--search-results-alias-color: #000;\n+\t--search-results-grey-color: #999;\n \t--stab-background-color: #fff5d6;\n \t--stab-code-color: #000;\n-\t--search-color: #000;\n \t--code-highlight-kw-color: #8959a8;\n \t--code-highlight-kw-2-color: #4271ae;\n \t--code-highlight-lifetime-color: #b76514;\n@@ -96,13 +98,6 @@ body.source .example-wrap pre.rust a {\n \tcolor: #888;\n }\n \n-.search-results .result-name span.alias {\n-\tcolor: #000;\n-}\n-.search-results .result-name span.grey {\n-\tcolor: #999;\n-}\n-\n #source-sidebar div.files > a:hover, details.dir-entry summary:hover,\n #source-sidebar div.files > a:focus, details.dir-entry summary:focus {\n \tbackground-color: #E0E0E0;"}, {"sha": "dde43b1c980af213c641f351bdcb5cdf76481493", "filename": "src/test/rustdoc-gui/search-result-color.goml", "status": "modified", "additions": 36, "deletions": 17, "changes": 53, "blob_url": "https://github.com/rust-lang/rust/blob/96d0b7f159504d493e7f1d056bf23279a6379922/src%2Ftest%2Frustdoc-gui%2Fsearch-result-color.goml", "raw_url": "https://github.com/rust-lang/rust/raw/96d0b7f159504d493e7f1d056bf23279a6379922/src%2Ftest%2Frustdoc-gui%2Fsearch-result-color.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsearch-result-color.goml?ref=96d0b7f159504d493e7f1d056bf23279a6379922", "patch": "@@ -366,23 +366,42 @@ assert-css: (\n     {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n )\n \n-// Check the alias more specifically in the dark theme.\n+// Check the alias.\n goto: \"file://\" + |DOC_PATH| + \"/test_docs/index.html\"\n-// We set the theme so we're sure that the correct values will be used, whatever the computer\n-// this test is running on.\n-local-storage: {\n-    \"rustdoc-theme\": \"dark\",\n-    \"rustdoc-use-system-theme\": \"false\",\n-}\n // If the text isn't displayed, the browser doesn't compute color style correctly...\n show-text: true\n-// We reload the page so the local storage settings are being used.\n-reload:\n-write: (\".search-input\", \"thisisanalias\")\n-// To be SURE that the search will be run.\n-press-key: 'Enter'\n-// Waiting for the search results to appear...\n-wait-for: \"#titles\"\n-// Checking that the colors for the alias element are the ones expected.\n-assert-css: (\".result-name > .alias\", {\"color\": \"rgb(255, 255, 255)\"})\n-assert-css: (\".result-name > .alias > .grey\", {\"color\": \"rgb(204, 204, 204)\"})\n+\n+define-function: (\n+    \"check-alias\",\n+    (theme, alias, grey),\n+    [\n+        (\"local-storage\", {\"rustdoc-theme\": |theme|, \"rustdoc-use-system-theme\": \"false\"}),\n+        (\"reload\"),\n+        (\"write\", (\".search-input\", \"thisisanalias\")),\n+        // To be SURE that the search will be run.\n+        (\"press-key\", 'Enter'),\n+        // Waiting for the search results to appear...\n+        (\"wait-for\", \"#titles\"),\n+        // Checking that the colors for the alias element are the ones expected.\n+        (\"assert-css\", (\".result-name > .alias\", {\"color\": |alias|})),\n+        (\"assert-css\", (\".result-name > .alias > .grey\", {\"color\": |grey|})),\n+        // Leave the search results to prevent reloading with an already filled search input.\n+        (\"press-key\", \"Escape\"),\n+    ],\n+)\n+\n+call-function: (\"check-alias\", {\n+    \"theme\": \"ayu\",\n+    \"alias\": \"rgb(197, 197, 197)\",\n+    \"grey\": \"rgb(153, 153, 153)\",\n+})\n+call-function: (\"check-alias\", {\n+    \"theme\": \"dark\",\n+    \"alias\": \"rgb(255, 255, 255)\",\n+    \"grey\": \"rgb(204, 204, 204)\",\n+})\n+call-function: (\"check-alias\", {\n+    \"theme\": \"light\",\n+    \"alias\": \"rgb(0, 0, 0)\",\n+    \"grey\": \"rgb(153, 153, 153)\",\n+})"}]}