{"sha": "7bb9353dd56a738e7a85bf852ad58d552a07c4e9", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdiYjkzNTNkZDU2YTczOGU3YTg1YmY4NTJhZDU4ZDU1MmEwN2M0ZTk=", "commit": {"author": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2017-10-27T12:31:18Z"}, "committer": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2017-11-07T07:54:38Z"}, "message": "Update codegen-unit tests.", "tree": {"sha": "78ddd377b7f2bc8213c786bdb4c8a8aae8186148", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/78ddd377b7f2bc8213c786bdb4c8a8aae8186148"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7bb9353dd56a738e7a85bf852ad58d552a07c4e9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7bb9353dd56a738e7a85bf852ad58d552a07c4e9", "html_url": "https://github.com/rust-lang/rust/commit/7bb9353dd56a738e7a85bf852ad58d552a07c4e9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7bb9353dd56a738e7a85bf852ad58d552a07c4e9/comments", "author": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "committer": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b61ee5180c3e4cd5b5112995ba2d66b6ab6831f3", "url": "https://api.github.com/repos/rust-lang/rust/commits/b61ee5180c3e4cd5b5112995ba2d66b6ab6831f3", "html_url": "https://github.com/rust-lang/rust/commit/b61ee5180c3e4cd5b5112995ba2d66b6ab6831f3"}], "stats": {"total": 94, "additions": 47, "deletions": 47}, "files": [{"sha": "da96c5e183d79361a9c85938391b87ba00be6de7", "filename": "src/test/codegen-units/partitioning/extern-drop-glue.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/7bb9353dd56a738e7a85bf852ad58d552a07c4e9/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fextern-drop-glue.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7bb9353dd56a738e7a85bf852ad58d552a07c4e9/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fextern-drop-glue.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fextern-drop-glue.rs?ref=7bb9353dd56a738e7a85bf852ad58d552a07c4e9", "patch": "@@ -16,7 +16,7 @@\n // compile-flags:-Zinline-in-all-cgus\n \n #![allow(dead_code)]\n-#![crate_type=\"lib\"]\n+#![crate_type=\"rlib\"]\n \n // aux-build:cgu_extern_drop_glue.rs\n extern crate cgu_extern_drop_glue;\n@@ -25,20 +25,20 @@ extern crate cgu_extern_drop_glue;\n \n struct LocalStruct(cgu_extern_drop_glue::Struct);\n \n-//~ TRANS_ITEM fn extern_drop_glue::user[0] @@ extern_drop_glue[Internal]\n-fn user()\n+//~ TRANS_ITEM fn extern_drop_glue::user[0] @@ extern_drop_glue[External]\n+pub fn user()\n {\n     //~ TRANS_ITEM fn core::ptr[0]::drop_in_place[0]<extern_drop_glue::LocalStruct[0]> @@ extern_drop_glue[Internal]\n     let _ = LocalStruct(cgu_extern_drop_glue::Struct(0));\n }\n \n-mod mod1 {\n+pub mod mod1 {\n     use cgu_extern_drop_glue;\n \n     struct LocalStruct(cgu_extern_drop_glue::Struct);\n \n-    //~ TRANS_ITEM fn extern_drop_glue::mod1[0]::user[0] @@ extern_drop_glue-mod1[Internal]\n-    fn user()\n+    //~ TRANS_ITEM fn extern_drop_glue::mod1[0]::user[0] @@ extern_drop_glue-mod1[External]\n+    pub fn user()\n     {\n         //~ TRANS_ITEM fn core::ptr[0]::drop_in_place[0]<extern_drop_glue::mod1[0]::LocalStruct[0]> @@ extern_drop_glue-mod1[Internal]\n         let _ = LocalStruct(cgu_extern_drop_glue::Struct(0));"}, {"sha": "01600c03ba2cd1af648ba940c07fa043934720c2", "filename": "src/test/codegen-units/partitioning/inlining-from-extern-crate.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/7bb9353dd56a738e7a85bf852ad58d552a07c4e9/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Finlining-from-extern-crate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7bb9353dd56a738e7a85bf852ad58d552a07c4e9/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Finlining-from-extern-crate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Finlining-from-extern-crate.rs?ref=7bb9353dd56a738e7a85bf852ad58d552a07c4e9", "patch": "@@ -35,10 +35,10 @@ pub fn user()\n     cgu_explicit_inlining::never_inlined();\n }\n \n-mod mod1 {\n+pub mod mod1 {\n     use cgu_explicit_inlining;\n \n-    //~ TRANS_ITEM fn inlining_from_extern_crate::mod1[0]::user[0] @@ inlining_from_extern_crate-mod1[Internal]\n+    //~ TRANS_ITEM fn inlining_from_extern_crate::mod1[0]::user[0] @@ inlining_from_extern_crate-mod1[External]\n     pub fn user()\n     {\n         cgu_explicit_inlining::inlined();\n@@ -48,10 +48,10 @@ mod mod1 {\n     }\n }\n \n-mod mod2 {\n+pub mod mod2 {\n     use cgu_explicit_inlining;\n \n-    //~ TRANS_ITEM fn inlining_from_extern_crate::mod2[0]::user[0] @@ inlining_from_extern_crate-mod2[Internal]\n+    //~ TRANS_ITEM fn inlining_from_extern_crate::mod2[0]::user[0] @@ inlining_from_extern_crate-mod2[External]\n     pub fn user()\n     {\n         cgu_explicit_inlining::always_inlined();"}, {"sha": "f7c05285ed63c7823e0c40ae2f965c2e5beb38db", "filename": "src/test/codegen-units/partitioning/local-drop-glue.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/7bb9353dd56a738e7a85bf852ad58d552a07c4e9/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-drop-glue.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7bb9353dd56a738e7a85bf852ad58d552a07c4e9/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-drop-glue.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-drop-glue.rs?ref=7bb9353dd56a738e7a85bf852ad58d552a07c4e9", "patch": "@@ -15,7 +15,7 @@\n // compile-flags:-Zinline-in-all-cgus\n \n #![allow(dead_code)]\n-#![crate_type=\"lib\"]\n+#![crate_type=\"rlib\"]\n \n //~ TRANS_ITEM fn core::ptr[0]::drop_in_place[0]<local_drop_glue::Struct[0]> @@ local_drop_glue[Internal] local_drop_glue-mod1[Internal]\n struct Struct {\n@@ -32,8 +32,8 @@ struct Outer {\n     _a: Struct\n }\n \n-//~ TRANS_ITEM fn local_drop_glue::user[0] @@ local_drop_glue[Internal]\n-fn user()\n+//~ TRANS_ITEM fn local_drop_glue::user[0] @@ local_drop_glue[External]\n+pub fn user()\n {\n     let _ = Outer {\n         _a: Struct {\n@@ -42,7 +42,7 @@ fn user()\n     };\n }\n \n-mod mod1\n+pub mod mod1\n {\n     use super::Struct;\n \n@@ -53,8 +53,8 @@ mod mod1\n         _b: (u32, Struct),\n     }\n \n-    //~ TRANS_ITEM fn local_drop_glue::mod1[0]::user[0] @@ local_drop_glue-mod1[Internal]\n-    fn user()\n+    //~ TRANS_ITEM fn local_drop_glue::mod1[0]::user[0] @@ local_drop_glue-mod1[External]\n+    pub fn user()\n     {\n         let _ = Struct2 {\n             _a: Struct { _a: 0 },"}, {"sha": "cf197301eec16e151d7bd36fe9e7e5d2217e71fe", "filename": "src/test/codegen-units/partitioning/local-inlining-but-not-all.rs", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/7bb9353dd56a738e7a85bf852ad58d552a07c4e9/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-inlining-but-not-all.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7bb9353dd56a738e7a85bf852ad58d552a07c4e9/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-inlining-but-not-all.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-inlining-but-not-all.rs?ref=7bb9353dd56a738e7a85bf852ad58d552a07c4e9", "patch": "@@ -27,28 +27,28 @@ mod inline {\n     }\n }\n \n-mod user1 {\n+pub mod user1 {\n     use super::inline;\n \n-    //~ TRANS_ITEM fn local_inlining_but_not_all::user1[0]::foo[0] @@ local_inlining_but_not_all-user1[Internal]\n-    fn foo() {\n+    //~ TRANS_ITEM fn local_inlining_but_not_all::user1[0]::foo[0] @@ local_inlining_but_not_all-user1[External]\n+    pub fn foo() {\n         inline::inlined_function();\n     }\n }\n \n-mod user2 {\n+pub mod user2 {\n     use super::inline;\n \n-    //~ TRANS_ITEM fn local_inlining_but_not_all::user2[0]::bar[0] @@ local_inlining_but_not_all-user2[Internal]\n-    fn bar() {\n+    //~ TRANS_ITEM fn local_inlining_but_not_all::user2[0]::bar[0] @@ local_inlining_but_not_all-user2[External]\n+    pub fn bar() {\n         inline::inlined_function();\n     }\n }\n \n-mod non_user {\n+pub mod non_user {\n \n-    //~ TRANS_ITEM fn local_inlining_but_not_all::non_user[0]::baz[0] @@ local_inlining_but_not_all-non_user[Internal]\n-    fn baz() {\n+    //~ TRANS_ITEM fn local_inlining_but_not_all::non_user[0]::baz[0] @@ local_inlining_but_not_all-non_user[External]\n+    pub fn baz() {\n \n     }\n }"}, {"sha": "3502aa59fdccc48a20f59e062be8b246738e5af2", "filename": "src/test/codegen-units/partitioning/local-inlining.rs", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/7bb9353dd56a738e7a85bf852ad58d552a07c4e9/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-inlining.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7bb9353dd56a738e7a85bf852ad58d552a07c4e9/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-inlining.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-inlining.rs?ref=7bb9353dd56a738e7a85bf852ad58d552a07c4e9", "patch": "@@ -28,28 +28,28 @@ mod inline {\n     }\n }\n \n-mod user1 {\n+pub mod user1 {\n     use super::inline;\n \n-    //~ TRANS_ITEM fn local_inlining::user1[0]::foo[0] @@ local_inlining-user1[Internal]\n-    fn foo() {\n+    //~ TRANS_ITEM fn local_inlining::user1[0]::foo[0] @@ local_inlining-user1[External]\n+    pub fn foo() {\n         inline::inlined_function();\n     }\n }\n \n-mod user2 {\n+pub mod user2 {\n     use super::inline;\n \n-    //~ TRANS_ITEM fn local_inlining::user2[0]::bar[0] @@ local_inlining-user2[Internal]\n-    fn bar() {\n+    //~ TRANS_ITEM fn local_inlining::user2[0]::bar[0] @@ local_inlining-user2[External]\n+    pub fn bar() {\n         inline::inlined_function();\n     }\n }\n \n-mod non_user {\n+pub mod non_user {\n \n-    //~ TRANS_ITEM fn local_inlining::non_user[0]::baz[0] @@ local_inlining-non_user[Internal]\n-    fn baz() {\n+    //~ TRANS_ITEM fn local_inlining::non_user[0]::baz[0] @@ local_inlining-non_user[External]\n+    pub fn baz() {\n \n     }\n }"}, {"sha": "ed883954f3f40e35a5173ea6c0f14e11d52e6ac0", "filename": "src/test/codegen-units/partitioning/local-transitive-inlining.rs", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/7bb9353dd56a738e7a85bf852ad58d552a07c4e9/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-transitive-inlining.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7bb9353dd56a738e7a85bf852ad58d552a07c4e9/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-transitive-inlining.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Flocal-transitive-inlining.rs?ref=7bb9353dd56a738e7a85bf852ad58d552a07c4e9", "patch": "@@ -15,7 +15,7 @@\n // compile-flags:-Zinline-in-all-cgus\n \n #![allow(dead_code)]\n-#![crate_type=\"lib\"]\n+#![crate_type=\"rlib\"]\n \n mod inline {\n \n@@ -37,19 +37,19 @@ mod direct_user {\n     }\n }\n \n-mod indirect_user {\n+pub mod indirect_user {\n     use super::direct_user;\n \n-    //~ TRANS_ITEM fn local_transitive_inlining::indirect_user[0]::bar[0] @@ local_transitive_inlining-indirect_user[Internal]\n-    fn bar() {\n+    //~ TRANS_ITEM fn local_transitive_inlining::indirect_user[0]::bar[0] @@ local_transitive_inlining-indirect_user[External]\n+    pub fn bar() {\n         direct_user::foo();\n     }\n }\n \n-mod non_user {\n+pub mod non_user {\n \n-    //~ TRANS_ITEM fn local_transitive_inlining::non_user[0]::baz[0] @@ local_transitive_inlining-non_user[Internal]\n-    fn baz() {\n+    //~ TRANS_ITEM fn local_transitive_inlining::non_user[0]::baz[0] @@ local_transitive_inlining-non_user[External]\n+    pub fn baz() {\n \n     }\n }"}, {"sha": "12ef34441ff394c023837fb0c0a68c1ffa143d13", "filename": "src/test/codegen-units/partitioning/statics.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/7bb9353dd56a738e7a85bf852ad58d552a07c4e9/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fstatics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7bb9353dd56a738e7a85bf852ad58d552a07c4e9/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fstatics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen-units%2Fpartitioning%2Fstatics.rs?ref=7bb9353dd56a738e7a85bf852ad58d552a07c4e9", "patch": "@@ -13,32 +13,32 @@\n // incremental compilation\n // compile-flags:-Zprint-trans-items=lazy -Zincremental=tmp/partitioning-tests/statics\n \n-#![crate_type=\"lib\"]\n+#![crate_type=\"rlib\"]\n \n //~ TRANS_ITEM static statics::FOO[0] @@ statics[Internal]\n static FOO: u32 = 0;\n \n //~ TRANS_ITEM static statics::BAR[0] @@ statics[Internal]\n static BAR: u32 = 0;\n \n-//~ TRANS_ITEM fn statics::function[0] @@ statics[Internal]\n-fn function() {\n+//~ TRANS_ITEM fn statics::function[0] @@ statics[External]\n+pub fn function() {\n     //~ TRANS_ITEM static statics::function[0]::FOO[0] @@ statics[Internal]\n     static FOO: u32 = 0;\n \n     //~ TRANS_ITEM static statics::function[0]::BAR[0] @@ statics[Internal]\n     static BAR: u32 = 0;\n }\n \n-mod mod1 {\n+pub mod mod1 {\n     //~ TRANS_ITEM static statics::mod1[0]::FOO[0] @@ statics-mod1[Internal]\n     static FOO: u32 = 0;\n \n     //~ TRANS_ITEM static statics::mod1[0]::BAR[0] @@ statics-mod1[Internal]\n     static BAR: u32 = 0;\n \n-    //~ TRANS_ITEM fn statics::mod1[0]::function[0] @@ statics-mod1[Internal]\n-    fn function() {\n+    //~ TRANS_ITEM fn statics::mod1[0]::function[0] @@ statics-mod1[External]\n+    pub fn function() {\n         //~ TRANS_ITEM static statics::mod1[0]::function[0]::FOO[0] @@ statics-mod1[Internal]\n         static FOO: u32 = 0;\n "}]}