{"sha": "4e1bc7e695cb412fa77fe17b5380b0244e9a70b9", "node_id": "C_kwDOAAsO6NoAKDRlMWJjN2U2OTVjYjQxMmZhNzdmZTE3YjUzODBiMDI0NGU5YTcwYjk", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-08-12T15:26:53Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-08-12T15:26:53Z"}, "message": "Auto merge of #2482 - RalfJung:raw-eq, r=RalfJung\n\nadd test for raw_eq on a pointer\n\nLet's make sure this keeps erroring; I have plans to refactor that part of the interpreter which will fix the error message (but could also lead to us accidentally accepting this which this test is there to avoid).", "tree": {"sha": "0e54ff4d57b9c0c2d88af0398c5d4655d807afb6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0e54ff4d57b9c0c2d88af0398c5d4655d807afb6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4e1bc7e695cb412fa77fe17b5380b0244e9a70b9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4e1bc7e695cb412fa77fe17b5380b0244e9a70b9", "html_url": "https://github.com/rust-lang/rust/commit/4e1bc7e695cb412fa77fe17b5380b0244e9a70b9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4e1bc7e695cb412fa77fe17b5380b0244e9a70b9/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "403b3f94bbb2717ca7f06cdc5cf79bdaccf6b577", "url": "https://api.github.com/repos/rust-lang/rust/commits/403b3f94bbb2717ca7f06cdc5cf79bdaccf6b577", "html_url": "https://github.com/rust-lang/rust/commit/403b3f94bbb2717ca7f06cdc5cf79bdaccf6b577"}, {"sha": "74e87b1dc573c2488c6cd319216f08b0c39d7e6f", "url": "https://api.github.com/repos/rust-lang/rust/commits/74e87b1dc573c2488c6cd319216f08b0c39d7e6f", "html_url": "https://github.com/rust-lang/rust/commit/74e87b1dc573c2488c6cd319216f08b0c39d7e6f"}], "stats": {"total": 25, "additions": 25, "deletions": 0}, "files": [{"sha": "675b7cf9224bdfddbe75b5f17fdc228f8b9e74a0", "filename": "tests/fail/intrinsics/raw_eq_on_ptr.rs", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/4e1bc7e695cb412fa77fe17b5380b0244e9a70b9/tests%2Ffail%2Fintrinsics%2Fraw_eq_on_ptr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4e1bc7e695cb412fa77fe17b5380b0244e9a70b9/tests%2Ffail%2Fintrinsics%2Fraw_eq_on_ptr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ffail%2Fintrinsics%2Fraw_eq_on_ptr.rs?ref=4e1bc7e695cb412fa77fe17b5380b0244e9a70b9", "patch": "@@ -0,0 +1,11 @@\n+#![feature(intrinsics)]\n+\n+extern \"rust-intrinsic\" {\n+    fn raw_eq<T>(a: &T, b: &T) -> bool;\n+}\n+\n+fn main() {\n+    let x = &0;\n+    // FIXME: the error message is not great (should be UB rather than 'unsupported')\n+    unsafe { raw_eq(&x, &x) }; //~ERROR: unsupported operation\n+}"}, {"sha": "6c5e618315c80d1a2e7dea86f52c759548047a84", "filename": "tests/fail/intrinsics/raw_eq_on_ptr.stderr", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/4e1bc7e695cb412fa77fe17b5380b0244e9a70b9/tests%2Ffail%2Fintrinsics%2Fraw_eq_on_ptr.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/4e1bc7e695cb412fa77fe17b5380b0244e9a70b9/tests%2Ffail%2Fintrinsics%2Fraw_eq_on_ptr.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ffail%2Fintrinsics%2Fraw_eq_on_ptr.stderr?ref=4e1bc7e695cb412fa77fe17b5380b0244e9a70b9", "patch": "@@ -0,0 +1,14 @@\n+error: unsupported operation: unable to turn pointer into raw bytes\n+  --> $DIR/raw_eq_on_ptr.rs:LL:CC\n+   |\n+LL |     unsafe { raw_eq(&x, &x) };\n+   |              ^^^^^^^^^^^^^^ unable to turn pointer into raw bytes\n+   |\n+   = help: this is likely not a bug in the program; it indicates that the program performed an operation that the interpreter does not support\n+   = note: backtrace:\n+   = note: inside `main` at $DIR/raw_eq_on_ptr.rs:LL:CC\n+\n+note: some details are omitted, run with `MIRIFLAGS=-Zmiri-backtrace=full` for a verbose backtrace\n+\n+error: aborting due to previous error\n+"}]}