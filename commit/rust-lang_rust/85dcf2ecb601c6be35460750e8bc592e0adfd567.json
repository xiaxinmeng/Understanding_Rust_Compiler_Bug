{"sha": "85dcf2ecb601c6be35460750e8bc592e0adfd567", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg1ZGNmMmVjYjYwMWM2YmUzNTQ2MDc1MGU4YmM1OTJlMGFkZmQ1Njc=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2017-11-16T00:28:09Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2017-11-17T21:50:15Z"}, "message": "Improve modal display and add JS events", "tree": {"sha": "9a0d77f184a9095233a5e5dcd7fc86ef6389194a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9a0d77f184a9095233a5e5dcd7fc86ef6389194a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/85dcf2ecb601c6be35460750e8bc592e0adfd567", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/85dcf2ecb601c6be35460750e8bc592e0adfd567", "html_url": "https://github.com/rust-lang/rust/commit/85dcf2ecb601c6be35460750e8bc592e0adfd567", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/85dcf2ecb601c6be35460750e8bc592e0adfd567/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "aca1bd7d7ed90febe83508d2e0b93b6d99da26fb", "url": "https://api.github.com/repos/rust-lang/rust/commits/aca1bd7d7ed90febe83508d2e0b93b6d99da26fb", "html_url": "https://github.com/rust-lang/rust/commit/aca1bd7d7ed90febe83508d2e0b93b6d99da26fb"}], "stats": {"total": 107, "additions": 89, "deletions": 18}, "files": [{"sha": "dc83b3da4903dc4ab70d6a8b2cee54620059bba2", "filename": "src/librustdoc/html/render.rs", "status": "modified", "additions": 6, "deletions": 11, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/85dcf2ecb601c6be35460750e8bc592e0adfd567/src%2Flibrustdoc%2Fhtml%2Frender.rs", "raw_url": "https://github.com/rust-lang/rust/raw/85dcf2ecb601c6be35460750e8bc592e0adfd567/src%2Flibrustdoc%2Fhtml%2Frender.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender.rs?ref=85dcf2ecb601c6be35460750e8bc592e0adfd567", "patch": "@@ -2266,15 +2266,10 @@ fn item_function(w: &mut fmt::Formatter, cx: &Context, it: &clean::Item,\n                            AbiSpace(f.abi),\n                            it.name.as_ref().unwrap(),\n                            f.generics).len();\n-    let mut extra = render_spotlight_traits(it)?;\n-    if !extra.is_empty() {\n-        extra.insert_str(0, \"<div class=\\\"important-traits\\\">\u24d8<div class=\\\"content hidden\\\">\");\n-        extra.push_str(\"</div></div>\");\n-    };\n-    write!(w, \"<pre class='rust fn'>\")?;\n+    write!(w, \"{}<pre class='rust fn'>\", render_spotlight_traits(it)?)?;\n     render_attributes(w, it)?;\n     write!(w, \"{vis}{constness}{unsafety}{abi}fn \\\n-               {name}{generics}{decl}{where_clause}</pre>{extra}\",\n+               {name}{generics}{decl}{where_clause}</pre>\",\n            vis = VisSpace(&it.visibility),\n            constness = ConstnessSpace(f.constness),\n            unsafety = UnsafetySpace(f.unsafety),\n@@ -2286,8 +2281,7 @@ fn item_function(w: &mut fmt::Formatter, cx: &Context, it: &clean::Item,\n                decl: &f.decl,\n                name_len,\n                indent: 0,\n-           },\n-           extra = extra)?;\n+           })?;\n     document(w, cx, it)\n }\n \n@@ -3269,8 +3263,9 @@ fn spotlight_decl(decl: &clean::FnDecl) -> Result<String, fmt::Error> {\n                 if impl_.trait_.def_id().and_then(|d| c.traits.get(&d))\n                                         .map_or(false, |t| t.is_spotlight) {\n                     if out.is_empty() {\n-                        out.push_str(\"<span class=\\\"docblock autohide\\\">\");\n-                        out.push_str(&format!(\"<h3>Important traits for {}</h3>\", impl_.for_));\n+                        out.push_str(\n+                            &format!(\"<h3 class=\\\"important\\\">Important traits for {}</h3>\",\n+                                     impl_.for_));\n                         out.push_str(\"<code class=\\\"content\\\">\");\n                     }\n "}, {"sha": "c3f2ec253087dbcc66c022191b1d08b29297b5a1", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 16, "deletions": 1, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/85dcf2ecb601c6be35460750e8bc592e0adfd567/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/85dcf2ecb601c6be35460750e8bc592e0adfd567/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=85dcf2ecb601c6be35460750e8bc592e0adfd567", "patch": "@@ -215,6 +215,7 @@\n         var help = document.getElementById(\"help\");\n         switch (getVirtualKey(ev)) {\n         case \"Escape\":\n+            hideModal();\n             var search = document.getElementById(\"search\");\n             if (!hasClass(help, \"hidden\")) {\n                 displayHelp(false, ev);\n@@ -228,6 +229,7 @@\n         case \"s\":\n         case \"S\":\n             displayHelp(false, ev);\n+            hideModal();\n             ev.preventDefault();\n             focusSearchBar();\n             break;\n@@ -240,6 +242,7 @@\n \n         case \"?\":\n             if (ev.shiftKey) {\n+                hideModal();\n                 displayHelp(true, ev);\n             }\n             break;\n@@ -1715,9 +1718,21 @@\n \n     function showModal(content) {\n         var modal = document.createElement('div');\n+        modal.id = \"important\";\n         addClass(modal, 'modal');\n-        modal.innerHTML = '<div class=\"modal-content\">' + content + \"</div>\";\n+        modal.innerHTML = '<div class=\"modal-content\"><div class=\"close\" id=\"modal-close\">\u2715</div>' +\n+                          '<div class=\"whiter\"></div><span class=\"docblock\">' + content +\n+                          '</span></div>';\n         document.getElementsByTagName('body')[0].appendChild(modal);\n+        document.getElementById('modal-close').onclick = hideModal;\n+        modal.onclick = hideModal;\n+    }\n+\n+    function hideModal() {\n+        var modal = document.getElementById(\"important\");\n+        if (modal) {\n+            modal.parentNode.removeChild(modal);\n+        }\n     }\n \n     onEach(document.getElementsByClassName('important-traits'), function(e) {"}, {"sha": "89c75818ddf2a28a97572e58ee1e14959bd7f89d", "filename": "src/librustdoc/html/static/rustdoc.css", "status": "modified", "additions": 67, "deletions": 6, "changes": 73, "blob_url": "https://github.com/rust-lang/rust/blob/85dcf2ecb601c6be35460750e8bc592e0adfd567/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/85dcf2ecb601c6be35460750e8bc592e0adfd567/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Frustdoc.css?ref=85dcf2ecb601c6be35460750e8bc592e0adfd567", "patch": "@@ -89,7 +89,7 @@ h2 {\n h3 {\n \tfont-size: 1.3em;\n }\n-h1, h2, h3:not(.impl):not(.method):not(.type):not(.tymethod), h4:not(.method):not(.type):not(.tymethod):not(.associatedconstant) {\n+h1, h2, h3:not(.impl):not(.method):not(.type):not(.tymethod):not(.important), h4:not(.method):not(.type):not(.tymethod):not(.associatedconstant) {\n \tfont-weight: 500;\n \tmargin: 20px 0 15px 0;\n \tpadding-bottom: 6px;\n@@ -955,11 +955,14 @@ pre.rust {\n \tfont-size: 16px;\n }\n \n+.important-traits {\n+\tcursor: pointer;\n+}\n+\n h4 > .important-traits {\n \tposition: absolute;\n \tleft: -44px;\n \ttop: 2px;\n-\tcursor: pointer;\n }\n \n .modal {\n@@ -976,12 +979,70 @@ h4 > .important-traits {\n \tdisplay: block;\n \tmax-width: 60%;\n \tmin-width: 200px;\n-\tbackground-color: white;\n-\tpadding: 5px;\n-\ttop: 10%;\n+\tbackground-color: #eee;\n+\tpadding: 8px;\n+\ttop: 40%;\n \tposition: absolute;\n \tleft: 50%;\n-\ttransform: translate(-50%, -50%);\n+\ttransform: translate(-50%, -40%);\n \tborder: 1px solid #999;\n \tborder-radius: 4px;\n+\tborder-top-right-radius: 0;\n+}\n+\n+.modal-content > .docblock {\n+\tmargin: 0;\n+}\n+\n+h3.important {\n+\tmargin: 0;\n+\tmargin-bottom: 13px;\n+\tfont-size: 19px;\n+}\n+\n+.modal-content > .docblock > code.content {\n+\tmargin: 0;\n+\tpadding: 0;\n+\tfont-size: 20px;\n+}\n+\n+.modal-content > .close {\n+\tposition: absolute;\n+\tfont-weight: 900;\n+\tright: -25px;\n+\ttop: -1px;\n+\tfont-size: 18px;\n+\tbackground-color: #eee;\n+\twidth: 25px;\n+\tpadding-right: 2px;\n+\tborder-top-right-radius: 5px;\n+\tborder-bottom-right-radius: 5px;\n+\ttext-align: center;\n+\tborder: 1px solid #999;\n+\tborder-right: 0;\n+\tcursor: pointer;\n+}\n+\n+.modal-content > .close:hover {\n+\tbackground-color: #ff1f1f;\n+\tcolor: white;\n+}\n+\n+.modal-content > .whiter {\n+\theight: 25px;\n+\tposition: absolute;\n+\twidth: 3px;\n+\tbackground-color: #eee;\n+\tright: -2px;\n+\ttop: 0px;\n+}\n+\n+.modal-content > .close:hover + .whiter {\n+\tbackground-color: #ff1f1f;\n+}\n+\n+#main > div.important-traits {\n+\tposition: absolute;\n+\tleft: -24px;\n+\tmargin-top: 16px;\n }\n\\ No newline at end of file"}]}