{"sha": "0757d5f83f4bc4faca896c85932cf1e4a0cd6031", "node_id": "C_kwDOAAsO6NoAKDA3NTdkNWY4M2Y0YmM0ZmFjYTg5NmM4NTkzMmNmMWU0YTBjZDYwMzE", "commit": {"author": {"name": "Xiretza", "email": "xiretza@xiretza.xyz", "date": "2022-10-06T16:35:53Z"}, "committer": {"name": "Xiretza", "email": "xiretza@xiretza.xyz", "date": "2023-02-01T20:50:34Z"}, "message": "Fix condition for \"missing `struct`\" diagnostic on tuple structs\n\nThe check previously matched this, and suggested adding a missing\n`struct`:\n\npub Foo(...):\n\nIt was probably intended to match this instead (semicolon instead of\ncolon):\n\npub Foo(...);", "tree": {"sha": "a10dccb1ef78f9869c3fdcc87a647023cfa9a787", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a10dccb1ef78f9869c3fdcc87a647023cfa9a787"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0757d5f83f4bc4faca896c85932cf1e4a0cd6031", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0757d5f83f4bc4faca896c85932cf1e4a0cd6031", "html_url": "https://github.com/rust-lang/rust/commit/0757d5f83f4bc4faca896c85932cf1e4a0cd6031", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0757d5f83f4bc4faca896c85932cf1e4a0cd6031/comments", "author": {"login": "Xiretza", "id": 3107142, "node_id": "MDQ6VXNlcjMxMDcxNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3107142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Xiretza", "html_url": "https://github.com/Xiretza", "followers_url": "https://api.github.com/users/Xiretza/followers", "following_url": "https://api.github.com/users/Xiretza/following{/other_user}", "gists_url": "https://api.github.com/users/Xiretza/gists{/gist_id}", "starred_url": "https://api.github.com/users/Xiretza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Xiretza/subscriptions", "organizations_url": "https://api.github.com/users/Xiretza/orgs", "repos_url": "https://api.github.com/users/Xiretza/repos", "events_url": "https://api.github.com/users/Xiretza/events{/privacy}", "received_events_url": "https://api.github.com/users/Xiretza/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Xiretza", "id": 3107142, "node_id": "MDQ6VXNlcjMxMDcxNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3107142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Xiretza", "html_url": "https://github.com/Xiretza", "followers_url": "https://api.github.com/users/Xiretza/followers", "following_url": "https://api.github.com/users/Xiretza/following{/other_user}", "gists_url": "https://api.github.com/users/Xiretza/gists{/gist_id}", "starred_url": "https://api.github.com/users/Xiretza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Xiretza/subscriptions", "organizations_url": "https://api.github.com/users/Xiretza/orgs", "repos_url": "https://api.github.com/users/Xiretza/repos", "events_url": "https://api.github.com/users/Xiretza/events{/privacy}", "received_events_url": "https://api.github.com/users/Xiretza/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a84adba55239b5bfa702ee4937a7f14b36aab181", "url": "https://api.github.com/repos/rust-lang/rust/commits/a84adba55239b5bfa702ee4937a7f14b36aab181", "html_url": "https://github.com/rust-lang/rust/commit/a84adba55239b5bfa702ee4937a7f14b36aab181"}], "stats": {"total": 49, "additions": 42, "deletions": 7}, "files": [{"sha": "32ffc9306f21bc6870de1bdbc7b9ac03889cfabb", "filename": "compiler/rustc_parse/src/parser/item.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0757d5f83f4bc4faca896c85932cf1e4a0cd6031/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fitem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0757d5f83f4bc4faca896c85932cf1e4a0cd6031/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fitem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fitem.rs?ref=0757d5f83f4bc4faca896c85932cf1e4a0cd6031", "patch": "@@ -412,7 +412,7 @@ impl<'a> Parser<'a> {\n             } else if self.check(&token::OpenDelim(Delimiter::Brace)) {\n                 self.bump(); // `{`\n                 (\"fn\", kw_name, false)\n-            } else if self.check(&token::Colon) {\n+            } else if self.check(&token::Semi) {\n                 let kw = \"struct\";\n                 (kw, kw, false)\n             } else {"}, {"sha": "50db4039d4fc114b3a020eabc761300b2ffc6f81", "filename": "tests/ui/pub/pub-ident-fn-3.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0757d5f83f4bc4faca896c85932cf1e4a0cd6031/tests%2Fui%2Fpub%2Fpub-ident-fn-3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0757d5f83f4bc4faca896c85932cf1e4a0cd6031/tests%2Fui%2Fpub%2Fpub-ident-fn-3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fpub%2Fpub-ident-fn-3.rs?ref=0757d5f83f4bc4faca896c85932cf1e4a0cd6031", "patch": "@@ -2,7 +2,7 @@\n \n mod foo {\n     pub bar();\n-    //~^ ERROR missing `fn` or `struct` for function or struct definition\n+    //~^ ERROR missing `struct` for struct definition\n }\n \n fn main() {}"}, {"sha": "23eadec1193e1961809ed066f1178173dd7f66ef", "filename": "tests/ui/pub/pub-ident-fn-3.stderr", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/0757d5f83f4bc4faca896c85932cf1e4a0cd6031/tests%2Fui%2Fpub%2Fpub-ident-fn-3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0757d5f83f4bc4faca896c85932cf1e4a0cd6031/tests%2Fui%2Fpub%2Fpub-ident-fn-3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fpub%2Fpub-ident-fn-3.stderr?ref=0757d5f83f4bc4faca896c85932cf1e4a0cd6031", "patch": "@@ -1,8 +1,13 @@\n-error: missing `fn` or `struct` for function or struct definition\n+error: missing `struct` for struct definition\n   --> $DIR/pub-ident-fn-3.rs:4:8\n    |\n LL |     pub bar();\n-   |     ---^--- help: if you meant to call a macro, try: `bar!`\n+   |        ^\n+   |\n+help: add `struct` here to parse `bar` as a public struct\n+   |\n+LL |     pub struct bar();\n+   |         ++++++\n \n error: aborting due to previous error\n "}, {"sha": "dfa6cf2ee1e87696e48049ce57342f497e77a015", "filename": "tests/ui/pub/pub-ident-fn-or-struct-2.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0757d5f83f4bc4faca896c85932cf1e4a0cd6031/tests%2Fui%2Fpub%2Fpub-ident-fn-or-struct-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0757d5f83f4bc4faca896c85932cf1e4a0cd6031/tests%2Fui%2Fpub%2Fpub-ident-fn-or-struct-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fpub%2Fpub-ident-fn-or-struct-2.rs?ref=0757d5f83f4bc4faca896c85932cf1e4a0cd6031", "patch": "@@ -1,4 +1,4 @@\n pub S();\n-//~^ ERROR missing `fn` or `struct` for function or struct definition\n+//~^ ERROR missing `struct` for struct definition\n \n fn main() {}"}, {"sha": "b7a9bc0a7db358fd2d459f6de00cf2a171f6feb1", "filename": "tests/ui/pub/pub-ident-fn-or-struct-2.stderr", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/0757d5f83f4bc4faca896c85932cf1e4a0cd6031/tests%2Fui%2Fpub%2Fpub-ident-fn-or-struct-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0757d5f83f4bc4faca896c85932cf1e4a0cd6031/tests%2Fui%2Fpub%2Fpub-ident-fn-or-struct-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fpub%2Fpub-ident-fn-or-struct-2.stderr?ref=0757d5f83f4bc4faca896c85932cf1e4a0cd6031", "patch": "@@ -1,8 +1,13 @@\n-error: missing `fn` or `struct` for function or struct definition\n+error: missing `struct` for struct definition\n   --> $DIR/pub-ident-fn-or-struct-2.rs:1:4\n    |\n LL | pub S();\n-   | ---^- help: if you meant to call a macro, try: `S!`\n+   |    ^\n+   |\n+help: add `struct` here to parse `S` as a public struct\n+   |\n+LL | pub struct S();\n+   |     ++++++\n \n error: aborting due to previous error\n "}, {"sha": "b49fa678e1b7d3221777cce538f499f786ebbbd4", "filename": "tests/ui/pub/pub-ident-struct-4.fixed", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/0757d5f83f4bc4faca896c85932cf1e4a0cd6031/tests%2Fui%2Fpub%2Fpub-ident-struct-4.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/0757d5f83f4bc4faca896c85932cf1e4a0cd6031/tests%2Fui%2Fpub%2Fpub-ident-struct-4.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fpub%2Fpub-ident-struct-4.fixed?ref=0757d5f83f4bc4faca896c85932cf1e4a0cd6031", "patch": "@@ -0,0 +1,6 @@\n+// run-rustfix\n+\n+pub struct T(String);\n+//~^ ERROR missing `struct` for struct definition\n+\n+fn main() {}"}, {"sha": "20bc94b0acb19f4f081351daa4b67b8a375424d7", "filename": "tests/ui/pub/pub-ident-struct-4.rs", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/0757d5f83f4bc4faca896c85932cf1e4a0cd6031/tests%2Fui%2Fpub%2Fpub-ident-struct-4.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0757d5f83f4bc4faca896c85932cf1e4a0cd6031/tests%2Fui%2Fpub%2Fpub-ident-struct-4.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fpub%2Fpub-ident-struct-4.rs?ref=0757d5f83f4bc4faca896c85932cf1e4a0cd6031", "patch": "@@ -0,0 +1,6 @@\n+// run-rustfix\n+\n+pub T(String);\n+//~^ ERROR missing `struct` for struct definition\n+\n+fn main() {}"}, {"sha": "90c7138e5cee0fb325f5dd0bac36c573913ff160", "filename": "tests/ui/pub/pub-ident-struct-4.stderr", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/0757d5f83f4bc4faca896c85932cf1e4a0cd6031/tests%2Fui%2Fpub%2Fpub-ident-struct-4.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0757d5f83f4bc4faca896c85932cf1e4a0cd6031/tests%2Fui%2Fpub%2Fpub-ident-struct-4.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fpub%2Fpub-ident-struct-4.stderr?ref=0757d5f83f4bc4faca896c85932cf1e4a0cd6031", "patch": "@@ -0,0 +1,13 @@\n+error: missing `struct` for struct definition\n+  --> $DIR/pub-ident-struct-4.rs:3:4\n+   |\n+LL | pub T(String);\n+   |    ^\n+   |\n+help: add `struct` here to parse `T` as a public struct\n+   |\n+LL | pub struct T(String);\n+   |     ++++++\n+\n+error: aborting due to previous error\n+"}]}