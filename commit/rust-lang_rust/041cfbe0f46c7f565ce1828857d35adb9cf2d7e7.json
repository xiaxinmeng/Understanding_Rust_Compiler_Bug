{"sha": "041cfbe0f46c7f565ce1828857d35adb9cf2d7e7", "node_id": "C_kwDOAAsO6NoAKDA0MWNmYmUwZjQ2YzdmNTY1Y2UxODI4ODU3ZDM1YWRiOWNmMmQ3ZTc", "commit": {"author": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2021-10-05T16:00:27Z"}, "committer": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2021-10-05T16:11:22Z"}, "message": "Render the expansion of snippets as their docs", "tree": {"sha": "c3ba44f7a9fa2a1524ec2b56f17328357aa10741", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c3ba44f7a9fa2a1524ec2b56f17328357aa10741"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/041cfbe0f46c7f565ce1828857d35adb9cf2d7e7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/041cfbe0f46c7f565ce1828857d35adb9cf2d7e7", "html_url": "https://github.com/rust-lang/rust/commit/041cfbe0f46c7f565ce1828857d35adb9cf2d7e7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/041cfbe0f46c7f565ce1828857d35adb9cf2d7e7/comments", "author": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "77cbf4adbc0cac53386eeba42223ee312aa02c0c", "url": "https://api.github.com/repos/rust-lang/rust/commits/77cbf4adbc0cac53386eeba42223ee312aa02c0c", "html_url": "https://github.com/rust-lang/rust/commit/77cbf4adbc0cac53386eeba42223ee312aa02c0c"}], "stats": {"total": 27, "additions": 10, "deletions": 17}, "files": [{"sha": "b74030c17350eb787a29d793e207db0cc3355f2c", "filename": "crates/ide_completion/src/completions/postfix.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/041cfbe0f46c7f565ce1828857d35adb9cf2d7e7/crates%2Fide_completion%2Fsrc%2Fcompletions%2Fpostfix.rs", "raw_url": "https://github.com/rust-lang/rust/raw/041cfbe0f46c7f565ce1828857d35adb9cf2d7e7/crates%2Fide_completion%2Fsrc%2Fcompletions%2Fpostfix.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_completion%2Fsrc%2Fcompletions%2Fpostfix.rs?ref=041cfbe0f46c7f565ce1828857d35adb9cf2d7e7", "patch": "@@ -2,6 +2,7 @@\n \n mod format_like;\n \n+use hir::Documentation;\n use ide_db::{\n     helpers::{insert_use::ImportScope, FamousDefs, SnippetCap},\n     ty_filter::TryEnum,\n@@ -236,11 +237,10 @@ fn add_custom_postfix_completions(\n                 Some(imports) => imports,\n                 None => return,\n             };\n-            let mut builder = postfix_snippet(\n-                trigger,\n-                snippet.description.as_deref().unwrap_or_default(),\n-                &snippet.postfix_snippet(&receiver_text),\n-            );\n+            let body = snippet.postfix_snippet(&receiver_text);\n+            let mut builder =\n+                postfix_snippet(trigger, snippet.description.as_deref().unwrap_or_default(), &body);\n+            builder.documentation(Documentation::new(format!(\"```rust\\n{}\\n```\", body)));\n             for import in imports.into_iter() {\n                 builder.add_import(import);\n             }\n@@ -481,7 +481,7 @@ fn main() {\n                 snippets: vec![Snippet::new(\n                     &[],\n                     &[\"break\".into()],\n-                    &[\"ControlFlow::Break($receiver)\".into()],\n+                    &[\"ControlFlow::Break(${receiver})\".into()],\n                     \"\",\n                     &[\"core::ops::ControlFlow\".into()],\n                     crate::SnippetScope::Expr,"}, {"sha": "a0e5f56129e24e14e3b0822090190dcfff5a7cb8", "filename": "crates/ide_completion/src/completions/snippet.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/041cfbe0f46c7f565ce1828857d35adb9cf2d7e7/crates%2Fide_completion%2Fsrc%2Fcompletions%2Fsnippet.rs", "raw_url": "https://github.com/rust-lang/rust/raw/041cfbe0f46c7f565ce1828857d35adb9cf2d7e7/crates%2Fide_completion%2Fsrc%2Fcompletions%2Fsnippet.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_completion%2Fsrc%2Fcompletions%2Fsnippet.rs?ref=041cfbe0f46c7f565ce1828857d35adb9cf2d7e7", "patch": "@@ -1,5 +1,6 @@\n //! This file provides snippet completions, like `pd` => `eprintln!(...)`.\n \n+use hir::Documentation;\n use ide_db::helpers::{insert_use::ImportScope, SnippetCap};\n use syntax::T;\n \n@@ -109,7 +110,9 @@ fn add_custom_completions(\n                 Some(imports) => imports,\n                 None => return,\n             };\n-            let mut builder = snippet(ctx, cap, &trigger, &snip.snippet());\n+            let body = snip.snippet();\n+            let mut builder = snippet(ctx, cap, &trigger, &body);\n+            builder.documentation(Documentation::new(format!(\"```rust\\n{}\\n```\", body)));\n             for import in imports.into_iter() {\n                 builder.add_import(import);\n             }"}, {"sha": "f80b97854581c98f5ebb0911d7f72dbaccce503f", "filename": "docs/user/generated_config.adoc", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/041cfbe0f46c7f565ce1828857d35adb9cf2d7e7/docs%2Fuser%2Fgenerated_config.adoc", "raw_url": "https://github.com/rust-lang/rust/raw/041cfbe0f46c7f565ce1828857d35adb9cf2d7e7/docs%2Fuser%2Fgenerated_config.adoc", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/docs%2Fuser%2Fgenerated_config.adoc?ref=041cfbe0f46c7f565ce1828857d35adb9cf2d7e7", "patch": "@@ -146,11 +146,6 @@ Custom completion snippets.\n --\n Whether to show postfix snippets like `dbg`, `if`, `not`, etc.\n --\n-[[rust-analyzer.completion.postfix.snippets]]rust-analyzer.completion.postfix.snippets (default: `{}`)::\n-+\n---\n-Custom postfix completion snippets.\n---\n [[rust-analyzer.completion.autoimport.enable]]rust-analyzer.completion.autoimport.enable (default: `true`)::\n +\n --"}, {"sha": "d9afdfad1bce2bb1c6a13edaf9bdf1ea6f809a80", "filename": "editors/code/package.json", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/041cfbe0f46c7f565ce1828857d35adb9cf2d7e7/editors%2Fcode%2Fpackage.json", "raw_url": "https://github.com/rust-lang/rust/raw/041cfbe0f46c7f565ce1828857d35adb9cf2d7e7/editors%2Fcode%2Fpackage.json", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/editors%2Fcode%2Fpackage.json?ref=041cfbe0f46c7f565ce1828857d35adb9cf2d7e7", "patch": "@@ -595,11 +595,6 @@\n                     \"default\": true,\n                     \"type\": \"boolean\"\n                 },\n-                \"rust-analyzer.completion.postfix.snippets\": {\n-                    \"markdownDescription\": \"Custom postfix completion snippets.\",\n-                    \"default\": {},\n-                    \"type\": \"object\"\n-                },\n                 \"rust-analyzer.completion.autoimport.enable\": {\n                     \"markdownDescription\": \"Toggles the additional completions that automatically add imports when completed.\\nNote that your client must specify the `additionalTextEdits` LSP client capability to truly have this feature enabled.\",\n                     \"default\": true,"}]}