{"sha": "52862e4cda1ff72e52dfaea21cf82ae93725b3be", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUyODYyZTRjZGExZmY3MmU1MmRmYWVhMjFjZjgyYWU5MzcyNWIzYmU=", "commit": {"author": {"name": "Aidan Hobson Sayers", "email": "aidanhs@cantab.net", "date": "2015-06-14T22:55:01Z"}, "committer": {"name": "Aidan Hobson Sayers", "email": "aidanhs@cantab.net", "date": "2015-06-15T12:42:18Z"}, "message": "When building libc crate with musl, don't look for libc.a\n\nmusl may not be available on the target user's machine, and even if\nit is, we may not be able to find it because of how static libraries\nare searched for.\nInstead, use the transitively included liblibc which includes libc.a.", "tree": {"sha": "df3d3e906d5b1bcdffbf67fd01d48811c5b7b351", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/df3d3e906d5b1bcdffbf67fd01d48811c5b7b351"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/52862e4cda1ff72e52dfaea21cf82ae93725b3be", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/52862e4cda1ff72e52dfaea21cf82ae93725b3be", "html_url": "https://github.com/rust-lang/rust/commit/52862e4cda1ff72e52dfaea21cf82ae93725b3be", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/52862e4cda1ff72e52dfaea21cf82ae93725b3be/comments", "author": {"login": "aidanhs", "id": 1050652, "node_id": "MDQ6VXNlcjEwNTA2NTI=", "avatar_url": "https://avatars.githubusercontent.com/u/1050652?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aidanhs", "html_url": "https://github.com/aidanhs", "followers_url": "https://api.github.com/users/aidanhs/followers", "following_url": "https://api.github.com/users/aidanhs/following{/other_user}", "gists_url": "https://api.github.com/users/aidanhs/gists{/gist_id}", "starred_url": "https://api.github.com/users/aidanhs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aidanhs/subscriptions", "organizations_url": "https://api.github.com/users/aidanhs/orgs", "repos_url": "https://api.github.com/users/aidanhs/repos", "events_url": "https://api.github.com/users/aidanhs/events{/privacy}", "received_events_url": "https://api.github.com/users/aidanhs/received_events", "type": "User", "site_admin": false}, "committer": {"login": "aidanhs", "id": 1050652, "node_id": "MDQ6VXNlcjEwNTA2NTI=", "avatar_url": "https://avatars.githubusercontent.com/u/1050652?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aidanhs", "html_url": "https://github.com/aidanhs", "followers_url": "https://api.github.com/users/aidanhs/followers", "following_url": "https://api.github.com/users/aidanhs/following{/other_user}", "gists_url": "https://api.github.com/users/aidanhs/gists{/gist_id}", "starred_url": "https://api.github.com/users/aidanhs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aidanhs/subscriptions", "organizations_url": "https://api.github.com/users/aidanhs/orgs", "repos_url": "https://api.github.com/users/aidanhs/repos", "events_url": "https://api.github.com/users/aidanhs/events{/privacy}", "received_events_url": "https://api.github.com/users/aidanhs/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5ef250427d26af88a23e6e0d19bca00fc72ce2bc", "url": "https://api.github.com/repos/rust-lang/rust/commits/5ef250427d26af88a23e6e0d19bca00fc72ce2bc", "html_url": "https://github.com/rust-lang/rust/commit/5ef250427d26af88a23e6e0d19bca00fc72ce2bc"}], "stats": {"total": 5, "additions": 4, "deletions": 1}, "files": [{"sha": "2676d4879b5e397f93b5b778ca4e79246f80cf65", "filename": "src/liblibc/lib.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/52862e4cda1ff72e52dfaea21cf82ae93725b3be/src%2Fliblibc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/52862e4cda1ff72e52dfaea21cf82ae93725b3be/src%2Fliblibc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliblibc%2Flib.rs?ref=52862e4cda1ff72e52dfaea21cf82ae93725b3be", "patch": "@@ -146,7 +146,10 @@ pub use funcs::bsd43::*;\n #[link(name = \"m\")]\n extern {}\n \n-#[cfg(all(target_env = \"musl\", not(test)))]\n+// When compiling rust with musl, statically include libc.a in liblibc.rlib.\n+// A cargo build of the libc crate will therefore automatically pick up the\n+// libc.a symbols because liblibc is transitively linked to by the stdlib.\n+#[cfg(all(target_env = \"musl\", not(feature = \"cargo-build\"), not(test)))]\n #[link(name = \"c\", kind = \"static\")]\n extern {}\n "}]}