{"sha": "d9554c258b9c1cc2a328572e5671bc2a87729b18", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ5NTU0YzI1OGI5YzFjYzJhMzI4NTcyZTU2NzFiYzJhODc3MjliMTg=", "commit": {"author": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2021-04-10T15:16:35Z"}, "committer": {"name": "Lukas Wirth", "email": "lukastw97@gmail.com", "date": "2021-04-10T15:16:35Z"}, "message": "Add manual ops::Add impls to test::traits::closure_2", "tree": {"sha": "d458693eed73195dfd830f5237a272eeba342089", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d458693eed73195dfd830f5237a272eeba342089"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d9554c258b9c1cc2a328572e5671bc2a87729b18", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d9554c258b9c1cc2a328572e5671bc2a87729b18", "html_url": "https://github.com/rust-lang/rust/commit/d9554c258b9c1cc2a328572e5671bc2a87729b18", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d9554c258b9c1cc2a328572e5671bc2a87729b18/comments", "author": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Veykril", "id": 3757771, "node_id": "MDQ6VXNlcjM3NTc3NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/3757771?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Veykril", "html_url": "https://github.com/Veykril", "followers_url": "https://api.github.com/users/Veykril/followers", "following_url": "https://api.github.com/users/Veykril/following{/other_user}", "gists_url": "https://api.github.com/users/Veykril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Veykril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Veykril/subscriptions", "organizations_url": "https://api.github.com/users/Veykril/orgs", "repos_url": "https://api.github.com/users/Veykril/repos", "events_url": "https://api.github.com/users/Veykril/events{/privacy}", "received_events_url": "https://api.github.com/users/Veykril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "252eb78dc3852707969b27b8a30f8844289aa985", "url": "https://api.github.com/repos/rust-lang/rust/commits/252eb78dc3852707969b27b8a30f8844289aa985", "html_url": "https://github.com/rust-lang/rust/commit/252eb78dc3852707969b27b8a30f8844289aa985"}], "stats": {"total": 66, "additions": 46, "deletions": 20}, "files": [{"sha": "c93ff91ee13ec222e6176d4e13ddc3ad300aea46", "filename": "crates/hir_ty/src/tests/traits.rs", "status": "modified", "additions": 46, "deletions": 20, "changes": 66, "blob_url": "https://github.com/rust-lang/rust/blob/d9554c258b9c1cc2a328572e5671bc2a87729b18/crates%2Fhir_ty%2Fsrc%2Ftests%2Ftraits.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d9554c258b9c1cc2a328572e5671bc2a87729b18/crates%2Fhir_ty%2Fsrc%2Ftests%2Ftraits.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_ty%2Fsrc%2Ftests%2Ftraits.rs?ref=d9554c258b9c1cc2a328572e5671bc2a87729b18", "patch": "@@ -1919,10 +1919,26 @@ fn closure_1() {\n fn closure_2() {\n     check_infer_with_mismatches(\n         r#\"\n+        #[lang = \"add\"]\n+        pub trait Add<Rhs = Self> {\n+            type Output;\n+            fn add(self, rhs: Rhs) -> Self::Output;\n+        }\n+\n         trait FnOnce<Args> {\n             type Output;\n         }\n \n+        impl Add for u64 {\n+            type Output = Self;\n+            fn add(self, rhs: u64) -> Self::Output {0}\n+        }\n+\n+        impl Add for u128 {\n+            type Output = Self;\n+            fn add(self, rhs: u128) -> Self::Output {0}\n+        }\n+\n         fn test<F: FnOnce(u32) -> u64>(f: F) {\n             f(1);\n             let g = |v| v + 1;\n@@ -1931,26 +1947,36 @@ fn closure_2() {\n         }\n         \"#,\n         expect![[r#\"\n-            72..73 'f': F\n-            78..154 '{     ...+ v; }': ()\n-            84..85 'f': F\n-            84..88 'f(1)': {unknown}\n-            86..87 '1': i32\n-            98..99 'g': |u64| -> {unknown}\n-            102..111 '|v| v + 1': |u64| -> {unknown}\n-            103..104 'v': u64\n-            106..107 'v': u64\n-            106..111 'v + 1': {unknown}\n-            110..111 '1': i32\n-            117..118 'g': |u64| -> {unknown}\n-            117..124 'g(1u64)': {unknown}\n-            119..123 '1u64': u64\n-            134..135 'h': |u128| -> u128\n-            138..151 '|v| 1u128 + v': |u128| -> u128\n-            139..140 'v': u128\n-            142..147 '1u128': u128\n-            142..151 '1u128 + v': u128\n-            150..151 'v': u128\n+            72..76 'self': Self\n+            78..81 'rhs': Rhs\n+            203..207 'self': u64\n+            209..212 'rhs': u64\n+            235..238 '{0}': u64\n+            236..237 '0': u64\n+            297..301 'self': u128\n+            303..306 'rhs': u128\n+            330..333 '{0}': u128\n+            331..332 '0': u128\n+            368..369 'f': F\n+            374..450 '{     ...+ v; }': ()\n+            380..381 'f': F\n+            380..384 'f(1)': {unknown}\n+            382..383 '1': i32\n+            394..395 'g': |u64| -> u64\n+            398..407 '|v| v + 1': |u64| -> u64\n+            399..400 'v': u64\n+            402..403 'v': u64\n+            402..407 'v + 1': u64\n+            406..407 '1': u64\n+            413..414 'g': |u64| -> u64\n+            413..420 'g(1u64)': u64\n+            415..419 '1u64': u64\n+            430..431 'h': |u128| -> u128\n+            434..447 '|v| 1u128 + v': |u128| -> u128\n+            435..436 'v': u128\n+            438..443 '1u128': u128\n+            438..447 '1u128 + v': u128\n+            446..447 'v': u128\n         \"#]],\n     );\n }"}]}