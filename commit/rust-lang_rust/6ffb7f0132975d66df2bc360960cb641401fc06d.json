{"sha": "6ffb7f0132975d66df2bc360960cb641401fc06d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZmZmI3ZjAxMzI5NzVkNjZkZjJiYzM2MDk2MGNiNjQxNDAxZmMwNmQ=", "commit": {"author": {"name": "Jauhien Piatlicki", "email": "jpiatlicki@zertisa.com", "date": "2014-11-23T14:36:36Z"}, "committer": {"name": "Jauhien Piatlicki", "email": "jpiatlicki@zertisa.com", "date": "2014-11-23T14:36:42Z"}, "message": "fix for PR#16552 implementation on windows: CFG_LIBDIR should be always set in configure variables", "tree": {"sha": "7d2ddb301e9938f1abd819c194871f95848af868", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7d2ddb301e9938f1abd819c194871f95848af868"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6ffb7f0132975d66df2bc360960cb641401fc06d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6ffb7f0132975d66df2bc360960cb641401fc06d", "html_url": "https://github.com/rust-lang/rust/commit/6ffb7f0132975d66df2bc360960cb641401fc06d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6ffb7f0132975d66df2bc360960cb641401fc06d/comments", "author": {"login": "jauhien", "id": 1590238, "node_id": "MDQ6VXNlcjE1OTAyMzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1590238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jauhien", "html_url": "https://github.com/jauhien", "followers_url": "https://api.github.com/users/jauhien/followers", "following_url": "https://api.github.com/users/jauhien/following{/other_user}", "gists_url": "https://api.github.com/users/jauhien/gists{/gist_id}", "starred_url": "https://api.github.com/users/jauhien/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jauhien/subscriptions", "organizations_url": "https://api.github.com/users/jauhien/orgs", "repos_url": "https://api.github.com/users/jauhien/repos", "events_url": "https://api.github.com/users/jauhien/events{/privacy}", "received_events_url": "https://api.github.com/users/jauhien/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jauhien", "id": 1590238, "node_id": "MDQ6VXNlcjE1OTAyMzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1590238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jauhien", "html_url": "https://github.com/jauhien", "followers_url": "https://api.github.com/users/jauhien/followers", "following_url": "https://api.github.com/users/jauhien/following{/other_user}", "gists_url": "https://api.github.com/users/jauhien/gists{/gist_id}", "starred_url": "https://api.github.com/users/jauhien/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jauhien/subscriptions", "organizations_url": "https://api.github.com/users/jauhien/orgs", "repos_url": "https://api.github.com/users/jauhien/repos", "events_url": "https://api.github.com/users/jauhien/events{/privacy}", "received_events_url": "https://api.github.com/users/jauhien/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "22513fed350cb6e722d31831de97bede42af8c70", "url": "https://api.github.com/repos/rust-lang/rust/commits/22513fed350cb6e722d31831de97bede42af8c70", "html_url": "https://github.com/rust-lang/rust/commit/22513fed350cb6e722d31831de97bede42af8c70"}], "stats": {"total": 24, "additions": 14, "deletions": 10}, "files": [{"sha": "bf65b5dc8e7d31d74b11c2e4c7b94b2bcea92c26", "filename": "configure", "status": "modified", "additions": 14, "deletions": 10, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/6ffb7f0132975d66df2bc360960cb641401fc06d/configure", "raw_url": "https://github.com/rust-lang/rust/raw/6ffb7f0132975d66df2bc360960cb641401fc06d/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=6ffb7f0132975d66df2bc360960cb641401fc06d", "patch": "@@ -546,22 +546,26 @@ CFG_TARGET=$(to_llvm_triple $CFG_TARGET)\n # there's no rpath. This is where the build system itself puts libraries;\n # --libdir is used to configure the installation directory.\n # FIXME: This needs to parameterized over target triples. Do it in platform.mk\n-CFG_LIBDIR_RELATIVE=lib\n if [ \"$CFG_OSTYPE\" = \"pc-windows-gnu\" ]\n then\n     CFG_LIBDIR_RELATIVE=bin\n-    CFG_LIBDIR=\"${CFG_PREFIX}/${CFG_LIBDIR_RELATIVE}\"\n else\n-    valopt libdir \"${CFG_PREFIX}/${CFG_LIBDIR_RELATIVE}\" \"install libraries (ignored on windows platform)\"\n+    CFG_LIBDIR_RELATIVE=lib\n+fi\n \n-    case \"$CFG_LIBDIR\" in\n-\t\"$CFG_PREFIX\"/*) CAT_INC=2;;\n-\t\"$CFG_PREFIX\"*)  CAT_INC=1;;\n-\t*)\n-            err \"libdir must begin with the prefix. Use --prefix to set it accordingly.\";;\n-    esac\n+valopt libdir \"${CFG_PREFIX}/${CFG_LIBDIR_RELATIVE}\" \"install libraries (do not set it on windows platform)\"\n+\n+case \"$CFG_LIBDIR\" in\n+    \"$CFG_PREFIX\"/*) CAT_INC=2;;\n+    \"$CFG_PREFIX\"*)  CAT_INC=1;;\n+    *)\n+        err \"libdir must begin with the prefix. Use --prefix to set it accordingly.\";;\n+esac\n+\n+CFG_LIBDIR_RELATIVE=`echo ${CFG_LIBDIR} | cut -c$((${#CFG_PREFIX}+${CAT_INC}))-`\n \n-    CFG_LIBDIR_RELATIVE=`echo ${CFG_LIBDIR} | cut -c$((${#CFG_PREFIX}+${CAT_INC}))-`\n+if [ \"$CFG_OSTYPE\" = \"pc-windows-gnu\" ] && [ \"$CFG_LIBDIR_RELATIVE\" != \"bin\" ]; then\n+    err \"libdir on windows should be set to 'bin'\"\n fi\n \n if [ $HELP -eq 1 ]"}]}