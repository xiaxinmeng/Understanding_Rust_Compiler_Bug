{"sha": "f85c3f72a4448424f2a3a63fedcbb9e33287c0e7", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY4NWMzZjcyYTQ0NDg0MjRmMmEzYTYzZmVkY2JiOWUzMzI4N2MwZTc=", "commit": {"author": {"name": "Mara Bos", "email": "m-ou.se@m-ou.se", "date": "2020-11-18T14:46:29Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-11-18T14:46:29Z"}, "message": "Rollup merge of #79079 - camelid:mir-visit-docs, r=matthewjasper\n\nTurn top-level comments into module docs in MIR visitor", "tree": {"sha": "c0016541ed12db0666777e04b17cebbf48c242b0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c0016541ed12db0666777e04b17cebbf48c242b0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f85c3f72a4448424f2a3a63fedcbb9e33287c0e7", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJftTPFCRBK7hj4Ov3rIwAAdHIIAHj5rN4eF9U1EgkMSHGIDqfk\ny0B2rB4iu8OwQhUQ4gj+C5GGiax5yDm+odw0+/vpszeKqDTbt5/aSRE+TLawpcgS\nj56GYaOQlzB4z5Hd0sx8fQvzNYrrMHy2Ao1pLaHaOELbER8n0AZzAc/HgBlDS7uM\ndKWWg+emooaNvaAdTE/zpWMuMUDnPgrVS8SrQIvFVr3hQO4DX3pHen8LvHrwOmoZ\n+RL/4+NdgLWFCf6e2VOzNI8IKK9fFKMvjNWLlMlhwVYuIr/tzb0E7J9nbfmYbx5o\n03/oy8Z3GbenlUgqH3BXow9W3i/AAifys0WkK3gG+cazla0HV+yZbo7zyaF7+2M=\n=iRKF\n-----END PGP SIGNATURE-----\n", "payload": "tree c0016541ed12db0666777e04b17cebbf48c242b0\nparent ad6fd9b0372e9948658eab6779e636dd7f1eede1\nparent c82a258ad40ca8877e91a12722097e79a42905c6\nauthor Mara Bos <m-ou.se@m-ou.se> 1605710789 +0100\ncommitter GitHub <noreply@github.com> 1605710789 +0100\n\nRollup merge of #79079 - camelid:mir-visit-docs, r=matthewjasper\n\nTurn top-level comments into module docs in MIR visitor\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f85c3f72a4448424f2a3a63fedcbb9e33287c0e7", "html_url": "https://github.com/rust-lang/rust/commit/f85c3f72a4448424f2a3a63fedcbb9e33287c0e7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f85c3f72a4448424f2a3a63fedcbb9e33287c0e7/comments", "author": {"login": "m-ou-se", "id": 783247, "node_id": "MDQ6VXNlcjc4MzI0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/783247?v=4", "gravatar_id": "", "url": "https://api.github.com/users/m-ou-se", "html_url": "https://github.com/m-ou-se", "followers_url": "https://api.github.com/users/m-ou-se/followers", "following_url": "https://api.github.com/users/m-ou-se/following{/other_user}", "gists_url": "https://api.github.com/users/m-ou-se/gists{/gist_id}", "starred_url": "https://api.github.com/users/m-ou-se/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/m-ou-se/subscriptions", "organizations_url": "https://api.github.com/users/m-ou-se/orgs", "repos_url": "https://api.github.com/users/m-ou-se/repos", "events_url": "https://api.github.com/users/m-ou-se/events{/privacy}", "received_events_url": "https://api.github.com/users/m-ou-se/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ad6fd9b0372e9948658eab6779e636dd7f1eede1", "url": "https://api.github.com/repos/rust-lang/rust/commits/ad6fd9b0372e9948658eab6779e636dd7f1eede1", "html_url": "https://github.com/rust-lang/rust/commit/ad6fd9b0372e9948658eab6779e636dd7f1eede1"}, {"sha": "c82a258ad40ca8877e91a12722097e79a42905c6", "url": "https://api.github.com/repos/rust-lang/rust/commits/c82a258ad40ca8877e91a12722097e79a42905c6", "html_url": "https://github.com/rust-lang/rust/commit/c82a258ad40ca8877e91a12722097e79a42905c6"}], "stats": {"total": 124, "additions": 62, "deletions": 62}, "files": [{"sha": "638dd8ce9706f355a408c8a0438ac801b06224e9", "filename": "compiler/rustc_middle/src/mir/visit.rs", "status": "modified", "additions": 62, "deletions": 62, "changes": 124, "blob_url": "https://github.com/rust-lang/rust/blob/f85c3f72a4448424f2a3a63fedcbb9e33287c0e7/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fvisit.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f85c3f72a4448424f2a3a63fedcbb9e33287c0e7/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fvisit.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fmir%2Fvisit.rs?ref=f85c3f72a4448424f2a3a63fedcbb9e33287c0e7", "patch": "@@ -1,70 +1,70 @@\n+//! # The MIR Visitor\n+//!\n+//! ## Overview\n+//!\n+//! There are two visitors, one for immutable and one for mutable references,\n+//! but both are generated by the following macro. The code is written according\n+//! to the following conventions:\n+//!\n+//! - introduce a `visit_foo` and a `super_foo` method for every MIR type\n+//! - `visit_foo`, by default, calls `super_foo`\n+//! - `super_foo`, by default, destructures the `foo` and calls `visit_foo`\n+//!\n+//! This allows you as a user to override `visit_foo` for types are\n+//! interested in, and invoke (within that method) call\n+//! `self.super_foo` to get the default behavior. Just as in an OO\n+//! language, you should never call `super` methods ordinarily except\n+//! in that circumstance.\n+//!\n+//! For the most part, we do not destructure things external to the\n+//! MIR, e.g., types, spans, etc, but simply visit them and stop. This\n+//! avoids duplication with other visitors like `TypeFoldable`.\n+//!\n+//! ## Updating\n+//!\n+//! The code is written in a very deliberate style intended to minimize\n+//! the chance of things being overlooked. You'll notice that we always\n+//! use pattern matching to reference fields and we ensure that all\n+//! matches are exhaustive.\n+//!\n+//! For example, the `super_basic_block_data` method begins like this:\n+//!\n+//! ```rust\n+//! fn super_basic_block_data(&mut self,\n+//!                           block: BasicBlock,\n+//!                           data: & $($mutability)? BasicBlockData<'tcx>) {\n+//!     let BasicBlockData {\n+//!         statements,\n+//!         terminator,\n+//!         is_cleanup: _\n+//!     } = *data;\n+//!\n+//!     for statement in statements {\n+//!         self.visit_statement(block, statement);\n+//!     }\n+//!\n+//!     ...\n+//! }\n+//! ```\n+//!\n+//! Here we used `let BasicBlockData { <fields> } = *data` deliberately,\n+//! rather than writing `data.statements` in the body. This is because if one\n+//! adds a new field to `BasicBlockData`, one will be forced to revise this code,\n+//! and hence one will (hopefully) invoke the correct visit methods (if any).\n+//!\n+//! For this to work, ALL MATCHES MUST BE EXHAUSTIVE IN FIELDS AND VARIANTS.\n+//! That means you never write `..` to skip over fields, nor do you write `_`\n+//! to skip over variants in a `match`.\n+//!\n+//! The only place that `_` is acceptable is to match a field (or\n+//! variant argument) that does not require visiting, as in\n+//! `is_cleanup` above.\n+\n use crate::mir::*;\n use crate::ty::subst::SubstsRef;\n use crate::ty::{CanonicalUserTypeAnnotation, Ty};\n use rustc_span::Span;\n \n-// # The MIR Visitor\n-//\n-// ## Overview\n-//\n-// There are two visitors, one for immutable and one for mutable references,\n-// but both are generated by the following macro. The code is written according\n-// to the following conventions:\n-//\n-// - introduce a `visit_foo` and a `super_foo` method for every MIR type\n-// - `visit_foo`, by default, calls `super_foo`\n-// - `super_foo`, by default, destructures the `foo` and calls `visit_foo`\n-//\n-// This allows you as a user to override `visit_foo` for types are\n-// interested in, and invoke (within that method) call\n-// `self.super_foo` to get the default behavior. Just as in an OO\n-// language, you should never call `super` methods ordinarily except\n-// in that circumstance.\n-//\n-// For the most part, we do not destructure things external to the\n-// MIR, e.g., types, spans, etc, but simply visit them and stop. This\n-// avoids duplication with other visitors like `TypeFoldable`.\n-//\n-// ## Updating\n-//\n-// The code is written in a very deliberate style intended to minimize\n-// the chance of things being overlooked. You'll notice that we always\n-// use pattern matching to reference fields and we ensure that all\n-// matches are exhaustive.\n-//\n-// For example, the `super_basic_block_data` method begins like this:\n-//\n-// ```rust\n-// fn super_basic_block_data(&mut self,\n-//                           block: BasicBlock,\n-//                           data: & $($mutability)? BasicBlockData<'tcx>) {\n-//     let BasicBlockData {\n-//         statements,\n-//         terminator,\n-//         is_cleanup: _\n-//     } = *data;\n-//\n-//     for statement in statements {\n-//         self.visit_statement(block, statement);\n-//     }\n-//\n-//     ...\n-// }\n-// ```\n-//\n-// Here we used `let BasicBlockData { <fields> } = *data` deliberately,\n-// rather than writing `data.statements` in the body. This is because if one\n-// adds a new field to `BasicBlockData`, one will be forced to revise this code,\n-// and hence one will (hopefully) invoke the correct visit methods (if any).\n-//\n-// For this to work, ALL MATCHES MUST BE EXHAUSTIVE IN FIELDS AND VARIANTS.\n-// That means you never write `..` to skip over fields, nor do you write `_`\n-// to skip over variants in a `match`.\n-//\n-// The only place that `_` is acceptable is to match a field (or\n-// variant argument) that does not require visiting, as in\n-// `is_cleanup` above.\n-\n macro_rules! make_mir_visitor {\n     ($visitor_trait_name:ident, $($mutability:ident)?) => {\n         pub trait $visitor_trait_name<'tcx> {"}]}