{"sha": "0de314b3b3d7ac30edfa2bdd6627683d6a19e694", "node_id": "C_kwDOAAsO6NoAKDBkZTMxNGIzYjNkN2FjMzBlZGZhMmJkZDY2Mjc2ODNkNmExOWU2OTQ", "commit": {"author": {"name": "Amanieu d'Antras", "email": "amanieu@gmail.com", "date": "2022-03-01T00:50:56Z"}, "committer": {"name": "Amanieu d'Antras", "email": "amanieu@gmail.com", "date": "2022-04-14T14:32:03Z"}, "message": "Reimplement lowering of sym operands for asm! so that it also works with global_asm!", "tree": {"sha": "fdb17d64bf022f6b0d52b6fff957fe4b0c60e9b9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fdb17d64bf022f6b0d52b6fff957fe4b0c60e9b9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0de314b3b3d7ac30edfa2bdd6627683d6a19e694", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0de314b3b3d7ac30edfa2bdd6627683d6a19e694", "html_url": "https://github.com/rust-lang/rust/commit/0de314b3b3d7ac30edfa2bdd6627683d6a19e694", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0de314b3b3d7ac30edfa2bdd6627683d6a19e694/comments", "author": {"login": "Amanieu", "id": 278509, "node_id": "MDQ6VXNlcjI3ODUwOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/278509?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Amanieu", "html_url": "https://github.com/Amanieu", "followers_url": "https://api.github.com/users/Amanieu/followers", "following_url": "https://api.github.com/users/Amanieu/following{/other_user}", "gists_url": "https://api.github.com/users/Amanieu/gists{/gist_id}", "starred_url": "https://api.github.com/users/Amanieu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Amanieu/subscriptions", "organizations_url": "https://api.github.com/users/Amanieu/orgs", "repos_url": "https://api.github.com/users/Amanieu/repos", "events_url": "https://api.github.com/users/Amanieu/events{/privacy}", "received_events_url": "https://api.github.com/users/Amanieu/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Amanieu", "id": 278509, "node_id": "MDQ6VXNlcjI3ODUwOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/278509?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Amanieu", "html_url": "https://github.com/Amanieu", "followers_url": "https://api.github.com/users/Amanieu/followers", "following_url": "https://api.github.com/users/Amanieu/following{/other_user}", "gists_url": "https://api.github.com/users/Amanieu/gists{/gist_id}", "starred_url": "https://api.github.com/users/Amanieu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Amanieu/subscriptions", "organizations_url": "https://api.github.com/users/Amanieu/orgs", "repos_url": "https://api.github.com/users/Amanieu/repos", "events_url": "https://api.github.com/users/Amanieu/events{/privacy}", "received_events_url": "https://api.github.com/users/Amanieu/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a377ebc82e51afbb6ec11f7defe20cec5b2d87a4", "url": "https://api.github.com/repos/rust-lang/rust/commits/a377ebc82e51afbb6ec11f7defe20cec5b2d87a4", "html_url": "https://github.com/rust-lang/rust/commit/a377ebc82e51afbb6ec11f7defe20cec5b2d87a4"}], "stats": {"total": 33, "additions": 26, "deletions": 7}, "files": [{"sha": "9ba9642fcc833691fabcd4489b206e6ddb16a37a", "filename": "clippy_lints/src/loops/never_loop.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/0de314b3b3d7ac30edfa2bdd6627683d6a19e694/clippy_lints%2Fsrc%2Floops%2Fnever_loop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0de314b3b3d7ac30edfa2bdd6627683d6a19e694/clippy_lints%2Fsrc%2Floops%2Fnever_loop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Floops%2Fnever_loop.rs?ref=0de314b3b3d7ac30edfa2bdd6627683d6a19e694", "patch": "@@ -169,13 +169,14 @@ fn never_loop_expr(expr: &Expr<'_>, main_loop_id: HirId) -> NeverLoopResult {\n             .iter()\n             .map(|(o, _)| match o {\n                 InlineAsmOperand::In { expr, .. }\n-                | InlineAsmOperand::InOut { expr, .. }\n-                | InlineAsmOperand::Sym { expr } => never_loop_expr(expr, main_loop_id),\n+                | InlineAsmOperand::InOut { expr, .. } => never_loop_expr(expr, main_loop_id),\n                 InlineAsmOperand::Out { expr, .. } => never_loop_expr_all(&mut expr.iter(), main_loop_id),\n                 InlineAsmOperand::SplitInOut { in_expr, out_expr, .. } => {\n                     never_loop_expr_all(&mut once(in_expr).chain(out_expr.iter()), main_loop_id)\n                 },\n-                InlineAsmOperand::Const { .. } => NeverLoopResult::Otherwise,\n+                InlineAsmOperand::Const { .. }\n+                | InlineAsmOperand::SymFn { .. }\n+                | InlineAsmOperand::SymStatic { .. } => NeverLoopResult::Otherwise,\n             })\n             .fold(NeverLoopResult::Otherwise, combine_both),\n         ExprKind::Struct(_, _, None)"}, {"sha": "a04288e0a413ecd8f6733eda276ba321d1b146d8", "filename": "clippy_lints/src/utils/inspector.rs", "status": "modified", "additions": 20, "deletions": 3, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/0de314b3b3d7ac30edfa2bdd6627683d6a19e694/clippy_lints%2Fsrc%2Futils%2Finspector.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0de314b3b3d7ac30edfa2bdd6627683d6a19e694/clippy_lints%2Fsrc%2Futils%2Finspector.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Futils%2Finspector.rs?ref=0de314b3b3d7ac30edfa2bdd6627683d6a19e694", "patch": "@@ -281,8 +281,9 @@ fn print_expr(cx: &LateContext<'_>, expr: &hir::Expr<'_>, indent: usize) {\n             for (op, _op_sp) in asm.operands {\n                 match op {\n                     hir::InlineAsmOperand::In { expr, .. }\n-                    | hir::InlineAsmOperand::InOut { expr, .. }\n-                    | hir::InlineAsmOperand::Sym { expr } => print_expr(cx, expr, indent + 1),\n+                    | hir::InlineAsmOperand::InOut { expr, .. } => {\n+                        print_expr(cx, expr, indent + 1);\n+                    }\n                     hir::InlineAsmOperand::Out { expr, .. } => {\n                         if let Some(expr) = expr {\n                             print_expr(cx, expr, indent + 1);\n@@ -294,10 +295,26 @@ fn print_expr(cx: &LateContext<'_>, expr: &hir::Expr<'_>, indent: usize) {\n                             print_expr(cx, out_expr, indent + 1);\n                         }\n                     },\n-                    hir::InlineAsmOperand::Const { anon_const } => {\n+                    hir::InlineAsmOperand::Const { anon_const }\n+                    | hir::InlineAsmOperand::SymFn { anon_const } => {\n                         println!(\"{}anon_const:\", ind);\n                         print_expr(cx, &cx.tcx.hir().body(anon_const.body).value, indent + 1);\n                     },\n+                    hir::InlineAsmOperand::SymStatic { path, .. } => {\n+                        match path {\n+                            hir::QPath::Resolved(ref ty, path) => {\n+                                println!(\"{}Resolved Path, {:?}\", ind, ty);\n+                                println!(\"{}path: {:?}\", ind, path);\n+                            },\n+                            hir::QPath::TypeRelative(ty, seg) => {\n+                                println!(\"{}Relative Path, {:?}\", ind, ty);\n+                                println!(\"{}seg: {:?}\", ind, seg);\n+                            },\n+                            hir::QPath::LangItem(lang_item, ..) => {\n+                                println!(\"{}Lang Item Path, {:?}\", ind, lang_item.name());\n+                            },\n+                        }\n+                    }\n                 }\n             }\n         },"}, {"sha": "c05317f59b716ad60f0fdd92689ee1167fbe914e", "filename": "clippy_utils/src/hir_utils.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/0de314b3b3d7ac30edfa2bdd6627683d6a19e694/clippy_utils%2Fsrc%2Fhir_utils.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0de314b3b3d7ac30edfa2bdd6627683d6a19e694/clippy_utils%2Fsrc%2Fhir_utils.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_utils%2Fsrc%2Fhir_utils.rs?ref=0de314b3b3d7ac30edfa2bdd6627683d6a19e694", "patch": "@@ -675,7 +675,8 @@ impl<'a, 'tcx> SpanlessHash<'a, 'tcx> {\n                             }\n                         },\n                         InlineAsmOperand::Const { anon_const } => self.hash_body(anon_const.body),\n-                        InlineAsmOperand::Sym { expr } => self.hash_expr(expr),\n+                        InlineAsmOperand::SymFn { anon_const } => self.hash_body(anon_const.body),\n+                        InlineAsmOperand::SymStatic { path, def_id: _ } => self.hash_qpath(path),\n                     }\n                 }\n             },"}]}