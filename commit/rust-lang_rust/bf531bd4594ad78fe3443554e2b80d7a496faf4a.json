{"sha": "bf531bd4594ad78fe3443554e2b80d7a496faf4a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJmNTMxYmQ0NTk0YWQ3OGZlMzQ0MzU1NGUyYjgwZDdhNDk2ZmFmNGE=", "commit": {"author": {"name": "Taiki Endo", "email": "te316e89@gmail.com", "date": "2019-02-08T11:40:49Z"}, "committer": {"name": "Taiki Endo", "email": "te316e89@gmail.com", "date": "2019-02-08T11:40:49Z"}, "message": "librustc_passes => 2018", "tree": {"sha": "21ae397113d23fcc03ca0530b5de4e623aab8997", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/21ae397113d23fcc03ca0530b5de4e623aab8997"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/bf531bd4594ad78fe3443554e2b80d7a496faf4a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/bf531bd4594ad78fe3443554e2b80d7a496faf4a", "html_url": "https://github.com/rust-lang/rust/commit/bf531bd4594ad78fe3443554e2b80d7a496faf4a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/bf531bd4594ad78fe3443554e2b80d7a496faf4a/comments", "author": {"login": "taiki-e", "id": 43724913, "node_id": "MDQ6VXNlcjQzNzI0OTEz", "avatar_url": "https://avatars.githubusercontent.com/u/43724913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/taiki-e", "html_url": "https://github.com/taiki-e", "followers_url": "https://api.github.com/users/taiki-e/followers", "following_url": "https://api.github.com/users/taiki-e/following{/other_user}", "gists_url": "https://api.github.com/users/taiki-e/gists{/gist_id}", "starred_url": "https://api.github.com/users/taiki-e/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/taiki-e/subscriptions", "organizations_url": "https://api.github.com/users/taiki-e/orgs", "repos_url": "https://api.github.com/users/taiki-e/repos", "events_url": "https://api.github.com/users/taiki-e/events{/privacy}", "received_events_url": "https://api.github.com/users/taiki-e/received_events", "type": "User", "site_admin": false}, "committer": {"login": "taiki-e", "id": 43724913, "node_id": "MDQ6VXNlcjQzNzI0OTEz", "avatar_url": "https://avatars.githubusercontent.com/u/43724913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/taiki-e", "html_url": "https://github.com/taiki-e", "followers_url": "https://api.github.com/users/taiki-e/followers", "following_url": "https://api.github.com/users/taiki-e/following{/other_user}", "gists_url": "https://api.github.com/users/taiki-e/gists{/gist_id}", "starred_url": "https://api.github.com/users/taiki-e/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/taiki-e/subscriptions", "organizations_url": "https://api.github.com/users/taiki-e/orgs", "repos_url": "https://api.github.com/users/taiki-e/repos", "events_url": "https://api.github.com/users/taiki-e/events{/privacy}", "received_events_url": "https://api.github.com/users/taiki-e/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b139669f374eb5024a50eb13f116ff763b1c5935", "url": "https://api.github.com/repos/rust-lang/rust/commits/b139669f374eb5024a50eb13f116ff763b1c5935", "html_url": "https://github.com/rust-lang/rust/commit/b139669f374eb5024a50eb13f116ff763b1c5935"}], "stats": {"total": 45, "additions": 23, "deletions": 22}, "files": [{"sha": "00bdcdc0cc021151de881115c9b99b3fbd97d551", "filename": "src/librustc_passes/Cargo.toml", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/bf531bd4594ad78fe3443554e2b80d7a496faf4a/src%2Flibrustc_passes%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/bf531bd4594ad78fe3443554e2b80d7a496faf4a/src%2Flibrustc_passes%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_passes%2FCargo.toml?ref=bf531bd4594ad78fe3443554e2b80d7a496faf4a", "patch": "@@ -2,6 +2,7 @@\n authors = [\"The Rust Project Developers\"]\n name = \"rustc_passes\"\n version = \"0.0.0\"\n+edition = \"2018\"\n \n [lib]\n name = \"rustc_passes\"\n@@ -16,4 +17,4 @@ rustc_data_structures = { path = \"../librustc_data_structures\" }\n syntax = { path = \"../libsyntax\" }\n syntax_ext = { path = \"../libsyntax_ext\" }\n syntax_pos = { path = \"../libsyntax_pos\" }\n-rustc_errors = { path = \"../librustc_errors\" }\n+errors = { path = \"../librustc_errors\", package = \"rustc_errors\" }"}, {"sha": "4b1cf6a035ef7cd20d3d2f76b227cfd333bf1c1e", "filename": "src/librustc_passes/ast_validation.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/bf531bd4594ad78fe3443554e2b80d7a496faf4a/src%2Flibrustc_passes%2Fast_validation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bf531bd4594ad78fe3443554e2b80d7a496faf4a/src%2Flibrustc_passes%2Fast_validation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_passes%2Fast_validation.rs?ref=bf531bd4594ad78fe3443554e2b80d7a496faf4a", "patch": "@@ -15,10 +15,11 @@ use syntax::source_map::Spanned;\n use syntax::symbol::keywords;\n use syntax::ptr::P;\n use syntax::visit::{self, Visitor};\n+use syntax::{span_err, struct_span_err, walk_list};\n use syntax_ext::proc_macro_decls::is_proc_macro_attr;\n use syntax_pos::Span;\n-use errors;\n use errors::Applicability;\n+use log::debug;\n \n struct AstValidator<'a> {\n     session: &'a Session,"}, {"sha": "19d4d3aeb0f6530e06a0a724bb89c2cb0e52b4b6", "filename": "src/librustc_passes/diagnostics.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/bf531bd4594ad78fe3443554e2b80d7a496faf4a/src%2Flibrustc_passes%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bf531bd4594ad78fe3443554e2b80d7a496faf4a/src%2Flibrustc_passes%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_passes%2Fdiagnostics.rs?ref=bf531bd4594ad78fe3443554e2b80d7a496faf4a", "patch": "@@ -1,5 +1,7 @@\n #![allow(non_snake_case)]\n \n+use syntax::{register_diagnostic, register_diagnostics, register_long_diagnostics};\n+\n register_long_diagnostics! {\n /*\n E0014: r##\""}, {"sha": "2427abad07c958853f3451c0bab378f231755cb1", "filename": "src/librustc_passes/hir_stats.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/bf531bd4594ad78fe3443554e2b80d7a496faf4a/src%2Flibrustc_passes%2Fhir_stats.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bf531bd4594ad78fe3443554e2b80d7a496faf4a/src%2Flibrustc_passes%2Fhir_stats.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_passes%2Fhir_stats.rs?ref=bf531bd4594ad78fe3443554e2b80d7a496faf4a", "patch": "@@ -61,7 +61,7 @@ impl<'k> StatCollector<'k> {\n         });\n \n         entry.count += 1;\n-        entry.size = ::std::mem::size_of_val(node);\n+        entry.size = std::mem::size_of_val(node);\n     }\n \n     fn print(&self, title: &str) {"}, {"sha": "7b0e57846f3609aaf054c9443e49c0375fd37d9c", "filename": "src/librustc_passes/lib.rs", "status": "modified", "additions": 3, "deletions": 11, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/bf531bd4594ad78fe3443554e2b80d7a496faf4a/src%2Flibrustc_passes%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bf531bd4594ad78fe3443554e2b80d7a496faf4a/src%2Flibrustc_passes%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_passes%2Flib.rs?ref=bf531bd4594ad78fe3443554e2b80d7a496faf4a", "patch": "@@ -13,18 +13,10 @@\n \n #![recursion_limit=\"256\"]\n \n-#[macro_use]\n-extern crate rustc;\n-extern crate rustc_mir;\n-extern crate rustc_data_structures;\n+#![deny(rust_2018_idioms)]\n \n #[macro_use]\n-extern crate log;\n-#[macro_use]\n-extern crate syntax;\n-extern crate syntax_ext;\n-extern crate syntax_pos;\n-extern crate rustc_errors as errors;\n+extern crate rustc;\n \n use rustc::ty::query::Providers;\n \n@@ -38,7 +30,7 @@ pub mod loops;\n \n __build_diagnostic_array! { librustc_passes, DIAGNOSTICS }\n \n-pub fn provide(providers: &mut Providers) {\n+pub fn provide(providers: &mut Providers<'_>) {\n     rvalue_promotion::provide(providers);\n     loops::provide(providers);\n }"}, {"sha": "533e043efa9d223f4f3f1addc239f21a25d58b46", "filename": "src/librustc_passes/loops.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/bf531bd4594ad78fe3443554e2b80d7a496faf4a/src%2Flibrustc_passes%2Floops.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bf531bd4594ad78fe3443554e2b80d7a496faf4a/src%2Flibrustc_passes%2Floops.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_passes%2Floops.rs?ref=bf531bd4594ad78fe3443554e2b80d7a496faf4a", "patch": "@@ -1,4 +1,4 @@\n-use self::Context::*;\n+use Context::*;\n \n use rustc::session::Session;\n \n@@ -9,6 +9,7 @@ use rustc::hir::map::Map;\n use rustc::hir::intravisit::{self, Visitor, NestedVisitorMap};\n use rustc::hir::{self, Node, Destination};\n use syntax::ast;\n+use syntax::struct_span_err;\n use syntax_pos::Span;\n use errors::Applicability;\n \n@@ -59,7 +60,7 @@ fn check_mod_loops<'tcx>(tcx: TyCtxt<'_, 'tcx, 'tcx>, module_def_id: DefId) {\n     }.as_deep_visitor());\n }\n \n-pub(crate) fn provide(providers: &mut Providers) {\n+pub(crate) fn provide(providers: &mut Providers<'_>) {\n     *providers = Providers {\n         check_mod_loops,\n         ..*providers"}, {"sha": "748500ac46b57c1f032bcd6ddac628d3dc7fbceb", "filename": "src/librustc_passes/rvalue_promotion.rs", "status": "modified", "additions": 10, "deletions": 6, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/bf531bd4594ad78fe3443554e2b80d7a496faf4a/src%2Flibrustc_passes%2Frvalue_promotion.rs", "raw_url": "https://github.com/rust-lang/rust/raw/bf531bd4594ad78fe3443554e2b80d7a496faf4a/src%2Flibrustc_passes%2Frvalue_promotion.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_passes%2Frvalue_promotion.rs?ref=bf531bd4594ad78fe3443554e2b80d7a496faf4a", "patch": "@@ -28,10 +28,11 @@ use rustc::hir;\n use rustc_data_structures::sync::Lrc;\n use syntax::ast;\n use syntax_pos::{Span, DUMMY_SP};\n-use self::Promotability::*;\n+use log::debug;\n+use Promotability::*;\n use std::ops::{BitAnd, BitAndAssign, BitOr};\n \n-pub fn provide(providers: &mut Providers) {\n+pub fn provide(providers: &mut Providers<'_>) {\n     *providers = Providers {\n         rvalue_promotable_map,\n         const_is_rvalue_promotable_to_static,\n@@ -622,7 +623,7 @@ impl<'a, 'gcx, 'tcx> euv::Delegate<'tcx> for CheckCrateVisitor<'a, 'gcx> {\n     fn consume(&mut self,\n                _consume_id: ast::NodeId,\n                _consume_span: Span,\n-               _cmt: &mc::cmt_,\n+               _cmt: &mc::cmt_<'_>,\n                _mode: euv::ConsumeMode) {}\n \n     fn borrow(&mut self,\n@@ -681,11 +682,14 @@ impl<'a, 'gcx, 'tcx> euv::Delegate<'tcx> for CheckCrateVisitor<'a, 'gcx> {\n     fn mutate(&mut self,\n               _assignment_id: ast::NodeId,\n               _assignment_span: Span,\n-              _assignee_cmt: &mc::cmt_,\n+              _assignee_cmt: &mc::cmt_<'_>,\n               _mode: euv::MutateMode) {\n     }\n \n-    fn matched_pat(&mut self, _: &hir::Pat, _: &mc::cmt_, _: euv::MatchMode) {}\n+    fn matched_pat(&mut self, _: &hir::Pat, _: &mc::cmt_<'_>, _: euv::MatchMode) {}\n \n-    fn consume_pat(&mut self, _consume_pat: &hir::Pat, _cmt: &mc::cmt_, _mode: euv::ConsumeMode) {}\n+    fn consume_pat(&mut self,\n+                   _consume_pat: &hir::Pat,\n+                   _cmt: &mc::cmt_<'_>,\n+                   _mode: euv::ConsumeMode) {}\n }"}]}