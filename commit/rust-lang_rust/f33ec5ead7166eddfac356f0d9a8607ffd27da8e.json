{"sha": "f33ec5ead7166eddfac356f0d9a8607ffd27da8e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYzM2VjNWVhZDcxNjZlZGRmYWMzNTZmMGQ5YTg2MDdmZmQyN2RhOGU=", "commit": {"author": {"name": "Diego Giagio", "email": "diego@giagio.com", "date": "2014-12-28T19:44:33Z"}, "committer": {"name": "Diego Giagio", "email": "diego@giagio.com", "date": "2014-12-28T19:44:33Z"}, "message": "Fix deprecation warnings on libregex tests", "tree": {"sha": "18182ace844ee453d3e6804e1245ce30faddea4f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/18182ace844ee453d3e6804e1245ce30faddea4f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f33ec5ead7166eddfac356f0d9a8607ffd27da8e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f33ec5ead7166eddfac356f0d9a8607ffd27da8e", "html_url": "https://github.com/rust-lang/rust/commit/f33ec5ead7166eddfac356f0d9a8607ffd27da8e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f33ec5ead7166eddfac356f0d9a8607ffd27da8e/comments", "author": {"login": "dgiagio", "id": 124647, "node_id": "MDQ6VXNlcjEyNDY0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/124647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dgiagio", "html_url": "https://github.com/dgiagio", "followers_url": "https://api.github.com/users/dgiagio/followers", "following_url": "https://api.github.com/users/dgiagio/following{/other_user}", "gists_url": "https://api.github.com/users/dgiagio/gists{/gist_id}", "starred_url": "https://api.github.com/users/dgiagio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dgiagio/subscriptions", "organizations_url": "https://api.github.com/users/dgiagio/orgs", "repos_url": "https://api.github.com/users/dgiagio/repos", "events_url": "https://api.github.com/users/dgiagio/events{/privacy}", "received_events_url": "https://api.github.com/users/dgiagio/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dgiagio", "id": 124647, "node_id": "MDQ6VXNlcjEyNDY0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/124647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dgiagio", "html_url": "https://github.com/dgiagio", "followers_url": "https://api.github.com/users/dgiagio/followers", "following_url": "https://api.github.com/users/dgiagio/following{/other_user}", "gists_url": "https://api.github.com/users/dgiagio/gists{/gist_id}", "starred_url": "https://api.github.com/users/dgiagio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dgiagio/subscriptions", "organizations_url": "https://api.github.com/users/dgiagio/orgs", "repos_url": "https://api.github.com/users/dgiagio/repos", "events_url": "https://api.github.com/users/dgiagio/events{/privacy}", "received_events_url": "https://api.github.com/users/dgiagio/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3e6b29f8ad1ddfcb134d743a66ee5f467e16c350", "url": "https://api.github.com/repos/rust-lang/rust/commits/3e6b29f8ad1ddfcb134d743a66ee5f467e16c350", "html_url": "https://github.com/rust-lang/rust/commit/3e6b29f8ad1ddfcb134d743a66ee5f467e16c350"}], "stats": {"total": 19, "additions": 10, "deletions": 9}, "files": [{"sha": "d29d90a26083f5f611156f37afb7813b97e14cc3", "filename": "src/libregex/test/bench.rs", "status": "modified", "additions": 10, "deletions": 9, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/f33ec5ead7166eddfac356f0d9a8607ffd27da8e/src%2Flibregex%2Ftest%2Fbench.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f33ec5ead7166eddfac356f0d9a8607ffd27da8e/src%2Flibregex%2Ftest%2Fbench.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibregex%2Ftest%2Fbench.rs?ref=f33ec5ead7166eddfac356f0d9a8607ffd27da8e", "patch": "@@ -11,6 +11,7 @@\n \n use std::rand::{Rng, task_rng};\n use stdtest::Bencher;\n+use std::iter::repeat;\n \n use regex::{Regex, NoExpand};\n \n@@ -22,38 +23,38 @@ fn bench_assert_match(b: &mut Bencher, re: Regex, text: &str) {\n fn no_exponential(b: &mut Bencher) {\n     let n = 100;\n     let re = Regex::new(format!(\"{}{}\",\n-                                \"a?\".repeat(n),\n-                                \"a\".repeat(n)).as_slice()).unwrap();\n-    let text = \"a\".repeat(n);\n+                                repeat(\"a?\").take(n).collect::<String>(),\n+                                repeat(\"a\").take(n).collect::<String>()).as_slice()).unwrap();\n+    let text = repeat(\"a\").take(n).collect::<String>();\n     bench_assert_match(b, re, text.as_slice());\n }\n \n #[bench]\n fn literal(b: &mut Bencher) {\n     let re = regex!(\"y\");\n-    let text = format!(\"{}y\", \"x\".repeat(50));\n+    let text = format!(\"{}y\", repeat(\"x\").take(50).collect::<String>());\n     bench_assert_match(b, re, text.as_slice());\n }\n \n #[bench]\n fn not_literal(b: &mut Bencher) {\n     let re = regex!(\".y\");\n-    let text = format!(\"{}y\", \"x\".repeat(50));\n+    let text = format!(\"{}y\", repeat(\"x\").take(50).collect::<String>());\n     bench_assert_match(b, re, text.as_slice());\n }\n \n #[bench]\n fn match_class(b: &mut Bencher) {\n     let re = regex!(\"[abcdw]\");\n-    let text = format!(\"{}w\", \"xxxx\".repeat(20));\n+    let text = format!(\"{}w\", repeat(\"xxxx\").take(20).collect::<String>());\n     bench_assert_match(b, re, text.as_slice());\n }\n \n #[bench]\n fn match_class_in_range(b: &mut Bencher) {\n     // 'b' is between 'a' and 'c', so the class range checking doesn't help.\n     let re = regex!(\"[ac]\");\n-    let text = format!(\"{}c\", \"bbbb\".repeat(20));\n+    let text = format!(\"{}c\", repeat(\"bbbb\").take(20).collect::<String>());\n     bench_assert_match(b, re, text.as_slice());\n }\n \n@@ -77,7 +78,7 @@ fn anchored_literal_short_non_match(b: &mut Bencher) {\n #[bench]\n fn anchored_literal_long_non_match(b: &mut Bencher) {\n     let re = regex!(\"^zbc(d|e)\");\n-    let text = \"abcdefghijklmnopqrstuvwxyz\".repeat(15);\n+    let text = repeat(\"abcdefghijklmnopqrstuvwxyz\").take(15).collect::<String>();\n     b.iter(|| re.is_match(text.as_slice()));\n }\n \n@@ -91,7 +92,7 @@ fn anchored_literal_short_match(b: &mut Bencher) {\n #[bench]\n fn anchored_literal_long_match(b: &mut Bencher) {\n     let re = regex!(\"^.bc(d|e)\");\n-    let text = \"abcdefghijklmnopqrstuvwxyz\".repeat(15);\n+    let text = repeat(\"abcdefghijklmnopqrstuvwxyz\").take(15).collect::<String>();\n     b.iter(|| re.is_match(text.as_slice()));\n }\n "}]}