{"sha": "d9d9246418ae884cb67feb3574832696660b8e2e", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ5ZDkyNDY0MThhZTg4NGNiNjdmZWIzNTc0ODMyNjk2NjYwYjhlMmU=", "commit": {"author": {"name": "Matthew Jasper", "email": "mjjasper1@gmail.com", "date": "2019-08-05T22:10:32Z"}, "committer": {"name": "Matthew Jasper", "email": "mjjasper1@gmail.com", "date": "2019-08-05T22:50:47Z"}, "message": "Remove gensym from format_args", "tree": {"sha": "7c1057d7534bd270c9c4460bed00d3043771312c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7c1057d7534bd270c9c4460bed00d3043771312c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d9d9246418ae884cb67feb3574832696660b8e2e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d9d9246418ae884cb67feb3574832696660b8e2e", "html_url": "https://github.com/rust-lang/rust/commit/d9d9246418ae884cb67feb3574832696660b8e2e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d9d9246418ae884cb67feb3574832696660b8e2e/comments", "author": {"login": "matthewjasper", "id": 20113453, "node_id": "MDQ6VXNlcjIwMTEzNDUz", "avatar_url": "https://avatars.githubusercontent.com/u/20113453?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthewjasper", "html_url": "https://github.com/matthewjasper", "followers_url": "https://api.github.com/users/matthewjasper/followers", "following_url": "https://api.github.com/users/matthewjasper/following{/other_user}", "gists_url": "https://api.github.com/users/matthewjasper/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthewjasper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthewjasper/subscriptions", "organizations_url": "https://api.github.com/users/matthewjasper/orgs", "repos_url": "https://api.github.com/users/matthewjasper/repos", "events_url": "https://api.github.com/users/matthewjasper/events{/privacy}", "received_events_url": "https://api.github.com/users/matthewjasper/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matthewjasper", "id": 20113453, "node_id": "MDQ6VXNlcjIwMTEzNDUz", "avatar_url": "https://avatars.githubusercontent.com/u/20113453?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthewjasper", "html_url": "https://github.com/matthewjasper", "followers_url": "https://api.github.com/users/matthewjasper/followers", "following_url": "https://api.github.com/users/matthewjasper/following{/other_user}", "gists_url": "https://api.github.com/users/matthewjasper/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthewjasper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthewjasper/subscriptions", "organizations_url": "https://api.github.com/users/matthewjasper/orgs", "repos_url": "https://api.github.com/users/matthewjasper/repos", "events_url": "https://api.github.com/users/matthewjasper/events{/privacy}", "received_events_url": "https://api.github.com/users/matthewjasper/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7b41fd215893c06110c7f650be47efed3910d90b", "url": "https://api.github.com/repos/rust-lang/rust/commits/7b41fd215893c06110c7f650be47efed3910d90b", "html_url": "https://github.com/rust-lang/rust/commit/7b41fd215893c06110c7f650be47efed3910d90b"}], "stats": {"total": 26, "additions": 14, "deletions": 12}, "files": [{"sha": "6a2c3bff4ddcac34cbdae1639824efb6b8e7acf3", "filename": "src/libcore/macros.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d9d9246418ae884cb67feb3574832696660b8e2e/src%2Flibcore%2Fmacros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d9d9246418ae884cb67feb3574832696660b8e2e/src%2Flibcore%2Fmacros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fmacros.rs?ref=d9d9246418ae884cb67feb3574832696660b8e2e", "patch": "@@ -767,7 +767,6 @@ pub(crate) mod builtin {\n     #[stable(feature = \"rust1\", since = \"1.0.0\")]\n     #[allow_internal_unstable(fmt_internals)]\n     #[rustc_builtin_macro]\n-    #[rustc_macro_transparency = \"semitransparent\"]\n     pub macro format_args {\n         ($fmt:expr) => ({ /* compiler built-in */ }),\n         ($fmt:expr, $($args:tt)*) => ({ /* compiler built-in */ })\n@@ -779,7 +778,6 @@ pub(crate) mod builtin {\n                          language use and is subject to change\")]\n     #[allow_internal_unstable(fmt_internals)]\n     #[rustc_builtin_macro]\n-    #[rustc_macro_transparency = \"semitransparent\"]\n     pub macro format_args_nl {\n         ($fmt:expr) => ({ /* compiler built-in */ }),\n         ($fmt:expr, $($args:tt)*) => ({ /* compiler built-in */ })"}, {"sha": "1dfcc14021c3b9ecd3e1ed2baaf49e748accf9d3", "filename": "src/libsyntax_ext/format.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d9d9246418ae884cb67feb3574832696660b8e2e/src%2Flibsyntax_ext%2Fformat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d9d9246418ae884cb67feb3574832696660b8e2e/src%2Flibsyntax_ext%2Fformat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax_ext%2Fformat.rs?ref=d9d9246418ae884cb67feb3574832696660b8e2e", "patch": "@@ -646,7 +646,7 @@ impl<'a, 'b> Context<'a, 'b> {\n         let mut heads = Vec::with_capacity(self.args.len());\n \n         let names_pos: Vec<_> = (0..self.args.len())\n-            .map(|i| self.ecx.ident_of(&format!(\"arg{}\", i)).gensym())\n+            .map(|i| ast::Ident::from_str_and_span(&format!(\"arg{}\", i), self.macsp))\n             .collect();\n \n         // First, build up the static array which will become our precompiled\n@@ -843,7 +843,7 @@ pub fn expand_preparsed_format_args(\n     let arg_unique_types: Vec<_> = (0..args.len()).map(|_| Vec::new()).collect();\n \n     let mut macsp = ecx.call_site();\n-    macsp = macsp.apply_mark(ecx.current_expansion.id);\n+    macsp = macsp.with_ctxt(ecx.backtrace());\n \n     let msg = \"format argument must be a string literal\";\n     let fmt_sp = efmt.span;"}, {"sha": "6bf5ae8beaddb91a9984df5187eab1198443f79e", "filename": "src/test/ui/format-hygiene.rs", "status": "removed", "additions": 0, "deletions": 8, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/7b41fd215893c06110c7f650be47efed3910d90b/src%2Ftest%2Fui%2Fformat-hygiene.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7b41fd215893c06110c7f650be47efed3910d90b/src%2Ftest%2Fui%2Fformat-hygiene.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fformat-hygiene.rs?ref=7b41fd215893c06110c7f650be47efed3910d90b", "patch": "@@ -1,8 +0,0 @@\n-// run-pass\n-\n-#![allow(non_upper_case_globals)]\n-pub const arg0: u8 = 1;\n-\n-pub fn main() {\n-    format!(\"{}\", 1);\n-}"}, {"sha": "d74889b95cc12de3a8ce704f6381ada6e564953f", "filename": "src/test/ui/hygiene/format-args.rs", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/d9d9246418ae884cb67feb3574832696660b8e2e/src%2Ftest%2Fui%2Fhygiene%2Fformat-args.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d9d9246418ae884cb67feb3574832696660b8e2e/src%2Ftest%2Fui%2Fhygiene%2Fformat-args.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fhygiene%2Fformat-args.rs?ref=d9d9246418ae884cb67feb3574832696660b8e2e", "patch": "@@ -0,0 +1,12 @@\n+// check-pass\n+\n+#![allow(non_upper_case_globals)]\n+#![feature(format_args_nl)]\n+\n+static arg0: () = ();\n+\n+fn main() {\n+    static arg1: () = ();\n+    format_args!(\"{} {:?}\", 0, 1);\n+    format_args_nl!(\"{} {:?}\", 0, 1);\n+}"}]}