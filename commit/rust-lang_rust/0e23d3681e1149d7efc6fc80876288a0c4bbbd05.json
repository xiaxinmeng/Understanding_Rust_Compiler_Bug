{"sha": "0e23d3681e1149d7efc6fc80876288a0c4bbbd05", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBlMjNkMzY4MWUxMTQ5ZDdlZmM2ZmM4MDg3NjI4OGEwYzRiYmJkMDU=", "commit": {"author": {"name": "Jonas Schievink", "email": "jonasschievink@gmail.com", "date": "2020-02-09T17:23:31Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-02-09T17:23:31Z"}, "message": "Rollup merge of #68881 - eddyb:always-preserve-dbg-vars, r=nagisa\n\nrustc_codegen_llvm: always set AlwaysPreserve on all debuginfo variables\n\nMaking this depend on the optimization level appears to have been a copy-paste mistake (other LLVM functions called in this module also take a `bool` argument, but there it means something unrelated).\nAlso see https://github.com/rust-lang/rust/pull/8855#discussion_r374392128.\n\nI don't believe we have any reason to let LLVM omit user variables from DWARF, and we were already setting this to `true` when LLVM *could* optimize them away, so this PR should have no effect anyway.\n\nr? @michaelwoerister or @nagisa cc @hanna-kruppe @nikomatsakis", "tree": {"sha": "0d0a341ab95eb6e9e66170d7c184b0cfb7982aac", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0d0a341ab95eb6e9e66170d7c184b0cfb7982aac"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0e23d3681e1149d7efc6fc80876288a0c4bbbd05", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJeQEATCRBK7hj4Ov3rIwAAdHIIAD9eOYB8OECjlPJt3QCAvCTg\nnBzg9Dy+4ZHBvdWQNJbwidt/nw2Mp3O15OzYn5f/8vl7Kf2Ytl8TdkCUsIvK5qUT\nSuI2EmVjiE0L9WH9MN4CP+UrJdo82dXFNOjHBf4xHptsx7AiUOZ3DGlgikLVnotp\nQtEn276XAsctlPYeRmSZWJg9x5g5xx5oRoic/50DHeltsPgxp6adcDh/wmBmikbD\notMRfPEy9uzjEjh0pTKhi70fd1Hb6db+8TfTH38SifVqWbpAAV3oHLQZ0CfyKQBe\nKivPQM6k172b/hBtQXcQtZr1Gomh9OwX1haeT6N9c4xbsmlZRZYzhlVy6un0de4=\n=9CjP\n-----END PGP SIGNATURE-----\n", "payload": "tree 0d0a341ab95eb6e9e66170d7c184b0cfb7982aac\nparent 3516df3ecbc97a449221e7a02cf750bf8726b5c1\nparent b82f6c575e53f06c3645f66a9d480b4f025ee39e\nauthor Jonas Schievink <jonasschievink@gmail.com> 1581269011 +0100\ncommitter GitHub <noreply@github.com> 1581269011 +0100\n\nRollup merge of #68881 - eddyb:always-preserve-dbg-vars, r=nagisa\n\nrustc_codegen_llvm: always set AlwaysPreserve on all debuginfo variables\n\nMaking this depend on the optimization level appears to have been a copy-paste mistake (other LLVM functions called in this module also take a `bool` argument, but there it means something unrelated).\nAlso see https://github.com/rust-lang/rust/pull/8855#discussion_r374392128.\n\nI don't believe we have any reason to let LLVM omit user variables from DWARF, and we were already setting this to `true` when LLVM *could* optimize them away, so this PR should have no effect anyway.\n\nr? @michaelwoerister or @nagisa cc @hanna-kruppe @nikomatsakis\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0e23d3681e1149d7efc6fc80876288a0c4bbbd05", "html_url": "https://github.com/rust-lang/rust/commit/0e23d3681e1149d7efc6fc80876288a0c4bbbd05", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0e23d3681e1149d7efc6fc80876288a0c4bbbd05/comments", "author": {"login": "jonas-schievink", "id": 1786438, "node_id": "MDQ6VXNlcjE3ODY0Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/1786438?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonas-schievink", "html_url": "https://github.com/jonas-schievink", "followers_url": "https://api.github.com/users/jonas-schievink/followers", "following_url": "https://api.github.com/users/jonas-schievink/following{/other_user}", "gists_url": "https://api.github.com/users/jonas-schievink/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonas-schievink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonas-schievink/subscriptions", "organizations_url": "https://api.github.com/users/jonas-schievink/orgs", "repos_url": "https://api.github.com/users/jonas-schievink/repos", "events_url": "https://api.github.com/users/jonas-schievink/events{/privacy}", "received_events_url": "https://api.github.com/users/jonas-schievink/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3516df3ecbc97a449221e7a02cf750bf8726b5c1", "url": "https://api.github.com/repos/rust-lang/rust/commits/3516df3ecbc97a449221e7a02cf750bf8726b5c1", "html_url": "https://github.com/rust-lang/rust/commit/3516df3ecbc97a449221e7a02cf750bf8726b5c1"}, {"sha": "b82f6c575e53f06c3645f66a9d480b4f025ee39e", "url": "https://api.github.com/repos/rust-lang/rust/commits/b82f6c575e53f06c3645f66a9d480b4f025ee39e", "html_url": "https://github.com/rust-lang/rust/commit/b82f6c575e53f06c3645f66a9d480b4f025ee39e"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "22effb102fd67d18815cbae542448ffd7e6a1b22", "filename": "src/librustc_codegen_llvm/debuginfo/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0e23d3681e1149d7efc6fc80876288a0c4bbbd05/src%2Flibrustc_codegen_llvm%2Fdebuginfo%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0e23d3681e1149d7efc6fc80876288a0c4bbbd05/src%2Flibrustc_codegen_llvm%2Fdebuginfo%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Fdebuginfo%2Fmod.rs?ref=0e23d3681e1149d7efc6fc80876288a0c4bbbd05", "patch": "@@ -559,7 +559,7 @@ impl DebugInfoMethods<'tcx> for CodegenCx<'ll, 'tcx> {\n                 file_metadata,\n                 loc.line as c_uint,\n                 type_metadata,\n-                self.sess().opts.optimize != config::OptLevel::No,\n+                true,\n                 DIFlags::FlagZero,\n                 argument_index,\n                 align.bytes() as u32,"}]}