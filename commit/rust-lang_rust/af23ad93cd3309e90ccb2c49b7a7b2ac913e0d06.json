{"sha": "af23ad93cd3309e90ccb2c49b7a7b2ac913e0d06", "node_id": "C_kwDOAAsO6NoAKGFmMjNhZDkzY2QzMzA5ZTkwY2NiMmM0OWI3YTdiMmFjOTEzZTBkMDY", "commit": {"author": {"name": "Nilstrieb", "email": "48135649+Nilstrieb@users.noreply.github.com", "date": "2022-12-30T20:11:17Z"}, "committer": {"name": "nils", "email": "48135649+Nilstrieb@users.noreply.github.com", "date": "2023-01-17T07:14:35Z"}, "message": "Improve comments", "tree": {"sha": "4061af827e64c9f2369b594f6cadb9691f9f0db5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4061af827e64c9f2369b594f6cadb9691f9f0db5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/af23ad93cd3309e90ccb2c49b7a7b2ac913e0d06", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/af23ad93cd3309e90ccb2c49b7a7b2ac913e0d06", "html_url": "https://github.com/rust-lang/rust/commit/af23ad93cd3309e90ccb2c49b7a7b2ac913e0d06", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/af23ad93cd3309e90ccb2c49b7a7b2ac913e0d06/comments", "author": {"login": "Nilstrieb", "id": 48135649, "node_id": "MDQ6VXNlcjQ4MTM1NjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/48135649?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nilstrieb", "html_url": "https://github.com/Nilstrieb", "followers_url": "https://api.github.com/users/Nilstrieb/followers", "following_url": "https://api.github.com/users/Nilstrieb/following{/other_user}", "gists_url": "https://api.github.com/users/Nilstrieb/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nilstrieb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nilstrieb/subscriptions", "organizations_url": "https://api.github.com/users/Nilstrieb/orgs", "repos_url": "https://api.github.com/users/Nilstrieb/repos", "events_url": "https://api.github.com/users/Nilstrieb/events{/privacy}", "received_events_url": "https://api.github.com/users/Nilstrieb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Nilstrieb", "id": 48135649, "node_id": "MDQ6VXNlcjQ4MTM1NjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/48135649?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nilstrieb", "html_url": "https://github.com/Nilstrieb", "followers_url": "https://api.github.com/users/Nilstrieb/followers", "following_url": "https://api.github.com/users/Nilstrieb/following{/other_user}", "gists_url": "https://api.github.com/users/Nilstrieb/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nilstrieb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nilstrieb/subscriptions", "organizations_url": "https://api.github.com/users/Nilstrieb/orgs", "repos_url": "https://api.github.com/users/Nilstrieb/repos", "events_url": "https://api.github.com/users/Nilstrieb/events{/privacy}", "received_events_url": "https://api.github.com/users/Nilstrieb/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "645c0fddd2e0446cc0e6eecd8a78de4b5ab5a967", "url": "https://api.github.com/repos/rust-lang/rust/commits/645c0fddd2e0446cc0e6eecd8a78de4b5ab5a967", "html_url": "https://github.com/rust-lang/rust/commit/645c0fddd2e0446cc0e6eecd8a78de4b5ab5a967"}], "stats": {"total": 8, "additions": 1, "deletions": 7}, "files": [{"sha": "669f84ae1b4720a09f5ec6a46d28b8db93618624", "filename": "compiler/rustc_ty_utils/src/abi.rs", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/af23ad93cd3309e90ccb2c49b7a7b2ac913e0d06/compiler%2Frustc_ty_utils%2Fsrc%2Fabi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/af23ad93cd3309e90ccb2c49b7a7b2ac913e0d06/compiler%2Frustc_ty_utils%2Fsrc%2Fabi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ty_utils%2Fsrc%2Fabi.rs?ref=af23ad93cd3309e90ccb2c49b7a7b2ac913e0d06", "patch": "@@ -219,7 +219,6 @@ fn adjust_for_rust_scalar<'tcx>(\n         return;\n     }\n \n-    // Scalars which have invalid values cannot be undef.\n     if !scalar.is_uninit_valid() {\n         attrs.set(ArgAttribute::NoUndef);\n     }\n@@ -246,11 +245,6 @@ fn adjust_for_rust_scalar<'tcx>(\n                 PointerKind::SharedMutable | PointerKind::UniqueOwned => Size::ZERO,\n             };\n \n-            // `Box`, `&T`, and `&mut T` cannot be undef.\n-            // Note that this only applies to the value of the pointer itself;\n-            // this attribute doesn't make it UB for the pointed-to data to be undef.\n-            attrs.set(ArgAttribute::NoUndef);\n-\n             // The aliasing rules for `Box<T>` are still not decided, but currently we emit\n             // `noalias` for it. This can be turned off using an unstable flag.\n             // See https://github.com/rust-lang/unsafe-code-guidelines/issues/326"}, {"sha": "7c3bf07cc811fb2e19d5917780199de561101da0", "filename": "tests/codegen/loads.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/af23ad93cd3309e90ccb2c49b7a7b2ac913e0d06/tests%2Fcodegen%2Floads.rs", "raw_url": "https://github.com/rust-lang/rust/raw/af23ad93cd3309e90ccb2c49b7a7b2ac913e0d06/tests%2Fcodegen%2Floads.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcodegen%2Floads.rs?ref=af23ad93cd3309e90ccb2c49b7a7b2ac913e0d06", "patch": "@@ -50,7 +50,7 @@ pub fn load_scalar_pair<'a>(x: &(&'a i32, &'a Align16)) -> (&'a i32, &'a Align16\n // CHECK-LABEL: @load_raw_pointer\n #[no_mangle]\n pub fn load_raw_pointer<'a>(x: &*const i32) -> *const i32 {\n-    // loaded raw pointer should not have !nonnull, !align, or !noundef metadata\n+    // loaded raw pointer should not have !nonnull or !align metadata\n     // CHECK: load {{i32\\*|ptr}}, {{i32\\*\\*|ptr}} %x, align [[PTR_ALIGNMENT]], !noundef !2{{$}}\n     *x\n }"}]}