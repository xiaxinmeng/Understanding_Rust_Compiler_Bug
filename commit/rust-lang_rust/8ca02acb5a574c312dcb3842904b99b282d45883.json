{"sha": "8ca02acb5a574c312dcb3842904b99b282d45883", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhjYTAyYWNiNWE1NzRjMzEyZGNiMzg0MjkwNGI5OWIyODJkNDU4ODM=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-01-28T15:53:53Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-01-28T18:18:24Z"}, "message": "Generic params in structs", "tree": {"sha": "d1707c94eda435c95408f73ec530aa5ac2386920", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d1707c94eda435c95408f73ec530aa5ac2386920"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8ca02acb5a574c312dcb3842904b99b282d45883", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8ca02acb5a574c312dcb3842904b99b282d45883", "html_url": "https://github.com/rust-lang/rust/commit/8ca02acb5a574c312dcb3842904b99b282d45883", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8ca02acb5a574c312dcb3842904b99b282d45883/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7e55b2693f17afdae91c492c6f79c9ba4020d893", "url": "https://api.github.com/repos/rust-lang/rust/commits/7e55b2693f17afdae91c492c6f79c9ba4020d893", "html_url": "https://github.com/rust-lang/rust/commit/7e55b2693f17afdae91c492c6f79c9ba4020d893"}], "stats": {"total": 297, "additions": 294, "deletions": 3}, "files": [{"sha": "7c76d595d05796a2b1c39a12bb1374c0e0d74c9a", "filename": "grammar.ron", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/8ca02acb5a574c312dcb3842904b99b282d45883/grammar.ron", "raw_url": "https://github.com/rust-lang/rust/raw/8ca02acb5a574c312dcb3842904b99b282d45883/grammar.ron", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/grammar.ron?ref=8ca02acb5a574c312dcb3842904b99b282d45883", "patch": "@@ -88,5 +88,8 @@ Grammar(\n         \"LITERAL\",\n         \"ALIAS\",\n         \"VISIBILITY\",\n+        \"TYPE_PARAM_LIST\",\n+        \"LIFETIME_PARAM\",\n+        \"TYPE_PARAM\",\n     ]\n-)\n\\ No newline at end of file\n+)"}, {"sha": "f10fb230b483cdec9620e7384b7b7f7c74cae386", "filename": "src/parser/event_parser/grammar/items/mod.rs", "status": "modified", "additions": 43, "deletions": 1, "changes": 44, "blob_url": "https://github.com/rust-lang/rust/blob/8ca02acb5a574c312dcb3842904b99b282d45883/src%2Fparser%2Fevent_parser%2Fgrammar%2Fitems%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8ca02acb5a574c312dcb3842904b99b282d45883/src%2Fparser%2Fevent_parser%2Fgrammar%2Fitems%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fparser%2Fevent_parser%2Fgrammar%2Fitems%2Fmod.rs?ref=8ca02acb5a574c312dcb3842904b99b282d45883", "patch": "@@ -59,7 +59,49 @@ fn item(p: &mut Parser) {\n     item.complete(p, item_kind);\n }\n \n-fn generic_parameters(_: &mut Parser) {}\n+fn type_param_list(p: &mut Parser) {\n+    if !p.at(L_ANGLE) {\n+        return;\n+    }\n+    let m = p.start();\n+    p.bump();\n+\n+    while !p.at(EOF) && !p.at(R_ANGLE) {\n+        match p.current() {\n+            LIFETIME => lifetime_param(p),\n+            IDENT => type_param(p),\n+            _ => p.err_and_bump(\"expected type parameter\"),\n+        }\n+        if !p.at(R_ANGLE) && !p.expect(COMMA) {\n+            break;\n+        }\n+    }\n+    p.expect(R_ANGLE);\n+    m.complete(p, TYPE_PARAM_LIST);\n+\n+    fn lifetime_param(p: &mut Parser) {\n+        assert!(p.at(LIFETIME));\n+        let m = p.start();\n+        p.bump();\n+        if p.eat(COLON) {\n+            while p.at(LIFETIME) {\n+                p.bump();\n+                if !p.eat(PLUS) {\n+                    break;\n+                }\n+            }\n+        }\n+        m.complete(p, LIFETIME_PARAM);\n+    }\n+\n+    fn type_param(p: &mut Parser) {\n+        assert!(p.at(IDENT));\n+        let m = p.start();\n+        p.bump();\n+        m.complete(p, TYPE_PARAM);\n+        //TODO: bounds\n+    }\n+}\n \n fn where_clause(_: &mut Parser) {}\n "}, {"sha": "0934f3d284036bc2307b62cfa6a2d41801864169", "filename": "src/parser/event_parser/grammar/items/structs.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/8ca02acb5a574c312dcb3842904b99b282d45883/src%2Fparser%2Fevent_parser%2Fgrammar%2Fitems%2Fstructs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8ca02acb5a574c312dcb3842904b99b282d45883/src%2Fparser%2Fevent_parser%2Fgrammar%2Fitems%2Fstructs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fparser%2Fevent_parser%2Fgrammar%2Fitems%2Fstructs.rs?ref=8ca02acb5a574c312dcb3842904b99b282d45883", "patch": "@@ -7,7 +7,7 @@ pub(super) fn struct_item(p: &mut Parser) {\n     if !p.expect(IDENT) {\n         return;\n     }\n-    generic_parameters(p);\n+    type_param_list(p);\n     match p.current() {\n         WHERE_KW => {\n             where_clause(p);"}, {"sha": "b6c281cd56be2076b892ec2182903b5ddf31d72d", "filename": "src/syntax_kinds.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/8ca02acb5a574c312dcb3842904b99b282d45883/src%2Fsyntax_kinds.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8ca02acb5a574c312dcb3842904b99b282d45883/src%2Fsyntax_kinds.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fsyntax_kinds.rs?ref=8ca02acb5a574c312dcb3842904b99b282d45883", "patch": "@@ -90,6 +90,9 @@ pub enum SyntaxKind {\n     LITERAL,\n     ALIAS,\n     VISIBILITY,\n+    TYPE_PARAM_LIST,\n+    LIFETIME_PARAM,\n+    TYPE_PARAM,\n \n     // Technical SyntaxKinds: they appear temporally during parsing,\n     // but never end up in the final tree\n@@ -187,6 +190,9 @@ impl SyntaxKind {\n             LITERAL => &SyntaxInfo { name: \"LITERAL\" },\n             ALIAS => &SyntaxInfo { name: \"ALIAS\" },\n             VISIBILITY => &SyntaxInfo { name: \"VISIBILITY\" },\n+            TYPE_PARAM_LIST => &SyntaxInfo { name: \"TYPE_PARAM_LIST\" },\n+            LIFETIME_PARAM => &SyntaxInfo { name: \"LIFETIME_PARAM\" },\n+            TYPE_PARAM => &SyntaxInfo { name: \"TYPE_PARAM\" },\n \n             TOMBSTONE => &SyntaxInfo { name: \"TOMBSTONE\" },\n             EOF => &SyntaxInfo { name: \"EOF\" },"}, {"sha": "88c544923b54d69fe5497321e1e689780b9fc450", "filename": "tests/data/parser/ok/0018_struct_type_params.rs", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/8ca02acb5a574c312dcb3842904b99b282d45883/tests%2Fdata%2Fparser%2Fok%2F0018_struct_type_params.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8ca02acb5a574c312dcb3842904b99b282d45883/tests%2Fdata%2Fparser%2Fok%2F0018_struct_type_params.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Fok%2F0018_struct_type_params.rs?ref=8ca02acb5a574c312dcb3842904b99b282d45883", "patch": "@@ -0,0 +1,17 @@\n+struct S1<T>;\n+struct S2<T>(u32);\n+struct S3<T> { u: u32 }\n+\n+struct S4<>;\n+struct S5<'a>;\n+struct S6<'a:>;\n+struct S7<'a: 'b>;\n+struct S8<'a: 'b + >;\n+struct S9<'a: 'b + 'c>;\n+struct S10<'a,>;\n+struct S11<'a, 'b>;\n+struct S12<'a: 'b+, 'b: 'c,>;\n+\n+struct S13<T>;\n+struct S14<T, U>;\n+struct S15<'a, T, U>;"}, {"sha": "b2e7ef9d7558960d9a516c167b6a26cd41177f47", "filename": "tests/data/parser/ok/0018_struct_type_params.txt", "status": "added", "additions": 223, "deletions": 0, "changes": 223, "blob_url": "https://github.com/rust-lang/rust/blob/8ca02acb5a574c312dcb3842904b99b282d45883/tests%2Fdata%2Fparser%2Fok%2F0018_struct_type_params.txt", "raw_url": "https://github.com/rust-lang/rust/raw/8ca02acb5a574c312dcb3842904b99b282d45883/tests%2Fdata%2Fparser%2Fok%2F0018_struct_type_params.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Fok%2F0018_struct_type_params.txt?ref=8ca02acb5a574c312dcb3842904b99b282d45883", "patch": "@@ -0,0 +1,223 @@\n+FILE@[0; 290)\n+  STRUCT_ITEM@[0; 14)\n+    STRUCT_KW@[0; 6)\n+    WHITESPACE@[6; 7)\n+    IDENT@[7; 9)\n+    TYPE_PARAM_LIST@[9; 12)\n+      L_ANGLE@[9; 10)\n+      TYPE_PARAM@[10; 11)\n+        IDENT@[10; 11)\n+      R_ANGLE@[11; 12)\n+    SEMI@[12; 13)\n+    WHITESPACE@[13; 14)\n+  STRUCT_ITEM@[14; 33)\n+    STRUCT_KW@[14; 20)\n+    WHITESPACE@[20; 21)\n+    IDENT@[21; 23)\n+    TYPE_PARAM_LIST@[23; 26)\n+      L_ANGLE@[23; 24)\n+      TYPE_PARAM@[24; 25)\n+        IDENT@[24; 25)\n+      R_ANGLE@[25; 26)\n+    L_PAREN@[26; 27)\n+    POS_FIELD@[27; 30)\n+      IDENT@[27; 30)\n+    R_PAREN@[30; 31)\n+    SEMI@[31; 32)\n+    WHITESPACE@[32; 33)\n+  STRUCT_ITEM@[33; 58)\n+    STRUCT_KW@[33; 39)\n+    WHITESPACE@[39; 40)\n+    IDENT@[40; 42)\n+    TYPE_PARAM_LIST@[42; 46)\n+      L_ANGLE@[42; 43)\n+      TYPE_PARAM@[43; 44)\n+        IDENT@[43; 44)\n+      R_ANGLE@[44; 45)\n+      WHITESPACE@[45; 46)\n+    L_CURLY@[46; 47)\n+    NAMED_FIELD@[47; 55)\n+      WHITESPACE@[47; 48)\n+      IDENT@[48; 49)\n+      COLON@[49; 50)\n+      WHITESPACE@[50; 51)\n+      IDENT@[51; 54)\n+      WHITESPACE@[54; 55)\n+    R_CURLY@[55; 56)\n+    WHITESPACE@[56; 58)\n+  STRUCT_ITEM@[58; 71)\n+    STRUCT_KW@[58; 64)\n+    WHITESPACE@[64; 65)\n+    IDENT@[65; 67)\n+    TYPE_PARAM_LIST@[67; 69)\n+      L_ANGLE@[67; 68)\n+      R_ANGLE@[68; 69)\n+    SEMI@[69; 70)\n+    WHITESPACE@[70; 71)\n+  STRUCT_ITEM@[71; 86)\n+    STRUCT_KW@[71; 77)\n+    WHITESPACE@[77; 78)\n+    IDENT@[78; 80)\n+    TYPE_PARAM_LIST@[80; 84)\n+      L_ANGLE@[80; 81)\n+      LIFETIME_PARAM@[81; 83)\n+        LIFETIME@[81; 83)\n+      R_ANGLE@[83; 84)\n+    SEMI@[84; 85)\n+    WHITESPACE@[85; 86)\n+  STRUCT_ITEM@[86; 102)\n+    STRUCT_KW@[86; 92)\n+    WHITESPACE@[92; 93)\n+    IDENT@[93; 95)\n+    TYPE_PARAM_LIST@[95; 100)\n+      L_ANGLE@[95; 96)\n+      LIFETIME_PARAM@[96; 99)\n+        LIFETIME@[96; 98)\n+        COLON@[98; 99)\n+      R_ANGLE@[99; 100)\n+    SEMI@[100; 101)\n+    WHITESPACE@[101; 102)\n+  STRUCT_ITEM@[102; 121)\n+    STRUCT_KW@[102; 108)\n+    WHITESPACE@[108; 109)\n+    IDENT@[109; 111)\n+    TYPE_PARAM_LIST@[111; 119)\n+      L_ANGLE@[111; 112)\n+      LIFETIME_PARAM@[112; 118)\n+        LIFETIME@[112; 114)\n+        COLON@[114; 115)\n+        WHITESPACE@[115; 116)\n+        LIFETIME@[116; 118)\n+      R_ANGLE@[118; 119)\n+    SEMI@[119; 120)\n+    WHITESPACE@[120; 121)\n+  STRUCT_ITEM@[121; 143)\n+    STRUCT_KW@[121; 127)\n+    WHITESPACE@[127; 128)\n+    IDENT@[128; 130)\n+    TYPE_PARAM_LIST@[130; 141)\n+      L_ANGLE@[130; 131)\n+      LIFETIME_PARAM@[131; 140)\n+        LIFETIME@[131; 133)\n+        COLON@[133; 134)\n+        WHITESPACE@[134; 135)\n+        LIFETIME@[135; 137)\n+        WHITESPACE@[137; 138)\n+        PLUS@[138; 139)\n+        WHITESPACE@[139; 140)\n+      R_ANGLE@[140; 141)\n+    SEMI@[141; 142)\n+    WHITESPACE@[142; 143)\n+  STRUCT_ITEM@[143; 167)\n+    STRUCT_KW@[143; 149)\n+    WHITESPACE@[149; 150)\n+    IDENT@[150; 152)\n+    TYPE_PARAM_LIST@[152; 165)\n+      L_ANGLE@[152; 153)\n+      LIFETIME_PARAM@[153; 164)\n+        LIFETIME@[153; 155)\n+        COLON@[155; 156)\n+        WHITESPACE@[156; 157)\n+        LIFETIME@[157; 159)\n+        WHITESPACE@[159; 160)\n+        PLUS@[160; 161)\n+        WHITESPACE@[161; 162)\n+        LIFETIME@[162; 164)\n+      R_ANGLE@[164; 165)\n+    SEMI@[165; 166)\n+    WHITESPACE@[166; 167)\n+  STRUCT_ITEM@[167; 184)\n+    STRUCT_KW@[167; 173)\n+    WHITESPACE@[173; 174)\n+    IDENT@[174; 177)\n+    TYPE_PARAM_LIST@[177; 182)\n+      L_ANGLE@[177; 178)\n+      LIFETIME_PARAM@[178; 180)\n+        LIFETIME@[178; 180)\n+      COMMA@[180; 181)\n+      R_ANGLE@[181; 182)\n+    SEMI@[182; 183)\n+    WHITESPACE@[183; 184)\n+  STRUCT_ITEM@[184; 204)\n+    STRUCT_KW@[184; 190)\n+    WHITESPACE@[190; 191)\n+    IDENT@[191; 194)\n+    TYPE_PARAM_LIST@[194; 202)\n+      L_ANGLE@[194; 195)\n+      LIFETIME_PARAM@[195; 197)\n+        LIFETIME@[195; 197)\n+      COMMA@[197; 198)\n+      LIFETIME_PARAM@[198; 201)\n+        WHITESPACE@[198; 199)\n+        LIFETIME@[199; 201)\n+      R_ANGLE@[201; 202)\n+    SEMI@[202; 203)\n+    WHITESPACE@[203; 204)\n+  STRUCT_ITEM@[204; 235)\n+    STRUCT_KW@[204; 210)\n+    WHITESPACE@[210; 211)\n+    IDENT@[211; 214)\n+    TYPE_PARAM_LIST@[214; 232)\n+      L_ANGLE@[214; 215)\n+      LIFETIME_PARAM@[215; 222)\n+        LIFETIME@[215; 217)\n+        COLON@[217; 218)\n+        WHITESPACE@[218; 219)\n+        LIFETIME@[219; 221)\n+        PLUS@[221; 222)\n+      COMMA@[222; 223)\n+      LIFETIME_PARAM@[223; 230)\n+        WHITESPACE@[223; 224)\n+        LIFETIME@[224; 226)\n+        COLON@[226; 227)\n+        WHITESPACE@[227; 228)\n+        LIFETIME@[228; 230)\n+      COMMA@[230; 231)\n+      R_ANGLE@[231; 232)\n+    SEMI@[232; 233)\n+    WHITESPACE@[233; 235)\n+  STRUCT_ITEM@[235; 250)\n+    STRUCT_KW@[235; 241)\n+    WHITESPACE@[241; 242)\n+    IDENT@[242; 245)\n+    TYPE_PARAM_LIST@[245; 248)\n+      L_ANGLE@[245; 246)\n+      TYPE_PARAM@[246; 247)\n+        IDENT@[246; 247)\n+      R_ANGLE@[247; 248)\n+    SEMI@[248; 249)\n+    WHITESPACE@[249; 250)\n+  STRUCT_ITEM@[250; 268)\n+    STRUCT_KW@[250; 256)\n+    WHITESPACE@[256; 257)\n+    IDENT@[257; 260)\n+    TYPE_PARAM_LIST@[260; 266)\n+      L_ANGLE@[260; 261)\n+      TYPE_PARAM@[261; 262)\n+        IDENT@[261; 262)\n+      COMMA@[262; 263)\n+      TYPE_PARAM@[263; 265)\n+        WHITESPACE@[263; 264)\n+        IDENT@[264; 265)\n+      R_ANGLE@[265; 266)\n+    SEMI@[266; 267)\n+    WHITESPACE@[267; 268)\n+  STRUCT_ITEM@[268; 290)\n+    STRUCT_KW@[268; 274)\n+    WHITESPACE@[274; 275)\n+    IDENT@[275; 278)\n+    TYPE_PARAM_LIST@[278; 288)\n+      L_ANGLE@[278; 279)\n+      LIFETIME_PARAM@[279; 281)\n+        LIFETIME@[279; 281)\n+      COMMA@[281; 282)\n+      TYPE_PARAM@[282; 284)\n+        WHITESPACE@[282; 283)\n+        IDENT@[283; 284)\n+      COMMA@[284; 285)\n+      TYPE_PARAM@[285; 287)\n+        WHITESPACE@[285; 286)\n+        IDENT@[286; 287)\n+      R_ANGLE@[287; 288)\n+    SEMI@[288; 289)\n+    WHITESPACE@[289; 290)"}]}