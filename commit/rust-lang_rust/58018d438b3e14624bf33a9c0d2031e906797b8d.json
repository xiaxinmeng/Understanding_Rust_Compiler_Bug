{"sha": "58018d438b3e14624bf33a9c0d2031e906797b8d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU4MDE4ZDQzOGIzZTE0NjI0YmYzM2E5YzBkMjAzMWU5MDY3OTdiOGQ=", "commit": {"author": {"name": "Santiago Pastorino", "email": "spastorino@gmail.com", "date": "2020-10-20T16:23:58Z"}, "committer": {"name": "Santiago Pastorino", "email": "spastorino@gmail.com", "date": "2020-10-27T17:45:38Z"}, "message": "Properly restore within_fn_param value to the previous state", "tree": {"sha": "534223eab2b6d740e53f55e6f585b4ffb1f42537", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/534223eab2b6d740e53f55e6f585b4ffb1f42537"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/58018d438b3e14624bf33a9c0d2031e906797b8d", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEF0ntrgrd9qf9uuThgTGiTgx5768FAl+YXMIACgkQgTGiTgx5\n76+yew/+NOemLkF/ODoniVoPJhP7+C6j8Vw72yTDX44divgLh/VimYdG5uwyFdIe\ngVwJbyY1aMVKCwflXByYzNv/60l+L+9G0Q5gS1n24AwiQyoTotzNtedg0Er2/ak8\nZWA01IQQ9yB5UP/IC3etShNJVeXRdW3YKjYO/Eq8UYKI+KmJPUd3Woolxpd4MTS5\nFyjlmTPQWMzm5aJ6KuqiCqevmTGJmuCB/mRUlT8p/2MQlCl2fpHseprPi2AK3iai\nkShIf62Np/Uexrm05o4/fXj064ahKoFpbO1a5aIgc3WJ2Blj9r9BEGRH0rzLim6d\nRMBrw+JFUJuuTe41O5gapSak5pHovJPsvjnNnJ8kht1bxFfc3a1GOxf/CmW9b7lu\nGN0yNsVnsUR9GA17Crd0kkJu3CqBnoIPy7cbTZOjN9zIdkaauvlfhVhsxE6xxScl\ndtOYgZ4z4fif1l5IjLYWj1pXIxo227nHPBsCTLchvx3LUQppPKzn7QkAL6lJnfdQ\niRpgMmcJC9zk5cKKOJ+4pAZLYjHT7QuH6kvc2/LOZuWBEOLeb17KfFQmF9/yO3d+\nUFcc/CQWfSHPRiYyaZkafGV9YAKx+3fG3btWIaPHfPJNZe3xlAmCNX+xw5a64L3c\nuf9uuamQoF9QcVjd6BiKRHwtyCR3B77Fmgtve/DjCSGZl139TYI=\n=ozsx\n-----END PGP SIGNATURE-----", "payload": "tree 534223eab2b6d740e53f55e6f585b4ffb1f42537\nparent a3470b13ab8cfba6b698aa0ae0e9591a76d40ba7\nauthor Santiago Pastorino <spastorino@gmail.com> 1603211038 -0300\ncommitter Santiago Pastorino <spastorino@gmail.com> 1603820738 -0300\n\nProperly restore within_fn_param value to the previous state\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/58018d438b3e14624bf33a9c0d2031e906797b8d", "html_url": "https://github.com/rust-lang/rust/commit/58018d438b3e14624bf33a9c0d2031e906797b8d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/58018d438b3e14624bf33a9c0d2031e906797b8d/comments", "author": {"login": "spastorino", "id": 52642, "node_id": "MDQ6VXNlcjUyNjQy", "avatar_url": "https://avatars.githubusercontent.com/u/52642?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spastorino", "html_url": "https://github.com/spastorino", "followers_url": "https://api.github.com/users/spastorino/followers", "following_url": "https://api.github.com/users/spastorino/following{/other_user}", "gists_url": "https://api.github.com/users/spastorino/gists{/gist_id}", "starred_url": "https://api.github.com/users/spastorino/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spastorino/subscriptions", "organizations_url": "https://api.github.com/users/spastorino/orgs", "repos_url": "https://api.github.com/users/spastorino/repos", "events_url": "https://api.github.com/users/spastorino/events{/privacy}", "received_events_url": "https://api.github.com/users/spastorino/received_events", "type": "User", "site_admin": false}, "committer": {"login": "spastorino", "id": 52642, "node_id": "MDQ6VXNlcjUyNjQy", "avatar_url": "https://avatars.githubusercontent.com/u/52642?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spastorino", "html_url": "https://github.com/spastorino", "followers_url": "https://api.github.com/users/spastorino/followers", "following_url": "https://api.github.com/users/spastorino/following{/other_user}", "gists_url": "https://api.github.com/users/spastorino/gists{/gist_id}", "starred_url": "https://api.github.com/users/spastorino/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spastorino/subscriptions", "organizations_url": "https://api.github.com/users/spastorino/orgs", "repos_url": "https://api.github.com/users/spastorino/repos", "events_url": "https://api.github.com/users/spastorino/events{/privacy}", "received_events_url": "https://api.github.com/users/spastorino/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a3470b13ab8cfba6b698aa0ae0e9591a76d40ba7", "url": "https://api.github.com/repos/rust-lang/rust/commits/a3470b13ab8cfba6b698aa0ae0e9591a76d40ba7", "html_url": "https://github.com/rust-lang/rust/commit/a3470b13ab8cfba6b698aa0ae0e9591a76d40ba7"}], "stats": {"total": 5, "additions": 3, "deletions": 2}, "files": [{"sha": "8699de4ce14cd0c0c7e47cc4ee9ad5dc40bd2f3d", "filename": "compiler/rustc_typeck/src/check/gather_locals.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/58018d438b3e14624bf33a9c0d2031e906797b8d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fgather_locals.rs", "raw_url": "https://github.com/rust-lang/rust/raw/58018d438b3e14624bf33a9c0d2031e906797b8d/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fgather_locals.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcheck%2Fgather_locals.rs?ref=58018d438b3e14624bf33a9c0d2031e906797b8d", "patch": "@@ -6,6 +6,7 @@ use rustc_infer::infer::type_variable::{TypeVariableOrigin, TypeVariableOriginKi\n use rustc_middle::ty::Ty;\n use rustc_span::Span;\n use rustc_trait_selection::traits;\n+use std::mem;\n \n pub(super) struct GatherLocalsVisitor<'a, 'tcx> {\n     fcx: &'a FnCtxt<'a, 'tcx>,\n@@ -97,9 +98,9 @@ impl<'a, 'tcx> Visitor<'tcx> for GatherLocalsVisitor<'a, 'tcx> {\n     }\n \n     fn visit_param(&mut self, param: &'tcx hir::Param<'tcx>) {\n-        self.within_fn_param = true;\n+        let old_within_fn_param = mem::replace(&mut self.within_fn_param, true);\n         intravisit::walk_param(self, param);\n-        self.within_fn_param = false;\n+        self.within_fn_param = old_within_fn_param;\n     }\n \n     // Add pattern bindings."}]}