{"sha": "5940c193159a40fc9ebecc0de1482ba3d0a7a2dc", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU5NDBjMTkzMTU5YTQwZmM5ZWJlY2MwZGUxNDgyYmEzZDBhN2EyZGM=", "commit": {"author": {"name": "Corey Farwell", "email": "coreyf@rwell.org", "date": "2020-12-10T04:53:53Z"}, "committer": {"name": "Corey Farwell", "email": "coreyf@rwell.org", "date": "2020-12-10T04:53:53Z"}, "message": "Enable ASan, TSan, UBSan for aarch64-apple-darwin.", "tree": {"sha": "3a7a8404e2bca075d3de2a22247d0454d85a5db6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3a7a8404e2bca075d3de2a22247d0454d85a5db6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5940c193159a40fc9ebecc0de1482ba3d0a7a2dc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5940c193159a40fc9ebecc0de1482ba3d0a7a2dc", "html_url": "https://github.com/rust-lang/rust/commit/5940c193159a40fc9ebecc0de1482ba3d0a7a2dc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5940c193159a40fc9ebecc0de1482ba3d0a7a2dc/comments", "author": {"login": "frewsxcv", "id": 416575, "node_id": "MDQ6VXNlcjQxNjU3NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/416575?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frewsxcv", "html_url": "https://github.com/frewsxcv", "followers_url": "https://api.github.com/users/frewsxcv/followers", "following_url": "https://api.github.com/users/frewsxcv/following{/other_user}", "gists_url": "https://api.github.com/users/frewsxcv/gists{/gist_id}", "starred_url": "https://api.github.com/users/frewsxcv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frewsxcv/subscriptions", "organizations_url": "https://api.github.com/users/frewsxcv/orgs", "repos_url": "https://api.github.com/users/frewsxcv/repos", "events_url": "https://api.github.com/users/frewsxcv/events{/privacy}", "received_events_url": "https://api.github.com/users/frewsxcv/received_events", "type": "User", "site_admin": false}, "committer": {"login": "frewsxcv", "id": 416575, "node_id": "MDQ6VXNlcjQxNjU3NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/416575?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frewsxcv", "html_url": "https://github.com/frewsxcv", "followers_url": "https://api.github.com/users/frewsxcv/followers", "following_url": "https://api.github.com/users/frewsxcv/following{/other_user}", "gists_url": "https://api.github.com/users/frewsxcv/gists{/gist_id}", "starred_url": "https://api.github.com/users/frewsxcv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frewsxcv/subscriptions", "organizations_url": "https://api.github.com/users/frewsxcv/orgs", "repos_url": "https://api.github.com/users/frewsxcv/repos", "events_url": "https://api.github.com/users/frewsxcv/events{/privacy}", "received_events_url": "https://api.github.com/users/frewsxcv/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "58d2bad9f7ab0971495247b6c94978848760ca9d", "url": "https://api.github.com/repos/rust-lang/rust/commits/58d2bad9f7ab0971495247b6c94978848760ca9d", "html_url": "https://github.com/rust-lang/rust/commit/58d2bad9f7ab0971495247b6c94978848760ca9d"}], "stats": {"total": 24, "additions": 19, "deletions": 5}, "files": [{"sha": "0f4408a8fc696b7203b6de9556b4db73aba7177f", "filename": "compiler/rustc_codegen_ssa/src/back/link.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/5940c193159a40fc9ebecc0de1482ba3d0a7a2dc/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Flink.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5940c193159a40fc9ebecc0de1482ba3d0a7a2dc/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Flink.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_codegen_ssa%2Fsrc%2Fback%2Flink.rs?ref=5940c193159a40fc9ebecc0de1482ba3d0a7a2dc", "patch": "@@ -819,7 +819,8 @@ fn link_sanitizer_runtime(sess: &Session, linker: &mut dyn Linker, name: &str) {\n         .unwrap_or_default();\n \n     match sess.opts.target_triple.triple() {\n-        \"x86_64-apple-darwin\" => {\n+        \"aarch64-apple-darwin\"\n+        | \"x86_64-apple-darwin\" => {\n             // On Apple platforms, the sanitizer is always built as a dylib, and\n             // LLVM will link to `@rpath/*.dylib`, so we need to specify an\n             // rpath to the library as well (the rpath should be absolute, see"}, {"sha": "6ca9050339fd8b7959a69e11718ca1a34599cc16", "filename": "compiler/rustc_session/src/session.rs", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/5940c193159a40fc9ebecc0de1482ba3d0a7a2dc/compiler%2Frustc_session%2Fsrc%2Fsession.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5940c193159a40fc9ebecc0de1482ba3d0a7a2dc/compiler%2Frustc_session%2Fsrc%2Fsession.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_session%2Fsrc%2Fsession.rs?ref=5940c193159a40fc9ebecc0de1482ba3d0a7a2dc", "patch": "@@ -1520,18 +1520,24 @@ fn validate_commandline_args_with_session_available(sess: &Session) {\n     }\n \n     const ASAN_SUPPORTED_TARGETS: &[&str] = &[\n+        \"aarch64-apple-darwin\",\n         \"aarch64-fuchsia\",\n         \"aarch64-unknown-linux-gnu\",\n         \"x86_64-apple-darwin\",\n         \"x86_64-fuchsia\",\n         \"x86_64-unknown-freebsd\",\n         \"x86_64-unknown-linux-gnu\",\n     ];\n-    const LSAN_SUPPORTED_TARGETS: &[&str] =\n-        &[\"aarch64-unknown-linux-gnu\", \"x86_64-apple-darwin\", \"x86_64-unknown-linux-gnu\"];\n+    const LSAN_SUPPORTED_TARGETS: &[&str] = &[\n+        \"aarch64-apple-darwin\",\n+        \"aarch64-unknown-linux-gnu\",\n+        \"x86_64-apple-darwin\",\n+        \"x86_64-unknown-linux-gnu\",\n+    ];\n     const MSAN_SUPPORTED_TARGETS: &[&str] =\n         &[\"aarch64-unknown-linux-gnu\", \"x86_64-unknown-freebsd\", \"x86_64-unknown-linux-gnu\"];\n     const TSAN_SUPPORTED_TARGETS: &[&str] = &[\n+        \"aarch64-apple-darwin\",\n         \"aarch64-unknown-linux-gnu\",\n         \"x86_64-apple-darwin\",\n         \"x86_64-unknown-freebsd\","}, {"sha": "6412df3fd904e88a906b90f597104c855ed435c1", "filename": "src/bootstrap/native.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5940c193159a40fc9ebecc0de1482ba3d0a7a2dc/src%2Fbootstrap%2Fnative.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5940c193159a40fc9ebecc0de1482ba3d0a7a2dc/src%2Fbootstrap%2Fnative.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fnative.rs?ref=5940c193159a40fc9ebecc0de1482ba3d0a7a2dc", "patch": "@@ -802,6 +802,7 @@ fn supported_sanitizers(\n     };\n \n     match &*target.triple {\n+        \"aarch64-apple-darwin\" => darwin_libs(\"osx\", &[\"asan\", \"lsan\", \"tsan\"]),\n         \"aarch64-fuchsia\" => common_libs(\"fuchsia\", \"aarch64\", &[\"asan\"]),\n         \"aarch64-unknown-linux-gnu\" => {\n             common_libs(\"linux\", \"aarch64\", &[\"asan\", \"lsan\", \"msan\", \"tsan\"])"}, {"sha": "1647df8044ccc37cb138c13499853ce43daf340b", "filename": "src/tools/compiletest/src/util.rs", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/5940c193159a40fc9ebecc0de1482ba3d0a7a2dc/src%2Ftools%2Fcompiletest%2Fsrc%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5940c193159a40fc9ebecc0de1482ba3d0a7a2dc/src%2Ftools%2Fcompiletest%2Fsrc%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Futil.rs?ref=5940c193159a40fc9ebecc0de1482ba3d0a7a2dc", "patch": "@@ -82,6 +82,7 @@ const ARCH_TABLE: &[(&str, &str)] = &[\n ];\n \n pub const ASAN_SUPPORTED_TARGETS: &[&str] = &[\n+    \"aarch64-apple-darwin\",\n     \"aarch64-fuchsia\",\n     \"aarch64-unknown-linux-gnu\",\n     \"x86_64-apple-darwin\",\n@@ -90,13 +91,18 @@ pub const ASAN_SUPPORTED_TARGETS: &[&str] = &[\n     \"x86_64-unknown-linux-gnu\",\n ];\n \n-pub const LSAN_SUPPORTED_TARGETS: &[&str] =\n-    &[\"aarch64-unknown-linux-gnu\", \"x86_64-apple-darwin\", \"x86_64-unknown-linux-gnu\"];\n+pub const LSAN_SUPPORTED_TARGETS: &[&str] = &[\n+    \"aarch64-apple-darwin\",\n+    \"aarch64-unknown-linux-gnu\",\n+    \"x86_64-apple-darwin\",\n+    \"x86_64-unknown-linux-gnu\",\n+];\n \n pub const MSAN_SUPPORTED_TARGETS: &[&str] =\n     &[\"aarch64-unknown-linux-gnu\", \"x86_64-unknown-freebsd\", \"x86_64-unknown-linux-gnu\"];\n \n pub const TSAN_SUPPORTED_TARGETS: &[&str] = &[\n+    \"aarch64-apple-darwin\",\n     \"aarch64-unknown-linux-gnu\",\n     \"x86_64-apple-darwin\",\n     \"x86_64-unknown-freebsd\","}]}