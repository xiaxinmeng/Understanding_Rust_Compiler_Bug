{"sha": "6a60cb1e0cf4bdc37e78c0560e6fed0743a9c271", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZhNjBjYjFlMGNmNGJkYzM3ZTc4YzA1NjBlNmZlZDA3NDNhOWMyNzE=", "commit": {"author": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2011-03-31T18:55:28Z"}, "committer": {"name": "Patrick Walton", "email": "pcwalton@mimiga.net", "date": "2011-03-31T18:55:28Z"}, "message": "rustc: Mix the bits more when hashing def ids", "tree": {"sha": "5bc001a208290212ca3d0f4fe1a992b5e7e81754", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5bc001a208290212ca3d0f4fe1a992b5e7e81754"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6a60cb1e0cf4bdc37e78c0560e6fed0743a9c271", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6a60cb1e0cf4bdc37e78c0560e6fed0743a9c271", "html_url": "https://github.com/rust-lang/rust/commit/6a60cb1e0cf4bdc37e78c0560e6fed0743a9c271", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6a60cb1e0cf4bdc37e78c0560e6fed0743a9c271/comments", "author": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pcwalton", "id": 157897, "node_id": "MDQ6VXNlcjE1Nzg5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/157897?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pcwalton", "html_url": "https://github.com/pcwalton", "followers_url": "https://api.github.com/users/pcwalton/followers", "following_url": "https://api.github.com/users/pcwalton/following{/other_user}", "gists_url": "https://api.github.com/users/pcwalton/gists{/gist_id}", "starred_url": "https://api.github.com/users/pcwalton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pcwalton/subscriptions", "organizations_url": "https://api.github.com/users/pcwalton/orgs", "repos_url": "https://api.github.com/users/pcwalton/repos", "events_url": "https://api.github.com/users/pcwalton/events{/privacy}", "received_events_url": "https://api.github.com/users/pcwalton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dec92d392e59075ceee750b4b816a84c873a5212", "url": "https://api.github.com/repos/rust-lang/rust/commits/dec92d392e59075ceee750b4b816a84c873a5212", "html_url": "https://github.com/rust-lang/rust/commit/dec92d392e59075ceee750b4b816a84c873a5212"}], "stats": {"total": 17, "additions": 8, "deletions": 9}, "files": [{"sha": "5243e2f7df2848b75bb9935fc483e825ece46652", "filename": "src/comp/util/common.rs", "status": "modified", "additions": 8, "deletions": 9, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/6a60cb1e0cf4bdc37e78c0560e6fed0743a9c271/src%2Fcomp%2Futil%2Fcommon.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6a60cb1e0cf4bdc37e78c0560e6fed0743a9c271/src%2Fcomp%2Futil%2Fcommon.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Futil%2Fcommon.rs?ref=6a60cb1e0cf4bdc37e78c0560e6fed0743a9c271", "patch": "@@ -50,16 +50,15 @@ fn def_eq(&ast.def_id a, &ast.def_id b) -> bool {\n     ret a._0 == b._0 && a._1 == b._1;\n }\n \n-fn new_def_hash[V]() -> std.map.hashmap[ast.def_id,V] {\n-\n-    fn hash(&ast.def_id d) -> uint {\n-        let uint u = d._0 as uint;\n-        u <<= 16u;\n-        u |= d._1 as uint;\n-        ret u;\n-    }\n+fn hash_def(&ast.def_id d) -> uint {\n+    auto h = 5381u;\n+    h = ((h << 5u) + h) ^ (d._0 as uint);\n+    h = ((h << 5u) + h) ^ (d._1 as uint);\n+    ret h;\n+}\n \n-    let std.map.hashfn[ast.def_id] hasher = hash;\n+fn new_def_hash[V]() -> std.map.hashmap[ast.def_id,V] {\n+    let std.map.hashfn[ast.def_id] hasher = hash_def;\n     let std.map.eqfn[ast.def_id] eqer = def_eq;\n     ret std.map.mk_hashmap[ast.def_id,V](hasher, eqer);\n }"}]}