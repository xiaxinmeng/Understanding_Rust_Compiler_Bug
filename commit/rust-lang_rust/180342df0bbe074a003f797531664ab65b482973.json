{"sha": "180342df0bbe074a003f797531664ab65b482973", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE4MDM0MmRmMGJiZTA3NGEwMDNmNzk3NTMxNjY0YWI2NWI0ODI5NzM=", "commit": {"author": {"name": "gnzlbg", "email": "gonzalobg88@gmail.com", "date": "2018-05-09T15:09:50Z"}, "committer": {"name": "gnzlbg", "email": "gonzalobg88@gmail.com", "date": "2018-05-24T14:04:39Z"}, "message": "add gather/scatter tests for pointers of pointers", "tree": {"sha": "c06e0c85622ef809447190a78e7e3077af395336", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c06e0c85622ef809447190a78e7e3077af395336"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/180342df0bbe074a003f797531664ab65b482973", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/180342df0bbe074a003f797531664ab65b482973", "html_url": "https://github.com/rust-lang/rust/commit/180342df0bbe074a003f797531664ab65b482973", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/180342df0bbe074a003f797531664ab65b482973/comments", "author": {"login": "gnzlbg", "id": 904614, "node_id": "MDQ6VXNlcjkwNDYxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gnzlbg", "html_url": "https://github.com/gnzlbg", "followers_url": "https://api.github.com/users/gnzlbg/followers", "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}", "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}", "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions", "organizations_url": "https://api.github.com/users/gnzlbg/orgs", "repos_url": "https://api.github.com/users/gnzlbg/repos", "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}", "received_events_url": "https://api.github.com/users/gnzlbg/received_events", "type": "User", "site_admin": false}, "committer": {"login": "gnzlbg", "id": 904614, "node_id": "MDQ6VXNlcjkwNDYxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/904614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gnzlbg", "html_url": "https://github.com/gnzlbg", "followers_url": "https://api.github.com/users/gnzlbg/followers", "following_url": "https://api.github.com/users/gnzlbg/following{/other_user}", "gists_url": "https://api.github.com/users/gnzlbg/gists{/gist_id}", "starred_url": "https://api.github.com/users/gnzlbg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gnzlbg/subscriptions", "organizations_url": "https://api.github.com/users/gnzlbg/orgs", "repos_url": "https://api.github.com/users/gnzlbg/repos", "events_url": "https://api.github.com/users/gnzlbg/events{/privacy}", "received_events_url": "https://api.github.com/users/gnzlbg/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1ffc30a45976374e914df250e2852821eb811f41", "url": "https://api.github.com/repos/rust-lang/rust/commits/1ffc30a45976374e914df250e2852821eb811f41", "html_url": "https://github.com/rust-lang/rust/commit/1ffc30a45976374e914df250e2852821eb811f41"}], "stats": {"total": 71, "additions": 71, "deletions": 0}, "files": [{"sha": "54143739a88f931648e5dff6975aecd2d98bed8d", "filename": "src/test/run-pass/simd-intrinsic-generic-gather.rs", "status": "modified", "additions": 71, "deletions": 0, "changes": 71, "blob_url": "https://github.com/rust-lang/rust/blob/180342df0bbe074a003f797531664ab65b482973/src%2Ftest%2Frun-pass%2Fsimd-intrinsic-generic-gather.rs", "raw_url": "https://github.com/rust-lang/rust/raw/180342df0bbe074a003f797531664ab65b482973/src%2Ftest%2Frun-pass%2Fsimd-intrinsic-generic-gather.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fsimd-intrinsic-generic-gather.rs?ref=180342df0bbe074a003f797531664ab65b482973", "patch": "@@ -77,4 +77,75 @@ fn main() {\n \n         assert_eq!(x, [42., 1., 43., 3., 4., 5., 45., 7.]);\n     }\n+\n+    // test modifying array of *const f32\n+    let mut y = [\n+        &x[0] as *const f32,\n+        &x[1] as *const f32,\n+        &x[2] as *const f32,\n+        &x[3] as *const f32,\n+        &x[4] as *const f32,\n+        &x[5] as *const f32,\n+        &x[6] as *const f32,\n+        &x[7] as *const f32\n+    ];\n+\n+    let default = x4(y[0], y[0], y[0], y[0]);\n+    let s_strided = x4(y[0], y[2], y[0], y[6]);\n+\n+    // reading from *const\n+    unsafe {\n+        let pointer = &y[0] as *const *const f32;\n+        let pointers = x4(\n+            pointer.offset(0) as *const *const f32,\n+            pointer.offset(2),\n+            pointer.offset(4),\n+            pointer.offset(6)\n+        );\n+\n+        let r_strided = simd_gather(default, pointers, mask);\n+\n+        assert_eq!(r_strided, s_strided);\n+    }\n+\n+    // reading from *mut\n+    unsafe {\n+        let pointer = &mut y[0] as *mut *const f32;\n+        let pointers = x4(\n+            pointer.offset(0) as *mut *const f32,\n+            pointer.offset(2),\n+            pointer.offset(4),\n+            pointer.offset(6)\n+        );\n+\n+        let r_strided = simd_gather(default, pointers, mask);\n+\n+        assert_eq!(r_strided, s_strided);\n+    }\n+\n+    // writing to *mut\n+    unsafe {\n+        let pointer = &mut y[0] as *mut *const f32;\n+        let pointers = x4(\n+            pointer.offset(0) as *mut *const f32,\n+            pointer.offset(2),\n+            pointer.offset(4),\n+            pointer.offset(6)\n+        );\n+\n+        let values = x4(y[7], y[6], y[5], y[1]);\n+        simd_scatter(values, pointers, mask);\n+\n+        let s = [\n+            &x[7] as *const f32,\n+            &x[1] as *const f32,\n+            &x[6] as *const f32,\n+            &x[3] as *const f32,\n+            &x[4] as *const f32,\n+            &x[5] as *const f32,\n+            &x[1] as *const f32,\n+            &x[7] as *const f32\n+        ];\n+        assert_eq!(y, s);\n+    }\n }"}]}