{"sha": "38ddff516cc89d58a36293a32c11479a6ad063bc", "node_id": "C_kwDOAAsO6NoAKDM4ZGRmZjUxNmNjODlkNThhMzYyOTNhMzJjMTE0NzlhNmFkMDYzYmM", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-06-06T20:00:20Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-06-06T20:00:20Z"}, "message": "Rollup merge of #112343 - GuillaumeGomez:extern-crate-missing-docs, r=notriddle\n\nPrevent emitting `missing_docs` for `pub extern crate`\n\nFixes #112308.\n\nr? `@notriddle`", "tree": {"sha": "83033300714a557c88e3742c32c311e72bb4b351", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/83033300714a557c88e3742c32c311e72bb4b351"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/38ddff516cc89d58a36293a32c11479a6ad063bc", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkf5BUCRBK7hj4Ov3rIwAAFWwIAHd2Y1dlvEqdXOq4QqpPCjGI\nFFQdihfKdFNNVBHTDEooqZuxeUvursjgvHaZrQ9XQyV6fSqnLo7jbUGmsYGOcru2\nGnlFwkRdp7VzWIbvhMj+icoKk7Vkm8GxXHsdI+cGBqyjirnjOeWpV2Tq5I0pDUFo\nJpf1g6NNW2E8Kmf6iFQwX9r5d8ENmTUrzv1/ozgbxBH6kqDvipbQV+Alldw3kpzz\nZZ/RLGJ+FbunCFOqxbk5oBWBSk21LKzr6YGu2ZftSQWradYWo2S5xbNbCEdEQnr1\naRAWpeVU8TvAG1BCdcHhvYdpRO5o4NHvEmd0lMRm4XOQKBHFBv4iQR192eyiCwQ=\n=aS8E\n-----END PGP SIGNATURE-----\n", "payload": "tree 83033300714a557c88e3742c32c311e72bb4b351\nparent e937fa49dd463bc9503598e31c830103ee72919b\nparent 550fe634bf5914e01ea529119bd23bf276fe673b\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1686081620 +0200\ncommitter GitHub <noreply@github.com> 1686081620 +0200\n\nRollup merge of #112343 - GuillaumeGomez:extern-crate-missing-docs, r=notriddle\n\nPrevent emitting `missing_docs` for `pub extern crate`\n\nFixes #112308.\n\nr? `@notriddle`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/38ddff516cc89d58a36293a32c11479a6ad063bc", "html_url": "https://github.com/rust-lang/rust/commit/38ddff516cc89d58a36293a32c11479a6ad063bc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/38ddff516cc89d58a36293a32c11479a6ad063bc/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e937fa49dd463bc9503598e31c830103ee72919b", "url": "https://api.github.com/repos/rust-lang/rust/commits/e937fa49dd463bc9503598e31c830103ee72919b", "html_url": "https://github.com/rust-lang/rust/commit/e937fa49dd463bc9503598e31c830103ee72919b"}, {"sha": "550fe634bf5914e01ea529119bd23bf276fe673b", "url": "https://api.github.com/repos/rust-lang/rust/commits/550fe634bf5914e01ea529119bd23bf276fe673b", "html_url": "https://github.com/rust-lang/rust/commit/550fe634bf5914e01ea529119bd23bf276fe673b"}], "stats": {"total": 65, "additions": 37, "deletions": 28}, "files": [{"sha": "8c0956a618deab91095de98013497ee54a624e2b", "filename": "compiler/rustc_lint/src/builtin.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/38ddff516cc89d58a36293a32c11479a6ad063bc/compiler%2Frustc_lint%2Fsrc%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/38ddff516cc89d58a36293a32c11479a6ad063bc/compiler%2Frustc_lint%2Fsrc%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint%2Fsrc%2Fbuiltin.rs?ref=38ddff516cc89d58a36293a32c11479a6ad063bc", "patch": "@@ -548,8 +548,12 @@ impl<'tcx> LateLintPass<'tcx> for MissingDoc {\n \n     fn check_item(&mut self, cx: &LateContext<'_>, it: &hir::Item<'_>) {\n         // Previously the Impl and Use types have been excluded from missing docs,\n-        // so we will continue to exclude them for compatibility\n-        if let hir::ItemKind::Impl(..) | hir::ItemKind::Use(..) = it.kind {\n+        // so we will continue to exclude them for compatibility.\n+        //\n+        // The documentation on `ExternCrate` is not used at the moment so no need to warn for it.\n+        if let hir::ItemKind::Impl(..) | hir::ItemKind::Use(..) | hir::ItemKind::ExternCrate(_) =\n+            it.kind\n+        {\n             return;\n         }\n "}, {"sha": "4a835673a596bcd05404f43d34082bf2785f2a9d", "filename": "tests/ui/lint/auxiliary/missing_docs.rs", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/38ddff516cc89d58a36293a32c11479a6ad063bc/tests%2Fui%2Flint%2Fauxiliary%2Fmissing_docs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/38ddff516cc89d58a36293a32c11479a6ad063bc/tests%2Fui%2Flint%2Fauxiliary%2Fmissing_docs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flint%2Fauxiliary%2Fmissing_docs.rs?ref=38ddff516cc89d58a36293a32c11479a6ad063bc", "patch": "@@ -0,0 +1 @@\n+pub struct Foo;"}, {"sha": "b59f2212f51b3a66896ccc1bebf6e1c9461a70a9", "filename": "tests/ui/lint/lint-missing-doc.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/38ddff516cc89d58a36293a32c11479a6ad063bc/tests%2Fui%2Flint%2Flint-missing-doc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/38ddff516cc89d58a36293a32c11479a6ad063bc/tests%2Fui%2Flint%2Flint-missing-doc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flint%2Flint-missing-doc.rs?ref=38ddff516cc89d58a36293a32c11479a6ad063bc", "patch": "@@ -1,5 +1,6 @@\n // When denying at the crate level, be sure to not get random warnings from the\n // injected intrinsics by the compiler.\n+// aux-build:missing_docs.rs\n #![deny(missing_docs)]\n #![allow(dead_code)]\n #![feature(associated_type_defaults, extern_types)]\n@@ -8,6 +9,9 @@\n //! Some garbage docs for the crate here\n #![doc=\"More garbage\"]\n \n+// There should be not \"missing_docs\" warning on \"pub extern crate\".\n+pub extern crate missing_docs;\n+\n type Typedef = String;\n pub type PubTypedef = String; //~ ERROR: missing documentation for a type alias\n "}, {"sha": "adcc21c44b26206d716cb5a7a23dcf1f7ee45565", "filename": "tests/ui/lint/lint-missing-doc.stderr", "status": "modified", "additions": 26, "deletions": 26, "changes": 52, "blob_url": "https://github.com/rust-lang/rust/blob/38ddff516cc89d58a36293a32c11479a6ad063bc/tests%2Fui%2Flint%2Flint-missing-doc.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/38ddff516cc89d58a36293a32c11479a6ad063bc/tests%2Fui%2Flint%2Flint-missing-doc.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flint%2Flint-missing-doc.stderr?ref=38ddff516cc89d58a36293a32c11479a6ad063bc", "patch": "@@ -1,155 +1,155 @@\n error: missing documentation for a type alias\n-  --> $DIR/lint-missing-doc.rs:12:1\n+  --> $DIR/lint-missing-doc.rs:16:1\n    |\n LL | pub type PubTypedef = String;\n    | ^^^^^^^^^^^^^^^^^^^\n    |\n note: the lint level is defined here\n-  --> $DIR/lint-missing-doc.rs:3:9\n+  --> $DIR/lint-missing-doc.rs:4:9\n    |\n LL | #![deny(missing_docs)]\n    |         ^^^^^^^^^^^^\n \n error: missing documentation for a struct\n-  --> $DIR/lint-missing-doc.rs:19:1\n+  --> $DIR/lint-missing-doc.rs:23:1\n    |\n LL | pub struct PubFoo {\n    | ^^^^^^^^^^^^^^^^^\n \n error: missing documentation for a struct field\n-  --> $DIR/lint-missing-doc.rs:20:5\n+  --> $DIR/lint-missing-doc.rs:24:5\n    |\n LL |     pub a: isize,\n    |     ^^^^^^^^^^^^\n \n error: missing documentation for a module\n-  --> $DIR/lint-missing-doc.rs:31:1\n+  --> $DIR/lint-missing-doc.rs:35:1\n    |\n LL | pub mod pub_module_no_dox {}\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: missing documentation for a function\n-  --> $DIR/lint-missing-doc.rs:35:1\n+  --> $DIR/lint-missing-doc.rs:39:1\n    |\n LL | pub fn foo2() {}\n    | ^^^^^^^^^^^^^\n \n error: missing documentation for a trait\n-  --> $DIR/lint-missing-doc.rs:53:1\n+  --> $DIR/lint-missing-doc.rs:57:1\n    |\n LL | pub trait C {\n    | ^^^^^^^^^^^\n \n error: missing documentation for a method\n-  --> $DIR/lint-missing-doc.rs:54:5\n+  --> $DIR/lint-missing-doc.rs:58:5\n    |\n LL |     fn foo(&self);\n    |     ^^^^^^^^^^^^^^\n \n error: missing documentation for a method\n-  --> $DIR/lint-missing-doc.rs:55:5\n+  --> $DIR/lint-missing-doc.rs:59:5\n    |\n LL |     fn foo_with_impl(&self) {}\n    |     ^^^^^^^^^^^^^^^^^^^^^^^\n \n error: missing documentation for an associated function\n-  --> $DIR/lint-missing-doc.rs:56:5\n+  --> $DIR/lint-missing-doc.rs:60:5\n    |\n LL |     fn foo_no_self();\n    |     ^^^^^^^^^^^^^^^^^\n \n error: missing documentation for an associated function\n-  --> $DIR/lint-missing-doc.rs:57:5\n+  --> $DIR/lint-missing-doc.rs:61:5\n    |\n LL |     fn foo_no_self_with_impl() {}\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: missing documentation for an associated type\n-  --> $DIR/lint-missing-doc.rs:67:5\n+  --> $DIR/lint-missing-doc.rs:71:5\n    |\n LL |     type AssociatedType;\n    |     ^^^^^^^^^^^^^^^^^^^\n \n error: missing documentation for an associated type\n-  --> $DIR/lint-missing-doc.rs:68:5\n+  --> $DIR/lint-missing-doc.rs:72:5\n    |\n LL |     type AssociatedTypeDef = Self;\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n error: missing documentation for an associated function\n-  --> $DIR/lint-missing-doc.rs:84:5\n+  --> $DIR/lint-missing-doc.rs:88:5\n    |\n LL |     pub fn foo() {}\n    |     ^^^^^^^^^^^^\n \n error: missing documentation for an enum\n-  --> $DIR/lint-missing-doc.rs:121:1\n+  --> $DIR/lint-missing-doc.rs:125:1\n    |\n LL | pub enum PubBaz {\n    | ^^^^^^^^^^^^^^^\n \n error: missing documentation for a variant\n-  --> $DIR/lint-missing-doc.rs:122:5\n+  --> $DIR/lint-missing-doc.rs:126:5\n    |\n LL |     PubBazA {\n    |     ^^^^^^^\n \n error: missing documentation for a struct field\n-  --> $DIR/lint-missing-doc.rs:123:9\n+  --> $DIR/lint-missing-doc.rs:127:9\n    |\n LL |         a: isize,\n    |         ^^^^^^^^\n \n error: missing documentation for a constant\n-  --> $DIR/lint-missing-doc.rs:154:1\n+  --> $DIR/lint-missing-doc.rs:158:1\n    |\n LL | pub const FOO4: u32 = 0;\n    | ^^^^^^^^^^^^^^^^^^^\n \n error: missing documentation for a static\n-  --> $DIR/lint-missing-doc.rs:164:1\n+  --> $DIR/lint-missing-doc.rs:168:1\n    |\n LL | pub static BAR4: u32 = 0;\n    | ^^^^^^^^^^^^^^^^^^^^\n \n error: missing documentation for a function\n-  --> $DIR/lint-missing-doc.rs:170:5\n+  --> $DIR/lint-missing-doc.rs:174:5\n    |\n LL |     pub fn undocumented1() {}\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n error: missing documentation for a function\n-  --> $DIR/lint-missing-doc.rs:171:5\n+  --> $DIR/lint-missing-doc.rs:175:5\n    |\n LL |     pub fn undocumented2() {}\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n \n error: missing documentation for a function\n-  --> $DIR/lint-missing-doc.rs:177:9\n+  --> $DIR/lint-missing-doc.rs:181:9\n    |\n LL |         pub fn also_undocumented1() {}\n    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: missing documentation for a function\n-  --> $DIR/lint-missing-doc.rs:192:5\n+  --> $DIR/lint-missing-doc.rs:196:5\n    |\n LL |     pub fn extern_fn_undocumented(f: f32) -> f32;\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: missing documentation for a static\n-  --> $DIR/lint-missing-doc.rs:197:5\n+  --> $DIR/lint-missing-doc.rs:201:5\n    |\n LL |     pub static EXTERN_STATIC_UNDOCUMENTED: u8;\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: missing documentation for a foreign type\n-  --> $DIR/lint-missing-doc.rs:202:5\n+  --> $DIR/lint-missing-doc.rs:206:5\n    |\n LL |     pub type ExternTyUndocumented;\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: missing documentation for a trait alias\n-  --> $DIR/lint-missing-doc.rs:206:1\n+  --> $DIR/lint-missing-doc.rs:210:1\n    |\n LL | pub trait T = Sync;\n    | ^^^^^^^^^^^"}]}