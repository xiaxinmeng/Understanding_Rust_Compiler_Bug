{"sha": "ee98c6fea4b96abd8cad6616291657dc05329045", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVlOThjNmZlYTRiOTZhYmQ4Y2FkNjYxNjI5MTY1N2RjMDUzMjkwNDU=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-03-17T12:48:25Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2021-03-17T13:54:40Z"}, "message": "Don't show HTML diff if tidy isn't installed for rustdoc tests", "tree": {"sha": "79f78e85c37657e86f3009f154f74b7777a89a28", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/79f78e85c37657e86f3009f154f74b7777a89a28"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ee98c6fea4b96abd8cad6616291657dc05329045", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ee98c6fea4b96abd8cad6616291657dc05329045", "html_url": "https://github.com/rust-lang/rust/commit/ee98c6fea4b96abd8cad6616291657dc05329045", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ee98c6fea4b96abd8cad6616291657dc05329045/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4b9f5cc4c10a161047475cb9bbe02c4fda57fb07", "url": "https://api.github.com/repos/rust-lang/rust/commits/4b9f5cc4c10a161047475cb9bbe02c4fda57fb07", "html_url": "https://github.com/rust-lang/rust/commit/4b9f5cc4c10a161047475cb9bbe02c4fda57fb07"}], "stats": {"total": 11, "additions": 6, "deletions": 5}, "files": [{"sha": "1d4b5e1247de742cfc06ef58ac4cb6d61fe0eee3", "filename": "src/tools/compiletest/src/main.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ee98c6fea4b96abd8cad6616291657dc05329045/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ee98c6fea4b96abd8cad6616291657dc05329045/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fmain.rs?ref=ee98c6fea4b96abd8cad6616291657dc05329045", "patch": "@@ -44,7 +44,7 @@ fn main() {\n     }\n \n     if !config.has_tidy && config.mode == Mode::Rustdoc {\n-        eprintln!(\"warning: `tidy` is not installed; generated diffs will be harder to read\");\n+        eprintln!(\"warning: `tidy` is not installed; diffs will not be generated\");\n     }\n \n     log_config(&config);"}, {"sha": "4f5003529a3cbccdde0734ea308bba9716a3d76a", "filename": "src/tools/compiletest/src/runtest.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/ee98c6fea4b96abd8cad6616291657dc05329045/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ee98c6fea4b96abd8cad6616291657dc05329045/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs?ref=ee98c6fea4b96abd8cad6616291657dc05329045", "patch": "@@ -2365,6 +2365,9 @@ impl<'test> TestCx<'test> {\n     }\n \n     fn compare_to_default_rustdoc(&mut self, out_dir: &Path) {\n+        if !self.config.has_tidy {\n+            return;\n+        }\n         println!(\"info: generating a diff against nightly rustdoc\");\n \n         let suffix =\n@@ -2426,10 +2429,8 @@ impl<'test> TestCx<'test> {\n                 }\n             }\n         };\n-        if self.config.has_tidy {\n-            tidy_dir(out_dir);\n-            tidy_dir(&compare_dir);\n-        }\n+        tidy_dir(out_dir);\n+        tidy_dir(&compare_dir);\n \n         let pager = {\n             let output = Command::new(\"git\").args(&[\"config\", \"--get\", \"core.pager\"]).output().ok();"}]}