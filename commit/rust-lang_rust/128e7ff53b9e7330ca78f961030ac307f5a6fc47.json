{"sha": "128e7ff53b9e7330ca78f961030ac307f5a6fc47", "node_id": "MDY6Q29tbWl0NzI0NzEyOjEyOGU3ZmY1M2I5ZTczMzBjYTc4Zjk2MTAzMGFjMzA3ZjVhNmZjNDc=", "commit": {"author": {"name": "Keegan McAllister", "email": "kmcallister@mozilla.com", "date": "2015-01-08T20:21:51Z"}, "committer": {"name": "Keegan McAllister", "email": "kmcallister@mozilla.com", "date": "2015-01-09T19:06:17Z"}, "message": "Re-reduce libstd macro duplication\n\nThe libstd definitions move to libcore, which causes some minor updates there.", "tree": {"sha": "8b660249dddff582b5c06c147312e0533d7a9c95", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8b660249dddff582b5c06c147312e0533d7a9c95"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/128e7ff53b9e7330ca78f961030ac307f5a6fc47", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/128e7ff53b9e7330ca78f961030ac307f5a6fc47", "html_url": "https://github.com/rust-lang/rust/commit/128e7ff53b9e7330ca78f961030ac307f5a6fc47", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/128e7ff53b9e7330ca78f961030ac307f5a6fc47/comments", "author": {"login": "kmcallister", "id": 444997, "node_id": "MDQ6VXNlcjQ0NDk5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/444997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kmcallister", "html_url": "https://github.com/kmcallister", "followers_url": "https://api.github.com/users/kmcallister/followers", "following_url": "https://api.github.com/users/kmcallister/following{/other_user}", "gists_url": "https://api.github.com/users/kmcallister/gists{/gist_id}", "starred_url": "https://api.github.com/users/kmcallister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kmcallister/subscriptions", "organizations_url": "https://api.github.com/users/kmcallister/orgs", "repos_url": "https://api.github.com/users/kmcallister/repos", "events_url": "https://api.github.com/users/kmcallister/events{/privacy}", "received_events_url": "https://api.github.com/users/kmcallister/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kmcallister", "id": 444997, "node_id": "MDQ6VXNlcjQ0NDk5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/444997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kmcallister", "html_url": "https://github.com/kmcallister", "followers_url": "https://api.github.com/users/kmcallister/followers", "following_url": "https://api.github.com/users/kmcallister/following{/other_user}", "gists_url": "https://api.github.com/users/kmcallister/gists{/gist_id}", "starred_url": "https://api.github.com/users/kmcallister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kmcallister/subscriptions", "organizations_url": "https://api.github.com/users/kmcallister/orgs", "repos_url": "https://api.github.com/users/kmcallister/repos", "events_url": "https://api.github.com/users/kmcallister/events{/privacy}", "received_events_url": "https://api.github.com/users/kmcallister/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2e2372c6c4a265992b0eb615ea9fdee4ab999143", "url": "https://api.github.com/repos/rust-lang/rust/commits/2e2372c6c4a265992b0eb615ea9fdee4ab999143", "html_url": "https://github.com/rust-lang/rust/commit/2e2372c6c4a265992b0eb615ea9fdee4ab999143"}], "stats": {"total": 190, "additions": 9, "deletions": 181}, "files": [{"sha": "3d3b9f8cf658577389f7e89f9c28310460d0a2a7", "filename": "src/libcore/macros.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/128e7ff53b9e7330ca78f961030ac307f5a6fc47/src%2Flibcore%2Fmacros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/128e7ff53b9e7330ca78f961030ac307f5a6fc47/src%2Flibcore%2Fmacros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fmacros.rs?ref=128e7ff53b9e7330ca78f961030ac307f5a6fc47", "patch": "@@ -49,15 +49,16 @@ macro_rules! panic {\n /// assert!(a + b == 30, \"a = {}, b = {}\", a, b);\n /// ```\n #[macro_export]\n+#[stable]\n macro_rules! assert {\n     ($cond:expr) => (\n         if !$cond {\n             panic!(concat!(\"assertion failed: \", stringify!($cond)))\n         }\n     );\n-    ($cond:expr, $($arg:expr),+) => (\n+    ($cond:expr, $($arg:tt)+) => (\n         if !$cond {\n-            panic!($($arg),+)\n+            panic!($($arg)+)\n         }\n     );\n }\n@@ -75,6 +76,7 @@ macro_rules! assert {\n /// assert_eq!(a, b);\n /// ```\n #[macro_export]\n+#[stable]\n macro_rules! assert_eq {\n     ($left:expr , $right:expr) => ({\n         match (&($left), &($right)) {\n@@ -116,6 +118,7 @@ macro_rules! assert_eq {\n /// debug_assert!(a + b == 30, \"a = {}, b = {}\", a, b);\n /// ```\n #[macro_export]\n+#[stable]\n macro_rules! debug_assert {\n     ($($arg:tt)*) => (if cfg!(not(ndebug)) { assert!($($arg)*); })\n }\n@@ -227,6 +230,7 @@ macro_rules! writeln {\n /// }\n /// ```\n #[macro_export]\n+#[unstable = \"relationship with panic is unclear\"]\n macro_rules! unreachable {\n     () => ({\n         panic!(\"internal error: entered unreachable code\")\n@@ -242,6 +246,7 @@ macro_rules! unreachable {\n /// A standardised placeholder for marking unfinished code. It panics with the\n /// message `\"not yet implemented\"` when executed.\n #[macro_export]\n+#[unstable = \"relationship with panic is unclear\"]\n macro_rules! unimplemented {\n     () => (panic!(\"not yet implemented\"))\n }"}, {"sha": "e15e611adc08cfc8aacc743886e77656773e1f83", "filename": "src/libstd/lib.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/128e7ff53b9e7330ca78f961030ac307f5a6fc47/src%2Flibstd%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/128e7ff53b9e7330ca78f961030ac307f5a6fc47/src%2Flibstd%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Flib.rs?ref=128e7ff53b9e7330ca78f961030ac307f5a6fc47", "patch": "@@ -122,7 +122,8 @@\n extern crate log;\n \n #[macro_use]\n-#[macro_reexport(write, writeln)]\n+#[macro_reexport(assert, assert_eq, debug_assert, debug_assert_eq,\n+    unreachable, unimplemented, write, writeln)]\n extern crate core;\n \n #[macro_use]"}, {"sha": "a420c841d25e3196b9bbeb8ce82f324277271505", "filename": "src/libstd/macros.rs", "status": "modified", "additions": 0, "deletions": 178, "changes": 178, "blob_url": "https://github.com/rust-lang/rust/blob/128e7ff53b9e7330ca78f961030ac307f5a6fc47/src%2Flibstd%2Fmacros.rs", "raw_url": "https://github.com/rust-lang/rust/raw/128e7ff53b9e7330ca78f961030ac307f5a6fc47/src%2Flibstd%2Fmacros.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fmacros.rs?ref=128e7ff53b9e7330ca78f961030ac307f5a6fc47", "patch": "@@ -60,184 +60,6 @@ macro_rules! panic {\n     });\n }\n \n-/// Ensure that a boolean expression is `true` at runtime.\n-///\n-/// This will invoke the `panic!` macro if the provided expression cannot be\n-/// evaluated to `true` at runtime.\n-///\n-/// # Example\n-///\n-/// ```\n-/// // the panic message for these assertions is the stringified value of the\n-/// // expression given.\n-/// assert!(true);\n-/// # fn some_computation() -> bool { true }\n-/// assert!(some_computation());\n-///\n-/// // assert with a custom message\n-/// # let x = true;\n-/// assert!(x, \"x wasn't true!\");\n-/// # let a = 3i; let b = 27i;\n-/// assert!(a + b == 30, \"a = {}, b = {}\", a, b);\n-/// ```\n-#[macro_export]\n-#[stable]\n-macro_rules! assert {\n-    ($cond:expr) => (\n-        if !$cond {\n-            panic!(concat!(\"assertion failed: \", stringify!($cond)))\n-        }\n-    );\n-    ($cond:expr, $($arg:tt)+) => (\n-        if !$cond {\n-            panic!($($arg)+)\n-        }\n-    );\n-}\n-\n-/// Asserts that two expressions are equal to each other, testing equality in\n-/// both directions.\n-///\n-/// On panic, this macro will print the values of the expressions.\n-///\n-/// # Example\n-///\n-/// ```\n-/// let a = 3i;\n-/// let b = 1i + 2i;\n-/// assert_eq!(a, b);\n-/// ```\n-#[macro_export]\n-#[stable]\n-macro_rules! assert_eq {\n-    ($left:expr , $right:expr) => ({\n-        match (&($left), &($right)) {\n-            (left_val, right_val) => {\n-                // check both directions of equality....\n-                if !((*left_val == *right_val) &&\n-                     (*right_val == *left_val)) {\n-                    panic!(\"assertion failed: `(left == right) && (right == left)` \\\n-                           (left: `{:?}`, right: `{:?}`)\", *left_val, *right_val)\n-                }\n-            }\n-        }\n-    })\n-}\n-\n-/// Ensure that a boolean expression is `true` at runtime.\n-///\n-/// This will invoke the `panic!` macro if the provided expression cannot be\n-/// evaluated to `true` at runtime.\n-///\n-/// Unlike `assert!`, `debug_assert!` statements can be disabled by passing\n-/// `--cfg ndebug` to the compiler. This makes `debug_assert!` useful for\n-/// checks that are too expensive to be present in a release build but may be\n-/// helpful during development.\n-///\n-/// # Example\n-///\n-/// ```\n-/// // the panic message for these assertions is the stringified value of the\n-/// // expression given.\n-/// debug_assert!(true);\n-/// # fn some_expensive_computation() -> bool { true }\n-/// debug_assert!(some_expensive_computation());\n-///\n-/// // assert with a custom message\n-/// # let x = true;\n-/// debug_assert!(x, \"x wasn't true!\");\n-/// # let a = 3i; let b = 27i;\n-/// debug_assert!(a + b == 30, \"a = {}, b = {}\", a, b);\n-/// ```\n-#[macro_export]\n-#[stable]\n-macro_rules! debug_assert {\n-    ($($arg:tt)*) => (if cfg!(not(ndebug)) { assert!($($arg)*); })\n-}\n-\n-/// Asserts that two expressions are equal to each other, testing equality in\n-/// both directions.\n-///\n-/// On panic, this macro will print the values of the expressions.\n-///\n-/// Unlike `assert_eq!`, `debug_assert_eq!` statements can be disabled by\n-/// passing `--cfg ndebug` to the compiler. This makes `debug_assert_eq!`\n-/// useful for checks that are too expensive to be present in a release build\n-/// but may be helpful during development.\n-///\n-/// # Example\n-///\n-/// ```\n-/// let a = 3i;\n-/// let b = 1i + 2i;\n-/// debug_assert_eq!(a, b);\n-/// ```\n-#[macro_export]\n-macro_rules! debug_assert_eq {\n-    ($($arg:tt)*) => (if cfg!(not(ndebug)) { assert_eq!($($arg)*); })\n-}\n-\n-/// A utility macro for indicating unreachable code.\n-///\n-/// This is useful any time that the compiler can't determine that some code is unreachable. For\n-/// example:\n-///\n-/// * Match arms with guard conditions.\n-/// * Loops that dynamically terminate.\n-/// * Iterators that dynamically terminate.\n-///\n-/// # Panics\n-///\n-/// This will always panic.\n-///\n-/// # Examples\n-///\n-/// Match arms:\n-///\n-/// ```rust\n-/// fn foo(x: Option<int>) {\n-///     match x {\n-///         Some(n) if n >= 0 => println!(\"Some(Non-negative)\"),\n-///         Some(n) if n <  0 => println!(\"Some(Negative)\"),\n-///         Some(_)           => unreachable!(), // compile error if commented out\n-///         None              => println!(\"None\")\n-///     }\n-/// }\n-/// ```\n-///\n-/// Iterators:\n-///\n-/// ```rust\n-/// fn divide_by_three(x: u32) -> u32 { // one of the poorest implementations of x/3\n-///     for i in std::iter::count(0_u32, 1) {\n-///         if 3*i < i { panic!(\"u32 overflow\"); }\n-///         if x < 3*i { return i-1; }\n-///     }\n-///     unreachable!();\n-/// }\n-/// ```\n-#[macro_export]\n-#[unstable = \"relationship with panic is unclear\"]\n-macro_rules! unreachable {\n-    () => ({\n-        panic!(\"internal error: entered unreachable code\")\n-    });\n-    ($msg:expr) => ({\n-        unreachable!(\"{}\", $msg)\n-    });\n-    ($fmt:expr, $($arg:tt)*) => ({\n-        panic!(concat!(\"internal error: entered unreachable code: \", $fmt), $($arg)*)\n-    });\n-}\n-\n-/// A standardised placeholder for marking unfinished code. It panics with the\n-/// message `\"not yet implemented\"` when executed.\n-#[macro_export]\n-#[unstable = \"relationship with panic is unclear\"]\n-macro_rules! unimplemented {\n-    () => (panic!(\"not yet implemented\"))\n-}\n-\n /// Use the syntax described in `std::fmt` to create a value of type `String`.\n /// See `std::fmt` for more information.\n ///"}]}