{"sha": "7ad471b09d96ddaec442934e49013e6dc528da3a", "node_id": "C_kwDOAAsO6NoAKDdhZDQ3MWIwOWQ5NmRkYWVjNDQyOTM0ZTQ5MDEzZTZkYzUyOGRhM2E", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-03-12T07:13:28Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-03-12T07:13:28Z"}, "message": "Rollup merge of #109018 - jyn514:global-allocator-comment, r=lqd\n\nExpand on the allocator comment in `rustc-main`\n\nBefore, it said \"global_allocator does nothing\". Now it gives you suggestions for what to do if you want to change the global allocator (which is likely the main reason you'd be reading the comment).\n\ncc https://rust-lang.zulipchat.com/#narrow/stream/122651-general/topic/improving.20rustc.20memory.20usage", "tree": {"sha": "bf049d855ab08a97b00410335a9c5873e831c347", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bf049d855ab08a97b00410335a9c5873e831c347"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7ad471b09d96ddaec442934e49013e6dc528da3a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkDXuYCRBK7hj4Ov3rIwAAucsIAC+FyOmEY0WT484XjOKBJrnA\nEuJtkoLiCPgX+PsaE7h2CrpJORlxdmAvkBg3azvXbgaIfqU/gkNIE96je46q6sfd\nJwf+N557h7BvUW4EHVj4yEbR6JV/9fJRJCmwjzeSWA76Dsgd0dykggbYF7y2LJaQ\nydyUlylIoGkHs5Q+BQGrgbm7+JhUXhA0oe8n9YsAIlA04PyVnfqD9Yn9p/FJhQt8\n/i6h+BEq7YjsS2UAOKy2/Aj/hbWMe5uPYGKdIpl2zWDcQyVbNtfhfK6XtCzJV+t+\nVjVLsXCqcOhiEUuX0v4UcE+oZJ7uBYHc3bKGIJQ9PK/hNVOk3UYEMhCBW6bjvxU=\n=sWcr\n-----END PGP SIGNATURE-----\n", "payload": "tree bf049d855ab08a97b00410335a9c5873e831c347\nparent c9a38c3c697cb9db276178ec3690a08f599d38d4\nparent e89bd9428f621545c979c0ec686addc6563a394e\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1678605208 +0100\ncommitter GitHub <noreply@github.com> 1678605208 +0100\n\nRollup merge of #109018 - jyn514:global-allocator-comment, r=lqd\n\nExpand on the allocator comment in `rustc-main`\n\nBefore, it said \"global_allocator does nothing\". Now it gives you suggestions for what to do if you want to change the global allocator (which is likely the main reason you'd be reading the comment).\n\ncc https://rust-lang.zulipchat.com/#narrow/stream/122651-general/topic/improving.20rustc.20memory.20usage\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7ad471b09d96ddaec442934e49013e6dc528da3a", "html_url": "https://github.com/rust-lang/rust/commit/7ad471b09d96ddaec442934e49013e6dc528da3a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7ad471b09d96ddaec442934e49013e6dc528da3a/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c9a38c3c697cb9db276178ec3690a08f599d38d4", "url": "https://api.github.com/repos/rust-lang/rust/commits/c9a38c3c697cb9db276178ec3690a08f599d38d4", "html_url": "https://github.com/rust-lang/rust/commit/c9a38c3c697cb9db276178ec3690a08f599d38d4"}, {"sha": "e89bd9428f621545c979c0ec686addc6563a394e", "url": "https://api.github.com/repos/rust-lang/rust/commits/e89bd9428f621545c979c0ec686addc6563a394e", "html_url": "https://github.com/rust-lang/rust/commit/e89bd9428f621545c979c0ec686addc6563a394e"}], "stats": {"total": 9, "additions": 9, "deletions": 0}, "files": [{"sha": "434b978ae3151caa16781f2cddca9c9f5b8e5b46", "filename": "compiler/rustc/src/main.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/7ad471b09d96ddaec442934e49013e6dc528da3a/compiler%2Frustc%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7ad471b09d96ddaec442934e49013e6dc528da3a/compiler%2Frustc%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc%2Fsrc%2Fmain.rs?ref=7ad471b09d96ddaec442934e49013e6dc528da3a", "patch": "@@ -24,6 +24,15 @@\n // The two crates we link to here, `std` and `rustc_driver`, are both dynamic\n // libraries. So we must reference jemalloc symbols one way or another, because\n // this file is the only object code in the rustc executable.\n+//\n+// NOTE: if you are reading this comment because you want to set a custom `global_allocator` for\n+// benchmarking, consider using the benchmarks in the `rustc-perf` collector suite instead:\n+// https://github.com/rust-lang/rustc-perf/blob/master/collector/README.md#profiling\n+//\n+// NOTE: if you are reading this comment because you want to replace jemalloc with another allocator\n+// to compare their performance, see\n+// https://github.com/rust-lang/rust/commit/b90cfc887c31c3e7a9e6d462e2464db1fe506175#diff-43914724af6e464c1da2171e4a9b6c7e607d5bc1203fa95c0ab85be4122605ef\n+// for an example of how to do so.\n \n #[unix_sigpipe = \"sig_dfl\"]\n fn main() {"}]}