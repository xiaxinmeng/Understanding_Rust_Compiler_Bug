{"sha": "35ebbe3e019905911f6d84761683563a0ca4426b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM1ZWJiZTNlMDE5OTA1OTExZjZkODQ3NjE2ODM1NjNhMGNhNDQyNmI=", "commit": {"author": {"name": "Mara Bos", "email": "m-ou.se@m-ou.se", "date": "2021-02-08T18:28:09Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-02-08T18:28:09Z"}, "message": "Rollup merge of #71531 - spastorino:move-treat-err-as-bug-tests-to-ui, r=oli-obk\n\nMove treat err as bug tests to ui\n\ncc `@oli-obk`", "tree": {"sha": "71e361feab420cb2e310253ad0d4c3c5c24f095c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/71e361feab420cb2e310253ad0d4c3c5c24f095c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/35ebbe3e019905911f6d84761683563a0ca4426b", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgIYK8CRBK7hj4Ov3rIwAAdHIIAGfcfC5fJ7XQ5hBzjwrBTo1D\nCns6ngR0NryBirS87dfmZwanZnBhdfmBmmZ1BdM1egWe1dIm2J0b+9kZsufvfzmi\nTafeIcR5HcurO+U0BY4JW1C/22FxDs4mkSN5uPLzssuZ6FhBNfY/dYif9V4y5sgo\nmQu9glDGmsYrf94zlFrPtbzsLhpHvQLgsPpIUhvMm/QZ32EMsp7B13d+dHhvlSLH\nBRgi+2UCmDruE24ZoD5WleJLeA/lmASk9U5sa+wfLP7FAavIFImg241IMLnixjNx\nkgETy/yNSVrAwybvH32gWSgqz6t28xF7rigXIuJVbRlbbExMEtWcWRT3JiDir3Y=\n=6G10\n-----END PGP SIGNATURE-----\n", "payload": "tree 71e361feab420cb2e310253ad0d4c3c5c24f095c\nparent 921ec4b3fca17cc777766c240038d7d50ba98e0d\nparent 6d9efd17e527850b2caf48fcbf547d6d3ca4e39d\nauthor Mara Bos <m-ou.se@m-ou.se> 1612808889 +0100\ncommitter GitHub <noreply@github.com> 1612808889 +0100\n\nRollup merge of #71531 - spastorino:move-treat-err-as-bug-tests-to-ui, r=oli-obk\n\nMove treat err as bug tests to ui\n\ncc `@oli-obk`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/35ebbe3e019905911f6d84761683563a0ca4426b", "html_url": "https://github.com/rust-lang/rust/commit/35ebbe3e019905911f6d84761683563a0ca4426b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/35ebbe3e019905911f6d84761683563a0ca4426b/comments", "author": {"login": "m-ou-se", "id": 783247, "node_id": "MDQ6VXNlcjc4MzI0Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/783247?v=4", "gravatar_id": "", "url": "https://api.github.com/users/m-ou-se", "html_url": "https://github.com/m-ou-se", "followers_url": "https://api.github.com/users/m-ou-se/followers", "following_url": "https://api.github.com/users/m-ou-se/following{/other_user}", "gists_url": "https://api.github.com/users/m-ou-se/gists{/gist_id}", "starred_url": "https://api.github.com/users/m-ou-se/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/m-ou-se/subscriptions", "organizations_url": "https://api.github.com/users/m-ou-se/orgs", "repos_url": "https://api.github.com/users/m-ou-se/repos", "events_url": "https://api.github.com/users/m-ou-se/events{/privacy}", "received_events_url": "https://api.github.com/users/m-ou-se/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "921ec4b3fca17cc777766c240038d7d50ba98e0d", "url": "https://api.github.com/repos/rust-lang/rust/commits/921ec4b3fca17cc777766c240038d7d50ba98e0d", "html_url": "https://github.com/rust-lang/rust/commit/921ec4b3fca17cc777766c240038d7d50ba98e0d"}, {"sha": "6d9efd17e527850b2caf48fcbf547d6d3ca4e39d", "url": "https://api.github.com/repos/rust-lang/rust/commits/6d9efd17e527850b2caf48fcbf547d6d3ca4e39d", "html_url": "https://github.com/rust-lang/rust/commit/6d9efd17e527850b2caf48fcbf547d6d3ca4e39d"}], "stats": {"total": 59, "additions": 45, "deletions": 14}, "files": [{"sha": "57cac76aec2a5384243aa2d6fed45add8a19c416", "filename": "src/test/run-make-fulldeps/treat-err-as-bug/Makefile", "status": "removed", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/921ec4b3fca17cc777766c240038d7d50ba98e0d/src%2Ftest%2Frun-make-fulldeps%2Ftreat-err-as-bug%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/921ec4b3fca17cc777766c240038d7d50ba98e0d/src%2Ftest%2Frun-make-fulldeps%2Ftreat-err-as-bug%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Ftreat-err-as-bug%2FMakefile?ref=921ec4b3fca17cc777766c240038d7d50ba98e0d", "patch": "@@ -1,7 +0,0 @@\n--include ../tools.mk\n-\n-all:\n-\t$(RUSTC) err.rs -Z treat-err-as-bug 2>&1 \\\n-\t    | $(CGREP) \"panicked at 'aborting due to \\`-Z treat-err-as-bug=1\\`'\"\n-\t$(RUSTC) delay_span_bug.rs -Z treat-err-as-bug 2>&1 \\\n-\t    | $(CGREP) \"panicked at 'aborting due to \\`-Z treat-err-as-bug=1\\`'\""}, {"sha": "dad33e498b52fb57eb49660aef11acbf0de48242", "filename": "src/test/run-make-fulldeps/treat-err-as-bug/delay_span_bug.rs", "status": "removed", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/921ec4b3fca17cc777766c240038d7d50ba98e0d/src%2Ftest%2Frun-make-fulldeps%2Ftreat-err-as-bug%2Fdelay_span_bug.rs", "raw_url": "https://github.com/rust-lang/rust/raw/921ec4b3fca17cc777766c240038d7d50ba98e0d/src%2Ftest%2Frun-make-fulldeps%2Ftreat-err-as-bug%2Fdelay_span_bug.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Ftreat-err-as-bug%2Fdelay_span_bug.rs?ref=921ec4b3fca17cc777766c240038d7d50ba98e0d", "patch": "@@ -1,4 +0,0 @@\n-#![feature(rustc_attrs)]\n-\n-#[rustc_error(delay_span_bug_from_inside_query)]\n-fn main() {}"}, {"sha": "136b2f3070299687bd28b1577ea3f287fb1c29f1", "filename": "src/test/run-make-fulldeps/treat-err-as-bug/err.rs", "status": "removed", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/921ec4b3fca17cc777766c240038d7d50ba98e0d/src%2Ftest%2Frun-make-fulldeps%2Ftreat-err-as-bug%2Ferr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/921ec4b3fca17cc777766c240038d7d50ba98e0d/src%2Ftest%2Frun-make-fulldeps%2Ftreat-err-as-bug%2Ferr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Ftreat-err-as-bug%2Ferr.rs?ref=921ec4b3fca17cc777766c240038d7d50ba98e0d", "patch": "@@ -1,3 +0,0 @@\n-#![crate_type=\"rlib\"]\n-\n-pub static C: u32 = 0-1;"}, {"sha": "67846336acaaf27d337cdea040c668e1216a3216", "filename": "src/test/ui/treat-err-as-bug/delay_span_bug.rs", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/35ebbe3e019905911f6d84761683563a0ca4426b/src%2Ftest%2Fui%2Ftreat-err-as-bug%2Fdelay_span_bug.rs", "raw_url": "https://github.com/rust-lang/rust/raw/35ebbe3e019905911f6d84761683563a0ca4426b/src%2Ftest%2Fui%2Ftreat-err-as-bug%2Fdelay_span_bug.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftreat-err-as-bug%2Fdelay_span_bug.rs?ref=35ebbe3e019905911f6d84761683563a0ca4426b", "patch": "@@ -0,0 +1,11 @@\n+// compile-flags: -Ztreat-err-as-bug\n+// failure-status: 101\n+// error-pattern: aborting due to `-Z treat-err-as-bug=1`\n+// error-pattern: [trigger_delay_span_bug] trigger a delay span bug\n+// normalize-stderr-test \"note: .*\\n\\n\" -> \"\"\n+// normalize-stderr-test \"thread 'rustc' panicked.*\\n\" -> \"\"\n+\n+#![feature(rustc_attrs)]\n+\n+#[rustc_error(delay_span_bug_from_inside_query)]\n+fn main() {}"}, {"sha": "ed65b69ebcab1a6ad0adcdf6fdce0cec78ee6dbd", "filename": "src/test/ui/treat-err-as-bug/delay_span_bug.stderr", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/35ebbe3e019905911f6d84761683563a0ca4426b/src%2Ftest%2Fui%2Ftreat-err-as-bug%2Fdelay_span_bug.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/35ebbe3e019905911f6d84761683563a0ca4426b/src%2Ftest%2Fui%2Ftreat-err-as-bug%2Fdelay_span_bug.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftreat-err-as-bug%2Fdelay_span_bug.stderr?ref=35ebbe3e019905911f6d84761683563a0ca4426b", "patch": "@@ -0,0 +1,11 @@\n+error: internal compiler error: delayed span bug triggered by #[rustc_error(delay_span_bug_from_inside_query)]\n+  --> $DIR/delay_span_bug.rs:11:1\n+   |\n+LL | fn main() {}\n+   | ^^^^^^^^^\n+\n+error: internal compiler error: unexpected panic\n+\n+query stack during panic:\n+#0 [trigger_delay_span_bug] trigger a delay span bug\n+end of query stack"}, {"sha": "5442d8585941b7f4f9fbd33019bbaa1135ff8f4c", "filename": "src/test/ui/treat-err-as-bug/err.rs", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/35ebbe3e019905911f6d84761683563a0ca4426b/src%2Ftest%2Fui%2Ftreat-err-as-bug%2Ferr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/35ebbe3e019905911f6d84761683563a0ca4426b/src%2Ftest%2Fui%2Ftreat-err-as-bug%2Ferr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftreat-err-as-bug%2Ferr.rs?ref=35ebbe3e019905911f6d84761683563a0ca4426b", "patch": "@@ -0,0 +1,11 @@\n+// compile-flags: -Ztreat-err-as-bug\n+// failure-status: 101\n+// error-pattern: aborting due to `-Z treat-err-as-bug=1`\n+// error-pattern: [eval_to_allocation_raw] const-evaluating + checking `C`\n+// normalize-stderr-test \"note: .*\\n\\n\" -> \"\"\n+// normalize-stderr-test \"thread 'rustc' panicked.*\\n\" -> \"\"\n+\n+#![crate_type = \"rlib\"]\n+\n+pub static C: u32 = 0 - 1;\n+//~^ ERROR could not evaluate static initializer"}, {"sha": "61eb85c40a112c549c55f81e9437f7e64e503063", "filename": "src/test/ui/treat-err-as-bug/err.stderr", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/35ebbe3e019905911f6d84761683563a0ca4426b/src%2Ftest%2Fui%2Ftreat-err-as-bug%2Ferr.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/35ebbe3e019905911f6d84761683563a0ca4426b/src%2Ftest%2Fui%2Ftreat-err-as-bug%2Ferr.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ftreat-err-as-bug%2Ferr.stderr?ref=35ebbe3e019905911f6d84761683563a0ca4426b", "patch": "@@ -0,0 +1,12 @@\n+error[E0080]: could not evaluate static initializer\n+  --> $DIR/err.rs:10:21\n+   |\n+LL | pub static C: u32 = 0 - 1;\n+   |                     ^^^^^ attempt to compute `0_u32 - 1_u32`, which would overflow\n+\n+error: internal compiler error: unexpected panic\n+\n+query stack during panic:\n+#0 [eval_to_allocation_raw] const-evaluating + checking `C`\n+#1 [eval_to_allocation_raw] const-evaluating + checking `C`\n+end of query stack"}]}