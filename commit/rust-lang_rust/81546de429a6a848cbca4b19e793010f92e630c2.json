{"sha": "81546de429a6a848cbca4b19e793010f92e630c2", "node_id": "MDY6Q29tbWl0NzI0NzEyOjgxNTQ2ZGU0MjlhNmE4NDhjYmNhNGIxOWU3OTMwMTBmOTJlNjMwYzI=", "commit": {"author": {"name": "Yuki Okushi", "email": "huyuumi.dev@gmail.com", "date": "2020-08-08T02:36:10Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-08-08T02:36:10Z"}, "message": "Rollup merge of #75267 - estebank:cleanup, r=Dylan-DPC\n\nSmall cleanup\n\n* Add docstring to `Parser` field\n* Remove unnecessary `unwrap`\n* Remove unnecessary borrow\n* Fix indentation of some `teach`text output", "tree": {"sha": "7527baecda8dc3003a39d8b3dc4fdf0f39c3f8fb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7527baecda8dc3003a39d8b3dc4fdf0f39c3f8fb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/81546de429a6a848cbca4b19e793010f92e630c2", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfLg+bCRBK7hj4Ov3rIwAAdHIIAGe5zj/U05NB95ZcDGVcr0p5\nqIAzSxf0qmMLMs5OCBfzSWlSa8xck+oRXYjrahUf0MsHgfHPrJBiYTFgYZ61zaLY\nZr+mNXKrUNSZ05JTwoPnDSmb4vjToa2sFRjYAuxytNb+VuOift7CzeeaPxriJbKZ\nhDRnQMOHuwSgcwb2WGZdG6btHP4xkOH5cIZWJmtWvppFi8iWbKQ1ANPRz21UUlzJ\nmL1uiP/j+bj4MYltNtGhkjGBFPtdXS6oNwGRfYnQdeP22NSWzt66QukAAP86ILI4\n2jSfV1YbyBMNoZG4wfglFyBgnSRwlRUOgSDYIe+Qinoe/VvoQv4vpNIjUSR5pKI=\n=v8Pk\n-----END PGP SIGNATURE-----\n", "payload": "tree 7527baecda8dc3003a39d8b3dc4fdf0f39c3f8fb\nparent 2c1fe50362d4f5971af3183e3430663c8536c752\nparent 7e9a8483f486f73c5be14abfe48cf5298c7972f5\nauthor Yuki Okushi <huyuumi.dev@gmail.com> 1596854170 +0900\ncommitter GitHub <noreply@github.com> 1596854170 +0900\n\nRollup merge of #75267 - estebank:cleanup, r=Dylan-DPC\n\nSmall cleanup\n\n* Add docstring to `Parser` field\n* Remove unnecessary `unwrap`\n* Remove unnecessary borrow\n* Fix indentation of some `teach`text output\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/81546de429a6a848cbca4b19e793010f92e630c2", "html_url": "https://github.com/rust-lang/rust/commit/81546de429a6a848cbca4b19e793010f92e630c2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/81546de429a6a848cbca4b19e793010f92e630c2/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2c1fe50362d4f5971af3183e3430663c8536c752", "url": "https://api.github.com/repos/rust-lang/rust/commits/2c1fe50362d4f5971af3183e3430663c8536c752", "html_url": "https://github.com/rust-lang/rust/commit/2c1fe50362d4f5971af3183e3430663c8536c752"}, {"sha": "7e9a8483f486f73c5be14abfe48cf5298c7972f5", "url": "https://api.github.com/repos/rust-lang/rust/commits/7e9a8483f486f73c5be14abfe48cf5298c7972f5", "html_url": "https://github.com/rust-lang/rust/commit/7e9a8483f486f73c5be14abfe48cf5298c7972f5"}], "stats": {"total": 40, "additions": 21, "deletions": 19}, "files": [{"sha": "b33ae4bed828b95ad518c274e778244e3f9cacef", "filename": "src/librustc_parse/parser/mod.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/81546de429a6a848cbca4b19e793010f92e630c2/src%2Flibrustc_parse%2Fparser%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/81546de429a6a848cbca4b19e793010f92e630c2/src%2Flibrustc_parse%2Fparser%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_parse%2Fparser%2Fmod.rs?ref=81546de429a6a848cbca4b19e793010f92e630c2", "patch": "@@ -103,6 +103,8 @@ pub struct Parser<'a> {\n     /// error.\n     pub(super) unclosed_delims: Vec<UnmatchedBrace>,\n     last_unexpected_token_span: Option<Span>,\n+    /// Span pointing at the `:` for the last type ascription the parser has seen, and whether it\n+    /// looked like it could have been a mistyped path or literal `Option:Some(42)`).\n     pub last_type_ascription: Option<(Span, bool /* likely path typo */)>,\n     /// If present, this `Parser` is not parsing Rust code but rather a macro call.\n     subparser_name: Option<&'static str>,"}, {"sha": "461edaf32524d54d16e962cd0eebe0d3a2ad3b2a", "filename": "src/librustc_resolve/late.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/81546de429a6a848cbca4b19e793010f92e630c2/src%2Flibrustc_resolve%2Flate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/81546de429a6a848cbca4b19e793010f92e630c2/src%2Flibrustc_resolve%2Flate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Flate.rs?ref=81546de429a6a848cbca4b19e793010f92e630c2", "patch": "@@ -226,7 +226,7 @@ impl<'a> PathSource<'a> {\n                 ValueNS => \"method or associated constant\",\n                 MacroNS => bug!(\"associated macro\"),\n             },\n-            PathSource::Expr(parent) => match &parent.as_ref().map(|p| &p.kind) {\n+            PathSource::Expr(parent) => match parent.as_ref().map(|p| &p.kind) {\n                 // \"function\" here means \"anything callable\" rather than `DefKind::Fn`,\n                 // this is not precise but usually more helpful than just \"value\".\n                 Some(ExprKind::Call(call_expr, _)) => match &call_expr.kind {"}, {"sha": "f598ada900feecfd2f6062cac615917acfecfa41", "filename": "src/librustc_typeck/check/pat.rs", "status": "modified", "additions": 18, "deletions": 18, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/81546de429a6a848cbca4b19e793010f92e630c2/src%2Flibrustc_typeck%2Fcheck%2Fpat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/81546de429a6a848cbca4b19e793010f92e630c2/src%2Flibrustc_typeck%2Fcheck%2Fpat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fpat.rs?ref=81546de429a6a848cbca4b19e793010f92e630c2", "patch": "@@ -1114,7 +1114,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                 tcx.sess.struct_span_err(pat.span, \"`..` cannot be used in union patterns\").emit();\n             }\n         } else if !etc && !unmentioned_fields.is_empty() {\n-            unmentioned_err = Some(self.error_unmentioned_fields(pat.span, &unmentioned_fields));\n+            unmentioned_err = Some(self.error_unmentioned_fields(pat, &unmentioned_fields));\n         }\n         match (inexistent_fields_err, unmentioned_err) {\n             (Some(mut i), Some(mut u)) => {\n@@ -1237,13 +1237,13 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n         if tcx.sess.teach(&err.get_code().unwrap()) {\n             err.note(\n                 \"This error indicates that a struct pattern attempted to \\\n-                    extract a non-existent field from a struct. Struct fields \\\n-                    are identified by the name used before the colon : so struct \\\n-                    patterns should resemble the declaration of the struct type \\\n-                    being matched.\\n\\n\\\n-                    If you are using shorthand field patterns but want to refer \\\n-                    to the struct field by a different name, you should rename \\\n-                    it explicitly.\",\n+                 extract a non-existent field from a struct. Struct fields \\\n+                 are identified by the name used before the colon : so struct \\\n+                 patterns should resemble the declaration of the struct type \\\n+                 being matched.\\n\\n\\\n+                 If you are using shorthand field patterns but want to refer \\\n+                 to the struct field by a different name, you should rename \\\n+                 it explicitly.\",\n             );\n         }\n         err\n@@ -1299,7 +1299,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n \n     fn error_unmentioned_fields(\n         &self,\n-        span: Span,\n+        pat: &Pat<'_>,\n         unmentioned_fields: &[Ident],\n     ) -> DiagnosticBuilder<'tcx> {\n         let field_names = if unmentioned_fields.len() == 1 {\n@@ -1312,23 +1312,23 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                 .join(\", \");\n             format!(\"fields {}\", fields)\n         };\n-        let mut diag = struct_span_err!(\n+        let mut err = struct_span_err!(\n             self.tcx.sess,\n-            span,\n+            pat.span,\n             E0027,\n             \"pattern does not mention {}\",\n             field_names\n         );\n-        diag.span_label(span, format!(\"missing {}\", field_names));\n-        if self.tcx.sess.teach(&diag.get_code().unwrap()) {\n-            diag.note(\n+        err.span_label(pat.span, format!(\"missing {}\", field_names));\n+        if self.tcx.sess.teach(&err.get_code().unwrap()) {\n+            err.note(\n                 \"This error indicates that a pattern for a struct fails to specify a \\\n-                    sub-pattern for every one of the struct's fields. Ensure that each field \\\n-                    from the struct's definition is mentioned in the pattern, or use `..` to \\\n-                    ignore unwanted fields.\",\n+                 sub-pattern for every one of the struct's fields. Ensure that each field \\\n+                 from the struct's definition is mentioned in the pattern, or use `..` to \\\n+                 ignore unwanted fields.\",\n             );\n         }\n-        diag\n+        err\n     }\n \n     fn check_pat_box("}]}