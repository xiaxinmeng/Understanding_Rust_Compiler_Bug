{"sha": "7c8f29f02c279acfa7b0c353e2187ad268e25de8", "node_id": "C_kwDOAAsO6NoAKDdjOGYyOWYwMmMyNzlhY2ZhN2IwYzM1M2UyMTg3YWQyNjhlMjVkZTg", "commit": {"author": {"name": "Camille GILLOT", "email": "gillot.camille@gmail.com", "date": "2023-05-18T14:36:13Z"}, "committer": {"name": "Camille GILLOT", "email": "gillot.camille@gmail.com", "date": "2023-05-18T14:36:13Z"}, "message": "Revert spurious changes.", "tree": {"sha": "cbee62f49015511cefd587150d4afe6da04490b6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cbee62f49015511cefd587150d4afe6da04490b6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7c8f29f02c279acfa7b0c353e2187ad268e25de8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7c8f29f02c279acfa7b0c353e2187ad268e25de8", "html_url": "https://github.com/rust-lang/rust/commit/7c8f29f02c279acfa7b0c353e2187ad268e25de8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7c8f29f02c279acfa7b0c353e2187ad268e25de8/comments", "author": {"login": "cjgillot", "id": 1822483, "node_id": "MDQ6VXNlcjE4MjI0ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1822483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjgillot", "html_url": "https://github.com/cjgillot", "followers_url": "https://api.github.com/users/cjgillot/followers", "following_url": "https://api.github.com/users/cjgillot/following{/other_user}", "gists_url": "https://api.github.com/users/cjgillot/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjgillot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjgillot/subscriptions", "organizations_url": "https://api.github.com/users/cjgillot/orgs", "repos_url": "https://api.github.com/users/cjgillot/repos", "events_url": "https://api.github.com/users/cjgillot/events{/privacy}", "received_events_url": "https://api.github.com/users/cjgillot/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cjgillot", "id": 1822483, "node_id": "MDQ6VXNlcjE4MjI0ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/1822483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cjgillot", "html_url": "https://github.com/cjgillot", "followers_url": "https://api.github.com/users/cjgillot/followers", "following_url": "https://api.github.com/users/cjgillot/following{/other_user}", "gists_url": "https://api.github.com/users/cjgillot/gists{/gist_id}", "starred_url": "https://api.github.com/users/cjgillot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cjgillot/subscriptions", "organizations_url": "https://api.github.com/users/cjgillot/orgs", "repos_url": "https://api.github.com/users/cjgillot/repos", "events_url": "https://api.github.com/users/cjgillot/events{/privacy}", "received_events_url": "https://api.github.com/users/cjgillot/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8c2c695c9ee6f5e0f9fb8ef1037f1ec9c9dd94a1", "url": "https://api.github.com/repos/rust-lang/rust/commits/8c2c695c9ee6f5e0f9fb8ef1037f1ec9c9dd94a1", "html_url": "https://github.com/rust-lang/rust/commit/8c2c695c9ee6f5e0f9fb8ef1037f1ec9c9dd94a1"}], "stats": {"total": 22, "additions": 11, "deletions": 11}, "files": [{"sha": "3c350e25ba6ec066ad1fad4938ce150e97894fda", "filename": "compiler/rustc_const_eval/src/transform/validate.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/7c8f29f02c279acfa7b0c353e2187ad268e25de8/compiler%2Frustc_const_eval%2Fsrc%2Ftransform%2Fvalidate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7c8f29f02c279acfa7b0c353e2187ad268e25de8/compiler%2Frustc_const_eval%2Fsrc%2Ftransform%2Fvalidate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_const_eval%2Fsrc%2Ftransform%2Fvalidate.rs?ref=7c8f29f02c279acfa7b0c353e2187ad268e25de8", "patch": "@@ -155,7 +155,7 @@ impl<'a, 'tcx> TypeChecker<'a, 'tcx> {\n         if self.unwind_edge_count <= 1 {\n             return;\n         }\n-        let dom_tree = self.body.basic_blocks.dominators();\n+        let doms = self.body.basic_blocks.dominators();\n         let mut post_contract_node = FxHashMap::default();\n         // Reusing the allocation across invocations of the closure\n         let mut dom_path = vec![];\n@@ -164,7 +164,7 @@ impl<'a, 'tcx> TypeChecker<'a, 'tcx> {\n                 if let Some(root) = post_contract_node.get(&bb) {\n                     break *root;\n                 }\n-                let parent = dom_tree.immediate_dominator(bb).unwrap();\n+                let parent = doms.immediate_dominator(bb).unwrap();\n                 dom_path.push(bb);\n                 if !self.body.basic_blocks[parent].is_cleanup {\n                     break bb;"}, {"sha": "8b124516623d60bbe44e253e5a205f965e5a2753", "filename": "compiler/rustc_data_structures/src/graph/dominators/tests.rs", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/7c8f29f02c279acfa7b0c353e2187ad268e25de8/compiler%2Frustc_data_structures%2Fsrc%2Fgraph%2Fdominators%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7c8f29f02c279acfa7b0c353e2187ad268e25de8/compiler%2Frustc_data_structures%2Fsrc%2Fgraph%2Fdominators%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_data_structures%2Fsrc%2Fgraph%2Fdominators%2Ftests.rs?ref=7c8f29f02c279acfa7b0c353e2187ad268e25de8", "patch": "@@ -6,8 +6,8 @@ use super::super::tests::TestGraph;\n fn diamond() {\n     let graph = TestGraph::new(0, &[(0, 1), (0, 2), (1, 3), (2, 3)]);\n \n-    let tree = dominators(&graph);\n-    let immediate_dominators = &tree.immediate_dominators;\n+    let dominators = dominators(&graph);\n+    let immediate_dominators = &dominators.immediate_dominators;\n     assert_eq!(immediate_dominators[0], None);\n     assert_eq!(immediate_dominators[1], Some(0));\n     assert_eq!(immediate_dominators[2], Some(0));\n@@ -22,8 +22,8 @@ fn paper() {\n         &[(6, 5), (6, 4), (5, 1), (4, 2), (4, 3), (1, 2), (2, 3), (3, 2), (2, 1)],\n     );\n \n-    let dom_tree = dominators(&graph);\n-    let immediate_dominators = &dom_tree.immediate_dominators;\n+    let dominators = dominators(&graph);\n+    let immediate_dominators = &dominators.immediate_dominators;\n     assert_eq!(immediate_dominators[0], None); // <-- note that 0 is not in graph\n     assert_eq!(immediate_dominators[1], Some(6));\n     assert_eq!(immediate_dominators[2], Some(6));\n@@ -47,9 +47,9 @@ fn paper_slt() {\n #[test]\n fn immediate_dominator() {\n     let graph = TestGraph::new(1, &[(1, 2), (2, 3)]);\n-    let tree = dominators(&graph);\n-    assert_eq!(tree.immediate_dominator(0), None);\n-    assert_eq!(tree.immediate_dominator(1), None);\n-    assert_eq!(tree.immediate_dominator(2), Some(1));\n-    assert_eq!(tree.immediate_dominator(3), Some(2));\n+    let dominators = dominators(&graph);\n+    assert_eq!(dominators.immediate_dominator(0), None);\n+    assert_eq!(dominators.immediate_dominator(1), None);\n+    assert_eq!(dominators.immediate_dominator(2), Some(1));\n+    assert_eq!(dominators.immediate_dominator(3), Some(2));\n }"}]}