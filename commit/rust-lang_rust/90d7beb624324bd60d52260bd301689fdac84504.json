{"sha": "90d7beb624324bd60d52260bd301689fdac84504", "node_id": "C_kwDOAAsO6NoAKDkwZDdiZWI2MjQzMjRiZDYwZDUyMjYwYmQzMDE2ODlmZGFjODQ1MDQ", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-11-21T10:15:54Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-11-21T10:15:54Z"}, "message": "Extend GUI test for alias search result", "tree": {"sha": "bf0391a3b8e3128f8a83ecbb2ae0d1cc40e4b7c9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bf0391a3b8e3128f8a83ecbb2ae0d1cc40e4b7c9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/90d7beb624324bd60d52260bd301689fdac84504", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/90d7beb624324bd60d52260bd301689fdac84504", "html_url": "https://github.com/rust-lang/rust/commit/90d7beb624324bd60d52260bd301689fdac84504", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/90d7beb624324bd60d52260bd301689fdac84504/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ca0aad8795610a9650d061bf902e58f252a67565", "url": "https://api.github.com/repos/rust-lang/rust/commits/ca0aad8795610a9650d061bf902e58f252a67565", "html_url": "https://github.com/rust-lang/rust/commit/ca0aad8795610a9650d061bf902e58f252a67565"}], "stats": {"total": 53, "additions": 36, "deletions": 17}, "files": [{"sha": "dde43b1c980af213c641f351bdcb5cdf76481493", "filename": "src/test/rustdoc-gui/search-result-color.goml", "status": "modified", "additions": 36, "deletions": 17, "changes": 53, "blob_url": "https://github.com/rust-lang/rust/blob/90d7beb624324bd60d52260bd301689fdac84504/src%2Ftest%2Frustdoc-gui%2Fsearch-result-color.goml", "raw_url": "https://github.com/rust-lang/rust/raw/90d7beb624324bd60d52260bd301689fdac84504/src%2Ftest%2Frustdoc-gui%2Fsearch-result-color.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsearch-result-color.goml?ref=90d7beb624324bd60d52260bd301689fdac84504", "patch": "@@ -366,23 +366,42 @@ assert-css: (\n     {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n )\n \n-// Check the alias more specifically in the dark theme.\n+// Check the alias.\n goto: \"file://\" + |DOC_PATH| + \"/test_docs/index.html\"\n-// We set the theme so we're sure that the correct values will be used, whatever the computer\n-// this test is running on.\n-local-storage: {\n-    \"rustdoc-theme\": \"dark\",\n-    \"rustdoc-use-system-theme\": \"false\",\n-}\n // If the text isn't displayed, the browser doesn't compute color style correctly...\n show-text: true\n-// We reload the page so the local storage settings are being used.\n-reload:\n-write: (\".search-input\", \"thisisanalias\")\n-// To be SURE that the search will be run.\n-press-key: 'Enter'\n-// Waiting for the search results to appear...\n-wait-for: \"#titles\"\n-// Checking that the colors for the alias element are the ones expected.\n-assert-css: (\".result-name > .alias\", {\"color\": \"rgb(255, 255, 255)\"})\n-assert-css: (\".result-name > .alias > .grey\", {\"color\": \"rgb(204, 204, 204)\"})\n+\n+define-function: (\n+    \"check-alias\",\n+    (theme, alias, grey),\n+    [\n+        (\"local-storage\", {\"rustdoc-theme\": |theme|, \"rustdoc-use-system-theme\": \"false\"}),\n+        (\"reload\"),\n+        (\"write\", (\".search-input\", \"thisisanalias\")),\n+        // To be SURE that the search will be run.\n+        (\"press-key\", 'Enter'),\n+        // Waiting for the search results to appear...\n+        (\"wait-for\", \"#titles\"),\n+        // Checking that the colors for the alias element are the ones expected.\n+        (\"assert-css\", (\".result-name > .alias\", {\"color\": |alias|})),\n+        (\"assert-css\", (\".result-name > .alias > .grey\", {\"color\": |grey|})),\n+        // Leave the search results to prevent reloading with an already filled search input.\n+        (\"press-key\", \"Escape\"),\n+    ],\n+)\n+\n+call-function: (\"check-alias\", {\n+    \"theme\": \"ayu\",\n+    \"alias\": \"rgb(197, 197, 197)\",\n+    \"grey\": \"rgb(153, 153, 153)\",\n+})\n+call-function: (\"check-alias\", {\n+    \"theme\": \"dark\",\n+    \"alias\": \"rgb(255, 255, 255)\",\n+    \"grey\": \"rgb(204, 204, 204)\",\n+})\n+call-function: (\"check-alias\", {\n+    \"theme\": \"light\",\n+    \"alias\": \"rgb(0, 0, 0)\",\n+    \"grey\": \"rgb(153, 153, 153)\",\n+})"}]}