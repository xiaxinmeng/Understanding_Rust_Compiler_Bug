{"sha": "1314ba323b6612d5109344c1d8bf9ae16e1e421f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjEzMTRiYTMyM2I2NjEyZDUxMDkzNDRjMWQ4YmY5YWUxNmUxZTQyMWY=", "commit": {"author": {"name": "Remy Rakic", "email": "remy.rakic@gmail.com", "date": "2019-12-03T13:07:41Z"}, "committer": {"name": "Remy Rakic", "email": "remy.rakic@gmail.com", "date": "2019-12-06T10:50:02Z"}, "message": "add subset relations test using polonius\n\nIt's a relatively simple smoke-test for subset errors, executed outside\nof the polonius compare-mode.", "tree": {"sha": "f6251934ad43f2ce6c8bc30001f381a22ea759ed", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f6251934ad43f2ce6c8bc30001f381a22ea759ed"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1314ba323b6612d5109344c1d8bf9ae16e1e421f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1314ba323b6612d5109344c1d8bf9ae16e1e421f", "html_url": "https://github.com/rust-lang/rust/commit/1314ba323b6612d5109344c1d8bf9ae16e1e421f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1314ba323b6612d5109344c1d8bf9ae16e1e421f/comments", "author": {"login": "lqd", "id": 247183, "node_id": "MDQ6VXNlcjI0NzE4Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/247183?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lqd", "html_url": "https://github.com/lqd", "followers_url": "https://api.github.com/users/lqd/followers", "following_url": "https://api.github.com/users/lqd/following{/other_user}", "gists_url": "https://api.github.com/users/lqd/gists{/gist_id}", "starred_url": "https://api.github.com/users/lqd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lqd/subscriptions", "organizations_url": "https://api.github.com/users/lqd/orgs", "repos_url": "https://api.github.com/users/lqd/repos", "events_url": "https://api.github.com/users/lqd/events{/privacy}", "received_events_url": "https://api.github.com/users/lqd/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lqd", "id": 247183, "node_id": "MDQ6VXNlcjI0NzE4Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/247183?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lqd", "html_url": "https://github.com/lqd", "followers_url": "https://api.github.com/users/lqd/followers", "following_url": "https://api.github.com/users/lqd/following{/other_user}", "gists_url": "https://api.github.com/users/lqd/gists{/gist_id}", "starred_url": "https://api.github.com/users/lqd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lqd/subscriptions", "organizations_url": "https://api.github.com/users/lqd/orgs", "repos_url": "https://api.github.com/users/lqd/repos", "events_url": "https://api.github.com/users/lqd/events{/privacy}", "received_events_url": "https://api.github.com/users/lqd/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e2230a4366dc7854f766e4f79e964f719671fa0c", "url": "https://api.github.com/repos/rust-lang/rust/commits/e2230a4366dc7854f766e4f79e964f719671fa0c", "html_url": "https://github.com/rust-lang/rust/commit/e2230a4366dc7854f766e4f79e964f719671fa0c"}], "stats": {"total": 44, "additions": 44, "deletions": 0}, "files": [{"sha": "3f6f67ebf4030084cfa22be2421c8dcf49fbae3d", "filename": "src/test/ui/nll/polonius/subset-relations.rs", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/1314ba323b6612d5109344c1d8bf9ae16e1e421f/src%2Ftest%2Fui%2Fnll%2Fpolonius%2Fsubset-relations.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1314ba323b6612d5109344c1d8bf9ae16e1e421f/src%2Ftest%2Fui%2Fnll%2Fpolonius%2Fsubset-relations.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnll%2Fpolonius%2Fsubset-relations.rs?ref=1314ba323b6612d5109344c1d8bf9ae16e1e421f", "patch": "@@ -0,0 +1,30 @@\n+// Checks that Polonius can compute cases of universal regions errors:\n+// \"illegal subset relation errors\", cases where analysis finds that\n+// two free regions outlive each other, without any evidence that this\n+// relation holds.\n+\n+// ignore-compare-mode-nll\n+// compile-flags: -Z borrowck=mir -Zpolonius\n+\n+// returning `y` requires that `'b: 'a`, but it's not known to be true\n+fn missing_subset<'a, 'b>(x: &'a u32, y: &'b u32) -> &'a u32 {\n+    y //~ ERROR\n+}\n+\n+// `'b: 'a` is explicitly declared\n+fn valid_subset<'a, 'b: 'a>(x: &'a u32, y: &'b u32) -> &'a u32 {\n+    y\n+}\n+\n+// because of `x`, it is implied that `'b: 'a` holds\n+fn implied_bounds_subset<'a, 'b>(x: &'a &'b mut u32) -> &'a u32 {\n+    x\n+}\n+\n+// `'b: 'a` is declared, and `'a: 'c` is known via implied bounds:\n+// `'b: 'c` is therefore known to hold transitively\n+fn transitively_valid_subset<'a, 'b: 'a, 'c>(x: &'c &'a u32, y: &'b u32) -> &'c u32  {\n+    y\n+}\n+\n+fn main() {}"}, {"sha": "63645106f82c169dc1f4ee2585bebc4e7066d692", "filename": "src/test/ui/nll/polonius/subset-relations.stderr", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/1314ba323b6612d5109344c1d8bf9ae16e1e421f/src%2Ftest%2Fui%2Fnll%2Fpolonius%2Fsubset-relations.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/1314ba323b6612d5109344c1d8bf9ae16e1e421f/src%2Ftest%2Fui%2Fnll%2Fpolonius%2Fsubset-relations.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnll%2Fpolonius%2Fsubset-relations.stderr?ref=1314ba323b6612d5109344c1d8bf9ae16e1e421f", "patch": "@@ -0,0 +1,14 @@\n+error: lifetime may not live long enough\n+  --> $DIR/subset-relations.rs:11:5\n+   |\n+LL | fn missing_subset<'a, 'b>(x: &'a u32, y: &'b u32) -> &'a u32 {\n+   |                   --  -- lifetime `'b` defined here\n+   |                   |\n+   |                   lifetime `'a` defined here\n+LL |     y\n+   |     ^ function was supposed to return data with lifetime `'a` but it is returning data with lifetime `'b`\n+   |\n+   = help: consider adding the following bound: `'b: 'a`\n+\n+error: aborting due to previous error\n+"}]}