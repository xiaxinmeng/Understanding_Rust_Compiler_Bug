{"sha": "110b71a8280c984bf63a01199f57e50eafad0b8f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjExMGI3MWE4MjgwYzk4NGJmNjNhMDExOTlmNTdlNTBlYWZhZDBiOGY=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2018-08-01T19:46:33Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-08-01T19:46:33Z"}, "message": "Rollup merge of #52926 - alexcrichton:trim-idioms-lints, r=oli-obk\n\nrustc: Trim down the `rust_2018_idioms` lint group\n\nThese migration lints aren't all up to par in terms of a good migration\nexperience. Some, like `unreachable_pub`, hit bugs like #52665 and unprepared\nmacros to be handled enough of the time. Others like linting against\n`#[macro_use]` are swimming upstream in an ecosystem that's not quite ready (and\nslightly buggy pending a few current PRs).\n\nThe general idea is that we will continue to recommend the `rust_2018_idioms`\nlint group as part of the transition guide (as an optional step) but we'll be\nmuch more selective about which lints make it into this group. Only those with a\nstrong track record of not causing too much churn will make the cut.\n\ncc #52679", "tree": {"sha": "4e39ef6bba06a647ca9aab4b0cfeae95669f3c27", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4e39ef6bba06a647ca9aab4b0cfeae95669f3c27"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/110b71a8280c984bf63a01199f57e50eafad0b8f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJbYg4aCRBK7hj4Ov3rIwAAdHIIAKV3Y2HsgawqoSB1gHGCLpox\n8F+MKOpJYKGEdj/8cI5saLWuYdrRp5Q4t1WB0/wSoIntaAMqOVWQtpcdpYDQrTQS\nhBw619Wr+/qaWy5Ybluh5CnJz+WaiwfPMEg/Tp3ASrXA9VpPCOpyO+XVLWQbLo9r\nDH8Fj1G/8zxZ2aDPVvNhvWgL56NE5nQJ4ky7uOZutf0M/u+6qLpV82kaCMyCUXWq\nL9z4BLZlE0zp26MP54BQK2b2/pXVo331/C1nU0jKgE1PJJpNBehHoz08iDVA50HG\np4SbPIZfxdpPQKdJ1TXyFkiovRdM/2eALQ41ED5zf2mmFctNCSVe4ZA0PlYsWH8=\n=92Zh\n-----END PGP SIGNATURE-----\n", "payload": "tree 4e39ef6bba06a647ca9aab4b0cfeae95669f3c27\nparent b40b8996901e19d71d3336afc53a97bfa9c7b14a\nparent 27b3cb552d8e7b4f5d2faad841df7a79f09fd362\nauthor Pietro Albini <pietro@pietroalbini.org> 1533152793 +0200\ncommitter GitHub <noreply@github.com> 1533152793 +0200\n\nRollup merge of #52926 - alexcrichton:trim-idioms-lints, r=oli-obk\n\nrustc: Trim down the `rust_2018_idioms` lint group\n\nThese migration lints aren't all up to par in terms of a good migration\nexperience. Some, like `unreachable_pub`, hit bugs like #52665 and unprepared\nmacros to be handled enough of the time. Others like linting against\n`#[macro_use]` are swimming upstream in an ecosystem that's not quite ready (and\nslightly buggy pending a few current PRs).\n\nThe general idea is that we will continue to recommend the `rust_2018_idioms`\nlint group as part of the transition guide (as an optional step) but we'll be\nmuch more selective about which lints make it into this group. Only those with a\nstrong track record of not causing too much churn will make the cut.\n\ncc #52679\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/110b71a8280c984bf63a01199f57e50eafad0b8f", "html_url": "https://github.com/rust-lang/rust/commit/110b71a8280c984bf63a01199f57e50eafad0b8f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/110b71a8280c984bf63a01199f57e50eafad0b8f/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b40b8996901e19d71d3336afc53a97bfa9c7b14a", "url": "https://api.github.com/repos/rust-lang/rust/commits/b40b8996901e19d71d3336afc53a97bfa9c7b14a", "html_url": "https://github.com/rust-lang/rust/commit/b40b8996901e19d71d3336afc53a97bfa9c7b14a"}, {"sha": "27b3cb552d8e7b4f5d2faad841df7a79f09fd362", "url": "https://api.github.com/repos/rust-lang/rust/commits/27b3cb552d8e7b4f5d2faad841df7a79f09fd362", "html_url": "https://github.com/rust-lang/rust/commit/27b3cb552d8e7b4f5d2faad841df7a79f09fd362"}], "stats": {"total": 29, "additions": 17, "deletions": 12}, "files": [{"sha": "b92ac0ff57bd88478b5fb40c95520c55e884173a", "filename": "src/librustc_lint/lib.rs", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/110b71a8280c984bf63a01199f57e50eafad0b8f/src%2Flibrustc_lint%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/110b71a8280c984bf63a01199f57e50eafad0b8f/src%2Flibrustc_lint%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Flib.rs?ref=110b71a8280c984bf63a01199f57e50eafad0b8f", "patch": "@@ -45,7 +45,6 @@ use rustc::lint::{LateContext, LateLintPass, LintPass, LintArray};\n use rustc::lint::builtin::{\n     BARE_TRAIT_OBJECTS,\n     ABSOLUTE_PATHS_NOT_STARTING_WITH_CRATE,\n-    MACRO_USE_EXTERN_CRATE,\n     ELIDED_LIFETIMES_IN_PATHS,\n     parser::QUESTION_MARK_MACRO_SEP\n };\n@@ -195,11 +194,18 @@ pub fn register_builtins(store: &mut lint::LintStore, sess: Option<&Session>) {\n     add_lint_group!(sess,\n                     \"rust_2018_idioms\",\n                     BARE_TRAIT_OBJECTS,\n-                    UNREACHABLE_PUB,\n                     UNUSED_EXTERN_CRATES,\n-                    MACRO_USE_EXTERN_CRATE,\n-                    ELIDED_LIFETIMES_IN_PATHS,\n-                    ELLIPSIS_INCLUSIVE_RANGE_PATTERNS);\n+                    ELLIPSIS_INCLUSIVE_RANGE_PATTERNS,\n+                    ELIDED_LIFETIMES_IN_PATHS\n+\n+                    // FIXME(#52665, #47816) not always applicable and not all\n+                    // macros are ready for this yet.\n+                    // UNREACHABLE_PUB,\n+\n+                    // FIXME macro crates are not up for this yet, too much\n+                    // breakage is seen if we try to encourage this lint.\n+                    // MACRO_USE_EXTERN_CRATE,\n+                    );\n \n     // Guidelines for creating a future incompatibility lint:\n     //"}, {"sha": "f50419434ae1ddfa518d5ef64f49bad26d7ad865", "filename": "src/test/ui/rust-2018/macro-use-warned-against.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/110b71a8280c984bf63a01199f57e50eafad0b8f/src%2Ftest%2Fui%2Frust-2018%2Fmacro-use-warned-against.rs", "raw_url": "https://github.com/rust-lang/rust/raw/110b71a8280c984bf63a01199f57e50eafad0b8f/src%2Ftest%2Fui%2Frust-2018%2Fmacro-use-warned-against.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frust-2018%2Fmacro-use-warned-against.rs?ref=110b71a8280c984bf63a01199f57e50eafad0b8f", "patch": "@@ -12,7 +12,7 @@\n // aux-build:macro-use-warned-against2.rs\n // compile-pass\n \n-#![warn(rust_2018_idioms, unused)]\n+#![warn(macro_use_extern_crate, unused)]\n #![feature(use_extern_macros)]\n \n #[macro_use] //~ WARN should be replaced at use sites with a `use` statement"}, {"sha": "7af404fab790e432ac20cee4d7e1637fe92a9124", "filename": "src/test/ui/rust-2018/macro-use-warned-against.stderr", "status": "modified", "additions": 5, "deletions": 6, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/110b71a8280c984bf63a01199f57e50eafad0b8f/src%2Ftest%2Fui%2Frust-2018%2Fmacro-use-warned-against.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/110b71a8280c984bf63a01199f57e50eafad0b8f/src%2Ftest%2Fui%2Frust-2018%2Fmacro-use-warned-against.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frust-2018%2Fmacro-use-warned-against.stderr?ref=110b71a8280c984bf63a01199f57e50eafad0b8f", "patch": "@@ -7,9 +7,8 @@ LL | #[macro_use] //~ WARN should be replaced at use sites with a `use` statemen\n note: lint level defined here\n   --> $DIR/macro-use-warned-against.rs:15:9\n    |\n-LL | #![warn(rust_2018_idioms, unused)]\n-   |         ^^^^^^^^^^^^^^^^\n-   = note: #[warn(macro_use_extern_crate)] implied by #[warn(rust_2018_idioms)]\n+LL | #![warn(macro_use_extern_crate, unused)]\n+   |         ^^^^^^^^^^^^^^^^^^^^^^\n \n warning: unused `#[macro_use]` import\n   --> $DIR/macro-use-warned-against.rs:20:1\n@@ -18,9 +17,9 @@ LL | #[macro_use] //~ WARN unused `#[macro_use]`\n    | ^^^^^^^^^^^^\n    |\n note: lint level defined here\n-  --> $DIR/macro-use-warned-against.rs:15:27\n+  --> $DIR/macro-use-warned-against.rs:15:33\n    |\n-LL | #![warn(rust_2018_idioms, unused)]\n-   |                           ^^^^^^\n+LL | #![warn(macro_use_extern_crate, unused)]\n+   |                                 ^^^^^^\n    = note: #[warn(unused_imports)] implied by #[warn(unused)]\n "}]}