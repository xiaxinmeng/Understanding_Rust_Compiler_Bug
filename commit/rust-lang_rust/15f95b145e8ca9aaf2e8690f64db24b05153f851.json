{"sha": "15f95b145e8ca9aaf2e8690f64db24b05153f851", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE1Zjk1YjE0NWU4Y2E5YWFmMmU4NjkwZjY0ZGIyNGIwNTE1M2Y4NTE=", "commit": {"author": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2020-04-19T19:42:24Z"}, "committer": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2020-04-23T18:01:56Z"}, "message": "Cycle errors now occur during const-eval, not checking", "tree": {"sha": "07557629b1f6c2744657dccbe66f8e953720be99", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/07557629b1f6c2744657dccbe66f8e953720be99"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/15f95b145e8ca9aaf2e8690f64db24b05153f851", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/15f95b145e8ca9aaf2e8690f64db24b05153f851", "html_url": "https://github.com/rust-lang/rust/commit/15f95b145e8ca9aaf2e8690f64db24b05153f851", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/15f95b145e8ca9aaf2e8690f64db24b05153f851/comments", "author": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1343797859d9d2204b7d19e97acbe83c4744578c", "url": "https://api.github.com/repos/rust-lang/rust/commits/1343797859d9d2204b7d19e97acbe83c4744578c", "html_url": "https://github.com/rust-lang/rust/commit/1343797859d9d2204b7d19e97acbe83c4744578c"}], "stats": {"total": 133, "additions": 106, "deletions": 27}, "files": [{"sha": "ee621a8cb147309deb514880bb1cf5e3eb806b14", "filename": "src/test/ui/issues/issue-17252.stderr", "status": "modified", "additions": 16, "deletions": 5, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/15f95b145e8ca9aaf2e8690f64db24b05153f851/src%2Ftest%2Fui%2Fissues%2Fissue-17252.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/15f95b145e8ca9aaf2e8690f64db24b05153f851/src%2Ftest%2Fui%2Fissues%2Fissue-17252.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-17252.stderr?ref=15f95b145e8ca9aaf2e8690f64db24b05153f851", "patch": "@@ -1,11 +1,22 @@\n-error[E0391]: cycle detected when const checking `FOO`\n-  --> $DIR/issue-17252.rs:1:20\n+error[E0391]: cycle detected when normalizing `FOO`\n+   |\n+note: ...which requires const-evaluating + checking `FOO`...\n+  --> $DIR/issue-17252.rs:1:1\n+   |\n+LL | const FOO: usize = FOO;\n+   | ^^^^^^^^^^^^^^^^^^^^^^^\n+note: ...which requires const-evaluating + checking `FOO`...\n+  --> $DIR/issue-17252.rs:1:1\n    |\n LL | const FOO: usize = FOO;\n-   |                    ^^^\n+   | ^^^^^^^^^^^^^^^^^^^^^^^\n+note: ...which requires const-evaluating `FOO`...\n+  --> $DIR/issue-17252.rs:1:1\n    |\n-   = note: ...which again requires const checking `FOO`, completing the cycle\n-note: cycle used when const checking `main::{{constant}}#0`\n+LL | const FOO: usize = FOO;\n+   | ^^^^^^^^^^^^^^^^^^^^^^^\n+   = note: ...which again requires normalizing `FOO`, completing the cycle\n+note: cycle used when const-evaluating `main::{{constant}}#0`\n   --> $DIR/issue-17252.rs:4:18\n    |\n LL |     let _x: [u8; FOO]; // caused stack overflow prior to fix"}, {"sha": "b6c85b9e22749c9053cb5000a4d34efcc0744174", "filename": "src/test/ui/issues/issue-23302-1.stderr", "status": "modified", "additions": 14, "deletions": 3, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/15f95b145e8ca9aaf2e8690f64db24b05153f851/src%2Ftest%2Fui%2Fissues%2Fissue-23302-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/15f95b145e8ca9aaf2e8690f64db24b05153f851/src%2Ftest%2Fui%2Fissues%2Fissue-23302-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-23302-1.stderr?ref=15f95b145e8ca9aaf2e8690f64db24b05153f851", "patch": "@@ -1,15 +1,26 @@\n-error[E0391]: cycle detected when const checking `X::A::{{constant}}#0`\n+error[E0391]: cycle detected when const-evaluating + checking `X::A::{{constant}}#0`\n   --> $DIR/issue-23302-1.rs:4:9\n    |\n LL |     A = X::A as isize,\n    |         ^^^^^^^^^^^^^\n    |\n-   = note: ...which again requires const checking `X::A::{{constant}}#0`, completing the cycle\n-note: cycle used when processing `X::A::{{constant}}#0`\n+note: ...which requires const-evaluating + checking `X::A::{{constant}}#0`...\n   --> $DIR/issue-23302-1.rs:4:9\n    |\n LL |     A = X::A as isize,\n    |         ^^^^^^^^^^^^^\n+note: ...which requires const-evaluating `X::A::{{constant}}#0`...\n+  --> $DIR/issue-23302-1.rs:4:9\n+   |\n+LL |     A = X::A as isize,\n+   |         ^^^^^^^^^^^^^\n+   = note: ...which requires normalizing `X::A as isize`...\n+   = note: ...which again requires const-evaluating + checking `X::A::{{constant}}#0`, completing the cycle\n+note: cycle used when collecting item types in top-level module\n+  --> $DIR/issue-23302-1.rs:3:1\n+   |\n+LL | enum X {\n+   | ^^^^^^\n \n error: aborting due to previous error\n "}, {"sha": "d014922fe2069a5c5838c8e7f5578fdaab635d39", "filename": "src/test/ui/issues/issue-23302-2.stderr", "status": "modified", "additions": 14, "deletions": 3, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/15f95b145e8ca9aaf2e8690f64db24b05153f851/src%2Ftest%2Fui%2Fissues%2Fissue-23302-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/15f95b145e8ca9aaf2e8690f64db24b05153f851/src%2Ftest%2Fui%2Fissues%2Fissue-23302-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-23302-2.stderr?ref=15f95b145e8ca9aaf2e8690f64db24b05153f851", "patch": "@@ -1,15 +1,26 @@\n-error[E0391]: cycle detected when const checking `Y::A::{{constant}}#0`\n+error[E0391]: cycle detected when const-evaluating + checking `Y::A::{{constant}}#0`\n   --> $DIR/issue-23302-2.rs:4:9\n    |\n LL |     A = Y::B as isize,\n    |         ^^^^^^^^^^^^^\n    |\n-   = note: ...which again requires const checking `Y::A::{{constant}}#0`, completing the cycle\n-note: cycle used when processing `Y::A::{{constant}}#0`\n+note: ...which requires const-evaluating + checking `Y::A::{{constant}}#0`...\n   --> $DIR/issue-23302-2.rs:4:9\n    |\n LL |     A = Y::B as isize,\n    |         ^^^^^^^^^^^^^\n+note: ...which requires const-evaluating `Y::A::{{constant}}#0`...\n+  --> $DIR/issue-23302-2.rs:4:9\n+   |\n+LL |     A = Y::B as isize,\n+   |         ^^^^^^^^^^^^^\n+   = note: ...which requires normalizing `Y::B as isize`...\n+   = note: ...which again requires const-evaluating + checking `Y::A::{{constant}}#0`, completing the cycle\n+note: cycle used when collecting item types in top-level module\n+  --> $DIR/issue-23302-2.rs:3:1\n+   |\n+LL | enum Y {\n+   | ^^^^^^\n \n error: aborting due to previous error\n "}, {"sha": "b30b1214271a06354e0900c238c621e744a244c0", "filename": "src/test/ui/issues/issue-23302-3.stderr", "status": "modified", "additions": 27, "deletions": 9, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/15f95b145e8ca9aaf2e8690f64db24b05153f851/src%2Ftest%2Fui%2Fissues%2Fissue-23302-3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/15f95b145e8ca9aaf2e8690f64db24b05153f851/src%2Ftest%2Fui%2Fissues%2Fissue-23302-3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-23302-3.stderr?ref=15f95b145e8ca9aaf2e8690f64db24b05153f851", "patch": "@@ -1,20 +1,38 @@\n-error[E0391]: cycle detected when const checking `A`\n-  --> $DIR/issue-23302-3.rs:1:16\n+error[E0391]: cycle detected when const-evaluating + checking `A`\n+  --> $DIR/issue-23302-3.rs:1:1\n    |\n LL | const A: i32 = B;\n-   |                ^\n+   | ^^^^^^^^^^^^^^^^^\n    |\n-note: ...which requires const checking `B`...\n-  --> $DIR/issue-23302-3.rs:3:16\n+note: ...which requires const-evaluating + checking `A`...\n+  --> $DIR/issue-23302-3.rs:1:1\n    |\n-LL | const B: i32 = A;\n-   |                ^\n-   = note: ...which again requires const checking `A`, completing the cycle\n-note: cycle used when processing `A`\n+LL | const A: i32 = B;\n+   | ^^^^^^^^^^^^^^^^^\n+note: ...which requires const-evaluating `A`...\n   --> $DIR/issue-23302-3.rs:1:1\n    |\n LL | const A: i32 = B;\n    | ^^^^^^^^^^^^^^^^^\n+   = note: ...which requires normalizing `B`...\n+note: ...which requires const-evaluating + checking `B`...\n+  --> $DIR/issue-23302-3.rs:3:1\n+   |\n+LL | const B: i32 = A;\n+   | ^^^^^^^^^^^^^^^^^\n+note: ...which requires const-evaluating + checking `B`...\n+  --> $DIR/issue-23302-3.rs:3:1\n+   |\n+LL | const B: i32 = A;\n+   | ^^^^^^^^^^^^^^^^^\n+note: ...which requires const-evaluating `B`...\n+  --> $DIR/issue-23302-3.rs:3:1\n+   |\n+LL | const B: i32 = A;\n+   | ^^^^^^^^^^^^^^^^^\n+   = note: ...which requires normalizing `A`...\n+   = note: ...which again requires const-evaluating + checking `A`, completing the cycle\n+   = note: cycle used when running analysis passes on this crate\n \n error: aborting due to previous error\n "}, {"sha": "7c2da9dce6e9da41cc45a1809c0d2efa07257910", "filename": "src/test/ui/issues/issue-36163.stderr", "status": "modified", "additions": 35, "deletions": 7, "changes": 42, "blob_url": "https://github.com/rust-lang/rust/blob/15f95b145e8ca9aaf2e8690f64db24b05153f851/src%2Ftest%2Fui%2Fissues%2Fissue-36163.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/15f95b145e8ca9aaf2e8690f64db24b05153f851/src%2Ftest%2Fui%2Fissues%2Fissue-36163.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-36163.stderr?ref=15f95b145e8ca9aaf2e8690f64db24b05153f851", "patch": "@@ -1,20 +1,48 @@\n-error[E0391]: cycle detected when const checking `Foo::B::{{constant}}#0`\n+error[E0391]: cycle detected when const-evaluating + checking `Foo::B::{{constant}}#0`\n   --> $DIR/issue-36163.rs:4:9\n    |\n LL |     B = A,\n    |         ^\n    |\n-note: ...which requires const checking `A`...\n-  --> $DIR/issue-36163.rs:1:18\n+note: ...which requires const-evaluating + checking `Foo::B::{{constant}}#0`...\n+  --> $DIR/issue-36163.rs:4:9\n    |\n-LL | const A: isize = Foo::B as isize;\n-   |                  ^^^^^^^^^^^^^^^\n-   = note: ...which again requires const checking `Foo::B::{{constant}}#0`, completing the cycle\n-note: cycle used when processing `Foo::B::{{constant}}#0`\n+LL |     B = A,\n+   |         ^\n+note: ...which requires const-evaluating `Foo::B::{{constant}}#0`...\n   --> $DIR/issue-36163.rs:4:9\n    |\n LL |     B = A,\n    |         ^\n+   = note: ...which requires normalizing `A`...\n+note: ...which requires const-evaluating + checking `A`...\n+  --> $DIR/issue-36163.rs:1:1\n+   |\n+LL | const A: isize = Foo::B as isize;\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+note: ...which requires const-evaluating + checking `A`...\n+  --> $DIR/issue-36163.rs:1:1\n+   |\n+LL | const A: isize = Foo::B as isize;\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+note: ...which requires const-evaluating `A`...\n+  --> $DIR/issue-36163.rs:1:1\n+   |\n+LL | const A: isize = Foo::B as isize;\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   = note: ...which requires normalizing `A`...\n+   = note: ...which again requires const-evaluating + checking `Foo::B::{{constant}}#0`, completing the cycle\n+note: cycle used when collecting item types in top-level module\n+  --> $DIR/issue-36163.rs:1:1\n+   |\n+LL | / const A: isize = Foo::B as isize;\n+LL | |\n+LL | | enum Foo {\n+LL | |     B = A,\n+LL | | }\n+LL | |\n+LL | | fn main() {}\n+   | |____________^\n \n error: aborting due to previous error\n "}]}