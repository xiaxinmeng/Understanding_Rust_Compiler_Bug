{"sha": "184d3bca6cc1ac2023bbd723223d1a9bd4d4380b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE4NGQzYmNhNmNjMWFjMjAyM2JiZDcyMzIyM2QxYTliZDRkNDM4MGI=", "commit": {"author": {"name": "Mark Simulacrum", "email": "mark.simulacrum@gmail.com", "date": "2018-04-01T16:51:24Z"}, "committer": {"name": "Mark Simulacrum", "email": "mark.simulacrum@gmail.com", "date": "2018-04-03T17:43:14Z"}, "message": "Stop checking that the graph produced by a dry run is equivalent\n\nThis is too likely to cause spurious bounces on CI; what we run may be\ndependent on what ran successfully before hand (e.g. RLS features with\nClippy), which makes this not tenable. There's no good way to ignore\nspecifically these problematic steps so we'll just ignore everything for\nthe time being. We still test that a dry run worked though so largely\nthis is the same from a ensure-that-tests-work perspective.\n\nEventually we'll want to undo this commit, though, to make our tests\nmore accurate.", "tree": {"sha": "ecac9d77b11721fe7f855908f292ee3e1da08648", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ecac9d77b11721fe7f855908f292ee3e1da08648"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/184d3bca6cc1ac2023bbd723223d1a9bd4d4380b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/184d3bca6cc1ac2023bbd723223d1a9bd4d4380b", "html_url": "https://github.com/rust-lang/rust/commit/184d3bca6cc1ac2023bbd723223d1a9bd4d4380b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/184d3bca6cc1ac2023bbd723223d1a9bd4d4380b/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0ce5cf06973aa75bc1729e5bc1aa0a611537014c", "url": "https://api.github.com/repos/rust-lang/rust/commits/0ce5cf06973aa75bc1729e5bc1aa0a611537014c", "html_url": "https://github.com/rust-lang/rust/commit/0ce5cf06973aa75bc1729e5bc1aa0a611537014c"}], "stats": {"total": 16, "additions": 4, "deletions": 12}, "files": [{"sha": "2eeb2691eaee45a427f68d944257607d894870ab", "filename": "src/bootstrap/lib.rs", "status": "modified", "additions": 4, "deletions": 12, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/184d3bca6cc1ac2023bbd723223d1a9bd4d4380b/src%2Fbootstrap%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/184d3bca6cc1ac2023bbd723223d1a9bd4d4380b/src%2Fbootstrap%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Flib.rs?ref=184d3bca6cc1ac2023bbd723223d1a9bd4d4380b", "patch": "@@ -416,22 +416,14 @@ impl Build {\n         }\n \n         if !self.config.dry_run {\n-            let dry_graph = {\n+            {\n                 self.config.dry_run = true;\n                 let builder = builder::Builder::new(&self);\n-                builder.execute_cli()\n-            };\n+                builder.execute_cli();\n+            }\n             self.config.dry_run = false;\n             let builder = builder::Builder::new(&self);\n-            let act_graph = builder.execute_cli();\n-            assert_eq!(dry_graph.raw_nodes().iter().map(|i| &i.weight).collect::<Vec<_>>(),\n-                act_graph.raw_nodes().iter().map(|i| &i.weight).collect::<Vec<_>>());\n-            assert_eq!(dry_graph.raw_edges()\n-                .iter().map(|i| (&dry_graph[i.source()], &dry_graph[i.target()], &i.weight))\n-                .collect::<Vec<_>>(),\n-                act_graph.raw_edges()\n-                .iter().map(|i| (&act_graph[i.source()], &act_graph[i.target()], &i.weight))\n-                .collect::<Vec<_>>());\n+            builder.execute_cli();\n         } else {\n             let builder = builder::Builder::new(&self);\n             let _ = builder.execute_cli();"}]}