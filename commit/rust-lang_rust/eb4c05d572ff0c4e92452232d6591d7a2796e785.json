{"sha": "eb4c05d572ff0c4e92452232d6591d7a2796e785", "node_id": "MDY6Q29tbWl0NzI0NzEyOmViNGMwNWQ1NzJmZjBjNGU5MjQ1MjIzMmQ2NTkxZDdhMjc5NmU3ODU=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-02-11T08:54:09Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-02-11T08:54:09Z"}, "message": "G: reference types", "tree": {"sha": "371136f9c2ad04ff1fca3db94e73872988395fa1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/371136f9c2ad04ff1fca3db94e73872988395fa1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/eb4c05d572ff0c4e92452232d6591d7a2796e785", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/eb4c05d572ff0c4e92452232d6591d7a2796e785", "html_url": "https://github.com/rust-lang/rust/commit/eb4c05d572ff0c4e92452232d6591d7a2796e785", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/eb4c05d572ff0c4e92452232d6591d7a2796e785/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "555c4ae37560493fd901aad41951ad1664043459", "url": "https://api.github.com/repos/rust-lang/rust/commits/555c4ae37560493fd901aad41951ad1664043459", "html_url": "https://github.com/rust-lang/rust/commit/555c4ae37560493fd901aad41951ad1664043459"}], "stats": {"total": 71, "additions": 71, "deletions": 0}, "files": [{"sha": "0905c282a7718de4d0b94096f37680eecbf6bced", "filename": "grammar.ron", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/eb4c05d572ff0c4e92452232d6591d7a2796e785/grammar.ron", "raw_url": "https://github.com/rust-lang/rust/raw/eb4c05d572ff0c4e92452232d6591d7a2796e785/grammar.ron", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/grammar.ron?ref=eb4c05d572ff0c4e92452232d6591d7a2796e785", "patch": "@@ -108,6 +108,7 @@ Grammar(\n         \"POINTER_TYPE\",\n         \"ARRAY_TYPE\",\n         \"SLICE_TYPE\",\n+        \"REFERENCE_TYPE\",\n \n         \"EXTERN_BLOCK\",\n         \"ENUM_VARIANT\","}, {"sha": "003341db5f2b9399114079c31ca515e9d0e69df0", "filename": "src/parser/grammar/types.rs", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/eb4c05d572ff0c4e92452232d6591d7a2796e785/src%2Fparser%2Fgrammar%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eb4c05d572ff0c4e92452232d6591d7a2796e785/src%2Fparser%2Fgrammar%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fparser%2Fgrammar%2Ftypes.rs?ref=eb4c05d572ff0c4e92452232d6591d7a2796e785", "patch": "@@ -6,6 +6,7 @@ pub(super) fn type_(p: &mut Parser) {\n         EXCL => never_type(p),\n         STAR => pointer_type(p),\n         L_BRACK => array_or_slice_type(p),\n+        AMPERSAND => reference_type(p),\n         IDENT => path_type(p),\n         _ => {\n             p.error(\"expected type\");\n@@ -115,6 +116,20 @@ fn array_or_slice_type(p: &mut Parser) {\n     m.complete(p, kind);\n }\n \n+// test reference_type;\n+// type A = &();\n+// type B = &'static ();\n+// type C = &mut ();\n+fn reference_type(p: &mut Parser) {\n+    assert!(p.at(AMPERSAND));\n+    let m = p.start();\n+    p.bump();\n+    p.eat(LIFETIME);\n+    p.eat(MUT_KW);\n+    type_no_plus(p);\n+    m.complete(p, REFERENCE_TYPE);\n+}\n+\n fn path_type(p: &mut Parser) {\n     assert!(p.at(IDENT));\n     let m = p.start();"}, {"sha": "597550a3207f8d4fba4687e852e823456a47c256", "filename": "src/syntax_kinds.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/eb4c05d572ff0c4e92452232d6591d7a2796e785/src%2Fsyntax_kinds.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eb4c05d572ff0c4e92452232d6591d7a2796e785/src%2Fsyntax_kinds.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fsyntax_kinds.rs?ref=eb4c05d572ff0c4e92452232d6591d7a2796e785", "patch": "@@ -106,6 +106,7 @@ pub enum SyntaxKind {\n     POINTER_TYPE,\n     ARRAY_TYPE,\n     SLICE_TYPE,\n+    REFERENCE_TYPE,\n     EXTERN_BLOCK,\n     ENUM_VARIANT,\n     NAMED_FIELD,\n@@ -238,6 +239,7 @@ impl SyntaxKind {\n             POINTER_TYPE => &SyntaxInfo { name: \"POINTER_TYPE\" },\n             ARRAY_TYPE => &SyntaxInfo { name: \"ARRAY_TYPE\" },\n             SLICE_TYPE => &SyntaxInfo { name: \"SLICE_TYPE\" },\n+            REFERENCE_TYPE => &SyntaxInfo { name: \"REFERENCE_TYPE\" },\n             EXTERN_BLOCK => &SyntaxInfo { name: \"EXTERN_BLOCK\" },\n             ENUM_VARIANT => &SyntaxInfo { name: \"ENUM_VARIANT\" },\n             NAMED_FIELD => &SyntaxInfo { name: \"NAMED_FIELD\" },"}, {"sha": "3ac0badabc5a7079741892551866038bb309c380", "filename": "tests/data/parser/inline/0026_reference_type;.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/eb4c05d572ff0c4e92452232d6591d7a2796e785/tests%2Fdata%2Fparser%2Finline%2F0026_reference_type%3B.rs", "raw_url": "https://github.com/rust-lang/rust/raw/eb4c05d572ff0c4e92452232d6591d7a2796e785/tests%2Fdata%2Fparser%2Finline%2F0026_reference_type%3B.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Finline%2F0026_reference_type%3B.rs?ref=eb4c05d572ff0c4e92452232d6591d7a2796e785", "patch": "@@ -0,0 +1,3 @@\n+type A = &();\n+type B = &'static ();\n+type C = &mut ();"}, {"sha": "665c021e1a38157e5abed198350c4523ec10b6f1", "filename": "tests/data/parser/inline/0026_reference_type;.txt", "status": "added", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/rust-lang/rust/blob/eb4c05d572ff0c4e92452232d6591d7a2796e785/tests%2Fdata%2Fparser%2Finline%2F0026_reference_type%3B.txt", "raw_url": "https://github.com/rust-lang/rust/raw/eb4c05d572ff0c4e92452232d6591d7a2796e785/tests%2Fdata%2Fparser%2Finline%2F0026_reference_type%3B.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Finline%2F0026_reference_type%3B.txt?ref=eb4c05d572ff0c4e92452232d6591d7a2796e785", "patch": "@@ -0,0 +1,50 @@\n+FILE@[0; 54)\n+  TYPE_ITEM@[0; 14)\n+    TYPE_KW@[0; 4)\n+    NAME@[4; 7)\n+      WHITESPACE@[4; 5)\n+      IDENT@[5; 6) \"A\"\n+      WHITESPACE@[6; 7)\n+    EQ@[7; 8)\n+    REFERENCE_TYPE@[8; 12)\n+      WHITESPACE@[8; 9)\n+      AMPERSAND@[9; 10)\n+      TUPLE_TYPE@[10; 12)\n+        L_PAREN@[10; 11)\n+        R_PAREN@[11; 12)\n+    SEMI@[12; 13)\n+    WHITESPACE@[13; 14)\n+  TYPE_ITEM@[14; 36)\n+    TYPE_KW@[14; 18)\n+    NAME@[18; 21)\n+      WHITESPACE@[18; 19)\n+      IDENT@[19; 20) \"B\"\n+      WHITESPACE@[20; 21)\n+    EQ@[21; 22)\n+    REFERENCE_TYPE@[22; 34)\n+      WHITESPACE@[22; 23)\n+      AMPERSAND@[23; 24)\n+      LIFETIME@[24; 31) \"'static\"\n+      TUPLE_TYPE@[31; 34)\n+        WHITESPACE@[31; 32)\n+        L_PAREN@[32; 33)\n+        R_PAREN@[33; 34)\n+    SEMI@[34; 35)\n+    WHITESPACE@[35; 36)\n+  TYPE_ITEM@[36; 54)\n+    TYPE_KW@[36; 40)\n+    NAME@[40; 43)\n+      WHITESPACE@[40; 41)\n+      IDENT@[41; 42) \"C\"\n+      WHITESPACE@[42; 43)\n+    EQ@[43; 44)\n+    REFERENCE_TYPE@[44; 52)\n+      WHITESPACE@[44; 45)\n+      AMPERSAND@[45; 46)\n+      MUT_KW@[46; 49)\n+      TUPLE_TYPE@[49; 52)\n+        WHITESPACE@[49; 50)\n+        L_PAREN@[50; 51)\n+        R_PAREN@[51; 52)\n+    SEMI@[52; 53)\n+    WHITESPACE@[53; 54)"}]}