{"sha": "ce73df065f89bb5aa17517de16c10f9e4d3abaeb", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNlNzNkZjA2NWY4OWJiNWFhMTc1MTdkZTE2YzEwZjllNGQzYWJhZWI=", "commit": {"author": {"name": "Muhammad Mominul Huque", "email": "mominul2082@gmail.com", "date": "2018-10-15T17:52:11Z"}, "committer": {"name": "Muhammad Mominul Huque", "email": "mominul2082@gmail.com", "date": "2018-10-15T17:52:11Z"}, "message": "Use CARGO_MANIFEST_DIR for locating the grammar.ron file", "tree": {"sha": "c8afdd06e562f5cd0040b41f577a881887b5a26a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c8afdd06e562f5cd0040b41f577a881887b5a26a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ce73df065f89bb5aa17517de16c10f9e4d3abaeb", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEPNYzeVcwyOf+o1ZNnUcuizYJiVYFAlvE08sACgkQnUcuizYJ\niVYF+BAAuKd/DZ9nGLz237UysRUVOLlAF72Ll5msQVNR2VhUSKRPuE4P+Sqsog4i\nj5V6fRb3kL1Oz3WH3CQuYOimRNi4Zd9fPRNQXIF8PGASoFJnnLIWFt2TtvNGfWFt\niCsx/F6sUcpMOvssrcbUfWjSJ0B3kP7HzMwxcXALPUInx/5zhTPv7Nr7Mt0EwsCX\nDYlCTgL9seT1NWBUNo2yjJADlY4rSwXhKDHXTe03zibvvDLQBOGEbzNobTUC1zGX\nJ5gPLKDsLEl8i8eVvPW46tBrGpyak7eEEzBn3Rg3w5BCc6j+JjJYeW+jERBliwUR\nTBd8ztB4CTeHT9SI9IwZ9sljVAASbDrLsqNaWkbfPwUoozgHUNA87pGieDk9epUV\nCHzb4S31EEbcoFkwAopI5XFtImMhRgIOf2AtSOVcCM65DClh3wZlwh4ctxSqlMYS\nms1pDZzZTCezfG68982wBj/KZp7Ev85RbCwp0x3sC2W8Exq54HIhljEbrkhPoZMw\nvYH11m7guJSZ3/7F47IG2KVremU6xcQ03KYF55snrL1aAItU91t3BIg6pCo1K8ca\neDwWOjnFDmsZCQ+45t+1x5CXX6hJ0OlgGw4U7DxlExwhJ5ASCba5jJJOe4ndS7QL\nHs+HLJF88SRUip8c02NMx/QokVyWl7QZpmY4wrOTa3/mQ7aC554=\n=MuK0\n-----END PGP SIGNATURE-----", "payload": "tree c8afdd06e562f5cd0040b41f577a881887b5a26a\nparent 33b378797c33bf29af4104e0b11c31252451df0c\nauthor Muhammad Mominul Huque <mominul2082@gmail.com> 1539625931 +0600\ncommitter Muhammad Mominul Huque <mominul2082@gmail.com> 1539625931 +0600\n\nUse CARGO_MANIFEST_DIR for locating the grammar.ron file\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ce73df065f89bb5aa17517de16c10f9e4d3abaeb", "html_url": "https://github.com/rust-lang/rust/commit/ce73df065f89bb5aa17517de16c10f9e4d3abaeb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ce73df065f89bb5aa17517de16c10f9e4d3abaeb/comments", "author": {"login": "mominul", "id": 9459891, "node_id": "MDQ6VXNlcjk0NTk4OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/9459891?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mominul", "html_url": "https://github.com/mominul", "followers_url": "https://api.github.com/users/mominul/followers", "following_url": "https://api.github.com/users/mominul/following{/other_user}", "gists_url": "https://api.github.com/users/mominul/gists{/gist_id}", "starred_url": "https://api.github.com/users/mominul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mominul/subscriptions", "organizations_url": "https://api.github.com/users/mominul/orgs", "repos_url": "https://api.github.com/users/mominul/repos", "events_url": "https://api.github.com/users/mominul/events{/privacy}", "received_events_url": "https://api.github.com/users/mominul/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mominul", "id": 9459891, "node_id": "MDQ6VXNlcjk0NTk4OTE=", "avatar_url": "https://avatars.githubusercontent.com/u/9459891?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mominul", "html_url": "https://github.com/mominul", "followers_url": "https://api.github.com/users/mominul/followers", "following_url": "https://api.github.com/users/mominul/following{/other_user}", "gists_url": "https://api.github.com/users/mominul/gists{/gist_id}", "starred_url": "https://api.github.com/users/mominul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mominul/subscriptions", "organizations_url": "https://api.github.com/users/mominul/orgs", "repos_url": "https://api.github.com/users/mominul/repos", "events_url": "https://api.github.com/users/mominul/events{/privacy}", "received_events_url": "https://api.github.com/users/mominul/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "33b378797c33bf29af4104e0b11c31252451df0c", "url": "https://api.github.com/repos/rust-lang/rust/commits/33b378797c33bf29af4104e0b11c31252451df0c", "html_url": "https://github.com/rust-lang/rust/commit/33b378797c33bf29af4104e0b11c31252451df0c"}], "stats": {"total": 15, "additions": 7, "deletions": 8}, "files": [{"sha": "ba7d10caa52c6d2c6b35fbc6dc2aa94c506d0c06", "filename": "crates/tools/src/lib.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ce73df065f89bb5aa17517de16c10f9e4d3abaeb/crates%2Ftools%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ce73df065f89bb5aa17517de16c10f9e4d3abaeb/crates%2Ftools%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Ftools%2Fsrc%2Flib.rs?ref=ce73df065f89bb5aa17517de16c10f9e4d3abaeb", "patch": "@@ -71,9 +71,9 @@ pub fn update(path: &Path, contents: &str, verify: bool) -> Result<()> {\n     Ok(())\n }\n \n-pub fn render_template(template: &str, grammarfile: &str) -> Result<String> {\n+pub fn render_template(template: &str) -> Result<String> {\n     let grammar: ron::value::Value = {\n-        let text = fs::read_to_string(grammarfile)?;\n+        let text = fs::read_to_string(format!(\"{}{}\", Path::new(&std::env::var(\"CARGO_MANIFEST_DIR\").unwrap()).parent().unwrap().to_str().unwrap(), \"/ra_syntax/src/grammar.ron\"))?;\n         ron::de::from_str(&text)?\n     };\n     let template = fs::read_to_string(template)?;"}, {"sha": "aa6d964e62776236777ab84bf7f6f315688146d3", "filename": "crates/tools/src/main.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ce73df065f89bb5aa17517de16c10f9e4d3abaeb/crates%2Ftools%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ce73df065f89bb5aa17517de16c10f9e4d3abaeb/crates%2Ftools%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Ftools%2Fsrc%2Fmain.rs?ref=ce73df065f89bb5aa17517de16c10f9e4d3abaeb", "patch": "@@ -45,8 +45,8 @@ fn main() -> Result<()> {\n fn run_gen_command(name: &str, verify: bool) -> Result<()> {\n     match name {\n         \"gen-kinds\" => {\n-            update(Path::new(SYNTAX_KINDS), &render_template(SYNTAX_KINDS_TEMPLATE, GRAMMAR)?, verify)?;\n-            update(Path::new(AST), &render_template(AST_TEMPLATE, GRAMMAR)?, verify)?;\n+            update(Path::new(SYNTAX_KINDS), &render_template(SYNTAX_KINDS_TEMPLATE)?, verify)?;\n+            update(Path::new(AST), &render_template(AST_TEMPLATE)?, verify)?;\n         },\n         \"gen-tests\" => {\n             gen_tests(verify)?"}, {"sha": "9ff1eecd9d71c8e0336b0cd0c89d913cb97bbf54", "filename": "crates/tools/tests/cli.rs", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/ce73df065f89bb5aa17517de16c10f9e4d3abaeb/crates%2Ftools%2Ftests%2Fcli.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ce73df065f89bb5aa17517de16c10f9e4d3abaeb/crates%2Ftools%2Ftests%2Fcli.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Ftools%2Ftests%2Fcli.rs?ref=ce73df065f89bb5aa17517de16c10f9e4d3abaeb", "patch": "@@ -3,18 +3,17 @@ extern crate tools;\n use std::path::Path;\n use tools::{render_template, update};\n \n-const GRAMMAR: &str = \"../ra_syntax/src/grammar.ron\";\n const SYNTAX_KINDS: &str = \"../ra_syntax/src/syntax_kinds/generated.rs\";\n const SYNTAX_KINDS_TEMPLATE: &str = \"../ra_syntax/src/syntax_kinds/generated.rs.tera\";\n const AST: &str = \"../ra_syntax/src/ast/generated.rs\";\n const AST_TEMPLATE: &str = \"../ra_syntax/src/ast/generated.rs.tera\";\n \n #[test]\n fn verify_template_generation() {\n-    if let Err(error) = update(Path::new(SYNTAX_KINDS), &render_template(SYNTAX_KINDS_TEMPLATE, GRAMMAR).unwrap(), true) {\n+    if let Err(error) = update(Path::new(SYNTAX_KINDS), &render_template(SYNTAX_KINDS_TEMPLATE).unwrap(), true) {\n         panic!(\"{}. Please update it by running `cargo gen-kinds`\", error);\n     }\n-    if let Err(error) = update(Path::new(AST), &render_template(AST_TEMPLATE, GRAMMAR).unwrap(), true) {\n+    if let Err(error) = update(Path::new(AST), &render_template(AST_TEMPLATE).unwrap(), true) {\n         panic!(\"{}. Please update it by running `cargo gen-kinds`\", error);\n     }\n-}\n\\ No newline at end of file\n+}"}]}