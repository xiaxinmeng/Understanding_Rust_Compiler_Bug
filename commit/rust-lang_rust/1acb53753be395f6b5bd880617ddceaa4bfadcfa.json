{"sha": "1acb53753be395f6b5bd880617ddceaa4bfadcfa", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFhY2I1Mzc1M2JlMzk1ZjZiNWJkODgwNjE3ZGRjZWFhNGJmYWRjZmE=", "commit": {"author": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2019-08-22T17:38:09Z"}, "committer": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2019-08-22T20:37:35Z"}, "message": "Do not suggest `.try_into()` on `i32::from(x)`", "tree": {"sha": "7e67c158a172a877e045ffb69a310f57360c634f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7e67c158a172a877e045ffb69a310f57360c634f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1acb53753be395f6b5bd880617ddceaa4bfadcfa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1acb53753be395f6b5bd880617ddceaa4bfadcfa", "html_url": "https://github.com/rust-lang/rust/commit/1acb53753be395f6b5bd880617ddceaa4bfadcfa", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1acb53753be395f6b5bd880617ddceaa4bfadcfa/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7b0085a613e69cb69fc9e4eb5d422fa4a39d5de1", "url": "https://api.github.com/repos/rust-lang/rust/commits/7b0085a613e69cb69fc9e4eb5d422fa4a39d5de1", "html_url": "https://github.com/rust-lang/rust/commit/7b0085a613e69cb69fc9e4eb5d422fa4a39d5de1"}], "stats": {"total": 36, "additions": 36, "deletions": 0}, "files": [{"sha": "0efc433341c1fa343586fb534a94de497b749845", "filename": "src/librustc_typeck/check/demand.rs", "status": "modified", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/1acb53753be395f6b5bd880617ddceaa4bfadcfa/src%2Flibrustc_typeck%2Fcheck%2Fdemand.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1acb53753be395f6b5bd880617ddceaa4bfadcfa/src%2Flibrustc_typeck%2Fcheck%2Fdemand.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fdemand.rs?ref=1acb53753be395f6b5bd880617ddceaa4bfadcfa", "patch": "@@ -587,6 +587,30 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n                 return false;\n             }\n         }\n+        if let hir::ExprKind::Call(path, args) = &expr.node {\n+            if let (\n+                hir::ExprKind::Path(hir::QPath::TypeRelative(base_ty, path_segment)),\n+                1,\n+            ) = (&path.node, args.len()) {\n+                // `expr` is a conversion like `u32::from(val)`, do not suggest anything (#63697).\n+                if let (\n+                    hir::TyKind::Path(hir::QPath::Resolved(None, base_ty_path)),\n+                    sym::from,\n+                ) = (&base_ty.node, path_segment.ident.name) {\n+                    if let Some(ident) = &base_ty_path.segments.iter().map(|s| s.ident).next() {\n+                        match ident.name {\n+                            sym::i128 | sym::i64 | sym::i32 | sym::i16 | sym::i8 |\n+                            sym::u128 | sym::u64 | sym::u32 | sym::u16 | sym::u8 |\n+                            sym::isize | sym::usize\n+                            if base_ty_path.segments.len() == 1 => {\n+                                return false;\n+                            }\n+                            _ => {}\n+                        }\n+                    }\n+                }\n+            }\n+        }\n \n         let msg = format!(\"you can convert an `{}` to `{}`\", checked_ty, expected_ty);\n         let cast_msg = format!(\"you can cast an `{} to `{}`\", checked_ty, expected_ty);"}, {"sha": "56549da9c7358b694ad351d442b97ab0de665003", "filename": "src/test/ui/suggestions/mismatched-types-numeric-from.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/1acb53753be395f6b5bd880617ddceaa4bfadcfa/src%2Ftest%2Fui%2Fsuggestions%2Fmismatched-types-numeric-from.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1acb53753be395f6b5bd880617ddceaa4bfadcfa/src%2Ftest%2Fui%2Fsuggestions%2Fmismatched-types-numeric-from.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsuggestions%2Fmismatched-types-numeric-from.rs?ref=1acb53753be395f6b5bd880617ddceaa4bfadcfa", "patch": "@@ -0,0 +1,3 @@\n+fn main() {\n+    let _: u32 = i32::from(0_u8); //~ ERROR mismatched types\n+}"}, {"sha": "223b6747322c14bf061bba5e510a31881b2499d1", "filename": "src/test/ui/suggestions/mismatched-types-numeric-from.stderr", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/1acb53753be395f6b5bd880617ddceaa4bfadcfa/src%2Ftest%2Fui%2Fsuggestions%2Fmismatched-types-numeric-from.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/1acb53753be395f6b5bd880617ddceaa4bfadcfa/src%2Ftest%2Fui%2Fsuggestions%2Fmismatched-types-numeric-from.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fsuggestions%2Fmismatched-types-numeric-from.stderr?ref=1acb53753be395f6b5bd880617ddceaa4bfadcfa", "patch": "@@ -0,0 +1,9 @@\n+error[E0308]: mismatched types\n+  --> $DIR/mismatched-types-numeric-from.rs:2:18\n+   |\n+LL |     let _: u32 = i32::from(0_u8);\n+   |                  ^^^^^^^^^^^^^^^ expected u32, found i32\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0308`."}]}