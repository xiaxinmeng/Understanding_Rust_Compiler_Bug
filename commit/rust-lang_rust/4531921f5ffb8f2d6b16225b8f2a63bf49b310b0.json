{"sha": "4531921f5ffb8f2d6b16225b8f2a63bf49b310b0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ1MzE5MjFmNWZmYjhmMmQ2YjE2MjI1YjhmMmE2M2JmNDliMzEwYjA=", "commit": {"author": {"name": "Seiichi Uchida", "email": "seuchida@gmail.com", "date": "2018-02-17T07:14:05Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-02-17T07:14:05Z"}, "message": "Merge pull request #2454 from radix/issue-2446\n\nDon't generate V: { f: u8, // comment }", "tree": {"sha": "ce959002140a65e3537bcabbf857d1580cb7180a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ce959002140a65e3537bcabbf857d1580cb7180a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4531921f5ffb8f2d6b16225b8f2a63bf49b310b0", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJah9Y9CRBK7hj4Ov3rIwAAdHIIAJaDCSuCPzPJEIhCL/eb9oMs\nvnQRtrXkVmIDD2fFLRC5NoQ0IjysC7D6tzAscG0DCJEdhEt1bFZFL5LeLDXlmF3/\nHiQ87I9Jcm2VI8nMv/1G9TL4JFyoPUrjhw4vb2DRkNJkFaEhtQIWrZTRax2HD1wk\nUP0N12mBwXpYI027qBYmPCW/IzMN7NSmkrNsnKiNbveXic9ODpgwBl6syScpBIiH\nD1oxXfwhyYL3+PP+HxXpBOlOSoNK79Od1EUkx7kxrXQJfekPwLaVmPzVpol7mLIe\nI5n/R7J+OnzfYSldas0lQjgr4fuXMEjfezsYnf37tcwvBKrv+Tm+UHY0HjnEtHE=\n=A2vW\n-----END PGP SIGNATURE-----\n", "payload": "tree ce959002140a65e3537bcabbf857d1580cb7180a\nparent bdf562921dd4ad77d00de6ab29f5f3516f641994\nparent bd0facd4ce1701cb293d31078bf39df055a67363\nauthor Seiichi Uchida <seuchida@gmail.com> 1518851645 +0900\ncommitter GitHub <noreply@github.com> 1518851645 +0900\n\nMerge pull request #2454 from radix/issue-2446\n\nDon't generate V: { f: u8, // comment }"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4531921f5ffb8f2d6b16225b8f2a63bf49b310b0", "html_url": "https://github.com/rust-lang/rust/commit/4531921f5ffb8f2d6b16225b8f2a63bf49b310b0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4531921f5ffb8f2d6b16225b8f2a63bf49b310b0/comments", "author": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bdf562921dd4ad77d00de6ab29f5f3516f641994", "url": "https://api.github.com/repos/rust-lang/rust/commits/bdf562921dd4ad77d00de6ab29f5f3516f641994", "html_url": "https://github.com/rust-lang/rust/commit/bdf562921dd4ad77d00de6ab29f5f3516f641994"}, {"sha": "bd0facd4ce1701cb293d31078bf39df055a67363", "url": "https://api.github.com/repos/rust-lang/rust/commits/bd0facd4ce1701cb293d31078bf39df055a67363", "html_url": "https://github.com/rust-lang/rust/commit/bd0facd4ce1701cb293d31078bf39df055a67363"}], "stats": {"total": 24, "additions": 23, "deletions": 1}, "files": [{"sha": "11568278e1d5921f02ecfe61cecfdf3d4566fd1d", "filename": "rustfmt-core/src/items.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4531921f5ffb8f2d6b16225b8f2a63bf49b310b0/rustfmt-core%2Fsrc%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4531921f5ffb8f2d6b16225b8f2a63bf49b310b0/rustfmt-core%2Fsrc%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/rustfmt-core%2Fsrc%2Fitems.rs?ref=4531921f5ffb8f2d6b16225b8f2a63bf49b310b0", "patch": "@@ -1203,7 +1203,9 @@ pub fn format_struct_struct(\n         one_line_budget,\n     )?;\n \n-    if !items_str.contains('\\n') && !result.contains('\\n') && items_str.len() <= one_line_budget {\n+    if !items_str.contains('\\n') && !result.contains('\\n') && items_str.len() <= one_line_budget\n+        && !last_line_contains_single_line_comment(&items_str)\n+    {\n         Some(format!(\"{} {} }}\", result, items_str))\n     } else {\n         Some(format!("}, {"sha": "ad649d95c54943b4e145f88e9737b66ee41d3afe", "filename": "rustfmt-core/tests/source/issue-2446.rs", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/4531921f5ffb8f2d6b16225b8f2a63bf49b310b0/rustfmt-core%2Ftests%2Fsource%2Fissue-2446.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4531921f5ffb8f2d6b16225b8f2a63bf49b310b0/rustfmt-core%2Ftests%2Fsource%2Fissue-2446.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/rustfmt-core%2Ftests%2Fsource%2Fissue-2446.rs?ref=4531921f5ffb8f2d6b16225b8f2a63bf49b310b0", "patch": "@@ -0,0 +1,11 @@\n+enum Issue2446 {\n+    V {\n+        f: u8, // x\n+    },\n+}\n+\n+enum Issue2446TrailingCommentsOnly {\n+    V {\n+        f: u8, /* */\n+    }\n+}"}, {"sha": "be62e9c9c31113bbb1d8bb1b69c5872fdf84b587", "filename": "rustfmt-core/tests/target/issue-2446.rs", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/4531921f5ffb8f2d6b16225b8f2a63bf49b310b0/rustfmt-core%2Ftests%2Ftarget%2Fissue-2446.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4531921f5ffb8f2d6b16225b8f2a63bf49b310b0/rustfmt-core%2Ftests%2Ftarget%2Fissue-2446.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/rustfmt-core%2Ftests%2Ftarget%2Fissue-2446.rs?ref=4531921f5ffb8f2d6b16225b8f2a63bf49b310b0", "patch": "@@ -0,0 +1,9 @@\n+enum Issue2446 {\n+    V {\n+        f: u8, // x\n+    },\n+}\n+\n+enum Issue2446TrailingCommentsOnly {\n+    V { f: u8 /* */ },\n+}"}]}