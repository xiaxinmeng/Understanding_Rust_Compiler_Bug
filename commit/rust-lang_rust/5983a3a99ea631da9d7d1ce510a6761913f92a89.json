{"sha": "5983a3a99ea631da9d7d1ce510a6761913f92a89", "node_id": "C_kwDOAAsO6NoAKDU5ODNhM2E5OWVhNjMxZGE5ZDdkMWNlNTEwYTY3NjE5MTNmOTJhODk", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2023-03-01T03:11:44Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2023-03-01T03:11:44Z"}, "message": "Auto merge of #108586 - matthiaskrgr:rollup-ry9u2ou, r=matthiaskrgr\n\nRollup of 8 pull requests\n\nSuccessful merges:\n\n - #108297 (Exit when there are unmatched delims to avoid noisy diagnostics)\n - #108531 (rustdoc: Show that repeated expression arrays can be made with constant values)\n - #108536 (Update books)\n - #108550 (Remove the `capture_disjoint_fields` feature)\n - #108551 (Descriptive error when users try to combine RPITIT/AFIT with specialization)\n - #108554 (Only look for param in item's generics if it actually comes from generics)\n - #108555 (Fix a race in the query system)\n - #108558 (add missing feature in core/tests)\n\nFailed merges:\n\nr? `@ghost`\n`@rustbot` modify labels: rollup", "tree": {"sha": "98c1d9ec880ed1e96e974171f58dfa319c8ca935", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/98c1d9ec880ed1e96e974171f58dfa319c8ca935"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5983a3a99ea631da9d7d1ce510a6761913f92a89", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5983a3a99ea631da9d7d1ce510a6761913f92a89", "html_url": "https://github.com/rust-lang/rust/commit/5983a3a99ea631da9d7d1ce510a6761913f92a89", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5983a3a99ea631da9d7d1ce510a6761913f92a89/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ca1bc7f1f6487991dd6b504d1fddbc982e6b779c", "url": "https://api.github.com/repos/rust-lang/rust/commits/ca1bc7f1f6487991dd6b504d1fddbc982e6b779c", "html_url": "https://github.com/rust-lang/rust/commit/ca1bc7f1f6487991dd6b504d1fddbc982e6b779c"}, {"sha": "3abc41a45ca2784c6c36b34c97302271eb48ed24", "url": "https://api.github.com/repos/rust-lang/rust/commits/3abc41a45ca2784c6c36b34c97302271eb48ed24", "html_url": "https://github.com/rust-lang/rust/commit/3abc41a45ca2784c6c36b34c97302271eb48ed24"}], "stats": {"total": 2287, "additions": 554, "deletions": 1733}, "files": [{"sha": "41295f2b7b661f54e8d0c13d85c624ace4a46de7", "filename": "compiler/rustc_ast_lowering/src/item.rs", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_ast_lowering%2Fsrc%2Fitem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_ast_lowering%2Fsrc%2Fitem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Fitem.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1339,13 +1339,19 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                 .map(|predicate| self.lower_where_predicate(predicate)),\n         );\n \n-        let mut params: SmallVec<[hir::GenericParam<'hir>; 4]> =\n-            self.lower_generic_params_mut(&generics.params).collect();\n+        let mut params: SmallVec<[hir::GenericParam<'hir>; 4]> = self\n+            .lower_generic_params_mut(&generics.params, hir::GenericParamSource::Generics)\n+            .collect();\n \n         // Introduce extra lifetimes if late resolution tells us to.\n         let extra_lifetimes = self.resolver.take_extra_lifetime_params(parent_node_id);\n         params.extend(extra_lifetimes.into_iter().filter_map(|(ident, node_id, res)| {\n-            self.lifetime_res_to_generic_param(ident, node_id, res)\n+            self.lifetime_res_to_generic_param(\n+                ident,\n+                node_id,\n+                res,\n+                hir::GenericParamSource::Generics,\n+            )\n         }));\n \n         let has_where_clause_predicates = !generics.where_clause.predicates.is_empty();\n@@ -1449,7 +1455,8 @@ impl<'hir> LoweringContext<'_, 'hir> {\n                 span,\n             }) => hir::WherePredicate::BoundPredicate(hir::WhereBoundPredicate {\n                 hir_id: self.next_id(),\n-                bound_generic_params: self.lower_generic_params(bound_generic_params),\n+                bound_generic_params: self\n+                    .lower_generic_params(bound_generic_params, hir::GenericParamSource::Binder),\n                 bounded_ty: self\n                     .lower_ty(bounded_ty, &ImplTraitContext::Disallowed(ImplTraitPosition::Bound)),\n                 bounds: self.arena.alloc_from_iter(bounds.iter().map(|bound| {"}, {"sha": "5352a56b16588d6f554bd74ca89279cb19d7a251", "filename": "compiler/rustc_ast_lowering/src/lib.rs", "status": "modified", "additions": 30, "deletions": 9, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_ast_lowering%2Fsrc%2Flib.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -804,6 +804,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         ident: Ident,\n         node_id: NodeId,\n         res: LifetimeRes,\n+        source: hir::GenericParamSource,\n     ) -> Option<hir::GenericParam<'hir>> {\n         let (name, kind) = match res {\n             LifetimeRes::Param { .. } => {\n@@ -837,6 +838,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n             pure_wrt_drop: false,\n             kind: hir::GenericParamKind::Lifetime { kind },\n             colon_span: None,\n+            source,\n         })\n     }\n \n@@ -852,11 +854,13 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n         binder: NodeId,\n         generic_params: &[GenericParam],\n     ) -> &'hir [hir::GenericParam<'hir>] {\n-        let mut generic_params: Vec<_> = self.lower_generic_params_mut(generic_params).collect();\n+        let mut generic_params: Vec<_> = self\n+            .lower_generic_params_mut(generic_params, hir::GenericParamSource::Binder)\n+            .collect();\n         let extra_lifetimes = self.resolver.take_extra_lifetime_params(binder);\n         debug!(?extra_lifetimes);\n         generic_params.extend(extra_lifetimes.into_iter().filter_map(|(ident, node_id, res)| {\n-            self.lifetime_res_to_generic_param(ident, node_id, res)\n+            self.lifetime_res_to_generic_param(ident, node_id, res, hir::GenericParamSource::Binder)\n         }));\n         let generic_params = self.arena.alloc_from_iter(generic_params);\n         debug!(?generic_params);\n@@ -1375,8 +1379,12 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                             span,\n                         );\n                         let ident = Ident::from_str_and_span(&pprust::ty_to_string(t), span);\n-                        let (param, bounds, path) =\n-                            self.lower_generic_and_bounds(*def_node_id, span, ident, bounds);\n+                        let (param, bounds, path) = self.lower_universal_param_and_bounds(\n+                            *def_node_id,\n+                            span,\n+                            ident,\n+                            bounds,\n+                        );\n                         self.impl_trait_defs.push(param);\n                         if let Some(bounds) = bounds {\n                             self.impl_trait_bounds.push(bounds);\n@@ -1530,6 +1538,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                             pure_wrt_drop: false,\n                             kind: hir::GenericParamKind::Lifetime { kind },\n                             colon_span: None,\n+                            source: hir::GenericParamSource::Generics,\n                         }\n                     },\n                 ));\n@@ -1987,6 +1996,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n                             pure_wrt_drop: false,\n                             kind: hir::GenericParamKind::Lifetime { kind },\n                             colon_span: None,\n+                            source: hir::GenericParamSource::Generics,\n                         }\n                     },\n                 ));\n@@ -2152,16 +2162,25 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n     fn lower_generic_params_mut<'s>(\n         &'s mut self,\n         params: &'s [GenericParam],\n+        source: hir::GenericParamSource,\n     ) -> impl Iterator<Item = hir::GenericParam<'hir>> + Captures<'a> + Captures<'s> {\n-        params.iter().map(move |param| self.lower_generic_param(param))\n+        params.iter().map(move |param| self.lower_generic_param(param, source))\n     }\n \n-    fn lower_generic_params(&mut self, params: &[GenericParam]) -> &'hir [hir::GenericParam<'hir>] {\n-        self.arena.alloc_from_iter(self.lower_generic_params_mut(params))\n+    fn lower_generic_params(\n+        &mut self,\n+        params: &[GenericParam],\n+        source: hir::GenericParamSource,\n+    ) -> &'hir [hir::GenericParam<'hir>] {\n+        self.arena.alloc_from_iter(self.lower_generic_params_mut(params, source))\n     }\n \n     #[instrument(level = \"trace\", skip(self))]\n-    fn lower_generic_param(&mut self, param: &GenericParam) -> hir::GenericParam<'hir> {\n+    fn lower_generic_param(\n+        &mut self,\n+        param: &GenericParam,\n+        source: hir::GenericParamSource,\n+    ) -> hir::GenericParam<'hir> {\n         let (name, kind) = self.lower_generic_param_kind(param);\n \n         let hir_id = self.lower_node_id(param.id);\n@@ -2174,6 +2193,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n             pure_wrt_drop: self.tcx.sess.contains_name(&param.attrs, sym::may_dangle),\n             kind,\n             colon_span: param.colon_span.map(|s| self.lower_span(s)),\n+            source,\n         }\n     }\n \n@@ -2266,7 +2286,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n     }\n \n     #[instrument(level = \"debug\", skip(self), ret)]\n-    fn lower_generic_and_bounds(\n+    fn lower_universal_param_and_bounds(\n         &mut self,\n         node_id: NodeId,\n         span: Span,\n@@ -2286,6 +2306,7 @@ impl<'a, 'hir> LoweringContext<'a, 'hir> {\n             span,\n             kind: hir::GenericParamKind::Type { default: None, synthetic: true },\n             colon_span: None,\n+            source: hir::GenericParamSource::Generics,\n         };\n \n         let preds = self.lower_generic_bound_predicate("}, {"sha": "480d95b77e901f540c12fd1a560fdf1f342b8fe1", "filename": "compiler/rustc_expand/src/tests.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_expand%2Fsrc%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_expand%2Fsrc%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_expand%2Fsrc%2Ftests.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -43,7 +43,6 @@ pub(crate) fn string_to_stream(source_str: String) -> TokenStream {\n         ps.source_map().new_source_file(PathBuf::from(\"bogofile\").into(), source_str),\n         None,\n     )\n-    .0\n }\n \n /// Parses a string, returns a crate."}, {"sha": "adc06d9aa108afb59fafc20e0eb8aac2162c5183", "filename": "compiler/rustc_feature/src/active.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_feature%2Fsrc%2Factive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_feature%2Fsrc%2Factive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_feature%2Fsrc%2Factive.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -316,8 +316,6 @@ declare_features! (\n     (active, c_unwind, \"1.52.0\", Some(74990), None),\n     /// Allows using C-variadics.\n     (active, c_variadic, \"1.34.0\", Some(44930), None),\n-    /// Allows capturing disjoint fields in a closure/generator (RFC 2229).\n-    (incomplete, capture_disjoint_fields, \"1.49.0\", Some(53488), None),\n     /// Allows the use of `#[cfg(sanitize = \"option\")]`; set when -Zsanitizer is used.\n     (active, cfg_sanitize, \"1.41.0\", Some(39699), None),\n     /// Allows `cfg(target_abi = \"...\")`."}, {"sha": "04d4f6cb14e4ceb6ea6c06e2357d13a7520d0ef4", "filename": "compiler/rustc_feature/src/removed.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_feature%2Fsrc%2Fremoved.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_feature%2Fsrc%2Fremoved.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_feature%2Fsrc%2Fremoved.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -52,6 +52,8 @@ declare_features! (\n     (removed, allow_fail, \"1.19.0\", Some(46488), None, Some(\"removed due to no clear use cases\")),\n     (removed, await_macro, \"1.38.0\", Some(50547), None,\n      Some(\"subsumed by `.await` syntax\")),\n+    /// Allows capturing disjoint fields in a closure/generator (RFC 2229).\n+    (removed, capture_disjoint_fields, \"1.49.0\", Some(53488), None, Some(\"stabilized in Rust 2021\")),\n     /// Allows comparing raw pointers during const eval.\n     (removed, const_compare_raw_pointers, \"1.46.0\", Some(53020), None,\n      Some(\"cannot be allowed in const eval in any meaningful way\")),"}, {"sha": "19d3d41c9841c2a52ad26f798e286bdc25f6f73d", "filename": "compiler/rustc_hir/src/hir.rs", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_hir%2Fsrc%2Fhir.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_hir%2Fsrc%2Fhir.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir%2Fsrc%2Fhir.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -498,6 +498,7 @@ pub struct GenericParam<'hir> {\n     pub pure_wrt_drop: bool,\n     pub kind: GenericParamKind<'hir>,\n     pub colon_span: Option<Span>,\n+    pub source: GenericParamSource,\n }\n \n impl<'hir> GenericParam<'hir> {\n@@ -516,6 +517,20 @@ impl<'hir> GenericParam<'hir> {\n     }\n }\n \n+/// Records where the generic parameter originated from.\n+///\n+/// This can either be from an item's generics, in which case it's typically\n+/// early-bound (but can be a late-bound lifetime in functions, for example),\n+/// or from a `for<...>` binder, in which case it's late-bound (and notably,\n+/// does not show up in the parent item's generics).\n+#[derive(Debug, HashStable_Generic, PartialEq, Eq, Copy, Clone)]\n+pub enum GenericParamSource {\n+    // Early or late-bound parameters defined on an item\n+    Generics,\n+    // Late-bound parameters defined via a `for<...>`\n+    Binder,\n+}\n+\n #[derive(Default)]\n pub struct GenericParamCount {\n     pub lifetimes: usize,"}, {"sha": "848828175e2d8f22dffc95ac22fc9b55612f1e62", "filename": "compiler/rustc_hir_analysis/src/check/check.rs", "status": "modified", "additions": 36, "deletions": 4, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_hir_analysis%2Fsrc%2Fcheck%2Fcheck.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_hir_analysis%2Fsrc%2Fcheck%2Fcheck.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_analysis%2Fsrc%2Fcheck%2Fcheck.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -792,17 +792,19 @@ fn check_impl_items_against_trait<'tcx>(\n             trait_def.must_implement_one_of.as_deref();\n \n         for &trait_item_id in tcx.associated_item_def_ids(impl_trait_ref.def_id) {\n-            let is_implemented = ancestors\n-                .leaf_def(tcx, trait_item_id)\n+            let leaf_def = ancestors.leaf_def(tcx, trait_item_id);\n+\n+            let is_implemented = leaf_def\n+                .as_ref()\n                 .map_or(false, |node_item| node_item.item.defaultness(tcx).has_value());\n \n             if !is_implemented && tcx.impl_defaultness(impl_id).is_final() {\n                 missing_items.push(tcx.associated_item(trait_item_id));\n             }\n \n             // true if this item is specifically implemented in this impl\n-            let is_implemented_here = ancestors\n-                .leaf_def(tcx, trait_item_id)\n+            let is_implemented_here = leaf_def\n+                .as_ref()\n                 .map_or(false, |node_item| !node_item.defining_node.is_from_trait());\n \n             if !is_implemented_here {\n@@ -831,6 +833,36 @@ fn check_impl_items_against_trait<'tcx>(\n                     }\n                 }\n             }\n+\n+            if let Some(leaf_def) = &leaf_def\n+                && !leaf_def.is_final()\n+                && let def_id = leaf_def.item.def_id\n+                && tcx.impl_method_has_trait_impl_trait_tys(def_id)\n+            {\n+                let def_kind = tcx.def_kind(def_id);\n+                let descr = tcx.def_kind_descr(def_kind, def_id);\n+                let (msg, feature) = if tcx.asyncness(def_id).is_async() {\n+                    (\n+                        format!(\"async {descr} in trait cannot be specialized\"),\n+                        sym::async_fn_in_trait,\n+                    )\n+                } else {\n+                    (\n+                        format!(\n+                            \"{descr} with return-position `impl Trait` in trait cannot be specialized\"\n+                        ),\n+                        sym::return_position_impl_trait_in_trait,\n+                    )\n+                };\n+                tcx.sess\n+                    .struct_span_err(tcx.def_span(def_id), msg)\n+                    .note(format!(\n+                        \"specialization behaves in inconsistent and \\\n+                        surprising ways with `#![feature({feature})]`, \\\n+                        and for now is disallowed\"\n+                    ))\n+                    .emit();\n+            }\n         }\n \n         if !missing_items.is_empty() {"}, {"sha": "b14e65183aa3dadb7d45ffe8abd915cb68139bd1", "filename": "compiler/rustc_hir_analysis/src/collect/resolve_bound_vars.rs", "status": "modified", "additions": 45, "deletions": 36, "changes": 81, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_hir_analysis%2Fsrc%2Fcollect%2Fresolve_bound_vars.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_hir_analysis%2Fsrc%2Fcollect%2Fresolve_bound_vars.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_analysis%2Fsrc%2Fcollect%2Fresolve_bound_vars.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1034,45 +1034,53 @@ impl<'a, 'tcx> Visitor<'tcx> for BoundVarContext<'a, 'tcx> {\n fn object_lifetime_default(tcx: TyCtxt<'_>, param_def_id: DefId) -> ObjectLifetimeDefault {\n     debug_assert_eq!(tcx.def_kind(param_def_id), DefKind::TyParam);\n     let param_def_id = param_def_id.expect_local();\n-    let parent_def_id = tcx.local_parent(param_def_id);\n-    let generics = tcx.hir().get_generics(parent_def_id).unwrap();\n-    let param_hir_id = tcx.local_def_id_to_hir_id(param_def_id);\n-    let param = generics.params.iter().find(|p| p.hir_id == param_hir_id).unwrap();\n-\n-    // Scan the bounds and where-clauses on parameters to extract bounds\n-    // of the form `T:'a` so as to determine the `ObjectLifetimeDefault`\n-    // for each type parameter.\n-    match param.kind {\n-        GenericParamKind::Type { .. } => {\n-            let mut set = Set1::Empty;\n-\n-            // Look for `type: ...` where clauses.\n-            for bound in generics.bounds_for_param(param_def_id) {\n-                // Ignore `for<'a> type: ...` as they can change what\n-                // lifetimes mean (although we could \"just\" handle it).\n-                if !bound.bound_generic_params.is_empty() {\n-                    continue;\n-                }\n+    let hir::Node::GenericParam(param) = tcx.hir().get_by_def_id(param_def_id) else {\n+        bug!(\"expected GenericParam for object_lifetime_default\");\n+    };\n+    match param.source {\n+        hir::GenericParamSource::Generics => {\n+            let parent_def_id = tcx.local_parent(param_def_id);\n+            let generics = tcx.hir().get_generics(parent_def_id).unwrap();\n+            let param_hir_id = tcx.local_def_id_to_hir_id(param_def_id);\n+            let param = generics.params.iter().find(|p| p.hir_id == param_hir_id).unwrap();\n+\n+            // Scan the bounds and where-clauses on parameters to extract bounds\n+            // of the form `T:'a` so as to determine the `ObjectLifetimeDefault`\n+            // for each type parameter.\n+            match param.kind {\n+                GenericParamKind::Type { .. } => {\n+                    let mut set = Set1::Empty;\n+\n+                    // Look for `type: ...` where clauses.\n+                    for bound in generics.bounds_for_param(param_def_id) {\n+                        // Ignore `for<'a> type: ...` as they can change what\n+                        // lifetimes mean (although we could \"just\" handle it).\n+                        if !bound.bound_generic_params.is_empty() {\n+                            continue;\n+                        }\n \n-                for bound in bound.bounds {\n-                    if let hir::GenericBound::Outlives(lifetime) = bound {\n-                        set.insert(lifetime.res);\n+                        for bound in bound.bounds {\n+                            if let hir::GenericBound::Outlives(lifetime) = bound {\n+                                set.insert(lifetime.res);\n+                            }\n+                        }\n                     }\n-                }\n-            }\n \n-            match set {\n-                Set1::Empty => ObjectLifetimeDefault::Empty,\n-                Set1::One(hir::LifetimeName::Static) => ObjectLifetimeDefault::Static,\n-                Set1::One(hir::LifetimeName::Param(param_def_id)) => {\n-                    ObjectLifetimeDefault::Param(param_def_id.to_def_id())\n+                    match set {\n+                        Set1::Empty => ObjectLifetimeDefault::Empty,\n+                        Set1::One(hir::LifetimeName::Static) => ObjectLifetimeDefault::Static,\n+                        Set1::One(hir::LifetimeName::Param(param_def_id)) => {\n+                            ObjectLifetimeDefault::Param(param_def_id.to_def_id())\n+                        }\n+                        _ => ObjectLifetimeDefault::Ambiguous,\n+                    }\n+                }\n+                _ => {\n+                    bug!(\"object_lifetime_default_raw must only be called on a type parameter\")\n                 }\n-                _ => ObjectLifetimeDefault::Ambiguous,\n             }\n         }\n-        _ => {\n-            bug!(\"object_lifetime_default_raw must only be called on a type parameter\")\n-        }\n+        hir::GenericParamSource::Binder => ObjectLifetimeDefault::Empty,\n     }\n }\n \n@@ -1392,9 +1400,10 @@ impl<'a, 'tcx> BoundVarContext<'a, 'tcx> {\n             return;\n         }\n \n-        self.tcx\n-            .sess\n-            .delay_span_bug(self.tcx.hir().span(hir_id), \"could not resolve {param_def_id:?}\");\n+        self.tcx.sess.delay_span_bug(\n+            self.tcx.hir().span(hir_id),\n+            format!(\"could not resolve {param_def_id:?}\"),\n+        );\n     }\n \n     #[instrument(level = \"debug\", skip(self))]"}, {"sha": "e8bc50440e2343fcd4fac0f7a655f7b355da5233", "filename": "compiler/rustc_hir_typeck/src/upvar.rs", "status": "modified", "additions": 6, "deletions": 9, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_hir_typeck%2Fsrc%2Fupvar.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_hir_typeck%2Fsrc%2Fupvar.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_typeck%2Fsrc%2Fupvar.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -231,7 +231,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n \n         // We now fake capture information for all variables that are mentioned within the closure\n         // We do this after handling migrations so that min_captures computes before\n-        if !enable_precise_capture(self.tcx, span) {\n+        if !enable_precise_capture(span) {\n             let mut capture_information: InferredCaptureInformation<'tcx> = Default::default();\n \n             if let Some(upvars) = self.tcx.upvars_mentioned(closure_def_id) {\n@@ -265,7 +265,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n \n             // If we have an origin, store it.\n             if let Some(origin) = origin {\n-                let origin = if enable_precise_capture(self.tcx, span) {\n+                let origin = if enable_precise_capture(span) {\n                     (origin.0, origin.1)\n                 } else {\n                     (origin.0, Place { projections: vec![], ..origin.1 })\n@@ -1243,8 +1243,7 @@ impl<'a, 'tcx> FnCtxt<'a, 'tcx> {\n     ///\n     /// This will make more sense with an example:\n     ///\n-    /// ```rust\n-    /// #![feature(capture_disjoint_fields)]\n+    /// ```rust,edition2021\n     ///\n     /// struct FancyInteger(i32); // This implements Drop\n     ///\n@@ -2250,12 +2249,10 @@ fn truncate_capture_for_optimization(\n     (place, curr_mode)\n }\n \n-/// Precise capture is enabled if the feature gate `capture_disjoint_fields` is enabled or if\n-/// user is using Rust Edition 2021 or higher.\n-///\n+/// Precise capture is enabled if user is using Rust Edition 2021 or higher.\n /// `span` is the span of the closure.\n-fn enable_precise_capture(tcx: TyCtxt<'_>, span: Span) -> bool {\n+fn enable_precise_capture(span: Span) -> bool {\n     // We use span here to ensure that if the closure was generated by a macro with a different\n     // edition.\n-    tcx.features().capture_disjoint_fields || span.rust_2021()\n+    span.rust_2021()\n }"}, {"sha": "27490a09a36469ead8c52b643b164ee668e2a8cb", "filename": "compiler/rustc_metadata/src/rmeta/encoder.rs", "status": "modified", "additions": 1, "deletions": 29, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_metadata%2Fsrc%2Frmeta%2Fencoder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_metadata%2Fsrc%2Frmeta%2Fencoder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_metadata%2Fsrc%2Frmeta%2Fencoder.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1101,34 +1101,6 @@ fn should_encode_const(def_kind: DefKind) -> bool {\n     }\n }\n \n-fn should_encode_trait_impl_trait_tys(tcx: TyCtxt<'_>, def_id: DefId) -> bool {\n-    if tcx.def_kind(def_id) != DefKind::AssocFn {\n-        return false;\n-    }\n-\n-    let Some(item) = tcx.opt_associated_item(def_id) else { return false; };\n-    if item.container != ty::AssocItemContainer::ImplContainer {\n-        return false;\n-    }\n-\n-    let Some(trait_item_def_id) = item.trait_item_def_id else { return false; };\n-\n-    // FIXME(RPITIT): This does a somewhat manual walk through the signature\n-    // of the trait fn to look for any RPITITs, but that's kinda doing a lot\n-    // of work. We can probably remove this when we refactor RPITITs to be\n-    // associated types.\n-    tcx.fn_sig(trait_item_def_id).subst_identity().skip_binder().output().walk().any(|arg| {\n-        if let ty::GenericArgKind::Type(ty) = arg.unpack()\n-            && let ty::Alias(ty::Projection, data) = ty.kind()\n-            && tcx.def_kind(data.def_id) == DefKind::ImplTraitPlaceholder\n-        {\n-            true\n-        } else {\n-            false\n-        }\n-    })\n-}\n-\n // Return `false` to avoid encoding impl trait in trait, while we don't use the query.\n fn should_encode_fn_impl_trait_in_trait<'tcx>(_tcx: TyCtxt<'tcx>, _def_id: DefId) -> bool {\n     false\n@@ -1211,7 +1183,7 @@ impl<'a, 'tcx> EncodeContext<'a, 'tcx> {\n             if let DefKind::Enum | DefKind::Struct | DefKind::Union = def_kind {\n                 self.encode_info_for_adt(def_id);\n             }\n-            if should_encode_trait_impl_trait_tys(tcx, def_id)\n+            if tcx.impl_method_has_trait_impl_trait_tys(def_id)\n                 && let Ok(table) = self.tcx.collect_return_position_impl_trait_in_trait_tys(def_id)\n             {\n                 record!(self.tables.trait_impl_trait_tys[def_id] <- table);"}, {"sha": "5084bc9cec6c67555a7f3a7b9969788eebf62dc9", "filename": "compiler/rustc_middle/src/ty/mod.rs", "status": "modified", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_middle%2Fsrc%2Fty%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_middle%2Fsrc%2Fty%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fty%2Fmod.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -2541,6 +2541,34 @@ impl<'tcx> TyCtxt<'tcx> {\n         }\n         def_id\n     }\n+\n+    pub fn impl_method_has_trait_impl_trait_tys(self, def_id: DefId) -> bool {\n+        if self.def_kind(def_id) != DefKind::AssocFn {\n+            return false;\n+        }\n+\n+        let Some(item) = self.opt_associated_item(def_id) else { return false; };\n+        if item.container != ty::AssocItemContainer::ImplContainer {\n+            return false;\n+        }\n+\n+        let Some(trait_item_def_id) = item.trait_item_def_id else { return false; };\n+\n+        // FIXME(RPITIT): This does a somewhat manual walk through the signature\n+        // of the trait fn to look for any RPITITs, but that's kinda doing a lot\n+        // of work. We can probably remove this when we refactor RPITITs to be\n+        // associated types.\n+        self.fn_sig(trait_item_def_id).subst_identity().skip_binder().output().walk().any(|arg| {\n+            if let ty::GenericArgKind::Type(ty) = arg.unpack()\n+                && let ty::Alias(ty::Projection, data) = ty.kind()\n+                && self.def_kind(data.def_id) == DefKind::ImplTraitPlaceholder\n+            {\n+                true\n+            } else {\n+                false\n+            }\n+        })\n+    }\n }\n \n /// Yields the parent function's `LocalDefId` if `def_id` is an `impl Trait` definition."}, {"sha": "33200b80a572d82fa95b038376781eaa274d04db", "filename": "compiler/rustc_mir_build/src/build/expr/as_place.rs", "status": "modified", "additions": 5, "deletions": 6, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_mir_build%2Fsrc%2Fbuild%2Fexpr%2Fas_place.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_mir_build%2Fsrc%2Fbuild%2Fexpr%2Fas_place.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_mir_build%2Fsrc%2Fbuild%2Fexpr%2Fas_place.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -11,7 +11,7 @@ use rustc_middle::mir::AssertKind::BoundsCheck;\n use rustc_middle::mir::*;\n use rustc_middle::thir::*;\n use rustc_middle::ty::AdtDef;\n-use rustc_middle::ty::{self, CanonicalUserTypeAnnotation, Ty, TyCtxt, Variance};\n+use rustc_middle::ty::{self, CanonicalUserTypeAnnotation, Ty, Variance};\n use rustc_span::Span;\n use rustc_target::abi::VariantIdx;\n \n@@ -183,7 +183,7 @@ fn to_upvars_resolved_place_builder<'tcx>(\n             &projection,\n         ) else {\n         let closure_span = cx.tcx.def_span(closure_def_id);\n-        if !enable_precise_capture(cx.tcx, closure_span) {\n+        if !enable_precise_capture(closure_span) {\n             bug!(\n                 \"No associated capture found for {:?}[{:#?}] even though \\\n                     capture_disjoint_fields isn't enabled\",\n@@ -745,8 +745,7 @@ impl<'a, 'tcx> Builder<'a, 'tcx> {\n     }\n }\n \n-/// Precise capture is enabled if the feature gate `capture_disjoint_fields` is enabled or if\n-/// user is using Rust Edition 2021 or higher.\n-fn enable_precise_capture(tcx: TyCtxt<'_>, closure_span: Span) -> bool {\n-    tcx.features().capture_disjoint_fields || closure_span.rust_2021()\n+/// Precise capture is enabled if user is using Rust Edition 2021 or higher.\n+fn enable_precise_capture(closure_span: Span) -> bool {\n+    closure_span.rust_2021()\n }"}, {"sha": "27f4428d306cd47604dd8a30e35e7cf3022dd73a", "filename": "compiler/rustc_parse/src/lexer/diagnostics.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_parse%2Fsrc%2Flexer%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_parse%2Fsrc%2Flexer%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Flexer%2Fdiagnostics.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,4 +1,4 @@\n-use super::UnmatchedBrace;\n+use super::UnmatchedDelim;\n use rustc_ast::token::Delimiter;\n use rustc_errors::Diagnostic;\n use rustc_span::source_map::SourceMap;\n@@ -8,7 +8,7 @@ use rustc_span::Span;\n pub struct TokenTreeDiagInfo {\n     /// Stack of open delimiters and their spans. Used for error message.\n     pub open_braces: Vec<(Delimiter, Span)>,\n-    pub unmatched_braces: Vec<UnmatchedBrace>,\n+    pub unmatched_delims: Vec<UnmatchedDelim>,\n \n     /// Used only for error recovery when arriving to EOF with mismatched braces.\n     pub last_unclosed_found_span: Option<Span>,\n@@ -32,10 +32,10 @@ pub fn same_identation_level(sm: &SourceMap, open_sp: Span, close_sp: Span) -> b\n // it's more friendly compared to report `unmatched error` in later phase\n pub fn report_missing_open_delim(\n     err: &mut Diagnostic,\n-    unmatched_braces: &[UnmatchedBrace],\n+    unmatched_delims: &[UnmatchedDelim],\n ) -> bool {\n     let mut reported_missing_open = false;\n-    for unmatch_brace in unmatched_braces.iter() {\n+    for unmatch_brace in unmatched_delims.iter() {\n         if let Some(delim) = unmatch_brace.found_delim\n             && matches!(delim, Delimiter::Parenthesis | Delimiter::Bracket)\n         {\n@@ -60,7 +60,7 @@ pub fn report_suspicious_mismatch_block(\n     sm: &SourceMap,\n     delim: Delimiter,\n ) {\n-    if report_missing_open_delim(err, &diag_info.unmatched_braces) {\n+    if report_missing_open_delim(err, &diag_info.unmatched_delims) {\n         return;\n     }\n "}, {"sha": "9dbddee5a56f0ddc0c45831b8ab3ee881391ed30", "filename": "compiler/rustc_parse/src/lexer/mod.rs", "status": "modified", "additions": 27, "deletions": 4, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_parse%2Fsrc%2Flexer%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_parse%2Fsrc%2Flexer%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Flexer%2Fmod.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,10 +1,11 @@\n use crate::errors;\n use crate::lexer::unicode_chars::UNICODE_ARRAY;\n+use crate::make_unclosed_delims_error;\n use rustc_ast::ast::{self, AttrStyle};\n use rustc_ast::token::{self, CommentKind, Delimiter, Token, TokenKind};\n use rustc_ast::tokenstream::TokenStream;\n use rustc_ast::util::unicode::contains_text_flow_control_chars;\n-use rustc_errors::{error_code, Applicability, DiagnosticBuilder, PResult, StashKey};\n+use rustc_errors::{error_code, Applicability, Diagnostic, DiagnosticBuilder, StashKey};\n use rustc_lexer::unescape::{self, Mode};\n use rustc_lexer::Cursor;\n use rustc_lexer::{Base, DocStyle, RawStrError};\n@@ -31,7 +32,7 @@ use unescape_error_reporting::{emit_unescape_error, escaped_char};\n rustc_data_structures::static_assert_size!(rustc_lexer::Token, 12);\n \n #[derive(Clone, Debug)]\n-pub struct UnmatchedBrace {\n+pub struct UnmatchedDelim {\n     pub expected_delim: Delimiter,\n     pub found_delim: Option<Delimiter>,\n     pub found_span: Span,\n@@ -44,7 +45,7 @@ pub(crate) fn parse_token_trees<'a>(\n     mut src: &'a str,\n     mut start_pos: BytePos,\n     override_span: Option<Span>,\n-) -> (PResult<'a, TokenStream>, Vec<UnmatchedBrace>) {\n+) -> Result<TokenStream, Vec<Diagnostic>> {\n     // Skip `#!`, if present.\n     if let Some(shebang_len) = rustc_lexer::strip_shebang(src) {\n         src = &src[shebang_len..];\n@@ -61,7 +62,29 @@ pub(crate) fn parse_token_trees<'a>(\n         override_span,\n         nbsp_is_whitespace: false,\n     };\n-    tokentrees::TokenTreesReader::parse_all_token_trees(string_reader)\n+    let (token_trees, unmatched_delims) =\n+        tokentrees::TokenTreesReader::parse_all_token_trees(string_reader);\n+    match token_trees {\n+        Ok(stream) if unmatched_delims.is_empty() => Ok(stream),\n+        _ => {\n+            // Return error if there are unmatched delimiters or unclosng delimiters.\n+            // We emit delimiter mismatch errors first, then emit the unclosing delimiter mismatch\n+            // because the delimiter mismatch is more likely to be the root cause of error\n+\n+            let mut buffer = Vec::with_capacity(1);\n+            // Not using `emit_unclosed_delims` to use `db.buffer`\n+            for unmatched in unmatched_delims {\n+                if let Some(err) = make_unclosed_delims_error(unmatched, &sess) {\n+                    err.buffer(&mut buffer);\n+                }\n+            }\n+            if let Err(err) = token_trees {\n+                // Add unclosing delimiter error\n+                err.buffer(&mut buffer);\n+            }\n+            Err(buffer)\n+        }\n+    }\n }\n \n struct StringReader<'a> {"}, {"sha": "36fd1e37d651ebbd08388bb67f8d028bd7c5b630", "filename": "compiler/rustc_parse/src/lexer/tokentrees.rs", "status": "modified", "additions": 14, "deletions": 13, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_parse%2Fsrc%2Flexer%2Ftokentrees.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_parse%2Fsrc%2Flexer%2Ftokentrees.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Flexer%2Ftokentrees.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,7 +1,7 @@\n use super::diagnostics::report_suspicious_mismatch_block;\n use super::diagnostics::same_identation_level;\n use super::diagnostics::TokenTreeDiagInfo;\n-use super::{StringReader, UnmatchedBrace};\n+use super::{StringReader, UnmatchedDelim};\n use rustc_ast::token::{self, Delimiter, Token};\n use rustc_ast::tokenstream::{DelimSpan, Spacing, TokenStream, TokenTree};\n use rustc_ast_pretty::pprust::token_to_string;\n@@ -18,14 +18,14 @@ pub(super) struct TokenTreesReader<'a> {\n impl<'a> TokenTreesReader<'a> {\n     pub(super) fn parse_all_token_trees(\n         string_reader: StringReader<'a>,\n-    ) -> (PResult<'a, TokenStream>, Vec<UnmatchedBrace>) {\n+    ) -> (PResult<'a, TokenStream>, Vec<UnmatchedDelim>) {\n         let mut tt_reader = TokenTreesReader {\n             string_reader,\n             token: Token::dummy(),\n             diag_info: TokenTreeDiagInfo::default(),\n         };\n         let res = tt_reader.parse_token_trees(/* is_delimited */ false);\n-        (res, tt_reader.diag_info.unmatched_braces)\n+        (res, tt_reader.diag_info.unmatched_delims)\n     }\n \n     // Parse a stream of tokens into a list of `TokenTree`s.\n@@ -34,7 +34,7 @@ impl<'a> TokenTreesReader<'a> {\n         let mut buf = Vec::new();\n         loop {\n             match self.token.kind {\n-                token::OpenDelim(delim) => buf.push(self.parse_token_tree_open_delim(delim)),\n+                token::OpenDelim(delim) => buf.push(self.parse_token_tree_open_delim(delim)?),\n                 token::CloseDelim(delim) => {\n                     return if is_delimited {\n                         Ok(TokenStream::new(buf))\n@@ -43,10 +43,11 @@ impl<'a> TokenTreesReader<'a> {\n                     };\n                 }\n                 token::Eof => {\n-                    if is_delimited {\n-                        self.eof_err().emit();\n-                    }\n-                    return Ok(TokenStream::new(buf));\n+                    return if is_delimited {\n+                        Err(self.eof_err())\n+                    } else {\n+                        Ok(TokenStream::new(buf))\n+                    };\n                 }\n                 _ => {\n                     // Get the next normal token. This might require getting multiple adjacent\n@@ -78,7 +79,7 @@ impl<'a> TokenTreesReader<'a> {\n         let mut err = self.string_reader.sess.span_diagnostic.struct_span_err(self.token.span, msg);\n         for &(_, sp) in &self.diag_info.open_braces {\n             err.span_label(sp, \"unclosed delimiter\");\n-            self.diag_info.unmatched_braces.push(UnmatchedBrace {\n+            self.diag_info.unmatched_delims.push(UnmatchedDelim {\n                 expected_delim: Delimiter::Brace,\n                 found_delim: None,\n                 found_span: self.token.span,\n@@ -98,7 +99,7 @@ impl<'a> TokenTreesReader<'a> {\n         err\n     }\n \n-    fn parse_token_tree_open_delim(&mut self, open_delim: Delimiter) -> TokenTree {\n+    fn parse_token_tree_open_delim(&mut self, open_delim: Delimiter) -> PResult<'a, TokenTree> {\n         // The span for beginning of the delimited section\n         let pre_span = self.token.span;\n \n@@ -107,7 +108,7 @@ impl<'a> TokenTreesReader<'a> {\n         // Parse the token trees within the delimiters.\n         // We stop at any delimiter so we can try to recover if the user\n         // uses an incorrect delimiter.\n-        let tts = self.parse_token_trees(/* is_delimited */ true).unwrap();\n+        let tts = self.parse_token_trees(/* is_delimited */ true)?;\n \n         // Expand to cover the entire delimited token tree\n         let delim_span = DelimSpan::from_pair(pre_span, self.token.span);\n@@ -160,7 +161,7 @@ impl<'a> TokenTreesReader<'a> {\n                         }\n                     }\n                     let (tok, _) = self.diag_info.open_braces.pop().unwrap();\n-                    self.diag_info.unmatched_braces.push(UnmatchedBrace {\n+                    self.diag_info.unmatched_delims.push(UnmatchedDelim {\n                         expected_delim: tok,\n                         found_delim: Some(close_delim),\n                         found_span: self.token.span,\n@@ -190,7 +191,7 @@ impl<'a> TokenTreesReader<'a> {\n             _ => unreachable!(),\n         }\n \n-        TokenTree::Delimited(delim_span, open_delim, tts)\n+        Ok(TokenTree::Delimited(delim_span, open_delim, tts))\n     }\n \n     fn close_delim_err(&mut self, delim: Delimiter) -> PErr<'a> {"}, {"sha": "d1c3fd0cd0f8f7559e412a799bfe6e7bce2d2448", "filename": "compiler/rustc_parse/src/lib.rs", "status": "modified", "additions": 6, "deletions": 26, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_parse%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_parse%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Flib.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -30,7 +30,7 @@ pub const MACRO_ARGUMENTS: Option<&str> = Some(\"macro arguments\");\n \n #[macro_use]\n pub mod parser;\n-use parser::{emit_unclosed_delims, make_unclosed_delims_error, Parser};\n+use parser::{make_unclosed_delims_error, Parser};\n pub mod lexer;\n pub mod validate_attr;\n \n@@ -96,10 +96,7 @@ pub fn parse_stream_from_source_str(\n     sess: &ParseSess,\n     override_span: Option<Span>,\n ) -> TokenStream {\n-    let (stream, mut errors) =\n-        source_file_to_stream(sess, sess.source_map().new_source_file(name, source), override_span);\n-    emit_unclosed_delims(&mut errors, &sess);\n-    stream\n+    source_file_to_stream(sess, sess.source_map().new_source_file(name, source), override_span)\n }\n \n /// Creates a new parser from a source string.\n@@ -135,9 +132,8 @@ fn maybe_source_file_to_parser(\n     source_file: Lrc<SourceFile>,\n ) -> Result<Parser<'_>, Vec<Diagnostic>> {\n     let end_pos = source_file.end_pos;\n-    let (stream, unclosed_delims) = maybe_file_to_stream(sess, source_file, None)?;\n+    let stream = maybe_file_to_stream(sess, source_file, None)?;\n     let mut parser = stream_to_parser(sess, stream, None);\n-    parser.unclosed_delims = unclosed_delims;\n     if parser.token == token::Eof {\n         parser.token.span = Span::new(end_pos, end_pos, parser.token.span.ctxt(), None);\n     }\n@@ -182,7 +178,7 @@ pub fn source_file_to_stream(\n     sess: &ParseSess,\n     source_file: Lrc<SourceFile>,\n     override_span: Option<Span>,\n-) -> (TokenStream, Vec<lexer::UnmatchedBrace>) {\n+) -> TokenStream {\n     panictry_buffer!(&sess.span_diagnostic, maybe_file_to_stream(sess, source_file, override_span))\n }\n \n@@ -192,31 +188,15 @@ pub fn maybe_file_to_stream(\n     sess: &ParseSess,\n     source_file: Lrc<SourceFile>,\n     override_span: Option<Span>,\n-) -> Result<(TokenStream, Vec<lexer::UnmatchedBrace>), Vec<Diagnostic>> {\n+) -> Result<TokenStream, Vec<Diagnostic>> {\n     let src = source_file.src.as_ref().unwrap_or_else(|| {\n         sess.span_diagnostic.bug(&format!(\n             \"cannot lex `source_file` without source: {}\",\n             sess.source_map().filename_for_diagnostics(&source_file.name)\n         ));\n     });\n \n-    let (token_trees, unmatched_braces) =\n-        lexer::parse_token_trees(sess, src.as_str(), source_file.start_pos, override_span);\n-\n-    match token_trees {\n-        Ok(stream) => Ok((stream, unmatched_braces)),\n-        Err(err) => {\n-            let mut buffer = Vec::with_capacity(1);\n-            err.buffer(&mut buffer);\n-            // Not using `emit_unclosed_delims` to use `db.buffer`\n-            for unmatched in unmatched_braces {\n-                if let Some(err) = make_unclosed_delims_error(unmatched, &sess) {\n-                    err.buffer(&mut buffer);\n-                }\n-            }\n-            Err(buffer)\n-        }\n-    }\n+    lexer::parse_token_trees(sess, src.as_str(), source_file.start_pos, override_span)\n }\n \n /// Given a stream and the `ParseSess`, produces a parser."}, {"sha": "488f14699c31ee4b727cfd959045e21869b1bd3b", "filename": "compiler/rustc_parse/src/parser/diagnostics.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fdiagnostics.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -19,7 +19,7 @@ use crate::errors::{\n };\n \n use crate::fluent_generated as fluent;\n-use crate::lexer::UnmatchedBrace;\n+use crate::lexer::UnmatchedDelim;\n use crate::parser;\n use rustc_ast as ast;\n use rustc_ast::ptr::P;\n@@ -222,7 +222,7 @@ impl MultiSugg {\n /// is dropped.\n pub struct SnapshotParser<'a> {\n     parser: Parser<'a>,\n-    unclosed_delims: Vec<UnmatchedBrace>,\n+    unclosed_delims: Vec<UnmatchedDelim>,\n }\n \n impl<'a> Deref for SnapshotParser<'a> {\n@@ -264,7 +264,7 @@ impl<'a> Parser<'a> {\n         self.unclosed_delims.extend(snapshot.unclosed_delims);\n     }\n \n-    pub fn unclosed_delims(&self) -> &[UnmatchedBrace] {\n+    pub fn unclosed_delims(&self) -> &[UnmatchedDelim] {\n         &self.unclosed_delims\n     }\n "}, {"sha": "b1b79fe4e054b7703733899d58b3419bc02e9a64", "filename": "compiler/rustc_parse/src/parser/mod.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_parse%2Fsrc%2Fparser%2Fmod.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -10,7 +10,7 @@ mod path;\n mod stmt;\n mod ty;\n \n-use crate::lexer::UnmatchedBrace;\n+use crate::lexer::UnmatchedDelim;\n pub use attr_wrapper::AttrWrapper;\n pub use diagnostics::AttemptLocalParseRecovery;\n pub(crate) use item::FnParseMode;\n@@ -149,7 +149,7 @@ pub struct Parser<'a> {\n     /// A list of all unclosed delimiters found by the lexer. If an entry is used for error recovery\n     /// it gets removed from here. Every entry left at the end gets emitted as an independent\n     /// error.\n-    pub(super) unclosed_delims: Vec<UnmatchedBrace>,\n+    pub(super) unclosed_delims: Vec<UnmatchedDelim>,\n     last_unexpected_token_span: Option<Span>,\n     /// Span pointing at the `:` for the last type ascription the parser has seen, and whether it\n     /// looked like it could have been a mistyped path or literal `Option:Some(42)`).\n@@ -1521,11 +1521,11 @@ impl<'a> Parser<'a> {\n }\n \n pub(crate) fn make_unclosed_delims_error(\n-    unmatched: UnmatchedBrace,\n+    unmatched: UnmatchedDelim,\n     sess: &ParseSess,\n ) -> Option<DiagnosticBuilder<'_, ErrorGuaranteed>> {\n     // `None` here means an `Eof` was found. We already emit those errors elsewhere, we add them to\n-    // `unmatched_braces` only for error recovery in the `Parser`.\n+    // `unmatched_delims` only for error recovery in the `Parser`.\n     let found_delim = unmatched.found_delim?;\n     let mut spans = vec![unmatched.found_span];\n     if let Some(sp) = unmatched.unclosed_span {\n@@ -1542,7 +1542,7 @@ pub(crate) fn make_unclosed_delims_error(\n     Some(err)\n }\n \n-pub fn emit_unclosed_delims(unclosed_delims: &mut Vec<UnmatchedBrace>, sess: &ParseSess) {\n+pub fn emit_unclosed_delims(unclosed_delims: &mut Vec<UnmatchedDelim>, sess: &ParseSess) {\n     *sess.reached_eof.borrow_mut() |=\n         unclosed_delims.iter().any(|unmatched_delim| unmatched_delim.found_delim.is_none());\n     for unmatched in unclosed_delims.drain(..) {"}, {"sha": "5f003fa70e133b241911ac8b088cd33e4e6c7d3a", "filename": "compiler/rustc_query_system/src/query/plumbing.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_query_system%2Fsrc%2Fquery%2Fplumbing.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_query_system%2Fsrc%2Fquery%2Fplumbing.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_query_system%2Fsrc%2Fquery%2Fplumbing.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -25,7 +25,6 @@ use std::collections::hash_map::Entry;\n use std::fmt::Debug;\n use std::hash::Hash;\n use std::mem;\n-use std::ptr;\n use thin_vec::ThinVec;\n \n use super::QueryConfig;\n@@ -250,13 +249,16 @@ where\n     where\n         C: QueryCache<Key = K>,\n     {\n-        // We can move out of `self` here because we `mem::forget` it below\n-        let key = unsafe { ptr::read(&self.key) };\n+        let key = self.key;\n         let state = self.state;\n \n         // Forget ourself so our destructor won't poison the query\n         mem::forget(self);\n \n+        // Mark as complete before we remove the job from the active state\n+        // so no other thread can re-execute this query.\n+        cache.complete(key, result, dep_node_index);\n+\n         let job = {\n             #[cfg(parallel_compiler)]\n             let mut lock = state.active.get_shard_by_value(&key).lock();\n@@ -267,7 +269,6 @@ where\n                 QueryResult::Poisoned => panic!(),\n             }\n         };\n-        cache.complete(key, result, dep_node_index);\n \n         job.signal_complete();\n     }"}, {"sha": "013db2edb398d40c52c8a3ea1d5410d6247cd687", "filename": "compiler/rustc_trait_selection/src/traits/project.rs", "status": "modified", "additions": 4, "deletions": 20, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fproject.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fproject.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_trait_selection%2Fsrc%2Ftraits%2Fproject.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1307,25 +1307,8 @@ fn assemble_candidate_for_impl_trait_in_trait<'cx, 'tcx>(\n         let _ = selcx.infcx.commit_if_ok(|_| {\n             match selcx.select(&obligation.with(tcx, trait_predicate)) {\n                 Ok(Some(super::ImplSource::UserDefined(data))) => {\n-                    let Ok(leaf_def) = specialization_graph::assoc_def(tcx, data.impl_def_id, trait_fn_def_id) else {\n-                        return Err(());\n-                    };\n-                    // Only reveal a specializable default if we're past type-checking\n-                    // and the obligation is monomorphic, otherwise passes such as\n-                    // transmute checking and polymorphic MIR optimizations could\n-                    // get a result which isn't correct for all monomorphizations.\n-                    if leaf_def.is_final()\n-                        || (obligation.param_env.reveal() == Reveal::All\n-                            && !selcx\n-                                .infcx\n-                                .resolve_vars_if_possible(obligation.predicate.trait_ref(tcx))\n-                                .still_further_specializable())\n-                    {\n-                        candidate_set.push_candidate(ProjectionCandidate::ImplTraitInTrait(data));\n-                        Ok(())\n-                    } else {\n-                        Err(())\n-                    }\n+                    candidate_set.push_candidate(ProjectionCandidate::ImplTraitInTrait(data));\n+                    Ok(())\n                 }\n                 Ok(None) => {\n                     candidate_set.mark_ambiguous();\n@@ -2216,7 +2199,8 @@ fn confirm_impl_trait_in_trait_candidate<'tcx>(\n         Ok(assoc_ty) => assoc_ty,\n         Err(guar) => return Progress::error(tcx, guar),\n     };\n-    if !leaf_def.item.defaultness(tcx).has_value() {\n+    // We don't support specialization for RPITITs anyways... yet.\n+    if !leaf_def.is_final() {\n         return Progress { term: tcx.ty_error_misc().into(), obligations };\n     }\n "}, {"sha": "6f78811a186c7ec6b6d3bb537407a860a66d8211", "filename": "library/core/src/primitive_docs.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/library%2Fcore%2Fsrc%2Fprimitive_docs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/library%2Fcore%2Fsrc%2Fprimitive_docs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Fsrc%2Fprimitive_docs.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -587,8 +587,10 @@ mod prim_pointer {}\n /// There are two syntactic forms for creating an array:\n ///\n /// * A list with each element, i.e., `[x, y, z]`.\n-/// * A repeat expression `[x; N]`, which produces an array with `N` copies of `x`.\n-///   The type of `x` must be [`Copy`].\n+/// * A repeat expression `[expr; N]` where `N` is how many times to repeat `expr` in the array. `expr` must either be:\n+///\n+///   * A value of a type implementing the [`Copy`] trait\n+///   * A `const` value\n ///\n /// Note that `[expr; 0]` is allowed, and produces an empty array.\n /// This will still evaluate `expr`, however, and immediately drop the resulting value, so"}, {"sha": "ccb7be68eb1b2407c63426fd3de7d32ec52f0b46", "filename": "library/core/tests/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/library%2Fcore%2Ftests%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/library%2Fcore%2Ftests%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fcore%2Ftests%2Flib.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -67,6 +67,7 @@\n #![feature(slice_internals)]\n #![feature(slice_partition_dedup)]\n #![feature(ip)]\n+#![feature(ip_in_core)]\n #![feature(iter_advance_by)]\n #![feature(iter_array_chunks)]\n #![feature(iter_collect_into)]"}, {"sha": "6f78811a186c7ec6b6d3bb537407a860a66d8211", "filename": "library/std/src/primitive_docs.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/library%2Fstd%2Fsrc%2Fprimitive_docs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/library%2Fstd%2Fsrc%2Fprimitive_docs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Fprimitive_docs.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -587,8 +587,10 @@ mod prim_pointer {}\n /// There are two syntactic forms for creating an array:\n ///\n /// * A list with each element, i.e., `[x, y, z]`.\n-/// * A repeat expression `[x; N]`, which produces an array with `N` copies of `x`.\n-///   The type of `x` must be [`Copy`].\n+/// * A repeat expression `[expr; N]` where `N` is how many times to repeat `expr` in the array. `expr` must either be:\n+///\n+///   * A value of a type implementing the [`Copy`] trait\n+///   * A `const` value\n ///\n /// Note that `[expr; 0]` is allowed, and produces an empty array.\n /// This will still evaluate `expr`, however, and immediately drop the resulting value, so"}, {"sha": "21a2ed14f4480dab62438dcc1130291bebc65379", "filename": "src/doc/book", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": null, "raw_url": null, "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Fbook?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1 +1 @@\n-Subproject commit d94e03a18a2590ed3f1c67b859cb11528d2a2d5c\n+Subproject commit 21a2ed14f4480dab62438dcc1130291bebc65379"}, {"sha": "a9afb04b47a84a6753e4dc657348c324c876102c", "filename": "src/doc/reference", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": null, "raw_url": null, "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Freference?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1 +1 @@\n-Subproject commit e5adb99c04817b7fbe08f4ffce5b36702667345f\n+Subproject commit a9afb04b47a84a6753e4dc657348c324c876102c"}, {"sha": "af0998b7473839ca75563ba3d3e7fd0160bef235", "filename": "src/doc/rust-by-example", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": null, "raw_url": null, "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frust-by-example?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1 +1 @@\n-Subproject commit efe23c4fe12e06351b8dc8c3d18312c761455109\n+Subproject commit af0998b7473839ca75563ba3d3e7fd0160bef235"}, {"sha": "b06dab84083390e0ee1e998f466545a8a1a76a9f", "filename": "src/doc/rustc-dev-guide", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": null, "raw_url": null, "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Frustc-dev-guide?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1 +1 @@\n-Subproject commit 41a96ab971cb45e2a184df20619ad1829765c990\n+Subproject commit b06dab84083390e0ee1e998f466545a8a1a76a9f"}, {"sha": "9cf84acc79f8d9653988c6ca045844a1af5e4abb", "filename": "src/librustdoc/doctest.rs", "status": "modified", "additions": 3, "deletions": 11, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/src%2Flibrustdoc%2Fdoctest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/src%2Flibrustdoc%2Fdoctest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fdoctest.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -769,24 +769,16 @@ fn check_if_attr_is_complete(source: &str, edition: Edition) -> bool {\n                 match maybe_new_parser_from_source_str(&sess, filename, source.to_owned()) {\n                     Ok(p) => p,\n                     Err(_) => {\n-                        debug!(\"Cannot build a parser to check mod attr so skipping...\");\n-                        return true;\n+                        // If there is an unclosed delimiter, an error will be returned by the tokentrees.\n+                        return false;\n                     }\n                 };\n             // If a parsing error happened, it's very likely that the attribute is incomplete.\n             if let Err(e) = parser.parse_attribute(InnerAttrPolicy::Permitted) {\n                 e.cancel();\n                 return false;\n             }\n-            // We now check if there is an unclosed delimiter for the attribute. To do so, we look at\n-            // the `unclosed_delims` and see if the opening square bracket was closed.\n-            parser\n-                .unclosed_delims()\n-                .get(0)\n-                .map(|unclosed| {\n-                    unclosed.unclosed_span.map(|s| s.lo()).unwrap_or(BytePos(0)) != BytePos(2)\n-                })\n-                .unwrap_or(true)\n+            true\n         })\n     })\n     .unwrap_or(false)"}, {"sha": "b71734c2354df2f96f0b8d42409cb9a846ec69be", "filename": "tests/debuginfo/captured-fields-1.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fdebuginfo%2Fcaptured-fields-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fdebuginfo%2Fcaptured-fields-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdebuginfo%2Fcaptured-fields-1.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,5 +1,5 @@\n // compile-flags:-g\n-\n+// edition:2021\n // === GDB TESTS ===================================================================================\n \n // gdb-command:run\n@@ -44,7 +44,6 @@\n // lldbg-check:(captured_fields_1::main::{closure_env#5}) $5 = { my_var = { my_field1 = 11 my_field2 = 22 } }\n // lldb-command:continue\n \n-#![feature(capture_disjoint_fields)]\n #![allow(unused)]\n \n struct MyStruct {"}, {"sha": "8d463fb2451624c97e69ea8cd784a1cf04c2ab5b", "filename": "tests/debuginfo/captured-fields-2.rs", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fdebuginfo%2Fcaptured-fields-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fdebuginfo%2Fcaptured-fields-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdebuginfo%2Fcaptured-fields-2.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,5 +1,5 @@\n // compile-flags:-g\n-\n+// edition:2021\n // === GDB TESTS ===================================================================================\n \n // gdb-command:run\n@@ -20,7 +20,6 @@\n // lldbg-check:(unsigned int) $1 = 22\n // lldb-command:continue\n \n-#![feature(capture_disjoint_fields)]\n #![allow(unused)]\n \n struct MyStruct {\n@@ -29,10 +28,7 @@ struct MyStruct {\n }\n \n fn main() {\n-    let mut my_var = MyStruct {\n-        my_field1: 11,\n-        my_field2: 22,\n-    };\n+    let mut my_var = MyStruct { my_field1: 11, my_field2: 22 };\n     let my_ref = &mut my_var;\n \n     let test = || {"}, {"sha": "f71fd9980a261374877c5f1a5c571a5ff6c7f8be", "filename": "tests/ui/async-await/in-trait/dont-project-to-specializable-projection.stderr", "status": "modified", "additions": 4, "deletions": 11, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fasync-await%2Fin-trait%2Fdont-project-to-specializable-projection.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fasync-await%2Fin-trait%2Fdont-project-to-specializable-projection.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fasync-await%2Fin-trait%2Fdont-project-to-specializable-projection.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -7,20 +7,13 @@ LL | #![feature(async_fn_in_trait)]\n    = note: see issue #91611 <https://github.com/rust-lang/rust/issues/91611> for more information\n    = note: `#[warn(incomplete_features)]` on by default\n \n-error[E0053]: method `foo` has an incompatible type for trait\n-  --> $DIR/dont-project-to-specializable-projection.rs:14:35\n+error: async associated function in trait cannot be specialized\n+  --> $DIR/dont-project-to-specializable-projection.rs:14:5\n    |\n LL |     default async fn foo(_: T) -> &'static str {\n-   |                                   ^^^^^^^^^^^^ expected associated type, found future\n+   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |\n-note: type in trait\n-  --> $DIR/dont-project-to-specializable-projection.rs:10:27\n-   |\n-LL |     async fn foo(_: T) -> &'static str;\n-   |                           ^^^^^^^^^^^^\n-   = note: expected signature `fn(_) -> impl Future<Output = &'static str>`\n-              found signature `fn(_) -> impl Future<Output = &'static str>`\n+   = note: specialization behaves in inconsistent and surprising ways with `#![feature(async_fn_in_trait)]`, and for now is disallowed\n \n error: aborting due to previous error; 1 warning emitted\n \n-For more information about this error, try `rustc --explain E0053`."}, {"sha": "bfb487649a3ce5856731bacb954ce835e14ecc3d", "filename": "tests/ui/closures/2229_closure_analysis/issue_88118.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fclosures%2F2229_closure_analysis%2Fissue_88118.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fclosures%2F2229_closure_analysis%2Fissue_88118.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fclosures%2F2229_closure_analysis%2Fissue_88118.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,10 +1,7 @@\n // Regression test for #88118. Used to ICE.\n-//\n+// edition:2021\n // check-pass\n \n-#![allow(incomplete_features)]\n-#![feature(capture_disjoint_fields)]\n-\n fn foo<MsU>(handler: impl FnOnce() -> MsU + Clone + 'static) {\n     Box::new(move |value| {\n         (|_| handler.clone()())(value);"}, {"sha": "2fcffdf3f9a298f50daaed33566b47c498b932d3", "filename": "tests/ui/impl-trait/in-trait/specialization-broken.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fimpl-trait%2Fin-trait%2Fspecialization-broken.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fimpl-trait%2Fin-trait%2Fspecialization-broken.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fimpl-trait%2Fin-trait%2Fspecialization-broken.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -15,6 +15,7 @@ where\n {\n     fn bar(&self) -> U {\n         //~^ ERROR method `bar` has an incompatible type for trait\n+        //~| ERROR method with return-position `impl Trait` in trait cannot be specialized\n         *self\n     }\n }"}, {"sha": "dc621d6b8a848ff1d92d0fa17a1092af20622696", "filename": "tests/ui/impl-trait/in-trait/specialization-broken.stderr", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fimpl-trait%2Fin-trait%2Fspecialization-broken.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fimpl-trait%2Fin-trait%2Fspecialization-broken.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fimpl-trait%2Fin-trait%2Fspecialization-broken.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -18,6 +18,14 @@ LL |     fn bar(&self) -> impl Sized;\n    = note: expected signature `fn(&U) -> impl Sized`\n               found signature `fn(&U) -> U`\n \n-error: aborting due to previous error\n+error: method with return-position `impl Trait` in trait cannot be specialized\n+  --> $DIR/specialization-broken.rs:16:5\n+   |\n+LL |     fn bar(&self) -> U {\n+   |     ^^^^^^^^^^^^^^^^^^\n+   |\n+   = note: specialization behaves in inconsistent and surprising ways with `#![feature(return_position_impl_trait_in_trait)]`, and for now is disallowed\n+\n+error: aborting due to 2 previous errors\n \n For more information about this error, try `rustc --explain E0053`."}, {"sha": "2d298aff9db892ce39a6864ca42290440211afd2", "filename": "tests/ui/lint/issue-104897.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Flint%2Fissue-104897.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Flint%2Fissue-104897.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flint%2Fissue-104897.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,6 +1,5 @@\n // error-pattern: this file contains an unclosed delimiter\n // error-pattern: this file contains an unclosed delimiter\n // error-pattern: this file contains an unclosed delimiter\n-// error-pattern: format argument must be a string literal\n \n fn f(){(print!(\u00e1"}, {"sha": "728d51f34a49a015533fc607dc9db488a8515604", "filename": "tests/ui/lint/issue-104897.stderr", "status": "modified", "additions": 2, "deletions": 33, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Flint%2Fissue-104897.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Flint%2Fissue-104897.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flint%2Fissue-104897.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,5 +1,5 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/issue-104897.rs:6:18\n+  --> $DIR/issue-104897.rs:5:18\n    |\n LL | fn f(){(print!(\u00e1\n    |       --      -  ^\n@@ -8,36 +8,5 @@ LL | fn f(){(print!(\u00e1\n    |       |unclosed delimiter\n    |       unclosed delimiter\n \n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-104897.rs:6:18\n-   |\n-LL | fn f(){(print!(\u00e1\n-   |       --      -  ^\n-   |       ||      |\n-   |       ||      unclosed delimiter\n-   |       |unclosed delimiter\n-   |       unclosed delimiter\n-\n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-104897.rs:6:18\n-   |\n-LL | fn f(){(print!(\u00e1\n-   |       --      -  ^\n-   |       ||      |\n-   |       ||      unclosed delimiter\n-   |       |unclosed delimiter\n-   |       unclosed delimiter\n-\n-error: format argument must be a string literal\n-  --> $DIR/issue-104897.rs:6:16\n-   |\n-LL | fn f(){(print!(\u00e1\n-   |                ^\n-   |\n-help: you might be missing a string literal to format with\n-   |\n-LL | fn f(){(print!(\"{}\", \u00e1\n-   |                +++++\n-\n-error: aborting due to 4 previous errors\n+error: aborting due to previous error\n "}, {"sha": "bc03faf3fce6cbd6d00185732c180940e3c72ca8", "filename": "tests/ui/lint/unused_parens_multibyte_recovery.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Flint%2Funused_parens_multibyte_recovery.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Flint%2Funused_parens_multibyte_recovery.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flint%2Funused_parens_multibyte_recovery.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -3,7 +3,6 @@\n // error-pattern: this file contains an unclosed delimiter\n // error-pattern: this file contains an unclosed delimiter\n // error-pattern: this file contains an unclosed delimiter\n-// error-pattern: format argument must be a string literal\n //\n // Verify that unused parens lint does not try to create a span\n // which points in the middle of a multibyte character."}, {"sha": "adbf27fcca2f4e34aba18cb91de02f9830225267", "filename": "tests/ui/lint/unused_parens_multibyte_recovery.stderr", "status": "modified", "additions": 2, "deletions": 33, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Flint%2Funused_parens_multibyte_recovery.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Flint%2Funused_parens_multibyte_recovery.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Flint%2Funused_parens_multibyte_recovery.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,5 +1,5 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/unused_parens_multibyte_recovery.rs:11:17\n+  --> $DIR/unused_parens_multibyte_recovery.rs:10:17\n    |\n LL | fn f(){(print!(\u00e1\n    |       --      - ^\n@@ -8,36 +8,5 @@ LL | fn f(){(print!(\u00e1\n    |       |unclosed delimiter\n    |       unclosed delimiter\n \n-error: this file contains an unclosed delimiter\n-  --> $DIR/unused_parens_multibyte_recovery.rs:11:17\n-   |\n-LL | fn f(){(print!(\u00e1\n-   |       --      - ^\n-   |       ||      |\n-   |       ||      unclosed delimiter\n-   |       |unclosed delimiter\n-   |       unclosed delimiter\n-\n-error: this file contains an unclosed delimiter\n-  --> $DIR/unused_parens_multibyte_recovery.rs:11:17\n-   |\n-LL | fn f(){(print!(\u00e1\n-   |       --      - ^\n-   |       ||      |\n-   |       ||      unclosed delimiter\n-   |       |unclosed delimiter\n-   |       unclosed delimiter\n-\n-error: format argument must be a string literal\n-  --> $DIR/unused_parens_multibyte_recovery.rs:11:16\n-   |\n-LL | fn f(){(print!(\u00e1\n-   |                ^\n-   |\n-help: you might be missing a string literal to format with\n-   |\n-LL | fn f(){(print!(\"{}\", \u00e1\n-   |                +++++\n-\n-error: aborting due to 4 previous errors\n+error: aborting due to previous error\n "}, {"sha": "bdd9c2569545a8d517a74ac48f289f31dd563ade", "filename": "tests/ui/macros/issue-102878.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fmacros%2Fissue-102878.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fmacros%2Fissue-102878.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmacros%2Fissue-102878.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,9 +1,5 @@\n macro_rules!test{($l:expr,$_:r)=>({const:y y)}\n //~^ ERROR mismatched closing delimiter: `)`\n-//~| ERROR invalid fragment specifier `r`\n-//~| ERROR expected identifier, found keyword `const`\n-//~| ERROR expected identifier, found keyword `const`\n-//~| ERROR expected identifier, found `:`\n \n fn s(){test!(1,i)}\n "}, {"sha": "034e3731b87fa209ec0b06c26c7dc0d4140b1e02", "filename": "tests/ui/macros/issue-102878.stderr", "status": "modified", "additions": 1, "deletions": 50, "changes": 51, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fmacros%2Fissue-102878.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fmacros%2Fissue-102878.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmacros%2Fissue-102878.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -7,54 +7,5 @@ LL | macro_rules!test{($l:expr,$_:r)=>({const:y y)}\n    |                                  |unclosed delimiter\n    |                                  closing delimiter possibly meant for this\n \n-error: invalid fragment specifier `r`\n-  --> $DIR/issue-102878.rs:1:27\n-   |\n-LL | macro_rules!test{($l:expr,$_:r)=>({const:y y)}\n-   |                           ^^^^\n-   |\n-   = help: valid fragment specifiers are `ident`, `block`, `stmt`, `expr`, `pat`, `ty`, `lifetime`, `literal`, `path`, `meta`, `tt`, `item` and `vis`\n-\n-error: expected identifier, found keyword `const`\n-  --> $DIR/issue-102878.rs:1:36\n-   |\n-LL | macro_rules!test{($l:expr,$_:r)=>({const:y y)}\n-   |                                    ^^^^^ expected identifier, found keyword\n-...\n-LL | fn s(){test!(1,i)}\n-   |        ---------- in this macro invocation\n-   |\n-   = note: this error originates in the macro `test` (in Nightly builds, run with -Z macro-backtrace for more info)\n-help: escape `const` to use it as an identifier\n-   |\n-LL | macro_rules!test{($l:expr,$_:r)=>({r#const:y y)}\n-   |                                    ++\n-\n-error: expected identifier, found keyword `const`\n-  --> $DIR/issue-102878.rs:1:36\n-   |\n-LL | macro_rules!test{($l:expr,$_:r)=>({const:y y)}\n-   |                                    ^^^^^ expected identifier, found keyword\n-...\n-LL | fn s(){test!(1,i)}\n-   |        ---------- in this macro invocation\n-   |\n-   = note: this error originates in the macro `test` (in Nightly builds, run with -Z macro-backtrace for more info)\n-help: escape `const` to use it as an identifier\n-   |\n-LL | macro_rules!test{($l:expr,$_:r)=>({r#const:y y)}\n-   |                                    ++\n-\n-error: expected identifier, found `:`\n-  --> $DIR/issue-102878.rs:1:41\n-   |\n-LL | macro_rules!test{($l:expr,$_:r)=>({const:y y)}\n-   |                                         ^ expected identifier\n-...\n-LL | fn s(){test!(1,i)}\n-   |        ---------- in this macro invocation\n-   |\n-   = note: this error originates in the macro `test` (in Nightly builds, run with -Z macro-backtrace for more info)\n-\n-error: aborting due to 5 previous errors\n+error: aborting due to previous error\n "}, {"sha": "89e0d982eafdc860a66f19ce018ebd4ddb834b22", "filename": "tests/ui/malformed/issue-107423-unused-delim-only-one-no-pair.stderr", "status": "modified", "additions": 1, "deletions": 21, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fmalformed%2Fissue-107423-unused-delim-only-one-no-pair.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fmalformed%2Fissue-107423-unused-delim-only-one-no-pair.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmalformed%2Fissue-107423-unused-delim-only-one-no-pair.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -8,25 +8,5 @@ LL | fn a(){{{\n    |       |unclosed delimiter\n    |       unclosed delimiter\n \n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-107423-unused-delim-only-one-no-pair.rs:7:11\n-   |\n-LL | fn a(){{{\n-   |       --- ^\n-   |       |||\n-   |       ||unclosed delimiter\n-   |       |unclosed delimiter\n-   |       unclosed delimiter\n-\n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-107423-unused-delim-only-one-no-pair.rs:7:11\n-   |\n-LL | fn a(){{{\n-   |       --- ^\n-   |       |||\n-   |       ||unclosed delimiter\n-   |       |unclosed delimiter\n-   |       unclosed delimiter\n-\n-error: aborting due to 3 previous errors\n+error: aborting due to previous error\n "}, {"sha": "224ee6c09e0c233773ab6f4e98c10ab07c9fa051", "filename": "tests/ui/parser/deli-ident-issue-1.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fdeli-ident-issue-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fdeli-ident-issue-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fdeli-ident-issue-1.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -15,8 +15,6 @@ impl dyn Demo {\n         if let Some(b) = val\n         && let Some(c) = num {\n         && b == c {\n-            //~^ ERROR expected struct\n-            //~| ERROR mismatched types\n         }\n     }\n }"}, {"sha": "eb5073e14cfd931afcaeae10d039a273a25d3e62", "filename": "tests/ui/parser/deli-ident-issue-1.stderr", "status": "modified", "additions": 2, "deletions": 22, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fdeli-ident-issue-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fdeli-ident-issue-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fdeli-ident-issue-1.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,5 +1,5 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/deli-ident-issue-1.rs:24:66\n+  --> $DIR/deli-ident-issue-1.rs:22:66\n    |\n LL | impl dyn Demo {\n    |               - unclosed delimiter\n@@ -13,25 +13,5 @@ LL |     }\n LL | fn main() { }\n    |                                                                  ^\n \n-error[E0574]: expected struct, variant or union type, found local variable `c`\n-  --> $DIR/deli-ident-issue-1.rs:17:17\n-   |\n-LL |         && b == c {\n-   |                 ^ not a struct, variant or union type\n-\n-error[E0308]: mismatched types\n-  --> $DIR/deli-ident-issue-1.rs:17:9\n-   |\n-LL |       fn check(&self, val: Option<u32>, num: Option<u32>) {\n-   |                                                           - expected `()` because of default return type\n-...\n-LL | /         && b == c {\n-LL | |\n-LL | |\n-LL | |         }\n-   | |_________^ expected `()`, found `bool`\n-\n-error: aborting due to 3 previous errors\n+error: aborting due to previous error\n \n-Some errors have detailed explanations: E0308, E0574.\n-For more information about an error, try `rustc --explain E0308`."}, {"sha": "e0188cdfb4af833691b5d49f92cdd57fdc0aaf45", "filename": "tests/ui/parser/deli-ident-issue-2.stderr", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fdeli-ident-issue-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fdeli-ident-issue-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fdeli-ident-issue-2.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,3 +1,11 @@\n+error: mismatched closing delimiter: `]`\n+  --> $DIR/deli-ident-issue-2.rs:2:14\n+   |\n+LL |     if 1 < 2 {\n+   |              ^ unclosed delimiter\n+LL |         let _a = vec!];\n+   |                      ^ mismatched closing delimiter\n+\n error: unexpected closing delimiter: `}`\n   --> $DIR/deli-ident-issue-2.rs:5:1\n    |\n@@ -7,13 +15,5 @@ LL |     }\n LL | }\n    | ^ unexpected closing delimiter\n \n-error: mismatched closing delimiter: `]`\n-  --> $DIR/deli-ident-issue-2.rs:2:14\n-   |\n-LL |     if 1 < 2 {\n-   |              ^ unclosed delimiter\n-LL |         let _a = vec!];\n-   |                      ^ mismatched closing delimiter\n-\n error: aborting due to 2 previous errors\n "}, {"sha": "7eff7f431be7e5ecb2776c3bcac7950eaf25c33d", "filename": "tests/ui/parser/do-not-suggest-semicolon-before-array.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fdo-not-suggest-semicolon-before-array.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fdo-not-suggest-semicolon-before-array.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fdo-not-suggest-semicolon-before-array.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -2,7 +2,7 @@ fn foo() {}\n \n fn bar() -> [u8; 2] {\n     foo()\n-    [1, 3) //~ ERROR expected one of `.`, `?`, `]`, or an operator, found `,`\n+    [1, 3) //~ ERROR mismatched closing delimiter\n }\n \n fn main() {}"}, {"sha": "7b43c77005ed469afdcc4af2faec84743e30aa7f", "filename": "tests/ui/parser/do-not-suggest-semicolon-before-array.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fdo-not-suggest-semicolon-before-array.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fdo-not-suggest-semicolon-before-array.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fdo-not-suggest-semicolon-before-array.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,8 +1,8 @@\n-error: expected one of `.`, `?`, `]`, or an operator, found `,`\n+error: mismatched closing delimiter: `)`\n   --> $DIR/do-not-suggest-semicolon-before-array.rs:5:5\n    |\n LL |     [1, 3)\n-   |     ^ ^ help: `]` may belong here\n+   |     ^    ^ mismatched closing delimiter\n    |     |\n    |     unclosed delimiter\n "}, {"sha": "be33213f3cbce910d880a676f7bcadb79629c983", "filename": "tests/ui/parser/issue-103451.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissue-103451.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissue-103451.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissue-103451.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,5 +1,4 @@\n // error-pattern: this file contains an unclosed delimiter\n-// error-pattern: expected value, found struct `R`\n struct R { }\n struct S {\n     x: [u8; R"}, {"sha": "6aacd5012c14f89f96c15190aef50a4be35e66ae", "filename": "tests/ui/parser/issue-103451.stderr", "status": "modified", "additions": 2, "deletions": 22, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissue-103451.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissue-103451.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissue-103451.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,5 +1,5 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/issue-103451.rs:5:15\n+  --> $DIR/issue-103451.rs:4:15\n    |\n LL | struct S {\n    |          - unclosed delimiter\n@@ -8,25 +8,5 @@ LL |     x: [u8; R\n    |        |\n    |        unclosed delimiter\n \n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-103451.rs:5:15\n-   |\n-LL | struct S {\n-   |          - unclosed delimiter\n-LL |     x: [u8; R\n-   |        -      ^\n-   |        |\n-   |        unclosed delimiter\n-\n-error[E0423]: expected value, found struct `R`\n-  --> $DIR/issue-103451.rs:5:13\n-   |\n-LL | struct R { }\n-   | ------------ `R` defined here\n-LL | struct S {\n-LL |     x: [u8; R\n-   |             ^ help: use struct literal syntax instead: `R {}`\n-\n-error: aborting due to 3 previous errors\n+error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0423`."}, {"sha": "0ecb748a0a4ce6593f5817fa1345474e24bc5707", "filename": "tests/ui/parser/issue-68987-unmatch-issue-2.stderr", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissue-68987-unmatch-issue-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissue-68987-unmatch-issue-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissue-68987-unmatch-issue-2.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,3 +1,11 @@\n+error: mismatched closing delimiter: `)`\n+  --> $DIR/issue-68987-unmatch-issue-2.rs:3:32\n+   |\n+LL | async fn obstest() -> Result<> {\n+   |                                ^ unclosed delimiter\n+LL |     let obs_connect = || -> Result<(), MyError) {\n+   |                                               ^ mismatched closing delimiter\n+\n error: unexpected closing delimiter: `}`\n   --> $DIR/issue-68987-unmatch-issue-2.rs:14:1\n    |\n@@ -7,13 +15,5 @@ LL |     let obs_connect = || -> Result<(), MyError) {\n LL | }\n    | ^ unexpected closing delimiter\n \n-error: mismatched closing delimiter: `)`\n-  --> $DIR/issue-68987-unmatch-issue-2.rs:3:32\n-   |\n-LL | async fn obstest() -> Result<> {\n-   |                                ^ unclosed delimiter\n-LL |     let obs_connect = || -> Result<(), MyError) {\n-   |                                               ^ mismatched closing delimiter\n-\n error: aborting due to 2 previous errors\n "}, {"sha": "dfc4407ed6565f91c5cb8883e4c06f97fcc98c60", "filename": "tests/ui/parser/issue-68987-unmatch-issue-3.stderr", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissue-68987-unmatch-issue-3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissue-68987-unmatch-issue-3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissue-68987-unmatch-issue-3.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,3 +1,11 @@\n+error: mismatched closing delimiter: `)`\n+  --> $DIR/issue-68987-unmatch-issue-3.rs:5:19\n+   |\n+LL |     while cnt < j {\n+   |                   ^ unclosed delimiter\n+LL |         write!&mut res, \" \");\n+   |                            ^ mismatched closing delimiter\n+\n error: unexpected closing delimiter: `}`\n   --> $DIR/issue-68987-unmatch-issue-3.rs:8:1\n    |\n@@ -7,13 +15,5 @@ LL |     }\n LL | }\n    | ^ unexpected closing delimiter\n \n-error: mismatched closing delimiter: `)`\n-  --> $DIR/issue-68987-unmatch-issue-3.rs:5:19\n-   |\n-LL |     while cnt < j {\n-   |                   ^ unclosed delimiter\n-LL |         write!&mut res, \" \");\n-   |                            ^ mismatched closing delimiter\n-\n error: aborting due to 2 previous errors\n "}, {"sha": "ebc4752a142915f682f90ace312d8ac3987d6612", "filename": "tests/ui/parser/issue-81804.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissue-81804.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissue-81804.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissue-81804.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,8 +1,5 @@\n // error-pattern: this file contains an unclosed delimiter\n // error-pattern: this file contains an unclosed delimiter\n-// error-pattern: expected pattern, found `=`\n-// error-pattern: expected one of `)`, `,`, `->`, `where`, or `{`, found `]`\n-// error-pattern: expected item, found `]`\n \n fn main() {}\n "}, {"sha": "de3b33ecd95c62f46569bd680daf349a3d3e53c8", "filename": "tests/ui/parser/issue-81804.stderr", "status": "modified", "additions": 7, "deletions": 29, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissue-81804.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissue-81804.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissue-81804.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,41 +1,19 @@\n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-81804.rs:9:11\n+error: mismatched closing delimiter: `}`\n+  --> $DIR/issue-81804.rs:6:8\n    |\n LL | fn p([=(}\n-   |     --    ^\n-   |     ||\n-   |     |unclosed delimiter\n-   |     unclosed delimiter\n+   |        ^^ mismatched closing delimiter\n+   |        |\n+   |        unclosed delimiter\n \n error: this file contains an unclosed delimiter\n-  --> $DIR/issue-81804.rs:9:11\n+  --> $DIR/issue-81804.rs:6:11\n    |\n LL | fn p([=(}\n    |     --    ^\n    |     ||\n    |     |unclosed delimiter\n    |     unclosed delimiter\n \n-error: expected pattern, found `=`\n-  --> $DIR/issue-81804.rs:9:7\n-   |\n-LL | fn p([=(}\n-   |       ^ expected pattern\n-\n-error: expected one of `)`, `,`, `->`, `where`, or `{`, found `]`\n-  --> $DIR/issue-81804.rs:9:8\n-   |\n-LL | fn p([=(}\n-   |        ^ -^\n-   |        | |\n-   |        | help: `)` may belong here\n-   |        unclosed delimiter\n-\n-error: expected item, found `]`\n-  --> $DIR/issue-81804.rs:9:11\n-   |\n-LL | fn p([=(}\n-   |           ^ expected item\n-\n-error: aborting due to 5 previous errors\n+error: aborting due to 2 previous errors\n "}, {"sha": "91defd12a578330e86628b91771cca4c7a2cbd3c", "filename": "tests/ui/parser/issue-81827.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissue-81827.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissue-81827.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissue-81827.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,6 +1,5 @@\n // error-pattern: this file contains an unclosed delimiter\n // error-pattern: mismatched closing delimiter: `]`\n-// error-pattern: expected one of `)` or `,`, found `{`\n \n #![crate_name=\"0\"]\n "}, {"sha": "63d135f73e69f0e9f1c28636792b5cda5504c9b7", "filename": "tests/ui/parser/issue-81827.stderr", "status": "modified", "additions": 8, "deletions": 24, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissue-81827.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissue-81827.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissue-81827.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,15 +1,14 @@\n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-81827.rs:11:27\n+error: mismatched closing delimiter: `]`\n+  --> $DIR/issue-81827.rs:10:23\n    |\n LL | fn r()->i{0|{#[cfg(r(0{]0\n-   |          -  -          -  ^\n-   |          |  |          |\n-   |          |  |          missing open `[` for this delimiter\n-   |          |  unclosed delimiter\n-   |          unclosed delimiter\n+   |               -       ^^ mismatched closing delimiter\n+   |               |       |\n+   |               |       unclosed delimiter\n+   |               closing delimiter possibly meant for this\n \n error: this file contains an unclosed delimiter\n-  --> $DIR/issue-81827.rs:11:27\n+  --> $DIR/issue-81827.rs:10:27\n    |\n LL | fn r()->i{0|{#[cfg(r(0{]0\n    |          -  -          -  ^\n@@ -18,20 +17,5 @@ LL | fn r()->i{0|{#[cfg(r(0{]0\n    |          |  unclosed delimiter\n    |          unclosed delimiter\n \n-error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-81827.rs:11:23\n-   |\n-LL | fn r()->i{0|{#[cfg(r(0{]0\n-   |               -       ^^ mismatched closing delimiter\n-   |               |       |\n-   |               |       unclosed delimiter\n-   |               closing delimiter possibly meant for this\n-\n-error: expected one of `)` or `,`, found `{`\n-  --> $DIR/issue-81827.rs:11:23\n-   |\n-LL | fn r()->i{0|{#[cfg(r(0{]0\n-   |                       ^ expected one of `)` or `,`\n-\n-error: aborting due to 4 previous errors\n+error: aborting due to 2 previous errors\n "}, {"sha": "80d8ef65a6952a69bcc17bccf9642c3315a23d7b", "filename": "tests/ui/parser/issues/issue-10636-2.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-10636-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-10636-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-10636-2.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,11 +1,11 @@\n+// error-pattern: mismatched closing delimiter: `}`\n // FIXME(31528) we emit a bunch of silly errors here due to continuing past the\n // first one. This would be easy-ish to address by better recovery in tokenisation.\n \n pub fn trace_option(option: Option<isize>) {\n     option.map(|some| 42;\n-                          //~^ ERROR: expected one of\n+\n \n }\n-//~^ ERROR: expected expression, found `)`\n \n fn main() {}"}, {"sha": "4cd4be1803e12adf76a94ec0713dd1621f348f1f", "filename": "tests/ui/parser/issues/issue-10636-2.stderr", "status": "modified", "additions": 8, "deletions": 11, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-10636-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-10636-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-10636-2.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,16 +1,13 @@\n-error: expected one of `)`, `,`, `.`, `?`, or an operator, found `;`\n-  --> $DIR/issue-10636-2.rs:5:15\n+error: mismatched closing delimiter: `}`\n+  --> $DIR/issue-10636-2.rs:6:15\n    |\n+LL | pub fn trace_option(option: Option<isize>) {\n+   |                                            - closing delimiter possibly meant for this\n LL |     option.map(|some| 42;\n-   |               ^         ^ help: `)` may belong here\n-   |               |\n-   |               unclosed delimiter\n-\n-error: expected expression, found `)`\n-  --> $DIR/issue-10636-2.rs:8:1\n-   |\n+   |               ^ unclosed delimiter\n+...\n LL | }\n-   | ^ expected expression\n+   | ^ mismatched closing delimiter\n \n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n "}, {"sha": "a596a9f2de3a297b4e61eac13fde03f37376c7db", "filename": "tests/ui/parser/issues/issue-58094-missing-right-square-bracket.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-58094-missing-right-square-bracket.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-58094-missing-right-square-bracket.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-58094-missing-right-square-bracket.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,4 +1,5 @@\n // Fixed in #66054.\n // ignore-tidy-trailing-newlines\n-// error-pattern: aborting due to 2 previous errors\n+// error-pattern: this file contains an unclosed delimiter\n+// error-pattern: aborting due to previous error\n #[\u0405\n\\ No newline at end of file"}, {"sha": "c79e8b4fb708295d37e16f26b23cf4c985868068", "filename": "tests/ui/parser/issues/issue-58094-missing-right-square-bracket.stderr", "status": "modified", "additions": 2, "deletions": 8, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-58094-missing-right-square-bracket.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-58094-missing-right-square-bracket.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-58094-missing-right-square-bracket.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,16 +1,10 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/issue-58094-missing-right-square-bracket.rs:4:4\n+  --> $DIR/issue-58094-missing-right-square-bracket.rs:5:4\n    |\n LL | #[\u0405\n    |  - ^\n    |  |\n    |  unclosed delimiter\n \n-error: expected item after attributes\n-  --> $DIR/issue-58094-missing-right-square-bracket.rs:4:1\n-   |\n-LL | #[\u0405\n-   | ^^^\n-\n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n "}, {"sha": "799243d545ade1158f272992d85a39b8c5dd2349", "filename": "tests/ui/parser/issues/issue-58856-1.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-58856-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-58856-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-58856-1.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,8 +1,5 @@\n impl A {\n-    //~^ ERROR cannot find type `A` in this scope\n     fn b(self>\n-    //~^ ERROR expected one of `)`, `,`, or `:`, found `>`\n-    //~| ERROR expected one of `->`, `where`, or `{`, found `>`\n-}\n+} //~ ERROR mismatched closing delimiter\n \n fn main() {}"}, {"sha": "77ad8acbd43b5b97516be0476977390ddb92fdf9", "filename": "tests/ui/parser/issues/issue-58856-1.stderr", "status": "modified", "additions": 6, "deletions": 23, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-58856-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-58856-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-58856-1.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,29 +1,12 @@\n-error: expected one of `)`, `,`, or `:`, found `>`\n-  --> $DIR/issue-58856-1.rs:3:9\n-   |\n-LL |     fn b(self>\n-   |         ^    ^ help: `)` may belong here\n-   |         |\n-   |         unclosed delimiter\n-\n-error: expected one of `->`, `where`, or `{`, found `>`\n-  --> $DIR/issue-58856-1.rs:3:14\n+error: mismatched closing delimiter: `}`\n+  --> $DIR/issue-58856-1.rs:2:9\n    |\n LL | impl A {\n-   |        - while parsing this item list starting here\n-LL |\n+   |        - closing delimiter possibly meant for this\n LL |     fn b(self>\n-   |              ^ expected one of `->`, `where`, or `{`\n-...\n+   |         ^ unclosed delimiter\n LL | }\n-   | - the item list ends here\n-\n-error[E0412]: cannot find type `A` in this scope\n-  --> $DIR/issue-58856-1.rs:1:6\n-   |\n-LL | impl A {\n-   |      ^ not found in this scope\n+   | ^ mismatched closing delimiter\n \n-error: aborting due to 3 previous errors\n+error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0412`."}, {"sha": "5edd72639058ddd2a8532a60716781e85e43b2a7", "filename": "tests/ui/parser/issues/issue-58856-2.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-58856-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-58856-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-58856-2.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -4,11 +4,8 @@ trait Howness {}\n \n impl Howness for () {\n     fn how_are_you(&self -> Empty {\n-    //~^ ERROR expected one of `)` or `,`, found `->`\n-    //~| ERROR method `how_are_you` is not a member of trait `Howness`\n         Empty\n     }\n-}\n-//~^ ERROR non-item in item list\n+} //~ ERROR mismatched closing delimiter\n \n fn main() {}"}, {"sha": "5fcf5bcc17e83b6f613b897521375b375336890c", "filename": "tests/ui/parser/issues/issue-58856-2.stderr", "status": "modified", "additions": 6, "deletions": 27, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-58856-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-58856-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-58856-2.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,34 +1,13 @@\n-error: expected one of `)` or `,`, found `->`\n+error: mismatched closing delimiter: `}`\n   --> $DIR/issue-58856-2.rs:6:19\n    |\n-LL |     fn how_are_you(&self -> Empty {\n-   |                   ^     -^^\n-   |                   |     |\n-   |                   |     help: `)` may belong here\n-   |                   unclosed delimiter\n-\n-error: non-item in item list\n-  --> $DIR/issue-58856-2.rs:11:1\n-   |\n LL | impl Howness for () {\n-   |                     - item list starts here\n+   |                     - closing delimiter possibly meant for this\n+LL |     fn how_are_you(&self -> Empty {\n+   |                   ^ unclosed delimiter\n ...\n LL | }\n-   | ^\n-   | |\n-   | non-item starts here\n-   | item list ends here\n-\n-error[E0407]: method `how_are_you` is not a member of trait `Howness`\n-  --> $DIR/issue-58856-2.rs:6:5\n-   |\n-LL | /     fn how_are_you(&self -> Empty {\n-LL | |\n-LL | |\n-LL | |         Empty\n-LL | |     }\n-   | |_____^ not a member of trait `Howness`\n+   | ^ mismatched closing delimiter\n \n-error: aborting due to 3 previous errors\n+error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0407`."}, {"sha": "3c36e4d3ea7da927b03ae6d931d7dab8b2777a72", "filename": "tests/ui/parser/issues/issue-60075.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-60075.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-60075.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-60075.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -3,9 +3,6 @@ fn main() {}\n trait T {\n     fn qux() -> Option<usize> {\n         let _ = if true {\n-        });\n-//~^ ERROR non-item in item list\n-//~| ERROR mismatched closing delimiter: `)`\n-//~| ERROR expected one of `.`, `;`\n+        }); //~ ERROR mismatched closing delimiter\n         Some(4)\n     }"}, {"sha": "cd8f1231fad0a008d2e0c79b270100e9a3634122", "filename": "tests/ui/parser/issues/issue-60075.stderr", "status": "modified", "additions": 1, "deletions": 19, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-60075.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-60075.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-60075.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,21 +1,3 @@\n-error: expected one of `.`, `;`, `?`, `else`, or an operator, found `}`\n-  --> $DIR/issue-60075.rs:6:10\n-   |\n-LL |         });\n-   |          ^ expected one of `.`, `;`, `?`, `else`, or an operator\n-\n-error: non-item in item list\n-  --> $DIR/issue-60075.rs:6:11\n-   |\n-LL | trait T {\n-   |         - item list starts here\n-...\n-LL |         });\n-   |           ^ non-item starts here\n-...\n-LL |     }\n-   |     - item list ends here\n-\n error: mismatched closing delimiter: `)`\n   --> $DIR/issue-60075.rs:4:31\n    |\n@@ -25,5 +7,5 @@ LL |         let _ = if true {\n LL |         });\n    |          ^ mismatched closing delimiter\n \n-error: aborting due to 3 previous errors\n+error: aborting due to previous error\n "}, {"sha": "fa7c626f5cc124baf67e9ca4b422780b8424b76f", "filename": "tests/ui/parser/issues/issue-62524.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62524.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62524.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-62524.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,5 +1,5 @@\n // ignore-tidy-trailing-newlines\n-// error-pattern: aborting due to 3 previous errors\n+// error-pattern: aborting due to previous error\n #![allow(uncommon_codepoints)]\n \n y!["}, {"sha": "0cbaacd4c64be20f694fcbf55b0188a409e437e7", "filename": "tests/ui/parser/issues/issue-62524.stderr", "status": "modified", "additions": 1, "deletions": 24, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62524.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62524.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-62524.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -6,28 +6,5 @@ LL | y![\n LL | \u03e4,\n    |   ^\n \n-error: macros that expand to items must be delimited with braces or followed by a semicolon\n-  --> $DIR/issue-62524.rs:5:3\n-   |\n-LL |   y![\n-   |  ___^\n-LL | | \u03e4,\n-   | |__^\n-   |\n-help: change the delimiters to curly braces\n-   |\n-LL | y! { /* items */ }\n-   |    ~~~~~~~~~~~~~~~\n-help: add a semicolon\n-   |\n-LL | \u03e4,;\n-   |   +\n-\n-error: cannot find macro `y` in this scope\n-  --> $DIR/issue-62524.rs:5:1\n-   |\n-LL | y![\n-   | ^\n-\n-error: aborting due to 3 previous errors\n+error: aborting due to previous error\n "}, {"sha": "bb30d68eabd71ec91de2c6c571c7186114e1d69c", "filename": "tests/ui/parser/issues/issue-62546.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62546.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62546.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-62546.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,3 +1 @@\n-pub t(#\n-//~^ ERROR missing `fn` or `struct` for function or struct definition\n-//~ ERROR this file contains an unclosed delimiter\n+pub t(# //~ ERROR this file contains an unclosed delimiter"}, {"sha": "80c1c71689d151da9aa52b8e318dd90046468287", "filename": "tests/ui/parser/issues/issue-62546.stderr", "status": "modified", "additions": 3, "deletions": 12, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62546.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62546.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-62546.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,17 +1,8 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/issue-62546.rs:3:52\n+  --> $DIR/issue-62546.rs:1:60\n    |\n LL | pub t(#\n-   |      - unclosed delimiter\n-LL |\n-LL |\n-   |                                                    ^\n+   |      - unclosed delimiter                                  ^\n \n-error: missing `fn` or `struct` for function or struct definition\n-  --> $DIR/issue-62546.rs:1:4\n-   |\n-LL | pub t(#\n-   | ---^- help: if you meant to call a macro, try: `t!`\n-\n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n "}, {"sha": "4b463a17333a171069b75636919a671f965daa6f", "filename": "tests/ui/parser/issues/issue-62554.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62554.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62554.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-62554.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,5 +1,4 @@\n // error-pattern:this file contains an unclosed delimiter\n-// error-pattern:xpected `{`, found `macro_rules`\n \n fn main() {}\n "}, {"sha": "4637c795ae5ec2063b6e54cfa76ab7945110acf2", "filename": "tests/ui/parser/issues/issue-62554.stderr", "status": "modified", "additions": 2, "deletions": 62, "changes": 64, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62554.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62554.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-62554.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,5 +1,5 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/issue-62554.rs:6:89\n+  --> $DIR/issue-62554.rs:5:89\n    |\n LL | fn foo(u: u8) { if u8 macro_rules! u8 { (u6) => { fn uuuuuuuuuuu() { use s loo mod u8 {\n    |               -                       -         -                  -                  - ^\n@@ -9,65 +9,5 @@ LL | fn foo(u: u8) { if u8 macro_rules! u8 { (u6) => { fn uuuuuuuuuuu() { use s\n    |               |                       |         unclosed delimiter\n    |               unclosed delimiter      unclosed delimiter\n \n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-62554.rs:6:89\n-   |\n-LL | fn foo(u: u8) { if u8 macro_rules! u8 { (u6) => { fn uuuuuuuuuuu() { use s loo mod u8 {\n-   |               -                       -         -                  -                  - ^\n-   |               |                       |         |                  |                  |\n-   |               |                       |         |                  |                  unclosed delimiter\n-   |               |                       |         |                  unclosed delimiter\n-   |               |                       |         unclosed delimiter\n-   |               unclosed delimiter      unclosed delimiter\n-\n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-62554.rs:6:89\n-   |\n-LL | fn foo(u: u8) { if u8 macro_rules! u8 { (u6) => { fn uuuuuuuuuuu() { use s loo mod u8 {\n-   |               -                       -         -                  -                  - ^\n-   |               |                       |         |                  |                  |\n-   |               |                       |         |                  |                  unclosed delimiter\n-   |               |                       |         |                  unclosed delimiter\n-   |               |                       |         unclosed delimiter\n-   |               unclosed delimiter      unclosed delimiter\n-\n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-62554.rs:6:89\n-   |\n-LL | fn foo(u: u8) { if u8 macro_rules! u8 { (u6) => { fn uuuuuuuuuuu() { use s loo mod u8 {\n-   |               -                       -         -                  -                  - ^\n-   |               |                       |         |                  |                  |\n-   |               |                       |         |                  |                  unclosed delimiter\n-   |               |                       |         |                  unclosed delimiter\n-   |               |                       |         unclosed delimiter\n-   |               unclosed delimiter      unclosed delimiter\n-\n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-62554.rs:6:89\n-   |\n-LL | fn foo(u: u8) { if u8 macro_rules! u8 { (u6) => { fn uuuuuuuuuuu() { use s loo mod u8 {\n-   |               -                       -         -                  -                  - ^\n-   |               |                       |         |                  |                  |\n-   |               |                       |         |                  |                  unclosed delimiter\n-   |               |                       |         |                  unclosed delimiter\n-   |               |                       |         unclosed delimiter\n-   |               unclosed delimiter      unclosed delimiter\n-\n-error: expected `{`, found `macro_rules`\n-  --> $DIR/issue-62554.rs:6:23\n-   |\n-LL | fn foo(u: u8) { if u8 macro_rules! u8 { (u6) => { fn uuuuuuuuuuu() { use s loo mod u8 {\n-   |                       ^^^^^^^^^^^ expected `{`\n-   |\n-note: the `if` expression is missing a block after this condition\n-  --> $DIR/issue-62554.rs:6:20\n-   |\n-LL | fn foo(u: u8) { if u8 macro_rules! u8 { (u6) => { fn uuuuuuuuuuu() { use s loo mod u8 {\n-   |                    ^^\n-help: try placing this code inside a block\n-   |\n-LL | fn foo(u: u8) { if u8 { macro_rules! u8 { (u6) => { fn uuuuuuuuuuu() { use s loo mod u8 { }\n-   |                       +                                                                    +\n-\n-error: aborting due to 6 previous errors\n+error: aborting due to previous error\n "}, {"sha": "cc80d449930ee34760fccb6fd4144ad60f0b0f02", "filename": "tests/ui/parser/issues/issue-62881.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62881.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62881.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-62881.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,6 +1,3 @@\n fn main() {}\n \n-fn f() -> isize { fn f() -> isize {} pub f<\n-//~^ ERROR missing `fn` or `struct` for function or struct definition\n-//~| ERROR mismatched types\n-//~ ERROR this file contains an unclosed delimiter\n+fn f() -> isize { fn f() -> isize {} pub f< //~ ERROR this file contains an unclosed delimiter"}, {"sha": "e57cbd1810a4783b843e2435723158d573a3da22", "filename": "tests/ui/parser/issues/issue-62881.stderr", "status": "modified", "additions": 3, "deletions": 21, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62881.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62881.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-62881.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,26 +1,8 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/issue-62881.rs:6:52\n+  --> $DIR/issue-62881.rs:3:96\n    |\n LL | fn f() -> isize { fn f() -> isize {} pub f<\n-   |                 - unclosed delimiter\n-...\n-LL |\n-   |                                                    ^\n+   |                 - unclosed delimiter                                                           ^\n \n-error: missing `fn` or `struct` for function or struct definition\n-  --> $DIR/issue-62881.rs:3:41\n-   |\n-LL | fn f() -> isize { fn f() -> isize {} pub f<\n-   |                                         ^\n-\n-error[E0308]: mismatched types\n-  --> $DIR/issue-62881.rs:3:29\n-   |\n-LL | fn f() -> isize { fn f() -> isize {} pub f<\n-   |                      -      ^^^^^ expected `isize`, found `()`\n-   |                      |\n-   |                      implicitly returns `()` as its body has no tail or `return` expression\n-\n-error: aborting due to 3 previous errors\n+error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0308`."}, {"sha": "4dfa406ea2d825d1e30ca2ac9f4a2cf80a6ab5de", "filename": "tests/ui/parser/issues/issue-62894.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62894.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62894.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-62894.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,6 +1,5 @@\n // Regression test for #62894, shouldn't crash.\n // error-pattern: this file contains an unclosed delimiter\n-// error-pattern: expected one of `(`, `[`, or `{`, found keyword `fn`\n \n fn f() { assert_eq!(f(), (), assert_eq!(assert_eq!\n "}, {"sha": "700479076dfe8428c8455de132a23a01afdfdaaa", "filename": "tests/ui/parser/issues/issue-62894.stderr", "status": "modified", "additions": 2, "deletions": 38, "changes": 40, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62894.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62894.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-62894.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,5 +1,5 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/issue-62894.rs:7:14\n+  --> $DIR/issue-62894.rs:6:14\n    |\n LL | fn f() { assert_eq!(f(), (), assert_eq!(assert_eq!\n    |        -           -                   - unclosed delimiter\n@@ -10,41 +10,5 @@ LL |\n LL | fn main() {}\n    |              ^\n \n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-62894.rs:7:14\n-   |\n-LL | fn f() { assert_eq!(f(), (), assert_eq!(assert_eq!\n-   |        -           -                   - unclosed delimiter\n-   |        |           |\n-   |        |           unclosed delimiter\n-   |        unclosed delimiter\n-LL |\n-LL | fn main() {}\n-   |              ^\n-\n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-62894.rs:7:14\n-   |\n-LL | fn f() { assert_eq!(f(), (), assert_eq!(assert_eq!\n-   |        -           -                   - unclosed delimiter\n-   |        |           |\n-   |        |           unclosed delimiter\n-   |        unclosed delimiter\n-LL |\n-LL | fn main() {}\n-   |              ^\n-\n-error: expected one of `(`, `[`, or `{`, found keyword `fn`\n-  --> $DIR/issue-62894.rs:7:1\n-   |\n-LL | fn f() { assert_eq!(f(), (), assert_eq!(assert_eq!\n-   |                                                   - expected one of `(`, `[`, or `{`\n-LL |\n-LL | fn main() {}\n-   | ^^ unexpected token\n-  --> $SRC_DIR/core/src/macros/mod.rs:LL:COL\n-   |\n-   = note: while parsing argument for this `expr` macro fragment\n-\n-error: aborting due to 4 previous errors\n+error: aborting due to previous error\n "}, {"sha": "33511dee93e8f08a45815bb832b60e97c9444b28", "filename": "tests/ui/parser/issues/issue-62895.rs", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62895.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62895.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-62895.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,11 +1,11 @@\n fn main() {}\n \n-fn v() -> isize { //~ ERROR mismatched types\n-mod _ { //~ ERROR expected identifier\n-pub fn g() -> isizee { //~ ERROR cannot find type `isizee` in this scope\n-mod _ { //~ ERROR expected identifier\n-pub    g() -> is //~ ERROR missing `fn` for function definition\n-(), w20);\n+fn v() -> isize {\n+mod _ {\n+pub fn g() -> isizee {\n+mod _ {\n+pub    g() -> is\n+(), w20); //~ ERROR mismatched closing delimiter\n }\n-(), w20); //~ ERROR expected item, found `;`\n+(), w20); //~ ERROR mismatched closing delimiter\n }"}, {"sha": "0ad9ac63ebd4557e5735e387bdfb94a36b2eb6fb", "filename": "tests/ui/parser/issues/issue-62895.stderr", "status": "modified", "additions": 12, "deletions": 39, "changes": 51, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62895.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62895.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-62895.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,47 +1,20 @@\n-error: expected identifier, found reserved identifier `_`\n-  --> $DIR/issue-62895.rs:4:5\n+error: mismatched closing delimiter: `)`\n+  --> $DIR/issue-62895.rs:6:7\n    |\n LL | mod _ {\n-   |     ^ expected identifier, found reserved identifier\n-\n-error: expected identifier, found reserved identifier `_`\n-  --> $DIR/issue-62895.rs:6:5\n-   |\n-LL | mod _ {\n-   |     ^ expected identifier, found reserved identifier\n-\n-error: missing `fn` for function definition\n-  --> $DIR/issue-62895.rs:7:4\n-   |\n+   |       ^ unclosed delimiter\n LL | pub    g() -> is\n-   |    ^^^^\n-   |\n-help: add `fn` here to parse `g` as a public function\n-   |\n-LL | pub fn g() -> is\n-   |     ++\n-\n-error: expected item, found `;`\n-  --> $DIR/issue-62895.rs:10:9\n-   |\n LL | (), w20);\n-   |         ^ help: remove this semicolon\n-\n-error[E0412]: cannot find type `isizee` in this scope\n-  --> $DIR/issue-62895.rs:5:15\n-   |\n-LL | pub fn g() -> isizee {\n-   |               ^^^^^^ help: a builtin type with a similar name exists: `isize`\n+   |        ^ mismatched closing delimiter\n \n-error[E0308]: mismatched types\n-  --> $DIR/issue-62895.rs:3:11\n+error: mismatched closing delimiter: `)`\n+  --> $DIR/issue-62895.rs:4:7\n    |\n-LL | fn v() -> isize {\n-   |    -      ^^^^^ expected `isize`, found `()`\n-   |    |\n-   |    implicitly returns `()` as its body has no tail or `return` expression\n+LL | mod _ {\n+   |       ^ unclosed delimiter\n+...\n+LL | (), w20);\n+   |        ^ mismatched closing delimiter\n \n-error: aborting due to 6 previous errors\n+error: aborting due to 2 previous errors\n \n-Some errors have detailed explanations: E0308, E0412.\n-For more information about an error, try `rustc --explain E0308`."}, {"sha": "22d7545770223078c231a3dfbd3e17e025631126", "filename": "tests/ui/parser/issues/issue-62973.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62973.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62973.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-62973.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,5 +1,5 @@\n // ignore-tidy-trailing-newlines\n-// error-pattern: aborting due to 7 previous errors\n+// error-pattern: aborting due to 3 previous errors\n \n fn main() {}\n "}, {"sha": "14411a8cb7849c17d197386bf0f2bca48ee2599a", "filename": "tests/ui/parser/issues/issue-62973.stderr", "status": "modified", "additions": 14, "deletions": 70, "changes": 84, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62973.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-62973.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-62973.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,72 +1,3 @@\n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-62973.rs:8:2\n-   |\n-LL | fn p() { match s { v, E { [) {) }\n-   |        -         -         -  - missing open `(` for this delimiter\n-   |        |         |         |\n-   |        |         |         missing open `(` for this delimiter\n-   |        |         unclosed delimiter\n-   |        unclosed delimiter\n-LL |\n-LL |\n-   |  ^\n-\n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-62973.rs:8:2\n-   |\n-LL | fn p() { match s { v, E { [) {) }\n-   |        -         -         -  - missing open `(` for this delimiter\n-   |        |         |         |\n-   |        |         |         missing open `(` for this delimiter\n-   |        |         unclosed delimiter\n-   |        unclosed delimiter\n-LL |\n-LL |\n-   |  ^\n-\n-error: expected one of `,`, `:`, or `}`, found `{`\n-  --> $DIR/issue-62973.rs:6:8\n-   |\n-LL | fn p() { match s { v, E { [) {) }\n-   |        ^       -        ^ expected one of `,`, `:`, or `}`\n-   |        |       |\n-   |        |       while parsing this struct\n-   |        unclosed delimiter\n-   |\n-help: `}` may belong here\n-   |\n-LL | fn p() { match s { v, E} { [) {) }\n-   |                        +\n-help: try naming a field\n-   |\n-LL | fn p() { match s { v, E: E { [) {) }\n-   |                       ++\n-\n-error: struct literals are not allowed here\n-  --> $DIR/issue-62973.rs:6:16\n-   |\n-LL |   fn p() { match s { v, E { [) {) }\n-   |  ________________^\n-LL | |\n-LL | |\n-   | |_^\n-   |\n-help: surround the struct literal with parentheses\n-   |\n-LL ~ fn p() { match (s { v, E { [) {) }\n-LL | \n-LL ~ )\n-   |\n-\n-error: expected one of `.`, `?`, `{`, or an operator, found `}`\n-  --> $DIR/issue-62973.rs:8:2\n-   |\n-LL | fn p() { match s { v, E { [) {) }\n-   |          ----- while parsing this `match` expression\n-LL |\n-LL |\n-   |  ^ expected one of `.`, `?`, `{`, or an operator\n-\n error: mismatched closing delimiter: `)`\n   --> $DIR/issue-62973.rs:6:27\n    |\n@@ -83,5 +14,18 @@ LL | fn p() { match s { v, E { [) {) }\n    |                              |\n    |                              unclosed delimiter\n \n-error: aborting due to 7 previous errors\n+error: this file contains an unclosed delimiter\n+  --> $DIR/issue-62973.rs:8:2\n+   |\n+LL | fn p() { match s { v, E { [) {) }\n+   |        -         -         -  - missing open `(` for this delimiter\n+   |        |         |         |\n+   |        |         |         missing open `(` for this delimiter\n+   |        |         unclosed delimiter\n+   |        unclosed delimiter\n+LL |\n+LL |\n+   |  ^\n+\n+error: aborting due to 3 previous errors\n "}, {"sha": "6b9d9cdbeb1fb287e33aeb36f4bcaf72032edfd7", "filename": "tests/ui/parser/issues/issue-63116.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-63116.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-63116.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-63116.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,3 +1,3 @@\n // fixed by #66361\n-// error-pattern: aborting due to 3 previous errors\n+// error-pattern: aborting due to 2 previous errors\n impl W <s(f;Y(;]"}, {"sha": "27c94f337bdb82ef0f541a2b32ed321a8f74e01d", "filename": "tests/ui/parser/issues/issue-63116.stderr", "status": "modified", "additions": 9, "deletions": 15, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-63116.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-63116.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-63116.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,3 +1,11 @@\n+error: mismatched closing delimiter: `]`\n+  --> $DIR/issue-63116.rs:3:14\n+   |\n+LL | impl W <s(f;Y(;]\n+   |              ^ ^ mismatched closing delimiter\n+   |              |\n+   |              unclosed delimiter\n+\n error: this file contains an unclosed delimiter\n   --> $DIR/issue-63116.rs:3:18\n    |\n@@ -7,19 +15,5 @@ LL | impl W <s(f;Y(;]\n    |          |     missing open `[` for this delimiter\n    |          unclosed delimiter\n \n-error: expected one of `!`, `(`, `)`, `+`, `,`, `::`, or `<`, found `;`\n-  --> $DIR/issue-63116.rs:3:12\n-   |\n-LL | impl W <s(f;Y(;]\n-   |            ^ expected one of 7 possible tokens\n-\n-error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-63116.rs:3:14\n-   |\n-LL | impl W <s(f;Y(;]\n-   |              ^ ^ mismatched closing delimiter\n-   |              |\n-   |              unclosed delimiter\n-\n-error: aborting due to 3 previous errors\n+error: aborting due to 2 previous errors\n "}, {"sha": "d61197dc566ac7a3d1476ce0e16a4d5703da9247", "filename": "tests/ui/parser/issues/issue-63135.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-63135.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-63135.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-63135.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,3 +1,3 @@\n-// error-pattern: aborting due to 5 previous errors\n-\n+// error-pattern: this file contains an unclosed delimiter\n+// error-pattern: aborting due to previous error\n fn i(n{...,f #"}, {"sha": "ff9d99c28fe7d58b1938716d0a955c5420624874", "filename": "tests/ui/parser/issues/issue-63135.stderr", "status": "modified", "additions": 1, "deletions": 38, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-63135.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-63135.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-63135.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -7,42 +7,5 @@ LL | fn i(n{...,f #\n    |     | unclosed delimiter\n    |     unclosed delimiter\n \n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-63135.rs:3:16\n-   |\n-LL | fn i(n{...,f #\n-   |     - -        ^\n-   |     | |\n-   |     | unclosed delimiter\n-   |     unclosed delimiter\n-\n-error: expected field pattern, found `...`\n-  --> $DIR/issue-63135.rs:3:8\n-   |\n-LL | fn i(n{...,f #\n-   |        ^^^\n-   |\n-help: to omit remaining fields, use `..`\n-   |\n-LL | fn i(n{..,f #\n-   |        ~~\n-\n-error: expected `}`, found `,`\n-  --> $DIR/issue-63135.rs:3:11\n-   |\n-LL | fn i(n{...,f #\n-   |        ---^\n-   |        |  |\n-   |        |  expected `}`\n-   |        `..` must be at the end and cannot have a trailing comma\n-\n-error: expected one of `!` or `[`, found `}`\n-  --> $DIR/issue-63135.rs:3:16\n-   |\n-LL | fn i(n{...,f #\n-   |      -         ^ expected one of `!` or `[`\n-   |      |\n-   |      while parsing the fields for this pattern\n-\n-error: aborting due to 5 previous errors\n+error: aborting due to previous error\n "}, {"sha": "69a2dfe6cbd15fe7f984f568b1d8a127f2997db9", "filename": "tests/ui/parser/issues/issue-66357-unexpected-unreachable.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-66357-unexpected-unreachable.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-66357-unexpected-unreachable.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-66357-unexpected-unreachable.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -9,6 +9,4 @@\n //\n // ended up bubbling up `Ok(true)` to `unexpected` which then used `unreachable!()`.\n \n-fn f() { |[](* }\n-//~^ ERROR expected one of `,` or `:`, found `(`\n-//~| ERROR expected one of `&`, `(`, `)`, `-`, `...`, `..=`, `..`, `[`, `_`, `box`, `mut`, `ref`, `|`, identifier, or path, found `*`\n+fn f() { |[](* } //~ ERROR mismatched closing delimiter"}, {"sha": "079fff37ea4f84092c6c2ab25dbb1b3df676b80a", "filename": "tests/ui/parser/issues/issue-66357-unexpected-unreachable.stderr", "status": "modified", "additions": 6, "deletions": 11, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-66357-unexpected-unreachable.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-66357-unexpected-unreachable.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-66357-unexpected-unreachable.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,16 +1,11 @@\n-error: expected one of `,` or `:`, found `(`\n+error: mismatched closing delimiter: `}`\n   --> $DIR/issue-66357-unexpected-unreachable.rs:12:13\n    |\n LL | fn f() { |[](* }\n-   |             ^ expected one of `,` or `:`\n+   |        -    ^  ^ mismatched closing delimiter\n+   |        |    |\n+   |        |    unclosed delimiter\n+   |        closing delimiter possibly meant for this\n \n-error: expected one of `&`, `(`, `)`, `-`, `...`, `..=`, `..`, `[`, `_`, `box`, `mut`, `ref`, `|`, identifier, or path, found `*`\n-  --> $DIR/issue-66357-unexpected-unreachable.rs:12:13\n-   |\n-LL | fn f() { |[](* }\n-   |             ^^ help: `)` may belong here\n-   |             |\n-   |             unclosed delimiter\n-\n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n "}, {"sha": "e712160fcf84de00cf32dc3dbcd69d930f77d916", "filename": "tests/ui/parser/issues/issue-67377-invalid-syntax-in-enum-discriminant.rs", "status": "modified", "additions": 1, "deletions": 13, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-67377-invalid-syntax-in-enum-discriminant.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-67377-invalid-syntax-in-enum-discriminant.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-67377-invalid-syntax-in-enum-discriminant.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -4,32 +4,20 @@ mod a {\n     enum Bug {\n         V = [PhantomData; { [ () ].len() ].len() as isize,\n         //~^ ERROR mismatched closing delimiter: `]`\n-        //~| ERROR mismatched closing delimiter: `]`\n-        //~| ERROR mismatched closing delimiter: `]`\n-        //~| ERROR mismatched closing delimiter: `]`\n     }\n }\n \n mod b {\n     enum Bug {\n         V = [Vec::new; { [].len()  ].len() as isize,\n         //~^ ERROR mismatched closing delimiter: `]`\n-        //~| ERROR mismatched closing delimiter: `]`\n-        //~| ERROR mismatched closing delimiter: `]`\n-        //~| ERROR mismatched closing delimiter: `]`\n-        //~| ERROR type annotations needed\n     }\n }\n \n mod c {\n     enum Bug {\n         V = [Vec::new; { [0].len() ].len() as isize,\n         //~^ ERROR mismatched closing delimiter: `]`\n-        //~| ERROR mismatched closing delimiter: `]`\n-        //~| ERROR mismatched closing delimiter: `]`\n-        //~| ERROR mismatched closing delimiter: `]`\n-        //~| ERROR type annotations needed\n-    }\n }\n \n-fn main() {}\n+fn main() {} //~ ERROR this file contains an unclosed delimiter"}, {"sha": "9f631edf680c8edcb68d55af5269f16a745f7585", "filename": "tests/ui/parser/issues/issue-67377-invalid-syntax-in-enum-discriminant.stderr", "status": "modified", "additions": 16, "deletions": 97, "changes": 113, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-67377-invalid-syntax-in-enum-discriminant.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-67377-invalid-syntax-in-enum-discriminant.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-67377-invalid-syntax-in-enum-discriminant.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -8,7 +8,7 @@ LL |         V = [PhantomData; { [ () ].len() ].len() as isize,\n    |             closing delimiter possibly meant for this\n \n error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:15:24\n+  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:12:24\n    |\n LL |         V = [Vec::new; { [].len()  ].len() as isize,\n    |             -          ^           ^ mismatched closing delimiter\n@@ -17,112 +17,31 @@ LL |         V = [Vec::new; { [].len()  ].len() as isize,\n    |             closing delimiter possibly meant for this\n \n error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:26:24\n+  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:19:24\n    |\n LL |         V = [Vec::new; { [0].len() ].len() as isize,\n    |             -          ^           ^ mismatched closing delimiter\n    |             |          |\n    |             |          unclosed delimiter\n    |             closing delimiter possibly meant for this\n \n-error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:5:27\n-   |\n-LL |         V = [PhantomData; { [ () ].len() ].len() as isize,\n-   |             -             ^              ^ mismatched closing delimiter\n-   |             |             |\n-   |             |             unclosed delimiter\n-   |             closing delimiter possibly meant for this\n-\n-error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:15:24\n-   |\n-LL |         V = [Vec::new; { [].len()  ].len() as isize,\n-   |             -          ^           ^ mismatched closing delimiter\n-   |             |          |\n-   |             |          unclosed delimiter\n-   |             closing delimiter possibly meant for this\n-\n-error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:26:24\n-   |\n-LL |         V = [Vec::new; { [0].len() ].len() as isize,\n-   |             -          ^           ^ mismatched closing delimiter\n-   |             |          |\n-   |             |          unclosed delimiter\n-   |             closing delimiter possibly meant for this\n-\n-error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:5:27\n-   |\n-LL |         V = [PhantomData; { [ () ].len() ].len() as isize,\n-   |             -             ^              ^ mismatched closing delimiter\n-   |             |             |\n-   |             |             unclosed delimiter\n-   |             closing delimiter possibly meant for this\n-\n-error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:15:24\n-   |\n-LL |         V = [Vec::new; { [].len()  ].len() as isize,\n-   |             -          ^           ^ mismatched closing delimiter\n-   |             |          |\n-   |             |          unclosed delimiter\n-   |             closing delimiter possibly meant for this\n-\n-error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:26:24\n-   |\n-LL |         V = [Vec::new; { [0].len() ].len() as isize,\n-   |             -          ^           ^ mismatched closing delimiter\n-   |             |          |\n-   |             |          unclosed delimiter\n-   |             closing delimiter possibly meant for this\n-\n-error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:5:27\n+error: this file contains an unclosed delimiter\n+  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:23:65\n    |\n LL |         V = [PhantomData; { [ () ].len() ].len() as isize,\n-   |             -             ^              ^ mismatched closing delimiter\n-   |             |             |\n-   |             |             unclosed delimiter\n-   |             closing delimiter possibly meant for this\n-\n-error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:15:24\n-   |\n+   |                                          - missing open `[` for this delimiter\n+...\n LL |         V = [Vec::new; { [].len()  ].len() as isize,\n-   |             -          ^           ^ mismatched closing delimiter\n-   |             |          |\n-   |             |          unclosed delimiter\n-   |             closing delimiter possibly meant for this\n-\n-error: mismatched closing delimiter: `]`\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:26:24\n-   |\n+   |                                    - missing open `[` for this delimiter\n+...\n+LL | mod c {\n+   |       - unclosed delimiter\n+LL |     enum Bug {\n LL |         V = [Vec::new; { [0].len() ].len() as isize,\n-   |             -          ^           ^ mismatched closing delimiter\n-   |             |          |\n-   |             |          unclosed delimiter\n-   |             closing delimiter possibly meant for this\n-\n-error[E0282]: type annotations needed\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:15:26\n-   |\n-LL |         V = [Vec::new; { [].len()  ].len() as isize,\n-   |                          ^^ cannot infer type for type parameter `T`\n-\n-error[E0282]: type annotations needed\n-  --> $DIR/issue-67377-invalid-syntax-in-enum-discriminant.rs:26:14\n-   |\n-LL |         V = [Vec::new; { [0].len() ].len() as isize,\n-   |              ^^^^^^^^ cannot infer type of the type parameter `T` declared on the struct `Vec`\n-   |\n-help: consider specifying the generic argument\n-   |\n-LL |         V = [Vec::<T>::new; { [0].len() ].len() as isize,\n-   |                 +++++\n+   |                                    - missing open `[` for this delimiter\n+...\n+LL | fn main() {}\n+   |                                                                 ^\n \n-error: aborting due to 14 previous errors\n+error: aborting due to 4 previous errors\n \n-For more information about this error, try `rustc --explain E0282`."}, {"sha": "af89bb58699b51d2a72be405dd52999cdce599c7", "filename": "tests/ui/parser/issues/issue-68629.rs", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-68629.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-68629.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-68629.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89"}, {"sha": "2562baa1c49c3034012d9721c128aecc4303dc02", "filename": "tests/ui/parser/issues/issue-68629.stderr", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-68629.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-68629.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-68629.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89"}, {"sha": "962eb69bd83f1b6c1e48c3424af22efa935e51cd", "filename": "tests/ui/parser/issues/issue-84104.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-84104.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-84104.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-84104.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,3 +1,2 @@\n // error-pattern: this file contains an unclosed delimiter\n-// error-pattern: expected one of\n #[i=i::<\u069a\u0716<"}, {"sha": "7ad59f8450efa2af5129cbd8dd50d9d02ce77767", "filename": "tests/ui/parser/issues/issue-84104.stderr", "status": "modified", "additions": 2, "deletions": 8, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-84104.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-84104.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-84104.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,16 +1,10 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/issue-84104.rs:3:13\n+  --> $DIR/issue-84104.rs:2:13\n    |\n LL | #[i=i::<\u069a\u0716<\n    |  -          ^\n    |  |\n    |  unclosed delimiter\n \n-error: expected one of `>`, a const expression, lifetime, or type, found `]`\n-  --> $DIR/issue-84104.rs:3:13\n-   |\n-LL | #[i=i::<\u069a\u0716<\n-   |             ^ expected one of `>`, a const expression, lifetime, or type\n-\n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n "}, {"sha": "e677abde5f632ef2c8ef4f894cb344598af9e8bd", "filename": "tests/ui/parser/issues/issue-84148-2.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-84148-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-84148-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-84148-2.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,3 +1,2 @@\n // error-pattern: this file contains an unclosed delimiter\n-// error-pattern: invalid `?` in type\n fn f(t:for<>t?"}, {"sha": "20761180e77c4497d23c497557b34bc2df49cbb5", "filename": "tests/ui/parser/issues/issue-84148-2.stderr", "status": "modified", "additions": 2, "deletions": 19, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-84148-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-84148-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-84148-2.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,27 +1,10 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/issue-84148-2.rs:3:16\n+  --> $DIR/issue-84148-2.rs:2:16\n    |\n LL | fn f(t:for<>t?\n    |     -          ^\n    |     |\n    |     unclosed delimiter\n \n-error: invalid `?` in type\n-  --> $DIR/issue-84148-2.rs:3:14\n-   |\n-LL | fn f(t:for<>t?\n-   |              ^ `?` is only allowed on expressions, not types\n-   |\n-help: if you meant to express that the type might not contain a value, use the `Option` wrapper type\n-   |\n-LL | fn f(t:Option<for<>t>\n-   |        +++++++      ~\n-\n-error: expected one of `->`, `where`, or `{`, found `<eof>`\n-  --> $DIR/issue-84148-2.rs:3:16\n-   |\n-LL | fn f(t:for<>t?\n-   |                ^ expected one of `->`, `where`, or `{`\n-\n-error: aborting due to 3 previous errors\n+error: aborting due to previous error\n "}, {"sha": "9341415b2d9d67ff6cad4bd4cbf8c4c4c2a9c1da", "filename": "tests/ui/parser/issues/issue-88770.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-88770.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-88770.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-88770.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,9 +1,6 @@\n // Regression test for the ICE described in #88770.\n \n // error-pattern:this file contains an unclosed delimiter\n-// error-pattern:expected one of\n-// error-pattern:missing `in` in `for` loop\n-// error-pattern:expected one of `!`, `)`, `,`, `.`, `::`, `;`, `?`, `{`, or an operator, found `e`\n \n fn m(){print!(\"\",(c for&g\n u"}, {"sha": "836f44953d4a8c941eb0097b40f5de9a8c0bce34", "filename": "tests/ui/parser/issues/issue-88770.stderr", "status": "modified", "additions": 2, "deletions": 48, "changes": 50, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-88770.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fissues%2Fissue-88770.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fissues%2Fissue-88770.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,5 +1,5 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/issue-88770.rs:11:3\n+  --> $DIR/issue-88770.rs:8:3\n    |\n LL | fn m(){print!(\"\",(c for&g\n    |       -      -   - unclosed delimiter\n@@ -10,51 +10,5 @@ LL | fn m(){print!(\"\",(c for&g\n LL | e\n    |   ^\n \n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-88770.rs:11:3\n-   |\n-LL | fn m(){print!(\"\",(c for&g\n-   |       -      -   - unclosed delimiter\n-   |       |      |\n-   |       |      unclosed delimiter\n-   |       unclosed delimiter\n-...\n-LL | e\n-   |   ^\n-\n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-88770.rs:11:3\n-   |\n-LL | fn m(){print!(\"\",(c for&g\n-   |       -      -   - unclosed delimiter\n-   |       |      |\n-   |       |      unclosed delimiter\n-   |       unclosed delimiter\n-...\n-LL | e\n-   |   ^\n-\n-error: missing `in` in `for` loop\n-  --> $DIR/issue-88770.rs:8:26\n-   |\n-LL |   fn m(){print!(\"\",(c for&g\n-   |  __________________________^\n-LL | | u\n-   | |_ help: try adding `in` here\n-\n-error: expected one of `!`, `)`, `,`, `.`, `::`, `?`, `{`, or an operator, found keyword `for`\n-  --> $DIR/issue-88770.rs:8:21\n-   |\n-LL | fn m(){print!(\"\",(c for&g\n-   |                     ^^^ expected one of 8 possible tokens\n-\n-error: expected one of `!`, `)`, `,`, `.`, `::`, `;`, `?`, `{`, or an operator, found `e`\n-  --> $DIR/issue-88770.rs:11:1\n-   |\n-LL | e\n-   |  - expected one of 9 possible tokens\n-LL | e\n-   | ^ unexpected token\n-\n-error: aborting due to 6 previous errors\n+error: aborting due to previous error\n "}, {"sha": "34217e21ae95ef582c3420c92caeabebd75e2546", "filename": "tests/ui/parser/macro-mismatched-delim-paren-brace.stderr", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmacro-mismatched-delim-paren-brace.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmacro-mismatched-delim-paren-brace.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fmacro-mismatched-delim-paren-brace.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,3 +1,12 @@\n+error: mismatched closing delimiter: `}`\n+  --> $DIR/macro-mismatched-delim-paren-brace.rs:2:10\n+   |\n+LL |     foo! (\n+   |          ^ unclosed delimiter\n+LL |         bar, \"baz\", 1, 2.0\n+LL |     }\n+   |     ^ mismatched closing delimiter\n+\n error: unexpected closing delimiter: `}`\n   --> $DIR/macro-mismatched-delim-paren-brace.rs:5:1\n    |\n@@ -9,14 +18,5 @@ LL |     }\n LL | }\n    | ^ unexpected closing delimiter\n \n-error: mismatched closing delimiter: `}`\n-  --> $DIR/macro-mismatched-delim-paren-brace.rs:2:10\n-   |\n-LL |     foo! (\n-   |          ^ unclosed delimiter\n-LL |         bar, \"baz\", 1, 2.0\n-LL |     }\n-   |     ^ mismatched closing delimiter\n-\n error: aborting due to 2 previous errors\n "}, {"sha": "9a92e67da4db24734b3c93093f4bc0fc121e99b6", "filename": "tests/ui/parser/mbe_missing_right_paren.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmbe_missing_right_paren.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmbe_missing_right_paren.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fmbe_missing_right_paren.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,3 +1,3 @@\n // ignore-tidy-trailing-newlines\n-// error-pattern: aborting due to 3 previous errors\n+// error-pattern: this file contains an unclosed delimiter\n macro_rules! abc(\u063c\n\\ No newline at end of file"}, {"sha": "d2af94683eff4a793e6ec852e7b6cadb2f21f441", "filename": "tests/ui/parser/mbe_missing_right_paren.stderr", "status": "modified", "additions": 1, "deletions": 22, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmbe_missing_right_paren.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmbe_missing_right_paren.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fmbe_missing_right_paren.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -6,26 +6,5 @@ LL | macro_rules! abc(\u063c\n    |                 |\n    |                 unclosed delimiter\n \n-error: macros that expand to items must be delimited with braces or followed by a semicolon\n-  --> $DIR/mbe_missing_right_paren.rs:3:17\n-   |\n-LL | macro_rules! abc(\u063c\n-   |                 ^^\n-   |\n-help: change the delimiters to curly braces\n-   |\n-LL | macro_rules! abc { /* items */ }\n-   |                  ~~~~~~~~~~~~~~~\n-help: add a semicolon\n-   |\n-LL | macro_rules! abc(\u063c;\n-   |                   +\n-\n-error: unexpected end of macro invocation\n-  --> $DIR/mbe_missing_right_paren.rs:3:19\n-   |\n-LL | macro_rules! abc(\u063c\n-   |                   ^ missing tokens in macro arguments\n-\n-error: aborting due to 3 previous errors\n+error: aborting due to previous error\n "}, {"sha": "79de98d8b8cd3534e09f5a92e5df4f2f03451ed1", "filename": "tests/ui/parser/mismatched-braces/missing-close-brace-in-impl-trait.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-impl-trait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-impl-trait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-impl-trait.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,13 +1,13 @@\n fn main() {}\n \n-impl T for () { //~ ERROR cannot find trait `T` in this scope\n+impl T for () {\n \n fn foo(&self) {}\n \n-trait T { //~ ERROR trait is not supported in `trait`s or `impl`s\n+trait T {\n     fn foo(&self);\n }\n \n-pub(crate) struct Bar<T>(); //~ ERROR struct is not supported in `trait`s or `impl`s\n+pub(crate) struct Bar<T>();\n \n //~ ERROR this file contains an unclosed delimiter"}, {"sha": "d91a7f0542d38a81dc5f27eedf1f3dd094ffcc70", "filename": "tests/ui/parser/mismatched-braces/missing-close-brace-in-impl-trait.stderr", "status": "modified", "additions": 1, "deletions": 24, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-impl-trait.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-impl-trait.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-impl-trait.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -7,28 +7,5 @@ LL | impl T for () {\n LL |\n    |                                                    ^\n \n-error: trait is not supported in `trait`s or `impl`s\n-  --> $DIR/missing-close-brace-in-impl-trait.rs:7:1\n-   |\n-LL | trait T {\n-   | ^^^^^^^\n-   |\n-   = help: consider moving the trait out to a nearby module scope\n-\n-error: struct is not supported in `trait`s or `impl`s\n-  --> $DIR/missing-close-brace-in-impl-trait.rs:11:1\n-   |\n-LL | pub(crate) struct Bar<T>();\n-   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = help: consider moving the struct out to a nearby module scope\n-\n-error[E0405]: cannot find trait `T` in this scope\n-  --> $DIR/missing-close-brace-in-impl-trait.rs:3:6\n-   |\n-LL | impl T for () {\n-   |      ^ not found in this scope\n-\n-error: aborting due to 4 previous errors\n+error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0405`."}, {"sha": "88bc72576877ea7f7ec9062f73049c32bc1e6fc9", "filename": "tests/ui/parser/mismatched-braces/missing-close-brace-in-struct.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-struct.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-struct.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-struct.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,7 +1,7 @@\n pub(crate) struct Bar<T> {\n   foo: T,\n \n-trait T { //~ ERROR expected identifier, found keyword `trait`\n+trait T {\n     fn foo(&self);\n }\n "}, {"sha": "d01d9ed60e4112e6d880aacd6b12722d09f99ae5", "filename": "tests/ui/parser/mismatched-braces/missing-close-brace-in-struct.stderr", "status": "modified", "additions": 1, "deletions": 10, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-struct.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-struct.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-struct.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -7,14 +7,5 @@ LL | pub(crate) struct Bar<T> {\n LL | fn main() {}\n    |                                                                 ^\n \n-error: expected identifier, found keyword `trait`\n-  --> $DIR/missing-close-brace-in-struct.rs:4:1\n-   |\n-LL | pub(crate) struct Bar<T> {\n-   |                   --- while parsing this struct\n-...\n-LL | trait T {\n-   | ^^^^^ expected identifier, found keyword\n-\n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n "}, {"sha": "a05d6aa8edc127e0fe5e67ccf926541a80e36b89", "filename": "tests/ui/parser/mismatched-braces/missing-close-brace-in-trait.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-trait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-trait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-trait.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -2,10 +2,9 @@ trait T {\n     fn foo(&self);\n \n pub(crate) struct Bar<T>();\n-//~^ ERROR struct is not supported in `trait`s or `impl`s\n \n impl T for Bar<usize> {\n-//~^ ERROR implementation is not supported in `trait`s or `impl`s\n+\n fn foo(&self) {}\n }\n "}, {"sha": "7418dd64c9e9148c9c8be1000c992f7481cfd795", "filename": "tests/ui/parser/mismatched-braces/missing-close-brace-in-trait.stderr", "status": "modified", "additions": 2, "deletions": 18, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-trait.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-trait.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fmismatched-braces%2Fmissing-close-brace-in-trait.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,27 +1,11 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/missing-close-brace-in-trait.rs:12:65\n+  --> $DIR/missing-close-brace-in-trait.rs:11:65\n    |\n LL | trait T {\n    |         - unclosed delimiter\n ...\n LL | fn main() {}\n    |                                                                 ^\n \n-error: struct is not supported in `trait`s or `impl`s\n-  --> $DIR/missing-close-brace-in-trait.rs:4:1\n-   |\n-LL | pub(crate) struct Bar<T>();\n-   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = help: consider moving the struct out to a nearby module scope\n-\n-error: implementation is not supported in `trait`s or `impl`s\n-  --> $DIR/missing-close-brace-in-trait.rs:7:1\n-   |\n-LL | impl T for Bar<usize> {\n-   | ^^^^^^^^^^^^^^^^^^^^^\n-   |\n-   = help: consider moving the implementation out to a nearby module scope\n-\n-error: aborting due to 3 previous errors\n+error: aborting due to previous error\n "}, {"sha": "e240f8c6739eed1502e10d15387188060caeac92", "filename": "tests/ui/parser/missing_right_paren.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmissing_right_paren.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmissing_right_paren.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fmissing_right_paren.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,3 +1,4 @@\n // ignore-tidy-trailing-newlines\n-// error-pattern: aborting due to 4 previous errors\n+// error-pattern: this file contains an unclosed delimiter\n+// error-pattern: aborting due to previous error\n fn main((\u063c\n\\ No newline at end of file"}, {"sha": "994ce4d8541c0f70b6f4567f92ef9509c99212f6", "filename": "tests/ui/parser/missing_right_paren.stderr", "status": "modified", "additions": 2, "deletions": 23, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmissing_right_paren.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fmissing_right_paren.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fmissing_right_paren.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,32 +1,11 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/missing_right_paren.rs:3:11\n+  --> $DIR/missing_right_paren.rs:4:11\n    |\n LL | fn main((\u063c\n    |        -- ^\n    |        ||\n    |        |unclosed delimiter\n    |        unclosed delimiter\n \n-error: this file contains an unclosed delimiter\n-  --> $DIR/missing_right_paren.rs:3:11\n-   |\n-LL | fn main((\u063c\n-   |        -- ^\n-   |        ||\n-   |        |unclosed delimiter\n-   |        unclosed delimiter\n-\n-error: expected one of `:` or `|`, found `)`\n-  --> $DIR/missing_right_paren.rs:3:11\n-   |\n-LL | fn main((\u063c\n-   |           ^ expected one of `:` or `|`\n-\n-error: expected one of `->`, `where`, or `{`, found `<eof>`\n-  --> $DIR/missing_right_paren.rs:3:11\n-   |\n-LL | fn main((\u063c\n-   |           ^ expected one of `->`, `where`, or `{`\n-\n-error: aborting due to 4 previous errors\n+error: aborting due to previous error\n "}, {"sha": "5f729665cb8beccde6a99fda4def3d028fadb275", "filename": "tests/ui/parser/parser-recovery-1.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fparser-recovery-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fparser-recovery-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fparser-recovery-1.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -3,11 +3,8 @@\n trait Foo {\n     fn bar() {\n         let x = foo();\n-        //~^ ERROR cannot find function `foo` in this scope\n }\n \n fn main() {\n     let x = y.;\n-    //~^ ERROR unexpected token\n-    //~| ERROR cannot find value `y` in this scope\n } //~ ERROR this file contains an unclosed delimiter"}, {"sha": "7045b6f5b7869b42c205cc73fb46ebc3eaf264e7", "filename": "tests/ui/parser/parser-recovery-1.stderr", "status": "modified", "additions": 3, "deletions": 22, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fparser-recovery-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fparser-recovery-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fparser-recovery-1.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,35 +1,16 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/parser-recovery-1.rs:13:54\n+  --> $DIR/parser-recovery-1.rs:10:54\n    |\n LL | trait Foo {\n    |           - unclosed delimiter\n LL |     fn bar() {\n    |              - this delimiter might not be properly closed...\n-...\n+LL |         let x = foo();\n LL | }\n    | - ...as it matches this but it has different indentation\n ...\n LL | }\n    |                                                      ^\n \n-error: unexpected token: `;`\n-  --> $DIR/parser-recovery-1.rs:10:15\n-   |\n-LL |     let x = y.;\n-   |               ^\n-\n-error[E0425]: cannot find value `y` in this scope\n-  --> $DIR/parser-recovery-1.rs:10:13\n-   |\n-LL |     let x = y.;\n-   |             ^ not found in this scope\n-\n-error[E0425]: cannot find function `foo` in this scope\n-  --> $DIR/parser-recovery-1.rs:5:17\n-   |\n-LL |         let x = foo();\n-   |                 ^^^ not found in this scope\n-\n-error: aborting due to 4 previous errors\n+error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0425`."}, {"sha": "203d8aac66c599a8df34d7585605c93c06f1aafd", "filename": "tests/ui/parser/parser-recovery-2.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fparser-recovery-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fparser-recovery-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fparser-recovery-2.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -2,11 +2,10 @@\n \n trait Foo {\n     fn bar() {\n-        let x = foo(); //~ ERROR cannot find function `foo` in this scope\n+        let x = foo();\n     ) //~ ERROR mismatched closing delimiter: `)`\n }\n \n fn main() {\n-    let x = y.;  //~ ERROR unexpected token\n-                 //~^ ERROR cannot find value `y` in this scope\n+    let x = y.;\n }"}, {"sha": "f396e5fde5badc358b7acf1b98377fce77afcdc5", "filename": "tests/ui/parser/parser-recovery-2.stderr", "status": "modified", "additions": 1, "deletions": 20, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fparser-recovery-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fparser-recovery-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fparser-recovery-2.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,9 +1,3 @@\n-error: unexpected token: `;`\n-  --> $DIR/parser-recovery-2.rs:10:15\n-   |\n-LL |     let x = y.;\n-   |               ^\n-\n error: mismatched closing delimiter: `)`\n   --> $DIR/parser-recovery-2.rs:4:14\n    |\n@@ -13,18 +7,5 @@ LL |         let x = foo();\n LL |     )\n    |     ^ mismatched closing delimiter\n \n-error[E0425]: cannot find value `y` in this scope\n-  --> $DIR/parser-recovery-2.rs:10:13\n-   |\n-LL |     let x = y.;\n-   |             ^ not found in this scope\n-\n-error[E0425]: cannot find function `foo` in this scope\n-  --> $DIR/parser-recovery-2.rs:5:17\n-   |\n-LL |         let x = foo();\n-   |                 ^^^ not found in this scope\n-\n-error: aborting due to 4 previous errors\n+error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0425`."}, {"sha": "4de83ee640a731a33597ab164b0538cd62028477", "filename": "tests/ui/parser/unclosed-delimiter-in-dep.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Funclosed-delimiter-in-dep.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Funclosed-delimiter-in-dep.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Funclosed-delimiter-in-dep.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -2,5 +2,4 @@ mod unclosed_delim_mod;\n \n fn main() {\n     let _: usize = unclosed_delim_mod::new();\n-    //~^ ERROR mismatched types\n }"}, {"sha": "a46d020b9672e13cff2face8c0fc650400acb709", "filename": "tests/ui/parser/unclosed-delimiter-in-dep.stderr", "status": "modified", "additions": 1, "deletions": 13, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Funclosed-delimiter-in-dep.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Funclosed-delimiter-in-dep.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Funclosed-delimiter-in-dep.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -9,17 +9,5 @@ LL |     }\n LL | }\n    | ^ mismatched closing delimiter\n \n-error[E0308]: mismatched types\n-  --> $DIR/unclosed-delimiter-in-dep.rs:4:20\n-   |\n-LL |     let _: usize = unclosed_delim_mod::new();\n-   |            -----   ^^^^^^^^^^^^^^^^^^^^^^^^^ expected `usize`, found `Result<Value, ()>`\n-   |            |\n-   |            expected due to this\n-   |\n-   = note: expected type `usize`\n-              found enum `Result<Value, ()>`\n-\n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0308`."}, {"sha": "fcfe95b26f96b6794b4de62ac5c26a66fc9363eb", "filename": "tests/ui/parser/use-unclosed-brace.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fuse-unclosed-brace.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fuse-unclosed-brace.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fuse-unclosed-brace.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,6 +1,4 @@\n-// error-pattern: expected one of `,`, `::`, `as`, or `}`, found `;`\n // error-pattern: this file contains an unclosed delimiter\n-// error-pattern: expected item, found `}`\n use foo::{bar, baz;\n \n use std::fmt::Display;"}, {"sha": "ad5bb2de1b2562b347920e2f1f691fd77772287f", "filename": "tests/ui/parser/use-unclosed-brace.stderr", "status": "modified", "additions": 2, "deletions": 18, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fuse-unclosed-brace.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fparser%2Fuse-unclosed-brace.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fparser%2Fuse-unclosed-brace.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,27 +1,11 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/use-unclosed-brace.rs:12:14\n+  --> $DIR/use-unclosed-brace.rs:10:14\n    |\n LL | use foo::{bar, baz;\n    |          - unclosed delimiter\n ...\n LL | fn main() {}\n    |              ^\n \n-error: expected one of `,`, `::`, `as`, or `}`, found `;`\n-  --> $DIR/use-unclosed-brace.rs:4:10\n-   |\n-LL | use foo::{bar, baz;\n-   |          ^        ^\n-   |          |        |\n-   |          |        expected one of `,`, `::`, `as`, or `}`\n-   |          |        help: `}` may belong here\n-   |          unclosed delimiter\n-\n-error: expected item, found `}`\n-  --> $DIR/use-unclosed-brace.rs:12:14\n-   |\n-LL | fn main() {}\n-   |              ^ expected item\n-\n-error: aborting due to 3 previous errors\n+error: aborting due to previous error\n "}, {"sha": "a38755dae08580f8a823c3d2ab53202bc3c1f943", "filename": "tests/ui/resolve/token-error-correct-2.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fresolve%2Ftoken-error-correct-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fresolve%2Ftoken-error-correct-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fresolve%2Ftoken-error-correct-2.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -2,6 +2,5 @@\n \n fn main() {\n     if foo {\n-    //~^ ERROR: cannot find value `foo`\n     ) //~ ERROR: mismatched closing delimiter: `)`\n }"}, {"sha": "be5fb18a5d88a57aa9dab238ea68c95b504d41ea", "filename": "tests/ui/resolve/token-error-correct-2.stderr", "status": "modified", "additions": 1, "deletions": 9, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fresolve%2Ftoken-error-correct-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fresolve%2Ftoken-error-correct-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fresolve%2Ftoken-error-correct-2.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -3,16 +3,8 @@ error: mismatched closing delimiter: `)`\n    |\n LL |     if foo {\n    |            ^ unclosed delimiter\n-LL |\n LL |     )\n    |     ^ mismatched closing delimiter\n \n-error[E0425]: cannot find value `foo` in this scope\n-  --> $DIR/token-error-correct-2.rs:4:8\n-   |\n-LL |     if foo {\n-   |        ^^^ not found in this scope\n-\n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0425`."}, {"sha": "2793f1b90ff05ad2ca687f5f9e3eb73be539432a", "filename": "tests/ui/resolve/token-error-correct-3.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fresolve%2Ftoken-error-correct-3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fresolve%2Ftoken-error-correct-3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fresolve%2Ftoken-error-correct-3.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -9,12 +9,9 @@ pub mod raw {\n                                                                callback: F)\n                                                                -> io::Result<bool> {\n         if !is_directory(path.as_ref()) {\n-            //~^ ERROR cannot find function `is_directory`\n             callback(path.as_ref();\n-            //~^ ERROR expected one of\n             fs::create_dir_all(path.as_ref()).map(|()| true)\n-        } else {\n-            //~^ ERROR expected one of `.`, `;`, `?`, `}`, or an operator, found `)`\n+        } else {  //~ ERROR mismatched closing delimiter\n             Ok(false);\n         }\n "}, {"sha": "79d1d4883a13f748d941aa641ed363a1b420169f", "filename": "tests/ui/resolve/token-error-correct-3.stderr", "status": "modified", "additions": 7, "deletions": 19, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fresolve%2Ftoken-error-correct-3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fresolve%2Ftoken-error-correct-3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fresolve%2Ftoken-error-correct-3.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,25 +1,13 @@\n-error: expected one of `)`, `,`, `.`, `?`, or an operator, found `;`\n-  --> $DIR/token-error-correct-3.rs:13:21\n+error: mismatched closing delimiter: `}`\n+  --> $DIR/token-error-correct-3.rs:12:21\n    |\n+LL |         if !is_directory(path.as_ref()) {\n+   |                                         - closing delimiter possibly meant for this\n LL |             callback(path.as_ref();\n-   |                     ^             ^ help: `)` may belong here\n-   |                     |\n-   |                     unclosed delimiter\n-\n-error: expected one of `.`, `;`, `?`, `}`, or an operator, found `)`\n-  --> $DIR/token-error-correct-3.rs:16:9\n-   |\n+   |                     ^ unclosed delimiter\n LL |             fs::create_dir_all(path.as_ref()).map(|()| true)\n-   |                                                             - expected one of `.`, `;`, `?`, `}`, or an operator\n LL |         } else {\n-   |         ^ unexpected token\n-\n-error[E0425]: cannot find function `is_directory` in this scope\n-  --> $DIR/token-error-correct-3.rs:11:13\n-   |\n-LL |         if !is_directory(path.as_ref()) {\n-   |             ^^^^^^^^^^^^ not found in this scope\n+   |         ^ mismatched closing delimiter\n \n-error: aborting due to 3 previous errors\n+error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0425`."}, {"sha": "064b9e74e24fd524ea203b9bbda4150ce99e48e1", "filename": "tests/ui/resolve/token-error-correct-4.fixed", "status": "removed", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/ca1bc7f1f6487991dd6b504d1fddbc982e6b779c/tests%2Fui%2Fresolve%2Ftoken-error-correct-4.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/ca1bc7f1f6487991dd6b504d1fddbc982e6b779c/tests%2Fui%2Fresolve%2Ftoken-error-correct-4.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fresolve%2Ftoken-error-correct-4.fixed?ref=ca1bc7f1f6487991dd6b504d1fddbc982e6b779c", "patch": "@@ -1,10 +0,0 @@\n-// run-rustfix\n-// Test that we do some basic error correction in the tokeniser and apply suggestions.\n-\n-fn setsuna(_: ()) {}\n-\n-fn kazusa() {}\n-\n-fn main() {\n-    setsuna(kazusa()); //~ ERROR: expected one of\n-} //~ ERROR: expected expression"}, {"sha": "49fad4bd97fa16ca2f5e6fb3060004804c734c6e", "filename": "tests/ui/resolve/token-error-correct-4.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fresolve%2Ftoken-error-correct-4.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fresolve%2Ftoken-error-correct-4.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fresolve%2Ftoken-error-correct-4.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,10 +1,9 @@\n-// run-rustfix\n // Test that we do some basic error correction in the tokeniser and apply suggestions.\n \n fn setsuna(_: ()) {}\n \n fn kazusa() {}\n \n fn main() {\n-    setsuna(kazusa(); //~ ERROR: expected one of\n-} //~ ERROR: expected expression\n+    setsuna(kazusa();\n+} //~ ERROR mismatched closing delimiter"}, {"sha": "3ec97171fd327118a2452bf6e84e77b3eace33a4", "filename": "tests/ui/resolve/token-error-correct-4.stderr", "status": "modified", "additions": 7, "deletions": 11, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fresolve%2Ftoken-error-correct-4.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fresolve%2Ftoken-error-correct-4.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fresolve%2Ftoken-error-correct-4.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,16 +1,12 @@\n-error: expected one of `)`, `,`, `.`, `?`, or an operator, found `;`\n-  --> $DIR/token-error-correct-4.rs:9:12\n+error: mismatched closing delimiter: `}`\n+  --> $DIR/token-error-correct-4.rs:8:12\n    |\n+LL | fn main() {\n+   |           - closing delimiter possibly meant for this\n LL |     setsuna(kazusa();\n-   |            ^        ^ help: `)` may belong here\n-   |            |\n-   |            unclosed delimiter\n-\n-error: expected expression, found `)`\n-  --> $DIR/token-error-correct-4.rs:10:1\n-   |\n+   |            ^ unclosed delimiter\n LL | }\n-   | ^ expected expression\n+   | ^ mismatched closing delimiter\n \n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n "}, {"sha": "84ee90e36856c5041a2f93831759eb684f00334a", "filename": "tests/ui/resolve/token-error-correct.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fresolve%2Ftoken-error-correct.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fresolve%2Ftoken-error-correct.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fresolve%2Ftoken-error-correct.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -2,7 +2,6 @@\n \n fn main() {\n     foo(bar(;\n-    //~^ ERROR cannot find function `bar` in this scope\n }\n //~^ ERROR: mismatched closing delimiter: `}`\n "}, {"sha": "35b2d0b323bca3587bebdcab22ea059270152bae", "filename": "tests/ui/resolve/token-error-correct.stderr", "status": "modified", "additions": 1, "deletions": 9, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fresolve%2Ftoken-error-correct.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fresolve%2Ftoken-error-correct.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fresolve%2Ftoken-error-correct.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -5,16 +5,8 @@ LL | fn main() {\n    |           - closing delimiter possibly meant for this\n LL |     foo(bar(;\n    |            ^ unclosed delimiter\n-LL |\n LL | }\n    | ^ mismatched closing delimiter\n \n-error[E0425]: cannot find function `bar` in this scope\n-  --> $DIR/token-error-correct.rs:4:9\n-   |\n-LL |     foo(bar(;\n-   |         ^^^ not found in this scope\n-\n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0425`."}, {"sha": "f20024e759aa376acde69ac37f513d828f36b4f8", "filename": "tests/ui/span/drop-location-span-error-rust-2021-incompatible-closure-captures-93117.rs", "status": "modified", "additions": 3, "deletions": 9, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fspan%2Fdrop-location-span-error-rust-2021-incompatible-closure-captures-93117.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fspan%2Fdrop-location-span-error-rust-2021-incompatible-closure-captures-93117.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fspan%2Fdrop-location-span-error-rust-2021-incompatible-closure-captures-93117.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -3,16 +3,10 @@\n pub struct A {}\n \n impl A {\n-    async fn create(path: impl AsRef<std::path::Path>)  { //~ ERROR  `async fn` is not permitted in Rust 2015\n-    //~^ WARN changes to closure capture in Rust 2021 will affect drop order [rust_2021_incompatible_closure_captures]\n+    async fn create(path: impl AsRef<std::path::Path>)  {\n     ;\n-    crate(move || {} ).await //~ ERROR expected function, found module `crate`\n+    crate(move || {} ).await\n     }\n }\n \n-trait C{async fn new(val: T) {} //~ ERROR  `async fn` is not permitted in Rust 2015\n-//~^ ERROR functions in traits cannot be declared `async`\n-//~| ERROR cannot find type `T` in this scope\n-//~| WARN changes to closure capture in Rust 2021 will affect drop order [rust_2021_incompatible_closure_captures]\n-\n-//~ ERROR  this file contains an unclosed delimiter\n+trait C{async fn new(val: T) {}  //~ ERROR this file contains an unclosed delimiter"}, {"sha": "1ec8ca4275b37769e7e438ae9ee1e9ba8ee2ab97", "filename": "tests/ui/span/drop-location-span-error-rust-2021-incompatible-closure-captures-93117.stderr", "status": "modified", "additions": 3, "deletions": 90, "changes": 93, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fspan%2Fdrop-location-span-error-rust-2021-incompatible-closure-captures-93117.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fspan%2Fdrop-location-span-error-rust-2021-incompatible-closure-captures-93117.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fspan%2Fdrop-location-span-error-rust-2021-incompatible-closure-captures-93117.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,95 +1,8 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/drop-location-span-error-rust-2021-incompatible-closure-captures-93117.rs:18:53\n+  --> $DIR/drop-location-span-error-rust-2021-incompatible-closure-captures-93117.rs:12:85\n    |\n LL | trait C{async fn new(val: T) {}\n-   |        - unclosed delimiter\n-...\n-LL |\n-   |                                                     ^\n+   |        - unclosed delimiter                                                         ^\n \n-error[E0670]: `async fn` is not permitted in Rust 2015\n-  --> $DIR/drop-location-span-error-rust-2021-incompatible-closure-captures-93117.rs:6:5\n-   |\n-LL |     async fn create(path: impl AsRef<std::path::Path>)  {\n-   |     ^^^^^ to use `async fn`, switch to Rust 2018 or later\n-   |\n-   = help: pass `--edition 2021` to `rustc`\n-   = note: for more on editions, read https://doc.rust-lang.org/edition-guide\n-\n-error[E0670]: `async fn` is not permitted in Rust 2015\n-  --> $DIR/drop-location-span-error-rust-2021-incompatible-closure-captures-93117.rs:13:9\n-   |\n-LL | trait C{async fn new(val: T) {}\n-   |         ^^^^^ to use `async fn`, switch to Rust 2018 or later\n-   |\n-   = help: pass `--edition 2021` to `rustc`\n-   = note: for more on editions, read https://doc.rust-lang.org/edition-guide\n-\n-error[E0412]: cannot find type `T` in this scope\n-  --> $DIR/drop-location-span-error-rust-2021-incompatible-closure-captures-93117.rs:13:27\n-   |\n-LL | pub struct A {}\n-   | ------------ similarly named struct `A` defined here\n-...\n-LL | trait C{async fn new(val: T) {}\n-   |                           ^ help: a struct with a similar name exists: `A`\n-\n-error[E0706]: functions in traits cannot be declared `async`\n-  --> $DIR/drop-location-span-error-rust-2021-incompatible-closure-captures-93117.rs:13:9\n-   |\n-LL | trait C{async fn new(val: T) {}\n-   |         -----^^^^^^^^^^^^^^^\n-   |         |\n-   |         `async` because of this\n-   |\n-   = note: `async` trait functions are not currently supported\n-   = note: consider using the `async-trait` crate: https://crates.io/crates/async-trait\n-   = note: see issue #91611 <https://github.com/rust-lang/rust/issues/91611> for more information\n-   = help: add `#![feature(async_fn_in_trait)]` to the crate attributes to enable\n-\n-error[E0423]: expected function, found module `crate`\n-  --> $DIR/drop-location-span-error-rust-2021-incompatible-closure-captures-93117.rs:9:5\n-   |\n-LL |     crate(move || {} ).await\n-   |     ^^^^^ not a function\n-\n-warning: changes to closure capture in Rust 2021 will affect drop order\n-  --> $DIR/drop-location-span-error-rust-2021-incompatible-closure-captures-93117.rs:6:57\n-   |\n-LL |       async fn create(path: impl AsRef<std::path::Path>)  {\n-   |  _____________________----_____________________________-__^\n-   | |                     |                                |\n-   | |                     |                                in Rust 2018, `path` is dropped here along with the closure, but in Rust 2021 `path` is not part of the closure\n-   | |                     in Rust 2018, this causes the closure to capture `path`, but in Rust 2021, it has no effect\n-LL | |\n-LL | |     ;\n-LL | |     crate(move || {} ).await\n-LL | |     }\n-   | |_____^\n-   |\n-   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/disjoint-capture-in-closures.html>\n-   = note: requested on the command line with `-W rust-2021-incompatible-closure-captures`\n-help: add a dummy let to cause `path` to be fully captured\n-   |\n-LL |     async fn create(path: impl AsRef<std::path::Path>)  { let _ = &path;\n-   |                                                           ++++++++++++++\n-\n-warning: changes to closure capture in Rust 2021 will affect drop order\n-  --> $DIR/drop-location-span-error-rust-2021-incompatible-closure-captures-93117.rs:13:30\n-   |\n-LL | trait C{async fn new(val: T) {}\n-   |                      ---   - ^^\n-   |                      |     |\n-   |                      |     in Rust 2018, `val` is dropped here along with the closure, but in Rust 2021 `val` is not part of the closure\n-   |                      in Rust 2018, this causes the closure to capture `val`, but in Rust 2021, it has no effect\n-   |\n-   = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2021/disjoint-capture-in-closures.html>\n-help: add a dummy let to cause `val` to be fully captured\n-   |\n-LL | trait C{async fn new(val: T) { let _ = &val;}\n-   |                                +++++++++++++\n-\n-error: aborting due to 6 previous errors; 2 warnings emitted\n+error: aborting due to previous error\n \n-Some errors have detailed explanations: E0412, E0423, E0670, E0706.\n-For more information about an error, try `rustc --explain E0412`."}, {"sha": "d6e5263ffe0a82d712899bf62db709fe308654bc", "filename": "tests/ui/suggestions/constrain-suggest-ice.rs", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fsuggestions%2Fconstrain-suggest-ice.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fsuggestions%2Fconstrain-suggest-ice.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsuggestions%2Fconstrain-suggest-ice.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,11 +1,9 @@\n-struct Bug<S>{ //~ ERROR parameter `S` is never used [E0392]\n+struct Bug<S>{\n     A: [(); {\n-        let x: [u8; Self::W] = [0; Self::W]; //~ ERROR generic `Self` types are currently not permitted in anonymous constants\n-        //~^ ERROR generic `Self` types are currently not permitted in anonymous constants\n-        //~^^ ERROR the size for values of type `S` cannot be known at compilation time [E0277]\n-        F //~ ERROR cannot find value `F` in this scope [E0425]\n+        let x: [u8; Self::W] = [0; Self::W];\n+        F\n     }\n-} //~ ERROR mismatched closing delimiter: `}`\n+}\n //~^ ERROR mismatched closing delimiter: `}`\n \n fn main() {}"}, {"sha": "9b92091de9f54610d123bf598364c7440d78261d", "filename": "tests/ui/suggestions/constrain-suggest-ice.stderr", "status": "modified", "additions": 1, "deletions": 60, "changes": 61, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fsuggestions%2Fconstrain-suggest-ice.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Fsuggestions%2Fconstrain-suggest-ice.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fsuggestions%2Fconstrain-suggest-ice.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -9,64 +9,5 @@ LL |     A: [(); {\n LL | }\n    | ^ mismatched closing delimiter\n \n-error: mismatched closing delimiter: `}`\n-  --> $DIR/constrain-suggest-ice.rs:2:8\n-   |\n-LL | struct Bug<S>{\n-   |              - closing delimiter possibly meant for this\n-LL |     A: [(); {\n-   |        ^ unclosed delimiter\n-...\n-LL | }\n-   | ^ mismatched closing delimiter\n-\n-error[E0425]: cannot find value `F` in this scope\n-  --> $DIR/constrain-suggest-ice.rs:6:9\n-   |\n-LL |         F\n-   |         ^ help: a local variable with a similar name exists: `x`\n-\n-error: generic `Self` types are currently not permitted in anonymous constants\n-  --> $DIR/constrain-suggest-ice.rs:3:21\n-   |\n-LL |         let x: [u8; Self::W] = [0; Self::W];\n-   |                     ^^^^\n-\n-error: generic `Self` types are currently not permitted in anonymous constants\n-  --> $DIR/constrain-suggest-ice.rs:3:36\n-   |\n-LL |         let x: [u8; Self::W] = [0; Self::W];\n-   |                                    ^^^^\n-\n-error[E0277]: the size for values of type `S` cannot be known at compilation time\n-  --> $DIR/constrain-suggest-ice.rs:3:36\n-   |\n-LL | struct Bug<S>{\n-   |            - this type parameter needs to be `std::marker::Sized`\n-LL |     A: [(); {\n-LL |         let x: [u8; Self::W] = [0; Self::W];\n-   |                                    ^^^^^^^ doesn't have a size known at compile-time\n-   |\n-note: required by a bound in `Bug`\n-  --> $DIR/constrain-suggest-ice.rs:1:12\n-   |\n-LL | struct Bug<S>{\n-   |            ^ required by this bound in `Bug`\n-help: consider relaxing the implicit `Sized` restriction\n-   |\n-LL | struct Bug<S: ?Sized>{\n-   |             ++++++++\n-\n-error[E0392]: parameter `S` is never used\n-  --> $DIR/constrain-suggest-ice.rs:1:12\n-   |\n-LL | struct Bug<S>{\n-   |            ^ unused parameter\n-   |\n-   = help: consider removing `S`, referring to it in a field, or using a marker such as `PhantomData`\n-   = help: if you intended `S` to be a const parameter, use `const S: usize` instead\n-\n-error: aborting due to 7 previous errors\n+error: aborting due to previous error\n \n-Some errors have detailed explanations: E0277, E0392, E0425.\n-For more information about an error, try `rustc --explain E0277`."}, {"sha": "9830241c3770cc7926acb4e78a477dd94af4bf57", "filename": "tests/ui/traits/non_lifetime_binders/object-lifetime-default-for-late.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Ftraits%2Fnon_lifetime_binders%2Fobject-lifetime-default-for-late.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Ftraits%2Fnon_lifetime_binders%2Fobject-lifetime-default-for-late.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftraits%2Fnon_lifetime_binders%2Fobject-lifetime-default-for-late.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -0,0 +1,7 @@\n+// check-pass\n+// compile-flags: --crate-type=lib\n+\n+#![feature(non_lifetime_binders)]\n+//~^ WARN the feature `non_lifetime_binders` is incomplete\n+\n+pub fn f<T>() where for<U> (T, U): Copy {}"}, {"sha": "667575b72d4cb6758133d1076d99be4c84b3621b", "filename": "tests/ui/traits/non_lifetime_binders/object-lifetime-default-for-late.stderr", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Ftraits%2Fnon_lifetime_binders%2Fobject-lifetime-default-for-late.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Ftraits%2Fnon_lifetime_binders%2Fobject-lifetime-default-for-late.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftraits%2Fnon_lifetime_binders%2Fobject-lifetime-default-for-late.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -0,0 +1,11 @@\n+warning: the feature `non_lifetime_binders` is incomplete and may not be safe to use and/or cause compiler crashes\n+  --> $DIR/object-lifetime-default-for-late.rs:4:12\n+   |\n+LL | #![feature(non_lifetime_binders)]\n+   |            ^^^^^^^^^^^^^^^^^^^^\n+   |\n+   = note: see issue #108185 <https://github.com/rust-lang/rust/issues/108185> for more information\n+   = note: `#[warn(incomplete_features)]` on by default\n+\n+warning: 1 warning emitted\n+"}, {"sha": "274ea839e8bddb5b7927387a47844697258fed1c", "filename": "tests/ui/type/issue-91268.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Ftype%2Fissue-91268.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Ftype%2Fissue-91268.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftype%2Fissue-91268.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,8 +1,4 @@\n // error-pattern: this file contains an unclosed delimiter\n-// error-pattern: cannot find type `\u0163` in this scope\n-// error-pattern: parenthesized type parameters may only be used with a `Fn` trait\n-// error-pattern: type arguments are not allowed on builtin type `u8`\n-// error-pattern: mismatched types\n // ignore-tidy-trailing-newlines\n // `\u0163` must be the last character in this file, it cannot be followed by a newline\n fn main() {"}, {"sha": "a3619d863e259a3d43b6f0ccdfdb9796b8e8e21b", "filename": "tests/ui/type/issue-91268.stderr", "status": "modified", "additions": 2, "deletions": 53, "changes": 55, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Ftype%2Fissue-91268.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Ftype%2Fissue-91268.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftype%2Fissue-91268.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,5 +1,5 @@\n error: this file contains an unclosed delimiter\n-  --> $DIR/issue-91268.rs:9:12\n+  --> $DIR/issue-91268.rs:5:12\n    |\n LL | fn main() {\n    |           - unclosed delimiter\n@@ -8,56 +8,5 @@ LL |     0: u8(\u0163\n    |          |\n    |          unclosed delimiter\n \n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-91268.rs:9:12\n-   |\n-LL | fn main() {\n-   |           - unclosed delimiter\n-LL |     0: u8(\u0163\n-   |          - ^\n-   |          |\n-   |          unclosed delimiter\n-\n-error[E0412]: cannot find type `\u0163` in this scope\n-  --> $DIR/issue-91268.rs:9:11\n-   |\n-LL |     0: u8(\u0163\n-   |           ^ expecting a type here because of type ascription\n-\n-error[E0214]: parenthesized type parameters may only be used with a `Fn` trait\n-  --> $DIR/issue-91268.rs:9:8\n-   |\n-LL |     0: u8(\u0163\n-   |        ^^^^ only `Fn` traits may use parentheses\n-   |\n-help: use angle brackets instead\n-   |\n-LL |     0: u8<\u0163>\n-   |          ~ +\n-\n-error[E0109]: type arguments are not allowed on builtin type `u8`\n-  --> $DIR/issue-91268.rs:9:11\n-   |\n-LL |     0: u8(\u0163\n-   |        -- ^ type argument not allowed\n-   |        |\n-   |        not allowed on builtin type `u8`\n-   |\n-help: primitive type `u8` doesn't have generic parameters\n-   |\n-LL -     0: u8(\u0163\n-LL +     0: u8\n-   |\n-\n-error[E0308]: mismatched types\n-  --> $DIR/issue-91268.rs:9:5\n-   |\n-LL | fn main() {\n-   |           - expected `()` because of default return type\n-LL |     0: u8(\u0163\n-   |     ^^^^^^^ expected `()`, found `u8`\n-\n-error: aborting due to 6 previous errors\n+error: aborting due to previous error\n \n-Some errors have detailed explanations: E0109, E0214, E0308, E0412.\n-For more information about an error, try `rustc --explain E0109`."}, {"sha": "29204276bb3a551d908e151875fc981943330d10", "filename": "tests/ui/typeck/issue-91334.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Ftypeck%2Fissue-91334.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Ftypeck%2Fissue-91334.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftypeck%2Fissue-91334.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,9 +1,6 @@\n // Regression test for the ICE described in issue #91334.\n \n // error-pattern: this file contains an unclosed delimiter\n-// error-pattern: expected one of\n-// error-pattern: mismatched closing delimiter\n-// error-pattern: mismatched types\n \n #![feature(generators)]\n "}, {"sha": "7cb30eea530c6043e9f7c61f99f26d544eb58c36", "filename": "tests/ui/typeck/issue-91334.stderr", "status": "modified", "additions": 8, "deletions": 39, "changes": 47, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Ftypeck%2Fissue-91334.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Ftypeck%2Fissue-91334.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftypeck%2Fissue-91334.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,15 +1,14 @@\n-error: this file contains an unclosed delimiter\n-  --> $DIR/issue-91334.rs:10:23\n+error: mismatched closing delimiter: `)`\n+  --> $DIR/issue-91334.rs:7:19\n    |\n LL | fn f(){||yield(((){),\n-   |       -       -    -  ^\n-   |       |       |    |\n-   |       |       |    missing open `(` for this delimiter\n-   |       |       unclosed delimiter\n-   |       unclosed delimiter\n+   |                -  ^^ mismatched closing delimiter\n+   |                |  |\n+   |                |  unclosed delimiter\n+   |                closing delimiter possibly meant for this\n \n error: this file contains an unclosed delimiter\n-  --> $DIR/issue-91334.rs:10:23\n+  --> $DIR/issue-91334.rs:7:23\n    |\n LL | fn f(){||yield(((){),\n    |       -       -    -  ^\n@@ -18,35 +17,5 @@ LL | fn f(){||yield(((){),\n    |       |       unclosed delimiter\n    |       unclosed delimiter\n \n-error: expected one of `)`, `,`, `.`, `?`, or an operator, found `{`\n-  --> $DIR/issue-91334.rs:10:19\n-   |\n-LL | fn f(){||yield(((){),\n-   |                   ^\n-   |                   |\n-   |                   expected one of `)`, `,`, `.`, `?`, or an operator\n-   |                   help: missing `,`\n-\n-error: mismatched closing delimiter: `)`\n-  --> $DIR/issue-91334.rs:10:19\n-   |\n-LL | fn f(){||yield(((){),\n-   |                -  ^^ mismatched closing delimiter\n-   |                |  |\n-   |                |  unclosed delimiter\n-   |                closing delimiter possibly meant for this\n-\n-error[E0308]: mismatched types\n-  --> $DIR/issue-91334.rs:10:8\n-   |\n-LL | fn f(){||yield(((){),\n-   |       -^^^^^^^^^^^^^^^ expected `()`, found generator\n-   |       |\n-   |       help: a return type might be missing here: `-> _`\n-   |\n-   = note: expected unit type `()`\n-              found generator `[generator@$DIR/issue-91334.rs:10:8: 10:10]`\n-\n-error: aborting due to 5 previous errors\n+error: aborting due to 2 previous errors\n \n-For more information about this error, try `rustc --explain E0308`."}, {"sha": "f752400bbcbb6a5ce087c490cd0004fc80a9b6cb", "filename": "tests/ui/typeck/issue-92481.rs", "status": "modified", "additions": 2, "deletions": 7, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Ftypeck%2Fissue-92481.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Ftypeck%2Fissue-92481.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftypeck%2Fissue-92481.rs?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -2,13 +2,8 @@\n \n #![crate_type=\"lib\"]\n \n-fn r({) {\n-    Ok {             //~ ERROR mismatched types [E0308]\n+fn r({) { //~ ERROR mismatched closing delimiter\n+    Ok {\n         d..||_=m\n     }\n }\n-//~^^^^^ ERROR expected parameter name, found `{`\n-//~| ERROR expected one of `,`, `:`, or `}`, found `..`\n-//~^^^^^ ERROR cannot find value `d` in this scope [E0425]\n-//~| ERROR cannot find value `m` in this scope [E0425]\n-//~| ERROR variant `Result<_, _>::Ok` has no field named `d` [E0559]"}, {"sha": "d87d3277d563a3157774c8f0fe6b54be5a7b0740", "filename": "tests/ui/typeck/issue-92481.stderr", "status": "modified", "additions": 6, "deletions": 55, "changes": 61, "blob_url": "https://github.com/rust-lang/rust/blob/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Ftypeck%2Fissue-92481.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/5983a3a99ea631da9d7d1ce510a6761913f92a89/tests%2Fui%2Ftypeck%2Fissue-92481.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Ftypeck%2Fissue-92481.stderr?ref=5983a3a99ea631da9d7d1ce510a6761913f92a89", "patch": "@@ -1,60 +1,11 @@\n-error: expected parameter name, found `{`\n+error: mismatched closing delimiter: `)`\n   --> $DIR/issue-92481.rs:5:6\n    |\n LL | fn r({) {\n-   |      ^ expected parameter name\n+   |     -^^ mismatched closing delimiter\n+   |     ||\n+   |     |unclosed delimiter\n+   |     closing delimiter possibly meant for this\n \n-error: expected one of `,`, `:`, or `}`, found `..`\n-  --> $DIR/issue-92481.rs:5:6\n-   |\n-LL | fn r({) {\n-   |      ^ unclosed delimiter\n-LL |     Ok {\n-LL |         d..||_=m\n-   |          -^\n-   |          |\n-   |          help: `}` may belong here\n-\n-error[E0425]: cannot find value `d` in this scope\n-  --> $DIR/issue-92481.rs:7:9\n-   |\n-LL |         d..||_=m\n-   |         ^ not found in this scope\n-\n-error[E0425]: cannot find value `m` in this scope\n-  --> $DIR/issue-92481.rs:7:16\n-   |\n-LL |         d..||_=m\n-   |                ^ not found in this scope\n-\n-error[E0559]: variant `Result<_, _>::Ok` has no field named `d`\n-  --> $DIR/issue-92481.rs:7:9\n-   |\n-LL |         d..||_=m\n-   |         ^ field does not exist\n-  --> $SRC_DIR/core/src/result.rs:LL:COL\n-   |\n-   = note: `Result<_, _>::Ok` defined here\n-   |\n-help: `Result<_, _>::Ok` is a tuple variant, use the appropriate syntax\n-   |\n-LL |     Result<_, _>::Ok(/* fields */)\n-   |\n-\n-error[E0308]: mismatched types\n-  --> $DIR/issue-92481.rs:6:5\n-   |\n-LL |   fn r({) {\n-   |           - help: a return type might be missing here: `-> _`\n-LL | /     Ok {\n-LL | |         d..||_=m\n-LL | |     }\n-   | |_____^ expected `()`, found `Result<_, _>`\n-   |\n-   = note: expected unit type `()`\n-                   found enum `Result<_, _>`\n-\n-error: aborting due to 6 previous errors\n+error: aborting due to previous error\n \n-Some errors have detailed explanations: E0308, E0425, E0559.\n-For more information about an error, try `rustc --explain E0308`."}]}