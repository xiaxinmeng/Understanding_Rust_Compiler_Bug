{"sha": "6fdf6377cc3695fd403a69760a4fff5278b31a58", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZmZGY2Mzc3Y2MzNjk1ZmQ0MDNhNjk3NjBhNGZmZjUyNzhiMzFhNTg=", "commit": {"author": {"name": "Pramod Bisht", "email": "pramodpsb@outlook.com", "date": "2018-02-27T19:55:38Z"}, "committer": {"name": "Pramod Bisht", "email": "pramodpsb@outlook.com", "date": "2018-03-04T14:57:55Z"}, "message": "Fixed #48425", "tree": {"sha": "3fa3d6aeaa3fadb63d853b38e16217ff46555462", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3fa3d6aeaa3fadb63d853b38e16217ff46555462"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6fdf6377cc3695fd403a69760a4fff5278b31a58", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6fdf6377cc3695fd403a69760a4fff5278b31a58", "html_url": "https://github.com/rust-lang/rust/commit/6fdf6377cc3695fd403a69760a4fff5278b31a58", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6fdf6377cc3695fd403a69760a4fff5278b31a58/comments", "author": {"login": "PramodBisht", "id": 2766842, "node_id": "MDQ6VXNlcjI3NjY4NDI=", "avatar_url": "https://avatars.githubusercontent.com/u/2766842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PramodBisht", "html_url": "https://github.com/PramodBisht", "followers_url": "https://api.github.com/users/PramodBisht/followers", "following_url": "https://api.github.com/users/PramodBisht/following{/other_user}", "gists_url": "https://api.github.com/users/PramodBisht/gists{/gist_id}", "starred_url": "https://api.github.com/users/PramodBisht/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PramodBisht/subscriptions", "organizations_url": "https://api.github.com/users/PramodBisht/orgs", "repos_url": "https://api.github.com/users/PramodBisht/repos", "events_url": "https://api.github.com/users/PramodBisht/events{/privacy}", "received_events_url": "https://api.github.com/users/PramodBisht/received_events", "type": "User", "site_admin": false}, "committer": {"login": "PramodBisht", "id": 2766842, "node_id": "MDQ6VXNlcjI3NjY4NDI=", "avatar_url": "https://avatars.githubusercontent.com/u/2766842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PramodBisht", "html_url": "https://github.com/PramodBisht", "followers_url": "https://api.github.com/users/PramodBisht/followers", "following_url": "https://api.github.com/users/PramodBisht/following{/other_user}", "gists_url": "https://api.github.com/users/PramodBisht/gists{/gist_id}", "starred_url": "https://api.github.com/users/PramodBisht/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PramodBisht/subscriptions", "organizations_url": "https://api.github.com/users/PramodBisht/orgs", "repos_url": "https://api.github.com/users/PramodBisht/repos", "events_url": "https://api.github.com/users/PramodBisht/events{/privacy}", "received_events_url": "https://api.github.com/users/PramodBisht/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9ff5cb5aea98d3f5ccc5a66aa8fd36fb43dcb55d", "url": "https://api.github.com/repos/rust-lang/rust/commits/9ff5cb5aea98d3f5ccc5a66aa8fd36fb43dcb55d", "html_url": "https://github.com/rust-lang/rust/commit/9ff5cb5aea98d3f5ccc5a66aa8fd36fb43dcb55d"}], "stats": {"total": 22, "additions": 11, "deletions": 11}, "files": [{"sha": "5069c59562678a722926951c82222e89aa2b102c", "filename": "src/librustc/ty/layout.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/6fdf6377cc3695fd403a69760a4fff5278b31a58/src%2Flibrustc%2Fty%2Flayout.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6fdf6377cc3695fd403a69760a4fff5278b31a58/src%2Flibrustc%2Fty%2Flayout.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Flayout.rs?ref=6fdf6377cc3695fd403a69760a4fff5278b31a58", "patch": "@@ -1203,7 +1203,7 @@ impl<'a, 'tcx> LayoutCx<'tcx, TyCtxt<'a, 'tcx, 'tcx>> {\n                 }\n \n                 let pointee = tcx.normalize_associated_type_in_env(&pointee, param_env);\n-                if pointee.is_sized(tcx, param_env, DUMMY_SP) {\n+                if pointee.is_sized(tcx.at(DUMMY_SP), param_env) {\n                     return Ok(tcx.intern_layout(LayoutDetails::scalar(self, data_ptr)));\n                 }\n \n@@ -1428,7 +1428,7 @@ impl<'a, 'tcx> LayoutCx<'tcx, TyCtxt<'a, 'tcx, 'tcx>> {\n                         let param_env = tcx.param_env(def.did);\n                         let last_field = def.variants[v].fields.last().unwrap();\n                         let always_sized = tcx.type_of(last_field.did)\n-                          .is_sized(tcx, param_env, DUMMY_SP);\n+                          .is_sized(tcx.at(DUMMY_SP), param_env);\n                         if !always_sized { StructKind::MaybeUnsized }\n                         else { StructKind::AlwaysSized }\n                     };"}, {"sha": "3a5e6d97cd4ba834733586fefbaba36b331cf3c4", "filename": "src/librustc/ty/util.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/6fdf6377cc3695fd403a69760a4fff5278b31a58/src%2Flibrustc%2Fty%2Futil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6fdf6377cc3695fd403a69760a4fff5278b31a58/src%2Flibrustc%2Fty%2Futil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Futil.rs?ref=6fdf6377cc3695fd403a69760a4fff5278b31a58", "patch": "@@ -20,6 +20,7 @@ use traits::{self, Reveal};\n use ty::{self, Ty, TyCtxt, TypeFoldable};\n use ty::fold::TypeVisitor;\n use ty::subst::{Subst, UnpackedKind};\n+use ty::maps::TyCtxtAt;\n use ty::TypeVariants::*;\n use util::common::ErrorReported;\n use middle::lang_items;\n@@ -864,11 +865,10 @@ impl<'a, 'tcx> ty::TyS<'tcx> {\n     }\n \n     pub fn is_sized(&'tcx self,\n-                    tcx: TyCtxt<'a, 'tcx, 'tcx>,\n-                    param_env: ty::ParamEnv<'tcx>,\n-                    span: Span)-> bool\n+                    tcx_at: TyCtxtAt<'a, 'tcx, 'tcx>,\n+                    param_env: ty::ParamEnv<'tcx>)-> bool\n     {\n-        tcx.at(span).is_sized_raw(param_env.and(self))\n+        tcx_at.is_sized_raw(param_env.and(self))\n     }\n \n     pub fn is_freeze(&'tcx self,"}, {"sha": "1feecba60088b33909135794b723b897e948305c", "filename": "src/librustc_mir/borrow_check/nll/type_check/mod.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6fdf6377cc3695fd403a69760a4fff5278b31a58/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Ftype_check%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6fdf6377cc3695fd403a69760a4fff5278b31a58/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Ftype_check%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fborrow_check%2Fnll%2Ftype_check%2Fmod.rs?ref=6fdf6377cc3695fd403a69760a4fff5278b31a58", "patch": "@@ -1208,7 +1208,7 @@ impl<'a, 'gcx, 'tcx> TypeChecker<'a, 'gcx, 'tcx> {\n         // shouldn't affect `is_sized`.\n         let gcx = self.tcx().global_tcx();\n         let erased_ty = gcx.lift(&self.tcx().erase_regions(&ty)).unwrap();\n-        if !erased_ty.is_sized(gcx, self.param_env, span) {\n+        if !erased_ty.is_sized(gcx.at(span), self.param_env) {\n             // in current MIR construction, all non-control-flow rvalue\n             // expressions evaluate through `as_temp` or `into` a return\n             // slot or local, so to find all unsized rvalues it is enough"}, {"sha": "25f933c5da6e7ce6742aae078413cb3107d2292c", "filename": "src/librustc_mir/interpret/eval_context.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6fdf6377cc3695fd403a69760a4fff5278b31a58/src%2Flibrustc_mir%2Finterpret%2Feval_context.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6fdf6377cc3695fd403a69760a4fff5278b31a58/src%2Flibrustc_mir%2Finterpret%2Feval_context.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Finterpret%2Feval_context.rs?ref=6fdf6377cc3695fd403a69760a4fff5278b31a58", "patch": "@@ -286,7 +286,7 @@ impl<'a, 'tcx, M: Machine<'tcx>> EvalContext<'a, 'tcx, M> {\n     }\n \n     pub(super) fn type_is_sized(&self, ty: Ty<'tcx>) -> bool {\n-        ty.is_sized(self.tcx, self.param_env, DUMMY_SP)\n+        ty.is_sized(self.tcx.at(DUMMY_SP), self.param_env)\n     }\n \n     pub fn load_mir("}, {"sha": "501a9f4b1efc3c352fa1cfdb526fd99144b19f7b", "filename": "src/librustc_mir/monomorphize/collector.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6fdf6377cc3695fd403a69760a4fff5278b31a58/src%2Flibrustc_mir%2Fmonomorphize%2Fcollector.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6fdf6377cc3695fd403a69760a4fff5278b31a58/src%2Flibrustc_mir%2Fmonomorphize%2Fcollector.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fmonomorphize%2Fcollector.rs?ref=6fdf6377cc3695fd403a69760a4fff5278b31a58", "patch": "@@ -796,7 +796,7 @@ fn find_vtable_types_for_unsizing<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n     let ptr_vtable = |inner_source: Ty<'tcx>, inner_target: Ty<'tcx>| {\n         let type_has_metadata = |ty: Ty<'tcx>| -> bool {\n             use syntax_pos::DUMMY_SP;\n-            if ty.is_sized(tcx, ty::ParamEnv::empty(traits::Reveal::All), DUMMY_SP) {\n+            if ty.is_sized(tcx.at(DUMMY_SP), ty::ParamEnv::empty(traits::Reveal::All)) {\n                 return false;\n             }\n             let tail = tcx.struct_tail(ty);"}, {"sha": "7c4e2340d5bdc4dcaecf9f8ede17c813096c80dc", "filename": "src/librustc_trans/common.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6fdf6377cc3695fd403a69760a4fff5278b31a58/src%2Flibrustc_trans%2Fcommon.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6fdf6377cc3695fd403a69760a4fff5278b31a58/src%2Flibrustc_trans%2Fcommon.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fcommon.rs?ref=6fdf6377cc3695fd403a69760a4fff5278b31a58", "patch": "@@ -44,7 +44,7 @@ pub fn type_needs_drop<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>, ty: Ty<'tcx>) -> b\n }\n \n pub fn type_is_sized<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>, ty: Ty<'tcx>) -> bool {\n-    ty.is_sized(tcx, ty::ParamEnv::empty(traits::Reveal::All), DUMMY_SP)\n+    ty.is_sized(tcx.at(DUMMY_SP), ty::ParamEnv::empty(traits::Reveal::All))\n }\n \n pub fn type_is_freeze<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>, ty: Ty<'tcx>) -> bool {"}, {"sha": "1a35a3d9b403876da5f3bb299fd8b06afe35cbf7", "filename": "src/librustc_trans/context.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/6fdf6377cc3695fd403a69760a4fff5278b31a58/src%2Flibrustc_trans%2Fcontext.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6fdf6377cc3695fd403a69760a4fff5278b31a58/src%2Flibrustc_trans%2Fcontext.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fcontext.rs?ref=6fdf6377cc3695fd403a69760a4fff5278b31a58", "patch": "@@ -435,7 +435,7 @@ impl<'b, 'tcx> CodegenCx<'b, 'tcx> {\n \n     pub fn type_has_metadata(&self, ty: Ty<'tcx>) -> bool {\n         use syntax_pos::DUMMY_SP;\n-        if ty.is_sized(self.tcx, ty::ParamEnv::empty(traits::Reveal::All), DUMMY_SP) {\n+        if ty.is_sized(self.tcx.at(DUMMY_SP), ty::ParamEnv::empty(traits::Reveal::All)) {\n             return false;\n         }\n "}]}