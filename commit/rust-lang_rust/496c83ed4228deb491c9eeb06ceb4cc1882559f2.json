{"sha": "496c83ed4228deb491c9eeb06ceb4cc1882559f2", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ5NmM4M2VkNDIyOGRlYjQ5MWM5ZWViMDZjZWI0Y2MxODgyNTU5ZjI=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-10-21T07:19:17Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-10-21T07:19:17Z"}, "message": "Auto merge of #1589 - Aaron1011:enable-normal-backtrace, r=RalfJung\n\nEnable `backtrace` feature in the generated `Xargo.toml`\n\nThis allows the normal std panic hook to print a backtrace if\n`RUST_BACKTRACE=1` and `-Z miri-disable-isolation` are set", "tree": {"sha": "c22b8668c323e667c02ec1433c5f8f903350a250", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c22b8668c323e667c02ec1433c5f8f903350a250"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/496c83ed4228deb491c9eeb06ceb4cc1882559f2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/496c83ed4228deb491c9eeb06ceb4cc1882559f2", "html_url": "https://github.com/rust-lang/rust/commit/496c83ed4228deb491c9eeb06ceb4cc1882559f2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/496c83ed4228deb491c9eeb06ceb4cc1882559f2/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cc21740684cfa524e347ead06700b6906af202ce", "url": "https://api.github.com/repos/rust-lang/rust/commits/cc21740684cfa524e347ead06700b6906af202ce", "html_url": "https://github.com/rust-lang/rust/commit/cc21740684cfa524e347ead06700b6906af202ce"}, {"sha": "05bb560de2fc0911a9b03a6f015770695f37c0ff", "url": "https://api.github.com/repos/rust-lang/rust/commits/05bb560de2fc0911a9b03a6f015770695f37c0ff", "html_url": "https://github.com/rust-lang/rust/commit/05bb560de2fc0911a9b03a6f015770695f37c0ff"}], "stats": {"total": 56, "additions": 54, "deletions": 2}, "files": [{"sha": "d41dc862e59995b9f98f011a56afb4904f08308c", "filename": "README.md", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/496c83ed4228deb491c9eeb06ceb4cc1882559f2/README.md", "raw_url": "https://github.com/rust-lang/rust/raw/496c83ed4228deb491c9eeb06ceb4cc1882559f2/README.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/README.md?ref=496c83ed4228deb491c9eeb06ceb4cc1882559f2", "patch": "@@ -152,6 +152,19 @@ cargo miri test\n When using the above instructions, you may encounter a number of confusing compiler\n errors.\n \n+### \"note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\"\n+\n+You may see this when trying to get Miri to display a backtrace. By default, Miri\n+doesn't expose any environment to the program, so running\n+`RUST_BACKTRACE=1 cargo miri test` will not do what you expect.\n+\n+To get a backtrace, you need to disable isolation\n+[using `-Zmiri-disable-isolation`](#miri-flags):\n+\n+```sh\n+RUST_BACKTRACE=1 MIRIFLAGS=\"-Zmiri-disable-isolation\" cargo miri test\n+```\n+\n #### \"found possibly newer version of crate `std` which `<dependency>` depends on\"\n \n Your build directory may contain artifacts from an earlier build that have/have"}, {"sha": "62fb9299c4563449ce818cd4fb41d7d9e2885a5d", "filename": "cargo-miri/bin.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/496c83ed4228deb491c9eeb06ceb4cc1882559f2/cargo-miri%2Fbin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/496c83ed4228deb491c9eeb06ceb4cc1882559f2/cargo-miri%2Fbin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/cargo-miri%2Fbin.rs?ref=496c83ed4228deb491c9eeb06ceb4cc1882559f2", "patch": "@@ -296,7 +296,7 @@ fn setup(subcommand: MiriCommand) {\n [dependencies.std]\n default_features = false\n # We support unwinding, so enable that panic runtime.\n-features = [\"panic_unwind\"]\n+features = [\"panic_unwind\", \"backtrace\"]\n \n [dependencies.test]\n \"#,"}, {"sha": "7060411278e6e7e515138f96c5741bcba659fc41", "filename": "tests/run-pass/concurrency/simple.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fconcurrency%2Fsimple.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fconcurrency%2Fsimple.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fconcurrency%2Fsimple.stderr?ref=496c83ed4228deb491c9eeb06ceb4cc1882559f2", "patch": "@@ -1,4 +1,5 @@\n warning: thread support is experimental. For example, Miri does not detect data races yet.\n \n thread '<unnamed>' panicked at 'Hello!', $DIR/simple.rs:54:9\n+note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\n thread 'childthread' panicked at 'Hello, world!', $DIR/simple.rs:64:9"}, {"sha": "30c7767b5642b6c48cb09971a460757360bd0c83", "filename": "tests/run-pass/panic/catch_panic.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Fcatch_panic.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Fcatch_panic.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fpanic%2Fcatch_panic.stderr?ref=496c83ed4228deb491c9eeb06ceb4cc1882559f2", "patch": "@@ -1,4 +1,5 @@\n thread 'main' panicked at 'Hello from panic: std', $DIR/catch_panic.rs:LL:27\n+note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\n Caught panic message (&str): Hello from panic: std\n thread 'main' panicked at 'Hello from panic: 1', $DIR/catch_panic.rs:LL:26\n Caught panic message (String): Hello from panic: 1"}, {"sha": "eb5b5f59a0cb15976d272f297199fc41d2c24c84", "filename": "tests/run-pass/panic/concurrent-panic.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Fconcurrent-panic.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Fconcurrent-panic.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fpanic%2Fconcurrent-panic.stderr?ref=496c83ed4228deb491c9eeb06ceb4cc1882559f2", "patch": "@@ -3,6 +3,7 @@ warning: thread support is experimental. For example, Miri does not detect data\n Thread 1 starting, will block on mutex\n Thread 1 reported it has started\n thread '<unnamed>' panicked at 'panic in thread 2', $DIR/concurrent-panic.rs:65:13\n+note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\n Thread 2 blocking on thread 1\n Thread 2 reported it has started\n Unlocking mutex"}, {"sha": "60ff33c8bfcd3fc7657f2093f1cc800dc9d91dcb", "filename": "tests/run-pass/panic/div-by-zero-2.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Fdiv-by-zero-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Fdiv-by-zero-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fpanic%2Fdiv-by-zero-2.stderr?ref=496c83ed4228deb491c9eeb06ceb4cc1882559f2", "patch": "@@ -1 +1,2 @@\n thread 'main' panicked at 'attempt to divide by zero', $DIR/div-by-zero-2.rs:4:14\n+note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace"}, {"sha": "64959da0faea741796e82f4bc3a0e1a11701392c", "filename": "tests/run-pass/panic/overflowing-lsh-neg.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Foverflowing-lsh-neg.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Foverflowing-lsh-neg.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fpanic%2Foverflowing-lsh-neg.stderr?ref=496c83ed4228deb491c9eeb06ceb4cc1882559f2", "patch": "@@ -1 +1,2 @@\n thread 'main' panicked at 'attempt to shift left with overflow', $DIR/overflowing-lsh-neg.rs:4:14\n+note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace"}, {"sha": "bd8843f8d603900d8084ed2be572216052f7bb39", "filename": "tests/run-pass/panic/overflowing-rsh-1.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Foverflowing-rsh-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Foverflowing-rsh-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fpanic%2Foverflowing-rsh-1.stderr?ref=496c83ed4228deb491c9eeb06ceb4cc1882559f2", "patch": "@@ -1 +1,2 @@\n thread 'main' panicked at 'attempt to shift right with overflow', $DIR/overflowing-rsh-1.rs:4:14\n+note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace"}, {"sha": "c43090ea70371037d7f872970b7953591fa63d24", "filename": "tests/run-pass/panic/overflowing-rsh-2.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Foverflowing-rsh-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Foverflowing-rsh-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fpanic%2Foverflowing-rsh-2.stderr?ref=496c83ed4228deb491c9eeb06ceb4cc1882559f2", "patch": "@@ -1 +1,2 @@\n thread 'main' panicked at 'attempt to shift right with overflow', $DIR/overflowing-rsh-2.rs:5:14\n+note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace"}, {"sha": "4500c916ad6a5aaf7801bc5cdc624d0902dac9f8", "filename": "tests/run-pass/panic/panic1.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Fpanic1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Fpanic1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fpanic%2Fpanic1.rs?ref=496c83ed4228deb491c9eeb06ceb4cc1882559f2", "patch": "@@ -1,3 +1,9 @@\n+// rustc-env: RUST_BACKTRACE=1\n+// compile-flags: -Zmiri-disable-isolation\n+// normalize-stderr-test \".*/(rust|checkout)/library/\" -> \"RUSTLIB/\"\n+// normalize-stderr-test \"RUSTLIB/(.*):\\d+:\\d+ \"-> \"RUSTLIB/$1:LL:COL \"\n+// normalize-stderr-test \"::<.*>\" -> \"\"\n+\n fn main() {\n     std::panic!(\"panicking from libstd\");\n }"}, {"sha": "e06ec1b9ce32d12e145eab94f5c6aa9765df7519", "filename": "tests/run-pass/panic/panic1.stderr", "status": "modified", "additions": 23, "deletions": 1, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Fpanic1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Fpanic1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fpanic%2Fpanic1.stderr?ref=496c83ed4228deb491c9eeb06ceb4cc1882559f2", "patch": "@@ -1 +1,23 @@\n-thread 'main' panicked at 'panicking from libstd', $DIR/panic1.rs:2:5\n+thread 'main' panicked at 'panicking from libstd', $DIR/panic1.rs:8:5\n+stack backtrace:\n+   0: std::rt::begin_panic\n+RUSTLIB/std/src/panicking.rs:505:12\n+   1: main\n+             at $DIR/panic1.rs:8:5\n+   2: <fn() as std::ops::FnOnce<()>>::call_once - shim(fn())\n+RUSTLIB/core/src/ops/function.rs:227:5\n+   3: std::rt::lang_start::{closure#0}\n+RUSTLIB/std/src/rt.rs:66:18\n+   4: std::ops::function::impls::call_once\n+RUSTLIB/core/src/ops/function.rs:259:13\n+   5: std::panicking::r#try::do_call\n+RUSTLIB/std/src/panicking.rs:381:40\n+   6: std::panicking::r#try\n+RUSTLIB/std/src/panicking.rs:345:19\n+   7: std::panic::catch_unwind\n+RUSTLIB/std/src/panic.rs:382:14\n+   8: std::rt::lang_start_internal\n+RUSTLIB/std/src/rt.rs:51:25\n+   9: std::rt::lang_start\n+RUSTLIB/std/src/rt.rs:65:5\n+note: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace."}, {"sha": "c0415b4e70f0706f4bc7fb9b6e46257d9dc8fc81", "filename": "tests/run-pass/panic/panic2.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Fpanic2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Fpanic2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fpanic%2Fpanic2.stderr?ref=496c83ed4228deb491c9eeb06ceb4cc1882559f2", "patch": "@@ -1 +1,2 @@\n thread 'main' panicked at '42-panicking from libstd', $DIR/panic2.rs:2:5\n+note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace"}, {"sha": "8aa8761aebf77634197491a7af9c721a606b3548", "filename": "tests/run-pass/panic/panic3.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Fpanic3.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Fpanic3.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fpanic%2Fpanic3.stderr?ref=496c83ed4228deb491c9eeb06ceb4cc1882559f2", "patch": "@@ -1 +1,2 @@\n thread 'main' panicked at 'panicking from libcore', $DIR/panic3.rs:2:5\n+note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace"}, {"sha": "a71d25b74c435bf3fe0e1c79a551bb83492f2660", "filename": "tests/run-pass/panic/panic4.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Fpanic4.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Fpanic%2Fpanic4.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fpanic%2Fpanic4.stderr?ref=496c83ed4228deb491c9eeb06ceb4cc1882559f2", "patch": "@@ -1 +1,2 @@\n thread 'main' panicked at '42-panicking from libcore', $DIR/panic4.rs:2:5\n+note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace"}, {"sha": "54ccdfb5e4656ef1239c0570a67f2c9bea6b8b56", "filename": "tests/run-pass/transmute_fat2.stderr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Ftransmute_fat2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/496c83ed4228deb491c9eeb06ceb4cc1882559f2/tests%2Frun-pass%2Ftransmute_fat2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Ftransmute_fat2.stderr?ref=496c83ed4228deb491c9eeb06ceb4cc1882559f2", "patch": "@@ -1 +1,2 @@\n thread 'main' panicked at 'index out of bounds: the len is 0 but the index is 0', $DIR/transmute_fat2.rs:15:5\n+note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace"}]}