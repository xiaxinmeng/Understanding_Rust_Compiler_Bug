{"sha": "53c2c04d63b3c043ec5b1b4f401e04868a1139a4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUzYzJjMDRkNjNiM2MwNDNlYzViMWI0ZjQwMWUwNDg2OGExMTM5YTQ=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2019-10-30T11:35:55Z"}, "committer": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2019-11-12T10:03:52Z"}, "message": "ci: remove the MINGW_DIR and MINGW_ARCHIVE env vars", "tree": {"sha": "02ca098b21a25a8d415dfa3ab73764eefc1eabba", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/02ca098b21a25a8d415dfa3ab73764eefc1eabba"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/53c2c04d63b3c043ec5b1b4f401e04868a1139a4", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE1JbYPtLJAsc22U9xPgar6Auq8ZwFAl3Kg4wACgkQPgar6Auq\n8ZwuZxAAlDuTRDg/k7Vb5mv0BG9s+lKhjl0hhut5v8M/2N9ZncYAn4PkGkyOHjj0\nAspxnXIPW9uPfa2rRjIps+kDkMjJMB2yve6x4MBt2jJWcpF0QQPugucXy5bn3M5D\nsGGf2xkXWRqog6GQq/Eknj1N7aHXzC2XDXSXGeopOjW6yo2y+m1tkj2wxtKEuuqG\nqcPpUfo8Y/coyYqUrslE5wKXwKCnkvFhgziRGnZEnAp+GY17hzfBX6CeCM9tUIjh\niwmybljuW29NaNKclCkOaU5DAXAvJiqF7HU3CtT4I+EddZ6vCdq9eeFxl++vrPCS\n4fRKhadTCrF+Vc7Whv4y+5bLB9V34hmJayKR4LBmiUivpLyANzJS3SzCdNdSMyQp\nzs8jn0KyNNuCulALp3QE4NzlqdPu7YULeFDLiMrsg28IQpSfxTzAH2fJw3wlr6aW\nl4O770ygZti/cLJesCUldfaz38ChGDJ4vHhmv2rbnbzl7OsDqu66vZ3fZAGR5Iw7\npAOYsrEti3lPSHF5IV/U0dxziEs/aMjW6BeJ9+/aL9oy1xUtg/fZmcTT9vQvuE30\nEOXPuabmJeXdGFrLGPHyQyyzSxVEaFkUBz3jC5v6mjGwcpQLgCbptden+csBLo3z\nUiE9w0IwEolevrzQZ8/RHw105LdFDPjamJ9qyyCWm/K8rY7nwgk=\n=/b1W\n-----END PGP SIGNATURE-----", "payload": "tree 02ca098b21a25a8d415dfa3ab73764eefc1eabba\nparent 71e50180713eaaaa3bedc827e6890cede03baa0b\nauthor Pietro Albini <pietro@pietroalbini.org> 1572435355 +0100\ncommitter Pietro Albini <pietro@pietroalbini.org> 1573553032 +0100\n\nci: remove the MINGW_DIR and MINGW_ARCHIVE env vars\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/53c2c04d63b3c043ec5b1b4f401e04868a1139a4", "html_url": "https://github.com/rust-lang/rust/commit/53c2c04d63b3c043ec5b1b4f401e04868a1139a4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/53c2c04d63b3c043ec5b1b4f401e04868a1139a4/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "71e50180713eaaaa3bedc827e6890cede03baa0b", "url": "https://api.github.com/repos/rust-lang/rust/commits/71e50180713eaaaa3bedc827e6890cede03baa0b", "html_url": "https://github.com/rust-lang/rust/commit/71e50180713eaaaa3bedc827e6890cede03baa0b"}], "stats": {"total": 27, "additions": 12, "deletions": 15}, "files": [{"sha": "74fb237eebd1e648a20e822f3a0f7269828951e2", "filename": "src/ci/azure-pipelines/auto.yml", "status": "modified", "additions": 0, "deletions": 12, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/53c2c04d63b3c043ec5b1b4f401e04868a1139a4/src%2Fci%2Fazure-pipelines%2Fauto.yml", "raw_url": "https://github.com/rust-lang/rust/raw/53c2c04d63b3c043ec5b1b4f401e04868a1139a4/src%2Fci%2Fazure-pipelines%2Fauto.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fazure-pipelines%2Fauto.yml?ref=53c2c04d63b3c043ec5b1b4f401e04868a1139a4", "patch": "@@ -285,8 +285,6 @@ jobs:\n         RUST_CONFIGURE_ARGS: --build=i686-pc-windows-gnu\n         SCRIPT: make ci-mingw-subset-1\n         CUSTOM_MINGW: 1\n-        MINGW_ARCHIVE: i686-6.3.0-release-posix-dwarf-rt_v5-rev2.7z\n-        MINGW_DIR: mingw32\n         # FIXME(#59637)\n         NO_DEBUG_ASSERTIONS: 1\n         NO_LLVM_ASSERTIONS: 1\n@@ -295,15 +293,11 @@ jobs:\n         RUST_CONFIGURE_ARGS: --build=i686-pc-windows-gnu\n         SCRIPT: make ci-mingw-subset-2\n         CUSTOM_MINGW: 1\n-        MINGW_ARCHIVE: i686-6.3.0-release-posix-dwarf-rt_v5-rev2.7z\n-        MINGW_DIR: mingw32\n       x86_64-mingw-1:\n         MSYS_BITS: 64\n         SCRIPT: make ci-mingw-subset-1\n         RUST_CONFIGURE_ARGS: --build=x86_64-pc-windows-gnu\n         CUSTOM_MINGW: 1\n-        MINGW_ARCHIVE: x86_64-6.3.0-release-posix-seh-rt_v5-rev2.7z\n-        MINGW_DIR: mingw64\n         # FIXME(#59637)\n         NO_DEBUG_ASSERTIONS: 1\n         NO_LLVM_ASSERTIONS: 1\n@@ -312,8 +306,6 @@ jobs:\n         SCRIPT: make ci-mingw-subset-2\n         RUST_CONFIGURE_ARGS: --build=x86_64-pc-windows-gnu\n         CUSTOM_MINGW: 1\n-        MINGW_ARCHIVE: x86_64-6.3.0-release-posix-seh-rt_v5-rev2.7z\n-        MINGW_DIR: mingw64\n \n       # 32/64 bit MSVC and GNU deployment\n       dist-x86_64-msvc:\n@@ -341,17 +333,13 @@ jobs:\n         RUST_CONFIGURE_ARGS: --build=i686-pc-windows-gnu --enable-full-tools --enable-profiler\n         SCRIPT: python x.py dist\n         CUSTOM_MINGW: 1\n-        MINGW_ARCHIVE: i686-6.3.0-release-posix-dwarf-rt_v5-rev2.7z\n-        MINGW_DIR: mingw32\n         DIST_REQUIRE_ALL_TOOLS: 1\n         DEPLOY: 1\n       dist-x86_64-mingw:\n         MSYS_BITS: 64\n         SCRIPT: python x.py dist\n         RUST_CONFIGURE_ARGS: --build=x86_64-pc-windows-gnu --enable-full-tools --enable-profiler\n         CUSTOM_MINGW: 1\n-        MINGW_ARCHIVE: x86_64-6.3.0-release-posix-seh-rt_v5-rev2.7z\n-        MINGW_DIR: mingw64\n         DIST_REQUIRE_ALL_TOOLS: 1\n         DEPLOY: 1\n "}, {"sha": "631d5e575a5dca4da0346f6be5e910a553b070a0", "filename": "src/ci/scripts/install-mingw.sh", "status": "modified", "additions": 12, "deletions": 3, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/53c2c04d63b3c043ec5b1b4f401e04868a1139a4/src%2Fci%2Fscripts%2Finstall-mingw.sh", "raw_url": "https://github.com/rust-lang/rust/raw/53c2c04d63b3c043ec5b1b4f401e04868a1139a4/src%2Fci%2Fscripts%2Finstall-mingw.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fscripts%2Finstall-mingw.sh?ref=53c2c04d63b3c043ec5b1b4f401e04868a1139a4", "patch": "@@ -27,6 +27,9 @@ IFS=$'\\n\\t'\n \n source \"$(cd \"$(dirname \"$0\")\" && pwd)/../shared.sh\"\n \n+MINGW_ARCHIVE_32=\"i686-6.3.0-release-posix-dwarf-rt_v5-rev2.7z\"\n+MINGW_ARCHIVE_64=\"x86_64-6.3.0-release-posix-seh-rt_v5-rev2.7z\"\n+\n if isWindows; then\n     if [[ \"${CUSTOM_MINGW-0}\" -ne 1 ]]; then\n         arch=i686\n@@ -37,9 +40,15 @@ if isWindows; then\n             mingw-w64-$arch-gcc mingw-w64-$arch-python2\n         ciCommandAddPath \"${SYSTEM_WORKFOLDER}/msys2/mingw${MSYS_BITS}/bin\"\n     else\n-        curl -o mingw.7z \"${MIRRORS_BASE}/${MINGW_ARCHIVE}\"\n+        mingw_archive=\"${MINGW_ARCHIVE_32}\"\n+        if [[ \"${MSYS_BITS}\" = \"64\" ]]; then\n+            mingw_archive=\"${MINGW_ARCHIVE_64}\"\n+        fi\n+        mingw_dir=\"mingw${MSYS_BITS}\"\n+\n+        curl -o mingw.7z \"${MIRRORS_BASE}/${mingw_archive}\"\n         7z x -y mingw.7z > /dev/null\n-        curl -o \"${MINGW_DIR}/bin/gdborig.exe\" \"${MIRRORS_BASE}/2017-04-20-${MSYS_BITS}bit-gdborig.exe\"\n-        ciCommandAddPath \"$(pwd)/${MINGW_DIR}/bin\"\n+        curl -o \"${mingw_dir}/bin/gdborig.exe\" \"${MIRRORS_BASE}/2017-04-20-${MSYS_BITS}bit-gdborig.exe\"\n+        ciCommandAddPath \"$(pwd)/${mingw_dir}/bin\"\n     fi\n fi"}]}