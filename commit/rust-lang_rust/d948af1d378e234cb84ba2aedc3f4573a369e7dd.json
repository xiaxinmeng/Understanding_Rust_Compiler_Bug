{"sha": "d948af1d378e234cb84ba2aedc3f4573a369e7dd", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ5NDhhZjFkMzc4ZTIzNGNiODRiYTJhZWRjM2Y0NTczYTM2OWU3ZGQ=", "commit": {"author": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2017-11-08T10:44:55Z"}, "committer": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2017-11-08T10:44:55Z"}, "message": "incr.comp.: Remove unused DepKind::WorkProduct.", "tree": {"sha": "0e03c30703cfa713662936e31b17229ee9167101", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0e03c30703cfa713662936e31b17229ee9167101"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d948af1d378e234cb84ba2aedc3f4573a369e7dd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d948af1d378e234cb84ba2aedc3f4573a369e7dd", "html_url": "https://github.com/rust-lang/rust/commit/d948af1d378e234cb84ba2aedc3f4573a369e7dd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d948af1d378e234cb84ba2aedc3f4573a369e7dd/comments", "author": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "committer": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "702ce8f0a6d8a026343f0f162585ee4fd7ef81c1", "url": "https://api.github.com/repos/rust-lang/rust/commits/702ce8f0a6d8a026343f0f162585ee4fd7ef81c1", "html_url": "https://github.com/rust-lang/rust/commit/702ce8f0a6d8a026343f0f162585ee4fd7ef81c1"}], "stats": {"total": 30, "additions": 3, "deletions": 27}, "files": [{"sha": "89ce4bf928ad859e8ecc4424ef55cc9dd6595a56", "filename": "src/librustc/dep_graph/dep_node.rs", "status": "modified", "additions": 0, "deletions": 11, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/d948af1d378e234cb84ba2aedc3f4573a369e7dd/src%2Flibrustc%2Fdep_graph%2Fdep_node.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d948af1d378e234cb84ba2aedc3f4573a369e7dd/src%2Flibrustc%2Fdep_graph%2Fdep_node.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fdep_graph%2Fdep_node.rs?ref=d948af1d378e234cb84ba2aedc3f4573a369e7dd", "patch": "@@ -459,10 +459,6 @@ define_dep_nodes!( <'tcx>\n     // Represents metadata from an extern crate.\n     [input] CrateMetadata(CrateNum),\n \n-    // Represents some artifact that we save to disk. Note that these\n-    // do not have a def-id as part of their identifier.\n-    [] WorkProduct(WorkProductId),\n-\n     // Represents different phases in the compiler.\n     [] RegionScopeTree(DefId),\n     [eval_always] Coherence,\n@@ -781,13 +777,6 @@ impl WorkProductId {\n             hash: fingerprint\n         }\n     }\n-\n-    pub fn to_dep_node(self) -> DepNode {\n-        DepNode {\n-            kind: DepKind::WorkProduct,\n-            hash: self.hash,\n-        }\n-    }\n }\n \n impl_stable_hash_for!(struct ::dep_graph::WorkProductId {"}, {"sha": "24148bcc83f37a76924c5ae0e1e87df89c496615", "filename": "src/librustc/ty/maps/plumbing.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/d948af1d378e234cb84ba2aedc3f4573a369e7dd/src%2Flibrustc%2Fty%2Fmaps%2Fplumbing.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d948af1d378e234cb84ba2aedc3f4573a369e7dd/src%2Flibrustc%2Fty%2Fmaps%2Fplumbing.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fty%2Fmaps%2Fplumbing.rs?ref=d948af1d378e234cb84ba2aedc3f4573a369e7dd", "patch": "@@ -721,9 +721,8 @@ pub fn force_from_dep_node<'a, 'gcx, 'lcx>(tcx: TyCtxt<'a, 'gcx, 'lcx>,\n         DepKind::EraseRegionsTy |\n         DepKind::NormalizeTy |\n \n-        // These are just odd\n-        DepKind::Null |\n-        DepKind::WorkProduct => {\n+        // This one should never occur in this context\n+        DepKind::Null => {\n             bug!(\"force_from_dep_node() - Encountered {:?}\", dep_node.kind)\n         }\n "}, {"sha": "03c0f13e2f5f7b7e1dbd2526ac66b94d9a6911b7", "filename": "src/librustc_trans/partitioning.rs", "status": "modified", "additions": 1, "deletions": 13, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/d948af1d378e234cb84ba2aedc3f4573a369e7dd/src%2Flibrustc_trans%2Fpartitioning.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d948af1d378e234cb84ba2aedc3f4573a369e7dd/src%2Flibrustc_trans%2Fpartitioning.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fpartitioning.rs?ref=d948af1d378e234cb84ba2aedc3f4573a369e7dd", "patch": "@@ -104,7 +104,7 @@\n \n use collector::InliningMap;\n use common;\n-use rustc::dep_graph::{DepNode, WorkProductId};\n+use rustc::dep_graph::WorkProductId;\n use rustc::hir::def_id::DefId;\n use rustc::hir::map::DefPathData;\n use rustc::middle::trans::{Linkage, Visibility};\n@@ -147,10 +147,6 @@ pub trait CodegenUnitExt<'tcx> {\n         WorkProductId::from_cgu_name(self.name())\n     }\n \n-    fn work_product_dep_node(&self) -> DepNode {\n-        self.work_product_id().to_dep_node()\n-    }\n-\n     fn items_in_deterministic_order<'a>(&self,\n                                         tcx: TyCtxt<'a, 'tcx, 'tcx>)\n                                         -> Vec<(TransItem<'tcx>,\n@@ -253,14 +249,6 @@ pub fn partition<'a, 'tcx, I>(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n         cgu1.name().cmp(cgu2.name())\n     });\n \n-    if tcx.sess.opts.enable_dep_node_debug_strs() {\n-        for cgu in &result {\n-            let dep_node = cgu.work_product_dep_node();\n-            tcx.dep_graph.register_dep_node_debug_str(dep_node,\n-                                                            || cgu.name().to_string());\n-        }\n-    }\n-\n     result\n }\n "}]}