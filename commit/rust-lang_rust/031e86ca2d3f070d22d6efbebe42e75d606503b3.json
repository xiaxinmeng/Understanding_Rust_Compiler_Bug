{"sha": "031e86ca2d3f070d22d6efbebe42e75d606503b3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAzMWU4NmNhMmQzZjA3MGQyMmQ2ZWZiZWJlNDJlNzVkNjA2NTAzYjM=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-04-27T16:03:45Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-04-27T16:03:45Z"}, "message": "Partly disable simplified-type glue optimization due to compile-time cost.", "tree": {"sha": "004103c331f451734e3548d654572fefc79130c9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/004103c331f451734e3548d654572fefc79130c9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/031e86ca2d3f070d22d6efbebe42e75d606503b3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/031e86ca2d3f070d22d6efbebe42e75d606503b3", "html_url": "https://github.com/rust-lang/rust/commit/031e86ca2d3f070d22d6efbebe42e75d606503b3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/031e86ca2d3f070d22d6efbebe42e75d606503b3/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "05587ebdff53def560e04e853fbb3c272fa586d6", "url": "https://api.github.com/repos/rust-lang/rust/commits/05587ebdff53def560e04e853fbb3c272fa586d6", "html_url": "https://github.com/rust-lang/rust/commit/05587ebdff53def560e04e853fbb3c272fa586d6"}], "stats": {"total": 12, "additions": 11, "deletions": 1}, "files": [{"sha": "bddcf2724174dd0fce8b46614ff33549fe1409bc", "filename": "src/comp/middle/trans.rs", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/031e86ca2d3f070d22d6efbebe42e75d606503b3/src%2Fcomp%2Fmiddle%2Ftrans.rs", "raw_url": "https://github.com/rust-lang/rust/raw/031e86ca2d3f070d22d6efbebe42e75d606503b3/src%2Fcomp%2Fmiddle%2Ftrans.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fmiddle%2Ftrans.rs?ref=031e86ca2d3f070d22d6efbebe42e75d606503b3", "patch": "@@ -1617,14 +1617,24 @@ fn get_static_tydesc(&@block_ctxt cx,\n             ret info;\n         }\n         case (none[@tydesc_info]) {\n+\n+            // FIXME: Use of a simplified tydesc (w/o names) removes a lot of\n+            // generated glue, but the compile time goes way down due to\n+            // greatly increasing the miss rate on the type_of cache elsewhere\n+            // in this file. Experiment with other approaches to this.\n+\n+            /*\n             fn simplifier(ty.t typ) -> ty.t {\n                 ret @rec(cname=none[str] with *typ);\n             }\n             auto f = simplifier;\n             auto t_simplified = ty.fold_ty(cx.fcx.lcx.ccx.tcx, f, t);\n             auto info = declare_tydesc(cx.fcx.lcx, t_simplified);\n-            cx.fcx.lcx.ccx.tydescs.insert(t, info);\n             cx.fcx.lcx.ccx.tydescs.insert(t_simplified, info);\n+            */\n+\n+            auto info = declare_tydesc(cx.fcx.lcx, t);\n+            cx.fcx.lcx.ccx.tydescs.insert(t, info);\n             define_tydesc(cx.fcx.lcx, t, ty_params);\n             ret info;\n         }"}]}