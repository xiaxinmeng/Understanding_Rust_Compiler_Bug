{"sha": "5a439f5a82815c029c8b2bfa28d9525aaac1c320", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVhNDM5ZjVhODI4MTVjMDI5YzhiMmJmYTI4ZDk1MjVhYWFjMWMzMjA=", "commit": {"author": {"name": "Yoshitomo Nakanishi", "email": "yurayura.rounin.3@gmail.com", "date": "2021-03-16T01:37:05Z"}, "committer": {"name": "Yoshitomo Nakanishi", "email": "yurayura.rounin.3@gmail.com", "date": "2021-03-16T02:28:53Z"}, "message": "Remove unit_types::utils::is_unit", "tree": {"sha": "f68639cefa32c12240319bf50168e4f2639c28a6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f68639cefa32c12240319bf50168e4f2639c28a6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5a439f5a82815c029c8b2bfa28d9525aaac1c320", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5a439f5a82815c029c8b2bfa28d9525aaac1c320", "html_url": "https://github.com/rust-lang/rust/commit/5a439f5a82815c029c8b2bfa28d9525aaac1c320", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5a439f5a82815c029c8b2bfa28d9525aaac1c320/comments", "author": {"login": "Y-Nak", "id": 6376004, "node_id": "MDQ6VXNlcjYzNzYwMDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/6376004?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Y-Nak", "html_url": "https://github.com/Y-Nak", "followers_url": "https://api.github.com/users/Y-Nak/followers", "following_url": "https://api.github.com/users/Y-Nak/following{/other_user}", "gists_url": "https://api.github.com/users/Y-Nak/gists{/gist_id}", "starred_url": "https://api.github.com/users/Y-Nak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Y-Nak/subscriptions", "organizations_url": "https://api.github.com/users/Y-Nak/orgs", "repos_url": "https://api.github.com/users/Y-Nak/repos", "events_url": "https://api.github.com/users/Y-Nak/events{/privacy}", "received_events_url": "https://api.github.com/users/Y-Nak/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Y-Nak", "id": 6376004, "node_id": "MDQ6VXNlcjYzNzYwMDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/6376004?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Y-Nak", "html_url": "https://github.com/Y-Nak", "followers_url": "https://api.github.com/users/Y-Nak/followers", "following_url": "https://api.github.com/users/Y-Nak/following{/other_user}", "gists_url": "https://api.github.com/users/Y-Nak/gists{/gist_id}", "starred_url": "https://api.github.com/users/Y-Nak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Y-Nak/subscriptions", "organizations_url": "https://api.github.com/users/Y-Nak/orgs", "repos_url": "https://api.github.com/users/Y-Nak/repos", "events_url": "https://api.github.com/users/Y-Nak/events{/privacy}", "received_events_url": "https://api.github.com/users/Y-Nak/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6211b49ac1c9a013869943a003efbd5a71a73c93", "url": "https://api.github.com/repos/rust-lang/rust/commits/6211b49ac1c9a013869943a003efbd5a71a73c93", "html_url": "https://github.com/rust-lang/rust/commit/6211b49ac1c9a013869943a003efbd5a71a73c93"}], "stats": {"total": 17, "additions": 6, "deletions": 11}, "files": [{"sha": "55715cc6bf39c49aea5bd8b12aad6a322207b59b", "filename": "clippy_lints/src/unit_types/let_unit_value.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/5a439f5a82815c029c8b2bfa28d9525aaac1c320/clippy_lints%2Fsrc%2Funit_types%2Flet_unit_value.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5a439f5a82815c029c8b2bfa28d9525aaac1c320/clippy_lints%2Fsrc%2Funit_types%2Flet_unit_value.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Funit_types%2Flet_unit_value.rs?ref=5a439f5a82815c029c8b2bfa28d9525aaac1c320", "patch": "@@ -7,11 +7,11 @@ use crate::utils::diagnostics::span_lint_and_then;\n use crate::utils::higher;\n use crate::utils::source::snippet_with_macro_callsite;\n \n-use super::{utils, LET_UNIT_VALUE};\n+use super::LET_UNIT_VALUE;\n \n pub(super) fn check(cx: &LateContext<'_>, stmt: &Stmt<'_>) {\n     if let StmtKind::Local(ref local) = stmt.kind {\n-        if utils::is_unit(cx.typeck_results().pat_ty(&local.pat)) {\n+        if cx.typeck_results().pat_ty(&local.pat).is_unit() {\n             if in_external_macro(cx.sess(), stmt.span) || local.pat.span.from_expansion() {\n                 return;\n             }"}, {"sha": "d4ef645fc8d9e8eba77c196bde8d97c4303be73f", "filename": "clippy_lints/src/unit_types/unit_arg.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5a439f5a82815c029c8b2bfa28d9525aaac1c320/clippy_lints%2Fsrc%2Funit_types%2Funit_arg.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5a439f5a82815c029c8b2bfa28d9525aaac1c320/clippy_lints%2Fsrc%2Funit_types%2Funit_arg.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Funit_types%2Funit_arg.rs?ref=5a439f5a82815c029c8b2bfa28d9525aaac1c320", "patch": "@@ -36,7 +36,7 @@ pub(super) fn check(cx: &LateContext<'_>, expr: &Expr<'_>) {\n             let args_to_recover = args\n                 .iter()\n                 .filter(|arg| {\n-                    if utils::is_unit(cx.typeck_results().expr_ty(arg)) && !utils::is_unit_literal(arg) {\n+                    if cx.typeck_results().expr_ty(arg).is_unit() && !utils::is_unit_literal(arg) {\n                         !matches!(\n                             &arg.kind,\n                             ExprKind::Match(.., MatchSource::TryDesugar) | ExprKind::Path(..)"}, {"sha": "f9c0374c86dc197b96080c34ab7db595eec1149b", "filename": "clippy_lints/src/unit_types/unit_cmp.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/5a439f5a82815c029c8b2bfa28d9525aaac1c320/clippy_lints%2Fsrc%2Funit_types%2Funit_cmp.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5a439f5a82815c029c8b2bfa28d9525aaac1c320/clippy_lints%2Fsrc%2Funit_types%2Funit_cmp.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Funit_types%2Funit_cmp.rs?ref=5a439f5a82815c029c8b2bfa28d9525aaac1c320", "patch": "@@ -4,15 +4,15 @@ use rustc_span::hygiene::{ExpnKind, MacroKind};\n \n use crate::utils::diagnostics::span_lint;\n \n-use super::{utils, UNIT_CMP};\n+use super::UNIT_CMP;\n \n pub(super) fn check(cx: &LateContext<'_>, expr: &Expr<'_>) {\n     if expr.span.from_expansion() {\n         if let Some(callee) = expr.span.source_callee() {\n             if let ExpnKind::Macro(MacroKind::Bang, symbol) = callee.kind {\n                 if let ExprKind::Binary(ref cmp, ref left, _) = expr.kind {\n                     let op = cmp.node;\n-                    if op.is_comparison() && utils::is_unit(cx.typeck_results().expr_ty(left)) {\n+                    if op.is_comparison() && cx.typeck_results().expr_ty(left).is_unit() {\n                         let result = match &*symbol.as_str() {\n                             \"assert_eq\" | \"debug_assert_eq\" => \"succeed\",\n                             \"assert_ne\" | \"debug_assert_ne\" => \"fail\",\n@@ -37,7 +37,7 @@ pub(super) fn check(cx: &LateContext<'_>, expr: &Expr<'_>) {\n \n     if let ExprKind::Binary(ref cmp, ref left, _) = expr.kind {\n         let op = cmp.node;\n-        if op.is_comparison() && utils::is_unit(cx.typeck_results().expr_ty(left)) {\n+        if op.is_comparison() && cx.typeck_results().expr_ty(left).is_unit() {\n             let result = match op {\n                 BinOpKind::Eq | BinOpKind::Le | BinOpKind::Ge => \"true\",\n                 _ => \"false\","}, {"sha": "4e194a05e8dec89b212b7e936283ada26f052839", "filename": "clippy_lints/src/unit_types/utils.rs", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/5a439f5a82815c029c8b2bfa28d9525aaac1c320/clippy_lints%2Fsrc%2Funit_types%2Futils.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5a439f5a82815c029c8b2bfa28d9525aaac1c320/clippy_lints%2Fsrc%2Funit_types%2Futils.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Funit_types%2Futils.rs?ref=5a439f5a82815c029c8b2bfa28d9525aaac1c320", "patch": "@@ -1,9 +1,4 @@\n use rustc_hir::{Expr, ExprKind};\n-use rustc_middle::ty::{self, Ty};\n-\n-pub(super) fn is_unit(ty: Ty<'_>) -> bool {\n-    matches!(ty.kind(), ty::Tuple(slice) if slice.is_empty())\n-}\n \n pub(super) fn is_unit_literal(expr: &Expr<'_>) -> bool {\n     matches!(expr.kind, ExprKind::Tup(ref slice) if slice.is_empty())"}]}