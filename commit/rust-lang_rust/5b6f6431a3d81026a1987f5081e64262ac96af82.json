{"sha": "5b6f6431a3d81026a1987f5081e64262ac96af82", "node_id": "MDY6Q29tbWl0NzI0NzEyOjViNmY2NDMxYTNkODEwMjZhMTk4N2Y1MDgxZTY0MjYyYWM5NmFmODI=", "commit": {"author": {"name": "Seiichi Uchida", "email": "seuchida@gmail.com", "date": "2019-01-27T14:02:54Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-01-27T14:02:54Z"}, "message": "Merge pull request #3280 from m-ou-se/global-config\n\nLook for a global rustfmt.toml.", "tree": {"sha": "0bb87785ab29e658bd4a3881f0f547633121fbcb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0bb87785ab29e658bd4a3881f0f547633121fbcb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5b6f6431a3d81026a1987f5081e64262ac96af82", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJcTboOCRBK7hj4Ov3rIwAAdHIIAAe3lmmve0tmjQQDUBN2qOHc\nU+H8EBxMYyZ05bXNixrlcsskLxm+MBITyDIxQ2aDMC3gEuOt07CxevdPbSFPH6hD\nV5Vcut7KrGml2foNWBscJjZtZ9hbY/YXu0xKCZvr7GoEnOfBcZ1QV/fD/kQp2rj9\n+4yRe5XrygG+9ycjQkEpthJdlwsO8wtbaBHfSCosK7BvHEsZ0pIYSXM0qT0bxRr+\nBBUvYOElvDKaXrlbr2RgTApMB+87SSx0Gff8wzeVuPC3/hOXaiBxGsgFlapVuwP0\nRRmSr7A6ZctZzJlq3aLE1jPFwC2w0IpRP+yGOp+G4TMYTXtCeY7r0l27GdkDl0g=\n=SnQR\n-----END PGP SIGNATURE-----\n", "payload": "tree 0bb87785ab29e658bd4a3881f0f547633121fbcb\nparent 203e6d265d88bee97f89bb0529f3a33cb46e0477\nparent 635a4cdcdcf726aab4b6f7dcb620ffdb33c5e367\nauthor Seiichi Uchida <seuchida@gmail.com> 1548597774 +0900\ncommitter GitHub <noreply@github.com> 1548597774 +0900\n\nMerge pull request #3280 from m-ou-se/global-config\n\nLook for a global rustfmt.toml."}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5b6f6431a3d81026a1987f5081e64262ac96af82", "html_url": "https://github.com/rust-lang/rust/commit/5b6f6431a3d81026a1987f5081e64262ac96af82", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5b6f6431a3d81026a1987f5081e64262ac96af82/comments", "author": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "203e6d265d88bee97f89bb0529f3a33cb46e0477", "url": "https://api.github.com/repos/rust-lang/rust/commits/203e6d265d88bee97f89bb0529f3a33cb46e0477", "html_url": "https://github.com/rust-lang/rust/commit/203e6d265d88bee97f89bb0529f3a33cb46e0477"}, {"sha": "635a4cdcdcf726aab4b6f7dcb620ffdb33c5e367", "url": "https://api.github.com/repos/rust-lang/rust/commits/635a4cdcdcf726aab4b6f7dcb620ffdb33c5e367", "html_url": "https://github.com/rust-lang/rust/commit/635a4cdcdcf726aab4b6f7dcb620ffdb33c5e367"}], "stats": {"total": 79, "additions": 77, "deletions": 2}, "files": [{"sha": "01cb370a89a8d146bce00d4a6bef79b0c806206d", "filename": "Cargo.lock", "status": "modified", "additions": 56, "deletions": 0, "changes": 56, "blob_url": "https://github.com/rust-lang/rust/blob/5b6f6431a3d81026a1987f5081e64262ac96af82/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/5b6f6431a3d81026a1987f5081e64262ac96af82/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=5b6f6431a3d81026a1987f5081e64262ac96af82", "patch": "@@ -6,6 +6,15 @@ dependencies = [\n  \"memchr 2.1.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n+[[package]]\n+name = \"argon2rs\"\n+version = \"0.2.5\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+dependencies = [\n+ \"blake2-rfc 0.2.18 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"scoped_threadpool 0.1.9 (registry+https://github.com/rust-lang/crates.io-index)\",\n+]\n+\n [[package]]\n name = \"arrayvec\"\n version = \"0.4.8\"\n@@ -50,6 +59,15 @@ name = \"bitflags\"\n version = \"1.0.4\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n+[[package]]\n+name = \"blake2-rfc\"\n+version = \"0.2.18\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+dependencies = [\n+ \"arrayvec 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"constant_time_eq 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n+]\n+\n [[package]]\n name = \"bytecount\"\n version = \"0.5.0\"\n@@ -93,6 +111,11 @@ dependencies = [\n  \"bitflags 1.0.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n+[[package]]\n+name = \"constant_time_eq\"\n+version = \"0.1.3\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+\n [[package]]\n name = \"crossbeam-deque\"\n version = \"0.2.0\"\n@@ -139,6 +162,16 @@ name = \"diff\"\n version = \"0.1.11\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n+[[package]]\n+name = \"dirs\"\n+version = \"1.0.4\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+dependencies = [\n+ \"libc 0.2.44 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"redox_users 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"winapi 0.3.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n+]\n+\n [[package]]\n name = \"either\"\n version = \"1.5.0\"\n@@ -396,6 +429,17 @@ dependencies = [\n  \"redox_syscall 0.1.43 (registry+https://github.com/rust-lang/crates.io-index)\",\n ]\n \n+[[package]]\n+name = \"redox_users\"\n+version = \"0.2.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+dependencies = [\n+ \"argon2rs 0.2.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"failure 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"rand 0.4.3 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"redox_syscall 0.1.43 (registry+https://github.com/rust-lang/crates.io-index)\",\n+]\n+\n [[package]]\n name = \"regex\"\n version = \"1.0.6\"\n@@ -578,6 +622,7 @@ dependencies = [\n  \"cargo_metadata 0.7.1 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"derive-new 0.5.6 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"diff 0.1.11 (registry+https://github.com/rust-lang/crates.io-index)\",\n+ \"dirs 1.0.4 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"env_logger 0.6.0 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"failure 0.1.5 (registry+https://github.com/rust-lang/crates.io-index)\",\n  \"getopts 0.2.18 (registry+https://github.com/rust-lang/crates.io-index)\",\n@@ -609,6 +654,11 @@ name = \"scoped-tls\"\n version = \"0.1.2\"\n source = \"registry+https://github.com/rust-lang/crates.io-index\"\n \n+[[package]]\n+name = \"scoped_threadpool\"\n+version = \"0.1.9\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+\n [[package]]\n name = \"scopeguard\"\n version = \"0.3.3\"\n@@ -816,22 +866,26 @@ dependencies = [\n \n [metadata]\n \"checksum aho-corasick 0.6.9 (registry+https://github.com/rust-lang/crates.io-index)\" = \"1e9a933f4e58658d7b12defcf96dc5c720f20832deebe3e0a19efd3b6aaeeb9e\"\n+\"checksum argon2rs 0.2.5 (registry+https://github.com/rust-lang/crates.io-index)\" = \"3f67b0b6a86dae6e67ff4ca2b6201396074996379fba2b92ff649126f37cb392\"\n \"checksum arrayvec 0.4.8 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f405cc4c21cd8b784f6c8fc2adf9bc00f59558f0049b5ec21517f875963040cc\"\n \"checksum atty 0.2.11 (registry+https://github.com/rust-lang/crates.io-index)\" = \"9a7d5b8723950951411ee34d271d99dddcc2035a16ab25310ea2c8cfd4369652\"\n \"checksum backtrace 0.3.9 (registry+https://github.com/rust-lang/crates.io-index)\" = \"89a47830402e9981c5c41223151efcced65a0510c13097c769cede7efb34782a\"\n \"checksum backtrace-sys 0.1.24 (registry+https://github.com/rust-lang/crates.io-index)\" = \"c66d56ac8dabd07f6aacdaf633f4b8262f5b3601a810a0dcddffd5c22c69daa0\"\n \"checksum bitflags 1.0.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"228047a76f468627ca71776ecdebd732a3423081fcf5125585bcd7c49886ce12\"\n+\"checksum blake2-rfc 0.2.18 (registry+https://github.com/rust-lang/crates.io-index)\" = \"5d6d530bdd2d52966a6d03b7a964add7ae1a288d25214066fd4b600f0f796400\"\n \"checksum bytecount 0.5.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"c219c0335c21a8bd79587ce5aee9f64aff1d0bd7a2cca7a58a815f9780cd3b0d\"\n \"checksum byteorder 1.2.7 (registry+https://github.com/rust-lang/crates.io-index)\" = \"94f88df23a25417badc922ab0f5716cc1330e87f71ddd9203b3a3ccd9cedf75d\"\n \"checksum cargo_metadata 0.7.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"585784cac9b05c93a53b17a0b24a5cdd1dfdda5256f030e089b549d2390cc720\"\n \"checksum cc 1.0.25 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f159dfd43363c4d08055a07703eb7a3406b0dac4d0584d96965a3262db3c9d16\"\n \"checksum cfg-if 0.1.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"082bb9b28e00d3c9d39cc03e64ce4cea0f1bb9b3fde493f0cbc008472d22bdf4\"\n \"checksum cloudabi 0.0.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ddfc5b9aa5d4507acaf872de71051dfd0e309860e88966e1051e462a077aac4f\"\n+\"checksum constant_time_eq 0.1.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"8ff012e225ce166d4422e0e78419d901719760f62ae2b7969ca6b564d1b54a9e\"\n \"checksum crossbeam-deque 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f739f8c5363aca78cfb059edf753d8f0d36908c348f3d8d1503f03d8b75d9cf3\"\n \"checksum crossbeam-epoch 0.3.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"927121f5407de9956180ff5e936fe3cf4324279280001cd56b669d28ee7e9150\"\n \"checksum crossbeam-utils 0.2.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"2760899e32a1d58d5abb31129f8fae5de75220bc2176e77ff7c627ae45c918d9\"\n \"checksum derive-new 0.5.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"6ca414e896ae072546f4d789f452daaecf60ddee4c9df5dc6d5936d769e3d87c\"\n \"checksum diff 0.1.11 (registry+https://github.com/rust-lang/crates.io-index)\" = \"3c2b69f912779fbb121ceb775d74d51e915af17aaebc38d28a592843a2dd0a3a\"\n+\"checksum dirs 1.0.4 (registry+https://github.com/rust-lang/crates.io-index)\" = \"88972de891f6118092b643d85a0b28e0678e0f948d7f879aa32f2d5aafe97d2a\"\n \"checksum either 1.5.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"3be565ca5c557d7f59e7cfcf1844f9e3033650c929c6566f511e8005f205c1d0\"\n \"checksum ena 0.11.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"f56c93cc076508c549d9bb747f79aa9b4eb098be7b8cad8830c3137ef52d1e00\"\n \"checksum env_logger 0.6.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"afb070faf94c85d17d50ca44f6ad076bce18ae92f0037d350947240a36e9d42e\"\n@@ -865,6 +919,7 @@ dependencies = [\n \"checksum rand_core 0.3.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"0905b6b7079ec73b314d4c748701f6931eb79fd97c668caa3f1899b22b32c6db\"\n \"checksum redox_syscall 0.1.43 (registry+https://github.com/rust-lang/crates.io-index)\" = \"679da7508e9a6390aeaf7fbd02a800fdc64b73fe2204dd2c8ae66d22d9d5ad5d\"\n \"checksum redox_termios 0.1.1 (registry+https://github.com/rust-lang/crates.io-index)\" = \"7e891cfe48e9100a70a3b6eb652fef28920c117d366339687bd5576160db0f76\"\n+\"checksum redox_users 0.2.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"214a97e49be64fd2c86f568dd0cb2c757d2cc53de95b273b6ad0a1c908482f26\"\n \"checksum regex 1.0.6 (registry+https://github.com/rust-lang/crates.io-index)\" = \"ee84f70c8c08744ea9641a731c7fadb475bf2ecc52d7f627feb833e0b3990467\"\n \"checksum regex-syntax 0.6.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"fbc557aac2b708fe84121caf261346cc2eed71978024337e42eb46b8a252ac6e\"\n \"checksum rustc-ap-arena 306.0.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"cbfb540c1347a3993060896b18e0d64084203fa37aaffdc5e5c31264f275d476\"\n@@ -884,6 +939,7 @@ dependencies = [\n \"checksum rustc_version 0.2.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"138e3e0acb6c9fb258b19b67cb8abd63c00679d2851805ea151465464fe9030a\"\n \"checksum ryu 0.2.7 (registry+https://github.com/rust-lang/crates.io-index)\" = \"eb9e9b8cde282a9fe6a42dd4681319bfb63f121b8a8ee9439c6f4107e58a46f7\"\n \"checksum scoped-tls 0.1.2 (registry+https://github.com/rust-lang/crates.io-index)\" = \"332ffa32bf586782a3efaeb58f127980944bbc8c4d6913a86107ac2a5ab24b28\"\n+\"checksum scoped_threadpool 0.1.9 (registry+https://github.com/rust-lang/crates.io-index)\" = \"1d51f5df5af43ab3f1360b429fa5e0152ac5ce8c0bd6485cae490332e96846a8\"\n \"checksum scopeguard 0.3.3 (registry+https://github.com/rust-lang/crates.io-index)\" = \"94258f53601af11e6a49f722422f6e3425c52b06245a5cf9bc09908b174f5e27\"\n \"checksum semver 0.9.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"1d7eb9ef2c18661902cc47e535f9bc51b78acd254da71d375c2f6720d9a40403\"\n \"checksum semver-parser 0.7.0 (registry+https://github.com/rust-lang/crates.io-index)\" = \"388a1df253eca08550bef6c72392cfe7c30914bf41df5269b68cbd6ff8f570a3\""}, {"sha": "b1e83e93b0996e97e3ce4622fd02ff42ec0248cb", "filename": "Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5b6f6431a3d81026a1987f5081e64262ac96af82/Cargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/5b6f6431a3d81026a1987f5081e64262ac96af82/Cargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.toml?ref=5b6f6431a3d81026a1987f5081e64262ac96af82", "patch": "@@ -55,6 +55,7 @@ failure = \"0.1.3\"\n bytecount = \"0.5\"\n unicode-width = \"0.1.5\"\n unicode_categories = \"0.1.1\"\n+dirs = \"1.0.4\"\n \n # A noop dependency that changes in the Rust repository, it's a bit of a hack.\n # See the `src/tools/rustc-workspace-hack/README.md` file in `rust-lang/rust`"}, {"sha": "3399f7ff782822ba267a1f0b3edb23ed98ffa674", "filename": "Configurations.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5b6f6431a3d81026a1987f5081e64262ac96af82/Configurations.md", "raw_url": "https://github.com/rust-lang/rust/raw/5b6f6431a3d81026a1987f5081e64262ac96af82/Configurations.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Configurations.md?ref=5b6f6431a3d81026a1987f5081e64262ac96af82", "patch": "@@ -1,6 +1,6 @@\n # Configuring Rustfmt\n \n-Rustfmt is designed to be very configurable. You can create a TOML file called `rustfmt.toml` or `.rustfmt.toml`, place it in the project or any other parent directory and it will apply the options in that file.\n+Rustfmt is designed to be very configurable. You can create a TOML file called `rustfmt.toml` or `.rustfmt.toml`, place it in the project or any other parent directory and it will apply the options in that file. If none of these directories contain such a file, both your home directory and a directory called `rustfmt` in your [global config directory](https://docs.rs/dirs/1.0.4/dirs/fn.config_dir.html) (e.g. `.config/rustfmt/`) are checked as well.\n \n A possible content of `rustfmt.toml` or `.rustfmt.toml` might look like this:\n "}, {"sha": "9e58eac52a22d906f199c9764d303cf69410b699", "filename": "src/config/config_type.rs", "status": "modified", "additions": 18, "deletions": 1, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/5b6f6431a3d81026a1987f5081e64262ac96af82/src%2Fconfig%2Fconfig_type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5b6f6431a3d81026a1987f5081e64262ac96af82/src%2Fconfig%2Fconfig_type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fconfig%2Fconfig_type.rs?ref=5b6f6431a3d81026a1987f5081e64262ac96af82", "patch": "@@ -345,9 +345,26 @@ macro_rules! create_config {\n \n                         // If the current directory has no parent, we're done searching.\n                         if !current.pop() {\n-                            return Ok(None);\n+                            break;\n                         }\n                     }\n+\n+                    // If nothing was found, check in the home directory.\n+                    if let Some(home_dir) = dirs::home_dir() {\n+                        if let Some(path) = get_toml_path(&home_dir)? {\n+                            return Ok(Some(path));\n+                        }\n+                    }\n+\n+                    // If none was found ther either, check in the user's configuration directory.\n+                    if let Some(mut config_dir) = dirs::config_dir() {\n+                        config_dir.push(\"rustfmt\");\n+                        if let Some(path) = get_toml_path(&config_dir)? {\n+                            return Ok(Some(path));\n+                        }\n+                    }\n+\n+                    return Ok(None);\n                 }\n \n                 match resolve_project_file(dir)? {"}, {"sha": "a6e531e476b8334be562c35e0a0c6edc24bb6262", "filename": "src/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5b6f6431a3d81026a1987f5081e64262ac96af82/src%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5b6f6431a3d81026a1987f5081e64262ac96af82/src%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flib.rs?ref=5b6f6431a3d81026a1987f5081e64262ac96af82", "patch": "@@ -13,6 +13,7 @@ extern crate derive_new;\n extern crate atty;\n extern crate bytecount;\n extern crate diff;\n+extern crate dirs;\n extern crate failure;\n extern crate itertools;\n #[cfg(test)]"}]}