{"sha": "16c7ebbb27dc81b4640b5694f36b381cae706c8d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE2YzdlYmJiMjdkYzgxYjQ2NDBiNTY5NGYzNmIzODFjYWU3MDZjOGQ=", "commit": {"author": {"name": "bors[bot]", "email": "bors[bot]@users.noreply.github.com", "date": "2019-02-18T09:26:24Z"}, "committer": {"name": "bors[bot]", "email": "bors[bot]@users.noreply.github.com", "date": "2019-02-18T09:26:24Z"}, "message": "Merge #854\n\n854: more compact edits in insta r=matklad a=matklad\n\n\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>", "tree": {"sha": "a6f9a860d59e24b0c9141ad8d73e980cfb9ed748", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a6f9a860d59e24b0c9141ad8d73e980cfb9ed748"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/16c7ebbb27dc81b4640b5694f36b381cae706c8d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/16c7ebbb27dc81b4640b5694f36b381cae706c8d", "html_url": "https://github.com/rust-lang/rust/commit/16c7ebbb27dc81b4640b5694f36b381cae706c8d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/16c7ebbb27dc81b4640b5694f36b381cae706c8d/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "parents": [{"sha": "564ab84b787cca0f5994451eb2ce9e1ba8c9d974", "url": "https://api.github.com/repos/rust-lang/rust/commits/564ab84b787cca0f5994451eb2ce9e1ba8c9d974", "html_url": "https://github.com/rust-lang/rust/commit/564ab84b787cca0f5994451eb2ce9e1ba8c9d974"}, {"sha": "a92db7c84829becdf95e0a5ef6e27cdf833518b8", "url": "https://api.github.com/repos/rust-lang/rust/commits/a92db7c84829becdf95e0a5ef6e27cdf833518b8", "html_url": "https://github.com/rust-lang/rust/commit/a92db7c84829becdf95e0a5ef6e27cdf833518b8"}], "stats": {"total": 955, "additions": 522, "deletions": 433}, "files": [{"sha": "b667381a7d17f77f40ceffd87421848b7004713e", "filename": "crates/ra_ide_api/src/completion/complete_keyword.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_keyword.rs", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_keyword.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_keyword.rs?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -40,7 +40,7 @@ pub(super) fn complete_use_tree_keyword(acc: &mut Completions, ctx: &CompletionC\n fn keyword(ctx: &CompletionContext, kw: &str, snippet: &str) -> CompletionItem {\n     CompletionItem::new(CompletionKind::Keyword, ctx.source_range(), kw)\n         .kind(CompletionItemKind::Keyword)\n-        .snippet(snippet)\n+        .insert_snippet(snippet)\n         .build()\n }\n "}, {"sha": "ce3d6ed3cb6c26944e49ddb68ef98c3afa7b2963", "filename": "crates/ra_ide_api/src/completion/complete_postfix.rs", "status": "modified", "additions": 9, "deletions": 8, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_postfix.rs", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_postfix.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_postfix.rs?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -16,15 +16,16 @@ use ra_syntax::{\n use ra_text_edit::TextEditBuilder;\n \n fn postfix_snippet(ctx: &CompletionContext, label: &str, detail: &str, snippet: &str) -> Builder {\n-    let replace_range = ctx.source_range();\n-    let receiver_range = ctx.dot_receiver.expect(\"no receiver available\").syntax().range();\n-    let delete_range = TextRange::from_to(receiver_range.start(), replace_range.start());\n-    let mut builder = TextEditBuilder::default();\n-    builder.delete(delete_range);\n-    CompletionItem::new(CompletionKind::Postfix, replace_range, label)\n-        .snippet(snippet)\n+    let edit = {\n+        let receiver_range = ctx.dot_receiver.expect(\"no receiver available\").syntax().range();\n+        let delete_range = TextRange::from_to(receiver_range.start(), ctx.source_range().end());\n+        let mut builder = TextEditBuilder::default();\n+        builder.replace(delete_range, snippet.to_string());\n+        builder.finish()\n+    };\n+    CompletionItem::new(CompletionKind::Postfix, ctx.source_range(), label)\n         .detail(detail)\n-        .text_edit(builder.finish())\n+        .snippet_edit(edit)\n }\n \n pub(super) fn complete_postfix(acc: &mut Completions, ctx: &CompletionContext) {"}, {"sha": "aa3a16fa267cab7137bf9a1380254df01ada2c0c", "filename": "crates/ra_ide_api/src/completion/complete_snippet.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_snippet.rs", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_snippet.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcomplete_snippet.rs?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -2,7 +2,7 @@ use crate::completion::{CompletionItem, Completions, CompletionKind, CompletionI\n \n fn snippet(ctx: &CompletionContext, label: &str, snippet: &str) -> Builder {\n     CompletionItem::new(CompletionKind::Snippet, ctx.source_range(), label)\n-        .snippet(snippet)\n+        .insert_snippet(snippet)\n         .kind(CompletionItemKind::Snippet)\n }\n "}, {"sha": "95bdd59b4e41f14cecd36672a08becd28314e0df", "filename": "crates/ra_ide_api/src/completion/completion_item.rs", "status": "modified", "additions": 68, "deletions": 46, "changes": 114, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcompletion_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcompletion_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fcompletion_item.rs?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -2,7 +2,7 @@ use std::fmt;\n \n use hir::{Docs, Documentation, PerNs, Resolution};\n use ra_syntax::TextRange;\n-use ra_text_edit::TextEdit;\n+use ra_text_edit::{ TextEditBuilder, TextEdit};\n use test_utils::tested_by;\n \n use crate::completion::{\n@@ -17,29 +17,53 @@ use crate::completion::{\n /// `CompletionItem`, use `new` method and the `Builder` struct.\n pub struct CompletionItem {\n     /// Used only internally in tests, to check only specific kind of\n-    /// completion.\n+    /// completion (postfix, keyword, reference, etc).\n     #[allow(unused)]\n     completion_kind: CompletionKind,\n+    /// Label in the completion pop up which identifies completion.\n     label: String,\n+    /// Range of identifier that is being completed.\n+    ///\n+    /// It should be used primarily for UI, but we also use this to convert\n+    /// genetic TextEdit into LSP's completion edit (see conv.rs).\n+    ///\n+    /// `source_range` must contain the completion offset. `insert_text` should\n+    /// start with what `source_range` points to, or VSCode will filter out the\n+    /// completion silently.\n+    source_range: TextRange,\n+    /// What happens when user selects this item.\n+    ///\n+    /// Typically, replaces `source_range` with new identifier.\n+    text_edit: TextEdit,\n+    insert_text_format: InsertTextFormat,\n+\n+    /// What item (struct, function, etc) are we completing.\n     kind: Option<CompletionItemKind>,\n+\n+    /// Lookup is used to check if completion item indeed can complete current\n+    /// ident.\n+    ///\n+    /// That is, in `foo.bar<|>` lookup of `abracadabra` will be accepted (it\n+    /// contains `bar` sub sequence), and `quux` will rejected.\n     lookup: Option<String>,\n+\n+    /// Additional info to show in the UI pop up.\n     detail: Option<String>,\n     documentation: Option<Documentation>,\n-    insert_text: Option<String>,\n-    insert_text_format: InsertTextFormat,\n-    /// Where completion occurs. `source_range` must contain the completion offset.\n-    /// `insert_text` should start with what `source_range` points to, or VSCode\n-    /// will filter out the completion silently.\n-    source_range: TextRange,\n-    /// Additional text edit, ranges in `text_edit` must never intersect with `source_range`.\n-    /// Or VSCode will drop it silently.\n-    text_edit: Option<TextEdit>,\n }\n \n+// We use custom debug for CompletionItem to make `insta`'s diffs more readable.\n impl fmt::Debug for CompletionItem {\n     fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {\n         let mut s = f.debug_struct(\"CompletionItem\");\n         s.field(\"label\", &self.label()).field(\"source_range\", &self.source_range());\n+        if self.text_edit().as_atoms().len() == 1 {\n+            let atom = &self.text_edit().as_atoms()[0];\n+            s.field(\"delete\", &atom.delete);\n+            s.field(\"insert\", &atom.insert);\n+        } else {\n+            s.field(\"text_edit\", &self.text_edit);\n+        }\n         if let Some(kind) = self.kind().as_ref() {\n             s.field(\"kind\", kind);\n         }\n@@ -52,13 +76,6 @@ impl fmt::Debug for CompletionItem {\n         if let Some(documentation) = self.documentation() {\n             s.field(\"documentation\", &documentation);\n         }\n-        if self.insert_text() != self.label() {\n-            s.field(\"insert_text\", &self.insert_text())\n-                .field(\"insert_text_format\", &self.insert_text_format());\n-        }\n-        if let Some(edit) = self.text_edit.as_ref() {\n-            s.field(\"text_edit\", edit);\n-        }\n         s.finish()\n     }\n }\n@@ -103,12 +120,12 @@ pub enum InsertTextFormat {\n impl CompletionItem {\n     pub(crate) fn new(\n         completion_kind: CompletionKind,\n-        replace_range: TextRange,\n+        source_range: TextRange,\n         label: impl Into<String>,\n     ) -> Builder {\n         let label = label.into();\n         Builder {\n-            source_range: replace_range,\n+            source_range,\n             completion_kind,\n             label,\n             insert_text: None,\n@@ -124,6 +141,18 @@ impl CompletionItem {\n     pub fn label(&self) -> &str {\n         &self.label\n     }\n+    pub fn source_range(&self) -> TextRange {\n+        self.source_range\n+    }\n+\n+    pub fn insert_text_format(&self) -> InsertTextFormat {\n+        self.insert_text_format\n+    }\n+\n+    pub fn text_edit(&self) -> &TextEdit {\n+        &self.text_edit\n+    }\n+\n     /// Short one-line additional information, like a type\n     pub fn detail(&self) -> Option<&str> {\n         self.detail.as_ref().map(|it| it.as_str())\n@@ -137,24 +166,9 @@ impl CompletionItem {\n         self.lookup.as_ref().map(|it| it.as_str()).unwrap_or_else(|| self.label())\n     }\n \n-    pub fn insert_text_format(&self) -> InsertTextFormat {\n-        self.insert_text_format\n-    }\n-    pub fn insert_text(&self) -> String {\n-        match &self.insert_text {\n-            Some(t) => t.clone(),\n-            None => self.label.clone(),\n-        }\n-    }\n     pub fn kind(&self) -> Option<CompletionItemKind> {\n         self.kind\n     }\n-    pub fn take_text_edit(&mut self) -> Option<TextEdit> {\n-        self.text_edit.take()\n-    }\n-    pub fn source_range(&self) -> TextRange {\n-        self.source_range\n-    }\n }\n \n /// A helper to make `CompletionItem`s.\n@@ -178,17 +192,27 @@ impl Builder {\n     }\n \n     pub(crate) fn build(self) -> CompletionItem {\n+        let label = self.label;\n+        let text_edit = match self.text_edit {\n+            Some(it) => it,\n+            None => {\n+                let mut builder = TextEditBuilder::default();\n+                builder\n+                    .replace(self.source_range, self.insert_text.unwrap_or_else(|| label.clone()));\n+                builder.finish()\n+            }\n+        };\n+\n         CompletionItem {\n             source_range: self.source_range,\n-            label: self.label,\n+            label,\n+            insert_text_format: self.insert_text_format,\n+            text_edit,\n             detail: self.detail,\n             documentation: self.documentation,\n-            insert_text_format: self.insert_text_format,\n             lookup: self.lookup,\n             kind: self.kind,\n             completion_kind: self.completion_kind,\n-            text_edit: self.text_edit,\n-            insert_text: self.insert_text,\n         }\n     }\n     pub(crate) fn lookup_by(mut self, lookup: impl Into<String>) -> Builder {\n@@ -199,24 +223,22 @@ impl Builder {\n         self.insert_text = Some(insert_text.into());\n         self\n     }\n-    #[allow(unused)]\n-    pub(crate) fn insert_text_format(mut self, insert_text_format: InsertTextFormat) -> Builder {\n-        self.insert_text_format = insert_text_format;\n-        self\n-    }\n-    pub(crate) fn snippet(mut self, snippet: impl Into<String>) -> Builder {\n+    pub(crate) fn insert_snippet(mut self, snippet: impl Into<String>) -> Builder {\n         self.insert_text_format = InsertTextFormat::Snippet;\n         self.insert_text(snippet)\n     }\n     pub(crate) fn kind(mut self, kind: CompletionItemKind) -> Builder {\n         self.kind = Some(kind);\n         self\n     }\n-    #[allow(unused)]\n     pub(crate) fn text_edit(mut self, edit: TextEdit) -> Builder {\n         self.text_edit = Some(edit);\n         self\n     }\n+    pub(crate) fn snippet_edit(mut self, edit: TextEdit) -> Builder {\n+        self.insert_text_format = InsertTextFormat::Snippet;\n+        self.text_edit(edit)\n+    }\n     #[allow(unused)]\n     pub(crate) fn detail(self, detail: impl Into<String>) -> Builder {\n         self.set_detail(Some(detail))"}, {"sha": "bd7f99f7123f1eac03602337c8d65481833c571b", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__bindings_from_for.snap", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_for.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_for.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_for.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.736783986Z\"\n+created: \"2019-02-18T09:22:24.132341107Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,14 +8,16 @@ expression: kind_completions\n     CompletionItem {\n         label: \"quux\",\n         source_range: [83; 83),\n+        delete: [83; 83),\n+        insert: \"quux()$0\",\n         kind: Function,\n-        detail: \"fn quux()\",\n-        insert_text: \"quux()$0\",\n-        insert_text_format: Snippet\n+        detail: \"fn quux()\"\n     },\n     CompletionItem {\n         label: \"x\",\n         source_range: [83; 83),\n+        delete: [83; 83),\n+        insert: \"x\",\n         kind: Binding\n     }\n ]"}, {"sha": "3b374c4defbfab815464a1e93b6eea6861c9515a", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__bindings_from_if_let.snap", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_if_let.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_if_let.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_if_let.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.739513594Z\"\n+created: \"2019-02-18T09:22:24.126809445Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,19 +8,23 @@ expression: kind_completions\n     CompletionItem {\n         label: \"a\",\n         source_range: [214; 214),\n+        delete: [214; 214),\n+        insert: \"a\",\n         kind: Binding\n     },\n     CompletionItem {\n         label: \"b\",\n         source_range: [214; 214),\n+        delete: [214; 214),\n+        insert: \"b\",\n         kind: Binding\n     },\n     CompletionItem {\n         label: \"quux\",\n         source_range: [214; 214),\n+        delete: [214; 214),\n+        insert: \"quux()$0\",\n         kind: Function,\n-        detail: \"fn quux()\",\n-        insert_text: \"quux()$0\",\n-        insert_text_format: Snippet\n+        detail: \"fn quux()\"\n     }\n ]"}, {"sha": "173f5319ade6385e01ddae66701018276373c0a1", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__bindings_from_let.snap", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_let.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_let.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__bindings_from_let.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.739513592Z\"\n+created: \"2019-02-18T09:22:24.126696322Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,19 +8,23 @@ expression: kind_completions\n     CompletionItem {\n         label: \"quux\",\n         source_range: [79; 79),\n+        delete: [79; 79),\n+        insert: \"quux($0)\",\n         kind: Function,\n-        detail: \"fn quux(x: i32)\",\n-        insert_text: \"quux($0)\",\n-        insert_text_format: Snippet\n+        detail: \"fn quux(x: i32)\"\n     },\n     CompletionItem {\n         label: \"x\",\n         source_range: [79; 79),\n+        delete: [79; 79),\n+        insert: \"x\",\n         kind: Binding\n     },\n     CompletionItem {\n         label: \"y\",\n         source_range: [79; 79),\n+        delete: [79; 79),\n+        insert: \"y\",\n         kind: Binding\n     }\n ]"}, {"sha": "42ff024691eef52ef125911709810ce736c96b3c", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__completes_break_and_continue_in_loops1.snap", "status": "modified", "additions": 22, "deletions": 22, "changes": 44, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_break_and_continue_in_loops1.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_break_and_continue_in_loops1.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_break_and_continue_in_loops1.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.630948152Z\"\n+created: \"2019-02-18T09:22:23.976673150Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,50 +8,50 @@ expression: kind_completions\n     CompletionItem {\n         label: \"break\",\n         source_range: [55; 55),\n-        kind: Keyword,\n-        insert_text: \"break;\",\n-        insert_text_format: Snippet\n+        delete: [55; 55),\n+        insert: \"break;\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"continue\",\n         source_range: [55; 55),\n-        kind: Keyword,\n-        insert_text: \"continue;\",\n-        insert_text_format: Snippet\n+        delete: [55; 55),\n+        insert: \"continue;\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"if\",\n         source_range: [55; 55),\n-        kind: Keyword,\n-        insert_text: \"if $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [55; 55),\n+        insert: \"if $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"loop\",\n         source_range: [55; 55),\n-        kind: Keyword,\n-        insert_text: \"loop {$0}\",\n-        insert_text_format: Snippet\n+        delete: [55; 55),\n+        insert: \"loop {$0}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"match\",\n         source_range: [55; 55),\n-        kind: Keyword,\n-        insert_text: \"match $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [55; 55),\n+        insert: \"match $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"return\",\n         source_range: [55; 55),\n-        kind: Keyword,\n-        insert_text: \"return $0;\",\n-        insert_text_format: Snippet\n+        delete: [55; 55),\n+        insert: \"return $0;\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"while\",\n         source_range: [55; 55),\n-        kind: Keyword,\n-        insert_text: \"while $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [55; 55),\n+        insert: \"while $0 {}\",\n+        kind: Keyword\n     }\n ]"}, {"sha": "057ff8a7ace2a3bc6db96a50e0f83003f5d9bb4c", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__completes_break_and_continue_in_loops2.snap", "status": "modified", "additions": 16, "deletions": 16, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_break_and_continue_in_loops2.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_break_and_continue_in_loops2.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_break_and_continue_in_loops2.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.662074625Z\"\n+created: \"2019-02-18T09:22:24.068967569Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,36 +8,36 @@ expression: kind_completions\n     CompletionItem {\n         label: \"if\",\n         source_range: [60; 60),\n-        kind: Keyword,\n-        insert_text: \"if $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [60; 60),\n+        insert: \"if $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"loop\",\n         source_range: [60; 60),\n-        kind: Keyword,\n-        insert_text: \"loop {$0}\",\n-        insert_text_format: Snippet\n+        delete: [60; 60),\n+        insert: \"loop {$0}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"match\",\n         source_range: [60; 60),\n-        kind: Keyword,\n-        insert_text: \"match $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [60; 60),\n+        insert: \"match $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"return\",\n         source_range: [60; 60),\n-        kind: Keyword,\n-        insert_text: \"return $0;\",\n-        insert_text_format: Snippet\n+        delete: [60; 60),\n+        insert: \"return $0;\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"while\",\n         source_range: [60; 60),\n-        kind: Keyword,\n-        insert_text: \"while $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [60; 60),\n+        insert: \"while $0 {}\",\n+        kind: Keyword\n     }\n ]"}, {"sha": "16126ee7772d10b462dd1a997cff2a749d308d03", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__completes_prelude.snap", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_prelude.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_prelude.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_prelude.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.774580359Z\"\n+created: \"2019-02-18T09:22:24.180517434Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,19 +8,23 @@ expression: kind_completions\n     CompletionItem {\n         label: \"Option\",\n         source_range: [18; 18),\n+        delete: [18; 18),\n+        insert: \"Option\",\n         kind: Struct\n     },\n     CompletionItem {\n         label: \"foo\",\n         source_range: [18; 18),\n+        delete: [18; 18),\n+        insert: \"foo()$0\",\n         kind: Function,\n-        detail: \"fn foo()\",\n-        insert_text: \"foo()$0\",\n-        insert_text_format: Snippet\n+        detail: \"fn foo()\"\n     },\n     CompletionItem {\n         label: \"std\",\n         source_range: [18; 18),\n+        delete: [18; 18),\n+        insert: \"std\",\n         kind: Module\n     }\n ]"}, {"sha": "2420e7744549d758a797cf238bbd86c60b5ae260", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__completes_use_paths_across_crates.snap", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_use_paths_across_crates.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_use_paths_across_crates.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__completes_use_paths_across_crates.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.729954589Z\"\n+created: \"2019-02-18T09:22:24.118807216Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,6 +8,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"bar\",\n         source_range: [9; 9),\n+        delete: [9; 9),\n+        insert: \"bar\",\n         kind: Module\n     }\n ]"}, {"sha": "c472f796593e3e614e439b6018ff5e464d977495", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__deeply_nested_use_tree.snap", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__deeply_nested_use_tree.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__deeply_nested_use_tree.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__deeply_nested_use_tree.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.663233766Z\"\n+created: \"2019-02-18T09:22:24.044567777Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,6 +8,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"Spam\",\n         source_range: [23; 25),\n+        delete: [23; 25),\n+        insert: \"Spam\",\n         kind: Struct\n     }\n ]"}, {"sha": "97bd76c494c5c07fd136c11aed96fa55c5338fb1", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__dont_add_semi_after_return_if_not_a_statement.snap", "status": "modified", "additions": 16, "deletions": 16, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_add_semi_after_return_if_not_a_statement.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_add_semi_after_return_if_not_a_statement.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_add_semi_after_return_if_not_a_statement.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.637726929Z\"\n+created: \"2019-02-18T09:22:23.987788705Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,36 +8,36 @@ expression: kind_completions\n     CompletionItem {\n         label: \"if\",\n         source_range: [85; 85),\n-        kind: Keyword,\n-        insert_text: \"if $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [85; 85),\n+        insert: \"if $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"loop\",\n         source_range: [85; 85),\n-        kind: Keyword,\n-        insert_text: \"loop {$0}\",\n-        insert_text_format: Snippet\n+        delete: [85; 85),\n+        insert: \"loop {$0}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"match\",\n         source_range: [85; 85),\n-        kind: Keyword,\n-        insert_text: \"match $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [85; 85),\n+        insert: \"match $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"return\",\n         source_range: [85; 85),\n-        kind: Keyword,\n-        insert_text: \"return $0\",\n-        insert_text_format: Snippet\n+        delete: [85; 85),\n+        insert: \"return $0\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"while\",\n         source_range: [85; 85),\n-        kind: Keyword,\n-        insert_text: \"while $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [85; 85),\n+        insert: \"while $0 {}\",\n+        kind: Keyword\n     }\n ]"}, {"sha": "1de0efb5b36ba61703cf316fe123d0e64bb7ac51", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__dont_render_function_parens_if_already_call.snap", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_render_function_parens_if_already_call.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_render_function_parens_if_already_call.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_render_function_parens_if_already_call.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.812347626Z\"\n+created: \"2019-02-18T09:22:24.211680376Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,12 +8,16 @@ expression: kind_completions\n     CompletionItem {\n         label: \"frobnicate\",\n         source_range: [35; 39),\n+        delete: [35; 39),\n+        insert: \"frobnicate\",\n         kind: Function,\n         detail: \"fn frobnicate()\"\n     },\n     CompletionItem {\n         label: \"main\",\n         source_range: [35; 39),\n+        delete: [35; 39),\n+        insert: \"main\",\n         kind: Function,\n         detail: \"fn main()\"\n     }"}, {"sha": "39fff2cb7666c48049f71e67b5aecd6b9ab99f4c", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__dont_render_function_parens_if_already_call_assoc_fn.snap", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_render_function_parens_if_already_call_assoc_fn.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_render_function_parens_if_already_call_assoc_fn.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_render_function_parens_if_already_call_assoc_fn.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.843178841Z\"\n+created: \"2019-02-18T09:22:24.268227065Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,6 +8,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"new\",\n         source_range: [67; 69),\n+        delete: [67; 69),\n+        insert: \"new\",\n         kind: Method,\n         detail: \"fn new() -> Foo\"\n     }"}, {"sha": "ef77816ec1f35d8e7ed18dd0ecdaee98125b19a8", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__dont_render_function_parens_in_use_item.snap", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_render_function_parens_in_use_item.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_render_function_parens_in_use_item.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_render_function_parens_in_use_item.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.808400485Z\"\n+created: \"2019-02-18T09:22:24.213677341Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,6 +8,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"foo\",\n         source_range: [40; 41),\n+        delete: [40; 41),\n+        insert: \"foo\",\n         kind: Function,\n         detail: \"pub fn foo()\"\n     }"}, {"sha": "87691b3040249936a5d9ff260a8edde022ebd3f9", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__dont_show_both_completions_for_shadowing.snap", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_show_both_completions_for_shadowing.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_show_both_completions_for_shadowing.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__dont_show_both_completions_for_shadowing.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.810202671Z\"\n+created: \"2019-02-18T09:22:24.188564584Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,14 +8,16 @@ expression: kind_completions\n     CompletionItem {\n         label: \"bar\",\n         source_range: [129; 129),\n+        delete: [129; 129),\n+        insert: \"bar\",\n         kind: Binding\n     },\n     CompletionItem {\n         label: \"foo\",\n         source_range: [129; 129),\n+        delete: [129; 129),\n+        insert: \"foo()$0\",\n         kind: Function,\n-        detail: \"fn foo() ->\",\n-        insert_text: \"foo()$0\",\n-        insert_text_format: Snippet\n+        detail: \"fn foo() ->\"\n     }\n ]"}, {"sha": "1df121523b670322d01d127312c0618fa014c160", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__enum_variant.snap", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__enum_variant.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__enum_variant.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__enum_variant.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.672144115Z\"\n+created: \"2019-02-18T09:22:24.045355450Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,6 +8,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"Bar\",\n         source_range: [116; 116),\n+        delete: [116; 116),\n+        insert: \"Bar\",\n         kind: EnumVariant,\n         detail: \"(i32)\",\n         documentation: Documentation(\n@@ -17,6 +19,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"Foo\",\n         source_range: [116; 116),\n+        delete: [116; 116),\n+        insert: \"Foo\",\n         kind: EnumVariant,\n         detail: \"()\",\n         documentation: Documentation("}, {"sha": "70ea96e1bd76d4e95f9bacd4b485dd6a29f6f864", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__enum_variant_with_details.snap", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__enum_variant_with_details.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__enum_variant_with_details.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__enum_variant_with_details.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.686329490Z\"\n+created: \"2019-02-18T09:22:24.062138085Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,6 +8,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"Bar\",\n         source_range: [180; 180),\n+        delete: [180; 180),\n+        insert: \"Bar\",\n         kind: EnumVariant,\n         detail: \"(i32, u32)\",\n         documentation: Documentation(\n@@ -17,6 +19,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"Foo\",\n         source_range: [180; 180),\n+        delete: [180; 180),\n+        insert: \"Foo\",\n         kind: EnumVariant,\n         detail: \"()\",\n         documentation: Documentation(\n@@ -26,6 +30,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"S\",\n         source_range: [180; 180),\n+        delete: [180; 180),\n+        insert: \"S\",\n         kind: EnumVariant,\n         detail: \"(S)\"\n     }"}, {"sha": "0d36fd6035d4a7d6dd824236acb4ea28d0a3b74c", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__extern_prelude.snap", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__extern_prelude.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__extern_prelude.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__extern_prelude.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.763042807Z\"\n+created: \"2019-02-18T09:22:24.137183638Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,6 +8,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"other_crate\",\n         source_range: [4; 4),\n+        delete: [4; 4),\n+        insert: \"other_crate\",\n         kind: Module\n     }\n ]"}, {"sha": "210e5a02d28c78712f7c0fb18db227fd72d40e56", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__generic_params.snap", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__generic_params.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__generic_params.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__generic_params.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.765665697Z\"\n+created: \"2019-02-18T09:22:24.143253235Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,14 +8,16 @@ expression: kind_completions\n     CompletionItem {\n         label: \"T\",\n         source_range: [44; 44),\n+        delete: [44; 44),\n+        insert: \"T\",\n         kind: TypeParam\n     },\n     CompletionItem {\n         label: \"quux\",\n         source_range: [44; 44),\n+        delete: [44; 44),\n+        insert: \"quux()$0\",\n         kind: Function,\n-        detail: \"fn quux<T>()\",\n-        insert_text: \"quux()$0\",\n-        insert_text_format: Snippet\n+        detail: \"fn quux<T>()\"\n     }\n ]"}, {"sha": "ab8c3044674327d50aea702e7ffddf8dcc6d2ee9", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__generic_params_in_struct.snap", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__generic_params_in_struct.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__generic_params_in_struct.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__generic_params_in_struct.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.768275744Z\"\n+created: \"2019-02-18T09:22:24.149424158Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,11 +8,15 @@ expression: kind_completions\n     CompletionItem {\n         label: \"T\",\n         source_range: [46; 46),\n+        delete: [46; 46),\n+        insert: \"T\",\n         kind: TypeParam\n     },\n     CompletionItem {\n         label: \"X\",\n         source_range: [46; 46),\n+        delete: [46; 46),\n+        insert: \"X\",\n         kind: Struct\n     }\n ]"}, {"sha": "a4fc447b27795dee34f9f2c96a25c7d54fcf26db", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__inserts_parens_for_function_calls1.snap", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__inserts_parens_for_function_calls1.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__inserts_parens_for_function_calls1.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__inserts_parens_for_function_calls1.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.808403924Z\"\n+created: \"2019-02-18T09:22:24.224510370Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,17 +8,17 @@ expression: kind_completions\n     CompletionItem {\n         label: \"main\",\n         source_range: [53; 56),\n+        delete: [53; 56),\n+        insert: \"main()$0\",\n         kind: Function,\n-        detail: \"fn main()\",\n-        insert_text: \"main()$0\",\n-        insert_text_format: Snippet\n+        detail: \"fn main()\"\n     },\n     CompletionItem {\n         label: \"no_args\",\n         source_range: [53; 56),\n+        delete: [53; 56),\n+        insert: \"no_args()$0\",\n         kind: Function,\n-        detail: \"fn no_args()\",\n-        insert_text: \"no_args()$0\",\n-        insert_text_format: Snippet\n+        detail: \"fn no_args()\"\n     }\n ]"}, {"sha": "b124355d5e18e1cc4ddde1df0716cbfe7bc38a20", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__inserts_parens_for_function_calls2.snap", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__inserts_parens_for_function_calls2.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__inserts_parens_for_function_calls2.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__inserts_parens_for_function_calls2.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.843178843Z\"\n+created: \"2019-02-18T09:22:24.267013140Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,17 +8,17 @@ expression: kind_completions\n     CompletionItem {\n         label: \"main\",\n         source_range: [72; 77),\n+        delete: [72; 77),\n+        insert: \"main()$0\",\n         kind: Function,\n-        detail: \"fn main()\",\n-        insert_text: \"main()$0\",\n-        insert_text_format: Snippet\n+        detail: \"fn main()\"\n     },\n     CompletionItem {\n         label: \"with_args\",\n         source_range: [72; 77),\n+        delete: [72; 77),\n+        insert: \"with_args($0)\",\n         kind: Function,\n-        detail: \"fn with_args(x: i32, y: String)\",\n-        insert_text: \"with_args($0)\",\n-        insert_text_format: Snippet\n+        detail: \"fn with_args(x: i32, y: String)\"\n     }\n ]"}, {"sha": "fec729d4873510f643ab44fb8c3a901400a8127e", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__inserts_parens_for_function_calls3.snap", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__inserts_parens_for_function_calls3.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__inserts_parens_for_function_calls3.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__inserts_parens_for_function_calls3.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.877573951Z\"\n+created: \"2019-02-18T09:22:24.303360770Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,9 +8,9 @@ expression: kind_completions\n     CompletionItem {\n         label: \"foo\",\n         source_range: [139; 140),\n+        delete: [139; 140),\n+        insert: \"foo()$0\",\n         kind: Method,\n-        detail: \"fn foo(&self)\",\n-        insert_text: \"foo()$0\",\n-        insert_text_format: Snippet\n+        detail: \"fn foo(&self)\"\n     }\n ]"}, {"sha": "045e2a4e6f58301af51c8c7d858ef8deb9e084da", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__keywords_in_function1.snap", "status": "modified", "additions": 16, "deletions": 16, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function1.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function1.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function1.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.639066512Z\"\n+created: \"2019-02-18T09:22:23.987788720Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,36 +8,36 @@ expression: kind_completions\n     CompletionItem {\n         label: \"if\",\n         source_range: [41; 41),\n-        kind: Keyword,\n-        insert_text: \"if $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [41; 41),\n+        insert: \"if $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"loop\",\n         source_range: [41; 41),\n-        kind: Keyword,\n-        insert_text: \"loop {$0}\",\n-        insert_text_format: Snippet\n+        delete: [41; 41),\n+        insert: \"loop {$0}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"match\",\n         source_range: [41; 41),\n-        kind: Keyword,\n-        insert_text: \"match $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [41; 41),\n+        insert: \"match $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"return\",\n         source_range: [41; 41),\n-        kind: Keyword,\n-        insert_text: \"return;\",\n-        insert_text_format: Snippet\n+        delete: [41; 41),\n+        insert: \"return;\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"while\",\n         source_range: [41; 41),\n-        kind: Keyword,\n-        insert_text: \"while $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [41; 41),\n+        insert: \"while $0 {}\",\n+        kind: Keyword\n     }\n ]"}, {"sha": "b08efa522eae0289729e361ab43fb5b19f9304a1", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__keywords_in_function2.snap", "status": "modified", "additions": 22, "deletions": 22, "changes": 44, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function2.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function2.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function2.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.630760038Z\"\n+created: \"2019-02-18T09:22:23.984740354Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,50 +8,50 @@ expression: kind_completions\n     CompletionItem {\n         label: \"else\",\n         source_range: [92; 92),\n-        kind: Keyword,\n-        insert_text: \"else {$0}\",\n-        insert_text_format: Snippet\n+        delete: [92; 92),\n+        insert: \"else {$0}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"else if\",\n         source_range: [92; 92),\n-        kind: Keyword,\n-        insert_text: \"else if $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [92; 92),\n+        insert: \"else if $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"if\",\n         source_range: [92; 92),\n-        kind: Keyword,\n-        insert_text: \"if $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [92; 92),\n+        insert: \"if $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"loop\",\n         source_range: [92; 92),\n-        kind: Keyword,\n-        insert_text: \"loop {$0}\",\n-        insert_text_format: Snippet\n+        delete: [92; 92),\n+        insert: \"loop {$0}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"match\",\n         source_range: [92; 92),\n-        kind: Keyword,\n-        insert_text: \"match $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [92; 92),\n+        insert: \"match $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"return\",\n         source_range: [92; 92),\n-        kind: Keyword,\n-        insert_text: \"return;\",\n-        insert_text_format: Snippet\n+        delete: [92; 92),\n+        insert: \"return;\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"while\",\n         source_range: [92; 92),\n-        kind: Keyword,\n-        insert_text: \"while $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [92; 92),\n+        insert: \"while $0 {}\",\n+        kind: Keyword\n     }\n ]"}, {"sha": "e2b9214fbc1c0a703af4bc4877767926118f46ae", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__keywords_in_function3.snap", "status": "modified", "additions": 16, "deletions": 16, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function3.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function3.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function3.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.659527166Z\"\n+created: \"2019-02-18T09:22:24.049699338Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,36 +8,36 @@ expression: kind_completions\n     CompletionItem {\n         label: \"if\",\n         source_range: [48; 48),\n-        kind: Keyword,\n-        insert_text: \"if $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [48; 48),\n+        insert: \"if $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"loop\",\n         source_range: [48; 48),\n-        kind: Keyword,\n-        insert_text: \"loop {$0}\",\n-        insert_text_format: Snippet\n+        delete: [48; 48),\n+        insert: \"loop {$0}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"match\",\n         source_range: [48; 48),\n-        kind: Keyword,\n-        insert_text: \"match $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [48; 48),\n+        insert: \"match $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"return\",\n         source_range: [48; 48),\n-        kind: Keyword,\n-        insert_text: \"return $0;\",\n-        insert_text_format: Snippet\n+        delete: [48; 48),\n+        insert: \"return $0;\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"while\",\n         source_range: [48; 48),\n-        kind: Keyword,\n-        insert_text: \"while $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [48; 48),\n+        insert: \"while $0 {}\",\n+        kind: Keyword\n     }\n ]"}, {"sha": "1ea7eb5ceabab9c29b62e05e36565b35fef16df5", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__keywords_in_function4.snap", "status": "modified", "additions": 16, "deletions": 16, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function4.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function4.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_function4.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.696757543Z\"\n+created: \"2019-02-18T09:22:24.090949782Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,36 +8,36 @@ expression: kind_completions\n     CompletionItem {\n         label: \"if\",\n         source_range: [41; 41),\n-        kind: Keyword,\n-        insert_text: \"if $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [41; 41),\n+        insert: \"if $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"loop\",\n         source_range: [41; 41),\n-        kind: Keyword,\n-        insert_text: \"loop {$0}\",\n-        insert_text_format: Snippet\n+        delete: [41; 41),\n+        insert: \"loop {$0}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"match\",\n         source_range: [41; 41),\n-        kind: Keyword,\n-        insert_text: \"match $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [41; 41),\n+        insert: \"match $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"return\",\n         source_range: [41; 41),\n-        kind: Keyword,\n-        insert_text: \"return;\",\n-        insert_text_format: Snippet\n+        delete: [41; 41),\n+        insert: \"return;\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"while\",\n         source_range: [41; 41),\n-        kind: Keyword,\n-        insert_text: \"while $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [41; 41),\n+        insert: \"while $0 {}\",\n+        kind: Keyword\n     }\n ]"}, {"sha": "76d5daf556b79ad6409d161a66471506ed311d2f", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__keywords_in_use_stmt1.snap", "status": "modified", "additions": 9, "deletions": 7, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt1.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt1.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt1.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.633925638Z\"\n+created: \"2019-02-18T09:22:23.988755424Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,20 +8,22 @@ expression: kind_completions\n     CompletionItem {\n         label: \"crate\",\n         source_range: [17; 17),\n-        kind: Keyword,\n-        insert_text: \"crate::\",\n-        insert_text_format: PlainText\n+        delete: [17; 17),\n+        insert: \"crate::\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"self\",\n         source_range: [17; 17),\n+        delete: [17; 17),\n+        insert: \"self\",\n         kind: Keyword\n     },\n     CompletionItem {\n         label: \"super\",\n         source_range: [17; 17),\n-        kind: Keyword,\n-        insert_text: \"super::\",\n-        insert_text_format: PlainText\n+        delete: [17; 17),\n+        insert: \"super::\",\n+        kind: Keyword\n     }\n ]"}, {"sha": "ee8bf4ca12b3e9e6d40c5aa847309198d7f24422", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__keywords_in_use_stmt2.snap", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt2.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt2.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt2.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.658885169Z\"\n+created: \"2019-02-18T09:22:24.030382527Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,13 +8,15 @@ expression: kind_completions\n     CompletionItem {\n         label: \"self\",\n         source_range: [20; 20),\n+        delete: [20; 20),\n+        insert: \"self\",\n         kind: Keyword\n     },\n     CompletionItem {\n         label: \"super\",\n         source_range: [20; 20),\n-        kind: Keyword,\n-        insert_text: \"super::\",\n-        insert_text_format: PlainText\n+        delete: [20; 20),\n+        insert: \"super::\",\n+        kind: Keyword\n     }\n ]"}, {"sha": "b44db276e176b9ee62f3016e08d8c3324fac060d", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__keywords_in_use_stmt3.snap", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt3.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt3.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__keywords_in_use_stmt3.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.688856977Z\"\n+created: \"2019-02-18T09:22:24.073607133Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,13 +8,15 @@ expression: kind_completions\n     CompletionItem {\n         label: \"self\",\n         source_range: [24; 24),\n+        delete: [24; 24),\n+        insert: \"self\",\n         kind: Keyword\n     },\n     CompletionItem {\n         label: \"super\",\n         source_range: [24; 24),\n-        kind: Keyword,\n-        insert_text: \"super::\",\n-        insert_text_format: PlainText\n+        delete: [24; 24),\n+        insert: \"super::\",\n+        kind: Keyword\n     }\n ]"}, {"sha": "f220d35c265dccd743ecc1cfe29ad934e1eff16c", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__last_return_in_block_has_semi1.snap", "status": "modified", "additions": 16, "deletions": 16, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__last_return_in_block_has_semi1.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__last_return_in_block_has_semi1.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__last_return_in_block_has_semi1.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.638715790Z\"\n+created: \"2019-02-18T09:22:23.989188654Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,36 +8,36 @@ expression: kind_completions\n     CompletionItem {\n         label: \"if\",\n         source_range: [83; 83),\n-        kind: Keyword,\n-        insert_text: \"if $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [83; 83),\n+        insert: \"if $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"loop\",\n         source_range: [83; 83),\n-        kind: Keyword,\n-        insert_text: \"loop {$0}\",\n-        insert_text_format: Snippet\n+        delete: [83; 83),\n+        insert: \"loop {$0}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"match\",\n         source_range: [83; 83),\n-        kind: Keyword,\n-        insert_text: \"match $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [83; 83),\n+        insert: \"match $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"return\",\n         source_range: [83; 83),\n-        kind: Keyword,\n-        insert_text: \"return $0;\",\n-        insert_text_format: Snippet\n+        delete: [83; 83),\n+        insert: \"return $0;\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"while\",\n         source_range: [83; 83),\n-        kind: Keyword,\n-        insert_text: \"while $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [83; 83),\n+        insert: \"while $0 {}\",\n+        kind: Keyword\n     }\n ]"}, {"sha": "d2093acdfd8e9c3c0562041395ea3b0e5c8f7cde", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__last_return_in_block_has_semi2.snap", "status": "modified", "additions": 16, "deletions": 16, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__last_return_in_block_has_semi2.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__last_return_in_block_has_semi2.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__last_return_in_block_has_semi2.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.661936290Z\"\n+created: \"2019-02-18T09:22:24.036383875Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,36 +8,36 @@ expression: kind_completions\n     CompletionItem {\n         label: \"if\",\n         source_range: [83; 83),\n-        kind: Keyword,\n-        insert_text: \"if $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [83; 83),\n+        insert: \"if $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"loop\",\n         source_range: [83; 83),\n-        kind: Keyword,\n-        insert_text: \"loop {$0}\",\n-        insert_text_format: Snippet\n+        delete: [83; 83),\n+        insert: \"loop {$0}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"match\",\n         source_range: [83; 83),\n-        kind: Keyword,\n-        insert_text: \"match $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [83; 83),\n+        insert: \"match $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"return\",\n         source_range: [83; 83),\n-        kind: Keyword,\n-        insert_text: \"return $0;\",\n-        insert_text_format: Snippet\n+        delete: [83; 83),\n+        insert: \"return $0;\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"while\",\n         source_range: [83; 83),\n-        kind: Keyword,\n-        insert_text: \"while $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [83; 83),\n+        insert: \"while $0 {}\",\n+        kind: Keyword\n     }\n ]"}, {"sha": "ce8af2159ee6ee1b443310aff21abd58adb89f2c", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__method_attr_filtering.snap", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__method_attr_filtering.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__method_attr_filtering.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__method_attr_filtering.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.598946710Z\"\n+created: \"2019-02-18T09:22:23.941335305Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,9 +8,9 @@ expression: kind_completions\n     CompletionItem {\n         label: \"the_method\",\n         source_range: [249; 249),\n+        delete: [249; 249),\n+        insert: \"the_method()$0\",\n         kind: Method,\n-        detail: \"fn the_method(&self)\",\n-        insert_text: \"the_method()$0\",\n-        insert_text_format: Snippet\n+        detail: \"fn the_method(&self)\"\n     }\n ]"}, {"sha": "41a10de14d9e604443e3c1be948982386760e272", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__method_completion.snap", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__method_completion.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__method_completion.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__method_completion.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.598948318Z\"\n+created: \"2019-02-18T09:22:23.939676100Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,9 +8,9 @@ expression: kind_completions\n     CompletionItem {\n         label: \"the_method\",\n         source_range: [144; 144),\n+        delete: [144; 144),\n+        insert: \"the_method()$0\",\n         kind: Method,\n-        detail: \"fn the_method(&self)\",\n-        insert_text: \"the_method()$0\",\n-        insert_text_format: Snippet\n+        detail: \"fn the_method(&self)\"\n     }\n ]"}, {"sha": "1da3c3ba204a2ea093a04d3c8a0803067ed7dab0", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__mod_with_docs.snap", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__mod_with_docs.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__mod_with_docs.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__mod_with_docs.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.682030298Z\"\n+created: \"2019-02-18T09:22:24.066918191Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,6 +8,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"my\",\n         source_range: [23; 25),\n+        delete: [23; 25),\n+        insert: \"my\",\n         kind: Module,\n         documentation: Documentation(\n             \"Some simple\\ndocs describing `mod my`.\""}, {"sha": "86bc8679ded0821a3ef048496cc3b47f2adb3e7f", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__module_items.snap", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__module_items.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__module_items.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__module_items.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.770568686Z\"\n+created: \"2019-02-18T09:22:24.161888678Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,19 +8,23 @@ expression: kind_completions\n     CompletionItem {\n         label: \"Baz\",\n         source_range: [89; 89),\n+        delete: [89; 89),\n+        insert: \"Baz\",\n         kind: Enum\n     },\n     CompletionItem {\n         label: \"Foo\",\n         source_range: [89; 89),\n+        delete: [89; 89),\n+        insert: \"Foo\",\n         kind: Struct\n     },\n     CompletionItem {\n         label: \"quux\",\n         source_range: [89; 89),\n+        delete: [89; 89),\n+        insert: \"quux()$0\",\n         kind: Function,\n-        detail: \"fn quux()\",\n-        insert_text: \"quux()$0\",\n-        insert_text_format: Snippet\n+        detail: \"fn quux()\"\n     }\n ]"}, {"sha": "9f796b7caecec79f5b12aa4b7ef637f4d5a20cb8", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__module_items_in_nested_modules.snap", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__module_items_in_nested_modules.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__module_items_in_nested_modules.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__module_items_in_nested_modules.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.770992040Z\"\n+created: \"2019-02-18T09:22:24.180517419Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,14 +8,16 @@ expression: kind_completions\n     CompletionItem {\n         label: \"Bar\",\n         source_range: [101; 101),\n+        delete: [101; 101),\n+        insert: \"Bar\",\n         kind: Struct\n     },\n     CompletionItem {\n         label: \"quux\",\n         source_range: [101; 101),\n+        delete: [101; 101),\n+        insert: \"quux()$0\",\n         kind: Function,\n-        detail: \"fn quux()\",\n-        insert_text: \"quux()$0\",\n-        insert_text_format: Snippet\n+        detail: \"fn quux()\"\n     }\n ]"}, {"sha": "4920e500eb6833aced0b404ca2ffa780b949fb8a", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__nested_use_tree.snap", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__nested_use_tree.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__nested_use_tree.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__nested_use_tree.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.689653720Z\"\n+created: \"2019-02-18T09:22:24.085605313Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,11 +8,15 @@ expression: kind_completions\n     CompletionItem {\n         label: \"Spam\",\n         source_range: [12; 14),\n+        delete: [12; 14),\n+        insert: \"Spam\",\n         kind: Struct\n     },\n     CompletionItem {\n         label: \"foo\",\n         source_range: [12; 14),\n+        delete: [12; 14),\n+        insert: \"foo\",\n         kind: Module\n     }\n ]"}, {"sha": "038e7f4025b77425e92965f406aea98a3fe6b14a", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__no_semi_after_break_continue_in_expr.snap", "status": "modified", "additions": 19, "deletions": 13, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__no_semi_after_break_continue_in_expr.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__no_semi_after_break_continue_in_expr.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__no_semi_after_break_continue_in_expr.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.641375216Z\"\n+created: \"2019-02-18T09:22:23.999953358Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,44 +8,50 @@ expression: kind_completions\n     CompletionItem {\n         label: \"break\",\n         source_range: [106; 108),\n+        delete: [106; 108),\n+        insert: \"break\",\n         kind: Keyword\n     },\n     CompletionItem {\n         label: \"continue\",\n         source_range: [106; 108),\n+        delete: [106; 108),\n+        insert: \"continue\",\n         kind: Keyword\n     },\n     CompletionItem {\n         label: \"if\",\n         source_range: [106; 108),\n-        kind: Keyword,\n-        insert_text: \"if $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [106; 108),\n+        insert: \"if $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"loop\",\n         source_range: [106; 108),\n-        kind: Keyword,\n-        insert_text: \"loop {$0}\",\n-        insert_text_format: Snippet\n+        delete: [106; 108),\n+        insert: \"loop {$0}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"match\",\n         source_range: [106; 108),\n-        kind: Keyword,\n-        insert_text: \"match $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [106; 108),\n+        insert: \"match $0 {}\",\n+        kind: Keyword\n     },\n     CompletionItem {\n         label: \"return\",\n         source_range: [106; 108),\n+        delete: [106; 108),\n+        insert: \"return\",\n         kind: Keyword\n     },\n     CompletionItem {\n         label: \"while\",\n         source_range: [106; 108),\n-        kind: Keyword,\n-        insert_text: \"while $0 {}\",\n-        insert_text_format: Snippet\n+        delete: [106; 108),\n+        insert: \"while $0 {}\",\n+        kind: Keyword\n     }\n ]"}, {"sha": "cab77f5a257ac6b969234a6ddecafa362610295f", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__param_completion_last_param.snap", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_last_param.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_last_param.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_last_param.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.606265507Z\"\n+created: \"2019-02-18T09:22:23.949634602Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,6 +8,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"file_id: FileId\",\n         source_range: [98; 102),\n+        delete: [98; 102),\n+        insert: \"file_id: FileId\",\n         lookup: \"file_id\"\n     }\n ]"}, {"sha": "8fbee160c303abb000e8a8a270af811403cba029", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__param_completion_nth_param.snap", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_nth_param.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_nth_param.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_nth_param.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.606265538Z\"\n+created: \"2019-02-18T09:22:23.949634355Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,6 +8,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"file_id: FileId\",\n         source_range: [98; 102),\n+        delete: [98; 102),\n+        insert: \"file_id: FileId\",\n         lookup: \"file_id\"\n     }\n ]"}, {"sha": "76eeadb6db9e2d0f3c44362df9c4fcdd88fd934c", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__param_completion_trait_param.snap", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_trait_param.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_trait_param.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__param_completion_trait_param.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.628419014Z\"\n+created: \"2019-02-18T09:22:23.974417169Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,6 +8,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"file_id: FileId\",\n         source_range: [269; 273),\n+        delete: [269; 273),\n+        insert: \"file_id: FileId\",\n         lookup: \"file_id\"\n     }\n ]"}, {"sha": "2b5435f0ce9e46934501c3cd65bb4b7e5b00019e", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__postfix_completion_works_for_trivial_path_expression.snap", "status": "modified", "additions": 22, "deletions": 78, "changes": 100, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__postfix_completion_works_for_trivial_path_expression.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__postfix_completion_works_for_trivial_path_expression.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__postfix_completion_works_for_trivial_path_expression.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.734401559Z\"\n+created: \"2019-02-18T09:22:24.127119709Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,106 +8,50 @@ expression: kind_completions\n     CompletionItem {\n         label: \"dbg\",\n         source_range: [76; 76),\n-        detail: \"dbg!(expr)\",\n-        insert_text: \"dbg!(bar)\",\n-        insert_text_format: Snippet,\n-        text_edit: TextEdit {\n-            atoms: [\n-                AtomTextEdit {\n-                    delete: [72; 76),\n-                    insert: \"\"\n-                }\n-            ]\n-        }\n+        delete: [72; 76),\n+        insert: \"dbg!(bar)\",\n+        detail: \"dbg!(expr)\"\n     },\n     CompletionItem {\n         label: \"if\",\n         source_range: [76; 76),\n-        detail: \"if expr {}\",\n-        insert_text: \"if bar {$0}\",\n-        insert_text_format: Snippet,\n-        text_edit: TextEdit {\n-            atoms: [\n-                AtomTextEdit {\n-                    delete: [72; 76),\n-                    insert: \"\"\n-                }\n-            ]\n-        }\n+        delete: [72; 76),\n+        insert: \"if bar {$0}\",\n+        detail: \"if expr {}\"\n     },\n     CompletionItem {\n         label: \"match\",\n         source_range: [76; 76),\n-        detail: \"match expr {}\",\n-        insert_text: \"match bar {\\n${1:_} => {$0\\\\},\\n}\",\n-        insert_text_format: Snippet,\n-        text_edit: TextEdit {\n-            atoms: [\n-                AtomTextEdit {\n-                    delete: [72; 76),\n-                    insert: \"\"\n-                }\n-            ]\n-        }\n+        delete: [72; 76),\n+        insert: \"match bar {\\n${1:_} => {$0\\\\},\\n}\",\n+        detail: \"match expr {}\"\n     },\n     CompletionItem {\n         label: \"not\",\n         source_range: [76; 76),\n-        detail: \"!expr\",\n-        insert_text: \"!bar\",\n-        insert_text_format: Snippet,\n-        text_edit: TextEdit {\n-            atoms: [\n-                AtomTextEdit {\n-                    delete: [72; 76),\n-                    insert: \"\"\n-                }\n-            ]\n-        }\n+        delete: [72; 76),\n+        insert: \"!bar\",\n+        detail: \"!expr\"\n     },\n     CompletionItem {\n         label: \"ref\",\n         source_range: [76; 76),\n-        detail: \"&expr\",\n-        insert_text: \"&bar\",\n-        insert_text_format: Snippet,\n-        text_edit: TextEdit {\n-            atoms: [\n-                AtomTextEdit {\n-                    delete: [72; 76),\n-                    insert: \"\"\n-                }\n-            ]\n-        }\n+        delete: [72; 76),\n+        insert: \"&bar\",\n+        detail: \"&expr\"\n     },\n     CompletionItem {\n         label: \"refm\",\n         source_range: [76; 76),\n-        detail: \"&mut expr\",\n-        insert_text: \"&mut bar\",\n-        insert_text_format: Snippet,\n-        text_edit: TextEdit {\n-            atoms: [\n-                AtomTextEdit {\n-                    delete: [72; 76),\n-                    insert: \"\"\n-                }\n-            ]\n-        }\n+        delete: [72; 76),\n+        insert: \"&mut bar\",\n+        detail: \"&mut expr\"\n     },\n     CompletionItem {\n         label: \"while\",\n         source_range: [76; 76),\n-        detail: \"while expr {}\",\n-        insert_text: \"while bar {\\n$0\\n}\",\n-        insert_text_format: Snippet,\n-        text_edit: TextEdit {\n-            atoms: [\n-                AtomTextEdit {\n-                    delete: [72; 76),\n-                    insert: \"\"\n-                }\n-            ]\n-        }\n+        delete: [72; 76),\n+        insert: \"while bar {\\n$0\\n}\",\n+        detail: \"while expr {}\"\n     }\n ]"}, {"sha": "0738cf466ca079c6c4fe67b9e153f64d533eef8a", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__return_type.snap", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__return_type.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__return_type.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__return_type.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.780512486Z\"\n+created: \"2019-02-18T09:22:24.182964414Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,14 +8,16 @@ expression: kind_completions\n     CompletionItem {\n         label: \"Foo\",\n         source_range: [47; 47),\n+        delete: [47; 47),\n+        insert: \"Foo\",\n         kind: Struct\n     },\n     CompletionItem {\n         label: \"x\",\n         source_range: [47; 47),\n+        delete: [47; 47),\n+        insert: \"x()$0\",\n         kind: Function,\n-        detail: \"fn x() ->\",\n-        insert_text: \"x()$0\",\n-        insert_text_format: Snippet\n+        detail: \"fn x() ->\"\n     }\n ]"}, {"sha": "baf12cae130344ebc9d15a79175219f302382f55", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__self_in_methods.snap", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__self_in_methods.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__self_in_methods.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__self_in_methods.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.774705610Z\"\n+created: \"2019-02-18T09:22:24.174038680Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,11 +8,15 @@ expression: kind_completions\n     CompletionItem {\n         label: \"Self\",\n         source_range: [25; 25),\n+        delete: [25; 25),\n+        insert: \"Self\",\n         kind: TypeParam\n     },\n     CompletionItem {\n         label: \"self\",\n         source_range: [25; 25),\n+        delete: [25; 25),\n+        insert: \"self\",\n         kind: Binding\n     }\n ]"}, {"sha": "fce2d64799990a76e83e99bf11083bb1f4bf6b0f", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__snippets_in_expressions.snap", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__snippets_in_expressions.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__snippets_in_expressions.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__snippets_in_expressions.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.799497268Z\"\n+created: \"2019-02-18T09:22:24.191576723Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,15 +8,15 @@ expression: kind_completions\n     CompletionItem {\n         label: \"pd\",\n         source_range: [17; 17),\n-        kind: Snippet,\n-        insert_text: \"eprintln!(\\\"$0 = {:?}\\\", $0);\",\n-        insert_text_format: Snippet\n+        delete: [17; 17),\n+        insert: \"eprintln!(\\\"$0 = {:?}\\\", $0);\",\n+        kind: Snippet\n     },\n     CompletionItem {\n         label: \"ppd\",\n         source_range: [17; 17),\n-        kind: Snippet,\n-        insert_text: \"eprintln!(\\\"$0 = {:#?}\\\", $0);\",\n-        insert_text_format: Snippet\n+        delete: [17; 17),\n+        insert: \"eprintln!(\\\"$0 = {:#?}\\\", $0);\",\n+        kind: Snippet\n     }\n ]"}, {"sha": "d2b1a5f0ef3acb10084d2381ad5d1421475dc8d5", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__snippets_in_items.snap", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__snippets_in_items.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__snippets_in_items.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__snippets_in_items.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.800831987Z\"\n+created: \"2019-02-18T09:22:24.187670733Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,16 +8,16 @@ expression: kind_completions\n     CompletionItem {\n         label: \"Test function\",\n         source_range: [66; 66),\n+        delete: [66; 66),\n+        insert: \"#[test]\\nfn ${1:feature}() {\\n    $0\\n}\",\n         kind: Snippet,\n-        lookup: \"tfn\",\n-        insert_text: \"#[test]\\nfn ${1:feature}() {\\n    $0\\n}\",\n-        insert_text_format: Snippet\n+        lookup: \"tfn\"\n     },\n     CompletionItem {\n         label: \"pub(crate)\",\n         source_range: [66; 66),\n-        kind: Snippet,\n-        insert_text: \"pub(crate) $0\",\n-        insert_text_format: Snippet\n+        delete: [66; 66),\n+        insert: \"pub(crate) $0\",\n+        kind: Snippet\n     }\n ]"}, {"sha": "6ad4c5acc525f6203f5f5aa4a46ce6abfa29b0d8", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__struct_associated_const.snap", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_associated_const.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_associated_const.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_associated_const.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.704544613Z\"\n+created: \"2019-02-18T09:22:24.093406123Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,6 +8,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"C\",\n         source_range: [107; 107),\n+        delete: [107; 107),\n+        insert: \"C\",\n         kind: Const,\n         detail: \"const C: i32 = 42;\",\n         documentation: Documentation("}, {"sha": "163b325c3923659c8c320c3c2e4cf17d558ec705", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__struct_associated_method.snap", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_associated_method.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_associated_method.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_associated_method.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.704544615Z\"\n+created: \"2019-02-18T09:22:24.093082839Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,12 +8,12 @@ expression: kind_completions\n     CompletionItem {\n         label: \"m\",\n         source_range: [100; 100),\n+        delete: [100; 100),\n+        insert: \"m()$0\",\n         kind: Method,\n         detail: \"fn m()\",\n         documentation: Documentation(\n             \"An associated method\"\n-        ),\n-        insert_text: \"m()$0\",\n-        insert_text_format: Snippet\n+        )\n     }\n ]"}, {"sha": "583bda2257d07f9c06daabb0e9a25132a4b2471e", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__struct_associated_type.snap", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_associated_type.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_associated_type.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_associated_type.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.725668999Z\"\n+created: \"2019-02-18T09:22:24.090876030Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,6 +8,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"T\",\n         source_range: [101; 101),\n+        delete: [101; 101),\n+        insert: \"T\",\n         kind: TypeAlias,\n         detail: \"type T = i32;\",\n         documentation: Documentation("}, {"sha": "58271b873fac410381113679580291c0c2e8047c", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__struct_field_completion.snap", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.599230647Z\"\n+created: \"2019-02-18T09:22:23.939645902Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,6 +8,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"the_field\",\n         source_range: [85; 85),\n+        delete: [85; 85),\n+        insert: \"the_field\",\n         kind: Field,\n         detail: \"u32\"\n     }"}, {"sha": "b38867b81dafcc45b87562018283ad1cacbb0889", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__struct_field_completion_autoderef.snap", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion_autoderef.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion_autoderef.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion_autoderef.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.598966298Z\"\n+created: \"2019-02-18T09:22:23.940872916Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,14 +8,16 @@ expression: kind_completions\n     CompletionItem {\n         label: \"foo\",\n         source_range: [126; 126),\n+        delete: [126; 126),\n+        insert: \"foo()$0\",\n         kind: Method,\n-        detail: \"fn foo(&self)\",\n-        insert_text: \"foo()$0\",\n-        insert_text_format: Snippet\n+        detail: \"fn foo(&self)\"\n     },\n     CompletionItem {\n         label: \"the_field\",\n         source_range: [126; 126),\n+        delete: [126; 126),\n+        insert: \"the_field\",\n         kind: Field,\n         detail: \"(u32, i32)\"\n     }"}, {"sha": "8e5cab43e9bca4401a1e9b43563a05d08b0d7131", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__struct_field_completion_self.snap", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion_self.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion_self.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__struct_field_completion_self.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.598965593Z\"\n+created: \"2019-02-18T09:22:23.940872918Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,14 +8,16 @@ expression: kind_completions\n     CompletionItem {\n         label: \"foo\",\n         source_range: [187; 187),\n+        delete: [187; 187),\n+        insert: \"foo()$0\",\n         kind: Method,\n-        detail: \"fn foo(self)\",\n-        insert_text: \"foo()$0\",\n-        insert_text_format: Snippet\n+        detail: \"fn foo(self)\"\n     },\n     CompletionItem {\n         label: \"the_field\",\n         source_range: [187; 187),\n+        delete: [187; 187),\n+        insert: \"the_field\",\n         kind: Field,\n         detail: \"(u32,)\",\n         documentation: Documentation("}, {"sha": "3f27806211d0db309e05553829b83cd896c90c5a", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__tuple_field_completion.snap", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__tuple_field_completion.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__tuple_field_completion.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__tuple_field_completion.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.598973382Z\"\n+created: \"2019-02-18T09:22:23.939710971Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,12 +8,16 @@ expression: kind_completions\n     CompletionItem {\n         label: \"0\",\n         source_range: [75; 75),\n+        delete: [75; 75),\n+        insert: \"0\",\n         kind: Field,\n         detail: \"i32\"\n     },\n     CompletionItem {\n         label: \"1\",\n         source_range: [75; 75),\n+        delete: [75; 75),\n+        insert: \"1\",\n         kind: Field,\n         detail: \"f64\"\n     }"}, {"sha": "34e70c35dd9c350394cbd9d1a263e27c9a7ab7cf", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__use_item_starting_with_crate.snap", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__use_item_starting_with_crate.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__use_item_starting_with_crate.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__use_item_starting_with_crate.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.726365989Z\"\n+created: \"2019-02-18T09:22:24.098574884Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,11 +8,15 @@ expression: kind_completions\n     CompletionItem {\n         label: \"Spam\",\n         source_range: [11; 13),\n+        delete: [11; 13),\n+        insert: \"Spam\",\n         kind: Struct\n     },\n     CompletionItem {\n         label: \"foo\",\n         source_range: [11; 13),\n+        delete: [11; 13),\n+        insert: \"foo\",\n         kind: Module\n     }\n ]"}, {"sha": "d15f1905bae2625f61676363342dc565cf789dc2", "filename": "crates/ra_ide_api/src/completion/snapshots/completion_item__use_item_starting_with_self.snap", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__use_item_starting_with_self.snap", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__use_item_starting_with_self.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fcompletion%2Fsnapshots%2Fcompletion_item__use_item_starting_with_self.snap?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-02-18T07:29:59.731789946Z\"\n+created: \"2019-02-18T09:22:24.102063333Z\"\n creator: insta@0.6.2\n source: crates/ra_ide_api/src/completion/completion_item.rs\n expression: kind_completions\n@@ -8,6 +8,8 @@ expression: kind_completions\n     CompletionItem {\n         label: \"Bar\",\n         source_range: [26; 26),\n+        delete: [26; 26),\n+        insert: \"Bar\",\n         kind: Struct\n     }\n ]"}, {"sha": "f0f67b6636137f7303a62f207f5af57058ec1ed2", "filename": "crates/ra_lsp_server/src/conv.rs", "status": "modified", "additions": 26, "deletions": 6, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_lsp_server%2Fsrc%2Fconv.rs", "raw_url": "https://github.com/rust-lang/rust/raw/16c7ebbb27dc81b4640b5694f36b381cae706c8d/crates%2Fra_lsp_server%2Fsrc%2Fconv.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_lsp_server%2Fsrc%2Fconv.rs?ref=16c7ebbb27dc81b4640b5694f36b381cae706c8d", "patch": "@@ -79,19 +79,39 @@ impl ConvWith for CompletionItem {\n     type Ctx = LineIndex;\n     type Output = ::lsp_types::CompletionItem;\n \n-    fn conv_with(mut self, ctx: &LineIndex) -> ::lsp_types::CompletionItem {\n-        let atom_text_edit = AtomTextEdit::replace(self.source_range(), self.insert_text());\n-        let text_edit = (&atom_text_edit).conv_with(ctx);\n-        let additional_text_edits =\n-            if let Some(edit) = self.take_text_edit() { Some(edit.conv_with(ctx)) } else { None };\n+    fn conv_with(self, ctx: &LineIndex) -> ::lsp_types::CompletionItem {\n+        let mut additional_text_edits = Vec::new();\n+        let mut text_edit = None;\n+        // LSP does not allow arbitrary edits in completion, so we have to do a\n+        // non-trivial mapping here.\n+        for atom_edit in self.text_edit().as_atoms() {\n+            if self.source_range().is_subrange(&atom_edit.delete) {\n+                text_edit = Some(if atom_edit.delete == self.source_range() {\n+                    atom_edit.conv_with(ctx)\n+                } else {\n+                    assert!(self.source_range().end() == atom_edit.delete.end());\n+                    let range1 =\n+                        TextRange::from_to(atom_edit.delete.start(), self.source_range().start());\n+                    let range2 = self.source_range();\n+                    let edit1 = AtomTextEdit::replace(range1, String::new());\n+                    let edit2 = AtomTextEdit::replace(range2, atom_edit.insert.clone());\n+                    additional_text_edits.push(edit1.conv_with(ctx));\n+                    edit2.conv_with(ctx)\n+                })\n+            } else {\n+                assert!(self.source_range().intersection(&atom_edit.delete).is_none());\n+                additional_text_edits.push(atom_edit.conv_with(ctx));\n+            }\n+        }\n+        let text_edit = text_edit.unwrap();\n \n         let mut res = lsp_types::CompletionItem {\n             label: self.label().to_string(),\n             detail: self.detail().map(|it| it.to_string()),\n             filter_text: Some(self.lookup().to_string()),\n             kind: self.kind().map(|it| it.conv()),\n             text_edit: Some(text_edit),\n-            additional_text_edits,\n+            additional_text_edits: Some(additional_text_edits),\n             documentation: self.documentation().map(|it| it.conv()),\n             ..Default::default()\n         };"}]}