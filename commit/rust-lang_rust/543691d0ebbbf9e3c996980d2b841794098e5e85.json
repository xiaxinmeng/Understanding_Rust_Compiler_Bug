{"sha": "543691d0ebbbf9e3c996980d2b841794098e5e85", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU0MzY5MWQwZWJiYmY5ZTNjOTk2OTgwZDJiODQxNzk0MDk4ZTVlODU=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-05-19T17:42:28Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-05-19T17:42:28Z"}, "message": "Auto merge of #41439 - ivandardi:master, r=BurntSushi\n\nStabilize step_by by adding it to Iterator (issue #27741)\n\nInspired by itertools' `take()` method. See issue #27741", "tree": {"sha": "12c326e9a0e62013d8bc64758cfae582c27d7c2e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/12c326e9a0e62013d8bc64758cfae582c27d7c2e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/543691d0ebbbf9e3c996980d2b841794098e5e85", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/543691d0ebbbf9e3c996980d2b841794098e5e85", "html_url": "https://github.com/rust-lang/rust/commit/543691d0ebbbf9e3c996980d2b841794098e5e85", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/543691d0ebbbf9e3c996980d2b841794098e5e85/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b21577e1e80ed7a2470cd3402004b80d1bf0f30d", "url": "https://api.github.com/repos/rust-lang/rust/commits/b21577e1e80ed7a2470cd3402004b80d1bf0f30d", "html_url": "https://github.com/rust-lang/rust/commit/b21577e1e80ed7a2470cd3402004b80d1bf0f30d"}, {"sha": "49555172016d3ca59b8ece596e28578741d8d076", "url": "https://api.github.com/repos/rust-lang/rust/commits/49555172016d3ca59b8ece596e28578741d8d076", "html_url": "https://github.com/rust-lang/rust/commit/49555172016d3ca59b8ece596e28578741d8d076"}], "stats": {"total": 109, "additions": 106, "deletions": 3}, "files": [{"sha": "8467cb68862f7996cb8c6bc8a660d29e3a2fde56", "filename": "src/doc/unstable-book/src/library-features/iterator-step-by.md", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/543691d0ebbbf9e3c996980d2b841794098e5e85/src%2Fdoc%2Funstable-book%2Fsrc%2Flibrary-features%2Fiterator-step-by.md", "raw_url": "https://github.com/rust-lang/rust/raw/543691d0ebbbf9e3c996980d2b841794098e5e85/src%2Fdoc%2Funstable-book%2Fsrc%2Flibrary-features%2Fiterator-step-by.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flibrary-features%2Fiterator-step-by.md?ref=543691d0ebbbf9e3c996980d2b841794098e5e85", "patch": "@@ -0,0 +1,7 @@\n+# `iterator_step_by`\n+\n+The tracking issue for this feature is: [#27741]\n+\n+[#27741]: https://github.com/rust-lang/rust/issues/27741\n+\n+------------------------"}, {"sha": "77cbdb98c830480ff55f4e245c51cbae4fd5ef87", "filename": "src/libcore/iter/iterator.rs", "status": "modified", "additions": 34, "deletions": 1, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/543691d0ebbbf9e3c996980d2b841794098e5e85/src%2Flibcore%2Fiter%2Fiterator.rs", "raw_url": "https://github.com/rust-lang/rust/raw/543691d0ebbbf9e3c996980d2b841794098e5e85/src%2Flibcore%2Fiter%2Fiterator.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fiter%2Fiterator.rs?ref=543691d0ebbbf9e3c996980d2b841794098e5e85", "patch": "@@ -11,7 +11,7 @@\n use cmp::Ordering;\n \n use super::{Chain, Cycle, Cloned, Enumerate, Filter, FilterMap, FlatMap, Fuse};\n-use super::{Inspect, Map, Peekable, Scan, Skip, SkipWhile, Take, TakeWhile, Rev};\n+use super::{Inspect, Map, Peekable, Scan, Skip, SkipWhile, StepBy, Take, TakeWhile, Rev};\n use super::{Zip, Sum, Product};\n use super::{ChainState, FromIterator, ZipImpl};\n \n@@ -258,6 +258,39 @@ pub trait Iterator {\n         None\n     }\n \n+    /// Creates an iterator starting at the same point, but stepping by\n+    /// the given amount at each iteration.\n+    ///\n+    /// Note that it will always return the first element of the range,\n+    /// regardless of the step given.\n+    ///\n+    /// # Panics\n+    ///\n+    /// The method will panic if the given step is `0`.\n+    ///\n+    /// # Examples\n+    ///\n+    /// Basic usage:\n+    ///\n+    /// ```\n+    /// #![feature(iterator_step_by)]\n+    /// let a = [0, 1, 2, 3, 4, 5];\n+    /// let mut iter = a.into_iter().step_by(2);\n+    ///\n+    /// assert_eq!(iter.next(), Some(&0));\n+    /// assert_eq!(iter.next(), Some(&2));\n+    /// assert_eq!(iter.next(), Some(&4));\n+    /// assert_eq!(iter.next(), None);\n+    /// ```\n+    #[inline]\n+    #[unstable(feature = \"iterator_step_by\",\n+               reason = \"unstable replacement of Range::step_by\",\n+               issue = \"27741\")]\n+    fn step_by(self, step: usize) -> StepBy<Self> where Self: Sized {\n+        assert!(step != 0);\n+        StepBy{iter: self, step: step - 1, first_take: true}\n+    }\n+\n     /// Takes two iterators and creates a new iterator over both in sequence.\n     ///\n     /// `chain()` will return a new iterator which will first iterate over"}, {"sha": "420ff0f71193b47bdcf843db68558b27836c8e90", "filename": "src/libcore/iter/mod.rs", "status": "modified", "additions": 36, "deletions": 1, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/543691d0ebbbf9e3c996980d2b841794098e5e85/src%2Flibcore%2Fiter%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/543691d0ebbbf9e3c996980d2b841794098e5e85/src%2Flibcore%2Fiter%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fiter%2Fmod.rs?ref=543691d0ebbbf9e3c996980d2b841794098e5e85", "patch": "@@ -313,7 +313,7 @@ pub use self::iterator::Iterator;\n pub use self::range::Step;\n #[unstable(feature = \"step_by\", reason = \"recent addition\",\n            issue = \"27741\")]\n-pub use self::range::StepBy;\n+pub use self::range::StepBy as DeprecatedStepBy;\n \n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n pub use self::sources::{Repeat, repeat};\n@@ -520,6 +520,41 @@ impl<I> Iterator for Cycle<I> where I: Clone + Iterator {\n #[unstable(feature = \"fused\", issue = \"35602\")]\n impl<I> FusedIterator for Cycle<I> where I: Clone + Iterator {}\n \n+/// An iterator that steps by n elements every iteration.\n+///\n+/// This `struct` is created by the [`step_by`] method on [`Iterator`]. See\n+/// its documentation for more.\n+///\n+/// [`step_by`]: trait.Iterator.html#method.step_by\n+/// [`Iterator`]: trait.Iterator.html\n+#[must_use = \"iterator adaptors are lazy and do nothing unless consumed\"]\n+#[unstable(feature = \"iterator_step_by\",\n+           reason = \"unstable replacement of Range::step_by\",\n+           issue = \"27741\")]\n+#[derive(Clone, Debug)]\n+pub struct StepBy<I> {\n+    iter: I,\n+    step: usize,\n+    first_take: bool,\n+}\n+\n+#[unstable(feature = \"iterator_step_by\",\n+           reason = \"unstable replacement of Range::step_by\",\n+           issue = \"27741\")]\n+impl<I> Iterator for StepBy<I> where I: Iterator {\n+    type Item = I::Item;\n+\n+    #[inline]\n+    fn next(&mut self) -> Option<Self::Item> {\n+        if self.first_take {\n+            self.first_take = false;\n+            self.iter.next()\n+        } else {\n+            self.iter.nth(self.step)\n+        }\n+    }\n+}\n+\n /// An iterator that strings two iterators together.\n ///\n /// This `struct` is created by the [`chain`] method on [`Iterator`]. See its"}, {"sha": "ad91ba9be58f210f87032b2b62e4f597c108cfe1", "filename": "src/libcore/tests/iter.rs", "status": "modified", "additions": 28, "deletions": 1, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/543691d0ebbbf9e3c996980d2b841794098e5e85/src%2Flibcore%2Ftests%2Fiter.rs", "raw_url": "https://github.com/rust-lang/rust/raw/543691d0ebbbf9e3c996980d2b841794098e5e85/src%2Flibcore%2Ftests%2Fiter.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Ftests%2Fiter.rs?ref=543691d0ebbbf9e3c996980d2b841794098e5e85", "patch": "@@ -144,6 +144,33 @@ fn test_iterator_chain_find() {\n     assert_eq!(iter.next(), None);\n }\n \n+#[test]\n+fn test_iterator_step_by() {\n+    // Identity\n+    // Replace with (0..).step_by(1) after Range::step_by gets removed\n+    let mut it = Iterator::step_by((0..), 1).take(3);\n+    assert_eq!(it.next(), Some(0));\n+    assert_eq!(it.next(), Some(1));\n+    assert_eq!(it.next(), Some(2));\n+    assert_eq!(it.next(), None);\n+\n+    // Replace with (0..).step_by(3) after Range::step_by gets removed\n+    let mut it = Iterator::step_by((0..), 3).take(4);\n+    assert_eq!(it.next(), Some(0));\n+    assert_eq!(it.next(), Some(3));\n+    assert_eq!(it.next(), Some(6));\n+    assert_eq!(it.next(), Some(9));\n+    assert_eq!(it.next(), None);\n+}\n+\n+#[test]\n+#[should_panic]\n+fn test_iterator_step_by_zero() {\n+    // Replace with (0..).step_by(0) after Range::step_by gets removed\n+    let mut it = Iterator::step_by((0..), 0);\n+    it.next();\n+}\n+\n #[test]\n fn test_filter_map() {\n     let it = (0..).step_by(1).take(10)\n@@ -1119,4 +1146,4 @@ fn test_step_replace_no_between() {\n     let y = x.replace_one();\n     assert_eq!(x, 1);\n     assert_eq!(y, 5);\n-}\n\\ No newline at end of file\n+}"}, {"sha": "c52155ead4f0b2774fe73db9cb4f73048a475dc4", "filename": "src/libcore/tests/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/543691d0ebbbf9e3c996980d2b841794098e5e85/src%2Flibcore%2Ftests%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/543691d0ebbbf9e3c996980d2b841794098e5e85/src%2Flibcore%2Ftests%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Ftests%2Flib.rs?ref=543691d0ebbbf9e3c996980d2b841794098e5e85", "patch": "@@ -20,6 +20,7 @@\n #![feature(fixed_size_array)]\n #![feature(flt2dec)]\n #![feature(fmt_internals)]\n+#![feature(iterator_step_by)]\n #![feature(i128_type)]\n #![feature(iter_rfind)]\n #![feature(libc)]"}]}