{"sha": "512efbea2321dafd19d30eacb9d8f9d21fcedae2", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUxMmVmYmVhMjMyMWRhZmQxOWQzMGVhY2I5ZDhmOWQyMWZjZWRhZTI=", "commit": {"author": {"name": "xiongmao86", "email": "xiongmao86dev@sina.com", "date": "2020-01-29T16:21:29Z"}, "committer": {"name": "xiongmao86", "email": "xiongmao86dev@sina.com", "date": "2020-01-29T16:21:29Z"}, "message": "Declare lint and implement lint logic.", "tree": {"sha": "681f24549f415f811a7e9ae175efbe025f4851dc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/681f24549f415f811a7e9ae175efbe025f4851dc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/512efbea2321dafd19d30eacb9d8f9d21fcedae2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/512efbea2321dafd19d30eacb9d8f9d21fcedae2", "html_url": "https://github.com/rust-lang/rust/commit/512efbea2321dafd19d30eacb9d8f9d21fcedae2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/512efbea2321dafd19d30eacb9d8f9d21fcedae2/comments", "author": {"login": "xiongmao86", "id": 1770218, "node_id": "MDQ6VXNlcjE3NzAyMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1770218?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xiongmao86", "html_url": "https://github.com/xiongmao86", "followers_url": "https://api.github.com/users/xiongmao86/followers", "following_url": "https://api.github.com/users/xiongmao86/following{/other_user}", "gists_url": "https://api.github.com/users/xiongmao86/gists{/gist_id}", "starred_url": "https://api.github.com/users/xiongmao86/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xiongmao86/subscriptions", "organizations_url": "https://api.github.com/users/xiongmao86/orgs", "repos_url": "https://api.github.com/users/xiongmao86/repos", "events_url": "https://api.github.com/users/xiongmao86/events{/privacy}", "received_events_url": "https://api.github.com/users/xiongmao86/received_events", "type": "User", "site_admin": false}, "committer": {"login": "xiongmao86", "id": 1770218, "node_id": "MDQ6VXNlcjE3NzAyMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1770218?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xiongmao86", "html_url": "https://github.com/xiongmao86", "followers_url": "https://api.github.com/users/xiongmao86/followers", "following_url": "https://api.github.com/users/xiongmao86/following{/other_user}", "gists_url": "https://api.github.com/users/xiongmao86/gists{/gist_id}", "starred_url": "https://api.github.com/users/xiongmao86/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xiongmao86/subscriptions", "organizations_url": "https://api.github.com/users/xiongmao86/orgs", "repos_url": "https://api.github.com/users/xiongmao86/repos", "events_url": "https://api.github.com/users/xiongmao86/events{/privacy}", "received_events_url": "https://api.github.com/users/xiongmao86/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c0f39cfb466202a1dbe8368ca177848083dc34cb", "url": "https://api.github.com/repos/rust-lang/rust/commits/c0f39cfb466202a1dbe8368ca177848083dc34cb", "html_url": "https://github.com/rust-lang/rust/commit/c0f39cfb466202a1dbe8368ca177848083dc34cb"}], "stats": {"total": 78, "additions": 76, "deletions": 2}, "files": [{"sha": "d5dbbabb3c5cfbafac70c66ddfe8a633dbdc3eb4", "filename": "CHANGELOG.md", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/512efbea2321dafd19d30eacb9d8f9d21fcedae2/CHANGELOG.md", "raw_url": "https://github.com/rust-lang/rust/raw/512efbea2321dafd19d30eacb9d8f9d21fcedae2/CHANGELOG.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/CHANGELOG.md?ref=512efbea2321dafd19d30eacb9d8f9d21fcedae2", "patch": "@@ -1284,6 +1284,7 @@ Released 2018-09-13\n [`should_implement_trait`]: https://rust-lang.github.io/rust-clippy/master/index.html#should_implement_trait\n [`similar_names`]: https://rust-lang.github.io/rust-clippy/master/index.html#similar_names\n [`single_char_pattern`]: https://rust-lang.github.io/rust-clippy/master/index.html#single_char_pattern\n+[`single_component_path_imports`]: https://rust-lang.github.io/rust-clippy/master/index.html#single_component_path_imports\n [`single_match`]: https://rust-lang.github.io/rust-clippy/master/index.html#single_match\n [`single_match_else`]: https://rust-lang.github.io/rust-clippy/master/index.html#single_match_else\n [`skip_while_next`]: https://rust-lang.github.io/rust-clippy/master/index.html#skip_while_next"}, {"sha": "0cb14eda6a8812f8aea8e7b6cd4734db1a363ce3", "filename": "README.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/512efbea2321dafd19d30eacb9d8f9d21fcedae2/README.md", "raw_url": "https://github.com/rust-lang/rust/raw/512efbea2321dafd19d30eacb9d8f9d21fcedae2/README.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/README.md?ref=512efbea2321dafd19d30eacb9d8f9d21fcedae2", "patch": "@@ -6,7 +6,7 @@\n \n A collection of lints to catch common mistakes and improve your [Rust](https://github.com/rust-lang/rust) code.\n \n-[There are 349 lints included in this crate!](https://rust-lang.github.io/rust-clippy/master/index.html)\n+[There are 350 lints included in this crate!](https://rust-lang.github.io/rust-clippy/master/index.html)\n \n We have a bunch of lint categories to allow you to choose how much Clippy is supposed to ~~annoy~~ help you:\n "}, {"sha": "7008c6d6839de6692347ae87cbc7e4c59c9ea08f", "filename": "clippy_lints/src/lib.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/512efbea2321dafd19d30eacb9d8f9d21fcedae2/clippy_lints%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/512efbea2321dafd19d30eacb9d8f9d21fcedae2/clippy_lints%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Flib.rs?ref=512efbea2321dafd19d30eacb9d8f9d21fcedae2", "patch": "@@ -284,6 +284,7 @@ pub mod replace_consts;\n pub mod returns;\n pub mod serde_api;\n pub mod shadow;\n+pub mod single_component_path_imports;\n pub mod slow_vector_initialization;\n pub mod strings;\n pub mod suspicious_trait_impl;\n@@ -741,6 +742,7 @@ pub fn register_plugins(store: &mut rustc_lint::LintStore, sess: &Session, conf:\n         &shadow::SHADOW_REUSE,\n         &shadow::SHADOW_SAME,\n         &shadow::SHADOW_UNRELATED,\n+        &single_component_path_imports::SINGLE_COMPONENT_PATH_IMPORTS,\n         &slow_vector_initialization::SLOW_VECTOR_INITIALIZATION,\n         &strings::STRING_ADD,\n         &strings::STRING_ADD_ASSIGN,\n@@ -993,6 +995,7 @@ pub fn register_plugins(store: &mut rustc_lint::LintStore, sess: &Session, conf:\n     store.register_early_pass(|| box utils::internal_lints::ProduceIce);\n     store.register_late_pass(|| box let_underscore::LetUnderscore);\n     store.register_late_pass(|| box atomic_ordering::AtomicOrdering);\n+    store.register_early_pass(|| box single_component_path_imports::SingleComponentPathImports);\n \n     store.register_group(true, \"clippy::restriction\", Some(\"clippy_restriction\"), vec![\n         LintId::of(&arithmetic::FLOAT_ARITHMETIC),\n@@ -1296,6 +1299,7 @@ pub fn register_plugins(store: &mut rustc_lint::LintStore, sess: &Session, conf:\n         LintId::of(&returns::NEEDLESS_RETURN),\n         LintId::of(&returns::UNUSED_UNIT),\n         LintId::of(&serde_api::SERDE_API_MISUSE),\n+        LintId::of(&single_component_path_imports::SINGLE_COMPONENT_PATH_IMPORTS),\n         LintId::of(&slow_vector_initialization::SLOW_VECTOR_INITIALIZATION),\n         LintId::of(&strings::STRING_LIT_AS_BYTES),\n         LintId::of(&suspicious_trait_impl::SUSPICIOUS_ARITHMETIC_IMPL),\n@@ -1431,6 +1435,7 @@ pub fn register_plugins(store: &mut rustc_lint::LintStore, sess: &Session, conf:\n         LintId::of(&returns::LET_AND_RETURN),\n         LintId::of(&returns::NEEDLESS_RETURN),\n         LintId::of(&returns::UNUSED_UNIT),\n+        LintId::of(&single_component_path_imports::SINGLE_COMPONENT_PATH_IMPORTS),\n         LintId::of(&strings::STRING_LIT_AS_BYTES),\n         LintId::of(&tabs_in_doc_comments::TABS_IN_DOC_COMMENTS),\n         LintId::of(&to_digit_is_some::TO_DIGIT_IS_SOME),"}, {"sha": "eb3261bebe31573be548e0838109e2aa1dc8dd13", "filename": "clippy_lints/src/single_component_path_imports.rs", "status": "added", "additions": 61, "deletions": 0, "changes": 61, "blob_url": "https://github.com/rust-lang/rust/blob/512efbea2321dafd19d30eacb9d8f9d21fcedae2/clippy_lints%2Fsrc%2Fsingle_component_path_imports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/512efbea2321dafd19d30eacb9d8f9d21fcedae2/clippy_lints%2Fsrc%2Fsingle_component_path_imports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fsingle_component_path_imports.rs?ref=512efbea2321dafd19d30eacb9d8f9d21fcedae2", "patch": "@@ -0,0 +1,61 @@\n+use crate::utils::span_lint_and_sugg;\n+use if_chain::if_chain;\n+use rustc_errors::Applicability;\n+use rustc_lint::{EarlyContext, EarlyLintPass};\n+use rustc_session::{declare_lint_pass, declare_tool_lint};\n+use rustc_span::edition::Edition;\n+use syntax::ast::{Item, ItemKind, UseTreeKind};\n+\n+declare_clippy_lint! {\n+    /// **What it does:** Checking for imports with single component use path.\n+    ///\n+    /// **Why is this bad?** Import with single component use path such as `use cratename;`\n+    /// is not necessary, and thus should be removed.\n+    ///\n+    /// **Known problems:** None.\n+    ///\n+    /// **Example:**\n+    ///\n+    /// ```rust, ignore\n+    /// use regex;\n+    ///\n+    /// fn main() {\n+    ///     regex::Regex::new(r\"^\\d{4}-\\d{2}-\\d{2}$\").unwrap();\n+    /// }\n+    /// ```\n+    /// Better as\n+    /// ```rust, ignore\n+    /// fn main() {\n+    ///     regex::Regex::new(r\"^\\d{4}-\\d{2}-\\d{2}$\").unwrap();\n+    /// }\n+    /// ```\n+    pub SINGLE_COMPONENT_PATH_IMPORTS,\n+    style,\n+    \"imports with single component path are redundant\"\n+}\n+\n+declare_lint_pass!(SingleComponentPathImports => [SINGLE_COMPONENT_PATH_IMPORTS]);\n+\n+impl EarlyLintPass for SingleComponentPathImports {\n+    fn check_item(&mut self, cx: &EarlyContext<'_>, item: &Item) {\n+        if_chain! {\n+            if cx.sess.opts.edition == Edition::Edition2018;\n+            if !item.vis.node.is_pub();\n+            if let ItemKind::Use(use_tree) = &item.kind;\n+            if let segments = &use_tree.prefix.segments;\n+            if segments.len() == 1;\n+            if let UseTreeKind::Simple(None, _, _) = use_tree.kind;\n+            then {\n+                span_lint_and_sugg(\n+                    cx,\n+                    SINGLE_COMPONENT_PATH_IMPORTS,\n+                    item.span,\n+                    \"this import is redundant\",\n+                    \"remove it entirely\",\n+                    String::new(),\n+                    Applicability::MachineApplicable\n+                );\n+            }\n+        }\n+    }\n+}"}, {"sha": "b762c8d139514fb09ffc6359bb6c52cf373f3e25", "filename": "src/lintlist/mod.rs", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/512efbea2321dafd19d30eacb9d8f9d21fcedae2/src%2Flintlist%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/512efbea2321dafd19d30eacb9d8f9d21fcedae2/src%2Flintlist%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flintlist%2Fmod.rs?ref=512efbea2321dafd19d30eacb9d8f9d21fcedae2", "patch": "@@ -6,7 +6,7 @@ pub use lint::Lint;\n pub use lint::LINT_LEVELS;\n \n // begin lint list, do not remove this comment, it\u2019s used in `update_lints`\n-pub const ALL_LINTS: [Lint; 349] = [\n+pub const ALL_LINTS: [Lint; 350] = [\n     Lint {\n         name: \"absurd_extreme_comparisons\",\n         group: \"correctness\",\n@@ -1855,6 +1855,13 @@ pub const ALL_LINTS: [Lint; 349] = [\n         deprecation: None,\n         module: \"methods\",\n     },\n+    Lint {\n+        name: \"single_component_path_imports\",\n+        group: \"style\",\n+        desc: \"imports with single component path are redundant\",\n+        deprecation: None,\n+        module: \"single_component_path_imports\",\n+    },\n     Lint {\n         name: \"single_match\",\n         group: \"style\","}]}