{"sha": "723ac0faf18613f7652583f83854664e1dc6a89b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjcyM2FjMGZhZjE4NjEzZjc2NTI1ODNmODM4NTQ2NjRlMWRjNmE4OWI=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-11-23T13:26:28Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2020-11-23T13:26:28Z"}, "message": "Auto merge of #6317 - chansuke:add-external-macro, r=llogiq\n\nAdd exteranal macros for as_conversions\n\nAdded external macros to this PR https://github.com/rust-lang/rust-clippy/pull/4888.\n\nr? `@llogiq`\n\nchangelog: none", "tree": {"sha": "a417c629e00222a023682b73594e29435cdcdd7a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a417c629e00222a023682b73594e29435cdcdd7a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/723ac0faf18613f7652583f83854664e1dc6a89b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/723ac0faf18613f7652583f83854664e1dc6a89b", "html_url": "https://github.com/rust-lang/rust/commit/723ac0faf18613f7652583f83854664e1dc6a89b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/723ac0faf18613f7652583f83854664e1dc6a89b/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3e7c6dec244539970b593824334876f8b6ed0b18", "url": "https://api.github.com/repos/rust-lang/rust/commits/3e7c6dec244539970b593824334876f8b6ed0b18", "html_url": "https://github.com/rust-lang/rust/commit/3e7c6dec244539970b593824334876f8b6ed0b18"}, {"sha": "faa3e233169523f6bb1537d9b6b2aabe66efd01b", "url": "https://api.github.com/repos/rust-lang/rust/commits/faa3e233169523f6bb1537d9b6b2aabe66efd01b", "html_url": "https://github.com/rust-lang/rust/commit/faa3e233169523f6bb1537d9b6b2aabe66efd01b"}], "stats": {"total": 34, "additions": 30, "deletions": 4}, "files": [{"sha": "cd745feec6d8acc81063dae1d74b6f0a0a4e85e2", "filename": "tests/ui/as_conversions.rs", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/723ac0faf18613f7652583f83854664e1dc6a89b/tests%2Fui%2Fas_conversions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/723ac0faf18613f7652583f83854664e1dc6a89b/tests%2Fui%2Fas_conversions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fas_conversions.rs?ref=723ac0faf18613f7652583f83854664e1dc6a89b", "patch": "@@ -1,7 +1,19 @@\n-#[warn(clippy::as_conversions)]\n+// aux-build:macro_rules.rs\n+\n+#![warn(clippy::as_conversions)]\n+\n+#[macro_use]\n+extern crate macro_rules;\n+\n+fn with_external_macro() {\n+    as_conv_with_arg!(0u32 as u64);\n+    as_conv!();\n+}\n \n fn main() {\n     let i = 0u32 as u64;\n \n     let j = &i as *const u64 as *mut u64;\n+\n+    with_external_macro();\n }"}, {"sha": "f5f75d3aee04a40f2032684353aa310418343389", "filename": "tests/ui/as_conversions.stderr", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/723ac0faf18613f7652583f83854664e1dc6a89b/tests%2Fui%2Fas_conversions.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/723ac0faf18613f7652583f83854664e1dc6a89b/tests%2Fui%2Fas_conversions.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fas_conversions.stderr?ref=723ac0faf18613f7652583f83854664e1dc6a89b", "patch": "@@ -1,5 +1,5 @@\n error: using a potentially dangerous silent `as` conversion\n-  --> $DIR/as_conversions.rs:4:13\n+  --> $DIR/as_conversions.rs:14:13\n    |\n LL |     let i = 0u32 as u64;\n    |             ^^^^^^^^^^^\n@@ -8,15 +8,15 @@ LL |     let i = 0u32 as u64;\n    = help: consider using a safe wrapper for this conversion\n \n error: using a potentially dangerous silent `as` conversion\n-  --> $DIR/as_conversions.rs:6:13\n+  --> $DIR/as_conversions.rs:16:13\n    |\n LL |     let j = &i as *const u64 as *mut u64;\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |\n    = help: consider using a safe wrapper for this conversion\n \n error: using a potentially dangerous silent `as` conversion\n-  --> $DIR/as_conversions.rs:6:13\n+  --> $DIR/as_conversions.rs:16:13\n    |\n LL |     let j = &i as *const u64 as *mut u64;\n    |             ^^^^^^^^^^^^^^^^"}, {"sha": "f985a15eda2bb5cbc48fecbbdd1e8c1b0205346e", "filename": "tests/ui/auxiliary/macro_rules.rs", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/723ac0faf18613f7652583f83854664e1dc6a89b/tests%2Fui%2Fauxiliary%2Fmacro_rules.rs", "raw_url": "https://github.com/rust-lang/rust/raw/723ac0faf18613f7652583f83854664e1dc6a89b/tests%2Fui%2Fauxiliary%2Fmacro_rules.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fauxiliary%2Fmacro_rules.rs?ref=723ac0faf18613f7652583f83854664e1dc6a89b", "patch": "@@ -70,3 +70,17 @@ macro_rules! ref_arg_function {\n         fn fun_example(ref _x: usize) {}\n     };\n }\n+\n+#[macro_export]\n+macro_rules! as_conv_with_arg {\n+    (0u32 as u64) => {\n+        ()\n+    };\n+}\n+\n+#[macro_export]\n+macro_rules! as_conv {\n+    () => {\n+        0u32 as u64\n+    };\n+}"}]}