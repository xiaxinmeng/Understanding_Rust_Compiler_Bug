{"sha": "070b0350df41a65db066a66c2479ccd229627067", "node_id": "C_kwDOAAsO6NoAKDA3MGIwMzUwZGY0MWE2NWRiMDY2YTY2YzI0NzljY2QyMjk2MjcwNjc", "commit": {"author": {"name": "Philipp Krones", "email": "hello@philkrones.com", "date": "2022-08-21T09:36:30Z"}, "committer": {"name": "Philipp Krones", "email": "hello@philkrones.com", "date": "2022-08-21T09:57:05Z"}, "message": "Improve error if rustfix coverage test spuriously fails", "tree": {"sha": "374c1320711ac2b7b2723f7300faa74a633af4f8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/374c1320711ac2b7b2723f7300faa74a633af4f8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/070b0350df41a65db066a66c2479ccd229627067", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEij1UXJ/PQTcb99vTHKDfKvWdaKUFAmMCAYwACgkQHKDfKvWd\naKX/IhAArd4/+GIkcHeVzTWZ1d6DhLfNG5UshYxtY1o2O0jPhVJCUe9rbAQ1cC1/\nzCh8MjbVBCEaezkhdMuGEo813Cv1ivrFjX47KLeYtde5Y6DrrIWQqkOFryAY4Wrb\nWwpBXT1UMIAuF5Vxc3HuRJLfYn67adUnUH6q6a9U2q+hmKSUdC7uz3g1SunG/5Uu\nyfFUxAcvG7nfRAwQoXmgjfZ8INQ+waQxVhll0ckxPXxzkJx7w/wz0Tym1rJYOMnX\n1KARWdnDJp1WoNHrjassdkZZbmRbKYeE7p/yNG4LD+fVsI4LwXMSUQGGBWhfEaZf\ntIoZfbMmnWCNaFszlww7DX8CL2aOZEa/y6OOMN8QkkFw4f7xUc3fmlEA8zqvg+5z\nN/pVDzcAP5Dqso0x1CiulMslG5/zUS+MK65Ov5Av3YexlMcokbFHHlS70yVzTSgJ\nRnegwN82JuIEdquaNz8R8jYwGStymOd8Hj+3SHORI6/y2mpdogZ/+rdtfEqrL39i\n7VdBRxkYbmbg2UPSMejvJe0eWQ+dkBQvknE4jajtR607OWskFBJBMHjZ2pWslP9d\nvKgol3P5wngPfF90RcumNA0FDIr2LoC0rCw40SBLfAPrEIb8/kZdLiDZQbL1MR/e\nSEFGuRtBol8h8M6Ay+kGtQz2wMdKXTkg436ez74p4lvt3E424+Y=\n=h7R0\n-----END PGP SIGNATURE-----", "payload": "tree 374c1320711ac2b7b2723f7300faa74a633af4f8\nparent 318ed0592077c8ab7dd957e201c7fe8607f1994f\nauthor Philipp Krones <hello@philkrones.com> 1661074590 +0200\ncommitter Philipp Krones <hello@philkrones.com> 1661075825 +0200\n\nImprove error if rustfix coverage test spuriously fails\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/070b0350df41a65db066a66c2479ccd229627067", "html_url": "https://github.com/rust-lang/rust/commit/070b0350df41a65db066a66c2479ccd229627067", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/070b0350df41a65db066a66c2479ccd229627067/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "318ed0592077c8ab7dd957e201c7fe8607f1994f", "url": "https://api.github.com/repos/rust-lang/rust/commits/318ed0592077c8ab7dd957e201c7fe8607f1994f", "html_url": "https://github.com/rust-lang/rust/commit/318ed0592077c8ab7dd957e201c7fe8607f1994f"}], "stats": {"total": 10, "additions": 6, "deletions": 4}, "files": [{"sha": "5431f2ebc0a3d9782f6f384ae7e0aaec28e38555", "filename": "tests/compile-test.rs", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/070b0350df41a65db066a66c2479ccd229627067/tests%2Fcompile-test.rs", "raw_url": "https://github.com/rust-lang/rust/raw/070b0350df41a65db066a66c2479ccd229627067/tests%2Fcompile-test.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fcompile-test.rs?ref=070b0350df41a65db066a66c2479ccd229627067", "patch": "@@ -413,19 +413,21 @@ fn check_rustfix_coverage() {\n     if let Ok(missing_coverage_contents) = std::fs::read_to_string(missing_coverage_path) {\n         assert!(RUSTFIX_COVERAGE_KNOWN_EXCEPTIONS.iter().is_sorted_by_key(Path::new));\n \n-        for rs_path in missing_coverage_contents.lines() {\n-            if Path::new(rs_path).starts_with(\"tests/ui/crashes\") {\n+        for rs_file in missing_coverage_contents.lines() {\n+            let rs_path = Path::new(rs_file);\n+            if rs_path.starts_with(\"tests/ui/crashes\") {\n                 continue;\n             }\n-            let filename = Path::new(rs_path).strip_prefix(\"tests/ui/\").unwrap();\n+            assert!(rs_path.starts_with(\"tests/ui/\"), \"{:?}\", rs_file);\n+            let filename = rs_path.strip_prefix(\"tests/ui/\").unwrap();\n             assert!(\n                 RUSTFIX_COVERAGE_KNOWN_EXCEPTIONS\n                     .binary_search_by_key(&filename, Path::new)\n                     .is_ok(),\n                 \"`{}` runs `MachineApplicable` diagnostics but is missing a `run-rustfix` annotation. \\\n                 Please either add `// run-rustfix` at the top of the file or add the file to \\\n                 `RUSTFIX_COVERAGE_KNOWN_EXCEPTIONS` in `tests/compile-test.rs`.\",\n-                rs_path,\n+                rs_file,\n             );\n         }\n     }"}]}