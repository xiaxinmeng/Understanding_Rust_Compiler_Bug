{"sha": "4c71610e3e9f6f0d322990b75b388a625edc2b17", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRjNzE2MTBlM2U5ZjZmMGQzMjI5OTBiNzViMzg4YTYyNWVkYzJiMTc=", "commit": {"author": {"name": "Joshua Nelson", "email": "jyn514@gmail.com", "date": "2021-05-05T03:36:33Z"}, "committer": {"name": "Joshua Nelson", "email": "jyn514@gmail.com", "date": "2021-06-04T18:58:22Z"}, "message": "rustdoc: link consistently to stable/beta in diagnostic messages", "tree": {"sha": "bffc3cee549e7782f94440d8a55f615d93192712", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bffc3cee549e7782f94440d8a55f615d93192712"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4c71610e3e9f6f0d322990b75b388a625edc2b17", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4c71610e3e9f6f0d322990b75b388a625edc2b17", "html_url": "https://github.com/rust-lang/rust/commit/4c71610e3e9f6f0d322990b75b388a625edc2b17", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4c71610e3e9f6f0d322990b75b388a625edc2b17/comments", "author": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7411a9e7ccde17258ccd39990097fc12f7a76a71", "url": "https://api.github.com/repos/rust-lang/rust/commits/7411a9e7ccde17258ccd39990097fc12f7a76a71", "html_url": "https://github.com/rust-lang/rust/commit/7411a9e7ccde17258ccd39990097fc12f7a76a71"}], "stats": {"total": 24, "additions": 17, "deletions": 7}, "files": [{"sha": "d538ee1404f5126627f7e03478243d03c4e2ca6e", "filename": "src/librustdoc/clean/utils.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/4c71610e3e9f6f0d322990b75b388a625edc2b17/src%2Flibrustdoc%2Fclean%2Futils.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4c71610e3e9f6f0d322990b75b388a625edc2b17/src%2Flibrustdoc%2Fclean%2Futils.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fclean%2Futils.rs?ref=4c71610e3e9f6f0d322990b75b388a625edc2b17", "patch": "@@ -544,7 +544,8 @@ crate fn has_doc_flag(attrs: ty::Attributes<'_>, flag: Symbol) -> bool {\n     })\n }\n \n-/// A link to `doc.rust-lang.org` that includes the channel name.\n+/// A link to `doc.rust-lang.org` that includes the channel name. Use this instead of manual links\n+/// so that the channel is consistent.\n ///\n /// Set by `bootstrap::Builder::doc_rust_lang_org_channel` in order to keep tests passing on beta/stable.\n crate const DOC_RUST_LANG_ORG_CHANNEL: &'static str = env!(\"DOC_RUST_LANG_ORG_CHANNEL\");"}, {"sha": "52cae5631c8bf703e87fc0986bbb45ff7dc7f9cc", "filename": "src/librustdoc/core.rs", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/4c71610e3e9f6f0d322990b75b388a625edc2b17/src%2Flibrustdoc%2Fcore.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4c71610e3e9f6f0d322990b75b388a625edc2b17/src%2Flibrustdoc%2Fcore.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fcore.rs?ref=4c71610e3e9f6f0d322990b75b388a625edc2b17", "patch": "@@ -399,15 +399,18 @@ crate fn run_global_ctxt(\n     let mut krate = tcx.sess.time(\"clean_crate\", || clean::krate(&mut ctxt));\n \n     if krate.module.doc_value().map(|d| d.is_empty()).unwrap_or(true) {\n-        let help = \"The following guide may be of use:\\n\\\n-                https://doc.rust-lang.org/nightly/rustdoc/how-to-write-documentation.html\";\n+        let help = format!(\n+            \"The following guide may be of use:\\n\\\n+            {}/rustdoc/how-to-write-documentation.html\",\n+            crate::DOC_RUST_LANG_ORG_CHANNEL\n+        );\n         tcx.struct_lint_node(\n             crate::lint::MISSING_CRATE_LEVEL_DOCS,\n             DocContext::as_local_hir_id(tcx, krate.module.def_id).unwrap(),\n             |lint| {\n                 let mut diag =\n                     lint.build(\"no documentation found for this crate's top-level module\");\n-                diag.help(help);\n+                diag.help(&help);\n                 diag.emit();\n             },\n         );"}, {"sha": "7319a8185f3e54170739d373b5614b242a3503dc", "filename": "src/librustdoc/lib.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/4c71610e3e9f6f0d322990b75b388a625edc2b17/src%2Flibrustdoc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4c71610e3e9f6f0d322990b75b388a625edc2b17/src%2Flibrustdoc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Flib.rs?ref=4c71610e3e9f6f0d322990b75b388a625edc2b17", "patch": "@@ -605,7 +605,10 @@ fn usage(argv0: &str) {\n     }\n     println!(\"{}\", options.usage(&format!(\"{} [options] <input>\", argv0)));\n     println!(\"    @path               Read newline separated options from `path`\\n\");\n-    println!(\"More information available at https://doc.rust-lang.org/rustdoc/what-is-rustdoc.html\")\n+    println!(\n+        \"More information available at {}/rustdoc/what-is-rustdoc.html\",\n+        DOC_RUST_LANG_ORG_CHANNEL\n+    );\n }\n \n /// A result type used by several functions under `main()`."}, {"sha": "15f378669a5c9762222a4df277f9436e84ce2476", "filename": "src/librustdoc/passes/collect_intra_doc_links.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/4c71610e3e9f6f0d322990b75b388a625edc2b17/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4c71610e3e9f6f0d322990b75b388a625edc2b17/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fpasses%2Fcollect_intra_doc_links.rs?ref=4c71610e3e9f6f0d322990b75b388a625edc2b17", "patch": "@@ -1999,8 +1999,11 @@ fn disambiguator_error(\n ) {\n     diag_info.link_range = disambiguator_range;\n     report_diagnostic(cx.tcx, BROKEN_INTRA_DOC_LINKS, msg, &diag_info, |diag, _sp| {\n-        let msg = \"see https://doc.rust-lang.org/nightly/rustdoc/linking-to-items-by-name.html#namespaces-and-disambiguators for more info about disambiguators\";\n-        diag.note(msg);\n+        let msg = format!(\n+            \"see {}/rustdoc/linking-to-items-by-name.html#namespaces-and-disambiguators for more info about disambiguators\",\n+            crate::DOC_RUST_LANG_ORG_CHANNEL\n+        );\n+        diag.note(&msg);\n     });\n }\n "}]}