{"sha": "ffb3861c7076345f2e43497e5079e9a970571ff0", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZmYjM4NjFjNzA3NjM0NWYyZTQzNDk3ZTUwNzllOWE5NzA1NzFmZjA=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2010-11-06T01:29:18Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2010-11-06T01:31:23Z"}, "message": "Move symbol prefix logic into separate function, add underscore prefix for windows.", "tree": {"sha": "98d22ca29d8e6e4bf3270e7d0c3b77c33659ee67", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/98d22ca29d8e6e4bf3270e7d0c3b77c33659ee67"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ffb3861c7076345f2e43497e5079e9a970571ff0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ffb3861c7076345f2e43497e5079e9a970571ff0", "html_url": "https://github.com/rust-lang/rust/commit/ffb3861c7076345f2e43497e5079e9a970571ff0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ffb3861c7076345f2e43497e5079e9a970571ff0/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c1fb592f620bf29d854d64816974c478d567e578", "url": "https://api.github.com/repos/rust-lang/rust/commits/c1fb592f620bf29d854d64816974c478d567e578", "html_url": "https://github.com/rust-lang/rust/commit/c1fb592f620bf29d854d64816974c478d567e578"}], "stats": {"total": 14, "additions": 10, "deletions": 4}, "files": [{"sha": "22ee3da333113ac02d97eb855d4ef3ecdbed991e", "filename": "src/comp/back/x86.rs", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/ffb3861c7076345f2e43497e5079e9a970571ff0/src%2Fcomp%2Fback%2Fx86.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ffb3861c7076345f2e43497e5079e9a970571ff0/src%2Fcomp%2Fback%2Fx86.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fcomp%2Fback%2Fx86.rs?ref=ffb3861c7076345f2e43497e5079e9a970571ff0", "patch": "@@ -127,13 +127,19 @@ fn decl_upcall_glue(int align, str prefix, uint n) -> str {\n                   upcall_glue(i));\n }\n \n+fn get_symbol_prefix() -> str {\n+    if (_str.eq(target_os(), \"macos\") ||\n+        _str.eq(target_os(), \"win32\")) {\n+        ret \"_\";\n+    } else {\n+        ret \"\";\n+    }\n+}\n+\n fn get_module_asm() -> str {\n     auto align = 4;\n \n-    auto prefix = \"\";\n-    if (_str.eq(target_os(), \"macos\")) {\n-        prefix = \"_\";\n-    }\n+    auto prefix = get_symbol_prefix();\n \n     auto glues =\n         vec(decl_glue(align, prefix,"}]}