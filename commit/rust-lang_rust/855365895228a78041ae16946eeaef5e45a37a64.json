{"sha": "855365895228a78041ae16946eeaef5e45a37a64", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg1NTM2NTg5NTIyOGE3ODA0MWFlMTY5NDZlZWFlZjVlNDVhMzdhNjQ=", "commit": {"author": {"name": "Erick Tryzelaar", "email": "erick.tryzelaar@gmail.com", "date": "2015-04-17T03:38:00Z"}, "committer": {"name": "Erick Tryzelaar", "email": "erick.tryzelaar@gmail.com", "date": "2015-04-21T17:08:27Z"}, "message": "syntax: remove #[feature(quote, unsafe_destructor)]", "tree": {"sha": "ef127a3342c9ce82f7f58fccd61cb083f2f209c6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ef127a3342c9ce82f7f58fccd61cb083f2f209c6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/855365895228a78041ae16946eeaef5e45a37a64", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/855365895228a78041ae16946eeaef5e45a37a64", "html_url": "https://github.com/rust-lang/rust/commit/855365895228a78041ae16946eeaef5e45a37a64", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/855365895228a78041ae16946eeaef5e45a37a64/comments", "author": {"login": "erickt", "id": 84711, "node_id": "MDQ6VXNlcjg0NzEx", "avatar_url": "https://avatars.githubusercontent.com/u/84711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/erickt", "html_url": "https://github.com/erickt", "followers_url": "https://api.github.com/users/erickt/followers", "following_url": "https://api.github.com/users/erickt/following{/other_user}", "gists_url": "https://api.github.com/users/erickt/gists{/gist_id}", "starred_url": "https://api.github.com/users/erickt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/erickt/subscriptions", "organizations_url": "https://api.github.com/users/erickt/orgs", "repos_url": "https://api.github.com/users/erickt/repos", "events_url": "https://api.github.com/users/erickt/events{/privacy}", "received_events_url": "https://api.github.com/users/erickt/received_events", "type": "User", "site_admin": false}, "committer": {"login": "erickt", "id": 84711, "node_id": "MDQ6VXNlcjg0NzEx", "avatar_url": "https://avatars.githubusercontent.com/u/84711?v=4", "gravatar_id": "", "url": "https://api.github.com/users/erickt", "html_url": "https://github.com/erickt", "followers_url": "https://api.github.com/users/erickt/followers", "following_url": "https://api.github.com/users/erickt/following{/other_user}", "gists_url": "https://api.github.com/users/erickt/gists{/gist_id}", "starred_url": "https://api.github.com/users/erickt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/erickt/subscriptions", "organizations_url": "https://api.github.com/users/erickt/orgs", "repos_url": "https://api.github.com/users/erickt/repos", "events_url": "https://api.github.com/users/erickt/events{/privacy}", "received_events_url": "https://api.github.com/users/erickt/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bc6d990adbad6109cf096acc04cc5ab7dfd5b5ff", "url": "https://api.github.com/repos/rust-lang/rust/commits/bc6d990adbad6109cf096acc04cc5ab7dfd5b5ff", "html_url": "https://github.com/rust-lang/rust/commit/bc6d990adbad6109cf096acc04cc5ab7dfd5b5ff"}], "stats": {"total": 49, "additions": 43, "deletions": 6}, "files": [{"sha": "6de4edafa0bf5cafaadd4457d54aeca6d6093bcd", "filename": "src/libsyntax/diagnostics/plugin.rs", "status": "modified", "additions": 43, "deletions": 5, "changes": 48, "blob_url": "https://github.com/rust-lang/rust/blob/855365895228a78041ae16946eeaef5e45a37a64/src%2Flibsyntax%2Fdiagnostics%2Fplugin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/855365895228a78041ae16946eeaef5e45a37a64/src%2Flibsyntax%2Fdiagnostics%2Fplugin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fdiagnostics%2Fplugin.rs?ref=855365895228a78041ae16946eeaef5e45a37a64", "patch": "@@ -77,7 +77,7 @@ pub fn expand_diagnostic_used<'cx>(ecx: &'cx mut ExtCtxt,\n             ));\n         }\n     });\n-    MacEager::expr(quote_expr!(ecx, ()))\n+    MacEager::expr(ecx.expr_tuple(span, Vec::new()))\n }\n \n pub fn expand_register_diagnostic<'cx>(ecx: &'cx mut ExtCtxt,\n@@ -128,7 +128,15 @@ pub fn expand_register_diagnostic<'cx>(ecx: &'cx mut ExtCtxt,\n     let sym = Ident::new(token::gensym(&(\n         \"__register_diagnostic_\".to_string() + &token::get_ident(*code)\n     )));\n-    MacEager::items(SmallVector::many(vec![quote_item!(ecx, mod $sym {}).unwrap()]))\n+    MacEager::items(SmallVector::many(vec![\n+        ecx.item_mod(\n+            span,\n+            span,\n+            sym,\n+            Vec::new(),\n+            Vec::new()\n+        )\n+    ]))\n }\n \n pub fn expand_build_diagnostic_array<'cx>(ecx: &'cx mut ExtCtxt,\n@@ -153,7 +161,37 @@ pub fn expand_build_diagnostic_array<'cx>(ecx: &'cx mut ExtCtxt,\n             (descriptions.len(), ecx.expr_vec(span, descriptions))\n         });\n \n-    MacEager::items(SmallVector::many(vec![quote_item!(ecx,\n-        pub static $name: [(&'static str, &'static str); $count] = $expr;\n-    ).unwrap()]))\n+    let static_ = ecx.lifetime(span, ecx.name_of(\"'static\"));\n+    let ty_str = ecx.ty_rptr(\n+        span,\n+        ecx.ty_ident(span, ecx.ident_of(\"str\")),\n+        Some(static_),\n+        ast::MutImmutable,\n+    );\n+\n+    let ty = ecx.ty(\n+        span,\n+        ast::TyFixedLengthVec(\n+            ecx.ty(\n+                span,\n+                ast::TyTup(vec![ty_str.clone(), ty_str])\n+            ),\n+            ecx.expr_usize(span, count),\n+        ),\n+    );\n+\n+    MacEager::items(SmallVector::many(vec![\n+        P(ast::Item {\n+            ident: name.clone(),\n+            attrs: Vec::new(),\n+            id: ast::DUMMY_NODE_ID,\n+            node: ast::ItemStatic(\n+                ty,\n+                ast::MutImmutable,\n+                expr,\n+            ),\n+            vis: ast::Public,\n+            span: span,\n+        })\n+    ]))\n }"}, {"sha": "8d77894a549fe8873562d6e54121ff7989436bdc", "filename": "src/libsyntax/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/855365895228a78041ae16946eeaef5e45a37a64/src%2Flibsyntax%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/855365895228a78041ae16946eeaef5e45a37a64/src%2Flibsyntax%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Flib.rs?ref=855365895228a78041ae16946eeaef5e45a37a64", "patch": "@@ -28,7 +28,6 @@\n #![feature(collections)]\n #![feature(core)]\n #![feature(libc)]\n-#![feature(quote, unsafe_destructor)]\n #![feature(rustc_private)]\n #![feature(staged_api)]\n #![feature(unicode)]"}]}