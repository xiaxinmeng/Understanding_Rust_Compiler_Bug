{"sha": "5e87f2f89e36250d2066213c47081e631ead9f5f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVlODdmMmY4OWUzNjI1MGQyMDY2MjEzYzQ3MDgxZTYzMWVhZDlmNWY=", "commit": {"author": {"name": "Seo Sanghyeon", "email": "sanxiyn@gmail.com", "date": "2013-08-20T07:50:45Z"}, "committer": {"name": "Seo Sanghyeon", "email": "sanxiyn@gmail.com", "date": "2013-08-20T07:50:45Z"}, "message": "Android: Change directory before running tests", "tree": {"sha": "e799a98eca8e69f28664835891ffed932b858517", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e799a98eca8e69f28664835891ffed932b858517"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5e87f2f89e36250d2066213c47081e631ead9f5f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5e87f2f89e36250d2066213c47081e631ead9f5f", "html_url": "https://github.com/rust-lang/rust/commit/5e87f2f89e36250d2066213c47081e631ead9f5f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5e87f2f89e36250d2066213c47081e631ead9f5f/comments", "author": {"login": "sanxiyn", "id": 45249, "node_id": "MDQ6VXNlcjQ1MjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/45249?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanxiyn", "html_url": "https://github.com/sanxiyn", "followers_url": "https://api.github.com/users/sanxiyn/followers", "following_url": "https://api.github.com/users/sanxiyn/following{/other_user}", "gists_url": "https://api.github.com/users/sanxiyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanxiyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanxiyn/subscriptions", "organizations_url": "https://api.github.com/users/sanxiyn/orgs", "repos_url": "https://api.github.com/users/sanxiyn/repos", "events_url": "https://api.github.com/users/sanxiyn/events{/privacy}", "received_events_url": "https://api.github.com/users/sanxiyn/received_events", "type": "User", "site_admin": false}, "committer": {"login": "sanxiyn", "id": 45249, "node_id": "MDQ6VXNlcjQ1MjQ5", "avatar_url": "https://avatars.githubusercontent.com/u/45249?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanxiyn", "html_url": "https://github.com/sanxiyn", "followers_url": "https://api.github.com/users/sanxiyn/followers", "following_url": "https://api.github.com/users/sanxiyn/following{/other_user}", "gists_url": "https://api.github.com/users/sanxiyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanxiyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanxiyn/subscriptions", "organizations_url": "https://api.github.com/users/sanxiyn/orgs", "repos_url": "https://api.github.com/users/sanxiyn/repos", "events_url": "https://api.github.com/users/sanxiyn/events{/privacy}", "received_events_url": "https://api.github.com/users/sanxiyn/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2ec9b8ce2f08dd9b931bd084f83fd3a4d0c3e8c7", "url": "https://api.github.com/repos/rust-lang/rust/commits/2ec9b8ce2f08dd9b931bd084f83fd3a4d0c3e8c7", "html_url": "https://github.com/rust-lang/rust/commit/2ec9b8ce2f08dd9b931bd084f83fd3a4d0c3e8c7"}], "stats": {"total": 13, "additions": 7, "deletions": 6}, "files": [{"sha": "a9702aa3250e802607ec5fb535030ad45530c0d8", "filename": "mk/tests.mk", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/5e87f2f89e36250d2066213c47081e631ead9f5f/mk%2Ftests.mk", "raw_url": "https://github.com/rust-lang/rust/raw/5e87f2f89e36250d2066213c47081e631ead9f5f/mk%2Ftests.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftests.mk?ref=5e87f2f89e36250d2066213c47081e631ead9f5f", "patch": "@@ -143,8 +143,9 @@ CFG_ADB_TEST_DIR=/data/tmp\n \n $(info check: android device test dir $(CFG_ADB_TEST_DIR) ready \\\n  $(shell adb remount 1>/dev/null) \\\n- $(shell adb shell mkdir $(CFG_ADB_TEST_DIR) 1>/dev/null) \\\n- $(shell adb shell rm -rf $(CFG_ADB_TEST_DIR)/* 1>/dev/null) \\\n+ $(shell adb shell rm -r $(CFG_ADB_TEST_DIR) >/dev/null) \\\n+ $(shell adb shell mkdir $(CFG_ADB_TEST_DIR)) \\\n+ $(shell adb shell mkdir $(CFG_ADB_TEST_DIR)/tmp) \\\n  $(shell adb push $(S)src/etc/adb_run_wrapper.sh $(CFG_ADB_TEST_DIR) 1>/dev/null) \\\n  $(shell adb push $(CFG_ANDROID_CROSS_PATH)/arm-linux-androideabi/lib/armv7-a/libgnustl_shared.so \\\n                   $(CFG_ADB_TEST_DIR) 1>/dev/null) \\\n@@ -408,10 +409,10 @@ $$(call TEST_OK_FILE,$(1),$(2),$(3),$(4)): \\\n \t\t$(3)/stage$(1)/test/$(4)test-$(2)$$(X_$(2))\n \t@$$(call E, run: $$< via adb)\n \t@$(CFG_ADB) push $$< $(CFG_ADB_TEST_DIR)\n-\t@$(CFG_ADB) shell LD_LIBRARY_PATH=$(CFG_ADB_TEST_DIR) \\\n-        $(CFG_ADB_TEST_DIR)/`echo $$< | sed 's/.*\\///'` \\\n-\t\t--logfile $(CFG_ADB_TEST_DIR)/check-stage$(1)-T-$(2)-H-$(3)-$(4).log > \\\n-\t\ttmp/check-stage$(1)-T-$(2)-H-$(3)-$(4).tmp\n+\t@$(CFG_ADB) shell '(cd $(CFG_ADB_TEST_DIR); LD_LIBRARY_PATH=. \\\n+\t\t./$$(notdir $$<) \\\n+\t\t--logfile $(CFG_ADB_TEST_DIR)/check-stage$(1)-T-$(2)-H-$(3)-$(4).log)' \\\n+\t\t> tmp/check-stage$(1)-T-$(2)-H-$(3)-$(4).tmp\n \t@cat tmp/check-stage$(1)-T-$(2)-H-$(3)-$(4).tmp\n \t@touch tmp/check-stage$(1)-T-$(2)-H-$(3)-$(4).log\n \t@$(CFG_ADB) pull $(CFG_ADB_TEST_DIR)/check-stage$(1)-T-$(2)-H-$(3)-$(4).log tmp/"}]}