{"sha": "8926b31088bdb04d1fa772afa0a7dcbc13b38c1f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg5MjZiMzEwODhiZGIwNGQxZmE3NzJhZmEwYTdkY2JjMTNiMzhjMWY=", "commit": {"author": {"name": "Gary Linscott", "email": "glinscott@gmail.com", "date": "2013-07-11T18:45:45Z"}, "committer": {"name": "Gary Linscott", "email": "glinscott@gmail.com", "date": "2013-07-11T19:02:12Z"}, "message": "Add is_utf8 bench tests\n\nBefore:\nis_utf8_ascii:          272.355162 ms\nis_utf8_multibyte:      167.337334 ms\n\nAfter:\nis_utf8_ascii:          218.088049 ms\nis_utf8_multibyte:      134.836722 ms", "tree": {"sha": "d115711b84335ecb12091c008460b8c9688a0838", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d115711b84335ecb12091c008460b8c9688a0838"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8926b31088bdb04d1fa772afa0a7dcbc13b38c1f", "comment_count": 5, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8926b31088bdb04d1fa772afa0a7dcbc13b38c1f", "html_url": "https://github.com/rust-lang/rust/commit/8926b31088bdb04d1fa772afa0a7dcbc13b38c1f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8926b31088bdb04d1fa772afa0a7dcbc13b38c1f/comments", "author": {"login": "glinscott", "id": 554932, "node_id": "MDQ6VXNlcjU1NDkzMg==", "avatar_url": "https://avatars.githubusercontent.com/u/554932?v=4", "gravatar_id": "", "url": "https://api.github.com/users/glinscott", "html_url": "https://github.com/glinscott", "followers_url": "https://api.github.com/users/glinscott/followers", "following_url": "https://api.github.com/users/glinscott/following{/other_user}", "gists_url": "https://api.github.com/users/glinscott/gists{/gist_id}", "starred_url": "https://api.github.com/users/glinscott/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/glinscott/subscriptions", "organizations_url": "https://api.github.com/users/glinscott/orgs", "repos_url": "https://api.github.com/users/glinscott/repos", "events_url": "https://api.github.com/users/glinscott/events{/privacy}", "received_events_url": "https://api.github.com/users/glinscott/received_events", "type": "User", "site_admin": false}, "committer": {"login": "glinscott", "id": 554932, "node_id": "MDQ6VXNlcjU1NDkzMg==", "avatar_url": "https://avatars.githubusercontent.com/u/554932?v=4", "gravatar_id": "", "url": "https://api.github.com/users/glinscott", "html_url": "https://github.com/glinscott", "followers_url": "https://api.github.com/users/glinscott/followers", "following_url": "https://api.github.com/users/glinscott/following{/other_user}", "gists_url": "https://api.github.com/users/glinscott/gists{/gist_id}", "starred_url": "https://api.github.com/users/glinscott/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/glinscott/subscriptions", "organizations_url": "https://api.github.com/users/glinscott/orgs", "repos_url": "https://api.github.com/users/glinscott/repos", "events_url": "https://api.github.com/users/glinscott/events{/privacy}", "received_events_url": "https://api.github.com/users/glinscott/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5aee5a11e3d4807c6df190e33cc6c4dc81ef7ea3", "url": "https://api.github.com/repos/rust-lang/rust/commits/5aee5a11e3d4807c6df190e33cc6c4dc81ef7ea3", "html_url": "https://github.com/rust-lang/rust/commit/5aee5a11e3d4807c6df190e33cc6c4dc81ef7ea3"}], "stats": {"total": 24, "additions": 24, "deletions": 0}, "files": [{"sha": "82139ca3c16a4116baa61bfb95181bb6d08f308e", "filename": "src/test/bench/core-std.rs", "status": "modified", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/8926b31088bdb04d1fa772afa0a7dcbc13b38c1f/src%2Ftest%2Fbench%2Fcore-std.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8926b31088bdb04d1fa772afa0a7dcbc13b38c1f/src%2Ftest%2Fbench%2Fcore-std.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fbench%2Fcore-std.rs?ref=8926b31088bdb04d1fa772afa0a7dcbc13b38c1f", "patch": "@@ -19,6 +19,7 @@ use std::os;\n use std::rand::RngUtil;\n use std::rand;\n use std::result;\n+use std::str;\n use std::uint;\n use std::util;\n use std::vec;\n@@ -36,6 +37,8 @@ fn main() {\n     bench!(vec_plus);\n     bench!(vec_append);\n     bench!(vec_push_all);\n+    bench!(is_utf8_ascii);\n+    bench!(is_utf8_multibyte);\n }\n \n fn maybe_run_test(argv: &[~str], name: ~str, test: &fn()) {\n@@ -127,3 +130,24 @@ fn vec_push_all() {\n         }\n     }\n }\n+\n+fn is_utf8_ascii() {\n+    let mut v : ~[u8] = ~[];\n+    for uint::range(0, 20000) |_| {\n+        v.push('b' as u8);\n+        if !str::is_utf8(v) {\n+            fail!(\"is_utf8 failed\");\n+        }\n+    }\n+}\n+\n+fn is_utf8_multibyte() {\n+    let s = \"b\u00a2\u20ac\ud852\udf62\";\n+    let mut v : ~[u8]= ~[];\n+    for uint::range(0, 5000) |_| {\n+        v.push_all(s.as_bytes());\n+        if !str::is_utf8(v) {\n+            fail!(\"is_utf8 failed\");\n+        }\n+    }\n+}"}]}