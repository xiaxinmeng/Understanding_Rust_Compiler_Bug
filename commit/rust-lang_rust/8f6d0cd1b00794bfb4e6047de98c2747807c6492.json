{"sha": "8f6d0cd1b00794bfb4e6047de98c2747807c6492", "node_id": "C_kwDOAAsO6NoAKDhmNmQwY2QxYjAwNzk0YmZiNGU2MDQ3ZGU5OGMyNzQ3ODA3YzY0OTI", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-12-16T19:53:06Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-12-16T19:53:06Z"}, "message": "Auto merge of #13783 - Veykril:bm-hints, r=Veykril\n\nAdd parentheses for binding mode hints when they attach to an Or-pattern", "tree": {"sha": "bbc994aa3e353630979e6de49885ef7f81d55adc", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/bbc994aa3e353630979e6de49885ef7f81d55adc"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8f6d0cd1b00794bfb4e6047de98c2747807c6492", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8f6d0cd1b00794bfb4e6047de98c2747807c6492", "html_url": "https://github.com/rust-lang/rust/commit/8f6d0cd1b00794bfb4e6047de98c2747807c6492", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8f6d0cd1b00794bfb4e6047de98c2747807c6492/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4909d4fbdbf4e9c81c766edd5a0e38042154bc39", "url": "https://api.github.com/repos/rust-lang/rust/commits/4909d4fbdbf4e9c81c766edd5a0e38042154bc39", "html_url": "https://github.com/rust-lang/rust/commit/4909d4fbdbf4e9c81c766edd5a0e38042154bc39"}, {"sha": "b6c2bb21ab54a84a05163fcb0fce87b540c4ed1e", "url": "https://api.github.com/repos/rust-lang/rust/commits/b6c2bb21ab54a84a05163fcb0fce87b540c4ed1e", "html_url": "https://github.com/rust-lang/rust/commit/b6c2bb21ab54a84a05163fcb0fce87b540c4ed1e"}], "stats": {"total": 52, "additions": 40, "deletions": 12}, "files": [{"sha": "b5b4d6ca64f815494b078e9a3c54d233566f6265", "filename": "crates/ide/src/inlay_hints.rs", "status": "modified", "additions": 29, "deletions": 5, "changes": 34, "blob_url": "https://github.com/rust-lang/rust/blob/8f6d0cd1b00794bfb4e6047de98c2747807c6492/crates%2Fide%2Fsrc%2Finlay_hints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8f6d0cd1b00794bfb4e6047de98c2747807c6492/crates%2Fide%2Fsrc%2Finlay_hints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Finlay_hints.rs?ref=8f6d0cd1b00794bfb4e6047de98c2747807c6492", "patch": "@@ -65,10 +65,11 @@ pub enum InlayKind {\n     ClosureReturnTypeHint,\n     GenericParamListHint,\n     AdjustmentHint,\n-    AdjustmentHintClosingParenthesis,\n     LifetimeHint,\n     ParameterHint,\n     TypeHint,\n+    OpeningParenthesis,\n+    ClosingParenthesis,\n }\n \n #[derive(Debug)]\n@@ -671,7 +672,7 @@ fn adjustment_hints(\n     if needs_parens {\n         acc.push(InlayHint {\n             range: expr.syntax().text_range(),\n-            kind: InlayKind::AdjustmentHint,\n+            kind: InlayKind::OpeningParenthesis,\n             label: \"(\".into(),\n             tooltip: None,\n         });\n@@ -716,7 +717,7 @@ fn adjustment_hints(\n     if needs_parens {\n         acc.push(InlayHint {\n             range: expr.syntax().text_range(),\n-            kind: InlayKind::AdjustmentHintClosingParenthesis,\n+            kind: InlayKind::ClosingParenthesis,\n             label: \")\".into(),\n             tooltip: None,\n         });\n@@ -880,6 +881,20 @@ fn binding_mode_hints(\n                 tooltip: Some(InlayTooltip::String(\"Inferred binding mode\".into())),\n             });\n         }\n+        ast::Pat::OrPat(pat) => {\n+            acc.push(InlayHint {\n+                range: pat.syntax().text_range(),\n+                kind: InlayKind::OpeningParenthesis,\n+                label: \"(\".into(),\n+                tooltip: None,\n+            });\n+            acc.push(InlayHint {\n+                range: pat.syntax().text_range(),\n+                kind: InlayKind::ClosingParenthesis,\n+                label: \")\".into(),\n+                tooltip: None,\n+            });\n+        }\n         _ => (),\n     }\n \n@@ -2951,9 +2966,18 @@ fn __(\n         (x,) => ()\n     }\n     match &(0,) {\n-        (x,) => ()\n-      //^^^^ &\n+        (x,) | (x,) => (),\n+      //^^^^^^^^^^^&\n        //^ ref\n+              //^ ref\n+      //^^^^^^^^^^^(\n+      //^^^^^^^^^^^)\n+        ((x,) | (x,)) => (),\n+       //^^^^^^^^^^^&\n+        //^ ref\n+               //^ ref\n+       //^^^^^^^^^^^(\n+       //^^^^^^^^^^^)\n     }\n     match &mut (0,) {\n         (x,) => ()"}, {"sha": "a7106acc78b157016088c8fda3f86210201748ed", "filename": "crates/rust-analyzer/src/to_proto.rs", "status": "modified", "additions": 11, "deletions": 7, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/8f6d0cd1b00794bfb4e6047de98c2747807c6492/crates%2Frust-analyzer%2Fsrc%2Fto_proto.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8f6d0cd1b00794bfb4e6047de98c2747807c6492/crates%2Frust-analyzer%2Fsrc%2Fto_proto.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fto_proto.rs?ref=8f6d0cd1b00794bfb4e6047de98c2747807c6492", "patch": "@@ -440,22 +440,24 @@ pub(crate) fn inlay_hint(\n     Ok(lsp_types::InlayHint {\n         position: match inlay_hint.kind {\n             // before annotated thing\n-            InlayKind::ParameterHint | InlayKind::AdjustmentHint | InlayKind::BindingModeHint => {\n-                position(line_index, inlay_hint.range.start())\n-            }\n+            InlayKind::OpeningParenthesis\n+            | InlayKind::ParameterHint\n+            | InlayKind::AdjustmentHint\n+            | InlayKind::BindingModeHint => position(line_index, inlay_hint.range.start()),\n             // after annotated thing\n             InlayKind::ClosureReturnTypeHint\n             | InlayKind::TypeHint\n             | InlayKind::ChainingHint\n             | InlayKind::GenericParamListHint\n-            | InlayKind::AdjustmentHintClosingParenthesis\n+            | InlayKind::ClosingParenthesis\n             | InlayKind::LifetimeHint\n             | InlayKind::ClosingBraceHint => position(line_index, inlay_hint.range.end()),\n         },\n         padding_left: Some(match inlay_hint.kind {\n             InlayKind::TypeHint => !render_colons,\n             InlayKind::ChainingHint | InlayKind::ClosingBraceHint => true,\n-            InlayKind::AdjustmentHintClosingParenthesis\n+            InlayKind::ClosingParenthesis\n+            | InlayKind::OpeningParenthesis\n             | InlayKind::BindingModeHint\n             | InlayKind::ClosureReturnTypeHint\n             | InlayKind::GenericParamListHint\n@@ -464,7 +466,8 @@ pub(crate) fn inlay_hint(\n             | InlayKind::ParameterHint => false,\n         }),\n         padding_right: Some(match inlay_hint.kind {\n-            InlayKind::AdjustmentHintClosingParenthesis\n+            InlayKind::ClosingParenthesis\n+            | InlayKind::OpeningParenthesis\n             | InlayKind::ChainingHint\n             | InlayKind::ClosureReturnTypeHint\n             | InlayKind::GenericParamListHint\n@@ -479,7 +482,8 @@ pub(crate) fn inlay_hint(\n             InlayKind::ClosureReturnTypeHint | InlayKind::TypeHint | InlayKind::ChainingHint => {\n                 Some(lsp_types::InlayHintKind::TYPE)\n             }\n-            InlayKind::AdjustmentHintClosingParenthesis\n+            InlayKind::ClosingParenthesis\n+            | InlayKind::OpeningParenthesis\n             | InlayKind::BindingModeHint\n             | InlayKind::GenericParamListHint\n             | InlayKind::LifetimeHint"}]}