{"sha": "c9bf5c0bffef595136b484b0282ade18894cf5af", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM5YmY1YzBiZmZlZjU5NTEzNmI0ODRiMDI4MmFkZTE4ODk0Y2Y1YWY=", "commit": {"author": {"name": "Charles Lew", "email": "crlf0710@gmail.com", "date": "2019-08-27T16:45:29Z"}, "committer": {"name": "Charles Lew", "email": "crlf0710@gmail.com", "date": "2019-08-27T16:47:12Z"}, "message": "bootstrap: allow specifying mirror for bootstrap compiler download.", "tree": {"sha": "eb83d36c497890fc0e2297cea51029dc7b2f3fa4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/eb83d36c497890fc0e2297cea51029dc7b2f3fa4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c9bf5c0bffef595136b484b0282ade18894cf5af", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c9bf5c0bffef595136b484b0282ade18894cf5af", "html_url": "https://github.com/rust-lang/rust/commit/c9bf5c0bffef595136b484b0282ade18894cf5af", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c9bf5c0bffef595136b484b0282ade18894cf5af/comments", "author": {"login": "crlf0710", "id": 451806, "node_id": "MDQ6VXNlcjQ1MTgwNg==", "avatar_url": "https://avatars.githubusercontent.com/u/451806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crlf0710", "html_url": "https://github.com/crlf0710", "followers_url": "https://api.github.com/users/crlf0710/followers", "following_url": "https://api.github.com/users/crlf0710/following{/other_user}", "gists_url": "https://api.github.com/users/crlf0710/gists{/gist_id}", "starred_url": "https://api.github.com/users/crlf0710/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crlf0710/subscriptions", "organizations_url": "https://api.github.com/users/crlf0710/orgs", "repos_url": "https://api.github.com/users/crlf0710/repos", "events_url": "https://api.github.com/users/crlf0710/events{/privacy}", "received_events_url": "https://api.github.com/users/crlf0710/received_events", "type": "User", "site_admin": false}, "committer": {"login": "crlf0710", "id": 451806, "node_id": "MDQ6VXNlcjQ1MTgwNg==", "avatar_url": "https://avatars.githubusercontent.com/u/451806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/crlf0710", "html_url": "https://github.com/crlf0710", "followers_url": "https://api.github.com/users/crlf0710/followers", "following_url": "https://api.github.com/users/crlf0710/following{/other_user}", "gists_url": "https://api.github.com/users/crlf0710/gists{/gist_id}", "starred_url": "https://api.github.com/users/crlf0710/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/crlf0710/subscriptions", "organizations_url": "https://api.github.com/users/crlf0710/orgs", "repos_url": "https://api.github.com/users/crlf0710/repos", "events_url": "https://api.github.com/users/crlf0710/events{/privacy}", "received_events_url": "https://api.github.com/users/crlf0710/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7e0afdad28c4d1154176df6d35a14e738ec311af", "url": "https://api.github.com/repos/rust-lang/rust/commits/7e0afdad28c4d1154176df6d35a14e738ec311af", "html_url": "https://github.com/rust-lang/rust/commit/7e0afdad28c4d1154176df6d35a14e738ec311af"}], "stats": {"total": 16, "additions": 14, "deletions": 2}, "files": [{"sha": "c9f5d299a61c98123ed59fc4265d4c74184da97a", "filename": "src/bootstrap/bootstrap.py", "status": "modified", "additions": 14, "deletions": 2, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/c9bf5c0bffef595136b484b0282ade18894cf5af/src%2Fbootstrap%2Fbootstrap.py", "raw_url": "https://github.com/rust-lang/rust/raw/c9bf5c0bffef595136b484b0282ade18894cf5af/src%2Fbootstrap%2Fbootstrap.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbootstrap.py?ref=c9bf5c0bffef595136b484b0282ade18894cf5af", "patch": "@@ -320,7 +320,7 @@ class RustBuild(object):\n     def __init__(self):\n         self.cargo_channel = ''\n         self.date = ''\n-        self._download_url = 'https://static.rust-lang.org'\n+        self._download_url = ''\n         self.rustc_channel = ''\n         self.build = ''\n         self.build_dir = os.path.join(os.getcwd(), \"build\")\n@@ -731,9 +731,19 @@ def update_submodules(self):\n             self.update_submodule(module[0], module[1], recorded_submodules)\n         print(\"Submodules updated in %.2f seconds\" % (time() - start_time))\n \n+    def set_normal_environment(self):\n+        \"\"\"Set download URL for normal environment\"\"\"\n+        if 'RUSTUP_DIST_SERVER' in os.environ:\n+            self._download_url = os.environ['RUSTUP_DIST_SERVER']\n+        else:\n+            self._download_url = 'https://static.rust-lang.org'\n+\n     def set_dev_environment(self):\n         \"\"\"Set download URL for development environment\"\"\"\n-        self._download_url = 'https://dev-static.rust-lang.org'\n+        if 'RUSTUP_DEV_DIST_SERVER' in os.environ:\n+            self._download_url = os.environ['RUSTUP_DEV_DIST_SERVER']\n+        else:\n+            self._download_url = 'https://dev-static.rust-lang.org'\n \n     def check_vendored_status(self):\n         \"\"\"Check that vendoring is configured properly\"\"\"\n@@ -826,6 +836,8 @@ def bootstrap(help_triggered):\n \n     if 'dev' in data:\n         build.set_dev_environment()\n+    else:\n+        build.set_normal_environment()\n \n     build.update_submodules()\n "}]}