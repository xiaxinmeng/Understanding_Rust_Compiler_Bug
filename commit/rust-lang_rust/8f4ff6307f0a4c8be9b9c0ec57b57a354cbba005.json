{"sha": "8f4ff6307f0a4c8be9b9c0ec57b57a354cbba005", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhmNGZmNjMwN2YwYTRjOGJlOWI5YzBlYzU3YjU3YTM1NGNiYmEwMDU=", "commit": {"author": {"name": "bgermann", "email": "bgermann@users.noreply.github.com", "date": "2017-10-13T09:36:44Z"}, "committer": {"name": "bgermann", "email": "bgermann@users.noreply.github.com", "date": "2017-10-13T09:36:44Z"}, "message": "Make Solaris builder compatible with Solaris 10", "tree": {"sha": "ab84da6009524b855baf642f52c6895498731430", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ab84da6009524b855baf642f52c6895498731430"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8f4ff6307f0a4c8be9b9c0ec57b57a354cbba005", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8f4ff6307f0a4c8be9b9c0ec57b57a354cbba005", "html_url": "https://github.com/rust-lang/rust/commit/8f4ff6307f0a4c8be9b9c0ec57b57a354cbba005", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8f4ff6307f0a4c8be9b9c0ec57b57a354cbba005/comments", "author": {"login": "bgermann", "id": 9329107, "node_id": "MDQ6VXNlcjkzMjkxMDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9329107?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bgermann", "html_url": "https://github.com/bgermann", "followers_url": "https://api.github.com/users/bgermann/followers", "following_url": "https://api.github.com/users/bgermann/following{/other_user}", "gists_url": "https://api.github.com/users/bgermann/gists{/gist_id}", "starred_url": "https://api.github.com/users/bgermann/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bgermann/subscriptions", "organizations_url": "https://api.github.com/users/bgermann/orgs", "repos_url": "https://api.github.com/users/bgermann/repos", "events_url": "https://api.github.com/users/bgermann/events{/privacy}", "received_events_url": "https://api.github.com/users/bgermann/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bgermann", "id": 9329107, "node_id": "MDQ6VXNlcjkzMjkxMDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9329107?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bgermann", "html_url": "https://github.com/bgermann", "followers_url": "https://api.github.com/users/bgermann/followers", "following_url": "https://api.github.com/users/bgermann/following{/other_user}", "gists_url": "https://api.github.com/users/bgermann/gists{/gist_id}", "starred_url": "https://api.github.com/users/bgermann/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bgermann/subscriptions", "organizations_url": "https://api.github.com/users/bgermann/orgs", "repos_url": "https://api.github.com/users/bgermann/repos", "events_url": "https://api.github.com/users/bgermann/events{/privacy}", "received_events_url": "https://api.github.com/users/bgermann/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2d7397230ad0bf292c701bb73757947237653354", "url": "https://api.github.com/repos/rust-lang/rust/commits/2d7397230ad0bf292c701bb73757947237653354", "html_url": "https://github.com/rust-lang/rust/commit/2d7397230ad0bf292c701bb73757947237653354"}], "stats": {"total": 34, "additions": 19, "deletions": 15}, "files": [{"sha": "029d2c18d4a4ce7f9c0d386118ec885216cd8567", "filename": "src/ci/docker/cross2/Dockerfile", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/8f4ff6307f0a4c8be9b9c0ec57b57a354cbba005/src%2Fci%2Fdocker%2Fcross2%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/8f4ff6307f0a4c8be9b9c0ec57b57a354cbba005/src%2Fci%2Fdocker%2Fcross2%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fcross2%2FDockerfile?ref=8f4ff6307f0a4c8be9b9c0ec57b57a354cbba005", "patch": "@@ -36,12 +36,12 @@ ENV \\\n     AR_aarch64_unknown_fuchsia=aarch64-unknown-fuchsia-ar \\\n     CC_aarch64_unknown_fuchsia=aarch64-unknown-fuchsia-clang \\\n     CXX_aarch64_unknown_fuchsia=aarch64-unknown-fuchsia-clang++ \\\n-    AR_sparcv9_sun_solaris=sparcv9-sun-solaris2.11-ar \\\n-    CC_sparcv9_sun_solaris=sparcv9-sun-solaris2.11-gcc \\\n-    CXX_sparcv9_sun_solaris=sparcv9-sun-solaris2.11-g++ \\\n-    AR_x86_64_sun_solaris=x86_64-sun-solaris2.11-ar \\\n-    CC_x86_64_sun_solaris=x86_64-sun-solaris2.11-gcc \\\n-    CXX_x86_64_sun_solaris=x86_64-sun-solaris2.11-g++\n+    AR_sparcv9_sun_solaris=sparcv9-sun-solaris2.10-ar \\\n+    CC_sparcv9_sun_solaris=sparcv9-sun-solaris2.10-gcc \\\n+    CXX_sparcv9_sun_solaris=sparcv9-sun-solaris2.10-g++ \\\n+    AR_x86_64_sun_solaris=x86_64-sun-solaris2.10-ar \\\n+    CC_x86_64_sun_solaris=x86_64-sun-solaris2.10-gcc \\\n+    CXX_x86_64_sun_solaris=x86_64-sun-solaris2.10-g++\n \n ENV TARGETS=x86_64-unknown-fuchsia\n ENV TARGETS=$TARGETS,aarch64-unknown-fuchsia"}, {"sha": "935cbe5d61b58eff77992c5df1cee66d300425c8", "filename": "src/ci/docker/cross2/build-solaris-toolchain.sh", "status": "modified", "additions": 13, "deletions": 9, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/8f4ff6307f0a4c8be9b9c0ec57b57a354cbba005/src%2Fci%2Fdocker%2Fcross2%2Fbuild-solaris-toolchain.sh", "raw_url": "https://github.com/rust-lang/rust/raw/8f4ff6307f0a4c8be9b9c0ec57b57a354cbba005/src%2Fci%2Fdocker%2Fcross2%2Fbuild-solaris-toolchain.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fcross2%2Fbuild-solaris-toolchain.sh?ref=8f4ff6307f0a4c8be9b9c0ec57b57a354cbba005", "patch": "@@ -25,7 +25,7 @@ cd binutils\n curl https://ftp.gnu.org/gnu/binutils/binutils-$BINUTILS.tar.xz | tar xJf -\n mkdir binutils-build\n cd binutils-build\n-hide_output ../binutils-$BINUTILS/configure --target=$ARCH-sun-solaris2.11\n+hide_output ../binutils-$BINUTILS/configure --target=$ARCH-sun-solaris2.10\n hide_output make -j10\n hide_output make install\n \n@@ -58,13 +58,17 @@ for deb in *$APT_ARCH.deb; do\n   dpkg -x $deb .\n done\n \n-mkdir                  /usr/local/$ARCH-sun-solaris2.11/usr\n-mv usr/include         /usr/local/$ARCH-sun-solaris2.11/usr/include\n-mv usr/lib/$LIB_ARCH/* /usr/local/$ARCH-sun-solaris2.11/lib\n-mv     lib/$LIB_ARCH/* /usr/local/$ARCH-sun-solaris2.11/lib\n+# Strip Solaris 11 functions that are optionally used by libbacktrace.\n+# This is for Solaris 10 compatibility.\n+$ARCH-sun-solaris2.10-strip -N dl_iterate_phdr -N strnlen lib/$LIB_ARCH/libc.so\n \n-ln -s /usr/local/$ARCH-sun-solaris2.11/usr/include /usr/local/$ARCH-sun-solaris2.11/sys-include\n-ln -s /usr/local/$ARCH-sun-solaris2.11/usr/include /usr/local/$ARCH-sun-solaris2.11/include\n+mkdir                  /usr/local/$ARCH-sun-solaris2.10/usr\n+mv usr/include         /usr/local/$ARCH-sun-solaris2.10/usr/include\n+mv usr/lib/$LIB_ARCH/* /usr/local/$ARCH-sun-solaris2.10/lib\n+mv     lib/$LIB_ARCH/* /usr/local/$ARCH-sun-solaris2.10/lib\n+\n+ln -s /usr/local/$ARCH-sun-solaris2.10/usr/include /usr/local/$ARCH-sun-solaris2.10/sys-include\n+ln -s /usr/local/$ARCH-sun-solaris2.10/usr/include /usr/local/$ARCH-sun-solaris2.10/include\n \n cd ..\n rm -rf solaris\n@@ -80,7 +84,7 @@ mkdir ../gcc-build\n cd ../gcc-build\n hide_output ../gcc-$GCC/configure \\\n   --enable-languages=c,c++        \\\n-  --target=$ARCH-sun-solaris2.11  \\\n+  --target=$ARCH-sun-solaris2.10  \\\n   --with-gnu-as                   \\\n   --with-gnu-ld                   \\\n   --disable-multilib              \\\n@@ -94,7 +98,7 @@ hide_output ../gcc-$GCC/configure \\\n   --disable-libsanitizer          \\\n   --disable-libquadmath-support   \\\n   --disable-lto                   \\\n-  --with-sysroot=/usr/local/$ARCH-sun-solaris2.11\n+  --with-sysroot=/usr/local/$ARCH-sun-solaris2.10\n \n hide_output make -j10\n hide_output make install"}]}