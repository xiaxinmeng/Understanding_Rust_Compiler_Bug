{"sha": "75474ff1323c2968bb2dafc8b8f0af4817a89d01", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc1NDc0ZmYxMzIzYzI5NjhiYjJkYWZjOGI4ZjBhZjQ4MTdhODlkMDE=", "commit": {"author": {"name": "oberien", "email": "jaro.fietz@gmx.de", "date": "2018-02-02T08:31:56Z"}, "committer": {"name": "oberien", "email": "jaro.fietz@gmx.de", "date": "2018-02-04T15:09:32Z"}, "message": "TrustedLen for Repeat / RangeFrom test cases", "tree": {"sha": "4f56a427389cdb9f3cb7ba641e8ecdcde2948da0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4f56a427389cdb9f3cb7ba641e8ecdcde2948da0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/75474ff1323c2968bb2dafc8b8f0af4817a89d01", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/75474ff1323c2968bb2dafc8b8f0af4817a89d01", "html_url": "https://github.com/rust-lang/rust/commit/75474ff1323c2968bb2dafc8b8f0af4817a89d01", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/75474ff1323c2968bb2dafc8b8f0af4817a89d01/comments", "author": {"login": "oberien", "id": 4820508, "node_id": "MDQ6VXNlcjQ4MjA1MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/4820508?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oberien", "html_url": "https://github.com/oberien", "followers_url": "https://api.github.com/users/oberien/followers", "following_url": "https://api.github.com/users/oberien/following{/other_user}", "gists_url": "https://api.github.com/users/oberien/gists{/gist_id}", "starred_url": "https://api.github.com/users/oberien/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oberien/subscriptions", "organizations_url": "https://api.github.com/users/oberien/orgs", "repos_url": "https://api.github.com/users/oberien/repos", "events_url": "https://api.github.com/users/oberien/events{/privacy}", "received_events_url": "https://api.github.com/users/oberien/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oberien", "id": 4820508, "node_id": "MDQ6VXNlcjQ4MjA1MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/4820508?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oberien", "html_url": "https://github.com/oberien", "followers_url": "https://api.github.com/users/oberien/followers", "following_url": "https://api.github.com/users/oberien/following{/other_user}", "gists_url": "https://api.github.com/users/oberien/gists{/gist_id}", "starred_url": "https://api.github.com/users/oberien/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oberien/subscriptions", "organizations_url": "https://api.github.com/users/oberien/orgs", "repos_url": "https://api.github.com/users/oberien/repos", "events_url": "https://api.github.com/users/oberien/events{/privacy}", "received_events_url": "https://api.github.com/users/oberien/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a1809d57840a19e28e93b437a7d029be3656acb8", "url": "https://api.github.com/repos/rust-lang/rust/commits/a1809d57840a19e28e93b437a7d029be3656acb8", "html_url": "https://github.com/rust-lang/rust/commit/a1809d57840a19e28e93b437a7d029be3656acb8"}], "stats": {"total": 66, "additions": 66, "deletions": 0}, "files": [{"sha": "f6b12fbb2dd111cdb500f97b4cc2a5c7604a9619", "filename": "src/libcore/tests/iter.rs", "status": "modified", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/rust-lang/rust/blob/75474ff1323c2968bb2dafc8b8f0af4817a89d01/src%2Flibcore%2Ftests%2Fiter.rs", "raw_url": "https://github.com/rust-lang/rust/raw/75474ff1323c2968bb2dafc8b8f0af4817a89d01/src%2Flibcore%2Ftests%2Fiter.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Ftests%2Fiter.rs?ref=75474ff1323c2968bb2dafc8b8f0af4817a89d01", "patch": "@@ -1371,6 +1371,29 @@ fn test_range_from_nth() {\n     assert_eq!(r, 16..);\n     assert_eq!(r.nth(10), Some(26));\n     assert_eq!(r, 27..);\n+\n+    assert_eq!((0..).size_hint(), (usize::MAX, None));\n+}\n+\n+fn is_trusted_len<I: TrustedLen>(_: I) {}\n+\n+#[test]\n+fn test_range_from_take() {\n+    let mut it = (0..).take(3);\n+    assert_eq!(it.next(), Some(0));\n+    assert_eq!(it.next(), Some(1));\n+    assert_eq!(it.next(), Some(2));\n+    assert_eq!(it.next(), None);\n+    is_trusted_len((0..).take(3));\n+    assert_eq!((0..).take(3).size_hint(), (3, Some(3)));\n+    assert_eq!((0..).take(0).size_hint(), (0, Some(0)));\n+    assert_eq!((0..).take(usize::MAX).size_hint(), (usize::MAX, Some(usize::MAX)));\n+}\n+\n+#[test]\n+fn test_range_from_take_collect() {\n+    let v: Vec<_> = (0..).take(3).collect();\n+    assert_eq!(v, vec![0, 1, 2]);\n }\n \n #[test]\n@@ -1465,6 +1488,26 @@ fn test_repeat() {\n     assert_eq!(it.next(), Some(42));\n     assert_eq!(it.next(), Some(42));\n     assert_eq!(it.next(), Some(42));\n+    assert_eq!(repeat(42).size_hint(), (usize::MAX, None));\n+}\n+\n+#[test]\n+fn test_repeat_take() {\n+    let mut it = repeat(42).take(3);\n+    assert_eq!(it.next(), Some(42));\n+    assert_eq!(it.next(), Some(42));\n+    assert_eq!(it.next(), Some(42));\n+    assert_eq!(it.next(), None);\n+    is_trusted_len(repeat(42).take(3));\n+    assert_eq!(repeat(42).take(3).size_hint(), (3, Some(3)));\n+    assert_eq!(repeat(42).take(0).size_hint(), (0, Some(0)));\n+    assert_eq!(repeat(42).take(usize::MAX).size_hint(), (usize::MAX, Some(usize::MAX)));\n+}\n+\n+#[test]\n+fn test_repeat_take_collect() {\n+    let v: Vec<_> = repeat(42).take(3).collect();\n+    assert_eq!(v, vec![42, 42, 42]);\n }\n \n #[test]"}, {"sha": "43872f15d51e22ca898e17607ecb42dcb25becf5", "filename": "src/test/codegen/repeat-trusted-len.rs", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/75474ff1323c2968bb2dafc8b8f0af4817a89d01/src%2Ftest%2Fcodegen%2Frepeat-trusted-len.rs", "raw_url": "https://github.com/rust-lang/rust/raw/75474ff1323c2968bb2dafc8b8f0af4817a89d01/src%2Ftest%2Fcodegen%2Frepeat-trusted-len.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcodegen%2Frepeat-trusted-len.rs?ref=75474ff1323c2968bb2dafc8b8f0af4817a89d01", "patch": "@@ -0,0 +1,23 @@\n+// Copyright 2018 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// compile-flags: -O\n+// ignore-tidy-linelength\n+\n+#![crate_type = \"lib\"]\n+\n+use std::iter;\n+\n+// CHECK-LABEL: @repeat_take_collect\n+#[no_mangle]\n+pub fn repeat_take_collect() -> Vec<u8> {\n+// CHECK: call void @llvm.memset.p0i8\n+    iter::repeat(42).take(100000).collect()\n+}"}]}