{"sha": "c5025f0e4e46569bdd31743434a9d2dd602e95f2", "node_id": "C_kwDOAAsO6NoAKGM1MDI1ZjBlNGU0NjU2OWJkZDMxNzQzNDM0YTlkMmRkNjAyZTk1ZjI", "commit": {"author": {"name": "David Tolnay", "email": "dtolnay@gmail.com", "date": "2021-10-26T03:25:30Z"}, "committer": {"name": "David Tolnay", "email": "dtolnay@gmail.com", "date": "2021-10-26T03:30:47Z"}, "message": "Append .0 to unsuffixed float if it would otherwise become int token", "tree": {"sha": "cab3f6e40bb3bf8f76897e901e1336e5b1bd77d4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/cab3f6e40bb3bf8f76897e901e1336e5b1bd77d4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c5025f0e4e46569bdd31743434a9d2dd602e95f2", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEERijF2Cz/ZdaBZKeK+boUO5X/bYIFAmF3dmcACgkQ+boUO5X/\nbYIw5w//eYq0SolFSgkTXjI+IFfIOIrNTFmD3GziVcuxMsuXo/Q73yed1N8FQf/j\nhuiIF9+u5NXGA4x2xjCZvIbGb5FjRR3zEP7jH8M7jUlr9eHx37lXmW/9/f+qWV0m\n99h9Ab2bUwh6+lvVYzVKVlENSWIGg3C82x7N9NUDgNr/ZNjN1UGRGppjxProeHg1\nUa0myOa6OVLQ+WTm94iAk2U2Gq0eg2buUkfvpd/ywNuUYfNyNMjmNam4Ov4/i+M4\nDBSyYOgZ1Gqw1vIWNhB7+J7hUEbknEPKwA9XOEWsrk7fc1HsvxK2oyiuW5mH0GES\nnjAoRbto3J9UIAg4uCOUn5JPIscmYAsThm1GiV05GCxqg9OIq6ZNUhZqDYl3uVGL\nObHTU7OVuCVzy+1fQOL/cqKI/dkdp0Uro9lqXvZrFew5KxWGyMkQM8XcMGlqYCUO\n//850ExGugaFxDIAPdDy1Xl47ahKD//caX7cJ990xE314omqfMi7McDYEERy2NeO\nlsC2AuM1c0bihh90mObqRX0SvVMpe8UY57FLjtyrzSRsVkO20moyV3ErqAveiOFX\nKco0O4cMuU4Ntpu6cK05jZHRwHEJgnDD2xEbgixtSgnsXRZDehiS6s76gzfnWfsh\n4ro1iae2+zscdjhzZ8q40sz08Mal0a6GyRinomfelmWEdUrpphQ=\n=fv5V\n-----END PGP SIGNATURE-----", "payload": "tree cab3f6e40bb3bf8f76897e901e1336e5b1bd77d4\nparent ffba4309241a7a21df4ec7b16f1357cbcd327d6e\nauthor David Tolnay <dtolnay@gmail.com> 1635218730 -0700\ncommitter David Tolnay <dtolnay@gmail.com> 1635219047 -0700\n\nAppend .0 to unsuffixed float if it would otherwise become int token\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c5025f0e4e46569bdd31743434a9d2dd602e95f2", "html_url": "https://github.com/rust-lang/rust/commit/c5025f0e4e46569bdd31743434a9d2dd602e95f2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c5025f0e4e46569bdd31743434a9d2dd602e95f2/comments", "author": {"login": "dtolnay", "id": 1940490, "node_id": "MDQ6VXNlcjE5NDA0OTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1940490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtolnay", "html_url": "https://github.com/dtolnay", "followers_url": "https://api.github.com/users/dtolnay/followers", "following_url": "https://api.github.com/users/dtolnay/following{/other_user}", "gists_url": "https://api.github.com/users/dtolnay/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtolnay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtolnay/subscriptions", "organizations_url": "https://api.github.com/users/dtolnay/orgs", "repos_url": "https://api.github.com/users/dtolnay/repos", "events_url": "https://api.github.com/users/dtolnay/events{/privacy}", "received_events_url": "https://api.github.com/users/dtolnay/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dtolnay", "id": 1940490, "node_id": "MDQ6VXNlcjE5NDA0OTA=", "avatar_url": "https://avatars.githubusercontent.com/u/1940490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtolnay", "html_url": "https://github.com/dtolnay", "followers_url": "https://api.github.com/users/dtolnay/followers", "following_url": "https://api.github.com/users/dtolnay/following{/other_user}", "gists_url": "https://api.github.com/users/dtolnay/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtolnay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtolnay/subscriptions", "organizations_url": "https://api.github.com/users/dtolnay/orgs", "repos_url": "https://api.github.com/users/dtolnay/repos", "events_url": "https://api.github.com/users/dtolnay/events{/privacy}", "received_events_url": "https://api.github.com/users/dtolnay/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ffba4309241a7a21df4ec7b16f1357cbcd327d6e", "url": "https://api.github.com/repos/rust-lang/rust/commits/ffba4309241a7a21df4ec7b16f1357cbcd327d6e", "html_url": "https://github.com/rust-lang/rust/commit/ffba4309241a7a21df4ec7b16f1357cbcd327d6e"}], "stats": {"total": 16, "additions": 14, "deletions": 2}, "files": [{"sha": "9d673d69687191dfb4525339593a7e2979506e11", "filename": "library/proc_macro/src/lib.rs", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/c5025f0e4e46569bdd31743434a9d2dd602e95f2/library%2Fproc_macro%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c5025f0e4e46569bdd31743434a9d2dd602e95f2/library%2Fproc_macro%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fproc_macro%2Fsrc%2Flib.rs?ref=c5025f0e4e46569bdd31743434a9d2dd602e95f2", "patch": "@@ -1074,7 +1074,11 @@ impl Literal {\n         if !n.is_finite() {\n             panic!(\"Invalid float literal {}\", n);\n         }\n-        Literal(bridge::client::Literal::float(&n.to_string()))\n+        let mut repr = n.to_string();\n+        if !repr.contains('.') {\n+            repr.push_str(\".0\");\n+        }\n+        Literal(bridge::client::Literal::float(&repr))\n     }\n \n     /// Creates a new suffixed floating-point literal.\n@@ -1115,7 +1119,11 @@ impl Literal {\n         if !n.is_finite() {\n             panic!(\"Invalid float literal {}\", n);\n         }\n-        Literal(bridge::client::Literal::float(&n.to_string()))\n+        let mut repr = n.to_string();\n+        if !repr.contains('.') {\n+            repr.push_str(\".0\");\n+        }\n+        Literal(bridge::client::Literal::float(&repr))\n     }\n \n     /// Creates a new suffixed floating-point literal."}, {"sha": "ef777fc033368ebcce0aa7f1c880ead3ed27d764", "filename": "src/test/ui/proc-macro/auxiliary/api/parse.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/c5025f0e4e46569bdd31743434a9d2dd602e95f2/src%2Ftest%2Fui%2Fproc-macro%2Fauxiliary%2Fapi%2Fparse.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c5025f0e4e46569bdd31743434a9d2dd602e95f2/src%2Ftest%2Fui%2Fproc-macro%2Fauxiliary%2Fapi%2Fparse.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Fauxiliary%2Fapi%2Fparse.rs?ref=c5025f0e4e46569bdd31743434a9d2dd602e95f2", "patch": "@@ -8,6 +8,10 @@ pub fn test() {\n fn test_display_literal() {\n     assert_eq!(Literal::isize_unsuffixed(-10).to_string(), \"-10\");\n     assert_eq!(Literal::isize_suffixed(-10).to_string(), \"-10isize\");\n+    assert_eq!(Literal::f32_unsuffixed(-10.0).to_string(), \"-10.0\");\n+    assert_eq!(Literal::f32_suffixed(-10.0).to_string(), \"-10f32\");\n+    assert_eq!(Literal::f64_unsuffixed(-10.0).to_string(), \"-10.0\");\n+    assert_eq!(Literal::f64_suffixed(-10.0).to_string(), \"-10f64\");\n }\n \n fn test_parse_literal() {"}]}