{"sha": "7d0586cb15000193941f93d4b5281e56ef751edd", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdkMDU4NmNiMTUwMDAxOTM5NDFmOTNkNGI1MjgxZTU2ZWY3NTFlZGQ=", "commit": {"author": {"name": "Florian Diebold", "email": "florian.diebold@freiheit.com", "date": "2020-05-29T14:03:06Z"}, "committer": {"name": "Florian Diebold", "email": "florian.diebold@freiheit.com", "date": "2020-05-29T14:04:56Z"}, "message": "Use first match branch in case of type mismatch, not last\n\nThe comment says this was intentional, but I do agree with #4304 that it makes\nmore sense the other way around (for if/else as well).\n\nFixes #4304.", "tree": {"sha": "84d3847e805b43b641ec7db04f78064835c1ee07", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/84d3847e805b43b641ec7db04f78064835c1ee07"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7d0586cb15000193941f93d4b5281e56ef751edd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7d0586cb15000193941f93d4b5281e56ef751edd", "html_url": "https://github.com/rust-lang/rust/commit/7d0586cb15000193941f93d4b5281e56ef751edd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7d0586cb15000193941f93d4b5281e56ef751edd/comments", "author": {"login": "flodiebold", "id": 906069, "node_id": "MDQ6VXNlcjkwNjA2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/906069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flodiebold", "html_url": "https://github.com/flodiebold", "followers_url": "https://api.github.com/users/flodiebold/followers", "following_url": "https://api.github.com/users/flodiebold/following{/other_user}", "gists_url": "https://api.github.com/users/flodiebold/gists{/gist_id}", "starred_url": "https://api.github.com/users/flodiebold/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flodiebold/subscriptions", "organizations_url": "https://api.github.com/users/flodiebold/orgs", "repos_url": "https://api.github.com/users/flodiebold/repos", "events_url": "https://api.github.com/users/flodiebold/events{/privacy}", "received_events_url": "https://api.github.com/users/flodiebold/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flodiebold", "id": 906069, "node_id": "MDQ6VXNlcjkwNjA2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/906069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flodiebold", "html_url": "https://github.com/flodiebold", "followers_url": "https://api.github.com/users/flodiebold/followers", "following_url": "https://api.github.com/users/flodiebold/following{/other_user}", "gists_url": "https://api.github.com/users/flodiebold/gists{/gist_id}", "starred_url": "https://api.github.com/users/flodiebold/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flodiebold/subscriptions", "organizations_url": "https://api.github.com/users/flodiebold/orgs", "repos_url": "https://api.github.com/users/flodiebold/repos", "events_url": "https://api.github.com/users/flodiebold/events{/privacy}", "received_events_url": "https://api.github.com/users/flodiebold/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "190a0595a478d059fdd95a179fe38d59cb6379be", "url": "https://api.github.com/repos/rust-lang/rust/commits/190a0595a478d059fdd95a179fe38d59cb6379be", "html_url": "https://github.com/rust-lang/rust/commit/190a0595a478d059fdd95a179fe38d59cb6379be"}], "stats": {"total": 6, "additions": 2, "deletions": 4}, "files": [{"sha": "32c7c57cd61a3be0561d59436b391eb6fda0ec77", "filename": "crates/ra_hir_ty/src/infer/coerce.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/7d0586cb15000193941f93d4b5281e56ef751edd/crates%2Fra_hir_ty%2Fsrc%2Finfer%2Fcoerce.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7d0586cb15000193941f93d4b5281e56ef751edd/crates%2Fra_hir_ty%2Fsrc%2Finfer%2Fcoerce.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir_ty%2Fsrc%2Finfer%2Fcoerce.rs?ref=7d0586cb15000193941f93d4b5281e56ef751edd", "patch": "@@ -45,9 +45,7 @@ impl<'a> InferenceContext<'a> {\n                 self.coerce_merge_branch(&ptr_ty1, &ptr_ty2)\n             } else {\n                 mark::hit!(coerce_merge_fail_fallback);\n-                // For incompatible types, we use the latter one as result\n-                // to be better recovery for `if` without `else`.\n-                ty2.clone()\n+                ty1.clone()\n             }\n         }\n     }"}, {"sha": "daa9cc953f81a180d74686dcdbc48e802d3625e6", "filename": "crates/ra_hir_ty/src/tests/simple.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7d0586cb15000193941f93d4b5281e56ef751edd/crates%2Fra_hir_ty%2Fsrc%2Ftests%2Fsimple.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7d0586cb15000193941f93d4b5281e56ef751edd/crates%2Fra_hir_ty%2Fsrc%2Ftests%2Fsimple.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir_ty%2Fsrc%2Ftests%2Fsimple.rs?ref=7d0586cb15000193941f93d4b5281e56ef751edd", "patch": "@@ -937,7 +937,7 @@ fn main(foo: Foo) {\n     51..107 'if tru...     }': ()\n     54..58 'true': bool\n     59..67 '{      }': ()\n-    73..107 'if fal...     }': ()\n+    73..107 'if fal...     }': i32\n     76..81 'false': bool\n     82..107 '{     ...     }': i32\n     92..95 'foo': Foo"}]}