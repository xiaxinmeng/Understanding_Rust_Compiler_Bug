{"sha": "a836d9b6413d9d593be6c09463ff8c4c70e56599", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE4MzZkOWI2NDEzZDlkNTkzYmU2YzA5NDYzZmY4YzRjNzBlNTY1OTk=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-04-10T19:20:16Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-04-10T19:20:16Z"}, "message": "Auto merge of #84016 - Aaron1011:new-preexp-tests, r=petrochenkov\n\nAdd some proc-macro attribute token handling tests\n\nSplit out from https://github.com/rust-lang/rust/pull/82608\n\nr? `@petrochenkov`", "tree": {"sha": "84453d2fec81c62101d4dbbb0bc9041655cbb1f1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/84453d2fec81c62101d4dbbb0bc9041655cbb1f1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a836d9b6413d9d593be6c09463ff8c4c70e56599", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a836d9b6413d9d593be6c09463ff8c4c70e56599", "html_url": "https://github.com/rust-lang/rust/commit/a836d9b6413d9d593be6c09463ff8c4c70e56599", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a836d9b6413d9d593be6c09463ff8c4c70e56599/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "72c63de2ccf8445bfe27dcfb4f712bc771da1b15", "url": "https://api.github.com/repos/rust-lang/rust/commits/72c63de2ccf8445bfe27dcfb4f712bc771da1b15", "html_url": "https://github.com/rust-lang/rust/commit/72c63de2ccf8445bfe27dcfb4f712bc771da1b15"}, {"sha": "6c591112ce88ad64b21cf9ec5e3f5f6d9363bab6", "url": "https://api.github.com/repos/rust-lang/rust/commits/6c591112ce88ad64b21cf9ec5e3f5f6d9363bab6", "html_url": "https://github.com/rust-lang/rust/commit/6c591112ce88ad64b21cf9ec5e3f5f6d9363bab6"}], "stats": {"total": 1265, "additions": 1199, "deletions": 66}, "files": [{"sha": "ea5ff466570e6603d4cd07afb7f9eff744e1165e", "filename": "src/test/ui/proc-macro/auxiliary/nonterminal-recollect-attr.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Fauxiliary%2Fnonterminal-recollect-attr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Fauxiliary%2Fnonterminal-recollect-attr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Fauxiliary%2Fnonterminal-recollect-attr.rs?ref=a836d9b6413d9d593be6c09463ff8c4c70e56599", "patch": "@@ -10,6 +10,7 @@ use proc_macro::{TokenStream, quote};\n #[proc_macro_attribute]\n pub fn first_attr(_: TokenStream, input: TokenStream) -> TokenStream {\n     let recollected: TokenStream = input.into_iter().collect();\n+    println!(\"First recollected: {:#?}\", recollected);\n     quote! {\n         #[second_attr]\n         $recollected\n@@ -18,6 +19,7 @@ pub fn first_attr(_: TokenStream, input: TokenStream) -> TokenStream {\n \n #[proc_macro_attribute]\n pub fn second_attr(_: TokenStream, input: TokenStream) -> TokenStream {\n-    let _recollected: TokenStream = input.into_iter().collect();\n+    let recollected: TokenStream = input.into_iter().collect();\n+    println!(\"Second recollected: {:#?}\", recollected);\n     TokenStream::new()\n }"}, {"sha": "5fd3ca0d163bccd5a9f754295391e5c9a53eef77", "filename": "src/test/ui/proc-macro/cfg-eval-inner.rs", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Fcfg-eval-inner.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Fcfg-eval-inner.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Fcfg-eval-inner.rs?ref=a836d9b6413d9d593be6c09463ff8c4c70e56599", "patch": "@@ -0,0 +1,39 @@\n+// compile-flags: -Z span-debug\n+// aux-build:test-macros.rs\n+// check-pass\n+\n+#![feature(cfg_eval)]\n+#![feature(custom_inner_attributes)]\n+#![feature(stmt_expr_attributes)]\n+#![feature(rustc_attrs)]\n+\n+#![no_std] // Don't load unnecessary hygiene information from std\n+extern crate std;\n+\n+#[macro_use]\n+extern crate test_macros;\n+\n+struct Foo<T>(T);\n+\n+impl Foo<[u8; {\n+    #![cfg_attr(not(FALSE), rustc_dummy(cursed_inner))]\n+    #![allow(unused)]\n+    struct Inner {\n+        field: [u8; {\n+            #![cfg_attr(not(FALSE), rustc_dummy(another_cursed_inner))]\n+            1\n+        }]\n+    }\n+\n+    0\n+}]> {\n+    #![cfg_eval]\n+    #![print_attr]\n+    #![cfg_attr(not(FALSE), rustc_dummy(evaluated_attr))]\n+\n+    fn bar() {\n+        #[cfg(FALSE)] let a = 1;\n+    }\n+}\n+\n+fn main() {}"}, {"sha": "a9301d3349f177673542252803b8d5e7189459f0", "filename": "src/test/ui/proc-macro/cfg-eval-inner.stdout", "status": "added", "additions": 252, "deletions": 0, "changes": 252, "blob_url": "https://github.com/rust-lang/rust/blob/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Fcfg-eval-inner.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Fcfg-eval-inner.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Fcfg-eval-inner.stdout?ref=a836d9b6413d9d593be6c09463ff8c4c70e56599", "patch": "@@ -0,0 +1,252 @@\n+PRINT-ATTR INPUT (DISPLAY): impl Foo <\n+[u8 ;\n+ {\n+     # ! [rustc_dummy(cursed_inner)] # ! [allow(unused)] struct Inner\n+     { field : [u8 ; { # ! [rustc_dummy(another_cursed_inner)] 1 }], } 0\n+ }] > { # ! [rustc_dummy(evaluated_attr)] fn bar() { } }\n+PRINT-ATTR INPUT (DEBUG): TokenStream [\n+    Ident {\n+        ident: \"impl\",\n+        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+    },\n+    Ident {\n+        ident: \"Foo\",\n+        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+    },\n+    Punct {\n+        ch: '<',\n+        spacing: Alone,\n+        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+    },\n+    Group {\n+        delimiter: Bracket,\n+        stream: TokenStream [\n+            Ident {\n+                ident: \"u8\",\n+                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+            },\n+            Punct {\n+                ch: ';',\n+                spacing: Alone,\n+                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+            },\n+            Group {\n+                delimiter: Brace,\n+                stream: TokenStream [\n+                    Punct {\n+                        ch: '#',\n+                        spacing: Joint,\n+                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                    },\n+                    Punct {\n+                        ch: '!',\n+                        spacing: Alone,\n+                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                    },\n+                    Group {\n+                        delimiter: Bracket,\n+                        stream: TokenStream [\n+                            Ident {\n+                                ident: \"rustc_dummy\",\n+                                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                            },\n+                            Group {\n+                                delimiter: Parenthesis,\n+                                stream: TokenStream [\n+                                    Ident {\n+                                        ident: \"cursed_inner\",\n+                                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                                    },\n+                                ],\n+                                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                            },\n+                        ],\n+                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                    },\n+                    Punct {\n+                        ch: '#',\n+                        spacing: Joint,\n+                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                    },\n+                    Punct {\n+                        ch: '!',\n+                        spacing: Alone,\n+                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                    },\n+                    Group {\n+                        delimiter: Bracket,\n+                        stream: TokenStream [\n+                            Ident {\n+                                ident: \"allow\",\n+                                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                            },\n+                            Group {\n+                                delimiter: Parenthesis,\n+                                stream: TokenStream [\n+                                    Ident {\n+                                        ident: \"unused\",\n+                                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                                    },\n+                                ],\n+                                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                            },\n+                        ],\n+                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                    },\n+                    Ident {\n+                        ident: \"struct\",\n+                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                    },\n+                    Ident {\n+                        ident: \"Inner\",\n+                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                    },\n+                    Group {\n+                        delimiter: Brace,\n+                        stream: TokenStream [\n+                            Ident {\n+                                ident: \"field\",\n+                                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                            },\n+                            Punct {\n+                                ch: ':',\n+                                spacing: Alone,\n+                                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                            },\n+                            Group {\n+                                delimiter: Bracket,\n+                                stream: TokenStream [\n+                                    Ident {\n+                                        ident: \"u8\",\n+                                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                                    },\n+                                    Punct {\n+                                        ch: ';',\n+                                        spacing: Alone,\n+                                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                                    },\n+                                    Group {\n+                                        delimiter: Brace,\n+                                        stream: TokenStream [\n+                                            Punct {\n+                                                ch: '#',\n+                                                spacing: Joint,\n+                                                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                                            },\n+                                            Punct {\n+                                                ch: '!',\n+                                                spacing: Alone,\n+                                                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                                            },\n+                                            Group {\n+                                                delimiter: Bracket,\n+                                                stream: TokenStream [\n+                                                    Ident {\n+                                                        ident: \"rustc_dummy\",\n+                                                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                                                    },\n+                                                    Group {\n+                                                        delimiter: Parenthesis,\n+                                                        stream: TokenStream [\n+                                                            Ident {\n+                                                                ident: \"another_cursed_inner\",\n+                                                                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                                                            },\n+                                                        ],\n+                                                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                                                    },\n+                                                ],\n+                                                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                                            },\n+                                            Literal {\n+                                                kind: Integer,\n+                                                symbol: \"1\",\n+                                                suffix: None,\n+                                                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                                            },\n+                                        ],\n+                                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                                    },\n+                                ],\n+                                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                            },\n+                            Punct {\n+                                ch: ',',\n+                                spacing: Alone,\n+                                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                            },\n+                        ],\n+                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                    },\n+                    Literal {\n+                        kind: Integer,\n+                        symbol: \"0\",\n+                        suffix: None,\n+                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                    },\n+                ],\n+                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+            },\n+        ],\n+        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+    },\n+    Punct {\n+        ch: '>',\n+        spacing: Alone,\n+        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+    },\n+    Group {\n+        delimiter: Brace,\n+        stream: TokenStream [\n+            Punct {\n+                ch: '#',\n+                spacing: Joint,\n+                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+            },\n+            Punct {\n+                ch: '!',\n+                spacing: Alone,\n+                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+            },\n+            Group {\n+                delimiter: Bracket,\n+                stream: TokenStream [\n+                    Ident {\n+                        ident: \"rustc_dummy\",\n+                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                    },\n+                    Group {\n+                        delimiter: Parenthesis,\n+                        stream: TokenStream [\n+                            Ident {\n+                                ident: \"evaluated_attr\",\n+                                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                            },\n+                        ],\n+                        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+                    },\n+                ],\n+                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+            },\n+            Ident {\n+                ident: \"fn\",\n+                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+            },\n+            Ident {\n+                ident: \"bar\",\n+                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+            },\n+            Group {\n+                delimiter: Parenthesis,\n+                stream: TokenStream [],\n+                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+            },\n+            Group {\n+                delimiter: Brace,\n+                stream: TokenStream [],\n+                span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+            },\n+        ],\n+        span: $DIR/cfg-eval-inner.rs:18:1: 37:2 (#0),\n+    },\n+]"}, {"sha": "fa6d015e48eb8a4039f853b1fee08b23419006a0", "filename": "src/test/ui/proc-macro/cfg-eval.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Fcfg-eval.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Fcfg-eval.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Fcfg-eval.rs?ref=a836d9b6413d9d593be6c09463ff8c4c70e56599", "patch": "@@ -5,7 +5,7 @@\n #![feature(cfg_eval)]\n #![feature(proc_macro_hygiene)]\n #![feature(stmt_expr_attributes)]\n-\n+#![feature(rustc_attrs)]\n #![no_std] // Don't load unnecessary hygiene information from std\n extern crate std;\n \n@@ -28,5 +28,10 @@ struct S1 {\n struct S2 {}\n \n fn main() {\n-    let _ = #[cfg_eval] #[print_attr](#[cfg(FALSE)] 0, #[cfg(all(/*true*/))] 1);\n+    // Subtle - we need a trailing comma after the '1' - otherwise, `#[cfg_eval]` will\n+    // turn this into `(#[cfg(all())] 1)`, which is a parenthesized expression, not a tuple\n+    // expression. `#[cfg]` is not supported inside parenthesized expressions, so this will\n+    // produce an error when attribute collection runs.\n+    let _ = #[cfg_eval] #[print_attr] #[cfg_attr(not(FALSE), rustc_dummy)]\n+    (#[cfg(FALSE)] 0, #[cfg(all(/*true*/))] 1,);\n }"}, {"sha": "1f784598ff708b3243dd63056d2fb5ae735cb895", "filename": "src/test/ui/proc-macro/cfg-eval.stdout", "status": "modified", "additions": 25, "deletions": 10, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Fcfg-eval.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Fcfg-eval.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Fcfg-eval.stdout?ref=a836d9b6413d9d593be6c09463ff8c4c70e56599", "patch": "@@ -83,53 +83,68 @@ PRINT-ATTR INPUT (DEBUG): TokenStream [\n         span: $DIR/cfg-eval.rs:17:1: 24:2 (#0),\n     },\n ]\n-PRINT-ATTR INPUT (DISPLAY): (#[cfg(all())] 1,)\n+PRINT-ATTR INPUT (DISPLAY): #[rustc_dummy] (#[cfg(all())] 1,)\n PRINT-ATTR INPUT (DEBUG): TokenStream [\n+    Punct {\n+        ch: '#',\n+        spacing: Alone,\n+        span: $DIR/cfg-eval.rs:36:5: 36:48 (#0),\n+    },\n+    Group {\n+        delimiter: Bracket,\n+        stream: TokenStream [\n+            Ident {\n+                ident: \"rustc_dummy\",\n+                span: $DIR/cfg-eval.rs:36:5: 36:48 (#0),\n+            },\n+        ],\n+        span: $DIR/cfg-eval.rs:36:5: 36:48 (#0),\n+    },\n     Group {\n         delimiter: Parenthesis,\n         stream: TokenStream [\n             Punct {\n                 ch: '#',\n                 spacing: Alone,\n-                span: $DIR/cfg-eval.rs:31:38: 31:80 (#0),\n+                span: $DIR/cfg-eval.rs:36:5: 36:48 (#0),\n             },\n             Group {\n                 delimiter: Bracket,\n                 stream: TokenStream [\n                     Ident {\n                         ident: \"cfg\",\n-                        span: $DIR/cfg-eval.rs:31:38: 31:80 (#0),\n+                        span: $DIR/cfg-eval.rs:36:5: 36:48 (#0),\n                     },\n                     Group {\n                         delimiter: Parenthesis,\n                         stream: TokenStream [\n                             Ident {\n                                 ident: \"all\",\n-                                span: $DIR/cfg-eval.rs:31:38: 31:80 (#0),\n+                                span: $DIR/cfg-eval.rs:36:5: 36:48 (#0),\n                             },\n                             Group {\n                                 delimiter: Parenthesis,\n                                 stream: TokenStream [],\n-                                span: $DIR/cfg-eval.rs:31:38: 31:80 (#0),\n+                                span: $DIR/cfg-eval.rs:36:5: 36:48 (#0),\n                             },\n                         ],\n-                        span: $DIR/cfg-eval.rs:31:38: 31:80 (#0),\n+                        span: $DIR/cfg-eval.rs:36:5: 36:48 (#0),\n                     },\n                 ],\n-                span: $DIR/cfg-eval.rs:31:38: 31:80 (#0),\n+                span: $DIR/cfg-eval.rs:36:5: 36:48 (#0),\n             },\n             Literal {\n                 kind: Integer,\n                 symbol: \"1\",\n                 suffix: None,\n-                span: $DIR/cfg-eval.rs:31:38: 31:80 (#0),\n+                span: $DIR/cfg-eval.rs:36:5: 36:48 (#0),\n             },\n             Punct {\n                 ch: ',',\n                 spacing: Alone,\n-                span: $DIR/cfg-eval.rs:31:38: 31:80 (#0),\n+                span: $DIR/cfg-eval.rs:36:5: 36:48 (#0),\n             },\n         ],\n-        span: $DIR/cfg-eval.rs:31:38: 31:80 (#0),\n+        span: $DIR/cfg-eval.rs:36:5: 36:48 (#0),\n     },\n ]"}, {"sha": "1ff97dbf3c7fad1717f9056b2f0def71a818802c", "filename": "src/test/ui/proc-macro/inner-attrs.rs", "status": "modified", "additions": 53, "deletions": 1, "changes": 54, "blob_url": "https://github.com/rust-lang/rust/blob/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Finner-attrs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Finner-attrs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Finner-attrs.rs?ref=a836d9b6413d9d593be6c09463ff8c4c70e56599", "patch": "@@ -1,6 +1,6 @@\n // compile-flags: -Z span-debug --error-format human\n // aux-build:test-macros.rs\n-\n+// edition:2018\n #![feature(custom_inner_attributes)]\n #![feature(proc_macro_hygiene)]\n #![feature(stmt_expr_attributes)]\n@@ -19,10 +19,32 @@ fn foo() {\n     #![print_target_and_args(fourth)]\n }\n \n+#[print_target_and_args(mod_first)]\n+#[print_target_and_args(mod_second)]\n+mod inline_mod {\n+    #![print_target_and_args(mod_third)]\n+    #![print_target_and_args(mod_fourth)]\n+}\n+\n struct MyStruct {\n     field: bool\n }\n \n+#[derive(Print)]\n+struct MyDerivePrint {\n+    field: [u8; {\n+        match true {\n+            #![cfg_attr(not(FALSE), rustc_dummy(first))]\n+            #![cfg_attr(not(FALSE), rustc_dummy(second))]\n+            _ => {\n+                #![cfg_attr(not(FALSE), rustc_dummy(second))]\n+                true\n+            }\n+        };\n+        0\n+    }]\n+}\n+\n fn bar() {\n     (#![print_target_and_args(fifth)] 1, 2);\n     //~^ ERROR expected non-macro inner attribute, found attribute macro\n@@ -40,6 +62,19 @@ fn bar() {\n         true; 0\n     ];\n \n+    #[print_target_and_args(tuple_attrs)] (\n+        #![cfg_attr(FALSE, rustc_dummy)]\n+        3, 4, {\n+            #![cfg_attr(not(FALSE), rustc_dummy(innermost))]\n+            5\n+        }\n+    );\n+\n+    #[print_target_and_args(array_attrs)] [\n+        #![rustc_dummy(inner)]\n+        true; 0\n+    ];\n+\n     [#![print_target_and_args(sixth)] 1 , 2];\n     //~^ ERROR expected non-macro inner attribute, found attribute macro\n     [#![print_target_and_args(seventh)] true ; 5];\n@@ -53,8 +88,25 @@ fn bar() {\n \n     MyStruct { #![print_target_and_args(ninth)] field: true };\n     //~^ ERROR expected non-macro inner attribute, found attribute macro\n+\n+    for _ in &[true] {\n+        #![print_attr] //~ ERROR expected non-macro inner attribute\n+    }\n+\n+    let _ = {\n+        #![print_attr] //~ ERROR expected non-macro inner attribute\n+    };\n+\n+    let _ = async {\n+        #![print_attr] //~ ERROR expected non-macro inner attribute\n+    };\n+\n+    {\n+        #![print_attr] //~ ERROR expected non-macro inner attribute\n+    };\n }\n \n+\n extern {\n     fn weird_extern() {\n         #![print_target_and_args_consume(tenth)]"}, {"sha": "7f22c5f30d660792d9357c23f31ef230bfae566e", "filename": "src/test/ui/proc-macro/inner-attrs.stderr", "status": "modified", "additions": 30, "deletions": 6, "changes": 36, "blob_url": "https://github.com/rust-lang/rust/blob/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Finner-attrs.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Finner-attrs.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Finner-attrs.stderr?ref=a836d9b6413d9d593be6c09463ff8c4c70e56599", "patch": "@@ -1,32 +1,56 @@\n error: expected non-macro inner attribute, found attribute macro `print_target_and_args`\n-  --> $DIR/inner-attrs.rs:27:9\n+  --> $DIR/inner-attrs.rs:49:9\n    |\n LL |     (#![print_target_and_args(fifth)] 1, 2);\n    |         ^^^^^^^^^^^^^^^^^^^^^ not a non-macro inner attribute\n \n error: expected non-macro inner attribute, found attribute macro `print_target_and_args`\n-  --> $DIR/inner-attrs.rs:43:9\n+  --> $DIR/inner-attrs.rs:78:9\n    |\n LL |     [#![print_target_and_args(sixth)] 1 , 2];\n    |         ^^^^^^^^^^^^^^^^^^^^^ not a non-macro inner attribute\n \n error: expected non-macro inner attribute, found attribute macro `print_target_and_args`\n-  --> $DIR/inner-attrs.rs:45:9\n+  --> $DIR/inner-attrs.rs:80:9\n    |\n LL |     [#![print_target_and_args(seventh)] true ; 5];\n    |         ^^^^^^^^^^^^^^^^^^^^^ not a non-macro inner attribute\n \n error: expected non-macro inner attribute, found attribute macro `print_target_and_args`\n-  --> $DIR/inner-attrs.rs:49:12\n+  --> $DIR/inner-attrs.rs:84:12\n    |\n LL |         #![print_target_and_args(eighth)]\n    |            ^^^^^^^^^^^^^^^^^^^^^ not a non-macro inner attribute\n \n error: expected non-macro inner attribute, found attribute macro `print_target_and_args`\n-  --> $DIR/inner-attrs.rs:54:19\n+  --> $DIR/inner-attrs.rs:89:19\n    |\n LL |     MyStruct { #![print_target_and_args(ninth)] field: true };\n    |                   ^^^^^^^^^^^^^^^^^^^^^ not a non-macro inner attribute\n \n-error: aborting due to 5 previous errors\n+error: expected non-macro inner attribute, found attribute macro `print_attr`\n+  --> $DIR/inner-attrs.rs:93:12\n+   |\n+LL |         #![print_attr]\n+   |            ^^^^^^^^^^ not a non-macro inner attribute\n+\n+error: expected non-macro inner attribute, found attribute macro `print_attr`\n+  --> $DIR/inner-attrs.rs:97:12\n+   |\n+LL |         #![print_attr]\n+   |            ^^^^^^^^^^ not a non-macro inner attribute\n+\n+error: expected non-macro inner attribute, found attribute macro `print_attr`\n+  --> $DIR/inner-attrs.rs:101:12\n+   |\n+LL |         #![print_attr]\n+   |            ^^^^^^^^^^ not a non-macro inner attribute\n+\n+error: expected non-macro inner attribute, found attribute macro `print_attr`\n+  --> $DIR/inner-attrs.rs:105:12\n+   |\n+LL |         #![print_attr]\n+   |            ^^^^^^^^^^ not a non-macro inner attribute\n+\n+error: aborting due to 9 previous errors\n "}, {"sha": "b44822fb557f9c8ec414710d1fce39825f161f5b", "filename": "src/test/ui/proc-macro/inner-attrs.stdout", "status": "modified", "additions": 714, "deletions": 46, "changes": 760, "blob_url": "https://github.com/rust-lang/rust/blob/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Finner-attrs.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Finner-attrs.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Finner-attrs.stdout?ref=a836d9b6413d9d593be6c09463ff8c4c70e56599", "patch": "@@ -290,11 +290,679 @@ PRINT-ATTR INPUT (DEBUG): TokenStream [\n         span: $DIR/inner-attrs.rs:17:1: 20:2 (#0),\n     },\n ]\n+PRINT-ATTR_ARGS INPUT (DISPLAY): mod_first\n+PRINT-ATTR_ARGS INPUT (DEBUG): TokenStream [\n+    Ident {\n+        ident: \"mod_first\",\n+        span: $DIR/inner-attrs.rs:22:25: 22:34 (#0),\n+    },\n+]\n+PRINT-ATTR INPUT (DISPLAY): #[print_target_and_args(mod_second)] mod inline_mod\n+{\n+    # ! [print_target_and_args(mod_third)] # !\n+    [print_target_and_args(mod_fourth)]\n+}\n+PRINT-ATTR INPUT (DEBUG): TokenStream [\n+    Punct {\n+        ch: '#',\n+        spacing: Alone,\n+        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+    },\n+    Group {\n+        delimiter: Bracket,\n+        stream: TokenStream [\n+            Ident {\n+                ident: \"print_target_and_args\",\n+                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+            },\n+            Group {\n+                delimiter: Parenthesis,\n+                stream: TokenStream [\n+                    Ident {\n+                        ident: \"mod_second\",\n+                        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+                    },\n+                ],\n+                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+            },\n+        ],\n+        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+    },\n+    Ident {\n+        ident: \"mod\",\n+        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+    },\n+    Ident {\n+        ident: \"inline_mod\",\n+        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+    },\n+    Group {\n+        delimiter: Brace,\n+        stream: TokenStream [\n+            Punct {\n+                ch: '#',\n+                spacing: Joint,\n+                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+            },\n+            Punct {\n+                ch: '!',\n+                spacing: Alone,\n+                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+            },\n+            Group {\n+                delimiter: Bracket,\n+                stream: TokenStream [\n+                    Ident {\n+                        ident: \"print_target_and_args\",\n+                        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+                    },\n+                    Group {\n+                        delimiter: Parenthesis,\n+                        stream: TokenStream [\n+                            Ident {\n+                                ident: \"mod_third\",\n+                                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+                            },\n+                        ],\n+                        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+                    },\n+                ],\n+                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+            },\n+            Punct {\n+                ch: '#',\n+                spacing: Joint,\n+                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+            },\n+            Punct {\n+                ch: '!',\n+                spacing: Alone,\n+                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+            },\n+            Group {\n+                delimiter: Bracket,\n+                stream: TokenStream [\n+                    Ident {\n+                        ident: \"print_target_and_args\",\n+                        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+                    },\n+                    Group {\n+                        delimiter: Parenthesis,\n+                        stream: TokenStream [\n+                            Ident {\n+                                ident: \"mod_fourth\",\n+                                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+                            },\n+                        ],\n+                        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+                    },\n+                ],\n+                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+            },\n+        ],\n+        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+    },\n+]\n+PRINT-ATTR_ARGS INPUT (DISPLAY): mod_second\n+PRINT-ATTR_ARGS INPUT (DEBUG): TokenStream [\n+    Ident {\n+        ident: \"mod_second\",\n+        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+    },\n+]\n+PRINT-ATTR INPUT (DISPLAY): mod inline_mod\n+{\n+    # ! [print_target_and_args(mod_third)] # !\n+    [print_target_and_args(mod_fourth)]\n+}\n+PRINT-ATTR INPUT (DEBUG): TokenStream [\n+    Ident {\n+        ident: \"mod\",\n+        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+    },\n+    Ident {\n+        ident: \"inline_mod\",\n+        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+    },\n+    Group {\n+        delimiter: Brace,\n+        stream: TokenStream [\n+            Punct {\n+                ch: '#',\n+                spacing: Joint,\n+                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+            },\n+            Punct {\n+                ch: '!',\n+                spacing: Alone,\n+                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+            },\n+            Group {\n+                delimiter: Bracket,\n+                stream: TokenStream [\n+                    Ident {\n+                        ident: \"print_target_and_args\",\n+                        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+                    },\n+                    Group {\n+                        delimiter: Parenthesis,\n+                        stream: TokenStream [\n+                            Ident {\n+                                ident: \"mod_third\",\n+                                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+                            },\n+                        ],\n+                        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+                    },\n+                ],\n+                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+            },\n+            Punct {\n+                ch: '#',\n+                spacing: Joint,\n+                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+            },\n+            Punct {\n+                ch: '!',\n+                spacing: Alone,\n+                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+            },\n+            Group {\n+                delimiter: Bracket,\n+                stream: TokenStream [\n+                    Ident {\n+                        ident: \"print_target_and_args\",\n+                        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+                    },\n+                    Group {\n+                        delimiter: Parenthesis,\n+                        stream: TokenStream [\n+                            Ident {\n+                                ident: \"mod_fourth\",\n+                                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+                            },\n+                        ],\n+                        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+                    },\n+                ],\n+                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+            },\n+        ],\n+        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+    },\n+]\n+PRINT-ATTR_ARGS INPUT (DISPLAY): mod_third\n+PRINT-ATTR_ARGS INPUT (DEBUG): TokenStream [\n+    Ident {\n+        ident: \"mod_third\",\n+        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+    },\n+]\n+PRINT-ATTR INPUT (DISPLAY): mod inline_mod { # ! [print_target_and_args(mod_fourth)] }\n+PRINT-ATTR INPUT (DEBUG): TokenStream [\n+    Ident {\n+        ident: \"mod\",\n+        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+    },\n+    Ident {\n+        ident: \"inline_mod\",\n+        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+    },\n+    Group {\n+        delimiter: Brace,\n+        stream: TokenStream [\n+            Punct {\n+                ch: '#',\n+                spacing: Joint,\n+                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+            },\n+            Punct {\n+                ch: '!',\n+                spacing: Alone,\n+                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+            },\n+            Group {\n+                delimiter: Bracket,\n+                stream: TokenStream [\n+                    Ident {\n+                        ident: \"print_target_and_args\",\n+                        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+                    },\n+                    Group {\n+                        delimiter: Parenthesis,\n+                        stream: TokenStream [\n+                            Ident {\n+                                ident: \"mod_fourth\",\n+                                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+                            },\n+                        ],\n+                        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+                    },\n+                ],\n+                span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+            },\n+        ],\n+        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+    },\n+]\n+PRINT-ATTR_ARGS INPUT (DISPLAY): mod_fourth\n+PRINT-ATTR_ARGS INPUT (DEBUG): TokenStream [\n+    Ident {\n+        ident: \"mod_fourth\",\n+        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+    },\n+]\n+PRINT-ATTR INPUT (DISPLAY): mod inline_mod { }\n+PRINT-ATTR INPUT (DEBUG): TokenStream [\n+    Ident {\n+        ident: \"mod\",\n+        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+    },\n+    Ident {\n+        ident: \"inline_mod\",\n+        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+    },\n+    Group {\n+        delimiter: Brace,\n+        stream: TokenStream [],\n+        span: $DIR/inner-attrs.rs:24:1: 27:2 (#0),\n+    },\n+]\n+PRINT-DERIVE INPUT (DISPLAY): struct MyDerivePrint\n+{\n+    field :\n+    [u8 ;\n+     {\n+         match true\n+         { # ! [rustc_dummy(first)] # ! [rustc_dummy(second)] _ => { true } }\n+         ; 0\n+     }],\n+}\n+PRINT-DERIVE INPUT (DEBUG): TokenStream [\n+    Ident {\n+        ident: \"struct\",\n+        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+    },\n+    Ident {\n+        ident: \"MyDerivePrint\",\n+        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+    },\n+    Group {\n+        delimiter: Brace,\n+        stream: TokenStream [\n+            Ident {\n+                ident: \"field\",\n+                span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+            },\n+            Punct {\n+                ch: ':',\n+                spacing: Alone,\n+                span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+            },\n+            Group {\n+                delimiter: Bracket,\n+                stream: TokenStream [\n+                    Ident {\n+                        ident: \"u8\",\n+                        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                    },\n+                    Punct {\n+                        ch: ';',\n+                        spacing: Alone,\n+                        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                    },\n+                    Group {\n+                        delimiter: Brace,\n+                        stream: TokenStream [\n+                            Ident {\n+                                ident: \"match\",\n+                                span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                            },\n+                            Ident {\n+                                ident: \"true\",\n+                                span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                            },\n+                            Group {\n+                                delimiter: Brace,\n+                                stream: TokenStream [\n+                                    Punct {\n+                                        ch: '#',\n+                                        spacing: Joint,\n+                                        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                                    },\n+                                    Punct {\n+                                        ch: '!',\n+                                        spacing: Alone,\n+                                        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                                    },\n+                                    Group {\n+                                        delimiter: Bracket,\n+                                        stream: TokenStream [\n+                                            Ident {\n+                                                ident: \"rustc_dummy\",\n+                                                span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                                            },\n+                                            Group {\n+                                                delimiter: Parenthesis,\n+                                                stream: TokenStream [\n+                                                    Ident {\n+                                                        ident: \"first\",\n+                                                        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                                                    },\n+                                                ],\n+                                                span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                                            },\n+                                        ],\n+                                        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                                    },\n+                                    Punct {\n+                                        ch: '#',\n+                                        spacing: Joint,\n+                                        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                                    },\n+                                    Punct {\n+                                        ch: '!',\n+                                        spacing: Alone,\n+                                        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                                    },\n+                                    Group {\n+                                        delimiter: Bracket,\n+                                        stream: TokenStream [\n+                                            Ident {\n+                                                ident: \"rustc_dummy\",\n+                                                span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                                            },\n+                                            Group {\n+                                                delimiter: Parenthesis,\n+                                                stream: TokenStream [\n+                                                    Ident {\n+                                                        ident: \"second\",\n+                                                        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                                                    },\n+                                                ],\n+                                                span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                                            },\n+                                        ],\n+                                        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                                    },\n+                                    Ident {\n+                                        ident: \"_\",\n+                                        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                                    },\n+                                    Punct {\n+                                        ch: '=',\n+                                        spacing: Joint,\n+                                        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                                    },\n+                                    Punct {\n+                                        ch: '>',\n+                                        spacing: Alone,\n+                                        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                                    },\n+                                    Group {\n+                                        delimiter: Brace,\n+                                        stream: TokenStream [\n+                                            Ident {\n+                                                ident: \"true\",\n+                                                span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                                            },\n+                                        ],\n+                                        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                                    },\n+                                ],\n+                                span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                            },\n+                            Punct {\n+                                ch: ';',\n+                                spacing: Alone,\n+                                span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                            },\n+                            Literal {\n+                                kind: Integer,\n+                                symbol: \"0\",\n+                                suffix: None,\n+                                span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                            },\n+                        ],\n+                        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+                    },\n+                ],\n+                span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+            },\n+            Punct {\n+                ch: ',',\n+                spacing: Alone,\n+                span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+            },\n+        ],\n+        span: $DIR/inner-attrs.rs:34:1: 46:2 (#0),\n+    },\n+]\n+PRINT-ATTR_ARGS INPUT (DISPLAY): tuple_attrs\n+PRINT-ATTR_ARGS INPUT (DEBUG): TokenStream [\n+    Ident {\n+        ident: \"tuple_attrs\",\n+        span: $DIR/inner-attrs.rs:52:29: 52:40 (#0),\n+    },\n+]\n+PRINT-ATTR INPUT (DISPLAY): (# ! [cfg_attr(FALSE, rustc_dummy)] 3, 4,\n+ { # ! [cfg_attr(not(FALSE), rustc_dummy(innermost))] 5 }) ;\n+PRINT-ATTR INPUT (DEBUG): TokenStream [\n+    Group {\n+        delimiter: Parenthesis,\n+        stream: TokenStream [\n+            Punct {\n+                ch: '#',\n+                spacing: Joint,\n+                span: $DIR/inner-attrs.rs:53:9: 53:10 (#0),\n+            },\n+            Punct {\n+                ch: '!',\n+                spacing: Alone,\n+                span: $DIR/inner-attrs.rs:53:10: 53:11 (#0),\n+            },\n+            Group {\n+                delimiter: Bracket,\n+                stream: TokenStream [\n+                    Ident {\n+                        ident: \"cfg_attr\",\n+                        span: $DIR/inner-attrs.rs:53:12: 53:20 (#0),\n+                    },\n+                    Group {\n+                        delimiter: Parenthesis,\n+                        stream: TokenStream [\n+                            Ident {\n+                                ident: \"FALSE\",\n+                                span: $DIR/inner-attrs.rs:53:21: 53:26 (#0),\n+                            },\n+                            Punct {\n+                                ch: ',',\n+                                spacing: Alone,\n+                                span: $DIR/inner-attrs.rs:53:26: 53:27 (#0),\n+                            },\n+                            Ident {\n+                                ident: \"rustc_dummy\",\n+                                span: $DIR/inner-attrs.rs:53:28: 53:39 (#0),\n+                            },\n+                        ],\n+                        span: $DIR/inner-attrs.rs:53:20: 53:40 (#0),\n+                    },\n+                ],\n+                span: $DIR/inner-attrs.rs:53:11: 53:41 (#0),\n+            },\n+            Literal {\n+                kind: Integer,\n+                symbol: \"3\",\n+                suffix: None,\n+                span: $DIR/inner-attrs.rs:54:9: 54:10 (#0),\n+            },\n+            Punct {\n+                ch: ',',\n+                spacing: Alone,\n+                span: $DIR/inner-attrs.rs:54:10: 54:11 (#0),\n+            },\n+            Literal {\n+                kind: Integer,\n+                symbol: \"4\",\n+                suffix: None,\n+                span: $DIR/inner-attrs.rs:54:12: 54:13 (#0),\n+            },\n+            Punct {\n+                ch: ',',\n+                spacing: Alone,\n+                span: $DIR/inner-attrs.rs:54:13: 54:14 (#0),\n+            },\n+            Group {\n+                delimiter: Brace,\n+                stream: TokenStream [\n+                    Punct {\n+                        ch: '#',\n+                        spacing: Joint,\n+                        span: $DIR/inner-attrs.rs:55:13: 55:14 (#0),\n+                    },\n+                    Punct {\n+                        ch: '!',\n+                        spacing: Alone,\n+                        span: $DIR/inner-attrs.rs:55:14: 55:15 (#0),\n+                    },\n+                    Group {\n+                        delimiter: Bracket,\n+                        stream: TokenStream [\n+                            Ident {\n+                                ident: \"cfg_attr\",\n+                                span: $DIR/inner-attrs.rs:55:16: 55:24 (#0),\n+                            },\n+                            Group {\n+                                delimiter: Parenthesis,\n+                                stream: TokenStream [\n+                                    Ident {\n+                                        ident: \"not\",\n+                                        span: $DIR/inner-attrs.rs:55:25: 55:28 (#0),\n+                                    },\n+                                    Group {\n+                                        delimiter: Parenthesis,\n+                                        stream: TokenStream [\n+                                            Ident {\n+                                                ident: \"FALSE\",\n+                                                span: $DIR/inner-attrs.rs:55:29: 55:34 (#0),\n+                                            },\n+                                        ],\n+                                        span: $DIR/inner-attrs.rs:55:28: 55:35 (#0),\n+                                    },\n+                                    Punct {\n+                                        ch: ',',\n+                                        spacing: Alone,\n+                                        span: $DIR/inner-attrs.rs:55:35: 55:36 (#0),\n+                                    },\n+                                    Ident {\n+                                        ident: \"rustc_dummy\",\n+                                        span: $DIR/inner-attrs.rs:55:37: 55:48 (#0),\n+                                    },\n+                                    Group {\n+                                        delimiter: Parenthesis,\n+                                        stream: TokenStream [\n+                                            Ident {\n+                                                ident: \"innermost\",\n+                                                span: $DIR/inner-attrs.rs:55:49: 55:58 (#0),\n+                                            },\n+                                        ],\n+                                        span: $DIR/inner-attrs.rs:55:48: 55:59 (#0),\n+                                    },\n+                                ],\n+                                span: $DIR/inner-attrs.rs:55:24: 55:60 (#0),\n+                            },\n+                        ],\n+                        span: $DIR/inner-attrs.rs:55:15: 55:61 (#0),\n+                    },\n+                    Literal {\n+                        kind: Integer,\n+                        symbol: \"5\",\n+                        suffix: None,\n+                        span: $DIR/inner-attrs.rs:56:13: 56:14 (#0),\n+                    },\n+                ],\n+                span: $DIR/inner-attrs.rs:54:15: 57:10 (#0),\n+            },\n+        ],\n+        span: $DIR/inner-attrs.rs:52:43: 58:6 (#0),\n+    },\n+    Punct {\n+        ch: ';',\n+        spacing: Alone,\n+        span: $DIR/inner-attrs.rs:58:6: 58:7 (#0),\n+    },\n+]\n+PRINT-ATTR_ARGS INPUT (DISPLAY): array_attrs\n+PRINT-ATTR_ARGS INPUT (DEBUG): TokenStream [\n+    Ident {\n+        ident: \"array_attrs\",\n+        span: $DIR/inner-attrs.rs:60:29: 60:40 (#0),\n+    },\n+]\n+PRINT-ATTR INPUT (DISPLAY): [# ! [rustc_dummy(inner)] true ; 0] ;\n+PRINT-ATTR INPUT (DEBUG): TokenStream [\n+    Group {\n+        delimiter: Bracket,\n+        stream: TokenStream [\n+            Punct {\n+                ch: '#',\n+                spacing: Joint,\n+                span: $DIR/inner-attrs.rs:60:43: 63:7 (#0),\n+            },\n+            Punct {\n+                ch: '!',\n+                spacing: Alone,\n+                span: $DIR/inner-attrs.rs:60:43: 63:7 (#0),\n+            },\n+            Group {\n+                delimiter: Bracket,\n+                stream: TokenStream [\n+                    Ident {\n+                        ident: \"rustc_dummy\",\n+                        span: $DIR/inner-attrs.rs:60:43: 63:7 (#0),\n+                    },\n+                    Group {\n+                        delimiter: Parenthesis,\n+                        stream: TokenStream [\n+                            Ident {\n+                                ident: \"inner\",\n+                                span: $DIR/inner-attrs.rs:60:43: 63:7 (#0),\n+                            },\n+                        ],\n+                        span: $DIR/inner-attrs.rs:60:43: 63:7 (#0),\n+                    },\n+                ],\n+                span: $DIR/inner-attrs.rs:60:43: 63:7 (#0),\n+            },\n+            Ident {\n+                ident: \"true\",\n+                span: $DIR/inner-attrs.rs:60:43: 63:7 (#0),\n+            },\n+            Punct {\n+                ch: ';',\n+                spacing: Alone,\n+                span: $DIR/inner-attrs.rs:60:43: 63:7 (#0),\n+            },\n+            Literal {\n+                kind: Integer,\n+                symbol: \"0\",\n+                suffix: None,\n+                span: $DIR/inner-attrs.rs:60:43: 63:7 (#0),\n+            },\n+        ],\n+        span: $DIR/inner-attrs.rs:60:43: 63:7 (#0),\n+    },\n+    Punct {\n+        ch: ';',\n+        spacing: Alone,\n+        span: $DIR/inner-attrs.rs:60:43: 63:7 (#0),\n+    },\n+]\n PRINT-ATTR_ARGS INPUT (DISPLAY): tuple_attrs\n PRINT-ATTR_ARGS INPUT (DEBUG): TokenStream [\n     Ident {\n         ident: \"tuple_attrs\",\n-        span: $DIR/inner-attrs.rs:30:29: 30:40 (#0),\n+        span: $DIR/inner-attrs.rs:65:29: 65:40 (#0),\n     },\n ]\n PRINT-ATTR INPUT (DISPLAY): (# ! [cfg_attr(FALSE, rustc_dummy)] 3, 4,\n@@ -306,149 +974,149 @@ PRINT-ATTR INPUT (DEBUG): TokenStream [\n             Punct {\n                 ch: '#',\n                 spacing: Joint,\n-                span: $DIR/inner-attrs.rs:31:9: 31:10 (#0),\n+                span: $DIR/inner-attrs.rs:66:9: 66:10 (#0),\n             },\n             Punct {\n                 ch: '!',\n                 spacing: Alone,\n-                span: $DIR/inner-attrs.rs:31:10: 31:11 (#0),\n+                span: $DIR/inner-attrs.rs:66:10: 66:11 (#0),\n             },\n             Group {\n                 delimiter: Bracket,\n                 stream: TokenStream [\n                     Ident {\n                         ident: \"cfg_attr\",\n-                        span: $DIR/inner-attrs.rs:31:12: 31:20 (#0),\n+                        span: $DIR/inner-attrs.rs:66:12: 66:20 (#0),\n                     },\n                     Group {\n                         delimiter: Parenthesis,\n                         stream: TokenStream [\n                             Ident {\n                                 ident: \"FALSE\",\n-                                span: $DIR/inner-attrs.rs:31:21: 31:26 (#0),\n+                                span: $DIR/inner-attrs.rs:66:21: 66:26 (#0),\n                             },\n                             Punct {\n                                 ch: ',',\n                                 spacing: Alone,\n-                                span: $DIR/inner-attrs.rs:31:26: 31:27 (#0),\n+                                span: $DIR/inner-attrs.rs:66:26: 66:27 (#0),\n                             },\n                             Ident {\n                                 ident: \"rustc_dummy\",\n-                                span: $DIR/inner-attrs.rs:31:28: 31:39 (#0),\n+                                span: $DIR/inner-attrs.rs:66:28: 66:39 (#0),\n                             },\n                         ],\n-                        span: $DIR/inner-attrs.rs:31:20: 31:40 (#0),\n+                        span: $DIR/inner-attrs.rs:66:20: 66:40 (#0),\n                     },\n                 ],\n-                span: $DIR/inner-attrs.rs:31:11: 31:41 (#0),\n+                span: $DIR/inner-attrs.rs:66:11: 66:41 (#0),\n             },\n             Literal {\n                 kind: Integer,\n                 symbol: \"3\",\n                 suffix: None,\n-                span: $DIR/inner-attrs.rs:32:9: 32:10 (#0),\n+                span: $DIR/inner-attrs.rs:67:9: 67:10 (#0),\n             },\n             Punct {\n                 ch: ',',\n                 spacing: Alone,\n-                span: $DIR/inner-attrs.rs:32:10: 32:11 (#0),\n+                span: $DIR/inner-attrs.rs:67:10: 67:11 (#0),\n             },\n             Literal {\n                 kind: Integer,\n                 symbol: \"4\",\n                 suffix: None,\n-                span: $DIR/inner-attrs.rs:32:12: 32:13 (#0),\n+                span: $DIR/inner-attrs.rs:67:12: 67:13 (#0),\n             },\n             Punct {\n                 ch: ',',\n                 spacing: Alone,\n-                span: $DIR/inner-attrs.rs:32:13: 32:14 (#0),\n+                span: $DIR/inner-attrs.rs:67:13: 67:14 (#0),\n             },\n             Group {\n                 delimiter: Brace,\n                 stream: TokenStream [\n                     Punct {\n                         ch: '#',\n                         spacing: Joint,\n-                        span: $DIR/inner-attrs.rs:33:13: 33:14 (#0),\n+                        span: $DIR/inner-attrs.rs:68:13: 68:14 (#0),\n                     },\n                     Punct {\n                         ch: '!',\n                         spacing: Alone,\n-                        span: $DIR/inner-attrs.rs:33:14: 33:15 (#0),\n+                        span: $DIR/inner-attrs.rs:68:14: 68:15 (#0),\n                     },\n                     Group {\n                         delimiter: Bracket,\n                         stream: TokenStream [\n                             Ident {\n                                 ident: \"cfg_attr\",\n-                                span: $DIR/inner-attrs.rs:33:16: 33:24 (#0),\n+                                span: $DIR/inner-attrs.rs:68:16: 68:24 (#0),\n                             },\n                             Group {\n                                 delimiter: Parenthesis,\n                                 stream: TokenStream [\n                                     Ident {\n                                         ident: \"not\",\n-                                        span: $DIR/inner-attrs.rs:33:25: 33:28 (#0),\n+                                        span: $DIR/inner-attrs.rs:68:25: 68:28 (#0),\n                                     },\n                                     Group {\n                                         delimiter: Parenthesis,\n                                         stream: TokenStream [\n                                             Ident {\n                                                 ident: \"FALSE\",\n-                                                span: $DIR/inner-attrs.rs:33:29: 33:34 (#0),\n+                                                span: $DIR/inner-attrs.rs:68:29: 68:34 (#0),\n                                             },\n                                         ],\n-                                        span: $DIR/inner-attrs.rs:33:28: 33:35 (#0),\n+                                        span: $DIR/inner-attrs.rs:68:28: 68:35 (#0),\n                                     },\n                                     Punct {\n                                         ch: ',',\n                                         spacing: Alone,\n-                                        span: $DIR/inner-attrs.rs:33:35: 33:36 (#0),\n+                                        span: $DIR/inner-attrs.rs:68:35: 68:36 (#0),\n                                     },\n                                     Ident {\n                                         ident: \"rustc_dummy\",\n-                                        span: $DIR/inner-attrs.rs:33:37: 33:48 (#0),\n+                                        span: $DIR/inner-attrs.rs:68:37: 68:48 (#0),\n                                     },\n                                     Group {\n                                         delimiter: Parenthesis,\n                                         stream: TokenStream [\n                                             Ident {\n                                                 ident: \"innermost\",\n-                                                span: $DIR/inner-attrs.rs:33:49: 33:58 (#0),\n+                                                span: $DIR/inner-attrs.rs:68:49: 68:58 (#0),\n                                             },\n                                         ],\n-                                        span: $DIR/inner-attrs.rs:33:48: 33:59 (#0),\n+                                        span: $DIR/inner-attrs.rs:68:48: 68:59 (#0),\n                                     },\n                                 ],\n-                                span: $DIR/inner-attrs.rs:33:24: 33:60 (#0),\n+                                span: $DIR/inner-attrs.rs:68:24: 68:60 (#0),\n                             },\n                         ],\n-                        span: $DIR/inner-attrs.rs:33:15: 33:61 (#0),\n+                        span: $DIR/inner-attrs.rs:68:15: 68:61 (#0),\n                     },\n                     Literal {\n                         kind: Integer,\n                         symbol: \"5\",\n                         suffix: None,\n-                        span: $DIR/inner-attrs.rs:34:13: 34:14 (#0),\n+                        span: $DIR/inner-attrs.rs:69:13: 69:14 (#0),\n                     },\n                 ],\n-                span: $DIR/inner-attrs.rs:32:15: 35:10 (#0),\n+                span: $DIR/inner-attrs.rs:67:15: 70:10 (#0),\n             },\n         ],\n-        span: $DIR/inner-attrs.rs:30:43: 36:6 (#0),\n+        span: $DIR/inner-attrs.rs:65:43: 71:6 (#0),\n     },\n     Punct {\n         ch: ';',\n         spacing: Alone,\n-        span: $DIR/inner-attrs.rs:36:6: 36:7 (#0),\n+        span: $DIR/inner-attrs.rs:71:6: 71:7 (#0),\n     },\n ]\n PRINT-ATTR_ARGS INPUT (DISPLAY): array_attrs\n PRINT-ATTR_ARGS INPUT (DEBUG): TokenStream [\n     Ident {\n         ident: \"array_attrs\",\n-        span: $DIR/inner-attrs.rs:38:29: 38:40 (#0),\n+        span: $DIR/inner-attrs.rs:73:29: 73:40 (#0),\n     },\n ]\n PRINT-ATTR INPUT (DISPLAY): [# ! [rustc_dummy(inner)] true ; 0] ;\n@@ -459,82 +1127,82 @@ PRINT-ATTR INPUT (DEBUG): TokenStream [\n             Punct {\n                 ch: '#',\n                 spacing: Joint,\n-                span: $DIR/inner-attrs.rs:38:43: 41:7 (#0),\n+                span: $DIR/inner-attrs.rs:73:43: 76:7 (#0),\n             },\n             Punct {\n                 ch: '!',\n                 spacing: Alone,\n-                span: $DIR/inner-attrs.rs:38:43: 41:7 (#0),\n+                span: $DIR/inner-attrs.rs:73:43: 76:7 (#0),\n             },\n             Group {\n                 delimiter: Bracket,\n                 stream: TokenStream [\n                     Ident {\n                         ident: \"rustc_dummy\",\n-                        span: $DIR/inner-attrs.rs:38:43: 41:7 (#0),\n+                        span: $DIR/inner-attrs.rs:73:43: 76:7 (#0),\n                     },\n                     Group {\n                         delimiter: Parenthesis,\n                         stream: TokenStream [\n                             Ident {\n                                 ident: \"inner\",\n-                                span: $DIR/inner-attrs.rs:38:43: 41:7 (#0),\n+                                span: $DIR/inner-attrs.rs:73:43: 76:7 (#0),\n                             },\n                         ],\n-                        span: $DIR/inner-attrs.rs:38:43: 41:7 (#0),\n+                        span: $DIR/inner-attrs.rs:73:43: 76:7 (#0),\n                     },\n                 ],\n-                span: $DIR/inner-attrs.rs:38:43: 41:7 (#0),\n+                span: $DIR/inner-attrs.rs:73:43: 76:7 (#0),\n             },\n             Ident {\n                 ident: \"true\",\n-                span: $DIR/inner-attrs.rs:38:43: 41:7 (#0),\n+                span: $DIR/inner-attrs.rs:73:43: 76:7 (#0),\n             },\n             Punct {\n                 ch: ';',\n                 spacing: Alone,\n-                span: $DIR/inner-attrs.rs:38:43: 41:7 (#0),\n+                span: $DIR/inner-attrs.rs:73:43: 76:7 (#0),\n             },\n             Literal {\n                 kind: Integer,\n                 symbol: \"0\",\n                 suffix: None,\n-                span: $DIR/inner-attrs.rs:38:43: 41:7 (#0),\n+                span: $DIR/inner-attrs.rs:73:43: 76:7 (#0),\n             },\n         ],\n-        span: $DIR/inner-attrs.rs:38:43: 41:7 (#0),\n+        span: $DIR/inner-attrs.rs:73:43: 76:7 (#0),\n     },\n     Punct {\n         ch: ';',\n         spacing: Alone,\n-        span: $DIR/inner-attrs.rs:38:43: 41:7 (#0),\n+        span: $DIR/inner-attrs.rs:73:43: 76:7 (#0),\n     },\n ]\n PRINT-ATTR_ARGS INPUT (DISPLAY): tenth\n PRINT-ATTR_ARGS INPUT (DEBUG): TokenStream [\n     Ident {\n         ident: \"tenth\",\n-        span: $DIR/inner-attrs.rs:60:42: 60:47 (#0),\n+        span: $DIR/inner-attrs.rs:112:42: 112:47 (#0),\n     },\n ]\n PRINT-ATTR INPUT (DISPLAY): fn weird_extern() { }\n PRINT-ATTR INPUT (DEBUG): TokenStream [\n     Ident {\n         ident: \"fn\",\n-        span: $DIR/inner-attrs.rs:59:5: 61:6 (#0),\n+        span: $DIR/inner-attrs.rs:111:5: 113:6 (#0),\n     },\n     Ident {\n         ident: \"weird_extern\",\n-        span: $DIR/inner-attrs.rs:59:5: 61:6 (#0),\n+        span: $DIR/inner-attrs.rs:111:5: 113:6 (#0),\n     },\n     Group {\n         delimiter: Parenthesis,\n         stream: TokenStream [],\n-        span: $DIR/inner-attrs.rs:59:5: 61:6 (#0),\n+        span: $DIR/inner-attrs.rs:111:5: 113:6 (#0),\n     },\n     Group {\n         delimiter: Brace,\n         stream: TokenStream [],\n-        span: $DIR/inner-attrs.rs:59:5: 61:6 (#0),\n+        span: $DIR/inner-attrs.rs:111:5: 113:6 (#0),\n     },\n ]"}, {"sha": "79c4ad4cd2a249b2ebefe61a02137f964e5420c8", "filename": "src/test/ui/proc-macro/nonterminal-recollect-attr.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Fnonterminal-recollect-attr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Fnonterminal-recollect-attr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Fnonterminal-recollect-attr.rs?ref=a836d9b6413d9d593be6c09463ff8c4c70e56599", "patch": "@@ -1,6 +1,10 @@\n // check-pass\n+// compile-flags: -Z span-debug\n // aux-build:nonterminal-recollect-attr.rs\n \n+#![no_std] // Don't load unnecessary hygiene information from std\n+extern crate std;\n+\n extern crate nonterminal_recollect_attr;\n use nonterminal_recollect_attr::*;\n "}, {"sha": "7331a25abd328bf208a3a83613e51105754708eb", "filename": "src/test/ui/proc-macro/nonterminal-recollect-attr.stdout", "status": "added", "additions": 72, "deletions": 0, "changes": 72, "blob_url": "https://github.com/rust-lang/rust/blob/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Fnonterminal-recollect-attr.stdout", "raw_url": "https://github.com/rust-lang/rust/raw/a836d9b6413d9d593be6c09463ff8c4c70e56599/src%2Ftest%2Fui%2Fproc-macro%2Fnonterminal-recollect-attr.stdout", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fproc-macro%2Fnonterminal-recollect-attr.stdout?ref=a836d9b6413d9d593be6c09463ff8c4c70e56599", "patch": "@@ -0,0 +1,72 @@\n+First recollected: TokenStream [\n+    Group {\n+        delimiter: None,\n+        stream: TokenStream [\n+            Ident {\n+                ident: \"pub\",\n+                span: $DIR/nonterminal-recollect-attr.rs:20:11: 20:14 (#0),\n+            },\n+        ],\n+        span: $DIR/nonterminal-recollect-attr.rs:14:9: 14:11 (#4),\n+    },\n+    Ident {\n+        ident: \"struct\",\n+        span: $DIR/nonterminal-recollect-attr.rs:14:12: 14:18 (#4),\n+    },\n+    Ident {\n+        ident: \"Foo\",\n+        span: $DIR/nonterminal-recollect-attr.rs:14:19: 14:22 (#4),\n+    },\n+    Group {\n+        delimiter: Brace,\n+        stream: TokenStream [\n+            Ident {\n+                ident: \"field\",\n+                span: $DIR/nonterminal-recollect-attr.rs:15:13: 15:18 (#4),\n+            },\n+            Punct {\n+                ch: ':',\n+                spacing: Alone,\n+                span: $DIR/nonterminal-recollect-attr.rs:15:18: 15:19 (#4),\n+            },\n+            Ident {\n+                ident: \"u8\",\n+                span: $DIR/nonterminal-recollect-attr.rs:15:20: 15:22 (#4),\n+            },\n+        ],\n+        span: $DIR/nonterminal-recollect-attr.rs:14:23: 16:10 (#4),\n+    },\n+]\n+Second recollected: TokenStream [\n+    Ident {\n+        ident: \"pub\",\n+        span: $DIR/nonterminal-recollect-attr.rs:20:11: 20:14 (#0),\n+    },\n+    Ident {\n+        ident: \"struct\",\n+        span: $DIR/nonterminal-recollect-attr.rs:14:12: 14:18 (#4),\n+    },\n+    Ident {\n+        ident: \"Foo\",\n+        span: $DIR/nonterminal-recollect-attr.rs:14:19: 14:22 (#4),\n+    },\n+    Group {\n+        delimiter: Brace,\n+        stream: TokenStream [\n+            Ident {\n+                ident: \"field\",\n+                span: $DIR/nonterminal-recollect-attr.rs:15:13: 15:18 (#4),\n+            },\n+            Punct {\n+                ch: ':',\n+                spacing: Alone,\n+                span: $DIR/nonterminal-recollect-attr.rs:15:18: 15:19 (#4),\n+            },\n+            Ident {\n+                ident: \"u8\",\n+                span: $DIR/nonterminal-recollect-attr.rs:15:20: 15:22 (#4),\n+            },\n+        ],\n+        span: $DIR/nonterminal-recollect-attr.rs:14:23: 16:10 (#4),\n+    },\n+]"}]}