{"sha": "be121c93ffc443a82735321edd793ef1e3ee3a00", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJlMTIxYzkzZmZjNDQzYTgyNzM1MzIxZWRkNzkzZWYxZTNlZTNhMDA=", "commit": {"author": {"name": "miguel raz", "email": "miguelraz@gmail.com", "date": "2021-06-04T15:54:08Z"}, "committer": {"name": "miguel raz", "email": "miguelraz@gmail.com", "date": "2021-06-04T15:54:08Z"}, "message": "clean code vis. Jubilee's comments", "tree": {"sha": "ef79c948972d03b5ef7e5c6716a4368f2c9049f0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ef79c948972d03b5ef7e5c6716a4368f2c9049f0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/be121c93ffc443a82735321edd793ef1e3ee3a00", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/be121c93ffc443a82735321edd793ef1e3ee3a00", "html_url": "https://github.com/rust-lang/rust/commit/be121c93ffc443a82735321edd793ef1e3ee3a00", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/be121c93ffc443a82735321edd793ef1e3ee3a00/comments", "author": {"login": "miguelraz", "id": 13056181, "node_id": "MDQ6VXNlcjEzMDU2MTgx", "avatar_url": "https://avatars.githubusercontent.com/u/13056181?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miguelraz", "html_url": "https://github.com/miguelraz", "followers_url": "https://api.github.com/users/miguelraz/followers", "following_url": "https://api.github.com/users/miguelraz/following{/other_user}", "gists_url": "https://api.github.com/users/miguelraz/gists{/gist_id}", "starred_url": "https://api.github.com/users/miguelraz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miguelraz/subscriptions", "organizations_url": "https://api.github.com/users/miguelraz/orgs", "repos_url": "https://api.github.com/users/miguelraz/repos", "events_url": "https://api.github.com/users/miguelraz/events{/privacy}", "received_events_url": "https://api.github.com/users/miguelraz/received_events", "type": "User", "site_admin": false}, "committer": {"login": "miguelraz", "id": 13056181, "node_id": "MDQ6VXNlcjEzMDU2MTgx", "avatar_url": "https://avatars.githubusercontent.com/u/13056181?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miguelraz", "html_url": "https://github.com/miguelraz", "followers_url": "https://api.github.com/users/miguelraz/followers", "following_url": "https://api.github.com/users/miguelraz/following{/other_user}", "gists_url": "https://api.github.com/users/miguelraz/gists{/gist_id}", "starred_url": "https://api.github.com/users/miguelraz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miguelraz/subscriptions", "organizations_url": "https://api.github.com/users/miguelraz/orgs", "repos_url": "https://api.github.com/users/miguelraz/repos", "events_url": "https://api.github.com/users/miguelraz/events{/privacy}", "received_events_url": "https://api.github.com/users/miguelraz/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "435d1cf7a6985696291048e3b5f2bf7e1b63aa32", "url": "https://api.github.com/repos/rust-lang/rust/commits/435d1cf7a6985696291048e3b5f2bf7e1b63aa32", "html_url": "https://github.com/rust-lang/rust/commit/435d1cf7a6985696291048e3b5f2bf7e1b63aa32"}], "stats": {"total": 18, "additions": 7, "deletions": 11}, "files": [{"sha": "44e1c6e87d0e3f15d948e63c3ab9a88668e50df2", "filename": "crates/core_simd/examples/nbody.rs", "status": "modified", "additions": 7, "deletions": 11, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/be121c93ffc443a82735321edd793ef1e3ee3a00/crates%2Fcore_simd%2Fexamples%2Fnbody.rs", "raw_url": "https://github.com/rust-lang/rust/raw/be121c93ffc443a82735321edd793ef1e3ee3a00/crates%2Fcore_simd%2Fexamples%2Fnbody.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fcore_simd%2Fexamples%2Fnbody.rs?ref=be121c93ffc443a82735321edd793ef1e3ee3a00", "patch": "@@ -126,19 +126,17 @@ pub fn advance(bodies: &mut [Body; N_BODIES], dt: f64) {\n     }\n \n     let mut mag = [0.0; N];\n-    let mut i = 0;\n-    while i < N {\n+    for i in (0..N).step_by(2) {\n         let d2s = f64x2::from_array([\n             (r[i] * r[i]).horizontal_sum(),\n             (r[i + 1] * r[i + 1]).horizontal_sum(),\n         ]);\n         let dmags = f64x2::splat(dt) / (d2s * d2s.sqrt());\n         mag[i] = dmags[0];\n         mag[i + 1] = dmags[1];\n-        i += 2;\n     }\n \n-    i = 0;\n+    let mut i = 0;\n     for j in 0..N_BODIES {\n         for k in j + 1..N_BODIES {\n             let f = r[i] * mag[i];\n@@ -164,23 +162,21 @@ pub fn run(n: usize) -> (f64, f64) {\n     (energy_before, energy_after)\n }\n \n-// Good enough for demonstration purposes, not going for strictness here.\n-fn approx_eq_f64(a: f64, b: f64) -> bool {\n-    (a - b).abs() < 0.00001\n-}\n-\n #[cfg(test)]\n mod tests {\n+    // Good enough for demonstration purposes, not going for strictness here.\n+    fn approx_eq_f64(a: f64, b: f64) -> bool {\n+        (a - b).abs() < 0.00001\n+    }\n     #[test]\n     fn test() {\n-        use super::*;\n         const OUTPUT: [f64; 2] = [-0.169075164, -0.169087605];\n         let (energy_before, energy_after) = super::run(1000);\n         assert!(approx_eq_f64(energy_before, OUTPUT[0]));\n         assert!(approx_eq_f64(energy_after, OUTPUT[1]));\n     }\n }\n \n-fn main () {\n+fn main() {\n     // empty main to pass CI\n }"}]}