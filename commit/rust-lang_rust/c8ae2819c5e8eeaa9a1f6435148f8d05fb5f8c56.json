{"sha": "c8ae2819c5e8eeaa9a1f6435148f8d05fb5f8c56", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM4YWUyODE5YzVlOGVlYWE5YTFmNjQzNTE0OGY4ZDA1ZmI1ZjhjNTY=", "commit": {"author": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2019-11-04T21:09:02Z"}, "committer": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2019-11-04T22:19:51Z"}, "message": "Add tests for loop constructs in consts\n\nThese errors are suboptimal, but they will be fixed by the new\n`check_consts` pass.", "tree": {"sha": "49009232802f229dca9cd01ef7fbdb04cbcff026", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/49009232802f229dca9cd01ef7fbdb04cbcff026"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c8ae2819c5e8eeaa9a1f6435148f8d05fb5f8c56", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c8ae2819c5e8eeaa9a1f6435148f8d05fb5f8c56", "html_url": "https://github.com/rust-lang/rust/commit/c8ae2819c5e8eeaa9a1f6435148f8d05fb5f8c56", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c8ae2819c5e8eeaa9a1f6435148f8d05fb5f8c56/comments", "author": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2477e2493e67527fc282c7239e019f7ebd513a1a", "url": "https://api.github.com/repos/rust-lang/rust/commits/2477e2493e67527fc282c7239e019f7ebd513a1a", "html_url": "https://github.com/rust-lang/rust/commit/2477e2493e67527fc282c7239e019f7ebd513a1a"}], "stats": {"total": 118, "additions": 118, "deletions": 0}, "files": [{"sha": "954f269d30e59e4ae1a281474081b3ab3e06d6c7", "filename": "src/test/ui/consts/const-loop.rs", "status": "added", "additions": 58, "deletions": 0, "changes": 58, "blob_url": "https://github.com/rust-lang/rust/blob/c8ae2819c5e8eeaa9a1f6435148f8d05fb5f8c56/src%2Ftest%2Fui%2Fconsts%2Fconst-loop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c8ae2819c5e8eeaa9a1f6435148f8d05fb5f8c56/src%2Ftest%2Fui%2Fconsts%2Fconst-loop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-loop.rs?ref=c8ae2819c5e8eeaa9a1f6435148f8d05fb5f8c56", "patch": "@@ -0,0 +1,58 @@\n+const _: i32 = {\n+    let mut x = 0;\n+\n+    while x < 4 {\n+        //~^ ERROR constant contains unimplemented expression type\n+        //~| ERROR constant contains unimplemented expression type\n+        x += 1;\n+    }\n+\n+    while x < 8 {\n+        x += 1;\n+    }\n+\n+    x\n+};\n+\n+const _: i32 = {\n+    let mut x = 0;\n+\n+    for i in 0..4 {\n+        //~^ ERROR constant contains unimplemented expression type\n+        //~| ERROR constant contains unimplemented expression type\n+        //~| ERROR references in constants may only refer to immutable values\n+        //~| ERROR calls in constants are limited to constant functions, tuple\n+        //         structs and tuple variants\n+        x += i;\n+    }\n+\n+    for i in 0..4 {\n+        x += i;\n+    }\n+\n+    x\n+};\n+\n+const _: i32 = {\n+    let mut x = 0;\n+\n+    loop {\n+        x += 1;\n+        if x == 4 {\n+            //~^ ERROR constant contains unimplemented expression type\n+            //~| ERROR constant contains unimplemented expression type\n+            break;\n+        }\n+    }\n+\n+    loop {\n+        x += 1;\n+        if x == 8 {\n+            break;\n+        }\n+    }\n+\n+    x\n+};\n+\n+fn main() {}"}, {"sha": "e6e4e2f5bb80881a88e0963b789fa7586791108f", "filename": "src/test/ui/consts/const-loop.stderr", "status": "added", "additions": 60, "deletions": 0, "changes": 60, "blob_url": "https://github.com/rust-lang/rust/blob/c8ae2819c5e8eeaa9a1f6435148f8d05fb5f8c56/src%2Ftest%2Fui%2Fconsts%2Fconst-loop.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/c8ae2819c5e8eeaa9a1f6435148f8d05fb5f8c56/src%2Ftest%2Fui%2Fconsts%2Fconst-loop.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-loop.stderr?ref=c8ae2819c5e8eeaa9a1f6435148f8d05fb5f8c56", "patch": "@@ -0,0 +1,60 @@\n+error[E0019]: constant contains unimplemented expression type\n+  --> $DIR/const-loop.rs:4:11\n+   |\n+LL |     while x < 4 {\n+   |           ^^^^^\n+\n+error[E0019]: constant contains unimplemented expression type\n+  --> $DIR/const-loop.rs:4:5\n+   |\n+LL | /     while x < 4 {\n+LL | |\n+LL | |\n+LL | |         x += 1;\n+LL | |     }\n+   | |_____^\n+\n+error[E0015]: calls in constants are limited to constant functions, tuple structs and tuple variants\n+  --> $DIR/const-loop.rs:20:14\n+   |\n+LL |     for i in 0..4 {\n+   |              ^^^^\n+\n+error[E0019]: constant contains unimplemented expression type\n+  --> $DIR/const-loop.rs:20:14\n+   |\n+LL |     for i in 0..4 {\n+   |              ^^^^\n+\n+error[E0017]: references in constants may only refer to immutable values\n+  --> $DIR/const-loop.rs:20:14\n+   |\n+LL |     for i in 0..4 {\n+   |              ^^^^ constants require immutable values\n+\n+error[E0019]: constant contains unimplemented expression type\n+  --> $DIR/const-loop.rs:20:9\n+   |\n+LL |     for i in 0..4 {\n+   |         ^\n+\n+error[E0019]: constant contains unimplemented expression type\n+  --> $DIR/const-loop.rs:41:12\n+   |\n+LL |         if x == 4 {\n+   |            ^^^^^^\n+\n+error[E0019]: constant contains unimplemented expression type\n+  --> $DIR/const-loop.rs:41:9\n+   |\n+LL | /         if x == 4 {\n+LL | |\n+LL | |\n+LL | |             break;\n+LL | |         }\n+   | |_________^\n+\n+error: aborting due to 8 previous errors\n+\n+Some errors have detailed explanations: E0015, E0017, E0019.\n+For more information about an error, try `rustc --explain E0015`."}]}