{"sha": "7e611366bb07f1c26cf5692bccfdfa4fb1d96d25", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdlNjExMzY2YmIwN2YxYzI2Y2Y1NjkyYmNjZmRmYTRmYjFkOTZkMjU=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-12-30T20:47:43Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-12-30T20:47:43Z"}, "message": "Make clean cleaner.", "tree": {"sha": "8984931c3ba03f3de50eb51d4ba7578465a12c27", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8984931c3ba03f3de50eb51d4ba7578465a12c27"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7e611366bb07f1c26cf5692bccfdfa4fb1d96d25", "comment_count": 1, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7e611366bb07f1c26cf5692bccfdfa4fb1d96d25", "html_url": "https://github.com/rust-lang/rust/commit/7e611366bb07f1c26cf5692bccfdfa4fb1d96d25", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7e611366bb07f1c26cf5692bccfdfa4fb1d96d25/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "aa5382bb13690ff183f6e94065dadf0524ce1c6e", "url": "https://api.github.com/repos/rust-lang/rust/commits/aa5382bb13690ff183f6e94065dadf0524ce1c6e", "html_url": "https://github.com/rust-lang/rust/commit/aa5382bb13690ff183f6e94065dadf0524ce1c6e"}], "stats": {"total": 43, "additions": 33, "deletions": 10}, "files": [{"sha": "6272609d84355e0b42f2ad41192837cac13f9751", "filename": "mk/clean.mk", "status": "modified", "additions": 22, "deletions": 8, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/7e611366bb07f1c26cf5692bccfdfa4fb1d96d25/mk%2Fclean.mk", "raw_url": "https://github.com/rust-lang/rust/raw/7e611366bb07f1c26cf5692bccfdfa4fb1d96d25/mk%2Fclean.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fclean.mk?ref=7e611366bb07f1c26cf5692bccfdfa4fb1d96d25", "patch": "@@ -29,24 +29,34 @@ clean-misc:\n \t$(Q)rm -f $(ML_DEPFILES:%.d=%.d.tmp)\n \t$(Q)rm -f $(C_DEPFILES:%.d=%.d.tmp)\n \t$(Q)rm -f $(CRATE_DEPFILES:%.d=%.d.tmp)\n-\t$(Q)rm -f $(GENERATED)\n+\t$(Q)rm -Rf $(DOCS)\n+\t$(Q)rm -Rf $(GENERATED)\n \t$(Q)rm -f rustllvm/$(CFG_RUSTLLVM) rustllvm/rustllvmbits.a\n \t$(Q)rm -f rt/$(CFG_RUNTIME)\n-\t$(Q)find rt -name '*.o' -delete\n-\t$(Q)find rt -name '*.a' -delete\n+\t$(Q)find rustllvm llvm rt -name '*.[odasS]' -delete\n+\t$(Q)find rustllvm llvm rt -name '*.so' -delete\n+\t$(Q)find rustllvm llvm rt -name '*.dylib' -delete\n+\t$(Q)find rustllvm llvm rt -name '*.dll' -delete\n+\t$(Q)find rustllvm rt -name '*.def' -delete\n+\t$(Q)rm -Rf $(wildcard rt/*/libuv/Default)\n \t$(Q)rm -f test/run_pass_stage2.rc test/run_pass_stage2_driver.rs\n \t$(Q)rm -Rf $(PKG_NAME)-*.tar.gz dist\n-\t$(Q)rm -f $(foreach ext,o a d bc s exe,$(wildcard stage*/*.$(ext)))\n \t$(Q)rm -Rf $(foreach ext,out out.tmp                      \\\n                              stage0$(X) stage1$(X) stage2$(X) \\\n-                             bc o s exe dSYM,                 \\\n+                             bc o s so dll exe dSYM,          \\\n                         $(wildcard test/*.$(ext) \\\n                                    test/*/*.$(ext) \\\n                                    test/bench/*/*.$(ext)))\n \t$(Q)rm -Rf $(foreach ext, \\\n-                 aux cp fn ky log pdf html pg toc tp vr cps, \\\n-                 $(wildcard doc/*.$(ext)))\n+                 css html js \\\n+                 aux cp fn ky log pdf pg toc tp vr cps, \\\n+                 $(wildcard doc/*.$(ext) \\\n+                            doc/*/*.$(ext) \\\n+                            doc/*/*/*.$(ext)))\n+\t$(Q)rm -Rf doc/keywords.texi\n \t$(Q)rm -Rf doc/version.texi\n+\t$(Q)rm -Rf $(foreach sub, index styles files search javascript, \\\n+                 $(wildcard doc/*/$(sub)))\n \t$(Q)rm -rf libuv\n \n define CLEAN_HOST_STAGE_N\n@@ -55,6 +65,7 @@ clean$(1)_H_$(2):\n \t$(Q)rm -f $$(HBIN$(1)_H_$(2))/rustc$(X)\n \t$(Q)rm -f $$(HBIN$(1)_H_$(2))/fuzzer$(X)\n \t$(Q)rm -f $$(HBIN$(1)_H_$(2))/cargo$(X)\n+\t$(Q)rm -f $$(HBIN$(1)_H_$(2))/rustdoc$(X)\n \t$(Q)rm -f $$(HLIB$(1)_H_$(2))/$(CFG_RUNTIME)\n \t$(Q)rm -f $$(HLIB$(1)_H_$(2))/$(CFG_CORELIB)\n \t$(Q)rm -f $$(HLIB$(1)_H_$(2))/$(CFG_STDLIB)\n@@ -76,6 +87,8 @@ define CLEAN_TARGET_STAGE_N\n clean$(1)_T_$(2)_H_$(3):\n \t$(Q)rm -f $$(TBIN$(1)_T_$(2)_H_$(3))/rustc$(X)\n \t$(Q)rm -f $$(TBIN$(1)_T_$(2)_H_$(3))/fuzzer$(X)\n+\t$(Q)rm -f $$(TBIN$(1)_T_$(2)_H_$(3))/cargo$(X)\n+\t$(Q)rm -f $$(TBIN$(1)_T_$(2)_H_$(3))/rustdoc$(X)\n \t$(Q)rm -f $$(TLIB$(1)_T_$(2)_H_$(3))/$(CFG_RUNTIME)\n \t$(Q)rm -f $$(TLIB$(1)_T_$(2)_H_$(3))/$(CFG_CORELIB)\n \t$(Q)rm -f $$(TLIB$(1)_T_$(2)_H_$(3))/$(CFG_STDLIB)\n@@ -86,7 +99,8 @@ clean$(1)_T_$(2)_H_$(3):\n \t$(Q)rm -f $$(TLIB$(1)_T_$(2)_H_$(3))/$(CFG_RUSTLLVM)\n \t$(Q)rm -f $$(TLIB$(1)_T_$(2)_H_$(3))/libstd.rlib\n \t$(Q)rm -f $$(TLIB$(1)_T_$(2)_H_$(3))/intrinsics.bc\n-\n+\t$(Q)rm -f $$(TLIB$(1)_T_$(2)_H_$(3))/intrinsics.ll\n+\t$(Q)rm -f $$(TLIB$(1)_T_$(2)_H_$(3))/libmorestack.a\n endef\n \n $(foreach host, $(CFG_TARGET_TRIPLES), \\"}, {"sha": "b90de8d26b2766bd9251fb297ed21b8a798c3a8c", "filename": "mk/docs.mk", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/7e611366bb07f1c26cf5692bccfdfa4fb1d96d25/mk%2Fdocs.mk", "raw_url": "https://github.com/rust-lang/rust/raw/7e611366bb07f1c26cf5692bccfdfa4fb1d96d25/mk%2Fdocs.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fdocs.mk?ref=7e611366bb07f1c26cf5692bccfdfa4fb1d96d25", "patch": "@@ -2,8 +2,6 @@\n # Doc variables and rules\n ######################################################################\n \n-docs: $(DOCS)\n-\n doc/keywords.texi: $(S)doc/keywords.txt $(S)src/etc/gen-keywords-table.py\n \t@$(call E, gen-keywords-table: $@)\n \t$(Q)$(S)src/etc/gen-keywords-table.py\n@@ -14,6 +12,8 @@ doc/version.texi: $(MKFILE_DEPS) rust.texi\n \t$(Q)echo \"$(CFG_VERSION)\" >>$@\n \t$(Q)echo \"@end macro\" >>$@\n \n+GENERATED += doc/keywords.texi doc/version.texi\n+\n doc/%.pdf: %.texi doc/version.texi doc/keywords.texi\n \t@$(call E, texi2pdf: $@)\n \t@# LC_COLLATE=C works around a bug in texi2dvi; see\n@@ -47,7 +47,16 @@ nd/$(1)/lib.css: $(S)doc/lib.css\n \t@$$(call E, cp: $$@)\n \t$(Q)cp $$< $$@\n \n+GENERATED += nd/$(1)/Languages.txt \\\n+             nd/$(1)/Topics.txt \\\n+             nd/$(1)/Menu.txt \\\n+             nd/$(1)/Data\n+\n+DOCS += nd/$(1)/index.html nd/$(1)/lib.css\n+\n endef\n \n $(eval $(call libdoc,core,$(CORELIB_CRATE) $(CORELIB_INPUTS)))\n $(eval $(call libdoc,std,$(STDLIB_CRATE) $(STDLIB_INPUTS)))\n+\n+docs: $(DOCS)"}]}