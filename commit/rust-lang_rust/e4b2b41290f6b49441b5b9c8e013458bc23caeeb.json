{"sha": "e4b2b41290f6b49441b5b9c8e013458bc23caeeb", "node_id": "C_kwDOAAsO6NoAKGU0YjJiNDEyOTBmNmI0OTQ0MWI1YjljOGUwMTM0NThiYzIzY2FlZWI", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-06-22T18:49:26Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2022-06-22T22:22:25Z"}, "message": "Merge all popover hide functions into one", "tree": {"sha": "666b7621ece0e29ab0c6230467f7642bd12386f3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/666b7621ece0e29ab0c6230467f7642bd12386f3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e4b2b41290f6b49441b5b9c8e013458bc23caeeb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e4b2b41290f6b49441b5b9c8e013458bc23caeeb", "html_url": "https://github.com/rust-lang/rust/commit/e4b2b41290f6b49441b5b9c8e013458bc23caeeb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e4b2b41290f6b49441b5b9c8e013458bc23caeeb/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3eb9e1a7ae62ed074056928b7ae12ab5db713f07", "url": "https://api.github.com/repos/rust-lang/rust/commits/3eb9e1a7ae62ed074056928b7ae12ab5db713f07", "html_url": "https://github.com/rust-lang/rust/commit/3eb9e1a7ae62ed074056928b7ae12ab5db713f07"}], "stats": {"total": 45, "additions": 18, "deletions": 27}, "files": [{"sha": "70dbfd444254070184ee241350caeaf3ce7b83bb", "filename": "src/librustdoc/html/static/js/main.js", "status": "modified", "additions": 13, "deletions": 20, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/e4b2b41290f6b49441b5b9c8e013458bc23caeeb/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/e4b2b41290f6b49441b5b9c8e013458bc23caeeb/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fmain.js?ref=e4b2b41290f6b49441b5b9c8e013458bc23caeeb", "patch": "@@ -137,10 +137,6 @@ function getNakedUrl() {\n     return window.location.href.split(\"?\")[0].split(\"#\")[0];\n }\n \n-window.hideSettings = () => {\n-    // Does nothing by default.\n-};\n-\n /**\n  * This function inserts `newNode` after `referenceNode`. It doesn't work if `referenceNode`\n  * doesn't have a parent node.\n@@ -413,8 +409,7 @@ function loadCss(cssFileName) {\n         }\n         ev.preventDefault();\n         searchState.defocus();\n-        window.hideSettings();\n-        hideHelp();\n+        window.hidePopoverMenus();\n     }\n \n     const disableShortcuts = getSettingValue(\"disable-shortcuts\") === \"true\";\n@@ -824,7 +819,7 @@ function loadCss(cssFileName) {\n     }\n \n     function helpBlurHandler(event) {\n-        blurHandler(event, getHelpButton(), hideHelp);\n+        blurHandler(event, getHelpButton(), window.hidePopoverMenus);\n     }\n \n     function buildHelpMenu() {\n@@ -900,6 +895,15 @@ function loadCss(cssFileName) {\n         return container;\n     }\n \n+    /**\n+     * Hide all the popover menus.\n+     */\n+    window.hidePopoverMenus = function() {\n+        onEachLazy(document.querySelectorAll(\".search-container .popover\"), elem => {\n+            elem.style.display = \"none\";\n+        });\n+    };\n+\n     /**\n      * Returns the help menu element (not the button).\n      *\n@@ -926,25 +930,14 @@ function loadCss(cssFileName) {\n         }\n     }\n \n-    /**\n-     * Hide the help popup menu.\n-     */\n-    function hideHelp() {\n-        const menu = getHelpMenu(false);\n-        if (menu && menu.style.display !== \"none\") {\n-            menu.style.display = \"none\";\n-        }\n-    }\n-\n     document.querySelector(`#${HELP_BUTTON_ID} > button`).addEventListener(\"click\", event => {\n         const target = event.target;\n         if (target.tagName !== \"BUTTON\" || target.parentElement.id !== HELP_BUTTON_ID) {\n             return;\n         }\n         const menu = getHelpMenu(true);\n-        if (menu.style.display !== \"none\") {\n-            hideHelp();\n-        } else {\n+        const shouldShowHelp = menu.style.display === \"none\";\n+        if (shouldShowHelp) {\n             showHelp();\n         }\n     });"}, {"sha": "797b931afc643b82d7b5744df52275d5ed9fcff2", "filename": "src/librustdoc/html/static/js/settings.js", "status": "modified", "additions": 5, "deletions": 7, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/e4b2b41290f6b49441b5b9c8e013458bc23caeeb/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js", "raw_url": "https://github.com/rust-lang/rust/raw/e4b2b41290f6b49441b5b9c8e013458bc23caeeb/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsettings.js?ref=e4b2b41290f6b49441b5b9c8e013458bc23caeeb", "patch": "@@ -228,7 +228,7 @@\n     }\n \n     function settingsBlurHandler(event) {\n-        blurHandler(event, getSettingsButton(), window.hideSettings);\n+        blurHandler(event, getSettingsButton(), window.hidePopoverMenus);\n     }\n \n     if (isSettingsPage) {\n@@ -240,17 +240,15 @@\n         // We replace the existing \"onclick\" callback.\n         const settingsButton = getSettingsButton();\n         const settingsMenu = document.getElementById(\"settings\");\n-        window.hideSettings = function() {\n-            settingsMenu.style.display = \"none\";\n-        };\n         settingsButton.onclick = function(event) {\n             if (elemIsInParent(event.target, settingsMenu)) {\n                 return;\n             }\n             event.preventDefault();\n-            if (settingsMenu.style.display !== \"none\") {\n-                window.hideSettings();\n-            } else {\n+            const shouldDisplaySettings = settingsMenu.style.display === \"none\";\n+\n+            window.hidePopoverMenus();\n+            if (shouldDisplaySettings) {\n                 displaySettings();\n             }\n         };"}]}