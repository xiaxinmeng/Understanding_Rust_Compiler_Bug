{"sha": "ffff91a8e8d1b29164db89019429a712feca4a18", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZmZmY5MWE4ZThkMWIyOTE2NGRiODkwMTk0MjlhNzEyZmVjYTRhMTg=", "commit": {"author": {"name": "Nick Platt", "email": "platt.nicholas@gmail.com", "date": "2016-04-14T02:10:25Z"}, "committer": {"name": "Nick Platt", "email": "platt.nicholas@gmail.com", "date": "2016-04-14T02:10:25Z"}, "message": "rustbuild: Improve error messaging in bootstrap.py\n\nFor normal invocations, print a short error message and exit. When\nthe verbose option is enabled, also print the backtrace.", "tree": {"sha": "a17a47dace96879b6f1dba729f505592b46de225", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a17a47dace96879b6f1dba729f505592b46de225"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ffff91a8e8d1b29164db89019429a712feca4a18", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ffff91a8e8d1b29164db89019429a712feca4a18", "html_url": "https://github.com/rust-lang/rust/commit/ffff91a8e8d1b29164db89019429a712feca4a18", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ffff91a8e8d1b29164db89019429a712feca4a18/comments", "author": {"login": "caipre", "id": 295094, "node_id": "MDQ6VXNlcjI5NTA5NA==", "avatar_url": "https://avatars.githubusercontent.com/u/295094?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caipre", "html_url": "https://github.com/caipre", "followers_url": "https://api.github.com/users/caipre/followers", "following_url": "https://api.github.com/users/caipre/following{/other_user}", "gists_url": "https://api.github.com/users/caipre/gists{/gist_id}", "starred_url": "https://api.github.com/users/caipre/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caipre/subscriptions", "organizations_url": "https://api.github.com/users/caipre/orgs", "repos_url": "https://api.github.com/users/caipre/repos", "events_url": "https://api.github.com/users/caipre/events{/privacy}", "received_events_url": "https://api.github.com/users/caipre/received_events", "type": "User", "site_admin": false}, "committer": {"login": "caipre", "id": 295094, "node_id": "MDQ6VXNlcjI5NTA5NA==", "avatar_url": "https://avatars.githubusercontent.com/u/295094?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caipre", "html_url": "https://github.com/caipre", "followers_url": "https://api.github.com/users/caipre/followers", "following_url": "https://api.github.com/users/caipre/following{/other_user}", "gists_url": "https://api.github.com/users/caipre/gists{/gist_id}", "starred_url": "https://api.github.com/users/caipre/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caipre/subscriptions", "organizations_url": "https://api.github.com/users/caipre/orgs", "repos_url": "https://api.github.com/users/caipre/repos", "events_url": "https://api.github.com/users/caipre/events{/privacy}", "received_events_url": "https://api.github.com/users/caipre/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2b6020723115e77ebe94f228c0c9b977b9199c6e", "url": "https://api.github.com/repos/rust-lang/rust/commits/2b6020723115e77ebe94f228c0c9b977b9199c6e", "html_url": "https://github.com/rust-lang/rust/commit/2b6020723115e77ebe94f228c0c9b977b9199c6e"}], "stats": {"total": 22, "additions": 16, "deletions": 6}, "files": [{"sha": "5c50599fbf4bd1fccdf8a753cc54456fe22118d5", "filename": "src/bootstrap/bootstrap.py", "status": "modified", "additions": 16, "deletions": 6, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/ffff91a8e8d1b29164db89019429a712feca4a18/src%2Fbootstrap%2Fbootstrap.py", "raw_url": "https://github.com/rust-lang/rust/raw/ffff91a8e8d1b29164db89019429a712feca4a18/src%2Fbootstrap%2Fbootstrap.py", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fbootstrap.py?ref=ffff91a8e8d1b29164db89019429a712feca4a18", "patch": "@@ -57,9 +57,10 @@ def run(args, verbose=False):\n     ret = subprocess.Popen(args)\n     code = ret.wait()\n     if code != 0:\n-        if not verbose:\n-            print(\"failed to run: \" + ' '.join(args))\n-        raise RuntimeError(\"failed to run command\")\n+        err = \"failed to run: \" + ' '.join(args)\n+        if verbose:\n+            raise RuntimeError(err)\n+        sys.exit(err)\n \n class RustBuild:\n     def download_rust_nightly(self):\n@@ -210,7 +211,10 @@ def build_triple(self):\n             if sys.platform == 'win32':\n                 return 'x86_64-pc-windows-msvc'\n             else:\n-                raise\n+                err = \"uname not found\"\n+                if self.verbose:\n+                    raise Exception(err)\n+                sys.exit(err)\n \n         # Darwin's `uname -s` lies and always returns i386. We have to use\n         # sysctl instead.\n@@ -253,7 +257,10 @@ def build_triple(self):\n                 cputype = 'x86_64'\n             ostype = 'pc-windows-gnu'\n         else:\n-            raise ValueError(\"unknown OS type: \" + ostype)\n+            err = \"unknown OS type: \" + ostype\n+            if self.verbose:\n+                raise ValueError(err)\n+            sys.exit(err)\n \n         if cputype in {'i386', 'i486', 'i686', 'i786', 'x86'}:\n             cputype = 'i686'\n@@ -269,7 +276,10 @@ def build_triple(self):\n         elif cputype in {'amd64', 'x86_64', 'x86-64', 'x64'}:\n             cputype = 'x86_64'\n         else:\n-            raise ValueError(\"unknown cpu type: \" + cputype)\n+            err = \"unknown cpu type: \" + cputype\n+            if self.verbose:\n+                raise ValueError(err)\n+            sys.exit(err)\n \n         return cputype + '-' + ostype\n "}]}