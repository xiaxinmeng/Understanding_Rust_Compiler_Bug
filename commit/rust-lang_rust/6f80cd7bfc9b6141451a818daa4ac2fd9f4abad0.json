{"sha": "6f80cd7bfc9b6141451a818daa4ac2fd9f4abad0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZmODBjZDdiZmM5YjYxNDE0NTFhODE4ZGFhNGFjMmZkOWY0YWJhZDA=", "commit": {"author": {"name": "Ian Douglas Scott", "email": "ian@iandouglasscott.com", "date": "2017-07-18T01:37:54Z"}, "committer": {"name": "Ian Douglas Scott", "email": "ian@iandouglasscott.com", "date": "2017-07-18T02:17:48Z"}, "message": "redox: handle multiple paths in PATH", "tree": {"sha": "2fc84acb6f6864a444dec7881b17e4dc5828af96", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2fc84acb6f6864a444dec7881b17e4dc5828af96"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6f80cd7bfc9b6141451a818daa4ac2fd9f4abad0", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCAAdFiEECYv1aaNg4jTOK4YaSSThDhmbWVkFAlltb84ACgkQSSThDhmb\nWVnKjggAg4uYWjZFjXXe27gSVZX3+6rKjTMuOUJyFxUKQ11efH+YRpA2FvLOzRkL\n2gPvcg+reQKbOnXsxeqhXzhUI02UQcMts2ateLgfvXxEAWuoXwmwXBou++gD6818\niM7qYRVwXiP3m+vi6BU+cXR0L/WtaFW7eHPDOdvKQCfUTIaJNAw34v7+wyqJmke0\nfRk3SCjD1WcszLTWUOL2NhBbEtZiVWkK8ORpAY+PJzG6++8QyFSrSYKUbN8U2M2t\nPy2u4k8GZRi2UD3wkBMfv5g2kC+TqL+WkiuIdXxxCCggWgXR7LygXduGomVflruw\nKIAXo1E0gjJLVYD0qNzBsXYqU6MZQw==\n=TFgK\n-----END PGP SIGNATURE-----", "payload": "tree 2fc84acb6f6864a444dec7881b17e4dc5828af96\nparent 2652ce6771b114189cdc1f9bd026a10af0a714e0\nauthor Ian Douglas Scott <ian@iandouglasscott.com> 1500341874 -0700\ncommitter Ian Douglas Scott <ian@iandouglasscott.com> 1500344268 -0700\n\nredox: handle multiple paths in PATH\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6f80cd7bfc9b6141451a818daa4ac2fd9f4abad0", "html_url": "https://github.com/rust-lang/rust/commit/6f80cd7bfc9b6141451a818daa4ac2fd9f4abad0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6f80cd7bfc9b6141451a818daa4ac2fd9f4abad0/comments", "author": {"login": "ids1024", "id": 2263150, "node_id": "MDQ6VXNlcjIyNjMxNTA=", "avatar_url": "https://avatars.githubusercontent.com/u/2263150?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ids1024", "html_url": "https://github.com/ids1024", "followers_url": "https://api.github.com/users/ids1024/followers", "following_url": "https://api.github.com/users/ids1024/following{/other_user}", "gists_url": "https://api.github.com/users/ids1024/gists{/gist_id}", "starred_url": "https://api.github.com/users/ids1024/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ids1024/subscriptions", "organizations_url": "https://api.github.com/users/ids1024/orgs", "repos_url": "https://api.github.com/users/ids1024/repos", "events_url": "https://api.github.com/users/ids1024/events{/privacy}", "received_events_url": "https://api.github.com/users/ids1024/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ids1024", "id": 2263150, "node_id": "MDQ6VXNlcjIyNjMxNTA=", "avatar_url": "https://avatars.githubusercontent.com/u/2263150?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ids1024", "html_url": "https://github.com/ids1024", "followers_url": "https://api.github.com/users/ids1024/followers", "following_url": "https://api.github.com/users/ids1024/following{/other_user}", "gists_url": "https://api.github.com/users/ids1024/gists{/gist_id}", "starred_url": "https://api.github.com/users/ids1024/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ids1024/subscriptions", "organizations_url": "https://api.github.com/users/ids1024/orgs", "repos_url": "https://api.github.com/users/ids1024/repos", "events_url": "https://api.github.com/users/ids1024/events{/privacy}", "received_events_url": "https://api.github.com/users/ids1024/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2652ce6771b114189cdc1f9bd026a10af0a714e0", "url": "https://api.github.com/repos/rust-lang/rust/commits/2652ce6771b114189cdc1f9bd026a10af0a714e0", "html_url": "https://github.com/rust-lang/rust/commit/2652ce6771b114189cdc1f9bd026a10af0a714e0"}], "stats": {"total": 49, "additions": 28, "deletions": 21}, "files": [{"sha": "efddd5f0294840afb40a94b8f627d5d23e4138e6", "filename": "src/libstd/sys/redox/os.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6f80cd7bfc9b6141451a818daa4ac2fd9f4abad0/src%2Flibstd%2Fsys%2Fredox%2Fos.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6f80cd7bfc9b6141451a818daa4ac2fd9f4abad0/src%2Flibstd%2Fsys%2Fredox%2Fos.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Fredox%2Fos.rs?ref=6f80cd7bfc9b6141451a818daa4ac2fd9f4abad0", "patch": "@@ -73,10 +73,10 @@ pub fn split_paths(unparsed: &OsStr) -> SplitPaths {\n     fn bytes_to_path(b: &[u8]) -> PathBuf {\n         PathBuf::from(<OsStr as OsStrExt>::from_bytes(b))\n     }\n-    fn is_colon(b: &u8) -> bool { *b == b':' }\n+    fn is_semicolon(b: &u8) -> bool { *b == b';' }\n     let unparsed = unparsed.as_bytes();\n     SplitPaths {\n-        iter: unparsed.split(is_colon as fn(&u8) -> bool)\n+        iter: unparsed.split(is_semicolon as fn(&u8) -> bool)\n                       .map(bytes_to_path as fn(&[u8]) -> PathBuf)\n     }\n }\n@@ -94,7 +94,7 @@ pub fn join_paths<I, T>(paths: I) -> Result<OsString, JoinPathsError>\n     where I: Iterator<Item=T>, T: AsRef<OsStr>\n {\n     let mut joined = Vec::new();\n-    let sep = b':';\n+    let sep = b';';\n \n     for (i, path) in paths.enumerate() {\n         let path = path.as_ref().as_bytes();"}, {"sha": "e7e66e57e13acd5b316972534b0adcb1c7a22513", "filename": "src/libstd/sys/redox/process.rs", "status": "modified", "additions": 22, "deletions": 15, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/6f80cd7bfc9b6141451a818daa4ac2fd9f4abad0/src%2Flibstd%2Fsys%2Fredox%2Fprocess.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6f80cd7bfc9b6141451a818daa4ac2fd9f4abad0/src%2Flibstd%2Fsys%2Fredox%2Fprocess.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Fredox%2Fprocess.rs?ref=6f80cd7bfc9b6141451a818daa4ac2fd9f4abad0", "patch": "@@ -9,11 +9,12 @@\n // except according to those terms.\n \n use collections::hash_map::HashMap;\n-use env;\n+use env::{self, split_paths};\n use ffi::OsStr;\n+use os::unix::ffi::OsStrExt;\n use fmt;\n use io::{self, Error, ErrorKind};\n-use path::Path;\n+use path::{Path, PathBuf};\n use sys::fd::FileDesc;\n use sys::fs::{File, OpenOptions};\n use sys::pipe::{self, AnonPipe};\n@@ -313,23 +314,29 @@ impl Command {\n         }\n \n         let program = if self.program.contains(':') || self.program.contains('/') {\n-            self.program.to_owned()\n-        } else {\n-            let mut path_env = ::env::var(\"PATH\").unwrap_or(\".\".to_string());\n-\n-            if ! path_env.ends_with('/') {\n-                path_env.push('/');\n+            Some(PathBuf::from(&self.program))\n+        } else if let Ok(path_env) = ::env::var(\"PATH\") {\n+            let mut program = None;\n+            for mut path in split_paths(&path_env) {\n+                path.push(&self.program);\n+                if path.exists() {\n+                    program = Some(path);\n+                    break;\n+                }\n             }\n-\n-            path_env.push_str(&self.program);\n-\n-            path_env\n+            program\n+        } else {\n+            None\n         };\n \n-        if let Err(err) = syscall::execve(&program, &args) {\n-            io::Error::from_raw_os_error(err.errno as i32)\n+        if let Some(program) = program {\n+            if let Err(err) = syscall::execve(program.as_os_str().as_bytes(), &args) {\n+                io::Error::from_raw_os_error(err.errno as i32)\n+            } else {\n+                panic!(\"return from exec without err\");\n+            }\n         } else {\n-            panic!(\"return from exec without err\");\n+            io::Error::new(io::ErrorKind::NotFound, \"\")\n         }\n     }\n "}, {"sha": "ec9005c2cc3be702981a2febe47b20fc5307fe18", "filename": "src/libstd/sys/redox/syscall/call.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6f80cd7bfc9b6141451a818daa4ac2fd9f4abad0/src%2Flibstd%2Fsys%2Fredox%2Fsyscall%2Fcall.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6f80cd7bfc9b6141451a818daa4ac2fd9f4abad0/src%2Flibstd%2Fsys%2Fredox%2Fsyscall%2Fcall.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fsys%2Fredox%2Fsyscall%2Fcall.rs?ref=6f80cd7bfc9b6141451a818daa4ac2fd9f4abad0", "patch": "@@ -77,9 +77,9 @@ pub fn dup2(fd: usize, newfd: usize, buf: &[u8]) -> Result<usize> {\n }\n \n /// Replace the current process with a new executable\n-pub fn execve(path: &str, args: &[[usize; 2]]) -> Result<usize> {\n-    unsafe { syscall4(SYS_EXECVE, path.as_ptr() as usize, path.len(),\n-                                  args.as_ptr() as usize, args.len()) }\n+pub fn execve<T: AsRef<[u8]>>(path: T, args: &[[usize; 2]]) -> Result<usize> {\n+    unsafe { syscall4(SYS_EXECVE, path.as_ref().as_ptr() as usize,\n+                      path.as_ref().len(), args.as_ptr() as usize, args.len()) }\n }\n \n /// Exit the current process"}]}