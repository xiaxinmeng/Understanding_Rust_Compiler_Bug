{"sha": "a85993ff69d5ba9a2cf07b0d1889b3ddf2e099e5", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE4NTk5M2ZmNjlkNWJhOWEyY2YwN2IwZDE4ODliM2RkZjJlMDk5ZTU=", "commit": {"author": {"name": "Tom Lee", "email": "github@tomlee.co", "date": "2013-05-25T18:09:33Z"}, "committer": {"name": "Tom Lee", "email": "github@tomlee.co", "date": "2013-05-28T00:13:01Z"}, "message": "Added _RUST_STAGEN guard to rust_call_tydesc_glue", "tree": {"sha": "8bb2a10b7a5169aecbd917b31669e54a3a8c828f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8bb2a10b7a5169aecbd917b31669e54a3a8c828f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a85993ff69d5ba9a2cf07b0d1889b3ddf2e099e5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a85993ff69d5ba9a2cf07b0d1889b3ddf2e099e5", "html_url": "https://github.com/rust-lang/rust/commit/a85993ff69d5ba9a2cf07b0d1889b3ddf2e099e5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a85993ff69d5ba9a2cf07b0d1889b3ddf2e099e5/comments", "author": {"login": "thomaslee", "id": 93216, "node_id": "MDQ6VXNlcjkzMjE2", "avatar_url": "https://avatars.githubusercontent.com/u/93216?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thomaslee", "html_url": "https://github.com/thomaslee", "followers_url": "https://api.github.com/users/thomaslee/followers", "following_url": "https://api.github.com/users/thomaslee/following{/other_user}", "gists_url": "https://api.github.com/users/thomaslee/gists{/gist_id}", "starred_url": "https://api.github.com/users/thomaslee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thomaslee/subscriptions", "organizations_url": "https://api.github.com/users/thomaslee/orgs", "repos_url": "https://api.github.com/users/thomaslee/repos", "events_url": "https://api.github.com/users/thomaslee/events{/privacy}", "received_events_url": "https://api.github.com/users/thomaslee/received_events", "type": "User", "site_admin": false}, "committer": {"login": "thomaslee", "id": 93216, "node_id": "MDQ6VXNlcjkzMjE2", "avatar_url": "https://avatars.githubusercontent.com/u/93216?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thomaslee", "html_url": "https://github.com/thomaslee", "followers_url": "https://api.github.com/users/thomaslee/followers", "following_url": "https://api.github.com/users/thomaslee/following{/other_user}", "gists_url": "https://api.github.com/users/thomaslee/gists{/gist_id}", "starred_url": "https://api.github.com/users/thomaslee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thomaslee/subscriptions", "organizations_url": "https://api.github.com/users/thomaslee/orgs", "repos_url": "https://api.github.com/users/thomaslee/repos", "events_url": "https://api.github.com/users/thomaslee/events{/privacy}", "received_events_url": "https://api.github.com/users/thomaslee/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cddd274e4defa86820a7a4218f6f55a440b2f82f", "url": "https://api.github.com/repos/rust-lang/rust/commits/cddd274e4defa86820a7a4218f6f55a440b2f82f", "html_url": "https://github.com/rust-lang/rust/commit/cddd274e4defa86820a7a4218f6f55a440b2f82f"}], "stats": {"total": 7, "additions": 7, "deletions": 0}, "files": [{"sha": "f173fa836a5a48eddb218e51e0f7811295123ecb", "filename": "src/rt/rust_builtin.cpp", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/a85993ff69d5ba9a2cf07b0d1889b3ddf2e099e5/src%2Frt%2Frust_builtin.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/a85993ff69d5ba9a2cf07b0d1889b3ddf2e099e5/src%2Frt%2Frust_builtin.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Frust_builtin.cpp?ref=a85993ff69d5ba9a2cf07b0d1889b3ddf2e099e5", "patch": "@@ -731,10 +731,17 @@ rust_task_deref(rust_task *task) {\n // Must call on rust stack.\n extern \"C\" CDECL void\n rust_call_tydesc_glue(void *root, size_t *tydesc, size_t glue_index) {\n+#ifdef _RUST_STAGE0\n+    void (*glue_fn)(void *, void *, void *, void *) =\n+        (void (*)(void *, void *, void *, void *))tydesc[glue_index];\n+    if (glue_fn)\n+        glue_fn(0, 0, 0, root);\n+#else\n     void (*glue_fn)(void *, void *, void *) =\n         (void (*)(void *, void *, void *))tydesc[glue_index];\n     if (glue_fn)\n         glue_fn(0, 0, root);\n+#endif\n }\n \n // Don't run on the Rust stack!"}]}