{"sha": "93373e13f0df27c7f887caacdcc02182925c5644", "node_id": "MDY6Q29tbWl0NzI0NzEyOjkzMzczZTEzZjBkZjI3YzdmODg3Y2FhY2RjYzAyMTgyOTI1YzU2NDQ=", "commit": {"author": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2021-02-21T09:56:25Z"}, "committer": {"name": "bjorn3", "email": "bjorn3@users.noreply.github.com", "date": "2021-02-21T09:56:25Z"}, "message": "Don't build alloc_system as part of the sysroot", "tree": {"sha": "41a59fd3054c258e99084b1986190b078733cb3f", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/41a59fd3054c258e99084b1986190b078733cb3f"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/93373e13f0df27c7f887caacdcc02182925c5644", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/93373e13f0df27c7f887caacdcc02182925c5644", "html_url": "https://github.com/rust-lang/rust/commit/93373e13f0df27c7f887caacdcc02182925c5644", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/93373e13f0df27c7f887caacdcc02182925c5644/comments", "author": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bjorn3", "id": 17426603, "node_id": "MDQ6VXNlcjE3NDI2NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/17426603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bjorn3", "html_url": "https://github.com/bjorn3", "followers_url": "https://api.github.com/users/bjorn3/followers", "following_url": "https://api.github.com/users/bjorn3/following{/other_user}", "gists_url": "https://api.github.com/users/bjorn3/gists{/gist_id}", "starred_url": "https://api.github.com/users/bjorn3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bjorn3/subscriptions", "organizations_url": "https://api.github.com/users/bjorn3/orgs", "repos_url": "https://api.github.com/users/bjorn3/repos", "events_url": "https://api.github.com/users/bjorn3/events{/privacy}", "received_events_url": "https://api.github.com/users/bjorn3/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b36fd9d82b645d67282eda2ca6bbcb09eca5163f", "url": "https://api.github.com/repos/rust-lang/rust/commits/b36fd9d82b645d67282eda2ca6bbcb09eca5163f", "html_url": "https://github.com/rust-lang/rust/commit/b36fd9d82b645d67282eda2ca6bbcb09eca5163f"}], "stats": {"total": 34, "additions": 5, "deletions": 29}, "files": [{"sha": "2bafe2c5269329e264be13b333203b1e9bb58018", "filename": "build_sysroot/Cargo.lock", "status": "modified", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/93373e13f0df27c7f887caacdcc02182925c5644/build_sysroot%2FCargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/93373e13f0df27c7f887caacdcc02182925c5644/build_sysroot%2FCargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/build_sysroot%2FCargo.lock?ref=93373e13f0df27c7f887caacdcc02182925c5644", "patch": "@@ -30,15 +30,6 @@ dependencies = [\n  \"core\",\n ]\n \n-[[package]]\n-name = \"alloc_system\"\n-version = \"0.0.0\"\n-dependencies = [\n- \"compiler_builtins\",\n- \"core\",\n- \"libc\",\n-]\n-\n [[package]]\n name = \"autocfg\"\n version = \"1.0.1\"\n@@ -258,7 +249,6 @@ name = \"sysroot\"\n version = \"0.0.0\"\n dependencies = [\n  \"alloc\",\n- \"alloc_system\",\n  \"compiler_builtins\",\n  \"core\",\n  \"std\","}, {"sha": "04748d5dbab5951df6ef16995fccdc0f13f2f809", "filename": "build_sysroot/Cargo.toml", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/93373e13f0df27c7f887caacdcc02182925c5644/build_sysroot%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/93373e13f0df27c7f887caacdcc02182925c5644/build_sysroot%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/build_sysroot%2FCargo.toml?ref=93373e13f0df27c7f887caacdcc02182925c5644", "patch": "@@ -9,8 +9,6 @@ alloc = { path = \"./sysroot_src/library/alloc\" }\n std = { path = \"./sysroot_src/library/std\", features = [\"panic_unwind\", \"backtrace\"] }\n test = { path = \"./sysroot_src/library/test\" }\n \n-alloc_system = { path = \"./alloc_system\" }\n-\n compiler_builtins = { version = \"0.1.39\", default-features = false, features = [\"no-asm\"] }\n \n [patch.crates-io]"}, {"sha": "09b13db772611106fed2de4757e0b055fafe4444", "filename": "build_sysroot/alloc_system/Cargo.toml", "status": "removed", "additions": 0, "deletions": 15, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/b36fd9d82b645d67282eda2ca6bbcb09eca5163f/build_sysroot%2Falloc_system%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/b36fd9d82b645d67282eda2ca6bbcb09eca5163f/build_sysroot%2Falloc_system%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/build_sysroot%2Falloc_system%2FCargo.toml?ref=b36fd9d82b645d67282eda2ca6bbcb09eca5163f", "patch": "@@ -1,15 +0,0 @@\n-[package]\n-authors = [\"The Rust Project Developers\", \"bjorn3 (edited to be usable outside the rust source)\"]\n-name = \"alloc_system\"\n-version = \"0.0.0\"\n-\n-[lib]\n-name = \"alloc_system\"\n-path = \"lib.rs\"\n-test = false\n-doc = false\n-\n-[dependencies]\n-core = { path = \"../sysroot_src/library/core\" }\n-libc = { version = \"0.2.43\", features = ['rustc-dep-of-std'], default-features = false }\n-compiler_builtins = \"0.1\""}, {"sha": "71e93e87b6c4135c4d180cedeac7be72f64fabe7", "filename": "example/alloc_example.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/93373e13f0df27c7f887caacdcc02182925c5644/example%2Falloc_example.rs", "raw_url": "https://github.com/rust-lang/rust/raw/93373e13f0df27c7f887caacdcc02182925c5644/example%2Falloc_example.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/example%2Falloc_example.rs?ref=93373e13f0df27c7f887caacdcc02182925c5644", "patch": "@@ -1,4 +1,4 @@\n-#![feature(start, box_syntax, alloc_system, core_intrinsics, alloc_prelude, alloc_error_handler)]\n+#![feature(start, box_syntax, core_intrinsics, alloc_prelude, alloc_error_handler)]\n #![no_std]\n \n extern crate alloc;"}, {"sha": "5f66ca67f2d409e9699c49a9fcda047c1e8c6ca9", "filename": "example/alloc_system.rs", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/93373e13f0df27c7f887caacdcc02182925c5644/example%2Falloc_system.rs", "raw_url": "https://github.com/rust-lang/rust/raw/93373e13f0df27c7f887caacdcc02182925c5644/example%2Falloc_system.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/example%2Falloc_system.rs?ref=93373e13f0df27c7f887caacdcc02182925c5644", "patch": "@@ -8,7 +8,7 @@\n // option. This file may not be copied, modified, or distributed\n // except according to those terms.\n #![no_std]\n-#![feature(allocator_api)]\n+#![feature(allocator_api, rustc_private)]\n #![cfg_attr(any(unix, target_os = \"redox\"), feature(libc))]\n \n // The minimum alignment guaranteed by the architecture. This value is used to", "previous_filename": "build_sysroot/alloc_system/lib.rs"}, {"sha": "321e0af553e5ad496dd40cb520a5c6fdec8ab7e0", "filename": "scripts/tests.sh", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/93373e13f0df27c7f887caacdcc02182925c5644/scripts%2Ftests.sh", "raw_url": "https://github.com/rust-lang/rust/raw/93373e13f0df27c7f887caacdcc02182925c5644/scripts%2Ftests.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/scripts%2Ftests.sh?ref=93373e13f0df27c7f887caacdcc02182925c5644", "patch": "@@ -34,6 +34,9 @@ function no_sysroot_tests() {\n }\n \n function base_sysroot_tests() {\n+    echo \"[AOT] alloc_system\"\n+    $MY_RUSTC example/alloc_system.rs --crate-type lib --target \"$TARGET_TRIPLE\"\n+\n     echo \"[AOT] alloc_example\"\n     $MY_RUSTC example/alloc_example.rs --crate-type bin --target \"$TARGET_TRIPLE\"\n     $RUN_WRAPPER ./target/out/alloc_example"}]}