{"sha": "31d383fcd2651d730187c0dc10bcc950473e48b5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjMxZDM4M2ZjZDI2NTFkNzMwMTg3YzBkYzEwYmNjOTUwNDczZTQ4YjU=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2015-12-08T13:56:22Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2015-12-08T13:56:22Z"}, "message": "Remove STARTUP_OBJS from Makefile deps for non win-gnu targets.\n\nThe `rsbegin.o` and `rsend.o` build products should not be generated\non non WinGnu platforms.\n\nThis is another path to resolving #30063 for non win-gnu targets.\n(And it won't require a snapshot, unlike PR #30208.)", "tree": {"sha": "877427c967272e76ae0a8aa655d3bdb9c578ecfa", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/877427c967272e76ae0a8aa655d3bdb9c578ecfa"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/31d383fcd2651d730187c0dc10bcc950473e48b5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/31d383fcd2651d730187c0dc10bcc950473e48b5", "html_url": "https://github.com/rust-lang/rust/commit/31d383fcd2651d730187c0dc10bcc950473e48b5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/31d383fcd2651d730187c0dc10bcc950473e48b5/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4dbdfb493357427a0f94ce09badef581f5d62bbd", "url": "https://api.github.com/repos/rust-lang/rust/commits/4dbdfb493357427a0f94ce09badef581f5d62bbd", "html_url": "https://github.com/rust-lang/rust/commit/4dbdfb493357427a0f94ce09badef581f5d62bbd"}], "stats": {"total": 4, "additions": 4, "deletions": 0}, "files": [{"sha": "3426b30aeeb85f9080d28f6f4dda698c8a11dd28", "filename": "mk/cfg/i686-pc-windows-gnu.mk", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/31d383fcd2651d730187c0dc10bcc950473e48b5/mk%2Fcfg%2Fi686-pc-windows-gnu.mk", "raw_url": "https://github.com/rust-lang/rust/raw/31d383fcd2651d730187c0dc10bcc950473e48b5/mk%2Fcfg%2Fi686-pc-windows-gnu.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fcfg%2Fi686-pc-windows-gnu.mk?ref=31d383fcd2651d730187c0dc10bcc950473e48b5", "patch": "@@ -24,3 +24,4 @@ CFG_RUN_TARG_i686-pc-windows-gnu=$(call CFG_RUN_i686-pc-windows-gnu,,$(2))\n CFG_GNU_TRIPLE_i686-pc-windows-gnu := i686-w64-mingw32\n CFG_THIRD_PARTY_OBJECTS_i686-pc-windows-gnu := crt2.o dllcrt2.o\n CFG_INSTALLED_OBJECTS_i686-pc-windows-gnu := crt2.o dllcrt2.o rsbegin.o rsend.o\n+CFG_RUSTRT_HAS_STARTUP_OBJS_i686-pc-windows-gnu := 1"}, {"sha": "f0732d08c71ea84c65b9c5e6140084bb69ac2aa2", "filename": "mk/cfg/x86_64-pc-windows-gnu.mk", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/31d383fcd2651d730187c0dc10bcc950473e48b5/mk%2Fcfg%2Fx86_64-pc-windows-gnu.mk", "raw_url": "https://github.com/rust-lang/rust/raw/31d383fcd2651d730187c0dc10bcc950473e48b5/mk%2Fcfg%2Fx86_64-pc-windows-gnu.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fcfg%2Fx86_64-pc-windows-gnu.mk?ref=31d383fcd2651d730187c0dc10bcc950473e48b5", "patch": "@@ -24,3 +24,4 @@ CFG_RUN_TARG_x86_64-pc-windows-gnu=$(call CFG_RUN_x86_64-pc-windows-gnu,,$(2))\n CFG_GNU_TRIPLE_x86_64-pc-windows-gnu := x86_64-w64-mingw32\n CFG_THIRD_PARTY_OBJECTS_x86_64-pc-windows-gnu := crt2.o dllcrt2.o\n CFG_INSTALLED_OBJECTS_x86_64-pc-windows-gnu := crt2.o dllcrt2.o rsbegin.o rsend.o\n+CFG_RUSTRT_HAS_STARTUP_OBJS_x86_64-pc-windows-gnu := 1"}, {"sha": "f1b5f9e315569a97d515ace943622d9a1eccd412", "filename": "mk/target.mk", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/31d383fcd2651d730187c0dc10bcc950473e48b5/mk%2Ftarget.mk", "raw_url": "https://github.com/rust-lang/rust/raw/31d383fcd2651d730187c0dc10bcc950473e48b5/mk%2Ftarget.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftarget.mk?ref=31d383fcd2651d730187c0dc10bcc950473e48b5", "patch": "@@ -152,12 +152,14 @@ $$(TLIB$(1)_T_$(2)_H_$(3))/$(4).o: \\\n \t@$$(call E, rustc: $$@)\n \t$$(STAGE$(1)_T_$(2)_H_$(3)) --emit=obj -o $$@ $$<\n \n+ifeq ($$(CFG_RUSTRT_HAS_STARTUP_OBJS_$(2)), 1)\n # Add dependencies on Rust startup objects to all crates that depend on core.\n # This ensures that they are built after core (since they depend on it),\n # but before everything else (since they are needed for linking dylib crates).\n $$(foreach crate, $$(TARGET_CRATES), \\\n \t$$(if $$(findstring core,$$(DEPS_$$(crate))), \\\n \t\t$$(TLIB$(1)_T_$(2)_H_$(3))/stamp.$$(crate))) : $$(TLIB$(1)_T_$(2)_H_$(3))/$(4).o\n+endif\n \n endef\n "}]}