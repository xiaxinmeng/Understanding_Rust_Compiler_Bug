{"sha": "77ef84e1e8a48ffa1a7d63e858e3d158bc1a8ecb", "node_id": "MDY6Q29tbWl0NzI0NzEyOjc3ZWY4NGUxZThhNDhmZmExYTdkNjNlODU4ZTNkMTU4YmMxYThlY2I=", "commit": {"author": {"name": "Oliver Scherer", "email": "github35764891676564198441@oli-obk.de", "date": "2018-12-17T09:12:04Z"}, "committer": {"name": "Oliver Scherer", "email": "github35764891676564198441@oli-obk.de", "date": "2018-12-17T09:12:04Z"}, "message": "Adjust tests for funciton pointer changes", "tree": {"sha": "50d21e64159a56de36c829875994e22052ad5217", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/50d21e64159a56de36c829875994e22052ad5217"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/77ef84e1e8a48ffa1a7d63e858e3d158bc1a8ecb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/77ef84e1e8a48ffa1a7d63e858e3d158bc1a8ecb", "html_url": "https://github.com/rust-lang/rust/commit/77ef84e1e8a48ffa1a7d63e858e3d158bc1a8ecb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/77ef84e1e8a48ffa1a7d63e858e3d158bc1a8ecb/comments", "author": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "96b2c347d74cef4b93ddb681fb3244b98ab883f1", "url": "https://api.github.com/repos/rust-lang/rust/commits/96b2c347d74cef4b93ddb681fb3244b98ab883f1", "html_url": "https://github.com/rust-lang/rust/commit/96b2c347d74cef4b93ddb681fb3244b98ab883f1"}], "stats": {"total": 14, "additions": 9, "deletions": 5}, "files": [{"sha": "6819a2af3ed8f9612d389853308010c5f4aa1271", "filename": "tests/run-pass/function_pointers.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/77ef84e1e8a48ffa1a7d63e858e3d158bc1a8ecb/tests%2Frun-pass%2Ffunction_pointers.rs", "raw_url": "https://github.com/rust-lang/rust/raw/77ef84e1e8a48ffa1a7d63e858e3d158bc1a8ecb/tests%2Frun-pass%2Ffunction_pointers.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Ffunction_pointers.rs?ref=77ef84e1e8a48ffa1a7d63e858e3d158bc1a8ecb", "patch": "@@ -10,12 +10,12 @@ fn h(i: i32, j: i32) -> i32 {\n     j * i * 7\n }\n \n-fn return_fn_ptr() -> fn() -> i32 {\n+fn return_fn_ptr(f: fn() -> i32) -> fn() -> i32 {\n     f\n }\n \n fn call_fn_ptr() -> i32 {\n-    return_fn_ptr()()\n+    return_fn_ptr(f)()\n }\n \n fn indirect<F: Fn() -> i32>(f: F) -> i32 { f() }\n@@ -41,6 +41,7 @@ fn main() {\n     assert_eq!(indirect3(h), 210);\n     assert_eq!(indirect_mut3(h), 210);\n     assert_eq!(indirect_once3(h), 210);\n-    assert!(return_fn_ptr() == f);\n-    assert!(return_fn_ptr() as unsafe fn() -> i32 == f as fn() -> i32 as unsafe fn() -> i32);\n+    let g = f as fn() -> i32;\n+    assert!(return_fn_ptr(g) == g);\n+    assert!(return_fn_ptr(g) as unsafe fn() -> i32 == g as fn() -> i32 as unsafe fn() -> i32);\n }"}, {"sha": "1dab492f9da3bfe4821e19cfc52a7fcf8f9e9d78", "filename": "tests/run-pass/mir_coercions.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/77ef84e1e8a48ffa1a7d63e858e3d158bc1a8ecb/tests%2Frun-pass%2Fmir_coercions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/77ef84e1e8a48ffa1a7d63e858e3d158bc1a8ecb/tests%2Frun-pass%2Fmir_coercions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frun-pass%2Fmir_coercions.rs?ref=77ef84e1e8a48ffa1a7d63e858e3d158bc1a8ecb", "patch": "@@ -60,7 +60,10 @@ fn main() {\n     let a = [0,1,2];\n     let square_local : fn(u32) -> u32 = square;\n     let (f,g) = fn_coercions(&square_local);\n-    assert_eq!(f as *const (), square as *const());\n+    // cannot use `square as *const ()` because we can't know whether the compiler duplicates\n+    // functions, so two function pointers are only equal if they result from the same function\n+    // to function pointer cast\n+    assert_eq!(f as *const (), square_local as *const());\n     assert_eq!(g(4), 16);\n     assert_eq!(identity_coercion(g)(5), 25);\n "}]}