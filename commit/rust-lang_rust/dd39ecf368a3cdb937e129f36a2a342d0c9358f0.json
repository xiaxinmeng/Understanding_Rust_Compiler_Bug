{"sha": "dd39ecf368a3cdb937e129f36a2a342d0c9358f0", "node_id": "MDY6Q29tbWl0NzI0NzEyOmRkMzllY2YzNjhhM2NkYjkzN2UxMjlmMzZhMmEzNDJkMGM5MzU4ZjA=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-08-17T10:58:12Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2017-08-17T10:58:12Z"}, "message": "Auto merge of #43902 - michaelwoerister:fix-mir-passes-promoted, r=arielb1\n\nRun MIR passes on promoted temporaries again.\n\nThis seems to have been broken some time in the past (maybe here: https://github.com/rust-lang/rust/commit/9c154a67bf5c6841c39afdb90388cc3ba36dc70c#diff-2f8e8805126c84b2be3f0967ffa0af28L162).\n\nr? @arielb1", "tree": {"sha": "f9747d948ca1eec3556058a2e85a569c2baaae03", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f9747d948ca1eec3556058a2e85a569c2baaae03"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/dd39ecf368a3cdb937e129f36a2a342d0c9358f0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/dd39ecf368a3cdb937e129f36a2a342d0c9358f0", "html_url": "https://github.com/rust-lang/rust/commit/dd39ecf368a3cdb937e129f36a2a342d0c9358f0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/dd39ecf368a3cdb937e129f36a2a342d0c9358f0/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a7e001833e3a40ddcccbc6f6764205162c83c027", "url": "https://api.github.com/repos/rust-lang/rust/commits/a7e001833e3a40ddcccbc6f6764205162c83c027", "html_url": "https://github.com/rust-lang/rust/commit/a7e001833e3a40ddcccbc6f6764205162c83c027"}, {"sha": "14d62c650faeca7df7a2c702b20820ef52924e89", "url": "https://api.github.com/repos/rust-lang/rust/commits/14d62c650faeca7df7a2c702b20820ef52924e89", "html_url": "https://github.com/rust-lang/rust/commit/14d62c650faeca7df7a2c702b20820ef52924e89"}], "stats": {"total": 8, "additions": 8, "deletions": 0}, "files": [{"sha": "25a156ea3fd97026347178ffb305a2e22f303f96", "filename": "src/librustc_mir/transform/mod.rs", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/dd39ecf368a3cdb937e129f36a2a342d0c9358f0/src%2Flibrustc_mir%2Ftransform%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/dd39ecf368a3cdb937e129f36a2a342d0c9358f0/src%2Flibrustc_mir%2Ftransform%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Ftransform%2Fmod.rs?ref=dd39ecf368a3cdb937e129f36a2a342d0c9358f0", "patch": "@@ -149,6 +149,14 @@ fn run_suite<'a, 'tcx>(tcx: TyCtxt<'a, 'tcx, 'tcx>,\n \n         pass.run_pass(tcx, source, mir);\n \n+        for (index, promoted_mir) in mir.promoted.iter_enumerated_mut() {\n+            let promoted_source = MirSource::Promoted(source.item_id(), index);\n+            pass.run_pass(tcx, promoted_source, promoted_mir);\n+\n+            // Let's make sure we don't miss any nested instances\n+            assert!(promoted_mir.promoted.is_empty());\n+        }\n+\n         for hook in tcx.mir_passes.hooks() {\n             hook.on_mir_pass(tcx, suite, pass_num, &pass.name(), source, &mir, true);\n         }"}]}