{"sha": "18ed1fa12933ff895980b55cf8b858aec8171b85", "node_id": "C_kwDOAAsO6NoAKDE4ZWQxZmExMjkzM2ZmODk1OTgwYjU1Y2Y4Yjg1OGFlYzgxNzFiODU", "commit": {"author": {"name": "klensy", "email": "klensy@users.noreply.github.com", "date": "2022-06-15T13:36:19Z"}, "committer": {"name": "klensy", "email": "klensy@users.noreply.github.com", "date": "2022-06-22T11:43:59Z"}, "message": "use `-Cstrip=debuginfo` with ui tests to reduce disk space usage", "tree": {"sha": "141cdc6519afeaafc600d327d46162d26ad8f20b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/141cdc6519afeaafc600d327d46162d26ad8f20b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/18ed1fa12933ff895980b55cf8b858aec8171b85", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/18ed1fa12933ff895980b55cf8b858aec8171b85", "html_url": "https://github.com/rust-lang/rust/commit/18ed1fa12933ff895980b55cf8b858aec8171b85", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/18ed1fa12933ff895980b55cf8b858aec8171b85/comments", "author": {"login": "klensy", "id": 1782831, "node_id": "MDQ6VXNlcjE3ODI4MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1782831?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klensy", "html_url": "https://github.com/klensy", "followers_url": "https://api.github.com/users/klensy/followers", "following_url": "https://api.github.com/users/klensy/following{/other_user}", "gists_url": "https://api.github.com/users/klensy/gists{/gist_id}", "starred_url": "https://api.github.com/users/klensy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klensy/subscriptions", "organizations_url": "https://api.github.com/users/klensy/orgs", "repos_url": "https://api.github.com/users/klensy/repos", "events_url": "https://api.github.com/users/klensy/events{/privacy}", "received_events_url": "https://api.github.com/users/klensy/received_events", "type": "User", "site_admin": false}, "committer": {"login": "klensy", "id": 1782831, "node_id": "MDQ6VXNlcjE3ODI4MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1782831?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klensy", "html_url": "https://github.com/klensy", "followers_url": "https://api.github.com/users/klensy/followers", "following_url": "https://api.github.com/users/klensy/following{/other_user}", "gists_url": "https://api.github.com/users/klensy/gists{/gist_id}", "starred_url": "https://api.github.com/users/klensy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klensy/subscriptions", "organizations_url": "https://api.github.com/users/klensy/orgs", "repos_url": "https://api.github.com/users/klensy/repos", "events_url": "https://api.github.com/users/klensy/events{/privacy}", "received_events_url": "https://api.github.com/users/klensy/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "89a0783f1c8fef46b1c8de57dc611a1d753bf0d5", "url": "https://api.github.com/repos/rust-lang/rust/commits/89a0783f1c8fef46b1c8de57dc611a1d753bf0d5", "html_url": "https://github.com/rust-lang/rust/commit/89a0783f1c8fef46b1c8de57dc611a1d753bf0d5"}], "stats": {"total": 24, "additions": 20, "deletions": 4}, "files": [{"sha": "d32ad11a122df215aab23727fd1899911016ad80", "filename": "src/test/ui/backtrace-apple-no-dsymutil.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fbacktrace-apple-no-dsymutil.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fbacktrace-apple-no-dsymutil.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fbacktrace-apple-no-dsymutil.rs?ref=18ed1fa12933ff895980b55cf8b858aec8171b85", "patch": "@@ -1,5 +1,6 @@\n // run-pass\n \n+// compile-flags:-Cstrip=none\n // compile-flags:-g -Csplit-debuginfo=unpacked\n // only-macos\n "}, {"sha": "05ccfcb5060cb9226c2127c565128164c57fbac3", "filename": "src/test/ui/backtrace.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fbacktrace.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fbacktrace.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fbacktrace.rs?ref=18ed1fa12933ff895980b55cf8b858aec8171b85", "patch": "@@ -5,6 +5,7 @@\n // ignore-sgx no processes\n // ignore-msvc see #62897 and `backtrace-debuginfo.rs` test\n // compile-flags:-g\n+// compile-flags:-Cstrip=none\n \n use std::env;\n use std::process::{Command, Stdio};"}, {"sha": "ba168f773d856c2fe4544955ad26f5daf504c10c", "filename": "src/test/ui/numbers-arithmetic/promoted_overflow.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fnumbers-arithmetic%2Fpromoted_overflow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fnumbers-arithmetic%2Fpromoted_overflow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnumbers-arithmetic%2Fpromoted_overflow.rs?ref=18ed1fa12933ff895980b55cf8b858aec8171b85", "patch": "@@ -3,6 +3,10 @@\n // run-fail\n // error-pattern: overflow\n // compile-flags: -C overflow-checks=yes\n+// for some reason, fails to match error string on\n+// wasm32-unknown-unknown with stripped debuginfo and symbols,\n+// so don't strip it\n+// compile-flags:-Cstrip=none\n \n fn main() {\n     let x: &'static u32 = &(0u32 - 1);"}, {"sha": "b6223b93764f4f7ff0fd8272dab8ce57c2b25f22", "filename": "src/test/ui/panics/issue-47429-short-backtraces.legacy.run.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fpanics%2Fissue-47429-short-backtraces.legacy.run.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fpanics%2Fissue-47429-short-backtraces.legacy.run.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpanics%2Fissue-47429-short-backtraces.legacy.run.stderr?ref=18ed1fa12933ff895980b55cf8b858aec8171b85", "patch": "@@ -1,4 +1,4 @@\n-thread 'main' panicked at 'explicit panic', $DIR/issue-47429-short-backtraces.rs:21:5\n+thread 'main' panicked at 'explicit panic', $DIR/issue-47429-short-backtraces.rs:22:5\n stack backtrace:\n    0: std::panicking::begin_panic\n    1: issue_47429_short_backtraces::main"}, {"sha": "f338ace6bb0d1c8dbe004b288ef2178f06292375", "filename": "src/test/ui/panics/issue-47429-short-backtraces.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fpanics%2Fissue-47429-short-backtraces.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fpanics%2Fissue-47429-short-backtraces.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpanics%2Fissue-47429-short-backtraces.rs?ref=18ed1fa12933ff895980b55cf8b858aec8171b85", "patch": "@@ -1,6 +1,7 @@\n // Regression test for #47429: short backtraces were not terminating correctly\n \n // compile-flags: -O\n+// compile-flags:-Cstrip=none\n // run-fail\n // check-run-results\n // exec-env:RUST_BACKTRACE=1"}, {"sha": "c2bea449249833c1952511cac63eae5dcb6e713c", "filename": "src/test/ui/panics/issue-47429-short-backtraces.v0.run.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fpanics%2Fissue-47429-short-backtraces.v0.run.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fpanics%2Fissue-47429-short-backtraces.v0.run.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpanics%2Fissue-47429-short-backtraces.v0.run.stderr?ref=18ed1fa12933ff895980b55cf8b858aec8171b85", "patch": "@@ -1,4 +1,4 @@\n-thread 'main' panicked at 'explicit panic', $DIR/issue-47429-short-backtraces.rs:21:5\n+thread 'main' panicked at 'explicit panic', $DIR/issue-47429-short-backtraces.rs:22:5\n stack backtrace:\n    0: std::panicking::begin_panic::<&str>\n    1: issue_47429_short_backtraces::main"}, {"sha": "f282f18839c64e389e5c9bfc339e96478ea4c5fd", "filename": "src/test/ui/panics/runtime-switch.legacy.run.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fpanics%2Fruntime-switch.legacy.run.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fpanics%2Fruntime-switch.legacy.run.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpanics%2Fruntime-switch.legacy.run.stderr?ref=18ed1fa12933ff895980b55cf8b858aec8171b85", "patch": "@@ -1,4 +1,4 @@\n-thread 'main' panicked at 'explicit panic', $DIR/runtime-switch.rs:24:5\n+thread 'main' panicked at 'explicit panic', $DIR/runtime-switch.rs:25:5\n stack backtrace:\n    0: std::panicking::begin_panic\n    1: runtime_switch::main"}, {"sha": "37ef961e2d019d6846101f9f6da78f50a932b642", "filename": "src/test/ui/panics/runtime-switch.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fpanics%2Fruntime-switch.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fpanics%2Fruntime-switch.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpanics%2Fruntime-switch.rs?ref=18ed1fa12933ff895980b55cf8b858aec8171b85", "patch": "@@ -1,6 +1,7 @@\n // Test for std::panic::set_backtrace_style.\n \n // compile-flags: -O\n+// compile-flags:-Cstrip=none\n // run-fail\n // check-run-results\n // exec-env:RUST_BACKTRACE=0"}, {"sha": "7ce9722e5edf184d0ba01c3af17c8d9f9f1b38a8", "filename": "src/test/ui/panics/runtime-switch.v0.run.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fpanics%2Fruntime-switch.v0.run.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fpanics%2Fruntime-switch.v0.run.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpanics%2Fruntime-switch.v0.run.stderr?ref=18ed1fa12933ff895980b55cf8b858aec8171b85", "patch": "@@ -1,4 +1,4 @@\n-thread 'main' panicked at 'explicit panic', $DIR/runtime-switch.rs:24:5\n+thread 'main' panicked at 'explicit panic', $DIR/runtime-switch.rs:25:5\n stack backtrace:\n    0: std::panicking::begin_panic::<&str>\n    1: runtime_switch::main"}, {"sha": "ae7911e5943891df6cea34c1e82a8f31c5ddf5d6", "filename": "src/test/ui/panics/unique-panic.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fpanics%2Funique-panic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fpanics%2Funique-panic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fpanics%2Funique-panic.rs?ref=18ed1fa12933ff895980b55cf8b858aec8171b85", "patch": "@@ -1,5 +1,9 @@\n // run-fail\n // error-pattern: panic\n+// for some reason, fails to match error string on\n+// wasm32-unknown-unknown with stripped debuginfo and symbols,\n+// so don't strip it\n+// compile-flags:-Cstrip=none\n \n fn main() {\n     Box::new(panic!());"}, {"sha": "7c9f1a7f2f49b1200d1e05a150e09e05a0759c2f", "filename": "src/test/ui/runtime/backtrace-debuginfo.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fruntime%2Fbacktrace-debuginfo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fruntime%2Fbacktrace-debuginfo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fruntime%2Fbacktrace-debuginfo.rs?ref=18ed1fa12933ff895980b55cf8b858aec8171b85", "patch": "@@ -8,6 +8,7 @@\n \n // compile-flags:-g -Copt-level=0 -Cllvm-args=-enable-tail-merge=0\n // compile-flags:-Cforce-frame-pointers=yes\n+// compile-flags:-Cstrip=none\n // ignore-pretty issue #37195\n // ignore-emscripten spawning processes is not supported\n // ignore-sgx no processes"}, {"sha": "07de066b5586382cc676b5e8b02dbc3490657cf9", "filename": "src/test/ui/std-backtrace.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fstd-backtrace.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftest%2Fui%2Fstd-backtrace.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fstd-backtrace.rs?ref=18ed1fa12933ff895980b55cf8b858aec8171b85", "patch": "@@ -5,6 +5,7 @@\n // ignore-sgx no processes\n // ignore-msvc see #62897 and `backtrace-debuginfo.rs` test\n // compile-flags:-g\n+// compile-flags:-Cstrip=none\n \n #![feature(backtrace)]\n "}, {"sha": "160b9785d975f771a706315f7582e88dff032d8d", "filename": "src/tools/compiletest/src/runtest.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/18ed1fa12933ff895980b55cf8b858aec8171b85/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fcompiletest%2Fsrc%2Fruntest.rs?ref=18ed1fa12933ff895980b55cf8b858aec8171b85", "patch": "@@ -1882,6 +1882,8 @@ impl<'test> TestCx<'test> {\n                 rustc.arg(\"-Ccodegen-units=1\");\n                 rustc.arg(\"-Zui-testing\");\n                 rustc.arg(\"-Zdeduplicate-diagnostics=no\");\n+                // FIXME: use this for other modes too, for perf?\n+                rustc.arg(\"-Cstrip=debuginfo\");\n             }\n             MirOpt => {\n                 rustc.args(&["}]}