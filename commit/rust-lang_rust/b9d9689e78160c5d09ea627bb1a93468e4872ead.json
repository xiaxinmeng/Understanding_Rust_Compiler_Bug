{"sha": "b9d9689e78160c5d09ea627bb1a93468e4872ead", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI5ZDk2ODllNzgxNjBjNWQwOWVhNjI3YmIxYTkzNDY4ZTQ4NzJlYWQ=", "commit": {"author": {"name": "Mateusz Miku\u0142a", "email": "mati865@gmail.com", "date": "2020-04-08T19:36:18Z"}, "committer": {"name": "Mateusz Miku\u0142a", "email": "mati865@gmail.com", "date": "2020-04-08T22:33:05Z"}, "message": "Fix staticlib name for *-pc-windows-gnu targets", "tree": {"sha": "c5feb2f3025c8856fad94ff542911c4ed6c0d4fd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c5feb2f3025c8856fad94ff542911c4ed6c0d4fd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b9d9689e78160c5d09ea627bb1a93468e4872ead", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b9d9689e78160c5d09ea627bb1a93468e4872ead", "html_url": "https://github.com/rust-lang/rust/commit/b9d9689e78160c5d09ea627bb1a93468e4872ead", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b9d9689e78160c5d09ea627bb1a93468e4872ead/comments", "author": {"login": "mati865", "id": 1174646, "node_id": "MDQ6VXNlcjExNzQ2NDY=", "avatar_url": "https://avatars.githubusercontent.com/u/1174646?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mati865", "html_url": "https://github.com/mati865", "followers_url": "https://api.github.com/users/mati865/followers", "following_url": "https://api.github.com/users/mati865/following{/other_user}", "gists_url": "https://api.github.com/users/mati865/gists{/gist_id}", "starred_url": "https://api.github.com/users/mati865/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mati865/subscriptions", "organizations_url": "https://api.github.com/users/mati865/orgs", "repos_url": "https://api.github.com/users/mati865/repos", "events_url": "https://api.github.com/users/mati865/events{/privacy}", "received_events_url": "https://api.github.com/users/mati865/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mati865", "id": 1174646, "node_id": "MDQ6VXNlcjExNzQ2NDY=", "avatar_url": "https://avatars.githubusercontent.com/u/1174646?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mati865", "html_url": "https://github.com/mati865", "followers_url": "https://api.github.com/users/mati865/followers", "following_url": "https://api.github.com/users/mati865/following{/other_user}", "gists_url": "https://api.github.com/users/mati865/gists{/gist_id}", "starred_url": "https://api.github.com/users/mati865/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mati865/subscriptions", "organizations_url": "https://api.github.com/users/mati865/orgs", "repos_url": "https://api.github.com/users/mati865/repos", "events_url": "https://api.github.com/users/mati865/events{/privacy}", "received_events_url": "https://api.github.com/users/mati865/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "af89eb5e5beda2c1de0c0c031694892a51e8db07", "url": "https://api.github.com/repos/rust-lang/rust/commits/af89eb5e5beda2c1de0c0c031694892a51e8db07", "html_url": "https://github.com/rust-lang/rust/commit/af89eb5e5beda2c1de0c0c031694892a51e8db07"}], "stats": {"total": 11, "additions": 8, "deletions": 3}, "files": [{"sha": "39350c1618ab06e7a8299ce85146c792b7c9bd37", "filename": "src/librustc_target/spec/windows_base.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/b9d9689e78160c5d09ea627bb1a93468e4872ead/src%2Flibrustc_target%2Fspec%2Fwindows_base.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b9d9689e78160c5d09ea627bb1a93468e4872ead/src%2Flibrustc_target%2Fspec%2Fwindows_base.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_target%2Fspec%2Fwindows_base.rs?ref=b9d9689e78160c5d09ea627bb1a93468e4872ead", "patch": "@@ -75,8 +75,8 @@ pub fn opts() -> TargetOptions {\n         dll_prefix: String::new(),\n         dll_suffix: \".dll\".to_string(),\n         exe_suffix: \".exe\".to_string(),\n-        staticlib_prefix: String::new(),\n-        staticlib_suffix: \".lib\".to_string(),\n+        staticlib_prefix: \"lib\".to_string(),\n+        staticlib_suffix: \".a\".to_string(),\n         target_family: Some(\"windows\".to_string()),\n         is_like_windows: true,\n         allows_weak_linkage: false,"}, {"sha": "b6e0cbaf5ddc7557e9fb7fd8ac479dbb15791b7b", "filename": "src/test/run-make-fulldeps/output-type-permutations/Makefile", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/b9d9689e78160c5d09ea627bb1a93468e4872ead/src%2Ftest%2Frun-make-fulldeps%2Foutput-type-permutations%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/b9d9689e78160c5d09ea627bb1a93468e4872ead/src%2Ftest%2Frun-make-fulldeps%2Foutput-type-permutations%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Foutput-type-permutations%2FMakefile?ref=b9d9689e78160c5d09ea627bb1a93468e4872ead", "patch": "@@ -78,7 +78,7 @@ all:\n \trm $(TMPDIR)/$(call BIN,foo)\n \t$(RUSTC) foo.rs --crate-type=dylib --emit=link=$(TMPDIR)/$(call BIN,foo)\n \trm $(TMPDIR)/$(call BIN,foo)\n-\trm -f $(TMPDIR)/{lib,}foo.{dll.exp,dll.lib,pdb,dll.a,exe.lib}\n+\trm -f $(TMPDIR)/{lib,}foo.{dll.exp,dll.lib,pdb,dll.a,exe.a}\n \t[ \"$$(ls -1 $(TMPDIR) | wc -l)\" -eq \"0\" ] || (ls -1 $(TMPDIR) && exit 1)\n \n \t$(RUSTC) foo.rs --crate-type=staticlib -o $(TMPDIR)/foo"}, {"sha": "04bf78ed2105be91980aef74951edbe51036dd21", "filename": "src/test/run-make-fulldeps/tools.mk", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/b9d9689e78160c5d09ea627bb1a93468e4872ead/src%2Ftest%2Frun-make-fulldeps%2Ftools.mk", "raw_url": "https://github.com/rust-lang/rust/raw/b9d9689e78160c5d09ea627bb1a93468e4872ead/src%2Ftest%2Frun-make-fulldeps%2Ftools.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Ftools.mk?ref=b9d9689e78160c5d09ea627bb1a93468e4872ead", "patch": "@@ -44,8 +44,13 @@ RUN = PATH=\"$(PATH):$(TARGET_RPATH_DIR)\" $(RUN_BINFILE)\n FAIL = PATH=\"$(PATH):$(TARGET_RPATH_DIR)\" $(RUN_BINFILE) && exit 1 || exit 0\n DYLIB_GLOB = $(1)*.dll\n DYLIB = $(TMPDIR)/$(1).dll\n+ifdef IS_MSVC\n STATICLIB = $(TMPDIR)/$(1).lib\n STATICLIB_GLOB = $(1)*.lib\n+else\n+STATICLIB = $(TMPDIR)/lib$(1).a\n+STATICLIB_GLOB = lib$(1)*.a\n+endif\n BIN = $(1).exe\n LLVM_FILECHECK := $(shell cygpath -u \"$(LLVM_FILECHECK)\")\n else"}]}