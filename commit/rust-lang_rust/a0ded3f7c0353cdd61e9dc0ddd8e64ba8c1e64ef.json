{"sha": "a0ded3f7c0353cdd61e9dc0ddd8e64ba8c1e64ef", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEwZGVkM2Y3YzAzNTNjZGQ2MWU5ZGMwZGRkOGU2NGJhOGMxZTY0ZWY=", "commit": {"author": {"name": "bors[bot]", "email": "bors[bot]@users.noreply.github.com", "date": "2019-03-14T09:17:21Z"}, "committer": {"name": "bors[bot]", "email": "bors[bot]@users.noreply.github.com", "date": "2019-03-14T09:17:21Z"}, "message": "Merge #974\n\n974: Add MINUS token the PATTERN_FIRST token set r=matklad a=mchesser\n\nFixes: #972 \n\nCo-authored-by: Michael Chesser <michaelchesser@outlook.com>", "tree": {"sha": "d251d88ce50996846924d9f4d82b6ba3fcd4b83b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d251d88ce50996846924d9f4d82b6ba3fcd4b83b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a0ded3f7c0353cdd61e9dc0ddd8e64ba8c1e64ef", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a0ded3f7c0353cdd61e9dc0ddd8e64ba8c1e64ef", "html_url": "https://github.com/rust-lang/rust/commit/a0ded3f7c0353cdd61e9dc0ddd8e64ba8c1e64ef", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a0ded3f7c0353cdd61e9dc0ddd8e64ba8c1e64ef/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "parents": [{"sha": "f7065c294c24b48014f2b2594126dad4a43caee8", "url": "https://api.github.com/repos/rust-lang/rust/commits/f7065c294c24b48014f2b2594126dad4a43caee8", "html_url": "https://github.com/rust-lang/rust/commit/f7065c294c24b48014f2b2594126dad4a43caee8"}, {"sha": "943d2fb781b01a1a852c03319ffdeb3ab3800d99", "url": "https://api.github.com/repos/rust-lang/rust/commits/943d2fb781b01a1a852c03319ffdeb3ab3800d99", "html_url": "https://github.com/rust-lang/rust/commit/943d2fb781b01a1a852c03319ffdeb3ab3800d99"}], "stats": {"total": 349, "additions": 348, "deletions": 1}, "files": [{"sha": "9a307559bc9657438d581209576a48a7961da426", "filename": "crates/ra_parser/src/grammar/patterns.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/a0ded3f7c0353cdd61e9dc0ddd8e64ba8c1e64ef/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fpatterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a0ded3f7c0353cdd61e9dc0ddd8e64ba8c1e64ef/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fpatterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fpatterns.rs?ref=a0ded3f7c0353cdd61e9dc0ddd8e64ba8c1e64ef", "patch": "@@ -2,7 +2,7 @@ use super::*;\n \n pub(super) const PATTERN_FIRST: TokenSet = expressions::LITERAL_FIRST\n     .union(paths::PATH_FIRST)\n-    .union(token_set![REF_KW, MUT_KW, L_PAREN, L_BRACK, AMP, UNDERSCORE]);\n+    .union(token_set![REF_KW, MUT_KW, L_PAREN, L_BRACK, AMP, UNDERSCORE, MINUS]);\n \n pub(super) fn pattern(p: &mut Parser) {\n     pattern_r(p, PAT_RECOVERY_SET)"}, {"sha": "bbd6b0f6e7c642ebe059a547e969edc542c8d797", "filename": "crates/ra_syntax/tests/data/parser/ok/0047_minus_in_inner_pattern.rs", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/a0ded3f7c0353cdd61e9dc0ddd8e64ba8c1e64ef/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Fok%2F0047_minus_in_inner_pattern.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a0ded3f7c0353cdd61e9dc0ddd8e64ba8c1e64ef/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Fok%2F0047_minus_in_inner_pattern.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Fok%2F0047_minus_in_inner_pattern.rs?ref=a0ded3f7c0353cdd61e9dc0ddd8e64ba8c1e64ef", "patch": "@@ -0,0 +1,27 @@\n+// https://github.com/rust-analyzer/rust-analyzer/issues/972\n+\n+fn main() {\n+    match Some(-1) {\n+        Some(-1) => (),\n+        _ => (),\n+    }\n+\n+    match Some((-1, -1)) {\n+        Some((-1, -1)) => (),\n+        _ => (),\n+    }\n+\n+    match A::B(-1, -1) {\n+        A::B(-1, -1) => (),\n+        _ => (),\n+    }\n+\n+    if let Some(-1) = Some(-1) {\n+    }\n+}\n+\n+enum A {\n+    B(i8, i8)\n+}\n+\n+fn foo(-128..=127: i8) {}"}, {"sha": "ca66b44bb7cbda81c10818f02ff445fd224b0351", "filename": "crates/ra_syntax/tests/data/parser/ok/0047_minus_in_inner_pattern.txt", "status": "added", "additions": 320, "deletions": 0, "changes": 320, "blob_url": "https://github.com/rust-lang/rust/blob/a0ded3f7c0353cdd61e9dc0ddd8e64ba8c1e64ef/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Fok%2F0047_minus_in_inner_pattern.txt", "raw_url": "https://github.com/rust-lang/rust/raw/a0ded3f7c0353cdd61e9dc0ddd8e64ba8c1e64ef/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Fok%2F0047_minus_in_inner_pattern.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Fok%2F0047_minus_in_inner_pattern.txt?ref=a0ded3f7c0353cdd61e9dc0ddd8e64ba8c1e64ef", "patch": "@@ -0,0 +1,320 @@\n+SOURCE_FILE@[0; 395)\n+  COMMENT@[0; 60)\n+  WHITESPACE@[60; 62)\n+  FN_DEF@[62; 341)\n+    FN_KW@[62; 64)\n+    WHITESPACE@[64; 65)\n+    NAME@[65; 69)\n+      IDENT@[65; 69) \"main\"\n+    PARAM_LIST@[69; 71)\n+      L_PAREN@[69; 70)\n+      R_PAREN@[70; 71)\n+    WHITESPACE@[71; 72)\n+    BLOCK@[72; 341)\n+      L_CURLY@[72; 73)\n+      WHITESPACE@[73; 78)\n+      EXPR_STMT@[78; 141)\n+        MATCH_EXPR@[78; 141)\n+          MATCH_KW@[78; 83)\n+          WHITESPACE@[83; 84)\n+          CALL_EXPR@[84; 92)\n+            PATH_EXPR@[84; 88)\n+              PATH@[84; 88)\n+                PATH_SEGMENT@[84; 88)\n+                  NAME_REF@[84; 88)\n+                    IDENT@[84; 88) \"Some\"\n+            ARG_LIST@[88; 92)\n+              L_PAREN@[88; 89)\n+              PREFIX_EXPR@[89; 91)\n+                MINUS@[89; 90)\n+                LITERAL@[90; 91)\n+                  INT_NUMBER@[90; 91) \"1\"\n+              R_PAREN@[91; 92)\n+          WHITESPACE@[92; 93)\n+          MATCH_ARM_LIST@[93; 141)\n+            L_CURLY@[93; 94)\n+            WHITESPACE@[94; 103)\n+            MATCH_ARM@[103; 117)\n+              TUPLE_STRUCT_PAT@[103; 111)\n+                PATH@[103; 107)\n+                  PATH_SEGMENT@[103; 107)\n+                    NAME_REF@[103; 107)\n+                      IDENT@[103; 107) \"Some\"\n+                L_PAREN@[107; 108)\n+                LITERAL_PAT@[108; 110)\n+                  MINUS@[108; 109)\n+                  LITERAL@[109; 110)\n+                    INT_NUMBER@[109; 110) \"1\"\n+                R_PAREN@[110; 111)\n+              WHITESPACE@[111; 112)\n+              FAT_ARROW@[112; 114)\n+              WHITESPACE@[114; 115)\n+              TUPLE_EXPR@[115; 117)\n+                L_PAREN@[115; 116)\n+                R_PAREN@[116; 117)\n+            COMMA@[117; 118)\n+            WHITESPACE@[118; 127)\n+            MATCH_ARM@[127; 134)\n+              PLACEHOLDER_PAT@[127; 128)\n+                UNDERSCORE@[127; 128)\n+              WHITESPACE@[128; 129)\n+              FAT_ARROW@[129; 131)\n+              WHITESPACE@[131; 132)\n+              TUPLE_EXPR@[132; 134)\n+                L_PAREN@[132; 133)\n+                R_PAREN@[133; 134)\n+            COMMA@[134; 135)\n+            WHITESPACE@[135; 140)\n+            R_CURLY@[140; 141)\n+      WHITESPACE@[141; 147)\n+      EXPR_STMT@[147; 222)\n+        MATCH_EXPR@[147; 222)\n+          MATCH_KW@[147; 152)\n+          WHITESPACE@[152; 153)\n+          CALL_EXPR@[153; 167)\n+            PATH_EXPR@[153; 157)\n+              PATH@[153; 157)\n+                PATH_SEGMENT@[153; 157)\n+                  NAME_REF@[153; 157)\n+                    IDENT@[153; 157) \"Some\"\n+            ARG_LIST@[157; 167)\n+              L_PAREN@[157; 158)\n+              TUPLE_EXPR@[158; 166)\n+                L_PAREN@[158; 159)\n+                PREFIX_EXPR@[159; 161)\n+                  MINUS@[159; 160)\n+                  LITERAL@[160; 161)\n+                    INT_NUMBER@[160; 161) \"1\"\n+                COMMA@[161; 162)\n+                WHITESPACE@[162; 163)\n+                PREFIX_EXPR@[163; 165)\n+                  MINUS@[163; 164)\n+                  LITERAL@[164; 165)\n+                    INT_NUMBER@[164; 165) \"1\"\n+                R_PAREN@[165; 166)\n+              R_PAREN@[166; 167)\n+          WHITESPACE@[167; 168)\n+          MATCH_ARM_LIST@[168; 222)\n+            L_CURLY@[168; 169)\n+            WHITESPACE@[169; 178)\n+            MATCH_ARM@[178; 198)\n+              TUPLE_STRUCT_PAT@[178; 192)\n+                PATH@[178; 182)\n+                  PATH_SEGMENT@[178; 182)\n+                    NAME_REF@[178; 182)\n+                      IDENT@[178; 182) \"Some\"\n+                L_PAREN@[182; 183)\n+                TUPLE_PAT@[183; 191)\n+                  L_PAREN@[183; 184)\n+                  LITERAL_PAT@[184; 186)\n+                    MINUS@[184; 185)\n+                    LITERAL@[185; 186)\n+                      INT_NUMBER@[185; 186) \"1\"\n+                  COMMA@[186; 187)\n+                  WHITESPACE@[187; 188)\n+                  LITERAL_PAT@[188; 190)\n+                    MINUS@[188; 189)\n+                    LITERAL@[189; 190)\n+                      INT_NUMBER@[189; 190) \"1\"\n+                  R_PAREN@[190; 191)\n+                R_PAREN@[191; 192)\n+              WHITESPACE@[192; 193)\n+              FAT_ARROW@[193; 195)\n+              WHITESPACE@[195; 196)\n+              TUPLE_EXPR@[196; 198)\n+                L_PAREN@[196; 197)\n+                R_PAREN@[197; 198)\n+            COMMA@[198; 199)\n+            WHITESPACE@[199; 208)\n+            MATCH_ARM@[208; 215)\n+              PLACEHOLDER_PAT@[208; 209)\n+                UNDERSCORE@[208; 209)\n+              WHITESPACE@[209; 210)\n+              FAT_ARROW@[210; 212)\n+              WHITESPACE@[212; 213)\n+              TUPLE_EXPR@[213; 215)\n+                L_PAREN@[213; 214)\n+                R_PAREN@[214; 215)\n+            COMMA@[215; 216)\n+            WHITESPACE@[216; 221)\n+            R_CURLY@[221; 222)\n+      WHITESPACE@[222; 228)\n+      EXPR_STMT@[228; 299)\n+        MATCH_EXPR@[228; 299)\n+          MATCH_KW@[228; 233)\n+          WHITESPACE@[233; 234)\n+          CALL_EXPR@[234; 246)\n+            PATH_EXPR@[234; 238)\n+              PATH@[234; 238)\n+                PATH@[234; 235)\n+                  PATH_SEGMENT@[234; 235)\n+                    NAME_REF@[234; 235)\n+                      IDENT@[234; 235) \"A\"\n+                COLONCOLON@[235; 237)\n+                PATH_SEGMENT@[237; 238)\n+                  NAME_REF@[237; 238)\n+                    IDENT@[237; 238) \"B\"\n+            ARG_LIST@[238; 246)\n+              L_PAREN@[238; 239)\n+              PREFIX_EXPR@[239; 241)\n+                MINUS@[239; 240)\n+                LITERAL@[240; 241)\n+                  INT_NUMBER@[240; 241) \"1\"\n+              COMMA@[241; 242)\n+              WHITESPACE@[242; 243)\n+              PREFIX_EXPR@[243; 245)\n+                MINUS@[243; 244)\n+                LITERAL@[244; 245)\n+                  INT_NUMBER@[244; 245) \"1\"\n+              R_PAREN@[245; 246)\n+          WHITESPACE@[246; 247)\n+          MATCH_ARM_LIST@[247; 299)\n+            L_CURLY@[247; 248)\n+            WHITESPACE@[248; 257)\n+            MATCH_ARM@[257; 275)\n+              TUPLE_STRUCT_PAT@[257; 269)\n+                PATH@[257; 261)\n+                  PATH@[257; 258)\n+                    PATH_SEGMENT@[257; 258)\n+                      NAME_REF@[257; 258)\n+                        IDENT@[257; 258) \"A\"\n+                  COLONCOLON@[258; 260)\n+                  PATH_SEGMENT@[260; 261)\n+                    NAME_REF@[260; 261)\n+                      IDENT@[260; 261) \"B\"\n+                L_PAREN@[261; 262)\n+                LITERAL_PAT@[262; 264)\n+                  MINUS@[262; 263)\n+                  LITERAL@[263; 264)\n+                    INT_NUMBER@[263; 264) \"1\"\n+                COMMA@[264; 265)\n+                WHITESPACE@[265; 266)\n+                LITERAL_PAT@[266; 268)\n+                  MINUS@[266; 267)\n+                  LITERAL@[267; 268)\n+                    INT_NUMBER@[267; 268) \"1\"\n+                R_PAREN@[268; 269)\n+              WHITESPACE@[269; 270)\n+              FAT_ARROW@[270; 272)\n+              WHITESPACE@[272; 273)\n+              TUPLE_EXPR@[273; 275)\n+                L_PAREN@[273; 274)\n+                R_PAREN@[274; 275)\n+            COMMA@[275; 276)\n+            WHITESPACE@[276; 285)\n+            MATCH_ARM@[285; 292)\n+              PLACEHOLDER_PAT@[285; 286)\n+                UNDERSCORE@[285; 286)\n+              WHITESPACE@[286; 287)\n+              FAT_ARROW@[287; 289)\n+              WHITESPACE@[289; 290)\n+              TUPLE_EXPR@[290; 292)\n+                L_PAREN@[290; 291)\n+                R_PAREN@[291; 292)\n+            COMMA@[292; 293)\n+            WHITESPACE@[293; 298)\n+            R_CURLY@[298; 299)\n+      WHITESPACE@[299; 305)\n+      IF_EXPR@[305; 339)\n+        IF_KW@[305; 307)\n+        WHITESPACE@[307; 308)\n+        CONDITION@[308; 331)\n+          LET_KW@[308; 311)\n+          WHITESPACE@[311; 312)\n+          TUPLE_STRUCT_PAT@[312; 320)\n+            PATH@[312; 316)\n+              PATH_SEGMENT@[312; 316)\n+                NAME_REF@[312; 316)\n+                  IDENT@[312; 316) \"Some\"\n+            L_PAREN@[316; 317)\n+            LITERAL_PAT@[317; 319)\n+              MINUS@[317; 318)\n+              LITERAL@[318; 319)\n+                INT_NUMBER@[318; 319) \"1\"\n+            R_PAREN@[319; 320)\n+          WHITESPACE@[320; 321)\n+          EQ@[321; 322)\n+          WHITESPACE@[322; 323)\n+          CALL_EXPR@[323; 331)\n+            PATH_EXPR@[323; 327)\n+              PATH@[323; 327)\n+                PATH_SEGMENT@[323; 327)\n+                  NAME_REF@[323; 327)\n+                    IDENT@[323; 327) \"Some\"\n+            ARG_LIST@[327; 331)\n+              L_PAREN@[327; 328)\n+              PREFIX_EXPR@[328; 330)\n+                MINUS@[328; 329)\n+                LITERAL@[329; 330)\n+                  INT_NUMBER@[329; 330) \"1\"\n+              R_PAREN@[330; 331)\n+        WHITESPACE@[331; 332)\n+        BLOCK@[332; 339)\n+          L_CURLY@[332; 333)\n+          WHITESPACE@[333; 338)\n+          R_CURLY@[338; 339)\n+      WHITESPACE@[339; 340)\n+      R_CURLY@[340; 341)\n+  WHITESPACE@[341; 343)\n+  ENUM_DEF@[343; 367)\n+    ENUM_KW@[343; 347)\n+    WHITESPACE@[347; 348)\n+    NAME@[348; 349)\n+      IDENT@[348; 349) \"A\"\n+    WHITESPACE@[349; 350)\n+    ENUM_VARIANT_LIST@[350; 367)\n+      L_CURLY@[350; 351)\n+      WHITESPACE@[351; 356)\n+      ENUM_VARIANT@[356; 365)\n+        NAME@[356; 357)\n+          IDENT@[356; 357) \"B\"\n+        POS_FIELD_DEF_LIST@[357; 365)\n+          L_PAREN@[357; 358)\n+          POS_FIELD_DEF@[358; 360)\n+            PATH_TYPE@[358; 360)\n+              PATH@[358; 360)\n+                PATH_SEGMENT@[358; 360)\n+                  NAME_REF@[358; 360)\n+                    IDENT@[358; 360) \"i8\"\n+          COMMA@[360; 361)\n+          WHITESPACE@[361; 362)\n+          POS_FIELD_DEF@[362; 364)\n+            PATH_TYPE@[362; 364)\n+              PATH@[362; 364)\n+                PATH_SEGMENT@[362; 364)\n+                  NAME_REF@[362; 364)\n+                    IDENT@[362; 364) \"i8\"\n+          R_PAREN@[364; 365)\n+      WHITESPACE@[365; 366)\n+      R_CURLY@[366; 367)\n+  WHITESPACE@[367; 369)\n+  FN_DEF@[369; 394)\n+    FN_KW@[369; 371)\n+    WHITESPACE@[371; 372)\n+    NAME@[372; 375)\n+      IDENT@[372; 375) \"foo\"\n+    PARAM_LIST@[375; 391)\n+      L_PAREN@[375; 376)\n+      PARAM@[376; 390)\n+        RANGE_PAT@[376; 386)\n+          LITERAL_PAT@[376; 380)\n+            MINUS@[376; 377)\n+            LITERAL@[377; 380)\n+              INT_NUMBER@[377; 380) \"128\"\n+          DOTDOTEQ@[380; 383)\n+          LITERAL_PAT@[383; 386)\n+            LITERAL@[383; 386)\n+              INT_NUMBER@[383; 386) \"127\"\n+        COLON@[386; 387)\n+        WHITESPACE@[387; 388)\n+        PATH_TYPE@[388; 390)\n+          PATH@[388; 390)\n+            PATH_SEGMENT@[388; 390)\n+              NAME_REF@[388; 390)\n+                IDENT@[388; 390) \"i8\"\n+      R_PAREN@[390; 391)\n+    WHITESPACE@[391; 392)\n+    BLOCK@[392; 394)\n+      L_CURLY@[392; 393)\n+      R_CURLY@[393; 394)\n+  WHITESPACE@[394; 395)"}]}