{"sha": "09712d7ac3a351dcbe3c354a902d52d3f0c5658d", "node_id": "MDY6Q29tbWl0NzI0NzEyOjA5NzEyZDdhYzNhMzUxZGNiZTNjMzU0YTkwMmQ1MmQzZjBjNTY1OGQ=", "commit": {"author": {"name": "Jonathan Turner", "email": "jonathandturner@users.noreply.github.com", "date": "2016-10-06T15:35:41Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2016-10-06T15:35:41Z"}, "message": "Rollup merge of #36832 - ParkHanbum:master, r=michaelwoerister\n\nAdd testcase for issue-32948\n\nissue-32948 is similar to issue-32554.\n\nissue-32948 : Symbol names for monomorphized trait impls are not stable across crates\nissue-32554 : Symbol names for generics are not stable across crates\n\nso, I append issue-32948's testcase to issue-32554's testcase.\nthanks!", "tree": {"sha": "1ab95534d4f6a0e81a0c34b428a2a6e3ae2cf919", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1ab95534d4f6a0e81a0c34b428a2a6e3ae2cf919"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/09712d7ac3a351dcbe3c354a902d52d3f0c5658d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/09712d7ac3a351dcbe3c354a902d52d3f0c5658d", "html_url": "https://github.com/rust-lang/rust/commit/09712d7ac3a351dcbe3c354a902d52d3f0c5658d", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/09712d7ac3a351dcbe3c354a902d52d3f0c5658d/comments", "author": {"login": "jonathandturner", "id": 111457284, "node_id": "O_kgDOBqS0BA", "avatar_url": "https://avatars.githubusercontent.com/u/111457284?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jonathandturner", "html_url": "https://github.com/jonathandturner", "followers_url": "https://api.github.com/users/jonathandturner/followers", "following_url": "https://api.github.com/users/jonathandturner/following{/other_user}", "gists_url": "https://api.github.com/users/jonathandturner/gists{/gist_id}", "starred_url": "https://api.github.com/users/jonathandturner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jonathandturner/subscriptions", "organizations_url": "https://api.github.com/users/jonathandturner/orgs", "repos_url": "https://api.github.com/users/jonathandturner/repos", "events_url": "https://api.github.com/users/jonathandturner/events{/privacy}", "received_events_url": "https://api.github.com/users/jonathandturner/received_events", "type": "Organization", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d3bb56860d1ea81eccc2b9bac257a2414a572de6", "url": "https://api.github.com/repos/rust-lang/rust/commits/d3bb56860d1ea81eccc2b9bac257a2414a572de6", "html_url": "https://github.com/rust-lang/rust/commit/d3bb56860d1ea81eccc2b9bac257a2414a572de6"}, {"sha": "cb700e78ed24300e8609b1f8bd442ede4fae03d2", "url": "https://api.github.com/repos/rust-lang/rust/commits/cb700e78ed24300e8609b1f8bd442ede4fae03d2", "html_url": "https://github.com/rust-lang/rust/commit/cb700e78ed24300e8609b1f8bd442ede4fae03d2"}], "stats": {"total": 34, "additions": 29, "deletions": 5}, "files": [{"sha": "c1b14440faab6609bbf5f32c7d45adcc06d16d8b", "filename": "src/test/run-make/stable-symbol-names/Makefile", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/09712d7ac3a351dcbe3c354a902d52d3f0c5658d/src%2Ftest%2Frun-make%2Fstable-symbol-names%2FMakefile", "raw_url": "https://github.com/rust-lang/rust/raw/09712d7ac3a351dcbe3c354a902d52d3f0c5658d/src%2Ftest%2Frun-make%2Fstable-symbol-names%2FMakefile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fstable-symbol-names%2FMakefile?ref=09712d7ac3a351dcbe3c354a902d52d3f0c5658d", "patch": "@@ -1,12 +1,16 @@\n -include ../tools.mk\n \n-# This test case makes sure that monomorphizations of the same function with the\n-# same set of generic arguments will have the same symbol names when\n-# instantiated in different crates.\n+# The following command will:\n+#  1. dump the symbols of a library using `nm`\n+#  2. extract only those lines that we are interested in via `grep`\n+#  3. from those lines, extract just the symbol name via `sed`\n+#     (symbol names always start with \"_ZN\" and end with \"E\")\n+#  4. sort those symbol names for deterministic comparison\n+#  5. write the result into a file\n \n dump-symbols = nm \"$(TMPDIR)/lib$(1).rlib\" \\\n-             |  grep \"some_test_function\" \\\n-             | sed \"s/^[0-9a-f]\\{8,16\\}/00000000/\" \\\n+             | grep -E \"some_test_function|Bar|bar\" \\\n+             | sed \"s/.*\\(_ZN.*E\\).*/\\1/\" \\\n              | sort \\\n              > \"$(TMPDIR)/$(1).nm\"\n "}, {"sha": "5c73ff0fab6d0ea16c608d0430b2ab20ee6a0c0d", "filename": "src/test/run-make/stable-symbol-names/stable-symbol-names1.rs", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/09712d7ac3a351dcbe3c354a902d52d3f0c5658d/src%2Ftest%2Frun-make%2Fstable-symbol-names%2Fstable-symbol-names1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/09712d7ac3a351dcbe3c354a902d52d3f0c5658d/src%2Ftest%2Frun-make%2Fstable-symbol-names%2Fstable-symbol-names1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fstable-symbol-names%2Fstable-symbol-names1.rs?ref=09712d7ac3a351dcbe3c354a902d52d3f0c5658d", "patch": "@@ -10,6 +10,20 @@\n \n #![crate_type=\"rlib\"]\n \n+pub trait Foo {\n+  fn foo<T>();\n+}\n+\n+pub struct Bar;\n+\n+impl Foo for Bar {\n+  fn foo<T>() {}\n+}\n+\n+pub fn bar() {\n+  Bar::foo::<Bar>();\n+}\n+\n pub fn some_test_function<T>(t: T) -> T {\n   t\n }"}, {"sha": "097dce876affc4428bf7c031b19532d40b513ef4", "filename": "src/test/run-make/stable-symbol-names/stable-symbol-names2.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/09712d7ac3a351dcbe3c354a902d52d3f0c5658d/src%2Ftest%2Frun-make%2Fstable-symbol-names%2Fstable-symbol-names2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/09712d7ac3a351dcbe3c354a902d52d3f0c5658d/src%2Ftest%2Frun-make%2Fstable-symbol-names%2Fstable-symbol-names2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fstable-symbol-names%2Fstable-symbol-names2.rs?ref=09712d7ac3a351dcbe3c354a902d52d3f0c5658d", "patch": "@@ -18,3 +18,9 @@ pub fn user() {\n   let x = 2u64;\n   stable_symbol_names1::some_test_function(&x);\n }\n+\n+pub fn trait_impl_test_function() {\n+  use stable_symbol_names1::*;\n+  Bar::foo::<Bar>();\n+  bar();\n+}"}]}