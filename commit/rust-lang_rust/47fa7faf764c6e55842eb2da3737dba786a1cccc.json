{"sha": "47fa7faf764c6e55842eb2da3737dba786a1cccc", "node_id": "C_kwDOAAsO6NoAKDQ3ZmE3ZmFmNzY0YzZlNTU4NDJlYjJkYTM3MzdkYmE3ODZhMWNjY2M", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-01-14T12:04:23Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-01-14T12:04:23Z"}, "message": "Rollup merge of #106046 - uweigand:s390x-test-bigendian-mir, r=Mark-Simulacrum\n\nFix mir-opt tests for big-endian platforms\n\nThe test cases src/test/mir-opt/building/custom/consts.rs and src/test/mir-opt/const_prop/mutable_variable_no_prop.rs are currently failing on big-endian platforms as the binary encoding of some constants is hard-coded in the MIR test files.  Fix this by choosing constant values that have the same encoding on big- and little-endian platforms.\n\nThe test case src/test/mir-opt/issues/issue_75439.rs is failing as well, but since the purpose of the test is to validate handling of big-endian integer encodings on a little-endian platform, it does not make much sense to run it on big-endian platforms in the first place - we can just ignore it there.\n\nFixed part of https://github.com/rust-lang/rust/issues/105383.", "tree": {"sha": "d83d6bc134f3a5f88c17ad1b957e9233dc7af00e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d83d6bc134f3a5f88c17ad1b957e9233dc7af00e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/47fa7faf764c6e55842eb2da3737dba786a1cccc", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjwppHCRBK7hj4Ov3rIwAAO5MIAFIsHsKpJcXDzenwxfofxZme\n8zsCUdoQAEhTlxUTSZN0aA9wWAa+N/v3/uQEjgFuk2+7UJb4V3MgbnyJ9vBTImw5\np9L36YCYwBUcyBqxOg3QXH1i38AcM8ot5LzswQFNXrjKiCvlWlDzyWjFWdrrGc9R\nhho7Tn0SFGNDKS8yWjlqaCzrUHHONo0lk5sGD2a5KRkzAysKNclM7olDyaZzhl6h\nmkufuGdbfvgmWZXx82A1COObGFmEyHZhlpSvuk1n5jeYgRp0rd4KYJAcM9mO7fVO\nYdtWo+ufuNCyIK3M0NFL3QT14C0Dvuc4KRP+dSinIBxvdis6RYG66bFMEKVtDfI=\n=6nWG\n-----END PGP SIGNATURE-----\n", "payload": "tree d83d6bc134f3a5f88c17ad1b957e9233dc7af00e\nparent 44a500c8c187b245638684748f54bd6ec67e0b25\nparent 6885733c41844ac0ea24b965e91616a16a631697\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1673697863 +0100\ncommitter GitHub <noreply@github.com> 1673697863 +0100\n\nRollup merge of #106046 - uweigand:s390x-test-bigendian-mir, r=Mark-Simulacrum\n\nFix mir-opt tests for big-endian platforms\n\nThe test cases src/test/mir-opt/building/custom/consts.rs and src/test/mir-opt/const_prop/mutable_variable_no_prop.rs are currently failing on big-endian platforms as the binary encoding of some constants is hard-coded in the MIR test files.  Fix this by choosing constant values that have the same encoding on big- and little-endian platforms.\n\nThe test case src/test/mir-opt/issues/issue_75439.rs is failing as well, but since the purpose of the test is to validate handling of big-endian integer encodings on a little-endian platform, it does not make much sense to run it on big-endian platforms in the first place - we can just ignore it there.\n\nFixed part of https://github.com/rust-lang/rust/issues/105383.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/47fa7faf764c6e55842eb2da3737dba786a1cccc", "html_url": "https://github.com/rust-lang/rust/commit/47fa7faf764c6e55842eb2da3737dba786a1cccc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/47fa7faf764c6e55842eb2da3737dba786a1cccc/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "44a500c8c187b245638684748f54bd6ec67e0b25", "url": "https://api.github.com/repos/rust-lang/rust/commits/44a500c8c187b245638684748f54bd6ec67e0b25", "html_url": "https://github.com/rust-lang/rust/commit/44a500c8c187b245638684748f54bd6ec67e0b25"}, {"sha": "6885733c41844ac0ea24b965e91616a16a631697", "url": "https://api.github.com/repos/rust-lang/rust/commits/6885733c41844ac0ea24b965e91616a16a631697", "html_url": "https://github.com/rust-lang/rust/commit/6885733c41844ac0ea24b965e91616a16a631697"}], "stats": {"total": 17, "additions": 9, "deletions": 8}, "files": [{"sha": "16d10eb5968c1b897b178a2fa30cd0526e370b8c", "filename": "tests/mir-opt/building/custom/consts.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/47fa7faf764c6e55842eb2da3737dba786a1cccc/tests%2Fmir-opt%2Fbuilding%2Fcustom%2Fconsts.rs", "raw_url": "https://github.com/rust-lang/rust/raw/47fa7faf764c6e55842eb2da3737dba786a1cccc/tests%2Fmir-opt%2Fbuilding%2Fcustom%2Fconsts.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fmir-opt%2Fbuilding%2Fcustom%2Fconsts.rs?ref=47fa7faf764c6e55842eb2da3737dba786a1cccc", "patch": "@@ -18,8 +18,8 @@ fn consts<const C: u32>() {\n     })\n }\n \n-static S: i32 = 5;\n-static mut T: i32 = 10;\n+static S: i32 = 0x05050505;\n+static mut T: i32 = 0x0a0a0a0a;\n // EMIT_MIR consts.statics.built.after.mir\n #[custom_mir(dialect = \"built\")]\n fn statics() {"}, {"sha": "bfef976aa02726b299276088ac0e5e343b97b3b3", "filename": "tests/mir-opt/building/custom/consts.statics.built.after.mir", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/47fa7faf764c6e55842eb2da3737dba786a1cccc/tests%2Fmir-opt%2Fbuilding%2Fcustom%2Fconsts.statics.built.after.mir", "raw_url": "https://github.com/rust-lang/rust/raw/47fa7faf764c6e55842eb2da3737dba786a1cccc/tests%2Fmir-opt%2Fbuilding%2Fcustom%2Fconsts.statics.built.after.mir", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fmir-opt%2Fbuilding%2Fcustom%2Fconsts.statics.built.after.mir?ref=47fa7faf764c6e55842eb2da3737dba786a1cccc", "patch": "@@ -19,9 +19,9 @@ fn statics() -> () {\n }\n \n alloc2 (static: T, size: 4, align: 4) {\n-    0a 00 00 00                                     \u2502 ....\n+    0a 0a 0a 0a                                     \u2502 ....\n }\n \n alloc1 (static: S, size: 4, align: 4) {\n-    05 00 00 00                                     \u2502 ....\n+    05 05 05 05                                     \u2502 ....\n }"}, {"sha": "7fa29cccd50d602b0e01bc4ed258c20cadc8564a", "filename": "tests/mir-opt/const_prop/mutable_variable_no_prop.main.ConstProp.diff", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/47fa7faf764c6e55842eb2da3737dba786a1cccc/tests%2Fmir-opt%2Fconst_prop%2Fmutable_variable_no_prop.main.ConstProp.diff", "raw_url": "https://github.com/rust-lang/rust/raw/47fa7faf764c6e55842eb2da3737dba786a1cccc/tests%2Fmir-opt%2Fconst_prop%2Fmutable_variable_no_prop.main.ConstProp.diff", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fmir-opt%2Fconst_prop%2Fmutable_variable_no_prop.main.ConstProp.diff?ref=47fa7faf764c6e55842eb2da3737dba786a1cccc", "patch": "@@ -38,6 +38,6 @@\n   }\n   \n   alloc1 (static: STATIC, size: 4, align: 4) {\n-      2a 00 00 00                                     \u2502 *...\n+      42 42 42 42                                     \u2502 BBBB\n   }\n   "}, {"sha": "b69ec931a6311360a097698f26319e9e7b57a899", "filename": "tests/mir-opt/const_prop/mutable_variable_no_prop.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/47fa7faf764c6e55842eb2da3737dba786a1cccc/tests%2Fmir-opt%2Fconst_prop%2Fmutable_variable_no_prop.rs", "raw_url": "https://github.com/rust-lang/rust/raw/47fa7faf764c6e55842eb2da3737dba786a1cccc/tests%2Fmir-opt%2Fconst_prop%2Fmutable_variable_no_prop.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fmir-opt%2Fconst_prop%2Fmutable_variable_no_prop.rs?ref=47fa7faf764c6e55842eb2da3737dba786a1cccc", "patch": "@@ -1,7 +1,7 @@\n // unit-test\n // compile-flags: -O\n \n-static mut STATIC: u32 = 42;\n+static mut STATIC: u32 = 0x42424242;\n \n // EMIT_MIR mutable_variable_no_prop.main.ConstProp.diff\n fn main() {"}, {"sha": "93804780371cd41d11207b768bdad81a67f63269", "filename": "tests/mir-opt/issues/issue_75439.foo.MatchBranchSimplification.diff", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/47fa7faf764c6e55842eb2da3737dba786a1cccc/tests%2Fmir-opt%2Fissues%2Fissue_75439.foo.MatchBranchSimplification.diff", "raw_url": "https://github.com/rust-lang/rust/raw/47fa7faf764c6e55842eb2da3737dba786a1cccc/tests%2Fmir-opt%2Fissues%2Fissue_75439.foo.MatchBranchSimplification.diff", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fmir-opt%2Fissues%2Fissue_75439.foo.MatchBranchSimplification.diff?ref=47fa7faf764c6e55842eb2da3737dba786a1cccc", "patch": "@@ -26,7 +26,7 @@\n           _3 = _1;                         // scope 2 at $DIR/issue_75439.rs:+2:47: +2:52\n           _2 = transmute::<[u8; 16], [u32; 4]>(move _3) -> bb1; // scope 2 at $DIR/issue_75439.rs:+2:37: +2:53\n                                            // mir::Constant\n-                                           // + span: $DIR/issue_75439.rs:7:37: 7:46\n+                                           // + span: $DIR/issue_75439.rs:8:37: 8:46\n                                            // + literal: Const { ty: unsafe extern \"rust-intrinsic\" fn([u8; 16]) -> [u32; 4] {transmute::<[u8; 16], [u32; 4]>}, val: Value(<ZST>) }\n       }\n   \n@@ -49,7 +49,7 @@\n           _6 = _4;                         // scope 4 at $DIR/issue_75439.rs:+5:33: +5:35\n           _5 = transmute::<u32, [u8; 4]>(move _6) -> bb7; // scope 4 at $DIR/issue_75439.rs:+5:23: +5:36\n                                            // mir::Constant\n-                                           // + span: $DIR/issue_75439.rs:10:23: 10:32\n+                                           // + span: $DIR/issue_75439.rs:11:23: 11:32\n                                            // + literal: Const { ty: unsafe extern \"rust-intrinsic\" fn(u32) -> [u8; 4] {transmute::<u32, [u8; 4]>}, val: Value(<ZST>) }\n       }\n   "}, {"sha": "4c749a150c091f5159defd11c28594e7cd22633c", "filename": "tests/mir-opt/issues/issue_75439.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/47fa7faf764c6e55842eb2da3737dba786a1cccc/tests%2Fmir-opt%2Fissues%2Fissue_75439.rs", "raw_url": "https://github.com/rust-lang/rust/raw/47fa7faf764c6e55842eb2da3737dba786a1cccc/tests%2Fmir-opt%2Fissues%2Fissue_75439.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fmir-opt%2Fissues%2Fissue_75439.rs?ref=47fa7faf764c6e55842eb2da3737dba786a1cccc", "patch": "@@ -1,4 +1,5 @@\n // EMIT_MIR issue_75439.foo.MatchBranchSimplification.diff\n+// ignore-endian-big\n \n use std::mem::transmute;\n "}]}