{"sha": "e47553909650b4e4339e902eaa19c0fbdf3610ab", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU0NzU1MzkwOTY1MGI0ZTQzMzllOTAyZWFhMTljMGZiZGYzNjEwYWI=", "commit": {"author": {"name": "Christian Poveda", "email": "christianpoveda@protonmail.com", "date": "2019-06-26T18:13:19Z"}, "committer": {"name": "Christian Poveda", "email": "christianpoveda@protonmail.com", "date": "2019-06-29T14:29:56Z"}, "message": "Add MemoryExtra in InterpretCx constructor params", "tree": {"sha": "ff9e780b43b3093932420c37c3fe7ea8c0334da2", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ff9e780b43b3093932420c37c3fe7ea8c0334da2"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e47553909650b4e4339e902eaa19c0fbdf3610ab", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e47553909650b4e4339e902eaa19c0fbdf3610ab", "html_url": "https://github.com/rust-lang/rust/commit/e47553909650b4e4339e902eaa19c0fbdf3610ab", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e47553909650b4e4339e902eaa19c0fbdf3610ab/comments", "author": {"login": "pvdrz", "id": 31802960, "node_id": "MDQ6VXNlcjMxODAyOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/31802960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pvdrz", "html_url": "https://github.com/pvdrz", "followers_url": "https://api.github.com/users/pvdrz/followers", "following_url": "https://api.github.com/users/pvdrz/following{/other_user}", "gists_url": "https://api.github.com/users/pvdrz/gists{/gist_id}", "starred_url": "https://api.github.com/users/pvdrz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pvdrz/subscriptions", "organizations_url": "https://api.github.com/users/pvdrz/orgs", "repos_url": "https://api.github.com/users/pvdrz/repos", "events_url": "https://api.github.com/users/pvdrz/events{/privacy}", "received_events_url": "https://api.github.com/users/pvdrz/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pvdrz", "id": 31802960, "node_id": "MDQ6VXNlcjMxODAyOTYw", "avatar_url": "https://avatars.githubusercontent.com/u/31802960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pvdrz", "html_url": "https://github.com/pvdrz", "followers_url": "https://api.github.com/users/pvdrz/followers", "following_url": "https://api.github.com/users/pvdrz/following{/other_user}", "gists_url": "https://api.github.com/users/pvdrz/gists{/gist_id}", "starred_url": "https://api.github.com/users/pvdrz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pvdrz/subscriptions", "organizations_url": "https://api.github.com/users/pvdrz/orgs", "repos_url": "https://api.github.com/users/pvdrz/repos", "events_url": "https://api.github.com/users/pvdrz/events{/privacy}", "received_events_url": "https://api.github.com/users/pvdrz/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8ec39423dd0d02f81866b675dd9299972e1b9af5", "url": "https://api.github.com/repos/rust-lang/rust/commits/8ec39423dd0d02f81866b675dd9299972e1b9af5", "html_url": "https://github.com/rust-lang/rust/commit/8ec39423dd0d02f81866b675dd9299972e1b9af5"}], "stats": {"total": 21, "additions": 15, "deletions": 6}, "files": [{"sha": "96e45c2c8fe5b54ec063de8622e3c81ebbce737b", "filename": "src/librustc_mir/const_eval.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/e47553909650b4e4339e902eaa19c0fbdf3610ab/src%2Flibrustc_mir%2Fconst_eval.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e47553909650b4e4339e902eaa19c0fbdf3610ab/src%2Flibrustc_mir%2Fconst_eval.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Fconst_eval.rs?ref=e47553909650b4e4339e902eaa19c0fbdf3610ab", "patch": "@@ -47,7 +47,7 @@ pub(crate) fn mk_eval_cx<'mir, 'tcx>(\n     param_env: ty::ParamEnv<'tcx>,\n ) -> CompileTimeEvalContext<'mir, 'tcx> {\n     debug!(\"mk_eval_cx: {:?}\", param_env);\n-    InterpretCx::new(tcx.at(span), param_env, CompileTimeInterpreter::new())\n+    InterpretCx::new(tcx.at(span), param_env, CompileTimeInterpreter::new(), Default::default())\n }\n \n pub(crate) fn eval_promoted<'mir, 'tcx>(\n@@ -632,7 +632,11 @@ pub fn const_eval_raw_provider<'tcx>(\n     }\n \n     let span = tcx.def_span(cid.instance.def_id());\n-    let mut ecx = InterpretCx::new(tcx.at(span), key.param_env, CompileTimeInterpreter::new());\n+    let mut ecx = InterpretCx::new(\n+        tcx.at(span),\n+        key.param_env,\n+        CompileTimeInterpreter::new(),\n+        Default::default());\n \n     let res = ecx.load_mir(cid.instance.def);\n     res.map(|body| {"}, {"sha": "4c4330ffb261d3d59491794356212aec63674848", "filename": "src/librustc_mir/interpret/eval_context.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/e47553909650b4e4339e902eaa19c0fbdf3610ab/src%2Flibrustc_mir%2Finterpret%2Feval_context.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e47553909650b4e4339e902eaa19c0fbdf3610ab/src%2Flibrustc_mir%2Finterpret%2Feval_context.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Finterpret%2Feval_context.rs?ref=e47553909650b4e4339e902eaa19c0fbdf3610ab", "patch": "@@ -196,12 +196,17 @@ impl<'mir, 'tcx, M: Machine<'mir, 'tcx>> LayoutOf for InterpretCx<'mir, 'tcx, M>\n }\n \n impl<'mir, 'tcx, M: Machine<'mir, 'tcx>> InterpretCx<'mir, 'tcx, M> {\n-    pub fn new(tcx: TyCtxtAt<'tcx>, param_env: ty::ParamEnv<'tcx>, machine: M) -> Self {\n+    pub fn new(\n+        tcx: TyCtxtAt<'tcx>,\n+        param_env: ty::ParamEnv<'tcx>,\n+        machine: M,\n+        memory_extra: M::MemoryExtra,\n+    ) -> Self {\n         InterpretCx {\n             machine,\n             tcx,\n             param_env,\n-            memory: Memory::new(tcx),\n+            memory: Memory::new(tcx, memory_extra),\n             stack: Vec::new(),\n             vtables: FxHashMap::default(),\n         }"}, {"sha": "c06fdccf6cac6ca0ba9ebf0c1f253ad2c8f3457a", "filename": "src/librustc_mir/interpret/memory.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/e47553909650b4e4339e902eaa19c0fbdf3610ab/src%2Flibrustc_mir%2Finterpret%2Fmemory.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e47553909650b4e4339e902eaa19c0fbdf3610ab/src%2Flibrustc_mir%2Finterpret%2Fmemory.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Finterpret%2Fmemory.rs?ref=e47553909650b4e4339e902eaa19c0fbdf3610ab", "patch": "@@ -106,11 +106,11 @@ where\n }\n \n impl<'mir, 'tcx, M: Machine<'mir, 'tcx>> Memory<'mir, 'tcx, M> {\n-    pub fn new(tcx: TyCtxtAt<'tcx>) -> Self {\n+    pub fn new(tcx: TyCtxtAt<'tcx>, extra: M::MemoryExtra) -> Self {\n         Memory {\n             alloc_map: M::MemoryMap::default(),\n             dead_alloc_map: FxHashMap::default(),\n-            extra: M::MemoryExtra::default(),\n+            extra,\n             tcx,\n         }\n     }"}]}