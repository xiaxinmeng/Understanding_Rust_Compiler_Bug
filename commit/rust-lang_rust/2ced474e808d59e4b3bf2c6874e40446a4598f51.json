{"sha": "2ced474e808d59e4b3bf2c6874e40446a4598f51", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJjZWQ0NzRlODA4ZDU5ZTRiM2JmMmM2ODc0ZTQwNDQ2YTQ1OThmNTE=", "commit": {"author": {"name": "Ferdia McKeogh", "email": "ferdia@mckeogh.tech", "date": "2019-07-15T17:45:51Z"}, "committer": {"name": "Ferdia McKeogh", "email": "ferdia@mckeogh.tech", "date": "2019-07-16T05:53:30Z"}, "message": "Check that trait is exported or public before adding intercrate ambiguity hint", "tree": {"sha": "9b2cfef3517d23804b9d629abb468b114e90697e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9b2cfef3517d23804b9d629abb468b114e90697e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2ced474e808d59e4b3bf2c6874e40446a4598f51", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEuT+BMYQxiclgroA1ODOxEDk5O5oFAl0tZloACgkQODOxEDk5\nO5rr8w/+JwiErNeX+WRiItTdysAKcdep8jiP/zHw0dwMOTHkqwZJ1PMruG2X2s3g\nkeG3g2jdO1fRnMFm46lqzfvZP6IS+dpS2CaDfkjz5rdR8eXQX4Wz/OmD2guLRX0Y\n3rFtg1eSr5MqiivBWVE3ilBhZ68sSIvbbmlMvVhb6lzPsmmTy8UyR6AABkz1ZA1a\nkZhlp0d/t/3T8GTE9Gr0Sf67sCgPVAVBN2nQkqC9cd1HrfJBISKdiL0negQuxUuy\n77CtOwrB7NPSkMu9tDW03E93/BPhazouA9s0TgJ/aB4XRrqcaot1t/rTYgE7+u1j\nH/F0CoUfbc47cJJHWKVykGvyUZWSoaHwcvjFQ7AEotkDMgSCHJvIjQ6oim61jgxf\n8UaUMYkIbbkfl6pYg2sQKMOpDsPdgiewWJLTeNTlPI3gbLYLacLzLmhI9roFSwW7\noP+82I5j8Wvcv1sZdEu43+mVcnAmhTURCnLYtFS6U5HWTHbz+cdf2HoDS9gwAeOB\ng66sIf2rgFwwtt4Oc/LsqGAd5dFK5AkxN1brTO5pDUd7I6nlTdlxDcDu1ZbJpdZv\nI2y74QSuC/HFEoNXO3os4NObBQiXn+37B/zQWxRdUbzVSkLGDp3h7Vii2bpwGvZD\nYoQzQ0/lefTfLhhs4MDFywaGSugW7QzQBNF+4n/xlngoO38Nzro=\n=0/xM\n-----END PGP SIGNATURE-----", "payload": "tree 9b2cfef3517d23804b9d629abb468b114e90697e\nparent 4b65a86ebace8600c8e269e8bfe3365cdc460e68\nauthor Ferdia McKeogh <ferdia@mckeogh.tech> 1563212751 +0200\ncommitter Ferdia McKeogh <ferdia@mckeogh.tech> 1563256410 +0200\n\nCheck that trait is exported or public before adding intercrate ambiguity hint\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2ced474e808d59e4b3bf2c6874e40446a4598f51", "html_url": "https://github.com/rust-lang/rust/commit/2ced474e808d59e4b3bf2c6874e40446a4598f51", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2ced474e808d59e4b3bf2c6874e40446a4598f51/comments", "author": {"login": "fmckeogh", "id": 8290136, "node_id": "MDQ6VXNlcjgyOTAxMzY=", "avatar_url": "https://avatars.githubusercontent.com/u/8290136?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmckeogh", "html_url": "https://github.com/fmckeogh", "followers_url": "https://api.github.com/users/fmckeogh/followers", "following_url": "https://api.github.com/users/fmckeogh/following{/other_user}", "gists_url": "https://api.github.com/users/fmckeogh/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmckeogh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmckeogh/subscriptions", "organizations_url": "https://api.github.com/users/fmckeogh/orgs", "repos_url": "https://api.github.com/users/fmckeogh/repos", "events_url": "https://api.github.com/users/fmckeogh/events{/privacy}", "received_events_url": "https://api.github.com/users/fmckeogh/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fmckeogh", "id": 8290136, "node_id": "MDQ6VXNlcjgyOTAxMzY=", "avatar_url": "https://avatars.githubusercontent.com/u/8290136?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fmckeogh", "html_url": "https://github.com/fmckeogh", "followers_url": "https://api.github.com/users/fmckeogh/followers", "following_url": "https://api.github.com/users/fmckeogh/following{/other_user}", "gists_url": "https://api.github.com/users/fmckeogh/gists{/gist_id}", "starred_url": "https://api.github.com/users/fmckeogh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fmckeogh/subscriptions", "organizations_url": "https://api.github.com/users/fmckeogh/orgs", "repos_url": "https://api.github.com/users/fmckeogh/repos", "events_url": "https://api.github.com/users/fmckeogh/events{/privacy}", "received_events_url": "https://api.github.com/users/fmckeogh/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4b65a86ebace8600c8e269e8bfe3365cdc460e68", "url": "https://api.github.com/repos/rust-lang/rust/commits/4b65a86ebace8600c8e269e8bfe3365cdc460e68", "html_url": "https://github.com/rust-lang/rust/commit/4b65a86ebace8600c8e269e8bfe3365cdc460e68"}], "stats": {"total": 28, "additions": 6, "deletions": 22}, "files": [{"sha": "9027d330a90f6bf5a964048bcadbc22a5a53bd63", "filename": "src/librustc/traits/specialize/mod.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Flibrustc%2Ftraits%2Fspecialize%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Flibrustc%2Ftraits%2Fspecialize%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Ftraits%2Fspecialize%2Fmod.rs?ref=2ced474e808d59e4b3bf2c6874e40446a4598f51", "patch": "@@ -366,8 +366,12 @@ pub(super) fn specialization_graph_provider(\n                     }\n                 }\n \n-                for cause in &overlap.intercrate_ambiguity_causes {\n-                    cause.add_intercrate_ambiguity_hint(&mut err);\n+                let access_levels = tcx.privacy_access_levels(impl_def_id.krate);\n+                let id = tcx.hir().as_local_hir_id(impl_def_id).unwrap();\n+                if access_levels.is_exported(id) || access_levels.is_public(id) {\n+                    for cause in &overlap.intercrate_ambiguity_causes {\n+                        cause.add_intercrate_ambiguity_hint(&mut err);\n+                    }\n                 }\n \n                 if overlap.involves_placeholder {"}, {"sha": "dea948ff8abbb2f3d48439f34e8e8ae342b543ca", "filename": "src/test/ui/coherence/coherence-overlap-upstream.old.stderr", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fcoherence%2Fcoherence-overlap-upstream.old.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fcoherence%2Fcoherence-overlap-upstream.old.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcoherence%2Fcoherence-overlap-upstream.old.stderr?ref=2ced474e808d59e4b3bf2c6874e40446a4598f51", "patch": "@@ -5,8 +5,6 @@ LL | impl<T> Foo for T where T: Remote {}\n    | --------------------------------- first implementation here\n LL | impl Foo for i16 {}\n    | ^^^^^^^^^^^^^^^^ conflicting implementation for `i16`\n-   |\n-   = note: upstream crates may add new impl of trait `coherence_lib::Remote` for type `i16` in future versions\n \n error: aborting due to previous error\n "}, {"sha": "dea948ff8abbb2f3d48439f34e8e8ae342b543ca", "filename": "src/test/ui/coherence/coherence-overlap-upstream.re.stderr", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fcoherence%2Fcoherence-overlap-upstream.re.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fcoherence%2Fcoherence-overlap-upstream.re.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcoherence%2Fcoherence-overlap-upstream.re.stderr?ref=2ced474e808d59e4b3bf2c6874e40446a4598f51", "patch": "@@ -5,8 +5,6 @@ LL | impl<T> Foo for T where T: Remote {}\n    | --------------------------------- first implementation here\n LL | impl Foo for i16 {}\n    | ^^^^^^^^^^^^^^^^ conflicting implementation for `i16`\n-   |\n-   = note: upstream crates may add new impl of trait `coherence_lib::Remote` for type `i16` in future versions\n \n error: aborting due to previous error\n "}, {"sha": "0ec4f0bb8e74dbb66a598cf1d4a99ca72f671069", "filename": "src/test/ui/coherence/coherence_copy_like_err_fundamental_struct_tuple.old.stderr", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_fundamental_struct_tuple.old.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_fundamental_struct_tuple.old.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_fundamental_struct_tuple.old.stderr?ref=2ced474e808d59e4b3bf2c6874e40446a4598f51", "patch": "@@ -6,8 +6,6 @@ LL | impl<T: lib::MyCopy> MyTrait for T { }\n ...\n LL | impl MyTrait for lib::MyFundamentalStruct<(MyType,)> { }\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ conflicting implementation for `lib::MyFundamentalStruct<(MyType,)>`\n-   |\n-   = note: upstream crates may add new impl of trait `lib::MyCopy` for type `lib::MyFundamentalStruct<(MyType,)>` in future versions\n \n error: aborting due to previous error\n "}, {"sha": "0ec4f0bb8e74dbb66a598cf1d4a99ca72f671069", "filename": "src/test/ui/coherence/coherence_copy_like_err_fundamental_struct_tuple.re.stderr", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_fundamental_struct_tuple.re.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_fundamental_struct_tuple.re.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_fundamental_struct_tuple.re.stderr?ref=2ced474e808d59e4b3bf2c6874e40446a4598f51", "patch": "@@ -6,8 +6,6 @@ LL | impl<T: lib::MyCopy> MyTrait for T { }\n ...\n LL | impl MyTrait for lib::MyFundamentalStruct<(MyType,)> { }\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ conflicting implementation for `lib::MyFundamentalStruct<(MyType,)>`\n-   |\n-   = note: upstream crates may add new impl of trait `lib::MyCopy` for type `lib::MyFundamentalStruct<(MyType,)>` in future versions\n \n error: aborting due to previous error\n "}, {"sha": "e5862fdda7c58ffb08bdd15d35c9c413cc923599", "filename": "src/test/ui/coherence/coherence_copy_like_err_struct.old.stderr", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_struct.old.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_struct.old.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_struct.old.stderr?ref=2ced474e808d59e4b3bf2c6874e40446a4598f51", "patch": "@@ -6,8 +6,6 @@ LL | impl<T: lib::MyCopy> MyTrait for T { }\n ...\n LL | impl MyTrait for lib::MyStruct<MyType> { }\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ conflicting implementation for `lib::MyStruct<MyType>`\n-   |\n-   = note: upstream crates may add new impl of trait `lib::MyCopy` for type `lib::MyStruct<MyType>` in future versions\n \n error: aborting due to previous error\n "}, {"sha": "e5862fdda7c58ffb08bdd15d35c9c413cc923599", "filename": "src/test/ui/coherence/coherence_copy_like_err_struct.re.stderr", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_struct.re.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_struct.re.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_struct.re.stderr?ref=2ced474e808d59e4b3bf2c6874e40446a4598f51", "patch": "@@ -6,8 +6,6 @@ LL | impl<T: lib::MyCopy> MyTrait for T { }\n ...\n LL | impl MyTrait for lib::MyStruct<MyType> { }\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ conflicting implementation for `lib::MyStruct<MyType>`\n-   |\n-   = note: upstream crates may add new impl of trait `lib::MyCopy` for type `lib::MyStruct<MyType>` in future versions\n \n error: aborting due to previous error\n "}, {"sha": "a3c4ef8e105a2cfd62a4e3e89028c5ff64491d96", "filename": "src/test/ui/coherence/coherence_copy_like_err_tuple.old.stderr", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_tuple.old.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_tuple.old.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_tuple.old.stderr?ref=2ced474e808d59e4b3bf2c6874e40446a4598f51", "patch": "@@ -6,8 +6,6 @@ LL | impl<T: lib::MyCopy> MyTrait for T { }\n ...\n LL | impl MyTrait for (MyType,) { }\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^ conflicting implementation for `(MyType,)`\n-   |\n-   = note: upstream crates may add new impl of trait `lib::MyCopy` for type `(MyType,)` in future versions\n \n error: aborting due to previous error\n "}, {"sha": "a3c4ef8e105a2cfd62a4e3e89028c5ff64491d96", "filename": "src/test/ui/coherence/coherence_copy_like_err_tuple.re.stderr", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_tuple.re.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_tuple.re.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fcoherence%2Fcoherence_copy_like_err_tuple.re.stderr?ref=2ced474e808d59e4b3bf2c6874e40446a4598f51", "patch": "@@ -6,8 +6,6 @@ LL | impl<T: lib::MyCopy> MyTrait for T { }\n ...\n LL | impl MyTrait for (MyType,) { }\n    | ^^^^^^^^^^^^^^^^^^^^^^^^^^ conflicting implementation for `(MyType,)`\n-   |\n-   = note: upstream crates may add new impl of trait `lib::MyCopy` for type `(MyType,)` in future versions\n \n error: aborting due to previous error\n "}, {"sha": "777e1fc9c27ea2f5f3cf263466213ad9464ec8ff", "filename": "src/test/ui/issues/issue-48728.stderr", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fissues%2Fissue-48728.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fissues%2Fissue-48728.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-48728.stderr?ref=2ced474e808d59e4b3bf2c6874e40446a4598f51", "patch": "@@ -6,8 +6,6 @@ LL | #[derive(Clone)]\n ...\n LL | impl<T: Clone + ?Sized> Clone for Node<[T]> {\n    | ------------------------------------------- first implementation here\n-   |\n-   = note: upstream crates may add new impl of trait `std::clone::Clone` for type `[_]` in future versions\n \n error: aborting due to previous error\n "}, {"sha": "583c580d341ba720ac98b2397bc44283f1bfa43d", "filename": "src/test/ui/specialization/issue-52050.stderr", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fspecialization%2Fissue-52050.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/2ced474e808d59e4b3bf2c6874e40446a4598f51/src%2Ftest%2Fui%2Fspecialization%2Fissue-52050.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fspecialization%2Fissue-52050.stderr?ref=2ced474e808d59e4b3bf2c6874e40446a4598f51", "patch": "@@ -10,8 +10,6 @@ LL | | }\n LL | \n LL |   impl IntoPyDictPointer for ()\n    |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ conflicting implementation for `()`\n-   |\n-   = note: upstream crates may add new impl of trait `std::iter::Iterator` for type `()` in future versions\n \n error: aborting due to previous error\n "}]}