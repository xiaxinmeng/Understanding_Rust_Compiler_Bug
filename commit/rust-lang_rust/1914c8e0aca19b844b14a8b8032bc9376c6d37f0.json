{"sha": "1914c8e0aca19b844b14a8b8032bc9376c6d37f0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE5MTRjOGUwYWNhMTliODQ0YjE0YThiODAzMmJjOTM3NmM2ZDM3ZjA=", "commit": {"author": {"name": "Jorge Aparicio", "email": "japaricious@gmail.com", "date": "2017-02-06T19:12:56Z"}, "committer": {"name": "Jorge Aparicio", "email": "japaricious@gmail.com", "date": "2017-02-08T23:51:43Z"}, "message": "dist-x86-linux: install newer kernel headers", "tree": {"sha": "ce83274d475963baf1833d106e0a310c43ea177d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ce83274d475963baf1833d106e0a310c43ea177d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1914c8e0aca19b844b14a8b8032bc9376c6d37f0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1914c8e0aca19b844b14a8b8032bc9376c6d37f0", "html_url": "https://github.com/rust-lang/rust/commit/1914c8e0aca19b844b14a8b8032bc9376c6d37f0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1914c8e0aca19b844b14a8b8032bc9376c6d37f0/comments", "author": null, "committer": null, "parents": [{"sha": "47ae2393e63e0d78118262b70245d34b8c8ba929", "url": "https://api.github.com/repos/rust-lang/rust/commits/47ae2393e63e0d78118262b70245d34b8c8ba929", "html_url": "https://github.com/rust-lang/rust/commit/47ae2393e63e0d78118262b70245d34b8c8ba929"}], "stats": {"total": 30, "additions": 30, "deletions": 0}, "files": [{"sha": "a06e47c3bc92201e92474f80eb2e108f86ff63ef", "filename": "src/ci/docker/dist-x86-linux/Dockerfile", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/1914c8e0aca19b844b14a8b8032bc9376c6d37f0/src%2Fci%2Fdocker%2Fdist-x86-linux%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/1914c8e0aca19b844b14a8b8032bc9376c6d37f0/src%2Fci%2Fdocker%2Fdist-x86-linux%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-x86-linux%2FDockerfile?ref=1914c8e0aca19b844b14a8b8032bc9376c6d37f0", "patch": "@@ -63,6 +63,11 @@ RUN ./build-git.sh\n COPY build-cmake.sh /tmp/\n RUN ./build-cmake.sh\n \n+# for sanitizers, we need kernel headers files newer than the ones CentOS ships\n+# with so we install newer ones here\n+COPY build-headers.sh /tmp/\n+RUN ./build-headers.sh\n+\n RUN curl -Lo /rustroot/dumb-init \\\n       https://github.com/Yelp/dumb-init/releases/download/v1.2.0/dumb-init_1.2.0_amd64 && \\\n       chmod +x /rustroot/dumb-init"}, {"sha": "4ce38fd9205e27b4aff8b169f4ead5c31f731993", "filename": "src/ci/docker/dist-x86-linux/build-headers.sh", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/1914c8e0aca19b844b14a8b8032bc9376c6d37f0/src%2Fci%2Fdocker%2Fdist-x86-linux%2Fbuild-headers.sh", "raw_url": "https://github.com/rust-lang/rust/raw/1914c8e0aca19b844b14a8b8032bc9376c6d37f0/src%2Fci%2Fdocker%2Fdist-x86-linux%2Fbuild-headers.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-x86-linux%2Fbuild-headers.sh?ref=1914c8e0aca19b844b14a8b8032bc9376c6d37f0", "patch": "@@ -0,0 +1,25 @@\n+#!/bin/bash\n+# Copyright 2017 The Rust Project Developers. See the COPYRIGHT\n+# file at the top-level directory of this distribution and at\n+# http://rust-lang.org/COPYRIGHT.\n+#\n+# Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+# http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+# <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+# option. This file may not be copied, modified, or distributed\n+# except according to those terms.\n+\n+set -ex\n+source shared.sh\n+\n+curl https://cdn.kernel.org/pub/linux/kernel/v3.x/linux-3.2.84.tar.xz | unxz | tar x\n+\n+cd linux-3.2.84\n+hide_output make mrproper\n+hide_output make INSTALL_HDR_PATH=dest headers_install\n+\n+find dest/include \\( -name .install -o -name ..install.cmd \\) -delete\n+yes | cp -fr dest/include/* /usr/include\n+\n+cd ..\n+rm -rf linux-3.2.84"}]}