{"sha": "004b885c0afe34d6f8e6649f1faa8bbef656172c", "node_id": "C_kwDOAAsO6NoAKDAwNGI4ODVjMGFmZTM0ZDZmOGU2NjQ5ZjFmYWE4YmJlZjY1NjE3MmM", "commit": {"author": {"name": "xFrednet", "email": "xFrednet@gmail.com", "date": "2022-12-15T11:42:08Z"}, "committer": {"name": "xFrednet", "email": "xFrednet@gmail.com", "date": "2022-12-15T12:01:02Z"}, "message": "rustc_tools_util: changelog and 0.3.0 release", "tree": {"sha": "d0e7f6dfcbbe597a34c7f741f88728f6293281f6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d0e7f6dfcbbe597a34c7f741f88728f6293281f6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/004b885c0afe34d6f8e6649f1faa8bbef656172c", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEwgBEOx3xlHwII7PG9cWdDmaeUwIFAmObDH4ACgkQ9cWdDmae\nUwK2axAAkoxQGxTPqUTn0o0fOQzli/xZ7/gv4W8/X6v2mfocublpWWyC5PKyyTaR\nXE8ukseUTs1H8Ost3XmXGSApI0gEc7Gm5lJuP2lJ01CQbAjPu73nZjNYM5vZ29sO\nFicLc96BkRb36smB+8Ptrd5AAZBRfSGjrsj58r8wMo8M7lfdcQ5UTdTh40+68Fss\ny3+0CJQaWfo4NEvqLI3TLxJPdruajgh2GXm1+Qe7HCktgs/zCvyUBMVXBxq32JIN\nkkBqkAkOOQFv6lOe08UCsB2bGIvVK/MW6+Ls9URdW3s4RAjW93wkxFjfK+bFSf2m\nEExOYrX50AfZXB5ACWk/FD8e6fFPm79R4axi7Ej/5aMtf7cIIhLHP+4eiszp8Rix\nSU0sAdjHHH5mu8IykwYJCWDFKLWpUqDp2Rsc2GIG1aLJ6l3pduQSFmjxn87dUESU\nvWBxr6DAZX6yN0scxrVYgURW8k5xwhDbVKsQtytDrdy7AealCnC3cYmFuhh0zQz7\nCtiZZqFtWgJBz+jCBUooNGvm9jM8bDo5Z9vVs2G2NMP+HGolsDapORYYYcmd+xCt\n+948xYyLZgNxgjYfLg8nDSbWdixxYziESNxRtFvS/ks5W6y3FzVyejmn4oAl4rW2\nn3+8guOUCY/v24b0wRq6s4MlW0krxtgLHol1WRk+a08QSwQrGcU=\n=of2I\n-----END PGP SIGNATURE-----", "payload": "tree d0e7f6dfcbbe597a34c7f741f88728f6293281f6\nparent aa66212e291cf6d726d58d139b7ab19631431bd5\nauthor xFrednet <xFrednet@gmail.com> 1671104528 +0100\ncommitter xFrednet <xFrednet@gmail.com> 1671105662 +0100\n\nrustc_tools_util: changelog and 0.3.0 release\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/004b885c0afe34d6f8e6649f1faa8bbef656172c", "html_url": "https://github.com/rust-lang/rust/commit/004b885c0afe34d6f8e6649f1faa8bbef656172c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/004b885c0afe34d6f8e6649f1faa8bbef656172c/comments", "author": {"login": "xFrednet", "id": 17087237, "node_id": "MDQ6VXNlcjE3MDg3MjM3", "avatar_url": "https://avatars.githubusercontent.com/u/17087237?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xFrednet", "html_url": "https://github.com/xFrednet", "followers_url": "https://api.github.com/users/xFrednet/followers", "following_url": "https://api.github.com/users/xFrednet/following{/other_user}", "gists_url": "https://api.github.com/users/xFrednet/gists{/gist_id}", "starred_url": "https://api.github.com/users/xFrednet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xFrednet/subscriptions", "organizations_url": "https://api.github.com/users/xFrednet/orgs", "repos_url": "https://api.github.com/users/xFrednet/repos", "events_url": "https://api.github.com/users/xFrednet/events{/privacy}", "received_events_url": "https://api.github.com/users/xFrednet/received_events", "type": "User", "site_admin": false}, "committer": {"login": "xFrednet", "id": 17087237, "node_id": "MDQ6VXNlcjE3MDg3MjM3", "avatar_url": "https://avatars.githubusercontent.com/u/17087237?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xFrednet", "html_url": "https://github.com/xFrednet", "followers_url": "https://api.github.com/users/xFrednet/followers", "following_url": "https://api.github.com/users/xFrednet/following{/other_user}", "gists_url": "https://api.github.com/users/xFrednet/gists{/gist_id}", "starred_url": "https://api.github.com/users/xFrednet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xFrednet/subscriptions", "organizations_url": "https://api.github.com/users/xFrednet/orgs", "repos_url": "https://api.github.com/users/xFrednet/repos", "events_url": "https://api.github.com/users/xFrednet/events{/privacy}", "received_events_url": "https://api.github.com/users/xFrednet/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "aa66212e291cf6d726d58d139b7ab19631431bd5", "url": "https://api.github.com/repos/rust-lang/rust/commits/aa66212e291cf6d726d58d139b7ab19631431bd5", "html_url": "https://github.com/rust-lang/rust/commit/aa66212e291cf6d726d58d139b7ab19631431bd5"}], "stats": {"total": 31, "additions": 19, "deletions": 12}, "files": [{"sha": "4400f4c0aadb3b5f3c31d3491d5482612ed163e0", "filename": "Cargo.toml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/004b885c0afe34d6f8e6649f1faa8bbef656172c/Cargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/004b885c0afe34d6f8e6649f1faa8bbef656172c/Cargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.toml?ref=004b885c0afe34d6f8e6649f1faa8bbef656172c", "patch": "@@ -23,7 +23,7 @@ path = \"src/driver.rs\"\n [dependencies]\n clippy_lints = { path = \"clippy_lints\" }\n semver = \"1.0\"\n-rustc_tools_util = {version = \"0.2.1\", path = \"./rustc_tools_util\"}\n+rustc_tools_util = \"0.3.0\"\n tempfile = { version = \"3.2\", optional = true }\n termize = \"0.1\"\n \n@@ -56,7 +56,7 @@ tokio = { version = \"1\", features = [\"io-util\"] }\n rustc-semver = \"1.1\"\n \n [build-dependencies]\n-rustc_tools_util = {version = \"0.2.1\", path = \"./rustc_tools_util\"}\n+rustc_tools_util = \"0.3.0\"\n \n [features]\n deny-warnings = [\"clippy_lints/deny-warnings\"]"}, {"sha": "1b351da2e7bceecb8f1985da3ad0a2cfe772e563", "filename": "rustc_tools_util/CHANGELOG.md", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/004b885c0afe34d6f8e6649f1faa8bbef656172c/rustc_tools_util%2FCHANGELOG.md", "raw_url": "https://github.com/rust-lang/rust/raw/004b885c0afe34d6f8e6649f1faa8bbef656172c/rustc_tools_util%2FCHANGELOG.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/rustc_tools_util%2FCHANGELOG.md?ref=004b885c0afe34d6f8e6649f1faa8bbef656172c", "patch": "@@ -0,0 +1,6 @@\n+# Changelog\n+\n+## Version 0.3.0\n+\n+* Added `setup_version_info!();` macro for automated scripts.\n+* `get_version_info!()` no longer requires the user to import `rustc_tools_util::VersionInfo` and `std::env`"}, {"sha": "877049ae7d0ebd92d8d11d95698f89ded3698a93", "filename": "rustc_tools_util/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/004b885c0afe34d6f8e6649f1faa8bbef656172c/rustc_tools_util%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/004b885c0afe34d6f8e6649f1faa8bbef656172c/rustc_tools_util%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/rustc_tools_util%2FCargo.toml?ref=004b885c0afe34d6f8e6649f1faa8bbef656172c", "patch": "@@ -1,6 +1,6 @@\n [package]\n name = \"rustc_tools_util\"\n-version = \"0.2.1\"\n+version = \"0.3.0\"\n description = \"small helper to generate version information for git packages\"\n repository = \"https://github.com/rust-lang/rust-clippy\"\n readme = \"README.md\""}, {"sha": "eefc661f96352e04d182fe016702674df122880f", "filename": "rustc_tools_util/README.md", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/004b885c0afe34d6f8e6649f1faa8bbef656172c/rustc_tools_util%2FREADME.md", "raw_url": "https://github.com/rust-lang/rust/raw/004b885c0afe34d6f8e6649f1faa8bbef656172c/rustc_tools_util%2FREADME.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/rustc_tools_util%2FREADME.md?ref=004b885c0afe34d6f8e6649f1faa8bbef656172c", "patch": "@@ -13,10 +13,10 @@ build = \"build.rs\"\n List rustc_tools_util as regular AND build dependency.\n ````toml\n [dependencies]\n-rustc_tools_util = \"0.2.1\"\n+rustc_tools_util = \"0.3.0\"\n \n [build-dependencies]\n-rustc_tools_util = \"0.2.1\"\n+rustc_tools_util = \"0.3.0\"\n ````\n \n In `build.rs`, generate the data in your `main()`\n@@ -44,6 +44,9 @@ This gives the following output in clippy:\n This project is part of the rust-lang/rust-clippy repository. The source code\n can be found under `./rustc_tools_util/`.\n \n+The changelog for `rustc_tools_util` is available under:\n+[`rustc_tools_util/CHANGELOG.md`](https://github.com/rust-lang/rust-clippy/blob/master/rustc_tools_util/CHANGELOG.md)\n+\n ## License\n \n Copyright 2014-2022 The Rust Project Developers"}, {"sha": "4c1d8c3733df61b97582e3780118d9b2446b8de7", "filename": "rustc_tools_util/src/lib.rs", "status": "modified", "additions": 5, "deletions": 7, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/004b885c0afe34d6f8e6649f1faa8bbef656172c/rustc_tools_util%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/004b885c0afe34d6f8e6649f1faa8bbef656172c/rustc_tools_util%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/rustc_tools_util%2Fsrc%2Flib.rs?ref=004b885c0afe34d6f8e6649f1faa8bbef656172c", "patch": "@@ -1,7 +1,5 @@\n #![cfg_attr(feature = \"deny-warnings\", deny(warnings))]\n \n-use std::env;\n-\n /// This macro creates the version string during compilation from the\n /// current environment\n #[macro_export]\n@@ -121,7 +119,7 @@ pub fn get_commit_date() -> Option<String> {\n \n #[must_use]\n pub fn get_channel() -> String {\n-    match env::var(\"CFG_RELEASE_CHANNEL\") {\n+    match std::env::var(\"CFG_RELEASE_CHANNEL\") {\n         Ok(channel) => channel,\n         Err(_) => {\n             // if that failed, try to ask rustc -V, do some parsing and find out\n@@ -156,8 +154,8 @@ mod test {\n     fn test_struct_local() {\n         let vi = get_version_info!();\n         assert_eq!(vi.major, 0);\n-        assert_eq!(vi.minor, 2);\n-        assert_eq!(vi.patch, 1);\n+        assert_eq!(vi.minor, 3);\n+        assert_eq!(vi.patch, 0);\n         assert_eq!(vi.crate_name, \"rustc_tools_util\");\n         // hard to make positive tests for these since they will always change\n         assert!(vi.commit_hash.is_none());\n@@ -167,7 +165,7 @@ mod test {\n     #[test]\n     fn test_display_local() {\n         let vi = get_version_info!();\n-        assert_eq!(vi.to_string(), \"rustc_tools_util 0.2.1\");\n+        assert_eq!(vi.to_string(), \"rustc_tools_util 0.3.0\");\n     }\n \n     #[test]\n@@ -176,7 +174,7 @@ mod test {\n         let s = format!(\"{vi:?}\");\n         assert_eq!(\n             s,\n-            \"VersionInfo { crate_name: \\\"rustc_tools_util\\\", major: 0, minor: 2, patch: 1 }\"\n+            \"VersionInfo { crate_name: \\\"rustc_tools_util\\\", major: 0, minor: 3, patch: 0 }\"\n         );\n     }\n }"}]}