{"sha": "d0695c9081b16077d0aed368bccaf437d77ff497", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQwNjk1YzkwODFiMTYwNzdkMGFlZDM2OGJjY2FmNDM3ZDc3ZmY0OTc=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-04-12T18:29:25Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-04-12T18:29:25Z"}, "message": "Auto merge of #83776 - jyn514:update-stdarch-docs, r=Amanieu\n\nUpdate stdarch submodule (to before it switched to const generics)\n\nhttps://github.com/rust-lang/rust/pull/83278#issuecomment-812389823: This unblocks #82539.\n\nMajor changes:\n- More AVX-512 intrinsics.\n- More ARM & AArch64 NEON intrinsics.\n- Updated unstable WASM intrinsics to latest draft standards.\n- std_detect is now a separate crate instead of a submodule of std.\n\nI double-checked and the first use of const generics looks like https://github.com/rust-lang/stdarch/commit/8d5017861ed594a2baf169e632379862d516e013, which isn't included in this PR.\n\nr? `@Amanieu`", "tree": {"sha": "e502b113ff2c7ff88e2f5f29b23eace25b85886c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e502b113ff2c7ff88e2f5f29b23eace25b85886c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d0695c9081b16077d0aed368bccaf437d77ff497", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d0695c9081b16077d0aed368bccaf437d77ff497", "html_url": "https://github.com/rust-lang/rust/commit/d0695c9081b16077d0aed368bccaf437d77ff497", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d0695c9081b16077d0aed368bccaf437d77ff497/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1284da34da56a17ae368e4673920ec4120562cbd", "url": "https://api.github.com/repos/rust-lang/rust/commits/1284da34da56a17ae368e4673920ec4120562cbd", "html_url": "https://github.com/rust-lang/rust/commit/1284da34da56a17ae368e4673920ec4120562cbd"}, {"sha": "1b0b7e95be5f0da032ddd35226792ca469c21684", "url": "https://api.github.com/repos/rust-lang/rust/commits/1b0b7e95be5f0da032ddd35226792ca469c21684", "html_url": "https://github.com/rust-lang/rust/commit/1b0b7e95be5f0da032ddd35226792ca469c21684"}], "stats": {"total": 43, "additions": 26, "deletions": 17}, "files": [{"sha": "8fec4bf128f7ea0a74cccd5baac84cf79eaecec4", "filename": "Cargo.lock", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/d0695c9081b16077d0aed368bccaf437d77ff497/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/d0695c9081b16077d0aed368bccaf437d77ff497/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=d0695c9081b16077d0aed368bccaf437d77ff497", "patch": "@@ -5034,10 +5034,22 @@ dependencies = [\n  \"profiler_builtins\",\n  \"rand 0.7.3\",\n  \"rustc-demangle\",\n+ \"std_detect\",\n  \"unwind\",\n  \"wasi\",\n ]\n \n+[[package]]\n+name = \"std_detect\"\n+version = \"0.1.5\"\n+dependencies = [\n+ \"cfg-if 0.1.10\",\n+ \"compiler_builtins\",\n+ \"libc\",\n+ \"rustc-std-workspace-alloc\",\n+ \"rustc-std-workspace-core\",\n+]\n+\n [[package]]\n name = \"string_cache\"\n version = \"0.8.0\""}, {"sha": "02011357eac9bea2dfd8b351995d00fd05603faf", "filename": "Cargo.toml", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d0695c9081b16077d0aed368bccaf437d77ff497/Cargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/d0695c9081b16077d0aed368bccaf437d77ff497/Cargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.toml?ref=d0695c9081b16077d0aed368bccaf437d77ff497", "patch": "@@ -45,6 +45,8 @@ exclude = [\n   # not all `Cargo.toml` files are available, so we exclude the `x` binary,\n   # so it can be invoked before the current checkout is set up.\n   \"src/tools/x\",\n+  # stdarch has its own Cargo workspace\n+  \"library/stdarch\",\n ]\n \n [profile.release.package.compiler_builtins]"}, {"sha": "ab7b142ef3db099baee396619ae51edb20f418a6", "filename": "library/std/Cargo.toml", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/d0695c9081b16077d0aed368bccaf437d77ff497/library%2Fstd%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/d0695c9081b16077d0aed368bccaf437d77ff497/library%2Fstd%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2FCargo.toml?ref=d0695c9081b16077d0aed368bccaf437d77ff497", "patch": "@@ -21,6 +21,7 @@ compiler_builtins = { version = \"0.1.39\" }\n profiler_builtins = { path = \"../profiler_builtins\", optional = true }\n unwind = { path = \"../unwind\" }\n hashbrown = { version = \"0.11\", default-features = false, features = ['rustc-dep-of-std'] }\n+std_detect = { path = \"../stdarch/crates/std_detect\", default-features = false, features = ['rustc-dep-of-std'] }\n \n # Dependencies of the `backtrace` crate\n addr2line = { version = \"0.14.0\", optional = true, default-features = false }\n@@ -70,8 +71,8 @@ panic_immediate_abort = [\"core/panic_immediate_abort\"]\n \n # Enable std_detect default features for stdarch/crates/std_detect:\n # https://github.com/rust-lang/stdarch/blob/master/crates/std_detect/Cargo.toml\n-std_detect_file_io = []\n-std_detect_dlsym_getauxval = []\n+std_detect_file_io = [\"std_detect/std_detect_file_io\"]\n+std_detect_dlsym_getauxval = [\"std_detect/std_detect_dlsym_getauxval\"]\n \n [package.metadata.fortanix-sgx]\n # Maximum possible number of threads when testing"}, {"sha": "18ad2077d83dea4ba1811b28bfa2b41689d88465", "filename": "library/std/src/lib.rs", "status": "modified", "additions": 8, "deletions": 14, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/d0695c9081b16077d0aed368bccaf437d77ff497/library%2Fstd%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d0695c9081b16077d0aed368bccaf437d77ff497/library%2Fstd%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstd%2Fsrc%2Flib.rs?ref=d0695c9081b16077d0aed368bccaf437d77ff497", "patch": "@@ -538,22 +538,16 @@ pub mod rt;\n #[allow(dead_code, unused_attributes)]\n mod backtrace_rs;\n \n-// Pull in the `std_detect` crate directly into libstd. The contents of\n-// `std_detect` are in a different repository: rust-lang/stdarch.\n-//\n-// `std_detect` depends on libstd, but the contents of this module are\n-// set up in such a way that directly pulling it here works such that the\n-// crate uses the this crate as its libstd.\n-#[path = \"../../stdarch/crates/std_detect/src/mod.rs\"]\n-#[allow(missing_debug_implementations, missing_docs, dead_code)]\n-#[unstable(feature = \"stdsimd\", issue = \"48556\")]\n-#[cfg(not(test))]\n-mod std_detect;\n-\n+#[stable(feature = \"simd_x86\", since = \"1.27.0\")]\n+pub use std_detect::is_x86_feature_detected;\n #[doc(hidden)]\n #[unstable(feature = \"stdsimd\", issue = \"48556\")]\n-#[cfg(not(test))]\n-pub use std_detect::detect;\n+pub use std_detect::*;\n+#[unstable(feature = \"stdsimd\", issue = \"48556\")]\n+pub use std_detect::{\n+    is_aarch64_feature_detected, is_arm_feature_detected, is_mips64_feature_detected,\n+    is_mips_feature_detected, is_powerpc64_feature_detected, is_powerpc_feature_detected,\n+};\n \n // Re-export macros defined in libcore.\n #[stable(feature = \"rust1\", since = \"1.0.0\")]"}, {"sha": "19f5459dd0f89e466b7bcaa0f69ecca90f21a4d1", "filename": "library/stdarch", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": null, "raw_url": null, "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Fstdarch?ref=d0695c9081b16077d0aed368bccaf437d77ff497", "patch": "@@ -1 +1 @@\n-Subproject commit 9c732a56f67f54d12a0b4fd99993154906c95ea6\n+Subproject commit 19f5459dd0f89e466b7bcaa0f69ecca90f21a4d1"}]}