{"sha": "c40fa3271a939ee34662482052be64929978ca6a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM0MGZhMzI3MWE5MzllZTM0NjYyNDgyMDUyYmU2NDkyOTk3OGNhNmE=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2019-02-04T11:38:26Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2019-02-04T11:38:26Z"}, "message": "sort elements in the sidebar", "tree": {"sha": "5070e4816b0a31cb7b74ce870c95fbe20d290b9d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5070e4816b0a31cb7b74ce870c95fbe20d290b9d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c40fa3271a939ee34662482052be64929978ca6a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c40fa3271a939ee34662482052be64929978ca6a", "html_url": "https://github.com/rust-lang/rust/commit/c40fa3271a939ee34662482052be64929978ca6a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c40fa3271a939ee34662482052be64929978ca6a/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "19f8958f827e379be9b0ffc93fca580ec8ffac77", "url": "https://api.github.com/repos/rust-lang/rust/commits/19f8958f827e379be9b0ffc93fca580ec8ffac77", "html_url": "https://github.com/rust-lang/rust/commit/19f8958f827e379be9b0ffc93fca580ec8ffac77"}], "stats": {"total": 156, "additions": 84, "deletions": 72}, "files": [{"sha": "c4c3b635b59e0f70fb9cf361a2b4926f0d7545d7", "filename": "src/librustdoc/html/render.rs", "status": "modified", "additions": 84, "deletions": 72, "changes": 156, "blob_url": "https://github.com/rust-lang/rust/blob/c40fa3271a939ee34662482052be64929978ca6a/src%2Flibrustdoc%2Fhtml%2Frender.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c40fa3271a939ee34662482052be64929978ca6a/src%2Flibrustdoc%2Fhtml%2Frender.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender.rs?ref=c40fa3271a939ee34662482052be64929978ca6a", "patch": "@@ -4470,15 +4470,17 @@ fn sidebar_assoc_items(it: &clean::Item) -> String {\n \n         {\n             let used_links_bor = Rc::new(RefCell::new(&mut used_links));\n-            let ret = v.iter()\n-                       .filter(|i| i.inner_impl().trait_.is_none())\n-                       .flat_map(move |i| get_methods(i.inner_impl(),\n-                                                      false,\n-                                                      &mut used_links_bor.borrow_mut()))\n-                       .collect::<String>();\n+            let mut ret = v.iter()\n+                           .filter(|i| i.inner_impl().trait_.is_none())\n+                           .flat_map(move |i| get_methods(i.inner_impl(),\n+                                                          false,\n+                                                          &mut used_links_bor.borrow_mut()))\n+                           .collect::<Vec<_>>();\n+            // We want links' order to be reproducible so we don't use unstable sort.\n+            ret.sort();\n             if !ret.is_empty() {\n                 out.push_str(&format!(\"<a class=\\\"sidebar-title\\\" href=\\\"#methods\\\">Methods\\\n-                                       </a><div class=\\\"sidebar-links\\\">{}</div>\", ret));\n+                                       </a><div class=\\\"sidebar-links\\\">{}</div>\", ret.join(\"\")));\n             }\n         }\n \n@@ -4502,40 +4504,47 @@ fn sidebar_assoc_items(it: &clean::Item) -> String {\n                                                      impl_.inner_impl().trait_.as_ref().unwrap())),\n                                               Escape(&format!(\"{:#}\", target))));\n                         out.push_str(\"</a>\");\n-                        let ret = impls.iter()\n-                                       .filter(|i| i.inner_impl().trait_.is_none())\n-                                       .flat_map(|i| get_methods(i.inner_impl(),\n-                                                                 true,\n-                                                                 &mut used_links))\n-                                       .collect::<String>();\n-                        out.push_str(&format!(\"<div class=\\\"sidebar-links\\\">{}</div>\", ret));\n+                        let mut ret = impls.iter()\n+                                           .filter(|i| i.inner_impl().trait_.is_none())\n+                                           .flat_map(|i| get_methods(i.inner_impl(),\n+                                                                     true,\n+                                                                     &mut used_links))\n+                                           .collect::<Vec<_>>();\n+                        // We want links' order to be reproducible so we don't use unstable sort.\n+                        ret.sort();\n+                        if !ret.is_empty() {\n+                            out.push_str(&format!(\"<div class=\\\"sidebar-links\\\">{}</div>\",\n+                                                  ret.join(\"\")));\n+                        }\n                     }\n                 }\n             }\n             let format_impls = |impls: Vec<&Impl>| {\n                 let mut links = FxHashSet::default();\n \n-                impls.iter()\n-                     .filter_map(|i| {\n-                         let is_negative_impl = is_negative_impl(i.inner_impl());\n-                         if let Some(ref i) = i.inner_impl().trait_ {\n-                             let i_display = format!(\"{:#}\", i);\n-                             let out = Escape(&i_display);\n-                             let encoded = small_url_encode(&format!(\"{:#}\", i));\n-                             let generated = format!(\"<a href=\\\"#impl-{}\\\">{}{}</a>\",\n-                                                     encoded,\n-                                                     if is_negative_impl { \"!\" } else { \"\" },\n-                                                     out);\n-                             if links.insert(generated.clone()) {\n-                                 Some(generated)\n-                             } else {\n-                                 None\n-                             }\n-                         } else {\n-                             None\n-                         }\n-                     })\n-                     .collect::<String>()\n+                let mut ret = impls.iter()\n+                    .filter_map(|i| {\n+                        let is_negative_impl = is_negative_impl(i.inner_impl());\n+                        if let Some(ref i) = i.inner_impl().trait_ {\n+                            let i_display = format!(\"{:#}\", i);\n+                            let out = Escape(&i_display);\n+                            let encoded = small_url_encode(&format!(\"{:#}\", i));\n+                            let generated = format!(\"<a href=\\\"#impl-{}\\\">{}{}</a>\",\n+                                                    encoded,\n+                                                    if is_negative_impl { \"!\" } else { \"\" },\n+                                                    out);\n+                            if links.insert(generated.clone()) {\n+                                Some(generated)\n+                            } else {\n+                                None\n+                            }\n+                        } else {\n+                            None\n+                        }\n+                    })\n+                    .collect::<Vec<String>>();\n+                ret.sort();\n+                ret.join(\"\")\n             };\n \n             let (synthetic, concrete): (Vec<&Impl>, Vec<&Impl>) = v\n@@ -4637,29 +4646,29 @@ fn sidebar_trait(fmt: &mut fmt::Formatter, it: &clean::Item,\n                       }\n                   })\n                   .collect::<String>();\n-    let required = t.items\n-                    .iter()\n-                    .filter_map(|m| {\n-                        match m.name {\n-                            Some(ref name) if m.is_ty_method() => {\n-                                Some(format!(\"<a href=\\\"#tymethod.{name}\\\">{name}</a>\",\n-                                             name=name))\n+    let mut required = t.items\n+                        .iter()\n+                        .filter_map(|m| {\n+                            match m.name {\n+                                Some(ref name) if m.is_ty_method() => {\n+                                    Some(format!(\"<a href=\\\"#tymethod.{name}\\\">{name}</a>\",\n+                                                 name=name))\n+                                }\n+                                _ => None,\n                             }\n-                            _ => None,\n-                        }\n-                    })\n-                    .collect::<String>();\n-    let provided = t.items\n-                    .iter()\n-                    .filter_map(|m| {\n-                        match m.name {\n-                            Some(ref name) if m.is_method() => {\n-                                Some(format!(\"<a href=\\\"#method.{name}\\\">{name}</a>\", name=name))\n+                        })\n+                        .collect::<Vec<String>>();\n+    let mut provided = t.items\n+                        .iter()\n+                        .filter_map(|m| {\n+                            match m.name {\n+                                Some(ref name) if m.is_method() => {\n+                                    Some(format!(\"<a href=\\\"#method.{0}\\\">{0}</a>\", name))\n+                                }\n+                                _ => None,\n                             }\n-                            _ => None,\n-                        }\n-                    })\n-                    .collect::<String>();\n+                        })\n+                        .collect::<Vec<String>>();\n \n     if !types.is_empty() {\n         sidebar.push_str(&format!(\"<a class=\\\"sidebar-title\\\" href=\\\"#associated-types\\\">\\\n@@ -4672,38 +4681,41 @@ fn sidebar_trait(fmt: &mut fmt::Formatter, it: &clean::Item,\n                                   consts));\n     }\n     if !required.is_empty() {\n+        required.sort();\n         sidebar.push_str(&format!(\"<a class=\\\"sidebar-title\\\" href=\\\"#required-methods\\\">\\\n                                    Required Methods</a><div class=\\\"sidebar-links\\\">{}</div>\",\n-                                  required));\n+                                  required.join(\"\")));\n     }\n     if !provided.is_empty() {\n+        provided.sort();\n         sidebar.push_str(&format!(\"<a class=\\\"sidebar-title\\\" href=\\\"#provided-methods\\\">\\\n                                    Provided Methods</a><div class=\\\"sidebar-links\\\">{}</div>\",\n-                                  provided));\n+                                  provided.join(\"\")));\n     }\n \n     let c = cache();\n \n     if let Some(implementors) = c.implementors.get(&it.def_id) {\n-        let res = implementors.iter()\n-                              .filter(|i| i.inner_impl().for_.def_id()\n-                              .map_or(false, |d| !c.paths.contains_key(&d)))\n-                              .filter_map(|i| {\n-                                  match extract_for_impl_name(&i.impl_item) {\n-                                      Some((ref name, ref url)) => {\n-                                          Some(format!(\"<a href=\\\"#impl-{}\\\">{}</a>\",\n-                                                      small_url_encode(url),\n-                                                      Escape(name)))\n+        let mut res = implementors.iter()\n+                                  .filter(|i| i.inner_impl().for_.def_id()\n+                                  .map_or(false, |d| !c.paths.contains_key(&d)))\n+                                  .filter_map(|i| {\n+                                      match extract_for_impl_name(&i.impl_item) {\n+                                          Some((ref name, ref url)) => {\n+                                              Some(format!(\"<a href=\\\"#impl-{}\\\">{}</a>\",\n+                                                          small_url_encode(url),\n+                                                          Escape(name)))\n+                                          }\n+                                          _ => None,\n                                       }\n-                                      _ => None,\n-                                  }\n-                              })\n-                              .collect::<String>();\n+                                  })\n+                                  .collect::<Vec<String>>();\n         if !res.is_empty() {\n+            res.sort();\n             sidebar.push_str(&format!(\"<a class=\\\"sidebar-title\\\" href=\\\"#foreign-impls\\\">\\\n                                        Implementations on Foreign Types</a><div \\\n                                        class=\\\"sidebar-links\\\">{}</div>\",\n-                                      res));\n+                                      res.join(\"\")));\n         }\n     }\n "}]}