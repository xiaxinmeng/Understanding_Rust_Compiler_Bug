{"sha": "2638f3a8d70decebca840c4679e3efcba0808e8a", "node_id": "C_kwDOAAsO6NoAKDI2MzhmM2E4ZDcwZGVjZWJjYTg0MGM0Njc5ZTNlZmNiYTA4MDhlOGE", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-07-20T16:58:21Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-07-20T16:58:21Z"}, "message": "Rollup merge of #99510 - krasimirgg:movb, r=nikic\n\nadapt assembly/static-relocation-model test for LLVM change\n\nAfter https://github.com/llvm/llvm-project/commit/f0dd12ec5c0169ba5b4363b62d59511181cf954a LLVM emits `movzbl` instead. Adapted this test case accordingly.\n\nDiscovered in our experimental rust + llvm at head ci:\nhttps://buildkite.com/llvm-project/rust-llvm-integrate-prototype/builds/12104#0182195b-8791-4f88-853c-bb23a1e4b54c", "tree": {"sha": "7858cc190e277e9b9a69b949b051877c670922f0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7858cc190e277e9b9a69b949b051877c670922f0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2638f3a8d70decebca840c4679e3efcba0808e8a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJi2DQuCRBK7hj4Ov3rIwAA3i4IAG1E1J2QiGAm/5ekmKJzZp2d\nwJVTKb5Womd7hO/8iBUWl7U65QPNW0GqU4pumPdvG5zfwPd2hkTGQBx8GSUBkdu3\nHxY02QkZom3+D6n86bZ9nzA+SfGcBbAiV/9KkEqXFs/9pvxt6jIL37EzXAduVxie\nkrNDgdie86NNrvH07XLnBgtfOFv1I9K3bqPMlXsMJM0eE9MHnL8pnG+Wj1bOUXdi\nP4u+odWq8iRu1n+BdQk7XPEc3yH6ZUxDfLq9oEnydG3UqNvmcKcP6h/rN0npA0Mw\nIs5w0l3NE/8eVt0WW1dF5iIm7boJhRTaNNWp7tmwqt3s235LK20B6CC9yulxfcU=\n=MFcC\n-----END PGP SIGNATURE-----\n", "payload": "tree 7858cc190e277e9b9a69b949b051877c670922f0\nparent 4b21ad26df669705831d14a66cd37f2fa0655470\nparent dcd02ab683f502ded270ee59d8b8ac2dc33908a4\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1658336301 +0200\ncommitter GitHub <noreply@github.com> 1658336301 +0200\n\nRollup merge of #99510 - krasimirgg:movb, r=nikic\n\nadapt assembly/static-relocation-model test for LLVM change\n\nAfter https://github.com/llvm/llvm-project/commit/f0dd12ec5c0169ba5b4363b62d59511181cf954a LLVM emits `movzbl` instead. Adapted this test case accordingly.\n\nDiscovered in our experimental rust + llvm at head ci:\nhttps://buildkite.com/llvm-project/rust-llvm-integrate-prototype/builds/12104#0182195b-8791-4f88-853c-bb23a1e4b54c\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2638f3a8d70decebca840c4679e3efcba0808e8a", "html_url": "https://github.com/rust-lang/rust/commit/2638f3a8d70decebca840c4679e3efcba0808e8a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2638f3a8d70decebca840c4679e3efcba0808e8a/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4b21ad26df669705831d14a66cd37f2fa0655470", "url": "https://api.github.com/repos/rust-lang/rust/commits/4b21ad26df669705831d14a66cd37f2fa0655470", "html_url": "https://github.com/rust-lang/rust/commit/4b21ad26df669705831d14a66cd37f2fa0655470"}, {"sha": "dcd02ab683f502ded270ee59d8b8ac2dc33908a4", "url": "https://api.github.com/repos/rust-lang/rust/commits/dcd02ab683f502ded270ee59d8b8ac2dc33908a4", "html_url": "https://github.com/rust-lang/rust/commit/dcd02ab683f502ded270ee59d8b8ac2dc33908a4"}], "stats": {"total": 7, "additions": 4, "deletions": 3}, "files": [{"sha": "faa2e3952096dbe5571619770419b9fb385567b5", "filename": "src/test/assembly/static-relocation-model.rs", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/2638f3a8d70decebca840c4679e3efcba0808e8a/src%2Ftest%2Fassembly%2Fstatic-relocation-model.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2638f3a8d70decebca840c4679e3efcba0808e8a/src%2Ftest%2Fassembly%2Fstatic-relocation-model.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fassembly%2Fstatic-relocation-model.rs?ref=2638f3a8d70decebca840c4679e3efcba0808e8a", "patch": "@@ -36,7 +36,8 @@ extern \"C\" {\n }\n \n // CHECK-LABEL: banana:\n-// x64: movb   chaenomeles{{(\\(%[a-z0-9]+\\))?}}, %{{[a-z0-9]+}}\n+// On the next line LLVM 14 produces a `movb`, whereas LLVM 15+ produces a `movzbl`.\n+// x64: {{movb|movzbl}}   chaenomeles{{(\\(%[a-z0-9]+\\))?}}, %{{[a-z0-9]+}}\n // A64:      adrp    [[REG:[a-z0-9]+]], chaenomeles\n // A64-NEXT: ldrb    {{[a-z0-9]+}}, {{\\[}}[[REG]], :lo12:chaenomeles]\n #[no_mangle]\n@@ -47,7 +48,7 @@ pub fn banana() -> u8 {\n }\n \n // CHECK-LABEL: peach:\n-// x64: movb    banana{{(\\(%[a-z0-9]+\\))?}}, %{{[a-z0-9]+}}\n+// x64: {{movb|movzbl}}    banana{{(\\(%[a-z0-9]+\\))?}}, %{{[a-z0-9]+}}\n // A64:      adrp    [[REG2:[a-z0-9]+]], banana\n // A64-NEXT: ldrb    {{[a-z0-9]+}}, {{\\[}}[[REG2]], :lo12:banana]\n #[no_mangle]\n@@ -59,7 +60,7 @@ pub fn peach() -> u8 {\n \n // CHECK-LABEL: mango:\n // x64:      movq    EXOCHORDA{{(\\(%[a-z0-9]+\\))?}}, %[[REG:[a-z0-9]+]]\n-// x64-NEXT: movb    (%[[REG]]), %{{[a-z0-9]+}}\n+// x64-NEXT: {{movb|movzbl}}   (%[[REG]]), %{{[a-z0-9]+}}\n // A64:      adrp    [[REG2:[a-z0-9]+]], EXOCHORDA\n // A64-NEXT: ldr     {{[a-z0-9]+}}, {{\\[}}[[REG2]], :lo12:EXOCHORDA]\n #[no_mangle]"}]}