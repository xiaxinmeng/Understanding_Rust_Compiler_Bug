{"sha": "87df0f1fbecb7454db6ff35f97e724b7bf919848", "node_id": "C_kwDOAAsO6NoAKDg3ZGYwZjFmYmVjYjc0NTRkYjZmZjM1Zjk3ZTcyNGI3YmY5MTk4NDg", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2022-07-03T20:41:56Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-07-03T20:41:56Z"}, "message": "Rollup merge of #98773 - notriddle:notriddle/source-sidebar-details, r=GuillaumeGomez\n\nrustdoc: use <details> tag for the source code sidebar\n\nThis fixes the extremely poor accessibility of the old system, making it possible to navigate the sidebar by keyboard, and also implicitly gives the sidebar items the correct ARIA roles.\n\nSplit out separately from #98772", "tree": {"sha": "4a11518ad7998dc583bef528f6b2c3c6c6ea754d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4a11518ad7998dc583bef528f6b2c3c6c6ea754d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/87df0f1fbecb7454db6ff35f97e724b7bf919848", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJiwf8UCRBK7hj4Ov3rIwAAOBYIAJO3VSJxPkeWEJO0FJFiGcbT\n5qpoq0gsusue1xHzLi7jBzg5oxI1AgX2D6GShNRGNFCn0saqp1c6HiPwkWvB67Zo\n0W2UaCxiRUBh3uPsaulJ4V/WbePwLIiRJUur4t3MRE5nfXIspoVminGBQxJUSl1L\nwnieht6CG8StAUADyRNutRK6aqNpiPmbIXwwV85rj6iy+FxmJyH9Go7Dvq4Nzj5n\neXFmfSi3rVRy8arZvEVBdAG4dRCOASdEzhEQjvCofrij4G5t7GzwTlmYHFGZx2L5\nisJK8zzoG1CDTXObgk9hRwKAGTNhvszhpWjLuCwVgC74v0/dF9GKDKLRkDtoGlQ=\n=Zqo/\n-----END PGP SIGNATURE-----\n", "payload": "tree 4a11518ad7998dc583bef528f6b2c3c6c6ea754d\nparent b0d831a48675d54ae7ab9dea2a603c356b79d54b\nparent e710ac12fac9d650fb53b27259332cabdc9416f5\nauthor Ralf Jung <post@ralfj.de> 1656880916 -0400\ncommitter GitHub <noreply@github.com> 1656880916 -0400\n\nRollup merge of #98773 - notriddle:notriddle/source-sidebar-details, r=GuillaumeGomez\n\nrustdoc: use <details> tag for the source code sidebar\n\nThis fixes the extremely poor accessibility of the old system, making it possible to navigate the sidebar by keyboard, and also implicitly gives the sidebar items the correct ARIA roles.\n\nSplit out separately from #98772\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/87df0f1fbecb7454db6ff35f97e724b7bf919848", "html_url": "https://github.com/rust-lang/rust/commit/87df0f1fbecb7454db6ff35f97e724b7bf919848", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/87df0f1fbecb7454db6ff35f97e724b7bf919848/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b0d831a48675d54ae7ab9dea2a603c356b79d54b", "url": "https://api.github.com/repos/rust-lang/rust/commits/b0d831a48675d54ae7ab9dea2a603c356b79d54b", "html_url": "https://github.com/rust-lang/rust/commit/b0d831a48675d54ae7ab9dea2a603c356b79d54b"}, {"sha": "e710ac12fac9d650fb53b27259332cabdc9416f5", "url": "https://api.github.com/repos/rust-lang/rust/commits/e710ac12fac9d650fb53b27259332cabdc9416f5", "html_url": "https://github.com/rust-lang/rust/commit/e710ac12fac9d650fb53b27259332cabdc9416f5"}], "stats": {"total": 191, "additions": 105, "deletions": 86}, "files": [{"sha": "ebff1dc92eada25b1d42d4a7f48292df0d6707ac", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 11, "deletions": 26, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/87df0f1fbecb7454db6ff35f97e724b7bf919848/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/87df0f1fbecb7454db6ff35f97e724b7bf919848/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=87df0f1fbecb7454db6ff35f97e724b7bf919848", "patch": "@@ -1578,38 +1578,23 @@ kbd {\n \tmargin-bottom: 1em;\n }\n \n-div.children {\n-\tpadding-left: 27px;\n-\tdisplay: none;\n+details.dir-entry {\n+\tpadding-left: 4px;\n }\n-div.name {\n+\n+details.dir-entry > summary {\n+\tmargin: 0 0 0 13px;\n+\tlist-style-position: outside;\n \tcursor: pointer;\n-\tposition: relative;\n-\tmargin-left: 16px;\n }\n-div.files > a {\n-\tdisplay: block;\n-\tpadding: 0 3px;\n-}\n-div.files > a:hover, div.name:hover {\n-\tbackground-color: #a14b4b;\n+\n+details.dir-entry div.folders, details.dir-entry div.files {\n+\tpadding-left: 23px;\n }\n-div.name.expand + .children {\n+\n+details.dir-entry a {\n \tdisplay: block;\n }\n-div.name::before {\n-\tcontent: \"\\25B6\";\n-\tpadding-left: 4px;\n-\tfont-size: 0.625rem;\n-\tposition: absolute;\n-\tleft: -16px;\n-\ttop: 4px;\n-}\n-div.name.expand::before {\n-\ttransform: rotate(90deg);\n-\tleft: -15px;\n-\ttop: 2px;\n-}\n \n /* The hideme class is used on summary tags that contain a span with\n \tplaceholder text shown only when the toggle is closed. For instance,"}, {"sha": "b25f5e9fdb10ba8dbf4ab2f8297524f4fb1fc12c", "filename": "src/librustdoc/html/static/css/themes/ayu.css", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/87df0f1fbecb7454db6ff35f97e724b7bf919848/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "raw_url": "https://github.com/rust-lang/rust/raw/87df0f1fbecb7454db6ff35f97e724b7bf919848/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css?ref=87df0f1fbecb7454db6ff35f97e724b7bf919848", "patch": "@@ -575,11 +575,12 @@ kbd {\n \tcolor: #fff;\n \tborder-bottom-color: #5c6773;\n }\n-#source-sidebar div.files > a:hover, div.name:hover {\n+#source-sidebar div.files > a:hover, details.dir-entry summary:hover,\n+#source-sidebar div.files > a:focus, details.dir-entry summary:focus {\n \tbackground-color: #14191f;\n \tcolor: #ffb44c;\n }\n-#source-sidebar div.files > .selected {\n+#source-sidebar div.files > a.selected {\n \tbackground-color: #14191f;\n \tcolor: #ffb44c;\n }"}, {"sha": "a678ec1e1c1080cc0fe576c3f3f69a766f39a31f", "filename": "src/librustdoc/html/static/css/themes/dark.css", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/87df0f1fbecb7454db6ff35f97e724b7bf919848/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "raw_url": "https://github.com/rust-lang/rust/raw/87df0f1fbecb7454db6ff35f97e724b7bf919848/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fdark.css?ref=87df0f1fbecb7454db6ff35f97e724b7bf919848", "patch": "@@ -432,10 +432,11 @@ kbd {\n #source-sidebar > .title {\n \tborder-bottom-color: #ccc;\n }\n-#source-sidebar div.files > a:hover, div.name:hover {\n+#source-sidebar div.files > a:hover, details.dir-entry summary:hover,\n+#source-sidebar div.files > a:focus, details.dir-entry summary:focus {\n \tbackground-color: #444;\n }\n-#source-sidebar div.files > .selected {\n+#source-sidebar div.files > a.selected {\n \tbackground-color: #333;\n }\n "}, {"sha": "e8770ac212426d33b2b210f58a4cf86119041c2e", "filename": "src/librustdoc/html/static/css/themes/light.css", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/87df0f1fbecb7454db6ff35f97e724b7bf919848/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "raw_url": "https://github.com/rust-lang/rust/raw/87df0f1fbecb7454db6ff35f97e724b7bf919848/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Flight.css?ref=87df0f1fbecb7454db6ff35f97e724b7bf919848", "patch": "@@ -414,13 +414,13 @@ kbd {\n #source-sidebar > .title {\n \tborder-bottom-color: #ccc;\n }\n-#source-sidebar div.files > a:hover, div.name:hover {\n+#source-sidebar div.files > a:hover, details.dir-entry summary:hover,\n+#source-sidebar div.files > a:focus, details.dir-entry summary:focus {\n \tbackground-color: #E0E0E0;\n }\n-#source-sidebar div.files > .selected {\n+#source-sidebar div.files > a.selected {\n \tbackground-color: #fff;\n }\n-\n .scraped-example-list .scrape-help {\n \tborder-color: #555;\n \tcolor: #333;"}, {"sha": "9173e93e7c804151f587ebf745590b13966b981d", "filename": "src/librustdoc/html/static/js/source-script.js", "status": "modified", "additions": 12, "deletions": 19, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/87df0f1fbecb7454db6ff35f97e724b7bf919848/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsource-script.js", "raw_url": "https://github.com/rust-lang/rust/raw/87df0f1fbecb7454db6ff35f97e724b7bf919848/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsource-script.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fjs%2Fsource-script.js?ref=87df0f1fbecb7454db6ff35f97e724b7bf919848", "patch": "@@ -2,7 +2,7 @@\n /* global sourcesIndex */\n \n // Local js definitions:\n-/* global addClass, getCurrentValue, hasClass, onEachLazy, removeClass, browserSupportsHistoryApi */\n+/* global addClass, getCurrentValue, onEachLazy, removeClass, browserSupportsHistoryApi */\n /* global updateLocalStorage */\n \n \"use strict\";\n@@ -13,33 +13,27 @@ const rootPath = document.getElementById(\"rustdoc-vars\").attributes[\"data-root-p\n let oldScrollPosition = 0;\n \n function createDirEntry(elem, parent, fullPath, hasFoundFile) {\n-    const name = document.createElement(\"div\");\n-    name.className = \"name\";\n+    const dirEntry = document.createElement(\"details\");\n+    const summary = document.createElement(\"summary\");\n+\n+    dirEntry.className = \"dir-entry\";\n \n     fullPath += elem[\"name\"] + \"/\";\n \n-    name.onclick = ev => {\n-        if (hasClass(ev.target, \"expand\")) {\n-            removeClass(ev.target, \"expand\");\n-        } else {\n-            addClass(ev.target, \"expand\");\n-        }\n-    };\n-    name.innerText = elem[\"name\"];\n+    summary.innerText = elem[\"name\"];\n+    dirEntry.appendChild(summary);\n \n-    const children = document.createElement(\"div\");\n-    children.className = \"children\";\n     const folders = document.createElement(\"div\");\n     folders.className = \"folders\";\n     if (elem.dirs) {\n         for (const dir of elem.dirs) {\n             if (createDirEntry(dir, folders, fullPath, hasFoundFile)) {\n-                addClass(name, \"expand\");\n+                dirEntry.open = true;\n                 hasFoundFile = true;\n             }\n         }\n     }\n-    children.appendChild(folders);\n+    dirEntry.appendChild(folders);\n \n     const files = document.createElement(\"div\");\n     files.className = \"files\";\n@@ -51,15 +45,14 @@ function createDirEntry(elem, parent, fullPath, hasFoundFile) {\n             const w = window.location.href.split(\"#\")[0];\n             if (!hasFoundFile && w === file.href) {\n                 file.className = \"selected\";\n-                addClass(name, \"expand\");\n+                dirEntry.open = true;\n                 hasFoundFile = true;\n             }\n             files.appendChild(file);\n         }\n     }\n-    children.appendChild(files);\n-    parent.appendChild(name);\n-    parent.appendChild(children);\n+    dirEntry.appendChild(files);\n+    parent.appendChild(dirEntry);\n     return hasFoundFile;\n }\n "}, {"sha": "edcd98dfd937f242514eb4d2f9e7c2c8dc111205", "filename": "src/test/rustdoc-gui/sidebar-source-code-display.goml", "status": "modified", "additions": 63, "deletions": 21, "changes": 84, "blob_url": "https://github.com/rust-lang/rust/blob/87df0f1fbecb7454db6ff35f97e724b7bf919848/src%2Ftest%2Frustdoc-gui%2Fsidebar-source-code-display.goml", "raw_url": "https://github.com/rust-lang/rust/raw/87df0f1fbecb7454db6ff35f97e724b7bf919848/src%2Ftest%2Frustdoc-gui%2Fsidebar-source-code-display.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsidebar-source-code-display.goml?ref=87df0f1fbecb7454db6ff35f97e724b7bf919848", "patch": "@@ -27,29 +27,43 @@ reload:\n // Waiting for the sidebar to be displayed...\n wait-for-css: (\"#sidebar-toggle\", {\"visibility\": \"visible\", \"opacity\": 1})\n assert-css: (\n-    \"#source-sidebar .expand + .children a.selected\",\n+    \"#source-sidebar details[open] > .files a.selected\",\n     {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(255, 255, 255)\"},\n )\n // Without hover.\n assert-css: (\n-    \"#source-sidebar .expand + .children > .files a:not(.selected)\",\n+    \"#source-sidebar details[open] > .files a:not(.selected)\",\n     {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n )\n+// With focus.\n+focus: \"#source-sidebar details[open] > .files a:not(.selected)\"\n+wait-for-css: (\n+    \"#source-sidebar details[open] > .files a:not(.selected)\",\n+    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(224, 224, 224)\"},\n+)\n+focus: \".search-input\"\n // With hover.\n-move-cursor-to: \"#source-sidebar .expand + .children > .files a:not(.selected)\"\n+move-cursor-to: \"#source-sidebar details[open] > .files a:not(.selected)\"\n assert-css: (\n-    \"#source-sidebar .expand + .children > .files a:not(.selected)\",\n+    \"#source-sidebar details[open] > .files a:not(.selected)\",\n     {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(224, 224, 224)\"},\n )\n // Without hover.\n assert-css: (\n-    \"#source-sidebar .expand + .children .folders .name\",\n+    \"#source-sidebar details[open] > .folders > details > summary\",\n     {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n )\n+// With focus.\n+focus: \"#source-sidebar details[open] > .folders > details > summary\"\n+wait-for-css: (\n+    \"#source-sidebar details[open] > .folders > details > summary\",\n+    {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(224, 224, 224)\"},\n+)\n+focus: \".search-input\"\n // With hover.\n-move-cursor-to: \"#source-sidebar .expand + .children .folders .name\"\n+move-cursor-to: \"#source-sidebar details[open] > .folders > details > summary\"\n assert-css: (\n-    \"#source-sidebar .expand + .children .folders .name\",\n+    \"#source-sidebar details[open] > .folders > details > summary\",\n     {\"color\": \"rgb(0, 0, 0)\", \"background-color\": \"rgb(224, 224, 224)\"},\n )\n \n@@ -59,29 +73,43 @@ reload:\n // Waiting for the sidebar to be displayed...\n wait-for-css: (\"#sidebar-toggle\", {\"visibility\": \"visible\", \"opacity\": 1})\n assert-css: (\n-    \"#source-sidebar .expand + .children a.selected\",\n+    \"#source-sidebar details[open] > .files > a.selected\",\n     {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(51, 51, 51)\"},\n )\n // Without hover.\n assert-css: (\n-    \"#source-sidebar .expand + .children > .files a:not(.selected)\",\n+    \"#source-sidebar details[open] > .files > a:not(.selected)\",\n     {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n )\n+// With focus.\n+focus: \"#source-sidebar details[open] > .files a:not(.selected)\"\n+wait-for-css: (\n+    \"#source-sidebar details[open] > .files a:not(.selected)\",\n+    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(68, 68, 68)\"},\n+)\n+focus: \".search-input\"\n // With hover.\n-move-cursor-to: \"#source-sidebar .expand + .children > .files a:not(.selected)\"\n+move-cursor-to: \"#source-sidebar details[open] > .files a:not(.selected)\"\n assert-css: (\n-    \"#source-sidebar .expand + .children > .files a:not(.selected)\",\n+    \"#source-sidebar details[open] > .files a:not(.selected)\",\n     {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(68, 68, 68)\"},\n )\n // Without hover.\n assert-css: (\n-    \"#source-sidebar .expand + .children .folders .name\",\n+    \"#source-sidebar details[open] > .folders > details > summary\",\n     {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n )\n+// With focus.\n+focus: \"#source-sidebar details[open] > .folders > details > summary\"\n+wait-for-css: (\n+    \"#source-sidebar details[open] > .folders > details > summary\",\n+    {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(68, 68, 68)\"},\n+)\n+focus: \".search-input\"\n // With hover.\n-move-cursor-to: \"#source-sidebar .expand + .children .folders .name\"\n+move-cursor-to: \"#source-sidebar details[open] > .folders > details > summary\"\n assert-css: (\n-    \"#source-sidebar .expand + .children .folders .name\",\n+    \"#source-sidebar details[open] > .folders > details > summary\",\n     {\"color\": \"rgb(221, 221, 221)\", \"background-color\": \"rgb(68, 68, 68)\"},\n )\n \n@@ -91,29 +119,43 @@ reload:\n // Waiting for the sidebar to be displayed...\n wait-for-css: (\"#sidebar-toggle\", {\"visibility\": \"visible\", \"opacity\": 1})\n assert-css: (\n-    \"#source-sidebar .expand + .children a.selected\",\n+    \"#source-sidebar details[open] > .files a.selected\",\n     {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n )\n // Without hover.\n assert-css: (\n-    \"#source-sidebar .expand + .children > .files a:not(.selected)\",\n+    \"#source-sidebar details[open] > .files a:not(.selected)\",\n     {\"color\": \"rgb(197, 197, 197)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n )\n+// With focus.\n+focus: \"#source-sidebar details[open] > .files a:not(.selected)\"\n+wait-for-css: (\n+    \"#source-sidebar details[open] > .files a:not(.selected)\",\n+    {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n+)\n+focus: \".search-input\"\n // With hover.\n-move-cursor-to: \"#source-sidebar .expand + .children > .files a:not(.selected)\"\n+move-cursor-to: \"#source-sidebar details[open] > .files a:not(.selected)\"\n assert-css: (\n-    \"#source-sidebar .expand + .children > .files a:not(.selected)\",\n+    \"#source-sidebar details[open] > .files a:not(.selected)\",\n     {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n )\n // Without hover.\n assert-css: (\n-    \"#source-sidebar .expand + .children .folders .name\",\n+    \"#source-sidebar details[open] > .folders > details > summary\",\n     {\"color\": \"rgb(197, 197, 197)\", \"background-color\": \"rgba(0, 0, 0, 0)\"},\n )\n+// With focus.\n+focus: \"#source-sidebar details[open] > .folders > details > summary\"\n+wait-for-css: (\n+    \"#source-sidebar details[open] > .folders > details > summary\",\n+    {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n+)\n+focus: \".search-input\"\n // With hover.\n-move-cursor-to: \"#source-sidebar .expand + .children .folders .name\"\n+move-cursor-to: \"#source-sidebar details[open] > .folders > details > summary\"\n assert-css: (\n-    \"#source-sidebar .expand + .children .folders .name\",\n+    \"#source-sidebar details[open] > .folders > details > summary\",\n     {\"color\": \"rgb(255, 180, 76)\", \"background-color\": \"rgb(20, 25, 31)\"},\n )\n "}, {"sha": "581f826a3d94d13625923bd6eb7a06316bb4a779", "filename": "src/test/rustdoc-gui/source-code-page.goml", "status": "modified", "additions": 10, "deletions": 13, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/87df0f1fbecb7454db6ff35f97e724b7bf919848/src%2Ftest%2Frustdoc-gui%2Fsource-code-page.goml", "raw_url": "https://github.com/rust-lang/rust/raw/87df0f1fbecb7454db6ff35f97e724b7bf919848/src%2Ftest%2Frustdoc-gui%2Fsource-code-page.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fsource-code-page.goml?ref=87df0f1fbecb7454db6ff35f97e724b7bf919848", "patch": "@@ -34,19 +34,16 @@ assert-document-property: ({\"URL\": \"/lib.rs.html\"}, ENDS_WITH)\n click: \"#sidebar-toggle\"\n assert: \".source-sidebar-expanded\"\n \n-// We check that the first entry of the sidebar is collapsed (which, for whatever reason,\n-// is number 2 and not 1...).\n-assert-attribute: (\"#source-sidebar .name:nth-child(2)\", {\"class\": \"name\"})\n-assert-text: (\"#source-sidebar .name:nth-child(2)\", \"implementors\")\n-// We also check its children are hidden too.\n-assert-css: (\"#source-sidebar .name:nth-child(2) + .children\", {\"display\": \"none\"})\n+// We check that the first entry of the sidebar is collapsed\n+assert-property: (\"#source-sidebar details:first-of-type\", {\"open\": \"false\"})\n+assert-text: (\"#source-sidebar details:first-of-type > summary\", \"implementors\")\n // We now click on it.\n-click: \"#source-sidebar .name:nth-child(2)\"\n-assert-attribute: (\"#source-sidebar .name:nth-child(2)\", {\"class\": \"name expand\"})\n-// Checking that its children are displayed as well.\n-assert-css: (\"#source-sidebar .name:nth-child(2) + .children\", {\"display\": \"block\"})\n+click: \"#source-sidebar details:first-of-type > summary\"\n+assert-property: (\"#source-sidebar details:first-of-type\", {\"open\": \"true\"})\n \n // And now we collapse it again.\n-click: \"#source-sidebar .name:nth-child(2)\"\n-assert-attribute: (\"#source-sidebar .name:nth-child(2)\", {\"class\": \"name\"})\n-assert-css: (\"#source-sidebar .name:nth-child(2) + .children\", {\"display\": \"none\"})\n+click: \"#source-sidebar details:first-of-type > summary\"\n+assert-property: (\"#source-sidebar details:first-of-type\", {\"open\": \"false\"})\n+\n+// Check the spacing.\n+assert-css: (\"#source-sidebar > details.dir-entry\", {\"padding-left\": \"4px\"})"}]}