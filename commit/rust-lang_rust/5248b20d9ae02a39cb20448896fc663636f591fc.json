{"sha": "5248b20d9ae02a39cb20448896fc663636f591fc", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUyNDhiMjBkOWFlMDJhMzljYjIwNDQ4ODk2ZmM2NjM2MzZmNTkxZmM=", "commit": {"author": {"name": "D\u00e1niel Buga", "email": "bugadani@gmail.com", "date": "2020-10-28T16:04:44Z"}, "committer": {"name": "D\u00e1niel Buga", "email": "bugadani@gmail.com", "date": "2020-10-28T16:22:10Z"}, "message": "Reuse memory", "tree": {"sha": "c196ff8955e3ce11837bd525af10dfd58029cf50", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c196ff8955e3ce11837bd525af10dfd58029cf50"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5248b20d9ae02a39cb20448896fc663636f591fc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5248b20d9ae02a39cb20448896fc663636f591fc", "html_url": "https://github.com/rust-lang/rust/commit/5248b20d9ae02a39cb20448896fc663636f591fc", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5248b20d9ae02a39cb20448896fc663636f591fc/comments", "author": {"login": "bugadani", "id": 977627, "node_id": "MDQ6VXNlcjk3NzYyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/977627?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bugadani", "html_url": "https://github.com/bugadani", "followers_url": "https://api.github.com/users/bugadani/followers", "following_url": "https://api.github.com/users/bugadani/following{/other_user}", "gists_url": "https://api.github.com/users/bugadani/gists{/gist_id}", "starred_url": "https://api.github.com/users/bugadani/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bugadani/subscriptions", "organizations_url": "https://api.github.com/users/bugadani/orgs", "repos_url": "https://api.github.com/users/bugadani/repos", "events_url": "https://api.github.com/users/bugadani/events{/privacy}", "received_events_url": "https://api.github.com/users/bugadani/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bugadani", "id": 977627, "node_id": "MDQ6VXNlcjk3NzYyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/977627?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bugadani", "html_url": "https://github.com/bugadani", "followers_url": "https://api.github.com/users/bugadani/followers", "following_url": "https://api.github.com/users/bugadani/following{/other_user}", "gists_url": "https://api.github.com/users/bugadani/gists{/gist_id}", "starred_url": "https://api.github.com/users/bugadani/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bugadani/subscriptions", "organizations_url": "https://api.github.com/users/bugadani/orgs", "repos_url": "https://api.github.com/users/bugadani/repos", "events_url": "https://api.github.com/users/bugadani/events{/privacy}", "received_events_url": "https://api.github.com/users/bugadani/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a21f3a76a9f5c1f7087e9aec6102889cb24a0b77", "url": "https://api.github.com/repos/rust-lang/rust/commits/a21f3a76a9f5c1f7087e9aec6102889cb24a0b77", "html_url": "https://github.com/rust-lang/rust/commit/a21f3a76a9f5c1f7087e9aec6102889cb24a0b77"}], "stats": {"total": 7, "additions": 5, "deletions": 2}, "files": [{"sha": "d332466160ce519821ba97303b73d3ae0fb6a2e9", "filename": "compiler/rustc_graphviz/src/lib.rs", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/5248b20d9ae02a39cb20448896fc663636f591fc/compiler%2Frustc_graphviz%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5248b20d9ae02a39cb20448896fc663636f591fc/compiler%2Frustc_graphviz%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_graphviz%2Fsrc%2Flib.rs?ref=5248b20d9ae02a39cb20448896fc663636f591fc", "patch": "@@ -653,13 +653,13 @@ where\n         writeln!(w, r#\"    edge[{}];\"#, content_attrs_str)?;\n     }\n \n+    let mut text = Vec::new();\n     for n in g.nodes().iter() {\n         write!(w, \"    \")?;\n         let id = g.node_id(n);\n \n         let escaped = &g.node_label(n).to_dot_string();\n \n-        let mut text = Vec::new();\n         write!(text, \"{}\", id.as_slice()).unwrap();\n \n         if !options.contains(&RenderOption::NoNodeLabels) {\n@@ -677,6 +677,8 @@ where\n \n         writeln!(text, \";\").unwrap();\n         w.write_all(&text[..])?;\n+\n+        text.clear();\n     }\n \n     for e in g.edges().iter() {\n@@ -687,7 +689,6 @@ where\n         let source_id = g.node_id(&source);\n         let target_id = g.node_id(&target);\n \n-        let mut text = Vec::new();\n         write!(text, \"{} -> {}\", source_id.as_slice(), target_id.as_slice()).unwrap();\n \n         if !options.contains(&RenderOption::NoEdgeLabels) {\n@@ -701,6 +702,8 @@ where\n \n         writeln!(text, \";\").unwrap();\n         w.write_all(&text[..])?;\n+\n+        text.clear();\n     }\n \n     writeln!(w, \"}}\")"}]}