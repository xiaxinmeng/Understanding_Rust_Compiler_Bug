{"sha": "a3b67fe43a2ae016992d9798ddea458632f90203", "node_id": "C_kwDOAAsO6NoAKGEzYjY3ZmU0M2EyYWUwMTY5OTJkOTc5OGRkZWE0NTg2MzJmOTAyMDM", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-09-21T19:25:49Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-09-21T19:25:49Z"}, "message": "Auto merge of #89103 - Mark-Simulacrum:migrate-2021, r=estebank\n\nMigrate in-tree crates to 2021\n\nThis replaces #89075 (cherry picking some of the commits from there), and closes #88637 and fixes #89074.\n\nIt excludes a migration of the library crates for now (see tidy diff) because we have some pending bugs around macro spans to fix there.\n\nI instrumented bootstrap during the migration to make sure all crates moved from 2018 to 2021 had the compatibility warnings applied first.\n\nOriginally, the intent was to support cargo fix --edition within bootstrap, but this proved fairly difficult to pull off. We'd need to architect the check functionality to support running cargo check and cargo fix within the same x.py invocation, and only resetting sysroots on check. Further, it was found that cargo fix doesn't behave too well with \"not quite workspaces\", such as Clippy which has several crates. Bootstrap runs with --manifest-path ... for all the tools, and this makes cargo fix only attempt migration for that crate. We can't use e.g. --workspace due to needing to maintain sysroots for different phases of compilation appropriately.\n\nIt is recommended to skip the mass migration of Cargo.toml's to 2021 for review purposes; you can also use `git diff d6cd2c6c877110748296760aefddc21a0ea1d316 -I'^edition = .20...$'` to ignore the edition = 2018/21 lines in the diff.", "tree": {"sha": "892a569e1162c497bb2cfdc9c9bb7104185139df", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/892a569e1162c497bb2cfdc9c9bb7104185139df"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a3b67fe43a2ae016992d9798ddea458632f90203", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a3b67fe43a2ae016992d9798ddea458632f90203", "html_url": "https://github.com/rust-lang/rust/commit/a3b67fe43a2ae016992d9798ddea458632f90203", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a3b67fe43a2ae016992d9798ddea458632f90203/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "44b8301c08acbb05b960fe0969174cad3cea5553", "url": "https://api.github.com/repos/rust-lang/rust/commits/44b8301c08acbb05b960fe0969174cad3cea5553", "html_url": "https://github.com/rust-lang/rust/commit/44b8301c08acbb05b960fe0969174cad3cea5553"}, {"sha": "1183371af17fb67317a9d860d3028db500a14ba7", "url": "https://api.github.com/repos/rust-lang/rust/commits/1183371af17fb67317a9d860d3028db500a14ba7", "html_url": "https://github.com/rust-lang/rust/commit/1183371af17fb67317a9d860d3028db500a14ba7"}], "stats": {"total": 0, "additions": 0, "deletions": 0}, "files": []}