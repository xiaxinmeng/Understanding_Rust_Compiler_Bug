{"sha": "6afb2c48d94255d73532f8b9d0dd028bf2112c12", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZhZmIyYzQ4ZDk0MjU1ZDczNTMyZjhiOWQwZGQwMjhiZjIxMTJjMTI=", "commit": {"author": {"name": "Corey Farwell", "email": "coreyf@rwell.org", "date": "2017-04-13T17:04:16Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2017-04-13T17:04:16Z"}, "message": "Rollup merge of #41266 - projektir:weak_docs_rc, r=alexcrichton\n\nUpdating docs for std::rc::Rc\n\nThe same changes as PR [#41240 ](https://github.com/rust-lang/rust/pull/41240), but for [`std::rc::Weak`](https://doc.rust-lang.org/std/rc/struct.Weak.html). At least, as far as I am aware, the Weak pointer is the same for both, and they're basically the same, just one is thread-safe and the other is not.\n\nr? @alexcrichton", "tree": {"sha": "1057c6802616a73b772a164a706aa8b8a0a7cbca", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/1057c6802616a73b772a164a706aa8b8a0a7cbca"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6afb2c48d94255d73532f8b9d0dd028bf2112c12", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6afb2c48d94255d73532f8b9d0dd028bf2112c12", "html_url": "https://github.com/rust-lang/rust/commit/6afb2c48d94255d73532f8b9d0dd028bf2112c12", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6afb2c48d94255d73532f8b9d0dd028bf2112c12/comments", "author": {"login": "frewsxcv", "id": 416575, "node_id": "MDQ6VXNlcjQxNjU3NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/416575?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frewsxcv", "html_url": "https://github.com/frewsxcv", "followers_url": "https://api.github.com/users/frewsxcv/followers", "following_url": "https://api.github.com/users/frewsxcv/following{/other_user}", "gists_url": "https://api.github.com/users/frewsxcv/gists{/gist_id}", "starred_url": "https://api.github.com/users/frewsxcv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frewsxcv/subscriptions", "organizations_url": "https://api.github.com/users/frewsxcv/orgs", "repos_url": "https://api.github.com/users/frewsxcv/repos", "events_url": "https://api.github.com/users/frewsxcv/events{/privacy}", "received_events_url": "https://api.github.com/users/frewsxcv/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6dfd8f6e12e94ca17009d641cff743a13a13285c", "url": "https://api.github.com/repos/rust-lang/rust/commits/6dfd8f6e12e94ca17009d641cff743a13a13285c", "html_url": "https://github.com/rust-lang/rust/commit/6dfd8f6e12e94ca17009d641cff743a13a13285c"}, {"sha": "f84cc0c0d0ff24e4cce5d05be3afd0347eb9d012", "url": "https://api.github.com/repos/rust-lang/rust/commits/f84cc0c0d0ff24e4cce5d05be3afd0347eb9d012", "html_url": "https://github.com/rust-lang/rust/commit/f84cc0c0d0ff24e4cce5d05be3afd0347eb9d012"}], "stats": {"total": 66, "additions": 33, "deletions": 33}, "files": [{"sha": "fed718e9be4c6aa6ec5eba5c7b184a23c34e47dc", "filename": "src/liballoc/rc.rs", "status": "modified", "additions": 33, "deletions": 33, "changes": 66, "blob_url": "https://github.com/rust-lang/rust/blob/6afb2c48d94255d73532f8b9d0dd028bf2112c12/src%2Fliballoc%2Frc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6afb2c48d94255d73532f8b9d0dd028bf2112c12/src%2Fliballoc%2Frc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Frc.rs?ref=6afb2c48d94255d73532f8b9d0dd028bf2112c12", "patch": "@@ -922,18 +922,29 @@ impl<T> From<T> for Rc<T> {\n     }\n }\n \n-/// A weak version of [`Rc`][rc].\n+/// `Weak` is a version of [`Rc`] that holds a non-owning reference to the\n+/// managed value. The value is accessed by calling [`upgrade`] on the `Weak`\n+/// pointer, which returns an [`Option`]`<`[`Rc`]`<T>>`.\n ///\n-/// `Weak` pointers do not count towards determining if the inner value\n-/// should be dropped.\n+/// Since a `Weak` reference does not count towards ownership, it will not\n+/// prevent the inner value from being dropped, and `Weak` itself makes no\n+/// guarantees about the value still being present and may return [`None`]\n+/// when [`upgrade`]d.\n ///\n-/// The typical way to obtain a `Weak` pointer is to call\n-/// [`Rc::downgrade`][downgrade].\n+/// A `Weak` pointer is useful for keeping a temporary reference to the value\n+/// within [`Rc`] without extending its lifetime. It is also used to prevent\n+/// circular references between [`Rc`] pointers, since mutual owning references\n+/// would never allow either [`Arc`] to be dropped. For example, a tree could\n+/// have strong [`Rc`] pointers from parent nodes to children, and `Weak`\n+/// pointers from children back to their parents.\n ///\n-/// See the [module-level documentation](./index.html) for more details.\n+/// The typical way to obtain a `Weak` pointer is to call [`Rc::downgrade`].\n ///\n-/// [rc]: struct.Rc.html\n-/// [downgrade]: struct.Rc.html#method.downgrade\n+/// [`Rc`]: struct.Rc.html\n+/// [`Rc::downgrade`]: struct.Rc.html#method.downgrade\n+/// [`upgrade`]: struct.Weak.html#method.upgrade\n+/// [`Option`]: ../../std/option/enum.Option.html\n+/// [`None`]: ../../std/option/enum.Option.html#variant.None\n #[stable(feature = \"rc_weak\", since = \"1.4.0\")]\n pub struct Weak<T: ?Sized> {\n     ptr: Shared<RcBox<T>>,\n@@ -948,14 +959,11 @@ impl<T: ?Sized> !marker::Sync for Weak<T> {}\n impl<T: ?Sized + Unsize<U>, U: ?Sized> CoerceUnsized<Weak<U>> for Weak<T> {}\n \n impl<T> Weak<T> {\n-    /// Constructs a new `Weak<T>`, without an accompanying instance of `T`.\n-    ///\n-    /// This allocates memory for `T`, but does not initialize it. Calling\n-    /// [`upgrade`][upgrade] on the return value always gives\n-    /// [`None`][option].\n+    /// Constructs a new `Weak<T>`, allocating memory for `T` without initializing\n+    /// it. Calling [`upgrade`] on the return value always gives [`None`].\n     ///\n-    /// [upgrade]: struct.Weak.html#method.upgrade\n-    /// [option]: ../../std/option/enum.Option.html\n+    /// [`upgrade`]: struct.Weak.html#method.upgrade\n+    /// [`None`]: ../../std/option/enum.Option.html\n     ///\n     /// # Examples\n     ///\n@@ -980,13 +988,13 @@ impl<T> Weak<T> {\n }\n \n impl<T: ?Sized> Weak<T> {\n-    /// Upgrades the `Weak` pointer to an [`Rc`][rc], if possible.\n+    /// Attempts to upgrade the `Weak` pointer to an [`Rc`], extending\n+    /// the lifetime of the value if successful.\n     ///\n-    /// Returns [`None`][option] if the strong count has reached zero and the\n-    /// inner value was destroyed.\n+    /// Returns [`None`] if the value has since been dropped.\n     ///\n-    /// [rc]: struct.Rc.html\n-    /// [option]: ../../std/option/enum.Option.html\n+    /// [`Rc`]: struct.Rc.html\n+    /// [`None`]: ../../std/option/enum.Option.html\n     ///\n     /// # Examples\n     ///\n@@ -1021,8 +1029,6 @@ impl<T: ?Sized> Weak<T> {\n impl<T: ?Sized> Drop for Weak<T> {\n     /// Drops the `Weak` pointer.\n     ///\n-    /// This will decrement the weak reference count.\n-    ///\n     /// # Examples\n     ///\n     /// ```\n@@ -1061,10 +1067,7 @@ impl<T: ?Sized> Drop for Weak<T> {\n \n #[stable(feature = \"rc_weak\", since = \"1.4.0\")]\n impl<T: ?Sized> Clone for Weak<T> {\n-    /// Makes a clone of the `Weak` pointer.\n-    ///\n-    /// This creates another pointer to the same inner value, increasing the\n-    /// weak reference count.\n+    /// Makes a clone of the `Weak` pointer that points to the same value.\n     ///\n     /// # Examples\n     ///\n@@ -1091,14 +1094,11 @@ impl<T: ?Sized + fmt::Debug> fmt::Debug for Weak<T> {\n \n #[stable(feature = \"downgraded_weak\", since = \"1.10.0\")]\n impl<T> Default for Weak<T> {\n-    /// Constructs a new `Weak<T>`, without an accompanying instance of `T`.\n-    ///\n-    /// This allocates memory for `T`, but does not initialize it. Calling\n-    /// [`upgrade`][upgrade] on the return value always gives\n-    /// [`None`][option].\n+    /// Constructs a new `Weak<T>`, allocating memory for `T` without initializing\n+    /// it. Calling [`upgrade`] on the return value always gives [`None`].\n     ///\n-    /// [upgrade]: struct.Weak.html#method.upgrade\n-    /// [option]: ../../std/option/enum.Option.html\n+    /// [`upgrade`]: struct.Weak.html#method.upgrade\n+    /// [`None`]: ../../std/option/enum.Option.html\n     ///\n     /// # Examples\n     ///"}]}