{"sha": "0de65441170292f243806e6239967ee85bff6c66", "node_id": "MDY6Q29tbWl0NzI0NzEyOjBkZTY1NDQxMTcwMjkyZjI0MzgwNmU2MjM5OTY3ZWU4NWJmZjZjNjY=", "commit": {"author": {"name": "Seiichi Uchida", "email": "seuchida@gmail.com", "date": "2018-02-04T06:36:26Z"}, "committer": {"name": "flip1995", "email": "uwdkn@student.kit.edu", "date": "2018-05-02T09:48:11Z"}, "message": "Change Attribute::name to return the last segment\n\nAnd fix some typos", "tree": {"sha": "4e45e295a52942e0fdc7074ea1f294418ed871e8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4e45e295a52942e0fdc7074ea1f294418ed871e8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0de65441170292f243806e6239967ee85bff6c66", "comment_count": 0, "verification": {"verified": false, "reason": "unverified_email", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz66kzxK9mXB0K2lyZ1erJvcvAIQFAlrpiVsACgkQZ1erJvcv\nAISaFg//Q4j1JRRpmMfkrYNjvzAjJF8Q55IoIRtKt7uN5Ou9deoHz7O7KVIOjQAw\nJ1neSYTd9XNrcyT0zgLYy/IFsU1ipzPh7ZcX22WcXV85P7hHyk4wWj0HOu5K9x2s\njHe0VecDzi9KkpOu2x5HavddDohL8FNlrwZB2h7fcyL4wSmK8V0EBWmP++PRGe6P\nZG3Do5gxHnTtRBgBitz0hxDakeRxvmx8Ve6aRlFoD+PBz8WebWVvoHCLgzBpmee7\niYaLWkRT0VwuaEg78VdaDuSrAJ9N7Qr/aTohX5oiLMjUfe8XDcX1YVRrS4gIXE7U\nU8lwXD2oQV+rS4kGT4eBL28Pl8Aoh4RKmZvRHu2g3jAUYftf2XoHGmj95UBuu8Q5\nVPT1KSCO1kajpoe+Bl3XGcgGTC+gWtDOO59XruVabFKLOjrnQvFQmKCbIonIXCLF\nH7s+ZeudIbmY3EltoFJRYQucMGXIszUbq8m8Zg513YO+K10H6og8YquuGz0KQXoL\neQ/pNGMp/RifcXfwHFReHK/I0wVBFdTv+PLj0YDiH3C1KEYPWwYXt8/XOUOCI/ku\n78NEc/ET9kcoZu9K3SB32aCy66fTCsfwWUFQCZhSvYaI7pOf+vsq44ubF6BUVOZC\nuUP+1Atl6W23b2pJ6/vjJPHNt6W865NXBitV/AeXtkifUOh6Puo=\n=6uNM\n-----END PGP SIGNATURE-----", "payload": "tree 4e45e295a52942e0fdc7074ea1f294418ed871e8\nparent 8ad2d21a9c83e1d764f208d5fffd18842033f432\nauthor Seiichi Uchida <seuchida@gmail.com> 1517726186 +0900\ncommitter flip1995 <uwdkn@student.kit.edu> 1525254491 +0200\n\nChange Attribute::name to return the last segment\n\nAnd fix some typos\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0de65441170292f243806e6239967ee85bff6c66", "html_url": "https://github.com/rust-lang/rust/commit/0de65441170292f243806e6239967ee85bff6c66", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0de65441170292f243806e6239967ee85bff6c66/comments", "author": {"login": "topecongiro", "id": 21980157, "node_id": "MDQ6VXNlcjIxOTgwMTU3", "avatar_url": "https://avatars.githubusercontent.com/u/21980157?v=4", "gravatar_id": "", "url": "https://api.github.com/users/topecongiro", "html_url": "https://github.com/topecongiro", "followers_url": "https://api.github.com/users/topecongiro/followers", "following_url": "https://api.github.com/users/topecongiro/following{/other_user}", "gists_url": "https://api.github.com/users/topecongiro/gists{/gist_id}", "starred_url": "https://api.github.com/users/topecongiro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/topecongiro/subscriptions", "organizations_url": "https://api.github.com/users/topecongiro/orgs", "repos_url": "https://api.github.com/users/topecongiro/repos", "events_url": "https://api.github.com/users/topecongiro/events{/privacy}", "received_events_url": "https://api.github.com/users/topecongiro/received_events", "type": "User", "site_admin": false}, "committer": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8ad2d21a9c83e1d764f208d5fffd18842033f432", "url": "https://api.github.com/repos/rust-lang/rust/commits/8ad2d21a9c83e1d764f208d5fffd18842033f432", "html_url": "https://github.com/rust-lang/rust/commit/8ad2d21a9c83e1d764f208d5fffd18842033f432"}], "stats": {"total": 17, "additions": 10, "deletions": 7}, "files": [{"sha": "8fa5f55490e3aa3ea3038591ec9b00ccae55d1a2", "filename": "src/libsyntax/attr.rs", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/0de65441170292f243806e6239967ee85bff6c66/src%2Flibsyntax%2Fattr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0de65441170292f243806e6239967ee85bff6c66/src%2Flibsyntax%2Fattr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fattr.rs?ref=0de65441170292f243806e6239967ee85bff6c66", "patch": "@@ -110,7 +110,9 @@ pub fn is_known(attr: &Attribute) -> bool {\n const RUST_KNOWN_TOOL: &[&str] = &[\"clippy\", \"rustfmt\"];\n \n pub fn is_known_tool(attr: &Attribute) -> bool {\n-    RUST_KNOWN_TOOL.contains(&attr.name().as_str().as_ref())\n+    let tool_name =\n+        attr.path.segments.iter().next().expect(\"empty path in attribute\").identifier.name;\n+    RUST_KNOWN_TOOL.contains(&tool_name.as_str().as_ref())\n }\n \n impl NestedMetaItem {\n@@ -211,7 +213,7 @@ impl NestedMetaItem {\n }\n \n fn name_from_path(path: &ast::Path) -> Name {\n-    path.segments.iter().next().unwrap().identifier.name\n+    path.segments.last().expect(\"empty path in attribute\").identifier.name\n }\n \n impl Attribute {\n@@ -223,8 +225,8 @@ impl Attribute {\n         matches\n     }\n \n-    /// Returns the first segment of the name of this attribute.\n-    /// E.g. `foo` for `#[foo]`, `rustfmt` for `#[rustfmt::skip]`.\n+    /// Returns the **last** segment of the name of this attribute.\n+    /// E.g. `foo` for `#[foo]`, `skip` for `#[rustfmt::skip]`.\n     pub fn name(&self) -> Name {\n         name_from_path(&self.path)\n     }\n@@ -1162,6 +1164,7 @@ impl MetaItem {\n     fn tokens(&self) -> TokenStream {\n         let mut idents = vec![];\n         let mut last_pos = BytePos(0 as u32);\n+        // FIXME: Share code with `parse_path`.\n         for (i, segment) in self.name.segments.iter().enumerate() {\n             let is_first = i == 0;\n             if !is_first {"}, {"sha": "0cb897917b44526d5175a403ef925c99f0aa3c2e", "filename": "src/test/compile-fail/unknown-tool-name.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/0de65441170292f243806e6239967ee85bff6c66/src%2Ftest%2Fcompile-fail%2Funknown-tool-name.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0de65441170292f243806e6239967ee85bff6c66/src%2Ftest%2Fcompile-fail%2Funknown-tool-name.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Funknown-tool-name.rs?ref=0de65441170292f243806e6239967ee85bff6c66", "patch": "@@ -10,7 +10,7 @@\n \n #![feature(tool_attributes)]\n \n-#![foo::bar] //~ ERROR An unkown tool name found in scoped attributes: `foo::bar`. [E0693]\n+#![foo::bar] //~ ERROR An unknown tool name found in scoped attributes: `foo::bar`. [E0693]\n \n-#[foo::bar] //~ ERROR An unkown tool name found in scoped attributes: `foo::bar`. [E0693]\n+#[foo::bar] //~ ERROR An unknown tool name found in scoped attributes: `foo::bar`. [E0693]\n fn main() {}"}, {"sha": "fbc46219461957a0e54759e9f7189660e727dd2d", "filename": "src/test/compile-fail/unknown_tool_attributes-1.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/0de65441170292f243806e6239967ee85bff6c66/src%2Ftest%2Fcompile-fail%2Funknown_tool_attributes-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0de65441170292f243806e6239967ee85bff6c66/src%2Ftest%2Fcompile-fail%2Funknown_tool_attributes-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Funknown_tool_attributes-1.rs?ref=0de65441170292f243806e6239967ee85bff6c66", "patch": "@@ -14,5 +14,5 @@\n \n #[foo::bar]\n //~^ ERROR scoped attribute `foo::bar` is experimental (see issue #44690) [E0658]\n-//~^^ ERROR An unkown tool name found in scoped attributes: `foo::bar`. [E0693]\n+//~^^ ERROR An unknown tool name found in scoped attributes: `foo::bar`. [E0693]\n fn main() {}"}]}