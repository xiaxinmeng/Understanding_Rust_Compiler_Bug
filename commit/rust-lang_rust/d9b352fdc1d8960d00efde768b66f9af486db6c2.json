{"sha": "d9b352fdc1d8960d00efde768b66f9af486db6c2", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ5YjM1MmZkYzFkODk2MGQwMGVmZGU3NjhiNjZmOWFmNDg2ZGI2YzI=", "commit": {"author": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2015-03-01T22:24:14Z"}, "committer": {"name": "Manish Goregaokar", "email": "manishsmail@gmail.com", "date": "2015-03-01T22:24:14Z"}, "message": "Rollup merge of #22923 - dotdash:trans_arg, r=eddyb\n\n The logic for the argument translation was duplicated here.", "tree": {"sha": "367505a751d84b062e25d4ccd6b2fc465b647311", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/367505a751d84b062e25d4ccd6b2fc465b647311"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d9b352fdc1d8960d00efde768b66f9af486db6c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d9b352fdc1d8960d00efde768b66f9af486db6c2", "html_url": "https://github.com/rust-lang/rust/commit/d9b352fdc1d8960d00efde768b66f9af486db6c2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d9b352fdc1d8960d00efde768b66f9af486db6c2/comments", "author": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Manishearth", "id": 1617736, "node_id": "MDQ6VXNlcjE2MTc3MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1617736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Manishearth", "html_url": "https://github.com/Manishearth", "followers_url": "https://api.github.com/users/Manishearth/followers", "following_url": "https://api.github.com/users/Manishearth/following{/other_user}", "gists_url": "https://api.github.com/users/Manishearth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Manishearth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Manishearth/subscriptions", "organizations_url": "https://api.github.com/users/Manishearth/orgs", "repos_url": "https://api.github.com/users/Manishearth/repos", "events_url": "https://api.github.com/users/Manishearth/events{/privacy}", "received_events_url": "https://api.github.com/users/Manishearth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "644b931437402d9e27606923bda4f63b7365d516", "url": "https://api.github.com/repos/rust-lang/rust/commits/644b931437402d9e27606923bda4f63b7365d516", "html_url": "https://github.com/rust-lang/rust/commit/644b931437402d9e27606923bda4f63b7365d516"}, {"sha": "708c3858e3e98d1b362b73510aa48416c3f68e51", "url": "https://api.github.com/repos/rust-lang/rust/commits/708c3858e3e98d1b362b73510aa48416c3f68e51", "html_url": "https://github.com/rust-lang/rust/commit/708c3858e3e98d1b362b73510aa48416c3f68e51"}], "stats": {"total": 21, "additions": 11, "deletions": 10}, "files": [{"sha": "78bfcdb7d3fcc0cfe612b06a92e7bdce26d70ad9", "filename": "src/librustc_trans/trans/callee.rs", "status": "modified", "additions": 11, "deletions": 10, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/d9b352fdc1d8960d00efde768b66f9af486db6c2/src%2Flibrustc_trans%2Ftrans%2Fcallee.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d9b352fdc1d8960d00efde768b66f9af486db6c2/src%2Flibrustc_trans%2Ftrans%2Fcallee.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Ftrans%2Fcallee.rs?ref=d9b352fdc1d8960d00efde768b66f9af486db6c2", "patch": "@@ -927,20 +927,21 @@ fn trans_args_under_call_abi<'blk, 'tcx>(\n                                                           tuple_expr.id));\n             let repr = adt::represent_type(bcx.ccx(), tuple_type);\n             let repr_ptr = &*repr;\n-            for i in 0..field_types.len() {\n+            llargs.extend(field_types.iter().enumerate().map(|(i, field_type)| {\n                 let arg_datum = tuple_lvalue_datum.get_element(\n                     bcx,\n-                    field_types[i],\n+                    field_type,\n                     |srcval| {\n                         adt::trans_field_ptr(bcx, repr_ptr, srcval, 0, i)\n-                    });\n-                let arg_datum = arg_datum.to_expr_datum();\n-                let arg_datum =\n-                    unpack_datum!(bcx, arg_datum.to_rvalue_datum(bcx, \"arg\"));\n-                let arg_datum =\n-                    unpack_datum!(bcx, arg_datum.to_appropriate_datum(bcx));\n-                llargs.push(arg_datum.add_clean(bcx.fcx, arg_cleanup_scope));\n-            }\n+                    }).to_expr_datum();\n+                unpack_result!(bcx, trans_arg_datum(\n+                    bcx,\n+                    field_type,\n+                    arg_datum,\n+                    arg_cleanup_scope,\n+                    DontAutorefArg)\n+                )\n+            }));\n         }\n         _ => {\n             bcx.sess().span_bug(tuple_expr.span,"}]}