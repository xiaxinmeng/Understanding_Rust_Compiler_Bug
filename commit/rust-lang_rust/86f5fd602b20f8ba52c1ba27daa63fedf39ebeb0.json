{"sha": "86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg2ZjVmZDYwMmIyMGY4YmE1MmMxYmEyN2RhYTYzZmVkZjM5ZWJlYjA=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2019-09-05T16:53:47Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-09-05T16:53:47Z"}, "message": "Merge #1767\n\n1767: better error recovery for use trees r=matklad a=matklad\n\n\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>", "tree": {"sha": "c9221ae272d625fce3751e86afe21e6a623e3b71", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c9221ae272d625fce3751e86afe21e6a623e3b71"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdcT2bCRBK7hj4Ov3rIwAAdHIIAA/+/ygS7WF/1jjwgGZXF0cS\n6mbIxnl5baad4qiOOWRNqGAD5RZTtxet3LCmPleb3c5Z5PcTRcB7xe1qDq/tkJsn\nzJDcEFaX8tWOkrNB0IfVokQ4QcCega2FzBUFAEP48LwGwLI6ekzKwjDIfbenpi/e\nTyNQ5w2jWmIWsxf7iBd5npoXvzckNUaw6vCXv5fYAuLZ/wNai7G2DEF+VYq7vtdX\nq8nFGG7z7R5YF42G9Xvae3SV5jO1T97YlrNIFlR6uSiym8uKNWxJMGHz/BPBxqoF\n5VnpSR2yCu8A8tpvBYCzUVYp9CYN1X9HAn6CXWeFT03W0NbHmlo+a1fbAT5/BOU=\n=JBaV\n-----END PGP SIGNATURE-----\n", "payload": "tree c9221ae272d625fce3751e86afe21e6a623e3b71\nparent edc2016f8b49964fa5b179c1ed8e12e4e0a39702\nparent b2be998b7b0beb48806cd3a1552e44100b12ddb6\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1567702427 +0000\ncommitter GitHub <noreply@github.com> 1567702427 +0000\n\nMerge #1767\n\n1767: better error recovery for use trees r=matklad a=matklad\n\n\n\nCo-authored-by: Aleksey Kladov <aleksey.kladov@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0", "html_url": "https://github.com/rust-lang/rust/commit/86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "edc2016f8b49964fa5b179c1ed8e12e4e0a39702", "url": "https://api.github.com/repos/rust-lang/rust/commits/edc2016f8b49964fa5b179c1ed8e12e4e0a39702", "html_url": "https://github.com/rust-lang/rust/commit/edc2016f8b49964fa5b179c1ed8e12e4e0a39702"}, {"sha": "b2be998b7b0beb48806cd3a1552e44100b12ddb6", "url": "https://api.github.com/repos/rust-lang/rust/commits/b2be998b7b0beb48806cd3a1552e44100b12ddb6", "html_url": "https://github.com/rust-lang/rust/commit/b2be998b7b0beb48806cd3a1552e44100b12ddb6"}], "stats": {"total": 68, "additions": 65, "deletions": 3}, "files": [{"sha": "b4327b78f4ac8cad2d3dc8f693e3d0631894a448", "filename": "crates/ra_parser/src/grammar/items.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fitems.rs?ref=86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0", "patch": "@@ -31,7 +31,7 @@ pub(super) enum ItemFlavor {\n \n pub(super) const ITEM_RECOVERY_SET: TokenSet = token_set![\n     FN_KW, STRUCT_KW, ENUM_KW, IMPL_KW, TRAIT_KW, CONST_KW, STATIC_KW, LET_KW, MOD_KW, PUB_KW,\n-    CRATE_KW\n+    CRATE_KW, USE_KW\n ];\n \n pub(super) fn item_or_macro(p: &mut Parser, stop_on_r_curly: bool, flavor: ItemFlavor) {"}, {"sha": "83a65e226595178c41beec3e4e0954dd9dc1e955", "filename": "crates/ra_parser/src/grammar/items/use_item.rs", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fitems%2Fuse_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fitems%2Fuse_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fitems%2Fuse_item.rs?ref=86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0", "patch": "@@ -101,7 +101,10 @@ fn use_tree(p: &mut Parser) {\n         }\n         _ => {\n             m.abandon(p);\n-            p.err_and_bump(\"expected one of `*`, `::`, `{`, `self`, `super` or an indentifier\");\n+            p.err_recover(\n+                \"expected one of `*`, `::`, `{`, `self`, `super` or an identifier\",\n+                ITEM_RECOVERY_SET,\n+            );\n             return;\n         }\n     }"}, {"sha": "bdb5fa6c5af223986c42cc462e7d4d3f922849d1", "filename": "crates/ra_syntax/test_data/parser/err/0002_duplicate_shebang.txt", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0/crates%2Fra_syntax%2Ftest_data%2Fparser%2Ferr%2F0002_duplicate_shebang.txt", "raw_url": "https://github.com/rust-lang/rust/raw/86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0/crates%2Fra_syntax%2Ftest_data%2Fparser%2Ferr%2F0002_duplicate_shebang.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Ferr%2F0002_duplicate_shebang.txt?ref=86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0", "patch": "@@ -28,7 +28,7 @@ SOURCE_FILE@[0; 42)\n   WHITESPACE@[41; 42) \"\\n\"\n error 23: expected `[`\n error 23: expected an item\n-error 27: expected one of `*`, `::`, `{`, `self`, `super` or an indentifier\n+error 27: expected one of `*`, `::`, `{`, `self`, `super` or an identifier\n error 28: expected SEMI\n error 31: expected EXCL\n error 31: expected `{`, `[`, `(`"}, {"sha": "4a266812628362e542a5977b6f425f22c56b8058", "filename": "crates/ra_syntax/test_data/parser/err/0035_use_recover.rs", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0/crates%2Fra_syntax%2Ftest_data%2Fparser%2Ferr%2F0035_use_recover.rs", "raw_url": "https://github.com/rust-lang/rust/raw/86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0/crates%2Fra_syntax%2Ftest_data%2Fparser%2Ferr%2F0035_use_recover.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Ferr%2F0035_use_recover.rs?ref=86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0", "patch": "@@ -0,0 +1,5 @@\n+use foo::bar;\n+use\n+use crate::baz;\n+use\n+fn f() {}"}, {"sha": "63684082881749ff257454935a0fc491599b14b7", "filename": "crates/ra_syntax/test_data/parser/err/0035_use_recover.txt", "status": "added", "additions": 54, "deletions": 0, "changes": 54, "blob_url": "https://github.com/rust-lang/rust/blob/86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0/crates%2Fra_syntax%2Ftest_data%2Fparser%2Ferr%2F0035_use_recover.txt", "raw_url": "https://github.com/rust-lang/rust/raw/86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0/crates%2Fra_syntax%2Ftest_data%2Fparser%2Ferr%2F0035_use_recover.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Ferr%2F0035_use_recover.txt?ref=86f5fd602b20f8ba52c1ba27daa63fedf39ebeb0", "patch": "@@ -0,0 +1,54 @@\n+SOURCE_FILE@[0; 48)\n+  USE_ITEM@[0; 13)\n+    USE_KW@[0; 3) \"use\"\n+    WHITESPACE@[3; 4) \" \"\n+    USE_TREE@[4; 12)\n+      PATH@[4; 12)\n+        PATH@[4; 7)\n+          PATH_SEGMENT@[4; 7)\n+            NAME_REF@[4; 7)\n+              IDENT@[4; 7) \"foo\"\n+        COLONCOLON@[7; 9) \"::\"\n+        PATH_SEGMENT@[9; 12)\n+          NAME_REF@[9; 12)\n+            IDENT@[9; 12) \"bar\"\n+    SEMI@[12; 13) \";\"\n+  WHITESPACE@[13; 14) \"\\n\"\n+  USE_ITEM@[14; 17)\n+    USE_KW@[14; 17) \"use\"\n+  WHITESPACE@[17; 18) \"\\n\"\n+  USE_ITEM@[18; 33)\n+    USE_KW@[18; 21) \"use\"\n+    WHITESPACE@[21; 22) \" \"\n+    USE_TREE@[22; 32)\n+      PATH@[22; 32)\n+        PATH@[22; 27)\n+          PATH_SEGMENT@[22; 27)\n+            CRATE_KW@[22; 27) \"crate\"\n+        COLONCOLON@[27; 29) \"::\"\n+        PATH_SEGMENT@[29; 32)\n+          NAME_REF@[29; 32)\n+            IDENT@[29; 32) \"baz\"\n+    SEMI@[32; 33) \";\"\n+  WHITESPACE@[33; 34) \"\\n\"\n+  USE_ITEM@[34; 37)\n+    USE_KW@[34; 37) \"use\"\n+  WHITESPACE@[37; 38) \"\\n\"\n+  FN_DEF@[38; 47)\n+    FN_KW@[38; 40) \"fn\"\n+    WHITESPACE@[40; 41) \" \"\n+    NAME@[41; 42)\n+      IDENT@[41; 42) \"f\"\n+    PARAM_LIST@[42; 44)\n+      L_PAREN@[42; 43) \"(\"\n+      R_PAREN@[43; 44) \")\"\n+    WHITESPACE@[44; 45) \" \"\n+    BLOCK_EXPR@[45; 47)\n+      BLOCK@[45; 47)\n+        L_CURLY@[45; 46) \"{\"\n+        R_CURLY@[46; 47) \"}\"\n+  WHITESPACE@[47; 48) \"\\n\"\n+error 17: expected one of `*`, `::`, `{`, `self`, `super` or an identifier\n+error 17: expected SEMI\n+error 37: expected one of `*`, `::`, `{`, `self`, `super` or an identifier\n+error 37: expected SEMI"}]}