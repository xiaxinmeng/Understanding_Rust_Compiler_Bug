{"sha": "d64d711db221e7959994e8fe22c6d8a975efcc4f", "node_id": "C_kwDOAAsO6NoAKGQ2NGQ3MTFkYjIyMWU3OTU5OTk0ZThmZTIyYzZkOGE5NzVlZmNjNGY", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-03-12T13:26:16Z"}, "committer": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-03-12T15:50:49Z"}, "message": "fix clippy::map_flatten", "tree": {"sha": "5b0e95a926c523f02b4c96f39fbc685aa283522b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5b0e95a926c523f02b4c96f39fbc685aa283522b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d64d711db221e7959994e8fe22c6d8a975efcc4f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d64d711db221e7959994e8fe22c6d8a975efcc4f", "html_url": "https://github.com/rust-lang/rust/commit/d64d711db221e7959994e8fe22c6d8a975efcc4f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d64d711db221e7959994e8fe22c6d8a975efcc4f/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "62ed658311a8ea35c5e6752c64e8b15e5f9ed19f", "url": "https://api.github.com/repos/rust-lang/rust/commits/62ed658311a8ea35c5e6752c64e8b15e5f9ed19f", "html_url": "https://github.com/rust-lang/rust/commit/62ed658311a8ea35c5e6752c64e8b15e5f9ed19f"}], "stats": {"total": 14, "additions": 6, "deletions": 8}, "files": [{"sha": "04171968431e16886371ffac1704e1fdf94f7974", "filename": "crates/hir/src/lib.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d64d711db221e7959994e8fe22c6d8a975efcc4f/crates%2Fhir%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d64d711db221e7959994e8fe22c6d8a975efcc4f/crates%2Fhir%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir%2Fsrc%2Flib.rs?ref=d64d711db221e7959994e8fe22c6d8a975efcc4f", "patch": "@@ -231,7 +231,7 @@ impl Crate {\n             return None;\n         }\n \n-        let doc_url = doc_attr_q.tt_values().map(|tt| {\n+        let doc_url = doc_attr_q.tt_values().filter_map(|tt| {\n             let name = tt.token_trees.iter()\n                 .skip_while(|tt| !matches!(tt, TokenTree::Leaf(Leaf::Ident(Ident { text, ..} )) if text == \"html_root_url\"))\n                 .nth(2);\n@@ -240,7 +240,7 @@ impl Crate {\n                 Some(TokenTree::Leaf(Leaf::Literal(Literal{ref text, ..}))) => Some(text),\n                 _ => None\n             }\n-        }).flatten().next();\n+        }).next();\n \n         doc_url.map(|s| s.trim_matches('\"').trim_end_matches('/').to_owned() + \"/\")\n     }"}, {"sha": "82f410ecda91d9d0c704dce00ed8efc4f99689d8", "filename": "crates/hir_expand/src/quote.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d64d711db221e7959994e8fe22c6d8a975efcc4f/crates%2Fhir_expand%2Fsrc%2Fquote.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d64d711db221e7959994e8fe22c6d8a975efcc4f/crates%2Fhir_expand%2Fsrc%2Fquote.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_expand%2Fsrc%2Fquote.rs?ref=d64d711db221e7959994e8fe22c6d8a975efcc4f", "patch": "@@ -261,7 +261,7 @@ mod tests {\n         // }\n         let struct_name = mk_ident(\"Foo\");\n         let fields = [mk_ident(\"name\"), mk_ident(\"id\")];\n-        let fields = fields.iter().map(|it| quote!(#it: self.#it.clone(), ).token_trees).flatten();\n+        let fields = fields.iter().flat_map(|it| quote!(#it: self.#it.clone(), ).token_trees);\n \n         let list = tt::Subtree {\n             delimiter: Some(tt::Delimiter {"}, {"sha": "8bfcf3beb87c88b5f1073cd515b615443329dbeb", "filename": "crates/ide/src/annotations.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d64d711db221e7959994e8fe22c6d8a975efcc4f/crates%2Fide%2Fsrc%2Fannotations.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d64d711db221e7959994e8fe22c6d8a975efcc4f/crates%2Fide%2Fsrc%2Fannotations.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide%2Fsrc%2Fannotations.rs?ref=d64d711db221e7959994e8fe22c6d8a975efcc4f", "patch": "@@ -170,10 +170,9 @@ pub(crate) fn resolve_annotation(db: &RootDatabase, mut annotation: Annotation)\n                 result\n                     .into_iter()\n                     .flat_map(|res| res.references)\n-                    .map(|(file_id, access)| {\n+                    .flat_map(|(file_id, access)| {\n                         access.into_iter().map(move |(range, _)| FileRange { file_id, range })\n                     })\n-                    .flatten()\n                     .collect()\n             });\n         }"}, {"sha": "a812c838acc38a955ae37c9c11f5c9ce8b9564cf", "filename": "crates/ide_db/src/symbol_index.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d64d711db221e7959994e8fe22c6d8a975efcc4f/crates%2Fide_db%2Fsrc%2Fsymbol_index.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d64d711db221e7959994e8fe22c6d8a975efcc4f/crates%2Fide_db%2Fsrc%2Fsymbol_index.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_db%2Fsrc%2Fsymbol_index.rs?ref=d64d711db221e7959994e8fe22c6d8a975efcc4f", "patch": "@@ -120,8 +120,7 @@ fn library_symbols(db: &dyn SymbolsDatabase, source_root_id: SourceRootId) -> Ar\n         // we specifically avoid calling SymbolsDatabase::module_symbols here, even they do the same thing,\n         // as the index for a library is not going to really ever change, and we do not want to store each\n         // module's index in salsa.\n-        .map(|module| SymbolCollector::collect(db.upcast(), module))\n-        .flatten()\n+        .flat_map(|module| SymbolCollector::collect(db.upcast(), module))\n         .collect();\n \n     Arc::new(SymbolIndex::new(symbols))"}, {"sha": "e63b6f490ba729045e24799ae575b49aa4888e8f", "filename": "crates/rust-analyzer/src/handlers.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/d64d711db221e7959994e8fe22c6d8a975efcc4f/crates%2Frust-analyzer%2Fsrc%2Fhandlers.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d64d711db221e7959994e8fe22c6d8a975efcc4f/crates%2Frust-analyzer%2Fsrc%2Fhandlers.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fhandlers.rs?ref=d64d711db221e7959994e8fe22c6d8a975efcc4f", "patch": "@@ -532,7 +532,7 @@ pub(crate) fn handle_will_rename_files(\n     let mut source_change = source_changes.next().unwrap_or_default();\n     source_change.file_system_edits.clear();\n     // no collect here because we want to merge text edits on same file ids\n-    source_change.extend(source_changes.map(|it| it.source_file_edits).flatten());\n+    source_change.extend(source_changes.flat_map(|it| it.source_file_edits));\n     if source_change.source_file_edits.is_empty() {\n         Ok(None)\n     } else {"}]}