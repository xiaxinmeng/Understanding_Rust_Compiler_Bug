{"sha": "5a0078520e80579307124aca567a70e195637682", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVhMDA3ODUyMGU4MDU3OTMwNzEyNGFjYTU2N2E3MGUxOTU2Mzc2ODI=", "commit": {"author": {"name": "Nathan Froyd", "email": "froydnj@gmail.com", "date": "2017-04-14T01:33:24Z"}, "committer": {"name": "Nathan Froyd", "email": "froydnj@gmail.com", "date": "2017-04-28T19:24:09Z"}, "message": "num: add minimal benchmarks for full floating-point formatting\n\nWe have benchmarks for the floating-point formatting algorithms\nthemselves, but not for the surrounding machinery like Formatter and\ntranslating to the flt2dec::Part slices.", "tree": {"sha": "f0cd367f329956505109a8467b00531b6d4709f6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f0cd367f329956505109a8467b00531b6d4709f6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5a0078520e80579307124aca567a70e195637682", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5a0078520e80579307124aca567a70e195637682", "html_url": "https://github.com/rust-lang/rust/commit/5a0078520e80579307124aca567a70e195637682", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5a0078520e80579307124aca567a70e195637682/comments", "author": {"login": "froydnj", "id": 151096, "node_id": "MDQ6VXNlcjE1MTA5Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/151096?v=4", "gravatar_id": "", "url": "https://api.github.com/users/froydnj", "html_url": "https://github.com/froydnj", "followers_url": "https://api.github.com/users/froydnj/followers", "following_url": "https://api.github.com/users/froydnj/following{/other_user}", "gists_url": "https://api.github.com/users/froydnj/gists{/gist_id}", "starred_url": "https://api.github.com/users/froydnj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/froydnj/subscriptions", "organizations_url": "https://api.github.com/users/froydnj/orgs", "repos_url": "https://api.github.com/users/froydnj/repos", "events_url": "https://api.github.com/users/froydnj/events{/privacy}", "received_events_url": "https://api.github.com/users/froydnj/received_events", "type": "User", "site_admin": false}, "committer": {"login": "froydnj", "id": 151096, "node_id": "MDQ6VXNlcjE1MTA5Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/151096?v=4", "gravatar_id": "", "url": "https://api.github.com/users/froydnj", "html_url": "https://github.com/froydnj", "followers_url": "https://api.github.com/users/froydnj/followers", "following_url": "https://api.github.com/users/froydnj/following{/other_user}", "gists_url": "https://api.github.com/users/froydnj/gists{/gist_id}", "starred_url": "https://api.github.com/users/froydnj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/froydnj/subscriptions", "organizations_url": "https://api.github.com/users/froydnj/orgs", "repos_url": "https://api.github.com/users/froydnj/repos", "events_url": "https://api.github.com/users/froydnj/events{/privacy}", "received_events_url": "https://api.github.com/users/froydnj/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ad1461efb92ae85ce8227f52ca79149e368529d1", "url": "https://api.github.com/repos/rust-lang/rust/commits/ad1461efb92ae85ce8227f52ca79149e368529d1", "html_url": "https://github.com/rust-lang/rust/commit/ad1461efb92ae85ce8227f52ca79149e368529d1"}], "stats": {"total": 24, "additions": 24, "deletions": 0}, "files": [{"sha": "7f3b98a1c7614f251452cd72df7dffe78096655e", "filename": "src/libcore/benches/num/flt2dec/mod.rs", "status": "modified", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/5a0078520e80579307124aca567a70e195637682/src%2Flibcore%2Fbenches%2Fnum%2Fflt2dec%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5a0078520e80579307124aca567a70e195637682/src%2Flibcore%2Fbenches%2Fnum%2Fflt2dec%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fbenches%2Fnum%2Fflt2dec%2Fmod.rs?ref=5a0078520e80579307124aca567a70e195637682", "patch": "@@ -13,6 +13,10 @@ mod strategy {\n     mod grisu;\n }\n \n+use std::f64;\n+use std::io::Write;\n+use std::vec::Vec;\n+use test::Bencher;\n use core::num::flt2dec::{decode, DecodableFloat, FullDecoded, Decoded};\n use core::num::flt2dec::MAX_SIG_DIGITS;\n \n@@ -22,3 +26,23 @@ pub fn decode_finite<T: DecodableFloat>(v: T) -> Decoded {\n         full_decoded => panic!(\"expected finite, got {:?} instead\", full_decoded)\n     }\n }\n+\n+#[bench]\n+fn bench_small_shortest(b: &mut Bencher) {\n+    let mut buf = Vec::with_capacity(20);\n+\n+    b.iter(|| {\n+        buf.clear();\n+        write!(&mut buf, \"{}\", 3.1415926f64).unwrap()\n+    });\n+}\n+\n+#[bench]\n+fn bench_big_shortest(b: &mut Bencher) {\n+    let mut buf = Vec::with_capacity(300);\n+\n+    b.iter(|| {\n+        buf.clear();\n+        write!(&mut buf, \"{}\", f64::MAX).unwrap()\n+    });\n+}"}]}