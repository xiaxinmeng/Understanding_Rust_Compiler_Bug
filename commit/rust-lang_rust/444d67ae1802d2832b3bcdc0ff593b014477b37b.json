{"sha": "444d67ae1802d2832b3bcdc0ff593b014477b37b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ0NGQ2N2FlMTgwMmQyODMyYjNiY2RjMGZmNTkzYjAxNDQ3N2IzN2I=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2021-03-09T14:42:05Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2021-03-09T14:42:05Z"}, "message": "Cleanup", "tree": {"sha": "caf7102e92020b7cc5293674dd2576744a6601e8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/caf7102e92020b7cc5293674dd2576744a6601e8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/444d67ae1802d2832b3bcdc0ff593b014477b37b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/444d67ae1802d2832b3bcdc0ff593b014477b37b", "html_url": "https://github.com/rust-lang/rust/commit/444d67ae1802d2832b3bcdc0ff593b014477b37b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/444d67ae1802d2832b3bcdc0ff593b014477b37b/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2cc278c6ffa900d9fba8e19c5a1fc6996fbe6639", "url": "https://api.github.com/repos/rust-lang/rust/commits/2cc278c6ffa900d9fba8e19c5a1fc6996fbe6639", "html_url": "https://github.com/rust-lang/rust/commit/2cc278c6ffa900d9fba8e19c5a1fc6996fbe6639"}], "stats": {"total": 15, "additions": 7, "deletions": 8}, "files": [{"sha": "b6bc11da290c3b1d3c8daecc15db6c629c05bbc4", "filename": "crates/ide_completion/src/item.rs", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/444d67ae1802d2832b3bcdc0ff593b014477b37b/crates%2Fide_completion%2Fsrc%2Fitem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/444d67ae1802d2832b3bcdc0ff593b014477b37b/crates%2Fide_completion%2Fsrc%2Fitem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_completion%2Fsrc%2Fitem.rs?ref=444d67ae1802d2832b3bcdc0ff593b014477b37b", "patch": "@@ -430,11 +430,8 @@ impl Builder {\n         self.import_to_add = import_to_add;\n         self\n     }\n-    pub(crate) fn set_ref_match(\n-        mut self,\n-        ref_match: Option<(Mutability, CompletionScore)>,\n-    ) -> Builder {\n-        self.ref_match = ref_match;\n+    pub(crate) fn ref_match(mut self, ref_match: (Mutability, CompletionScore)) -> Builder {\n+        self.ref_match = Some(ref_match);\n         self\n     }\n }"}, {"sha": "0a6ac8804a8afbeebca5bf8117100cf22ad55e54", "filename": "crates/ide_completion/src/render.rs", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/444d67ae1802d2832b3bcdc0ff593b014477b37b/crates%2Fide_completion%2Fsrc%2Frender.rs", "raw_url": "https://github.com/rust-lang/rust/raw/444d67ae1802d2832b3bcdc0ff593b014477b37b/crates%2Fide_completion%2Fsrc%2Frender.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_completion%2Fsrc%2Frender.rs?ref=444d67ae1802d2832b3bcdc0ff593b014477b37b", "patch": "@@ -246,7 +246,6 @@ impl<'a> Render<'a> {\n             }\n         };\n \n-        let mut ref_match = None;\n         if let ScopeDef::Local(local) = resolution {\n             if let Some((active_name, active_type)) = self.ctx.active_name_and_type() {\n                 let ty = local.ty(self.ctx.db());\n@@ -255,7 +254,11 @@ impl<'a> Render<'a> {\n                 {\n                     item = item.set_score(score);\n                 }\n-                ref_match = refed_type_matches(&active_type, &active_name, &ty, &local_name);\n+                if let Some(ref_match) =\n+                    refed_type_matches(&active_type, &active_name, &ty, &local_name)\n+                {\n+                    item = item.ref_match(ref_match);\n+                }\n             }\n         }\n \n@@ -285,7 +288,6 @@ impl<'a> Render<'a> {\n         Some(\n             item.kind(kind)\n                 .add_import(import_to_add)\n-                .set_ref_match(ref_match)\n                 .set_documentation(self.docs(resolution))\n                 .set_deprecated(self.is_deprecated(resolution))\n                 .build(),"}]}