{"sha": "a21c2eb1213715b26ae61944cb5edea897d77ebd", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEyMWMyZWIxMjEzNzE1YjI2YWU2MTk0NGNiNWVkZWE4OTdkNzdlYmQ=", "commit": {"author": {"name": "est31", "email": "MTest31@outlook.com", "date": "2020-10-24T13:54:19Z"}, "committer": {"name": "est31", "email": "MTest31@outlook.com", "date": "2020-10-24T13:57:42Z"}, "message": "Iterate over the smaller list\n\nIf there are two lists of different sizes,\niterating over the smaller list and then\nlooking up in the larger list is cheaper\nthan vice versa, because lookups scale\nsublinearly.", "tree": {"sha": "e14473eb05f7455d76d5a5615d78726e7a705257", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e14473eb05f7455d76d5a5615d78726e7a705257"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a21c2eb1213715b26ae61944cb5edea897d77ebd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a21c2eb1213715b26ae61944cb5edea897d77ebd", "html_url": "https://github.com/rust-lang/rust/commit/a21c2eb1213715b26ae61944cb5edea897d77ebd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a21c2eb1213715b26ae61944cb5edea897d77ebd/comments", "author": {"login": "est31", "id": 8872119, "node_id": "MDQ6VXNlcjg4NzIxMTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/est31", "html_url": "https://github.com/est31", "followers_url": "https://api.github.com/users/est31/followers", "following_url": "https://api.github.com/users/est31/following{/other_user}", "gists_url": "https://api.github.com/users/est31/gists{/gist_id}", "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/est31/subscriptions", "organizations_url": "https://api.github.com/users/est31/orgs", "repos_url": "https://api.github.com/users/est31/repos", "events_url": "https://api.github.com/users/est31/events{/privacy}", "received_events_url": "https://api.github.com/users/est31/received_events", "type": "User", "site_admin": false}, "committer": {"login": "est31", "id": 8872119, "node_id": "MDQ6VXNlcjg4NzIxMTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8872119?v=4", "gravatar_id": "", "url": "https://api.github.com/users/est31", "html_url": "https://github.com/est31", "followers_url": "https://api.github.com/users/est31/followers", "following_url": "https://api.github.com/users/est31/following{/other_user}", "gists_url": "https://api.github.com/users/est31/gists{/gist_id}", "starred_url": "https://api.github.com/users/est31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/est31/subscriptions", "organizations_url": "https://api.github.com/users/est31/orgs", "repos_url": "https://api.github.com/users/est31/repos", "events_url": "https://api.github.com/users/est31/events{/privacy}", "received_events_url": "https://api.github.com/users/est31/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4d247ad7d3d2a9f72cd60e281f39b5d85bd6a463", "url": "https://api.github.com/repos/rust-lang/rust/commits/4d247ad7d3d2a9f72cd60e281f39b5d85bd6a463", "html_url": "https://github.com/rust-lang/rust/commit/4d247ad7d3d2a9f72cd60e281f39b5d85bd6a463"}], "stats": {"total": 12, "additions": 12, "deletions": 0}, "files": [{"sha": "ae2ab2b02521a39e45165619a06cd00261733e33", "filename": "compiler/rustc_middle/src/ty/mod.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/a21c2eb1213715b26ae61944cb5edea897d77ebd/compiler%2Frustc_middle%2Fsrc%2Fty%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a21c2eb1213715b26ae61944cb5edea897d77ebd/compiler%2Frustc_middle%2Fsrc%2Fty%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_middle%2Fsrc%2Fty%2Fmod.rs?ref=a21c2eb1213715b26ae61944cb5edea897d77ebd", "patch": "@@ -265,6 +265,10 @@ impl<'tcx> AssociatedItems<'tcx> {\n         self.items.iter().map(|(_, v)| *v)\n     }\n \n+    pub fn len(&self) -> usize {\n+        self.items.len()\n+    }\n+\n     /// Returns an iterator over all associated items with the given name, ignoring hygiene.\n     pub fn filter_by_name_unhygienic(\n         &self,"}, {"sha": "673cddbdb5f27f7efe28100fd4641607685356de", "filename": "compiler/rustc_typeck/src/coherence/inherent_impls_overlap.rs", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/a21c2eb1213715b26ae61944cb5edea897d77ebd/compiler%2Frustc_typeck%2Fsrc%2Fcoherence%2Finherent_impls_overlap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a21c2eb1213715b26ae61944cb5edea897d77ebd/compiler%2Frustc_typeck%2Fsrc%2Fcoherence%2Finherent_impls_overlap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcoherence%2Finherent_impls_overlap.rs?ref=a21c2eb1213715b26ae61944cb5edea897d77ebd", "patch": "@@ -22,6 +22,14 @@ impl InherentOverlapChecker<'tcx> {\n         let impl_items1 = self.tcx.associated_items(impl1);\n         let impl_items2 = self.tcx.associated_items(impl2);\n \n+        let mut impl_items1 = &impl_items1;\n+        let mut impl_items2 = &impl_items2;\n+\n+        // Performance optimization: iterate over the smaller list\n+        if impl_items1.len() > impl_items2.len() {\n+            std::mem::swap(&mut impl_items1, &mut impl_items2);\n+        }\n+\n         for item1 in impl_items1.in_definition_order() {\n             let collision = impl_items2.filter_by_name_unhygienic(item1.ident.name).any(|item2| {\n                 // Symbols and namespace match, compare hygienically."}]}