{"sha": "20b8d283ae7d18faaa8aec86e029a573e755a1dd", "node_id": "MDY6Q29tbWl0NzI0NzEyOjIwYjhkMjgzYWU3ZDE4ZmFhYThhZWM4NmUwMjlhNTczZTc1NWExZGQ=", "commit": {"author": {"name": "Roland Ruckerbauer", "email": "roland.rucky@gmail.com", "date": "2020-01-12T14:23:04Z"}, "committer": {"name": "Roland Ruckerbauer", "email": "roland.rucky@gmail.com", "date": "2020-01-12T16:34:57Z"}, "message": "Remove hir usage from macro_rules! detection in structure_node()", "tree": {"sha": "621b44a5a65722c2563ee87a0b1f1fbd1245745a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/621b44a5a65722c2563ee87a0b1f1fbd1245745a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/20b8d283ae7d18faaa8aec86e029a573e755a1dd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/20b8d283ae7d18faaa8aec86e029a573e755a1dd", "html_url": "https://github.com/rust-lang/rust/commit/20b8d283ae7d18faaa8aec86e029a573e755a1dd", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/20b8d283ae7d18faaa8aec86e029a573e755a1dd/comments", "author": null, "committer": null, "parents": [{"sha": "15c5426b54412134d3c5f2992e58e852266fc22e", "url": "https://api.github.com/repos/rust-lang/rust/commits/15c5426b54412134d3c5f2992e58e852266fc22e", "html_url": "https://github.com/rust-lang/rust/commit/15c5426b54412134d3c5f2992e58e852266fc22e"}], "stats": {"total": 9, "additions": 3, "deletions": 6}, "files": [{"sha": "3d13978d459a4012bdcfb55dcf06b1bb19bc177f", "filename": "crates/ra_hir/src/lib.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/20b8d283ae7d18faaa8aec86e029a573e755a1dd/crates%2Fra_hir%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/20b8d283ae7d18faaa8aec86e029a573e755a1dd/crates%2Fra_hir%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_hir%2Fsrc%2Flib.rs?ref=20b8d283ae7d18faaa8aec86e029a573e755a1dd", "patch": "@@ -58,7 +58,6 @@ pub use hir_def::{\n     type_ref::Mutability,\n };\n pub use hir_expand::{\n-    name::name, name::AsName, name::Name, HirFileId, InFile, MacroCallId, MacroCallLoc, MacroDefId,\n-    MacroFile, Origin,\n+    name::Name, HirFileId, InFile, MacroCallId, MacroCallLoc, MacroDefId, MacroFile, Origin,\n };\n pub use hir_ty::{display::HirDisplay, CallableDef};"}, {"sha": "944cc79df13a2aaa5b5cc439785289f361c9e7ca", "filename": "crates/ra_ide/src/display/structure.rs", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/20b8d283ae7d18faaa8aec86e029a573e755a1dd/crates%2Fra_ide%2Fsrc%2Fdisplay%2Fstructure.rs", "raw_url": "https://github.com/rust-lang/rust/raw/20b8d283ae7d18faaa8aec86e029a573e755a1dd/crates%2Fra_ide%2Fsrc%2Fdisplay%2Fstructure.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide%2Fsrc%2Fdisplay%2Fstructure.rs?ref=20b8d283ae7d18faaa8aec86e029a573e755a1dd", "patch": "@@ -2,7 +2,6 @@\n \n use crate::TextRange;\n \n-use hir::{name, AsName, Path};\n use ra_syntax::{\n     ast::{self, AttrsOwner, NameOwner, TypeAscriptionOwner, TypeParamsOwner},\n     match_ast, AstNode, SourceFile, SyntaxKind, SyntaxNode, WalkEvent,\n@@ -152,9 +151,8 @@ fn structure_node(node: &SyntaxNode) -> Option<StructureNode> {\n                 Some(node)\n             },\n             ast::MacroCall(it) => {\n-                match it.path().and_then(|p| Path::from_ast(p)) {\n-                    Some(path) if path.mod_path().segments.as_slice() == [name![macro_rules]]\n-                        && it.name().map(|n| n.as_name()).is_some()\n+                match it.path().and_then(|it| it.segment()).and_then(|it| it.name_ref()) {\n+                    Some(path_segment) if path_segment.text() == \"macro_rules\"\n                     => decl(it),\n                     _ => None,\n                 }"}]}