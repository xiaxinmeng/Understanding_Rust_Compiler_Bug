{"sha": "cb76f821942053091706b7bb2c4dc416bb09bfb9", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNiNzZmODIxOTQyMDUzMDkxNzA2YjdiYjJjNGRjNDE2YmIwOWJmYjk=", "commit": {"author": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2020-07-06T13:12:27Z"}, "committer": {"name": "Pietro Albini", "email": "pietro@pietroalbini.org", "date": "2020-07-23T09:29:47Z"}, "message": "ci: avoid symlinking the build directory on self-hosted builders", "tree": {"sha": "b29f8d96d79edb8d83e18b7df72f9c3e3df508df", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b29f8d96d79edb8d83e18b7df72f9c3e3df508df"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cb76f821942053091706b7bb2c4dc416bb09bfb9", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE1JbYPtLJAsc22U9xPgar6Auq8ZwFAl8ZWIsACgkQPgar6Auq\n8ZwKEQ/+LDXMeooBVbt929hy608606xdKnrEZJI9Gyg/lNrdqSevC1aWi3YdL7+x\naYyLXPquldpRnxHjTTNdh/zoDxE2na6kyok9aZiGKAKCl04Ngd/8egHjBEkJABFj\nCMYdZXYFsMkajLFV5CMiLEpmyXF+20/bkqxn0ZO3F6sGpc2YyfcfbJCoBGQPjxlf\nRuMhjZzKZTdRst8oSDVOZIDOj3Xv3b6MH1T2KD9YZykaUJ5GE2+FqpyFhTONOg1O\ngXTiypnT9QgIQTmD5gr0PuksUlYZ/FRGABgkY0DZ1FiZoTeRorLdsb/H8S36uOlm\nWE5PWFYmW2vzh+E+1ux5ZU8Ndf0IqhmkNHNVzmEJrjwXYka7QGrzxKwmck5bdoBm\npT4XRZy/enq+brR/C74IGDIsVeMshg+/2SWP8nMobNRs2QKUmj4GOKDhAynk7Bdq\nbGGNScUFVNd7qPPGnVTVx17gvwtIBK64m/Q4thJ8J/HX2llrceMFzzZ2kE4OhcYy\neDWPbFUgZkRq2OeWsY9swWZ/NFQ/g6m2sdXT5mwHHb/sQqx4TIv7WNCU8nJGRCWS\nHfLD6Aaw2l4bqa5sLsZ5rJt+M+yLHrtEvmmiihOMIwc0ko6Kw1Wh+wxIqs5j6mWC\nHB4LYZuZbYAfIV4CNzr15+nd+vYgxyVDvt2N8vtBBCHdVqI3DfM=\n=Cljf\n-----END PGP SIGNATURE-----", "payload": "tree b29f8d96d79edb8d83e18b7df72f9c3e3df508df\nparent 4825e12fc9c79954aa0fe18f5521efa6c19c7539\nauthor Pietro Albini <pietro@pietroalbini.org> 1594041147 +0200\ncommitter Pietro Albini <pietro@pietroalbini.org> 1595496587 +0200\n\nci: avoid symlinking the build directory on self-hosted builders\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cb76f821942053091706b7bb2c4dc416bb09bfb9", "html_url": "https://github.com/rust-lang/rust/commit/cb76f821942053091706b7bb2c4dc416bb09bfb9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cb76f821942053091706b7bb2c4dc416bb09bfb9/comments", "author": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pietroalbini", "id": 2299951, "node_id": "MDQ6VXNlcjIyOTk5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2299951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pietroalbini", "html_url": "https://github.com/pietroalbini", "followers_url": "https://api.github.com/users/pietroalbini/followers", "following_url": "https://api.github.com/users/pietroalbini/following{/other_user}", "gists_url": "https://api.github.com/users/pietroalbini/gists{/gist_id}", "starred_url": "https://api.github.com/users/pietroalbini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pietroalbini/subscriptions", "organizations_url": "https://api.github.com/users/pietroalbini/orgs", "repos_url": "https://api.github.com/users/pietroalbini/repos", "events_url": "https://api.github.com/users/pietroalbini/events{/privacy}", "received_events_url": "https://api.github.com/users/pietroalbini/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4825e12fc9c79954aa0fe18f5521efa6c19c7539", "url": "https://api.github.com/repos/rust-lang/rust/commits/4825e12fc9c79954aa0fe18f5521efa6c19c7539", "html_url": "https://github.com/rust-lang/rust/commit/4825e12fc9c79954aa0fe18f5521efa6c19c7539"}], "stats": {"total": 7, "additions": 6, "deletions": 1}, "files": [{"sha": "28d8aa3b6e71a156ec9a58eeb91967d1cfa8eba5", "filename": "src/ci/scripts/symlink-build-dir.sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cb76f821942053091706b7bb2c4dc416bb09bfb9/src%2Fci%2Fscripts%2Fsymlink-build-dir.sh", "raw_url": "https://github.com/rust-lang/rust/raw/cb76f821942053091706b7bb2c4dc416bb09bfb9/src%2Fci%2Fscripts%2Fsymlink-build-dir.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fscripts%2Fsymlink-build-dir.sh?ref=cb76f821942053091706b7bb2c4dc416bb09bfb9", "patch": "@@ -12,7 +12,7 @@ source \"$(cd \"$(dirname \"$0\")\" && pwd)/../shared.sh\"\n if isWindows && isAzurePipelines; then\n     cmd //c \"mkdir c:\\\\MORE_SPACE\"\n     cmd //c \"mklink /J build c:\\\\MORE_SPACE\"\n-elif isLinux && isGitHubActions; then\n+elif isLinux && isGitHubActions && ! isSelfHostedGitHubActions; then\n     sudo mkdir -p /mnt/more-space\n     sudo chown -R \"$(whoami):\" /mnt/more-space\n "}, {"sha": "8222758ed6dc4e5bf62eec89239bb0415fe657d1", "filename": "src/ci/shared.sh", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/cb76f821942053091706b7bb2c4dc416bb09bfb9/src%2Fci%2Fshared.sh", "raw_url": "https://github.com/rust-lang/rust/raw/cb76f821942053091706b7bb2c4dc416bb09bfb9/src%2Fci%2Fshared.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fshared.sh?ref=cb76f821942053091706b7bb2c4dc416bb09bfb9", "patch": "@@ -38,6 +38,11 @@ function isGitHubActions {\n     [[ \"${GITHUB_ACTIONS-false}\" = \"true\" ]]\n }\n \n+\n+function isSelfHostedGitHubActions {\n+    [[ \"${RUST_GHA_SELF_HOSTED-false}\" = \"true\" ]]\n+}\n+\n function isMacOS {\n     [[ \"${OSTYPE}\" = \"darwin\"* ]]\n }"}]}