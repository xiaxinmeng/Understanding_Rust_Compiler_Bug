{"sha": "0307ff020ce40fc025aa81dc09e0e50e5e34849f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAzMDdmZjAyMGNlNDBmYzAyNWFhODFkYzA5ZTBlNTBlNWUzNDg0OWY=", "commit": {"author": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-04-08T20:06:02Z"}, "committer": {"name": "Philipp Hansch", "email": "dev@phansch.net", "date": "2019-04-08T20:16:34Z"}, "message": "Fix ICE in decimal_literal_representation lint\n\nHandling the integer parsing properly instead of just unwrapping.\n\nNote that the test is not catching the ICE because plain UI tests\n[currently hide ICEs][compiletest_issue]. Once that issue is fixed, this\ntest would fail properly again.\n\n[compiletest_issue]: https://github.com/laumann/compiletest-rs/issues/169", "tree": {"sha": "8510f55e4a5efef8a84bc911757489c75369d046", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8510f55e4a5efef8a84bc911757489c75369d046"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/0307ff020ce40fc025aa81dc09e0e50e5e34849f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJEBAABCgAuFiEEj4U0bmbiMSg/mWqvgqphyqETl+YFAlyrrCMQHGRldkBwaGFu\nc2NoLm5ldAAKCRCCqmHKoROX5vLJD/9pScx0rxAb0FGE8gk6FLmjF/H3g7S1Tkdi\n0CPmzTGTtC3LYMscTWBeGSabIASPvXenGuyn2JWwZUhFLyIB3G6ogPt/nGiaH7LN\nl1K0LzuNzjiFIozshC0ms5al+9IHd9yPvmMJB5mzTGyStfUNbys0yS1JqhSvqLM3\nnKUZE362O9qKAx1B9YZE4aIBweCOEOwdkYd9T8rlrClhdNlZXNC91DuybSVzmAbY\ndOYqZ5r4pHr7BUZ2F0UXacw5J1MdLiyM43Io2nVsUQVfS7jIJYjc0qg0DEiorsiT\nPwgOR20gUl1X19hPGyUQBCVsGtYvRRYbF6Dq0iUDwVaORGjLHQ+dbj+DZndqbR/Z\n9wbMmvu7sTrQk4Kh8Gu9GE2+XeHg48Qg19DK22JmtIMZU5qqhItaCgk7nprc6xvC\nF6Yypenvfg/jbNJ3OQTWwGaaDZT+pVZgLzawe9w9ActNGRgokJBatoDnALEXFzOo\nm2XR7phxI9Vq2nksUD38ajAaTaYVGV2aV73pd9r8g8PrY6ytvJHj6ovt5+ofI9TT\nmrceh5mlHquZ1FU8TFSyzKevBewpzMWkfG97tDjTdxH2f5HBKNNIot6iFxiVyYG7\nxrWX5uivVHlVdkwRQFEsfUgss8NCZHwddu6HPazuXvmcUtrsrok3oqgTJdYFgbeK\nc0pB5yU5SA==\n=mRos\n-----END PGP SIGNATURE-----", "payload": "tree 8510f55e4a5efef8a84bc911757489c75369d046\nparent 949f58440b19e470a8ed370166f9d72cd09bd7e3\nauthor Philipp Hansch <dev@phansch.net> 1554753962 +0200\ncommitter Philipp Hansch <dev@phansch.net> 1554754594 +0200\n\nFix ICE in decimal_literal_representation lint\n\nHandling the integer parsing properly instead of just unwrapping.\n\nNote that the test is not catching the ICE because plain UI tests\n[currently hide ICEs][compiletest_issue]. Once that issue is fixed, this\ntest would fail properly again.\n\n[compiletest_issue]: https://github.com/laumann/compiletest-rs/issues/169\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/0307ff020ce40fc025aa81dc09e0e50e5e34849f", "html_url": "https://github.com/rust-lang/rust/commit/0307ff020ce40fc025aa81dc09e0e50e5e34849f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/0307ff020ce40fc025aa81dc09e0e50e5e34849f/comments", "author": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "phansch", "id": 2042399, "node_id": "MDQ6VXNlcjIwNDIzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2042399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phansch", "html_url": "https://github.com/phansch", "followers_url": "https://api.github.com/users/phansch/followers", "following_url": "https://api.github.com/users/phansch/following{/other_user}", "gists_url": "https://api.github.com/users/phansch/gists{/gist_id}", "starred_url": "https://api.github.com/users/phansch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phansch/subscriptions", "organizations_url": "https://api.github.com/users/phansch/orgs", "repos_url": "https://api.github.com/users/phansch/repos", "events_url": "https://api.github.com/users/phansch/events{/privacy}", "received_events_url": "https://api.github.com/users/phansch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "949f58440b19e470a8ed370166f9d72cd09bd7e3", "url": "https://api.github.com/repos/rust-lang/rust/commits/949f58440b19e470a8ed370166f9d72cd09bd7e3", "html_url": "https://github.com/rust-lang/rust/commit/949f58440b19e470a8ed370166f9d72cd09bd7e3"}], "stats": {"total": 35, "additions": 26, "deletions": 9}, "files": [{"sha": "3ea818d3db604440ad6a6751dfaa53e896925932", "filename": "clippy_lints/src/literal_representation.rs", "status": "modified", "additions": 13, "deletions": 9, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/0307ff020ce40fc025aa81dc09e0e50e5e34849f/clippy_lints%2Fsrc%2Fliteral_representation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0307ff020ce40fc025aa81dc09e0e50e5e34849f/clippy_lints%2Fsrc%2Fliteral_representation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Fliteral_representation.rs?ref=0307ff020ce40fc025aa81dc09e0e50e5e34849f", "patch": "@@ -529,19 +529,23 @@ impl LiteralRepresentation {\n             then {\n                 let digit_info = DigitInfo::new(&src, false);\n                 if digit_info.radix == Radix::Decimal {\n-                    let val = digit_info.digits\n+                    if let Ok(val) = digit_info.digits\n                         .chars()\n                         .filter(|&c| c != '_')\n                         .collect::<String>()\n-                        .parse::<u128>().unwrap();\n-                    if val < u128::from(self.threshold) {\n-                        return\n+                        .parse::<u128>() {\n+                        if val < u128::from(self.threshold) {\n+                            return\n+                        }\n+                        let hex = format!(\"{:#X}\", val);\n+                        let digit_info = DigitInfo::new(&hex[..], false);\n+                        let _ = Self::do_lint(digit_info.digits).map_err(|warning_type| {\n+                            warning_type.display(&digit_info.grouping_hint(), cx, lit.span)\n+                        });\n                     }\n-                    let hex = format!(\"{:#X}\", val);\n-                    let digit_info = DigitInfo::new(&hex[..], false);\n-                    let _ = Self::do_lint(digit_info.digits).map_err(|warning_type| {\n-                        warning_type.display(&digit_info.grouping_hint(), cx, lit.span)\n-                    });\n+                    else {\n+                        return\n+                    };\n                 }\n             }\n         }"}, {"sha": "05c5134c8457b4f2564b99eff0aa4353f773cbcd", "filename": "tests/ui/crashes/ice-3891.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/0307ff020ce40fc025aa81dc09e0e50e5e34849f/tests%2Fui%2Fcrashes%2Fice-3891.rs", "raw_url": "https://github.com/rust-lang/rust/raw/0307ff020ce40fc025aa81dc09e0e50e5e34849f/tests%2Fui%2Fcrashes%2Fice-3891.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcrashes%2Fice-3891.rs?ref=0307ff020ce40fc025aa81dc09e0e50e5e34849f", "patch": "@@ -0,0 +1,3 @@\n+fn main() {\n+    1x;\n+}"}, {"sha": "16aedbd98dec30c6fa7c6efa4974e397847fbbf7", "filename": "tests/ui/crashes/ice-3891.stderr", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/0307ff020ce40fc025aa81dc09e0e50e5e34849f/tests%2Fui%2Fcrashes%2Fice-3891.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/0307ff020ce40fc025aa81dc09e0e50e5e34849f/tests%2Fui%2Fcrashes%2Fice-3891.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fcrashes%2Fice-3891.stderr?ref=0307ff020ce40fc025aa81dc09e0e50e5e34849f", "patch": "@@ -0,0 +1,10 @@\n+error: invalid suffix `x` for numeric literal\n+  --> $DIR/ice-3891.rs:2:5\n+   |\n+LL |     1x;\n+   |     ^^ invalid suffix `x`\n+   |\n+   = help: the suffix must be one of the integral types (`u32`, `isize`, etc)\n+\n+error: aborting due to previous error\n+"}]}