{"sha": "a4e4233828f0a8cb30278245d53dcb25b2e26a01", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE0ZTQyMzM4MjhmMGE4Y2IzMDI3ODI0NWQ1M2RjYjI1YjJlMjZhMDE=", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2015-08-09T19:04:22Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume1.gomez@gmail.com", "date": "2015-08-10T20:46:58Z"}, "message": "Add Send/Sync traits on Iter struct in hash/table", "tree": {"sha": "01402d0638fd57cdade151d091734a69839fb854", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/01402d0638fd57cdade151d091734a69839fb854"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a4e4233828f0a8cb30278245d53dcb25b2e26a01", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a4e4233828f0a8cb30278245d53dcb25b2e26a01", "html_url": "https://github.com/rust-lang/rust/commit/a4e4233828f0a8cb30278245d53dcb25b2e26a01", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a4e4233828f0a8cb30278245d53dcb25b2e26a01/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a5d33d8911d3ea691cb152bc582ee443ae3619da", "url": "https://api.github.com/repos/rust-lang/rust/commits/a5d33d8911d3ea691cb152bc582ee443ae3619da", "html_url": "https://github.com/rust-lang/rust/commit/a5d33d8911d3ea691cb152bc582ee443ae3619da"}], "stats": {"total": 29, "additions": 28, "deletions": 1}, "files": [{"sha": "445391bbe3a1020fcc454877f9bced6b3f9297e4", "filename": "src/libstd/collections/hash/set.rs", "status": "modified", "additions": 22, "deletions": 1, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/a4e4233828f0a8cb30278245d53dcb25b2e26a01/src%2Flibstd%2Fcollections%2Fhash%2Fset.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a4e4233828f0a8cb30278245d53dcb25b2e26a01/src%2Flibstd%2Fcollections%2Fhash%2Fset.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fcollections%2Fhash%2Fset.rs?ref=a4e4233828f0a8cb30278245d53dcb25b2e26a01", "patch": "@@ -11,7 +11,7 @@\n use borrow::Borrow;\n use clone::Clone;\n use cmp::{Eq, PartialEq};\n-use core::marker::Sized;\n+use core::marker::{Sized, Send, Sync};\n use default::Default;\n use fmt::Debug;\n use fmt;\n@@ -764,18 +764,27 @@ pub struct Iter<'a, K: 'a> {\n     iter: Keys<'a, K, ()>\n }\n \n+unsafe impl<'a, K: Send> Send for Iter<'a, K> {}\n+unsafe impl<'a, K: Sync> Sync for Iter<'a, K> {}\n+\n /// HashSet move iterator\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n pub struct IntoIter<K> {\n     iter: Map<map::IntoIter<K, ()>, fn((K, ())) -> K>\n }\n \n+unsafe impl<K: Send> Send for IntoIter<K> {}\n+unsafe impl<K: Sync> Sync for IntoIter<K> {}\n+\n /// HashSet drain iterator\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n pub struct Drain<'a, K: 'a> {\n     iter: Map<map::Drain<'a, K, ()>, fn((K, ())) -> K>,\n }\n \n+unsafe impl<'a, K: Send> Send for Drain<'a, K> {}\n+unsafe impl<'a, K: Sync> Sync for Drain<'a, K> {}\n+\n /// Intersection iterator\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n pub struct Intersection<'a, T: 'a, S: 'a> {\n@@ -785,6 +794,9 @@ pub struct Intersection<'a, T: 'a, S: 'a> {\n     other: &'a HashSet<T, S>,\n }\n \n+unsafe impl<'a, K: Send, S: Send> Send for Intersection<'a, K, S> {}\n+unsafe impl<'a, K: Sync, S: Send> Sync for Intersection<'a, K, S> {}\n+\n /// Difference iterator\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n pub struct Difference<'a, T: 'a, S: 'a> {\n@@ -794,18 +806,27 @@ pub struct Difference<'a, T: 'a, S: 'a> {\n     other: &'a HashSet<T, S>,\n }\n \n+unsafe impl<'a, K: Send, S: Send> Send for Difference<'a, K, S> {}\n+unsafe impl<'a, K: Sync, S: Send> Sync for Difference<'a, K, S> {}\n+\n /// Symmetric difference iterator.\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n pub struct SymmetricDifference<'a, T: 'a, S: 'a> {\n     iter: Chain<Difference<'a, T, S>, Difference<'a, T, S>>\n }\n \n+unsafe impl<'a, K: Send, S: Send> Send for SymmetricDifference<'a, K, S> {}\n+unsafe impl<'a, K: Sync, S: Send> Sync for SymmetricDifference<'a, K, S> {}\n+\n /// Set union iterator.\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n pub struct Union<'a, T: 'a, S: 'a> {\n     iter: Chain<Iter<'a, T>, Difference<'a, T, S>>\n }\n \n+unsafe impl<'a, K: Send, S: Send> Send for Union<'a, K, S> {}\n+unsafe impl<'a, K: Sync, S: Send> Sync for Union<'a, K, S> {}\n+\n #[stable(feature = \"rust1\", since = \"1.0.0\")]\n impl<'a, T, S> IntoIterator for &'a HashSet<T, S>\n     where T: Eq + Hash, S: HashState"}, {"sha": "ee63e29e6c9a47a88a2cb921a9d2cd2cf090f736", "filename": "src/libstd/collections/hash/table.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/a4e4233828f0a8cb30278245d53dcb25b2e26a01/src%2Flibstd%2Fcollections%2Fhash%2Ftable.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a4e4233828f0a8cb30278245d53dcb25b2e26a01/src%2Flibstd%2Fcollections%2Fhash%2Ftable.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibstd%2Fcollections%2Fhash%2Ftable.rs?ref=a4e4233828f0a8cb30278245d53dcb25b2e26a01", "patch": "@@ -741,6 +741,9 @@ struct RawBuckets<'a, K, V> {\n     marker: marker::PhantomData<&'a ()>,\n }\n \n+unsafe impl<'a, K: Send, V: Send> Send for RawBuckets<'a, K, V> {}\n+unsafe impl<'a, K: Sync, V: Sync> Sync for RawBuckets<'a, K, V> {}\n+\n // FIXME(#19839) Remove in favor of `#[derive(Clone)]`\n impl<'a, K, V> Clone for RawBuckets<'a, K, V> {\n     fn clone(&self) -> RawBuckets<'a, K, V> {"}, {"sha": "ffa5c611777804dae99454c7bebb25ede26a6e60", "filename": "src/test/run-pass/sync-send-iterators-in-libcollections.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/a4e4233828f0a8cb30278245d53dcb25b2e26a01/src%2Ftest%2Frun-pass%2Fsync-send-iterators-in-libcollections.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a4e4233828f0a8cb30278245d53dcb25b2e26a01/src%2Ftest%2Frun-pass%2Fsync-send-iterators-in-libcollections.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fsync-send-iterators-in-libcollections.rs?ref=a4e4233828f0a8cb30278245d53dcb25b2e26a01", "patch": "@@ -25,6 +25,7 @@ use collections::String;\n use collections::Vec;\n use collections::VecDeque;\n use collections::VecMap;\n+use std::collections::HashMap;\n \n use collections::Bound::Included;\n use collections::enum_set::CLike;\n@@ -77,6 +78,8 @@ fn main() {\n     is_sync_send!(BTreeSet::<usize>::new(), intersection(&BTreeSet::<usize>::new()));\n     is_sync_send!(BTreeSet::<usize>::new(), union(&BTreeSet::<usize>::new()));\n \n+    all_sync_send!(HashMap::<usize, usize>::new(), keys, values, iter, iter_mut);\n+\n     all_sync_send!(LinkedList::<usize>::new(), iter, iter_mut, into_iter);\n \n     #[derive(Copy, Clone)]"}]}