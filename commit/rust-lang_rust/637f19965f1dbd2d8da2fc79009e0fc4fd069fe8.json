{"sha": "637f19965f1dbd2d8da2fc79009e0fc4fd069fe8", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYzN2YxOTk2NWYxZGJkMmQ4ZGEyZmM3OTAwOWUwZmM0ZmQwNjlmZTg=", "commit": {"author": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-01-18T00:12:50Z"}, "committer": {"name": "Brian Anderson", "email": "banderson@mozilla.com", "date": "2012-01-18T00:31:26Z"}, "message": "rustdoc: Convert markdown generation to a pass", "tree": {"sha": "d689bca447f5612bfedf81e0c59b7038d29f33cb", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d689bca447f5612bfedf81e0c59b7038d29f33cb"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/637f19965f1dbd2d8da2fc79009e0fc4fd069fe8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/637f19965f1dbd2d8da2fc79009e0fc4fd069fe8", "html_url": "https://github.com/rust-lang/rust/commit/637f19965f1dbd2d8da2fc79009e0fc4fd069fe8", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/637f19965f1dbd2d8da2fc79009e0fc4fd069fe8/comments", "author": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "brson", "id": 147214, "node_id": "MDQ6VXNlcjE0NzIxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/147214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brson", "html_url": "https://github.com/brson", "followers_url": "https://api.github.com/users/brson/followers", "following_url": "https://api.github.com/users/brson/following{/other_user}", "gists_url": "https://api.github.com/users/brson/gists{/gist_id}", "starred_url": "https://api.github.com/users/brson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brson/subscriptions", "organizations_url": "https://api.github.com/users/brson/orgs", "repos_url": "https://api.github.com/users/brson/repos", "events_url": "https://api.github.com/users/brson/events{/privacy}", "received_events_url": "https://api.github.com/users/brson/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a6bdaee7f915f126921d253d9e102bd08026989d", "url": "https://api.github.com/repos/rust-lang/rust/commits/a6bdaee7f915f126921d253d9e102bd08026989d", "html_url": "https://github.com/rust-lang/rust/commit/a6bdaee7f915f126921d253d9e102bd08026989d"}], "stats": {"total": 42, "additions": 33, "deletions": 9}, "files": [{"sha": "533043417787495151b567ae8c68c8f86e7d3a7d", "filename": "src/rustdoc/attr_pass.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/637f19965f1dbd2d8da2fc79009e0fc4fd069fe8/src%2Frustdoc%2Fattr_pass.rs", "raw_url": "https://github.com/rust-lang/rust/raw/637f19965f1dbd2d8da2fc79009e0fc4fd069fe8/src%2Frustdoc%2Fattr_pass.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Fattr_pass.rs?ref=637f19965f1dbd2d8da2fc79009e0fc4fd069fe8", "patch": "@@ -1,7 +1,11 @@\n import rustc::syntax::ast;\n import rustc::middle::ast_map;\n \n-export run;\n+export mk_pass;\n+\n+fn mk_pass() -> pass {\n+    run\n+}\n \n fn run(\n     srv: astsrv::srv,"}, {"sha": "2366f81824674c8b4f5951be76294e579ac566bc", "filename": "src/rustdoc/gen.rs", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/637f19965f1dbd2d8da2fc79009e0fc4fd069fe8/src%2Frustdoc%2Fgen.rs", "raw_url": "https://github.com/rust-lang/rust/raw/637f19965f1dbd2d8da2fc79009e0fc4fd069fe8/src%2Frustdoc%2Fgen.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Fgen.rs?ref=637f19965f1dbd2d8da2fc79009e0fc4fd069fe8", "patch": "@@ -1,7 +1,19 @@\n import std::io;\n import std::io::writer_util;\n \n-export write_markdown;\n+export mk_pass;\n+\n+fn mk_pass(\n+    writer: fn~() -> io::writer\n+) -> pass {\n+    ret fn~(\n+        _srv: astsrv::srv,\n+        doc: doc::cratedoc\n+    ) -> doc::cratedoc {\n+        write_markdown(doc, writer());\n+        doc\n+    };\n+}\n \n type ctxt = {\n     w: io::writer,"}, {"sha": "527c8828033386f39672c7cb3a84e25a08e4f2a8", "filename": "src/rustdoc/prune_undoc_pass.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/637f19965f1dbd2d8da2fc79009e0fc4fd069fe8/src%2Frustdoc%2Fprune_undoc_pass.rs", "raw_url": "https://github.com/rust-lang/rust/raw/637f19965f1dbd2d8da2fc79009e0fc4fd069fe8/src%2Frustdoc%2Fprune_undoc_pass.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Fprune_undoc_pass.rs?ref=637f19965f1dbd2d8da2fc79009e0fc4fd069fe8", "patch": "@@ -1,4 +1,8 @@\n-export run;\n+export mk_pass;\n+\n+fn mk_pass() -> pass {\n+    run\n+}\n \n type ctxt = {\n     mutable have_docs: bool"}, {"sha": "afcacbd5556e717b4c779e6e21c156d8e587aaf0", "filename": "src/rustdoc/rustdoc.rs", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/637f19965f1dbd2d8da2fc79009e0fc4fd069fe8/src%2Frustdoc%2Frustdoc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/637f19965f1dbd2d8da2fc79009e0fc4fd069fe8/src%2Frustdoc%2Frustdoc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Frustdoc.rs?ref=637f19965f1dbd2d8da2fc79009e0fc4fd069fe8", "patch": "@@ -74,11 +74,11 @@ fn run(source_file: str) {\n     let default_name = source_file;\n     let srv = astsrv::mk_srv_from_file(source_file);\n     let doc = extract::from_srv(srv, default_name);\n-    let doc = run_passes(srv, doc, [\n-        attr_pass::run,\n+    run_passes(srv, doc, [\n+        attr_pass::mk_pass(),\n         // FIXME: This pass should be optional\n-        prune_undoc_pass::run,\n-        tystr_pass::run\n+        prune_undoc_pass::mk_pass(),\n+        tystr_pass::mk_pass(),\n+        gen::mk_pass {|| std::io:: stdout()}\n     ]);\n-    gen::write_markdown(doc, std::io::stdout());\n }\n\\ No newline at end of file"}, {"sha": "e31a208d1d1ee7831ae95868fd96b96660c55266", "filename": "src/rustdoc/tystr_pass.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/637f19965f1dbd2d8da2fc79009e0fc4fd069fe8/src%2Frustdoc%2Ftystr_pass.rs", "raw_url": "https://github.com/rust-lang/rust/raw/637f19965f1dbd2d8da2fc79009e0fc4fd069fe8/src%2Frustdoc%2Ftystr_pass.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustdoc%2Ftystr_pass.rs?ref=637f19965f1dbd2d8da2fc79009e0fc4fd069fe8", "patch": "@@ -2,7 +2,11 @@ import rustc::syntax::ast;\n import rustc::syntax::print::pprust;\n import rustc::middle::ast_map;\n \n-export run;\n+export mk_pass;\n+\n+fn mk_pass() -> pass {\n+    run\n+}\n \n fn run(\n     srv: astsrv::srv,"}]}