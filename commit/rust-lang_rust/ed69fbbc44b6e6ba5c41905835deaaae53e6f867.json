{"sha": "ed69fbbc44b6e6ba5c41905835deaaae53e6f867", "node_id": "MDY6Q29tbWl0NzI0NzEyOmVkNjlmYmJjNDRiNmU2YmE1YzQxOTA1ODM1ZGVhYWFlNTNlNmY4Njc=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2020-01-05T09:58:44Z"}, "committer": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2020-01-11T02:27:39Z"}, "message": "ast_validation -> new crate rustc_ast_passes", "tree": {"sha": "8b9d9660013c3fedb64902d24b892027270f7850", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8b9d9660013c3fedb64902d24b892027270f7850"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ed69fbbc44b6e6ba5c41905835deaaae53e6f867", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ed69fbbc44b6e6ba5c41905835deaaae53e6f867", "html_url": "https://github.com/rust-lang/rust/commit/ed69fbbc44b6e6ba5c41905835deaaae53e6f867", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ed69fbbc44b6e6ba5c41905835deaaae53e6f867/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f361b71a7dd5516e40fe77f22d28b9ed6d76e7bf", "url": "https://api.github.com/repos/rust-lang/rust/commits/f361b71a7dd5516e40fe77f22d28b9ed6d76e7bf", "html_url": "https://github.com/rust-lang/rust/commit/f361b71a7dd5516e40fe77f22d28b9ed6d76e7bf"}], "stats": {"total": 49, "additions": 44, "deletions": 5}, "files": [{"sha": "385863abf678a72292228ec1bf4888068ae02795", "filename": "Cargo.lock", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/ed69fbbc44b6e6ba5c41905835deaaae53e6f867/Cargo.lock", "raw_url": "https://github.com/rust-lang/rust/raw/ed69fbbc44b6e6ba5c41905835deaaae53e6f867/Cargo.lock", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.lock?ref=ed69fbbc44b6e6ba5c41905835deaaae53e6f867", "patch": "@@ -3374,6 +3374,19 @@ dependencies = [\n  \"syntax\",\n ]\n \n+[[package]]\n+name = \"rustc_ast_passes\"\n+version = \"0.0.0\"\n+dependencies = [\n+ \"rustc_data_structures\",\n+ \"rustc_error_codes\",\n+ \"rustc_errors\",\n+ \"rustc_parse\",\n+ \"rustc_session\",\n+ \"rustc_span\",\n+ \"syntax\",\n+]\n+\n [[package]]\n name = \"rustc_builtin_macros\"\n version = \"0.0.0\"\n@@ -3615,6 +3628,7 @@ dependencies = [\n  \"rustc\",\n  \"rustc-rayon\",\n  \"rustc_ast_lowering\",\n+ \"rustc_ast_passes\",\n  \"rustc_builtin_macros\",\n  \"rustc_codegen_llvm\",\n  \"rustc_codegen_ssa\","}, {"sha": "f658618fe8ac042774092f4387c82f1b0c812a21", "filename": "src/librustc_ast_passes/Cargo.toml", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/ed69fbbc44b6e6ba5c41905835deaaae53e6f867/src%2Flibrustc_ast_passes%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/ed69fbbc44b6e6ba5c41905835deaaae53e6f867/src%2Flibrustc_ast_passes%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_ast_passes%2FCargo.toml?ref=ed69fbbc44b6e6ba5c41905835deaaae53e6f867", "patch": "@@ -0,0 +1,18 @@\n+[package]\n+authors = [\"The Rust Project Developers\"]\n+name = \"rustc_ast_passes\"\n+version = \"0.0.0\"\n+edition = \"2018\"\n+\n+[lib]\n+name = \"rustc_ast_passes\"\n+path = \"lib.rs\"\n+\n+[dependencies]\n+rustc_data_structures = { path = \"../librustc_data_structures\" }\n+rustc_errors = { path = \"../librustc_errors\", package = \"rustc_errors\" }\n+rustc_error_codes = { path = \"../librustc_error_codes\" }\n+rustc_parse = { path = \"../librustc_parse\" }\n+rustc_session = { path = \"../librustc_session\" }\n+rustc_span = { path = \"../librustc_span\" }\n+syntax = { path = \"../libsyntax\" }"}, {"sha": "c915b7ba21692873630451ea71d230e3aafa4d72", "filename": "src/librustc_ast_passes/ast_validation.rs", "status": "renamed", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ed69fbbc44b6e6ba5c41905835deaaae53e6f867/src%2Flibrustc_ast_passes%2Fast_validation.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ed69fbbc44b6e6ba5c41905835deaaae53e6f867/src%2Flibrustc_ast_passes%2Fast_validation.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_ast_passes%2Fast_validation.rs?ref=ed69fbbc44b6e6ba5c41905835deaaae53e6f867", "patch": "@@ -6,10 +6,10 @@\n // This pass is supposed to perform only simple checks not requiring name resolution\n // or type checking or some other kind of complex analysis.\n \n-use rustc::lint::builtin::PATTERNS_IN_FNS_WITHOUT_BODY;\n use rustc_data_structures::fx::FxHashMap;\n use rustc_errors::{struct_span_err, Applicability, FatalError};\n use rustc_parse::validate_attr;\n+use rustc_session::lint::builtin::PATTERNS_IN_FNS_WITHOUT_BODY;\n use rustc_session::lint::LintBuffer;\n use rustc_session::Session;\n use rustc_span::source_map::Spanned;\n@@ -907,7 +907,7 @@ impl<'a> Visitor<'a> for AstValidator<'a> {\n                     }\n                 }\n \n-                Some(Constness::Const) => bug!(\"Parser should reject bare `const` on bounds\"),\n+                Some(Constness::Const) => panic!(\"Parser should reject bare `const` on bounds\"),\n                 None => {}\n             }\n         }", "previous_filename": "src/librustc_passes/ast_validation.rs"}, {"sha": "8011478ed2fee1bca7ee8a9765f1b76fddf9260f", "filename": "src/librustc_ast_passes/lib.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/ed69fbbc44b6e6ba5c41905835deaaae53e6f867/src%2Flibrustc_ast_passes%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ed69fbbc44b6e6ba5c41905835deaaae53e6f867/src%2Flibrustc_ast_passes%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_ast_passes%2Flib.rs?ref=ed69fbbc44b6e6ba5c41905835deaaae53e6f867", "patch": "@@ -0,0 +1,7 @@\n+//! The `rustc_ast_passes` crate contains passes which validate the AST in `syntax`\n+//! parsed by `rustc_parse` and then lowered, after the passes in this crate,\n+//! by `rustc_ast_lowering`.\n+\n+#![feature(slice_patterns)]\n+\n+pub mod ast_validation;"}, {"sha": "eb0551c606548ebea590bf28d2a0652510faec9d", "filename": "src/librustc_interface/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/ed69fbbc44b6e6ba5c41905835deaaae53e6f867/src%2Flibrustc_interface%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/ed69fbbc44b6e6ba5c41905835deaaae53e6f867/src%2Flibrustc_interface%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_interface%2FCargo.toml?ref=ed69fbbc44b6e6ba5c41905835deaaae53e6f867", "patch": "@@ -22,6 +22,7 @@ rustc_span = { path = \"../librustc_span\" }\n rustc_serialize = { path = \"../libserialize\", package = \"serialize\" }\n rustc = { path = \"../librustc\" }\n rustc_ast_lowering = { path = \"../librustc_ast_lowering\" }\n+rustc_ast_passes = { path = \"../librustc_ast_passes\" }\n rustc_incremental = { path = \"../librustc_incremental\" }\n rustc_traits = { path = \"../librustc_traits\" }\n rustc_data_structures = { path = \"../librustc_data_structures\" }"}, {"sha": "27bed31b9d673bb86de574b0cd5487b4a1649c6f", "filename": "src/librustc_interface/passes.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ed69fbbc44b6e6ba5c41905835deaaae53e6f867/src%2Flibrustc_interface%2Fpasses.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ed69fbbc44b6e6ba5c41905835deaaae53e6f867/src%2Flibrustc_interface%2Fpasses.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_interface%2Fpasses.rs?ref=ed69fbbc44b6e6ba5c41905835deaaae53e6f867", "patch": "@@ -29,7 +29,7 @@ use rustc_hir::def_id::{CrateNum, LOCAL_CRATE};\n use rustc_incremental;\n use rustc_mir as mir;\n use rustc_parse::{parse_crate_from_file, parse_crate_from_source_str};\n-use rustc_passes::{self, ast_validation, hir_stats, layout_test};\n+use rustc_passes::{self, hir_stats, layout_test};\n use rustc_plugin_impl as plugin;\n use rustc_privacy;\n use rustc_resolve::{Resolver, ResolverArenas};\n@@ -344,7 +344,7 @@ fn configure_and_expand_inner<'a>(\n     }\n \n     let has_proc_macro_decls = sess.time(\"AST_validation\", || {\n-        ast_validation::check_crate(sess, &krate, &mut resolver.lint_buffer())\n+        rustc_ast_passes::ast_validation::check_crate(sess, &krate, &mut resolver.lint_buffer())\n     });\n \n     let crate_types = sess.crate_types.borrow();"}, {"sha": "65eb07b989d83ab871380cb6048a096c1aa056ad", "filename": "src/librustc_passes/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/ed69fbbc44b6e6ba5c41905835deaaae53e6f867/src%2Flibrustc_passes%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ed69fbbc44b6e6ba5c41905835deaaae53e6f867/src%2Flibrustc_passes%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_passes%2Flib.rs?ref=ed69fbbc44b6e6ba5c41905835deaaae53e6f867", "patch": "@@ -17,7 +17,6 @@ extern crate log;\n \n use rustc::ty::query::Providers;\n \n-pub mod ast_validation;\n mod check_const;\n pub mod dead;\n mod diagnostic_items;"}]}