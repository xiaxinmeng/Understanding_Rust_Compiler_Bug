{"sha": "8ddb9c71c3f4c18a2679d498d5fe65a9b6516270", "node_id": "MDY6Q29tbWl0NzI0NzEyOjhkZGI5YzcxYzNmNGMxOGEyNjc5ZDQ5OGQ1ZmU2NWE5YjY1MTYyNzA=", "commit": {"author": {"name": "Steve Klabnik", "email": "steve@steveklabnik.com", "date": "2014-08-28T18:05:33Z"}, "committer": {"name": "Steve Klabnik", "email": "steve@steveklabnik.com", "date": "2014-09-09T22:48:30Z"}, "message": "Add section about Str trait", "tree": {"sha": "107a1fe8378fb7245082cd900e2ebad4fc33fd72", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/107a1fe8378fb7245082cd900e2ebad4fc33fd72"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/8ddb9c71c3f4c18a2679d498d5fe65a9b6516270", "comment_count": 9, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/8ddb9c71c3f4c18a2679d498d5fe65a9b6516270", "html_url": "https://github.com/rust-lang/rust/commit/8ddb9c71c3f4c18a2679d498d5fe65a9b6516270", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/8ddb9c71c3f4c18a2679d498d5fe65a9b6516270/comments", "author": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "committer": {"login": "steveklabnik", "id": 27786, "node_id": "MDQ6VXNlcjI3Nzg2", "avatar_url": "https://avatars.githubusercontent.com/u/27786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steveklabnik", "html_url": "https://github.com/steveklabnik", "followers_url": "https://api.github.com/users/steveklabnik/followers", "following_url": "https://api.github.com/users/steveklabnik/following{/other_user}", "gists_url": "https://api.github.com/users/steveklabnik/gists{/gist_id}", "starred_url": "https://api.github.com/users/steveklabnik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steveklabnik/subscriptions", "organizations_url": "https://api.github.com/users/steveklabnik/orgs", "repos_url": "https://api.github.com/users/steveklabnik/repos", "events_url": "https://api.github.com/users/steveklabnik/events{/privacy}", "received_events_url": "https://api.github.com/users/steveklabnik/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bda3ceda039f0d37c726ca62e0bac457ce39d071", "url": "https://api.github.com/repos/rust-lang/rust/commits/bda3ceda039f0d37c726ca62e0bac457ce39d071", "html_url": "https://github.com/rust-lang/rust/commit/bda3ceda039f0d37c726ca62e0bac457ce39d071"}], "stats": {"total": 37, "additions": 32, "deletions": 5}, "files": [{"sha": "a49132ec8be9498dcd55bdc6243d2693ff882abf", "filename": "src/doc/guide-strings.md", "status": "modified", "additions": 32, "deletions": 5, "changes": 37, "blob_url": "https://github.com/rust-lang/rust/blob/8ddb9c71c3f4c18a2679d498d5fe65a9b6516270/src%2Fdoc%2Fguide-strings.md", "raw_url": "https://github.com/rust-lang/rust/raw/8ddb9c71c3f4c18a2679d498d5fe65a9b6516270/src%2Fdoc%2Fguide-strings.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Fguide-strings.md?ref=8ddb9c71c3f4c18a2679d498d5fe65a9b6516270", "patch": "@@ -92,9 +92,33 @@ fn foo(s: String) {\n ```\n \n If you have good reason. It's not polite to hold on to ownership you don't\n-need, and it can make your lifetimes more complex. Furthermore, you can pass\n-either kind of string into `foo` by using `.as_slice()` on any `String` you\n-need to pass in, so the `&str` version is more flexible.\n+need, and it can make your lifetimes more complex.\n+\n+## Generic functions\n+\n+To write a function that's generic over types of strings, use [the `Str`\n+trait](http://doc.rust-lang.org/std/str/trait.Str.html):\n+\n+```{rust}\n+fn some_string_length<T: Str>(x: T) -> uint {\n+        x.as_slice().len()\n+}\n+\n+fn main() {\n+    let s = \"Hello, world\";\n+\n+    println!(\"{}\", some_string_length(s));\n+\n+    let s = \"Hello, world\".to_string();\n+\n+    println!(\"{}\", some_string_length(s));\n+}\n+```\n+\n+Both of these lines will print `12`. \n+\n+The only method that the `Str` trait has is `as_slice()`, which gives you\n+access to a `&str` value from the underlying string.\n \n ## Comparisons\n \n@@ -134,7 +158,7 @@ println!(\"{}\", s[0]);\n \n This does not compile. This is on purpose. In the world of UTF-8, direct\n indexing is basically never what you want to do. The reason is that each\n-charater can be a variable number of bytes. This means that you have to iterate\n+character can be a variable number of bytes. This means that you have to iterate\n through the characters anyway, which is a O(n) operation. \n \n To iterate over a string, use the `graphemes()` method on `&str`:\n@@ -147,14 +171,17 @@ for l in s.graphemes(true) {\n }\n ```\n \n+Note that `l` has the type `&str` here, since a single grapheme can consist of\n+multiple codepoints, so a `char` wouldn't be appropriate.\n+\n This will print out each character in turn, as you'd expect: first \"\u03b1\", then\n \"\u1f30\", etc. You can see that this is different than just the individual bytes.\n Here's a version that prints out each byte:\n \n ```{rust}\n let s = \"\u03b1\u1f30\u03b8\u03ae\u03c1\";\n \n-for l in s.as_bytes().iter() {\n+for l in s.bytes() {\n     println!(\"{}\", l);\n }\n ```"}]}