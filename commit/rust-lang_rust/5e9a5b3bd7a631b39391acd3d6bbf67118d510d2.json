{"sha": "5e9a5b3bd7a631b39391acd3d6bbf67118d510d2", "node_id": "MDY6Q29tbWl0NzI0NzEyOjVlOWE1YjNiZDdhNjMxYjM5MzkxYWNkM2Q2YmJmNjcxMThkNTEwZDI=", "commit": {"author": {"name": "Eduard-Mihai Burtescu", "email": "edy.burt@gmail.com", "date": "2016-08-18T03:12:21Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2016-08-18T03:12:21Z"}, "message": "Rollup merge of #35734 - japaric:mips-uclibc, r=alexcrichton\n\nadd mips-uclibc targets\n\nThese targets cover OpenWRT 15.05 devices, which use the soft float ABI\nand the uclibc library. None of the other built-in mips targets covered\nthose devices (mips-gnu is hard float and glibc-based, mips-musl is\nmusl-based).\n\nWith this commit one can now build std for these devices using these\ncommands:\n\n```\n$ configure --enable-rustbuild --target=mips-unknown-linux-uclibc\n$ make\n```\n\ncc #35673\n\n---\n\nr? @alexcrichton\ncc @felixalias This is the target the rust-tessel project should be using.\nNote that the libc crate doesn't support the uclibc library and will have to be updated. We are lucky that uclibc and glibc are somewhat similar and one can build std and even run the libc-test test suite with the current, unmodified libc. About that last part, I tried to run the libc-test and got a bunch of compile errors. I don't intend to fix them but I'll post some instruction about how to run libc-test in the rust-lang/libc issue tracker.", "tree": {"sha": "6a4ca3f46f56f63f23d06a4b91a6957d2fab6795", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6a4ca3f46f56f63f23d06a4b91a6957d2fab6795"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/5e9a5b3bd7a631b39391acd3d6bbf67118d510d2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/5e9a5b3bd7a631b39391acd3d6bbf67118d510d2", "html_url": "https://github.com/rust-lang/rust/commit/5e9a5b3bd7a631b39391acd3d6bbf67118d510d2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/5e9a5b3bd7a631b39391acd3d6bbf67118d510d2/comments", "author": {"login": "eddyb", "id": 77424, "node_id": "MDQ6VXNlcjc3NDI0", "avatar_url": "https://avatars.githubusercontent.com/u/77424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eddyb", "html_url": "https://github.com/eddyb", "followers_url": "https://api.github.com/users/eddyb/followers", "following_url": "https://api.github.com/users/eddyb/following{/other_user}", "gists_url": "https://api.github.com/users/eddyb/gists{/gist_id}", "starred_url": "https://api.github.com/users/eddyb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eddyb/subscriptions", "organizations_url": "https://api.github.com/users/eddyb/orgs", "repos_url": "https://api.github.com/users/eddyb/repos", "events_url": "https://api.github.com/users/eddyb/events{/privacy}", "received_events_url": "https://api.github.com/users/eddyb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "612506bfff93bd11f42c794b0b8560f0ee35b8bc", "url": "https://api.github.com/repos/rust-lang/rust/commits/612506bfff93bd11f42c794b0b8560f0ee35b8bc", "html_url": "https://github.com/rust-lang/rust/commit/612506bfff93bd11f42c794b0b8560f0ee35b8bc"}, {"sha": "1cf9cafeb14c4e9b16727b10953da95c5c5b0b1d", "url": "https://api.github.com/repos/rust-lang/rust/commits/1cf9cafeb14c4e9b16727b10953da95c5c5b0b1d", "html_url": "https://github.com/rust-lang/rust/commit/1cf9cafeb14c4e9b16727b10953da95c5c5b0b1d"}], "stats": {"total": 65, "additions": 65, "deletions": 0}, "files": [{"sha": "34aee77ae2107fbe45fcb960d74d2ffdd5c57bf1", "filename": "mk/cfg/mips-unknown-linux-uclibc.mk", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5e9a5b3bd7a631b39391acd3d6bbf67118d510d2/mk%2Fcfg%2Fmips-unknown-linux-uclibc.mk", "raw_url": "https://github.com/rust-lang/rust/raw/5e9a5b3bd7a631b39391acd3d6bbf67118d510d2/mk%2Fcfg%2Fmips-unknown-linux-uclibc.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fcfg%2Fmips-unknown-linux-uclibc.mk?ref=5e9a5b3bd7a631b39391acd3d6bbf67118d510d2", "patch": "@@ -0,0 +1 @@\n+# rustbuild-only target"}, {"sha": "34aee77ae2107fbe45fcb960d74d2ffdd5c57bf1", "filename": "mk/cfg/mipsel-unknown-linux-uclibc.mk", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/5e9a5b3bd7a631b39391acd3d6bbf67118d510d2/mk%2Fcfg%2Fmipsel-unknown-linux-uclibc.mk", "raw_url": "https://github.com/rust-lang/rust/raw/5e9a5b3bd7a631b39391acd3d6bbf67118d510d2/mk%2Fcfg%2Fmipsel-unknown-linux-uclibc.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fcfg%2Fmipsel-unknown-linux-uclibc.mk?ref=5e9a5b3bd7a631b39391acd3d6bbf67118d510d2", "patch": "@@ -0,0 +1 @@\n+# rustbuild-only target"}, {"sha": "529bd310391cde4b9a8b4ad019d94bc27732d18e", "filename": "src/librustc_back/target/mips_unknown_linux_uclibc.rs", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/5e9a5b3bd7a631b39391acd3d6bbf67118d510d2/src%2Flibrustc_back%2Ftarget%2Fmips_unknown_linux_uclibc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e9a5b3bd7a631b39391acd3d6bbf67118d510d2/src%2Flibrustc_back%2Ftarget%2Fmips_unknown_linux_uclibc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fmips_unknown_linux_uclibc.rs?ref=5e9a5b3bd7a631b39391acd3d6bbf67118d510d2", "patch": "@@ -0,0 +1,30 @@\n+// Copyright 2016 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+use target::{Target, TargetOptions, TargetResult};\n+\n+pub fn target() -> TargetResult {\n+    Ok(Target {\n+        llvm_target: \"mips-unknown-linux-uclibc\".to_string(),\n+        target_endian: \"big\".to_string(),\n+        target_pointer_width: \"32\".to_string(),\n+        data_layout: \"E-m:m-p:32:32-i8:8:32-i16:16:32-i64:64-n32-S64\".to_string(),\n+        arch: \"mips\".to_string(),\n+        target_os: \"linux\".to_string(),\n+        target_env: \"uclibc\".to_string(),\n+        target_vendor: \"unknown\".to_string(),\n+        options: TargetOptions {\n+            cpu: \"mips32r2\".to_string(),\n+            features: \"+mips32r2,+soft-float\".to_string(),\n+            max_atomic_width: 32,\n+            ..super::linux_base::opts()\n+        },\n+    })\n+}"}, {"sha": "1040a0fbe1724b558bad164e19819bd832ba085b", "filename": "src/librustc_back/target/mipsel_unknown_linux_uclibc.rs", "status": "added", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/5e9a5b3bd7a631b39391acd3d6bbf67118d510d2/src%2Flibrustc_back%2Ftarget%2Fmipsel_unknown_linux_uclibc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e9a5b3bd7a631b39391acd3d6bbf67118d510d2/src%2Flibrustc_back%2Ftarget%2Fmipsel_unknown_linux_uclibc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fmipsel_unknown_linux_uclibc.rs?ref=5e9a5b3bd7a631b39391acd3d6bbf67118d510d2", "patch": "@@ -0,0 +1,31 @@\n+// Copyright 2016 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+use target::{Target, TargetOptions, TargetResult};\n+\n+pub fn target() -> TargetResult {\n+    Ok(Target {\n+        llvm_target: \"mipsel-unknown-linux-uclibc\".to_string(),\n+        target_endian: \"little\".to_string(),\n+        target_pointer_width: \"32\".to_string(),\n+        data_layout: \"e-m:m-p:32:32-i8:8:32-i16:16:32-i64:64-n32-S64\".to_string(),\n+        arch: \"mips\".to_string(),\n+        target_os: \"linux\".to_string(),\n+        target_env: \"uclibc\".to_string(),\n+        target_vendor: \"unknown\".to_string(),\n+\n+        options: TargetOptions {\n+            cpu: \"mips32\".to_string(),\n+            features: \"+mips32,+soft-float\".to_string(),\n+            max_atomic_width: 32,\n+            ..super::linux_base::opts()\n+        },\n+    })\n+}"}, {"sha": "86cd86d282cf5d121842cdb4d3581f9c1f5b7597", "filename": "src/librustc_back/target/mod.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/5e9a5b3bd7a631b39391acd3d6bbf67118d510d2/src%2Flibrustc_back%2Ftarget%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/5e9a5b3bd7a631b39391acd3d6bbf67118d510d2/src%2Flibrustc_back%2Ftarget%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fmod.rs?ref=5e9a5b3bd7a631b39391acd3d6bbf67118d510d2", "patch": "@@ -143,6 +143,8 @@ supported_targets! {\n     (\"i686-unknown-linux-musl\", i686_unknown_linux_musl),\n     (\"mips-unknown-linux-musl\", mips_unknown_linux_musl),\n     (\"mipsel-unknown-linux-musl\", mipsel_unknown_linux_musl),\n+    (\"mips-unknown-linux-uclibc\", mips_unknown_linux_uclibc),\n+    (\"mipsel-unknown-linux-uclibc\", mipsel_unknown_linux_uclibc),\n \n     (\"i686-linux-android\", i686_linux_android),\n     (\"arm-linux-androideabi\", arm_linux_androideabi),"}]}