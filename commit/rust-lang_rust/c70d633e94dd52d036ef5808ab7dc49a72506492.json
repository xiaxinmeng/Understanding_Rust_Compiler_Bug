{"sha": "c70d633e94dd52d036ef5808ab7dc49a72506492", "node_id": "MDY6Q29tbWl0NzI0NzEyOmM3MGQ2MzNlOTRkZDUyZDAzNmVmNTgwOGFiN2RjNDlhNzI1MDY0OTI=", "commit": {"author": {"name": "Jorge Aparicio", "email": "japaricious@gmail.com", "date": "2016-08-27T22:12:37Z"}, "committer": {"name": "Jorge Aparicio", "email": "japaricious@gmail.com", "date": "2016-08-27T22:13:13Z"}, "message": "rustbuild: skip filecheck check if codegen tests are disabled\n\nto match the behavior of the old Makefile-based build system\n\ncloses #35752", "tree": {"sha": "738e82af4e5738fea3fd335b8d97e296dd0ca69e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/738e82af4e5738fea3fd335b8d97e296dd0ca69e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c70d633e94dd52d036ef5808ab7dc49a72506492", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c70d633e94dd52d036ef5808ab7dc49a72506492", "html_url": "https://github.com/rust-lang/rust/commit/c70d633e94dd52d036ef5808ab7dc49a72506492", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c70d633e94dd52d036ef5808ab7dc49a72506492/comments", "author": null, "committer": null, "parents": [{"sha": "11946956a6352f49c6aadc1c13c39757a046e0c2", "url": "https://api.github.com/repos/rust-lang/rust/commits/11946956a6352f49c6aadc1c13c39757a046e0c2", "html_url": "https://github.com/rust-lang/rust/commit/11946956a6352f49c6aadc1c13c39757a046e0c2"}], "stats": {"total": 5, "additions": 4, "deletions": 1}, "files": [{"sha": "682a6f74126a8278555573a5743a057711cdc9eb", "filename": "src/bootstrap/config.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/c70d633e94dd52d036ef5808ab7dc49a72506492/src%2Fbootstrap%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c70d633e94dd52d036ef5808ab7dc49a72506492/src%2Fbootstrap%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.rs?ref=c70d633e94dd52d036ef5808ab7dc49a72506492", "patch": "@@ -78,6 +78,7 @@ pub struct Config {\n     pub channel: String,\n     pub musl_root: Option<PathBuf>,\n     pub prefix: Option<String>,\n+    pub codegen_tests: bool,\n }\n \n /// Per-target configuration stored in the global configuration structure.\n@@ -169,6 +170,7 @@ impl Config {\n         config.rust_codegen_units = 1;\n         config.build = build.to_string();\n         config.channel = \"dev\".to_string();\n+        config.codegen_tests = true;\n \n         let toml = file.map(|file| {\n             let mut f = t!(File::open(&file));\n@@ -322,6 +324,7 @@ impl Config {\n                 (\"DEBUGINFO_TESTS\", self.rust_debuginfo_tests),\n                 (\"LOCAL_REBUILD\", self.local_rebuild),\n                 (\"NINJA\", self.ninja),\n+                (\"CODEGEN_TESTS\", self.codegen_tests),\n             }\n \n             match key {"}, {"sha": "c0d303c0ea9aeb19fe70e7319bdb78178d52920e", "filename": "src/bootstrap/sanity.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/c70d633e94dd52d036ef5808ab7dc49a72506492/src%2Fbootstrap%2Fsanity.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c70d633e94dd52d036ef5808ab7dc49a72506492/src%2Fbootstrap%2Fsanity.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fsanity.rs?ref=c70d633e94dd52d036ef5808ab7dc49a72506492", "patch": "@@ -89,7 +89,7 @@ pub fn check(build: &mut Build) {\n \n     // Externally configured LLVM requires FileCheck to exist\n     let filecheck = build.llvm_filecheck(&build.config.build);\n-    if !filecheck.starts_with(&build.out) && !filecheck.exists() {\n+    if !filecheck.starts_with(&build.out) && !filecheck.exists() && build.config.codegen_tests {\n         panic!(\"filecheck executable {:?} does not exist\", filecheck);\n     }\n "}]}