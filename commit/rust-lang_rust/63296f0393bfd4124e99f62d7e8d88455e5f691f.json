{"sha": "63296f0393bfd4124e99f62d7e8d88455e5f691f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjYzMjk2ZjAzOTNiZmQ0MTI0ZTk5ZjYyZDdlOGQ4ODQ1NWU1ZjY5MWY=", "commit": {"author": {"name": "Enrico Schmitz", "email": "enrico@schmitz.link", "date": "2017-03-01T14:06:53Z"}, "committer": {"name": "Enrico Schmitz", "email": "es@mdtm.de", "date": "2017-03-01T14:06:53Z"}, "message": "Handle signed types in node_as_const_fullint", "tree": {"sha": "9e62b6de81bf641c843641f837001a4cd96a8e26", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9e62b6de81bf641c843641f837001a4cd96a8e26"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/63296f0393bfd4124e99f62d7e8d88455e5f691f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/63296f0393bfd4124e99f62d7e8d88455e5f691f", "html_url": "https://github.com/rust-lang/rust/commit/63296f0393bfd4124e99f62d7e8d88455e5f691f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/63296f0393bfd4124e99f62d7e8d88455e5f691f/comments", "author": {"login": "ensch", "id": 180274, "node_id": "MDQ6VXNlcjE4MDI3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/180274?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ensch", "html_url": "https://github.com/ensch", "followers_url": "https://api.github.com/users/ensch/followers", "following_url": "https://api.github.com/users/ensch/following{/other_user}", "gists_url": "https://api.github.com/users/ensch/gists{/gist_id}", "starred_url": "https://api.github.com/users/ensch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ensch/subscriptions", "organizations_url": "https://api.github.com/users/ensch/orgs", "repos_url": "https://api.github.com/users/ensch/repos", "events_url": "https://api.github.com/users/ensch/events{/privacy}", "received_events_url": "https://api.github.com/users/ensch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ensch", "id": 180274, "node_id": "MDQ6VXNlcjE4MDI3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/180274?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ensch", "html_url": "https://github.com/ensch", "followers_url": "https://api.github.com/users/ensch/followers", "following_url": "https://api.github.com/users/ensch/following{/other_user}", "gists_url": "https://api.github.com/users/ensch/gists{/gist_id}", "starred_url": "https://api.github.com/users/ensch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ensch/subscriptions", "organizations_url": "https://api.github.com/users/ensch/orgs", "repos_url": "https://api.github.com/users/ensch/repos", "events_url": "https://api.github.com/users/ensch/events{/privacy}", "received_events_url": "https://api.github.com/users/ensch/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7e24e1db09105bf0bdd5249848a20e07526c4579", "url": "https://api.github.com/repos/rust-lang/rust/commits/7e24e1db09105bf0bdd5249848a20e07526c4579", "html_url": "https://github.com/rust-lang/rust/commit/7e24e1db09105bf0bdd5249848a20e07526c4579"}], "stats": {"total": 6, "additions": 5, "deletions": 1}, "files": [{"sha": "4521ce426b5795460436d18ce0b7433aaa5ad122", "filename": "clippy_lints/src/types.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/63296f0393bfd4124e99f62d7e8d88455e5f691f/clippy_lints%2Fsrc%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/63296f0393bfd4124e99f62d7e8d88455e5f691f/clippy_lints%2Fsrc%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Ftypes.rs?ref=63296f0393bfd4124e99f62d7e8d88455e5f691f", "patch": "@@ -5,6 +5,7 @@ use rustc::lint::*;\n use rustc::ty;\n use std::cmp::Ordering;\n use syntax::ast::{IntTy, UintTy, FloatTy};\n+use syntax::attr::IntType;\n use syntax::codemap::Span;\n use utils::{comparisons, higher, in_external_macro, in_macro, match_def_path, snippet, span_help_and_lint, span_lint,\n             opt_def_id, last_path_segment};\n@@ -1111,7 +1112,10 @@ fn node_as_const_fullint(cx: &LateContext, expr: &Expr) -> Option<FullInt> {\n     match ConstContext::with_tables(cx.tcx, cx.tables).eval(expr) {\n         Ok(val) => {\n             if let Integral(const_int) = val {\n-                Some(FullInt::U(const_int.to_u128_unchecked()))\n+                match const_int.int_type() {\n+                    IntType::SignedInt(_) => Some(FullInt::S(const_int.to_u128_unchecked() as i128)),\n+                    IntType::UnsignedInt(_) => Some(FullInt::U(const_int.to_u128_unchecked())),\n+                }\n             } else {\n                 None\n             }"}]}