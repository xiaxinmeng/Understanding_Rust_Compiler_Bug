{"sha": "757913df08f11e216b617a557959f5c28d2974ca", "node_id": "C_kwDOAAsO6NoAKDc1NzkxM2RmMDhmMTFlMjE2YjYxN2E1NTc5NTlmNWMyOGQyOTc0Y2E", "commit": {"author": {"name": "Eric Huss", "email": "eric@huss.org", "date": "2022-08-21T05:24:31Z"}, "committer": {"name": "Eric Huss", "email": "eric@huss.org", "date": "2022-08-21T05:24:31Z"}, "message": "bootstrap: Don't allow rustfmt to fail on dist.\n\nWhen running `x.py dist`, rustfmt was being allowed to fail when\nmissing-tools is true. This isn't much of an issue in practice\nsince other CI jobs will fail if rustfmt fails. This code was just\nleftovers from when rustfmt was tracked in toolstate, and this removes\nit to make it clear that it no longer works that way.", "tree": {"sha": "41e3184cd7ae03ca0972c87a4a119ab752ca87e4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/41e3184cd7ae03ca0972c87a4a119ab752ca87e4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/757913df08f11e216b617a557959f5c28d2974ca", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/757913df08f11e216b617a557959f5c28d2974ca", "html_url": "https://github.com/rust-lang/rust/commit/757913df08f11e216b617a557959f5c28d2974ca", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/757913df08f11e216b617a557959f5c28d2974ca/comments", "author": {"login": "ehuss", "id": 43198, "node_id": "MDQ6VXNlcjQzMTk4", "avatar_url": "https://avatars.githubusercontent.com/u/43198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ehuss", "html_url": "https://github.com/ehuss", "followers_url": "https://api.github.com/users/ehuss/followers", "following_url": "https://api.github.com/users/ehuss/following{/other_user}", "gists_url": "https://api.github.com/users/ehuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/ehuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ehuss/subscriptions", "organizations_url": "https://api.github.com/users/ehuss/orgs", "repos_url": "https://api.github.com/users/ehuss/repos", "events_url": "https://api.github.com/users/ehuss/events{/privacy}", "received_events_url": "https://api.github.com/users/ehuss/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ehuss", "id": 43198, "node_id": "MDQ6VXNlcjQzMTk4", "avatar_url": "https://avatars.githubusercontent.com/u/43198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ehuss", "html_url": "https://github.com/ehuss", "followers_url": "https://api.github.com/users/ehuss/followers", "following_url": "https://api.github.com/users/ehuss/following{/other_user}", "gists_url": "https://api.github.com/users/ehuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/ehuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ehuss/subscriptions", "organizations_url": "https://api.github.com/users/ehuss/orgs", "repos_url": "https://api.github.com/users/ehuss/repos", "events_url": "https://api.github.com/users/ehuss/events{/privacy}", "received_events_url": "https://api.github.com/users/ehuss/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "45e2fc3d4fd948441806f273bf34218fced0ad07", "url": "https://api.github.com/repos/rust-lang/rust/commits/45e2fc3d4fd948441806f273bf34218fced0ad07", "html_url": "https://github.com/rust-lang/rust/commit/45e2fc3d4fd948441806f273bf34218fced0ad07"}], "stats": {"total": 11, "additions": 2, "deletions": 9}, "files": [{"sha": "6bf57a89e896f371941b7f65c1290f24dbe05b9a", "filename": "src/bootstrap/dist.rs", "status": "modified", "additions": 2, "deletions": 9, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/757913df08f11e216b617a557959f5c28d2974ca/src%2Fbootstrap%2Fdist.rs", "raw_url": "https://github.com/rust-lang/rust/raw/757913df08f11e216b617a557959f5c28d2974ca/src%2Fbootstrap%2Fdist.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdist.rs?ref=757913df08f11e216b617a557959f5c28d2974ca", "patch": "@@ -1226,17 +1226,10 @@ impl Step for Rustfmt {\n \n         let rustfmt = builder\n             .ensure(tool::Rustfmt { compiler, target, extra_features: Vec::new() })\n-            .or_else(|| {\n-                missing_tool(\"Rustfmt\", builder.build.config.missing_tools);\n-                None\n-            })?;\n+            .expect(\"rustfmt expected to build - essential tool\");\n         let cargofmt = builder\n             .ensure(tool::Cargofmt { compiler, target, extra_features: Vec::new() })\n-            .or_else(|| {\n-                missing_tool(\"Cargofmt\", builder.build.config.missing_tools);\n-                None\n-            })?;\n-\n+            .expect(\"cargo fmt expected to build - essential tool\");\n         let mut tarball = Tarball::new(builder, \"rustfmt\", &target.triple);\n         tarball.set_overlay(OverlayKind::Rustfmt);\n         tarball.is_preview(true);"}]}