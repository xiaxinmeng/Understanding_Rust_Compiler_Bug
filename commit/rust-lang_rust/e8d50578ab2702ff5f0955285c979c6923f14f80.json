{"sha": "e8d50578ab2702ff5f0955285c979c6923f14f80", "node_id": "MDY6Q29tbWl0NzI0NzEyOmU4ZDUwNTc4YWIyNzAyZmY1ZjA5NTUyODVjOTc5YzY5MjNmMTRmODA=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2020-06-09T11:45:18Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2020-06-09T11:45:18Z"}, "message": "Correctly parse <_> paths in patterns\n\ncloses #3659", "tree": {"sha": "a0b6651453194d06795ecb76e556baf5c6d082fd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a0b6651453194d06795ecb76e556baf5c6d082fd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e8d50578ab2702ff5f0955285c979c6923f14f80", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e8d50578ab2702ff5f0955285c979c6923f14f80", "html_url": "https://github.com/rust-lang/rust/commit/e8d50578ab2702ff5f0955285c979c6923f14f80", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e8d50578ab2702ff5f0955285c979c6923f14f80/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "16943e533c68427e3381e03b49de29e0d6c0450c", "url": "https://api.github.com/repos/rust-lang/rust/commits/16943e533c68427e3381e03b49de29e0d6c0450c", "html_url": "https://github.com/rust-lang/rust/commit/16943e533c68427e3381e03b49de29e0d6c0450c"}], "stats": {"total": 119, "additions": 80, "deletions": 39}, "files": [{"sha": "427c0eb49c2fd04c67b09352ffd5917d2ab17af5", "filename": "crates/ra_parser/src/grammar/patterns.rs", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/e8d50578ab2702ff5f0955285c979c6923f14f80/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fpatterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e8d50578ab2702ff5f0955285c979c6923f14f80/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fpatterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_parser%2Fsrc%2Fgrammar%2Fpatterns.rs?ref=e8d50578ab2702ff5f0955285c979c6923f14f80", "patch": "@@ -88,7 +88,9 @@ fn atom_pat(p: &mut Parser, recovery_set: TokenSet) -> Option<CompletedMarker> {\n             _ => bind_pat(p, true),\n         },\n \n-        _ if paths::is_use_path_start(p) => path_or_macro_pat(p),\n+        // test type_path_in_pattern\n+        // fn main() { let <_>::Foo = (); }\n+        _ if paths::is_path_start(p) => path_or_macro_pat(p),\n         _ if is_literal_pat_start(p) => literal_pat(p),\n \n         T![.] if p.at(T![..]) => dot_dot_pat(p),\n@@ -138,7 +140,7 @@ fn literal_pat(p: &mut Parser) -> CompletedMarker {\n //     let Bar(..) = ();\n // }\n fn path_or_macro_pat(p: &mut Parser) -> CompletedMarker {\n-    assert!(paths::is_use_path_start(p));\n+    assert!(paths::is_path_start(p));\n     let m = p.start();\n     paths::expr_path(p);\n     let kind = match p.current() {"}, {"sha": "48610a5ebbe2ae29c2cfc439c03a982ad96f944a", "filename": "crates/ra_syntax/test_data/parser/err/0024_many_type_parens.rast", "status": "modified", "additions": 37, "deletions": 37, "changes": 74, "blob_url": "https://github.com/rust-lang/rust/blob/e8d50578ab2702ff5f0955285c979c6923f14f80/crates%2Fra_syntax%2Ftest_data%2Fparser%2Ferr%2F0024_many_type_parens.rast", "raw_url": "https://github.com/rust-lang/rust/raw/e8d50578ab2702ff5f0955285c979c6923f14f80/crates%2Fra_syntax%2Ftest_data%2Fparser%2Ferr%2F0024_many_type_parens.rast", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Ferr%2F0024_many_type_parens.rast?ref=e8d50578ab2702ff5f0955285c979c6923f14f80", "patch": "@@ -180,44 +180,45 @@ SOURCE_FILE@0..240\n       EXPR_STMT@150..180\n         TUPLE_EXPR@150..180\n           L_PAREN@150..151 \"(\"\n-          BIN_EXPR@151..180\n-            BIN_EXPR@151..178\n-              BIN_EXPR@151..169\n-                BIN_EXPR@151..167\n-                  BIN_EXPR@151..164\n-                    FOR_EXPR@151..157\n-                      FOR_KW@151..154 \"for\"\n-                      ERROR@154..155\n-                        L_ANGLE@154..155 \"<\"\n-                      ERROR@155..157\n-                        LIFETIME@155..157 \"\\'a\"\n-                    R_ANGLE@157..158 \">\"\n-                    WHITESPACE@158..159 \" \"\n+          FOR_EXPR@151..180\n+            FOR_KW@151..154 \"for\"\n+            PATH_PAT@154..158\n+              PATH@154..158\n+                PATH_SEGMENT@154..158\n+                  L_ANGLE@154..155 \"<\"\n+                  ERROR@155..157\n+                    LIFETIME@155..157 \"\\'a\"\n+                  R_ANGLE@157..158 \">\"\n+            WHITESPACE@158..159 \" \"\n+            BIN_EXPR@159..180\n+              BIN_EXPR@159..178\n+                BIN_EXPR@159..169\n+                  BIN_EXPR@159..167\n                     PATH_EXPR@159..164\n                       PATH@159..164\n                         PATH_SEGMENT@159..164\n                           NAME_REF@159..164\n                             IDENT@159..164 \"Trait\"\n-                  L_ANGLE@164..165 \"<\"\n-                  ERROR@165..167\n-                    LIFETIME@165..167 \"\\'a\"\n-                R_ANGLE@167..168 \">\"\n-                ERROR@168..169\n-                  R_PAREN@168..169 \")\"\n-              WHITESPACE@169..170 \" \"\n-              PLUS@170..171 \"+\"\n-              WHITESPACE@171..172 \" \"\n-              PAREN_EXPR@172..178\n-                L_PAREN@172..173 \"(\"\n-                PATH_EXPR@173..177\n-                  PATH@173..177\n-                    PATH_SEGMENT@173..177\n-                      NAME_REF@173..177\n-                        IDENT@173..177 \"Copy\"\n-                R_PAREN@177..178 \")\"\n-            R_ANGLE@178..179 \">\"\n-            ERROR@179..180\n-              SEMICOLON@179..180 \";\"\n+                    L_ANGLE@164..165 \"<\"\n+                    ERROR@165..167\n+                      LIFETIME@165..167 \"\\'a\"\n+                  R_ANGLE@167..168 \">\"\n+                  ERROR@168..169\n+                    R_PAREN@168..169 \")\"\n+                WHITESPACE@169..170 \" \"\n+                PLUS@170..171 \"+\"\n+                WHITESPACE@171..172 \" \"\n+                PAREN_EXPR@172..178\n+                  L_PAREN@172..173 \"(\"\n+                  PATH_EXPR@173..177\n+                    PATH@173..177\n+                      PATH_SEGMENT@173..177\n+                        NAME_REF@173..177\n+                          IDENT@173..177 \"Copy\"\n+                  R_PAREN@177..178 \")\"\n+              R_ANGLE@178..179 \">\"\n+              ERROR@179..180\n+                SEMICOLON@179..180 \";\"\n       WHITESPACE@180..185 \"\\n    \"\n       LET_STMT@185..235\n         LET_KW@185..188 \"let\"\n@@ -302,13 +303,12 @@ error 146..146: expected expression\n error 147..147: expected SEMICOLON\n error 148..148: expected expression\n error 149..149: expected SEMICOLON\n-error 154..154: expected pattern\n-error 155..155: expected IN_KW\n-error 155..155: expected expression\n-error 157..157: expected a block\n+error 155..155: expected type\n+error 158..158: expected IN_KW\n error 165..165: expected expression\n error 168..168: expected expression\n error 179..179: expected expression\n+error 180..180: expected a block\n error 180..180: expected COMMA\n error 180..180: expected expression\n error 180..180: expected R_PAREN"}, {"sha": "8688992750d61d79b57dbdacdf0227dc0bc8559d", "filename": "crates/ra_syntax/test_data/parser/inline/ok/0164_type_path_in_pattern.rast", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/e8d50578ab2702ff5f0955285c979c6923f14f80/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0164_type_path_in_pattern.rast", "raw_url": "https://github.com/rust-lang/rust/raw/e8d50578ab2702ff5f0955285c979c6923f14f80/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0164_type_path_in_pattern.rast", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0164_type_path_in_pattern.rast?ref=e8d50578ab2702ff5f0955285c979c6923f14f80", "patch": "@@ -0,0 +1,38 @@\n+SOURCE_FILE@0..33\n+  FN_DEF@0..32\n+    FN_KW@0..2 \"fn\"\n+    WHITESPACE@2..3 \" \"\n+    NAME@3..7\n+      IDENT@3..7 \"main\"\n+    PARAM_LIST@7..9\n+      L_PAREN@7..8 \"(\"\n+      R_PAREN@8..9 \")\"\n+    WHITESPACE@9..10 \" \"\n+    BLOCK_EXPR@10..32\n+      L_CURLY@10..11 \"{\"\n+      WHITESPACE@11..12 \" \"\n+      LET_STMT@12..30\n+        LET_KW@12..15 \"let\"\n+        WHITESPACE@15..16 \" \"\n+        PATH_PAT@16..24\n+          PATH@16..24\n+            PATH@16..19\n+              PATH_SEGMENT@16..19\n+                L_ANGLE@16..17 \"<\"\n+                PLACEHOLDER_TYPE@17..18\n+                  UNDERSCORE@17..18 \"_\"\n+                R_ANGLE@18..19 \">\"\n+            COLON2@19..21 \"::\"\n+            PATH_SEGMENT@21..24\n+              NAME_REF@21..24\n+                IDENT@21..24 \"Foo\"\n+        WHITESPACE@24..25 \" \"\n+        EQ@25..26 \"=\"\n+        WHITESPACE@26..27 \" \"\n+        TUPLE_EXPR@27..29\n+          L_PAREN@27..28 \"(\"\n+          R_PAREN@28..29 \")\"\n+        SEMICOLON@29..30 \";\"\n+      WHITESPACE@30..31 \" \"\n+      R_CURLY@31..32 \"}\"\n+  WHITESPACE@32..33 \"\\n\""}, {"sha": "ebe26834d883feedb5b51c3516cacfe5ff12c1ef", "filename": "crates/ra_syntax/test_data/parser/inline/ok/0164_type_path_in_pattern.rs", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/e8d50578ab2702ff5f0955285c979c6923f14f80/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0164_type_path_in_pattern.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e8d50578ab2702ff5f0955285c979c6923f14f80/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0164_type_path_in_pattern.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0164_type_path_in_pattern.rs?ref=e8d50578ab2702ff5f0955285c979c6923f14f80", "patch": "@@ -0,0 +1 @@\n+fn main() { let <_>::Foo = (); }"}]}