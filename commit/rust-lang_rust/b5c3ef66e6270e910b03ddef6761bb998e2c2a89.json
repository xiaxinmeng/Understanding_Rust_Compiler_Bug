{"sha": "b5c3ef66e6270e910b03ddef6761bb998e2c2a89", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI1YzNlZjY2ZTYyNzBlOTEwYjAzZGRlZjY3NjFiYjk5OGUyYzJhODk=", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2021-06-16T20:54:56Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-06-16T20:54:56Z"}, "message": "Rollup merge of #86260 - jsha:expand-methods, r=GuillaumeGomez\n\nOpen trait implementations' toggles by default.\n\nThis makes it possible to use Ctrl-F to find methods defined in traits.\n\nAs discussed in #85923. This modifies the approach suggested in #40363, but still achieves the goal of skimmability. For new users who aren't familiar with all the traits, their methods are readily visible and searchable. For experienced users who prefer to skim the list of all traits, there are two options: the \"collapse all\" shortcut, and the \"auto hide trait implementations\" setting.\n\nDemo https://hoffman-andrews.com/rust/expand-methods/std/string/struct.String.html#trait-implementations\n\nr? `@GuillaumeGomez`", "tree": {"sha": "344bc5fa01a9a699bccad416eb96d50c9b477713", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/344bc5fa01a9a699bccad416eb96d50c9b477713"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b5c3ef66e6270e910b03ddef6761bb998e2c2a89", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgymUgCRBK7hj4Ov3rIwAApXMIAEdxYKeVeZ2Jlx9mNgTLYegG\nJgXOMv4CMiez+eykJnrtDrXlR7wynqyQZ1XF7c1b8XdX0Djmf4tM4Eb9FHgUmEQl\nBlxxEXF+3t1HlVXZ+E3TRvYvzm87Cgi8pNMbGZYkOdraS2U1A9Ly9ha6pied6ZXe\niyfggDL0JoXaNC9awoU7zP4ItnAG4atYLAwIRJA+azttzPW5KnxnzSi0ltPuUbQ9\nU79hNDvNyS5zX9nLVz44ypWU3cfgIZBf+JsR3ycvlL86YgA1MPuL++UXYeYYos67\nQVMmS7nlhFaCY+I8Rn/gkaptV+U0lndgnkeGPeiIUh/UzWRHH/zIgyEDR2hFCAs=\n=Wlci\n-----END PGP SIGNATURE-----\n", "payload": "tree 344bc5fa01a9a699bccad416eb96d50c9b477713\nparent 0d14acad7ed9dca93a0e67030803e9ea2c9f87bf\nparent 62658bfc227dee9d8ac4f5d207a8a59bc315977c\nauthor Yuki Okushi <jtitor@2k36.org> 1623876896 +0900\ncommitter GitHub <noreply@github.com> 1623876896 +0900\n\nRollup merge of #86260 - jsha:expand-methods, r=GuillaumeGomez\n\nOpen trait implementations' toggles by default.\n\nThis makes it possible to use Ctrl-F to find methods defined in traits.\n\nAs discussed in #85923. This modifies the approach suggested in #40363, but still achieves the goal of skimmability. For new users who aren't familiar with all the traits, their methods are readily visible and searchable. For experienced users who prefer to skim the list of all traits, there are two options: the \"collapse all\" shortcut, and the \"auto hide trait implementations\" setting.\n\nDemo https://hoffman-andrews.com/rust/expand-methods/std/string/struct.String.html#trait-implementations\n\nr? `@GuillaumeGomez`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b5c3ef66e6270e910b03ddef6761bb998e2c2a89", "html_url": "https://github.com/rust-lang/rust/commit/b5c3ef66e6270e910b03ddef6761bb998e2c2a89", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b5c3ef66e6270e910b03ddef6761bb998e2c2a89/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0d14acad7ed9dca93a0e67030803e9ea2c9f87bf", "url": "https://api.github.com/repos/rust-lang/rust/commits/0d14acad7ed9dca93a0e67030803e9ea2c9f87bf", "html_url": "https://github.com/rust-lang/rust/commit/0d14acad7ed9dca93a0e67030803e9ea2c9f87bf"}, {"sha": "62658bfc227dee9d8ac4f5d207a8a59bc315977c", "url": "https://api.github.com/repos/rust-lang/rust/commits/62658bfc227dee9d8ac4f5d207a8a59bc315977c", "html_url": "https://github.com/rust-lang/rust/commit/62658bfc227dee9d8ac4f5d207a8a59bc315977c"}], "stats": {"total": 28, "additions": 14, "deletions": 14}, "files": [{"sha": "0efa014b12748d473a084d58b55cee1a93c2a81c", "filename": "src/librustdoc/html/render/mod.rs", "status": "modified", "additions": 2, "deletions": 7, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/b5c3ef66e6270e910b03ddef6761bb998e2c2a89/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b5c3ef66e6270e910b03ddef6761bb998e2c2a89/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs?ref=b5c3ef66e6270e910b03ddef6761bb998e2c2a89", "patch": "@@ -488,7 +488,7 @@ fn settings(root_path: &str, suffix: &str, themes: &[StylePath]) -> Result<Strin\n             .into(),\n         (\"auto-hide-large-items\", \"Auto-hide item contents for large items.\", true).into(),\n         (\"auto-hide-method-docs\", \"Auto-hide item methods' documentation\", false).into(),\n-        (\"auto-hide-trait-implementations\", \"Auto-hide trait implementation documentation\", true)\n+        (\"auto-hide-trait-implementations\", \"Auto-hide trait implementation documentation\", false)\n             .into(),\n         (\"auto-collapse-implementors\", \"Auto-hide implementors of a trait\", true).into(),\n         (\"go-to-only-result\", \"Directly go to item in search if there is only one result\", false)\n@@ -1543,15 +1543,10 @@ fn render_impl(\n         }\n     }\n     if render_mode == RenderMode::Normal {\n-        let is_implementing_trait = i.inner_impl().trait_.is_some();\n         let toggled = !impl_items.is_empty() || !default_impl_items.is_empty();\n         if toggled {\n             close_tags.insert_str(0, \"</details>\");\n-            if is_implementing_trait {\n-                write!(w, \"<details class=\\\"rustdoc-toggle implementors-toggle\\\">\");\n-            } else {\n-                write!(w, \"<details class=\\\"rustdoc-toggle implementors-toggle\\\" open>\");\n-            }\n+            write!(w, \"<details class=\\\"rustdoc-toggle implementors-toggle\\\" open>\");\n         }\n         if toggled {\n             write!(w, \"<summary>\")"}, {"sha": "e43a231d7570ba9f3be40069ff00dfb763b7cd4b", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/b5c3ef66e6270e910b03ddef6761bb998e2c2a89/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/b5c3ef66e6270e910b03ddef6761bb998e2c2a89/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=b5c3ef66e6270e910b03ddef6761bb998e2c2a89", "patch": "@@ -779,25 +779,25 @@ function hideThemeButtonState() {\n \n         var hideMethodDocs = getSettingValue(\"auto-hide-method-docs\") === \"true\";\n         var hideImplementors = getSettingValue(\"auto-collapse-implementors\") !== \"false\";\n-        var hideImplementations = getSettingValue(\"auto-hide-trait-implementations\") !== \"false\";\n+        var hideImplementations = getSettingValue(\"auto-hide-trait-implementations\") === \"true\";\n         var hideLargeItemContents = getSettingValue(\"auto-hide-large-items\") !== \"false\";\n \n-        function openImplementors(id) {\n+        function setImplementorsTogglesOpen(id, open) {\n             var list = document.getElementById(id);\n             if (list !== null) {\n                 onEachLazy(list.getElementsByClassName(\"implementors-toggle\"), function(e) {\n-                    e.open = true;\n+                    e.open = open;\n                 });\n             }\n         }\n \n-        if (!hideImplementations) {\n-            openImplementors(\"trait-implementations-list\");\n-            openImplementors(\"blanket-implementations-list\");\n+        if (hideImplementations) {\n+            setImplementorsTogglesOpen(\"trait-implementations-list\", false);\n+            setImplementorsTogglesOpen(\"blanket-implementations-list\", false);\n         }\n \n         if (!hideImplementors) {\n-            openImplementors(\"implementors-list\");\n+            setImplementorsTogglesOpen(\"implementors-list\", true);\n         }\n \n         onEachLazy(document.getElementsByClassName(\"rustdoc-toggle\"), function (e) {"}, {"sha": "96a5492edefcbf745a4e44e8bdcd3763afaa52cf", "filename": "src/test/rustdoc-gui/toggled-open-implementations.goml", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/b5c3ef66e6270e910b03ddef6761bb998e2c2a89/src%2Ftest%2Frustdoc-gui%2Ftoggled-open-implementations.goml", "raw_url": "https://github.com/rust-lang/rust/raw/b5c3ef66e6270e910b03ddef6761bb998e2c2a89/src%2Ftest%2Frustdoc-gui%2Ftoggled-open-implementations.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Ftoggled-open-implementations.goml?ref=b5c3ef66e6270e910b03ddef6761bb998e2c2a89", "patch": "@@ -0,0 +1,5 @@\n+// This tests that the \"implementations\" section on struct/enum pages\n+// has all the implementations toggled open by default, so users can\n+// find method names in those implementations with Ctrl-F.\n+goto: file://|DOC_PATH|/test_docs/struct.Foo.html\n+assert: (\".rustdoc-toggle.implementors-toggle\", \"open\", \"\")"}]}