{"sha": "90a9f65b8da62f7495e56cab252efe590dd456e5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjkwYTlmNjViOGRhNjJmNzQ5NWU1NmNhYjI1MmVmZTU5MGRkNDU2ZTU=", "commit": {"author": {"name": "Bj\u00f6rn Steinbrink", "email": "bsteinbr@gmail.com", "date": "2014-06-17T16:34:50Z"}, "committer": {"name": "Bj\u00f6rn Steinbrink", "email": "bsteinbr@gmail.com", "date": "2014-06-21T17:59:58Z"}, "message": "Update LLVM\n\nTo fix #8106, we need an LLVM version that contains r211082 aka 0dee6756\nwhich fixes a bug that blocks that issue.\n\nThere have been some tiny API changes in LLVM, and cmpxchg changed its\nreturn type. The i1 part of the new return type is only interesting when\nusing the new weak cmpxchg, which we don't do.", "tree": {"sha": "528fd1fb21fff39324aabe540d32e8088d9108f8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/528fd1fb21fff39324aabe540d32e8088d9108f8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/90a9f65b8da62f7495e56cab252efe590dd456e5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/90a9f65b8da62f7495e56cab252efe590dd456e5", "html_url": "https://github.com/rust-lang/rust/commit/90a9f65b8da62f7495e56cab252efe590dd456e5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/90a9f65b8da62f7495e56cab252efe590dd456e5/comments", "author": {"login": "dotdash", "id": 230962, "node_id": "MDQ6VXNlcjIzMDk2Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dotdash", "html_url": "https://github.com/dotdash", "followers_url": "https://api.github.com/users/dotdash/followers", "following_url": "https://api.github.com/users/dotdash/following{/other_user}", "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}", "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions", "organizations_url": "https://api.github.com/users/dotdash/orgs", "repos_url": "https://api.github.com/users/dotdash/repos", "events_url": "https://api.github.com/users/dotdash/events{/privacy}", "received_events_url": "https://api.github.com/users/dotdash/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dotdash", "id": 230962, "node_id": "MDQ6VXNlcjIzMDk2Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/230962?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dotdash", "html_url": "https://github.com/dotdash", "followers_url": "https://api.github.com/users/dotdash/followers", "following_url": "https://api.github.com/users/dotdash/following{/other_user}", "gists_url": "https://api.github.com/users/dotdash/gists{/gist_id}", "starred_url": "https://api.github.com/users/dotdash/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dotdash/subscriptions", "organizations_url": "https://api.github.com/users/dotdash/orgs", "repos_url": "https://api.github.com/users/dotdash/repos", "events_url": "https://api.github.com/users/dotdash/events{/privacy}", "received_events_url": "https://api.github.com/users/dotdash/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5e720aac4215dcd8ba1b0fd455a737d8798baea4", "url": "https://api.github.com/repos/rust-lang/rust/commits/5e720aac4215dcd8ba1b0fd455a737d8798baea4", "html_url": "https://github.com/rust-lang/rust/commit/5e720aac4215dcd8ba1b0fd455a737d8798baea4"}], "stats": {"total": 24, "additions": 18, "deletions": 6}, "files": [{"sha": "7624a71c9dd35ca9a629eed3a1a568414b23ff8c", "filename": "src/librustc/middle/trans/intrinsic.rs", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/90a9f65b8da62f7495e56cab252efe590dd456e5/src%2Flibrustc%2Fmiddle%2Ftrans%2Fintrinsic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/90a9f65b8da62f7495e56cab252efe590dd456e5/src%2Flibrustc%2Fmiddle%2Ftrans%2Fintrinsic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Ftrans%2Fintrinsic.rs?ref=90a9f65b8da62f7495e56cab252efe590dd456e5", "patch": "@@ -235,11 +235,15 @@ pub fn trans_intrinsic(ccx: &CrateContext,\n                     lib::llvm::SequentiallyConsistent =>\n                         lib::llvm::SequentiallyConsistent,\n                 };\n-                let old = AtomicCmpXchg(bcx, get_param(decl, first_real_arg),\n+                let res = AtomicCmpXchg(bcx, get_param(decl, first_real_arg),\n                                         get_param(decl, first_real_arg + 1u),\n                                         get_param(decl, first_real_arg + 2u),\n                                         order, strongest_failure_ordering);\n-                Ret(bcx, old);\n+                if unsafe { lib::llvm::llvm::LLVMVersionMinor() >= 5 } {\n+                    Ret(bcx, ExtractValue(bcx, res, 0));\n+                } else {\n+                    Ret(bcx, res);\n+                }\n             }\n             \"load\" => {\n                 let old = AtomicLoad(bcx, get_param(decl, first_real_arg),"}, {"sha": "1bba09755d95892bc826c558630e93803b0a4ee6", "filename": "src/llvm", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": null, "raw_url": null, "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fllvm?ref=90a9f65b8da62f7495e56cab252efe590dd456e5", "patch": "@@ -1 +1 @@\n-Subproject commit 0a894645cf120539876e9eb4eb0d7b572dfa9d14\n+Subproject commit 1bba09755d95892bc826c558630e93803b0a4ee6"}, {"sha": "a1a88d1b14d45d8a9d97cce938dc4ceff0497de1", "filename": "src/rustllvm/RustWrapper.cpp", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/90a9f65b8da62f7495e56cab252efe590dd456e5/src%2Frustllvm%2FRustWrapper.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/90a9f65b8da62f7495e56cab252efe590dd456e5/src%2Frustllvm%2FRustWrapper.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustllvm%2FRustWrapper.cpp?ref=90a9f65b8da62f7495e56cab252efe590dd456e5", "patch": "@@ -659,7 +659,7 @@ LLVMRustLinkInExternalBitcode(LLVMModuleRef dst, char *bc, size_t len) {\n extern \"C\" void*\n LLVMRustOpenArchive(char *path) {\n     std::unique_ptr<MemoryBuffer> buf;\n-    error_code err = MemoryBuffer::getFile(path, buf);\n+    std::error_code err = MemoryBuffer::getFile(path, buf);\n     if (err) {\n         LLVMRustSetLastError(err.message().c_str());\n         return NULL;\n@@ -694,14 +694,18 @@ LLVMRustArchiveReadSection(Archive *ar, char *name, size_t *size) {\n #if LLVM_VERSION_MINOR >= 5\n     Archive::child_iterator child = ar->child_begin(),\n                               end = ar->child_end();\n+    for (; child != end; ++child) {\n+        ErrorOr<StringRef> name_or_err = child->getName();\n+        if (name_or_err.getError()) continue;\n+        StringRef sect_name = name_or_err.get();\n #else\n     Archive::child_iterator child = ar->begin_children(),\n                               end = ar->end_children();\n-#endif\n     for (; child != end; ++child) {\n         StringRef sect_name;\n         error_code err = child->getName(sect_name);\n         if (err) continue;\n+#endif\n         if (sect_name.trim(\" \") == name) {\n             StringRef buf = child->getBuffer();\n             *size = buf.size();\n@@ -757,7 +761,11 @@ inline section_iterator *unwrap(LLVMSectionIteratorRef SI) {\n extern \"C\" int\n LLVMRustGetSectionName(LLVMSectionIteratorRef SI, const char **ptr) {\n     StringRef ret;\n+#if LLVM_VERSION_MINOR >= 5\n+    if (std::error_code ec = (*unwrap(SI))->getName(ret))\n+#else\n     if (error_code ec = (*unwrap(SI))->getName(ret))\n+#endif\n       report_fatal_error(ec.message());\n     *ptr = ret.data();\n     return ret.size();"}, {"sha": "1bd3434b46eca59bdeae275dcb79edef06acdf67", "filename": "src/rustllvm/llvm-auto-clean-trigger", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/90a9f65b8da62f7495e56cab252efe590dd456e5/src%2Frustllvm%2Fllvm-auto-clean-trigger", "raw_url": "https://github.com/rust-lang/rust/raw/90a9f65b8da62f7495e56cab252efe590dd456e5/src%2Frustllvm%2Fllvm-auto-clean-trigger", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frustllvm%2Fllvm-auto-clean-trigger?ref=90a9f65b8da62f7495e56cab252efe590dd456e5", "patch": "@@ -1,4 +1,4 @@\n # If this file is modified, then llvm will be forcibly cleaned and then rebuilt.\n # The actual contents of this file do not matter, but to trigger a change on the\n # build bots then the contents should be changed so git updates the mtime.\n-2014-05-20\n+2014-06-20.2"}]}