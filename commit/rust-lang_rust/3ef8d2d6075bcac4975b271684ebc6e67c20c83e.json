{"sha": "3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "node_id": "C_kwDOAAsO6NoAKDNlZjhkMmQ2MDc1YmNhYzQ5NzViMjcxNjg0ZWJjNmU2N2MyMGM4M2U", "commit": {"author": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2023-03-21T15:44:06Z"}, "committer": {"name": "Guillaume Gomez", "email": "guillaume.gomez@huawei.com", "date": "2023-03-30T20:56:52Z"}, "message": "Update tests for rustc_doc_primitive", "tree": {"sha": "300fa357a66d99e438c527d978432f84e6193db1", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/300fa357a66d99e438c527d978432f84e6193db1"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "html_url": "https://github.com/rust-lang/rust/commit/3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/comments", "author": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "committer": {"login": "GuillaumeGomez", "id": 3050060, "node_id": "MDQ6VXNlcjMwNTAwNjA=", "avatar_url": "https://avatars.githubusercontent.com/u/3050060?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GuillaumeGomez", "html_url": "https://github.com/GuillaumeGomez", "followers_url": "https://api.github.com/users/GuillaumeGomez/followers", "following_url": "https://api.github.com/users/GuillaumeGomez/following{/other_user}", "gists_url": "https://api.github.com/users/GuillaumeGomez/gists{/gist_id}", "starred_url": "https://api.github.com/users/GuillaumeGomez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GuillaumeGomez/subscriptions", "organizations_url": "https://api.github.com/users/GuillaumeGomez/orgs", "repos_url": "https://api.github.com/users/GuillaumeGomez/repos", "events_url": "https://api.github.com/users/GuillaumeGomez/events{/privacy}", "received_events_url": "https://api.github.com/users/GuillaumeGomez/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f40aa598e97465feb753abbb18268a368ef0118e", "url": "https://api.github.com/repos/rust-lang/rust/commits/f40aa598e97465feb753abbb18268a368ef0118e", "html_url": "https://github.com/rust-lang/rust/commit/f40aa598e97465feb753abbb18268a368ef0118e"}], "stats": {"total": 113, "additions": 57, "deletions": 56}, "files": [{"sha": "8383dcc0482ea32ae018dbbdd3d182c863d057ed", "filename": "tests/rustdoc-json/impls/local_for_local_primitive.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc-json%2Fimpls%2Flocal_for_local_primitive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc-json%2Fimpls%2Flocal_for_local_primitive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc-json%2Fimpls%2Flocal_for_local_primitive.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -1,5 +1,5 @@\n #![feature(no_core)]\n-#![feature(rustdoc_internals)]\n+#![feature(rustc_attrs)]\n #![no_core]\n \n // @set Local = \"$.index[*][?(@.name=='Local')].id\"\n@@ -16,6 +16,6 @@ impl Local for bool {}\n \n // FIXME(#101695): Test bool's `impls` include \"Local for bool\"\n // @has \"$.index[*][?(@.name=='bool')]\"\n-#[doc(primitive = \"bool\")]\n+#[rustc_doc_primitive = \"bool\"]\n /// Boolean docs\n mod prim_bool {}"}, {"sha": "0cf479faf294c8c600d4af3a2126fce403d949d7", "filename": "tests/rustdoc-json/primitives/local_primitive.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc-json%2Fprimitives%2Flocal_primitive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc-json%2Fprimitives%2Flocal_primitive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc-json%2Fprimitives%2Flocal_primitive.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -8,7 +8,7 @@\n \n //! Link to [i32][prim@i32] [i64][prim@i64]\n \n-#[doc(primitive = \"i32\")]\n+#[rustc_doc_primitive = \"i32\"]\n mod prim_i32 {}\n \n // @set local_i32 = \"$.index[*][?(@.name=='i32')].id\""}, {"sha": "85d179ee45f367ed36a531718ecc449bdc802a07", "filename": "tests/rustdoc-json/primitives/primitive_impls.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc-json%2Fprimitives%2Fprimitive_impls.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc-json%2Fprimitives%2Fprimitive_impls.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc-json%2Fprimitives%2Fprimitive_impls.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -25,7 +25,7 @@ pub trait Trait {}\n impl Trait for i32 {}\n \n /// i32\n-#[doc(primitive = \"i32\")]\n+#[rustc_doc_primitive = \"i32\"]\n mod prim_i32 {}\n \n // @set i32 = \"$.index[*][?(@.docs=='i32')].id\""}, {"sha": "81e0acdc6e93e8eeb22ae948360ee22e986c2f53", "filename": "tests/rustdoc-json/primitives/primitive_overloading.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc-json%2Fprimitives%2Fprimitive_overloading.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc-json%2Fprimitives%2Fprimitive_overloading.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc-json%2Fprimitives%2Fprimitive_overloading.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -2,15 +2,15 @@\n \n // Regression test for <https://github.com/rust-lang/rust/issues/98006>.\n \n-#![feature(rustdoc_internals)]\n+#![feature(rustc_attrs)]\n #![feature(no_core)]\n \n #![no_core]\n \n // @has \"$.index[*][?(@.name=='usize')]\"\n // @has \"$.index[*][?(@.name=='prim')]\"\n \n-#[doc(primitive = \"usize\")]\n+#[rustc_doc_primitive = \"usize\"]\n /// This is the built-in type `usize`.\n mod prim {\n }"}, {"sha": "5180a804f07ba093ddeab976e86748189f3ea264", "filename": "tests/rustdoc-json/primitives/use_primitive.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc-json%2Fprimitives%2Fuse_primitive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc-json%2Fprimitives%2Fuse_primitive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc-json%2Fprimitives%2Fuse_primitive.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -1,8 +1,8 @@\n // edition:2018\n \n-#![feature(rustdoc_internals)]\n+#![feature(rustc_attrs)]\n \n-#[doc(primitive = \"usize\")]\n+#[rustc_doc_primitive = \"usize\"]\n mod usize {}\n \n // @set local_crate_id = \"$.index[*][?(@.name=='use_primitive')].crate_id\""}, {"sha": "f45405fbf5dc8d49cd77a67bf1e31cfc77ac4cf0", "filename": "tests/rustdoc-ui/coverage/exotic.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc-ui%2Fcoverage%2Fexotic.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc-ui%2Fcoverage%2Fexotic.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc-ui%2Fcoverage%2Fexotic.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -2,12 +2,13 @@\n // check-pass\n \n #![feature(rustdoc_internals)]\n+#![feature(rustc_attrs)]\n \n //! the features only used in std also have entries in the table, so make sure those get pulled out\n //! properly as well\n \n /// woo, check it out, we can write our own primitive docs lol\n-#[doc(primitive=\"unit\")]\n+#[rustc_doc_primitive = \"unit\"]\n mod prim_unit {}\n \n /// keywords? sure, pile them on"}, {"sha": "a6db93dbc33cdcc9133b8f9ffe85c5ad13188b90", "filename": "tests/rustdoc/auto-impl-primitive.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fauto-impl-primitive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fauto-impl-primitive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fauto-impl-primitive.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -1,10 +1,10 @@\n-#![feature(rustdoc_internals)]\n+#![feature(rustc_attrs)]\n \n #![crate_name = \"foo\"]\n \n pub use std::fs::File;\n \n // @has 'foo/primitive.i16.html' '//h2[@id=\"synthetic-implementations\"]' 'Auto Trait Implementation'\n-#[doc(primitive = \"i16\")]\n+#[rustc_doc_primitive = \"i16\"]\n /// I love poneys!\n mod prim {}"}, {"sha": "a2f426c6352e988718b869ca57eb70c5a1782f48", "filename": "tests/rustdoc/auxiliary/issue-15318.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fauxiliary%2Fissue-15318.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fauxiliary%2Fissue-15318.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fauxiliary%2Fissue-15318.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -2,6 +2,7 @@\n // compile-flags: -Cmetadata=aux\n #![crate_type = \"rlib\"]\n #![doc(html_root_url = \"http://example.com/\")]\n+#![feature(rustc_attrs)]\n #![feature(lang_items)]\n #![no_std]\n \n@@ -12,5 +13,5 @@ fn foo() {}\n fn bar(_: &core::panic::PanicInfo) -> ! { loop {} }\n \n /// dox\n-#[doc(primitive = \"pointer\")]\n+#[rustc_doc_primitive = \"pointer\"]\n pub mod ptr {}"}, {"sha": "d1785e4239119e3f11222a1119c330c2900b3c29", "filename": "tests/rustdoc/auxiliary/primitive-doc.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fauxiliary%2Fprimitive-doc.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fauxiliary%2Fprimitive-doc.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fauxiliary%2Fprimitive-doc.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -1,9 +1,10 @@\n // compile-flags: --crate-type lib --edition 2018\n \n+#![feature(rustc_attrs)]\n #![feature(no_core)]\n #![no_core]\n \n-#[doc(primitive = \"usize\")]\n+#[rustc_doc_primitive = \"usize\"]\n /// This is the built-in type `usize`.\n mod usize {\n }"}, {"sha": "41b9d41fa4410e514e7eb23f203c19c8bb660da0", "filename": "tests/rustdoc/check-source-code-urls-to-def.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fcheck-source-code-urls-to-def.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fcheck-source-code-urls-to-def.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fcheck-source-code-urls-to-def.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -2,7 +2,7 @@\n // aux-build:source_code.rs\n // build-aux-docs\n \n-#![feature(rustdoc_internals)]\n+#![feature(rustc_attrs)]\n \n #![crate_name = \"foo\"]\n \n@@ -65,5 +65,5 @@ pub fn foo4() {\n }\n \n // @has - '//pre[@class=\"rust\"]//a[@href=\"../../foo/primitive.bool.html\"]' 'bool'\n-#[doc(primitive = \"bool\")]\n+#[rustc_doc_primitive = \"bool\"]\n mod whatever {}"}, {"sha": "c050929db9682cb66502e0c11b924cbad44af617", "filename": "tests/rustdoc/intra-doc/auxiliary/my-core.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fintra-doc%2Fauxiliary%2Fmy-core.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fintra-doc%2Fauxiliary%2Fmy-core.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fintra-doc%2Fauxiliary%2Fmy-core.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -3,7 +3,7 @@\n #![rustc_coherence_is_core]\n #![crate_type=\"rlib\"]\n \n-#[doc(primitive = \"char\")]\n+#[rustc_doc_primitive = \"char\"]\n /// Some char docs\n mod char {}\n "}, {"sha": "711ac09ba9a03db250c74a30fe742a3360b2a5be", "filename": "tests/rustdoc/intra-doc/no-doc-primitive.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fintra-doc%2Fno-doc-primitive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fintra-doc%2Fno-doc-primitive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fintra-doc%2Fno-doc-primitive.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -1,4 +1,4 @@\n-// Crate tree without a `doc(primitive)` module for primitive type linked to by a doc link.\n+// Crate tree without a `rustc_doc_primitive` module for primitive type linked to by a doc link.\n \n #![deny(rustdoc::broken_intra_doc_links)]\n #![feature(no_core, lang_items, rustc_attrs)]"}, {"sha": "6de4ec1802fd1348254ceedbfc6387705a8812b3", "filename": "tests/rustdoc/intra-doc/prim-methods-local.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fintra-doc%2Fprim-methods-local.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fintra-doc%2Fprim-methods-local.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fintra-doc%2Fprim-methods-local.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -10,7 +10,7 @@\n \n //! A [prim@`char`] and its [`char::len_utf8`].\n \n-#[doc(primitive = \"char\")]\n+#[rustc_doc_primitive = \"char\"]\n mod char {}\n \n impl char {"}, {"sha": "d13858a53cff71fbc5a67ce45b1d611840f8e157", "filename": "tests/rustdoc/intra-doc/prim-self.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fintra-doc%2Fprim-self.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fintra-doc%2Fprim-self.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fintra-doc%2Fprim-self.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -25,7 +25,7 @@ impl usize {\n     pub type ME = usize;\n }\n \n-#[doc(primitive = \"usize\")]\n+#[rustc_doc_primitive = \"usize\"]\n /// This has some docs.\n mod usize {}\n "}, {"sha": "2dab8f9488391f286116c2576dac28b1b76e7896", "filename": "tests/rustdoc/issue-15318-3.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fissue-15318-3.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fissue-15318-3.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fissue-15318-3.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -1,7 +1,7 @@\n-#![feature(rustdoc_internals)]\n+#![feature(rustc_attrs)]\n \n // @has issue_15318_3/primitive.pointer.html\n \n /// dox\n-#[doc(primitive = \"pointer\")]\n+#[rustc_doc_primitive = \"pointer\"]\n pub mod ptr {}"}, {"sha": "21d02842431d0d02b98952b99cff374689d3d165", "filename": "tests/rustdoc/issue-23511.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fissue-23511.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fissue-23511.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fissue-23511.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -3,7 +3,7 @@\n #![no_std]\n \n pub mod str {\n-    #![doc(primitive = \"str\")]\n+    #![rustc_doc_primitive = \"str\"]\n \n     impl str {\n         // @hasraw search-index.js foo"}, {"sha": "5af5f7616b57e867480bf986f19cc1adc1f9a971", "filename": "tests/rustdoc/notable-trait/doc-notable_trait-mut_t_is_not_an_iterator.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fnotable-trait%2Fdoc-notable_trait-mut_t_is_not_an_iterator.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fnotable-trait%2Fdoc-notable_trait-mut_t_is_not_an_iterator.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fnotable-trait%2Fdoc-notable_trait-mut_t_is_not_an_iterator.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -6,10 +6,10 @@\n //!\n //! [#80737]: https://github.com/rust-lang/rust/issues/80737\n \n-#![feature(rustdoc_internals)]\n+#![feature(rustc_attrs)]\n #![no_std]\n \n-#[doc(primitive = \"reference\")]\n+#[rustc_doc_primitive = \"reference\"]\n /// Some useless docs, wouhou!\n ///\n /// We need to put this in here, because notable traits"}, {"sha": "6c980aaa2b135ee97eb9c92c09de1561d3b44e26", "filename": "tests/rustdoc/notable-trait/doc-notable_trait-mut_t_is_not_ref_t.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fnotable-trait%2Fdoc-notable_trait-mut_t_is_not_ref_t.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fnotable-trait%2Fdoc-notable_trait-mut_t_is_not_ref_t.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fnotable-trait%2Fdoc-notable_trait-mut_t_is_not_ref_t.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -5,9 +5,9 @@\n //!\n //! [#78160]: https://github.com/rust-lang/rust/issues/78160\n \n-#![feature(rustdoc_internals)]\n+#![feature(rustc_attrs)]\n \n-#[doc(primitive = \"reference\")]\n+#[rustc_doc_primitive = \"reference\"]\n /// Some useless docs, wouhou!\n ///\n /// We need to put this in here, because notable traits"}, {"sha": "6f034224df55294bb880ffe3a282f58f719a7db6", "filename": "tests/rustdoc/primitive-reference.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fprimitive-reference.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fprimitive-reference.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fprimitive-reference.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -1,6 +1,6 @@\n #![crate_name = \"foo\"]\n \n-#![feature(rustdoc_internals)]\n+#![feature(rustc_attrs)]\n \n // @has foo/index.html\n // @has - '//h2[@id=\"primitives\"]' 'Primitive Types'\n@@ -16,7 +16,7 @@\n // @count - '//*[@class=\"impl\"]' 1\n // @has - '//*[@id=\"impl-Foo%3C%26A%3E-for-%26B\"]/*[@class=\"code-header\"]' \\\n //        'impl<A, B> Foo<&A> for &B'\n-#[doc(primitive = \"reference\")]\n+#[rustc_doc_primitive = \"reference\"]\n /// this is a test!\n mod reference {}\n "}, {"sha": "ba15a73ca1d1943295ebca4ee1f3103d095488a9", "filename": "tests/rustdoc/primitive-slice-auto-trait.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fprimitive-slice-auto-trait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fprimitive-slice-auto-trait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fprimitive-slice-auto-trait.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -1,14 +1,14 @@\n // compile-flags: --crate-type lib --edition 2018\n \n #![crate_name = \"foo\"]\n-#![feature(rustdoc_internals)]\n+#![feature(rustc_attrs)]\n \n // @has foo/primitive.slice.html '//a[@class=\"primitive\"]' 'slice'\n // @has - '//h1' 'Primitive Type slice'\n // @has - '//section[@id=\"main-content\"]//div[@class=\"docblock\"]//p' 'this is a test!'\n // @has - '//h2[@id=\"synthetic-implementations\"]' 'Auto Trait Implementations'\n // @has - '//div[@id=\"synthetic-implementations-list\"]//h3' 'impl<T> Send for [T]where T: Send'\n // @has - '//div[@id=\"synthetic-implementations-list\"]//h3' 'impl<T> Sync for [T]where T: Sync'\n-#[doc(primitive = \"slice\")]\n+#[rustc_doc_primitive = \"slice\"]\n /// this is a test!\n mod slice_prim {}"}, {"sha": "2b407b586a3d4942b560c20ac8060abf7196a88d", "filename": "tests/rustdoc/primitive-tuple-auto-trait.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fprimitive-tuple-auto-trait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fprimitive-tuple-auto-trait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fprimitive-tuple-auto-trait.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -1,15 +1,15 @@\n // compile-flags: --crate-type lib --edition 2018\n \n #![crate_name = \"foo\"]\n-#![feature(rustdoc_internals)]\n+#![feature(rustc_attrs)]\n \n // @has foo/primitive.tuple.html '//a[@class=\"primitive\"]' 'tuple'\n // @has - '//h1' 'Primitive Type tuple'\n // @has - '//section[@id=\"main-content\"]//div[@class=\"docblock\"]//p' 'this is a test!'\n // @has - '//h2[@id=\"synthetic-implementations\"]' 'Auto Trait Implementations'\n // @has - '//div[@id=\"synthetic-implementations-list\"]//h3' 'Send'\n // @has - '//div[@id=\"synthetic-implementations-list\"]//h3' 'Sync'\n-#[doc(primitive = \"tuple\")]\n+#[rustc_doc_primitive = \"tuple\"]\n /// this is a test!\n ///\n // Hardcoded anchor to header written in library/core/src/primitive_docs.rs"}, {"sha": "5a56f1fd83bd4bcc16ec0ab84ef8a8accbf57702", "filename": "tests/rustdoc/primitive-unit-auto-trait.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fprimitive-unit-auto-trait.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fprimitive-unit-auto-trait.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fprimitive-unit-auto-trait.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -1,14 +1,14 @@\n // compile-flags: --crate-type lib --edition 2018\n \n #![crate_name = \"foo\"]\n-#![feature(rustdoc_internals)]\n+#![feature(rustc_attrs)]\n \n // @has foo/primitive.unit.html '//a[@class=\"primitive\"]' 'unit'\n // @has - '//h1' 'Primitive Type unit'\n // @has - '//section[@id=\"main-content\"]//div[@class=\"docblock\"]//p' 'this is a test!'\n // @has - '//h2[@id=\"synthetic-implementations\"]' 'Auto Trait Implementations'\n // @has - '//div[@id=\"synthetic-implementations-list\"]//h3' 'impl Send for ()'\n // @has - '//div[@id=\"synthetic-implementations-list\"]//h3' 'impl Sync for ()'\n-#[doc(primitive = \"unit\")]\n+#[rustc_doc_primitive = \"unit\"]\n /// this is a test!\n mod unit_prim {}"}, {"sha": "2da8ae6ff38da6c78e70a4ba1a59449d633a5218", "filename": "tests/rustdoc/primitive/primitive-generic-impl.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fprimitive%2Fprimitive-generic-impl.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fprimitive%2Fprimitive-generic-impl.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fprimitive%2Fprimitive-generic-impl.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -1,8 +1,8 @@\n-#![feature(rustdoc_internals)]\n+#![feature(rustc_attrs)]\n #![crate_name = \"foo\"]\n \n // @has foo/primitive.i32.html '//*[@id=\"impl-ToString-for-i32\"]//h3[@class=\"code-header\"]' 'impl<T> ToString for T'\n \n-#[doc(primitive = \"i32\")]\n+#[rustc_doc_primitive = \"i32\"]\n /// Some useless docs, wouhou!\n mod i32 {}"}, {"sha": "32af2636c18b0fc624cd12ebf8d8d37e355f2cc0", "filename": "tests/rustdoc/primitive/primitive.rs", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fprimitive%2Fprimitive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fprimitive%2Fprimitive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fprimitive%2Fprimitive.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -1,6 +1,6 @@\n #![crate_name = \"foo\"]\n \n-#![feature(rustdoc_internals)]\n+#![feature(rustc_attrs)]\n \n // @has foo/index.html '//h2[@id=\"primitives\"]' 'Primitive Types'\n // @has foo/index.html '//a[@href=\"primitive.i32.html\"]' 'i32'\n@@ -11,11 +11,11 @@\n // @has foo/primitive.i32.html '//section[@id=\"main-content\"]//div[@class=\"docblock\"]//p' 'this is a test!'\n // @has foo/index.html '//a/@href' '../foo/index.html'\n // @!has foo/index.html '//span' '\ud83d\udd12'\n-#[doc(primitive = \"i32\")]\n+#[rustc_doc_primitive = \"i32\"]\n /// this is a test!\n mod i32{}\n \n // @has foo/primitive.bool.html '//section[@id=\"main-content\"]//div[@class=\"docblock\"]//p' 'hello'\n-#[doc(primitive = \"bool\")]\n+#[rustc_doc_primitive = \"bool\"]\n /// hello\n mod bool {}"}, {"sha": "45a6ba8ed2e16b896a8bcf2c5401f7c54c1359e9", "filename": "tests/rustdoc/sidebar-all-page.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fsidebar-all-page.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Fsidebar-all-page.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Fsidebar-all-page.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -1,6 +1,6 @@\n #![crate_name = \"foo\"]\n \n-#![feature(rustdoc_internals)]\n+#![feature(rustc_attrs)]\n \n // @has 'foo/all.html'\n // @has - '//*[@class=\"sidebar-elems\"]//li' 'Structs'\n@@ -31,5 +31,5 @@ macro_rules! foo {\n pub type Type = u8;\n pub const FOO: u8 = 0;\n pub static BAR: u8 = 0;\n-#[doc(primitive = \"u8\")]\n+#[rustc_doc_primitive = \"u8\"]\n mod u8 {}"}, {"sha": "8d781b40e46d90b21f5beecb7f4c15d5b782217b", "filename": "tests/rustdoc/tab_title.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Ftab_title.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Ftab_title.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Ftab_title.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -1,4 +1,5 @@\n #![crate_name = \"foo\"]\n+#![feature(rustc_attrs)]\n #![feature(rustdoc_internals)]\n \n // tests for the html <title> element\n@@ -39,6 +40,6 @@ mod continue_keyword {}\n \n // @has foo/primitive.u8.html '//head/title' 'u8 - Rust'\n // @!has - '//head/title' 'foo'\n-#[doc(primitive = \"u8\")]\n+#[rustc_doc_primitive = \"u8\"]\n /// `u8` docs\n mod u8 {}"}, {"sha": "e1feb1cd64fef2517719b1cef398c35c24dde49c", "filename": "tests/rustdoc/titles.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Ftitles.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Frustdoc%2Ftitles.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Frustdoc%2Ftitles.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -1,5 +1,5 @@\n #![crate_name = \"foo\"]\n-#![feature(rustdoc_internals)]\n+#![feature(rustc_attrs)]\n \n // @matches 'foo/index.html' '//h1' 'Crate foo'\n // @matches 'foo/index.html' '//h2[@class=\"location\"]' 'Crate foo'\n@@ -41,7 +41,7 @@ macro_rules! foo_macro {\n }\n \n // @matches 'foo/primitive.bool.html' '//h1' 'Primitive Type bool'\n-#[doc(primitive = \"bool\")]\n+#[rustc_doc_primitive = \"bool\"]\n mod bool {}\n \n // @matches 'foo/static.FOO_STATIC.html' '//h1' 'Static foo::FOO_STATIC'"}, {"sha": "78fcd90752e46d9cf494281321ecc94e94ba9c78", "filename": "tests/ui/rustdoc/feature-gate-doc_primitive.rs", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Fui%2Frustdoc%2Ffeature-gate-doc_primitive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Fui%2Frustdoc%2Ffeature-gate-doc_primitive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Frustdoc%2Ffeature-gate-doc_primitive.rs?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -1,7 +1,5 @@\n-// check-pass\n-#[doc(primitive = \"usize\")]\n-//~^ WARNING `doc(primitive)` should never have been stable\n-//~| WARNING hard error in a future release\n+#[rustc_doc_primitive = \"usize\"]\n+//~^ ERROR `rustc_doc_primitive` is a rustc internal attribute\n /// Some docs\n mod usize {}\n "}, {"sha": "5920880675d7ef2e514a6c4555137229141984cd", "filename": "tests/ui/rustdoc/feature-gate-doc_primitive.stderr", "status": "modified", "additions": 7, "deletions": 8, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Fui%2Frustdoc%2Ffeature-gate-doc_primitive.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3ef8d2d6075bcac4975b271684ebc6e67c20c83e/tests%2Fui%2Frustdoc%2Ffeature-gate-doc_primitive.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Frustdoc%2Ffeature-gate-doc_primitive.stderr?ref=3ef8d2d6075bcac4975b271684ebc6e67c20c83e", "patch": "@@ -1,12 +1,11 @@\n-warning: `doc(primitive)` should never have been stable\n-  --> $DIR/feature-gate-doc_primitive.rs:2:7\n+error[E0658]: `rustc_doc_primitive` is a rustc internal attribute\n+  --> $DIR/feature-gate-doc_primitive.rs:1:1\n    |\n-LL | #[doc(primitive = \"usize\")]\n-   |       ^^^^^^^^^^^^^^^^^^^\n+LL | #[rustc_doc_primitive = \"usize\"]\n+   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |\n-   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n-   = note: for more information, see issue #82730 <https://github.com/rust-lang/rust/issues/82730>\n-   = note: `#[warn(invalid_doc_attributes)]` on by default\n+   = help: add `#![feature(rustc_attrs)]` to the crate attributes to enable\n \n-warning: 1 warning emitted\n+error: aborting due to previous error\n \n+For more information about this error, try `rustc --explain E0658`."}]}