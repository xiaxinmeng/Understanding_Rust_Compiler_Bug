{"sha": "2a864852774e924f1f9bb68da34adca736211545", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJhODY0ODUyNzc0ZTkyNGYxZjliYjY4ZGEzNGFkY2E3MzYyMTE1NDU=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-04-18T20:45:55Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-04-18T20:45:55Z"}, "message": "auto merge of #5418 : luqmana/rust/stack-float, r=brson\n\nLike I commented in #2043, I can't reproduce the weirdness from #1388 on either mac or linux (x84_64) and pushing to try gives all green.\r\n\r\nThat's 128 less bytes to have to keep in the stack for every call to __morestack.", "tree": {"sha": "0b9e295336b909566476e652f6655ab6f17ff352", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0b9e295336b909566476e652f6655ab6f17ff352"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2a864852774e924f1f9bb68da34adca736211545", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2a864852774e924f1f9bb68da34adca736211545", "html_url": "https://github.com/rust-lang/rust/commit/2a864852774e924f1f9bb68da34adca736211545", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2a864852774e924f1f9bb68da34adca736211545/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b329f2fa82185c9e7c6bbbdf26270dd839618e9c", "url": "https://api.github.com/repos/rust-lang/rust/commits/b329f2fa82185c9e7c6bbbdf26270dd839618e9c", "html_url": "https://github.com/rust-lang/rust/commit/b329f2fa82185c9e7c6bbbdf26270dd839618e9c"}, {"sha": "f7a14e0a5a5c8c929e05a9d678609608bc784c4e", "url": "https://api.github.com/repos/rust-lang/rust/commits/f7a14e0a5a5c8c929e05a9d678609608bc784c4e", "html_url": "https://github.com/rust-lang/rust/commit/f7a14e0a5a5c8c929e05a9d678609608bc784c4e"}], "stats": {"total": 22, "additions": 3, "deletions": 19}, "files": [{"sha": "9d16afc0a1b3546cca2664f4b1d9acd0e6dc568a", "filename": "src/rt/arch/x86_64/morestack.S", "status": "modified", "additions": 3, "deletions": 19, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/2a864852774e924f1f9bb68da34adca736211545/src%2Frt%2Farch%2Fx86_64%2Fmorestack.S", "raw_url": "https://github.com/rust-lang/rust/raw/2a864852774e924f1f9bb68da34adca736211545/src%2Frt%2Farch%2Fx86_64%2Fmorestack.S", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Frt%2Farch%2Fx86_64%2Fmorestack.S?ref=2a864852774e924f1f9bb68da34adca736211545", "patch": "@@ -54,7 +54,7 @@ MORESTACK:\n \t// Calculate the CFA as on offset from %ebp\n \t.cfi_def_cfa_register %rbp\n \n-        subq $184, %rsp\n+        subq $56, %rsp\n \n \t// Save argument registers of the original function\n \tmovq %rdi,       (%rsp)\n@@ -63,14 +63,6 @@ MORESTACK:\n \tmovq %rcx,     24(%rsp)\n \tmovq %r8,      32(%rsp)\n \tmovq %r9,      40(%rsp)\n-\tmovdqa %xmm0,  48(%rsp)\n-\tmovdqa %xmm1,  64(%rsp)\n-\tmovdqa %xmm2,  80(%rsp)\n-\tmovdqa %xmm3,  96(%rsp)\n-\tmovdqa %xmm4, 112(%rsp)\n-\tmovdqa %xmm5, 128(%rsp)\n-\tmovdqa %xmm6, 144(%rsp)\n-\tmovdqa %xmm7, 160(%rsp)\n \n \t// Calculate the address of the stack arguments.\n \t// We have the base pointer, __morestack's return address,\n@@ -101,16 +93,8 @@ MORESTACK:\n \tmovq    24(%rsp), %rcx\n \tmovq    32(%rsp), %r8\n \tmovq    40(%rsp), %r9\n-\tmovdqa  48(%rsp), %xmm0\n-\tmovdqa  64(%rsp), %xmm1\n-\tmovdqa  80(%rsp), %xmm2\n-\tmovdqa  96(%rsp), %xmm3\n-\tmovdqa 112(%rsp), %xmm4\n-\tmovdqa 128(%rsp), %xmm5\n-\tmovdqa 144(%rsp), %xmm6\n-\tmovdqa 160(%rsp), %xmm7\n-\n-\taddq $184, %rsp\n+\n+\taddq $56, %rsp\n \n         movq 8(%rbp),%r10       // Grab the return pointer.\n         incq %r10               // Skip past the `ret` in our parent frame"}]}