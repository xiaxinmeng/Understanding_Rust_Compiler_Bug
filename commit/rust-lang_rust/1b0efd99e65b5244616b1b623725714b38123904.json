{"sha": "1b0efd99e65b5244616b1b623725714b38123904", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFiMGVmZDk5ZTY1YjUyNDQ2MTZiMWI2MjM3MjU3MTRiMzgxMjM5MDQ=", "commit": {"author": {"name": "Nick Cameron", "email": "nrc@ncameron.org", "date": "2018-07-17T21:06:26Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-07-17T21:06:26Z"}, "message": "Merge pull request #2847 from mbebenita/max-width\n\nAdd max_width option for all heuristics.", "tree": {"sha": "d6a9409bceb8238d3a765b212088c979aa663def", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d6a9409bceb8238d3a765b212088c979aa663def"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1b0efd99e65b5244616b1b623725714b38123904", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJbTlpSCRBK7hj4Ov3rIwAAdHIIALH4LwOvLupKi4PBFykXtdfc\n6WoXojLe49qthpkuLilXX/H3tS8q6KDxZzMRTAqA7FerA0L68AwMexc+z95Jdszl\nhk4TLgvh7pFCXgcEt1zrsAap9NeWFJRWFJLd0IPzfl/nNlGRSvBou3LWJ21SBINQ\nZUveDk5cTtEybla2FAXZBjbqpAyvyS165UtZ2CXA9vQrSofmF67KSZ//m0L87c+Z\nUvbcN1kTI+2jaFo+aQuE6guEdJE8h4PDNsF/Q9FbRx7iVrus1HEGVBie2rZjhbrl\nhswntqDLtJ5YNQSDWJ8qIy61PAFx9Wwq9MVdH7vZhrL/nt/YusR88uqTLzIB1W4=\n=+m8N\n-----END PGP SIGNATURE-----\n", "payload": "tree d6a9409bceb8238d3a765b212088c979aa663def\nparent b28a0cd6e68e342aa026e25dcc651cb9bc5007f8\nparent c2ae39e77a869836eae0403ac92245154a25379e\nauthor Nick Cameron <nrc@ncameron.org> 1531861586 +1200\ncommitter GitHub <noreply@github.com> 1531861586 +1200\n\nMerge pull request #2847 from mbebenita/max-width\n\nAdd max_width option for all heuristics."}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1b0efd99e65b5244616b1b623725714b38123904", "html_url": "https://github.com/rust-lang/rust/commit/1b0efd99e65b5244616b1b623725714b38123904", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1b0efd99e65b5244616b1b623725714b38123904/comments", "author": {"login": "nrc", "id": 762626, "node_id": "MDQ6VXNlcjc2MjYyNg==", "avatar_url": "https://avatars.githubusercontent.com/u/762626?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nrc", "html_url": "https://github.com/nrc", "followers_url": "https://api.github.com/users/nrc/followers", "following_url": "https://api.github.com/users/nrc/following{/other_user}", "gists_url": "https://api.github.com/users/nrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/nrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nrc/subscriptions", "organizations_url": "https://api.github.com/users/nrc/orgs", "repos_url": "https://api.github.com/users/nrc/repos", "events_url": "https://api.github.com/users/nrc/events{/privacy}", "received_events_url": "https://api.github.com/users/nrc/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b28a0cd6e68e342aa026e25dcc651cb9bc5007f8", "url": "https://api.github.com/repos/rust-lang/rust/commits/b28a0cd6e68e342aa026e25dcc651cb9bc5007f8", "html_url": "https://github.com/rust-lang/rust/commit/b28a0cd6e68e342aa026e25dcc651cb9bc5007f8"}, {"sha": "c2ae39e77a869836eae0403ac92245154a25379e", "url": "https://api.github.com/repos/rust-lang/rust/commits/c2ae39e77a869836eae0403ac92245154a25379e", "html_url": "https://github.com/rust-lang/rust/commit/c2ae39e77a869836eae0403ac92245154a25379e"}], "stats": {"total": 76, "additions": 75, "deletions": 1}, "files": [{"sha": "2a9df314417e75dfddfd1a72ab12bb730840bc5d", "filename": "Configurations.md", "status": "modified", "additions": 19, "deletions": 1, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/1b0efd99e65b5244616b1b623725714b38123904/Configurations.md", "raw_url": "https://github.com/rust-lang/rust/raw/1b0efd99e65b5244616b1b623725714b38123904/Configurations.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Configurations.md?ref=1b0efd99e65b5244616b1b623725714b38123904", "patch": "@@ -276,7 +276,7 @@ fn lorem<Ipsum, Dolor, Sit, Amet>() -> T\n Whether to use different formatting for items and expressions if they satisfy a heuristic notion of 'small'.\n \n - **Default value**: `Default`\n-- **Possible values**: `Default`, `Off`\n+- **Possible values**: `Default`, `Off`, `Max`\n - **Stable**: Yes\n \n #### `Default` (default):\n@@ -337,6 +337,24 @@ fn main() {\n }\n ```\n \n+#### `Max`:\n+\n+```rust\n+enum Lorem {\n+    Ipsum,\n+    Dolor(bool),\n+    Sit { amet: Consectetur, adipiscing: Elit },\n+}\n+\n+fn main() {\n+    lorem(\"lorem\", \"ipsum\", \"dolor\", \"sit\", \"amet\", \"consectetur\", \"adipiscing\");\n+\n+    let lorem = Lorem { ipsum: dolor, sit: amet };\n+\n+    let lorem = if ipsum { dolor } else { sit };\n+}\n+```\n+\n ## `binop_separator`\n \n Where to put a binary operator when a binary expression goes multiline."}, {"sha": "82cf0e19a8fe8b9e69310d428ef7838df51c4ecb", "filename": "src/config/config_type.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/1b0efd99e65b5244616b1b623725714b38123904/src%2Fconfig%2Fconfig_type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1b0efd99e65b5244616b1b623725714b38123904/src%2Fconfig%2Fconfig_type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fconfig%2Fconfig_type.rs?ref=1b0efd99e65b5244616b1b623725714b38123904", "patch": "@@ -403,6 +403,9 @@ macro_rules! create_config {\n                 if self.use_small_heuristics.2 == Heuristics::Default {\n                     let max_width = self.max_width.2;\n                     self.set().width_heuristics(WidthHeuristics::scaled(max_width));\n+                } else if self.use_small_heuristics.2 == Heuristics::Max {\n+                    let max_width = self.max_width.2;\n+                    self.set().width_heuristics(WidthHeuristics::set(max_width));\n                 } else {\n                     self.set().width_heuristics(WidthHeuristics::null());\n                 }"}, {"sha": "a581cdef43df65a248df2ed75102393ba3086828", "filename": "src/config/options.rs", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/1b0efd99e65b5244616b1b623725714b38123904/src%2Fconfig%2Foptions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1b0efd99e65b5244616b1b623725714b38123904/src%2Fconfig%2Foptions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fconfig%2Foptions.rs?ref=1b0efd99e65b5244616b1b623725714b38123904", "patch": "@@ -154,6 +154,8 @@ configuration_option_enum! { TypeDensity:\n configuration_option_enum! { Heuristics:\n     // Turn off any heuristics\n     Off,\n+    // Turn on max heuristics\n+    Max,\n     // Use Rustfmt's defaults\n     Default,\n }\n@@ -257,6 +259,17 @@ impl WidthHeuristics {\n         }\n     }\n \n+    pub fn set(max_width: usize) -> WidthHeuristics {\n+        WidthHeuristics {\n+            fn_call_width: max_width,\n+            struct_lit_width: max_width,\n+            struct_variant_width: max_width,\n+            array_width: max_width,\n+            chain_width: max_width,\n+            single_line_if_else_max_width: max_width,\n+        }\n+    }\n+\n     // scale the default WidthHeuristics according to max_width\n     pub fn scaled(max_width: usize) -> WidthHeuristics {\n         const DEFAULT_MAX_WIDTH: usize = 100;"}, {"sha": "8d30932e2c24d5cfc1a67b3108d97759d690becf", "filename": "tests/source/configs/use_small_heuristics/max.rs", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/rust-lang/rust/blob/1b0efd99e65b5244616b1b623725714b38123904/tests%2Fsource%2Fconfigs%2Fuse_small_heuristics%2Fmax.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1b0efd99e65b5244616b1b623725714b38123904/tests%2Fsource%2Fconfigs%2Fuse_small_heuristics%2Fmax.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fconfigs%2Fuse_small_heuristics%2Fmax.rs?ref=1b0efd99e65b5244616b1b623725714b38123904", "patch": "@@ -0,0 +1,25 @@\n+// rustfmt-use_small_heuristics: Max\n+\n+enum Lorem {\n+    Ipsum,\n+    Dolor(bool),\n+    Sit {\n+        amet: Consectetur,\n+        adipiscing: Elit,\n+    },\n+}\n+\n+fn main() {\n+    lorem(\"lorem\", \"ipsum\", \"dolor\", \"sit\", \"amet\", \"consectetur\", \"adipiscing\");\n+\n+    let lorem = Lorem {\n+        ipsum: dolor,\n+        sit: amet,\n+    };\n+\n+    let lorem = if ipsum {\n+        dolor\n+    } else {\n+        sit\n+    };\n+}"}, {"sha": "785dfbea01439665faf696137684eb01bd2d7b6c", "filename": "tests/target/configs/use_small_heuristics/max.rs", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/1b0efd99e65b5244616b1b623725714b38123904/tests%2Ftarget%2Fconfigs%2Fuse_small_heuristics%2Fmax.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1b0efd99e65b5244616b1b623725714b38123904/tests%2Ftarget%2Fconfigs%2Fuse_small_heuristics%2Fmax.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fconfigs%2Fuse_small_heuristics%2Fmax.rs?ref=1b0efd99e65b5244616b1b623725714b38123904", "patch": "@@ -0,0 +1,15 @@\n+// rustfmt-use_small_heuristics: Max\n+\n+enum Lorem {\n+    Ipsum,\n+    Dolor(bool),\n+    Sit { amet: Consectetur, adipiscing: Elit },\n+}\n+\n+fn main() {\n+    lorem(\"lorem\", \"ipsum\", \"dolor\", \"sit\", \"amet\", \"consectetur\", \"adipiscing\");\n+\n+    let lorem = Lorem { ipsum: dolor, sit: amet };\n+\n+    let lorem = if ipsum { dolor } else { sit };\n+}"}]}