{"sha": "ce40c48c4562fbc73a00d8023c221b54c7f2d466", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNlNDBjNDhjNDU2MmZiYzczYTAwZDgwMjNjMjIxYjU0YzdmMmQ0NjY=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-08-31T13:10:23Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-08-31T13:10:23Z"}, "message": "Auto merge of #28116 - nrc:closure-expand, r=alexcrichton", "tree": {"sha": "4e99d1ac7ed36ac8d710133c0733f7a4bf3d21d0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4e99d1ac7ed36ac8d710133c0733f7a4bf3d21d0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ce40c48c4562fbc73a00d8023c221b54c7f2d466", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ce40c48c4562fbc73a00d8023c221b54c7f2d466", "html_url": "https://github.com/rust-lang/rust/commit/ce40c48c4562fbc73a00d8023c221b54c7f2d466", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ce40c48c4562fbc73a00d8023c221b54c7f2d466/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6a69bdd9e92051d7efb9babb509027e522cc4f4c", "url": "https://api.github.com/repos/rust-lang/rust/commits/6a69bdd9e92051d7efb9babb509027e522cc4f4c", "html_url": "https://github.com/rust-lang/rust/commit/6a69bdd9e92051d7efb9babb509027e522cc4f4c"}, {"sha": "ef4853041a091f928a44aac28abf431965ce6fa2", "url": "https://api.github.com/repos/rust-lang/rust/commits/ef4853041a091f928a44aac28abf431965ce6fa2", "html_url": "https://github.com/rust-lang/rust/commit/ef4853041a091f928a44aac28abf431965ce6fa2"}], "stats": {"total": 7, "additions": 1, "deletions": 6}, "files": [{"sha": "56a15ce895cf24f7fddc0cfd75f6e4e273b3095e", "filename": "src/libsyntax/codemap.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ce40c48c4562fbc73a00d8023c221b54c7f2d466/src%2Flibsyntax%2Fcodemap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ce40c48c4562fbc73a00d8023c221b54c7f2d466/src%2Flibsyntax%2Fcodemap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fcodemap.rs?ref=ce40c48c4562fbc73a00d8023c221b54c7f2d466", "patch": "@@ -275,7 +275,6 @@ pub enum CompilerExpansionFormat {\n     PlacementIn,\n     WhileLet,\n     ForLoop,\n-    Closure,\n }\n \n impl CompilerExpansionFormat {\n@@ -285,7 +284,6 @@ impl CompilerExpansionFormat {\n             CompilerExpansionFormat::PlacementIn => \"placement-in expansion\",\n             CompilerExpansionFormat::WhileLet => \"while let expansion\",\n             CompilerExpansionFormat::ForLoop => \"for loop expansion\",\n-            CompilerExpansionFormat::Closure => \"closure expansion\",\n         }\n     }\n }"}, {"sha": "c1c6918aba7be4ecc983f4da0e4348ce177f4b13", "filename": "src/libsyntax/ext/expand.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/ce40c48c4562fbc73a00d8023c221b54c7f2d466/src%2Flibsyntax%2Fext%2Fexpand.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ce40c48c4562fbc73a00d8023c221b54c7f2d466/src%2Flibsyntax%2Fext%2Fexpand.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Fext%2Fexpand.rs?ref=ce40c48c4562fbc73a00d8023c221b54c7f2d466", "patch": "@@ -459,15 +459,12 @@ pub fn expand_expr(e: P<ast::Expr>, fld: &mut MacroExpander) -> P<ast::Expr> {\n         }\n \n         ast::ExprClosure(capture_clause, fn_decl, block) => {\n-            push_compiler_expansion(fld, span, CompilerExpansionFormat::Closure);\n             let (rewritten_fn_decl, rewritten_block)\n                 = expand_and_rename_fn_decl_and_block(fn_decl, block, fld);\n             let new_node = ast::ExprClosure(capture_clause,\n                                             rewritten_fn_decl,\n                                             rewritten_block);\n-            let result = P(ast::Expr{id:id, node: new_node, span: fld.new_span(span)});\n-            fld.cx.bt_pop();\n-            result\n+            P(ast::Expr{id:id, node: new_node, span: fld.new_span(span)})\n         }\n \n         _ => {"}]}