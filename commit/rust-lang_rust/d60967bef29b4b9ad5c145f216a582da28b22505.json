{"sha": "d60967bef29b4b9ad5c145f216a582da28b22505", "node_id": "C_kwDOAAsO6NoAKGQ2MDk2N2JlZjI5YjRiOWFkNWMxNDVmMjE2YTU4MmRhMjhiMjI1MDU", "commit": {"author": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2022-12-09T17:40:49Z"}, "committer": {"name": "Michael Howell", "email": "michael@notriddle.com", "date": "2022-12-09T17:54:44Z"}, "message": "rustdoc: make stability badge CSS more consistent\n\n* They all get rounded corners now. A test case has been added for this, too.\n\n* There are now broadly two kinds of stability badge, where there used to be\n  three: item-info \"fat badge\", and the \"thin badge\" in both item tables and\n  in docblocks (which got merged). The fat badges can have icons, while the\n  thin badges can't.", "tree": {"sha": "89f6831651a492404afbe0b4340f26bea0e181c6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/89f6831651a492404afbe0b4340f26bea0e181c6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d60967bef29b4b9ad5c145f216a582da28b22505", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d60967bef29b4b9ad5c145f216a582da28b22505", "html_url": "https://github.com/rust-lang/rust/commit/d60967bef29b4b9ad5c145f216a582da28b22505", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d60967bef29b4b9ad5c145f216a582da28b22505/comments", "author": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "committer": {"login": "notriddle", "id": 1593513, "node_id": "MDQ6VXNlcjE1OTM1MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1593513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notriddle", "html_url": "https://github.com/notriddle", "followers_url": "https://api.github.com/users/notriddle/followers", "following_url": "https://api.github.com/users/notriddle/following{/other_user}", "gists_url": "https://api.github.com/users/notriddle/gists{/gist_id}", "starred_url": "https://api.github.com/users/notriddle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notriddle/subscriptions", "organizations_url": "https://api.github.com/users/notriddle/orgs", "repos_url": "https://api.github.com/users/notriddle/repos", "events_url": "https://api.github.com/users/notriddle/events{/privacy}", "received_events_url": "https://api.github.com/users/notriddle/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e10201c9bb8e225095d76e6650dcfe8dadc50327", "url": "https://api.github.com/repos/rust-lang/rust/commits/e10201c9bb8e225095d76e6650dcfe8dadc50327", "html_url": "https://github.com/rust-lang/rust/commit/e10201c9bb8e225095d76e6650dcfe8dadc50327"}], "stats": {"total": 81, "additions": 54, "deletions": 27}, "files": [{"sha": "37f115e3d9efce9d290b585aae4dada2bcab5ce9", "filename": "src/librustdoc/html/static/css/rustdoc.css", "status": "modified", "additions": 13, "deletions": 22, "changes": 35, "blob_url": "https://github.com/rust-lang/rust/blob/d60967bef29b4b9ad5c145f216a582da28b22505/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "raw_url": "https://github.com/rust-lang/rust/raw/d60967bef29b4b9ad5c145f216a582da28b22505/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Frustdoc.css?ref=d60967bef29b4b9ad5c145f216a582da28b22505", "patch": "@@ -212,7 +212,7 @@ pre.rust a,\n .mobile-topbar h2 a,\n h1 a,\n .search-results a,\n-.item-left .stab,\n+.stab,\n .result-name .primitive > i, .result-name .keyword > i {\n \tcolor: var(--main-color);\n }\n@@ -960,22 +960,29 @@ so that we can apply CSS-filters to change the arrow color in themes */\n }\n \n .item-info .stab {\n-\twidth: fit-content;\n \t/* This min-height is needed to unify the height of the stab elements because some of them\n \t   have emojis.\n \t*/\n \tmin-height: 36px;\n \tdisplay: flex;\n-\talign-items: center;\n-\twhite-space: pre-wrap;\n-}\n-.stab {\n \tpadding: 3px;\n \tmargin-bottom: 5px;\n+}\n+.item-left .stab {\n+\tmargin-left: 0.3125em;\n+}\n+.stab {\n+\tpadding: 0 2px;\n \tfont-size: 0.875rem;\n \tfont-weight: normal;\n \tcolor: var(--main-color);\n \tbackground-color: var(--stab-background-color);\n+\twidth: fit-content;\n+\talign-items: center;\n+\twhite-space: pre-wrap;\n+\tborder-radius: 3px;\n+\tdisplay: inline-flex;\n+\tvertical-align: text-bottom;\n }\n \n .stab.portability > code {\n@@ -988,12 +995,6 @@ so that we can apply CSS-filters to change the arrow color in themes */\n \tmargin-right: 0.3rem;\n }\n \n-/* This is to prevent the `.stab` elements to overflow the .docblock elements. */\n-.docblock .stab {\n-\tpadding: 0 0.125em;\n-\tmargin-bottom: 0;\n-}\n-\n /* Black one-pixel outline around emoji shapes */\n .emoji {\n \ttext-shadow:\n@@ -1003,16 +1004,6 @@ so that we can apply CSS-filters to change the arrow color in themes */\n \t\t0 -1px 0 black;\n }\n \n-.item-left .stab {\n-\tborder-radius: 3px;\n-\tdisplay: inline-block;\n-\tline-height: 1.2;\n-\tmargin-bottom: 0;\n-\tmargin-left: 0.3125em;\n-\tpadding: 2px;\n-\tvertical-align: text-bottom;\n-}\n-\n .module-item.unstable,\n .import-item.unstable {\n \topacity: 0.65;"}, {"sha": "eba845bf5a91565f2219f56f71c9eeb8701526a2", "filename": "src/librustdoc/html/static/css/themes/ayu.css", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/d60967bef29b4b9ad5c145f216a582da28b22505/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "raw_url": "https://github.com/rust-lang/rust/raw/d60967bef29b4b9ad5c145f216a582da28b22505/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fcss%2Fthemes%2Fayu.css?ref=d60967bef29b4b9ad5c145f216a582da28b22505", "patch": "@@ -160,11 +160,6 @@ body.source .example-wrap pre.rust a {\n \tbackground: #333;\n }\n \n-.module-item .stab,\n-.import-item .stab {\n-\tcolor: #000;\n-}\n-\n .result-name .primitive > i, .result-name .keyword > i {\n \tcolor: #788797;\n }"}, {"sha": "aaed8440a40bd44807ac174149a1128732eba65e", "filename": "src/test/rustdoc-gui/stab-badge.goml", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/rust-lang/rust/blob/d60967bef29b4b9ad5c145f216a582da28b22505/src%2Ftest%2Frustdoc-gui%2Fstab-badge.goml", "raw_url": "https://github.com/rust-lang/rust/raw/d60967bef29b4b9ad5c145f216a582da28b22505/src%2Ftest%2Frustdoc-gui%2Fstab-badge.goml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc-gui%2Fstab-badge.goml?ref=d60967bef29b4b9ad5c145f216a582da28b22505", "patch": "@@ -0,0 +1,41 @@\n+// All stability badges should have rounded corners and colored backgrounds.\n+goto: \"file://\" + |DOC_PATH| + \"/test_docs/index.html\"\n+show-text: true\n+define-function: (\n+\t\"check-badge\",\n+\t(theme, background, color),\n+\t[\n+        (\"local-storage\", {\"rustdoc-use-system-theme\": \"false\", \"rustdoc-theme\": |theme|}),\n+        (\"goto\", \"file://\" + |DOC_PATH| + \"/test_docs/index.html\"),\n+\t\t(\"assert\", (\".docblock .stab\")),\n+\t\t(\"assert\", (\".item-table .stab\")),\n+\t\t(\"assert-css\", (\".stab\", {\n+\t\t\t\"border-radius\": \"3px\",\n+\t\t\t\"color\": |color|,\n+\t\t\t\"background-color\": |background|,\n+\t\t})),\n+        (\"goto\", \"file://\" + |DOC_PATH| + \"/test_docs/fn.replaced_function.html\"),\n+\t\t(\"assert\", (\".item-info .stab\")),\n+\t\t(\"assert-css\", (\".stab\", {\n+\t\t\t\"border-radius\": \"3px\",\n+\t\t\t\"color\": |color|,\n+\t\t\t\"background-color\": |background|,\n+\t\t})),\n+\t]\n+)\n+\n+call-function: (\"check-badge\", {\n+\t\"theme\": \"ayu\",\n+\t\"color\": \"rgb(197, 197, 197)\",\n+\t\"background\": \"rgb(49, 69, 89)\",\n+})\n+call-function: (\"check-badge\", {\n+\t\"theme\": \"dark\",\n+\t\"color\": \"rgb(221, 221, 221)\",\n+\t\"background\": \"rgb(49, 69, 89)\",\n+})\n+call-function: (\"check-badge\", {\n+\t\"theme\": \"light\",\n+\t\"color\": \"rgb(0, 0, 0)\",\n+\t\"background\": \"rgb(255, 245, 214)\",\n+})"}]}