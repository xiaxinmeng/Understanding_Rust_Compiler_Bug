{"sha": "880da380f170ad330736ed1efcef471a9c48cc9a", "node_id": "C_kwDOAAsO6NoAKDg4MGRhMzgwZjE3MGFkMzMwNzM2ZWQxZWZjZWY0NzFhOWM0OGNjOWE", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-05-29T19:34:18Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-05-29T19:34:18Z"}, "message": "Rollup merge of #112057 - MU001999:fix/self-sugg, r=compiler-errors\n\nSuggest correct `self_ty`\n\nFixes #112036", "tree": {"sha": "22935e939c16c148c55d0ccbfe752f2b11065772", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/22935e939c16c148c55d0ccbfe752f2b11065772"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/880da380f170ad330736ed1efcef471a9c48cc9a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkdP46CRBK7hj4Ov3rIwAAbHMIADRBsdMl6zyrIsuSuCrnLmCg\n2Z4SFSUDsHrMaoOAZiF3/hoEPZ/XGU7+OwjmgupUyTW302Eh9HCFX3+h4zGS2M7P\ndpD2hshm+mwg2Z0Gnk/SzcdBtv8Mw1XraVyRkXvryKctJ2hLdEF1x7ZnYAMZhd0L\nqVK+jn1ffoQ1D8bn5yGfK8rohcChjnYNBzqrImxeyZTfG7BJqzJixjR2TzmG4SNA\n2gc1qgArBm37iPieI/2bYaVT5/rfCWOm+tP1000D3xkS3HMseGvUXfNU/NnoctKO\nQTvRIhEyb7PCwL7Eh8XRtejx0cxoi5cQY1oMliFE7ziOZSVE7fLFQPX9+UZsQlk=\n=26Q5\n-----END PGP SIGNATURE-----\n", "payload": "tree 22935e939c16c148c55d0ccbfe752f2b11065772\nparent ef9a681183ff2d6cd04d2a87e8898d1c0b2d46ae\nparent 2f65aac667302849407fe677cc34078300b57eee\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1685388858 +0200\ncommitter GitHub <noreply@github.com> 1685388858 +0200\n\nRollup merge of #112057 - MU001999:fix/self-sugg, r=compiler-errors\n\nSuggest correct `self_ty`\n\nFixes #112036\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/880da380f170ad330736ed1efcef471a9c48cc9a", "html_url": "https://github.com/rust-lang/rust/commit/880da380f170ad330736ed1efcef471a9c48cc9a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/880da380f170ad330736ed1efcef471a9c48cc9a/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ef9a681183ff2d6cd04d2a87e8898d1c0b2d46ae", "url": "https://api.github.com/repos/rust-lang/rust/commits/ef9a681183ff2d6cd04d2a87e8898d1c0b2d46ae", "html_url": "https://github.com/rust-lang/rust/commit/ef9a681183ff2d6cd04d2a87e8898d1c0b2d46ae"}, {"sha": "2f65aac667302849407fe677cc34078300b57eee", "url": "https://api.github.com/repos/rust-lang/rust/commits/2f65aac667302849407fe677cc34078300b57eee", "html_url": "https://github.com/rust-lang/rust/commit/2f65aac667302849407fe677cc34078300b57eee"}], "stats": {"total": 26, "additions": 24, "deletions": 2}, "files": [{"sha": "18b6537a8e9045fd0b9b111c8bb6e104c6b4b66d", "filename": "compiler/rustc_hir_analysis/src/check/compare_impl_item.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/880da380f170ad330736ed1efcef471a9c48cc9a/compiler%2Frustc_hir_analysis%2Fsrc%2Fcheck%2Fcompare_impl_item.rs", "raw_url": "https://github.com/rust-lang/rust/raw/880da380f170ad330736ed1efcef471a9c48cc9a/compiler%2Frustc_hir_analysis%2Fsrc%2Fcheck%2Fcompare_impl_item.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_hir_analysis%2Fsrc%2Fcheck%2Fcompare_impl_item.rs?ref=880da380f170ad330736ed1efcef471a9c48cc9a", "patch": "@@ -902,7 +902,7 @@ fn report_trait_method_mismatch<'tcx>(\n             if trait_m.fn_has_self_parameter =>\n         {\n             let ty = trait_sig.inputs()[0];\n-            let sugg = match ExplicitSelf::determine(ty, |_| ty == impl_trait_ref.self_ty()) {\n+            let sugg = match ExplicitSelf::determine(ty, |ty| ty == impl_trait_ref.self_ty()) {\n                 ExplicitSelf::ByValue => \"self\".to_owned(),\n                 ExplicitSelf::ByReference(_, hir::Mutability::Not) => \"&self\".to_owned(),\n                 ExplicitSelf::ByReference(_, hir::Mutability::Mut) => \"&mut self\".to_owned(),"}, {"sha": "d0bd5b46cf59f9f6851e2c048caf39528fc1e489", "filename": "tests/ui/mismatched_types/E0053.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/880da380f170ad330736ed1efcef471a9c48cc9a/tests%2Fui%2Fmismatched_types%2FE0053.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/880da380f170ad330736ed1efcef471a9c48cc9a/tests%2Fui%2Fmismatched_types%2FE0053.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmismatched_types%2FE0053.stderr?ref=880da380f170ad330736ed1efcef471a9c48cc9a", "patch": "@@ -22,7 +22,7 @@ LL |     fn bar(&mut self) { }\n    |            ^^^^^^^^^\n    |            |\n    |            types differ in mutability\n-   |            help: change the self-receiver type to match the trait: `self: &Bar`\n+   |            help: change the self-receiver type to match the trait: `&self`\n    |\n note: type in trait\n   --> $DIR/E0053.rs:3:12"}, {"sha": "e63471e974771d5b5e05f57e9d961ac5d46ec45e", "filename": "tests/ui/mismatched_types/issue-112036.rs", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/880da380f170ad330736ed1efcef471a9c48cc9a/tests%2Fui%2Fmismatched_types%2Fissue-112036.rs", "raw_url": "https://github.com/rust-lang/rust/raw/880da380f170ad330736ed1efcef471a9c48cc9a/tests%2Fui%2Fmismatched_types%2Fissue-112036.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmismatched_types%2Fissue-112036.rs?ref=880da380f170ad330736ed1efcef471a9c48cc9a", "patch": "@@ -0,0 +1,7 @@\n+struct Foo;\n+\n+impl Drop for Foo {\n+    fn drop(self) {} //~ ERROR method `drop` has an incompatible type for trait\n+}\n+\n+fn main() {}"}, {"sha": "a883aba35bfba170f0080e868a57d415cb18b0d6", "filename": "tests/ui/mismatched_types/issue-112036.stderr", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/880da380f170ad330736ed1efcef471a9c48cc9a/tests%2Fui%2Fmismatched_types%2Fissue-112036.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/880da380f170ad330736ed1efcef471a9c48cc9a/tests%2Fui%2Fmismatched_types%2Fissue-112036.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fui%2Fmismatched_types%2Fissue-112036.stderr?ref=880da380f170ad330736ed1efcef471a9c48cc9a", "patch": "@@ -0,0 +1,15 @@\n+error[E0053]: method `drop` has an incompatible type for trait\n+  --> $DIR/issue-112036.rs:4:13\n+   |\n+LL |     fn drop(self) {}\n+   |             ^^^^\n+   |             |\n+   |             expected `&mut Foo`, found `Foo`\n+   |             help: change the self-receiver type to match the trait: `&mut self`\n+   |\n+   = note: expected signature `fn(&mut Foo)`\n+              found signature `fn(Foo)`\n+\n+error: aborting due to previous error\n+\n+For more information about this error, try `rustc --explain E0053`."}]}