{"sha": "d60df536d5d6a4ad2d6b2cdf4c443e022fe35d30", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ2MGRmNTM2ZDVkNmE0YWQyZDZiMmNkZjRjNDQzZTAyMmZlMzVkMzA=", "commit": {"author": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2020-06-09T19:36:33Z"}, "committer": {"name": "Vadim Petrochenkov", "email": "vadim.petrochenkov@gmail.com", "date": "2020-06-09T19:36:33Z"}, "message": "Add tests for modifying lint levels for lints reported at expansion time", "tree": {"sha": "93261f77aeab9947bb3e79b62a74e80ca9802e13", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/93261f77aeab9947bb3e79b62a74e80ca9802e13"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d60df536d5d6a4ad2d6b2cdf4c443e022fe35d30", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d60df536d5d6a4ad2d6b2cdf4c443e022fe35d30", "html_url": "https://github.com/rust-lang/rust/commit/d60df536d5d6a4ad2d6b2cdf4c443e022fe35d30", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d60df536d5d6a4ad2d6b2cdf4c443e022fe35d30/comments", "author": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "committer": {"login": "petrochenkov", "id": 5751617, "node_id": "MDQ6VXNlcjU3NTE2MTc=", "avatar_url": "https://avatars.githubusercontent.com/u/5751617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petrochenkov", "html_url": "https://github.com/petrochenkov", "followers_url": "https://api.github.com/users/petrochenkov/followers", "following_url": "https://api.github.com/users/petrochenkov/following{/other_user}", "gists_url": "https://api.github.com/users/petrochenkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/petrochenkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petrochenkov/subscriptions", "organizations_url": "https://api.github.com/users/petrochenkov/orgs", "repos_url": "https://api.github.com/users/petrochenkov/repos", "events_url": "https://api.github.com/users/petrochenkov/events{/privacy}", "received_events_url": "https://api.github.com/users/petrochenkov/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "217a7451c419b25ddecbd941f6006675738a41eb", "url": "https://api.github.com/repos/rust-lang/rust/commits/217a7451c419b25ddecbd941f6006675738a41eb", "html_url": "https://github.com/rust-lang/rust/commit/217a7451c419b25ddecbd941f6006675738a41eb"}], "stats": {"total": 83, "additions": 83, "deletions": 0}, "files": [{"sha": "4ea89d5adff94a3693949409c987439ad2c48240", "filename": "src/test/ui/lint/expansion-time-include.rs", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/d60df536d5d6a4ad2d6b2cdf4c443e022fe35d30/src%2Ftest%2Fui%2Flint%2Fexpansion-time-include.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d60df536d5d6a4ad2d6b2cdf4c443e022fe35d30/src%2Ftest%2Fui%2Flint%2Fexpansion-time-include.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fexpansion-time-include.rs?ref=d60df536d5d6a4ad2d6b2cdf4c443e022fe35d30", "patch": "@@ -0,0 +1,4 @@\n+// ignore-test auxiliary file for expansion-time.rs\n+\n+1\n+2"}, {"sha": "6e420c51f0a7ffa9d405279e1294ad47fc5af0ad", "filename": "src/test/ui/lint/expansion-time.rs", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/d60df536d5d6a4ad2d6b2cdf4c443e022fe35d30/src%2Ftest%2Fui%2Flint%2Fexpansion-time.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d60df536d5d6a4ad2d6b2cdf4c443e022fe35d30/src%2Ftest%2Fui%2Flint%2Fexpansion-time.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fexpansion-time.rs?ref=d60df536d5d6a4ad2d6b2cdf4c443e022fe35d30", "patch": "@@ -0,0 +1,23 @@\n+// check-pass\n+\n+#[warn(meta_variable_misuse)]\n+macro_rules! foo {\n+    ( $($i:ident)* ) => { $($i)+ }; //~ WARN meta-variable repeats with different Kleene operator\n+}\n+\n+#[warn(missing_fragment_specifier)]\n+macro_rules! m { ($i) => {} } //~ WARN missing fragment specifier\n+                              //~| WARN this was previously accepted\n+\n+#[warn(soft_unstable)]\n+mod benches {\n+    #[bench] //~ WARN use of unstable library feature 'test'\n+             //~| WARN this was previously accepted\n+    fn foo() {}\n+}\n+\n+#[warn(incomplete_include)]\n+fn main() {\n+    // WARN see in the stderr file, the warning points to the included file.\n+    include!(\"expansion-time-include.rs\");\n+}"}, {"sha": "e6b5cf67e390461673f12563096f2b4ff5629e91", "filename": "src/test/ui/lint/expansion-time.stderr", "status": "added", "additions": 56, "deletions": 0, "changes": 56, "blob_url": "https://github.com/rust-lang/rust/blob/d60df536d5d6a4ad2d6b2cdf4c443e022fe35d30/src%2Ftest%2Fui%2Flint%2Fexpansion-time.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d60df536d5d6a4ad2d6b2cdf4c443e022fe35d30/src%2Ftest%2Fui%2Flint%2Fexpansion-time.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Flint%2Fexpansion-time.stderr?ref=d60df536d5d6a4ad2d6b2cdf4c443e022fe35d30", "patch": "@@ -0,0 +1,56 @@\n+warning: meta-variable repeats with different Kleene operator\n+  --> $DIR/expansion-time.rs:5:29\n+   |\n+LL |     ( $($i:ident)* ) => { $($i)+ };\n+   |                  -          ^^ - conflicting repetition\n+   |                  |\n+   |                  expected repetition\n+   |\n+note: the lint level is defined here\n+  --> $DIR/expansion-time.rs:3:8\n+   |\n+LL | #[warn(meta_variable_misuse)]\n+   |        ^^^^^^^^^^^^^^^^^^^^\n+\n+warning: missing fragment specifier\n+  --> $DIR/expansion-time.rs:9:19\n+   |\n+LL | macro_rules! m { ($i) => {} }\n+   |                   ^^\n+   |\n+note: the lint level is defined here\n+  --> $DIR/expansion-time.rs:8:8\n+   |\n+LL | #[warn(missing_fragment_specifier)]\n+   |        ^^^^^^^^^^^^^^^^^^^^^^^^^^\n+   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n+   = note: for more information, see issue #40107 <https://github.com/rust-lang/rust/issues/40107>\n+\n+warning: use of unstable library feature 'test': `bench` is a part of custom test frameworks which are unstable\n+  --> $DIR/expansion-time.rs:14:7\n+   |\n+LL |     #[bench]\n+   |       ^^^^^\n+   |\n+note: the lint level is defined here\n+  --> $DIR/expansion-time.rs:12:8\n+   |\n+LL | #[warn(soft_unstable)]\n+   |        ^^^^^^^^^^^^^\n+   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in a future release!\n+   = note: for more information, see issue #64266 <https://github.com/rust-lang/rust/issues/64266>\n+\n+warning: include macro expected single expression in source\n+  --> $DIR/expansion-time-include.rs:4:1\n+   |\n+LL | 2\n+   | ^\n+   |\n+note: the lint level is defined here\n+  --> $DIR/expansion-time.rs:19:8\n+   |\n+LL | #[warn(incomplete_include)]\n+   |        ^^^^^^^^^^^^^^^^^^\n+\n+warning: 4 warnings emitted\n+"}]}