{"sha": "60db4487904a1c8ed6a99343c648c0fbda2447b6", "node_id": "C_kwDOAAsO6NoAKDYwZGI0NDg3OTA0YTFjOGVkNmE5OTM0M2M2NDhjMGZiZGEyNDQ3YjY", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2023-05-06T21:32:01Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2023-05-06T21:32:01Z"}, "message": "Rollup merge of #111151 - ozkanonur:syntax-check-on-bootstrap-scripts, r=Mark-Simulacrum\n\ncheck bootstrap scripts syntax\n\nFails bootstrapping if `x`/`x.ps1` scripts are not valid. Currently, it keeps executing lines until the invalid one.", "tree": {"sha": "5f1fcdd1b4c3469ab98bf8bcc1aa1e01c3ca91d7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5f1fcdd1b4c3469ab98bf8bcc1aa1e01c3ca91d7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/60db4487904a1c8ed6a99343c648c0fbda2447b6", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkVsdRCRBK7hj4Ov3rIwAAoMMIAHAKfNhvkvg+vu/qOW1sVsoW\ngVWjOx8FBBxJd1DKyHSsoiuL6yM2qGcnSDj55CB8RVc1+5h0tl57jOpFG39ACXXB\nuJn1pbDbFAhb2QREuQtNw1e5a0XyOhpuQFieL6VE93nVSnmJJDAXH5cFExmFGBLQ\ndZKrsdUKxJ4xYdI21XonQFuD0JPc00l2wLBzb0jdDPeh+axKhH1x8oDUOseyQKya\nCgOrnRDakEuifqrHiGaHAWONJZWuLkjpndkuClfxjbHt51ZiEObpzijZeQgKth7Q\nDUSOVIw9QwyitkeKxFZgsmScbNMQ1/yffUxq7SZ+nwULd/6WLM4rNUltEXk4DuM=\n=Sq+p\n-----END PGP SIGNATURE-----\n", "payload": "tree 5f1fcdd1b4c3469ab98bf8bcc1aa1e01c3ca91d7\nparent bccd29611ac6718d39b8c9d9f4d89052922248b1\nparent eea6202c248f0aa57a7f490f50a7bf21f322a40e\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1683408721 +0200\ncommitter GitHub <noreply@github.com> 1683408721 +0200\n\nRollup merge of #111151 - ozkanonur:syntax-check-on-bootstrap-scripts, r=Mark-Simulacrum\n\ncheck bootstrap scripts syntax\n\nFails bootstrapping if `x`/`x.ps1` scripts are not valid. Currently, it keeps executing lines until the invalid one.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/60db4487904a1c8ed6a99343c648c0fbda2447b6", "html_url": "https://github.com/rust-lang/rust/commit/60db4487904a1c8ed6a99343c648c0fbda2447b6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/60db4487904a1c8ed6a99343c648c0fbda2447b6/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bccd29611ac6718d39b8c9d9f4d89052922248b1", "url": "https://api.github.com/repos/rust-lang/rust/commits/bccd29611ac6718d39b8c9d9f4d89052922248b1", "html_url": "https://github.com/rust-lang/rust/commit/bccd29611ac6718d39b8c9d9f4d89052922248b1"}, {"sha": "eea6202c248f0aa57a7f490f50a7bf21f322a40e", "url": "https://api.github.com/repos/rust-lang/rust/commits/eea6202c248f0aa57a7f490f50a7bf21f322a40e", "html_url": "https://github.com/rust-lang/rust/commit/eea6202c248f0aa57a7f490f50a7bf21f322a40e"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "d967988e1c44b2b8705a3e63d1072358a0b8339a", "filename": "x", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/60db4487904a1c8ed6a99343c648c0fbda2447b6/x", "raw_url": "https://github.com/rust-lang/rust/raw/60db4487904a1c8ed6a99343c648c0fbda2447b6/x", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/x?ref=60db4487904a1c8ed6a99343c648c0fbda2447b6", "patch": "@@ -7,9 +7,12 @@\n \n set -eu\n \n+# syntax check\n+sh -n $0\n+\n realpath() {\n     if [ -d \"$1\" ]; then\n-        CDPATH='' command cd \"$1\" && pwd -P   \n+        CDPATH='' command cd \"$1\" && pwd -P\n     else\n         echo \"$(realpath \"$(dirname \"$1\")\")/$(basename \"$1\")\"\n     fi"}, {"sha": "a156017628db87e1cd5643257e5d781a7ee75547", "filename": "x.ps1", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/60db4487904a1c8ed6a99343c648c0fbda2447b6/x.ps1", "raw_url": "https://github.com/rust-lang/rust/raw/60db4487904a1c8ed6a99343c648c0fbda2447b6/x.ps1", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/x.ps1?ref=60db4487904a1c8ed6a99343c648c0fbda2447b6", "patch": "@@ -2,6 +2,11 @@\n \n # See ./x for why these scripts exist.\n \n+$ErrorActionPreference = \"Stop\"\n+\n+# syntax check\n+Get-Command -syntax ${PSCommandPath}\n+\n $xpy = Join-Path $PSScriptRoot x.py\n # Start-Process for some reason splits arguments on spaces. (Isn't powershell supposed to be simpler than bash?)\n # Double-quote all the arguments so it doesn't do that."}]}