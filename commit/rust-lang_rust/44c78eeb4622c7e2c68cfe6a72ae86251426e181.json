{"sha": "44c78eeb4622c7e2c68cfe6a72ae86251426e181", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ0Yzc4ZWViNDYyMmM3ZTJjNjhjZmU2YTcyYWU4NjI1MTQyNmUxODE=", "commit": {"author": {"name": "Jeffrey Seyfried", "email": "jeffrey.seyfried@gmail.com", "date": "2016-04-10T23:33:36Z"}, "committer": {"name": "Jeffrey Seyfried", "email": "jeffrey.seyfried@gmail.com", "date": "2016-04-14T04:58:42Z"}, "message": "Feature gate `pub(restricted)`", "tree": {"sha": "3567973d71a0ac7f577a5523082449072d183f1a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3567973d71a0ac7f577a5523082449072d183f1a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/44c78eeb4622c7e2c68cfe6a72ae86251426e181", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/44c78eeb4622c7e2c68cfe6a72ae86251426e181", "html_url": "https://github.com/rust-lang/rust/commit/44c78eeb4622c7e2c68cfe6a72ae86251426e181", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/44c78eeb4622c7e2c68cfe6a72ae86251426e181/comments", "author": {"login": "jseyfried", "id": 8652869, "node_id": "MDQ6VXNlcjg2NTI4Njk=", "avatar_url": "https://avatars.githubusercontent.com/u/8652869?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jseyfried", "html_url": "https://github.com/jseyfried", "followers_url": "https://api.github.com/users/jseyfried/followers", "following_url": "https://api.github.com/users/jseyfried/following{/other_user}", "gists_url": "https://api.github.com/users/jseyfried/gists{/gist_id}", "starred_url": "https://api.github.com/users/jseyfried/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jseyfried/subscriptions", "organizations_url": "https://api.github.com/users/jseyfried/orgs", "repos_url": "https://api.github.com/users/jseyfried/repos", "events_url": "https://api.github.com/users/jseyfried/events{/privacy}", "received_events_url": "https://api.github.com/users/jseyfried/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jseyfried", "id": 8652869, "node_id": "MDQ6VXNlcjg2NTI4Njk=", "avatar_url": "https://avatars.githubusercontent.com/u/8652869?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jseyfried", "html_url": "https://github.com/jseyfried", "followers_url": "https://api.github.com/users/jseyfried/followers", "following_url": "https://api.github.com/users/jseyfried/following{/other_user}", "gists_url": "https://api.github.com/users/jseyfried/gists{/gist_id}", "starred_url": "https://api.github.com/users/jseyfried/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jseyfried/subscriptions", "organizations_url": "https://api.github.com/users/jseyfried/orgs", "repos_url": "https://api.github.com/users/jseyfried/repos", "events_url": "https://api.github.com/users/jseyfried/events{/privacy}", "received_events_url": "https://api.github.com/users/jseyfried/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "50ce605f462cf7436ea454a38f99246a2c3bfddb", "url": "https://api.github.com/repos/rust-lang/rust/commits/50ce605f462cf7436ea454a38f99246a2c3bfddb", "html_url": "https://github.com/rust-lang/rust/commit/50ce605f462cf7436ea454a38f99246a2c3bfddb"}], "stats": {"total": 15, "additions": 15, "deletions": 0}, "files": [{"sha": "9960e88e7fb5afda15539d372a51208a23475359", "filename": "src/libsyntax/feature_gate.rs", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/44c78eeb4622c7e2c68cfe6a72ae86251426e181/src%2Flibsyntax%2Ffeature_gate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/44c78eeb4622c7e2c68cfe6a72ae86251426e181/src%2Flibsyntax%2Ffeature_gate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Ffeature_gate.rs?ref=44c78eeb4622c7e2c68cfe6a72ae86251426e181", "patch": "@@ -256,6 +256,9 @@ const KNOWN_FEATURES: &'static [(&'static str, &'static str, Option<u32>, Status\n \n     // impl specialization (RFC 1210)\n     (\"specialization\", \"1.7.0\", Some(31844), Active),\n+\n+    // pub(restricted) visibilities (RFC 1422)\n+    (\"pub_restricted\", \"1.9.0\", Some(32409), Active),\n ];\n // (changing above list without updating src/doc/reference.md makes @cmr sad)\n \n@@ -608,6 +611,7 @@ pub struct Features {\n     pub deprecated: bool,\n     pub question_mark: bool,\n     pub specialization: bool,\n+    pub pub_restricted: bool,\n }\n \n impl Features {\n@@ -644,6 +648,7 @@ impl Features {\n             deprecated: false,\n             question_mark: false,\n             specialization: false,\n+            pub_restricted: false,\n         }\n     }\n }\n@@ -1159,6 +1164,15 @@ impl<'a, 'v> Visitor<'v> for PostExpansionVisitor<'a> {\n         }\n         visit::walk_impl_item(self, ii);\n     }\n+\n+    fn visit_vis(&mut self, vis: &'v ast::Visibility) {\n+        let span = match *vis {\n+            ast::Visibility::Crate(span) => span,\n+            ast::Visibility::Restricted { ref path, .. } => path.span,\n+            _ => return,\n+        };\n+        self.gate_feature(\"pub_restricted\", span, \"`pub(restricted)` syntax is experimental\");\n+    }\n }\n \n fn check_crate_inner<F>(cm: &CodeMap, span_handler: &Handler,\n@@ -1256,6 +1270,7 @@ fn check_crate_inner<F>(cm: &CodeMap, span_handler: &Handler,\n         deprecated: cx.has_feature(\"deprecated\"),\n         question_mark: cx.has_feature(\"question_mark\"),\n         specialization: cx.has_feature(\"specialization\"),\n+        pub_restricted: cx.has_feature(\"pub_restricted\"),\n     }\n }\n "}]}