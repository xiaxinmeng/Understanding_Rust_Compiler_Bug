{"sha": "4711051b83f9c54d3cb6203cdf8a17c38d99ab7f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ3MTEwNTFiODNmOWM1NGQzY2I2MjAzY2RmOGExN2MzOGQ5OWFiN2Y=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-04-28T12:17:10Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-04-28T12:17:10Z"}, "message": "Rollup merge of #60270 - alexcrichton:metadata-multi-cgu, r=oli-obk\n\nrustc: Flag metadata compatible with multiple CGUs\n\nIt looks like the `OutputType::Metadata` kind in the compiler was\nmisclassified in #38571 long ago by accident as incompatible with\ncodegen units and a single output file. This means that if you emit both\na linkable artifact and metadata it silently turns off multiple codegen\nunits unintentionally!\n\nThis commit corrects the situation to ensure that if `--emit metadata`\nis used it doesn't implicitly disable multiple codegen units. This will\nensure we don't accidentally regress compiler performance when striving\nto implement pipelined compilation!", "tree": {"sha": "706f00bff77a9077d07fd2baee259faa75d4246c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/706f00bff77a9077d07fd2baee259faa75d4246c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4711051b83f9c54d3cb6203cdf8a17c38d99ab7f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJcxZnGCRBK7hj4Ov3rIwAAdHIIAAsOohKEa0HAu3hPbNjCdXC9\niUN+7k4bXaHf4nKwYiUE7fz+jT4A0U0YxMqrcLdqYpppn3L/uNy7CbE+VnX7PYf4\n1ipn4kFu3GiqpeToTwU9q72LyC8SKEnl4yTnrBv4MMV2TSoJYHGtpUZ7QWxIzzYb\n89dmKN4y69xmtNjKfgcDgolXmI0crpY1AzgE+59FvsOWn+4pizcgSwBmOFnAsuCz\nMqk5FluA3JuRlnwJj2vDswYrPSQ3BUgEuuVaF17KVVgQOeyUVwrH6rNqt3BVBGTH\neCm/rFH4QRQr2fgf0CgzLQWefWRvp7GlobP3TFS6Zyu/C6ztZ/amPKHUx+hUUps=\n=3+r9\n-----END PGP SIGNATURE-----\n", "payload": "tree 706f00bff77a9077d07fd2baee259faa75d4246c\nparent 95abeb0705fd0e5c4a14cfa900b90b9a5de34577\nparent 955f283e11dec628a988e23100f21ab92329b3bd\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1556453830 +0200\ncommitter GitHub <noreply@github.com> 1556453830 +0200\n\nRollup merge of #60270 - alexcrichton:metadata-multi-cgu, r=oli-obk\n\nrustc: Flag metadata compatible with multiple CGUs\n\nIt looks like the `OutputType::Metadata` kind in the compiler was\nmisclassified in #38571 long ago by accident as incompatible with\ncodegen units and a single output file. This means that if you emit both\na linkable artifact and metadata it silently turns off multiple codegen\nunits unintentionally!\n\nThis commit corrects the situation to ensure that if `--emit metadata`\nis used it doesn't implicitly disable multiple codegen units. This will\nensure we don't accidentally regress compiler performance when striving\nto implement pipelined compilation!\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4711051b83f9c54d3cb6203cdf8a17c38d99ab7f", "html_url": "https://github.com/rust-lang/rust/commit/4711051b83f9c54d3cb6203cdf8a17c38d99ab7f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4711051b83f9c54d3cb6203cdf8a17c38d99ab7f/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "95abeb0705fd0e5c4a14cfa900b90b9a5de34577", "url": "https://api.github.com/repos/rust-lang/rust/commits/95abeb0705fd0e5c4a14cfa900b90b9a5de34577", "html_url": "https://github.com/rust-lang/rust/commit/95abeb0705fd0e5c4a14cfa900b90b9a5de34577"}, {"sha": "955f283e11dec628a988e23100f21ab92329b3bd", "url": "https://api.github.com/repos/rust-lang/rust/commits/955f283e11dec628a988e23100f21ab92329b3bd", "html_url": "https://github.com/rust-lang/rust/commit/955f283e11dec628a988e23100f21ab92329b3bd"}], "stats": {"total": 5, "additions": 2, "deletions": 3}, "files": [{"sha": "e6203c94bfaa47a0968c05e6d12bee91fade384d", "filename": "src/librustc/session/config.rs", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/4711051b83f9c54d3cb6203cdf8a17c38d99ab7f/src%2Flibrustc%2Fsession%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4711051b83f9c54d3cb6203cdf8a17c38d99ab7f/src%2Flibrustc%2Fsession%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fsession%2Fconfig.rs?ref=4711051b83f9c54d3cb6203cdf8a17c38d99ab7f", "patch": "@@ -155,13 +155,12 @@ impl_stable_hash_via_hash!(OutputType);\n impl OutputType {\n     fn is_compatible_with_codegen_units_and_single_output_file(&self) -> bool {\n         match *self {\n-            OutputType::Exe | OutputType::DepInfo => true,\n+            OutputType::Exe | OutputType::DepInfo | OutputType::Metadata => true,\n             OutputType::Bitcode\n             | OutputType::Assembly\n             | OutputType::LlvmAssembly\n             | OutputType::Mir\n-            | OutputType::Object\n-            | OutputType::Metadata => false,\n+            | OutputType::Object => false,\n         }\n     }\n "}]}