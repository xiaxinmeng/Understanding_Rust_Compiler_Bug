{"sha": "45a6be545891f4a8f19f0dce801b67fdccf435ee", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ1YTZiZTU0NTg5MWY0YThmMTlmMGRjZTgwMWI2N2ZkY2NmNDM1ZWU=", "commit": {"author": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2019-08-14T18:44:56Z"}, "committer": {"name": "Esteban K\u00fcber", "email": "esteban@kuber.com.ar", "date": "2019-08-21T18:56:20Z"}, "message": "Fix tidy", "tree": {"sha": "debaa0f1f19a873642db6ef68ffd9bec9a520549", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/debaa0f1f19a873642db6ef68ffd9bec9a520549"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/45a6be545891f4a8f19f0dce801b67fdccf435ee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/45a6be545891f4a8f19f0dce801b67fdccf435ee", "html_url": "https://github.com/rust-lang/rust/commit/45a6be545891f4a8f19f0dce801b67fdccf435ee", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/45a6be545891f4a8f19f0dce801b67fdccf435ee/comments", "author": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "committer": {"login": "estebank", "id": 1606434, "node_id": "MDQ6VXNlcjE2MDY0MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1606434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/estebank", "html_url": "https://github.com/estebank", "followers_url": "https://api.github.com/users/estebank/followers", "following_url": "https://api.github.com/users/estebank/following{/other_user}", "gists_url": "https://api.github.com/users/estebank/gists{/gist_id}", "starred_url": "https://api.github.com/users/estebank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/estebank/subscriptions", "organizations_url": "https://api.github.com/users/estebank/orgs", "repos_url": "https://api.github.com/users/estebank/repos", "events_url": "https://api.github.com/users/estebank/events{/privacy}", "received_events_url": "https://api.github.com/users/estebank/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f08b036cc78ca225a8d3e25fc138ed3a210c611f", "url": "https://api.github.com/repos/rust-lang/rust/commits/f08b036cc78ca225a8d3e25fc138ed3a210c611f", "html_url": "https://github.com/rust-lang/rust/commit/f08b036cc78ca225a8d3e25fc138ed3a210c611f"}], "stats": {"total": 29, "additions": 14, "deletions": 15}, "files": [{"sha": "a78a4365633f761e54f1a447fb4e6cc448d15570", "filename": "src/librustc_errors/emitter.rs", "status": "modified", "additions": 10, "deletions": 11, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/45a6be545891f4a8f19f0dce801b67fdccf435ee/src%2Flibrustc_errors%2Femitter.rs", "raw_url": "https://github.com/rust-lang/rust/raw/45a6be545891f4a8f19f0dce801b67fdccf435ee/src%2Flibrustc_errors%2Femitter.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_errors%2Femitter.rs?ref=45a6be545891f4a8f19f0dce801b67fdccf435ee", "patch": "@@ -367,7 +367,8 @@ impl EmitterWriter {\n             &source_string[margin.left(line_len)..margin.right(line_len)],\n             Style::Quotation,\n         );\n-        if margin.was_cut_left() { // We have stripped some code/whitespace from the beginning, make it clear.\n+        if margin.was_cut_left() {\n+            // We have stripped some code/whitespace from the beginning, make it clear.\n             buffer.puts(line_offset, code_offset, \"...\", Style::LineNumber);\n         }\n         if margin.was_cut_right(line_len) {\n@@ -403,7 +404,7 @@ impl EmitterWriter {\n         //   ^^ ^ ^^^ ^^^^ ^^^ we don't care about code too far to the right of a span, we trim it\n         //   |  | |   |\n         //   |  | |   actual code found in your source code and the spans we use to mark it\n-        //   |  | when there's too much wasted space to the left, we trim it to focus where it matters\n+        //   |  | when there's too much wasted space to the left, trim it\n         //   |  vertical divider between the column number and the code\n         //   column number\n \n@@ -1251,18 +1252,16 @@ impl EmitterWriter {\n                 let mut label_right_margin = 0;\n                 let mut max_line_len = 0;\n                 for line in &annotated_file.lines {\n-                    max_line_len = max(\n-                        max_line_len,\n-                        annotated_file.file.get_line(line.line_index - 1).map(|s| s.len()).unwrap_or(0),\n-                    );\n+                    max_line_len = max(max_line_len, annotated_file.file\n+                        .get_line(line.line_index - 1)\n+                        .map(|s| s.len())\n+                        .unwrap_or(0));\n                     for ann in &line.annotations {\n                         span_right_margin = max(span_right_margin, ann.start_col);\n                         span_right_margin = max(span_right_margin, ann.end_col);\n-                        label_right_margin = max(\n-                            label_right_margin,\n-                            // TODO: account for labels not in the same line\n-                            ann.end_col + ann.label.as_ref().map(|l| l.len() + 1).unwrap_or(0),\n-                        );\n+                        // FIXME: account for labels not in the same line\n+                        let label_right = ann.label.as_ref().map(|l| l.len() + 1).unwrap_or(0);\n+                        label_right_margin = max(label_right_margin, ann.end_col + label_right);\n                     }\n                 }\n "}, {"sha": "b1ef6b95f25ce20337b50a0490b23a08be661dfb", "filename": "src/test/ui/terminal-width/non-whitespace-trimming-2.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/45a6be545891f4a8f19f0dce801b67fdccf435ee/src%2Ftest%2Fui%2Fterminal-width%2Fnon-whitespace-trimming-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/45a6be545891f4a8f19f0dce801b67fdccf435ee/src%2Ftest%2Fui%2Fterminal-width%2Fnon-whitespace-trimming-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fterminal-width%2Fnon-whitespace-trimming-2.rs?ref=45a6be545891f4a8f19f0dce801b67fdccf435ee", "patch": "@@ -1,4 +1,4 @@\n-// ignore-tidy-length \n+// ignore-tidy-linelength\n \n fn main() {\n     let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = 42; let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = ();"}, {"sha": "f6c8d345c652e89226f96b5c0bdc157679bebb44", "filename": "src/test/ui/terminal-width/non-whitespace-trimming.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/45a6be545891f4a8f19f0dce801b67fdccf435ee/src%2Ftest%2Fui%2Fterminal-width%2Fnon-whitespace-trimming.rs", "raw_url": "https://github.com/rust-lang/rust/raw/45a6be545891f4a8f19f0dce801b67fdccf435ee/src%2Ftest%2Fui%2Fterminal-width%2Fnon-whitespace-trimming.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fterminal-width%2Fnon-whitespace-trimming.rs?ref=45a6be545891f4a8f19f0dce801b67fdccf435ee", "patch": "@@ -1,4 +1,4 @@\n-// ignore-tidy-length \n+// ignore-tidy-linelength\n \n fn main() {\n     let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = 42; let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = (); let _: () = ();"}, {"sha": "c68f678aab3495a7dcc4cd6fc7f9c627a96326bf", "filename": "src/test/ui/terminal-width/whitespace-trimming-2.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/45a6be545891f4a8f19f0dce801b67fdccf435ee/src%2Ftest%2Fui%2Fterminal-width%2Fwhitespace-trimming-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/45a6be545891f4a8f19f0dce801b67fdccf435ee/src%2Ftest%2Fui%2Fterminal-width%2Fwhitespace-trimming-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fterminal-width%2Fwhitespace-trimming-2.rs?ref=45a6be545891f4a8f19f0dce801b67fdccf435ee", "patch": "@@ -1,4 +1,4 @@\n-// ignore-tidy-length \n+// ignore-tidy-linelength\n \n fn foo() -> usize {\n                                                                                                                                                                                           ()"}, {"sha": "f747bcf17e0b427992a72926029dba912cd0b181", "filename": "src/test/ui/terminal-width/whitespace-trimming.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/45a6be545891f4a8f19f0dce801b67fdccf435ee/src%2Ftest%2Fui%2Fterminal-width%2Fwhitespace-trimming.rs", "raw_url": "https://github.com/rust-lang/rust/raw/45a6be545891f4a8f19f0dce801b67fdccf435ee/src%2Ftest%2Fui%2Fterminal-width%2Fwhitespace-trimming.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fterminal-width%2Fwhitespace-trimming.rs?ref=45a6be545891f4a8f19f0dce801b67fdccf435ee", "patch": "@@ -1,4 +1,4 @@\n-// ignore-tidy-length \n+// ignore-tidy-linelength\n \n fn main() {\n                                                                                                                                                                                     let _: () = 42;"}]}