{"sha": "26ede3115fbaaab5aecf6ca32ab97cd0feb9f38b", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI2ZWRlMzExNWZiYWFhYjVhZWNmNmNhMzJhYjk3Y2QwZmViOWYzOGI=", "commit": {"author": {"name": "Philipp Krones", "email": "hello@philkrones.com", "date": "2020-07-13T13:59:45Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-07-13T13:59:45Z"}, "message": "Rollup merge of #5784 - matthiaskrgr:ice_5780, r=phansch\n\nFix out of bounds access by checking length equality BEFORE accessing by index.\n\nFixes #5780\n\nchangelog: fix out of bounds access in unnested_or_patterns lint.\n\nEdit: I did not bother reducing a testcase from `librustc_typeck` crate but I can confirm that with the change the crash no longer occurs.", "tree": {"sha": "b3e95076013e9d5c5bb44c997d9ed510e6c82925", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b3e95076013e9d5c5bb44c997d9ed510e6c82925"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/26ede3115fbaaab5aecf6ca32ab97cd0feb9f38b", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfDGjRCRBK7hj4Ov3rIwAAdHIIAING0jf33xhckZQa1IVD4qSP\n3VTLb4Lb8pco1Kf/PkCceZNyMH1tkrsmd9xARpfjCdx6RIlyI4j/IjDvm2muhxXk\n1eF+RJ4zg5n8NYZyW47iEf/rHhCElN760wt5A1Z7hB1yl82Xs9vlegqa6aS7JyF1\nkvFB57Hlk6WDWG10N6Mk3vklaYAUs+uiGSnFeNf9Xa4ywpIfLgmS05GMvQjPsfER\nMgiehdjV4N7jn9jSmlhSeboMGFXS1m9IfVx8j/rR6B7TZk61dborJsc0q4CtpdoA\nkgaPwcDtUXld0Z43PdKLJunbEg9FxCxFdPOpKk6pw9Z5NtQFVy8zU1XvzmZ/n3U=\n=IepN\n-----END PGP SIGNATURE-----\n", "payload": "tree b3e95076013e9d5c5bb44c997d9ed510e6c82925\nparent 32ef448bdb915f5ccb37daf7c32ad50b85c8ef0d\nparent 1b3bc16533a3e701616648920603c10674eb653b\nauthor Philipp Krones <hello@philkrones.com> 1594648785 +0200\ncommitter GitHub <noreply@github.com> 1594648785 +0200\n\nRollup merge of #5784 - matthiaskrgr:ice_5780, r=phansch\n\nFix out of bounds access by checking length equality BEFORE accessing by index.\n\nFixes #5780\n\nchangelog: fix out of bounds access in unnested_or_patterns lint.\n\nEdit: I did not bother reducing a testcase from `librustc_typeck` crate but I can confirm that with the change the crash no longer occurs.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/26ede3115fbaaab5aecf6ca32ab97cd0feb9f38b", "html_url": "https://github.com/rust-lang/rust/commit/26ede3115fbaaab5aecf6ca32ab97cd0feb9f38b", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/26ede3115fbaaab5aecf6ca32ab97cd0feb9f38b/comments", "author": {"login": "flip1995", "id": 9744647, "node_id": "MDQ6VXNlcjk3NDQ2NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/9744647?v=4", "gravatar_id": "", "url": "https://api.github.com/users/flip1995", "html_url": "https://github.com/flip1995", "followers_url": "https://api.github.com/users/flip1995/followers", "following_url": "https://api.github.com/users/flip1995/following{/other_user}", "gists_url": "https://api.github.com/users/flip1995/gists{/gist_id}", "starred_url": "https://api.github.com/users/flip1995/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/flip1995/subscriptions", "organizations_url": "https://api.github.com/users/flip1995/orgs", "repos_url": "https://api.github.com/users/flip1995/repos", "events_url": "https://api.github.com/users/flip1995/events{/privacy}", "received_events_url": "https://api.github.com/users/flip1995/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "32ef448bdb915f5ccb37daf7c32ad50b85c8ef0d", "url": "https://api.github.com/repos/rust-lang/rust/commits/32ef448bdb915f5ccb37daf7c32ad50b85c8ef0d", "html_url": "https://github.com/rust-lang/rust/commit/32ef448bdb915f5ccb37daf7c32ad50b85c8ef0d"}, {"sha": "1b3bc16533a3e701616648920603c10674eb653b", "url": "https://api.github.com/repos/rust-lang/rust/commits/1b3bc16533a3e701616648920603c10674eb653b", "html_url": "https://github.com/rust-lang/rust/commit/1b3bc16533a3e701616648920603c10674eb653b"}], "stats": {"total": 4, "additions": 2, "deletions": 2}, "files": [{"sha": "502bf0c427954b616a817d91512586ff1f968d68", "filename": "clippy_lints/src/unnested_or_patterns.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/26ede3115fbaaab5aecf6ca32ab97cd0feb9f38b/clippy_lints%2Fsrc%2Funnested_or_patterns.rs", "raw_url": "https://github.com/rust-lang/rust/raw/26ede3115fbaaab5aecf6ca32ab97cd0feb9f38b/clippy_lints%2Fsrc%2Funnested_or_patterns.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/clippy_lints%2Fsrc%2Funnested_or_patterns.rs?ref=26ede3115fbaaab5aecf6ca32ab97cd0feb9f38b", "patch": "@@ -400,8 +400,8 @@ fn extend_with_matching(\n \n /// Are the patterns in `ps1` and `ps2` equal save for `ps1[idx]` compared to `ps2[idx]`?\n fn eq_pre_post(ps1: &[P<Pat>], ps2: &[P<Pat>], idx: usize) -> bool {\n-    ps1[idx].is_rest() == ps2[idx].is_rest() // Avoid `[x, ..] | [x, 0]` => `[x, .. | 0]`.\n-        && ps1.len() == ps2.len()\n+    ps1.len() == ps2.len()\n+        && ps1[idx].is_rest() == ps2[idx].is_rest() // Avoid `[x, ..] | [x, 0]` => `[x, .. | 0]`.\n         && over(&ps1[..idx], &ps2[..idx], |l, r| eq_pat(l, r))\n         && over(&ps1[idx + 1..], &ps2[idx + 1..], |l, r| eq_pat(l, r))\n }"}]}