{"sha": "7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "node_id": "MDY6Q29tbWl0NzI0NzEyOjdlZDdmYzg4MWU3ZjRkYWJjZGM0NTY0NjI1N2RkYjk3OTgyMmQ3ZjQ=", "commit": {"author": {"name": "Ralf Jung", "email": "post@ralfj.de", "date": "2018-09-19T15:22:03Z"}, "committer": {"name": "Oliver Scherer", "email": "github35764891676564198441@oli-obk.de", "date": "2018-10-25T14:48:15Z"}, "message": "add the lint back to the list, and fix tests", "tree": {"sha": "6dfbb35ca07287347337a08208d6e6ea03f0cce3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6dfbb35ca07287347337a08208d6e6ea03f0cce3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "html_url": "https://github.com/rust-lang/rust/commit/7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/comments", "author": {"login": "RalfJung", "id": 330628, "node_id": "MDQ6VXNlcjMzMDYyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/330628?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RalfJung", "html_url": "https://github.com/RalfJung", "followers_url": "https://api.github.com/users/RalfJung/followers", "following_url": "https://api.github.com/users/RalfJung/following{/other_user}", "gists_url": "https://api.github.com/users/RalfJung/gists{/gist_id}", "starred_url": "https://api.github.com/users/RalfJung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RalfJung/subscriptions", "organizations_url": "https://api.github.com/users/RalfJung/orgs", "repos_url": "https://api.github.com/users/RalfJung/repos", "events_url": "https://api.github.com/users/RalfJung/events{/privacy}", "received_events_url": "https://api.github.com/users/RalfJung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "oli-obk", "id": 332036, "node_id": "MDQ6VXNlcjMzMjAzNg==", "avatar_url": "https://avatars.githubusercontent.com/u/332036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oli-obk", "html_url": "https://github.com/oli-obk", "followers_url": "https://api.github.com/users/oli-obk/followers", "following_url": "https://api.github.com/users/oli-obk/following{/other_user}", "gists_url": "https://api.github.com/users/oli-obk/gists{/gist_id}", "starred_url": "https://api.github.com/users/oli-obk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oli-obk/subscriptions", "organizations_url": "https://api.github.com/users/oli-obk/orgs", "repos_url": "https://api.github.com/users/oli-obk/repos", "events_url": "https://api.github.com/users/oli-obk/events{/privacy}", "received_events_url": "https://api.github.com/users/oli-obk/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "94586bc13326237c5aac566b1972dcd9b1b14000", "url": "https://api.github.com/repos/rust-lang/rust/commits/94586bc13326237c5aac566b1972dcd9b1b14000", "html_url": "https://github.com/rust-lang/rust/commit/94586bc13326237c5aac566b1972dcd9b1b14000"}], "stats": {"total": 370, "additions": 74, "deletions": 296}, "files": [{"sha": "c50f57e6c903dc58aad380c79b8e0611c5d608a7", "filename": "src/librustc_lint/builtin.rs", "status": "modified", "additions": 0, "deletions": 15, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Flibrustc_lint%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Flibrustc_lint%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Fbuiltin.rs?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -1607,17 +1607,6 @@ fn check_const(cx: &LateContext, body_id: hir::BodyId) {\n     let _ = cx.tcx.const_eval(param_env.and(cid));\n }\n \n-struct UnusedBrokenConstVisitor<'a, 'tcx: 'a>(&'a LateContext<'a, 'tcx>);\n-\n-impl<'a, 'tcx, 'v> hir::intravisit::Visitor<'v> for UnusedBrokenConstVisitor<'a, 'tcx> {\n-    fn visit_nested_body(&mut self, id: hir::BodyId) {\n-        check_const(self.0, id);\n-    }\n-    fn nested_visit_map<'this>(&'this mut self) -> hir::intravisit::NestedVisitorMap<'this, 'v> {\n-        hir::intravisit::NestedVisitorMap::None\n-    }\n-}\n-\n impl<'a, 'tcx> LateLintPass<'a, 'tcx> for UnusedBrokenConst {\n     fn check_item(&mut self, cx: &LateContext, it: &hir::Item) {\n         match it.node {\n@@ -1627,10 +1616,6 @@ impl<'a, 'tcx> LateLintPass<'a, 'tcx> for UnusedBrokenConst {\n             hir::ItemKind::Static(_, _, body_id) => {\n                 check_const(cx, body_id);\n             },\n-            hir::ItemKind::Ty(ref ty, _) => hir::intravisit::walk_ty(\n-                &mut UnusedBrokenConstVisitor(cx),\n-                ty\n-            ),\n             _ => {},\n         }\n     }"}, {"sha": "5bf2b76e66849b6a5346a8d1a089b0cfd98a7199", "filename": "src/librustc_lint/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Flibrustc_lint%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Flibrustc_lint%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Flib.rs?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -152,6 +152,7 @@ pub fn register_builtins(store: &mut lint::LintStore, sess: Option<&Session>) {\n         UnreachablePub: UnreachablePub,\n         UnnameableTestItems: UnnameableTestItems::new(),\n         TypeAliasBounds: TypeAliasBounds,\n+        UnusedBrokenConst: UnusedBrokenConst,\n         TrivialConstraints: TrivialConstraints,\n         TypeLimits: TypeLimits::new(),\n         MissingDoc: MissingDoc::new(),"}, {"sha": "e82458b10d97e4ce9e60d50fabc673fbfbd3a788", "filename": "src/test/ui/array_const_index-0.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Farray_const_index-0.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Farray_const_index-0.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Farray_const_index-0.rs?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -14,5 +14,5 @@ const B: i32 = (&A)[1];\n //~| ERROR any use of this value will cause an error\n \n fn main() {\n-    let _ = B; //~ ERROR erroneous constant used\n+    let _ = B;\n }"}, {"sha": "49c316eee12b2948d41ba40359fef868ee2d6685", "filename": "src/test/ui/array_const_index-0.stderr", "status": "modified", "additions": 1, "deletions": 8, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Farray_const_index-0.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Farray_const_index-0.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Farray_const_index-0.stderr?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -8,12 +8,5 @@ LL | const B: i32 = (&A)[1];\n    |\n    = note: #[deny(const_err)] on by default\n \n-error[E0080]: erroneous constant used\n-  --> $DIR/array_const_index-0.rs:17:13\n-   |\n-LL |     let _ = B; //~ ERROR erroneous constant used\n-   |             ^ referenced constant has errors\n-\n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0080`."}, {"sha": "21028a447f4e071a371d7bb397cb2380b157470d", "filename": "src/test/ui/array_const_index-1.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Farray_const_index-1.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Farray_const_index-1.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Farray_const_index-1.rs?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -14,5 +14,5 @@ const B: i32 = A[1];\n //~| ERROR any use of this value will cause an error\n \n fn main() {\n-    let _ = B; //~ ERROR erroneous constant used\n+    let _ = B;\n }"}, {"sha": "fa0e6e6afc6b0a0232208fc2c1f173f7aed9c9a6", "filename": "src/test/ui/array_const_index-1.stderr", "status": "modified", "additions": 1, "deletions": 8, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Farray_const_index-1.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Farray_const_index-1.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Farray_const_index-1.stderr?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -8,12 +8,5 @@ LL | const B: i32 = A[1];\n    |\n    = note: #[deny(const_err)] on by default\n \n-error[E0080]: erroneous constant used\n-  --> $DIR/array_const_index-1.rs:17:13\n-   |\n-LL |     let _ = B; //~ ERROR erroneous constant used\n-   |             ^ referenced constant has errors\n-\n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0080`."}, {"sha": "39b1b342eac3149752718d55ad5d48e24e3669c9", "filename": "src/test/ui/consts/const-err-early.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-err-early.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-err-early.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-err-early.rs?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -17,10 +17,10 @@ pub const D: u8 = 42u8 - (42u8 + 1); //~ ERROR const_err\n pub const E: u8 = [5u8][1]; //~ ERROR const_err\n \n fn main() {\n-    let _a = A; //~ ERROR erroneous constant used\n-    let _b = B; //~ ERROR erroneous constant used\n-    let _c = C; //~ ERROR erroneous constant used\n-    let _d = D; //~ ERROR erroneous constant used\n-    let _e = E; //~ ERROR erroneous constant used\n-    let _e = [6u8][1]; //~ ERROR index out of bounds\n+    let _a = A;\n+    let _b = B;\n+    let _c = C;\n+    let _d = D;\n+    let _e = E;\n+    let _e = [6u8][1];\n }"}, {"sha": "1dd6c096e3739b6c13cf4268d2826a8210813f2f", "filename": "src/test/ui/consts/const-err-early.stderr", "status": "modified", "additions": 1, "deletions": 38, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-err-early.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-err-early.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-err-early.stderr?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -44,42 +44,5 @@ LL | pub const E: u8 = [5u8][1]; //~ ERROR const_err\n    |                   |\n    |                   index out of bounds: the len is 1 but the index is 1\n \n-error[E0080]: erroneous constant used\n-  --> $DIR/const-err-early.rs:20:14\n-   |\n-LL |     let _a = A; //~ ERROR erroneous constant used\n-   |              ^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-err-early.rs:21:14\n-   |\n-LL |     let _b = B; //~ ERROR erroneous constant used\n-   |              ^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-err-early.rs:22:14\n-   |\n-LL |     let _c = C; //~ ERROR erroneous constant used\n-   |              ^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-err-early.rs:23:14\n-   |\n-LL |     let _d = D; //~ ERROR erroneous constant used\n-   |              ^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-err-early.rs:24:14\n-   |\n-LL |     let _e = E; //~ ERROR erroneous constant used\n-   |              ^ referenced constant has errors\n-\n-error: index out of bounds: the len is 1 but the index is 1\n-  --> $DIR/const-err-early.rs:25:14\n-   |\n-LL |     let _e = [6u8][1]; //~ ERROR index out of bounds\n-   |              ^^^^^^^^\n-\n-error: aborting due to 11 previous errors\n+error: aborting due to 5 previous errors\n \n-For more information about this error, try `rustc --explain E0080`."}, {"sha": "5cf3114c64a6b7daea0c229e741d656c59b72bd8", "filename": "src/test/ui/consts/const-err-multi.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-err-multi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-err-multi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-err-multi.rs?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -21,5 +21,4 @@ pub const D: i8 = 50 - A;\n \n fn main() {\n     let _ = (A, B, C, D);\n-    //~^ ERROR erroneous constant used\n }"}, {"sha": "e77a31a9f5fa0eaf35563322783b4bcd667e7ad0", "filename": "src/test/ui/consts/const-err-multi.stderr", "status": "modified", "additions": 1, "deletions": 8, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-err-multi.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-err-multi.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-err-multi.stderr?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -36,12 +36,5 @@ LL | pub const D: i8 = 50 - A;\n    |                   |\n    |                   referenced constant has errors\n \n-error[E0080]: erroneous constant used\n-  --> $DIR/const-err-multi.rs:23:13\n-   |\n-LL |     let _ = (A, B, C, D);\n-   |             ^^^^^^^^^^^^ referenced constant has errors\n-\n-error: aborting due to 5 previous errors\n+error: aborting due to 4 previous errors\n \n-For more information about this error, try `rustc --explain E0080`."}, {"sha": "8e094a7f7dcc77d1c21722d9585374f6c4652f6b", "filename": "src/test/ui/consts/const-eval/const-eval-overflow2.rs", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2.rs?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -60,15 +60,15 @@ const VALS_U64: (u64,) = //~ ERROR any use of this value will cause an error\n      );\n \n fn main() {\n-    foo(VALS_I8); //~ ERROR erroneous constant used\n-    foo(VALS_I16); //~ ERROR erroneous constant used\n-    foo(VALS_I32); //~ ERROR erroneous constant used\n-    foo(VALS_I64); //~ ERROR erroneous constant used\n+    foo(VALS_I8);\n+    foo(VALS_I16);\n+    foo(VALS_I32);\n+    foo(VALS_I64);\n \n-    foo(VALS_U8); //~ ERROR erroneous constant used\n-    foo(VALS_U16); //~ ERROR erroneous constant used\n-    foo(VALS_U32); //~ ERROR erroneous constant used\n-    foo(VALS_U64); //~ ERROR erroneous constant used\n+    foo(VALS_U8);\n+    foo(VALS_U16);\n+    foo(VALS_U32);\n+    foo(VALS_U64);\n }\n \n fn foo<T>(_: T) {"}, {"sha": "596ba6bb223f0c9c82e30319b075e24e8685b01d", "filename": "src/test/ui/consts/const-eval/const-eval-overflow2.stderr", "status": "modified", "additions": 1, "deletions": 50, "changes": 51, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2.stderr?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -82,54 +82,5 @@ LL | |      u64::MIN - 1,\n LL | |      );\n    | |_______^\n \n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2.rs:63:5\n-   |\n-LL |     foo(VALS_I8); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2.rs:64:5\n-   |\n-LL |     foo(VALS_I16); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2.rs:65:5\n-   |\n-LL |     foo(VALS_I32); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2.rs:66:5\n-   |\n-LL |     foo(VALS_I64); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2.rs:68:5\n-   |\n-LL |     foo(VALS_U8); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2.rs:69:5\n-   |\n-LL |     foo(VALS_U16); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2.rs:70:5\n-   |\n-LL |     foo(VALS_U32); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2.rs:71:5\n-   |\n-LL |     foo(VALS_U64); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error: aborting due to 16 previous errors\n+error: aborting due to 8 previous errors\n \n-For more information about this error, try `rustc --explain E0080`."}, {"sha": "c69d03071e756969702093b9de64abc7ad065dd0", "filename": "src/test/ui/consts/const-eval/const-eval-overflow2b.rs", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2b.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2b.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2b.rs?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -60,15 +60,15 @@ const VALS_U64: (u64,) = //~ ERROR any use of this value will cause an error\n      );\n \n fn main() {\n-    foo(VALS_I8); //~ ERROR erroneous constant used\n-    foo(VALS_I16); //~ ERROR erroneous constant used\n-    foo(VALS_I32); //~ ERROR erroneous constant used\n-    foo(VALS_I64); //~ ERROR erroneous constant used\n+    foo(VALS_I8);\n+    foo(VALS_I16);\n+    foo(VALS_I32);\n+    foo(VALS_I64);\n \n-    foo(VALS_U8); //~ ERROR erroneous constant used\n-    foo(VALS_U16); //~ ERROR erroneous constant used\n-    foo(VALS_U32); //~ ERROR erroneous constant used\n-    foo(VALS_U64); //~ ERROR erroneous constant used\n+    foo(VALS_U8);\n+    foo(VALS_U16);\n+    foo(VALS_U32);\n+    foo(VALS_U64);\n }\n \n fn foo<T>(_: T) {"}, {"sha": "82f245eaee86654f068082e9a6ed86695b4e32c6", "filename": "src/test/ui/consts/const-eval/const-eval-overflow2b.stderr", "status": "modified", "additions": 1, "deletions": 50, "changes": 51, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2b.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2b.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2b.stderr?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -82,54 +82,5 @@ LL | |      u64::MAX + 1,\n LL | |      );\n    | |_______^\n \n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2b.rs:63:5\n-   |\n-LL |     foo(VALS_I8); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2b.rs:64:5\n-   |\n-LL |     foo(VALS_I16); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2b.rs:65:5\n-   |\n-LL |     foo(VALS_I32); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2b.rs:66:5\n-   |\n-LL |     foo(VALS_I64); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2b.rs:68:5\n-   |\n-LL |     foo(VALS_U8); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2b.rs:69:5\n-   |\n-LL |     foo(VALS_U16); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2b.rs:70:5\n-   |\n-LL |     foo(VALS_U32); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2b.rs:71:5\n-   |\n-LL |     foo(VALS_U64); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error: aborting due to 16 previous errors\n+error: aborting due to 8 previous errors\n \n-For more information about this error, try `rustc --explain E0080`."}, {"sha": "f442661ec630b78dc02694b48c070f34623eecc5", "filename": "src/test/ui/consts/const-eval/const-eval-overflow2c.rs", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2c.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2c.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2c.rs?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -60,15 +60,15 @@ const VALS_U64: (u64,) = //~ ERROR any use of this value will cause an error\n      );\n \n fn main() {\n-    foo(VALS_I8); //~ ERROR erroneous constant used\n-    foo(VALS_I16); //~ ERROR erroneous constant used\n-    foo(VALS_I32); //~ ERROR erroneous constant used\n-    foo(VALS_I64); //~ ERROR erroneous constant used\n+    foo(VALS_I8);\n+    foo(VALS_I16);\n+    foo(VALS_I32);\n+    foo(VALS_I64);\n \n-    foo(VALS_U8); //~ ERROR erroneous constant used\n-    foo(VALS_U16); //~ ERROR erroneous constant used\n-    foo(VALS_U32); //~ ERROR erroneous constant used\n-    foo(VALS_U64); //~ ERROR erroneous constant used\n+    foo(VALS_U8);\n+    foo(VALS_U16);\n+    foo(VALS_U32);\n+    foo(VALS_U64);\n }\n \n fn foo<T>(_: T) {"}, {"sha": "91064eb867d868523e4c3c5dd9c721cefec77e34", "filename": "src/test/ui/consts/const-eval/const-eval-overflow2c.stderr", "status": "modified", "additions": 1, "deletions": 50, "changes": 51, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2c.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2c.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fconst-eval-overflow2c.stderr?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -82,54 +82,5 @@ LL | |      u64::MAX * 2,\n LL | |      );\n    | |_______^\n \n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2c.rs:63:5\n-   |\n-LL |     foo(VALS_I8); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2c.rs:64:5\n-   |\n-LL |     foo(VALS_I16); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2c.rs:65:5\n-   |\n-LL |     foo(VALS_I32); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2c.rs:66:5\n-   |\n-LL |     foo(VALS_I64); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2c.rs:68:5\n-   |\n-LL |     foo(VALS_U8); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2c.rs:69:5\n-   |\n-LL |     foo(VALS_U16); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2c.rs:70:5\n-   |\n-LL |     foo(VALS_U32); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error[E0080]: erroneous constant used\n-  --> $DIR/const-eval-overflow2c.rs:71:5\n-   |\n-LL |     foo(VALS_U64); //~ ERROR erroneous constant used\n-   |     ^^^^^^^^^^^^^ referenced constant has errors\n-\n-error: aborting due to 16 previous errors\n+error: aborting due to 8 previous errors\n \n-For more information about this error, try `rustc --explain E0080`."}, {"sha": "41cf844a8e299234842e27d85902a267d383699a", "filename": "src/test/ui/consts/const-eval/pub_const_err.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fpub_const_err.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fpub_const_err.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fpub_const_err.rs?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -17,5 +17,3 @@ pub const Z: u32 = 0 - 1;\n //~^ WARN any use of this value will cause an error\n \n pub type Foo = [i32; 0 - 1];\n-//~^ WARN attempt to subtract with overflow\n-//~| WARN this array length cannot be used"}, {"sha": "0ee7d603e31ad1a10d2850b8f38141ae9d831370", "filename": "src/test/ui/consts/const-eval/pub_const_err_bin.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fpub_const_err_bin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fpub_const_err_bin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Fpub_const_err_bin.rs?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -15,7 +15,5 @@ pub const Z: u32 = 0 - 1;\n //~^ WARN any use of this value will cause an error\n \n pub type Foo = [i32; 0 - 1];\n-//~^ WARN attempt to subtract with overflow\n-//~| WARN this array length cannot be used\n \n fn main() {}"}, {"sha": "c0bfbc17629fc3cfcb0f6a665e0c7078446b26a2", "filename": "src/test/ui/consts/const-eval/union-const-eval-field.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Funion-const-eval-field.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Funion-const-eval-field.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Funion-const-eval-field.rs?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -36,12 +36,10 @@ const fn read_field2() -> Field2 {\n const fn read_field3() -> Field3 {\n     const FIELD3: Field3 = unsafe { UNION.field3 }; //~ ERROR any use of this value\n     FIELD3\n-    //~^ erroneous constant used\n }\n \n fn main() {\n     assert_eq!(read_field1(), FLOAT1_AS_I32);\n     assert_eq!(read_field2(), 1.0);\n     assert_eq!(read_field3(), unsafe { UNION.field3 });\n-    //~^ ERROR evaluation of constant expression failed\n }"}, {"sha": "565cd916ffcb110244724ffd24d96b31e5dbd1e0", "filename": "src/test/ui/consts/const-eval/union-const-eval-field.stderr", "status": "modified", "additions": 1, "deletions": 21, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Funion-const-eval-field.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Funion-const-eval-field.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Funion-const-eval-field.stderr?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -6,25 +6,5 @@ LL |     const FIELD3: Field3 = unsafe { UNION.field3 }; //~ ERROR any use of th\n    |\n    = note: #[deny(const_err)] on by default\n \n-error[E0080]: erroneous constant used\n-  --> $DIR/union-const-eval-field.rs:38:5\n-   |\n-LL |     FIELD3\n-   |     ^^^^^^ referenced constant has errors\n-\n-error[E0080]: evaluation of constant expression failed\n-  --> $DIR/union-const-eval-field.rs:45:5\n-   |\n-LL |     FIELD3\n-   |     ------ referenced constant has errors\n-...\n-LL |     assert_eq!(read_field3(), unsafe { UNION.field3 });\n-   |     ^^^^^^^^^^^-------------^^^^^^^^^^^^^^^^^^^^^^^^^^^\n-   |                |\n-   |                inside call to `read_field3`\n-   |\n-   = note: this error originates in a macro outside of the current crate (in Nightly builds, run with -Z external-macro-backtrace for more info)\n-\n-error: aborting due to 3 previous errors\n+error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0080`."}, {"sha": "53ce82f8e87b6eab232a866c13ff31cc08150acb", "filename": "src/test/ui/consts/const-eval/unused-broken-const.rs", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Funused-broken-const.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Funused-broken-const.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Funused-broken-const.rs?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -0,0 +1,18 @@\n+// Copyright 2018 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// make sure that an *unused* broken const triggers an error even in a check build\n+\n+// compile-flags: --emit=dep-info,metadata\n+\n+const FOO: i32 = [][0];\n+//~^ ERROR any use of this value will cause an error\n+\n+fn main() {}"}, {"sha": "5fb2a3722e20f5eaae3d92f80e2ce24d1f7f539a", "filename": "src/test/ui/consts/const-eval/unused-broken-const.stderr", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Funused-broken-const.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Funused-broken-const.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-eval%2Funused-broken-const.stderr?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -0,0 +1,14 @@\n+warning: due to multiple output types requested, the explicitly specified output file name will be adapted for each output type\n+\n+error: any use of this value will cause an error\n+  --> $DIR/unused-broken-const.rs:15:1\n+   |\n+LL | const FOO: i32 = [][0];\n+   | ^^^^^^^^^^^^^^^^^-----^\n+   |                  |\n+   |                  index out of bounds: the len is 0 but the index is 0\n+   |\n+   = note: #[deny(const_err)] on by default\n+\n+error: aborting due to previous error\n+"}, {"sha": "04d9b01633b15f15fe3130e219177cb75fbcab96", "filename": "src/test/ui/consts/const-slice-oob.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-slice-oob.rs", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-slice-oob.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-slice-oob.rs?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -17,5 +17,4 @@ const BAR: u32 = FOO[5];\n \n fn main() {\n     let _ = BAR;\n-    //~^ ERROR erroneous constant used\n }"}, {"sha": "4a8ad5ed6ca77083d64a5b1aefdf11df4a195bcf", "filename": "src/test/ui/consts/const-slice-oob.stderr", "status": "modified", "additions": 1, "deletions": 8, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-slice-oob.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/7ed7fc881e7f4dabcdc45646257ddb979822d7f4/src%2Ftest%2Fui%2Fconsts%2Fconst-slice-oob.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-slice-oob.stderr?ref=7ed7fc881e7f4dabcdc45646257ddb979822d7f4", "patch": "@@ -8,12 +8,5 @@ LL | const BAR: u32 = FOO[5];\n    |\n    = note: #[deny(const_err)] on by default\n \n-error[E0080]: erroneous constant used\n-  --> $DIR/const-slice-oob.rs:19:13\n-   |\n-LL |     let _ = BAR;\n-   |             ^^^ referenced constant has errors\n-\n-error: aborting due to 2 previous errors\n+error: aborting due to previous error\n \n-For more information about this error, try `rustc --explain E0080`."}]}