{"sha": "4c5ca44b92691424b9a624e08b9588eaa2bfde25", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRjNWNhNDRiOTI2OTE0MjRiOWE2MjRlMDhiOTU4OGVhYTJiZmRlMjU=", "commit": {"author": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2020-02-03T18:32:54Z"}, "committer": {"name": "Dylan MacKenzie", "email": "ecstaticmorse@gmail.com", "date": "2020-02-03T18:32:54Z"}, "message": "Pass correct closure type to `Qualif` methods", "tree": {"sha": "fc0343e81bbcea44886970eae4a97fa1ebf1fb40", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fc0343e81bbcea44886970eae4a97fa1ebf1fb40"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4c5ca44b92691424b9a624e08b9588eaa2bfde25", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4c5ca44b92691424b9a624e08b9588eaa2bfde25", "html_url": "https://github.com/rust-lang/rust/commit/4c5ca44b92691424b9a624e08b9588eaa2bfde25", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4c5ca44b92691424b9a624e08b9588eaa2bfde25/comments", "author": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ecstatic-morse", "id": 29463364, "node_id": "MDQ6VXNlcjI5NDYzMzY0", "avatar_url": "https://avatars.githubusercontent.com/u/29463364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecstatic-morse", "html_url": "https://github.com/ecstatic-morse", "followers_url": "https://api.github.com/users/ecstatic-morse/followers", "following_url": "https://api.github.com/users/ecstatic-morse/following{/other_user}", "gists_url": "https://api.github.com/users/ecstatic-morse/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecstatic-morse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecstatic-morse/subscriptions", "organizations_url": "https://api.github.com/users/ecstatic-morse/orgs", "repos_url": "https://api.github.com/users/ecstatic-morse/repos", "events_url": "https://api.github.com/users/ecstatic-morse/events{/privacy}", "received_events_url": "https://api.github.com/users/ecstatic-morse/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "49ef3dac69767d322a30331712b0ce578e611abd", "url": "https://api.github.com/repos/rust-lang/rust/commits/49ef3dac69767d322a30331712b0ce578e611abd", "html_url": "https://github.com/rust-lang/rust/commit/49ef3dac69767d322a30331712b0ce578e611abd"}], "stats": {"total": 16, "additions": 11, "deletions": 5}, "files": [{"sha": "b804dc4b5b6786ed9fa628539d5095143f2ac446", "filename": "src/librustc_mir/transform/check_consts/resolver.rs", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/4c5ca44b92691424b9a624e08b9588eaa2bfde25/src%2Flibrustc_mir%2Ftransform%2Fcheck_consts%2Fresolver.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4c5ca44b92691424b9a624e08b9588eaa2bfde25/src%2Flibrustc_mir%2Ftransform%2Fcheck_consts%2Fresolver.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Ftransform%2Fcheck_consts%2Fresolver.rs?ref=4c5ca44b92691424b9a624e08b9588eaa2bfde25", "patch": "@@ -71,8 +71,13 @@ where\n         return_place: &mir::Place<'tcx>,\n     ) {\n         let return_ty = return_place.ty(*self.item.body, self.item.tcx).ty;\n-        let qualif =\n-            Q::in_call(self.item, &|l| self.qualifs_per_local.contains(l), func, args, return_ty);\n+        let qualif = Q::in_call(\n+            self.item,\n+            &mut |l| self.qualifs_per_local.contains(l),\n+            func,\n+            args,\n+            return_ty,\n+        );\n         if !return_place.is_indirect() {\n             self.assign_qualif_direct(return_place, qualif);\n         }\n@@ -105,7 +110,7 @@ where\n         rvalue: &mir::Rvalue<'tcx>,\n         location: Location,\n     ) {\n-        let qualif = Q::in_rvalue(self.item, &|l| self.qualifs_per_local.contains(l), rvalue);\n+        let qualif = Q::in_rvalue(self.item, &mut |l| self.qualifs_per_local.contains(l), rvalue);\n         if !place.is_indirect() {\n             self.assign_qualif_direct(place, qualif);\n         }\n@@ -120,7 +125,8 @@ where\n         // here; that occurs in `apply_call_return_effect`.\n \n         if let mir::TerminatorKind::DropAndReplace { value, location: dest, .. } = kind {\n-            let qualif = Q::in_operand(self.item, &|l| self.qualifs_per_local.contains(l), value);\n+            let qualif =\n+                Q::in_operand(self.item, &mut |l| self.qualifs_per_local.contains(l), value);\n             if !dest.is_indirect() {\n                 self.assign_qualif_direct(dest, qualif);\n             }"}, {"sha": "9a7f3f86a6fcdf1b87792a2ab2b784f5fda272e6", "filename": "src/librustc_mir/transform/promote_consts.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4c5ca44b92691424b9a624e08b9588eaa2bfde25/src%2Flibrustc_mir%2Ftransform%2Fpromote_consts.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4c5ca44b92691424b9a624e08b9588eaa2bfde25/src%2Flibrustc_mir%2Ftransform%2Fpromote_consts.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2Ftransform%2Fpromote_consts.rs?ref=4c5ca44b92691424b9a624e08b9588eaa2bfde25", "patch": "@@ -407,7 +407,7 @@ impl<'tcx> Validator<'_, 'tcx> {\n \n     // FIXME(eddyb) maybe cache this?\n     fn qualif_local<Q: qualifs::Qualif>(&self, local: Local) -> bool {\n-        let per_local = &|l| self.qualif_local::<Q>(l);\n+        let per_local = &mut |l| self.qualif_local::<Q>(l);\n \n         if let TempState::Defined { location: loc, .. } = self.temps[local] {\n             let num_stmts = self.body[loc.block].statements.len();"}]}