{"sha": "662ab0cd8eb6784e764903325da30418a2095307", "node_id": "C_kwDOAAsO6NoAKDY2MmFiMGNkOGViNjc4NGU3NjQ5MDMzMjVkYTMwNDE4YTIwOTUzMDc", "commit": {"author": {"name": "Ryo Yoshida", "email": "low.ryoshida@gmail.com", "date": "2022-08-30T18:43:28Z"}, "committer": {"name": "Ryo Yoshida", "email": "low.ryoshida@gmail.com", "date": "2022-08-30T18:51:37Z"}, "message": "fix: unescape all occurrences of module name in module resolution", "tree": {"sha": "e15012d9a79213d7f359943ff2fba86d5eaf7c8b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/e15012d9a79213d7f359943ff2fba86d5eaf7c8b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/662ab0cd8eb6784e764903325da30418a2095307", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEkSbsQIURluxz4rzf4laYqTBYYXEFAmMOXMEACgkQ4laYqTBY\nYXHGiBAAtJr8Va66GYoTPqJVpTTqKfYw/1S0aLLwkuKJqSMdwUEmrbx1r1n7jt6F\nOzi2HG+qpI8I4xkxtwgUA4E8ZxvKx4IjFWik/1IEF9yQHGtNPxXNiJij3iKwdRtm\nF7bryWlR4PY6ZNlPZVypwpbZ7I2x/mIIU8f3kwYc1rvqMAYI/SRIDs852ff+vrl1\nDf2fiDHny3HO6fbfQH0JQeZ7i3cInZ/ApmnPw9tLPRjjZPC5fcg5PrJCevGc8AFF\nHCv6m1KTmq63pxW/t+x1pgaG2w1zMQuxkzPUI/4DsQ4LzR5yHaHcEQu3F1Hh6LoG\nQ0CWAxUlrELTo0H6r7Aa213yIY6Rj1rYCNe6q41W7C4TUZ38gvdcbjBkpohB4LKV\nb+0ZNyG6cLTDiRaDIh0l3MFll6rbsdEGgfq2kRRtoicsyTqoU0gCK2ApbeoUFDUs\nK7qI9PVUT1nhEuSl4wphsnBPv47ZVDsAHHokjmk1AXrpG85Ib35fPQU4CCFdK9IP\n4nLCWkRrwflM5MImQ5flk7z5O5+PQkfZyeyRTwtw+swInoHx1+GE4jfWIFGwLpm0\nzhHsF1KjTxvr+6kR7Tuc+BXaY4y6namDNSPlolHtmXLbyDcXEQMp6DME2dRVUdNM\nEXJQJoZ2dYH5l9jwyotd61yfPh3dTUzNYuqrbSBodsARZPg0BTo=\n=wuyD\n-----END PGP SIGNATURE-----", "payload": "tree e15012d9a79213d7f359943ff2fba86d5eaf7c8b\nparent f02cd0a41d7381b1ef454b0141adacc188d3eee8\nauthor Ryo Yoshida <low.ryoshida@gmail.com> 1661885008 +0900\ncommitter Ryo Yoshida <low.ryoshida@gmail.com> 1661885497 +0900\n\nfix: unescape all occurrences of module name in module resolution\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/662ab0cd8eb6784e764903325da30418a2095307", "html_url": "https://github.com/rust-lang/rust/commit/662ab0cd8eb6784e764903325da30418a2095307", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/662ab0cd8eb6784e764903325da30418a2095307/comments", "author": {"login": "lowr", "id": 24381114, "node_id": "MDQ6VXNlcjI0MzgxMTE0", "avatar_url": "https://avatars.githubusercontent.com/u/24381114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lowr", "html_url": "https://github.com/lowr", "followers_url": "https://api.github.com/users/lowr/followers", "following_url": "https://api.github.com/users/lowr/following{/other_user}", "gists_url": "https://api.github.com/users/lowr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lowr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lowr/subscriptions", "organizations_url": "https://api.github.com/users/lowr/orgs", "repos_url": "https://api.github.com/users/lowr/repos", "events_url": "https://api.github.com/users/lowr/events{/privacy}", "received_events_url": "https://api.github.com/users/lowr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lowr", "id": 24381114, "node_id": "MDQ6VXNlcjI0MzgxMTE0", "avatar_url": "https://avatars.githubusercontent.com/u/24381114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lowr", "html_url": "https://github.com/lowr", "followers_url": "https://api.github.com/users/lowr/followers", "following_url": "https://api.github.com/users/lowr/following{/other_user}", "gists_url": "https://api.github.com/users/lowr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lowr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lowr/subscriptions", "organizations_url": "https://api.github.com/users/lowr/orgs", "repos_url": "https://api.github.com/users/lowr/repos", "events_url": "https://api.github.com/users/lowr/events{/privacy}", "received_events_url": "https://api.github.com/users/lowr/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f02cd0a41d7381b1ef454b0141adacc188d3eee8", "url": "https://api.github.com/repos/rust-lang/rust/commits/f02cd0a41d7381b1ef454b0141adacc188d3eee8", "html_url": "https://github.com/rust-lang/rust/commit/f02cd0a41d7381b1ef454b0141adacc188d3eee8"}], "stats": {"total": 19, "additions": 17, "deletions": 2}, "files": [{"sha": "ca7bcc814e8f8e41e4ced5c765e48f22af51a505", "filename": "crates/hir-def/src/nameres/mod_resolution.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/662ab0cd8eb6784e764903325da30418a2095307/crates%2Fhir-def%2Fsrc%2Fnameres%2Fmod_resolution.rs", "raw_url": "https://github.com/rust-lang/rust/raw/662ab0cd8eb6784e764903325da30418a2095307/crates%2Fhir-def%2Fsrc%2Fnameres%2Fmod_resolution.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir-def%2Fsrc%2Fnameres%2Fmod_resolution.rs?ref=662ab0cd8eb6784e764903325da30418a2095307", "patch": "@@ -65,6 +65,7 @@ impl ModDir {\n         name: &Name,\n         attr_path: Option<&SmolStr>,\n     ) -> Result<(FileId, bool, ModDir), Box<[String]>> {\n+        let name = name.unescaped();\n         let orig_file_id = file_id.original_file(db.upcast());\n \n         let mut candidate_files = ArrayVec::<_, 2>::new();\n@@ -73,12 +74,10 @@ impl ModDir {\n                 candidate_files.push(self.dir_path.join_attr(attr_path, self.root_non_dir_owner))\n             }\n             None if file_id.is_include_macro(db.upcast()) => {\n-                let name = name.unescaped();\n                 candidate_files.push(format!(\"{}.rs\", name));\n                 candidate_files.push(format!(\"{}/mod.rs\", name));\n             }\n             None => {\n-                let name = name.unescaped();\n                 candidate_files.push(format!(\"{}{}.rs\", self.dir_path.0, name));\n                 candidate_files.push(format!(\"{}{}/mod.rs\", self.dir_path.0, name));\n             }"}, {"sha": "ba3bf8b5a5cfa54075da94a07765c26f98fb2a7b", "filename": "crates/hir-def/src/nameres/tests/mod_resolution.rs", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/662ab0cd8eb6784e764903325da30418a2095307/crates%2Fhir-def%2Fsrc%2Fnameres%2Ftests%2Fmod_resolution.rs", "raw_url": "https://github.com/rust-lang/rust/raw/662ab0cd8eb6784e764903325da30418a2095307/crates%2Fhir-def%2Fsrc%2Fnameres%2Ftests%2Fmod_resolution.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir-def%2Fsrc%2Fnameres%2Ftests%2Fmod_resolution.rs?ref=662ab0cd8eb6784e764903325da30418a2095307", "patch": "@@ -127,7 +127,15 @@ mod r#async;\n use self::r#async::Bar;\n \n //- /async.rs\n+mod foo;\n+mod r#async;\n pub struct Bar;\n+\n+//- /async/foo.rs\n+pub struct Foo;\n+\n+//- /async/async.rs\n+pub struct Baz;\n \"#,\n         expect![[r#\"\n             crate\n@@ -136,6 +144,14 @@ pub struct Bar;\n \n             crate::r#async\n             Bar: t v\n+            foo: t\n+            r#async: t\n+\n+            crate::r#async::foo\n+            Foo: t v\n+\n+            crate::r#async::r#async\n+            Baz: t v\n         \"#]],\n     );\n }"}]}