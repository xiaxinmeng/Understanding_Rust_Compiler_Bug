{"sha": "24bc544db4238a8248be7d6e7eae893cf945f1f2", "node_id": "MDY6Q29tbWl0NzI0NzEyOjI0YmM1NDRkYjQyMzhhODI0OGJlN2Q2ZTdlYWU4OTNjZjk0NWYxZjI=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2018-08-22T06:54:22Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2018-08-22T06:54:22Z"}, "message": "Auto merge of #53509 - petrochenkov:wildregr, r=alexcrichton\n\nresolve: Reject some inaccessible candidates sooner during import resolution\n\nThis allows import resolution to progress in cases like #53140\n\nFixes #53140", "tree": {"sha": "437f9ffdb29d68e050a1dfc6853c9e1ceaf27cd6", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/437f9ffdb29d68e050a1dfc6853c9e1ceaf27cd6"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/24bc544db4238a8248be7d6e7eae893cf945f1f2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/24bc544db4238a8248be7d6e7eae893cf945f1f2", "html_url": "https://github.com/rust-lang/rust/commit/24bc544db4238a8248be7d6e7eae893cf945f1f2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/24bc544db4238a8248be7d6e7eae893cf945f1f2/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "786ccc336dc684cdb00402e84abe4a9bc53857cf", "url": "https://api.github.com/repos/rust-lang/rust/commits/786ccc336dc684cdb00402e84abe4a9bc53857cf", "html_url": "https://github.com/rust-lang/rust/commit/786ccc336dc684cdb00402e84abe4a9bc53857cf"}, {"sha": "7b47fd793fba4e0ce6c7fb4e50652bae0ff95fc0", "url": "https://api.github.com/repos/rust-lang/rust/commits/7b47fd793fba4e0ce6c7fb4e50652bae0ff95fc0", "html_url": "https://github.com/rust-lang/rust/commit/7b47fd793fba4e0ce6c7fb4e50652bae0ff95fc0"}], "stats": {"total": 26, "additions": 26, "deletions": 0}, "files": [{"sha": "87e30be7caaaf9118401739de46c37d0ab2efaf7", "filename": "src/librustc_resolve/resolve_imports.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/24bc544db4238a8248be7d6e7eae893cf945f1f2/src%2Flibrustc_resolve%2Fresolve_imports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/24bc544db4238a8248be7d6e7eae893cf945f1f2/src%2Flibrustc_resolve%2Fresolve_imports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Fresolve_imports.rs?ref=24bc544db4238a8248be7d6e7eae893cf945f1f2", "patch": "@@ -296,6 +296,8 @@ impl<'a, 'crateloader> Resolver<'a, 'crateloader> {\n             };\n             match self.resolve_ident_in_module(module, ident, ns, false, path_span) {\n                 Err(Determined) => continue,\n+                Ok(binding)\n+                    if !self.is_accessible_from(binding.vis, single_import.parent) => continue,\n                 Ok(_) | Err(Undetermined) => return Err(Undetermined),\n             }\n         }\n@@ -365,8 +367,11 @@ impl<'a, 'crateloader> Resolver<'a, 'crateloader> {\n                 path_span,\n             );\n             self.current_module = orig_current_module;\n+\n             match result {\n                 Err(Determined) => continue,\n+                Ok(binding)\n+                    if !self.is_accessible_from(binding.vis, glob_import.parent) => continue,\n                 Ok(_) | Err(Undetermined) => return Err(Undetermined),\n             }\n         }"}, {"sha": "dcfa054f2513f1e04748dde8e0dfccd2a739fd28", "filename": "src/test/ui/imports/issue-53140.rs", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/24bc544db4238a8248be7d6e7eae893cf945f1f2/src%2Ftest%2Fui%2Fimports%2Fissue-53140.rs", "raw_url": "https://github.com/rust-lang/rust/raw/24bc544db4238a8248be7d6e7eae893cf945f1f2/src%2Ftest%2Fui%2Fimports%2Fissue-53140.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fimports%2Fissue-53140.rs?ref=24bc544db4238a8248be7d6e7eae893cf945f1f2", "patch": "@@ -0,0 +1,21 @@\n+// Copyright 2018 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// compile-pass\n+\n+mod m {\n+    pub struct S(u8);\n+\n+    use S as Z;\n+}\n+\n+use m::*;\n+\n+fn main() {}"}]}