{"sha": "ff0278bc152c5e3072434615cf9861e98a160e71", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZmMDI3OGJjMTUyYzVlMzA3MjQzNDYxNWNmOTg2MWU5OGExNjBlNzE=", "commit": {"author": {"name": "Huon Wilson", "email": "dbau.pp+github@gmail.com", "date": "2014-11-19T02:11:24Z"}, "committer": {"name": "Huon Wilson", "email": "dbau.pp+github@gmail.com", "date": "2014-11-19T02:12:05Z"}, "message": "Update makefiles to ensure src/grammar/verify.rs is built.\n\nIt's not run, but this ensures that the code at least doesn't go out of\ndate.", "tree": {"sha": "14b66e24cae4ca708a760947c374a2bfb6ad7a7e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/14b66e24cae4ca708a760947c374a2bfb6ad7a7e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ff0278bc152c5e3072434615cf9861e98a160e71", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ff0278bc152c5e3072434615cf9861e98a160e71", "html_url": "https://github.com/rust-lang/rust/commit/ff0278bc152c5e3072434615cf9861e98a160e71", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ff0278bc152c5e3072434615cf9861e98a160e71/comments", "author": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "huonw", "id": 1203825, "node_id": "MDQ6VXNlcjEyMDM4MjU=", "avatar_url": "https://avatars.githubusercontent.com/u/1203825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huonw", "html_url": "https://github.com/huonw", "followers_url": "https://api.github.com/users/huonw/followers", "following_url": "https://api.github.com/users/huonw/following{/other_user}", "gists_url": "https://api.github.com/users/huonw/gists{/gist_id}", "starred_url": "https://api.github.com/users/huonw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huonw/subscriptions", "organizations_url": "https://api.github.com/users/huonw/orgs", "repos_url": "https://api.github.com/users/huonw/repos", "events_url": "https://api.github.com/users/huonw/events{/privacy}", "received_events_url": "https://api.github.com/users/huonw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9d20a46799178df9d2fb28dfec95ba55cbfb7f9c", "url": "https://api.github.com/repos/rust-lang/rust/commits/9d20a46799178df9d2fb28dfec95ba55cbfb7f9c", "html_url": "https://github.com/rust-lang/rust/commit/9d20a46799178df9d2fb28dfec95ba55cbfb7f9c"}], "stats": {"total": 18, "additions": 13, "deletions": 5}, "files": [{"sha": "a9f45907b8110b50716f02bbe0ebefd43fcb00b5", "filename": "mk/grammar.mk", "status": "modified", "additions": 12, "deletions": 4, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/ff0278bc152c5e3072434615cf9861e98a160e71/mk%2Fgrammar.mk", "raw_url": "https://github.com/rust-lang/rust/raw/ff0278bc152c5e3072434615cf9861e98a160e71/mk%2Fgrammar.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fgrammar.mk?ref=ff0278bc152c5e3072434615cf9861e98a160e71", "patch": "@@ -30,17 +30,25 @@ endef\n $(BG):\n \t$(Q)mkdir -p $(BG)\n \n-$(BG)RustLexer.class: $(SG)RustLexer.g4\n+$(BG)RustLexer.class: $(BG) $(SG)RustLexer.g4\n \t$(Q)$(CFG_ANTLR4) -o $(B)grammar $(SG)RustLexer.g4\n \t$(Q)$(CFG_JAVAC) -d $(BG) $(BG)RustLexer.java\n \n-$(BG)verify: $(SG)verify.rs rustc-stage2-H-$(CFG_BUILD) $(LD)stamp.regex_macros $(LD)stamp.rustc\n-\t$(Q)$(RUSTC) -O --out-dir $(BG) -L $(L) $(SG)verify.rs\n+check-build-lexer-verifier: $(BG)verify\n+\n+ifeq ($(NO_REBUILD),)\n+VERIFY_DEPS :=  rustc-stage2-H-$(CFG_BUILD) $(LD)stamp.regex_macros $(LD)stamp.rustc\n+else\n+VERIFY_DEPS :=\n+endif\n+\n+$(BG)verify: $(BG) $(SG)verify.rs $(VERIFY_DEPS)\n+\t$(Q)$(RUSTC) --out-dir $(BG) -L $(L) $(SG)verify.rs\n \n ifdef CFG_JAVAC\n ifdef CFG_ANTLR4\n ifdef CFG_GRUN\n-check-lexer: $(BG) $(BG)RustLexer.class $(BG)verify\n+check-lexer: $(BG) $(BG)RustLexer.class check-build-lexer-verifier\n \t$(info Verifying libsyntax against the reference lexer ...)\n \t$(Q)$(SG)check.sh $(S) \"$(BG)\" \\\n \t\t\"$(CFG_GRUN)\" \"$(BG)verify\" \"$(BG)RustLexer.tokens\""}, {"sha": "63a34e0f01007a4376058bf7c4b66940c2016e9c", "filename": "mk/tests.mk", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/ff0278bc152c5e3072434615cf9861e98a160e71/mk%2Ftests.mk", "raw_url": "https://github.com/rust-lang/rust/raw/ff0278bc152c5e3072434615cf9861e98a160e71/mk%2Ftests.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Ftests.mk?ref=ff0278bc152c5e3072434615cf9861e98a160e71", "patch": "@@ -199,7 +199,7 @@ check-docs: cleantestlibs cleantmptestlogs check-stage2-docs\n \n # Some less critical tests that are not prone to breakage.\n # Not run as part of the normal test suite, but tested by bors on checkin.\n-check-secondary: check-build-compiletest check-lexer check-pretty\n+check-secondary: check-build-compiletest check-build-lexer-verifier check-lexer check-pretty\n \n # check + check-secondary.\n #"}]}