{"sha": "d59372b7aad364a287f21cfbcf12e85d8be97fc7", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ1OTM3MmI3YWFkMzY0YTI4N2YyMWNmYmNmMTJlODVkOGJlOTdmYzc=", "commit": {"author": {"name": "Brandon W Maister", "email": "quodlibetor@gmail.com", "date": "2016-02-01T18:05:37Z"}, "committer": {"name": "Brandon W Maister", "email": "quodlibetor@gmail.com", "date": "2016-02-01T18:05:37Z"}, "message": "Decide to hide constness only in fn/method renders\n\nConstnessSpace has no knowledge of the type of item it's modifying, so\nhide the constness a level up.", "tree": {"sha": "d329df8ded05da5a1e3545ca9383e0e2fc0492c9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d329df8ded05da5a1e3545ca9383e0e2fc0492c9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d59372b7aad364a287f21cfbcf12e85d8be97fc7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d59372b7aad364a287f21cfbcf12e85d8be97fc7", "html_url": "https://github.com/rust-lang/rust/commit/d59372b7aad364a287f21cfbcf12e85d8be97fc7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d59372b7aad364a287f21cfbcf12e85d8be97fc7/comments", "author": {"login": "quodlibetor", "id": 277161, "node_id": "MDQ6VXNlcjI3NzE2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/277161?v=4", "gravatar_id": "", "url": "https://api.github.com/users/quodlibetor", "html_url": "https://github.com/quodlibetor", "followers_url": "https://api.github.com/users/quodlibetor/followers", "following_url": "https://api.github.com/users/quodlibetor/following{/other_user}", "gists_url": "https://api.github.com/users/quodlibetor/gists{/gist_id}", "starred_url": "https://api.github.com/users/quodlibetor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/quodlibetor/subscriptions", "organizations_url": "https://api.github.com/users/quodlibetor/orgs", "repos_url": "https://api.github.com/users/quodlibetor/repos", "events_url": "https://api.github.com/users/quodlibetor/events{/privacy}", "received_events_url": "https://api.github.com/users/quodlibetor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "quodlibetor", "id": 277161, "node_id": "MDQ6VXNlcjI3NzE2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/277161?v=4", "gravatar_id": "", "url": "https://api.github.com/users/quodlibetor", "html_url": "https://github.com/quodlibetor", "followers_url": "https://api.github.com/users/quodlibetor/followers", "following_url": "https://api.github.com/users/quodlibetor/following{/other_user}", "gists_url": "https://api.github.com/users/quodlibetor/gists{/gist_id}", "starred_url": "https://api.github.com/users/quodlibetor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/quodlibetor/subscriptions", "organizations_url": "https://api.github.com/users/quodlibetor/orgs", "repos_url": "https://api.github.com/users/quodlibetor/repos", "events_url": "https://api.github.com/users/quodlibetor/events{/privacy}", "received_events_url": "https://api.github.com/users/quodlibetor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cea8f671994026cefdaadd7388aef9e05b479e66", "url": "https://api.github.com/repos/rust-lang/rust/commits/cea8f671994026cefdaadd7388aef9e05b479e66", "html_url": "https://github.com/rust-lang/rust/commit/cea8f671994026cefdaadd7388aef9e05b479e66"}], "stats": {"total": 17, "additions": 12, "deletions": 5}, "files": [{"sha": "9d5189cfd0b12f992f0766fdc0978ef883ba20f4", "filename": "src/librustdoc/html/format.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d59372b7aad364a287f21cfbcf12e85d8be97fc7/src%2Flibrustdoc%2Fhtml%2Fformat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d59372b7aad364a287f21cfbcf12e85d8be97fc7/src%2Flibrustdoc%2Fhtml%2Fformat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fformat.rs?ref=d59372b7aad364a287f21cfbcf12e85d8be97fc7", "patch": "@@ -657,9 +657,6 @@ impl fmt::Display for UnsafetySpace {\n \n impl fmt::Display for ConstnessSpace {\n     fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {\n-        if option_env!(\"CFG_DISABLE_UNSTABLE_FEATURES\").is_some() {\n-            return Ok(());\n-        }\n         match self.get() {\n             hir::Constness::Const => write!(f, \"const \"),\n             hir::Constness::NotConst => Ok(())"}, {"sha": "dfbe08a0e423d2d204914dbb69cc5185d4a2224b", "filename": "src/librustdoc/html/render.rs", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/d59372b7aad364a287f21cfbcf12e85d8be97fc7/src%2Flibrustdoc%2Fhtml%2Frender.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d59372b7aad364a287f21cfbcf12e85d8be97fc7/src%2Flibrustdoc%2Fhtml%2Frender.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender.rs?ref=d59372b7aad364a287f21cfbcf12e85d8be97fc7", "patch": "@@ -54,10 +54,12 @@ use externalfiles::ExternalHtml;\n \n use serialize::json::{self, ToJson};\n use syntax::{abi, ast};\n+use syntax::feature_gate::UnstableFeatures;\n use rustc::middle::cstore::LOCAL_CRATE;\n use rustc::middle::def_id::{CRATE_DEF_INDEX, DefId};\n use rustc::middle::privacy::AccessLevels;\n use rustc::middle::stability;\n+use rustc::session::config::get_unstable_features_setting;\n use rustc_front::hir;\n \n use clean::{self, SelfTy};\n@@ -1897,10 +1899,14 @@ fn item_static(w: &mut fmt::Formatter, cx: &Context, it: &clean::Item,\n \n fn item_function(w: &mut fmt::Formatter, cx: &Context, it: &clean::Item,\n                  f: &clean::Function) -> fmt::Result {\n+    let vis_constness = match get_unstable_features_setting() {\n+        UnstableFeatures::Allow => f.constness,\n+        _ => hir::Constness::NotConst\n+    };\n     try!(write!(w, \"<pre class='rust fn'>{vis}{constness}{unsafety}{abi}fn \\\n                     {name}{generics}{decl}{where_clause}</pre>\",\n            vis = VisSpace(it.visibility),\n-           constness = ConstnessSpace(f.constness),\n+           constness = ConstnessSpace(vis_constness),\n            unsafety = UnsafetySpace(f.unsafety),\n            abi = AbiSpace(f.abi),\n            name = it.name.as_ref().unwrap(),\n@@ -2122,9 +2128,13 @@ fn render_assoc_item(w: &mut fmt::Formatter, meth: &clean::Item,\n                 href(did).map(|p| format!(\"{}{}\", p.0, anchor)).unwrap_or(anchor)\n             }\n         };\n+        let vis_constness = match get_unstable_features_setting() {\n+            UnstableFeatures::Allow => constness,\n+            _ => hir::Constness::NotConst\n+        };\n         write!(w, \"{}{}{}fn <a href='{href}' class='fnname'>{name}</a>\\\n                    {generics}{decl}{where_clause}\",\n-               ConstnessSpace(constness),\n+               ConstnessSpace(vis_constness),\n                UnsafetySpace(unsafety),\n                match abi {\n                    Abi::Rust => String::new(),"}]}