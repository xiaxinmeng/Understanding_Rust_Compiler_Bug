{"sha": "cabdc5597c6adc2e9f492c9cb682a3b58518bd8c", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNhYmRjNTU5N2M2YWRjMmU5ZjQ5MmM5Y2I2ODJhM2I1ODUxOGJkOGM=", "commit": {"author": {"name": "David Renshaw", "email": "dwrenshaw@gmail.com", "date": "2018-01-06T15:21:24Z"}, "committer": {"name": "David Renshaw", "email": "dwrenshaw@gmail.com", "date": "2018-01-06T15:21:24Z"}, "message": "update log deps", "tree": {"sha": "a2e0187edc1a3a9813965ae4c098d2ebf3e12275", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a2e0187edc1a3a9813965ae4c098d2ebf3e12275"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cabdc5597c6adc2e9f492c9cb682a3b58518bd8c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cabdc5597c6adc2e9f492c9cb682a3b58518bd8c", "html_url": "https://github.com/rust-lang/rust/commit/cabdc5597c6adc2e9f492c9cb682a3b58518bd8c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cabdc5597c6adc2e9f492c9cb682a3b58518bd8c/comments", "author": {"login": "dwrensha", "id": 495768, "node_id": "MDQ6VXNlcjQ5NTc2OA==", "avatar_url": "https://avatars.githubusercontent.com/u/495768?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dwrensha", "html_url": "https://github.com/dwrensha", "followers_url": "https://api.github.com/users/dwrensha/followers", "following_url": "https://api.github.com/users/dwrensha/following{/other_user}", "gists_url": "https://api.github.com/users/dwrensha/gists{/gist_id}", "starred_url": "https://api.github.com/users/dwrensha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dwrensha/subscriptions", "organizations_url": "https://api.github.com/users/dwrensha/orgs", "repos_url": "https://api.github.com/users/dwrensha/repos", "events_url": "https://api.github.com/users/dwrensha/events{/privacy}", "received_events_url": "https://api.github.com/users/dwrensha/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dwrensha", "id": 495768, "node_id": "MDQ6VXNlcjQ5NTc2OA==", "avatar_url": "https://avatars.githubusercontent.com/u/495768?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dwrensha", "html_url": "https://github.com/dwrensha", "followers_url": "https://api.github.com/users/dwrensha/followers", "following_url": "https://api.github.com/users/dwrensha/following{/other_user}", "gists_url": "https://api.github.com/users/dwrensha/gists{/gist_id}", "starred_url": "https://api.github.com/users/dwrensha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dwrensha/subscriptions", "organizations_url": "https://api.github.com/users/dwrensha/orgs", "repos_url": "https://api.github.com/users/dwrensha/repos", "events_url": "https://api.github.com/users/dwrensha/events{/privacy}", "received_events_url": "https://api.github.com/users/dwrensha/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "03aa8765b19a561e85441c6ed94ba3d646477807", "url": "https://api.github.com/repos/rust-lang/rust/commits/03aa8765b19a561e85441c6ed94ba3d646477807", "html_url": "https://github.com/rust-lang/rust/commit/03aa8765b19a561e85441c6ed94ba3d646477807"}], "stats": {"total": 26, "additions": 16, "deletions": 10}, "files": [{"sha": "cc7de42ceabfbb5395e66548cbfc8fbcfa6fed7e", "filename": "Cargo.toml", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cabdc5597c6adc2e9f492c9cb682a3b58518bd8c/Cargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/cabdc5597c6adc2e9f492c9cb682a3b58518bd8c/Cargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Cargo.toml?ref=cabdc5597c6adc2e9f492c9cb682a3b58518bd8c", "patch": "@@ -26,6 +26,8 @@ byteorder = { version = \"1.1\", features = [\"i128\"]}\n cargo_metadata = { version = \"0.2\", optional = true }\n regex = \"0.2.2\"\n lazy_static = \"1.0\"\n+env_logger = \"0.5.0-rc.1\"\n+log = \"0.4\"\n \n [features]\n cargo_miri = [\"cargo_metadata\"]"}, {"sha": "c3d422a6ff5dfc38d1dc7124e2eaf6d621beca68", "filename": "miri/bin/miri.rs", "status": "modified", "additions": 12, "deletions": 9, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/cabdc5597c6adc2e9f492c9cb682a3b58518bd8c/miri%2Fbin%2Fmiri.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cabdc5597c6adc2e9f492c9cb682a3b58518bd8c/miri%2Fbin%2Fmiri.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/miri%2Fbin%2Fmiri.rs?ref=cabdc5597c6adc2e9f492c9cb682a3b58518bd8c", "patch": "@@ -191,38 +191,41 @@ fn resource_limits_from_attributes(state: &CompileState) -> miri::ResourceLimits\n }\n \n fn init_logger() {\n-    let format = |record: &log::LogRecord| {\n-        if record.level() == log::LogLevel::Trace {\n+    let format = |formatter: &mut env_logger::fmt::Formatter, record: &log::Record| {\n+        use std::io::Write;\n+        if record.level() == log::Level::Trace {\n             // prepend frame number\n             let indentation = log_settings::settings().indentation;\n-            format!(\n+            writeln!(\n+                formatter,\n                 \"{indentation}:{lvl}:{module}: {text}\",\n                 lvl = record.level(),\n-                module = record.location().module_path(),\n+                module = record.module_path().unwrap_or(\"<unknown module>\"),\n                 indentation = indentation,\n                 text = record.args(),\n             )\n         } else {\n-            format!(\n+            writeln!(\n+                formatter,\n                 \"{lvl}:{module}: {text}\",\n                 lvl = record.level(),\n-                module = record.location().module_path(),\n+                module = record.module_path().unwrap_or(\"<unknown_module>\"),\n                 text = record.args(),\n             )\n         }\n     };\n \n-    let mut builder = env_logger::LogBuilder::new();\n+    let mut builder = env_logger::Builder::new();\n     builder.format(format).filter(\n         None,\n-        log::LogLevelFilter::Info,\n+        log::LevelFilter::Info,\n     );\n \n     if std::env::var(\"MIRI_LOG\").is_ok() {\n         builder.parse(&std::env::var(\"MIRI_LOG\").unwrap());\n     }\n \n-    builder.init().unwrap();\n+    builder.init();\n }\n \n fn find_sysroot() -> String {"}, {"sha": "9f6550ac072edfbf2cc718b13ac8bab6a79b54bd", "filename": "miri/lib.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/cabdc5597c6adc2e9f492c9cb682a3b58518bd8c/miri%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cabdc5597c6adc2e9f492c9cb682a3b58518bd8c/miri%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/miri%2Flib.rs?ref=cabdc5597c6adc2e9f492c9cb682a3b58518bd8c", "patch": "@@ -5,9 +5,10 @@\n     catch_expr,\n )]\n \n-// From rustc.\n #[macro_use]\n extern crate log;\n+\n+// From rustc.\n #[macro_use]\n extern crate rustc;\n extern crate rustc_mir;"}]}