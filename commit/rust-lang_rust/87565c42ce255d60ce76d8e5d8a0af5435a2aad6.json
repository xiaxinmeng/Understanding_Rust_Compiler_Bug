{"sha": "87565c42ce255d60ce76d8e5d8a0af5435a2aad6", "node_id": "MDY6Q29tbWl0NzI0NzEyOjg3NTY1YzQyY2UyNTVkNjBjZTc2ZDhlNWQ4YTBhZjU0MzVhMmFhZDY=", "commit": {"author": {"name": "St\u00e9phane Campinas", "email": "stephane.campinas@gmail.com", "date": "2019-06-08T07:50:12Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-06-08T07:50:12Z"}, "message": "Merge pull request #3607 from topecongiro/issue-3493\n\nIgnore sub-modules when skip-children is used", "tree": {"sha": "b5e9ee8a384ed95df4cd87eb8eb4e074890f776a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/b5e9ee8a384ed95df4cd87eb8eb4e074890f776a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/87565c42ce255d60ce76d8e5d8a0af5435a2aad6", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJc+2i0CRBK7hj4Ov3rIwAAdHIIAGn2mMoQCk7rVpQX3IMz99Zv\nz/XN7/RNkneccjeBcSjkWblthOvC5FVxIJndIJHFYcxnUwC1G7H1ldp7YmdICHpE\nACFxEG5IIYpbpT/QK4KI8cH3dGsqaawDy1d2/DWQjxjuRVi/soHpGT4hI1EqYkXB\ntlTmnEsDmMvEQRQe+uBN1KuZ5++juWf04IjuExqx0trDt0S7pA9tGmPnFmRUZgDu\nHw6NDB5z8U1jmNaoEVOn9czK/nYgVaVvZMiNOhaWP/X0x7C8T9SEYFDhhPfpHIpB\nyjCra6fmma2LxKDycKC27BqeM4tzt5x4yPZsu7JtiO3lHMDDVfDQWQiUFMbS6i8=\n=BCrq\n-----END PGP SIGNATURE-----\n", "payload": "tree b5e9ee8a384ed95df4cd87eb8eb4e074890f776a\nparent eea8af01833f0906b76686bd86408776050f226a\nparent 788a4cbe4ff7b53e9e247acd723642dd82bddcc8\nauthor St\u00e9phane Campinas <stephane.campinas@gmail.com> 1559980212 +0200\ncommitter GitHub <noreply@github.com> 1559980212 +0200\n\nMerge pull request #3607 from topecongiro/issue-3493\n\nIgnore sub-modules when skip-children is used"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/87565c42ce255d60ce76d8e5d8a0af5435a2aad6", "html_url": "https://github.com/rust-lang/rust/commit/87565c42ce255d60ce76d8e5d8a0af5435a2aad6", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/87565c42ce255d60ce76d8e5d8a0af5435a2aad6/comments", "author": {"login": "scampi", "id": 795879, "node_id": "MDQ6VXNlcjc5NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/795879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scampi", "html_url": "https://github.com/scampi", "followers_url": "https://api.github.com/users/scampi/followers", "following_url": "https://api.github.com/users/scampi/following{/other_user}", "gists_url": "https://api.github.com/users/scampi/gists{/gist_id}", "starred_url": "https://api.github.com/users/scampi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scampi/subscriptions", "organizations_url": "https://api.github.com/users/scampi/orgs", "repos_url": "https://api.github.com/users/scampi/repos", "events_url": "https://api.github.com/users/scampi/events{/privacy}", "received_events_url": "https://api.github.com/users/scampi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "eea8af01833f0906b76686bd86408776050f226a", "url": "https://api.github.com/repos/rust-lang/rust/commits/eea8af01833f0906b76686bd86408776050f226a", "html_url": "https://github.com/rust-lang/rust/commit/eea8af01833f0906b76686bd86408776050f226a"}, {"sha": "788a4cbe4ff7b53e9e247acd723642dd82bddcc8", "url": "https://api.github.com/repos/rust-lang/rust/commits/788a4cbe4ff7b53e9e247acd723642dd82bddcc8", "html_url": "https://github.com/rust-lang/rust/commit/788a4cbe4ff7b53e9e247acd723642dd82bddcc8"}], "stats": {"total": 12, "additions": 7, "deletions": 5}, "files": [{"sha": "4787b15e94aaaa5d9a7e7d6dec3a862845bca931", "filename": "src/formatting.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/87565c42ce255d60ce76d8e5d8a0af5435a2aad6/src%2Fformatting.rs", "raw_url": "https://github.com/rust-lang/rust/raw/87565c42ce255d60ce76d8e5d8a0af5435a2aad6/src%2Fformatting.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fformatting.rs?ref=87565c42ce255d60ce76d8e5d8a0af5435a2aad6", "patch": "@@ -101,7 +101,7 @@ fn format_project<T: FormatHandler>(\n     let files = modules::ModResolver::new(\n         context.parse_session.source_map(),\n         directory_ownership.unwrap_or(parse::DirectoryOwnership::UnownedViaMod(false)),\n-        input_is_stdin,\n+        !(input_is_stdin || config.skip_children()),\n     )\n     .visit_crate(&krate)\n     .map_err(|e| io::Error::new(io::ErrorKind::Other, e))?;"}, {"sha": "9da76de19ffffddb5644e4382bfafae650bdaecf", "filename": "src/modules.rs", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/87565c42ce255d60ce76d8e5d8a0af5435a2aad6/src%2Fmodules.rs", "raw_url": "https://github.com/rust-lang/rust/raw/87565c42ce255d60ce76d8e5d8a0af5435a2aad6/src%2Fmodules.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fmodules.rs?ref=87565c42ce255d60ce76d8e5d8a0af5435a2aad6", "patch": "@@ -18,7 +18,7 @@ pub(crate) struct ModResolver<'a, 'b> {\n     source_map: &'b source_map::SourceMap,\n     directory: Directory,\n     file_map: FileModMap<'a>,\n-    is_input_stdin: bool,\n+    recursive: bool,\n }\n \n #[derive(Clone)]\n@@ -32,7 +32,7 @@ impl<'a, 'b> ModResolver<'a, 'b> {\n     pub(crate) fn new(\n         source_map: &'b source_map::SourceMap,\n         directory_ownership: DirectoryOwnership,\n-        is_input_stdin: bool,\n+        recursive: bool,\n     ) -> Self {\n         ModResolver {\n             directory: Directory {\n@@ -41,7 +41,7 @@ impl<'a, 'b> ModResolver<'a, 'b> {\n             },\n             file_map: BTreeMap::new(),\n             source_map,\n-            is_input_stdin,\n+            recursive,\n         }\n     }\n \n@@ -57,7 +57,7 @@ impl<'a, 'b> ModResolver<'a, 'b> {\n         };\n \n         // Skip visiting sub modules when the input is from stdin.\n-        if !self.is_input_stdin {\n+        if self.recursive {\n             self.visit_mod(&krate.module)?;\n         }\n "}, {"sha": "e51889dd4c91f159ebf7dedcd04f4f6a829151ca", "filename": "tests/source/configs/skip_children/true.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/87565c42ce255d60ce76d8e5d8a0af5435a2aad6/tests%2Fsource%2Fconfigs%2Fskip_children%2Ftrue.rs", "raw_url": "https://github.com/rust-lang/rust/raw/87565c42ce255d60ce76d8e5d8a0af5435a2aad6/tests%2Fsource%2Fconfigs%2Fskip_children%2Ftrue.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fsource%2Fconfigs%2Fskip_children%2Ftrue.rs?ref=87565c42ce255d60ce76d8e5d8a0af5435a2aad6", "patch": "@@ -1,3 +1,4 @@\n // rustfmt-skip_children: true\n \n mod foo  ;\n+mod void;"}, {"sha": "33fd782b4fa2ce153a6a6e5a3cf6862de80c165d", "filename": "tests/target/configs/skip_children/true.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/87565c42ce255d60ce76d8e5d8a0af5435a2aad6/tests%2Ftarget%2Fconfigs%2Fskip_children%2Ftrue.rs", "raw_url": "https://github.com/rust-lang/rust/raw/87565c42ce255d60ce76d8e5d8a0af5435a2aad6/tests%2Ftarget%2Fconfigs%2Fskip_children%2Ftrue.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Ftarget%2Fconfigs%2Fskip_children%2Ftrue.rs?ref=87565c42ce255d60ce76d8e5d8a0af5435a2aad6", "patch": "@@ -1,3 +1,4 @@\n // rustfmt-skip_children: true\n \n mod foo;\n+mod void;"}]}