{"sha": "f2c5acd611e383020db373f0b2dd7d4a89ed33c0", "node_id": "MDY6Q29tbWl0NzI0NzEyOmYyYzVhY2Q2MTFlMzgzMDIwZGIzNzNmMGIyZGQ3ZDRhODllZDMzYzA=", "commit": {"author": {"name": "Zack M. Davis", "email": "code@zackmdavis.net", "date": "2017-09-30T06:44:41Z"}, "committer": {"name": "Zack M. Davis", "email": "code@zackmdavis.net", "date": "2017-09-30T18:31:12Z"}, "message": "code suggestion for deprecated-attribute lint\n\nAlso, fix the deprecation message for the late no-debug feature.", "tree": {"sha": "a906226943fb86e9943ff6aa352a28d4a5923d39", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/a906226943fb86e9943ff6aa352a28d4a5923d39"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f2c5acd611e383020db373f0b2dd7d4a89ed33c0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f2c5acd611e383020db373f0b2dd7d4a89ed33c0", "html_url": "https://github.com/rust-lang/rust/commit/f2c5acd611e383020db373f0b2dd7d4a89ed33c0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f2c5acd611e383020db373f0b2dd7d4a89ed33c0/comments", "author": {"login": "zackmdavis", "id": 1076988, "node_id": "MDQ6VXNlcjEwNzY5ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1076988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zackmdavis", "html_url": "https://github.com/zackmdavis", "followers_url": "https://api.github.com/users/zackmdavis/followers", "following_url": "https://api.github.com/users/zackmdavis/following{/other_user}", "gists_url": "https://api.github.com/users/zackmdavis/gists{/gist_id}", "starred_url": "https://api.github.com/users/zackmdavis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zackmdavis/subscriptions", "organizations_url": "https://api.github.com/users/zackmdavis/orgs", "repos_url": "https://api.github.com/users/zackmdavis/repos", "events_url": "https://api.github.com/users/zackmdavis/events{/privacy}", "received_events_url": "https://api.github.com/users/zackmdavis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "zackmdavis", "id": 1076988, "node_id": "MDQ6VXNlcjEwNzY5ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/1076988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zackmdavis", "html_url": "https://github.com/zackmdavis", "followers_url": "https://api.github.com/users/zackmdavis/followers", "following_url": "https://api.github.com/users/zackmdavis/following{/other_user}", "gists_url": "https://api.github.com/users/zackmdavis/gists{/gist_id}", "starred_url": "https://api.github.com/users/zackmdavis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zackmdavis/subscriptions", "organizations_url": "https://api.github.com/users/zackmdavis/orgs", "repos_url": "https://api.github.com/users/zackmdavis/repos", "events_url": "https://api.github.com/users/zackmdavis/events{/privacy}", "received_events_url": "https://api.github.com/users/zackmdavis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d663003e034a50be8aa62f394d03ad594fcf2b3c", "url": "https://api.github.com/repos/rust-lang/rust/commits/d663003e034a50be8aa62f394d03ad594fcf2b3c", "html_url": "https://github.com/rust-lang/rust/commit/d663003e034a50be8aa62f394d03ad594fcf2b3c"}], "stats": {"total": 14, "additions": 8, "deletions": 6}, "files": [{"sha": "cedc2871623ad9b4c9d89a104dce93b1ab68345e", "filename": "src/librustc_lint/builtin.rs", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/f2c5acd611e383020db373f0b2dd7d4a89ed33c0/src%2Flibrustc_lint%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f2c5acd611e383020db373f0b2dd7d4a89ed33c0/src%2Flibrustc_lint%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2Fbuiltin.rs?ref=f2c5acd611e383020db373f0b2dd7d4a89ed33c0", "patch": "@@ -650,10 +650,11 @@ impl EarlyLintPass for DeprecatedAttr {\n                                              ref name,\n                                              ref reason,\n                                              _) = g {\n-                    cx.span_lint(DEPRECATED,\n-                                 attr.span,\n-                                 &format!(\"use of deprecated attribute `{}`: {}. See {}\",\n-                                          name, reason, link));\n+                    let msg = format!(\"use of deprecated attribute `{}`: {}. See {}\",\n+                                      name, reason, link);\n+                    let mut err = cx.struct_span_lint(DEPRECATED, attr.span, &msg);\n+                    err.span_suggestion_short(attr.span, \"remove this attribute\", \"\".to_owned());\n+                    err.emit();\n                 }\n                 return;\n             }"}, {"sha": "f6e85ed6725ceafbd6bbe3d40d2e44aab63bec2f", "filename": "src/libsyntax/feature_gate.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/f2c5acd611e383020db373f0b2dd7d4a89ed33c0/src%2Flibsyntax%2Ffeature_gate.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f2c5acd611e383020db373f0b2dd7d4a89ed33c0/src%2Flibsyntax%2Ffeature_gate.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2Ffeature_gate.rs?ref=f2c5acd611e383020db373f0b2dd7d4a89ed33c0", "patch": "@@ -824,7 +824,8 @@ pub const BUILTIN_ATTRIBUTES: &'static [(&'static str, AttributeType, AttributeG\n     (\"no_debug\", Whitelisted, Gated(\n         Stability::Deprecated(\"https://github.com/rust-lang/rust/issues/29721\"),\n         \"no_debug\",\n-        \"the `#[no_debug]` attribute is an experimental feature\",\n+        \"the `#[no_debug]` attribute was an experimental feature that has been \\\n+         deprecated due to lack of demand\",\n         cfg_fn!(no_debug))),\n     (\"omit_gdb_pretty_printer_section\", Whitelisted, Gated(Stability::Unstable,\n                                                        \"omit_gdb_pretty_printer_section\","}, {"sha": "d21493de50a7fed484baf5aff3f234cf3df31b3a", "filename": "src/test/compile-fail/feature-gate-no-debug.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/f2c5acd611e383020db373f0b2dd7d4a89ed33c0/src%2Ftest%2Fcompile-fail%2Ffeature-gate-no-debug.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f2c5acd611e383020db373f0b2dd7d4a89ed33c0/src%2Ftest%2Fcompile-fail%2Ffeature-gate-no-debug.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Ffeature-gate-no-debug.rs?ref=f2c5acd611e383020db373f0b2dd7d4a89ed33c0", "patch": "@@ -10,5 +10,5 @@\n \n #![allow(deprecated)]\n \n-#[no_debug] //~ ERROR the `#[no_debug]` attribute is\n+#[no_debug] //~ ERROR the `#[no_debug]` attribute was\n fn main() {}"}]}