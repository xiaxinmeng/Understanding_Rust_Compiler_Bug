{"sha": "82981a77c45fcdb3c78c80b3e3a265413c934bbb", "node_id": "MDY6Q29tbWl0NzI0NzEyOjgyOTgxYTc3YzQ1ZmNkYjNjNzhjODBiM2UzYTI2NTQxM2M5MzRiYmI=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2018-01-23T09:03:36Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2018-01-23T09:03:36Z"}, "message": "Rollup merge of #47541 - psumbera:master, r=eddyb\n\nFixes sparc64 cabi fixes.\n\nArgument up to 16 bytes size is provided in registers.\nReturn value up to 32 bytes size is stored in registers.\n\nFixes: #46679\n\n---\n\nFirefox now (almost) build on sparc. Original rust issue seems to be gone. Note that I'm not rust expert and the fix was suggested in bug.", "tree": {"sha": "82f302b1eeaa55bdfde30ce3abd466662b6a058b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/82f302b1eeaa55bdfde30ce3abd466662b6a058b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/82981a77c45fcdb3c78c80b3e3a265413c934bbb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/82981a77c45fcdb3c78c80b3e3a265413c934bbb", "html_url": "https://github.com/rust-lang/rust/commit/82981a77c45fcdb3c78c80b3e3a265413c934bbb", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/82981a77c45fcdb3c78c80b3e3a265413c934bbb/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "150f2baca82726eca4b0bc68a070f1b0015e954c", "url": "https://api.github.com/repos/rust-lang/rust/commits/150f2baca82726eca4b0bc68a070f1b0015e954c", "html_url": "https://github.com/rust-lang/rust/commit/150f2baca82726eca4b0bc68a070f1b0015e954c"}, {"sha": "1203b3d892b6f8424f6540173e31af1cda304e36", "url": "https://api.github.com/repos/rust-lang/rust/commits/1203b3d892b6f8424f6540173e31af1cda304e36", "html_url": "https://github.com/rust-lang/rust/commit/1203b3d892b6f8424f6540173e31af1cda304e36"}], "stats": {"total": 7, "additions": 6, "deletions": 1}, "files": [{"sha": "b3fc6a6806118d7ca9a0f3081fa1270511e2a7dd", "filename": "src/librustc_trans/cabi_sparc64.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/82981a77c45fcdb3c78c80b3e3a265413c934bbb/src%2Flibrustc_trans%2Fcabi_sparc64.rs", "raw_url": "https://github.com/rust-lang/rust/raw/82981a77c45fcdb3c78c80b3e3a265413c934bbb/src%2Flibrustc_trans%2Fcabi_sparc64.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_trans%2Fcabi_sparc64.rs?ref=82981a77c45fcdb3c78c80b3e3a265413c934bbb", "patch": "@@ -50,7 +50,7 @@ fn classify_ret_ty<'a, 'tcx>(cx: &CodegenCx<'a, 'tcx>, ret: &mut ArgType<'tcx>)\n     }\n     let size = ret.layout.size;\n     let bits = size.bits();\n-    if bits <= 128 {\n+    if bits <= 256 {\n         let unit = if bits <= 8 {\n             Reg::i8()\n         } else if bits <= 16 {\n@@ -84,6 +84,11 @@ fn classify_arg_ty<'a, 'tcx>(cx: &CodegenCx<'a, 'tcx>, arg: &mut ArgType<'tcx>)\n     }\n \n     let total = arg.layout.size;\n+    if total.bits() > 128 {\n+        arg.make_indirect();\n+        return;\n+    }\n+\n     arg.cast_to(Uniform {\n         unit: Reg::i64(),\n         total"}]}