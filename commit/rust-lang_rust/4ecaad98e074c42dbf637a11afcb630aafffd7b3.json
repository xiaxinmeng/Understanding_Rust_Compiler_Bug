{"sha": "4ecaad98e074c42dbf637a11afcb630aafffd7b3", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRlY2FhZDk4ZTA3NGM0MmRiZjYzN2ExMWFmY2I2MzBhYWZmZmQ3YjM=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2021-03-26T16:29:20Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-03-26T16:29:20Z"}, "message": "Merge #8056\n\n8056: completion relevance consider if types can be unified r=JoshMcguigan a=JoshMcguigan\n\nThis PR improves completion relevance scoring for generic types, in cases where the types could unify. \r\n\r\n### Before\r\n\r\n![pre-could-unify](https://user-images.githubusercontent.com/22216761/111338556-46d94e80-8634-11eb-9936-2b20eb9e6756.png)\r\n\r\n### After\r\n\r\n![post-could-unify](https://user-images.githubusercontent.com/22216761/111338598-4e005c80-8634-11eb-92e0-69c2c1cda6fc.png)\r\n\r\nchangelog feature improve completions\n\nCo-authored-by: Josh Mcguigan <joshmcg88@gmail.com>", "tree": {"sha": "50832b85e65752b040affcc8d34dc5cd8c2625b9", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/50832b85e65752b040affcc8d34dc5cd8c2625b9"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4ecaad98e074c42dbf637a11afcb630aafffd7b3", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJgXgvgCRBK7hj4Ov3rIwAAdHIIAJUKyoZSKvlIGaAfLKZSWGtr\n5zmOLBAVnMILZsBDk/0KP5VHfJwpFSKLRJEj1Eyf/BXz74yHl4v46iCwRDhFcXs/\nY88NK7vPr5aWuE8utbXHhcW5uyl5Fnoz54NPjA2YjcbeltzwWaFccY0ic/FU2HBF\nPBjqmjRd6yZe8dsznfK2uBO8YIDbiD2yD/Gc9EdLtqV3/zL4rgE2fCdZdGb3zQgF\ndbNe0TQgXlOhVYstC1V9SIat+QYtEjTOoYX+q2YDF/YsMyRjHeAyXRVqc+8f9GLu\nqM0/qrNydRXWBs815pHN3ADEulFQQ/Gk+Rrj4M0Y20m0sANPs91+gQIskx/AL/Q=\n=D8Qc\n-----END PGP SIGNATURE-----\n", "payload": "tree 50832b85e65752b040affcc8d34dc5cd8c2625b9\nparent 20e32fc946010f8c46728d6cb8bab1b96b3f48b9\nparent 0e31ae2cef92f973a6ee3def3f1feaa94dcb7a4f\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1616776160 +0000\ncommitter GitHub <noreply@github.com> 1616776160 +0000\n\nMerge #8056\n\n8056: completion relevance consider if types can be unified r=JoshMcguigan a=JoshMcguigan\n\nThis PR improves completion relevance scoring for generic types, in cases where the types could unify. \r\n\r\n### Before\r\n\r\n![pre-could-unify](https://user-images.githubusercontent.com/22216761/111338556-46d94e80-8634-11eb-9936-2b20eb9e6756.png)\r\n\r\n### After\r\n\r\n![post-could-unify](https://user-images.githubusercontent.com/22216761/111338598-4e005c80-8634-11eb-92e0-69c2c1cda6fc.png)\r\n\r\nchangelog feature improve completions\n\nCo-authored-by: Josh Mcguigan <joshmcg88@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4ecaad98e074c42dbf637a11afcb630aafffd7b3", "html_url": "https://github.com/rust-lang/rust/commit/4ecaad98e074c42dbf637a11afcb630aafffd7b3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4ecaad98e074c42dbf637a11afcb630aafffd7b3/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "20e32fc946010f8c46728d6cb8bab1b96b3f48b9", "url": "https://api.github.com/repos/rust-lang/rust/commits/20e32fc946010f8c46728d6cb8bab1b96b3f48b9", "html_url": "https://github.com/rust-lang/rust/commit/20e32fc946010f8c46728d6cb8bab1b96b3f48b9"}, {"sha": "0e31ae2cef92f973a6ee3def3f1feaa94dcb7a4f", "url": "https://api.github.com/repos/rust-lang/rust/commits/0e31ae2cef92f973a6ee3def3f1feaa94dcb7a4f", "html_url": "https://github.com/rust-lang/rust/commit/0e31ae2cef92f973a6ee3def3f1feaa94dcb7a4f"}], "stats": {"total": 167, "additions": 124, "deletions": 43}, "files": [{"sha": "4ee08ef212a4629e1e809f87a8e26b8f6f234555", "filename": "crates/hir/src/lib.rs", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Fhir%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Fhir%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir%2Fsrc%2Flib.rs?ref=4ecaad98e074c42dbf637a11afcb630aafffd7b3", "patch": "@@ -51,7 +51,7 @@ use hir_def::{\n };\n use hir_expand::{diagnostics::DiagnosticSink, name::name, MacroDefKind};\n use hir_ty::{\n-    autoderef,\n+    autoderef, could_unify,\n     method_resolution::{self, TyFingerprint},\n     primitive::UintTy,\n     to_assoc_type_id,\n@@ -2154,6 +2154,10 @@ impl Type {\n \n         walk_type(db, self, &mut cb);\n     }\n+\n+    pub fn could_unify_with(&self, other: &Type) -> bool {\n+        could_unify(&self.ty, &other.ty)\n+    }\n }\n \n // FIXME: closures"}, {"sha": "e4407ff5051db6e55277192557e291e8b455fbf5", "filename": "crates/hir_ty/src/infer.rs", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Fhir_ty%2Fsrc%2Finfer.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Fhir_ty%2Fsrc%2Finfer.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_ty%2Fsrc%2Finfer.rs?ref=4ecaad98e074c42dbf637a11afcb630aafffd7b3", "patch": "@@ -45,6 +45,11 @@ use crate::{\n     to_assoc_type_id, to_chalk_trait_id, AliasEq, AliasTy, Interner, TyKind,\n };\n \n+// This lint has a false positive here. See the link below for details.\n+//\n+// https://github.com/rust-lang/rust/issues/57411\n+#[allow(unreachable_pub)]\n+pub use unify::could_unify;\n pub(crate) use unify::unify;\n \n mod unify;"}, {"sha": "6e7b0f5a63340053b0f25b51cb82ce524911e96f", "filename": "crates/hir_ty/src/infer/unify.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Fhir_ty%2Fsrc%2Finfer%2Funify.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Fhir_ty%2Fsrc%2Finfer%2Funify.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_ty%2Fsrc%2Finfer%2Funify.rs?ref=4ecaad98e074c42dbf637a11afcb630aafffd7b3", "patch": "@@ -157,6 +157,10 @@ impl<T> Canonicalized<T> {\n     }\n }\n \n+pub fn could_unify(t1: &Ty, t2: &Ty) -> bool {\n+    InferenceTable::new().unify(t1, t2)\n+}\n+\n pub(crate) fn unify(tys: &Canonical<(Ty, Ty)>) -> Option<Substitution> {\n     let mut table = InferenceTable::new();\n     let vars = Substitution("}, {"sha": "6f9c698e64cc21d4ada64bae68cd505a14126376", "filename": "crates/hir_ty/src/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Fhir_ty%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Fhir_ty%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fhir_ty%2Fsrc%2Flib.rs?ref=4ecaad98e074c42dbf637a11afcb630aafffd7b3", "patch": "@@ -41,7 +41,7 @@ use crate::{\n };\n \n pub use autoderef::autoderef;\n-pub use infer::{InferenceResult, InferenceVar};\n+pub use infer::{could_unify, InferenceResult, InferenceVar};\n pub use lower::{\n     associated_type_shorthand_candidates, callable_item_sig, CallableDefId, ImplTraitLoweringMode,\n     TyDefId, TyLoweringContext, ValueTyDefId,"}, {"sha": "cc4ac9ea2ef113c67fad7aa3b182f19f648deb54", "filename": "crates/ide_completion/src/item.rs", "status": "modified", "additions": 39, "deletions": 20, "changes": 59, "blob_url": "https://github.com/rust-lang/rust/blob/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Fide_completion%2Fsrc%2Fitem.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Fide_completion%2Fsrc%2Fitem.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_completion%2Fsrc%2Fitem.rs?ref=4ecaad98e074c42dbf637a11afcb630aafffd7b3", "patch": "@@ -122,7 +122,7 @@ impl fmt::Debug for CompletionItem {\n     }\n }\n \n-#[derive(Debug, Clone, Copy, Ord, PartialOrd, Eq, PartialEq, Default)]\n+#[derive(Debug, Clone, Copy, Eq, PartialEq, Default)]\n pub struct CompletionRelevance {\n     /// This is set in cases like these:\n     ///\n@@ -134,31 +134,41 @@ pub struct CompletionRelevance {\n     /// }\n     /// ```\n     pub exact_name_match: bool,\n+    /// See CompletionRelevanceTypeMatch doc comments for cases where this is set.\n+    pub type_match: Option<CompletionRelevanceTypeMatch>,\n     /// This is set in cases like these:\n     ///\n     /// ```\n-    /// fn f(spam: String) {}\n-    /// fn main {\n-    ///     let foo = String::new();\n-    ///     f($0) // type of local matches the type of param\n+    /// fn foo(a: u32) {\n+    ///     let b = 0;\n+    ///     $0 // `a` and `b` are local\n     /// }\n     /// ```\n-    pub exact_type_match: bool,\n+    pub is_local: bool,\n+}\n+\n+#[derive(Debug, Clone, Copy, Eq, PartialEq)]\n+pub enum CompletionRelevanceTypeMatch {\n     /// This is set in cases like these:\n     ///\n     /// ```\n-    /// fn foo(bar: u32) {\n-    ///     $0 // `bar` is local\n+    /// enum Option<T> { Some(T), None }\n+    /// fn f(a: Option<u32>) {}\n+    /// fn main {\n+    ///     f(Option::N$0) // type `Option<T>` could unify with `Option<u32>`\n     /// }\n     /// ```\n+    CouldUnify,\n+    /// This is set in cases like these:\n     ///\n     /// ```\n-    /// fn foo() {\n-    ///     let bar = 0;\n-    ///     $0 // `bar` is local\n+    /// fn f(spam: String) {}\n+    /// fn main {\n+    ///     let foo = String::new();\n+    ///     f($0) // type of local matches the type of param\n     /// }\n     /// ```\n-    pub is_local: bool,\n+    Exact,\n }\n \n impl CompletionRelevance {\n@@ -177,9 +187,11 @@ impl CompletionRelevance {\n         if self.exact_name_match {\n             score += 1;\n         }\n-        if self.exact_type_match {\n-            score += 3;\n-        }\n+        score += match self.type_match {\n+            Some(CompletionRelevanceTypeMatch::Exact) => 4,\n+            Some(CompletionRelevanceTypeMatch::CouldUnify) => 3,\n+            None => 0,\n+        };\n         if self.is_local {\n             score += 1;\n         }\n@@ -342,7 +354,7 @@ impl CompletionItem {\n         // match, but with exact type match set because self.ref_match\n         // is only set if there is an exact type match.\n         let mut relevance = self.relevance;\n-        relevance.exact_type_match = true;\n+        relevance.type_match = Some(CompletionRelevanceTypeMatch::Exact);\n \n         self.ref_match.map(|mutability| (mutability, relevance))\n     }\n@@ -523,7 +535,7 @@ mod tests {\n     use itertools::Itertools;\n     use test_utils::assert_eq_text;\n \n-    use super::CompletionRelevance;\n+    use super::{CompletionRelevance, CompletionRelevanceTypeMatch};\n \n     /// Check that these are CompletionRelevance are sorted in ascending order\n     /// by their relevance score.\n@@ -576,15 +588,22 @@ mod tests {\n                 is_local: true,\n                 ..CompletionRelevance::default()\n             }],\n-            vec![CompletionRelevance { exact_type_match: true, ..CompletionRelevance::default() }],\n+            vec![CompletionRelevance {\n+                type_match: Some(CompletionRelevanceTypeMatch::CouldUnify),\n+                ..CompletionRelevance::default()\n+            }],\n+            vec![CompletionRelevance {\n+                type_match: Some(CompletionRelevanceTypeMatch::Exact),\n+                ..CompletionRelevance::default()\n+            }],\n             vec![CompletionRelevance {\n                 exact_name_match: true,\n-                exact_type_match: true,\n+                type_match: Some(CompletionRelevanceTypeMatch::Exact),\n                 ..CompletionRelevance::default()\n             }],\n             vec![CompletionRelevance {\n                 exact_name_match: true,\n-                exact_type_match: true,\n+                type_match: Some(CompletionRelevanceTypeMatch::Exact),\n                 is_local: true,\n             }],\n         ];"}, {"sha": "1a762d3dc1f0fd6d0cdd05ff746eafc3a0651348", "filename": "crates/ide_completion/src/render.rs", "status": "modified", "additions": 65, "deletions": 16, "changes": 81, "blob_url": "https://github.com/rust-lang/rust/blob/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Fide_completion%2Fsrc%2Frender.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Fide_completion%2Fsrc%2Frender.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_completion%2Fsrc%2Frender.rs?ref=4ecaad98e074c42dbf637a11afcb630aafffd7b3", "patch": "@@ -20,8 +20,8 @@ use ide_db::{\n use syntax::TextRange;\n \n use crate::{\n-    item::ImportEdit, CompletionContext, CompletionItem, CompletionItemKind, CompletionKind,\n-    CompletionRelevance,\n+    item::{CompletionRelevanceTypeMatch, ImportEdit},\n+    CompletionContext, CompletionItem, CompletionItemKind, CompletionKind, CompletionRelevance,\n };\n \n use crate::render::{enum_variant::render_variant, function::render_fn, macro_::render_macro};\n@@ -143,7 +143,7 @@ impl<'a> Render<'a> {\n             .set_deprecated(is_deprecated);\n \n         item.set_relevance(CompletionRelevance {\n-            exact_type_match: compute_exact_type_match(self.ctx.completion, ty),\n+            type_match: compute_type_match(self.ctx.completion, ty),\n             exact_name_match: compute_exact_name_match(self.ctx.completion, name.to_string()),\n             ..CompletionRelevance::default()\n         });\n@@ -245,7 +245,7 @@ impl<'a> Render<'a> {\n             }\n \n             item.set_relevance(CompletionRelevance {\n-                exact_type_match: compute_exact_type_match(self.ctx.completion, &ty),\n+                type_match: compute_type_match(self.ctx.completion, &ty),\n                 exact_name_match: compute_exact_name_match(self.ctx.completion, &local_name),\n                 is_local: true,\n                 ..CompletionRelevance::default()\n@@ -309,14 +309,24 @@ impl<'a> Render<'a> {\n     }\n }\n \n-fn compute_exact_type_match(ctx: &CompletionContext, completion_ty: &hir::Type) -> bool {\n-    match ctx.expected_type.as_ref() {\n-        Some(expected_type) => {\n-            // We don't ever consider unit type to be an exact type match, since\n-            // nearly always this is not meaningful to the user.\n-            completion_ty == expected_type && !expected_type.is_unit()\n-        }\n-        None => false,\n+fn compute_type_match(\n+    ctx: &CompletionContext,\n+    completion_ty: &hir::Type,\n+) -> Option<CompletionRelevanceTypeMatch> {\n+    let expected_type = ctx.expected_type.as_ref()?;\n+\n+    // We don't ever consider unit type to be an exact type match, since\n+    // nearly always this is not meaningful to the user.\n+    if expected_type.is_unit() {\n+        return None;\n+    }\n+\n+    if completion_ty == expected_type {\n+        Some(CompletionRelevanceTypeMatch::Exact)\n+    } else if expected_type.could_unify_with(completion_ty) {\n+        Some(CompletionRelevanceTypeMatch::CouldUnify)\n+    } else {\n+        None\n     }\n }\n \n@@ -348,6 +358,7 @@ mod tests {\n     use itertools::Itertools;\n \n     use crate::{\n+        item::CompletionRelevanceTypeMatch,\n         test_utils::{check_edit, do_completion, get_all_items, TEST_CONFIG},\n         CompletionKind, CompletionRelevance,\n     };\n@@ -360,7 +371,11 @@ mod tests {\n     fn check_relevance(ra_fixture: &str, expect: Expect) {\n         fn display_relevance(relevance: CompletionRelevance) -> String {\n             let relevance_factors = vec![\n-                (relevance.exact_type_match, \"type\"),\n+                (relevance.type_match == Some(CompletionRelevanceTypeMatch::Exact), \"type\"),\n+                (\n+                    relevance.type_match == Some(CompletionRelevanceTypeMatch::CouldUnify),\n+                    \"type_could_unify\",\n+                ),\n                 (relevance.exact_name_match, \"name\"),\n                 (relevance.is_local, \"local\"),\n             ]\n@@ -533,7 +548,9 @@ fn main() { let _: m::Spam = S$0 }\n                         detail: \"(i32)\",\n                         relevance: CompletionRelevance {\n                             exact_name_match: false,\n-                            exact_type_match: true,\n+                            type_match: Some(\n+                                Exact,\n+                            ),\n                             is_local: false,\n                         },\n                         trigger_call_info: true,\n@@ -559,7 +576,9 @@ fn main() { let _: m::Spam = S$0 }\n                         detail: \"()\",\n                         relevance: CompletionRelevance {\n                             exact_name_match: false,\n-                            exact_type_match: true,\n+                            type_match: Some(\n+                                Exact,\n+                            ),\n                             is_local: false,\n                         },\n                     },\n@@ -1108,7 +1127,7 @@ fn main() {\n                         detail: \"S\",\n                         relevance: CompletionRelevance {\n                             exact_name_match: true,\n-                            exact_type_match: false,\n+                            type_match: None,\n                             is_local: true,\n                         },\n                         ref_match: \"&mut \",\n@@ -1353,4 +1372,34 @@ fn foo(f: Foo) { let _: &u32 = f.b$0 }\n             \"#]],\n         );\n     }\n+\n+    #[test]\n+    fn generic_enum() {\n+        check_relevance(\n+            r#\"\n+enum Foo<T> { A(T), B }\n+// bar() should not be an exact type match\n+// because the generic parameters are different\n+fn bar() -> Foo<u8> { Foo::B }\n+// FIXME baz() should be an exact type match\n+// because the types could unify, but it currently\n+// is not. This is due to the T here being\n+// TyKind::Placeholder rather than TyKind::Missing.\n+fn baz<T>() -> Foo<T> { Foo::B }\n+fn foo() {\n+    let foo: Foo<u32> = Foo::B;\n+    let _: Foo<u32> = f$0;\n+}\n+\"#,\n+            expect![[r#\"\n+                ev Foo::A(\u2026) [type_could_unify]\n+                ev Foo::B [type_could_unify]\n+                lc foo [type+local]\n+                en Foo []\n+                fn baz() []\n+                fn bar() []\n+                fn foo() []\n+            \"#]],\n+        );\n+    }\n }"}, {"sha": "832f5ced1310fa146ba41616f7828b0013872c9b", "filename": "crates/ide_completion/src/render/enum_variant.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Fide_completion%2Fsrc%2Frender%2Fenum_variant.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Fide_completion%2Fsrc%2Frender%2Fenum_variant.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_completion%2Fsrc%2Frender%2Fenum_variant.rs?ref=4ecaad98e074c42dbf637a11afcb630aafffd7b3", "patch": "@@ -6,7 +6,7 @@ use itertools::Itertools;\n \n use crate::{\n     item::{CompletionItem, CompletionKind, ImportEdit},\n-    render::{builder_ext::Params, compute_exact_type_match, compute_ref_match, RenderContext},\n+    render::{builder_ext::Params, compute_ref_match, compute_type_match, RenderContext},\n     CompletionRelevance,\n };\n \n@@ -77,7 +77,7 @@ impl<'a> EnumRender<'a> {\n \n         let ty = self.variant.parent_enum(self.ctx.completion.db).ty(self.ctx.completion.db);\n         item.set_relevance(CompletionRelevance {\n-            exact_type_match: compute_exact_type_match(self.ctx.completion, &ty),\n+            type_match: compute_type_match(self.ctx.completion, &ty),\n             ..CompletionRelevance::default()\n         });\n "}, {"sha": "d681e2c91b404bd518669c2f0c54ccf3da643deb", "filename": "crates/ide_completion/src/render/function.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Fide_completion%2Fsrc%2Frender%2Ffunction.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Fide_completion%2Fsrc%2Frender%2Ffunction.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fide_completion%2Fsrc%2Frender%2Ffunction.rs?ref=4ecaad98e074c42dbf637a11afcb630aafffd7b3", "patch": "@@ -8,7 +8,7 @@ use syntax::ast::Fn;\n use crate::{\n     item::{CompletionItem, CompletionItemKind, CompletionKind, CompletionRelevance, ImportEdit},\n     render::{\n-        builder_ext::Params, compute_exact_name_match, compute_exact_type_match, compute_ref_match,\n+        builder_ext::Params, compute_exact_name_match, compute_ref_match, compute_type_match,\n         RenderContext,\n     },\n };\n@@ -73,7 +73,7 @@ impl<'a> FunctionRender<'a> {\n \n         let ret_type = self.func.ret_type(self.ctx.db());\n         item.set_relevance(CompletionRelevance {\n-            exact_type_match: compute_exact_type_match(self.ctx.completion, &ret_type),\n+            type_match: compute_type_match(self.ctx.completion, &ret_type),\n             exact_name_match: compute_exact_name_match(self.ctx.completion, self.name.clone()),\n             ..CompletionRelevance::default()\n         });"}, {"sha": "530c8a5a4f3ccd06beba07d2886350598b890ec5", "filename": "crates/rust-analyzer/src/to_proto.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Frust-analyzer%2Fsrc%2Fto_proto.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4ecaad98e074c42dbf637a11afcb630aafffd7b3/crates%2Frust-analyzer%2Fsrc%2Fto_proto.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fto_proto.rs?ref=4ecaad98e074c42dbf637a11afcb630aafffd7b3", "patch": "@@ -1138,7 +1138,7 @@ mod tests {\n                 (\n                     \"&arg\",\n                     Some(\n-                        \"fffffffa\",\n+                        \"fffffff9\",\n                     ),\n                 ),\n                 ("}]}