{"sha": "133f97309a82459f751dbf8e3086b73c4d14f23e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjEzM2Y5NzMwOWE4MjQ1OWY3NTFkYmY4ZTMwODZiNzNjNGQxNGYyM2U=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2019-03-02T06:55:26Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2019-03-02T14:58:47Z"}, "message": "Rollup merge of #58852 - alexcrichton:update-netbsd, r=Mark-Simulacrum\n\nUpdate toolchain to build NetBSD release\n\nThis allows us to remove the \"allow old toolchains\" flag we pass to\nLLVM, ensuring that we'll be up to date when LLVM needs us to be!\n\nThis is a follow-up from https://github.com/rust-lang/rust/pull/58408 where NetBSD was explicitly whitelisted to allow older toolchains.", "tree": {"sha": "dd5f6dfdce204f0572fc5dbf63dd4bbaaf4ba23d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/dd5f6dfdce204f0572fc5dbf63dd4bbaaf4ba23d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/133f97309a82459f751dbf8e3086b73c4d14f23e", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlx6micACgkQ/vbIBR0O\nATwVpA/9G6buV35ksr16tAOG2UDTXlyO0ySR5Z4PFqaSSxOCDNMAah48IUJi2uQs\ns1lmkVnVEtB+EejYZlybZyQygBuuPtFWo22Chi/Es1geo3QyMgY+K9pP+976uDJg\n0pTPHldNXWutghRgAlvSP3hQVw0axynseCBucfPvHtS/a0OVDVrU8Crj6/XotB8w\njsA0vyS+VF9Wn1tTK2zVGwHRPEFFQGPER2IRJN5XOCsMVJ81+AbyFTt+jpmu6+sW\nvlb2DbD1+Ipb7URJ1FYybFlt+3awjopqxyeSBKActCMWIg8fEYnC3kxThVsKiGpW\n8tZ3cNec5aHTthEKEMIXa5uYdu8w8R6K4jYAVZqEJAGdpw5euSJxgg8tBjr+xRp3\nyE/qy3N3SIUoYYadOYNfudqA6UkLdIrrAA0cv16Lpz/EUjBtNterUvezUzYyj0vE\nSaU6Uhn9aPgr5BQ0zbnFOJu3zqQEApdbC/ejCNWPHGf+u0JX0Efb6031jlwfk9q0\n1Zyxli6sfGAjGplAy5PtYKxARn6P9608Gvz7+PrDaNChW4IWMGZ9Mwan5mzwqrXx\nTk47eB/12+ei9qH3/1zQ48LcWEMj59DllIQ9xsu5grmUGHUvOIGbX2lGvUvFngJx\njoNdnRh1n0pIBbzxF2Qs4jQBfvduKOOUv7lNZ9CYTMvSm6vODvE=\n=hp6A\n-----END PGP SIGNATURE-----", "payload": "tree dd5f6dfdce204f0572fc5dbf63dd4bbaaf4ba23d\nparent 2e51007350725f3d41288d9321b8192495f83b2b\nparent a7d17bfcd537c89908b59d86f4af1d6137974845\nauthor kennytm <kennytm@gmail.com> 1551509726 +0800\ncommitter kennytm <kennytm@gmail.com> 1551538727 +0800\n\nRollup merge of #58852 - alexcrichton:update-netbsd, r=Mark-Simulacrum\n\nUpdate toolchain to build NetBSD release\n\nThis allows us to remove the \"allow old toolchains\" flag we pass to\nLLVM, ensuring that we'll be up to date when LLVM needs us to be!\n\nThis is a follow-up from https://github.com/rust-lang/rust/pull/58408 where NetBSD was explicitly whitelisted to allow older toolchains.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/133f97309a82459f751dbf8e3086b73c4d14f23e", "html_url": "https://github.com/rust-lang/rust/commit/133f97309a82459f751dbf8e3086b73c4d14f23e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/133f97309a82459f751dbf8e3086b73c4d14f23e/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2e51007350725f3d41288d9321b8192495f83b2b", "url": "https://api.github.com/repos/rust-lang/rust/commits/2e51007350725f3d41288d9321b8192495f83b2b", "html_url": "https://github.com/rust-lang/rust/commit/2e51007350725f3d41288d9321b8192495f83b2b"}, {"sha": "a7d17bfcd537c89908b59d86f4af1d6137974845", "url": "https://api.github.com/repos/rust-lang/rust/commits/a7d17bfcd537c89908b59d86f4af1d6137974845", "html_url": "https://github.com/rust-lang/rust/commit/a7d17bfcd537c89908b59d86f4af1d6137974845"}], "stats": {"total": 32, "additions": 8, "deletions": 24}, "files": [{"sha": "44b1aaa24b19d9747bf4a8ed81cba44533ee7f70", "filename": "src/ci/docker/dist-x86_64-netbsd/Dockerfile", "status": "modified", "additions": 2, "deletions": 18, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/133f97309a82459f751dbf8e3086b73c4d14f23e/src%2Fci%2Fdocker%2Fdist-x86_64-netbsd%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/133f97309a82459f751dbf8e3086b73c4d14f23e/src%2Fci%2Fdocker%2Fdist-x86_64-netbsd%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-x86_64-netbsd%2FDockerfile?ref=133f97309a82459f751dbf8e3086b73c4d14f23e", "patch": "@@ -3,23 +3,8 @@ FROM ubuntu:16.04\n COPY scripts/cross-apt-packages.sh /scripts/\n RUN sh /scripts/cross-apt-packages.sh\n \n-# Ubuntu 16.04 (this container) ships with make 4, but something in the\n-# toolchains we build below chokes on that, so go back to make 3\n-COPY scripts/make3.sh /scripts/\n-RUN sh /scripts/make3.sh\n-\n-COPY scripts/crosstool-ng.sh /scripts/\n-RUN sh /scripts/crosstool-ng.sh\n-\n-COPY scripts/rustbuild-setup.sh /scripts/\n-RUN sh /scripts/rustbuild-setup.sh\n-USER rustbuild\n-WORKDIR /tmp\n-\n COPY dist-x86_64-netbsd/build-netbsd-toolchain.sh /tmp/\n-RUN ./build-netbsd-toolchain.sh\n-\n-USER root\n+RUN /tmp/build-netbsd-toolchain.sh\n \n COPY scripts/sccache.sh /scripts/\n RUN sh /scripts/sccache.sh\n@@ -33,6 +18,5 @@ ENV \\\n \n ENV HOSTS=x86_64-unknown-netbsd\n \n-ENV RUST_CONFIGURE_ARGS --enable-extended --disable-docs \\\n-  --set llvm.allow-old-toolchain\n+ENV RUST_CONFIGURE_ARGS --enable-extended --disable-docs\n ENV SCRIPT python2.7 ../x.py dist --host $HOSTS --target $HOSTS"}, {"sha": "b5377c64b1f546a0b3470d4db5fbfd152903bf4f", "filename": "src/ci/docker/dist-x86_64-netbsd/build-netbsd-toolchain.sh", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/133f97309a82459f751dbf8e3086b73c4d14f23e/src%2Fci%2Fdocker%2Fdist-x86_64-netbsd%2Fbuild-netbsd-toolchain.sh", "raw_url": "https://github.com/rust-lang/rust/raw/133f97309a82459f751dbf8e3086b73c4d14f23e/src%2Fci%2Fdocker%2Fdist-x86_64-netbsd%2Fbuild-netbsd-toolchain.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-x86_64-netbsd%2Fbuild-netbsd-toolchain.sh?ref=133f97309a82459f751dbf8e3086b73c4d14f23e", "patch": "@@ -28,15 +28,15 @@ mkdir -p /x-tools/x86_64-unknown-netbsd/sysroot\n URL=https://s3-us-west-1.amazonaws.com/rust-lang-ci2/rust-ci-mirror\n \n # Originally from ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-$BSD/source/sets/*.tgz\n-curl $URL/2017-03-17-netbsd-src.tgz | tar xzf -\n-curl $URL/2017-03-17-netbsd-gnusrc.tgz | tar xzf -\n-curl $URL/2017-03-17-netbsd-sharesrc.tgz | tar xzf -\n-curl $URL/2017-03-17-netbsd-syssrc.tgz | tar xzf -\n+curl $URL/2018-03-01-netbsd-src.tgz | tar xzf -\n+curl $URL/2018-03-01-netbsd-gnusrc.tgz | tar xzf -\n+curl $URL/2018-03-01-netbsd-sharesrc.tgz | tar xzf -\n+curl $URL/2018-03-01-netbsd-syssrc.tgz | tar xzf -\n \n # Originally from ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-$BSD/amd64/binary/sets/*.tgz\n-curl $URL/2017-03-17-netbsd-base.tgz | \\\n+curl $URL/2018-03-01-netbsd-base.tgz | \\\n   tar xzf - -C /x-tools/x86_64-unknown-netbsd/sysroot ./usr/include ./usr/lib ./lib\n-curl $URL/2017-03-17-netbsd-comp.tgz | \\\n+curl $URL/2018-03-01-netbsd-comp.tgz | \\\n   tar xzf - -C /x-tools/x86_64-unknown-netbsd/sysroot ./usr/include ./usr/lib\n \n cd usr/src"}]}