{"sha": "ff45df2acf8cb31e50930840d48d5285b67b23ec", "node_id": "MDY6Q29tbWl0NzI0NzEyOmZmNDVkZjJhY2Y4Y2IzMWU1MDkzMDg0MGQ0OGQ1Mjg1YjY3YjIzZWM=", "commit": {"author": {"name": "Stein Somers", "email": "git@steinsomers.be", "date": "2020-08-14T14:38:53Z"}, "committer": {"name": "Stein Somers", "email": "git@steinsomers.be", "date": "2020-08-14T15:54:09Z"}, "message": "Move btree unit test to their native, privileged location", "tree": {"sha": "f5ac49aaf5ebd749a8262e1cf1fcfcda6dac4e97", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f5ac49aaf5ebd749a8262e1cf1fcfcda6dac4e97"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ff45df2acf8cb31e50930840d48d5285b67b23ec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ff45df2acf8cb31e50930840d48d5285b67b23ec", "html_url": "https://github.com/rust-lang/rust/commit/ff45df2acf8cb31e50930840d48d5285b67b23ec", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ff45df2acf8cb31e50930840d48d5285b67b23ec/comments", "author": {"login": "ssomers", "id": 10174877, "node_id": "MDQ6VXNlcjEwMTc0ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/10174877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssomers", "html_url": "https://github.com/ssomers", "followers_url": "https://api.github.com/users/ssomers/followers", "following_url": "https://api.github.com/users/ssomers/following{/other_user}", "gists_url": "https://api.github.com/users/ssomers/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssomers/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssomers/subscriptions", "organizations_url": "https://api.github.com/users/ssomers/orgs", "repos_url": "https://api.github.com/users/ssomers/repos", "events_url": "https://api.github.com/users/ssomers/events{/privacy}", "received_events_url": "https://api.github.com/users/ssomers/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ssomers", "id": 10174877, "node_id": "MDQ6VXNlcjEwMTc0ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/10174877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssomers", "html_url": "https://github.com/ssomers", "followers_url": "https://api.github.com/users/ssomers/followers", "following_url": "https://api.github.com/users/ssomers/following{/other_user}", "gists_url": "https://api.github.com/users/ssomers/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssomers/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssomers/subscriptions", "organizations_url": "https://api.github.com/users/ssomers/orgs", "repos_url": "https://api.github.com/users/ssomers/repos", "events_url": "https://api.github.com/users/ssomers/events{/privacy}", "received_events_url": "https://api.github.com/users/ssomers/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8d1c3c116b6a3e26ab23f662fbf03d645068b228", "url": "https://api.github.com/repos/rust-lang/rust/commits/8d1c3c116b6a3e26ab23f662fbf03d645068b228", "html_url": "https://github.com/rust-lang/rust/commit/8d1c3c116b6a3e26ab23f662fbf03d645068b228"}], "stats": {"total": 124, "additions": 68, "deletions": 56}, "files": [{"sha": "567bed2fd67e2a6fae4ee4a6e96975e547918bfb", "filename": "library/alloc/src/collections/btree/map.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/ff45df2acf8cb31e50930840d48d5285b67b23ec/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fmap.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff45df2acf8cb31e50930840d48d5285b67b23ec/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fmap.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fmap.rs?ref=ff45df2acf8cb31e50930840d48d5285b67b23ec", "patch": "@@ -3024,3 +3024,6 @@ impl<K: Ord, V, I: Iterator<Item = (K, V)>> Iterator for MergeIter<K, V, I> {\n         }\n     }\n }\n+\n+#[cfg(test)]\n+mod tests;"}, {"sha": "910e7043092a550c09f2ef40436285eda2d263df", "filename": "library/alloc/src/collections/btree/map/tests.rs", "status": "renamed", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/ff45df2acf8cb31e50930840d48d5285b67b23ec/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fmap%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff45df2acf8cb31e50930840d48d5285b67b23ec/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fmap%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fmap%2Ftests.rs?ref=ff45df2acf8cb31e50930840d48d5285b67b23ec", "patch": "@@ -1,16 +1,20 @@\n-use std::collections::btree_map::Entry::{Occupied, Vacant};\n-use std::collections::BTreeMap;\n+use crate::boxed::Box;\n+use crate::collections::btree_map::Entry::{Occupied, Vacant};\n+use crate::collections::BTreeMap;\n+use crate::fmt::Debug;\n+use crate::rc::Rc;\n+use crate::string::String;\n+use crate::string::ToString;\n+use crate::vec::Vec;\n use std::convert::TryFrom;\n-use std::fmt::Debug;\n use std::iter::FromIterator;\n use std::mem;\n use std::ops::Bound::{self, Excluded, Included, Unbounded};\n use std::ops::RangeBounds;\n use std::panic::{catch_unwind, AssertUnwindSafe};\n-use std::rc::Rc;\n use std::sync::atomic::{AtomicUsize, Ordering};\n \n-use super::DeterministicRng;\n+use super::super::DeterministicRng;\n \n // Value of node::CAPACITY, thus capacity of a tree with a single level,\n // i.e. a tree who's root is a leaf node at height 0.", "previous_filename": "library/alloc/tests/btree/map.rs"}, {"sha": "6c8a588eb58f33db5d98c32d2f53f2cb7695d80a", "filename": "library/alloc/src/collections/btree/mod.rs", "status": "modified", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/ff45df2acf8cb31e50930840d48d5285b67b23ec/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff45df2acf8cb31e50930840d48d5285b67b23ec/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fmod.rs?ref=ff45df2acf8cb31e50930840d48d5285b67b23ec", "patch": "@@ -25,3 +25,30 @@ pub unsafe fn unwrap_unchecked<T>(val: Option<T>) -> T {\n         }\n     })\n }\n+\n+#[cfg(test)]\n+/// XorShiftRng\n+struct DeterministicRng {\n+    x: u32,\n+    y: u32,\n+    z: u32,\n+    w: u32,\n+}\n+\n+#[cfg(test)]\n+impl DeterministicRng {\n+    fn new() -> Self {\n+        DeterministicRng { x: 0x193a6754, y: 0xa8a7d469, z: 0x97830e05, w: 0x113ba7bb }\n+    }\n+\n+    fn next(&mut self) -> u32 {\n+        let x = self.x;\n+        let t = x ^ (x << 11);\n+        self.x = self.y;\n+        self.y = self.z;\n+        self.z = self.w;\n+        let w_ = self.w;\n+        self.w = w_ ^ (w_ >> 19) ^ (t ^ (t >> 8));\n+        self.w\n+    }\n+}"}, {"sha": "a559e87e4e29855956eb15258660871a45afb54b", "filename": "library/alloc/src/collections/btree/set.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/ff45df2acf8cb31e50930840d48d5285b67b23ec/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fset.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff45df2acf8cb31e50930840d48d5285b67b23ec/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fset.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fset.rs?ref=ff45df2acf8cb31e50930840d48d5285b67b23ec", "patch": "@@ -1572,3 +1572,6 @@ impl<'a, T: Ord> Iterator for Union<'a, T> {\n \n #[stable(feature = \"fused\", since = \"1.26.0\")]\n impl<T: Ord> FusedIterator for Union<'_, T> {}\n+\n+#[cfg(test)]\n+mod tests;"}, {"sha": "f4e957e22fe15ae07d0141ae2cc89f3e9bda908a", "filename": "library/alloc/src/collections/btree/set/tests.rs", "status": "renamed", "additions": 3, "deletions": 20, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/ff45df2acf8cb31e50930840d48d5285b67b23ec/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fset%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff45df2acf8cb31e50930840d48d5285b67b23ec/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fset%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Fcollections%2Fbtree%2Fset%2Ftests.rs?ref=ff45df2acf8cb31e50930840d48d5285b67b23ec", "patch": "@@ -1,9 +1,10 @@\n-use std::collections::BTreeSet;\n+use crate::collections::BTreeSet;\n+use crate::vec::Vec;\n use std::iter::FromIterator;\n use std::panic::{catch_unwind, AssertUnwindSafe};\n use std::sync::atomic::{AtomicU32, Ordering};\n \n-use super::DeterministicRng;\n+use super::super::DeterministicRng;\n \n #[test]\n fn test_clone_eq() {\n@@ -15,24 +16,6 @@ fn test_clone_eq() {\n     assert_eq!(m.clone(), m);\n }\n \n-#[test]\n-fn test_hash() {\n-    use crate::hash;\n-\n-    let mut x = BTreeSet::new();\n-    let mut y = BTreeSet::new();\n-\n-    x.insert(1);\n-    x.insert(2);\n-    x.insert(3);\n-\n-    y.insert(3);\n-    y.insert(2);\n-    y.insert(1);\n-\n-    assert_eq!(hash(&x), hash(&y));\n-}\n-\n #[test]\n fn test_iter_min_max() {\n     let mut a = BTreeSet::new();", "previous_filename": "library/alloc/tests/btree/set.rs"}, {"sha": "2d25941a52412187c8a43f1bb03c25fb865eb3ab", "filename": "library/alloc/src/lib.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/ff45df2acf8cb31e50930840d48d5285b67b23ec/library%2Falloc%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff45df2acf8cb31e50930840d48d5285b67b23ec/library%2Falloc%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Fsrc%2Flib.rs?ref=ff45df2acf8cb31e50930840d48d5285b67b23ec", "patch": "@@ -80,6 +80,7 @@\n #![feature(arbitrary_self_types)]\n #![feature(box_patterns)]\n #![feature(box_syntax)]\n+#![feature(btree_drain_filter)]\n #![feature(cfg_sanitize)]\n #![feature(cfg_target_has_atomic)]\n #![feature(coerce_unsized)]\n@@ -102,6 +103,8 @@\n #![feature(lang_items)]\n #![feature(layout_for_ptr)]\n #![feature(libc)]\n+#![feature(map_first_last)]\n+#![feature(map_into_keys_values)]\n #![feature(negative_impls)]\n #![feature(new_uninit)]\n #![feature(nll)]"}, {"sha": "1d08ae13e054011cd3e9f9285539fb15dfc34675", "filename": "library/alloc/tests/btree/mod.rs", "status": "removed", "additions": 0, "deletions": 27, "changes": 27, "blob_url": "https://github.com/rust-lang/rust/blob/8d1c3c116b6a3e26ab23f662fbf03d645068b228/library%2Falloc%2Ftests%2Fbtree%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/8d1c3c116b6a3e26ab23f662fbf03d645068b228/library%2Falloc%2Ftests%2Fbtree%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Ftests%2Fbtree%2Fmod.rs?ref=8d1c3c116b6a3e26ab23f662fbf03d645068b228", "patch": "@@ -1,27 +0,0 @@\n-mod map;\n-mod set;\n-\n-/// XorShiftRng\n-struct DeterministicRng {\n-    x: u32,\n-    y: u32,\n-    z: u32,\n-    w: u32,\n-}\n-\n-impl DeterministicRng {\n-    fn new() -> Self {\n-        DeterministicRng { x: 0x193a6754, y: 0xa8a7d469, z: 0x97830e05, w: 0x113ba7bb }\n-    }\n-\n-    fn next(&mut self) -> u32 {\n-        let x = self.x;\n-        let t = x ^ (x << 11);\n-        self.x = self.y;\n-        self.y = self.z;\n-        self.z = self.w;\n-        let w_ = self.w;\n-        self.w = w_ ^ (w_ >> 19) ^ (t ^ (t >> 8));\n-        self.w\n-    }\n-}"}, {"sha": "e06a95ded94c75dc09577214ea54bc8b71ae921f", "filename": "library/alloc/tests/btree_set_hash.rs", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/ff45df2acf8cb31e50930840d48d5285b67b23ec/library%2Falloc%2Ftests%2Fbtree_set_hash.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff45df2acf8cb31e50930840d48d5285b67b23ec/library%2Falloc%2Ftests%2Fbtree_set_hash.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Ftests%2Fbtree_set_hash.rs?ref=ff45df2acf8cb31e50930840d48d5285b67b23ec", "patch": "@@ -0,0 +1,19 @@\n+use std::collections::BTreeSet;\n+\n+#[test]\n+fn test_hash() {\n+    use crate::hash;\n+\n+    let mut x = BTreeSet::new();\n+    let mut y = BTreeSet::new();\n+\n+    x.insert(1);\n+    x.insert(2);\n+    x.insert(3);\n+\n+    y.insert(3);\n+    y.insert(2);\n+    y.insert(1);\n+\n+    assert_eq!(hash(&x), hash(&y));\n+}"}, {"sha": "f2ba1ab64810b11a73a86d910516e36a3ea4f377", "filename": "library/alloc/tests/lib.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/ff45df2acf8cb31e50930840d48d5285b67b23ec/library%2Falloc%2Ftests%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ff45df2acf8cb31e50930840d48d5285b67b23ec/library%2Falloc%2Ftests%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/library%2Falloc%2Ftests%2Flib.rs?ref=ff45df2acf8cb31e50930840d48d5285b67b23ec", "patch": "@@ -1,10 +1,7 @@\n #![feature(allocator_api)]\n #![feature(box_syntax)]\n-#![feature(btree_drain_filter)]\n #![feature(drain_filter)]\n #![feature(exact_size_is_empty)]\n-#![feature(map_first_last)]\n-#![feature(map_into_keys_values)]\n #![feature(new_uninit)]\n #![feature(pattern)]\n #![feature(str_split_once)]\n@@ -25,7 +22,7 @@ mod arc;\n mod binary_heap;\n mod borrow;\n mod boxed;\n-mod btree;\n+mod btree_set_hash;\n mod cow_str;\n mod fmt;\n mod heap;"}]}