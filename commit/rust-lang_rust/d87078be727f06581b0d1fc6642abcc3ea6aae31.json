{"sha": "d87078be727f06581b0d1fc6642abcc3ea6aae31", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQ4NzA3OGJlNzI3ZjA2NTgxYjBkMWZjNjY0MmFiY2MzZWE2YWFlMzE=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-09-16T09:45:49Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2013-09-16T09:45:49Z"}, "message": "auto merge of #9206 : alexcrichton/rust/issue-9188, r=catamorphism\n\nWhile they may have the same name within various scopes, this changes static\r\nnames to use path_pretty_name to append some hash information at the end of the\r\nsymbol. We're then guaranteed that each static has a unique NodeId, so this\r\nNodeId is as the \"hash\" of the pretty name.\r\n\r\nCloses #9188", "tree": {"sha": "fac0fec90d3a14c7314acc5cedf9aabdc05549ec", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/fac0fec90d3a14c7314acc5cedf9aabdc05549ec"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d87078be727f06581b0d1fc6642abcc3ea6aae31", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d87078be727f06581b0d1fc6642abcc3ea6aae31", "html_url": "https://github.com/rust-lang/rust/commit/d87078be727f06581b0d1fc6642abcc3ea6aae31", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d87078be727f06581b0d1fc6642abcc3ea6aae31/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "610c0cdf11ea350793fa9a7b9d0af96f8ed5ab94", "url": "https://api.github.com/repos/rust-lang/rust/commits/610c0cdf11ea350793fa9a7b9d0af96f8ed5ab94", "html_url": "https://github.com/rust-lang/rust/commit/610c0cdf11ea350793fa9a7b9d0af96f8ed5ab94"}, {"sha": "1da4488d8713a4190f110407470f57ddec42ec62", "url": "https://api.github.com/repos/rust-lang/rust/commits/1da4488d8713a4190f110407470f57ddec42ec62", "html_url": "https://github.com/rust-lang/rust/commit/1da4488d8713a4190f110407470f57ddec42ec62"}], "stats": {"total": 51, "additions": 49, "deletions": 2}, "files": [{"sha": "692e4e345df63fb84ea128c48c226141b1fb5dca", "filename": "src/librustc/metadata/encoder.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d87078be727f06581b0d1fc6642abcc3ea6aae31/src%2Flibrustc%2Fmetadata%2Fencoder.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d87078be727f06581b0d1fc6642abcc3ea6aae31/src%2Flibrustc%2Fmetadata%2Fencoder.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmetadata%2Fencoder.rs?ref=d87078be727f06581b0d1fc6642abcc3ea6aae31", "patch": "@@ -905,7 +905,8 @@ fn encode_info_for_item(ecx: &EncodeContext,\n         encode_type(ecx, ebml_w, node_id_to_type(tcx, item.id));\n         encode_symbol(ecx, ebml_w, item.id);\n         encode_name(ecx, ebml_w, item.ident);\n-        encode_path(ecx, ebml_w, path, ast_map::path_name(item.ident));\n+        let elt = ast_map::path_pretty_name(item.ident, item.id as u64);\n+        encode_path(ecx, ebml_w, path, elt);\n         (ecx.encode_inlined_item)(ecx, ebml_w, path, ii_item(item));\n         ebml_w.end_tag();\n       }"}, {"sha": "f0238e8f5c5501ee25fb5b9efba97ec386393c21", "filename": "src/librustc/middle/trans/base.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/d87078be727f06581b0d1fc6642abcc3ea6aae31/src%2Flibrustc%2Fmiddle%2Ftrans%2Fbase.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d87078be727f06581b0d1fc6642abcc3ea6aae31/src%2Flibrustc%2Fmiddle%2Ftrans%2Fbase.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Ftrans%2Fbase.rs?ref=d87078be727f06581b0d1fc6642abcc3ea6aae31", "patch": "@@ -2488,7 +2488,8 @@ pub fn get_item_val(ccx: @mut CrateContext, id: ast::NodeId) -> ValueRef {\n             let val = match item {\n                 ast_map::node_item(i, pth) => {\n \n-                    let my_path = vec::append((*pth).clone(), [path_name(i.ident)]);\n+                    let elt = path_pretty_name(i.ident, id as u64);\n+                    let my_path = vec::append_one((*pth).clone(), elt);\n                     let ty = ty::node_id_to_type(ccx.tcx, i.id);\n                     let sym = exported_name(ccx, my_path, ty, i.attrs);\n "}, {"sha": "5f5a8f02fd9d16191bafec4e9b5f218c564309b8", "filename": "src/test/auxiliary/issue_9188.rs", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/rust-lang/rust/blob/d87078be727f06581b0d1fc6642abcc3ea6aae31/src%2Ftest%2Fauxiliary%2Fissue_9188.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d87078be727f06581b0d1fc6642abcc3ea6aae31/src%2Ftest%2Fauxiliary%2Fissue_9188.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fauxiliary%2Fissue_9188.rs?ref=d87078be727f06581b0d1fc6642abcc3ea6aae31", "patch": "@@ -0,0 +1,24 @@\n+// Copyright 2013 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+pub fn foo<T>() -> &'static int {\n+    if false {\n+        static a: int = 4;\n+        return &a;\n+    } else {\n+        static a: int = 5;\n+        return &a;\n+    }\n+}\n+\n+pub fn bar() -> &'static int {\n+    foo::<int>()\n+}\n+"}, {"sha": "7cfa230766cfa36cf93a4811a6dc1c688c6c975f", "filename": "src/test/run-pass/issue-9188.rs", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/d87078be727f06581b0d1fc6642abcc3ea6aae31/src%2Ftest%2Frun-pass%2Fissue-9188.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d87078be727f06581b0d1fc6642abcc3ea6aae31/src%2Ftest%2Frun-pass%2Fissue-9188.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fissue-9188.rs?ref=d87078be727f06581b0d1fc6642abcc3ea6aae31", "patch": "@@ -0,0 +1,21 @@\n+// Copyright 2013 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// aux-build:issue_9188.rs\n+// xfail-fast windows doesn't like aux-build\n+\n+extern mod issue_9188;\n+\n+fn main() {\n+    let a = issue_9188::bar();\n+    let b = issue_9188::foo::<int>();\n+    assert_eq!(*a, *b);\n+}\n+"}]}