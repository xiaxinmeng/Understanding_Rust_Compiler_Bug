{"sha": "555c4ae37560493fd901aad41951ad1664043459", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU1NWM0YWUzNzU2MDQ5M2ZkOTAxYWFkNDE5NTFhZDE2NjQwNDM0NTk=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-02-11T08:37:08Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2018-02-11T08:37:08Z"}, "message": "G: slice & array types", "tree": {"sha": "89a260412886182f2a4f571694cfbff734f1dc3d", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/89a260412886182f2a4f571694cfbff734f1dc3d"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/555c4ae37560493fd901aad41951ad1664043459", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/555c4ae37560493fd901aad41951ad1664043459", "html_url": "https://github.com/rust-lang/rust/commit/555c4ae37560493fd901aad41951ad1664043459", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/555c4ae37560493fd901aad41951ad1664043459/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ceb94ece2aa6a1b54063c582663fff4c1937d989", "url": "https://api.github.com/repos/rust-lang/rust/commits/ceb94ece2aa6a1b54063c582663fff4c1937d989", "html_url": "https://github.com/rust-lang/rust/commit/ceb94ece2aa6a1b54063c582663fff4c1937d989"}], "stats": {"total": 108, "additions": 108, "deletions": 0}, "files": [{"sha": "bc7dd7c55301e8508bf824d2149c87fab892e8e1", "filename": "grammar.ron", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/555c4ae37560493fd901aad41951ad1664043459/grammar.ron", "raw_url": "https://github.com/rust-lang/rust/raw/555c4ae37560493fd901aad41951ad1664043459/grammar.ron", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/grammar.ron?ref=555c4ae37560493fd901aad41951ad1664043459", "patch": "@@ -106,6 +106,8 @@ Grammar(\n         \"NEVER_TYPE\",\n         \"PATH_TYPE\",\n         \"POINTER_TYPE\",\n+        \"ARRAY_TYPE\",\n+        \"SLICE_TYPE\",\n \n         \"EXTERN_BLOCK\",\n         \"ENUM_VARIANT\","}, {"sha": "4eb333b54e5e1239dbbef42fcb08aa31b68fe0db", "filename": "src/parser/grammar/types.rs", "status": "modified", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/555c4ae37560493fd901aad41951ad1664043459/src%2Fparser%2Fgrammar%2Ftypes.rs", "raw_url": "https://github.com/rust-lang/rust/raw/555c4ae37560493fd901aad41951ad1664043459/src%2Fparser%2Fgrammar%2Ftypes.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fparser%2Fgrammar%2Ftypes.rs?ref=555c4ae37560493fd901aad41951ad1664043459", "patch": "@@ -5,6 +5,7 @@ pub(super) fn type_(p: &mut Parser) {\n         L_PAREN => paren_or_tuple_type(p),\n         EXCL => never_type(p),\n         STAR => pointer_type(p),\n+        L_BRACK => array_or_slice_type(p),\n         IDENT => path_type(p),\n         _ => {\n             p.error(\"expected type\");\n@@ -82,6 +83,38 @@ fn pointer_type(p: &mut Parser) {\n     m.complete(p, POINTER_TYPE);\n }\n \n+fn array_or_slice_type(p: &mut Parser) {\n+    assert!(p.at(L_BRACK));\n+    let m = p.start();\n+    p.bump();\n+\n+    type_(p);\n+    let kind = match p.current() {\n+        // test slice_type\n+        // type T = [()];\n+        R_BRACK => {\n+            p.bump();\n+            SLICE_TYPE\n+        },\n+\n+        // test array_type\n+        // type T = [(); 92];\n+        SEMI => {\n+            p.bump();\n+            expressions::expr(p);\n+            p.expect(R_BRACK);\n+            ARRAY_TYPE\n+        }\n+        // test array_type_missing_semi\n+        // type T = [() 92];\n+        _ => {\n+            p.error(\"expected `;` or `]`\");\n+            SLICE_TYPE\n+        }\n+    };\n+    m.complete(p, kind);\n+}\n+\n fn path_type(p: &mut Parser) {\n     assert!(p.at(IDENT));\n     let m = p.start();"}, {"sha": "54200f2d1f463fcc78533c5aec9789560703e683", "filename": "src/syntax_kinds.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/555c4ae37560493fd901aad41951ad1664043459/src%2Fsyntax_kinds.rs", "raw_url": "https://github.com/rust-lang/rust/raw/555c4ae37560493fd901aad41951ad1664043459/src%2Fsyntax_kinds.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fsyntax_kinds.rs?ref=555c4ae37560493fd901aad41951ad1664043459", "patch": "@@ -104,6 +104,8 @@ pub enum SyntaxKind {\n     NEVER_TYPE,\n     PATH_TYPE,\n     POINTER_TYPE,\n+    ARRAY_TYPE,\n+    SLICE_TYPE,\n     EXTERN_BLOCK,\n     ENUM_VARIANT,\n     NAMED_FIELD,\n@@ -234,6 +236,8 @@ impl SyntaxKind {\n             NEVER_TYPE => &SyntaxInfo { name: \"NEVER_TYPE\" },\n             PATH_TYPE => &SyntaxInfo { name: \"PATH_TYPE\" },\n             POINTER_TYPE => &SyntaxInfo { name: \"POINTER_TYPE\" },\n+            ARRAY_TYPE => &SyntaxInfo { name: \"ARRAY_TYPE\" },\n+            SLICE_TYPE => &SyntaxInfo { name: \"SLICE_TYPE\" },\n             EXTERN_BLOCK => &SyntaxInfo { name: \"EXTERN_BLOCK\" },\n             ENUM_VARIANT => &SyntaxInfo { name: \"ENUM_VARIANT\" },\n             NAMED_FIELD => &SyntaxInfo { name: \"NAMED_FIELD\" },"}, {"sha": "a948514432072a1afa7958d7abb809e2231d607e", "filename": "tests/data/parser/inline/0023_array_type_missing_semi.rs", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/555c4ae37560493fd901aad41951ad1664043459/tests%2Fdata%2Fparser%2Finline%2F0023_array_type_missing_semi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/555c4ae37560493fd901aad41951ad1664043459/tests%2Fdata%2Fparser%2Finline%2F0023_array_type_missing_semi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Finline%2F0023_array_type_missing_semi.rs?ref=555c4ae37560493fd901aad41951ad1664043459", "patch": "@@ -0,0 +1 @@\n+type T = [() 92];"}, {"sha": "bb30a2a2a797537ccc31d7d1e169f785451362d6", "filename": "tests/data/parser/inline/0023_array_type_missing_semi.txt", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/rust-lang/rust/blob/555c4ae37560493fd901aad41951ad1664043459/tests%2Fdata%2Fparser%2Finline%2F0023_array_type_missing_semi.txt", "raw_url": "https://github.com/rust-lang/rust/raw/555c4ae37560493fd901aad41951ad1664043459/tests%2Fdata%2Fparser%2Finline%2F0023_array_type_missing_semi.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Finline%2F0023_array_type_missing_semi.txt?ref=555c4ae37560493fd901aad41951ad1664043459", "patch": "@@ -0,0 +1,28 @@\n+FILE@[0; 18)\n+  TYPE_ITEM@[0; 13)\n+    TYPE_KW@[0; 4)\n+    NAME@[4; 7)\n+      WHITESPACE@[4; 5)\n+      IDENT@[5; 6) \"T\"\n+      WHITESPACE@[6; 7)\n+    EQ@[7; 8)\n+    SLICE_TYPE@[8; 13)\n+      WHITESPACE@[8; 9)\n+      L_BRACK@[9; 10)\n+      TUPLE_TYPE@[10; 13)\n+        L_PAREN@[10; 11)\n+        R_PAREN@[11; 12)\n+        WHITESPACE@[12; 13)\n+      err: `expected `;` or `]``\n+    err: `expected SEMI`\n+  ERROR@[13; 15)\n+  err: `expected item`\n+    INT_NUMBER@[13; 15)\n+  ERROR@[15; 16)\n+  err: `expected item`\n+    R_BRACK@[15; 16)\n+  ERROR@[16; 18)\n+  err: `expected item, found `;`\n+consider removing this semicolon`\n+    SEMI@[16; 17)\n+    WHITESPACE@[17; 18)"}, {"sha": "27eb22f2238adf1e5f7a34f5640dcb83ff7e3117", "filename": "tests/data/parser/inline/0024_array_type.rs", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/555c4ae37560493fd901aad41951ad1664043459/tests%2Fdata%2Fparser%2Finline%2F0024_array_type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/555c4ae37560493fd901aad41951ad1664043459/tests%2Fdata%2Fparser%2Finline%2F0024_array_type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Finline%2F0024_array_type.rs?ref=555c4ae37560493fd901aad41951ad1664043459", "patch": "@@ -0,0 +1 @@\n+type T = [(); 92];"}, {"sha": "970734a19845feba94c3b8900b62e96a1dbbb012", "filename": "tests/data/parser/inline/0024_array_type.txt", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/555c4ae37560493fd901aad41951ad1664043459/tests%2Fdata%2Fparser%2Finline%2F0024_array_type.txt", "raw_url": "https://github.com/rust-lang/rust/raw/555c4ae37560493fd901aad41951ad1664043459/tests%2Fdata%2Fparser%2Finline%2F0024_array_type.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Finline%2F0024_array_type.txt?ref=555c4ae37560493fd901aad41951ad1664043459", "patch": "@@ -0,0 +1,21 @@\n+FILE@[0; 19)\n+  TYPE_ITEM@[0; 19)\n+    TYPE_KW@[0; 4)\n+    NAME@[4; 7)\n+      WHITESPACE@[4; 5)\n+      IDENT@[5; 6) \"T\"\n+      WHITESPACE@[6; 7)\n+    EQ@[7; 8)\n+    ARRAY_TYPE@[8; 17)\n+      WHITESPACE@[8; 9)\n+      L_BRACK@[9; 10)\n+      TUPLE_TYPE@[10; 12)\n+        L_PAREN@[10; 11)\n+        R_PAREN@[11; 12)\n+      SEMI@[12; 13)\n+      LITERAL@[13; 16)\n+        WHITESPACE@[13; 14)\n+        INT_NUMBER@[14; 16)\n+      R_BRACK@[16; 17)\n+    SEMI@[17; 18)\n+    WHITESPACE@[18; 19)"}, {"sha": "4da1af827057134f394140e406c931287580441a", "filename": "tests/data/parser/inline/0025_slice_type.rs", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/555c4ae37560493fd901aad41951ad1664043459/tests%2Fdata%2Fparser%2Finline%2F0025_slice_type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/555c4ae37560493fd901aad41951ad1664043459/tests%2Fdata%2Fparser%2Finline%2F0025_slice_type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Finline%2F0025_slice_type.rs?ref=555c4ae37560493fd901aad41951ad1664043459", "patch": "@@ -0,0 +1 @@\n+type T = [()];"}, {"sha": "22938e5e1d8701ed3b67125c6992372addfdb82f", "filename": "tests/data/parser/inline/0025_slice_type.txt", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/555c4ae37560493fd901aad41951ad1664043459/tests%2Fdata%2Fparser%2Finline%2F0025_slice_type.txt", "raw_url": "https://github.com/rust-lang/rust/raw/555c4ae37560493fd901aad41951ad1664043459/tests%2Fdata%2Fparser%2Finline%2F0025_slice_type.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/tests%2Fdata%2Fparser%2Finline%2F0025_slice_type.txt?ref=555c4ae37560493fd901aad41951ad1664043459", "patch": "@@ -0,0 +1,17 @@\n+FILE@[0; 15)\n+  TYPE_ITEM@[0; 15)\n+    TYPE_KW@[0; 4)\n+    NAME@[4; 7)\n+      WHITESPACE@[4; 5)\n+      IDENT@[5; 6) \"T\"\n+      WHITESPACE@[6; 7)\n+    EQ@[7; 8)\n+    SLICE_TYPE@[8; 13)\n+      WHITESPACE@[8; 9)\n+      L_BRACK@[9; 10)\n+      TUPLE_TYPE@[10; 12)\n+        L_PAREN@[10; 11)\n+        R_PAREN@[11; 12)\n+      R_BRACK@[12; 13)\n+    SEMI@[13; 14)\n+    WHITESPACE@[14; 15)"}]}