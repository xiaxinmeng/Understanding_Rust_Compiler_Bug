{"sha": "b74d6922ff15d9f3bf39d317ccd7141518f4f5ec", "node_id": "MDY6Q29tbWl0NzI0NzEyOmI3NGQ2OTIyZmYxNWQ5ZjNiZjM5ZDMxN2NjZDcxNDE1MThmNGY1ZWM=", "commit": {"author": {"name": "Michael Lamparski", "email": "diagonaldevice@gmail.com", "date": "2018-04-16T20:34:09Z"}, "committer": {"name": "Michael Lamparski", "email": "diagonaldevice@gmail.com", "date": "2018-04-18T01:31:35Z"}, "message": "smaller PR just to fix #50002", "tree": {"sha": "70be92ac0bfff57432121221c5f1a6618de2aa44", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/70be92ac0bfff57432121221c5f1a6618de2aa44"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/b74d6922ff15d9f3bf39d317ccd7141518f4f5ec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/b74d6922ff15d9f3bf39d317ccd7141518f4f5ec", "html_url": "https://github.com/rust-lang/rust/commit/b74d6922ff15d9f3bf39d317ccd7141518f4f5ec", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/b74d6922ff15d9f3bf39d317ccd7141518f4f5ec/comments", "author": {"login": "ExpHP", "id": 1411280, "node_id": "MDQ6VXNlcjE0MTEyODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1411280?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ExpHP", "html_url": "https://github.com/ExpHP", "followers_url": "https://api.github.com/users/ExpHP/followers", "following_url": "https://api.github.com/users/ExpHP/following{/other_user}", "gists_url": "https://api.github.com/users/ExpHP/gists{/gist_id}", "starred_url": "https://api.github.com/users/ExpHP/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ExpHP/subscriptions", "organizations_url": "https://api.github.com/users/ExpHP/orgs", "repos_url": "https://api.github.com/users/ExpHP/repos", "events_url": "https://api.github.com/users/ExpHP/events{/privacy}", "received_events_url": "https://api.github.com/users/ExpHP/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ExpHP", "id": 1411280, "node_id": "MDQ6VXNlcjE0MTEyODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1411280?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ExpHP", "html_url": "https://github.com/ExpHP", "followers_url": "https://api.github.com/users/ExpHP/followers", "following_url": "https://api.github.com/users/ExpHP/following{/other_user}", "gists_url": "https://api.github.com/users/ExpHP/gists{/gist_id}", "starred_url": "https://api.github.com/users/ExpHP/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ExpHP/subscriptions", "organizations_url": "https://api.github.com/users/ExpHP/orgs", "repos_url": "https://api.github.com/users/ExpHP/repos", "events_url": "https://api.github.com/users/ExpHP/events{/privacy}", "received_events_url": "https://api.github.com/users/ExpHP/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9a59133c09980122ce026d20e7832d63b106a927", "url": "https://api.github.com/repos/rust-lang/rust/commits/9a59133c09980122ce026d20e7832d63b106a927", "html_url": "https://github.com/rust-lang/rust/commit/9a59133c09980122ce026d20e7832d63b106a927"}], "stats": {"total": 25, "additions": 18, "deletions": 7}, "files": [{"sha": "e3f198f73623228a263d7ed4b9a6e2704258e818", "filename": "src/liballoc/tests/str.rs", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/b74d6922ff15d9f3bf39d317ccd7141518f4f5ec/src%2Fliballoc%2Ftests%2Fstr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b74d6922ff15d9f3bf39d317ccd7141518f4f5ec/src%2Fliballoc%2Ftests%2Fstr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliballoc%2Ftests%2Fstr.rs?ref=b74d6922ff15d9f3bf39d317ccd7141518f4f5ec", "patch": "@@ -401,6 +401,22 @@ fn test_str_get_maxinclusive() {\n     }\n }\n \n+#[test]\n+fn test_str_slicemut_rangetoinclusive_ok() {\n+    let mut s = \"abc\u03b1\u03b2\u03b3\".to_owned();\n+    let s: &mut str = &mut s;\n+    &mut s[..=3]; // before alpha\n+    &mut s[..=5]; // after alpha\n+}\n+\n+#[test]\n+#[should_panic]\n+fn test_str_slicemut_rangetoinclusive_notok() {\n+    let mut s = \"abc\u03b1\u03b2\u03b3\".to_owned();\n+    let s: &mut str = &mut s;\n+    &mut s[..=4]; // middle of alpha, which is 2 bytes long\n+}\n+\n #[test]\n fn test_is_char_boundary() {\n     let s = \"\u0e28\u0e44\u0e17\u0e22\u4e2d\u534eVi\u1ec7t Nam \u03b2-release \ud83d\udc31123\";"}, {"sha": "5b52119d0310abccd0035239fe33f5c427e7db4d", "filename": "src/libcore/str/mod.rs", "status": "modified", "additions": 2, "deletions": 7, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/b74d6922ff15d9f3bf39d317ccd7141518f4f5ec/src%2Flibcore%2Fstr%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b74d6922ff15d9f3bf39d317ccd7141518f4f5ec/src%2Flibcore%2Fstr%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fstr%2Fmod.rs?ref=b74d6922ff15d9f3bf39d317ccd7141518f4f5ec", "patch": "@@ -2100,18 +2100,13 @@ mod traits {\n         fn index(self, slice: &str) -> &Self::Output {\n             assert!(self.end != usize::max_value(),\n                 \"attempted to index str up to maximum usize\");\n-            let end = self.end + 1;\n-            self.get(slice).unwrap_or_else(|| super::slice_error_fail(slice, 0, end))\n+            (..self.end+1).index(slice)\n         }\n         #[inline]\n         fn index_mut(self, slice: &mut str) -> &mut Self::Output {\n             assert!(self.end != usize::max_value(),\n                 \"attempted to index str up to maximum usize\");\n-            if slice.is_char_boundary(self.end) {\n-                unsafe { self.get_unchecked_mut(slice) }\n-            } else {\n-                super::slice_error_fail(slice, 0, self.end + 1)\n-            }\n+            (..self.end+1).index_mut(slice)\n         }\n     }\n "}]}