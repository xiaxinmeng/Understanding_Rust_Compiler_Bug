{"sha": "54bdfa125722c9ee6fadb61818f861b1102fd300", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU0YmRmYTEyNTcyMmM5ZWU2ZmFkYjYxODE4Zjg2MWIxMTAyZmQzMDA=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-05-26T04:27:23Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2021-05-26T04:27:23Z"}, "message": "Auto merge of #85252 - kulikjak:fix-solaris-CI, r=Mark-Simulacrum\n\nBring back `x86_64-sun-solaris` target to rustup\n\nChange #82216 removed now deprecated target `x86_64-sun-solaris` from CI, thus making it no longer possible to use `$ rustup target add x86_64-sun-solaris` to install given target (see #85098 for details). Since there should be a period of time between the deprecation and removal, this PR brings it back (while keeping the new one as well).\n\nPlease, correct me if I am wrong; my assumption that these Docker scripts are being used to build artifacts later used by `rustup` might be incorrect.\n\nCloses #85098.", "tree": {"sha": "eb3be9ddf24c3042abea3bad0eda564b74d1b793", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/eb3be9ddf24c3042abea3bad0eda564b74d1b793"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/54bdfa125722c9ee6fadb61818f861b1102fd300", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/54bdfa125722c9ee6fadb61818f861b1102fd300", "html_url": "https://github.com/rust-lang/rust/commit/54bdfa125722c9ee6fadb61818f861b1102fd300", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/54bdfa125722c9ee6fadb61818f861b1102fd300/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "47a90f452050d4ea484206447babb07dd33c21d5", "url": "https://api.github.com/repos/rust-lang/rust/commits/47a90f452050d4ea484206447babb07dd33c21d5", "html_url": "https://github.com/rust-lang/rust/commit/47a90f452050d4ea484206447babb07dd33c21d5"}, {"sha": "b13185de8de511c75846ae62f01b4aa6c79e1230", "url": "https://api.github.com/repos/rust-lang/rust/commits/b13185de8de511c75846ae62f01b4aa6c79e1230", "html_url": "https://github.com/rust-lang/rust/commit/b13185de8de511c75846ae62f01b4aa6c79e1230"}], "stats": {"total": 24, "additions": 10, "deletions": 14}, "files": [{"sha": "b7f181adf2a09375b574806d310bb1787a5be322", "filename": "src/ci/docker/host-x86_64/dist-various-2/Dockerfile", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/54bdfa125722c9ee6fadb61818f861b1102fd300/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-2%2FDockerfile", "raw_url": "https://github.com/rust-lang/rust/raw/54bdfa125722c9ee6fadb61818f861b1102fd300/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-2%2FDockerfile", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-2%2FDockerfile?ref=54bdfa125722c9ee6fadb61818f861b1102fd300", "patch": "@@ -42,6 +42,9 @@ ENV \\\n     AR_x86_64_pc_solaris=x86_64-pc-solaris2.10-ar \\\n     CC_x86_64_pc_solaris=x86_64-pc-solaris2.10-gcc \\\n     CXX_x86_64_pc_solaris=x86_64-pc-solaris2.10-g++ \\\n+    AR_x86_64_sun_solaris=x86_64-sun-solaris2.10-ar \\\n+    CC_x86_64_sun_solaris=x86_64-sun-solaris2.10-gcc \\\n+    CXX_x86_64_sun_solaris=x86_64-sun-solaris2.10-g++ \\\n     CC_armv7_unknown_linux_gnueabi=arm-linux-gnueabi-gcc-8 \\\n     CXX_armv7_unknown_linux_gnueabi=arm-linux-gnueabi-g++-8 \\\n     AR_x86_64_fortanix_unknown_sgx=ar \\\n@@ -68,8 +71,10 @@ COPY host-x86_64/dist-various-2/shared.sh /tmp/\n COPY host-x86_64/dist-various-2/build-fuchsia-toolchain.sh /tmp/\n RUN /tmp/build-fuchsia-toolchain.sh\n COPY host-x86_64/dist-various-2/build-solaris-toolchain.sh /tmp/\n-RUN /tmp/build-solaris-toolchain.sh x86_64  amd64   solaris-i386\n-RUN /tmp/build-solaris-toolchain.sh sparcv9 sparcv9 solaris-sparc\n+RUN /tmp/build-solaris-toolchain.sh x86_64  amd64   solaris-i386  pc\n+# Build deprecated target 'x86_64-sun-solaris2.10' until removed\n+RUN /tmp/build-solaris-toolchain.sh x86_64  amd64   solaris-i386  sun\n+RUN /tmp/build-solaris-toolchain.sh sparcv9 sparcv9 solaris-sparc sun\n COPY host-x86_64/dist-various-2/build-x86_64-fortanix-unknown-sgx-toolchain.sh /tmp/\n RUN /tmp/build-x86_64-fortanix-unknown-sgx-toolchain.sh\n \n@@ -99,6 +104,7 @@ ENV TARGETS=$TARGETS,wasm32-unknown-unknown\n ENV TARGETS=$TARGETS,wasm32-wasi\n ENV TARGETS=$TARGETS,sparcv9-sun-solaris\n ENV TARGETS=$TARGETS,x86_64-pc-solaris\n+ENV TARGETS=$TARGETS,x86_64-sun-solaris\n ENV TARGETS=$TARGETS,x86_64-unknown-linux-gnux32\n ENV TARGETS=$TARGETS,x86_64-fortanix-unknown-sgx\n ENV TARGETS=$TARGETS,nvptx64-nvidia-cuda"}, {"sha": "4cbc2ccfe3814c7164f5fc66050604d2b261b16b", "filename": "src/ci/docker/host-x86_64/dist-various-2/build-solaris-toolchain.sh", "status": "modified", "additions": 2, "deletions": 12, "changes": 14, "blob_url": "https://github.com/rust-lang/rust/blob/54bdfa125722c9ee6fadb61818f861b1102fd300/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-2%2Fbuild-solaris-toolchain.sh", "raw_url": "https://github.com/rust-lang/rust/raw/54bdfa125722c9ee6fadb61818f861b1102fd300/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-2%2Fbuild-solaris-toolchain.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fhost-x86_64%2Fdist-various-2%2Fbuild-solaris-toolchain.sh?ref=54bdfa125722c9ee6fadb61818f861b1102fd300", "patch": "@@ -6,21 +6,11 @@ source shared.sh\n ARCH=$1\n LIB_ARCH=$2\n APT_ARCH=$3\n+MANUFACTURER=$4\n BINUTILS=2.28.1\n GCC=6.5.0\n \n-# Choose correct target based on the $ARCH\n-case \"$ARCH\" in\n-x86_64)\n-  TARGET=x86_64-pc-solaris2.10\n-  ;;\n-sparcv9)\n-  TARGET=sparcv9-sun-solaris2.10\n-  ;;\n-*)\n-  printf 'ERROR: unknown architecture: %s\\n' \"$ARCH\"\n-  exit 1\n-esac\n+TARGET=${ARCH}-${MANUFACTURER}-solaris2.10\n \n # First up, build binutils\n mkdir binutils"}]}