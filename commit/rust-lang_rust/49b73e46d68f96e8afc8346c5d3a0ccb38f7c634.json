{"sha": "49b73e46d68f96e8afc8346c5d3a0ccb38f7c634", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ5YjczZTQ2ZDY4Zjk2ZThhZmM4MzQ2YzVkM2EwY2NiMzhmN2M2MzQ=", "commit": {"author": {"name": "Mathieu David", "email": "mathieudavid@mathieudavid.org", "date": "2015-06-30T07:32:15Z"}, "committer": {"name": "Mathieu David", "email": "mathieudavid@mathieudavid.org", "date": "2015-07-01T08:11:23Z"}, "message": "In js from the docs, change keyboard eventlistener to be compatible with non-english keyboard layouts. Fixes #26016 Fixes #16572", "tree": {"sha": "f362f378e45c553d8ff975943e1406e792413ec4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/f362f378e45c553d8ff975943e1406e792413ec4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/49b73e46d68f96e8afc8346c5d3a0ccb38f7c634", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/49b73e46d68f96e8afc8346c5d3a0ccb38f7c634", "html_url": "https://github.com/rust-lang/rust/commit/49b73e46d68f96e8afc8346c5d3a0ccb38f7c634", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/49b73e46d68f96e8afc8346c5d3a0ccb38f7c634/comments", "author": {"login": "azerupi", "id": 7647338, "node_id": "MDQ6VXNlcjc2NDczMzg=", "avatar_url": "https://avatars.githubusercontent.com/u/7647338?v=4", "gravatar_id": "", "url": "https://api.github.com/users/azerupi", "html_url": "https://github.com/azerupi", "followers_url": "https://api.github.com/users/azerupi/followers", "following_url": "https://api.github.com/users/azerupi/following{/other_user}", "gists_url": "https://api.github.com/users/azerupi/gists{/gist_id}", "starred_url": "https://api.github.com/users/azerupi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/azerupi/subscriptions", "organizations_url": "https://api.github.com/users/azerupi/orgs", "repos_url": "https://api.github.com/users/azerupi/repos", "events_url": "https://api.github.com/users/azerupi/events{/privacy}", "received_events_url": "https://api.github.com/users/azerupi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "azerupi", "id": 7647338, "node_id": "MDQ6VXNlcjc2NDczMzg=", "avatar_url": "https://avatars.githubusercontent.com/u/7647338?v=4", "gravatar_id": "", "url": "https://api.github.com/users/azerupi", "html_url": "https://github.com/azerupi", "followers_url": "https://api.github.com/users/azerupi/followers", "following_url": "https://api.github.com/users/azerupi/following{/other_user}", "gists_url": "https://api.github.com/users/azerupi/gists{/gist_id}", "starred_url": "https://api.github.com/users/azerupi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/azerupi/subscriptions", "organizations_url": "https://api.github.com/users/azerupi/orgs", "repos_url": "https://api.github.com/users/azerupi/repos", "events_url": "https://api.github.com/users/azerupi/events{/privacy}", "received_events_url": "https://api.github.com/users/azerupi/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "27975c49a643d0b2f8cbcd7854931c4c9a8c5dbf", "url": "https://api.github.com/repos/rust-lang/rust/commits/27975c49a643d0b2f8cbcd7854931c4c9a8c5dbf", "html_url": "https://github.com/rust-lang/rust/commit/27975c49a643d0b2f8cbcd7854931c4c9a8c5dbf"}], "stats": {"total": 39, "additions": 33, "deletions": 6}, "files": [{"sha": "4a033452774666d272202816643a7da7a4f972d4", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 33, "deletions": 6, "changes": 39, "blob_url": "https://github.com/rust-lang/rust/blob/49b73e46d68f96e8afc8346c5d3a0ccb38f7c634/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/49b73e46d68f96e8afc8346c5d3a0ccb38f7c634/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=49b73e46d68f96e8afc8346c5d3a0ccb38f7c634", "patch": "@@ -76,17 +76,46 @@\n     highlightSourceLines(null);\n     $(window).on('hashchange', highlightSourceLines);\n \n-    $(document).on('keyup', function handleKeyboardShortcut(e) {\n+    // Helper function for Keyboard events,\n+    // Get's the char from the keypress event\n+    //\n+    // This method is used because e.wich === x is not\n+    // compatible with non-english keyboard layouts\n+    //\n+    // Note: event.type must be keypress !\n+    function getChar(event) {\n+      if (event.which == null) {\n+        return String.fromCharCode(event.keyCode) // IE\n+      } else if (event.which!=0 && event.charCode!=0) {\n+        return String.fromCharCode(event.which)   // the rest\n+      } else {\n+        return null // special key\n+      }\n+    }\n+\n+    $(document).on('keypress', function handleKeyboardShortcut(e) {\n         if (document.activeElement.tagName === 'INPUT') {\n             return;\n         }\n \n-        if (e.which === 191) { // question mark\n+        if (getChar(e) === '?') {\n             if (e.shiftKey && $('#help').hasClass('hidden')) {\n                 e.preventDefault();\n                 $('#help').removeClass('hidden');\n             }\n-        } else if (e.which === 27) { // esc\n+        } else if (getChar(e) === 's' || getChar(e) === 'S') {\n+            e.preventDefault();\n+            $('.search-input').focus();\n+        }\n+    }).on('keydown', function(e) {\n+        // The escape key event has to be captured with the keydown event.\n+        // Because keypressed has no keycode for the escape key\n+        // (and other special keys in general)...\n+        if (document.activeElement.tagName === 'INPUT') {\n+            return;\n+        }\n+\n+        if (e.keyCode === 27) { // escape key\n             if (!$('#help').hasClass('hidden')) {\n                 e.preventDefault();\n                 $('#help').addClass('hidden');\n@@ -95,16 +124,14 @@\n                 $('#search').addClass('hidden');\n                 $('#main').removeClass('hidden');\n             }\n-        } else if (e.which === 83) { // S\n-            e.preventDefault();\n-            $('.search-input').focus();\n         }\n     }).on('click', function(e) {\n         if (!$(e.target).closest('#help').length) {\n             $('#help').addClass('hidden');\n         }\n     });\n \n+\n     $('.version-selector').on('change', function() {\n         var i, match,\n             url = document.location.href,"}]}