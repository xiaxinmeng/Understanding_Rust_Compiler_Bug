{"sha": "2d337c88b07b6a67b24f4bff4d72025d9ea412a5", "node_id": "MDY6Q29tbWl0NzI0NzEyOjJkMzM3Yzg4YjA3YjZhNjdiMjRmNGJmZjRkNzIwMjVkOWVhNDEyYTU=", "commit": {"author": {"name": "bors[bot]", "email": "bors[bot]@users.noreply.github.com", "date": "2019-01-26T19:17:48Z"}, "committer": {"name": "bors[bot]", "email": "bors[bot]@users.noreply.github.com", "date": "2019-01-26T19:17:48Z"}, "message": "Merge #680\n\n680: Struct literals should not be a `BlockLike::Block` r=DJMcNab a=DJMcNab\n\nFix #674.\n\nCo-authored-by: DJMcNab <36049421+djmcnab@users.noreply.github.com>", "tree": {"sha": "969e6448476201c49e4c8d5fe228474f51e39fd7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/969e6448476201c49e4c8d5fe228474f51e39fd7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/2d337c88b07b6a67b24f4bff4d72025d9ea412a5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/2d337c88b07b6a67b24f4bff4d72025d9ea412a5", "html_url": "https://github.com/rust-lang/rust/commit/2d337c88b07b6a67b24f4bff4d72025d9ea412a5", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/2d337c88b07b6a67b24f4bff4d72025d9ea412a5/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "parents": [{"sha": "1662eb1f8dd9be765a5675f7062236c78b9c991d", "url": "https://api.github.com/repos/rust-lang/rust/commits/1662eb1f8dd9be765a5675f7062236c78b9c991d", "html_url": "https://github.com/rust-lang/rust/commit/1662eb1f8dd9be765a5675f7062236c78b9c991d"}, {"sha": "7a76433c45b01e969f1eca51aec76db53b9e4db3", "url": "https://api.github.com/repos/rust-lang/rust/commits/7a76433c45b01e969f1eca51aec76db53b9e4db3", "html_url": "https://github.com/rust-lang/rust/commit/7a76433c45b01e969f1eca51aec76db53b9e4db3"}], "stats": {"total": 119, "additions": 118, "deletions": 1}, "files": [{"sha": "1604d9b5aca9632cceea895a113fa2a703cd983a", "filename": "crates/ra_syntax/src/grammar/expressions.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/2d337c88b07b6a67b24f4bff4d72025d9ea412a5/crates%2Fra_syntax%2Fsrc%2Fgrammar%2Fexpressions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2d337c88b07b6a67b24f4bff4d72025d9ea412a5/crates%2Fra_syntax%2Fsrc%2Fgrammar%2Fexpressions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Fsrc%2Fgrammar%2Fexpressions.rs?ref=2d337c88b07b6a67b24f4bff4d72025d9ea412a5", "patch": "@@ -423,7 +423,7 @@ fn path_expr(p: &mut Parser, r: Restrictions) -> (CompletedMarker, BlockLike) {\n     match p.current() {\n         L_CURLY if !r.forbid_structs => {\n             named_field_list(p);\n-            (m.complete(p, STRUCT_LIT), BlockLike::Block)\n+            (m.complete(p, STRUCT_LIT), BlockLike::NotBlock)\n         }\n         EXCL => {\n             let block_like = items::macro_call_after_excl(p);"}, {"sha": "7e4a28bf74c758e218a199c105fb0037ff038f7c", "filename": "crates/ra_syntax/tests/data/parser/ok/0043_complex_assignment.rs", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/2d337c88b07b6a67b24f4bff4d72025d9ea412a5/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Fok%2F0043_complex_assignment.rs", "raw_url": "https://github.com/rust-lang/rust/raw/2d337c88b07b6a67b24f4bff4d72025d9ea412a5/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Fok%2F0043_complex_assignment.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Fok%2F0043_complex_assignment.rs?ref=2d337c88b07b6a67b24f4bff4d72025d9ea412a5", "patch": "@@ -0,0 +1,8 @@\n+// https://github.com/rust-analyzer/rust-analyzer/issues/674\n+\n+struct Repr { raw: [u8; 1] }\n+\n+fn abc() {\n+    Repr { raw: [0] }.raw[0] = 0;\n+    Repr{raw:[0]}();\n+}"}, {"sha": "2279c7966437f5e423e19f633e8c47fff1ec1762", "filename": "crates/ra_syntax/tests/data/parser/ok/0043_complex_assignment.txt", "status": "added", "additions": 109, "deletions": 0, "changes": 109, "blob_url": "https://github.com/rust-lang/rust/blob/2d337c88b07b6a67b24f4bff4d72025d9ea412a5/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Fok%2F0043_complex_assignment.txt", "raw_url": "https://github.com/rust-lang/rust/raw/2d337c88b07b6a67b24f4bff4d72025d9ea412a5/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Fok%2F0043_complex_assignment.txt", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Ftests%2Fdata%2Fparser%2Fok%2F0043_complex_assignment.txt?ref=2d337c88b07b6a67b24f4bff4d72025d9ea412a5", "patch": "@@ -0,0 +1,109 @@\n+SOURCE_FILE@[0; 160)\n+  COMMENT@[0; 60)\n+  WHITESPACE@[60; 62)\n+  STRUCT_DEF@[62; 90)\n+    STRUCT_KW@[62; 68)\n+    WHITESPACE@[68; 69)\n+    NAME@[69; 73)\n+      IDENT@[69; 73) \"Repr\"\n+    WHITESPACE@[73; 74)\n+    NAMED_FIELD_DEF_LIST@[74; 90)\n+      L_CURLY@[74; 75)\n+      WHITESPACE@[75; 76)\n+      NAMED_FIELD_DEF@[76; 88)\n+        NAME@[76; 79)\n+          IDENT@[76; 79) \"raw\"\n+        COLON@[79; 80)\n+        WHITESPACE@[80; 81)\n+        ARRAY_TYPE@[81; 88)\n+          L_BRACK@[81; 82)\n+          PATH_TYPE@[82; 84)\n+            PATH@[82; 84)\n+              PATH_SEGMENT@[82; 84)\n+                NAME_REF@[82; 84)\n+                  IDENT@[82; 84) \"u8\"\n+          SEMI@[84; 85)\n+          WHITESPACE@[85; 86)\n+          LITERAL@[86; 87)\n+            INT_NUMBER@[86; 87) \"1\"\n+          R_BRACK@[87; 88)\n+      WHITESPACE@[88; 89)\n+      R_CURLY@[89; 90)\n+  WHITESPACE@[90; 92)\n+  FN_DEF@[92; 159)\n+    FN_KW@[92; 94)\n+    WHITESPACE@[94; 95)\n+    NAME@[95; 98)\n+      IDENT@[95; 98) \"abc\"\n+    PARAM_LIST@[98; 100)\n+      L_PAREN@[98; 99)\n+      R_PAREN@[99; 100)\n+    WHITESPACE@[100; 101)\n+    BLOCK@[101; 159)\n+      L_CURLY@[101; 102)\n+      WHITESPACE@[102; 107)\n+      EXPR_STMT@[107; 136)\n+        BIN_EXPR@[107; 135)\n+          INDEX_EXPR@[107; 131)\n+            FIELD_EXPR@[107; 128)\n+              STRUCT_LIT@[107; 124)\n+                PATH@[107; 111)\n+                  PATH_SEGMENT@[107; 111)\n+                    NAME_REF@[107; 111)\n+                      IDENT@[107; 111) \"Repr\"\n+                WHITESPACE@[111; 112)\n+                NAMED_FIELD_LIST@[112; 124)\n+                  L_CURLY@[112; 113)\n+                  WHITESPACE@[113; 114)\n+                  NAMED_FIELD@[114; 122)\n+                    NAME_REF@[114; 117)\n+                      IDENT@[114; 117) \"raw\"\n+                    COLON@[117; 118)\n+                    WHITESPACE@[118; 119)\n+                    ARRAY_EXPR@[119; 122)\n+                      L_BRACK@[119; 120)\n+                      LITERAL@[120; 121)\n+                        INT_NUMBER@[120; 121) \"0\"\n+                      R_BRACK@[121; 122)\n+                  WHITESPACE@[122; 123)\n+                  R_CURLY@[123; 124)\n+              DOT@[124; 125)\n+              NAME_REF@[125; 128)\n+                IDENT@[125; 128) \"raw\"\n+            L_BRACK@[128; 129)\n+            LITERAL@[129; 130)\n+              INT_NUMBER@[129; 130) \"0\"\n+            R_BRACK@[130; 131)\n+          WHITESPACE@[131; 132)\n+          EQ@[132; 133)\n+          WHITESPACE@[133; 134)\n+          LITERAL@[134; 135)\n+            INT_NUMBER@[134; 135) \"0\"\n+        SEMI@[135; 136)\n+      WHITESPACE@[136; 141)\n+      EXPR_STMT@[141; 157)\n+        CALL_EXPR@[141; 156)\n+          STRUCT_LIT@[141; 154)\n+            PATH@[141; 145)\n+              PATH_SEGMENT@[141; 145)\n+                NAME_REF@[141; 145)\n+                  IDENT@[141; 145) \"Repr\"\n+            NAMED_FIELD_LIST@[145; 154)\n+              L_CURLY@[145; 146)\n+              NAMED_FIELD@[146; 153)\n+                NAME_REF@[146; 149)\n+                  IDENT@[146; 149) \"raw\"\n+                COLON@[149; 150)\n+                ARRAY_EXPR@[150; 153)\n+                  L_BRACK@[150; 151)\n+                  LITERAL@[151; 152)\n+                    INT_NUMBER@[151; 152) \"0\"\n+                  R_BRACK@[152; 153)\n+              R_CURLY@[153; 154)\n+          ARG_LIST@[154; 156)\n+            L_PAREN@[154; 155)\n+            R_PAREN@[155; 156)\n+        SEMI@[156; 157)\n+      WHITESPACE@[157; 158)\n+      R_CURLY@[158; 159)\n+  WHITESPACE@[159; 160)"}]}