{"sha": "01b31af4bbf7f066bbce00cc4260b63ac75c23b9", "node_id": "MDY6Q29tbWl0NzI0NzEyOjAxYjMxYWY0YmJmN2YwNjZiYmNlMDBjYzQyNjBiNjNhYzc1YzIzYjk=", "commit": {"author": {"name": "Kevin Ballard", "email": "kevin@sb.org", "date": "2014-02-13T06:03:36Z"}, "committer": {"name": "Kevin Ballard", "email": "kevin@sb.org", "date": "2014-02-16T23:34:02Z"}, "message": "Update clients of the TaskBuilder API", "tree": {"sha": "15d7887ad46e4ced4c1e431f10a47a36f8a4879b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/15d7887ad46e4ced4c1e431f10a47a36f8a4879b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/01b31af4bbf7f066bbce00cc4260b63ac75c23b9", "comment_count": 17, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/01b31af4bbf7f066bbce00cc4260b63ac75c23b9", "html_url": "https://github.com/rust-lang/rust/commit/01b31af4bbf7f066bbce00cc4260b63ac75c23b9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/01b31af4bbf7f066bbce00cc4260b63ac75c23b9/comments", "author": {"login": "lilyball", "id": 714, "node_id": "MDQ6VXNlcjcxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lilyball", "html_url": "https://github.com/lilyball", "followers_url": "https://api.github.com/users/lilyball/followers", "following_url": "https://api.github.com/users/lilyball/following{/other_user}", "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}", "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions", "organizations_url": "https://api.github.com/users/lilyball/orgs", "repos_url": "https://api.github.com/users/lilyball/repos", "events_url": "https://api.github.com/users/lilyball/events{/privacy}", "received_events_url": "https://api.github.com/users/lilyball/received_events", "type": "User", "site_admin": false}, "committer": {"login": "lilyball", "id": 714, "node_id": "MDQ6VXNlcjcxNA==", "avatar_url": "https://avatars.githubusercontent.com/u/714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lilyball", "html_url": "https://github.com/lilyball", "followers_url": "https://api.github.com/users/lilyball/followers", "following_url": "https://api.github.com/users/lilyball/following{/other_user}", "gists_url": "https://api.github.com/users/lilyball/gists{/gist_id}", "starred_url": "https://api.github.com/users/lilyball/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lilyball/subscriptions", "organizations_url": "https://api.github.com/users/lilyball/orgs", "repos_url": "https://api.github.com/users/lilyball/repos", "events_url": "https://api.github.com/users/lilyball/events{/privacy}", "received_events_url": "https://api.github.com/users/lilyball/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b94daee395c2ed513ea141021e30dcff8e2590c4", "url": "https://api.github.com/repos/rust-lang/rust/commits/b94daee395c2ed513ea141021e30dcff8e2590c4", "html_url": "https://github.com/rust-lang/rust/commit/b94daee395c2ed513ea141021e30dcff8e2590c4"}], "stats": {"total": 24, "additions": 8, "deletions": 16}, "files": [{"sha": "8d85dc9b6ff2465d25d9f9da2e584b4874723789", "filename": "src/libextra/test.rs", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/01b31af4bbf7f066bbce00cc4260b63ac75c23b9/src%2Flibextra%2Ftest.rs", "raw_url": "https://github.com/rust-lang/rust/raw/01b31af4bbf7f066bbce00cc4260b63ac75c23b9/src%2Flibextra%2Ftest.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibextra%2Ftest.rs?ref=01b31af4bbf7f066bbce00cc4260b63ac75c23b9", "patch": "@@ -904,15 +904,14 @@ pub fn run_test(force_ignore: bool,\n                       monitor_ch: Chan<MonitorMsg>,\n                       testfn: proc()) {\n         spawn(proc() {\n-            let mut task = task::task();\n             let (p, c) = Chan::new();\n             let mut reader = PortReader::new(p);\n             let stdout = ChanWriter::new(c.clone());\n             let stderr = ChanWriter::new(c);\n-            match desc.name {\n-                DynTestName(ref name) => task.name(name.clone()),\n-                StaticTestName(name) => task.name(name),\n-            }\n+            let mut task = task::task().named(match desc.name {\n+                DynTestName(ref name) => name.clone().into_maybe_owned(),\n+                StaticTestName(name) => name.into_maybe_owned(),\n+            });\n             task.opts.stdout = Some(~stdout as ~Writer);\n             task.opts.stderr = Some(~stderr as ~Writer);\n             let result_future = task.future_result();"}, {"sha": "6554ee592291834ae818b2f524a3d2c9189220a0", "filename": "src/librustc/lib.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/01b31af4bbf7f066bbce00cc4260b63ac75c23b9/src%2Flibrustc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/01b31af4bbf7f066bbce00cc4260b63ac75c23b9/src%2Flibrustc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Flib.rs?ref=01b31af4bbf7f066bbce00cc4260b63ac75c23b9", "patch": "@@ -371,8 +371,7 @@ pub fn monitor(f: proc()) {\n     #[cfg(not(rtopt))]\n     static STACK_SIZE: uint = 20000000; // 20MB\n \n-    let mut task_builder = task::task();\n-    task_builder.name(\"rustc\");\n+    let mut task_builder = task::task().named(\"rustc\");\n \n     // FIXME: Hacks on hacks. If the env is trying to override the stack size\n     // then *don't* set it explicitly."}, {"sha": "037dc9ac9b001b0f6a9ada368a51c41a804b7720", "filename": "src/test/run-fail/fail-task-name-owned.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/01b31af4bbf7f066bbce00cc4260b63ac75c23b9/src%2Ftest%2Frun-fail%2Ffail-task-name-owned.rs", "raw_url": "https://github.com/rust-lang/rust/raw/01b31af4bbf7f066bbce00cc4260b63ac75c23b9/src%2Ftest%2Frun-fail%2Ffail-task-name-owned.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-fail%2Ffail-task-name-owned.rs?ref=01b31af4bbf7f066bbce00cc4260b63ac75c23b9", "patch": "@@ -13,9 +13,7 @@\n use std::task;\n \n fn main() {\n-    let mut t = task::task();\n-    t.name(~\"owned name\");\n-    t.try(proc() {\n+    task::task().named(~\"owned name\").try(proc() {\n         fail!(\"test\");\n         1\n     }).unwrap()"}, {"sha": "c21c6c42f6f92a066abd72c7166ee0684f3c0aef", "filename": "src/test/run-fail/fail-task-name-send-str.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/01b31af4bbf7f066bbce00cc4260b63ac75c23b9/src%2Ftest%2Frun-fail%2Ffail-task-name-send-str.rs", "raw_url": "https://github.com/rust-lang/rust/raw/01b31af4bbf7f066bbce00cc4260b63ac75c23b9/src%2Ftest%2Frun-fail%2Ffail-task-name-send-str.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-fail%2Ffail-task-name-send-str.rs?ref=01b31af4bbf7f066bbce00cc4260b63ac75c23b9", "patch": "@@ -11,9 +11,7 @@\n // error-pattern:task 'send name' failed at 'test'\n \n fn main() {\n-    let mut t = ::std::task::task();\n-    t.name(\"send name\".into_maybe_owned());\n-    t.try(proc() {\n+    ::std::task::task().named(\"send name\".into_maybe_owned()).try(proc() {\n         fail!(\"test\");\n         3\n     }).unwrap()"}, {"sha": "516f9b2e1d77dfec0298aca4eba6937a6ff3b234", "filename": "src/test/run-fail/fail-task-name-static.rs", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/01b31af4bbf7f066bbce00cc4260b63ac75c23b9/src%2Ftest%2Frun-fail%2Ffail-task-name-static.rs", "raw_url": "https://github.com/rust-lang/rust/raw/01b31af4bbf7f066bbce00cc4260b63ac75c23b9/src%2Ftest%2Frun-fail%2Ffail-task-name-static.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-fail%2Ffail-task-name-static.rs?ref=01b31af4bbf7f066bbce00cc4260b63ac75c23b9", "patch": "@@ -11,9 +11,7 @@\n // error-pattern:task 'static name' failed at 'test'\n \n fn main() {\n-    let mut t = ::std::task::task();\n-    t.name(\"static name\");\n-    t.try(proc() {\n+    ::std::task::task().named(\"static name\").try(proc() {\n         fail!(\"test\");\n     }).unwrap()\n }"}]}