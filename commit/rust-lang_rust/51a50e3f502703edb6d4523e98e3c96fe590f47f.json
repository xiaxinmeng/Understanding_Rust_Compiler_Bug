{"sha": "51a50e3f502703edb6d4523e98e3c96fe590f47f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUxYTUwZTNmNTAyNzAzZWRiNmQ0NTIzZTk4ZTNjOTZmZTU5MGY0N2Y=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2020-03-09T08:08:23Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-03-09T08:08:23Z"}, "message": "Merge #3520\n\n3520: Omit unit struct hints r=matklad a=SomeoneToIgnore\n\nCloses https://github.com/rust-analyzer/rust-analyzer/issues/3488\n\nCo-authored-by: Kirill Bulatov <mail4score@gmail.com>", "tree": {"sha": "0d6ea744816446ad75f75fe95ee2c61cd0650e5c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0d6ea744816446ad75f75fe95ee2c61cd0650e5c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/51a50e3f502703edb6d4523e98e3c96fe590f47f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJeZfl3CRBK7hj4Ov3rIwAAdHIIABVzfEZiyehzRdWcQZNwOg4I\n5GyAgb1qGguT8wH75XFiIFMZcrbn2Qoy2apeKTgaViFbCdNeeiX11mAFJBWyw88Y\nuKPP5WtFMsLfUmh0rsrWQFeBZY9EVyNz/lrTs+YfyfBDR/7wDUJA09/Cnq+vAE8Z\nfjH9GbNd2JYlxOHYdDg7Cs9++qCIW4Noj/0hl3THd9SD5RdyeNiHjEHVz6lo44g4\nkk1McAMBt6BGDWC7bH+XiBKl3FyYBrP0lT01T5xLwcZ6A1ksc/sHSi5Ge0fPeFdP\nGNTV+fFxWn9w1/9lZPHu8X9zWMyX0lYPtbzsp7oLUJWSzxpl5yLfpHyNyLVg7ls=\n=jcE/\n-----END PGP SIGNATURE-----\n", "payload": "tree 0d6ea744816446ad75f75fe95ee2c61cd0650e5c\nparent 5b3d97e449690cfb75ccf48ca5a92f7f7a95ea5e\nparent 605dc98451816545577b8c23c998df490481c95b\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1583741303 +0000\ncommitter GitHub <noreply@github.com> 1583741303 +0000\n\nMerge #3520\n\n3520: Omit unit struct hints r=matklad a=SomeoneToIgnore\n\nCloses https://github.com/rust-analyzer/rust-analyzer/issues/3488\n\nCo-authored-by: Kirill Bulatov <mail4score@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/51a50e3f502703edb6d4523e98e3c96fe590f47f", "html_url": "https://github.com/rust-lang/rust/commit/51a50e3f502703edb6d4523e98e3c96fe590f47f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/51a50e3f502703edb6d4523e98e3c96fe590f47f/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5b3d97e449690cfb75ccf48ca5a92f7f7a95ea5e", "url": "https://api.github.com/repos/rust-lang/rust/commits/5b3d97e449690cfb75ccf48ca5a92f7f7a95ea5e", "html_url": "https://github.com/rust-lang/rust/commit/5b3d97e449690cfb75ccf48ca5a92f7f7a95ea5e"}, {"sha": "605dc98451816545577b8c23c998df490481c95b", "url": "https://api.github.com/repos/rust-lang/rust/commits/605dc98451816545577b8c23c998df490481c95b", "html_url": "https://github.com/rust-lang/rust/commit/605dc98451816545577b8c23c998df490481c95b"}], "stats": {"total": 32, "additions": 32, "deletions": 0}, "files": [{"sha": "cf0cbdbd02a6c5bb9b7fb3565b842b72d3877a8b", "filename": "crates/ra_ide/src/inlay_hints.rs", "status": "modified", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/rust-lang/rust/blob/51a50e3f502703edb6d4523e98e3c96fe590f47f/crates%2Fra_ide%2Fsrc%2Finlay_hints.rs", "raw_url": "https://github.com/rust-lang/rust/raw/51a50e3f502703edb6d4523e98e3c96fe590f47f/crates%2Fra_ide%2Fsrc%2Finlay_hints.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide%2Fsrc%2Finlay_hints.rs?ref=51a50e3f502703edb6d4523e98e3c96fe590f47f", "patch": "@@ -119,6 +119,12 @@ fn should_not_display_type_hint(db: &RootDatabase, bind_pat: &ast::BindPat, pat_\n         return true;\n     }\n \n+    if let Some(Adt::Struct(s)) = pat_ty.as_adt() {\n+        if s.fields(db).is_empty() && s.name(db).to_string() == bind_pat.syntax().to_string() {\n+            return true;\n+        }\n+    }\n+\n     for node in bind_pat.syntax().ancestors() {\n         match_ast! {\n             match node {\n@@ -943,4 +949,30 @@ fn main() {\n         \"###\n         );\n     }\n+\n+    #[test]\n+    fn unit_structs_have_no_type_hints() {\n+        let (analysis, file_id) = single_file(\n+            r#\"\n+enum CustomResult<T, E> {\n+    Ok(T),\n+    Err(E),\n+}\n+use CustomResult::*;\n+\n+struct SyntheticSyntax;\n+\n+fn main() {\n+    match Ok(()) {\n+        Ok(_) => (),\n+        Err(SyntheticSyntax) => (),\n+    }\n+}\"#,\n+        );\n+\n+        assert_debug_snapshot!(analysis.inlay_hints(file_id, Some(8)).unwrap(), @r###\"\n+        []\n+        \"###\n+        );\n+    }\n }"}]}