{"sha": "cedd26b1ea066fe243b82b0f78e37066c6f4d789", "node_id": "C_kwDOAAsO6NoAKGNlZGQyNmIxZWEwNjZmZTI0M2I4MmIwZjc4ZTM3MDY2YzZmNGQ3ODk", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-09-10T04:14:34Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2022-09-10T04:14:34Z"}, "message": "Auto merge of #99916 - dpaoliello:stablizerawdylib, r=wesleywiser\n\nStabilize raw-dylib for non-x86\n\nThis stabilizes the `raw-dylib` and `link_ordinal` features (#58713) for non-x86 architectures (i.e., `x86_64`, `aarch64` and `thumbv7a`):\n* Marked the `raw_dylib` feature as `active`.\n* Marked the `link_ordinal` attribute as `ungated`.\n* Added new errors if either feature is used on x86 targets without the `raw_dylib` feature being enabled.\n* Updated tests to only set the `raw_dylib` feature when building for x86.", "tree": {"sha": "9e259edeea5fcf1e113ca5b609ce3bb7674b5c38", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9e259edeea5fcf1e113ca5b609ce3bb7674b5c38"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/cedd26b1ea066fe243b82b0f78e37066c6f4d789", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/cedd26b1ea066fe243b82b0f78e37066c6f4d789", "html_url": "https://github.com/rust-lang/rust/commit/cedd26b1ea066fe243b82b0f78e37066c6f4d789", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/cedd26b1ea066fe243b82b0f78e37066c6f4d789/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "87eb3e2dfad244025bd5ee3161be66c271f691d8", "url": "https://api.github.com/repos/rust-lang/rust/commits/87eb3e2dfad244025bd5ee3161be66c271f691d8", "html_url": "https://github.com/rust-lang/rust/commit/87eb3e2dfad244025bd5ee3161be66c271f691d8"}, {"sha": "c7475011a398b9aa35c60e20f1b396dc0fc65afa", "url": "https://api.github.com/repos/rust-lang/rust/commits/c7475011a398b9aa35c60e20f1b396dc0fc65afa", "html_url": "https://github.com/rust-lang/rust/commit/c7475011a398b9aa35c60e20f1b396dc0fc65afa"}], "stats": {"total": 317, "additions": 86, "deletions": 231}, "files": [{"sha": "98258834bd58964d29302c1351393eae28a69320", "filename": "compiler/rustc_feature/src/active.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/compiler%2Frustc_feature%2Fsrc%2Factive.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/compiler%2Frustc_feature%2Fsrc%2Factive.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_feature%2Fsrc%2Factive.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -478,7 +478,7 @@ declare_features! (\n     /// Allows macro attributes on expressions, statements and non-inline modules.\n     (active, proc_macro_hygiene, \"1.30.0\", Some(54727), None),\n     /// Allows the use of raw-dylibs (RFC 2627).\n-    (incomplete, raw_dylib, \"1.40.0\", Some(58713), None),\n+    (active, raw_dylib, \"CURRENT_RUSTC_VERSION\", Some(58713), None),\n     /// Allows `&raw const $place_expr` and `&raw mut $place_expr` expressions.\n     (active, raw_ref_op, \"1.41.0\", Some(64490), None),\n     /// Allows using the `#[register_tool]` attribute."}, {"sha": "8d88a90e39564b5dc506d8de7b50b9ba350e7e6c", "filename": "compiler/rustc_feature/src/builtin_attrs.rs", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/compiler%2Frustc_feature%2Fsrc%2Fbuiltin_attrs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/compiler%2Frustc_feature%2Fsrc%2Fbuiltin_attrs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_feature%2Fsrc%2Fbuiltin_attrs.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -345,6 +345,7 @@ pub const BUILTIN_ATTRIBUTES: &[BuiltinAttribute] = &[\n     ungated!(link_section, Normal, template!(NameValueStr: \"name\"), FutureWarnPreceding),\n     ungated!(no_mangle, Normal, template!(Word), WarnFollowing, @only_local: true),\n     ungated!(used, Normal, template!(Word, List: \"compiler|linker\"), WarnFollowing, @only_local: true),\n+    ungated!(link_ordinal, Normal, template!(List: \"ordinal\"), ErrorPreceding),\n \n     // Limits:\n     ungated!(recursion_limit, CrateLevel, template!(NameValueStr: \"N\"), FutureWarnFollowing),\n@@ -406,10 +407,6 @@ pub const BUILTIN_ATTRIBUTES: &[BuiltinAttribute] = &[\n \n     // Linking:\n     gated!(naked, Normal, template!(Word), WarnFollowing, @only_local: true, naked_functions, experimental!(naked)),\n-    gated!(\n-        link_ordinal, Normal, template!(List: \"ordinal\"), ErrorPreceding, raw_dylib,\n-        experimental!(link_ordinal)\n-    ),\n \n     // Plugins:\n     BuiltinAttribute {"}, {"sha": "3acabc4e69ce653b96d7d3a8a142c73b15a12f28", "filename": "compiler/rustc_metadata/src/native_libs.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/compiler%2Frustc_metadata%2Fsrc%2Fnative_libs.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/compiler%2Frustc_metadata%2Fsrc%2Fnative_libs.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_metadata%2Fsrc%2Fnative_libs.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -113,12 +113,12 @@ impl<'tcx> Collector<'tcx> {\n                             \"raw-dylib\" => {\n                                 if !sess.target.is_like_windows {\n                                     sess.emit_err(FrameworkOnlyWindows { span });\n-                                } else if !features.raw_dylib {\n+                                } else if !features.raw_dylib && sess.target.arch == \"x86\" {\n                                     feature_err(\n                                         &sess.parse_sess,\n                                         sym::raw_dylib,\n                                         span,\n-                                        \"link kind `raw-dylib` is unstable\",\n+                                        \"link kind `raw-dylib` is unstable on x86\",\n                                     )\n                                     .emit();\n                                 }"}, {"sha": "f9c7c008fa484af94c431144085d7c29f8424f9e", "filename": "compiler/rustc_typeck/src/collect.rs", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/compiler%2Frustc_typeck%2Fsrc%2Fcollect.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/compiler%2Frustc_typeck%2Fsrc%2Fcollect.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_typeck%2Fsrc%2Fcollect.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -3287,6 +3287,15 @@ fn should_inherit_track_caller(tcx: TyCtxt<'_>, def_id: DefId) -> bool {\n \n fn check_link_ordinal(tcx: TyCtxt<'_>, attr: &ast::Attribute) -> Option<u16> {\n     use rustc_ast::{Lit, LitIntType, LitKind};\n+    if !tcx.features().raw_dylib && tcx.sess.target.arch == \"x86\" {\n+        feature_err(\n+            &tcx.sess.parse_sess,\n+            sym::raw_dylib,\n+            attr.span,\n+            \"`#[link_ordinal]` is unstable on x86\",\n+        )\n+        .emit();\n+    }\n     let meta_item_list = attr.meta_item_list();\n     let meta_item_list: Option<&[ast::NestedMetaItem]> = meta_item_list.as_ref().map(Vec::as_ref);\n     let sole_meta_list = match meta_item_list {"}, {"sha": "5fd208ae7571c979d61c7b3342d13bff6da7c832", "filename": "src/doc/unstable-book/src/language-features/raw-dylib.md", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fraw-dylib.md", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fraw-dylib.md", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fdoc%2Funstable-book%2Fsrc%2Flanguage-features%2Fraw-dylib.md?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -26,9 +26,9 @@ fn main() {\n \n ## Limitations\n \n-Currently, this feature is only supported on `-windows-msvc` targets.  Non-Windows platforms don't have import\n-libraries, and an incompatibility between LLVM and the BFD linker means that it is not currently supported on\n-`-windows-gnu` targets.\n+This feature is unstable for the `x86` architecture, and stable for all other architectures.\n \n-On the `i686-pc-windows-msvc` target, this feature supports only the `cdecl`, `stdcall`, `system`, and `fastcall`\n-calling conventions.\n+This feature is only supported on Windows.\n+\n+On the `x86` architecture, this feature supports only the `cdecl`, `stdcall`, `system`, `fastcall`, and\n+`vectorcall` calling conventions."}, {"sha": "fe74fbfd2646f40cff5b57dd0b68d07f3bd31529", "filename": "src/test/run-make/raw-dylib-alt-calling-convention/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Frun-make%2Fraw-dylib-alt-calling-convention%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Frun-make%2Fraw-dylib-alt-calling-convention%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fraw-dylib-alt-calling-convention%2Flib.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,5 +1,5 @@\n-#![feature(raw_dylib)]\n #![feature(abi_vectorcall)]\n+#![cfg_attr(target_arch = \"x86\", feature(raw_dylib))]\n \n #[repr(C)]\n #[derive(Clone)]"}, {"sha": "bb25ac64c613b261a64677e606ce60e6e11e7ecb", "filename": "src/test/run-make/raw-dylib-link-ordinal/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Frun-make%2Fraw-dylib-link-ordinal%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Frun-make%2Fraw-dylib-link-ordinal%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fraw-dylib-link-ordinal%2Flib.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,4 +1,4 @@\n-#![feature(raw_dylib)]\n+#![cfg_attr(target_arch = \"x86\", feature(raw_dylib))]\n \n #[link(name = \"exporter\", kind = \"raw-dylib\")]\n extern {"}, {"sha": "b7921396a0f4dd50d48fe2908d6f6c0bf1757589", "filename": "src/test/run-make/raw-dylib-stdcall-ordinal/lib.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Frun-make%2Fraw-dylib-stdcall-ordinal%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Frun-make%2Fraw-dylib-stdcall-ordinal%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make%2Fraw-dylib-stdcall-ordinal%2Flib.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,4 +1,4 @@\n-#![feature(raw_dylib)]\n+#![cfg_attr(target_arch = \"x86\", feature(raw_dylib))]\n \n #[link(name = \"exporter\", kind = \"raw-dylib\")]\n extern \"stdcall\" {"}, {"sha": "fc47a9061d3c02b5f7f76c8065f8f12e3c317950", "filename": "src/test/ui/feature-gates/feature-gate-raw-dylib-2.rs", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib-2.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,10 +1,11 @@\n+// only-x86\n #[link(name = \"foo\")]\n extern \"C\" {\n     #[link_ordinal(42)]\n-    //~^ ERROR: the `#[link_ordinal]` attribute is an experimental feature\n+    //~^ ERROR: `#[link_ordinal]` is unstable on x86\n     fn foo();\n     #[link_ordinal(5)]\n-    //~^ ERROR: the `#[link_ordinal]` attribute is an experimental feature\n+    //~^ ERROR: `#[link_ordinal]` is unstable on x86\n     static mut imported_variable: i32;\n }\n "}, {"sha": "0e900760d245e44b628d93ce54cdf9c859089ec0", "filename": "src/test/ui/feature-gates/feature-gate-raw-dylib-2.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib-2.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib-2.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib-2.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,14 +1,14 @@\n-error[E0658]: the `#[link_ordinal]` attribute is an experimental feature\n-  --> $DIR/feature-gate-raw-dylib-2.rs:3:5\n+error[E0658]: `#[link_ordinal]` is unstable on x86\n+  --> $DIR/feature-gate-raw-dylib-2.rs:4:5\n    |\n LL |     #[link_ordinal(42)]\n    |     ^^^^^^^^^^^^^^^^^^^\n    |\n    = note: see issue #58713 <https://github.com/rust-lang/rust/issues/58713> for more information\n    = help: add `#![feature(raw_dylib)]` to the crate attributes to enable\n \n-error[E0658]: the `#[link_ordinal]` attribute is an experimental feature\n-  --> $DIR/feature-gate-raw-dylib-2.rs:6:5\n+error[E0658]: `#[link_ordinal]` is unstable on x86\n+  --> $DIR/feature-gate-raw-dylib-2.rs:7:5\n    |\n LL |     #[link_ordinal(5)]\n    |     ^^^^^^^^^^^^^^^^^^"}, {"sha": "295f502d6a3e57f200195a1fae8b0ebf3cc33c2b", "filename": "src/test/ui/feature-gates/feature-gate-raw-dylib-import-name-type.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib-import-name-type.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib-import-name-type.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib-import-name-type.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,7 +1,7 @@\n // only-windows\n // only-x86\n #[link(name = \"foo\", kind = \"raw-dylib\", import_name_type = \"decorated\")]\n-//~^ ERROR link kind `raw-dylib` is unstable\n+//~^ ERROR link kind `raw-dylib` is unstable on x86\n //~| ERROR import name type is unstable\n extern \"C\" {}\n "}, {"sha": "d6b165b7610a55c453a29ad6d00f2cf79b378d3c", "filename": "src/test/ui/feature-gates/feature-gate-raw-dylib-import-name-type.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib-import-name-type.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib-import-name-type.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib-import-name-type.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,4 +1,4 @@\n-error[E0658]: link kind `raw-dylib` is unstable\n+error[E0658]: link kind `raw-dylib` is unstable on x86\n   --> $DIR/feature-gate-raw-dylib-import-name-type.rs:3:29\n    |\n LL | #[link(name = \"foo\", kind = \"raw-dylib\", import_name_type = \"decorated\")]"}, {"sha": "291cca8fd25737262db3b46b827440bb72c3b89d", "filename": "src/test/ui/feature-gates/feature-gate-raw-dylib.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,6 +1,7 @@\n // only-windows\n+// only-x86\n #[link(name = \"foo\", kind = \"raw-dylib\")]\n-//~^ ERROR: link kind `raw-dylib` is unstable\n+//~^ ERROR: link kind `raw-dylib` is unstable on x86\n extern \"C\" {}\n \n fn main() {}"}, {"sha": "f02241e4908c091b16d5a3e75d4a77d4018ba1df", "filename": "src/test/ui/feature-gates/feature-gate-raw-dylib.stderr", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ffeature-gates%2Ffeature-gate-raw-dylib.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,5 +1,5 @@\n-error[E0658]: link kind `raw-dylib` is unstable\n-  --> $DIR/feature-gate-raw-dylib.rs:2:29\n+error[E0658]: link kind `raw-dylib` is unstable on x86\n+  --> $DIR/feature-gate-raw-dylib.rs:3:29\n    |\n LL | #[link(name = \"foo\", kind = \"raw-dylib\")]\n    |                             ^^^^^^^^^^^"}, {"sha": "22d57f8bedddc01a6981693d58a4b2643dd2e021", "filename": "src/test/ui/rfc-2627-raw-dylib/import-name-type-invalid-format.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-invalid-format.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-invalid-format.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-invalid-format.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,7 +1,6 @@\n // only-windows\n // only-x86\n #![feature(raw_dylib)]\n-//~^ WARN the feature `raw_dylib` is incomplete\n \n #[link(name = \"foo\", kind = \"raw-dylib\", import_name_type = 6)]\n //~^ ERROR import name type must be of the form `import_name_type = \"string\"`"}, {"sha": "0e95fec29d2575087e17fbfdb52dd1752f167727", "filename": "src/test/ui/rfc-2627-raw-dylib/import-name-type-invalid-format.stderr", "status": "modified", "additions": 2, "deletions": 11, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-invalid-format.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-invalid-format.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-invalid-format.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,17 +1,8 @@\n-warning: the feature `raw_dylib` is incomplete and may not be safe to use and/or cause compiler crashes\n-  --> $DIR/import-name-type-invalid-format.rs:3:12\n-   |\n-LL | #![feature(raw_dylib)]\n-   |            ^^^^^^^^^\n-   |\n-   = note: `#[warn(incomplete_features)]` on by default\n-   = note: see issue #58713 <https://github.com/rust-lang/rust/issues/58713> for more information\n-\n error: import name type must be of the form `import_name_type = \"string\"`\n-  --> $DIR/import-name-type-invalid-format.rs:6:42\n+  --> $DIR/import-name-type-invalid-format.rs:5:42\n    |\n LL | #[link(name = \"foo\", kind = \"raw-dylib\", import_name_type = 6)]\n    |                                          ^^^^^^^^^^^^^^^^^^^^\n \n-error: aborting due to previous error; 1 warning emitted\n+error: aborting due to previous error\n "}, {"sha": "7ccb0082fb976d78fa587c07bd73f10e0e6c8b2a", "filename": "src/test/ui/rfc-2627-raw-dylib/import-name-type-multiple.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-multiple.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-multiple.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-multiple.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -2,7 +2,6 @@\n // only-windows\n // only-x86\n #![feature(raw_dylib)]\n-//~^ WARN the feature `raw_dylib` is incomplete\n \n #[link(name = \"foo\", kind = \"raw-dylib\", import_name_type = \"decorated\", import_name_type = \"decorated\")]\n //~^ ERROR multiple `import_name_type` arguments in a single `#[link]` attribute"}, {"sha": "7c0e0be911f73fb0ad00c29b45e376448e667a06", "filename": "src/test/ui/rfc-2627-raw-dylib/import-name-type-multiple.stderr", "status": "modified", "additions": 2, "deletions": 11, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-multiple.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-multiple.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-multiple.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,17 +1,8 @@\n-warning: the feature `raw_dylib` is incomplete and may not be safe to use and/or cause compiler crashes\n-  --> $DIR/import-name-type-multiple.rs:4:12\n-   |\n-LL | #![feature(raw_dylib)]\n-   |            ^^^^^^^^^\n-   |\n-   = note: `#[warn(incomplete_features)]` on by default\n-   = note: see issue #58713 <https://github.com/rust-lang/rust/issues/58713> for more information\n-\n error: multiple `import_name_type` arguments in a single `#[link]` attribute\n-  --> $DIR/import-name-type-multiple.rs:7:74\n+  --> $DIR/import-name-type-multiple.rs:6:74\n    |\n LL | #[link(name = \"foo\", kind = \"raw-dylib\", import_name_type = \"decorated\", import_name_type = \"decorated\")]\n    |                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-error: aborting due to previous error; 1 warning emitted\n+error: aborting due to previous error\n "}, {"sha": "f728a578d3b8a7bb5624b520e847f7621ebd9786", "filename": "src/test/ui/rfc-2627-raw-dylib/import-name-type-unknown-value.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-unknown-value.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-unknown-value.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-unknown-value.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,7 +1,6 @@\n // only-windows\n // only-x86\n #![feature(raw_dylib)]\n-//~^ WARN the feature `raw_dylib` is incomplete\n \n #[link(name = \"foo\", kind = \"raw-dylib\", import_name_type = \"unknown\")]\n //~^ ERROR unknown import name type `unknown`, expected one of: decorated, noprefix, undecorated"}, {"sha": "2b299f2fea316c6da4395e1de73851761b52fdf0", "filename": "src/test/ui/rfc-2627-raw-dylib/import-name-type-unknown-value.stderr", "status": "modified", "additions": 2, "deletions": 11, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-unknown-value.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-unknown-value.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-unknown-value.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,17 +1,8 @@\n-warning: the feature `raw_dylib` is incomplete and may not be safe to use and/or cause compiler crashes\n-  --> $DIR/import-name-type-unknown-value.rs:3:12\n-   |\n-LL | #![feature(raw_dylib)]\n-   |            ^^^^^^^^^\n-   |\n-   = note: `#[warn(incomplete_features)]` on by default\n-   = note: see issue #58713 <https://github.com/rust-lang/rust/issues/58713> for more information\n-\n error: unknown import name type `unknown`, expected one of: decorated, noprefix, undecorated\n-  --> $DIR/import-name-type-unknown-value.rs:6:42\n+  --> $DIR/import-name-type-unknown-value.rs:5:42\n    |\n LL | #[link(name = \"foo\", kind = \"raw-dylib\", import_name_type = \"unknown\")]\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-error: aborting due to previous error; 1 warning emitted\n+error: aborting due to previous error\n "}, {"sha": "ae9207864a2aea0c8a55832dfda7acf22573aafd", "filename": "src/test/ui/rfc-2627-raw-dylib/import-name-type-unsupported-link-kind.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-unsupported-link-kind.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-unsupported-link-kind.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-unsupported-link-kind.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,7 +1,6 @@\n // only-windows\n // only-x86\n #![feature(raw_dylib)]\n-//~^ WARN the feature `raw_dylib` is incomplete\n \n #[link(name = \"foo\", import_name_type = \"decorated\")]\n //~^ ERROR import name type can only be used with link kind `raw-dylib`"}, {"sha": "5898cd875a1c852fe4d4c6523396e30570001620", "filename": "src/test/ui/rfc-2627-raw-dylib/import-name-type-unsupported-link-kind.stderr", "status": "modified", "additions": 3, "deletions": 12, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-unsupported-link-kind.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-unsupported-link-kind.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-unsupported-link-kind.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,23 +1,14 @@\n-warning: the feature `raw_dylib` is incomplete and may not be safe to use and/or cause compiler crashes\n-  --> $DIR/import-name-type-unsupported-link-kind.rs:3:12\n-   |\n-LL | #![feature(raw_dylib)]\n-   |            ^^^^^^^^^\n-   |\n-   = note: `#[warn(incomplete_features)]` on by default\n-   = note: see issue #58713 <https://github.com/rust-lang/rust/issues/58713> for more information\n-\n error: import name type can only be used with link kind `raw-dylib`\n-  --> $DIR/import-name-type-unsupported-link-kind.rs:6:22\n+  --> $DIR/import-name-type-unsupported-link-kind.rs:5:22\n    |\n LL | #[link(name = \"foo\", import_name_type = \"decorated\")]\n    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n error: import name type can only be used with link kind `raw-dylib`\n-  --> $DIR/import-name-type-unsupported-link-kind.rs:10:39\n+  --> $DIR/import-name-type-unsupported-link-kind.rs:9:39\n    |\n LL | #[link(name = \"bar\", kind = \"static\", import_name_type = \"decorated\")]\n    |                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-error: aborting due to 2 previous errors; 1 warning emitted\n+error: aborting due to 2 previous errors\n "}, {"sha": "346ea18a8f8eb6fc1d1106cdff53782a63aaf138", "filename": "src/test/ui/rfc-2627-raw-dylib/import-name-type-x86-only.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-x86-only.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-x86-only.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-x86-only.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,7 +1,5 @@\n // only-windows\n // ignore-x86\n-#![feature(raw_dylib)]\n-//~^ WARN the feature `raw_dylib` is incomplete\n #[link(name = \"foo\", kind = \"raw-dylib\", import_name_type = \"decorated\")]\n //~^ ERROR import name type is only supported on x86\n extern \"C\" { }"}, {"sha": "b56449299b71e8ea9b79829aebcf674826a8d2df", "filename": "src/test/ui/rfc-2627-raw-dylib/import-name-type-x86-only.stderr", "status": "modified", "additions": 2, "deletions": 11, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-x86-only.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-x86-only.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fimport-name-type-x86-only.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,17 +1,8 @@\n-warning: the feature `raw_dylib` is incomplete and may not be safe to use and/or cause compiler crashes\n-  --> $DIR/import-name-type-x86-only.rs:3:12\n-   |\n-LL | #![feature(raw_dylib)]\n-   |            ^^^^^^^^^\n-   |\n-   = note: `#[warn(incomplete_features)]` on by default\n-   = note: see issue #58713 <https://github.com/rust-lang/rust/issues/58713> for more information\n-\n error: import name type is only supported on x86\n-  --> $DIR/import-name-type-x86-only.rs:5:42\n+  --> $DIR/import-name-type-x86-only.rs:3:42\n    |\n LL | #[link(name = \"foo\", kind = \"raw-dylib\", import_name_type = \"decorated\")]\n    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-error: aborting due to previous error; 1 warning emitted\n+error: aborting due to previous error\n "}, {"sha": "1a128c87a0c30921eb64f603c0d1ff2512c94620", "filename": "src/test/ui/rfc-2627-raw-dylib/link-ordinal-and-name.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-and-name.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-and-name.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-and-name.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,5 +1,4 @@\n-#![feature(raw_dylib)]\n-//~^ WARN the feature `raw_dylib` is incomplete\n+#![cfg_attr(target_arch = \"x86\", feature(raw_dylib))]\n \n #[link(name=\"foo\")]\n extern \"C\" {"}, {"sha": "481a06d2797d5442855af8891cc76fb7d7fe0eb1", "filename": "src/test/ui/rfc-2627-raw-dylib/link-ordinal-and-name.stderr", "status": "modified", "additions": 3, "deletions": 12, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-and-name.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-and-name.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-and-name.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,23 +1,14 @@\n-warning: the feature `raw_dylib` is incomplete and may not be safe to use and/or cause compiler crashes\n-  --> $DIR/link-ordinal-and-name.rs:1:12\n-   |\n-LL | #![feature(raw_dylib)]\n-   |            ^^^^^^^^^\n-   |\n-   = note: `#[warn(incomplete_features)]` on by default\n-   = note: see issue #58713 <https://github.com/rust-lang/rust/issues/58713> for more information\n-\n error: cannot use `#[link_name]` with `#[link_ordinal]`\n-  --> $DIR/link-ordinal-and-name.rs:7:5\n+  --> $DIR/link-ordinal-and-name.rs:6:5\n    |\n LL |     #[link_ordinal(42)]\n    |     ^^^^^^^^^^^^^^^^^^^\n \n error: cannot use `#[link_name]` with `#[link_ordinal]`\n-  --> $DIR/link-ordinal-and-name.rs:11:5\n+  --> $DIR/link-ordinal-and-name.rs:10:5\n    |\n LL |     #[link_ordinal(5)]\n    |     ^^^^^^^^^^^^^^^^^^\n \n-error: aborting due to 2 previous errors; 1 warning emitted\n+error: aborting due to 2 previous errors\n "}, {"sha": "7c8da050cf62432ab78128bab9066a7212e5de54", "filename": "src/test/ui/rfc-2627-raw-dylib/link-ordinal-invalid-format.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-invalid-format.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-invalid-format.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-invalid-format.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,5 +1,4 @@\n-#![feature(raw_dylib)]\n-//~^ WARN the feature `raw_dylib` is incomplete\n+#![cfg_attr(target_arch = \"x86\", feature(raw_dylib))]\n \n #[link(name = \"foo\")]\n extern \"C\" {"}, {"sha": "55cdcad75a4ad04c17bc0b4ab1476730a3fd0e37", "filename": "src/test/ui/rfc-2627-raw-dylib/link-ordinal-invalid-format.stderr", "status": "modified", "additions": 3, "deletions": 12, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-invalid-format.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-invalid-format.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-invalid-format.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,27 +1,18 @@\n-warning: the feature `raw_dylib` is incomplete and may not be safe to use and/or cause compiler crashes\n-  --> $DIR/link-ordinal-invalid-format.rs:1:12\n-   |\n-LL | #![feature(raw_dylib)]\n-   |            ^^^^^^^^^\n-   |\n-   = note: `#[warn(incomplete_features)]` on by default\n-   = note: see issue #58713 <https://github.com/rust-lang/rust/issues/58713> for more information\n-\n error: illegal ordinal format in `link_ordinal`\n-  --> $DIR/link-ordinal-invalid-format.rs:6:5\n+  --> $DIR/link-ordinal-invalid-format.rs:5:5\n    |\n LL |     #[link_ordinal(\"JustMonika\")]\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |\n    = note: an unsuffixed integer value, e.g., `1`, is expected\n \n error: illegal ordinal format in `link_ordinal`\n-  --> $DIR/link-ordinal-invalid-format.rs:9:5\n+  --> $DIR/link-ordinal-invalid-format.rs:8:5\n    |\n LL |     #[link_ordinal(\"JustMonika\")]\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |\n    = note: an unsuffixed integer value, e.g., `1`, is expected\n \n-error: aborting due to 2 previous errors; 1 warning emitted\n+error: aborting due to 2 previous errors\n "}, {"sha": "9feed394110467107d22b7054eea4e4d765e5b2c", "filename": "src/test/ui/rfc-2627-raw-dylib/link-ordinal-missing-argument.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-missing-argument.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-missing-argument.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-missing-argument.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,5 +1,4 @@\n-#![feature(raw_dylib)]\n-//~^ WARN the feature `raw_dylib` is incomplete\n+#![cfg_attr(target_arch = \"x86\", feature(raw_dylib))]\n \n #[link(name = \"foo\")]\n extern \"C\" {"}, {"sha": "853cdad8c1c541c3397e96e78bb6847d4c0c241b", "filename": "src/test/ui/rfc-2627-raw-dylib/link-ordinal-missing-argument.stderr", "status": "modified", "additions": 3, "deletions": 12, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-missing-argument.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-missing-argument.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-missing-argument.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,27 +1,18 @@\n-warning: the feature `raw_dylib` is incomplete and may not be safe to use and/or cause compiler crashes\n-  --> $DIR/link-ordinal-missing-argument.rs:1:12\n-   |\n-LL | #![feature(raw_dylib)]\n-   |            ^^^^^^^^^\n-   |\n-   = note: `#[warn(incomplete_features)]` on by default\n-   = note: see issue #58713 <https://github.com/rust-lang/rust/issues/58713> for more information\n-\n error: incorrect number of arguments to `#[link_ordinal]`\n-  --> $DIR/link-ordinal-missing-argument.rs:6:5\n+  --> $DIR/link-ordinal-missing-argument.rs:5:5\n    |\n LL |     #[link_ordinal()]\n    |     ^^^^^^^^^^^^^^^^^\n    |\n    = note: the attribute requires exactly one argument\n \n error: incorrect number of arguments to `#[link_ordinal]`\n-  --> $DIR/link-ordinal-missing-argument.rs:9:5\n+  --> $DIR/link-ordinal-missing-argument.rs:8:5\n    |\n LL |     #[link_ordinal()]\n    |     ^^^^^^^^^^^^^^^^^\n    |\n    = note: the attribute requires exactly one argument\n \n-error: aborting due to 2 previous errors; 1 warning emitted\n+error: aborting due to 2 previous errors\n "}, {"sha": "631c363d4ba1594dc06dbfb3f780bc0a88ff11d8", "filename": "src/test/ui/rfc-2627-raw-dylib/link-ordinal-multiple.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-multiple.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-multiple.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-multiple.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,6 +1,5 @@\n // only-windows\n-#![feature(raw_dylib)]\n-//~^ WARN the feature `raw_dylib` is incomplete\n+#![cfg_attr(target_arch = \"x86\", feature(raw_dylib))]\n \n #[link(name = \"foo\", kind = \"raw-dylib\")]\n extern \"C\" {"}, {"sha": "c0453d2bf0118edfbc13c91f897cc7a85b72d508", "filename": "src/test/ui/rfc-2627-raw-dylib/link-ordinal-multiple.stderr", "status": "modified", "additions": 5, "deletions": 14, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-multiple.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-multiple.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-multiple.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,35 +1,26 @@\n-warning: the feature `raw_dylib` is incomplete and may not be safe to use and/or cause compiler crashes\n-  --> $DIR/link-ordinal-multiple.rs:2:12\n-   |\n-LL | #![feature(raw_dylib)]\n-   |            ^^^^^^^^^\n-   |\n-   = note: `#[warn(incomplete_features)]` on by default\n-   = note: see issue #58713 <https://github.com/rust-lang/rust/issues/58713> for more information\n-\n error: multiple `link_ordinal` attributes\n-  --> $DIR/link-ordinal-multiple.rs:7:5\n+  --> $DIR/link-ordinal-multiple.rs:6:5\n    |\n LL |     #[link_ordinal(1)]\n    |     ^^^^^^^^^^^^^^^^^^ help: remove this attribute\n    |\n note: attribute also specified here\n-  --> $DIR/link-ordinal-multiple.rs:8:5\n+  --> $DIR/link-ordinal-multiple.rs:7:5\n    |\n LL |     #[link_ordinal(2)]\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: multiple `link_ordinal` attributes\n-  --> $DIR/link-ordinal-multiple.rs:10:5\n+  --> $DIR/link-ordinal-multiple.rs:9:5\n    |\n LL |     #[link_ordinal(1)]\n    |     ^^^^^^^^^^^^^^^^^^ help: remove this attribute\n    |\n note: attribute also specified here\n-  --> $DIR/link-ordinal-multiple.rs:11:5\n+  --> $DIR/link-ordinal-multiple.rs:10:5\n    |\n LL |     #[link_ordinal(2)]\n    |     ^^^^^^^^^^^^^^^^^^\n \n-error: aborting due to 2 previous errors; 1 warning emitted\n+error: aborting due to 2 previous errors\n "}, {"sha": "54e614164b3a50cb52232065f69800061f1ae7b9", "filename": "src/test/ui/rfc-2627-raw-dylib/link-ordinal-not-foreign-fn.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-not-foreign-fn.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-not-foreign-fn.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-not-foreign-fn.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,5 +1,4 @@\n-#![feature(raw_dylib)]\n-//~^ WARN the feature `raw_dylib` is incomplete\n+#![cfg_attr(target_arch = \"x86\", feature(raw_dylib))]\n \n #[link_ordinal(123)]\n //~^ ERROR attribute should be applied to a foreign function or static"}, {"sha": "ec4104fbe50003b623eb704e2c65f0e3f31acb8f", "filename": "src/test/ui/rfc-2627-raw-dylib/link-ordinal-not-foreign-fn.stderr", "status": "modified", "additions": 4, "deletions": 13, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-not-foreign-fn.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-not-foreign-fn.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-not-foreign-fn.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,29 +1,20 @@\n-warning: the feature `raw_dylib` is incomplete and may not be safe to use and/or cause compiler crashes\n-  --> $DIR/link-ordinal-not-foreign-fn.rs:1:12\n-   |\n-LL | #![feature(raw_dylib)]\n-   |            ^^^^^^^^^\n-   |\n-   = note: `#[warn(incomplete_features)]` on by default\n-   = note: see issue #58713 <https://github.com/rust-lang/rust/issues/58713> for more information\n-\n error: attribute should be applied to a foreign function or static\n-  --> $DIR/link-ordinal-not-foreign-fn.rs:4:1\n+  --> $DIR/link-ordinal-not-foreign-fn.rs:3:1\n    |\n LL | #[link_ordinal(123)]\n    | ^^^^^^^^^^^^^^^^^^^^\n \n error: attribute should be applied to a foreign function or static\n-  --> $DIR/link-ordinal-not-foreign-fn.rs:8:1\n+  --> $DIR/link-ordinal-not-foreign-fn.rs:7:1\n    |\n LL | #[link_ordinal(123)]\n    | ^^^^^^^^^^^^^^^^^^^^\n \n error: attribute should be applied to a foreign function or static\n-  --> $DIR/link-ordinal-not-foreign-fn.rs:12:1\n+  --> $DIR/link-ordinal-not-foreign-fn.rs:11:1\n    |\n LL | #[link_ordinal(42)]\n    | ^^^^^^^^^^^^^^^^^^^\n \n-error: aborting due to 3 previous errors; 1 warning emitted\n+error: aborting due to 3 previous errors\n "}, {"sha": "46731581ebcb0c2ba29957cfa462ced6f834eb98", "filename": "src/test/ui/rfc-2627-raw-dylib/link-ordinal-too-large.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-too-large.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-too-large.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-too-large.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,5 +1,4 @@\n-#![feature(raw_dylib)]\n-//~^ WARN the feature `raw_dylib` is incomplete\n+#![cfg_attr(target_arch = \"x86\", feature(raw_dylib))]\n \n #[link(name = \"foo\")]\n extern \"C\" {"}, {"sha": "fef6de6aedfe45a01c40e7dac0f646df6c346bed", "filename": "src/test/ui/rfc-2627-raw-dylib/link-ordinal-too-large.stderr", "status": "modified", "additions": 3, "deletions": 12, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-too-large.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-too-large.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-too-large.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,27 +1,18 @@\n-warning: the feature `raw_dylib` is incomplete and may not be safe to use and/or cause compiler crashes\n-  --> $DIR/link-ordinal-too-large.rs:1:12\n-   |\n-LL | #![feature(raw_dylib)]\n-   |            ^^^^^^^^^\n-   |\n-   = note: `#[warn(incomplete_features)]` on by default\n-   = note: see issue #58713 <https://github.com/rust-lang/rust/issues/58713> for more information\n-\n error: ordinal value in `link_ordinal` is too large: `72436`\n-  --> $DIR/link-ordinal-too-large.rs:6:5\n+  --> $DIR/link-ordinal-too-large.rs:5:5\n    |\n LL |     #[link_ordinal(72436)]\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n    |\n    = note: the value may not exceed `u16::MAX`\n \n error: ordinal value in `link_ordinal` is too large: `72436`\n-  --> $DIR/link-ordinal-too-large.rs:9:5\n+  --> $DIR/link-ordinal-too-large.rs:8:5\n    |\n LL |     #[link_ordinal(72436)]\n    |     ^^^^^^^^^^^^^^^^^^^^^^\n    |\n    = note: the value may not exceed `u16::MAX`\n \n-error: aborting due to 2 previous errors; 1 warning emitted\n+error: aborting due to 2 previous errors\n "}, {"sha": "71e0ac9f3ee4bc7d5578deda7c906f6fc6fcd95d", "filename": "src/test/ui/rfc-2627-raw-dylib/link-ordinal-too-many-arguments.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-too-many-arguments.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-too-many-arguments.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-too-many-arguments.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,5 +1,4 @@\n-#![feature(raw_dylib)]\n-//~^ WARN the feature `raw_dylib` is incomplete\n+#![cfg_attr(target_arch = \"x86\", feature(raw_dylib))]\n \n #[link(name = \"foo\")]\n extern \"C\" {"}, {"sha": "7e0fcd845cbde5829d35048d197eda9da6e13708", "filename": "src/test/ui/rfc-2627-raw-dylib/link-ordinal-too-many-arguments.stderr", "status": "modified", "additions": 3, "deletions": 12, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-too-many-arguments.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-too-many-arguments.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-too-many-arguments.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,27 +1,18 @@\n-warning: the feature `raw_dylib` is incomplete and may not be safe to use and/or cause compiler crashes\n-  --> $DIR/link-ordinal-too-many-arguments.rs:1:12\n-   |\n-LL | #![feature(raw_dylib)]\n-   |            ^^^^^^^^^\n-   |\n-   = note: `#[warn(incomplete_features)]` on by default\n-   = note: see issue #58713 <https://github.com/rust-lang/rust/issues/58713> for more information\n-\n error: incorrect number of arguments to `#[link_ordinal]`\n-  --> $DIR/link-ordinal-too-many-arguments.rs:6:5\n+  --> $DIR/link-ordinal-too-many-arguments.rs:5:5\n    |\n LL |     #[link_ordinal(3, 4)]\n    |     ^^^^^^^^^^^^^^^^^^^^^\n    |\n    = note: the attribute requires exactly one argument\n \n error: incorrect number of arguments to `#[link_ordinal]`\n-  --> $DIR/link-ordinal-too-many-arguments.rs:9:5\n+  --> $DIR/link-ordinal-too-many-arguments.rs:8:5\n    |\n LL |     #[link_ordinal(3, 4)]\n    |     ^^^^^^^^^^^^^^^^^^^^^\n    |\n    = note: the attribute requires exactly one argument\n \n-error: aborting due to 2 previous errors; 1 warning emitted\n+error: aborting due to 2 previous errors\n "}, {"sha": "329c93fc19637c6ab7ffecb8f04f6cdfcf3c5a6a", "filename": "src/test/ui/rfc-2627-raw-dylib/link-ordinal-unsupported-link-kind.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-unsupported-link-kind.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-unsupported-link-kind.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-unsupported-link-kind.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,5 +1,4 @@\n-#![feature(raw_dylib)]\n-//~^ WARN the feature `raw_dylib` is incomplete\n+#![cfg_attr(target_arch = \"x86\", feature(raw_dylib))]\n \n #[link(name = \"foo\")]\n extern \"C\" {"}, {"sha": "5fbffbda570af49dfa9b0b87dbeeadfd6ec3395a", "filename": "src/test/ui/rfc-2627-raw-dylib/link-ordinal-unsupported-link-kind.stderr", "status": "modified", "additions": 3, "deletions": 12, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-unsupported-link-kind.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-unsupported-link-kind.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Flink-ordinal-unsupported-link-kind.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,23 +1,14 @@\n-warning: the feature `raw_dylib` is incomplete and may not be safe to use and/or cause compiler crashes\n-  --> $DIR/link-ordinal-unsupported-link-kind.rs:1:12\n-   |\n-LL | #![feature(raw_dylib)]\n-   |            ^^^^^^^^^\n-   |\n-   = note: `#[warn(incomplete_features)]` on by default\n-   = note: see issue #58713 <https://github.com/rust-lang/rust/issues/58713> for more information\n-\n error: `#[link_ordinal]` is only supported if link kind is `raw-dylib`\n-  --> $DIR/link-ordinal-unsupported-link-kind.rs:6:5\n+  --> $DIR/link-ordinal-unsupported-link-kind.rs:5:5\n    |\n LL |     #[link_ordinal(3)]\n    |     ^^^^^^^^^^^^^^^^^^\n \n error: `#[link_ordinal]` is only supported if link kind is `raw-dylib`\n-  --> $DIR/link-ordinal-unsupported-link-kind.rs:13:5\n+  --> $DIR/link-ordinal-unsupported-link-kind.rs:12:5\n    |\n LL |     #[link_ordinal(3)]\n    |     ^^^^^^^^^^^^^^^^^^\n \n-error: aborting due to 2 previous errors; 1 warning emitted\n+error: aborting due to 2 previous errors\n "}, {"sha": "6542faad2641248b35d513a8c7c307b7ed4500d5", "filename": "src/test/ui/rfc-2627-raw-dylib/multiple-declarations.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fmultiple-declarations.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fmultiple-declarations.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fmultiple-declarations.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -3,7 +3,6 @@\n // compile-flags: --crate-type lib --emit link\n #![allow(clashing_extern_declarations)]\n #![feature(raw_dylib)]\n-//~^ WARN the feature `raw_dylib` is incomplete\n #[link(name = \"foo\", kind = \"raw-dylib\")]\n extern \"C\" {\n     fn f(x: i32);"}, {"sha": "c6808bec7b5c5f4ae0a82268211ff5109c71680b", "filename": "src/test/ui/rfc-2627-raw-dylib/multiple-declarations.stderr", "status": "modified", "additions": 2, "deletions": 11, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fmultiple-declarations.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fmultiple-declarations.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fmultiple-declarations.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,17 +1,8 @@\n-warning: the feature `raw_dylib` is incomplete and may not be safe to use and/or cause compiler crashes\n-  --> $DIR/multiple-declarations.rs:5:12\n-   |\n-LL | #![feature(raw_dylib)]\n-   |            ^^^^^^^^^\n-   |\n-   = note: `#[warn(incomplete_features)]` on by default\n-   = note: see issue #58713 <https://github.com/rust-lang/rust/issues/58713> for more information\n-\n error: multiple declarations of external function `f` from library `foo.dll` have different calling conventions\n-  --> $DIR/multiple-declarations.rs:15:9\n+  --> $DIR/multiple-declarations.rs:14:9\n    |\n LL |         fn f(x: i32);\n    |         ^^^^^^^^^^^^^\n \n-error: aborting due to previous error; 1 warning emitted\n+error: aborting due to previous error\n "}, {"sha": "4efffbd532e133aa26d188d03880b083b449e430", "filename": "src/test/ui/rfc-2627-raw-dylib/raw-dylib-windows-only.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fraw-dylib-windows-only.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fraw-dylib-windows-only.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fraw-dylib-windows-only.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,7 +1,6 @@\n // ignore-windows\n // compile-flags: --crate-type lib\n-#![feature(raw_dylib)]\n-//~^ WARNING: the feature `raw_dylib` is incomplete\n+#![cfg_attr(target_arch = \"x86\", feature(raw_dylib))]\n #[link(name = \"foo\", kind = \"raw-dylib\")]\n //~^ ERROR: link kind `raw-dylib` is only supported on Windows targets\n extern \"C\" {}"}, {"sha": "14e791f1fb9a1199b1446cefb0360a1b58b415f2", "filename": "src/test/ui/rfc-2627-raw-dylib/raw-dylib-windows-only.stderr", "status": "modified", "additions": 2, "deletions": 11, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fraw-dylib-windows-only.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fraw-dylib-windows-only.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Fraw-dylib-windows-only.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,18 +1,9 @@\n-warning: the feature `raw_dylib` is incomplete and may not be safe to use and/or cause compiler crashes\n-  --> $DIR/raw-dylib-windows-only.rs:3:12\n-   |\n-LL | #![feature(raw_dylib)]\n-   |            ^^^^^^^^^\n-   |\n-   = note: `#[warn(incomplete_features)]` on by default\n-   = note: see issue #58713 <https://github.com/rust-lang/rust/issues/58713> for more information\n-\n error[E0455]: link kind `raw-dylib` is only supported on Windows targets\n-  --> $DIR/raw-dylib-windows-only.rs:5:29\n+  --> $DIR/raw-dylib-windows-only.rs:4:29\n    |\n LL | #[link(name = \"foo\", kind = \"raw-dylib\")]\n    |                             ^^^^^^^^^^^\n \n-error: aborting due to previous error; 1 warning emitted\n+error: aborting due to previous error\n \n For more information about this error, try `rustc --explain E0455`."}, {"sha": "2f5a23e47a74963e5d9341b9e8553f1444f5448f", "filename": "src/test/ui/rfc-2627-raw-dylib/unsupported-abi.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Funsupported-abi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Funsupported-abi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Funsupported-abi.rs?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,8 +1,6 @@\n // only-x86_64\n // only-windows\n // compile-flags: --crate-type lib --emit link\n-#![allow(incomplete_features)]\n-#![feature(raw_dylib)]\n #[link(name = \"foo\", kind = \"raw-dylib\")]\n extern \"stdcall\" {\n     fn f(x: i32);"}, {"sha": "f8265ae691948948f0610495797ad854762b4b60", "filename": "src/test/ui/rfc-2627-raw-dylib/unsupported-abi.stderr", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Funsupported-abi.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/cedd26b1ea066fe243b82b0f78e37066c6f4d789/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Funsupported-abi.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Frfc-2627-raw-dylib%2Funsupported-abi.stderr?ref=cedd26b1ea066fe243b82b0f78e37066c6f4d789", "patch": "@@ -1,5 +1,5 @@\n error: ABI not supported by `#[link(kind = \"raw-dylib\")]` on this architecture\n-  --> $DIR/unsupported-abi.rs:8:5\n+  --> $DIR/unsupported-abi.rs:6:5\n    |\n LL |     fn f(x: i32);\n    |     ^^^^^^^^^^^^^"}]}