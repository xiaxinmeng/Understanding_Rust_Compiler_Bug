{"sha": "973fd3c4f2208c641b59704f357e535518cf7e70", "node_id": "MDY6Q29tbWl0NzI0NzEyOjk3M2ZkM2M0ZjIyMDhjNjQxYjU5NzA0ZjM1N2U1MzU1MThjZjdlNzA=", "commit": {"author": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-03-29T21:56:24Z"}, "committer": {"name": "Graydon Hoare", "email": "graydon@mozilla.com", "date": "2011-03-29T21:56:57Z"}, "message": "Add -lstd to the stage0, 1, 2 test executable link commands.", "tree": {"sha": "3c24fa8827bd04a4d1a67161c4cef974050c8634", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3c24fa8827bd04a4d1a67161c4cef974050c8634"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/973fd3c4f2208c641b59704f357e535518cf7e70", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/973fd3c4f2208c641b59704f357e535518cf7e70", "html_url": "https://github.com/rust-lang/rust/commit/973fd3c4f2208c641b59704f357e535518cf7e70", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/973fd3c4f2208c641b59704f357e535518cf7e70/comments", "author": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "committer": {"login": "graydon", "id": 14097, "node_id": "MDQ6VXNlcjE0MDk3", "avatar_url": "https://avatars.githubusercontent.com/u/14097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/graydon", "html_url": "https://github.com/graydon", "followers_url": "https://api.github.com/users/graydon/followers", "following_url": "https://api.github.com/users/graydon/following{/other_user}", "gists_url": "https://api.github.com/users/graydon/gists{/gist_id}", "starred_url": "https://api.github.com/users/graydon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/graydon/subscriptions", "organizations_url": "https://api.github.com/users/graydon/orgs", "repos_url": "https://api.github.com/users/graydon/repos", "events_url": "https://api.github.com/users/graydon/events{/privacy}", "received_events_url": "https://api.github.com/users/graydon/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "94c061729b66adc777cf346417ab236a5d7d8410", "url": "https://api.github.com/repos/rust-lang/rust/commits/94c061729b66adc777cf346417ab236a5d7d8410", "html_url": "https://github.com/rust-lang/rust/commit/94c061729b66adc777cf346417ab236a5d7d8410"}], "stats": {"total": 17, "additions": 11, "deletions": 6}, "files": [{"sha": "c71489389dfeedfb1e0515d34f0b4a8d2f6ce7b5", "filename": "Makefile.in", "status": "modified", "additions": 11, "deletions": 6, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/973fd3c4f2208c641b59704f357e535518cf7e70/Makefile.in", "raw_url": "https://github.com/rust-lang/rust/raw/973fd3c4f2208c641b59704f357e535518cf7e70/Makefile.in", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/Makefile.in?ref=973fd3c4f2208c641b59704f357e535518cf7e70", "patch": "@@ -71,6 +71,8 @@ endif\n \n CFG_LDPATH :=$(CFG_BUILD_DIR)/rt\n CFG_LDPATH :=$(CFG_LDPATH):$(CFG_BUILD_DIR)/rustllvm\n+CFG_TESTLIB=$(dir $(firstword $(1))):$(patsubst .%,%,$(suffix $(1)))\n+CFG_EXE_TESTLIB=$(call CFG_TESTLIB,$(patsubst %.exe,%))\n \n ifdef CFG_WINDOWSY\n   CFG_INFO := $(info cfg: windows-y environment)\n@@ -79,7 +81,7 @@ ifdef CFG_WINDOWSY\n   CFG_LIB_NAME=$(1).dll\n   CFG_LDPATH :=$(CFG_LDPATH):$(CFG_LLVM_BINDIR)\n   CFG_LDPATH :=$(CFG_LDPATH):$$PATH\n-  CFG_RUN_TEST=PATH=\"$(CFG_LDPATH)\" $(1)\n+  CFG_RUN_TEST=PATH=\"$(CFG_LDPATH):$(call CFG_EXE_TESTLIB,$(1))\" $(1)\n   CFG_RUN_TARG=PATH=\"$(CFG_LDPATH)\" $(1)\n \n   CFG_PATH_MUNGE := $(strip perl -i.bak -p             \\\n@@ -101,7 +103,7 @@ ifdef CFG_UNIXY\n   CFG_LDPATH :=$(CFG_LDPATH):$(CFG_LLVM_LIBDIR)\n   CFG_RUN_TARG=$(CFG_LDENV)=$(CFG_LDPATH) $(1)\n   CFG_RUN_TEST=\\\n-      $(CFG_LDENV)=$(dir $(firstword $(1))):$(CFG_LDPATH) \\\n+      $(CFG_LDENV)=$(call CFG_TESTLIB,$(1)):$(CFG_LDPATH) \\\n       $(CFG_VALGRIND) $(1)\n \n   CFG_BOOT_NATIVE := 1\n@@ -112,7 +114,7 @@ ifdef CFG_UNIXY\n     CFG_LDPATH :=$(CFG_LDPATH):$(CFG_LLVM_BINDIR)\n     CFG_LDPATH :=$(CFG_LDPATH):$$PATH\n     CFG_RUN_TARG=PATH=$(CFG_LDPATH) $(1)\n-    CFG_RUN_TEST=PATH=$(CFG_LDPATH) $(1)\n+    CFG_RUN_TEST=PATH=$(CFG_LDPATH):$(call CFG_EXE_TESTLIB,$(1)) $(1)\n \n     CFG_INFO := $(info cfg: mingw-cross)\n     CFG_GCC_CROSS := i586-mingw32msvc-\n@@ -714,23 +716,26 @@ compile-check: tidy \\\n \n %.stage0$(X): %.stage0.o rt/$(CFG_RUNTIME) stage0/glue.o\n \t@$(call E, link [gcc]: $@)\n-\t$(Q)gcc $(CFG_GCC_CFLAGS) stage0/glue.o -o $@ $< -Lstage0 -Lrt -lrustrt\n+\t$(Q)gcc $(CFG_GCC_CFLAGS) stage0/glue.o -o $@ $< \\\n+      -Lstage0 -Lrt -lrustrt -lstd\n \t@# dsymutil sometimes fails or prints a warning, but the\n \t@# program still runs.  Since it simplifies debugging other\n \t@# programs, I\\'ll live with the noise.\n \t-$(Q)$(CFG_DSYMUTIL) $@\n \n %.stage1(X): %.stage1.o rt/$(CFG_RUNTIME) stage1/glue.o\n \t@$(call E, link [gcc]: $@)\n-\t$(Q)gcc $(CFG_GCC_CFLAGS) stage1/glue.o -o $@ $< -Lstage1 -Lrt -lrustrt\n+\t$(Q)gcc $(CFG_GCC_CFLAGS) stage1/glue.o -o $@ $< \\\n+      -Lstage1 -Lrt -lrustrt -lstd\n \t@# dsymutil sometimes fails or prints a warning, but the\n \t@# program still runs.  Since it simplifies debugging other\n \t@# programs, I\\'ll live with the noise.\n \t-$(Q)$(CFG_DSYMUTIL) $@\n \n %.stage2$(X): %.stage2.o rt/$(CFG_RUNTIME) stage2/glue.o\n \t@$(call E, link [gcc]: $@)\n-\t$(Q)gcc $(CFG_GCC_CFLAGS) stage2/glue.o -o $@ $< -Lstage2 -Lrt -lrustrt\n+\t$(Q)gcc $(CFG_GCC_CFLAGS) stage2/glue.o -o $@ $< \\\n+      -Lstage2 -Lrt -lrustrt -lstd\n \t@# dsymutil sometimes fails or prints a warning, but the\n \t@# program still runs.  Since it simplifies debugging other\n \t@# programs, I\\'ll live with the noise."}]}