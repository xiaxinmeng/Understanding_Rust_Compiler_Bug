{"sha": "92ef0c4bffeae68689f5e3f8173c4ad309518409", "node_id": "MDY6Q29tbWl0NzI0NzEyOjkyZWYwYzRiZmZlYWU2ODY4OWY1ZTNmODE3M2M0YWQzMDk1MTg0MDk=", "commit": {"author": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-11-08T23:10:19Z"}, "committer": {"name": "Felix S. Klock II", "email": "pnkfelix@pnkfx.org", "date": "2018-11-08T23:14:11Z"}, "message": "Make test robust to NLL, in sense of ensuring borrows extend to something approximating lexical scope.", "tree": {"sha": "becc64431da8388b3c3ba5f41a3e340382e993e3", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/becc64431da8388b3c3ba5f41a3e340382e993e3"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/92ef0c4bffeae68689f5e3f8173c4ad309518409", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/92ef0c4bffeae68689f5e3f8173c4ad309518409", "html_url": "https://github.com/rust-lang/rust/commit/92ef0c4bffeae68689f5e3f8173c4ad309518409", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/92ef0c4bffeae68689f5e3f8173c4ad309518409/comments", "author": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pnkfelix", "id": 173127, "node_id": "MDQ6VXNlcjE3MzEyNw==", "avatar_url": "https://avatars.githubusercontent.com/u/173127?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pnkfelix", "html_url": "https://github.com/pnkfelix", "followers_url": "https://api.github.com/users/pnkfelix/followers", "following_url": "https://api.github.com/users/pnkfelix/following{/other_user}", "gists_url": "https://api.github.com/users/pnkfelix/gists{/gist_id}", "starred_url": "https://api.github.com/users/pnkfelix/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pnkfelix/subscriptions", "organizations_url": "https://api.github.com/users/pnkfelix/orgs", "repos_url": "https://api.github.com/users/pnkfelix/repos", "events_url": "https://api.github.com/users/pnkfelix/events{/privacy}", "received_events_url": "https://api.github.com/users/pnkfelix/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "653da4fd006c97625247acd7e076d0782cdc149b", "url": "https://api.github.com/repos/rust-lang/rust/commits/653da4fd006c97625247acd7e076d0782cdc149b", "html_url": "https://github.com/rust-lang/rust/commit/653da4fd006c97625247acd7e076d0782cdc149b"}], "stats": {"total": 31, "additions": 17, "deletions": 14}, "files": [{"sha": "5efc414da7731219c1f3de32e95ad6a3a07ce082", "filename": "src/test/ui/borrowck/borrowck-box-insensitivity.rs", "status": "modified", "additions": 13, "deletions": 10, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/92ef0c4bffeae68689f5e3f8173c4ad309518409/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-box-insensitivity.rs", "raw_url": "https://github.com/rust-lang/rust/raw/92ef0c4bffeae68689f5e3f8173c4ad309518409/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-box-insensitivity.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-box-insensitivity.rs?ref=92ef0c4bffeae68689f5e3f8173c4ad309518409", "patch": "@@ -63,36 +63,36 @@ fn move_after_borrow() {\n     let _y = a.y;\n     //~^ ERROR cannot move\n     //~| move out of\n+    use_imm(_x);\n }\n-\n fn copy_after_mut_borrow() {\n     let mut a: Box<_> = box A { x: box 0, y: 1 };\n     let _x = &mut a.x;\n     let _y = a.y; //~ ERROR cannot use\n+    use_mut(_x);\n }\n-\n fn move_after_mut_borrow() {\n     let mut a: Box<_> = box B { x: box 0, y: box 1 };\n     let _x = &mut a.x;\n     let _y = a.y;\n     //~^ ERROR cannot move\n     //~| move out of\n+    use_mut(_x);\n }\n-\n fn borrow_after_mut_borrow() {\n     let mut a: Box<_> = box A { x: box 0, y: 1 };\n     let _x = &mut a.x;\n     let _y = &a.y; //~ ERROR cannot borrow\n     //~^ immutable borrow occurs here (via `a.y`)\n+    use_mut(_x);\n }\n-\n fn mut_borrow_after_borrow() {\n     let mut a: Box<_> = box A { x: box 0, y: 1 };\n     let _x = &a.x;\n     let _y = &mut a.y; //~ ERROR cannot borrow\n     //~^ mutable borrow occurs here (via `a.y`)\n+    use_imm(_x);\n }\n-\n fn copy_after_move_nested() {\n     let a: Box<_> = box C { x: box A { x: box 0, y: 1 }, y: 2 };\n     let _x = a.x.x;\n@@ -124,38 +124,38 @@ fn move_after_borrow_nested() {\n     let _y = a.y;\n     //~^ ERROR cannot move\n     //~| move out of\n+    use_imm(_x);\n }\n-\n fn copy_after_mut_borrow_nested() {\n     let mut a: Box<_> = box C { x: box A { x: box 0, y: 1 }, y: 2 };\n     let _x = &mut a.x.x;\n     let _y = a.y; //~ ERROR cannot use\n+    use_mut(_x);\n }\n-\n fn move_after_mut_borrow_nested() {\n     let mut a: Box<_> = box D { x: box A { x: box 0, y: 1 }, y: box 2 };\n     let _x = &mut a.x.x;\n     let _y = a.y;\n     //~^ ERROR cannot move\n     //~| move out of\n+    use_mut(_x);\n }\n-\n fn borrow_after_mut_borrow_nested() {\n     let mut a: Box<_> = box C { x: box A { x: box 0, y: 1 }, y: 2 };\n     let _x = &mut a.x.x;\n     //~^ mutable borrow occurs here\n     let _y = &a.y; //~ ERROR cannot borrow\n     //~^ immutable borrow occurs here\n+    use_mut(_x);\n }\n-\n fn mut_borrow_after_borrow_nested() {\n     let mut a: Box<_> = box C { x: box A { x: box 0, y: 1 }, y: 2 };\n     let _x = &a.x.x;\n     //~^ immutable borrow occurs here\n     let _y = &mut a.y; //~ ERROR cannot borrow\n     //~^ mutable borrow occurs here\n+    use_imm(_x);\n }\n-\n #[rustc_error]\n fn main() {\n     copy_after_move();\n@@ -180,3 +180,6 @@ fn main() {\n     borrow_after_mut_borrow_nested();\n     mut_borrow_after_borrow_nested();\n }\n+\n+fn use_mut<T>(_: &mut T) { }\n+fn use_imm<T>(_: &T) { }"}, {"sha": "b84bae748eef9a0f00b0f38df683dc8fbeb43203", "filename": "src/test/ui/borrowck/borrowck-box-insensitivity.stderr", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/92ef0c4bffeae68689f5e3f8173c4ad309518409/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-box-insensitivity.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/92ef0c4bffeae68689f5e3f8173c4ad309518409/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-box-insensitivity.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fborrowck%2Fborrowck-box-insensitivity.stderr?ref=92ef0c4bffeae68689f5e3f8173c4ad309518409", "patch": "@@ -62,7 +62,7 @@ LL |     let _x = &mut a.x;\n    |                   --- mutable borrow occurs here (via `a.x`)\n LL |     let _y = &a.y; //~ ERROR cannot borrow\n    |               ^^^ immutable borrow occurs here (via `a.y`)\n-LL |     //~^ immutable borrow occurs here (via `a.y`)\n+...\n LL | }\n    | - mutable borrow ends here\n \n@@ -73,7 +73,7 @@ LL |     let _x = &a.x;\n    |               --- immutable borrow occurs here (via `a.x`)\n LL |     let _y = &mut a.y; //~ ERROR cannot borrow\n    |                   ^^^ mutable borrow occurs here (via `a.y`)\n-LL |     //~^ mutable borrow occurs here (via `a.y`)\n+...\n LL | }\n    | - immutable borrow ends here\n \n@@ -143,7 +143,7 @@ LL |     let _x = &mut a.x.x;\n LL |     //~^ mutable borrow occurs here\n LL |     let _y = &a.y; //~ ERROR cannot borrow\n    |               ^^^ immutable borrow occurs here\n-LL |     //~^ immutable borrow occurs here\n+...\n LL | }\n    | - mutable borrow ends here\n \n@@ -155,7 +155,7 @@ LL |     let _x = &a.x.x;\n LL |     //~^ immutable borrow occurs here\n LL |     let _y = &mut a.y; //~ ERROR cannot borrow\n    |                   ^^^ mutable borrow occurs here\n-LL |     //~^ mutable borrow occurs here\n+...\n LL | }\n    | - immutable borrow ends here\n "}]}