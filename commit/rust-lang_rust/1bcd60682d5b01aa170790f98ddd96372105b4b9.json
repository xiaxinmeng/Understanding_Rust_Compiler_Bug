{"sha": "1bcd60682d5b01aa170790f98ddd96372105b4b9", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFiY2Q2MDY4MmQ1YjAxYWExNzA3OTBmOThkZGQ5NjM3MjEwNWI0Yjk=", "commit": {"author": {"name": "Ben Boeckel", "email": "mathstuf@gmail.com", "date": "2016-07-01T23:47:30Z"}, "committer": {"name": "Ben Boeckel", "email": "mathstuf@gmail.com", "date": "2016-07-08T01:10:18Z"}, "message": "llvm, rt: build using the Ninja generator if available\n\nThe Ninja generator generally builds much faster than make. It may also\nbe used on Windows to have a vast speed improvement over the Visual\nStudio generators.\n\nCurrently hidden behind an `--enable-ninja` flag because it does not\nobey the top-level `-j` or `-l` flags given to `make`.", "tree": {"sha": "46ae47d3f93f7050abce6b7a6d0196d82e0a19f7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/46ae47d3f93f7050abce6b7a6d0196d82e0a19f7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1bcd60682d5b01aa170790f98ddd96372105b4b9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1bcd60682d5b01aa170790f98ddd96372105b4b9", "html_url": "https://github.com/rust-lang/rust/commit/1bcd60682d5b01aa170790f98ddd96372105b4b9", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1bcd60682d5b01aa170790f98ddd96372105b4b9/comments", "author": {"login": "mathstuf", "id": 97253, "node_id": "MDQ6VXNlcjk3MjUz", "avatar_url": "https://avatars.githubusercontent.com/u/97253?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mathstuf", "html_url": "https://github.com/mathstuf", "followers_url": "https://api.github.com/users/mathstuf/followers", "following_url": "https://api.github.com/users/mathstuf/following{/other_user}", "gists_url": "https://api.github.com/users/mathstuf/gists{/gist_id}", "starred_url": "https://api.github.com/users/mathstuf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mathstuf/subscriptions", "organizations_url": "https://api.github.com/users/mathstuf/orgs", "repos_url": "https://api.github.com/users/mathstuf/repos", "events_url": "https://api.github.com/users/mathstuf/events{/privacy}", "received_events_url": "https://api.github.com/users/mathstuf/received_events", "type": "User", "site_admin": false}, "committer": {"login": "mathstuf", "id": 97253, "node_id": "MDQ6VXNlcjk3MjUz", "avatar_url": "https://avatars.githubusercontent.com/u/97253?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mathstuf", "html_url": "https://github.com/mathstuf", "followers_url": "https://api.github.com/users/mathstuf/followers", "following_url": "https://api.github.com/users/mathstuf/following{/other_user}", "gists_url": "https://api.github.com/users/mathstuf/gists{/gist_id}", "starred_url": "https://api.github.com/users/mathstuf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mathstuf/subscriptions", "organizations_url": "https://api.github.com/users/mathstuf/orgs", "repos_url": "https://api.github.com/users/mathstuf/repos", "events_url": "https://api.github.com/users/mathstuf/events{/privacy}", "received_events_url": "https://api.github.com/users/mathstuf/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2ad5ed07f8f3e7d5c84be2d2df747fbd90f70d68", "url": "https://api.github.com/repos/rust-lang/rust/commits/2ad5ed07f8f3e7d5c84be2d2df747fbd90f70d68", "html_url": "https://github.com/rust-lang/rust/commit/2ad5ed07f8f3e7d5c84be2d2df747fbd90f70d68"}], "stats": {"total": 28, "additions": 25, "deletions": 3}, "files": [{"sha": "3ff728b86a9f5901cf5817e6e88deaa3655069f0", "filename": "configure", "status": "modified", "additions": 16, "deletions": 1, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/1bcd60682d5b01aa170790f98ddd96372105b4b9/configure", "raw_url": "https://github.com/rust-lang/rust/raw/1bcd60682d5b01aa170790f98ddd96372105b4b9/configure", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/configure?ref=1bcd60682d5b01aa170790f98ddd96372105b4b9", "patch": "@@ -612,6 +612,7 @@ opt rustbuild 0 \"use the rust and cargo based build system\"\n opt orbit 0 \"get MIR where it belongs - everywhere; most importantly, in orbit\"\n opt codegen-tests 1 \"run the src/test/codegen tests\"\n opt option-checking 1 \"complain about unrecognized options in this configure script\"\n+opt ninja 0 \"build LLVM using the Ninja generator (for MSVC, requires building in the correct environment)\"\n \n # Optimization and debugging options. These may be overridden by the release channel, etc.\n opt_nosave optimize 1 \"build optimized rust code\"\n@@ -775,6 +776,17 @@ probe CFG_BISON            bison\n probe CFG_GDB              gdb\n probe CFG_LLDB             lldb\n \n+if [ -n \"$CFG_ENABLE_NINJA\" ]\n+then\n+  probe CFG_NINJA            ninja\n+  if [ -z \"$CFG_NINJA\" ]\n+  then\n+    # On Debian and Fedora, the `ninja` binary is an IRC bot, so the build tool was\n+    # renamed. Handle this case.\n+    probe CFG_NINJA            ninja-build\n+  fi\n+fi\n+\n # For building LLVM\n probe_need CFG_CMAKE cmake\n \n@@ -1524,7 +1536,10 @@ do\n     fi\n \n     # We need the generator later on for compiler-rt even if LLVM's not built\n-    if [ ${is_msvc} -ne 0 ]\n+    if [ -n \"$CFG_NINJA\" ]\n+    then\n+        generator=\"Ninja\"\n+    elif [ ${is_msvc} -ne 0 ]\n     then\n         case \"$CFG_MSVC_ROOT\" in\n             *14.0*)"}, {"sha": "602c20430298b8414c9e910a56244fb43ffa7125", "filename": "mk/llvm.mk", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/1bcd60682d5b01aa170790f98ddd96372105b4b9/mk%2Fllvm.mk", "raw_url": "https://github.com/rust-lang/rust/raw/1bcd60682d5b01aa170790f98ddd96372105b4b9/mk%2Fllvm.mk", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/mk%2Fllvm.mk?ref=1bcd60682d5b01aa170790f98ddd96372105b4b9", "patch": "@@ -43,15 +43,21 @@ $$(LLVM_CONFIG_$(1)): $$(LLVM_DONE_$(1))\n \n $$(LLVM_DONE_$(1)): $$(LLVM_DEPS_TARGET_$(1)) $$(LLVM_STAMP_$(1))\n \t@$$(call E, cmake: llvm)\n-ifeq ($$(findstring msvc,$(1)),msvc)\n+ifneq ($$(CFG_NINJA),)\n+\t$$(Q)$$(CFG_NINJA) -C $$(CFG_LLVM_BUILD_DIR_$(1))\n+else ifeq ($$(findstring msvc,$(1)),msvc)\n \t$$(Q)$$(CFG_CMAKE) --build $$(CFG_LLVM_BUILD_DIR_$(1)) \\\n \t\t--config $$(LLVM_BUILD_CONFIG_MODE)\n else\n \t$$(Q)$$(MAKE) -C $$(CFG_LLVM_BUILD_DIR_$(1))\n endif\n \t$$(Q)touch $$@\n \n-ifeq ($$(findstring msvc,$(1)),msvc)\n+ifneq ($$(CFG_NINJA),)\n+clean-llvm$(1):\n+\t@$$(call E, clean: llvm)\n+\t$$(Q)$$(CFG_NINJA) -C $$(CFG_LLVM_BUILD_DIR_$(1)) -t clean\n+else ifeq ($$(findstring msvc,$(1)),msvc)\n clean-llvm$(1):\n else\n clean-llvm$(1):"}, {"sha": "e64d7e5a437e6103b13f7b5a471c90fa1f9b7c5b", "filename": "src/bootstrap/config.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/1bcd60682d5b01aa170790f98ddd96372105b4b9/src%2Fbootstrap%2Fconfig.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1bcd60682d5b01aa170790f98ddd96372105b4b9/src%2Fbootstrap%2Fconfig.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fconfig.rs?ref=1bcd60682d5b01aa170790f98ddd96372105b4b9", "patch": "@@ -317,6 +317,7 @@ impl Config {\n                 (\"OPTIMIZE_TESTS\", self.rust_optimize_tests),\n                 (\"DEBUGINFO_TESTS\", self.rust_debuginfo_tests),\n                 (\"LOCAL_REBUILD\", self.local_rebuild),\n+                (\"NINJA\", self.ninja),\n             }\n \n             match key {"}]}