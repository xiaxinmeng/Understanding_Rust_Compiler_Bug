{"sha": "984e6444324d45b3f0f41ff9aeac8ab999076d97", "node_id": "C_kwDOAAsO6NoAKDk4NGU2NDQ0MzI0ZDQ1YjNmMGY0MWZmOWFlYWM4YWI5OTkwNzZkOTc", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2021-11-25T14:05:40Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-11-25T14:05:40Z"}, "message": "Rollup merge of #91185 - camelid:rm-force-overflow-checks, r=wesleywiser\n\nRemove `-Z force-overflow-checks`\n\nIt was replaced several years ago by the stable option `-C overflow-checks`.\nThe goal was to delete the `-Z` flag once users had migrated [1].\nNow that it's been several years, it makes sense to delete the old flag.\n\nSee also the discussion on Zulip [2].\n\n[1]: https://github.com/rust-lang/rust/issues/33134#issuecomment-280484097\n[2]: https://rust-lang.zulipchat.com/#narrow/stream/131828-t-compiler/topic/overflow.20checks/near/262497224\n\nr? ```@wesleywiser```\ncc ```@RalfJung```", "tree": {"sha": "4485840e883dc21c7fbce36616fe93fdca6da2f0", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4485840e883dc21c7fbce36616fe93fdca6da2f0"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/984e6444324d45b3f0f41ff9aeac8ab999076d97", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhn5g1CRBK7hj4Ov3rIwAAX1gIACQq6d2ZXHsZOWLOx8EnhjtG\nVdOD29Yb94xo7OGgsZd/iPlUD76ztVTAEwuYatEUqfls7VZPa1E6cJBBL7lfb4q2\nmGPF4h00jWH/5sHd3q+gKo2CB8+HoOVgotFBwinNch/dXWYnLo+0JhML9LaaBete\nydzP3RjEnp2O4HofXGbbnht6sLCJiJ73ROxywdDCbPXJ4x/R9sALO/kqJbI+9Jka\n0iSiENll6SaZjeNp1dKIoBxiOIGe+Iv+bVR724uut9dzykvrmkWppOmTSS+bPzfC\nb7xi6cT/ZVxHHS5nWDYk0r4CAOADk9Wy6cbHBbBUGxeAIaSZ6q360Idsk4Sg9uU=\n=FIHj\n-----END PGP SIGNATURE-----\n", "payload": "tree 4485840e883dc21c7fbce36616fe93fdca6da2f0\nparent 5fff1d77e75762d9fe581735779e9c1caef8224f\nparent f0b990a8f9992cea0220e7cf64c5d7b891296bf1\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1637849140 +0100\ncommitter GitHub <noreply@github.com> 1637849140 +0100\n\nRollup merge of #91185 - camelid:rm-force-overflow-checks, r=wesleywiser\n\nRemove `-Z force-overflow-checks`\n\nIt was replaced several years ago by the stable option `-C overflow-checks`.\nThe goal was to delete the `-Z` flag once users had migrated [1].\nNow that it's been several years, it makes sense to delete the old flag.\n\nSee also the discussion on Zulip [2].\n\n[1]: https://github.com/rust-lang/rust/issues/33134#issuecomment-280484097\n[2]: https://rust-lang.zulipchat.com/#narrow/stream/131828-t-compiler/topic/overflow.20checks/near/262497224\n\nr? ```@wesleywiser```\ncc ```@RalfJung```\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/984e6444324d45b3f0f41ff9aeac8ab999076d97", "html_url": "https://github.com/rust-lang/rust/commit/984e6444324d45b3f0f41ff9aeac8ab999076d97", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/984e6444324d45b3f0f41ff9aeac8ab999076d97/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5fff1d77e75762d9fe581735779e9c1caef8224f", "url": "https://api.github.com/repos/rust-lang/rust/commits/5fff1d77e75762d9fe581735779e9c1caef8224f", "html_url": "https://github.com/rust-lang/rust/commit/5fff1d77e75762d9fe581735779e9c1caef8224f"}, {"sha": "f0b990a8f9992cea0220e7cf64c5d7b891296bf1", "url": "https://api.github.com/repos/rust-lang/rust/commits/f0b990a8f9992cea0220e7cf64c5d7b891296bf1", "html_url": "https://github.com/rust-lang/rust/commit/f0b990a8f9992cea0220e7cf64c5d7b891296bf1"}], "stats": {"total": 15, "additions": 4, "deletions": 11}, "files": [{"sha": "6147311af6159a0e36616714b4d8b67f87ed6b01", "filename": "compiler/rustc_interface/src/tests.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/984e6444324d45b3f0f41ff9aeac8ab999076d97/compiler%2Frustc_interface%2Fsrc%2Ftests.rs", "raw_url": "https://github.com/rust-lang/rust/raw/984e6444324d45b3f0f41ff9aeac8ab999076d97/compiler%2Frustc_interface%2Fsrc%2Ftests.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_interface%2Fsrc%2Ftests.rs?ref=984e6444324d45b3f0f41ff9aeac8ab999076d97", "patch": "@@ -726,7 +726,6 @@ fn test_debugging_options_tracking_hash() {\n     tracked!(dep_info_omit_d_target, true);\n     tracked!(dual_proc_macros, true);\n     tracked!(fewer_names, Some(true));\n-    tracked!(force_overflow_checks, Some(true));\n     tracked!(force_unstable_if_unmarked, true);\n     tracked!(fuel, Some((\"abc\".to_string(), 99)));\n     tracked!(function_sections, Some(false));"}, {"sha": "4165e750df50f4bbdcf5145171d1456691796575", "filename": "compiler/rustc_session/src/options.rs", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/984e6444324d45b3f0f41ff9aeac8ab999076d97/compiler%2Frustc_session%2Fsrc%2Foptions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/984e6444324d45b3f0f41ff9aeac8ab999076d97/compiler%2Frustc_session%2Fsrc%2Foptions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_session%2Fsrc%2Foptions.rs?ref=984e6444324d45b3f0f41ff9aeac8ab999076d97", "patch": "@@ -1131,8 +1131,6 @@ options! {\n     fewer_names: Option<bool> = (None, parse_opt_bool, [TRACKED],\n         \"reduce memory use by retaining fewer names within compilation artifacts (LLVM-IR) \\\n         (default: no)\"),\n-    force_overflow_checks: Option<bool> = (None, parse_opt_bool, [TRACKED],\n-        \"force overflow checks on or off\"),\n     force_unstable_if_unmarked: bool = (false, parse_bool, [TRACKED],\n         \"force all crates to be `rustc_private` unstable (default: no)\"),\n     fuel: Option<(String, u64)> = (None, parse_optimization_fuel, [TRACKED],"}, {"sha": "54109559a3bb2fd777c493c067a7f2214b5e5166", "filename": "compiler/rustc_session/src/session.rs", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/984e6444324d45b3f0f41ff9aeac8ab999076d97/compiler%2Frustc_session%2Fsrc%2Fsession.rs", "raw_url": "https://github.com/rust-lang/rust/raw/984e6444324d45b3f0f41ff9aeac8ab999076d97/compiler%2Frustc_session%2Fsrc%2Fsession.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_session%2Fsrc%2Fsession.rs?ref=984e6444324d45b3f0f41ff9aeac8ab999076d97", "patch": "@@ -678,11 +678,7 @@ impl Session {\n         self.opts.debugging_opts.sanitizer.contains(SanitizerSet::CFI)\n     }\n     pub fn overflow_checks(&self) -> bool {\n-        self.opts\n-            .cg\n-            .overflow_checks\n-            .or(self.opts.debugging_opts.force_overflow_checks)\n-            .unwrap_or(self.opts.debug_assertions)\n+        self.opts.cg.overflow_checks.unwrap_or(self.opts.debug_assertions)\n     }\n \n     /// Check whether this compile session and crate type use static crt."}, {"sha": "a8633fd87b5e2750ae6261c27cb105e0a71b2a1c", "filename": "src/test/ui/consts/const-err.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/984e6444324d45b3f0f41ff9aeac8ab999076d97/src%2Ftest%2Fui%2Fconsts%2Fconst-err.rs", "raw_url": "https://github.com/rust-lang/rust/raw/984e6444324d45b3f0f41ff9aeac8ab999076d97/src%2Ftest%2Fui%2Fconsts%2Fconst-err.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fconsts%2Fconst-err.rs?ref=984e6444324d45b3f0f41ff9aeac8ab999076d97", "patch": "@@ -1,5 +1,5 @@\n // build-fail\n-// compile-flags: -Zforce-overflow-checks=on\n+// compile-flags: -C overflow-checks=on\n \n #![allow(arithmetic_overflow)]\n #![warn(const_err)]"}, {"sha": "0098584dd261c8e729f0e379fd25507ec9ce8908", "filename": "src/test/ui/mir/mir_overflow_off.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/984e6444324d45b3f0f41ff9aeac8ab999076d97/src%2Ftest%2Fui%2Fmir%2Fmir_overflow_off.rs", "raw_url": "https://github.com/rust-lang/rust/raw/984e6444324d45b3f0f41ff9aeac8ab999076d97/src%2Ftest%2Fui%2Fmir%2Fmir_overflow_off.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmir%2Fmir_overflow_off.rs?ref=984e6444324d45b3f0f41ff9aeac8ab999076d97", "patch": "@@ -1,5 +1,5 @@\n // run-pass\n-// compile-flags: -Z force-overflow-checks=off\n+// compile-flags: -C overflow-checks=off\n \n // Test that with MIR codegen, overflow checks can be\n // turned off, even when they're from core::ops::*."}, {"sha": "9c6dff7e1a6ca151d5d08651d1e9a7a494f9d73d", "filename": "src/test/ui/numbers-arithmetic/int-abs-overflow.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/984e6444324d45b3f0f41ff9aeac8ab999076d97/src%2Ftest%2Fui%2Fnumbers-arithmetic%2Fint-abs-overflow.rs", "raw_url": "https://github.com/rust-lang/rust/raw/984e6444324d45b3f0f41ff9aeac8ab999076d97/src%2Ftest%2Fui%2Fnumbers-arithmetic%2Fint-abs-overflow.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fnumbers-arithmetic%2Fint-abs-overflow.rs?ref=984e6444324d45b3f0f41ff9aeac8ab999076d97", "patch": "@@ -1,5 +1,5 @@\n // run-pass\n-// compile-flags: -Z force-overflow-checks=on\n+// compile-flags: -C overflow-checks=on\n // ignore-emscripten no threads support\n \n use std::thread;"}]}