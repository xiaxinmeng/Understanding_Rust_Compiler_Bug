{"sha": "345ba505ece1d0b9f929d43bd7dc37036ae3c580", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM0NWJhNTA1ZWNlMWQwYjlmOTI5ZDQzYmQ3ZGMzNzAzNmFlM2M1ODA=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2018-12-19T17:11:31Z"}, "committer": {"name": "John K\u00e5re Alsaker", "email": "john.kare.alsaker@gmail.com", "date": "2019-07-07T01:23:00Z"}, "message": "rustc: Remove `dylib` crate type from most rustc crates\n\nNow that procedural macros no longer link transitively to libsyntax,\nthis shouldn't be needed any more! This commit is an experiment in\nremoving all dynamic libraries from rustc except for librustc_driver\nitself. Let's see how far we can get with that!", "tree": {"sha": "ff4cf50193a0b23ddf3479129006368ea1332be4", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/ff4cf50193a0b23ddf3479129006368ea1332be4"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/345ba505ece1d0b9f929d43bd7dc37036ae3c580", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/345ba505ece1d0b9f929d43bd7dc37036ae3c580", "html_url": "https://github.com/rust-lang/rust/commit/345ba505ece1d0b9f929d43bd7dc37036ae3c580", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/345ba505ece1d0b9f929d43bd7dc37036ae3c580/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Zoxc", "id": 25784, "node_id": "MDQ6VXNlcjI1Nzg0", "avatar_url": "https://avatars.githubusercontent.com/u/25784?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Zoxc", "html_url": "https://github.com/Zoxc", "followers_url": "https://api.github.com/users/Zoxc/followers", "following_url": "https://api.github.com/users/Zoxc/following{/other_user}", "gists_url": "https://api.github.com/users/Zoxc/gists{/gist_id}", "starred_url": "https://api.github.com/users/Zoxc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Zoxc/subscriptions", "organizations_url": "https://api.github.com/users/Zoxc/orgs", "repos_url": "https://api.github.com/users/Zoxc/repos", "events_url": "https://api.github.com/users/Zoxc/events{/privacy}", "received_events_url": "https://api.github.com/users/Zoxc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b0bd5f236d9bea38b8c9048f379fec179b09984c", "url": "https://api.github.com/repos/rust-lang/rust/commits/b0bd5f236d9bea38b8c9048f379fec179b09984c", "html_url": "https://github.com/rust-lang/rust/commit/b0bd5f236d9bea38b8c9048f379fec179b09984c"}], "stats": {"total": 102, "additions": 18, "deletions": 84}, "files": [{"sha": "2643912f6d7d6caed2619450ef7307be05d3b332", "filename": "src/libarena/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibarena%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibarena%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibarena%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,7 +7,6 @@ edition = \"2018\"\n [lib]\n name = \"arena\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n \n [dependencies]\n rustc_data_structures = { path = \"../librustc_data_structures\" }"}, {"sha": "a95193b85952f80e0fe43c33380935966a8f5f63", "filename": "src/libfmt_macros/Cargo.toml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibfmt_macros%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibfmt_macros%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibfmt_macros%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -11,3 +11,4 @@ crate-type = [\"dylib\"]\n \n [dependencies]\n syntax_pos = { path = \"../libsyntax_pos\" }\n+"}, {"sha": "4a6e41f76031994dc7119d196f8a1cba5ab03eab", "filename": "src/libgraphviz/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibgraphviz%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibgraphviz%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibgraphviz%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,4 +7,3 @@ edition = \"2018\"\n [lib]\n name = \"graphviz\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]"}, {"sha": "7584df82ac6bc3ea91ab1287809e9db10bc1e576", "filename": "src/librustc/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,7 +7,7 @@ edition = \"2018\"\n [lib]\n name = \"rustc\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n+doctest = false\n \n [dependencies]\n arena = { path = \"../libarena\" }"}, {"sha": "8bedbefc0a68104fa9a789466fc1be9178f30885", "filename": "src/librustc/lib.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Flib.rs?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -46,7 +46,6 @@\n #![feature(extern_types)]\n #![feature(nll)]\n #![feature(non_exhaustive)]\n-#![feature(proc_macro_internals)]\n #![feature(optin_builtin_traits)]\n #![feature(range_is_empty)]\n #![feature(rustc_diagnostic_macros)]"}, {"sha": "a964f323c9e7d06214eb8831b2fbbc81a13bee58", "filename": "src/librustc_allocator/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_allocator%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_allocator%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_allocator%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -6,7 +6,6 @@ edition = \"2018\"\n \n [lib]\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n test = false\n \n [dependencies]"}, {"sha": "af6c2feed0072a9023fff52e129c1921abdcaa7c", "filename": "src/librustc_apfloat/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_apfloat%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_apfloat%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_apfloat%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -10,5 +10,4 @@ path = \"lib.rs\"\n \n [dependencies]\n bitflags = \"1.0\"\n-rustc_cratesio_shim = { path = \"../librustc_cratesio_shim\" }\n smallvec = { version = \"0.6.7\", features = [\"union\", \"may_dangle\"] }"}, {"sha": "ceade5d2788380841ab4d1d1ead04fb66ea91f3c", "filename": "src/librustc_apfloat/lib.rs", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_apfloat%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_apfloat%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_apfloat%2Flib.rs?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -35,9 +35,6 @@\n #![deny(rust_2018_idioms)]\n \n #![feature(nll)]\n-// See librustc_cratesio_shim/Cargo.toml for a comment explaining this.\n-#[allow(unused_extern_crates)]\n-extern crate rustc_cratesio_shim;\n \n use std::cmp::Ordering;\n use std::fmt;"}, {"sha": "e9abc17202e762faf04eabe6e0768a65534f93b9", "filename": "src/librustc_borrowck/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_borrowck%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_borrowck%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_borrowck%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,8 +7,8 @@ edition = \"2018\"\n [lib]\n name = \"rustc_borrowck\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n test = false\n+doctest = false\n \n [dependencies]\n log = \"0.4\""}, {"sha": "0f0b9f279175ce39b598aa3dc90a525ce50b715e", "filename": "src/librustc_codegen_llvm/lib.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_codegen_llvm%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_codegen_llvm%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_llvm%2Flib.rs?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -39,6 +39,7 @@ extern crate rustc_incremental;\n extern crate rustc_codegen_utils;\n extern crate rustc_codegen_ssa;\n extern crate rustc_fs_util;\n+extern crate rustc_driver as _;\n \n #[macro_use] extern crate log;\n #[macro_use] extern crate syntax;"}, {"sha": "343596feed25f0d0fe69616e74de0716a7b1dbbd", "filename": "src/librustc_codegen_ssa/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_codegen_ssa%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_codegen_ssa%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_ssa%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,7 +7,6 @@ edition = \"2018\"\n [lib]\n name = \"rustc_codegen_ssa\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n test = false\n \n [dependencies]"}, {"sha": "d93589ea84be0b72eed3cb3f1df7ee9dbbfc60ae", "filename": "src/librustc_codegen_utils/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_codegen_utils%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_codegen_utils%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_codegen_utils%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,7 +7,6 @@ edition = \"2018\"\n [lib]\n name = \"rustc_codegen_utils\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n test = false\n \n [dependencies]"}, {"sha": "6bdfbe09354b40530cb730696380e65cfc7fb664", "filename": "src/librustc_cratesio_shim/Cargo.toml", "status": "removed", "additions": 0, "deletions": 26, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/b0bd5f236d9bea38b8c9048f379fec179b09984c/src%2Flibrustc_cratesio_shim%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/b0bd5f236d9bea38b8c9048f379fec179b09984c/src%2Flibrustc_cratesio_shim%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_cratesio_shim%2FCargo.toml?ref=b0bd5f236d9bea38b8c9048f379fec179b09984c", "patch": "@@ -1,26 +0,0 @@\n-# This crate exists to allow rustc to link certain crates from crates.io into\n-# the distribution. This doesn't work normally because:\n-#\n-# - Cargo always builds dependencies as rlibs:\n-#   https://github.com/rust-lang/cargo/issues/629\n-# - rustc wants to avoid multiple definitions of the same symbol, so it refuses\n-#   to link multiple dylibs containing the same rlib\n-# - multiple dylibs depend on the same crates.io crates\n-#\n-# This solution works by including all the conflicting rlibs in a single dylib,\n-# which is then linked into all dylibs that depend on these crates.io crates.\n-# The result is that each rlib only appears once, and things work!\n-\n-[package]\n-authors = [\"The Rust Project Developers\"]\n-name = \"rustc_cratesio_shim\"\n-version = \"0.0.0\"\n-edition = \"2018\"\n-\n-[lib]\n-crate-type = [\"dylib\"]\n-\n-[dependencies]\n-bitflags = \"1.0\"\n-log = \"0.4\"\n-unicode-width = \"0.1.4\""}, {"sha": "4c170f4f5f6f98bec42cd3d87e0d55905e4ad2a2", "filename": "src/librustc_cratesio_shim/src/lib.rs", "status": "removed", "additions": 0, "deletions": 11, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/b0bd5f236d9bea38b8c9048f379fec179b09984c/src%2Flibrustc_cratesio_shim%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/b0bd5f236d9bea38b8c9048f379fec179b09984c/src%2Flibrustc_cratesio_shim%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_cratesio_shim%2Fsrc%2Flib.rs?ref=b0bd5f236d9bea38b8c9048f379fec179b09984c", "patch": "@@ -1,11 +0,0 @@\n-#![deny(rust_2018_idioms)]\n-\n-// See Cargo.toml for a comment explaining this crate.\n-#![allow(unused_extern_crates)]\n-\n-#![feature(nll)]\n-\n-extern crate bitflags;\n-extern crate log;\n-extern crate proc_macro;\n-extern crate unicode_width;"}, {"sha": "acddb3448ca608ea974d9638a8892117b4df2faa", "filename": "src/librustc_data_structures/Cargo.toml", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_data_structures%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_data_structures%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_data_structures%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,15 +7,14 @@ edition = \"2018\"\n [lib]\n name = \"rustc_data_structures\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n+doctest = false\n \n [dependencies]\n ena = \"0.13\"\n indexmap = \"1\"\n log = \"0.4\"\n jobserver_crate = { version = \"0.1.13\", package = \"jobserver\" }\n lazy_static = \"1\"\n-rustc_cratesio_shim = { path = \"../librustc_cratesio_shim\" }\n serialize = { path = \"../libserialize\" }\n graphviz = { path = \"../libgraphviz\" }\n cfg-if = \"0.1.2\""}, {"sha": "b479643a5e8cd3d18207d41e98b67fed69333b29", "filename": "src/librustc_data_structures/lib.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_data_structures%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_data_structures%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_data_structures%2Flib.rs?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -38,10 +38,6 @@ extern crate libc;\n #[macro_use]\n extern crate cfg_if;\n \n-// See librustc_cratesio_shim/Cargo.toml for a comment explaining this.\n-#[allow(unused_extern_crates)]\n-extern crate rustc_cratesio_shim;\n-\n pub use rustc_serialize::hex::ToHex;\n \n #[inline(never)]"}, {"sha": "4df9632cce26bd406b5ea4c576bad3f22bebc419", "filename": "src/librustc_errors/Cargo.toml", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_errors%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_errors%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_errors%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,14 +7,13 @@ edition = \"2018\"\n [lib]\n name = \"rustc_errors\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n+doctest = false\n \n [dependencies]\n log = \"0.4\"\n serialize = { path = \"../libserialize\" }\n syntax_pos = { path = \"../libsyntax_pos\" }\n rustc_data_structures = { path = \"../librustc_data_structures\" }\n-rustc_cratesio_shim = { path = \"../librustc_cratesio_shim\" }\n unicode-width = \"0.1.4\"\n atty = \"0.2\"\n termcolor = \"1.0\""}, {"sha": "e74e3809927a0aecde5768c0d0db2e9a0ca296b7", "filename": "src/librustc_fs_util/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_fs_util%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_fs_util%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_fs_util%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,6 +7,5 @@ edition = \"2018\"\n [lib]\n name = \"rustc_fs_util\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n \n [dependencies]"}, {"sha": "9678cb4f655453a1b5860a5fa2c178f8d01367ea", "filename": "src/librustc_incremental/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_incremental%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_incremental%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_incremental%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,7 +7,7 @@ edition = \"2018\"\n [lib]\n name = \"rustc_incremental\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n+doctest = false\n \n [dependencies]\n graphviz = { path = \"../libgraphviz\" }"}, {"sha": "82880d2198712f076296bf0a769bfc1107d34542", "filename": "src/librustc_interface/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_interface%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_interface%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_interface%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,7 +7,7 @@ edition = \"2018\"\n [lib]\n name = \"rustc_interface\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n+doctest = false\n \n [dependencies]\n log = \"0.4\""}, {"sha": "041d0aaead913724cda5ab81edd5f145a7582b36", "filename": "src/librustc_lint/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_lint%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_lint%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_lint%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,7 +7,6 @@ edition = \"2018\"\n [lib]\n name = \"rustc_lint\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n \n [dependencies]\n log = \"0.4\""}, {"sha": "bdf6b0918573555ae51312e47f5e582e92318580", "filename": "src/librustc_llvm/lib.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_llvm%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_llvm%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_llvm%2Flib.rs?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -4,10 +4,6 @@\n \n #![doc(html_root_url = \"https://doc.rust-lang.org/nightly/\")]\n \n-// See librustc_cratesio_shim/Cargo.toml for a comment explaining this.\n-#[allow(unused_extern_crates)]\n-extern crate rustc_cratesio_shim;\n-\n // NOTE: This crate only exists to allow linking on mingw targets.\n \n /// Initialize targets enabled by the build script via `cfg(llvm_component = \"...\")`."}, {"sha": "e5c9f1bf2057b0c13db86a20807a7493602722f9", "filename": "src/librustc_metadata/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_metadata%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_metadata%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_metadata%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,7 +7,7 @@ edition = \"2018\"\n [lib]\n name = \"rustc_metadata\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n+doctest = false\n \n [dependencies]\n flate2 = \"1.0\""}, {"sha": "695bf1f077cd29689ac147bc4338572b47f98c99", "filename": "src/librustc_mir/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_mir%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_mir%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_mir%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,7 +7,7 @@ edition = \"2018\"\n [lib]\n name = \"rustc_mir\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n+doctest = false\n \n [dependencies]\n arena = { path = \"../libarena\" }"}, {"sha": "de2476775b07e361ae1fccba0d13934d2f140999", "filename": "src/librustc_passes/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_passes%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_passes%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_passes%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,7 +7,6 @@ edition = \"2018\"\n [lib]\n name = \"rustc_passes\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n \n [dependencies]\n log = \"0.4\""}, {"sha": "7486281c1eac187196cb9b85c101bbcb9d48dd1c", "filename": "src/librustc_plugin/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_plugin%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_plugin%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_plugin%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -8,7 +8,7 @@ edition = \"2018\"\n [lib]\n name = \"rustc_plugin\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n+doctest = false\n \n [dependencies]\n rustc = { path = \"../librustc\" }"}, {"sha": "7cf3a5d6dcde1956c46527711f674ad950c86885", "filename": "src/librustc_privacy/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_privacy%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_privacy%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_privacy%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,7 +7,6 @@ edition = \"2018\"\n [lib]\n name = \"rustc_privacy\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n \n [dependencies]\n rustc = { path = \"../librustc\" }"}, {"sha": "548f982fe3bf00ccb9c2517e154ead04ef194f38", "filename": "src/librustc_resolve/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_resolve%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_resolve%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,8 +7,8 @@ edition = \"2018\"\n [lib]\n name = \"rustc_resolve\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n test = false\n+doctest = false\n \n [dependencies]\n bitflags = \"1.0\""}, {"sha": "88bb76d2aba3a36aad94e24be13aa4f3ea792c07", "filename": "src/librustc_save_analysis/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_save_analysis%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_save_analysis%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_save_analysis%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,7 +7,6 @@ edition = \"2018\"\n [lib]\n name = \"rustc_save_analysis\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n \n [dependencies]\n log = \"0.4\""}, {"sha": "f1b21365e4bd4a7f9f10ff4def2a7dcc7f977192", "filename": "src/librustc_target/Cargo.toml", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_target%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_target%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_target%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,12 +7,10 @@ edition = \"2018\"\n [lib]\n name = \"rustc_target\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n \n [dependencies]\n bitflags = \"1.0\"\n log = \"0.4\"\n-rustc_cratesio_shim = { path = \"../librustc_cratesio_shim\" }\n rustc_data_structures = { path = \"../librustc_data_structures\" }\n serialize = { path = \"../libserialize\" }\n syntax_pos = { path = \"../libsyntax_pos\" }"}, {"sha": "c1ec4e59ef2399580196f073fc2c6f1048609cad", "filename": "src/librustc_target/lib.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_target%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_target%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_target%2Flib.rs?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -23,10 +23,6 @@\n #[allow(unused_extern_crates)]\n extern crate serialize as rustc_serialize; // used by deriving\n \n-// See librustc_cratesio_shim/Cargo.toml for a comment explaining this.\n-#[allow(unused_extern_crates)]\n-extern crate rustc_cratesio_shim;\n-\n #[macro_use]\n extern crate rustc_data_structures;\n "}, {"sha": "bb28ac839a54445821dc7390c6fa5bcf193ad188", "filename": "src/librustc_traits/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_traits%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_traits%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_traits%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,7 +7,6 @@ edition = \"2018\"\n [lib]\n name = \"rustc_traits\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n \n [dependencies]\n bitflags = \"1.0\""}, {"sha": "ac3966676838aac88d3979275e0b9234a3a94f5f", "filename": "src/librustc_typeck/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_typeck%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibrustc_typeck%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,8 +7,8 @@ edition = \"2018\"\n [lib]\n name = \"rustc_typeck\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n test = false\n+doctest = false\n \n [dependencies]\n arena = { path = \"../libarena\" }"}, {"sha": "c302bcf95dcadafe982aa26ead34a99fb217b3bb", "filename": "src/libserialize/Cargo.toml", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibserialize%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibserialize%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibserialize%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,7 +7,6 @@ edition = \"2018\"\n [lib]\n name = \"serialize\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\", \"rlib\"]\n \n [dependencies]\n indexmap = \"1\""}, {"sha": "c5daa6564767e617511bbaf61b8c9e43532d2cc8", "filename": "src/libsyntax/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibsyntax%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibsyntax%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,7 +7,7 @@ edition = \"2018\"\n [lib]\n name = \"syntax\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n+doctest = false\n \n [dependencies]\n bitflags = \"1.0\""}, {"sha": "eafbe6371a3c56f3332f983227643a74025edaf4", "filename": "src/libsyntax_ext/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibsyntax_ext%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibsyntax_ext%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax_ext%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,7 +7,7 @@ edition = \"2018\"\n [lib]\n name = \"syntax_ext\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n+doctest = false\n \n [dependencies]\n fmt_macros = { path = \"../libfmt_macros\" }"}, {"sha": "eebd25d1fafd82e37c53277f66474313255db5b1", "filename": "src/libsyntax_pos/Cargo.toml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibsyntax_pos%2FCargo.toml", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Flibsyntax_pos%2FCargo.toml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibsyntax_pos%2FCargo.toml?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -7,7 +7,7 @@ edition = \"2018\"\n [lib]\n name = \"syntax_pos\"\n path = \"lib.rs\"\n-crate-type = [\"dylib\"]\n+doctest = false\n \n [dependencies]\n serialize = { path = \"../libserialize\" }"}, {"sha": "3c4f2cd541f4eec09859ac0677a4f11cafa604a2", "filename": "src/test/run-make-fulldeps/issue-19371/foo.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Ftest%2Frun-make-fulldeps%2Fissue-19371%2Ffoo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/345ba505ece1d0b9f929d43bd7dc37036ae3c580/src%2Ftest%2Frun-make-fulldeps%2Fissue-19371%2Ffoo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-make-fulldeps%2Fissue-19371%2Ffoo.rs?ref=345ba505ece1d0b9f929d43bd7dc37036ae3c580", "patch": "@@ -2,6 +2,8 @@\n \n extern crate rustc;\n extern crate rustc_interface;\n+#[allow(unused_extern_crates)]\n+extern crate rustc_driver;\n extern crate syntax;\n \n use rustc::session::DiagnosticOutput;"}]}