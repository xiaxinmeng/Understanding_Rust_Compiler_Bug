{"sha": "50a7598773eaa57379d81c3d917ab4c84d867a51", "node_id": "MDY6Q29tbWl0NzI0NzEyOjUwYTc1OTg3NzNlYWE1NzM3OWQ4MWMzZDkxN2FiNGM4NGQ4NjdhNTE=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2019-01-25T18:10:28Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2019-01-25T18:10:51Z"}, "message": "print one size for symbols", "tree": {"sha": "0fcebddad60a74709e0f98cb565e7c15b967dfaf", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/0fcebddad60a74709e0f98cb565e7c15b967dfaf"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/50a7598773eaa57379d81c3d917ab4c84d867a51", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/50a7598773eaa57379d81c3d917ab4c84d867a51", "html_url": "https://github.com/rust-lang/rust/commit/50a7598773eaa57379d81c3d917ab4c84d867a51", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/50a7598773eaa57379d81c3d917ab4c84d867a51/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "aae69bc897f3ede3e2fecf3c9e7e24d9e254497c", "url": "https://api.github.com/repos/rust-lang/rust/commits/aae69bc897f3ede3e2fecf3c9e7e24d9e254497c", "html_url": "https://github.com/rust-lang/rust/commit/aae69bc897f3ede3e2fecf3c9e7e24d9e254497c"}], "stats": {"total": 20, "additions": 5, "deletions": 15}, "files": [{"sha": "59159df9866bc4ada5486fed239804df6f1b2b6b", "filename": "crates/ra_ide_api/src/status.rs", "status": "modified", "additions": 3, "deletions": 9, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/50a7598773eaa57379d81c3d917ab4c84d867a51/crates%2Fra_ide_api%2Fsrc%2Fstatus.rs", "raw_url": "https://github.com/rust-lang/rust/raw/50a7598773eaa57379d81c3d917ab4c84d867a51/crates%2Fra_ide_api%2Fsrc%2Fstatus.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fstatus.rs?ref=50a7598773eaa57379d81c3d917ab4c84d867a51", "patch": "@@ -94,17 +94,12 @@ impl FromIterator<TableEntry<FileId, TreeArc<SourceFile>>> for SyntaxTreeStats {\n #[derive(Default)]\n struct LibrarySymbolsStats {\n     total: usize,\n-    fst_size: Bytes,\n-    symbols_size: Bytes,\n+    size: Bytes,\n }\n \n impl fmt::Display for LibrarySymbolsStats {\n     fn fmt(&self, fmt: &mut fmt::Formatter) -> fmt::Result {\n-        write!(\n-            fmt,\n-            \"{} ({} + {}) symbols\",\n-            self.total, self.fst_size, self.symbols_size\n-        )\n+        write!(fmt, \"{} ({}) symbols\", self.total, self.size,)\n     }\n }\n \n@@ -117,8 +112,7 @@ impl FromIterator<TableEntry<SourceRootId, Arc<SymbolIndex>>> for LibrarySymbols\n         for entry in iter {\n             let value = entry.value.unwrap();\n             res.total += value.len();\n-            res.fst_size += value.fst_size();\n-            res.symbols_size += value.symbols_size();\n+            res.size += value.memory_size();\n         }\n         res\n     }"}, {"sha": "6baeabde68b4ad63f86d9897511d692fabcd4977", "filename": "crates/ra_ide_api/src/symbol_index.rs", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/rust-lang/rust/blob/50a7598773eaa57379d81c3d917ab4c84d867a51/crates%2Fra_ide_api%2Fsrc%2Fsymbol_index.rs", "raw_url": "https://github.com/rust-lang/rust/raw/50a7598773eaa57379d81c3d917ab4c84d867a51/crates%2Fra_ide_api%2Fsrc%2Fsymbol_index.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fsymbol_index.rs?ref=50a7598773eaa57379d81c3d917ab4c84d867a51", "patch": "@@ -137,12 +137,8 @@ impl SymbolIndex {\n         self.symbols.len()\n     }\n \n-    pub(crate) fn fst_size(&self) -> usize {\n-        self.map.as_fst().size()\n-    }\n-\n-    pub(crate) fn symbols_size(&self) -> usize {\n-        self.symbols.len() * mem::size_of::<FileSymbol>()\n+    pub(crate) fn memory_size(&self) -> usize {\n+        self.map.as_fst().size() * self.symbols.len() * mem::size_of::<FileSymbol>()\n     }\n \n     pub(crate) fn for_files("}]}