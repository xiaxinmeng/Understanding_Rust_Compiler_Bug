{"sha": "a8cf6cc6db13efea1057dfefbe9e6b583b23ea4f", "node_id": "MDY6Q29tbWl0NzI0NzEyOmE4Y2Y2Y2M2ZGIxM2VmZWExMDU3ZGZlZmJlOWU2YjU4M2IyM2VhNGY=", "commit": {"author": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2017-08-08T12:33:51Z"}, "committer": {"name": "Michael Woerister", "email": "michaelwoerister@posteo", "date": "2017-08-11T10:11:38Z"}, "message": "Add some ID conversion methods to HIR map and Definitions.", "tree": {"sha": "5e943b51bf248fe44835849e2d1789af430f45de", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5e943b51bf248fe44835849e2d1789af430f45de"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a8cf6cc6db13efea1057dfefbe9e6b583b23ea4f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a8cf6cc6db13efea1057dfefbe9e6b583b23ea4f", "html_url": "https://github.com/rust-lang/rust/commit/a8cf6cc6db13efea1057dfefbe9e6b583b23ea4f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a8cf6cc6db13efea1057dfefbe9e6b583b23ea4f/comments", "author": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "committer": {"login": "michaelwoerister", "id": 1825894, "node_id": "MDQ6VXNlcjE4MjU4OTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1825894?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelwoerister", "html_url": "https://github.com/michaelwoerister", "followers_url": "https://api.github.com/users/michaelwoerister/followers", "following_url": "https://api.github.com/users/michaelwoerister/following{/other_user}", "gists_url": "https://api.github.com/users/michaelwoerister/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelwoerister/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelwoerister/subscriptions", "organizations_url": "https://api.github.com/users/michaelwoerister/orgs", "repos_url": "https://api.github.com/users/michaelwoerister/repos", "events_url": "https://api.github.com/users/michaelwoerister/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelwoerister/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fbc7398badef55d58476b5410e7e911bb872f537", "url": "https://api.github.com/repos/rust-lang/rust/commits/fbc7398badef55d58476b5410e7e911bb872f537", "html_url": "https://github.com/rust-lang/rust/commit/fbc7398badef55d58476b5410e7e911bb872f537"}], "stats": {"total": 23, "additions": 23, "deletions": 0}, "files": [{"sha": "b371366bc5d5589b5de54be67b052c7583dc7f2a", "filename": "src/librustc/hir/map/definitions.rs", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/a8cf6cc6db13efea1057dfefbe9e6b583b23ea4f/src%2Flibrustc%2Fhir%2Fmap%2Fdefinitions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8cf6cc6db13efea1057dfefbe9e6b583b23ea4f/src%2Flibrustc%2Fhir%2Fmap%2Fdefinitions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fhir%2Fmap%2Fdefinitions.rs?ref=a8cf6cc6db13efea1057dfefbe9e6b583b23ea4f", "patch": "@@ -434,18 +434,22 @@ impl Definitions {\n         DefPath::make(LOCAL_CRATE, index, |p| self.def_key(p))\n     }\n \n+    #[inline]\n     pub fn opt_def_index(&self, node: ast::NodeId) -> Option<DefIndex> {\n         self.node_to_def_index.get(&node).cloned()\n     }\n \n+    #[inline]\n     pub fn opt_local_def_id(&self, node: ast::NodeId) -> Option<DefId> {\n         self.opt_def_index(node).map(DefId::local)\n     }\n \n+    #[inline]\n     pub fn local_def_id(&self, node: ast::NodeId) -> DefId {\n         self.opt_local_def_id(node).unwrap()\n     }\n \n+    #[inline]\n     pub fn as_local_node_id(&self, def_id: DefId) -> Option<ast::NodeId> {\n         if def_id.krate == LOCAL_CRATE {\n             let space_index = def_id.index.address_space().index();\n@@ -461,6 +465,7 @@ impl Definitions {\n         }\n     }\n \n+    #[inline]\n     pub fn node_to_hir_id(&self, node_id: ast::NodeId) -> hir::HirId {\n         self.node_to_hir_id[node_id]\n     }\n@@ -473,6 +478,14 @@ impl Definitions {\n             .unwrap()\n     }\n \n+    #[inline]\n+    pub fn def_index_to_hir_id(&self, def_index: DefIndex) -> hir::HirId {\n+        let space_index = def_index.address_space().index();\n+        let array_index = def_index.as_array_index();\n+        let node_id = self.def_index_to_node[space_index][array_index];\n+        self.node_to_hir_id[node_id]\n+    }\n+\n     /// Add a definition with a parent definition.\n     pub fn create_root_def(&mut self,\n                            crate_name: &str,"}, {"sha": "99ed4736a512d136da11a95a2a9869b831bb4e61", "filename": "src/librustc/hir/map/mod.rs", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/a8cf6cc6db13efea1057dfefbe9e6b583b23ea4f/src%2Flibrustc%2Fhir%2Fmap%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a8cf6cc6db13efea1057dfefbe9e6b583b23ea4f/src%2Flibrustc%2Fhir%2Fmap%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fhir%2Fmap%2Fmod.rs?ref=a8cf6cc6db13efea1057dfefbe9e6b583b23ea4f", "patch": "@@ -401,6 +401,16 @@ impl<'hir> Map<'hir> {\n         self.definitions.node_to_hir_id(node_id)\n     }\n \n+    #[inline]\n+    pub fn def_index_to_hir_id(&self, def_index: DefIndex) -> HirId {\n+        self.definitions.def_index_to_hir_id(def_index)\n+    }\n+\n+    #[inline]\n+    pub fn def_index_to_node_id(&self, def_index: DefIndex) -> NodeId {\n+        self.definitions.as_local_node_id(DefId::local(def_index)).unwrap()\n+    }\n+\n     fn entry_count(&self) -> usize {\n         self.map.len()\n     }"}]}