{"sha": "e0cea0db5da9d3671e9c68ebb264d90bd69b2c28", "node_id": "MDY6Q29tbWl0NzI0NzEyOmUwY2VhMGRiNWRhOWQzNjcxZTljNjhlYmIyNjRkOTBiZDY5YjJjMjg=", "commit": {"author": {"name": "Mazdak Farrokhzad", "email": "twingoow@gmail.com", "date": "2019-01-12T09:55:13Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2019-01-12T09:55:13Z"}, "message": "Rollup merge of #57493 - euclio:deref-suggest, r=oli-obk\n\nuse structured suggestion when casting a reference", "tree": {"sha": "2eb040cba84ca957438ae395b9df6b3cecbc64bd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/2eb040cba84ca957438ae395b9df6b3cecbc64bd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/e0cea0db5da9d3671e9c68ebb264d90bd69b2c28", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJcObmCCRBK7hj4Ov3rIwAAdHIIAAD8QW+W4tIyMHygMoZjMcxA\nQSajeVfYfxjMT4btTH/STBGgjS18/Y2J/ilUE828Rq4ckMoGD5HxMxGAiy9ucOOH\ngASlbVlR58G+vqn8lkdGbAidEMXsrzI3TD711vM+NNpkeLFuPUrVwH4YdVrJE0Ym\n+a10FKUed5Dsx0TcnkQHvgDOmffI2y849H8s32OVyeQDz94mPX48d2QU2qeuOZvt\nk0pojKSddz12yfoEywwD+j3jOuvoXoQqOD1ftMhmA2UbaNsmDUOXwkxRDe3yUmL1\nWm1o+y7NW2mntS+xgyCC2wO4sC2fyG4Wo0PZniqIh2Z0ENjcZrqUOAzR5NnBLH8=\n=AAO1\n-----END PGP SIGNATURE-----\n", "payload": "tree 2eb040cba84ca957438ae395b9df6b3cecbc64bd\nparent 1fff64a6947a4b78b2bf3dd48789149b2400df70\nparent 29a8386bb3b7ff8434f4b1b5be0fd51a48d93bb3\nauthor Mazdak Farrokhzad <twingoow@gmail.com> 1547286913 +0100\ncommitter GitHub <noreply@github.com> 1547286913 +0100\n\nRollup merge of #57493 - euclio:deref-suggest, r=oli-obk\n\nuse structured suggestion when casting a reference\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/e0cea0db5da9d3671e9c68ebb264d90bd69b2c28", "html_url": "https://github.com/rust-lang/rust/commit/e0cea0db5da9d3671e9c68ebb264d90bd69b2c28", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/e0cea0db5da9d3671e9c68ebb264d90bd69b2c28/comments", "author": {"login": "Centril", "id": 855702, "node_id": "MDQ6VXNlcjg1NTcwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/855702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Centril", "html_url": "https://github.com/Centril", "followers_url": "https://api.github.com/users/Centril/followers", "following_url": "https://api.github.com/users/Centril/following{/other_user}", "gists_url": "https://api.github.com/users/Centril/gists{/gist_id}", "starred_url": "https://api.github.com/users/Centril/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Centril/subscriptions", "organizations_url": "https://api.github.com/users/Centril/orgs", "repos_url": "https://api.github.com/users/Centril/repos", "events_url": "https://api.github.com/users/Centril/events{/privacy}", "received_events_url": "https://api.github.com/users/Centril/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1fff64a6947a4b78b2bf3dd48789149b2400df70", "url": "https://api.github.com/repos/rust-lang/rust/commits/1fff64a6947a4b78b2bf3dd48789149b2400df70", "html_url": "https://github.com/rust-lang/rust/commit/1fff64a6947a4b78b2bf3dd48789149b2400df70"}, {"sha": "29a8386bb3b7ff8434f4b1b5be0fd51a48d93bb3", "url": "https://api.github.com/repos/rust-lang/rust/commits/29a8386bb3b7ff8434f4b1b5be0fd51a48d93bb3", "html_url": "https://github.com/rust-lang/rust/commit/29a8386bb3b7ff8434f4b1b5be0fd51a48d93bb3"}], "stats": {"total": 43, "additions": 20, "deletions": 23}, "files": [{"sha": "fbba89164e6db89a52ff18b1b8eb7b8946f7157d", "filename": "src/librustc_typeck/check/cast.rs", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/rust-lang/rust/blob/e0cea0db5da9d3671e9c68ebb264d90bd69b2c28/src%2Flibrustc_typeck%2Fcheck%2Fcast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/e0cea0db5da9d3671e9c68ebb264d90bd69b2c28/src%2Flibrustc_typeck%2Fcheck%2Fcast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_typeck%2Fcheck%2Fcast.rs?ref=e0cea0db5da9d3671e9c68ebb264d90bd69b2c28", "patch": "@@ -213,8 +213,14 @@ impl<'a, 'gcx, 'tcx> CastCheck<'tcx> {\n                                        fcx.ty_to_string(self.expr_ty),\n                                        cast_ty));\n                 if let Ok(snippet) = fcx.sess().source_map().span_to_snippet(self.expr.span) {\n-                    err.span_help(self.expr.span,\n-                        &format!(\"did you mean `*{}`?\", snippet));\n+                    err.span_suggestion_with_applicability(\n+                        self.expr.span,\n+                        \"dereference the expression\",\n+                        format!(\"*{}\", snippet),\n+                        Applicability::MaybeIncorrect,\n+                    );\n+                } else {\n+                    err.span_help(self.expr.span, \"dereference the expression with `*`\");\n                 }\n                 err.emit();\n             }"}, {"sha": "89ec4896a2b4329b459efcc30c9fe5a41b9f60d9", "filename": "src/test/ui/error-codes/E0606.stderr", "status": "modified", "additions": 4, "deletions": 7, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/e0cea0db5da9d3671e9c68ebb264d90bd69b2c28/src%2Ftest%2Fui%2Ferror-codes%2FE0606.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e0cea0db5da9d3671e9c68ebb264d90bd69b2c28/src%2Ftest%2Fui%2Ferror-codes%2FE0606.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-codes%2FE0606.stderr?ref=e0cea0db5da9d3671e9c68ebb264d90bd69b2c28", "patch": "@@ -2,13 +2,10 @@ error[E0606]: casting `&u8` as `u8` is invalid\n   --> $DIR/E0606.rs:2:5\n    |\n LL |     &0u8 as u8; //~ ERROR E0606\n-   |     ^^^^^^^^^^ cannot cast `&u8` as `u8`\n-   |\n-help: did you mean `*&0u8`?\n-  --> $DIR/E0606.rs:2:5\n-   |\n-LL |     &0u8 as u8; //~ ERROR E0606\n-   |     ^^^^\n+   |     ----^^^^^^\n+   |     |\n+   |     cannot cast `&u8` as `u8`\n+   |     help: dereference the expression: `*&0u8`\n \n error: aborting due to previous error\n "}, {"sha": "ef7b49399bf3ab58e0250fcce40b1ff3e9a2c039", "filename": "src/test/ui/error-festival.stderr", "status": "modified", "additions": 4, "deletions": 7, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/e0cea0db5da9d3671e9c68ebb264d90bd69b2c28/src%2Ftest%2Fui%2Ferror-festival.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e0cea0db5da9d3671e9c68ebb264d90bd69b2c28/src%2Ftest%2Fui%2Ferror-festival.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Ferror-festival.stderr?ref=e0cea0db5da9d3671e9c68ebb264d90bd69b2c28", "patch": "@@ -60,13 +60,10 @@ error[E0606]: casting `&u8` as `u32` is invalid\n   --> $DIR/error-festival.rs:37:18\n    |\n LL |     let y: u32 = x as u32;\n-   |                  ^^^^^^^^ cannot cast `&u8` as `u32`\n-   |\n-help: did you mean `*x`?\n-  --> $DIR/error-festival.rs:37:18\n-   |\n-LL |     let y: u32 = x as u32;\n-   |                  ^\n+   |                  -^^^^^^^\n+   |                  |\n+   |                  cannot cast `&u8` as `u32`\n+   |                  help: dereference the expression: `*x`\n \n error[E0607]: cannot cast thin pointer `*const u8` to fat pointer `*const [u8]`\n   --> $DIR/error-festival.rs:41:5"}, {"sha": "fbe5e6d409934fe0fc7a8251f02a3ef8de742e27", "filename": "src/test/ui/mismatched_types/cast-rfc0401.stderr", "status": "modified", "additions": 4, "deletions": 7, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/e0cea0db5da9d3671e9c68ebb264d90bd69b2c28/src%2Ftest%2Fui%2Fmismatched_types%2Fcast-rfc0401.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/e0cea0db5da9d3671e9c68ebb264d90bd69b2c28/src%2Ftest%2Fui%2Fmismatched_types%2Fcast-rfc0401.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmismatched_types%2Fcast-rfc0401.stderr?ref=e0cea0db5da9d3671e9c68ebb264d90bd69b2c28", "patch": "@@ -240,13 +240,10 @@ error[E0606]: casting `&{float}` as `f32` is invalid\n   --> $DIR/cast-rfc0401.rs:71:30\n    |\n LL |     vec![0.0].iter().map(|s| s as f32).collect::<Vec<f32>>(); //~ ERROR is invalid\n-   |                              ^^^^^^^^ cannot cast `&{float}` as `f32`\n-   |\n-help: did you mean `*s`?\n-  --> $DIR/cast-rfc0401.rs:71:30\n-   |\n-LL |     vec![0.0].iter().map(|s| s as f32).collect::<Vec<f32>>(); //~ ERROR is invalid\n-   |                              ^\n+   |                              -^^^^^^^\n+   |                              |\n+   |                              cannot cast `&{float}` as `f32`\n+   |                              help: dereference the expression: `*s`\n \n error: aborting due to 34 previous errors\n "}]}