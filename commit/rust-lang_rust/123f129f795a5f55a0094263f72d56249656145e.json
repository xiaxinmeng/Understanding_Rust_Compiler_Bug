{"sha": "123f129f795a5f55a0094263f72d56249656145e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjEyM2YxMjlmNzk1YTVmNTVhMDA5NDI2M2Y3MmQ1NjI0OTY1NjE0NWU=", "commit": {"author": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2019-09-17T08:50:40Z"}, "committer": {"name": "Niko Matsakis", "email": "niko@alum.mit.edu", "date": "2019-09-17T08:53:28Z"}, "message": "apply nits from centril\n\nCo-Authored-By: Mazdak Farrokhzad <twingoow@gmail.com>", "tree": {"sha": "d61f2c605ac09b4a928e62267e525c618a3eb4aa", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/d61f2c605ac09b4a928e62267e525c618a3eb4aa"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/123f129f795a5f55a0094263f72d56249656145e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/123f129f795a5f55a0094263f72d56249656145e", "html_url": "https://github.com/rust-lang/rust/commit/123f129f795a5f55a0094263f72d56249656145e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/123f129f795a5f55a0094263f72d56249656145e/comments", "author": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "committer": {"login": "nikomatsakis", "id": 155238, "node_id": "MDQ6VXNlcjE1NTIzOA==", "avatar_url": "https://avatars.githubusercontent.com/u/155238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikomatsakis", "html_url": "https://github.com/nikomatsakis", "followers_url": "https://api.github.com/users/nikomatsakis/followers", "following_url": "https://api.github.com/users/nikomatsakis/following{/other_user}", "gists_url": "https://api.github.com/users/nikomatsakis/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikomatsakis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikomatsakis/subscriptions", "organizations_url": "https://api.github.com/users/nikomatsakis/orgs", "repos_url": "https://api.github.com/users/nikomatsakis/repos", "events_url": "https://api.github.com/users/nikomatsakis/events{/privacy}", "received_events_url": "https://api.github.com/users/nikomatsakis/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "00d159095adbb14c7dfaa6a77177be1b58600dc9", "url": "https://api.github.com/repos/rust-lang/rust/commits/00d159095adbb14c7dfaa6a77177be1b58600dc9", "html_url": "https://github.com/rust-lang/rust/commit/00d159095adbb14c7dfaa6a77177be1b58600dc9"}], "stats": {"total": 15, "additions": 8, "deletions": 7}, "files": [{"sha": "e40acff6dc1175af0966a7fd5d5bafe6670b57d7", "filename": "src/test/ui/async-await/drop-order/drop-order-for-temporary-in-tail-return-expr.rs", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/123f129f795a5f55a0094263f72d56249656145e/src%2Ftest%2Fui%2Fasync-await%2Fdrop-order%2Fdrop-order-for-temporary-in-tail-return-expr.rs", "raw_url": "https://github.com/rust-lang/rust/raw/123f129f795a5f55a0094263f72d56249656145e/src%2Ftest%2Fui%2Fasync-await%2Fdrop-order%2Fdrop-order-for-temporary-in-tail-return-expr.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fasync-await%2Fdrop-order%2Fdrop-order-for-temporary-in-tail-return-expr.rs?ref=123f129f795a5f55a0094263f72d56249656145e", "patch": "@@ -4,9 +4,10 @@\n \n #![allow(unused_variables)]\n \n-// Test that the drop order for parameters in a fn and async fn matches up. Also test that\n-// parameters (used or unused) are not dropped until the async fn completes execution.\n-// See also #54716.\n+// Test the drop order for parameters relative to local variables and\n+// temporaries created in the tail return expression of the function\n+// body. In particular, check that this drop order is the same between\n+// a `async fn` and an ordinary `fn`. See #64512.\n \n extern crate arc_wake;\n \n@@ -39,13 +40,13 @@ impl Drop for D {\n     }\n }\n \n-/// Check drop order of temporary \"temp\" as compared to x, y, and z.\n+/// Check drop order of temporary \"temp\" as compared to `x`, `y`, and `z`.\n ///\n /// Expected order:\n-/// - z\n+/// - `z`\n /// - temp\n-/// - y\n-/// - x\n+/// - `y`\n+/// - `x`\n async fn foo_async(x: D, _y: D) {\n     let l = x.1.clone();\n     let z = D(\"z\", l.clone());"}]}