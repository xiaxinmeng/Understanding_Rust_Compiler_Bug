{"sha": "ba65d259de15ef09eb648d68a3f3f78859223d51", "node_id": "MDY6Q29tbWl0NzI0NzEyOmJhNjVkMjU5ZGUxNWVmMDllYjY0OGQ2OGEzZjNmNzg4NTkyMjNkNTE=", "commit": {"author": {"name": "Kirill Bulatov", "email": "mail4score@gmail.com", "date": "2021-06-10T22:35:14Z"}, "committer": {"name": "Kirill Bulatov", "email": "mail4score@gmail.com", "date": "2021-06-10T23:00:03Z"}, "message": "Prime caches on workspace load", "tree": {"sha": "9b7b98827155bf0aa7fff2b95356c341112d4c7c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/9b7b98827155bf0aa7fff2b95356c341112d4c7c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ba65d259de15ef09eb648d68a3f3f78859223d51", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ba65d259de15ef09eb648d68a3f3f78859223d51", "html_url": "https://github.com/rust-lang/rust/commit/ba65d259de15ef09eb648d68a3f3f78859223d51", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ba65d259de15ef09eb648d68a3f3f78859223d51/comments", "author": {"login": "SomeoneToIgnore", "id": 2690773, "node_id": "MDQ6VXNlcjI2OTA3NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/2690773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SomeoneToIgnore", "html_url": "https://github.com/SomeoneToIgnore", "followers_url": "https://api.github.com/users/SomeoneToIgnore/followers", "following_url": "https://api.github.com/users/SomeoneToIgnore/following{/other_user}", "gists_url": "https://api.github.com/users/SomeoneToIgnore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SomeoneToIgnore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SomeoneToIgnore/subscriptions", "organizations_url": "https://api.github.com/users/SomeoneToIgnore/orgs", "repos_url": "https://api.github.com/users/SomeoneToIgnore/repos", "events_url": "https://api.github.com/users/SomeoneToIgnore/events{/privacy}", "received_events_url": "https://api.github.com/users/SomeoneToIgnore/received_events", "type": "User", "site_admin": false}, "committer": {"login": "SomeoneToIgnore", "id": 2690773, "node_id": "MDQ6VXNlcjI2OTA3NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/2690773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SomeoneToIgnore", "html_url": "https://github.com/SomeoneToIgnore", "followers_url": "https://api.github.com/users/SomeoneToIgnore/followers", "following_url": "https://api.github.com/users/SomeoneToIgnore/following{/other_user}", "gists_url": "https://api.github.com/users/SomeoneToIgnore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SomeoneToIgnore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SomeoneToIgnore/subscriptions", "organizations_url": "https://api.github.com/users/SomeoneToIgnore/orgs", "repos_url": "https://api.github.com/users/SomeoneToIgnore/repos", "events_url": "https://api.github.com/users/SomeoneToIgnore/events{/privacy}", "received_events_url": "https://api.github.com/users/SomeoneToIgnore/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a6cdde0d0bbcb0d6617052792028eb3b258685cd", "url": "https://api.github.com/repos/rust-lang/rust/commits/a6cdde0d0bbcb0d6617052792028eb3b258685cd", "html_url": "https://github.com/rust-lang/rust/commit/a6cdde0d0bbcb0d6617052792028eb3b258685cd"}], "stats": {"total": 5, "additions": 3, "deletions": 2}, "files": [{"sha": "25ebcc0ece3287737f43d40bde52b2b7486dfc2e", "filename": "crates/rust-analyzer/src/cli.rs", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/rust-lang/rust/blob/ba65d259de15ef09eb648d68a3f3f78859223d51/crates%2Frust-analyzer%2Fsrc%2Fcli.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ba65d259de15ef09eb648d68a3f3f78859223d51/crates%2Frust-analyzer%2Fsrc%2Fcli.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fcli.rs?ref=ba65d259de15ef09eb648d68a3f3f78859223d51", "patch": "@@ -16,7 +16,6 @@ use vfs::Vfs;\n pub use self::{\n     analysis_stats::AnalysisStatsCmd,\n     diagnostics::diagnostics,\n-    load_cargo::{load_workspace, load_workspace_at, LoadCargoConfig},\n     ssr::{apply_ssr_rules, search_for_patterns},\n };\n "}, {"sha": "b1c0e015d62ebd2f524dee701418ab4654e511fe", "filename": "crates/rust-analyzer/src/cli/load_cargo.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/ba65d259de15ef09eb648d68a3f3f78859223d51/crates%2Frust-analyzer%2Fsrc%2Fcli%2Fload_cargo.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ba65d259de15ef09eb648d68a3f3f78859223d51/crates%2Frust-analyzer%2Fsrc%2Fcli%2Fload_cargo.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Frust-analyzer%2Fsrc%2Fcli%2Fload_cargo.rs?ref=ba65d259de15ef09eb648d68a3f3f78859223d51", "patch": "@@ -33,7 +33,7 @@ pub fn load_workspace_at(\n     load_workspace(workspace, load_config, progress)\n }\n \n-pub fn load_workspace(\n+fn load_workspace(\n     ws: ProjectWorkspace,\n     config: &LoadCargoConfig,\n     progress: &dyn Fn(String),\n@@ -82,6 +82,8 @@ pub fn load_workspace(\n     log::debug!(\"crate graph: {:?}\", crate_graph);\n     let host =\n         load_crate_graph(crate_graph, project_folders.source_root_config, &mut vfs, &receiver);\n+\n+    host.analysis().prime_caches(|_| {})?;\n     Ok((host, vfs, proc_macro_client))\n }\n "}]}