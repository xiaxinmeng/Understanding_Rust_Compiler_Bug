{"sha": "46c453d0d3249bf83330c2f68fe352bd1dd36b5e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjQ2YzQ1M2QwZDMyNDliZjgzMzMwYzJmNjhmZTM1MmJkMWRkMzZiNWU=", "commit": {"author": {"name": "Ekaterina Babshukova", "email": "ekaterina.babshukova@yandex.ru", "date": "2019-06-28T21:08:02Z"}, "committer": {"name": "Ekaterina Babshukova", "email": "ekaterina.babshukova@yandex.ru", "date": "2019-06-28T21:08:02Z"}, "message": "show macros in file structure", "tree": {"sha": "26820b98a67547d3e4091b428645d1b8bc2e718a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/26820b98a67547d3e4091b428645d1b8bc2e718a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/46c453d0d3249bf83330c2f68fe352bd1dd36b5e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/46c453d0d3249bf83330c2f68fe352bd1dd36b5e", "html_url": "https://github.com/rust-lang/rust/commit/46c453d0d3249bf83330c2f68fe352bd1dd36b5e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/46c453d0d3249bf83330c2f68fe352bd1dd36b5e/comments", "author": {"login": "viorina", "id": 6714973, "node_id": "MDQ6VXNlcjY3MTQ5NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/6714973?v=4", "gravatar_id": "", "url": "https://api.github.com/users/viorina", "html_url": "https://github.com/viorina", "followers_url": "https://api.github.com/users/viorina/followers", "following_url": "https://api.github.com/users/viorina/following{/other_user}", "gists_url": "https://api.github.com/users/viorina/gists{/gist_id}", "starred_url": "https://api.github.com/users/viorina/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/viorina/subscriptions", "organizations_url": "https://api.github.com/users/viorina/orgs", "repos_url": "https://api.github.com/users/viorina/repos", "events_url": "https://api.github.com/users/viorina/events{/privacy}", "received_events_url": "https://api.github.com/users/viorina/received_events", "type": "User", "site_admin": false}, "committer": {"login": "viorina", "id": 6714973, "node_id": "MDQ6VXNlcjY3MTQ5NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/6714973?v=4", "gravatar_id": "", "url": "https://api.github.com/users/viorina", "html_url": "https://github.com/viorina", "followers_url": "https://api.github.com/users/viorina/followers", "following_url": "https://api.github.com/users/viorina/following{/other_user}", "gists_url": "https://api.github.com/users/viorina/gists{/gist_id}", "starred_url": "https://api.github.com/users/viorina/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/viorina/subscriptions", "organizations_url": "https://api.github.com/users/viorina/orgs", "repos_url": "https://api.github.com/users/viorina/repos", "events_url": "https://api.github.com/users/viorina/events{/privacy}", "received_events_url": "https://api.github.com/users/viorina/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5d829841cdab630d7953defd12e024e46ecc7c4f", "url": "https://api.github.com/repos/rust-lang/rust/commits/5d829841cdab630d7953defd12e024e46ecc7c4f", "html_url": "https://github.com/rust-lang/rust/commit/5d829841cdab630d7953defd12e024e46ecc7c4f"}], "stats": {"total": 30, "additions": 25, "deletions": 5}, "files": [{"sha": "102efc0267506d39d615094c19dbf229a6126aea", "filename": "crates/ra_ide_api/src/display/snapshots/tests__file_structure.snap", "status": "modified", "additions": 14, "deletions": 5, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/46c453d0d3249bf83330c2f68fe352bd1dd36b5e/crates%2Fra_ide_api%2Fsrc%2Fdisplay%2Fsnapshots%2Ftests__file_structure.snap", "raw_url": "https://github.com/rust-lang/rust/raw/46c453d0d3249bf83330c2f68fe352bd1dd36b5e/crates%2Fra_ide_api%2Fsrc%2Fdisplay%2Fsnapshots%2Ftests__file_structure.snap", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fdisplay%2Fsnapshots%2Ftests__file_structure.snap?ref=46c453d0d3249bf83330c2f68fe352bd1dd36b5e", "patch": "@@ -1,5 +1,5 @@\n ---\n-created: \"2019-05-23T22:23:35.168422050Z\"\n+created: \"2019-06-28T20:46:18.274464142Z\"\n creator: insta@0.8.1\n source: crates/ra_ide_api/src/display/structure.rs\n expression: structure\n@@ -157,11 +157,20 @@ expression: structure\n         detail: None,\n         deprecated: false,\n     },\n+    StructureNode {\n+        parent: None,\n+        label: \"mc\",\n+        navigation_range: [284; 286),\n+        node_range: [271; 303),\n+        kind: MACRO_CALL,\n+        detail: None,\n+        deprecated: false,\n+    },\n     StructureNode {\n         parent: None,\n         label: \"obsolete\",\n-        navigation_range: [288; 296),\n-        node_range: [271; 301),\n+        navigation_range: [322; 330),\n+        node_range: [305; 335),\n         kind: FN_DEF,\n         detail: Some(\n             \"fn()\",\n@@ -171,8 +180,8 @@ expression: structure\n     StructureNode {\n         parent: None,\n         label: \"very_obsolete\",\n-        navigation_range: [341; 354),\n-        node_range: [303; 359),\n+        navigation_range: [375; 388),\n+        node_range: [337; 393),\n         kind: FN_DEF,\n         detail: Some(\n             \"fn()\","}, {"sha": "e5057e833fdc4a4c6811784e1a9feb497c1c7abb", "filename": "crates/ra_ide_api/src/display/structure.rs", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/rust-lang/rust/blob/46c453d0d3249bf83330c2f68fe352bd1dd36b5e/crates%2Fra_ide_api%2Fsrc%2Fdisplay%2Fstructure.rs", "raw_url": "https://github.com/rust-lang/rust/raw/46c453d0d3249bf83330c2f68fe352bd1dd36b5e/crates%2Fra_ide_api%2Fsrc%2Fdisplay%2Fstructure.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_ide_api%2Fsrc%2Fdisplay%2Fstructure.rs?ref=46c453d0d3249bf83330c2f68fe352bd1dd36b5e", "patch": "@@ -142,6 +142,13 @@ fn structure_node(node: &SyntaxNode) -> Option<StructureNode> {\n             };\n             Some(node)\n         })\n+        .visit(|mc: &ast::MacroCall| {\n+            let first_token = mc.syntax().first_token().unwrap();\n+            if first_token.text().as_str() != \"macro_rules\" {\n+                return None;\n+            }\n+            decl(mc)\n+        })\n         .accept(node)?\n }\n \n@@ -177,6 +184,10 @@ impl E {}\n \n impl fmt::Debug for E {}\n \n+macro_rules! mc {\n+    () => {}\n+}\n+\n #[deprecated]\n fn obsolete() {}\n "}]}