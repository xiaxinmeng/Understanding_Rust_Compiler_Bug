{"sha": "f753c3ecd20c4a448403d2d7d9b334a289f9e5b3", "node_id": "MDY6Q29tbWl0NzI0NzEyOmY3NTNjM2VjZDIwYzRhNDQ4NDAzZDJkN2Q5YjMzNGEyODlmOWU1YjM=", "commit": {"author": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2020-10-20T15:13:15Z"}, "committer": {"name": "Aleksey Kladov", "email": "aleksey.kladov@gmail.com", "date": "2020-10-20T15:13:15Z"}, "message": "Support Display name in project.json", "tree": {"sha": "8ac8a8f761db3bd3b60446001739b94bb1ed44dd", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8ac8a8f761db3bd3b60446001739b94bb1ed44dd"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/f753c3ecd20c4a448403d2d7d9b334a289f9e5b3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/f753c3ecd20c4a448403d2d7d9b334a289f9e5b3", "html_url": "https://github.com/rust-lang/rust/commit/f753c3ecd20c4a448403d2d7d9b334a289f9e5b3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/f753c3ecd20c4a448403d2d7d9b334a289f9e5b3/comments", "author": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "committer": {"login": "matklad", "id": 1711539, "node_id": "MDQ6VXNlcjE3MTE1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1711539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matklad", "html_url": "https://github.com/matklad", "followers_url": "https://api.github.com/users/matklad/followers", "following_url": "https://api.github.com/users/matklad/following{/other_user}", "gists_url": "https://api.github.com/users/matklad/gists{/gist_id}", "starred_url": "https://api.github.com/users/matklad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matklad/subscriptions", "organizations_url": "https://api.github.com/users/matklad/orgs", "repos_url": "https://api.github.com/users/matklad/repos", "events_url": "https://api.github.com/users/matklad/events{/privacy}", "received_events_url": "https://api.github.com/users/matklad/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3b1a648539487c08bc613b6fd6e573b0e0e38948", "url": "https://api.github.com/repos/rust-lang/rust/commits/3b1a648539487c08bc613b6fd6e573b0e0e38948", "html_url": "https://github.com/rust-lang/rust/commit/3b1a648539487c08bc613b6fd6e573b0e0e38948"}], "stats": {"total": 13, "additions": 10, "deletions": 3}, "files": [{"sha": "e92cfea596b5689945cf68a381346112a0b49417", "filename": "crates/project_model/src/lib.rs", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/f753c3ecd20c4a448403d2d7d9b334a289f9e5b3/crates%2Fproject_model%2Fsrc%2Flib.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f753c3ecd20c4a448403d2d7d9b334a289f9e5b3/crates%2Fproject_model%2Fsrc%2Flib.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fproject_model%2Fsrc%2Flib.rs?ref=f753c3ecd20c4a448403d2d7d9b334a289f9e5b3", "patch": "@@ -335,8 +335,7 @@ impl ProjectWorkspace {\n                             crate_graph.add_crate_root(\n                                 file_id,\n                                 krate.edition,\n-                                // FIXME json definitions can store the crate name\n-                                None,\n+                                krate.display_name.clone(),\n                                 cfg_options,\n                                 env,\n                                 proc_macro.unwrap_or_default(),"}, {"sha": "aab279223aee6d6ea11795e4a6c300f4ef418a28", "filename": "crates/project_model/src/project_json.rs", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/rust-lang/rust/blob/f753c3ecd20c4a448403d2d7d9b334a289f9e5b3/crates%2Fproject_model%2Fsrc%2Fproject_json.rs", "raw_url": "https://github.com/rust-lang/rust/raw/f753c3ecd20c4a448403d2d7d9b334a289f9e5b3/crates%2Fproject_model%2Fsrc%2Fproject_json.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fproject_model%2Fsrc%2Fproject_json.rs?ref=f753c3ecd20c4a448403d2d7d9b334a289f9e5b3", "patch": "@@ -2,7 +2,7 @@\n \n use std::path::PathBuf;\n \n-use base_db::{CrateId, CrateName, Dependency, Edition};\n+use base_db::{CrateDisplayName, CrateId, CrateName, Dependency, Edition};\n use paths::{AbsPath, AbsPathBuf};\n use rustc_hash::FxHashMap;\n use serde::{de, Deserialize};\n@@ -21,6 +21,7 @@ pub struct ProjectJson {\n /// useful in creating the crate graph.\n #[derive(Clone, Debug, Eq, PartialEq)]\n pub struct Crate {\n+    pub(crate) display_name: Option<CrateDisplayName>,\n     pub(crate) root_module: AbsPathBuf,\n     pub(crate) edition: Edition,\n     pub(crate) deps: Vec<Dependency>,\n@@ -68,6 +69,9 @@ impl ProjectJson {\n                     };\n \n                     Crate {\n+                        display_name: crate_data\n+                            .display_name\n+                            .map(CrateDisplayName::from_canonical_name),\n                         root_module,\n                         edition: crate_data.edition.into(),\n                         deps: crate_data\n@@ -114,6 +118,7 @@ pub struct ProjectJsonData {\n \n #[derive(Deserialize)]\n struct CrateData {\n+    display_name: Option<String>,\n     root_module: PathBuf,\n     edition: EditionData,\n     deps: Vec<DepData>,"}, {"sha": "7e8adcdb75c0dd88ca9074de1814cea41fc1e3e6", "filename": "docs/user/manual.adoc", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/f753c3ecd20c4a448403d2d7d9b334a289f9e5b3/docs%2Fuser%2Fmanual.adoc", "raw_url": "https://github.com/rust-lang/rust/raw/f753c3ecd20c4a448403d2d7d9b334a289f9e5b3/docs%2Fuser%2Fmanual.adoc", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/docs%2Fuser%2Fmanual.adoc?ref=f753c3ecd20c4a448403d2d7d9b334a289f9e5b3", "patch": "@@ -287,6 +287,9 @@ interface JsonProject {\n }\n \n interface Crate {\n+    /// Optional crate name used for display purposes, without affecting semantics.\n+    /// See the `deps` key for semantically-significant crate names.\n+    display_name?: string;\n     /// Path to the root module of the crate.\n     root_module: string;\n     /// Edition of the crate."}]}