{"sha": "6eb070d6613644b6698a5ce6454d006662c84d8a", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZlYjA3MGQ2NjEzNjQ0YjY2OThhNWNlNjQ1NGQwMDY2NjJjODRkOGE=", "commit": {"author": {"name": "Ville Penttinen", "email": "villem.penttinen@gmail.com", "date": "2019-02-26T09:35:57Z"}, "committer": {"name": "Ville Penttinen", "email": "villem.penttinen@gmail.com", "date": "2019-02-26T09:35:57Z"}, "message": "Add new trait TypeAscriptionOwner\n\nThis trait should be implemented for nodes which have an ascribed type,\ne.g. thing : Type. Such as let, const, static, param, named struct fields.", "tree": {"sha": "7cf0495a5bccd8ed410aff334e917c833361ba5a", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/7cf0495a5bccd8ed410aff334e917c833361ba5a"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6eb070d6613644b6698a5ce6454d006662c84d8a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6eb070d6613644b6698a5ce6454d006662c84d8a", "html_url": "https://github.com/rust-lang/rust/commit/6eb070d6613644b6698a5ce6454d006662c84d8a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6eb070d6613644b6698a5ce6454d006662c84d8a/comments", "author": {"login": "vipentti", "id": 4726680, "node_id": "MDQ6VXNlcjQ3MjY2ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/4726680?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vipentti", "html_url": "https://github.com/vipentti", "followers_url": "https://api.github.com/users/vipentti/followers", "following_url": "https://api.github.com/users/vipentti/following{/other_user}", "gists_url": "https://api.github.com/users/vipentti/gists{/gist_id}", "starred_url": "https://api.github.com/users/vipentti/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vipentti/subscriptions", "organizations_url": "https://api.github.com/users/vipentti/orgs", "repos_url": "https://api.github.com/users/vipentti/repos", "events_url": "https://api.github.com/users/vipentti/events{/privacy}", "received_events_url": "https://api.github.com/users/vipentti/received_events", "type": "User", "site_admin": false}, "committer": {"login": "vipentti", "id": 4726680, "node_id": "MDQ6VXNlcjQ3MjY2ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/4726680?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vipentti", "html_url": "https://github.com/vipentti", "followers_url": "https://api.github.com/users/vipentti/followers", "following_url": "https://api.github.com/users/vipentti/following{/other_user}", "gists_url": "https://api.github.com/users/vipentti/gists{/gist_id}", "starred_url": "https://api.github.com/users/vipentti/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vipentti/subscriptions", "organizations_url": "https://api.github.com/users/vipentti/orgs", "repos_url": "https://api.github.com/users/vipentti/repos", "events_url": "https://api.github.com/users/vipentti/events{/privacy}", "received_events_url": "https://api.github.com/users/vipentti/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7c9acf2f834c582d9cad4f7d0679a0697c591432", "url": "https://api.github.com/repos/rust-lang/rust/commits/7c9acf2f834c582d9cad4f7d0679a0697c591432", "html_url": "https://github.com/rust-lang/rust/commit/7c9acf2f834c582d9cad4f7d0679a0697c591432"}], "stats": {"total": 45, "additions": 36, "deletions": 9}, "files": [{"sha": "81c709bfb33ead8c4b70c4284758c5af95ad80c3", "filename": "crates/ra_syntax/src/ast.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6eb070d6613644b6698a5ce6454d006662c84d8a/crates%2Fra_syntax%2Fsrc%2Fast.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6eb070d6613644b6698a5ce6454d006662c84d8a/crates%2Fra_syntax%2Fsrc%2Fast.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Fsrc%2Fast.rs?ref=6eb070d6613644b6698a5ce6454d006662c84d8a", "patch": "@@ -31,6 +31,12 @@ pub trait AstToken: AstNode {\n     }\n }\n \n+pub trait TypeAscriptionOwner: AstNode {\n+    fn ascribed_type(&self) -> Option<&TypeRef> {\n+        child_opt(self)\n+    }\n+}\n+\n pub trait NameOwner: AstNode {\n     fn name(&self) -> Option<&Name> {\n         child_opt(self)"}, {"sha": "6db2f74ef52252eed53474c31a1214bcee17d81a", "filename": "crates/ra_syntax/src/ast/generated.rs", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/rust-lang/rust/blob/6eb070d6613644b6698a5ce6454d006662c84d8a/crates%2Fra_syntax%2Fsrc%2Fast%2Fgenerated.rs", "raw_url": "https://github.com/rust-lang/rust/raw/6eb070d6613644b6698a5ce6454d006662c84d8a/crates%2Fra_syntax%2Fsrc%2Fast%2Fgenerated.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Fsrc%2Fast%2Fgenerated.rs?ref=6eb070d6613644b6698a5ce6454d006662c84d8a", "patch": "@@ -628,6 +628,7 @@ impl ast::NameOwner for ConstDef {}\n impl ast::TypeParamsOwner for ConstDef {}\n impl ast::AttrsOwner for ConstDef {}\n impl ast::DocCommentsOwner for ConstDef {}\n+impl ast::TypeAscriptionOwner for ConstDef {}\n impl ConstDef {\n     pub fn type_ref(&self) -> Option<&TypeRef> {\n         super::child_opt(self)\n@@ -1767,6 +1768,7 @@ impl ToOwned for LetStmt {\n }\n \n \n+impl ast::TypeAscriptionOwner for LetStmt {}\n impl LetStmt {\n     pub fn pat(&self) -> Option<&Pat> {\n         super::child_opt(self)\n@@ -2592,6 +2594,7 @@ impl ast::VisibilityOwner for NamedFieldDef {}\n impl ast::NameOwner for NamedFieldDef {}\n impl ast::AttrsOwner for NamedFieldDef {}\n impl ast::DocCommentsOwner for NamedFieldDef {}\n+impl ast::TypeAscriptionOwner for NamedFieldDef {}\n impl NamedFieldDef {\n     pub fn type_ref(&self) -> Option<&TypeRef> {\n         super::child_opt(self)\n@@ -2774,6 +2777,7 @@ impl ToOwned for Param {\n }\n \n \n+impl ast::TypeAscriptionOwner for Param {}\n impl Param {\n     pub fn pat(&self) -> Option<&Pat> {\n         super::child_opt(self)\n@@ -3685,6 +3689,7 @@ impl ToOwned for SelfParam {\n }\n \n \n+impl ast::TypeAscriptionOwner for SelfParam {}\n impl SelfParam {\n     pub fn type_ref(&self) -> Option<&TypeRef> {\n         super::child_opt(self)\n@@ -3820,6 +3825,7 @@ impl ast::NameOwner for StaticDef {}\n impl ast::TypeParamsOwner for StaticDef {}\n impl ast::AttrsOwner for StaticDef {}\n impl ast::DocCommentsOwner for StaticDef {}\n+impl ast::TypeAscriptionOwner for StaticDef {}\n impl StaticDef {\n     pub fn type_ref(&self) -> Option<&TypeRef> {\n         super::child_opt(self)"}, {"sha": "a3bfc74a7f927cb12b5b894d3f5f0a9cdcedd084", "filename": "crates/ra_syntax/src/grammar.ron", "status": "modified", "additions": 24, "deletions": 9, "changes": 33, "blob_url": "https://github.com/rust-lang/rust/blob/6eb070d6613644b6698a5ce6454d006662c84d8a/crates%2Fra_syntax%2Fsrc%2Fgrammar.ron", "raw_url": "https://github.com/rust-lang/rust/raw/6eb070d6613644b6698a5ce6454d006662c84d8a/crates%2Fra_syntax%2Fsrc%2Fgrammar.ron", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fra_syntax%2Fsrc%2Fgrammar.ron?ref=6eb070d6613644b6698a5ce6454d006662c84d8a", "patch": "@@ -271,7 +271,7 @@ Grammar(\n             ]\n         ),\n         \"NamedFieldDefList\": (collections: [[\"fields\", \"NamedFieldDef\"]]),\n-        \"NamedFieldDef\": ( traits: [\"VisibilityOwner\", \"NameOwner\", \"AttrsOwner\", \"DocCommentsOwner\"], options: [\"TypeRef\"] ),\n+        \"NamedFieldDef\": ( traits: [\"VisibilityOwner\", \"NameOwner\", \"AttrsOwner\", \"DocCommentsOwner\", \"TypeAscriptionOwner\"], options: [\"TypeRef\"] ),\n         \"PosFieldDefList\": (collections: [[\"fields\", \"PosFieldDef\"]]),\n         \"PosFieldDef\": ( traits: [\"VisibilityOwner\", \"AttrsOwner\"], options: [\"TypeRef\"]),\n         \"EnumDef\": ( traits: [\n@@ -298,7 +298,8 @@ Grammar(\n                 \"NameOwner\",\n                 \"TypeParamsOwner\",\n                 \"AttrsOwner\",\n-                \"DocCommentsOwner\"\n+                \"DocCommentsOwner\",\n+                \"TypeAscriptionOwner\",\n             ],\n             options: [\"TypeRef\"]\n         ),\n@@ -308,7 +309,8 @@ Grammar(\n                 \"NameOwner\",\n                 \"TypeParamsOwner\",\n                 \"AttrsOwner\",\n-                \"DocCommentsOwner\"\n+                \"DocCommentsOwner\",\n+                \"TypeAscriptionOwner\",\n             ],\n             options: [\"TypeRef\"]\n         ),\n@@ -569,11 +571,16 @@ Grammar(\n         \"ExprStmt\": (\n             options: [ [\"expr\", \"Expr\"] ]\n         ),\n-        \"LetStmt\": ( options: [\n-            [\"pat\", \"Pat\"],\n-            [\"type_ref\", \"TypeRef\"],\n-            [\"initializer\", \"Expr\"],\n-        ]),\n+        \"LetStmt\": (\n+            options: [\n+                [\"pat\", \"Pat\"],\n+                [\"type_ref\", \"TypeRef\"],\n+                [\"initializer\", \"Expr\"],\n+            ],\n+            traits: [\n+                \"TypeAscriptionOwner\",\n+            ]\n+        ),\n         \"Condition\": (\n             options: [ \"Pat\", \"Expr\" ]\n         ),\n@@ -595,10 +602,18 @@ Grammar(\n                 [\"params\", \"Param\"]\n             ]\n         ),\n-        \"SelfParam\": (options: [\"TypeRef\", \"SelfKw\"]),\n+        \"SelfParam\": (\n+            options: [\"TypeRef\", \"SelfKw\"],\n+            traits: [\n+                \"TypeAscriptionOwner\",\n+            ]\n+        ),\n         \"SelfKw\": (),\n         \"Param\": (\n             options: [ \"Pat\", \"TypeRef\" ],\n+            traits: [\n+                \"TypeAscriptionOwner\",\n+            ]\n         ),\n         \"UseItem\": (\n             traits: [\"AttrsOwner\"],"}]}