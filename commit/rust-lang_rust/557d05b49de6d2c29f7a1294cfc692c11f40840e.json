{"sha": "557d05b49de6d2c29f7a1294cfc692c11f40840e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU1N2QwNWI0OWRlNmQyYzI5ZjdhMTI5NGNmYzY5MmMxMWY0MDg0MGU=", "commit": {"author": {"name": "Mark Simulacrum", "email": "mark.simulacrum@gmail.com", "date": "2018-06-23T01:42:22Z"}, "committer": {"name": "Mark Simulacrum", "email": "mark.simulacrum@gmail.com", "date": "2018-06-25T21:21:13Z"}, "message": "Do not build LLVM tools for any of the tools\n\nNone of the tools in the list should need LLVM tools themselves as far as I can\ntell; if this is incorrect, we can re-enable the tool building later.\n\nThe primary reason for doing this is that rust-central-station uses the\nBuildManifest tool and building LLVM there is not cached: it takes ~1.5\nhours on the 2 core machine. This commit should make nightlies and\nstable releases much faster.", "tree": {"sha": "c669a49997c438f68cdcc8f3d2ad1f0f4c2a84ee", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c669a49997c438f68cdcc8f3d2ad1f0f4c2a84ee"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/557d05b49de6d2c29f7a1294cfc692c11f40840e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/557d05b49de6d2c29f7a1294cfc692c11f40840e", "html_url": "https://github.com/rust-lang/rust/commit/557d05b49de6d2c29f7a1294cfc692c11f40840e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/557d05b49de6d2c29f7a1294cfc692c11f40840e/comments", "author": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "committer": {"login": "Mark-Simulacrum", "id": 5047365, "node_id": "MDQ6VXNlcjUwNDczNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/5047365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mark-Simulacrum", "html_url": "https://github.com/Mark-Simulacrum", "followers_url": "https://api.github.com/users/Mark-Simulacrum/followers", "following_url": "https://api.github.com/users/Mark-Simulacrum/following{/other_user}", "gists_url": "https://api.github.com/users/Mark-Simulacrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mark-Simulacrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mark-Simulacrum/subscriptions", "organizations_url": "https://api.github.com/users/Mark-Simulacrum/orgs", "repos_url": "https://api.github.com/users/Mark-Simulacrum/repos", "events_url": "https://api.github.com/users/Mark-Simulacrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Mark-Simulacrum/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8acec1f9d0b40dde142e6c26d7358b9ab232d2b4", "url": "https://api.github.com/repos/rust-lang/rust/commits/8acec1f9d0b40dde142e6c26d7358b9ab232d2b4", "html_url": "https://github.com/rust-lang/rust/commit/8acec1f9d0b40dde142e6c26d7358b9ab232d2b4"}], "stats": {"total": 9, "additions": 3, "deletions": 6}, "files": [{"sha": "0a428a61d120299354400223834a0eacfa0e1501", "filename": "src/bootstrap/tool.rs", "status": "modified", "additions": 3, "deletions": 6, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/557d05b49de6d2c29f7a1294cfc692c11f40840e/src%2Fbootstrap%2Ftool.rs", "raw_url": "https://github.com/rust-lang/rust/raw/557d05b49de6d2c29f7a1294cfc692c11f40840e/src%2Fbootstrap%2Ftool.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Ftool.rs?ref=557d05b49de6d2c29f7a1294cfc692c11f40840e", "patch": "@@ -273,7 +273,7 @@ macro_rules! tool {\n             /// Whether this tool requires LLVM to run\n             pub fn uses_llvm_tools(&self) -> bool {\n                 match self {\n-                    $(Tool::$name => true $(&& $llvm)*,)+\n+                    $(Tool::$name => false $(|| $llvm)*,)+\n                 }\n             }\n         }\n@@ -340,20 +340,17 @@ macro_rules! tool {\n     }\n }\n \n-// FIXME(#51459): We have only checked that RustInstaller does not require\n-// the LLVM binaries when running. We should go through all tools to determine\n-// if they really need LLVM binaries, and make `llvm_tools` a required argument.\n tool!(\n     Rustbook, \"src/tools/rustbook\", \"rustbook\", Mode::ToolRustc;\n     ErrorIndex, \"src/tools/error_index_generator\", \"error_index_generator\", Mode::ToolRustc;\n     UnstableBookGen, \"src/tools/unstable-book-gen\", \"unstable-book-gen\", Mode::ToolStd;\n     Tidy, \"src/tools/tidy\", \"tidy\", Mode::ToolStd;\n     Linkchecker, \"src/tools/linkchecker\", \"linkchecker\", Mode::ToolStd;\n     CargoTest, \"src/tools/cargotest\", \"cargotest\", Mode::ToolStd;\n-    Compiletest, \"src/tools/compiletest\", \"compiletest\", Mode::ToolTest;\n+    Compiletest, \"src/tools/compiletest\", \"compiletest\", Mode::ToolTest, llvm_tools = true;\n     BuildManifest, \"src/tools/build-manifest\", \"build-manifest\", Mode::ToolStd;\n     RemoteTestClient, \"src/tools/remote-test-client\", \"remote-test-client\", Mode::ToolStd;\n-    RustInstaller, \"src/tools/rust-installer\", \"fabricate\", Mode::ToolStd, llvm_tools = false;\n+    RustInstaller, \"src/tools/rust-installer\", \"fabricate\", Mode::ToolStd;\n     RustdocTheme, \"src/tools/rustdoc-themes\", \"rustdoc-themes\", Mode::ToolStd;\n );\n "}]}