{"sha": "ce6472987d2cb466345a857cb2efdd06307c5ebf", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNlNjQ3Mjk4N2QyY2I0NjYzNDVhODU3Y2IyZWZkZDA2MzA3YzVlYmY=", "commit": {"author": {"name": "Jacob Hoffman-Andrews", "email": "github@hoffman-andrews.com", "date": "2021-06-03T17:28:43Z"}, "committer": {"name": "Jacob Hoffman-Andrews", "email": "github@hoffman-andrews.com", "date": "2021-06-17T05:08:36Z"}, "message": "Remove methods under Implementors on trait pages\n\nThese were hidden by default, and duplicated information already on the\npage anyhow.\n\nAlso remove the \"Auto-hide trait implementors of a trait\" setting,\nwhich is not needed anymore.", "tree": {"sha": "18dec7d1edb4c45c7d2051c1c3e1998d69b4dd92", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/18dec7d1edb4c45c7d2051c1c3e1998d69b4dd92"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ce6472987d2cb466345a857cb2efdd06307c5ebf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ce6472987d2cb466345a857cb2efdd06307c5ebf", "html_url": "https://github.com/rust-lang/rust/commit/ce6472987d2cb466345a857cb2efdd06307c5ebf", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ce6472987d2cb466345a857cb2efdd06307c5ebf/comments", "author": {"login": "jsha", "id": 220205, "node_id": "MDQ6VXNlcjIyMDIwNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/220205?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsha", "html_url": "https://github.com/jsha", "followers_url": "https://api.github.com/users/jsha/followers", "following_url": "https://api.github.com/users/jsha/following{/other_user}", "gists_url": "https://api.github.com/users/jsha/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsha/subscriptions", "organizations_url": "https://api.github.com/users/jsha/orgs", "repos_url": "https://api.github.com/users/jsha/repos", "events_url": "https://api.github.com/users/jsha/events{/privacy}", "received_events_url": "https://api.github.com/users/jsha/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jsha", "id": 220205, "node_id": "MDQ6VXNlcjIyMDIwNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/220205?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsha", "html_url": "https://github.com/jsha", "followers_url": "https://api.github.com/users/jsha/followers", "following_url": "https://api.github.com/users/jsha/following{/other_user}", "gists_url": "https://api.github.com/users/jsha/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsha/subscriptions", "organizations_url": "https://api.github.com/users/jsha/orgs", "repos_url": "https://api.github.com/users/jsha/repos", "events_url": "https://api.github.com/users/jsha/events{/privacy}", "received_events_url": "https://api.github.com/users/jsha/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "50a407200b970d8a48e4e58de37c94df355f5472", "url": "https://api.github.com/repos/rust-lang/rust/commits/50a407200b970d8a48e4e58de37c94df355f5472", "html_url": "https://github.com/rust-lang/rust/commit/50a407200b970d8a48e4e58de37c94df355f5472"}], "stats": {"total": 63, "additions": 21, "deletions": 42}, "files": [{"sha": "4f3acfb8e82f7e6924d6017ed0d4854aee753e07", "filename": "src/librustdoc/html/render/mod.rs", "status": "modified", "additions": 21, "deletions": 17, "changes": 38, "blob_url": "https://github.com/rust-lang/rust/blob/ce6472987d2cb466345a857cb2efdd06307c5ebf/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ce6472987d2cb466345a857cb2efdd06307c5ebf/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Frender%2Fmod.rs?ref=ce6472987d2cb466345a857cb2efdd06307c5ebf", "patch": "@@ -490,7 +490,6 @@ fn settings(root_path: &str, suffix: &str, themes: &[StylePath]) -> Result<Strin\n         (\"auto-hide-method-docs\", \"Auto-hide item methods' documentation\", false).into(),\n         (\"auto-hide-trait-implementations\", \"Auto-hide trait implementation documentation\", false)\n             .into(),\n-        (\"auto-collapse-implementors\", \"Auto-hide implementors of a trait\", true).into(),\n         (\"go-to-only-result\", \"Directly go to item in search if there is only one result\", false)\n             .into(),\n         (\"line-numbers\", \"Show line numbers on code examples\", false).into(),\n@@ -1543,7 +1542,10 @@ fn render_impl(\n         }\n     }\n     if render_mode == RenderMode::Normal {\n-        let toggled = !impl_items.is_empty() || !default_impl_items.is_empty();\n+        let on_trait_page = matches!(*parent.kind, clean::ItemKind::TraitItem(_));\n+        let has_impl_items = !(impl_items.is_empty() && default_impl_items.is_empty());\n+        let toggled = !on_trait_page && has_impl_items;\n+        let is_implementing_trait = i.inner_impl().trait_.is_some();\n         if toggled {\n             close_tags.insert_str(0, \"</details>\");\n             write!(w, \"<details class=\\\"rustdoc-toggle implementors-toggle\\\" open>\");\n@@ -1571,21 +1573,23 @@ fn render_impl(\n             }\n         }\n \n-        if let Some(ref dox) = cx.shared.maybe_collapsed_doc_value(&i.impl_item) {\n-            let mut ids = cx.id_map.borrow_mut();\n-            write!(\n-                w,\n-                \"<div class=\\\"docblock\\\">{}</div>\",\n-                Markdown(\n-                    &*dox,\n-                    &i.impl_item.links(cx),\n-                    &mut ids,\n-                    cx.shared.codes,\n-                    cx.shared.edition(),\n-                    &cx.shared.playground\n-                )\n-                .into_string()\n-            );\n+        if !on_trait_page {\n+            if let Some(ref dox) = cx.shared.maybe_collapsed_doc_value(&i.impl_item) {\n+                let mut ids = cx.id_map.borrow_mut();\n+                write!(\n+                    w,\n+                    \"<div class=\\\"docblock\\\">{}</div>\",\n+                    Markdown(\n+                        &*dox,\n+                        &i.impl_item.links(cx),\n+                        &mut ids,\n+                        cx.shared.codes,\n+                        cx.shared.edition(),\n+                        &cx.shared.playground\n+                    )\n+                    .into_string()\n+                );\n+            }\n         }\n     }\n     if !default_impl_items.is_empty() || !impl_items.is_empty() {"}, {"sha": "98128878999e4b36460ae92848dcf20e04107b67", "filename": "src/librustdoc/html/static/main.js", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/rust-lang/rust/blob/ce6472987d2cb466345a857cb2efdd06307c5ebf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "raw_url": "https://github.com/rust-lang/rust/raw/ce6472987d2cb466345a857cb2efdd06307c5ebf/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustdoc%2Fhtml%2Fstatic%2Fmain.js?ref=ce6472987d2cb466345a857cb2efdd06307c5ebf", "patch": "@@ -778,7 +778,6 @@ function hideThemeButtonState() {\n         }\n \n         var hideMethodDocs = getSettingValue(\"auto-hide-method-docs\") === \"true\";\n-        var hideImplementors = getSettingValue(\"auto-collapse-implementors\") !== \"false\";\n         var hideImplementations = getSettingValue(\"auto-hide-trait-implementations\") === \"true\";\n         var hideLargeItemContents = getSettingValue(\"auto-hide-large-items\") !== \"false\";\n \n@@ -796,10 +795,6 @@ function hideThemeButtonState() {\n             setImplementorsTogglesOpen(\"blanket-implementations-list\", false);\n         }\n \n-        if (!hideImplementors) {\n-            setImplementorsTogglesOpen(\"implementors-list\", true);\n-        }\n-\n         onEachLazy(document.getElementsByClassName(\"rustdoc-toggle\"), function (e) {\n             if (!hideLargeItemContents && hasClass(e, \"type-contents-toggle\")) {\n                 e.open = true;"}, {"sha": "dbaf744dc4712fad4fc82a004a1a0e489efecf21", "filename": "src/test/rustdoc/issue-19055.rs", "status": "removed", "additions": 0, "deletions": 20, "changes": 20, "blob_url": "https://github.com/rust-lang/rust/blob/50a407200b970d8a48e4e58de37c94df355f5472/src%2Ftest%2Frustdoc%2Fissue-19055.rs", "raw_url": "https://github.com/rust-lang/rust/raw/50a407200b970d8a48e4e58de37c94df355f5472/src%2Ftest%2Frustdoc%2Fissue-19055.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frustdoc%2Fissue-19055.rs?ref=50a407200b970d8a48e4e58de37c94df355f5472", "patch": "@@ -1,20 +0,0 @@\n-// @has issue_19055/trait.Any.html\n-pub trait Any {}\n-\n-impl<'any> Any + 'any {\n-    // @has - '//*[@id=\"method.is\"]' 'fn is'\n-    pub fn is<T: 'static>(&self) -> bool { loop {} }\n-\n-    // @has - '//*[@id=\"method.downcast_ref\"]' 'fn downcast_ref'\n-    pub fn downcast_ref<T: 'static>(&self) -> Option<&T> { loop {} }\n-\n-    // @has - '//*[@id=\"method.downcast_mut\"]' 'fn downcast_mut'\n-    pub fn downcast_mut<T: 'static>(&mut self) -> Option<&mut T> { loop {} }\n-}\n-\n-pub trait Foo {\n-    fn foo(&self) {}\n-}\n-\n-// @has - '//*[@id=\"method.foo\"]' 'fn foo'\n-impl Foo for Any {}"}]}