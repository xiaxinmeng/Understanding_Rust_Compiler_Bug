{"sha": "4fdf2c4f976ce52163841ba5b3117bb2bb06d97e", "node_id": "MDY6Q29tbWl0NzI0NzEyOjRmZGYyYzRmOTc2Y2U1MjE2Mzg0MWJhNWIzMTE3YmIyYmIwNmQ5N2U=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2016-05-16T19:15:10Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2016-05-16T19:15:10Z"}, "message": "Auto merge of #33500 - Nercury:update-aarch64-android-target-to-match-abi, r=alexcrichton\n\nUpdate aarch64-linux-android target to match android abi.\n\n- Changed `target_env` to \"gnu\" to empty \"\" for all android targets because it does not matter for android.\n- The PR #33048 added \"max_atomic_width\" for arm-android but missed recently added armv7-android. Add it there too.\n- Added features `+neon,+fp-armv8` because they [must exist on `aarch64` android](http://developer.android.com/ndk/guides/cpu-features.html).\n- Update libc to include https://github.com/rust-lang/libc/pull/282 so that rust's std lib works on android's aarch64 (the main issue there was incorrect structure alignment on 64-bit arm).\n\nr? @alexcrichton", "tree": {"sha": "78e466dda8648c120d986b41e59e48c9cc358ebf", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/78e466dda8648c120d986b41e59e48c9cc358ebf"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/4fdf2c4f976ce52163841ba5b3117bb2bb06d97e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/4fdf2c4f976ce52163841ba5b3117bb2bb06d97e", "html_url": "https://github.com/rust-lang/rust/commit/4fdf2c4f976ce52163841ba5b3117bb2bb06d97e", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/4fdf2c4f976ce52163841ba5b3117bb2bb06d97e/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8310de856db8ba78ba3f4c58e3fe6d3d87f2cb4f", "url": "https://api.github.com/repos/rust-lang/rust/commits/8310de856db8ba78ba3f4c58e3fe6d3d87f2cb4f", "html_url": "https://github.com/rust-lang/rust/commit/8310de856db8ba78ba3f4c58e3fe6d3d87f2cb4f"}, {"sha": "e512abd418cf6774a29c98b1643e08ae82b3a2b5", "url": "https://api.github.com/repos/rust-lang/rust/commits/e512abd418cf6774a29c98b1643e08ae82b3a2b5", "html_url": "https://github.com/rust-lang/rust/commit/e512abd418cf6774a29c98b1643e08ae82b3a2b5"}], "stats": {"total": 12, "additions": 8, "deletions": 4}, "files": [{"sha": "6598e2cbfd7e09bfca249cc3dcbf889735f73ce1", "filename": "src/liblibc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": null, "raw_url": null, "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fliblibc?ref=4fdf2c4f976ce52163841ba5b3117bb2bb06d97e", "patch": "@@ -1 +1 @@\n-Subproject commit 7265c17d1845354f979a39b4ceb3a6934025b2ab\n+Subproject commit 6598e2cbfd7e09bfca249cc3dcbf889735f73ce1"}, {"sha": "81be546e0c89da009e0177bc327bf0d3ad5ca63a", "filename": "src/librustc_back/target/aarch64_linux_android.rs", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/4fdf2c4f976ce52163841ba5b3117bb2bb06d97e/src%2Flibrustc_back%2Ftarget%2Faarch64_linux_android.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4fdf2c4f976ce52163841ba5b3117bb2bb06d97e/src%2Flibrustc_back%2Ftarget%2Faarch64_linux_android.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Faarch64_linux_android.rs?ref=4fdf2c4f976ce52163841ba5b3117bb2bb06d97e", "patch": "@@ -13,6 +13,9 @@ use target::Target;\n pub fn target() -> Target {\n     let mut base = super::android_base::opts();\n     base.max_atomic_width = 128;\n+    // As documented in http://developer.android.com/ndk/guides/cpu-features.html\n+    // the neon (ASIMD) and FP must exist on all android aarch64 targets.\n+    base.features = \"+neon,+fp-armv8\".to_string();\n     Target {\n         llvm_target: \"aarch64-linux-android\".to_string(),\n         target_endian: \"little\".to_string(),"}, {"sha": "e1b170422c60d4122c88a1d8e96743714fcf1e6b", "filename": "src/librustc_back/target/arm_linux_androideabi.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4fdf2c4f976ce52163841ba5b3117bb2bb06d97e/src%2Flibrustc_back%2Ftarget%2Farm_linux_androideabi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4fdf2c4f976ce52163841ba5b3117bb2bb06d97e/src%2Flibrustc_back%2Ftarget%2Farm_linux_androideabi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Farm_linux_androideabi.rs?ref=4fdf2c4f976ce52163841ba5b3117bb2bb06d97e", "patch": "@@ -22,7 +22,7 @@ pub fn target() -> Target {\n         data_layout: \"e-m:e-p:32:32-i64:64-v128:64:128-a:0:32-n32-S64\".to_string(),\n         arch: \"arm\".to_string(),\n         target_os: \"android\".to_string(),\n-        target_env: \"gnu\".to_string(),\n+        target_env: \"\".to_string(),\n         target_vendor: \"unknown\".to_string(),\n         options: base,\n     }"}, {"sha": "fd8f35da16f61a1820aeea9c161fe23a09b3bdff", "filename": "src/librustc_back/target/armv7_linux_androideabi.rs", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/rust-lang/rust/blob/4fdf2c4f976ce52163841ba5b3117bb2bb06d97e/src%2Flibrustc_back%2Ftarget%2Farmv7_linux_androideabi.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4fdf2c4f976ce52163841ba5b3117bb2bb06d97e/src%2Flibrustc_back%2Ftarget%2Farmv7_linux_androideabi.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Farmv7_linux_androideabi.rs?ref=4fdf2c4f976ce52163841ba5b3117bb2bb06d97e", "patch": "@@ -13,6 +13,7 @@ use target::Target;\n pub fn target() -> Target {\n     let mut base = super::android_base::opts();\n     base.features = \"+v7,+thumb2,+vfp3,+d16\".to_string();\n+    base.max_atomic_width = 64;\n \n     Target {\n         llvm_target: \"armv7-none-linux-android\".to_string(),\n@@ -21,7 +22,7 @@ pub fn target() -> Target {\n         data_layout: \"e-m:e-p:32:32-i64:64-v128:64:128-a:0:32-n32-S64\".to_string(),\n         arch: \"arm\".to_string(),\n         target_os: \"android\".to_string(),\n-        target_env: \"gnu\".to_string(),\n+        target_env: \"\".to_string(),\n         target_vendor: \"unknown\".to_string(),\n         options: base,\n     }"}, {"sha": "df746965a92e709a0b6589d49f757d016911b268", "filename": "src/librustc_back/target/i686_linux_android.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/4fdf2c4f976ce52163841ba5b3117bb2bb06d97e/src%2Flibrustc_back%2Ftarget%2Fi686_linux_android.rs", "raw_url": "https://github.com/rust-lang/rust/raw/4fdf2c4f976ce52163841ba5b3117bb2bb06d97e/src%2Flibrustc_back%2Ftarget%2Fi686_linux_android.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_back%2Ftarget%2Fi686_linux_android.rs?ref=4fdf2c4f976ce52163841ba5b3117bb2bb06d97e", "patch": "@@ -22,7 +22,7 @@ pub fn target() -> Target {\n         data_layout: \"e-m:e-p:32:32-f64:32:64-f80:32-n8:16:32-S128\".to_string(),\n         arch: \"x86\".to_string(),\n         target_os: \"android\".to_string(),\n-        target_env: \"gnu\".to_string(),\n+        target_env: \"\".to_string(),\n         target_vendor: \"unknown\".to_string(),\n         options: base,\n     }"}]}