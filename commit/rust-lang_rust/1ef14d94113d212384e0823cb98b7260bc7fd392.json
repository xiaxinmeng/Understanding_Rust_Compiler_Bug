{"sha": "1ef14d94113d212384e0823cb98b7260bc7fd392", "node_id": "MDY6Q29tbWl0NzI0NzEyOjFlZjE0ZDk0MTEzZDIxMjM4NGUwODIzY2I5OGI3MjYwYmM3ZmQzOTI=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-06-18T10:30:46Z"}, "committer": {"name": "bors", "email": "bors@rust-lang.org", "date": "2015-06-18T10:30:46Z"}, "message": "Auto merge of #26358 - nham:fix_24081, r=alexcrichton\n\nPreviously, it said \"import `Foo` conflicts with existing submodule\" even\r\nwhen it was a type alias, enum, or trait. The message now says the conflict\r\nis with \"type in this module\" in the case of the first two, and \"trait in\r\nthis module\" for the last one.\r\n\r\nFixes #24081.", "tree": {"sha": "4f648b25100efa3e2d27a0bf85f067f5ccc7353c", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/4f648b25100efa3e2d27a0bf85f067f5ccc7353c"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1ef14d94113d212384e0823cb98b7260bc7fd392", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1ef14d94113d212384e0823cb98b7260bc7fd392", "html_url": "https://github.com/rust-lang/rust/commit/1ef14d94113d212384e0823cb98b7260bc7fd392", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1ef14d94113d212384e0823cb98b7260bc7fd392/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "941af7be24a5c54fd24ba9f0276b97d2c3b53748", "url": "https://api.github.com/repos/rust-lang/rust/commits/941af7be24a5c54fd24ba9f0276b97d2c3b53748", "html_url": "https://github.com/rust-lang/rust/commit/941af7be24a5c54fd24ba9f0276b97d2c3b53748"}, {"sha": "0c22cd79066f59500eae430abb26b9738d105b99", "url": "https://api.github.com/repos/rust-lang/rust/commits/0c22cd79066f59500eae430abb26b9738d105b99", "html_url": "https://github.com/rust-lang/rust/commit/0c22cd79066f59500eae430abb26b9738d105b99"}], "stats": {"total": 36, "additions": 32, "deletions": 4}, "files": [{"sha": "2edbf6441ba71173b7940f194088301a88dd52e5", "filename": "src/librustc_resolve/resolve_imports.rs", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/rust-lang/rust/blob/1ef14d94113d212384e0823cb98b7260bc7fd392/src%2Flibrustc_resolve%2Fresolve_imports.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1ef14d94113d212384e0823cb98b7260bc7fd392/src%2Flibrustc_resolve%2Fresolve_imports.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc_resolve%2Fresolve_imports.rs?ref=1ef14d94113d212384e0823cb98b7260bc7fd392", "patch": "@@ -12,6 +12,7 @@ use self::ImportDirectiveSubclass::*;\n \n use DefModifiers;\n use Module;\n+use ModuleKind;\n use Namespace::{self, TypeNS, ValueNS};\n use NameBindings;\n use NamespaceResult::{BoundResult, UnboundResult, UnknownResult};\n@@ -980,10 +981,14 @@ impl<'a, 'b:'a, 'tcx:'b> ImportResolver<'a, 'b, 'tcx> {\n         match import_resolution.type_target {\n             Some(ref target) if target.shadowable != Shadowable::Always => {\n                 if let Some(ref ty) = *name_bindings.type_def.borrow() {\n-                    let (what, note) = if ty.module_def.is_some() {\n-                        (\"existing submodule\", \"note conflicting module here\")\n-                    } else {\n-                        (\"type in this module\", \"note conflicting type here\")\n+                    let (what, note) = match ty.module_def {\n+                        Some(ref module)\n+                            if module.kind.get() == ModuleKind::NormalModuleKind =>\n+                                (\"existing submodule\", \"note conflicting module here\"),\n+                        Some(ref module)\n+                            if module.kind.get() == ModuleKind::TraitModuleKind =>\n+                                (\"trait in this module\", \"note conflicting trait here\"),\n+                        _    => (\"type in this module\", \"note conflicting type here\"),\n                     };\n                     span_err!(self.resolver.session, import_span, E0256,\n                               \"import `{}` conflicts with {}\","}, {"sha": "11376cec14ee32d2442dcd952399d0d141cf0d13", "filename": "src/test/compile-fail/issue-24081.rs", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/rust-lang/rust/blob/1ef14d94113d212384e0823cb98b7260bc7fd392/src%2Ftest%2Fcompile-fail%2Fissue-24081.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1ef14d94113d212384e0823cb98b7260bc7fd392/src%2Ftest%2Fcompile-fail%2Fissue-24081.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fissue-24081.rs?ref=1ef14d94113d212384e0823cb98b7260bc7fd392", "patch": "@@ -0,0 +1,23 @@\n+// Copyright 2015 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+use std::ops::Add; //~ ERROR import `Add` conflicts with type in this module\n+use std::ops::Sub; //~ ERROR import `Sub` conflicts with type in this module\n+use std::ops::Mul; //~ ERROR import `Mul` conflicts with type in this module\n+use std::ops::Div; //~ ERROR import `Div` conflicts with existing submodule\n+use std::ops::Rem; //~ ERROR import `Rem` conflicts with trait in this module\n+\n+type Add = bool;\n+struct Sub { x: f32 }\n+enum Mul { A, B }\n+mod Div { }\n+trait Rem { }\n+\n+fn main() {}"}]}