{"sha": "6ae6160e425d146dfba26f4978bdafa5d78fdbd7", "node_id": "MDY6Q29tbWl0NzI0NzEyOjZhZTYxNjBlNDI1ZDE0NmRmYmEyNmY0OTc4YmRhZmE1ZDc4ZmRiZDc=", "commit": {"author": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2017-01-12T22:58:55Z"}, "committer": {"name": "Alex Crichton", "email": "alex@alexcrichton.com", "date": "2017-01-12T22:59:57Z"}, "message": "travis: Attempt to debug OSX linker segfaults\n\nThis commit attempts to debug the segfaults that we've been seeing on OSX on\nTravis. I have no idea what's going on here mostly, but let's try to look at\ncore dumps and get backtraces to see what's going on. This commit itself is\nmostly a complete shot in the dark, I'm not sure if this even works...\n\ncc #38878", "tree": {"sha": "caeeca4aa604f9c41b275177fcc2721b3e9f6c4e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/caeeca4aa604f9c41b275177fcc2721b3e9f6c4e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/6ae6160e425d146dfba26f4978bdafa5d78fdbd7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/6ae6160e425d146dfba26f4978bdafa5d78fdbd7", "html_url": "https://github.com/rust-lang/rust/commit/6ae6160e425d146dfba26f4978bdafa5d78fdbd7", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/6ae6160e425d146dfba26f4978bdafa5d78fdbd7/comments", "author": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "committer": {"login": "alexcrichton", "id": 64996, "node_id": "MDQ6VXNlcjY0OTk2", "avatar_url": "https://avatars.githubusercontent.com/u/64996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexcrichton", "html_url": "https://github.com/alexcrichton", "followers_url": "https://api.github.com/users/alexcrichton/followers", "following_url": "https://api.github.com/users/alexcrichton/following{/other_user}", "gists_url": "https://api.github.com/users/alexcrichton/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexcrichton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexcrichton/subscriptions", "organizations_url": "https://api.github.com/users/alexcrichton/orgs", "repos_url": "https://api.github.com/users/alexcrichton/repos", "events_url": "https://api.github.com/users/alexcrichton/events{/privacy}", "received_events_url": "https://api.github.com/users/alexcrichton/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b27c7095606ad9386a7038d7af03abd7f948f02f", "url": "https://api.github.com/repos/rust-lang/rust/commits/b27c7095606ad9386a7038d7af03abd7f948f02f", "html_url": "https://github.com/rust-lang/rust/commit/b27c7095606ad9386a7038d7af03abd7f948f02f"}], "stats": {"total": 15, "additions": 15, "deletions": 0}, "files": [{"sha": "eb6d768699b054f79a3007d6571b2313c1060863", "filename": ".travis.yml", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/rust-lang/rust/blob/6ae6160e425d146dfba26f4978bdafa5d78fdbd7/.travis.yml", "raw_url": "https://github.com/rust-lang/rust/raw/6ae6160e425d146dfba26f4978bdafa5d78fdbd7/.travis.yml", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/.travis.yml?ref=6ae6160e425d146dfba26f4978bdafa5d78fdbd7", "patch": "@@ -35,27 +35,42 @@ matrix:\n         RUST_CONFIGURE_ARGS=--build=x86_64-apple-darwin\n         SRC=.\n       os: osx\n+      before_script: &osx_before_script >\n+        ulimit -c unlimited\n       install: &osx_install_sccache >\n         curl -L https://api.pub.build.mozilla.org/tooltool/sha512/d0025b286468cc5ada83b23d3fafbc936b9f190eaa7d4a981715b18e8e3bf720a7bcee7bfe758cfdeb8268857f6098fd52dcdd8818232692a30ce91039936596 |\n           tar xJf - -C /usr/local/bin --strip-components=1\n+      after_failure: &osx_after_failure >\n+        echo 'bt all' > cmds;\n+        for file in $(ls /cores); do\n+          echo core file $file;\n+          lldb -c $file `which ld` -b -s cmds;\n+        done\n+\n     - env: >\n         RUST_CHECK_TARGET=check\n         RUST_CONFIGURE_ARGS=--build=i686-apple-darwin\n         SRC=.\n       os: osx\n+      before_script: *osx_before_script\n       install: *osx_install_sccache\n+      after_failure: *osx_after_failure\n     - env: >\n         RUST_CHECK_TARGET=check\n         RUST_CONFIGURE_ARGS=--build=x86_64-apple-darwin --disable-rustbuild\n         SRC=.\n       os: osx\n+      before_script: *osx_before_script\n       install: *osx_install_sccache\n+      after_failure: *osx_after_failure\n     - env: >\n         RUST_CHECK_TARGET=\n         RUST_CONFIGURE_ARGS=--target=aarch64-apple-ios,armv7-apple-ios,armv7s-apple-ios,i386-apple-ios,x86_64-apple-ios\n         SRC=.\n       os: osx\n+      before_script: *osx_before_script\n       install: *osx_install_sccache\n+      after_failure: *osx_after_failure\n \n env:\n   global:"}]}