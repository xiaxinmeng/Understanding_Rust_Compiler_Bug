{"sha": "db872ee1b8a6f8a598eb6cdadd1fc9d4cab374f0", "node_id": "C_kwDOAAsO6NoAKGRiODcyZWUxYjhhNmY4YTU5OGViNmNkYWRkMWZjOWQ0Y2FiMzc0ZjA", "commit": {"author": {"name": "Matthias Kr\u00fcger", "email": "matthias.krueger@famsik.de", "date": "2022-06-28T16:34:35Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-06-28T16:34:35Z"}, "message": "Rollup merge of #98621 - krasimirgg:llvm-15-wrapper, r=nikic\n\nllvm-wrapper: adapt for removal of the ASanGlobalsMetadataAnalysis LLVM API\n\nNo functional changes intended.\n\nThis adapts llvm-wrapper for https://github.com/llvm/llvm-project/commit/dacfa24f75c328ae30b710ecadaa18e4ba10cdc6, which removed `ASanGlobalsMetadataAnalysis`.\n\nFound via our experimental rust + HEAD llvm bot: https://buildkite.com/llvm-project/rust-llvm-integrate-prototype/builds/11565#0181a72f-75bb-4378-88f0-4c0bca7d03fa/231-505.", "tree": {"sha": "3390a0cab464cafea12a69fd2d398c6e7752784b", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/3390a0cab464cafea12a69fd2d398c6e7752784b"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/db872ee1b8a6f8a598eb6cdadd1fc9d4cab374f0", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJiuy2bCRBK7hj4Ov3rIwAAfkQIAItLBA2HUBGw7Ew7TDvAoele\niS5IIKTWDfHCsbAEPYaP4V0orIAHJzy/yULMlv0IKjEFn6OSHz/ZoFgqBsG/984N\nFrwfuVClLRe1SL7iq6kbsAn2jLno6NmYJMPc0mHdot49IZ9WNAXtkVjBZR07NMfm\ncKbw87hhmzGdk9rxex35ywYDtd5f+Gjd0VL9ahe6jS9EBtCV6cvtxUL/NJPg0Fw4\nCIG3aEnSL5mLWe9bfkID+xObVI4XgzlZC+Yeuw3z/nsBo98tIZEuXnDYFJZ6OUzJ\n2xzN4X19xMsrJiwNciFCC074paI5qk07XWJIBs+YEFw+xwxUejL/s5Vc+SJl804=\n=Q/b8\n-----END PGP SIGNATURE-----\n", "payload": "tree 3390a0cab464cafea12a69fd2d398c6e7752784b\nparent 62a787c595981a24b145e8e80d9b5ed889f0de74\nparent fe02ee8be97fc94166e3920d16d550bd6994fabd\nauthor Matthias Kr\u00fcger <matthias.krueger@famsik.de> 1656434075 +0200\ncommitter GitHub <noreply@github.com> 1656434075 +0200\n\nRollup merge of #98621 - krasimirgg:llvm-15-wrapper, r=nikic\n\nllvm-wrapper: adapt for removal of the ASanGlobalsMetadataAnalysis LLVM API\n\nNo functional changes intended.\n\nThis adapts llvm-wrapper for https://github.com/llvm/llvm-project/commit/dacfa24f75c328ae30b710ecadaa18e4ba10cdc6, which removed `ASanGlobalsMetadataAnalysis`.\n\nFound via our experimental rust + HEAD llvm bot: https://buildkite.com/llvm-project/rust-llvm-integrate-prototype/builds/11565#0181a72f-75bb-4378-88f0-4c0bca7d03fa/231-505.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/db872ee1b8a6f8a598eb6cdadd1fc9d4cab374f0", "html_url": "https://github.com/rust-lang/rust/commit/db872ee1b8a6f8a598eb6cdadd1fc9d4cab374f0", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/db872ee1b8a6f8a598eb6cdadd1fc9d4cab374f0/comments", "author": {"login": "matthiaskrgr", "id": 476013, "node_id": "MDQ6VXNlcjQ3NjAxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/476013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matthiaskrgr", "html_url": "https://github.com/matthiaskrgr", "followers_url": "https://api.github.com/users/matthiaskrgr/followers", "following_url": "https://api.github.com/users/matthiaskrgr/following{/other_user}", "gists_url": "https://api.github.com/users/matthiaskrgr/gists{/gist_id}", "starred_url": "https://api.github.com/users/matthiaskrgr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matthiaskrgr/subscriptions", "organizations_url": "https://api.github.com/users/matthiaskrgr/orgs", "repos_url": "https://api.github.com/users/matthiaskrgr/repos", "events_url": "https://api.github.com/users/matthiaskrgr/events{/privacy}", "received_events_url": "https://api.github.com/users/matthiaskrgr/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "62a787c595981a24b145e8e80d9b5ed889f0de74", "url": "https://api.github.com/repos/rust-lang/rust/commits/62a787c595981a24b145e8e80d9b5ed889f0de74", "html_url": "https://github.com/rust-lang/rust/commit/62a787c595981a24b145e8e80d9b5ed889f0de74"}, {"sha": "fe02ee8be97fc94166e3920d16d550bd6994fabd", "url": "https://api.github.com/repos/rust-lang/rust/commits/fe02ee8be97fc94166e3920d16d550bd6994fabd", "html_url": "https://github.com/rust-lang/rust/commit/fe02ee8be97fc94166e3920d16d550bd6994fabd"}], "stats": {"total": 2, "additions": 2, "deletions": 0}, "files": [{"sha": "0f4973ebf7129bd55571a117fd2a1addc216d079", "filename": "compiler/rustc_llvm/llvm-wrapper/PassWrapper.cpp", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/db872ee1b8a6f8a598eb6cdadd1fc9d4cab374f0/compiler%2Frustc_llvm%2Fllvm-wrapper%2FPassWrapper.cpp", "raw_url": "https://github.com/rust-lang/rust/raw/db872ee1b8a6f8a598eb6cdadd1fc9d4cab374f0/compiler%2Frustc_llvm%2Fllvm-wrapper%2FPassWrapper.cpp", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_llvm%2Fllvm-wrapper%2FPassWrapper.cpp?ref=db872ee1b8a6f8a598eb6cdadd1fc9d4cab374f0", "patch": "@@ -985,7 +985,9 @@ LLVMRustOptimizeWithNewPassManager(\n     if (SanitizerOptions->SanitizeAddress) {\n       OptimizerLastEPCallbacks.push_back(\n         [SanitizerOptions](ModulePassManager &MPM, OptimizationLevel Level) {\n+#if LLVM_VERSION_LT(15, 0)\n           MPM.addPass(RequireAnalysisPass<ASanGlobalsMetadataAnalysis, Module>());\n+#endif\n #if LLVM_VERSION_GE(14, 0)\n           AddressSanitizerOptions opts = AddressSanitizerOptions{\n             /*CompileKernel=*/false,"}]}