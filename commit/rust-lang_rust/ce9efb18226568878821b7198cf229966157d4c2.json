{"sha": "ce9efb18226568878821b7198cf229966157d4c2", "node_id": "MDY6Q29tbWl0NzI0NzEyOmNlOWVmYjE4MjI2NTY4ODc4ODIxYjcxOThjZjIyOTk2NjE1N2Q0YzI=", "commit": {"author": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2019-03-16T06:56:51Z"}, "committer": {"name": "kennytm", "email": "kennytm@gmail.com", "date": "2019-03-16T14:40:26Z"}, "message": "Rollup merge of #59156 - davidtwco:issue-55809, r=nikomatsakis\n\n[wg-async-await] Add regression test for #55809.\n\nFixes #55809.\n\nThis PR adds a regression test for #55809 which checks that a\noverflow does not occur when evaluating a requirement for async\nfunctions and `&mut` arguments in some specific circumstances.", "tree": {"sha": "290ca66d0a80323e122f0e9eb72611b3fdb738c7", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/290ca66d0a80323e122f0e9eb72611b3fdb738c7"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/ce9efb18226568878821b7198cf229966157d4c2", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEZ1R8CLMp8f2GxWoQ/vbIBR0OATwFAlyNCtsACgkQ/vbIBR0O\nATySxg/+P1IBY6L1O/IxJWbzy1DhApe6SMH66dfi/oi9N/kIg/aLlF3u/eEf8fNP\nx/WF+AGXSMRQ+vNjdZp2yRaK2BhLPSPH6TzP2n0eFcJUN8qHPdVgh5dhR0J7VJuj\na0gcprVx23ExKhitPxDnmHvAi67NeglFtuBULpQcfHE+a1n22Hmya8j0peA6IRPZ\nfKDW64i5LlUWsM6bMtY/HRkm8zIOOYZ41utHDCEkssopO/jTrscPa3ExR9d/vUyS\nzViYU0s5HuM+cZCS+URHDoiYyBA3OLtLuSHGZma+0oOdO5VBkKaatXpNGi0FnGLo\naPngNg/p93KIsdL+GX1MPNop7PQCMIEmm3cXvXe7WUSkF7Bgi7rEisZpv1Z0A3M1\nW5oj6/6HNbcp9A4SkDYTj/I23ipFwtn2cG1QxRe3qkx0P1v2I1RhiX43N5ycdNi/\n+WcaQim6LWCOASJlNbUYbjKEtACuBh1qh4LnyYok/B2hsSYjytrXVVQB+BArcdXQ\nvQji9kDNVfdt+nWXIdyhANDPSktjUFEprUwQuVDuCJxY4agZtoXHvav0Pik1PGjJ\ny1cgfhJM94gaJ8qAC4v7byCXYg4BIwJ13xq5+i5b0Pz0AYn0C2msMTeWTZCdCtqI\n0iyw2LDCTgNb/8pgWncWBXlvkHO/qn31x7qcB0kcB4t1XFhj5ZQ=\n=BLxQ\n-----END PGP SIGNATURE-----", "payload": "tree 290ca66d0a80323e122f0e9eb72611b3fdb738c7\nparent 6241fb55bacbe1583e4ab47ee5dbb0bee459e1f1\nparent 9d938f69362e9568c14955d7df801c21a2266e66\nauthor kennytm <kennytm@gmail.com> 1552719411 +0800\ncommitter kennytm <kennytm@gmail.com> 1552747226 +0800\n\nRollup merge of #59156 - davidtwco:issue-55809, r=nikomatsakis\n\n[wg-async-await] Add regression test for #55809.\n\nFixes #55809.\n\nThis PR adds a regression test for #55809 which checks that a\noverflow does not occur when evaluating a requirement for async\nfunctions and `&mut` arguments in some specific circumstances.\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/ce9efb18226568878821b7198cf229966157d4c2", "html_url": "https://github.com/rust-lang/rust/commit/ce9efb18226568878821b7198cf229966157d4c2", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/ce9efb18226568878821b7198cf229966157d4c2/comments", "author": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kennytm", "id": 103023, "node_id": "MDQ6VXNlcjEwMzAyMw==", "avatar_url": "https://avatars.githubusercontent.com/u/103023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kennytm", "html_url": "https://github.com/kennytm", "followers_url": "https://api.github.com/users/kennytm/followers", "following_url": "https://api.github.com/users/kennytm/following{/other_user}", "gists_url": "https://api.github.com/users/kennytm/gists{/gist_id}", "starred_url": "https://api.github.com/users/kennytm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kennytm/subscriptions", "organizations_url": "https://api.github.com/users/kennytm/orgs", "repos_url": "https://api.github.com/users/kennytm/repos", "events_url": "https://api.github.com/users/kennytm/events{/privacy}", "received_events_url": "https://api.github.com/users/kennytm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6241fb55bacbe1583e4ab47ee5dbb0bee459e1f1", "url": "https://api.github.com/repos/rust-lang/rust/commits/6241fb55bacbe1583e4ab47ee5dbb0bee459e1f1", "html_url": "https://github.com/rust-lang/rust/commit/6241fb55bacbe1583e4ab47ee5dbb0bee459e1f1"}, {"sha": "9d938f69362e9568c14955d7df801c21a2266e66", "url": "https://api.github.com/repos/rust-lang/rust/commits/9d938f69362e9568c14955d7df801c21a2266e66", "html_url": "https://github.com/rust-lang/rust/commit/9d938f69362e9568c14955d7df801c21a2266e66"}], "stats": {"total": 30, "additions": 30, "deletions": 0}, "files": [{"sha": "86b0977bebe1d5a3f2821d5e6a9423ed3a5a99b4", "filename": "src/test/run-pass/issue-55809.rs", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/rust-lang/rust/blob/ce9efb18226568878821b7198cf229966157d4c2/src%2Ftest%2Frun-pass%2Fissue-55809.rs", "raw_url": "https://github.com/rust-lang/rust/raw/ce9efb18226568878821b7198cf229966157d4c2/src%2Ftest%2Frun-pass%2Fissue-55809.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fissue-55809.rs?ref=ce9efb18226568878821b7198cf229966157d4c2", "patch": "@@ -0,0 +1,30 @@\n+// edition:2018\n+// run-pass\n+\n+#![feature(async_await, await_macro, futures_api)]\n+\n+trait Foo { }\n+\n+impl Foo for () { }\n+\n+impl<'a, T> Foo for &'a mut T where T: Foo { }\n+\n+async fn foo_async<T>(_v: T) -> u8 where T: Foo {\n+    0\n+}\n+\n+async fn bad<T>(v: T) -> u8 where T: Foo {\n+    await!(foo_async(v))\n+}\n+\n+async fn async_main() {\n+    let mut v = ();\n+\n+    let _ = await!(bad(&mut v));\n+    let _ = await!(foo_async(&mut v));\n+    let _ = await!(bad(v));\n+}\n+\n+fn main() {\n+    let _ = async_main();\n+}"}]}