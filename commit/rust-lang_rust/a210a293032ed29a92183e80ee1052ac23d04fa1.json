{"sha": "a210a293032ed29a92183e80ee1052ac23d04fa1", "node_id": "MDY6Q29tbWl0NzI0NzEyOmEyMTBhMjkzMDMyZWQyOWE5MjE4M2U4MGVlMTA1MmFjMjNkMDRmYTE=", "commit": {"author": {"name": "Josh Stone", "email": "jistone@redhat.com", "date": "2020-08-05T18:34:58Z"}, "committer": {"name": "Josh Stone", "email": "jistone@redhat.com", "date": "2020-08-22T20:44:54Z"}, "message": "Expand RISCV pseudo-instructions to match LLVM 11", "tree": {"sha": "6effb9f8f5da0c13172c351af2304e7bc8db12ce", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/6effb9f8f5da0c13172c351af2304e7bc8db12ce"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/a210a293032ed29a92183e80ee1052ac23d04fa1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/a210a293032ed29a92183e80ee1052ac23d04fa1", "html_url": "https://github.com/rust-lang/rust/commit/a210a293032ed29a92183e80ee1052ac23d04fa1", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/a210a293032ed29a92183e80ee1052ac23d04fa1/comments", "author": {"login": "cuviper", "id": 36186, "node_id": "MDQ6VXNlcjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/36186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuviper", "html_url": "https://github.com/cuviper", "followers_url": "https://api.github.com/users/cuviper/followers", "following_url": "https://api.github.com/users/cuviper/following{/other_user}", "gists_url": "https://api.github.com/users/cuviper/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuviper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuviper/subscriptions", "organizations_url": "https://api.github.com/users/cuviper/orgs", "repos_url": "https://api.github.com/users/cuviper/repos", "events_url": "https://api.github.com/users/cuviper/events{/privacy}", "received_events_url": "https://api.github.com/users/cuviper/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cuviper", "id": 36186, "node_id": "MDQ6VXNlcjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/36186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuviper", "html_url": "https://github.com/cuviper", "followers_url": "https://api.github.com/users/cuviper/followers", "following_url": "https://api.github.com/users/cuviper/following{/other_user}", "gists_url": "https://api.github.com/users/cuviper/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuviper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuviper/subscriptions", "organizations_url": "https://api.github.com/users/cuviper/orgs", "repos_url": "https://api.github.com/users/cuviper/repos", "events_url": "https://api.github.com/users/cuviper/events{/privacy}", "received_events_url": "https://api.github.com/users/cuviper/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "636ca7a4129d0e46483a41fc2687999067b45f8f", "url": "https://api.github.com/repos/rust-lang/rust/commits/636ca7a4129d0e46483a41fc2687999067b45f8f", "html_url": "https://github.com/rust-lang/rust/commit/636ca7a4129d0e46483a41fc2687999067b45f8f"}], "stats": {"total": 31, "additions": 16, "deletions": 15}, "files": [{"sha": "67dda1024fc248568f8a3eebecb39261b160f138", "filename": "src/test/assembly/asm/riscv-types.rs", "status": "modified", "additions": 16, "deletions": 15, "changes": 31, "blob_url": "https://github.com/rust-lang/rust/blob/a210a293032ed29a92183e80ee1052ac23d04fa1/src%2Ftest%2Fassembly%2Fasm%2Friscv-types.rs", "raw_url": "https://github.com/rust-lang/rust/raw/a210a293032ed29a92183e80ee1052ac23d04fa1/src%2Ftest%2Fassembly%2Fasm%2Friscv-types.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fassembly%2Fasm%2Friscv-types.rs?ref=a210a293032ed29a92183e80ee1052ac23d04fa1", "patch": "@@ -55,7 +55,8 @@ pub unsafe fn sym_fn() {\n \n // CHECK-LABEL: sym_static:\n // CHECK: #APP\n-// CHECK: lb t0, extern_static\n+// CHECK: auipc t0, %pcrel_hi(extern_static)\n+// CHECK: lb t0, %pcrel_lo(.Lpcrel_hi0)(t0)\n // CHECK: #NO_APP\n #[no_mangle]\n pub unsafe fn sym_static() {\n@@ -98,45 +99,45 @@ macro_rules! check_reg {\n \n // CHECK-LABEL: reg_i8:\n // CHECK: #APP\n-// CHECK: mv {{[a-z0-9]+}}, {{[a-z0-9]+}}\n+// CHECK: add {{[a-z0-9]+}}, zero, {{[a-z0-9]+}}\n // CHECK: #NO_APP\n check!(reg_i8 i8 reg \"mv\");\n \n // CHECK-LABEL: reg_i16:\n // CHECK: #APP\n-// CHECK: mv {{[a-z0-9]+}}, {{[a-z0-9]+}}\n+// CHECK: add {{[a-z0-9]+}}, zero, {{[a-z0-9]+}}\n // CHECK: #NO_APP\n check!(reg_i16 i16 reg \"mv\");\n \n // CHECK-LABEL: reg_i32:\n // CHECK: #APP\n-// CHECK: mv {{[a-z0-9]+}}, {{[a-z0-9]+}}\n+// CHECK: add {{[a-z0-9]+}}, zero, {{[a-z0-9]+}}\n // CHECK: #NO_APP\n check!(reg_i32 i32 reg \"mv\");\n \n // CHECK-LABEL: reg_f32:\n // CHECK: #APP\n-// CHECK: mv {{[a-z0-9]+}}, {{[a-z0-9]+}}\n+// CHECK: add {{[a-z0-9]+}}, zero, {{[a-z0-9]+}}\n // CHECK: #NO_APP\n check!(reg_f32 f32 reg \"mv\");\n \n // riscv64-LABEL: reg_i64:\n // riscv64: #APP\n-// riscv64: mv {{[a-z0-9]+}}, {{[a-z0-9]+}}\n+// riscv64: add {{[a-z0-9]+}}, zero, {{[a-z0-9]+}}\n // riscv64: #NO_APP\n #[cfg(riscv64)]\n check!(reg_i64 i64 reg \"mv\");\n \n // riscv64-LABEL: reg_f64:\n // riscv64: #APP\n-// riscv64: mv {{[a-z0-9]+}}, {{[a-z0-9]+}}\n+// riscv64: add {{[a-z0-9]+}}, zero, {{[a-z0-9]+}}\n // riscv64: #NO_APP\n #[cfg(riscv64)]\n check!(reg_f64 f64 reg \"mv\");\n \n // CHECK-LABEL: reg_ptr:\n // CHECK: #APP\n-// CHECK: mv {{[a-z0-9]+}}, {{[a-z0-9]+}}\n+// CHECK: add {{[a-z0-9]+}}, zero, {{[a-z0-9]+}}\n // CHECK: #NO_APP\n check!(reg_ptr ptr reg \"mv\");\n \n@@ -154,45 +155,45 @@ check!(freg_f64 f64 freg \"fmv.d\");\n \n // CHECK-LABEL: a0_i8:\n // CHECK: #APP\n-// CHECK: mv a0, a0\n+// CHECK: add a0, zero, a0\n // CHECK: #NO_APP\n check_reg!(a0_i8 i8 \"a0\" \"mv\");\n \n // CHECK-LABEL: a0_i16:\n // CHECK: #APP\n-// CHECK: mv a0, a0\n+// CHECK: add a0, zero, a0\n // CHECK: #NO_APP\n check_reg!(a0_i16 i16 \"a0\" \"mv\");\n \n // CHECK-LABEL: a0_i32:\n // CHECK: #APP\n-// CHECK: mv a0, a0\n+// CHECK: add a0, zero, a0\n // CHECK: #NO_APP\n check_reg!(a0_i32 i32 \"a0\" \"mv\");\n \n // CHECK-LABEL: a0_f32:\n // CHECK: #APP\n-// CHECK: mv a0, a0\n+// CHECK: add a0, zero, a0\n // CHECK: #NO_APP\n check_reg!(a0_f32 f32 \"a0\" \"mv\");\n \n // riscv64-LABEL: a0_i64:\n // riscv64: #APP\n-// riscv64: mv a0, a0\n+// riscv64: add a0, zero, a0\n // riscv64: #NO_APP\n #[cfg(riscv64)]\n check_reg!(a0_i64 i64 \"a0\" \"mv\");\n \n // riscv64-LABEL: a0_f64:\n // riscv64: #APP\n-// riscv64: mv a0, a0\n+// riscv64: add a0, zero, a0\n // riscv64: #NO_APP\n #[cfg(riscv64)]\n check_reg!(a0_f64 f64 \"a0\" \"mv\");\n \n // CHECK-LABEL: a0_ptr:\n // CHECK: #APP\n-// CHECK: mv a0, a0\n+// CHECK: add a0, zero, a0\n // CHECK: #NO_APP\n check_reg!(a0_ptr ptr \"a0\" \"mv\");\n "}]}