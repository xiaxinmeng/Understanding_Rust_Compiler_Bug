{"sha": "c104b5c89767101a40ef173eb84d3aa1122e5e9a", "node_id": "MDY6Q29tbWl0NzI0NzEyOmMxMDRiNWM4OTc2NzEwMWE0MGVmMTczZWI4NGQzYWExMTIyZTVlOWE=", "commit": {"author": {"name": "Nick Fitzgerald", "email": "fitzgen@gmail.com", "date": "2019-02-07T14:44:52Z"}, "committer": {"name": "Nick Fitzgerald", "email": "fitzgen@gmail.com", "date": "2019-02-08T09:07:08Z"}, "message": "Also de-duplicate 32- and 64-bit number formatting on wasm32", "tree": {"sha": "05bf089cbe0a3595610739e7eb943d0e1add1485", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/05bf089cbe0a3595610739e7eb943d0e1add1485"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/c104b5c89767101a40ef173eb84d3aa1122e5e9a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/c104b5c89767101a40ef173eb84d3aa1122e5e9a", "html_url": "https://github.com/rust-lang/rust/commit/c104b5c89767101a40ef173eb84d3aa1122e5e9a", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/c104b5c89767101a40ef173eb84d3aa1122e5e9a/comments", "author": {"login": "fitzgen", "id": 74571, "node_id": "MDQ6VXNlcjc0NTcx", "avatar_url": "https://avatars.githubusercontent.com/u/74571?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fitzgen", "html_url": "https://github.com/fitzgen", "followers_url": "https://api.github.com/users/fitzgen/followers", "following_url": "https://api.github.com/users/fitzgen/following{/other_user}", "gists_url": "https://api.github.com/users/fitzgen/gists{/gist_id}", "starred_url": "https://api.github.com/users/fitzgen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fitzgen/subscriptions", "organizations_url": "https://api.github.com/users/fitzgen/orgs", "repos_url": "https://api.github.com/users/fitzgen/repos", "events_url": "https://api.github.com/users/fitzgen/events{/privacy}", "received_events_url": "https://api.github.com/users/fitzgen/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fitzgen", "id": 74571, "node_id": "MDQ6VXNlcjc0NTcx", "avatar_url": "https://avatars.githubusercontent.com/u/74571?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fitzgen", "html_url": "https://github.com/fitzgen", "followers_url": "https://api.github.com/users/fitzgen/followers", "following_url": "https://api.github.com/users/fitzgen/following{/other_user}", "gists_url": "https://api.github.com/users/fitzgen/gists{/gist_id}", "starred_url": "https://api.github.com/users/fitzgen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fitzgen/subscriptions", "organizations_url": "https://api.github.com/users/fitzgen/orgs", "repos_url": "https://api.github.com/users/fitzgen/repos", "events_url": "https://api.github.com/users/fitzgen/events{/privacy}", "received_events_url": "https://api.github.com/users/fitzgen/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e633f152397545c2fd80795fc928ec555656b2ab", "url": "https://api.github.com/repos/rust-lang/rust/commits/e633f152397545c2fd80795fc928ec555656b2ab", "html_url": "https://github.com/rust-lang/rust/commit/e633f152397545c2fd80795fc928ec555656b2ab"}], "stats": {"total": 26, "additions": 18, "deletions": 8}, "files": [{"sha": "b9fa3640371082148624f625ad1e0eabbea9faa7", "filename": "src/libcore/fmt/num.rs", "status": "modified", "additions": 18, "deletions": 8, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/c104b5c89767101a40ef173eb84d3aa1122e5e9a/src%2Flibcore%2Ffmt%2Fnum.rs", "raw_url": "https://github.com/rust-lang/rust/raw/c104b5c89767101a40ef173eb84d3aa1122e5e9a/src%2Flibcore%2Ffmt%2Fnum.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Ffmt%2Fnum.rs?ref=c104b5c89767101a40ef173eb84d3aa1122e5e9a", "patch": "@@ -257,12 +257,22 @@ macro_rules! impl_Display {\n     };\n }\n \n-impl_Display!(i8, u8, i16, u16, i32, u32 as u32 via to_u32 named fmt_u32);\n-impl_Display!(i64, u64 as u64 via to_u64 named fmt_u64);\n+// Include wasm32 in here since it doesn't reflect the native pointer size, and\n+// often cares strongly about getting a smaller code size.\n+#[cfg(any(target_pointer_width = \"64\", target_arch = \"wasm32\"))]\n+mod imp {\n+    use super::*;\n+    impl_Display!(\n+        i8, u8, i16, u16, i32, u32, i64, u64, usize, isize\n+            as u64 via to_u64 named fmt_u64\n+    );\n+}\n+\n+#[cfg(not(any(target_pointer_width = \"64\", target_arch = \"wasm32\")))]\n+mod imp {\n+    use super::*;\n+    impl_Display!(i8, u8, i16, u16, i32, u32, isize, usize as u32 via to_u32 named fmt_u32);\n+    impl_Display!(i64, u64 as u64 via to_u64 named fmt_u64);\n+}\n+\n impl_Display!(i128, u128 as u128 via to_u128 named fmt_u128);\n-#[cfg(target_pointer_width = \"16\")]\n-impl_Display!(isize, usize as u16 via to_u16 named fmt_usize);\n-#[cfg(target_pointer_width = \"32\")]\n-impl_Display!(isize, usize as u32 via to_u32 named fmt_usize);\n-#[cfg(target_pointer_width = \"64\")]\n-impl_Display!(isize, usize as u64 via to_u64 named fmt_usize);"}]}