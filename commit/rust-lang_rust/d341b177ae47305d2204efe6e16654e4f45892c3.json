{"sha": "d341b177ae47305d2204efe6e16654e4f45892c3", "node_id": "MDY6Q29tbWl0NzI0NzEyOmQzNDFiMTc3YWU0NzMwNWQyMjA0ZWZlNmUxNjY1NGU0ZjQ1ODkyYzM=", "commit": {"author": {"name": "memoryruins", "email": "memoryruinsmusic@gmail.com", "date": "2018-09-21T01:14:05Z"}, "committer": {"name": "memoryruins", "email": "memoryruinsmusic@gmail.com", "date": "2018-09-21T01:14:05Z"}, "message": "Add test for deref recursion limit printing twice", "tree": {"sha": "87aa3cd3258caf4d7af97be11cb60e865dd8bf54", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/87aa3cd3258caf4d7af97be11cb60e865dd8bf54"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/d341b177ae47305d2204efe6e16654e4f45892c3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/d341b177ae47305d2204efe6e16654e4f45892c3", "html_url": "https://github.com/rust-lang/rust/commit/d341b177ae47305d2204efe6e16654e4f45892c3", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/d341b177ae47305d2204efe6e16654e4f45892c3/comments", "author": {"login": "memoryruins", "id": 6868531, "node_id": "MDQ6VXNlcjY4Njg1MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/6868531?v=4", "gravatar_id": "", "url": "https://api.github.com/users/memoryruins", "html_url": "https://github.com/memoryruins", "followers_url": "https://api.github.com/users/memoryruins/followers", "following_url": "https://api.github.com/users/memoryruins/following{/other_user}", "gists_url": "https://api.github.com/users/memoryruins/gists{/gist_id}", "starred_url": "https://api.github.com/users/memoryruins/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/memoryruins/subscriptions", "organizations_url": "https://api.github.com/users/memoryruins/orgs", "repos_url": "https://api.github.com/users/memoryruins/repos", "events_url": "https://api.github.com/users/memoryruins/events{/privacy}", "received_events_url": "https://api.github.com/users/memoryruins/received_events", "type": "User", "site_admin": false}, "committer": {"login": "memoryruins", "id": 6868531, "node_id": "MDQ6VXNlcjY4Njg1MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/6868531?v=4", "gravatar_id": "", "url": "https://api.github.com/users/memoryruins", "html_url": "https://github.com/memoryruins", "followers_url": "https://api.github.com/users/memoryruins/followers", "following_url": "https://api.github.com/users/memoryruins/following{/other_user}", "gists_url": "https://api.github.com/users/memoryruins/gists{/gist_id}", "starred_url": "https://api.github.com/users/memoryruins/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/memoryruins/subscriptions", "organizations_url": "https://api.github.com/users/memoryruins/orgs", "repos_url": "https://api.github.com/users/memoryruins/repos", "events_url": "https://api.github.com/users/memoryruins/events{/privacy}", "received_events_url": "https://api.github.com/users/memoryruins/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "20dc0c50704ba1fc8c56a88ae2bf05ddb3e419bc", "url": "https://api.github.com/repos/rust-lang/rust/commits/20dc0c50704ba1fc8c56a88ae2bf05ddb3e419bc", "html_url": "https://github.com/rust-lang/rust/commit/20dc0c50704ba1fc8c56a88ae2bf05ddb3e419bc"}], "stats": {"total": 72, "additions": 72, "deletions": 0}, "files": [{"sha": "22d7d1cd916f633e615cfe622c2588306fcb26f7", "filename": "src/test/ui/issues/issue-38940.rs", "status": "added", "additions": 51, "deletions": 0, "changes": 51, "blob_url": "https://github.com/rust-lang/rust/blob/d341b177ae47305d2204efe6e16654e4f45892c3/src%2Ftest%2Fui%2Fissues%2Fissue-38940.rs", "raw_url": "https://github.com/rust-lang/rust/raw/d341b177ae47305d2204efe6e16654e4f45892c3/src%2Ftest%2Fui%2Fissues%2Fissue-38940.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-38940.rs?ref=d341b177ae47305d2204efe6e16654e4f45892c3", "patch": "@@ -0,0 +1,51 @@\n+// issue-38940: error printed twice for deref recursion limit exceeded\n+// Test that the recursion limit can be changed. In this case, we have\n+// deeply nested types that will fail the `Send` check by overflow\n+// when the recursion limit is set very low.\n+#![allow(dead_code)]\n+#![recursion_limit=\"10\"]\n+macro_rules! link {\n+    ($outer:ident, $inner:ident) => {\n+        struct $outer($inner);\n+        impl $outer {\n+            fn new() -> $outer {\n+                $outer($inner::new())\n+            }\n+        }\n+        impl std::ops::Deref for $outer {\n+            type Target = $inner;\n+            fn deref(&self) -> &$inner {\n+                &self.0\n+            }\n+        }\n+    }\n+}\n+struct Bottom;\n+impl Bottom {\n+    fn new() -> Bottom {\n+        Bottom\n+    }\n+}\n+link!(Top, A);\n+link!(A, B);\n+link!(B, C);\n+link!(C, D);\n+link!(D, E);\n+link!(E, F);\n+link!(F, G);\n+link!(G, H);\n+link!(H, I);\n+link!(I, J);\n+link!(J, K);\n+link!(K, Bottom);\n+fn main() {\n+    let t = Top::new();\n+    let x: &Bottom = &t;\n+    //~^ ERROR mismatched types\n+    //~| NOTE expected type `&Bottom`\n+    //~| NOTE found type `&Top`\n+    //~| NOTE expected struct `Bottom`, found struct `Top`\n+    //~| ERROR reached the recursion limit while auto-dereferencing I\n+    //~| NOTE deref recursion limit reached\n+    //~| NOTE consider adding a `#![recursion_limit=\"20\"]` attribute to your crate\n+}"}, {"sha": "2d3cfda9a5f7272c787357c34a6d21d1bb41a52c", "filename": "src/test/ui/issues/issue-38940.stderr", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/d341b177ae47305d2204efe6e16654e4f45892c3/src%2Ftest%2Fui%2Fissues%2Fissue-38940.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/d341b177ae47305d2204efe6e16654e4f45892c3/src%2Ftest%2Fui%2Fissues%2Fissue-38940.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fissues%2Fissue-38940.stderr?ref=d341b177ae47305d2204efe6e16654e4f45892c3", "patch": "@@ -0,0 +1,21 @@\n+error[E0055]: reached the recursion limit while auto-dereferencing I\n+  --> $DIR/issue-38940.rs:43:22\n+   |\n+LL |     let x: &Bottom = &t;\n+   |                      ^^ deref recursion limit reached\n+   |\n+   = help: consider adding a `#![recursion_limit=\"20\"]` attribute to your crate\n+\n+error[E0308]: mismatched types\n+  --> $DIR/issue-38940.rs:43:22\n+   |\n+LL |     let x: &Bottom = &t;\n+   |                      ^^ expected struct `Bottom`, found struct `Top`\n+   |\n+   = note: expected type `&Bottom`\n+              found type `&Top`\n+\n+error: aborting due to 2 previous errors\n+\n+Some errors occurred: E0055, E0308.\n+For more information about an error, try `rustc --explain E0055`."}]}