{"sha": "57f971bc1610ef57c57616822c60aadc7e477904", "node_id": "MDY6Q29tbWl0NzI0NzEyOjU3Zjk3MWJjMTYxMGVmNTdjNTc2MTY4MjJjNjBhYWRjN2U0Nzc5MDQ=", "commit": {"author": {"name": "bors", "email": "bors@rust-lang.org", "date": "2016-11-07T19:48:16Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2016-11-07T19:48:16Z"}, "message": "Auto merge of #36365 - matthew-piziak:silent-overflow, r=eddyb\n\nfix silent overflows on `Step` impls\n\nPart of https://github.com/rust-lang/rust/issues/36110\n\nr? @eddyb", "tree": {"sha": "09c397f61199a454ea46c49c95690aa2d81de394", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/09c397f61199a454ea46c49c95690aa2d81de394"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/57f971bc1610ef57c57616822c60aadc7e477904", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/57f971bc1610ef57c57616822c60aadc7e477904", "html_url": "https://github.com/rust-lang/rust/commit/57f971bc1610ef57c57616822c60aadc7e477904", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/57f971bc1610ef57c57616822c60aadc7e477904/comments", "author": {"login": "bors", "id": 3372342, "node_id": "MDQ6VXNlcjMzNzIzNDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3372342?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors", "html_url": "https://github.com/bors", "followers_url": "https://api.github.com/users/bors/followers", "following_url": "https://api.github.com/users/bors/following{/other_user}", "gists_url": "https://api.github.com/users/bors/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors/subscriptions", "organizations_url": "https://api.github.com/users/bors/orgs", "repos_url": "https://api.github.com/users/bors/repos", "events_url": "https://api.github.com/users/bors/events{/privacy}", "received_events_url": "https://api.github.com/users/bors/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ec0d1ceb4288cd5e36187f1b523bd1a522537ad4", "url": "https://api.github.com/repos/rust-lang/rust/commits/ec0d1ceb4288cd5e36187f1b523bd1a522537ad4", "html_url": "https://github.com/rust-lang/rust/commit/ec0d1ceb4288cd5e36187f1b523bd1a522537ad4"}, {"sha": "8f19d5c3f6e9e6b37a63175875eae6c11c56822e", "url": "https://api.github.com/repos/rust-lang/rust/commits/8f19d5c3f6e9e6b37a63175875eae6c11c56822e", "html_url": "https://github.com/rust-lang/rust/commit/8f19d5c3f6e9e6b37a63175875eae6c11c56822e"}], "stats": {"total": 62, "additions": 56, "deletions": 6}, "files": [{"sha": "e6f21d6c17ae0ffb8aca334df72b7878d2c0172a", "filename": "src/libcore/iter/range.rs", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/rust-lang/rust/blob/57f971bc1610ef57c57616822c60aadc7e477904/src%2Flibcore%2Fiter%2Frange.rs", "raw_url": "https://github.com/rust-lang/rust/raw/57f971bc1610ef57c57616822c60aadc7e477904/src%2Flibcore%2Fiter%2Frange.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibcore%2Fiter%2Frange.rs?ref=57f971bc1610ef57c57616822c60aadc7e477904", "patch": "@@ -96,12 +96,12 @@ macro_rules! step_impl_unsigned {\n \n             #[inline]\n             fn add_one(&self) -> Self {\n-                *self + 1\n+                Add::add(*self, 1)\n             }\n \n             #[inline]\n             fn sub_one(&self) -> Self {\n-                *self - 1\n+                Sub::sub(*self, 1)\n             }\n \n             #[inline]\n@@ -167,12 +167,12 @@ macro_rules! step_impl_signed {\n \n             #[inline]\n             fn add_one(&self) -> Self {\n-                *self + 1\n+                Add::add(*self, 1)\n             }\n \n             #[inline]\n             fn sub_one(&self) -> Self {\n-                *self - 1\n+                Sub::sub(*self, 1)\n             }\n \n             #[inline]\n@@ -216,12 +216,12 @@ macro_rules! step_impl_no_between {\n \n             #[inline]\n             fn add_one(&self) -> Self {\n-                *self + 1\n+                Add::add(*self, 1)\n             }\n \n             #[inline]\n             fn sub_one(&self) -> Self {\n-                *self - 1\n+                Sub::sub(*self, 1)\n             }\n \n             #[inline]"}, {"sha": "5b9b58f0288945e9f532e0801a4b762a4811624b", "filename": "src/test/run-pass/iter-step-overflow-debug.rs", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/rust-lang/rust/blob/57f971bc1610ef57c57616822c60aadc7e477904/src%2Ftest%2Frun-pass%2Fiter-step-overflow-debug.rs", "raw_url": "https://github.com/rust-lang/rust/raw/57f971bc1610ef57c57616822c60aadc7e477904/src%2Ftest%2Frun-pass%2Fiter-step-overflow-debug.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fiter-step-overflow-debug.rs?ref=57f971bc1610ef57c57616822c60aadc7e477904", "patch": "@@ -0,0 +1,29 @@\n+// Copyright 2016 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// compile-flags: -C debug_assertions=yes\n+\n+use std::panic;\n+\n+fn main() {\n+    let r = panic::catch_unwind(|| {\n+        let mut it = u8::max_value()..;\n+        it.next().unwrap(); // 255\n+        it.next().unwrap();\n+    });\n+    assert!(r.is_err());\n+\n+    let r = panic::catch_unwind(|| {\n+        let mut it = i8::max_value()..;\n+        it.next().unwrap(); // 127\n+        it.next().unwrap();\n+    });\n+    assert!(r.is_err());\n+}"}, {"sha": "8642f1643c11c7e284b5aff842f1021ac0bea4db", "filename": "src/test/run-pass/iter-step-overflow-ndebug.rs", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/rust-lang/rust/blob/57f971bc1610ef57c57616822c60aadc7e477904/src%2Ftest%2Frun-pass%2Fiter-step-overflow-ndebug.rs", "raw_url": "https://github.com/rust-lang/rust/raw/57f971bc1610ef57c57616822c60aadc7e477904/src%2Ftest%2Frun-pass%2Fiter-step-overflow-ndebug.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Frun-pass%2Fiter-step-overflow-ndebug.rs?ref=57f971bc1610ef57c57616822c60aadc7e477904", "patch": "@@ -0,0 +1,21 @@\n+// Copyright 2016 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+// compile-flags: -C debug_assertions=no\n+\n+fn main() {\n+    let mut it = u8::max_value()..;\n+    assert_eq!(it.next().unwrap(), 255);\n+    assert_eq!(it.next().unwrap(), u8::min_value());\n+\n+    let mut it = i8::max_value()..;\n+    assert_eq!(it.next().unwrap(), 127);\n+    assert_eq!(it.next().unwrap(), i8::min_value());\n+}"}]}