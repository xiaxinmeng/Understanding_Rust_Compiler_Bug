{"sha": "1487f2f10efe2d0a54e8627692643f3a48ffdbff", "node_id": "MDY6Q29tbWl0NzI0NzEyOjE0ODdmMmYxMGVmZTJkMGE1NGU4NjI3NjkyNjQzZjNhNDhmZmRiZmY=", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2020-12-24T08:44:52Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2020-12-24T08:44:52Z"}, "message": "Merge #7027\n\n7027: Fix macro_rules not accepting brackets or parentheses r=matklad,lnicola a=Veykril\n\n\n\nCo-authored-by: Lukas Wirth <lukastw97@gmail.com>", "tree": {"sha": "c65db09490068db8a725d870eb65df579e7e41f5", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/c65db09490068db8a725d870eb65df579e7e41f5"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/1487f2f10efe2d0a54e8627692643f3a48ffdbff", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJf5FUECRBK7hj4Ov3rIwAAdHIIAJDGjwF2doz3fzbs/210+nEi\nrnSLeOJ9YKSWkbm5MZ4xBWVzeJ0aNeItLBBE3+uPEq0FXhE/5mPLqFFbjbn4eNcL\njpzgztLgou+2rZS1Hjzw76LVgbP1vR5jPovca1ylbo3FIHp/e+kdr9io3Ny5NO+2\naekIroocEjBviw9Lmh4WpL/pgZy0Gbre1YndkUCRZZ97hpafbPw1VYRkOKeaRqd/\nRNKi/+lX6Z70DRow6WpHXrzaRzqm1He+WYAdmHvyRdI0Ol7YCOU3SIBSrwuUKBqF\n5YvklchxmyN9bSXhk54/aqVYrDQMdbP6CBlkD0cXoquoCdx2hLhx0y/fpB03WKA=\n=sI4N\n-----END PGP SIGNATURE-----\n", "payload": "tree c65db09490068db8a725d870eb65df579e7e41f5\nparent 2c843c477615d46372ae0ffc4a1ab5c622bd2995\nparent 3e0bb895418b2042ee9cd14b2444a36c87a3f449\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1608799492 +0000\ncommitter GitHub <noreply@github.com> 1608799492 +0000\n\nMerge #7027\n\n7027: Fix macro_rules not accepting brackets or parentheses r=matklad,lnicola a=Veykril\n\n\n\nCo-authored-by: Lukas Wirth <lukastw97@gmail.com>\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/1487f2f10efe2d0a54e8627692643f3a48ffdbff", "html_url": "https://github.com/rust-lang/rust/commit/1487f2f10efe2d0a54e8627692643f3a48ffdbff", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/1487f2f10efe2d0a54e8627692643f3a48ffdbff/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2c843c477615d46372ae0ffc4a1ab5c622bd2995", "url": "https://api.github.com/repos/rust-lang/rust/commits/2c843c477615d46372ae0ffc4a1ab5c622bd2995", "html_url": "https://github.com/rust-lang/rust/commit/2c843c477615d46372ae0ffc4a1ab5c622bd2995"}, {"sha": "3e0bb895418b2042ee9cd14b2444a36c87a3f449", "url": "https://api.github.com/repos/rust-lang/rust/commits/3e0bb895418b2042ee9cd14b2444a36c87a3f449", "html_url": "https://github.com/rust-lang/rust/commit/3e0bb895418b2042ee9cd14b2444a36c87a3f449"}], "stats": {"total": 68, "additions": 66, "deletions": 2}, "files": [{"sha": "cf4168d321ea973fcca5e52eb162685564d8e44a", "filename": "crates/parser/src/grammar/items.rs", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/rust-lang/rust/blob/1487f2f10efe2d0a54e8627692643f3a48ffdbff/crates%2Fparser%2Fsrc%2Fgrammar%2Fitems.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1487f2f10efe2d0a54e8627692643f3a48ffdbff/crates%2Fparser%2Fsrc%2Fgrammar%2Fitems.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fparser%2Fsrc%2Fgrammar%2Fitems.rs?ref=1487f2f10efe2d0a54e8627692643f3a48ffdbff", "patch": "@@ -389,10 +389,15 @@ fn macro_rules(p: &mut Parser, m: Marker) {\n     }\n \n     match p.current() {\n-        T!['{'] => {\n+        // test macro_rules_non_brace\n+        // macro_rules! m ( ($i:ident) => {} );\n+        // macro_rules! m [ ($i:ident) => {} ];\n+        T!['['] | T!['('] => {\n             token_tree(p);\n+            p.expect(T![;]);\n         }\n-        _ => p.error(\"expected `{`\"),\n+        T!['{'] => token_tree(p),\n+        _ => p.error(\"expected `{`, `[`, `(`\"),\n     }\n     m.complete(p, MACRO_RULES);\n }"}, {"sha": "4a1f712aa73f9f7fac70d5800460ff9e974117fb", "filename": "crates/syntax/test_data/parser/inline/ok/0158_macro_rules_non_brace.rast", "status": "added", "additions": 57, "deletions": 0, "changes": 57, "blob_url": "https://github.com/rust-lang/rust/blob/1487f2f10efe2d0a54e8627692643f3a48ffdbff/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0158_macro_rules_non_brace.rast", "raw_url": "https://github.com/rust-lang/rust/raw/1487f2f10efe2d0a54e8627692643f3a48ffdbff/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0158_macro_rules_non_brace.rast", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0158_macro_rules_non_brace.rast?ref=1487f2f10efe2d0a54e8627692643f3a48ffdbff", "patch": "@@ -0,0 +1,57 @@\n+SOURCE_FILE@0..74\n+  MACRO_RULES@0..36\n+    MACRO_RULES_KW@0..11 \"macro_rules\"\n+    BANG@11..12 \"!\"\n+    WHITESPACE@12..13 \" \"\n+    NAME@13..14\n+      IDENT@13..14 \"m\"\n+    WHITESPACE@14..15 \" \"\n+    TOKEN_TREE@15..35\n+      L_PAREN@15..16 \"(\"\n+      WHITESPACE@16..17 \" \"\n+      TOKEN_TREE@17..27\n+        L_PAREN@17..18 \"(\"\n+        DOLLAR@18..19 \"$\"\n+        IDENT@19..20 \"i\"\n+        COLON@20..21 \":\"\n+        IDENT@21..26 \"ident\"\n+        R_PAREN@26..27 \")\"\n+      WHITESPACE@27..28 \" \"\n+      EQ@28..29 \"=\"\n+      R_ANGLE@29..30 \">\"\n+      WHITESPACE@30..31 \" \"\n+      TOKEN_TREE@31..33\n+        L_CURLY@31..32 \"{\"\n+        R_CURLY@32..33 \"}\"\n+      WHITESPACE@33..34 \" \"\n+      R_PAREN@34..35 \")\"\n+    SEMICOLON@35..36 \";\"\n+  WHITESPACE@36..37 \"\\n\"\n+  MACRO_RULES@37..73\n+    MACRO_RULES_KW@37..48 \"macro_rules\"\n+    BANG@48..49 \"!\"\n+    WHITESPACE@49..50 \" \"\n+    NAME@50..51\n+      IDENT@50..51 \"m\"\n+    WHITESPACE@51..52 \" \"\n+    TOKEN_TREE@52..72\n+      L_BRACK@52..53 \"[\"\n+      WHITESPACE@53..54 \" \"\n+      TOKEN_TREE@54..64\n+        L_PAREN@54..55 \"(\"\n+        DOLLAR@55..56 \"$\"\n+        IDENT@56..57 \"i\"\n+        COLON@57..58 \":\"\n+        IDENT@58..63 \"ident\"\n+        R_PAREN@63..64 \")\"\n+      WHITESPACE@64..65 \" \"\n+      EQ@65..66 \"=\"\n+      R_ANGLE@66..67 \">\"\n+      WHITESPACE@67..68 \" \"\n+      TOKEN_TREE@68..70\n+        L_CURLY@68..69 \"{\"\n+        R_CURLY@69..70 \"}\"\n+      WHITESPACE@70..71 \" \"\n+      R_BRACK@71..72 \"]\"\n+    SEMICOLON@72..73 \";\"\n+  WHITESPACE@73..74 \"\\n\""}, {"sha": "6033a28cd6454ba6d30b9f90052cc20d88bfe07d", "filename": "crates/syntax/test_data/parser/inline/ok/0158_macro_rules_non_brace.rs", "status": "added", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/1487f2f10efe2d0a54e8627692643f3a48ffdbff/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0158_macro_rules_non_brace.rs", "raw_url": "https://github.com/rust-lang/rust/raw/1487f2f10efe2d0a54e8627692643f3a48ffdbff/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0158_macro_rules_non_brace.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/crates%2Fsyntax%2Ftest_data%2Fparser%2Finline%2Fok%2F0158_macro_rules_non_brace.rs?ref=1487f2f10efe2d0a54e8627692643f3a48ffdbff", "patch": "@@ -0,0 +1,2 @@\n+macro_rules! m ( ($i:ident) => {} );\n+macro_rules! m [ ($i:ident) => {} ];"}]}