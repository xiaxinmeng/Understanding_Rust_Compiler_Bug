{"sha": "fb3e724d7602675f147a9b80e70fb6bd6512738c", "node_id": "C_kwDOAAsO6NoAKGZiM2U3MjRkNzYwMjY3NWYxNDdhOWI4MGU3MGZiNmJkNjUxMjczOGM", "commit": {"author": {"name": "Joshua Nelson", "email": "jnelson@cloudflare.com", "date": "2022-10-27T18:00:55Z"}, "committer": {"name": "Joshua Nelson", "email": "jnelson@cloudflare.com", "date": "2022-11-25T01:22:08Z"}, "message": "Don't set `is_preview` for clippy and rustfmt\n\nThese have been shipped on stable for many years now and it would be very disruptive to ever remove them.\nRemove the `-preview` suffix from their dist components.", "tree": {"sha": "40765940bcc81d2e7715ce3dfe96f325a4fbb506", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/40765940bcc81d2e7715ce3dfe96f325a4fbb506"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/fb3e724d7602675f147a9b80e70fb6bd6512738c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/fb3e724d7602675f147a9b80e70fb6bd6512738c", "html_url": "https://github.com/rust-lang/rust/commit/fb3e724d7602675f147a9b80e70fb6bd6512738c", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/fb3e724d7602675f147a9b80e70fb6bd6512738c/comments", "author": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jyn514", "id": 23638587, "node_id": "MDQ6VXNlcjIzNjM4NTg3", "avatar_url": "https://avatars.githubusercontent.com/u/23638587?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jyn514", "html_url": "https://github.com/jyn514", "followers_url": "https://api.github.com/users/jyn514/followers", "following_url": "https://api.github.com/users/jyn514/following{/other_user}", "gists_url": "https://api.github.com/users/jyn514/gists{/gist_id}", "starred_url": "https://api.github.com/users/jyn514/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jyn514/subscriptions", "organizations_url": "https://api.github.com/users/jyn514/orgs", "repos_url": "https://api.github.com/users/jyn514/repos", "events_url": "https://api.github.com/users/jyn514/events{/privacy}", "received_events_url": "https://api.github.com/users/jyn514/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bebd57a9602e48431c90274fbf7d96683b0708b6", "url": "https://api.github.com/repos/rust-lang/rust/commits/bebd57a9602e48431c90274fbf7d96683b0708b6", "html_url": "https://github.com/rust-lang/rust/commit/bebd57a9602e48431c90274fbf7d96683b0708b6"}], "stats": {"total": 12, "additions": 5, "deletions": 7}, "files": [{"sha": "05e3321993782613fcb3444885c4ca122bc52c7b", "filename": "src/bootstrap/dist.rs", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fb3e724d7602675f147a9b80e70fb6bd6512738c/src%2Fbootstrap%2Fdist.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fb3e724d7602675f147a9b80e70fb6bd6512738c/src%2Fbootstrap%2Fdist.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdist.rs?ref=fb3e724d7602675f147a9b80e70fb6bd6512738c", "patch": "@@ -1153,7 +1153,6 @@ impl Step for Clippy {\n \n         let mut tarball = Tarball::new(builder, \"clippy\", &target.triple);\n         tarball.set_overlay(OverlayKind::Clippy);\n-        tarball.is_preview(true);\n         tarball.add_file(clippy, \"bin\", 0o755);\n         tarball.add_file(cargoclippy, \"bin\", 0o755);\n         tarball.add_legal_and_readme_to(\"share/doc/clippy\");\n@@ -1251,7 +1250,6 @@ impl Step for Rustfmt {\n             .expect(\"cargo fmt expected to build - essential tool\");\n         let mut tarball = Tarball::new(builder, \"rustfmt\", &target.triple);\n         tarball.set_overlay(OverlayKind::Rustfmt);\n-        tarball.is_preview(true);\n         tarball.add_file(rustfmt, \"bin\", 0o755);\n         tarball.add_file(cargofmt, \"bin\", 0o755);\n         tarball.add_legal_and_readme_to(\"share/doc/rustfmt\");\n@@ -1512,8 +1510,6 @@ impl Step for Extended {\n                     format!(\"{}-{}\", name, target.triple)\n                 } else if name == \"rust-analyzer\" {\n                     \"rust-analyzer-preview\".to_string()\n-                } else if name == \"clippy\" {\n-                    \"clippy-preview\".to_string()\n                 } else if name == \"rust-demangler\" {\n                     \"rust-demangler-preview\".to_string()\n                 } else if name == \"miri\" {"}, {"sha": "430b3496d007c7b0c0cffccacd4fbcfd1b7693a3", "filename": "src/bootstrap/download.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fb3e724d7602675f147a9b80e70fb6bd6512738c/src%2Fbootstrap%2Fdownload.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fb3e724d7602675f147a9b80e70fb6bd6512738c/src%2Fbootstrap%2Fdownload.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fbootstrap%2Fdownload.rs?ref=fb3e724d7602675f147a9b80e70fb6bd6512738c", "patch": "@@ -326,6 +326,8 @@ impl Config {\n         }\n \n         let filename = format!(\"rustfmt-{version}-{build}.tar.xz\", build = host.triple);\n+        // cfg(bootstrap): will need to be changed from `rustfmt-preview` to `rustfmt` the next time you run `bump-stage0`.\n+        // See <https://github.com/rust-lang/rust/pull/103648>\n         self.download_component(DownloadSource::Dist, filename, \"rustfmt-preview\", &date, \"stage0\");\n \n         self.fix_bin_or_dylib(&bin_root.join(\"bin\").join(\"rustfmt\"));"}, {"sha": "66e6982d6b4d3c9941aef8c6b766e7e4193fd777", "filename": "src/tools/build-manifest/src/versions.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/fb3e724d7602675f147a9b80e70fb6bd6512738c/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fversions.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fb3e724d7602675f147a9b80e70fb6bd6512738c/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fversions.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fbuild-manifest%2Fsrc%2Fversions.rs?ref=fb3e724d7602675f147a9b80e70fb6bd6512738c", "patch": "@@ -49,10 +49,10 @@ pkg_type! {\n     Cargo = \"cargo\",\n     HtmlDocs = \"rust-docs\",\n     RustAnalysis = \"rust-analysis\",\n+    Clippy = \"clippy\",\n+    Rustfmt = \"rustfmt\",\n     Rls = \"rls\"; preview = true,\n     RustAnalyzer = \"rust-analyzer\"; preview = true,\n-    Clippy = \"clippy\"; preview = true,\n-    Rustfmt = \"rustfmt\"; preview = true,\n     LlvmTools = \"llvm-tools\"; preview = true,\n     Miri = \"miri\"; preview = true,\n     JsonDocs = \"rust-docs-json\"; preview = true,"}, {"sha": "388203ee4637fb7b36dc0d98630d04f85bc25ae0", "filename": "src/tools/bump-stage0/src/main.rs", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/fb3e724d7602675f147a9b80e70fb6bd6512738c/src%2Ftools%2Fbump-stage0%2Fsrc%2Fmain.rs", "raw_url": "https://github.com/rust-lang/rust/raw/fb3e724d7602675f147a9b80e70fb6bd6512738c/src%2Ftools%2Fbump-stage0%2Fsrc%2Fmain.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftools%2Fbump-stage0%2Fsrc%2Fmain.rs?ref=fb3e724d7602675f147a9b80e70fb6bd6512738c", "patch": "@@ -6,7 +6,7 @@ use std::convert::TryInto;\n \n const PATH: &str = \"src/stage0.json\";\n const COMPILER_COMPONENTS: &[&str] = &[\"rustc\", \"rust-std\", \"cargo\"];\n-const RUSTFMT_COMPONENTS: &[&str] = &[\"rustfmt-preview\"];\n+const RUSTFMT_COMPONENTS: &[&str] = &[\"rustfmt\"];\n \n struct Tool {\n     config: Config,"}]}