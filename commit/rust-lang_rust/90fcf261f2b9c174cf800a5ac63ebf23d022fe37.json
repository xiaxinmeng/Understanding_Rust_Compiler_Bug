{"sha": "90fcf261f2b9c174cf800a5ac63ebf23d022fe37", "node_id": "MDY6Q29tbWl0NzI0NzEyOjkwZmNmMjYxZjJiOWMxNzRjZjgwMGE1YWM2M2ViZjIzZDAyMmZlMzc=", "commit": {"author": {"name": "Ariel Ben-Yehuda", "email": "arielb1@mail.tau.ac.il", "date": "2015-07-04T12:30:00Z"}, "committer": {"name": "Ariel Ben-Yehuda", "email": "arielb1@mail.tau.ac.il", "date": "2015-07-04T13:17:26Z"}, "message": "Remove outdated errors for mutating strings", "tree": {"sha": "8d57efeb4eb1843d5b9f9d4a581c93b25040a1a8", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/8d57efeb4eb1843d5b9f9d4a581c93b25040a1a8"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/90fcf261f2b9c174cf800a5ac63ebf23d022fe37", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/90fcf261f2b9c174cf800a5ac63ebf23d022fe37", "html_url": "https://github.com/rust-lang/rust/commit/90fcf261f2b9c174cf800a5ac63ebf23d022fe37", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/90fcf261f2b9c174cf800a5ac63ebf23d022fe37/comments", "author": null, "committer": null, "parents": [{"sha": "0dc08240ea755679e3daec3832a04b22a8fc90bf", "url": "https://api.github.com/repos/rust-lang/rust/commits/0dc08240ea755679e3daec3832a04b22a8fc90bf", "html_url": "https://github.com/rust-lang/rust/commit/0dc08240ea755679e3daec3832a04b22a8fc90bf"}], "stats": {"total": 68, "additions": 40, "deletions": 28}, "files": [{"sha": "eb504d03209f60216eb5ddcaf9be322aae916dd6", "filename": "src/librustc/diagnostics.rs", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/90fcf261f2b9c174cf800a5ac63ebf23d022fe37/src%2Flibrustc%2Fdiagnostics.rs", "raw_url": "https://github.com/rust-lang/rust/raw/90fcf261f2b9c174cf800a5ac63ebf23d022fe37/src%2Flibrustc%2Fdiagnostics.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fdiagnostics.rs?ref=90fcf261f2b9c174cf800a5ac63ebf23d022fe37", "patch": "@@ -1205,8 +1205,8 @@ register_diagnostics! {\n     E0017,\n     E0022,\n     E0038,\n-    E0134,\n-    E0135,\n+//  E0134,\n+//  E0135,\n     E0136,\n     E0138,\n     E0139,"}, {"sha": "1ee557eb8cce330512a434eaa0d99fe9d09e5e4b", "filename": "src/librustc/middle/effect.rs", "status": "modified", "additions": 0, "deletions": 26, "changes": 26, "blob_url": "https://github.com/rust-lang/rust/blob/90fcf261f2b9c174cf800a5ac63ebf23d022fe37/src%2Flibrustc%2Fmiddle%2Feffect.rs", "raw_url": "https://github.com/rust-lang/rust/raw/90fcf261f2b9c174cf800a5ac63ebf23d022fe37/src%2Flibrustc%2Fmiddle%2Feffect.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Flibrustc%2Fmiddle%2Feffect.rs?ref=90fcf261f2b9c174cf800a5ac63ebf23d022fe37", "patch": "@@ -59,26 +59,6 @@ impl<'a, 'tcx> EffectCheckVisitor<'a, 'tcx> {\n             UnsafeFn => {}\n         }\n     }\n-\n-    fn check_str_index(&mut self, e: &ast::Expr) {\n-        let base_type = match e.node {\n-            ast::ExprIndex(ref base, _) => self.tcx.node_id_to_type(base.id),\n-            _ => return\n-        };\n-        debug!(\"effect: checking index with base type {:?}\",\n-                 base_type);\n-        match base_type.sty {\n-            ty::TyBox(ty) | ty::TyRef(_, ty::mt{ty, ..}) => if ty::TyStr == ty.sty {\n-                span_err!(self.tcx.sess, e.span, E0134,\n-                          \"modification of string types is not allowed\");\n-            },\n-            ty::TyStr => {\n-                span_err!(self.tcx.sess, e.span, E0135,\n-                          \"modification of string types is not allowed\");\n-            }\n-            _ => {}\n-        }\n-    }\n }\n \n impl<'a, 'tcx, 'v> Visitor<'v> for EffectCheckVisitor<'a, 'tcx> {\n@@ -164,12 +144,6 @@ impl<'a, 'tcx, 'v> Visitor<'v> for EffectCheckVisitor<'a, 'tcx> {\n                     self.require_unsafe(expr.span, \"dereference of raw pointer\")\n                 }\n             }\n-            ast::ExprAssign(ref base, _) | ast::ExprAssignOp(_, ref base, _) => {\n-                self.check_str_index(&**base);\n-            }\n-            ast::ExprAddrOf(ast::MutMutable, ref base) => {\n-                self.check_str_index(&**base);\n-            }\n             ast::ExprInlineAsm(..) => {\n                 self.require_unsafe(expr.span, \"use of inline assembly\");\n             }"}, {"sha": "aa05d7d5c54d7fabb81ef21796178eeb542d4d22", "filename": "src/test/compile-fail/str-mut-idx-2.rs", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/rust-lang/rust/blob/90fcf261f2b9c174cf800a5ac63ebf23d022fe37/src%2Ftest%2Fcompile-fail%2Fstr-mut-idx-2.rs", "raw_url": "https://github.com/rust-lang/rust/raw/90fcf261f2b9c174cf800a5ac63ebf23d022fe37/src%2Ftest%2Fcompile-fail%2Fstr-mut-idx-2.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fstr-mut-idx-2.rs?ref=90fcf261f2b9c174cf800a5ac63ebf23d022fe37", "patch": "@@ -0,0 +1,16 @@\n+// Copyright 2015 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+fn mutate(mut s: &mut str) {\n+    let _s: &mut str = &mut s[1..2];\n+    //~^ ERROR cannot borrow immutable indexed content as mutable\n+}\n+\n+pub fn main() {}"}, {"sha": "88e90c8244d87b5549badb6777e288cab7d1b5e0", "filename": "src/test/compile-fail/str-mut-idx.rs", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/rust-lang/rust/blob/90fcf261f2b9c174cf800a5ac63ebf23d022fe37/src%2Ftest%2Fcompile-fail%2Fstr-mut-idx.rs", "raw_url": "https://github.com/rust-lang/rust/raw/90fcf261f2b9c174cf800a5ac63ebf23d022fe37/src%2Ftest%2Fcompile-fail%2Fstr-mut-idx.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fcompile-fail%2Fstr-mut-idx.rs?ref=90fcf261f2b9c174cf800a5ac63ebf23d022fe37", "patch": "@@ -0,0 +1,22 @@\n+// Copyright 2015 The Rust Project Developers. See the COPYRIGHT\n+// file at the top-level directory of this distribution and at\n+// http://rust-lang.org/COPYRIGHT.\n+//\n+// Licensed under the Apache License, Version 2.0 <LICENSE-APACHE or\n+// http://www.apache.org/licenses/LICENSE-2.0> or the MIT license\n+// <LICENSE-MIT or http://opensource.org/licenses/MIT>, at your\n+// option. This file may not be copied, modified, or distributed\n+// except according to those terms.\n+\n+fn bot<T>() -> T { loop {} }\n+\n+fn mutate(s: &mut str) {\n+    s[1..2] = bot();\n+    //~^ ERROR `core::marker::Sized` is not implemented for the type `str`\n+    //~^^ ERROR `core::marker::Sized` is not implemented for the type `str`\n+    s[1usize] = bot();\n+    //~^ ERROR `core::ops::Index<usize>` is not implemented for the type `str`\n+    //~^^ ERROR `core::ops::Index<usize>` is not implemented for the type `str`\n+}\n+\n+pub fn main() {}"}]}