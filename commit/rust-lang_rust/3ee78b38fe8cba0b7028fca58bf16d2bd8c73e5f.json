{"sha": "3ee78b38fe8cba0b7028fca58bf16d2bd8c73e5f", "node_id": "MDY6Q29tbWl0NzI0NzEyOjNlZTc4YjM4ZmU4Y2JhMGI3MDI4ZmNhNThiZjE2ZDJiZDhjNzNlNWY=", "commit": {"author": {"name": "Yuki Okushi", "email": "jtitor@2k36.org", "date": "2021-06-21T15:00:36Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-06-21T15:00:36Z"}, "message": "Rollup merge of #86192 - hi-rustin:rustin-patch-lint, r=nikomatsakis\n\nMake OR_PATTERNS_BACK_COMPAT be a 2021 future-incompatible lint\n\nclose https://github.com/rust-lang/rust/issues/84869\n\nr? `@nikomatsakis`", "tree": {"sha": "df46b5f397c9e30878781fbe7bf0be00f44cb40e", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/df46b5f397c9e30878781fbe7bf0be00f44cb40e"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3ee78b38fe8cba0b7028fca58bf16d2bd8c73e5f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJg0KmUCRBK7hj4Ov3rIwAANgUIAAeOECiXecmWuru9p/aC6QK3\nomYpAY5B9Zt7E1HTGgAVCDfvSJRCWd2UDCeq1g+C2P5wXmqTz6ABx/MNoRaAHjk+\nqL3AczVnotOboT8LbOclDdtdQdnQ6MkYhEmYEGFGIHYmyKpDKpcB5YX1fIMXlv7v\nMHHwI1a0d+CY6pUfUNqyOc/tunWq3Z+jImV1m5IMGuetYJP0mkulMzIQyiDc6EK7\nCkXP59qDiertYYq5G7dYJuWESX2PWYbftdSNkT86s525nz2jYVuBd9C7qIr6dZeS\nKwE3mEoAl6eXkmyXNnSCHaobfZ+2JYj3sA6dkEbcRpzhaWCIJyQxDcqGRKNZ69g=\n=5o/p\n-----END PGP SIGNATURE-----\n", "payload": "tree df46b5f397c9e30878781fbe7bf0be00f44cb40e\nparent 9d93819fa7ae40376ac1f563a858d2ba5f3b0277\nparent 0fdd6cc2591e0dca3c55a698444e0e83e07b0ccb\nauthor Yuki Okushi <jtitor@2k36.org> 1624287636 +0900\ncommitter GitHub <noreply@github.com> 1624287636 +0900\n\nRollup merge of #86192 - hi-rustin:rustin-patch-lint, r=nikomatsakis\n\nMake OR_PATTERNS_BACK_COMPAT be a 2021 future-incompatible lint\n\nclose https://github.com/rust-lang/rust/issues/84869\n\nr? `@nikomatsakis`\n"}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3ee78b38fe8cba0b7028fca58bf16d2bd8c73e5f", "html_url": "https://github.com/rust-lang/rust/commit/3ee78b38fe8cba0b7028fca58bf16d2bd8c73e5f", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3ee78b38fe8cba0b7028fca58bf16d2bd8c73e5f/comments", "author": {"login": "JohnTitor", "id": 25030997, "node_id": "MDQ6VXNlcjI1MDMwOTk3", "avatar_url": "https://avatars.githubusercontent.com/u/25030997?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JohnTitor", "html_url": "https://github.com/JohnTitor", "followers_url": "https://api.github.com/users/JohnTitor/followers", "following_url": "https://api.github.com/users/JohnTitor/following{/other_user}", "gists_url": "https://api.github.com/users/JohnTitor/gists{/gist_id}", "starred_url": "https://api.github.com/users/JohnTitor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JohnTitor/subscriptions", "organizations_url": "https://api.github.com/users/JohnTitor/orgs", "repos_url": "https://api.github.com/users/JohnTitor/repos", "events_url": "https://api.github.com/users/JohnTitor/events{/privacy}", "received_events_url": "https://api.github.com/users/JohnTitor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9d93819fa7ae40376ac1f563a858d2ba5f3b0277", "url": "https://api.github.com/repos/rust-lang/rust/commits/9d93819fa7ae40376ac1f563a858d2ba5f3b0277", "html_url": "https://github.com/rust-lang/rust/commit/9d93819fa7ae40376ac1f563a858d2ba5f3b0277"}, {"sha": "0fdd6cc2591e0dca3c55a698444e0e83e07b0ccb", "url": "https://api.github.com/repos/rust-lang/rust/commits/0fdd6cc2591e0dca3c55a698444e0e83e07b0ccb", "html_url": "https://github.com/rust-lang/rust/commit/0fdd6cc2591e0dca3c55a698444e0e83e07b0ccb"}], "stats": {"total": 57, "additions": 45, "deletions": 12}, "files": [{"sha": "f95d4a6ca54812b2efb33dce2d2ad6a46ae9dd72", "filename": "compiler/rustc_lint_defs/src/builtin.rs", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/rust-lang/rust/blob/3ee78b38fe8cba0b7028fca58bf16d2bd8c73e5f/compiler%2Frustc_lint_defs%2Fsrc%2Fbuiltin.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ee78b38fe8cba0b7028fca58bf16d2bd8c73e5f/compiler%2Frustc_lint_defs%2Fsrc%2Fbuiltin.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/compiler%2Frustc_lint_defs%2Fsrc%2Fbuiltin.rs?ref=3ee78b38fe8cba0b7028fca58bf16d2bd8c73e5f", "patch": "@@ -3239,4 +3239,8 @@ declare_lint! {\n     pub OR_PATTERNS_BACK_COMPAT,\n     Allow,\n     \"detects usage of old versions of or-patterns\",\n+    @future_incompatible = FutureIncompatibleInfo {\n+        reference: \"issue #84869 <https://github.com/rust-lang/rust/issues/84869>\",\n+        edition: Some(Edition::Edition2021),\n+    };\n }"}, {"sha": "f4e81a6be2a8906b4607abb2bc817b4836cc6faf", "filename": "src/test/ui/macros/macro-or-patterns-back-compat.fixed", "status": "modified", "additions": 13, "deletions": 4, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/3ee78b38fe8cba0b7028fca58bf16d2bd8c73e5f/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.fixed", "raw_url": "https://github.com/rust-lang/rust/raw/3ee78b38fe8cba0b7028fca58bf16d2bd8c73e5f/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.fixed", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.fixed?ref=3ee78b38fe8cba0b7028fca58bf16d2bd8c73e5f", "patch": "@@ -2,13 +2,22 @@\n \n #![deny(or_patterns_back_compat)]\n #![allow(unused_macros)]\n-macro_rules! foo { ($x:pat_param | $y:pat) => {} } //~ ERROR the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n-macro_rules! bar { ($($x:pat_param)+ | $($y:pat)+) => {} } //~ ERROR the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n+\n+macro_rules! foo { ($x:pat_param | $y:pat) => {} }\n+//~^ ERROR the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n+//~| WARN this was previously accepted\n+macro_rules! bar { ($($x:pat_param)+ | $($y:pat)+) => {} }\n+//~^ ERROR the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n+//~| WARN this was previously accepted\n macro_rules! baz { ($x:pat_param | $y:pat_param) => {} } // should be ok\n macro_rules! qux { ($x:pat_param | $y:pat) => {} } // should be ok\n-macro_rules! ogg { ($x:pat_param | $y:pat_param) => {} } //~ ERROR the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n+macro_rules! ogg { ($x:pat_param | $y:pat_param) => {} }\n+//~^ ERROR the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n+//~| WARN this was previously accepted\n macro_rules! match_any {\n-    ( $expr:expr , $( $( $pat:pat_param )|+ => $expr_arm:expr ),+ ) => { //~ ERROR the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n+    ( $expr:expr , $( $( $pat:pat_param )|+ => $expr_arm:expr ),+ ) => {\n+        //~^ ERROR the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n+        //~| WARN this was previously accepted\n         match $expr {\n             $(\n                 $( $pat => $expr_arm, )+"}, {"sha": "49affdd38da9d79e4ac65db131ccbef38f255fd4", "filename": "src/test/ui/macros/macro-or-patterns-back-compat.rs", "status": "modified", "additions": 13, "deletions": 4, "changes": 17, "blob_url": "https://github.com/rust-lang/rust/blob/3ee78b38fe8cba0b7028fca58bf16d2bd8c73e5f/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.rs", "raw_url": "https://github.com/rust-lang/rust/raw/3ee78b38fe8cba0b7028fca58bf16d2bd8c73e5f/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.rs", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.rs?ref=3ee78b38fe8cba0b7028fca58bf16d2bd8c73e5f", "patch": "@@ -2,13 +2,22 @@\n \n #![deny(or_patterns_back_compat)]\n #![allow(unused_macros)]\n-macro_rules! foo { ($x:pat | $y:pat) => {} } //~ ERROR the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n-macro_rules! bar { ($($x:pat)+ | $($y:pat)+) => {} } //~ ERROR the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n+\n+macro_rules! foo { ($x:pat | $y:pat) => {} }\n+//~^ ERROR the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n+//~| WARN this was previously accepted\n+macro_rules! bar { ($($x:pat)+ | $($y:pat)+) => {} }\n+//~^ ERROR the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n+//~| WARN this was previously accepted\n macro_rules! baz { ($x:pat_param | $y:pat_param) => {} } // should be ok\n macro_rules! qux { ($x:pat_param | $y:pat) => {} } // should be ok\n-macro_rules! ogg { ($x:pat | $y:pat_param) => {} } //~ ERROR the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n+macro_rules! ogg { ($x:pat | $y:pat_param) => {} }\n+//~^ ERROR the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n+//~| WARN this was previously accepted\n macro_rules! match_any {\n-    ( $expr:expr , $( $( $pat:pat )|+ => $expr_arm:expr ),+ ) => { //~ ERROR the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n+    ( $expr:expr , $( $( $pat:pat )|+ => $expr_arm:expr ),+ ) => {\n+        //~^ ERROR the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n+        //~| WARN this was previously accepted\n         match $expr {\n             $(\n                 $( $pat => $expr_arm, )+"}, {"sha": "62687eb36b89e7984bc62cca630d88984f97dccf", "filename": "src/test/ui/macros/macro-or-patterns-back-compat.stderr", "status": "modified", "additions": 15, "deletions": 4, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/3ee78b38fe8cba0b7028fca58bf16d2bd8c73e5f/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.stderr", "raw_url": "https://github.com/rust-lang/rust/raw/3ee78b38fe8cba0b7028fca58bf16d2bd8c73e5f/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.stderr", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Ftest%2Fui%2Fmacros%2Fmacro-or-patterns-back-compat.stderr?ref=3ee78b38fe8cba0b7028fca58bf16d2bd8c73e5f", "patch": "@@ -1,5 +1,5 @@\n error: the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n-  --> $DIR/macro-or-patterns-back-compat.rs:5:21\n+  --> $DIR/macro-or-patterns-back-compat.rs:6:21\n    |\n LL | macro_rules! foo { ($x:pat | $y:pat) => {} }\n    |                     ^^^^^^ help: use pat_param to preserve semantics: `$x:pat_param`\n@@ -9,24 +9,35 @@ note: the lint level is defined here\n    |\n LL | #![deny(or_patterns_back_compat)]\n    |         ^^^^^^^^^^^^^^^^^^^^^^^\n+   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in the 2021 edition!\n+   = note: for more information, see issue #84869 <https://github.com/rust-lang/rust/issues/84869>\n \n error: the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n-  --> $DIR/macro-or-patterns-back-compat.rs:6:23\n+  --> $DIR/macro-or-patterns-back-compat.rs:9:23\n    |\n LL | macro_rules! bar { ($($x:pat)+ | $($y:pat)+) => {} }\n    |                       ^^^^^^ help: use pat_param to preserve semantics: `$x:pat_param`\n+   |\n+   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in the 2021 edition!\n+   = note: for more information, see issue #84869 <https://github.com/rust-lang/rust/issues/84869>\n \n error: the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n-  --> $DIR/macro-or-patterns-back-compat.rs:9:21\n+  --> $DIR/macro-or-patterns-back-compat.rs:14:21\n    |\n LL | macro_rules! ogg { ($x:pat | $y:pat_param) => {} }\n    |                     ^^^^^^ help: use pat_param to preserve semantics: `$x:pat_param`\n+   |\n+   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in the 2021 edition!\n+   = note: for more information, see issue #84869 <https://github.com/rust-lang/rust/issues/84869>\n \n error: the meaning of the `pat` fragment specifier is changing in Rust 2021, which may affect this macro\n-  --> $DIR/macro-or-patterns-back-compat.rs:11:26\n+  --> $DIR/macro-or-patterns-back-compat.rs:18:26\n    |\n LL |     ( $expr:expr , $( $( $pat:pat )|+ => $expr_arm:expr ),+ ) => {\n    |                          ^^^^^^^^ help: use pat_param to preserve semantics: `$pat:pat_param`\n+   |\n+   = warning: this was previously accepted by the compiler but is being phased out; it will become a hard error in the 2021 edition!\n+   = note: for more information, see issue #84869 <https://github.com/rust-lang/rust/issues/84869>\n \n error: aborting due to 4 previous errors\n "}]}