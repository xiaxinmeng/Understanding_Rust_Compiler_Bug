{"sha": "3477939b798b64f135a09f1b8b54a0034ede3246", "node_id": "MDY6Q29tbWl0NzI0NzEyOjM0Nzc5MzliNzk4YjY0ZjEzNWEwOWYxYjhiNTRhMDAzNGVkZTMyNDY=", "commit": {"author": {"name": "Josh Stone", "email": "jistone@redhat.com", "date": "2019-03-07T04:14:27Z"}, "committer": {"name": "Josh Stone", "email": "jistone@redhat.com", "date": "2019-03-07T04:14:27Z"}, "message": "[CI] Update binutils for powerpc64 and powerpc64le\n\nCargo powerpc64 and powerpc64le are seeing `SIGILL` crashes in openssl,\nwhich was found to be a linking problem, fixed by newer binutils. See\n<https://github.com/rust-lang/rust/issues/57345#issuecomment-462094555>\n\nFor powerpc64 we're using crosstool-ng, which doesn't offer a newer\nbinutils version, but we can just compile it separately. On powerpc64le\nwe're already building binutils. Both are now updated to binutils 2.32.\n\nCloses rust-lang/cargo#6320\nCloses rust-lang/rust#57345\nCloses rust-lang/rustup.rs#1620", "tree": {"sha": "5c45530de24bc7664e974011888d6490ab2eed95", "url": "https://api.github.com/repos/rust-lang/rust/git/trees/5c45530de24bc7664e974011888d6490ab2eed95"}, "url": "https://api.github.com/repos/rust-lang/rust/git/commits/3477939b798b64f135a09f1b8b54a0034ede3246", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/rust-lang/rust/commits/3477939b798b64f135a09f1b8b54a0034ede3246", "html_url": "https://github.com/rust-lang/rust/commit/3477939b798b64f135a09f1b8b54a0034ede3246", "comments_url": "https://api.github.com/repos/rust-lang/rust/commits/3477939b798b64f135a09f1b8b54a0034ede3246/comments", "author": {"login": "cuviper", "id": 36186, "node_id": "MDQ6VXNlcjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/36186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuviper", "html_url": "https://github.com/cuviper", "followers_url": "https://api.github.com/users/cuviper/followers", "following_url": "https://api.github.com/users/cuviper/following{/other_user}", "gists_url": "https://api.github.com/users/cuviper/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuviper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuviper/subscriptions", "organizations_url": "https://api.github.com/users/cuviper/orgs", "repos_url": "https://api.github.com/users/cuviper/repos", "events_url": "https://api.github.com/users/cuviper/events{/privacy}", "received_events_url": "https://api.github.com/users/cuviper/received_events", "type": "User", "site_admin": false}, "committer": {"login": "cuviper", "id": 36186, "node_id": "MDQ6VXNlcjM2MTg2", "avatar_url": "https://avatars.githubusercontent.com/u/36186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cuviper", "html_url": "https://github.com/cuviper", "followers_url": "https://api.github.com/users/cuviper/followers", "following_url": "https://api.github.com/users/cuviper/following{/other_user}", "gists_url": "https://api.github.com/users/cuviper/gists{/gist_id}", "starred_url": "https://api.github.com/users/cuviper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cuviper/subscriptions", "organizations_url": "https://api.github.com/users/cuviper/orgs", "repos_url": "https://api.github.com/users/cuviper/repos", "events_url": "https://api.github.com/users/cuviper/events{/privacy}", "received_events_url": "https://api.github.com/users/cuviper/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f22dca0a1bef4141e75326caacc3cd59f3d5be8e", "url": "https://api.github.com/repos/rust-lang/rust/commits/f22dca0a1bef4141e75326caacc3cd59f3d5be8e", "html_url": "https://github.com/rust-lang/rust/commit/f22dca0a1bef4141e75326caacc3cd59f3d5be8e"}], "stats": {"total": 21, "additions": 20, "deletions": 1}, "files": [{"sha": "a4431cbc0a16d18e5f163a4b9f57abbf852f35c6", "filename": "src/ci/docker/dist-powerpc64-linux/build-powerpc64-toolchain.sh", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/rust-lang/rust/blob/3477939b798b64f135a09f1b8b54a0034ede3246/src%2Fci%2Fdocker%2Fdist-powerpc64-linux%2Fbuild-powerpc64-toolchain.sh", "raw_url": "https://github.com/rust-lang/rust/raw/3477939b798b64f135a09f1b8b54a0034ede3246/src%2Fci%2Fdocker%2Fdist-powerpc64-linux%2Fbuild-powerpc64-toolchain.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-powerpc64-linux%2Fbuild-powerpc64-toolchain.sh?ref=3477939b798b64f135a09f1b8b54a0034ede3246", "patch": "@@ -3,9 +3,28 @@ set -ex\n \n source shared.sh\n \n+BINUTILS=2.32\n+TARGET=powerpc64-unknown-linux-gnu\n+PREFIX=/x-tools/$TARGET\n+SYSROOT=$PREFIX/$TARGET/sysroot\n+\n mkdir build\n cd build\n cp ../powerpc64-linux-gnu.config .config\n hide_output ct-ng build\n cd ..\n rm -rf build\n+\n+chmod -R u+w $PREFIX\n+\n+# Next, download and build newer binutils.\n+mkdir binutils-$TARGET\n+pushd binutils-$TARGET\n+curl https://ftp.gnu.org/gnu/binutils/binutils-$BINUTILS.tar.bz2 | tar xjf -\n+mkdir binutils-build\n+cd binutils-build\n+hide_output ../binutils-$BINUTILS/configure --target=$TARGET --prefix=$PREFIX --with-sysroot=$SYSROOT\n+hide_output make -j10\n+hide_output make install\n+popd\n+rm -rf binutils-$TARGET"}, {"sha": "f866a24287f9e6d9aed7b0758bd4ee258f37ee1c", "filename": "src/ci/docker/dist-powerpc64le-linux/build-powerpc64le-toolchain.sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/rust-lang/rust/blob/3477939b798b64f135a09f1b8b54a0034ede3246/src%2Fci%2Fdocker%2Fdist-powerpc64le-linux%2Fbuild-powerpc64le-toolchain.sh", "raw_url": "https://github.com/rust-lang/rust/raw/3477939b798b64f135a09f1b8b54a0034ede3246/src%2Fci%2Fdocker%2Fdist-powerpc64le-linux%2Fbuild-powerpc64le-toolchain.sh", "contents_url": "https://api.github.com/repos/rust-lang/rust/contents/src%2Fci%2Fdocker%2Fdist-powerpc64le-linux%2Fbuild-powerpc64le-toolchain.sh?ref=3477939b798b64f135a09f1b8b54a0034ede3246", "patch": "@@ -4,7 +4,7 @@ set -ex\n \n source shared.sh\n \n-BINUTILS=2.25.1\n+BINUTILS=2.32\n GCC=5.3.0\n TARGET=powerpc64le-linux-gnu\n SYSROOT=/usr/local/$TARGET/sysroot"}]}