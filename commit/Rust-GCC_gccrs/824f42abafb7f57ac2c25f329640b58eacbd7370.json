{"sha": "824f42abafb7f57ac2c25f329640b58eacbd7370", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODI0ZjQyYWJhZmI3ZjU3YWMyYzI1ZjMyOTY0MGI1OGVhY2JkNzM3MA==", "commit": {"author": {"name": "Per Bothner", "email": "bothner@gcc.gnu.org", "date": "1998-08-20T16:44:01Z"}, "committer": {"name": "Per Bothner", "email": "bothner@gcc.gnu.org", "date": "1998-08-20T16:44:01Z"}, "message": "Handle new'ing of Java classes.\n\n \n\tHandle new'ing of Java classes.\n\t* init.c (build_class_classref):  New function.\n\t(build_new_1):  If type is TYPE_FOR_JAVA:  Call _Jv_AllocObject;\n\tconstructor does not return this;  don't need to exception-protect.\n\t* pt.c (lookup_template_class):  Copy TYPE_FOR_JAVA flag.\n\t* decl2.c (acceptable_java_type):  Handle template-derived types.\n\nFrom-SVN: r21881", "tree": {"sha": "e9958d1dffda7ecf64ebef1ddf9f812af983e302", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e9958d1dffda7ecf64ebef1ddf9f812af983e302"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/824f42abafb7f57ac2c25f329640b58eacbd7370", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/824f42abafb7f57ac2c25f329640b58eacbd7370", "html_url": "https://github.com/Rust-GCC/gccrs/commit/824f42abafb7f57ac2c25f329640b58eacbd7370", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/824f42abafb7f57ac2c25f329640b58eacbd7370/comments", "author": null, "committer": null, "parents": [{"sha": "f668f16016466557738402723df012f81a588ae7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f668f16016466557738402723df012f81a588ae7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f668f16016466557738402723df012f81a588ae7"}], "stats": {"total": 18, "additions": 16, "deletions": 2}, "files": [{"sha": "8e1d0c791ed6aef96b9dc501b107f501526497f9", "filename": "gcc/cp/decl2.c", "status": "modified", "additions": 16, "deletions": 2, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/824f42abafb7f57ac2c25f329640b58eacbd7370/gcc%2Fcp%2Fdecl2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/824f42abafb7f57ac2c25f329640b58eacbd7370/gcc%2Fcp%2Fdecl2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl2.c?ref=824f42abafb7f57ac2c25f329640b58eacbd7370", "patch": "@@ -1403,8 +1403,22 @@ acceptable_java_type (type)\n       type = TREE_TYPE (type);\n       if (TREE_CODE (type) == RECORD_TYPE)\n \t{\n-\t  complete_type (type);\n-\t  return TYPE_FOR_JAVA (type);\n+\t  tree args;  int i;\n+\t  if (! TYPE_FOR_JAVA (type))\n+\t    return 0;\n+\t  if (! CLASSTYPE_TEMPLATE_INFO (type))\n+\t    return 1;\n+\t  args = CLASSTYPE_TI_ARGS (type);\n+\t  i = TREE_VEC_LENGTH (args);\n+\t  while (--i >= 0)\n+\t    {\n+\t      type = TREE_VEC_ELT (args, i);\n+\t      if (TREE_CODE (type) == POINTER_TYPE)\n+\t\ttype = TREE_TYPE (type);\n+\t      if (! TYPE_FOR_JAVA (type))\n+\t\treturn 0;\n+\t    }\n+\t  return 1;\n \t}\n     }\n   return 0;"}]}