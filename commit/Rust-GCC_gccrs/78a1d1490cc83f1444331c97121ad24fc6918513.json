{"sha": "78a1d1490cc83f1444331c97121ad24fc6918513", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzhhMWQxNDkwY2M4M2YxNDQ0MzMxYzk3MTIxYWQyNGZjNjkxODUxMw==", "commit": {"author": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2010-11-08T09:03:50Z"}, "committer": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2010-11-08T09:03:50Z"}, "message": "re PR fortran/46344 ([OOP] ICE with allocatable CLASS components)\n\n2010-11-08  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/46344\n\t* trans-types.c (gfc_copy_dt_decls_ifequal): Handle CLASS components.\n\n2010-11-08  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/46344\n\t* gfortran.dg/class_28.f03: New.\n\nFrom-SVN: r166430", "tree": {"sha": "2a7aa681cd656adfd69e781f5887991ff2d95d3c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2a7aa681cd656adfd69e781f5887991ff2d95d3c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/78a1d1490cc83f1444331c97121ad24fc6918513", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/78a1d1490cc83f1444331c97121ad24fc6918513", "html_url": "https://github.com/Rust-GCC/gccrs/commit/78a1d1490cc83f1444331c97121ad24fc6918513", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/78a1d1490cc83f1444331c97121ad24fc6918513/comments", "author": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "06f0c25f2509d20b1245697670108fc3f990cdac", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06f0c25f2509d20b1245697670108fc3f990cdac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/06f0c25f2509d20b1245697670108fc3f990cdac"}], "stats": {"total": 48, "additions": 45, "deletions": 3}, "files": [{"sha": "a513933c5a10278b7fd404a75d0b1bb048b747a4", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/78a1d1490cc83f1444331c97121ad24fc6918513/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/78a1d1490cc83f1444331c97121ad24fc6918513/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=78a1d1490cc83f1444331c97121ad24fc6918513", "patch": "@@ -1,3 +1,8 @@\n+2010-11-08  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/46344\n+\t* trans-types.c (gfc_copy_dt_decls_ifequal): Handle CLASS components.\n+\n 2010-11-06  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/46330"}, {"sha": "a597cd7239596336bfc0e46c149de3ec5e9eb60d", "filename": "gcc/fortran/trans-types.c", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/78a1d1490cc83f1444331c97121ad24fc6918513/gcc%2Ffortran%2Ftrans-types.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/78a1d1490cc83f1444331c97121ad24fc6918513/gcc%2Ffortran%2Ftrans-types.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-types.c?ref=78a1d1490cc83f1444331c97121ad24fc6918513", "patch": "@@ -1936,10 +1936,12 @@ gfc_copy_dt_decls_ifequal (gfc_symbol *from, gfc_symbol *to,\n   for (; to_cm; to_cm = to_cm->next, from_cm = from_cm->next)\n     {\n       to_cm->backend_decl = from_cm->backend_decl;\n-      if ((!from_cm->attr.pointer || from_gsym)\n-\t      && from_cm->ts.type == BT_DERIVED)\n+      if (from_cm->ts.type == BT_DERIVED\n+\t  && (!from_cm->attr.pointer || from_gsym))\n+\tgfc_get_derived_type (to_cm->ts.u.derived);\n+      else if (from_cm->ts.type == BT_CLASS\n+\t       && (!CLASS_DATA (from_cm)->attr.class_pointer || from_gsym))\n \tgfc_get_derived_type (to_cm->ts.u.derived);\n-\n       else if (from_cm->ts.type == BT_CHARACTER)\n \tto_cm->ts.u.cl->backend_decl = from_cm->ts.u.cl->backend_decl;\n     }"}, {"sha": "395d9879029b63beef54377ddf0efd1e5b1d41d9", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/78a1d1490cc83f1444331c97121ad24fc6918513/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/78a1d1490cc83f1444331c97121ad24fc6918513/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=78a1d1490cc83f1444331c97121ad24fc6918513", "patch": "@@ -1,3 +1,8 @@\n+2010-11-08  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/46344\n+\t* gfortran.dg/class_28.f03: New.\n+\n 2010-11-08  Andrey Belevantsev  <abel@ispras.ru>\n \n \tPR rtl-optimization/45352"}, {"sha": "cfd46a8eb6563af9ba2d9d3ee6f2db709f21a488", "filename": "gcc/testsuite/gfortran.dg/class_28.f03", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/78a1d1490cc83f1444331c97121ad24fc6918513/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_28.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/78a1d1490cc83f1444331c97121ad24fc6918513/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_28.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_28.f03?ref=78a1d1490cc83f1444331c97121ad24fc6918513", "patch": "@@ -0,0 +1,30 @@\n+! { dg-do compile }\n+!\n+! PR 46344: [4.6 Regression] [OOP] ICE with allocatable CLASS components\n+!\n+! Contributed by Salvatore Filippone <sfilippone@uniroma2.it>\n+\n+module m\n+\n+  type t1\n+  end type\n+\n+  type  t2\n+    class(t1), allocatable :: cc\n+  end type\n+\n+  class(t2), allocatable :: sm\n+\n+end module m\n+\n+program p\n+  use m\n+  implicit none\n+\n+  type(t2), allocatable :: x(:) \n+\n+  allocate(x(1))\n+\n+end program p\n+\n+! { dg-final { cleanup-modules \"m\" } }"}]}