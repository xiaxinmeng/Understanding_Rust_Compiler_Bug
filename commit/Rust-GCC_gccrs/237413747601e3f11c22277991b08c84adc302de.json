{"sha": "237413747601e3f11c22277991b08c84adc302de", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjM3NDEzNzQ3NjAxZTNmMTFjMjIyNzc5OTFiMDhjODRhZGMzMDJkZQ==", "commit": {"author": {"name": "Bernd Edlinger", "email": "bernd.edlinger@hotmail.de", "date": "2019-09-13T17:22:04Z"}, "committer": {"name": "Bernd Edlinger", "email": "edlinger@gcc.gnu.org", "date": "2019-09-13T17:22:04Z"}, "message": "re PR middle-end/91708 ([ARM] Bootstrap fails in gen_movsi, at config/arm/arm.md:5258)\n\n2019-09-13  Bernd Edlinger  <bernd.edlinger@hotmail.de>\n\n        PR middle-end/91708\n        * cse.c (cse_insn): Do not replace anything with a\n        MEM.\n\nFrom-SVN: r275701", "tree": {"sha": "17b3aee9ca71ac6401c419826374ce7febd9a069", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/17b3aee9ca71ac6401c419826374ce7febd9a069"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/237413747601e3f11c22277991b08c84adc302de", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/237413747601e3f11c22277991b08c84adc302de", "html_url": "https://github.com/Rust-GCC/gccrs/commit/237413747601e3f11c22277991b08c84adc302de", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/237413747601e3f11c22277991b08c84adc302de/comments", "author": {"login": "bernd-edlinger", "id": 17638929, "node_id": "MDQ6VXNlcjE3NjM4OTI5", "avatar_url": "https://avatars.githubusercontent.com/u/17638929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bernd-edlinger", "html_url": "https://github.com/bernd-edlinger", "followers_url": "https://api.github.com/users/bernd-edlinger/followers", "following_url": "https://api.github.com/users/bernd-edlinger/following{/other_user}", "gists_url": "https://api.github.com/users/bernd-edlinger/gists{/gist_id}", "starred_url": "https://api.github.com/users/bernd-edlinger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bernd-edlinger/subscriptions", "organizations_url": "https://api.github.com/users/bernd-edlinger/orgs", "repos_url": "https://api.github.com/users/bernd-edlinger/repos", "events_url": "https://api.github.com/users/bernd-edlinger/events{/privacy}", "received_events_url": "https://api.github.com/users/bernd-edlinger/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "57cccc860e501be56096a2863ae571175cb87960", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57cccc860e501be56096a2863ae571175cb87960", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57cccc860e501be56096a2863ae571175cb87960"}], "stats": {"total": 29, "additions": 12, "deletions": 17}, "files": [{"sha": "9bfc0e460a3183c029be5162159bcc99667ac12c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/237413747601e3f11c22277991b08c84adc302de/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/237413747601e3f11c22277991b08c84adc302de/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=237413747601e3f11c22277991b08c84adc302de", "patch": "@@ -1,3 +1,9 @@\n+2019-09-13  Bernd Edlinger  <bernd.edlinger@hotmail.de>\n+\n+\tPR middle-end/91708\n+\t* cse.c (cse_insn): Do not replace anything with a\n+\tMEM.\n+\n 2019-09-13  Ian Lance Taylor  <iant@golang.org>\n \n \t* doc/invoke.texi (Optimize Options): Fix typo."}, {"sha": "32b67902451ff1bc6a9c6845868f59b9ca79333b", "filename": "gcc/cse.c", "status": "modified", "additions": 6, "deletions": 17, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/237413747601e3f11c22277991b08c84adc302de/gcc%2Fcse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/237413747601e3f11c22277991b08c84adc302de/gcc%2Fcse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcse.c?ref=237413747601e3f11c22277991b08c84adc302de", "patch": "@@ -5238,23 +5238,6 @@ cse_insn (rtx_insn *insn)\n \t      src_elt_cost = MAX_COST;\n \t    }\n \n-\t  /* Avoid creation of overlapping memory moves.  */\n-\t  if (MEM_P (trial) && MEM_P (dest) && !rtx_equal_p (trial, dest))\n-\t    {\n-\t      rtx src, dest;\n-\n-\t      /* BLKmode moves are not handled by cse anyway.  */\n-\t      if (GET_MODE (trial) == BLKmode)\n-\t\tbreak;\n-\n-\t      src = canon_rtx (trial);\n-\t      dest = canon_rtx (SET_DEST (sets[i].rtl));\n-\n-\t      if (!MEM_P (src) || !MEM_P (dest)\n-\t\t  || !nonoverlapping_memrefs_p (src, dest, false))\n-\t\tbreak;\n-\t    }\n-\n \t  /* Try to optimize\n \t     (set (reg:M N) (const_int A))\n \t     (set (reg:M2 O) (const_int B))\n@@ -5385,6 +5368,12 @@ cse_insn (rtx_insn *insn)\n \t    /* Do nothing for this case.  */\n \t    ;\n \n+\t  /* Do not replace anything with a MEM, except the replacement\n+\t     is a no-op.  This allows this loop to terminate.  */\n+\t  else if (MEM_P (trial) && !rtx_equal_p (trial, SET_SRC(sets[i].rtl)))\n+\t    /* Do nothing for this case.  */\n+\t    ;\n+\n \t  /* Look for a substitution that makes a valid insn.  */\n \t  else if (validate_unshare_change (insn, &SET_SRC (sets[i].rtl),\n \t\t\t\t\t    trial, 0))"}]}