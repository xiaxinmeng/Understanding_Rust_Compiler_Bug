{"sha": "88d8c771f98c83763f2ee41e5046417795a97eac", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODhkOGM3NzFmOThjODM3NjNmMmVlNDFlNTA0NjQxNzc5NWE5N2VhYw==", "commit": {"author": {"name": "Anthony Green", "email": "green@redhat.com", "date": "2004-08-30T15:43:03Z"}, "committer": {"name": "Anthony Green", "email": "green@gcc.gnu.org", "date": "2004-08-30T15:43:03Z"}, "message": "Makefile.am: Add frv support.\n\n2004-08-30  Anthony Green  <green@redhat.com>\n\n        * Makefile.am: Add frv support.\n        * Makefile.in, testsuite/Makefile.in: Rebuilt.\n        * configure.ac: Read configure.host.\n        * configure, aclocal.m4: Rebuilt.\n        * configure.host: New file.  frv-elf needs libgloss.\n        * include/ffi.h.in: Force ffi_closure to have a nice big (8)\n        alignment.  This is needed to frv and should harm the others.\n        * include/ffi_common.h (ALIGN_DOWN): New macro.\n        * src/frv/ffi.c, src/frv/ffitarget.h, src/frv/eabi.S: New files.\n\nFrom-SVN: r86779", "tree": {"sha": "a36cbe1ac1d0a30e257ceffcce0d0b8b21e90faa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a36cbe1ac1d0a30e257ceffcce0d0b8b21e90faa"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/88d8c771f98c83763f2ee41e5046417795a97eac", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88d8c771f98c83763f2ee41e5046417795a97eac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/88d8c771f98c83763f2ee41e5046417795a97eac", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88d8c771f98c83763f2ee41e5046417795a97eac/comments", "author": {"login": "atgreen", "id": 89993, "node_id": "MDQ6VXNlcjg5OTkz", "avatar_url": "https://avatars.githubusercontent.com/u/89993?v=4", "gravatar_id": "", "url": "https://api.github.com/users/atgreen", "html_url": "https://github.com/atgreen", "followers_url": "https://api.github.com/users/atgreen/followers", "following_url": "https://api.github.com/users/atgreen/following{/other_user}", "gists_url": "https://api.github.com/users/atgreen/gists{/gist_id}", "starred_url": "https://api.github.com/users/atgreen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/atgreen/subscriptions", "organizations_url": "https://api.github.com/users/atgreen/orgs", "repos_url": "https://api.github.com/users/atgreen/repos", "events_url": "https://api.github.com/users/atgreen/events{/privacy}", "received_events_url": "https://api.github.com/users/atgreen/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8dc2b10365a3d9def1a6e0412db0cc0177cfad6d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8dc2b10365a3d9def1a6e0412db0cc0177cfad6d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8dc2b10365a3d9def1a6e0412db0cc0177cfad6d"}], "stats": {"total": 782, "additions": 693, "deletions": 89}, "files": [{"sha": "fd2c704c57cb4ea6723c5b306ad43f90dbf3a264", "filename": "libffi/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FChangeLog?ref=88d8c771f98c83763f2ee41e5046417795a97eac", "patch": "@@ -1,3 +1,15 @@\n+2004-08-30  Anthony Green  <green@redhat.com>\n+\n+\t* Makefile.am: Add frv support.\n+\t* Makefile.in, testsuite/Makefile.in: Rebuilt.\n+\t* configure.ac: Read configure.host.\n+\t* configure.in: Read configure.host.\n+\t* configure.host: New file.  frv-elf needs libgloss.\n+\t* include/ffi.h.in: Force ffi_closure to have a nice big (8)\n+\talignment.  This is needed to frv and should harm the others.\n+\t* include/ffi_common.h (ALIGN_DOWN): New macro.\n+\t* src/frv/ffi.c, src/frv/ffitarget.h, src/frv/eabi.S: New files.\n+\n 2004-08-24  David Daney  <daney@avtrex.com>\n \n \t* testsuite/libffi.call/closure_fn0.c: Xfail mips64* instead of mips*."}, {"sha": "6195d89859aed98855b7d20cbd006c547077e5c8", "filename": "libffi/Makefile.am", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FMakefile.am?ref=88d8c771f98c83763f2ee41e5046417795a97eac", "patch": "@@ -23,7 +23,7 @@ EXTRA_DIST = LICENSE ChangeLog.v1 \\\n \tsrc/sparc/ffi.c \\\n \tsrc/x86/ffi.c src/x86/sysv.S src/x86/win32.S \\\n \tsrc/x86/ffi64.c src/x86/unix64.S src/x86/ffitarget.h \\\n-\tsrc/pa/ffi.c src/pa/linux.S\n+\tsrc/pa/ffi.c src/pa/linux.S src/frv/eabi.S src/frv/ffitarget.h\n \n ## ################################################################\n \n@@ -116,6 +116,9 @@ endif\n if ARM\n nodist_libffi_la_SOURCES += src/arm/sysv.S src/arm/ffi.c\n endif\n+if FRV\n+nodist_libffi_la_SOURCES += src/frv/eabi.S src/frv/ffi.c\n+endif\n if S390\n nodist_libffi_la_SOURCES += src/s390/sysv.S src/s390/ffi.c\n endif"}, {"sha": "e1de967e3e16ef59c9b8444be0dbcc7bd776c7c4", "filename": "libffi/Makefile.in", "status": "modified", "additions": 64, "deletions": 34, "changes": 98, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FMakefile.in?ref=88d8c771f98c83763f2ee41e5046417795a97eac", "patch": "@@ -1,4 +1,4 @@\n-# Makefile.in generated by automake 1.8.5 from Makefile.am.\n+# Makefile.in generated by automake 1.8.3 from Makefile.am.\n # @configure_input@\n \n # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,\n@@ -51,11 +51,12 @@ target_triplet = @target@\n @POWERPC_AIX_TRUE@am__append_10 = src/powerpc/ffi_darwin.c src/powerpc/aix.S src/powerpc/aix_closure.S\n @POWERPC_DARWIN_TRUE@am__append_11 = src/powerpc/ffi_darwin.c src/powerpc/darwin.S src/powerpc/darwin_closure.S\n @ARM_TRUE@am__append_12 = src/arm/sysv.S src/arm/ffi.c\n-@S390_TRUE@am__append_13 = src/s390/sysv.S src/s390/ffi.c\n-@X86_64_TRUE@am__append_14 = src/x86/ffi64.c src/x86/unix64.S src/x86/ffi.c src/x86/sysv.S\n-@SH_TRUE@am__append_15 = src/sh/sysv.S src/sh/ffi.c\n-@SH64_TRUE@am__append_16 = src/sh64/sysv.S src/sh64/ffi.c\n-@PA_TRUE@am__append_17 = src/pa/linux.S src/pa/ffi.c\n+@FRV_TRUE@am__append_13 = src/frv/eabi.S src/frv/ffi.c\n+@S390_TRUE@am__append_14 = src/s390/sysv.S src/s390/ffi.c\n+@X86_64_TRUE@am__append_15 = src/x86/ffi64.c src/x86/unix64.S src/x86/ffi.c src/x86/sysv.S\n+@SH_TRUE@am__append_16 = src/sh/sysv.S src/sh/ffi.c\n+@SH64_TRUE@am__append_17 = src/sh64/sysv.S src/sh64/ffi.c\n+@PA_TRUE@am__append_18 = src/pa/linux.S src/pa/ffi.c\n DIST_COMMON = README $(am__configure_deps) $(srcdir)/../compile \\\n \t$(srcdir)/../config.guess $(srcdir)/../config.sub \\\n \t$(srcdir)/../install-sh $(srcdir)/../ltmain.sh \\\n@@ -102,31 +103,33 @@ am_libffi_la_OBJECTS = src/debug.lo src/prep_cif.lo src/types.lo \\\n @POWERPC_DARWIN_TRUE@\tsrc/powerpc/darwin.lo \\\n @POWERPC_DARWIN_TRUE@\tsrc/powerpc/darwin_closure.lo\n @ARM_TRUE@am__objects_12 = src/arm/sysv.lo src/arm/ffi.lo\n-@S390_TRUE@am__objects_13 = src/s390/sysv.lo src/s390/ffi.lo\n-@X86_64_TRUE@am__objects_14 = src/x86/ffi64.lo src/x86/unix64.lo \\\n+@FRV_TRUE@am__objects_13 = src/frv/eabi.lo src/frv/ffi.lo\n+@S390_TRUE@am__objects_14 = src/s390/sysv.lo src/s390/ffi.lo\n+@X86_64_TRUE@am__objects_15 = src/x86/ffi64.lo src/x86/unix64.lo \\\n @X86_64_TRUE@\tsrc/x86/ffi.lo src/x86/sysv.lo\n-@SH_TRUE@am__objects_15 = src/sh/sysv.lo src/sh/ffi.lo\n-@SH64_TRUE@am__objects_16 = src/sh64/sysv.lo src/sh64/ffi.lo\n-@PA_TRUE@am__objects_17 = src/pa/linux.lo src/pa/ffi.lo\n+@SH_TRUE@am__objects_16 = src/sh/sysv.lo src/sh/ffi.lo\n+@SH64_TRUE@am__objects_17 = src/sh64/sysv.lo src/sh64/ffi.lo\n+@PA_TRUE@am__objects_18 = src/pa/linux.lo src/pa/ffi.lo\n nodist_libffi_la_OBJECTS = $(am__objects_1) $(am__objects_2) \\\n \t$(am__objects_3) $(am__objects_4) $(am__objects_5) \\\n \t$(am__objects_6) $(am__objects_7) $(am__objects_8) \\\n \t$(am__objects_9) $(am__objects_10) $(am__objects_11) \\\n \t$(am__objects_12) $(am__objects_13) $(am__objects_14) \\\n-\t$(am__objects_15) $(am__objects_16) $(am__objects_17)\n+\t$(am__objects_15) $(am__objects_16) $(am__objects_17) \\\n+\t$(am__objects_18)\n libffi_la_OBJECTS = $(am_libffi_la_OBJECTS) \\\n \t$(nodist_libffi_la_OBJECTS)\n libffi_convenience_la_LIBADD =\n-am__objects_18 = src/debug.lo src/prep_cif.lo src/types.lo \\\n+am__objects_19 = src/debug.lo src/prep_cif.lo src/types.lo \\\n \tsrc/raw_api.lo src/java_raw_api.lo\n-am_libffi_convenience_la_OBJECTS = $(am__objects_18)\n-am__objects_19 = $(am__objects_1) $(am__objects_2) $(am__objects_3) \\\n+am_libffi_convenience_la_OBJECTS = $(am__objects_19)\n+am__objects_20 = $(am__objects_1) $(am__objects_2) $(am__objects_3) \\\n \t$(am__objects_4) $(am__objects_5) $(am__objects_6) \\\n \t$(am__objects_7) $(am__objects_8) $(am__objects_9) \\\n \t$(am__objects_10) $(am__objects_11) $(am__objects_12) \\\n \t$(am__objects_13) $(am__objects_14) $(am__objects_15) \\\n-\t$(am__objects_16) $(am__objects_17)\n-nodist_libffi_convenience_la_OBJECTS = $(am__objects_19)\n+\t$(am__objects_16) $(am__objects_17) $(am__objects_18)\n+nodist_libffi_convenience_la_OBJECTS = $(am__objects_20)\n libffi_convenience_la_OBJECTS = $(am_libffi_convenience_la_OBJECTS) \\\n \t$(nodist_libffi_convenience_la_OBJECTS)\n DEFAULT_INCLUDES = -I. -I$(srcdir) -I.\n@@ -202,6 +205,8 @@ ECHO_N = @ECHO_N@\n ECHO_T = @ECHO_T@\n EGREP = @EGREP@\n EXEEXT = @EXEEXT@\n+FRV_FALSE = @FRV_FALSE@\n+FRV_TRUE = @FRV_TRUE@\n HAVE_LONG_DOUBLE = @HAVE_LONG_DOUBLE@\n IA64_FALSE = @IA64_FALSE@\n IA64_TRUE = @IA64_TRUE@\n@@ -329,7 +334,7 @@ EXTRA_DIST = LICENSE ChangeLog.v1 \\\n \tsrc/sparc/ffi.c \\\n \tsrc/x86/ffi.c src/x86/sysv.S src/x86/win32.S \\\n \tsrc/x86/ffi64.c src/x86/unix64.S src/x86/ffitarget.h \\\n-\tsrc/pa/ffi.c src/pa/linux.S\n+\tsrc/pa/ffi.c src/pa/linux.S src/frv/eabi.S src/frv/ffitarget.h\n \n \n # Work around what appears to be a GNU make bug handling MAKEFLAGS\n@@ -377,13 +382,13 @@ noinst_LTLIBRARIES = libffi_convenience.la\n libffi_la_SOURCES = src/debug.c src/prep_cif.c src/types.c \\\n \t\tsrc/raw_api.c src/java_raw_api.c\n \n-nodist_libffi_la_SOURCES = $(am__append_1) $(am__append_2) $(am__append_3) $(am__append_4) $(am__append_5) $(am__append_6) $(am__append_7) $(am__append_8) $(am__append_9) $(am__append_10) $(am__append_11) $(am__append_12) $(am__append_13) $(am__append_14) $(am__append_15) $(am__append_16) $(am__append_17)\n+nodist_libffi_la_SOURCES = $(am__append_1) $(am__append_2) $(am__append_3) $(am__append_4) $(am__append_5) $(am__append_6) $(am__append_7) $(am__append_8) $(am__append_9) $(am__append_10) $(am__append_11) $(am__append_12) $(am__append_13) $(am__append_14) $(am__append_15) $(am__append_16) $(am__append_17) $(am__append_18)\n libffi_convenience_la_SOURCES = $(libffi_la_SOURCES)\n nodist_libffi_convenience_la_SOURCES = $(nodist_libffi_la_SOURCES)\n AM_CFLAGS = -Wall -g -fexceptions\n libffi_la_LDFLAGS = -version-info `grep -v '^\\#' $(srcdir)/libtool-version`\n-INCLUDES = -I. -I$(top_srcdir)/include -Iinclude -I$(top_srcdir)/src\n-AM_CCASFLAGS = $(INCLUDES)\n+AM_CPPFLAGS = -I. -I$(top_srcdir)/include -Iinclude -I$(top_srcdir)/src\n+AM_CCASFLAGS = $(AM_CPPFLAGS)\n all: fficonfig.h\n \t$(MAKE) $(AM_MAKEFLAGS) all-recursive\n \n@@ -444,7 +449,7 @@ clean-noinstLTLIBRARIES:\n \t-test -z \"$(noinst_LTLIBRARIES)\" || rm -f $(noinst_LTLIBRARIES)\n \t@list='$(noinst_LTLIBRARIES)'; for p in $$list; do \\\n \t  dir=\"`echo $$p | sed -e 's|/[^/]*$$||'`\"; \\\n-\t  test \"$$dir\" != \"$$p\" || dir=.; \\\n+\t  test \"$$dir\" = \"$$p\" && dir=.; \\\n \t  echo \"rm -f \\\"$${dir}/so_locations\\\"\"; \\\n \t  rm -f \"$${dir}/so_locations\"; \\\n \tdone\n@@ -471,7 +476,7 @@ clean-toolexeclibLTLIBRARIES:\n \t-test -z \"$(toolexeclib_LTLIBRARIES)\" || rm -f $(toolexeclib_LTLIBRARIES)\n \t@list='$(toolexeclib_LTLIBRARIES)'; for p in $$list; do \\\n \t  dir=\"`echo $$p | sed -e 's|/[^/]*$$||'`\"; \\\n-\t  test \"$$dir\" != \"$$p\" || dir=.; \\\n+\t  test \"$$dir\" = \"$$p\" && dir=.; \\\n \t  echo \"rm -f \\\"$${dir}/so_locations\\\"\"; \\\n \t  rm -f \"$${dir}/so_locations\"; \\\n \tdone\n@@ -534,6 +539,11 @@ src/arm/$(am__dirstamp):\n \t@: > src/arm/$(am__dirstamp)\n src/arm/sysv.lo: src/arm/$(am__dirstamp)\n src/arm/ffi.lo: src/arm/$(am__dirstamp)\n+src/frv/$(am__dirstamp):\n+\t@$(mkdir_p) src/frv\n+\t@: > src/frv/$(am__dirstamp)\n+src/frv/eabi.lo: src/frv/$(am__dirstamp)\n+src/frv/ffi.lo: src/frv/$(am__dirstamp)\n src/s390/$(am__dirstamp):\n \t@$(mkdir_p) src/s390\n \t@: > src/s390/$(am__dirstamp)\n@@ -573,6 +583,10 @@ mostlyclean-compile:\n \t-rm -f src/arm/sysv.lo\n \t-rm -f src/debug.$(OBJEXT)\n \t-rm -f src/debug.lo\n+\t-rm -f src/frv/eabi.$(OBJEXT)\n+\t-rm -f src/frv/eabi.lo\n+\t-rm -f src/frv/ffi.$(OBJEXT)\n+\t-rm -f src/frv/ffi.lo\n \t-rm -f src/ia64/ffi.$(OBJEXT)\n \t-rm -f src/ia64/ffi.lo\n \t-rm -f src/ia64/unix.$(OBJEXT)\n@@ -822,6 +836,15 @@ src/arm/sysv.obj: src/arm/sysv.S\n src/arm/sysv.lo: src/arm/sysv.S\n \t$(LIBTOOL) --mode=compile $(CCAS) $(AM_CCASFLAGS) $(CCASFLAGS) -c -o src/arm/sysv.lo `test -f 'src/arm/sysv.S' || echo '$(srcdir)/'`src/arm/sysv.S\n \n+src/frv/eabi.o: src/frv/eabi.S\n+\t$(CCAS) $(AM_CCASFLAGS) $(CCASFLAGS) -c -o src/frv/eabi.o `test -f 'src/frv/eabi.S' || echo '$(srcdir)/'`src/frv/eabi.S\n+\n+src/frv/eabi.obj: src/frv/eabi.S\n+\t$(CCAS) $(AM_CCASFLAGS) $(CCASFLAGS) -c -o src/frv/eabi.obj `if test -f 'src/frv/eabi.S'; then $(CYGPATH_W) 'src/frv/eabi.S'; else $(CYGPATH_W) '$(srcdir)/src/frv/eabi.S'; fi`\n+\n+src/frv/eabi.lo: src/frv/eabi.S\n+\t$(LIBTOOL) --mode=compile $(CCAS) $(AM_CCASFLAGS) $(CCASFLAGS) -c -o src/frv/eabi.lo `test -f 'src/frv/eabi.S' || echo '$(srcdir)/'`src/frv/eabi.S\n+\n src/s390/sysv.o: src/s390/sysv.S\n \t$(CCAS) $(AM_CCASFLAGS) $(CCASFLAGS) -c -o src/s390/sysv.o `test -f 'src/s390/sysv.S' || echo '$(srcdir)/'`src/s390/sysv.S\n \n@@ -1002,6 +1025,15 @@ src/arm/ffi.obj: src/arm/ffi.c\n src/arm/ffi.lo: src/arm/ffi.c\n \t$(LIBTOOL) --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o src/arm/ffi.lo `test -f 'src/arm/ffi.c' || echo '$(srcdir)/'`src/arm/ffi.c\n \n+src/frv/ffi.o: src/frv/ffi.c\n+\t$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o src/frv/ffi.o `test -f 'src/frv/ffi.c' || echo '$(srcdir)/'`src/frv/ffi.c\n+\n+src/frv/ffi.obj: src/frv/ffi.c\n+\t$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o src/frv/ffi.obj `if test -f 'src/frv/ffi.c'; then $(CYGPATH_W) 'src/frv/ffi.c'; else $(CYGPATH_W) '$(srcdir)/src/frv/ffi.c'; fi`\n+\n+src/frv/ffi.lo: src/frv/ffi.c\n+\t$(LIBTOOL) --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o src/frv/ffi.lo `test -f 'src/frv/ffi.c' || echo '$(srcdir)/'`src/frv/ffi.c\n+\n src/s390/ffi.o: src/s390/ffi.c\n \t$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) -c -o src/s390/ffi.o `test -f 'src/s390/ffi.c' || echo '$(srcdir)/'`src/s390/ffi.c\n \n@@ -1055,6 +1087,7 @@ clean-libtool:\n \t-rm -rf src/.libs src/_libs\n \t-rm -rf src/alpha/.libs src/alpha/_libs\n \t-rm -rf src/arm/.libs src/arm/_libs\n+\t-rm -rf src/frv/.libs src/frv/_libs\n \t-rm -rf src/ia64/.libs src/ia64/_libs\n \t-rm -rf src/m68k/.libs src/m68k/_libs\n \t-rm -rf src/mips/.libs src/mips/_libs\n@@ -1157,16 +1190,14 @@ TAGS: tags-recursive $(HEADERS) $(SOURCES) fficonfig.h.in $(TAGS_DEPENDENCIES) \\\n \t\t$(TAGS_FILES) $(LISP)\n \ttags=; \\\n \there=`pwd`; \\\n-\tif ($(ETAGS) --etags-include --version) >/dev/null 2>&1; then \\\n+\tif (etags --etags-include --version) >/dev/null 2>&1; then \\\n \t  include_option=--etags-include; \\\n-\t  empty_fix=.; \\\n \telse \\\n \t  include_option=--include; \\\n-\t  empty_fix=; \\\n \tfi; \\\n \tlist='$(SUBDIRS)'; for subdir in $$list; do \\\n \t  if test \"$$subdir\" = .; then :; else \\\n-\t    test ! -f $$subdir/TAGS || \\\n+\t    test -f $$subdir/TAGS && \\\n \t      tags=\"$$tags $$include_option=$$here/$$subdir/TAGS\"; \\\n \t  fi; \\\n \tdone; \\\n@@ -1176,11 +1207,9 @@ TAGS: tags-recursive $(HEADERS) $(SOURCES) fficonfig.h.in $(TAGS_DEPENDENCIES) \\\n \t  done | \\\n \t  $(AWK) '    { files[$$0] = 1; } \\\n \t       END { for (i in files) print i; }'`; \\\n-\tif test -z \"$(ETAGS_ARGS)$$tags$$unique\"; then :; else \\\n-\t  test -n \"$$unique\" || unique=$$empty_fix; \\\n-\t  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \\\n-\t    $$tags $$unique; \\\n-\tfi\n+\ttest -z \"$(ETAGS_ARGS)$$tags$$unique\" \\\n+\t  || $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \\\n+\t     $$tags $$unique\n ctags: CTAGS\n CTAGS: ctags-recursive $(HEADERS) $(SOURCES) fficonfig.h.in $(TAGS_DEPENDENCIES) \\\n \t\t$(TAGS_FILES) $(LISP)\n@@ -1207,7 +1236,7 @@ distclean-tags:\n distdir: $(DISTFILES)\n \t$(am__remove_distdir)\n \tmkdir $(distdir)\n-\t$(mkdir_p) $(distdir)/.. $(distdir)/../config $(distdir)/include $(distdir)/src/alpha $(distdir)/src/arm $(distdir)/src/m68k $(distdir)/src/mips $(distdir)/src/pa $(distdir)/src/powerpc $(distdir)/src/s390 $(distdir)/src/sh $(distdir)/src/sh64 $(distdir)/src/sparc $(distdir)/src/x86\n+\t$(mkdir_p) $(distdir)/.. $(distdir)/../config $(distdir)/include $(distdir)/src/alpha $(distdir)/src/arm $(distdir)/src/frv $(distdir)/src/m68k $(distdir)/src/mips $(distdir)/src/pa $(distdir)/src/powerpc $(distdir)/src/s390 $(distdir)/src/sh $(distdir)/src/sh64 $(distdir)/src/sparc $(distdir)/src/x86\n \t@srcdirstrip=`echo \"$(srcdir)\" | sed 's|.|.|g'`; \\\n \ttopsrcdirstrip=`echo \"$(top_srcdir)\" | sed 's|.|.|g'`; \\\n \tlist='$(DISTFILES)'; for file in $$list; do \\\n@@ -1289,7 +1318,7 @@ distcheck: dist\n \t*.tar.Z*) \\\n \t  uncompress -c $(distdir).tar.Z | $(AMTAR) xf - ;;\\\n \t*.shar.gz*) \\\n-\t  GZIP=$(GZIP_ENV) gunzip -c $(distdir).shar.gz | unshar ;;\\\n+\t  GZIP=$(GZIP_ENV) gunzip -c $(distdir).tar.gz | unshar ;;\\\n \t*.zip*) \\\n \t  unzip $(distdir).zip ;;\\\n \tesac\n@@ -1375,6 +1404,7 @@ distclean-generic:\n \t-rm -f src/s390/$(am__dirstamp)\n \t-rm -f src/arm/$(am__dirstamp)\n \t-rm -f src/mips/$(am__dirstamp)\n+\t-rm -f src/frv/$(am__dirstamp)\n \t-rm -f src/powerpc/$(am__dirstamp)\n \t-rm -f src/sh/$(am__dirstamp)\n \t-rm -f src/m68k/$(am__dirstamp)"}, {"sha": "ab4855b2ec777845f601119fb73a06248cddc874", "filename": "libffi/aclocal.m4", "status": "modified", "additions": 5, "deletions": 10, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Faclocal.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Faclocal.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Faclocal.m4?ref=88d8c771f98c83763f2ee41e5046417795a97eac", "patch": "@@ -1,4 +1,4 @@\n-# generated automatically by aclocal 1.8.5 -*- Autoconf -*-\n+# generated automatically by aclocal 1.8.3 -*- Autoconf -*-\n \n # Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004\n # Free Software Foundation, Inc.\n@@ -40,7 +40,7 @@ AC_DEFUN([AM_AUTOMAKE_VERSION], [am__api_version=\"1.8\"])\n # Call AM_AUTOMAKE_VERSION so it can be traced.\n # This function is AC_REQUIREd by AC_INIT_AUTOMAKE.\n AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],\n-\t [AM_AUTOMAKE_VERSION([1.8.5])])\n+\t [AM_AUTOMAKE_VERSION([1.8.3])])\n \n # Figure out how to run the assembler.             -*- Autoconf -*-\n \n@@ -298,14 +298,9 @@ AC_CACHE_CHECK([dependency style of $depcc],\n        grep sub/conftest.${OBJEXT-o} sub/conftest.Po > /dev/null 2>&1 &&\n        ${MAKE-make} -s -f confmf > /dev/null 2>&1; then\n       # icc doesn't choke on unknown options, it will just issue warnings\n-      # or remarks (even with -Werror).  So we grep stderr for any message\n-      # that says an option was ignored or not supported.\n-      # When given -MP, icc 7.0 and 7.1 complain thusly:\n-      #   icc: Command line warning: ignoring option '-M'; no argument required\n-      # The diagnosis changed in icc 8.0:\n-      #   icc: Command line remark: option '-MP' not supported\n-      if (grep 'ignoring option' conftest.err ||\n-          grep 'not supported' conftest.err) >/dev/null 2>&1; then :; else\n+      # (even with -Werror).  So we grep stderr for any message\n+      # that says an option was ignored.\n+      if grep 'ignoring option' conftest.err >/dev/null 2>&1; then :; else\n         am_cv_$1_dependencies_compiler_type=$depmode\n         break\n       fi"}, {"sha": "d806da0aff090bf0aa5407421fce73dab8aa09a9", "filename": "libffi/configure", "status": "modified", "additions": 83, "deletions": 42, "changes": 125, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fconfigure?ref=88d8c771f98c83763f2ee41e5046417795a97eac", "patch": "@@ -310,7 +310,7 @@ ac_includes_default=\"\\\n # include <unistd.h>\n #endif\"\n \n-ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS multi_basedir build build_cpu build_vendor build_os host host_cpu host_vendor host_os target target_cpu target_vendor target_os INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO AMTAR install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM mkdir_p AWK SET_MAKE am__leading_dot CC ac_ct_CC EXEEXT OBJEXT DEPDIR am__include am__quote AMDEP_TRUE AMDEP_FALSE AMDEPBACKSLASH CCDEPMODE am__fastdepCC_TRUE am__fastdepCC_FALSE CFLAGS CCAS CCASFLAGS LN_S RANLIB ac_ct_RANLIB LIBTOOL MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE MAINT CPP CPPFLAGS EGREP TESTSUBDIR_TRUE TESTSUBDIR_FALSE AM_RUNTESTFLAGS MIPS_IRIX_TRUE MIPS_IRIX_FALSE MIPS_LINUX_TRUE MIPS_LINUX_FALSE SPARC_TRUE SPARC_FALSE X86_TRUE X86_FALSE X86_WIN32_TRUE X86_WIN32_FALSE ALPHA_TRUE ALPHA_FALSE IA64_TRUE IA64_FALSE M68K_TRUE M68K_FALSE POWERPC_TRUE POWERPC_FALSE POWERPC_AIX_TRUE POWERPC_AIX_FALSE POWERPC_DARWIN_TRUE POWERPC_DARWIN_FALSE ARM_TRUE ARM_FALSE S390_TRUE S390_FALSE X86_64_TRUE X86_64_FALSE SH_TRUE SH_FALSE SH64_TRUE SH64_FALSE PA_TRUE PA_FALSE ALLOCA HAVE_LONG_DOUBLE TARGET TARGETDIR toolexecdir toolexeclibdir tool_include_dir gcc_version LIBOBJS LTLIBOBJS'\n+ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS multi_basedir build build_cpu build_vendor build_os host host_cpu host_vendor host_os target target_cpu target_vendor target_os INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO AMTAR install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM mkdir_p AWK SET_MAKE am__leading_dot CC ac_ct_CC EXEEXT OBJEXT DEPDIR am__include am__quote AMDEP_TRUE AMDEP_FALSE AMDEPBACKSLASH CCDEPMODE am__fastdepCC_TRUE am__fastdepCC_FALSE CFLAGS CCAS CCASFLAGS LN_S RANLIB ac_ct_RANLIB LIBTOOL MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE MAINT CPP CPPFLAGS EGREP TESTSUBDIR_TRUE TESTSUBDIR_FALSE AM_RUNTESTFLAGS MIPS_IRIX_TRUE MIPS_IRIX_FALSE MIPS_LINUX_TRUE MIPS_LINUX_FALSE SPARC_TRUE SPARC_FALSE X86_TRUE X86_FALSE X86_WIN32_TRUE X86_WIN32_FALSE ALPHA_TRUE ALPHA_FALSE IA64_TRUE IA64_FALSE M68K_TRUE M68K_FALSE POWERPC_TRUE POWERPC_FALSE POWERPC_AIX_TRUE POWERPC_AIX_FALSE POWERPC_DARWIN_TRUE POWERPC_DARWIN_FALSE ARM_TRUE ARM_FALSE FRV_TRUE FRV_FALSE S390_TRUE S390_FALSE X86_64_TRUE X86_64_FALSE SH_TRUE SH_FALSE SH64_TRUE SH64_FALSE PA_TRUE PA_FALSE ALLOCA HAVE_LONG_DOUBLE TARGET TARGETDIR toolexecdir toolexeclibdir tool_include_dir gcc_version LIBOBJS LTLIBOBJS'\n ac_subst_files=''\n \n # Initialize some variables set by options.\n@@ -972,7 +972,7 @@ esac\n     else\n       echo \"$as_me: WARNING: no configuration information is in $ac_dir\" >&2\n     fi\n-    cd \"$ac_popdir\"\n+    cd $ac_popdir\n   done\n fi\n \n@@ -1474,6 +1474,8 @@ test -n \"$target_alias\" &&\n   program_prefix=${target_alias}-\n target_alias=${target_alias-$host_alias}\n \n+. ${srcdir}/configure.host\n+\n am__api_version=\"1.8\"\n # Find a good install program.  We prefer a C program (faster),\n # so one script is as good as another.  But avoid the broken or\n@@ -2450,7 +2452,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2508,7 +2511,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2624,7 +2628,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2678,7 +2683,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2723,7 +2729,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2767,7 +2774,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2942,14 +2950,9 @@ else\n        grep sub/conftest.${OBJEXT-o} sub/conftest.Po > /dev/null 2>&1 &&\n        ${MAKE-make} -s -f confmf > /dev/null 2>&1; then\n       # icc doesn't choke on unknown options, it will just issue warnings\n-      # or remarks (even with -Werror).  So we grep stderr for any message\n-      # that says an option was ignored or not supported.\n-      # When given -MP, icc 7.0 and 7.1 complain thusly:\n-      #   icc: Command line warning: ignoring option '-M'; no argument required\n-      # The diagnosis changed in icc 8.0:\n-      #   icc: Command line remark: option '-MP' not supported\n-      if (grep 'ignoring option' conftest.err ||\n-          grep 'not supported' conftest.err) >/dev/null 2>&1; then :; else\n+      # (even with -Werror).  So we grep stderr for any message\n+      # that says an option was ignored.\n+      if grep 'ignoring option' conftest.err >/dev/null 2>&1; then :; else\n         am_cv_CC_dependencies_compiler_type=$depmode\n         break\n       fi\n@@ -3836,7 +3839,7 @@ test x\"$pic_mode\" = xno && libtool_flags=\"$libtool_flags --prefer-non-pic\"\n case $host in\n *-*-irix6*)\n   # Find out which ABI we are using.\n-  echo '#line 3839 \"configure\"' > conftest.$ac_ext\n+  echo '#line 3842 \"configure\"' > conftest.$ac_ext\n   if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   (eval $ac_compile) 2>&5\n   ac_status=$?\n@@ -3978,7 +3981,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -4430,7 +4434,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -4600,7 +4605,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -4667,7 +4673,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -4851,7 +4858,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -4914,7 +4922,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -5092,7 +5101,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -5209,7 +5219,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -5302,6 +5313,7 @@ i*86-*-netbsdelf* | i*86-*-knetbsd*-gnu) TARGET=X86; TARGETDIR=x86;;\n i*86-*-win32*) TARGET=X86_WIN32; TARGETDIR=x86;;\n i*86-*-cygwin*) TARGET=X86_WIN32; TARGETDIR=x86;;\n i*86-*-mingw*) TARGET=X86_WIN32; TARGETDIR=x86;;\n+frv-*-*) TARGET=FRV; TARGETDIR=frv;;\n sparc-sun-4*) TARGET=SPARC; TARGETDIR=sparc;;\n sparc*-sun-*) TARGET=SPARC; TARGETDIR=sparc;;\n sparc-*-linux* | sparc-*-netbsdelf* | sparc-*-knetbsd*-gnu) TARGET=SPARC; TARGETDIR=sparc;;\n@@ -5457,6 +5469,16 @@ fi\n \n \n \n+if test x$TARGET = xFRV; then\n+  FRV_TRUE=\n+  FRV_FALSE='#'\n+else\n+  FRV_TRUE='#'\n+  FRV_FALSE=\n+fi\n+\n+\n+\n if test x$TARGET = xS390; then\n   S390_TRUE=\n   S390_FALSE='#'\n@@ -5544,7 +5566,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -5745,7 +5768,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -5808,7 +5832,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -5889,7 +5914,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6030,7 +6056,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6167,7 +6194,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6237,7 +6265,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6324,7 +6353,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6365,7 +6395,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6533,7 +6564,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6599,7 +6631,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6970,6 +7003,13 @@ echo \"$as_me: error: conditional \\\"ARM\\\" was never defined.\n Usually this means the macro was only invoked conditionally.\" >&2;}\n    { (exit 1); exit 1; }; }\n fi\n+if test -z \"${FRV_TRUE}\" && test -z \"${FRV_FALSE}\"; then\n+  { { echo \"$as_me:$LINENO: error: conditional \\\"FRV\\\" was never defined.\n+Usually this means the macro was only invoked conditionally.\" >&5\n+echo \"$as_me: error: conditional \\\"FRV\\\" was never defined.\n+Usually this means the macro was only invoked conditionally.\" >&2;}\n+   { (exit 1); exit 1; }; }\n+fi\n if test -z \"${S390_TRUE}\" && test -z \"${S390_FALSE}\"; then\n   { { echo \"$as_me:$LINENO: error: conditional \\\"S390\\\" was never defined.\n Usually this means the macro was only invoked conditionally.\" >&5\n@@ -7646,6 +7686,8 @@ s,@POWERPC_DARWIN_TRUE@,$POWERPC_DARWIN_TRUE,;t t\n s,@POWERPC_DARWIN_FALSE@,$POWERPC_DARWIN_FALSE,;t t\n s,@ARM_TRUE@,$ARM_TRUE,;t t\n s,@ARM_FALSE@,$ARM_FALSE,;t t\n+s,@FRV_TRUE@,$FRV_TRUE,;t t\n+s,@FRV_FALSE@,$FRV_FALSE,;t t\n s,@S390_TRUE@,$S390_TRUE,;t t\n s,@S390_FALSE@,$S390_FALSE,;t t\n s,@X86_64_TRUE@,$X86_64_TRUE,;t t\n@@ -7832,6 +7874,11 @@ esac\n   *) ac_INSTALL=$ac_top_builddir$INSTALL ;;\n   esac\n \n+  if test x\"$ac_file\" != x-; then\n+    { echo \"$as_me:$LINENO: creating $ac_file\" >&5\n+echo \"$as_me: creating $ac_file\" >&6;}\n+    rm -f \"$ac_file\"\n+  fi\n   # Let's still pretend it is `configure' which instantiates (i.e., don't\n   # use $as_me), people would be surprised to read:\n   #    /* config.h.  Generated by config.status.  */\n@@ -7870,12 +7917,6 @@ echo \"$as_me: error: cannot find input file: $f\" >&2;}\n \t fi;;\n       esac\n     done` || { (exit 1); exit 1; }\n-\n-  if test x\"$ac_file\" != x-; then\n-    { echo \"$as_me:$LINENO: creating $ac_file\" >&5\n-echo \"$as_me: creating $ac_file\" >&6;}\n-    rm -f \"$ac_file\"\n-  fi\n _ACEOF\n cat >>$CONFIG_STATUS <<_ACEOF\n   sed \"$ac_vpsub"}, {"sha": "ec19944aa32c990f78474f314d0ace53c498b98b", "filename": "libffi/configure.ac", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fconfigure.ac?ref=88d8c771f98c83763f2ee41e5046417795a97eac", "patch": "@@ -10,6 +10,8 @@ AM_ENABLE_MULTILIB(, ..)\n AC_CANONICAL_SYSTEM\n target_alias=${target_alias-$host_alias}\n \n+. ${srcdir}/configure.host\n+\n AM_INIT_AUTOMAKE\n \n # The same as in boehm-gc and libstdc++. Have to borrow it from there.\n@@ -47,6 +49,7 @@ i*86-*-netbsdelf* | i*86-*-knetbsd*-gnu) TARGET=X86; TARGETDIR=x86;;\n i*86-*-win32*) TARGET=X86_WIN32; TARGETDIR=x86;;\n i*86-*-cygwin*) TARGET=X86_WIN32; TARGETDIR=x86;;\n i*86-*-mingw*) TARGET=X86_WIN32; TARGETDIR=x86;;\n+frv-*-*) TARGET=FRV; TARGETDIR=frv;;\n sparc-sun-4*) TARGET=SPARC; TARGETDIR=sparc;;\n sparc*-sun-*) TARGET=SPARC; TARGETDIR=sparc;;\n sparc-*-linux* | sparc-*-netbsdelf* | sparc-*-knetbsd*-gnu) TARGET=SPARC; TARGETDIR=sparc;;\n@@ -90,6 +93,7 @@ AM_CONDITIONAL(POWERPC, test x$TARGET = xPOWERPC)\n AM_CONDITIONAL(POWERPC_AIX, test x$TARGET = xPOWERPC_AIX)\n AM_CONDITIONAL(POWERPC_DARWIN, test x$TARGET = xPOWERPC_DARWIN)\n AM_CONDITIONAL(ARM, test x$TARGET = xARM)\n+AM_CONDITIONAL(FRV, test x$TARGET = xFRV)\n AM_CONDITIONAL(S390, test x$TARGET = xS390)\n AM_CONDITIONAL(X86_64, test x$TARGET = xX86_64)\n AM_CONDITIONAL(SH, test x$TARGET = xSH)"}, {"sha": "f52457b39fd48f22ec026fa6127e2f286d1f0e46", "filename": "libffi/configure.host", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Fconfigure.host", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Fconfigure.host", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fconfigure.host?ref=88d8c771f98c83763f2ee41e5046417795a97eac", "patch": "@@ -0,0 +1,11 @@\n+# configure.host\n+#\n+# This shell script handles all host based configuration for libffi.\n+# \n+\n+# THIS TABLE IS SORTED.  KEEP IT THAT WAY.\n+case \"${host}\" in\n+  frv*-elf)\n+    LDFLAGS=`echo $LDFLAGS | sed \"s/\\-B[^ ]*libgloss\\/frv\\///\"`\\ -B`pwd`/../libgloss/frv/\n+    ;;\n+esac"}, {"sha": "426004586894984b43db6728f7a8e62084a83a74", "filename": "libffi/include/ffi.h.in", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Finclude%2Fffi.h.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Finclude%2Fffi.h.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Finclude%2Fffi.h.in?ref=88d8c771f98c83763f2ee41e5046417795a97eac", "patch": "@@ -218,7 +218,7 @@ typedef struct {\n   ffi_cif   *cif;\n   void     (*fun)(ffi_cif*,void*,void**,void*);\n   void      *user_data;\n-} ffi_closure;\n+} ffi_closure __attribute__((aligned (8)));\n \n ffi_status\n ffi_prep_closure (ffi_closure*,"}, {"sha": "da15ab8ec6120f44c3dcdcf52214368be5e91775", "filename": "libffi/include/ffi_common.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Finclude%2Fffi_common.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Finclude%2Fffi_common.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Finclude%2Fffi_common.h?ref=88d8c771f98c83763f2ee41e5046417795a97eac", "patch": "@@ -60,6 +60,7 @@ void ffi_type_test(/*@temp@*/ /*@out@*/ ffi_type *a, /*@temp@*/ char *file, int\n #endif\n \n #define ALIGN(v, a)  (((((size_t) (v))-1) | ((a)-1))+1)\n+#define ALIGN_DOWN(v, a) (((size_t) (v)) & -a)\n \n /* Perform machine dependent cif processing */\n ffi_status ffi_prep_cif_machdep(ffi_cif *cif);"}, {"sha": "59b1e353916e15131d337d644739f61b26fd2765", "filename": "libffi/src/frv/eabi.S", "status": "added", "additions": 130, "deletions": 0, "changes": 130, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Fsrc%2Ffrv%2Feabi.S", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Fsrc%2Ffrv%2Feabi.S", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fsrc%2Ffrv%2Feabi.S?ref=88d8c771f98c83763f2ee41e5046417795a97eac", "patch": "@@ -0,0 +1,130 @@\n+/* -----------------------------------------------------------------------\n+   eabi.S - Copyright (c) 2004  Anthony Green\n+   \n+   FR-V Assembly glue.\n+\n+   $Id: sysv.S,v 1.1.1.1 1998/11/29 16:48:16 green Exp $\n+\n+   Permission is hereby granted, free of charge, to any person obtaining\n+   a copy of this software and associated documentation files (the\n+   ``Software''), to deal in the Software without restriction, including\n+   without limitation the rights to use, copy, modify, merge, publish,\n+   distribute, sublicense, and/or sell copies of the Software, and to\n+   permit persons to whom the Software is furnished to do so, subject to\n+   the following conditions:\n+\n+   The above copyright notice and this permission notice shall be included\n+   in all copies or substantial portions of the Software.\n+\n+   THE SOFTWARE IS PROVIDED ``AS IS'', WITHOUT WARRANTY OF ANY KIND, EXPRESS\n+   OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n+   MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\n+   IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY CLAIM, DAMAGES OR\n+   OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,\n+   ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n+   OTHER DEALINGS IN THE SOFTWARE.\n+   ----------------------------------------------------------------------- */\n+\n+#define LIBFFI_ASM\t\n+#include <fficonfig.h>\n+#include <ffi.h>\n+\n+\t.globl ffi_prep_args_EABI\n+\n+\t.text\n+\t.p2align 4\n+\t.globl ffi_call_EABI\n+\t.type ffi_call_EABI, @function\n+\n+\t# gr8 :   ffi_prep_args\n+\t# gr9 :   &ecif\n+\t# gr10:   cif->bytes\n+\t# gr11:   fig->flags\n+\t# gr12:   ecif.rvalue\n+\t# gr13:   fn\n+\t\n+ffi_call_EABI:\t\n+\taddi\tsp, #-80, sp\n+\tsti\tfp, @(sp, #24)\n+\taddi\tsp, #24, fp\n+\tmovsg\tlr, gr5\n+\n+\t/* Make room for the new arguments.  */\n+\t/* subi\tsp, fp, gr10 */\n+\t\n+\t/* Store return address and incoming args on stack.  */\n+\tsti\tgr5, @(fp, #8)\n+\tsti\tgr8, @(fp, #-4)\n+\tsti\tgr9, @(fp, #-8)\n+\tsti\tgr10, @(fp, #-12)\n+\tsti\tgr11, @(fp, #-16)\n+\tsti\tgr12, @(fp, #-20)\n+\tsti\tgr13, @(fp, #-24)\n+\n+\tsub     sp, gr10, sp\n+\t\n+\t/* Call ffi_prep_args.  */\n+\tldi\t@(fp, #-4), gr4\n+\taddi\tsp, #0, gr8\n+\tldi\t@(fp, #-8), gr9\n+#ifdef __FRV_FDPIC__\n+\tldd\t@(gr4, gr0), gr14\n+\tcalll\t@(gr14, gr0)\n+#else\n+\tcalll\t@(gr4, gr0)\n+#endif\t\n+\n+\t/* ffi_prep_args returns the new stack pointer.  */\n+\tmov\tgr8, gr4\n+\t\t\n+\tldi\t@(sp, #0), gr8\n+\tldi\t@(sp, #4), gr9\n+\tldi\t@(sp, #8), gr10\n+\tldi\t@(sp, #12), gr11\n+\tldi\t@(sp, #16), gr12\n+\tldi\t@(sp, #20), gr13\n+\n+\t/* Always copy the return value pointer into the hidden\n+\t   parameter register.  This is only strictly necessary\n+\t   when we're returning an aggregate type, but it doesn't\n+\t   hurt to do this all the time, and it saves a branch.  */\n+\tldi\t@(fp, #-20), gr3\n+\n+\t/* Use the ffi_prep_args return value for the new sp.  */\n+\tmov\tgr4, sp\n+\t\n+\t/* Call the target function.  */\n+\tldi\t@(fp, -24), gr4\n+#ifdef __FRV_FDPIC__\n+\tldd\t@(gr4, gr0), gr14\n+\tcalll\t@(gr14, gr0)\n+#else\n+\tcalll\t@(gr4, gr0)\n+#endif\t\n+\n+\t/* Store the result. */\n+\tldi\t@(fp, #-16), gr10  /* fig->flags */\n+\tldi\t@(fp, #-20), gr4   /* ecif.rvalue */\n+\n+\t/* Is the return value stored in two registers?  */\n+\tcmpi\tgr10, #8, icc0\n+\tbne\ticc0, 0, .L2\n+\t/*   Yes, save them.  */\n+\tsti\tgr8, @(gr4, #0)\n+\tsti\tgr9, @(gr4, #4)\n+\tbra\t.L3\n+.L2:\n+\t/* Is the return value a structure?  */\n+\tcmpi\tgr10, #-1, icc0\n+\tbeq\ticc0, 0, .L3\n+\t/*   No, save a 4 byte return value.  */\n+\tsti\tgr8, @(gr4, #0)\n+.L3:\t\n+\n+\t/* Restore the stack, and return.  */\n+\tldi\t@(fp, 8), gr5\n+\tld\t@(fp, gr0), fp\n+\taddi\tsp,#80,sp\n+\tjmpl\t@(gr5,gr0)\n+\t.size ffi_call_EABI, .-ffi_call_EABI\n+\t"}, {"sha": "6e2ac68736fe305ca6e9435fcef2b8141838f55f", "filename": "libffi/src/frv/ffi.c", "status": "added", "additions": 287, "deletions": 0, "changes": 287, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Fsrc%2Ffrv%2Fffi.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Fsrc%2Ffrv%2Fffi.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fsrc%2Ffrv%2Fffi.c?ref=88d8c771f98c83763f2ee41e5046417795a97eac", "patch": "@@ -0,0 +1,287 @@\n+/* -----------------------------------------------------------------------\n+   ffi.c - Copyright (c) 2004  Anthony Green\n+   \n+   FR-V Foreign Function Interface \n+\n+   Permission is hereby granted, free of charge, to any person obtaining\n+   a copy of this software and associated documentation files (the\n+   ``Software''), to deal in the Software without restriction, including\n+   without limitation the rights to use, copy, modify, merge, publish,\n+   distribute, sublicense, and/or sell copies of the Software, and to\n+   permit persons to whom the Software is furnished to do so, subject to\n+   the following conditions:\n+\n+   The above copyright notice and this permission notice shall be included\n+   in all copies or substantial portions of the Software.\n+\n+   THE SOFTWARE IS PROVIDED ``AS IS'', WITHOUT WARRANTY OF ANY KIND, EXPRESS\n+   OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n+   MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\n+   IN NO EVENT SHALL CYGNUS SOLUTIONS BE LIABLE FOR ANY CLAIM, DAMAGES OR\n+   OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,\n+   ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n+   OTHER DEALINGS IN THE SOFTWARE.\n+   ----------------------------------------------------------------------- */\n+\n+#include <ffi.h>\n+#include <ffi_common.h>\n+\n+#include <stdlib.h>\n+\n+/* ffi_prep_args is called by the assembly routine once stack space\n+   has been allocated for the function's arguments */\n+\n+void *ffi_prep_args(char *stack, extended_cif *ecif)\n+{\n+  register unsigned int i;\n+  register void **p_argv;\n+  register char *argp;\n+  register ffi_type **p_arg;\n+  register int count = 0;\n+\n+  p_argv = ecif->avalue;\n+  argp = stack;\n+\n+  for (i = ecif->cif->nargs, p_arg = ecif->cif->arg_types;\n+       (i != 0);\n+       i--, p_arg++)\n+    {\n+      size_t z;\n+      \n+      z = (*p_arg)->size;\n+\n+      if ((*p_arg)->type == FFI_TYPE_STRUCT)\n+\t{\n+\t  z = sizeof(void*);\n+\t  *(void **) argp = *p_argv;\n+\t} \n+      /*      if ((*p_arg)->type == FFI_TYPE_FLOAT)\n+\t{\n+\t  if (count > 24)\n+\t    {\n+\t      // This is going on the stack.  Turn it into a double.  \n+\t      *(double *) argp = (double) *(float*)(* p_argv);\n+\t      z = sizeof(double);\n+\t    }\n+\t  else\n+\t    *(void **) argp = *(void **)(* p_argv);\n+\t}  */\n+      else if (z < sizeof(int))\n+\t{\n+\t  z = sizeof(int);\n+\t  switch ((*p_arg)->type)\n+\t    {\n+\t    case FFI_TYPE_SINT8:\n+\t      *(signed int *) argp = (signed int)*(SINT8 *)(* p_argv);\n+\t      break;\n+\t      \n+\t    case FFI_TYPE_UINT8:\n+\t      *(unsigned int *) argp = (unsigned int)*(UINT8 *)(* p_argv);\n+\t      break;\n+\t      \n+\t    case FFI_TYPE_SINT16:\n+\t      *(signed int *) argp = (signed int)*(SINT16 *)(* p_argv);\n+\t      break;\n+\t\t  \n+\t    case FFI_TYPE_UINT16:\n+\t      *(unsigned int *) argp = (unsigned int)*(UINT16 *)(* p_argv);\n+\t      break;\n+\t\t  \n+\t    default:\n+\t      FFI_ASSERT(0);\n+\t    }\n+\t}\n+      else if (z == sizeof(int))\n+\t{\n+\t  *(unsigned int *) argp = (unsigned int)*(UINT32 *)(* p_argv);\n+\t}\n+      else\n+\t{\n+\t  memcpy(argp, *p_argv, z);\n+\t}\n+      p_argv++;\n+      argp += z;\n+      count += z;\n+    }\n+\n+  return (stack + ((count > 24) ? 24 : ALIGN_DOWN(count, 8)));\n+}\n+\n+/* Perform machine dependent cif processing */\n+ffi_status ffi_prep_cif_machdep(ffi_cif *cif)\n+{\n+  if (cif->rtype->type == FFI_TYPE_STRUCT)\n+    cif->flags = -1;\n+  else\n+    cif->flags = cif->rtype->size;\n+\n+  cif->bytes = ALIGN (cif->bytes, 8);\n+\n+  return FFI_OK;\n+}\n+\n+extern void ffi_call_EABI(void *(*)(char *, extended_cif *), \n+\t\t\t  extended_cif *, \n+\t\t\t  unsigned, unsigned, \n+\t\t\t  unsigned *, \n+\t\t\t  void (*fn)());\n+\n+void ffi_call(ffi_cif *cif, \n+\t      void (*fn)(), \n+\t      void *rvalue, \n+\t      void **avalue)\n+{\n+  extended_cif ecif;\n+\n+  ecif.cif = cif;\n+  ecif.avalue = avalue;\n+  \n+  /* If the return value is a struct and we don't have a return\t*/\n+  /* value address then we need to make one\t\t        */\n+\n+  if ((rvalue == NULL) && \n+      (cif->rtype->type == FFI_TYPE_STRUCT))\n+    {\n+      ecif.rvalue = alloca(cif->rtype->size);\n+    }\n+  else\n+    ecif.rvalue = rvalue;\n+    \n+  \n+  switch (cif->abi) \n+    {\n+    case FFI_EABI:\n+      ffi_call_EABI(ffi_prep_args, &ecif, cif->bytes, \n+\t\t    cif->flags, ecif.rvalue, fn);\n+      break;\n+    default:\n+      FFI_ASSERT(0);\n+      break;\n+    }\n+}\n+\n+void ffi_closure_eabi (unsigned arg1, unsigned arg2, unsigned arg3,\n+\t\t       unsigned arg4, unsigned arg5, unsigned arg6)\n+{\n+  /* This function is called by a trampoline.  The trampoline stows a\n+     pointer to the ffi_closure object in gr7.  We must save this\n+     pointer in a place that will persist while we do our work.  */\n+  register ffi_closure *creg __asm__ (\"gr7\");\n+  ffi_closure *closure = creg;\n+\n+  /* Arguments that don't fit in registers are found on the stack\n+     at a fixed offset above the current frame pointer.  */\n+  register char *frame_pointer __asm__ (\"fp\");\n+  char *stack_args = frame_pointer + 16;\n+\n+  /* Lay the register arguments down in a continuous chunk of memory.  */\n+  unsigned register_args[6] =\n+    { arg1, arg2, arg3, arg4, arg5, arg6 };\n+\n+  ffi_cif *cif = closure->cif;\n+  ffi_type **arg_types = cif->arg_types;\n+  void **avalue = alloca (cif->nargs * sizeof(void *));\n+  char *ptr = (char *) register_args;\n+  int i;\n+\n+  /* Find the address of each argument.  */\n+  for (i = 0; i < cif->nargs; i++)\n+    {\n+      switch (arg_types[i]->type)\n+\t{\n+\tcase FFI_TYPE_SINT8:\n+\tcase FFI_TYPE_UINT8:\n+\t  avalue[i] = ptr + 3;\n+\t  break;\n+\tcase FFI_TYPE_SINT16:\n+\tcase FFI_TYPE_UINT16:\n+\t  avalue[i] = ptr + 2;\n+\t  break;\n+\tcase FFI_TYPE_SINT32:\n+\tcase FFI_TYPE_UINT32:\n+\tcase FFI_TYPE_FLOAT:\n+\t  avalue[i] = ptr;\n+\t  break;\n+\tcase FFI_TYPE_STRUCT:\n+\t  avalue[i] = *(void**)ptr;\n+\t  break;\n+\tdefault:\n+\t  /* This is an 8-byte value.  */\n+\t  avalue[i] = ptr;\n+\t  ptr += 4;\n+\t  break;\n+\t}\n+      ptr += 4;\n+\n+      /* If we've handled more arguments than fit in registers,\n+\t start looking at the those passed on the stack.  */\n+      if (ptr == ((char *)register_args + (6*4)))\n+\tptr = stack_args;\n+    }\n+\n+  /* Invoke the closure.  */\n+  if (cif->rtype->type == FFI_TYPE_STRUCT)\n+    {\n+      /* The caller allocates space for the return structure, and\n+       passes a pointer to this space in gr3.  Use this value directly\n+       as the return value.  */\n+      register void *return_struct_ptr __asm__(\"gr3\");\n+      (closure->fun) (cif, return_struct_ptr, avalue, closure->user_data);\n+    }\n+  else\n+    {\n+      /* Allocate space for the return value and call the function.  */\n+      long long rvalue;\n+      (closure->fun) (cif, &rvalue, avalue, closure->user_data);\n+\n+      /* Functions return 4-byte or smaller results in gr8.  8-byte\n+\t values also use gr9.  We fill the both, even for small return\n+\t values, just to avoid a branch.  */ \n+      asm (\"ldi  @(%0, #0), gr8\" : : \"r\" (&rvalue));\n+      asm (\"ldi  @(%0, #0), gr9\" : : \"r\" (&((int *) &rvalue)[1]));\n+    }\n+}\n+\n+ffi_status\n+ffi_prep_closure (ffi_closure* closure,\n+\t\t  ffi_cif* cif,\n+\t\t  void (*fun)(ffi_cif*, void*, void**, void*),\n+\t\t  void *user_data)\n+{\n+  unsigned int *tramp = (unsigned int *) &closure->tramp[0];\n+  unsigned long fn = (long) ffi_closure_eabi;\n+  unsigned long cls = (long) closure;\n+#ifdef __FRV_FDPIC__\n+  register void *got __asm__(\"gr15\");\n+#endif\n+  int i;\n+\n+  fn = (unsigned long) ffi_closure_eabi;\n+\n+#ifdef __FRV_FDPIC__\n+  tramp[0] = &tramp[2];\n+  tramp[1] = got;\n+  tramp[2] = 0x8cfc0000 + (fn  & 0xffff); /* setlos lo(fn), gr6    */\n+  tramp[3] = 0x8efc0000 + (cls & 0xffff); /* setlos lo(cls), gr7   */\n+  tramp[4] = 0x8cf80000 + (fn  >> 16);\t  /* sethi hi(fn), gr6     */\n+  tramp[5] = 0x8ef80000 + (cls >> 16);    /* sethi hi(cls), gr7    */\n+  tramp[6] = 0x9cc86000;                  /* ldi @(gr6, #0), gr14  */\n+  tramp[7] = 0x8030e000;                  /* jmpl @(gr14, gr0)     */\n+#else\n+  tramp[0] = 0x8cfc0000 + (fn  & 0xffff); /* setlos lo(fn), gr6    */\n+  tramp[1] = 0x8efc0000 + (cls & 0xffff); /* setlos lo(cls), gr7   */\n+  tramp[2] = 0x8cf80000 + (fn  >> 16);\t  /* sethi hi(fn), gr6     */\n+  tramp[3] = 0x8ef80000 + (cls >> 16);    /* sethi hi(cls), gr7    */\n+  tramp[4] = 0x80300006;                  /* jmpl @(gr0, gr6)      */\n+#endif\n+\n+  closure->cif = cif;\n+  closure->fun = fun;\n+  closure->user_data = user_data;\n+\n+  /* Cache flushing.  */\n+  for (i = 0; i < FFI_TRAMPOLINE_SIZE; i++)\n+    __asm__ volatile (\"dcf @(%0,%1)\\n\\tici @(%0,%1)\" :: \"r\" (tramp), \"r\" (i));\n+\n+  return FFI_OK;\n+}"}, {"sha": "48ca13963c60b550abe8f98fe907141ec0ae4535", "filename": "libffi/src/frv/ffitarget.h", "status": "added", "additions": 88, "deletions": 0, "changes": 88, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Fsrc%2Ffrv%2Fffitarget.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Fsrc%2Ffrv%2Fffitarget.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fsrc%2Ffrv%2Fffitarget.h?ref=88d8c771f98c83763f2ee41e5046417795a97eac", "patch": "@@ -0,0 +1,88 @@\n+/* -----------------------------------------------------------------*-C-*-\n+   ffitarget.h - Copyright (c) 1996-2004  Red Hat, Inc.\n+   Target configuration macros for FR-V\n+\n+   Permission is hereby granted, free of charge, to any person obtaining\n+   a copy of this software and associated documentation files (the\n+   ``Software''), to deal in the Software without restriction, including\n+   without limitation the rights to use, copy, modify, merge, publish,\n+   distribute, sublicense, and/or sell copies of the Software, and to\n+   permit persons to whom the Software is furnished to do so, subject to\n+   the following conditions:\n+\n+   The above copyright notice and this permission notice shall be included\n+   in all copies or substantial portions of the Software.\n+\n+   THE SOFTWARE IS PROVIDED ``AS IS'', WITHOUT WARRANTY OF ANY KIND, EXPRESS\n+   OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n+   MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\n+   IN NO EVENT SHALL CYGNUS SOLUTIONS BE LIABLE FOR ANY CLAIM, DAMAGES OR\n+   OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,\n+   ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n+   OTHER DEALINGS IN THE SOFTWARE.\n+\n+   ----------------------------------------------------------------------- */\n+\n+#ifndef LIBFFI_TARGET_H\n+#define LIBFFI_TARGET_H\n+\n+/* ---- System specific configurations ----------------------------------- */\n+\n+#if defined (POWERPC) && defined (__powerpc64__)\n+#define POWERPC64\n+#endif\n+\n+#ifndef LIBFFI_ASM\n+typedef unsigned long          ffi_arg;\n+typedef signed long            ffi_sarg;\n+\n+typedef enum ffi_abi {\n+  FFI_FIRST_ABI = 0,\n+\n+#ifdef FRV\n+  FFI_EABI,\n+  FFI_DEFAULT_ABI = FFI_EABI,\n+#endif\n+\n+#ifdef POWERPC\n+  FFI_SYSV,\n+  FFI_GCC_SYSV,\n+  FFI_LINUX64,\n+# ifdef POWERPC64\n+  FFI_DEFAULT_ABI = FFI_LINUX64,\n+# else\n+  FFI_DEFAULT_ABI = FFI_GCC_SYSV,\n+# endif\n+#endif\n+\n+#ifdef POWERPC_AIX\n+  FFI_AIX,\n+  FFI_DARWIN,\n+  FFI_DEFAULT_ABI = FFI_AIX,\n+#endif\n+\n+#ifdef POWERPC_DARWIN\n+  FFI_AIX,\n+  FFI_DARWIN,\n+  FFI_DEFAULT_ABI = FFI_DARWIN,\n+#endif\n+\n+  FFI_LAST_ABI = FFI_DEFAULT_ABI + 1\n+} ffi_abi;\n+#endif\n+\n+/* ---- Definitions for closures ----------------------------------------- */\n+\n+#define FFI_CLOSURES 1\n+#define FFI_NATIVE_RAW_API 0\n+\n+#ifdef __FRV_FDPIC__\n+/* Trampolines are 8 4-byte instructions long.  */\n+#define FFI_TRAMPOLINE_SIZE (8*4) \n+#else\n+/* Trampolines are 5 4-byte instructions long.  */\n+#define FFI_TRAMPOLINE_SIZE (5*4) \n+#endif\n+\n+#endif\n+"}, {"sha": "2d8ea21dc6d1bd7b526aea1a64f40973119608b9", "filename": "libffi/testsuite/Makefile.in", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Ftestsuite%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d8c771f98c83763f2ee41e5046417795a97eac/libffi%2Ftestsuite%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Ftestsuite%2FMakefile.in?ref=88d8c771f98c83763f2ee41e5046417795a97eac", "patch": "@@ -1,4 +1,4 @@\n-# Makefile.in generated by automake 1.8.5 from Makefile.am.\n+# Makefile.in generated by automake 1.8.3 from Makefile.am.\n # @configure_input@\n \n # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,\n@@ -81,6 +81,8 @@ ECHO_N = @ECHO_N@\n ECHO_T = @ECHO_T@\n EGREP = @EGREP@\n EXEEXT = @EXEEXT@\n+FRV_FALSE = @FRV_FALSE@\n+FRV_TRUE = @FRV_TRUE@\n HAVE_LONG_DOUBLE = @HAVE_LONG_DOUBLE@\n IA64_FALSE = @IA64_FALSE@\n IA64_TRUE = @IA64_TRUE@"}]}