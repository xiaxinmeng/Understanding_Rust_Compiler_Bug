{"sha": "d86d6e27db4520249273fbd65e809036999f96f4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDg2ZDZlMjdkYjQ1MjAyNDkyNzNmYmQ2NWU4MDkwMzY5OTlmOTZmNA==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2018-05-10T18:57:50Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2018-05-10T18:57:50Z"}, "message": "CWG 2267 - list-initialization of reference temporary\n\n\t* call.c (reference_binding): List-initializing a reference\n\ttemporary is copy-list-initialization.\n\nFrom-SVN: r260126", "tree": {"sha": "f5eb9dc9a2a05a1c425ebae851abd3e610e671cd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f5eb9dc9a2a05a1c425ebae851abd3e610e671cd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d86d6e27db4520249273fbd65e809036999f96f4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d86d6e27db4520249273fbd65e809036999f96f4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d86d6e27db4520249273fbd65e809036999f96f4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d86d6e27db4520249273fbd65e809036999f96f4/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2c9c6adac944e2705131400a24570ae884388c71", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2c9c6adac944e2705131400a24570ae884388c71", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2c9c6adac944e2705131400a24570ae884388c71"}], "stats": {"total": 28, "additions": 22, "deletions": 6}, "files": [{"sha": "e6223ae4dc397d13dd7f8e017f42670ed3718a38", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d86d6e27db4520249273fbd65e809036999f96f4/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d86d6e27db4520249273fbd65e809036999f96f4/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=d86d6e27db4520249273fbd65e809036999f96f4", "patch": "@@ -1,5 +1,9 @@\n 2018-05-09  Jason Merrill  <jason@redhat.com>\n \n+\tCWG 2267 - list-initialization of reference temporary\n+\t* call.c (reference_binding): List-initializing a reference\n+\ttemporary is copy-list-initialization.\n+\n \t* parser.c (cp_parser_class_head): Use num_template_headers_for_class.\n \n \t* pt.c (instantiate_decl): Make sure we aren't trying to do a nested"}, {"sha": "30fe682e7b46f63aa08f93f63c702225439a9ad5", "filename": "gcc/cp/call.c", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d86d6e27db4520249273fbd65e809036999f96f4/gcc%2Fcp%2Fcall.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d86d6e27db4520249273fbd65e809036999f96f4/gcc%2Fcp%2Fcall.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcall.c?ref=d86d6e27db4520249273fbd65e809036999f96f4", "patch": "@@ -1560,12 +1560,10 @@ reference_binding (tree rto, tree rfrom, tree expr, bool c_cast_p, int flags,\n \t      goto skip;\n \t    }\n \t}\n-      /* Otherwise, if T is a reference type, a prvalue temporary of the\n-\t type referenced by T is copy-list-initialized or\n-\t direct-list-initialized, depending on the kind of initialization\n-\t for the reference, and the reference is bound to that temporary. */\n-      conv = implicit_conversion (to, from, expr, c_cast_p,\n-\t\t\t\t  flags|LOOKUP_NO_TEMP_BIND, complain);\n+      /* Otherwise, if T is a reference type, a prvalue temporary of the type\n+\t referenced by T is copy-list-initialized, and the reference is bound\n+\t to that temporary. */\n+      CONSTRUCTOR_IS_DIRECT_INIT (expr) = false;\n     skip:;\n     }\n "}, {"sha": "dfd735a5add94659623bc61762d8654060375263", "filename": "gcc/testsuite/g++.dg/cpp0x/initlist-ref-2267.C", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d86d6e27db4520249273fbd65e809036999f96f4/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist-ref-2267.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d86d6e27db4520249273fbd65e809036999f96f4/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist-ref-2267.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist-ref-2267.C?ref=d86d6e27db4520249273fbd65e809036999f96f4", "patch": "@@ -0,0 +1,14 @@\n+// CWG 2267\n+// { dg-do compile { target c++11 } }\n+\n+struct A {} a; \n+struct B { explicit B(const A&); }; \n+B b1(a); // #1, ok \n+const B &b2{a}; // { dg-error \"\" }\n+const B &b3(a); // { dg-error \"\" }\n+\n+struct D { D(); }; \n+struct C { explicit operator D(); } c; \n+D d1(c); // ok \n+const D &d2{c}; // { dg-error \"\" }\n+const D &d3(c); // { dg-error \"\" }"}]}