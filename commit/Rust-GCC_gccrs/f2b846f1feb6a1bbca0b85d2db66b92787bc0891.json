{"sha": "f2b846f1feb6a1bbca0b85d2db66b92787bc0891", "node_id": "C_kwDOANBUbNoAKGYyYjg0NmYxZmViNmExYmJjYTBiODVkMmRiNjZiOTI3ODdiYzA4OTE", "commit": {"author": {"name": "Junxian Zhu", "email": "zhujunxian@oss.cipunited.com", "date": "2023-03-02T10:30:21Z"}, "committer": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2023-03-02T10:30:21Z"}, "message": "MIPS: Add buildtime option to set msa default\n\nAdd buildtime option to decide whether will compiler build with `-mmsa` option default.\n\ngcc/ChangeLog:\n\t* config.gcc: add -with-{no-}msa build option.\n\t* config/mips/mips.h: Likewise.\n\t* doc/install.texi: Likewise.\n\nSigned-off-by: Junxian Zhu <zhujunxian@oss.cipunited.com>", "tree": {"sha": "10b0718b807e3d2a8c1429b12c2cd79a95260029", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/10b0718b807e3d2a8c1429b12c2cd79a95260029"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f2b846f1feb6a1bbca0b85d2db66b92787bc0891", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f2b846f1feb6a1bbca0b85d2db66b92787bc0891", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f2b846f1feb6a1bbca0b85d2db66b92787bc0891", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f2b846f1feb6a1bbca0b85d2db66b92787bc0891/comments", "author": {"login": "HeliC829", "id": 16401013, "node_id": "MDQ6VXNlcjE2NDAxMDEz", "avatar_url": "https://avatars.githubusercontent.com/u/16401013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/HeliC829", "html_url": "https://github.com/HeliC829", "followers_url": "https://api.github.com/users/HeliC829/followers", "following_url": "https://api.github.com/users/HeliC829/following{/other_user}", "gists_url": "https://api.github.com/users/HeliC829/gists{/gist_id}", "starred_url": "https://api.github.com/users/HeliC829/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/HeliC829/subscriptions", "organizations_url": "https://api.github.com/users/HeliC829/orgs", "repos_url": "https://api.github.com/users/HeliC829/repos", "events_url": "https://api.github.com/users/HeliC829/events{/privacy}", "received_events_url": "https://api.github.com/users/HeliC829/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b09dc74801cf4e19bdf5fcd18a5cd53fc9e9ca9a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b09dc74801cf4e19bdf5fcd18a5cd53fc9e9ca9a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b09dc74801cf4e19bdf5fcd18a5cd53fc9e9ca9a"}], "stats": {"total": 30, "additions": 27, "deletions": 3}, "files": [{"sha": "da3a6d3ba1f3ee184314e09453cbf1bbdf05faf4", "filename": "gcc/config.gcc", "status": "modified", "additions": 17, "deletions": 2, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f2b846f1feb6a1bbca0b85d2db66b92787bc0891/gcc%2Fconfig.gcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f2b846f1feb6a1bbca0b85d2db66b92787bc0891/gcc%2Fconfig.gcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.gcc?ref=f2b846f1feb6a1bbca0b85d2db66b92787bc0891", "patch": "@@ -4709,7 +4709,7 @@ case \"${target}\" in\n \t\t;;\n \n \tmips*-*-*)\n-\t\tsupported_defaults=\"abi arch arch_32 arch_64 float fpu nan fp_32 odd_spreg_32 tune tune_32 tune_64 divide llsc mips-plt synci lxc1-sxc1 madd4 compact-branches\"\n+\t\tsupported_defaults=\"abi arch arch_32 arch_64 float fpu nan fp_32 odd_spreg_32 tune tune_32 tune_64 divide llsc mips-plt synci lxc1-sxc1 madd4 compact-branches msa\"\n \n \t\tcase ${with_float} in\n \t\t\"\" | soft | hard)\n@@ -4871,6 +4871,21 @@ case \"${target}\" in\n \t\t\texit 1\n \t\t\t;;\n \t\tesac\n+\n+\t\tcase ${with_msa} in\n+\t\tyes)\n+\t\t\twith_msa=msa\n+\t\t\t;;\n+\t\tno)\n+\t\t\twith_msa=no-msa\n+\t\t\t;;\n+\t\t\"\")\n+\t\t\t;;\n+\t\t*)\n+\t\t\techo \"Unknown msa type used in --with-msa\" 1>&2\n+\t\t\texit 1\n+\t\t\t;;\n+\t\tesac\n \t\t;;\n \n \tloongarch*-*-*)\n@@ -5815,7 +5830,7 @@ case ${target} in\n esac\n \n t=\n-all_defaults=\"abi cpu cpu_32 cpu_64 arch arch_32 arch_64 tune tune_32 tune_64 schedule float mode fpu nan fp_32 odd_spreg_32 divide llsc mips-plt synci tls lxc1-sxc1 madd4 isa_spec compact-branches\"\n+all_defaults=\"abi cpu cpu_32 cpu_64 arch arch_32 arch_64 tune tune_32 tune_64 schedule float mode fpu nan fp_32 odd_spreg_32 divide llsc mips-plt synci tls lxc1-sxc1 madd4 isa_spec compact-branches msa\"\n for option in $all_defaults\n do\n \teval \"val=\\$with_\"`echo $option | sed s/-/_/g`"}, {"sha": "6daf6d37165bfdd878baa76059f6ae5464fa619d", "filename": "gcc/config/mips/mips.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f2b846f1feb6a1bbca0b85d2db66b92787bc0891/gcc%2Fconfig%2Fmips%2Fmips.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f2b846f1feb6a1bbca0b85d2db66b92787bc0891/gcc%2Fconfig%2Fmips%2Fmips.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.h?ref=f2b846f1feb6a1bbca0b85d2db66b92787bc0891", "patch": "@@ -916,7 +916,8 @@ struct mips_cpu_info {\n   {\"synci\", \"%{!msynci:%{!mno-synci:-m%(VALUE)}}\" },\t\t\t\\\n   {\"lxc1-sxc1\", \"%{!mlxc1-sxc1:%{!mno-lxc1-sxc1:-m%(VALUE)}}\" }, \\\n   {\"madd4\", \"%{!mmadd4:%{!mno-madd4:-m%(VALUE)}}\" }, \\\n-  {\"compact-branches\", \"%{!mcompact-branches=*:-mcompact-branches=%(VALUE)}\" } \\\n+  {\"compact-branches\", \"%{!mcompact-branches=*:-mcompact-branches=%(VALUE)}\" }, \\\n+  {\"msa\", \"%{!mmsa:%{!mno-msa:-m%(VALUE)}}\" } \\\n \n /* A spec that infers the:\n    -mnan=2008 setting from a -mips argument,"}, {"sha": "9133c8f8543bc7917ad5895a5b8f0b2df3ee5450", "filename": "gcc/doc/install.texi", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f2b846f1feb6a1bbca0b85d2db66b92787bc0891/gcc%2Fdoc%2Finstall.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f2b846f1feb6a1bbca0b85d2db66b92787bc0891/gcc%2Fdoc%2Finstall.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finstall.texi?ref=f2b846f1feb6a1bbca0b85d2db66b92787bc0891", "patch": "@@ -1653,6 +1653,14 @@ unfused is normally expected).  Disabling these instructions is the\n only way to ensure compatible code is generated; this will incur\n a performance penalty.\n \n+@item --with-msa\n+On MIPS targets, make @option{-mmsa} the default when no\n+@option{-mno-msa} option is passed.\n+\n+@item --without-msa\n+On MIPS targets, make @option{-mno-msa} the default when no\n+@option{-mmsa} option is passed. This is the default.\n+\n @item --with-mips-plt\n On MIPS targets, make use of copy relocations and PLTs.\n These features are extensions to the traditional"}]}