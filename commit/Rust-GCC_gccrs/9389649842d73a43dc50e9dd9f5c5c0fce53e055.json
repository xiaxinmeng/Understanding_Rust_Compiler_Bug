{"sha": "9389649842d73a43dc50e9dd9f5c5c0fce53e055", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTM4OTY0OTg0MmQ3M2E0M2RjNTBlOWRkOWY1YzVjMGZjZTUzZTA1NQ==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2014-06-29T02:49:45Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2014-06-29T02:49:45Z"}, "message": "re PR libfortran/61640 (KIND=4 Character Array Internal Unit Read Fail)\n\n2014-06-28  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n\n\tPR libgfortran/61640\n\t* io/list_read.c (next_char_internal): Adjust the read length to\n\ta single wide character. (eat_spaces): Add missing paren. \n\t* io/unix.c (mem_read4): Use the correct mem_alloc function for\n\twide character internal reads.\n\nFrom-SVN: r212118", "tree": {"sha": "17f01f33c20a91178bd54baf36472975f9e50cd3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/17f01f33c20a91178bd54baf36472975f9e50cd3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9389649842d73a43dc50e9dd9f5c5c0fce53e055", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9389649842d73a43dc50e9dd9f5c5c0fce53e055", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9389649842d73a43dc50e9dd9f5c5c0fce53e055", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9389649842d73a43dc50e9dd9f5c5c0fce53e055/comments", "author": null, "committer": null, "parents": [{"sha": "7d90d0e1df9b9afddb35c2147b48ee11a3389c34", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d90d0e1df9b9afddb35c2147b48ee11a3389c34", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7d90d0e1df9b9afddb35c2147b48ee11a3389c34"}], "stats": {"total": 16, "additions": 12, "deletions": 4}, "files": [{"sha": "10761e1c57c767e3abb72955fc11e4596f18bf15", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9389649842d73a43dc50e9dd9f5c5c0fce53e055/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9389649842d73a43dc50e9dd9f5c5c0fce53e055/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=9389649842d73a43dc50e9dd9f5c5c0fce53e055", "patch": "@@ -1,3 +1,11 @@\n+2014-06-28  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\tPR libgfortran/61640\n+\t* io/list_read.c (next_char_internal): Adjust the read length to\n+\ta single wide character. (eat_spaces): Add missing paren. \n+\t* io/unix.c (mem_read4): Use the correct mem_alloc function for\n+\twide character internal reads.\n+\n 2014-06-28  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n \n \tPR fortran/29383"}, {"sha": "1cb329f7df41bee13fc35d5ee0429280b51be443", "filename": "libgfortran/io/list_read.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9389649842d73a43dc50e9dd9f5c5c0fce53e055/libgfortran%2Fio%2Flist_read.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9389649842d73a43dc50e9dd9f5c5c0fce53e055/libgfortran%2Fio%2Flist_read.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Flist_read.c?ref=9389649842d73a43dc50e9dd9f5c5c0fce53e055", "patch": "@@ -273,7 +273,7 @@ next_char_internal (st_parameter_dt *dtp)\n   /* Get the next character and handle end-of-record conditions.  */\n \n   if (dtp->common.unit) /* Check for kind=4 internal unit.  */\n-   length = sread (dtp->u.p.current_unit->s, &c, sizeof (gfc_char4_t));\n+   length = sread (dtp->u.p.current_unit->s, &c, 1);\n   else\n    {\n      char cc;\n@@ -399,7 +399,7 @@ eat_spaces (st_parameter_dt *dtp)\n \t{\n \t  for (i = 0; i < dtp->u.p.current_unit->bytes_left; i++)\n \t    {\n-\t      if (dtp->internal_unit[offset + i * sizeof (gfc_char4_t)]\n+\t      if (dtp->internal_unit[(offset + i) * sizeof (gfc_char4_t)]\n \t\t  != (gfc_char4_t)' ')\n \t        break;\n \t    }"}, {"sha": "9ad293b60a462e85af3f9e053e28a276f90aed39", "filename": "libgfortran/io/unix.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9389649842d73a43dc50e9dd9f5c5c0fce53e055/libgfortran%2Fio%2Funix.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9389649842d73a43dc50e9dd9f5c5c0fce53e055/libgfortran%2Fio%2Funix.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Funix.c?ref=9389649842d73a43dc50e9dd9f5c5c0fce53e055", "patch": "@@ -808,10 +808,10 @@ mem_read4 (stream * s, void * buf, ssize_t nbytes)\n   void *p;\n   int nb = nbytes;\n \n-  p = mem_alloc_r (s, &nb);\n+  p = mem_alloc_r4 (s, &nb);\n   if (p)\n     {\n-      memcpy (buf, p, nb);\n+      memcpy (buf, p, nb * 4);\n       return (ssize_t) nb;\n     }\n   else"}]}