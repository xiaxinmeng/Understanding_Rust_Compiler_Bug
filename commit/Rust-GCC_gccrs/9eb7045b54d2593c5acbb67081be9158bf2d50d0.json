{"sha": "9eb7045b54d2593c5acbb67081be9158bf2d50d0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWViNzA0NWI1NGQyNTkzYzVhY2JiNjcwODFiZTkxNThiZjJkNTBkMA==", "commit": {"author": {"name": "Vladimir Makarov", "email": "vmakarov@redhat.com", "date": "2017-01-27T16:50:11Z"}, "committer": {"name": "Vladimir Makarov", "email": "vmakarov@gcc.gnu.org", "date": "2017-01-27T16:50:11Z"}, "message": "re PR target/79131 (ICE: in extract_constrain_insn, at recog.c:2213, big-endian ARM)\n\n2017-01-27  Vladimir Makarov  <vmakarov@redhat.com>\n\n\tPR target/79131\n\t* lra-assigns.c (find_hard_regno_for_1): Take endianess for into\n\taccount to calculate conflict_set.\n\n2017-01-27  Vladimir Makarov  <vmakarov@redhat.com>\n\n\tPR target/79131\n\t* gcc.target/arm/pr79131.c: Rename to gcc.target/arm/pr79131-1.c.\n\t* gcc.target/arm/pr79131-2.c: New.\n\nFrom-SVN: r244989", "tree": {"sha": "e9688fe66da9e2c94bf537233712fc7912a3393c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e9688fe66da9e2c94bf537233712fc7912a3393c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9eb7045b54d2593c5acbb67081be9158bf2d50d0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9eb7045b54d2593c5acbb67081be9158bf2d50d0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9eb7045b54d2593c5acbb67081be9158bf2d50d0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9eb7045b54d2593c5acbb67081be9158bf2d50d0/comments", "author": {"login": "vnmakarov", "id": 9855671, "node_id": "MDQ6VXNlcjk4NTU2NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/9855671?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vnmakarov", "html_url": "https://github.com/vnmakarov", "followers_url": "https://api.github.com/users/vnmakarov/followers", "following_url": "https://api.github.com/users/vnmakarov/following{/other_user}", "gists_url": "https://api.github.com/users/vnmakarov/gists{/gist_id}", "starred_url": "https://api.github.com/users/vnmakarov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vnmakarov/subscriptions", "organizations_url": "https://api.github.com/users/vnmakarov/orgs", "repos_url": "https://api.github.com/users/vnmakarov/repos", "events_url": "https://api.github.com/users/vnmakarov/events{/privacy}", "received_events_url": "https://api.github.com/users/vnmakarov/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "20f058d0986d8e7f81c1e45217b6d4c361dc089b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/20f058d0986d8e7f81c1e45217b6d4c361dc089b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/20f058d0986d8e7f81c1e45217b6d4c361dc089b"}], "stats": {"total": 94, "additions": 68, "deletions": 26}, "files": [{"sha": "2c90d06c8d44cc0998eacfe1a983b12e5985ba4c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9eb7045b54d2593c5acbb67081be9158bf2d50d0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9eb7045b54d2593c5acbb67081be9158bf2d50d0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9eb7045b54d2593c5acbb67081be9158bf2d50d0", "patch": "@@ -1,3 +1,9 @@\n+2017-01-27  Vladimir Makarov  <vmakarov@redhat.com>\n+\n+\tPR target/79131\n+\t* lra-assigns.c (find_hard_regno_for_1): Take endianess for into\n+\taccount to calculate conflict_set.\n+\n 2017-01-27  Bin Cheng  <bin.cheng@arm.com>\n \n \tPR rtl-optimization/78559"}, {"sha": "0ccd42546b71778db5d9efdd1b6eb7d9e7dcbd5d", "filename": "gcc/lra-assigns.c", "status": "modified", "additions": 39, "deletions": 26, "changes": 65, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9eb7045b54d2593c5acbb67081be9158bf2d50d0/gcc%2Flra-assigns.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9eb7045b54d2593c5acbb67081be9158bf2d50d0/gcc%2Flra-assigns.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flra-assigns.c?ref=9eb7045b54d2593c5acbb67081be9158bf2d50d0", "patch": "@@ -564,32 +564,45 @@ find_hard_regno_for_1 (int regno, int *cost, int try_only_hard_regno,\n   offset = lra_reg_info[regno].offset;\n   CLEAR_HARD_REG_SET (impossible_start_hard_regs);\n   EXECUTE_IF_SET_IN_SPARSESET (live_range_hard_reg_pseudos, conflict_regno)\n-    if (lra_reg_val_equal_p (conflict_regno, val, offset))\n-      {\n-\tconflict_hr = live_pseudos_reg_renumber[conflict_regno];\n-\tnregs = (hard_regno_nregs[conflict_hr]\n-\t\t [lra_reg_info[conflict_regno].biggest_mode]);\n-\t/* Remember about multi-register pseudos.  For example, 2 hard\n-\t   register pseudos can start on the same hard register but can\n-\t   not start on HR and HR+1/HR-1.  */\n-\tfor (hr = conflict_hr + 1;\n-\t     hr < FIRST_PSEUDO_REGISTER && hr < conflict_hr + nregs;\n-\t     hr++)\n-\t  SET_HARD_REG_BIT (impossible_start_hard_regs, hr);\n-\tfor (hr = conflict_hr - 1;\n-\t     hr >= 0 && hr + hard_regno_nregs[hr][biggest_mode] > conflict_hr;\n-\t     hr--)\n-\t  SET_HARD_REG_BIT (impossible_start_hard_regs, hr);\n-      }\n-    else\n-      {\n-\tadd_to_hard_reg_set (&conflict_set,\n-\t\t\t     lra_reg_info[conflict_regno].biggest_mode,\n-\t\t\t     live_pseudos_reg_renumber[conflict_regno]);\n-\tif (hard_reg_set_subset_p (reg_class_contents[rclass],\n-\t\t\t\t   conflict_set))\n-\t  return -1;\n-      }\n+    {\n+      conflict_hr = live_pseudos_reg_renumber[conflict_regno];\n+      if (lra_reg_val_equal_p (conflict_regno, val, offset))\n+\t{\n+\t  conflict_hr = live_pseudos_reg_renumber[conflict_regno];\n+\t  nregs = (hard_regno_nregs[conflict_hr]\n+\t\t   [lra_reg_info[conflict_regno].biggest_mode]);\n+\t  /* Remember about multi-register pseudos.  For example, 2\n+\t     hard register pseudos can start on the same hard register\n+\t     but can not start on HR and HR+1/HR-1.  */\n+\t  for (hr = conflict_hr + 1;\n+\t       hr < FIRST_PSEUDO_REGISTER && hr < conflict_hr + nregs;\n+\t       hr++)\n+\t    SET_HARD_REG_BIT (impossible_start_hard_regs, hr);\n+\t  for (hr = conflict_hr - 1;\n+\t       hr >= 0 && hr + hard_regno_nregs[hr][biggest_mode] > conflict_hr;\n+\t       hr--)\n+\t    SET_HARD_REG_BIT (impossible_start_hard_regs, hr);\n+\t}\n+      else\n+\t{\n+\t  enum machine_mode biggest_conflict_mode\n+\t    = lra_reg_info[conflict_regno].biggest_mode;\n+\t  int biggest_conflict_nregs\n+\t    = hard_regno_nregs[conflict_hr][biggest_conflict_mode];\n+\t  \n+\t  nregs_diff = (biggest_conflict_nregs\n+\t\t\t- (hard_regno_nregs\n+\t\t\t   [conflict_hr]\n+\t\t\t   [PSEUDO_REGNO_MODE (conflict_regno)]));\n+\t  add_to_hard_reg_set (&conflict_set,\n+\t\t\t       biggest_conflict_mode,\n+\t\t\t       conflict_hr\n+\t\t\t       - (WORDS_BIG_ENDIAN ? nregs_diff : 0));\n+\t  if (hard_reg_set_subset_p (reg_class_contents[rclass],\n+\t\t\t\t     conflict_set))\n+\t    return -1;\n+\t}\n+    }\n   EXECUTE_IF_SET_IN_SPARSESET (conflict_reload_and_inheritance_pseudos,\n \t\t\t       conflict_regno)\n     if (!lra_reg_val_equal_p (conflict_regno, val, offset))"}, {"sha": "9b164d304781178d708400cb0cd8c917d370f94c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9eb7045b54d2593c5acbb67081be9158bf2d50d0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9eb7045b54d2593c5acbb67081be9158bf2d50d0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9eb7045b54d2593c5acbb67081be9158bf2d50d0", "patch": "@@ -1,3 +1,9 @@\n+2017-01-27  Vladimir Makarov  <vmakarov@redhat.com>\n+\n+\tPR target/79131\n+\t* gcc.target/arm/pr79131.c: Rename to gcc.target/arm/pr79131-1.c.\n+\t* gcc.target/arm/pr79131-2.c: New.\n+\n 2017-01-27  Bill Schmidt  <wschmidt@linux.vnet.ibm.com>\n \n \tPR target/65484"}, {"sha": "3bd9e0fd935366dd60646c7d44c21f209e957200", "filename": "gcc/testsuite/gcc.target/arm/pr79131-1.c", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9eb7045b54d2593c5acbb67081be9158bf2d50d0/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fpr79131-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9eb7045b54d2593c5acbb67081be9158bf2d50d0/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fpr79131-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fpr79131-1.c?ref=9eb7045b54d2593c5acbb67081be9158bf2d50d0", "previous_filename": "gcc/testsuite/gcc.target/arm/pr79131.c"}, {"sha": "a670f0fec2b2c29d216efa43de35b5dac660719c", "filename": "gcc/testsuite/gcc.target/arm/pr79131-2.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9eb7045b54d2593c5acbb67081be9158bf2d50d0/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fpr79131-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9eb7045b54d2593c5acbb67081be9158bf2d50d0/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fpr79131-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fpr79131-2.c?ref=9eb7045b54d2593c5acbb67081be9158bf2d50d0", "patch": "@@ -0,0 +1,17 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -mbig-endian\" } */\n+\n+struct nilfs_segment_usage {\n+  int su_flags;\n+} a;\n+enum { NILFS_SEGMENT_USAGE_ACTIVE, NILFS_SEGMENT_USAGE_DIRTY } fn1();\n+int b;\n+void fn2(int *, long long);\n+void fn3() {\n+  int c, d;\n+  struct nilfs_segment_usage e = a;\n+  fn1();\n+  c = e.su_flags & 1 << NILFS_SEGMENT_USAGE_DIRTY;\n+  d = c;\n+  fn2(&b, d ? -1 : 0);\n+}"}]}