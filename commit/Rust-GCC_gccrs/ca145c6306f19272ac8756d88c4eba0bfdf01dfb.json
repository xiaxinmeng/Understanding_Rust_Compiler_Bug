{"sha": "ca145c6306f19272ac8756d88c4eba0bfdf01dfb", "node_id": "C_kwDOANBUbNoAKGNhMTQ1YzYzMDZmMTkyNzJhYzg3NTZkODhjNGViYTBiZmRmMDFkZmI", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2022-04-13T12:53:40Z"}, "committer": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2022-04-13T13:59:14Z"}, "message": "tree-optimization/105263 - reassoc and DFP\n\nreassoc has certain tricks which in the end depend on the ability\nto undo them.  For DFP creating a -1. constant is easy but\nre-identifying is appearantly not - real_minus_onep rejects those\noutright for DFP.  So we have to disable (at least) this one trick.\n\n2022-04-13  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/105263\n\t* tree-ssa-reassoc.cc (try_special_add_to_ops): Do not consume\n\tnegates in multiplication chains with DFP.\n\n\t* gcc.dg/pr105263.c: New testcase.", "tree": {"sha": "c5660dd0a8056f52cf7b1ead2effeb4c986d6672", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c5660dd0a8056f52cf7b1ead2effeb4c986d6672"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ca145c6306f19272ac8756d88c4eba0bfdf01dfb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ca145c6306f19272ac8756d88c4eba0bfdf01dfb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ca145c6306f19272ac8756d88c4eba0bfdf01dfb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ca145c6306f19272ac8756d88c4eba0bfdf01dfb/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "29c46490de4616b911fccb34a9479f768fb51e94", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/29c46490de4616b911fccb34a9479f768fb51e94", "html_url": "https://github.com/Rust-GCC/gccrs/commit/29c46490de4616b911fccb34a9479f768fb51e94"}], "stats": {"total": 19, "additions": 18, "deletions": 1}, "files": [{"sha": "5cb7fcd09a256cd877b8fdb302fb9516ed64309b", "filename": "gcc/testsuite/gcc.dg/pr105263.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca145c6306f19272ac8756d88c4eba0bfdf01dfb/gcc%2Ftestsuite%2Fgcc.dg%2Fpr105263.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca145c6306f19272ac8756d88c4eba0bfdf01dfb/gcc%2Ftestsuite%2Fgcc.dg%2Fpr105263.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr105263.c?ref=ca145c6306f19272ac8756d88c4eba0bfdf01dfb", "patch": "@@ -0,0 +1,15 @@\n+/* { dg-do compile { target dfp } } */\n+/* { dg-options \"-O -ffast-math -w -Wno-psabi\" } */\n+\n+typedef _Decimal64 __attribute__((__vector_size__ (8))) U;\n+typedef _Decimal64 __attribute__((__vector_size__ (16))) V;\n+\n+V v;\n+\n+U\n+foo (U u)\n+{\n+  u *= u;\n+  u *= -(U){ v[1] };\n+  return u;\n+}"}, {"sha": "f41b3c9a004c465e7af127deabfe0f95f9d39157", "filename": "gcc/tree-ssa-reassoc.cc", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca145c6306f19272ac8756d88c4eba0bfdf01dfb/gcc%2Ftree-ssa-reassoc.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca145c6306f19272ac8756d88c4eba0bfdf01dfb/gcc%2Ftree-ssa-reassoc.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-reassoc.cc?ref=ca145c6306f19272ac8756d88c4eba0bfdf01dfb", "patch": "@@ -5857,7 +5857,9 @@ try_special_add_to_ops (vec<operand_entry *> *ops,\n \t   && gimple_assign_rhs_code (def_stmt) == NEGATE_EXPR\n \t   && !HONOR_SNANS (TREE_TYPE (op))\n \t   && (!HONOR_SIGNED_ZEROS (TREE_TYPE (op))\n-\t       || !COMPLEX_FLOAT_TYPE_P (TREE_TYPE (op))))\n+\t       || !COMPLEX_FLOAT_TYPE_P (TREE_TYPE (op)))\n+\t   && (!FLOAT_TYPE_P (TREE_TYPE (op))\n+\t       || !DECIMAL_FLOAT_MODE_P (element_mode (op))))\n     {\n       tree rhs1 = gimple_assign_rhs1 (def_stmt);\n       tree cst = build_minus_one_cst (TREE_TYPE (op));"}]}