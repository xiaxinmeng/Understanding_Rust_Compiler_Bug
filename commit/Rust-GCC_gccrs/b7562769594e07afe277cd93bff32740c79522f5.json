{"sha": "b7562769594e07afe277cd93bff32740c79522f5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yjc1NjI3Njk1OTRlMDdhZmUyNzdjZDkzYmZmMzI3NDBjNzk1MjJmNQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2011-10-20T10:56:08Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2011-10-20T10:56:08Z"}, "message": "back_end.adb (Call_Back_End): Pass the maximum logical line number instead of the maximum physical line...\n\n\t* back_end.adb (Call_Back_End): Pass the maximum logical line number\n\tinstead of the maximum physical line number to gigi.\n\t* gcc-interface/trans.c (Sloc_to_locus): Cope with line zero.\n\nFrom-SVN: r180242", "tree": {"sha": "d9bd48a25fe74857f4b658b9278b9f09aa41a36a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d9bd48a25fe74857f4b658b9278b9f09aa41a36a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b7562769594e07afe277cd93bff32740c79522f5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7562769594e07afe277cd93bff32740c79522f5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b7562769594e07afe277cd93bff32740c79522f5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7562769594e07afe277cd93bff32740c79522f5/comments", "author": null, "committer": null, "parents": [{"sha": "687adac02dad2cd7f2e175dabd2156925bf81e45", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/687adac02dad2cd7f2e175dabd2156925bf81e45", "html_url": "https://github.com/Rust-GCC/gccrs/commit/687adac02dad2cd7f2e175dabd2156925bf81e45"}], "stats": {"total": 34, "additions": 33, "deletions": 1}, "files": [{"sha": "8b0c58a2258c23ab52d5ca29b4713ec9e12f5b15", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7562769594e07afe277cd93bff32740c79522f5/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7562769594e07afe277cd93bff32740c79522f5/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=b7562769594e07afe277cd93bff32740c79522f5", "patch": "@@ -1,3 +1,9 @@\n+2011-10-20  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* back_end.adb (Call_Back_End): Pass the maximum logical line number\n+\tinstead of the maximum physical line number to gigi.\n+\t* gcc-interface/trans.c (Sloc_to_locus): Cope with line zero.\n+\n 2011-10-16  Tom Tromey  <tromey@redhat.com>\n \t    Dodji Seketeli  <dodji@redhat.com>\n "}, {"sha": "b6ad263c232d8470b073391b4ba422aaf14c82e8", "filename": "gcc/ada/back_end.adb", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7562769594e07afe277cd93bff32740c79522f5/gcc%2Fada%2Fback_end.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7562769594e07afe277cd93bff32740c79522f5/gcc%2Fada%2Fback_end.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fback_end.adb?ref=b7562769594e07afe277cd93bff32740c79522f5", "patch": "@@ -114,9 +114,13 @@ package body Back_End is\n          return;\n       end if;\n \n+      --  The back end needs to know the maximum line number that can appear\n+      --  in a Sloc, in other words the maximum logical line number.\n+\n       for J in 1 .. Last_Source_File loop\n          File_Info_Array (J).File_Name        := Full_Debug_Name (J);\n-         File_Info_Array (J).Num_Source_Lines := Num_Source_Lines (J);\n+         File_Info_Array (J).Num_Source_Lines :=\n+           Nat (Physical_To_Logical (Last_Source_Line (J), J));\n       end loop;\n \n       if Generate_SCIL then"}, {"sha": "ba47a7e373ebca4d22d4d51d40e64a1a08664adf", "filename": "gcc/ada/gcc-interface/trans.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7562769594e07afe277cd93bff32740c79522f5/gcc%2Fada%2Fgcc-interface%2Ftrans.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7562769594e07afe277cd93bff32740c79522f5/gcc%2Fada%2Fgcc-interface%2Ftrans.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Ftrans.c?ref=b7562769594e07afe277cd93bff32740c79522f5", "patch": "@@ -8393,6 +8393,10 @@ Sloc_to_locus (Source_Ptr Sloc, location_t *locus)\n       Column_Number column = Get_Column_Number (Sloc);\n       struct line_map *map = LINEMAPS_ORDINARY_MAP_AT (line_table, file - 1);\n \n+      /* We can have zero if pragma Source_Reference is in effect.  */\n+      if (line < 1)\n+\tline = 1;\n+\n       /* Translate the location.  */\n       *locus = linemap_position_for_line_and_column (map, line, column);\n     }"}, {"sha": "654beee233e5cade14210196d931b18a74d543c2", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7562769594e07afe277cd93bff32740c79522f5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7562769594e07afe277cd93bff32740c79522f5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b7562769594e07afe277cd93bff32740c79522f5", "patch": "@@ -1,3 +1,8 @@\n+2011-10-20  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/source_ref1.adb: New test.\n+\t* gnat.dg/source_ref2.adb: Likewise.\n+\n 2011-10-19  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/13657"}, {"sha": "fd450cc45dbbce7d6b4e942cf62e1d8143b9e544", "filename": "gcc/testsuite/gnat.dg/source_ref1.adb", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7562769594e07afe277cd93bff32740c79522f5/gcc%2Ftestsuite%2Fgnat.dg%2Fsource_ref1.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7562769594e07afe277cd93bff32740c79522f5/gcc%2Ftestsuite%2Fgnat.dg%2Fsource_ref1.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fsource_ref1.adb?ref=b7562769594e07afe277cd93bff32740c79522f5", "patch": "@@ -0,0 +1,6 @@\n+pragma Source_Reference (3, \"p1.adb\");\n+\n+procedure Source_Ref1 is\n+begin\n+   null;\n+end;"}, {"sha": "cc2d57655e2d1a68ddf0173d99f2cf071a41fcda", "filename": "gcc/testsuite/gnat.dg/source_ref2.adb", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7562769594e07afe277cd93bff32740c79522f5/gcc%2Ftestsuite%2Fgnat.dg%2Fsource_ref2.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7562769594e07afe277cd93bff32740c79522f5/gcc%2Ftestsuite%2Fgnat.dg%2Fsource_ref2.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fsource_ref2.adb?ref=b7562769594e07afe277cd93bff32740c79522f5", "patch": "@@ -0,0 +1,7 @@\n+pragma Source_Reference (1, \"p2.adb\");\n+\n+procedure Source_Ref2 is\n+pragma Source_Reference (2, \"p2.adb\");\n+begin\n+   null;\n+end;"}]}