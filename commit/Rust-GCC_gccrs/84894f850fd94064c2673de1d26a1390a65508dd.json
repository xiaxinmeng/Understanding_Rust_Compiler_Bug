{"sha": "84894f850fd94064c2673de1d26a1390a65508dd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODQ4OTRmODUwZmQ5NDA2NGMyNjczZGUxZDI2YTEzOTBhNjU1MDhkZA==", "commit": {"author": {"name": "Dodji Seketeli", "email": "dodji@redhat.com", "date": "2009-12-03T08:33:03Z"}, "committer": {"name": "Dodji Seketeli", "email": "dodji@gcc.gnu.org", "date": "2009-12-03T08:33:03Z"}, "message": "re PR c++/42217 (ICE with zero-length bit-field)\n\nFix PR c++/42217\n\ngcc/cp/ChangeLog\n\tPR c++/42217\n\t* class.c (remove_zero_width_bit_fields): The width of the bit field is\n\tin DECL_SIZE, not in DECL_INITIAL.\n\ngcc/testsuite/ChangeLog\n\tPR c++/42217\n\t* g++.dg/other/bitfield4.C: New test.\n\nFrom-SVN: r154938", "tree": {"sha": "801fa0d123db0311962b9a816fed19689206532c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/801fa0d123db0311962b9a816fed19689206532c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/84894f850fd94064c2673de1d26a1390a65508dd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84894f850fd94064c2673de1d26a1390a65508dd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/84894f850fd94064c2673de1d26a1390a65508dd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84894f850fd94064c2673de1d26a1390a65508dd/comments", "author": null, "committer": null, "parents": [{"sha": "249ccaff220334750acbaf9351dd06b0fdcbde06", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/249ccaff220334750acbaf9351dd06b0fdcbde06", "html_url": "https://github.com/Rust-GCC/gccrs/commit/249ccaff220334750acbaf9351dd06b0fdcbde06"}], "stats": {"total": 28, "additions": 27, "deletions": 1}, "files": [{"sha": "f11ee70f04081dcfe86c75e8e24be4c31ed49b01", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84894f850fd94064c2673de1d26a1390a65508dd/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84894f850fd94064c2673de1d26a1390a65508dd/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=84894f850fd94064c2673de1d26a1390a65508dd", "patch": "@@ -1,3 +1,9 @@\n+2009-12-03  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tPR c++/42217\n+\t* class.c (remove_zero_width_bit_fields): The width of the bit field is\n+\tin DECL_SIZE, not in DECL_INITIAL.\n+\n 2009-12-03  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/42256"}, {"sha": "ca75bc15896fb476ffc4294c6e5cd2a263386544", "filename": "gcc/cp/class.c", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84894f850fd94064c2673de1d26a1390a65508dd/gcc%2Fcp%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84894f850fd94064c2673de1d26a1390a65508dd/gcc%2Fcp%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fclass.c?ref=84894f850fd94064c2673de1d26a1390a65508dd", "patch": "@@ -4254,7 +4254,12 @@ remove_zero_width_bit_fields (tree t)\n     {\n       if (TREE_CODE (*fieldsp) == FIELD_DECL\n \t  && DECL_C_BIT_FIELD (*fieldsp)\n-\t  && DECL_INITIAL (*fieldsp))\n+          /* We should not be confused by the fact that grokbitfield\n+\t     temporarily sets the width of the bit field into\n+\t     DECL_INITIAL (*fieldsp).\n+\t     check_bitfield_decl eventually sets DECL_SIZE (*fieldsp)\n+\t     to that width.  */\n+\t  && integer_zerop (DECL_SIZE (*fieldsp)))\n \t*fieldsp = TREE_CHAIN (*fieldsp);\n       else\n \tfieldsp = &TREE_CHAIN (*fieldsp);"}, {"sha": "550c13633053424d307cb6bfbe040d93fc26afc4", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84894f850fd94064c2673de1d26a1390a65508dd/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84894f850fd94064c2673de1d26a1390a65508dd/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=84894f850fd94064c2673de1d26a1390a65508dd", "patch": "@@ -1,3 +1,8 @@\n+2009-12-03  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tPR c++/42217\n+\t* g++.dg/other/bitfield4.C: New test.\n+\n 2009-12-03  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/42256"}, {"sha": "d140f82cb63a65b7eba0d5b90e1614efa18b3329", "filename": "gcc/testsuite/g++.dg/other/bitfield4.C", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84894f850fd94064c2673de1d26a1390a65508dd/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fbitfield4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84894f850fd94064c2673de1d26a1390a65508dd/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fbitfield4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fbitfield4.C?ref=84894f850fd94064c2673de1d26a1390a65508dd", "patch": "@@ -0,0 +1,10 @@\n+// Contributed by Dodji Seketeli <dodji@redhat.com>\n+// Origin PR c++/42217\n+// { dg-do compile }\n+\n+struct A\n+{\n+ int : 0;\n+};\n+A a = A();\n+"}]}