{"sha": "f782c65c3da796b4eb907daa55a160f1203ee5e6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Zjc4MmM2NWMzZGE3OTZiNGViOTA3ZGFhNTVhMTYwZjEyMDNlZTVlNg==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2008-12-04T19:00:03Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2008-12-04T19:00:03Z"}, "message": "re PR c++/37906 (has_trivial_default_constructor vs. deleted copy ctor)\n\n        PR c++/37906\n        * decl.c (grok_special_member_properties): Set TYPE_HAS_COMPLEX_DFLT\n        here.\n        * class.c (check_bases_and_members): Rather than assuming any\n        user-declared default constructor is complex here.\n\nFrom-SVN: r142442", "tree": {"sha": "175fb67e45c27c46f67a8bee4a79a8b083beec40", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/175fb67e45c27c46f67a8bee4a79a8b083beec40"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f782c65c3da796b4eb907daa55a160f1203ee5e6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f782c65c3da796b4eb907daa55a160f1203ee5e6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f782c65c3da796b4eb907daa55a160f1203ee5e6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f782c65c3da796b4eb907daa55a160f1203ee5e6/comments", "author": null, "committer": null, "parents": [{"sha": "1d9aba81050b524d9dd61e59f4b28382782051b3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1d9aba81050b524d9dd61e59f4b28382782051b3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1d9aba81050b524d9dd61e59f4b28382782051b3"}], "stats": {"total": 37, "additions": 33, "deletions": 4}, "files": [{"sha": "9c74714b7bee2e6ed4962a7f9e4619adbc402d4e", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f782c65c3da796b4eb907daa55a160f1203ee5e6/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f782c65c3da796b4eb907daa55a160f1203ee5e6/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=f782c65c3da796b4eb907daa55a160f1203ee5e6", "patch": "@@ -1,3 +1,11 @@\n+2008-12-04  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/37906\n+\t* decl.c (grok_special_member_properties): Set TYPE_HAS_COMPLEX_DFLT\n+\there.\n+\t* class.c (check_bases_and_members): Rather than assuming any\n+\tuser-declared default constructor is complex here.\n+\n 2008-12-04  Richard Guenther  <rguenther@suse.de>\n \n \tPR c++/38334\n@@ -179,7 +187,7 @@\n \t\n 2008-11-05  Fabien Chene <fabien.chene@gmail.com>\n \n-\tPR c++/35219\n+\tPR c++/32519\n \t* cp-tree.h: Fix DECL_NONSTATIC_MEMBER_P to handle member template\n \tfunctions.\n "}, {"sha": "8553139979ab95f216debbec515cff8f578900cc", "filename": "gcc/cp/class.c", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f782c65c3da796b4eb907daa55a160f1203ee5e6/gcc%2Fcp%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f782c65c3da796b4eb907daa55a160f1203ee5e6/gcc%2Fcp%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fclass.c?ref=f782c65c3da796b4eb907daa55a160f1203ee5e6", "patch": "@@ -4301,8 +4301,7 @@ check_bases_and_members (tree t)\n     |= (CLASSTYPE_NON_AGGREGATE (t)\n \t|| saved_nontrivial_dtor || saved_complex_asn_ref);\n   TYPE_HAS_COMPLEX_ASSIGN_REF (t) |= TYPE_CONTAINS_VPTR_P (t);\n-  TYPE_HAS_COMPLEX_DFLT (t)\n-    |= (TYPE_HAS_DEFAULT_CONSTRUCTOR (t) || TYPE_CONTAINS_VPTR_P (t));\n+  TYPE_HAS_COMPLEX_DFLT (t) |= TYPE_CONTAINS_VPTR_P (t);\n \n   /* If the class has no user-declared constructor, but does have\n      non-static const or reference data members that can never be"}, {"sha": "70ccd323f80798ae4a3fc09dd462350ed4a21df5", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f782c65c3da796b4eb907daa55a160f1203ee5e6/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f782c65c3da796b4eb907daa55a160f1203ee5e6/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=f782c65c3da796b4eb907daa55a160f1203ee5e6", "patch": "@@ -9842,7 +9842,11 @@ grok_special_member_properties (tree decl)\n \t    TYPE_HAS_CONST_INIT_REF (class_type) = 1;\n \t}\n       else if (sufficient_parms_p (FUNCTION_FIRST_USER_PARMTYPE (decl)))\n-\tTYPE_HAS_DEFAULT_CONSTRUCTOR (class_type) = 1;\n+\t{\n+\t  TYPE_HAS_DEFAULT_CONSTRUCTOR (class_type) = 1;\n+\t  if (TREE_CODE (decl) == TEMPLATE_DECL || !DECL_DEFAULTED_FN (decl))\n+\t    TYPE_HAS_COMPLEX_DFLT (class_type) = 1;\n+\t}\n       else if (is_list_ctor (decl))\n \tTYPE_HAS_LIST_CTOR (class_type) = 1;\n     }"}, {"sha": "9c9d674083cfc8038de778e06b17fcecb4737e97", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f782c65c3da796b4eb907daa55a160f1203ee5e6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f782c65c3da796b4eb907daa55a160f1203ee5e6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f782c65c3da796b4eb907daa55a160f1203ee5e6", "patch": "@@ -1,3 +1,8 @@\n+2008-12-04  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/37906\n+\t* g++.dg/cpp0x/defaulted6.C: New test.\n+\n 2008-12-04  Richard Guenther  <rguenther@suse.de>\n \n \tPR middle-end/36509"}, {"sha": "c33d5729223745e5cb208b4e8b50466487cf11c2", "filename": "gcc/testsuite/g++.dg/cpp0x/defaulted6.C", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f782c65c3da796b4eb907daa55a160f1203ee5e6/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fdefaulted6.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f782c65c3da796b4eb907daa55a160f1203ee5e6/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fdefaulted6.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fdefaulted6.C?ref=f782c65c3da796b4eb907daa55a160f1203ee5e6", "patch": "@@ -0,0 +1,13 @@\n+// PR c++/37906\n+// { dg-options \"-std=c++0x\" }\n+\n+struct b\n+{\n+  b() = default;\n+  b(const b&) = delete;\n+};\n+\n+void test01()\n+{\n+  static_assert(__has_trivial_constructor(b), \"default ctor not trivial\");\n+}"}]}