{"sha": "795dc4fc9010a608ed06857c4781f0c51b839431", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Nzk1ZGM0ZmM5MDEwYTYwOGVkMDY4NTdjNDc4MWYwYzUxYjgzOTQzMQ==", "commit": {"author": {"name": "Paul Brook", "email": "paul@codesourcery.com", "date": "2008-08-04T16:27:17Z"}, "committer": {"name": "Paul Brook", "email": "pbrook@gcc.gnu.org", "date": "2008-08-04T16:27:17Z"}, "message": "arm.c (thumb_core_reg_alloc_order): New.\n\n2008-08-04  Paul Brook  <paul@codesourcery.com>\n\n\tgcc/\n\t* cofig/arm/arm.c (thumb_core_reg_alloc_order): New.\n\t(arm_order_regs_for_local_alloc): New function.\n\t* config/arm/arm-protos.h (arm_order_regs_for_local_alloc): Add\n\tprototype.\n\t* config/arm/arm.h (ORDER_REGS_FOR_LOCAL_ALLOC): Define.\n\nFrom-SVN: r138640", "tree": {"sha": "7c8fe332e90fe048461d3ee6391e17764a0c3221", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7c8fe332e90fe048461d3ee6391e17764a0c3221"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/795dc4fc9010a608ed06857c4781f0c51b839431", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/795dc4fc9010a608ed06857c4781f0c51b839431", "html_url": "https://github.com/Rust-GCC/gccrs/commit/795dc4fc9010a608ed06857c4781f0c51b839431", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/795dc4fc9010a608ed06857c4781f0c51b839431/comments", "author": null, "committer": null, "parents": [{"sha": "367a9e66e0bf0f97e38dd4525887a8ed76a61a54", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/367a9e66e0bf0f97e38dd4525887a8ed76a61a54", "html_url": "https://github.com/Rust-GCC/gccrs/commit/367a9e66e0bf0f97e38dd4525887a8ed76a61a54"}], "stats": {"total": 37, "additions": 37, "deletions": 0}, "files": [{"sha": "51138d63eb19488b32624bab3d7443a64349bb33", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/795dc4fc9010a608ed06857c4781f0c51b839431/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/795dc4fc9010a608ed06857c4781f0c51b839431/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=795dc4fc9010a608ed06857c4781f0c51b839431", "patch": "@@ -1,3 +1,11 @@\n+2008-08-04  Paul Brook  <paul@codesourcery.com>\n+\n+\t* cofig/arm/arm.c (thumb_core_reg_alloc_order): New.\n+\t(arm_order_regs_for_local_alloc): New function.\n+\t* config/arm/arm-protos.h (arm_order_regs_for_local_alloc): Add\n+\tprototype.\n+\t* config/arm/arm.h (ORDER_REGS_FOR_LOCAL_ALLOC): Define.\n+\n 2008-08-04  H.J. Lu  <hongjiu.lu@intel.com>\n \n \tPR target/37012"}, {"sha": "bdf9a04416b9e9a7a2f0d06bd5f9013784166bc9", "filename": "gcc/config/arm/arm-protos.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/795dc4fc9010a608ed06857c4781f0c51b839431/gcc%2Fconfig%2Farm%2Farm-protos.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/795dc4fc9010a608ed06857c4781f0c51b839431/gcc%2Fconfig%2Farm%2Farm-protos.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm-protos.h?ref=795dc4fc9010a608ed06857c4781f0c51b839431", "patch": "@@ -208,4 +208,6 @@ extern void arm_lang_object_attributes_init(void);\n \n extern const char *arm_mangle_type (const_tree);\n \n+extern void arm_order_regs_for_local_alloc (void);\n+\n #endif /* ! GCC_ARM_PROTOS_H */"}, {"sha": "8b89904ffa18df9cd7c9373865e9ca037f9a83c4", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/795dc4fc9010a608ed06857c4781f0c51b839431/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/795dc4fc9010a608ed06857c4781f0c51b839431/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=795dc4fc9010a608ed06857c4781f0c51b839431", "patch": "@@ -19046,4 +19046,28 @@ arm_mangle_type (const_tree type)\n   return NULL;\n }\n \n+/* Order of allocation of core registers for Thumb: this allocation is\n+   written over the corresponding initial entries of the array\n+   initialized with REG_ALLOC_ORDER.  We allocate all low registers\n+   first.  Saving and restoring a low register is usually cheaper than\n+   using a call-clobbered high register.  */\n+\n+static const int thumb_core_reg_alloc_order[] =\n+{\n+   3,  2,  1,  0,  4,  5,  6,  7,\n+  14, 12,  8,  9, 10, 11, 13, 15\n+};\n+\n+/* Adjust register allocation order when compiling for Thumb.  */\n+\n+void\n+arm_order_regs_for_local_alloc (void)\n+{\n+  const int arm_reg_alloc_order[] = REG_ALLOC_ORDER;\n+  memcpy(reg_alloc_order, arm_reg_alloc_order, sizeof (reg_alloc_order));\n+  if (TARGET_THUMB)\n+    memcpy (reg_alloc_order, thumb_core_reg_alloc_order,\n+            sizeof (thumb_core_reg_alloc_order));\n+}\n+\n #include \"gt-arm.h\""}, {"sha": "2ab44c2448343f22b1815a9e1e172dae50343b92", "filename": "gcc/config/arm/arm.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/795dc4fc9010a608ed06857c4781f0c51b839431/gcc%2Fconfig%2Farm%2Farm.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/795dc4fc9010a608ed06857c4781f0c51b839431/gcc%2Fconfig%2Farm%2Farm.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.h?ref=795dc4fc9010a608ed06857c4781f0c51b839431", "patch": "@@ -1080,6 +1080,9 @@ extern int arm_structure_size_boundary;\n    127\t\t\t\t\t\t\\\n }\n \n+/* Use different register alloc ordering for Thumb.  */\n+#define ORDER_REGS_FOR_LOCAL_ALLOC arm_order_regs_for_local_alloc ()\n+\n /* Interrupt functions can only use registers that have already been\n    saved by the prologue, even if they would normally be\n    call-clobbered.  */"}]}