{"sha": "b094015443c17d6ef43ecfb77b01932701e3b4e4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjA5NDAxNTQ0M2MxN2Q2ZWY0M2VjZmI3N2IwMTkzMjcwMWUzYjRlNA==", "commit": {"author": {"name": "Andrew Pinski", "email": "andrew_pinski@playstation.sony.com", "date": "2008-03-06T21:56:04Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2008-03-06T21:56:04Z"}, "message": "re PR tree-optimization/35402 (Store CCP will not inline static const variable which is default initialized)\n\n2008-03-06  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n\n        PR tree-opt/35402\n        * tree-ssa-ccp.c (get_symbol_constant_value): Handle\n        integral and scalar float variables which have a\n        NULL DECL_INITIAL.\n\n2008-03-06  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n\n        PR tree-opt/35402\n        * gcc.dg/tree-ssa/ssa-store-ccp-1.c: New test.\n\nFrom-SVN: r132991", "tree": {"sha": "571a3a53a75436d921342817d1fe0b19f2685dc9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/571a3a53a75436d921342817d1fe0b19f2685dc9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b094015443c17d6ef43ecfb77b01932701e3b4e4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b094015443c17d6ef43ecfb77b01932701e3b4e4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b094015443c17d6ef43ecfb77b01932701e3b4e4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b094015443c17d6ef43ecfb77b01932701e3b4e4/comments", "author": null, "committer": null, "parents": [{"sha": "39897cdcb0e468dd683a554c1d76c410429d32bc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/39897cdcb0e468dd683a554c1d76c410429d32bc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/39897cdcb0e468dd683a554c1d76c410429d32bc"}], "stats": {"total": 32, "additions": 32, "deletions": 0}, "files": [{"sha": "d3a2325d2b6fa3587ce36752ec7bbbb9ad5d1b12", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b094015443c17d6ef43ecfb77b01932701e3b4e4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b094015443c17d6ef43ecfb77b01932701e3b4e4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b094015443c17d6ef43ecfb77b01932701e3b4e4", "patch": "@@ -1,3 +1,10 @@\n+2008-03-06  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n+\n+\tPR tree-opt/35402\n+\t* tree-ssa-ccp.c (get_symbol_constant_value): Handle\n+\tintegral and scalar float variables which have a\n+\tNULL DECL_INITIAL.\n+\n 2008-03-06  Nathan Froyd  <froydnj@codesourcery.com>\n \n \t* dwarf2out.c (dwarf2out_frame_debug_expr): Consult the"}, {"sha": "b24b8daa07b9e65f7e6e323c11c55ff9c11f6a78", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b094015443c17d6ef43ecfb77b01932701e3b4e4/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b094015443c17d6ef43ecfb77b01932701e3b4e4/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b094015443c17d6ef43ecfb77b01932701e3b4e4", "patch": "@@ -1,3 +1,8 @@\n+2008-03-06  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n+\n+\tPR tree-opt/35402\n+\t* gcc.dg/tree-ssa/ssa-store-ccp-1.c: New test.\n+\n 2008-03-06  Markus Milleder  <markus.milleder@generali.at>\n \n \tPR preprocessor/35458"}, {"sha": "aaa3d13cad4e8e4879b888ed0371269edaf7bc84", "filename": "gcc/testsuite/gcc.dg/tree-ssa/ssa-store-ccp-1.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b094015443c17d6ef43ecfb77b01932701e3b4e4/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fssa-store-ccp-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b094015443c17d6ef43ecfb77b01932701e3b4e4/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fssa-store-ccp-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fssa-store-ccp-1.c?ref=b094015443c17d6ef43ecfb77b01932701e3b4e4", "patch": "@@ -0,0 +1,14 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fdump-tree-optimized\" } */\n+\n+static const int conststaticvariable;\n+\n+int f(void)\n+{\n+  return conststaticvariable;\n+}\n+\n+/* There should be no reference to conststaticvariable as we should have\n+   inlined the 0. */\n+/* { dg-final { scan-tree-dump-times \"conststaticvariable\" 0 \"optimized\"} } */\n+/* { dg-final { cleanup-tree-dump \"optimized\" } } */"}, {"sha": "b9211a5df9c5d3d9058711988a56910da550f33b", "filename": "gcc/tree-ssa-ccp.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b094015443c17d6ef43ecfb77b01932701e3b4e4/gcc%2Ftree-ssa-ccp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b094015443c17d6ef43ecfb77b01932701e3b4e4/gcc%2Ftree-ssa-ccp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-ccp.c?ref=b094015443c17d6ef43ecfb77b01932701e3b4e4", "patch": "@@ -306,6 +306,12 @@ get_symbol_constant_value (tree sym)\n       if (val\n \t  && ccp_decl_initial_min_invariant (val))\n \treturn val;\n+      /* Variables declared 'const' without an initializer\n+\t have zero as the intializer.  */\n+      if (!val\n+          && (INTEGRAL_TYPE_P (TREE_TYPE (sym))\n+\t       || SCALAR_FLOAT_TYPE_P (TREE_TYPE (sym))))\n+        return fold_convert (TREE_TYPE (sym), integer_zero_node);\n     }\n \n   return NULL_TREE;"}]}