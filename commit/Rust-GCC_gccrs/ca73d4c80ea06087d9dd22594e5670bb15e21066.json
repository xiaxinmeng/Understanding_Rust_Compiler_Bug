{"sha": "ca73d4c80ea06087d9dd22594e5670bb15e21066", "node_id": "C_kwDOANBUbNoAKGNhNzNkNGM4MGVhMDYwODdkOWRkMjI1OTRlNTY3MGJiMTVlMjEwNjY", "commit": {"author": {"name": "Jeff Law", "email": "jeffreyalaw@gmail.com", "date": "2022-11-22T23:12:45Z"}, "committer": {"name": "Jeff Law", "email": "jeffreyalaw@gmail.com", "date": "2022-11-22T23:12:45Z"}, "message": "Fix recent rvv/base/spill testcase failures\n\nhe core issue is we're expecting the frame to have a constant size, but it\ndoesn't.  So when using the to_constant method we abort.\n\nThe safest thing to do is to set no shrink-wrapping components when the\nframe size is not fixed.  We might be able to do better later -- iff we\nknow the offset to the GPRs/FPRs is fixed and fits into the appropriate\nnumber of bits.\n\nBootstrapped and regression tested (C-only) on riscv64-linux-gnu.  As\nexpected, it fixes a bucketload of failures in rvv/base/spill-*.c.\n\ngcc/\n\t* config/riscv/riscv.cc (riscv_get_separate_components): Do not\n\tdo shrink-wrapping for a frame with a variable size.", "tree": {"sha": "351893a8857ff58a70c25557b2dc26f8e6eee83a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/351893a8857ff58a70c25557b2dc26f8e6eee83a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ca73d4c80ea06087d9dd22594e5670bb15e21066", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ca73d4c80ea06087d9dd22594e5670bb15e21066", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ca73d4c80ea06087d9dd22594e5670bb15e21066", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ca73d4c80ea06087d9dd22594e5670bb15e21066/comments", "author": {"login": "JeffreyALaw", "id": 14062506, "node_id": "MDQ6VXNlcjE0MDYyNTA2", "avatar_url": "https://avatars.githubusercontent.com/u/14062506?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JeffreyALaw", "html_url": "https://github.com/JeffreyALaw", "followers_url": "https://api.github.com/users/JeffreyALaw/followers", "following_url": "https://api.github.com/users/JeffreyALaw/following{/other_user}", "gists_url": "https://api.github.com/users/JeffreyALaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/JeffreyALaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JeffreyALaw/subscriptions", "organizations_url": "https://api.github.com/users/JeffreyALaw/orgs", "repos_url": "https://api.github.com/users/JeffreyALaw/repos", "events_url": "https://api.github.com/users/JeffreyALaw/events{/privacy}", "received_events_url": "https://api.github.com/users/JeffreyALaw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "JeffreyALaw", "id": 14062506, "node_id": "MDQ6VXNlcjE0MDYyNTA2", "avatar_url": "https://avatars.githubusercontent.com/u/14062506?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JeffreyALaw", "html_url": "https://github.com/JeffreyALaw", "followers_url": "https://api.github.com/users/JeffreyALaw/followers", "following_url": "https://api.github.com/users/JeffreyALaw/following{/other_user}", "gists_url": "https://api.github.com/users/JeffreyALaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/JeffreyALaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JeffreyALaw/subscriptions", "organizations_url": "https://api.github.com/users/JeffreyALaw/orgs", "repos_url": "https://api.github.com/users/JeffreyALaw/repos", "events_url": "https://api.github.com/users/JeffreyALaw/events{/privacy}", "received_events_url": "https://api.github.com/users/JeffreyALaw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e5cfb9cac1d7aba9a8ea73bfe7922cfaff9d61f3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e5cfb9cac1d7aba9a8ea73bfe7922cfaff9d61f3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e5cfb9cac1d7aba9a8ea73bfe7922cfaff9d61f3"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "7bfc0e9f595d7ee38c0afe1ffe36f387b05d5ab4", "filename": "gcc/config/riscv/riscv.cc", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca73d4c80ea06087d9dd22594e5670bb15e21066/gcc%2Fconfig%2Friscv%2Friscv.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca73d4c80ea06087d9dd22594e5670bb15e21066/gcc%2Fconfig%2Friscv%2Friscv.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Friscv.cc?ref=ca73d4c80ea06087d9dd22594e5670bb15e21066", "patch": "@@ -5340,7 +5340,8 @@ riscv_get_separate_components (void)\n   bitmap_clear (components);\n \n   if (riscv_use_save_libcall (&cfun->machine->frame)\n-      || cfun->machine->interrupt_handler_p)\n+      || cfun->machine->interrupt_handler_p\n+      || !cfun->machine->frame.gp_sp_offset.is_constant ())\n     return components;\n \n   offset = cfun->machine->frame.gp_sp_offset.to_constant ();"}]}