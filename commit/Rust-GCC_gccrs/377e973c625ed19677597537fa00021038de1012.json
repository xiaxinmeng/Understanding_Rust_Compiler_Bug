{"sha": "377e973c625ed19677597537fa00021038de1012", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Mzc3ZTk3M2M2MjVlZDE5Njc3NTk3NTM3ZmEwMDAyMTAzOGRlMTAxMg==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2016-09-21T11:00:02Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2016-09-21T11:00:02Z"}, "message": "dwarf2out.c (remove_child_with_prev): Clear child->die_sib.\n\n2016-09-21  Richard Biener  <rguenther@suse.de>\n\n\t* dwarf2out.c (remove_child_with_prev): Clear child->die_sib.\n\t(replace_child): Likewise.\n\t(remove_child_TAG): Adjust.\n\t(move_marked_base_types): Likewise.\n\t(prune_unused_types_prune): Clear die_sib of removed children.\n\nFrom-SVN: r240310", "tree": {"sha": "3c41b82a513833bd83554c241d540ce635308676", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3c41b82a513833bd83554c241d540ce635308676"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/377e973c625ed19677597537fa00021038de1012", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/377e973c625ed19677597537fa00021038de1012", "html_url": "https://github.com/Rust-GCC/gccrs/commit/377e973c625ed19677597537fa00021038de1012", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/377e973c625ed19677597537fa00021038de1012/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9ad5c32a217ab45edbf231d7ee56a1351aac84c7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ad5c32a217ab45edbf231d7ee56a1351aac84c7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ad5c32a217ab45edbf231d7ee56a1351aac84c7"}], "stats": {"total": 28, "additions": 22, "deletions": 6}, "files": [{"sha": "1862dabe5b5821442a0174c3fb7479d8996c8372", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/377e973c625ed19677597537fa00021038de1012/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/377e973c625ed19677597537fa00021038de1012/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=377e973c625ed19677597537fa00021038de1012", "patch": "@@ -1,3 +1,11 @@\n+2016-09-21  Richard Biener  <rguenther@suse.de>\n+\n+\t* dwarf2out.c (remove_child_with_prev): Clear child->die_sib.\n+\t(replace_child): Likewise.\n+\t(remove_child_TAG): Adjust.\n+\t(move_marked_base_types): Likewise.\n+\t(prune_unused_types_prune): Clear die_sib of removed children.\n+\n 2016-09-21  Georg-Johann Lay  <avr@gjlay.de>\n \n \tPR target/77326"}, {"sha": "4e4893f26a83443e4fd6838e68759590a25b191a", "filename": "gcc/dwarf2out.c", "status": "modified", "additions": 14, "deletions": 6, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/377e973c625ed19677597537fa00021038de1012/gcc%2Fdwarf2out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/377e973c625ed19677597537fa00021038de1012/gcc%2Fdwarf2out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.c?ref=377e973c625ed19677597537fa00021038de1012", "patch": "@@ -4892,6 +4892,7 @@ remove_child_with_prev (dw_die_ref child, dw_die_ref prev)\n     prev->die_sib = child->die_sib;\n   if (child->die_parent->die_child == child)\n     child->die_parent->die_child = prev;\n+  child->die_sib = NULL;\n }\n \n /* Replace OLD_CHILD with NEW_CHILD.  PREV must have the property that\n@@ -4918,6 +4919,7 @@ replace_child (dw_die_ref old_child, dw_die_ref new_child, dw_die_ref prev)\n     }\n   if (old_child->die_parent->die_child == old_child)\n     old_child->die_parent->die_child = new_child;\n+  old_child->die_sib = NULL;\n }\n \n /* Move all children from OLD_PARENT to NEW_PARENT.  */\n@@ -4948,9 +4950,9 @@ remove_child_TAG (dw_die_ref die, enum dwarf_tag tag)\n \tremove_child_with_prev (c, prev);\n \tc->die_parent = NULL;\n \t/* Might have removed every child.  */\n-\tif (c == c->die_sib)\n+\tif (die->die_child == NULL)\n \t  return;\n-\tc = c->die_sib;\n+\tc = prev->die_sib;\n       }\n   } while (c != die->die_child);\n }\n@@ -26208,8 +26210,8 @@ prune_unused_types_prune (dw_die_ref die)\n \n   c = die->die_child;\n   do {\n-    dw_die_ref prev = c;\n-    for (c = c->die_sib; ! c->die_mark; c = c->die_sib)\n+    dw_die_ref prev = c, next;\n+    for (c = c->die_sib; ! c->die_mark; c = next)\n       if (c == die->die_child)\n \t{\n \t  /* No marked children between 'prev' and the end of the list.  */\n@@ -26221,8 +26223,14 @@ prune_unused_types_prune (dw_die_ref die)\n \t      prev->die_sib = c->die_sib;\n \t      die->die_child = prev;\n \t    }\n+\t  c->die_sib = NULL;\n \t  return;\n \t}\n+      else\n+\t{\n+\t  next = c->die_sib;\n+\t  c->die_sib = NULL;\n+\t}\n \n     if (c != prev->die_sib)\n       prev->die_sib = c;\n@@ -26467,8 +26475,8 @@ move_marked_base_types (void)\n \t  remove_child_with_prev (c, prev);\n \t  /* As base types got marked, there must be at least\n \t     one node other than DW_TAG_base_type.  */\n-\t  gcc_assert (c != c->die_sib);\n-\t  c = c->die_sib;\n+\t  gcc_assert (die->die_child != NULL);\n+\t  c = prev->die_sib;\n \t}\n     }\n   while (c != die->die_child);"}]}