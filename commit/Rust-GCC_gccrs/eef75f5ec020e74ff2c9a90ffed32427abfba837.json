{"sha": "eef75f5ec020e74ff2c9a90ffed32427abfba837", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWVmNzVmNWVjMDIwZTc0ZmYyYzlhOTBmZmVkMzI0MjdhYmZiYTgzNw==", "commit": {"author": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2007-12-18T07:40:17Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2007-12-18T07:40:17Z"}, "message": "200x-xx-xx Kaz Kylheku <kaz@zeugmasystems.com>\n\ngcc/\n200x-xx-xx  Kaz Kylheku  <kaz@zeugmasystems.com>\n\n\tPR rtl-optimization/34456\n\t* resource.c (mark_set_resources): Use regs_invalidated_by_call\n\trather than call_used_regs and global_regs.\n\ngcc/testsuite/\n\tPR rtl-optimization/34456\n\t* gcc.c-torture/execute/pr34456.c: New test.\n\nFrom-SVN: r131033", "tree": {"sha": "5322d5e68639e47b06f7c6531dcdf93b7aa38e00", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5322d5e68639e47b06f7c6531dcdf93b7aa38e00"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/eef75f5ec020e74ff2c9a90ffed32427abfba837", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eef75f5ec020e74ff2c9a90ffed32427abfba837", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eef75f5ec020e74ff2c9a90ffed32427abfba837", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eef75f5ec020e74ff2c9a90ffed32427abfba837/comments", "author": null, "committer": null, "parents": [{"sha": "b6541c1068441d06393f9c93829138bc1340f4da", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b6541c1068441d06393f9c93829138bc1340f4da", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b6541c1068441d06393f9c93829138bc1340f4da"}], "stats": {"total": 46, "additions": 43, "deletions": 3}, "files": [{"sha": "a482ad855c62584dcc94aa3a084ee9dd50cefa78", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eef75f5ec020e74ff2c9a90ffed32427abfba837/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eef75f5ec020e74ff2c9a90ffed32427abfba837/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=eef75f5ec020e74ff2c9a90ffed32427abfba837", "patch": "@@ -1,3 +1,9 @@\n+2007-12-18  Kaz Kylheku  <kaz@zeugmasystems.com>\n+\n+\tPR rtl-optimization/34456\n+\t* resource.c (mark_set_resources): Use regs_invalidated_by_call\n+\trather than call_used_regs and global_regs.\n+\n 2007-12-18  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR rtl-optimization/34490"}, {"sha": "d7e3339aa9079cec9007314019679fee076168fd", "filename": "gcc/resource.c", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eef75f5ec020e74ff2c9a90ffed32427abfba837/gcc%2Fresource.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eef75f5ec020e74ff2c9a90ffed32427abfba837/gcc%2Fresource.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fresource.c?ref=eef75f5ec020e74ff2c9a90ffed32427abfba837", "patch": "@@ -663,9 +663,8 @@ mark_set_resources (rtx x, struct resources *res, int in_dest,\n \t  rtx link;\n \n \t  res->cc = res->memory = 1;\n-\t  for (r = 0; r < FIRST_PSEUDO_REGISTER; r++)\n-\t    if (call_used_regs[r] || global_regs[r])\n-\t      SET_HARD_REG_BIT (res->regs, r);\n+\n+\t  IOR_HARD_REG_SET (res->regs, regs_invalidated_by_call);\n \n \t  for (link = CALL_INSN_FUNCTION_USAGE (x);\n \t       link; link = XEXP (link, 1))"}, {"sha": "bc09250efe28f0ba390b16397330342f39deb901", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eef75f5ec020e74ff2c9a90ffed32427abfba837/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eef75f5ec020e74ff2c9a90ffed32427abfba837/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=eef75f5ec020e74ff2c9a90ffed32427abfba837", "patch": "@@ -1,3 +1,8 @@\n+2007-12-18  Richard Sandiford  <rsandifo@nildram.co.uk>\n+\n+\tPR rtl-optimization/34456\n+\t* gcc.c-torture/execute/pr34456.c: New test.\n+\n 2007-12-18  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/34488"}, {"sha": "526c954e55ad88708b10b74a7628a8aa611a5f5c", "filename": "gcc/testsuite/gcc.c-torture/execute/pr34456.c", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eef75f5ec020e74ff2c9a90ffed32427abfba837/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr34456.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eef75f5ec020e74ff2c9a90ffed32427abfba837/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr34456.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr34456.c?ref=eef75f5ec020e74ff2c9a90ffed32427abfba837", "patch": "@@ -0,0 +1,30 @@\n+#include <stdlib.h>\n+\n+int __attribute__ ((noinline)) debug (void) { return 1; }\n+int errors;\n+\n+struct s { int elt; int (*compare) (int); };\n+\n+static int\n+compare (const void *x, const void *y)\n+{\n+  const struct s *s1 = x, *s2 = y;\n+  int (*compare1) (int);\n+  int elt2;\n+\n+  compare1 = s1->compare;\n+  elt2 = s2->elt;\n+  if (elt2 != 0 && debug () && compare1 (s1->elt) != 0)\n+    errors++;\n+  return compare1 (elt2);\n+}\n+\n+int bad_compare (int x) { return -x; }\n+struct s array[2] = { { 1, bad_compare }, { -1, bad_compare } };\n+\n+int\n+main (void)\n+{\n+  qsort (array, 2, sizeof (struct s), compare);\n+  return errors == 0;\n+}"}]}