{"sha": "dd053eea0be4f3ec8b76fb2e103a13a3977bcf9f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGQwNTNlZWEwYmU0ZjNlYzhiNzZmYjJlMTAzYTEzYTM5NzdiY2Y5Zg==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2020-12-02T16:37:56Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2020-12-02T16:37:56Z"}, "message": "libstdc++: Use libatomic for tests on all 32-bit powerpc targets\n\nIn addition to the existing powerpc targets, powerpc64 needs libatomic\nfor 64-bit atomics when testing the 32-bit multilib with -m32. Adjust\nthe existing target checks to match all 32-bit powerpc targets, but not\n64-bit ones.\n\nlibstdc++-v3/ChangeLog:\n\n\t* testsuite/lib/dg-options.exp (add_options_for_libatomic):\n\tReplace powerpc-ibm-aix* and powerpc*-*-darwin* with check for\n\tpowerpc && ilp32.", "tree": {"sha": "9ea77183b82d19bc6844b8ab5445986690e1ac2c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9ea77183b82d19bc6844b8ab5445986690e1ac2c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dd053eea0be4f3ec8b76fb2e103a13a3977bcf9f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd053eea0be4f3ec8b76fb2e103a13a3977bcf9f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dd053eea0be4f3ec8b76fb2e103a13a3977bcf9f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd053eea0be4f3ec8b76fb2e103a13a3977bcf9f/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "af4180513836806e2b351d516af55f6664c8821a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/af4180513836806e2b351d516af55f6664c8821a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/af4180513836806e2b351d516af55f6664c8821a"}], "stats": {"total": 9, "additions": 5, "deletions": 4}, "files": [{"sha": "0102acf65a282e6283eacdedee460f8fb4cc3cb3", "filename": "libstdc++-v3/testsuite/lib/dg-options.exp", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd053eea0be4f3ec8b76fb2e103a13a3977bcf9f/libstdc%2B%2B-v3%2Ftestsuite%2Flib%2Fdg-options.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd053eea0be4f3ec8b76fb2e103a13a3977bcf9f/libstdc%2B%2B-v3%2Ftestsuite%2Flib%2Fdg-options.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Flib%2Fdg-options.exp?ref=dd053eea0be4f3ec8b76fb2e103a13a3977bcf9f", "patch": "@@ -257,13 +257,14 @@ proc add_options_for_net_ts { flags } {\n     return $flags\n }\n \n-# Add to FLAGS all the target-specific flags to link to libatomic, if required.\n+# Add to FLAGS all the target-specific flags to link to libatomic,\n+# if required for atomics on pointers and 64-bit types.\n \n proc add_options_for_libatomic { flags } {\n     if { [istarget hppa*-*-hpux*]\n-\t || [istarget powerpc-ibm-aix*]\n-\t || [istarget powerpc*-*-darwin*]\n-\t || [istarget riscv*-*-*] } {\n+\t || ([istarget powerpc*-*-*] && [check_effective_target_ilp32])\n+\t || [istarget riscv*-*-*]\n+       } {\n \treturn \"$flags -L../../libatomic/.libs -latomic\"\n     }\n     return $flags"}]}