{"sha": "adbdb8c76e9757634a688b093f6567d67b8b2498", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWRiZGI4Yzc2ZTk3NTc2MzRhNjg4YjA5M2Y2NTY3ZDY3YjhiMjQ5OA==", "commit": {"author": {"name": "Adam Butcher", "email": "adam@jessamine.co.uk", "date": "2014-02-25T06:44:53Z"}, "committer": {"name": "Adam Butcher", "email": "abutcher@gcc.gnu.org", "date": "2014-02-25T06:44:53Z"}, "message": "re PR c++/60311 ([c++1y] ICE with pointer-to-function with auto parameter)\n\nFix PR c++/60311.\n\n\tPR c++/60311\n\t* parser.c (function_being_declared_is_template_p): Return false when\n\tprocessing a template parameter list.\n\t(cp_parser_parameter_declaration_clause): Don't set\n\tauto_is_implicit_function_template_parm_p when processing a\n\ttemplate parameter list.\n\n\tPR c++/60311\n\t* g++.dg/cpp1y/pr60311.C: New testcase.\n\nFrom-SVN: r208111", "tree": {"sha": "c2838aa8b9eef42ed0aad12b7836de6d2a668112", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c2838aa8b9eef42ed0aad12b7836de6d2a668112"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/adbdb8c76e9757634a688b093f6567d67b8b2498", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/adbdb8c76e9757634a688b093f6567d67b8b2498", "html_url": "https://github.com/Rust-GCC/gccrs/commit/adbdb8c76e9757634a688b093f6567d67b8b2498", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/adbdb8c76e9757634a688b093f6567d67b8b2498/comments", "author": {"login": "abutcher-gh", "id": 10379705, "node_id": "MDQ6VXNlcjEwMzc5NzA1", "avatar_url": "https://avatars.githubusercontent.com/u/10379705?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abutcher-gh", "html_url": "https://github.com/abutcher-gh", "followers_url": "https://api.github.com/users/abutcher-gh/followers", "following_url": "https://api.github.com/users/abutcher-gh/following{/other_user}", "gists_url": "https://api.github.com/users/abutcher-gh/gists{/gist_id}", "starred_url": "https://api.github.com/users/abutcher-gh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abutcher-gh/subscriptions", "organizations_url": "https://api.github.com/users/abutcher-gh/orgs", "repos_url": "https://api.github.com/users/abutcher-gh/repos", "events_url": "https://api.github.com/users/abutcher-gh/events{/privacy}", "received_events_url": "https://api.github.com/users/abutcher-gh/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "41b2d514d0fc40c9abf744e392e3f7f16fa610aa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/41b2d514d0fc40c9abf744e392e3f7f16fa610aa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/41b2d514d0fc40c9abf744e392e3f7f16fa610aa"}], "stats": {"total": 29, "additions": 27, "deletions": 2}, "files": [{"sha": "5afc6d8e0d93a6f46bc437f68fe2a4044db716f1", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/adbdb8c76e9757634a688b093f6567d67b8b2498/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/adbdb8c76e9757634a688b093f6567d67b8b2498/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=adbdb8c76e9757634a688b093f6567d67b8b2498", "patch": "@@ -1,5 +1,12 @@\n 2014-02-25  Adam Butcher  <adam@jessamine.co.uk>\n \n+\tPR c++/60311\n+\t* parser.c (function_being_declared_is_template_p): Return false when\n+\tprocessing a template parameter list.\n+\t(cp_parser_parameter_declaration_clause): Don't set\n+\tauto_is_implicit_function_template_parm_p when processing a\n+\ttemplate parameter list.\n+\n \t* parser.c (synthesize_implicit_template_parm): Inject new template\n \targument list appropriately when a generic member function\n \tof a class template is declared out-of-line."}, {"sha": "ef363274471ccc6dc5d7d555fe3a47dcab58bfff", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/adbdb8c76e9757634a688b093f6567d67b8b2498/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/adbdb8c76e9757634a688b093f6567d67b8b2498/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=adbdb8c76e9757634a688b093f6567d67b8b2498", "patch": "@@ -18122,7 +18122,7 @@ cp_parser_type_specifier_seq (cp_parser* parser,\n static bool\n function_being_declared_is_template_p (cp_parser* parser)\n {\n-  if (!current_template_parms)\n+  if (!current_template_parms || processing_template_parmlist)\n     return false;\n \n   if (parser->implicit_template_scope)\n@@ -18165,7 +18165,7 @@ cp_parser_parameter_declaration_clause (cp_parser* parser)\n \n   (void) cleanup;\n \n-  if (!processing_specialization)\n+  if (!processing_specialization && !processing_template_parmlist)\n     if (!current_function_decl\n \t|| (current_class_type && LAMBDA_TYPE_P (current_class_type)))\n       parser->auto_is_implicit_function_template_parm_p = true;"}, {"sha": "d8d760ac009d308bb5ad7e9f36074f87afaaf3c4", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/adbdb8c76e9757634a688b093f6567d67b8b2498/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/adbdb8c76e9757634a688b093f6567d67b8b2498/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=adbdb8c76e9757634a688b093f6567d67b8b2498", "patch": "@@ -1,5 +1,8 @@\n 2014-02-25  Adam Butcher  <adam@jessamine.co.uk>\n \n+\tPR c++/60311\n+\t* g++.dg/cpp1y/pr60311.C: New testcase.\n+\n \t* g++.dg/cpp1y/fn-generic-member-ool.C: New testcase.\n \n \tPR c++/60065"}, {"sha": "a0db22d02003131089df9264ea947634840877ce", "filename": "gcc/testsuite/g++.dg/cpp1y/pr60311.C", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/adbdb8c76e9757634a688b093f6567d67b8b2498/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fpr60311.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/adbdb8c76e9757634a688b093f6567d67b8b2498/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fpr60311.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fpr60311.C?ref=adbdb8c76e9757634a688b093f6567d67b8b2498", "patch": "@@ -0,0 +1,15 @@\n+// PR c++/60311\n+// { dg-options -std=c++1y }\n+\n+template<void(*)(auto)> struct A {}; // { dg-error \"auto\" }\n+\n+struct B {\n+  template<void(*)(auto)> struct A {}; // { dg-error \"auto\" }\n+};\n+\n+template <typename T>\n+struct C {\n+  template<void(*)(auto)> struct A {}; // { dg-error \"auto\" }\n+};\n+\n+using D = C<int>;"}]}