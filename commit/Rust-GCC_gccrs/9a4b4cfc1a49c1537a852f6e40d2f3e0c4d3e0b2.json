{"sha": "9a4b4cfc1a49c1537a852f6e40d2f3e0c4d3e0b2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWE0YjRjZmMxYTQ5YzE1MzdhODUyZjZlNDBkMmYzZTBjNGQzZTBiMg==", "commit": {"author": {"name": "Benjamin Kosnik", "email": "bkoz@redhat.com", "date": "2002-04-21T04:15:29Z"}, "committer": {"name": "Benjamin Kosnik", "email": "bkoz@gcc.gnu.org", "date": "2002-04-21T04:15:29Z"}, "message": "re PR libstdc++/6360 (Wrong workaround in char_traits.h - ignore stops on \\0xff)\n\n\n2002-04-20  Benjamin Kosnik  <bkoz@redhat.com>\n\n\tPR libstdc++/6360\n\t* include/bits/istream.tcc (istream::ignore): Streamline, use\n\tdelimiter as is.\n\t* include/bits/streambuf.tcc: Use this->gptr.\n\t* testsuite/27_io/istream_unformatted.cc (test08): Add test.\n\nFrom-SVN: r52563", "tree": {"sha": "add173ebc2da118f90306d3c05822088573b6ac6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/add173ebc2da118f90306d3c05822088573b6ac6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9a4b4cfc1a49c1537a852f6e40d2f3e0c4d3e0b2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a4b4cfc1a49c1537a852f6e40d2f3e0c4d3e0b2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9a4b4cfc1a49c1537a852f6e40d2f3e0c4d3e0b2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a4b4cfc1a49c1537a852f6e40d2f3e0c4d3e0b2/comments", "author": null, "committer": null, "parents": [{"sha": "20764052b9fb43469efe0314dd611c9dfb91a80e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/20764052b9fb43469efe0314dd611c9dfb91a80e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/20764052b9fb43469efe0314dd611c9dfb91a80e"}], "stats": {"total": 57, "additions": 40, "deletions": 17}, "files": [{"sha": "6550006a5830b95249f19b333ea38e65b5411b5c", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a4b4cfc1a49c1537a852f6e40d2f3e0c4d3e0b2/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a4b4cfc1a49c1537a852f6e40d2f3e0c4d3e0b2/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=9a4b4cfc1a49c1537a852f6e40d2f3e0c4d3e0b2", "patch": "@@ -1,3 +1,11 @@\n+2002-04-20  Benjamin Kosnik  <bkoz@redhat.com>\n+\n+\tPR libstdc++/6360\n+\t* include/bits/istream.tcc (istream::ignore): Streamline, use\n+\tdelimiter as is.\n+\t* include/bits/streambuf.tcc: Use this->gptr.\n+\t* testsuite/27_io/istream_unformatted.cc (test08): Add test.\n+\t\n 2002-04-18  Benjamin Kosnik  <bkoz@redhat.com>\n \n \t* include/bits/localefwd.h (locale::id::_M_id): Do this correctly,"}, {"sha": "a55e906326809c9982fb4cca6c89a3aeab93a223", "filename": "libstdc++-v3/include/bits/istream.tcc", "status": "modified", "additions": 10, "deletions": 12, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a4b4cfc1a49c1537a852f6e40d2f3e0c4d3e0b2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fistream.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a4b4cfc1a49c1537a852f6e40d2f3e0c4d3e0b2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fistream.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fistream.tcc?ref=9a4b4cfc1a49c1537a852f6e40d2f3e0c4d3e0b2", "patch": "@@ -708,29 +708,27 @@ namespace std\n     {\n       _M_gcount = 0;\n       sentry __cerb(*this, true);\n-      if (__cerb && __n > 0) \n+      if (__cerb) \n \t{\n \t  try \n \t    {\n-\t      const int_type __idelim = traits_type::to_int_type(__delim);\n \t      const int_type __eof = traits_type::eof();\n \t      __streambuf_type* __sb = this->rdbuf();\n-\t      int_type __c = __sb->sbumpc();\t\n-\t      bool __testdelim = __c == __idelim;\n-\t      bool __testeof =  __c == __eof;\n+\t      int_type __c = __sb->sgetc();\t\n \t      \n \t      __n = min(__n, numeric_limits<streamsize>::max());\n-\t      while (_M_gcount < __n - 1 && !__testeof && !__testdelim)\n+\t      while (_M_gcount < __n  && __c !=__eof && __c != __delim)\n \t\t{\n+\t\t  __c = __sb->snextc();\n \t\t  ++_M_gcount;\n-\t\t  __c = __sb->sbumpc();\n-\t\t  __testeof = __c == __eof;\n-\t\t  __testdelim = __c == __idelim;\n \t\t}\n-\t      if ((_M_gcount == __n - 1 && !__testeof) || __testdelim)\n-\t\t++_M_gcount;\n-\t      if (__testeof)\n+\t      if (__c == __eof)\n \t\tthis->setstate(ios_base::eofbit);\n+\t      else if (__c == __delim)\n+\t\t{\n+\t\t  __sb->snextc();\n+\t\t  ++_M_gcount;\n+\t\t}\n \t    }\n \t  catch(exception& __fail)\n \t    {"}, {"sha": "292999cfba3183cc898ce08edbf08779bd769181", "filename": "libstdc++-v3/include/bits/streambuf.tcc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a4b4cfc1a49c1537a852f6e40d2f3e0c4d3e0b2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstreambuf.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a4b4cfc1a49c1537a852f6e40d2f3e0c4d3e0b2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstreambuf.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstreambuf.tcc?ref=9a4b4cfc1a49c1537a852f6e40d2f3e0c4d3e0b2", "patch": "@@ -51,7 +51,7 @@ namespace std\n       int_type __ret;\n       if (_M_in_cur && _M_in_cur < _M_in_end)\n \t{\n-\t  char_type __c = *gptr();\n+\t  char_type __c = *(this->gptr());\n \t  _M_in_cur_move(1);\n \t  __ret = traits_type::to_int_type(__c);\n \t}"}, {"sha": "bf25be8992a3329d40105fd207f0f81f5fe36300", "filename": "libstdc++-v3/testsuite/27_io/istream_unformatted.cc", "status": "modified", "additions": 21, "deletions": 4, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a4b4cfc1a49c1537a852f6e40d2f3e0c4d3e0b2/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fistream_unformatted.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a4b4cfc1a49c1537a852f6e40d2f3e0c4d3e0b2/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fistream_unformatted.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fistream_unformatted.cc?ref=9a4b4cfc1a49c1537a852f6e40d2f3e0c4d3e0b2", "patch": "@@ -1,6 +1,6 @@\n // 1999-08-11 bkoz\n \n-// Copyright (C) 1999, 2000, 2001 Free Software Foundation\n+// Copyright (C) 1999, 2000, 2001, 2002 Free Software Foundation\n //\n // This file is part of the GNU ISO C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -463,7 +463,7 @@ test06()\n \n // bug reported by bgarcia@laurelnetworks.com\n // http://gcc.gnu.org/ml/libstdc++-prs/2000-q3/msg00041.html\n-int\n+void\n test07()\n {\n   bool test = true;\n@@ -481,9 +481,25 @@ test07()\n       line = line_ss.str();\n       VERIFY( line == \"1234567890\" || line == \"\" );\n     }\n-  return 0;\n }\n- \n+\n+// 2002-04-19 PR libstdc++ 6360\n+void\n+test08()\n+{\n+  using namespace std;\n+  bool test = true;\n+\n+  stringstream ss(\"abcd\" \"\\xFF\" \"1234ina donna coolbrith\");  \n+  char c;\n+  ss >> c;\n+  VERIFY( c == 'a' );\n+  ss.ignore(8);\n+  ss >> c;\n+  VERIFY( c == 'i' );\n+}\n+    \n+\n int \n main()\n {\n@@ -494,6 +510,7 @@ main()\n   test05();\n   test06();\n   test07();\n+  test08();\n \n   return 0;\n }"}]}