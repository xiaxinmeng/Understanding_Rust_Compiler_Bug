{"sha": "f6f5e3a1cc294a064bf87250db3dee449a24f278", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjZmNWUzYTFjYzI5NGEwNjRiZjg3MjUwZGIzZGVlNDQ5YTI0ZjI3OA==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2009-04-08T16:08:15Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2009-04-08T16:08:15Z"}, "message": "re PR c++/25185 (deep typedef substitution in error message)\n\n\tPR c++/25185\n\t* error.c (dump_aggr_type): Chase template typedefs if\n\t-fno-pretty-templates.\n\nFrom-SVN: r145753", "tree": {"sha": "79752b2a66e9422d70efe39125b3a379bbca76e9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/79752b2a66e9422d70efe39125b3a379bbca76e9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f6f5e3a1cc294a064bf87250db3dee449a24f278", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6f5e3a1cc294a064bf87250db3dee449a24f278", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f6f5e3a1cc294a064bf87250db3dee449a24f278", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6f5e3a1cc294a064bf87250db3dee449a24f278/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b568955d9c5ac37908ca4f3b808a5d58079c3196", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b568955d9c5ac37908ca4f3b808a5d58079c3196", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b568955d9c5ac37908ca4f3b808a5d58079c3196"}], "stats": {"total": 36, "additions": 33, "deletions": 3}, "files": [{"sha": "b11e0049796015049603c69544357ef51584c5f3", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6f5e3a1cc294a064bf87250db3dee449a24f278/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6f5e3a1cc294a064bf87250db3dee449a24f278/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=f6f5e3a1cc294a064bf87250db3dee449a24f278", "patch": "@@ -1,3 +1,9 @@\n+2009-04-08  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/25185\n+\t* error.c (dump_aggr_type): Chase template typedefs if\n+\t-fno-pretty-templates.\n+\n 2009-04-08  Dodji Seketeli  <dodji@redhat.com>\n \n \tPR c++/39637"}, {"sha": "9c2e7e5a865334b42683415e830a71ba5bfddfe1", "filename": "gcc/cp/error.c", "status": "modified", "additions": 11, "deletions": 3, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6f5e3a1cc294a064bf87250db3dee449a24f278/gcc%2Fcp%2Ferror.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6f5e3a1cc294a064bf87250db3dee449a24f278/gcc%2Fcp%2Ferror.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ferror.c?ref=f6f5e3a1cc294a064bf87250db3dee449a24f278", "patch": "@@ -537,14 +537,22 @@ dump_aggr_type (tree t, int flags)\n   if (flags & TFF_CLASS_KEY_OR_ENUM)\n     pp_cxx_identifier (cxx_pp, variety);\n \n-  if (flags & TFF_CHASE_TYPEDEF)\n-    t = TYPE_MAIN_VARIANT (t);\n-\n   name = TYPE_NAME (t);\n \n   if (name)\n     {\n       typdef = !DECL_ARTIFICIAL (name);\n+\n+      if (typdef\n+\t  && ((flags & TFF_CHASE_TYPEDEF)\n+\t      || (!flag_pretty_templates && DECL_LANG_SPECIFIC (name)\n+\t\t  && DECL_TEMPLATE_INFO (name))))\n+\t{\n+\t  t = TYPE_MAIN_VARIANT (t);\n+\t  name = TYPE_NAME (t);\n+\t  typdef = 0;\n+\t}\n+\n       tmplate = !typdef && TREE_CODE (t) != ENUMERAL_TYPE\n \t\t&& TYPE_LANG_SPECIFIC (t) && CLASSTYPE_TEMPLATE_INFO (t)\n \t\t&& (TREE_CODE (CLASSTYPE_TI_TEMPLATE (t)) != TEMPLATE_DECL"}, {"sha": "646ee1f04c7f604f97b885dfc64cd2cf3b88a8ae", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6f5e3a1cc294a064bf87250db3dee449a24f278/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6f5e3a1cc294a064bf87250db3dee449a24f278/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f6f5e3a1cc294a064bf87250db3dee449a24f278", "patch": "@@ -1,3 +1,8 @@\n+2009-04-08  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/25185\n+\t* g++.dg/template/error40.C: Add another test.\n+\n 2009-04-08  Joseph Myers  <joseph@codesourcery.com>\n \n \tPR c/39614"}, {"sha": "c5df56fc1be0f9315f2a6c6cc1bdb131f6e69bc7", "filename": "gcc/testsuite/g++.dg/template/error40.C", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6f5e3a1cc294a064bf87250db3dee449a24f278/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ferror40.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6f5e3a1cc294a064bf87250db3dee449a24f278/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ferror40.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ferror40.C?ref=f6f5e3a1cc294a064bf87250db3dee449a24f278", "patch": "@@ -3,6 +3,7 @@\n template <class T, int N=0, int X=1>\n struct A\n {\n+  struct AN;\n };\n \n void foo(void)\n@@ -13,7 +14,17 @@ void foo(void)\n template <class T> T f(T);\t    // { dg-message \"int f<int>.int.\" }\n template <class T> T f(T, int = 0); // { dg-message \"\" }\n \n+template <class T>\n+struct B\n+{\n+  typedef typename T::AN BN;\n+\n+  BN f();\t\t\t// { dg-message \"AN\" }\n+  BN f(int = 0);\t\t// { dg-message \"\" }\n+};\n+\n int main()\n {\n   f(1);\t\t\t\t// { dg-error \"\" }\n+  B<A<int> >().f();\t\t// { dg-error \"\" }\n }"}]}