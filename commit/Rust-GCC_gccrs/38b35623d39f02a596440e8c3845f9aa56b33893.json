{"sha": "38b35623d39f02a596440e8c3845f9aa56b33893", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzhiMzU2MjNkMzlmMDJhNTk2NDQwZThjMzg0NWY5YWE1NmIzMzg5Mw==", "commit": {"author": {"name": "Kazu Hirata", "email": "kazu@cs.umass.edu", "date": "2003-09-29T17:35:11Z"}, "committer": {"name": "Kazu Hirata", "email": "kazu@gcc.gnu.org", "date": "2003-09-29T17:35:11Z"}, "message": "fold-const.c (fold): Fold (A & ~B) - (A & B) into (A ^ B) - B, where B is any power of 2 minus 1.\n\n\t* fold-const.c (fold): Fold (A & ~B) - (A & B) into\n\t(A ^ B) - B, where B is any power of 2 minus 1.\n\nFrom-SVN: r71910", "tree": {"sha": "0f7ea83bcc8f21bb26c3a1a6dd61d42a9f950cb5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0f7ea83bcc8f21bb26c3a1a6dd61d42a9f950cb5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/38b35623d39f02a596440e8c3845f9aa56b33893", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/38b35623d39f02a596440e8c3845f9aa56b33893", "html_url": "https://github.com/Rust-GCC/gccrs/commit/38b35623d39f02a596440e8c3845f9aa56b33893", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/38b35623d39f02a596440e8c3845f9aa56b33893/comments", "author": null, "committer": null, "parents": [{"sha": "1ffcc3520601ae337f0c9419fb3b694ce5c4469f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ffcc3520601ae337f0c9419fb3b694ce5c4469f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1ffcc3520601ae337f0c9419fb3b694ce5c4469f"}], "stats": {"total": 28, "additions": 28, "deletions": 0}, "files": [{"sha": "307e9b76fd9d786e1a83b20af96d61041813a7d4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/38b35623d39f02a596440e8c3845f9aa56b33893/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/38b35623d39f02a596440e8c3845f9aa56b33893/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=38b35623d39f02a596440e8c3845f9aa56b33893", "patch": "@@ -1,3 +1,8 @@\n+2003-09-29  Kazu Hirata  <kazu@cs.umass.edu>\n+\n+\t* fold-const.c (fold): Fold (A & ~B) - (A & B) into\n+\t(A ^ B) - B, where B is any power of 2 minus 1.\n+\n Mon Sep 29 19:05:46 CEST 2003  Jan Hubicka  <jh@suse.cz>\n \n \t* libgcov.c (gcov_exit): Fix two pastos."}, {"sha": "3cfa54543602fd7525a7ea7a6c5f8e465696ca10", "filename": "gcc/fold-const.c", "status": "modified", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/38b35623d39f02a596440e8c3845f9aa56b33893/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/38b35623d39f02a596440e8c3845f9aa56b33893/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=38b35623d39f02a596440e8c3845f9aa56b33893", "patch": "@@ -6017,6 +6017,29 @@ fold (tree expr)\n \t\t\t\t\t\t  TREE_OPERAND (arg1, 1))),\n \t\t\t\t    arg0));\n \t    }\n+\n+\t  /* Fold (A & ~B) - (A & B) into (A ^ B) - B, , where B is\n+\t     any power of 2 minus 1.  */\n+\t  if (TREE_CODE (arg0) == BIT_AND_EXPR\n+\t      && TREE_CODE (arg1) == BIT_AND_EXPR\n+\t      && operand_equal_p (TREE_OPERAND (arg0, 0),\n+\t\t\t\t  TREE_OPERAND (arg1, 0), 0)\n+\t      && TREE_CODE (TREE_OPERAND (arg0, 1)) == INTEGER_CST\n+\t      && TREE_CODE (TREE_OPERAND (arg1, 1)) == INTEGER_CST)\n+\t    {\n+\t      tree mask0 = TREE_OPERAND (arg0, 1);\n+\t      tree mask1 = TREE_OPERAND (arg1, 1);\n+\t      tree tem = fold (build1 (BIT_NOT_EXPR, type, mask0));\n+\t      \n+\t      if (operand_equal_p (tem, mask1, 0)\n+\t\t  && integer_pow2p (fold (build (PLUS_EXPR, type,\n+\t\t\t\t\t\t mask1, integer_one_node))))\n+\t\t{\n+\t\t  tem = fold (build (BIT_XOR_EXPR, type,\n+\t\t\t\t     TREE_OPERAND (arg0, 0), mask1));\n+\t\t  return fold (build (MINUS_EXPR, type, tem, mask1));\n+\t\t}\n+\t    }\n \t}\n \n       /* See if ARG1 is zero and X - ARG1 reduces to X.  */"}]}