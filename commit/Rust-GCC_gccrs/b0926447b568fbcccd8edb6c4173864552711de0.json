{"sha": "b0926447b568fbcccd8edb6c4173864552711de0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjA5MjY0NDdiNTY4ZmJjY2NkOGVkYjZjNDE3Mzg2NDU1MjcxMWRlMA==", "commit": {"author": {"name": "Igor Tsimbalist", "email": "igor.v.tsimbalist@intel.com", "date": "2017-10-20T17:29:02Z"}, "committer": {"name": "Igor Tsimbalist", "email": "itsimbal@gcc.gnu.org", "date": "2017-10-20T17:29:02Z"}, "message": "Add tests for -fcf-protection option and nocf_check attribute.\n\n\t* c-c++-common/fcf-protection-1.c: New test.\n\t* c-c++-common/fcf-protection-2.c: Likewise.\n\t* c-c++-common/fcf-protection-3.c: Likewise.\n\t* c-c++-common/fcf-protection-4.c: Likewise.\n\t* c-c++-common/fcf-protection-5.c: Likewise.\n\t* c-c++-common/attr-nocf-check-1.c: Likewise.\n\t* c-c++-common/attr-nocf-check-2.c: Likewise.\n\t* c-c++-common/attr-nocf-check-3.c: Likewise.\n\nFrom-SVN: r253949", "tree": {"sha": "75e40ac779adece884a9e8d47b425fd564a0f34b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/75e40ac779adece884a9e8d47b425fd564a0f34b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b0926447b568fbcccd8edb6c4173864552711de0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b0926447b568fbcccd8edb6c4173864552711de0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b0926447b568fbcccd8edb6c4173864552711de0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b0926447b568fbcccd8edb6c4173864552711de0/comments", "author": {"login": "itsimbal", "id": 29258612, "node_id": "MDQ6VXNlcjI5MjU4NjEy", "avatar_url": "https://avatars.githubusercontent.com/u/29258612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/itsimbal", "html_url": "https://github.com/itsimbal", "followers_url": "https://api.github.com/users/itsimbal/followers", "following_url": "https://api.github.com/users/itsimbal/following{/other_user}", "gists_url": "https://api.github.com/users/itsimbal/gists{/gist_id}", "starred_url": "https://api.github.com/users/itsimbal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/itsimbal/subscriptions", "organizations_url": "https://api.github.com/users/itsimbal/orgs", "repos_url": "https://api.github.com/users/itsimbal/repos", "events_url": "https://api.github.com/users/itsimbal/events{/privacy}", "received_events_url": "https://api.github.com/users/itsimbal/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c840bf9bc92e71291a9dc653688bf496aa219b7d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c840bf9bc92e71291a9dc653688bf496aa219b7d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c840bf9bc92e71291a9dc653688bf496aa219b7d"}], "stats": {"total": 93, "additions": 93, "deletions": 0}, "files": [{"sha": "9e0b48d23b8e8cee05c42e947ba080006f53b524", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b0926447b568fbcccd8edb6c4173864552711de0", "patch": "@@ -1,3 +1,14 @@\n+2017-10-20  Igor Tsimbalist  <igor.v.tsimbalist@intel.com>\n+\n+\t* c-c++-common/fcf-protection-1.c: New test.\n+\t* c-c++-common/fcf-protection-2.c: Likewise.\n+\t* c-c++-common/fcf-protection-3.c: Likewise.\n+\t* c-c++-common/fcf-protection-4.c: Likewise.\n+\t* c-c++-common/fcf-protection-5.c: Likewise.\n+\t* c-c++-common/attr-nocf-check-1.c: Likewise.\n+\t* c-c++-common/attr-nocf-check-2.c: Likewise.\n+\t* c-c++-common/attr-nocf-check-3.c: Likewise.\n+\n 2017-10-20  Ed Schonberg  <schonberg@adacore.com>\n \n \t* gnat.dg/sync_iface_call.adb, gnat.dg/sync_iface_call_pkg.ads,"}, {"sha": "62fa370b22e86716b79bd99f26acdd688be72a8a", "filename": "gcc/testsuite/c-c++-common/attr-nocf-check-1.c", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fattr-nocf-check-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fattr-nocf-check-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fattr-nocf-check-1.c?ref=b0926447b568fbcccd8edb6c4173864552711de0", "patch": "@@ -0,0 +1,30 @@\n+/* { dg-do compile } */\n+\n+int func (int) __attribute__ ((nocf_check)); /* { dg-warning \"'nocf_check' attribute ignored. Use -fcf-protection option to enable it\" } */\n+int (*fptr) (int) __attribute__ ((nocf_check)); /* { dg-warning \"'nocf_check' attribute ignored. Use -fcf-protection option to enable it\" } */\n+typedef void (*nocf_check_t) (void) __attribute__ ((nocf_check)); /* { dg-warning \"'nocf_check' attribute ignored. Use -fcf-protection option to enable it\" } */\n+\n+int\n+foo1 (int arg)\n+{\n+  return func (arg) + fptr (arg);\n+}\n+\n+void\n+foo2 (void (*foo) (void))\n+{\n+  void (*func) (void) __attribute__((nocf_check)) = foo; /* { dg-warning \"'nocf_check' attribute ignored. Use -fcf-protection option to enable it\" } */\n+  func ();\n+}\n+\n+void\n+foo3 (nocf_check_t foo)\n+{\n+  foo ();\n+}\n+\n+void\n+foo4 (void (*foo) (void) __attribute__((nocf_check))) /* { dg-warning \"'nocf_check' attribute ignored. Use -fcf-protection option to enable it\" } */\n+{\n+  foo ();\n+}"}, {"sha": "9ab01804782a340d286f91c6528eb4728f3545e9", "filename": "gcc/testsuite/c-c++-common/attr-nocf-check-2.c", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fattr-nocf-check-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fattr-nocf-check-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fattr-nocf-check-2.c?ref=b0926447b568fbcccd8edb6c4173864552711de0", "patch": "@@ -0,0 +1,5 @@\n+/* { dg-do compile } */\n+\n+int var1 __attribute__((nocf_check)); /* { dg-warning \"'nocf_check' attribute only applies to function types\" } */\n+int *var2 __attribute__((nocf_check)); /* { dg-warning \"'nocf_check' attribute only applies to function types\" } */\n+void (**var3) (void) __attribute__((nocf_check)); /* { dg-warning \"'nocf_check' attribute only applies to function types\" } */"}, {"sha": "c7d9c8f401f05ba04fd79312d9390411d9ce7f1a", "filename": "gcc/testsuite/c-c++-common/attr-nocf-check-3.c", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fattr-nocf-check-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fattr-nocf-check-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fattr-nocf-check-3.c?ref=b0926447b568fbcccd8edb6c4173864552711de0", "patch": "@@ -0,0 +1,29 @@\n+/* { dg-do compile } */\n+\n+int  foo (void) __attribute__ ((nocf_check)); /* { dg-warning \"'nocf_check' attribute ignored. Use -fcf-protection option to enable it\" } */\n+void (*foo1) (void) __attribute__((nocf_check)); /* { dg-warning \"'nocf_check' attribute ignored. Use -fcf-protection option to enable it\" } */\n+void (*foo2) (void);\n+\n+int\n+foo (void) /* The function's address is not tracked.  */\n+{\n+  /* This call site is not tracked for\n+     control-flow instrumentation.  */\n+  (*foo1)();\n+\n+  foo1 = foo2;\n+  /* This call site is still not tracked for\n+     control-flow instrumentation.  */\n+  (*foo1)();\n+\n+  /* This call site is tracked for\n+     control-flow instrumentation.  */\n+  (*foo2)();\n+\n+  foo2 = foo1;\n+  /* This call site is still tracked for\n+     control-flow instrumentation.  */\n+  (*foo2)();\n+\n+  return 0;\n+}"}, {"sha": "6a27e1973d89d505bb3a98828fe869996f26d35c", "filename": "gcc/testsuite/c-c++-common/fcf-protection-1.c", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Ffcf-protection-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Ffcf-protection-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Ffcf-protection-1.c?ref=b0926447b568fbcccd8edb6c4173864552711de0", "patch": "@@ -0,0 +1,4 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-fcf-protection=full\" } */\n+/* { dg-error \"'-fcf-protection=full' is not supported for this target\" \"\" { target { \"i?86-*-* x86_64-*-*\" } } 0 } */\n+/* { dg-error \"'-fcf-protection=full' is not supported for this target\" \"\" { target { ! \"i?86-*-* x86_64-*-*\" } } 0 } */"}, {"sha": "558f4c0a580279db4e79045027f5cc700eefa645", "filename": "gcc/testsuite/c-c++-common/fcf-protection-2.c", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Ffcf-protection-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Ffcf-protection-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Ffcf-protection-2.c?ref=b0926447b568fbcccd8edb6c4173864552711de0", "patch": "@@ -0,0 +1,4 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-fcf-protection=branch\" } */\n+/* { dg-error \"'-fcf-protection=branch' is not supported for this target\" \"\" { target { \"i?86-*-* x86_64-*-*\" } } 0 } */\n+/* { dg-error \"'-fcf-protection=branch' is not supported for this target\" \"\" { target { ! \"i?86-*-* x86_64-*-*\" } } 0 } */"}, {"sha": "ffc73469ad9273192d659139dc8ea348f764a244", "filename": "gcc/testsuite/c-c++-common/fcf-protection-3.c", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Ffcf-protection-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Ffcf-protection-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Ffcf-protection-3.c?ref=b0926447b568fbcccd8edb6c4173864552711de0", "patch": "@@ -0,0 +1,4 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-fcf-protection=return\" } */\n+/* { dg-error \"'-fcf-protection=return' is not supported for this target\" \"\" { target { \"i?86-*-* x86_64-*-*\" } } 0 } */\n+/* { dg-error \"'-fcf-protection=return' is not supported for this target\" \"\" { target { ! \"i?86-*-* x86_64-*-*\" } } 0 } */"}, {"sha": "af4fc0b28126128ac717a3d946e276e353f62f68", "filename": "gcc/testsuite/c-c++-common/fcf-protection-4.c", "status": "added", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Ffcf-protection-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Ffcf-protection-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Ffcf-protection-4.c?ref=b0926447b568fbcccd8edb6c4173864552711de0", "patch": "@@ -0,0 +1,2 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-fcf-protection=none\" } */"}, {"sha": "2ea2ce0d82554cd249e82d3088d14d028736acf7", "filename": "gcc/testsuite/c-c++-common/fcf-protection-5.c", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Ffcf-protection-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b0926447b568fbcccd8edb6c4173864552711de0/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Ffcf-protection-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Ffcf-protection-5.c?ref=b0926447b568fbcccd8edb6c4173864552711de0", "patch": "@@ -0,0 +1,4 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-fcf-protection\" } */\n+/* { dg-error \"'-fcf-protection=full' is not supported for this target\" \"\" { target { \"i?86-*-* x86_64-*-*\" } } 0 } */\n+/* { dg-error \"'-fcf-protection=full' is not supported for this target\" \"\" { target { ! \"i?86-*-* x86_64-*-*\" } } 0 } */"}]}