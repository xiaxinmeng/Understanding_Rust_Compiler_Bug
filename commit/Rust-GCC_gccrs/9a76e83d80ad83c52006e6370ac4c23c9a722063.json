{"sha": "9a76e83d80ad83c52006e6370ac4c23c9a722063", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWE3NmU4M2Q4MGFkODNjNTIwMDZlNjM3MGFjNGMyM2M5YTcyMjA2Mw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2012-02-13T23:31:48Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2012-02-13T23:31:48Z"}, "message": "re PR bootstrap/52172 (stage 3 Bootstrap comparison failure on FreeBSD ia64)\n\n\tPR bootstrap/52172\n\t* cselib.h (cselib_subst_to_values_from_insn): New prototype.\n\t* cselib.c (cselib_subst_to_values_from_insn): New function.\n\t* sched-deps.c (add_insn_mem_dependence,\n\tsched_analyze_1, sched_analyze_2): Use it.\n\nFrom-SVN: r184181", "tree": {"sha": "15cbb5d3f14d62dfccb279c6d3b924cdce7aeabd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/15cbb5d3f14d62dfccb279c6d3b924cdce7aeabd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9a76e83d80ad83c52006e6370ac4c23c9a722063", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a76e83d80ad83c52006e6370ac4c23c9a722063", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9a76e83d80ad83c52006e6370ac4c23c9a722063", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a76e83d80ad83c52006e6370ac4c23c9a722063/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "993716bdcab4dd9d6727b406ad6b7732484c14d4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/993716bdcab4dd9d6727b406ad6b7732484c14d4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/993716bdcab4dd9d6727b406ad6b7732484c14d4"}], "stats": {"total": 35, "additions": 31, "deletions": 4}, "files": [{"sha": "e6dd0ca137258a575c588d559208489538770ba2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a76e83d80ad83c52006e6370ac4c23c9a722063/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a76e83d80ad83c52006e6370ac4c23c9a722063/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9a76e83d80ad83c52006e6370ac4c23c9a722063", "patch": "@@ -1,3 +1,11 @@\n+2012-02-13  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR bootstrap/52172\n+\t* cselib.h (cselib_subst_to_values_from_insn): New prototype.\n+\t* cselib.c (cselib_subst_to_values_from_insn): New function.\n+\t* sched-deps.c (add_insn_mem_dependence,\n+\tsched_analyze_1, sched_analyze_2): Use it.\n+\n 2012-02-13  Jan Hubicka  <jh@suse.cz>\n \n \tPR middle-end/52214"}, {"sha": "d7cb355fc33f9a18bb9fcf2a96f8fac6f800c60a", "filename": "gcc/cselib.c", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a76e83d80ad83c52006e6370ac4c23c9a722063/gcc%2Fcselib.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a76e83d80ad83c52006e6370ac4c23c9a722063/gcc%2Fcselib.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcselib.c?ref=9a76e83d80ad83c52006e6370ac4c23c9a722063", "patch": "@@ -1905,6 +1905,19 @@ cselib_subst_to_values (rtx x, enum machine_mode memmode)\n   return copy;\n }\n \n+/* Wrapper for cselib_subst_to_values, that indicates X is in INSN.  */\n+\n+rtx\n+cselib_subst_to_values_from_insn (rtx x, enum machine_mode memmode, rtx insn)\n+{\n+  rtx ret;\n+  gcc_assert (!cselib_current_insn);\n+  cselib_current_insn = insn;\n+  ret = cselib_subst_to_values (x, memmode);\n+  cselib_current_insn = NULL;\n+  return ret;\n+}\n+\n /* Look up the rtl expression X in our tables and return the value it\n    has.  If CREATE is zero, we return NULL if we don't know the value.\n    Otherwise, we create a new one if possible, using mode MODE if X"}, {"sha": "5b5fe23ae4039b4d28dde5d51735da5038e70650", "filename": "gcc/cselib.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a76e83d80ad83c52006e6370ac4c23c9a722063/gcc%2Fcselib.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a76e83d80ad83c52006e6370ac4c23c9a722063/gcc%2Fcselib.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcselib.h?ref=9a76e83d80ad83c52006e6370ac4c23c9a722063", "patch": "@@ -1,6 +1,6 @@\n /* Common subexpression elimination for GNU compiler.\n    Copyright (C) 1987, 1988, 1989, 1992, 1993, 1994, 1995, 1996, 1997,\n-   1998, 1999, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010\n+   1998, 1999, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012\n    Free Software Foundation, Inc.\n \n This file is part of GCC.\n@@ -88,6 +88,7 @@ extern rtx cselib_expand_value_rtx_cb (rtx, bitmap, int,\n extern bool cselib_dummy_expand_value_rtx_cb (rtx, bitmap, int,\n \t\t\t\t\t      cselib_expand_callback, void *);\n extern rtx cselib_subst_to_values (rtx, enum machine_mode);\n+extern rtx cselib_subst_to_values_from_insn (rtx, enum machine_mode, rtx);\n extern void cselib_invalidate_rtx (rtx);\n \n extern void cselib_reset_table (unsigned int);"}, {"sha": "33a6996fe4fca2b7bbfde0aaf187b23d94f051f0", "filename": "gcc/sched-deps.c", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a76e83d80ad83c52006e6370ac4c23c9a722063/gcc%2Fsched-deps.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a76e83d80ad83c52006e6370ac4c23c9a722063/gcc%2Fsched-deps.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsched-deps.c?ref=9a76e83d80ad83c52006e6370ac4c23c9a722063", "patch": "@@ -1728,7 +1728,8 @@ add_insn_mem_dependence (struct deps_desc *deps, bool read_p,\n   if (sched_deps_info->use_cselib)\n     {\n       mem = shallow_copy_rtx (mem);\n-      XEXP (mem, 0) = cselib_subst_to_values (XEXP (mem, 0), GET_MODE (mem));\n+      XEXP (mem, 0) = cselib_subst_to_values_from_insn (XEXP (mem, 0),\n+\t\t\t\t\t\t\tGET_MODE (mem), insn);\n     }\n   link = alloc_EXPR_LIST (VOIDmode, canon_rtx (mem), *mem_list);\n   *mem_list = link;\n@@ -2449,7 +2450,9 @@ sched_analyze_1 (struct deps_desc *deps, rtx x, rtx insn)\n \t  t = shallow_copy_rtx (dest);\n \t  cselib_lookup_from_insn (XEXP (t, 0), address_mode, 1,\n \t\t\t\t   GET_MODE (t), insn);\n-\t  XEXP (t, 0) = cselib_subst_to_values (XEXP (t, 0), GET_MODE (t));\n+\t  XEXP (t, 0)\n+\t    = cselib_subst_to_values_from_insn (XEXP (t, 0), GET_MODE (t),\n+\t\t\t\t\t\tinsn);\n \t}\n       t = canon_rtx (t);\n \n@@ -2609,7 +2612,9 @@ sched_analyze_2 (struct deps_desc *deps, rtx x, rtx insn)\n \t    t = shallow_copy_rtx (t);\n \t    cselib_lookup_from_insn (XEXP (t, 0), address_mode, 1,\n \t\t\t\t     GET_MODE (t), insn);\n-\t    XEXP (t, 0) = cselib_subst_to_values (XEXP (t, 0), GET_MODE (t));\n+\t    XEXP (t, 0)\n+\t      = cselib_subst_to_values_from_insn (XEXP (t, 0), GET_MODE (t),\n+\t\t\t\t\t\t  insn);\n \t  }\n \n \tif (!DEBUG_INSN_P (insn))"}]}