{"sha": "b7f08b83e430cf571c78bd48807b2a8e639c202c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjdmMDhiODNlNDMwY2Y1NzFjNzhiZDQ4ODA3YjJhOGU2MzljMjAyYw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2017-11-25T10:19:16Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-11-25T10:19:16Z"}, "message": "re PR target/82848 (ICE in expand_expr_real_2, at expr.c:8715)\n\n\tPR target/82848\n\t* config/rs6000/rs6000.c (rs6000_gimple_fold_builtin): Don't fold\n\tbuiltins not enabled in the currently selected ISA.\n\n\t* gcc.target/powerpc/pr82848.c: New test.\n\nFrom-SVN: r255148", "tree": {"sha": "d7e2995a23a47fa3b0824941c0855ef684a5a952", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d7e2995a23a47fa3b0824941c0855ef684a5a952"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b7f08b83e430cf571c78bd48807b2a8e639c202c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7f08b83e430cf571c78bd48807b2a8e639c202c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b7f08b83e430cf571c78bd48807b2a8e639c202c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7f08b83e430cf571c78bd48807b2a8e639c202c/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "430ddc2279ceb533232a15964dabbb640505b753", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/430ddc2279ceb533232a15964dabbb640505b753", "html_url": "https://github.com/Rust-GCC/gccrs/commit/430ddc2279ceb533232a15964dabbb640505b753"}], "stats": {"total": 30, "additions": 30, "deletions": 0}, "files": [{"sha": "5e8b5388b2022055b4cc0a9bee0ef94754d14c9c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7f08b83e430cf571c78bd48807b2a8e639c202c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7f08b83e430cf571c78bd48807b2a8e639c202c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b7f08b83e430cf571c78bd48807b2a8e639c202c", "patch": "@@ -1,3 +1,9 @@\n+2017-11-25  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR target/82848\n+\t* config/rs6000/rs6000.c (rs6000_gimple_fold_builtin): Don't fold\n+\tbuiltins not enabled in the currently selected ISA.\n+\n 2017-11-24  Jackson Woodruff  <jackson.woodruff@arm.com>\n \n \tPR tree-optimization/71026"}, {"sha": "4df87ea755659244db66f8dc1059701ab46c29f5", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7f08b83e430cf571c78bd48807b2a8e639c202c/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7f08b83e430cf571c78bd48807b2a8e639c202c/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=b7f08b83e430cf571c78bd48807b2a8e639c202c", "patch": "@@ -16143,6 +16143,12 @@ rs6000_gimple_fold_builtin (gimple_stmt_iterator *gsi)\n   if (!gimple_call_lhs (stmt) && !rs6000_builtin_valid_without_lhs (fn_code))\n     return false;\n \n+  /* Don't fold invalid builtins, let rs6000_expand_builtin diagnose it.  */\n+  HOST_WIDE_INT mask = rs6000_builtin_info[uns_fncode].mask;\n+  bool func_valid_p = (rs6000_builtin_mask & mask) == mask;\n+  if (!func_valid_p)\n+    return false;\n+\n   switch (fn_code)\n     {\n     /* Flavors of vec_add.  We deliberately don't expand"}, {"sha": "545c39dccdd68a2d8131c854eb7dfe1277b87752", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7f08b83e430cf571c78bd48807b2a8e639c202c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7f08b83e430cf571c78bd48807b2a8e639c202c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b7f08b83e430cf571c78bd48807b2a8e639c202c", "patch": "@@ -1,3 +1,8 @@\n+2017-11-25  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR target/82848\n+\t* gcc.target/powerpc/pr82848.c: New test.\n+\n 2017-11-24  Jackson Woodruff  <jackson.woodruff@arm.com>\n \n \tPR tree-optimization/71026"}, {"sha": "80a0f8c83bc7982059b40e6c25414c30ab589e19", "filename": "gcc/testsuite/gcc.target/powerpc/pr82848.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7f08b83e430cf571c78bd48807b2a8e639c202c/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr82848.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7f08b83e430cf571c78bd48807b2a8e639c202c/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr82848.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr82848.c?ref=b7f08b83e430cf571c78bd48807b2a8e639c202c", "patch": "@@ -0,0 +1,13 @@\n+/* PR target/82848 */\n+/* { dg-do compile } */\n+/* { dg-options \"-mno-altivec -mno-vsx -Wno-psabi\" } */\n+\n+#define C 3.68249351546114573519399405666776E-44f\n+#define vector __attribute__ ((altivec (vector__)))\n+\n+vector float\n+foo (vector float a)\n+{\n+  vector float b = __builtin_vec_madd (b, a, (vector float) { C, C, C, C });\t/* { dg-error \"requires the '-maltivec' option\" } */\n+  return b;\n+}"}]}