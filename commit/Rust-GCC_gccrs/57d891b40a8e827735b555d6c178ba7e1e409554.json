{"sha": "57d891b40a8e827735b555d6c178ba7e1e409554", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTdkODkxYjQwYThlODI3NzM1YjU1NWQ2YzE3OGJhN2UxZTQwOTU1NA==", "commit": {"author": {"name": "Andrew Haley", "email": "aph@redhat.com", "date": "2008-11-05T14:19:06Z"}, "committer": {"name": "Andrew Haley", "email": "aph@gcc.gnu.org", "date": "2008-11-05T14:19:06Z"}, "message": "FreetypeGlyphVector.java (getKerning): Return result in a float[], not a Point2D.\n\n2008-11-05  Andrew Haley  <aph@redhat.com>\n\n        * gnu/java/awt/peer/gtk/FreetypeGlyphVector.java (getKerning):\n        Return result in a float[], not a Point2D.\n        (performDefaultLayout): Call getKerning with a float[].\n        * native/jni/gtk-peer/gnu_java_awt_peer_gtk_FreetypeGlyphVector.c\n        (getKerning): Return result in a float[], not a Point2D.\n\nFrom-SVN: r141610", "tree": {"sha": "eb0bac86065f33d2904121ba06374dc762ee7752", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/eb0bac86065f33d2904121ba06374dc762ee7752"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/57d891b40a8e827735b555d6c178ba7e1e409554", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57d891b40a8e827735b555d6c178ba7e1e409554", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57d891b40a8e827735b555d6c178ba7e1e409554", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57d891b40a8e827735b555d6c178ba7e1e409554/comments", "author": {"login": "theRealAph", "id": 254637, "node_id": "MDQ6VXNlcjI1NDYzNw==", "avatar_url": "https://avatars.githubusercontent.com/u/254637?v=4", "gravatar_id": "", "url": "https://api.github.com/users/theRealAph", "html_url": "https://github.com/theRealAph", "followers_url": "https://api.github.com/users/theRealAph/followers", "following_url": "https://api.github.com/users/theRealAph/following{/other_user}", "gists_url": "https://api.github.com/users/theRealAph/gists{/gist_id}", "starred_url": "https://api.github.com/users/theRealAph/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/theRealAph/subscriptions", "organizations_url": "https://api.github.com/users/theRealAph/orgs", "repos_url": "https://api.github.com/users/theRealAph/repos", "events_url": "https://api.github.com/users/theRealAph/events{/privacy}", "received_events_url": "https://api.github.com/users/theRealAph/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f158188388fb801ce7c328daf1eecd693e27e5e8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f158188388fb801ce7c328daf1eecd693e27e5e8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f158188388fb801ce7c328daf1eecd693e27e5e8"}], "stats": {"total": 35, "additions": 22, "deletions": 13}, "files": [{"sha": "78863261d67b43001135425b69197083ab4490a5", "filename": "libjava/classpath/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57d891b40a8e827735b555d6c178ba7e1e409554/libjava%2Fclasspath%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57d891b40a8e827735b555d6c178ba7e1e409554/libjava%2Fclasspath%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fclasspath%2FChangeLog?ref=57d891b40a8e827735b555d6c178ba7e1e409554", "patch": "@@ -1,3 +1,11 @@\n+2008-11-05  Andrew Haley  <aph@redhat.com>\n+\n+\t* gnu/java/awt/peer/gtk/FreetypeGlyphVector.java (getKerning):\n+\tReturn result in a float[], not a Point2D.\n+\t(performDefaultLayout): Call getKerning with a float[].\n+\t* native/jni/gtk-peer/gnu_java_awt_peer_gtk_FreetypeGlyphVector.c\n+\t(getKerning): Return result in a float[], not a Point2D.\n+\t\n 2008-11-05  Andrew Haley  <aph@redhat.com>\n \n \t* tools/Makefile.am (UPDATE_TOOLS_ZIP, CREATE_TOOLS_ZIP): Exclude"}, {"sha": "af975f394caee708a4227c93bf27cc18b4eb0c35", "filename": "libjava/classpath/gnu/java/awt/peer/gtk/FreetypeGlyphVector.java", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57d891b40a8e827735b555d6c178ba7e1e409554/libjava%2Fclasspath%2Fgnu%2Fjava%2Fawt%2Fpeer%2Fgtk%2FFreetypeGlyphVector.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57d891b40a8e827735b555d6c178ba7e1e409554/libjava%2Fclasspath%2Fgnu%2Fjava%2Fawt%2Fpeer%2Fgtk%2FFreetypeGlyphVector.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fclasspath%2Fgnu%2Fjava%2Fawt%2Fpeer%2Fgtk%2FFreetypeGlyphVector.java?ref=57d891b40a8e827735b555d6c178ba7e1e409554", "patch": "@@ -247,7 +247,8 @@ private void getGlyphs()\n   /**\n    * Returns the kerning of a glyph pair\n    */\n-  private native Point2D getKerning(int leftGlyph, int rightGlyph, long font);\n+  private native void getKerning(int leftGlyph, int rightGlyph, long font, \n+\t\t\t\t float[] p);\n \n   private native double[] getMetricsNative(int glyphCode, long font);\n \n@@ -301,6 +302,7 @@ public void performDefaultLayout()\n     GlyphMetrics gm = null;\n     float x = 0;\n     float y = 0;\n+    float[] p = {0.0f, 0.0f};\n     for(int i = 0; i < nGlyphs; i++)\n       {\n         gm = getGlyphMetrics( i );\n@@ -314,9 +316,9 @@ public void performDefaultLayout()\n         // using the same font\n         if (i != nGlyphs-1 && fontSet[i] == fontSet[i+1])\n           {\n-            Point2D p = getKerning(glyphCodes[i], glyphCodes[i + 1], fontSet[i]);\n-            x += p.getX();\n-            y += p.getY();\n+            getKerning(glyphCodes[i], glyphCodes[i + 1], fontSet[i], p);\n+            x += p[0];\n+            y += p[1];\n           }\n       }\n     glyphPositions[nGlyphs * 2] = x;"}, {"sha": "cb424f4267309743cc7515ef60e2b2b68244a066", "filename": "libjava/classpath/include/gnu_java_awt_peer_gtk_FreetypeGlyphVector.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57d891b40a8e827735b555d6c178ba7e1e409554/libjava%2Fclasspath%2Finclude%2Fgnu_java_awt_peer_gtk_FreetypeGlyphVector.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57d891b40a8e827735b555d6c178ba7e1e409554/libjava%2Fclasspath%2Finclude%2Fgnu_java_awt_peer_gtk_FreetypeGlyphVector.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fclasspath%2Finclude%2Fgnu_java_awt_peer_gtk_FreetypeGlyphVector.h?ref=57d891b40a8e827735b555d6c178ba7e1e409554", "patch": "@@ -13,7 +13,7 @@ extern \"C\"\n JNIEXPORT void JNICALL Java_gnu_java_awt_peer_gtk_FreetypeGlyphVector_dispose (JNIEnv *env, jobject, jlongArray);\n JNIEXPORT jlong JNICALL Java_gnu_java_awt_peer_gtk_FreetypeGlyphVector_getNativeFontPointer (JNIEnv *env, jobject, jint);\n JNIEXPORT void JNICALL Java_gnu_java_awt_peer_gtk_FreetypeGlyphVector_getGlyphs (JNIEnv *env, jobject, jintArray, jintArray, jlongArray);\n-JNIEXPORT jobject JNICALL Java_gnu_java_awt_peer_gtk_FreetypeGlyphVector_getKerning (JNIEnv *env, jobject, jint, jint, jlong);\n+JNIEXPORT void JNICALL Java_gnu_java_awt_peer_gtk_FreetypeGlyphVector_getKerning (JNIEnv *env, jobject, jint, jint, jlong, jfloatArray);\n JNIEXPORT jdoubleArray JNICALL Java_gnu_java_awt_peer_gtk_FreetypeGlyphVector_getMetricsNative (JNIEnv *env, jobject, jint, jlong);\n JNIEXPORT jobject JNICALL Java_gnu_java_awt_peer_gtk_FreetypeGlyphVector_getGlyphOutlineNative (JNIEnv *env, jobject, jint, jlong);\n "}, {"sha": "3ca96423bc2b2b4a4170c1a1484cb7be3e3838d2", "filename": "libjava/classpath/lib/gnu/java/awt/peer/gtk/FreetypeGlyphVector.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57d891b40a8e827735b555d6c178ba7e1e409554/libjava%2Fclasspath%2Flib%2Fgnu%2Fjava%2Fawt%2Fpeer%2Fgtk%2FFreetypeGlyphVector.class", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57d891b40a8e827735b555d6c178ba7e1e409554/libjava%2Fclasspath%2Flib%2Fgnu%2Fjava%2Fawt%2Fpeer%2Fgtk%2FFreetypeGlyphVector.class", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fclasspath%2Flib%2Fgnu%2Fjava%2Fawt%2Fpeer%2Fgtk%2FFreetypeGlyphVector.class?ref=57d891b40a8e827735b555d6c178ba7e1e409554"}, {"sha": "951b74558f22578770a7928268339ecf856432d7", "filename": "libjava/classpath/native/jni/gtk-peer/gnu_java_awt_peer_gtk_FreetypeGlyphVector.c", "status": "modified", "additions": 7, "deletions": 8, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57d891b40a8e827735b555d6c178ba7e1e409554/libjava%2Fclasspath%2Fnative%2Fjni%2Fgtk-peer%2Fgnu_java_awt_peer_gtk_FreetypeGlyphVector.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57d891b40a8e827735b555d6c178ba7e1e409554/libjava%2Fclasspath%2Fnative%2Fjni%2Fgtk-peer%2Fgnu_java_awt_peer_gtk_FreetypeGlyphVector.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fclasspath%2Fnative%2Fjni%2Fgtk-peer%2Fgnu_java_awt_peer_gtk_FreetypeGlyphVector.c?ref=57d891b40a8e827735b555d6c178ba7e1e409554", "patch": "@@ -169,9 +169,10 @@ Java_gnu_java_awt_peer_gtk_FreetypeGlyphVector_getGlyphs\n   (*env)->ReleaseLongArrayElements (env, fonts, fontArray, 0);\n }\n \n-JNIEXPORT jobject JNICALL \n+JNIEXPORT void JNICALL \n Java_gnu_java_awt_peer_gtk_FreetypeGlyphVector_getKerning\n-(JNIEnv *env, jobject obj __attribute__((unused)), jint rightGlyph, jint leftGlyph, jlong fnt)\n+  (JNIEnv *env, jobject obj __attribute__((unused)), jint rightGlyph,\n+   jint leftGlyph, jlong fnt, jfloatArray p)\n {\n   FT_Face ft_face;\n   FT_Vector kern;\n@@ -187,12 +188,10 @@ Java_gnu_java_awt_peer_gtk_FreetypeGlyphVector_getKerning\n \n   pango_fc_font_unlock_face( font );\n \n-  values[0].d = (jdouble)kern.x/64.0;\n-  values[1].d = (jdouble)kern.y/64.0;\n-\n-  cls = (*env)->FindClass (env, \"java/awt/geom/Point2D$Double\");\n-  method = (*env)->GetMethodID (env, cls, \"<init>\", \"(DD)V\");\n-  return (*env)->NewObjectA(env, cls, method, values);\n+  jfloat *pelements = (*env)->GetPrimitiveArrayCritical(env, p, NULL);\n+  pelements[0] = (jfloat)kern.x/64.0;\n+  pelements[1] = (jfloat)kern.y/64.0;\n+  (*env)->ReleasePrimitiveArrayCritical (env, p, pelements, 0);\n }\n \n JNIEXPORT jdoubleArray JNICALL "}]}