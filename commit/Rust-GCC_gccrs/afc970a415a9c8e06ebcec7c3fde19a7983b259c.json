{"sha": "afc970a415a9c8e06ebcec7c3fde19a7983b259c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWZjOTcwYTQxNWE5YzhlMDZlYmNlYzdjM2ZkZTE5YTc5ODNiMjU5Yw==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2005-06-25T11:59:55Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2005-06-25T11:59:55Z"}, "message": "tree-ssa-phiopt.c (replace_phi_edge_with_variable): Update profile.\n\n\n\n\t* tree-ssa-phiopt.c (replace_phi_edge_with_variable): Update profile.\n\t* cfg.c (update_bb_profile_for_threading): Fix rescaling.\n\nFrom-SVN: r101322", "tree": {"sha": "eabfa52c083b7034378660b03895b3fed8913c95", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/eabfa52c083b7034378660b03895b3fed8913c95"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/afc970a415a9c8e06ebcec7c3fde19a7983b259c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/afc970a415a9c8e06ebcec7c3fde19a7983b259c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/afc970a415a9c8e06ebcec7c3fde19a7983b259c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/afc970a415a9c8e06ebcec7c3fde19a7983b259c/comments", "author": null, "committer": null, "parents": [{"sha": "5d9f607b1b3e84f2f360aa758bcedf181649e5bb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d9f607b1b3e84f2f360aa758bcedf181649e5bb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5d9f607b1b3e84f2f360aa758bcedf181649e5bb"}], "stats": {"total": 9, "additions": 8, "deletions": 1}, "files": [{"sha": "d02246624490dde3ec5cf4e09b1f839eac41f513", "filename": "gcc/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/afc970a415a9c8e06ebcec7c3fde19a7983b259c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/afc970a415a9c8e06ebcec7c3fde19a7983b259c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=afc970a415a9c8e06ebcec7c3fde19a7983b259c", "patch": "@@ -1,5 +1,8 @@\n 2005-06-25  Jan Hubicka  <jh@suse.cz>\n \n+\t* tree-ssa-phiopt.c (replace_phi_edge_with_variable): Update profile.\n+\t* cfg.c (update_bb_profile_for_threading): Fix rescaling.\n+\n \t* passes.c (rest_of_handle_branch_prob): Do not rebuild profiling info\n \twhen not neecesary\n \t(rest_of_compilation): Fix conditional on branch prob pass."}, {"sha": "044fcaef2427f78d1345d32acb72a7651fc1d6dd", "filename": "gcc/cfg.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/afc970a415a9c8e06ebcec7c3fde19a7983b259c/gcc%2Fcfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/afc970a415a9c8e06ebcec7c3fde19a7983b259c/gcc%2Fcfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfg.c?ref=afc970a415a9c8e06ebcec7c3fde19a7983b259c", "patch": "@@ -901,7 +901,7 @@ update_bb_profile_for_threading (basic_block bb, int edge_frequency,\n       int scale = 65536 * REG_BR_PROB_BASE / prob;\n \n       FOR_EACH_EDGE (c, ei, bb->succs)\n-\tc->probability *= scale / 65536;\n+\tc->probability = (c->probability * scale) / 65536;\n     }\n \n   gcc_assert (bb == taken_edge->src);"}, {"sha": "e7d048f5387ca7820ecbaa8171faec7e111da575", "filename": "gcc/tree-ssa-phiopt.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/afc970a415a9c8e06ebcec7c3fde19a7983b259c/gcc%2Ftree-ssa-phiopt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/afc970a415a9c8e06ebcec7c3fde19a7983b259c/gcc%2Ftree-ssa-phiopt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-phiopt.c?ref=afc970a415a9c8e06ebcec7c3fde19a7983b259c", "patch": "@@ -331,6 +331,8 @@ replace_phi_edge_with_variable (basic_block cond_block,\n     {\n       EDGE_SUCC (cond_block, 0)->flags |= EDGE_FALLTHRU;\n       EDGE_SUCC (cond_block, 0)->flags &= ~(EDGE_TRUE_VALUE | EDGE_FALSE_VALUE);\n+      EDGE_SUCC (cond_block, 0)->probability = REG_BR_PROB_BASE;\n+      EDGE_SUCC (cond_block, 0)->count += EDGE_SUCC (cond_block, 1)->count;\n \n       block_to_remove = EDGE_SUCC (cond_block, 1)->dest;\n     }\n@@ -339,6 +341,8 @@ replace_phi_edge_with_variable (basic_block cond_block,\n       EDGE_SUCC (cond_block, 1)->flags |= EDGE_FALLTHRU;\n       EDGE_SUCC (cond_block, 1)->flags\n \t&= ~(EDGE_TRUE_VALUE | EDGE_FALSE_VALUE);\n+      EDGE_SUCC (cond_block, 1)->probability = REG_BR_PROB_BASE;\n+      EDGE_SUCC (cond_block, 1)->count += EDGE_SUCC (cond_block, 0)->count;\n \n       block_to_remove = EDGE_SUCC (cond_block, 0)->dest;\n     }"}]}