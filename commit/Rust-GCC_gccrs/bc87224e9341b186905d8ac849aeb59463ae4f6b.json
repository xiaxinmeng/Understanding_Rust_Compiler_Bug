{"sha": "bc87224e9341b186905d8ac849aeb59463ae4f6b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmM4NzIyNGU5MzQxYjE4NjkwNWQ4YWM4NDlhZWI1OTQ2M2FlNGY2Yg==", "commit": {"author": {"name": "Nathan Froyd", "email": "froydnj@codesourcery.com", "date": "2010-06-18T15:51:37Z"}, "committer": {"name": "Nathan Froyd", "email": "froydnj@gcc.gnu.org", "date": "2010-06-18T15:51:37Z"}, "message": "function.h (types_used_by_cur_var_decl): Change type to a VEC.\n\ngcc/\n\t* function.h (types_used_by_cur_var_decl): Change type to a VEC.\n\t* function.c (types_used_by_cur_var_decl): Likewise.\n\t(used_types_insert): Adjust for new type of\n\ttypes_used_by_cur_var_decl.\n\ngcc/c-family/\n\t* c-common.c (record_types_used_by_current_var_decl): Adjust for\n\tnew type of types_used_by_cur_var_decl.\n\nFrom-SVN: r161001", "tree": {"sha": "099f2565c44bc86efadd0114c6699753ab14efa5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/099f2565c44bc86efadd0114c6699753ab14efa5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bc87224e9341b186905d8ac849aeb59463ae4f6b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc87224e9341b186905d8ac849aeb59463ae4f6b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bc87224e9341b186905d8ac849aeb59463ae4f6b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc87224e9341b186905d8ac849aeb59463ae4f6b/comments", "author": null, "committer": null, "parents": [{"sha": "76d971ccfb886e192d3d21705b1d9327d61f8827", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/76d971ccfb886e192d3d21705b1d9327d61f8827", "html_url": "https://github.com/Rust-GCC/gccrs/commit/76d971ccfb886e192d3d21705b1d9327d61f8827"}], "stats": {"total": 37, "additions": 20, "deletions": 17}, "files": [{"sha": "0e723ef02ac0594267df2b3df980510d8011e4cf", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc87224e9341b186905d8ac849aeb59463ae4f6b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc87224e9341b186905d8ac849aeb59463ae4f6b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bc87224e9341b186905d8ac849aeb59463ae4f6b", "patch": "@@ -1,3 +1,10 @@\n+2010-06-18  Nathan Froyd  <froydnj@codesourcery.com>\n+\n+\t* function.h (types_used_by_cur_var_decl): Change type to a VEC.\n+\t* function.c (types_used_by_cur_var_decl): Likewise.\n+\t(used_types_insert): Adjust for new type of\n+\ttypes_used_by_cur_var_decl.\n+\n 2010-06-18  Nathan Froyd  <froydnj@codesourcery.com>\n \n \t* tree.h (record_layout_info): Change type of pending_statics field"}, {"sha": "c13367e9a6a8744c67be56d6ac7ad1ad858d40c9", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc87224e9341b186905d8ac849aeb59463ae4f6b/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc87224e9341b186905d8ac849aeb59463ae4f6b/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=bc87224e9341b186905d8ac849aeb59463ae4f6b", "patch": "@@ -1,3 +1,8 @@\n+2010-06-18  Nathan Froyd  <froydnj@codesourcery.com>\n+\n+\t* c-common.c (record_types_used_by_current_var_decl): Adjust for\n+\tnew type of types_used_by_cur_var_decl.\n+\n 2010-06-17  Joern Rennecke  <joern.rennecke@embecosm.com>\n \n \tPR bootstrap/44512"}, {"sha": "4bafd1cfad5f822ece8705a765a85e022bd7f6c2", "filename": "gcc/c-family/c-common.c", "status": "modified", "additions": 3, "deletions": 10, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc87224e9341b186905d8ac849aeb59463ae4f6b/gcc%2Fc-family%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc87224e9341b186905d8ac849aeb59463ae4f6b/gcc%2Fc-family%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-common.c?ref=bc87224e9341b186905d8ac849aeb59463ae4f6b", "patch": "@@ -9191,17 +9191,10 @@ record_types_used_by_current_var_decl (tree decl)\n {\n   gcc_assert (decl && DECL_P (decl) && TREE_STATIC (decl));\n \n-  if (types_used_by_cur_var_decl)\n+  while (!VEC_empty (tree, types_used_by_cur_var_decl))\n     {\n-      tree node;\n-      for (node = types_used_by_cur_var_decl;\n-\t   node;\n-\t   node = TREE_CHAIN (node))\n-      {\n-\ttree type = TREE_PURPOSE (node);\n-\ttypes_used_by_var_decl_insert (type, decl);\n-      }\n-      types_used_by_cur_var_decl = NULL;\n+      tree type = VEC_pop (tree, types_used_by_cur_var_decl);\n+      types_used_by_var_decl_insert (type, decl);\n     }\n }\n "}, {"sha": "5c31955380ae4945936b8698b55853922ad7b686", "filename": "gcc/function.c", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc87224e9341b186905d8ac849aeb59463ae4f6b/gcc%2Ffunction.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc87224e9341b186905d8ac849aeb59463ae4f6b/gcc%2Ffunction.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffunction.c?ref=bc87224e9341b186905d8ac849aeb59463ae4f6b", "patch": "@@ -132,7 +132,7 @@ static GTY((if_marked (\"ggc_marked_p\"), param_is (struct rtx_def)))\n \f\n \n htab_t types_used_by_vars_hash = NULL;\n-tree types_used_by_cur_var_decl = NULL;\n+VEC(tree,gc) *types_used_by_cur_var_decl;\n \n /* Forward declarations.  */\n \n@@ -5562,9 +5562,7 @@ used_types_insert (tree t)\n \t/* So this might be a type referenced by a global variable.\n \t   Record that type so that we can later decide to emit its debug\n \t   information.  */\n-\ttypes_used_by_cur_var_decl =\n-\t  tree_cons (t, NULL, types_used_by_cur_var_decl);\n-\n+        VEC_safe_push (tree, gc, types_used_by_cur_var_decl, t);\n     }\n }\n "}, {"sha": "617034872ccd1e7d42a992a1f3a2d3287f39bc4e", "filename": "gcc/function.h", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc87224e9341b186905d8ac849aeb59463ae4f6b/gcc%2Ffunction.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc87224e9341b186905d8ac849aeb59463ae4f6b/gcc%2Ffunction.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffunction.h?ref=bc87224e9341b186905d8ac849aeb59463ae4f6b", "patch": "@@ -645,9 +645,9 @@ hashval_t types_used_by_vars_do_hash (const void*);\n int types_used_by_vars_eq (const void *, const void *);\n void types_used_by_var_decl_insert (tree type, tree var_decl);\n \n-/* During parsing of a global variable, this linked list points to\n-   the list of types referenced by the global variable.  */\n-extern GTY(()) tree types_used_by_cur_var_decl;\n+/* During parsing of a global variable, this vector contains the types\n+   referenced by the global variable.  */\n+extern GTY(()) VEC(tree,gc) *types_used_by_cur_var_decl;\n \n \n /* cfun shouldn't be set directly; use one of these functions instead.  */"}]}