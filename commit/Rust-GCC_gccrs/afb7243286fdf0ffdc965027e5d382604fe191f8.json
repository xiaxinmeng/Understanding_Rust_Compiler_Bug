{"sha": "afb7243286fdf0ffdc965027e5d382604fe191f8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWZiNzI0MzI4NmZkZjBmZmRjOTY1MDI3ZTVkMzgyNjA0ZmUxOTFmOA==", "commit": {"author": {"name": "Ilya Enkovich", "email": "ilya.enkovich@intel.com", "date": "2016-05-19T13:50:22Z"}, "committer": {"name": "Ilya Enkovich", "email": "ienkovich@gcc.gnu.org", "date": "2016-05-19T13:50:22Z"}, "message": "cse.c (cse_main): Free dominance info.\n\ngcc/\n\n\t* cse.c (cse_main): Free dominance info.\n\t(rest_of_handle_cse): Don't free dominance info.\n\t(rest_of_handle_cse2): Likewise.\n\t(rest_of_handle_cse_after_global_opts): Likewise.\n\ngcc/testsuite/\n\n\t* gcc.dg/pr71148.c: New test.\n\nFrom-SVN: r236460", "tree": {"sha": "5290bca9513f9d27a69e5fcf7b9ff24a6cef820f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5290bca9513f9d27a69e5fcf7b9ff24a6cef820f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/afb7243286fdf0ffdc965027e5d382604fe191f8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/afb7243286fdf0ffdc965027e5d382604fe191f8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/afb7243286fdf0ffdc965027e5d382604fe191f8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/afb7243286fdf0ffdc965027e5d382604fe191f8/comments", "author": {"login": "ienkovich", "id": 18308708, "node_id": "MDQ6VXNlcjE4MzA4NzA4", "avatar_url": "https://avatars.githubusercontent.com/u/18308708?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ienkovich", "html_url": "https://github.com/ienkovich", "followers_url": "https://api.github.com/users/ienkovich/followers", "following_url": "https://api.github.com/users/ienkovich/following{/other_user}", "gists_url": "https://api.github.com/users/ienkovich/gists{/gist_id}", "starred_url": "https://api.github.com/users/ienkovich/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ienkovich/subscriptions", "organizations_url": "https://api.github.com/users/ienkovich/orgs", "repos_url": "https://api.github.com/users/ienkovich/repos", "events_url": "https://api.github.com/users/ienkovich/events{/privacy}", "received_events_url": "https://api.github.com/users/ienkovich/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "4f83064e3bf64e5b6fe615a49ee84cf61b0ac954", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4f83064e3bf64e5b6fe615a49ee84cf61b0ac954", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4f83064e3bf64e5b6fe615a49ee84cf61b0ac954"}], "stats": {"total": 72, "additions": 63, "deletions": 9}, "files": [{"sha": "4771d5ae1c7dbd941bfcb668680736e9c09eee91", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/afb7243286fdf0ffdc965027e5d382604fe191f8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/afb7243286fdf0ffdc965027e5d382604fe191f8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=afb7243286fdf0ffdc965027e5d382604fe191f8", "patch": "@@ -1,3 +1,11 @@\n+2016-05-19  Ilya Enkovich  <ilya.enkovich@intel.com>\n+\n+\tPR rtl-optimization/71148\n+\t* cse.c (cse_main): Free dominance info.\n+\t(rest_of_handle_cse): Don't free dominance info.\n+\t(rest_of_handle_cse2): Likewise.\n+\t(rest_of_handle_cse_after_global_opts): Likewise.\n+\n 2016-05-19  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n \n \tPR target/71056"}, {"sha": "bce4fb0262e602bc14f8ad77e52224ed30872f98", "filename": "gcc/cse.c", "status": "modified", "additions": 4, "deletions": 9, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/afb7243286fdf0ffdc965027e5d382604fe191f8/gcc%2Fcse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/afb7243286fdf0ffdc965027e5d382604fe191f8/gcc%2Fcse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcse.c?ref=afb7243286fdf0ffdc965027e5d382604fe191f8", "patch": "@@ -6669,6 +6669,10 @@ cse_main (rtx_insn *f ATTRIBUTE_UNUSED, int nregs)\n   int *rc_order = XNEWVEC (int, last_basic_block_for_fn (cfun));\n   int i, n_blocks;\n \n+  /* CSE doesn't use dominane info but can invalidate it in different ways.\n+     For simplicity free dominance info here.  */\n+  free_dominance_info (CDI_DOMINATORS);\n+\n   df_set_flags (DF_LR_RUN_DCE);\n   df_note_add_problem ();\n   df_analyze ();\n@@ -7568,9 +7572,6 @@ rest_of_handle_cse (void)\n   else if (tem == 1 || optimize > 1)\n     cse_cfg_altered |= cleanup_cfg (0);\n \n-  if (cse_cfg_altered && dom_info_available_p (CDI_DOMINATORS))\n-    free_dominance_info (CDI_DOMINATORS);\n-\n   return 0;\n }\n \n@@ -7640,9 +7641,6 @@ rest_of_handle_cse2 (void)\n   else if (tem == 1)\n     cse_cfg_altered |= cleanup_cfg (0);\n \n-  if (cse_cfg_altered && dom_info_available_p (CDI_DOMINATORS))\n-    free_dominance_info (CDI_DOMINATORS);\n-\n   cse_not_expected = 1;\n   return 0;\n }\n@@ -7717,9 +7715,6 @@ rest_of_handle_cse_after_global_opts (void)\n   else if (tem == 1)\n     cse_cfg_altered |= cleanup_cfg (0);\n \n-  if (cse_cfg_altered && dom_info_available_p (CDI_DOMINATORS))\n-    free_dominance_info (CDI_DOMINATORS);\n-\n   flag_cse_follow_jumps = save_cfj;\n   return 0;\n }"}, {"sha": "b071e9f5a05f2180967899e65a57474a041b8ecc", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/afb7243286fdf0ffdc965027e5d382604fe191f8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/afb7243286fdf0ffdc965027e5d382604fe191f8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=afb7243286fdf0ffdc965027e5d382604fe191f8", "patch": "@@ -1,3 +1,8 @@\n+2016-05-19  Ilya Enkovich  <ilya.enkovich@intel.com>\n+\n+\tPR rtl-optimization/71148\n+\t* gcc.dg/pr71148.c: New test.\n+\n 2016-05-19  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n \n \tPR target/71056"}, {"sha": "6aa4920d1d9fd8858cc5183bf3169279cde1dd33", "filename": "gcc/testsuite/gcc.dg/pr71148.c", "status": "added", "additions": 46, "deletions": 0, "changes": 46, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/afb7243286fdf0ffdc965027e5d382604fe191f8/gcc%2Ftestsuite%2Fgcc.dg%2Fpr71148.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/afb7243286fdf0ffdc965027e5d382604fe191f8/gcc%2Ftestsuite%2Fgcc.dg%2Fpr71148.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr71148.c?ref=afb7243286fdf0ffdc965027e5d382604fe191f8", "patch": "@@ -0,0 +1,46 @@\n+/* PR rtl-optimization/71148 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O3 -funroll-loops\" } */\n+\n+int rh, ok, kq, fu;\n+\n+void\n+js (int cs)\n+{\n+  rh = fu;\n+  if (fu != 0)\n+    {\n+      cs /= 3;\n+      if (cs <= 0)\n+        {\n+          int z9;\n+          for (z9 = 0; z9 < 2; ++z9)\n+            {\n+              z9 += cs;\n+              ok += z9;\n+              fu += ok;\n+            }\n+        }\n+    }\n+}\n+\n+void\n+vy (int s3)\n+{\n+  int yo, g2 = 0;\n+ sd:\n+  js (g2);\n+  for (yo = 0; yo < 2; ++yo)\n+    {\n+      if (fu != 0)\n+        goto sd;\n+      kq += (s3 != (g2 ? s3 : 0));\n+      for (s3 = 0; s3 < 72; ++s3)\n+        g2 *= (~0 - 1);\n+      g2 -= yo;\n+    }\n+  for (fu = 0; fu < 18; ++fu)\n+    for (yo = 0; yo < 17; ++yo)\n+      if (g2 < 0)\n+        goto sd;\n+}"}]}