{"sha": "938a807a68f4ee61343b4f0b03b2cc8110d3c0b9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTM4YTgwN2E2OGY0ZWU2MTM0M2I0ZjBiMDNiMmNjODExMGQzYzBiOQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2017-06-14T11:22:19Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2017-06-14T11:22:19Z"}, "message": "sparc.h (MASK_ISA): Add MASK_LEON and MASK_LEON3.\n\n\t* config/sparc/sparc.h (MASK_ISA): Add MASK_LEON and MASK_LEON3.\n\t(MASK_FEATURES): New macro.\n\t* config/sparc/sparc.c (sparc_option_override): Remove the special\n\thandling of -mfpu and generalize it to all MASK_FEATURES switches.\n\nFrom-SVN: r249189", "tree": {"sha": "a5d51c6aa6ba93338d6c77a0686f5d567f5fa996", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a5d51c6aa6ba93338d6c77a0686f5d567f5fa996"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/938a807a68f4ee61343b4f0b03b2cc8110d3c0b9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/938a807a68f4ee61343b4f0b03b2cc8110d3c0b9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/938a807a68f4ee61343b4f0b03b2cc8110d3c0b9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/938a807a68f4ee61343b4f0b03b2cc8110d3c0b9/comments", "author": null, "committer": null, "parents": [{"sha": "934861488090cd5fa80845d9b07c6497e5d7621a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/934861488090cd5fa80845d9b07c6497e5d7621a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/934861488090cd5fa80845d9b07c6497e5d7621a"}], "stats": {"total": 42, "additions": 25, "deletions": 17}, "files": [{"sha": "11e3533d4f9b9470a0d9bcf426a9e1cb491be6ca", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/938a807a68f4ee61343b4f0b03b2cc8110d3c0b9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/938a807a68f4ee61343b4f0b03b2cc8110d3c0b9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=938a807a68f4ee61343b4f0b03b2cc8110d3c0b9", "patch": "@@ -1,3 +1,10 @@\n+2017-06-14  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* config/sparc/sparc.h (MASK_ISA): Add MASK_LEON and MASK_LEON3.\n+\t(MASK_FEATURES): New macro.\n+\t* config/sparc/sparc.c (sparc_option_override): Remove the special\n+\thandling of -mfpu and generalize it to all MASK_FEATURES switches.\n+\n 2017-06-14  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* simplify-rtx.c (simplify_binary_operation_1) <UDIV>: Do not simplify"}, {"sha": "790a0367b67be2ce04467f86c2e6b317da276124", "filename": "gcc/config/sparc/sparc.c", "status": "modified", "additions": 6, "deletions": 14, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/938a807a68f4ee61343b4f0b03b2cc8110d3c0b9/gcc%2Fconfig%2Fsparc%2Fsparc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/938a807a68f4ee61343b4f0b03b2cc8110d3c0b9/gcc%2Fconfig%2Fsparc%2Fsparc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsparc%2Fsparc.c?ref=938a807a68f4ee61343b4f0b03b2cc8110d3c0b9", "patch": "@@ -1341,7 +1341,6 @@ sparc_option_override (void)\n   };\n   const struct cpu_table *cpu;\n   unsigned int i;\n-  int fpu;\n \n   if (sparc_debug_string != NULL)\n     {\n@@ -1433,8 +1432,6 @@ sparc_option_override (void)\n         call_used_regs [i] = 1;\n       }\n \n-  fpu = target_flags & MASK_FPU; /* save current -mfpu status */\n-\n   /* Set the default CPU.  */\n   if (!global_options_set.x_sparc_cpu_and_features)\n     {\n@@ -1473,22 +1470,18 @@ sparc_option_override (void)\n #ifndef HAVE_AS_LEON\n \t\t   & ~(MASK_LEON | MASK_LEON3)\n #endif\n+\t\t   & ~(target_flags_explicit & MASK_FEATURES)\n \t\t   );\n \n-  /* If -mfpu or -mno-fpu was explicitly used, don't override with\n-     the processor default.  */\n-  if (target_flags_explicit & MASK_FPU)\n-    target_flags = (target_flags & ~MASK_FPU) | fpu;\n-\n-  /* -mvis2 implies -mvis */\n+  /* -mvis2 implies -mvis.  */\n   if (TARGET_VIS2)\n     target_flags |= MASK_VIS;\n \n-  /* -mvis3 implies -mvis2 and -mvis */\n+  /* -mvis3 implies -mvis2 and -mvis.  */\n   if (TARGET_VIS3)\n     target_flags |= MASK_VIS2 | MASK_VIS;\n \n-  /* -mvis4 implies -mvis3, -mvis2 and -mvis */\n+  /* -mvis4 implies -mvis3, -mvis2 and -mvis.  */\n   if (TARGET_VIS4)\n     target_flags |= MASK_VIS3 | MASK_VIS2 | MASK_VIS;\n \n@@ -1499,15 +1492,14 @@ sparc_option_override (void)\n \t\t      | MASK_FMAF);\n \n   /* -mvis assumes UltraSPARC+, so we are sure v9 instructions\n-     are available.\n-     -m64 also implies v9.  */\n+     are available; -m64 also implies v9.  */\n   if (TARGET_VIS || TARGET_ARCH64)\n     {\n       target_flags |= MASK_V9;\n       target_flags &= ~(MASK_V8 | MASK_SPARCLET | MASK_SPARCLITE);\n     }\n \n-  /* -mvis also implies -mv8plus on 32-bit */\n+  /* -mvis also implies -mv8plus on 32-bit.  */\n   if (TARGET_VIS && ! TARGET_ARCH64)\n     target_flags |= MASK_V8PLUS;\n "}, {"sha": "581774e586b7e475d345a801ce791d2863c3e611", "filename": "gcc/config/sparc/sparc.h", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/938a807a68f4ee61343b4f0b03b2cc8110d3c0b9/gcc%2Fconfig%2Fsparc%2Fsparc.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/938a807a68f4ee61343b4f0b03b2cc8110d3c0b9/gcc%2Fconfig%2Fsparc%2Fsparc.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsparc%2Fsparc.h?ref=938a807a68f4ee61343b4f0b03b2cc8110d3c0b9", "patch": "@@ -423,10 +423,15 @@ extern enum cmodel sparc_cmodel;\n #define WCHAR_TYPE_SIZE 16\n \f\n /* Mask of all CPU selection flags.  */\n-#define MASK_ISA\t\t\t\t\t\\\n-  (MASK_SPARCLITE + MASK_SPARCLET\t\t\t\\\n+#define MASK_ISA\t\t\t\t\t\t\\\n+  (MASK_SPARCLITE + MASK_SPARCLET + MASK_LEON + MASK_LEON3\t\\\n    + MASK_V8 + MASK_V9 + MASK_DEPRECATED_V8_INSNS)\n \n+/* Mask of all CPU feature flags.  */\n+#define MASK_FEATURES\t\t\t\t\t\t\\\n+  (MASK_FPU + MASK_HARD_QUAD + MASK_VIS + MASK_VIS2 + MASK_VIS3\t\\\n+   + MASK_VIS4 + MASK_CBCOND + MASK_FMAF + MASK_POPC + MASK_SUBXC)\n+ \n /* TARGET_HARD_MUL: Use 32-bit hardware multiply instructions but not %y.  */\n #define TARGET_HARD_MUL\t\t\t\t\\\n   (TARGET_SPARCLITE || TARGET_SPARCLET\t\t\\"}, {"sha": "d6fdd845dd2d500e30239c0c7936190e00f17e89", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/938a807a68f4ee61343b4f0b03b2cc8110d3c0b9/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/938a807a68f4ee61343b4f0b03b2cc8110d3c0b9/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=938a807a68f4ee61343b4f0b03b2cc8110d3c0b9", "patch": "@@ -1,3 +1,7 @@\n+2017-06-14  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc.target/sparc/overflow-4.c: Add -mno-vis3.\n+\n 2017-06-14  Andrew Pinski  <apinski@cavium.com>\n \t    Naveen H.S  <Naveen.Hurugalawadi@cavium.com>\n "}, {"sha": "868edea2b9e80437d1f523847ec0d38ce0e3b2bc", "filename": "gcc/testsuite/gcc.target/sparc/overflow-4.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/938a807a68f4ee61343b4f0b03b2cc8110d3c0b9/gcc%2Ftestsuite%2Fgcc.target%2Fsparc%2Foverflow-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/938a807a68f4ee61343b4f0b03b2cc8110d3c0b9/gcc%2Ftestsuite%2Fgcc.target%2Fsparc%2Foverflow-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fsparc%2Foverflow-4.c?ref=938a807a68f4ee61343b4f0b03b2cc8110d3c0b9", "patch": "@@ -1,5 +1,5 @@\n /* { dg-do compile } */\n-/* { dg-options \"-O\" } */\n+/* { dg-options \"-O -mno-vis3\" } */\n /* { dg-require-effective-target lp64 } */\n \n #include <stdbool.h>"}]}