{"sha": "1c0f1f465265a391519a2be0b718be84beb064cd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWMwZjFmNDY1MjY1YTM5MTUxOWEyYmUwYjcxOGJlODRiZWIwNjRjZA==", "commit": {"author": {"name": "Kirill Yukhin", "email": "kirill.yukhin@intel.com", "date": "2013-12-05T12:20:19Z"}, "committer": {"name": "Kirill Yukhin", "email": "kyukhin@gcc.gnu.org", "date": "2013-12-05T12:20:19Z"}, "message": "i386.c (ix86_expand_builtin): Generate reg for readflags built-in when optimizing.\n\n        * config/i386/i386.c (ix86_expand_builtin): Generate\n        reg for readflags built-in when optimizing.\n        * config/i386/i386.md (*pushfl<mode>): Rename to ...\n        (pushfl<mode>2): This. Fix iterator.\n        (*popfl<mode>): Rename to ...\n        (*popfl<mode>1): This. Fix iterator.\n\nFrom-SVN: r205707", "tree": {"sha": "a2ec463ff610ad87b90b55d60706ecd6a94b57fc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a2ec463ff610ad87b90b55d60706ecd6a94b57fc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1c0f1f465265a391519a2be0b718be84beb064cd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1c0f1f465265a391519a2be0b718be84beb064cd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1c0f1f465265a391519a2be0b718be84beb064cd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1c0f1f465265a391519a2be0b718be84beb064cd/comments", "author": null, "committer": null, "parents": [{"sha": "9e36c9ed207d4ce83c8b24d698040973e485acdb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9e36c9ed207d4ce83c8b24d698040973e485acdb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9e36c9ed207d4ce83c8b24d698040973e485acdb"}], "stats": {"total": 28, "additions": 19, "deletions": 9}, "files": [{"sha": "7488e925ad537902850aacf420a410770af80926", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1c0f1f465265a391519a2be0b718be84beb064cd/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1c0f1f465265a391519a2be0b718be84beb064cd/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1c0f1f465265a391519a2be0b718be84beb064cd", "patch": "@@ -1,6 +1,15 @@\n 2013-12-05  Kirill Yukhin  <kirill.yukhin@intel.com>\n \n-        * config/i386/i386.c(IX86_BUILTIN_READ_FLAGS): New.\n+\t* config/i386/i386.c (ix86_expand_builtin): Generate\n+\treg for readflags built-in when optimizing.\n+\t* config/i386/i386.md (*pushfl<mode>): Rename to ...\n+\t(pushfl<mode>2): This. Fix iterator.\n+\t(*popfl<mode>): Rename to ...\n+\t(*popfl<mode>1): This. Fix iterator.\n+\n+2013-12-05  Kirill Yukhin  <kirill.yukhin@intel.com>\n+\n+        * config/i386/i386.c (IX86_BUILTIN_READ_FLAGS): New.\n \t(IX86_BUILTIN_WRITE_FLAGS): Ditto.\n \t(ix86_init_mmx_sse_builtins): Define\n \t__builtin_ia32_writeeflags_u32, __builtin_ia32_writeeflags_u64,"}, {"sha": "0f6612dabf8ec30a3480b9b0c31077227cd8bcd2", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1c0f1f465265a391519a2be0b718be84beb064cd/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1c0f1f465265a391519a2be0b718be84beb064cd/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=1c0f1f465265a391519a2be0b718be84beb064cd", "patch": "@@ -33457,8 +33457,9 @@ ix86_expand_builtin (tree exp, rtx target, rtx subtarget,\n     case IX86_BUILTIN_READ_FLAGS:\n       emit_insn (gen_push (gen_rtx_REG (word_mode, FLAGS_REG)));\n \n-      if (target == NULL_RTX\n-\t  || !register_operand (target, word_mode)\n+      if (optimize\n+\t  || target == NULL_RTX\n+\t  || !nonimmediate_operand (target, word_mode)\n \t  || GET_MODE (target) != word_mode)\n \ttarget = gen_reg_rtx (word_mode);\n "}, {"sha": "713886885d0e829399a6ced24c285861c26ae2b3", "filename": "gcc/config/i386/i386.md", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1c0f1f465265a391519a2be0b718be84beb064cd/gcc%2Fconfig%2Fi386%2Fi386.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1c0f1f465265a391519a2be0b718be84beb064cd/gcc%2Fconfig%2Fi386%2Fi386.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.md?ref=1c0f1f465265a391519a2be0b718be84beb064cd", "patch": "@@ -1722,17 +1722,17 @@\n   [(set_attr \"type\" \"pop\")\n    (set_attr \"mode\" \"<MODE>\")])\n \n-(define_insn \"*pushfl<mode>\"\n-  [(set (match_operand:DWIH 0 \"push_operand\" \"=<\")\n-\t(match_operand:DWIH 1 \"flags_reg_operand\"))]\n+(define_insn \"*pushfl<mode>2\"\n+  [(set (match_operand:W 0 \"push_operand\" \"=<\")\n+\t(match_operand:W 1 \"flags_reg_operand\"))]\n   \"\"\n   \"pushf{<imodesuffix>}\"\n   [(set_attr \"type\" \"push\")\n    (set_attr \"mode\" \"<MODE>\")])\n \n-(define_insn \"*popfl<mode>\"\n-  [(set (match_operand:DWIH 0 \"flags_reg_operand\")\n-\t(match_operand:DWIH 1 \"pop_operand\" \">\"))]\n+(define_insn \"*popfl<mode>1\"\n+  [(set (match_operand:W 0 \"flags_reg_operand\")\n+\t(match_operand:W 1 \"pop_operand\" \">\"))]\n   \"\"\n   \"popf{<imodesuffix>}\"\n   [(set_attr \"type\" \"pop\")"}]}