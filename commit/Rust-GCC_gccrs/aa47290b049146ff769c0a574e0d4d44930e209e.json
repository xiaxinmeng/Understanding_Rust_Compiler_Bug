{"sha": "aa47290b049146ff769c0a574e0d4d44930e209e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWE0NzI5MGIwNDkxNDZmZjc2OWMwYTU3NGUwZDRkNDQ5MzBlMjA5ZQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2012-02-15T00:10:00Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2012-02-15T00:10:00Z"}, "message": "re PR lto/52178 (Ada bootstrap failure in LTO mode)\n\n\tPR lto/52178\n\t* gimple.c (iterative_hash_gimple_type): Use RECORD_OR_UNION_TYPE_P.\n\t(iterative_hash_canonical_type): Likewise.\n\t* tree-ssa-pre.c (fini_pre): Clean up the CFG only after purging all\n\tthe dead edges.\n\nFrom-SVN: r184246", "tree": {"sha": "18ec09d90fb77ac0d3f7100b09c78c6700285cec", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/18ec09d90fb77ac0d3f7100b09c78c6700285cec"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/aa47290b049146ff769c0a574e0d4d44930e209e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa47290b049146ff769c0a574e0d4d44930e209e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aa47290b049146ff769c0a574e0d4d44930e209e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa47290b049146ff769c0a574e0d4d44930e209e/comments", "author": null, "committer": null, "parents": [{"sha": "e73bea1cebabe2e142bfb84adbbc469a3334c65e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e73bea1cebabe2e142bfb84adbbc469a3334c65e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e73bea1cebabe2e142bfb84adbbc469a3334c65e"}], "stats": {"total": 41, "additions": 22, "deletions": 19}, "files": [{"sha": "f7f2169b9d33e5a21d749f78f5b15ea823e3d585", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa47290b049146ff769c0a574e0d4d44930e209e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa47290b049146ff769c0a574e0d4d44930e209e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=aa47290b049146ff769c0a574e0d4d44930e209e", "patch": "@@ -1,4 +1,12 @@\n-2012-02-15  Bernd Schmidt  <bernds@codesourcery.com>\n+2012-02-14  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\tPR lto/52178\n+\t* gimple.c (iterative_hash_gimple_type): Use RECORD_OR_UNION_TYPE_P.\n+\t(iterative_hash_canonical_type): Likewise.\n+\t* tree-ssa-pre.c (fini_pre): Clean up the CFG only after purging all\n+\tthe dead edges.\n+\n+2012-02-14  Bernd Schmidt  <bernds@codesourcery.com>\n \n \t* haifa-sched.c (prune_ready_list): Ensure that if there is a\n \tsched-group insn, it either remains alone or the entire list is"}, {"sha": "805ad2d77b221d49f81dbe17c5b9da79a0f9b331", "filename": "gcc/gimple.c", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa47290b049146ff769c0a574e0d4d44930e209e/gcc%2Fgimple.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa47290b049146ff769c0a574e0d4d44930e209e/gcc%2Fgimple.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple.c?ref=aa47290b049146ff769c0a574e0d4d44930e209e", "patch": "@@ -4140,9 +4140,7 @@ iterative_hash_gimple_type (tree type, hashval_t val,\n       v = iterative_hash_hashval_t (na, v);\n     }\n \n-  if (TREE_CODE (type) == RECORD_TYPE\n-      || TREE_CODE (type) == UNION_TYPE\n-      || TREE_CODE (type) == QUAL_UNION_TYPE)\n+  if (RECORD_OR_UNION_TYPE_P (type))\n     {\n       unsigned nf;\n       tree f;\n@@ -4373,9 +4371,7 @@ iterative_hash_canonical_type (tree type, hashval_t val)\n       v = iterative_hash_hashval_t (na, v);\n     }\n \n-  if (TREE_CODE (type) == RECORD_TYPE\n-      || TREE_CODE (type) == UNION_TYPE\n-      || TREE_CODE (type) == QUAL_UNION_TYPE)\n+  if (RECORD_OR_UNION_TYPE_P (type))\n     {\n       unsigned nf;\n       tree f;"}, {"sha": "e5ec931b96fd5f663c9ec9984ea015721b3e108c", "filename": "gcc/tree-ssa-pre.c", "status": "modified", "additions": 11, "deletions": 12, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa47290b049146ff769c0a574e0d4d44930e209e/gcc%2Ftree-ssa-pre.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa47290b049146ff769c0a574e0d4d44930e209e/gcc%2Ftree-ssa-pre.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-pre.c?ref=aa47290b049146ff769c0a574e0d4d44930e209e", "patch": "@@ -4836,6 +4836,9 @@ init_pre (bool do_fre)\n static void\n fini_pre (bool do_fre)\n {\n+  bool do_eh_cleanup = !bitmap_empty_p (need_eh_cleanup);\n+  bool do_ab_cleanup = !bitmap_empty_p (need_ab_cleanup);\n+\n   free (postorder);\n   VEC_free (bitmap_set_t, heap, value_expressions);\n   BITMAP_FREE (inserted_exprs);\n@@ -4851,22 +4854,18 @@ fini_pre (bool do_fre)\n \n   free_dominance_info (CDI_POST_DOMINATORS);\n \n-  if (!bitmap_empty_p (need_eh_cleanup))\n-    {\n-      gimple_purge_all_dead_eh_edges (need_eh_cleanup);\n-      cleanup_tree_cfg ();\n-    }\n+  if (do_eh_cleanup)\n+    gimple_purge_all_dead_eh_edges (need_eh_cleanup);\n \n-  BITMAP_FREE (need_eh_cleanup);\n-\n-  if (!bitmap_empty_p (need_ab_cleanup))\n-    {\n-      gimple_purge_all_dead_abnormal_call_edges (need_ab_cleanup);\n-      cleanup_tree_cfg ();\n-    }\n+  if (do_ab_cleanup)\n+    gimple_purge_all_dead_abnormal_call_edges (need_ab_cleanup);\n \n+  BITMAP_FREE (need_eh_cleanup);\n   BITMAP_FREE (need_ab_cleanup);\n \n+  if (do_eh_cleanup || do_ab_cleanup)\n+    cleanup_tree_cfg ();\n+\n   if (!do_fre)\n     loop_optimizer_finalize ();\n }"}]}