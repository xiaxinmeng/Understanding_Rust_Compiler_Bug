{"sha": "c0138701eb9fb930028a53732ae6b7902d42ee3b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzAxMzg3MDFlYjlmYjkzMDAyOGE1MzczMmFlNmI3OTAyZDQyZWUzYg==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1992-10-24T14:35:05Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1992-10-24T14:35:05Z"}, "message": "(movqi, movhi, reload_{in,out}{qi,hi}): Use a29k_set_memflags.\n\nFrom-SVN: r2590", "tree": {"sha": "fa2a8ecbb19d61de555b7700f07c1f6e44bad6d0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fa2a8ecbb19d61de555b7700f07c1f6e44bad6d0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c0138701eb9fb930028a53732ae6b7902d42ee3b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0138701eb9fb930028a53732ae6b7902d42ee3b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c0138701eb9fb930028a53732ae6b7902d42ee3b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0138701eb9fb930028a53732ae6b7902d42ee3b/comments", "author": null, "committer": null, "parents": [{"sha": "5cafc6586e84b2d84e09a299aa342415d7b25bc5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5cafc6586e84b2d84e09a299aa342415d7b25bc5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5cafc6586e84b2d84e09a299aa342415d7b25bc5"}], "stats": {"total": 103, "additions": 52, "deletions": 51}, "files": [{"sha": "cdf595bde140f4a61f029548e5c6cfd8b872c5eb", "filename": "gcc/config/a29k/a29k.md", "status": "modified", "additions": 52, "deletions": 51, "changes": 103, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0138701eb9fb930028a53732ae6b7902d42ee3b/gcc%2Fconfig%2Fa29k%2Fa29k.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0138701eb9fb930028a53732ae6b7902d42ee3b/gcc%2Fconfig%2Fa29k%2Fa29k.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fa29k%2Fa29k.md?ref=c0138701eb9fb930028a53732ae6b7902d42ee3b", "patch": "@@ -1773,15 +1773,14 @@\n \t{\n \t  rtx general = gen_reg_rtx (SImode);\n \t  rtx bp = gen_reg_rtx (PSImode);\n-\n-\t  if (TARGET_BYTE_WRITES)\n-\t    emit_insn (gen_storehihww (XEXP (operands[0], 0),\n-\t\t\t\t       gen_lowpart (SImode, operands[1]),\n-\t\t\t\t       general, bp));\n-\t  else\n-\t    emit_insn (gen_storehinhww (XEXP (operands[0], 0),\n-\t\t\t\t\tgen_lowpart (SImode, operands[1]),\n-\t\t\t\t\tgeneral, bp));\n+\t  rtx (*fcn) ()\n+\t    = TARGET_BYTE_WRITES ? gen_storehihww : gen_storehinhww;\n+\t  rtx seq = (*fcn) (XEXP (operands[0], 0),\n+\t\t\t    gen_lowpart (SImode, operands[1]),\n+\t\t\t    general, bp);\n+\t    \n+\t  a29k_set_memflags (seq, operands[0]);\n+\t  emit_insn (seq);\n \t  DONE;\n \t}\n     }\n@@ -1791,9 +1790,11 @@\n \t{\n \t  rtx general = gen_reg_rtx (SImode);\n \t  rtx bp = gen_reg_rtx (PSImode);\n+\t  rtx seq = gen_loadqi (gen_lowpart (SImode, operands[0]),\n+\t\t\t\tXEXP (operands[1], 0), general, bp);\n \n-\t  emit_insn (gen_loadqi (gen_lowpart (SImode, operands[0]),\n-\t\t\t\t XEXP (operands[1], 0), general, bp));\n+\t  a29k_set_memflags (seq, operands[1]);\n+\t  emit_insn (seq);\n \t  DONE;\n \t}\n     }\n@@ -1805,10 +1806,13 @@\n \t      (match_operand:PSI 2 \"register_operand\" \"=b\")])]\n   \"! TARGET_DW_ENABLE\"\n   \"\n-{ emit_insn (gen_loadhi (gen_lowpart (SImode, operands[0]),\n-\t\t\t a29k_get_reloaded_address (operands[1]),\n-\t\t\t gen_rtx (REG, SImode, R_TAV),\n-\t\t\t operands[2]));\n+{ rtx seq = gen_loadhi (gen_lowpart (SImode, operands[0]),\n+\t\t\ta29k_get_reloaded_address (operands[1]),\n+\t\t\tgen_rtx (REG, SImode, R_TAV),\n+\t\t\toperands[2]);\n+\n+  a29k_set_memflags (seq, operands[1]);\n+  emit_insn (seq);\n   DONE;\n }\")\n \n@@ -1818,16 +1822,13 @@\n \t      (match_operand:PSI 2 \"register_operand\" \"=b\")])]\n   \"! TARGET_DW_ENABLE\"\n   \"\n-{ if (TARGET_BYTE_WRITES)\n-    emit_insn (gen_storehihww (a29k_get_reloaded_address (operands[0]),\n-\t\t\t       gen_lowpart (SImode, operands[1]),\n-\t\t\t       gen_rtx (REG, SImode, R_TAV),\n-\t\t\t       operands[2]));\n-  else\n-    emit_insn (gen_storehinhww (a29k_get_reloaded_address (operands[0]),\n-\t\t\t\tgen_lowpart (SImode, operands[1]),\n-\t\t\t\tgen_rtx (REG, SImode, R_TAV),\n-\t\t\t\toperands[2]));\n+{ rtx (*fcn) () = TARGET_BYTE_WRITES ? gen_storehihww : gen_storehinhww;\n+  rtx seq = (*fcn) (a29k_get_reloaded_address (operands[0]),\n+\t\t    gen_lowpart (SImode, operands[1]),\n+\t\t    gen_rtx (REG, SImode, R_TAV), operands[2]);\n+\n+  a29k_set_memflags (seq, operands[0]);\n+  emit_insn (seq);\n   DONE;\n }\")\n \f\n@@ -1902,16 +1903,14 @@\n \t{\n \t  rtx general = gen_reg_rtx (SImode);\n \t  rtx bp = gen_reg_rtx (PSImode);\n-\n-\t  if (TARGET_BYTE_WRITES)\n-\t    emit_insn (gen_storeqihww (XEXP (operands[0], 0),\n-\t\t\t\t       gen_lowpart (SImode, operands[1]),\n-\t\t\t\t       general, bp));\n-\t  else\n-\t    emit_insn (gen_storeqinhww (XEXP (operands[0], 0),\n-\t\t\t\t\tgen_lowpart (SImode, operands[1]),\n-\t\t\t\t\tgeneral, bp));\n-\t  DONE;\n+\t  rtx (*fcn) ()\n+\t    = TARGET_BYTE_WRITES ? gen_storeqihww : gen_storeqinhww;\n+\t  rtx seq = (*fcn) (XEXP (operands[0], 0),\n+\t\t\t    gen_lowpart (SImode, operands[1]),\n+\t\t\t    general, bp);\n+\t    \n+\t  a29k_set_memflags (seq, operands[0]);\n+\t  emit_insn (seq);\n \t}\n     }\n   else if (GET_CODE (operands[1]) == MEM)\n@@ -1920,9 +1919,11 @@\n \t{\n \t  rtx general = gen_reg_rtx (SImode);\n \t  rtx bp = gen_reg_rtx (PSImode);\n+\t  rtx seq = gen_loadqi (gen_lowpart (SImode, operands[0]),\n+\t\t\t\tXEXP (operands[1], 0), general, bp);\n \n-\t  emit_insn (gen_loadqi (gen_lowpart (SImode, operands[0]),\n-\t\t\t\t XEXP (operands[1], 0), general, bp));\n+\t  a29k_set_memflags (seq, operands[1]);\n+\t  emit_insn (seq);\n \t  DONE;\n \t}\n     }\n@@ -1934,10 +1935,13 @@\n \t      (match_operand:PSI 2 \"register_operand\" \"=b\")])]\n   \"! TARGET_DW_ENABLE\"\n   \"\n-{ emit_insn (gen_loadqi (gen_lowpart (SImode, operands[0]),\n-\t\t\t a29k_get_reloaded_address (operands[1]),\n-\t\t\t gen_rtx (REG, SImode, R_TAV),\n-\t\t\t operands[2]));\n+{ rtx seq = gen_loadqi (gen_lowpart (SImode, operands[0]),\n+\t\t\ta29k_get_reloaded_address (operands[1]),\n+\t\t\tgen_rtx (REG, SImode, R_TAV),\n+\t\t\toperands[2]);\n+\n+  a29k_set_memflags (seq, operands[1]);\n+  emit_insn (seq);\n   DONE;\n }\")\n \n@@ -1947,16 +1951,13 @@\n \t      (match_operand:PSI 2 \"register_operand\" \"=b\")])]\n   \"! TARGET_DW_ENABLE\"\n   \"\n-{ if (TARGET_BYTE_WRITES)\n-    emit_insn (gen_storeqihww (a29k_get_reloaded_address (operands[0]),\n-\t\t\t       gen_lowpart (SImode, operands[1]),\n-\t\t\t       gen_rtx (REG, SImode, R_TAV),\n-\t\t\t       operands[2]));\n-  else\n-    emit_insn (gen_storeqinhww (a29k_get_reloaded_address (operands[0]),\n-\t\t\t\tgen_lowpart (SImode, operands[1]),\n-\t\t\t\tgen_rtx (REG, SImode, R_TAV),\n-\t\t\t\toperands[2]));\n+{ rtx (*fcn) () = TARGET_BYTE_WRITES ? gen_storeqihww : gen_storeqinhww;\n+  rtx seq = (*fcn) (a29k_get_reloaded_address (operands[0]),\n+\t\t    gen_lowpart (SImode, operands[1]),\n+\t\t    gen_rtx (REG, SImode, R_TAV), operands[2]);\n+\n+  a29k_set_memflags (seq, operands[0]);\n+  emit_insn (seq);\n   DONE;\n }\")\n \f"}]}