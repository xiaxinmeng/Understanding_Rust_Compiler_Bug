{"sha": "bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmQ3OGM2ZDViMmM3ZTZlMmM2ZTk5MDMyNDU0YmM2ZGU4YzM5ZDIzOA==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2018-11-06T12:46:46Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2018-11-06T12:46:46Z"}, "message": "ipa-pure-const.c (check_decl): Do not test TYPE_NEEDS_CONSTRUCTING.\n\n\n\t* ipa-pure-const.c (check_decl): Do not test TYPE_NEEDS_CONSTRUCTING.\n\t* lto-streamer-out.c (hash_tree): Do not hash TYPE_NEEDS_CONSTRUCTING.\n\t* tree-streamer-in.c (unpack_ts_type_common_value_fields): Do not\n\tstream TYPE_NEEDS_CONSTRUCTING.\n\t* tree-streamer-out.c (pack_ts_type_common_value_fields): Likewise.\n\t* tree.c (free_lang_data_in_type): Clear TYPE_NEEDS_CONSTRUCTING.\n\nFrom-SVN: r265841", "tree": {"sha": "ca048f7076f2a072ec7dc663415531cd7c17755d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ca048f7076f2a072ec7dc663415531cd7c17755d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238/comments", "author": null, "committer": null, "parents": [{"sha": "bfb9d79805753fd6cc69bb114b5c6597269f3e21", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bfb9d79805753fd6cc69bb114b5c6597269f3e21", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bfb9d79805753fd6cc69bb114b5c6597269f3e21"}], "stats": {"total": 16, "additions": 12, "deletions": 4}, "files": [{"sha": "abe98c35c5b6cb81ec282ca96b2c92e6330480e5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238", "patch": "@@ -1,3 +1,12 @@\n+2018-11-06  Jan Hubicka  <jh@suse.cz>\n+\n+\t* ipa-pure-const.c (check_decl): Do not test TYPE_NEEDS_CONSTRUCTING.\n+\t* lto-streamer-out.c (hash_tree): Do not hash TYPE_NEEDS_CONSTRUCTING.\n+\t* tree-streamer-in.c (unpack_ts_type_common_value_fields): Do not\n+\tstream TYPE_NEEDS_CONSTRUCTING.\n+\t* tree-streamer-out.c (pack_ts_type_common_value_fields): Likewise.\n+\t* tree.c (free_lang_data_in_type): Clear TYPE_NEEDS_CONSTRUCTING.\n+\n 2018-11-06  Richard Biener  <rguenther@suse.de>\n \n \t* tree-vect-slp.c (vect_slp_bb): Move opening of vect_slp_analyze_bb"}, {"sha": "4418eefd3d197020e14e0cafdd4bef7341dcddbc", "filename": "gcc/ipa-pure-const.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238/gcc%2Fipa-pure-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238/gcc%2Fipa-pure-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-pure-const.c?ref=bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238", "patch": "@@ -339,7 +339,7 @@ check_decl (funct_state local,\n   if (DECL_EXTERNAL (t) || TREE_PUBLIC (t))\n     {\n       /* Readonly reads are safe.  */\n-      if (TREE_READONLY (t) && !TYPE_NEEDS_CONSTRUCTING (TREE_TYPE (t)))\n+      if (TREE_READONLY (t))\n \treturn; /* Read of a constant, do not change the function state.  */\n       else\n \t{"}, {"sha": "e8f6a691301bccf7d1cc6851a060bc8950a6c40b", "filename": "gcc/lto-streamer-out.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238/gcc%2Flto-streamer-out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238/gcc%2Flto-streamer-out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-streamer-out.c?ref=bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238", "patch": "@@ -1147,7 +1147,6 @@ hash_tree (struct streamer_tree_cache_d *cache, hash_map<tree, hashval_t> *map,\n       hstate.add_flag (TYPE_STRING_FLAG (t));\n       /* TYPE_NO_FORCE_BLK is private to stor-layout and need\n  \t no streaming.  */\n-      hstate.add_flag (TYPE_NEEDS_CONSTRUCTING (t));\n       hstate.add_flag (TYPE_PACKED (t));\n       hstate.add_flag (TYPE_RESTRICT (t));\n       hstate.add_flag (TYPE_USER_ALIGN (t));"}, {"sha": "f1e824421f02b856becef3829cde735260be736a", "filename": "gcc/tree-streamer-in.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238/gcc%2Ftree-streamer-in.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238/gcc%2Ftree-streamer-in.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-streamer-in.c?ref=bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238", "patch": "@@ -367,7 +367,6 @@ unpack_ts_type_common_value_fields (struct bitpack_d *bp, tree expr)\n   TYPE_STRING_FLAG (expr) = (unsigned) bp_unpack_value (bp, 1);\n   /* TYPE_NO_FORCE_BLK is private to stor-layout and need\n      no streaming.  */\n-  TYPE_NEEDS_CONSTRUCTING (expr) = (unsigned) bp_unpack_value (bp, 1);\n   TYPE_PACKED (expr) = (unsigned) bp_unpack_value (bp, 1);\n   TYPE_RESTRICT (expr) = (unsigned) bp_unpack_value (bp, 1);\n   TYPE_USER_ALIGN (expr) = (unsigned) bp_unpack_value (bp, 1);"}, {"sha": "55abd3cc503cba431b993c0a6af3231273989b2e", "filename": "gcc/tree-streamer-out.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238/gcc%2Ftree-streamer-out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238/gcc%2Ftree-streamer-out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-streamer-out.c?ref=bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238", "patch": "@@ -314,7 +314,6 @@ pack_ts_type_common_value_fields (struct bitpack_d *bp, tree expr)\n   bp_pack_value (bp, TYPE_STRING_FLAG (expr), 1);\n   /* TYPE_NO_FORCE_BLK is private to stor-layout and need\n      no streaming.  */\n-  bp_pack_value (bp, TYPE_NEEDS_CONSTRUCTING (expr), 1);\n   bp_pack_value (bp, TYPE_PACKED (expr), 1);\n   bp_pack_value (bp, TYPE_RESTRICT (expr), 1);\n   bp_pack_value (bp, TYPE_USER_ALIGN (expr), 1);"}, {"sha": "a6b187c07b4cbc84e572f4ac44792991ed25773e", "filename": "gcc/tree.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238/gcc%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238/gcc%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.c?ref=bd78c6d5b2c7e6e2c6e99032454bc6de8c39d238", "patch": "@@ -5259,6 +5259,8 @@ free_lang_data_in_type (tree type)\n   TREE_LANG_FLAG_5 (type) = 0;\n   TREE_LANG_FLAG_6 (type) = 0;\n \n+  TYPE_NEEDS_CONSTRUCTING (type) = 0;\n+\n   if (TREE_CODE (type) == FUNCTION_TYPE)\n     {\n       /* Remove the const and volatile qualifiers from arguments.  The"}]}