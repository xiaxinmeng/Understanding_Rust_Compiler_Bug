{"sha": "2e97d6443f0a862ce9b798084499635914e3b8c6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmU5N2Q2NDQzZjBhODYyY2U5Yjc5ODA4NDQ5OTYzNTkxNGUzYjhjNg==", "commit": {"author": {"name": "Martin Jambor", "email": "mjambor@suse.cz", "date": "2020-11-13T17:30:11Z"}, "committer": {"name": "Martin Jambor", "email": "mjambor@suse.cz", "date": "2020-11-13T17:30:11Z"}, "message": "ipa-cp: One more safe_add (PR 97816)\n\nThe new behavior of safe_add triggered an ICE because of one use where\nit had not been used instead of a simple addition.  I'll fix it with the\nfollowing obvious patch so that periodic benchmarkers can continue\nworking because a proper fix (see below) will need a review.\n\nThe testcase showed me, however, that we can propagate time and cost\nfrom one lattice to another more than once even when that was not the\nintent.  I'll address that as a follow-up after I verify it does not\naffect the IPA-CP heuristics too much or change the corresponding\nparams accordingly.\n\nBootstrapped and tested on x86_64-linux.\n\ngcc/ChangeLog:\n\n2020-11-13  Martin Jambor  <mjambor@suse.cz>\n\n\tPR ipa/97816\n\t* ipa-cp.c (value_topo_info<valtype>::propagate_effects): Use\n\tsafe_add instead of a simple addition.", "tree": {"sha": "f396d84d040d60c107c6c0b750c25b9074f90200", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f396d84d040d60c107c6c0b750c25b9074f90200"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2e97d6443f0a862ce9b798084499635914e3b8c6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e97d6443f0a862ce9b798084499635914e3b8c6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2e97d6443f0a862ce9b798084499635914e3b8c6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e97d6443f0a862ce9b798084499635914e3b8c6/comments", "author": {"login": "jamborm", "id": 2180070, "node_id": "MDQ6VXNlcjIxODAwNzA=", "avatar_url": "https://avatars.githubusercontent.com/u/2180070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jamborm", "html_url": "https://github.com/jamborm", "followers_url": "https://api.github.com/users/jamborm/followers", "following_url": "https://api.github.com/users/jamborm/following{/other_user}", "gists_url": "https://api.github.com/users/jamborm/gists{/gist_id}", "starred_url": "https://api.github.com/users/jamborm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jamborm/subscriptions", "organizations_url": "https://api.github.com/users/jamborm/orgs", "repos_url": "https://api.github.com/users/jamborm/repos", "events_url": "https://api.github.com/users/jamborm/events{/privacy}", "received_events_url": "https://api.github.com/users/jamborm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jamborm", "id": 2180070, "node_id": "MDQ6VXNlcjIxODAwNzA=", "avatar_url": "https://avatars.githubusercontent.com/u/2180070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jamborm", "html_url": "https://github.com/jamborm", "followers_url": "https://api.github.com/users/jamborm/followers", "following_url": "https://api.github.com/users/jamborm/following{/other_user}", "gists_url": "https://api.github.com/users/jamborm/gists{/gist_id}", "starred_url": "https://api.github.com/users/jamborm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jamborm/subscriptions", "organizations_url": "https://api.github.com/users/jamborm/orgs", "repos_url": "https://api.github.com/users/jamborm/repos", "events_url": "https://api.github.com/users/jamborm/events{/privacy}", "received_events_url": "https://api.github.com/users/jamborm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6f1ae1ecd351348eb33b515c5e23778651bee028", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f1ae1ecd351348eb33b515c5e23778651bee028", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6f1ae1ecd351348eb33b515c5e23778651bee028"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "c3ee71e16e1d5f0235b3f6d938e38de26f1c89e2", "filename": "gcc/ipa-cp.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e97d6443f0a862ce9b798084499635914e3b8c6/gcc%2Fipa-cp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e97d6443f0a862ce9b798084499635914e3b8c6/gcc%2Fipa-cp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-cp.c?ref=2e97d6443f0a862ce9b798084499635914e3b8c6", "patch": "@@ -3873,7 +3873,8 @@ value_topo_info<valtype>::propagate_effects ()\n       for (val = base; val; val = val->scc_next)\n \t{\n \t  time = time + val->local_time_benefit + val->prop_time_benefit;\n-\t  size = safe_add (size, val->local_size_cost + val->prop_size_cost);\n+\t  size = safe_add (size, safe_add (val->local_size_cost,\n+\t\t\t\t\t   val->prop_size_cost));\n \t}\n \n       for (val = base; val; val = val->scc_next)"}]}