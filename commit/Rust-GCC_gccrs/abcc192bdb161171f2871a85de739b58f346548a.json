{"sha": "abcc192bdb161171f2871a85de739b58f346548a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWJjYzE5MmJkYjE2MTE3MWYyODcxYTg1ZGU3MzliNThmMzQ2NTQ4YQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2012-11-19T13:44:15Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2012-11-19T13:44:15Z"}, "message": "re PR middle-end/54630 (GCC 4.8 --enable-languages=c build fails: Undefined symbols: ___cxa_guard_acquire and ___cxa_guard_release)\n\n\tPR middle-end/54630\n\t* tree-ssa-coalesce.c (coalesce_ssa_name): Remove static\n\tkeyword from ssa_name_hash var.\n\n\t* class.c (fixed_type_or_null_ref_ht): New variable.\n\t(fixed_type_or_null): Use it instead of local static ht.\n\nFrom-SVN: r193620", "tree": {"sha": "a1b14e3bc152e0e0a1fbcddd45bfd1528f6ff4ce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a1b14e3bc152e0e0a1fbcddd45bfd1528f6ff4ce"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/abcc192bdb161171f2871a85de739b58f346548a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/abcc192bdb161171f2871a85de739b58f346548a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/abcc192bdb161171f2871a85de739b58f346548a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/abcc192bdb161171f2871a85de739b58f346548a/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c293d490e44732b94dd2815586e9ccf84be4b715", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c293d490e44732b94dd2815586e9ccf84be4b715", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c293d490e44732b94dd2815586e9ccf84be4b715"}], "stats": {"total": 32, "additions": 23, "deletions": 9}, "files": [{"sha": "f1811099a5c6d8ad6eacd93b07f82fd9126961ec", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/abcc192bdb161171f2871a85de739b58f346548a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/abcc192bdb161171f2871a85de739b58f346548a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=abcc192bdb161171f2871a85de739b58f346548a", "patch": "@@ -1,3 +1,9 @@\n+2012-11-19  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR middle-end/54630\n+\t* tree-ssa-coalesce.c (coalesce_ssa_name): Remove static\n+\tkeyword from ssa_name_hash var.\n+\n 2012-11-19  Maxim Kuznetsov  <maxim.kuznetsov@intel.com>\n \t    Kirill Yukhin  <kirill.yukhin@intel.com>\n \t    Michael Zolotukhin  <michael.v.zolotukhin@intel.com>"}, {"sha": "a4e76a6f926a1de4f7c8c186e491518895256f49", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/abcc192bdb161171f2871a85de739b58f346548a/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/abcc192bdb161171f2871a85de739b58f346548a/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=abcc192bdb161171f2871a85de739b58f346548a", "patch": "@@ -1,3 +1,9 @@\n+2012-11-19  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR middle-end/54630\n+\t* class.c (fixed_type_or_null_ref_ht): New variable.\n+\t(fixed_type_or_null): Use it instead of local static ht.\n+\n 2012-11-17  Diego Novillo  <dnovillo@google.com>\n \n \tAdjust for new vec API (http://gcc.gnu.org/wiki/cxx-conversion/cxx-vec)"}, {"sha": "2737cbc3ecf77664bab4f271a2b574a6a642d27a", "filename": "gcc/cp/class.c", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/abcc192bdb161171f2871a85de739b58f346548a/gcc%2Fcp%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/abcc192bdb161171f2871a85de739b58f346548a/gcc%2Fcp%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fclass.c?ref=abcc192bdb161171f2871a85de739b58f346548a", "patch": "@@ -6568,6 +6568,9 @@ finish_struct (tree t, tree attributes)\n   return t;\n }\n \f\n+/* Hash table to avoid endless recursion when handling references.  */\n+static hash_table <pointer_hash <tree_node> > fixed_type_or_null_ref_ht;\n+\n /* Return the dynamic type of INSTANCE, if known.\n    Used to determine whether the virtual function table is needed\n    or not.\n@@ -6683,9 +6686,8 @@ fixed_type_or_null (tree instance, int *nonnull, int *cdtorp)\n       else if (TREE_CODE (TREE_TYPE (instance)) == REFERENCE_TYPE)\n \t{\n \t  /* We only need one hash table because it is always left empty.  */\n-\t  static hash_table <pointer_hash <tree_node> > ht;\n-\t  if (!ht.is_created ())\n-\t    ht.create (37); \n+\t  if (!fixed_type_or_null_ref_ht.is_created ())\n+\t    fixed_type_or_null_ref_ht.create (37); \n \n \t  /* Reference variables should be references to objects.  */\n \t  if (nonnull)\n@@ -6697,15 +6699,15 @@ fixed_type_or_null (tree instance, int *nonnull, int *cdtorp)\n \t  if (TREE_CODE (instance) == VAR_DECL\n \t      && DECL_INITIAL (instance)\n \t      && !type_dependent_expression_p_push (DECL_INITIAL (instance))\n-\t      && !ht.find (instance))\n+\t      && !fixed_type_or_null_ref_ht.find (instance))\n \t    {\n \t      tree type;\n \t      tree_node **slot;\n \n-\t      slot = ht.find_slot (instance, INSERT);\n+\t      slot = fixed_type_or_null_ref_ht.find_slot (instance, INSERT);\n \t      *slot = instance;\n \t      type = RECUR (DECL_INITIAL (instance));\n-\t      ht.remove_elt (instance);\n+\t      fixed_type_or_null_ref_ht.remove_elt (instance);\n \n \t      return type;\n \t    }"}, {"sha": "636de23d019e140782c8361bb7f7e87f9efec362", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/abcc192bdb161171f2871a85de739b58f346548a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/abcc192bdb161171f2871a85de739b58f346548a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=abcc192bdb161171f2871a85de739b58f346548a", "patch": "@@ -1,7 +1,6 @@\n 2012-11-19  Tom de Vries  <tom@codesourcery.com>\n \n \tPR rtl-optimization/55315\n-\n \t* gcc.target/mips/pr55315.c: New test.\n \n 2012-11-17  Jakub Jelinek  <jakub@redhat.com>"}, {"sha": "ce04fdf7759b9fc1c17c9b623802ef6ad953c349", "filename": "gcc/tree-ssa-coalesce.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/abcc192bdb161171f2871a85de739b58f346548a/gcc%2Ftree-ssa-coalesce.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/abcc192bdb161171f2871a85de739b58f346548a/gcc%2Ftree-ssa-coalesce.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-coalesce.c?ref=abcc192bdb161171f2871a85de739b58f346548a", "patch": "@@ -1,5 +1,5 @@\n /* Coalesce SSA_NAMES together for the out-of-ssa pass.\n-   Copyright (C) 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011\n+   Copyright (C) 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012\n    Free Software Foundation, Inc.\n    Contributed by Andrew MacLeod <amacleod@redhat.com>\n \n@@ -1292,7 +1292,6 @@ coalesce_ssa_name (void)\n   bitmap used_in_copies = BITMAP_ALLOC (NULL);\n   var_map map;\n   unsigned int i;\n-  static hash_table <ssa_name_var_hash> ssa_name_hash;\n \n   cl = create_coalesce_list ();\n   map = create_outofssa_var_map (cl, used_in_copies);\n@@ -1301,6 +1300,8 @@ coalesce_ssa_name (void)\n      so debug info remains undisturbed.  */\n   if (!optimize)\n     {\n+      hash_table <ssa_name_var_hash> ssa_name_hash;\n+\n       ssa_name_hash.create (10);\n       for (i = 1; i < num_ssa_names; i++)\n \t{"}]}