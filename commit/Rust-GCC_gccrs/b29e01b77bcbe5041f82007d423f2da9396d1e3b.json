{"sha": "b29e01b77bcbe5041f82007d423f2da9396d1e3b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjI5ZTAxYjc3YmNiZTUwNDFmODIwMDdkNDIzZjJkYTkzOTZkMWUzYg==", "commit": {"author": {"name": "Janis Johnson", "email": "janisjo@codesourcery.com", "date": "2012-06-12T20:27:49Z"}, "committer": {"name": "Janis Johnson", "email": "janis@gcc.gnu.org", "date": "2012-06-12T20:27:49Z"}, "message": "stackalign.exp: Combine stack alignment torture options with usual torture options.\n\n\t* gcc.dg/torture/stackalign/stackalign.exp: Combine stack\n\talignment torture options with usual torture options.\n\t* gcc.dg/torture/stackalign/alloca-2.c: Use dg-additional-options\n\tinstead of dg-options.\n\t* gcc.dg/torture/stackalign/alloca-3.c: Likewise.\n\t* gcc.dg/torture/stackalign/alloca-4.c: Likewise.\n\t* gcc.dg/torture/stackalign/alloca-5.c: Likewise.\n\t* gcc.dg/torture/stackalign/alloca-6.c: Likewise.\n\t* gcc.dg/torture/stackalign/push-1.c: Likewise.\n\t* gcc.dg/torture/stackalign/vararg-3.c: Likewise.\n\nFrom-SVN: r188481", "tree": {"sha": "ce8ee89bb7454488f2461fdff63f183562cd48f2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ce8ee89bb7454488f2461fdff63f183562cd48f2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b29e01b77bcbe5041f82007d423f2da9396d1e3b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b29e01b77bcbe5041f82007d423f2da9396d1e3b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b29e01b77bcbe5041f82007d423f2da9396d1e3b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b29e01b77bcbe5041f82007d423f2da9396d1e3b/comments", "author": null, "committer": null, "parents": [{"sha": "a637d2cb48139ed2ab31a383757a3bc625510de2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a637d2cb48139ed2ab31a383757a3bc625510de2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a637d2cb48139ed2ab31a383757a3bc625510de2"}], "stats": {"total": 77, "additions": 54, "deletions": 23}, "files": [{"sha": "2f7f3f18abad02c0bd9ed4fa14913d2b4c2bbbb7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b29e01b77bcbe5041f82007d423f2da9396d1e3b", "patch": "@@ -1,5 +1,16 @@\n 2012-06-12  Janis Johnson  <janisjo@codesourcery.com>\n \n+\t* gcc.dg/torture/stackalign/stackalign.exp: Combine stack\n+\talignment torture options with usual torture options.\n+\t* gcc.dg/torture/stackalign/alloca-2.c: Use dg-additional-options\n+\tinstead of dg-options.\n+\t* gcc.dg/torture/stackalign/alloca-3.c: Likewise.\n+\t* gcc.dg/torture/stackalign/alloca-4.c: Likewise.\n+\t* gcc.dg/torture/stackalign/alloca-5.c: Likewise.\n+\t* gcc.dg/torture/stackalign/alloca-6.c: Likewise.\n+\t* gcc.dg/torture/stackalign/push-1.c: Likewise.\n+\t* gcc.dg/torture/stackalign/vararg-3.c: Likewise.\n+\n \t* gcc.target/arm/di-longlong64-sync-withhelpers.c: Add comments\n \tto checks for multiple messages reported for one line of source code.\n \t* gcc.target/arm/di-longlong64-sync-withldrexd.c: Likewise."}, {"sha": "2ef17629d7b13fdce21d7c26c8b67da8c2104bb2", "filename": "gcc/testsuite/gcc.dg/torture/stackalign/alloca-2.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Falloca-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Falloca-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Falloca-2.c?ref=b29e01b77bcbe5041f82007d423f2da9396d1e3b", "patch": "@@ -1,6 +1,6 @@\n /* PR middle-end/37009 */\n /* { dg-do run { target { { i?86-*-* x86_64-*-* } && ia32 } } } */\n-/* { dg-options \"-msse2\" } */\n+/* { dg-additional-options \"-mmmx -msse2\" } */\n /* { dg-require-effective-target sse2_runtime } */\n \n #include <emmintrin.h>"}, {"sha": "c3dd12479a24cdcdfce5cb5969e890f54651d0c3", "filename": "gcc/testsuite/gcc.dg/torture/stackalign/alloca-3.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Falloca-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Falloca-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Falloca-3.c?ref=b29e01b77bcbe5041f82007d423f2da9396d1e3b", "patch": "@@ -1,6 +1,6 @@\n /* PR middle-end/37009 */\n /* { dg-do run { target { { i?86-*-* x86_64-*-* } && ilp32 } } } */\n-/* { dg-options \"-msse2\" } */\n+/* { dg-additional-options \"-mmmx -msse2\" } */\n /* { dg-require-effective-target sse2_runtime } */\n \n #include <emmintrin.h>"}, {"sha": "bc16f5789035cc3d83cdb56f232bf9e0bd36d0fb", "filename": "gcc/testsuite/gcc.dg/torture/stackalign/alloca-4.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Falloca-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Falloca-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Falloca-4.c?ref=b29e01b77bcbe5041f82007d423f2da9396d1e3b", "patch": "@@ -1,6 +1,6 @@\n /* PR middle-end/37009 */\n /* { dg-do run { target { { i?86-*-* x86_64-*-* } && ia32 } } } */\n-/* { dg-options \"-mincoming-stack-boundary=2 -mpreferred-stack-boundary=2\" } */\n+/* { dg-additional-options \"-mincoming-stack-boundary=2 -mpreferred-stack-boundary=2\" } */\n \n #include \"check.h\"\n "}, {"sha": "4c6506d1ab17f6adefaf4c6dc651f7e614a92de3", "filename": "gcc/testsuite/gcc.dg/torture/stackalign/alloca-5.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Falloca-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Falloca-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Falloca-5.c?ref=b29e01b77bcbe5041f82007d423f2da9396d1e3b", "patch": "@@ -1,6 +1,6 @@\n /* PR middle-end/45234 */\n /* { dg-do run { target { { i?86-*-* x86_64-*-* } && ia32 } } } */\n-/* { dg-options \"-mincoming-stack-boundary=2 -mpreferred-stack-boundary=2\" } */\n+/* { dg-additional-options \"-mincoming-stack-boundary=2 -mpreferred-stack-boundary=2\" } */\n \n #include \"check.h\"\n "}, {"sha": "301fff7a202f3ce4794e8a5841181f83b8fc164b", "filename": "gcc/testsuite/gcc.dg/torture/stackalign/alloca-6.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Falloca-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Falloca-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Falloca-6.c?ref=b29e01b77bcbe5041f82007d423f2da9396d1e3b", "patch": "@@ -1,6 +1,6 @@\n /* PR middle-end/45234 */\n /* { dg-do run { target { { i?86-*-* x86_64-*-* } && ia32 } } } */\n-/* { dg-options \"-mincoming-stack-boundary=2 -mpreferred-stack-boundary=2\" } */\n+/* { dg-additional-options \"-mincoming-stack-boundary=2 -mpreferred-stack-boundary=2\" } */\n \n #include \"check.h\"\n "}, {"sha": "c23faf411c48a04526a4e1f2c6798dc264c3560f", "filename": "gcc/testsuite/gcc.dg/torture/stackalign/push-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Fpush-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Fpush-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Fpush-1.c?ref=b29e01b77bcbe5041f82007d423f2da9396d1e3b", "patch": "@@ -1,6 +1,6 @@\n /* PR middle-end/37010 */\n /* { dg-do run { target { { i?86-*-* x86_64-*-* } && ia32 } } } */\n-/* { dg-options \"-msse2 -mpreferred-stack-boundary=2\" } */\n+/* { dg-additional-options \"-mmmx -msse2 -mpreferred-stack-boundary=2\" } */\n /* { dg-require-effective-target sse2_runtime } */\n \n #include <emmintrin.h>"}, {"sha": "dafac8de18e67189e12bc36ddef54301fe330d11", "filename": "gcc/testsuite/gcc.dg/torture/stackalign/stackalign.exp", "status": "modified", "additions": 36, "deletions": 16, "changes": 52, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Fstackalign.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Fstackalign.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Fstackalign.exp?ref=b29e01b77bcbe5041f82007d423f2da9396d1e3b", "patch": "@@ -1,4 +1,4 @@\n-# Copyright (C) 2008, 2010\n+# Copyright (C) 2008, 2010, 2012\n # Free Software Foundation, Inc.\n \n # This program is free software; you can redistribute it and/or modify\n@@ -18,33 +18,53 @@\n # This harness is for tests that should be run at all optimisation levels.\n \n load_lib gcc-dg.exp\n+load_lib torture-options.exp\n \n-set additional_flags \"\"\n+global DG_TORTURE_OPTIONS LTO_TORTURE_OPTIONS\n+\n+dg-init\n+torture-init\n+\n+# default_flags are replaced by a dg-options test directive, or appended\n+# to by using dg-additional-options.  Use default_flags for options that\n+# are used in all of the torture sets to limit the amount of noise in\n+# test summaries.\n+set default_flags \"\"\n+\n+# torture_flags are combined with other torture options and do not\n+# affect options specified within a test.\n+set torture_flags \"\"\n+\n+set stackalign_options [list]\n if { [check_effective_target_automatic_stack_alignment] } then {\n-    lappend additional_flags \"-mstackrealign\"\n-    lappend additional_flags \"-mpreferred-stack-boundary=5\"\n+    append default_flags \" -mstackrealign\"\n+    append default_flags \" -mpreferred-stack-boundary=5\"\n }\n if { [istarget i?86*-*-*] || [istarget x86_64-*-*] } then {\n-    lappend additional_flags \"-mno-mmx\"\n+    append default_flags \" -mno-mmx\"\n }\n+lappend stackalign_options [join $torture_flags]\n \n-dg-init\n-\n-gcc-dg-runtest [lsort [glob $srcdir/$subdir/*.c]] $additional_flags\n if { [check_effective_target_fpic] } then {\n-    set pic_additional_flags $additional_flags\n-    lappend pic_additional_flags \"-fpic\"\n-    gcc-dg-runtest [lsort [glob $srcdir/$subdir/*.c]] $pic_additional_flags\n+    set pic_torture_flags $torture_flags\n+    append pic_torture_flags \" -fpic\"\n+    lappend stackalign_options [join $pic_torture_flags]\n }\n \n if { [check_effective_target_automatic_stack_alignment] } then {\n-    lappend additional_flags \"-mforce-drap\"\n-    gcc-dg-runtest [lsort [glob $srcdir/$subdir/*.c]] $additional_flags\n+    append torture_flags \" -mforce-drap\"\n+    lappend stackalign_options [join $torture_flags]\n     if { [check_effective_target_fpic] } then {\n-\tset pic_additional_flags $additional_flags\n-\tlappend pic_additional_flags \"-fpic\"\n-\tgcc-dg-runtest [lsort [glob $srcdir/$subdir/*.c]] $pic_additional_flags\n+\tset pic_torture_flags $torture_flags\n+\tappend pic_torture_flags \" -fpic\"\n+\tlappend stackalign_options [join $pic_torture_flags]\n     }\n }\n \n+# Combine stackalign options with the usual torture optimization flags.\n+set-torture-options [concat $DG_TORTURE_OPTIONS $LTO_TORTURE_OPTIONS] $stackalign_options\n+\n+gcc-dg-runtest [lsort [glob $srcdir/$subdir/*.c]] \"$default_flags\"\n+\n+torture-finish\n dg-finish"}, {"sha": "baf398c12e7e2f2795790c90125f1443572189fa", "filename": "gcc/testsuite/gcc.dg/torture/stackalign/vararg-3.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Fvararg-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29e01b77bcbe5041f82007d423f2da9396d1e3b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Fvararg-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fstackalign%2Fvararg-3.c?ref=b29e01b77bcbe5041f82007d423f2da9396d1e3b", "patch": "@@ -1,6 +1,6 @@\n /* PR middle-end/37009 */\n /* { dg-do run { target { { i?86-*-* x86_64-*-* } && ilp32 } } } */\n-/* { dg-options \"-msse2\" } */\n+/* { dg-additional-options \"-mmmx -msse2\" } */\n /* { dg-require-effective-target sse2_runtime } */\n \n #include <stdarg.h>"}]}