{"sha": "a16f235752abdce78d8e5f608762a207f4973f13", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTE2ZjIzNTc1MmFiZGNlNzhkOGU1ZjYwODc2MmEyMDdmNDk3M2YxMw==", "commit": {"author": {"name": "Geoffrey Keating", "email": "geoffk@apple.com", "date": "2002-11-27T01:59:43Z"}, "committer": {"name": "Geoffrey Keating", "email": "geoffk@gcc.gnu.org", "date": "2002-11-27T01:59:43Z"}, "message": "Index: cp/ChangeLog\n2002-11-26  Geoffrey Keating  <geoffk@apple.com>\n\n\t* decl.c (check_initializer): Don't error on initialisation of\n\ta scalar with a brace-enclosed expression.\n\nIndex: testsuite/ChangeLog\n2002-11-26  Geoffrey Keating  <geoffk@apple.com>\n\n\t* g++.dg/init/brace2.C: New test.\n\t* g++.old-deja/g++.mike/p9129.C: Correct.\n\nFrom-SVN: r59553", "tree": {"sha": "db5500814feb0e745c846f219176878af5153a6e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/db5500814feb0e745c846f219176878af5153a6e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a16f235752abdce78d8e5f608762a207f4973f13", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a16f235752abdce78d8e5f608762a207f4973f13", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a16f235752abdce78d8e5f608762a207f4973f13", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a16f235752abdce78d8e5f608762a207f4973f13/comments", "author": {"login": "geoffk01", "id": 31905243, "node_id": "MDQ6VXNlcjMxOTA1MjQz", "avatar_url": "https://avatars.githubusercontent.com/u/31905243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/geoffk01", "html_url": "https://github.com/geoffk01", "followers_url": "https://api.github.com/users/geoffk01/followers", "following_url": "https://api.github.com/users/geoffk01/following{/other_user}", "gists_url": "https://api.github.com/users/geoffk01/gists{/gist_id}", "starred_url": "https://api.github.com/users/geoffk01/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/geoffk01/subscriptions", "organizations_url": "https://api.github.com/users/geoffk01/orgs", "repos_url": "https://api.github.com/users/geoffk01/repos", "events_url": "https://api.github.com/users/geoffk01/events{/privacy}", "received_events_url": "https://api.github.com/users/geoffk01/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0ef08cc42e3010f897e2ba1b71d78c47356ed13a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ef08cc42e3010f897e2ba1b71d78c47356ed13a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0ef08cc42e3010f897e2ba1b71d78c47356ed13a"}], "stats": {"total": 34, "additions": 32, "deletions": 2}, "files": [{"sha": "42ae0dda194dfc462476fd714584b34a24ca430e", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a16f235752abdce78d8e5f608762a207f4973f13/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a16f235752abdce78d8e5f608762a207f4973f13/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=a16f235752abdce78d8e5f608762a207f4973f13", "patch": "@@ -1,3 +1,8 @@\n+2002-11-26  Geoffrey Keating  <geoffk@apple.com>\n+\n+\t* decl.c (check_initializer): Don't error on initialisation of\n+\ta scalar with a brace-enclosed expression.\n+\n 2002-11-26  Nathan Sidwell  <nathan@codesourcery.com>\n \n \t* cp-tree.h (DECL_LANG_FLAG_4): Document more uses."}, {"sha": "5a30e5b5ef322f24f9d7b958f665b9108dd1d232", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a16f235752abdce78d8e5f608762a207f4973f13/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a16f235752abdce78d8e5f608762a207f4973f13/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=a16f235752abdce78d8e5f608762a207f4973f13", "patch": "@@ -8017,7 +8017,19 @@ check_initializer (tree decl, tree init, int flags)\n   else if (init)\n     {\n       if (TREE_CODE (init) == CONSTRUCTOR && TREE_HAS_CONSTRUCTOR (init))\n-\tinit = reshape_init (type, &init);\n+\t{\n+\t  /* [dcl.init] paragraph 13,\n+\t     If T is a scalar type, then a declaration of the form\n+\t     T x = { a };\n+\t     is equivalent to\n+\t     T x = a;\n+\t     \n+\t     reshape_init will complain about the extra braces,\n+\t     and doesn't do anything useful in the case where TYPE is\n+\t     scalar, so just don't call it.  */\n+\t  if (CP_AGGREGATE_TYPE_P (type))\n+\t    init = reshape_init (type, &init);\n+\t}\n \n       /* If DECL has an array type without a specific bound, deduce the\n \t array size from the initializer.  */"}, {"sha": "d9a69fcedc5a2e76ff2285dbeb955efff8a00f3c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a16f235752abdce78d8e5f608762a207f4973f13/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a16f235752abdce78d8e5f608762a207f4973f13/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a16f235752abdce78d8e5f608762a207f4973f13", "patch": "@@ -1,3 +1,8 @@\n+2002-11-26  Geoffrey Keating  <geoffk@apple.com>\n+\n+\t* g++.dg/init/brace2.C: New test.\n+\t* g++.old-deja/g++.mike/p9129.C: Correct.\n+\n 2002-11-26  Mark Mitchell  <mark@codesourcery.com>\n \n \t* g++.dg/abi/empty10.C: Don't run on non-x86 targets."}, {"sha": "488d916aa424bee90d54433b212c4aa59670da9d", "filename": "gcc/testsuite/g++.dg/init/brace2.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a16f235752abdce78d8e5f608762a207f4973f13/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finit%2Fbrace2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a16f235752abdce78d8e5f608762a207f4973f13/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finit%2Fbrace2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finit%2Fbrace2.C?ref=a16f235752abdce78d8e5f608762a207f4973f13", "patch": "@@ -0,0 +1,8 @@\n+// { dg-do compile }\n+// [dcl.init] paragraph 13.\n+int x = { 2 };\n+const char * y = { \"hello\" };\n+int a = 2;\n+int b = { 2,3 }; // { dg-error \"requires one element\" }\n+int c = { { 2 } } ; // { dg-error \"braces around scalar initializer\" }\n+"}, {"sha": "c8d54853367a28cb640f0b1709d052f6eab0a559", "filename": "gcc/testsuite/g++.old-deja/g++.mike/p9129.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a16f235752abdce78d8e5f608762a207f4973f13/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.mike%2Fp9129.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a16f235752abdce78d8e5f608762a207f4973f13/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.mike%2Fp9129.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.mike%2Fp9129.C?ref=a16f235752abdce78d8e5f608762a207f4973f13", "patch": "@@ -7,6 +7,6 @@ public:\n   int DoSomething();\n };\n \n-int (Foo::*pA)() = { &Foo::DoSomething };\t// ERROR - \n+int (Foo::*pA)() = { &Foo::DoSomething };\n int (Foo::*X[1])(int) = { { &Foo::DoSomething } };\t\t    // ERROR - \n int (Foo::*Y[])(int) = { { &Foo::DoSomething, &Foo::DoSomething, 0 } }; // ERROR - "}]}