{"sha": "ea8eb0b9206661d7ceee7506e97a91309b5f2ae9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWE4ZWIwYjkyMDY2NjFkN2NlZWU3NTA2ZTk3YTkxMzA5YjVmMmFlOQ==", "commit": {"author": {"name": "Kaveh R. Ghazi", "email": "ghazi@caip.rutgers.edu", "date": "2003-08-01T17:48:30Z"}, "committer": {"name": "Kaveh Ghazi", "email": "ghazi@gcc.gnu.org", "date": "2003-08-01T17:48:30Z"}, "message": "builtins.def (ATTR_MATHFN_ERRNO, [...]): New macros.\n\n\t* builtins.def (ATTR_MATHFN_ERRNO, ATTR_MATHFN_FPROUNDING,\n\tATTR_MATHFN_FPROUNDING_ERRNO): New macros.  Use throughout.\n\nFrom-SVN: r70055", "tree": {"sha": "8347c0c7d137da1f16b06e117933981e1b26746d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8347c0c7d137da1f16b06e117933981e1b26746d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ea8eb0b9206661d7ceee7506e97a91309b5f2ae9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea8eb0b9206661d7ceee7506e97a91309b5f2ae9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ea8eb0b9206661d7ceee7506e97a91309b5f2ae9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea8eb0b9206661d7ceee7506e97a91309b5f2ae9/comments", "author": null, "committer": null, "parents": [{"sha": "6ab37e1eef3cdb60f3be462713623ba699e6ef36", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6ab37e1eef3cdb60f3be462713623ba699e6ef36", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6ab37e1eef3cdb60f3be462713623ba699e6ef36"}], "stats": {"total": 155, "additions": 59, "deletions": 96}, "files": [{"sha": "e9aaf210d665f570f706494d67db58ff4ef30297", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ea8eb0b9206661d7ceee7506e97a91309b5f2ae9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ea8eb0b9206661d7ceee7506e97a91309b5f2ae9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ea8eb0b9206661d7ceee7506e97a91309b5f2ae9", "patch": "@@ -1,3 +1,8 @@\n+2003-08-01  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n+\n+\t* builtins.def (ATTR_MATHFN_ERRNO, ATTR_MATHFN_FPROUNDING,\n+\tATTR_MATHFN_FPROUNDING_ERRNO): New macros.  Use throughout.\n+\n 2003-08-01  Andreas Krebbel  <krebbel1@de.ibm.com>\n \n \t* config/s390/s390.c (s390_select_ccmode): Do not attempt to use CCL,"}, {"sha": "32bea772c010c26e2857619a588ce702e9597f9e", "filename": "gcc/builtins.def", "status": "modified", "additions": 54, "deletions": 96, "changes": 150, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ea8eb0b9206661d7ceee7506e97a91309b5f2ae9/gcc%2Fbuiltins.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ea8eb0b9206661d7ceee7506e97a91309b5f2ae9/gcc%2Fbuiltins.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbuiltins.def?ref=ea8eb0b9206661d7ceee7506e97a91309b5f2ae9", "patch": "@@ -105,6 +105,30 @@ Software Foundation, 59 Temple Place - Suite 330, Boston, MA\n   DEF_BUILTIN (ENUM, NAME, BUILT_IN_NORMAL, TYPE, TYPE,\t\\\n    \t       true, true, !flag_isoc99, ATTRS, TARGET_C99_FUNCTIONS)\n \n+/* Define at attribute list for math functions that are normally\n+   \"impure\" because some of them may write into global memory for\n+   `errno'.  If !flag_errno_math they are instead \"const\".  */\n+#undef ATTR_MATHFN_ERRNO\n+#define ATTR_MATHFN_ERRNO (flag_errno_math ? \\\n+\tATTR_NOTHROW_LIST : ATTR_CONST_NOTHROW_LIST)\n+\n+/* Define at attribute list for math functions that are normally\n+   \"pure\" but if flag_unsafe_math_optimizations is set they are\n+   instead \"const\".  This distinction accounts for the fact that some\n+   math functions check the rounding mode which is akin to examing\n+   global memory.  In \"unsafe\" mode we can be less careful.  */\n+#undef ATTR_MATHFN_FPROUNDING\n+#define ATTR_MATHFN_FPROUNDING (flag_unsafe_math_optimizations ? \\\n+\tATTR_CONST_NOTHROW_LIST : ATTR_PURE_NOTHROW_LIST)\n+\n+/* Define at attribute list for math functions that are normally\n+   \"impure\" because some of them may write into global memory for\n+   `errno'.  If !flag_errno_math, we can possibly use \"pure\" or\n+   \"const\" depending on whether we care about FP rounding.  */\n+#undef ATTR_MATHFN_FPROUNDING_ERRNO\n+#define ATTR_MATHFN_FPROUNDING_ERRNO (flag_errno_math ? \\\n+\tATTR_NOTHROW_LIST : ATTR_MATHFN_FPROUNDING)\n+\n \n DEF_LIB_BUILTIN(BUILT_IN_ABORT,\n \t\t\"__builtin_abort\",\n@@ -144,44 +168,32 @@ DEF_GCC_BUILTIN(BUILT_IN_ARGS_INFO,\n DEF_LIB_BUILTIN(BUILT_IN_ATAN,\n \t\t\"__builtin_atan\",\n \t\tBT_FN_DOUBLE_DOUBLE,\n-\t\tflag_unsafe_math_optimizations ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t       : ATTR_PURE_NOTHROW_LIST)\n+\t\tATTR_MATHFN_FPROUNDING)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_ATANF,\n \t\t       \"__builtin_atanf\",\n \t\t       BT_FN_FLOAT_FLOAT,\n-\t\t       flag_unsafe_math_optimizations ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t\t      : ATTR_PURE_NOTHROW_LIST)\n+\t\t       ATTR_MATHFN_FPROUNDING)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_ATANL,\n \t\t       \"__builtin_atanl\",\n \t\t       BT_FN_LONGDOUBLE_LONGDOUBLE,\n-\t\t       flag_unsafe_math_optimizations ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t\t      : ATTR_PURE_NOTHROW_LIST)\n+\t\t       ATTR_MATHFN_FPROUNDING)\n \n DEF_LIB_BUILTIN(BUILT_IN_ATAN2,\n \t\t\"__builtin_atan2\",\n \t\tBT_FN_DOUBLE_DOUBLE_DOUBLE,\n-\t\tflag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t: (flag_unsafe_math_optimizations\n-\t\t\t\t   ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t   : ATTR_PURE_NOTHROW_LIST))\n+\t\tATTR_MATHFN_FPROUNDING_ERRNO)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_ATAN2F,\n \t\t       \"__builtin_atan2f\",\n \t\t       BT_FN_FLOAT_FLOAT_FLOAT,\n-\t\t       flag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t       : (flag_unsafe_math_optimizations\n-\t\t\t\t\t  ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t  : ATTR_PURE_NOTHROW_LIST))\n+\t\t       ATTR_MATHFN_FPROUNDING_ERRNO)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_ATAN2L,\n \t\t       \"__builtin_atan2l\",\n \t\t       BT_FN_LONGDOUBLE_LONGDOUBLE_LONGDOUBLE,\n-\t\t       flag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t       : (flag_unsafe_math_optimizations\n-\t\t\t\t\t  ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t  : ATTR_PURE_NOTHROW_LIST))\n+\t\t       ATTR_MATHFN_FPROUNDING_ERRNO)\n \n /* bcmp has traditionally accepted NULL pointers when the length\n    parameter is zero, so don't apply attribute \"nonnull\".  */\n@@ -297,20 +309,17 @@ DEF_GCC_BUILTIN(BUILT_IN_CONSTANT_P,\n DEF_LIB_BUILTIN(BUILT_IN_COS,\n \t\t\"__builtin_cos\",\n \t\tBT_FN_DOUBLE_DOUBLE,\n-\t\tflag_unsafe_math_optimizations ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t       : ATTR_PURE_NOTHROW_LIST)\n+\t\tATTR_MATHFN_FPROUNDING)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_COSF,\n \t\t       \"__builtin_cosf\",\n \t\t       BT_FN_FLOAT_FLOAT,\n-\t\t       flag_unsafe_math_optimizations ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t\t      : ATTR_PURE_NOTHROW_LIST)\n+\t\t       ATTR_MATHFN_FPROUNDING)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_COSL,\n \t\t       \"__builtin_cosl\",\n \t\t       BT_FN_LONGDOUBLE_LONGDOUBLE,\n-\t\t       flag_unsafe_math_optimizations ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t\t      : ATTR_PURE_NOTHROW_LIST)\n+\t\t       ATTR_MATHFN_FPROUNDING)\n \n DEF_C99_BUILTIN(BUILT_IN_CREAL,\n \t\t\"__builtin_creal\",\n@@ -380,26 +389,17 @@ DEF_C99_BUILTIN(BUILT_IN__EXIT2,\n DEF_LIB_BUILTIN(BUILT_IN_EXP,\n \t\t\"__builtin_exp\",\n \t\tBT_FN_DOUBLE_DOUBLE,\n-\t\tflag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t: (flag_unsafe_math_optimizations\n-\t\t\t\t   ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t   : ATTR_PURE_NOTHROW_LIST))\n+\t\tATTR_MATHFN_FPROUNDING_ERRNO)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_EXPF,\n \t\t       \"__builtin_expf\",\n \t\t       BT_FN_FLOAT_FLOAT,\n-\t\t       flag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t       : (flag_unsafe_math_optimizations\n-\t\t\t\t\t  ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t  : ATTR_PURE_NOTHROW_LIST))\n+\t\t       ATTR_MATHFN_FPROUNDING_ERRNO)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_EXPL,\n \t\t       \"__builtin_expl\",\n \t\t       BT_FN_LONGDOUBLE_LONGDOUBLE,\n-\t\t       flag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t       : (flag_unsafe_math_optimizations\n-\t\t\t\t\t  ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t  : ATTR_PURE_NOTHROW_LIST))\n+\t\t       ATTR_MATHFN_FPROUNDING_ERRNO)\n \n DEF_GCC_BUILTIN(BUILT_IN_EXPECT,\n \t\t\"__builtin_expect\",\n@@ -459,26 +459,17 @@ DEF_C99_C90RES_BUILTIN(BUILT_IN_FLOORL,\n DEF_LIB_BUILTIN(BUILT_IN_FMOD,\n \t\t\"__builtin_fmod\",\n \t\tBT_FN_DOUBLE_DOUBLE_DOUBLE,\n-\t\tflag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t: (flag_unsafe_math_optimizations\n-\t\t\t\t   ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t   : ATTR_PURE_NOTHROW_LIST))\n+\t\tATTR_MATHFN_FPROUNDING_ERRNO)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_FMODF,\n \t\t       \"__builtin_fmodf\",\n \t\t       BT_FN_FLOAT_FLOAT_FLOAT,\n-\t\t       flag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t       : (flag_unsafe_math_optimizations\n-\t\t\t\t\t  ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t  : ATTR_PURE_NOTHROW_LIST))\n+\t\t       ATTR_MATHFN_FPROUNDING_ERRNO)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_FMODL,\n \t\t       \"__builtin_fmodl\",\n \t\t       BT_FN_LONGDOUBLE_LONGDOUBLE_LONGDOUBLE,\n-\t\t       flag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t       : (flag_unsafe_math_optimizations\n-\t\t\t\t\t  ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t  : ATTR_PURE_NOTHROW_LIST))\n+\t\t       ATTR_MATHFN_FPROUNDING_ERRNO)\n \n DEF_LIB_BUILTIN(BUILT_IN_FPRINTF,\n \t\t\"__builtin_fprintf\",\n@@ -618,26 +609,17 @@ DEF_C99_BUILTIN(BUILT_IN_LLABS,\n DEF_LIB_BUILTIN(BUILT_IN_LOG,\n \t\t\"__builtin_log\",\n \t\tBT_FN_DOUBLE_DOUBLE,\n-\t\tflag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t: (flag_unsafe_math_optimizations\n-\t\t\t\t   ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t   : ATTR_PURE_NOTHROW_LIST))\n+\t\tATTR_MATHFN_FPROUNDING_ERRNO)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_LOGF,\n \t\t       \"__builtin_logf\",\n \t\t       BT_FN_FLOAT_FLOAT,\n-\t\t       flag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t       : (flag_unsafe_math_optimizations\n-\t\t\t\t\t  ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t  : ATTR_PURE_NOTHROW_LIST))\n+\t\t       ATTR_MATHFN_FPROUNDING_ERRNO)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_LOGL,\n \t\t       \"__builtin_logl\",\n \t\t       BT_FN_LONGDOUBLE_LONGDOUBLE,\n-\t\t       flag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t       : (flag_unsafe_math_optimizations\n-\t\t\t\t\t  ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t  : ATTR_PURE_NOTHROW_LIST))\n+\t\t       ATTR_MATHFN_FPROUNDING_ERRNO)\n \n DEF_GCC_BUILTIN(BUILT_IN_LONGJMP,\n \t\t\"__builtin_longjmp\",\n@@ -757,26 +739,17 @@ DEF_GCC_BUILTIN(BUILT_IN_POPCOUNTLL,\n DEF_LIB_BUILTIN(BUILT_IN_POW,\n \t\t\"__builtin_pow\",\n \t\tBT_FN_DOUBLE_DOUBLE_DOUBLE,\n-\t\tflag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t: (flag_unsafe_math_optimizations\n-\t\t\t\t   ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t   : ATTR_PURE_NOTHROW_LIST))\n+\t\tATTR_MATHFN_FPROUNDING_ERRNO)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_POWF,\n \t\t       \"__builtin_powf\",\n \t\t       BT_FN_FLOAT_FLOAT_FLOAT,\n-\t\t       flag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t       : (flag_unsafe_math_optimizations\n-\t\t\t\t\t  ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t  : ATTR_PURE_NOTHROW_LIST))\n+\t\t       ATTR_MATHFN_FPROUNDING_ERRNO)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_POWL,\n \t\t       \"__builtin_powl\",\n \t\t       BT_FN_LONGDOUBLE_LONGDOUBLE_LONGDOUBLE,\n-\t\t       flag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t       : (flag_unsafe_math_optimizations\n-\t\t\t\t\t  ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t  : ATTR_PURE_NOTHROW_LIST))\n+\t\t       ATTR_MATHFN_FPROUNDING_ERRNO)\n \n DEF_GCC_BUILTIN(BUILT_IN_PREFETCH,\n \t\t\"__builtin_prefetch\",\n@@ -861,20 +834,17 @@ DEF_GCC_BUILTIN(BUILT_IN_SETJMP,\n DEF_LIB_BUILTIN(BUILT_IN_SIN,\n \t\t\"__builtin_sin\",\n \t\tBT_FN_DOUBLE_DOUBLE,\n-\t\tflag_unsafe_math_optimizations ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t       : ATTR_PURE_NOTHROW_LIST)\n+\t\tATTR_MATHFN_FPROUNDING)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_SINF,\n \t\t       \"__builtin_sinf\",\n \t\t       BT_FN_FLOAT_FLOAT,\n-\t\t       flag_unsafe_math_optimizations ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t\t      : ATTR_PURE_NOTHROW_LIST)\n+\t\t       ATTR_MATHFN_FPROUNDING)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_SINL,\n \t\t       \"__builtin_sinl\",\n \t\t       BT_FN_LONGDOUBLE_LONGDOUBLE,\n-\t\t       flag_unsafe_math_optimizations ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t\t      : ATTR_PURE_NOTHROW_LIST)\n+\t\t       ATTR_MATHFN_FPROUNDING)\n \n DEF_C99_BUILTIN(BUILT_IN_SNPRINTF,\n \t\t\"__builtin_snprintf\",\n@@ -974,44 +944,32 @@ DEF_LIB_BUILTIN(BUILT_IN_STRSTR,\n DEF_LIB_BUILTIN(BUILT_IN_SQRT,\n \t\t\"__builtin_sqrt\",\n \t\tBT_FN_DOUBLE_DOUBLE,\n-\t\tflag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t: (flag_unsafe_math_optimizations\n-\t\t\t\t   ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t   : ATTR_PURE_NOTHROW_LIST))\n+\t\tATTR_MATHFN_FPROUNDING_ERRNO)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_SQRTF,\n \t\t       \"__builtin_sqrtf\",\n \t\t       BT_FN_FLOAT_FLOAT,\n-\t\t       flag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t       : (flag_unsafe_math_optimizations\n-\t\t\t\t\t  ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t  : ATTR_PURE_NOTHROW_LIST))\n+\t\t       ATTR_MATHFN_FPROUNDING_ERRNO)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_SQRTL,\n \t\t       \"__builtin_sqrtl\",\n \t\t       BT_FN_LONGDOUBLE_LONGDOUBLE,\n-\t\t       flag_errno_math ? ATTR_NOTHROW_LIST\n-\t\t\t\t       : (flag_unsafe_math_optimizations\n-\t\t\t\t\t  ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t  : ATTR_PURE_NOTHROW_LIST))\n+\t\t       ATTR_MATHFN_FPROUNDING_ERRNO)\n \n DEF_LIB_BUILTIN(BUILT_IN_TAN,\n \t\t\"__builtin_tan\",\n \t\tBT_FN_DOUBLE_DOUBLE,\n-\t\tflag_unsafe_math_optimizations ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t       : ATTR_PURE_NOTHROW_LIST)\n+\t\tATTR_MATHFN_FPROUNDING)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_TANF,\n \t\t       \"__builtin_tanf\",\n \t\t       BT_FN_FLOAT_FLOAT,\n-\t\t       flag_unsafe_math_optimizations ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t\t      : ATTR_PURE_NOTHROW_LIST)\n+\t\t       ATTR_MATHFN_FPROUNDING)\n \n DEF_C99_C90RES_BUILTIN(BUILT_IN_TANL,\n \t\t       \"__builtin_tanl\",\n \t\t       BT_FN_LONGDOUBLE_LONGDOUBLE,\n-\t\t       flag_unsafe_math_optimizations ? ATTR_CONST_NOTHROW_LIST\n-\t\t\t\t\t\t      : ATTR_PURE_NOTHROW_LIST)\n+\t\t       ATTR_MATHFN_FPROUNDING)\n \n DEF_GCC_BUILTIN(BUILT_IN_TRAP,\n \t\t\"__builtin_trap\","}]}