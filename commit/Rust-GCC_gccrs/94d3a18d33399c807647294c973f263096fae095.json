{"sha": "94d3a18d33399c807647294c973f263096fae095", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTRkM2ExOGQzMzM5OWM4MDc2NDcyOTRjOTczZjI2MzA5NmZhZTA5NQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2017-04-25T09:12:31Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2017-04-25T09:12:31Z"}, "message": "[multiple changes]\n\n2017-04-25  Hristian Kirtchev  <kirtchev@adacore.com>\n\n\t* make.adb, par-ch2.adb, sem_util.adb, scans.ads, sem_ch8.adb,\n\tscn.adb, osint.adb, fname.adb: Minor reformatting.\n\n2017-04-25  Pascal Obry  <obry@adacore.com>\n\n\t* s-taprop-mingw.adb: Do not check for CloseHandle in\n\tFinalize_TCB.\n\nFrom-SVN: r247153", "tree": {"sha": "241695fc84fc443f47ea6b65207c576a7bea745b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/241695fc84fc443f47ea6b65207c576a7bea745b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/94d3a18d33399c807647294c973f263096fae095", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94d3a18d33399c807647294c973f263096fae095", "html_url": "https://github.com/Rust-GCC/gccrs/commit/94d3a18d33399c807647294c973f263096fae095", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94d3a18d33399c807647294c973f263096fae095/comments", "author": null, "committer": null, "parents": [{"sha": "51148ddab1495aa357e57f1c209940f7cde571c1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/51148ddab1495aa357e57f1c209940f7cde571c1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/51148ddab1495aa357e57f1c209940f7cde571c1"}], "stats": {"total": 176, "additions": 112, "deletions": 64}, "files": [{"sha": "23ba472288127c7704afc1eb164132d607abc480", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=94d3a18d33399c807647294c973f263096fae095", "patch": "@@ -1,3 +1,13 @@\n+2017-04-25  Hristian Kirtchev  <kirtchev@adacore.com>\n+\n+\t* make.adb, par-ch2.adb, sem_util.adb, scans.ads, sem_ch8.adb,\n+\tscn.adb, osint.adb, fname.adb: Minor reformatting.\n+\n+2017-04-25  Pascal Obry  <obry@adacore.com>\n+\n+\t* s-taprop-mingw.adb: Do not check for CloseHandle in\n+\tFinalize_TCB.\n+\n 2017-04-25  Hristian Kirtchev  <kirtchev@adacore.com>\n \n \t* sem_util.adb (Check_Part_Of_Reference):"}, {"sha": "5905dfb9b39f9e9fe7226b53f7d48fb641258814", "filename": "gcc/ada/fname.adb", "status": "modified", "additions": 56, "deletions": 28, "changes": 84, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Ffname.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Ffname.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Ffname.adb?ref=94d3a18d33399c807647294c973f263096fae095", "patch": "@@ -57,25 +57,26 @@ package body Fname is\n      Table_Increment      => Alloc.SFN_Table_Increment,\n      Table_Name           => \"Fname_Dummy_Table\");\n \n+   function Has_Internal_Extension (Fname : String) return Boolean;\n+   --  True if the extension is \".ads\" or \".adb\", as is always the case for\n+   --  internal/predefined units.\n+\n    function Has_Prefix (X, Prefix : String) return Boolean;\n    --  True if Prefix is at the beginning of X. For example,\n    --  Has_Prefix(\"a-filename.ads\", Prefix => \"a-\") is True.\n \n    function Has_Suffix (X, Suffix : String) return Boolean;\n    --  True if Suffix is at the end of X\n \n-   function Has_Internal_Extension (Fname : String) return Boolean;\n-   --  True if the extension is \".ads\" or \".adb\", as is always the case for\n-   --  internal/predefined units.\n-\n    ----------------------------\n    -- Has_Internal_Extension --\n    ----------------------------\n \n    function Has_Internal_Extension (Fname : String) return Boolean is\n    begin\n-      return Has_Suffix (Fname, Suffix => \".ads\")\n-        or else Has_Suffix (Fname, Suffix => \".adb\");\n+      return\n+        Has_Suffix (Fname, Suffix => \".ads\")\n+          or else Has_Suffix (Fname, Suffix => \".adb\");\n    end Has_Internal_Extension;\n \n    ----------------\n@@ -87,7 +88,7 @@ package body Fname is\n       if X'Length >= Prefix'Length then\n          declare\n             Slice : String renames\n-              X (X'First .. X'First + Prefix'Length - 1);\n+                      X (X'First .. X'First + Prefix'Length - 1);\n          begin\n             return Slice = Prefix;\n          end;\n@@ -104,7 +105,7 @@ package body Fname is\n       if X'Length >= Suffix'Length then\n          declare\n             Slice : String renames\n-              X (X'Last - Suffix'Length + 1 .. X'Last);\n+                      X (X'Last - Suffix'Length + 1 .. X'Last);\n          begin\n             return Slice = Suffix;\n          end;\n@@ -118,7 +119,8 @@ package body Fname is\n \n    function Is_Internal_File_Name\n      (Fname              : String;\n-      Renamings_Included : Boolean := True) return Boolean is\n+      Renamings_Included : Boolean := True) return Boolean\n+   is\n    begin\n       --  Check for internal extensions first, so we don't think (e.g.)\n       --  \"gnat.adc\" is internal.\n@@ -127,18 +129,20 @@ package body Fname is\n          return False;\n       end if;\n \n-      return Is_Predefined_File_Name (Fname, Renamings_Included)\n-        or else Has_Prefix (Fname, Prefix => \"g-\")\n-        or else Has_Prefix (Fname, Prefix => \"gnat.ad\");\n+      return\n+        Is_Predefined_File_Name (Fname, Renamings_Included)\n+          or else Has_Prefix (Fname, Prefix => \"g-\")\n+          or else Has_Prefix (Fname, Prefix => \"gnat.ad\");\n    end Is_Internal_File_Name;\n \n    function Is_Internal_File_Name\n      (Fname              : File_Name_Type;\n       Renamings_Included : Boolean := True) return Boolean\n    is\n    begin\n-      return Is_Internal_File_Name\n-        (Get_Name_String (Fname), Renamings_Included);\n+      return\n+        Is_Internal_File_Name\n+          (Get_Name_String (Fname), Renamings_Included);\n    end Is_Internal_File_Name;\n \n    -----------------------------\n@@ -147,7 +151,8 @@ package body Fname is\n \n    function Is_Predefined_File_Name\n      (Fname              : String;\n-      Renamings_Included : Boolean := True) return Boolean is\n+      Renamings_Included : Boolean := True) return Boolean\n+   is\n    begin\n       if not Has_Internal_Extension (Fname) then\n          return False;\n@@ -166,9 +171,9 @@ package body Fname is\n          return False;\n       end if;\n \n-      if Has_Prefix (Fname, Prefix => \"ada.ad\") -- Ada\n-        or else Has_Prefix (Fname, Prefix => \"interfac.ad\") -- Interfaces\n-        or else Has_Prefix (Fname, Prefix => \"system.ad\") -- System\n+      if Has_Prefix (Fname, Prefix => \"ada.ad\")              --  Ada\n+        or else Has_Prefix (Fname, Prefix => \"interfac.ad\")  --  Interfaces\n+        or else Has_Prefix (Fname, Prefix => \"system.ad\")    --  System\n       then\n          return True;\n       end if;\n@@ -179,25 +184,48 @@ package body Fname is\n \n       --  The following are the predefined renamings\n \n-      return Has_Prefix (Fname, Prefix => \"calendar.ad\") -- Calendar\n-        or else Has_Prefix (Fname, Prefix => \"machcode.ad\") -- Machine_Code\n-        or else Has_Prefix (Fname, Prefix => \"unchconv.ad\")\n+      return\n+         --  Calendar\n+\n+        Has_Prefix (Fname, Prefix => \"calendar.ad\")\n+\n+         --  Machine_Code\n+\n+          or else Has_Prefix (Fname, Prefix => \"machcode.ad\")\n+\n          --  Unchecked_Conversion\n-        or else Has_Prefix (Fname, Prefix => \"unchdeal.ad\")\n+\n+          or else Has_Prefix (Fname, Prefix => \"unchconv.ad\")\n+\n          --  Unchecked_Deallocation\n-        or else Has_Prefix (Fname, Prefix => \"directio.ad\") -- Direct_IO\n-        or else Has_Prefix (Fname, Prefix => \"ioexcept.ad\") -- IO_Exceptions\n-        or else Has_Prefix (Fname, Prefix => \"sequenio.ad\") -- Sequential_IO\n-        or else Has_Prefix (Fname, Prefix => \"text_io.ad\"); -- Text_IO\n+\n+          or else Has_Prefix (Fname, Prefix => \"unchdeal.ad\")\n+\n+         --  Direct_IO\n+\n+          or else Has_Prefix (Fname, Prefix => \"directio.ad\")\n+\n+         --  IO_Exceptions\n+\n+          or else Has_Prefix (Fname, Prefix => \"ioexcept.ad\")\n+\n+         --  Sequential_IO\n+\n+          or else Has_Prefix (Fname, Prefix => \"sequenio.ad\")\n+\n+         --  Text_IO\n+\n+          or else Has_Prefix (Fname, Prefix => \"text_io.ad\");\n    end Is_Predefined_File_Name;\n \n    function Is_Predefined_File_Name\n      (Fname              : File_Name_Type;\n       Renamings_Included : Boolean := True) return Boolean\n    is\n    begin\n-      return Is_Predefined_File_Name\n-        (Get_Name_String (Fname), Renamings_Included);\n+      return\n+        Is_Predefined_File_Name\n+          (Get_Name_String (Fname), Renamings_Included);\n    end Is_Predefined_File_Name;\n \n    ---------------"}, {"sha": "d6ea05bd5f19fdd703e048711018ba206c3e11f9", "filename": "gcc/ada/make.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Fmake.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Fmake.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmake.adb?ref=94d3a18d33399c807647294c973f263096fae095", "patch": "@@ -2945,7 +2945,7 @@ package body Make is\n \n          begin\n             if Is_Predefined_File_Name\n-              (Fname, Renamings_Included => False)\n+                 (Fname, Renamings_Included => False)\n             then\n                if Check_Readonly_Files or else Must_Compile then\n                   Comp_Args (Comp_Args'First + 2 .. Comp_Last + 1) :="}, {"sha": "2a3b1c3dbcae568de322cf578284f22082b8ea6b", "filename": "gcc/ada/osint.adb", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Fosint.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Fosint.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fosint.adb?ref=94d3a18d33399c807647294c973f263096fae095", "patch": "@@ -1187,7 +1187,7 @@ package body Osint is\n                      and then Name_Buffer (Name_Len - 2 .. Name_Len) = \".dg\")\n          then\n             Found := N;\n-            Attr.all  := Unknown_Attributes;\n+            Attr.all := Unknown_Attributes;\n \n             if T = Config then\n                if Full_Name then\n@@ -1199,7 +1199,7 @@ package body Osint is\n                   begin\n                      Name_Buffer (1 .. Full_Size) := Full_Path;\n                      Name_Len := Full_Size;\n-                     Found := Name_Find;\n+                     Found    := Name_Find;\n                   end;\n                end if;\n "}, {"sha": "fc8d9cbd72174073d1d525f2f8862a14280897e0", "filename": "gcc/ada/par-ch2.adb", "status": "modified", "additions": 26, "deletions": 22, "changes": 48, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Fpar-ch2.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Fpar-ch2.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fpar-ch2.adb?ref=94d3a18d33399c807647294c973f263096fae095", "patch": "@@ -224,26 +224,6 @@ package body Ch2 is\n    --  in fact the bodies ARE present, supplied by these pragmas.\n \n    function P_Pragma (Skipping : Boolean := False) return Node_Id is\n-      Interface_Check_Required : Boolean := False;\n-      --  Set True if check of pragma INTERFACE is required\n-\n-      Import_Check_Required : Boolean := False;\n-      --  Set True if check of pragma IMPORT is required\n-\n-      Arg_Count : Nat := 0;\n-      --  Number of argument associations processed\n-\n-      Identifier_Seen : Boolean := False;\n-      --  Set True if an identifier is encountered for a pragma argument. Used\n-      --  to check that there are no more arguments without identifiers.\n-\n-      Prag_Node     : Node_Id;\n-      Prag_Name     : Name_Id;\n-      Semicolon_Loc : Source_Ptr;\n-      Ident_Node    : Node_Id;\n-      Assoc_Node    : Node_Id;\n-      Result        : Node_Id;\n-\n       procedure Skip_Pragma_Semicolon;\n       --  Skip past semicolon at end of pragma\n \n@@ -265,6 +245,28 @@ package body Ch2 is\n          end if;\n       end Skip_Pragma_Semicolon;\n \n+      --  Local variables\n+\n+      Interface_Check_Required : Boolean := False;\n+      --  Set True if check of pragma INTERFACE is required\n+\n+      Import_Check_Required : Boolean := False;\n+      --  Set True if check of pragma IMPORT is required\n+\n+      Arg_Count : Nat := 0;\n+      --  Number of argument associations processed\n+\n+      Identifier_Seen : Boolean := False;\n+      --  Set True if an identifier is encountered for a pragma argument. Used\n+      --  to check that there are no more arguments without identifiers.\n+\n+      Assoc_Node    : Node_Id;\n+      Ident_Node    : Node_Id;\n+      Prag_Name     : Name_Id;\n+      Prag_Node     : Node_Id;\n+      Result        : Node_Id;\n+      Semicolon_Loc : Source_Ptr;\n+\n    --  Start of processing for P_Pragma\n \n    begin\n@@ -366,8 +368,8 @@ package body Ch2 is\n       --  Cancel indication of being within a pragma or in particular a Depends\n       --  pragma.\n \n-      Inside_Pragma  := False;\n       Inside_Depends := False;\n+      Inside_Pragma  := False;\n \n       --  Now we have two tasks left, we need to scan out the semicolon\n       --  following the pragma, and we have to call Par.Prag to process\n@@ -390,10 +392,12 @@ package body Ch2 is\n          Skip_Pragma_Semicolon;\n          return Par.Prag (Prag_Node, Semicolon_Loc);\n       end if;\n+\n    exception\n       when Error_Resync =>\n          Resync_Past_Semicolon;\n-         Inside_Pragma := False;\n+         Inside_Depends := False;\n+         Inside_Pragma  := False;\n          return Error;\n    end P_Pragma;\n "}, {"sha": "e3d0842953ce53c85091b6874c4f39daa22efe49", "filename": "gcc/ada/s-taprop-mingw.adb", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Fs-taprop-mingw.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Fs-taprop-mingw.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-taprop-mingw.adb?ref=94d3a18d33399c807647294c973f263096fae095", "patch": "@@ -958,6 +958,7 @@ package body System.Task_Primitives.Operations is\n \n    procedure Finalize_TCB (T : Task_Id) is\n       Succeeded : BOOL;\n+      pragma Unreferenced (Succeeded);\n \n    begin\n       if not Single_Lock then\n@@ -976,7 +977,10 @@ package body System.Task_Primitives.Operations is\n          --  is needed to release system resources.\n \n          Succeeded := CloseHandle (T.Common.LL.Thread);\n-         pragma Assert (Succeeded = Win32.TRUE);\n+         --  Note that we do not check for the returned value, this is\n+         --  because the above call will fail for a foreign thread. But\n+         --  we still need to call it to properly close Ada tasks created\n+         --  with CreateThread() in Create_Task above.\n       end if;\n \n       ATCB_Allocation.Free_ATCB (T);"}, {"sha": "428c1a5b9750891a76cdef0816b8d9f125125805", "filename": "gcc/ada/scans.ads", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Fscans.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Fscans.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fscans.ads?ref=94d3a18d33399c807647294c973f263096fae095", "patch": "@@ -484,10 +484,6 @@ package Scans is\n    --  Is it really right for this to be a Name rather than a String, what\n    --  about the case of Wide_Wide_Characters???\n \n-   Inside_Pragma : Boolean := False;\n-   --  True within a pragma. Used to avoid complaining about reserved words\n-   --  within pragmas (see Scan_Reserved_Identifier).\n-\n    Inside_Depends : Boolean := False;\n    --  True while parsing the argument of a Depends pragma or aspect (used to\n    --  allow/require non-standard style rules for =>+ with -gnatyt).\n@@ -497,6 +493,10 @@ package Scans is\n    --  expression (incremented on entry, decremented on exit). It is used to\n    --  disconnect format checks that normally apply to keywords THEN, ELSE etc.\n \n+   Inside_Pragma : Boolean := False;\n+   --  True within a pragma. Used to avoid complaining about reserved words\n+   --  within pragmas (see Scan_Reserved_Identifier).\n+\n    --------------------------------------------------------\n    -- Procedures for Saving and Restoring the Scan State --\n    --------------------------------------------------------"}, {"sha": "f5a519055a0b958fbb725a60996311bd6e9c3068", "filename": "gcc/ada/scn.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Fscn.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Fscn.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fscn.adb?ref=94d3a18d33399c807647294c973f263096fae095", "patch": "@@ -378,8 +378,9 @@ package body Scn is\n    ------------------------------\n \n    procedure Scan_Reserved_Identifier (Force_Msg : Boolean) is\n-      Token_Chars : String := Token_Type'Image (Token);\n+      Token_Chars : String  := Token_Type'Image (Token);\n       Len         : Natural := 0;\n+\n    begin\n       --  AI12-0125 : '@' denotes the target_name, i.e. serves as an\n       --  abbreviation for the LHS of an assignment."}, {"sha": "ee6bcddcaf01f80e1539c6502d717bd9b3d707ee", "filename": "gcc/ada/sem_ch8.adb", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Fsem_ch8.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Fsem_ch8.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch8.adb?ref=94d3a18d33399c807647294c973f263096fae095", "patch": "@@ -3632,9 +3632,9 @@ package body Sem_Ch8 is\n \n       if Is_Predefined_File_Name (Unit_File_Name (Current_Sem_Unit))\n         and then Get_Name_String\n-          (Unit_File_Name (Current_Sem_Unit)) (1 .. 3) /= \"a-n\"\n-        and then\n-          Nkind (Unit (Cunit (Current_Sem_Unit))) = N_Package_Declaration\n+                   (Unit_File_Name (Current_Sem_Unit)) (1 .. 3) /= \"a-n\"\n+        and then Nkind (Unit (Cunit (Current_Sem_Unit))) =\n+                   N_Package_Declaration\n       then\n          Error_Msg_N (\"use clause not allowed in predefined spec\", N);\n       end if;"}, {"sha": "144fd7d92fc6fe22011d990d4caf4075f50c20fc", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94d3a18d33399c807647294c973f263096fae095/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=94d3a18d33399c807647294c973f263096fae095", "patch": "@@ -20517,8 +20517,9 @@ package body Sem_Util is\n \n    function Should_Ignore_Pragma (Prag_Name : Name_Id) return Boolean is\n    begin\n-      return not Is_Internal_File_Name (File_Name (Current_Source_File))\n-        and then Get_Name_Table_Boolean3 (Prag_Name);\n+      return\n+        not Is_Internal_File_Name (File_Name (Current_Source_File))\n+          and then Get_Name_Table_Boolean3 (Prag_Name);\n    end Should_Ignore_Pragma;\n \n    --------------------"}]}