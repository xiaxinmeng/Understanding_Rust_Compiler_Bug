{"sha": "194c524aa2f34e1389c4ddd31b20eea15eae00bb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTk0YzUyNGFhMmYzNGUxMzg5YzRkZGQzMWIyMGVlYTE1ZWFlMDBiYg==", "commit": {"author": {"name": "David Edelsohn", "email": "edelsohn@gnu.org", "date": "2006-04-30T19:23:13Z"}, "committer": {"name": "David Edelsohn", "email": "dje@gcc.gnu.org", "date": "2006-04-30T19:23:13Z"}, "message": "rs6000.c (rs6000_override_options): Enable TARGET_NO_FP_IN_TOC for section anchors.\n\n        * config/rs6000/rs6000.c (rs6000_override_options): Enable\n        TARGET_NO_FP_IN_TOC for section anchors.\n        (optimization_options): Enable section anchors for all\n        non-\"Objective\" languages.\n\nFrom-SVN: r113395", "tree": {"sha": "17238bdcbef9e54e38535fb243c6f612ad701406", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/17238bdcbef9e54e38535fb243c6f612ad701406"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/194c524aa2f34e1389c4ddd31b20eea15eae00bb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/194c524aa2f34e1389c4ddd31b20eea15eae00bb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/194c524aa2f34e1389c4ddd31b20eea15eae00bb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/194c524aa2f34e1389c4ddd31b20eea15eae00bb/comments", "author": null, "committer": null, "parents": [{"sha": "7b3bd50372bab4573d19c32167b83fcc3a567cd6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7b3bd50372bab4573d19c32167b83fcc3a567cd6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7b3bd50372bab4573d19c32167b83fcc3a567cd6"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "49d96389628b7ce883e88d5381ce819af5fbcf8e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/194c524aa2f34e1389c4ddd31b20eea15eae00bb/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/194c524aa2f34e1389c4ddd31b20eea15eae00bb/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=194c524aa2f34e1389c4ddd31b20eea15eae00bb", "patch": "@@ -1,3 +1,10 @@\n+2006-04-30  David Edelsohn  <edelsohn@gnu.org>\n+\n+\t* config/rs6000/rs6000.c (rs6000_override_options): Enable\n+\tTARGET_NO_FP_IN_TOC for section anchors.\n+\t(optimization_options): Enable section anchors for all\n+\tnon-\"Objective\" languages.\n+\n 2006-04-28  Eric Christopher  <echristo@apple.com>\n \n \t* config/darwin-c.c (darwin_ms_struct): Move this"}, {"sha": "53b10829cdd535e0581c06f1fadfd5eae80666f9", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/194c524aa2f34e1389c4ddd31b20eea15eae00bb/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/194c524aa2f34e1389c4ddd31b20eea15eae00bb/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=194c524aa2f34e1389c4ddd31b20eea15eae00bb", "patch": "@@ -1350,6 +1350,11 @@ rs6000_override_options (const char *default_cpu)\n       rs6000_alignment_flags = MASK_ALIGN_NATURAL;\n     }\n \n+  /* Place FP constants in the constant pool instead of TOC\n+     if section anchors enabled.  */\n+  if (flag_section_anchors)\n+    TARGET_NO_FP_IN_TOC = 1;\n+\n   /* Handle -mtls-size option.  */\n   rs6000_parse_tls_size_option ();\n \n@@ -1621,6 +1626,12 @@ optimization_options (int level ATTRIBUTE_UNUSED, int size ATTRIBUTE_UNUSED)\n \n   /* Double growth factor to counter reduced min jump length.  */\n   set_param_value (\"max-grow-copy-bb-insns\", 16);\n+\n+  /* Enable section anchors by default.\n+     Skip section anchors for Objective C and Objective C++\n+     until front-ends fixed.  */\n+  if (lang_hooks.name[4] != 'O')\n+    flag_section_anchors = 1;\n }\n \n /* Implement TARGET_HANDLE_OPTION.  */\n@@ -3452,7 +3463,7 @@ rs6000_legitimize_reload_address (rtx x, enum machine_mode mode,\n       && constant_pool_expr_p (x)\n       && ASM_OUTPUT_SPECIAL_POOL_ENTRY_P (get_pool_constant (x), mode))\n     {\n-      (x) = create_TOC_reference (x);\n+      x = create_TOC_reference (x);\n       *win = 1;\n       return x;\n     }"}]}