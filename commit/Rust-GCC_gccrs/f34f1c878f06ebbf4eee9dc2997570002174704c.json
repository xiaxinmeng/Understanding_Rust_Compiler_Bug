{"sha": "f34f1c878f06ebbf4eee9dc2997570002174704c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjM0ZjFjODc4ZjA2ZWJiZjRlZWU5ZGMyOTk3NTcwMDAyMTc0NzA0Yw==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2014-01-22T22:15:12Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2014-01-22T22:15:12Z"}, "message": "re PR c/59891 (ICE on invalid code (with div-by-zero) at all optimization levels on x86_64-linux-gnu)\n\n\tPR c/59891\nc/\n\t* c-typeck.c (build_conditional_expr): Call c_fully_fold instead\n\tof remove_c_maybe_const_expr on op1 and op2.\ntestsuite/\n\t* gcc.dg/torture/pr59891.c: New test.\n\nFrom-SVN: r206944", "tree": {"sha": "f50ece7b1dc98d9b657dab87ab3eca6a8823f625", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f50ece7b1dc98d9b657dab87ab3eca6a8823f625"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f34f1c878f06ebbf4eee9dc2997570002174704c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f34f1c878f06ebbf4eee9dc2997570002174704c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f34f1c878f06ebbf4eee9dc2997570002174704c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f34f1c878f06ebbf4eee9dc2997570002174704c/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "77b7a218bbe8aca5a7b4da211cbbc4ceb2dd6270", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/77b7a218bbe8aca5a7b4da211cbbc4ceb2dd6270", "html_url": "https://github.com/Rust-GCC/gccrs/commit/77b7a218bbe8aca5a7b4da211cbbc4ceb2dd6270"}], "stats": {"total": 26, "additions": 24, "deletions": 2}, "files": [{"sha": "3ec4fe7de16cde4d1e50a13d48f7c1ebe97f11a1", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f34f1c878f06ebbf4eee9dc2997570002174704c/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f34f1c878f06ebbf4eee9dc2997570002174704c/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=f34f1c878f06ebbf4eee9dc2997570002174704c", "patch": "@@ -1,3 +1,9 @@\n+2014-01-22  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/59891\n+\t* c-typeck.c (build_conditional_expr): Call c_fully_fold instead\n+\tof remove_c_maybe_const_expr on op1 and op2.\n+\n 2014-01-15  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/58943"}, {"sha": "7cb717a9749b013b0df3a1e42d5b15b2cede92e4", "filename": "gcc/c/c-typeck.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f34f1c878f06ebbf4eee9dc2997570002174704c/gcc%2Fc%2Fc-typeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f34f1c878f06ebbf4eee9dc2997570002174704c/gcc%2Fc%2Fc-typeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-typeck.c?ref=f34f1c878f06ebbf4eee9dc2997570002174704c", "patch": "@@ -4708,8 +4708,10 @@ build_conditional_expr (location_t colon_loc, tree ifexp, bool ifexp_bcp,\n     {\n       if (int_operands)\n \t{\n-\t  op1 = remove_c_maybe_const_expr (op1);\n-\t  op2 = remove_c_maybe_const_expr (op2);\n+\t  /* Use c_fully_fold here, since C_MAYBE_CONST_EXPR might be\n+\t     nested inside of the expression.  */\n+\t  op1 = c_fully_fold (op1, false, NULL);\n+\t  op2 = c_fully_fold (op2, false, NULL);\n \t}\n       ret = build3 (COND_EXPR, result_type, ifexp, op1, op2);\n       if (int_operands)"}, {"sha": "4cc8d9f8984234ee4be69715a077ba016506bf09", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f34f1c878f06ebbf4eee9dc2997570002174704c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f34f1c878f06ebbf4eee9dc2997570002174704c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f34f1c878f06ebbf4eee9dc2997570002174704c", "patch": "@@ -1,3 +1,8 @@\n+2014-01-22  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/59891\n+\t* gcc.dg/torture/pr59891.c: New test.\n+\n 2014-01-22  Jeff Law  <law@redhat.com>\n \n \tPR tree-optimization/59597"}, {"sha": "1562acccf6877a78bf5c54e0d3af9733c6e1fe0c", "filename": "gcc/testsuite/gcc.dg/torture/pr59891.c", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f34f1c878f06ebbf4eee9dc2997570002174704c/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr59891.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f34f1c878f06ebbf4eee9dc2997570002174704c/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr59891.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr59891.c?ref=f34f1c878f06ebbf4eee9dc2997570002174704c", "patch": "@@ -0,0 +1,9 @@\n+/* PR c/59891 */\n+\n+unsigned int a;\n+\n+int\n+main ()\n+{\n+  return (0 ? a : 0) ? : 0 % 0; /* { dg-warning \"division by zero\" } */\n+}"}]}