{"sha": "638fc14f07ae8908141b520b9d11ba364f087018", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjM4ZmMxNGYwN2FlODkwODE0MWI1MjBiOWQxMWJhMzY0ZjA4NzAxOA==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2016-07-29T17:39:39Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2016-07-29T17:39:39Z"}, "message": "re PR c/71926 (wrong location for -Wparentheses warning)\n\n\tPR c/71926\n\t* c-common.c (c_common_truthvalue_conversion): Use LOCATION for the\n\tparentheses warning.\n\n\t* semantics.c (maybe_convert_cond): Use the location of COND for the\n\tparentheses warning.\n\n\t* g++.dg/warn/Wparentheses-30.C: New test.\n\t* gcc.dg/Wparentheses-14.c: New test.\n\nFrom-SVN: r238886", "tree": {"sha": "0fe460480bf9bb01eac667e2c342d2230fe60b19", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0fe460480bf9bb01eac667e2c342d2230fe60b19"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/638fc14f07ae8908141b520b9d11ba364f087018", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/638fc14f07ae8908141b520b9d11ba364f087018", "html_url": "https://github.com/Rust-GCC/gccrs/commit/638fc14f07ae8908141b520b9d11ba364f087018", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/638fc14f07ae8908141b520b9d11ba364f087018/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e00dceafd2de848a7735dbce48922aa2304a0f94", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e00dceafd2de848a7735dbce48922aa2304a0f94", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e00dceafd2de848a7735dbce48922aa2304a0f94"}], "stats": {"total": 45, "additions": 41, "deletions": 4}, "files": [{"sha": "aed494a5af1fc2c58bcd2616733b60858986fb67", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/638fc14f07ae8908141b520b9d11ba364f087018/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/638fc14f07ae8908141b520b9d11ba364f087018/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=638fc14f07ae8908141b520b9d11ba364f087018", "patch": "@@ -1,5 +1,9 @@\n 2016-07-29  Marek Polacek  <polacek@redhat.com>\n \n+\tPR c/71926\n+\t* c-common.c (c_common_truthvalue_conversion): Use LOCATION for the\n+\tparentheses warning.\n+\n \tPR c/71574\n \t* c-common.c (handle_alloc_align_attribute): Also check FUNCTION_DECL.\n "}, {"sha": "27031b5e25fb95f59c2b7f1e33e06c4cc91c511a", "filename": "gcc/c-family/c-common.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/638fc14f07ae8908141b520b9d11ba364f087018/gcc%2Fc-family%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/638fc14f07ae8908141b520b9d11ba364f087018/gcc%2Fc-family%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-common.c?ref=638fc14f07ae8908141b520b9d11ba364f087018", "patch": "@@ -4591,8 +4591,9 @@ c_common_truthvalue_conversion (location_t location, tree expr)\n       if (!TREE_NO_WARNING (expr)\n \t  && warn_parentheses)\n \t{\n-\t  warning (OPT_Wparentheses,\n-\t\t   \"suggest parentheses around assignment used as truth value\");\n+\t  warning_at (location, OPT_Wparentheses,\n+\t\t      \"suggest parentheses around assignment used as \"\n+\t\t      \"truth value\");\n \t  TREE_NO_WARNING (expr) = 1;\n \t}\n       break;"}, {"sha": "db6e1eb773011f21a4d47a99aeb67b799f7adc7e", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/638fc14f07ae8908141b520b9d11ba364f087018/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/638fc14f07ae8908141b520b9d11ba364f087018/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=638fc14f07ae8908141b520b9d11ba364f087018", "patch": "@@ -1,3 +1,9 @@\n+2016-07-29  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/71926\n+\t* semantics.c (maybe_convert_cond): Use the location of COND for the\n+\tparentheses warning.\n+\n 2016-07-29  Jason Merrill  <jason@redhat.com>\n \n \t* decl.c (build_enumerator): Tweak diagnostic."}, {"sha": "2fe2d091a3a0c0748007149785b024477b431690", "filename": "gcc/cp/semantics.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/638fc14f07ae8908141b520b9d11ba364f087018/gcc%2Fcp%2Fsemantics.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/638fc14f07ae8908141b520b9d11ba364f087018/gcc%2Fcp%2Fsemantics.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fsemantics.c?ref=638fc14f07ae8908141b520b9d11ba364f087018", "patch": "@@ -656,8 +656,8 @@ maybe_convert_cond (tree cond)\n       && !TREE_NO_WARNING (cond)\n       && warn_parentheses)\n     {\n-      warning (OPT_Wparentheses,\n-\t       \"suggest parentheses around assignment used as truth value\");\n+      warning_at (EXPR_LOC_OR_LOC (cond, input_location), OPT_Wparentheses,\n+\t\t  \"suggest parentheses around assignment used as truth value\");\n       TREE_NO_WARNING (cond) = 1;\n     }\n "}, {"sha": "5cf7c1fbdea9fff745f24e4866a06e024008279f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/638fc14f07ae8908141b520b9d11ba364f087018/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/638fc14f07ae8908141b520b9d11ba364f087018/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=638fc14f07ae8908141b520b9d11ba364f087018", "patch": "@@ -11,6 +11,10 @@\n \tPR c/71573\n \t* gcc.dg/noncompile/pr71573.c: New test.\n \n+\tPR c/71926\n+\t* g++.dg/warn/Wparentheses-30.C: New test.\n+\t* gcc.dg/Wparentheses-14.c: New test.\n+\n 2016-07-29  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* gcc.dg/pr59833.c: Use dg-add-options ieee."}, {"sha": "ea7c74135abd992d07669c44be85c0d9190d0d85", "filename": "gcc/testsuite/g++.dg/warn/Wparentheses-30.C", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/638fc14f07ae8908141b520b9d11ba364f087018/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWparentheses-30.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/638fc14f07ae8908141b520b9d11ba364f087018/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWparentheses-30.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWparentheses-30.C?ref=638fc14f07ae8908141b520b9d11ba364f087018", "patch": "@@ -0,0 +1,11 @@\n+/* PR c/71926 */\n+/* { dg-options \"-Wparentheses\" }  */\n+\n+int\n+f (void)\n+{\n+  int a = 1, b = 2, c = 3, d = 4;\n+  if (a = 2 || (b != 3 && c != 4 && d != 5)) /* { dg-warning \"9:suggest parentheses\" } */\n+    return 1;\n+  return 0;\n+}"}, {"sha": "36dedf714768702ac96927a2d3607dfa710bdf08", "filename": "gcc/testsuite/gcc.dg/Wparentheses-14.c", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/638fc14f07ae8908141b520b9d11ba364f087018/gcc%2Ftestsuite%2Fgcc.dg%2FWparentheses-14.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/638fc14f07ae8908141b520b9d11ba364f087018/gcc%2Ftestsuite%2Fgcc.dg%2FWparentheses-14.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2FWparentheses-14.c?ref=638fc14f07ae8908141b520b9d11ba364f087018", "patch": "@@ -0,0 +1,11 @@\n+/* PR c/71926 */\n+/* { dg-options \"-Wparentheses\" }  */\n+\n+int\n+f (void)\n+{\n+  int a = 1, b = 2, c = 3, d = 4;\n+  if (a = 2 || (b != 3 && c != 4 && d != 5)) /* { dg-warning \"7:suggest parentheses\" } */\n+    return 1;\n+  return 0;\n+}"}]}