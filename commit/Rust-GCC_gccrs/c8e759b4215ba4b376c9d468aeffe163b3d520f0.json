{"sha": "c8e759b4215ba4b376c9d468aeffe163b3d520f0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzhlNzU5YjQyMTViYTRiMzc2YzlkNDY4YWVmZmUxNjNiM2Q1MjBmMA==", "commit": {"author": {"name": "Maciej W. Rozycki", "email": "macro@wdc.com", "date": "2019-12-22T00:41:36Z"}, "committer": {"name": "Maciej W. Rozycki", "email": "macro@gcc.gnu.org", "date": "2019-12-22T00:41:36Z"}, "message": "libgomp/test: Fix compilation for build sysroot\n\nFix a problem with the libgomp testsuite using a method to determine\nthe compiler to use resulting in the tool being different from one the\nlibrary has been built with, and causing a catastrophic failure from the\nlack of a suitable `--sysroot=' option where the `--with-build-sysroot='\nconfiguration option has been used to build the compiler resulting in\nthe inability to link executables.\n\nAddress this problem by defining the compiler to use, via the\nGCC_UNDER_TEST TCL variable, set in the DejaGNU configuration file from\n$CC by autoconf, which will have all the required options set for the\ntarget compiler to build executables in the environment configured,\nremoving failures like:\n\n.../bin/riscv64-linux-gnu-ld: cannot find crt1.o: No such file or directory\n.../bin/riscv64-linux-gnu-ld: cannot find -lm\n.../bin/riscv64-linux-gnu-ld: cannot find -lpthread\n.../bin/riscv64-linux-gnu-ld: cannot find -lc\n.../bin/riscv64-linux-gnu-ld: cannot find -latomic\ncollect2: error: ld returned 1 exit status\ncompiler exited with status 1\nFAIL: libgomp.c/../libgomp.c-c++-common/atomic-18.c (test for excess errors)\nExcess errors:\n.../bin/riscv64-linux-gnu-ld: cannot find crt1.o: No such file or directory\n.../bin/riscv64-linux-gnu-ld: cannot find -lm\n.../bin/riscv64-linux-gnu-ld: cannot find -lpthread\n.../bin/riscv64-linux-gnu-ld: cannot find -lc\n.../bin/riscv64-linux-gnu-ld: cannot find -latomic\n\nUNRESOLVED: libgomp.c/../libgomp.c-c++-common/atomic-18.c compilation failed to produce executable\n\nand bringing overall test results for the `riscv64-linux-gnu' target\n(here with the `x86_64-linux-gnu' host and RISC-V QEMU in the Linux user\nemulation mode as the target board) from:\n\n\t\t=== libgomp Summary ===\n\n# of expected passes\t\t44\n# of unexpected failures\t3274\n# of unresolved testcases\t3241\n# of unsupported tests\t\t548\n\nto:\n\n\t\t=== libgomp Summary ===\n\n# of expected passes\t\t6834\n# of unexpected failures\t4\n# of expected failures\t\t4\n# of unsupported tests\t\t518\n\n\tlibgomp/\n\t* testsuite/libgomp-test-support.exp.in (GCC_UNDER_TEST): New\n\tvariable.\n\nFrom-SVN: r279708", "tree": {"sha": "0bc204c0c55e511407e9aacc6cfd3a9e9aa34e0f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0bc204c0c55e511407e9aacc6cfd3a9e9aa34e0f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c8e759b4215ba4b376c9d468aeffe163b3d520f0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8e759b4215ba4b376c9d468aeffe163b3d520f0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c8e759b4215ba4b376c9d468aeffe163b3d520f0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8e759b4215ba4b376c9d468aeffe163b3d520f0/comments", "author": null, "committer": null, "parents": [{"sha": "20ff65f8c5657fe59b19534034aadcdb578ea50f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/20ff65f8c5657fe59b19534034aadcdb578ea50f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/20ff65f8c5657fe59b19534034aadcdb578ea50f"}], "stats": {"total": 7, "additions": 7, "deletions": 0}, "files": [{"sha": "c557aa436f29e6169304a1f6c2c8056facb034fa", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8e759b4215ba4b376c9d468aeffe163b3d520f0/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8e759b4215ba4b376c9d468aeffe163b3d520f0/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=c8e759b4215ba4b376c9d468aeffe163b3d520f0", "patch": "@@ -1,3 +1,8 @@\n+2019-12-22  Maciej W. Rozycki  <macro@wdc.com>\n+\n+\t* testsuite/libgomp-test-support.exp.in (GCC_UNDER_TEST): New\n+\tvariable.\n+\n 2019-12-21  Thomas Schwinge  <thomas@codesourcery.com>\n \n \t* target.c (gomp_map_vars_internal): Restore 'omp declare target"}, {"sha": "6ec10c728a3e1784737adbbd515dfe6c0376b548", "filename": "libgomp/testsuite/libgomp-test-support.exp.in", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8e759b4215ba4b376c9d468aeffe163b3d520f0/libgomp%2Ftestsuite%2Flibgomp-test-support.exp.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8e759b4215ba4b376c9d468aeffe163b3d520f0/libgomp%2Ftestsuite%2Flibgomp-test-support.exp.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp-test-support.exp.in?ref=c8e759b4215ba4b376c9d468aeffe163b3d520f0", "patch": "@@ -1,3 +1,5 @@\n+set GCC_UNDER_TEST {@CC@}\n+\n set cuda_driver_include \"@CUDA_DRIVER_INCLUDE@\"\n set cuda_driver_lib \"@CUDA_DRIVER_LIB@\"\n set hsa_runtime_lib \"@HSA_RUNTIME_LIB@\""}]}