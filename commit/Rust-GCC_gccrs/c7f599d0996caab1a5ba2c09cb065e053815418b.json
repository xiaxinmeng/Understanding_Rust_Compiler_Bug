{"sha": "c7f599d0996caab1a5ba2c09cb065e053815418b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzdmNTk5ZDA5OTZjYWFiMWE1YmEyYzA5Y2IwNjVlMDUzODE1NDE4Yg==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2005-03-28T13:16:14Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2005-03-28T13:16:14Z"}, "message": "tree-inline.c (estimate_num_insns_1): Use declaration to discover argument types where possible.\n\n\n\t* tree-inline.c (estimate_num_insns_1): Use declaration to discover argument\n\ttypes where possible.\n\nFrom-SVN: r97132", "tree": {"sha": "a0b97adf5de23839438ccb88d04706c1b9efea09", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a0b97adf5de23839438ccb88d04706c1b9efea09"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c7f599d0996caab1a5ba2c09cb065e053815418b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c7f599d0996caab1a5ba2c09cb065e053815418b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c7f599d0996caab1a5ba2c09cb065e053815418b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c7f599d0996caab1a5ba2c09cb065e053815418b/comments", "author": null, "committer": null, "parents": [{"sha": "93f15e1e749ed086104b669e7f298146454cbef1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/93f15e1e749ed086104b669e7f298146454cbef1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/93f15e1e749ed086104b669e7f298146454cbef1"}], "stats": {"total": 20, "additions": 17, "deletions": 3}, "files": [{"sha": "33a60b1b93b9dc88ff823105a89f9050a8563b06", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c7f599d0996caab1a5ba2c09cb065e053815418b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c7f599d0996caab1a5ba2c09cb065e053815418b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c7f599d0996caab1a5ba2c09cb065e053815418b", "patch": "@@ -1,3 +1,8 @@\n+2005-03-28  Jan Hubicka  <jh@suse.cz>\n+\n+\t* tree-inline.c (estimate_num_insns_1): Use declaration to discover argument\n+\ttypes where possible.\n+\n 2005-03-26  Per Bothner  <per@bothner.com>\n \n \tMake -f[no-]show-column also control non-cpp diagnostics."}, {"sha": "0b38f08724c667ae3456ef7b13ef6e4315a4dc12", "filename": "gcc/tree-inline.c", "status": "modified", "additions": 12, "deletions": 3, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c7f599d0996caab1a5ba2c09cb065e053815418b/gcc%2Ftree-inline.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c7f599d0996caab1a5ba2c09cb065e053815418b/gcc%2Ftree-inline.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-inline.c?ref=c7f599d0996caab1a5ba2c09cb065e053815418b", "patch": "@@ -1403,9 +1403,18 @@ estimate_num_insns_1 (tree *tp, int *walk_subtrees, void *data)\n \t      break;\n \t    }\n \n-\targ = TREE_OPERAND (x, 1);\n-\tfor (arg = TREE_OPERAND (x, 1); arg; arg = TREE_CHAIN (arg))\n-\t  *count += estimate_move_cost (TREE_TYPE (TREE_VALUE (arg)));\n+\t/* Our cost must be kept in sync with cgraph_estimate_size_after_inlining\n+\t   that does use function declaration to figure out the arguments.  */\n+\tif (!decl)\n+\t  {\n+\t    for (arg = TREE_OPERAND (x, 1); arg; arg = TREE_CHAIN (arg))\n+\t      *count += estimate_move_cost (TREE_TYPE (TREE_VALUE (arg)));\n+\t  }\n+\telse\n+\t  {\n+\t    for (arg = DECL_ARGUMENTS (decl); arg; arg = TREE_CHAIN (arg))\n+\t      *count += estimate_move_cost (TREE_TYPE (arg));\n+\t  }\n \n \t*count += PARAM_VALUE (PARAM_INLINE_CALL_COST);\n \tbreak;"}]}