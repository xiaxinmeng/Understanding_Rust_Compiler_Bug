{"sha": "022d41663ddcc03460e411e390eeb0ccada393d5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDIyZDQxNjYzZGRjYzAzNDYwZTQxMWUzOTBlZWIwY2NhZGEzOTNkNQ==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@airs.com", "date": "2006-08-27T21:42:55Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2006-08-27T21:42:55Z"}, "message": "re PR other/28797 (Problems with demangling (__cxa_demangle()))\n\n\tPR other/28797\n\t* cp-demangle.c (d_pointer_to_member_type): Do add a substitution\n\tfor a qualified member which is not a function.\n\t* testsuite/demangle-expected: Add test case.\n\nFrom-SVN: r116493", "tree": {"sha": "a40a9f01db662b18e0ec6a5970063abe955768bc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a40a9f01db662b18e0ec6a5970063abe955768bc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/022d41663ddcc03460e411e390eeb0ccada393d5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/022d41663ddcc03460e411e390eeb0ccada393d5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/022d41663ddcc03460e411e390eeb0ccada393d5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/022d41663ddcc03460e411e390eeb0ccada393d5/comments", "author": {"login": "ianlancetaylor", "id": 3194333, "node_id": "MDQ6VXNlcjMxOTQzMzM=", "avatar_url": "https://avatars.githubusercontent.com/u/3194333?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ianlancetaylor", "html_url": "https://github.com/ianlancetaylor", "followers_url": "https://api.github.com/users/ianlancetaylor/followers", "following_url": "https://api.github.com/users/ianlancetaylor/following{/other_user}", "gists_url": "https://api.github.com/users/ianlancetaylor/gists{/gist_id}", "starred_url": "https://api.github.com/users/ianlancetaylor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ianlancetaylor/subscriptions", "organizations_url": "https://api.github.com/users/ianlancetaylor/orgs", "repos_url": "https://api.github.com/users/ianlancetaylor/repos", "events_url": "https://api.github.com/users/ianlancetaylor/events{/privacy}", "received_events_url": "https://api.github.com/users/ianlancetaylor/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "99f4234aa713145f873b2295a4d62dd388489e64", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/99f4234aa713145f873b2295a4d62dd388489e64", "html_url": "https://github.com/Rust-GCC/gccrs/commit/99f4234aa713145f873b2295a4d62dd388489e64"}], "stats": {"total": 24, "additions": 23, "deletions": 1}, "files": [{"sha": "27280a3274d966fac46e1f9d99f00ffb83f3b6ff", "filename": "libiberty/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/022d41663ddcc03460e411e390eeb0ccada393d5/libiberty%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/022d41663ddcc03460e411e390eeb0ccada393d5/libiberty%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2FChangeLog?ref=022d41663ddcc03460e411e390eeb0ccada393d5", "patch": "@@ -1,3 +1,10 @@\n+2006-08-27  Ian Lance Taylor  <ian@airs.com>\n+\n+\tPR other/28797\n+\t* cp-demangle.c (d_pointer_to_member_type): Do add a substitution\n+\tfor a qualified member which is not a function.\n+\t* testsuite/demangle-expected: Add test case.\n+\n 2006-07-27  Jan Hubicka  <jh@suse.cz>\n \n \tPR rtl-optimization/28071"}, {"sha": "c7ee8786d9225031832c205a223aa2b4af0d6218", "filename": "libiberty/cp-demangle.c", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/022d41663ddcc03460e411e390eeb0ccada393d5/libiberty%2Fcp-demangle.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/022d41663ddcc03460e411e390eeb0ccada393d5/libiberty%2Fcp-demangle.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Fcp-demangle.c?ref=022d41663ddcc03460e411e390eeb0ccada393d5", "patch": "@@ -2081,13 +2081,22 @@ d_pointer_to_member_type (struct d_info *di)\n      g++ does not work that way.  g++ treats only the CV-qualified\n      member function as a substitution source.  FIXME.  So to work\n      with g++, we need to pull off the CV-qualifiers here, in order to\n-     avoid calling add_substitution() in cplus_demangle_type().  */\n+     avoid calling add_substitution() in cplus_demangle_type().  But\n+     for a CV-qualified member which is not a function, g++ does\n+     follow the ABI, so we need to handle that case here by calling\n+     d_add_substitution ourselves.  */\n \n   pmem = d_cv_qualifiers (di, &mem, 1);\n   if (pmem == NULL)\n     return NULL;\n   *pmem = cplus_demangle_type (di);\n \n+  if (pmem != &mem && (*pmem)->type != DEMANGLE_COMPONENT_FUNCTION_TYPE)\n+    {\n+      if (! d_add_substitution (di, mem))\n+\treturn NULL;\n+    }\n+\n   return d_make_comp (di, DEMANGLE_COMPONENT_PTRMEM_TYPE, cl, mem);\n }\n "}, {"sha": "4aaa3d639ec34896228a1b8c40c65d01d03459bb", "filename": "libiberty/testsuite/demangle-expected", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/022d41663ddcc03460e411e390eeb0ccada393d5/libiberty%2Ftestsuite%2Fdemangle-expected", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/022d41663ddcc03460e411e390eeb0ccada393d5/libiberty%2Ftestsuite%2Fdemangle-expected", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Ftestsuite%2Fdemangle-expected?ref=022d41663ddcc03460e411e390eeb0ccada393d5", "patch": "@@ -3805,3 +3805,9 @@ java::lang::Math::acos(double)double\n _Z4makeI7FactoryiET_IT0_Ev\n make<Factory, int>()Factory<int>\n make<Factory, int>\n+#\n+# From PR 28797\n+--format=auto --no-params\n+_Z1fM1AKiPKS1_\n+f(int const A::*, int const A::* const*)\n+f"}]}