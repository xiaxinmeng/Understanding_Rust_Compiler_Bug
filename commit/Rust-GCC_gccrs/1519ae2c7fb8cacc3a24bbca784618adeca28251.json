{"sha": "1519ae2c7fb8cacc3a24bbca784618adeca28251", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTUxOWFlMmM3ZmI4Y2FjYzNhMjRiYmNhNzg0NjE4YWRlY2EyODI1MQ==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@cygnus.com", "date": "2000-03-19T11:30:38Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2000-03-19T11:30:38Z"}, "message": "flow.c (delete_block): Delete the addr_vec along with the block.\n\n        * flow.c (delete_block): Delete the addr_vec along with the block.\n        (flow_delete_insn): Decrement LABEL_NUSES when deleting insns that\n        reference labels.\n\nFrom-SVN: r32635", "tree": {"sha": "053b5728c84e3fc8f12d1958a32b54540969c4f8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/053b5728c84e3fc8f12d1958a32b54540969c4f8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1519ae2c7fb8cacc3a24bbca784618adeca28251", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1519ae2c7fb8cacc3a24bbca784618adeca28251", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1519ae2c7fb8cacc3a24bbca784618adeca28251", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1519ae2c7fb8cacc3a24bbca784618adeca28251/comments", "author": null, "committer": null, "parents": [{"sha": "b6166b4d0fd0ea3767a48034d773967c057220ee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b6166b4d0fd0ea3767a48034d773967c057220ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b6166b4d0fd0ea3767a48034d773967c057220ee"}], "stats": {"total": 34, "additions": 28, "deletions": 6}, "files": [{"sha": "cdaef9deb83cae852b7918d0314d00f8bb04031b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1519ae2c7fb8cacc3a24bbca784618adeca28251/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1519ae2c7fb8cacc3a24bbca784618adeca28251/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1519ae2c7fb8cacc3a24bbca784618adeca28251", "patch": "@@ -1,3 +1,9 @@\n+2000-03-19  Richard Henderson  <rth@cygnus.com>\n+\n+\t* flow.c (delete_block): Delete the addr_vec along with the block.\n+\t(flow_delete_insn): Decrement LABEL_NUSES when deleting insns that\n+\treference labels.\n+\n 2000-03-18  Mark Mitchell  <mark@codesourcery.com>\n \n \t* emit-rtl.c (remove_unncessary_notes): Check that all"}, {"sha": "79203d7a05097e55d542c9f904a14553dfe37357", "filename": "gcc/flow.c", "status": "modified", "additions": 22, "deletions": 6, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1519ae2c7fb8cacc3a24bbca784618adeca28251/gcc%2Fflow.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1519ae2c7fb8cacc3a24bbca784618adeca28251/gcc%2Fflow.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fflow.c?ref=1519ae2c7fb8cacc3a24bbca784618adeca28251", "patch": "@@ -1853,7 +1853,7 @@ delete_block (b)\n      basic_block b;\n {\n   int deleted_handler = 0;\n-  rtx insn, end;\n+  rtx insn, end, tmp;\n \n   /* If the head of this block is a CODE_LABEL, then it might be the\n      label for an exception handler which can't be reached.\n@@ -1902,11 +1902,22 @@ delete_block (b)\n \t}\n     }\n \n-  /* Selectively unlink the insn chain.  Include any BARRIER that may\n-     follow the basic block.  */\n-  end = next_nonnote_insn (b->end);\n-  if (!end || GET_CODE (end) != BARRIER)\n-    end = b->end;\n+  /* Include any jump table following the basic block.  */\n+  end = b->end;\n+  if (GET_CODE (end) == JUMP_INSN\n+      && (tmp = JUMP_LABEL (end)) != NULL_RTX\n+      && (tmp = NEXT_INSN (tmp)) != NULL_RTX\n+      && GET_CODE (tmp) == JUMP_INSN\n+      && (GET_CODE (PATTERN (tmp)) == ADDR_VEC\n+\t  || GET_CODE (PATTERN (tmp)) == ADDR_DIFF_VEC))\n+    end = tmp;\n+\n+  /* Include any barrier that may follow the basic block.  */\n+  tmp = next_nonnote_insn (b->end);\n+  if (tmp && GET_CODE (tmp) == BARRIER)\n+    end = tmp;\n+\n+  /* Selectively delete the entire chain.  */\n   flow_delete_insn_chain (insn, end);\n \n  no_delete_insns:\n@@ -1972,6 +1983,7 @@ flow_delete_insn (insn)\n {\n   rtx prev = PREV_INSN (insn);\n   rtx next = NEXT_INSN (insn);\n+  rtx note;\n \n   PREV_INSN (insn) = NULL_RTX;\n   NEXT_INSN (insn) = NULL_RTX;\n@@ -1991,6 +2003,10 @@ flow_delete_insn (insn)\n   if (GET_CODE (insn) == JUMP_INSN && JUMP_LABEL (insn))\n     LABEL_NUSES (JUMP_LABEL (insn))--;\n \n+  /* Also if deleting an insn that references a label.  */\n+  else if ((note = find_reg_note (insn, REG_LABEL, NULL_RTX)) != NULL_RTX)\n+    LABEL_NUSES (XEXP (note, 0))--;\n+\n   return next;\n }\n "}]}