{"sha": "2f2dcbe4717ce7a117671234940f8b74809f3973", "node_id": "C_kwDOANBUbNoAKDJmMmRjYmU0NzE3Y2U3YTExNzY3MTIzNDk0MGY4Yjc0ODA5ZjM5NzM", "commit": {"author": {"name": "H.J. Lu", "email": "hjl.tools@gmail.com", "date": "2021-09-20T14:48:05Z"}, "committer": {"name": "H.J. Lu", "email": "hjl.tools@gmail.com", "date": "2021-09-22T17:00:02Z"}, "message": "x86: Clean up gcc.target/i386/auto-init-* tests\n\n1. Replace ia32 with { ! lp64 } to enable ILP32 tests for -mx32.\n2. Replace lp64 with { ! ia32 } to enable x86-64 ISA tests for -mx32.\n3. For auto-init-3.c, add -msse and -mfpmath=387 for ia32.\n\n\t* gcc.target/i386/auto-init-2.c: Replace ia32 with { ! lp64 }.\n\t* gcc.target/i386/auto-init-3.c (dg-options): Add -msse.\n\t(dg-additional-options): Add -mfpmath=387 for ia32.\n\tReplace lp64 with { ! ia32 }. Add a space after ia32.\n\t* gcc.target/i386/auto-init-4.c: Replace lp64 with { ! ia32 }.\n\t* gcc.target/i386/auto-init-5.c: Likewise.\n\t* gcc.target/i386/auto-init-padding-3.c: Likewise.\n\t* gcc.target/i386/auto-init-padding-7.c: Likewise.\n\t* gcc.target/i386/auto-init-padding-8.c: Likewise.\n\t* gcc.target/i386/auto-init-padding-9.c: Likewise.", "tree": {"sha": "d2c669a389b7ffd66f5b97185976a16f8574f7ef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d2c669a389b7ffd66f5b97185976a16f8574f7ef"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2f2dcbe4717ce7a117671234940f8b74809f3973", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f2dcbe4717ce7a117671234940f8b74809f3973", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2f2dcbe4717ce7a117671234940f8b74809f3973", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f2dcbe4717ce7a117671234940f8b74809f3973/comments", "author": {"login": "hjl-tools", "id": 1072356, "node_id": "MDQ6VXNlcjEwNzIzNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hjl-tools", "html_url": "https://github.com/hjl-tools", "followers_url": "https://api.github.com/users/hjl-tools/followers", "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}", "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}", "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions", "organizations_url": "https://api.github.com/users/hjl-tools/orgs", "repos_url": "https://api.github.com/users/hjl-tools/repos", "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}", "received_events_url": "https://api.github.com/users/hjl-tools/received_events", "type": "User", "site_admin": false}, "committer": {"login": "hjl-tools", "id": 1072356, "node_id": "MDQ6VXNlcjEwNzIzNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hjl-tools", "html_url": "https://github.com/hjl-tools", "followers_url": "https://api.github.com/users/hjl-tools/followers", "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}", "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}", "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions", "organizations_url": "https://api.github.com/users/hjl-tools/orgs", "repos_url": "https://api.github.com/users/hjl-tools/repos", "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}", "received_events_url": "https://api.github.com/users/hjl-tools/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9329344a6d81a6a5e3bd171167ebc7b158bb44f4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9329344a6d81a6a5e3bd171167ebc7b158bb44f4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9329344a6d81a6a5e3bd171167ebc7b158bb44f4"}], "stats": {"total": 39, "additions": 16, "deletions": 23}, "files": [{"sha": "e22930ae89bb906389b685d802c4bb859baeabb0", "filename": "gcc/testsuite/gcc.target/i386/auto-init-2.c", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f2dcbe4717ce7a117671234940f8b74809f3973/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f2dcbe4717ce7a117671234940f8b74809f3973/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-2.c?ref=2f2dcbe4717ce7a117671234940f8b74809f3973", "patch": "@@ -33,6 +33,5 @@ void foo()\n /* { dg-final { scan-rtl-dump-times \"0xfffffffffffffefe\" 1 \"expand\" } } */\n /* { dg-final { scan-rtl-dump-times \"0xfffffffffefefefe\" 2 \"expand\" { target lp64 } } } */\n /* { dg-final { scan-rtl-dump-times \"0xfefefefefefefefe\" 3 \"expand\" { target lp64 } } } */\n-/* { dg-final { scan-rtl-dump-times \"0xfffffffffefefefe\" 4 \"expand\" { target ia32 } } } */\n-/* { dg-final { scan-rtl-dump-times \"0xfefefefefefefefe\" 1 \"expand\" { target ia32 } } } */\n-\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffefefefe\" 4 \"expand\" { target { ! lp64 } } } } */\n+/* { dg-final { scan-rtl-dump-times \"0xfefefefefefefefe\" 1 \"expand\" { target { ! lp64 } } } } */"}, {"sha": "891eab1c40bd84a36b6190a1a8c6e382afc45a49", "filename": "gcc/testsuite/gcc.target/i386/auto-init-3.c", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f2dcbe4717ce7a117671234940f8b74809f3973/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f2dcbe4717ce7a117671234940f8b74809f3973/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-3.c?ref=2f2dcbe4717ce7a117671234940f8b74809f3973", "patch": "@@ -1,6 +1,7 @@\n /* Verify zero initialization for floating point type automatic variables.  */\n /* { dg-do compile } */\n-/* { dg-options \"-ftrivial-auto-var-init=zero -march=x86-64 -mtune=generic\" } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -march=x86-64 -mtune=generic -msse\" } */\n+/* { dg-additional-options \"-mfpmath=387\" { target ia32 } } */\n \n long double result;\n \n@@ -14,5 +15,5 @@ long double foo()\n   return result;\n }\n \n-/* { dg-final { scan-assembler-times \"pxor\\t\\\\\\%xmm0, \\\\\\%xmm0\" 3  { target lp64 } } } */\n-/* { dg-final { scan-assembler-times \"fldz\" 3  { target ia32} } } */\n+/* { dg-final { scan-assembler-times \"pxor\\t\\\\\\%xmm0, \\\\\\%xmm0\" 3  { target { ! ia32 } } } } */\n+/* { dg-final { scan-assembler-times \"fldz\" 3  { target ia32 } } } */"}, {"sha": "7b46c74a073157566a6ced8415d90079d4a83ba9", "filename": "gcc/testsuite/gcc.target/i386/auto-init-4.c", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f2dcbe4717ce7a117671234940f8b74809f3973/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f2dcbe4717ce7a117671234940f8b74809f3973/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-4.c?ref=2f2dcbe4717ce7a117671234940f8b74809f3973", "patch": "@@ -14,9 +14,8 @@ long double foo()\n   return result;\n }\n \n-/* { dg-final { scan-rtl-dump-times \"0xfffffffffefefefe\" 1 \"expand\" { target lp64 } } } */\n-/* { dg-final { scan-rtl-dump-times \"\\\\\\[0xfefefefefefefefe\\\\\\]\" 1 \"expand\" { target lp64 } } } */\n-/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffffe\\\\\\]\\\\\\) repeated x16\" 1 \"expand\" { target lp64 } } } */\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffefefefe\" 1 \"expand\" { target { ! ia32 } } } } */\n+/* { dg-final { scan-rtl-dump-times \"\\\\\\[0xfefefefefefefefe\\\\\\]\" 1 \"expand\" { target { ! ia32 } } } } */\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffffe\\\\\\]\\\\\\) repeated x16\" 1 \"expand\" { target { ! ia32 } } } } */\n /* { dg-final { scan-rtl-dump-times \"0xfffffffffefefefe\" 2 \"expand\" { target ia32 } } } */\n /* { dg-final { scan-rtl-dump-times \"\\\\\\[0xfefefefefefefefe\\\\\\]\" 2 \"expand\" { target ia32 } } } */\n-"}, {"sha": "0e9d74f985256b7983232efc43d46076e72263d3", "filename": "gcc/testsuite/gcc.target/i386/auto-init-5.c", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f2dcbe4717ce7a117671234940f8b74809f3973/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f2dcbe4717ce7a117671234940f8b74809f3973/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-5.c?ref=2f2dcbe4717ce7a117671234940f8b74809f3973", "patch": "@@ -15,7 +15,5 @@ _Complex long double foo()\n   return result;\n }\n \n-/* { dg-final { scan-assembler-times \"\\\\.long\\t0\" 14 { target lp64 } } } */\n+/* { dg-final { scan-assembler-times \"\\\\.long\\t0\" 14 { target { ! ia32 } } } } */\n /* { dg-final { scan-assembler-times \"\\\\.long\\t0\" 12 { target ia32 } } } */\n-\n-"}, {"sha": "7c20a28508ff33b2f274ba71d171cd3360ea5e05", "filename": "gcc/testsuite/gcc.target/i386/auto-init-padding-3.c", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f2dcbe4717ce7a117671234940f8b74809f3973/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f2dcbe4717ce7a117671234940f8b74809f3973/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-3.c?ref=2f2dcbe4717ce7a117671234940f8b74809f3973", "patch": "@@ -24,9 +24,7 @@ int foo ()\n }\n \n /* { dg-final { scan-assembler \"movl\\t\\\\\\$0,\" } } */\n-/* { dg-final { scan-assembler \"movl\\t\\\\\\$16,\" { target lp64 } } } */\n-/* { dg-final { scan-assembler \"rep stosq\" { target lp64 } } } */\n+/* { dg-final { scan-assembler \"movl\\t\\\\\\$16,\" { target { ! ia32 } } } } */\n+/* { dg-final { scan-assembler \"rep stosq\" { target { ! ia32 } } } } */\n /* { dg-final { scan-assembler \"movl\\t\\\\\\$32,\" { target ia32 } } } */\n /* { dg-final { scan-assembler \"rep stosl\" { target ia32 } } } */\n-\n-"}, {"sha": "c3823de905d7d73126c90c066517031176a47b73", "filename": "gcc/testsuite/gcc.target/i386/auto-init-padding-7.c", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f2dcbe4717ce7a117671234940f8b74809f3973/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f2dcbe4717ce7a117671234940f8b74809f3973/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-7.c?ref=2f2dcbe4717ce7a117671234940f8b74809f3973", "patch": "@@ -18,6 +18,4 @@ int foo ()\n }\n \n /* { dg-final { scan-rtl-dump-times \"const_int 0 \\\\\\[0\\\\\\]\\\\\\) repeated x16\" 1 \"expand\" { target ia32 } } } */\n-/* { dg-final { scan-rtl-dump-times \"const_int 0 \\\\\\[0\\\\\\]\\\\\\)\" 1 \"expand\" { target lp64 } } } */\n-\n-\n+/* { dg-final { scan-rtl-dump-times \"const_int 0 \\\\\\[0\\\\\\]\\\\\\)\" 1 \"expand\" { target { ! ia32 } } } } */"}, {"sha": "4f45755c90da5b30ed242fbf445ff123a517fd54", "filename": "gcc/testsuite/gcc.target/i386/auto-init-padding-8.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f2dcbe4717ce7a117671234940f8b74809f3973/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f2dcbe4717ce7a117671234940f8b74809f3973/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-8.c?ref=2f2dcbe4717ce7a117671234940f8b74809f3973", "patch": "@@ -18,4 +18,4 @@ int foo ()\n }\n \n /* { dg-final { scan-rtl-dump-times \"const_int 0 \\\\\\[0\\\\\\]\\\\\\) repeated x16\" 1 \"expand\" { target ia32 } } } */\n-/* { dg-final { scan-rtl-dump-times \"const_int 0 \\\\\\[0\\\\\\]\\\\\\)\" 1 \"expand\" { target lp64 } } } */\n+/* { dg-final { scan-rtl-dump-times \"const_int 0 \\\\\\[0\\\\\\]\\\\\\)\" 1 \"expand\" { target { ! ia32 } } } } */"}, {"sha": "a87b68b255b0c0ca3ce24b81e382bfac511f9fb2", "filename": "gcc/testsuite/gcc.target/i386/auto-init-padding-9.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f2dcbe4717ce7a117671234940f8b74809f3973/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-9.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f2dcbe4717ce7a117671234940f8b74809f3973/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-9.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-9.c?ref=2f2dcbe4717ce7a117671234940f8b74809f3973", "patch": "@@ -19,7 +19,7 @@ int foo ()\n }\n \n /* { dg-final { scan-assembler \"movl\\t\\\\\\$0,\" } } */\n-/* { dg-final { scan-assembler \"movl\\t\\\\\\$20,\" { target lp64} } } */\n-/* { dg-final { scan-assembler \"rep stosq\" { target lp64 } } } */\n+/* { dg-final { scan-assembler \"movl\\t\\\\\\$20,\" { target { ! ia32 } } } } */\n+/* { dg-final { scan-assembler \"rep stosq\" { target { ! ia32 } } } } */\n /* { dg-final { scan-assembler \"movl\\t\\\\\\$40,\" { target ia32} } } */\n /* { dg-final { scan-assembler \"rep stosl\" { target ia32 } } } */"}]}