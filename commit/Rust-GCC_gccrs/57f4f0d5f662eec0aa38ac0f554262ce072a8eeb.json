{"sha": "57f4f0d5f662eec0aa38ac0f554262ce072a8eeb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTdmNGYwZDVmNjYyZWVjMGFhMzhhYzBmNTU0MjYyY2UwNzJhOGVlYg==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2015-02-08T10:12:38Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2015-02-08T10:12:38Z"}, "message": "decl.c (gnat_to_gnu_param): Do not strip the padding if the parameter either is passed by reference or if...\n\n\t* gcc-interface/decl.c (gnat_to_gnu_param): Do not strip the padding\n\tif the parameter either is passed by reference or if the alignment\n\twould be lowered.\n\nFrom-SVN: r220514", "tree": {"sha": "0051b78ac611dff575529484aa1235a96db8faa9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0051b78ac611dff575529484aa1235a96db8faa9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb/comments", "author": null, "committer": null, "parents": [{"sha": "86ceee8522f4877bd76cd1848e7b39a9b1ce98ce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/86ceee8522f4877bd76cd1848e7b39a9b1ce98ce", "html_url": "https://github.com/Rust-GCC/gccrs/commit/86ceee8522f4877bd76cd1848e7b39a9b1ce98ce"}], "stats": {"total": 61, "additions": 57, "deletions": 4}, "files": [{"sha": "874779e44ea8bc495f2009a32abc8b791217f8ea", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=57f4f0d5f662eec0aa38ac0f554262ce072a8eeb", "patch": "@@ -1,3 +1,9 @@\n+2015-02-08  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc-interface/decl.c (gnat_to_gnu_param): Do not strip the padding\n+\tif the parameter either is passed by reference or if the alignment\n+\twould be lowered.\n+\n 2015-02-08  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gcc-interface/decl.c (is_cplusplus_method): Use Is_Primitive flag to"}, {"sha": "94043b6a397be2159a42b87ca51f1d1b9c5c02b3", "filename": "gcc/ada/gcc-interface/decl.c", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Fdecl.c?ref=57f4f0d5f662eec0aa38ac0f554262ce072a8eeb", "patch": "@@ -5659,15 +5659,17 @@ gnat_to_gnu_param (Entity_Id gnat_param, Mechanism_Type mech,\n     }\n \n   /* If this is either a foreign function or if the underlying type won't\n-     be passed by reference, strip off possible padding type.  */\n+     be passed by reference and is as aligned as the original type, strip\n+     off possible padding type.  */\n   if (TYPE_IS_PADDING_P (gnu_param_type))\n     {\n       tree unpadded_type = TREE_TYPE (TYPE_FIELDS (gnu_param_type));\n \n-      if (mech == By_Reference\n-\t  || foreign\n+      if (foreign\n \t  || (!must_pass_by_ref (unpadded_type)\n-\t      && (mech == By_Copy || !default_pass_by_ref (unpadded_type))))\n+\t      && mech != By_Reference\n+\t      && (mech == By_Copy || !default_pass_by_ref (unpadded_type))\n+\t      && TYPE_ALIGN (unpadded_type) >= TYPE_ALIGN (gnu_param_type)))\n \tgnu_param_type = unpadded_type;\n     }\n "}, {"sha": "878338960ceb2f31db4e419d812ecc26855b0dbc", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=57f4f0d5f662eec0aa38ac0f554262ce072a8eeb", "patch": "@@ -1,3 +1,8 @@\n+2015-02-08  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/addr7.ad[sb]: New test.\n+\t* gnat.dg/addr8.ad[sb]: Likewise.\n+\n 2015-02-06  David Malcolm  <dmalcolm@redhat.com>\n \n \tPR jit/64752"}, {"sha": "982b50e3a1acec269f4fd37fff781b48a05a459c", "filename": "gcc/testsuite/gnat.dg/addr7.adb", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb/gcc%2Ftestsuite%2Fgnat.dg%2Faddr7.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb/gcc%2Ftestsuite%2Fgnat.dg%2Faddr7.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Faddr7.adb?ref=57f4f0d5f662eec0aa38ac0f554262ce072a8eeb", "patch": "@@ -0,0 +1,12 @@\n+-- { dg-do compile }\n+\n+package body Addr7 is\n+\n+   procedure Proc (B: aliased Bytes) is\n+      O: Integer;\n+      for O'Address use B'Address;\n+   begin\n+      null;\n+   end;\n+\n+end Addr7;"}, {"sha": "19fbb0ea90c512b856c05931f238cd601adce3ae", "filename": "gcc/testsuite/gnat.dg/addr7.ads", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb/gcc%2Ftestsuite%2Fgnat.dg%2Faddr7.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb/gcc%2Ftestsuite%2Fgnat.dg%2Faddr7.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Faddr7.ads?ref=57f4f0d5f662eec0aa38ac0f554262ce072a8eeb", "patch": "@@ -0,0 +1,8 @@\n+package Addr7 is\n+\n+   type Bytes is array (1 .. 4) of Character;\n+   for Bytes'Alignment use 4;\n+\n+   procedure Proc (B: aliased Bytes);\n+\n+end Addr7;"}, {"sha": "9105c22f77fb496c78b22d37214da1a759aac4c9", "filename": "gcc/testsuite/gnat.dg/addr8.adb", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb/gcc%2Ftestsuite%2Fgnat.dg%2Faddr8.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb/gcc%2Ftestsuite%2Fgnat.dg%2Faddr8.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Faddr8.adb?ref=57f4f0d5f662eec0aa38ac0f554262ce072a8eeb", "patch": "@@ -0,0 +1,12 @@\n+-- { dg-do compile }\n+\n+package body Addr8 is\n+\n+   procedure Proc (B: Bytes) is\n+      O: Integer;\n+      for O'Address use B'Address;\n+   begin\n+      null;\n+   end;\n+\n+end Addr8;"}, {"sha": "ab648e123c08363f5dcc2b62708c9c1a815122e9", "filename": "gcc/testsuite/gnat.dg/addr8.ads", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb/gcc%2Ftestsuite%2Fgnat.dg%2Faddr8.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57f4f0d5f662eec0aa38ac0f554262ce072a8eeb/gcc%2Ftestsuite%2Fgnat.dg%2Faddr8.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Faddr8.ads?ref=57f4f0d5f662eec0aa38ac0f554262ce072a8eeb", "patch": "@@ -0,0 +1,8 @@\n+package Addr8 is\n+\n+   type Bytes is array (1 .. 4) of Character;\n+   for Bytes'Alignment use 4;\n+\n+   procedure Proc (B: Bytes);\n+\n+end Addr8;"}]}