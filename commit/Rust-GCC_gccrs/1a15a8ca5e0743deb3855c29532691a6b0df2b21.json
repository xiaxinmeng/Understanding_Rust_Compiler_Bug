{"sha": "1a15a8ca5e0743deb3855c29532691a6b0df2b21", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWExNWE4Y2E1ZTA3NDNkZWIzODU1YzI5NTMyNjkxYTZiMGRmMmIyMQ==", "commit": {"author": {"name": "Georg-Johann Lay", "email": "avr@gjlay.de", "date": "2013-07-19T07:53:11Z"}, "committer": {"name": "Georg-Johann Lay", "email": "gjl@gcc.gnu.org", "date": "2013-07-19T07:53:11Z"}, "message": "target-supports.exp (check_effective_target_cilkplus): New proc.\n\n\t* lib/target-supports.exp (check_effective_target_cilkplus): New proc.\n\t* gcc.dg/cilk-plus/cilk-plus.exp: only run if\n\tcheck_effective_target_cilkplus.\n\t* g++.dg/cilk-plus/cilk-plus.exp: Same.\n\nFrom-SVN: r201048", "tree": {"sha": "c6d6b586f9c049a033b8f632ff8dd04679069dc0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c6d6b586f9c049a033b8f632ff8dd04679069dc0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1a15a8ca5e0743deb3855c29532691a6b0df2b21", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a15a8ca5e0743deb3855c29532691a6b0df2b21", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a15a8ca5e0743deb3855c29532691a6b0df2b21", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a15a8ca5e0743deb3855c29532691a6b0df2b21/comments", "author": null, "committer": {"login": "sprintersb", "id": 8905355, "node_id": "MDQ6VXNlcjg5MDUzNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/8905355?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sprintersb", "html_url": "https://github.com/sprintersb", "followers_url": "https://api.github.com/users/sprintersb/followers", "following_url": "https://api.github.com/users/sprintersb/following{/other_user}", "gists_url": "https://api.github.com/users/sprintersb/gists{/gist_id}", "starred_url": "https://api.github.com/users/sprintersb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sprintersb/subscriptions", "organizations_url": "https://api.github.com/users/sprintersb/orgs", "repos_url": "https://api.github.com/users/sprintersb/repos", "events_url": "https://api.github.com/users/sprintersb/events{/privacy}", "received_events_url": "https://api.github.com/users/sprintersb/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e0fc81aa08ce342e3f61ec04dae6eb0fdc256e78", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0fc81aa08ce342e3f61ec04dae6eb0fdc256e78", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e0fc81aa08ce342e3f61ec04dae6eb0fdc256e78"}], "stats": {"total": 33, "additions": 33, "deletions": 0}, "files": [{"sha": "d5f4c32de0272484ff3cde53c83f8b1361067f91", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a15a8ca5e0743deb3855c29532691a6b0df2b21/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a15a8ca5e0743deb3855c29532691a6b0df2b21/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1a15a8ca5e0743deb3855c29532691a6b0df2b21", "patch": "@@ -1,3 +1,10 @@\n+2013-07-19  Georg-Johann Lay  <avr@gjlay.de>\n+\n+\t* lib/target-supports.exp (check_effective_target_cilkplus): New proc.\n+\t* gcc.dg/cilk-plus/cilk-plus.exp: only run if\n+\tcheck_effective_target_cilkplus.\n+\t* g++.dg/cilk-plus/cilk-plus.exp: Same.\n+\n 2013-07-18  Pat Haugen  <pthaugen@us.ibm.com>\n \n \t* gcc.target/powerpc/pr57744.c: Fix typo."}, {"sha": "7e0fda57b27ffedeeaf55ca2177f54ef47df5d70", "filename": "gcc/testsuite/g++.dg/cilk-plus/cilk-plus.exp", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a15a8ca5e0743deb3855c29532691a6b0df2b21/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcilk-plus%2Fcilk-plus.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a15a8ca5e0743deb3855c29532691a6b0df2b21/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcilk-plus%2Fcilk-plus.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcilk-plus%2Fcilk-plus.exp?ref=1a15a8ca5e0743deb3855c29532691a6b0df2b21", "patch": "@@ -19,6 +19,10 @@\n \n load_lib g++-dg.exp\n \n+if { ![check_effective_target_cilkplus] } {\n+    return;\n+}\n+\n dg-init\n dg-runtest [lsort [glob -nocomplain $srcdir/c-c++-common/cilk-plus/AN/*.c]] \" -fcilkplus\" \" \"\n dg-runtest [lsort [glob -nocomplain $srcdir/c-c++-common/cilk-plus/AN/*.c]] \" -O0 -fcilkplus\" \" \""}, {"sha": "2533febc8ab78b6667d35ecf43f39600ca2723da", "filename": "gcc/testsuite/gcc.dg/cilk-plus/cilk-plus.exp", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a15a8ca5e0743deb3855c29532691a6b0df2b21/gcc%2Ftestsuite%2Fgcc.dg%2Fcilk-plus%2Fcilk-plus.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a15a8ca5e0743deb3855c29532691a6b0df2b21/gcc%2Ftestsuite%2Fgcc.dg%2Fcilk-plus%2Fcilk-plus.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcilk-plus%2Fcilk-plus.exp?ref=1a15a8ca5e0743deb3855c29532691a6b0df2b21", "patch": "@@ -19,6 +19,10 @@\n \n load_lib gcc-dg.exp\n \n+if { ![check_effective_target_cilkplus] } {\n+    return;\n+}\n+\n dg-init\n dg-runtest [lsort [glob -nocomplain $srcdir/c-c++-common/cilk-plus/AN/*.c]] \" -fcilkplus\" \" \"\n dg-runtest [lsort [glob -nocomplain $srcdir/c-c++-common/cilk-plus/AN/*.c]] \" -O0 -fcilkplus\" \" \""}, {"sha": "fe51fde52d3cdcf0cd854761766efefb6b71bf6f", "filename": "gcc/testsuite/lib/target-supports.exp", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a15a8ca5e0743deb3855c29532691a6b0df2b21/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a15a8ca5e0743deb3855c29532691a6b0df2b21/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp?ref=1a15a8ca5e0743deb3855c29532691a6b0df2b21", "patch": "@@ -1132,6 +1132,24 @@ proc check_effective_target_static_libgfortran { } {\n     } \"-static\"]\n }\n \n+# Return 1 if cilk-plus is supported by the target, 0 otherwise.\n+ \n+proc check_effective_target_cilkplus { } {\n+    # Skip cilk-plus tests on int16 and size16 targets for now.\n+    # The cilk-plus tests are not generic enough to cover these\n+    # cases and would throw hundreds of FAILs.\n+    if { [check_effective_target_int16]\n+\t || ![check_effective_target_size32plus] } {\n+\treturn 0;\n+    }\n+\n+    # Skip AVR, its RAM is too small and too many tests would fail.\n+    if { [istarget avr-*-*] } {\n+\treturn 0;\n+    }\n+    return 1\n+}\n+\n proc check_linker_plugin_available { } {\n   return [check_no_compiler_messages_nocache linker_plugin executable {\n      int main() { return 0; }"}]}