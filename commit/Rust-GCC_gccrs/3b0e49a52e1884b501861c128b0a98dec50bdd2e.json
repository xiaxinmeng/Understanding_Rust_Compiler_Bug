{"sha": "3b0e49a52e1884b501861c128b0a98dec50bdd2e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2IwZTQ5YTUyZTE4ODRiNTAxODYxYzEyOGIwYTk4ZGVjNTBiZGQyZQ==", "commit": {"author": {"name": "Thomas K\u00f6nig", "email": "tkoenig@gcc.gnu.org", "date": "2020-04-14T11:50:51Z"}, "committer": {"name": "Thomas K\u00f6nig", "email": "tkoenig@gcc.gnu.org", "date": "2020-04-14T11:50:51Z"}, "message": "Fix PR 94270 by not warning about artifical dummy arguments.\n\n2020-04-14  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/94270\n\t* interface.c (gfc_get_formal_from_actual_arglist): Always\n\tset artificial attribute for symbols.\n\t* trans-decl.c (generate_local_decl): Do not warn if the\n\tsymbol is artifical.\n\n2020-04-14  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/94270\n\t* gfortran.dg/warn_unused_dummy_argument_6.f90: New test.", "tree": {"sha": "726bb3c94000a64c680bc61898ddd4bdb1684122", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/726bb3c94000a64c680bc61898ddd4bdb1684122"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3b0e49a52e1884b501861c128b0a98dec50bdd2e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3b0e49a52e1884b501861c128b0a98dec50bdd2e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3b0e49a52e1884b501861c128b0a98dec50bdd2e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3b0e49a52e1884b501861c128b0a98dec50bdd2e/comments", "author": null, "committer": null, "parents": [{"sha": "a1ff717f59d5198140fa6e1ad814f3d63ccf9925", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a1ff717f59d5198140fa6e1ad814f3d63ccf9925", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a1ff717f59d5198140fa6e1ad814f3d63ccf9925"}], "stats": {"total": 17, "additions": 15, "deletions": 2}, "files": [{"sha": "8f041f0a0a880fb13ce51324026757a1f8a55a42", "filename": "gcc/fortran/interface.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b0e49a52e1884b501861c128b0a98dec50bdd2e/gcc%2Ffortran%2Finterface.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b0e49a52e1884b501861c128b0a98dec50bdd2e/gcc%2Ffortran%2Finterface.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Finterface.c?ref=3b0e49a52e1884b501861c128b0a98dec50bdd2e", "patch": "@@ -5317,7 +5317,6 @@ gfc_get_formal_from_actual_arglist (gfc_symbol *sym,\n \t      s->ts.is_iso_c = 0;\n \t      s->ts.is_c_interop = 0;\n \t      s->attr.flavor = FL_VARIABLE;\n-\t      s->attr.artificial = 1;\n \t      if (a->expr->rank > 0)\n \t\t{\n \t\t  s->attr.dimension = 1;\n@@ -5332,6 +5331,7 @@ gfc_get_formal_from_actual_arglist (gfc_symbol *sym,\n \t\ts->maybe_array = maybe_dummy_array_arg (a->expr);\n \t    }\n \t  s->attr.dummy = 1;\n+\t  s->attr.artificial = 1;\n \t  s->declared_at = a->expr->where;\n \t  s->attr.intent = INTENT_UNKNOWN;\n \t  (*f)->sym = s;"}, {"sha": "487e776f5dd37077221bdf3ac20406928f5ef8ed", "filename": "gcc/fortran/trans-decl.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b0e49a52e1884b501861c128b0a98dec50bdd2e/gcc%2Ffortran%2Ftrans-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b0e49a52e1884b501861c128b0a98dec50bdd2e/gcc%2Ffortran%2Ftrans-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-decl.c?ref=3b0e49a52e1884b501861c128b0a98dec50bdd2e", "patch": "@@ -6072,7 +6072,7 @@ generate_local_decl (gfc_symbol * sym)\n       /* Unused procedure passed as dummy argument.  */\n       if (sym->attr.flavor == FL_PROCEDURE)\n \t{\n-\t  if (!sym->attr.referenced)\n+\t  if (!sym->attr.referenced && !sym->attr.artificial)\n \t    {\n \t      if (warn_unused_dummy_argument)\n \t\tgfc_warning (OPT_Wunused_dummy_argument,"}, {"sha": "72f6d5c08570b314033dcbf2fc6a8ab4a692d7a2", "filename": "gcc/testsuite/gfortran.dg/warn_unused_dummy_argument_6.f90", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b0e49a52e1884b501861c128b0a98dec50bdd2e/gcc%2Ftestsuite%2Fgfortran.dg%2Fwarn_unused_dummy_argument_6.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b0e49a52e1884b501861c128b0a98dec50bdd2e/gcc%2Ftestsuite%2Fgfortran.dg%2Fwarn_unused_dummy_argument_6.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fwarn_unused_dummy_argument_6.f90?ref=3b0e49a52e1884b501861c128b0a98dec50bdd2e", "patch": "@@ -0,0 +1,13 @@\n+! { dg-do compile }\n+! { dg-options \"-Wall\" }\n+! PR 94270 - this used to give a bogus warning.\n+! Test case by Ignacio Fern\u00e1ndez Galv\u00e1n.\n+subroutine foo()\n+external bar\n+call meh(bar)\n+call foo_internal()\n+contains\n+  subroutine foo_internal()\n+    call meh(bar)\n+  end subroutine foo_internal\n+end subroutine foo"}]}