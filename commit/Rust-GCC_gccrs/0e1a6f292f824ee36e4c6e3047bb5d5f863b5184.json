{"sha": "0e1a6f292f824ee36e4c6e3047bb5d5f863b5184", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGUxYTZmMjkyZjgyNGVlMzZlNGM2ZTMwNDdiYjVkNWY4NjNiNTE4NA==", "commit": {"author": {"name": "Olivier Hainque", "email": "hainque@adacore.com", "date": "2007-06-12T13:32:27Z"}, "committer": {"name": "Olivier Hainque", "email": "hainque@gcc.gnu.org", "date": "2007-06-12T13:32:27Z"}, "message": "tree-nested.c (convert_local_reference): Handle VIEW_CONVERT_EXPR.\n\n\t* tree-nested.c (convert_local_reference): Handle VIEW_CONVERT_EXPR.\n\tRequest walking the subtrees only, leaving the current is_lhs/val_only\n\tuntouched.\n\t(convert_non_local_reference): Likewise.\n\n\ttestsuite/\n\t* gnat.dg/lhs_view_convert.adb: New test.\n\nFrom-SVN: r125646", "tree": {"sha": "3259accf8e26823f3276d4d3a167b9abdebc6ce1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3259accf8e26823f3276d4d3a167b9abdebc6ce1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0e1a6f292f824ee36e4c6e3047bb5d5f863b5184", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0e1a6f292f824ee36e4c6e3047bb5d5f863b5184", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0e1a6f292f824ee36e4c6e3047bb5d5f863b5184", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0e1a6f292f824ee36e4c6e3047bb5d5f863b5184/comments", "author": {"login": "hainque", "id": 18735142, "node_id": "MDQ6VXNlcjE4NzM1MTQy", "avatar_url": "https://avatars.githubusercontent.com/u/18735142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hainque", "html_url": "https://github.com/hainque", "followers_url": "https://api.github.com/users/hainque/followers", "following_url": "https://api.github.com/users/hainque/following{/other_user}", "gists_url": "https://api.github.com/users/hainque/gists{/gist_id}", "starred_url": "https://api.github.com/users/hainque/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hainque/subscriptions", "organizations_url": "https://api.github.com/users/hainque/orgs", "repos_url": "https://api.github.com/users/hainque/repos", "events_url": "https://api.github.com/users/hainque/events{/privacy}", "received_events_url": "https://api.github.com/users/hainque/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "beff4180563acfb4c308a7c48b0ca6f5ff6a6782", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/beff4180563acfb4c308a7c48b0ca6f5ff6a6782", "html_url": "https://github.com/Rust-GCC/gccrs/commit/beff4180563acfb4c308a7c48b0ca6f5ff6a6782"}], "stats": {"total": 54, "additions": 54, "deletions": 0}, "files": [{"sha": "7cb1cf2396cd44f7a2407ec4d0e29023f4b83cca", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e1a6f292f824ee36e4c6e3047bb5d5f863b5184/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e1a6f292f824ee36e4c6e3047bb5d5f863b5184/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0e1a6f292f824ee36e4c6e3047bb5d5f863b5184", "patch": "@@ -1,3 +1,10 @@\n+2007-06-12  Olivier Hainque  <hainque@adacore.com>\n+\n+\t* tree-nested.c (convert_local_reference): Handle VIEW_CONVERT_EXPR.\n+\tRequest walking the subtrees only, leaving the current is_lhs/val_only\n+\tuntouched.\n+\t(convert_non_local_reference): Likewise.\n+\t\n 2007-06-12  Nathan Sidwell  <nathan@codesourcery.com>\n \n \t* config/m68k/m68k-devices.def (52221, 52223, 5253): New."}, {"sha": "7aec66339d3e44dd4615dcca1e0852ff8c2ae7f0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e1a6f292f824ee36e4c6e3047bb5d5f863b5184/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e1a6f292f824ee36e4c6e3047bb5d5f863b5184/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0e1a6f292f824ee36e4c6e3047bb5d5f863b5184", "patch": "@@ -1,3 +1,7 @@\n+2007-06-12  Olivier Hainque  <hainque@adacore.com>\n+\n+\t* gnat.dg/lhs_view_convert.adb: New test.\n+\n 2007-06-12  Richard Guenther  <rguenther@suse.de>\n \n \tPR tree-optimization/15353"}, {"sha": "e7947f033d889730e4a53b6053d2b2f60fef6641", "filename": "gcc/testsuite/gnat.dg/lhs_view_convert.adb", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e1a6f292f824ee36e4c6e3047bb5d5f863b5184/gcc%2Ftestsuite%2Fgnat.dg%2Flhs_view_convert.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e1a6f292f824ee36e4c6e3047bb5d5f863b5184/gcc%2Ftestsuite%2Fgnat.dg%2Flhs_view_convert.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Flhs_view_convert.adb?ref=0e1a6f292f824ee36e4c6e3047bb5d5f863b5184", "patch": "@@ -0,0 +1,29 @@\n+-- { dg-do run }\n+-- { dg-options \"-gnatp\" }\n+\n+procedure Lhs_View_Convert is\n+\n+   type Root is tagged record\n+      RV : Natural;\n+   end record;\n+\n+   type Derived is new Root with null record;\n+\n+   Root_Instance : Root := (RV => 1);\n+\n+   Derived_Instance : Derived;\n+\n+   procedure Process is\n+      X : Natural := Derived_Instance.RV;\n+   begin\n+      null;\n+   end;\n+begin\n+   Derived_Instance.RV := 2;\n+   \n+   Root (Derived_Instance) := Root (Root_Instance);\n+   \n+   if Derived_Instance.RV /= Root_Instance.RV then\n+      raise Program_Error;\n+   end if;\n+end;"}, {"sha": "dbb146d0866f193898a7c0479fa2e87a275c2f34", "filename": "gcc/tree-nested.c", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e1a6f292f824ee36e4c6e3047bb5d5f863b5184/gcc%2Ftree-nested.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e1a6f292f824ee36e4c6e3047bb5d5f863b5184/gcc%2Ftree-nested.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-nested.c?ref=0e1a6f292f824ee36e4c6e3047bb5d5f863b5184", "patch": "@@ -1035,6 +1035,13 @@ convert_nonlocal_reference (tree *tp, int *walk_subtrees, void *data)\n       walk_tree (tp, convert_nonlocal_reference, wi, NULL);\n       break;\n \n+    case VIEW_CONVERT_EXPR:\n+      /* Just request to look at the subtrees, leaving val_only and lhs\n+\t untouched.  This might actually be for !val_only + lhs, in which\n+\t case we don't want to force a replacement by a temporary.  */\n+      *walk_subtrees = 1;\n+      break;\n+\n     case OMP_PARALLEL:\n       save_suppress = info->suppress_expansion;\n       if (convert_nonlocal_omp_clauses (&OMP_PARALLEL_CLAUSES (t), wi))\n@@ -1313,6 +1320,13 @@ convert_local_reference (tree *tp, int *walk_subtrees, void *data)\n       wi->val_only = save_val_only;\n       break;\n \n+    case VIEW_CONVERT_EXPR:\n+      /* Just request to look at the subtrees, leaving val_only and lhs\n+\t untouched.  This might actually be for !val_only + lhs, in which\n+\t case we don't want to force a replacement by a temporary.  */\n+      *walk_subtrees = 1;\n+      break;\n+\n     case OMP_PARALLEL:\n       save_suppress = info->suppress_expansion;\n       if (convert_local_omp_clauses (&OMP_PARALLEL_CLAUSES (t), wi))"}]}