{"sha": "75fad0a98919da8212be4efc479d098499f4f1c3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzVmYWQwYTk4OTE5ZGE4MjEyYmU0ZWZjNDc5ZDA5ODQ5OWY0ZjFjMw==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2019-07-05T12:48:42Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2019-07-05T12:48:42Z"}, "message": "re PR tree-optimization/91091 ([missed optimization] Missing optimization in unaliased pointers)\n\n2019-07-05  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/91091\n\t* tree-ssa-sccvn.c (vn_reference_lookup_3): Overlap of\n\taccesses can happen with -fno-strict-aliasing.\n\n\t* gcc.dg/tree-ssa/pr91091-1.c: New testcase.\n\t* gcc.dg/tree-ssa/ssa-fre-61.c: Adjust.\n\nFrom-SVN: r273134", "tree": {"sha": "3daeebb2ad8afb9e01b95c8297cb83c91f22ea97", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3daeebb2ad8afb9e01b95c8297cb83c91f22ea97"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/75fad0a98919da8212be4efc479d098499f4f1c3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75fad0a98919da8212be4efc479d098499f4f1c3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/75fad0a98919da8212be4efc479d098499f4f1c3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75fad0a98919da8212be4efc479d098499f4f1c3/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1d776353135272b1fcb7453ae9c8bd4fafd9bd07", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1d776353135272b1fcb7453ae9c8bd4fafd9bd07", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1d776353135272b1fcb7453ae9c8bd4fafd9bd07"}], "stats": {"total": 40, "additions": 38, "deletions": 2}, "files": [{"sha": "25e539fbf323c0f37498a9cb36572a34d2c9fe62", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75fad0a98919da8212be4efc479d098499f4f1c3/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75fad0a98919da8212be4efc479d098499f4f1c3/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=75fad0a98919da8212be4efc479d098499f4f1c3", "patch": "@@ -1,3 +1,9 @@\n+2019-07-05  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/91091\n+\t* tree-ssa-sccvn.c (vn_reference_lookup_3): Overlap of\n+\taccesses can happen with -fno-strict-aliasing.\n+\n 2019-07-05  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* tree-ssa-alias.c (alias_stats): Add"}, {"sha": "6c049d0f484f010716a967de25230c47affe66d2", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75fad0a98919da8212be4efc479d098499f4f1c3/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75fad0a98919da8212be4efc479d098499f4f1c3/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=75fad0a98919da8212be4efc479d098499f4f1c3", "patch": "@@ -1,3 +1,9 @@\n+2019-07-05  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/91091\n+\t* gcc.dg/tree-ssa/pr91091-1.c: New testcase.\n+\t* gcc.dg/tree-ssa/ssa-fre-61.c: Adjust.\n+\n 2019-07-05  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gnat.dg/pack23.adb, gnat.dg/pack23_pkg.ads: New testcase."}, {"sha": "2ee75d9804adb706dd9c0f752090f9ef2d32a148", "filename": "gcc/testsuite/gcc.dg/tree-ssa/pr91091-1.c", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75fad0a98919da8212be4efc479d098499f4f1c3/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr91091-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75fad0a98919da8212be4efc479d098499f4f1c3/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr91091-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr91091-1.c?ref=75fad0a98919da8212be4efc479d098499f4f1c3", "patch": "@@ -0,0 +1,23 @@\n+/* { dg-do run } */\n+/* { dg-options \"-O3 -fno-strict-aliasing\" } */\n+\n+struct s { int x; } __attribute__((packed));\n+struct t { int x; };\n+\n+void __attribute__((noinline,noipa))\n+swap(struct s* p, struct t* q)\n+{\n+  p->x = q->x;\n+  q->x = p->x;\n+}\n+\n+int main()\n+{    \n+  struct t a[2];\n+  a[0].x = 0x12345678;\n+  a[1].x = 0x98765432;\n+  swap ((struct s *)((char *)a + 1), a);\n+  if (a[0].x != 0x12345678)\n+    __builtin_abort ();\n+  return 0;\n+}"}, {"sha": "eae4b15b7f2c769a098c432348afa72dbec1ee56", "filename": "gcc/testsuite/gcc.dg/tree-ssa/ssa-fre-61.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75fad0a98919da8212be4efc479d098499f4f1c3/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fssa-fre-61.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75fad0a98919da8212be4efc479d098499f4f1c3/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fssa-fre-61.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fssa-fre-61.c?ref=75fad0a98919da8212be4efc479d098499f4f1c3", "patch": "@@ -1,5 +1,5 @@\n /* { dg-do link } */\n-/* { dg-options \"-O -fdump-tree-fre1-details\" } */\n+/* { dg-options \"-O -fstrict-aliasing -fdump-tree-fre1-details\" } */\n \n void link_error (void);\n "}, {"sha": "2cc76d89bd4515a5889d09fc0a69ff6f03648bfd", "filename": "gcc/tree-ssa-sccvn.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75fad0a98919da8212be4efc479d098499f4f1c3/gcc%2Ftree-ssa-sccvn.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75fad0a98919da8212be4efc479d098499f4f1c3/gcc%2Ftree-ssa-sccvn.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-sccvn.c?ref=75fad0a98919da8212be4efc479d098499f4f1c3", "patch": "@@ -1996,7 +1996,8 @@ vn_reference_lookup_3 (ao_ref *ref, tree vuse, void *data_,\n \t     activation of a union member via a store makes the\n \t     values of untouched bytes unspecified.  */\n \t  && (known_eq (ref->size, BITS_PER_UNIT)\n-\t      || (get_alias_set (lhs) != 0\n+\t      || (flag_strict_aliasing\n+\t\t  && get_alias_set (lhs) != 0\n \t\t  && ao_ref_alias_set (ref) != 0)))\n \t{\n \t  tree *saved_last_vuse_ptr = data->last_vuse_ptr;"}]}