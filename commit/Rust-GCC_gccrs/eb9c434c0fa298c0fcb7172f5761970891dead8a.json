{"sha": "eb9c434c0fa298c0fcb7172f5761970891dead8a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWI5YzQzNGMwZmEyOThjMGZjYjcxNzJmNTc2MTk3MDg5MWRlYWQ4YQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2008-07-29T16:29:33Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2008-07-29T16:29:33Z"}, "message": "re PR c++/36852 (Two dimensional array in template method argument list incorrectly interpreted.)\n\n\tPR c++/36852\n\t* tree.c (cplus_array_hash, build_cplus_array_type_1): Hash on\n\tTYPE_UID instead of pointers.\n\n\t* g++.dg/pch/array-1.C: New test.\n\t* g++.dg/pch/array-1.Hs: New file.\n\nFrom-SVN: r138250", "tree": {"sha": "15c1e6e162b23f0c7c5bceaffb233c6f0ed15adb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/15c1e6e162b23f0c7c5bceaffb233c6f0ed15adb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/eb9c434c0fa298c0fcb7172f5761970891dead8a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eb9c434c0fa298c0fcb7172f5761970891dead8a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eb9c434c0fa298c0fcb7172f5761970891dead8a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eb9c434c0fa298c0fcb7172f5761970891dead8a/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "11cc4546906b5b73b367b7e14df85281fbed04db", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/11cc4546906b5b73b367b7e14df85281fbed04db", "html_url": "https://github.com/Rust-GCC/gccrs/commit/11cc4546906b5b73b367b7e14df85281fbed04db"}], "stats": {"total": 42, "additions": 37, "deletions": 5}, "files": [{"sha": "e05b0cb8d9413f1448abac1f77b6b744e4eb3c19", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb9c434c0fa298c0fcb7172f5761970891dead8a/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb9c434c0fa298c0fcb7172f5761970891dead8a/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=eb9c434c0fa298c0fcb7172f5761970891dead8a", "patch": "@@ -1,3 +1,9 @@\n+2008-07-29  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c++/36852\n+\t* tree.c (cplus_array_hash, build_cplus_array_type_1): Hash on\n+\tTYPE_UID instead of pointers.\n+\n 2008-07-29  Jan Hubicka  <jh@suse.cz>\n \n  \t* optimize.c (maybe_clone_body): Remove DECL_INLINE."}, {"sha": "50c3049c3d07271907406161ef1106aece2e0ac7", "filename": "gcc/cp/tree.c", "status": "modified", "additions": 6, "deletions": 5, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb9c434c0fa298c0fcb7172f5761970891dead8a/gcc%2Fcp%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb9c434c0fa298c0fcb7172f5761970891dead8a/gcc%2Fcp%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftree.c?ref=eb9c434c0fa298c0fcb7172f5761970891dead8a", "patch": "@@ -504,9 +504,9 @@ cplus_array_hash (const void* k)\n   hashval_t hash;\n   const_tree const t = (const_tree) k;\n \n-  hash = (htab_hash_pointer (TREE_TYPE (t))\n-\t  ^ htab_hash_pointer (TYPE_DOMAIN (t)));\n-\n+  hash = TYPE_UID (TREE_TYPE (t));\n+  if (TYPE_DOMAIN (t))\n+    hash ^= TYPE_UID (TYPE_DOMAIN (t));\n   return hash;\n }\n \n@@ -553,8 +553,9 @@ build_cplus_array_type_1 (tree elt_type, tree index_type)\n \tcplus_array_htab = htab_create_ggc (61, &cplus_array_hash,\n \t\t\t\t\t    &cplus_array_compare, NULL);\n       \n-      hash = (htab_hash_pointer (elt_type)\n-\t      ^ htab_hash_pointer (index_type));\n+      hash = TYPE_UID (elt_type);\n+      if (index_type)\n+\thash ^= TYPE_UID (index_type);\n       cai.type = elt_type;\n       cai.domain = index_type;\n "}, {"sha": "d4e8ddb8701b01117108660feda8b16d5f71f8d0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb9c434c0fa298c0fcb7172f5761970891dead8a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb9c434c0fa298c0fcb7172f5761970891dead8a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=eb9c434c0fa298c0fcb7172f5761970891dead8a", "patch": "@@ -1,3 +1,9 @@\n+2008-07-29  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c++/36852\n+\t* g++.dg/pch/array-1.C: New test.\n+\t* g++.dg/pch/array-1.Hs: New file.\n+\n 2008-07-29  Jan Hubicka  <jh@suse.cz>\n \n \t* gcc.dg/20040206-1.c: Expect frontend warning now."}, {"sha": "a8935ed2606d5d3dc55da80180c7db0e8f7015d8", "filename": "gcc/testsuite/g++.dg/pch/array-1.C", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb9c434c0fa298c0fcb7172f5761970891dead8a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpch%2Farray-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb9c434c0fa298c0fcb7172f5761970891dead8a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpch%2Farray-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpch%2Farray-1.C?ref=eb9c434c0fa298c0fcb7172f5761970891dead8a", "patch": "@@ -0,0 +1,15 @@\n+// PR c++/36852\n+\n+#include \"array-1.H\"\n+\n+template <class T>\n+T\n+A::foo (T t[3][3])\n+{\n+  return t[0][1];\n+}\n+\n+int\n+main ()\n+{\n+}"}, {"sha": "fb44b675e3a7ae52626e7e40cd8487de1dd1e71d", "filename": "gcc/testsuite/g++.dg/pch/array-1.Hs", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb9c434c0fa298c0fcb7172f5761970891dead8a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpch%2Farray-1.Hs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb9c434c0fa298c0fcb7172f5761970891dead8a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpch%2Farray-1.Hs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpch%2Farray-1.Hs?ref=eb9c434c0fa298c0fcb7172f5761970891dead8a", "patch": "@@ -0,0 +1,4 @@\n+struct A\n+{\n+  template <class T> static T foo (T[3][3]);\n+};"}]}