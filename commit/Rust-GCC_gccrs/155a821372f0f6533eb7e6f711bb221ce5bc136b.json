{"sha": "155a821372f0f6533eb7e6f711bb221ce5bc136b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTU1YTgyMTM3MmYwZjY1MzNlYjdlNmY3MTFiYjIyMWNlNWJjMTM2Yg==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2005-01-02T08:35:34Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2005-01-02T08:35:34Z"}, "message": "tree-vectorizer.c (vect_analyze_offset_expr): Strip conversions that don't narrow the value.\n\n        * tree-vectorizer.c (vect_analyze_offset_expr): Strip conversions\n        that don't narrow the value.  Fail for other conversions.\n\nFrom-SVN: r92804", "tree": {"sha": "7ac40de5ff75592ffe8a5c47e0137e8c80274d06", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7ac40de5ff75592ffe8a5c47e0137e8c80274d06"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/155a821372f0f6533eb7e6f711bb221ce5bc136b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/155a821372f0f6533eb7e6f711bb221ce5bc136b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/155a821372f0f6533eb7e6f711bb221ce5bc136b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/155a821372f0f6533eb7e6f711bb221ce5bc136b/comments", "author": null, "committer": null, "parents": [{"sha": "bedb9fc04bb56b56d8af671bdfe28cc9052622ec", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bedb9fc04bb56b56d8af671bdfe28cc9052622ec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bedb9fc04bb56b56d8af671bdfe28cc9052622ec"}], "stats": {"total": 22, "additions": 21, "deletions": 1}, "files": [{"sha": "20b6d358e3bec881cad211f3aad38227d9ebc17c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/155a821372f0f6533eb7e6f711bb221ce5bc136b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/155a821372f0f6533eb7e6f711bb221ce5bc136b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=155a821372f0f6533eb7e6f711bb221ce5bc136b", "patch": "@@ -1,3 +1,8 @@\n+2005-01-01  Richard Henderson  <rth@redhat.com>\n+\n+\t* tree-vectorizer.c (vect_analyze_offset_expr): Strip conversions\n+\tthat don't narrow the value.  Fail for other conversions.\n+\n 2005-01-01  Richard Henderson  <rth@redhat.com>\n \n \tPR c/19031"}, {"sha": "bd826d0127c659c91bc20644e3eb37c397c90f93", "filename": "gcc/tree-vectorizer.c", "status": "modified", "additions": 16, "deletions": 1, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/155a821372f0f6533eb7e6f711bb221ce5bc136b/gcc%2Ftree-vectorizer.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/155a821372f0f6533eb7e6f711bb221ce5bc136b/gcc%2Ftree-vectorizer.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vectorizer.c?ref=155a821372f0f6533eb7e6f711bb221ce5bc136b", "patch": "@@ -1390,7 +1390,22 @@ vect_analyze_offset_expr (tree expr,\n   enum tree_code code;\n   tree init, evolution, def_stmt;\n \n-  STRIP_NOPS (expr);\n+  /* Strip conversions that don't narrow the mode.  */\n+  while (TREE_CODE (expr) == NOP_EXPR || TREE_CODE (expr) == CONVERT_EXPR)\n+    {\n+      tree to, ti;\n+\n+      to = TREE_TYPE (expr);\n+      oprnd0 = TREE_OPERAND (expr, 0);\n+      ti = TREE_TYPE (oprnd0);\n+\n+      if (!INTEGRAL_TYPE_P (to) || !INTEGRAL_TYPE_P (ti))\n+\treturn false;\n+      if (GET_MODE_SIZE (TYPE_MODE (to)) < GET_MODE_SIZE (TYPE_MODE (ti)))\n+\treturn false;\n+\n+      expr = oprnd0;\n+    }\n   \n   *step = NULL_TREE;\n   *misalign = NULL_TREE;"}]}