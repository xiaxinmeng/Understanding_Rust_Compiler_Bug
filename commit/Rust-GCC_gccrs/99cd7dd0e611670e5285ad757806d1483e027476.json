{"sha": "99cd7dd0e611670e5285ad757806d1483e027476", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTljZDdkZDBlNjExNjcwZTUyODVhZDc1NzgwNmQxNDgzZTAyNzQ3Ng==", "commit": {"author": {"name": "Andreas Krebbel", "email": "krebbel1@de.ibm.com", "date": "2007-03-28T08:39:03Z"}, "committer": {"name": "Andreas Krebbel", "email": "krebbel@gcc.gnu.org", "date": "2007-03-28T08:39:03Z"}, "message": "s390.md (\"fix_trunc<mode>di2\"): New expander.\n\n2007-03-28  Andreas Krebbel  <krebbel1@de.ibm.com>\n\n\t* config/s390/s390.md (\"fix_trunc<mode>di2\"): New expander.\n\t(\"fix_trunc<DFP:mode>di2_dfp\"): New insn definition renamed from\n\tfix_trunc<mode>di2.\n\t(\"fixuns_truncdddi2\", \"fixuns_trunctddi2\"): Use \n\tfix_trunc<DFP:mode>di2_dfp instead of fix_trunc<mode>di2.\n\t(\"fix_truncdfsi2\", \"fix_truncsfsi2\", \"fixuns_truncdddi2\",\n\t\"fixuns_trunctddi2\"): Whitespace fix.\n\nFrom-SVN: r123291", "tree": {"sha": "540dea2916de9820fb50484cd3db9665ea8f6a14", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/540dea2916de9820fb50484cd3db9665ea8f6a14"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/99cd7dd0e611670e5285ad757806d1483e027476", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/99cd7dd0e611670e5285ad757806d1483e027476", "html_url": "https://github.com/Rust-GCC/gccrs/commit/99cd7dd0e611670e5285ad757806d1483e027476", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/99cd7dd0e611670e5285ad757806d1483e027476/comments", "author": null, "committer": null, "parents": [{"sha": "e318fc8faba5ae9a6be5bf986b56d9a91815dbbb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e318fc8faba5ae9a6be5bf986b56d9a91815dbbb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e318fc8faba5ae9a6be5bf986b56d9a91815dbbb"}], "stats": {"total": 37, "additions": 29, "deletions": 8}, "files": [{"sha": "081cbd5ca2d2b99bb044f9d791c423adb253d338", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/99cd7dd0e611670e5285ad757806d1483e027476/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/99cd7dd0e611670e5285ad757806d1483e027476/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=99cd7dd0e611670e5285ad757806d1483e027476", "patch": "@@ -1,3 +1,13 @@\n+2007-03-28  Andreas Krebbel  <krebbel1@de.ibm.com>\n+\n+\t* config/s390/s390.md (\"fix_trunc<mode>di2\"): New expander.\n+\t(\"fix_trunc<DFP:mode>di2_dfp\"): New insn definition renamed from\n+\tfix_trunc<mode>di2.\n+\t(\"fixuns_truncdddi2\", \"fixuns_trunctddi2\"): Use \n+\tfix_trunc<DFP:mode>di2_dfp instead of fix_trunc<mode>di2.\n+\t(\"fix_truncdfsi2\", \"fix_truncsfsi2\", \"fixuns_truncdddi2\",\n+\t\"fixuns_trunctddi2\"): Whitespace fix.\n+\n 2007-03-28  Kaz Kojima  <kkojima@gcc.gnu.org>\n \n \t* config/sh/sh.h (CALL_COOKIE_RET_TRAMP_SHIFT): Move after"}, {"sha": "3fd6c319f249e064a57a993741d1f146f645c912", "filename": "gcc/config/s390/s390.md", "status": "modified", "additions": 19, "deletions": 8, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/99cd7dd0e611670e5285ad757806d1483e027476/gcc%2Fconfig%2Fs390%2Fs390.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/99cd7dd0e611670e5285ad757806d1483e027476/gcc%2Fconfig%2Fs390%2Fs390.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fs390%2Fs390.md?ref=99cd7dd0e611670e5285ad757806d1483e027476", "patch": "@@ -3219,11 +3219,11 @@\n   emit_jump_insn (gen_blt (label1));\n   emit_insn (gen_subtd3 (temp, temp,\n \tCONST_DOUBLE_FROM_REAL_VALUE (sub, TDmode)));\n-  emit_insn (gen_fix_trunctddi2 (operands[0], temp, GEN_INT(11)));\n+  emit_insn (gen_fix_trunctddi2_dfp (operands[0], temp, GEN_INT (11)));\n   emit_jump (label2);\n \n   emit_label (label1);\n-  emit_insn (gen_fix_truncdddi2 (operands[0], operands[1], GEN_INT(9)));\n+  emit_insn (gen_fix_truncdddi2_dfp (operands[0], operands[1], GEN_INT (9)));\n   emit_label (label2);\n   DONE;\n })\n@@ -3247,11 +3247,11 @@\n   emit_jump_insn (gen_blt (label1));\n   emit_insn (gen_subtd3 (temp, operands[1],\n \tCONST_DOUBLE_FROM_REAL_VALUE (sub, TDmode)));\n-  emit_insn (gen_fix_trunctddi2 (operands[0], temp, GEN_INT(11)));\n+  emit_insn (gen_fix_trunctddi2_dfp (operands[0], temp, GEN_INT (11)));\n   emit_jump (label2);\n \n   emit_label (label1);\n-  emit_insn (gen_fix_trunctddi2 (operands[0], operands[1], GEN_INT(9)));\n+  emit_insn (gen_fix_trunctddi2_dfp (operands[0], operands[1], GEN_INT (9)));\n   emit_label (label2);\n   DONE;\n })\n@@ -3281,12 +3281,12 @@\n   emit_insn (gen_sub<BFP:mode>3 (temp, operands[1],\n \tCONST_DOUBLE_FROM_REAL_VALUE (sub, <BFP:MODE>mode)));\n   emit_insn (gen_fix_trunc<BFP:mode><GPR:mode>2_ieee (operands[0], temp,\n-\tGEN_INT(7)));\n+\tGEN_INT (7)));\n   emit_jump (label2);\n \n   emit_label (label1);\n   emit_insn (gen_fix_trunc<BFP:mode><GPR:mode>2_ieee (operands[0],\n-\toperands[1], GEN_INT(5)));\n+\toperands[1], GEN_INT (5)));\n   emit_label (label2);\n   DONE;\n })\n@@ -3298,7 +3298,7 @@\n {\n   operands[1] = force_reg (<MODE>mode, operands[1]);\n   emit_insn (gen_fix_trunc<mode>di2_ieee (operands[0], operands[1],\n-      GEN_INT(5)));\n+      GEN_INT (5)));\n   DONE;\n })\n \n@@ -3318,8 +3318,19 @@\n ; fix_trunc(td|dd)di2 instruction pattern(s).\n ;\n \n+(define_expand \"fix_trunc<mode>di2\"\n+  [(set (match_operand:DI 0 \"register_operand\" \"\")\n+        (fix:DI (match_operand:DFP 1 \"nonimmediate_operand\" \"\")))]\n+  \"TARGET_64BIT && TARGET_HARD_FLOAT && TARGET_HARD_DFP\"\n+{\n+  operands[1] = force_reg (<MODE>mode, operands[1]);\n+  emit_insn (gen_fix_trunc<mode>di2_dfp (operands[0], operands[1],\n+      GEN_INT (9)));\n+  DONE;\n+})\n+\n ; cgxtr, cgdtr\n-(define_insn \"fix_trunc<DFP:mode>di2\"\n+(define_insn \"fix_trunc<DFP:mode>di2_dfp\"\n   [(set (match_operand:DI 0 \"register_operand\" \"=d\")\n         (fix:DI (match_operand:DFP 1 \"register_operand\" \"f\")))\n    (unspec:DI [(match_operand:DI 2 \"immediate_operand\" \"K\")] UNSPEC_ROUND)"}]}