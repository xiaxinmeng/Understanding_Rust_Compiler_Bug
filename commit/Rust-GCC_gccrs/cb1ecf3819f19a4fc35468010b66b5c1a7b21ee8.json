{"sha": "cb1ecf3819f19a4fc35468010b66b5c1a7b21ee8", "node_id": "C_kwDOANBUbNoAKGNiMWVjZjM4MTlmMTlhNGZjMzU0NjgwMTBiNjZiNWMxYTdiMjFlZTg", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2022-06-13T08:03:36Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2022-06-13T11:35:33Z"}, "message": "Do not erase warning data in gimple_set_location\n\ngimple_set_location is mostly invoked on newly built GIMPLE statements, so\ntheir location is UNKNOWN_LOCATION and setting it will clobber the warning\ndata of the passed location, if any.\n\ngcc/\n\t* dwarf2out.cc (output_one_line_info_table): Initialize prev_addr.\n\t* gimple.h (gimple_set_location): Do not copy warning data from\n\tthe previous location when it is UNKNOWN_LOCATION.\n\t* optabs.cc (expand_widen_pattern_expr): Always set oprnd{1,2}.\ngcc/testsuite/\n\t* c-c++-common/nonnull-1.c: Remove XFAIL for C++.", "tree": {"sha": "82d4d3db3c65eb4cf3e013d3b0d6072945a170ec", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/82d4d3db3c65eb4cf3e013d3b0d6072945a170ec"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cb1ecf3819f19a4fc35468010b66b5c1a7b21ee8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb1ecf3819f19a4fc35468010b66b5c1a7b21ee8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cb1ecf3819f19a4fc35468010b66b5c1a7b21ee8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb1ecf3819f19a4fc35468010b66b5c1a7b21ee8/comments", "author": null, "committer": null, "parents": [{"sha": "6303eee4b92e8509409503a3abebde8bd50f0f05", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6303eee4b92e8509409503a3abebde8bd50f0f05", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6303eee4b92e8509409503a3abebde8bd50f0f05"}], "stats": {"total": 13, "additions": 6, "deletions": 7}, "files": [{"sha": "b468a4b9c0fa16f03bbed1ed1e4d6da04e198627", "filename": "gcc/dwarf2out.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb1ecf3819f19a4fc35468010b66b5c1a7b21ee8/gcc%2Fdwarf2out.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb1ecf3819f19a4fc35468010b66b5c1a7b21ee8/gcc%2Fdwarf2out.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.cc?ref=cb1ecf3819f19a4fc35468010b66b5c1a7b21ee8", "patch": "@@ -12916,7 +12916,7 @@ output_one_line_info_table (dw_line_info_table *table)\n   char line_label[MAX_ARTIFICIAL_LABEL_BYTES];\n   unsigned int current_line = 1;\n   bool current_is_stmt = DWARF_LINE_DEFAULT_IS_STMT_START;\n-  dw_line_info_entry *ent, *prev_addr;\n+  dw_line_info_entry *ent, *prev_addr = NULL;\n   size_t i;\n   unsigned int view;\n "}, {"sha": "870629cd56272f3b30cd97490a292d231148d3ce", "filename": "gcc/gimple.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb1ecf3819f19a4fc35468010b66b5c1a7b21ee8/gcc%2Fgimple.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb1ecf3819f19a4fc35468010b66b5c1a7b21ee8/gcc%2Fgimple.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple.h?ref=cb1ecf3819f19a4fc35468010b66b5c1a7b21ee8", "patch": "@@ -1913,7 +1913,8 @@ static inline void\n gimple_set_location (gimple *g, location_t location)\n {\n   /* Copy the no-warning data to the statement location.  */\n-  copy_warning (location, g->location);\n+  if (g->location != UNKNOWN_LOCATION)\n+    copy_warning (location, g->location);\n   g->location = location;\n }\n "}, {"sha": "a50dd798f2a454ac54e247f3e6cbab17577ea304", "filename": "gcc/optabs.cc", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb1ecf3819f19a4fc35468010b66b5c1a7b21ee8/gcc%2Foptabs.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb1ecf3819f19a4fc35468010b66b5c1a7b21ee8/gcc%2Foptabs.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Foptabs.cc?ref=cb1ecf3819f19a4fc35468010b66b5c1a7b21ee8", "patch": "@@ -264,10 +264,8 @@ expand_widen_pattern_expr (sepops ops, rtx op0, rtx op1, rtx wide_op,\n   bool sbool = false;\n \n   oprnd0 = ops->op0;\n-  if (nops >= 2)\n-    oprnd1 = ops->op1;\n-  if (nops >= 3)\n-    oprnd2 = ops->op2;\n+  oprnd1 = nops >= 2 ? ops->op1 : NULL_TREE;\n+  oprnd2 = nops >= 3 ? ops->op2 : NULL_TREE;\n \n   tmode0 = TYPE_MODE (TREE_TYPE (oprnd0));\n   if (ops->code == VEC_UNPACK_FIX_TRUNC_HI_EXPR"}, {"sha": "7be4e3479ddee20a85af264d329da7b5c8caea60", "filename": "gcc/testsuite/c-c++-common/nonnull-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb1ecf3819f19a4fc35468010b66b5c1a7b21ee8/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fnonnull-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb1ecf3819f19a4fc35468010b66b5c1a7b21ee8/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fnonnull-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fnonnull-1.c?ref=cb1ecf3819f19a4fc35468010b66b5c1a7b21ee8", "patch": "@@ -30,5 +30,5 @@ func (char *cp1, char *cp2, char *cp3, char *cp4)\n __attribute__((nonnull (1))) int\n func2 (char *cp)\n {\n-  return (cp != NULL) ? 1 : 0; /* { dg-warning \"'nonnull' argument\" \"cp compared to NULL\" { xfail c++ } } */\n+  return (cp != NULL) ? 1 : 0; /* { dg-warning \"'nonnull' argument\" \"cp compared to NULL\" } */\n }"}]}