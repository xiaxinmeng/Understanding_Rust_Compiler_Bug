{"sha": "e548ead97f3db1ec58643181f81c3a438da6c554", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTU0OGVhZDk3ZjNkYjFlYzU4NjQzMTgxZjgxYzNhNDM4ZGE2YzU1NA==", "commit": {"author": {"name": "Alan Modra", "email": "amodra@bigpond.net.au", "date": "2004-08-25T03:40:27Z"}, "committer": {"name": "Alan Modra", "email": "amodra@gcc.gnu.org", "date": "2004-08-25T03:40:27Z"}, "message": "re PR target/17052 (altivec varargs failure if no optimization)\n\n\tPR target/17052\n\t* config/rs6000/rs6000.h (machine_function): Remove sysv_varargs_p.\n\t* config/rs6000/sysv4.h (RS6000_VARARGS_AREA): Use\n\tcurrent_function_stdarg in place of sysv_varargs_p.\n\t* config/rs6000/rs6000.c (setup_incoming_varargs): Don't set\n\tsysv_varargs_p.\n\nFrom-SVN: r86533", "tree": {"sha": "53f77fe437614e0149a5ba4fc1539cd189e881ed", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/53f77fe437614e0149a5ba4fc1539cd189e881ed"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e548ead97f3db1ec58643181f81c3a438da6c554", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e548ead97f3db1ec58643181f81c3a438da6c554", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e548ead97f3db1ec58643181f81c3a438da6c554", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e548ead97f3db1ec58643181f81c3a438da6c554/comments", "author": null, "committer": null, "parents": [{"sha": "5352bda03ee91af3e4592d0f62178fae15daab40", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5352bda03ee91af3e4592d0f62178fae15daab40", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5352bda03ee91af3e4592d0f62178fae15daab40"}], "stats": {"total": 16, "additions": 10, "deletions": 6}, "files": [{"sha": "979fb11a284d3907f9221a93db3838493bd0615d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e548ead97f3db1ec58643181f81c3a438da6c554/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e548ead97f3db1ec58643181f81c3a438da6c554/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e548ead97f3db1ec58643181f81c3a438da6c554", "patch": "@@ -1,3 +1,12 @@\n+2004-08-25  Alan Modra  <amodra@bigpond.net.au>\n+\n+\tPR target/17052\n+\t* config/rs6000/rs6000.h (machine_function): Remove sysv_varargs_p.\n+\t* config/rs6000/sysv4.h (RS6000_VARARGS_AREA): Use\n+\tcurrent_function_stdarg in place of sysv_varargs_p.\n+\t* config/rs6000/rs6000.c (setup_incoming_varargs): Don't set\n+\tsysv_varargs_p.\n+\n 2004-08-24  Richard Henderson  <rth@redhat.com>\n \n \tPR target/16298"}, {"sha": "b6175f37af721c93d3d26508c849103b1a2678fc", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e548ead97f3db1ec58643181f81c3a438da6c554/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e548ead97f3db1ec58643181f81c3a438da6c554/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=e548ead97f3db1ec58643181f81c3a438da6c554", "patch": "@@ -5304,8 +5304,6 @@ setup_incoming_varargs (CUMULATIVE_ARGS *cum, enum machine_mode mode,\n \n   if (DEFAULT_ABI == ABI_V4)\n     {\n-      /* Indicate to allocate space on the stack for varargs save area.  */\n-      cfun->machine->sysv_varargs_p = 1;\n       if (! no_rtl)\n \tsave_area = plus_constant (virtual_stack_vars_rtx,\n \t\t\t\t   - RS6000_VARARGS_SIZE);\n@@ -5316,7 +5314,6 @@ setup_incoming_varargs (CUMULATIVE_ARGS *cum, enum machine_mode mode,\n     {\n       first_reg_offset = next_cum.words;\n       save_area = virtual_incoming_args_rtx;\n-      cfun->machine->sysv_varargs_p = 0;\n \n       if (targetm.calls.must_pass_in_stack (mode, type))\n \tfirst_reg_offset += rs6000_arg_size (TYPE_MODE (type), type);"}, {"sha": "f1bf91b5eb019406d11b22a5ae79dc4c6822d9f1", "filename": "gcc/config/rs6000/rs6000.h", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e548ead97f3db1ec58643181f81c3a438da6c554/gcc%2Fconfig%2Frs6000%2Frs6000.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e548ead97f3db1ec58643181f81c3a438da6c554/gcc%2Fconfig%2Frs6000%2Frs6000.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.h?ref=e548ead97f3db1ec58643181f81c3a438da6c554", "patch": "@@ -1639,8 +1639,6 @@ extern enum rs6000_abi rs6000_current_abi;\t/* available for use by subtarget */\n    This is added to the cfun structure.  */\n typedef struct machine_function GTY(())\n {\n-  /* Whether a System V.4 varargs area was created.  */\n-  int sysv_varargs_p;\n   /* Flags if __builtin_return_address (n) with n >= 1 was used.  */\n   int ra_needs_full_frame;\n   /* Some local-dynamic symbol.  */"}, {"sha": "f3f722d6db8d615c663bb62b63f5f98b7f971805", "filename": "gcc/config/rs6000/sysv4.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e548ead97f3db1ec58643181f81c3a438da6c554/gcc%2Fconfig%2Frs6000%2Fsysv4.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e548ead97f3db1ec58643181f81c3a438da6c554/gcc%2Fconfig%2Frs6000%2Fsysv4.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fsysv4.h?ref=e548ead97f3db1ec58643181f81c3a438da6c554", "patch": "@@ -332,7 +332,7 @@ do {\t\t\t\t\t\t\t\t\t\\\n /* Size of the V.4 varargs area if needed.  */\n /* Override rs6000.h definition.  */\n #undef\tRS6000_VARARGS_AREA\n-#define RS6000_VARARGS_AREA ((cfun->machine->sysv_varargs_p) ? RS6000_VARARGS_SIZE : 0)\n+#define RS6000_VARARGS_AREA (current_function_stdarg ? RS6000_VARARGS_SIZE : 0)\n \n /* Override default big endianism definitions in rs6000.h.  */\n #undef\tBYTES_BIG_ENDIAN"}]}