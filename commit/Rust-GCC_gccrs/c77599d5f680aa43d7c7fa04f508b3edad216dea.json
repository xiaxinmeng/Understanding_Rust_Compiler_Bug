{"sha": "c77599d5f680aa43d7c7fa04f508b3edad216dea", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzc3NTk5ZDVmNjgwYWE0M2Q3YzdmYTA0ZjUwOGIzZWRhZDIxNmRlYQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-06-17T13:03:27Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-06-17T13:03:27Z"}, "message": "[multiple changes]\n\n2010-06-17  Ed Schonberg  <schonberg@adacore.com>\n\n\t* exp_ch4.adb: expand NOT for VMS types.\n\t* sem_util.adb: Use OpenVMS_On_Target for IS_VMS_Operator.\n\n2010-06-17  Sergey Rybin  <rybin@adacore.com>\n\n\t* vms_data.ads: Add qualifier for '--no-elim-dispatch' gnatelim option.\n\t* gnat_ugn.texi (gnatelim): add description for --no-elim-dispatch\n\toption.\n\nFrom-SVN: r160908", "tree": {"sha": "1da6c077e39154f1d139d9206c15e3c0d7e2f6be", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1da6c077e39154f1d139d9206c15e3c0d7e2f6be"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c77599d5f680aa43d7c7fa04f508b3edad216dea", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c77599d5f680aa43d7c7fa04f508b3edad216dea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c77599d5f680aa43d7c7fa04f508b3edad216dea", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c77599d5f680aa43d7c7fa04f508b3edad216dea/comments", "author": null, "committer": null, "parents": [{"sha": "6f76a2575b040ada4b58e1aea71ce609bffa5c06", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f76a2575b040ada4b58e1aea71ce609bffa5c06", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6f76a2575b040ada4b58e1aea71ce609bffa5c06"}], "stats": {"total": 45, "additions": 43, "deletions": 2}, "files": [{"sha": "17fba32dd9e3fd6c849ed9b21b385b642c81bef6", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c77599d5f680aa43d7c7fa04f508b3edad216dea/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c77599d5f680aa43d7c7fa04f508b3edad216dea/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=c77599d5f680aa43d7c7fa04f508b3edad216dea", "patch": "@@ -1,3 +1,14 @@\n+2010-06-17  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* exp_ch4.adb: expand NOT for VMS types.\n+\t* sem_util.adb: Use OpenVMS_On_Target for IS_VMS_Operator.\n+\n+2010-06-17  Sergey Rybin  <rybin@adacore.com>\n+\n+\t* vms_data.ads: Add qualifier for '--no-elim-dispatch' gnatelim option.\n+\t* gnat_ugn.texi (gnatelim): add description for --no-elim-dispatch\n+\toption.\n+\n 2010-06-17  Ed Schonberg  <schonberg@adacore.com>\n \n \t* exp_ch6.adb (Expand_Call): Do not expand a call to an internal"}, {"sha": "5174be4c7f035d1a98165e530416a3cea5b860c3", "filename": "gcc/ada/exp_ch4.adb", "status": "modified", "additions": 18, "deletions": 1, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c77599d5f680aa43d7c7fa04f508b3edad216dea/gcc%2Fada%2Fexp_ch4.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c77599d5f680aa43d7c7fa04f508b3edad216dea/gcc%2Fada%2Fexp_ch4.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch4.adb?ref=c77599d5f680aa43d7c7fa04f508b3edad216dea", "patch": "@@ -6631,7 +6631,7 @@ package body Exp_Ch4 is\n    ---------------------\n \n    --  If the argument is other than a Boolean array type, there is no special\n-   --  expansion required.\n+   --  expansion required, except for VMS operations on signed integers.\n \n    --  For the packed case, we call the special routine in Exp_Pakd, except\n    --  that if the component size is greater than one, we use the standard\n@@ -6681,6 +6681,23 @@ package body Exp_Ch4 is\n          return;\n       end if;\n \n+      --  For the VMS \"not\" on signed integer types, use conversion to and\n+      --  from a predefined modular type.\n+\n+      if Is_VMS_Operator (Entity (N)) then\n+         declare\n+            LI : constant Entity_Id := RTE (RE_Unsigned_64);\n+\n+         begin\n+            Rewrite (N,\n+              Unchecked_Convert_To (Typ,\n+                (Make_Op_Not (Loc,\n+                  Right_Opnd => Unchecked_Convert_To (LI, Right_Opnd (N))))));\n+            Analyze_And_Resolve (N, Typ);\n+            return;\n+         end;\n+      end if;\n+\n       --  Only array types need any other processing\n \n       if not Is_Array_Type (Typ) then"}, {"sha": "c36b283bfd7a57a32ae6eac8899150d932914cca", "filename": "gcc/ada/gnat_ugn.texi", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c77599d5f680aa43d7c7fa04f508b3edad216dea/gcc%2Fada%2Fgnat_ugn.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c77599d5f680aa43d7c7fa04f508b3edad216dea/gcc%2Fada%2Fgnat_ugn.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_ugn.texi?ref=c77599d5f680aa43d7c7fa04f508b3edad216dea", "patch": "@@ -10727,6 +10727,10 @@ is named @file{gnatelim.log} and is located in the current directory.\n @cindex @option{^-log^/LOGFILE^} (@command{gnatelim})\n Duplicate all the output sent to @file{stderr} into a specified log file.\n \n+@cindex @option{^--no-elim-dispatch^/NO_DISPATCH^} (@command{gnatelim})\n+@item ^--no-elim-dispatch^/NO_DISPATCH^\n+Do not generate pragmas for dispatching operations.\n+\n @cindex @option{^-o^/OUTPUT^} (@command{gnatelim})\n @item ^-o^/OUTPUT^=@var{report_file}\n Put @command{gnatelim} output into a specified file. If this file already exists,"}, {"sha": "a47e739aeb4ad292819c87b5a7bb15d807f19217", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c77599d5f680aa43d7c7fa04f508b3edad216dea/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c77599d5f680aa43d7c7fa04f508b3edad216dea/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=c77599d5f680aa43d7c7fa04f508b3edad216dea", "patch": "@@ -7034,7 +7034,8 @@ package body Sem_Util is\n    begin\n       return Ekind (Op) = E_Function\n         and then Is_Intrinsic_Subprogram (Op)\n-        and then Scope (Op) = System_Aux_Id;\n+        and then Chars (Scope (Scope (Op))) = Name_System\n+        and then OpenVMS_On_Target;\n    end Is_VMS_Operator;\n \n    -----------------"}, {"sha": "9d1443ea6417680e9c43782ea71899af41783e9f", "filename": "gcc/ada/vms_data.ads", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c77599d5f680aa43d7c7fa04f508b3edad216dea/gcc%2Fada%2Fvms_data.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c77599d5f680aa43d7c7fa04f508b3edad216dea/gcc%2Fada%2Fvms_data.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fvms_data.ads?ref=c77599d5f680aa43d7c7fa04f508b3edad216dea", "patch": "@@ -3597,6 +3597,13 @@ package VMS_Data is\n    --      HIGH         A great number of messages are output, most of them not\n    --                   being useful for the user.\n \n+   S_Elim_Nodisp : aliased constant S := \"/NO_DISPATCH \"                   &\n+                                          \"--no-elim-dispatch\";\n+   --        /NONO_DISPATCH (D)\n+   --        /NO_DISPATCH\n+   --\n+   --   Do not generate pragmas for dispatching operations.\n+\n    S_Elim_Project : aliased constant S := \"/PROJECT_FILE=<\"                &\n                                              \"-P>\";\n    --        /PROJECT_FILE=filename\n@@ -3709,6 +3716,7 @@ package VMS_Data is\n                       S_Elim_Logfile 'Access,\n                       S_Elim_Main    'Access,\n                       S_Elim_Mess    'Access,\n+                      S_Elim_Nodisp  'Access,\n                       S_Elim_Out     'Access,\n                       S_Elim_Project 'Access,\n                       S_Elim_Quiet   'Access,"}]}