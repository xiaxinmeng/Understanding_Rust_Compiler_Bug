{"sha": "456b8ce5dbc2f77b3506d18c7eaec25cf76cb573", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDU2YjhjZTVkYmMyZjc3YjM1MDZkMThjN2VhZWMyNWNmNzZjYjU3Mw==", "commit": {"author": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2005-11-09T06:30:03Z"}, "committer": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2005-11-09T06:30:03Z"}, "message": "re PR c/24101 (Segfault with preprocessed source)\n\nlibcpp/\n\n\tPR c/24101\n\t* init.c (read_original_filename): Temporarily set\n\tstate.in_directive before calling _cpp_lex_direct for\n\tCPP_HASH tokens.\n\ngcc/\n\n\tPR c/24101\n\t* toplev.c (process_options): Initialize debug_hooks early\n\tin case lang_hooks.post_options ends up calling a debug_hook.\n\ngcc/testsuite/\n\n\tPR c/24101\n\t* gcc.dg/pr24101-1.i, gcc.dg/pr24101-2.i: New tests.\n\t* gcc.dg/dg.exp: Run main loop also for *.i files.\n\nFrom-SVN: r106677", "tree": {"sha": "b078bd18fbfd08b7038db568253cd7312a08964d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b078bd18fbfd08b7038db568253cd7312a08964d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573", "html_url": "https://github.com/Rust-GCC/gccrs/commit/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573/comments", "author": null, "committer": null, "parents": [{"sha": "85e77c2176355b95565534e4bee77eb5672ccfe9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85e77c2176355b95565534e4bee77eb5672ccfe9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/85e77c2176355b95565534e4bee77eb5672ccfe9"}], "stats": {"total": 38, "additions": 36, "deletions": 2}, "files": [{"sha": "c9836318d76e7c15cf554c9824987561681a27b9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=456b8ce5dbc2f77b3506d18c7eaec25cf76cb573", "patch": "@@ -1,3 +1,10 @@\n+2005-11-09  Per Bothner  <per@bothner.com>\n+\t    Uros Bizjak  <uros@kss-loka.si>\n+\t\n+\tPR c/24101\n+\t* toplev.c (process_options): Initialize debug_hooks early\n+\tin case lang_hooks.post_options ends up calling a debug_hook.\n+\n 2005-11-08  Jakub Jelinek  <jakub@redhat.com>\n \n \t* dwarf2out.c (multiple_reg_loc_descriptor): Don't assume"}, {"sha": "d0bd89e28e8c1c3db0c2db3c466e920fb2d0b152", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=456b8ce5dbc2f77b3506d18c7eaec25cf76cb573", "patch": "@@ -1,3 +1,9 @@\n+2005-11-09  Uros Bizjak  <uros@kss-loka.si>\n+\n+\tPR c/24101\n+\t* gcc.dg/pr24101-1.i, gcc.dg/pr24101-2.i: New tests.\n+\t* gcc.dg/dg.exp: Run main loop also for *.i files.\n+\n 2005-11-08  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/19450"}, {"sha": "826bcf3f3a5e36e25ecf1194b752b346b10abbca", "filename": "gcc/testsuite/gcc.dg/dg.exp", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573/gcc%2Ftestsuite%2Fgcc.dg%2Fdg.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573/gcc%2Ftestsuite%2Fgcc.dg%2Fdg.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fdg.exp?ref=456b8ce5dbc2f77b3506d18c7eaec25cf76cb573", "patch": "@@ -29,7 +29,7 @@ if ![info exists DEFAULT_CFLAGS] then {\n dg-init\n \n # Main loop.\n-dg-runtest [lsort [glob -nocomplain $srcdir/$subdir/*.\\[cS\\]]] \\\n+dg-runtest [lsort [glob -nocomplain $srcdir/$subdir/*.\\[cSi\\]]] \\\n \t\"\" $DEFAULT_CFLAGS\n \n # All done."}, {"sha": "45c165539b61a12124b1271cbcc558475e213b23", "filename": "gcc/testsuite/gcc.dg/pr24101-1.i", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573/gcc%2Ftestsuite%2Fgcc.dg%2Fpr24101-1.i", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573/gcc%2Ftestsuite%2Fgcc.dg%2Fpr24101-1.i", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr24101-1.i?ref=456b8ce5dbc2f77b3506d18c7eaec25cf76cb573", "patch": "@@ -0,0 +1,4 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-ansi\" } */\n+\n+# 1 \"/usr/local/lib/gcc/i686-pc-linux-gnu/4.1.0/include/stddef.h\" 1 3 4"}, {"sha": "501382da4b680628f67e394b3b7d6f6845a3eee6", "filename": "gcc/testsuite/gcc.dg/pr24101-2.i", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573/gcc%2Ftestsuite%2Fgcc.dg%2Fpr24101-2.i", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573/gcc%2Ftestsuite%2Fgcc.dg%2Fpr24101-2.i", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr24101-2.i?ref=456b8ce5dbc2f77b3506d18c7eaec25cf76cb573", "patch": "@@ -0,0 +1,4 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-ansi\" } */\n+\n+#"}, {"sha": "b03e91dc99948bfd4278d113ebf372ad258f4292", "filename": "gcc/toplev.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573/gcc%2Ftoplev.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573/gcc%2Ftoplev.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftoplev.c?ref=456b8ce5dbc2f77b3506d18c7eaec25cf76cb573", "patch": "@@ -1493,6 +1493,10 @@ general_init (const char *argv0)\n static void\n process_options (void)\n {\n+  /* Just in case lang_hooks.post_options ends up calling a debug_hook.\n+     This can happen with incorrect pre-processed input. */\n+  debug_hooks = &do_nothing_debug_hooks;\n+\n   /* Allow the front end to perform consistency checks and do further\n      initialization based on the command line options.  This hook also\n      sets the original filename if appropriate (e.g. foo.i -> foo.c)\n@@ -1652,7 +1656,6 @@ process_options (void)\n     default_debug_hooks = &vmsdbg_debug_hooks;\n #endif\n \n-  debug_hooks = &do_nothing_debug_hooks;\n   if (write_symbols == NO_DEBUG)\n     ;\n #if defined(DBX_DEBUGGING_INFO)"}, {"sha": "747e45adc72ee538154d042786ef4638af1649ba", "filename": "libcpp/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573/libcpp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573/libcpp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2FChangeLog?ref=456b8ce5dbc2f77b3506d18c7eaec25cf76cb573", "patch": "@@ -1,3 +1,11 @@\n+2005-11-09  Per Bothner  <per@bothner.com>\n+\t    Uros Bizjak  <uros@kss-loka.si>\n+\t\n+\tPR c/24101\n+\t* init.c (read_original_filename): Temporarily set\n+\tstate.in_directive before calling _cpp_lex_direct for\n+\tCPP_HASH tokens.\n+\n 2005-11-03  James E Wilson  <wilson@specifix.com>\n \n \tPR preprocessor/24202"}, {"sha": "bbf2705b46c4cca516609b979ec34fb1cfca4fd8", "filename": "libcpp/init.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573/libcpp%2Finit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/456b8ce5dbc2f77b3506d18c7eaec25cf76cb573/libcpp%2Finit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Finit.c?ref=456b8ce5dbc2f77b3506d18c7eaec25cf76cb573", "patch": "@@ -497,8 +497,10 @@ read_original_filename (cpp_reader *pfile)\n   token = _cpp_lex_direct (pfile);\n   if (token->type == CPP_HASH)\n     {\n+      pfile->state.in_directive = 1;\n       token1 = _cpp_lex_direct (pfile);\n       _cpp_backup_tokens (pfile, 1);\n+      pfile->state.in_directive = 0;\n \n       /* If it's a #line directive, handle it.  */\n       if (token1->type == CPP_NUMBER)"}]}