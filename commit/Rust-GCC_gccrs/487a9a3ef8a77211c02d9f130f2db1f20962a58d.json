{"sha": "487a9a3ef8a77211c02d9f130f2db1f20962a58d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDg3YTlhM2VmOGE3NzIxMWMwMmQ5ZjEzMGYyZGIxZjIwOTYyYTU4ZA==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2010-10-23T16:42:24Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2010-10-23T16:42:24Z"}, "message": "re PR target/46144 (gfortran.dg/vect/fast-math-vect-8.f90)\n\nPR target/46144\n* config/i386/sse.md (*avx_absneg<AVXMODEF2P>2): New.\n(*sse_absneg<SSEMODEF2P>2): Rename from *absneg<VEC_FLOAT_MODE>2.\nHonor matching operands when splitting to XOR.\n\nFrom-SVN: r165885", "tree": {"sha": "865be7655f55d604099febaa3502c37da71b1475", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/865be7655f55d604099febaa3502c37da71b1475"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/487a9a3ef8a77211c02d9f130f2db1f20962a58d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/487a9a3ef8a77211c02d9f130f2db1f20962a58d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/487a9a3ef8a77211c02d9f130f2db1f20962a58d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/487a9a3ef8a77211c02d9f130f2db1f20962a58d/comments", "author": null, "committer": null, "parents": [{"sha": "0e1b8b109fb5a19dc3576a14416383299566ff00", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0e1b8b109fb5a19dc3576a14416383299566ff00", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0e1b8b109fb5a19dc3576a14416383299566ff00"}], "stats": {"total": 52, "additions": 42, "deletions": 10}, "files": [{"sha": "bae819764bfdecf47abe8321e3c2edf885b3716e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/487a9a3ef8a77211c02d9f130f2db1f20962a58d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/487a9a3ef8a77211c02d9f130f2db1f20962a58d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=487a9a3ef8a77211c02d9f130f2db1f20962a58d", "patch": "@@ -1,3 +1,10 @@\n+2010-10-23  Richard Henderson  <rth@redhat.com>\n+\n+\tPR target/46144\n+\t* config/i386/sse.md (*avx_absneg<AVXMODEF2P>2): New.\n+\t(*sse_absneg<SSEMODEF2P>2): Rename from *absneg<VEC_FLOAT_MODE>2.\n+\tHonor matching operands when splitting to XOR.\n+\n 2010-10-23  Ian Lance Taylor  <iant@google.com>\n \n \t* tree-vrp.c (extract_range_from_binary_expr): If"}, {"sha": "ffddf1868e4038907973abcbc266cebf2b5c2ec2", "filename": "gcc/config/i386/sse.md", "status": "modified", "additions": 35, "deletions": 10, "changes": 45, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/487a9a3ef8a77211c02d9f130f2db1f20962a58d/gcc%2Fconfig%2Fi386%2Fsse.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/487a9a3ef8a77211c02d9f130f2db1f20962a58d/gcc%2Fconfig%2Fi386%2Fsse.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fsse.md?ref=487a9a3ef8a77211c02d9f130f2db1f20962a58d", "patch": "@@ -585,21 +585,46 @@\n   \"\"\n   \"ix86_expand_fp_absneg_operator (<CODE>, <MODE>mode, operands); DONE;\")\n \n-(define_insn_and_split \"*absneg<mode>2\"\n-  [(set (match_operand:VEC_FLOAT_MODE 0 \"register_operand\" \"=x,x\")\n-\t(match_operator:VEC_FLOAT_MODE 3 \"absneg_operator\"\n-\t  [(match_operand:VEC_FLOAT_MODE 1 \"nonimmediate_operand\" \"0,xm\")]))\n-   (use (match_operand:VEC_FLOAT_MODE 2 \"nonimmediate_operand\" \"xm,0\"))]\n-  \"SSE_VEC_FLOAT_MODE_P (<MODE>mode) || AVX256_VEC_FLOAT_MODE_P (<MODE>mode)\"\n+(define_insn_and_split \"*avx_absneg<mode>2\"\n+  [(set (match_operand:AVXMODEF2P 0 \"register_operand\" \"=x,x\")\n+\t(match_operator:AVXMODEF2P 3 \"absneg_operator\"\n+\t  [(match_operand:AVXMODEF2P 1 \"nonimmediate_operand\" \"x,m\")]))\n+   (use (match_operand:AVXMODEF2P 2 \"nonimmediate_operand\" \"xm,x\"))]\n+  \"AVX_VEC_FLOAT_MODE_P (<MODE>mode)\"\n   \"#\"\n   \"&& reload_completed\"\n   [(const_int 0)]\n {\n-  rtx set;\n-  set = gen_rtx_fmt_ee (GET_CODE (operands[3]) == NEG ? XOR : AND,\n+  rtx t;\n+\n+  if (MEM_P (operands[1]))\n+    t = gen_rtx_fmt_ee (GET_CODE (operands[3]) == NEG ? XOR : AND,\n+\t\t\t<MODE>mode, operands[2], operands[1]);\n+  else\n+    t = gen_rtx_fmt_ee (GET_CODE (operands[3]) == NEG ? XOR : AND,\n \t\t\t<MODE>mode, operands[1], operands[2]);\n-  set = gen_rtx_SET (VOIDmode, operands[0], set);\n-  emit_insn (set);\n+  t = gen_rtx_SET (VOIDmode, operands[0], t);\n+  emit_insn (t);\n+  DONE;\n+})\n+\n+(define_insn_and_split \"*sse_absneg<mode>2\"\n+  [(set (match_operand:SSEMODEF2P 0 \"register_operand\" \"=x,x\")\n+\t(match_operator:SSEMODEF2P 3 \"absneg_operator\"\n+\t  [(match_operand:SSEMODEF2P 1 \"nonimmediate_operand\" \"0,xm\")]))\n+   (use (match_operand:SSEMODEF2P 2 \"nonimmediate_operand\" \"xm,0\"))]\n+  \"SSE_VEC_FLOAT_MODE_P (<MODE>mode)\"\n+  \"#\"\n+  \"&& reload_completed\"\n+  [(const_int 0)]\n+{\n+  rtx t;\n+\n+  t = operands[rtx_equal_p (operands[0], operands[1]) ? 2 : 1];\n+  t = gen_rtx_fmt_ee (GET_CODE (operands[3]) == NEG ? XOR : AND,\n+\t\t      <MODE>mode, operands[0], t);\n+  t = gen_rtx_SET (VOIDmode, operands[0], t);\n+  emit_insn (t);\n   DONE;\n })\n "}]}