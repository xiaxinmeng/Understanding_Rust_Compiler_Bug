{"sha": "bdb55eae5e08c10636c8882140b06eeee7921209", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmRiNTVlYWU1ZTA4YzEwNjM2Yzg4ODIxNDBiMDZlZWVlNzkyMTIwOQ==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2008-01-16T21:51:57Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2008-01-16T21:51:57Z"}, "message": "re PR middle-end/32628 (bogus integer overflow warning)\n\n2008-01-16  Richard Guenther  <rguenther@suse.de>\n\n\tPR middle-end/32628\n\t* fold-const.c (fold_convert_const_int_from_int): Do not\n\tset overflow if that occured only because of a sign extension\n\tchange when converting from/to a sizetype with the same\n\tprecision and signedness.\n\n\t* gcc.dg/overflow-warn-7.c: New testcase.\n\nFrom-SVN: r131579", "tree": {"sha": "31643f94d1c330d6b0c18e681ad5beb86cc4a269", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/31643f94d1c330d6b0c18e681ad5beb86cc4a269"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bdb55eae5e08c10636c8882140b06eeee7921209", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bdb55eae5e08c10636c8882140b06eeee7921209", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bdb55eae5e08c10636c8882140b06eeee7921209", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bdb55eae5e08c10636c8882140b06eeee7921209/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2e2c7ce23798d0ffd6e1302e1594cf0de8b0bbe7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e2c7ce23798d0ffd6e1302e1594cf0de8b0bbe7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2e2c7ce23798d0ffd6e1302e1594cf0de8b0bbe7"}], "stats": {"total": 39, "additions": 37, "deletions": 2}, "files": [{"sha": "0aa13b5c526f22f80aa9f27c0b9a144a4c126ad4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdb55eae5e08c10636c8882140b06eeee7921209/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdb55eae5e08c10636c8882140b06eeee7921209/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bdb55eae5e08c10636c8882140b06eeee7921209", "patch": "@@ -1,3 +1,11 @@\n+2008-01-16  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR middle-end/32628\n+\t* fold-const.c (fold_convert_const_int_from_int): Do not\n+\tset overflow if that occured only because of a sign extension\n+\tchange when converting from/to a sizetype with the same\n+\tprecision and signedness.\n+\n 2008-01-16  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR debug/34249"}, {"sha": "ea0b43e942d27ea455cd52e017a45a7b593db034", "filename": "gcc/fold-const.c", "status": "modified", "additions": 16, "deletions": 2, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdb55eae5e08c10636c8882140b06eeee7921209/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdb55eae5e08c10636c8882140b06eeee7921209/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=bdb55eae5e08c10636c8882140b06eeee7921209", "patch": "@@ -2122,8 +2122,22 @@ fold_convert_const_int_from_int (tree type, const_tree arg1)\n   t = force_fit_type_double (type, TREE_INT_CST_LOW (arg1),\n \t\t\t     TREE_INT_CST_HIGH (arg1),\n \t\t             /* Don't set the overflow when\n-\t\t      \t\tconverting a pointer  */\n-\t\t\t     !POINTER_TYPE_P (TREE_TYPE (arg1)),\n+\t\t      \t\tconverting from a pointer,  */\n+\t\t\t     !POINTER_TYPE_P (TREE_TYPE (arg1))\n+\t\t\t     /* or to a sizetype with same signedness\n+\t\t\t\tand the precision is unchanged.\n+\t\t\t\t???  sizetype is always sign-extended,\n+\t\t\t\tbut its signedness depends on the\n+\t\t\t\tfrontend.  Thus we see spurious overflows\n+\t\t\t\there if we do not check this.  */\n+\t\t\t     && !((TYPE_PRECISION (TREE_TYPE (arg1))\n+\t\t\t\t   == TYPE_PRECISION (type))\n+\t\t\t\t  && (TYPE_UNSIGNED (TREE_TYPE (arg1))\n+\t\t\t\t      == TYPE_UNSIGNED (type))\n+\t\t\t\t  && ((TREE_CODE (TREE_TYPE (arg1)) == INTEGER_TYPE\n+\t\t\t\t       && TYPE_IS_SIZETYPE (TREE_TYPE (arg1)))\n+\t\t\t\t      || (TREE_CODE (type) == INTEGER_TYPE\n+\t\t\t\t\t  && TYPE_IS_SIZETYPE (type)))),\n \t\t\t     (TREE_INT_CST_HIGH (arg1) < 0\n \t\t \t      && (TYPE_UNSIGNED (type)\n \t\t\t\t  < TYPE_UNSIGNED (TREE_TYPE (arg1))))"}, {"sha": "155e98eb1c737cb967eac8bcd0c618efc846310c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdb55eae5e08c10636c8882140b06eeee7921209/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdb55eae5e08c10636c8882140b06eeee7921209/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bdb55eae5e08c10636c8882140b06eeee7921209", "patch": "@@ -1,3 +1,8 @@\n+2008-01-16  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR middle-end/32628\n+\t* gcc.dg/overflow-warn-7.c: New testcase.\n+\n 2008-01-16  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* gcc.dg/tree-ssa/loop-19.c: Require nonpic."}, {"sha": "7c0ce68df50864187e0fbcecf10a60c42d3595a3", "filename": "gcc/testsuite/gcc.dg/overflow-warn-7.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdb55eae5e08c10636c8882140b06eeee7921209/gcc%2Ftestsuite%2Fgcc.dg%2Foverflow-warn-7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdb55eae5e08c10636c8882140b06eeee7921209/gcc%2Ftestsuite%2Fgcc.dg%2Foverflow-warn-7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Foverflow-warn-7.c?ref=bdb55eae5e08c10636c8882140b06eeee7921209", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-Wall\" } */\n+\n+int f(char *device)\n+{\n+  return device == ((char *)0 + ~0UL);  /* { dg-bogus \"overflow\" } */\n+}\n+"}]}