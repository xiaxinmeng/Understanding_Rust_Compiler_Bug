{"sha": "0cd020ae59e1131b8d7e23424c319c493745f0f8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGNkMDIwYWU1OWUxMTMxYjhkN2UyMzQyNGMzMTljNDkzNzQ1ZjBmOA==", "commit": {"author": {"name": "Prathamesh Kulkarni", "email": "prathamesh.kulkarni@linaro.org", "date": "2018-08-15T15:52:22Z"}, "committer": {"name": "Prathamesh Kulkarni", "email": "prathamesh3492@gcc.gnu.org", "date": "2018-08-15T15:52:22Z"}, "message": "c-decl.c (start_decl): Do not warn if variables is named as main and is a local variable.\n\n2018-08-15  Prathamesh Kulkarni  <prathamesh.kulkarni@linaro.org>\n\nc/\n\t* c-decl.c (start_decl): Do not warn if variables is named as main\n\tand is a local variable.\n\ntestsuite/\n\t* gcc.dg/wmain.c: New test.\n\nFrom-SVN: r263562", "tree": {"sha": "f9611140f858ee59be030aa1f78bfa2bc7d63d19", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f9611140f858ee59be030aa1f78bfa2bc7d63d19"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0cd020ae59e1131b8d7e23424c319c493745f0f8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0cd020ae59e1131b8d7e23424c319c493745f0f8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0cd020ae59e1131b8d7e23424c319c493745f0f8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0cd020ae59e1131b8d7e23424c319c493745f0f8/comments", "author": null, "committer": null, "parents": [{"sha": "bcee52c4b7ab4a47bb4c2426daa10f5b37968ac7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bcee52c4b7ab4a47bb4c2426daa10f5b37968ac7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bcee52c4b7ab4a47bb4c2426daa10f5b37968ac7"}], "stats": {"total": 22, "additions": 21, "deletions": 1}, "files": [{"sha": "be714d28b4d4efd5d2a33d0c631e14e3698586c3", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0cd020ae59e1131b8d7e23424c319c493745f0f8/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0cd020ae59e1131b8d7e23424c319c493745f0f8/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=0cd020ae59e1131b8d7e23424c319c493745f0f8", "patch": "@@ -1,3 +1,8 @@\n+2018-08-15  Prathamesh Kulkarni  <prathamesh.kulkarni@linaro.org>\n+\t\n+\t* c-decl.c (start_decl): Do not warn if variables is named as main\n+\tand is a local variable.\n+\n 2018-08-15  Iain Sandoe  <iain@sandoe.co.uk>\n \n \tPR c/19315"}, {"sha": "1bbccddab31de598516ecacb3f43370951a408d0", "filename": "gcc/c/c-decl.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0cd020ae59e1131b8d7e23424c319c493745f0f8/gcc%2Fc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0cd020ae59e1131b8d7e23424c319c493745f0f8/gcc%2Fc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-decl.c?ref=0cd020ae59e1131b8d7e23424c319c493745f0f8", "patch": "@@ -4700,7 +4700,8 @@ start_decl (struct c_declarator *declarator, struct c_declspecs *declspecs,\n   if (expr)\n     add_stmt (fold_convert (void_type_node, expr));\n \n-  if (TREE_CODE (decl) != FUNCTION_DECL && MAIN_NAME_P (DECL_NAME (decl)))\n+  if (TREE_CODE (decl) != FUNCTION_DECL && MAIN_NAME_P (DECL_NAME (decl))\n+      && TREE_PUBLIC (decl))\n     warning (OPT_Wmain, \"%q+D is usually a function\", decl);\n \n   if (initialized)"}, {"sha": "0bcf92fe7d2eff0dc7b6bc5987b101e7f2324a0b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0cd020ae59e1131b8d7e23424c319c493745f0f8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0cd020ae59e1131b8d7e23424c319c493745f0f8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0cd020ae59e1131b8d7e23424c319c493745f0f8", "patch": "@@ -1,3 +1,7 @@\n+2018-08-15  Prathamesh Kulkarni  <prathamesh.kulkarni@linaro.org>\n+\n+\t* gcc.dg/wmain.c: New test.\n+\n 2018-08-15  Iain Sandoe  <iain@sandoe.co.uk>\n \n \tPR c/19315"}, {"sha": "06fc26fd398127f594afd5000f5f2bbb82402c23", "filename": "gcc/testsuite/gcc.dg/wmain.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0cd020ae59e1131b8d7e23424c319c493745f0f8/gcc%2Ftestsuite%2Fgcc.dg%2Fwmain.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0cd020ae59e1131b8d7e23424c319c493745f0f8/gcc%2Ftestsuite%2Fgcc.dg%2Fwmain.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fwmain.c?ref=0cd020ae59e1131b8d7e23424c319c493745f0f8", "patch": "@@ -0,0 +1,10 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-Wall\" } */\n+\n+int main; /* { dg-warning \"'main' is usually a function\" } */\n+\n+int foo()\n+{\n+  int main = 1; /* { dg-bogus \"'main' is usually a function\" } */\n+  return main;\n+}"}]}