{"sha": "2a523cfe4e6304f18117266d34f4ae2603274577", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmE1MjNjZmU0ZTYzMDRmMTgxMTcyNjZkMzRmNGFlMjYwMzI3NDU3Nw==", "commit": {"author": {"name": "Joel Brobecker", "email": "brobecker@adacore.com", "date": "2014-10-14T17:57:08Z"}, "committer": {"name": "Joel Brobecker", "email": "brobecke@gcc.gnu.org", "date": "2014-10-14T17:57:08Z"}, "message": "Use strtod instead of strtold in libiberty/d-demangle.c\n\nstrtold is currently used to decode templates which have a floating-point\nvalue encoded inside; but this routine is not available on some systems,\nsuch as Solaris 2.9 for instance.\n\nThis patch fixes the issue by replace the use of strtold by strtod.\nIt reduces a bit the precision, but it should still remain acceptable\nin most cases.\n\nlibiberty/ChangeLog:\n\n        * d-demangle.c: Replace strtold with strtod in global comment.\n        (strtold): Remove declaration.\n        (strtod): New declaration.\n        (dlang_parse_real): Declare value as double instead of long\n        double.  Replace call to strtold by call to strtod.\n        Update format in call to snprintf.\n\nFrom-SVN: r216216", "tree": {"sha": "fa07e611157bd534c668860de85bd30c4a8b2096", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fa07e611157bd534c668860de85bd30c4a8b2096"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2a523cfe4e6304f18117266d34f4ae2603274577", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a523cfe4e6304f18117266d34f4ae2603274577", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2a523cfe4e6304f18117266d34f4ae2603274577", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a523cfe4e6304f18117266d34f4ae2603274577/comments", "author": {"login": "brobecke", "id": 11981700, "node_id": "MDQ6VXNlcjExOTgxNzAw", "avatar_url": "https://avatars.githubusercontent.com/u/11981700?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brobecke", "html_url": "https://github.com/brobecke", "followers_url": "https://api.github.com/users/brobecke/followers", "following_url": "https://api.github.com/users/brobecke/following{/other_user}", "gists_url": "https://api.github.com/users/brobecke/gists{/gist_id}", "starred_url": "https://api.github.com/users/brobecke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brobecke/subscriptions", "organizations_url": "https://api.github.com/users/brobecke/orgs", "repos_url": "https://api.github.com/users/brobecke/repos", "events_url": "https://api.github.com/users/brobecke/events{/privacy}", "received_events_url": "https://api.github.com/users/brobecke/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "957079189766793e0f6f82dfe74edc477f619bc2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/957079189766793e0f6f82dfe74edc477f619bc2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/957079189766793e0f6f82dfe74edc477f619bc2"}], "stats": {"total": 19, "additions": 14, "deletions": 5}, "files": [{"sha": "5211664c242e75fa5b8313d5b1de8c42bc512bc7", "filename": "libiberty/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a523cfe4e6304f18117266d34f4ae2603274577/libiberty%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a523cfe4e6304f18117266d34f4ae2603274577/libiberty%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2FChangeLog?ref=2a523cfe4e6304f18117266d34f4ae2603274577", "patch": "@@ -1,3 +1,12 @@\n+2014-10-14  Joel Brobecker  <brobecker@adacore.com>\n+\n+\t* d-demangle.c: Replace strtold with strtod in global comment.\n+\t(strtold): Remove declaration.\n+\t(strtod): New declaration.\n+\t(dlang_parse_real): Declare value as double instead of long\n+\tdouble.  Replace call to strtold by call to strtod.\n+\tUpdate format in call to snprintf.\n+\n 2014-09-26  Jason Merrill  <jason@redhat.com>\n \n \t* cp-demangle.c (d_substitution): Handle abi tags on abbreviation."}, {"sha": "bb481c0998e851b6c3fe6ad7610e00c92a0ea658", "filename": "libiberty/d-demangle.c", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a523cfe4e6304f18117266d34f4ae2603274577/libiberty%2Fd-demangle.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a523cfe4e6304f18117266d34f4ae2603274577/libiberty%2Fd-demangle.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Fd-demangle.c?ref=2a523cfe4e6304f18117266d34f4ae2603274577", "patch": "@@ -28,7 +28,7 @@ If not, see <http://www.gnu.org/licenses/>.  */\n \n /* This file exports one function; dlang_demangle.\n \n-   This file imports strtol and strtold for decoding mangled literals.  */\n+   This file imports strtol and strtod for decoding mangled literals.  */\n \n #ifdef HAVE_CONFIG_H\n #include \"config.h\"\n@@ -44,7 +44,7 @@ If not, see <http://www.gnu.org/licenses/>.  */\n #include <stdlib.h>\n #else\n extern long strtol (const char *nptr, char **endptr, int base);\n-extern long double strtold (const char *nptr, char **endptr);\n+extern double strtod (const char *nptr, char **endptr);\n #endif\n \n #include <demangle.h>\n@@ -810,7 +810,7 @@ dlang_parse_real (string *decl, const char *mangled)\n {\n   char buffer[64];\n   int len = 0;\n-  long double value;\n+  double value;\n   char *endptr;\n \n   /* Handle NAN and +-INF.  */\n@@ -877,12 +877,12 @@ dlang_parse_real (string *decl, const char *mangled)\n \n   /* Convert buffer from hexadecimal to floating-point.  */\n   buffer[len] = '\\0';\n-  value = strtold (buffer, &endptr);\n+  value = strtod (buffer, &endptr);\n \n   if (endptr == NULL || endptr != (buffer + len))\n     return NULL;\n \n-  len = snprintf (buffer, sizeof(buffer), \"%#Lg\", value);\n+  len = snprintf (buffer, sizeof(buffer), \"%#g\", value);\n   string_appendn (decl, buffer, len);\n   return mangled;\n }"}]}