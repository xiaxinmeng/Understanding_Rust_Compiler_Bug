{"sha": "a698cc0308468029029e0501815747284194e407", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTY5OGNjMDMwODQ2ODAyOTAyOWUwNTAxODE1NzQ3Mjg0MTk0ZTQwNw==", "commit": {"author": {"name": "Jeff Law", "email": "law@redhat.com", "date": "2013-02-08T20:03:52Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2013-02-08T20:03:52Z"}, "message": "re PR debug/53948 (Assignment line missing for -O0 -g)\n\n       PR debug/53948\n        * emit-rtl.c (reg_is_parm_p): New function.\n        * regs.h (reg_is_parm_p): New prototype.\n        * ira-conflicts.c (ira_build_conflicts): Allow parameters in\n        callee-clobbered registers.\n\n       PR debug/53948\n        * gcc.dg/debug/dwarf2/pr53948.c: New test.\n\nFrom-SVN: r195900", "tree": {"sha": "a991da3f3350280432395c213f19731541c363b9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a991da3f3350280432395c213f19731541c363b9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a698cc0308468029029e0501815747284194e407", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a698cc0308468029029e0501815747284194e407", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a698cc0308468029029e0501815747284194e407", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a698cc0308468029029e0501815747284194e407/comments", "author": null, "committer": null, "parents": [{"sha": "e1122ddda6332ca3a430b3944053ad8ecf11fb20", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e1122ddda6332ca3a430b3944053ad8ecf11fb20", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e1122ddda6332ca3a430b3944053ad8ecf11fb20"}], "stats": {"total": 45, "additions": 43, "deletions": 2}, "files": [{"sha": "2693b7e843e6c5759fac1d06d4fad0b065379ce5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a698cc0308468029029e0501815747284194e407/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a698cc0308468029029e0501815747284194e407/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a698cc0308468029029e0501815747284194e407", "patch": "@@ -1,3 +1,11 @@\n+2013-02-08  Jeff Law  <law@redhat.com>\n+\n+\tPR debug/53948\n+\t* emit-rtl.c (reg_is_parm_p): New function.\n+\t* regs.h (reg_is_parm_p): New prototype.\n+\t* ira-conflicts.c (ira_build_conflicts): Allow parameters in\n+\tcallee-clobbered registers.\n+\n 2013-02-08  Michael Meissner  <meissner@linux.vnet.ibm.com>\n \n \tPR target/56043"}, {"sha": "2c70fb1841daecee753b11852e189b5495e0c222", "filename": "gcc/emit-rtl.c", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a698cc0308468029029e0501815747284194e407/gcc%2Femit-rtl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a698cc0308468029029e0501815747284194e407/gcc%2Femit-rtl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Femit-rtl.c?ref=a698cc0308468029029e0501815747284194e407", "patch": "@@ -919,6 +919,18 @@ gen_reg_rtx (enum machine_mode mode)\n   return val;\n }\n \n+/* Return TRUE if REG is a PARM_DECL, FALSE otherwise.  */\n+\n+bool\n+reg_is_parm_p (rtx reg)\n+{\n+  tree decl;\n+\n+  gcc_assert (REG_P (reg));\n+  decl = REG_EXPR (reg);\n+  return (decl && TREE_CODE (decl) == PARM_DECL);\n+}\n+\n /* Update NEW with the same attributes as REG, but with OFFSET added\n    to the REG_OFFSET.  */\n "}, {"sha": "710986b073e4598b3d4e23b53f340cc34bb8c616", "filename": "gcc/ira-conflicts.c", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a698cc0308468029029e0501815747284194e407/gcc%2Fira-conflicts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a698cc0308468029029e0501815747284194e407/gcc%2Fira-conflicts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fira-conflicts.c?ref=a698cc0308468029029e0501815747284194e407", "patch": "@@ -895,8 +895,12 @@ ira_build_conflicts (void)\n \n \t  if ((! flag_caller_saves && ALLOCNO_CALLS_CROSSED_NUM (a) != 0)\n \t      /* For debugging purposes don't put user defined variables in\n-\t\t callee-clobbered registers.  */\n-\t      || (optimize == 0 && REG_USERVAR_P (allocno_reg)))\n+\t\t callee-clobbered registers.  However, do allow parameters\n+\t\t in callee-clobbered registers to improve debugging.  This\n+\t\t is a bit of a fragile hack.  */\n+\t      || (optimize == 0\n+\t\t  && REG_USERVAR_P (allocno_reg)\n+\t\t  && ! reg_is_parm_p (allocno_reg)))\n \t    {\n \t      IOR_HARD_REG_SET (OBJECT_TOTAL_CONFLICT_HARD_REGS (obj),\n \t\t\t\tcall_used_reg_set);"}, {"sha": "090d6b64e8334967903c3a0ea823b9259e723662", "filename": "gcc/regs.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a698cc0308468029029e0501815747284194e407/gcc%2Fregs.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a698cc0308468029029e0501815747284194e407/gcc%2Fregs.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fregs.h?ref=a698cc0308468029029e0501815747284194e407", "patch": "@@ -89,6 +89,8 @@ REG_N_SETS (int regno)\n #define SET_REG_N_SETS(N,V) (regstat_n_sets_and_refs[N].sets = V)\n #define INC_REG_N_SETS(N,V) (regstat_n_sets_and_refs[N].sets += V)\n \n+/* Given a REG, return TRUE if the reg is a PARM_DECL, FALSE otherwise.  */\n+extern bool reg_is_parm_p (rtx);\n \n /* Functions defined in regstat.c.  */\n extern void regstat_init_n_sets_and_refs (void);"}, {"sha": "83843b765810ad7eca61d15022319654f75e98f6", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a698cc0308468029029e0501815747284194e407/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a698cc0308468029029e0501815747284194e407/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a698cc0308468029029e0501815747284194e407", "patch": "@@ -1,3 +1,8 @@\n+2013-02-08  Jeff Law  <law@redhat.com>\n+\n+\tPR debug/53948\n+\t* gcc.dg/debug/dwarf2/pr53948.c: New test.\n+\n 2013-02-08  Michael Meissner  <meissner@linux.vnet.ibm.com>\n \n \tPR target/56043"}, {"sha": "f0600b77a1478bfcbdbe66088267ec2a77139c15", "filename": "gcc/testsuite/gcc.dg/debug/dwarf2/pr53948.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a698cc0308468029029e0501815747284194e407/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr53948.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a698cc0308468029029e0501815747284194e407/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr53948.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr53948.c?ref=a698cc0308468029029e0501815747284194e407", "patch": "@@ -0,0 +1,10 @@\n+/* Test that we have line information for the line\n+   with local variable initializations.  */\n+/* { dg-options \"-O0 -g -dA\" } */\n+/* { dg-final { scan-assembler \".loc 1 8 0|# line 8\" } } */\n+\n+\n+int f (register int a, register int b) {\n+  register int x = b, y = a;\n+  return x + y; }\n+"}]}