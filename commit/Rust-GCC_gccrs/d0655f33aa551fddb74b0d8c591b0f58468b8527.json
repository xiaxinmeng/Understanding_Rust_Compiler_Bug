{"sha": "d0655f33aa551fddb74b0d8c591b0f58468b8527", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDA2NTVmMzNhYTU1MWZkZGI3NGIwZDhjNTkxYjBmNTg0NjhiODUyNw==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2006-09-08T00:28:30Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2006-09-08T00:28:30Z"}, "message": "re PR target/13685 (Building simple test application with -march=pentium3 -Os gives SIGSEGV (unaligned sse instruction))\n\n        PR target/13685\n        * config/i386/i386.c (override_options): Use 128-bit\n        stack boundary if -msse.\n\nFrom-SVN: r116775", "tree": {"sha": "01c9bb568034eaea41601799d2f2b67c4ecf7a44", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/01c9bb568034eaea41601799d2f2b67c4ecf7a44"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d0655f33aa551fddb74b0d8c591b0f58468b8527", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d0655f33aa551fddb74b0d8c591b0f58468b8527", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d0655f33aa551fddb74b0d8c591b0f58468b8527", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d0655f33aa551fddb74b0d8c591b0f58468b8527/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2e71a7a31e0e19e69bd3a34dbfb549871d461cc9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e71a7a31e0e19e69bd3a34dbfb549871d461cc9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2e71a7a31e0e19e69bd3a34dbfb549871d461cc9"}], "stats": {"total": 64, "additions": 48, "deletions": 16}, "files": [{"sha": "a430e20667a18854f0475d357651045bb88521d8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d0655f33aa551fddb74b0d8c591b0f58468b8527/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d0655f33aa551fddb74b0d8c591b0f58468b8527/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d0655f33aa551fddb74b0d8c591b0f58468b8527", "patch": "@@ -1,3 +1,9 @@\n+2006-09-07  Jason Merrill  <jason@redhat.com>\n+\n+\tPR target/13685\n+\t* config/i386/i386.c (override_options): Use 128-bit\n+\tstack boundary if -msse.\n+\n 2006-09-07  Eric Christopher  <echristo@apple.com>\n \n \t* config/darwin.h (MACHO_SYMBOL_FLAG_VARIABLE): Update"}, {"sha": "962b9900507b04aadeb4e4b4badf735e2481c099", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 16, "deletions": 16, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d0655f33aa551fddb74b0d8c591b0f58468b8527/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d0655f33aa551fddb74b0d8c591b0f58468b8527/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=d0655f33aa551fddb74b0d8c591b0f58468b8527", "patch": "@@ -1799,22 +1799,6 @@ override_options (void)\n       align_functions = processor_target_table[ix86_tune].align_func;\n     }\n \n-  /* Validate -mpreferred-stack-boundary= value, or provide default.\n-     The default of 128 bits is for Pentium III's SSE __m128, but we\n-     don't want additional code to keep the stack aligned when\n-     optimizing for code size.  */\n-  ix86_preferred_stack_boundary = ((TARGET_64BIT || TARGET_MACHO || !optimize_size)\n-\t\t\t\t   ? 128 : 32);\n-  if (ix86_preferred_stack_boundary_string)\n-    {\n-      i = atoi (ix86_preferred_stack_boundary_string);\n-      if (i < (TARGET_64BIT ? 4 : 2) || i > 12)\n-\terror (\"-mpreferred-stack-boundary=%d is not between %d and 12\", i,\n-\t       TARGET_64BIT ? 4 : 2);\n-      else\n-\tix86_preferred_stack_boundary = (1 << i) * BITS_PER_UNIT;\n-    }\n-\n   /* Validate -mbranch-cost= value, or provide default.  */\n   ix86_branch_cost = ix86_cost->branch_cost;\n   if (ix86_branch_cost_string)\n@@ -1909,6 +1893,22 @@ override_options (void)\n         target_flags |= MASK_NO_RED_ZONE;\n     }\n \n+  /* Validate -mpreferred-stack-boundary= value, or provide default.\n+     The default of 128 bits is for Pentium III's SSE __m128, but we\n+     don't want additional code to keep the stack aligned when\n+     optimizing for code size.  */\n+  ix86_preferred_stack_boundary\n+    = ((TARGET_MACHO || TARGET_SSE || !optimize_size) ? 128 : 32);\n+  if (ix86_preferred_stack_boundary_string)\n+    {\n+      i = atoi (ix86_preferred_stack_boundary_string);\n+      if (i < (TARGET_64BIT ? 4 : 2) || i > 12)\n+\terror (\"-mpreferred-stack-boundary=%d is not between %d and 12\", i,\n+\t       TARGET_64BIT ? 4 : 2);\n+      else\n+\tix86_preferred_stack_boundary = (1 << i) * BITS_PER_UNIT;\n+    }\n+\n   /* Accept -msseregparm only if at least SSE support is enabled.  */\n   if (TARGET_SSEREGPARM\n       && ! TARGET_SSE)"}, {"sha": "5aa8f7a28129eb2f2530077305927d1a2c166746", "filename": "gcc/testsuite/gcc.target/i386/sse-20.c", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d0655f33aa551fddb74b0d8c591b0f58468b8527/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse-20.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d0655f33aa551fddb74b0d8c591b0f58468b8527/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse-20.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse-20.c?ref=d0655f33aa551fddb74b0d8c591b0f58468b8527", "patch": "@@ -0,0 +1,26 @@\n+/* PR target/13685 */\n+/* { dg-options \"-Os -msse\" } */\n+\n+typedef float __m128 __attribute__ ((vector_size (16)));\n+typedef int __m64 __attribute__ ((vector_size (8)));\n+\n+int puts (const char *s);\n+void foo (__m128 *, __m64 *, int);\n+\n+int main (void)\n+{\n+  foo (0, 0, 0);\n+  return 0;\n+}\n+\n+void foo (__m128 *dst, __m64 *src, int n)\n+{\n+  __m128 xmm0 = { 0 };\n+  while (n > 64)\n+    {\n+      puts (\"\");\n+      xmm0 = __builtin_ia32_cvtpi2ps (xmm0, *src);\n+      *dst = xmm0;\n+      n --;\n+    }\n+}"}]}