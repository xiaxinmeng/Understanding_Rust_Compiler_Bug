{"sha": "79488388644d9f3096c283f17a1ffc85f5e319ae", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Nzk0ODgzODg2NDRkOWYzMDk2YzI4M2YxN2ExZmZjODVmNWUzMTlhZQ==", "commit": {"author": {"name": "Tim Shen", "email": "timshen91@gmail.com", "date": "2013-10-18T16:13:07Z"}, "committer": {"name": "Tim Shen", "email": "timshen@gcc.gnu.org", "date": "2013-10-18T16:13:07Z"}, "message": "regex_scanner.tcc: (_Scanner<>::_M_scan_normal...\n\n2013-10-18  Tim Shen  <timshen91@gmail.com>\n\n\t* include/bits/regex_scanner.tcc: (_Scanner<>::_M_scan_normal,\n\t_Scanner<>::_M_eat_escape_ecma, _Scanner<>::_M_eat_escape_posix,\n\t_Scanner<>::_M_eat_escape_awk): Narrow character before finding in maps.\n\t* testsuite/28_regex/algorithms/regex_match/ecma/wchar_t/cjk_match.cc:\n\tNew.\n\nFrom-SVN: r203827", "tree": {"sha": "edfbc3cc8e346a4ca77164d8ffa6c232be178ce6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/edfbc3cc8e346a4ca77164d8ffa6c232be178ce6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/79488388644d9f3096c283f17a1ffc85f5e319ae", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/79488388644d9f3096c283f17a1ffc85f5e319ae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/79488388644d9f3096c283f17a1ffc85f5e319ae", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/79488388644d9f3096c283f17a1ffc85f5e319ae/comments", "author": {"login": "timshen91", "id": 1157432, "node_id": "MDQ6VXNlcjExNTc0MzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1157432?v=4", "gravatar_id": "", "url": "https://api.github.com/users/timshen91", "html_url": "https://github.com/timshen91", "followers_url": "https://api.github.com/users/timshen91/followers", "following_url": "https://api.github.com/users/timshen91/following{/other_user}", "gists_url": "https://api.github.com/users/timshen91/gists{/gist_id}", "starred_url": "https://api.github.com/users/timshen91/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/timshen91/subscriptions", "organizations_url": "https://api.github.com/users/timshen91/orgs", "repos_url": "https://api.github.com/users/timshen91/repos", "events_url": "https://api.github.com/users/timshen91/events{/privacy}", "received_events_url": "https://api.github.com/users/timshen91/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "01e127b1dd90a951a602832070047e2723f072f5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/01e127b1dd90a951a602832070047e2723f072f5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/01e127b1dd90a951a602832070047e2723f072f5"}], "stats": {"total": 66, "additions": 62, "deletions": 4}, "files": [{"sha": "b37fdb64aa7935c6ea9ad1d7edfc5a1a2f803793", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/79488388644d9f3096c283f17a1ffc85f5e319ae/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/79488388644d9f3096c283f17a1ffc85f5e319ae/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=79488388644d9f3096c283f17a1ffc85f5e319ae", "patch": "@@ -1,3 +1,11 @@\n+2013-10-18  Tim Shen  <timshen91@gmail.com>\n+\n+\t* include/bits/regex_scanner.tcc: (_Scanner<>::_M_scan_normal,\n+\t_Scanner<>::_M_eat_escape_ecma, _Scanner<>::_M_eat_escape_posix,\n+\t_Scanner<>::_M_eat_escape_awk): Narrow character before finding in maps.\n+\t* testsuite/28_regex/algorithms/regex_match/ecma/wchar_t/cjk_match.cc:\n+\tNew.\n+\n 2013-10-17  Tim Shen  <timshen91@gmail.com>\n \n \t* include/bits/regex.h (regex_token_iterator<>::regex_token_iterator):"}, {"sha": "f6cef6a04c2d2183bf4f7cb293d2a173d9843c1a", "filename": "libstdc++-v3/include/bits/regex_scanner.tcc", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/79488388644d9f3096c283f17a1ffc85f5e319ae/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fregex_scanner.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/79488388644d9f3096c283f17a1ffc85f5e319ae/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fregex_scanner.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fregex_scanner.tcc?ref=79488388644d9f3096c283f17a1ffc85f5e319ae", "patch": "@@ -244,7 +244,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \t  _M_state = _S_state_in_brace;\n \t  _M_token = _S_token_interval_begin;\n \t}\n-      else if ((_M_spec_char.count(__c)\n+      else if ((_M_spec_char.count(_M_ctype.narrow(__c, '\\0'))\n \t\t&& __c != ']'\n \t\t&& __c != '}')\n \t       || (_M_is_grep() && __c == '\\n'))\n@@ -367,7 +367,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \n       auto __c = *_M_current++;\n \n-      if (_M_escape_map.count(__c)\n+      if (_M_escape_map.count(_M_ctype.narrow(__c, '\\0'))\n \t  && (__c != 'b' || _M_state == _S_state_in_bracket))\n \t{\n \t  _M_token = _S_token_ord_char;\n@@ -441,7 +441,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \n       auto __c = *_M_current;\n \n-      if (_M_spec_char.count(__c))\n+      if (_M_spec_char.count(_M_ctype.narrow(__c, '\\0')))\n \t{\n \t  _M_token = _S_token_ord_char;\n \t  _M_value.assign(1, __c);\n@@ -476,7 +476,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n     {\n       auto __c = *_M_current++;\n \n-      if (_M_escape_map.count(__c))\n+      if (_M_escape_map.count(_M_ctype.narrow(__c, '\\0')))\n \t{\n \t  _M_token = _S_token_ord_char;\n \t  _M_value.assign(1, _M_escape_map.at(__c));"}, {"sha": "15929ddc532d51f8b664bb5075e790aeb2e828f7", "filename": "libstdc++-v3/testsuite/28_regex/algorithms/regex_match/ecma/wchar_t/cjk_match.cc", "status": "added", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/79488388644d9f3096c283f17a1ffc85f5e319ae/libstdc%2B%2B-v3%2Ftestsuite%2F28_regex%2Falgorithms%2Fregex_match%2Fecma%2Fwchar_t%2Fcjk_match.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/79488388644d9f3096c283f17a1ffc85f5e319ae/libstdc%2B%2B-v3%2Ftestsuite%2F28_regex%2Falgorithms%2Fregex_match%2Fecma%2Fwchar_t%2Fcjk_match.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F28_regex%2Falgorithms%2Fregex_match%2Fecma%2Fwchar_t%2Fcjk_match.cc?ref=79488388644d9f3096c283f17a1ffc85f5e319ae", "patch": "@@ -0,0 +1,50 @@\n+// { dg-options \"-std=gnu++11\" }\n+\n+//\n+// 2013-10-18  Tim Shen <timshen91@gmail.com>\n+//\n+// Copyright (C) 2013 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+//\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+\n+// 28.11.2 regex_match\n+// Tests CJK support.\n+\n+#include <regex>\n+#include <testsuite_hooks.h>\n+#include <testsuite_regex.h>\n+\n+using namespace __gnu_test;\n+using namespace std;\n+\n+void\n+test01()\n+{\n+  bool test __attribute__((unused)) = true;\n+\n+  const wchar_t * s = L\"\\u4f60\\u597d\\u002c\\u0020\\u4e16\\u002b\\u754c\";\n+\n+  wregex re(s);\n+  VERIFY(regex_match_debug(L\"\\u4f60\\u597d\\u002c\\u0020\\u4e16\\u4e16\\u4e16\\u754c\",\n+\t\t\t   re));\n+}\n+\n+int\n+main()\n+{\n+  test01();\n+  return 0;\n+}"}]}