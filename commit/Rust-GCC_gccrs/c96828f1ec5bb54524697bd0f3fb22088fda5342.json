{"sha": "c96828f1ec5bb54524697bd0f3fb22088fda5342", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzk2ODI4ZjFlYzViYjU0NTI0Njk3YmQwZjNmYjIyMDg4ZmRhNTM0Mg==", "commit": {"author": {"name": "Kewen Lin", "email": "linkw@gcc.gnu.org", "date": "2019-12-04T05:10:46Z"}, "committer": {"name": "Kewen Lin", "email": "linkw@gcc.gnu.org", "date": "2019-12-04T05:10:46Z"}, "message": "[rs6000] Fix PR92760 by checking VECTOR_MEM_NONE_P instead\n\nPR92760 exposed one issue that VECTOR_UNIT_NONE_P (V2DImode) is true on Power7\nthen we won't return it as preferred_simd_mode but ISA 2.06 (Power7) does\nintroduce partial support on vector doubleword (very limitted) and more basic\nsupport origins from ISA 2.07 (Power8) though.  To make vectorizer still\nleverage those few but available V2DImode related instructions, we need to\nclaim it's available on VSX (Power7 and up).\n\ngcc/ChangeLog\n\n    PR target/92760\n    * gcc/config/rs6000/rs6000.c (rs6000_preferred_simd_mode): Use\n    VECTOR_MEM_NONE_P instead of VECTOR_UNIT_NONE_P.\n\nFrom-SVN: r278955", "tree": {"sha": "16ab3a269c12b6ff25b2645e7b20663754acd7f0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/16ab3a269c12b6ff25b2645e7b20663754acd7f0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c96828f1ec5bb54524697bd0f3fb22088fda5342", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c96828f1ec5bb54524697bd0f3fb22088fda5342", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c96828f1ec5bb54524697bd0f3fb22088fda5342", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c96828f1ec5bb54524697bd0f3fb22088fda5342/comments", "author": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b0e83d70f935664482cf4006f9bac8315d55c480", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b0e83d70f935664482cf4006f9bac8315d55c480", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b0e83d70f935664482cf4006f9bac8315d55c480"}], "stats": {"total": 8, "additions": 7, "deletions": 1}, "files": [{"sha": "e04a48a38808c7343590bcba54b83f3dd794e2f0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c96828f1ec5bb54524697bd0f3fb22088fda5342/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c96828f1ec5bb54524697bd0f3fb22088fda5342/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c96828f1ec5bb54524697bd0f3fb22088fda5342", "patch": "@@ -1,3 +1,9 @@\n+2019-12-04  Kewen Lin  <linkw@gcc.gnu.org>\n+\n+\tPR target/92760\n+\t* gcc/config/rs6000/rs6000.c (rs6000_preferred_simd_mode): Use\n+\tVECTOR_MEM_NONE_P instead of VECTOR_UNIT_NONE_P.\n+\n 2019-12-03  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* ipa-fnsummary.c: Include tree-into-ssa.h."}, {"sha": "23b6d99609b4fbda5276d25e776f222e22d32405", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c96828f1ec5bb54524697bd0f3fb22088fda5342/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c96828f1ec5bb54524697bd0f3fb22088fda5342/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=c96828f1ec5bb54524697bd0f3fb22088fda5342", "patch": "@@ -4917,7 +4917,7 @@ rs6000_preferred_simd_mode (scalar_mode mode)\n {\n   opt_machine_mode vmode = mode_for_vector (mode, 16 / GET_MODE_SIZE (mode));\n \n-  if (vmode.exists () && !VECTOR_UNIT_NONE_P (vmode.require ()))\n+  if (vmode.exists () && !VECTOR_MEM_NONE_P (vmode.require ()))\n     return vmode.require ();\n \n   return word_mode;"}]}