{"sha": "414231ba78973dfcb11648a0a5287b989e0148bb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDE0MjMxYmE3ODk3M2RmY2IxMTY0OGEwYTUyODdiOTg5ZTAxNDhiYg==", "commit": {"author": {"name": "Martin Sebor", "email": "msebor@redhat.com", "date": "2020-01-20T13:53:33Z"}, "committer": {"name": "Martin Sebor", "email": "msebor@redhat.com", "date": "2020-01-20T13:53:33Z"}, "message": "PR testsuite/92829 - several -Wstringop-overflow test case failures on powerpc64\n\n\t* g++.dg/warn/Wstringop-overflow-4.C: Adjust test to avoid failures\n\tdue to an aparrent VRP limtation.\n\t* gcc.dg/Wstringop-overflow-25.c: Same.", "tree": {"sha": "9ee516543ff69990b9695be895865402fe819189", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9ee516543ff69990b9695be895865402fe819189"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/414231ba78973dfcb11648a0a5287b989e0148bb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/414231ba78973dfcb11648a0a5287b989e0148bb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/414231ba78973dfcb11648a0a5287b989e0148bb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/414231ba78973dfcb11648a0a5287b989e0148bb/comments", "author": {"login": "msebor", "id": 381149, "node_id": "MDQ6VXNlcjM4MTE0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/381149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msebor", "html_url": "https://github.com/msebor", "followers_url": "https://api.github.com/users/msebor/followers", "following_url": "https://api.github.com/users/msebor/following{/other_user}", "gists_url": "https://api.github.com/users/msebor/gists{/gist_id}", "starred_url": "https://api.github.com/users/msebor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msebor/subscriptions", "organizations_url": "https://api.github.com/users/msebor/orgs", "repos_url": "https://api.github.com/users/msebor/repos", "events_url": "https://api.github.com/users/msebor/events{/privacy}", "received_events_url": "https://api.github.com/users/msebor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "msebor", "id": 381149, "node_id": "MDQ6VXNlcjM4MTE0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/381149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msebor", "html_url": "https://github.com/msebor", "followers_url": "https://api.github.com/users/msebor/followers", "following_url": "https://api.github.com/users/msebor/following{/other_user}", "gists_url": "https://api.github.com/users/msebor/gists{/gist_id}", "starred_url": "https://api.github.com/users/msebor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msebor/subscriptions", "organizations_url": "https://api.github.com/users/msebor/orgs", "repos_url": "https://api.github.com/users/msebor/repos", "events_url": "https://api.github.com/users/msebor/events{/privacy}", "received_events_url": "https://api.github.com/users/msebor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a5d8a40617df40680cf7de6109925e4f1f1b9ae2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a5d8a40617df40680cf7de6109925e4f1f1b9ae2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a5d8a40617df40680cf7de6109925e4f1f1b9ae2"}], "stats": {"total": 37, "additions": 28, "deletions": 9}, "files": [{"sha": "452c16eb8c5ed7b4181a02800bb3dbc7b55e38cd", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/414231ba78973dfcb11648a0a5287b989e0148bb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/414231ba78973dfcb11648a0a5287b989e0148bb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=414231ba78973dfcb11648a0a5287b989e0148bb", "patch": "@@ -1,3 +1,10 @@\n+2020-01-20  Martin Sebor  <msebor@redhat.com>\n+\n+\tPR testsuite/92829\n+\t* g++.dg/warn/Wstringop-overflow-4.C: Adjust test to avoid failures\n+\tdue to an aparrent VRP limtation.\n+\t* gcc.dg/Wstringop-overflow-25.c: Same.\n+\n 2020-01-20  Nathan Sidwell  <nathan@acm.org>\n \n \tPR preprocessor/80005"}, {"sha": "121239ac1dbc7c3fd2ad38712de9387d28ba8976", "filename": "gcc/testsuite/g++.dg/warn/Wstringop-overflow-4.C", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/414231ba78973dfcb11648a0a5287b989e0148bb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWstringop-overflow-4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/414231ba78973dfcb11648a0a5287b989e0148bb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWstringop-overflow-4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWstringop-overflow-4.C?ref=414231ba78973dfcb11648a0a5287b989e0148bb", "patch": "@@ -98,13 +98,19 @@ void test_strcpy_new_char_array (size_t n)\n \n #ifdef __INT16_TYPE__\n \n+// Hack around PR 92829.\n+#define XUR(min, max) \\\n+  (++idx, (vals[idx] < min || max < vals[idx] ? min : vals[idx]))\n+\n typedef __INT16_TYPE__ int16_t;\n \n-void test_strcpy_new_int16_t (size_t n)\n+void test_strcpy_new_int16_t (size_t n, const size_t vals[])\n {\n-  size_t r_0_1 = UR (0, 1);\n-  size_t r_1_2 = UR (1, 2);\n-  size_t r_2_3 = UR (2, 3);\n+  size_t idx = 0;\n+\n+  size_t r_0_1 = XUR (0, 1);\n+  size_t r_1_2 = XUR (1, 2);\n+  size_t r_2_3 = XUR (2, 3);\n \n   T (S (0), new int16_t[r_0_1]);\n   T (S (1), new int16_t[r_0_1]);\n@@ -122,7 +128,7 @@ void test_strcpy_new_int16_t (size_t n)\n   T (S (6), new int16_t[r_2_3]);      // { dg-warning \"\\\\\\[-Wstringop-overflow\" }\n   T (S (9), new int16_t[r_2_3]);      // { dg-warning \"\\\\\\[-Wstringop-overflow\" }\n \n-  size_t r_2_smax = UR (2, SIZE_MAX);\n+  size_t r_2_smax = XUR (2, SIZE_MAX);\n   T (S (0), new int16_t[r_2_smax]);\n   T (S (1), new int16_t[r_2_smax]);\n   T (S (2), new int16_t[r_2_smax]);"}, {"sha": "01807207acc6cdd565cb624db9c69e3627bcf9d4", "filename": "gcc/testsuite/gcc.dg/Wstringop-overflow-25.c", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/414231ba78973dfcb11648a0a5287b989e0148bb/gcc%2Ftestsuite%2Fgcc.dg%2FWstringop-overflow-25.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/414231ba78973dfcb11648a0a5287b989e0148bb/gcc%2Ftestsuite%2Fgcc.dg%2FWstringop-overflow-25.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2FWstringop-overflow-25.c?ref=414231ba78973dfcb11648a0a5287b989e0148bb", "patch": "@@ -290,11 +290,17 @@ NOIPA void test_strcpy_alloc2_4 (void)\n     sink (vla);\t\t\t\t\t\\\n   } while (0)\n \n-NOIPA void test_strcpy_vla (void)\n+// Hack around PR 92829.\n+#define XUR(min, max) \\\n+  (++idx, (vals[idx] < min || max < vals[idx] ? min : vals[idx]))\n+\n+NOIPA void test_strcpy_vla (const size_t vals[])\n {\n-  size_t r_0_1 = UR (0, 1);\n-  size_t r_1_2 = UR (1, 2);\n-  size_t r_2_3 = UR (2, 3);\n+  size_t idx = 0;\n+\n+  size_t r_0_1 = XUR (0, 1);\n+  size_t r_1_2 = XUR (1, 2);\n+  size_t r_2_3 = XUR (2, 3);\n \n   T (char, S (0), r_0_1);\n   T (char, S (1), r_0_1);       // { dg-warning \"\\\\\\[-Wstringop-overflow\" }"}]}