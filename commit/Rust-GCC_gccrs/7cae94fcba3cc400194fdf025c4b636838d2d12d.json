{"sha": "7cae94fcba3cc400194fdf025c4b636838d2d12d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2NhZTk0ZmNiYTNjYzQwMDE5NGZkZjAyNWM0YjYzNjgzOGQyZDEyZA==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2009-02-10T14:54:13Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2009-02-10T14:54:13Z"}, "message": "re PR tree-optimization/39132 (wrong code generated with -ftree-loop-disttribution)\n\n2009-02-10  Richard Guenther  <rguenther@suse.de>\n\n\tPR tree-optimization/39132\n\t* tree-loop-distribution.c (todo): New global var.\n\t(generate_memset_zero): Trigger TODO_rebuild_alias.\n\t(tree_loop_distribution): Return todo.\n\n\t* gcc.dg/torture/pr39132.c: New testcase.\n\nFrom-SVN: r144060", "tree": {"sha": "3dc3892cf084cf9a20ddafc9cb440422e5bd6f08", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3dc3892cf084cf9a20ddafc9cb440422e5bd6f08"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7cae94fcba3cc400194fdf025c4b636838d2d12d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7cae94fcba3cc400194fdf025c4b636838d2d12d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7cae94fcba3cc400194fdf025c4b636838d2d12d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7cae94fcba3cc400194fdf025c4b636838d2d12d/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a8800687f548b183c6c28492e2ff455b606d828c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a8800687f548b183c6c28492e2ff455b606d828c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a8800687f548b183c6c28492e2ff455b606d828c"}], "stats": {"total": 55, "additions": 54, "deletions": 1}, "files": [{"sha": "d29668a7ff4e1367170867dbfc49c95e8cf82994", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7cae94fcba3cc400194fdf025c4b636838d2d12d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7cae94fcba3cc400194fdf025c4b636838d2d12d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7cae94fcba3cc400194fdf025c4b636838d2d12d", "patch": "@@ -1,3 +1,10 @@\n+2009-02-10  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR tree-optimization/39132\n+\t* tree-loop-distribution.c (todo): New global var.\n+\t(generate_memset_zero): Trigger TODO_rebuild_alias.\n+\t(tree_loop_distribution): Return todo.\n+\n 2009-02-10  H.J. Lu  <hongjiu.lu@intel.com>\n \n \tPR target/39119"}, {"sha": "02a65b9335ea145d9116c8274899488679736a12", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7cae94fcba3cc400194fdf025c4b636838d2d12d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7cae94fcba3cc400194fdf025c4b636838d2d12d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7cae94fcba3cc400194fdf025c4b636838d2d12d", "patch": "@@ -1,3 +1,8 @@\n+2009-02-10  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR tree-optimization/39132\n+\t* gcc.dg/torture/pr39132.c: New testcase.\n+\n 2009-02-10  H.J. Lu  <hongjiu.lu@intel.com>\n \n \tPR target/39119"}, {"sha": "f6e2907e0d6c58b7c680c54ee9d77455f20b1638", "filename": "gcc/testsuite/gcc.dg/torture/pr39132.c", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7cae94fcba3cc400194fdf025c4b636838d2d12d/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr39132.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7cae94fcba3cc400194fdf025c4b636838d2d12d/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr39132.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr39132.c?ref=7cae94fcba3cc400194fdf025c4b636838d2d12d", "patch": "@@ -0,0 +1,34 @@\n+/* { dg-do run } */\n+/* { dg-options \"-ftree-loop-distribution\" } */\n+\n+extern void abort(void);\n+\n+struct epic_private\n+{\n+  unsigned int *rx_ring;\n+  unsigned int rx_skbuff[5];\n+};\n+\n+int\n+main (void)\n+{\n+  struct epic_private ep;\n+  unsigned int rx_ring[5];\n+  int i;\n+\n+  ep.rx_skbuff[0] = 5;\n+\n+  ep.rx_ring = rx_ring;\n+\n+  for (i = 0; i < 5; i++)\n+    {\n+      ep.rx_ring[i] = i;\n+      ep.rx_skbuff[i] = 0;\n+    }\n+\n+  if (ep.rx_skbuff[0] != 0)\n+    abort ();\n+\n+  return 0;\n+}\n+"}, {"sha": "080eceacb55b679281609d76b1455bd6f3c913f5", "filename": "gcc/tree-loop-distribution.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7cae94fcba3cc400194fdf025c4b636838d2d12d/gcc%2Ftree-loop-distribution.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7cae94fcba3cc400194fdf025c4b636838d2d12d/gcc%2Ftree-loop-distribution.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-loop-distribution.c?ref=7cae94fcba3cc400194fdf025c4b636838d2d12d", "patch": "@@ -77,6 +77,9 @@ static bitmap remaining_stmts;\n    predecessor a node that writes to memory.  */\n static bitmap upstream_mem_writes;\n \n+/* TODOs we need to run after the pass.  */\n+static unsigned int todo;\n+\n /* Update the PHI nodes of NEW_LOOP.  NEW_LOOP is a duplicate of\n    ORIG_LOOP.  */\n \n@@ -331,6 +334,8 @@ generate_memset_zero (gimple stmt, tree op0, tree nb_iter,\n   if (dump_file && (dump_flags & TDF_DETAILS))\n     fprintf (dump_file, \"generated memset zero\\n\");\n \n+  todo |= TODO_rebuild_alias;\n+\n  end:\n   free_data_ref (dr);\n   return res;\n@@ -1206,6 +1211,8 @@ tree_loop_distribution (void)\n   loop_iterator li;\n   int nb_generated_loops = 0;\n \n+  todo = 0;\n+\n   FOR_EACH_LOOP (li, loop, 0)\n     {\n       VEC (gimple, heap) *work_list = VEC_alloc (gimple, heap, 3);\n@@ -1237,7 +1244,7 @@ tree_loop_distribution (void)\n       VEC_free (gimple, heap, work_list);\n     }\n \n-  return 0;\n+  return todo;\n }\n \n static bool"}]}