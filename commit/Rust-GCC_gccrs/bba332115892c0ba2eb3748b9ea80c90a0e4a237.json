{"sha": "bba332115892c0ba2eb3748b9ea80c90a0e4a237", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmJhMzMyMTE1ODkyYzBiYTJlYjM3NDhiOWVhODBjOTBhMGU0YTIzNw==", "commit": {"author": {"name": "Joern Rennecke", "email": "joern.rennecke@embecosm.com", "date": "2013-07-29T22:45:38Z"}, "committer": {"name": "Joern Rennecke", "email": "amylaar@gcc.gnu.org", "date": "2013-07-29T22:45:38Z"}, "message": "re PR rtl-optimization/58021 (MODE_EXIT switches at NOTE_INSN_DELETED)\n\n        PR rtl-optimization/58021\n        * mode-switching.c (create_pre_exit): Always split off preceding\n        insns if we are not at the basic block head.\n\nFrom-SVN: r201321", "tree": {"sha": "94703f6d865b5c862c8f5aea9eefd59bc4d7e5dd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/94703f6d865b5c862c8f5aea9eefd59bc4d7e5dd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bba332115892c0ba2eb3748b9ea80c90a0e4a237", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bba332115892c0ba2eb3748b9ea80c90a0e4a237", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bba332115892c0ba2eb3748b9ea80c90a0e4a237", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bba332115892c0ba2eb3748b9ea80c90a0e4a237/comments", "author": {"login": "amylaar", "id": 1663475, "node_id": "MDQ6VXNlcjE2NjM0NzU=", "avatar_url": "https://avatars.githubusercontent.com/u/1663475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amylaar", "html_url": "https://github.com/amylaar", "followers_url": "https://api.github.com/users/amylaar/followers", "following_url": "https://api.github.com/users/amylaar/following{/other_user}", "gists_url": "https://api.github.com/users/amylaar/gists{/gist_id}", "starred_url": "https://api.github.com/users/amylaar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amylaar/subscriptions", "organizations_url": "https://api.github.com/users/amylaar/orgs", "repos_url": "https://api.github.com/users/amylaar/repos", "events_url": "https://api.github.com/users/amylaar/events{/privacy}", "received_events_url": "https://api.github.com/users/amylaar/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e137912234fc9056a3898870f5e4826614df094a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e137912234fc9056a3898870f5e4826614df094a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e137912234fc9056a3898870f5e4826614df094a"}], "stats": {"total": 11, "additions": 7, "deletions": 4}, "files": [{"sha": "2d01701c1bbc53dddd7d6ae06276e17c472c0f94", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bba332115892c0ba2eb3748b9ea80c90a0e4a237/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bba332115892c0ba2eb3748b9ea80c90a0e4a237/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bba332115892c0ba2eb3748b9ea80c90a0e4a237", "patch": "@@ -6,6 +6,10 @@\n \t* predicates.md (float_operation): Allow patterns with three\n \tbasic sub-patterns.\n \n+\tPR rtl-optimization/58021\n+\t* mode-switching.c (create_pre_exit): Always split off preceding\n+\tinsns if we are not at the basic block head.\n+\n 2013-07-29  Maciej W. Rozycki  <macro@codesourcery.com>\n \n \t* config/mips/linux.h (GLIBC_DYNAMIC_LINKER): Handle `-mnan=2008'."}, {"sha": "0d112b19074989f966c457430ede23e7607e2467", "filename": "gcc/mode-switching.c", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bba332115892c0ba2eb3748b9ea80c90a0e4a237/gcc%2Fmode-switching.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bba332115892c0ba2eb3748b9ea80c90a0e4a237/gcc%2Fmode-switching.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmode-switching.c?ref=bba332115892c0ba2eb3748b9ea80c90a0e4a237", "patch": "@@ -420,17 +420,16 @@ create_pre_exit (int n_entities, int *entity_map, const int *num_modes)\n \t\t\t|| (GET_MODE_CLASS (GET_MODE (ret_reg)) != MODE_INT\n \t\t\t    && nregs != 1));\n \n-\t    if (INSN_P (last_insn))\n+\t    if (!NOTE_INSN_BASIC_BLOCK_P (last_insn))\n \t      {\n \t\tbefore_return_copy\n \t\t  = emit_note_before (NOTE_INSN_DELETED, last_insn);\n \t\t/* Instructions preceding LAST_INSN in the same block might\n \t\t   require a different mode than MODE_EXIT, so if we might\n \t\t   have such instructions, keep them in a separate block\n \t\t   from pre_exit.  */\n-\t\tif (last_insn != BB_HEAD (src_bb))\n-\t\t  src_bb = split_block (src_bb,\n-\t\t\t\t\tPREV_INSN (before_return_copy))->dest;\n+\t\tsrc_bb = split_block (src_bb,\n+\t\t\t\t      PREV_INSN (before_return_copy))->dest;\n \t      }\n \t    else\n \t      before_return_copy = last_insn;"}]}