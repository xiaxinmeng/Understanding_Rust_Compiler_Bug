{"sha": "d902a1b57606536982a1001670f998de685eaf7c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDkwMmExYjU3NjA2NTM2OTgyYTEwMDE2NzBmOTk4ZGU2ODVlYWY3Yw==", "commit": {"author": {"name": "Aldy Hernandez", "email": "aldyh@redhat.com", "date": "2021-05-12T19:22:15Z"}, "committer": {"name": "Aldy Hernandez", "email": "aldyh@redhat.com", "date": "2021-05-12T20:46:58Z"}, "message": "Skip out on processing __builtin_clz when varying.\n\nThe previous changes to irange::constant_p return TRUE for\nVARYING, since VARYING has numerical end points like any other\nconstant range.  The problem is that some users of constant_p\ndepended on constant_p excluding the full domain.  The\nrange handler for __builtin_clz, that is shared between ranger\nand vr_values, is one such user.\n\nThis patch excludes varying_p(), to match the original behavior\nfor clz.\n\ngcc/ChangeLog:\n\n\tPR c/100521\n\t* gimple-range.cc (range_of_builtin_call): Skip out on\n\t  processing __builtin_clz when varying.", "tree": {"sha": "70f23a7edb0c0a6825af6613deed94734620d2e0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/70f23a7edb0c0a6825af6613deed94734620d2e0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d902a1b57606536982a1001670f998de685eaf7c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d902a1b57606536982a1001670f998de685eaf7c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d902a1b57606536982a1001670f998de685eaf7c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d902a1b57606536982a1001670f998de685eaf7c/comments", "author": {"login": "aldyh", "id": 12937877, "node_id": "MDQ6VXNlcjEyOTM3ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/12937877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aldyh", "html_url": "https://github.com/aldyh", "followers_url": "https://api.github.com/users/aldyh/followers", "following_url": "https://api.github.com/users/aldyh/following{/other_user}", "gists_url": "https://api.github.com/users/aldyh/gists{/gist_id}", "starred_url": "https://api.github.com/users/aldyh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aldyh/subscriptions", "organizations_url": "https://api.github.com/users/aldyh/orgs", "repos_url": "https://api.github.com/users/aldyh/repos", "events_url": "https://api.github.com/users/aldyh/events{/privacy}", "received_events_url": "https://api.github.com/users/aldyh/received_events", "type": "User", "site_admin": false}, "committer": {"login": "aldyh", "id": 12937877, "node_id": "MDQ6VXNlcjEyOTM3ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/12937877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aldyh", "html_url": "https://github.com/aldyh", "followers_url": "https://api.github.com/users/aldyh/followers", "following_url": "https://api.github.com/users/aldyh/following{/other_user}", "gists_url": "https://api.github.com/users/aldyh/gists{/gist_id}", "starred_url": "https://api.github.com/users/aldyh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aldyh/subscriptions", "organizations_url": "https://api.github.com/users/aldyh/orgs", "repos_url": "https://api.github.com/users/aldyh/repos", "events_url": "https://api.github.com/users/aldyh/events{/privacy}", "received_events_url": "https://api.github.com/users/aldyh/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8982a5354d2697eeb12a77d49b6730db90053618", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8982a5354d2697eeb12a77d49b6730db90053618", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8982a5354d2697eeb12a77d49b6730db90053618"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "5b288d8e6a7e80300c5b2f3a5149736f1a3bac7e", "filename": "gcc/gimple-range.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d902a1b57606536982a1001670f998de685eaf7c/gcc%2Fgimple-range.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d902a1b57606536982a1001670f998de685eaf7c/gcc%2Fgimple-range.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple-range.cc?ref=d902a1b57606536982a1001670f998de685eaf7c", "patch": "@@ -737,7 +737,7 @@ range_of_builtin_call (range_query &query, irange &r, gcall *call)\n \n       query.range_of_expr (r, arg, call);\n       // From clz of minimum we can compute result maximum.\n-      if (r.constant_p ())\n+      if (r.constant_p () && !r.varying_p ())\n \t{\n \t  int newmaxi = prec - 1 - wi::floor_log2 (r.lower_bound ());\n \t  // Argument is unsigned, so do nothing if it is [0, ...] range."}, {"sha": "fd9f0db54126034e18e35279d50027ec8d3c1658", "filename": "gcc/testsuite/gcc.dg/pr100521.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d902a1b57606536982a1001670f998de685eaf7c/gcc%2Ftestsuite%2Fgcc.dg%2Fpr100521.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d902a1b57606536982a1001670f998de685eaf7c/gcc%2Ftestsuite%2Fgcc.dg%2Fpr100521.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr100521.c?ref=d902a1b57606536982a1001670f998de685eaf7c", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2\" } */\n+\n+int\n+__builtin_clz (int a)\n+{\n+  return __builtin_clz(a);\n+}"}]}