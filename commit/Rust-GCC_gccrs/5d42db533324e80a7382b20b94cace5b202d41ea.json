{"sha": "5d42db533324e80a7382b20b94cace5b202d41ea", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWQ0MmRiNTMzMzI0ZTgwYTczODJiMjBiOTRjYWNlNWIyMDJkNDFlYQ==", "commit": {"author": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2021-05-21T07:03:43Z"}, "committer": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2021-05-21T14:22:46Z"}, "message": "Don't skip 'libgomp.oacc-fortran/privatized-ref-2.f90' for nvptx offloading\n\n\tlibgomp/\n\t* testsuite/libgomp.oacc-fortran/privatized-ref-2.f90: Don't skip\n\tfor nvptx offloading.", "tree": {"sha": "157182872d2a061ef40724bd8874ff497f3b4dcf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/157182872d2a061ef40724bd8874ff497f3b4dcf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5d42db533324e80a7382b20b94cace5b202d41ea", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d42db533324e80a7382b20b94cace5b202d41ea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5d42db533324e80a7382b20b94cace5b202d41ea", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d42db533324e80a7382b20b94cace5b202d41ea/comments", "author": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "61796dc03befa9b7426d5bc7c336cca585944143", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/61796dc03befa9b7426d5bc7c336cca585944143", "html_url": "https://github.com/Rust-GCC/gccrs/commit/61796dc03befa9b7426d5bc7c336cca585944143"}], "stats": {"total": 12, "additions": 11, "deletions": 1}, "files": [{"sha": "907f0245f93af12a63378de85202cffdc2c9cc8b", "filename": "libgomp/testsuite/libgomp.oacc-fortran/privatized-ref-2.f90", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d42db533324e80a7382b20b94cace5b202d41ea/libgomp%2Ftestsuite%2Flibgomp.oacc-fortran%2Fprivatized-ref-2.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d42db533324e80a7382b20b94cace5b202d41ea/libgomp%2Ftestsuite%2Flibgomp.oacc-fortran%2Fprivatized-ref-2.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.oacc-fortran%2Fprivatized-ref-2.f90?ref=5d42db533324e80a7382b20b94cace5b202d41ea", "patch": "@@ -1,4 +1,11 @@\n-! { dg-do run { target { ! openacc_nvidia_accel_selected } } }\n+! { dg-do run }\n+\n+! PR65181 \"Support for alloca in nvptx\"\n+! { dg-excess-errors \"lto1, mkoffload and lto-wrapper fatal errors\" { target openacc_nvidia_accel_selected } }\n+! Aside from restricting this testcase to non-nvptx offloading, and duplicating\n+! it with 'dg-do link' for nvptx offloading, there doesn't seem to be a way to\n+! XFAIL the \"UNRESOLVED: [...] compilation failed to produce executable\", or\n+! get rid of it, unfortunately.\n \n program main\n   implicit none (type, external)\n@@ -24,6 +31,7 @@ subroutine foo (array, nn)\n     !$acc parallel copyout(array)\n     array = [(-i, i = 1, nn)]\n     !$acc loop gang private(array)\n+    ! { dg-message {sorry, unimplemented: target cannot support alloca} PR65181 { target openacc_nvidia_accel_selected } .-1 }\n     do i = 1, 10\n       array(i) = i\n     end do\n@@ -37,6 +45,7 @@ subroutine bar (array)\n     !$acc parallel copyout(array)\n     array = [(-2*i, i = 1, size(array))]\n     !$acc loop gang private(array)\n+    ! { dg-message {sorry, unimplemented: target cannot support alloca} PR65181 { target openacc_nvidia_accel_selected } .-1 }\n     do i = 1, 10\n       array(i) = 9*i\n     end do\n@@ -50,6 +59,7 @@ subroutine foo_str(str)\n     !$acc parallel copyout(str)\n     str = \"abcdefghij\"\n     !$acc loop gang private(str)\n+    ! { dg-message {sorry, unimplemented: target cannot support alloca} PR65181 { target openacc_nvidia_accel_selected } .-1 }\n     do i = 1, 10\n       str(i:i) = achar(ichar('A') + i)\n     end do"}]}