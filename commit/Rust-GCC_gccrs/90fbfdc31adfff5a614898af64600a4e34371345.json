{"sha": "90fbfdc31adfff5a614898af64600a4e34371345", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTBmYmZkYzMxYWRmZmY1YTYxNDg5OGFmNjQ2MDBhNGUzNDM3MTM0NQ==", "commit": {"author": {"name": "Nicola Pero", "email": "nicola.pero@meta-innovation.com", "date": "2010-10-17T21:52:09Z"}, "committer": {"name": "Nicola Pero", "email": "nicola@gcc.gnu.org", "date": "2010-10-17T21:52:09Z"}, "message": "In gcc/: 2010-10-17 Nicola Pero <nicola.pero@meta-innovation.com>\n\nIn gcc/:\n2010-10-17  Nicola Pero  <nicola.pero@meta-innovation.com>\n\n        Merge from 'apple/trunk' branch on FSF servers.\n\n        2006-03-27 Fariborz Jahanian <fjahanian@apple.com>\n\n        Radar 4133425\n        * c-decl.c (undeclared_variable): Issue diagnostic on\n        private 'ivar' access.\n\nIn gcc/c-family/:\n2010-10-17  Nicola Pero  <nicola.pero@meta-innovation.com>\n\n        Merge from 'apple/trunk' branch on FSF servers.\n\n        2006-03-27 Fariborz Jahanian <fjahanian@apple.com>\n\n        Radar 4133425\n        * c-common.h (objc_diagnose_private_ivar): New decl.\n        * stub-objc.c (objc_diagnose_private_ivar): New stub.\n\nIn gcc/cp/:\n2010-10-17  Nicola Pero  <nicola.pero@meta-innovation.com>\n\n        Merge from apple/trunk branch on FSF servers.\n\n        2006-03-27 Fariborz Jahanian <fjahanian@apple.com>\n\n        Radar 4133425\n        * lex.c (unqualified_name_lookup_error): Issue diagnostic\n        for private 'ivar' access.\n\nIn gcc/objc/:\n2010-10-17  Nicola Pero  <nicola.pero@meta-innovation.com>\n\n        Merge from 'apple/trunk' branch on FSF servers.\n\n        2006-03-27 Fariborz Jahanian <fjahanian@apple.com>\n\n        Radar 4133425\n        * objc-act.c (objc_diagnose_private_ivar): New.\n\nIn gcc/testsuite/:\n2010-10-17  Nicola Pero  <nicola.pero@meta-innovation.com>\n\n        Merge from 'apple/trunk' branch on FSF servers.\n\n        2006-03-27 Fariborz Jahanian <fjahanian@apple.com>\n\n        Radar 4133425\n        * objc.dg/private-1.m: Test modified.\n        * obj-c++.dg/private-1.mm: Test modified.\n\nFrom-SVN: r165601", "tree": {"sha": "2d6e2e2e27434afe6a8c78faa3fe2eabe7e5ee36", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2d6e2e2e27434afe6a8c78faa3fe2eabe7e5ee36"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/90fbfdc31adfff5a614898af64600a4e34371345", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/90fbfdc31adfff5a614898af64600a4e34371345", "html_url": "https://github.com/Rust-GCC/gccrs/commit/90fbfdc31adfff5a614898af64600a4e34371345", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/90fbfdc31adfff5a614898af64600a4e34371345/comments", "author": {"login": "Nico-31415", "id": 94470564, "node_id": "U_kgDOBaGBpA", "avatar_url": "https://avatars.githubusercontent.com/u/94470564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nico-31415", "html_url": "https://github.com/Nico-31415", "followers_url": "https://api.github.com/users/Nico-31415/followers", "following_url": "https://api.github.com/users/Nico-31415/following{/other_user}", "gists_url": "https://api.github.com/users/Nico-31415/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nico-31415/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nico-31415/subscriptions", "organizations_url": "https://api.github.com/users/Nico-31415/orgs", "repos_url": "https://api.github.com/users/Nico-31415/repos", "events_url": "https://api.github.com/users/Nico-31415/events{/privacy}", "received_events_url": "https://api.github.com/users/Nico-31415/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2e01b76611fdd27cfb04d3bbb1b349cbecb9230c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e01b76611fdd27cfb04d3bbb1b349cbecb9230c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2e01b76611fdd27cfb04d3bbb1b349cbecb9230c"}], "stats": {"total": 86, "additions": 80, "deletions": 6}, "files": [{"sha": "5bfe507ac026e4d7ae93d50f5ace24f2014d6541", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=90fbfdc31adfff5a614898af64600a4e34371345", "patch": "@@ -1,3 +1,13 @@\n+2010-10-17  Nicola Pero  <nicola.pero@meta-innovation.com>\n+\n+\tMerge from 'apple/trunk' branch on FSF servers.\n+\t\n+\t2006-03-27 Fariborz Jahanian <fjahanian@apple.com>\n+\n+        Radar 4133425\n+\t* c-decl.c (undeclared_variable): Issue diagnostic on\n+\tprivate 'ivar' access.\n+\t\n 2010-10-17  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR target/46051"}, {"sha": "c1a44d8eb57258fc7356f2308453b76c8e2e3c1d", "filename": "gcc/c-decl.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-decl.c?ref=90fbfdc31adfff5a614898af64600a4e34371345", "patch": "@@ -2961,7 +2961,8 @@ undeclared_variable (location_t loc, tree id)\n     }\n   else\n     {\n-      error_at (loc, \"%qE undeclared (first use in this function)\", id);\n+      if (!objc_diagnose_private_ivar (id))\n+        error_at (loc, \"%qE undeclared (first use in this function)\", id);\n       if (!already)\n \t{\n           inform (loc, \"each undeclared identifier is reported only\""}, {"sha": "ec54c09e659c695d5ac559259946a0106449290e", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=90fbfdc31adfff5a614898af64600a4e34371345", "patch": "@@ -1,3 +1,13 @@\n+2010-10-17  Nicola Pero  <nicola.pero@meta-innovation.com>\n+\n+\tMerge from 'apple/trunk' branch on FSF servers.\t\t\n+\n+\t2006-03-27 Fariborz Jahanian <fjahanian@apple.com>\n+\n+        Radar 4133425\n+\t* c-common.h (objc_diagnose_private_ivar): New decl.\n+\t* stub-objc.c (objc_diagnose_private_ivar): New stub.\t\n+\n 2010-10-17  Iain Sandoe  <iains@gcc.gnu.org>\n \n \t* c-common.c (c_common_reswords): Add package, RID_AT_PACKAGE."}, {"sha": "2a58c6c73d387dc4a7f4b3f7fe1bcbe6bb061f8b", "filename": "gcc/c-family/c-common.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Fc-family%2Fc-common.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Fc-family%2Fc-common.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-common.h?ref=90fbfdc31adfff5a614898af64600a4e34371345", "patch": "@@ -987,6 +987,7 @@ extern void objc_check_global_decl (tree);\n extern tree objc_common_type (tree, tree);\n extern bool objc_compare_types (tree, tree, int, tree);\n extern bool objc_have_common_type (tree, tree, int, tree);\n+extern bool objc_diagnose_private_ivar (tree);\n extern void objc_volatilize_decl (tree);\n extern bool objc_type_quals_match (tree, tree);\n extern tree objc_rewrite_function_call (tree, tree);"}, {"sha": "c6a8cfad4e68afe04dc76c0b7ba3249d31d90c9a", "filename": "gcc/c-family/stub-objc.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Fc-family%2Fstub-objc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Fc-family%2Fstub-objc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fstub-objc.c?ref=90fbfdc31adfff5a614898af64600a4e34371345", "patch": "@@ -44,6 +44,11 @@ objc_is_object_ptr (tree ARG_UNUSED (arg))\n   return 0;\n }\n \n+bool objc_diagnose_private_ivar (tree ARG_UNUSED (arg))\n+{\n+  return false;\n+}\n+\n tree\n objc_lookup_ivar (tree other, tree ARG_UNUSED (arg))\n {"}, {"sha": "fc26e00d34f3b3aa59fe7dc3a5d5fc0ce4c64a24", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=90fbfdc31adfff5a614898af64600a4e34371345", "patch": "@@ -1,3 +1,13 @@\n+2010-10-17  Nicola Pero  <nicola.pero@meta-innovation.com>\n+\t\n+\tMerge from apple/trunk branch on FSF servers.\n+\t\n+\t2006-03-27 Fariborz Jahanian <fjahanian@apple.com>\n+\n+        Radar 4133425\n+\t* lex.c (unqualified_name_lookup_error): Issue diagnostic\n+\tfor private 'ivar' access.\n+\t\n 2010-10-17  Iain Sandoe  <iains@gcc.gnu.org>\n \n \t* parser.c (cp_parser_objc_visibility_spec): Update to use visibility "}, {"sha": "c583d7d307e80bc3e1a0091c2fd1628c9e9fa73a", "filename": "gcc/cp/lex.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Fcp%2Flex.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Fcp%2Flex.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Flex.c?ref=90fbfdc31adfff5a614898af64600a4e34371345", "patch": "@@ -449,7 +449,8 @@ unqualified_name_lookup_error (tree name)\n     }\n   else\n     {\n-      error (\"%qD was not declared in this scope\", name);\n+      if (!objc_diagnose_private_ivar (name))\n+        error (\"%qD was not declared in this scope\", name);\n       /* Prevent repeated error messages by creating a VAR_DECL with\n \t this NAME in the innermost block scope.  */\n       if (current_function_decl)"}, {"sha": "83bef4deecb9480eb8dc3c94fde64c68516e89f9", "filename": "gcc/objc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Fobjc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Fobjc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fobjc%2FChangeLog?ref=90fbfdc31adfff5a614898af64600a4e34371345", "patch": "@@ -1,3 +1,12 @@\n+2010-10-17  Nicola Pero  <nicola.pero@meta-innovation.com>\n+\n+\tMerge from 'apple/trunk' branch on FSF servers.\n+\t\n+\t2006-03-27 Fariborz Jahanian <fjahanian@apple.com>\n+\n+\tRadar 4133425\n+\t* objc-act.c (objc_diagnose_private_ivar): New.\n+\n 2010-10-17  Iain Sandoe  <iains@gcc.gnu.org>\n \n \t* objc-act.c: Rename 'objc_public_flag' to  objc_ivar_visibility and"}, {"sha": "904095495dbac0df8514b2895909baebc2790043", "filename": "gcc/objc/objc-act.c", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Fobjc%2Fobjc-act.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Fobjc%2Fobjc-act.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fobjc%2Fobjc-act.c?ref=90fbfdc31adfff5a614898af64600a4e34371345", "patch": "@@ -10821,6 +10821,25 @@ generate_objc_image_info (void)\n   finish_var_decl (decl, objc_build_constructor (TREE_TYPE (decl), v));\n }\n \n+/* Routine is called to issue diagnostic when reference to a private \n+   ivar is made and no other variable with same name is found in \n+   current scope.  */\n+bool\n+objc_diagnose_private_ivar (tree id)\n+{\n+  tree ivar;\n+  if (!objc_method_context)\n+    return false;\n+  ivar = is_ivar (objc_ivar_chain, id);\n+  if (ivar && is_private (ivar))\n+    {\n+      error (\"instance variable %qs is declared private\", \n+\t     IDENTIFIER_POINTER (id));\n+      return true;\n+    }\n+  return false;\n+}\n+\n /* Look up ID as an instance variable.  OTHER contains the result of\n    the C or C++ lookup, which we may want to use instead.  */\n /* Also handle use of property as setter/getter. */"}, {"sha": "dfdaa82e26e27bce38f70245364bafda28a5fc37", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=90fbfdc31adfff5a614898af64600a4e34371345", "patch": "@@ -1,3 +1,13 @@\n+2010-10-17  Nicola Pero  <nicola.pero@meta-innovation.com>\n+\t\n+\tMerge from 'apple/trunk' branch on FSF servers.\n+\n+\t2006-03-27 Fariborz Jahanian <fjahanian@apple.com>\n+\n+\tRadar 4133425\n+\t* objc.dg/private-1.m: Test modified.\n+\t* obj-c++.dg/private-1.mm: Test modified.\n+\t\n 2010-10-17  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR testsuite/45987"}, {"sha": "cd423b55127c378e101bd6c5c5d7c3d4cbd16e8d", "filename": "gcc/testsuite/obj-c++.dg/private-1.mm", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Ftestsuite%2Fobj-c%2B%2B.dg%2Fprivate-1.mm", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Ftestsuite%2Fobj-c%2B%2B.dg%2Fprivate-1.mm", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fobj-c%2B%2B.dg%2Fprivate-1.mm?ref=90fbfdc31adfff5a614898af64600a4e34371345", "patch": "@@ -1,8 +1,6 @@\n /* Test errors for accessing @private and @protected variables.  */\n /* Based on work by: Nicola Pero <nicola@brainstorm.co.uk>.  */\n-\n /* { dg-do compile } */\n-\n #include <objc/objc.h>\n \n @interface MySuperClass\n@@ -36,7 +34,7 @@ @implementation MyClass\n - (void) test\n {\n   /* Private variables simply don't exist in the subclass.  */\n-  _private = 12; /* { dg-error \"._private. was not declared in this scope\" } */\n+  _private = 12; /* { dg-error \"instance variable \\\\'_private\\\\' is declared private\" } */\n \n   _protected = 12; /* Ok  */\n   _public = 12;    /* Ok  */"}, {"sha": "a11183c8ea6ba463fd60f1faa0f117ab77bf0f3f", "filename": "gcc/testsuite/objc.dg/private-1.m", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Ftestsuite%2Fobjc.dg%2Fprivate-1.m", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90fbfdc31adfff5a614898af64600a4e34371345/gcc%2Ftestsuite%2Fobjc.dg%2Fprivate-1.m", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fobjc.dg%2Fprivate-1.m?ref=90fbfdc31adfff5a614898af64600a4e34371345", "patch": "@@ -34,7 +34,7 @@ @implementation MyClass\n - (void) test\n {\n   /* Private variables simply don't exist in the subclass.  */\n-  private = 12;/* { dg-error \"undeclared\" } */\n+  private = 12;  /* { dg-error \"instance variable\" } */\n   /* { dg-message \"function it appears in\" \"\" { target *-*-* } { 37 } } */\n \n   protected = 12; /* Ok  */"}]}