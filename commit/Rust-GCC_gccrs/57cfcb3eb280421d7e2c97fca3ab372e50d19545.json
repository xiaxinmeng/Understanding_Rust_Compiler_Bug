{"sha": "57cfcb3eb280421d7e2c97fca3ab372e50d19545", "node_id": "C_kwDOANBUbNoAKDU3Y2ZjYjNlYjI4MDQyMWQ3ZTJjOTdmY2EzYWIzNzJlNTBkMTk1NDU", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2022-01-14T09:25:50Z"}, "committer": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2022-01-17T10:23:17Z"}, "message": "Start using check-MAINTAINERS.py instead of legacy maintainers-verify.sh.\n\ncontrib/ChangeLog:\n\n\t* maintainers-verify.sh: Removed.\n\ngcc/testsuite/ChangeLog:\n\n\t* gcc.src/maintainers.exp: Start using check-MAINTAINERS.py.\n\t* lib/target-supports.exp: Add check_effective_target_python3.", "tree": {"sha": "3d561ec87266d4dd386fba4a3788ef0bed171232", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3d561ec87266d4dd386fba4a3788ef0bed171232"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/57cfcb3eb280421d7e2c97fca3ab372e50d19545", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57cfcb3eb280421d7e2c97fca3ab372e50d19545", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57cfcb3eb280421d7e2c97fca3ab372e50d19545", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57cfcb3eb280421d7e2c97fca3ab372e50d19545/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d4c02ec777943c88378c1357d9cd6cfb0433c1bc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d4c02ec777943c88378c1357d9cd6cfb0433c1bc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d4c02ec777943c88378c1357d9cd6cfb0433c1bc"}], "stats": {"total": 75, "additions": 23, "deletions": 52}, "files": [{"sha": "226c158fdaaa7f3b306ab71bca1378c318779046", "filename": "contrib/maintainers-verify.sh", "status": "removed", "additions": 0, "deletions": 45, "changes": 45, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d4c02ec777943c88378c1357d9cd6cfb0433c1bc/contrib%2Fmaintainers-verify.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d4c02ec777943c88378c1357d9cd6cfb0433c1bc/contrib%2Fmaintainers-verify.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fmaintainers-verify.sh?ref=d4c02ec777943c88378c1357d9cd6cfb0433c1bc", "patch": "@@ -1,45 +0,0 @@\n-#!/bin/sh\n-\n-# Copyright (C) 2018 Free Software Foundation, Inc.\n-#\n-# This file is part of GCC.\n-#\n-# GCC is free software; you can redistribute it and/or modify\n-# it under the terms of the GNU General Public License as published by\n-# the Free Software Foundation; either version 3, or (at your option)\n-# any later version.\n-#\n-# GCC is distributed in the hope that it will be useful,\n-# but WITHOUT ANY WARRANTY; without even the implied warranty of\n-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-# GNU General Public License for more details.\n-#\n-# You should have received a copy of the GNU General Public License\n-# along with GCC; see the file COPYING.  If not, write to\n-# the Free Software Foundation, 51 Franklin Street, Fifth Floor,\n-# Boston, MA 02110-1301, USA.\n-\n-if [ \"$1\" != \"\" ]; then\n-    f=\"$1\"\n-else\n-    f=./MAINTAINERS\n-fi\n-\n-grep @ $f \\\n-    | sed 's/[\\t][\\t]*/\\t/g' \\\n-    | awk -F '\\t' \\\n-\t  \"\n-{\n-  if (NF == 2) {\n-    name=\\$1\n-    email=\\$2\n-    if (names[name] == 1) {\n-        printf \\\"Redundant in write approval: %s\\n\\\", name\n-    }\n-  } else if (NF == 3 ) {\n-    name=\\$2\n-    email=\\$3\n-    names[name] = 1\n-  }\n-}\n-\""}, {"sha": "63361dd5e4b37c31c3317cf5b00dc5600a7abf6e", "filename": "gcc/testsuite/gcc.src/maintainers.exp", "status": "modified", "additions": 11, "deletions": 7, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57cfcb3eb280421d7e2c97fca3ab372e50d19545/gcc%2Ftestsuite%2Fgcc.src%2Fmaintainers.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57cfcb3eb280421d7e2c97fca3ab372e50d19545/gcc%2Ftestsuite%2Fgcc.src%2Fmaintainers.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.src%2Fmaintainers.exp?ref=57cfcb3eb280421d7e2c97fca3ab372e50d19545", "patch": "@@ -14,22 +14,27 @@\n # along with GCC; see the file COPYING3.  If not see\n # <http://www.gnu.org/licenses/>.\n \n-load_lib \"gcc-defs.exp\"\n+load_lib \"target-supports.exp\"\n \n proc gcc_src_run_maintainers_verify_sh {} {\n-    set script maintainers-verify.sh\n+    set script check-MAINTAINERS.py\n \n     global srcdir\n     set rootdir $srcdir/../..\n     set contrib $rootdir/contrib\n-\n     set maintainers $rootdir/MAINTAINERS\n \n-    set verify_output [exec $contrib/$script $maintainers]\n-    if { \"$verify_output\"  == \"\" } {\n+    if { ![check_effective_target_python3] } {\n+      unsupported \"$script python3 is missing\"\n+      return\n+    }\n+\n+    set result [remote_exec host $contrib/$script $maintainers]\n+    set status [lindex $result 0]\n+    if { $status == 0 } then {\n \tpass \"$script\"\n     } else {\n-\tsend_log \"$verify_output\\n\"\n+\tsend_log \"$result\\n\"\n \tfail \"$script\"\n     }\n }\n@@ -40,4 +45,3 @@ if ![gcc_parallel_test_run_p maintainers] {\n gcc_parallel_test_enable 0\n gcc_src_run_maintainers_verify_sh\n gcc_parallel_test_enable 1\n-"}, {"sha": "12c5ca5da33f9617e966c19d0052bb8ccaceaea7", "filename": "gcc/testsuite/lib/target-supports.exp", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57cfcb3eb280421d7e2c97fca3ab372e50d19545/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57cfcb3eb280421d7e2c97fca3ab372e50d19545/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp?ref=57cfcb3eb280421d7e2c97fca3ab372e50d19545", "patch": "@@ -11722,3 +11722,15 @@ proc check_effective_target___OPTIMIZE__ {} {\n \t#endif\n     } [current_compiler_flags]]\n }\n+\n+# Return 1 if python3 is available.\n+\n+proc check_effective_target_python3 { } {\n+    set result [remote_exec host \"python3 --version\"]\n+    set status [lindex $result 0]\n+    if { $status == 0 } then {\n+        return 1;\n+    } else {\n+        return 0;\n+    }\n+}"}]}