{"sha": "c18e9f65faeb5ea78af6d703c2e5b4e60de0485c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzE4ZTlmNjVmYWViNWVhNzhhZjZkNzAzYzJlNWI0ZTYwZGUwNDg1Yw==", "commit": {"author": {"name": "Tristan Gingold", "email": "gingold@adacore.com", "date": "2012-10-29T10:52:28Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2012-10-29T10:52:28Z"}, "message": "bindgen.adb (Gen_Output_File_Ada): Do not emit declaration for Is_Elaborated if not referenced.\n\n2012-10-29  Tristan Gingold  <gingold@adacore.com>\n\n\t* bindgen.adb (Gen_Output_File_Ada): Do not emit declaration for\n\tIs_Elaborated if not referenced.\n\n2012-10-29  Tristan Gingold  <gingold@adacore.com>\n\n\t* exp_ch9.adb (Build_Activation_Chain_Entity): Punt in restricted\n\tprofile.\n\t* exp_ch3.adb (Build_Initialization_Call): Do no append _Chain\n\tparameter in restricted profile.\n\t(Build_Init_Call_Thru): Likewise.\n\t(Init_Formals): Likewise.\n\t* exp_ch3.adb: Minor reformatting.\n\nFrom-SVN: r192925", "tree": {"sha": "c984dd33ef86b98862cf158e113906ed181216b1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c984dd33ef86b98862cf158e113906ed181216b1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c18e9f65faeb5ea78af6d703c2e5b4e60de0485c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c18e9f65faeb5ea78af6d703c2e5b4e60de0485c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c18e9f65faeb5ea78af6d703c2e5b4e60de0485c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c18e9f65faeb5ea78af6d703c2e5b4e60de0485c/comments", "author": {"login": "gingold-adacore", "id": 16334725, "node_id": "MDQ6VXNlcjE2MzM0NzI1", "avatar_url": "https://avatars.githubusercontent.com/u/16334725?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gingold-adacore", "html_url": "https://github.com/gingold-adacore", "followers_url": "https://api.github.com/users/gingold-adacore/followers", "following_url": "https://api.github.com/users/gingold-adacore/following{/other_user}", "gists_url": "https://api.github.com/users/gingold-adacore/gists{/gist_id}", "starred_url": "https://api.github.com/users/gingold-adacore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gingold-adacore/subscriptions", "organizations_url": "https://api.github.com/users/gingold-adacore/orgs", "repos_url": "https://api.github.com/users/gingold-adacore/repos", "events_url": "https://api.github.com/users/gingold-adacore/events{/privacy}", "received_events_url": "https://api.github.com/users/gingold-adacore/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c607e6d50ef2dee78cdbf008f763c4098acb185a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c607e6d50ef2dee78cdbf008f763c4098acb185a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c607e6d50ef2dee78cdbf008f763c4098acb185a"}], "stats": {"total": 87, "additions": 64, "deletions": 23}, "files": [{"sha": "7bc26c6a8a1127760e06f6d217ba7771d99d081c", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c18e9f65faeb5ea78af6d703c2e5b4e60de0485c/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c18e9f65faeb5ea78af6d703c2e5b4e60de0485c/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=c18e9f65faeb5ea78af6d703c2e5b4e60de0485c", "patch": "@@ -1,3 +1,18 @@\n+2012-10-29  Tristan Gingold  <gingold@adacore.com>\n+\n+\t* bindgen.adb (Gen_Output_File_Ada): Do not emit declaration for\n+\tIs_Elaborated if not referenced.\n+\n+2012-10-29  Tristan Gingold  <gingold@adacore.com>\n+\n+\t* exp_ch9.adb (Build_Activation_Chain_Entity): Punt in restricted\n+\tprofile.\n+\t* exp_ch3.adb (Build_Initialization_Call): Do no append _Chain\n+\tparameter in restricted profile.\n+\t(Build_Init_Call_Thru): Likewise.\n+\t(Init_Formals): Likewise.\n+\t* exp_ch3.adb: Minor reformatting.\n+\n 2012-10-29  Arnaud Charlet  <charlet@adacore.com>\n \n \t* usage.adb: Update usage line for -gnatw.k."}, {"sha": "e178a57a21b9fd50d184e0c01e13d8607959f3fe", "filename": "gcc/ada/bindgen.adb", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c18e9f65faeb5ea78af6d703c2e5b4e60de0485c/gcc%2Fada%2Fbindgen.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c18e9f65faeb5ea78af6d703c2e5b4e60de0485c/gcc%2Fada%2Fbindgen.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fbindgen.adb?ref=c18e9f65faeb5ea78af6d703c2e5b4e60de0485c", "patch": "@@ -2394,8 +2394,13 @@ package body Bindgen is\n \n          --  The B.1 (39) implementation advice says that the adainit/adafinal\n          --  routines should be idempotent. Generate a flag to ensure that.\n+         --  This is not needed if we are suppressing the standard library\n+         --  since it would never be referenced.\n+\n+         if not Suppress_Standard_Library_On_Target then\n+            WBI (\"   Is_Elaborated : Boolean := False;\");\n+         end if;\n \n-         WBI (\"   Is_Elaborated : Boolean := False;\");\n          WBI (\"\");\n       end if;\n "}, {"sha": "9911d213bf2351bf5bad14a7f5185a63dce07a03", "filename": "gcc/ada/exp_ch3.adb", "status": "modified", "additions": 37, "deletions": 22, "changes": 59, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c18e9f65faeb5ea78af6d703c2e5b4e60de0485c/gcc%2Fada%2Fexp_ch3.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c18e9f65faeb5ea78af6d703c2e5b4e60de0485c/gcc%2Fada%2Fexp_ch3.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch3.adb?ref=c18e9f65faeb5ea78af6d703c2e5b4e60de0485c", "patch": "@@ -1537,7 +1537,12 @@ package body Exp_Ch3 is\n             Append_To (Args, Make_Identifier (Loc, Name_uMaster));\n          end if;\n \n-         Append_To (Args, Make_Identifier (Loc, Name_uChain));\n+         if not Restricted_Profile then\n+\n+            --  No _Chain for restricted profile\n+\n+            Append_To (Args, Make_Identifier (Loc, Name_uChain));\n+         end if;\n \n          --  Ada 2005 (AI-287): In case of default initialized components\n          --  with tasks, we generate a null string actual parameter.\n@@ -1987,7 +1992,13 @@ package body Exp_Ch3 is\n                Append_To (Args, Make_Identifier (Loc, Name_uMaster));\n             end if;\n \n-            Append_To (Args, Make_Identifier (Loc, Name_uChain));\n+            if not Restricted_Profile then\n+\n+               --  No _Chain for restricted profile\n+\n+               Append_To (Args, Make_Identifier (Loc, Name_uChain));\n+            end if;\n+\n             Append_To (Args, Make_Identifier (Loc, Name_uTask_Name));\n             First_Discr_Param := Next (Next (Next (First_Discr_Param)));\n          end if;\n@@ -7791,24 +7802,29 @@ package body Exp_Ch3 is\n            Make_Parameter_Specification (Loc,\n              Defining_Identifier =>\n                Make_Defining_Identifier (Loc, Name_uMaster),\n-             Parameter_Type => New_Reference_To (RTE (RE_Master_Id), Loc)));\n+             Parameter_Type      =>\n+               New_Reference_To (RTE (RE_Master_Id), Loc)));\n \n-         Append_To (Formals,\n-           Make_Parameter_Specification (Loc,\n-             Defining_Identifier =>\n-               Make_Defining_Identifier (Loc, Name_uChain),\n-             In_Present => True,\n-             Out_Present => True,\n-             Parameter_Type =>\n-               New_Reference_To (RTE (RE_Activation_Chain), Loc)));\n+         if not Restricted_Profile then\n+\n+            --  No _Chain for restricted profile\n+\n+            Append_To (Formals,\n+              Make_Parameter_Specification (Loc,\n+                Defining_Identifier =>\n+                  Make_Defining_Identifier (Loc, Name_uChain),\n+                In_Present          => True,\n+                Out_Present         => True,\n+                Parameter_Type      =>\n+                  New_Reference_To (RTE (RE_Activation_Chain), Loc)));\n+         end if;\n \n          Append_To (Formals,\n            Make_Parameter_Specification (Loc,\n              Defining_Identifier =>\n                Make_Defining_Identifier (Loc, Name_uTask_Name),\n-             In_Present => True,\n-             Parameter_Type =>\n-               New_Reference_To (Standard_String, Loc)));\n+             In_Present          => True,\n+             Parameter_Type      => New_Reference_To (Standard_String, Loc)));\n       end if;\n \n       return Formals;\n@@ -7907,7 +7923,7 @@ package body Exp_Ch3 is\n                           (RTE (RE_Set_Dynamic_Offset_To_Top), Loc),\n                 Parameter_Associations => New_List (\n                   Make_Attribute_Reference (Loc,\n-                    Prefix => New_Copy_Tree (Target),\n+                    Prefix         => New_Copy_Tree (Target),\n                     Attribute_Name => Name_Address),\n \n                   Unchecked_Convert_To (RTE (RE_Tag),\n@@ -7920,7 +7936,7 @@ package body Exp_Ch3 is\n                      Make_Attribute_Reference (Loc,\n                        Prefix         =>\n                          Make_Selected_Component (Loc,\n-                           Prefix => New_Copy_Tree (Target),\n+                           Prefix        => New_Copy_Tree (Target),\n                            Selector_Name =>\n                              New_Reference_To (Tag_Comp, Loc)),\n                        Attribute_Name => Name_Position)),\n@@ -7946,18 +7962,17 @@ package body Exp_Ch3 is\n                                        (Offset_To_Top_Comp, Loc)),\n                 Expression =>\n                   Make_Attribute_Reference (Loc,\n-                    Prefix         =>\n+                    Prefix       =>\n                       Make_Selected_Component (Loc,\n-                        Prefix => New_Copy_Tree (Target),\n-                        Selector_Name =>\n-                          New_Reference_To (Tag_Comp, Loc)),\n+                        Prefix        => New_Copy_Tree (Target),\n+                        Selector_Name => New_Reference_To (Tag_Comp, Loc)),\n                   Attribute_Name => Name_Position)));\n \n          --  Normal case: No discriminants in the parent type\n \n          else\n-            --  Don't need to set any value if this interface shares\n-            --  the primary dispatch table.\n+            --  Don't need to set any value if this interface shares the\n+            --  primary dispatch table.\n \n             if not Is_Ancestor (Iface, Typ, Use_Full_View => True) then\n                Append_To (Stmts_List,"}, {"sha": "b39484fc1ef12ee96d1c115e345a5f67d4e777e6", "filename": "gcc/ada/exp_ch9.adb", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c18e9f65faeb5ea78af6d703c2e5b4e60de0485c/gcc%2Fada%2Fexp_ch9.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c18e9f65faeb5ea78af6d703c2e5b4e60de0485c/gcc%2Fada%2Fexp_ch9.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch9.adb?ref=c18e9f65faeb5ea78af6d703c2e5b4e60de0485c", "patch": "@@ -911,6 +911,12 @@ package body Exp_Ch9 is\n    --  Start of processing for Build_Activation_Chain_Entity\n \n    begin\n+      --  Activation chain is never used in restricted profile\n+\n+      if Restricted_Profile then\n+         return;\n+      end if;\n+\n       Find_Enclosing_Context (N, Context, Context_Id, Decls);\n \n       --  If an activation chain entity has not been declared already, create"}]}