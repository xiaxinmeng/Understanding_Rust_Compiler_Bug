{"sha": "802ac282f819054e10ac5dca06881b6dca909cdb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODAyYWMyODJmODE5MDU0ZTEwYWM1ZGNhMDY4ODFiNmRjYTkwOWNkYg==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2015-03-09T11:57:33Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2015-03-09T11:57:33Z"}, "message": "c-convert.c (convert): Make use of do_ubsan_in_current_function.\n\n\t* c-convert.c (convert): Make use of do_ubsan_in_current_function.\n\t* c-decl.c (grokdeclarator): Likewise.\n\t* c-typeck.c (build_binary_op): Likewise.\n\nFrom-SVN: r221278", "tree": {"sha": "87c8562a9a465e2be6cfd41ae229a30fba710f11", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/87c8562a9a465e2be6cfd41ae229a30fba710f11"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/802ac282f819054e10ac5dca06881b6dca909cdb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/802ac282f819054e10ac5dca06881b6dca909cdb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/802ac282f819054e10ac5dca06881b6dca909cdb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/802ac282f819054e10ac5dca06881b6dca909cdb/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e0d514da7ba05dabd279fee99a1ef8f40f098ab0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0d514da7ba05dabd279fee99a1ef8f40f098ab0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e0d514da7ba05dabd279fee99a1ef8f40f098ab0"}], "stats": {"total": 19, "additions": 9, "deletions": 10}, "files": [{"sha": "a5fcb35e32f2cfdcd858ed90a59e1608485d75c7", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/802ac282f819054e10ac5dca06881b6dca909cdb/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/802ac282f819054e10ac5dca06881b6dca909cdb/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=802ac282f819054e10ac5dca06881b6dca909cdb", "patch": "@@ -1,3 +1,9 @@\n+2015-03-09  Marek Polacek  <polacek@redhat.com>\n+\n+\t* c-convert.c (convert): Make use of do_ubsan_in_current_function.\n+\t* c-decl.c (grokdeclarator): Likewise.\n+\t* c-typeck.c (build_binary_op): Likewise.\n+\n 2015-02-27  Marek Polacek  <polacek@redhat.com>\n \n \tPR c/65228"}, {"sha": "27fc3fc0e8edd1579dd704d32287468f8260053e", "filename": "gcc/c/c-convert.c", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/802ac282f819054e10ac5dca06881b6dca909cdb/gcc%2Fc%2Fc-convert.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/802ac282f819054e10ac5dca06881b6dca909cdb/gcc%2Fc%2Fc-convert.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-convert.c?ref=802ac282f819054e10ac5dca06881b6dca909cdb", "patch": "@@ -121,9 +121,7 @@ convert (tree type, tree expr)\n       if (flag_sanitize & SANITIZE_FLOAT_CAST\n \t  && TREE_CODE (TREE_TYPE (expr)) == REAL_TYPE\n \t  && COMPLETE_TYPE_P (type)\n-\t  && current_function_decl != NULL_TREE\n-\t  && !lookup_attribute (\"no_sanitize_undefined\",\n-\t\t\t\tDECL_ATTRIBUTES (current_function_decl)))\n+\t  && do_ubsan_in_current_function ())\n \t{\n \t  tree arg;\n \t  if (in_late_binary_op)"}, {"sha": "c140837f1392b33b5020ca0fe71111f126c390f0", "filename": "gcc/c/c-decl.c", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/802ac282f819054e10ac5dca06881b6dca909cdb/gcc%2Fc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/802ac282f819054e10ac5dca06881b6dca909cdb/gcc%2Fc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-decl.c?ref=802ac282f819054e10ac5dca06881b6dca909cdb", "patch": "@@ -5837,10 +5837,7 @@ grokdeclarator (const struct c_declarator *declarator,\n \t\t    warn_variable_length_array (name, size);\n \t\t    if (flag_sanitize & SANITIZE_VLA\n \t\t        && decl_context == NORMAL\n-\t\t\t&& current_function_decl != NULL_TREE\n-\t\t\t&& !lookup_attribute (\"no_sanitize_undefined\",\n-\t\t\t\t\t      DECL_ATTRIBUTES\n-\t\t\t\t\t\t(current_function_decl)))\n+\t\t\t&& do_ubsan_in_current_function ())\n \t\t      {\n \t\t\t/* Evaluate the array size only once.  */\n \t\t\tsize = c_save_expr (size);"}, {"sha": "7c6d974a4867e5722662832c51f4b52a72c6ce8d", "filename": "gcc/c/c-typeck.c", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/802ac282f819054e10ac5dca06881b6dca909cdb/gcc%2Fc%2Fc-typeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/802ac282f819054e10ac5dca06881b6dca909cdb/gcc%2Fc%2Fc-typeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-typeck.c?ref=802ac282f819054e10ac5dca06881b6dca909cdb", "patch": "@@ -11229,9 +11229,7 @@ build_binary_op (location_t location, enum tree_code code,\n \n   if ((flag_sanitize & (SANITIZE_SHIFT | SANITIZE_DIVIDE\n \t\t\t| SANITIZE_FLOAT_DIVIDE))\n-      && current_function_decl != 0\n-      && !lookup_attribute (\"no_sanitize_undefined\",\n-\t\t\t    DECL_ATTRIBUTES (current_function_decl))\n+      && do_ubsan_in_current_function ()\n       && (doing_div_or_mod || doing_shift))\n     {\n       /* OP0 and/or OP1 might have side-effects.  */"}]}