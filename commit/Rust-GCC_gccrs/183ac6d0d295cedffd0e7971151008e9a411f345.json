{"sha": "183ac6d0d295cedffd0e7971151008e9a411f345", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTgzYWM2ZDBkMjk1Y2VkZmZkMGU3OTcxMTUxMDA4ZTlhNDExZjM0NQ==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2016-08-11T09:02:04Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2016-08-11T09:02:04Z"}, "message": "re PR tree-optimization/72772 (Missed SCEV after pass reordering@236440)\n\n2016-08-11  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/72772\n\t* cfgloopmanip.c (create_preheader): Use split_edge if there\n\tis a single loop entry, avoiding degenerate PHIs.\n\n\t* gcc.dg/graphite/pr35356-1.c: Adjust.\n\t* gcc.dg/tree-ssa/pr59597.c: Likewise.\n\nFrom-SVN: r239357", "tree": {"sha": "8d5fbd4bacf84fae62437497b5b8a89b8f7f2ed5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8d5fbd4bacf84fae62437497b5b8a89b8f7f2ed5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/183ac6d0d295cedffd0e7971151008e9a411f345", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/183ac6d0d295cedffd0e7971151008e9a411f345", "html_url": "https://github.com/Rust-GCC/gccrs/commit/183ac6d0d295cedffd0e7971151008e9a411f345", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/183ac6d0d295cedffd0e7971151008e9a411f345/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b152f5a2b33b251ab1874a43d97ce73d11eec0a4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b152f5a2b33b251ab1874a43d97ce73d11eec0a4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b152f5a2b33b251ab1874a43d97ce73d11eec0a4"}], "stats": {"total": 32, "additions": 25, "deletions": 7}, "files": [{"sha": "4984f50d51d46f0ec550991295b906e8d50209fd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/183ac6d0d295cedffd0e7971151008e9a411f345/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/183ac6d0d295cedffd0e7971151008e9a411f345/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=183ac6d0d295cedffd0e7971151008e9a411f345", "patch": "@@ -1,3 +1,9 @@\n+2016-08-11  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/72772\n+\t* cfgloopmanip.c (create_preheader): Use split_edge if there\n+\tis a single loop entry, avoiding degenerate PHIs.\n+\n 2016-08-11  Richard Biener  <rguenther@suse.de>\n \n \t* tree-ssa-threadbackward.c (pass_data_thread_jumps): Remove"}, {"sha": "487b91df0e5dfa4ade3ff79b478081634ec100d3", "filename": "gcc/cfgloopmanip.c", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/183ac6d0d295cedffd0e7971151008e9a411f345/gcc%2Fcfgloopmanip.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/183ac6d0d295cedffd0e7971151008e9a411f345/gcc%2Fcfgloopmanip.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgloopmanip.c?ref=183ac6d0d295cedffd0e7971151008e9a411f345", "patch": "@@ -1497,7 +1497,7 @@ has_preds_from_loop (basic_block block, struct loop *loop)\n basic_block\n create_preheader (struct loop *loop, int flags)\n {\n-  edge e, fallthru;\n+  edge e;\n   basic_block dummy;\n   int nentry = 0;\n   bool irred = false;\n@@ -1544,9 +1544,14 @@ create_preheader (struct loop *loop, int flags)\n \n   mfb_kj_edge = loop_latch_edge (loop);\n   latch_edge_was_fallthru = (mfb_kj_edge->flags & EDGE_FALLTHRU) != 0;\n-  fallthru = make_forwarder_block (loop->header, mfb_keep_just, NULL);\n-  dummy = fallthru->src;\n-  loop->header = fallthru->dest;\n+  if (nentry == 1)\n+    dummy = split_edge (single_entry);\n+  else\n+    {\n+      edge fallthru = make_forwarder_block (loop->header, mfb_keep_just, NULL);\n+      dummy = fallthru->src;\n+      loop->header = fallthru->dest;\n+    }\n \n   /* Try to be clever in placing the newly created preheader.  The idea is to\n      avoid breaking any \"fallthruness\" relationship between blocks."}, {"sha": "00cdc8f6ae09af7c96ddb84ce1bf5f8af872974b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/183ac6d0d295cedffd0e7971151008e9a411f345/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/183ac6d0d295cedffd0e7971151008e9a411f345/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=183ac6d0d295cedffd0e7971151008e9a411f345", "patch": "@@ -1,3 +1,9 @@\n+2016-08-11  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/72772\n+\t* gcc.dg/graphite/pr35356-1.c: Adjust.\n+\t* gcc.dg/tree-ssa/pr59597.c: Likewise.\n+\n 2016-08-11  Janne Blomqvist  <jb@gcc.gnu.org>\n \n \t* gfortran.dg/random_7.f90: Take into account that the last seed"}, {"sha": "9b633d27a37b74b432f37fb219b3edab9a8584a7", "filename": "gcc/testsuite/gcc.dg/graphite/pr35356-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/183ac6d0d295cedffd0e7971151008e9a411f345/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fpr35356-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/183ac6d0d295cedffd0e7971151008e9a411f345/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fpr35356-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fpr35356-1.c?ref=183ac6d0d295cedffd0e7971151008e9a411f345", "patch": "@@ -34,4 +34,4 @@ if (n >= k + 1 && k >= 0) {\n \n */\n \n-/* { dg-final { scan-tree-dump \"if \\\\\\(P_9 >= P_10 \\\\\\+ 1 && P_10 >= 0\\\\\\) \\\\\\{\" \"graphite\" } } */\n+/* { dg-final { scan-tree-dump \"if \\\\\\(P_8 >= P_9 \\\\\\+ 1 && P_9 >= 0\\\\\\) \\\\\\{\" \"graphite\" } } */"}, {"sha": "4ac12c8c15cf47f1bb61e57835f02c7bd3dd41f7", "filename": "gcc/testsuite/gcc.dg/tree-ssa/pr59597.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/183ac6d0d295cedffd0e7971151008e9a411f345/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr59597.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/183ac6d0d295cedffd0e7971151008e9a411f345/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr59597.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr59597.c?ref=183ac6d0d295cedffd0e7971151008e9a411f345", "patch": "@@ -54,5 +54,6 @@ main (int argc, char argv[])\n   return crc;\n }\n \n-/* { dg-final { scan-tree-dump \"Cancelling\" \"vrp1\" } } */\n-\n+/* { dg-final { scan-tree-dump-times \"Registering jump thread\" 3 \"vrp1\" } } */\n+/* { dg-final { scan-tree-dump-not \"joiner\" \"vrp1\" } } */\n+/* { dg-final { scan-tree-dump-times \"Threaded jump\" 3 \"vrp1\" } } */"}]}