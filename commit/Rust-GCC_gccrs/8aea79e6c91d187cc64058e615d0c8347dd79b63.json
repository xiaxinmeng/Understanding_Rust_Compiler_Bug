{"sha": "8aea79e6c91d187cc64058e615d0c8347dd79b63", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGFlYTc5ZTZjOTFkMTg3Y2M2NDA1OGU2MTVkMGM4MzQ3ZGQ3OWI2Mw==", "commit": {"author": {"name": "Rafael Avila de Espindola", "email": "espindola@google.com", "date": "2009-11-24T15:00:15Z"}, "committer": {"name": "Rafael Espindola", "email": "espindola@gcc.gnu.org", "date": "2009-11-24T15:00:15Z"}, "message": "lto-wrapper.c (lto_wrapper_exit): Don't try to delete files if being called recursively.\n\n2009-11-24  Rafael Avila de Espindola  <espindola@google.com>\n\n       * lto-wrapper.c (lto_wrapper_exit): Don't try to delete files if\n       being called recursively.\n\nFrom-SVN: r154500", "tree": {"sha": "5883b35114ee1f36785b234871a9a477dcaeac44", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5883b35114ee1f36785b234871a9a477dcaeac44"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8aea79e6c91d187cc64058e615d0c8347dd79b63", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8aea79e6c91d187cc64058e615d0c8347dd79b63", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8aea79e6c91d187cc64058e615d0c8347dd79b63", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8aea79e6c91d187cc64058e615d0c8347dd79b63/comments", "author": null, "committer": null, "parents": [{"sha": "338877519ddf8530a92672bb457929bf57b6d2dd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/338877519ddf8530a92672bb457929bf57b6d2dd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/338877519ddf8530a92672bb457929bf57b6d2dd"}], "stats": {"total": 25, "additions": 19, "deletions": 6}, "files": [{"sha": "169f5ee65d9ad3f5b5cafe19df5972dc1a9e12c5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8aea79e6c91d187cc64058e615d0c8347dd79b63/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8aea79e6c91d187cc64058e615d0c8347dd79b63/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8aea79e6c91d187cc64058e615d0c8347dd79b63", "patch": "@@ -1,3 +1,8 @@\n+2009-11-24  Rafael Avila de Espindola  <espindola@google.com>\n+\n+\t* lto-wrapper.c (lto_wrapper_exit): Don't try to delete files if\n+\tbeing called recursively.\n+\n 2009-11-24  Basile Starynkevitch  <basile@starynkevitch.net>\n \n         * Makefile.in (PLUGIN_HEADERS): Added files: cppdefault.h flags.h"}, {"sha": "5f24f59564d3e495eccdbab6f2bbde855b6dcbed", "filename": "gcc/lto-wrapper.c", "status": "modified", "additions": 14, "deletions": 6, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8aea79e6c91d187cc64058e615d0c8347dd79b63/gcc%2Flto-wrapper.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8aea79e6c91d187cc64058e615d0c8347dd79b63/gcc%2Flto-wrapper.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-wrapper.c?ref=8aea79e6c91d187cc64058e615d0c8347dd79b63", "patch": "@@ -66,12 +66,20 @@ static void maybe_unlink_file (const char *);\n static void\n lto_wrapper_exit (int status)\n {\n-  if (ltrans_output_file)\n-    maybe_unlink_file (ltrans_output_file);\n-  if (flto_out)\n-    maybe_unlink_file (flto_out);\n-  if (args_name)\n-    maybe_unlink_file (args_name);\n+  static bool cleanup_done = false;\n+  if (!cleanup_done)\n+    {\n+      /* Setting cleanup_done prevents an infinite loop if one of the\n+         calls to maybe_unlink_file fails. */\n+      cleanup_done = true;\n+\n+      if (ltrans_output_file)\n+        maybe_unlink_file (ltrans_output_file);\n+      if (flto_out)\n+        maybe_unlink_file (flto_out);\n+      if (args_name)\n+        maybe_unlink_file (args_name);\n+    }\n   exit (status);\n }\n "}]}