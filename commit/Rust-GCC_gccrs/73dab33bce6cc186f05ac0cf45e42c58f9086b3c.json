{"sha": "73dab33bce6cc186f05ac0cf45e42c58f9086b3c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzNkYWIzM2JjZTZjYzE4NmYwNWFjMGNmNDVlNDJjNThmOTA4NmIzYw==", "commit": {"author": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2006-06-20T02:09:57Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2006-06-20T02:09:57Z"}, "message": "re PR middle-end/28075 (inliner introduces unnecessary type conversions)\n\n2006-06-19  Andrew Pinski  <pinskia@gmail.com>\n\n        PR middle-end/28075\n        * tree-inline.c (setup_one_parameter): Strip useless\n        type conversion before adding it to the IR.\n        (declare_return_variable): Likewise.\n\n\n2006-06-19  Andrew Pinski  <pinskia@gmail.com>\n\n        PR middle-end/28075\n        * gcc.dg/tree-ssa/inline-1.c: New test.\n\nFrom-SVN: r114801", "tree": {"sha": "70fce683565be251ca9b5d49fd3d814bfcf5a973", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/70fce683565be251ca9b5d49fd3d814bfcf5a973"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/73dab33bce6cc186f05ac0cf45e42c58f9086b3c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73dab33bce6cc186f05ac0cf45e42c58f9086b3c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/73dab33bce6cc186f05ac0cf45e42c58f9086b3c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73dab33bce6cc186f05ac0cf45e42c58f9086b3c/comments", "author": null, "committer": null, "parents": [{"sha": "48e2909e4a9d520a083d213999c926bf135ebed2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48e2909e4a9d520a083d213999c926bf135ebed2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/48e2909e4a9d520a083d213999c926bf135ebed2"}], "stats": {"total": 43, "additions": 42, "deletions": 1}, "files": [{"sha": "39489118b60b892d05a513a39f2a229a3978d11e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73dab33bce6cc186f05ac0cf45e42c58f9086b3c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73dab33bce6cc186f05ac0cf45e42c58f9086b3c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=73dab33bce6cc186f05ac0cf45e42c58f9086b3c", "patch": "@@ -1,3 +1,10 @@\n+2006-06-19  Andrew Pinski  <pinskia@gmail.com>\n+\n+\tPR middle-end/28075\n+\t* tree-inline.c (setup_one_parameter): Strip useless\n+\ttype conversion before adding it to the IR.\n+\t(declare_return_variable): Likewise.\n+\n 2006-06-19  Martin Michlmayr  <tbm@cyrius.com>\n \n \tPR c/27149"}, {"sha": "96c8628778507a6ab83ffed8567fa940053d6d39", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73dab33bce6cc186f05ac0cf45e42c58f9086b3c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73dab33bce6cc186f05ac0cf45e42c58f9086b3c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=73dab33bce6cc186f05ac0cf45e42c58f9086b3c", "patch": "@@ -1,4 +1,9 @@\n-2006-06-19  Anatoly Sokolov <aesok@post.ru>\n+2006-06-19  Andrew Pinski  <pinskia@gmail.com>\n+\n+\tPR middle-end/28075\n+\t* gcc.dg/tree-ssa/inline-1.c: New test.\n+\n+2006-06-19  Anatoly Sokolov  <aesok@post.ru>\n \n \t* gcc.dg/pr18241-1.c: Use __SIZE_TYPE__ instead of unsigned long\n \tin malloc prototype; remove XFAIL."}, {"sha": "bbf7e83aacf7098e45af85e16ccad89fca6e4b83", "filename": "gcc/testsuite/gcc.dg/tree-ssa/inline-1.c", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73dab33bce6cc186f05ac0cf45e42c58f9086b3c/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Finline-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73dab33bce6cc186f05ac0cf45e42c58f9086b3c/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Finline-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Finline-1.c?ref=73dab33bce6cc186f05ac0cf45e42c58f9086b3c", "patch": "@@ -0,0 +1,25 @@\n+/* { dg-do compile } */ \n+/* { dg-options \"-O2 -fdump-tree-final_cleanup\" } */\n+\n+\n+typedef struct {\n+  double min;\n+  double max;\n+} interval;\n+inline interval add(interval x, interval y)  __attribute__((always_inline));\n+inline interval add(interval x, interval y)  \n+{\n+  interval r;\n+  r.min = x.min + y.min;\n+  r.max = x.max + y.max;\n+  return r;\n+}\n+interval foo (interval a, interval b, interval c)\n+{\n+  return add (a, add (b, c));\n+}\n+\n+\n+/* { dg-final { scan-tree-dump-times \"\\(struct interval\\)\" 0 \"final_cleanup\"} } */\n+/* { dg-final { cleanup-tree-dump \"final_cleanup\" } } */\n+"}, {"sha": "4749be519e3fc73303528d86f63e835ad10e3a19", "filename": "gcc/tree-inline.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73dab33bce6cc186f05ac0cf45e42c58f9086b3c/gcc%2Ftree-inline.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73dab33bce6cc186f05ac0cf45e42c58f9086b3c/gcc%2Ftree-inline.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-inline.c?ref=73dab33bce6cc186f05ac0cf45e42c58f9086b3c", "patch": "@@ -1081,6 +1081,8 @@ setup_one_parameter (copy_body_data *id, tree p, tree value, tree fn,\n \n       if (rhs == error_mark_node)\n \treturn;\n+\t\n+      STRIP_USELESS_TYPE_CONVERSION (rhs);\n \n       /* We want to use MODIFY_EXPR, not INIT_EXPR here so that we\n \t keep our trees in gimple form.  */\n@@ -1267,6 +1269,8 @@ declare_return_variable (copy_body_data *id, tree return_slot_addr,\n   use = var;\n   if (!lang_hooks.types_compatible_p (TREE_TYPE (var), caller_type))\n     use = fold_convert (caller_type, var);\n+    \n+  STRIP_USELESS_TYPE_CONVERSION (use);\n \n  done:\n   /* Register the VAR_DECL as the equivalent for the RESULT_DECL; that"}]}