{"sha": "81fa6d7321dd9b645d86de4a8a6967c603f176e3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODFmYTZkNzMyMWRkOWI2NDVkODZkZTRhOGE2OTY3YzYwM2YxNzZlMw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2020-03-09T20:52:18Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2020-03-09T20:52:18Z"}, "message": "c++: Readd [LR]ROTATE_EXPR support to constexpr.c [PR94067]\n\nSince r10-6527-gaaa26bf496a646778ac861aed124d960b5bf549f fold_for_warn\nwill perform maybe_constant_value even on some cp_fold produced trees and\nso can include rotate exprs which were removed last fall from constexpr.c\n\n2020-03-09  Jakub Jelinek  <jakub@redhat.com>\n\n\tPR c++/94067\n\tRevert\n\t2019-10-11  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\t* constexpr.c (cxx_eval_constant_expression): Do not handle\n\tRROTATE_EXPR and LROTATE_EXPR.\n\n\t* g++.dg/warn/Wconversion-pr94067.C: New test.", "tree": {"sha": "fbf797669532e0c3e7372cc8a1cce0aa95bcfcf6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fbf797669532e0c3e7372cc8a1cce0aa95bcfcf6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/81fa6d7321dd9b645d86de4a8a6967c603f176e3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81fa6d7321dd9b645d86de4a8a6967c603f176e3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/81fa6d7321dd9b645d86de4a8a6967c603f176e3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81fa6d7321dd9b645d86de4a8a6967c603f176e3/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5dc1390b41db5c1765e25fd21dad1a930a015aac", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5dc1390b41db5c1765e25fd21dad1a930a015aac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5dc1390b41db5c1765e25fd21dad1a930a015aac"}], "stats": {"total": 27, "additions": 27, "deletions": 0}, "files": [{"sha": "7b3b9560571d0ffa4d32dc6b7c1004addd29702f", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81fa6d7321dd9b645d86de4a8a6967c603f176e3/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81fa6d7321dd9b645d86de4a8a6967c603f176e3/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=81fa6d7321dd9b645d86de4a8a6967c603f176e3", "patch": "@@ -1,3 +1,12 @@\n+2020-03-09  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c++/94067\n+\tRevert\n+\t2019-10-11  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\t* constexpr.c (cxx_eval_constant_expression): Do not handle\n+\tRROTATE_EXPR and LROTATE_EXPR.\n+\n 2020-03-09  Marek Polacek  <polacek@redhat.com>\n \n \tPR c++/94050 - ABI issue with alignas on armv7hl."}, {"sha": "76af0d710c403455b51f1356e44412e487bfff67", "filename": "gcc/cp/constexpr.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81fa6d7321dd9b645d86de4a8a6967c603f176e3/gcc%2Fcp%2Fconstexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81fa6d7321dd9b645d86de4a8a6967c603f176e3/gcc%2Fcp%2Fconstexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fconstexpr.c?ref=81fa6d7321dd9b645d86de4a8a6967c603f176e3", "patch": "@@ -5730,6 +5730,8 @@ cxx_eval_constant_expression (const constexpr_ctx *ctx, tree t,\n     case MAX_EXPR:\n     case LSHIFT_EXPR:\n     case RSHIFT_EXPR:\n+    case LROTATE_EXPR:\n+    case RROTATE_EXPR:\n     case BIT_IOR_EXPR:\n     case BIT_XOR_EXPR:\n     case BIT_AND_EXPR:\n@@ -7853,6 +7855,8 @@ potential_constant_expression_1 (tree t, bool want_rval, bool strict, bool now,\n     case MAX_EXPR:\n     case LSHIFT_EXPR:\n     case RSHIFT_EXPR:\n+    case LROTATE_EXPR:\n+    case RROTATE_EXPR:\n     case BIT_IOR_EXPR:\n     case BIT_XOR_EXPR:\n     case BIT_AND_EXPR:"}, {"sha": "44f65ffa2049396c7a685efdd732db57309ce7cd", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81fa6d7321dd9b645d86de4a8a6967c603f176e3/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81fa6d7321dd9b645d86de4a8a6967c603f176e3/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=81fa6d7321dd9b645d86de4a8a6967c603f176e3", "patch": "@@ -1,3 +1,8 @@\n+2020-03-09  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c++/94067\n+\t* g++.dg/warn/Wconversion-pr94067.C: New test.\n+\n 2020-03-09  Marek Polacek  <polacek@redhat.com>\n \n \tPR c++/94050 - ABI issue with alignas on armv7hl."}, {"sha": "c1031017a1f62b39007c0c81f77b08dec9ff158e", "filename": "gcc/testsuite/g++.dg/warn/Wconversion-pr94067.C", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81fa6d7321dd9b645d86de4a8a6967c603f176e3/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWconversion-pr94067.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81fa6d7321dd9b645d86de4a8a6967c603f176e3/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWconversion-pr94067.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWconversion-pr94067.C?ref=81fa6d7321dd9b645d86de4a8a6967c603f176e3", "patch": "@@ -0,0 +1,9 @@\n+// PR c++/94067\n+// { dg-do compile }\n+// { dg-options \"-Wconversion\" }\n+\n+static inline unsigned short\n+swap (unsigned short x)\n+{\n+  return (x >> 8) | static_cast<unsigned short>(x << 8);\n+}"}]}