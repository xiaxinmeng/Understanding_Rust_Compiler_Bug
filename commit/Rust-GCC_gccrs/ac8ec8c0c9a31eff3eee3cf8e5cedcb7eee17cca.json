{"sha": "ac8ec8c0c9a31eff3eee3cf8e5cedcb7eee17cca", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWM4ZWM4YzBjOWEzMWVmZjNlZWUzY2Y4ZTVjZWRjYjdlZWUxN2NjYQ==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1994-05-07T16:12:53Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1994-05-07T16:12:53Z"}, "message": "(LIB_SPEC): Support -fshared-data.\n\n(CPP_SPEC): Set _SEQUENT_ to 1.\n(SHARED_SECTION_ASM_OP, ASM_OUTPUT_SHARED_COMMON): Supply new macros.\n(SHARED_BSS_SECTION_ASM_OP, BSS_SECTION_FUNCTION): Likewise.\n\nFrom-SVN: r7262", "tree": {"sha": "47ac3b7868456ca39e82b77cd701a2da136facc1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/47ac3b7868456ca39e82b77cd701a2da136facc1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ac8ec8c0c9a31eff3eee3cf8e5cedcb7eee17cca", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac8ec8c0c9a31eff3eee3cf8e5cedcb7eee17cca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ac8ec8c0c9a31eff3eee3cf8e5cedcb7eee17cca", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac8ec8c0c9a31eff3eee3cf8e5cedcb7eee17cca/comments", "author": null, "committer": null, "parents": [{"sha": "19a9014fab5f39ebfe4e56a298e786eb2cf7d968", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/19a9014fab5f39ebfe4e56a298e786eb2cf7d968", "html_url": "https://github.com/Rust-GCC/gccrs/commit/19a9014fab5f39ebfe4e56a298e786eb2cf7d968"}], "stats": {"total": 35, "additions": 32, "deletions": 3}, "files": [{"sha": "dabdb594229870e3d1fca1fde8bd737533a9e8b8", "filename": "gcc/config/i386/seq-sysv3.h", "status": "modified", "additions": 32, "deletions": 3, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac8ec8c0c9a31eff3eee3cf8e5cedcb7eee17cca/gcc%2Fconfig%2Fi386%2Fseq-sysv3.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac8ec8c0c9a31eff3eee3cf8e5cedcb7eee17cca/gcc%2Fconfig%2Fi386%2Fseq-sysv3.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fseq-sysv3.h?ref=ac8ec8c0c9a31eff3eee3cf8e5cedcb7eee17cca", "patch": "@@ -11,10 +11,13 @@\n  %{p:-L/usr/lib/libp}%{pg:-L/usr/lib/libp}\"\n \n #undef LIB_SPEC\n-#define LIB_SPEC \"%{posix:-lcposix} %{shlib:-lc_s} -lc crtend.o%s\"\n+#define LIB_SPEC \\\n+\"%{posix:-lcposix}\\\n+ %{shlib:-lc_s}\\\n+ %{fshared-data:-lpps -lseq} -lc crtend.o%s\"\n \n #undef CPP_SPEC\n-#define CPP_SPEC \"%{posix:-D_POSIX_SOURCE} -D_SEQUENT_\"\n+#define CPP_SPEC \"%{posix:-D_POSIX_SOURCE} -D_SEQUENT_=1\"\n \n /* Although the .init section is used, it is not automatically invoked.\n    This because the _start() function in /lib/crt0.o never calls anything\n@@ -25,5 +28,31 @@\n    our own exit function.  */\n #define HAVE_ATEXIT\n \n-/* Assembler pseudo-op for shared data segment. */\n+/* Assembler pseudo-op for initialized shared variables (.shdata). */\n+#undef  SHARED_SECTION_ASM_OP\n #define SHARED_SECTION_ASM_OP \".section .shdata, \\\"ws\\\"\"\n+\n+/* Assembler pseudo-op for uninitialized shared global variables (.shbss). */\n+#undef  ASM_OUTPUT_SHARED_COMMON\n+#define ASM_OUTPUT_SHARED_COMMON(FILE, NAME, SIZE, ROUNDED) \\\n+( fputs(\".comm \", (FILE)),\t\t\t\\\n+  assemble_name((FILE), (NAME)),\t\t\\\n+   fprintf((FILE), \",%u,-3\\n\", (SIZE)))\n+\n+/* Assembler pseudo-op for uninitialized shared local variables (.shbss). */\n+#undef  SHARED_BSS_SECTION_ASM_OP\n+#define SHARED_BSS_SECTION_ASM_OP \".section .shbss, \\\"bs\\\"\"\n+#undef  BSS_SECTION_FUNCTION\n+#define BSS_SECTION_FUNCTION\t\t\t\t\t\\\n+void\t\t\t\t\t\t\t\t\\\n+bss_section ()\t\t\t\t\t\t\t\\\n+{\t\t\t\t\t\t\t\t\\\n+  if (in_section != in_bss)\t\t\t\t\t\\\n+    {\t\t\t\t\t\t\t\t\\\n+      if (flag_shared_data)                                     \\\n+        fprintf (asm_out_file, \"%s\\n\", SHARED_BSS_SECTION_ASM_OP);\t\\\n+      else\t\t\t\t\t\t\t\\\n+        fprintf (asm_out_file, \"%s\\n\", BSS_SECTION_ASM_OP);\t\\\n+      in_section = in_bss;\t\t\t\t\t\\\n+    }\t\t\t\t\t\t\t\t\\\n+}"}]}