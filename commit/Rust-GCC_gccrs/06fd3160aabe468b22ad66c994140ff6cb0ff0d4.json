{"sha": "06fd3160aabe468b22ad66c994140ff6cb0ff0d4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDZmZDMxNjBhYWJlNDY4YjIyYWQ2NmM5OTQxNDBmZjZjYjBmZjBkNA==", "commit": {"author": {"name": "Bin Cheng", "email": "bin.cheng@arm.com", "date": "2017-05-11T09:42:36Z"}, "committer": {"name": "Bin Cheng", "email": "amker@gcc.gnu.org", "date": "2017-05-11T09:42:36Z"}, "message": "tree-ssa-loop-ivopts.c (relate_compare_use_with_all_cands): New.\n\n\t* tree-ssa-loop-ivopts.c (relate_compare_use_with_all_cands): New.\n\t(find_iv_candidates): Call relate_compare_use_with_all_cands.\n\nFrom-SVN: r247890", "tree": {"sha": "1e03f56ec04f1e4d34a2168918b55a8bc11285ad", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1e03f56ec04f1e4d34a2168918b55a8bc11285ad"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/06fd3160aabe468b22ad66c994140ff6cb0ff0d4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06fd3160aabe468b22ad66c994140ff6cb0ff0d4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/06fd3160aabe468b22ad66c994140ff6cb0ff0d4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06fd3160aabe468b22ad66c994140ff6cb0ff0d4/comments", "author": null, "committer": null, "parents": [{"sha": "4c11bdff4d725cd0a0079524e071b1b5c735b116", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c11bdff4d725cd0a0079524e071b1b5c735b116", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4c11bdff4d725cd0a0079524e071b1b5c735b116"}], "stats": {"total": 24, "additions": 24, "deletions": 0}, "files": [{"sha": "95d560c67466aa26fca22704f4baa6e2725c8e45", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06fd3160aabe468b22ad66c994140ff6cb0ff0d4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06fd3160aabe468b22ad66c994140ff6cb0ff0d4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=06fd3160aabe468b22ad66c994140ff6cb0ff0d4", "patch": "@@ -1,3 +1,8 @@\n+2017-05-11  Bin Cheng  <bin.cheng@arm.com>\n+\n+\t* tree-ssa-loop-ivopts.c (relate_compare_use_with_all_cands): New.\n+\t(find_iv_candidates): Call relate_compare_use_with_all_cands.\n+\n 2017-05-11  Bin Cheng  <bin.cheng@arm.com>\n \n \t* tree-ssa-loop-ivopts.c (struct iv_cand): New field inv_exprs."}, {"sha": "d0757c3c5b28cf74ee200548d18a323b44346fb1", "filename": "gcc/tree-ssa-loop-ivopts.c", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06fd3160aabe468b22ad66c994140ff6cb0ff0d4/gcc%2Ftree-ssa-loop-ivopts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06fd3160aabe468b22ad66c994140ff6cb0ff0d4/gcc%2Ftree-ssa-loop-ivopts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop-ivopts.c?ref=06fd3160aabe468b22ad66c994140ff6cb0ff0d4", "patch": "@@ -5250,6 +5250,21 @@ set_autoinc_for_original_candidates (struct ivopts_data *data)\n     }\n }\n \n+/* Relate compare use with all candidates.  */\n+\n+static void\n+relate_compare_use_with_all_cands (struct ivopts_data *data)\n+{\n+  unsigned i, max_id = data->vcands.length () - 1;\n+  for (i = 0; i < data->vgroups.length (); i++)\n+    {\n+      struct iv_group *group = data->vgroups[i];\n+\n+      if (group->type == USE_COMPARE)\n+\tbitmap_set_range (group->related_cands, 0, max_id);\n+    }\n+}\n+\n /* Finds the candidates for the induction variables.  */\n \n static void\n@@ -5269,6 +5284,10 @@ find_iv_candidates (struct ivopts_data *data)\n   /* Record the important candidates.  */\n   record_important_candidates (data);\n \n+  /* Relate compare iv_use with all candidates.  */\n+  if (!data->consider_all_candidates)\n+    relate_compare_use_with_all_cands (data);\n+\n   if (dump_file && (dump_flags & TDF_DETAILS))\n     {\n       unsigned i;"}]}