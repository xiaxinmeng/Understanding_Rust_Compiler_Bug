{"sha": "1784915af28cfbed713a9cd9a3ce4789c44ffb2b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTc4NDkxNWFmMjhjZmJlZDcxM2E5Y2Q5YTNjZTQ3ODljNDRmZmIyYg==", "commit": {"author": {"name": "Aldy Hernandez", "email": "aldyh@gcc.gnu.org", "date": "2011-12-19T19:33:05Z"}, "committer": {"name": "Aldy Hernandez", "email": "aldyh@gcc.gnu.org", "date": "2011-12-19T19:33:05Z"}, "message": "Commit forgotten testcase that goes along with this PR.\n\n\tPR middle-end/51411\n\t* trans-mem.c (ipa_tm_create_version): Unset DECL_WEAK.\n\nFrom-SVN: r182493", "tree": {"sha": "0b6235a582a2bc053445b77f7e56dc16cdc3f94a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0b6235a582a2bc053445b77f7e56dc16cdc3f94a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1784915af28cfbed713a9cd9a3ce4789c44ffb2b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1784915af28cfbed713a9cd9a3ce4789c44ffb2b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1784915af28cfbed713a9cd9a3ce4789c44ffb2b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1784915af28cfbed713a9cd9a3ce4789c44ffb2b/comments", "author": null, "committer": null, "parents": [{"sha": "e0b22991cc363a1baf2186512eea66b0b003dcc1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0b22991cc363a1baf2186512eea66b0b003dcc1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e0b22991cc363a1baf2186512eea66b0b003dcc1"}], "stats": {"total": 56, "additions": 56, "deletions": 0}, "files": [{"sha": "4105d66ec9d77fa217fbf13be063b9b8a5481ab9", "filename": "gcc/testsuite/g++.dg/tm/pr51411-2.C", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1784915af28cfbed713a9cd9a3ce4789c44ffb2b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftm%2Fpr51411-2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1784915af28cfbed713a9cd9a3ce4789c44ffb2b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftm%2Fpr51411-2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftm%2Fpr51411-2.C?ref=1784915af28cfbed713a9cd9a3ce4789c44ffb2b", "patch": "@@ -0,0 +1,49 @@\n+// { dg-do compile }\n+// { dg-options \"-fgnu-tm -O0\" }\n+\n+namespace std {\n+template<typename _CharT> struct char_traits;\n+\n+template<typename _Tp> class allocator {\n+};\n+\n+template<typename _Tp> struct less {\n+    bool operator()(const _Tp& __x, const _Tp& __y) const {\n+        return __x < __y;\n+    }\n+};\n+\n+template <typename _Key, typename _Compare = std::less<_Key> > class map {\n+public:\n+    _Compare _M_key_compare;\n+    bool find(const _Key& __x) {\n+        return _M_key_compare(__x, __x);\n+    }\n+};\n+\n+template<typename _CharT, typename _Traits = char_traits<_CharT>, typename _Alloc = allocator<_CharT> > class basic_string {\n+public:\n+    bool compare(const basic_string& __str) const {\n+        return 0;\n+    }\n+};\n+\n+typedef basic_string<char> string;\n+\n+template<typename _CharT, typename _Traits>\n+inline bool operator<(const basic_string<_CharT, _Traits>& __lhs, const basic_string<_CharT, _Traits>& __rhs) {\n+    return __lhs.compare(__rhs);\n+}\n+\n+extern template class basic_string<char>;\n+\n+}\n+\n+std::map<std::string> units;\n+\n+__attribute__((transaction_callable))\n+void get(const std::string &name) {\n+    units.find(name);\n+}\n+\n+// { dg-final { scan-assembler \"_ZGTtNKSs7compareERKSs:\" } }"}, {"sha": "df20b87c83d32527b1665ae27f7c335f1a0cf3ef", "filename": "gcc/testsuite/g++.dg/tm/pr51411.C", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1784915af28cfbed713a9cd9a3ce4789c44ffb2b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftm%2Fpr51411.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1784915af28cfbed713a9cd9a3ce4789c44ffb2b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftm%2Fpr51411.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftm%2Fpr51411.C?ref=1784915af28cfbed713a9cd9a3ce4789c44ffb2b", "patch": "@@ -0,0 +1,7 @@\n+// { dg-do compile }\n+// { dg-options \"-fgnu-tm -O\" }\n+\n+struct A\n+{\n+  __attribute__ ((transaction_safe)) virtual void virtfoo () { }\n+};"}]}