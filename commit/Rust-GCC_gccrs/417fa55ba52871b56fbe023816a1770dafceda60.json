{"sha": "417fa55ba52871b56fbe023816a1770dafceda60", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDE3ZmE1NWJhNTI4NzFiNTZmYmUwMjM4MTZhMTc3MGRhZmNlZGE2MA==", "commit": {"author": {"name": "Lee Millward", "email": "lee.millward@gmail.com", "date": "2006-07-07T17:57:12Z"}, "committer": {"name": "Lee Millward", "email": "lmillward@gcc.gnu.org", "date": "2006-07-07T17:57:12Z"}, "message": "re PR c++/27820 (ICE with duplicate label)\n\n\tPR c++/27820\n\t* decl.c (define_label): Return error_mark_node on error.\n\t* semantics.c (finish_label_stmt): Don't call\n\tadd_stmt for invalid labels.\n\n\t* g++.dg/other/label1.C: New test.\n\n\nCo-Authored-By: Andrew Pinski <pinskia@gmail.com>\n\nFrom-SVN: r115265", "tree": {"sha": "7188c6ff46aae01dbc101916159cda34535ef8f2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7188c6ff46aae01dbc101916159cda34535ef8f2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/417fa55ba52871b56fbe023816a1770dafceda60", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/417fa55ba52871b56fbe023816a1770dafceda60", "html_url": "https://github.com/Rust-GCC/gccrs/commit/417fa55ba52871b56fbe023816a1770dafceda60", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/417fa55ba52871b56fbe023816a1770dafceda60/comments", "author": {"login": "lee-m", "id": 1028098, "node_id": "MDQ6VXNlcjEwMjgwOTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1028098?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lee-m", "html_url": "https://github.com/lee-m", "followers_url": "https://api.github.com/users/lee-m/followers", "following_url": "https://api.github.com/users/lee-m/following{/other_user}", "gists_url": "https://api.github.com/users/lee-m/gists{/gist_id}", "starred_url": "https://api.github.com/users/lee-m/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lee-m/subscriptions", "organizations_url": "https://api.github.com/users/lee-m/orgs", "repos_url": "https://api.github.com/users/lee-m/repos", "events_url": "https://api.github.com/users/lee-m/events{/privacy}", "received_events_url": "https://api.github.com/users/lee-m/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "bfabddb6c0307307e963bf1388fcad0b8a00ba5c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bfabddb6c0307307e963bf1388fcad0b8a00ba5c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bfabddb6c0307307e963bf1388fcad0b8a00ba5c"}], "stats": {"total": 29, "additions": 28, "deletions": 1}, "files": [{"sha": "d499bfdadd0496cf4b65fb341ce8dc85d57c0727", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/417fa55ba52871b56fbe023816a1770dafceda60/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/417fa55ba52871b56fbe023816a1770dafceda60/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=417fa55ba52871b56fbe023816a1770dafceda60", "patch": "@@ -1,3 +1,11 @@\n+2006-06-29  Lee Millward  <lee.millward@gmail.com>\n+\t    Andrew Pinski  <pinskia@gmail.com>\n+\n+\tPR c++/27820\n+\t* decl.c (define_label): Return error_mark_node on error.\n+\t* semantics.c (finish_label_stmt): Don't call\n+\tadd_stmt for invalid labels.\n+\t\n 2006-07-06  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/28279"}, {"sha": "1d5be58e09f401457279a75b7d39d80bee7c36b7", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/417fa55ba52871b56fbe023816a1770dafceda60/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/417fa55ba52871b56fbe023816a1770dafceda60/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=417fa55ba52871b56fbe023816a1770dafceda60", "patch": "@@ -2543,7 +2543,10 @@ define_label (location_t location, tree name)\n     pedwarn (\"label named wchar_t\");\n \n   if (DECL_INITIAL (decl) != NULL_TREE)\n-    error (\"duplicate label %qD\", decl);\n+    {\n+      error (\"duplicate label %qD\", decl);\n+      POP_TIMEVAR_AND_RETURN (TV_NAME_LOOKUP, error_mark_node);\n+    }\n   else\n     {\n       struct named_label_use_entry *use;"}, {"sha": "9ecace6806a0b6600b37eadc9fcf7edb89de659b", "filename": "gcc/cp/semantics.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/417fa55ba52871b56fbe023816a1770dafceda60/gcc%2Fcp%2Fsemantics.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/417fa55ba52871b56fbe023816a1770dafceda60/gcc%2Fcp%2Fsemantics.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fsemantics.c?ref=417fa55ba52871b56fbe023816a1770dafceda60", "patch": "@@ -1293,6 +1293,10 @@ tree\n finish_label_stmt (tree name)\n {\n   tree decl = define_label (input_location, name);\n+\n+  if (decl  == error_mark_node)\n+    return error_mark_node;\n+\n   return add_stmt (build_stmt (LABEL_EXPR, decl));\n }\n "}, {"sha": "9203c1566daa077fe89ca605a3565d9a210aac32", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/417fa55ba52871b56fbe023816a1770dafceda60/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/417fa55ba52871b56fbe023816a1770dafceda60/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=417fa55ba52871b56fbe023816a1770dafceda60", "patch": "@@ -1,3 +1,8 @@\n+2006-07-07  Lee Millward  <lee.millward@gmail.com>\n+\n+\tPR c++/27820\n+\t* g++.dg/other/label1.C: New test.\n+\t\n 2006-07-07   Richard Guenther  <rguenther@suse.de>\n \n \tPR middle-end/28268"}, {"sha": "74572dc7d2c717c01773284cdaf42fb7a953bf84", "filename": "gcc/testsuite/g++.dg/other/label1.C", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/417fa55ba52871b56fbe023816a1770dafceda60/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Flabel1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/417fa55ba52871b56fbe023816a1770dafceda60/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Flabel1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Flabel1.C?ref=417fa55ba52871b56fbe023816a1770dafceda60", "patch": "@@ -0,0 +1,7 @@\n+//PR c++/27820\n+\n+void foo()\n+{\n+    L: L: ; // { dg-error \"duplicate label\" }\n+}\n+"}]}