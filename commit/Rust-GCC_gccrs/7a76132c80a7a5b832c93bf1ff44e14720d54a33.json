{"sha": "7a76132c80a7a5b832c93bf1ff44e14720d54a33", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2E3NjEzMmM4MGE3YTViODMyYzkzYmYxZmY0NGUxNDcyMGQ1NGEzMw==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2017-10-17T07:31:30Z"}, "committer": {"name": "Martin Liska", "email": "marxin@gcc.gnu.org", "date": "2017-10-17T07:31:30Z"}, "message": "Improve FAIL message for dump-*-times functions.\n\n2017-10-17  Martin Liska  <mliska@suse.cz>\n\n\t* lib/scanasm.exp: Print how many times a regex pattern is\n\tfound.\n\t* lib/scandump.exp: Likewise.\n\nFrom-SVN: r253804", "tree": {"sha": "8c5848c4b2a14cdb014159f2d64538ea61fb3989", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8c5848c4b2a14cdb014159f2d64538ea61fb3989"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7a76132c80a7a5b832c93bf1ff44e14720d54a33", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a76132c80a7a5b832c93bf1ff44e14720d54a33", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7a76132c80a7a5b832c93bf1ff44e14720d54a33", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a76132c80a7a5b832c93bf1ff44e14720d54a33/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "af297249647b4d5b783239916f27a4b68829f916", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/af297249647b4d5b783239916f27a4b68829f916", "html_url": "https://github.com/Rust-GCC/gccrs/commit/af297249647b4d5b783239916f27a4b68829f916"}], "stats": {"total": 22, "additions": 16, "deletions": 6}, "files": [{"sha": "5c3c5b2328f5fc170dbf4871352975a5da451a3b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a76132c80a7a5b832c93bf1ff44e14720d54a33/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a76132c80a7a5b832c93bf1ff44e14720d54a33/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7a76132c80a7a5b832c93bf1ff44e14720d54a33", "patch": "@@ -1,3 +1,9 @@\n+2017-10-17  Martin Liska  <mliska@suse.cz>\n+\n+\t* lib/scanasm.exp: Print how many times a regex pattern is\n+\tfound.\n+\t* lib/scandump.exp: Likewise.\n+\n 17-10-2017  Olga Makhotina  <olga.makhotina@intel.com>\n \n \t* gcc.target/i386/avx512dq-vreducesd-1.c (_mm_mask_reduce_sd,"}, {"sha": "32764cb9c4abc0a96422edde0ffe381c3c0d32ef", "filename": "gcc/testsuite/lib/scanasm.exp", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a76132c80a7a5b832c93bf1ff44e14720d54a33/gcc%2Ftestsuite%2Flib%2Fscanasm.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a76132c80a7a5b832c93bf1ff44e14720d54a33/gcc%2Ftestsuite%2Flib%2Fscanasm.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Fscanasm.exp?ref=7a76132c80a7a5b832c93bf1ff44e14720d54a33", "patch": "@@ -231,6 +231,7 @@ proc scan-assembler-times { args } {\n \n     set testcase [testname-for-summary]\n     set pattern [lindex $args 0]\n+    set times [lindex $args 1]\n     set pp_pattern [make_pattern_printable $pattern]\n \n     # This must match the rule in gcc-dg.exp.\n@@ -239,18 +240,19 @@ proc scan-assembler-times { args } {\n     set files [glob -nocomplain $output_file]\n     if { $files == \"\" } {\n \tverbose -log \"$testcase: output file does not exist\"\n-\tunresolved \"$testcase scan-assembler-times $pp_pattern [lindex $args 1]\"\n+\tunresolved \"$testcase scan-assembler-times $pp_pattern $times\"\n \treturn\n     }\n \n     set fd [open $output_file r]\n     set text [read $fd]\n     close $fd\n \n-    if { [llength [regexp -inline -all -- $pattern $text]] == [lindex $args 1]} {\n-\tpass \"$testcase scan-assembler-times $pp_pattern [lindex $args 1]\"\n+    set result_count [llength [regexp -inline -all -- $pattern $text]]\n+    if {$result_count == $times} {\n+\tpass \"$testcase scan-assembler-times $pp_pattern $times\"\n     } else {\n-\tfail \"$testcase scan-assembler-times $pp_pattern [lindex $args 1]\"\n+\tfail \"$testcase scan-assembler-times $pp_pattern $times (found $result_count times)\"\n     }\n }\n "}, {"sha": "4a64ac6e05ddfafb8c27d24e381e6e6dc53afe96", "filename": "gcc/testsuite/lib/scandump.exp", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a76132c80a7a5b832c93bf1ff44e14720d54a33/gcc%2Ftestsuite%2Flib%2Fscandump.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a76132c80a7a5b832c93bf1ff44e14720d54a33/gcc%2Ftestsuite%2Flib%2Fscandump.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Fscandump.exp?ref=7a76132c80a7a5b832c93bf1ff44e14720d54a33", "patch": "@@ -86,6 +86,7 @@ proc scan-dump-times { args } {\n     }\n \n     set testcase [testname-for-summary]\n+    set times [lindex $args 2]\n     set suf [dump-suffix [lindex $args 3]]\n     set printable_pattern [make_pattern_printable [lindex $args 1]]\n     set testname \"$testcase scan-[lindex $args 0]-dump-times $suf \\\"$printable_pattern\\\" [lindex $args 2]\"\n@@ -101,10 +102,11 @@ proc scan-dump-times { args } {\n     set text [read $fd]\n     close $fd\n \n-    if { [llength [regexp -inline -all -- [lindex $args 1] $text]] == [lindex $args 2]} {\n+    set result_count [llength [regexp -inline -all -- [lindex $args 1] $text]]\n+    if {$result_count == $times} {\n         pass \"$testname\"\n     } else {\n-        fail \"$testname\"\n+        fail \"$testname (found $result_count times)\"\n     }\n }\n "}]}