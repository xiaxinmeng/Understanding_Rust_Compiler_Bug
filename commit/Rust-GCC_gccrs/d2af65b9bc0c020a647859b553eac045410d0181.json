{"sha": "d2af65b9bc0c020a647859b553eac045410d0181", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDJhZjY1YjliYzBjMDIwYTY0Nzg1OWI1NTNlYWMwNDU0MTBkMDE4MQ==", "commit": {"author": {"name": "Rainer Orth", "email": "ro@CeBiTec.Uni-Bielefeld.DE", "date": "2010-03-24T18:31:07Z"}, "committer": {"name": "Rainer Orth", "email": "ro@gcc.gnu.org", "date": "2010-03-24T18:31:07Z"}, "message": "i386.c (override_options): Don't accept -mtls-dialect=sun any longer.\n\n\t* config/i386/i386.c (override_options): Don't accept\n\t-mtls-dialect=sun any longer.\n\t* config/i386/i386.h (TARGET_SUN_TLS): Define as 0.\n\t* config/i386/i386.md (*tls_global_dynamic_32_sun): Remove.\n\t(*tls_local_dynamic_base_32_sun): Likewise.\n\t* config/i386/sol2.h (TARGET_SUN_TLS): Redefine.\n\nFrom-SVN: r157704", "tree": {"sha": "82b8153b18de7e1ad4296f40b025b31046788416", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/82b8153b18de7e1ad4296f40b025b31046788416"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d2af65b9bc0c020a647859b553eac045410d0181", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d2af65b9bc0c020a647859b553eac045410d0181", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d2af65b9bc0c020a647859b553eac045410d0181", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d2af65b9bc0c020a647859b553eac045410d0181/comments", "author": {"login": "rorth", "id": 3930951, "node_id": "MDQ6VXNlcjM5MzA5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/3930951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rorth", "html_url": "https://github.com/rorth", "followers_url": "https://api.github.com/users/rorth/followers", "following_url": "https://api.github.com/users/rorth/following{/other_user}", "gists_url": "https://api.github.com/users/rorth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rorth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rorth/subscriptions", "organizations_url": "https://api.github.com/users/rorth/orgs", "repos_url": "https://api.github.com/users/rorth/repos", "events_url": "https://api.github.com/users/rorth/events{/privacy}", "received_events_url": "https://api.github.com/users/rorth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1db0ea007ba1dde37be101b58591e7403464a27d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1db0ea007ba1dde37be101b58591e7403464a27d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1db0ea007ba1dde37be101b58591e7403464a27d"}], "stats": {"total": 51, "additions": 17, "deletions": 34}, "files": [{"sha": "1bbb9d8f9d86821f2c1957cde998f58e1f5271e8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2af65b9bc0c020a647859b553eac045410d0181/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2af65b9bc0c020a647859b553eac045410d0181/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d2af65b9bc0c020a647859b553eac045410d0181", "patch": "@@ -1,3 +1,12 @@\n+2010-03-24  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n+\n+\t* config/i386/i386.c (override_options): Don't accept\n+\t-mtls-dialect=sun any longer.\n+\t* config/i386/i386.h (TARGET_SUN_TLS): Define as 0.\n+\t* config/i386/i386.md (*tls_global_dynamic_32_sun): Remove.\n+\t(*tls_local_dynamic_base_32_sun): Likewise.\n+\t* config/i386/sol2.h (TARGET_SUN_TLS): Redefine.\n+\n 2010-03-24  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR debug/43508"}, {"sha": "2179b5a1fb0f540fbd3bb0059a14591065a520f3", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2af65b9bc0c020a647859b553eac045410d0181/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2af65b9bc0c020a647859b553eac045410d0181/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=d2af65b9bc0c020a647859b553eac045410d0181", "patch": "@@ -3197,8 +3197,6 @@ override_options (bool main_args_p)\n \tix86_tls_dialect = TLS_DIALECT_GNU;\n       else if (strcmp (ix86_tls_dialect_string, \"gnu2\") == 0)\n \tix86_tls_dialect = TLS_DIALECT_GNU2;\n-      else if (strcmp (ix86_tls_dialect_string, \"sun\") == 0)\n-\tix86_tls_dialect = TLS_DIALECT_SUN;\n       else\n \terror (\"bad value (%s) for %stls-dialect=%s %s\",\n \t       ix86_tls_dialect_string, prefix, suffix, sw);"}, {"sha": "521e2feb4f0f04bfe96dd8c59a1d59185ddb8cc3", "filename": "gcc/config/i386/i386.h", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2af65b9bc0c020a647859b553eac045410d0181/gcc%2Fconfig%2Fi386%2Fi386.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2af65b9bc0c020a647859b553eac045410d0181/gcc%2Fconfig%2Fi386%2Fi386.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.h?ref=d2af65b9bc0c020a647859b553eac045410d0181", "patch": "@@ -1,6 +1,6 @@\n /* Definitions of target machine for GCC for IA-32.\n    Copyright (C) 1988, 1992, 1994, 1995, 1996, 1997, 1998, 1999, 2000,\n-   2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009\n+   2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010\n    Free Software Foundation, Inc.\n \n This file is part of GCC.\n@@ -429,7 +429,7 @@ extern int x86_prefetch_sse;\n #define TARGET_GNU_TLS\t\t(ix86_tls_dialect == TLS_DIALECT_GNU)\n #define TARGET_GNU2_TLS\t\t(ix86_tls_dialect == TLS_DIALECT_GNU2)\n #define TARGET_ANY_GNU_TLS\t(TARGET_GNU_TLS || TARGET_GNU2_TLS)\n-#define TARGET_SUN_TLS\t\t(ix86_tls_dialect == TLS_DIALECT_SUN)\n+#define TARGET_SUN_TLS\t\t0\n \n extern int ix86_isa_flags;\n "}, {"sha": "da28f1cc840ba4c25c858d31a5d8cec409a7f7f3", "filename": "gcc/config/i386/i386.md", "status": "modified", "additions": 1, "deletions": 30, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2af65b9bc0c020a647859b553eac045410d0181/gcc%2Fconfig%2Fi386%2Fi386.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2af65b9bc0c020a647859b553eac045410d0181/gcc%2Fconfig%2Fi386%2Fi386.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.md?ref=d2af65b9bc0c020a647859b553eac045410d0181", "patch": "@@ -1,6 +1,6 @@\n ;; GCC machine description for IA-32 and x86-64.\n ;; Copyright (C) 1988, 1994, 1995, 1996, 1997, 1998, 1999, 2000,\n-;; 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009\n+;; 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010\n ;; Free Software Foundation, Inc.\n ;; Mostly by William Schelter.\n ;; x86_64 support added by Jan Hubicka\n@@ -14495,21 +14495,6 @@\n   [(set_attr \"type\" \"multi\")\n    (set_attr \"length\" \"12\")])\n \n-(define_insn \"*tls_global_dynamic_32_sun\"\n-  [(set (match_operand:SI 0 \"register_operand\" \"=a\")\n-\t(unspec:SI [(match_operand:SI 1 \"register_operand\" \"b\")\n-\t\t    (match_operand:SI 2 \"tls_symbolic_operand\" \"\")\n-\t\t    (match_operand:SI 3 \"call_insn_operand\" \"\")]\n-\t\t    UNSPEC_TLS_GD))\n-   (clobber (match_scratch:SI 4 \"=d\"))\n-   (clobber (match_scratch:SI 5 \"=c\"))\n-   (clobber (reg:CC FLAGS_REG))]\n-  \"!TARGET_64BIT && TARGET_SUN_TLS\"\n-  \"lea{l}\\t{%a2@DTLNDX(%1), %4|%4, %a2@DTLNDX[%1]}\n-\tpush{l}\\t%4\\;call\\t%a2@TLSPLT\\;pop{l}\\t%4\\;nop\"\n-  [(set_attr \"type\" \"multi\")\n-   (set_attr \"length\" \"14\")])\n-\n (define_expand \"tls_global_dynamic_32\"\n   [(parallel [(set (match_operand:SI 0 \"register_operand\" \"\")\n \t\t   (unspec:SI\n@@ -14578,20 +14563,6 @@\n   [(set_attr \"type\" \"multi\")\n    (set_attr \"length\" \"11\")])\n \n-(define_insn \"*tls_local_dynamic_base_32_sun\"\n-  [(set (match_operand:SI 0 \"register_operand\" \"=a\")\n-\t(unspec:SI [(match_operand:SI 1 \"register_operand\" \"b\")\n-                    (match_operand:SI 2 \"call_insn_operand\" \"\")]\n-\t\t   UNSPEC_TLS_LD_BASE))\n-   (clobber (match_scratch:SI 3 \"=d\"))\n-   (clobber (match_scratch:SI 4 \"=c\"))\n-   (clobber (reg:CC FLAGS_REG))]\n-  \"!TARGET_64BIT && TARGET_SUN_TLS\"\n-  \"lea{l}\\t{%&@TMDNX(%1), %3|%3, %&@TMDNX[%1]}\n-\tpush{l}\\t%3\\;call\\t%&@TLSPLT\\;pop{l}\\t%3\"\n-  [(set_attr \"type\" \"multi\")\n-   (set_attr \"length\" \"13\")])\n-\n (define_expand \"tls_local_dynamic_base_32\"\n   [(parallel [(set (match_operand:SI 0 \"register_operand\" \"\")\n \t\t   (unspec:SI [(match_dup 1) (match_dup 2)]"}, {"sha": "addaf81df36a85bf124ac9983aa6d758168f8873", "filename": "gcc/config/i386/sol2.h", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2af65b9bc0c020a647859b553eac045410d0181/gcc%2Fconfig%2Fi386%2Fsol2.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2af65b9bc0c020a647859b553eac045410d0181/gcc%2Fconfig%2Fi386%2Fsol2.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fsol2.h?ref=d2af65b9bc0c020a647859b553eac045410d0181", "patch": "@@ -91,6 +91,11 @@ along with GCC; see the file COPYING3.  If not see\n       }\t\t\t\t\t\t\t\\\n   } while (0)\n \n+/* Follow Sun requirements for TLS code sequences and use Sun assembler TLS\n+   syntax.  */\n+#undef TARGET_SUN_TLS\n+#define TARGET_SUN_TLS 1\n+\n /* The Solaris assembler cannot grok .stabd directives.  */\n #undef NO_DBX_BNSYM_ENSYM\n #define NO_DBX_BNSYM_ENSYM 1"}]}