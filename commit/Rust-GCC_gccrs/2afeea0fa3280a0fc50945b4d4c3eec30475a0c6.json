{"sha": "2afeea0fa3280a0fc50945b4d4c3eec30475a0c6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmFmZWVhMGZhMzI4MGEwZmM1MDk0NWI0ZDRjM2VlYzMwNDc1YTBjNg==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1996-08-12T21:43:22Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1996-08-12T21:43:22Z"}, "message": "(regno_reg_class): Change entry 23 from NO_REGS to GENERAL_REGS.\n\n(initial_elimination_offset): New variable live_regs_mask.  Add\ncode to handle RETURN_ADDRESS_POINTER_REGNUM.\n\nFrom-SVN: r12627", "tree": {"sha": "c98d0af44ad3264ac8ef3d8d7fd49d54b80d1ab6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c98d0af44ad3264ac8ef3d8d7fd49d54b80d1ab6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2afeea0fa3280a0fc50945b4d4c3eec30475a0c6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2afeea0fa3280a0fc50945b4d4c3eec30475a0c6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2afeea0fa3280a0fc50945b4d4c3eec30475a0c6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2afeea0fa3280a0fc50945b4d4c3eec30475a0c6/comments", "author": null, "committer": null, "parents": [{"sha": "f434403dd78bd9ecd8cfd721396170b9e05af2ea", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f434403dd78bd9ecd8cfd721396170b9e05af2ea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f434403dd78bd9ecd8cfd721396170b9e05af2ea"}], "stats": {"total": 19, "additions": 16, "deletions": 3}, "files": [{"sha": "f7625a4a3dc196b1811e6160ac3ab666c1266a85", "filename": "gcc/config/sh/sh.c", "status": "modified", "additions": 16, "deletions": 3, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2afeea0fa3280a0fc50945b4d4c3eec30475a0c6/gcc%2Fconfig%2Fsh%2Fsh.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2afeea0fa3280a0fc50945b4d4c3eec30475a0c6/gcc%2Fconfig%2Fsh%2Fsh.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsh%2Fsh.c?ref=2afeea0fa3280a0fc50945b4d4c3eec30475a0c6", "patch": "@@ -84,7 +84,7 @@ int regno_reg_class[FIRST_PSEUDO_REGISTER] =\n   GENERAL_REGS, GENERAL_REGS, GENERAL_REGS, GENERAL_REGS,\n   GENERAL_REGS, GENERAL_REGS, GENERAL_REGS, GENERAL_REGS,\n   GENERAL_REGS, PR_REGS, T_REGS, NO_REGS,\n-  MAC_REGS, MAC_REGS, FPUL_REGS, NO_REGS,\n+  MAC_REGS, MAC_REGS, FPUL_REGS, GENERAL_REGS,\n   FP0_REGS,FP_REGS, FP_REGS, FP_REGS,\n   FP_REGS, FP_REGS, FP_REGS, FP_REGS,\n   FP_REGS, FP_REGS, FP_REGS, FP_REGS,\n@@ -2074,8 +2074,8 @@ initial_elimination_offset (from, to)\n   int total_saved_regs_space;\n   int total_auto_space = get_frame_size ();\n \n-  int live_regs_mask2;\n-  calc_live_regs (&regs_saved, &live_regs_mask2);\n+  int live_regs_mask, live_regs_mask2;\n+  live_regs_mask = calc_live_regs (&regs_saved, &live_regs_mask2);\n \n   total_saved_regs_space = (regs_saved) * 4;\n \n@@ -2089,6 +2089,19 @@ initial_elimination_offset (from, to)\n   if (from == FRAME_POINTER_REGNUM && to == STACK_POINTER_REGNUM)\n     return 0;\n \n+  if (from == RETURN_ADDRESS_POINTER_REGNUM\n+      && (to == FRAME_POINTER_REGNUM || to == STACK_POINTER_REGNUM))\n+    {\n+      int i, n = 0;\n+      for (i = PR_REG+1; i < 32; i++)\n+\tif (live_regs_mask & (1 << i))\n+\t  n += 4;\n+      for (i = 32; i < FIRST_PSEUDO_REGISTER; i++)\n+\tif (live_regs_mask2 & (1 << (i - 32)))\n+\t  n += 4;\n+      return n + total_auto_space;\n+    }\n+\n   abort ();\n }\n \f"}]}