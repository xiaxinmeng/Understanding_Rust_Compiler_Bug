{"sha": "6d9a0a36e54c29474dc5cd1bafd7efe5600d23e9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmQ5YTBhMzZlNTRjMjk0NzRkYzVjZDFiYWZkN2VmZTU2MDBkMjNlOQ==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2003-08-26T09:16:16Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2003-08-26T09:16:16Z"}, "message": "re PR c++/11871 (Koenig lookup regression)\n\ncp:\n\tPR c++/11871\n\t* decl.c (push_class_level_binding): Correct old_decl value from\n\tmy 2003-07-29 reorganization.\ntestsuite:\n\tPR c++/11871\n\t* c++.dg/lookup/crash1.C: New test.\n\nFrom-SVN: r70803", "tree": {"sha": "2c4c57aeeadaea119c1e2808f2ac3a9936111080", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2c4c57aeeadaea119c1e2808f2ac3a9936111080"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6d9a0a36e54c29474dc5cd1bafd7efe5600d23e9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d9a0a36e54c29474dc5cd1bafd7efe5600d23e9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6d9a0a36e54c29474dc5cd1bafd7efe5600d23e9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d9a0a36e54c29474dc5cd1bafd7efe5600d23e9/comments", "author": null, "committer": null, "parents": [{"sha": "20b506726b1e07f028fa81ffc80f5081aabaea02", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/20b506726b1e07f028fa81ffc80f5081aabaea02", "html_url": "https://github.com/Rust-GCC/gccrs/commit/20b506726b1e07f028fa81ffc80f5081aabaea02"}], "stats": {"total": 42, "additions": 41, "deletions": 1}, "files": [{"sha": "7079968f99073ec267a9dbf00752f34dffdadc2f", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d9a0a36e54c29474dc5cd1bafd7efe5600d23e9/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d9a0a36e54c29474dc5cd1bafd7efe5600d23e9/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=6d9a0a36e54c29474dc5cd1bafd7efe5600d23e9", "patch": "@@ -1,5 +1,9 @@\n 2003-08-26  Nathan Sidwell  <nathan@codesourcery.com>\n \n+\tPR c++/11871\n+\t* decl.c (push_class_level_binding): Correct old_decl value from\n+\tmy 2003-07-29 reorganization.\n+\n \t* call.c (build_call): Don't set TREE_SIDE_EFFECTS here.\n \t(build_new_method_call): Add goto finish.\n \t* semantics.c (simplify_aggr_init_exprs_r): Don't set"}, {"sha": "0f6d09061b8bd3f62895da3b08e028242c16b926", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d9a0a36e54c29474dc5cd1bafd7efe5600d23e9/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d9a0a36e54c29474dc5cd1bafd7efe5600d23e9/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=6d9a0a36e54c29474dc5cd1bafd7efe5600d23e9", "patch": "@@ -4282,11 +4282,13 @@ push_class_level_binding (tree name, tree x)\n \t  if (TREE_CODE (bval) == TYPE_DECL && DECL_ARTIFICIAL (bval)\n \t      && !(TREE_CODE (x) == TYPE_DECL && DECL_ARTIFICIAL (x)))\n \t    {\n+\t      old_decl = BINDING_TYPE (binding);\n \t      BINDING_TYPE (binding) = bval;\n \t      BINDING_VALUE (binding) = NULL_TREE;\n \t      INHERITED_VALUE_BINDING_P (binding) = 0;\n \t    }\n-\t  old_decl = bval;\n+\t  else\n+\t    old_decl = bval;\n \t}\n       else if (TREE_CODE (x) == OVERLOAD && is_overloaded_fn (bval))\n \told_decl = bval;"}, {"sha": "200a4e38d466ad112c834e4d3606712b85d5dd2f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d9a0a36e54c29474dc5cd1bafd7efe5600d23e9/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d9a0a36e54c29474dc5cd1bafd7efe5600d23e9/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6d9a0a36e54c29474dc5cd1bafd7efe5600d23e9", "patch": "@@ -1,5 +1,8 @@\n 2003-08-26  Nathan Sidwell  <nathan@codesourcery.com>\n \n+\tPR c++/11871\n+\t* c++.dg/lookup/crash1.C: New test.\n+\n \t* c++.dg/warn/noeffect3.C: New test.\n \n 2003-08-25  Janis Johnson  <janis187@us.ibm.com>"}, {"sha": "cd90685c70d5a686f5a7f3cd495dfaca57f4c1c0", "filename": "gcc/testsuite/g++.dg/lookup/crash1.C", "status": "added", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d9a0a36e54c29474dc5cd1bafd7efe5600d23e9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fcrash1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d9a0a36e54c29474dc5cd1bafd7efe5600d23e9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fcrash1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fcrash1.C?ref=6d9a0a36e54c29474dc5cd1bafd7efe5600d23e9", "patch": "@@ -0,0 +1,31 @@\n+// { dg-do compile }\n+\n+// Copyright (C) 2003 Free Software Foundation, Inc.\n+// Contributed by Nathan Sidwell 25 Aug 2003 <nathan@codesourcery.com>\n+// Origin pr 11871 Dirk Mueller <mueller@kde.org>\n+\n+// PR c++/11871 Regression\n+\n+namespace std\n+{\n+  class A\n+  {\n+  public:\n+    enum result\n+    {\n+      ok\n+    };\n+  };\n+\n+  template<typename T> class B : public A\n+    {\n+    public:\n+      typedef A::result\tresult;\n+    };\n+}\n+\n+int main()\n+{\n+  for(float result = 1.0;;);\n+}\n+"}]}