{"sha": "85106b8757d46f80a5993fc75948a82ce16c1f74", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODUxMDZiODc1N2Q0NmY4MGE1OTkzZmM3NTk0OGE4MmNlMTZjMWY3NA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2017-03-21T14:49:51Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-03-21T14:49:51Z"}, "message": "re PR target/80125 (r246297 causes segfault in reg_used_between_p())\n\n\tPR target/80125\n\t* combine.c (can_combine_p): Revert the 2017-03-20 change, only\n\tcheck reg_used_between_p between insn and one of succ or succ2\n\tdepending on if succ is artificial insn not inserted into insn\n\tstream.\n\n\t* gcc.target/powerpc/pr80125.c: New test.\n\nCo-Authored-By: Segher Boessenkool <segher@kernel.crashing.org>\n\nFrom-SVN: r246323", "tree": {"sha": "1a81dd0d7abfba195d6e9f2a5236c6a0ae6f0f7c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1a81dd0d7abfba195d6e9f2a5236c6a0ae6f0f7c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/85106b8757d46f80a5993fc75948a82ce16c1f74", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85106b8757d46f80a5993fc75948a82ce16c1f74", "html_url": "https://github.com/Rust-GCC/gccrs/commit/85106b8757d46f80a5993fc75948a82ce16c1f74", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85106b8757d46f80a5993fc75948a82ce16c1f74/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8c0f9dab864878286b6fd16e26d62be4742cd7d6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c0f9dab864878286b6fd16e26d62be4742cd7d6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8c0f9dab864878286b6fd16e26d62be4742cd7d6"}], "stats": {"total": 52, "additions": 47, "deletions": 5}, "files": [{"sha": "03b2a419331e261ffd608ca3b5941d07046b9c3d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85106b8757d46f80a5993fc75948a82ce16c1f74/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85106b8757d46f80a5993fc75948a82ce16c1f74/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=85106b8757d46f80a5993fc75948a82ce16c1f74", "patch": "@@ -1,3 +1,12 @@\n+2017-03-21  Jakub Jelinek  <jakub@redhat.com>\n+\t    Segher Boessenkool  <segher@kernel.crashing.org>\n+\n+\tPR target/80125\n+\t* combine.c (can_combine_p): Revert the 2017-03-20 change, only\n+\tcheck reg_used_between_p between insn and one of succ or succ2\n+\tdepending on if succ is artificial insn not inserted into insn\n+\tstream.\n+\n 2017-03-21  Martin Liska  <mliska@suse.cz>\n \n \tPR gcov-profile/80081"}, {"sha": "c118aa25806be21dcdd4144f86115c8de853386d", "filename": "gcc/combine.c", "status": "modified", "additions": 10, "deletions": 5, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85106b8757d46f80a5993fc75948a82ce16c1f74/gcc%2Fcombine.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85106b8757d46f80a5993fc75948a82ce16c1f74/gcc%2Fcombine.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcombine.c?ref=85106b8757d46f80a5993fc75948a82ce16c1f74", "patch": "@@ -1954,15 +1954,20 @@ can_combine_p (rtx_insn *insn, rtx_insn *i3, rtx_insn *pred ATTRIBUTE_UNUSED,\n       /* Don't substitute into a non-local goto, this confuses CFG.  */\n       || (JUMP_P (i3) && find_reg_note (i3, REG_NON_LOCAL_GOTO, NULL_RTX))\n       /* Make sure that DEST is not used after INSN but before SUCC, or\n-\t between SUCC and SUCC2.  */\n-      || (succ && reg_used_between_p (dest, insn, succ))\n-      || (succ2 && reg_used_between_p (dest, succ, succ2))\n-      /* Make sure that DEST is not used after SUCC but before I3.  */\n+\t after SUCC and before SUCC2, or after SUCC2 but before I3.  */\n       || (!all_adjacent\n \t  && ((succ2\n \t       && (reg_used_between_p (dest, succ2, i3)\n \t\t   || reg_used_between_p (dest, succ, succ2)))\n-\t      || (!succ2 && succ && reg_used_between_p (dest, succ, i3))))\n+\t      || (!succ2 && succ && reg_used_between_p (dest, succ, i3))\n+\t      || (succ\n+\t\t  /* SUCC and SUCC2 can be split halves from a PARALLEL; in\n+\t\t     that case SUCC is not in the insn stream, so use SUCC2\n+\t\t     instead for this test.  */\n+\t\t  && reg_used_between_p (dest, insn,\n+\t\t\t\t\t succ2\n+\t\t\t\t\t && INSN_UID (succ) == INSN_UID (succ2)\n+\t\t\t\t\t ? succ2 : succ))))\n       /* Make sure that the value that is to be substituted for the register\n \t does not use any registers whose values alter in between.  However,\n \t If the insns are adjacent, a use can't cross a set even though we"}, {"sha": "6a87efc180d53405184cdff7a45af7c85ba10d42", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85106b8757d46f80a5993fc75948a82ce16c1f74/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85106b8757d46f80a5993fc75948a82ce16c1f74/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=85106b8757d46f80a5993fc75948a82ce16c1f74", "patch": "@@ -1,3 +1,8 @@\n+2017-03-21  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR target/80125\n+\t* gcc.target/powerpc/pr80125.c: New test.\n+\n 2017-03-21  Bill Schmidt  <wschmidt@linux.vnet.ibm.com>\n             Richard Biener  <rguenther@suse.de>\n "}, {"sha": "494a6e673b1372e413c6812b626187b49178f2ef", "filename": "gcc/testsuite/gcc.target/powerpc/pr80125.c", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85106b8757d46f80a5993fc75948a82ce16c1f74/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr80125.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85106b8757d46f80a5993fc75948a82ce16c1f74/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr80125.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr80125.c?ref=85106b8757d46f80a5993fc75948a82ce16c1f74", "patch": "@@ -0,0 +1,23 @@\n+/* PR target/80125 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -maltivec\" } */\n+\n+#include <altivec.h>\n+\n+int a[1];\n+\n+void\n+foo ()\n+{\n+  vector int b, e, f, g, h, j, n;\n+  vector unsigned c, d;\n+  f = vec_sums (h, b);\n+  vector int i = vec_mergel (f, g);\n+  vector int k = vec_mergel (i, j);\n+  vector int l = vec_sl (k, c);\n+  vector int m = vec_sl (l, d);\n+  vector char o;\n+  vector int p = vec_perm (m, n, o);\n+  e = vec_sra (p, c);\n+  vec_st (e, 0, a);\n+}"}]}