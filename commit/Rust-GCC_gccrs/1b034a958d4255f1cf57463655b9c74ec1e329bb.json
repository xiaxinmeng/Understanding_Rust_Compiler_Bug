{"sha": "1b034a958d4255f1cf57463655b9c74ec1e329bb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWIwMzRhOTU4ZDQyNTVmMWNmNTc0NjM2NTViOWM3NGVjMWUzMjliYg==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2019-07-14T22:52:58Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2019-07-14T22:52:58Z"}, "message": "re PR fortran/87233 (Constraint C1279 still followed after f2008 standard revision (?))\n\n2019-07-14  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n\n\tPR fortran/87233\n\t* expr.c (check_restricted): Relax constraint C1279 which was\n\tremoved from F2008 and above.\n\n\t* gfortran.dg/initialization_14.f90: Modify to now pass by\n\tremoving two dg-error commands. Added comments.\n\t* gfortran.dg/initialization_30.f90: New test that includes the\n\ttwo tests removed above with the 'dg-options -std=f95'.\n\nFrom-SVN: r273484", "tree": {"sha": "f8fb10ad522b358bed6b32e200069c3a57d816db", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f8fb10ad522b358bed6b32e200069c3a57d816db"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1b034a958d4255f1cf57463655b9c74ec1e329bb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1b034a958d4255f1cf57463655b9c74ec1e329bb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1b034a958d4255f1cf57463655b9c74ec1e329bb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1b034a958d4255f1cf57463655b9c74ec1e329bb/comments", "author": null, "committer": null, "parents": [{"sha": "c5e02838afa5a79091dc22b480951fc5effb42e6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c5e02838afa5a79091dc22b480951fc5effb42e6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c5e02838afa5a79091dc22b480951fc5effb42e6"}], "stats": {"total": 51, "additions": 44, "deletions": 7}, "files": [{"sha": "c92c85a3a76a3b68a7a2b4fded6a969788002ecb", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1b034a958d4255f1cf57463655b9c74ec1e329bb/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1b034a958d4255f1cf57463655b9c74ec1e329bb/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=1b034a958d4255f1cf57463655b9c74ec1e329bb", "patch": "@@ -1,3 +1,9 @@\n+2019-07-14  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\tPR fortran/87233\n+\t* expr.c (check_restricted): Relax constraint C1279 which was\n+\tremoved from F2008 and above.\n+\n 2019-07-07  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/91077"}, {"sha": "a1643707662a794b32bac3b93d088c0696ef6eee", "filename": "gcc/fortran/expr.c", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1b034a958d4255f1cf57463655b9c74ec1e329bb/gcc%2Ffortran%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1b034a958d4255f1cf57463655b9c74ec1e329bb/gcc%2Ffortran%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fexpr.c?ref=1b034a958d4255f1cf57463655b9c74ec1e329bb", "patch": "@@ -3305,12 +3305,14 @@ check_restricted (gfc_expr *e)\n \t restricted expression in an elemental procedure, it will have\n \t already been simplified away once we get here.  Therefore we\n \t don't need to jump through hoops to distinguish valid from\n-\t invalid cases.  */\n-      if (sym->attr.dummy && sym->ns == gfc_current_ns\n+\t invalid cases.  Allowed in F2008 and F2018.  */\n+      if (gfc_notification_std (GFC_STD_F2008)\n+\t  && sym->attr.dummy && sym->ns == gfc_current_ns\n \t  && sym->ns->proc_name && sym->ns->proc_name->attr.elemental)\n \t{\n-\t  gfc_error (\"Dummy argument %qs not allowed in expression at %L\",\n-\t\t     sym->name, &e->where);\n+\t  gfc_error_now (\"Dummy argument %qs not \"\n+\t\t\t \"allowed in expression at %L\",\n+\t\t\t sym->name, &e->where);\n \t  break;\n \t}\n "}, {"sha": "ae16c7da40885162d256d293ed23a6d9deeda528", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1b034a958d4255f1cf57463655b9c74ec1e329bb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1b034a958d4255f1cf57463655b9c74ec1e329bb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1b034a958d4255f1cf57463655b9c74ec1e329bb", "patch": "@@ -1,3 +1,11 @@\n+2019-07-14  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\tPR fortran/87233\n+\t* gfortran.dg/initialization_14.f90: Modify to now pass by\n+\tremoving two dg-error commands. Added comments.\n+\t* gfortran.dg/initialization_30.f90: New test that includes the\n+\ttwo tests removed above with the 'dg-options -std=f95'.\n+\n 2019-07-14  Uro\u0161 Bizjak  <ubizjak@gmail.com>\n \n \t* gcc.dg/tree-ssa/pr84512.c (dg-final): Remove XFAIL on alpha*-*-*."}, {"sha": "aa1437719aca71b91ca1ca11374dbcfc0e209ad9", "filename": "gcc/testsuite/gfortran.dg/initialization_14.f90", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1b034a958d4255f1cf57463655b9c74ec1e329bb/gcc%2Ftestsuite%2Fgfortran.dg%2Finitialization_14.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1b034a958d4255f1cf57463655b9c74ec1e329bb/gcc%2Ftestsuite%2Fgfortran.dg%2Finitialization_14.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Finitialization_14.f90?ref=1b034a958d4255f1cf57463655b9c74ec1e329bb", "patch": "@@ -3,18 +3,18 @@\n ! Dummy arguments are disallowed in initialization expressions in\n ! elemental functions except as arguments to the intrinsic functions\n ! BIT_SIZE, KIND, LEN, or to the numeric inquiry functions listed\n-! in 13.11.8\n+! in 13.11.8 F95, likewise not allowed in F2003, now allowed in F2008.\n MODULE TT\n INTEGER M\n CONTAINS\n    ELEMENTAL REAL FUNCTION two(N)\n      INTEGER, INTENT(IN) :: N\n-     INTEGER, DIMENSION(N) :: scr ! { dg-error \"Dummy argument 'n' not allowed in expression\" }\n+     INTEGER, DIMENSION(N) :: scr ! Now valid under F2008\n    END FUNCTION\n \n    ELEMENTAL REAL FUNCTION twopointfive(N)\n      INTEGER, INTENT(IN) :: N\n-     INTEGER, DIMENSION(MAX(N,2)) :: scr ! { dg-error \"Dummy argument 'n' not allowed in expression\" }\n+     INTEGER, DIMENSION(MAX(N,2)) :: scr ! Now valid under F2008\n    end FUNCTION twopointfive\n \n    REAL FUNCTION three(N)"}, {"sha": "ff8436bc7c9ff7fcdeb74fe539d603bf859200a3", "filename": "gcc/testsuite/gfortran.dg/initialization_30.f90", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1b034a958d4255f1cf57463655b9c74ec1e329bb/gcc%2Ftestsuite%2Fgfortran.dg%2Finitialization_30.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1b034a958d4255f1cf57463655b9c74ec1e329bb/gcc%2Ftestsuite%2Fgfortran.dg%2Finitialization_30.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Finitialization_30.f90?ref=1b034a958d4255f1cf57463655b9c74ec1e329bb", "patch": "@@ -0,0 +1,21 @@\n+! { dg-do compile }\n+! { dg-options \"-std=f95\" }\n+! PR 20851\n+! Dummy arguments are disallowed in initialization expressions in\n+! elemental functions except as arguments to the intrinsic functions\n+! BIT_SIZE, KIND, LEN, or to the numeric inquiry functions listed\n+! in 13.11.8\n+MODULE TT\n+INTEGER M\n+CONTAINS\n+   ELEMENTAL REAL FUNCTION two(N)\n+     INTEGER, INTENT(IN) :: N\n+     INTEGER, DIMENSION(N) :: scr ! { dg-error \"Dummy argument 'n' not allowed in expression\" }\n+   END FUNCTION\n+\n+   ELEMENTAL REAL FUNCTION twopointfive(N)\n+     INTEGER, INTENT(IN) :: N\n+     INTEGER, DIMENSION(MAX(N,2)) :: scr ! { dg-error \"Dummy argument 'n' not allowed in expression\" }\n+   end FUNCTION twopointfive\n+END MODULE\n+END"}]}