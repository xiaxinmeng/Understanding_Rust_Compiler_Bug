{"sha": "41eff652935a9cbeb7d26a7742dcf2040c78e431", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDFlZmY2NTI5MzVhOWNiZWI3ZDI2YTc3NDJkY2YyMDQwYzc4ZTQzMQ==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@yorick.cygnus.com", "date": "1999-01-16T16:44:35Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "1999-01-16T16:44:35Z"}, "message": "decl.c (grokdeclarator): Don't make 'main(){}' an error with only -Wreturn-type.\n\n\t* decl.c (grokdeclarator): Don't make 'main(){}' an error with only\n\t-Wreturn-type.\n\nCo-Authored-By: Manfred Hollstein <manfred@s-direktnet.de>\n\nFrom-SVN: r24704", "tree": {"sha": "91f852ffee6c0f09aeed47783bad1e998988a1f4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/91f852ffee6c0f09aeed47783bad1e998988a1f4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/41eff652935a9cbeb7d26a7742dcf2040c78e431", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/41eff652935a9cbeb7d26a7742dcf2040c78e431", "html_url": "https://github.com/Rust-GCC/gccrs/commit/41eff652935a9cbeb7d26a7742dcf2040c78e431", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/41eff652935a9cbeb7d26a7742dcf2040c78e431/comments", "author": null, "committer": null, "parents": [{"sha": "db838bb85b280d924ff9967471871739c129ff73", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/db838bb85b280d924ff9967471871739c129ff73", "html_url": "https://github.com/Rust-GCC/gccrs/commit/db838bb85b280d924ff9967471871739c129ff73"}], "stats": {"total": 28, "additions": 20, "deletions": 8}, "files": [{"sha": "554d85f5c32c2ec586bc4ad5811f0ce7753cf5e1", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/41eff652935a9cbeb7d26a7742dcf2040c78e431/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/41eff652935a9cbeb7d26a7742dcf2040c78e431/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=41eff652935a9cbeb7d26a7742dcf2040c78e431", "patch": "@@ -1,3 +1,9 @@\n+1999-01-16  Jason Merrill  <jason@yorick.cygnus.com>\n+\t    Manfred Hollstein <manfred@s-direktnet.de>\n+\n+\t* decl.c (grokdeclarator): Don't make 'main(){}' an error with only\n+\t-Wreturn-type.\n+\n 1999-01-16  Nathan Sidwell  <nathan@acm.org>\n \n \t* cp-tree.h (struct lang_type): Added has_mutable flag."}, {"sha": "13c11bfcba7f6ae97482f8d2eb5485fd327c3002", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 14, "deletions": 8, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/41eff652935a9cbeb7d26a7742dcf2040c78e431/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/41eff652935a9cbeb7d26a7742dcf2040c78e431/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=41eff652935a9cbeb7d26a7742dcf2040c78e431", "patch": "@@ -9356,16 +9356,22 @@ grokdeclarator (declarator, declspecs, decl_context, initialized, attrlist)\n \t}\n       else\n \t{\n-\t  if (! pedantic && ! warn_return_type\n-\t      && funcdef_flag\n-\t      && MAIN_NAME_P (dname)\n-\t      && ctype == NULL_TREE\n-\t      && in_namespace == NULL_TREE\n-\t      && current_namespace == global_namespace)\n-\t    /* Let `main () { }' slide, since it's so common.  */;\n-\t  else\n+\t  /* We handle `main' specially here, because 'main () { }' is so\n+\t     common.  With no options, it is allowed.  With -Wreturn-type,\n+\t     it is a warning.  It is only an error with -pedantic-errors.  */\n+\t  int is_main = (funcdef_flag\n+\t\t\t && MAIN_NAME_P (dname)\n+\t\t\t && ctype == NULL_TREE\n+\t\t\t && in_namespace == NULL_TREE\n+\t\t\t && current_namespace == global_namespace);\n+\n+\t  if (pedantic || ! is_main)\n \t    cp_pedwarn (\"ANSI C++ forbids declaration `%D' with no type\",\n \t\t\tdname);\n+\t  else if (warn_return_type)\n+\t    cp_warning (\"ANSI C++ forbids declaration `%D' with no type\",\n+\t\t\tdname);\n+\n \t  type = integer_type_node;\n \t}\n     }"}]}