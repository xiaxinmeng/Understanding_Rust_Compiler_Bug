{"sha": "7b3f937f00f4d14bb1606407b3af663645863446", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2IzZjkzN2YwMGY0ZDE0YmIxNjA2NDA3YjNhZjY2MzY0NTg2MzQ0Ng==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-06-18T13:54:07Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-06-18T13:54:07Z"}, "message": "[multiple changes]\n\n2010-06-18  Ed Schonberg  <schonberg@adacore.com>\n\n\t* sem_elim.adb: Proper error message on improperly eliminated instances\n\n2010-06-18  Vincent Celier  <celier@adacore.com>\n\n\t* prj.ads (Response_File_Format): New value GCC.\n\n2010-06-18  Thomas Quinot  <quinot@adacore.com>\n\n\t* gnat1drv.adb: Minor reformatting.\n\nFrom-SVN: r160992", "tree": {"sha": "c6f4afc7cb01f555c6290ff6b90b03372ce383ba", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c6f4afc7cb01f555c6290ff6b90b03372ce383ba"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7b3f937f00f4d14bb1606407b3af663645863446", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7b3f937f00f4d14bb1606407b3af663645863446", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7b3f937f00f4d14bb1606407b3af663645863446", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7b3f937f00f4d14bb1606407b3af663645863446/comments", "author": null, "committer": null, "parents": [{"sha": "1cf3727fb9a42a5d52ff9c239e4e98053e079e79", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1cf3727fb9a42a5d52ff9c239e4e98053e079e79", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1cf3727fb9a42a5d52ff9c239e4e98053e079e79"}], "stats": {"total": 43, "additions": 31, "deletions": 12}, "files": [{"sha": "e0334226b000af5ccc6769a69fbdcf2b8ebb545b", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7b3f937f00f4d14bb1606407b3af663645863446/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7b3f937f00f4d14bb1606407b3af663645863446/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=7b3f937f00f4d14bb1606407b3af663645863446", "patch": "@@ -1,3 +1,15 @@\n+2010-06-18  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* sem_elim.adb: Proper error message on improperly eliminated instances\n+\n+2010-06-18  Vincent Celier  <celier@adacore.com>\n+\n+\t* prj.ads (Response_File_Format): New value GCC.\n+\n+2010-06-18  Thomas Quinot  <quinot@adacore.com>\n+\n+\t* gnat1drv.adb: Minor reformatting.\n+\n 2010-06-18  Robert Dewar  <dewar@adacore.com>\n \n \t* make.adb, sem_cat.adb: Minor reformatting."}, {"sha": "85d9dcc950bcece52da94815bc1ad76d1ec4f26d", "filename": "gcc/ada/gnat1drv.adb", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7b3f937f00f4d14bb1606407b3af663645863446/gcc%2Fada%2Fgnat1drv.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7b3f937f00f4d14bb1606407b3af663645863446/gcc%2Fada%2Fgnat1drv.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat1drv.adb?ref=7b3f937f00f4d14bb1606407b3af663645863446", "patch": "@@ -353,8 +353,8 @@ procedure Gnat1drv is\n       then\n          Use_Expression_With_Actions := False;\n \n-         --  Otherwise normal gcc back end, which does implement this feature\n-         --  so by default we allow its use.\n+      --  Otherwise normal gcc back end, which does implement this feature so\n+      --  by default we allow its use.\n \n       else\n          Use_Expression_With_Actions := True;"}, {"sha": "434145027e26f185b2cc288e5178f8fb47e1113d", "filename": "gcc/ada/prj.ads", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7b3f937f00f4d14bb1606407b3af663645863446/gcc%2Fada%2Fprj.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7b3f937f00f4d14bb1606407b3af663645863446/gcc%2Fada%2Fprj.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.ads?ref=7b3f937f00f4d14bb1606407b3af663645863446", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 2001-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2001-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -894,6 +894,7 @@ package Prj is\n    type Response_File_Format is\n      (None,\n       GNU,\n+      GCC,\n       Object_List,\n       Option_List);\n    --  The format of the different response files"}, {"sha": "97faf84877ffb53c36345f5604aeaf4e79a3c79f", "filename": "gcc/ada/sem_elim.adb", "status": "modified", "additions": 15, "deletions": 9, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7b3f937f00f4d14bb1606407b3af663645863446/gcc%2Fada%2Fsem_elim.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7b3f937f00f4d14bb1606407b3af663645863446/gcc%2Fada%2Fsem_elim.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_elim.adb?ref=7b3f937f00f4d14bb1606407b3af663645863446", "patch": "@@ -344,10 +344,9 @@ package body Sem_Elim is\n             if Present (Elmt.Entity_Node)\n               and then Elmt.Entity_Scope /= null\n             then\n-\n-               --  Check that names of enclosing scopes match.\n-               --  Skip blocks and wrapper package of subprogram instances,\n-               --  which do not appear in the pragma.\n+               --  Check that names of enclosing scopes match. Skip blocks and\n+               --  wrapper package of subprogram instances, which do not appear\n+               --  in the pragma.\n \n                Scop := Scope (E);\n \n@@ -723,14 +722,19 @@ package body Sem_Elim is\n             Enclosing_Subp := Enclosing_Subprogram (Enclosing_Subp);\n          end loop;\n \n-         --  Emit error, unless we are within an instance body and\n-         --  the expander is disabled, which indicates an instance\n-         --  within an enclosing generic.\n+         --  Emit error, unless we are within an instance body and the expander\n+         --  is disabled, indicating an instance within an enclosing generic.\n+         --  In an instance, the ultimate alias is an internal entity, so place\n+         --  the message on the original subprogram.\n \n          if In_Instance_Body and then not Expander_Active then\n             null;\n-         else\n+\n+         elsif Comes_From_Source (Ultimate_Subp) then\n             Eliminate_Error_Msg (N, Ultimate_Subp);\n+\n+         else\n+            Eliminate_Error_Msg (N, S);\n          end if;\n       end if;\n    end Check_For_Eliminated_Subprogram;\n@@ -762,7 +766,9 @@ package body Sem_Elim is\n       --  Otherwise should not fall through, entry should be in table\n \n       else\n-         raise Program_Error;\n+         Error_Msg_NE\n+           (\"subprogram& is called but its alias is eliminated\", N, E);\n+         --  raise Program_Error;\n       end if;\n    end Eliminate_Error_Msg;\n "}]}