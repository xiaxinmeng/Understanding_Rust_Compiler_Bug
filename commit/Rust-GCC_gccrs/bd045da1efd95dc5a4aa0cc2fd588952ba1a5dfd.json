{"sha": "bd045da1efd95dc5a4aa0cc2fd588952ba1a5dfd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmQwNDVkYTFlZmQ5NWRjNWE0YWEwY2MyZmQ1ODg5NTJiYTFhNWRmZA==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2007-03-18T18:17:24Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2007-03-18T18:17:24Z"}, "message": "re PR libfortran/31052 ([4.2 only] Bad IOSTAT values when readings NAMELISTs past EOF)\n\n2007-03-18  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n\n\tPR libgfortran/31052\n\t* gfortran.dg/namelist_27.f90: New test.\n\nFrom-SVN: r123039", "tree": {"sha": "329f5bcbb6148f59e92f738fff261fed6da21f44", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/329f5bcbb6148f59e92f738fff261fed6da21f44"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bd045da1efd95dc5a4aa0cc2fd588952ba1a5dfd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd045da1efd95dc5a4aa0cc2fd588952ba1a5dfd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bd045da1efd95dc5a4aa0cc2fd588952ba1a5dfd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd045da1efd95dc5a4aa0cc2fd588952ba1a5dfd/comments", "author": null, "committer": null, "parents": [{"sha": "7ab8aa36203ef49ae94f239ca6b148ac99922e46", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7ab8aa36203ef49ae94f239ca6b148ac99922e46", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7ab8aa36203ef49ae94f239ca6b148ac99922e46"}], "stats": {"total": 111, "additions": 111, "deletions": 0}, "files": [{"sha": "8e36820aa5e44bcc74989339d062b567f20dacf7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd045da1efd95dc5a4aa0cc2fd588952ba1a5dfd/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd045da1efd95dc5a4aa0cc2fd588952ba1a5dfd/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bd045da1efd95dc5a4aa0cc2fd588952ba1a5dfd", "patch": "@@ -1,3 +1,8 @@\n+2007-03-18  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\tPR libgfortran/31052\n+\t* gfortran.dg/namelist_27.f90: New test.\n+\n 2007-03-18  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/30531"}, {"sha": "10b0031e89450f7337f485de6b26997c7a6d3f09", "filename": "gcc/testsuite/gfortran.dg/namelist_27.f90", "status": "added", "additions": 106, "deletions": 0, "changes": 106, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd045da1efd95dc5a4aa0cc2fd588952ba1a5dfd/gcc%2Ftestsuite%2Fgfortran.dg%2Fnamelist_27.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd045da1efd95dc5a4aa0cc2fd588952ba1a5dfd/gcc%2Ftestsuite%2Fgfortran.dg%2Fnamelist_27.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fnamelist_27.f90?ref=bd045da1efd95dc5a4aa0cc2fd588952ba1a5dfd", "patch": "@@ -0,0 +1,106 @@\n+! { dg-do run }\n+! PR31052 Bad IOSTAT values when readings NAMELISTs past EOF.\n+! Patch derived from PR, submitted by Jerry DeLisle <jvdelisle@gcc.gnu.org>\n+program gfcbug61\n+  implicit none\n+  integer            :: stat\n+\n+  open (12, status=\"scratch\")\n+  write (12, '(a)')\"!================\"\n+  write (12, '(a)')\"! Namelist REPORT\"\n+  write (12, '(a)')\"!================\"\n+  write (12, '(a)')\" &REPORT type     = 'SYNOP' \"\n+  write (12, '(a)')\"         use      = 'active'\"\n+  write (12, '(a)')\"         max_proc = 20\"\n+  write (12, '(a)')\" /\"\n+  write (12, '(a)')\"! Other namelists...\"\n+  write (12, '(a)')\" &OTHER  i = 1 /\"\n+  rewind (12)\n+\n+  ! Read /REPORT/ the first time\n+  rewind (12)\n+  call position_nml (12, \"REPORT\", stat)\n+  if (stat.ne.0) call abort()\n+  if (stat == 0)  call read_report (12, stat)\n+\n+  ! Comment out the following lines to hide the bug\n+  rewind (12)\n+  call position_nml (12, \"MISSING\", stat)\n+  if (stat.ne.-1)  call abort ()\n+\n+  ! Read /REPORT/ again\n+  rewind (12)\n+  call position_nml (12, \"REPORT\", stat)\n+  if (stat.ne.0)  call abort()\n+\n+contains\n+\n+  subroutine position_nml (unit, name, status)\n+    ! Check for presence of namelist 'name'\n+    integer                      :: unit, status\n+    character(len=*), intent(in) :: name\n+\n+    character(len=255) :: line\n+    integer            :: ios, idx\n+    logical            :: first\n+\n+    first = .true.\n+    status = 0\n+    ios = 0\n+    line = \"\"\n+    do\n+       read (unit,'(a)',iostat=ios) line\n+       if (first) then\n+          first = .false.\n+       end if\n+       if (ios < 0) then\n+          ! EOF encountered!\n+          backspace (unit)\n+          status = -1\n+          return\n+       else if (ios > 0) then\n+          ! Error encountered!\n+          status = +1\n+          return\n+       end if\n+       idx = index (line, \"&\"//trim (name))\n+       if (idx > 0) then\n+          backspace (unit)\n+          return\n+       end if\n+    end do\n+  end subroutine position_nml\n+\n+  subroutine read_report (unit, status)\n+    integer :: unit, status\n+\n+    integer            :: iuse, ios\n+    !------------------\n+    ! Namelist 'REPORT'\n+    !------------------\n+    character(len=12) :: type, use\n+    integer           :: max_proc\n+    namelist /REPORT/ type, use, max_proc\n+    !-------------------------------------\n+    ! Loop to read namelist multiple times\n+    !-------------------------------------\n+    iuse = 0\n+    do\n+       !----------------------------------------\n+       ! Preset namelist variables with defaults\n+       !----------------------------------------\n+       type      = ''\n+       use       = ''\n+       max_proc  = -1\n+       !--------------\n+       ! Read namelist\n+       !--------------\n+       read (unit, nml=REPORT, iostat=ios)\n+       if (ios /= 0) exit\n+       iuse = iuse + 1\n+    end do\n+    if (iuse.ne.1) call abort()\n+    status = ios\n+  end subroutine read_report\n+\n+end program gfcbug61\n\\ No newline at end of file"}]}