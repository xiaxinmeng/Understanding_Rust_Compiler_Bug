{"sha": "27bd251b64e5c1eb756d0de7e57c7b485a1c395b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjdiZDI1MWI2NGU1YzFlYjc1NmQwZGU3ZTU3YzdiNDg1YTFjMzk1Yg==", "commit": {"author": {"name": "Ian Bolton", "email": "ian.bolton@arm.com", "date": "2013-10-24T14:31:45Z"}, "committer": {"name": "Marcus Shawcroft", "email": "mshawcroft@gcc.gnu.org", "date": "2013-10-24T14:31:45Z"}, "message": "[AArch64,PATCH] Adjust preferred_reload_class of SP+C\n\nCo-Authored-By: Marcus Shawcroft <marcus.shawcroft@arm.com>\n\nFrom-SVN: r204018", "tree": {"sha": "9836a80ebbbdafeb6c37abde5beecfb3b6a94187", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9836a80ebbbdafeb6c37abde5beecfb3b6a94187"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/27bd251b64e5c1eb756d0de7e57c7b485a1c395b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/27bd251b64e5c1eb756d0de7e57c7b485a1c395b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/27bd251b64e5c1eb756d0de7e57c7b485a1c395b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/27bd251b64e5c1eb756d0de7e57c7b485a1c395b/comments", "author": null, "committer": null, "parents": [{"sha": "ac63f3057f0f5a6d517532269821266bcb406cd9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac63f3057f0f5a6d517532269821266bcb406cd9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ac63f3057f0f5a6d517532269821266bcb406cd9"}], "stats": {"total": 24, "additions": 24, "deletions": 0}, "files": [{"sha": "60a9547df817a1f153690e71de1b74186fa2d8ac", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/27bd251b64e5c1eb756d0de7e57c7b485a1c395b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/27bd251b64e5c1eb756d0de7e57c7b485a1c395b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=27bd251b64e5c1eb756d0de7e57c7b485a1c395b", "patch": "@@ -1,3 +1,9 @@\n+2013-10-17  Ian Bolton  <ian.bolton@arm.com>\n+\t    Marcus Shawcroft  <marcus.shawcroft@arm.com>\n+\n+\t* config/aarch64/aarch64.c (aarch64_preferred_reload_class):\n+\tSpecial case reload SP+C into none GENERAL_REGS.\n+\n 2013-10-24  Michael Matz  <matz@suse.de>\n \n \t* gengtype.c (is_file_equal): Check that files will be same"}, {"sha": "83d0c66706062c311cf24be248ba9541c973c48e", "filename": "gcc/config/aarch64/aarch64.c", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/27bd251b64e5c1eb756d0de7e57c7b485a1c395b/gcc%2Fconfig%2Faarch64%2Faarch64.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/27bd251b64e5c1eb756d0de7e57c7b485a1c395b/gcc%2Fconfig%2Faarch64%2Faarch64.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64.c?ref=27bd251b64e5c1eb756d0de7e57c7b485a1c395b", "patch": "@@ -4263,6 +4263,24 @@ aarch64_preferred_reload_class (rtx x, reg_class_t regclass)\n       && !aarch64_simd_imm_scalar_p (x, GET_MODE (x)))\n     return NO_REGS;\n \n+  /* Register eliminiation can result in a request for\n+     SP+constant->FP_REGS.  We cannot support such operations which\n+     use SP as source and an FP_REG as destination, so reject out\n+     right now.  */\n+  if (! reg_class_subset_p (regclass, GENERAL_REGS) && GET_CODE (x) == PLUS)\n+    {\n+      rtx lhs = XEXP (x, 0);\n+\n+      /* Look through a possible SUBREG introduced by ILP32.  */\n+      if (GET_CODE (lhs) == SUBREG)\n+\tlhs = SUBREG_REG (lhs);\n+\n+      gcc_assert (REG_P (lhs));\n+      gcc_assert (reg_class_subset_p (REGNO_REG_CLASS (REGNO (lhs)),\n+\t\t\t\t      POINTER_REGS));\n+      return NO_REGS;\n+    }\n+\n   return regclass;\n }\n "}]}