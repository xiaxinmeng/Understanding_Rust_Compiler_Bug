{"sha": "ad2c91b25108791bd3acae34beff5510f031fcbf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWQyYzkxYjI1MTA4NzkxYmQzYWNhZTM0YmVmZjU1MTBmMDMxZmNiZg==", "commit": {"author": {"name": "Andreas Krebbel", "email": "krebbel@linux.vnet.ibm.com", "date": "2017-10-09T12:07:54Z"}, "committer": {"name": "Andreas Krebbel", "email": "krebbel@gcc.gnu.org", "date": "2017-10-09T12:07:54Z"}, "message": "S/390: PR82463: Fix vec_madd header file definition\n\nThe builtin was not correctly defined in the vecintrin.h header file.\n\ngcc/testsuite/ChangeLog:\n\n2017-10-09  Andreas Krebbel  <krebbel@linux.vnet.ibm.com>\n\n\tPR target/82463\n\t* gcc.target/s390/zvector/pr82463.c: New test.\n\ngcc/ChangeLog:\n\n2017-10-09  Andreas Krebbel  <krebbel@linux.vnet.ibm.com>\n\n\tPR target/82463\n\t* config/s390/vecintrin.h (vec_madd, vec_msub): Fix macro\n\tdefinitions.\n\nFrom-SVN: r253543", "tree": {"sha": "a8f61e1abcecfc810252d8eb7bfb1ea56c823821", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a8f61e1abcecfc810252d8eb7bfb1ea56c823821"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ad2c91b25108791bd3acae34beff5510f031fcbf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad2c91b25108791bd3acae34beff5510f031fcbf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ad2c91b25108791bd3acae34beff5510f031fcbf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad2c91b25108791bd3acae34beff5510f031fcbf/comments", "author": null, "committer": null, "parents": [{"sha": "3141e768ee22a6dda9a5aaf6201191bdbc46a6e0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3141e768ee22a6dda9a5aaf6201191bdbc46a6e0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3141e768ee22a6dda9a5aaf6201191bdbc46a6e0"}], "stats": {"total": 29, "additions": 27, "deletions": 2}, "files": [{"sha": "aaff01a7f723334e8e4c49975ecd27d04852c87a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad2c91b25108791bd3acae34beff5510f031fcbf/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad2c91b25108791bd3acae34beff5510f031fcbf/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ad2c91b25108791bd3acae34beff5510f031fcbf", "patch": "@@ -1,3 +1,9 @@\n+2017-10-09  Andreas Krebbel  <krebbel@linux.vnet.ibm.com>\n+\n+\tPR target/82463\n+\t* config/s390/vecintrin.h (vec_madd, vec_msub): Fix macro\n+\tdefinitions.\n+\n 2017-10-09  Andreas Krebbel  <krebbel@linux.vnet.ibm.com>\n \n \tPR target/82465"}, {"sha": "80eb2b30867c543fbf8fc4485e9e0d26ecf694e4", "filename": "gcc/config/s390/vecintrin.h", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad2c91b25108791bd3acae34beff5510f031fcbf/gcc%2Fconfig%2Fs390%2Fvecintrin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad2c91b25108791bd3acae34beff5510f031fcbf/gcc%2Fconfig%2Fs390%2Fvecintrin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fs390%2Fvecintrin.h?ref=ad2c91b25108791bd3acae34beff5510f031fcbf", "patch": "@@ -113,8 +113,6 @@ __lcbb(const void *ptr, int bndry)\n #define vec_unsigned(X) __builtin_s390_vclgdb((X), 0, 0)\n #define vec_doublee(X) __builtin_s390_vfll((X))\n #define vec_floate(X) __builtin_s390_vflr((X), 0, 0)\n-#define vec_madd __builtin_s390_vfmadb\n-#define vec_msub __builtin_s390_vfmsdb\n #define vec_load_len_r(X,Y) __builtin_s390_vlrl((Y),(X))\n #define vec_store_len_r(X,Y) __builtin_s390_vstrl((Y),(X))\n \n@@ -306,6 +304,8 @@ __lcbb(const void *ptr, int bndry)\n #define vec_ld2f __builtin_s390_vec_ld2f\n #define vec_st2f __builtin_s390_vec_st2f\n #define vec_double __builtin_s390_vec_double\n+#define vec_madd __builtin_s390_vec_madd\n+#define vec_msub __builtin_s390_vec_msub\n #define vec_nmadd __builtin_s390_vec_nmadd\n #define vec_nmsub __builtin_s390_vec_nmsub\n #define vec_nabs __builtin_s390_vec_nabs"}, {"sha": "ae952c9cfb02f33db41a9f554a429e39120fe3ba", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad2c91b25108791bd3acae34beff5510f031fcbf/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad2c91b25108791bd3acae34beff5510f031fcbf/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ad2c91b25108791bd3acae34beff5510f031fcbf", "patch": "@@ -1,3 +1,8 @@\n+2017-10-09  Andreas Krebbel  <krebbel@linux.vnet.ibm.com>\n+\n+\tPR target/82463\n+\t* gcc.target/s390/zvector/pr82463.c: New test.\n+\n 2017-10-09  Andreas Krebbel  <krebbel@linux.vnet.ibm.com>\n \n \tPR target/82465"}, {"sha": "5014ed61ad94f06d4a8ce3a0ad47c21e33fbfdb4", "filename": "gcc/testsuite/gcc.target/s390/zvector/pr82463.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad2c91b25108791bd3acae34beff5510f031fcbf/gcc%2Ftestsuite%2Fgcc.target%2Fs390%2Fzvector%2Fpr82463.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad2c91b25108791bd3acae34beff5510f031fcbf/gcc%2Ftestsuite%2Fgcc.target%2Fs390%2Fzvector%2Fpr82463.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fs390%2Fzvector%2Fpr82463.c?ref=ad2c91b25108791bd3acae34beff5510f031fcbf", "patch": "@@ -0,0 +1,14 @@\n+/* { dg-do compile { target { s390*-*-* } } } */\n+/* { dg-options \"-march=z14 -mzarch -mzvector\" } */\n+\n+/* The builtin was not correctly defined in the vecintrin.h header\n+   file.  */\n+\n+#include <vecintrin.h>\n+\n+typedef __vector float v4sf;\n+\n+v4sf\n+foo (v4sf a, v4sf b, v4sf c) {\n+  return vec_madd(a, b, c);\n+}"}]}