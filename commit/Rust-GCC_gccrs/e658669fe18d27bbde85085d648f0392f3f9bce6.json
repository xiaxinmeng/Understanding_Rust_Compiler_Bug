{"sha": "e658669fe18d27bbde85085d648f0392f3f9bce6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTY1ODY2OWZlMThkMjdiYmRlODUwODVkNjQ4ZjAzOTJmM2Y5YmNlNg==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2019-01-24T15:39:25Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2019-01-24T15:39:25Z"}, "message": "PR libstdc++/88840 delay evaluation of constant until type is complete\n\nClang fails to compile std::vector<Incomplete> because the static member\n__use_relocate cannot be evaluated for an incomplete type. Replace with\na static member function that will not be odr-used until needed, by\nwhich point the type must be complete.\n\n\tPR libstdc++/88840\n\t* include/bits/stl_vector.h (vector::__use_relocate): Replace static\n\tdata member with static member function _S_use_relocate().\n\t* include/bits/vector.tcc (vector::reserve, vector::_M_realloc_insert)\n\t(vector::_M_default_append): Use _S_use_relocate() instead of\n\t__use_relocate.\n\nFrom-SVN: r268239", "tree": {"sha": "eddfdc9e4eb573f87f18f3b2ca3d2c5ed4443a5f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/eddfdc9e4eb573f87f18f3b2ca3d2c5ed4443a5f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e658669fe18d27bbde85085d648f0392f3f9bce6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e658669fe18d27bbde85085d648f0392f3f9bce6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e658669fe18d27bbde85085d648f0392f3f9bce6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e658669fe18d27bbde85085d648f0392f3f9bce6/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "400a08e28429f2c56c2298908be673a5951d5e20", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/400a08e28429f2c56c2298908be673a5951d5e20", "html_url": "https://github.com/Rust-GCC/gccrs/commit/400a08e28429f2c56c2298908be673a5951d5e20"}], "stats": {"total": 28, "additions": 19, "deletions": 9}, "files": [{"sha": "7a1deca18cb85b45fc40c7501db6f18c0bb1b451", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e658669fe18d27bbde85085d648f0392f3f9bce6/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e658669fe18d27bbde85085d648f0392f3f9bce6/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=e658669fe18d27bbde85085d648f0392f3f9bce6", "patch": "@@ -1,5 +1,12 @@\n 2019-01-24  Jonathan Wakely  <jwakely@redhat.com>\n \n+\tPR libstdc++/88840\n+\t* include/bits/stl_vector.h (vector::__use_relocate): Replace static\n+\tdata member with static member function _S_use_relocate().\n+\t* include/bits/vector.tcc (vector::reserve, vector::_M_realloc_insert)\n+\t(vector::_M_default_append): Use _S_use_relocate() instead of\n+\t__use_relocate.\n+\n \t* testsuite/27_io/filesystem/path/compare/strings.cc: Only compare\n \tsign of results.\n "}, {"sha": "43debda54f1b40075d1616f53093e484f4d191da", "filename": "libstdc++-v3/include/bits/stl_vector.h", "status": "modified", "additions": 8, "deletions": 5, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e658669fe18d27bbde85085d648f0392f3f9bce6/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_vector.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e658669fe18d27bbde85085d648f0392f3f9bce6/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_vector.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_vector.h?ref=e658669fe18d27bbde85085d648f0392f3f9bce6", "patch": "@@ -424,11 +424,14 @@ _GLIBCXX_BEGIN_NAMESPACE_CONTAINER\n \n     private:\n #if __cplusplus >= 201103L\n-      static constexpr bool __use_relocate =\n-\tnoexcept(std::__relocate_a(std::declval<pointer>(),\n-\t\t\t\t   std::declval<pointer>(),\n-\t\t\t\t   std::declval<pointer>(),\n-\t\t\t\t   std::declval<_Tp_alloc_type&>()));\n+      static constexpr bool\n+      _S_use_relocate()\n+      {\n+\treturn noexcept(std::__relocate_a(std::declval<pointer>(),\n+\t\t\t\t\t  std::declval<pointer>(),\n+\t\t\t\t\t  std::declval<pointer>(),\n+\t\t\t\t\t  std::declval<_Tp_alloc_type&>()));\n+      }\n #endif\n \n     protected:"}, {"sha": "4cf0e809fe9cec4a0568658e0cdc27bd12539ff6", "filename": "libstdc++-v3/include/bits/vector.tcc", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e658669fe18d27bbde85085d648f0392f3f9bce6/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fvector.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e658669fe18d27bbde85085d648f0392f3f9bce6/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fvector.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fvector.tcc?ref=e658669fe18d27bbde85085d648f0392f3f9bce6", "patch": "@@ -73,7 +73,7 @@ _GLIBCXX_BEGIN_NAMESPACE_CONTAINER\n \t  const size_type __old_size = size();\n \t  pointer __tmp;\n #if __cplusplus >= 201103L\n-\t  if constexpr (__use_relocate)\n+\t  if constexpr (_S_use_relocate())\n \t    {\n \t      __tmp = this->_M_allocate(__n);\n \t      std::__relocate_a(this->_M_impl._M_start,\n@@ -457,7 +457,7 @@ _GLIBCXX_BEGIN_NAMESPACE_CONTAINER\n \t  __new_finish = pointer();\n \n #if __cplusplus >= 201103L\n-\t  if constexpr (__use_relocate)\n+\t  if constexpr (_S_use_relocate())\n \t    {\n \t      __new_finish\n \t\t= std::__relocate_a\n@@ -498,7 +498,7 @@ _GLIBCXX_BEGIN_NAMESPACE_CONTAINER\n \t  __throw_exception_again;\n \t}\n #if __cplusplus >= 201103L\n-      if constexpr (!__use_relocate)\n+      if constexpr (!_S_use_relocate())\n #endif\n \tstd::_Destroy(__old_start, __old_finish, _M_get_Tp_allocator());\n       _GLIBCXX_ASAN_ANNOTATE_REINIT;\n@@ -639,7 +639,7 @@ _GLIBCXX_BEGIN_NAMESPACE_CONTAINER\n \t\t_M_check_len(__n, \"vector::_M_default_append\");\n \t      pointer __new_start(this->_M_allocate(__len));\n #if __cplusplus >= 201103L\n-\t      if constexpr (__use_relocate)\n+\t      if constexpr (_S_use_relocate())\n \t\t{\n \t\t  __try\n \t\t    {"}]}