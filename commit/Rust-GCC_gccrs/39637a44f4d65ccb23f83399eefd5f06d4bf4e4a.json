{"sha": "39637a44f4d65ccb23f83399eefd5f06d4bf4e4a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Mzk2MzdhNDRmNGQ2NWNjYjIzZjgzMzk5ZWVmZDVmMDZkNGJmNGU0YQ==", "commit": {"author": {"name": "Bin Cheng", "email": "bin.cheng@arm.com", "date": "2017-08-01T09:17:29Z"}, "committer": {"name": "Bin Cheng", "email": "amker@gcc.gnu.org", "date": "2017-08-01T09:17:29Z"}, "message": "re PR tree-optimization/81620 (ICE in is_inv_store_elimination_chain, at tree-predcom.c:1651 with -O3)\n\n\tPR tree-optimization/81620\n\t* tree-predcom.c (add_ref_to_chain): Don't set has_max_use_after\n\tfor store-store chain.\n\n\tgcc/testsuite\n\t* gcc.dg/tree-ssa/pr81620-1.c: New.\n\t* gcc.dg/tree-ssa/pr81620-2.c: New.\n\nFrom-SVN: r250763", "tree": {"sha": "73e73febf0baa3141fc54e81b74d95b207ef2b7c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/73e73febf0baa3141fc54e81b74d95b207ef2b7c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/39637a44f4d65ccb23f83399eefd5f06d4bf4e4a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/39637a44f4d65ccb23f83399eefd5f06d4bf4e4a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/39637a44f4d65ccb23f83399eefd5f06d4bf4e4a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/39637a44f4d65ccb23f83399eefd5f06d4bf4e4a/comments", "author": null, "committer": null, "parents": [{"sha": "f9c5fe06f992ba29fccf7b3a15f5424b9ff254ce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f9c5fe06f992ba29fccf7b3a15f5424b9ff254ce", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f9c5fe06f992ba29fccf7b3a15f5424b9ff254ce"}], "stats": {"total": 61, "additions": 60, "deletions": 1}, "files": [{"sha": "c8ed19d41ad25c0cda607dd646fb5a5c8d3d4b50", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39637a44f4d65ccb23f83399eefd5f06d4bf4e4a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39637a44f4d65ccb23f83399eefd5f06d4bf4e4a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=39637a44f4d65ccb23f83399eefd5f06d4bf4e4a", "patch": "@@ -1,3 +1,9 @@\n+2017-08-01  Bin Cheng  <bin.cheng@arm.com>\n+\n+\tPR tree-optimization/81620\n+\t* tree-predcom.c (add_ref_to_chain): Don't set has_max_use_after\n+\tfor store-store chain.\n+\n 2017-08-01  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/81588"}, {"sha": "e2f695fa00112b3f9d8f6879f9c65871ad78b898", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39637a44f4d65ccb23f83399eefd5f06d4bf4e4a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39637a44f4d65ccb23f83399eefd5f06d4bf4e4a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=39637a44f4d65ccb23f83399eefd5f06d4bf4e4a", "patch": "@@ -1,3 +1,9 @@\n+2017-08-01  Bin Cheng  <bin.cheng@arm.com>\n+\n+\tPR tree-optimization/81620\n+\t* gcc.dg/tree-ssa/pr81620-1.c: New.\n+\t* gcc.dg/tree-ssa/pr81620-2.c: New.\n+\n 2017-08-01  Dominique d'Humieres  <dominiq@lps.ens.fr>\n \n \tPR testsuite/53542"}, {"sha": "f8f2dd8ad6c032de1cdc471dd31418cd32005544", "filename": "gcc/testsuite/gcc.dg/tree-ssa/pr81620-1.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39637a44f4d65ccb23f83399eefd5f06d4bf4e4a/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr81620-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39637a44f4d65ccb23f83399eefd5f06d4bf4e4a/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr81620-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr81620-1.c?ref=39637a44f4d65ccb23f83399eefd5f06d4bf4e4a", "patch": "@@ -0,0 +1,20 @@\n+/* { dg-do run } */\n+/* { dg-options \"-O3 -fno-tree-loop-vectorize -fdump-tree-pcom-details\" } */\n+\n+int a[7];\n+char b;\n+void abort (void);\n+\n+int main() {\n+  b = 4;\n+  for (; b; b--) {\n+    a[b] = b;\n+    a[b + 2] = 1;\n+  }\n+  if (a[0] != 0 || a[1] != 1 || a[2] != 2\n+      || a[3] != 1 || a[4] != 1 || a[5] != 1 || a[6] != 1)\n+    abort ();\n+  return 0;\n+}\n+\n+/* { dg-final { scan-tree-dump-times \"Store-stores chain\" 1 \"pcom\" } } */"}, {"sha": "85a8e3508402a89f39903fa2456ca6047fe575e4", "filename": "gcc/testsuite/gcc.dg/tree-ssa/pr81620-2.c", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39637a44f4d65ccb23f83399eefd5f06d4bf4e4a/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr81620-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39637a44f4d65ccb23f83399eefd5f06d4bf4e4a/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr81620-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr81620-2.c?ref=39637a44f4d65ccb23f83399eefd5f06d4bf4e4a", "patch": "@@ -0,0 +1,25 @@\n+/* { dg-do run } */\n+/* { dg-options \"-O3 -fno-tree-loop-vectorize -fdump-tree-pcom-details\" } */\n+\n+int a[200];\n+char b;\n+void abort (void);\n+\n+int main() {\n+  int i;\n+  b = 100;\n+  for (; b; b--) {\n+    a[b] = 2;\n+    a[b + 2] = 1;\n+  }\n+\n+  if (a[0] != 0 || a[1] != 2 || a[2] != 2)\n+    abort ();\n+  for (i = 3; i < 103; i++)\n+    if (a[i] != 1)\n+    abort ();\n+\n+  return 0;\n+}\n+\n+/* { dg-final { scan-tree-dump-times \"Store-stores chain\" 1 \"pcom\" } } */"}, {"sha": "f7a57a43a0e6985634c39a7ab020a2e131875ede", "filename": "gcc/tree-predcom.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39637a44f4d65ccb23f83399eefd5f06d4bf4e4a/gcc%2Ftree-predcom.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39637a44f4d65ccb23f83399eefd5f06d4bf4e4a/gcc%2Ftree-predcom.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-predcom.c?ref=39637a44f4d65ccb23f83399eefd5f06d4bf4e4a", "patch": "@@ -1069,7 +1069,9 @@ add_ref_to_chain (chain_p chain, dref ref)\n       chain->has_max_use_after = false;\n     }\n \n-  if (ref->distance == chain->length\n+  /* Don't set the flag for store-store chain since there is no use.  */\n+  if (chain->type != CT_STORE_STORE\n+      && ref->distance == chain->length\n       && ref->pos > root->pos)\n     chain->has_max_use_after = true;\n "}]}