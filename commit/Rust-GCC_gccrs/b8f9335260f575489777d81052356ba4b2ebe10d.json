{"sha": "b8f9335260f575489777d81052356ba4b2ebe10d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjhmOTMzNTI2MGY1NzU0ODk3NzdkODEwNTIzNTZiYTRiMmViZTEwZA==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2002-02-22T01:52:35Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2002-02-22T01:52:35Z"}, "message": "gcc_release: Correct handling of diff-generation.\n\n\t* gcc_release: Correct handling of diff-generation.  Add\n\t\"diffs\" major mode.\n\n[[Split portion of a mixed commit.]]\n\nFrom-SVN: r49951.2", "tree": {"sha": "cd7d973df1eb1bc7e79997f303e6d69f271351e6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cd7d973df1eb1bc7e79997f303e6d69f271351e6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b8f9335260f575489777d81052356ba4b2ebe10d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b8f9335260f575489777d81052356ba4b2ebe10d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b8f9335260f575489777d81052356ba4b2ebe10d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b8f9335260f575489777d81052356ba4b2ebe10d/comments", "author": null, "committer": null, "parents": [{"sha": "87b3cd7699306b8dfbf35d35516881a684958d7b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/87b3cd7699306b8dfbf35d35516881a684958d7b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/87b3cd7699306b8dfbf35d35516881a684958d7b"}], "stats": {"total": 45, "additions": 31, "deletions": 14}, "files": [{"sha": "de0ecd87abe73b3332410924bb211d0e28de5633", "filename": "maintainer-scripts/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b8f9335260f575489777d81052356ba4b2ebe10d/maintainer-scripts%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b8f9335260f575489777d81052356ba4b2ebe10d/maintainer-scripts%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/maintainer-scripts%2FChangeLog?ref=b8f9335260f575489777d81052356ba4b2ebe10d", "patch": "@@ -1,3 +1,8 @@\n+2002-02-21  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* gcc_release: Correct handling of diff-generation.  Add\n+\t\"diffs\" major mode.\n+\n 2002-02-08  Joseph S. Myers  <jsm28@cam.ac.uk>\n \n \t* gcc_release: Substitute dates in snapshot-README and"}, {"sha": "0bba03b2fad3f9b8e0f4e2e18f1cf6516df12afa", "filename": "maintainer-scripts/gcc_release", "status": "modified", "additions": 26, "deletions": 14, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b8f9335260f575489777d81052356ba4b2ebe10d/maintainer-scripts%2Fgcc_release", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b8f9335260f575489777d81052356ba4b2ebe10d/maintainer-scripts%2Fgcc_release", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/maintainer-scripts%2Fgcc_release?ref=b8f9335260f575489777d81052356ba4b2ebe10d", "patch": "@@ -9,7 +9,7 @@\n # Contents:\n #   Script to create a GCC release.\n #\n-# Copyright (c) 2001 Free Software Foundation.\n+# Copyright (c) 2001, 2002 Free Software Foundation.\n #\n # This file is part of GNU CC.\n #\n@@ -284,13 +284,6 @@ build_tarfiles() {\n   build_tarfile gcc-core-${RELEASE} ${EXCLUDES} \\\n     `basename ${SOURCE_DIRECTORY}`\n \n-  # Possibly build diffs.\n-  if [ -n \"$OLD_TARS\" ]; then\n-    for old_tar in $OLD_TARS; do\n-      build_diffs $old_tar\n-    done\n-  fi\n-\n   # Build .bz2 files.\n   for f in ${FILE_LIST}; do\n     bzfile=${f%.gz}.bz2\n@@ -301,7 +294,7 @@ build_tarfiles() {\n \n # Build diffs against an old release.\n build_diffs() {\n-  old_dir=${1%/*}\n+  old_dir=${1%/}\n   old_file=${1##*/}\n   old_vers=${old_file%.tar.gz}\n   old_vers=${old_vers#gcc-}\n@@ -346,7 +339,8 @@ upload_files() {\n       || error \"Could not create \\`${FTP_PATH}'\"\n   fi\n \n-  # Copy the tar files to the FTP server.\n+  # Make sure the directory exists on the server.\n+  ${SSH} -l ${GCC_USERNAME} ${GCC_HOSTNAME} mkdir ${FTP_PATH}\n   for x in gcc*.gz gcc*.bz2; do\n     if [ -e ${x} ]; then\n       # Make sure the file will be readable on the server.\n@@ -375,8 +369,12 @@ CVS_PROTOCOL=\"ext\"\n # The username to use when connecting to the server.\n CVS_USERNAME=\"${USER}\"\n \n-# The path to the directory where the files are uploaded for FTP.\n-FTP_PATH=\"gccadmin@gcc.gnu.org:~ftp/pub/gcc\"\n+# The machine to which files will be uploaded.\n+GCC_HOSTNAME=\"gcc.gnu.org\"\n+# The name of the account on the machine to which files are uploaded.\n+GCC_USERNAME=\"gccadmin\"\n+# The directory in which the files will be placed.\n+FTP_PATH=\"~ftp/pub/gcc\"\n \n # The major number for the release.  For release `3.0.2' this would be \n # `3'\n@@ -429,6 +427,7 @@ SNAPSHOT=0\n LOCAL=0\n \n # Major operation modes.\n+MODE_DIFFS=0\n MODE_SOURCES=0\n MODE_TARFILES=0\n MODE_UPLOAD=0\n@@ -444,6 +443,7 @@ DIFF=\"${DIFF:-diff -Nrc3pad}\"\n ENV=\"${ENV:-env}\"\n GZIP=\"${GZIP:-gzip --best}\"\n SCP=\"${SCP:-scp -p}\"\n+SSH=\"${SSH:-ssh}\"\n TAR=\"${TAR:-tar}\"\n \n ########################################################################\n@@ -506,9 +506,9 @@ if [ $SNAPSHOT -eq 0 ]; then\n   # If this is not a final release, set various parameters acordingly.\n   if [ ${FINAL} -ne 1 ]; then\n     RELEASE=\"${RELEASE}-${DATE}\"\n-    FTP_PATH=\"${FTP_PATH}/snapshots\"\n+    FTP_PATH=\"${FTP_PATH}/snapshots/\"\n   else\n-    FTP_PATH=\"${FTP_PATH}/releases/gcc-${RELEASE}\"\n+    FTP_PATH=\"${FTP_PATH}/releases/gcc-${RELEASE}/\"\n   fi\n else\n   RELEASE=$DATE\n@@ -557,6 +557,7 @@ export CVSROOT\n # Handle the major modes.\n while [ $# -ne 0 ]; do\n     case $1 in\n+    diffs)    MODE_DIFFS=1;;\n     sources)  MODE_SOURCES=1;;\n     tarfiles) MODE_TARFILES=1;;\n     upload)   MODE_UPLOAD=1;;\n@@ -578,6 +579,17 @@ if [ $MODE_TARFILES -ne 0 ]; then\n   build_tarfiles\n fi\n \n+# Build diffs\n+\n+if [ $MODE_DIFFS -ne 0 ]; then\n+  # Possibly build diffs.\n+  if [ -n \"$OLD_TARS\" ]; then\n+    for old_tar in $OLD_TARS; do\n+      build_diffs $old_tar\n+    done\n+  fi\n+fi\n+\n # Upload them to the FTP server.\n \n if [ $MODE_UPLOAD -ne 0 ]; then"}]}