{"sha": "b9b2405ff39ccd696dd1ff825bf81c367a63d3fa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjliMjQwNWZmMzljY2Q2OTZkZDFmZjgyNWJmODFjMzY3YTYzZDNmYQ==", "commit": {"author": {"name": "Samuel Tardieu", "email": "sam@rfc1149.net", "date": "2008-08-18T08:59:47Z"}, "committer": {"name": "Samuel Tardieu", "email": "sam@gcc.gnu.org", "date": "2008-08-18T08:59:47Z"}, "message": "gcc/ada/\n\t* exp_ch13.adb, exp_disp.adb, sem_cat.adb, sem_ch10.adb,\n\t* sem_ch12.adb, sem_ch6.adb, sem_ch7.adb, sem_ch8.adb,\n\t* sem_prag.adb, sem_util.adb, sem_warn.adb: Use\n\tIs_Package_Or_Generic_Package instead of hand-crafted tests.\n\nFrom-SVN: r139191", "tree": {"sha": "10893a8df07da42db5c377e6e409ee4e98a8ebf2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/10893a8df07da42db5c377e6e409ee4e98a8ebf2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/comments", "author": {"login": "samueltardieu", "id": 44656, "node_id": "MDQ6VXNlcjQ0NjU2", "avatar_url": "https://avatars.githubusercontent.com/u/44656?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samueltardieu", "html_url": "https://github.com/samueltardieu", "followers_url": "https://api.github.com/users/samueltardieu/followers", "following_url": "https://api.github.com/users/samueltardieu/following{/other_user}", "gists_url": "https://api.github.com/users/samueltardieu/gists{/gist_id}", "starred_url": "https://api.github.com/users/samueltardieu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samueltardieu/subscriptions", "organizations_url": "https://api.github.com/users/samueltardieu/orgs", "repos_url": "https://api.github.com/users/samueltardieu/repos", "events_url": "https://api.github.com/users/samueltardieu/events{/privacy}", "received_events_url": "https://api.github.com/users/samueltardieu/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "51c16e2998aa74045dffe63e3c561b08d2e7c477", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/51c16e2998aa74045dffe63e3c561b08d2e7c477", "html_url": "https://github.com/Rust-GCC/gccrs/commit/51c16e2998aa74045dffe63e3c561b08d2e7c477"}], "stats": {"total": 87, "additions": 31, "deletions": 56}, "files": [{"sha": "47bcb8e77589b64d424507cce7dedc2868f68319", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=b9b2405ff39ccd696dd1ff825bf81c367a63d3fa", "patch": "@@ -1,3 +1,10 @@\n+2008-08-18  Samuel Tardieu  <sam@rfc1149.net>\n+\n+\t* exp_ch13.adb, exp_disp.adb, sem_cat.adb, sem_ch10.adb,\n+\t* sem_ch12.adb, sem_ch6.adb, sem_ch7.adb, sem_ch8.adb,\n+\t* sem_prag.adb, sem_util.adb, sem_warn.adb: Use\n+\tIs_Package_Or_Generic_Package instead of hand-crafted tests.\n+\n 2008-08-18  Samuel Tardieu  <sam@rfc1149.net>\n \n \tPR ada/15808"}, {"sha": "af94e1d8f92d7692759598f36c608e6c03d9798e", "filename": "gcc/ada/exp_ch13.adb", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fexp_ch13.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fexp_ch13.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch13.adb?ref=b9b2405ff39ccd696dd1ff825bf81c367a63d3fa", "patch": "@@ -259,9 +259,8 @@ package body Exp_Ch13 is\n          Push_Scope (E_Scope);\n          Install_Visible_Declarations (E_Scope);\n \n-         if Ekind (E_Scope) = E_Package         or else\n-            Ekind (E_Scope) = E_Generic_Package or else\n-            Is_Protected_Type (E_Scope)         or else\n+         if Is_Package_Or_Generic_Package (E_Scope) or else\n+            Is_Protected_Type (E_Scope)             or else\n             Is_Task_Type (E_Scope)\n          then\n             Install_Private_Declarations (E_Scope);"}, {"sha": "84ea0b8f74c65e0da8b3c3f4e309dbc5d20eb118", "filename": "gcc/ada/exp_disp.adb", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fexp_disp.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fexp_disp.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_disp.adb?ref=b9b2405ff39ccd696dd1ff825bf81c367a63d3fa", "patch": "@@ -6016,9 +6016,7 @@ package body Exp_Disp is\n    begin\n       --  The scope must be a package\n \n-      if Ekind (Scop) /= E_Package\n-        and then Ekind (Scop) /= E_Generic_Package\n-      then\n+      if not Is_Package_Or_Generic_Package (Scop) then\n          return False;\n       end if;\n "}, {"sha": "273c04f81859e8ff4d2879e1c9553f61eaa5af1e", "filename": "gcc/ada/sem_cat.adb", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_cat.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_cat.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_cat.adb?ref=b9b2405ff39ccd696dd1ff825bf81c367a63d3fa", "patch": "@@ -433,8 +433,7 @@ package body Sem_Cat is\n       --  of an RCI unit.\n \n       return Is_Remote_Call_Interface (Unit_Entity)\n-        and then (Ekind (Unit_Entity) = E_Package\n-                  or else Ekind (Unit_Entity) = E_Generic_Package)\n+        and then Is_Package_Or_Generic_Package (Unit_Entity)\n         and then Unit_Kind /= N_Package_Body\n         and then List_Containing (N) =\n                   Visible_Declarations\n@@ -459,8 +458,7 @@ package body Sem_Cat is\n       --  There are no restrictions on the body of a Remote Types unit\n \n       return Is_Remote_Types (Unit_Entity)\n-        and then (Ekind (Unit_Entity) = E_Package\n-                   or else Ekind (Unit_Entity) = E_Generic_Package)\n+        and then Is_Package_Or_Generic_Package (Unit_Entity)\n         and then Unit_Kind /= N_Package_Body\n         and then not In_Package_Body (Unit_Entity)\n         and then not In_Instance;"}, {"sha": "6331c0443ea11afd99510c42b9d430bcc05f6661", "filename": "gcc/ada/sem_ch10.adb", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_ch10.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_ch10.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch10.adb?ref=b9b2405ff39ccd696dd1ff825bf81c367a63d3fa", "patch": "@@ -2007,9 +2007,7 @@ package body Sem_Ch10 is\n          --  all the parents are bodies. Restore full visibility of their\n          --  private entities.\n \n-         if Ekind (Scop) = E_Package\n-           or else Ekind (Scop) = E_Generic_Package\n-         then\n+         if Is_Package_Or_Generic_Package (Scop) then\n             Set_In_Package_Body (Scop);\n             Install_Private_Declarations (Scop);\n          end if;\n@@ -2099,9 +2097,7 @@ package body Sem_Ch10 is\n          --  context includes another subunit of the same parent which in\n          --  turn includes a child unit in its context.\n \n-         if Ekind (Par_Unit) = E_Package\n-           or else Ekind (Par_Unit) = E_Generic_Package\n-         then\n+         if Is_Package_Or_Generic_Package (Par_Unit) then\n             if not Is_Immediately_Visible (Par_Unit)\n               or else (Present (First_Entity (Par_Unit))\n                         and then not Is_Immediately_Visible"}, {"sha": "c956e7cbadab3340040001b69a225ec523751f9b", "filename": "gcc/ada/sem_ch12.adb", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_ch12.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_ch12.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch12.adb?ref=b9b2405ff39ccd696dd1ff825bf81c367a63d3fa", "patch": "@@ -5202,8 +5202,7 @@ package body Sem_Ch12 is\n \n          Inst_Par := Entity (Prefix (Gen_Id));\n          while Present (Inst_Par)\n-           and then Ekind (Inst_Par) /= E_Package\n-           and then Ekind (Inst_Par) /= E_Generic_Package\n+           and then not Is_Package_Or_Generic_Package (Inst_Par)\n          loop\n             Inst_Par := Homonym (Inst_Par);\n          end loop;"}, {"sha": "1100c30f5dd00835d98fb5d82cfb5c6ceac828e2", "filename": "gcc/ada/sem_ch6.adb", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_ch6.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_ch6.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch6.adb?ref=b9b2405ff39ccd696dd1ff825bf81c367a63d3fa", "patch": "@@ -6566,8 +6566,7 @@ package body Sem_Ch6 is\n          elsif Current_Scope = Standard_Standard then\n             null;\n \n-         elsif ((Ekind (Current_Scope) = E_Package\n-                  or else Ekind (Current_Scope) = E_Generic_Package)\n+         elsif (Is_Package_Or_Generic_Package (Current_Scope)\n                  and then not In_Package_Body (Current_Scope))\n            or else Is_Overriding\n          then"}, {"sha": "ef9a6540b0c86debc489caaf263e01e0772adb59", "filename": "gcc/ada/sem_ch7.adb", "status": "modified", "additions": 3, "deletions": 8, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_ch7.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_ch7.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch7.adb?ref=b9b2405ff39ccd696dd1ff825bf81c367a63d3fa", "patch": "@@ -847,10 +847,7 @@ package body Sem_Ch7 is\n                   Set_Is_Known_Non_Null (E, False);\n                end if;\n \n-            elsif Ekind (E) = E_Package\n-                    or else\n-                  Ekind (E) = E_Generic_Package\n-            then\n+            elsif Is_Package_Or_Generic_Package (E) then\n                Clear_Constants (E, First_Entity (E));\n                Clear_Constants (E, First_Private_Entity (E));\n             end if;\n@@ -1145,8 +1142,7 @@ package body Sem_Ch7 is\n          declare\n             Comp_Unit : constant Entity_Id := Cunit_Entity (Current_Sem_Unit);\n          begin\n-            if (Ekind (Comp_Unit) = E_Package\n-                 or else Ekind (Comp_Unit) = E_Generic_Package)\n+            if Is_Package_Or_Generic_Package (Comp_Unit)\n               and then not In_Private_Part (Comp_Unit)\n               and then not In_Instance\n             then\n@@ -1308,8 +1304,7 @@ package body Sem_Ch7 is\n       Set_Is_Pure         (Id, PF);\n       Init_Size_Align     (Id);\n \n-      if (Ekind (Current_Scope) /= E_Package\n-          and then Ekind (Current_Scope) /= E_Generic_Package)\n+      if not Is_Package_Or_Generic_Package (Current_Scope)\n         or else In_Private_Part (Current_Scope)\n       then\n          Error_Msg_N (\"invalid context for private declaration\", N);"}, {"sha": "d943cbc60feb24f3e1b748c309da349713504958", "filename": "gcc/ada/sem_ch8.adb", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_ch8.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_ch8.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch8.adb?ref=b9b2405ff39ccd696dd1ff825bf81c367a63d3fa", "patch": "@@ -2933,9 +2933,8 @@ package body Sem_Ch8 is\n          Error_Msg_N\n            (\"renamed generic unit must be a library unit\", Name (N));\n \n-      elsif Ekind (Old_E) = E_Package\n-        or else Ekind (Old_E) = E_Generic_Package\n-      then\n+      elsif Is_Package_Or_Generic_Package (Old_E) then\n+\n          --  Inherit categorization flags\n \n          New_E := Defining_Entity (N);\n@@ -6645,8 +6644,7 @@ package body Sem_Ch8 is\n             then\n                Full_Vis := True;\n \n-            elsif (Ekind (S) = E_Package\n-                    or else Ekind (S) = E_Generic_Package)\n+            elsif Is_Package_Or_Generic_Package (S)\n               and then (In_Private_Part (S)\n                          or else In_Package_Body (S))\n             then"}, {"sha": "44b5c88b9613e5be81d0d9b3db86221bb0512612", "filename": "gcc/ada/sem_prag.adb", "status": "modified", "additions": 4, "deletions": 12, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_prag.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_prag.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_prag.adb?ref=b9b2405ff39ccd696dd1ff825bf81c367a63d3fa", "patch": "@@ -1383,10 +1383,7 @@ package body Sem_Prag is\n             --  the end of the package declarations (for details, see\n             --  Analyze_Package_Specification.Analyze_PPCs).\n \n-            if Ekind (Scope (S)) /= E_Package\n-                 and then\n-               Ekind (Scope (S)) /= E_Generic_Package\n-            then\n+            if not Is_Package_Or_Generic_Package (Scope (S)) then\n                Analyze_PPC_In_Decl_Part (N, S);\n             end if;\n \n@@ -3539,8 +3536,7 @@ package body Sem_Prag is\n \n          elsif (C = Convention_Java or else C = Convention_CIL)\n            and then\n-             (Ekind (Def_Id) = E_Package\n-                or else Ekind (Def_Id) = E_Generic_Package\n+             (Is_Package_Or_Generic_Package (Def_Id)\n                 or else Ekind (Def_Id) = E_Exception\n                 or else Nkind (Parent (Def_Id)) = N_Component_Declaration)\n          then\n@@ -4307,9 +4303,7 @@ package body Sem_Prag is\n          E    : Entity_Id;\n \n          In_Package_Spec : constant Boolean :=\n-                             (Ekind (Current_Scope) = E_Package\n-                                or else\n-                              Ekind (Current_Scope) = E_Generic_Package)\n+                             Is_Package_Or_Generic_Package (Current_Scope)\n                                and then not In_Package_Body (Current_Scope);\n \n          procedure Suppress_Unsuppress_Echeck (E : Entity_Id; C : Check_Id);\n@@ -9215,9 +9209,7 @@ package body Sem_Prag is\n                   declare\n                      Ent : constant Entity_Id := Find_Lib_Unit_Name;\n                   begin\n-                     if Ekind (Ent) = E_Package\n-                       or else Ekind (Ent) = E_Generic_Package\n-                     then\n+                     if Is_Package_Or_Generic_Package (Ent) then\n                         Set_Obsolescent (Ent);\n                         return;\n                      end if;"}, {"sha": "5783d3c92e7738816e7a4db89bbb957d2c332971", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=b9b2405ff39ccd696dd1ff825bf81c367a63d3fa", "patch": "@@ -7031,11 +7031,8 @@ package body Sem_Util is\n          --  If scope is a package, also clear current values of all\n          --  private entities in the scope.\n \n-         if Ekind (S) = E_Package\n-              or else\n-            Ekind (S) = E_Generic_Package\n-              or else\n-            Is_Concurrent_Type (S)\n+         if Is_Package_Or_Generic_Package (S)\n+           or else Is_Concurrent_Type (S)\n          then\n             Kill_Current_Values_For_Entity_Chain (First_Private_Entity (S));\n          end if;"}, {"sha": "feb19ce56315df89ec23258f30ec4b83292a16ce", "filename": "gcc/ada/sem_warn.adb", "status": "modified", "additions": 3, "deletions": 6, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_warn.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9b2405ff39ccd696dd1ff825bf81c367a63d3fa/gcc%2Fada%2Fsem_warn.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_warn.adb?ref=b9b2405ff39ccd696dd1ff825bf81c367a63d3fa", "patch": "@@ -1294,11 +1294,8 @@ package body Sem_Warn is\n                            or else\n                              (Ekind (E1) = E_Package\n                                 and then\n-                                  Ekind (Cunit_Entity (Current_Sem_Unit)) /=\n-                                                          E_Package\n-                                and then\n-                                  Ekind (Cunit_Entity (Current_Sem_Unit)) /=\n-                                                          E_Generic_Package))\n+                                  not Is_Package_Or_Generic_Package\n+                                    (Cunit_Entity (Current_Sem_Unit))))\n \n                --  Exclude instantiations, since there is no reason why every\n                --  entity in an instantiation should be referenced.\n@@ -1432,7 +1429,7 @@ package body Sem_Warn is\n          --  formal package, because the corresponding body is not analyzed.\n \n          <<Continue>>\n-            if ((Ekind (E1) = E_Package or else Ekind (E1) = E_Generic_Package)\n+            if (Is_Package_Or_Generic_Package (E1)\n                   and then Nkind (Parent (E1)) = N_Package_Specification\n                   and then\n                     Nkind (Original_Node (Unit_Declaration_Node (E1)))"}]}