{"sha": "def3263a3364034c8cd6cd865975529f9fd80e69", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGVmMzI2M2EzMzY0MDM0YzhjZDZjZDg2NTk3NTUyOWY5ZmQ4MGU2OQ==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2000-11-03T16:03:37Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2000-11-03T16:03:37Z"}, "message": "cppfiles.c (open_file): If already read, then don't reopen.\n\n\t* cppfiles.c (open_file): If already read, then don't reopen.\n\tImmediately close an empty file.\n\nFrom-SVN: r37227", "tree": {"sha": "b3e2c442f061fc7379989b80f9d5ee2b7118618f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b3e2c442f061fc7379989b80f9d5ee2b7118618f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/def3263a3364034c8cd6cd865975529f9fd80e69", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/def3263a3364034c8cd6cd865975529f9fd80e69", "html_url": "https://github.com/Rust-GCC/gccrs/commit/def3263a3364034c8cd6cd865975529f9fd80e69", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/def3263a3364034c8cd6cd865975529f9fd80e69/comments", "author": null, "committer": null, "parents": [{"sha": "30235724a2cd237a613883e9c4149f979acb91ea", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/30235724a2cd237a613883e9c4149f979acb91ea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/30235724a2cd237a613883e9c4149f979acb91ea"}], "stats": {"total": 21, "additions": 17, "deletions": 4}, "files": [{"sha": "0ad0e517bce075328af8cc5546c9e86eb90e8b96", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/def3263a3364034c8cd6cd865975529f9fd80e69/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/def3263a3364034c8cd6cd865975529f9fd80e69/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=def3263a3364034c8cd6cd865975529f9fd80e69", "patch": "@@ -1,3 +1,8 @@\n+2000-11-03  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* cppfiles.c (open_file): If already read, then don't reopen.\n+\tImmediately close an empty file.\n+\n 2000-11-01  Bernd Schmidt  <bernds@redhat.co.uk>\n \n \t* expr.h (fold_builtin): Move declaration..."}, {"sha": "47bf43f211fbc0499e4d6dcc4d053e4c293fc07b", "filename": "gcc/cppfiles.c", "status": "modified", "additions": 12, "deletions": 4, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/def3263a3364034c8cd6cd865975529f9fd80e69/gcc%2Fcppfiles.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/def3263a3364034c8cd6cd865975529f9fd80e69/gcc%2Fcppfiles.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcppfiles.c?ref=def3263a3364034c8cd6cd865975529f9fd80e69", "patch": "@@ -145,9 +145,13 @@ open_file (pfile, filename)\n       if (file->fd == -2)\n \treturn 0;\n \n-      /* -1 indicates a file we've opened previously, and since closed.  */\n-      if (file->fd != -1)\n-\treturn file;\n+      /* Don't reopen an idempotent file. */\n+      if (DO_NOT_REREAD (file))\n+        return file;\n+      \n+      /* Don't reopen one which is already loaded. */\n+      if (file->buffer != NULL)\n+        return file;\n     }\n   else\n     {\n@@ -181,7 +185,11 @@ open_file (pfile, filename)\n     {\n       /* Mark a regular, zero-length file never-reread now.  */\n       if (S_ISREG (file->st.st_mode) && file->st.st_size == 0)\n-\tfile->cmacro = NEVER_REREAD;\n+        {\n+\t  file->cmacro = NEVER_REREAD;\n+\t  close (file->fd);\n+\t  file->fd = -1;\n+\t}\n \n       return file;\n     }"}]}