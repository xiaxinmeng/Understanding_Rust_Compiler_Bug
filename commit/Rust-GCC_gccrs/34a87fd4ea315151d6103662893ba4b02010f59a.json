{"sha": "34a87fd4ea315151d6103662893ba4b02010f59a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzRhODdmZDRlYTMxNTE1MWQ2MTAzNjYyODkzYmE0YjAyMDEwZjU5YQ==", "commit": {"author": {"name": "Andrew Pinski", "email": "andrew_pinski@playstation.sony.com", "date": "2008-07-20T17:51:48Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2008-07-20T17:51:48Z"}, "message": "re PR tree-optimization/36879 (undefined reference to a variable)\n\n2008-07-20  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n\n        PR tree-opt/36879\n        * tree-switch-conversion.c (build_one_array): Call\n        varpool_mark_needed_node and varpool_finalize_decl\n        instead of assemble_variable.\n\n2008-07-20  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n\n        PR tree-opt/36879\n        * gcc.c-torture/execute/20080719-1.c: New testcase.\n\nFrom-SVN: r138012", "tree": {"sha": "f685d1d08678d259263f443dd13cbdac7b7e2514", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f685d1d08678d259263f443dd13cbdac7b7e2514"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/34a87fd4ea315151d6103662893ba4b02010f59a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34a87fd4ea315151d6103662893ba4b02010f59a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/34a87fd4ea315151d6103662893ba4b02010f59a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34a87fd4ea315151d6103662893ba4b02010f59a/comments", "author": null, "committer": null, "parents": [{"sha": "c72321c9a7c869ae5cb7f5bbec1ea4e8c8d3c50a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c72321c9a7c869ae5cb7f5bbec1ea4e8c8d3c50a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c72321c9a7c869ae5cb7f5bbec1ea4e8c8d3c50a"}], "stats": {"total": 80, "additions": 79, "deletions": 1}, "files": [{"sha": "494e252fa78d95082778f382c3c370b1ac0c4071", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34a87fd4ea315151d6103662893ba4b02010f59a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34a87fd4ea315151d6103662893ba4b02010f59a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=34a87fd4ea315151d6103662893ba4b02010f59a", "patch": "@@ -1,3 +1,10 @@\n+2008-07-20  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n+\n+\tPR tree-opt/36879\n+\t* tree-switch-conversion.c (build_one_array): Call\n+\tvarpool_mark_needed_node and varpool_finalize_decl \n+\tinstead of assemble_variable.\n+\n 2008-07-19  Jan Hubicka  <jh@suse.cz>\n \n \t* cgraph.c (cgraph_add_new_function): Do early local passes."}, {"sha": "8eea44725d937aeb370a01e0875d65c7d1cd63f6", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34a87fd4ea315151d6103662893ba4b02010f59a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34a87fd4ea315151d6103662893ba4b02010f59a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=34a87fd4ea315151d6103662893ba4b02010f59a", "patch": "@@ -1,3 +1,8 @@\n+2008-07-20  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n+\n+\tPR tree-opt/36879\n+\t* gcc.c-torture/execute/20080719-1.c: New testcase.\n+\n 2008-07-20  Hans-Peter Nilsson  <hp@axis.com>\n \n \t* gcc.dg/tree-ssa/data-dep-1.c: XFAIL."}, {"sha": "694abcbf9851bbc563578a30c4ea4972ba5a58c8", "filename": "gcc/testsuite/gcc.c-torture/execute/20080719-1.c", "status": "added", "additions": 65, "deletions": 0, "changes": 65, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34a87fd4ea315151d6103662893ba4b02010f59a/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F20080719-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34a87fd4ea315151d6103662893ba4b02010f59a/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F20080719-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F20080719-1.c?ref=34a87fd4ea315151d6103662893ba4b02010f59a", "patch": "@@ -0,0 +1,65 @@\n+typedef unsigned int u32;\n+\n+static const u32 deadfish = 0xdeadf155;\n+\n+static const u32 cfb_tab8_be[] = {\n+    0x00000000,0x000000ff,0x0000ff00,0x0000ffff,\n+    0x00ff0000,0x00ff00ff,0x00ffff00,0x00ffffff,\n+    0xff000000,0xff0000ff,0xff00ff00,0xff00ffff,\n+    0xffff0000,0xffff00ff,0xffffff00,0xffffffff\n+};\n+\n+static const u32 cfb_tab8_le[] = {\n+    0x00000000,0xff000000,0x00ff0000,0xffff0000,\n+    0x0000ff00,0xff00ff00,0x00ffff00,0xffffff00,\n+    0x000000ff,0xff0000ff,0x00ff00ff,0xffff00ff,\n+    0x0000ffff,0xff00ffff,0x00ffffff,0xffffffff\n+};\n+\n+static const u32 cfb_tab16_be[] = {\n+    0x00000000, 0x0000ffff, 0xffff0000, 0xffffffff\n+};\n+\n+static const u32 cfb_tab16_le[] = {\n+    0x00000000, 0xffff0000, 0x0000ffff, 0xffffffff\n+};\n+\n+static const u32 cfb_tab32[] = {\n+ 0x00000000, 0xffffffff\n+};\n+\n+\n+\n+\n+\n+\n+const u32 *xxx(int bpp)\n+{\n+ const u32 *tab;\n+\n+if (0) return &deadfish;\n+\n+ switch (bpp) {\n+ case 8:\n+  tab = cfb_tab8_be;\n+  break;\n+ case 16:\n+  tab = cfb_tab16_be;\n+  break;\n+ case 32:\n+ default:\n+  tab = cfb_tab32;\n+  break;\n+ }\n+\n+ return tab;\n+}\n+\n+int main(void)\n+{\n+  const u32 *a = xxx(8);\n+  int b = a[0];\n+  if (b != cfb_tab8_be[0])\n+    __builtin_abort ();\n+  return 0;\n+}"}, {"sha": "2205c1a8b7172567fac047d2049e3133e228df8c", "filename": "gcc/tree-switch-conversion.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34a87fd4ea315151d6103662893ba4b02010f59a/gcc%2Ftree-switch-conversion.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34a87fd4ea315151d6103662893ba4b02010f59a/gcc%2Ftree-switch-conversion.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-switch-conversion.c?ref=34a87fd4ea315151d6103662893ba4b02010f59a", "patch": "@@ -474,7 +474,8 @@ build_one_array (tree swtch, int num, tree arr_index_type, tree phi, tree tidx)\n   DECL_ARTIFICIAL (decl) = 1;\n   TREE_CONSTANT (decl) = 1;\n   add_referenced_var (decl);\n-  assemble_variable (decl, 0, 0, 0);\n+  varpool_mark_needed_node (varpool_node (decl));\n+  varpool_finalize_decl (decl);\n   mark_sym_for_renaming (decl);\n \n   name = make_ssa_name (SSA_NAME_VAR (PHI_RESULT (phi)), NULL_TREE);"}]}