{"sha": "5b1ef8b9db964ec2375df29a73d2b1651afe7ea9", "node_id": "C_kwDOANBUbNoAKDViMWVmOGI5ZGI5NjRlYzIzNzVkZjI5YTczZDJiMTY1MWFmZTdlYTk", "commit": {"author": {"name": "Peter Bergner", "email": "bergner@linux.ibm.com", "date": "2021-12-01T19:17:52Z"}, "committer": {"name": "Peter Bergner", "email": "bergner@linux.ibm.com", "date": "2021-12-01T19:22:36Z"}, "message": "middle-end: Skip initialization of opaque type variables [PR103127]\n\nFor -ftrivial-auto-var-init=*, skip initializing the variable if it is an\nopaque type, because CONST0_RTX(mode) is not defined for opaque modes.\n\n2021-12-01  Peter Bergner  <bergner@linux.ibm.com>\n\ngcc/\n\tPR middle-end/103127\n\t* gimplify.c (is_var_need_auto_init): Handle opaque types.\n\ngcc/testsuite/\n\tPR middle-end/103127\n\t* gcc.target/powerpc/pr103127.c: New test.", "tree": {"sha": "e6bb5f142821dbd5bfb2edebcb3643358b99446f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e6bb5f142821dbd5bfb2edebcb3643358b99446f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5b1ef8b9db964ec2375df29a73d2b1651afe7ea9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5b1ef8b9db964ec2375df29a73d2b1651afe7ea9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5b1ef8b9db964ec2375df29a73d2b1651afe7ea9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5b1ef8b9db964ec2375df29a73d2b1651afe7ea9/comments", "author": {"login": "peter-bergner", "id": 17504345, "node_id": "MDQ6VXNlcjE3NTA0MzQ1", "avatar_url": "https://avatars.githubusercontent.com/u/17504345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/peter-bergner", "html_url": "https://github.com/peter-bergner", "followers_url": "https://api.github.com/users/peter-bergner/followers", "following_url": "https://api.github.com/users/peter-bergner/following{/other_user}", "gists_url": "https://api.github.com/users/peter-bergner/gists{/gist_id}", "starred_url": "https://api.github.com/users/peter-bergner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/peter-bergner/subscriptions", "organizations_url": "https://api.github.com/users/peter-bergner/orgs", "repos_url": "https://api.github.com/users/peter-bergner/repos", "events_url": "https://api.github.com/users/peter-bergner/events{/privacy}", "received_events_url": "https://api.github.com/users/peter-bergner/received_events", "type": "User", "site_admin": false}, "committer": {"login": "peter-bergner", "id": 17504345, "node_id": "MDQ6VXNlcjE3NTA0MzQ1", "avatar_url": "https://avatars.githubusercontent.com/u/17504345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/peter-bergner", "html_url": "https://github.com/peter-bergner", "followers_url": "https://api.github.com/users/peter-bergner/followers", "following_url": "https://api.github.com/users/peter-bergner/following{/other_user}", "gists_url": "https://api.github.com/users/peter-bergner/gists{/gist_id}", "starred_url": "https://api.github.com/users/peter-bergner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/peter-bergner/subscriptions", "organizations_url": "https://api.github.com/users/peter-bergner/orgs", "repos_url": "https://api.github.com/users/peter-bergner/repos", "events_url": "https://api.github.com/users/peter-bergner/events{/privacy}", "received_events_url": "https://api.github.com/users/peter-bergner/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "185b307b03db20bfc7105a519ef19e2cafea7196", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/185b307b03db20bfc7105a519ef19e2cafea7196", "html_url": "https://github.com/Rust-GCC/gccrs/commit/185b307b03db20bfc7105a519ef19e2cafea7196"}], "stats": {"total": 20, "additions": 20, "deletions": 0}, "files": [{"sha": "326476f02388016d835c284c15c19bebdec83b92", "filename": "gcc/gimplify.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5b1ef8b9db964ec2375df29a73d2b1651afe7ea9/gcc%2Fgimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5b1ef8b9db964ec2375df29a73d2b1651afe7ea9/gcc%2Fgimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimplify.c?ref=5b1ef8b9db964ec2375df29a73d2b1651afe7ea9", "patch": "@@ -1829,6 +1829,7 @@ is_var_need_auto_init (tree decl)\n \t  || !DECL_HARD_REGISTER (decl))\n       && (flag_auto_var_init > AUTO_INIT_UNINITIALIZED)\n       && (!lookup_attribute (\"uninitialized\", DECL_ATTRIBUTES (decl)))\n+      && !OPAQUE_TYPE_P (TREE_TYPE (decl))\n       && !is_empty_type (TREE_TYPE (decl)))\n     return true;\n   return false;"}, {"sha": "801fc0a46207e2d94d30d304054c2eb395666dd7", "filename": "gcc/testsuite/gcc.target/powerpc/pr103127.c", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5b1ef8b9db964ec2375df29a73d2b1651afe7ea9/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr103127.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5b1ef8b9db964ec2375df29a73d2b1651afe7ea9/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr103127.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr103127.c?ref=5b1ef8b9db964ec2375df29a73d2b1651afe7ea9", "patch": "@@ -0,0 +1,19 @@\n+/* PR target/103127 */\n+/* { dg-require-effective-target power10_ok } */\n+/* { dg-options \"-O2 -mdejagnu-cpu=power10 -ftrivial-auto-var-init=zero\" } */\n+\n+/* Verify we do not ICE on the following tests.  */\n+\n+void\n+foo (__vector_quad *dst)\n+{\n+  __vector_quad acc;\n+  *dst = acc;\n+}\n+\n+void\n+bar (__vector_pair *dst)\n+{\n+  __vector_pair pair;\n+  *dst = pair;\n+}"}]}