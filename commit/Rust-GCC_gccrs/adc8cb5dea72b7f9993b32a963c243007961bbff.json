{"sha": "adc8cb5dea72b7f9993b32a963c243007961bbff", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWRjOGNiNWRlYTcyYjdmOTk5M2IzMmE5NjNjMjQzMDA3OTYxYmJmZg==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2002-01-28T16:52:27Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2002-01-28T16:52:27Z"}, "message": "expr.c (build_jni_stub): Ensure storage for `meth' is generated.\n\n\t* expr.c (build_jni_stub): Ensure storage for `meth' is\n\tgenerated.\n\t* parse.y (java_complete_expand_methods): Set\n\tcurrent_function_decl before building JNI stub.\n\nFrom-SVN: r49286", "tree": {"sha": "8ed3e8b997f63faf1389995024ab7a0566889b73", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8ed3e8b997f63faf1389995024ab7a0566889b73"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/adc8cb5dea72b7f9993b32a963c243007961bbff", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/adc8cb5dea72b7f9993b32a963c243007961bbff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/adc8cb5dea72b7f9993b32a963c243007961bbff", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/adc8cb5dea72b7f9993b32a963c243007961bbff/comments", "author": null, "committer": null, "parents": [{"sha": "5a721dab82a65ae66c4b4a7ef05c8f287299a212", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5a721dab82a65ae66c4b4a7ef05c8f287299a212", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5a721dab82a65ae66c4b4a7ef05c8f287299a212"}], "stats": {"total": 20, "additions": 17, "deletions": 3}, "files": [{"sha": "8e434f25afd9d3e89caa77121d7f4d20e3a03e05", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/adc8cb5dea72b7f9993b32a963c243007961bbff/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/adc8cb5dea72b7f9993b32a963c243007961bbff/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=adc8cb5dea72b7f9993b32a963c243007961bbff", "patch": "@@ -1,3 +1,10 @@\n+2002-01-28  Tom Tromey  <tromey@redhat.com>\n+\n+\t* expr.c (build_jni_stub): Ensure storage for `meth' is\n+\tgenerated.\n+\t* parse.y (java_complete_expand_methods): Set\n+\tcurrent_function_decl before building JNI stub.\n+\n 2002-01-26 Andreas Tobler <a.tobler@schweiz.ch>\n \t\n \t* gcc/java/builtins.c (sqrt_builtin): Use BUILT_IN_SQRT, not"}, {"sha": "a7cb59efcc590f9a942d4d4183342712afcfee98", "filename": "gcc/java/expr.c", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/adc8cb5dea72b7f9993b32a963c243007961bbff/gcc%2Fjava%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/adc8cb5dea72b7f9993b32a963c243007961bbff/gcc%2Fjava%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fexpr.c?ref=adc8cb5dea72b7f9993b32a963c243007961bbff", "patch": "@@ -2168,8 +2168,13 @@ build_jni_stub (method)\n   TREE_PUBLIC (meth_var) = 0;\n   DECL_EXTERNAL (meth_var) = 0;\n   DECL_CONTEXT (meth_var) = method;\n+  DECL_ARTIFICIAL (meth_var) = 1;\n+  DECL_INITIAL (meth_var) = null_pointer_node;\n+  TREE_USED (meth_var) = 1;\n+  chainon (env_var, meth_var);\n+  layout_decl (meth_var, 0);\n   make_decl_rtl (meth_var, NULL);\n-  meth_var = pushdecl_top_level (meth_var);\n+  rest_of_decl_compilation (meth_var, NULL, 0, 0);\n \n   /* One strange way that the front ends are different is that they\n      store arguments differently.  */"}, {"sha": "8b33fadf85c0399e22985e341b3e0adf8502bbfd", "filename": "gcc/java/parse.y", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/adc8cb5dea72b7f9993b32a963c243007961bbff/gcc%2Fjava%2Fparse.y", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/adc8cb5dea72b7f9993b32a963c243007961bbff/gcc%2Fjava%2Fparse.y", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fparse.y?ref=adc8cb5dea72b7f9993b32a963c243007961bbff", "patch": "@@ -1,6 +1,6 @@\n /* Source code parsing and tree node generation for the GNU compiler\n    for the Java(TM) language.\n-   Copyright (C) 1997, 1998, 1999, 2000, 2001 Free Software Foundation, Inc.\n+   Copyright (C) 1997, 1998, 1999, 2000, 2001, 2002 Free Software Foundation, Inc.\n    Contributed by Alexandre Petit-Bianco (apbianco@cygnus.com)\n \n This file is part of GNU CC.\n@@ -7723,7 +7723,9 @@ java_complete_expand_methods (class_decl)\n \n       if (METHOD_NATIVE (decl))\n  \t{\n- \t  tree body = build_jni_stub (decl);\n+ \t  tree body;\n+\t  current_function_decl = decl;\n+\t  body = build_jni_stub (decl);\n  \t  BLOCK_EXPR_BODY (DECL_FUNCTION_BODY (decl)) = body;\n  \t}\n "}]}