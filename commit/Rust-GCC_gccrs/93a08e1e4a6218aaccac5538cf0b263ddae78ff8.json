{"sha": "93a08e1e4a6218aaccac5538cf0b263ddae78ff8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTNhMDhlMWU0YTYyMThhYWNjYWM1NTM4Y2YwYjI2M2RkYWU3OGZmOA==", "commit": {"author": {"name": "Javier Miranda", "email": "miranda@adacore.com", "date": "2019-08-21T08:29:33Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-08-21T08:29:33Z"}, "message": "[Ada] Missing attribute update in new_copy_tree\n\nThe compiler crashes processing an internally generated cloned tree that\nhas a subprogram call with a named actual parameter.\n\n2019-08-21  Javier Miranda  <miranda@adacore.com>\n\ngcc/ada/\n\n\t* sem_util.adb (Update_Named_Associations): Update\n\tFirst_Named_Actual when the subprogram call has a single named\n\tactual.\n\ngcc/testsuite/\n\n\t* gnat.dg/implicit_param.adb, gnat.dg/implicit_param_pkg.ads:\n\tNew testcase.\n\nFrom-SVN: r274776", "tree": {"sha": "e59f947b0949df9d161425854501dd2d0cbe2e50", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e59f947b0949df9d161425854501dd2d0cbe2e50"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/93a08e1e4a6218aaccac5538cf0b263ddae78ff8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/93a08e1e4a6218aaccac5538cf0b263ddae78ff8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/93a08e1e4a6218aaccac5538cf0b263ddae78ff8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/93a08e1e4a6218aaccac5538cf0b263ddae78ff8/comments", "author": {"login": "miranda-adacore", "id": 54413934, "node_id": "MDQ6VXNlcjU0NDEzOTM0", "avatar_url": "https://avatars.githubusercontent.com/u/54413934?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miranda-adacore", "html_url": "https://github.com/miranda-adacore", "followers_url": "https://api.github.com/users/miranda-adacore/followers", "following_url": "https://api.github.com/users/miranda-adacore/following{/other_user}", "gists_url": "https://api.github.com/users/miranda-adacore/gists{/gist_id}", "starred_url": "https://api.github.com/users/miranda-adacore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miranda-adacore/subscriptions", "organizations_url": "https://api.github.com/users/miranda-adacore/orgs", "repos_url": "https://api.github.com/users/miranda-adacore/repos", "events_url": "https://api.github.com/users/miranda-adacore/events{/privacy}", "received_events_url": "https://api.github.com/users/miranda-adacore/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "cfc03d536f3b4b20e0084a65e90d5a9491721100", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cfc03d536f3b4b20e0084a65e90d5a9491721100", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cfc03d536f3b4b20e0084a65e90d5a9491721100"}], "stats": {"total": 57, "additions": 50, "deletions": 7}, "files": [{"sha": "08989eb8f4e917904da16c0004ac04d02265f4df", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93a08e1e4a6218aaccac5538cf0b263ddae78ff8/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93a08e1e4a6218aaccac5538cf0b263ddae78ff8/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=93a08e1e4a6218aaccac5538cf0b263ddae78ff8", "patch": "@@ -1,3 +1,9 @@\n+2019-08-21  Javier Miranda  <miranda@adacore.com>\n+\n+\t* sem_util.adb (Update_Named_Associations): Update\n+\tFirst_Named_Actual when the subprogram call has a single named\n+\tactual.\n+\n 2019-08-21  Joel Brobecker  <brobecker@adacore.com>\n \n \t* doc/Makefile (mk_empty_dirs): New (PHONY) rule."}, {"sha": "58b7b0864ee9cb1109db578aecf9fa93cafb2d5d", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 12, "deletions": 7, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93a08e1e4a6218aaccac5538cf0b263ddae78ff8/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93a08e1e4a6218aaccac5538cf0b263ddae78ff8/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=93a08e1e4a6218aaccac5538cf0b263ddae78ff8", "patch": "@@ -20623,22 +20623,27 @@ package body Sem_Util is\n          Old_Next : Node_Id;\n \n       begin\n+         if No (First_Named_Actual (Old_Call)) then\n+            return;\n+         end if;\n+\n          --  Recreate the First/Next_Named_Actual chain of a call by traversing\n          --  the chains of both the old and new calls in parallel.\n \n          New_Act := First (Parameter_Associations (New_Call));\n          Old_Act := First (Parameter_Associations (Old_Call));\n          while Present (Old_Act) loop\n             if Nkind (Old_Act) = N_Parameter_Association\n-              and then Present (Next_Named_Actual (Old_Act))\n+              and then Explicit_Actual_Parameter (Old_Act)\n+                         = First_Named_Actual (Old_Call)\n             then\n-               if First_Named_Actual (Old_Call) =\n-                    Explicit_Actual_Parameter (Old_Act)\n-               then\n-                  Set_First_Named_Actual (New_Call,\n-                    Explicit_Actual_Parameter (New_Act));\n-               end if;\n+               Set_First_Named_Actual (New_Call,\n+                 Explicit_Actual_Parameter (New_Act));\n+            end if;\n \n+            if Nkind (Old_Act) = N_Parameter_Association\n+              and then Present (Next_Named_Actual (Old_Act))\n+            then\n                --  Scan the actual parameter list to find the next suitable\n                --  named actual. Note that the list may be out of order.\n "}, {"sha": "50929c173aba67cf51ce2ecdc4fbba4a3dc2b8c1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93a08e1e4a6218aaccac5538cf0b263ddae78ff8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93a08e1e4a6218aaccac5538cf0b263ddae78ff8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=93a08e1e4a6218aaccac5538cf0b263ddae78ff8", "patch": "@@ -1,3 +1,8 @@\n+2019-08-21  Javier Miranda  <miranda@adacore.com>\n+\n+\t* gnat.dg/implicit_param.adb, gnat.dg/implicit_param_pkg.ads:\n+\tNew testcase.\n+\n 2019-08-20  Martin Sebor  <msebor@redhat.com>\n \n \tPR testsuite/91458"}, {"sha": "89de0c3104c562e6e8f31e8ac42e8c53d9482d13", "filename": "gcc/testsuite/gnat.dg/implicit_param.adb", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93a08e1e4a6218aaccac5538cf0b263ddae78ff8/gcc%2Ftestsuite%2Fgnat.dg%2Fimplicit_param.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93a08e1e4a6218aaccac5538cf0b263ddae78ff8/gcc%2Ftestsuite%2Fgnat.dg%2Fimplicit_param.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fimplicit_param.adb?ref=93a08e1e4a6218aaccac5538cf0b263ddae78ff8", "patch": "@@ -0,0 +1,19 @@\n+--  { dg-do compile }\n+\n+with Implicit_Param_Pkg;\n+\n+procedure Implicit_Param is\n+    subtype Tiny is Integer range 1 .. 5;\n+    V : Tiny := 4;\n+\n+    function Func62 return Implicit_Param_Pkg.Lim_Rec is\n+    begin\n+       return\n+         (case V is\n+           when 1 .. 3 => Implicit_Param_Pkg.Func_Lim_Rec,\n+           when 4 .. 5 => raise Program_Error);\n+    end Func62;\n+\n+begin\n+    null;\n+end Implicit_Param;"}, {"sha": "ce6c7e6d555399e011bf9ffe9f4c9bb92e65f583", "filename": "gcc/testsuite/gnat.dg/implicit_param_pkg.ads", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93a08e1e4a6218aaccac5538cf0b263ddae78ff8/gcc%2Ftestsuite%2Fgnat.dg%2Fimplicit_param_pkg.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93a08e1e4a6218aaccac5538cf0b263ddae78ff8/gcc%2Ftestsuite%2Fgnat.dg%2Fimplicit_param_pkg.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fimplicit_param_pkg.ads?ref=93a08e1e4a6218aaccac5538cf0b263ddae78ff8", "patch": "@@ -0,0 +1,8 @@\n+package Implicit_Param_Pkg is\n+    type Lim_Rec is limited record\n+        A : Integer;\n+        B : Boolean;\n+    end record;\n+\n+    function Func_Lim_Rec return Lim_Rec;\n+end Implicit_Param_Pkg;"}]}