{"sha": "f251709af54dc788d21dd2c6a7d7e74d7167acef", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjI1MTcwOWFmNTRkYzc4OGQyMWRkMmM2YTdkN2U3NGQ3MTY3YWNlZg==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2010-06-04T13:27:51Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2010-06-04T13:27:51Z"}, "message": "* dce.c (dce_process_block): Do not re-scan already marked instructions.\n\nFrom-SVN: r160262", "tree": {"sha": "a4ceb7e97bfde2381fe3c825e778ba184c7d2b8f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a4ceb7e97bfde2381fe3c825e778ba184c7d2b8f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f251709af54dc788d21dd2c6a7d7e74d7167acef", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f251709af54dc788d21dd2c6a7d7e74d7167acef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f251709af54dc788d21dd2c6a7d7e74d7167acef", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f251709af54dc788d21dd2c6a7d7e74d7167acef/comments", "author": null, "committer": null, "parents": [{"sha": "8ff49c29fd93d56df978cfe1e4e41812251d7773", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ff49c29fd93d56df978cfe1e4e41812251d7773", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8ff49c29fd93d56df978cfe1e4e41812251d7773"}], "stats": {"total": 27, "additions": 15, "deletions": 12}, "files": [{"sha": "9063edc4ee92c80b5d0b47d8873cbc92228eadc8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f251709af54dc788d21dd2c6a7d7e74d7167acef/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f251709af54dc788d21dd2c6a7d7e74d7167acef/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f251709af54dc788d21dd2c6a7d7e74d7167acef", "patch": "@@ -1,3 +1,7 @@\n+2010-06-04  Jan Hubicka  <jh@suse.cz>\n+\n+\t* dce.c (dce_process_block): Do not re-scan already marked instructions.\n+\n 2010-06-04  Bernd Schmidt  <bernds@codesourcery.com>\n \n \tPR rtl-optimization/39871"}, {"sha": "7191f90414f5c26fbe04539f4aec6aac94dd8112", "filename": "gcc/dce.c", "status": "modified", "additions": 11, "deletions": 12, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f251709af54dc788d21dd2c6a7d7e74d7167acef/gcc%2Fdce.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f251709af54dc788d21dd2c6a7d7e74d7167acef/gcc%2Fdce.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdce.c?ref=f251709af54dc788d21dd2c6a7d7e74d7167acef", "patch": "@@ -904,27 +904,26 @@ dce_process_block (basic_block bb, bool redo_out, bitmap au)\n   FOR_BB_INSNS_REVERSE (bb, insn)\n     if (INSN_P (insn))\n       {\n-\tbool needed = false;\n+\tbool needed = marked_insn_p (insn);\n \n \t/* The insn is needed if there is someone who uses the output.  */\n-\tfor (def_rec = DF_INSN_DEFS (insn); *def_rec; def_rec++)\n-\t  if (bitmap_bit_p (local_live, DF_REF_REGNO (*def_rec))\n-\t      || bitmap_bit_p (au, DF_REF_REGNO (*def_rec)))\n-\t    {\n-\t      needed = true;\n-\t      break;\n-\t    }\n-\n-\tif (needed)\n-\t  mark_insn (insn, true);\n+\tif (!needed)\n+\t  for (def_rec = DF_INSN_DEFS (insn); *def_rec; def_rec++)\n+\t    if (bitmap_bit_p (local_live, DF_REF_REGNO (*def_rec))\n+\t\t|| bitmap_bit_p (au, DF_REF_REGNO (*def_rec)))\n+\t      {\n+\t\tneeded = true;\n+\t\tmark_insn (insn, true);\n+\t\tbreak;\n+\t      }\n \n \t/* No matter if the instruction is needed or not, we remove\n \t   any regno in the defs from the live set.  */\n \tdf_simulate_defs (insn, local_live);\n \n \t/* On the other hand, we do not allow the dead uses to set\n \t   anything in local_live.  */\n-\tif (marked_insn_p (insn))\n+\tif (needed)\n \t  df_simulate_uses (insn, local_live);\n       }\n "}]}