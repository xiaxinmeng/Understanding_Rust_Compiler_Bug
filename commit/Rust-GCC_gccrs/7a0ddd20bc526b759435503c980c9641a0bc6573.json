{"sha": "7a0ddd20bc526b759435503c980c9641a0bc6573", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2EwZGRkMjBiYzUyNmI3NTk0MzU1MDNjOTgwYzk2NDFhMGJjNjU3Mw==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2011-09-02T09:43:58Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2011-09-02T09:43:58Z"}, "message": "[multiple changes]\n\n2011-09-02  Vincent Celier  <celier@adacore.com>\n\n\t* prj-nmsc.db: (Check_Stand_Alone_Library): For SALs, allow\n\tonly library names with the syntax of Ada identifiers, to avoid errors\n\twhen compiling the binder generated files.\n\t* projects.texi: Document restriction on SAL library names\n\n2011-09-02  Thomas Quinot  <quinot@adacore.com>\n\n\t* a-chtgbo.adb: Minor comment fix.\n\nFrom-SVN: r178455", "tree": {"sha": "c5486dba41350c97d49f1cf898860311befccd52", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c5486dba41350c97d49f1cf898860311befccd52"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7a0ddd20bc526b759435503c980c9641a0bc6573", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a0ddd20bc526b759435503c980c9641a0bc6573", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7a0ddd20bc526b759435503c980c9641a0bc6573", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a0ddd20bc526b759435503c980c9641a0bc6573/comments", "author": null, "committer": null, "parents": [{"sha": "439b6dfab1115446fb8f5d7593d62642d4751591", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/439b6dfab1115446fb8f5d7593d62642d4751591", "html_url": "https://github.com/Rust-GCC/gccrs/commit/439b6dfab1115446fb8f5d7593d62642d4751591"}], "stats": {"total": 73, "additions": 66, "deletions": 7}, "files": [{"sha": "238a8cd5408ebcf3037c506bef7d62cd8b23afc4", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a0ddd20bc526b759435503c980c9641a0bc6573/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a0ddd20bc526b759435503c980c9641a0bc6573/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=7a0ddd20bc526b759435503c980c9641a0bc6573", "patch": "@@ -1,3 +1,14 @@\n+2011-09-02  Vincent Celier  <celier@adacore.com>\n+\n+\t* prj-nmsc.db: (Check_Stand_Alone_Library): For SALs, allow\n+\tonly library names with the syntax of Ada identifiers, to avoid errors\n+\twhen compiling the binder generated files.\n+\t* projects.texi: Document restriction on SAL library names\n+\n+2011-09-02  Thomas Quinot  <quinot@adacore.com>\n+\n+\t* a-chtgbo.adb: Minor comment fix.\n+\n 2011-09-02  Robert Dewar  <dewar@adacore.com>\n \n \t* lib-xref.adb: Minor reformatting"}, {"sha": "1a395d3b34e7753319a503fd0613739752d79c7e", "filename": "gcc/ada/a-chtgbo.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a0ddd20bc526b759435503c980c9641a0bc6573/gcc%2Fada%2Fa-chtgbo.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a0ddd20bc526b759435503c980c9641a0bc6573/gcc%2Fada%2Fa-chtgbo.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fa-chtgbo.adb?ref=7a0ddd20bc526b759435503c980c9641a0bc6573", "patch": "@@ -144,7 +144,7 @@ package body Ada.Containers.Hash_Tables.Generic_Bounded_Operations is\n       --  value 0 as an error. The precondition was weakened, so that index\n       --  value 0 is now allowed, and this value is interpreted to mean \"do\n       --  nothing\". This makes its behavior analogous to the behavior of\n-      --  Ada.Unchecked_Conversion, and allows callers to avoid having to add\n+      --  Ada.Unchecked_Deallocation, and allows callers to avoid having to add\n       --  special-case checks at the point of call.\n \n       if X = 0 then"}, {"sha": "5804da911cbbe465b695eb57b0b874fa06054cb6", "filename": "gcc/ada/prj-nmsc.adb", "status": "modified", "additions": 45, "deletions": 2, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a0ddd20bc526b759435503c980c9641a0bc6573/gcc%2Fada%2Fprj-nmsc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a0ddd20bc526b759435503c980c9641a0bc6573/gcc%2Fada%2Fprj-nmsc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-nmsc.adb?ref=7a0ddd20bc526b759435503c980c9641a0bc6573", "patch": "@@ -82,8 +82,7 @@ package body Prj.Nmsc is\n       Hash       => Hash,\n       Equal      => \"=\");\n    --  File name information found in string list attribute (Source_Files or\n-   --  Source_List_File). Except is set to True if source is a naming exception\n-   --  in the project. Used to check that all referenced files were indeed\n+   --  Source_List_File). Used to check that all referenced files were indeed\n    --  found on the disk.\n \n    type Unit_Exception is record\n@@ -4302,6 +4301,12 @@ package body Prj.Nmsc is\n    is\n       Shared : constant Shared_Project_Tree_Data_Access := Data.Tree.Shared;\n \n+      Lib_Name            : constant Prj.Variable_Value :=\n+                              Prj.Util.Value_Of\n+                               (Snames.Name_Library_Name,\n+                                Project.Decl.Attributes,\n+                                Shared);\n+\n       Lib_Interfaces      : constant Prj.Variable_Value :=\n                               Prj.Util.Value_Of\n                                 (Snames.Name_Library_Interface,\n@@ -4353,6 +4358,44 @@ package body Prj.Nmsc is\n       --  Library_Interface is defined.\n \n       if not Lib_Interfaces.Default then\n+\n+         --  The name of a stand-alone library needs to have the syntax of an\n+         --  Ada identifier.\n+\n+         declare\n+            Name : constant String := Get_Name_String (Project.Library_Name);\n+            OK   : Boolean := Is_Letter (Name (Name'First));\n+            Underline : Boolean := False;\n+         begin\n+            for J in Name'First + 1 .. Name'Last loop\n+               exit when not OK;\n+\n+               if Is_Alphanumeric (Name (J)) then\n+                  Underline := False;\n+\n+               elsif Name (J) = '_' then\n+                  if Underline then\n+                     OK := False;\n+                  else\n+                     Underline := True;\n+                  end if;\n+\n+               else\n+                  OK := False;\n+               end if;\n+            end loop;\n+\n+            OK := OK and then not Underline;\n+\n+            if not OK then\n+               Error_Msg\n+                 (Data.Flags,\n+                  \"Incorrect library name for a Stand-Alone Library\",\n+                  Lib_Name.Location, Project);\n+               return;\n+            end if;\n+         end;\n+\n          declare\n             Interfaces     : String_List_Id := Lib_Interfaces.Values;\n             Interface_ALIs : String_List_Id := Nil_String;"}, {"sha": "46f149721ee4fea16755df5ec3ef39247d5845ef", "filename": "gcc/ada/projects.texi", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a0ddd20bc526b759435503c980c9641a0bc6573/gcc%2Fada%2Fprojects.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a0ddd20bc526b759435503c980c9641a0bc6573/gcc%2Fada%2Fprojects.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprojects.texi?ref=7a0ddd20bc526b759435503c980c9641a0bc6573", "patch": "@@ -1,6 +1,7 @@\n @set gprconfig GPRconfig\n \n @c ------ projects.texi\n+@c Copyright (C) 2002-2011, Free Software Foundation, Inc.\n @c This file is shared between the GNAT user's guide and gprbuild. It is not\n @c compilable on its own, you should instead compile the other two manuals.\n @c For that reason, there is no toplevel @menu\n@@ -1525,10 +1526,11 @@ front of the @code{project} keyword.\n @item @b{Library_Name}:\n @cindex @code{Library_Name}\n   This attribute is the name of the library to be built. There is no\n-  restriction on the name of a library imposed by the project manager;\n-  however, there may be system specific restrictions on the name.\n-  In general, it is recommended to stick to alphanumeric characters\n-  (and possibly underscores) to help portability.\n+  restriction on the name of a library imposed by the project manager, except\n+  for stand-alone libraries whose names must follow the syntax of Ada\n+  identifiers; however, there may be system specific restrictions on the name.\n+  In general, it is recommended to stick to alphanumeric characters (and\n+  possibly single underscores) to help portability.\n \n @item @b{Library_Dir}:\n @cindex @code{Library_Dir}\n@@ -1749,6 +1751,9 @@ transparent. However, stand-alone libraries are also useful when the main is in\n Ada: they provide a means for minimizing relinking & redeployment of complex\n systems when localized changes are made.\n \n+The name of a stand-alone library, specified with attribute\n+@code{Library_Name}, must have the syntax of an Ada identifier.\n+\n The most prominent characteristic of a stand-alone library is that it offers a\n distinction between interface units and implementation units. Only the former\n are visible to units outside the library. A stand-alone library project is thus"}]}