{"sha": "47cc2d4917c7cb351e561dba5768deaa2d42bf8b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDdjYzJkNDkxN2M3Y2IzNTFlNTYxZGJhNTc2OGRlYWEyZDQyYmY4Yg==", "commit": {"author": {"name": "Tobias Burnus", "email": "tobias@codesourcery.com", "date": "2019-11-08T08:14:40Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2019-11-08T08:14:40Z"}, "message": "Fortran] PR91253 fix continuation-line handling with -pre_include\n\n        PR fortran/91253\n        * scanner.c (skip_fixed_comments): Move comment\n        lines to next if block.\n        (gfc_next_char_literal): Fix continue_line setting.\n        (get_file): Remove bogus ATTRIBUTE_UNUSED.\n\nFrom-SVN: r277948", "tree": {"sha": "276dcd61aff86d2391fe58689f2a4b704f9059d8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/276dcd61aff86d2391fe58689f2a4b704f9059d8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/47cc2d4917c7cb351e561dba5768deaa2d42bf8b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/47cc2d4917c7cb351e561dba5768deaa2d42bf8b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/47cc2d4917c7cb351e561dba5768deaa2d42bf8b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/47cc2d4917c7cb351e561dba5768deaa2d42bf8b/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "bc5b2b688150f96bd2b75aa1b7fc4d9d53712955", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc5b2b688150f96bd2b75aa1b7fc4d9d53712955", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bc5b2b688150f96bd2b75aa1b7fc4d9d53712955"}], "stats": {"total": 34, "additions": 29, "deletions": 5}, "files": [{"sha": "f13444f00117b9a361fd224de8449d8e10ff9a41", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/47cc2d4917c7cb351e561dba5768deaa2d42bf8b/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/47cc2d4917c7cb351e561dba5768deaa2d42bf8b/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=47cc2d4917c7cb351e561dba5768deaa2d42bf8b", "patch": "@@ -1,3 +1,11 @@\n+2019-11-08  Tobias Burnus  <tobias@codesourcery.com\n+\n+\tPR fortran/91253\n+\t* scanner.c (skip_fixed_comments): Move comment\n+\tlines to next if block.\n+\t(gfc_next_char_literal): Fix continue_line setting.\n+\t(get_file): Remove bogus ATTRIBUTE_UNUSED.\n+\n 2019-11-06  Jerry DeLisle  <jvdelisle@gcc.ngu.org>\n \n \tPR fortran/90374"}, {"sha": "40c06b6b67432091c8db9c322b8685a89d99643e", "filename": "gcc/fortran/scanner.c", "status": "modified", "additions": 21, "deletions": 5, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/47cc2d4917c7cb351e561dba5768deaa2d42bf8b/gcc%2Ffortran%2Fscanner.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/47cc2d4917c7cb351e561dba5768deaa2d42bf8b/gcc%2Ffortran%2Fscanner.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fscanner.c?ref=47cc2d4917c7cb351e561dba5768deaa2d42bf8b", "patch": "@@ -1050,17 +1050,17 @@ skip_fixed_comments (void)\n \t      return;\n \t    }\n \n+\t  if (gfc_current_locus.lb != NULL\n+\t      && continue_line < gfc_linebuf_linenum (gfc_current_locus.lb))\n+\t    continue_line = gfc_linebuf_linenum (gfc_current_locus.lb);\n+\n \t  /* If -fopenmp/-fopenacc, we need to handle here 2 things:\n \t     1) don't treat !$omp/!$acc|c$omp/c$acc|*$omp / *$acc as comments, \n \t\tbut directives\n \t     2) handle OpenMP/OpenACC conditional compilation, where\n \t\t!$|c$|*$ should be treated as 2 spaces if the characters\n \t\tin columns 3 to 6 are valid fixed form label columns\n \t\tcharacters.  */\n-\t  if (gfc_current_locus.lb != NULL\n-\t      && continue_line < gfc_linebuf_linenum (gfc_current_locus.lb))\n-\t    continue_line = gfc_linebuf_linenum (gfc_current_locus.lb);\n-\n \t  if ((flag_openmp || flag_openmp_simd) && !flag_openacc)\n \t    {\n \t      if (next_char () == '$')\n@@ -1313,6 +1313,14 @@ gfc_next_char_literal (gfc_instring in_string)\n       if (flag_openacc)\n \tprev_openacc_flag = openacc_flag;\n \n+      /* This can happen if the input file changed or via cpp's #line\n+\t without getting reset (e.g. via input_stmt). It also happens\n+\t when pre-including files via -fpre-include=.  */\n+      if (continue_count == 0\n+\t  && gfc_current_locus.lb\n+\t  && continue_line > gfc_linebuf_linenum (gfc_current_locus.lb) + 1)\n+\tcontinue_line = gfc_linebuf_linenum (gfc_current_locus.lb) + 1;\n+\n       continue_flag = 1;\n       if (c == '!')\n \tskip_comment_line ();\n@@ -1475,6 +1483,14 @@ gfc_next_char_literal (gfc_instring in_string)\n       if (flag_openacc)\n \tprev_openacc_flag = openacc_flag;\n \n+      /* This can happen if the input file changed or via cpp's #line\n+\t without getting reset (e.g. via input_stmt). It also happens\n+\t when pre-including files via -fpre-include=.  */\n+      if (continue_count == 0\n+\t  && gfc_current_locus.lb\n+\t  && continue_line > gfc_linebuf_linenum (gfc_current_locus.lb) + 1)\n+\tcontinue_line = gfc_linebuf_linenum (gfc_current_locus.lb) + 1;\n+\n       continue_flag = 1;\n       old_loc = gfc_current_locus;\n \n@@ -1943,7 +1959,7 @@ load_line (FILE *input, gfc_char_t **pbuf, int *pbuflen, const int *first_char)\n    the file stack.  */\n \n static gfc_file *\n-get_file (const char *name, enum lc_reason reason ATTRIBUTE_UNUSED)\n+get_file (const char *name, enum lc_reason reason)\n {\n   gfc_file *f;\n "}]}