{"sha": "cea85c669704332baacfe8a50f18d8498a025309", "node_id": "C_kwDOANBUbNoAKGNlYTg1YzY2OTcwNDMzMmJhYWNmZThhNTBmMThkODQ5OGEwMjUzMDk", "commit": {"author": {"name": "Andrea Corallo", "email": "andrea.corallo@arm.com", "date": "2021-12-06T10:42:59Z"}, "committer": {"name": "Andrea Corallo", "email": "andrea.corallo@arm.com", "date": "2023-01-23T10:32:06Z"}, "message": "[PATCH 8/15] arm: Introduce multilibs for PACBTI target feature\n\nThis patch add the following new multilibs.\n\nthumb/v8.1-m.main+pacbti/mbranch-protection/nofp\nthumb/v8.1-m.main+pacbti+dp/mbranch-protection/soft\nthumb/v8.1-m.main+pacbti+dp/mbranch-protection/hard\nthumb/v8.1-m.main+pacbti+fp/mbranch-protection/soft\nthumb/v8.1-m.main+pacbti+fp/mbranch-protection/hard\nthumb/v8.1-m.main+pacbti+mve/mbranch-protection/hard\n\nTriggering the following compiler flags:\n\n-mthumb -march=armv8.1-m.main+pacbti -mbranch-protection=standard -mfloat-abi=soft\n-mthumb -march=armv8.1-m.main+pacbti+fp -mbranch-protection=standard -mfloat-abi=softfp\n-mthumb -march=armv8.1-m.main+pacbti+fp -mbranch-protection=standard -mfloat-abi=hard\n-mthumb -march=armv8.1-m.main+pacbti+fp.dp -mbranch-protection=standard -mfloat-abi=softfp\n-mthumb -march=armv8.1-m.main+pacbti+fp.dp -mbranch-protection=standard -mfloat-abi=hard\n-mthumb -march=armv8.1-m.main+pacbti+mve -mbranch-protection=standard -mfloat-abi=hard\n\ngcc/\n\n\t* config/arm/t-rmprofile: Add multilib rules for march +pacbti and\n\tmbranch-protection.\n\ngcc/testsuite/\n\n\t* gcc.target/arm/multilib.exp: Add pacbti related entries.", "tree": {"sha": "d189eb33972721d99186c53d6e9023968cce2995", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d189eb33972721d99186c53d6e9023968cce2995"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cea85c669704332baacfe8a50f18d8498a025309", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cea85c669704332baacfe8a50f18d8498a025309", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cea85c669704332baacfe8a50f18d8498a025309", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cea85c669704332baacfe8a50f18d8498a025309/comments", "author": {"login": "AndreaCorallo", "id": 6765576, "node_id": "MDQ6VXNlcjY3NjU1NzY=", "avatar_url": "https://avatars.githubusercontent.com/u/6765576?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AndreaCorallo", "html_url": "https://github.com/AndreaCorallo", "followers_url": "https://api.github.com/users/AndreaCorallo/followers", "following_url": "https://api.github.com/users/AndreaCorallo/following{/other_user}", "gists_url": "https://api.github.com/users/AndreaCorallo/gists{/gist_id}", "starred_url": "https://api.github.com/users/AndreaCorallo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AndreaCorallo/subscriptions", "organizations_url": "https://api.github.com/users/AndreaCorallo/orgs", "repos_url": "https://api.github.com/users/AndreaCorallo/repos", "events_url": "https://api.github.com/users/AndreaCorallo/events{/privacy}", "received_events_url": "https://api.github.com/users/AndreaCorallo/received_events", "type": "User", "site_admin": false}, "committer": {"login": "AndreaCorallo", "id": 6765576, "node_id": "MDQ6VXNlcjY3NjU1NzY=", "avatar_url": "https://avatars.githubusercontent.com/u/6765576?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AndreaCorallo", "html_url": "https://github.com/AndreaCorallo", "followers_url": "https://api.github.com/users/AndreaCorallo/followers", "following_url": "https://api.github.com/users/AndreaCorallo/following{/other_user}", "gists_url": "https://api.github.com/users/AndreaCorallo/gists{/gist_id}", "starred_url": "https://api.github.com/users/AndreaCorallo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AndreaCorallo/subscriptions", "organizations_url": "https://api.github.com/users/AndreaCorallo/orgs", "repos_url": "https://api.github.com/users/AndreaCorallo/repos", "events_url": "https://api.github.com/users/AndreaCorallo/events{/privacy}", "received_events_url": "https://api.github.com/users/AndreaCorallo/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "616c1d02bcea9ff24ff2873c6d2efc84c7be4192", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/616c1d02bcea9ff24ff2873c6d2efc84c7be4192", "html_url": "https://github.com/Rust-GCC/gccrs/commit/616c1d02bcea9ff24ff2873c6d2efc84c7be4192"}], "stats": {"total": 34, "additions": 32, "deletions": 2}, "files": [{"sha": "ecfdc9861e38c7b25dc982a19fc2381e7dcbb3b4", "filename": "gcc/config/arm/t-rmprofile", "status": "modified", "additions": 26, "deletions": 2, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cea85c669704332baacfe8a50f18d8498a025309/gcc%2Fconfig%2Farm%2Ft-rmprofile", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cea85c669704332baacfe8a50f18d8498a025309/gcc%2Fconfig%2Farm%2Ft-rmprofile", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Ft-rmprofile?ref=cea85c669704332baacfe8a50f18d8498a025309", "patch": "@@ -27,8 +27,11 @@\n \n # Arch and FPU variants to build libraries with\n \n-MULTI_ARCH_OPTS_RM\t= march=armv6s-m/march=armv7-m/march=armv7e-m/march=armv7e-m+fp/march=armv7e-m+fp.dp/march=armv8-m.base/march=armv8-m.main/march=armv8-m.main+fp/march=armv8-m.main+fp.dp/march=armv8.1-m.main+mve\n-MULTI_ARCH_DIRS_RM\t= v6-m v7-m v7e-m v7e-m+fp v7e-m+dp v8-m.base v8-m.main v8-m.main+fp v8-m.main+dp v8.1-m.main+mve\n+MULTI_ARCH_OPTS_RM\t= march=armv6s-m/march=armv7-m/march=armv7e-m/march=armv7e-m+fp/march=armv7e-m+fp.dp/march=armv8-m.base/march=armv8-m.main/march=armv8-m.main+fp/march=armv8-m.main+fp.dp/march=armv8.1-m.main+mve/march=armv8.1-m.main+pacbti/march=armv8.1-m.main+pacbti+fp/march=armv8.1-m.main+pacbti+fp.dp/march=armv8.1-m.main+pacbti+mve\n+MULTI_ARCH_DIRS_RM\t= v6-m v7-m v7e-m v7e-m+fp v7e-m+dp v8-m.base v8-m.main v8-m.main+fp v8-m.main+dp v8.1-m.main+mve v8.1-m.main+pacbti v8.1-m.main+pacbti+fp v8.1-m.main+pacbti+dp v8.1-m.main+pacbti+mve\n+\n+MULTI_ARCH_OPTS_RM\t+= mbranch-protection=standard\n+MULTI_ARCH_DIRS_RM\t+= mbranch-protection\n \n # Base M-profile (no fp)\n MULTILIB_REQUIRED\t+= mthumb/march=armv6s-m/mfloat-abi=soft\n@@ -50,6 +53,13 @@ MULTILIB_REQUIRED\t+= mthumb/march=armv8-m.main+fp.dp/mfloat-abi=hard\n MULTILIB_REQUIRED\t+= mthumb/march=armv8-m.main+fp.dp/mfloat-abi=softfp\n MULTILIB_REQUIRED\t+= mthumb/march=armv8.1-m.main+mve/mfloat-abi=hard\n \n+MULTILIB_REQUIRED\t+= mthumb/march=armv8.1-m.main+pacbti/mbranch-protection=standard/mfloat-abi=soft\n+MULTILIB_REQUIRED\t+= mthumb/march=armv8.1-m.main+pacbti+fp/mbranch-protection=standard/mfloat-abi=softfp\n+MULTILIB_REQUIRED\t+= mthumb/march=armv8.1-m.main+pacbti+fp/mbranch-protection=standard/mfloat-abi=hard\n+MULTILIB_REQUIRED\t+= mthumb/march=armv8.1-m.main+pacbti+fp.dp/mbranch-protection=standard/mfloat-abi=softfp\n+MULTILIB_REQUIRED\t+= mthumb/march=armv8.1-m.main+pacbti+fp.dp/mbranch-protection=standard/mfloat-abi=hard\n+MULTILIB_REQUIRED\t+= mthumb/march=armv8.1-m.main+pacbti+mve/mbranch-protection=standard/mfloat-abi=hard\n+\n # Arch Matches\n MULTILIB_MATCHES\t+= march?armv6s-m=march?armv6-m\n \n@@ -87,9 +97,23 @@ MULTILIB_MATCHES += $(foreach FP, $(v8_1m_sp_variants), \\\n MULTILIB_MATCHES += $(foreach FP, $(v8_1m_dp_variants), \\\n \t\t\t     march?armv8-m.main+fp.dp=mlibarch?armv8.1-m.main$(FP))\n \n+# Map all mbranch-protection values other than 'none' to 'standard'.\n+MULTILIB_MATCHES\t+= mbranch-protection?standard=mbranch-protection?bti\n+MULTILIB_MATCHES\t+= mbranch-protection?standard=mbranch-protection?pac-ret\n+MULTILIB_MATCHES\t+= mbranch-protection?standard=mbranch-protection?pac-ret+leaf\n+MULTILIB_MATCHES\t+= mbranch-protection?standard=mbranch-protection?pac-ret+bti\n+MULTILIB_MATCHES\t+= mbranch-protection?standard=mbranch-protection?pac-ret+leaf+bti\n+MULTILIB_MATCHES\t+= mbranch-protection?standard=mbranch-protection?bti+pac-ret\n+MULTILIB_MATCHES\t+= mbranch-protection?standard=mbranch-protection?bti+pac-ret+leaf\n+MULTILIB_MATCHES\t+= mbranch-protection?standard=mbranch-protection?standard+leaf\n+\n # For all the MULTILIB_REQUIRED for v8-m and above, add MULTILIB_MATCHES which\n # maps mlibarch with march for multilib linking.\n MULTILIB_MATCHES\t+= march?armv8-m.main=mlibarch?armv8-m.main\n MULTILIB_MATCHES\t+= march?armv8-m.main+fp=mlibarch?armv8-m.main+fp\n MULTILIB_MATCHES\t+= march?armv8-m.main+fp.dp=mlibarch?armv8-m.main+fp.dp\n MULTILIB_MATCHES\t+= march?armv8.1-m.main+mve=mlibarch?armv8.1-m.main+mve\n+MULTILIB_MATCHES\t+= march?armv8.1-m.main+pacbti=mlibarch?armv8.1-m.main+pacbti\n+MULTILIB_MATCHES\t+= march?armv8.1-m.main+pacbti+fp=mlibarch?armv8.1-m.main+pacbti+fp\n+MULTILIB_MATCHES\t+= march?armv8.1-m.main+pacbti+fp.dp=mlibarch?armv8.1-m.main+pacbti+fp.dp\n+MULTILIB_MATCHES\t+= march?armv8.1-m.main+pacbti+mve=mlibarch?armv8.1-m.main+pacbti+mve"}, {"sha": "4f0a0a14b1cbb6ab6ac9cdf658595c10f2ef1e35", "filename": "gcc/testsuite/gcc.target/arm/multilib.exp", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cea85c669704332baacfe8a50f18d8498a025309/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmultilib.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cea85c669704332baacfe8a50f18d8498a025309/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmultilib.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmultilib.exp?ref=cea85c669704332baacfe8a50f18d8498a025309", "patch": "@@ -838,6 +838,12 @@ if {[multilib_config \"rmprofile\"] } {\n \t{-march=armv8.1-m.main+mve.fp+fp.dp -mfpu=auto -mfloat-abi=softfp} \"thumb/v8-m.main+dp/softfp\"\n \t{-march=armv8.1-m.main+mve+fp.dp -mfpu=auto -mfloat-abi=hard} \"thumb/v8-m.main+dp/hard\"\n \t{-march=armv8.1-m.main+mve.fp+fp.dp -mfpu=auto -mfloat-abi=hard} \"thumb/v8-m.main+dp/hard\"\n+\t{-march=armv8.1-m.main+pacbti -mbranch-protection=standard -mfloat-abi=soft} \"thumb/v8.1-m.main+pacbti/mbranch-protection/nofp\"\n+\t{-march=armv8.1-m.main+pacbti+fp -mbranch-protection=standard -mfloat-abi=softfp} \"thumb/v8.1-m.main+pacbti+fp/mbranch-protection/soft\"\n+\t{-march=armv8.1-m.main+pacbti+fp -mbranch-protection=standard -mfloat-abi=hard} \"thumb/v8.1-m.main+pacbti+fp/mbranch-protection/hard\"\n+\t{-march=armv8.1-m.main+pacbti+fp.dp -mbranch-protection=standard -mfloat-abi=softfp} \"thumb/v8.1-m.main+pacbti+dp/mbranch-protection/soft\"\n+\t{-march=armv8.1-m.main+pacbti+fp.dp -mbranch-protection=standard -mfloat-abi=hard} \"thumb/v8.1-m.main+pacbti+dp/mbranch-protection/hard\"\n+\t{-march=armv8.1-m.main+pacbti+mve -mbranch-protection=standard -mfloat-abi=hard} \"thumb/v8.1-m.main+pacbti+mve/mbranch-protection/hard\"\n \t{-mcpu=cortex-m55+nomve -mfpu=auto -mfloat-abi=soft} \"thumb/v8-m.main/nofp\"\n \t{-mcpu=cortex-m55+nomve -mfpu=auto -mfloat-abi=softfp} \"thumb/v8-m.main+dp/softfp\"\n \t{-mcpu=cortex-m55+nomve -mfpu=auto -mfloat-abi=hard} \"thumb/v8-m.main+dp/hard\""}]}