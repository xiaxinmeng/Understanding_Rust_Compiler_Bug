{"sha": "1db75f6c39f5ef4cda5f3b76975dddff035c90fd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWRiNzVmNmMzOWY1ZWY0Y2RhNWYzYjc2OTc1ZGRkZmYwMzVjOTBmZA==", "commit": {"author": {"name": "Michael Meissner", "email": "meissner@linux.vnet.ibm.com", "date": "2011-07-13T21:38:29Z"}, "committer": {"name": "Michael Meissner", "email": "meissner@gcc.gnu.org", "date": "2011-07-13T21:38:29Z"}, "message": "Change -mno-r11 to -mno-pointers-to-nested-functions\n\nFrom-SVN: r176252", "tree": {"sha": "41caa311889940f758249e50dea016723e0e5b68", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/41caa311889940f758249e50dea016723e0e5b68"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1db75f6c39f5ef4cda5f3b76975dddff035c90fd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1db75f6c39f5ef4cda5f3b76975dddff035c90fd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1db75f6c39f5ef4cda5f3b76975dddff035c90fd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1db75f6c39f5ef4cda5f3b76975dddff035c90fd/comments", "author": null, "committer": null, "parents": [{"sha": "f542c405c0bb1d6eda47ba05832fbd3c10e7e27e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f542c405c0bb1d6eda47ba05832fbd3c10e7e27e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f542c405c0bb1d6eda47ba05832fbd3c10e7e27e"}], "stats": {"total": 63, "additions": 45, "deletions": 18}, "files": [{"sha": "157ad42b7c0ab8bc1c9a9829561a463125127d4e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1db75f6c39f5ef4cda5f3b76975dddff035c90fd/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1db75f6c39f5ef4cda5f3b76975dddff035c90fd/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1db75f6c39f5ef4cda5f3b76975dddff035c90fd", "patch": "@@ -1,3 +1,19 @@\n+2011-07-13  Michael Meissner  <meissner@linux.vnet.ibm.com>\n+\n+\t* config/rs6000/rs6000.opt (-mpointers-to-nested-functions):\n+\tRename -mr11.\n+\t* config/rs6000/rs6000.c (rs6000_trampoline_init): Ditto.\n+\t(rs6000_call_indirect_aix): Ditto.\n+\t* config/rs6000/rs6000.md (call_indirect_aix<ptrsize>): Ditto.\n+\t(call_indirect_aix<ptrsize>_internal): Ditto.\n+\t(call_indirect_aix<ptrsize>_nor11): Ditto.\n+\t(call_indirect_aix<ptrsize>_internal2): Ditto.\n+\t(call_value_indirect_aix<ptrsize>): Ditto.\n+\t(call_value_indirect_aix<ptrsize>_internal): Ditto.\n+\t(call_value_indirect_aix<ptrsize>_nor11): Ditto.\n+\t(call_value_indirect_aix<ptrsize>_internal2): Ditto.\n+\t* doc/invoke.texi (RS/6000 and PowerPC Options): Ditto.\n+\n 2011-07-13  Jason Merrill  <jason@redhat.com>\n \n \t* Makefile.in ($(lang_checks_parallelized)): Allow --tool_opts."}, {"sha": "79dd1403c91f00026e819cd2298ebaed87a0c4e0", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1db75f6c39f5ef4cda5f3b76975dddff035c90fd/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1db75f6c39f5ef4cda5f3b76975dddff035c90fd/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=1db75f6c39f5ef4cda5f3b76975dddff035c90fd", "patch": "@@ -24409,7 +24409,7 @@ rs6000_trampoline_init (rtx m_tramp, tree fndecl, rtx cxt)\n       {\n \trtx fnmem, fn_reg, toc_reg;\n \n-\tif (!TARGET_R11)\n+\tif (!TARGET_POINTERS_TO_NESTED_FUNCTIONS)\n \t  error (\"-mno-r11 must not be used if you have trampolines\");\n \n \tfnmem = gen_const_mem (Pmode, force_reg (Pmode, fnaddr));\n@@ -27741,7 +27741,7 @@ rs6000_call_indirect_aix (rtx value, rtx func_desc, rtx flag)\n       stack_toc_offset = GEN_INT (TOC_SAVE_OFFSET_32BIT);\n       func_toc_offset = GEN_INT (AIX_FUNC_DESC_TOC_32BIT);\n       func_sc_offset = GEN_INT (AIX_FUNC_DESC_SC_32BIT);\n-      if (TARGET_R11)\n+      if (TARGET_POINTERS_TO_NESTED_FUNCTIONS)\n \t{\n \t  call_func = gen_call_indirect_aix32bit;\n \t  call_value_func = gen_call_value_indirect_aix32bit;\n@@ -27757,7 +27757,7 @@ rs6000_call_indirect_aix (rtx value, rtx func_desc, rtx flag)\n       stack_toc_offset = GEN_INT (TOC_SAVE_OFFSET_64BIT);\n       func_toc_offset = GEN_INT (AIX_FUNC_DESC_TOC_64BIT);\n       func_sc_offset = GEN_INT (AIX_FUNC_DESC_SC_64BIT);\n-      if (TARGET_R11)\n+      if (TARGET_POINTERS_TO_NESTED_FUNCTIONS)\n \t{\n \t  call_func = gen_call_indirect_aix64bit;\n \t  call_value_func = gen_call_value_indirect_aix64bit;\n@@ -27800,7 +27800,7 @@ rs6000_call_indirect_aix (rtx value, rtx func_desc, rtx flag)\n \t\t\t\t\t    func_toc_offset));\n \n   /* If we have a static chain, load it up.  */\n-  if (TARGET_R11)\n+  if (TARGET_POINTERS_TO_NESTED_FUNCTIONS)\n     {\n       func_sc_mem = gen_rtx_MEM (Pmode,\n \t\t\t\t gen_rtx_PLUS (Pmode,"}, {"sha": "b34b70a27f451c915667ccff0e2a593c29c95ff3", "filename": "gcc/config/rs6000/rs6000.md", "status": "modified", "additions": 12, "deletions": 8, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1db75f6c39f5ef4cda5f3b76975dddff035c90fd/gcc%2Fconfig%2Frs6000%2Frs6000.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1db75f6c39f5ef4cda5f3b76975dddff035c90fd/gcc%2Fconfig%2Frs6000%2Frs6000.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.md?ref=1db75f6c39f5ef4cda5f3b76975dddff035c90fd", "patch": "@@ -12386,7 +12386,7 @@\n    (use (match_operand:P 3 \"memory_operand\" \"m,m\"))\n    (use (reg:P STATIC_CHAIN_REGNUM))\n    (clobber (reg:P LR_REGNO))]\n-  \"DEFAULT_ABI == ABI_AIX && TARGET_R11\"\n+  \"DEFAULT_ABI == ABI_AIX && TARGET_POINTERS_TO_NESTED_FUNCTIONS\"\n   \"#\"\n   \"&& reload_completed\"\n   [(set (reg:P TOC_REGNUM) (match_dup 2))\n@@ -12409,7 +12409,8 @@\n    (use (match_operand:P 2 \"memory_operand\" \"m,m\"))\n    (set (reg:P TOC_REGNUM) (match_dup 2))\n    (clobber (reg:P LR_REGNO))]\n-  \"DEFAULT_ABI == ABI_AIX && reload_completed && TARGET_R11\"\n+  \"DEFAULT_ABI == ABI_AIX && reload_completed\n+   && TARGET_POINTERS_TO_NESTED_FUNCTIONS\"\n   \"b%T0l\\;<ptrload> 2,%2\"\n   [(set_attr \"type\" \"jmpreg\")\n    (set_attr \"length\" \"8\")])\n@@ -12426,7 +12427,7 @@\n    (use (match_operand:P 2 \"memory_operand\" \"m,m\"))\n    (use (match_operand:P 3 \"memory_operand\" \"m,m\"))\n    (clobber (reg:P LR_REGNO))]\n-  \"DEFAULT_ABI == ABI_AIX && !TARGET_R11\"\n+  \"DEFAULT_ABI == ABI_AIX && !TARGET_POINTERS_TO_NESTED_FUNCTIONS\"\n   \"#\"\n   \"&& reload_completed\"\n   [(set (reg:P TOC_REGNUM) (match_dup 2))\n@@ -12447,7 +12448,8 @@\n    (use (match_operand:P 2 \"memory_operand\" \"m,m\"))\n    (set (reg:P TOC_REGNUM) (match_dup 2))\n    (clobber (reg:P LR_REGNO))]\n-  \"DEFAULT_ABI == ABI_AIX && reload_completed && !TARGET_R11\"\n+  \"DEFAULT_ABI == ABI_AIX && reload_completed\n+   && !TARGET_POINTERS_TO_NESTED_FUNCTIONS\"\n   \"b%T0l\\;<ptrload> 2,%2\"\n   [(set_attr \"type\" \"jmpreg\")\n    (set_attr \"length\" \"8\")])\n@@ -12466,7 +12468,7 @@\n    (use (match_operand:P 4 \"memory_operand\" \"m,m\"))\n    (use (reg:P STATIC_CHAIN_REGNUM))\n    (clobber (reg:P LR_REGNO))]\n-  \"DEFAULT_ABI == ABI_AIX && TARGET_R11\"\n+  \"DEFAULT_ABI == ABI_AIX && TARGET_POINTERS_TO_NESTED_FUNCTIONS\"\n   \"#\"\n   \"&& reload_completed\"\n   [(set (reg:P TOC_REGNUM) (match_dup 3))\n@@ -12491,7 +12493,8 @@\n    (use (match_operand:P 3 \"memory_operand\" \"m,m\"))\n    (set (reg:P TOC_REGNUM) (match_dup 3))\n    (clobber (reg:P LR_REGNO))]\n-  \"DEFAULT_ABI == ABI_AIX && reload_completed && TARGET_R11\"\n+  \"DEFAULT_ABI == ABI_AIX && reload_completed\n+   && TARGET_POINTERS_TO_NESTED_FUNCTIONS\"\n   \"b%T1l\\;<ptrload> 2,%3\"\n   [(set_attr \"type\" \"jmpreg\")\n    (set_attr \"length\" \"8\")])\n@@ -12510,7 +12513,7 @@\n    (use (match_operand:P 3 \"memory_operand\" \"m,m\"))\n    (use (match_operand:P 4 \"memory_operand\" \"m,m\"))\n    (clobber (reg:P LR_REGNO))]\n-  \"DEFAULT_ABI == ABI_AIX && !TARGET_R11\"\n+  \"DEFAULT_ABI == ABI_AIX && !TARGET_POINTERS_TO_NESTED_FUNCTIONS\"\n   \"#\"\n   \"&& reload_completed\"\n   [(set (reg:P TOC_REGNUM) (match_dup 3))\n@@ -12533,7 +12536,8 @@\n    (use (match_operand:P 3 \"memory_operand\" \"m,m\"))\n    (set (reg:P TOC_REGNUM) (match_dup 3))\n    (clobber (reg:P LR_REGNO))]\n-  \"DEFAULT_ABI == ABI_AIX && reload_completed && !TARGET_R11\"\n+  \"DEFAULT_ABI == ABI_AIX && reload_completed\n+   && !TARGET_POINTERS_TO_NESTED_FUNCTIONS\"\n   \"b%T1l\\;<ptrload> 2,%3\"\n   [(set_attr \"type\" \"jmpreg\")\n    (set_attr \"length\" \"8\")])"}, {"sha": "292308f60d06e9e9c2608a809c4a434a602e2a7b", "filename": "gcc/config/rs6000/rs6000.opt", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1db75f6c39f5ef4cda5f3b76975dddff035c90fd/gcc%2Fconfig%2Frs6000%2Frs6000.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1db75f6c39f5ef4cda5f3b76975dddff035c90fd/gcc%2Fconfig%2Frs6000%2Frs6000.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.opt?ref=1db75f6c39f5ef4cda5f3b76975dddff035c90fd", "patch": "@@ -521,9 +521,9 @@ mxilinx-fpu\n Target Var(rs6000_xilinx_fpu) Save\n Specify Xilinx FPU.\n \n-mr11\n-Target Report Var(TARGET_R11) Init(1) Save\n-Use/do not use r11 to hold the static link in calls.\n+mpointers-to-nested-functions\n+Target Report Var(TARGET_POINTERS_TO_NESTED_FUNCTIONS) Init(1) Save\n+Use/do not use r11 to hold the static link in calls to functions via pointers.\n \n msave-toc-indirect\n Target Undocumented Var(TARGET_SAVE_TOC_INDIRECT) Save Init(1)"}, {"sha": "a38c046e430ea910a2c83afa1ef3e7f91ac17604", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1db75f6c39f5ef4cda5f3b76975dddff035c90fd/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1db75f6c39f5ef4cda5f3b76975dddff035c90fd/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1db75f6c39f5ef4cda5f3b76975dddff035c90fd", "patch": "@@ -1,3 +1,10 @@\n+2011-07-13  Michael Meissner  <meissner@linux.vnet.ibm.com>\n+\n+\t* gcc.target/powerpc/no-r11-1.c: Change -mno-r11 to\n+\t-mno-pointers-to-nested-functions.\n+\t* gcc.target/powerpc/no-r11-2.c: Ditto.\n+\t* gcc.target/powerpc/no-r11-3.c: Ditto.\n+\n 2011-07-13  Jason Merrill  <jason@redhat.com>\n \n \t* lib/g++.exp (${tool}_option_help, ${tool}_option_proc): Remove."}, {"sha": "57c01a3e259dee819bb6ba13f32222fbd4046acd", "filename": "gcc/testsuite/gcc.target/powerpc/no-r11-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1db75f6c39f5ef4cda5f3b76975dddff035c90fd/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fno-r11-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1db75f6c39f5ef4cda5f3b76975dddff035c90fd/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fno-r11-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fno-r11-1.c?ref=1db75f6c39f5ef4cda5f3b76975dddff035c90fd", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do compile { target { powerpc*-*-* && lp64 } } } */\n /* { dg-skip-if \"\" { *-*-darwin* } { \"*\" } { \"\" } } */\n-/* { dg-options \"-O2 -mno-r11\" } */\n+/* { dg-options \"-O2 -mno-pointers-to-nested-functions\" } */\n \n int\n call_ptr (int (func) (void))"}, {"sha": "3e4a6ca0ff463441da06482e19880da4d4490028", "filename": "gcc/testsuite/gcc.target/powerpc/no-r11-2.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1db75f6c39f5ef4cda5f3b76975dddff035c90fd/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fno-r11-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1db75f6c39f5ef4cda5f3b76975dddff035c90fd/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fno-r11-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fno-r11-2.c?ref=1db75f6c39f5ef4cda5f3b76975dddff035c90fd", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do compile { target { powerpc*-*-* && lp64 } } } */\n /* { dg-skip-if \"\" { *-*-darwin* } { \"*\" } { \"\" } } */\n-/* { dg-options \"-O2 -mr11\" } */\n+/* { dg-options \"-O2 -mpointers-to-nested-functions\" } */\n \n int\n call_ptr (int (func) (void))"}, {"sha": "c4b2448ea5d78725777535e90cca3154bc21b1cb", "filename": "gcc/testsuite/gcc.target/powerpc/no-r11-3.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1db75f6c39f5ef4cda5f3b76975dddff035c90fd/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fno-r11-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1db75f6c39f5ef4cda5f3b76975dddff035c90fd/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fno-r11-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fno-r11-3.c?ref=1db75f6c39f5ef4cda5f3b76975dddff035c90fd", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do compile { target { powerpc*-*-* && lp64 } } } */\n /* { dg-skip-if \"\" { *-*-darwin* } { \"*\" } { \"\" } } */\n-/* { dg-options \"-O2 -mno-r11\" } */\n+/* { dg-options \"-O2 -mno-pointers-to-nested-functions\" } */\n \n extern void ext_call (int (func) (void));\n "}]}