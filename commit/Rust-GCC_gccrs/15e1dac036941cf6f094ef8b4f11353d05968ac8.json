{"sha": "15e1dac036941cf6f094ef8b4f11353d05968ac8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTVlMWRhYzAzNjk0MWNmNmYwOTRlZjhiNGYxMTM1M2QwNTk2OGFjOA==", "commit": {"author": {"name": "Peter Maydell", "email": "pmaydell@chiark.greenend.org.uk", "date": "2008-07-10T03:51:04Z"}, "committer": {"name": "Matthias Klose", "email": "doko@gcc.gnu.org", "date": "2008-07-10T03:51:04Z"}, "message": "re PR other/28322 (GCC new warnings and compatibility)\n\n2008-07-10  Peter Maydell  <pmaydell@chiark.greenend.org.uk>\n\n        PR other/28322\n        * opts.c (print_ignored_options): report postponed diagnostics for\n        unknown -Wno-* options as warnings, not errors.\n        (postpone_unknown_option_error): renamed to\n        postpone_unknown_option_warning.\n        * gcc.dg/pr28322-2.c: check that emitted diagnostic for -Wno-foobar\n        is a warning and not an error.\n\nFrom-SVN: r137687", "tree": {"sha": "b4ac0f8b506dab7f430e4dfdd07dc085a83e5dfc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b4ac0f8b506dab7f430e4dfdd07dc085a83e5dfc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/15e1dac036941cf6f094ef8b4f11353d05968ac8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15e1dac036941cf6f094ef8b4f11353d05968ac8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/15e1dac036941cf6f094ef8b4f11353d05968ac8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15e1dac036941cf6f094ef8b4f11353d05968ac8/comments", "author": {"login": "pm215", "id": 1682716, "node_id": "MDQ6VXNlcjE2ODI3MTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1682716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pm215", "html_url": "https://github.com/pm215", "followers_url": "https://api.github.com/users/pm215/followers", "following_url": "https://api.github.com/users/pm215/following{/other_user}", "gists_url": "https://api.github.com/users/pm215/gists{/gist_id}", "starred_url": "https://api.github.com/users/pm215/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pm215/subscriptions", "organizations_url": "https://api.github.com/users/pm215/orgs", "repos_url": "https://api.github.com/users/pm215/repos", "events_url": "https://api.github.com/users/pm215/events{/privacy}", "received_events_url": "https://api.github.com/users/pm215/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "d674c8bacd2483bbdbbd82e067b39fc09f661b1b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d674c8bacd2483bbdbbd82e067b39fc09f661b1b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d674c8bacd2483bbdbbd82e067b39fc09f661b1b"}], "stats": {"total": 27, "additions": 20, "deletions": 7}, "files": [{"sha": "3e9ce90d36c3a5f1a9d7f69b7da65f018668fa70", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15e1dac036941cf6f094ef8b4f11353d05968ac8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15e1dac036941cf6f094ef8b4f11353d05968ac8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=15e1dac036941cf6f094ef8b4f11353d05968ac8", "patch": "@@ -1,3 +1,13 @@\n+2008-07-10  Peter Maydell  <pmaydell@chiark.greenend.org.uk>\n+\n+\tPR other/28322\n+\t* opts.c (print_ignored_options): report postponed diagnostics for\n+\tunknown -Wno-* options as warnings, not errors.\n+\t(postpone_unknown_option_error): renamed to\n+\tpostpone_unknown_option_warning.\n+\t* gcc.dg/pr28322-2.c: check that emitted diagnostic for -Wno-foobar\n+\tis a warning and not an error.\n+\n 2008-07-09  Doug Kwan  <dougkwan@google.com>\n \n \tRevert:"}, {"sha": "7e8e96c4dadae8a95b5b542b6b1e3671dca6eba3", "filename": "gcc/opts.c", "status": "modified", "additions": 9, "deletions": 6, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15e1dac036941cf6f094ef8b4f11353d05968ac8/gcc%2Fopts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15e1dac036941cf6f094ef8b4f11353d05968ac8/gcc%2Fopts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fopts.c?ref=15e1dac036941cf6f094ef8b4f11353d05968ac8", "patch": "@@ -457,14 +457,17 @@ complain_wrong_lang (const char *text, const struct cl_option *option,\n \n /* Buffer the unknown option described by the string OPT.  Currently,\n    we only complain about unknown -Wno-* options if they may have\n-   prevented a diagnostic. Otherwise, we just ignore them.  */\n+   prevented a diagnostic. Otherwise, we just ignore them.\n+   Note that if we do complain, it is only as a warning, not an error;\n+   passing the compiler an unrecognised -Wno-* option should never\n+   change whether the compilation succeeds or fails.  */\n \n-static void postpone_unknown_option_error(const char *opt)\n+static void postpone_unknown_option_warning(const char *opt)\n {\n   VEC_safe_push (const_char_p, heap, ignored_options, opt);\n }\n \n-/* Produce an error for each option previously buffered.  */\n+/* Produce a warning for each option previously buffered.  */\n \n void print_ignored_options (void)\n {\n@@ -476,7 +479,7 @@ void print_ignored_options (void)\n     {\n       const char *opt;\n       opt = VEC_pop (const_char_p, ignored_options);\n-      error (\"unrecognized command line option \\\"%s\\\"\", opt);\n+      warning (0, \"unrecognized command line option \\\"%s\\\"\", opt);\n     }\n \n   input_location = saved_loc;\n@@ -513,9 +516,9 @@ handle_option (const char **argv, unsigned int lang_mask)\n       opt_index = find_opt (opt + 1, lang_mask | CL_COMMON | CL_TARGET);\n       if (opt_index == cl_options_count && opt[1] == 'W')\n \t{\n-\t  /* We don't generate errors for unknown -Wno-* options\n+\t  /* We don't generate warnings for unknown -Wno-* options\n              unless we issue diagnostics.  */\n-\t  postpone_unknown_option_error (argv[0]);\n+\t  postpone_unknown_option_warning (argv[0]);\n \t  result = 1;\n \t  goto done;\n \t}"}, {"sha": "89dd15390f872db213556f1c507e51e516b50df6", "filename": "gcc/testsuite/gcc.dg/pr28322-2.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15e1dac036941cf6f094ef8b4f11353d05968ac8/gcc%2Ftestsuite%2Fgcc.dg%2Fpr28322-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15e1dac036941cf6f094ef8b4f11353d05968ac8/gcc%2Ftestsuite%2Fgcc.dg%2Fpr28322-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr28322-2.c?ref=15e1dac036941cf6f094ef8b4f11353d05968ac8", "patch": "@@ -8,5 +8,5 @@ int foo (void)\n   return i;\n }\n \n-/* { dg-message \"unrecognized command line option .-Wno-foobar.\" \"\" { target *-*-* } 0 } */\n+/* { dg-warning \"unrecognized command line option .-Wno-foobar.\" \"\" { target *-*-* } 0 } */\n "}]}