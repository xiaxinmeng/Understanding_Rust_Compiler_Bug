{"sha": "535dd32006f8be5ef3e953f357d3e52510b05fc5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTM1ZGQzMjAwNmY4YmU1ZWYzZTk1M2YzNTdkM2U1MjUxMGIwNWZjNQ==", "commit": {"author": {"name": "Joseph Myers", "email": "jsm@polyomino.org.uk", "date": "2004-10-25T22:23:08Z"}, "committer": {"name": "Joseph Myers", "email": "jsm28@gcc.gnu.org", "date": "2004-10-25T22:23:08Z"}, "message": "re PR c/16667 (GCC allows invalid syntax in C99 designated initializers)\n\n\tPR c/16667\n\t* c-parse.in (array_designator): New.\n\t(designator): Use it.\n\t(initelt): Only permit array_designator without '=', not \".foo\".\n\ntestsuite:\n\t* gcc.dg/init-desig-obs-1.c, gcc.dg/init-desig-obs-2.c,\n\tgcc.dg/init-desig-obs-3.c: New tests.\n\nFrom-SVN: r89560", "tree": {"sha": "d85117008d821ebc849f31a386dc58b0e98b291e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d85117008d821ebc849f31a386dc58b0e98b291e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/535dd32006f8be5ef3e953f357d3e52510b05fc5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/535dd32006f8be5ef3e953f357d3e52510b05fc5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/535dd32006f8be5ef3e953f357d3e52510b05fc5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/535dd32006f8be5ef3e953f357d3e52510b05fc5/comments", "author": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "85c33455eaf3dc5cb7eb98fa740a7d6c3253e90b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85c33455eaf3dc5cb7eb98fa740a7d6c3253e90b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/85c33455eaf3dc5cb7eb98fa740a7d6c3253e90b"}], "stats": {"total": 61, "additions": 59, "deletions": 2}, "files": [{"sha": "001043dea99e764912eaf168fb1efbfb3aacb2ce", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/535dd32006f8be5ef3e953f357d3e52510b05fc5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/535dd32006f8be5ef3e953f357d3e52510b05fc5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=535dd32006f8be5ef3e953f357d3e52510b05fc5", "patch": "@@ -1,3 +1,10 @@\n+2004-10-25  Joseph S. Myers  <jsm@polyomino.org.uk>\n+\n+\tPR c/16667\n+\t* c-parse.in (array_designator): New.\n+\t(designator): Use it.\n+\t(initelt): Only permit array_designator without '=', not \".foo\".\n+\n 2004-10-25  Kenneth Zadeck <zadeck@naturalbridge.com>\n \t* gcc/Makefile.in: removed ggc for cgraphunit.\n \t* gcc/cgraph.c.dump_cgraph_node: removed static var analysis."}, {"sha": "7f6f4f491d7d8a8fb50f0699b6ed43518eb9553f", "filename": "gcc/c-parse.in", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/535dd32006f8be5ef3e953f357d3e52510b05fc5/gcc%2Fc-parse.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/535dd32006f8be5ef3e953f357d3e52510b05fc5/gcc%2Fc-parse.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-parse.in?ref=535dd32006f8be5ef3e953f357d3e52510b05fc5", "patch": "@@ -1445,7 +1445,7 @@ initelt:\n \t  designator_list '=' initval\n \t\t{ if (pedantic && !flag_isoc99)\n \t\t    pedwarn (\"ISO C90 forbids specifying subobject to initialize\"); }\n-\t| designator initval\n+\t| array_designator initval\n \t\t{ if (pedantic)\n \t\t    pedwarn (\"obsolete use of designated initializer without %<=%>\"); }\n \t| identifier ':'\n@@ -1475,7 +1475,10 @@ designator_list:\n designator:\n \t  '.' identifier\n \t\t{ set_init_label ($2); }\n-\t| '[' expr_no_commas ELLIPSIS expr_no_commas ']'\n+\t| array_designator\n+\n+array_designator:\n+\t  '[' expr_no_commas ELLIPSIS expr_no_commas ']'\n \t\t{ set_init_index ($2.value, $4.value);\n \t\t  if (pedantic)\n \t\t    pedwarn (\"ISO C forbids specifying range of elements to initialize\"); }"}, {"sha": "68b98b29c1590d9751f016195eea5ce0c68bd2b9", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/535dd32006f8be5ef3e953f357d3e52510b05fc5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/535dd32006f8be5ef3e953f357d3e52510b05fc5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=535dd32006f8be5ef3e953f357d3e52510b05fc5", "patch": "@@ -1,3 +1,9 @@\n+2004-10-25  Joseph S. Myers  <jsm@polyomino.org.uk>\n+\n+\tPR c/16667\n+\t* gcc.dg/init-desig-obs-1.c, gcc.dg/init-desig-obs-2.c,\n+\tgcc.dg/init-desig-obs-3.c: New tests.\n+\n 2004-10-25  Jakub Jelinek  <jakub@redhat.com>\n \n \t* gcc.dg/debug/20041023-1.c: New test."}, {"sha": "4a9df0482b8cc59f57db16a9df0dfb47b575cf95", "filename": "gcc/testsuite/gcc.dg/init-desig-obs-1.c", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/535dd32006f8be5ef3e953f357d3e52510b05fc5/gcc%2Ftestsuite%2Fgcc.dg%2Finit-desig-obs-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/535dd32006f8be5ef3e953f357d3e52510b05fc5/gcc%2Ftestsuite%2Fgcc.dg%2Finit-desig-obs-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Finit-desig-obs-1.c?ref=535dd32006f8be5ef3e953f357d3e52510b05fc5", "patch": "@@ -0,0 +1,19 @@\n+/* Test obsolete forms of designated initializers.  Test with default\n+   warning options: valid forms are accepted, while \".member\" without\n+   \"=\" should not be (bug 16667).  */\n+/* Origin: Joseph Myers <jsm@polyomino.org.uk> */\n+/* { dg-do compile } */\n+/* { dg-options \"\" } */\n+struct s { int a; };\n+struct s s0 = { .a = 1 };\n+struct s s1 = { a: 1 };\n+\n+int x0[] = { [0] = 1 };\n+int x1[] = { [0] 1 };\n+\n+/* Invalid syntax: multiple designators without \"=\".  */\n+int x2[2][2] = { [0][0] 1 }; /* { dg-error \"(syntax|parse) error\" } */\n+\n+\n+/* Invalid syntax: C99-style structure designator without \"=\".  */\n+struct s s2 = { .a 1 }; /* { dg-error \"(syntax|parse) error\" } */"}, {"sha": "04c3b1048e8061b334d3425a867071bedc4fd452", "filename": "gcc/testsuite/gcc.dg/init-desig-obs-2.c", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/535dd32006f8be5ef3e953f357d3e52510b05fc5/gcc%2Ftestsuite%2Fgcc.dg%2Finit-desig-obs-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/535dd32006f8be5ef3e953f357d3e52510b05fc5/gcc%2Ftestsuite%2Fgcc.dg%2Finit-desig-obs-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Finit-desig-obs-2.c?ref=535dd32006f8be5ef3e953f357d3e52510b05fc5", "patch": "@@ -0,0 +1,11 @@\n+/* Test obsolete forms of designated initializers.  Test with\n+   -pedantic.  */\n+/* Origin: Joseph Myers <jsm@polyomino.org.uk> */\n+/* { dg-do compile } */\n+/* { dg-options \"-std=gnu99 -pedantic\" } */\n+struct s { int a; };\n+struct s s0 = { .a = 1 };\n+struct s s1 = { a: 1 }; /* { dg-warning \"warning: obsolete use of designated initializer with ':'\" } */\n+\n+int x0[] = { [0] = 1 };\n+int x1[] = { [0] 1 }; /* { dg-warning \"warning: obsolete use of designated initializer without '='\" } */"}, {"sha": "9cc50ba33731fa56f2a703f684347ee197825af1", "filename": "gcc/testsuite/gcc.dg/init-desig-obs-3.c", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/535dd32006f8be5ef3e953f357d3e52510b05fc5/gcc%2Ftestsuite%2Fgcc.dg%2Finit-desig-obs-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/535dd32006f8be5ef3e953f357d3e52510b05fc5/gcc%2Ftestsuite%2Fgcc.dg%2Finit-desig-obs-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Finit-desig-obs-3.c?ref=535dd32006f8be5ef3e953f357d3e52510b05fc5", "patch": "@@ -0,0 +1,11 @@\n+/* Test obsolete forms of designated initializers.  Test with\n+   -pedantic-errors.  */\n+/* Origin: Joseph Myers <jsm@polyomino.org.uk> */\n+/* { dg-do compile } */\n+/* { dg-options \"-std=gnu99 -pedantic-errors\" } */\n+struct s { int a; };\n+struct s s0 = { .a = 1 };\n+struct s s1 = { a: 1 }; /* { dg-error \"error: obsolete use of designated initializer with ':'\" } */\n+\n+int x0[] = { [0] = 1 };\n+int x1[] = { [0] 1 }; /* { dg-error \"error: obsolete use of designated initializer without '='\" } */"}]}