{"sha": "4a1016814c2121920459d13ccb4c841b3a537951", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGExMDE2ODE0YzIxMjE5MjA0NTlkMTNjY2I0Yzg0MWIzYTUzNzk1MQ==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@net-b.de", "date": "2012-04-16T21:47:35Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2012-04-16T21:47:35Z"}, "message": "[multiple changes]\n\n2012-04-12  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/52864\n        * expr.c (gfc_check_vardef_context): Fix assignment check for\n        pointer components.\n\n2012-04-16  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/52864\n        * gfortran.dg/pointer_intent_6.f90: New.\n\nFrom-SVN: r186507", "tree": {"sha": "6f8f9a6dfa3ca63e08395668b8ea280c79920cb5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6f8f9a6dfa3ca63e08395668b8ea280c79920cb5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4a1016814c2121920459d13ccb4c841b3a537951", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4a1016814c2121920459d13ccb4c841b3a537951", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4a1016814c2121920459d13ccb4c841b3a537951", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4a1016814c2121920459d13ccb4c841b3a537951/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "de86e0a5d32fcaa2ec236f745fe7713cdedbaad4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/de86e0a5d32fcaa2ec236f745fe7713cdedbaad4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/de86e0a5d32fcaa2ec236f745fe7713cdedbaad4"}], "stats": {"total": 44, "additions": 40, "deletions": 4}, "files": [{"sha": "9793c8b57b0b356fbcff13797316f68a69d17da4", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4a1016814c2121920459d13ccb4c841b3a537951/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4a1016814c2121920459d13ccb4c841b3a537951/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=4a1016814c2121920459d13ccb4c841b3a537951", "patch": "@@ -1,3 +1,9 @@\n+2012-04-16  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/52864\n+\t* expr.c (gfc_check_vardef_context): Fix assignment check for\n+\tpointer components.\n+\n 2012-04-16  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/52968"}, {"sha": "d9614413e67eaacffa9511bb547381954132c2e9", "filename": "gcc/fortran/expr.c", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4a1016814c2121920459d13ccb4c841b3a537951/gcc%2Ffortran%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4a1016814c2121920459d13ccb4c841b3a537951/gcc%2Ffortran%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fexpr.c?ref=4a1016814c2121920459d13ccb4c841b3a537951", "patch": "@@ -4645,9 +4645,11 @@ gfc_check_vardef_context (gfc_expr* e, bool pointer, bool alloc_obj,\n       return FAILURE;\n     }\n \n-  /* INTENT(IN) dummy argument.  Check this, unless the object itself is\n-     the component of sub-component of a pointer.  Obviously,\n-     procedure pointers are of no interest here.  */\n+  /* INTENT(IN) dummy argument.  Check this, unless the object itself is the\n+     component of sub-component of a pointer; we need to distinguish\n+     assignment to a pointer component from pointer-assignment to a pointer\n+     component.  Note that (normal) assignment to procedure pointers is not\n+     possible.  */\n   check_intentin = true;\n   ptr_component = (sym->ts.type == BT_CLASS && CLASS_DATA (sym))\n \t\t  ? CLASS_DATA (sym)->attr.class_pointer : sym->attr.pointer;\n@@ -4656,7 +4658,11 @@ gfc_check_vardef_context (gfc_expr* e, bool pointer, bool alloc_obj,\n       if (ptr_component && ref->type == REF_COMPONENT)\n \tcheck_intentin = false;\n       if (ref->type == REF_COMPONENT && ref->u.c.component->attr.pointer)\n-\tptr_component = true;\n+\t{\n+\t  ptr_component = true;\n+\t  if (!pointer)\n+\t    check_intentin = false;\n+\t}\n     }\n   if (check_intentin && sym->attr.intent == INTENT_IN)\n     {"}, {"sha": "79a724ebb9c72aa5644db816232e0d468aa64fa8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4a1016814c2121920459d13ccb4c841b3a537951/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4a1016814c2121920459d13ccb4c841b3a537951/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4a1016814c2121920459d13ccb4c841b3a537951", "patch": "@@ -1,3 +1,8 @@\n+2012-04-16  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/52864\n+\t* gfortran.dg/pointer_intent_6.f90: New.\n+\n 2012-04-16  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/52916"}, {"sha": "56c7de5ebba47abf1d795e674303bc6ad1b2483a", "filename": "gcc/testsuite/gfortran.dg/pointer_intent_6.f90", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4a1016814c2121920459d13ccb4c841b3a537951/gcc%2Ftestsuite%2Fgfortran.dg%2Fpointer_intent_6.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4a1016814c2121920459d13ccb4c841b3a537951/gcc%2Ftestsuite%2Fgfortran.dg%2Fpointer_intent_6.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpointer_intent_6.f90?ref=4a1016814c2121920459d13ccb4c841b3a537951", "patch": "@@ -0,0 +1,19 @@\n+! { dg-do compile }\n+!\n+! PR fortran/52864\n+!\n+! Assigning to an intent(in) pointer (which is valid).\n+!\n+      program test\n+         type PoisFFT_Solver3D\n+           complex, dimension(:,:,:), &\n+                           pointer :: work => null()\n+         end type PoisFFT_Solver3D\n+      contains\n+        subroutine PoisFFT_Solver3D_FullPeriodic(D, p)\n+          type(PoisFFT_Solver3D), intent(in) :: D\n+          real, intent(in), pointer :: p(:)\n+          D%work(i,j,k) = 0.0\n+          p = 0.0\n+        end subroutine\n+      end"}]}