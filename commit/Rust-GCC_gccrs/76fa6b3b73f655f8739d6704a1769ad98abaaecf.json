{"sha": "76fa6b3b73f655f8739d6704a1769ad98abaaecf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzZmYTZiM2I3M2Y2NTVmODczOWQ2NzA0YTE3NjlhZDk4YWJhYWVjZg==", "commit": {"author": {"name": "Zack Weinberg", "email": "zack@wolery.cumb.org", "date": "2000-05-06T17:29:59Z"}, "committer": {"name": "Zack Weinberg", "email": "zack@gcc.gnu.org", "date": "2000-05-06T17:29:59Z"}, "message": "com.c (ffecom_overlap_): Set source_offset to bitsize_zero_node.\n\n\t* com.c (ffecom_overlap_): Set source_offset to\n\tbitsize_zero_node.\n\t(ffecom_tree_canonize_ptr_): Use size_binop.  Convert to\n\tbitsizetype before multiplying by TYPE_SIZE.\n\t(ffecom_tree_canonize_ref_) [case ARRAY_REF]: Break up offset\n\tcalculation.  Convert to bitsizetype before multiplying by\n\tTYPE_SIZE.\n\nFrom-SVN: r33730", "tree": {"sha": "48b84eb692491d6afc688da0f6de4f0619bc5fc4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/48b84eb692491d6afc688da0f6de4f0619bc5fc4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/76fa6b3b73f655f8739d6704a1769ad98abaaecf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/76fa6b3b73f655f8739d6704a1769ad98abaaecf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/76fa6b3b73f655f8739d6704a1769ad98abaaecf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/76fa6b3b73f655f8739d6704a1769ad98abaaecf/comments", "author": null, "committer": null, "parents": [{"sha": "ac670723c85b2516a260ab7c9a00f7d1489bcb11", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac670723c85b2516a260ab7c9a00f7d1489bcb11", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ac670723c85b2516a260ab7c9a00f7d1489bcb11"}], "stats": {"total": 41, "additions": 25, "deletions": 16}, "files": [{"sha": "5c95ba177e66774d923b830ddd2d9ce114c3fc44", "filename": "gcc/f/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/76fa6b3b73f655f8739d6704a1769ad98abaaecf/gcc%2Ff%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/76fa6b3b73f655f8739d6704a1769ad98abaaecf/gcc%2Ff%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ff%2FChangeLog?ref=76fa6b3b73f655f8739d6704a1769ad98abaaecf", "patch": "@@ -1,3 +1,13 @@\n+2000-05-06  Zack Weinberg  <zack@wolery.cumb.org>\n+\n+\t* com.c (ffecom_overlap_): Set source_offset to\n+\tbitsize_zero_node.\n+\t(ffecom_tree_canonize_ptr_): Use size_binop.  Convert to\n+\tbitsizetype before multiplying by TYPE_SIZE.\n+\t(ffecom_tree_canonize_ref_) [case ARRAY_REF]: Break up offset\n+\tcalculation.  Convert to bitsizetype before multiplying by\n+\tTYPE_SIZE.\n+\n 2000-04-18  Zack Weinberg  <zack@wolery.cumb.org>\n \n \t* lex.c: Remove references to cccp.c."}, {"sha": "d1ddd622dece189923c29db54692ccc3344497f6", "filename": "gcc/f/com.c", "status": "modified", "additions": 15, "deletions": 16, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/76fa6b3b73f655f8739d6704a1769ad98abaaecf/gcc%2Ff%2Fcom.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/76fa6b3b73f655f8739d6704a1769ad98abaaecf/gcc%2Ff%2Fcom.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ff%2Fcom.c?ref=76fa6b3b73f655f8739d6704a1769ad98abaaecf", "patch": "@@ -1712,7 +1712,7 @@ ffecom_overlap_ (tree dest_decl, tree dest_offset, tree dest_size,\n \treturn TRUE;\n \n       source_decl = source_tree;\n-      source_offset = size_zero_node;\n+      source_offset = bitsize_zero_node;\n       source_size = TYPE_SIZE (TREE_TYPE (TREE_TYPE (source_tree)));\n       break;\n \n@@ -9086,9 +9086,9 @@ ffecom_tree_canonize_ptr_ (tree *decl, tree *offset,\n \t\t\t\t *offset, TREE_OPERAND (t, 1)));\n \t  /* Convert offset (presumably in bytes) into canonical units\n \t     (presumably bits).  */\n-\t  *offset = fold (build (MULT_EXPR, TREE_TYPE (*offset),\n-\t\t\t\t TYPE_SIZE (TREE_TYPE (TREE_TYPE (t))),\n-\t\t\t\t *offset));\n+\t  *offset = size_binop (MULT_EXPR,\n+\t\t\t\tconvert (bitsizetype, *offset),\n+\t\t\t\tTYPE_SIZE (TREE_TYPE (TREE_TYPE (t))));\n \t  break;\n \t}\n       /* Not a COMMON reference, so an unrecognized pattern.  */\n@@ -9249,18 +9249,17 @@ ffecom_tree_canonize_ref_ (tree *decl, tree *offset,\n \t    || (*decl == error_mark_node))\n \t  return;\n \n-\t*offset\n-\t  = size_binop (MULT_EXPR,\n-\t\t\tTYPE_SIZE (TREE_TYPE (TREE_TYPE (array))),\n-\t\t\tconvert (sizetype,\n-\t\t\t\t fold (build (MINUS_EXPR, TREE_TYPE (element),\n-\t\t\t\t\t      element,\n-\t\t\t\t\t      TYPE_MIN_VALUE\n-\t\t\t\t\t      (TYPE_DOMAIN\n-\t\t\t\t\t       (TREE_TYPE (array)))))));;\n-\n-\t*offset = size_binop (PLUS_EXPR, convert (sizetype, init_offset),\n-\t\t\t      *offset);\n+\t/* Calculate ((element - base) * NBBY) + init_offset.  */\n+\t*offset = fold (build (MINUS_EXPR, TREE_TYPE (element),\n+\t\t\t       element,\n+\t\t\t       TYPE_MIN_VALUE (TYPE_DOMAIN\n+\t\t\t\t\t       (TREE_TYPE (array)))));\n+\n+\t*offset = size_binop (MULT_EXPR,\n+\t\t\t      convert (bitsizetype, *offset),\n+\t\t\t      TYPE_SIZE (TREE_TYPE (TREE_TYPE (array))));\n+\n+\t*offset = size_binop (PLUS_EXPR, init_offset, *offset);\n \n \t*size = TYPE_SIZE (TREE_TYPE (t));\n \treturn;"}]}