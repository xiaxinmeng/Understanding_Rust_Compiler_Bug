{"sha": "69fb98321197c0223455e69dbab1525637e46fc5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjlmYjk4MzIxMTk3YzAyMjM0NTVlNjlkYmFiMTUyNTYzN2U0NmZjNQ==", "commit": {"author": {"name": "Manuel L\u00f3pez-Ib\u00e1\u00f1ez", "email": "manu@gcc.gnu.org", "date": "2009-08-04T23:51:07Z"}, "committer": {"name": "Manuel L\u00f3pez-Ib\u00e1\u00f1ez", "email": "manu@gcc.gnu.org", "date": "2009-08-04T23:51:07Z"}, "message": "re PR c++/36069 (Strange \"warning: suggest parentheses around assignment used as truth value\" with volatile/non volatile bools)\n\n2009-08-05  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n\n\tPR c++/36069\ncp/\n\t* typeck.c (convert_for_assignment): Do not warn for any boolean\n\tvariant. Use explicit location.\ntestsuite/\n\t* g++.dg/warn/pr36069.C: New.\n\nFrom-SVN: r150471", "tree": {"sha": "87cf43e047f319f07a7a6834529d8e73431e3cc3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/87cf43e047f319f07a7a6834529d8e73431e3cc3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/69fb98321197c0223455e69dbab1525637e46fc5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/69fb98321197c0223455e69dbab1525637e46fc5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/69fb98321197c0223455e69dbab1525637e46fc5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/69fb98321197c0223455e69dbab1525637e46fc5/comments", "author": null, "committer": null, "parents": [{"sha": "f9fc1a02d7cadbbb9aba35776150929c9cb7dcb9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f9fc1a02d7cadbbb9aba35776150929c9cb7dcb9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f9fc1a02d7cadbbb9aba35776150929c9cb7dcb9"}], "stats": {"total": 36, "additions": 33, "deletions": 3}, "files": [{"sha": "3e86ab38763536f286008b90d99a88c2f4cfc82c", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/69fb98321197c0223455e69dbab1525637e46fc5/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/69fb98321197c0223455e69dbab1525637e46fc5/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=69fb98321197c0223455e69dbab1525637e46fc5", "patch": "@@ -1,3 +1,9 @@\n+2009-08-05  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n+\n+\tPR c++/36069\n+\t* typeck.c (convert_for_assignment): Do not warn for any boolean\n+\tvariant. Use explicit location.\n+\n 2009-08-04  Dodji Seketeli  <dodji@redhat.com>\n \n \tPR c++/39987"}, {"sha": "de42af409da04a1b8bee434be0cad85be49f6894", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/69fb98321197c0223455e69dbab1525637e46fc5/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/69fb98321197c0223455e69dbab1525637e46fc5/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=69fb98321197c0223455e69dbab1525637e46fc5", "patch": "@@ -6790,11 +6790,14 @@ convert_for_assignment (tree type, tree rhs,\n       && type == boolean_type_node\n       && TREE_CODE (rhs) == MODIFY_EXPR\n       && !TREE_NO_WARNING (rhs)\n-      && TREE_TYPE (rhs) != boolean_type_node\n+      && TREE_CODE (TREE_TYPE (rhs)) != BOOLEAN_TYPE\n       && (complain & tf_warning))\n     {\n-      warning (OPT_Wparentheses,\n-\t       \"suggest parentheses around assignment used as truth value\");\n+      location_t loc = EXPR_HAS_LOCATION (rhs) \n+\t? EXPR_LOCATION (rhs) : input_location;\n+\n+      warning_at (loc, OPT_Wparentheses,\n+\t\t  \"suggest parentheses around assignment used as truth value\");\n       TREE_NO_WARNING (rhs) = 1;\n     }\n "}, {"sha": "77238de44b5be8f9392b30ed727d163e3bb14b66", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/69fb98321197c0223455e69dbab1525637e46fc5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/69fb98321197c0223455e69dbab1525637e46fc5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=69fb98321197c0223455e69dbab1525637e46fc5", "patch": "@@ -1,3 +1,8 @@\n+2009-08-05  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n+\n+\tPR c++/36069\n+\t* g++.dg/warn/pr36069.C: New.\n+\n 2009-08-04  Dodji Seketeli  <dodji@redhat.com>\n \n \tPR c++/39987"}, {"sha": "efb35c25716ad21ece8d4597eda5b5dcad5bc6ec", "filename": "gcc/testsuite/g++.dg/warn/pr36069.C", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/69fb98321197c0223455e69dbab1525637e46fc5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fpr36069.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/69fb98321197c0223455e69dbab1525637e46fc5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fpr36069.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fpr36069.C?ref=69fb98321197c0223455e69dbab1525637e46fc5", "patch": "@@ -0,0 +1,16 @@\n+// PR c++/36069 Strange \"warning: suggest parentheses around\n+// assignment used as truth value\" with volatile/non volatile bools\n+// { dg-do compile }\n+// { dg-options \"-Wparentheses\" }\n+struct foo {\n+  bool a;\n+  volatile bool b,c;  \n+  foo() { a = b = c = false; } // { dg-bogus \"parentheses\" }\n+};\n+\n+int main() {\n+  bool a;\n+  volatile bool b,c;\n+  a = b = c = false; // { dg-bogus \"parentheses\" }\n+  foo A;\n+}"}]}