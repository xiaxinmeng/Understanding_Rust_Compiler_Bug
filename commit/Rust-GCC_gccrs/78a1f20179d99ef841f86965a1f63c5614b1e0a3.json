{"sha": "78a1f20179d99ef841f86965a1f63c5614b1e0a3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzhhMWYyMDE3OWQ5OWVmODQxZjg2OTY1YTFmNjNjNTYxNGIxZTBhMw==", "commit": {"author": {"name": "Danny Smith", "email": "dannysmith@users.sourceforge.net", "date": "2008-09-13T22:58:55Z"}, "committer": {"name": "Danny Smith", "email": "dannysmith@gcc.gnu.org", "date": "2008-09-13T22:58:55Z"}, "message": "cygming-crtend.c (register_frame_ctor): If DEFAULT_USE_CXA_ATEXIT, register __gcc_deregister_frame directly with atexit.\n\n\t* config/i386/cygming-crtend.c (register_frame_ctor): If\n\tDEFAULT_USE_CXA_ATEXIT, register __gcc_deregister_frame\n\tdirectly with atexit.\n\t(deregister_frame_ctor): Rename to ...\n\t(deregister_frame_dtor): Use to call __gcc_deregister_frame\n\tif !DEFAULT_USE_CXA_ATEXIT.\n\nFrom-SVN: r140351", "tree": {"sha": "494deedf5a3eb3c4359ea97b38e32e99bc48e78d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/494deedf5a3eb3c4359ea97b38e32e99bc48e78d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/78a1f20179d99ef841f86965a1f63c5614b1e0a3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/78a1f20179d99ef841f86965a1f63c5614b1e0a3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/78a1f20179d99ef841f86965a1f63c5614b1e0a3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/78a1f20179d99ef841f86965a1f63c5614b1e0a3/comments", "author": null, "committer": null, "parents": [{"sha": "a63f29427ba31d65547ee0b78e5ddf0dee1cd876", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a63f29427ba31d65547ee0b78e5ddf0dee1cd876", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a63f29427ba31d65547ee0b78e5ddf0dee1cd876"}], "stats": {"total": 22, "additions": 19, "deletions": 3}, "files": [{"sha": "af70b38b4c4c8eadbd4e76bd8cab076a17a74e8b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/78a1f20179d99ef841f86965a1f63c5614b1e0a3/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/78a1f20179d99ef841f86965a1f63c5614b1e0a3/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=78a1f20179d99ef841f86965a1f63c5614b1e0a3", "patch": "@@ -1,3 +1,12 @@\n+2008-09-14  Danny Smith  <dannysmith@users.sourceforge.net>\n+\n+\t* config/i386/cygming-crtend.c (register_frame_ctor): If\n+\tDEFAULT_USE_CXA_ATEXIT, register __gcc_deregister_frame\n+\tdirectly with atexit.\n+\t(deregister_frame_ctor): Rename to ...\n+\t(deregister_frame_dtor): Use to call __gcc_deregister_frame\n+\tif !DEFAULT_USE_CXA_ATEXIT.\n+\n 2008-09-13  Jan Hubicka  <jh@suse.cz>\n \n \t* cgraph.c: Include value-prof.h"}, {"sha": "e1f21c0e74e0ffd6462d08a647d073cf547ba314", "filename": "gcc/config/i386/cygming-crtend.c", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/78a1f20179d99ef841f86965a1f63c5614b1e0a3/gcc%2Fconfig%2Fi386%2Fcygming-crtend.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/78a1f20179d99ef841f86965a1f63c5614b1e0a3/gcc%2Fconfig%2Fi386%2Fcygming-crtend.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fcygming-crtend.c?ref=78a1f20179d99ef841f86965a1f63c5614b1e0a3", "patch": "@@ -74,13 +74,20 @@ static void\n register_frame_ctor (void)\n {\n   __gcc_register_frame ();\n+#if DEFAULT_USE_CXA_ATEXIT\n+  /* If we use the __cxa_atexit method to register C++ dtors\n+     at object construction,  also use atexit to register eh frame\n+     info cleanup.  */\n+  atexit (__gcc_deregister_frame);\n+#endif\n }\n \n-static void deregister_frame_ctor (void) __attribute__ ((destructor (0)));\n+#if !DEFAULT_USE_CXA_ATEXIT\n+static void deregister_frame_dtor (void) __attribute__ ((destructor (0)));\n \n static void\n-deregister_frame_ctor (void)\n+deregister_frame_dtor (void)\n {\n   __gcc_deregister_frame ();\n }\n-\n+#endif"}]}