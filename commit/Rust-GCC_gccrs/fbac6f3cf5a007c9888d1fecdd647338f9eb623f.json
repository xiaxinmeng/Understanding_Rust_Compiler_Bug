{"sha": "fbac6f3cf5a007c9888d1fecdd647338f9eb623f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmJhYzZmM2NmNWEwMDdjOTg4OGQxZmVjZGQ2NDczMzhmOWViNjIzZg==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2004-08-12T05:17:42Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2004-08-12T05:17:42Z"}, "message": "re PR c++/16698 (ICE with exceptions and declaration of __cxa_throw)\n\n\tPR c++/16698\n\t* except.c (build_throw): Allocate cleanup_type and the function\n\tfor __cxa_throw separately.\n\n\tPR c++/16698\n\t* g++.dg/eh/crash1.C: New test.\n\nFrom-SVN: r85850", "tree": {"sha": "22161d69312ee914b3ef780ef0a534744352e972", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/22161d69312ee914b3ef780ef0a534744352e972"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fbac6f3cf5a007c9888d1fecdd647338f9eb623f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fbac6f3cf5a007c9888d1fecdd647338f9eb623f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fbac6f3cf5a007c9888d1fecdd647338f9eb623f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fbac6f3cf5a007c9888d1fecdd647338f9eb623f/comments", "author": null, "committer": null, "parents": [{"sha": "174283a3c26828ee2bf0acd05f6350f439beefcc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/174283a3c26828ee2bf0acd05f6350f439beefcc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/174283a3c26828ee2bf0acd05f6350f439beefcc"}], "stats": {"total": 32, "additions": 22, "deletions": 10}, "files": [{"sha": "2bc5a854100f4060f17b483f66e33ff509db27d1", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fbac6f3cf5a007c9888d1fecdd647338f9eb623f/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fbac6f3cf5a007c9888d1fecdd647338f9eb623f/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=fbac6f3cf5a007c9888d1fecdd647338f9eb623f", "patch": "@@ -1,5 +1,9 @@\n 2004-08-11  Mark Mitchell  <mark@codesourcery.com>\n \n+\tPR c++/16698\n+\t* except.c (build_throw): Allocate cleanup_type and the function\n+\tfor __cxa_throw separately.\n+\n \tPR c++/16853\n \t* call.c (standard_conversion): Do not accept conversions between\n \tpointers to members if the class types are unrelated."}, {"sha": "b78cecd5d869bb854455a8384bb629226275183a", "filename": "gcc/cp/except.c", "status": "modified", "additions": 10, "deletions": 10, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fbac6f3cf5a007c9888d1fecdd647338f9eb623f/gcc%2Fcp%2Fexcept.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fbac6f3cf5a007c9888d1fecdd647338f9eb623f/gcc%2Fcp%2Fexcept.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fexcept.c?ref=fbac6f3cf5a007c9888d1fecdd647338f9eb623f", "patch": "@@ -611,18 +611,18 @@ build_throw (tree exp)\n       tree temp_expr, allocate_expr;\n       bool elided;\n \n+      /* The CLEANUP_TYPE is the internal type of a destructor.  */\n+      if (!cleanup_type)\n+\t{\n+\t  tmp = void_list_node;\n+\t  tmp = tree_cons (NULL_TREE, ptr_type_node, tmp);\n+\t  tmp = build_function_type (void_type_node, tmp);\n+\t  cleanup_type = build_pointer_type (tmp);\n+\t}\n+      \n       fn = get_identifier (\"__cxa_throw\");\n       if (!get_global_value_if_present (fn, &fn))\n \t{\n-\t  /* The CLEANUP_TYPE is the internal type of a destructor.  */\n-\t  if (cleanup_type == NULL_TREE)\n-\t    {\n-\t      tmp = void_list_node;\n-\t      tmp = tree_cons (NULL_TREE, ptr_type_node, tmp);\n-\t      tmp = build_function_type (void_type_node, tmp);\n-\t      cleanup_type = build_pointer_type (tmp);\n-\t    }\n-\n \t  /* Declare void __cxa_throw (void*, void*, void (*)(void*)).  */\n \t  /* ??? Second argument is supposed to be \"std::type_info*\".  */\n \t  tmp = void_list_node;\n@@ -632,7 +632,7 @@ build_throw (tree exp)\n \t  tmp = build_function_type (void_type_node, tmp);\n \t  fn = push_throw_library_fn (fn, tmp);\n \t}\n-\n+      \n       /* throw expression */\n       /* First, decay it.  */\n       exp = decay_conversion (exp);"}, {"sha": "93a6e56c99a39c22fe560f547a4672e2cfd21971", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fbac6f3cf5a007c9888d1fecdd647338f9eb623f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fbac6f3cf5a007c9888d1fecdd647338f9eb623f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=fbac6f3cf5a007c9888d1fecdd647338f9eb623f", "patch": "@@ -1,5 +1,8 @@\n 2004-08-11  Mark Mitchell  <mark@codesourcery.com>\n \n+\tPR c++/16698\n+\t* g++.dg/eh/crash1.C: New test.\n+\n \tPR c++/16717\n \t* g++.dg/ext/construct1.C: New test.\n "}, {"sha": "4cbcbd3ec1c5a52197b0725d8244dafad0370e37", "filename": "gcc/testsuite/g++.dg/eh/crash1.C", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fbac6f3cf5a007c9888d1fecdd647338f9eb623f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Feh%2Fcrash1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fbac6f3cf5a007c9888d1fecdd647338f9eb623f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Feh%2Fcrash1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Feh%2Fcrash1.C?ref=fbac6f3cf5a007c9888d1fecdd647338f9eb623f", "patch": "@@ -0,0 +1,5 @@\n+extern \"C\" void __cxa_throw (void *, void *,  void (*) (void *) ); \n+ \n+void foo(){ \n+  throw 1; \n+} "}]}