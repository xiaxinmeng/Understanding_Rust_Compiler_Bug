{"sha": "771a4552b63ede699c261d94c426451fad38793a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzcxYTQ1NTJiNjNlZGU2OTljMjYxZDk0YzQyNjQ1MWZhZDM4NzkzYQ==", "commit": {"author": {"name": "Christophe Lyon", "email": "christophe.lyon@linaro.org", "date": "2020-11-23T09:58:43Z"}, "committer": {"name": "Christophe Lyon", "email": "christophe.lyon@linaro.org", "date": "2020-11-23T09:59:23Z"}, "message": "testsuite/arm: add missing -mthumb to several tests\n\nSome tests force -mcpu=cortex-mXX but do not add -mthumb, causing\nerrors if GCC is not configured to default to Thumb code\n(--with-mode=thumb):\ncc1: error: target CPU does not support ARM mode\n\nThis patch adds -mthumb where relevant.\n\n2020-11-23  Christophe Lyon  <christophe.lyon@linaro.org>\n\n\tgcc/testsuite/\n\t* gcc.target/arm/cortex-m55-nodsp-flag-hard.c: Add -mthumb.\n\t* gcc.target/arm/cortex-m55-nodsp-flag-softfp.c: Likewise.\n\t* gcc.target/arm/cortex-m55-nodsp-nofp-flag-softfp.c: Likewise.\n\t* gcc.target/arm/cortex-m55-nofp-flag-hard.c: Likewise.\n\t* gcc.target/arm/cortex-m55-nofp-flag-softfp.c: Likewise.\n\t* gcc.target/arm/cortex-m55-nofp-nomve-flag-softfp.c: Likewise.\n\t* gcc.target/arm/cortex-m55-nomve-flag-hard.c: Likewise.\n\t* gcc.target/arm/cortex-m55-nomve-flag-softfp.c: Likewise.\n\t* gcc.target/arm/cortex-m55-nomve.fp-flag-hard.c: Likewise.\n\t* gcc.target/arm/cortex-m55-nomve.fp-flag-softfp.c: Likewise.\n\t* gcc.target/arm/mve/intrinsics/pr97327.c: Likewise.", "tree": {"sha": "417e0213354f5b6d6d70f2d7d3aece5a4cc5bacf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/417e0213354f5b6d6d70f2d7d3aece5a4cc5bacf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/771a4552b63ede699c261d94c426451fad38793a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/771a4552b63ede699c261d94c426451fad38793a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/771a4552b63ede699c261d94c426451fad38793a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/771a4552b63ede699c261d94c426451fad38793a/comments", "author": null, "committer": null, "parents": [{"sha": "d3585f5d0df47ffa453f5fe436fdf588301e5314", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d3585f5d0df47ffa453f5fe436fdf588301e5314", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d3585f5d0df47ffa453f5fe436fdf588301e5314"}], "stats": {"total": 22, "additions": 11, "deletions": 11}, "files": [{"sha": "92c15112ae7a29761e104190bf4076bc42544451", "filename": "gcc/testsuite/gcc.target/arm/cortex-m55-nodsp-flag-hard.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nodsp-flag-hard.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nodsp-flag-hard.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nodsp-flag-hard.c?ref=771a4552b63ede699c261d94c426451fad38793a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do assemble } */\n /* { dg-require-effective-target arm_v8_1m_mve_fp_ok } */\n-/* { dg-additional-options \"-mcpu=cortex-m55+nodsp -mfloat-abi=hard -mfpu=auto --save-temps\" } */\n+/* { dg-additional-options \"-mcpu=cortex-m55+nodsp -mthumb -mfloat-abi=hard -mfpu=auto --save-temps\" } */\n /* { dg-final { scan-assembler \"\\.arch_extension fp\" } } */\n /* { dg-final { scan-assembler \"\\.arch_extension fp.dp\" } } */\n /* { dg-final { scan-assembler-not \"\\.arch_extension dsp\" } } */"}, {"sha": "89d778f8ecbf8817b332d25791b7bdb65431743e", "filename": "gcc/testsuite/gcc.target/arm/cortex-m55-nodsp-flag-softfp.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nodsp-flag-softfp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nodsp-flag-softfp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nodsp-flag-softfp.c?ref=771a4552b63ede699c261d94c426451fad38793a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do assemble } */\n /* { dg-require-effective-target arm_v8_1m_mve_fp_ok } */\n-/* { dg-additional-options \"-mcpu=cortex-m55+nodsp -mfloat-abi=softfp -mfpu=auto --save-temps\" } */\n+/* { dg-additional-options \"-mcpu=cortex-m55+nodsp -mthumb -mfloat-abi=softfp -mfpu=auto --save-temps\" } */\n /* { dg-final { scan-assembler \"\\.arch_extension fp\" } } */\n /* { dg-final { scan-assembler \"\\.arch_extension fp.dp\" } } */\n /* { dg-final { scan-assembler-not \"\\.arch_extension dsp\" } } */"}, {"sha": "405090ca9e9bdf586f44a860830e9e7d112471c9", "filename": "gcc/testsuite/gcc.target/arm/cortex-m55-nodsp-nofp-flag-softfp.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nodsp-nofp-flag-softfp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nodsp-nofp-flag-softfp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nodsp-nofp-flag-softfp.c?ref=771a4552b63ede699c261d94c426451fad38793a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do assemble } */\n /* { dg-require-effective-target arm_v8_1m_mve_fp_ok } */\n-/* { dg-additional-options \"-mcpu=cortex-m55+nodsp+nofp -mfloat-abi=softfp -mfpu=auto --save-temps\" } */\n+/* { dg-additional-options \"-mcpu=cortex-m55+nodsp+nofp -mthumb -mfloat-abi=softfp -mfpu=auto --save-temps\" } */\n /* { dg-final { scan-assembler-not \"\\.arch_extension fp\" } } */\n /* { dg-final { scan-assembler-not \"\\.arch_extension fp.dp\" } } */\n /* { dg-final { scan-assembler-not \"\\.arch_extension dsp\" } } */"}, {"sha": "6a92dedcc59326c179b5fa4ba3a7f4787dadb908", "filename": "gcc/testsuite/gcc.target/arm/cortex-m55-nofp-flag-hard.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nofp-flag-hard.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nofp-flag-hard.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nofp-flag-hard.c?ref=771a4552b63ede699c261d94c426451fad38793a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do assemble } */\n /* { dg-require-effective-target arm_v8_1m_mve_fp_ok } */\n-/* { dg-additional-options \"-mcpu=cortex-m55+nofp -mfloat-abi=hard -mfpu=auto --save-temps\" } */\n+/* { dg-additional-options \"-mcpu=cortex-m55+nofp -mthumb -mfloat-abi=hard -mfpu=auto --save-temps\" } */\n /* { dg-final { scan-assembler \"\\.arch_extension mve\" } } */\n /* { dg-final { scan-assembler \"\\.arch_extension dsp\" } } */\n /* { dg-final { scan-assembler-not \"\\.arch_extension fp\" } } */"}, {"sha": "25e80e9bd64a63dde1baf84b91d9ed1d9e19122d", "filename": "gcc/testsuite/gcc.target/arm/cortex-m55-nofp-flag-softfp.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nofp-flag-softfp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nofp-flag-softfp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nofp-flag-softfp.c?ref=771a4552b63ede699c261d94c426451fad38793a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do assemble } */\n /* { dg-require-effective-target arm_v8_1m_mve_fp_ok } */\n-/* { dg-additional-options \"-mcpu=cortex-m55+nofp -mfloat-abi=softfp -mfpu=auto --save-temps\" } */\n+/* { dg-additional-options \"-mcpu=cortex-m55+nofp -mthumb -mfloat-abi=softfp -mfpu=auto --save-temps\" } */\n /* { dg-final { scan-assembler \"\\.arch_extension mve\" } } */\n /* { dg-final { scan-assembler \"\\.arch_extension dsp\" } } */\n /* { dg-final { scan-assembler-not \"\\.arch_extension fp\" } } */"}, {"sha": "38042cc490ccf85dab9b066e1f28888d43e61c5c", "filename": "gcc/testsuite/gcc.target/arm/cortex-m55-nofp-nomve-flag-softfp.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nofp-nomve-flag-softfp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nofp-nomve-flag-softfp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nofp-nomve-flag-softfp.c?ref=771a4552b63ede699c261d94c426451fad38793a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do assemble } */\n /* { dg-require-effective-target arm_v8_1m_mve_fp_ok } */\n-/* { dg-additional-options \"-mcpu=cortex-m55+nomve+nofp -mfloat-abi=softfp -mfpu=auto --save-temps\" } */\n+/* { dg-additional-options \"-mcpu=cortex-m55+nomve+nofp -mthumb -mfloat-abi=softfp -mfpu=auto --save-temps\" } */\n /* { dg-final { scan-assembler-not \"\\.arch_extension mve\" } } */\n /* { dg-final { scan-assembler-not \"\\.arch_extension mve.fp\" } } */\n /* { dg-final { scan-assembler-not \"\\.arch_extension fp\" } } */"}, {"sha": "2366e99ad24d9043ed8ebf58e3c198fb4456d4bf", "filename": "gcc/testsuite/gcc.target/arm/cortex-m55-nomve-flag-hard.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nomve-flag-hard.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nomve-flag-hard.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nomve-flag-hard.c?ref=771a4552b63ede699c261d94c426451fad38793a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do assemble } */\n /* { dg-require-effective-target arm_v8_1m_mve_fp_ok } */\n-/* { dg-additional-options \"-mcpu=cortex-m55+nomve -mfloat-abi=hard -mfpu=auto --save-temps\" } */\n+/* { dg-additional-options \"-mcpu=cortex-m55+nomve -mthumb -mfloat-abi=hard -mfpu=auto --save-temps\" } */\n /* { dg-final { scan-assembler-not \"\\.arch_extension mve\" } } */\n /* { dg-final { scan-assembler \"\\.arch_extension dsp\" } } */\n /* { dg-final { scan-assembler \"\\.arch_extension fp\" } } */"}, {"sha": "eb2d63d32910fa60400d17b56f9693226e740dcb", "filename": "gcc/testsuite/gcc.target/arm/cortex-m55-nomve-flag-softfp.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nomve-flag-softfp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nomve-flag-softfp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nomve-flag-softfp.c?ref=771a4552b63ede699c261d94c426451fad38793a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do assemble } */\n /* { dg-require-effective-target arm_v8_1m_mve_fp_ok } */\n-/* { dg-additional-options \"-mcpu=cortex-m55+nomve -mfloat-abi=softfp -mfpu=auto --save-temps\" } */\n+/* { dg-additional-options \"-mcpu=cortex-m55+nomve -mthumb -mfloat-abi=softfp -mfpu=auto --save-temps\" } */\n /* { dg-final { scan-assembler-not \"\\.arch_extension mve\" } } */\n /* { dg-final { scan-assembler \"\\.arch_extension dsp\" } } */\n /* { dg-final { scan-assembler \"\\.arch_extension fp\" } } */"}, {"sha": "e7e57d986caab96f69ce2fd302dae3f163cbd56e", "filename": "gcc/testsuite/gcc.target/arm/cortex-m55-nomve.fp-flag-hard.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nomve.fp-flag-hard.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nomve.fp-flag-hard.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nomve.fp-flag-hard.c?ref=771a4552b63ede699c261d94c426451fad38793a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do assemble } */\n /* { dg-require-effective-target arm_v8_1m_mve_fp_ok } */\n-/* { dg-additional-options \"-mcpu=cortex-m55+nomve.fp -mfloat-abi=hard -mfpu=auto --save-temps\" } */\n+/* { dg-additional-options \"-mcpu=cortex-m55+nomve.fp -mthumb -mfloat-abi=hard -mfpu=auto --save-temps\" } */\n /* { dg-final { scan-assembler-not \"\\.arch_extension mve.fp\" } } */\n /* { dg-final { scan-assembler \"\\.arch_extension mve\" } } */\n /* { dg-final { scan-assembler \"\\.arch_extension dsp\" } } */"}, {"sha": "42889aad4a3ae1a468ab1d030c13c0b2e8a2850d", "filename": "gcc/testsuite/gcc.target/arm/cortex-m55-nomve.fp-flag-softfp.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nomve.fp-flag-softfp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nomve.fp-flag-softfp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcortex-m55-nomve.fp-flag-softfp.c?ref=771a4552b63ede699c261d94c426451fad38793a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do assemble } */\n /* { dg-require-effective-target arm_v8_1m_mve_fp_ok } */\n-/* { dg-additional-options \"-mcpu=cortex-m55+nomve.fp -mfloat-abi=softfp -mfpu=auto --save-temps\" } */\n+/* { dg-additional-options \"-mcpu=cortex-m55+nomve.fp -mthumb -mfloat-abi=softfp -mfpu=auto --save-temps\" } */\n /* { dg-final { scan-assembler-not \"\\.arch_extension mve.fp\" } } */\n /* { dg-final { scan-assembler \"\\.arch_extension mve\" } } */\n /* { dg-final { scan-assembler \"\\.arch_extension dsp\" } } */"}, {"sha": "d19bde59266355426a17500fbc58f43d25adb4e2", "filename": "gcc/testsuite/gcc.target/arm/mve/intrinsics/pr97327.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmve%2Fintrinsics%2Fpr97327.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/771a4552b63ede699c261d94c426451fad38793a/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmve%2Fintrinsics%2Fpr97327.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmve%2Fintrinsics%2Fpr97327.c?ref=771a4552b63ede699c261d94c426451fad38793a", "patch": "@@ -1,6 +1,6 @@\n /* { dg-require-effective-target arm_v8_1m_mve_fp_ok } */\n /* { dg-skip-if \"Incompatible float ABI\" { *-*-* } { \"-mfloat-abi=hard\" } { \"\" } } */\n-/* { dg-additional-options \"-mcpu=cortex-m55 -mfloat-abi=soft -mfpu=auto -Werror\" } */\n+/* { dg-additional-options \"-mcpu=cortex-m55 -mthumb -mfloat-abi=soft -mfpu=auto -Werror\" } */\n \n int main ()\n {"}]}