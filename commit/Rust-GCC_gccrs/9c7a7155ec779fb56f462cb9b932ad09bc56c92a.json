{"sha": "9c7a7155ec779fb56f462cb9b932ad09bc56c92a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWM3YTcxNTVlYzc3OWZiNTZmNDYyY2I5YjkzMmFkMDliYzU2YzkyYQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2018-11-28T20:34:06Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2018-11-28T20:34:06Z"}, "message": "tree-ssa-ifcombine.c (update_profile_after_ifcombine): Handle profile_probability::always better.\n\n\n\t* tree-ssa-ifcombine.c (update_profile_after_ifcombine): Handle\n\tprofile_probability::always better.\n\nFrom-SVN: r266585", "tree": {"sha": "bc57de7d1314bd8ef95aa30587f08d683a5e6512", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bc57de7d1314bd8ef95aa30587f08d683a5e6512"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9c7a7155ec779fb56f462cb9b932ad09bc56c92a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9c7a7155ec779fb56f462cb9b932ad09bc56c92a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9c7a7155ec779fb56f462cb9b932ad09bc56c92a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9c7a7155ec779fb56f462cb9b932ad09bc56c92a/comments", "author": null, "committer": null, "parents": [{"sha": "f0dbeec7c506407aa7e02cc2df82057ea40ab457", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f0dbeec7c506407aa7e02cc2df82057ea40ab457", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f0dbeec7c506407aa7e02cc2df82057ea40ab457"}], "stats": {"total": 16, "additions": 14, "deletions": 2}, "files": [{"sha": "bc49105e219f5107452ce4c842a16299b411a0c3", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9c7a7155ec779fb56f462cb9b932ad09bc56c92a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9c7a7155ec779fb56f462cb9b932ad09bc56c92a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9c7a7155ec779fb56f462cb9b932ad09bc56c92a", "patch": "@@ -1,3 +1,8 @@\n+2018-11-28  Jan Hubicka  <jh@suse.cz>\n+\n+\t* tree-ssa-ifcombine.c (update_profile_after_ifcombine): Handle\n+\tprofile_probability::always better.\n+\n 2018-11-28  Jan Hubicka  <jh@suse.cz>\n \n \t* profile-count.h (profile_count::split): Give better result when"}, {"sha": "2b969378d6506ece0f640b05cd15894f5fb4b406", "filename": "gcc/tree-ssa-ifcombine.c", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9c7a7155ec779fb56f462cb9b932ad09bc56c92a/gcc%2Ftree-ssa-ifcombine.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9c7a7155ec779fb56f462cb9b932ad09bc56c92a/gcc%2Ftree-ssa-ifcombine.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-ifcombine.c?ref=9c7a7155ec779fb56f462cb9b932ad09bc56c92a", "patch": "@@ -360,8 +360,15 @@ update_profile_after_ifcombine (basic_block inner_cond_bb,\n \n   inner_cond_bb->count = outer_cond_bb->count;\n \n-  inner_taken->probability = outer2->probability + outer_to_inner->probability\n-\t\t\t     * inner_taken->probability;\n+  /* Handle special case where inner_taken probability is always. In this case\n+     we know that the overall outcome will be always as well, but combining\n+     probabilities will be conservative because it does not know that\n+     outer2->probability is inverse of outer_to_inner->probability.  */\n+  if (inner_taken->probability == profile_probability::always ())\n+    ;\n+  else\n+    inner_taken->probability = outer2->probability + outer_to_inner->probability\n+\t\t\t       * inner_taken->probability;\n   inner_not_taken->probability = profile_probability::always ()\n \t\t\t\t - inner_taken->probability;\n "}]}