{"sha": "88e18bd5cc520a945793b5cae2561ad3a70633f6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODhlMThiZDVjYzUyMGE5NDU3OTNiNWNhZTI1NjFhZDNhNzA2MzNmNg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2014-01-17T14:45:34Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2014-01-17T14:45:34Z"}, "message": "i386.c (ix86_data_alignment): For compatibility with (incorrect) GCC 4.8 and earlier alignment assumptions...\n\n\t* config/i386/i386.c (ix86_data_alignment): For compatibility with\n\t(incorrect) GCC 4.8 and earlier alignment assumptions ensure we align\n\tdecls to at least the GCC 4.8 used alignments.\n\nFrom-SVN: r206713", "tree": {"sha": "778cb6f38e21d2902007986b0d7a7c949dca5586", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/778cb6f38e21d2902007986b0d7a7c949dca5586"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/88e18bd5cc520a945793b5cae2561ad3a70633f6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88e18bd5cc520a945793b5cae2561ad3a70633f6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/88e18bd5cc520a945793b5cae2561ad3a70633f6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88e18bd5cc520a945793b5cae2561ad3a70633f6/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "cc2b0e50e02c9425a5102972cd79d5ff79e838e9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cc2b0e50e02c9425a5102972cd79d5ff79e838e9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cc2b0e50e02c9425a5102972cd79d5ff79e838e9"}], "stats": {"total": 29, "additions": 24, "deletions": 5}, "files": [{"sha": "5440d4493f3f2a6bc1cbc1c5d6c1a30228cc297a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88e18bd5cc520a945793b5cae2561ad3a70633f6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88e18bd5cc520a945793b5cae2561ad3a70633f6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=88e18bd5cc520a945793b5cae2561ad3a70633f6", "patch": "@@ -1,5 +1,9 @@\n 2014-01-17  Jakub Jelinek  <jakub@redhat.com>\n \n+\t* config/i386/i386.c (ix86_data_alignment): For compatibility with\n+\t(incorrect) GCC 4.8 and earlier alignment assumptions ensure we align\n+\tdecls to at least the GCC 4.8 used alignments.\n+\n \tPR fortran/59440\n \t* tree-nested.c (convert_nonlocal_reference_stmt,\n \tconvert_local_reference_stmt): For NAMELIST_DECLs in gimple_bind_vars"}, {"sha": "d3e4d5f654c8a2e9129fb34a9fba5b478488523d", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 20, "deletions": 5, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88e18bd5cc520a945793b5cae2561ad3a70633f6/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88e18bd5cc520a945793b5cae2561ad3a70633f6/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=88e18bd5cc520a945793b5cae2561ad3a70633f6", "patch": "@@ -26433,6 +26433,15 @@ ix86_constant_alignment (tree exp, int align)\n int\n ix86_data_alignment (tree type, int align, bool opt)\n {\n+  /* GCC 4.8 and earlier used to incorrectly assume this alignment even\n+     for symbols from other compilation units or symbols that don't need\n+     to bind locally.  In order to preserve some ABI compatibility with\n+     those compilers, ensure we don't decrease alignment from what we\n+     used to assume.  */\n+\n+  int max_align_compat\n+    = optimize_size ? BITS_PER_WORD : MIN (256, MAX_OFILE_ALIGNMENT);\n+\n   /* A data structure, equal or greater than the size of a cache line\n      (64 bytes in the Pentium 4 and other recent Intel processors, including\n      processors based on Intel Core microarchitecture) should be aligned\n@@ -26447,11 +26456,17 @@ ix86_data_alignment (tree type, int align, bool opt)\n   if (opt\n       && AGGREGATE_TYPE_P (type)\n       && TYPE_SIZE (type)\n-      && TREE_CODE (TYPE_SIZE (type)) == INTEGER_CST\n-      && (TREE_INT_CST_LOW (TYPE_SIZE (type)) >= (unsigned) max_align\n-\t  || TREE_INT_CST_HIGH (TYPE_SIZE (type)))\n-      && align < max_align)\n-    align = max_align;\n+      && TREE_CODE (TYPE_SIZE (type)) == INTEGER_CST)\n+    {\n+      if ((TREE_INT_CST_LOW (TYPE_SIZE (type)) >= (unsigned) max_align_compat\n+\t   || TREE_INT_CST_HIGH (TYPE_SIZE (type)))\n+\t  && align < max_align_compat)\n+\talign = max_align_compat;\n+      if ((TREE_INT_CST_LOW (TYPE_SIZE (type)) >= (unsigned) max_align\n+\t   || TREE_INT_CST_HIGH (TYPE_SIZE (type)))\n+\t  && align < max_align)\n+\talign = max_align;\n+    }\n \n   /* x86-64 ABI requires arrays greater than 16 bytes to be aligned\n      to 16byte boundary.  */"}]}