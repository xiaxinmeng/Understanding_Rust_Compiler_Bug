{"sha": "122d6c36552fd516efee6e57e68103ec693a9ff5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTIyZDZjMzY1NTJmZDUxNmVmZWU2ZTU3ZTY4MTAzZWM2OTNhOWZmNQ==", "commit": {"author": {"name": "Aaron Sawdey", "email": "acsawdey@linux.ibm.com", "date": "2018-11-02T17:02:38Z"}, "committer": {"name": "Aaron Sawdey", "email": "acsawdey@gcc.gnu.org", "date": "2018-11-02T17:02:38Z"}, "message": "rs6000-string.c (expand_strncmp_gpr_sequence): Pay attention to TARGET_AVOID_XFORM and BYTES_BIG_ENDIAN.\n\n2018-11-02  Aaron Sawdey  <acsawdey@linux.ibm.com>\n\n\t* config/rs6000/rs6000-string.c (expand_strncmp_gpr_sequence): Pay\n\tattention to TARGET_AVOID_XFORM and BYTES_BIG_ENDIAN.\n\nFrom-SVN: r265751", "tree": {"sha": "192ddf6b5071d1d838097bd8fbf3f980904a6fbf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/192ddf6b5071d1d838097bd8fbf3f980904a6fbf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/122d6c36552fd516efee6e57e68103ec693a9ff5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/122d6c36552fd516efee6e57e68103ec693a9ff5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/122d6c36552fd516efee6e57e68103ec693a9ff5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/122d6c36552fd516efee6e57e68103ec693a9ff5/comments", "author": {"login": "acsawdey", "id": 41373646, "node_id": "MDQ6VXNlcjQxMzczNjQ2", "avatar_url": "https://avatars.githubusercontent.com/u/41373646?v=4", "gravatar_id": "", "url": "https://api.github.com/users/acsawdey", "html_url": "https://github.com/acsawdey", "followers_url": "https://api.github.com/users/acsawdey/followers", "following_url": "https://api.github.com/users/acsawdey/following{/other_user}", "gists_url": "https://api.github.com/users/acsawdey/gists{/gist_id}", "starred_url": "https://api.github.com/users/acsawdey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/acsawdey/subscriptions", "organizations_url": "https://api.github.com/users/acsawdey/orgs", "repos_url": "https://api.github.com/users/acsawdey/repos", "events_url": "https://api.github.com/users/acsawdey/events{/privacy}", "received_events_url": "https://api.github.com/users/acsawdey/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5f7dbaa0adbe5148029177b198ae3dc26e1ff257", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f7dbaa0adbe5148029177b198ae3dc26e1ff257", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5f7dbaa0adbe5148029177b198ae3dc26e1ff257"}], "stats": {"total": 21, "additions": 16, "deletions": 5}, "files": [{"sha": "5cf291da2d5ec19773157f1657d53ccc9810b276", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/122d6c36552fd516efee6e57e68103ec693a9ff5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/122d6c36552fd516efee6e57e68103ec693a9ff5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=122d6c36552fd516efee6e57e68103ec693a9ff5", "patch": "@@ -1,3 +1,8 @@\n+2018-11-02  Aaron Sawdey  <acsawdey@linux.ibm.com>\n+\n+\t* config/rs6000/rs6000-string.c (expand_strncmp_gpr_sequence): Pay\n+\tattention to TARGET_AVOID_XFORM and BYTES_BIG_ENDIAN.\n+\n 2018-11-02  Richard Earnshaw  <rearnsha@arm.com>\n \n \t* config/aarch64/aarch64.c ((aarch64_override_options): Disable"}, {"sha": "22fe966d5729d2f294688e295224e0baad79f362", "filename": "gcc/config/rs6000/rs6000-string.c", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/122d6c36552fd516efee6e57e68103ec693a9ff5/gcc%2Fconfig%2Frs6000%2Frs6000-string.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/122d6c36552fd516efee6e57e68103ec693a9ff5/gcc%2Fconfig%2Frs6000%2Frs6000-string.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000-string.c?ref=122d6c36552fd516efee6e57e68103ec693a9ff5", "patch": "@@ -1798,12 +1798,18 @@ expand_strncmp_gpr_sequence (unsigned HOST_WIDE_INT bytes_to_compare,\n \t   rid of the extra bytes.  */\n \tcmp_bytes = bytes_to_compare;\n \n-      rtx offset_reg = gen_reg_rtx (Pmode);\n-      emit_move_insn (offset_reg, GEN_INT (offset));\n-\n-      rtx addr1 = gen_rtx_PLUS (Pmode, src1_addr, offset_reg);\n+      rtx offset_rtx;\n+      if (BYTES_BIG_ENDIAN || TARGET_AVOID_XFORM)\n+\toffset_rtx = GEN_INT (offset);\n+      else\n+\t{\n+\t  offset_rtx = gen_reg_rtx (Pmode);\n+\t  emit_move_insn (offset_rtx, GEN_INT (offset));\n+\t}\n+      rtx addr1 = gen_rtx_PLUS (Pmode, src1_addr, offset_rtx);\n+      rtx addr2 = gen_rtx_PLUS (Pmode, src2_addr, offset_rtx);\n+\t  \n       do_load_for_compare_from_addr (load_mode, tmp_reg_src1, addr1, orig_src1);\n-      rtx addr2 = gen_rtx_PLUS (Pmode, src2_addr, offset_reg);\n       do_load_for_compare_from_addr (load_mode, tmp_reg_src2, addr2, orig_src2);\n \n       /* We must always left-align the data we read, and"}]}