{"sha": "3017937417e39615cb08ed5f4f106f8969bcf691", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzAxNzkzNzQxN2UzOTYxNWNiMDhlZDVmNGYxMDZmODk2OWJjZjY5MQ==", "commit": {"author": {"name": "Robert Dewar", "email": "dewar@adacore.com", "date": "2008-04-08T06:56:20Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2008-04-08T06:56:20Z"}, "message": "stylesw.adb: Implement -gnaty + - y options\n\n2008-04-08  Robert Dewar  <dewar@adacore.com>\n\n\t* stylesw.adb: Implement -gnaty + - y options\n\t(Set_GNAT_Style_Check_Options): Includ I in style check string\n\n\t* stylesw.ads: Add comments for new style switch options\n\nFrom-SVN: r134055", "tree": {"sha": "62d6b606bf60997a81d50f9571f896bfeab89386", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/62d6b606bf60997a81d50f9571f896bfeab89386"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3017937417e39615cb08ed5f4f106f8969bcf691", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3017937417e39615cb08ed5f4f106f8969bcf691", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3017937417e39615cb08ed5f4f106f8969bcf691", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3017937417e39615cb08ed5f4f106f8969bcf691/comments", "author": null, "committer": null, "parents": [{"sha": "57238335539655345a06f3d557fb2a8e1c08be25", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57238335539655345a06f3d557fb2a8e1c08be25", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57238335539655345a06f3d557fb2a8e1c08be25"}], "stats": {"total": 147, "additions": 134, "deletions": 13}, "files": [{"sha": "a037528c0bca435b3d8c89b46073c03d9495d4e8", "filename": "gcc/ada/stylesw.adb", "status": "modified", "additions": 130, "deletions": 10, "changes": 140, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3017937417e39615cb08ed5f4f106f8969bcf691/gcc%2Fada%2Fstylesw.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3017937417e39615cb08ed5f4f106f8969bcf691/gcc%2Fada%2Fstylesw.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fstylesw.adb?ref=3017937417e39615cb08ed5f4f106f8969bcf691", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 1992-2007, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2008, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -168,7 +168,7 @@ package body Stylesw is\n    procedure Set_GNAT_Style_Check_Options is\n    begin\n       Reset_Style_Check_Options;\n-      Set_Style_Check_Options (\"3aAbcdefhiklmnprsStux\");\n+      Set_Style_Check_Options (\"3aAbcdefhiIklmnprsStux\");\n    end Set_GNAT_Style_Check_Options;\n \n    -----------------------------\n@@ -195,6 +195,13 @@ package body Stylesw is\n    is\n       C : Character;\n \n+      On : Boolean := True;\n+      --  Set to False if minus encountered\n+      --  Set to True if plus encountered\n+\n+      Last_Option : Character := ' ';\n+      --  Set to last character encountered\n+\n       procedure Add_Img (N : Natural);\n       --  Concatenates image of N at end of Style_Msg_Buf\n \n@@ -234,10 +241,21 @@ package body Stylesw is\n       Err_Col := Options'First;\n       while Err_Col <= Options'Last loop\n          C := Options (Err_Col);\n+         Last_Option := C;\n          Err_Col := Err_Col + 1;\n \n-         case C is\n-            when '1' .. '9' =>\n+         --  Turning switches on\n+\n+         if On then\n+            case C is\n+\n+            when '+' =>\n+               null;\n+\n+            when '-' =>\n+               On := False;\n+\n+            when '0' .. '9' =>\n                Style_Check_Indentation :=\n                  Character'Pos (C) - Character'Pos ('0');\n \n@@ -373,20 +391,122 @@ package body Stylesw is\n             when 'x' =>\n                Style_Check_Xtra_Parens           := True;\n \n+            when 'y' =>\n+               Set_Default_Style_Check_Options;\n+\n+            when ' ' =>\n+               null;\n+\n+            when others =>\n+               Err_Col := Err_Col - 1;\n+               Bad_Style_Switch (\"invalid style switch: \" & C);\n+               return;\n+            end case;\n+\n+         --  Turning switches off\n+\n+         else\n+            case C is\n+\n+            when '+' =>\n+               On := True;\n+\n+            when '-' =>\n+               null;\n+\n+            when '0' .. '9' =>\n+               Style_Check_Indentation := 0;\n+\n+            when 'a' =>\n+               Style_Check_Attribute_Casing      := False;\n+\n+            when 'A' =>\n+               Style_Check_Array_Attribute_Index := False;\n+\n+            when 'b' =>\n+               Style_Check_Blanks_At_End         := False;\n+\n+            when 'c' =>\n+               Style_Check_Comments              := False;\n+\n+            when 'd' =>\n+               Style_Check_DOS_Line_Terminator   := False;\n+\n+            when 'e' =>\n+               Style_Check_End_Labels            := False;\n+\n+            when 'f' =>\n+               Style_Check_Form_Feeds            := False;\n+\n+            when 'g' =>\n+               Reset_Style_Check_Options;\n+\n+            when 'h' =>\n+               Style_Check_Horizontal_Tabs       := False;\n+\n+            when 'i' =>\n+               Style_Check_If_Then_Layout        := False;\n+\n+            when 'I' =>\n+               Style_Check_Mode_In               := False;\n+\n+            when 'k' =>\n+               Style_Check_Keyword_Casing        := False;\n+\n+            when 'l' =>\n+               Style_Check_Layout                := False;\n+\n+            when 'L' =>\n+               Style_Max_Nesting_Level := 0;\n+\n+            when 'm' =>\n+               Style_Check_Max_Line_Length       := False;\n+\n+            when 'M' =>\n+               Style_Max_Line_Length             := 0;\n+               Style_Check_Max_Line_Length       := False;\n+\n+            when 'n' =>\n+               Style_Check_Standard              := False;\n+\n+            when 'o' =>\n+               Style_Check_Order_Subprograms     := False;\n+\n+            when 'p' =>\n+               Style_Check_Pragma_Casing         := False;\n+\n+            when 'r' =>\n+               Style_Check_References            := False;\n+\n+            when 's' =>\n+               Style_Check_Specs                 := False;\n+\n+            when 'S' =>\n+               Style_Check_Separate_Stmt_Lines   := False;\n+\n+            when 't' =>\n+               Style_Check_Tokens                := False;\n+\n+            when 'u' =>\n+               Style_Check_Blank_Lines           := False;\n+\n+            when 'x' =>\n+               Style_Check_Xtra_Parens           := False;\n+\n             when ' ' =>\n                null;\n \n             when others =>\n                Err_Col := Err_Col - 1;\n-               Style_Msg_Buf (1 .. 22) := \"invalid style switch: \";\n-               Style_Msg_Len := 23;\n-               Style_Msg_Buf (Style_Msg_Len) := C;\n-               OK := False;\n+               Bad_Style_Switch (\"invalid style switch: \" & C);\n                return;\n-         end case;\n+            end case;\n+         end if;\n       end loop;\n \n-      Style_Check := True;\n+      --  Turn on style checking if other than N at end of string\n+\n+      Style_Check := (Last_Option /= 'N');\n       OK := True;\n    end Set_Style_Check_Options;\n end Stylesw;"}, {"sha": "27c92d5fd2ba1e8a27d8c498166654f2f742e434", "filename": "gcc/ada/stylesw.ads", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3017937417e39615cb08ed5f4f106f8969bcf691/gcc%2Fada%2Fstylesw.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3017937417e39615cb08ed5f4f106f8969bcf691/gcc%2Fada%2Fstylesw.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fstylesw.ads?ref=3017937417e39615cb08ed5f4f106f8969bcf691", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 1992-2007, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2008, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -269,7 +269,7 @@ package Stylesw is\n \n    procedure Set_Default_Style_Check_Options;\n    --  This procedure is called to set the default style checking options in\n-   --  response to a -gnaty switch with no suboptions.\n+   --  response to a -gnaty switch with no suboptions or from -gnatyy.\n \n    procedure Set_GNAT_Style_Check_Options;\n    --  This procedure is called to set the default style checking options for\n@@ -286,7 +286,8 @@ package Stylesw is\n    --  This procedure is called to set the style check options that correspond\n    --  to the characters in the given Options string. If all options are valid,\n    --  they are set in an additive manner: any previous options are retained\n-   --  unless overridden.\n+   --  unless overridden, unless a minus is encountered, and then subsequent\n+   --  style switches are subtracted from the current set.\n    --\n    --  If all options given are valid, then OK is True, Err_Col is set to\n    --  Options'Last + 1, and Style_Msg_Buf/Style_Msg_Len are unchanged."}]}