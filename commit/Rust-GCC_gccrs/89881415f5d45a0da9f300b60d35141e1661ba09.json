{"sha": "89881415f5d45a0da9f300b60d35141e1661ba09", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODk4ODE0MTVmNWQ0NWEwZGE5ZjMwMGI2MGQzNTE0MWUxNjYxYmEwOQ==", "commit": {"author": {"name": "Tom Wood", "email": "wood@gnu.org", "date": "1992-11-20T20:37:05Z"}, "committer": {"name": "Tom Wood", "email": "wood@gnu.org", "date": "1992-11-20T20:37:05Z"}, "message": "(final): When producing SDB debugging info...\n\n(final): When producing SDB debugging info, delete line\n\tnumber notes from inlined functions in other files as well as\n\tduplicate line number notes.\n\nFrom-SVN: r2763", "tree": {"sha": "1eda3e1ee14c0812ce17f962362978da165d7068", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1eda3e1ee14c0812ce17f962362978da165d7068"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/89881415f5d45a0da9f300b60d35141e1661ba09", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/89881415f5d45a0da9f300b60d35141e1661ba09", "html_url": "https://github.com/Rust-GCC/gccrs/commit/89881415f5d45a0da9f300b60d35141e1661ba09", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/89881415f5d45a0da9f300b60d35141e1661ba09/comments", "author": null, "committer": null, "parents": [{"sha": "3daf3cadb0d501cc3f0a63449e0d76e662b8fc63", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3daf3cadb0d501cc3f0a63449e0d76e662b8fc63", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3daf3cadb0d501cc3f0a63449e0d76e662b8fc63"}], "stats": {"total": 37, "additions": 33, "deletions": 4}, "files": [{"sha": "7c3a61b36ac73222be25ab66f096016a6f3acb27", "filename": "gcc/final.c", "status": "modified", "additions": 33, "deletions": 4, "changes": 37, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89881415f5d45a0da9f300b60d35141e1661ba09/gcc%2Ffinal.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89881415f5d45a0da9f300b60d35141e1661ba09/gcc%2Ffinal.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffinal.c?ref=89881415f5d45a0da9f300b60d35141e1661ba09", "patch": "@@ -902,10 +902,39 @@ final (first, file, optimize, prescan)\n   last_ignored_compare = 0;\n   new_block = 1;\n \n-  /* Make a map indicating which line numbers appear in this function.  */\n-  for (insn = first; insn; insn = NEXT_INSN (insn))\n-    if (GET_CODE (insn) == NOTE && NOTE_LINE_NUMBER (insn) > max_line)\n-      max_line = NOTE_LINE_NUMBER (insn);\n+  /* Make a map indicating which line numbers appear in this function.\n+     When producing SDB debugging info, delete troublesome line number\n+     notes from inlined functions in other files as well as duplicate\n+     line number notes.  */\n+#ifdef SDB_DEBUGGING_INFO\n+  if (write_symbols == SDB_DEBUG)\n+    {\n+      rtx last = 0;\n+      for (insn = first; insn; insn = NEXT_INSN (insn))\n+\tif (GET_CODE (insn) == NOTE && NOTE_LINE_NUMBER (insn) > 0)\n+\t  {\n+\t    if ((RTX_INTEGRATED_P (insn)\n+\t\t && strcmp (NOTE_SOURCE_FILE (insn), main_input_filename) != 0)\n+\t\t || (last != 0\n+\t\t     && NOTE_LINE_NUMBER (insn) == NOTE_LINE_NUMBER (last)\n+\t\t     && NOTE_SOURCE_FILE (insn) == NOTE_SOURCE_FILE (last)))\n+\t      {\n+\t\tNOTE_LINE_NUMBER (insn) = NOTE_INSN_DELETED;\n+\t\tNOTE_SOURCE_FILE (insn) = 0;\n+\t\tcontinue;\n+\t      }\n+\t    last = insn;\n+\t    if (NOTE_LINE_NUMBER (insn) > max_line)\n+\t      max_line = NOTE_LINE_NUMBER (insn);\n+\t  }\n+    }\n+  else\n+#endif\n+    {\n+      for (insn = first; insn; insn = NEXT_INSN (insn))\n+\tif (GET_CODE (insn) == NOTE && NOTE_LINE_NUMBER (insn) > max_line)\n+\t  max_line = NOTE_LINE_NUMBER (insn);\n+    }\n \n   line_note_exists = (char *) oballoc (max_line + 1);\n   bzero (line_note_exists, max_line + 1);"}]}