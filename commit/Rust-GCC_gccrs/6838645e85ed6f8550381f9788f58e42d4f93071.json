{"sha": "6838645e85ed6f8550381f9788f58e42d4f93071", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjgzODY0NWU4NWVkNmY4NTUwMzgxZjk3ODhmNThlNDJkNGY5MzA3MQ==", "commit": {"author": {"name": "Andreas Tobler", "email": "a.tobler@schweiz.ch", "date": "2004-01-07T18:46:04Z"}, "committer": {"name": "Andreas Tobler", "email": "andreast@gcc.gnu.org", "date": "2004-01-07T18:46:04Z"}, "message": "jartool.c (make_manifest): Fix off-by-one bug when creating an empty MANIFEST.MF.\n\n2004-01-07  Andreas Tobler  <a.tobler@schweiz.ch>\n\n        * jartool.c (make_manifest): Fix off-by-one bug when creating\n        an empty MANIFEST.MF.\n\nFrom-SVN: r75511", "tree": {"sha": "dbb91a8ea2814c973aca1fc43777f0df2ce0c7a7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/dbb91a8ea2814c973aca1fc43777f0df2ce0c7a7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6838645e85ed6f8550381f9788f58e42d4f93071", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6838645e85ed6f8550381f9788f58e42d4f93071", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6838645e85ed6f8550381f9788f58e42d4f93071", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6838645e85ed6f8550381f9788f58e42d4f93071/comments", "author": null, "committer": null, "parents": [{"sha": "9b773289f883bc57491f8254e7ece335ae948f7e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9b773289f883bc57491f8254e7ece335ae948f7e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9b773289f883bc57491f8254e7ece335ae948f7e"}], "stats": {"total": 15, "additions": 13, "deletions": 2}, "files": [{"sha": "898d7330626fa8082bfc0f9938891257081f2b77", "filename": "fastjar/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6838645e85ed6f8550381f9788f58e42d4f93071/fastjar%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6838645e85ed6f8550381f9788f58e42d4f93071/fastjar%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fastjar%2FChangeLog?ref=6838645e85ed6f8550381f9788f58e42d4f93071", "patch": "@@ -1,3 +1,8 @@\n+2004-01-07  Andreas Tobler  <a.tobler@schweiz.ch>\n+\n+\t* jartool.c (make_manifest): Fix off-by-one bug when creating\n+\tan empty MANIFEST.MF.\n+\n 2003-12-01  Kelley Cook  <kcook@gcc.gnu.org>\n \n \t* Makefile.am: Define AM_MAKINFOFLAGS.  Remove Automake 1.4 hack."}, {"sha": "59e71767f8dbeabf7fa26ed3438c9cd4ad023be9", "filename": "fastjar/jartool.c", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6838645e85ed6f8550381f9788f58e42d4f93071/fastjar%2Fjartool.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6838645e85ed6f8550381f9788f58e42d4f93071/fastjar%2Fjartool.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fastjar%2Fjartool.c?ref=6838645e85ed6f8550381f9788f58e42d4f93071", "patch": "@@ -313,6 +313,11 @@ int number_of_entries; /* number of entries in the linked list */\n /* This holds all options.  */\n #define OPTION_STRING \"-ctxuvVf:m:C:0ME@\"\n \n+/* Define the MANIFEST content here to have it easier with calculations\n+   below.  This is for the case we create an empty MANIFEST.MF.  */\n+#define MANIFEST_STR \"Manifest-Version: 1.0\\nCreated-By: \"\n+#define MANIFEST_END \"\\n\\n\"\n+\n static const struct option options[] =\n {\n   { \"help\", no_argument, NULL, OPT_HELP },\n@@ -732,13 +737,14 @@ int make_manifest(int jfd, const char *mf_name){\n \n   /* if the user didn't specify an external manifest file... */\n   if(mf_name == NULL){\n-    int mf_len = 37 + strlen(VERSION);\n+    \n+    int mf_len = strlen(MANIFEST_STR) + strlen(VERSION) + strlen(MANIFEST_END);\n     char *mf;\n \n     if((mf = (char *) malloc(mf_len + 1))) {\n     uLong crc;\n \n-    sprintf(mf, \"Manifest-Version: 1.0\\nCreated-By: %s\\n\\n\", VERSION);\n+    sprintf(mf, \"%s%s%s\", MANIFEST_STR, VERSION, MANIFEST_END);\n \n     crc = crc32(0L, Z_NULL, 0);\n     "}]}