{"sha": "2e89be4857edfbbcfcca261079c868d70341feb1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmU4OWJlNDg1N2VkZmJiY2ZjY2EyNjEwNzljODY4ZDcwMzQxZmViMQ==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@linaro.org", "date": "2017-09-21T11:06:48Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2017-09-21T11:06:48Z"}, "message": "Fix unguarded uses of tree_to_uhwi\n\nThis patch uses tree_fits_uhwi_p to protect a previously unguarded\nuse of tree_to_uhwi.  Previously we would ICE for variable-sized types.\n\n2017-09-20  Richard Sandiford  <richard.sandiford@linaro.org>\n\t    Alan Hayward  <alan.hayward@arm.com>\n\t    David Sherwood  <david.sherwood@arm.com>\n\ngcc/\n\t* tree.c (find_atomic_core_type): Check tree_fits_uhwi_p before\n\tcalling tree_to_uhwi.\n\nCo-Authored-By: Alan Hayward <alan.hayward@arm.com>\nCo-Authored-By: David Sherwood <david.sherwood@arm.com>\n\nFrom-SVN: r253057", "tree": {"sha": "ee231ccdf565d1f70e11d3f988284a4572f8f0ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ee231ccdf565d1f70e11d3f988284a4572f8f0ff"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2e89be4857edfbbcfcca261079c868d70341feb1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e89be4857edfbbcfcca261079c868d70341feb1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2e89be4857edfbbcfcca261079c868d70341feb1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e89be4857edfbbcfcca261079c868d70341feb1/comments", "author": null, "committer": null, "parents": [{"sha": "4a77e8874709d7848e4216c59089ccce756f228e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4a77e8874709d7848e4216c59089ccce756f228e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4a77e8874709d7848e4216c59089ccce756f228e"}], "stats": {"total": 12, "additions": 9, "deletions": 3}, "files": [{"sha": "a8d78c7ad58aeda897e17efe01c851281bdc2b55", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e89be4857edfbbcfcca261079c868d70341feb1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e89be4857edfbbcfcca261079c868d70341feb1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2e89be4857edfbbcfcca261079c868d70341feb1", "patch": "@@ -1,3 +1,10 @@\n+2017-09-21  Richard Sandiford  <richard.sandiford@linaro.org>\n+\t    Alan Hayward  <alan.hayward@arm.com>\n+\t    David Sherwood  <david.sherwood@arm.com>\n+\n+\t* tree.c (find_atomic_core_type): Check tree_fits_uhwi_p before\n+\tcalling tree_to_uhwi.\n+\n 2017-09-21  Richard Sandiford  <richard.sandiford@linaro.org>\n \t    Alan Hayward  <alan.hayward@arm.com>\n \t    David Sherwood  <david.sherwood@arm.com>"}, {"sha": "e379940f35d34996c29b28a400c8fd5f63cff634", "filename": "gcc/tree.c", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2e89be4857edfbbcfcca261079c868d70341feb1/gcc%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2e89be4857edfbbcfcca261079c868d70341feb1/gcc%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.c?ref=2e89be4857edfbbcfcca261079c868d70341feb1", "patch": "@@ -5821,11 +5821,10 @@ find_atomic_core_type (tree type)\n   tree base_atomic_type;\n \n   /* Only handle complete types.  */\n-  if (TYPE_SIZE (type) == NULL_TREE)\n+  if (!tree_fits_uhwi_p (TYPE_SIZE (type)))\n     return NULL_TREE;\n \n-  HOST_WIDE_INT type_size = tree_to_uhwi (TYPE_SIZE (type));\n-  switch (type_size)\n+  switch (tree_to_uhwi (TYPE_SIZE (type)))\n     {\n     case 8:\n       base_atomic_type = atomicQI_type_node;"}]}