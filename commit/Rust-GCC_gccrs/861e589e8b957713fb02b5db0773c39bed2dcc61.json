{"sha": "861e589e8b957713fb02b5db0773c39bed2dcc61", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODYxZTU4OWU4Yjk1NzcxM2ZiMDJiNWRiMDc3M2MzOWJlZDJkY2M2MQ==", "commit": {"author": {"name": "Ed Schonberg", "email": "schonberg@adacore.com", "date": "2018-05-24T13:05:49Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2018-05-24T13:05:49Z"}, "message": "[Ada] Add warning on redundant others_clause in array aggregate\n\nThis patch adds a warning on a redundant others_clause in an array aggregate\nwhen all index positions are already specified in previous positional or named\nassociations. The warning is emitted when Warn_On_Redundant_Constructs is\nenabled.\n\n2018-05-24  Ed Schonberg  <schonberg@adacore.com>\n\ngcc/ada/\n\n\t* exp_aggr.adb (Flatten): Add a warning on an others clause in an array\n\taggregate with static bounds when named associations cover all index\n\tpositions and the others clause is redundant.\n\ngcc/testsuite/\n\n\t* gnat.dg/others1.adb: New testcase.\n\nFrom-SVN: r260657", "tree": {"sha": "c70a303f0872fe365859f4ad242d0978dd905b84", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c70a303f0872fe365859f4ad242d0978dd905b84"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/861e589e8b957713fb02b5db0773c39bed2dcc61", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/861e589e8b957713fb02b5db0773c39bed2dcc61", "html_url": "https://github.com/Rust-GCC/gccrs/commit/861e589e8b957713fb02b5db0773c39bed2dcc61", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/861e589e8b957713fb02b5db0773c39bed2dcc61/comments", "author": {"login": "Edschonberg", "id": 6352375, "node_id": "MDQ6VXNlcjYzNTIzNzU=", "avatar_url": "https://avatars.githubusercontent.com/u/6352375?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Edschonberg", "html_url": "https://github.com/Edschonberg", "followers_url": "https://api.github.com/users/Edschonberg/followers", "following_url": "https://api.github.com/users/Edschonberg/following{/other_user}", "gists_url": "https://api.github.com/users/Edschonberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/Edschonberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Edschonberg/subscriptions", "organizations_url": "https://api.github.com/users/Edschonberg/orgs", "repos_url": "https://api.github.com/users/Edschonberg/repos", "events_url": "https://api.github.com/users/Edschonberg/events{/privacy}", "received_events_url": "https://api.github.com/users/Edschonberg/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0347c01b136f864830d1ec9e8d9f1da0cb8029f7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0347c01b136f864830d1ec9e8d9f1da0cb8029f7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0347c01b136f864830d1ec9e8d9f1da0cb8029f7"}], "stats": {"total": 29, "additions": 29, "deletions": 0}, "files": [{"sha": "2e809767de061b1cbb916c36d51251db49a0624d", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/861e589e8b957713fb02b5db0773c39bed2dcc61/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/861e589e8b957713fb02b5db0773c39bed2dcc61/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=861e589e8b957713fb02b5db0773c39bed2dcc61", "patch": "@@ -1,3 +1,9 @@\n+2018-05-24  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* exp_aggr.adb (Flatten): Add a warning on an others clause in an array\n+\taggregate with static bounds when named associations cover all index\n+\tpositions and the others clause is redundant.\n+\n 2018-05-24  Raphael Amiard  <amiard@adacore.com>\n \n \t* libgnat/a-cohama.ads: Add documentation."}, {"sha": "81d35533b18e072b49a0e358cf39443a6ba13c20", "filename": "gcc/ada/exp_aggr.adb", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/861e589e8b957713fb02b5db0773c39bed2dcc61/gcc%2Fada%2Fexp_aggr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/861e589e8b957713fb02b5db0773c39bed2dcc61/gcc%2Fada%2Fexp_aggr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_aggr.adb?ref=861e589e8b957713fb02b5db0773c39bed2dcc61", "patch": "@@ -4581,6 +4581,12 @@ package body Exp_Aggr is\n                         end if;\n                      end loop;\n \n+                     if Rep_Count = 0\n+                       and then Warn_On_Redundant_Constructs\n+                     then\n+                        Error_Msg_N (\"there are no others?r?\", Elmt);\n+                     end if;\n+\n                      exit Component_Loop;\n \n                   --  Case of a subtype mark, identifier or expanded name"}, {"sha": "6ab715740b38b79265e0648d3106e034178fa8e0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/861e589e8b957713fb02b5db0773c39bed2dcc61/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/861e589e8b957713fb02b5db0773c39bed2dcc61/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=861e589e8b957713fb02b5db0773c39bed2dcc61", "patch": "@@ -1,3 +1,7 @@\n+2018-05-24  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* gnat.dg/others1.adb: New testcase.\n+\n 2018-05-24  Justin Squirek  <squirek@adacore.com>\n \n \t* gnat.dg/raise_expr.adb: New testcase."}, {"sha": "59393fa00fff478e321ad293f07a8c550c0b898a", "filename": "gcc/testsuite/gnat.dg/others1.adb", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/861e589e8b957713fb02b5db0773c39bed2dcc61/gcc%2Ftestsuite%2Fgnat.dg%2Fothers1.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/861e589e8b957713fb02b5db0773c39bed2dcc61/gcc%2Ftestsuite%2Fgnat.dg%2Fothers1.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fothers1.adb?ref=861e589e8b957713fb02b5db0773c39bed2dcc61", "patch": "@@ -0,0 +1,13 @@\n+--  { dg-do compile }\n+--  { dg-options \"-gnatwr\" }\n+\n+procedure Others1 is\n+   type Ar is Array (1..10) of Natural;\n+   function five return integer is (5);\n+   THing : Ar;\n+begin\n+   Thing := (1..5 => 22, 6 ..10 => 111, others => Five); --  { dg-warning \"there are no others\" }\n+   if Thing (1) /= thing (5) then\n+      raise Program_Error;\n+   end if;\n+end;"}]}