{"sha": "bae420fcdb5715f37cb519f898152d8c4a6c394d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmFlNDIwZmNkYjU3MTVmMzdjYjUxOWY4OTgxNTJkOGM0YTZjMzk0ZA==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2015-01-23T03:37:30Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2015-01-23T03:37:30Z"}, "message": "re PR fortran/61933 (Inquire on internal units)\n\n2015-01-22  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n\n\tPR fortran/61933\n\t* gfortran.dg/make_unit.f90: New test.\n\nFrom-SVN: r220026", "tree": {"sha": "83241f0136b66605d743ffdb091e1f7bf6f7321e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/83241f0136b66605d743ffdb091e1f7bf6f7321e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bae420fcdb5715f37cb519f898152d8c4a6c394d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bae420fcdb5715f37cb519f898152d8c4a6c394d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bae420fcdb5715f37cb519f898152d8c4a6c394d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bae420fcdb5715f37cb519f898152d8c4a6c394d/comments", "author": null, "committer": null, "parents": [{"sha": "20056f6002a17c609321d27ecfa6c52fe73e77a1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/20056f6002a17c609321d27ecfa6c52fe73e77a1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/20056f6002a17c609321d27ecfa6c52fe73e77a1"}], "stats": {"total": 39, "additions": 39, "deletions": 0}, "files": [{"sha": "92076857cddfb400af92e02c7feb632b1a5adee8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bae420fcdb5715f37cb519f898152d8c4a6c394d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bae420fcdb5715f37cb519f898152d8c4a6c394d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bae420fcdb5715f37cb519f898152d8c4a6c394d", "patch": "@@ -1,3 +1,8 @@\n+2015-01-22  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\tPR fortran/61933\n+\t* gfortran.dg/make_unit.f90: New test.\n+\n 2015-01-22  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR fortran/61933"}, {"sha": "ffeb5f1b2d0b107ef1395d30d0d4a89d6e3c9604", "filename": "gcc/testsuite/gfortran.dg/make_unit.f90", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bae420fcdb5715f37cb519f898152d8c4a6c394d/gcc%2Ftestsuite%2Fgfortran.dg%2Fmake_unit.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bae420fcdb5715f37cb519f898152d8c4a6c394d/gcc%2Ftestsuite%2Fgfortran.dg%2Fmake_unit.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fmake_unit.f90?ref=bae420fcdb5715f37cb519f898152d8c4a6c394d", "patch": "@@ -0,0 +1,34 @@\n+! { dg-do run }\n+! PR61933, useing inquire to get available units.\n+program makeunit\n+integer  :: ic, istat, nc\n+logical  :: exists, is_open\n+\n+if (get_unit_number(\"foo0.dat\") .ne. 10) call abort\n+if (get_unit_number(\"foo1.dat\") .ne. 11) call abort\n+if (get_unit_number(\"foo2.dat\") .ne. 12) call abort\n+if (get_unit_number(\"foo3.dat\") .ne. 13) call abort\n+\n+close(unit=12, status=\"delete\")\n+if (get_unit_number(\"foo2.dat\") .ne. 12) call abort()\n+close(unit=10, status=\"delete\")\n+close(unit=11, status=\"delete\")\n+close(unit=12, status=\"delete\")\n+close(unit=13, status=\"delete\")\n+\n+contains\n+  function get_unit_number(file_name) result(unit_number)\n+    character(len=*), intent(in), optional   :: file_name\n+    integer                                  :: unit_number\n+    ! get a new unit number\n+    do unit_number=10,100\n+       inquire (unit=unit_number,exist=exists,opened=is_open,iostat=istat)\n+       if (exists.and.(.not.is_open).and.(istat == 0)) then\n+           open(unit=unit_number, file=file_name)\n+           return\n+       endif\n+    end do\n+    unit_number = -1\n+  end function get_unit_number\n+\n+end program makeunit"}]}