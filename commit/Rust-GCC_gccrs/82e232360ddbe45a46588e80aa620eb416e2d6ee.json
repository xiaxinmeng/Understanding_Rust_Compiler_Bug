{"sha": "82e232360ddbe45a46588e80aa620eb416e2d6ee", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODJlMjMyMzYwZGRiZTQ1YTQ2NTg4ZTgwYWE2MjBlYjQxNmUyZDZlZQ==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2001-03-22T06:48:32Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2001-03-22T06:48:32Z"}, "message": "ltconfig, [...]: Upgraded to libtool 1.4a 1.641.2.198.\n\n* ltconfig, ltmain.sh, libtool.m4, ltcf-c.sh, ltcf-cxx.sh,\nltcf-gcj.sh: Upgraded to libtool 1.4a 1.641.2.198.\n\nFrom-SVN: r40731", "tree": {"sha": "263e2343daebef64f5353d3bc54ae4ea676f67bf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/263e2343daebef64f5353d3bc54ae4ea676f67bf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/82e232360ddbe45a46588e80aa620eb416e2d6ee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82e232360ddbe45a46588e80aa620eb416e2d6ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/82e232360ddbe45a46588e80aa620eb416e2d6ee", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82e232360ddbe45a46588e80aa620eb416e2d6ee/comments", "author": null, "committer": null, "parents": [{"sha": "595420bfea88f5c0117e887cf70345a61f26e893", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/595420bfea88f5c0117e887cf70345a61f26e893", "html_url": "https://github.com/Rust-GCC/gccrs/commit/595420bfea88f5c0117e887cf70345a61f26e893"}], "stats": {"total": 1790, "additions": 1182, "deletions": 608}, "files": [{"sha": "25f1ff54720f47c2a0b0d75d8d0959ee83c2651e", "filename": "ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82e232360ddbe45a46588e80aa620eb416e2d6ee/ChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82e232360ddbe45a46588e80aa620eb416e2d6ee/ChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ChangeLog?ref=82e232360ddbe45a46588e80aa620eb416e2d6ee", "patch": "@@ -1,3 +1,8 @@\n+2001-03-22  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\t* ltconfig, ltmain.sh, libtool.m4, ltcf-c.sh, ltcf-cxx.sh,\n+\tltcf-gcj.sh: Upgraded to libtool 1.4a 1.641.2.198.\n+\n 2001-03-19  Tom Tromey  <tromey@redhat.com>\n \n \t* config-ml.in: Handle GCJ and GCJFLAGS."}, {"sha": "324676aab3f11abcf7d3bd51ea61f47dbaf3d908", "filename": "libtool.m4", "status": "modified", "additions": 114, "deletions": 109, "changes": 223, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82e232360ddbe45a46588e80aa620eb416e2d6ee/libtool.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82e232360ddbe45a46588e80aa620eb416e2d6ee/libtool.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libtool.m4?ref=82e232360ddbe45a46588e80aa620eb416e2d6ee", "patch": "@@ -22,8 +22,9 @@\n ## configuration script generated by Autoconf, you may include it under\n ## the same distribution terms that you use for the rest of that program.\n \n-# serial 45 AC_PROG_LIBTOOL\n-AC_DEFUN(AC_PROG_LIBTOOL,[AC_REQUIRE([_AC_PROG_LIBTOOL])\n+# serial 46 AC_PROG_LIBTOOL\n+AC_DEFUN([AC_PROG_LIBTOOL],\n+[AC_REQUIRE([_AC_PROG_LIBTOOL])dnl\n dnl If AC_PROG_CXX has already been expanded, run AC_LIBTOOL_CXX\n dnl immediately, otherwise, hook it in at the end of AC_PROG_CXX.\n   AC_PROVIDE_IFELSE([AC_PROG_CXX],\n@@ -50,7 +51,7 @@ dnl AC_LIBTOOL_GCJ immediately, otherwise, hook it in at the end of both.\n \t       [define([LT_AC_PROG_GCJ], defn([LT_AC_PROG_GCJ])[AC_LIBTOOL_GCJ\n ])])])])])])\n \n-AC_DEFUN(_AC_PROG_LIBTOOL,\n+AC_DEFUN([_AC_PROG_LIBTOOL],\n [AC_REQUIRE([AC_LIBTOOL_SETUP])dnl\n AC_BEFORE([$0],[AC_LIBTOOL_CXX])dnl\n AC_BEFORE([$0],[AC_LIBTOOL_GCJ])dnl\n@@ -84,7 +85,7 @@ AC_SUBST(LIBTOOL)dnl\n exec 5>>./config.log\n ])\n \n-AC_DEFUN(AC_LIBTOOL_SETUP,\n+AC_DEFUN([AC_LIBTOOL_SETUP],\n [AC_PREREQ(2.13)dnl\n AC_REQUIRE([AC_ENABLE_SHARED])dnl\n AC_REQUIRE([AC_ENABLE_STATIC])dnl\n@@ -103,7 +104,7 @@ AC_REQUIRE([AC_EXEEXT])dnl\n dnl\n \n # Only perform the check for file, if the check method requires it\n-case \"$deplibs_check_method\" in\n+case $deplibs_check_method in\n file_magic*)\n   if test \"$file_magic_cmd\" = '$MAGIC_CMD'; then\n     AC_PATH_MAGIC\n@@ -119,8 +120,8 @@ libtool_flags=\"--cache-file=$cache_file\"\n test \"$enable_shared\" = no && libtool_flags=\"$libtool_flags --disable-shared\"\n test \"$enable_static\" = no && libtool_flags=\"$libtool_flags --disable-static\"\n test \"$enable_fast_install\" = no && libtool_flags=\"$libtool_flags --disable-fast-install\"\n-test \"$ac_cv_prog_gcc\" = yes && libtool_flags=\"$libtool_flags --with-gcc\"\n-test \"$ac_cv_prog_gnu_ld\" = yes && libtool_flags=\"$libtool_flags --with-gnu-ld\"\n+test \"$GCC\" = yes && libtool_flags=\"$libtool_flags --with-gcc\"\n+test \"$lt_cv_prog_gnu_ld\" = yes && libtool_flags=\"$libtool_flags --with-gnu-ld\"\n ifdef([AC_PROVIDE_AC_LIBTOOL_DLOPEN],\n [libtool_flags=\"$libtool_flags --enable-dlopen\"])\n ifdef([AC_PROVIDE_AC_LIBTOOL_WIN32_DLL],\n@@ -138,12 +139,12 @@ test x\"$pic_mode\" = xno && libtool_flags=\"$libtool_flags --prefer-non-pic\"\n \n # Some flags need to be propagated to the compiler or linker for good\n # libtool support.\n-case \"$host\" in\n+case $host in\n *-*-irix6*)\n   # Find out which ABI we are using.\n   echo '[#]line __oline__ \"configure\"' > conftest.$ac_ext\n   if AC_TRY_EVAL(ac_compile); then\n-    case \"`/usr/bin/file conftest.o`\" in\n+    case `/usr/bin/file conftest.$ac_objext` in\n     *32-bit*)\n       LD=\"${LD-ld} -32\"\n       ;;\n@@ -187,7 +188,7 @@ ifdef([AC_PROVIDE_AC_LIBTOOL_WIN32_DLL],\n       DllMain (0, 0, 0);],\n       [lt_cv_need_dllmain=no],[lt_cv_need_dllmain=yes])])\n \n-  case \"$host/$CC\" in\n+  case $host/$CC in\n   *-*-cygwin*/gcc*-mno-cygwin*|*-*-mingw*)\n     # old mingw systems require \"-dll\" to link a DLL, while more recent ones\n     # require \"-mdll\"\n@@ -207,23 +208,23 @@ esac\n ])\n \n # AC_LIBTOOL_DLOPEN - enable checks for dlopen support\n-AC_DEFUN(AC_LIBTOOL_DLOPEN, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])])\n+AC_DEFUN([AC_LIBTOOL_DLOPEN], [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])])\n \n # AC_LIBTOOL_WIN32_DLL - declare package support for building win32 dll's\n-AC_DEFUN(AC_LIBTOOL_WIN32_DLL, [AC_BEFORE([$0], [AC_LIBTOOL_SETUP])])\n+AC_DEFUN([AC_LIBTOOL_WIN32_DLL], [AC_BEFORE([$0], [AC_LIBTOOL_SETUP])])\n \n # AC_ENABLE_SHARED - implement the --enable-shared flag\n # Usage: AC_ENABLE_SHARED[(DEFAULT)]\n #   Where DEFAULT is either `yes' or `no'.  If omitted, it defaults to\n #   `yes'.\n-AC_DEFUN(AC_ENABLE_SHARED, [dnl\n-define([AC_ENABLE_SHARED_DEFAULT], ifelse($1, no, no, yes))dnl\n+AC_DEFUN([AC_ENABLE_SHARED],\n+[define([AC_ENABLE_SHARED_DEFAULT], ifelse($1, no, no, yes))dnl\n AC_ARG_ENABLE(shared,\n changequote(<<, >>)dnl\n <<  --enable-shared[=PKGS]  build shared libraries [default=>>AC_ENABLE_SHARED_DEFAULT],\n changequote([, ])dnl\n [p=${PACKAGE-default}\n-case \"$enableval\" in\n+case $enableval in\n yes) enable_shared=yes ;;\n no) enable_shared=no ;;\n *)\n@@ -242,21 +243,21 @@ enable_shared=AC_ENABLE_SHARED_DEFAULT)dnl\n ])\n \n # AC_DISABLE_SHARED - set the default shared flag to --disable-shared\n-AC_DEFUN(AC_DISABLE_SHARED, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl\n+AC_DEFUN([AC_DISABLE_SHARED], [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl\n AC_ENABLE_SHARED(no)])\n \n # AC_ENABLE_STATIC - implement the --enable-static flag\n # Usage: AC_ENABLE_STATIC[(DEFAULT)]\n #   Where DEFAULT is either `yes' or `no'.  If omitted, it defaults to\n #   `yes'.\n-AC_DEFUN(AC_ENABLE_STATIC, [dnl\n-define([AC_ENABLE_STATIC_DEFAULT], ifelse($1, no, no, yes))dnl\n+AC_DEFUN([AC_ENABLE_STATIC],\n+[define([AC_ENABLE_STATIC_DEFAULT], ifelse($1, no, no, yes))dnl\n AC_ARG_ENABLE(static,\n changequote(<<, >>)dnl\n <<  --enable-static[=PKGS]  build static libraries [default=>>AC_ENABLE_STATIC_DEFAULT],\n changequote([, ])dnl\n [p=${PACKAGE-default}\n-case \"$enableval\" in\n+case $enableval in\n yes) enable_static=yes ;;\n no) enable_static=no ;;\n *)\n@@ -275,22 +276,23 @@ enable_static=AC_ENABLE_STATIC_DEFAULT)dnl\n ])\n \n # AC_DISABLE_STATIC - set the default static flag to --disable-static\n-AC_DEFUN(AC_DISABLE_STATIC, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl\n+AC_DEFUN([AC_DISABLE_STATIC],\n+[AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl\n AC_ENABLE_STATIC(no)])\n \n \n # AC_ENABLE_FAST_INSTALL - implement the --enable-fast-install flag\n # Usage: AC_ENABLE_FAST_INSTALL[(DEFAULT)]\n #   Where DEFAULT is either `yes' or `no'.  If omitted, it defaults to\n #   `yes'.\n-AC_DEFUN(AC_ENABLE_FAST_INSTALL, [dnl\n-define([AC_ENABLE_FAST_INSTALL_DEFAULT], ifelse($1, no, no, yes))dnl\n+AC_DEFUN([AC_ENABLE_FAST_INSTALL],\n+[define([AC_ENABLE_FAST_INSTALL_DEFAULT], ifelse($1, no, no, yes))dnl\n AC_ARG_ENABLE(fast-install,\n changequote(<<, >>)dnl\n <<  --enable-fast-install[=PKGS]  optimize for fast installation [default=>>AC_ENABLE_FAST_INSTALL_DEFAULT],\n changequote([, ])dnl\n [p=${PACKAGE-default}\n-case \"$enableval\" in\n+case $enableval in\n yes) enable_fast_install=yes ;;\n no) enable_fast_install=no ;;\n *)\n@@ -309,22 +311,24 @@ enable_fast_install=AC_ENABLE_FAST_INSTALL_DEFAULT)dnl\n ])\n \n # AC_DISABLE_FAST_INSTALL - set the default to --disable-fast-install\n-AC_DEFUN(AC_DISABLE_FAST_INSTALL, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl\n+AC_DEFUN([AC_DISABLE_FAST_INSTALL],\n+[AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl\n AC_ENABLE_FAST_INSTALL(no)])\n \n # AC_LIBTOOL_PICMODE - implement the --with-pic flag\n # Usage: AC_LIBTOOL_PICMODE[(MODE)]\n #   Where MODE is either `yes' or `no'.  If omitted, it defaults to\n #   `both'.\n-AC_DEFUN(AC_LIBTOOL_PICMODE, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl\n+AC_DEFUN([AC_LIBTOOL_PICMODE],\n+[AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl\n pic_mode=ifelse($#,1,$1,default)])\n \n \n # AC_PATH_TOOL_PREFIX - find a file program which can recognise shared library\n-AC_DEFUN(AC_PATH_TOOL_PREFIX,\n+AC_DEFUN([AC_PATH_TOOL_PREFIX],\n [AC_MSG_CHECKING([for $1])\n AC_CACHE_VAL(lt_cv_path_MAGIC_CMD,\n-[case \"$MAGIC_CMD\" in\n+[case $MAGIC_CMD in\n   /*)\n   lt_cv_path_MAGIC_CMD=\"$MAGIC_CMD\" # Let the user override the test with a path.\n   ;;\n@@ -343,7 +347,7 @@ dnl not every word.  This closes a longstanding sh security hole.\n     if test -f $ac_dir/$1; then\n       lt_cv_path_MAGIC_CMD=\"$ac_dir/$1\"\n       if test -n \"$file_magic_test_file\"; then\n-\tcase \"$deplibs_check_method\" in\n+\tcase $deplibs_check_method in\n \t\"file_magic \"*)\n \t  file_magic_regex=\"`expr \\\"$deplibs_check_method\\\" : \\\"file_magic \\(.*\\)\\\"`\"\n \t  MAGIC_CMD=\"$lt_cv_path_MAGIC_CMD\"\n@@ -383,7 +387,7 @@ fi\n \n \n # AC_PATH_MAGIC - find a file program which can recognise a shared library\n-AC_DEFUN(AC_PATH_MAGIC,\n+AC_DEFUN([AC_PATH_MAGIC],\n [AC_REQUIRE([AC_CHECK_TOOL_PREFIX])dnl\n AC_PATH_TOOL_PREFIX(${ac_tool_prefix}file, /usr/bin:$PATH)\n if test -z \"$lt_cv_path_MAGIC_CMD\"; then\n@@ -397,15 +401,15 @@ fi\n \n \n # AC_PROG_LD - find the path to the GNU or non-GNU linker\n-AC_DEFUN(AC_PROG_LD,\n+AC_DEFUN([AC_PROG_LD],\n [AC_ARG_WITH(gnu-ld,\n [  --with-gnu-ld           assume the C compiler uses GNU ld [default=no]],\n test \"$withval\" = no || with_gnu_ld=yes, with_gnu_ld=no)\n AC_REQUIRE([AC_PROG_CC])dnl\n AC_REQUIRE([AC_CANONICAL_HOST])dnl\n AC_REQUIRE([AC_CANONICAL_BUILD])dnl\n ac_prog=ld\n-if test \"$ac_cv_prog_gcc\" = yes; then\n+if test \"$GCC\" = yes; then\n   # Check if gcc -print-prog-name=ld gives a path.\n   AC_MSG_CHECKING([for ld used by GCC])\n   case $host in\n@@ -415,12 +419,10 @@ if test \"$ac_cv_prog_gcc\" = yes; then\n   *)\n     ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;\n   esac\n-  case \"$ac_prog\" in\n+  case $ac_prog in\n     # Accept absolute paths.\n-changequote(,)dnl\n-    [\\\\/]* | [A-Za-z]:[\\\\/]*)\n-      re_direlt='/[^/][^/]*/\\.\\./'\n-changequote([,])dnl\n+    [[\\\\/]* | [A-Za-z]:[\\\\/]*)]\n+      re_direlt=['/[^/][^/]*/\\.\\./']\n       # Canonicalize the path of ld\n       ac_prog=`echo $ac_prog| sed 's%\\\\\\\\%/%g'`\n       while echo $ac_prog | grep \"$re_direlt\" > /dev/null 2>&1; do\n@@ -442,17 +444,17 @@ elif test \"$with_gnu_ld\" = yes; then\n else\n   AC_MSG_CHECKING([for non-GNU ld])\n fi\n-AC_CACHE_VAL(ac_cv_path_LD,\n+AC_CACHE_VAL(lt_cv_path_LD,\n [if test -z \"$LD\"; then\n   IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\"${IFS}${PATH_SEPARATOR-:}\"\n   for ac_dir in $PATH; do\n     test -z \"$ac_dir\" && ac_dir=.\n     if test -f \"$ac_dir/$ac_prog\" || test -f \"$ac_dir/$ac_prog$ac_exeext\"; then\n-      ac_cv_path_LD=\"$ac_dir/$ac_prog\"\n+      lt_cv_path_LD=\"$ac_dir/$ac_prog\"\n       # Check to see if the program is GNU ld.  I'd rather use --version,\n       # but apparently some GNU ld's only accept -v.\n       # Break only if it was the GNU/non-GNU ld that we prefer.\n-      if \"$ac_cv_path_LD\" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then\n+      if \"$lt_cv_path_LD\" -v 2>&1 < /dev/null | egrep '(GNU|with BFD)' > /dev/null; then\n \ttest \"$with_gnu_ld\" != no && break\n       else\n \ttest \"$with_gnu_ld\" != yes && break\n@@ -461,9 +463,9 @@ AC_CACHE_VAL(ac_cv_path_LD,\n   done\n   IFS=\"$ac_save_ifs\"\n else\n-  ac_cv_path_LD=\"$LD\" # Let the user override the test with a path.\n+  lt_cv_path_LD=\"$LD\" # Let the user override the test with a path.\n fi])\n-LD=\"$ac_cv_path_LD\"\n+LD=\"$lt_cv_path_LD\"\n if test -n \"$LD\"; then\n   AC_MSG_RESULT($LD)\n else\n@@ -473,20 +475,20 @@ test -z \"$LD\" && AC_MSG_ERROR([no acceptable ld found in \\$PATH])\n AC_PROG_LD_GNU\n ])\n \n-AC_DEFUN(AC_PROG_LD_GNU,\n-[AC_CACHE_CHECK([if the linker ($LD) is GNU ld], ac_cv_prog_gnu_ld,\n+AC_DEFUN([AC_PROG_LD_GNU],\n+[AC_CACHE_CHECK([if the linker ($LD) is GNU ld], lt_cv_prog_gnu_ld,\n [# I'd rather use --version here, but apparently some GNU ld's only accept -v.\n if $LD -v 2>&1 </dev/null | egrep '(GNU|with BFD)' 1>&5; then\n-  ac_cv_prog_gnu_ld=yes\n+  lt_cv_prog_gnu_ld=yes\n else\n-  ac_cv_prog_gnu_ld=no\n+  lt_cv_prog_gnu_ld=no\n fi])\n-with_gnu_ld=$ac_cv_prog_gnu_ld\n+with_gnu_ld=$lt_cv_prog_gnu_ld\n ])\n \n # AC_PROG_LD_RELOAD_FLAG - find reload flag for linker\n #   -- PORTME Some linkers may need a different reload flag.\n-AC_DEFUN(AC_PROG_LD_RELOAD_FLAG,\n+AC_DEFUN([AC_PROG_LD_RELOAD_FLAG],\n [AC_CACHE_CHECK([for $LD option to reload object files], lt_cv_ld_reload_flag,\n [lt_cv_ld_reload_flag='-r'])\n reload_flag=$lt_cv_ld_reload_flag\n@@ -495,7 +497,7 @@ test -n \"$reload_flag\" && reload_flag=\" $reload_flag\"\n \n # AC_DEPLIBS_CHECK_METHOD - how to check for library dependencies\n #  -- PORTME fill in with the dynamic library characteristics\n-AC_DEFUN(AC_DEPLIBS_CHECK_METHOD,\n+AC_DEFUN([AC_DEPLIBS_CHECK_METHOD],\n [AC_CACHE_CHECK([how to recognise dependant libraries],\n lt_cv_deplibs_check_method,\n [lt_cv_file_magic_cmd='$MAGIC_CMD'\n@@ -512,8 +514,8 @@ lt_cv_deplibs_check_method='unknown'\n # If you have `file' or equivalent on your system and you're not sure\n # whether `pass_all' will *always* work, you probably want this one.\n \n-case \"$host_os\" in\n-aix4*)\n+case $host_os in\n+aix*)\n   lt_cv_deplibs_check_method=pass_all\n   ;;\n \n@@ -522,9 +524,7 @@ beos*)\n   ;;\n \n bsdi4*)\n-  changequote(,)dnl\n-  lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [ML]SB (shared object|dynamic lib)'\n-  changequote([, ])dnl\n+  lt_cv_deplibs_check_method=['file_magic ELF [0-9][0-9]*-bit [ML]SB (shared object|dynamic lib)']\n   lt_cv_file_magic_cmd='/usr/bin/file -L'\n   lt_cv_file_magic_test_file=/shlib/libc.so\n   ;;\n@@ -534,15 +534,19 @@ cygwin* | mingw* |pw32*)\n   lt_cv_file_magic_cmd='$OBJDUMP -f'\n   ;;\n \n+darwin* | rhapsody*)\n+  lt_cv_deplibs_check_method='file_magic Mach-O dynamically linked shared library'\n+  lt_cv_file_magic_cmd=/usr/bin/file\n+  lt_cv_file_magic_test_file=`echo /System/Library/Frameworks/System.framework/Versions/*/System | head -1`\n+  ;;\n+\n freebsd* )\n   if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then\n-    case \"$host_cpu\" in\n+    case $host_cpu in\n     i*86 )\n       # Not sure whether the presence of OpenBSD here was a mistake.\n       # Let's accept both of them until this is cleared up.\n-      changequote(,)dnl\n-      lt_cv_deplibs_check_method='file_magic (FreeBSD|OpenBSD)/i[3-9]86 (compact )?demand paged shared library'\n-      changequote([, ])dnl\n+      lt_cv_deplibs_check_method=['file_magic (FreeBSD|OpenBSD)/i[3-9]86 (compact )?demand paged shared library']\n       lt_cv_file_magic_cmd=/usr/bin/file\n       lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`\n       ;;\n@@ -556,30 +560,27 @@ gnu*)\n   lt_cv_deplibs_check_method=pass_all\n   ;;\n \n-hpux10.20*)\n-  # TODO:  Does this work for hpux-11 too?\n-  lt_cv_deplibs_check_method='file_magic (s[0-9][0-9][0-9]|PA-RISC[0-9].[0-9]) shared library'\n+hpux10.20*|hpux11*)\n+  lt_cv_deplibs_check_method=['file_magic (s[0-9][0-9][0-9]|PA-RISC[0-9].[0-9]) shared library']\n   lt_cv_file_magic_cmd=/usr/bin/file\n   lt_cv_file_magic_test_file=/usr/lib/libc.sl\n   ;;\n \n irix5* | irix6*)\n-  case \"$host_os\" in\n+  case $host_os in\n   irix5*)\n     # this will be overridden with pass_all, but let us keep it just in case\n     lt_cv_deplibs_check_method=\"file_magic ELF 32-bit MSB dynamic lib MIPS - version 1\"\n     ;;\n   *)\n-    case \"$LD\" in\n+    case $LD in\n     *-32|*\"-32 \") libmagic=32-bit;;\n     *-n32|*\"-n32 \") libmagic=N32;;\n     *-64|*\"-64 \") libmagic=64-bit;;\n     *) libmagic=never-match;;\n     esac\n     # this will be overridden with pass_all, but let us keep it just in case\n-    changequote(,)dnl\n-    lt_cv_deplibs_check_method=\"file_magic ELF ${libmagic} MSB mips-[1234] dynamic lib MIPS - version 1\"\n-    changequote([, ])dnl\n+    lt_cv_deplibs_check_method=[\"file_magic ELF ${libmagic} MSB mips-[1234] dynamic lib MIPS - version 1\"]\n     ;;\n   esac\n   lt_cv_file_magic_test_file=`echo /lib${libsuff}/libc.so*`\n@@ -588,27 +589,30 @@ irix5* | irix6*)\n \n # This must be Linux ELF.\n linux-gnu*)\n-  case \"$host_cpu\" in\n+  case $host_cpu in\n   alpha* | i*86 | powerpc* | sparc* | ia64* )\n     lt_cv_deplibs_check_method=pass_all ;;\n   *)\n     # glibc up to 2.1.1 does not perform some relocations on ARM\n-    changequote(,)dnl\n-    lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [LM]SB (shared object|dynamic lib )' ;;\n-    changequote([, ])dnl\n+    lt_cv_deplibs_check_method=['file_magic ELF [0-9][0-9]*-bit [LM]SB (shared object|dynamic lib )'] ;;\n   esac\n   lt_cv_file_magic_test_file=`echo /lib/libc.so* /lib/libc-*.so`\n   ;;\n \n netbsd*)\n-  if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then :\n+  if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then\n+    [lt_cv_deplibs_check_method='file_magic NetBSD/[a-z0-9]* demand paged shared library']\n   else\n-    changequote(,)dnl\n-    lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [LM]SB shared object'\n-    changequote([, ])dnl\n-    lt_cv_file_magic_cmd='/usr/bin/file -L'\n-    lt_cv_file_magic_test_file=`echo /usr/lib/libc.so*`\n+    [lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [LM]SB shared object']\n   fi\n+  lt_cv_file_magic_cmd='/usr/bin/file -L'\n+  lt_cv_file_magic_test_file=`echo /usr/lib/libc.so*`\n+  ;;\n+\n+newsos6)\n+  [lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [ML]SB (executable|dynamic lib)']\n+  lt_cv_file_magic_cmd=/usr/bin/file\n+  lt_cv_file_magic_test_file=/usr/lib/libnls.so\n   ;;\n \n osf3* | osf4* | osf5*)\n@@ -628,14 +632,12 @@ solaris*)\n   ;;\n \n sysv4 | sysv4.2uw2* | sysv4.3* | sysv5*)\n-  case \"$host_vendor\" in\n+  case $host_vendor in\n   ncr)\n     lt_cv_deplibs_check_method=pass_all\n     ;;\n   motorola)\n-    changequote(,)dnl\n-    lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [ML]SB (shared object|dynamic lib) M[0-9][0-9]* Version [0-9]'\n-    changequote([, ])dnl\n+    lt_cv_deplibs_check_method=['file_magic ELF [0-9][0-9]*-bit [ML]SB (shared object|dynamic lib) M[0-9][0-9]* Version [0-9]']\n     lt_cv_file_magic_test_file=`echo /usr/lib/libc.so*`\n     ;;\n   esac\n@@ -648,12 +650,12 @@ deplibs_check_method=$lt_cv_deplibs_check_method\n \n \n # AC_PROG_NM - find the path to a BSD-compatible name lister\n-AC_DEFUN(AC_PROG_NM,\n+AC_DEFUN([AC_PROG_NM],\n [AC_MSG_CHECKING([for BSD-compatible nm])\n-AC_CACHE_VAL(ac_cv_path_NM,\n+AC_CACHE_VAL(lt_cv_path_NM,\n [if test -n \"$NM\"; then\n   # Let the user override the test.\n-  ac_cv_path_NM=\"$NM\"\n+  lt_cv_path_NM=\"$NM\"\n else\n   IFS=\"${IFS= \t}\"; ac_save_ifs=\"$IFS\"; IFS=\"${IFS}${PATH_SEPARATOR-:}\"\n   for ac_dir in $PATH /usr/ccs/bin /usr/ucb /bin; do\n@@ -665,29 +667,29 @@ else\n       #   nm: unknown option \"B\" ignored\n       # Tru64's nm complains that /dev/null is an invalid object file\n       if ($tmp_nm -B /dev/null 2>&1 | sed '1q'; exit 0) | egrep '(/dev/null|Invalid file or object type)' >/dev/null; then\n-\tac_cv_path_NM=\"$tmp_nm -B\"\n+\tlt_cv_path_NM=\"$tmp_nm -B\"\n \tbreak\n       elif ($tmp_nm -p /dev/null 2>&1 | sed '1q'; exit 0) | egrep /dev/null >/dev/null; then\n-\tac_cv_path_NM=\"$tmp_nm -p\"\n+\tlt_cv_path_NM=\"$tmp_nm -p\"\n \tbreak\n       else\n-\tac_cv_path_NM=${ac_cv_path_NM=\"$tmp_nm\"} # keep the first match, but\n+\tlt_cv_path_NM=${lt_cv_path_NM=\"$tmp_nm\"} # keep the first match, but\n \tcontinue # so that we can try to find one that supports BSD flags\n       fi\n     fi\n   done\n   IFS=\"$ac_save_ifs\"\n-  test -z \"$ac_cv_path_NM\" && ac_cv_path_NM=nm\n+  test -z \"$lt_cv_path_NM\" && lt_cv_path_NM=nm\n fi])\n-NM=\"$ac_cv_path_NM\"\n+NM=\"$lt_cv_path_NM\"\n AC_MSG_RESULT([$NM])\n ])\n \n # AC_CHECK_LIBM - check for math library\n-AC_DEFUN(AC_CHECK_LIBM,\n+AC_DEFUN([AC_CHECK_LIBM],\n [AC_REQUIRE([AC_CANONICAL_HOST])dnl\n LIBM=\n-case \"$host\" in\n+case $host in\n *-*-beos* | *-*-cygwin* | *-*-pw32*)\n   # These system don't have libm\n   ;;\n@@ -711,8 +713,9 @@ esac\n # '${top_srcdir}/' (note the single quotes!).  If your package is not\n # flat and you're not using automake, define top_builddir and\n # top_srcdir appropriately in the Makefiles.\n-AC_DEFUN(AC_LIBLTDL_CONVENIENCE, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl\n-  case \"$enable_ltdl_convenience\" in\n+AC_DEFUN([AC_LIBLTDL_CONVENIENCE],\n+[AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl\n+  case $enable_ltdl_convenience in\n   no) AC_MSG_ERROR([this package needs a convenience libltdl]) ;;\n   \"\") enable_ltdl_convenience=yes\n       ac_configure_args=\"$ac_configure_args --enable-ltdl-convenience\" ;;\n@@ -732,7 +735,8 @@ AC_DEFUN(AC_LIBLTDL_CONVENIENCE, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl\n # not flat and you're not using automake, define top_builddir and\n # top_srcdir appropriately in the Makefiles.\n # In the future, this macro may have to be called after AC_PROG_LIBTOOL.\n-AC_DEFUN(AC_LIBLTDL_INSTALLABLE, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl\n+AC_DEFUN([AC_LIBLTDL_INSTALLABLE],\n+[AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl\n   AC_CHECK_LIB(ltdl, main,\n   [test x\"$enable_ltdl_install\" != xyes && enable_ltdl_install=no],\n   [if test x\"$enable_ltdl_install\" = xno; then\n@@ -760,18 +764,18 @@ ifdef([AC_PROVIDE_IFELSE],\n                      [$2], [$3])])])\n \n # AC_LIBTOOL_CXX - enable support for C++ libraries\n-AC_DEFUN(AC_LIBTOOL_CXX,[AC_REQUIRE([_AC_LIBTOOL_CXX])])\n-AC_DEFUN(_AC_LIBTOOL_CXX,\n-[AC_REQUIRE([AC_PROG_LIBTOOL])\n-AC_REQUIRE([AC_PROG_CXX])\n+AC_DEFUN([AC_LIBTOOL_CXX], [AC_REQUIRE([_AC_LIBTOOL_CXX])])\n+\n+AC_DEFUN([_AC_LIBTOOL_CXX],\n+[AC_REQUIRE([AC_PROG_CXX])\n AC_REQUIRE([AC_PROG_CXXCPP])\n LIBTOOL_DEPS=$LIBTOOL_DEPS\" $ac_aux_dir/ltcf-cxx.sh\"\n lt_save_CC=\"$CC\"\n lt_save_CFLAGS=\"$CFLAGS\"\n dnl Make sure LTCC is set to the C compiler, i.e. set LTCC before CC\n dnl is set to the C++ compiler.\n AR=\"$AR\" LTCC=\"$CC\" CC=\"$CXX\" CXX=\"$CXX\" CFLAGS=\"$CXXFLAGS\" CPPFLAGS=\"$CPPFLAGS\" \\\n-MAGIC_CMD=\"$MAGIC_CMD\" LDFLAGS=\"$LDFLAGS\" LIBS=\"$LIBS\" \\\n+MAGIC_CMD=\"$MAGIC_CMD\" LD=\"$LD\" LDFLAGS=\"$LDFLAGS\" LIBS=\"$LIBS\" \\\n LN_S=\"$LN_S\" NM=\"$NM\" RANLIB=\"$RANLIB\" STRIP=\"$STRIP\" \\\n AS=\"$AS\" DLLTOOL=\"$DLLTOOL\" OBJDUMP=\"$OBJDUMP\" \\\n objext=\"$OBJEXT\" exeext=\"$EXEEXT\" reload_flag=\"$reload_flag\" \\\n@@ -789,8 +793,9 @@ exec 5>>./config.log\n ])\n \n # AC_LIBTOOL_GCJ - enable support for GCJ libraries\n-AC_DEFUN(AC_LIBTOOL_GCJ,[AC_REQUIRE([_AC_LIBTOOL_GCJ])])\n-AC_DEFUN(_AC_LIBTOOL_GCJ,\n+AC_DEFUN([AC_LIBTOOL_GCJ],[AC_REQUIRE([_AC_LIBTOOL_GCJ])])\n+\n+AC_DEFUN([_AC_LIBTOOL_GCJ],\n [AC_REQUIRE([AC_PROG_LIBTOOL])\n AC_PROVIDE_IFELSE([AC_PROG_GCJ],[],\n   [AC_PROVIDE_IFELSE([A][M_PROG_GCJ],[],\n@@ -804,7 +809,7 @@ lt_save_CFLAGS=\"$CFLAGS\"\n dnl Make sure LTCC is set to the C compiler, i.e. set LTCC before CC\n dnl is set to the C++ compiler.\n AR=\"$AR\" LTCC=\"$CC\" CC=\"$GCJ\" CFLAGS=\"$GCJFLAGS\" CPPFLAGS=\"$CPPFLAGS\" \\\n-MAGIC_CMD=\"$MAGIC_CMD\" LDFLAGS=\"$LDFLAGS\" LIBS=\"$LIBS\" \\\n+MAGIC_CMD=\"$MAGIC_CMD\" LD=\"$LD\" LDFLAGS=\"$LDFLAGS\" LIBS=\"$LIBS\" \\\n LN_S=\"$LN_S\" NM=\"$NM\" RANLIB=\"$RANLIB\" STRIP=\"$STRIP\" \\\n AS=\"$AS\" DLLTOOL=\"$DLLTOOL\" OBJDUMP=\"$OBJDUMP\" \\\n objext=\"$OBJEXT\" exeext=\"$EXEEXT\" reload_flag=\"$reload_flag\" \\\n@@ -822,19 +827,19 @@ exec 5>>./config.log\n ])\n \n dnl old names\n-AC_DEFUN(AM_PROG_LIBTOOL, [indir([AC_PROG_LIBTOOL])])dnl\n-AC_DEFUN(AM_ENABLE_SHARED, [indir([AC_ENABLE_SHARED], $@)])dnl\n-AC_DEFUN(AM_ENABLE_STATIC, [indir([AC_ENABLE_STATIC], $@)])dnl\n-AC_DEFUN(AM_DISABLE_SHARED, [indir([AC_DISABLE_SHARED], $@)])dnl\n-AC_DEFUN(AM_DISABLE_STATIC, [indir([AC_DISABLE_STATIC], $@)])dnl\n-AC_DEFUN(AM_PROG_LD, [indir([AC_PROG_LD])])dnl\n-AC_DEFUN(AM_PROG_NM, [indir([AC_PROG_NM])])dnl\n+AC_DEFUN([AM_PROG_LIBTOOL],   [AC_PROG_LIBTOOL])\n+AC_DEFUN([AM_ENABLE_SHARED],  [AC_ENABLE_SHARED($@)])\n+AC_DEFUN([AM_ENABLE_STATIC],  [AC_ENABLE_STATIC($@)])\n+AC_DEFUN([AM_DISABLE_SHARED], [AC_DISABLE_SHARED($@)])\n+AC_DEFUN([AM_DISABLE_STATIC], [AC_DISABLE_STATIC($@)])\n+AC_DEFUN([AM_PROG_LD],        [AC_PROG_LD])\n+AC_DEFUN([AM_PROG_NM],        [AC_PROG_NM])\n \n dnl This is just to silence aclocal about the macro not being used\n ifelse([AC_DISABLE_FAST_INSTALL])dnl\n \n-AC_DEFUN([LT_AC_PROG_GCJ],[\n-  AC_CHECK_TOOL(GCJ, gcj, no)\n+AC_DEFUN([LT_AC_PROG_GCJ],\n+[AC_CHECK_TOOL(GCJ, gcj, no)\n   test \"x${GCJFLAGS+set}\" = xset || GCJFLAGS=\"-g -O2\"\n   AC_SUBST(GCJFLAGS)\n ])"}, {"sha": "3d99a49cc1918c21c4b28a4959a79d776be5c2d0", "filename": "ltcf-c.sh", "status": "modified", "additions": 148, "deletions": 87, "changes": 235, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82e232360ddbe45a46588e80aa620eb416e2d6ee/ltcf-c.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82e232360ddbe45a46588e80aa620eb416e2d6ee/ltcf-c.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ltcf-c.sh?ref=82e232360ddbe45a46588e80aa620eb416e2d6ee", "patch": "@@ -38,7 +38,7 @@ lt_simple_compile_test_code=\"int some_variable = 0;\"\n lt_simple_link_test_code='main(){return(0);}'\n \n ## Linker Characteristics\n-case \"$host_os\" in\n+case $host_os in\n cygwin* | mingw*)\n   # FIXME: the MSVC++ port hasn't been tested in a loooong time\n   # When not using gcc, we currently assume that we are using\n@@ -56,7 +56,7 @@ if test \"$with_gnu_ld\" = yes; then\n   wlarc='${wl}'\n \n   # See if GNU ld supports shared libraries.\n-  case \"$host_os\" in\n+  case $host_os in\n   aix3* | aix4* | aix5*)\n     # On AIX, the GNU linker is very broken\n     ld_shlibs=no\n@@ -117,7 +117,7 @@ EOF\n     # FIXME: what about values for MSVC?\n     dll_entry=__cygwin_dll_entry@12\n     dll_exclude_symbols=DllMain@12,_cygwin_dll_entry@12,_cygwin_noncygwin_dll_entry@12~\n-    case \"$host_os\" in\n+    case $host_os in\n     mingw*)\n       # mingw values\n       dll_entry=_DllMainCRTStartup@12\n@@ -148,17 +148,23 @@ EOF\n       $DLLTOOL --export-all --exclude-symbols '$dll_exclude_symbols' --output-def $output_objdir/$soname-def '$ltdll_obj'$libobjs $convenience~\n       sed -e \"1,/EXPORTS/d\" -e \"s/ @ [0-9]*//\" -e \"s/ *;.*$//\" < $output_objdir/$soname-def > $export_symbols'\n \n+    # If the export-symbols file already is a .def file (1st line\n+    # is EXPORTS), use it as is.\n     # If DATA tags from a recent dlltool are present, honour them!\n-    archive_expsym_cmds='echo EXPORTS > $output_objdir/$soname-def~\n-      _lt_hint=1;\n-      cat $export_symbols | while read symbol; do\n-\tset dummy \\$symbol;\n-\tcase \\$# in\n-\t  2) echo \"\t\\$2 @ \\$_lt_hint ; \" >> $output_objdir/$soname-def;;\n-\t  *) echo \"     \\$2 @ \\$_lt_hint \\$3 ; \" >> $output_objdir/$soname-def;;\n-\tesac;\n-\t_lt_hint=`expr 1 + \\$_lt_hint`;\n-      done~\n+    archive_expsym_cmds='if test \"x`head -1 $export_symbols`\" = xEXPORTS; then\n+        cp $export_symbols $output_objdir/$soname-def;\n+      else\n+        echo EXPORTS > $output_objdir/$soname-def;\n+        _lt_hint=1;\n+        cat $export_symbols | while read symbol; do\n+         set dummy \\$symbol;\n+         case \\[$]# in\n+           2) echo \"   \\[$]2 @ \\$_lt_hint ; \" >> $output_objdir/$soname-def;;\n+           *) echo \"     \\[$]2 @ \\$_lt_hint \\[$]3 ; \" >> $output_objdir/$soname-def;;\n+         esac;\n+         _lt_hint=`expr 1 + \\$_lt_hint`;\n+        done;\n+      fi~\n       '\"$ltdll_cmds\"'\n       $CC -Wl,--base-file,$output_objdir/$soname-base '$lt_cv_cc_dll_switch' -Wl,-e,'$dll_entry' -o $lib '$ltdll_obj'$libobjs $deplibs $compiler_flags~\n       $DLLTOOL --as=$AS --dllname $soname --exclude-symbols '$dll_exclude_symbols' --def $output_objdir/$soname-def --base-file $output_objdir/$soname-base --output-exp $output_objdir/$soname-exp~\n@@ -167,6 +173,18 @@ EOF\n       $CC $output_objdir/$soname-exp '$lt_cv_cc_dll_switch' -Wl,-e,'$dll_entry' -o $lib '$ltdll_obj'$libobjs $deplibs $compiler_flags'\n     ;;\n \n+  darwin*|rhapsody*)\n+    allow_undefined_flag='-undefined warning'\n+    archive_cmds='$CC $(if test \"$module\" = \"yes\"; then echo -bundle; else\n+      echo -dynamiclib; fi) -o $lib $libobjs $deplibs $linkopts'\n+    archive_expsym_cmds=\"$archive_cmds\"' && strip -s $export_symbols'\n+    ## What we need is to hardcode the path to the library, not the search path\n+    #hardcode_direct=yes\n+    #hardcode_libdir_flag_spec='-install_name $libdir/$lib'\n+    hardcode_shlibpath_var=no\n+    whole_archive_flag_spec='-all_load'\n+    ;;\n+\n   netbsd*)\n     if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then\n       archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'\n@@ -207,9 +225,8 @@ EOF\n \n   *)\n     if $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then\n-      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${allow_undefined_flag} ${wl}-soname $wl$soname -o $lib'\n-      archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${allow_undefined_flag} ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'\n-      no_undefined_flag='${wl}--no-undefined'\n+      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'\n+      archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'\n     else\n       ld_shlibs=no\n     fi\n@@ -237,7 +254,7 @@ EOF\n   fi\n else\n   # PORTME fill in a description of your system's linker (not GNU ld)\n-  case \"$host_os\" in\n+  case $host_os in\n   aix3*)\n     allow_undefined_flag=unsupported\n     always_export_symbols=yes\n@@ -253,43 +270,89 @@ else\n     ;;\n \n   aix4* | aix5*)\n-    hardcode_libdir_flag_spec='${wl}-b ${wl}nolibpath ${wl}-b ${wl}libpath:$libdir:/usr/lib:/lib'\n+    hardcode_direct=yes\n     hardcode_libdir_separator=':'\n+    link_all_deplibs=yes\n+    # When large executables or shared objects are built, AIX ld can\n+    # have problems creating the table of contents.  If linking a library\n+    # or program results in \"error TOC overflow\" add -mminimal-toc to\n+    # CXXFLAGS/CFLAGS for g++/gcc.  In the cases where that is not\n+    # enough to fix the problem, add -Wl,-bbigtoc to LDFLAGS.\n     if test \"$with_gcc\" = yes; then\n-      collect2name=`${CC} -print-prog-name=collect2`\n-      if test -f \"$collect2name\" && \\\n-\t strings \"$collect2name\" | grep resolve_lib_name >/dev/null\n-      then\n-\t# We have reworked collect2\n-\thardcode_direct=yes\n+      case $host_os in aix4.[012]|aix4.[012].*)\n+      # We only want to do this on AIX 4.2 and lower, the check\n+      # below for broken collect2 doesn't work under 4.3+\n+        collect2name=`${CC} -print-prog-name=collect2`\n+        if test -f \"$collect2name\" && \\\n+\t   strings \"$collect2name\" | grep resolve_lib_name >/dev/null\n+        then\n+\t  # We have reworked collect2\n+\t  hardcode_direct=yes\n+        else\n+\t  # We have old collect2\n+\t  hardcode_direct=unsupported\n+\t  # It fails to find uninstalled libraries when the uninstalled\n+\t  # path is not listed in the libpath.  Setting hardcode_minus_L\n+\t  # to unsupported forces relinking\n+\t  hardcode_minus_L=yes\n+\t  hardcode_libdir_flag_spec='-L$libdir'\n+\t  hardcode_libdir_separator=\n+        fi\n+      esac\n+      shared_flag='-shared'\n+    else\n+      # not using gcc\n+      if test \"$host_cpu\" = ia64; then\n+        shared_flag='${wl}-G'\n       else\n-\t# We have old collect2\n-\thardcode_direct=unsupported\n-\t# It fails to find uninstalled libraries when the uninstalled\n-\t# path is not listed in the libpath.  Setting hardcode_minus_L\n-\t# to unsupported forces relinking\n-\thardcode_minus_L=yes\n-\thardcode_libdir_flag_spec='-L$libdir'\n-\thardcode_libdir_separator=\n+        shared_flag='${wl}-bM:SRE'\n       fi\n-      shared_flag='-shared'\n+    fi\n+\n+    if test \"$host_cpu\" = ia64; then\n+      # On IA64, the linker does run time linking by default, so we don't\n+      # have to do anything special.\n+      aix_use_runtimelinking=no\n+      exp_sym_flag='-Bexport'\n+      no_entry_flag=\"\"\n     else\n-      shared_flag='${wl}-bM:SRE'\n-      hardcode_direct=yes\n+      # Test if we are trying to use run time linking, or normal AIX style linking.\n+      # If -brtl is somewhere in LDFLAGS, we need to do run time linking.\n+      aix_use_runtimelinking=no\n+      for ld_flag in $LDFLAGS; do\n+        if (test $ld_flag = \"-brtl\" || test $ld_flag = \"-Wl,-brtl\" ); then\n+          aix_use_runtimelinking=yes\n+          break\n+        fi\n+      done\n+      exp_sym_flag='-bexport'\n+      no_entry_flag='-bnoentry'\n     fi\n-    allow_undefined_flag=' ${wl}-berok'\n-    archive_expsym_cmds=\"\\$CC $shared_flag\"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}-bE:$export_symbols ${wl}-bnoentry${allow_undefined_flag}~$AR $AR_FLAGS $output_objdir/$libname$release.a $output_objdir/$soname'\n     # -bexpall does not export symbols beginning with underscore (_)\n     always_export_symbols=yes\n-    # Exported symbols can be pulled into shared objects from archives\n-    whole_archive_flag_spec=' '\n-    build_libtool_need_lc=yes\n-\n-    # We don't want to build shared libraries on unknown CPU types.\n-    case $host_cpu in\n-    powerpc | rs6000) ;;\n-    *) ld_shlibs=no ;;\n-    esac\n+    if test \"$aix_use_runtimelinking\" = yes; then\n+      # Warning - without using the other run time loading flags (-brtl), -berok will\n+      #           link without error, but may produce a broken library.\n+      allow_undefined_flag=' ${wl}-berok'\n+      hardcode_libdir_flag_spec='${wl}-blibpath:$libdir:/usr/lib:/lib'\n+      archive_expsym_cmds=\"\\$CC $shared_flag\"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${allow_undefined_flag} '\"\\${wl}$no_entry_flag \\${wl}$exp_sym_flag:\\$export_symbols\"\n+    else\n+      if test \"$host_cpu\" = ia64; then\n+        hardcode_libdir_flag_spec='${wl}-R $libdir:/usr/lib:/lib'\n+        allow_undefined_flag=\"-z nodefs\"\n+        archive_expsym_cmds=\"\\$CC $shared_flag\"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}${allow_undefined_flag} '\"\\${wl}$no_entry_flag \\${wl}$exp_sym_flag:\\$export_symbols\"\n+      else\n+        allow_undefined_flag=' ${wl}-berok'\n+        # -bexpall does not export symbols beginning with underscore (_)\n+        always_export_symbols=yes\n+        # Exported symbols can be pulled into shared objects from archives\n+        whole_archive_flag_spec=' '\n+        build_libtool_need_lc=yes\n+        hardcode_libdir_flag_spec='${wl}-blibpath:$libdir:/usr/lib:/lib'\n+        # This is similar to how AIX traditionally builds it's shared libraries.\n+        archive_expsym_cmds=\"\\$CC $shared_flag\"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}-bE:$export_symbols ${wl}-bnoentry${allow_undefined_flag}~$AR $AR_FLAGS $output_objdir/$libname$release.a $output_objdir/$soname'\n+      fi\n+    fi\n     ;;\n \n   amigaos*)\n@@ -315,7 +378,7 @@ else\n     old_archive_from_new_cmds='true'\n     # FIXME: Should let the user specify the lib program.\n     old_archive_cmds='lib /OUT:$oldlib$oldobjs$old_deplibs'\n-    fix_srcfile_path='`cygpath -w $srcfile`'\n+    fix_srcfile_path='`cygpath -w \"$srcfile\"`'\n     ;;\n \n   freebsd1*)\n@@ -350,7 +413,7 @@ else\n     ;;\n \n   hpux9* | hpux10* | hpux11*)\n-    case \"$host_os\" in\n+    case $host_os in\n     hpux9*) archive_cmds='$rm $output_objdir/$soname~$LD -b +b $install_libdir -o $output_objdir/$soname $libobjs $deplibs $linker_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib' ;;\n     *) archive_cmds='$LD -b +h $soname +b $install_libdir -o $lib $libobjs $deplibs $linker_flags' ;;\n     esac\n@@ -379,8 +442,16 @@ else\n     else\n       archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF\n     fi\n-    hardcode_libdir_flag_spec='${wl}-R$libdir'\n+    hardcode_libdir_flag_spec='-R$libdir'\n+    hardcode_direct=yes\n+    hardcode_shlibpath_var=no\n+    ;;\n+\n+  newsos6)\n+    archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linkopts'\n     hardcode_direct=yes\n+    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'\n+    hardcode_libdir_separator=:\n     hardcode_shlibpath_var=no\n     ;;\n \n@@ -418,8 +489,10 @@ else\n     else\n       allow_undefined_flag=' -expect_unresolved \\*'\n       archive_cmds='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -msym -soname $soname `test -n \"$verstring\" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'\n+      archive_expsym_cmds='for i in `cat $export_symbols`; do printf \"-exported_symbol \" >> $lib.exp; echo \"\\$i\" >> $lib.exp; done; echo \"-hidden\">> $lib.exp~\n+      $LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n \"$verstring\" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib~$rm $lib.exp'\n     fi\n-    hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'\n+    hardcode_libdir_flag_spec='-rpath $libdir'\n     hardcode_libdir_separator=:\n     ;;\n \n@@ -432,18 +505,14 @@ else\n \n   solaris*)\n     no_undefined_flag=' -z text'\n-    if test \"$with_gcc\" = yes; then\n-      archive_cmds='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'\n-      archive_expsym_cmds='$echo \"{ global:\" > $lib.exp~cat $export_symbols | sed -e \"s/\\(.*\\)/\\1;/\" >> $lib.exp~$echo \"local: *; };\" >> $lib.exp~\n-                  $CC -shared ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$rm $lib.exp'\n-    else\n-      archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'\n-      archive_expsym_cmds='$echo \"{ global:\" > $lib.exp~cat $export_symbols | sed -e \"s/\\(.*\\)/\\1;/\" >> $lib.exp~$echo \"local: *; };\" >> $lib.exp~\n-\t\t  $LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'\n-    fi\n+    # $CC -shared without GNU ld will not create a library from C++\n+    # object files and a static libstdc++, better avoid it by now\n+    archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'\n+    archive_expsym_cmds='$echo \"{ global:\" > $lib.exp~cat $export_symbols | sed -e \"s/\\(.*\\)/\\1;/\" >> $lib.exp~$echo \"local: *; };\" >> $lib.exp~\n+\t\t$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'\n     hardcode_libdir_flag_spec='-R$libdir'\n     hardcode_shlibpath_var=no\n-    case \"$host_os\" in\n+    case $host_os in\n     solaris2.[0-5] | solaris2.[0-5].*) ;;\n     *) # Supported since Solaris 2.6 (maybe 2.5.1?)\n       whole_archive_flag_spec='-z allextract$convenience -z defaultextract' ;;\n@@ -542,22 +611,18 @@ else\n     ac_cv_prog_cc_wl='-Wl,'\n     ac_cv_prog_cc_static='-static'\n \n-    case \"$host_os\" in\n+    case $host_os in\n     beos* | irix5* | irix6* | osf3* | osf4* | osf5*)\n       # PIC is the default for these OSes.\n       ;;\n     aix*)\n-      # Below there is a dirty hack to force normal static linking with -ldl\n-      # The problem is because libdl dynamically linked with both libc and\n-      # libC (AIX C++ library), which obviously doesn't included in libraries\n-      # list by gcc. This cause undefined symbols with -static flags.\n-      # This hack allows C programs to be linked with \"-static -ldl\", but\n-      # we not sure about C++ programs.\n-      ac_cv_prog_cc_static=\"$ac_cv_prog_cc_static ${ac_cv_prog_cc_wl}-lC\"\n-      ;;\n-    *djgpp*)\n-      # DJGPP does not support shared libraries at all\n-      ac_cv_prog_cc_pic=\n+      # All AIX code is PIC.\n+      if test \"$host_cpu\" = ia64; then\n+        # AIX 5 now supports IA64 processor\n+        lt_cv_prog_cc_static='-Bstatic'\n+      else\n+        lt_cv_prog_cc_static='-bnso -bI:/lib/syscalls.exp'\n+      fi\n       ;;\n     cygwin* | mingw* | os2*)\n       # This hack is so that the source file can tell whether it is being\n@@ -581,10 +646,10 @@ else\n     esac\n   else\n     # PORTME Check for PIC flags for the system compiler.\n-    case \"$host_os\" in\n-    aix3* | aix4* | aix5*)\n+    case $host_os in\n+    aix*)\n      # All AIX code is PIC.\n-      ac_cv_prog_cc_static='-bnso -bI:/lib/syscalls.exp'\n+      ac_cv_prog_cc_static=\"$ac_cv_prog_cc_static ${ac_cv_prog_cc_wl}-lC\"\n       ;;\n \n     hpux9* | hpux10* | hpux11*)\n@@ -606,6 +671,11 @@ else\n       ac_cv_prog_cc_pic='-DDLL_EXPORT'\n       ;;\n \n+    newsos6)\n+      ac_cv_prog_cc_pic='-KPIC'\n+      ac_cv_prog_cc_static='-Bstatic'\n+      ;;\n+\n     osf3* | osf4* | osf5*)\n       # All OSF/1 code is PIC.\n       ac_cv_prog_cc_wl='-Wl,'\n@@ -653,21 +723,12 @@ else\n       ;;\n     esac\n   fi\n-  case \"$host_os\" in\n-      # Platforms which do not suport PIC and -DPIC is meaningless\n-      # on them:\n-      *djgpp*)\n-        ac_cv_prog_cc_pic=\n-        ;;\n-      *)\n-        ac_cv_prog_cc_pic=\"$ac_cv_prog_cc_pic -DPIC\"\n-        ;;\n-  esac\n+  ac_cv_prog_cc_pic=\"$ac_cv_prog_cc_pic -DPIC\"\n fi\n \n need_lc=yes\n if test \"$enable_shared\" = yes && test \"$with_gcc\" = yes; then\n-  case \"$archive_cmds\" in\n+  case $archive_cmds in\n   *'~'*)\n     # FIXME: we may have to deal with multi-command sequences.\n     ;;\n@@ -687,7 +748,7 @@ if test \"$enable_shared\" = yes && test \"$with_gcc\" = yes; then\n \tcat conftest.err 1>&5\n \tsoname=conftest\n \tlib=conftest\n-\tlibobjs=conftest.o\n+\tlibobjs=conftest.$ac_objext\n \tdeplibs=\n \twl=$ac_cv_prog_cc_wl\n \tcompiler_flags=-v"}, {"sha": "d7cdf6909b0b0cc355f03b7393fa34132357d662", "filename": "ltcf-cxx.sh", "status": "modified", "additions": 165, "deletions": 111, "changes": 276, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82e232360ddbe45a46588e80aa620eb416e2d6ee/ltcf-cxx.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82e232360ddbe45a46588e80aa620eb416e2d6ee/ltcf-cxx.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ltcf-cxx.sh?ref=82e232360ddbe45a46588e80aa620eb416e2d6ee", "patch": "@@ -73,9 +73,8 @@ if { ac_try='${CC-c++} -E conftest.$ac_ext'; { (eval echo \\\"$ac_try\\\") 1>&5; (ev\n       egrep 'GNU ld' > /dev/null; then\n     with_gnu_ld=yes\n \n-    archive_cmds='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${allow_undefined_flag} ${wl}-soname $wl$soname -o $lib'\n-    archive_expsym_cmds='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${allow_undefined_flag} ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'\n-    no_undefined_flag='${wl}--no-undefined'\n+    archive_cmds='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'\n+    archive_expsym_cmds='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'\n \n     hardcode_libdir_flag_spec='${wl}--rpath ${wl}$libdir'\n     export_dynamic_flag_spec='${wl}--export-dynamic'\n@@ -115,50 +114,110 @@ else\n   wlarc=\n fi\n \n-# In general, the C++ compiler should always link C++ objects.\n-case $target in\n-*aix3* | *aix4* | *aix5*)\n-  # AIX just has to be different, doesn't it? :-\\\n-  LD=makeC++SharedLib_r\n-  LDFLAGS=\"$LDFLAGS -p 0\"\n-  ;;\n-*)\n-  LD=\"$CC\"\n-  LDFLAGS=\"$LDFLAGS\"\n-  ;;\n-esac\n-\n-\n # PORTME: fill in a description of your system's C++ link characteristics\n-case \"$host_os\" in\n+case $host_os in\n   aix3*)\n     # FIXME: insert proper C++ library support\n     ld_shlibs=no\n     ;;\n   aix4* | aix5*)\n-    archive_expsym_cmds=\"\\$CC $shared_flag\"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}-bE:$export_symbols ${wl}-bnoentry${allow_undefined_flag}~$AR $AR_FLAGS $output_objdir/$libname$release.a $output_objdir/$soname'\n-    # -bexpall does not export symbols beginning with underscore (_)\n+    archive_cmds=''\n+    hardcode_direct=yes\n+    hardcode_libdir_separator=':'\n+    link_all_deplibs=yes\n+    # When large executables or shared objects are built, AIX ld can\n+    # have problems creating the table of contents.  If linking a library\n+    # or program results in \"error TOC overflow\" add -mminimal-toc to\n+    # CXXFLAGS/CFLAGS for g++/gcc.  In the cases where that is not\n+    # enough to fix the problem, add -Wl,-bbigtoc to LDFLAGS.\n+    if test \"$with_gcc\" = yes; then\n+      case $host_os in aix4.[012]|aix4.[012].*)\n+      # We only want to do this on AIX 4.2 and lower, the check\n+      # below for broken collect2 doesn't work under 4.3+\n+        collect2name=`${CC} -print-prog-name=collect2`\n+        if test -f \"$collect2name\" && \\\n+\t   strings \"$collect2name\" | grep resolve_lib_name >/dev/null\n+        then\n+\t  # We have reworked collect2\n+\t  hardcode_direct=yes\n+        else\n+\t  # We have old collect2\n+\t  hardcode_direct=unsupported\n+\t  # It fails to find uninstalled libraries when the uninstalled\n+\t  # path is not listed in the libpath.  Setting hardcode_minus_L\n+\t  # to unsupported forces relinking\n+\t  hardcode_minus_L=yes\n+\t  hardcode_libdir_flag_spec='-L$libdir'\n+\t  hardcode_libdir_separator=\n+        fi\n+      esac\n+      shared_flag='-shared'\n+    else\n+      # not using gcc\n+      if test \"$host_cpu\" = ia64; then\n+        shared_flag='${wl}-G'\n+      else\n+        shared_flag='${wl}-bM:SRE'\n+      fi\n+    fi\n+\n+    if test \"$host_cpu\" = ia64; then\n+      # On IA64, the linker does run time linking by default, so we don't\n+      # have to do anything special.\n+      aix_use_runtimelinking=no\n+      exp_sym_flag='-Bexport'\n+      no_entry_flag=\"\"\n+    else\n+      # Test if we are trying to use run time linking, or normal AIX style linking.\n+      # If -brtl is somewhere in LDFLAGS, we need to do run time linking.\n+      aix_use_runtimelinking=no\n+      for ld_flag in $LDFLAGS; do\n+        if (test $ld_flag = \"-brtl\" || test $ld_flag = \"-Wl,-brtl\" ); then\n+          aix_use_runtimelinking=yes\n+          break\n+        fi\n+      done\n+      exp_sym_flag='-bexport'\n+      no_entry_flag='-bnoentry'\n+    fi\n+    # It seems that -bexpall does not export symbols beginning with\n+    # underscore (_), so it is better to generate a list of symbols to export.\n     always_export_symbols=yes\n-    # Exported symbols can be pulled into shared objects from archives\n-    whole_archive_flag_spec=' '\n-    build_libtool_need_lc=yes\n-\n-    # We don't want to build shared libraries on unknown CPU types.\n-    case $host_cpu in\n-    powerpc | rs6000) ;;\n-    *) ld_shlibs=no ;;\n-    esac\n+    if test \"$aix_use_runtimelinking\" = yes; then\n+      hardcode_libdir_flag_spec='${wl}-blibpath:$libdir:/usr/lib:/lib'\n+      allow_undefined_flag=' -Wl,-G'\n+      archive_expsym_cmds=\"\\$CC $shared_flag\"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${allow_undefined_flag} '\"\\${wl}$no_entry_flag \\${wl}-brtl \\${wl}$exp_sym_flag:\\$export_symbols\"\n+     else\n+      if test \"$host_cpu\" = ia64; then\n+        hardcode_libdir_flag_spec='${wl}-R $libdir:/usr/lib:/lib'\n+        allow_undefined_flag=\"-z nodefs\"\n+        archive_expsym_cmds=\"\\$CC $shared_flag\"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}${allow_undefined_flag} '\"\\${wl}$no_entry_flag \\${wl}$exp_sym_flag:\\$export_symbols\"\n+      else\n+        hardcode_libdir_flag_spec='${wl}-blibpath:$libdir:/usr/lib:/lib'\n+        # Warning - without using the other run time loading flags, -berok will\n+        #           link without error, but may produce a broken library.\n+        no_undefined_flag='${wl}-bnoerok'\n+        allow_undefined_flag='${wl}-berok\"\n+        # -bexpall does not export symbols beginning with underscore (_)\n+        always_export_symbols=yes\n+        # Exported symbols can be pulled into shared objects from archives\n+        whole_archive_flag_spec=' '\n+        build_libtool_need_lc=yes\n+        # This is similar to how AIX traditionally builds it's shared libraries.\n+        archive_expsym_cmds=\"\\$CC $shared_flag\"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}-bE:$export_symbols ${wl}-bnoentry${allow_undefined_flag}~$AR $AR_FLAGS $output_objdir/$libname$release.a $output_objdir/$soname'\n+      fi\n+    fi\n     ;;\n   chorus*)\n-    case \"$cc_basename\" in\n+    case $cc_basename in\n       *)\n         # FIXME: insert proper C++ library support\n         ld_shlibs=no\n         ;;\n-    esac \n+    esac\n     ;;\n   dgux*)\n-    case \"$cc_basename\" in\n+    case $cc_basename in\n       ec++)\n         # FIXME: insert proper C++ library support\n         ld_shlibs=no\n@@ -174,33 +233,29 @@ case \"$host_os\" in\n         ;;\n     esac\n     ;;\n-  freebsd[12]*)\n-    # C++ shared libraries reported to be fairly broken before switch to ELF\n-    ld_shlibs=no\n-    ;;\n   freebsd*)\n-    # FreeBSD 3 and later use GNU C++ and GNU ld with standard ELF\n-    # conventions\n-    ld_shlibs=yes\n+    # FreeBSD uses GNU C++ and GNU ld\n+    # FIXME: insert proper C++ library support\n+    ld_shlibs=no\n     ;;\n   hpux*)\n-    case \"$cc_basename\" in\n+    hardcode_libdir_flag_spec='${wl}+b ${wl}$libdir'\n+    hardcode_libdir_separator=:\n+    hardcode_direct=yes\n+    hardcode_minus_L=yes # Not in the search PATH, but as the default\n+\t\t\t # location of the library.\n+    export_dynamic_flag_spec='${wl}-E'\n+\n+    case $cc_basename in\n       CC)\n         # FIXME: insert proper C++ library support\n         ld_shlibs=no\n         ;;\n       aCC)\n-\tcase \"$host_os\" in\n+\tcase $host_os in\n \thpux9*) archive_cmds='$rm $output_objdir/$soname~$CC -b ${wl}+b ${wl}$install_libdir -o $output_objdir/$soname $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib' ;;\n \t*) archive_cmds='$CC -b ${wl}+h ${wl}$soname ${wl}+b ${wl}$install_libdir -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags' ;;\n \tesac\n-\thardcode_libdir_flag_spec='${wl}+b ${wl}$libdir'\n-\thardcode_libdir_separator=:\n-\thardcode_direct=yes\n-\thardcode_minus_L=yes # Not in the search PATH, but as the default\n-\t\t\t     # location of the library.\n-\texport_dynamic_flag_spec='${wl}-E'\n-\n         # Commands to make compiler produce verbose output that lists\n         # what \"hidden\" libraries, object files and flags are used when\n         # linking a shared library.\n@@ -212,13 +267,20 @@ case \"$host_os\" in\n         output_verbose_link_cmds='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | egrep \"\\-L\"`; list=\"\"; for z in $templist; do case $z in conftest.$objext) list=\"$list $z\";; *.$objext);; *) list=\"$list $z\";;esac; done; echo $list'\n         ;;\n       *)\n-        # FIXME: insert proper C++ library support\n-        ld_shlibs=no\n+        if test $with_gcc = yes; then\n+\t  case \"$host_os\" in\n+\t  hpux9*) archive_cmds='$rm $output_objdir/$soname~$CC -shared -fPIC ${wl}+b ${wl}$install_libdir -o $output_objdir/$soname $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib' ;;\n+\t  *) archive_cmds='$CC -shared -fPIC ${wl}+h ${wl}$soname ${wl}+b ${wl}$install_libdir -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags' ;;\n+\t  esac\n+\telse\n+\t  # FIXME: insert proper C++ library support\n+          ld_shlibs=no\n+\tfi\n         ;;\n     esac\n     ;;\n   irix5* | irix6*)\n-    case \"$cc_basename\" in\n+    case $cc_basename in\n       CC)\n         # SGI C++\n         archive_cmds='$CC -shared -all -multigot $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -soname $soname `test -n \"$verstring\" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'\n@@ -234,7 +296,7 @@ case \"$host_os\" in\n           if test \"$with_gnu_ld\" = no; then\n             archive_cmds='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n \"$verstring\" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'\n           else\n-            archive_cmds='$LD -shared $predep_objects $libobjs $deplibs $postdep_objects $linker_flags -soname $soname `test -n \"$verstring\" && echo -set_version $verstring` -o $lib'\n+            archive_cmds='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $linker_flags -soname $soname `test -n \"$verstring\" && echo -set_version $verstring` -o $lib'\n           fi\n         fi\n         hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'\n@@ -244,7 +306,7 @@ case \"$host_os\" in\n     esac\n     ;;\n   linux*)\n-    case \"$cc_basename\" in\n+    case $cc_basename in\n       KCC)\n         # Kuck and Associates, Inc. (KAI) C++ Compiler\n \n@@ -301,7 +363,7 @@ case \"$host_os\" in\n     ld_shlibs=no\n     ;;\n   mvs*)\n-    case \"$cc_basename\" in\n+    case $cc_basename in\n       cxx)\n         # FIXME: insert proper C++ library support\n         ld_shlibs=no\n@@ -310,7 +372,7 @@ case \"$host_os\" in\n         # FIXME: insert proper C++ library support\n         ld_shlibs=no\n         ;;\n-    esac   \n+    esac\n     ;;\n   netbsd*)\n     # NetBSD uses g++ - do we need to do anything?\n@@ -329,7 +391,7 @@ case \"$host_os\" in\n       output_verbose_link_cmds='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | egrep \"\\-L\"'\n     fi\n \n-    case \"$cc_basename\" in\n+    case $cc_basename in\n       KCC)\n         # Kuck and Associates, Inc. (KAI) C++ Compiler\n \n@@ -388,7 +450,7 @@ case \"$host_os\" in\n       output_verbose_link_cmds='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | egrep \"\\-L\"'\n     fi\n \n-    case \"$cc_basename\" in\n+    case $cc_basename in\n       KCC)\n         # Kuck and Associates, Inc. (KAI) C++ Compiler\n \n@@ -410,10 +472,10 @@ case \"$host_os\" in\n         ld_shlibs=no\n         ;;\n       cxx)\n-        allow_undefined_flag=' ${wl}-expect_unresolved ${wl}\\*'\n-        archive_cmds='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-msym ${wl}-soname $soname `test -n \"$verstring\" && echo ${wl}-set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'\n-        \n-        hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'\n+        allow_undefined_flag=' -expect_unresolved \\*'\n+        archive_cmds='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname `test -n \"$verstring\" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'\n+\n+        hardcode_libdir_flag_spec='-rpath $libdir'\n         hardcode_libdir_separator=:\n \n         # Commands to make compiler produce verbose output that lists\n@@ -437,7 +499,7 @@ case \"$host_os\" in\n     ld_shlibs=no\n     ;;\n   sco*)\n-    case \"$cc_basename\" in\n+    case $cc_basename in\n       CC)\n         # FIXME: insert proper C++ library support\n         ld_shlibs=no\n@@ -449,7 +511,7 @@ case \"$host_os\" in\n     esac\n     ;;\n   sunos4*)\n-    case \"$cc_basename\" in\n+    case $cc_basename in\n       CC)\n         # Sun C++ 4.x\n         # FIXME: insert proper C++ library support\n@@ -467,7 +529,7 @@ case \"$host_os\" in\n     esac\n     ;;\n   solaris*)\n-    case \"$cc_basename\" in\n+    case $cc_basename in\n       CC)\n \t# Sun C++ 4.2, 5.x and Centerline C++\n         no_undefined_flag=' -ztext'\n@@ -477,7 +539,7 @@ case \"$host_os\" in\n \n         hardcode_libdir_flag_spec='-R$libdir'\n         hardcode_shlibpath_var=no\n-        case \"$host_os\" in\n+        case $host_os in\n           solaris2.[0-5] | solaris2.[0-5].*) ;;\n           *)\n             # The C++ compiler is used as linker so we must use $wl\n@@ -516,9 +578,9 @@ case \"$host_os\" in\n         # GNU C++ compiler with Solaris linker\n         if test \"$with_gcc\" = yes && test \"$with_gnu_ld\" = no; then\n           if $CC --version | egrep -v '^2\\.7' > /dev/null; then\n-            archive_cmds='$LD -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $linker_flags ${wl}-h $wl$soname -o $lib'\n+            archive_cmds='$CC -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $linker_flags ${wl}-h $wl$soname -o $lib'\n             archive_expsym_cmds='$echo \"{ global:\" > $lib.exp~cat $export_symbols | sed -e \"s/\\(.*\\)/\\1;/\" >> $lib.exp~$echo \"local: *; };\" >> $lib.exp~\n-\t\t$LD -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags~$rm $lib.exp'\n+\t\t$CC -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags~$rm $lib.exp'\n \n             # Commands to make compiler produce verbose output that lists\n             # what \"hidden\" libraries, object files and flags are used when\n@@ -527,9 +589,9 @@ case \"$host_os\" in\n           else\n             # g++ 2.7 appears to require `-G' NOT `-shared' on this\n             # platform.\n-            archive_cmds='$LD -G -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $linker_flags ${wl}-h $wl$soname -o $lib'\n+            archive_cmds='$CC -G -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $linker_flags ${wl}-h $wl$soname -o $lib'\n             archive_expsym_cmds='$echo \"{ global:\" > $lib.exp~cat $export_symbols | sed -e \"s/\\(.*\\)/\\1;/\" >> $lib.exp~$echo \"local: *; };\" >> $lib.exp~\n-\t\t$LD -G -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags~$rm $lib.exp'\n+\t\t$CC -G -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags~$rm $lib.exp'\n \n             # Commands to make compiler produce verbose output that lists\n             # what \"hidden\" libraries, object files and flags are used when\n@@ -540,10 +602,10 @@ case \"$host_os\" in\n           hardcode_libdir_flag_spec='${wl}-R $wl$libdir'\n         fi\n         ;;\n-    esac   \n+    esac\n     ;;\n   tandem*)\n-    case \"$cc_basename\" in\n+    case $cc_basename in\n       NCC)\n         # NonStop-UX NCC 3.20\n         # FIXME: insert proper C++ library support\n@@ -553,7 +615,7 @@ case \"$host_os\" in\n         # FIXME: insert proper C++ library support\n         ld_shlibs=no\n         ;;\n-    esac   \n+    esac\n     ;;\n   unixware*)\n     # FIXME: insert proper C++ library support\n@@ -588,22 +650,18 @@ if test \"$with_gcc\" = yes; then\n   ac_cv_prog_cc_wl='-Wl,'\n   ac_cv_prog_cc_static='-static'\n \n-  case \"$host_os\" in\n+  case $host_os in\n   beos* | irix5* | irix6* | osf3* | osf4* | osf5*)\n     # PIC is the default for these OSes.\n     ;;\n   aix*)\n-    # Below there is a dirty hack to force normal static linking with -ldl\n-    # The problem is because libdl dynamically linked with both libc and\n-    # libC (AIX C++ library), which obviously doesn't included in libraries\n-    # list by gcc. This cause undefined symbols with -static flags.\n-    # This hack allows C programs to be linked with \"-static -ldl\", but\n-    # we not sure about C++ programs.\n-    ac_cv_prog_cc_static=\"$ac_cv_prog_cc_static ${ac_cv_prog_cc_wl}-lC\"\n-    ;;\n-  *djgpp*)\n-    # DJGPP does not support shared libraries at all\n-    ac_cv_prog_cc_pic=\n+    # All AIX code is PIC.\n+    if test \"$host_cpu\" = ia64; then\n+      # AIX 5 now supports IA64 processor\n+      lt_cv_prog_cc_static='-Bstatic'\n+    else\n+      lt_cv_prog_cc_static='-bnso -bI:/lib/syscalls.exp'\n+    fi\n     ;;\n   cygwin* | mingw* | os2*)\n     # This hack is so that the source file can tell whether it is being\n@@ -626,20 +684,26 @@ if test \"$with_gcc\" = yes; then\n     ;;\n   esac\n else\n-  case \"$host_os\" in\n+  case $host_os in\n     aix4* | aix5*)\n       # All AIX code is PIC.\n+      if test \"$host_cpu\" = ia64; then\n+        # AIX 5 now supports IA64 processor\n+        lt_cv_prog_cc_static='-Bstatic'\n+      else\n+        lt_cv_prog_cc_static='-bnso -bI:/lib/syscalls.exp'\n+      fi\n       ;;\n     chorus*)\n-      case \"$cc_basename\" in\n+      case $cc_basename in\n       cxch68)\n         # Green Hills C++ Compiler\n         # ac_cv_prog_cc_static=\"--no_auto_instantiation -u __main -u __premain -u _abort -r $COOL_DIR/lib/libOrb.a $MVME_DIR/lib/CC/libC.a $MVME_DIR/lib/classix/libcx.s.a\"\n         ;;\n-      esac \n+      esac\n       ;;\n     dgux*)\n-      case \"$cc_basename\" in\n+      case $cc_basename in\n         ec++)\n           ac_cv_prog_cc_pic='-KPIC'\n           ;;\n@@ -655,7 +719,7 @@ else\n       # FreeBSD uses GNU C++\n       ;;\n     hpux9* | hpux10* | hpux11*)\n-      case \"$cc_basename\" in\n+      case $cc_basename in\n         CC)\n           ac_cv_prog_cc_wl='-Wl,'\n           ac_cv_prog_cc_static=\"${ac_cv_prog_cc_wl}-a ${ac_cv_prog_cc_wl}archive\"\n@@ -671,7 +735,7 @@ else\n       esac\n       ;;\n     irix5* | irix6*)\n-      case \"$cc_basename\" in\n+      case $cc_basename in\n         CC)\n           ac_cv_prog_cc_wl='-Wl,'\n           ac_cv_prog_cc_static='-non_shared'\n@@ -682,7 +746,7 @@ else\n       esac\n       ;;\n     linux*)\n-      case \"$cc_basename\" in\n+      case $cc_basename in\n         KCC)\n           # KAI C++ Compiler\n           ac_cv_prog_cc_wl='--backend -Wl,'\n@@ -704,18 +768,18 @@ else\n     m88k*)\n       ;;\n     mvs*)\n-      case \"$cc_basename\" in\n+      case $cc_basename in\n         cxx)\n           ac_cv_prog_cc_pic='-W c,exportall'\n           ;;\n         *)\n           ;;\n-      esac   \n+      esac\n       ;;\n     netbsd*)\n       ;;\n     osf3* | osf4* | osf5*)\n-      case \"$cc_basename\" in\n+      case $cc_basename in\n         KCC)\n           ac_cv_prog_cc_wl='--backend -Wl,'\n           ;;\n@@ -738,7 +802,7 @@ else\n     psos*)\n       ;;\n     sco*)\n-      case \"$cc_basename\" in\n+      case $cc_basename in\n         CC)\n           ac_cv_prog_cc_pic='-fPIC'\n           ;;\n@@ -747,7 +811,7 @@ else\n       esac\n       ;;\n     solaris*)\n-      case \"$cc_basename\" in\n+      case $cc_basename in\n         CC)\n           # Sun C++ 4.2, 5.x and Centerline C++\n           ac_cv_prog_cc_pic='-KPIC'\n@@ -760,10 +824,10 @@ else\n           ;;\n         *)\n           ;;\n-      esac   \n+      esac\n       ;;\n     sunos4*)\n-      case \"$cc_basename\" in\n+      case $cc_basename in\n         CC)\n           # Sun C++ 4.x\n           ac_cv_prog_cc_pic='-pic'\n@@ -778,14 +842,14 @@ else\n       esac\n       ;;\n     tandem*)\n-      case \"$cc_basename\" in\n+      case $cc_basename in\n         NCC)\n           # NonStop-UX NCC 3.20\n           ac_cv_prog_cc_pic='-KPIC'\n           ;;\n         *)\n           ;;\n-      esac   \n+      esac\n       ;;\n     unixware*)\n       ;;\n@@ -796,17 +860,7 @@ else\n       ;;\n   esac\n fi\n-\n-case \"$host_os\" in\n-    # Platforms which do not suport PIC and -DPIC is meaningless\n-    # on them:\n-    *djgpp*)\n-      ac_cv_prog_cc_pic=\n-      ;;\n-    *)\n-      ac_cv_prog_cc_pic=\"$ac_cv_prog_cc_pic -DPIC\"\n-      ;;\n-esac\n+ac_cv_prog_cc_pic=\"$ac_cv_prog_cc_pic -DPIC\"\n \n \n # Figure out \"hidden\" C++ library dependencies from verbose"}, {"sha": "cce8c22fe5a69a0d0009ac3a49c6bbd38acc46fa", "filename": "ltcf-gcj.sh", "status": "modified", "additions": 106, "deletions": 55, "changes": 161, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82e232360ddbe45a46588e80aa620eb416e2d6ee/ltcf-gcj.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82e232360ddbe45a46588e80aa620eb416e2d6ee/ltcf-gcj.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ltcf-gcj.sh?ref=82e232360ddbe45a46588e80aa620eb416e2d6ee", "patch": "@@ -41,7 +41,7 @@ lt_simple_compile_test_code=\"class foo {}\"\n lt_simple_link_test_code='public class conftest { public static void main(String[] argv) {}; }'\n \n ## Linker Characteristics\n-case \"$host_os\" in\n+case $host_os in\n cygwin* | mingw*)\n   # FIXME: the MSVC++ port hasn't been tested in a loooong time\n   # When not using gcc, we currently assume that we are using\n@@ -59,7 +59,7 @@ if test \"$with_gnu_ld\" = yes; then\n   wlarc='${wl}'\n \n   # See if GNU ld supports shared libraries.\n-  case \"$host_os\" in\n+  case $host_os in\n   aix3* | aix4*)\n     # On AIX, the GNU linker is very broken\n     ld_shlibs=no\n@@ -120,7 +120,7 @@ EOF\n     # FIXME: what about values for MSVC?\n     dll_entry=__cygwin_dll_entry@12\n     dll_exclude_symbols=DllMain@12,_cygwin_dll_entry@12,_cygwin_noncygwin_dll_entry@12~\n-    case \"$host_os\" in\n+    case $host_os in\n     mingw*)\n       # mingw values\n       dll_entry=_DllMainCRTStartup@12\n@@ -151,17 +151,23 @@ EOF\n       $DLLTOOL --export-all --exclude-symbols '$dll_exclude_symbols' --output-def $output_objdir/$soname-def '$ltdll_obj'$libobjs $convenience~\n       sed -e \"1,/EXPORTS/d\" -e \"s/ @ [0-9]*//\" -e \"s/ *;.*$//\" < $output_objdir/$soname-def > $export_symbols'\n \n+    # If the export-symbols file already is a .def file (1st line\n+    # is EXPORTS), use it as is.\n     # If DATA tags from a recent dlltool are present, honour them!\n-    archive_expsym_cmds='echo EXPORTS > $output_objdir/$soname-def~\n-      _lt_hint=1;\n-      cat $export_symbols | while read symbol; do\n-\tset dummy \\$symbol;\n-\tcase \\$# in\n-\t  2) echo \"\t\\$2 @ \\$_lt_hint ; \" >> $output_objdir/$soname-def;;\n-\t  *) echo \"     \\$2 @ \\$_lt_hint \\$3 ; \" >> $output_objdir/$soname-def;;\n-\tesac;\n-\t_lt_hint=`expr 1 + \\$_lt_hint`;\n-      done~\n+    archive_expsym_cmds='if test \"x`head -1 $export_symbols`\" = xEXPORTS; then\n+        cp $export_symbols $output_objdir/$soname-def;\n+      else\n+        echo EXPORTS > $output_objdir/$soname-def;\n+        _lt_hint=1;\n+        cat $export_symbols | while read symbol; do\n+         set dummy \\$symbol;\n+         case \\[$]# in\n+           2) echo \"   \\[$]2 @ \\$_lt_hint ; \" >> $output_objdir/$soname-def;;\n+           *) echo \"     \\[$]2 @ \\$_lt_hint \\[$]3 ; \" >> $output_objdir/$soname-def;;\n+         esac;\n+         _lt_hint=`expr 1 + \\$_lt_hint`;\n+        done;\n+      fi~\n       '\"$ltdll_cmds\"'\n       $CC -Wl,--base-file,$output_objdir/$soname-base '$lt_cv_gcj_dll_switch' -Wl,-e,'$dll_entry' -o $lib '$ltdll_obj'$libobjs $deplibs $compiler_flags~\n       $DLLTOOL --as=$AS --dllname $soname --exclude-symbols '$dll_exclude_symbols' --def $output_objdir/$soname-def --base-file $output_objdir/$soname-base --output-exp $output_objdir/$soname-exp~\n@@ -239,7 +245,7 @@ EOF\n   fi\n else\n   # PORTME fill in a description of your system's linker (not GNU ld)\n-  case \"$host_os\" in\n+  case $host_os in\n   aix3*)\n     allow_undefined_flag=unsupported\n     always_export_symbols=yes\n@@ -254,45 +260,91 @@ else\n     fi\n     ;;\n \n-  aix4*)\n-    hardcode_libdir_flag_spec='${wl}-b ${wl}nolibpath ${wl}-b ${wl}libpath:$libdir:/usr/lib:/lib'\n+  aix4* | aix5*)\n+    hardcode_direct=yes\n     hardcode_libdir_separator=':'\n+    link_all_deplibs=yes\n+    # When large executables or shared objects are built, AIX ld can\n+    # have problems creating the table of contents.  If linking a library\n+    # or program results in \"error TOC overflow\" add -mminimal-toc to\n+    # CXXFLAGS/CFLAGS for g++/gcc.  In the cases where that is not\n+    # enough to fix the problem, add -Wl,-bbigtoc to LDFLAGS.\n     if test \"$with_gcc\" = yes; then\n-      collect2name=`${CC} -print-prog-name=collect2`\n-      if test -f \"$collect2name\" && \\\n-\t strings \"$collect2name\" | grep resolve_lib_name >/dev/null\n-      then\n-\t# We have reworked collect2\n-\thardcode_direct=yes\n-      else\n-\t# We have old collect2\n-\thardcode_direct=unsupported\n-\t# It fails to find uninstalled libraries when the uninstalled\n-\t# path is not listed in the libpath.  Setting hardcode_minus_L\n-\t# to unsupported forces relinking\n-\thardcode_minus_L=yes\n-\thardcode_libdir_flag_spec='-L$libdir'\n-\thardcode_libdir_separator=\n-      fi\n+      case $host_os in aix4.[012]|aix4.[012].*)\n+      # We only want to do this on AIX 4.2 and lower, the check\n+      # below for broken collect2 doesn't work under 4.3+\n+        collect2name=`${CC} -print-prog-name=collect2`\n+        if test -f \"$collect2name\" && \\\n+\t   strings \"$collect2name\" | grep resolve_lib_name >/dev/null\n+        then\n+\t  # We have reworked collect2\n+\t  hardcode_direct=yes\n+        else\n+\t  # We have old collect2\n+\t  hardcode_direct=unsupported\n+\t  # It fails to find uninstalled libraries when the uninstalled\n+\t  # path is not listed in the libpath.  Setting hardcode_minus_L\n+\t  # to unsupported forces relinking\n+\t  hardcode_minus_L=yes\n+\t  hardcode_libdir_flag_spec='-L$libdir'\n+\t  hardcode_libdir_separator=\n+        fi\n+      esac\n       shared_flag='-shared'\n     else\n-      shared_flag='${wl}-bM:SRE'\n-      hardcode_direct=yes\n+      # not using gcc\n+      if test \"$host_cpu\" = ia64; then\n+        shared_flag='${wl}-G'\n+      else\n+        shared_flag='${wl}-bM:SRE'\n+      fi\n     fi\n-    allow_undefined_flag=' ${wl}-berok'\n-    archive_cmds=\"\\$CC $shared_flag\"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}-bexpall ${wl}-bnoentry${allow_undefined_flag}'\n-    archive_expsym_cmds=\"\\$CC $shared_flag\"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}-bE:$export_symbols ${wl}-bnoentry${allow_undefined_flag}'\n-    case \"$host_os\" in aix4.[01]|aix4.[01].*)\n-      # According to Greg Wooledge, -bexpall is only supported from AIX 4.2 on\n-      always_export_symbols=yes ;;\n-    esac\n \n-    # We don't want to build shared libraries on unknown CPU types.\n-    case $host_cpu in\n-    powerpc | rs6000) ;;\n-    *) ld_shlibs=no ;;\n-    esac\n-   ;;\n+    if test \"$host_cpu\" = ia64; then\n+      # On IA64, the linker does run time linking by default, so we don't\n+      # have to do anything special.\n+      aix_use_runtimelinking=no\n+      exp_sym_flag='-Bexport'\n+      no_entry_flag=\"\"\n+    else\n+      # Test if we are trying to use run time linking, or normal AIX style linking.\n+      # If -brtl is somewhere in LDFLAGS, we need to do run time linking.\n+      aix_use_runtimelinking=no\n+      for ld_flag in $LDFLAGS; do\n+        if (test $ld_flag = \"-brtl\" || test $ld_flag = \"-Wl,-brtl\" ); then\n+          aix_use_runtimelinking=yes\n+          break\n+        fi\n+      done\n+      exp_sym_flag='-bexport'\n+      no_entry_flag='-bnoentry'\n+    fi\n+    # -bexpall does not export symbols beginning with underscore (_)\n+    always_export_symbols=yes\n+    if test \"$aix_use_runtimelinking\" = yes; then\n+      # Warning - without using the other run time loading flags (-brtl), -berok will\n+      #           link without error, but may produce a broken library.\n+      allow_undefined_flag=' ${wl}-berok'\n+      hardcode_libdir_flag_spec='${wl}-blibpath:$libdir:/usr/lib:/lib'\n+      archive_expsym_cmds=\"\\$CC $shared_flag\"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${allow_undefined_flag} '\"\\${wl}$no_entry_flag \\${wl}$exp_sym_flag:\\$export_symbols\"\n+    else\n+      if test \"$host_cpu\" = ia64; then\n+        hardcode_libdir_flag_spec='${wl}-R $libdir:/usr/lib:/lib'\n+        allow_undefined_flag=\"-z nodefs\"\n+        archive_expsym_cmds=\"\\$CC $shared_flag\"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}${allow_undefined_flag} '\"\\${wl}$no_entry_flag \\${wl}$exp_sym_flag:\\$export_symbols\"\n+      else\n+        allow_undefined_flag=' ${wl}-berok'\n+        # -bexpall does not export symbols beginning with underscore (_)\n+        always_export_symbols=yes\n+        # Exported symbols can be pulled into shared objects from archives\n+        whole_archive_flag_spec=' '\n+        build_libtool_need_lc=yes\n+        hardcode_libdir_flag_spec='${wl}-blibpath:$libdir:/usr/lib:/lib'\n+        # This is similar to how AIX traditionally builds it's shared libraries.\n+        archive_expsym_cmds=\"\\$CC $shared_flag\"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}-bE:$export_symbols ${wl}-bnoentry${allow_undefined_flag}~$AR $AR_FLAGS $output_objdir/$libname$release.a $output_objdir/$soname'\n+      fi\n+    fi\n+  ;;\n \n   amigaos*)\n     archive_cmds='$rm $output_objdir/a2ixlibrary.data~$echo \"#define NAME $libname\" > $output_objdir/a2ixlibrary.data~$echo \"#define LIBRARY_ID 1\" >> $output_objdir/a2ixlibrary.data~$echo \"#define VERSION $major\" >> $output_objdir/a2ixlibrary.data~$echo \"#define REVISION $revision\" >> $output_objdir/a2ixlibrary.data~$AR $AR_FLAGS $lib $libobjs~$RANLIB $lib~(cd $output_objdir && a2ixlibrary -32)'\n@@ -317,7 +369,7 @@ else\n     old_archive_from_new_cmds='true'\n     # FIXME: Should let the user specify the lib program.\n     old_archive_cmds='lib /OUT:$oldlib$oldobjs$old_deplibs'\n-    fix_srcfile_path='`cygpath -w $srcfile`'\n+    fix_srcfile_path='`cygpath -w \"$srcfile\"`'\n     ;;\n \n   freebsd1*)\n@@ -352,7 +404,7 @@ else\n     ;;\n \n   hpux9* | hpux10* | hpux11*)\n-    case \"$host_os\" in\n+    case $host_os in\n     hpux9*) archive_cmds='$rm $output_objdir/$soname~$LD -b +b $install_libdir -o $output_objdir/$soname $libobjs $deplibs $linker_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib' ;;\n     *) archive_cmds='$LD -b +h $soname +b $install_libdir -o $lib $libobjs $deplibs $linker_flags' ;;\n     esac\n@@ -441,7 +493,7 @@ else\n \t\t$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'\n     hardcode_libdir_flag_spec='-R$libdir'\n     hardcode_shlibpath_var=no\n-    case \"$host_os\" in\n+    case $host_os in\n     solaris2.[0-5] | solaris2.[0-5].*) ;;\n     *) # Supported since Solaris 2.6 (maybe 2.5.1?)\n       whole_archive_flag_spec='-z allextract$convenience -z defaultextract' ;;\n@@ -539,7 +591,7 @@ fi\n     ac_cv_prog_cc_wl='-Wl,'\n     ac_cv_prog_cc_static='-static'\n \n-    case \"$host_os\" in\n+    case $host_os in\n     beos* | irix5* | irix6* | osf3* | osf4* | osf5*)\n       # PIC is the default for these OSes.\n       ;;\n@@ -552,10 +604,6 @@ fi\n       # we not sure about C++ programs.\n       ac_cv_prog_cc_static=\"$ac_cv_prog_cc_static ${ac_cv_prog_cc_wl}-lC\"\n       ;;\n-    *djgpp*)\n-      # DJGPP does not support shared libraries at all\n-      ac_cv_prog_cc_pic=\n-      ;;\n     cygwin* | mingw* | os2*)\n       # This hack is so that the source file can tell whether it is being\n       # built for inclusion in a dll (and should export symbols for example).\n@@ -579,3 +627,6 @@ fi\n \n # GCJ did not exist at the time GCC didn't implicitly link libc in.\n need_lc=no\n+\n+# All existing releases of GCJ support `-c -o'.\n+lt_cv_compiler_c_o=yes"}, {"sha": "739e6529ded21f3d96699077eb827239073bbf2d", "filename": "ltconfig", "status": "modified", "additions": 234, "deletions": 129, "changes": 363, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82e232360ddbe45a46588e80aa620eb416e2d6ee/ltconfig", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82e232360ddbe45a46588e80aa620eb416e2d6ee/ltconfig", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ltconfig?ref=82e232360ddbe45a46588e80aa620eb416e2d6ee", "patch": "@@ -1,7 +1,8 @@\n #! /bin/sh\n \n # ltconfig - Create a system-specific libtool.\n-# Copyright (C) 1996-2000 Free Software Foundation, Inc.\n+# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001\n+# Free Software Foundation, Inc.\n # Originally by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996\n #\n # This file is free software; you can redistribute it and/or modify it\n@@ -181,7 +182,7 @@ progname=`$echo \"X$0\" | $Xsed -e 's%^.*/%%'`\n PROGRAM=ltconfig\n PACKAGE=libtool\n VERSION=1.4a\n-TIMESTAMP=\" (1.641.2.122 2000/09/30 05:27:52)\"\n+TIMESTAMP=\" (1.641.2.198 2001/03/20 05:47:28)\"\n ac_compile='${CC-cc} -c $CFLAGS $CPPFLAGS conftest.$ac_ext 1>&5'\n ac_link='${CC-cc} -o conftest $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS 1>&5'\n rm=\"rm -f\"\n@@ -216,6 +217,7 @@ need_locks=yes\n ac_ext=c\n libext=a\n cache_file=\n+max_cmd_len=\n \n ## Dependencies to place before and after the object being linked:\n predep_objects=\n@@ -294,7 +296,7 @@ args=\n prev=\n for option\n do\n-  case \"$option\" in\n+  case $option in\n   -*=*) optarg=`echo \"$option\" | sed 's/[-_a-zA-Z0-9]*=//'` ;;\n   *) optarg= ;;\n   esac\n@@ -306,7 +308,7 @@ do\n     continue\n   fi\n \n-  case \"$option\" in\n+  case $option in\n   --help) cat <<EOM\n Usage: $progname [OPTION]... LTMAIN [HOST]\n \n@@ -422,8 +424,7 @@ fi\n \n if test -n \"$tagname\"; then\n   # Check whether tagname contains only valid characters\n-  case `$echo \"X$tagname\" |\n-        $Xsed -e 's/[-_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890,/]//g'` in\n+  case `$echo \"X$tagname\" | $Xsed -e 's/[-_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890,/]//g'` in\n   \"\") ;;\n   *)\n     echo \"$progname: invalid tag name: $tagname\" 1>&2\n@@ -454,7 +455,7 @@ fi\n ltconfig_args=\n for arg\n do\n-  case \"$arg\" in\n+  case $arg in\n   *\" \"*|*\"\t\"*|*[\\[\\]\\~\\#\\$\\^\\&\\*\\(\\)\\{\\}\\\\\\|\\;\\<\\>\\?]*)\n   ltconfig_args=\"$ltconfig_args '$arg'\" ;;\n   *) ltconfig_args=\"$ltconfig_args $arg\" ;;\n@@ -537,7 +538,7 @@ if test \"$verify_host\" = yes; then\n   echo $ac_n \"checking host system type\"\"... $ac_c\" 1>&6\n \n   host_alias=$host\n-  case \"$host_alias\" in\n+  case $host_alias in\n   \"\")\n     # Force config.guess to use the C compiler.\n     # CC_FOR_BUILD overrides the CC variable in config.guess but I had\n@@ -565,7 +566,7 @@ if test \"$verify_host\" = yes; then\n   echo $ac_n \"checking build system type... $ac_c\" 1>&6\n \n   build_alias=$build\n-  case \"$build_alias\" in\n+  case $build_alias in\n   NONE)\n     case $nonopt in\n     NONE) build_alias=$host_alias ;;\n@@ -600,12 +601,12 @@ host_vendor=`echo $host | sed 's/^\\([^-]*\\)-\\([^-]*\\)-\\(.*\\)$/\\2/'`\n host_os=`echo $host | sed 's/^\\([^-]*\\)-\\([^-]*\\)-\\(.*\\)$/\\3/'`\n \n # Transform linux* to *-*-linux-gnu*, to support old configure scripts.\n-case \"$host_os\" in\n+case $host_os in\n linux-gnu*) ;;\n linux*) host=`echo $host | sed 's/^\\(.*-.*-linux\\)\\(.*\\)$/\\1-gnu\\2/'`\n esac\n \n-case \"$host_os\" in\n+case $host_os in\n aix3*)\n   # AIX sometimes has problems with the GCC collect2 program.  For some\n   # reason, if we set the COLLECT_NAMES environment variable, the problems\n@@ -674,7 +675,7 @@ compiler=\"$2\"\n # in isolation, and that seeing it set (from the cache) indicates that\n # the associated values are set (in the cache) correctly too.\n echo $ac_n \"checking for $compiler option to produce PIC... $ac_c\" 1>&6\n-echo \"$progname:675:checking for $compiler option to produce PIC\" 1>&5\n+echo \"$progname:678:checking for $compiler option to produce PIC\" 1>&5\n \n if test -z \"$ac_cv_prog_cc_pic\"; then\n   echo \"$ac_t\"none 1>&6\n@@ -683,7 +684,7 @@ else\n \n   # Check to make sure the pic_flag actually works.\n   echo $ac_n \"checking if $compiler PIC flag $ac_cv_prog_cc_pic works... $ac_c\" 1>&6\n-  echo \"$progname:684:checking that $compiler PIC flag $ac_cv_prog_cc_pic works.\" 1>&5\n+  echo \"$progname:687:checking that $compiler PIC flag $ac_cv_prog_cc_pic works.\" 1>&5\n   if test \"X${ac_cv_prog_cc_pic_works+set}\" = Xset && \\\n      test \"X${ac_cv_prog_cc_pic_works}\" != X; then\n     echo $ac_n \"(cached) $ac_c\" 1>&6\n@@ -693,11 +694,11 @@ else\n     echo $lt_simple_compile_test_code > conftest.$ac_ext\n     save_CFLAGS=\"$CFLAGS\"\n     CFLAGS=\"$CFLAGS $ac_cv_prog_cc_pic -DPIC\"\n-    if { (eval echo $progname:694: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>conftest.err; } && test -s conftest.$objext; then\n+    if { (eval echo $progname:697: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>conftest.err; } && test -s conftest.$objext; then\n       # Append any warnings to the config.log.\n       cat conftest.err 1>&5\n \n-      case \"$host_os\" in\n+      case $host_os in\n       hpux9* | hpux10* | hpux11*)\n \t# On HP-UX, both CC and GCC only warn that PIC is supported... then\n \t# they create non-PIC objects.  So, if there were any warnings, we\n@@ -745,7 +746,7 @@ if test -n \"$ac_cv_prog_cc_shlib\"; then\n fi\n \n echo $ac_n \"checking if $compiler static flag $ac_cv_prog_cc_static works... $ac_c\" 1>&6\n-echo \"$progname:746: checking if $compiler static flag $ac_cv_prog_cc_static works\" >&5\n+echo \"$progname:749: checking if $compiler static flag $ac_cv_prog_cc_static works\" >&5\n if test \"X${ac_cv_prog_cc_static_works+set}\" = Xset && \\\n    test \"X${ac_cv_prog_cc_static_works}\" != X; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n@@ -754,7 +755,7 @@ else\n   echo $lt_simple_link_test_code > conftest.$ac_ext\n   save_LDFLAGS=\"$LDFLAGS\"\n   LDFLAGS=\"$LDFLAGS $ac_cv_prog_cc_static\"\n-  if { (eval echo $progname:755: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then\n+  if { (eval echo $progname:758: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then\n     ac_cv_prog_cc_static_works=yes\n   else\n     ac_cv_prog_cc_static_works=no\n@@ -775,47 +776,81 @@ link_static_flag=\"$ac_cv_prog_cc_static\"\n no_builtin_flag=\"$ac_cv_prog_cc_no_builtin\"\n can_build_shared=\"$ac_cv_prog_cc_can_build_shared\"\n \n+# find the maximum length of command line arguments\n+echo \"$progname:780: finding the maximum length of command line arguments\" 1>&5\n+echo $ac_n \"finding the maximum length of command line arguments... $ac_c\" 1>&6\n+if test \"${lt_cv_sys_max_cmd_len+set}\" = set; then\n+  echo $ac_n \"(cached) $ac_c\" 1>&6\n+else\n+  i=0\n+  testring=\"ABCDEF\"\n+  while test `$CONFIG_SHELL $0 --fallback-echo \"X$testring\" >/dev/null 2>&1` == `echo \"X$testring\" >/dev/null 2>&1` &&\n+          new_result=`expr \"X$testring\" : \".*\" 2>&1` &&\n+          lt_cv_sys_max_cmd_len=$new_result &&\n+          test $i != 32 # 1 MB should be enough\n+  do\n+    i=`expr $i + 1`\n+    testring=$testring$testring\n+  done\n+  testring=\n+  # add a significant safety factor because C++ compilers can tack on massive amounts\n+  # of additional arguments before passing them to the linker.  1/4 should be good.\n+  len=`expr $lt_cv_sys_max_cmd_len \\/ 4`\n+  lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len - $len`\n+fi\n+echo \"$progname:@lineno@: result: $lt_cv_sys_max_cmd_len\" 1>&5\n+echo \"${ac_t}$lt_cv_sys_max_cmd_len\" 1>&6\n+\n+if test -n $lt_cv_sys_max_cmd_len ; then\n+  max_cmd_len=$lt_cv_sys_max_cmd_len\n+else\n+  max_cmd_len=none\n+fi\n+\n # Check to see if options -o and -c are simultaneously supported by compiler\n echo $ac_n \"checking if $compiler supports -c -o file.$objext... $ac_c\" 1>&6\n-$rm -r conftest 2>/dev/null\n-mkdir conftest\n-cd conftest\n-$rm conftest*\n-echo $lt_simple_compile_test_code > conftest.$ac_ext\n-mkdir out\n-# According to Tom Tromey, Ian Lance Taylor reported there are C compilers\n-# that will create temporary files in the current directory regardless of\n-# the output directory.  Thus, making CWD read-only will cause this test\n-# to fail, enabling locking or at least warning the user not to do parallel\n-# builds.\n-chmod -w .\n-save_CFLAGS=\"$CFLAGS\"\n-CFLAGS=\"$CFLAGS -o out/conftest2.$objext\"\n-echo \"$progname:792: checking if $compiler supports -c -o file.$objext\" >&5\n-if { (eval echo $progname:793: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>out/conftest.err; } && test -s out/conftest2.$objext; then\n-\n-  # The compiler can only warn and ignore the option if not recognized\n-  # So say no if there are warnings\n-    if test -s out/conftest.err; then\n-      echo \"$ac_t\"no 1>&6\n-      compiler_c_o=no\n-    else\n-      echo \"$ac_t\"yes 1>&6\n-      compiler_c_o=yes\n-    fi\n+if test \"${lt_cv_compiler_c_o+set}\" = set; then\n+  echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n-  # Append any errors to the config.log.\n-  cat out/conftest.err 1>&5\n-  compiler_c_o=no\n-  echo \"$ac_t\"no 1>&6\n-fi\n-CFLAGS=\"$save_CFLAGS\"\n-chmod u+w .\n-$rm conftest* out/*\n-rmdir out\n-cd ..\n-rmdir conftest\n-$rm -r conftest 2>/dev/null\n+  $rm -r conftest 2>/dev/null\n+  mkdir conftest\n+  cd conftest\n+  $rm conftest*\n+  echo $lt_simple_compile_test_code > conftest.$ac_ext\n+  mkdir out\n+  # According to Tom Tromey, Ian Lance Taylor reported there are C compilers\n+  # that will create temporary files in the current directory regardless of\n+  # the output directory.  Thus, making CWD read-only will cause this test\n+  # to fail, enabling locking or at least warning the user not to do parallel\n+  # builds.\n+  chmod -w .\n+  save_CFLAGS=\"$CFLAGS\"\n+  CFLAGS=\"$CFLAGS -o out/conftest2.$objext\"\n+  echo \"$progname:829: checking if $compiler supports -c -o file.$objext\" >&5\n+  if { (eval echo $progname:830: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>out/conftest.err; } && test -s out/conftest2.$objext; then\n+\n+    # The compiler can only warn and ignore the option if not recognized\n+    # So say no if there are warnings\n+      if test -s out/conftest.err; then\n+        lt_cv_compiler_c_o=no\n+      else\n+        lt_cv_compiler_c_o=yes\n+      fi\n+  else\n+    # Append any errors to the config.log.\n+    cat out/conftest.err 1>&5\n+    lt_cv_compiler_c_o=no\n+  fi\n+  CFLAGS=\"$save_CFLAGS\"\n+  chmod u+w .\n+  $rm conftest* out/*\n+  rmdir out\n+  cd ..\n+  rmdir conftest\n+  $rm -r conftest 2>/dev/null\n+fi\n+compiler_c_o=$lt_cv_compiler_c_o\n+echo \"${ac_t}$compiler_c_o\" 1>&6\n \n # Check to see if we can do hard links to lock some files if needed\n hard_links=\"nottested\"\n@@ -845,8 +880,8 @@ if test \"$with_gcc\" = yes; then\n   echo $lt_simple_compile_test_code > conftest.$ac_ext\n   save_CFLAGS=\"$CFLAGS\"\n   CFLAGS=\"$CFLAGS -fno-rtti -fno-exceptions -c conftest.$ac_ext\"\n-  echo \"$progname:846: checking if $compiler supports -fno-rtti -fno-exceptions\" >&5\n-  if { (eval echo $progname:847: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>conftest.err; } && test -s conftest.$objext; then\n+  echo \"$progname:883: checking if $compiler supports -fno-rtti -fno-exceptions\" >&5\n+  if { (eval echo $progname:884: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>conftest.err; } && test -s conftest.$objext; then\n \n     # The compiler can only warn and ignore the option if not recognized\n     # So say no if there are warnings\n@@ -915,6 +950,10 @@ else\n   echo \"${ac_t}no\" 1>&6\n fi\n \n+case $reload_flag in\n+\"\" | \" \"*) ;;\n+*) reload_flag=\" $reload_flag\" ;;\n+esac\n reload_cmds='$LD$reload_flag -o $output$reload_objs'\n test -z \"$deplibs_check_method\" && deplibs_check_method=unknown\n \n@@ -934,27 +973,63 @@ sys_lib_dlsearch_path_spec=\"/lib /usr/lib\"\n sys_lib_search_path_spec=\"/lib /usr/lib /usr/local/lib\"\n \n echo $ac_n \"checking dynamic linker characteristics... $ac_c\" 1>&6\n-case \"$host_os\" in\n+case $host_os in\n aix3*)\n   version_type=linux\n   library_names_spec='${libname}${release}.so$versuffix $libname.a'\n   shlibpath_var=LIBPATH\n \n-  # AIX has no versioning support, so we append a major version to the name.\n+  # AIX 3 has no versioning support, so we append a major version to the name.\n   soname_spec='${libname}${release}.so$major'\n   ;;\n \n aix4* | aix5*)\n-  version_type=linux\n-  # AIX has no versioning support, so currently we can not hardcode correct\n-  # soname into executable. Probably we can add versioning support to\n-  # collect2, so additional links can be useful in future.\n-  # We preserve .a as extension for shared libraries though AIX4.2\n-  # and later linker supports .so\n-  library_names_spec='${libname}${release}.a $libname.a'\n-  shlibpath_var=LIBPATH\n-  soname_spec='${libname}${release}.so$major.o'\n-  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\\''{ if (((\\$2 == \"T\") || (\\$2 == \"D\") || (\\$2 == \"B\")) && (substr(\\$3,1,1) != \".\")) { print \\$3 } }'\\'' | sort -u > $export_symbols'\n+  if test \"$host_cpu\" = ia64; then\n+    # AIX 5 supports IA64\n+    library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'\n+    shlibpath_var=LD_LIBRARY_PATH\n+  else\n+    # AIX (on Power*) has no versioning support, so currently we can not hardcode correct\n+    # soname into executable. Probably we can add versioning support to\n+    # collect2, so additional links can be useful in future.\n+    # We preserve .a as extension for shared libraries though AIX4.2\n+    # and later linker supports .so\n+    if test \"$aix_use_runtimelinking\" = yes; then\n+      # If using run time linking (on AIX 4.2 or later) use lib<name>.so instead of\n+      # lib<name>.a to let people know that these are not typical AIX shared libraries.\n+      library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'\n+    else\n+      # We preserve .a as extension for shared libraries though AIX4.2\n+      # and later when we are not doing run time linking.\n+      library_names_spec='${libname}${release}.a $libname.a'\n+      soname_spec='${libname}${release}.so$major.o'\n+    fi\n+    # If we're using GNU nm, then we don't want the \"-C\" option.\n+    # -C means demangle to AIX nm, but means don't demangle with GNU nm\n+    if $NM -V 2>&1 | egrep '(GNU)' > /dev/null; then\n+      export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\\''{ if (((\\$2 == \"T\") || (\\$2 == \"D\") || (\\$2 == \"B\")) && (substr(\\$3,1,1) != \".\")) { print \\$3 } }'\\'' | sort -u > $export_symbols'\n+    else\n+      export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\\''{ if (((\\$2 == \"T\") || (\\$2 == \"D\") || (\\$2 == \"B\")) && (substr(\\$3,1,1) != \".\")) { print \\$3 } }'\\'' | sort -u > $export_symbols'\n+    fi\n+    shlibpath_var=LIBPATH\n+    deplibs_check_method=pass_all\n+    case $host_os in\n+    aix4 | aix4.[01] | aix4.[01].*)\n+      if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'\n+\t   echo ' yes '\n+\t   echo '#endif'; } | ${CC} -E - | grep yes > /dev/null; then\n+\t:\n+      else\n+\t# With GCC up to 2.95.x, collect2 would create an import file\n+\t# for dependence libraries.  The import file would start with\n+\t# the line `#! .'.  This would cause the generated library to\n+\t# depend on `.', always an invalid library.  This was fixed in\n+\t# development snapshots of GCC prior to 3.0.\n+        can_build_shared=no\n+      fi\n+      ;;\n+    esac\n+  fi\n   ;;\n \n amigaos*)\n@@ -991,30 +1066,48 @@ cygwin* | mingw* | pw32*)\n   version_type=windows\n   need_version=no\n   need_lib_prefix=no\n-  if test \"$with_gcc\" = yes; then\n+  case $with_gcc,$host_os in\n+  yes,cygwin*)\n+    library_names_spec='`echo ${libname} | sed -e 's/^lib/cyg/'``echo ${release} | sed -e 's/[.]/-/g'`${versuffix}.dll'\n+    ;;\n+  yes,mingw*)\n     library_names_spec='${libname}`echo ${release} | sed -e 's/[.]/-/g'`${versuffix}.dll'\n-  else\n+    sys_lib_search_path_spec=`$CC -print-search-dirs | grep \"^libraries:\" | sed -e \"s/^libraries://\" -e \"s/;/ /g\"`\n+    ;;\n+  yes,pw32*)\n+    library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | sed -e 's/[.]/-/g'`${versuffix}.dll'\n+;;\n+  *)\n     library_names_spec='${libname}`echo ${release} | sed -e 's/[.]/-/g'`${versuffix}.dll $libname.lib'\n-  fi\n+    ;;\n+  esac\n   dynamic_linker='Win32 ld.exe'\n   # FIXME: first we should search . and the directory the executable is in\n   shlibpath_var=PATH\n   lt_cv_dlopen=\"LoadLibrary\"\n   lt_cv_dlopen_libs=\n   ;;\n \n+darwin* | rhapsody*)\n+  library_names_spec='${libname}.`if test \"$module\" = \"yes\"; then echo so; else echo dylib; fi`'\n+  need_lib_prefix=no\n+  need_version=no\n+  postinstall_cmds='chmod +x $lib'\n+  shlibpath_overrides_runpath=yes\n+  shlibpath_var=DYLD_LIBRARY_PATH\n+  ;;\n+\n freebsd1*)\n   dynamic_linker=no\n   ;;\n \n freebsd*)\n   objformat=`test -x /usr/bin/objformat && /usr/bin/objformat || echo aout`\n   version_type=freebsd-$objformat\n-  case \"$version_type\" in\n+  case $version_type in\n     freebsd-elf*)\n       library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so $libname.so'\n       need_version=no\n-      need_lc=no\n       need_lib_prefix=no\n       ;;\n     freebsd-*)\n@@ -1023,7 +1116,7 @@ freebsd*)\n       ;;\n   esac\n   shlibpath_var=LD_LIBRARY_PATH\n-  case \"$host_os\" in\n+  case $host_os in\n   freebsd2*)\n     shlibpath_overrides_runpath=yes\n     ;;\n@@ -1065,12 +1158,12 @@ irix5* | irix6*)\n   need_version=no\n   soname_spec='${libname}${release}.so$major'\n   library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major ${libname}${release}.so $libname.so'\n-  case \"$host_os\" in\n+  case $host_os in\n   irix5*)\n     libsuff= shlibsuff=\n     ;;\n   *)\n-    case \"$LD\" in # libtool.m4 will add one of these switches to LD\n+    case $LD in # libtool.m4 will add one of these switches to LD\n     *-32|*\"-32 \") libsuff= shlibsuff= libmagic=32-bit;;\n     *-n32|*\"-n32 \") libsuff=32 shlibsuff=N32 libmagic=N32;;\n     *-64|*\"-64 \") libsuff=64 shlibsuff=64 libmagic=64-bit;;\n@@ -1129,6 +1222,13 @@ netbsd*)\n   hardcode_into_libs=yes\n   ;;\n \n+newsos6)\n+  version_type=linux\n+  library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'\n+  shlibpath_var=LD_LIBRARY_PATH\n+  shlibpath_overrides_runpath=yes\n+  ;;\n+\n openbsd*)\n   version_type=sunos\n   if test \"$with_gnu_ld\" = yes; then\n@@ -1195,7 +1295,7 @@ sysv4 | sysv4.2uw2* | sysv4.3* | sysv5*)\n   library_names_spec='${libname}${release}.so$versuffix ${libname}${release}.so$major $libname.so'\n   soname_spec='${libname}${release}.so$major'\n   shlibpath_var=LD_LIBRARY_PATH\n-  case \"$host_vendor\" in\n+  case $host_vendor in\n     motorola)\n       need_lib_prefix=no\n       need_version=no\n@@ -1256,7 +1356,7 @@ symxfrm='\\1 \\2\\3 \\3'\n global_symbol_to_cdecl=\"sed -n -e 's/^. .* \\(.*\\)$/extern char \\1;/p'\"\n \n # Define system-specific variables.\n-case \"$host_os\" in\n+case $host_os in\n aix*)\n   symcode='[BCDT]'\n   ;;\n@@ -1277,9 +1377,9 @@ sysv4)\n   ;;\n esac\n \n-# Handle CRLF in mingw tool chain\n+# Handle CRLF in mingw too chain\n opt_cr=\n-case \"$host_os\" in\n+case $host_os in\n mingw*)\n   opt_cr=`echo 'x\\{0,1\\}' | tr x '\\015'` # option cr in regexp\n   ;;\n@@ -1308,14 +1408,14 @@ void nm_test_func(){}\n #ifdef __cplusplus\n }\n #endif\n-main(){nm_test_var='a';nm_test_func();return(0);}\n+int main(){nm_test_var='a';nm_test_func();return(0);}\n EOF\n \n-  echo \"$progname:1309: checking if global_symbol_pipe works\" >&5\n-  if { (eval echo $progname:1310: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; } && test -s conftest.$objext; then\n+  echo \"$progname:1414: checking if global_symbol_pipe works\" >&5\n+  if { (eval echo $progname:1415: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; } && test -s conftest.$objext; then\n     # Now try to grab the symbols.\n     nlist=conftest.nm\n-    if { echo \"$progname:1313: eval \\\"$NM conftest.$objext | $global_symbol_pipe > $nlist\\\"\" >&5; eval \"$NM conftest.$objext | $global_symbol_pipe > $nlist 2>&5\"; } && test -s \"$nlist\"; then\n+    if { echo \"$progname:1418: eval \\\"$NM conftest.$objext | $global_symbol_pipe > $nlist\\\"\" >&5; eval \"$NM conftest.$objext | $global_symbol_pipe > $nlist 2>&5\"; } && test -s \"$nlist\"; then\n \n       # Try sorting and uniquifying the output.\n       if sort \"$nlist\" | uniq > \"$nlist\"T; then\n@@ -1367,7 +1467,7 @@ EOF\n \t  save_CFLAGS=\"$CFLAGS\"\n \t  LIBS=\"conftstm.$objext\"\n \t  CFLAGS=\"$CFLAGS$no_builtin_flag\"\n-\t  if { (eval echo $progname:1365: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then\n+\t  if { (eval echo $progname:1470: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then\n \t    pipe_works=yes\n \t  else\n \t    echo \"$progname: failed program was:\" >&5\n@@ -1411,7 +1511,7 @@ echo \"checking if libtool supports shared libraries... $can_build_shared\" 1>&6\n \n # Only try to build win32 dlls if AC_LIBTOOL_WIN32_DLL was used in\n # configure.in, otherwise build static only libraries.\n-case \"$host_os\" in\n+case $host_os in\n cygwin* | mingw* | pw32* | os2*)\n   if test x$can_build_shared = xyes; then\n     test x$enable_win32_dll = xno && can_build_shared=no\n@@ -1425,7 +1525,7 @@ test \"$can_build_shared\" = \"no\" && enable_shared=no\n \n # On AIX, shared libraries and static libraries use the same namespace, and\n # are all built from PIC.\n-case \"$host_os\" in\n+case $host_os in\n aix3*)\n   test \"$enable_shared\" = yes && enable_static=no\n   if test -n \"$RANLIB\"; then\n@@ -1434,7 +1534,7 @@ aix3*)\n   fi\n   ;;\n \n-aix4* | aix5*)\n+aix4*)\n   test \"$enable_shared\" = yes && enable_static=no\n   ;;\n esac\n@@ -1471,14 +1571,14 @@ else\n if test \"X${lt_cv_dlopen+set}\" != Xset; then\n   lt_cv_dlopen=no lt_cv_dlopen_libs=\n echo $ac_n \"checking for dlopen in -ldl\"\"... $ac_c\" 1>&6\n-echo \"$progname:1469: checking for dlopen in -ldl\" >&5\n+echo \"$progname:1574: checking for dlopen in -ldl\" >&5\n if test \"X${ac_cv_lib_dl_dlopen+set}\" = Xset; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   ac_save_LIBS=\"$LIBS\"\n LIBS=\"-ldl  $LIBS\"\n cat > conftest.$ac_ext <<EOF\n-#line 1476 \"ltconfig\"\n+#line 1581 \"ltconfig\"\n /* Override any gcc2 internal prototype to avoid an error.  */\n /* We use char because int might match the return type of a gcc2\n     builtin and then its argument prototype would still apply.  */\n@@ -1491,7 +1591,7 @@ int main() {\n dlopen()\n ; return 0; }\n EOF\n-if { (eval echo $progname:1489: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo $progname:1594: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_lib_dl_dlopen=yes\n else\n@@ -1510,12 +1610,12 @@ if test \"X$ac_cv_lib_dl_dlopen\" = Xyes; then\n else\n   echo \"$ac_t\"\"no\" 1>&6\n echo $ac_n \"checking for dlopen\"\"... $ac_c\" 1>&6\n-echo \"$progname:1508: checking for dlopen\" >&5\n+echo \"$progname:1613: checking for dlopen\" >&5\n if test \"X${ac_cv_func_dlopen+set}\" = Xset; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 1513 \"ltconfig\"\n+#line 1618 \"ltconfig\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char dlopen(); below.  */\n #include <assert.h>\n@@ -1540,7 +1640,7 @@ dlopen();\n \n ; return 0; }\n EOF\n-if { (eval echo $progname:1538: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo $progname:1643: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_func_dlopen=yes\n else\n@@ -1557,14 +1657,14 @@ if test \"X$ac_cv_func_dlopen\" = Xyes; then\n else\n   echo \"$ac_t\"\"no\" 1>&6\n echo $ac_n \"checking for dlopen in -lsvld\"\"... $ac_c\" 1>&6\n-echo \"$progname:1555: checking for dlopen in -lsvld\" >&5\n+echo \"$progname:1660: checking for dlopen in -lsvld\" >&5\n if test \"X${ac_cv_lib_svld_dlopen+set}\" = Xset; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   ac_save_LIBS=\"$LIBS\"\n LIBS=\"-lsvld  $LIBS\"\n cat > conftest.$ac_ext <<EOF\n-#line 1562 \"ltconfig\"\n+#line 1667 \"ltconfig\"\n /* Override any gcc2 internal prototype to avoid an error.  */\n /* We use char because int might match the return type of a gcc2\n     builtin and then its argument prototype would still apply.  */\n@@ -1577,7 +1677,7 @@ int main() {\n dlopen()\n ; return 0; }\n EOF\n-if { (eval echo $progname:1575: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo $progname:1680: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_lib_svld_dlopen=yes\n else\n@@ -1596,14 +1696,14 @@ if test \"X$ac_cv_lib_svld_dlopen\" = Xyes; then\n else\n   echo \"$ac_t\"\"no\" 1>&6\n echo $ac_n \"checking for dld_link in -ldld\"\"... $ac_c\" 1>&6\n-echo \"$progname:1594: checking for dld_link in -ldld\" >&5\n+echo \"$progname:1699: checking for dld_link in -ldld\" >&5\n if test \"X${ac_cv_lib_dld_dld_link+set}\" = Xset; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   ac_save_LIBS=\"$LIBS\"\n LIBS=\"-ldld  $LIBS\"\n cat > conftest.$ac_ext <<EOF\n-#line 1601 \"ltconfig\"\n+#line 1706 \"ltconfig\"\n /* Override any gcc2 internal prototype to avoid an error.  */\n /* We use char because int might match the return type of a gcc2\n     builtin and then its argument prototype would still apply.  */\n@@ -1616,7 +1716,7 @@ int main() {\n dld_link()\n ; return 0; }\n EOF\n-if { (eval echo $progname:1614: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo $progname:1719: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_lib_dld_dld_link=yes\n else\n@@ -1635,12 +1735,12 @@ if test \"X$ac_cv_lib_dld_dld_link\" = Xyes; then\n else\n   echo \"$ac_t\"\"no\" 1>&6\n echo $ac_n \"checking for shl_load\"\"... $ac_c\" 1>&6\n-echo \"$progname:1633: checking for shl_load\" >&5\n+echo \"$progname:1738: checking for shl_load\" >&5\n if test \"X${ac_cv_func_shl_load+set}\" = Xset; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 1638 \"ltconfig\"\n+#line 1743 \"ltconfig\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char shl_load(); below.  */\n #include <assert.h>\n@@ -1665,7 +1765,7 @@ shl_load();\n \n ; return 0; }\n EOF\n-if { (eval echo $progname:1663: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo $progname:1768: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_func_shl_load=yes\n else\n@@ -1683,14 +1783,14 @@ if test \"X$ac_cv_func_shl_load\" = Xyes; then\n else\n   echo \"$ac_t\"\"no\" 1>&6\n echo $ac_n \"checking for shl_load in -ldld\"\"... $ac_c\" 1>&6\n-echo \"$progname:1681: checking for shl_load in -ldld\" >&5\n+echo \"$progname:1786: checking for shl_load in -ldld\" >&5\n if test \"X${ac_cv_lib_dld_shl_load+set}\" = Xset; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   ac_save_LIBS=\"$LIBS\"\n LIBS=\"-ldld  $LIBS\"\n cat > conftest.$ac_ext <<EOF\n-#line 1688 \"ltconfig\"\n+#line 1793 \"ltconfig\"\n #include \"confdefs.h\"\n /* Override any gcc2 internal prototype to avoid an error.  */\n /* We use char because int might match the return type of a gcc2\n@@ -1704,7 +1804,7 @@ int main() {\n shl_load()\n ; return 0; }\n EOF\n-if { (eval echo $progname:1702: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo $progname:1807: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_lib_dld_shl_load=yes\n else\n@@ -1746,23 +1846,23 @@ fi\n     enable_dlopen=no\n   fi\n \n-  case \"$lt_cv_dlopen\" in\n+  case $lt_cv_dlopen in\n   dlopen)\n for ac_hdr in dlfcn.h; do\n ac_safe=`echo \"$ac_hdr\" | sed 'y%./+-%__p_%'`\n echo $ac_n \"checking for $ac_hdr\"\"... $ac_c\" 1>&6\n-echo \"$progname:1749: checking for $ac_hdr\" >&5\n+echo \"$progname:1854: checking for $ac_hdr\" >&5\n if eval \"test \\\"`echo 'X$''{'ac_cv_header_$ac_safe'+set}'`\\\" = Xset\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 1754 \"ltconfig\"\n+#line 1859 \"ltconfig\"\n #include <$ac_hdr>\n int fnord = 0;\n int main () { return(0); }\n EOF\n ac_try=\"$ac_compile >/dev/null 2>conftest.out\"\n-{ (eval echo $progname:1760: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo $progname:1865: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   rm -rf conftest*\n@@ -1790,15 +1890,15 @@ done\n     LIBS=\"$lt_cv_dlopen_libs $LIBS\"\n \n   echo $ac_n \"checking whether a program can dlopen itself\"\"... $ac_c\" 1>&6\n-echo \"$progname:1788: checking whether a program can dlopen itself\" >&5\n+echo \"$progname:1893: checking whether a program can dlopen itself\" >&5\n if test \"X${lt_cv_dlopen_self+set}\" = Xset; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     lt_cv_dlopen_self=cross\n   else\n     cat > conftest.$ac_ext <<EOF\n-#line 1796 \"ltconfig\"\n+#line 1901 \"ltconfig\"\n \n #if HAVE_DLFCN_H\n #include <dlfcn.h>\n@@ -1838,13 +1938,14 @@ else\n # endif\n #endif\n \n-fnord() { int i=42;}\n-main() { void *self, *ptr1, *ptr2; self=dlopen(0,LTDL_GLOBAL|LTDL_LAZY_OR_NOW);\n+void fnord() { int i=42; }\n+int main() {\n+    void *self, *ptr1, *ptr2; self=dlopen(0,LTDL_GLOBAL|LTDL_LAZY_OR_NOW);\n     if(self) { ptr1=dlsym(self,\"fnord\"); ptr2=dlsym(self,\"_fnord\");\n                if(ptr1 || ptr2) { dlclose(self); exit(0); } } exit(1); }\n \n EOF\n-if { (eval echo $progname:1842: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null\n+if { (eval echo $progname:1948: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null\n then\n   lt_cv_dlopen_self=yes\n else\n@@ -1863,15 +1964,15 @@ echo \"$ac_t\"\"$lt_cv_dlopen_self\" 1>&6\n   if test \"$lt_cv_dlopen_self\" = yes; then\n     LDFLAGS=\"$LDFLAGS $link_static_flag\"\n   echo $ac_n \"checking whether a statically linked program can dlopen itself\"\"... $ac_c\" 1>&6\n-echo \"$progname:1861: checking whether a statically linked program can dlopen itself\" >&5\n+echo \"$progname:1967: checking whether a statically linked program can dlopen itself\" >&5\n if test \"X${lt_cv_dlopen_self_static+set}\" = Xset; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     lt_cv_dlopen_self_static=cross\n   else\n     cat > conftest.$ac_ext <<EOF\n-#line 1869 \"ltconfig\"\n+#line 1975 \"ltconfig\"\n \n #if HAVE_DLFCN_H\n #include <dlfcn.h>\n@@ -1911,13 +2012,14 @@ else\n # endif\n #endif\n \n-fnord() { int i=42;}\n-main() { void *self, *ptr1, *ptr2; self=dlopen(0,LTDL_GLOBAL|LTDL_LAZY_OR_NOW);\n+void fnord() { int i=42; }\n+int main() {\n+    void *self, *ptr1, *ptr2; self=dlopen(0,LTDL_GLOBAL|LTDL_LAZY_OR_NOW);\n     if(self) { ptr1=dlsym(self,\"fnord\"); ptr2=dlsym(self,\"_fnord\");\n     if(ptr1 || ptr2) { dlclose(self); exit(0); } } exit(1); }\n \n EOF\n-if { (eval echo $progname:1915: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null\n+if { (eval echo $progname:2022: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null\n then\n   lt_cv_dlopen_self_static=yes\n else\n@@ -1936,12 +2038,12 @@ fi\n     ;;\n   esac\n \n-  case \"$lt_cv_dlopen_self\" in\n+  case $lt_cv_dlopen_self in\n   yes|no) enable_dlopen_self=$lt_cv_dlopen_self ;;\n   *) enable_dlopen_self=unknown ;;\n   esac\n \n-  case \"$lt_cv_dlopen_self_static\" in\n+  case $lt_cv_dlopen_self_static in\n   yes|no) enable_dlopen_self_static=$lt_cv_dlopen_self_static ;;\n   *) enable_dlopen_self_static=unknown ;;\n   esac\n@@ -1958,7 +2060,7 @@ LTSHELL=\"$SHELL\"\n LTCONFIG_VERSION=\"$VERSION\"\n \n # Only quote variables if we're using ltmain.sh.\n-case \"$ltmain\" in\n+case $ltmain in\n *.sh)\n   # Now quote all the things that may contain metacharacters.\n   for var in ltecho old_AR old_AR_FLAGS old_CC old_LTCC old_CFLAGS old_CPPFLAGS \\\n@@ -1983,7 +2085,7 @@ case \"$ltmain\" in\n     sys_lib_search_path_spec sys_lib_dlsearch_path_spec \\\n     compiler_c_o need_locks exclude_expsyms include_expsyms; do\n \n-    case \"$var\" in\n+    case $var in\n     reload_cmds | old_archive_cmds | old_archive_from_new_cmds | \\\n     old_postinstall_cmds | old_postuninstall_cmds | \\\n     export_symbols_cmds | archive_cmds | archive_expsym_cmds | \\\n@@ -1999,7 +2101,7 @@ case \"$ltmain\" in\n     esac\n   done\n \n-  case \"$ltecho\" in\n+  case $ltecho in\n   *'\\$0 --fallback-echo\"')\n     ltecho=`$echo \"X$ltecho\" | $Xsed -e 's/\\\\\\\\\\\\\\$0 --fallback-echo\"$/$0 --fallback-echo\"/'`\n     ;;\n@@ -2188,6 +2290,9 @@ exeext=\"$exeext\"\n pic_flag=$pic_flag\n pic_mode=$pic_mode\n \n+# What is the maximum length of a command?\n+max_cmd_len=$max_cmd_len\n+\n # Does compiler simultaneously support -c and -o options?\n compiler_c_o=$compiler_c_o\n \n@@ -2376,11 +2481,11 @@ else\n   echo \"### END LIBTOOL TAG CONFIG: $tagname\" >> \"$ofile\"\n fi\n \n-case \"$ltmain\" in\n+case $ltmain in\n *.sh)\n   echo >> \"$ofile\"\n   if test -z \"$tagname\"; then\n-    case \"$host_os\" in\n+    case $host_os in\n     aix3*)\n       cat <<\\EOF >> \"$ofile\"\n \n@@ -2394,7 +2499,7 @@ fi\n EOF\n       ;;\n     esac\n-    case \"$host\" in\n+    case $host in\n     *-*-cygwin* | *-*-mingw* | *-*-pw32* | *-*-os2*)\n       cat <<'EOF' >> \"$ofile\"\n       # This is a source program that is used to create dlls on Windows"}, {"sha": "b81cb285ed6394a180c15305153c9ec7b2f2ae07", "filename": "ltmain.sh", "status": "modified", "additions": 410, "deletions": 117, "changes": 527, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82e232360ddbe45a46588e80aa620eb416e2d6ee/ltmain.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82e232360ddbe45a46588e80aa620eb416e2d6ee/ltmain.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ltmain.sh?ref=82e232360ddbe45a46588e80aa620eb416e2d6ee", "patch": "@@ -1,7 +1,8 @@\n # ltmain.sh - Provide generalized library-building support services.\n # NOTE: Changing this file will not affect anything until you rerun ltconfig.\n #\n-# Copyright (C) 1996-2000, 2001 Free Software Foundation, Inc.\n+# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001\n+# Free Software Foundation, Inc.\n # Originally by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996\n #\n # This program is free software; you can redistribute it and/or modify\n@@ -55,7 +56,7 @@ modename=\"$progname\"\n PROGRAM=ltmain.sh\n PACKAGE=libtool\n VERSION=1.4a\n-TIMESTAMP=\" (1.641.2.122 2000/09/30 05:27:52)\"\n+TIMESTAMP=\" (1.641.2.198 2001/03/20 05:47:28)\"\n \n default_mode=\n help=\"Try \\`$progname --help' for more information.\"\n@@ -113,22 +114,22 @@ do\n   arg=\"$1\"\n   shift\n \n-  case \"$arg\" in\n+  case $arg in\n   -*=*) optarg=`$echo \"X$arg\" | $Xsed -e 's/[-_a-zA-Z0-9]*=//'` ;;\n   *) optarg= ;;\n   esac\n \n   # If the previous option needs an argument, assign it.\n   if test -n \"$prev\"; then\n-    case \"$prev\" in\n+    case $prev in\n     execute_dlfiles)\n-      eval \"$prev=\\\"\\$$prev \\$arg\\\"\"\n+      execute_dlfiles=\"$execute_dlfiles $arg\"\n       ;;\n     tag)\n       tagname=\"$arg\"\n \n       # Check whether tagname contains only valid characters\n-      case \"$tagname\" in\n+      case $tagname in\n       *[!-_A-Za-z0-9,/]*)\n \techo \"$progname: invalid tag name: $tagname\" 1>&2\n \texit 1\n@@ -154,7 +155,7 @@ do\n   fi\n \n   # Have we seen a non-optional argument yet?\n-  case \"$arg\" in\n+  case $arg in\n   --help)\n     show_help=yes\n     ;;\n@@ -241,12 +242,12 @@ if test -z \"$show_help\"; then\n \n   # Infer the operation mode.\n   if test -z \"$mode\"; then\n-    case \"$nonopt\" in\n+    case $nonopt in\n     *cc | *++ | gcc* | *-gcc*)\n       mode=link\n       for arg\n       do\n-\tcase \"$arg\" in\n+\tcase $arg in\n \t-c)\n \t   mode=compile\n \t   break\n@@ -291,7 +292,7 @@ if test -z \"$show_help\"; then\n   help=\"Try \\`$modename --help --mode=$mode' for more information.\"\n \n   # These modes are in order of execution frequency so that they run quickly.\n-  case \"$mode\" in\n+  case $mode in\n   # libtool compile mode\n   compile)\n     modename=\"$modename: compile\"\n@@ -305,14 +306,14 @@ if test -z \"$show_help\"; then\n     user_target=no\n     for arg\n     do\n-      case \"$prev\" in\n+      case $prev in\n       \"\") ;;\n       xcompiler)\n \t# Aesthetically quote the previous argument.\n \tprev=\n \tlastarg=`$echo \"X$arg\" | $Xsed -e \"$sed_quote_subst\"`\n \n-\tcase \"$arg\" in\n+\tcase $arg in\n \t# Double-quote args containing other shell metacharacters.\n \t# Many Bourne shells cannot handle close brackets correctly\n \t# in scan sets, so we specify it separately.\n@@ -332,7 +333,7 @@ if test -z \"$show_help\"; then\n       esac\n \n       # Accept any command-line options.\n-      case \"$arg\" in\n+      case $arg in\n       -o)\n \tif test \"$user_target\" != \"no\"; then\n \t  $echo \"$modename: you cannot specify \\`-o' more than once\" 1>&2\n@@ -371,7 +372,7 @@ if test -z \"$show_help\"; then\n \t  # Double-quote args containing other shell metacharacters.\n \t  # Many Bourne shells cannot handle close brackets correctly\n \t  # in scan sets, so we specify it separately.\n-\t  case \"$arg\" in\n+\t  case $arg in\n \t    *[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*|\"\")\n \t    arg=\"\\\"$arg\\\"\"\n \t    ;;\n@@ -391,7 +392,7 @@ if test -z \"$show_help\"; then\n \t;;\n       esac\n \n-      case \"$user_target\" in\n+      case $user_target in\n       next)\n \t# The next one is the -o target name\n \tuser_target=yes\n@@ -419,7 +420,7 @@ if test -z \"$show_help\"; then\n       # Double-quote args containing other shell metacharacters.\n       # Many Bourne shells cannot handle close brackets correctly\n       # in scan sets, so we specify it separately.\n-      case \"$lastarg\" in\n+      case $lastarg in\n       *[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*|\"\")\n \tlastarg=\"\\\"$lastarg\\\"\"\n \t;;\n@@ -433,7 +434,7 @@ if test -z \"$show_help\"; then\n       fi\n     done\n \n-    case \"$user_target\" in\n+    case $user_target in\n     set)\n       ;;\n     no)\n@@ -449,7 +450,7 @@ if test -z \"$show_help\"; then\n     # Recognize several different file suffixes.\n     # If the user specifies -o file.o, it is replaced with file.lo\n     xform='[cCFSfmso]'\n-    case \"$libobj\" in\n+    case $libobj in\n     *.ada) xform=ada ;;\n     *.adb) xform=adb ;;\n     *.ads) xform=ads ;;\n@@ -466,7 +467,7 @@ if test -z \"$show_help\"; then\n \n     libobj=`$echo \"X$libobj\" | $Xsed -e \"s/\\.$xform$/.lo/\"`\n \n-    case \"$libobj\" in\n+    case $libobj in\n     *.lo) obj=`$echo \"X$libobj\" | $Xsed -e \"$lo2o\"` ;;\n     *)\n       $echo \"$modename: cannot determine name of library object from \\`$libobj'\" 1>&2\n@@ -544,7 +545,7 @@ if test -z \"$show_help\"; then\n     trap \"$run $rm $removelist; exit 1\" 1 2 15\n \n     # On Cygwin there's no \"real\" PIC flag so we must build both object types\n-    case \"$host_os\" in\n+    case $host_os in\n     cygwin* | mingw* | pw32* | os2*)\n       pic_mode=default\n       ;;\n@@ -777,7 +778,7 @@ EOF\n   # libtool link mode\n   link | relink)\n     modename=\"$modename: link\"\n-    case \"$host\" in\n+    case $host in\n     *-*-cygwin* | *-*-mingw* | *-*-pw32* | *-*-os2*)\n       # It is impossible to link a dll without this setting, and\n       # we shouldn't force the makefile maintainer to figure out\n@@ -843,7 +844,7 @@ EOF\n     # We need to know -static, to get the right output filenames.\n     for arg\n     do\n-      case \"$arg\" in\n+      case $arg in\n       -all-static | -static)\n \tif test \"X$arg\" = \"X-all-static\"; then\n \t  if test \"$build_libtool_libs\" = yes && test -z \"$link_static_flag\"; then\n@@ -873,7 +874,7 @@ EOF\n       arg=\"$1\"\n       base_compile=\"$base_compile $arg\"\n       shift\n-      case \"$arg\" in\n+      case $arg in\n       *[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*|\"\")\n \tqarg=\\\"`$echo \"X$arg\" | $Xsed -e \"$sed_quote_subst\"`\\\" ### testsuite: skip nested quoting test\n \t;;\n@@ -883,22 +884,22 @@ EOF\n \n       # If the previous option needs an argument, assign it.\n       if test -n \"$prev\"; then\n-\tcase \"$prev\" in\n+\tcase $prev in\n \toutput)\n \t  compile_command=\"$compile_command @OUTPUT@\"\n \t  finalize_command=\"$finalize_command @OUTPUT@\"\n \t  ;;\n \tesac\n \n-\tcase \"$prev\" in\n+\tcase $prev in\n \tdlfiles|dlprefiles)\n \t  if test \"$preload\" = no; then\n \t    # Add the symbol object into the linking commands.\n \t    compile_command=\"$compile_command @SYMFILE@\"\n \t    finalize_command=\"$finalize_command @SYMFILE@\"\n \t    preload=yes\n \t  fi\n-\t  case \"$arg\" in\n+\t  case $arg in\n \t  *.la | *.lo) ;;  # We handle these cases below.\n \t  force)\n \t    if test \"$dlself\" = no; then\n@@ -950,9 +951,116 @@ EOF\n \t  prev=\n \t  continue\n \t  ;;\n+\tobjectlist)\n+\t  if test -f \"$arg\"; then\n+            save_arg=$arg\n+\t    moreargs=\n+\t    for fil in `cat $save_arg`\n+\t    do\n+#\t      moreargs=\"$moreargs $fil\"\n+              arg=$fil\n+              # A libtool-controlled object.\n+\n+\t      # Check to see that this really is a libtool object.\n+\t      if (sed -e '2q' $arg | egrep \"^# Generated by .*$PACKAGE\") >/dev/null 2>&1; then\n+                pic_object=\n+                non_pic_object=\n+\n+                # Read the .lo file\n+                # If there is no directory component, then add one.\n+                case $arg in\n+                */* | *\\\\*) . $arg ;;\n+                *) . ./$arg ;;\n+                esac\n+\n+                if test -z \"$pic_object\" || \\\n+                   test -z \"$non_pic_object\" ||\n+                   test \"$pic_object\" = none && \\\n+                   test \"$non_pic_object\" = none; then\n+                  $echo \"$modename: cannot find name of object for \\`$arg'\" 1>&2\n+                  exit 1\n+                fi\n+\n+\t        # Extract subdirectory from the argument.\n+\t        xdir=`$echo \"X$arg\" | $Xsed -e 's%/[^/]*$%%'`\n+\t        if test \"X$xdir\" = \"X$arg\"; then\n+\t          xdir=\n+\t        else\n+\t          xdir=\"$xdir/\"\n+\t        fi\n+\n+                if test \"$pic_object\" != none; then\n+                  # Prepend the subdirectory the object is found in.\n+\t          pic_object=\"$xdir$pic_object\"\n+\n+\t          if test \"$prev\" = dlfiles; then\n+\t            if test \"$build_libtool_libs\" = yes && test \"$dlopen_support\" = yes; then\n+\t              dlfiles=\"$dlfiles $pic_object\"\n+\t              prev=\n+\t              continue\n+\t            else\n+\t              # If libtool objects are unsupported, then we need to preload.\n+\t              prev=dlprefiles\n+\t            fi\n+\t          fi\n+\n+\t          # CHECK ME:  I think I busted this.  -Ossama\n+                  if test \"$prev\" = dlprefiles; then\n+\t            # Preload the old-style object.\n+\t            dlprefiles=\"$dlprefiles $pic_object\"\n+\t            prev=\n+                  fi\n+\n+                  # A PIC object.\n+\t          libobjs=\"$libobjs $pic_object\"\n+\t          arg=\"$pic_object\"\n+                fi\n+\n+                # Non-PIC object.\n+                if test \"$non_pic_object\" != none; then\n+                  # Prepend the subdirectory the object is found in.\n+\t          non_pic_object=\"$xdir$non_pic_object\"\n+\n+                  # A standard non-PIC object\n+                  non_pic_objects=\"$non_pic_objects $non_pic_object\"\n+                  if test -z \"$pic_object\" || test \"$pic_object\" = none ; then\n+                    arg=\"$non_pic_object\"\n+                  fi\n+                fi\n+              else\n+                # Only an error if not doing a dry-run.\n+                if test -z \"$run\"; then\n+                  $echo \"$modename: \\`$arg' is not a valid libtool object\" 1>&2\n+                  exit 1\n+                else\n+                  # Dry-run case.\n+\n+\t          # Extract subdirectory from the argument.\n+\t          xdir=`$echo \"X$arg\" | $Xsed -e 's%/[^/]*$%%'`\n+\t          if test \"X$xdir\" = \"X$arg\"; then\n+\t            xdir=\n+\t          else\n+\t            xdir=\"$xdir/\"\n+\t          fi\n+\n+                  pic_object=`$echo \"X${xdir}${objdir}/${arg}\" | $Xsed -e \"$lo2o\"`\n+                  non_pic_object=`$echo \"X${xdir}${arg}\" | $Xsed -e \"$lo2o\"`\n+\t          libobjs=\"$libobjs $pic_object\"\n+                  non_pic_objects=\"$non_pic_objects $non_pic_object\"\n+                fi\n+\t      fi\n+\t    done\n+\t  else\n+\t    $echo \"$modename: link input file \\`$save_arg' does not exist\"\n+\t    exit 1\n+\t  fi\n+          arg=$save_arg\n+\t  prev=\n+\t  continue\n+\t  ;;\n \trpath | xrpath)\n \t  # We need an absolute path.\n-\t  case \"$arg\" in\n+\t  case $arg in\n \t  [\\\\/]* | [A-Za-z]:[\\\\/]*) ;;\n \t  *)\n \t    $echo \"$modename: only absolute run-paths are allowed\" 1>&2\n@@ -998,7 +1106,7 @@ EOF\n \n       prevarg=\"$arg\"\n \n-      case \"$arg\" in\n+      case $arg in\n       -all-static)\n \tif test -n \"$link_static_flag\"; then\n \t  compile_command=\"$compile_command $link_static_flag\"\n@@ -1061,7 +1169,7 @@ EOF\n       -L*)\n \tdir=`$echo \"X$arg\" | $Xsed -e 's/^-L//'`\n \t# We need an absolute path.\n-\tcase \"$dir\" in\n+\tcase $dir in\n \t[\\\\/]* | [A-Za-z]:[\\\\/]*) ;;\n \t*)\n \t  absdir=`cd \"$dir\" && pwd`\n@@ -1079,9 +1187,9 @@ EOF\n \t  lib_search_path=\"$lib_search_path $dir\"\n \t  ;;\n \tesac\n-\tcase \"$host\" in\n+\tcase $host in\n \t*-*-cygwin* | *-*-mingw* | *-*-pw32* | *-*-os2*)\n-\t  case \":$dllsearchpath:\" in\n+\t  case :$dllsearchpath: in\n \t  *\":$dir:\"*) ;;\n \t  *) dllsearchpath=\"$dllsearchpath:$dir\";;\n \t  esac\n@@ -1092,18 +1200,26 @@ EOF\n \n       -l*)\n \tif test \"$arg\" = \"-lc\"; then\n-\t  case \"$host\" in\n+\t  case $host in\n \t  *-*-cygwin* | *-*-mingw* | *-*-pw32* | *-*-os2* | *-*-beos*)\n \t    # These systems don't actually have c library (as such)\n \t    continue\n \t    ;;\n+\t  *-*-rhapsody* | *-*-darwin*)\n+\t    # Darwin C library is in the System framework\n+\t    deplibs=\"$deplibs -framework System\"\n+\t    ;;\n \t  esac\n \telif test \"$arg\" = \"-lm\"; then\n-\t  case \"$host\" in\n+\t  case $host in\n \t  *-*-cygwin* | *-*-pw32* | *-*-beos*)\n \t    # These systems don't actually have math library (as such)\n \t    continue\n \t    ;;\n+\t  *-*-rhapsody* | *-*-darwin*)\n+\t    # Darwin math library is in the System framework\n+\t    deplibs=\"$deplibs -framework System\"\n+\t    ;;\n \t  esac\n \tfi\n \tdeplibs=\"$deplibs $arg\"\n@@ -1121,16 +1237,16 @@ EOF\n \t;;\n \n       -no-install)\n-\tcase \"$host\" in\n+\tcase $host in\n \t*-*-cygwin* | *-*-mingw* | *-*-pw32* | *-*-os2*)\n \t  # The PATH hackery in wrapper scripts is required on Windows\n \t  # in order for the loader to find any dlls it needs.\n \t  $echo \"$modename: warning: \\`-no-install' is ignored for $host\" 1>&2\n \t  $echo \"$modename: warning: assuming \\`-no-fast-install' instead\" 1>&2\n \t  fast_install=no\n \t  ;;\n-\t*-*-rhapsody*)\n-\t  # rhapsody is a little odd...\n+\t*-*-rhapsody* | *-*-darwin*)\n+\t  # Darwin C library is in the System framework\n \t  deplibs=\"$deplibs -framework System\"\n \t  ;;\n \t*)\n@@ -1145,6 +1261,11 @@ EOF\n \tcontinue\n \t;;\n \n+      -objectlist)\n+\tprev=objectlist\n+\tcontinue\n+\t;;\n+\n       -o) prev=output ;;\n \n       -release)\n@@ -1165,7 +1286,7 @@ EOF\n       -R*)\n \tdir=`$echo \"X$arg\" | $Xsed -e 's/^-R//'`\n \t# We need an absolute path.\n-\tcase \"$dir\" in\n+\tcase $dir in\n \t[\\\\/]* | [A-Za-z]:[\\\\/]*) ;;\n \t*)\n \t  $echo \"$modename: only absolute run-paths are allowed\" 1>&2\n@@ -1204,7 +1325,7 @@ EOF\n \tIFS=\"${IFS= \t}\"; save_ifs=\"$IFS\"; IFS=','\n \tfor flag in $args; do\n \t  IFS=\"$save_ifs\"\n-\t  case \"$flag\" in\n+\t  case $flag in\n \t    *[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*|\"\")\n \t    flag=\"\\\"$flag\\\"\"\n \t    ;;\n@@ -1222,7 +1343,7 @@ EOF\n \tIFS=\"${IFS= \t}\"; save_ifs=\"$IFS\"; IFS=','\n \tfor flag in $args; do\n \t  IFS=\"$save_ifs\"\n-\t  case \"$flag\" in\n+\t  case $flag in\n \t    *[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*|\"\")\n \t    flag=\"\\\"$flag\\\"\"\n \t    ;;\n@@ -1250,7 +1371,7 @@ EOF\n \t# Unknown arguments in both finalize_command and compile_command need\n \t# to be aesthetically quoted because they are evaled later.\n \targ=`$echo \"X$arg\" | $Xsed -e \"$sed_quote_subst\"`\n-\tcase \"$arg\" in\n+\tcase $arg in\n \t*[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*|\"\")\n \t  arg=\"\\\"$arg\\\"\"\n \t  ;;\n@@ -1272,7 +1393,7 @@ EOF\n \n           # Read the .lo file\n           # If there is no directory component, then add one.\n-          case \"$arg\" in\n+          case $arg in\n           */* | *\\\\*) . $arg ;;\n           *) . ./$arg ;;\n           esac\n@@ -1384,7 +1505,7 @@ EOF\n \t# Unknown arguments in both finalize_command and compile_command need\n \t# to be aesthetically quoted because they are evaled later.\n \targ=`$echo \"X$arg\" | $Xsed -e \"$sed_quote_subst\"`\n-\tcase \"$arg\" in\n+\tcase $arg in\n \t*[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*|\"\")\n \t  arg=\"\\\"$arg\\\"\"\n \t  ;;\n@@ -1486,7 +1607,7 @@ EOF\n     fi\n \n     # Determine the type of output\n-    case \"$output\" in\n+    case $output in\n     \"\")\n       $echo \"$modename: you must specify an output file\" 1>&2\n       $echo \"$help\" 1>&2\n@@ -1523,7 +1644,7 @@ EOF\n     lib)\n \tpasses=\"conv link\"\n \tfor file in $dlfiles $dlprefiles; do\n-\t  case \"$file\" in\n+\t  case $file in\n \t  *.la) ;;\n \t  *)\n \t    $echo \"$modename: libraries can \\`-dlopen' only libtool libraries: $file\" 1>&2\n@@ -1564,7 +1685,7 @@ EOF\n       for deplib in $libs; do\n \tlib=\n \tfound=no\n-\tcase \"$deplib\" in\n+\tcase $deplib in\n \t-l*)\n \t  if test $linkmode != lib && test $linkmode != prog; then\n \t    $echo \"$modename: warning: \\`-l' is ignored for archives/objects\" 1>&2\n@@ -1714,7 +1835,7 @@ EOF\n \tinstalled=yes\n \n \t# Read the .la file\n-\tcase \"$lib\" in\n+\tcase $lib in\n \t*/* | *\\\\*) . $lib ;;\n \t*) . ./$lib ;;\n \tesac\n@@ -1769,17 +1890,19 @@ EOF\n \t    exit 1\n \t  fi\n \t  if test -z \"$dlname\" || test \"$dlopen_support\" != yes || test \"$build_libtool_libs\" = no; then\n-\t    # If there is no dlname, no dlopen support or we're linking statically,\n-\t    # we need to preload.\n-\t    dlprefiles=\"$dlprefiles $lib\"\n+\t    # If there is no dlname, no dlopen support or we're linking\n+\t    # statically, we need to preload.  We also need to preload any\n+\t    # dependent libraries so libltdl's deplib preloader doesn't\n+\t    # bomb out in the load deplibs phase.\n+\t    dlprefiles=\"$dlprefiles $lib $dependency_libs\"\n \t  else\n \t    newdlfiles=\"$newdlfiles $lib\"\n \t  fi\n \t  continue\n \tfi\n \n \t# We need an absolute path.\n-\tcase \"$ladir\" in\n+\tcase $ladir in\n \t[\\\\/]* | [A-Za-z]:[\\\\/]*) abs_ladir=\"$ladir\" ;;\n \t*)\n \t  abs_ladir=`cd \"$ladir\" && pwd`\n@@ -1854,7 +1977,7 @@ EOF\n \n \t  tmp_libs=\n \t  for deplib in $dependency_libs; do\n-\t    case \"$deplib\" in\n+\t    case $deplib in\n \t    -L*) newlib_search_path=\"$newlib_search_path \"`$echo \"X$deplib\" | $Xsed -e 's/^-L//'`;; ### testsuite: skip nested quoting test\n \t    esac\n \t    # Need to link against all dependency_libs?\n@@ -2003,12 +2126,12 @@ EOF\n \t    add_dir=\n \t    add=\n \t    lib_linked=yes\n-\t    case \"$hardcode_action\" in\n+\t    case $hardcode_action in\n \t    immediate | unsupported)\n \t      if test \"$hardcode_direct\" = no; then\n \t\tadd=\"$dir/$linklib\"\n \t      elif test \"$hardcode_minus_L\" = no; then\n-\t\tcase \"$host\" in\n+\t\tcase $host in\n \t\t*-*-sunos*) add_shlibpath=\"$dir\" ;;\n \t\tesac\n \t\tadd_dir=\"-L$dir\"\n@@ -2042,7 +2165,7 @@ EOF\n \t    fi\n \n \t    if test -n \"$add_shlibpath\"; then\n-\t      case \":$compile_shlibpath:\" in\n+\t      case :$compile_shlibpath: in\n \t      *\":$add_shlibpath:\"*) ;;\n \t      *) compile_shlibpath=\"$compile_shlibpath$add_shlibpath:\" ;;\n \t      esac\n@@ -2056,7 +2179,7 @@ EOF\n \t      if test \"$hardcode_direct\" != yes && \\\n \t\t test \"$hardcode_minus_L\" != yes && \\\n \t\t test \"$hardcode_shlibpath_var\" = yes; then\n-\t\tcase \":$finalize_shlibpath:\" in\n+\t\tcase :$finalize_shlibpath: in\n \t\t*\":$libdir:\"*) ;;\n \t\t*) finalize_shlibpath=\"$finalize_shlibpath$libdir:\" ;;\n \t\tesac\n@@ -2075,7 +2198,7 @@ EOF\n \t      add_dir=\"-L$libdir\"\n \t      add=\"-l$name\"\n \t    elif test \"$hardcode_shlibpath_var\" = yes; then\n-\t      case \":$finalize_shlibpath:\" in\n+\t      case :$finalize_shlibpath: in\n \t      *\":$libdir:\"*) ;;\n \t      *) finalize_shlibpath=\"$finalize_shlibpath$libdir:\" ;;\n \t      esac\n@@ -2133,7 +2256,7 @@ EOF\n \t    # Extract -R from dependency_libs\n \t    temp_deplibs=\n \t    for libdir in $dependency_libs; do\n-\t      case \"$libdir\" in\n+\t      case $libdir in\n \t      -R*) temp_xrpath=`$echo \"X$libdir\" | $Xsed -e 's/^-R//'`\n \t\t   case \" $xrpath \" in\n \t\t   *\" $temp_xrpath \"*) ;;\n@@ -2161,13 +2284,13 @@ EOF\n \t  if test $link_all_deplibs != no; then\n \t    # Add the search paths of all dependency libraries\n \t    for deplib in $dependency_libs; do\n-\t      case \"$deplib\" in\n+\t      case $deplib in\n \t      -L*) path=\"$deplib\" ;;\n \t      *.la)\n \t\tdir=`$echo \"X$deplib\" | $Xsed -e 's%/[^/]*$%%'`\n \t\ttest \"X$dir\" = \"X$deplib\" && dir=\".\"\n \t\t# We need an absolute path.\n-\t\tcase \"$dir\" in\n+\t\tcase $dir in\n \t\t[\\\\/]* | [A-Za-z]:[\\\\/]*) absdir=\"$dir\" ;;\n \t\t*)\n \t\t  absdir=`cd \"$dir\" && pwd`\n@@ -2232,7 +2355,7 @@ EOF\n \t  eval tmp_libs=\\\"\\$$var\\\"\n \t  new_libs=\n \t  for deplib in $tmp_libs; do\n-\t    case \"$deplib\" in\n+\t    case $deplib in\n \t    -L*) new_libs=\"$deplib $new_libs\" ;;\n \t    *)\n \t      case \" $specialdeplibs \" in\n@@ -2249,7 +2372,7 @@ EOF\n \t  done\n \t  tmp_libs=\n \t  for deplib in $new_libs; do\n-\t    case \"$deplib\" in\n+\t    case $deplib in\n \t    -L*)\n \t      case \" $tmp_libs \" in\n \t      *\" $deplib \"*) ;;\n@@ -2306,7 +2429,7 @@ EOF\n \n     lib)\n       # Make sure we only generate libraries of the form `libNAME.la'.\n-      case \"$outputname\" in\n+      case $outputname in\n       lib*)\n \tname=`$echo \"X$outputname\" | $Xsed -e 's/\\.la$//' -e 's/^lib//'`\n \teval libname=\\\"$libname_spec\\\"\n@@ -2386,7 +2509,7 @@ EOF\n \tage=\"$4\"\n \n \t# Check that each of the things are valid numbers.\n-\tcase \"$current\" in\n+\tcase $current in\n \t0 | [1-9] | [1-9][0-9]*) ;;\n \t*)\n \t  $echo \"$modename: CURRENT \\`$current' is not a nonnegative integer\" 1>&2\n@@ -2395,7 +2518,7 @@ EOF\n \t  ;;\n \tesac\n \n-\tcase \"$revision\" in\n+\tcase $revision in\n \t0 | [1-9] | [1-9][0-9]*) ;;\n \t*)\n \t  $echo \"$modename: REVISION \\`$revision' is not a nonnegative integer\" 1>&2\n@@ -2404,7 +2527,7 @@ EOF\n \t  ;;\n \tesac\n \n-\tcase \"$age\" in\n+\tcase $age in\n \t0 | [1-9] | [1-9][0-9]*) ;;\n \t*)\n \t  $echo \"$modename: AGE \\`$age' is not a nonnegative integer\" 1>&2\n@@ -2423,7 +2546,7 @@ EOF\n \tmajor=\n \tversuffix=\n \tverstring=\n-\tcase \"$version_type\" in\n+\tcase $version_type in\n \tnone) ;;\n \n \tirix)\n@@ -2531,7 +2654,7 @@ EOF\n         removelist=\n         tempremovelist=`echo \"$output_objdir/*\"`\n \tfor p in $tempremovelist; do\n-          case \"$p\" in\n+          case $p in\n             *.$objext)\n                ;;\n             $output_objdir/$outputname | $output_objdir/$libname.* | $output_objdir/${libname}${release}.*)\n@@ -2598,7 +2721,7 @@ EOF\n \n       if test \"$build_libtool_libs\" = yes; then\n \tif test -n \"$rpath\"; then\n-\t  case \"$host\" in\n+\t  case $host in\n \t  *-*-cygwin* | *-*-mingw* | *-*-pw32* | *-*-os2* | *-*-beos*)\n \t    # these systems don't actually have a c library (as such)!\n \t    ;;\n@@ -2625,7 +2748,7 @@ EOF\n \tmajor=\"\"\n \tnewdeplibs=\n \tdroppeddeps=no\n-\tcase \"$deplibs_check_method\" in\n+\tcase $deplibs_check_method in\n \tpass_all)\n \t  # Don't check for shared/static.  Everything works.\n \t  # This might be a little naive.  We might want to check\n@@ -2650,7 +2773,7 @@ EOF\n \t    for i in $deplibs; do\n \t      name=\"`expr $i : '-l\\(.*\\)'`\"\n \t      # If $name is empty we are operating on a -L argument.\n-\t      if test \"$name\" != \"\" ; then\n+\t      if test \"$name\" != \"\" -a \"$name\" != \"0\"; then\n \t\tlibname=`eval \\\\$echo \\\"$libname_spec\\\"`\n \t\tdeplib_matches=`eval \\\\$echo \\\"$library_names_spec\\\"`\n \t\tset dummy $deplib_matches\n@@ -2675,7 +2798,7 @@ EOF\n \t    for i in $deplibs; do\n \t      name=\"`expr $i : '-l\\(.*\\)'`\"\n \t     # If $name is empty we are operating on a -L argument.\n-\t      if test \"$name\" != \"\" ; then\n+\t      if test \"$name\" != \"\" -a \"$name\" != \"0\"; then\n \t\t$rm conftest\n \t\t$LTCC -o conftest conftest.c $i\n \t\t# Did it work?\n@@ -2715,7 +2838,7 @@ EOF\n \t  for a_deplib in $deplibs; do\n \t    name=\"`expr $a_deplib : '-l\\(.*\\)'`\"\n \t    # If $name is empty we are operating on a -L argument.\n-\t    if test \"$name\" != \"\" ; then\n+\t    if test \"$name\" != \"\" -a \"$name\" != \"0\"; then\n \t      libname=`eval \\\\$echo \\\"$libname_spec\\\"`\n \t      for i in $lib_search_path $sys_lib_search_path $shlib_search_path; do\n \t\t    potential_libs=`ls $i/$libname[.-]* 2>/dev/null`\n@@ -2733,7 +2856,7 @@ EOF\n \t\t      potlib=\"$potent_lib\"\n \t\t      while test -h \"$potlib\" 2>/dev/null; do\n \t\t\tpotliblink=`ls -ld $potlib | sed 's/.* -> //'`\n-\t\t\tcase \"$potliblink\" in\n+\t\t\tcase $potliblink in\n \t\t\t[\\\\/]* | [A-Za-z]:[\\\\/]*) potlib=\"$potliblink\";;\n \t\t\t*) potlib=`$echo \"X$potlib\" | $Xsed -e 's,[^/]*$,,'`\"$potliblink\";;\n \t\t\tesac\n@@ -2808,6 +2931,21 @@ EOF\n \t    echo \"*** The inter-library dependencies that have been dropped here will be\"\n \t    echo \"*** automatically added whenever a program is linked with this library\"\n \t    echo \"*** or is declared to -dlopen it.\"\n+\n+\t    if test $allow_undefined = no; then\n+\t      echo\n+\t      echo \"*** Since this library must not contain undefined symbols,\"\n+\t      echo \"*** because either the platform does not support them or\"\n+\t      echo \"*** it was explicitly requested with -no-undefined,\"\n+\t      echo \"*** libtool will only create a static version of it.\"\n+\t      if test \"$build_old_libs\" = no; then\n+\t\toldlibs=\"$output_objdir/$libname.$libext\"\n+\t\tbuild_libtool_libs=module\n+\t\tbuild_old_libs=yes\n+\t      else\n+\t\tbuild_libtool_libs=no\n+\t      fi\n+\t    fi\n \t  fi\n \tfi\n \t# Done checking deplibs!\n@@ -2834,7 +2972,7 @@ EOF\n \t\t  hardcode_libdirs=\"$libdir\"\n \t\telse\n \t\t  # Just accumulate the unique libdirs.\n-\t\t  case \"$hardcode_libdir_separator$hardcode_libdirs$hardcode_libdir_separator\" in\n+\t\t  case $hardcode_libdir_separator$hardcode_libdirs$hardcode_libdir_separator in\n \t\t  *\"$hardcode_libdir_separator$libdir$hardcode_libdir_separator\"*)\n \t\t    ;;\n \t\t  *)\n@@ -2943,6 +3081,7 @@ EOF\n \n \tif test -n \"$convenience\"; then\n \t  if test -n \"$whole_archive_flag_spec\"; then\n+\t    save_libobjs=$libobjs\n \t    eval libobjs=\\\"\\$libobjs $whole_archive_flag_spec\\\"\n \t  else\n \t    gentop=\"$output_objdir/${outputname}x\"\n@@ -2958,7 +3097,7 @@ EOF\n \n \t    for xlib in $convenience; do\n \t      # Extract the objects.\n-\t      case \"$xlib\" in\n+\t      case $xlib in\n \t      [\\\\/]* | [A-Za-z]:[\\\\/]*) xabs=\"$xlib\" ;;\n \t      *) xabs=`pwd`\"/$xlib\" ;;\n \t      esac\n@@ -2997,13 +3136,115 @@ EOF\n \telse\n \t  eval cmds=\\\"$archive_cmds\\\"\n \tfi\n-\tIFS=\"${IFS= \t}\"; save_ifs=\"$IFS\"; IFS='~'\n-\tfor cmd in $cmds; do\n-\t  IFS=\"$save_ifs\"\n-\t  $show \"$cmd\"\n-\t  $run eval \"$cmd\" || exit $?\n-\tdone\n-\tIFS=\"$save_ifs\"\n+        if len=`expr \"X$cmds\" : \".*\"` &&\n+           test $len -le $max_cmd_len; then\n+          :\n+        else\n+\t  # The command line is too long to link in one step, link piecewise.\n+          $echo \"creating reloadable object files...\"\n+\n+\t  # Save the value of $output and $libobjs because we want to\n+\t  # use them later.  If we have whole_archive_flag_spec, we\n+\t  # want to use save_libobjs as it was before\n+\t  # whole_archive_flag_spec was expanded, because we can't\n+\t  # assume the linker understands whole_archive_flag_spec.\n+\t  # This may have to be revisited, in case too many\n+\t  # convenience libraries get linked in and end up exceeding\n+\t  # the spec.\n+\t  if test -z \"$convenience\" || test -z \"$whole_archive_flag_spec\"; then\n+\t    save_libobjs=$libobjs\n+\t  fi\n+          save_output=$output\n+\n+\t  # Clear the reloadable object creation command queue and\n+\t  # initialize k to one.\n+          test_cmds=\n+          concat_cmds=\n+          objlist=\n+          delfiles=\n+          last_robj=\n+          k=1\n+          output=$output_objdir/$save_output-${k}.$objext\n+\t  # Loop over the list of objects to be linked.\n+          for obj in $save_libobjs\n+          do\n+            eval test_cmds=\\\"$reload_cmds $objlist $last_robj\\\"\n+            if test \"X$objlist\" = X ||\n+\t       { len=`expr \"X$test_cmds\" : \".*\"` &&\n+                 test $len -le $max_cmd_len; }; then\n+              objlist=\"$objlist $obj\"\n+            else\n+\t      # The command $test_cmds is almost too long, add a\n+\t      # command to the queue.\n+              if test $k -eq 1 ; then\n+\t        # The first file doesn't have a previous command to add.\n+                eval concat_cmds=\\\"$reload_cmds $objlist $last_robj\\\"\n+              else\n+\t        # All subsequent reloadable object files will link in\n+\t        # the last one created.\n+                eval concat_cmds=\\\"\\$concat_cmds~$reload_cmds $objlist $last_robj\\\"\n+              fi\n+              last_robj=$output_objdir/$save_output-${k}.$objext\n+              k=`expr $k + 1`\n+              output=$output_objdir/$save_output-${k}.$objext\n+              objlist=$obj\n+              len=1\n+            fi\n+          done\n+\t  # Handle the remaining objects by creating one last\n+\t  # reloadable object file.  All subsequent reloadable object\n+\t  # files will link in the last one created.\n+\t  test -z \"$concat_cmds\" || concat_cmds=$concat_cmds~\n+          eval concat_cmds=\\\"\\${concat_cmds}$reload_cmds $objlist $last_robj\\\"\n+\n+\t  # Set up a command to remove the reloadale object files\n+\t  # after they are used.\n+          i=0\n+          while test $i -lt $k\n+          do\n+            i=`expr $i + 1`\n+            delfiles=\"$delfiles $output_objdir/$save_output-${i}.$objext\"\n+          done\n+\n+          $echo \"creating a temporary reloadable object file: $output\"\n+\n+\t  # Loop through the commands generated above and execute them.\n+          IFS=\"${IFS= \t}\"; save_ifs=\"$IFS\"; IFS='~'\n+          for cmd in $concat_cmds; do\n+            IFS=\"$save_ifs\"\n+            $show \"$cmd\"\n+            $run eval \"$cmd\" || exit $?\n+          done\n+          IFS=\"$save_ifs\"\n+\n+          libobjs=$output\n+\t  # Restore the value of output.\n+          output=$save_output\n+\n+\t  if test -n \"$convenience\" && test -n \"$whole_archive_flag_spec\"; then\n+\t    eval libobjs=\\\"\\$libobjs $whole_archive_flag_spec\\\"\n+\t  fi\n+\t  # Expand the library linking commands again to reset the\n+\t  # value of $libobjs for piecewise linking.\n+\n+\t  # Do each of the archive commands.\n+          if test -n \"$export_symbols\" && test -n \"$archive_expsym_cmds\"; then\n+            eval cmds=\\\"$archive_expsym_cmds\\\"\n+          else\n+            eval cmds=\\\"$archive_cmds\\\"\n+          fi\n+\n+\t  # Append the command to remove the reloadable object files\n+\t  # to the just-reset $cmds.\n+          eval cmds=\\\"\\$cmds~$rm $delfiles\\\"\n+        fi\n+        IFS=\"${IFS= \t}\"; save_ifs=\"$IFS\"; IFS='~'\n+        for cmd in $cmds; do\n+          IFS=\"$save_ifs\"\n+          $show \"$cmd\"\n+          $run eval \"$cmd\" || exit $?\n+        done\n+        IFS=\"$save_ifs\"\n \n \t# Restore the uninstalled library and exit\n \tif test \"$mode\" = relink; then\n@@ -3052,7 +3293,7 @@ EOF\n \t$echo \"$modename: warning: \\`-release' is ignored for objects\" 1>&2\n       fi\n \n-      case \"$output\" in\n+      case $output in\n       *.lo)\n \tif test -n \"$objs$old_deplibs\"; then\n \t  $echo \"$modename: cannot build library object \\`$output' from non-libtool objects\" 1>&2\n@@ -3097,7 +3338,7 @@ EOF\n \n \t  for xlib in $convenience; do\n \t    # Extract the objects.\n-\t    case \"$xlib\" in\n+\t    case $xlib in\n \t    [\\\\/]* | [A-Za-z]:[\\\\/]*) xabs=\"$xlib\" ;;\n \t    *) xabs=`pwd`\"/$xlib\" ;;\n \t    esac\n@@ -3232,7 +3473,7 @@ EOF\n \t      hardcode_libdirs=\"$libdir\"\n \t    else\n \t      # Just accumulate the unique libdirs.\n-\t      case \"$hardcode_libdir_separator$hardcode_libdirs$hardcode_libdir_separator\" in\n+\t      case $hardcode_libdir_separator$hardcode_libdirs$hardcode_libdir_separator in\n \t      *\"$hardcode_libdir_separator$libdir$hardcode_libdir_separator\"*)\n \t\t;;\n \t      *)\n@@ -3250,9 +3491,9 @@ EOF\n \t  *) perm_rpath=\"$perm_rpath $libdir\" ;;\n \t  esac\n \tfi\n-\tcase \"$host\" in\n+\tcase $host in\n \t*-*-cygwin* | *-*-mingw* | *-*-pw32* | *-*-os2*)\n-\t  case \":$dllsearchpath:\" in\n+\t  case :$dllsearchpath: in\n \t  *\":$libdir:\"*) ;;\n \t  *) dllsearchpath=\"$dllsearchpath:$libdir\";;\n \t  esac\n@@ -3276,7 +3517,7 @@ EOF\n \t      hardcode_libdirs=\"$libdir\"\n \t    else\n \t      # Just accumulate the unique libdirs.\n-\t      case \"$hardcode_libdir_separator$hardcode_libdirs$hardcode_libdir_separator\" in\n+\t      case $hardcode_libdir_separator$hardcode_libdirs$hardcode_libdir_separator in\n \t      *\"$hardcode_libdir_separator$libdir$hardcode_libdir_separator\"*)\n \t\t;;\n \t      *)\n@@ -3313,7 +3554,7 @@ EOF\n       fi\n \n       if test -n \"$dlsyms\"; then\n-\tcase \"$dlsyms\" in\n+\tcase $dlsyms in\n \t\"\") ;;\n \t*.c)\n \t  # Discover the nlist of each of the dlfiles.\n@@ -3444,7 +3685,7 @@ static const void *lt_preloaded_setup() {\n \t  fi\n \n \t  pic_flag_for_symtable=\n-\t  case \"$host\" in\n+\t  case $host in\n \t  # compiling the symbol table file with pic_flag works around\n \t  # a FreeBSD bug that causes programs to crash when -lm is\n \t  # linked before any other PIC object.  But we must not use\n@@ -3512,7 +3753,7 @@ static const void *lt_preloaded_setup() {\n \t# We should set the shlibpath_var\n \trpath=\n \tfor dir in $temp_rpath; do\n-\t  case \"$dir\" in\n+\t  case $dir in\n \t  [\\\\/]* | [A-Za-z]:[\\\\/]*)\n \t    # Absolute path.\n \t    rpath=\"$rpath$dir:\"\n@@ -3620,7 +3861,7 @@ static const void *lt_preloaded_setup() {\n \n       # Quote $echo for shipping.\n       if test \"X$echo\" = \"X$SHELL $0 --fallback-echo\"; then\n-\tcase \"$0\" in\n+\tcase $0 in\n \t[\\\\/]* | [A-Za-z]:[\\\\/]*) qecho=\"$SHELL $0 --fallback-echo\";;\n \t*) qecho=\"$SHELL `pwd`/$0 --fallback-echo\";;\n \tesac\n@@ -3859,7 +4100,7 @@ fi\\\n \t# Add in members from convenience archives.\n \tfor xlib in $addlibs; do\n \t  # Extract the objects.\n-\t  case \"$xlib\" in\n+\t  case $xlib in\n \t  [\\\\/]* | [A-Za-z]:[\\\\/]*) xabs=\"$xlib\" ;;\n \t  *) xabs=`pwd`\"/$xlib\" ;;\n \t  esac\n@@ -3903,7 +4144,39 @@ fi\\\n #\t  fi\n #\tdone\n \n-\teval cmds=\\\"$old_archive_cmds\\\"\n+        eval cmds=\\\"$old_archive_cmds\\\"\n+\n+        if len=`expr \"X$cmds\" : \".*\"` &&\n+             test $len -le $max_cmd_len; then\n+          :\n+        else\n+          # the command line is too long to link in one step, link in parts\n+          $echo \"using piecewise archive linking...\"\n+\t  save_RANLIB=$RANLIB\n+\t  RANLIB=:\n+          objlist=\n+          concat_cmds=\n+          save_oldobjs=$oldobjs\n+          for obj in $save_oldobjs\n+          do\n+            oldobjs=\"$objlist $obj\"\n+            objlist=\"$objlist $obj\"\n+            eval test_cmds=\\\"$old_archive_cmds\\\"\n+            if len=`expr \"X$test_cmds\" : \".*\"` &&\n+               test $len -le $max_cmd_len; then\n+              :\n+            else\n+              # the above command should be used before it gets too long\n+              oldobjs=$objlist\n+\t      test -z \"$concat_cmds\" || concat_cmds=$concat_cmds~\n+              eval concat_cmds=\\\"\\${concat_cmds}$old_archive_cmds\\\"\n+              objlist=\n+            fi\n+          done\n+\t  RANLIB=$save_RANLIB\n+          oldobjs=$objlist\n+          eval cmds=\\\"\\$concat_cmds~$old_archive_cmds\\\"\n+        fi\n       fi\n       IFS=\"${IFS= \t}\"; save_ifs=\"$IFS\"; IFS='~'\n       for cmd in $cmds; do\n@@ -3920,7 +4193,7 @@ fi\\\n     fi\n \n     # Now create the libtool archive.\n-    case \"$output\" in\n+    case $output in\n     *.la)\n       old_library=\n       test \"$build_old_libs\" = yes && old_library=\"$libname.$libext\"\n@@ -3952,7 +4225,7 @@ fi\\\n \t    # Replace all uninstalled libtool libraries with the installed ones\n \t    newdependency_libs=\n \t    for deplib in $dependency_libs; do\n-\t      case \"$deplib\" in\n+\t      case $deplib in\n \t      *.la)\n \t\tname=`$echo \"X$deplib\" | $Xsed -e 's%^.*/%%'`\n \t\teval libdir=`sed -n -e 's/^libdir=\\(.*\\)$/\\1/p' $deplib`\n@@ -4050,7 +4323,7 @@ relink_command=\\\"$relink_command\\\"\"\n        $echo \"X$nonopt\" | $Xsed | grep shtool > /dev/null; then\n       # Aesthetically quote it.\n       arg=`$echo \"X$nonopt\" | $Xsed -e \"$sed_quote_subst\"`\n-      case \"$arg\" in\n+      case $arg in\n       *[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*)\n \targ=\"\\\"$arg\\\"\"\n \t;;\n@@ -4066,7 +4339,7 @@ relink_command=\\\"$relink_command\\\"\"\n     # The real first argument should be the name of the installation program.\n     # Aesthetically quote it.\n     arg=`$echo \"X$arg\" | $Xsed -e \"$sed_quote_subst\"`\n-    case \"$arg\" in\n+    case $arg in\n     *[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*)\n       arg=\"\\\"$arg\\\"\"\n       ;;\n@@ -4089,7 +4362,7 @@ relink_command=\\\"$relink_command\\\"\"\n \tcontinue\n       fi\n \n-      case \"$arg\" in\n+      case $arg in\n       -d) isdir=yes ;;\n       -f) prev=\"-f\" ;;\n       -g) prev=\"-g\" ;;\n@@ -4114,7 +4387,7 @@ relink_command=\\\"$relink_command\\\"\"\n \n       # Aesthetically quote the argument.\n       arg=`$echo \"X$arg\" | $Xsed -e \"$sed_quote_subst\"`\n-      case \"$arg\" in\n+      case $arg in\n       *[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*)\n \targ=\"\\\"$arg\\\"\"\n \t;;\n@@ -4165,11 +4438,11 @@ relink_command=\\\"$relink_command\\\"\"\n \texit 1\n       fi\n     fi\n-    case \"$destdir\" in\n+    case $destdir in\n     [\\\\/]* | [A-Za-z]:[\\\\/]*) ;;\n     *)\n       for file in $files; do\n-\tcase \"$file\" in\n+\tcase $file in\n \t*.lo) ;;\n \t*)\n \t  $echo \"$modename: \\`$destdir' must be an absolute directory name\" 1>&2\n@@ -4191,7 +4464,7 @@ relink_command=\\\"$relink_command\\\"\"\n     for file in $files; do\n \n       # Do each installation.\n-      case \"$file\" in\n+      case $file in\n       *.$libext)\n \t# Do the static libraries later.\n \tstaticlibs=\"$staticlibs $file\"\n@@ -4210,7 +4483,7 @@ relink_command=\\\"$relink_command\\\"\"\n \told_library=\n \trelink_command=\n \t# If there is no directory component, then add one.\n-\tcase \"$file\" in\n+\tcase $file in\n \t*/* | *\\\\*) . $file ;;\n \t*) . ./$file ;;\n \tesac\n@@ -4306,7 +4579,7 @@ relink_command=\\\"$relink_command\\\"\"\n \tfi\n \n \t# Deduce the name of the destination old-style object file.\n-\tcase \"$destfile\" in\n+\tcase $destfile in\n \t*.lo)\n \t  staticdest=`$echo \"X$destfile\" | $Xsed -e \"$lo2o\"`\n \t  ;;\n@@ -4353,7 +4626,7 @@ relink_command=\\\"$relink_command\\\"\"\n \t  relink_command=\n \n \t  # If there is no directory component, then add one.\n-\t  case \"$file\" in\n+\t  case $file in\n \t  */* | *\\\\*) . $file ;;\n \t  *) . ./$file ;;\n \t  esac\n@@ -4370,7 +4643,7 @@ relink_command=\\\"$relink_command\\\"\"\n \t    libdir=\n \t    if test -f \"$lib\"; then\n \t      # If there is no directory component, then add one.\n-\t      case \"$lib\" in\n+\t      case $lib in\n \t      */* | *\\\\*) . $lib ;;\n \t      *) . ./$lib ;;\n \t      esac\n@@ -4384,7 +4657,7 @@ relink_command=\\\"$relink_command\\\"\"\n \n \t  relink_command=\n \t  # If there is no directory component, then add one.\n-\t  case \"$file\" in\n+\t  case $file in\n \t  */* | *\\\\*) . $file ;;\n \t  *) . ./$file ;;\n \t  esac\n@@ -4563,7 +4836,7 @@ relink_command=\\\"$relink_command\\\"\"\n       fi\n \n       dir=\n-      case \"$file\" in\n+      case $file in\n       *.la)\n \t# Check to see that this really is a libtool archive.\n \tif (sed -e '2q' $file | egrep \"^# Generated by .*$PACKAGE\") >/dev/null 2>&1; then :\n@@ -4578,7 +4851,7 @@ relink_command=\\\"$relink_command\\\"\"\n \tlibrary_names=\n \n \t# If there is no directory component, then add one.\n-\tcase \"$file\" in\n+\tcase $file in\n \t*/* | *\\\\*) . $file ;;\n \t*) . ./$file ;;\n \tesac\n@@ -4633,13 +4906,13 @@ relink_command=\\\"$relink_command\\\"\"\n     args=\n     for file\n     do\n-      case \"$file\" in\n+      case $file in\n       -*) ;;\n       *)\n \t# Do a test to see if this is really a libtool program.\n \tif (sed -e '4q' $file | egrep \"^# Generated by .*$PACKAGE\") >/dev/null 2>&1; then\n \t  # If there is no directory component, then add one.\n-\t  case \"$file\" in\n+\t  case $file in\n \t  */* | *\\\\*) . $file ;;\n \t  *) . ./$file ;;\n \t  esac\n@@ -4696,7 +4969,7 @@ relink_command=\\\"$relink_command\\\"\"\n \n     for arg\n     do\n-      case \"$arg\" in\n+      case $arg in\n       -*) rm=\"$rm $arg\" ;;\n       *) files=\"$files $arg\" ;;\n       esac\n@@ -4708,6 +4981,8 @@ relink_command=\\\"$relink_command\\\"\"\n       exit 1\n     fi\n \n+    rmdirs=\n+\n     for file in $files; do\n       dir=`$echo \"X$file\" | $Xsed -e 's%/[^/]*$%%'`\n       if test \"X$dir\" = \"X$file\"; then\n@@ -4719,9 +4994,17 @@ relink_command=\\\"$relink_command\\\"\"\n       name=`$echo \"X$file\" | $Xsed -e 's%^.*/%%'`\n       test $mode = uninstall && objdir=\"$dir\"\n \n+      # Remember objdir for removal later, being careful to avoid duplicates\n+      if test $mode = clean; then\n+        case \" $rmdirs \" in\n+\t  *\" $objdir \"*) ;;\n+\t  *) rmdirs=\"$rmdirs $objdir\" ;;\n+\tesac\n+      fi\n+\n       rmfiles=\"$file\"\n \n-      case \"$name\" in\n+      case $name in\n       *.la)\n \t# Possibly a libtool archive, so verify it.\n \tif (sed -e '2q' $file | egrep \"^# Generated by .*$PACKAGE\") >/dev/null 2>&1; then\n@@ -4765,10 +5048,10 @@ relink_command=\\\"$relink_command\\\"\"\n \n       *.lo)\n \t# Possibly a libtool object, so verify it.\n-\tif (sed -e '2q' $arg | egrep \"^# Generated by .*$PACKAGE\") >/dev/null 2>&1; then\n+\tif (sed -e '2q' $file | egrep \"^# Generated by .*$PACKAGE\") >/dev/null 2>&1; then\n \n           # Read the .lo file\n-          . ./$file\n+          . $dir/$name\n \n \t  # Add PIC object to the list of files to remove.\n           if test -n \"$pic_object\" \\\n@@ -4801,6 +5084,15 @@ relink_command=\\\"$relink_command\\\"\"\n       $show \"$rm $rmfiles\"\n       $run $rm $rmfiles\n     done\n+\n+    # Try to remove the ${objdir}s in the directories where we deleted files\n+    for dir in $rmdirs; do\n+      if test -d \"$dir\"; then\n+        $show \"rmdir $dir\"\n+        $run rmdir $dir >/dev/null 2>&1\n+      fi\n+    done\n+\n     exit 0\n     ;;\n \n@@ -4817,7 +5109,7 @@ relink_command=\\\"$relink_command\\\"\"\n fi # test -z \"$show_help\"\n \n # We need to display help for each of the modes.\n-case \"$mode\" in\n+case $mode in\n \"\") $echo \\\n \"Usage: $modename [OPTION]... [MODE-ARG]...\n \n@@ -4956,6 +5248,7 @@ The following components of LINK-COMMAND are treated specially:\n   -no-install       link a not-installable executable\n   -no-undefined     declare that a library does not refer to external symbols\n   -o OUTPUT-FILE    create OUTPUT-FILE from the specified objects\n+  -objectlist FILE  Use a list of object files found in FILE to specify objects\n   -release RELEASE  specify package release information\n   -rpath LIBDIR     the created library will eventually be installed in LIBDIR\n   -R[ ]LIBDIR       add LIBDIR to the runtime path of programs and libraries"}]}