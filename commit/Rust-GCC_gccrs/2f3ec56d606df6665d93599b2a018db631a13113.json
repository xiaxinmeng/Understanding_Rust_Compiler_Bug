{"sha": "2f3ec56d606df6665d93599b2a018db631a13113", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmYzZWM1NmQ2MDZkZjY2NjVkOTM1OTliMmEwMThkYjYzMWExMzExMw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2017-02-21T14:39:21Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-02-21T14:39:21Z"}, "message": "re PR target/79494 (ICE in maybe_record_trace_start, at dwarf2cfi.c:2330)\n\n\tPR target/79494\n\t* config/i386/i386.c (ix86_expand_split_stack_prologue): Call\n\tmake_reg_eh_region_note_nothrow_nononlocal on call_insn.\n\t* config/rs6000/rs6000.c: Include except.h.\n\t(rs6000_expand_split_stack_prologue): Call\n\tmake_reg_eh_region_note_nothrow_nononlocal on the call insn.\n\n\t* gcc.dg/pr79494.c: New test.\n\nFrom-SVN: r245629", "tree": {"sha": "c342c5dab1daaea372097f60db202ee861e37058", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c342c5dab1daaea372097f60db202ee861e37058"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2f3ec56d606df6665d93599b2a018db631a13113", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f3ec56d606df6665d93599b2a018db631a13113", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2f3ec56d606df6665d93599b2a018db631a13113", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f3ec56d606df6665d93599b2a018db631a13113/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "03108bad95b96d9dad75dc99482d652ea9a749c5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03108bad95b96d9dad75dc99482d652ea9a749c5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/03108bad95b96d9dad75dc99482d652ea9a749c5"}], "stats": {"total": 41, "additions": 41, "deletions": 0}, "files": [{"sha": "0d39438c673e4077cd8ad94e167c8441cc23a516", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f3ec56d606df6665d93599b2a018db631a13113/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f3ec56d606df6665d93599b2a018db631a13113/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2f3ec56d606df6665d93599b2a018db631a13113", "patch": "@@ -1,3 +1,12 @@\n+2017-02-21  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR target/79494\n+\t* config/i386/i386.c (ix86_expand_split_stack_prologue): Call\n+\tmake_reg_eh_region_note_nothrow_nononlocal on call_insn.\n+\t* config/rs6000/rs6000.c: Include except.h.\n+\t(rs6000_expand_split_stack_prologue): Call\n+\tmake_reg_eh_region_note_nothrow_nononlocal on the call insn.\n+\n 2017-02-21  Martin Jambor  <mjambor@suse.cz>\n \n \tPR lto/79579"}, {"sha": "14ac189fc42bda5c7a8d1ec562bb3d13ca0ad1aa", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f3ec56d606df6665d93599b2a018db631a13113/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f3ec56d606df6665d93599b2a018db631a13113/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=2f3ec56d606df6665d93599b2a018db631a13113", "patch": "@@ -15057,6 +15057,8 @@ ix86_expand_split_stack_prologue (void)\n   add_function_usage_to (call_insn, call_fusage);\n   if (!TARGET_64BIT)\n     add_reg_note (call_insn, REG_ARGS_SIZE, GEN_INT (0));\n+  /* Indicate that this function can't jump to non-local gotos.  */\n+  make_reg_eh_region_note_nothrow_nononlocal (as_a <rtx_insn *> (call_insn));\n \n   /* In order to make call/return prediction work right, we now need\n      to execute a return instruction.  See"}, {"sha": "25b10f12742d66c28f9a8f6e3123826ed06d01ad", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f3ec56d606df6665d93599b2a018db631a13113/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f3ec56d606df6665d93599b2a018db631a13113/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=2f3ec56d606df6665d93599b2a018db631a13113", "patch": "@@ -66,6 +66,7 @@\n #include \"builtins.h\"\n #include \"context.h\"\n #include \"tree-pass.h\"\n+#include \"except.h\"\n #if TARGET_XCOFF\n #include \"xcoffout.h\"  /* get declarations of xcoff_*_section_name */\n #endif\n@@ -31680,6 +31681,8 @@ rs6000_expand_split_stack_prologue (void)\n      split_stack_return use r0.  */\n   use_reg (&call_fusage, r0);\n   add_function_usage_to (insn, call_fusage);\n+  /* Indicate that this function can't jump to non-local gotos.  */\n+  make_reg_eh_region_note_nothrow_nononlocal (insn);\n   emit_insn (gen_frame_load (r0, r1, info->lr_save_offset));\n   insn = emit_move_insn (lr, r0);\n   add_reg_note (insn, REG_CFA_RESTORE, lr);"}, {"sha": "b9c70a7b77b09b2ea537233398a1fd580415d294", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f3ec56d606df6665d93599b2a018db631a13113/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f3ec56d606df6665d93599b2a018db631a13113/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2f3ec56d606df6665d93599b2a018db631a13113", "patch": "@@ -1,3 +1,8 @@\n+2017-02-21  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR target/79494\n+\t* gcc.dg/pr79494.c: New test.\n+\n 2017-02-21  Segher Boessenkool  <segher@kernel.crashing.org>\n \n \t* gcc.dg/plugin/diagnostic-test-expressions-1.c: Add -Wno-psabi"}, {"sha": "e8543f8c43fb93a69943c800a5c1b1c1f36ead40", "filename": "gcc/testsuite/gcc.dg/pr79494.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f3ec56d606df6665d93599b2a018db631a13113/gcc%2Ftestsuite%2Fgcc.dg%2Fpr79494.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f3ec56d606df6665d93599b2a018db631a13113/gcc%2Ftestsuite%2Fgcc.dg%2Fpr79494.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr79494.c?ref=2f3ec56d606df6665d93599b2a018db631a13113", "patch": "@@ -0,0 +1,22 @@\n+/* PR target/79494 */\n+/* { dg-do compile } */\n+/* { dg-require-effective-target split_stack } */\n+/* { dg-options \"-O2 -fsplit-stack -g\" } */\n+\n+void\n+foo (int a)\n+{\n+  __label__ lab;\n+  __attribute__((noinline, noclone)) void bar (int b)\n+  {\n+    switch (b)\n+      {\n+      case 1:\n+\tgoto lab;\n+      case 2:\n+\tgoto lab;\n+      }\n+  }\n+  bar (a);\n+lab:;\n+}"}]}