{"sha": "4ce7ff881ab27cda15543985de467fd6c9611676", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGNlN2ZmODgxYWIyN2NkYTE1NTQzOTg1ZGU0NjdmZDZjOTYxMTY3Ng==", "commit": {"author": {"name": "Thomas Quinot", "email": "quinot@adacore.com", "date": "2007-06-06T10:48:51Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2007-06-06T10:48:51Z"}, "message": "g-soccon-darwin.ads, [...]: Add new constant Thread_Blocking_IO...\n\n2007-04-20  Thomas Quinot  <quinot@adacore.com>\n\n\t* g-soccon-darwin.ads, gen-soccon.c: Add new constant\n\tThread_Blocking_IO, always True by default, set False on a per-runtime\n\tbasis.\n\tAdd Windows-specific constants\n\tAdd new constant Need_Netdb_Buffer.\n\tAdd new macros to indicate whether getXXXbyYYY is thread safe and, if\n\tnot, whether to use getXXXbyYYY_r.\n\n\t* gsocket.h: Add new constant Need_Netdb_Buffer.\n\tAdd new macros to indicate whether getXXXbyYYY is thread safe and, if\n\tnot, whether to use getXXXbyYYY_r.\n\nFrom-SVN: r125466", "tree": {"sha": "21c8578817abfa775cbe5d7fee601745c1d48134", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/21c8578817abfa775cbe5d7fee601745c1d48134"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4ce7ff881ab27cda15543985de467fd6c9611676", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4ce7ff881ab27cda15543985de467fd6c9611676", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4ce7ff881ab27cda15543985de467fd6c9611676", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4ce7ff881ab27cda15543985de467fd6c9611676/comments", "author": null, "committer": null, "parents": [{"sha": "37000abae45e881eaeaf0ca40f043a7f5f55e924", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37000abae45e881eaeaf0ca40f043a7f5f55e924", "html_url": "https://github.com/Rust-GCC/gccrs/commit/37000abae45e881eaeaf0ca40f043a7f5f55e924"}], "stats": {"total": 88, "additions": 82, "deletions": 6}, "files": [{"sha": "7d82375763fc2a2e375e7e269a0123190c18bda3", "filename": "gcc/ada/g-soccon-darwin.ads", "status": "modified", "additions": 16, "deletions": 3, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4ce7ff881ab27cda15543985de467fd6c9611676/gcc%2Fada%2Fg-soccon-darwin.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4ce7ff881ab27cda15543985de467fd6c9611676/gcc%2Fada%2Fg-soccon-darwin.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-soccon-darwin.ads?ref=4ce7ff881ab27cda15543985de467fd6c9611676", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 2000-2005, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2000-2007, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -35,7 +35,7 @@\n --  by the GNAT.Sockets package (g-socket.ads). This package should not be\n --  directly with'ed by an applications program.\n \n---  This is the version for powerpc-apple-darwin7.4.1\n+--  This is the version for powerpc-apple-darwin8.8.0\n --  This file is generated automatically, do not modify it by hand! Instead,\n --  make changes to gen-soccon.c and re-run it on each target.\n \n@@ -167,7 +167,7 @@ package GNAT.Sockets.Constants is\n    -- System limits --\n    -------------------\n \n-   IOV_MAX            : constant :=  2147483647; --  Maximum writev iovcnt\n+   IOV_MAX            : constant :=        1024; --  Maximum writev iovcnt\n \n    ----------------------\n    -- Type definitions --\n@@ -178,4 +178,17 @@ package GNAT.Sockets.Constants is\n    SIZEOF_tv_sec      : constant :=           4; --  tv_sec\n    SIZEOF_tv_usec     : constant :=           4; --  tv_usec\n \n+   ----------------------------------------\n+   -- Properties of supported interfaces --\n+   ----------------------------------------\n+\n+   Need_Netdb_Buffer  : constant :=           1; --  Need buffer for Netdb ops\n+\n+   ----------------------\n+   -- Additional flags --\n+   ----------------------\n+\n+   Thread_Blocking_IO : constant Boolean := True;\n+   --  Set False for contexts where socket i/o are process blocking\n+\n end GNAT.Sockets.Constants;"}, {"sha": "d52ba5f3464e68048a1ce0fa89991a0763f1e5a7", "filename": "gcc/ada/gen-soccon.c", "status": "modified", "additions": 35, "deletions": 2, "changes": 37, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4ce7ff881ab27cda15543985de467fd6c9611676/gcc%2Fada%2Fgen-soccon.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4ce7ff881ab27cda15543985de467fd6c9611676/gcc%2Fada%2Fgen-soccon.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgen-soccon.c?ref=4ce7ff881ab27cda15543985de467fd6c9611676", "patch": "@@ -4,7 +4,7 @@\n  *                                                                          *\n  *                           G E N - S O C C O N                            *\n  *                                                                          *\n- *          Copyright (C) 2004-2005, Free Software Foundation, Inc.         *\n+ *          Copyright (C) 2004-2007, Free Software Foundation, Inc.         *\n  *                                                                          *\n  * GNAT is free software;  you can  redistribute it  and/or modify it under *\n  * terms of the  GNU General Public License as published  by the Free Soft- *\n@@ -98,7 +98,7 @@ TXT(\"--               G N A T . S O C K E T S . C O N S T A N T S\n TXT(\"--                                                                          --\")\n TXT(\"--                                 S p e c                                  --\")\n TXT(\"--                                                                          --\")\n-TXT(\"--          Copyright (C) 2000-2005, Free Software Foundation, Inc.         --\")\n+TXT(\"--          Copyright (C) 2000-2007, Free Software Foundation, Inc.         --\")\n TXT(\"--                                                                          --\")\n TXT(\"-- GNAT is free software;  you can  redistribute it  and/or modify it under --\")\n TXT(\"-- terms of the  GNU General Public License as published  by the Free Soft- --\")\n@@ -589,6 +589,14 @@ CND(SIZEOF_tv_sec, \"tv_sec\")\n CND(SIZEOF_tv_usec, \"tv_usec\")\n }\n \n+_NL\n+TXT(\"   ----------------------------------------\")\n+TXT(\"   -- Properties of supported interfaces --\")\n+TXT(\"   ----------------------------------------\")\n+_NL\n+\n+CND(Need_Netdb_Buffer, \"Need buffer for Netdb ops\")\n+\n #ifdef __vxworks\n _NL\n TXT(\"   --------------------------------\")\n@@ -603,6 +611,31 @@ CND(OK,    \"VxWorks generic success\")\n CND(ERROR, \"VxWorks generic error\")\n #endif\n \n+#ifdef __MINGW32__\n+_NL\n+TXT(\"   ------------------------------\")\n+TXT(\"   -- MinGW-specific constants --\")\n+TXT(\"   ------------------------------\")\n+_NL\n+TXT(\"   --  These constants may be used only within the MinGW version of\")\n+TXT(\"   --  GNAT.Sockets.Thin.\")\n+_NL\n+\n+CND(WSASYSNOTREADY,     \"System not ready\")\n+CND(WSAVERNOTSUPPORTED, \"Version not supported\")\n+CND(WSANOTINITIALISED,  \"Winsock not intialized\")\n+CND(WSAEDISCON,         \"Disconnected\")\n+\n+#endif\n+\n+_NL\n+TXT(\"   ----------------------\")\n+TXT(\"   -- Additional flags --\")\n+TXT(\"   ----------------------\")\n+_NL\n+TXT(\"   Thread_Blocking_IO : constant Boolean := True;\")\n+TXT(\"   --  Set False for contexts where socket i/o are process blocking\")\n+\n _NL\n TXT(\"end GNAT.Sockets.Constants;\")\n "}, {"sha": "7df7ea089cb5b7d9018e7fd258ddec802356bd39", "filename": "gcc/ada/gsocket.h", "status": "modified", "additions": 31, "deletions": 1, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4ce7ff881ab27cda15543985de467fd6c9611676/gcc%2Fada%2Fgsocket.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4ce7ff881ab27cda15543985de467fd6c9611676/gcc%2Fada%2Fgsocket.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgsocket.h?ref=4ce7ff881ab27cda15543985de467fd6c9611676", "patch": "@@ -6,7 +6,7 @@\n  *                                                                          *\n  *                              C Header File                               *\n  *                                                                          *\n- *         Copyright (C) 2004-2005, Free Software Foundation, Inc.          *\n+ *         Copyright (C) 2004-2006, Free Software Foundation, Inc.          *\n  *                                                                          *\n  * GNAT is free software;  you can  redistribute it  and/or modify it under *\n  * terms of the  GNU General Public License as published  by the Free Soft- *\n@@ -146,3 +146,33 @@\n #include <sys/ioctl.h>\n #include <netdb.h>\n #endif\n+\n+/*\n+ * Handling of gethostbyname, gethostbyaddr, getservbyname and getservbyport\n+ * =========================================================================\n+ *\n+ * The default implementation of GNAT.Sockets.Thin requires that these\n+ * operations be either thread safe, or that a reentrant version getXXXbyYYY_r\n+ * be provided. In both cases, socket.c provides a __gnat_safe_getXXXbyYYY\n+ * function with the same signature as getXXXbyYYY_r. If the operating\n+ * system version of getXXXbyYYY is thread safe, the provided auxiliary\n+ * buffer argument is unused and ignored.\n+ *\n+ * Target specific versions of GNAT.Sockets.Thin for platforms that can't\n+ * fulfill these requirements must provide their own protection mechanism\n+ * in Safe_GetXXXbyYYY, and if they require GNAT.Sockets to provide a buffer\n+ * to this effect, then we need to set Need_Netdb_Buffer here (case of\n+ * VxWorks and VMS).\n+ */\n+\n+#if defined (_AIX) || defined (__FreeBSD__) || defined (__hpux__) || defined (__osf__) || defined (_WIN32) || defined (__APPLE__)\n+# define HAVE_THREAD_SAFE_GETxxxBYyyy 1\n+#elif defined (sgi) || defined (linux) || (defined (sun) && defined (__SVR4) && !defined (__vxworks))\n+# define HAVE_GETxxxBYyyy_R 1\n+#endif\n+\n+#if defined (HAVE_GETxxxBYyyy_R) || !defined (HAVE_THREAD_SAFE_GETxxxBYyyy)\n+# define Need_Netdb_Buffer 1\n+#else\n+# define Need_Netdb_Buffer 0\n+#endif"}]}