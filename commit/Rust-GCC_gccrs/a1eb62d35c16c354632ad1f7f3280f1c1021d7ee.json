{"sha": "a1eb62d35c16c354632ad1f7f3280f1c1021d7ee", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTFlYjYyZDM1YzE2YzM1NDYzMmFkMWY3ZjMyODBmMWMxMDIxZDdlZQ==", "commit": {"author": {"name": "Daniel Cederman", "email": "cederman@gaisler.com", "date": "2017-12-19T08:04:52Z"}, "committer": {"name": "Sebastian Huber", "email": "sh@gcc.gnu.org", "date": "2017-12-19T08:04:52Z"}, "message": "SPARC: Make sure that jump is to a label in errata workaround\n\nIn some cases the jump could be to a return instruction and in those cases the\nnext_active_insn() function tries to follow an invalid pointer which leads to a\ncrash. This error did not manifest when using a 32-bit version of GCC which is\nwhy I did not detect it before.\n\ngcc/\n\t* config/sparc/sparc.c (sparc_do_work_around_errata): Make sure\n\tthe jump is to a label.\n\nFrom-SVN: r255807", "tree": {"sha": "d95cd8535957692d6070d199de82ca39f8f8e59c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d95cd8535957692d6070d199de82ca39f8f8e59c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a1eb62d35c16c354632ad1f7f3280f1c1021d7ee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a1eb62d35c16c354632ad1f7f3280f1c1021d7ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a1eb62d35c16c354632ad1f7f3280f1c1021d7ee", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a1eb62d35c16c354632ad1f7f3280f1c1021d7ee/comments", "author": {"login": "doac", "id": 2056695, "node_id": "MDQ6VXNlcjIwNTY2OTU=", "avatar_url": "https://avatars.githubusercontent.com/u/2056695?v=4", "gravatar_id": "", "url": "https://api.github.com/users/doac", "html_url": "https://github.com/doac", "followers_url": "https://api.github.com/users/doac/followers", "following_url": "https://api.github.com/users/doac/following{/other_user}", "gists_url": "https://api.github.com/users/doac/gists{/gist_id}", "starred_url": "https://api.github.com/users/doac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/doac/subscriptions", "organizations_url": "https://api.github.com/users/doac/orgs", "repos_url": "https://api.github.com/users/doac/repos", "events_url": "https://api.github.com/users/doac/events{/privacy}", "received_events_url": "https://api.github.com/users/doac/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f744bfec7ffb92b476da82bc62a81eaf087b2391", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f744bfec7ffb92b476da82bc62a81eaf087b2391", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f744bfec7ffb92b476da82bc62a81eaf087b2391"}], "stats": {"total": 8, "additions": 7, "deletions": 1}, "files": [{"sha": "31a60f1757d0fc20aca7703c849d6d3b5604ec0a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a1eb62d35c16c354632ad1f7f3280f1c1021d7ee/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a1eb62d35c16c354632ad1f7f3280f1c1021d7ee/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a1eb62d35c16c354632ad1f7f3280f1c1021d7ee", "patch": "@@ -1,3 +1,8 @@\n+2017-12-19  Daniel Cederman  <cederman@gaisler.com>\n+\n+\t* config/sparc/sparc.c (sparc_do_work_around_errata): Make sure\n+\tthe jump is to a label.\n+\n 2017-12-19  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/83444"}, {"sha": "288264f0e8c048ddeff338fd02623c132864ce36", "filename": "gcc/config/sparc/sparc.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a1eb62d35c16c354632ad1f7f3280f1c1021d7ee/gcc%2Fconfig%2Fsparc%2Fsparc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a1eb62d35c16c354632ad1f7f3280f1c1021d7ee/gcc%2Fconfig%2Fsparc%2Fsparc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsparc%2Fsparc.c?ref=a1eb62d35c16c354632ad1f7f3280f1c1021d7ee", "patch": "@@ -1066,6 +1066,7 @@ sparc_do_work_around_errata (void)\n \t floating-point operation or a floating-point branch.  */\n       if (sparc_fix_gr712rc\n \t  && jump\n+\t  && jump_to_label_p (jump)\n \t  && get_attr_branch_type (jump) == BRANCH_TYPE_ICC)\n \t{\n \t  rtx_insn *target = next_active_insn (JUMP_LABEL_AS_INSN (jump));\n@@ -1085,7 +1086,7 @@ sparc_do_work_around_errata (void)\n \t  && mem_ref (SET_SRC (set))\n \t  && REG_P (SET_DEST (set)))\n \t{\n-\t  if (jump)\n+\t  if (jump && jump_to_label_p (jump))\n \t    {\n \t      rtx_insn *target = next_active_insn (JUMP_LABEL_AS_INSN (jump));\n \t      if (target && atomic_insn_for_leon3_p (target))"}]}