{"sha": "3d422cb195ff12f1775103d5308495d459d860ec", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2Q0MjJjYjE5NWZmMTJmMTc3NTEwM2Q1MzA4NDk1ZDQ1OWQ4NjBlYw==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2000-12-01T03:29:02Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2000-12-01T03:29:02Z"}, "message": "sh.c (shiftcosts): Don't get INTVAL before testing whether X is a CONST_INT.\n\n* config/sh/sh.c (shiftcosts): Don't get INTVAL before testing\nwhether X is a CONST_INT.\n(addsubcosts): Likewise.\n\nFrom-SVN: r37911", "tree": {"sha": "1b58068f19d3b2610de8c6488b8ad77801f819f3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1b58068f19d3b2610de8c6488b8ad77801f819f3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3d422cb195ff12f1775103d5308495d459d860ec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3d422cb195ff12f1775103d5308495d459d860ec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3d422cb195ff12f1775103d5308495d459d860ec", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3d422cb195ff12f1775103d5308495d459d860ec/comments", "author": null, "committer": null, "parents": [{"sha": "b927e8c7203c92b0580665b6ee75cff290c64d0d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b927e8c7203c92b0580665b6ee75cff290c64d0d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b927e8c7203c92b0580665b6ee75cff290c64d0d"}], "stats": {"total": 11, "additions": 9, "deletions": 2}, "files": [{"sha": "3dc102c1d574da77177716b2740a15909e6ff23a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3d422cb195ff12f1775103d5308495d459d860ec/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3d422cb195ff12f1775103d5308495d459d860ec/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3d422cb195ff12f1775103d5308495d459d860ec", "patch": "@@ -1,5 +1,9 @@\n 2000-12-01  Alexandre Oliva  <aoliva@redhat.com>\n \n+\t* config/sh/sh.c (shiftcosts): Don't get INTVAL before testing\n+\twhether X is a CONST_INT.\n+\t(addsubcosts): Likewise.\n+\n \t* config/sh/sh.h (OUTPUT_ADDR_CONST_EXTRA): Use INTVAL instead of\n \tmis-used XINT.\n \t(ARG_POINTER_REGNUM): Set to AP_REG."}, {"sha": "80b1808530c79588923fb0532ef7abc8160e292b", "filename": "gcc/config/sh/sh.c", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3d422cb195ff12f1775103d5308495d459d860ec/gcc%2Fconfig%2Fsh%2Fsh.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3d422cb195ff12f1775103d5308495d459d860ec/gcc%2Fconfig%2Fsh%2Fsh.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsh%2Fsh.c?ref=3d422cb195ff12f1775103d5308495d459d860ec", "patch": "@@ -965,12 +965,14 @@ int\n shiftcosts (x)\n      rtx x;\n {\n-  int value = INTVAL (XEXP (x, 1));\n+  int value;\n \n   /* If shift by a non constant, then this will be expensive.  */\n   if (GET_CODE (XEXP (x, 1)) != CONST_INT)\n     return SH_DYNAMIC_SHIFT_COST;\n \n+  value = INTVAL (XEXP (x, 1));\n+\n   /* Otherwise, return the true cost in instructions.  */\n   if (GET_CODE (x) == ASHIFTRT)\n     {\n@@ -1025,7 +1027,8 @@ addsubcosts (x)\n     return 1;\n \n   /* Likewise for small constants.  */\n-  if (CONST_OK_FOR_I (INTVAL (XEXP (x, 1))))\n+  if (GET_CODE (XEXP (x, 1)) == CONST_INT\n+      && CONST_OK_FOR_I (INTVAL (XEXP (x, 1))))\n     return 1;\n \n   /* Any other constant requires a 2 cycle pc-relative load plus an"}]}