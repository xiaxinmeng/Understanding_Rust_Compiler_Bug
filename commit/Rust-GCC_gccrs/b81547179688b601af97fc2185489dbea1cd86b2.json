{"sha": "b81547179688b601af97fc2185489dbea1cd86b2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjgxNTQ3MTc5Njg4YjYwMWFmOTdmYzIxODU0ODlkYmVhMWNkODZiMg==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2019-03-14T09:33:54Z"}, "committer": {"name": "Martin Liska", "email": "marxin@gcc.gnu.org", "date": "2019-03-14T09:33:54Z"}, "message": "GCOV: print {start,end}_column in JSON file and gcov-dump tool.\n\n2019-03-14  Martin Liska  <mliska@suse.cz>\n\n\t* coverage.c (coverage_begin_function): Stream also\n\tend_column.\n\t* doc/gcov.texi: Document 2 new fields in JSON file.  Improve\n\tdocumentation about function declaration location.\n\t* gcov-dump.c (tag_function): Print whole range\n\tof function declaration.\n\t* gcov.c (struct function_info): Add end_column field.\n\t(function_info::function_info): Initialize it.\n\t(output_json_intermediate_file): Output {start,end}_column\n\tfields.\n\t(read_graph_file): Read end_column.\n\nFrom-SVN: r269678", "tree": {"sha": "3b014b7c0ae678b661a9596e5af81a9395664ec1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3b014b7c0ae678b661a9596e5af81a9395664ec1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b81547179688b601af97fc2185489dbea1cd86b2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b81547179688b601af97fc2185489dbea1cd86b2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b81547179688b601af97fc2185489dbea1cd86b2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b81547179688b601af97fc2185489dbea1cd86b2/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ea9d9d749c3203e9fb01267fabecad93b7f1c06c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea9d9d749c3203e9fb01267fabecad93b7f1c06c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ea9d9d749c3203e9fb01267fabecad93b7f1c06c"}], "stats": {"total": 45, "additions": 42, "deletions": 3}, "files": [{"sha": "86a231956c06dde8d96113aaacd3a5ae949e86cd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b81547179688b601af97fc2185489dbea1cd86b2/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b81547179688b601af97fc2185489dbea1cd86b2/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b81547179688b601af97fc2185489dbea1cd86b2", "patch": "@@ -1,3 +1,17 @@\n+2019-03-14  Martin Liska  <mliska@suse.cz>\n+\n+\t* coverage.c (coverage_begin_function): Stream also\n+\tend_column.\n+\t* doc/gcov.texi: Document 2 new fields in JSON file.  Improve\n+\tdocumentation about function declaration location.\n+\t* gcov-dump.c (tag_function): Print whole range\n+\tof function declaration.\n+\t* gcov.c (struct function_info): Add end_column field.\n+\t(function_info::function_info): Initialize it.\n+\t(output_json_intermediate_file): Output {start,end}_column\n+\tfields.\n+\t(read_graph_file): Read end_column.\n+\n 2019-03-14  Richard Biener  <rguenther@suse.de>\n \n \tPR middle-end/89698"}, {"sha": "1ffefd5f482053308c3dc6f87aec69f0109ec7a0", "filename": "gcc/coverage.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b81547179688b601af97fc2185489dbea1cd86b2/gcc%2Fcoverage.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b81547179688b601af97fc2185489dbea1cd86b2/gcc%2Fcoverage.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcoverage.c?ref=b81547179688b601af97fc2185489dbea1cd86b2", "patch": "@@ -652,8 +652,10 @@ coverage_begin_function (unsigned lineno_checksum, unsigned cfg_checksum)\n \n   /* Function can start in a single file and end in another one.  */\n   int end_line = endloc.file == xloc.file ? endloc.line : xloc.line;\n+  int end_column = endloc.file == xloc.file ? endloc.column: xloc.column;\n   gcc_assert (xloc.line <= end_line);\n   gcov_write_unsigned (end_line);\n+  gcov_write_unsigned (end_column);\n   gcov_write_length (offset);\n \n   return !gcov_is_error ();"}, {"sha": "ecad5d1184762c354d711cff4a4dddcefae145b0", "filename": "gcc/doc/gcov.texi", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b81547179688b601af97fc2185489dbea1cd86b2/gcc%2Fdoc%2Fgcov.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b81547179688b601af97fc2185489dbea1cd86b2/gcc%2Fdoc%2Fgcov.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Fgcov.texi?ref=b81547179688b601af97fc2185489dbea1cd86b2", "patch": "@@ -236,9 +236,11 @@ Each @var{function} has the following form:\n   \"blocks\": @var{blocks},\n   \"blocks_executed\": @var{blocks_executed},\n   \"demangled_name\": \"@var{demangled_name},\n+  \"end_column\": @var{end_column},\n   \"end_line\": @var{end_line},\n   \"execution_count\": @var{execution_count},\n   \"name\": @var{name},\n+  \"start_column\": @var{start_column}\n   \"start_line\": @var{start_line}\n @}\n @end smallexample\n@@ -255,6 +257,9 @@ Fields of the @var{function} element have following semantics:\n @item\n @var{demangled_name}: demangled name of the function\n \n+@item\n+@var{end_column}: column in the source file where the function ends\n+\n @item\n @var{end_line}: line in the source file where the function ends\n \n@@ -264,10 +269,18 @@ Fields of the @var{function} element have following semantics:\n @item\n @var{name}: name of the function\n \n+@item\n+@var{start_column}: column in the source file where the function begins\n+\n @item\n @var{start_line}: line in the source file where the function begins\n @end itemize\n \n+Note that line numbers and column numbers number from 1.  In the current\n+implementation, @var{start_line} and @var{start_column} do not include\n+any template parameters and the leading return type but that\n+this is likely to be fixed in the future.\n+\n Each @var{line} has the following form:\n \n @smallexample\n@@ -293,11 +306,11 @@ Fields of the @var{line} element have following semantics:\n @item\n @var{unexecuted_block}: flag whether the line contains an unexecuted block\n (not all statements on the line are executed)\n-@end itemize\n \n @item\n @var{function_name}: a name of a function this @var{line} belongs to\n (for a line with an inlined statements can be not set)\n+@end itemize\n \n Each @var{branch} has the following form:\n "}, {"sha": "67b1e88a5bc5a9beb8d232da8794b7ef9330e047", "filename": "gcc/gcov-dump.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b81547179688b601af97fc2185489dbea1cd86b2/gcc%2Fgcov-dump.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b81547179688b601af97fc2185489dbea1cd86b2/gcc%2Fgcov-dump.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcov-dump.c?ref=b81547179688b601af97fc2185489dbea1cd86b2", "patch": "@@ -315,7 +315,9 @@ tag_function (const char *filename ATTRIBUTE_UNUSED,\n \t  unsigned line_start = gcov_read_unsigned ();\n \t  unsigned column_start = gcov_read_unsigned ();\n \t  unsigned line_end = gcov_read_unsigned ();\n-\t  printf (\":%u:%u:%u\", line_start, column_start, line_end);\n+\t  unsigned column_end = gcov_read_unsigned ();\n+\t  printf (\":%u:%u-%u:%u\", line_start, column_start,\n+\t\t  line_end, column_end);\n \t  if (artificial)\n \t    printf (\", artificial\");\n \t}"}, {"sha": "1d576552a45dcb211340469142e83dbff754a185", "filename": "gcc/gcov.c", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b81547179688b601af97fc2185489dbea1cd86b2/gcc%2Fgcov.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b81547179688b601af97fc2185489dbea1cd86b2/gcc%2Fgcov.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcov.c?ref=b81547179688b601af97fc2185489dbea1cd86b2", "patch": "@@ -283,6 +283,9 @@ struct function_info\n   /* Last line number.  */\n   unsigned end_line;\n \n+  /* Last line column.  */\n+  unsigned end_column;\n+\n   /* Index of source file where the function is defined.  */\n   unsigned src;\n \n@@ -631,7 +634,8 @@ function_info::function_info (): m_name (NULL), m_demangled_name (NULL),\n   ident (0), lineno_checksum (0), cfg_checksum (0), has_catch (0),\n   artificial (0), is_group (0),\n   blocks (), blocks_executed (0), counts (),\n-  start_line (0), start_column (), end_line (0), src (0), lines (), next (NULL)\n+  start_line (0), start_column (0), end_line (0), end_column (0),\n+  src (0), lines (), next (NULL)\n {\n }\n \n@@ -1131,7 +1135,9 @@ output_json_intermediate_file (json::array *json_files, source_info *src)\n       function->set (\"demangled_name\",\n \t\t     new json::string ((*it)->get_demangled_name ()));\n       function->set (\"start_line\", new json::number ((*it)->start_line));\n+      function->set (\"start_column\", new json::number ((*it)->start_column));\n       function->set (\"end_line\", new json::number ((*it)->end_line));\n+      function->set (\"end_column\", new json::number ((*it)->end_column));\n       function->set (\"blocks\",\n \t\t     new json::number ((*it)->get_block_count ()));\n       function->set (\"blocks_executed\",\n@@ -1726,6 +1732,7 @@ read_graph_file (void)\n \t  unsigned start_line = gcov_read_unsigned ();\n \t  unsigned start_column = gcov_read_unsigned ();\n \t  unsigned end_line = gcov_read_unsigned ();\n+\t  unsigned end_column = gcov_read_unsigned ();\n \n \t  fn = new function_info ();\n \t  functions.push_back (fn);\n@@ -1739,6 +1746,7 @@ read_graph_file (void)\n \t  fn->start_line = start_line;\n \t  fn->start_column = start_column;\n \t  fn->end_line = end_line;\n+\t  fn->end_column = end_column;\n \t  fn->artificial = artificial;\n \n \t  current_tag = tag;"}]}