{"sha": "dda441650817aec18d07a390fec35ce24a516ee4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGRhNDQxNjUwODE3YWVjMThkMDdhMzkwZmVjMzVjZTI0YTUxNmVlNA==", "commit": {"author": {"name": "Jim Blandy", "email": "jimb@red-bean.com", "date": "2009-10-15T08:56:02Z"}, "committer": {"name": "Tristan Gingold", "email": "gingold@gcc.gnu.org", "date": "2009-10-15T08:56:02Z"}, "message": "2009-10-15  Jim Blandy  <jimb@red-bean.com>\n\n\t* libgnuintl.h (_INTL_MAY_RETURN_STRING_ARG, gettext, dgettext)\n\t(dcgettext, ngettext, dngettext, dcngettext): Backport changes\n\tfrom current gettext to provide GCC format_arg attributes.\n\nFrom-SVN: r152842", "tree": {"sha": "191c63ac5c55f6505177a2552748ab4184f748cd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/191c63ac5c55f6505177a2552748ab4184f748cd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dda441650817aec18d07a390fec35ce24a516ee4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dda441650817aec18d07a390fec35ce24a516ee4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dda441650817aec18d07a390fec35ce24a516ee4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dda441650817aec18d07a390fec35ce24a516ee4/comments", "author": {"login": "jimblandy", "id": 751272, "node_id": "MDQ6VXNlcjc1MTI3Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/751272?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jimblandy", "html_url": "https://github.com/jimblandy", "followers_url": "https://api.github.com/users/jimblandy/followers", "following_url": "https://api.github.com/users/jimblandy/following{/other_user}", "gists_url": "https://api.github.com/users/jimblandy/gists{/gist_id}", "starred_url": "https://api.github.com/users/jimblandy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jimblandy/subscriptions", "organizations_url": "https://api.github.com/users/jimblandy/orgs", "repos_url": "https://api.github.com/users/jimblandy/repos", "events_url": "https://api.github.com/users/jimblandy/events{/privacy}", "received_events_url": "https://api.github.com/users/jimblandy/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "23503efce3344d0af0bed3ed7fa5d458cafc7fb8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23503efce3344d0af0bed3ed7fa5d458cafc7fb8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23503efce3344d0af0bed3ed7fa5d458cafc7fb8"}], "stats": {"total": 51, "additions": 39, "deletions": 12}, "files": [{"sha": "20aaed376b0777e396f6fc03873993e8a93c93eb", "filename": "intl/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dda441650817aec18d07a390fec35ce24a516ee4/intl%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dda441650817aec18d07a390fec35ce24a516ee4/intl%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/intl%2FChangeLog?ref=dda441650817aec18d07a390fec35ce24a516ee4", "patch": "@@ -1,3 +1,9 @@\n+2009-10-15  Jim Blandy  <jimb@red-bean.com>\n+\n+\t* libgnuintl.h (_INTL_MAY_RETURN_STRING_ARG, gettext, dgettext)\n+\t(dcgettext, ngettext, dngettext, dcngettext): Backport changes\n+\tfrom current gettext to provide GCC format_arg attributes.\n+\n 2009-08-24  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>\n \n \t* configure.ac (AC_PREREQ): Bump to 2.64."}, {"sha": "acc9093a9de968cd4d77aa7dd3ae7a3fb163e695", "filename": "intl/libgnuintl.h", "status": "modified", "additions": 33, "deletions": 12, "changes": 45, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dda441650817aec18d07a390fec35ce24a516ee4/intl%2Flibgnuintl.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dda441650817aec18d07a390fec35ce24a516ee4/intl%2Flibgnuintl.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/intl%2Flibgnuintl.h?ref=dda441650817aec18d07a390fec35ce24a516ee4", "patch": "@@ -112,11 +112,21 @@ extern \"C\" {\n # define _INTL_ASM(cname)\n #endif\n \n+/* _INTL_MAY_RETURN_STRING_ARG(n) declares that the given function may return\n+   its n-th argument literally.  This enables GCC to warn for example about\n+   printf (gettext (\"foo %y\")).  */\n+#if __GNUC__ >= 3 && !(__APPLE_CC__ > 1 && defined __cplusplus)\n+# define _INTL_MAY_RETURN_STRING_ARG(n) __attribute__ ((__format_arg__ (n)))\n+#else\n+# define _INTL_MAY_RETURN_STRING_ARG(n)\n+#endif\n+\n /* Look up MSGID in the current default message catalog for the current\n    LC_MESSAGES locale.  If not found, returns MSGID itself (the default\n    text).  */\n #ifdef _INTL_REDIRECT_INLINE\n-extern char *libintl_gettext (const char *__msgid);\n+extern char *libintl_gettext (const char *__msgid)\n+       _INTL_MAY_RETURN_STRING_ARG (1);\n static inline char *gettext (const char *__msgid)\n {\n   return libintl_gettext (__msgid);\n@@ -126,13 +136,15 @@ static inline char *gettext (const char *__msgid)\n # define gettext libintl_gettext\n #endif\n extern char *gettext _INTL_PARAMS ((const char *__msgid))\n-       _INTL_ASM (libintl_gettext);\n+       _INTL_ASM (libintl_gettext)\n+       _INTL_MAY_RETURN_STRING_ARG (1);\n #endif\n \n /* Look up MSGID in the DOMAINNAME message catalog for the current\n    LC_MESSAGES locale.  */\n #ifdef _INTL_REDIRECT_INLINE\n-extern char *libintl_dgettext (const char *__domainname, const char *__msgid);\n+extern char *libintl_dgettext (const char *__domainname, const char *__msgid)\n+       _INTL_MAY_RETURN_STRING_ARG (2);\n static inline char *dgettext (const char *__domainname, const char *__msgid)\n {\n   return libintl_dgettext (__domainname, __msgid);\n@@ -143,14 +155,16 @@ static inline char *dgettext (const char *__domainname, const char *__msgid)\n #endif\n extern char *dgettext _INTL_PARAMS ((const char *__domainname,\n \t\t\t\t     const char *__msgid))\n-       _INTL_ASM (libintl_dgettext);\n+       _INTL_ASM (libintl_dgettext)\n+       _INTL_MAY_RETURN_STRING_ARG (2);\n #endif\n \n /* Look up MSGID in the DOMAINNAME message catalog for the current CATEGORY\n    locale.  */\n #ifdef _INTL_REDIRECT_INLINE\n extern char *libintl_dcgettext (const char *__domainname, const char *__msgid,\n-\t\t\t\tint __category);\n+\t\t\t\tint __category)\n+       _INTL_MAY_RETURN_STRING_ARG (2);\n static inline char *dcgettext (const char *__domainname, const char *__msgid,\n \t\t\t       int __category)\n {\n@@ -163,15 +177,17 @@ static inline char *dcgettext (const char *__domainname, const char *__msgid,\n extern char *dcgettext _INTL_PARAMS ((const char *__domainname,\n \t\t\t\t      const char *__msgid,\n \t\t\t\t      int __category))\n-       _INTL_ASM (libintl_dcgettext);\n+       _INTL_ASM (libintl_dcgettext)\n+       _INTL_MAY_RETURN_STRING_ARG (2);\n #endif\n \n \n /* Similar to `gettext' but select the plural form corresponding to the\n    number N.  */\n #ifdef _INTL_REDIRECT_INLINE\n extern char *libintl_ngettext (const char *__msgid1, const char *__msgid2,\n-\t\t\t       unsigned long int __n);\n+\t\t\t       unsigned long int __n)\n+       _INTL_MAY_RETURN_STRING_ARG (1) _INTL_MAY_RETURN_STRING_ARG (2);\n static inline char *ngettext (const char *__msgid1, const char *__msgid2,\n \t\t\t      unsigned long int __n)\n {\n@@ -184,14 +200,16 @@ static inline char *ngettext (const char *__msgid1, const char *__msgid2,\n extern char *ngettext _INTL_PARAMS ((const char *__msgid1,\n \t\t\t\t     const char *__msgid2,\n \t\t\t\t     unsigned long int __n))\n-       _INTL_ASM (libintl_ngettext);\n+       _INTL_ASM (libintl_ngettext)\n+       _INTL_MAY_RETURN_STRING_ARG (1) _INTL_MAY_RETURN_STRING_ARG (2);\n #endif\n \n /* Similar to `dgettext' but select the plural form corresponding to the\n    number N.  */\n #ifdef _INTL_REDIRECT_INLINE\n extern char *libintl_dngettext (const char *__domainname, const char *__msgid1,\n-\t\t\t\tconst char *__msgid2, unsigned long int __n);\n+\t\t\t\tconst char *__msgid2, unsigned long int __n)\n+       _INTL_MAY_RETURN_STRING_ARG (2) _INTL_MAY_RETURN_STRING_ARG (3);\n static inline char *dngettext (const char *__domainname, const char *__msgid1,\n \t\t\t       const char *__msgid2, unsigned long int __n)\n {\n@@ -205,15 +223,17 @@ extern char *dngettext _INTL_PARAMS ((const char *__domainname,\n \t\t\t\t      const char *__msgid1,\n \t\t\t\t      const char *__msgid2,\n \t\t\t\t      unsigned long int __n))\n-       _INTL_ASM (libintl_dngettext);\n+       _INTL_ASM (libintl_dngettext)\n+       _INTL_MAY_RETURN_STRING_ARG (2) _INTL_MAY_RETURN_STRING_ARG (3);\n #endif\n \n /* Similar to `dcgettext' but select the plural form corresponding to the\n    number N.  */\n #ifdef _INTL_REDIRECT_INLINE\n extern char *libintl_dcngettext (const char *__domainname,\n \t\t\t\t const char *__msgid1, const char *__msgid2,\n-\t\t\t\t unsigned long int __n, int __category);\n+\t\t\t\t unsigned long int __n, int __category)\n+       _INTL_MAY_RETURN_STRING_ARG (2) _INTL_MAY_RETURN_STRING_ARG (3);\n static inline char *dcngettext (const char *__domainname,\n \t\t\t\tconst char *__msgid1, const char *__msgid2,\n \t\t\t\tunsigned long int __n, int __category)\n@@ -229,7 +249,8 @@ extern char *dcngettext _INTL_PARAMS ((const char *__domainname,\n \t\t\t\t       const char *__msgid2,\n \t\t\t\t       unsigned long int __n,\n \t\t\t\t       int __category))\n-       _INTL_ASM (libintl_dcngettext);\n+       _INTL_ASM (libintl_dcngettext)\n+       _INTL_MAY_RETURN_STRING_ARG (2) _INTL_MAY_RETURN_STRING_ARG (3);\n #endif\n \n "}]}