{"sha": "f5c48b80ce05386d15f25859cecafbc475a21bd3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjVjNDhiODBjZTA1Mzg2ZDE1ZjI1ODU5Y2VjYWZiYzQ3NWEyMWJkMw==", "commit": {"author": {"name": "Kai Tietz", "email": "ktietz@redhat.com", "date": "2011-12-12T13:24:30Z"}, "committer": {"name": "Kai Tietz", "email": "ktietz@gcc.gnu.org", "date": "2011-12-12T13:24:30Z"}, "message": "PR libstdc++/511135\n\t* libsupc++/cxxabi.h (__cxxabi_dtor_type): New type.\n\t(__cxa_throw): Use it for destructor-argument.\n\t* libsupc++/eh_throw.cc (__cxa_throw): Likewise.\n\t* libsupc++/unwind-cxx.h (__cxa_exception): Change type of member\n\texceptionDestructor to __cxxabi_dtor_type.\n\t* config/os/mingw32-w64/os_defines.h (_GLIBCXX_USE_THISCALL_ON_DTOR):\n\tDefine.\n\t(__cxa_dtor_type): Declare target secific type variant.\n\t* config/os/mingw32/os_defines.h: Likewise.\n\nFrom-SVN: r182237", "tree": {"sha": "fb256e22db988e4e02527dbd9b878d0a9519f86b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fb256e22db988e4e02527dbd9b878d0a9519f86b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f5c48b80ce05386d15f25859cecafbc475a21bd3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f5c48b80ce05386d15f25859cecafbc475a21bd3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f5c48b80ce05386d15f25859cecafbc475a21bd3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f5c48b80ce05386d15f25859cecafbc475a21bd3/comments", "author": null, "committer": null, "parents": [{"sha": "b913199ea39e5027a5f4176f245fe7fef1951dcd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b913199ea39e5027a5f4176f245fe7fef1951dcd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b913199ea39e5027a5f4176f245fe7fef1951dcd"}], "stats": {"total": 53, "additions": 43, "deletions": 10}, "files": [{"sha": "bf5afcd909a1b0e211df7a5ef89b7bab0320e079", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5c48b80ce05386d15f25859cecafbc475a21bd3/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5c48b80ce05386d15f25859cecafbc475a21bd3/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=f5c48b80ce05386d15f25859cecafbc475a21bd3", "patch": "@@ -1,3 +1,16 @@\n+2011-12-12  Kai Tietz  <ktietz@redhat.com>\n+\n+\tPR libstdc++/511135\n+\t* libsupc++/cxxabi.h (__cxxabi_dtor_type): New type.\n+\t(__cxa_throw): Use it for destructor-argument.\n+\t* libsupc++/eh_throw.cc (__cxa_throw): Likewise.\n+\t* libsupc++/unwind-cxx.h (__cxa_exception): Change type of member\n+\texceptionDestructor to __cxxabi_dtor_type.\n+\t* config/os/mingw32-w64/os_defines.h (_GLIBCXX_USE_THISCALL_ON_DTOR):\n+\tDefine.\n+\t(__cxa_dtor_type): Declare target secific type variant.\n+\t* config/os/mingw32/os_defines.h: Likewise.\n+\n 2011-12-11  Jonathan Wakely  <jwakely.gcc@gmail.com>\n \n \t* doc/xml/manual/abi.xml: Replace gcc-x.y.z with GCC x.y.z or x.y,"}, {"sha": "b612d06fd7a7777bd120578cd8d597e8fea31ed1", "filename": "libstdc++-v3/config/os/mingw32-w64/os_defines.h", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5c48b80ce05386d15f25859cecafbc475a21bd3/libstdc%2B%2B-v3%2Fconfig%2Fos%2Fmingw32-w64%2Fos_defines.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5c48b80ce05386d15f25859cecafbc475a21bd3/libstdc%2B%2B-v3%2Fconfig%2Fos%2Fmingw32-w64%2Fos_defines.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfig%2Fos%2Fmingw32-w64%2Fos_defines.h?ref=f5c48b80ce05386d15f25859cecafbc475a21bd3", "patch": "@@ -1,7 +1,7 @@\n // Specific definitions for generic platforms  -*- C++ -*-\n \n // Copyright (C) 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008,\n-// 2009, 2010  Free Software Foundation, Inc.\n+// 2009, 2010, 2011  Free Software Foundation, Inc.\n //\n // This file is part of the GNU ISO C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -65,4 +65,12 @@\n // ioctlsocket function doesn't work for normal file-descriptors.\n #define _GLIBCXX_NO_IOCTL 1\n \n+// See libstdc++/51135\n+// Class constructors/destructors have __thiscall calling-convention\n+// for IA 32-bit target.\n+#if defined (__i386__)\n+#define _GLIBCXX_USE_THISCALL_ON_DTOR 1\n+typedef void (__thiscall *__cxa_dtor_type) (void *);\n+#endif\n+\n #endif"}, {"sha": "b612d06fd7a7777bd120578cd8d597e8fea31ed1", "filename": "libstdc++-v3/config/os/mingw32/os_defines.h", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5c48b80ce05386d15f25859cecafbc475a21bd3/libstdc%2B%2B-v3%2Fconfig%2Fos%2Fmingw32%2Fos_defines.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5c48b80ce05386d15f25859cecafbc475a21bd3/libstdc%2B%2B-v3%2Fconfig%2Fos%2Fmingw32%2Fos_defines.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfig%2Fos%2Fmingw32%2Fos_defines.h?ref=f5c48b80ce05386d15f25859cecafbc475a21bd3", "patch": "@@ -1,7 +1,7 @@\n // Specific definitions for generic platforms  -*- C++ -*-\n \n // Copyright (C) 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008,\n-// 2009, 2010  Free Software Foundation, Inc.\n+// 2009, 2010, 2011  Free Software Foundation, Inc.\n //\n // This file is part of the GNU ISO C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -65,4 +65,12 @@\n // ioctlsocket function doesn't work for normal file-descriptors.\n #define _GLIBCXX_NO_IOCTL 1\n \n+// See libstdc++/51135\n+// Class constructors/destructors have __thiscall calling-convention\n+// for IA 32-bit target.\n+#if defined (__i386__)\n+#define _GLIBCXX_USE_THISCALL_ON_DTOR 1\n+typedef void (__thiscall *__cxa_dtor_type) (void *);\n+#endif\n+\n #endif"}, {"sha": "7ed5c559f13e7102d2814f8da543011b6fccc800", "filename": "libstdc++-v3/libsupc++/cxxabi.h", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5c48b80ce05386d15f25859cecafbc475a21bd3/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Fcxxabi.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5c48b80ce05386d15f25859cecafbc475a21bd3/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Fcxxabi.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Fcxxabi.h?ref=f5c48b80ce05386d15f25859cecafbc475a21bd3", "patch": "@@ -51,6 +51,10 @@\n #include <bits/cxxabi_tweaks.h>\n #include <bits/cxxabi_forced.h>\n \n+#ifndef _GLIBCXX_USE_THISCALL_ON_DTOR\n+typedef void (*__cxa_dtor_type) (void *);\n+#endif\n+\n #ifdef __cplusplus\n namespace __cxxabiv1\n {\n@@ -596,7 +600,7 @@ namespace __cxxabiv1\n \n   // Throw the exception.\n   void\n-  __cxa_throw(void*, std::type_info*, void (*) (void *)) \n+  __cxa_throw(void*, std::type_info*, __cxa_dtor_type)\n   __attribute__((__noreturn__));\n \n   // Used to implement exception handlers."}, {"sha": "0791f1a595fec8a3e4fedfea6d052c9acfb7ee55", "filename": "libstdc++-v3/libsupc++/eh_throw.cc", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5c48b80ce05386d15f25859cecafbc475a21bd3/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Feh_throw.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5c48b80ce05386d15f25859cecafbc475a21bd3/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Feh_throw.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Feh_throw.cc?ref=f5c48b80ce05386d15f25859cecafbc475a21bd3", "patch": "@@ -1,6 +1,6 @@\n // -*- C++ -*- Exception handling routines for throwing.\n-// Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009\n-// Free Software Foundation, Inc.\n+// Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009,\n+// 2011  Free Software Foundation, Inc.\n //\n // This file is part of GCC.\n //\n@@ -58,8 +58,8 @@ __gxx_exception_cleanup (_Unwind_Reason_Code code, _Unwind_Exception *exc)\n \n \n extern \"C\" void\n-__cxxabiv1::__cxa_throw (void *obj, std::type_info *tinfo, \n-\t\t\t void (*dest) (void *))\n+__cxxabiv1::__cxa_throw (void *obj, std::type_info *tinfo,\n+\t\t\t __cxa_dtor_type dest)\n {\n   // Definitely a primary.\n   __cxa_refcounted_exception *header"}, {"sha": "b9919ce946856a092018e3445edebe8ec4171128", "filename": "libstdc++-v3/libsupc++/unwind-cxx.h", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5c48b80ce05386d15f25859cecafbc475a21bd3/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Funwind-cxx.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5c48b80ce05386d15f25859cecafbc475a21bd3/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Funwind-cxx.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Funwind-cxx.h?ref=f5c48b80ce05386d15f25859cecafbc475a21bd3", "patch": "@@ -1,6 +1,6 @@\n // -*- C++ -*- Exception handling and frame unwind runtime interface routines.\n-// Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010\n-// Free Software Foundation, Inc.\n+// Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,\n+// 2011  Free Software Foundation, Inc.\n //\n // This file is part of GCC.\n //\n@@ -51,7 +51,7 @@ struct __cxa_exception\n {\n   // Manage the exception object itself.\n   std::type_info *exceptionType;\n-  void (*exceptionDestructor)(void *); \n+  __cxa_dtor_type exceptionDestructor; \n \n   // The C++ standard has entertaining rules wrt calling set_terminate\n   // and set_unexpected in the middle of the exception cleanup process."}]}