{"sha": "ebad523301c12f27e56a3008916e4e41f518ba57", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWJhZDUyMzMwMWMxMmYyN2U1NmEzMDA4OTE2ZTRlNDFmNTE4YmE1Nw==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2010-05-06T19:46:03Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2010-05-06T19:46:03Z"}, "message": "gimplify.c (gimplify_modify_expr_rhs): Don't return GS_OK for stripping WITH_SIZE_EXPR.\n\n\t* gimplify.c (gimplify_modify_expr_rhs): Don't return GS_OK for\n\tstripping WITH_SIZE_EXPR.\n\t(gimplify_expr) [MODIFY_EXPR]: Trust GS_OK even if the rhs didn't\n\tchange.\n\nFrom-SVN: r159124", "tree": {"sha": "a0ded03e5675ac2991167c1d2a5332b05c60dc5f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a0ded03e5675ac2991167c1d2a5332b05c60dc5f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ebad523301c12f27e56a3008916e4e41f518ba57", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ebad523301c12f27e56a3008916e4e41f518ba57", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ebad523301c12f27e56a3008916e4e41f518ba57", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ebad523301c12f27e56a3008916e4e41f518ba57/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9aaa1ee883ca0e914b52d5b4bd21933b77267c28", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9aaa1ee883ca0e914b52d5b4bd21933b77267c28", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9aaa1ee883ca0e914b52d5b4bd21933b77267c28"}], "stats": {"total": 28, "additions": 17, "deletions": 11}, "files": [{"sha": "a7595478ecb2fddd4100ff7f5fbaa90b26475141", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ebad523301c12f27e56a3008916e4e41f518ba57/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ebad523301c12f27e56a3008916e4e41f518ba57/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ebad523301c12f27e56a3008916e4e41f518ba57", "patch": "@@ -1,3 +1,10 @@\n+2010-05-06  Jason Merrill  <jason@redhat.com>\n+\n+\t* gimplify.c (gimplify_modify_expr_rhs): Don't return GS_OK for\n+\tstripping WITH_SIZE_EXPR.\n+\t(gimplify_expr) [MODIFY_EXPR]: Trust GS_OK even if the rhs didn't\n+\tchange.\n+\n 2010-05-06  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \t* config.gcc: Removed mips-sgi-irix5*, mips-sgi-irix6.[0-4]* from"}, {"sha": "51ec4b5633d2e5ba6eeb66c4016dcc40dc6556c4", "filename": "gcc/gimplify.c", "status": "modified", "additions": 10, "deletions": 11, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ebad523301c12f27e56a3008916e4e41f518ba57/gcc%2Fgimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ebad523301c12f27e56a3008916e4e41f518ba57/gcc%2Fgimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimplify.c?ref=ebad523301c12f27e56a3008916e4e41f518ba57", "patch": "@@ -4291,7 +4291,10 @@ gimplify_modify_expr_rhs (tree *expr_p, tree *from_p, tree *to_p,\n \t  if (TREE_CODE (TREE_OPERAND (*from_p, 0)) == CALL_EXPR)\n \t    {\n \t      *from_p = TREE_OPERAND (*from_p, 0);\n-\t      ret = GS_OK;\n+\t      /* We don't change ret in this case because the\n+\t\t WITH_SIZE_EXPR might have been added in\n+\t\t gimplify_modify_expr, so returning GS_OK would lead to an\n+\t\t infinite loop.  */\n \t      changed = true;\n \t    }\n \t  break;\n@@ -6628,16 +6631,12 @@ gimplify_expr (tree *expr_p, gimple_seq *pre_p, gimple_seq *post_p,\n \n \tcase MODIFY_EXPR:\n \tcase INIT_EXPR:\n-\t  {\n-\t    tree from = TREE_OPERAND (*expr_p, 1);\n-\t    ret = gimplify_modify_expr (expr_p, pre_p, post_p,\n-\t\t\t\t\tfallback != fb_none);\n-\t    /* Don't let the end of loop logic change GS_OK into GS_ALL_DONE\n-\t       if the RHS has changed.  */\n-\t    if (ret == GS_OK && *expr_p == save_expr\n-\t\t&& TREE_OPERAND (*expr_p, 1) != from)\n-\t      continue;\n-\t  }\n+\t  ret = gimplify_modify_expr (expr_p, pre_p, post_p,\n+\t\t\t\t      fallback != fb_none);\n+\t  /* Don't let the end of loop logic change GS_OK to GS_ALL_DONE;\n+\t     gimplify_modify_expr_rhs might have changed the RHS.  */\n+\t  if (ret == GS_OK && *expr_p)\n+\t    continue;\n \t  break;\n \n \tcase TRUTH_ANDIF_EXPR:"}]}