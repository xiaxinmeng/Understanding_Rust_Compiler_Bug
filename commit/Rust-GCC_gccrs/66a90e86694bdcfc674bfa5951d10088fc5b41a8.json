{"sha": "66a90e86694bdcfc674bfa5951d10088fc5b41a8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjZhOTBlODY2OTRiZGNmYzY3NGJmYTU5NTFkMTAwODhmYzViNDFhOA==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2018-02-08T09:06:33Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2018-02-08T09:06:33Z"}, "message": "re PR c++/83204 (c++ -std=c++14 ICE in maybe_undo_parenthesized_ref, at cp/semantics.c:1694)\n\n/cp\n2018-02-08  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/83204\n\t* pt.c (tsubst_copy_and_build): Use force_paren_expr for INDIRECT_REF.\n\n/testsuite\n2018-02-08  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/83204\n\t* g++.dg/cpp0x/lambda/lambda-ice25.C: New.\n\nFrom-SVN: r257478", "tree": {"sha": "dab98eb6e79d3bf8ebe3ae7cfc624718b2f0fb30", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/dab98eb6e79d3bf8ebe3ae7cfc624718b2f0fb30"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/66a90e86694bdcfc674bfa5951d10088fc5b41a8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66a90e86694bdcfc674bfa5951d10088fc5b41a8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/66a90e86694bdcfc674bfa5951d10088fc5b41a8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66a90e86694bdcfc674bfa5951d10088fc5b41a8/comments", "author": null, "committer": null, "parents": [{"sha": "f986f7e4bbeba1a8478ccc88aebc34d3eb97286b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f986f7e4bbeba1a8478ccc88aebc34d3eb97286b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f986f7e4bbeba1a8478ccc88aebc34d3eb97286b"}], "stats": {"total": 41, "additions": 39, "deletions": 2}, "files": [{"sha": "b898ba15a37e8e8645704f0b48675487d0a51fb9", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66a90e86694bdcfc674bfa5951d10088fc5b41a8/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66a90e86694bdcfc674bfa5951d10088fc5b41a8/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=66a90e86694bdcfc674bfa5951d10088fc5b41a8", "patch": "@@ -1,3 +1,8 @@\n+2018-02-08  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/83204\n+\t* pt.c (tsubst_copy_and_build): Use force_paren_expr for INDIRECT_REF.\n+\n 2018-02-07  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/84082"}, {"sha": "a9e4770152734029170156130a65975039881f98", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66a90e86694bdcfc674bfa5951d10088fc5b41a8/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66a90e86694bdcfc674bfa5951d10088fc5b41a8/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=66a90e86694bdcfc674bfa5951d10088fc5b41a8", "patch": "@@ -17224,8 +17224,8 @@ tsubst_copy_and_build (tree t,\n \t  r = build_x_indirect_ref (input_location, r, RO_UNARY_STAR,\n \t\t\t\t    complain|decltype_flag);\n \n-\tif (TREE_CODE (r) == INDIRECT_REF)\n-\t  REF_PARENTHESIZED_P (r) = REF_PARENTHESIZED_P (t);\n+\tif (REF_PARENTHESIZED_P (t))\n+\t  r = force_paren_expr (r);\n \n \tRETURN (r);\n       }"}, {"sha": "16f2b1a952260b0389b87642279d6bed77b93690", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66a90e86694bdcfc674bfa5951d10088fc5b41a8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66a90e86694bdcfc674bfa5951d10088fc5b41a8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=66a90e86694bdcfc674bfa5951d10088fc5b41a8", "patch": "@@ -1,3 +1,8 @@\n+2018-02-08  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/83204\n+\t* g++.dg/cpp0x/lambda/lambda-ice25.C: New.\n+\n 2018-02-07  Will Schmidt  <will_schmidt@vnet.ibm.com>\n \n \t* gcc.target/powerpc/vsxcopy.c: Update scan-assembler stanzas."}, {"sha": "1a33fb1636447b83644950b29bff93cf1ce9aa73", "filename": "gcc/testsuite/g++.dg/cpp0x/lambda/lambda-ice25.C", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66a90e86694bdcfc674bfa5951d10088fc5b41a8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-ice25.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66a90e86694bdcfc674bfa5951d10088fc5b41a8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-ice25.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-ice25.C?ref=66a90e86694bdcfc674bfa5951d10088fc5b41a8", "patch": "@@ -0,0 +1,27 @@\n+// PR c++/83204\n+// { dg-do compile { target c++11 } }\n+\n+int rand();\n+\n+template<typename T>\n+struct s\n+{\n+    int count() { return rand(); }\n+};\n+\n+template<typename v>\n+void f(s<v> a)\n+{\n+    int const x = a.count();\n+    int r = 0;\n+    auto l = [&](int& r)\n+    {\n+        for(int y = 0, yend = (x); y < yend; ++y)\n+        {\n+            r += y;\n+        }\n+    };\n+    l(r);\n+}\n+\n+template void f(s<float>);"}]}