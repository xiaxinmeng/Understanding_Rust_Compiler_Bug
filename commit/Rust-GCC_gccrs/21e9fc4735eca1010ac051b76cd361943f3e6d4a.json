{"sha": "21e9fc4735eca1010ac051b76cd361943f3e6d4a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjFlOWZjNDczNWVjYTEwMTBhYzA1MWI3NmNkMzYxOTQzZjNlNmQ0YQ==", "commit": {"author": {"name": "Richard Sandiford", "email": "rsandifo@redhat.com", "date": "2003-11-04T09:14:18Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2003-11-04T09:14:18Z"}, "message": "emit-rtl.c (copy_rtx_if_shared): Don't allow MEMs with constant addresses to be shared.\n\n\t* emit-rtl.c (copy_rtx_if_shared): Don't allow MEMs with constant\n\taddresses to be shared.\n\t(force_const_mem): Return a copy of the pool entry.\n\nFrom-SVN: r73248", "tree": {"sha": "794f7f482bbd70e6e9a2a4361659acc02fe2a1e8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/794f7f482bbd70e6e9a2a4361659acc02fe2a1e8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/21e9fc4735eca1010ac051b76cd361943f3e6d4a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/21e9fc4735eca1010ac051b76cd361943f3e6d4a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/21e9fc4735eca1010ac051b76cd361943f3e6d4a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/21e9fc4735eca1010ac051b76cd361943f3e6d4a/comments", "author": null, "committer": null, "parents": [{"sha": "7807fcd903c2a016ee64a6ac6ce66443e801791f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7807fcd903c2a016ee64a6ac6ce66443e801791f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7807fcd903c2a016ee64a6ac6ce66443e801791f"}], "stats": {"total": 24, "additions": 8, "deletions": 16}, "files": [{"sha": "e26d5c3ac59b7b45de36a3547cea7db1e491d73e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/21e9fc4735eca1010ac051b76cd361943f3e6d4a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/21e9fc4735eca1010ac051b76cd361943f3e6d4a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=21e9fc4735eca1010ac051b76cd361943f3e6d4a", "patch": "@@ -1,3 +1,9 @@\n+2003-11-04  Richard Sandiford  <rsandifo@redhat.com>\n+\n+\t* emit-rtl.c (copy_rtx_if_shared): Don't allow MEMs with constant\n+\taddresses to be shared.\n+\t(force_const_mem): Return a copy of the pool entry.\n+\n 2003-11-03  Andreas Jaeger  <aj@suse.de>\n \n \t* Makefile.in (GCC_CFLAGS): Remove @WERROR@ again."}, {"sha": "9c50e2371fd6d78f9012423153bdf9eaa9e61fd0", "filename": "gcc/emit-rtl.c", "status": "modified", "additions": 0, "deletions": 14, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/21e9fc4735eca1010ac051b76cd361943f3e6d4a/gcc%2Femit-rtl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/21e9fc4735eca1010ac051b76cd361943f3e6d4a/gcc%2Femit-rtl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Femit-rtl.c?ref=21e9fc4735eca1010ac051b76cd361943f3e6d4a", "patch": "@@ -2690,20 +2690,6 @@ copy_rtx_if_shared (rtx orig)\n       /* The chain of insns is not being copied.  */\n       return x;\n \n-    case MEM:\n-      /* A MEM is allowed to be shared if its address is constant.\n-\n-\t We used to allow sharing of MEMs which referenced\n-\t virtual_stack_vars_rtx or virtual_incoming_args_rtx, but\n-\t that can lose.  instantiate_virtual_regs will not unshare\n-\t the MEMs, and combine may change the structure of the address\n-\t because it looks safe and profitable in one context, but\n-\t in some other context it creates unrecognizable RTL.  */\n-      if (CONSTANT_ADDRESS_P (XEXP (x, 0)))\n-\treturn x;\n-\n-      break;\n-\n     default:\n       break;\n     }"}, {"sha": "21b76b9a59cb725401890ce1a42943d982303e20", "filename": "gcc/varasm.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/21e9fc4735eca1010ac051b76cd361943f3e6d4a/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/21e9fc4735eca1010ac051b76cd361943f3e6d4a/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=21e9fc4735eca1010ac051b76cd361943f3e6d4a", "patch": "@@ -2915,7 +2915,7 @@ force_const_mem (enum machine_mode mode, rtx x)\n   hash = const_hash_rtx (mode, x);\n   for (desc = const_rtx_hash_table[hash]; desc; desc = desc->next)\n     if (compare_constant_rtx (mode, x, desc))\n-      return desc->rtl;\n+      return copy_rtx (desc->rtl);\n \n   /* No constant equal to X is known to have been output.\n      Make a constant descriptor to enter X in the hash table\n@@ -2983,7 +2983,7 @@ force_const_mem (enum machine_mode mode, rtx x)\n   SYMBOL_REF_FLAGS (symbol) = SYMBOL_FLAG_LOCAL;\n   current_function_uses_const_pool = 1;\n \n-  return def;\n+  return copy_rtx (def);\n }\n \f\n /* Given a SYMBOL_REF with CONSTANT_POOL_ADDRESS_P true, return a pointer to"}]}