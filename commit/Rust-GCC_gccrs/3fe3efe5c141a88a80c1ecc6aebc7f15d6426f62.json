{"sha": "3fe3efe5c141a88a80c1ecc6aebc7f15d6426f62", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2ZlM2VmZTVjMTQxYTg4YTgwYzFlY2M2YWViYzdmMTVkNjQyNmY2Mg==", "commit": {"author": {"name": "Martin Storsj\u00f6", "email": "martin@martin.st", "date": "2020-09-07T11:18:42Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2020-09-07T11:20:21Z"}, "message": "gcc: Make strchr return value pointers const\n\nThis fixes compilation of codepaths for dos-like filesystems\nwith Clang. When built with clang, it treats C input files as C++\nwhen the compiler driver is invoked in C++ mode, triggering errors\nwhen the return value of strchr() on a pointer to const is assigned\nto a pointer to non-const variable.\n\nThis matches similar variables outside of the ifdefs for dos-like\npath handling.\n\n2020-09-07  Martin Storsj\u00f6  <martin@martin.st>\n\ngcc/\n\t* dwarf2out.c (file_name_acquire): Make a strchr return value\n\tpointer to const.\nlibcpp/\n\t* files.c (remap_filename): Make a strchr return value pointer\n\tto const.", "tree": {"sha": "d4832db5123a59b6a45fd2783e8f75d4e975784f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d4832db5123a59b6a45fd2783e8f75d4e975784f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3fe3efe5c141a88a80c1ecc6aebc7f15d6426f62", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3fe3efe5c141a88a80c1ecc6aebc7f15d6426f62", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3fe3efe5c141a88a80c1ecc6aebc7f15d6426f62", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3fe3efe5c141a88a80c1ecc6aebc7f15d6426f62/comments", "author": {"login": "mstorsjo", "id": 69727, "node_id": "MDQ6VXNlcjY5NzI3", "avatar_url": "https://avatars.githubusercontent.com/u/69727?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mstorsjo", "html_url": "https://github.com/mstorsjo", "followers_url": "https://api.github.com/users/mstorsjo/followers", "following_url": "https://api.github.com/users/mstorsjo/following{/other_user}", "gists_url": "https://api.github.com/users/mstorsjo/gists{/gist_id}", "starred_url": "https://api.github.com/users/mstorsjo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mstorsjo/subscriptions", "organizations_url": "https://api.github.com/users/mstorsjo/orgs", "repos_url": "https://api.github.com/users/mstorsjo/repos", "events_url": "https://api.github.com/users/mstorsjo/events{/privacy}", "received_events_url": "https://api.github.com/users/mstorsjo/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2b0df0a6ac79b34f5fac4f3d456e8e14db220e4a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b0df0a6ac79b34f5fac4f3d456e8e14db220e4a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2b0df0a6ac79b34f5fac4f3d456e8e14db220e4a"}], "stats": {"total": 4, "additions": 2, "deletions": 2}, "files": [{"sha": "4096c0c0d69f70bc2e6f331d5d9d220c24a3162d", "filename": "gcc/dwarf2out.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3fe3efe5c141a88a80c1ecc6aebc7f15d6426f62/gcc%2Fdwarf2out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3fe3efe5c141a88a80c1ecc6aebc7f15d6426f62/gcc%2Fdwarf2out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.c?ref=3fe3efe5c141a88a80c1ecc6aebc7f15d6426f62", "patch": "@@ -12118,7 +12118,7 @@ file_name_acquire (dwarf_file_data **slot, file_name_acquire_data *fnad)\n   f = strrchr (f, DIR_SEPARATOR);\n #if defined (DIR_SEPARATOR_2)\n   {\n-    char *g = strrchr (fi->path, DIR_SEPARATOR_2);\n+    const char *g = strrchr (fi->path, DIR_SEPARATOR_2);\n \n     if (g != NULL)\n       {"}, {"sha": "b890b8ebf1e07c82dbfe1b32166337b6ea8f73e7", "filename": "libcpp/files.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3fe3efe5c141a88a80c1ecc6aebc7f15d6426f62/libcpp%2Ffiles.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3fe3efe5c141a88a80c1ecc6aebc7f15d6426f62/libcpp%2Ffiles.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Ffiles.c?ref=3fe3efe5c141a88a80c1ecc6aebc7f15d6426f62", "patch": "@@ -1693,7 +1693,7 @@ remap_filename (cpp_reader *pfile, _cpp_file *file)\n       p = strchr (fname, '/');\n #ifdef HAVE_DOS_BASED_FILE_SYSTEM\n       {\n-\tchar *p2 = strchr (fname, '\\\\');\n+\tconst char *p2 = strchr (fname, '\\\\');\n \tif (!p || (p > p2))\n \t  p = p2;\n       }"}]}