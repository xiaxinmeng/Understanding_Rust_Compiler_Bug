{"sha": "58864d1c7a4f6ae4642c6d8fd93b52b7586893ac", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTg4NjRkMWM3YTRmNmFlNDY0MmM2ZDhmZDkzYjUyYjc1ODY4OTNhYw==", "commit": {"author": {"name": "Louis Krupp", "email": "louis.krupp@zoho.com", "date": "2015-10-06T23:47:18Z"}, "committer": {"name": "Louis Krupp", "email": "lkrupp@gcc.gnu.org", "date": "2015-10-06T23:47:18Z"}, "message": "[multiple changes]\n\n2015-10-06  Louis Krupp <louis.krupp@zoho.com>\n\tPR fortran/65766\n\t* resolve.c (gfc_resolve_substring_charlen): For derived type,\n\tuse typespec of string component when resolving substring length.\n\n2015-10-06  Louis Krupp     <louis.krupp@zoho.com>\n\n\tPR fortran/65766\n\t* gfortran.dg/substr_alloc_string_comp_1.f90: New.\n\nFrom-SVN: r228551", "tree": {"sha": "284a952dbaa2d667bb8889bd480e3f2c06d5415a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/284a952dbaa2d667bb8889bd480e3f2c06d5415a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/58864d1c7a4f6ae4642c6d8fd93b52b7586893ac", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/58864d1c7a4f6ae4642c6d8fd93b52b7586893ac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/58864d1c7a4f6ae4642c6d8fd93b52b7586893ac", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/58864d1c7a4f6ae4642c6d8fd93b52b7586893ac/comments", "author": null, "committer": null, "parents": [{"sha": "c12df35927747bd91c0a2d0ffce030f2cdb9f722", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c12df35927747bd91c0a2d0ffce030f2cdb9f722", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c12df35927747bd91c0a2d0ffce030f2cdb9f722"}], "stats": {"total": 25, "additions": 22, "deletions": 3}, "files": [{"sha": "4dba1deac9e2ca9cefefff22708d33593ec590eb", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58864d1c7a4f6ae4642c6d8fd93b52b7586893ac/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58864d1c7a4f6ae4642c6d8fd93b52b7586893ac/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=58864d1c7a4f6ae4642c6d8fd93b52b7586893ac", "patch": "@@ -1,3 +1,8 @@\n+2015-10-06  Louis Krupp <louis.krupp@zoho.com>\n+\tPR fortran/65766\n+\t* resolve.c (gfc_resolve_substring_charlen): For derived type,\n+\tuse typespec of string component when resolving substring length.\n+\n 2015-10-04  Mikael Morin  <mikael@gcc.gnu.org>\n \n \t* match.c (gfc_match_common): Remove dead variable old_blank_common."}, {"sha": "50b5c1d2a330cab14ec9557f850bb6b4b2336733", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 12, "deletions": 3, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58864d1c7a4f6ae4642c6d8fd93b52b7586893ac/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58864d1c7a4f6ae4642c6d8fd93b52b7586893ac/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=58864d1c7a4f6ae4642c6d8fd93b52b7586893ac", "patch": "@@ -4543,10 +4543,15 @@ gfc_resolve_substring_charlen (gfc_expr *e)\n {\n   gfc_ref *char_ref;\n   gfc_expr *start, *end;\n+  gfc_typespec *ts = NULL;\n \n   for (char_ref = e->ref; char_ref; char_ref = char_ref->next)\n-    if (char_ref->type == REF_SUBSTRING)\n-      break;\n+    {\n+      if (char_ref->type == REF_SUBSTRING)\n+      \tbreak;\n+      if (char_ref->type == REF_COMPONENT)\n+\tts = &char_ref->u.c.component->ts;\n+    }\n \n   if (!char_ref)\n     return;\n@@ -4576,7 +4581,11 @@ gfc_resolve_substring_charlen (gfc_expr *e)\n   if (char_ref->u.ss.end)\n     end = gfc_copy_expr (char_ref->u.ss.end);\n   else if (e->expr_type == EXPR_VARIABLE)\n-    end = gfc_copy_expr (e->symtree->n.sym->ts.u.cl->length);\n+    {\n+      if (!ts)\n+\tts = &e->symtree->n.sym->ts;\n+      end = gfc_copy_expr (ts->u.cl->length);\n+    }\n   else\n     end = NULL;\n "}, {"sha": "4ec4743eb48f308cd141da0fc1e6f4807135d198", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58864d1c7a4f6ae4642c6d8fd93b52b7586893ac/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58864d1c7a4f6ae4642c6d8fd93b52b7586893ac/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=58864d1c7a4f6ae4642c6d8fd93b52b7586893ac", "patch": "@@ -2,6 +2,11 @@\n \n \t* gcc.target/aarch64/get_lane_f16_1.c: New test.\n \n+2015-10-06  Louis Krupp     <louis.krupp@zoho.com>\n+\n+\tPR fortran/65766\n+\t* gfortran.dg/substr_alloc_string_comp_1.f90: New.\n+\n 2015-10-06  Marek Polacek  <polacek@redhat.com>\n \n \tPR c++/67863"}]}