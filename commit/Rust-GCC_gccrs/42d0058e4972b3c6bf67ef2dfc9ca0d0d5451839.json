{"sha": "42d0058e4972b3c6bf67ef2dfc9ca0d0d5451839", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDJkMDA1OGU0OTcyYjNjNmJmNjdlZjJkZmM5Y2EwZDBkNTQ1MTgzOQ==", "commit": {"author": {"name": "Mikael Morin", "email": "mikael@gcc.gnu.org", "date": "2011-11-03T22:29:25Z"}, "committer": {"name": "Mikael Morin", "email": "mikael@gcc.gnu.org", "date": "2011-11-03T22:29:25Z"}, "message": "trans.h (struct gfc_ss, [...]): Move field gfc_ss::where into gfc_ss_info.\n\n\t* trans.h (struct gfc_ss, struct gfc_ss_info): Move field\n\tgfc_ss::where into gfc_ss_info.\n\t* trans-array.c (gfc_add_loop_ss_code):\n\tUpdate reference chains.\n\t* trans-stmt.c (gfc_trans_where_assign, gfc_trans_where_3): Ditto.\n\nFrom-SVN: r180877", "tree": {"sha": "b924b38f05bcb9fee71a912b4c69eb58b408cd0a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b924b38f05bcb9fee71a912b4c69eb58b408cd0a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/42d0058e4972b3c6bf67ef2dfc9ca0d0d5451839", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/42d0058e4972b3c6bf67ef2dfc9ca0d0d5451839", "html_url": "https://github.com/Rust-GCC/gccrs/commit/42d0058e4972b3c6bf67ef2dfc9ca0d0d5451839", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/42d0058e4972b3c6bf67ef2dfc9ca0d0d5451839/comments", "author": null, "committer": null, "parents": [{"sha": "7a412892a6b9234be08dee746a8b15b770756d99", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a412892a6b9234be08dee746a8b15b770756d99", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7a412892a6b9234be08dee746a8b15b770756d99"}], "stats": {"total": 23, "additions": 16, "deletions": 7}, "files": [{"sha": "802c2ff4ba838d12b8c091ad2533cbfb2da6aba3", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/42d0058e4972b3c6bf67ef2dfc9ca0d0d5451839/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/42d0058e4972b3c6bf67ef2dfc9ca0d0d5451839/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=42d0058e4972b3c6bf67ef2dfc9ca0d0d5451839", "patch": "@@ -1,3 +1,11 @@\n+2011-11-03  Mikael Morin  <mikael@gcc.gnu.org>\n+\n+\t* trans.h (struct gfc_ss, struct gfc_ss_info): Move field\n+\tgfc_ss::where into gfc_ss_info.\n+\t* trans-array.c (gfc_add_loop_ss_code):\n+\tUpdate reference chains.\n+\t* trans-stmt.c (gfc_trans_where_assign, gfc_trans_where_3): Ditto.\n+\n 2011-11-03  Mikael Morin  <mikael@gcc.gnu.org>\n \n \t* trans.h (struct gfc_ss, struct gfc_ss_info): Move field"}, {"sha": "045c426cab10dd934c92759f3ae4c6e29e1de99a", "filename": "gcc/fortran/trans-array.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/42d0058e4972b3c6bf67ef2dfc9ca0d0d5451839/gcc%2Ffortran%2Ftrans-array.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/42d0058e4972b3c6bf67ef2dfc9ca0d0d5451839/gcc%2Ffortran%2Ftrans-array.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-array.c?ref=42d0058e4972b3c6bf67ef2dfc9ca0d0d5451839", "patch": "@@ -2203,7 +2203,7 @@ gfc_add_loop_ss_code (gfc_loopinfo * loop, gfc_ss * ss, bool subscript,\n \t\t scalarization loop, except for WHERE assignments.  */\n \t      if (subscript)\n \t\tse.expr = convert(gfc_array_index_type, se.expr);\n-\t      if (!ss->where)\n+\t      if (!ss_info->where)\n \t\tse.expr = gfc_evaluate_now (se.expr, &loop->pre);\n \t      gfc_add_block_to_block (&loop->pre, &se.post);\n \t    }"}, {"sha": "86a56e8c19a40cae900b6f5d72cb3c0e6270e740", "filename": "gcc/fortran/trans-stmt.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/42d0058e4972b3c6bf67ef2dfc9ca0d0d5451839/gcc%2Ffortran%2Ftrans-stmt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/42d0058e4972b3c6bf67ef2dfc9ca0d0d5451839/gcc%2Ffortran%2Ftrans-stmt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-stmt.c?ref=42d0058e4972b3c6bf67ef2dfc9ca0d0d5451839", "patch": "@@ -4062,7 +4062,7 @@ gfc_trans_where_assign (gfc_expr *expr1, gfc_expr *expr2,\n     {\n       /* The rhs is scalar.  Add a ss for the expression.  */\n       rss = gfc_get_scalar_ss (gfc_ss_terminator, expr2);\n-      rss->where = 1;\n+      rss->info->where = 1;\n     }\n \n   /* Associate the SS with the loop.  */\n@@ -4501,7 +4501,7 @@ gfc_trans_where_3 (gfc_code * cblock, gfc_code * eblock)\n   if (tsss == gfc_ss_terminator)\n     {\n       tsss = gfc_get_scalar_ss (gfc_ss_terminator, tsrc);\n-      tsss->where = 1;\n+      tsss->info->where = 1;\n     }\n   gfc_add_ss_to_loop (&loop, tdss);\n   gfc_add_ss_to_loop (&loop, tsss);\n@@ -4516,7 +4516,7 @@ gfc_trans_where_3 (gfc_code * cblock, gfc_code * eblock)\n       if (esss == gfc_ss_terminator)\n \t{\n \t  esss = gfc_get_scalar_ss (gfc_ss_terminator, esrc);\n-\t  esss->where = 1;\n+\t  esss->info->where = 1;\n \t}\n       gfc_add_ss_to_loop (&loop, edss);\n       gfc_add_ss_to_loop (&loop, esss);"}, {"sha": "c35b1ae0fdacbb3812588188f118dd760922cc3f", "filename": "gcc/fortran/trans.h", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/42d0058e4972b3c6bf67ef2dfc9ca0d0d5451839/gcc%2Ffortran%2Ftrans.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/42d0058e4972b3c6bf67ef2dfc9ca0d0d5451839/gcc%2Ffortran%2Ftrans.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans.h?ref=42d0058e4972b3c6bf67ef2dfc9ca0d0d5451839", "patch": "@@ -214,6 +214,9 @@ typedef struct gfc_ss_info\n      loops the terms appear in.  This will be 1 for the RHS expressions,\n      2 for the LHS expressions, and 3(=1|2) for the temporary.  */\n   unsigned useflags:2;\n+\n+  /* Suppresses precalculation of scalars in WHERE assignments.  */\n+  unsigned where:1;\n }\n gfc_ss_info;\n \n@@ -242,9 +245,7 @@ typedef struct gfc_ss\n   struct gfc_ss *loop_chain;\n   struct gfc_ss *next;\n \n-  /* The bit 'where' suppresses precalculation of scalars in WHERE assignments.\n-  */\n-  unsigned where:1, is_alloc_lhs:1;\n+  unsigned is_alloc_lhs:1;\n }\n gfc_ss;\n #define gfc_get_ss() XCNEW (gfc_ss)"}]}