{"sha": "9a594ad6ef76d46da25ef7820451fff7907d50bf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWE1OTRhZDZlZjc2ZDQ2ZGEyNWVmNzgyMDQ1MWZmZjc5MDdkNTBiZg==", "commit": {"author": {"name": "Jiong Wang", "email": "jiong.wang@arm.com", "date": "2016-07-25T16:13:22Z"}, "committer": {"name": "Jiong Wang", "email": "jiwang@gcc.gnu.org", "date": "2016-07-25T16:13:22Z"}, "message": "[AArch64][9/10] ARMv8.2-A FP16 three operands scalar intrinsics\n\ngcc/\n\t* config/aarch64/aarch64-simd-builtins.def: Register new builtins.\n\t* config/aarch64/aarch64.md (fma, fnma): Support HF.\n\t* config/aarch64/arm_fp16.h (vfmah_f16, vfmsh_f16): New.\n\nFrom-SVN: r238724", "tree": {"sha": "4c422015c975da2319df4e6bea103ae1781e7450", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4c422015c975da2319df4e6bea103ae1781e7450"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9a594ad6ef76d46da25ef7820451fff7907d50bf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a594ad6ef76d46da25ef7820451fff7907d50bf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9a594ad6ef76d46da25ef7820451fff7907d50bf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a594ad6ef76d46da25ef7820451fff7907d50bf/comments", "author": null, "committer": null, "parents": [{"sha": "68ad28c34a53456625df599035f7b6530b46ba0f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/68ad28c34a53456625df599035f7b6530b46ba0f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/68ad28c34a53456625df599035f7b6530b46ba0f"}], "stats": {"total": 43, "additions": 33, "deletions": 10}, "files": [{"sha": "c1da62a26fe34e3fe8863b23cefe4ff73fd4a9a0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a594ad6ef76d46da25ef7820451fff7907d50bf/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a594ad6ef76d46da25ef7820451fff7907d50bf/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9a594ad6ef76d46da25ef7820451fff7907d50bf", "patch": "@@ -1,3 +1,9 @@\n+2016-07-25  Jiong Wang  <jiong.wang@arm.com>\n+\n+\t* config/aarch64/aarch64-simd-builtins.def: Register new builtins.\n+\t* config/aarch64/aarch64.md (fma, fnma): Support HF.\n+\t* config/aarch64/arm_fp16.h (vfmah_f16, vfmsh_f16): New.\n+\n 2016-07-25  Jiong Wang  <jiong.wang@arm.com>\n \n \t* config/aarch64/aarch64-simd-builtins.def: Register new builtins."}, {"sha": "c7fe08bb21a066fd232e2fad35c59e267b2efd62", "filename": "gcc/config/aarch64/aarch64-simd-builtins.def", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a594ad6ef76d46da25ef7820451fff7907d50bf/gcc%2Fconfig%2Faarch64%2Faarch64-simd-builtins.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a594ad6ef76d46da25ef7820451fff7907d50bf/gcc%2Fconfig%2Faarch64%2Faarch64-simd-builtins.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64-simd-builtins.def?ref=9a594ad6ef76d46da25ef7820451fff7907d50bf", "patch": "@@ -422,8 +422,10 @@\n \n   /* Implemented by fma<mode>4.  */\n   BUILTIN_VHSDF (TERNOP, fma, 4)\n+  VAR1 (TERNOP, fma, 4, hf)\n   /* Implemented by fnma<mode>4.  */\n   BUILTIN_VHSDF (TERNOP, fnma, 4)\n+  VAR1 (TERNOP, fnma, 4, hf)\n \n   /* Implemented by aarch64_simd_bsl<mode>.  */\n   BUILTIN_VDQQH (BSL_P, simd_bsl, 0)"}, {"sha": "7d8b394310063e58814224c198769e3dc200b66a", "filename": "gcc/config/aarch64/aarch64.md", "status": "modified", "additions": 11, "deletions": 10, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a594ad6ef76d46da25ef7820451fff7907d50bf/gcc%2Fconfig%2Faarch64%2Faarch64.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a594ad6ef76d46da25ef7820451fff7907d50bf/gcc%2Fconfig%2Faarch64%2Faarch64.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64.md?ref=9a594ad6ef76d46da25ef7820451fff7907d50bf", "patch": "@@ -4492,23 +4492,24 @@\n ;; fma - no throw\n \n (define_insn \"fma<mode>4\"\n-  [(set (match_operand:GPF 0 \"register_operand\" \"=w\")\n-        (fma:GPF (match_operand:GPF 1 \"register_operand\" \"w\")\n-\t\t (match_operand:GPF 2 \"register_operand\" \"w\")\n-\t\t (match_operand:GPF 3 \"register_operand\" \"w\")))]\n+  [(set (match_operand:GPF_F16 0 \"register_operand\" \"=w\")\n+        (fma:GPF_F16 (match_operand:GPF_F16 1 \"register_operand\" \"w\")\n+\t\t     (match_operand:GPF_F16 2 \"register_operand\" \"w\")\n+\t\t     (match_operand:GPF_F16 3 \"register_operand\" \"w\")))]\n   \"TARGET_FLOAT\"\n   \"fmadd\\\\t%<s>0, %<s>1, %<s>2, %<s>3\"\n-  [(set_attr \"type\" \"fmac<s>\")]\n+  [(set_attr \"type\" \"fmac<stype>\")]\n )\n \n (define_insn \"fnma<mode>4\"\n-  [(set (match_operand:GPF 0 \"register_operand\" \"=w\")\n-\t(fma:GPF (neg:GPF (match_operand:GPF 1 \"register_operand\" \"w\"))\n-\t\t (match_operand:GPF 2 \"register_operand\" \"w\")\n-\t\t (match_operand:GPF 3 \"register_operand\" \"w\")))]\n+  [(set (match_operand:GPF_F16 0 \"register_operand\" \"=w\")\n+\t(fma:GPF_F16\n+\t  (neg:GPF_F16 (match_operand:GPF_F16 1 \"register_operand\" \"w\"))\n+\t  (match_operand:GPF_F16 2 \"register_operand\" \"w\")\n+\t  (match_operand:GPF_F16 3 \"register_operand\" \"w\")))]\n   \"TARGET_FLOAT\"\n   \"fmsub\\\\t%<s>0, %<s>1, %<s>2, %<s>3\"\n-  [(set_attr \"type\" \"fmac<s>\")]\n+  [(set_attr \"type\" \"fmac<stype>\")]\n )\n \n (define_insn \"fms<mode>4\""}, {"sha": "4b7c2dd3bcc95379c1f912b89956263ce064a832", "filename": "gcc/config/aarch64/arm_fp16.h", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a594ad6ef76d46da25ef7820451fff7907d50bf/gcc%2Fconfig%2Faarch64%2Farm_fp16.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a594ad6ef76d46da25ef7820451fff7907d50bf/gcc%2Fconfig%2Faarch64%2Farm_fp16.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Farm_fp16.h?ref=9a594ad6ef76d46da25ef7820451fff7907d50bf", "patch": "@@ -560,6 +560,20 @@ vsubh_f16 (float16_t __a, float16_t __b)\n   return __a - __b;\n }\n \n+/* ARMv8.2-A FP16 three operands scalar intrinsics.  */\n+\n+__extension__ static __inline float16_t __attribute__ ((__always_inline__))\n+vfmah_f16 (float16_t __a, float16_t __b, float16_t __c)\n+{\n+  return __builtin_aarch64_fmahf (__b, __c, __a);\n+}\n+\n+__extension__ static __inline float16_t __attribute__ ((__always_inline__))\n+vfmsh_f16 (float16_t __a, float16_t __b, float16_t __c)\n+{\n+  return __builtin_aarch64_fnmahf (__b, __c, __a);\n+}\n+\n #pragma GCC pop_options\n \n #endif"}]}