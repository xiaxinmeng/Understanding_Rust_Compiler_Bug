{"sha": "3164517929a2f21feb2c7668a4941a36288f57d3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzE2NDUxNzkyOWEyZjIxZmViMmM3NjY4YTQ5NDFhMzYyODhmNTdkMw==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2011-11-02T10:06:08Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2011-11-02T10:06:08Z"}, "message": "re PR libstdc++/50951 (state of subtract_with_carry_engine not saved correctly to output stream)\n\n2011-11-02  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR libstdc++/50951\n\t* include/bits/random.tcc (operator<<(basic_ostream<>&,\n\tconst mersenne_twister_engine<>&): Output _M_p too.\n\t(operator<<(basic_ostream<>&, const\n\tsubtract_with_carry_engine<>&): Likewise.\n\t(operator>>(basic_istream<>&, mersenne_twister_engine<>&):\n\tReload it.\n\t(operator>>(basic_istream<>&, subtract_with_carry_engine<>&):\n\tLikewise.\n\t* include/bits/random.h (mersenne_twister_engine<>::operator==):\n\tCompare _M_p too.\n\t(subtract_with_carry_engine<>::operator==): Compare _M_carry\n\tand _M_p too.\n\t(shuffle_order_engine<>::operator==): Compare _M_v(s) and _M_y too.\n\t* testsuite/26_numerics/random/independent_bits_engine/\n\toperators/serialize.cc: Extend.\n\t* testsuite/26_numerics/random/subtract_with_carry_engine/\n\toperators/serialize.cc: Likewise.\n\t* testsuite/26_numerics/random/discard_block_engine/\n\toperators/serialize.cc: Likewise.\n\t* testsuite/26_numerics/random/mersenne_twister_engine/\n\toperators/serialize.cc: Likewise.\n\t* testsuite/26_numerics/random/linear_congruential_engine/\n\toperators/serialize.cc: Likewise.\n\t* testsuite/26_numerics/random/shuffle_order_engine/\n\toperators/serialize.cc: Likewise.\n\nFrom-SVN: r180764", "tree": {"sha": "48af547c3cc847618ee46d294950ca480613b916", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/48af547c3cc847618ee46d294950ca480613b916"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3164517929a2f21feb2c7668a4941a36288f57d3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3164517929a2f21feb2c7668a4941a36288f57d3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3164517929a2f21feb2c7668a4941a36288f57d3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3164517929a2f21feb2c7668a4941a36288f57d3/comments", "author": null, "committer": null, "parents": [{"sha": "e021c122e50fdf3bc80e630e148b836c358a4dc5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e021c122e50fdf3bc80e630e148b836c358a4dc5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e021c122e50fdf3bc80e630e148b836c358a4dc5"}], "stats": {"total": 158, "additions": 139, "deletions": 19}, "files": [{"sha": "82a0b911412c80b3085dc1c9fb028c3d4a0f041f", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=3164517929a2f21feb2c7668a4941a36288f57d3", "patch": "@@ -1,3 +1,32 @@\n+2011-11-02  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR libstdc++/50951\n+\t* include/bits/random.tcc (operator<<(basic_ostream<>&,\n+\tconst mersenne_twister_engine<>&): Output _M_p too.\n+\t(operator<<(basic_ostream<>&, const\n+\tsubtract_with_carry_engine<>&): Likewise.\n+\t(operator>>(basic_istream<>&, mersenne_twister_engine<>&):\n+\tReload it.\n+\t(operator>>(basic_istream<>&, subtract_with_carry_engine<>&):\n+\tLikewise.\n+\t* include/bits/random.h (mersenne_twister_engine<>::operator==):\n+\tCompare _M_p too.\n+\t(subtract_with_carry_engine<>::operator==): Compare _M_carry\n+\tand _M_p too.\n+\t(shuffle_order_engine<>::operator==): Compare _M_v(s) and _M_y too.\n+\t* testsuite/26_numerics/random/independent_bits_engine/\n+\toperators/serialize.cc: Extend.\n+\t* testsuite/26_numerics/random/subtract_with_carry_engine/\n+\toperators/serialize.cc: Likewise.\n+\t* testsuite/26_numerics/random/discard_block_engine/\n+\toperators/serialize.cc: Likewise.\n+\t* testsuite/26_numerics/random/mersenne_twister_engine/\n+\toperators/serialize.cc: Likewise.\n+\t* testsuite/26_numerics/random/linear_congruential_engine/\n+\toperators/serialize.cc: Likewise.\n+\t* testsuite/26_numerics/random/shuffle_order_engine/\n+\toperators/serialize.cc: Likewise.\n+\n 2011-11-02  Benjamin Kosnik  <bkoz@redhat.com>\n \n \t* include/bits/c++config: Add tr2 to versioned namespaces."}, {"sha": "d109224d1bf2b38b799e1bedfa4d761fd6b7941f", "filename": "libstdc++-v3/include/bits/random.h", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2Finclude%2Fbits%2Frandom.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2Finclude%2Fbits%2Frandom.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Frandom.h?ref=3164517929a2f21feb2c7668a4941a36288f57d3", "patch": "@@ -491,7 +491,8 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n       friend bool\n       operator==(const mersenne_twister_engine& __lhs,\n \t\t const mersenne_twister_engine& __rhs)\n-      { return std::equal(__lhs._M_x, __lhs._M_x + state_size, __rhs._M_x); }\n+      { return (std::equal(__lhs._M_x, __lhs._M_x + state_size, __rhs._M_x)\n+\t\t&& __lhs._M_p == __rhs._M_p); }\n \n       /**\n        * @brief Inserts the current state of a % mersenne_twister_engine\n@@ -705,7 +706,9 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n       friend bool\n       operator==(const subtract_with_carry_engine& __lhs,\n \t\t const subtract_with_carry_engine& __rhs)\n-      { return std::equal(__lhs._M_x, __lhs._M_x + long_lag, __rhs._M_x); }\n+      { return (std::equal(__lhs._M_x, __lhs._M_x + long_lag, __rhs._M_x)\n+\t\t&& __lhs._M_carry == __rhs._M_carry\n+\t\t&& __lhs._M_p == __rhs._M_p); }\n \n       /**\n        * @brief Inserts the current state of a % subtract_with_carry_engine\n@@ -1370,7 +1373,9 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n       friend bool\n       operator==(const shuffle_order_engine& __lhs,\n \t\t const shuffle_order_engine& __rhs)\n-      { return __lhs._M_b == __rhs._M_b; }\n+      { return (__lhs._M_b == __rhs._M_b\n+\t\t&& std::equal(__lhs._M_v, __lhs._M_v + __k, __rhs._M_v)\n+\t\t&& __lhs._M_y == __rhs._M_y); }\n \n       /**\n        * @brief Inserts the current state of a %shuffle_order_engine random"}, {"sha": "8936a62316aed15e7f958fc35089134a5dd91d99", "filename": "libstdc++-v3/include/bits/random.tcc", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2Finclude%2Fbits%2Frandom.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2Finclude%2Fbits%2Frandom.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Frandom.tcc?ref=3164517929a2f21feb2c7668a4941a36288f57d3", "patch": "@@ -471,9 +471,9 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n       __os.flags(__ios_base::dec | __ios_base::fixed | __ios_base::left);\n       __os.fill(__space);\n \n-      for (size_t __i = 0; __i < __n - 1; ++__i)\n+      for (size_t __i = 0; __i < __n; ++__i)\n \t__os << __x._M_x[__i] << __space;\n-      __os << __x._M_x[__n - 1];\n+      __os << __x._M_p;\n \n       __os.flags(__flags);\n       __os.fill(__fill);\n@@ -498,6 +498,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \n       for (size_t __i = 0; __i < __n; ++__i)\n \t__is >> __x._M_x[__i];\n+      __is >> __x._M_p;\n \n       __is.flags(__flags);\n       return __is;\n@@ -627,7 +628,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \n       for (size_t __i = 0; __i < __r; ++__i)\n \t__os << __x._M_x[__i] << __space;\n-      __os << __x._M_carry;\n+      __os << __x._M_carry << __space << __x._M_p;\n \n       __os.flags(__flags);\n       __os.fill(__fill);\n@@ -649,6 +650,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n       for (size_t __i = 0; __i < __r; ++__i)\n \t__is >> __x._M_x[__i];\n       __is >> __x._M_carry;\n+      __is >> __x._M_p;\n \n       __is.flags(__flags);\n       return __is;"}, {"sha": "4249d975a8214d9fdcba8f03d9879700d3f4a41d", "filename": "libstdc++-v3/testsuite/26_numerics/random/discard_block_engine/operators/serialize.cc", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Fdiscard_block_engine%2Foperators%2Fserialize.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Fdiscard_block_engine%2Foperators%2Fserialize.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Fdiscard_block_engine%2Foperators%2Fserialize.cc?ref=3164517929a2f21feb2c7668a4941a36288f57d3", "patch": "@@ -3,7 +3,7 @@\n //\n // 2008-11-24  Edward M. Smith-Rowland <3dw4rd@verizon.net>\n //\n-// Copyright (C) 2008, 2009 Free Software Foundation, Inc.\n+// Copyright (C) 2008, 2009, 2010, 2011 Free Software Foundation, Inc.\n //\n // This file is part of the GNU ISO C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -46,6 +46,20 @@ test01()\n \n   str >> v;\n   VERIFY( u == v );\n+  for (unsigned i = 0; i < 1000; ++i)\n+    VERIFY( u() == v() );\n+\n+  str.clear();\n+  str << v;\n+\n+  u();\n+  u();\n+  u();\n+\n+  str >> u;\n+  VERIFY( u == v );\n+  for (unsigned i = 0; i < 1000; ++i)\n+    VERIFY( u() == v() );\n }\n \n int main()"}, {"sha": "32a5157608cdf8939fbd5ad521bc15fd30a58917", "filename": "libstdc++-v3/testsuite/26_numerics/random/independent_bits_engine/operators/serialize.cc", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Findependent_bits_engine%2Foperators%2Fserialize.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Findependent_bits_engine%2Foperators%2Fserialize.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Findependent_bits_engine%2Foperators%2Fserialize.cc?ref=3164517929a2f21feb2c7668a4941a36288f57d3", "patch": "@@ -3,7 +3,7 @@\n //\n // 2008-11-24  Edward M. Smith-Rowland <3dw4rd@verizon.net>\n //\n-// Copyright (C) 2008, 2009 Free Software Foundation, Inc.\n+// Copyright (C) 2008, 2009, 2010, 2011 Free Software Foundation, Inc.\n //\n // This file is part of the GNU ISO C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -44,6 +44,20 @@ test01()\n \n   str >> v;\n   VERIFY( u == v );\n+  for (unsigned i = 0; i < 1000; ++i)\n+    VERIFY( u() == v() );\n+\n+  str.clear();\n+  str << v;\n+\n+  u();\n+  u();\n+  u();\n+\n+  str >> u;\n+  VERIFY( u == v );\n+  for (unsigned i = 0; i < 1000; ++i)\n+    VERIFY( u() == v() );\n }\n \n int main()"}, {"sha": "a83b22ef65106152392c06bee0edd2914a66b0f5", "filename": "libstdc++-v3/testsuite/26_numerics/random/linear_congruential_engine/operators/serialize.cc", "status": "modified", "additions": 22, "deletions": 8, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Flinear_congruential_engine%2Foperators%2Fserialize.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Flinear_congruential_engine%2Foperators%2Fserialize.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Flinear_congruential_engine%2Foperators%2Fserialize.cc?ref=3164517929a2f21feb2c7668a4941a36288f57d3", "patch": "@@ -3,7 +3,7 @@\n //\n // 2008-11-24  Edward M. Smith-Rowland <3dw4rd@verizon.net>\n //\n-// Copyright (C) 2008, 2009 Free Software Foundation, Inc.\n+// Copyright (C) 2008, 2009, 2010, 2011 Free Software Foundation, Inc.\n //\n // This file is part of the GNU ISO C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -33,15 +33,29 @@ test01()\n   bool test __attribute__((unused)) = true;\n \n   std::stringstream str;\n-  std::minstd_rand0 a;\n-  std::minstd_rand0 b;\n+  std::minstd_rand0 u;\n+  std::minstd_rand0 v;\n \n-  a(); // advance\n-  str << a;\n-  VERIFY( !(a == b) );\n+  u(); // advance\n+  str << u;\n+  VERIFY( !(u == v) );\n \n-  str >> b;\n-  VERIFY( a == b );\n+  str >> v;\n+  VERIFY( u == v );\n+  for (unsigned i = 0; i < 1000; ++i)\n+    VERIFY( u() == v() );\n+\n+  str.clear();\n+  str << v;\n+\n+  u();\n+  u();\n+  u();\n+\n+  str >> u;\n+  VERIFY( u == v );\n+  for (unsigned i = 0; i < 1000; ++i)\n+    VERIFY( u() == v() );\n }\n \n int main()"}, {"sha": "7c90e3d390fabb3cf026475f0e63bca535cb0cc4", "filename": "libstdc++-v3/testsuite/26_numerics/random/mersenne_twister_engine/operators/serialize.cc", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Fmersenne_twister_engine%2Foperators%2Fserialize.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Fmersenne_twister_engine%2Foperators%2Fserialize.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Fmersenne_twister_engine%2Foperators%2Fserialize.cc?ref=3164517929a2f21feb2c7668a4941a36288f57d3", "patch": "@@ -3,7 +3,7 @@\n //\n // 2008-11-24  Edward M. Smith-Rowland <3dw4rd@verizon.net>\n //\n-// Copyright (C) 2008, 2009 Free Software Foundation, Inc.\n+// Copyright (C) 2008, 2009, 2010, 2011 Free Software Foundation, Inc.\n //\n // This file is part of the GNU ISO C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -47,6 +47,20 @@ test01()\n \n   str >> v;\n   VERIFY( u == v );\n+  for (unsigned i = 0; i < 1000; ++i)\n+    VERIFY( u() == v() );\n+\n+  str.clear();\n+  str << v;\n+\n+  u();\n+  u();\n+  u();\n+\n+  str >> u;\n+  VERIFY( u == v );\n+  for (unsigned i = 0; i < 1000; ++i)\n+    VERIFY( u() == v() );\n }\n \n int main()"}, {"sha": "c7b15d1ba15c010587e6bdc6798c513fce7747dc", "filename": "libstdc++-v3/testsuite/26_numerics/random/shuffle_order_engine/operators/serialize.cc", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Fshuffle_order_engine%2Foperators%2Fserialize.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Fshuffle_order_engine%2Foperators%2Fserialize.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Fshuffle_order_engine%2Foperators%2Fserialize.cc?ref=3164517929a2f21feb2c7668a4941a36288f57d3", "patch": "@@ -3,7 +3,7 @@\n //\n // 2008-11-24  Edward M. Smith-Rowland <3dw4rd@verizon.net>\n //\n-// Copyright (C) 2008, 2009 Free Software Foundation, Inc.\n+// Copyright (C) 2008, 2009, 2010, 2011 Free Software Foundation, Inc.\n //\n // This file is part of the GNU ISO C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -46,6 +46,20 @@ test01()\n \n   str >> v;\n   VERIFY( u == v );\n+  for (unsigned i = 0; i < 1000; ++i)\n+    VERIFY( u() == v() );\n+\n+  str.clear();\n+  str << v;\n+\n+  u();\n+  u();\n+  u();\n+\n+  str >> u;\n+  VERIFY( u == v );\n+  for (unsigned i = 0; i < 1000; ++i)\n+    VERIFY( u() == v() );\n }\n \n int main()"}, {"sha": "1e2e53ac59304c8ff541ebfc4a2208960e0f2351", "filename": "libstdc++-v3/testsuite/26_numerics/random/subtract_with_carry_engine/operators/serialize.cc", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Fsubtract_with_carry_engine%2Foperators%2Fserialize.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3164517929a2f21feb2c7668a4941a36288f57d3/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Fsubtract_with_carry_engine%2Foperators%2Fserialize.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Fsubtract_with_carry_engine%2Foperators%2Fserialize.cc?ref=3164517929a2f21feb2c7668a4941a36288f57d3", "patch": "@@ -3,7 +3,7 @@\n //\n // 2008-11-24  Edward M. Smith-Rowland <3dw4rd@verizon.net>\n //\n-// Copyright (C) 2008, 2009 Free Software Foundation, Inc.\n+// Copyright (C) 2008, 2009, 2010, 2011 Free Software Foundation, Inc.\n //\n // This file is part of the GNU ISO C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -43,6 +43,20 @@ test01()\n \n   str >> v;\n   VERIFY( u == v );\n+  for (unsigned i = 0; i < 1000; ++i)\n+    VERIFY( u() == v() );\n+\n+  str.clear();\n+  str << v;\n+\n+  u();\n+  u();\n+  u();\n+\n+  str >> u;\n+  VERIFY( u == v );\n+  for (unsigned i = 0; i < 1000; ++i)\n+    VERIFY( u() == v() );\n }\n \n int main()"}]}