{"sha": "5e96e6c04bd61928c4e4a25f1c030ab31976a844", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWU5NmU2YzA0YmQ2MTkyOGM0ZTRhMjVmMWMwMzBhYjMxOTc2YTg0NA==", "commit": {"author": {"name": "Andrew Haley", "email": "aph@redhat.com", "date": "2008-01-04T11:06:34Z"}, "committer": {"name": "Andrew Haley", "email": "aph@gcc.gnu.org", "date": "2008-01-04T11:06:34Z"}, "message": "re PR java/17779 (ICE: Seg fault)\n\n2008-01-03  Andrew Haley  <aph@redhat.com>\n\n        PR java/17779\n        * jcf-parse.c (parse_zip_file_entries): Unset TYPE_ALIAS_SET if\n        we're about to re-layout the type.\n\nFrom-SVN: r131319", "tree": {"sha": "5ca9d8e9e82f9ece0aab4d35bca5a493ac5af106", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5ca9d8e9e82f9ece0aab4d35bca5a493ac5af106"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5e96e6c04bd61928c4e4a25f1c030ab31976a844", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5e96e6c04bd61928c4e4a25f1c030ab31976a844", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5e96e6c04bd61928c4e4a25f1c030ab31976a844", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5e96e6c04bd61928c4e4a25f1c030ab31976a844/comments", "author": {"login": "theRealAph", "id": 254637, "node_id": "MDQ6VXNlcjI1NDYzNw==", "avatar_url": "https://avatars.githubusercontent.com/u/254637?v=4", "gravatar_id": "", "url": "https://api.github.com/users/theRealAph", "html_url": "https://github.com/theRealAph", "followers_url": "https://api.github.com/users/theRealAph/followers", "following_url": "https://api.github.com/users/theRealAph/following{/other_user}", "gists_url": "https://api.github.com/users/theRealAph/gists{/gist_id}", "starred_url": "https://api.github.com/users/theRealAph/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/theRealAph/subscriptions", "organizations_url": "https://api.github.com/users/theRealAph/orgs", "repos_url": "https://api.github.com/users/theRealAph/repos", "events_url": "https://api.github.com/users/theRealAph/events{/privacy}", "received_events_url": "https://api.github.com/users/theRealAph/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6a3d1d4957e60027cf5ab581bf260f50441cdd52", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6a3d1d4957e60027cf5ab581bf260f50441cdd52", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6a3d1d4957e60027cf5ab581bf260f50441cdd52"}], "stats": {"total": 28, "additions": 23, "deletions": 5}, "files": [{"sha": "7392287cd4975cbe8e9858ba7ded8202e74a7c9c", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5e96e6c04bd61928c4e4a25f1c030ab31976a844/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5e96e6c04bd61928c4e4a25f1c030ab31976a844/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=5e96e6c04bd61928c4e4a25f1c030ab31976a844", "patch": "@@ -1,3 +1,9 @@\n+2008-01-03  Andrew Haley  <aph@redhat.com>\n+\n+\tPR java/17779\n+\t* jcf-parse.c (parse_zip_file_entries): Unset TYPE_ALIAS_SET if\n+\twe're about to re-layout the type.\n+\n 2007-12-20  Alexandre Oliva  <aoliva@redhat.com>\n \n \t* lang.c (java_classify_record): Don't return"}, {"sha": "8aa007c9924041b1da571b97abdb8624ce0efbe8", "filename": "gcc/java/jcf-parse.c", "status": "modified", "additions": 17, "deletions": 5, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5e96e6c04bd61928c4e4a25f1c030ab31976a844/gcc%2Fjava%2Fjcf-parse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5e96e6c04bd61928c4e4a25f1c030ab31976a844/gcc%2Fjava%2Fjcf-parse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fjcf-parse.c?ref=5e96e6c04bd61928c4e4a25f1c030ab31976a844", "patch": "@@ -2076,6 +2076,7 @@ parse_zip_file_entries (void)\n \t  {\n \t    char *class_name = compute_class_name (zdir);\n \t    class = lookup_class (get_identifier (class_name));\n+\t    int previous_alias_set = -1;\n \t    FREE (class_name);\n \t    current_jcf = TYPE_JCF (class);\n \t    output_class = current_class = class;\n@@ -2085,17 +2086,25 @@ parse_zip_file_entries (void)\n \t    gcc_assert (! TYPE_DUMMY (class));\n \n \t    /* This is for a corner case where we have a superclass\n-\t       but no superclass fields.  \n+\t       but no superclass fields.\n \n \t       This can happen if we earlier failed to lay out this\n \t       class because its superclass was still in the process\n \t       of being laid out; this occurs when we have recursive\n-\t       class dependencies via inner classes.  Setting\n-\t       TYPE_SIZE to null here causes CLASS_LOADED_P to return\n-\t       false, so layout_class() will be called again.  */\n+\t       class dependencies via inner classes.  We must record\n+\t       the previous alias set and restore it after laying out\n+\t       the class.\n+\n+\t       FIXME: this really is a kludge.  We should figure out a\n+\t       way to lay out the class properly before this\n+\t       happens.  */\n \t    if (TYPE_SIZE (class) && CLASSTYPE_SUPER (class)\n \t\t&& integer_zerop (TYPE_SIZE (class)))\n-\t      TYPE_SIZE (class) = NULL_TREE;\n+\t      {\n+\t\tTYPE_SIZE (class) = NULL_TREE;\n+\t\tprevious_alias_set = TYPE_ALIAS_SET (class);\n+\t\tTYPE_ALIAS_SET (class) = -1;\n+\t      }\n \n \t    if (! CLASS_LOADED_P (class))\n \t      {\n@@ -2108,6 +2117,9 @@ parse_zip_file_entries (void)\n \t\tload_inner_classes (current_class);\n \t      }\n \n+\t    if (previous_alias_set != -1)\n+\t      TYPE_ALIAS_SET (class) = previous_alias_set;\n+\n \t    if (TYPE_SIZE (current_class) != error_mark_node)\n \t      {\n \t\tparse_class_file ();"}]}