{"sha": "ba9b1a639fb8dfcf7d54700905fd1ba58d20f739", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmE5YjFhNjM5ZmI4ZGZjZjdkNTQ3MDA5MDVmZDFiYTU4ZDIwZjczOQ==", "commit": {"author": {"name": "Kyrylo Tkachov", "email": "kyrylo.tkachov@arm.com", "date": "2014-04-23T15:17:54Z"}, "committer": {"name": "Kyrylo Tkachov", "email": "ktkachov@gcc.gnu.org", "date": "2014-04-23T15:17:54Z"}, "message": "[ARM] Handle FMA code in rtx costs.\n\n       * config/arm/arm.c (arm_new_rtx_costs): Handle FMA.\n\nFrom-SVN: r209701", "tree": {"sha": "077fa5686b7c88606c9f0005913c67cd2423f14b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/077fa5686b7c88606c9f0005913c67cd2423f14b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ba9b1a639fb8dfcf7d54700905fd1ba58d20f739", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ba9b1a639fb8dfcf7d54700905fd1ba58d20f739", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ba9b1a639fb8dfcf7d54700905fd1ba58d20f739", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ba9b1a639fb8dfcf7d54700905fd1ba58d20f739/comments", "author": {"login": "ktkachov-arm", "id": 74917949, "node_id": "MDQ6VXNlcjc0OTE3OTQ5", "avatar_url": "https://avatars.githubusercontent.com/u/74917949?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ktkachov-arm", "html_url": "https://github.com/ktkachov-arm", "followers_url": "https://api.github.com/users/ktkachov-arm/followers", "following_url": "https://api.github.com/users/ktkachov-arm/following{/other_user}", "gists_url": "https://api.github.com/users/ktkachov-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/ktkachov-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ktkachov-arm/subscriptions", "organizations_url": "https://api.github.com/users/ktkachov-arm/orgs", "repos_url": "https://api.github.com/users/ktkachov-arm/repos", "events_url": "https://api.github.com/users/ktkachov-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/ktkachov-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "da4cfeacb0a152f4cc3afa7473ccad1b8455eae2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/da4cfeacb0a152f4cc3afa7473ccad1b8455eae2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/da4cfeacb0a152f4cc3afa7473ccad1b8455eae2"}], "stats": {"total": 34, "additions": 34, "deletions": 0}, "files": [{"sha": "5f86e3ec1557af2c3e2139820ab760833dff9723", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba9b1a639fb8dfcf7d54700905fd1ba58d20f739/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba9b1a639fb8dfcf7d54700905fd1ba58d20f739/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ba9b1a639fb8dfcf7d54700905fd1ba58d20f739", "patch": "@@ -1,3 +1,7 @@\n+2014-04-23  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n+\n+       * config/arm/arm.c (arm_new_rtx_costs): Handle FMA.\n+\n 2014-04-23  Richard Biener  <rguenther@suse.de>\n \n \t* Makefile.in (OBJS): Remove loop-unswitch.o."}, {"sha": "42df6fe0aa2115c06dda1d211fde20b14dc1f2ae", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba9b1a639fb8dfcf7d54700905fd1ba58d20f739/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba9b1a639fb8dfcf7d54700905fd1ba58d20f739/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=ba9b1a639fb8dfcf7d54700905fd1ba58d20f739", "patch": "@@ -10635,6 +10635,36 @@ arm_new_rtx_costs (rtx x, enum rtx_code code, enum rtx_code outer_code,\n       *cost = LIBCALL_COST (1);\n       return false;\n \n+    case FMA:\n+      if (TARGET_32BIT && TARGET_HARD_FLOAT && TARGET_FMA)\n+        {\n+          rtx op0 = XEXP (x, 0);\n+          rtx op1 = XEXP (x, 1);\n+          rtx op2 = XEXP (x, 2);\n+\n+          *cost = COSTS_N_INSNS (1);\n+\n+          /* vfms or vfnma.  */\n+          if (GET_CODE (op0) == NEG)\n+            op0 = XEXP (op0, 0);\n+\n+          /* vfnms or vfnma.  */\n+          if (GET_CODE (op2) == NEG)\n+            op2 = XEXP (op2, 0);\n+\n+          *cost += rtx_cost (op0, FMA, 0, speed_p);\n+          *cost += rtx_cost (op1, FMA, 1, speed_p);\n+          *cost += rtx_cost (op2, FMA, 2, speed_p);\n+\n+          if (speed_p)\n+            *cost += extra_cost->fp[mode ==DFmode].fma;\n+\n+          return true;\n+        }\n+\n+      *cost = LIBCALL_COST (3);\n+      return false;\n+\n     case FIX:\n     case UNSIGNED_FIX:\n       if (TARGET_HARD_FLOAT)"}]}