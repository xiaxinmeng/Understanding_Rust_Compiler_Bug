{"sha": "ff522f7fd48070a5365880a0ea6b54ae8be7315b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmY1MjJmN2ZkNDgwNzBhNTM2NTg4MGEwZWE2YjU0YWU4YmU3MzE1Yg==", "commit": {"author": {"name": "Zhenqiang Chen", "email": "zhenqiang.chen@linaro.org", "date": "2013-08-09T06:38:26Z"}, "committer": {"name": "Xuepeng Guo", "email": "xguo@gcc.gnu.org", "date": "2013-08-09T06:38:26Z"}, "message": "neon.md (vcond): Fix floating-point vector comparisons against 0.\n\nChangeLog:\n2013-08-09  Zhenqiang Chen  <zhenqiang.chen@linaro.org>\n\n        * config/arm/neon.md (vcond): Fix floating-point vector\n        comparisons against 0.\n\ntestsuite/ChangeLog:\n2013-08-09  Zhenqiang Chen  <zhenqiang.chen@linaro.org>\n\n        * gcc.target/arm/lp1189445.c: New testcase.\n\nFrom-SVN: r201618", "tree": {"sha": "ea555bd51f37002eb52fb97999532595b6682a4c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ea555bd51f37002eb52fb97999532595b6682a4c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ff522f7fd48070a5365880a0ea6b54ae8be7315b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff522f7fd48070a5365880a0ea6b54ae8be7315b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ff522f7fd48070a5365880a0ea6b54ae8be7315b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff522f7fd48070a5365880a0ea6b54ae8be7315b/comments", "author": null, "committer": null, "parents": [{"sha": "b9bfa45aad8f9f06a52439607764a7a960e2364b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b9bfa45aad8f9f06a52439607764a7a960e2364b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b9bfa45aad8f9f06a52439607764a7a960e2364b"}], "stats": {"total": 61, "additions": 56, "deletions": 5}, "files": [{"sha": "c2240dbce685838918432cfd4287a11522b34745", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff522f7fd48070a5365880a0ea6b54ae8be7315b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff522f7fd48070a5365880a0ea6b54ae8be7315b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ff522f7fd48070a5365880a0ea6b54ae8be7315b", "patch": "@@ -1,3 +1,8 @@\n+2013-08-09  Zhenqiang Chen  <zhenqiang.chen@linaro.org>\n+\n+\t* config/arm/neon.md (vcond): Fix floating-point vector\n+\tcomparisons against 0.\n+\n 2013-08-08  Vladimir Makarov  <vmakarov@redhat.com>\n \n \t* lra-constraints.c (emit_spill_move): Remove assert."}, {"sha": "e00ca2c7bf982f71c377dec73ee438687aadad02", "filename": "gcc/config/arm/neon.md", "status": "modified", "additions": 29, "deletions": 5, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff522f7fd48070a5365880a0ea6b54ae8be7315b/gcc%2Fconfig%2Farm%2Fneon.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff522f7fd48070a5365880a0ea6b54ae8be7315b/gcc%2Fconfig%2Farm%2Fneon.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Fneon.md?ref=ff522f7fd48070a5365880a0ea6b54ae8be7315b", "patch": "@@ -1671,6 +1671,7 @@\n \t\t\t     ? 3 : 1;\n   rtx magic_rtx = GEN_INT (magic_word);\n   int inverse = 0;\n+  int use_zero_form = 0;\n   int swap_bsl_operands = 0;\n   rtx mask = gen_reg_rtx (<V_cmp_result>mode);\n   rtx tmp = gen_reg_rtx (<V_cmp_result>mode);\n@@ -1681,12 +1682,16 @@\n   switch (GET_CODE (operands[3]))\n     {\n     case GE:\n+    case GT:\n     case LE:\n+    case LT:\n     case EQ:\n-      if (!REG_P (operands[5])\n-\t  && (operands[5] != CONST0_RTX (<MODE>mode)))\n-\toperands[5] = force_reg (<MODE>mode, operands[5]);\n-      break;\n+      if (operands[5] == CONST0_RTX (<MODE>mode))\n+\t{\n+\t  use_zero_form = 1;\n+\t  break;\n+\t}\n+      /* Fall through.  */\n     default:\n       if (!REG_P (operands[5]))\n \toperands[5] = force_reg (<MODE>mode, operands[5]);\n@@ -1737,7 +1742,26 @@\n \t a GT b -> a GT b\n \t a LE b -> b GE a\n \t a LT b -> b GT a\n-\t a EQ b -> a EQ b  */\n+\t a EQ b -> a EQ b\n+\t Note that there also exist direct comparison against 0 forms,\n+\t so catch those as a special case.  */\n+      if (use_zero_form)\n+\t{\n+\t  inverse = 0;\n+\t  switch (GET_CODE (operands[3]))\n+\t    {\n+\t    case LT:\n+\t      base_comparison = gen_neon_vclt<mode>;\n+\t      break;\n+\t    case LE:\n+\t      base_comparison = gen_neon_vcle<mode>;\n+\t      break;\n+\t    default:\n+\t      /* Do nothing, other zero form cases already have the correct\n+\t\t base_comparison.  */\n+\t      break;\n+\t    }\n+\t}\n \n       if (!inverse)\n \temit_insn (base_comparison (mask, operands[4], operands[5], magic_rtx));"}, {"sha": "24efd3e1317588f8c97b85249260e49a68ff5e30", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff522f7fd48070a5365880a0ea6b54ae8be7315b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff522f7fd48070a5365880a0ea6b54ae8be7315b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ff522f7fd48070a5365880a0ea6b54ae8be7315b", "patch": "@@ -1,3 +1,7 @@\n+2013-08-09  Zhenqiang Chen  <zhenqiang.chen@linaro.org>\n+\n+\t* gcc.target/arm/lp1189445.c: New testcase.\n+\n 2013-08-08  Richard Sandiford  <rdsandiford@googlemail.com>\n \n \t* gcc.dg/torture/pr58079.c: New test."}, {"sha": "766748e550987d3f609e48ea1c4b7ce926f0dedd", "filename": "gcc/testsuite/gcc.target/arm/lp1189445.c", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff522f7fd48070a5365880a0ea6b54ae8be7315b/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Flp1189445.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff522f7fd48070a5365880a0ea6b54ae8be7315b/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Flp1189445.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Flp1189445.c?ref=ff522f7fd48070a5365880a0ea6b54ae8be7315b", "patch": "@@ -0,0 +1,18 @@\n+/* { dg-do compile } */\n+/* { dg-require-effective-target arm_neon } */\n+/* { dg-add-options arm_neon } */\n+/* { dg-options \"-O3\" } */\n+\n+int id;\n+int\n+test (const long int *data)\n+{\n+  int i, retval;\n+  retval = id;\n+  for (i = 0; i < id; i++)\n+    {\n+      retval &= (data[i] <= 0);\n+    }\n+\n+  return (retval);\n+}"}]}