{"sha": "66168f5d32b3703c999833307b14eb4729fc4139", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjYxNjhmNWQzMmIzNzAzYzk5OTgzMzMwN2IxNGViNDcyOWZjNDEzOQ==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1993-10-29T15:49:33Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1993-10-29T15:49:33Z"}, "message": "Add support for coff-based ctor/dtor handling.\n\nFrom-SVN: r5929", "tree": {"sha": "c4a0de0779a0c77d2761bcb288a3a223642620f5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c4a0de0779a0c77d2761bcb288a3a223642620f5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/66168f5d32b3703c999833307b14eb4729fc4139", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66168f5d32b3703c999833307b14eb4729fc4139", "html_url": "https://github.com/Rust-GCC/gccrs/commit/66168f5d32b3703c999833307b14eb4729fc4139", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66168f5d32b3703c999833307b14eb4729fc4139/comments", "author": null, "committer": null, "parents": [{"sha": "c192da272be503d6d70ee09165cbac6de7b0b88a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c192da272be503d6d70ee09165cbac6de7b0b88a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c192da272be503d6d70ee09165cbac6de7b0b88a"}], "stats": {"total": 48, "additions": 48, "deletions": 0}, "files": [{"sha": "910bc7da24a1accbc69c6181a9171a7a448179fe", "filename": "gcc/config/i386/go32.h", "status": "modified", "additions": 48, "deletions": 0, "changes": 48, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66168f5d32b3703c999833307b14eb4729fc4139/gcc%2Fconfig%2Fi386%2Fgo32.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66168f5d32b3703c999833307b14eb4729fc4139/gcc%2Fconfig%2Fi386%2Fgo32.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fgo32.h?ref=66168f5d32b3703c999833307b14eb4729fc4139", "patch": "@@ -9,3 +9,51 @@\n #endif\n #define CPP_PREDEFINES \"-Dunix -Di386 -DGO32 -DMSDOS \\\n   -Asystem(unix) -Asystem(msdos) -Acpu(i386) -Amachine(i386)\"\n+\n+#undef EXTRA_SECTIONS\n+#define EXTRA_SECTIONS in_ctor, in_dtor\n+\n+#undef EXTRA_SECTION_FUNCTIONS\n+#define EXTRA_SECTION_FUNCTIONS\t\t\t\t\t\\\n+  CTOR_SECTION_FUNCTION\t\t\t\t\t\t\\\n+  DTOR_SECTION_FUNCTION\n+\n+#define CTOR_SECTION_FUNCTION\t\t\t\t\t\\\n+void\t\t\t\t\t\t\t\t\\\n+ctor_section ()\t\t\t\t\t\t\t\\\n+{\t\t\t\t\t\t\t\t\\\n+  if (in_section != in_ctor)\t\t\t\t\t\\\n+    {\t\t\t\t\t\t\t\t\\\n+      fprintf (asm_out_file, \"\\t.section .ctor\\n\");\t\t\\\n+      in_section = in_ctor;\t\t\t\t\t\\\n+    }\t\t\t\t\t\t\t\t\\\n+}\n+\n+#define DTOR_SECTION_FUNCTION\t\t\t\t\t\\\n+void\t\t\t\t\t\t\t\t\\\n+dtor_section ()\t\t\t\t\t\t\t\\\n+{\t\t\t\t\t\t\t\t\\\n+  if (in_section != in_dtor)\t\t\t\t\t\\\n+    {\t\t\t\t\t\t\t\t\\\n+      fprintf (asm_out_file, \"\\t.section .dtor\\n\");\t\t\\\n+      in_section = in_dtor;\t\t\t\t\t\\\n+    }\t\t\t\t\t\t\t\t\\\n+}\n+\n+#define ASM_OUTPUT_CONSTRUCTOR(FILE,NAME)\t\\\n+  do {\t\t\t\t\t\t\\\n+    ctor_section ();\t\t\t\t\\\n+    fprintf (FILE, \"%s\\t\", ASM_LONG);\t\t\\\n+    assemble_name (FILE, NAME);\t\t\t\\\n+    fprintf (FILE, \"\\n\");\t\t\t\\\n+  } while (0)\n+\n+#define ASM_OUTPUT_DESTRUCTOR(FILE,NAME)       \t\\\n+  do {\t\t\t\t\t\t\\\n+    dtor_section ();                   \t\t\\\n+    fprintf (FILE, \"%s\\t\", ASM_LONG);\t\t\\\n+    assemble_name (FILE, NAME);              \t\\\n+    fprintf (FILE, \"\\n\");\t\t\t\\\n+  } while (0)\n+\n+"}]}