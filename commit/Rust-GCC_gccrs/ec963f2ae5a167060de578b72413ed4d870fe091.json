{"sha": "ec963f2ae5a167060de578b72413ed4d870fe091", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWM5NjNmMmFlNWExNjcwNjBkZTU3OGI3MjQxM2VkNGQ4NzBmZTA5MQ==", "commit": {"author": {"name": "Kugan Vivekanandarajah", "email": "kuganv@linaro.org", "date": "2016-06-06T23:46:11Z"}, "committer": {"name": "Kugan Vivekanandarajah", "email": "kugan@gcc.gnu.org", "date": "2016-06-06T23:46:11Z"}, "message": "re PR tree-optimization/71408 (wrong code at -Os and above on x86_64-linux-gnu)\n\ngcc/ChangeLog:\n\n2016-06-07  Kugan Vivekanandarajah  <kuganv@linaro.org>\n\n\tPR middle-end/71408\n\t* tree-ssa-reassoc.c (zero_one_operation): Fix NEGATE_EXPR operand for\n\tpropagate_op_to_single_use.\n\n\ngcc/testsuite/ChangeLog:\n\n2016-06-07  Kugan Vivekanandarajah  <kuganv@linaro.org>\n\n\tPR middle-end/71408\n\t* gcc.dg/tree-ssa/pr71408.c: New test.\n\nFrom-SVN: r237158", "tree": {"sha": "fb896e6b17b2b1900b966f416a4390a5dde1521f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fb896e6b17b2b1900b966f416a4390a5dde1521f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ec963f2ae5a167060de578b72413ed4d870fe091", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ec963f2ae5a167060de578b72413ed4d870fe091", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ec963f2ae5a167060de578b72413ed4d870fe091", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ec963f2ae5a167060de578b72413ed4d870fe091/comments", "author": null, "committer": null, "parents": [{"sha": "46ab5b6edea83d9eb67a83572171493a8e2283b5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/46ab5b6edea83d9eb67a83572171493a8e2283b5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/46ab5b6edea83d9eb67a83572171493a8e2283b5"}], "stats": {"total": 47, "additions": 45, "deletions": 2}, "files": [{"sha": "5e9ce57826b0348ca585cc2bdaa001451c14b85c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec963f2ae5a167060de578b72413ed4d870fe091/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec963f2ae5a167060de578b72413ed4d870fe091/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ec963f2ae5a167060de578b72413ed4d870fe091", "patch": "@@ -1,3 +1,9 @@\n+2016-06-07  Kugan Vivekanandarajah  <kuganv@linaro.org>\n+\n+\tPR middle-end/71408\n+\t* tree-ssa-reassoc.c (zero_one_operation): Fix NEGATE_EXPR operand for\n+\tpropagate_op_to_single_use.\n+\n 2016-06-07  Kugan Vivekanandarajah  <kuganv@linaro.org>\n \n \tPR middle-end/71281"}, {"sha": "a1a7f1994ffe48b028621ec202e50e857401d112", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec963f2ae5a167060de578b72413ed4d870fe091/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec963f2ae5a167060de578b72413ed4d870fe091/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ec963f2ae5a167060de578b72413ed4d870fe091", "patch": "@@ -1,3 +1,8 @@\n+2016-06-07  Kugan Vivekanandarajah  <kuganv@linaro.org>\n+\n+\tPR middle-end/71408\n+\t* gcc.dg/tree-ssa/pr71408.c: New test.\n+\n 2016-06-07  Kugan Vivekanandarajah  <kuganv@linaro.org>\n \n \tPR middle-end/71281"}, {"sha": "896a42869e50cee4365f81cc191a734e75b7f3fe", "filename": "gcc/testsuite/gcc.dg/tree-ssa/pr71408.c", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec963f2ae5a167060de578b72413ed4d870fe091/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr71408.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec963f2ae5a167060de578b72413ed4d870fe091/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr71408.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr71408.c?ref=ec963f2ae5a167060de578b72413ed4d870fe091", "patch": "@@ -0,0 +1,30 @@\n+/* PR middle-end/71408 */\n+/* { dg-do run } */\n+/* { dg-options \"-Os\" } */\n+unsigned a, b;\n+\n+struct S0\n+{\n+  int f1:18;\n+  unsigned f3:4;\n+};\n+\n+void fn1 ()\n+{\n+  struct S0 c = { 7, 0 };\n+  if (c.f1)\n+    c.f3 = 3;\n+  a = -~c.f3;\n+  c.f3 = ~(c.f1 && c.f1);\n+  c.f1 = c.f3 * (c.f1 - (c.f1 - a % c.f1)) + ~c.f3 * -a;\n+  b = ~(c.f1 & a);\n+  if (b >= 4294967295)\n+    __builtin_abort ();\n+}\n+\n+int\n+main ()\n+{\n+  fn1 ();\n+  return 0;\n+}"}, {"sha": "36b34d37380628a3bc825eba7881973c3dfd4a81", "filename": "gcc/tree-ssa-reassoc.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec963f2ae5a167060de578b72413ed4d870fe091/gcc%2Ftree-ssa-reassoc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec963f2ae5a167060de578b72413ed4d870fe091/gcc%2Ftree-ssa-reassoc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-reassoc.c?ref=ec963f2ae5a167060de578b72413ed4d870fe091", "patch": "@@ -1203,7 +1203,8 @@ zero_one_operation (tree *def, enum tree_code opcode, tree op)\n \t    {\n \t      if (gimple_assign_rhs1 (stmt) == op)\n \t\t{\n-\t\t  propagate_op_to_single_use (op, stmt, def);\n+\t\t  tree cst = build_minus_one_cst (TREE_TYPE (op));\n+\t\t  propagate_op_to_single_use (cst, stmt, def);\n \t\t  return;\n \t\t}\n \t      else if (integer_minus_onep (op)\n@@ -1251,7 +1252,8 @@ zero_one_operation (tree *def, enum tree_code opcode, tree op)\n \t    {\n \t      if (gimple_assign_rhs1 (stmt2) == op)\n \t\t{\n-\t\t  propagate_op_to_single_use (op, stmt2, def);\n+\t\t  tree cst = build_minus_one_cst (TREE_TYPE (op));\n+\t\t  propagate_op_to_single_use (cst, stmt2, def);\n \t\t  return;\n \t\t}\n \t      else if (integer_minus_onep (op)"}]}