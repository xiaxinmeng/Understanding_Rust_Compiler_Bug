{"sha": "2b187c63e263707a88b01352880a24107baa88be", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmIxODdjNjNlMjYzNzA3YTg4YjAxMzUyODgwYTI0MTA3YmFhODhiZQ==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2003-07-18T03:05:27Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2003-07-18T03:05:27Z"}, "message": "re PR rtl-optimization/11557 (constant folding)\n\n\tPR optimization/11557\n\t* calls.c (flags_from_decl_or_type): Do not set ECF_LIBCALL_BLOCK\n\tunless we know which function is being called.\n\n\tPR optimization/11557\n\t* gcc.dg/20030717-1.c: New test.\n\nFrom-SVN: r69538", "tree": {"sha": "3a201d49170ff7a8281bb7bf1202e847d42a3bda", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3a201d49170ff7a8281bb7bf1202e847d42a3bda"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2b187c63e263707a88b01352880a24107baa88be", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b187c63e263707a88b01352880a24107baa88be", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2b187c63e263707a88b01352880a24107baa88be", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b187c63e263707a88b01352880a24107baa88be/comments", "author": null, "committer": null, "parents": [{"sha": "fea4065dda83f9ab8ca438275d82dc3740bab689", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fea4065dda83f9ab8ca438275d82dc3740bab689", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fea4065dda83f9ab8ca438275d82dc3740bab689"}], "stats": {"total": 40, "additions": 39, "deletions": 1}, "files": [{"sha": "0fe5852478ad9b77e83731c6626b3f4370d99133", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b187c63e263707a88b01352880a24107baa88be/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b187c63e263707a88b01352880a24107baa88be/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2b187c63e263707a88b01352880a24107baa88be", "patch": "@@ -1,3 +1,9 @@\n+2003-07-17  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR optimization/11557\n+\t* calls.c (flags_from_decl_or_type): Do not set ECF_LIBCALL_BLOCK\n+\tunless we know which function is being called.\n+\n 2003-07-17  Roger Sayle  <roger@eyesopen.com>\n \n \t* cse.c (fold_rtx): Use swap_commutative_operands_p to determine"}, {"sha": "845934e2cb5446deb0c96d03cc1231c6a6f13e0d", "filename": "gcc/calls.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b187c63e263707a88b01352880a24107baa88be/gcc%2Fcalls.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b187c63e263707a88b01352880a24107baa88be/gcc%2Fcalls.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcalls.c?ref=2b187c63e263707a88b01352880a24107baa88be", "patch": "@@ -730,10 +730,13 @@ flags_from_decl_or_type (tree exp)\n \n       if (TREE_NOTHROW (exp))\n \tflags |= ECF_NOTHROW;\n+\n+      if (TREE_READONLY (exp) && ! TREE_THIS_VOLATILE (exp))\n+\tflags |= ECF_LIBCALL_BLOCK;\n     }\n \n   if (TREE_READONLY (exp) && ! TREE_THIS_VOLATILE (exp))\n-    flags |= ECF_CONST | ECF_LIBCALL_BLOCK;\n+    flags |= ECF_CONST;\n \n   if (TREE_THIS_VOLATILE (exp))\n     flags |= ECF_NORETURN;"}, {"sha": "91f7815eaf33577148094c4259b74794d1aa98a7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b187c63e263707a88b01352880a24107baa88be/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b187c63e263707a88b01352880a24107baa88be/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2b187c63e263707a88b01352880a24107baa88be", "patch": "@@ -1,3 +1,8 @@\n+2003-07-17  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR optimization/11557\n+\t* gcc.dg/20030717-1.c: New test.\n+\n 2003-07-17  Andrew Pinski <pinskia@physics.uc.edu>\n \n \tPR c++/10476"}, {"sha": "6a7f6de6f444d00923903187537000dca446cd95", "filename": "gcc/testsuite/gcc.dg/20030717-1.c", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b187c63e263707a88b01352880a24107baa88be/gcc%2Ftestsuite%2Fgcc.dg%2F20030717-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b187c63e263707a88b01352880a24107baa88be/gcc%2Ftestsuite%2Fgcc.dg%2F20030717-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2F20030717-1.c?ref=2b187c63e263707a88b01352880a24107baa88be", "patch": "@@ -0,0 +1,24 @@\n+/* { dg-do run } */\n+/* { dg-options \"-O2\" } */\n+\n+extern void abort (void);\n+\n+int zero (void)\n+{\n+  return 0;\n+}\n+\n+int one (void)\n+{\n+  return 1;\n+}\n+\n+int main (void)\n+{\n+  int i = 1;\n+  int r = (i ? one : zero)();\n+  if (r != 1)\n+    abort();\n+  return 0;\n+}\n+"}]}