{"sha": "34a53788fec49e0a85bd32b51b057cfaae0200c8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzRhNTM3ODhmZWM0OWUwYTg1YmQzMmI1MWIwNTdjZmFhZTAyMDBjOA==", "commit": {"author": {"name": "Jozef Lawrynowicz", "email": "jozef.l@mittosystems.com", "date": "2019-12-11T18:59:38Z"}, "committer": {"name": "Jozef Lawrynowicz", "email": "jozefl@gcc.gnu.org", "date": "2019-12-11T18:59:38Z"}, "message": "libgcc: Declare __dso_handle only if DEFAULT_USE_CXA_ATEXIT is true\n\n2019-12-11  Jozef Lawrynowicz  <jozef.l@mittosystems.com>\n\n\t* crtstuff.c: Declare __dso_handle only if DEFAULT_USE_CXA_ATEXIT is\n\ttrue.\n\nFrom-SVN: r279243", "tree": {"sha": "35c729cb152743702ce27f8f39a2334b739b3a37", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/35c729cb152743702ce27f8f39a2334b739b3a37"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/34a53788fec49e0a85bd32b51b057cfaae0200c8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34a53788fec49e0a85bd32b51b057cfaae0200c8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/34a53788fec49e0a85bd32b51b057cfaae0200c8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34a53788fec49e0a85bd32b51b057cfaae0200c8/comments", "author": {"login": "jozefl-mitto", "id": 36524004, "node_id": "MDQ6VXNlcjM2NTI0MDA0", "avatar_url": "https://avatars.githubusercontent.com/u/36524004?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jozefl-mitto", "html_url": "https://github.com/jozefl-mitto", "followers_url": "https://api.github.com/users/jozefl-mitto/followers", "following_url": "https://api.github.com/users/jozefl-mitto/following{/other_user}", "gists_url": "https://api.github.com/users/jozefl-mitto/gists{/gist_id}", "starred_url": "https://api.github.com/users/jozefl-mitto/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jozefl-mitto/subscriptions", "organizations_url": "https://api.github.com/users/jozefl-mitto/orgs", "repos_url": "https://api.github.com/users/jozefl-mitto/repos", "events_url": "https://api.github.com/users/jozefl-mitto/events{/privacy}", "received_events_url": "https://api.github.com/users/jozefl-mitto/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0230c89710f748153fcab4fb80a7576942922c7d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0230c89710f748153fcab4fb80a7576942922c7d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0230c89710f748153fcab4fb80a7576942922c7d"}], "stats": {"total": 11, "additions": 10, "deletions": 1}, "files": [{"sha": "b415d78a8af8f563f6c6a0621f11f84e61d81bd8", "filename": "libgcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34a53788fec49e0a85bd32b51b057cfaae0200c8/libgcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34a53788fec49e0a85bd32b51b057cfaae0200c8/libgcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2FChangeLog?ref=34a53788fec49e0a85bd32b51b057cfaae0200c8", "patch": "@@ -1,3 +1,8 @@\n+2019-12-11  Jozef Lawrynowicz  <jozef.l@mittosystems.com>\n+\n+\t* crtstuff.c: Declare __dso_handle only if DEFAULT_USE_CXA_ATEXIT is\n+\ttrue.\n+\n 2019-12-09  Jozef Lawrynowicz  <jozef.l@mittosystems.com>\n \n \t* crtstuff.c (__do_global_dtors_aux): Check if USE_EH_FRAME_REGISTRY is"}, {"sha": "e282cb1aabb40ced7254425418529e886d1906fb", "filename": "libgcc/crtstuff.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34a53788fec49e0a85bd32b51b057cfaae0200c8/libgcc%2Fcrtstuff.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34a53788fec49e0a85bd32b51b057cfaae0200c8/libgcc%2Fcrtstuff.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fcrtstuff.c?ref=34a53788fec49e0a85bd32b51b057cfaae0200c8", "patch": "@@ -325,11 +325,14 @@ register_tm_clones (void)\n \n #ifdef OBJECT_FORMAT_ELF\n \n+#if DEFAULT_USE_CXA_ATEXIT\n /* Declare the __dso_handle variable.  It should have a unique value\n    in every shared-object; in a main program its value is zero.  The\n    object should in any case be protected.  This means the instance\n    in one DSO or the main program is not used in another object.  The\n-   dynamic linker takes care of this.  */\n+   dynamic linker takes care of this.\n+   If __cxa_atexit is not being used, __dso_handle will not be used and\n+   doesn't need to be defined.  */\n \n #ifdef TARGET_LIBGCC_SDATA_SECTION\n extern void *__dso_handle __attribute__ ((__section__ (TARGET_LIBGCC_SDATA_SECTION)));\n@@ -342,6 +345,7 @@ void *__dso_handle = &__dso_handle;\n #else\n void *__dso_handle = 0;\n #endif\n+#endif /* DEFAULT_USE_CXA_ATEXIT */\n \n /* The __cxa_finalize function may not be available so we use only a\n    weak declaration.  */"}]}