{"sha": "6ad216adda81c7bab0d9f4cd4887178f892ef8a1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmFkMjE2YWRkYTgxYzdiYWIwZDlmNGNkNDg4NzE3OGY4OTJlZjhhMQ==", "commit": {"author": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-05-20T04:34:02Z"}, "committer": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-05-20T04:34:02Z"}, "message": "(scan_loop): Treat pseudo duplicated for exit tests just\nlike we treat user vars in seeing if we can move a SET.\n\nFrom-SVN: r4514", "tree": {"sha": "460fd96d0ccc005d463c9e083abfd1fc9324d095", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/460fd96d0ccc005d463c9e083abfd1fc9324d095"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6ad216adda81c7bab0d9f4cd4887178f892ef8a1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6ad216adda81c7bab0d9f4cd4887178f892ef8a1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6ad216adda81c7bab0d9f4cd4887178f892ef8a1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6ad216adda81c7bab0d9f4cd4887178f892ef8a1/comments", "author": null, "committer": null, "parents": [{"sha": "dca821e1a9a0d5ed3a44fd6a1e15f7cb08833e58", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dca821e1a9a0d5ed3a44fd6a1e15f7cb08833e58", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dca821e1a9a0d5ed3a44fd6a1e15f7cb08833e58"}], "stats": {"total": 7, "additions": 5, "deletions": 2}, "files": [{"sha": "357eee672d9d45d730a627e09d1348719ebc8447", "filename": "gcc/loop.c", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6ad216adda81c7bab0d9f4cd4887178f892ef8a1/gcc%2Floop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6ad216adda81c7bab0d9f4cd4887178f892ef8a1/gcc%2Floop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Floop.c?ref=6ad216adda81c7bab0d9f4cd4887178f892ef8a1", "patch": "@@ -682,13 +682,16 @@ scan_loop (loop_start, end, nregs)\n \t    ;\n \t  /* In order to move a register, we need to have one of three cases:\n \t     (1) it is used only in the same basic block as the set\n-\t     (2) it is not a user variable.\n+\t     (2) it is not a user variable and it is not used in the\n+\t         exit test (this can cause the variable to be used\n+\t\t before it is set just like a user-variable).\n \t     (3) the set is guaranteed to be executed once the loop starts,\n \t         and the reg is not used until after that.  */\n \t  else if (! ((! maybe_never\n \t\t       && ! loop_reg_used_before_p (set, p, loop_start,\n \t\t\t\t\t\t    scan_start, end))\n-\t\t      || ! REG_USERVAR_P (SET_DEST (PATTERN (p)))\n+\t\t      || (! REG_USERVAR_P (SET_DEST (PATTERN (p)))\n+\t\t\t  && ! REG_LOOP_TEST_P (SET_DEST (PATTERN (p))))\n \t\t      || reg_in_basic_block_p (p, SET_DEST (PATTERN (p)))))\n \t    ;\n \t  else if ((tem = invariant_p (src))"}]}