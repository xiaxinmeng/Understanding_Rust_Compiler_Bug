{"sha": "fad970a5ecf82f7af0c3d75c7524dc887e31be65", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmFkOTcwYTVlY2Y4MmY3YWYwYzNkNzVjNzUyNGRjODg3ZTMxYmU2NQ==", "commit": {"author": {"name": "SimplyTheOther", "email": "simplytheother@gmail.com", "date": "2020-06-14T14:16:20Z"}, "committer": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2020-11-28T21:13:16Z"}, "message": "Added TI C6X target hook (or a basic one at least)", "tree": {"sha": "aee7646217c4aee9204d87b9792f84cc7b136ed0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/aee7646217c4aee9204d87b9792f84cc7b136ed0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fad970a5ecf82f7af0c3d75c7524dc887e31be65", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fad970a5ecf82f7af0c3d75c7524dc887e31be65", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fad970a5ecf82f7af0c3d75c7524dc887e31be65", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fad970a5ecf82f7af0c3d75c7524dc887e31be65/comments", "author": {"login": "SimplyTheOther", "id": 19371469, "node_id": "MDQ6VXNlcjE5MzcxNDY5", "avatar_url": "https://avatars.githubusercontent.com/u/19371469?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SimplyTheOther", "html_url": "https://github.com/SimplyTheOther", "followers_url": "https://api.github.com/users/SimplyTheOther/followers", "following_url": "https://api.github.com/users/SimplyTheOther/following{/other_user}", "gists_url": "https://api.github.com/users/SimplyTheOther/gists{/gist_id}", "starred_url": "https://api.github.com/users/SimplyTheOther/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SimplyTheOther/subscriptions", "organizations_url": "https://api.github.com/users/SimplyTheOther/orgs", "repos_url": "https://api.github.com/users/SimplyTheOther/repos", "events_url": "https://api.github.com/users/SimplyTheOther/events{/privacy}", "received_events_url": "https://api.github.com/users/SimplyTheOther/received_events", "type": "User", "site_admin": false}, "committer": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "821da3d3a2b5f710efcdc8600a69cd4677e84583", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/821da3d3a2b5f710efcdc8600a69cd4677e84583", "html_url": "https://github.com/Rust-GCC/gccrs/commit/821da3d3a2b5f710efcdc8600a69cd4677e84583"}], "stats": {"total": 66, "additions": 66, "deletions": 0}, "files": [{"sha": "c5c9d8a4597034b7f591618f07bb62b4138ccad0", "filename": "gcc/config.gcc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fad970a5ecf82f7af0c3d75c7524dc887e31be65/gcc%2Fconfig.gcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fad970a5ecf82f7af0c3d75c7524dc887e31be65/gcc%2Fconfig.gcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.gcc?ref=fad970a5ecf82f7af0c3d75c7524dc887e31be65", "patch": "@@ -578,6 +578,7 @@ v850*-*-*)\n \t;;\n tic6x-*-*)\n \tcpu_type=c6x\n+\trust_target_objs=\"c6x-rust.o\"\n \textra_headers=\"c6x_intrinsics.h\"\n \textra_options=\"${extra_options} c6x/c6x-tables.opt\"\n \t;;"}, {"sha": "e69484d4965bdf9195496579a9c6dc85c12e7180", "filename": "gcc/config/c6x/c6x-protos.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fad970a5ecf82f7af0c3d75c7524dc887e31be65/gcc%2Fconfig%2Fc6x%2Fc6x-protos.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fad970a5ecf82f7af0c3d75c7524dc887e31be65/gcc%2Fconfig%2Fc6x%2Fc6x-protos.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fc6x%2Fc6x-protos.h?ref=fad970a5ecf82f7af0c3d75c7524dc887e31be65", "patch": "@@ -21,6 +21,9 @@\n #ifndef GCC_C6X_PROTOS_H\n #define GCC_C6X_PROTOS_H\n \n+/* Defined in c6x-rust.c  */\n+extern void c6x_rust_target_cpu_info (void);\n+\n /* Functions defined in c6x.c.  */\n \n #ifdef RTX_CODE"}, {"sha": "351adacf83b606dbaaf9b5014639f85caf384eba", "filename": "gcc/config/c6x/c6x-rust.c", "status": "added", "additions": 56, "deletions": 0, "changes": 56, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fad970a5ecf82f7af0c3d75c7524dc887e31be65/gcc%2Fconfig%2Fc6x%2Fc6x-rust.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fad970a5ecf82f7af0c3d75c7524dc887e31be65/gcc%2Fconfig%2Fc6x%2Fc6x-rust.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fc6x%2Fc6x-rust.c?ref=fad970a5ecf82f7af0c3d75c7524dc887e31be65", "patch": "@@ -0,0 +1,56 @@\n+/* Subroutines for the Rust front end on the TI C6X.\n+   Copyright (C) 2020 Free Software Foundation, Inc.\n+\n+GCC is free software; you can redistribute it and/or modify\n+it under the terms of the GNU General Public License as published by\n+the Free Software Foundation; either version 3, or (at your option)\n+any later version.\n+\n+GCC is distributed in the hope that it will be useful,\n+but WITHOUT ANY WARRANTY; without even the implied warranty of\n+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+GNU General Public License for more details.\n+\n+You should have received a copy of the GNU General Public License\n+along with GCC; see the file COPYING3.  If not see\n+<http://www.gnu.org/licenses/>.  */\n+\n+#include \"config.h\"\n+#include \"system.h\"\n+#include \"coretypes.h\"\n+#include \"tm.h\"\n+#include \"tm_p.h\"\n+#include \"rust/rust-target.h\"\n+#include \"rust/rust-target-def.h\"\n+\n+/* Implement TARGET_RUST_CPU_INFO for TI C6X targets.  */\n+\n+void c6x_rust_target_cpu_info(void) {\n+    rust_add_target_info(\"target_arch\", \"tic6x\");\n+\n+    // llvm seems to have no support for c6x (nor historical support), so names are made up by me\n+    // TODO: very subject to change\n+    // TODO maybe put in sub-arches as features? idk\n+    if (TARGET_DSBT)\n+        rust_add_target_info(\"target_feature\", \"dsbt\");\n+    \n+    if (TARGET_INSNS_64)\n+        rust_add_target_info(\"target_feature\", \"c64x\");\n+    if (TARGET_INSNS_64PLUS)\n+        rust_add_target_info(\"target_feature\", \"c64x+\");\n+    if (TARGET_INSNS_67)\n+        rust_add_target_info(\"target_feature\", \"c67x\");\n+    if (TARGET_INSNS_67PLUS)\n+        rust_add_target_info(\"target_feature\", \"c67x+\");\n+\n+    if (TARGET_LDDW)\n+        rust_add_target_info(\"target_feature\", \"lddw\");\n+    if (TARGET_STDW)\n+        rust_add_target_info(\"target_feature\", \"stdw\");\n+    if (TARGET_MPY32)\n+        rust_add_target_info(\"target_feature\", \"mpy32\");\n+    if (TARGET_FP)\n+        rust_add_target_info(\"target_feature\", \"fp\");\n+    if (TARGET_FP_EXT)\n+        rust_add_target_info(\"target_feature\", \"fp-ext\");\n+}"}, {"sha": "e2159ef84b4001dde55ad9ee844c3604a7bbf1df", "filename": "gcc/config/c6x/c6x.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fad970a5ecf82f7af0c3d75c7524dc887e31be65/gcc%2Fconfig%2Fc6x%2Fc6x.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fad970a5ecf82f7af0c3d75c7524dc887e31be65/gcc%2Fconfig%2Fc6x%2Fc6x.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fc6x%2Fc6x.h?ref=fad970a5ecf82f7af0c3d75c7524dc887e31be65", "patch": "@@ -114,6 +114,8 @@ extern c6x_cpu_t c6x_arch;\n \t}\t\t\t\t\t\\\n     } while (0)\n \n+#define TARGET_RUST_CPU_INFO c6x_rust_target_cpu_info\n+\n #define OPTION_DEFAULT_SPECS \\\n   {\"arch\", \"%{!march=*:-march=%(VALUE)}\" }\n "}, {"sha": "cbcdfcc5f09da78de28bc3671a5e67571b969046", "filename": "gcc/config/c6x/t-c6x", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fad970a5ecf82f7af0c3d75c7524dc887e31be65/gcc%2Fconfig%2Fc6x%2Ft-c6x", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fad970a5ecf82f7af0c3d75c7524dc887e31be65/gcc%2Fconfig%2Fc6x%2Ft-c6x", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fc6x%2Ft-c6x?ref=fad970a5ecf82f7af0c3d75c7524dc887e31be65", "patch": "@@ -42,3 +42,7 @@ $(srcdir)/config/c6x/c6x-tables.opt: $(srcdir)/config/c6x/genopt.sh \\\n   $(srcdir)/config/c6x/c6x-isas.def\n \t$(SHELL) $(srcdir)/config/c6x/genopt.sh $(srcdir)/config/c6x > \\\n \t\t$(srcdir)/config/c6x/c6x-tables.opt\n+\n+c6x-rust.o: $(srcdir)/config/c6x/c6x-rust.c \\\n+  $(CONFIG_H) $(SYSTEM_H) coretypes.h $(TM_H) $(TREE_H) $(C_COMMON_H)\n+\t$(COMPILER) -c $(ALL_COMPILERFLAGS) $(ALL_CPPFLAGS) $(INCLUDES) $<"}]}