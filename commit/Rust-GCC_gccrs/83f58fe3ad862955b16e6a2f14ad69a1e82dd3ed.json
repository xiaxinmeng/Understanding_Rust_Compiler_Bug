{"sha": "83f58fe3ad862955b16e6a2f14ad69a1e82dd3ed", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODNmNThmZTNhZDg2Mjk1NWIxNmU2YTJmMTRhZDY5YTFlODJkZDNlZA==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2019-10-31T08:52:31Z"}, "committer": {"name": "Martin Liska", "email": "marxin@gcc.gnu.org", "date": "2019-10-31T08:52:31Z"}, "message": "Remove missing usage of cgraph_local_info in arm,bfin and c6x.\n\n2019-10-31  Martin Liska  <mliska@suse.cz>\n\n\t* config/arm/arm.c (arm_get_pcs_model): Remove usage\n\tof cgraph_local_info and use local_info_node instead.\n\t* config/bfin/bfin.c (bfin_load_pic_reg): Likewise.\n\t(bfin_function_ok_for_sibcall): Likewise.\n\t* config/c6x/c6x.c (c6x_function_ok_for_sibcall): Likewise.\n\t(must_reload_pic_reg_p): Likewise.\n\nFrom-SVN: r277657", "tree": {"sha": "59fce5b14f2b58224444307e8e75166a91c146ec", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/59fce5b14f2b58224444307e8e75166a91c146ec"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/83f58fe3ad862955b16e6a2f14ad69a1e82dd3ed", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/83f58fe3ad862955b16e6a2f14ad69a1e82dd3ed", "html_url": "https://github.com/Rust-GCC/gccrs/commit/83f58fe3ad862955b16e6a2f14ad69a1e82dd3ed", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/83f58fe3ad862955b16e6a2f14ad69a1e82dd3ed/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "fbdbe8b06a1c5626ad6360a4af33cb638c14cda1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fbdbe8b06a1c5626ad6360a4af33cb638c14cda1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fbdbe8b06a1c5626ad6360a4af33cb638c14cda1"}], "stats": {"total": 45, "additions": 27, "deletions": 18}, "files": [{"sha": "38f6f11af2602441e5f8e70b376af281f9d696ec", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/83f58fe3ad862955b16e6a2f14ad69a1e82dd3ed/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/83f58fe3ad862955b16e6a2f14ad69a1e82dd3ed/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=83f58fe3ad862955b16e6a2f14ad69a1e82dd3ed", "patch": "@@ -1,3 +1,12 @@\n+2019-10-31  Martin Liska  <mliska@suse.cz>\n+\n+\t* config/arm/arm.c (arm_get_pcs_model): Remove usage\n+\tof cgraph_local_info and use local_info_node instead.\n+\t* config/bfin/bfin.c (bfin_load_pic_reg): Likewise.\n+\t(bfin_function_ok_for_sibcall): Likewise.\n+\t* config/c6x/c6x.c (c6x_function_ok_for_sibcall): Likewise.\n+\t(must_reload_pic_reg_p): Likewise.\n+\n 2019-10-31  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/90947"}, {"sha": "3c83b7f7f69ba6cecbdb26c82d3893b92e0683e4", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/83f58fe3ad862955b16e6a2f14ad69a1e82dd3ed/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/83f58fe3ad862955b16e6a2f14ad69a1e82dd3ed/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=83f58fe3ad862955b16e6a2f14ad69a1e82dd3ed", "patch": "@@ -5956,8 +5956,9 @@ arm_get_pcs_model (const_tree type, const_tree decl)\n \t     so we are free to use whatever conventions are\n \t     appropriate.  */\n \t  /* FIXME: remove CONST_CAST_TREE when cgraph is constified.  */\n-\t  cgraph_local_info *i = cgraph_node::local_info (CONST_CAST_TREE(decl));\n-\t  if (i && i->local)\n+\t  cgraph_node *local_info_node\n+\t    = cgraph_node::local_info_node (CONST_CAST_TREE (decl));\n+\t  if (local_info_node && local_info_node->local)\n \t    return ARM_PCS_AAPCS_LOCAL;\n \t}\n     }"}, {"sha": "b646d03f146440c4baba792d964c480e25ed30b4", "filename": "gcc/config/bfin/bfin.c", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/83f58fe3ad862955b16e6a2f14ad69a1e82dd3ed/gcc%2Fconfig%2Fbfin%2Fbfin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/83f58fe3ad862955b16e6a2f14ad69a1e82dd3ed/gcc%2Fconfig%2Fbfin%2Fbfin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fbfin%2Fbfin.c?ref=83f58fe3ad862955b16e6a2f14ad69a1e82dd3ed", "patch": "@@ -1036,14 +1036,14 @@ expand_interrupt_handler_epilogue (rtx spreg, e_funkind fkind, bool all)\n static rtx\n bfin_load_pic_reg (rtx dest)\n {\n-  struct cgraph_local_info *i = NULL;\n   rtx addr;\n- \n-  i = cgraph_node::local_info (current_function_decl);\n- \n+\n+  cgraph_node *local_info_node\n+    = cgraph_node::local_info_node (current_function_decl);\n+\n   /* Functions local to the translation unit don't need to reload the\n      pic reg, since the caller always passes a usable one.  */\n-  if (i && i->local)\n+  if (local_info_node && local_info_node->local)\n     return pic_offset_table_rtx;\n       \n   if (global_options_set.x_bfin_library_id)\n@@ -1806,7 +1806,7 @@ static bool\n bfin_function_ok_for_sibcall (tree decl ATTRIBUTE_UNUSED,\n \t\t\t      tree exp ATTRIBUTE_UNUSED)\n {\n-  struct cgraph_local_info *this_func, *called_func;\n+  cgraph_node *this_func, *called_func;\n   e_funkind fkind = funkind (TREE_TYPE (current_function_decl));\n   if (fkind != SUBROUTINE)\n     return false;\n@@ -1821,9 +1821,9 @@ bfin_function_ok_for_sibcall (tree decl ATTRIBUTE_UNUSED,\n   if (!decl)\n     /* Not enough information.  */\n     return false;\n- \n-  this_func = cgraph_node::local_info (current_function_decl);\n-  called_func = cgraph_node::local_info (decl);\n+\n+  this_func = cgraph_node::local_info_node (current_function_decl);\n+  called_func = cgraph_node::local_info_node (decl);\n   if (!called_func)\n     return false;\n   return !called_func->local || this_func->local;"}, {"sha": "a6ff25fb7548c623a90ad6b4fa6d00d8fc1c7745", "filename": "gcc/config/c6x/c6x.c", "status": "modified", "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/83f58fe3ad862955b16e6a2f14ad69a1e82dd3ed/gcc%2Fconfig%2Fc6x%2Fc6x.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/83f58fe3ad862955b16e6a2f14ad69a1e82dd3ed/gcc%2Fconfig%2Fc6x%2Fc6x.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fc6x%2Fc6x.c?ref=83f58fe3ad862955b16e6a2f14ad69a1e82dd3ed", "patch": "@@ -1158,13 +1158,13 @@ c6x_function_ok_for_sibcall (tree decl, tree exp)\n       /* When compiling for DSBT, the calling function must be local,\n \t so that when we reload B14 in the sibcall epilogue, it will\n \t not change its value.  */\n-      struct cgraph_local_info *this_func;\n \n       if (!decl)\n \t/* Not enough information.  */\n \treturn false;\n \n-      this_func = cgraph_node::local_info (current_function_decl);\n+      cgraph_node *this_func\n+\t= cgraph_node::local_info_node (current_function_decl);\n       return this_func->local;\n     }\n \n@@ -2516,14 +2516,13 @@ struct c6x_frame\n static bool\n must_reload_pic_reg_p (void)\n {\n-  struct cgraph_local_info *i = NULL;\n-\n   if (!TARGET_DSBT)\n     return false;\n \n-  i = cgraph_node::local_info (current_function_decl);\n-\n-  if ((crtl->uses_pic_offset_table || !crtl->is_leaf) && !i->local)\n+  cgraph_node *local_info_node\n+    = cgraph_node::local_info_node (current_function_decl);\n+  if ((crtl->uses_pic_offset_table || !crtl->is_leaf)\n+      && !local_info_node->local)\n     return true;\n   return false;\n }"}]}