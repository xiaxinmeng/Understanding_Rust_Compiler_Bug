{"sha": "3eda57b4ae50b5fe57c174556f1daf3bd9a46b09", "node_id": "C_kwDOANBUbNoAKDNlZGE1N2I0YWU1MGI1ZmU1N2MxNzQ1NTZmMWRhZjNiZDlhNDZiMDk", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2022-04-04T08:31:15Z"}, "committer": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2022-04-04T09:34:25Z"}, "message": "tree-optimization/105132 - add missing checking in vectorizable_operation\n\nThe following adds missing verification that the input vectors\nhave the same number of elements for vectorizable_operation.\n\n2022-04-04  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/105132\n\t* tree-vect-stmts.cc (vectorizable_operation): Check that\n\tthe input vectors have the same number of elements.\n\n\t* gcc.dg/torture/pr105132.c: New testcase.", "tree": {"sha": "4b06fc51771ddd8fdd4386eddbb87111f982f517", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4b06fc51771ddd8fdd4386eddbb87111f982f517"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3eda57b4ae50b5fe57c174556f1daf3bd9a46b09", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3eda57b4ae50b5fe57c174556f1daf3bd9a46b09", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3eda57b4ae50b5fe57c174556f1daf3bd9a46b09", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3eda57b4ae50b5fe57c174556f1daf3bd9a46b09/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "eaaf77dd85c333b116111bb1ae6c080154a4e411", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eaaf77dd85c333b116111bb1ae6c080154a4e411", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eaaf77dd85c333b116111bb1ae6c080154a4e411"}], "stats": {"total": 18, "additions": 18, "deletions": 0}, "files": [{"sha": "f8f0b16ec5658c6d13c67b70fd8e189efc3517c1", "filename": "gcc/testsuite/gcc.dg/torture/pr105132.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3eda57b4ae50b5fe57c174556f1daf3bd9a46b09/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr105132.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3eda57b4ae50b5fe57c174556f1daf3bd9a46b09/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr105132.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr105132.c?ref=3eda57b4ae50b5fe57c174556f1daf3bd9a46b09", "patch": "@@ -0,0 +1,12 @@\n+/* { dg-do compile } */\n+/* { dg-additional-options \"-march=skylake-avx512\" { target x86_64-*-* i?86-*-* } } */\n+\n+short a;\n+extern int b[];\n+int c;\n+void d(long f[][5][5][17], int g[][5][5][17]) {\n+  for (short e = 0; e < 17; e++) {\n+    a = g[19][2][3][e];\n+    b[e] = c & (f[3][2][3][e] && g[19][2][3][e]);\n+  }\n+}"}, {"sha": "f6fc7e1fcddafa92af4cf4cb761d58f39e854fea", "filename": "gcc/tree-vect-stmts.cc", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3eda57b4ae50b5fe57c174556f1daf3bd9a46b09/gcc%2Ftree-vect-stmts.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3eda57b4ae50b5fe57c174556f1daf3bd9a46b09/gcc%2Ftree-vect-stmts.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-stmts.cc?ref=3eda57b4ae50b5fe57c174556f1daf3bd9a46b09", "patch": "@@ -6133,6 +6133,9 @@ vectorizable_operation (vec_info *vinfo,\n                              \"use not simple.\\n\");\n \t  return false;\n \t}\n+      if (vectype2\n+\t  && maybe_ne (nunits_out, TYPE_VECTOR_SUBPARTS (vectype2)))\n+\treturn false;\n     }\n   if (op_type == ternary_op)\n     {\n@@ -6144,6 +6147,9 @@ vectorizable_operation (vec_info *vinfo,\n                              \"use not simple.\\n\");\n \t  return false;\n \t}\n+      if (vectype3\n+\t  && maybe_ne (nunits_out, TYPE_VECTOR_SUBPARTS (vectype3)))\n+\treturn false;\n     }\n \n   /* Multiple types in SLP are handled by creating the appropriate number of"}]}