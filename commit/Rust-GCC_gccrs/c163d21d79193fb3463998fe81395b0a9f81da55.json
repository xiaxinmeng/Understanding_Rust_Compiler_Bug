{"sha": "c163d21d79193fb3463998fe81395b0a9f81da55", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzE2M2QyMWQ3OTE5M2ZiMzQ2Mzk5OGZlODEzOTViMGE5ZjgxZGE1NQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2001-10-24T21:47:23Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2001-10-24T21:47:23Z"}, "message": "stor-layout.c (place_union_field): If any field was aligned with attribute aligned, set record type's TYPE_USER_ALIGN.\n\n\t* stor-layout.c (place_union_field): If any field was aligned with\n\tattribute aligned, set record type's TYPE_USER_ALIGN.\n\t(place_field): Likewise.\n\t(finalize_record_size): Don't clear TYPE_USER_ALIGN.\n\t(layout_type) [ARRAY_TYPE]: Copy element's TYPE_USER_ALIGN.\n\nFrom-SVN: r46475", "tree": {"sha": "ae608d3d6e2328c23270d903f6faaa81040abc11", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ae608d3d6e2328c23270d903f6faaa81040abc11"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c163d21d79193fb3463998fe81395b0a9f81da55", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c163d21d79193fb3463998fe81395b0a9f81da55", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c163d21d79193fb3463998fe81395b0a9f81da55", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c163d21d79193fb3463998fe81395b0a9f81da55/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6dee3a2320540b9b654d9a5ef7626e90246ffe80", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6dee3a2320540b9b654d9a5ef7626e90246ffe80", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6dee3a2320540b9b654d9a5ef7626e90246ffe80"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "f704e4a6bbee153988f5bfadc7af0e48a507aff9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c163d21d79193fb3463998fe81395b0a9f81da55/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c163d21d79193fb3463998fe81395b0a9f81da55/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c163d21d79193fb3463998fe81395b0a9f81da55", "patch": "@@ -1,3 +1,11 @@\n+2001-10-24  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* stor-layout.c (place_union_field): If any field was aligned with\n+\tattribute aligned, set record type's TYPE_USER_ALIGN.\n+\t(place_field): Likewise.\n+\t(finalize_record_size): Don't clear TYPE_USER_ALIGN.\n+\t(layout_type) [ARRAY_TYPE]: Copy element's TYPE_USER_ALIGN.\n+\n 2001-10-24  Zack Weinberg  <zack@codesourcery.com>\n \n \t* c-common.h (struct c_common_identifier): Remove rid_code field."}, {"sha": "22dd86b709ef14f632b84830f715e72b5e9e8a45", "filename": "gcc/stor-layout.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c163d21d79193fb3463998fe81395b0a9f81da55/gcc%2Fstor-layout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c163d21d79193fb3463998fe81395b0a9f81da55/gcc%2Fstor-layout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstor-layout.c?ref=c163d21d79193fb3463998fe81395b0a9f81da55", "patch": "@@ -650,6 +650,8 @@ place_union_field (rli, field)\n       MIN (desired_align, (unsigned) BIGGEST_FIELD_ALIGNMENT);\n #endif\n \n+  TYPE_USER_ALIGN (rli->t) |= DECL_USER_ALIGN (field);\n+\n   /* Union must be at least as aligned as any field requires.  */\n   rli->record_align = MAX (rli->record_align, desired_align);\n   rli->unpadded_align = MAX (rli->unpadded_align, desired_align);\n@@ -924,6 +926,8 @@ place_field (rli, field)\n   DECL_FIELD_BIT_OFFSET (field) = rli->bitpos;\n   SET_DECL_OFFSET_ALIGN (field, rli->offset_align);\n \n+  TYPE_USER_ALIGN (rli->t) |= user_align;\n+\n   /* If this field ended up more aligned than we thought it would be (we\n      approximate this by seeing if its position changed), lay out the field\n      again; perhaps we can use an integral mode for it now.  */\n@@ -993,7 +997,6 @@ finalize_record_size (rli)\n #else\n   TYPE_ALIGN (rli->t) = MAX (TYPE_ALIGN (rli->t), rli->record_align);\n #endif\n-  TYPE_USER_ALIGN (rli->t) = 0;\n \n   /* Compute the size so far.  Be sure to allow for extra bits in the\n      size in bytes.  We have guaranteed above that it will be no more\n@@ -1454,6 +1457,7 @@ layout_type (type)\n #else\n \tTYPE_ALIGN (type) = MAX (TYPE_ALIGN (element), BITS_PER_UNIT);\n #endif\n+\tTYPE_USER_ALIGN (type) = TYPE_USER_ALIGN (element);\n \n #ifdef ROUND_TYPE_SIZE\n \tif (TYPE_SIZE (type) != 0)"}]}