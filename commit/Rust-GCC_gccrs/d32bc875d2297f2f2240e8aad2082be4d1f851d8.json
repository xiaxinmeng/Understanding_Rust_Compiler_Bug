{"sha": "d32bc875d2297f2f2240e8aad2082be4d1f851d8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDMyYmM4NzVkMjI5N2YyZjIyNDBlOGFhZDIwODJiZTRkMWY4NTFkOA==", "commit": {"author": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2017-10-24T07:02:48Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2017-10-24T07:02:48Z"}, "message": "re PR tree-optimization/82672 ([GRAPHITE] ICE in verify_gimple_in_cfg)\n\n2017-10-23  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/82672\n\t* graphite-isl-ast-to-gimple.c (graphite_copy_stmts_from_block):\n\tFold the stmt if we propagated into it.\n\n\t* gfortran.dg/graphite/pr82672.f90: New testcase.\n\nFrom-SVN: r254036", "tree": {"sha": "17bd6804bb91862e208f10a563382c2db21b95b3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/17bd6804bb91862e208f10a563382c2db21b95b3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d32bc875d2297f2f2240e8aad2082be4d1f851d8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d32bc875d2297f2f2240e8aad2082be4d1f851d8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d32bc875d2297f2f2240e8aad2082be4d1f851d8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d32bc875d2297f2f2240e8aad2082be4d1f851d8/comments", "author": null, "committer": null, "parents": [{"sha": "57f6a200e324c605ed19fef107e528d0b902770a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57f6a200e324c605ed19fef107e528d0b902770a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57f6a200e324c605ed19fef107e528d0b902770a"}], "stats": {"total": 38, "additions": 22, "deletions": 16}, "files": [{"sha": "16570e16855725f0b0280fa6a730997e0f10f75a", "filename": "gcc/graphite-isl-ast-to-gimple.c", "status": "modified", "additions": 22, "deletions": 16, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d32bc875d2297f2f2240e8aad2082be4d1f851d8/gcc%2Fgraphite-isl-ast-to-gimple.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d32bc875d2297f2f2240e8aad2082be4d1f851d8/gcc%2Fgraphite-isl-ast-to-gimple.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraphite-isl-ast-to-gimple.c?ref=d32bc875d2297f2f2240e8aad2082be4d1f851d8", "patch": "@@ -1175,22 +1175,28 @@ graphite_copy_stmts_from_block (basic_block bb, basic_block new_bb,\n       ssa_op_iter iter;\n       use_operand_p use_p;\n       if (!is_gimple_debug (copy))\n-\tFOR_EACH_SSA_USE_OPERAND (use_p, copy, iter, SSA_OP_USE)\n-\t  {\n-\t    tree old_name = USE_FROM_PTR (use_p);\n-\n-\t    if (TREE_CODE (old_name) != SSA_NAME\n-\t\t|| SSA_NAME_IS_DEFAULT_DEF (old_name)\n-\t\t|| ! scev_analyzable_p (old_name, region->region))\n-\t      continue;\n-\n-\t    gimple_seq stmts = NULL;\n-\t    tree new_name = get_rename_from_scev (old_name, &stmts,\n-\t\t\t\t\t\t  bb->loop_father, iv_map);\n-\t    if (! codegen_error_p ())\n-\t      gsi_insert_earliest (stmts);\n-\t    replace_exp (use_p, new_name);\n-\t  }\n+\t{\n+\t  bool changed = false;\n+\t  FOR_EACH_SSA_USE_OPERAND (use_p, copy, iter, SSA_OP_USE)\n+\t    {\n+\t      tree old_name = USE_FROM_PTR (use_p);\n+\n+\t      if (TREE_CODE (old_name) != SSA_NAME\n+\t\t  || SSA_NAME_IS_DEFAULT_DEF (old_name)\n+\t\t  || ! scev_analyzable_p (old_name, region->region))\n+\t\tcontinue;\n+\n+\t      gimple_seq stmts = NULL;\n+\t      tree new_name = get_rename_from_scev (old_name, &stmts,\n+\t\t\t\t\t\t    bb->loop_father, iv_map);\n+\t      if (! codegen_error_p ())\n+\t\tgsi_insert_earliest (stmts);\n+\t      replace_exp (use_p, new_name);\n+\t      changed = true;\n+\t    }\n+\t  if (changed)\n+\t    fold_stmt_inplace (&gsi_tgt);\n+\t}\n \n       update_stmt (copy);\n     }"}]}