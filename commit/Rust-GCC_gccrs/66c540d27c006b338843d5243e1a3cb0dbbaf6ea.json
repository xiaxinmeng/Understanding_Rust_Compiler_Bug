{"sha": "66c540d27c006b338843d5243e1a3cb0dbbaf6ea", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjZjNTQwZDI3YzAwNmIzMzg4NDNkNTI0M2UxYTNjYjBkYmJhZjZlYQ==", "commit": {"author": {"name": "Marc Glisse", "email": "marc.glisse@inria.fr", "date": "2012-05-30T10:48:06Z"}, "committer": {"name": "Marc Glisse", "email": "glisse@gcc.gnu.org", "date": "2012-05-30T10:48:06Z"}, "message": "simplify-rtx.c (simplify_binary_operation_1): Optimize shuffle of concatenations.\n\n2012-05-30  Marc Glisse  <marc.glisse@inria.fr>\n\ngcc/\n\t* simplify-rtx.c (simplify_binary_operation_1): Optimize shuffle of\n\tconcatenations.\n\ngcc/testsuite/\n\t* gcc.target/i386/shuf-concat.c: New test.\n\nFrom-SVN: r188006", "tree": {"sha": "da9f6d747436ed3223f6278e7b049997631805e4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/da9f6d747436ed3223f6278e7b049997631805e4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/66c540d27c006b338843d5243e1a3cb0dbbaf6ea", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66c540d27c006b338843d5243e1a3cb0dbbaf6ea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/66c540d27c006b338843d5243e1a3cb0dbbaf6ea", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66c540d27c006b338843d5243e1a3cb0dbbaf6ea/comments", "author": {"login": "mglisse", "id": 10097863, "node_id": "MDQ6VXNlcjEwMDk3ODYz", "avatar_url": "https://avatars.githubusercontent.com/u/10097863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mglisse", "html_url": "https://github.com/mglisse", "followers_url": "https://api.github.com/users/mglisse/followers", "following_url": "https://api.github.com/users/mglisse/following{/other_user}", "gists_url": "https://api.github.com/users/mglisse/gists{/gist_id}", "starred_url": "https://api.github.com/users/mglisse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mglisse/subscriptions", "organizations_url": "https://api.github.com/users/mglisse/orgs", "repos_url": "https://api.github.com/users/mglisse/repos", "events_url": "https://api.github.com/users/mglisse/events{/privacy}", "received_events_url": "https://api.github.com/users/mglisse/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ab068278e973f6f191e161a1d8705b454bb06dae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab068278e973f6f191e161a1d8705b454bb06dae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ab068278e973f6f191e161a1d8705b454bb06dae"}], "stats": {"total": 45, "additions": 44, "deletions": 1}, "files": [{"sha": "f19ac409607f235e2e4f7532cad4ed2813e69260", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66c540d27c006b338843d5243e1a3cb0dbbaf6ea/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66c540d27c006b338843d5243e1a3cb0dbbaf6ea/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=66c540d27c006b338843d5243e1a3cb0dbbaf6ea", "patch": "@@ -1,3 +1,8 @@\n+2012-05-30  Marc Glisse  <marc.glisse@inria.fr>\n+\n+\t* simplify-rtx.c (simplify_binary_operation_1): Optimize shuffle of\n+\tconcatenations.\n+\n 2012-05-30  Richard Guenther  <rguenther@suse.de>\n \n \tPR middle-end/53522"}, {"sha": "6b645fe027cd2badf5630c516d98b1f1cc6523c8", "filename": "gcc/simplify-rtx.c", "status": "modified", "additions": 22, "deletions": 1, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66c540d27c006b338843d5243e1a3cb0dbbaf6ea/gcc%2Fsimplify-rtx.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66c540d27c006b338843d5243e1a3cb0dbbaf6ea/gcc%2Fsimplify-rtx.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsimplify-rtx.c?ref=66c540d27c006b338843d5243e1a3cb0dbbaf6ea", "patch": "@@ -1,7 +1,7 @@\n /* RTL simplification functions for GNU compiler.\n    Copyright (C) 1987, 1988, 1989, 1992, 1993, 1994, 1995, 1996, 1997, 1998,\n    1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,\n-   2011  Free Software Foundation, Inc.\n+   2011, 2012  Free Software Foundation, Inc.\n \n This file is part of GCC.\n \n@@ -3242,6 +3242,27 @@ simplify_binary_operation_1 (enum rtx_code code, enum machine_mode mode,\n \n \t      return gen_rtx_CONST_VECTOR (mode, v);\n \t    }\n+\n+\t  /* If we build {a,b} then permute it, build the result directly.  */\n+\t  if (XVECLEN (trueop1, 0) == 2\n+\t      && CONST_INT_P (XVECEXP (trueop1, 0, 0))\n+\t      && CONST_INT_P (XVECEXP (trueop1, 0, 1))\n+\t      && GET_CODE (trueop0) == VEC_CONCAT\n+\t      && GET_CODE (XEXP (trueop0, 0)) == VEC_CONCAT\n+\t      && GET_MODE (XEXP (trueop0, 0)) == mode\n+\t      && GET_CODE (XEXP (trueop0, 1)) == VEC_CONCAT\n+\t      && GET_MODE (XEXP (trueop0, 1)) == mode)\n+\t    {\n+\t      unsigned int i0 = INTVAL (XVECEXP (trueop1, 0, 0));\n+\t      unsigned int i1 = INTVAL (XVECEXP (trueop1, 0, 1));\n+\t      rtx subop0, subop1;\n+\n+\t      gcc_assert (i0 < 4 && i1 < 4);\n+\t      subop0 = XEXP (XEXP (trueop0, i0 / 2), i0 % 2);\n+\t      subop1 = XEXP (XEXP (trueop0, i1 / 2), i1 % 2);\n+\n+\t      return simplify_gen_binary (VEC_CONCAT, mode, subop0, subop1);\n+\t    }\n \t}\n \n       if (XVECLEN (trueop1, 0) == 1"}, {"sha": "b36bc06a25c0cab44087aafbdcd24ab1a7e51e1e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66c540d27c006b338843d5243e1a3cb0dbbaf6ea/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66c540d27c006b338843d5243e1a3cb0dbbaf6ea/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=66c540d27c006b338843d5243e1a3cb0dbbaf6ea", "patch": "@@ -1,3 +1,7 @@\n+2012-05-30  Marc Glisse  <marc.glisse@inria.fr>\n+\n+\t* gcc.target/i386/shuf-concat.c: New test.\n+\n 2012-05-30  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR rtl-optimization/53519"}, {"sha": "04ed4a9dbb8ee943b6dd48a0ed48e0b020a0ad6a", "filename": "gcc/testsuite/gcc.target/i386/shuf-concat.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66c540d27c006b338843d5243e1a3cb0dbbaf6ea/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fshuf-concat.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66c540d27c006b338843d5243e1a3cb0dbbaf6ea/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fshuf-concat.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fshuf-concat.c?ref=66c540d27c006b338843d5243e1a3cb0dbbaf6ea", "patch": "@@ -0,0 +1,13 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O -msse2 -mfpmath=sse\" } */\n+\n+typedef double v2df __attribute__ ((__vector_size__ (16)));\n+\n+v2df f(double d,double e){\n+  v2df x={-d,d};\n+  v2df y={-e,e};\n+  return __builtin_ia32_shufpd(x,y,1);\n+}\n+\n+/* { dg-final { scan-assembler-not \"\\tv?shufpd\\[ \\t\\]\" } } */\n+/* { dg-final { scan-assembler-times \"\\tv?unpcklpd\\[ \\t\\]\" 1 } } */"}]}