{"sha": "235d0d663cb41ec10f6946352a9ad827e851334e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjM1ZDBkNjYzY2I0MWVjMTBmNjk0NjM1MmE5YWQ4MjdlODUxMzM0ZQ==", "commit": {"author": {"name": "Richard Sandiford", "email": "rsandifo@redhat.com", "date": "2003-11-07T08:14:32Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2003-11-07T08:14:32Z"}, "message": "mips.md (loadgp): Take $25 as a second operand.\n\n\t* config/mips/mips.md (loadgp): Take $25 as a second operand.\n\t* config/mips/mips.c (mips_expand_prologue): Modify accordingly.\n\nFrom-SVN: r73330", "tree": {"sha": "82dd6d23a18b90b743b737b4aaddd1f08e8b0775", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/82dd6d23a18b90b743b737b4aaddd1f08e8b0775"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/235d0d663cb41ec10f6946352a9ad827e851334e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/235d0d663cb41ec10f6946352a9ad827e851334e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/235d0d663cb41ec10f6946352a9ad827e851334e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/235d0d663cb41ec10f6946352a9ad827e851334e/comments", "author": null, "committer": null, "parents": [{"sha": "eb622d37cfc1e4d1760aa1eba3e1ea3149f80469", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eb622d37cfc1e4d1760aa1eba3e1ea3149f80469", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eb622d37cfc1e4d1760aa1eba3e1ea3149f80469"}], "stats": {"total": 33, "additions": 21, "deletions": 12}, "files": [{"sha": "565c30a472f862989e66678e669b12532e40b5a1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/235d0d663cb41ec10f6946352a9ad827e851334e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/235d0d663cb41ec10f6946352a9ad827e851334e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=235d0d663cb41ec10f6946352a9ad827e851334e", "patch": "@@ -1,3 +1,8 @@\n+2003-11-07  Richard Sandiford  <rsandifo@redhat.com>\n+\n+\t* config/mips/mips.md (loadgp): Take $25 as a second operand.\n+\t* config/mips/mips.c (mips_expand_prologue): Modify accordingly.\n+\n 2003-11-06  Matt Austern <austern@apple.com>\n \n \t* c-common.c (handle_visibility_attribute): Set DECL_VISIBILITY"}, {"sha": "9b2bc2f257da47ab166b730978f8d1667cdd70a4", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/235d0d663cb41ec10f6946352a9ad827e851334e/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/235d0d663cb41ec10f6946352a9ad827e851334e/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=235d0d663cb41ec10f6946352a9ad827e851334e", "patch": "@@ -6655,11 +6655,12 @@ mips_expand_prologue (void)\n   /* If generating n32/n64 abicalls, emit the instructions to load $gp.  */\n   if (TARGET_ABICALLS && TARGET_NEWABI && cfun->machine->global_pointer > 0)\n     {\n-      rtx addr, offset;\n+      rtx addr, offset, incoming_address;\n \n       addr = XEXP (DECL_RTL (current_function_decl), 0);\n       offset = mips_unspec_address (addr, SYMBOL_GOTOFF_LOADGP);\n-      emit_insn (gen_loadgp (offset));\n+      incoming_address = gen_rtx_REG (Pmode, PIC_FUNCTION_ADDR_REGNUM);\n+      emit_insn (gen_loadgp (offset, incoming_address));\n       if (!TARGET_EXPLICIT_RELOCS)\n \temit_insn (gen_loadgp_blockage ());\n     }"}, {"sha": "5a4e89eb8ca35e60f29639eaf2440dca1de4be70", "filename": "gcc/config/mips/mips.md", "status": "modified", "additions": 13, "deletions": 10, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/235d0d663cb41ec10f6946352a9ad827e851334e/gcc%2Fconfig%2Fmips%2Fmips.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/235d0d663cb41ec10f6946352a9ad827e851334e/gcc%2Fconfig%2Fmips%2Fmips.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.md?ref=235d0d663cb41ec10f6946352a9ad827e851334e", "patch": "@@ -5123,20 +5123,23 @@ dsrl\\t%3,%3,1\\n\\\n    (set_attr \"mode\"\t\"SF\")\n    (set_attr \"length\"\t\"4\")])\n \n+;; Insn to initialize $gp for n32/n64 abicalls.  Operand 0 is the offset\n+;; of _gp from the start of this function.  Operand 1 is the incoming\n+;; function address.\n (define_insn_and_split \"loadgp\"\n-  [(unspec_volatile [(match_operand 0 \"\" \"\")] UNSPEC_LOADGP)]\n+  [(unspec_volatile [(match_operand 0 \"\" \"\")\n+\t\t     (match_operand 1 \"register_operand\" \"\")] UNSPEC_LOADGP)]\n   \"TARGET_ABICALLS && TARGET_NEWABI\"\n   \"#\"\n   \"\"\n-  [(set (match_dup 1) (match_dup 2))\n-   (set (match_dup 1) (match_dup 3))\n-   (set (match_dup 1) (match_dup 4))]\n-{\n-  operands[1] = pic_offset_table_rtx;\n-  operands[2] = gen_rtx_HIGH (Pmode, operands[0]);\n-  operands[3] = gen_rtx_PLUS (Pmode, operands[1],\n-\t\t\t      gen_rtx_REG (Pmode, PIC_FUNCTION_ADDR_REGNUM));\n-  operands[4] = gen_rtx_LO_SUM (Pmode, operands[1], operands[0]);\n+  [(set (match_dup 2) (match_dup 3))\n+   (set (match_dup 2) (match_dup 4))\n+   (set (match_dup 2) (match_dup 5))]\n+{\n+  operands[2] = pic_offset_table_rtx;\n+  operands[3] = gen_rtx_HIGH (Pmode, operands[0]);\n+  operands[4] = gen_rtx_PLUS (Pmode, operands[2], operands[1]);\n+  operands[5] = gen_rtx_LO_SUM (Pmode, operands[2], operands[0]);\n }\n   [(set_attr \"length\" \"12\")])\n "}]}