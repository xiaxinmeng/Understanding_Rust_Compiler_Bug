{"sha": "b41f0b3440bc8fe4982404c16a63b41521929450", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjQxZjBiMzQ0MGJjOGZlNDk4MjQwNGMxNmE2M2I0MTUyMTkyOTQ1MA==", "commit": {"author": {"name": "Michael Meissner", "email": "meissner@linux.vnet.ibm.com", "date": "2011-01-13T15:59:19Z"}, "committer": {"name": "Michael Meissner", "email": "meissner@gcc.gnu.org", "date": "2011-01-13T15:59:19Z"}, "message": "Fix 47251, failure in powerpc -mcpu=power7 -m32 -msoft-float\n\nFrom-SVN: r168752", "tree": {"sha": "0a3d6fbb49456492285091a11d5c1c4b4cb11d1d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0a3d6fbb49456492285091a11d5c1c4b4cb11d1d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b41f0b3440bc8fe4982404c16a63b41521929450", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b41f0b3440bc8fe4982404c16a63b41521929450", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b41f0b3440bc8fe4982404c16a63b41521929450", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b41f0b3440bc8fe4982404c16a63b41521929450/comments", "author": null, "committer": null, "parents": [{"sha": "2975762754545f8c1fb35e027897e05e87336412", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2975762754545f8c1fb35e027897e05e87336412", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2975762754545f8c1fb35e027897e05e87336412"}], "stats": {"total": 33, "additions": 30, "deletions": 3}, "files": [{"sha": "b96f8121b32b571ffca82f23c3971165409bb382", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b41f0b3440bc8fe4982404c16a63b41521929450/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b41f0b3440bc8fe4982404c16a63b41521929450/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b41f0b3440bc8fe4982404c16a63b41521929450", "patch": "@@ -1,3 +1,10 @@\n+2011-01-13  Michael Meissner  <meissner@linux.vnet.ibm.com>\n+\n+\tPR target/47251\n+\t* config/rs6000/rs6000.md (floatunsdidf2): Add check for hardware\n+\tfloating point.\n+\t(floatunsdidf2_fcfidu): Ditto.\n+\n 2011-01-13  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>\n \n \t* config/s390/s390.c (print_operand_address): Replace 'error' with"}, {"sha": "6d2f515fcf8e5acd01da4c3fa323db3fbb5cd991", "filename": "gcc/config/rs6000/rs6000.md", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b41f0b3440bc8fe4982404c16a63b41521929450/gcc%2Fconfig%2Frs6000%2Frs6000.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b41f0b3440bc8fe4982404c16a63b41521929450/gcc%2Fconfig%2Frs6000%2Frs6000.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.md?ref=b41f0b3440bc8fe4982404c16a63b41521929450", "patch": "@@ -7167,13 +7167,13 @@\n   [(set (match_operand:DF 0 \"gpc_reg_operand\" \"\")\n \t(unsigned_float:DF\n \t (match_operand:DI 1 \"gpc_reg_operand\" \"\")))]\n-  \"TARGET_FCFIDU || VECTOR_UNIT_VSX_P (DFmode)\"\n+  \"TARGET_HARD_FLOAT && (TARGET_FCFIDU || VECTOR_UNIT_VSX_P (DFmode))\"\n   \"\")\n \n (define_insn \"*floatunsdidf2_fcfidu\"\n   [(set (match_operand:DF 0 \"gpc_reg_operand\" \"=d\")\n \t(unsigned_float:DF (match_operand:DI 1 \"gpc_reg_operand\" \"d\")))]\n-  \"TARGET_FCFIDU && !VECTOR_UNIT_VSX_P (DFmode)\"\n+  \"TARGET_HARD_FLOAT && TARGET_FCFIDU && !VECTOR_UNIT_VSX_P (DFmode)\"\n   \"fcfidu %0,%1\"\n   [(set_attr \"type\" \"fp\")\n    (set_attr \"length\" \"4\")])\n@@ -7182,7 +7182,7 @@\n   [(set (match_operand:DF 0 \"gpc_reg_operand\" \"=d\")\n \t(unsigned_float:DF (match_operand:DI 1 \"memory_operand\" \"m\")))\n    (clobber (match_scratch:DI 2 \"=d\"))]\n-  \"TARGET_FCFIDU || VECTOR_UNIT_VSX_P (DFmode)\"\n+  \"TARGET_HARD_FLOAT && (TARGET_FCFIDU || VECTOR_UNIT_VSX_P (DFmode))\"\n   \"#\"\n   \"&& reload_completed\"\n   [(set (match_dup 2) (match_dup 1))"}, {"sha": "c171c3d0028f9172746a85b1995b2df6bb4ba911", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b41f0b3440bc8fe4982404c16a63b41521929450/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b41f0b3440bc8fe4982404c16a63b41521929450/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b41f0b3440bc8fe4982404c16a63b41521929450", "patch": "@@ -1,3 +1,8 @@\n+2011-01-13  Michael Meissner  <meissner@linux.vnet.ibm.com>\n+\n+\tPR target/47251\n+\t* gcc.target/powerpc/pr47251.c: New file, test PR 47251 fix.\n+\n 2011-01-13  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>\n \n \t* gcc.dg/guality/pr36728-1.c: Disable arg1/2 checks for s390 and"}, {"sha": "3089c493378073354a68f492ec5634caf029f1c7", "filename": "gcc/testsuite/gcc.target/powerpc/pr47251.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b41f0b3440bc8fe4982404c16a63b41521929450/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr47251.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b41f0b3440bc8fe4982404c16a63b41521929450/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr47251.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr47251.c?ref=b41f0b3440bc8fe4982404c16a63b41521929450", "patch": "@@ -0,0 +1,15 @@\n+/* { dg-do compile { target { powerpc*-*-* && ip32 } } } */\n+/* { dg-skip-if \"\" { powerpc*-*-darwin* } { \"*\" } { \"\" } } */\n+/* { dg-require-effective-target powerpc_vsx_ok } */\n+/* { dg-options \"-O2 -msoft-float -mcpu=power7\" } */\n+\n+/* PR 47151: libgcc fails to build when using --with-cpu=power7 due to a missed\n+   TARGET_HARD_FLOAT test.  */\n+unsigned int\n+__fixunssfdi (float a)\n+{\n+  const float dfa = a;\n+  const unsigned int hi = dfa / 0x1p32f;\n+  const unsigned int lo = dfa - (float) hi * 0x1p32f;\n+  return ((unsigned int) hi << (4 * 8)) | lo;\n+}"}]}