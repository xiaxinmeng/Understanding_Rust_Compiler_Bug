{"sha": "ca9e13823c9e8cf547dbcd98416e1b4dfcced5fa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2E5ZTEzODIzYzllOGNmNTQ3ZGJjZDk4NDE2ZTFiNGRmY2NlZDVmYQ==", "commit": {"author": {"name": "Kriang Lerdsuwanakij", "email": "lerdsuwa@users.sourceforge.net", "date": "2003-03-09T14:30:18Z"}, "committer": {"name": "Kriang Lerdsuwanakij", "email": "lerdsuwa@gcc.gnu.org", "date": "2003-03-09T14:30:18Z"}, "message": "re PR c++/9970 (previously declared inline friend can't access members)\n\n\tPR c++/9970\n\t* decl.c (duplicate_decls): Only copy DECL_THUNKS for virtual\n\tfunctions.\n\n\t* g++.dg/lookup/friend1.C: New test.\n\nFrom-SVN: r64029", "tree": {"sha": "023dc3d8583203ef9854baf4a70e196dfabefbe6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/023dc3d8583203ef9854baf4a70e196dfabefbe6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ca9e13823c9e8cf547dbcd98416e1b4dfcced5fa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ca9e13823c9e8cf547dbcd98416e1b4dfcced5fa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ca9e13823c9e8cf547dbcd98416e1b4dfcced5fa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ca9e13823c9e8cf547dbcd98416e1b4dfcced5fa/comments", "author": null, "committer": null, "parents": [{"sha": "c5979bc6a244692449d277e24083da7849f78bd7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c5979bc6a244692449d277e24083da7849f78bd7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c5979bc6a244692449d277e24083da7849f78bd7"}], "stats": {"total": 31, "additions": 30, "deletions": 1}, "files": [{"sha": "7d7debe3ed647e57bec87f441f1cb009371ca558", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca9e13823c9e8cf547dbcd98416e1b4dfcced5fa/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca9e13823c9e8cf547dbcd98416e1b4dfcced5fa/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=ca9e13823c9e8cf547dbcd98416e1b4dfcced5fa", "patch": "@@ -1,3 +1,9 @@\n+2003-03-09  Kriang Lerdsuwanakij  <lerdsuwa@users.sourceforge.net>\n+\n+\tPR c++/9970\n+\t* decl.c (duplicate_decls): Only copy DECL_THUNKS for virtual\n+\tfunctions.\n+\n 2003-03-08  Geoffrey Keating  <geoffk@apple.com>\n \n \t* lang-specs.h (c++-header): Change .pch to .gch."}, {"sha": "639c5d04293aace51589c11dee0b6d835b99e1d5", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca9e13823c9e8cf547dbcd98416e1b4dfcced5fa/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca9e13823c9e8cf547dbcd98416e1b4dfcced5fa/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=ca9e13823c9e8cf547dbcd98416e1b4dfcced5fa", "patch": "@@ -3554,7 +3554,10 @@ duplicate_decls (tree newdecl, tree olddecl)\n \t  DECL_BEFRIENDING_CLASSES (newdecl)\n \t    = chainon (DECL_BEFRIENDING_CLASSES (newdecl),\n \t\t       DECL_BEFRIENDING_CLASSES (olddecl));\n-\t  DECL_THUNKS (newdecl) = DECL_THUNKS (olddecl);\n+\t  /* DECL_THUNKS is only valid for virtual functions,\n+\t     otherwise it is a DECL_FRIEND_CONTEXT.  */\n+\t  if (DECL_VIRTUAL_P (newdecl))\n+\t    DECL_THUNKS (newdecl) = DECL_THUNKS (olddecl);\n \t}\n     }\n "}, {"sha": "15d6935eba573c250e1b2df4573d61044b94d1d9", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca9e13823c9e8cf547dbcd98416e1b4dfcced5fa/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca9e13823c9e8cf547dbcd98416e1b4dfcced5fa/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ca9e13823c9e8cf547dbcd98416e1b4dfcced5fa", "patch": "@@ -1,3 +1,8 @@\n+2003-03-09  Kriang Lerdsuwanakij  <lerdsuwa@users.sourceforge.net>\n+\n+\tPR c++/9970\n+\t* g++.dg/lookup/friend1.C: New test.\n+\n 2003-03-08  Mark Mitchell  <mark@codesourcery.com>\n \n \tPR c++/9823"}, {"sha": "47fe0556519e8072060ef5e675c1235323ce6964", "filename": "gcc/testsuite/g++.dg/lookup/friend1.C", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca9e13823c9e8cf547dbcd98416e1b4dfcced5fa/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Ffriend1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca9e13823c9e8cf547dbcd98416e1b4dfcced5fa/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Ffriend1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Ffriend1.C?ref=ca9e13823c9e8cf547dbcd98416e1b4dfcced5fa", "patch": "@@ -0,0 +1,15 @@\n+// { dg-do compile }\n+\n+// Origin: <matz@suse.de>\n+\n+// PR c++/9970: In-class friend function definition after\n+// declaration lexical scope problem.\n+\n+void f();\n+struct X\n+{\n+  enum { k = 1 };\n+  friend void f() {\n+        char a[k];\n+  }\n+};"}]}