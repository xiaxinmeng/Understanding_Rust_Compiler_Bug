{"sha": "cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2JhMTQ2ZWIzMmEzYmE2NmUxZmJlMWM5ZGE3ZmI2ODc4OGNhNWIwNg==", "commit": {"author": {"name": "Paul Brook", "email": "paul@codesourcery.com", "date": "2009-07-21T12:35:38Z"}, "committer": {"name": "Paul Brook", "email": "pbrook@gcc.gnu.org", "date": "2009-07-21T12:35:38Z"}, "message": "tree-vectorizer.c (increase_alignment): Handle nested arrays.\n\n2009-07-21  Paul Brook <paul@codesourcery.com>\n\n\tgcc/\n\t* tree-vectorizer.c (increase_alignment): Handle nested arrays.\n\tTerminate debug dump with newline.\n\n\tgcc/testsuite/\n\t* gcc.dg/vect/section-anchors-nest-1.c: New test.\n\t* lib/target-supports.exp (check_effective_target_section_anchors):\n\tAdd arm*-*-*.\n\nFrom-SVN: r149853", "tree": {"sha": "b8eeb7763d8791aff99b58f9aee0b245a8fc13d0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b8eeb7763d8791aff99b58f9aee0b245a8fc13d0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06/comments", "author": null, "committer": null, "parents": [{"sha": "309e9930efb67cd497365b487ff3f66b4d178e8f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/309e9930efb67cd497365b487ff3f66b4d178e8f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/309e9930efb67cd497365b487ff3f66b4d178e8f"}], "stats": {"total": 56, "additions": 53, "deletions": 3}, "files": [{"sha": "c189dda3f5038a9233ae5d484bd84692dc27f03e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06", "patch": "@@ -1,3 +1,8 @@\n+2009-07-21  Paul Brook <paul@codesourcery.com>\n+\n+\t* tree-vectorizer.c (increase_alignment): Handle nested arrays.\n+\tTerminate debug dump with newline.\n+\n 2009-07-20  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>\n \n \t* pa.c (compute_zdepwi_operands): Limit deposit length to 32 - lsb."}, {"sha": "a50af8678fbd2e4cdf9c00d27925285351493954", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06", "patch": "@@ -1,3 +1,9 @@\n+2009-07-21  Paul Brook <paul@codesourcery.com>\n+\n+\t* gcc.dg/vect/section-anchors-nest-1.c: New test.\n+\t* lib/target-supports.exp (check_effective_target_section_anchors):\n+\tAdd arm*-*-*.\n+\n 2009-07-20  Olatunji Ruwase  <tjruwase@google.com>\n \n \t* gcc.dg/plugin/finish_unit_plugin.c: New test."}, {"sha": "39a24ccaf22256cffc0f0ffe632dc8f4094e47cf", "filename": "gcc/testsuite/gcc.dg/vect/section-anchors-nest-1.c", "status": "added", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fsection-anchors-nest-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fsection-anchors-nest-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fsection-anchors-nest-1.c?ref=cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06", "patch": "@@ -0,0 +1,35 @@\n+/* { dg-do compile } */\n+/* { dg-require-effective-target section_anchors } */\n+/* { dg-require-effective-target vect_int } */\n+/* { dg-options \"-O2 -ftree-vectorize -fsection-anchors -fno-vect-cost-model -fdump-ipa-increase_alignment\" } */\n+\n+#include <stdarg.h>\n+#include \"tree-vect.h\"\n+\n+#define N 32\n+\n+static int a[N][N];\n+static int b[N][N];\n+static int c[N][N];\n+\n+void clobber(int *);\n+\n+int *foo(void)\n+{\n+  int i;\n+  int j;\n+\n+  clobber (&a[0][0]);\n+  clobber (&b[0][0]);\n+  clobber (&c[0][0]);\n+\n+  for (i = 0; i < N; i++) {\n+      for (j = 0; j < N; j++) {\n+\t  c[j][i] += a[j][i] + c[j][i];\n+      }\n+  }\n+  return &c[0][0];\n+}\n+\n+/* { dg-final { scan-ipa-dump-times \"Increasing alignment of decl\" 3 \"increase_alignment\" } } */\n+/* { dg -finalfoo { cleanup-ipa-dump \"increase_alignment\" } } */"}, {"sha": "f007e04e5983d6b01ceae2119885de4ed726287c", "filename": "gcc/testsuite/lib/target-supports.exp", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp?ref=cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06", "patch": "@@ -2553,7 +2553,8 @@ proc check_effective_target_section_anchors { } {\n         verbose \"check_effective_target_section_anchors: using cached result\" 2\n     } else {\n         set et_section_anchors_saved 0\n-        if { [istarget powerpc*-*-*] } {\n+        if { [istarget powerpc*-*-*] \n+\t      || [istarget arm*-*-*] } {\n            set et_section_anchors_saved 1\n         }\n     }"}, {"sha": "90abbd76665cc688651fc2741af24ff98feea733", "filename": "gcc/tree-vectorizer.c", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06/gcc%2Ftree-vectorizer.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06/gcc%2Ftree-vectorizer.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vectorizer.c?ref=cba146eb32a3ba66e1fbe1c9da7fb68788ca5b06", "patch": "@@ -337,11 +337,13 @@ increase_alignment (void)\n        vnode = vnode->next_needed)\n     {\n       tree vectype, decl = vnode->decl;\n+      tree t;\n       unsigned int alignment;\n \n-      if (TREE_CODE (TREE_TYPE (decl)) != ARRAY_TYPE)\n+      t = TREE_TYPE(decl);\n+      if (TREE_CODE (t) != ARRAY_TYPE)\n         continue;\n-      vectype = get_vectype_for_scalar_type (TREE_TYPE (TREE_TYPE (decl)));\n+      vectype = get_vectype_for_scalar_type (strip_array_types (t));\n       if (!vectype)\n         continue;\n       alignment = TYPE_ALIGN (vectype);\n@@ -356,6 +358,7 @@ increase_alignment (void)\n             {\n               fprintf (dump_file, \"Increasing alignment of decl: \");\n               print_generic_expr (dump_file, decl, TDF_SLIM);\n+\t      fprintf (dump_file, \"\\n\");\n             }\n         }\n     }"}]}