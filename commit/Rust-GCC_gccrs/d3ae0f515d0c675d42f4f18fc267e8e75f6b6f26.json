{"sha": "d3ae0f515d0c675d42f4f18fc267e8e75f6b6f26", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDNhZTBmNTE1ZDBjNjc1ZDQyZjRmMThmYzI2N2U4ZTc1ZjZiNmYyNg==", "commit": {"author": {"name": "Iain Buclaw", "email": "ibuclaw@gdcproject.org", "date": "2019-06-16T16:12:47Z"}, "committer": {"name": "Iain Buclaw", "email": "ibuclaw@gdcproject.org", "date": "2021-03-28T12:47:35Z"}, "message": "d: Use COMPILER_FOR_BUILD to build all D front-end generator programs\n\nThis means the correct config headers are included when building the\nD front-end in a Canadian cross configuration.\n\ngcc/d/ChangeLog:\n\n\t* Make-lang.in (DMDGEN_COMPILE): Remove.\n\t(d/%.dmdgen.o): Use COMPILER_FOR_BUILD and BUILD_COMPILERFLAGS to\n\tbuild all D generator programs.\n\t(D_SYSTEM_H): New macro.\n\t(d/idgen.dmdgen.o): Add dependencies to build.\n\t(d/impcnvgen.dmdgen.o): Likewise.\n\t* d-system.h: Include bconfig.h if GENERATOR_FILE is defined.", "tree": {"sha": "5a25cb8f3b5060830a4d60970387f36cd29846ab", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5a25cb8f3b5060830a4d60970387f36cd29846ab"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d3ae0f515d0c675d42f4f18fc267e8e75f6b6f26", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d3ae0f515d0c675d42f4f18fc267e8e75f6b6f26", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d3ae0f515d0c675d42f4f18fc267e8e75f6b6f26", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d3ae0f515d0c675d42f4f18fc267e8e75f6b6f26/comments", "author": {"login": "ibuclaw", "id": 397929, "node_id": "MDQ6VXNlcjM5NzkyOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/397929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ibuclaw", "html_url": "https://github.com/ibuclaw", "followers_url": "https://api.github.com/users/ibuclaw/followers", "following_url": "https://api.github.com/users/ibuclaw/following{/other_user}", "gists_url": "https://api.github.com/users/ibuclaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/ibuclaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ibuclaw/subscriptions", "organizations_url": "https://api.github.com/users/ibuclaw/orgs", "repos_url": "https://api.github.com/users/ibuclaw/repos", "events_url": "https://api.github.com/users/ibuclaw/events{/privacy}", "received_events_url": "https://api.github.com/users/ibuclaw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ibuclaw", "id": 397929, "node_id": "MDQ6VXNlcjM5NzkyOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/397929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ibuclaw", "html_url": "https://github.com/ibuclaw", "followers_url": "https://api.github.com/users/ibuclaw/followers", "following_url": "https://api.github.com/users/ibuclaw/following{/other_user}", "gists_url": "https://api.github.com/users/ibuclaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/ibuclaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ibuclaw/subscriptions", "organizations_url": "https://api.github.com/users/ibuclaw/orgs", "repos_url": "https://api.github.com/users/ibuclaw/repos", "events_url": "https://api.github.com/users/ibuclaw/events{/privacy}", "received_events_url": "https://api.github.com/users/ibuclaw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "65c001bfaf778e83ded451f94d2a0da528758dd8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/65c001bfaf778e83ded451f94d2a0da528758dd8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/65c001bfaf778e83ded451f94d2a0da528758dd8"}], "stats": {"total": 18, "additions": 15, "deletions": 3}, "files": [{"sha": "75857d81ec7e99a638e5c96c829ff1bc15083e0f", "filename": "gcc/d/Make-lang.in", "status": "modified", "additions": 11, "deletions": 3, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d3ae0f515d0c675d42f4f18fc267e8e75f6b6f26/gcc%2Fd%2FMake-lang.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d3ae0f515d0c675d42f4f18fc267e8e75f6b6f26/gcc%2Fd%2FMake-lang.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fd%2FMake-lang.in?ref=d3ae0f515d0c675d42f4f18fc267e8e75f6b6f26", "patch": "@@ -52,7 +52,6 @@ d-warn = $(filter-out -pedantic -Woverloaded-virtual, $(STRICT_WARN))\n # Also filter out warnings for missing format attributes in the D Frontend.\n DMD_WARN_CXXFLAGS = $(filter-out -Wmissing-format-attribute, $(WARN_CXXFLAGS))\n DMD_COMPILE = $(subst $(WARN_CXXFLAGS), $(DMD_WARN_CXXFLAGS), $(COMPILE))\n-DMDGEN_COMPILE = $(subst $(COMPILER), $(COMPILER_FOR_BUILD), $(DMD_COMPILE))\n \n # D Frontend object files.\n D_FRONTEND_OBJS = \\\n@@ -360,6 +359,15 @@ d/id.h: d/id.c\n d/impcnvtab.c: d/impcnvgen$(build_exeext)\n \tcd d && ./impcnvgen$(build_exeext)\n \n+# Compile the generator programs.\n d/%.dmdgen.o: $(srcdir)/d/dmd/%.c\n-\t$(DMDGEN_COMPILE) $(D_INCLUDES) $<\n-\t$(POSTCOMPILE)\n+\t$(COMPILER_FOR_BUILD) -c $(BUILD_COMPILERFLAGS) $(D_INCLUDES) \\\n+\t\t$(BUILD_CPPFLAGS) -o $@ $<\n+\n+# Header dependencies for the generator programs.\n+D_SYSTEM_H = d/dmd/root/dsystem.h d/d-system.h\n+\n+d/idgen.dmdgen.o: d/dmd/idgen.c $(D_SYSTEM_H) $(BCONFIG_H) $(SYSTEM_H)\n+\n+d/impcnvgen.dmdgen.o: d/dmd/impcnvgen.c d/dmd/mtype.h $(D_SYSTEM_H) \\\n+\t$(BCONFIG_H) $(SYSTEM_H)"}, {"sha": "a6a9fccc6b809d03a0454aa406b1905ced2bf123", "filename": "gcc/d/d-system.h", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d3ae0f515d0c675d42f4f18fc267e8e75f6b6f26/gcc%2Fd%2Fd-system.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d3ae0f515d0c675d42f4f18fc267e8e75f6b6f26/gcc%2Fd%2Fd-system.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fd%2Fd-system.h?ref=d3ae0f515d0c675d42f4f18fc267e8e75f6b6f26", "patch": "@@ -19,7 +19,11 @@\n #ifndef GCC_D_SYSTEM_H\n #define GCC_D_SYSTEM_H\n \n+#ifdef GENERATOR_FILE\n+#include \"bconfig.h\"\n+#else\n #include \"config.h\"\n+#endif\n #include \"system.h\"\n \n /* Used by the dmd front-end to determine if we have POSIX-style IO.  */"}]}