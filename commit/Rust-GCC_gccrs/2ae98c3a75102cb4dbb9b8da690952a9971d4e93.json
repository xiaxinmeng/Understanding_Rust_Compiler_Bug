{"sha": "2ae98c3a75102cb4dbb9b8da690952a9971d4e93", "node_id": "C_kwDOANBUbNoAKDJhZTk4YzNhNzUxMDJjYjRkYmI5YjhkYTY5MDk1MmE5OTcxZDRlOTM", "commit": {"author": {"name": "Piotr Trojanek", "email": "trojanek@adacore.com", "date": "2022-05-06T15:23:25Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2022-06-01T08:43:18Z"}, "message": "[Ada] Propagate null-exclusion to anonymous access types\n\nWhen analyzing an array or record type declaration whose component has a\nconstrained access type, e.g.:\n\n   type Buffer_Acc is not null access all String;\n\n   type Buffer_Rec is record\n      Data : Buffer_Acc (1 .. 10);\n   end record;\n\n   type Buffer_Arr is array (Boolean) of Buffer_Acc (1 .. 10);\n\nwe propagated various properties of the unconstrained access type (e.g.\nthe designated type, access-to-constant flag), but forgot to propagate\nthe null-exclusion.\n\nFor GNAT it didn't make a big difference, because the (anonymous)\ncomponent type was never subject to legality checks. The \"value\ntracking\" optimisation machinery, which also deals with null values,\nonly works for entire objects and doesn't care about components.\nHowever, GNATprove uses this flag when an access-to-component object is\ndereferenced.\n\ngcc/ada/\n\n\t* sem_ch3.adb (Constrain_Access): Propagate null-exclusion flag\n\tfrom parent type.", "tree": {"sha": "41d67a485a44a5bc854e1d19b27b0a4fe1cc3f3e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/41d67a485a44a5bc854e1d19b27b0a4fe1cc3f3e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2ae98c3a75102cb4dbb9b8da690952a9971d4e93", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2ae98c3a75102cb4dbb9b8da690952a9971d4e93", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2ae98c3a75102cb4dbb9b8da690952a9971d4e93", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2ae98c3a75102cb4dbb9b8da690952a9971d4e93/comments", "author": {"login": "ptroja", "id": 161602, "node_id": "MDQ6VXNlcjE2MTYwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/161602?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ptroja", "html_url": "https://github.com/ptroja", "followers_url": "https://api.github.com/users/ptroja/followers", "following_url": "https://api.github.com/users/ptroja/following{/other_user}", "gists_url": "https://api.github.com/users/ptroja/gists{/gist_id}", "starred_url": "https://api.github.com/users/ptroja/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ptroja/subscriptions", "organizations_url": "https://api.github.com/users/ptroja/orgs", "repos_url": "https://api.github.com/users/ptroja/repos", "events_url": "https://api.github.com/users/ptroja/events{/privacy}", "received_events_url": "https://api.github.com/users/ptroja/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8182602c5061ddc9c329ecef26a7fd77b9264ec0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8182602c5061ddc9c329ecef26a7fd77b9264ec0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8182602c5061ddc9c329ecef26a7fd77b9264ec0"}], "stats": {"total": 1, "additions": 1, "deletions": 0}, "files": [{"sha": "f91d3edfefd13cf3cacf53ca1c042c362ed3f9c0", "filename": "gcc/ada/sem_ch3.adb", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2ae98c3a75102cb4dbb9b8da690952a9971d4e93/gcc%2Fada%2Fsem_ch3.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2ae98c3a75102cb4dbb9b8da690952a9971d4e93/gcc%2Fada%2Fsem_ch3.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch3.adb?ref=2ae98c3a75102cb4dbb9b8da690952a9971d4e93", "patch": "@@ -13535,6 +13535,7 @@ package body Sem_Ch3 is\n       Set_Directly_Designated_Type (Def_Id, Desig_Subtype);\n       Set_Depends_On_Private       (Def_Id, Has_Private_Component (Def_Id));\n       Set_Is_Access_Constant       (Def_Id, Is_Access_Constant (T));\n+      Set_Can_Never_Be_Null        (Def_Id, Can_Never_Be_Null (T));\n \n       Conditional_Delay (Def_Id, T);\n "}]}