{"sha": "874c7b7df2de8cec8dc6732bda78c8639862236e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODc0YzdiN2RmMmRlOGNlYzhkYzY3MzJiZGE3OGM4NjM5ODYyMjM2ZQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2018-06-10T21:19:07Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2018-06-10T21:19:07Z"}, "message": "decl.c (grokfndecl): Use the location_t argument in two more places.\n\n/cp\n2018-06-10  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\t* decl.c (grokfndecl): Use the location_t argument in two more places.\n\n/testsuite\n2018-06-10  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\t* g++.dg/template/friend64.C: New.\n\t* g++.old-deja/g++.other/friend4.C: Test the location too.\n\t* g++.old-deja/g++.pt/crash23.C: Likewise.\n\nFrom-SVN: r261389", "tree": {"sha": "3f5b5c928d3b47a9bfc1c1eed390cfa3a06e26cf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3f5b5c928d3b47a9bfc1c1eed390cfa3a06e26cf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/874c7b7df2de8cec8dc6732bda78c8639862236e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/874c7b7df2de8cec8dc6732bda78c8639862236e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/874c7b7df2de8cec8dc6732bda78c8639862236e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/874c7b7df2de8cec8dc6732bda78c8639862236e/comments", "author": null, "committer": null, "parents": [{"sha": "980fa45eefc0ec8f71e1947a28938af28f6fdbb2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/980fa45eefc0ec8f71e1947a28938af28f6fdbb2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/980fa45eefc0ec8f71e1947a28938af28f6fdbb2"}], "stats": {"total": 32, "additions": 25, "deletions": 7}, "files": [{"sha": "bdf717f82fb0ec57bb957a30c578cbc7a4e8c031", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/874c7b7df2de8cec8dc6732bda78c8639862236e/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/874c7b7df2de8cec8dc6732bda78c8639862236e/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=874c7b7df2de8cec8dc6732bda78c8639862236e", "patch": "@@ -1,3 +1,7 @@\n+2018-06-10  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\t* decl.c (grokfndecl): Use the location_t argument in two more places.\n+\n 2018-06-06  Marek Polacek  <polacek@redhat.com>\n \n \tPR c++/85977"}, {"sha": "688ba4a1442a8f884dd1466a28b021d81ba434eb", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/874c7b7df2de8cec8dc6732bda78c8639862236e/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/874c7b7df2de8cec8dc6732bda78c8639862236e/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=874c7b7df2de8cec8dc6732bda78c8639862236e", "patch": "@@ -8674,8 +8674,9 @@ grokfndecl (tree ctype,\n   if (friendp && TREE_CODE (orig_declarator) == TEMPLATE_ID_EXPR)\n     {\n       if (funcdef_flag)\n-\terror (\"defining explicit specialization %qD in friend declaration\",\n-\t       orig_declarator);\n+\terror_at (location,\n+\t\t  \"defining explicit specialization %qD in friend declaration\",\n+\t\t  orig_declarator);\n       else\n \t{\n \t  tree fns = TREE_OPERAND (orig_declarator, 0);\n@@ -8684,9 +8685,10 @@ grokfndecl (tree ctype,\n \t  if (PROCESSING_REAL_TEMPLATE_DECL_P ())\n \t    {\n \t      /* Something like `template <class T> friend void f<T>()'.  */\n-\t      error (\"invalid use of template-id %qD in declaration \"\n-\t\t     \"of primary template\",\n-\t\t     orig_declarator);\n+\t      error_at (location,\n+\t\t\t\"invalid use of template-id %qD in declaration \"\n+\t\t\t\"of primary template\",\n+\t\t\torig_declarator);\n \t      return NULL_TREE;\n \t    }\n "}, {"sha": "040cce2b770bec0377702af84266f3d7519826b0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/874c7b7df2de8cec8dc6732bda78c8639862236e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/874c7b7df2de8cec8dc6732bda78c8639862236e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=874c7b7df2de8cec8dc6732bda78c8639862236e", "patch": "@@ -1,3 +1,9 @@\n+2018-06-10  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\t* g++.dg/template/friend64.C: New.\n+\t* g++.old-deja/g++.other/friend4.C: Test the location too.\n+\t* g++.old-deja/g++.pt/crash23.C: Likewise.\n+\n 2018-06-10  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \t* gfortran.dg/inline_matmul_23.f90: New test."}, {"sha": "77a8c97cf567257baafa5d71ad22490112832fdc", "filename": "gcc/testsuite/g++.dg/template/friend64.C", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/874c7b7df2de8cec8dc6732bda78c8639862236e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ffriend64.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/874c7b7df2de8cec8dc6732bda78c8639862236e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ffriend64.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ffriend64.C?ref=874c7b7df2de8cec8dc6732bda78c8639862236e", "patch": "@@ -0,0 +1,6 @@\n+template <class T> void foo (int);\n+\n+template <class T>\n+class Q {\n+  friend void foo<T> (int) { }  // { dg-error \"15:defining explicit specialization\" }\n+};"}, {"sha": "a55184769072c7c4b93eea58ab0b4aecdc37cdc7", "filename": "gcc/testsuite/g++.old-deja/g++.other/friend4.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/874c7b7df2de8cec8dc6732bda78c8639862236e/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Ffriend4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/874c7b7df2de8cec8dc6732bda78c8639862236e/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Ffriend4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Ffriend4.C?ref=874c7b7df2de8cec8dc6732bda78c8639862236e", "patch": "@@ -11,7 +11,7 @@\n template <class A, class B> void foo();\n template <class C> class bar {\n   int i; // { dg-message \"\" } private\n-  template <class B> friend void foo<C,B>(); // { dg-error \"\" } bogus declaration\n+  template <class B> friend void foo<C,B>(); // { dg-error \"34:invalid use of template-id\" }\n };\n template <class A, class B> void foo() {\n   bar<A> baz; baz.i = 1;   // { dg-error \"\" } foo cannot access bar<int>::i"}, {"sha": "ef37f95548e030b2198d7ea648fefeed13a7671e", "filename": "gcc/testsuite/g++.old-deja/g++.pt/crash23.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/874c7b7df2de8cec8dc6732bda78c8639862236e/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fcrash23.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/874c7b7df2de8cec8dc6732bda78c8639862236e/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fcrash23.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fcrash23.C?ref=874c7b7df2de8cec8dc6732bda78c8639862236e", "patch": "@@ -4,7 +4,7 @@ template <class A, class B> void foo();\n template <class C> class bar {\n public:\n   int i;\n-  template <class B> friend void foo<C,B>(); // { dg-error \"\" } template-id\n+  template <class B> friend void foo<C,B>(); // { dg-error \"34:invalid use of template-id\" }\n };\n template <class A, class B> void foo() {\n   bar<A> baz; baz.i = 1;"}]}