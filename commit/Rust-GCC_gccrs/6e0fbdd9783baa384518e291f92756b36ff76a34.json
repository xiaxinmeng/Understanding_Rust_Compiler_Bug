{"sha": "6e0fbdd9783baa384518e291f92756b36ff76a34", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmUwZmJkZDk3ODNiYWEzODQ1MThlMjkxZjkyNzU2YjM2ZmY3NmEzNA==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2005-06-25T11:22:50Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2005-06-25T11:22:50Z"}, "message": "builtins.c (define_builtin): Accept new flags parameter.\n\n\n\t* builtins.c (define_builtin): Accept new flags parameter.\n\t(initialize_builtins): Mark the builtins const and nothrow accordingly.\n\nFrom-SVN: r101319", "tree": {"sha": "5b342106eb78ab2a9cf10127af3acf0527e396ef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5b342106eb78ab2a9cf10127af3acf0527e396ef"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6e0fbdd9783baa384518e291f92756b36ff76a34", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6e0fbdd9783baa384518e291f92756b36ff76a34", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6e0fbdd9783baa384518e291f92756b36ff76a34", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6e0fbdd9783baa384518e291f92756b36ff76a34/comments", "author": null, "committer": null, "parents": [{"sha": "0e6d033bc892f6f79683dcbbda0e6a1987685bf4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0e6d033bc892f6f79683dcbbda0e6a1987685bf4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0e6d033bc892f6f79683dcbbda0e6a1987685bf4"}], "stats": {"total": 62, "additions": 43, "deletions": 19}, "files": [{"sha": "229845e076010c302651ac78ffda901a4a3c6523", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6e0fbdd9783baa384518e291f92756b36ff76a34/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6e0fbdd9783baa384518e291f92756b36ff76a34/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=6e0fbdd9783baa384518e291f92756b36ff76a34", "patch": "@@ -1,3 +1,8 @@\n+2005-06-25  Jan Hubicka  <jh@suse.cz>\n+\n+\t* builtins.c (define_builtin): Accept new flags parameter.\n+\t(initialize_builtins): Mark the builtins const and nothrow accordingly.\n+\n 2005-06-25  Kelley Cook  <kcook@gcc.gnu.org>\n \n \t* all files: Update FSF address in copyright headers."}, {"sha": "68f0b95f1b5f58faacf80895c2bc1939affdcb4d", "filename": "gcc/java/builtins.c", "status": "modified", "additions": 38, "deletions": 19, "changes": 57, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6e0fbdd9783baa384518e291f92756b36ff76a34/gcc%2Fjava%2Fbuiltins.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6e0fbdd9783baa384518e291f92756b36ff76a34/gcc%2Fjava%2Fbuiltins.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fbuiltins.c?ref=6e0fbdd9783baa384518e291f92756b36ff76a34", "patch": "@@ -41,8 +41,6 @@ static tree min_builtin (tree, tree);\n static tree abs_builtin (tree, tree);\n \n static tree java_build_function_call_expr (tree, tree);\n-static void define_builtin (enum built_in_function, const char *,\n-\t\t\t    tree, const char *);\n \n \f\n \n@@ -131,12 +129,15 @@ java_build_function_call_expr (tree fn, tree arglist)\n \n \f\n \n+#define BUILTIN_NOTHROW 1\n+#define BUILTIN_CONST 2\n /* Define a single builtin.  */\n static void\n define_builtin (enum built_in_function val,\n \t\tconst char *name,\n \t\ttree type,\n-\t\tconst char *libname)\n+\t\tconst char *libname,\n+\t\tint flags)\n {\n   tree decl;\n \n@@ -147,6 +148,10 @@ define_builtin (enum built_in_function val,\n   pushdecl (decl);\n   DECL_BUILT_IN_CLASS (decl) = BUILT_IN_NORMAL;\n   DECL_FUNCTION_CODE (decl) = val;\n+  if (flags & BUILTIN_NOTHROW)\n+    TREE_NOTHROW (decl) = 1;\n+  if (flags & BUILTIN_CONST)\n+    TREE_READONLY (decl) = 1;\n \n   implicit_built_in_decls[val] = decl;\n   built_in_decls[val] = decl;\n@@ -186,43 +191,57 @@ initialize_builtins (void)\n   double_ftype_double_double = build_function_type (double_type_node, t);\n \n   define_builtin (BUILT_IN_FMOD, \"__builtin_fmod\",\n-\t\t  double_ftype_double_double, \"fmod\");\n+\t\t  double_ftype_double_double, \"fmod\", BUILTIN_CONST);\n   define_builtin (BUILT_IN_FMODF, \"__builtin_fmodf\",\n-\t\t  float_ftype_float_float, \"fmodf\");\n+\t\t  float_ftype_float_float, \"fmodf\", BUILTIN_CONST);\n \n   define_builtin (BUILT_IN_ACOS, \"__builtin_acos\",\n-\t\t  double_ftype_double, \"_ZN4java4lang4Math4acosEd\");\n+\t\t  double_ftype_double, \"_ZN4java4lang4Math4acosEd\",\n+\t\t  BUILTIN_CONST);\n   define_builtin (BUILT_IN_ASIN, \"__builtin_asin\",\n-\t\t  double_ftype_double, \"_ZN4java4lang4Math4asinEd\");\n+\t\t  double_ftype_double, \"_ZN4java4lang4Math4asinEd\",\n+\t\t  BUILTIN_CONST);\n   define_builtin (BUILT_IN_ATAN, \"__builtin_atan\",\n-\t\t  double_ftype_double, \"_ZN4java4lang4Math4atanEd\");\n+\t\t  double_ftype_double, \"_ZN4java4lang4Math4atanEd\",\n+\t\t  BUILTIN_CONST);\n   define_builtin (BUILT_IN_ATAN2, \"__builtin_atan2\",\n-\t\t  double_ftype_double_double, \"_ZN4java4lang4Math5atan2Edd\");\n+\t\t  double_ftype_double_double, \"_ZN4java4lang4Math5atan2Edd\",\n+\t\t  BUILTIN_CONST);\n   define_builtin (BUILT_IN_CEIL, \"__builtin_ceil\",\n-\t\t  double_ftype_double, \"_ZN4java4lang4Math4ceilEd\");\n+\t\t  double_ftype_double, \"_ZN4java4lang4Math4ceilEd\",\n+\t\t  BUILTIN_CONST);\n   define_builtin (BUILT_IN_COS, \"__builtin_cos\",\n-\t\t  double_ftype_double, \"_ZN4java4lang4Math3cosEd\");\n+\t\t  double_ftype_double, \"_ZN4java4lang4Math3cosEd\",\n+\t\t  BUILTIN_CONST);\n   define_builtin (BUILT_IN_EXP, \"__builtin_exp\",\n-\t\t  double_ftype_double, \"_ZN4java4lang4Math3expEd\");\n+\t\t  double_ftype_double, \"_ZN4java4lang4Math3expEd\",\n+\t\t  BUILTIN_CONST);\n   define_builtin (BUILT_IN_FLOOR, \"__builtin_floor\",\n-\t\t  double_ftype_double, \"_ZN4java4lang4Math5floorEd\");\n+\t\t  double_ftype_double, \"_ZN4java4lang4Math5floorEd\",\n+\t\t  BUILTIN_CONST);\n   define_builtin (BUILT_IN_LOG, \"__builtin_log\",\n-\t\t  double_ftype_double, \"_ZN4java4lang4Math3logEd\");\n+\t\t  double_ftype_double, \"_ZN4java4lang4Math3logEd\",\n+\t\t  BUILTIN_CONST);\n   define_builtin (BUILT_IN_POW, \"__builtin_pow\",\n-\t\t  double_ftype_double_double, \"_ZN4java4lang4Math3powEdd\");\n+\t\t  double_ftype_double_double, \"_ZN4java4lang4Math3powEdd\",\n+\t\t  BUILTIN_CONST);\n   define_builtin (BUILT_IN_SIN, \"__builtin_sin\",\n-\t\t  double_ftype_double, \"_ZN4java4lang4Math3sinEd\");\n+\t\t  double_ftype_double, \"_ZN4java4lang4Math3sinEd\",\n+\t\t  BUILTIN_CONST);\n   define_builtin (BUILT_IN_SQRT, \"__builtin_sqrt\",\n-\t\t  double_ftype_double, \"_ZN4java4lang4Math4sqrtEd\");\n+\t\t  double_ftype_double, \"_ZN4java4lang4Math4sqrtEd\",\n+\t\t  BUILTIN_CONST);\n   define_builtin (BUILT_IN_TAN, \"__builtin_tan\",\n-\t\t  double_ftype_double, \"_ZN4java4lang4Math3tanEd\");\n+\t\t  double_ftype_double, \"_ZN4java4lang4Math3tanEd\",\n+\t\t  BUILTIN_CONST);\n   \n   t = tree_cons (NULL_TREE, boolean_type_node, end_params_node);\n   t = tree_cons (NULL_TREE, boolean_type_node, t);\n   boolean_ftype_boolean_boolean = build_function_type (boolean_type_node, t);\n   define_builtin (BUILT_IN_EXPECT, \"__builtin_expect\", \n \t\t  boolean_ftype_boolean_boolean,\n-\t\t  \"__builtin_expect\");\n+\t\t  \"__builtin_expect\",\n+\t\t  BUILTIN_CONST | BUILTIN_NOTHROW);\n \t\t  \n   build_common_builtin_nodes ();\n }"}]}