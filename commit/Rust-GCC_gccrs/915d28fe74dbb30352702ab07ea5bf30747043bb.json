{"sha": "915d28fe74dbb30352702ab07ea5bf30747043bb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTE1ZDI4ZmU3NGRiYjMwMzUyNzAyYWIwN2VhNWJmMzA3NDcwNDNiYg==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2019-08-07T18:37:21Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2019-08-07T18:37:21Z"}, "message": "[AArch64] Reorganise aarch64-sve.md\n\naarch64-sve.md was getting a bit jumbled, with related operations\nseparated by unrelated operations.  Also, many SVE instructions need\nto have several patterns due to the various ways in which predication\ncan be used, and it was getting hard to tell which instructions had a\ncomplete set of patterns.\n\nThis patch therefore tries to use an explicit grouping scheme.\nBanner comments are usually frowned on, but md files have been\na traditional exception (e.g. when using Mike's template for\nnew targets).\n\nThe patch also lists the instructions implemented by each section,\nso that it's possible to search the file by instruction mnemonic.\n\nI wouldn't be surprised if I end up having to rip out the contents\nsection, but I found it useful for the month or so that that I've\nbeen using it locally.  The patch checks that the contents remain\nup-to-date by running a checking script during an early stage of\nthe build.\n\nNo functional change intended.\n\n2019-08-07  Richard Sandiford  <richard.sandiford@arm.com>\n\ngcc/\n\t* config/aarch64/aarch64-sve.md: Reorganize contents and add\n\tbanner comments.\n\t* config/aarch64/check-sve-md.awk: New file.\n\t* config/aarch64/t-aarch64 (s-check-sve-md): New rule.\n\t(insn-conditions.md): Depend on it.\n\nFrom-SVN: r274184", "tree": {"sha": "7cca074f1dbc49e60b143875574a67c89ccbad67", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7cca074f1dbc49e60b143875574a67c89ccbad67"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/915d28fe74dbb30352702ab07ea5bf30747043bb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/915d28fe74dbb30352702ab07ea5bf30747043bb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/915d28fe74dbb30352702ab07ea5bf30747043bb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/915d28fe74dbb30352702ab07ea5bf30747043bb/comments", "author": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e3b4d9d7021e78a85b4627b67c89acb1515ae426", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e3b4d9d7021e78a85b4627b67c89acb1515ae426", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e3b4d9d7021e78a85b4627b67c89acb1515ae426"}], "stats": {"total": 4967, "additions": 2978, "deletions": 1989}, "files": [{"sha": "4328352cb9a0e8b5ca2bfb26ac186ed5d8b40f04", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/915d28fe74dbb30352702ab07ea5bf30747043bb/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/915d28fe74dbb30352702ab07ea5bf30747043bb/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=915d28fe74dbb30352702ab07ea5bf30747043bb", "patch": "@@ -1,3 +1,11 @@\n+2019-08-07  Richard Sandiford  <richard.sandiford@arm.com>\n+\n+\t* config/aarch64/aarch64-sve.md: Reorganize contents and add\n+\tbanner comments.\n+\t* config/aarch64/check-sve-md.awk: New file.\n+\t* config/aarch64/t-aarch64 (s-check-sve-md): New rule.\n+\t(insn-conditions.md): Depend on it.\n+\n 2019-08-07  Uro\u0161 Bizjak  <ubizjak@gmail.com>\n \n \tPR target/91385"}, {"sha": "b66066becb6fe15600640af36fa7c4da0440d06c", "filename": "gcc/config/aarch64/aarch64-sve.md", "status": "modified", "additions": 2897, "deletions": 1989, "changes": 4886, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/915d28fe74dbb30352702ab07ea5bf30747043bb/gcc%2Fconfig%2Faarch64%2Faarch64-sve.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/915d28fe74dbb30352702ab07ea5bf30747043bb/gcc%2Fconfig%2Faarch64%2Faarch64-sve.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64-sve.md?ref=915d28fe74dbb30352702ab07ea5bf30747043bb"}, {"sha": "3da78f3dd1bc553a078df0c818662cc56e3a9df0", "filename": "gcc/config/aarch64/check-sve-md.awk", "status": "added", "additions": 66, "deletions": 0, "changes": 66, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/915d28fe74dbb30352702ab07ea5bf30747043bb/gcc%2Fconfig%2Faarch64%2Fcheck-sve-md.awk", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/915d28fe74dbb30352702ab07ea5bf30747043bb/gcc%2Fconfig%2Faarch64%2Fcheck-sve-md.awk", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Fcheck-sve-md.awk?ref=915d28fe74dbb30352702ab07ea5bf30747043bb", "patch": "@@ -0,0 +1,66 @@\n+#!/usr/bin/awk -f\n+# Copyright (C) 2019 Free Software Foundation, Inc.\n+#\n+# This program is free software; you can redistribute it and/or modify it\n+# under the terms of the GNU General Public License as published by the\n+# Free Software Foundation; either version 3, or (at your option) any\n+# later version.\n+#\n+# This program is distributed in the hope that it will be useful,\n+# but WITHOUT ANY WARRANTY; without even the implied warranty of\n+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+# GNU General Public License for more details.\n+#\n+# You should have received a copy of the GNU General Public License\n+# along with this program; see the file COPYING3.  If not see\n+# <http://www.gnu.org/licenses/>.\n+\n+# This awk script checks that aarch64-sve.md (passed either on the\n+# command line or via stdin) has an up-to-date contents section.\n+\n+BEGIN {\n+  seen1 = 0\n+  seen2 = 0\n+  errors = 0\n+}\n+\n+# The headings in the comments use a two-level hierarchy: \";; == ...\"\n+# for major sections and \";; ---- ...\" for minor sections.  Each section\n+# heading must be unique.\n+#\n+# The contents section should list all the section headings, using the\n+# same text and in the same order.  We should therefore see exactly two\n+# copies of the section list.\n+/^;; == / || /^;; ---- / {\n+  if ($0 in seen || seen2 > 0)\n+    {\n+      if (seen2 >= seen1)\n+\t{\n+\t  printf \"error: line not in contents: %s\\n\", $0 > \"/dev/stderr\"\n+\t  errors += 1\n+\t  exit(1)\n+\t}\n+      if ($0 != order[seen2])\n+\t{\n+\t  printf \"error: mismatched contents\\n     saw: %s\\nexpected: %s\\n\", \\\n+\t    $0, order[seen2] > \"/dev/stderr\"\n+\t  errors += 1\n+\t  exit(1)\n+\t}\n+      seen2 += 1\n+    }\n+  else\n+    {\n+      seen[$0] = 1\n+      order[seen1] = $0\n+      seen1 += 1\n+    }\n+}\n+\n+END {\n+  if (seen2 < seen1 && errors == 0)\n+    {\n+      printf \"error: line only in contents: %s\\n\", order[seen2] > \"/dev/stderr\"\n+      exit(1)\n+    }\n+}"}, {"sha": "391b4a2f7fced9c9b19a8377cd050bee91e452a3", "filename": "gcc/config/aarch64/t-aarch64", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/915d28fe74dbb30352702ab07ea5bf30747043bb/gcc%2Fconfig%2Faarch64%2Ft-aarch64", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/915d28fe74dbb30352702ab07ea5bf30747043bb/gcc%2Fconfig%2Faarch64%2Ft-aarch64", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Ft-aarch64?ref=915d28fe74dbb30352702ab07ea5bf30747043bb", "patch": "@@ -103,3 +103,10 @@ aarch64-bti-insert.o: $(srcdir)/config/aarch64/aarch64-bti-insert.c \\\n comma=,\n MULTILIB_OPTIONS    = $(subst $(comma),/, $(patsubst %, mabi=%, $(subst $(comma),$(comma)mabi=,$(TM_MULTILIB_CONFIG))))\n MULTILIB_DIRNAMES   = $(subst $(comma), ,$(TM_MULTILIB_CONFIG))\n+\n+insn-conditions.md: s-check-sve-md\n+s-check-sve-md: $(srcdir)/config/aarch64/check-sve-md.awk \\\n+\t\t$(srcdir)/config/aarch64/aarch64-sve.md\n+\t$(AWK) -f $(srcdir)/config/aarch64/check-sve-md.awk \\\n+\t  $(srcdir)/config/aarch64/aarch64-sve.md\n+\t$(STAMP) s-check-sve-md"}]}