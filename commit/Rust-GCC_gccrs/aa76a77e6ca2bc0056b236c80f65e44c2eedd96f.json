{"sha": "aa76a77e6ca2bc0056b236c80f65e44c2eedd96f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWE3NmE3N2U2Y2EyYmMwMDU2YjIzNmM4MGY2NWU0NGMyZWVkZDk2Zg==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-09-12T22:30:06Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-09-12T22:30:06Z"}, "message": "Remove fix_argv kludge.\n\nFrom-SVN: r10340", "tree": {"sha": "b3d891e16bdca33f2eb4dc118052844cb7a08f1f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b3d891e16bdca33f2eb4dc118052844cb7a08f1f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/aa76a77e6ca2bc0056b236c80f65e44c2eedd96f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa76a77e6ca2bc0056b236c80f65e44c2eedd96f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aa76a77e6ca2bc0056b236c80f65e44c2eedd96f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa76a77e6ca2bc0056b236c80f65e44c2eedd96f/comments", "author": null, "committer": null, "parents": [{"sha": "cf601f01c1192813a04d883e60f99215237adcdf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cf601f01c1192813a04d883e60f99215237adcdf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cf601f01c1192813a04d883e60f99215237adcdf"}], "stats": {"total": 60, "additions": 14, "deletions": 46}, "files": [{"sha": "7622771d8ff1a5e72170b37687c8e1fc2385d582", "filename": "gcc/gcc.c", "status": "modified", "additions": 14, "deletions": 46, "changes": 60, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa76a77e6ca2bc0056b236c80f65e44c2eedd96f/gcc%2Fgcc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa76a77e6ca2bc0056b236c80f65e44c2eedd96f/gcc%2Fgcc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcc.c?ref=aa76a77e6ca2bc0056b236c80f65e44c2eedd96f", "patch": "@@ -41,6 +41,8 @@ compilation is specified by a string called a \"spec\".  */\n #include <sys/file.h>   /* May get R_OK, etc. on some systems.  */\n #else\n #include <process.h>\n+int __spawnv ();\n+int __spawnvp ();\n #endif\n \n #include \"config.h\"\n@@ -2112,54 +2114,20 @@ pexecute (search_flag, program, argv, not_last)\n \n #endif /* not __MSDOS__ and not OS2 and not _WIN32 */\n \n-#if defined(OS2) || defined(_WIN32)\n+#if defined(OS2)\n \n-#ifdef _WIN32\n-\n-/* This is a kludge to get around the Microsoft C spawn functions' propensity\n-   to remove the outermost set of double quotes from all arguments.  */\n-\n-const char * const\n-fix_argv (argvec)\n-     char **argvec;\n+static int\n+pexecute (search_flag, program, argv, not_last)\n+     int search_flag;\n+     char *program;\n+     char *argv[];\n+     int not_last;\n {\n-  int i;\n-\n-  for (i = 1; argvec[i] != 0; i++)\n-    {\n-      int len, j;\n-      char *temp, *newtemp;\n-\n-      temp = argvec[i];\n-      len = strlen (temp);\n-      for (j = 0; j < len; j++)\n-        {\n-          if (temp[j] == '\"')\n-            {\n-              newtemp = xmalloc (len + 2);\n-              strncpy (newtemp, temp, j);\n-              newtemp [j] = '\\\\';\n-              strncpy (&newtemp [j+1], &temp [j], len-j);\n-              newtemp [len+1] = 0;\n-              temp = newtemp;\n-              len++;\n-              j++;\n-            }\n-        }\n-\n-        argvec[i] = temp;\n-      }\n-\n-  return (const char* const*) argvec;\n+  return (search_flag ? spawnv : spawnvp) (1, program, argv);\n }\n+#endif /* OS2 */\n \n-#define FIX_ARGV(a) fix_argv(a)\n-\n-#else\n-\n-#define FIX_ARGV(a) a\n-\n-#endif\n+#if defined(_WIN32)\n \n static int\n pexecute (search_flag, program, argv, not_last)\n@@ -2168,9 +2136,9 @@ pexecute (search_flag, program, argv, not_last)\n      char *argv[];\n      int not_last;\n {\n-  return (search_flag ? spawnv : spawnvp) (1, program, FIX_ARGV (argv));\n+  return (search_flag ? __spawnv : __spawnvp) (1, program, argv);\n }\n-#endif /* OS2 or _WIN32 */\n+#endif /* _WIN32 */\n \n \f\n /* Execute the command specified by the arguments on the current line of spec."}]}