{"sha": "c618c6ec7e797b5aa69218b86cd643bb65c0c48a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzYxOGM2ZWM3ZTc5N2I1YWE2OTIxOGI4NmNkNjQzYmI2NWMwYzQ4YQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2004-07-08T15:58:22Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2004-07-08T15:58:22Z"}, "message": "[multiple changes]\n\n2004-07-08  Paolo Bonzini  <bonzini@gnu.org>\n            Jakub Jelinek  <jakub@redhat.com>\n\n\t* config/i386/i386.c (override_options): Enable\n\tSSE prefetches with -mtune, as long as we are\n\tcompiling for i686 or higher.  All i686 processors\n\taccept SSE prefetches as NOPS, some i586's don't.\n\n2004-07-08  Jakub Jelinek  <jakub@redhat.com>\n\n\t* gcc.mist-tests/i386-prefetch.exp (PREFETCH_SSE): Change all\n\t-march=i386 into -march=i686.  Add -march=i686 -mtune=x and\n\t-march=x for pentium3, pentium3m, pentium-m, pentium4m,\n\tprescott and c3-2.\n\t(PREFETCH_3DNOW): Add -march=c3.\n\nFrom-SVN: r84297", "tree": {"sha": "ceb3967dbf08a732475f57723332634514a7ec6a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ceb3967dbf08a732475f57723332634514a7ec6a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c618c6ec7e797b5aa69218b86cd643bb65c0c48a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c618c6ec7e797b5aa69218b86cd643bb65c0c48a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c618c6ec7e797b5aa69218b86cd643bb65c0c48a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c618c6ec7e797b5aa69218b86cd643bb65c0c48a/comments", "author": null, "committer": null, "parents": [{"sha": "75f29cdded521da42f6b3a8d790371203d833664", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75f29cdded521da42f6b3a8d790371203d833664", "html_url": "https://github.com/Rust-GCC/gccrs/commit/75f29cdded521da42f6b3a8d790371203d833664"}], "stats": {"total": 47, "additions": 41, "deletions": 6}, "files": [{"sha": "ec20053acc912a08bbedf3769ef8ea921b03646d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c618c6ec7e797b5aa69218b86cd643bb65c0c48a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c618c6ec7e797b5aa69218b86cd643bb65c0c48a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c618c6ec7e797b5aa69218b86cd643bb65c0c48a", "patch": "@@ -1,3 +1,11 @@\n+2004-07-08  Paolo Bonzini  <bonzini@gnu.org>\n+            Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* config/i386/i386.c (override_options): Enable\n+\tSSE prefetches with -mtune, as long as we are\n+\tcompiling for i686 or higher.  All i686 processors\n+\taccept SSE prefetches as NOPS, some i586's don't.\n+\n 2004-07-08  Eric Botcazou  <ebotcazou@libertysurf.fr>\n \n \tPR target/10567"}, {"sha": "b468e1d0250908db3411cf981f4e238310924991", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c618c6ec7e797b5aa69218b86cd643bb65c0c48a/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c618c6ec7e797b5aa69218b86cd643bb65c0c48a/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=c618c6ec7e797b5aa69218b86cd643bb65c0c48a", "patch": "@@ -1306,6 +1306,14 @@ override_options (void)\n \tix86_tune = processor_alias_table[i].processor;\n \tif (TARGET_64BIT && !(processor_alias_table[i].flags & PTA_64BIT))\n \t  error (\"CPU you selected does not support x86-64 instruction set\");\n+\n+        /* Intel CPUs have always interpreted SSE prefetch instructions as\n+\t   NOPs; so, we can enable SSE prefetch instructions even when\n+\t   -mtune (rather than -march) points us to a processor that has them.\n+\t   However, the VIA C3 gives a SIGILL, so we only do that for i686 and\n+\t   higher processors.  */\n+\tif (TARGET_CMOVE && (processor_alias_table[i].flags & PTA_PREFETCH_SSE))\n+\t  x86_prefetch_sse = true;\n \tbreak;\n       }\n   if (i == pta_size)"}, {"sha": "827198dd93604ec27bc7bbe3c22dc5f2e33e2c1a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c618c6ec7e797b5aa69218b86cd643bb65c0c48a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c618c6ec7e797b5aa69218b86cd643bb65c0c48a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c618c6ec7e797b5aa69218b86cd643bb65c0c48a", "patch": "@@ -1,3 +1,11 @@\n+2004-07-08  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* gcc.mist-tests/i386-prefetch.exp (PREFETCH_SSE): Change all\n+\t-march=i386 into -march=i686.  Add -march=i686 -mtune=x and\n+\t-march=x for pentium3, pentium3m, pentium-m, pentium4m,\n+\tprescott and c3-2.\n+\t(PREFETCH_3DNOW): Add -march=c3.\n+\n 2004-07-08  Diego Novillo  <dnovillo@redhat.com>\n \n \tPR c/16437"}, {"sha": "25a752a6b2c61d3eeb472f856011df6d4fd92c66", "filename": "gcc/testsuite/gcc.misc-tests/i386-prefetch.exp", "status": "modified", "additions": 17, "deletions": 6, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c618c6ec7e797b5aa69218b86cd643bb65c0c48a/gcc%2Ftestsuite%2Fgcc.misc-tests%2Fi386-prefetch.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c618c6ec7e797b5aa69218b86cd643bb65c0c48a/gcc%2Ftestsuite%2Fgcc.misc-tests%2Fi386-prefetch.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.misc-tests%2Fi386-prefetch.exp?ref=c618c6ec7e797b5aa69218b86cd643bb65c0c48a", "patch": "@@ -1,4 +1,4 @@\n-#   Copyright (C) 2002 Free Software Foundation, Inc.\n+#   Copyright (C) 2002, 2004 Free Software Foundation, Inc.\n \n # This program is free software; you can redistribute it and/or modify\n # it under the terms of the GNU General Public License as published by\n@@ -46,16 +46,27 @@ set PREFETCH_NONE [list \\\n # instructions as nops.\n \n set PREFETCH_SSE [list \\\n-\t{ -march=i386 -mtune=pentium3 } \\\n-\t{ -march=i386 -mtune=pentium4 } \\\n-\t{ -march=i386 -mtune=athlon } \\\n-\t{ -march=i386 -mtune=athlon-4 } \\\n+\t{ -march=i686 -mtune=pentium3 } \\\n+\t{ -march=i686 -mtune=pentium3m } \\\n+\t{ -march=i686 -mtune=pentium-m } \\\n+\t{ -march=i686 -mtune=pentium4 } \\\n+\t{ -march=i686 -mtune=pentium4m } \\\n+\t{ -march=i686 -mtune=prescott } \\\n+\t{ -march=i686 -mtune=athlon } \\\n+\t{ -march=i686 -mtune=athlon-4 } \\\n+\t{ -march=i686 -mtune=c3-2 } \\\n \t{ -march=pentium3 } \\\n-\t{ -march=pentium4 } ]\n+\t{ -march=pentium3m } \\\n+\t{ -march=pentium-m } \\\n+\t{ -march=pentium4 } \\\n+\t{ -march=pentium4m } \\\n+\t{ -march=prescott } \\\n+\t{ -march=c3-2 } ]\n \n # Generate 3DNow! prefetch instructions for the following.\n \n set PREFETCH_3DNOW [list \\\n+\t{ -march=c3 } \\\n \t{ -march=k6-2 } \\\n \t{ -march=k6-3 } ]\n "}]}