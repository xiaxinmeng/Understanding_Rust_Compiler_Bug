{"sha": "0a90412010e4bd535df8c35d4bce95f321ebb6be", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGE5MDQxMjAxMGU0YmQ1MzVkZjhjMzVkNGJjZTk1ZjMyMWViYjZiZQ==", "commit": {"author": {"name": "Dmitriy Anisimkov", "email": "anisimko@adacore.com", "date": "2019-07-08T08:12:51Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-07-08T08:12:51Z"}, "message": "[Ada] GNAT.Sockets: remove default level in Get/Set_Socket_Option\n\n2019-07-08  Dmitriy Anisimkov  <anisimko@adacore.com>\n\ngcc/ada/\n\n\t* libgnat/g-socket.ads, libgnat/g-socket.adb: Improve\n\tdocumentation.\n\t(Get_Socket_Option, Set_Socket_Option): Remove default value for\n\tthe Level formal.\n\nFrom-SVN: r273198", "tree": {"sha": "bac81ea8b7b0892352bb0a1af3a52b36dd9a3ea0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bac81ea8b7b0892352bb0a1af3a52b36dd9a3ea0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0a90412010e4bd535df8c35d4bce95f321ebb6be", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0a90412010e4bd535df8c35d4bce95f321ebb6be", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0a90412010e4bd535df8c35d4bce95f321ebb6be", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0a90412010e4bd535df8c35d4bce95f321ebb6be/comments", "author": {"login": "anisimkov", "id": 15864134, "node_id": "MDQ6VXNlcjE1ODY0MTM0", "avatar_url": "https://avatars.githubusercontent.com/u/15864134?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anisimkov", "html_url": "https://github.com/anisimkov", "followers_url": "https://api.github.com/users/anisimkov/followers", "following_url": "https://api.github.com/users/anisimkov/following{/other_user}", "gists_url": "https://api.github.com/users/anisimkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/anisimkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anisimkov/subscriptions", "organizations_url": "https://api.github.com/users/anisimkov/orgs", "repos_url": "https://api.github.com/users/anisimkov/repos", "events_url": "https://api.github.com/users/anisimkov/events{/privacy}", "received_events_url": "https://api.github.com/users/anisimkov/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e87f67eb5d8671bc7c98dbf10106fda34114b293", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e87f67eb5d8671bc7c98dbf10106fda34114b293", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e87f67eb5d8671bc7c98dbf10106fda34114b293"}], "stats": {"total": 144, "additions": 115, "deletions": 29}, "files": [{"sha": "b1b2e48ab544c5265db272968103d01c6fb07e96", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0a90412010e4bd535df8c35d4bce95f321ebb6be/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0a90412010e4bd535df8c35d4bce95f321ebb6be/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=0a90412010e4bd535df8c35d4bce95f321ebb6be", "patch": "@@ -1,3 +1,10 @@\n+2019-07-08  Dmitriy Anisimkov  <anisimko@adacore.com>\n+\n+\t* libgnat/g-socket.ads, libgnat/g-socket.adb: Improve\n+\tdocumentation.\n+\t(Get_Socket_Option, Set_Socket_Option): Remove default value for\n+\tthe Level formal.\n+\n 2019-07-08  Ed Schonberg  <schonberg@adacore.com>\n \n \t* sem_ch13.adb (Check_Aspect_At_End_Of_Declarations): For an"}, {"sha": "2c9b8c76afd93fce934b3ae5dd66f73024d19ee6", "filename": "gcc/ada/libgnat/g-socket.adb", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0a90412010e4bd535df8c35d4bce95f321ebb6be/gcc%2Fada%2Flibgnat%2Fg-socket.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0a90412010e4bd535df8c35d4bce95f321ebb6be/gcc%2Fada%2Flibgnat%2Fg-socket.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fg-socket.adb?ref=0a90412010e4bd535df8c35d4bce95f321ebb6be", "patch": "@@ -1369,7 +1369,7 @@ package body GNAT.Sockets is\n \n    function Get_Socket_Option\n      (Socket  : Socket_Type;\n-      Level   : Level_Type := Socket_Level;\n+      Level   : Level_Type;\n       Name    : Option_Name;\n       Optname : Interfaces.C.int := -1) return Option_Type\n    is\n@@ -2539,7 +2539,7 @@ package body GNAT.Sockets is\n \n    procedure Set_Socket_Option\n      (Socket : Socket_Type;\n-      Level  : Level_Type := Socket_Level;\n+      Level  : Level_Type;\n       Option : Option_Type)\n    is\n       use type C.unsigned;"}, {"sha": "6db3c5422a926bf1b58fe4db82502abb7225f5d7", "filename": "gcc/ada/libgnat/g-socket.ads", "status": "modified", "additions": 106, "deletions": 27, "changes": 133, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0a90412010e4bd535df8c35d4bce95f321ebb6be/gcc%2Fada%2Flibgnat%2Fg-socket.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0a90412010e4bd535df8c35d4bce95f321ebb6be/gcc%2Fada%2Flibgnat%2Fg-socket.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fg-socket.ads?ref=0a90412010e4bd535df8c35d4bce95f321ebb6be", "patch": "@@ -775,34 +775,113 @@ package GNAT.Sockets is\n       IP_Protocol_For_TCP_Level);\n \n    --  There are several options available to manipulate sockets. Each option\n-   --  has a name and several values available. Most of the time, the value is\n-   --  a boolean to enable or disable this option.\n+   --  has a name and several values available. Most of the time, the value\n+   --  is a boolean to enable or disable this option. Each socket option is\n+   --  provided with an appropriate C name taken from the sockets API comments.\n+   --  The C name can be used to find a detailed description in the OS-specific\n+   --  documentation. The options are grouped by main Level_Type value, which\n+   --  can be used together with this option in calls to the Set_Socket_Option\n+   --  and Get_Socket_Option routines. Note that some options can be used with\n+   --  more than one level.\n \n    type Option_Name is\n      (Generic_Option,\n-      Keep_Alive,          -- Enable sending of keep-alive messages\n-      Reuse_Address,       -- Allow bind to reuse local address\n-      Broadcast,           -- Enable datagram sockets to recv/send broadcasts\n-      Send_Buffer,         -- Set/get the maximum socket send buffer in bytes\n-      Receive_Buffer,      -- Set/get the maximum socket recv buffer in bytes\n-      Linger,              -- Shutdown wait for msg to be sent or timeout occur\n-      Error,               -- Get and clear the pending socket error\n-      No_Delay,            -- Do not delay send to coalesce data (TCP_NODELAY)\n-      Add_Membership_V4,   -- Join a multicast group\n-      Add_Membership_V6,   -- Idem for IPv6 socket\n-      Drop_Membership_V4,  -- Leave a multicast group\n-      Drop_Membership_V6,  -- Idem for IPv6 socket\n-      Multicast_If_V4,     -- Set default out interface for multicast packets\n-      Multicast_If_V6,     -- Idem for IPv6 socket\n-      Multicast_Loop_V4,   -- Sent multicast packets are looped to local socket\n-      Multicast_Loop_V6,   -- Idem for IPv6 socket\n-      Multicast_TTL,       -- Set the time-to-live of sent multicast packets\n-      Multicast_Hops,      -- Set the multicast hop limit for the IPv6 socket\n-      Receive_Packet_Info, -- Receive low level packet info as ancillary data\n-      Send_Timeout,        -- Set timeout value for output\n-      Receive_Timeout,     -- Set timeout value for input\n-      IPv6_Only,           -- Restricted to IPv6 communications only\n-      Busy_Polling);       -- Set busy polling mode\n+      --  Can be used to set/get any socket option via an OS-specific option\n+      --  code with an integer value.\n+\n+      ------------------\n+      -- Socket_Level --\n+      ------------------\n+\n+      Keep_Alive,      -- SO_KEEPALIVE\n+      --  Enable sending of keep-alive messages on connection-oriented sockets\n+\n+      Reuse_Address,   -- SO_REUSEADDR\n+      --  Enable binding to an address and port already in use\n+\n+      Broadcast,       -- SO_BROADCAST\n+      --  Enable sending broadcast datagrams on the socket\n+\n+      Send_Buffer,     -- SO_SNDBUF\n+      --  Set/get the maximum socket send buffer in bytes\n+\n+      Receive_Buffer,  -- SO_RCVBUF\n+      --  Set/get the maximum socket receive buffer in bytes\n+\n+      Linger,          -- SO_LINGER\n+      --  When enabled, a Close_Socket or Shutdown_Socket will wait until all\n+      --  queued messages for the socket have been successfully sent or the\n+      --  linger timeout has been reached.\n+\n+      Error,           -- SO_ERROR\n+      --  Get and clear the pending socket error integer code\n+\n+      Send_Timeout,    -- SO_SNDTIMEO\n+      --  Specify sending timeout until reporting an error\n+\n+      Receive_Timeout, -- SO_RCVTIMEO\n+      --  Specify receiving timeout until reporting an error\n+\n+      Busy_Polling,    -- SO_BUSY_POLL\n+      --  Sets the approximate time in microseconds to busy poll on a blocking\n+      --  receive when there is no data.\n+\n+      -------------------------------\n+      -- IP_Protocol_For_TCP_Level --\n+      -------------------------------\n+\n+      No_Delay, -- TCP_NODELAY\n+      --  Disable the Nagle algorithm. This means that output buffer content\n+      --  is always sent as soon as possible, even if there is only a small\n+      --  amount of data.\n+\n+      ------------------------------\n+      -- IP_Protocol_For_IP_Level --\n+      ------------------------------\n+\n+      Add_Membership_V4,   -- IP_ADD_MEMBERSHIP\n+      --  Join a multicast group\n+\n+      Drop_Membership_V4,  -- IP_DROP_MEMBERSHIP\n+      --  Leave a multicast group\n+\n+      Multicast_If_V4,     -- IP_MULTICAST_IF\n+      --  Set/Get outgoing interface for sending multicast packets\n+\n+      Multicast_Loop_V4,   -- IP_MULTICAST_LOOP\n+      --  This boolean option determines whether sent multicast packets should\n+      --  be looped back to the local sockets.\n+\n+      Multicast_TTL,       -- IP_MULTICAST_TTL\n+      --  Set/Get the time-to-live of sent multicast packets\n+\n+      Receive_Packet_Info, -- IP_PKTINFO\n+      --  Receive low-level packet info as ancillary data\n+\n+      --------------------------------\n+      -- IP_Protocol_For_IPv6_Level --\n+      --------------------------------\n+\n+      Add_Membership_V6,   -- IPV6_ADD_MEMBERSHIP\n+      --  Join IPv6 multicast group\n+\n+      Drop_Membership_V6,  -- IPV6_DROP_MEMBERSHIP\n+      --  Leave IPv6 multicast group\n+\n+      Multicast_If_V6,     -- IPV6_MULTICAST_IF\n+      --  Set/Get outgoing interface index for sending multicast packets\n+\n+      Multicast_Loop_V6,   -- IPV6_MULTICAST_LOOP\n+      --  This boolean option determines whether sent multicast IPv6 packets\n+      --  should be looped back to the local sockets.\n+\n+      IPv6_Only,           -- IPV6_V6ONLY\n+      --  Restricted to IPv6 communications only\n+\n+      Multicast_Hops       -- IPV6_MULTICAST_HOPS\n+      --  Set the multicast hop limit for the IPv6 socket\n+     );\n+\n    subtype Specific_Option_Name is\n      Option_Name range Keep_Alive .. Option_Name'Last;\n \n@@ -1084,7 +1163,7 @@ package GNAT.Sockets is\n \n    function Get_Socket_Option\n      (Socket  : Socket_Type;\n-      Level   : Level_Type := Socket_Level;\n+      Level   : Level_Type;\n       Name    : Option_Name;\n       Optname : Interfaces.C.int := -1) return Option_Type;\n    --  Get the options associated with a socket. Raises Socket_Error on error.\n@@ -1199,7 +1278,7 @@ package GNAT.Sockets is\n \n    procedure Set_Socket_Option\n      (Socket : Socket_Type;\n-      Level  : Level_Type := Socket_Level;\n+      Level  : Level_Type;\n       Option : Option_Type);\n    --  Manipulate socket options. Raises Socket_Error on error\n "}]}