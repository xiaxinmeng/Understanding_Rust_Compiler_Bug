{"sha": "a7812c0b0067e549fb8096d265561294adcaf24a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTc4MTJjMGIwMDY3ZTU0OWZiODA5NmQyNjU1NjEyOTRhZGNhZjI0YQ==", "commit": {"author": {"name": "Kazu Hirata", "email": "kazu@hxi.com", "date": "2001-10-26T21:08:47Z"}, "committer": {"name": "Kazu Hirata", "email": "kazu@gcc.gnu.org", "date": "2001-10-26T21:08:47Z"}, "message": "* config/h8300/h8300.c (get_shift_alg): Remove redundant code.\n\nFrom-SVN: r46560", "tree": {"sha": "ab3eec2549480c58c3489e32d06fb9fe879a97f4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ab3eec2549480c58c3489e32d06fb9fe879a97f4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a7812c0b0067e549fb8096d265561294adcaf24a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7812c0b0067e549fb8096d265561294adcaf24a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a7812c0b0067e549fb8096d265561294adcaf24a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7812c0b0067e549fb8096d265561294adcaf24a/comments", "author": null, "committer": null, "parents": [{"sha": "a38b987a8968704c43fa8ca205e6d3d6831ab464", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a38b987a8968704c43fa8ca205e6d3d6831ab464", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a38b987a8968704c43fa8ca205e6d3d6831ab464"}], "stats": {"total": 202, "additions": 25, "deletions": 177}, "files": [{"sha": "3ae47434d0fc2d54ee138dfa3c983871741ee843", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7812c0b0067e549fb8096d265561294adcaf24a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7812c0b0067e549fb8096d265561294adcaf24a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a7812c0b0067e549fb8096d265561294adcaf24a", "patch": "@@ -1,3 +1,7 @@\n+2001-10-26  Kazu Hirata  <kazu@hxi.com>\n+\n+\t* config/h8300/h8300.c (get_shift_alg): Remove redundant code.\n+\n 2001-10-26  Neil Booth  <neil@daikokuya.demon.co.uk>\n \n \t* c-typeck.c (convert_arguments): When comparing for enumeral"}, {"sha": "c713f522782aa8a5d481b0f0ac1efedf83533648", "filename": "gcc/config/h8300/h8300.c", "status": "modified", "additions": 21, "deletions": 177, "changes": 198, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7812c0b0067e549fb8096d265561294adcaf24a/gcc%2Fconfig%2Fh8300%2Fh8300.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7812c0b0067e549fb8096d265561294adcaf24a/gcc%2Fconfig%2Fh8300%2Fh8300.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fh8300%2Fh8300.c?ref=a7812c0b0067e549fb8096d265561294adcaf24a", "patch": "@@ -2280,117 +2280,29 @@ get_shift_alg (shift_type, shift_mode, count, info)\n \t      goto return_shift_special;\n \t    }\n \t}\n-      else if (count == 8)\n+      else if (8 <= count && count <= 12)\n \t{\n+\t  info->remainder = count - 8;\n+\n \t  switch (shift_type)\n \t    {\n \t    case SHIFT_ASHIFT:\n \t      info->special = \"mov.b\\t%s0,%t0\\n\\tsub.b\\t%s0,%s0\";\n+\t      info->shift1  = \"shal.b\\t%t0\";\n+\t      info->shift2  = \"shal.b\\t#2,%t0\";\n \t      goto return_shift_special;\n \t    case SHIFT_LSHIFTRT:\n \t      info->special = \"mov.b\\t%t0,%s0\\n\\tsub.b\\t%t0,%t0\";\n+\t      info->shift1  = \"shlr.b\\t%s0\";\n+\t      info->shift2  = \"shlr.b\\t#2,%s0\";\n \t      goto return_shift_special;\n \t    case SHIFT_ASHIFTRT:\n \t      if (TARGET_H8300)\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\tshll\\t%t0\\n\\tsubx\\t%t0,%t0\";\n+\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\tbld\\t#7,%s0\\n\\tsubx\\t%t0,%t0\";\n \t      else\n \t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\texts.w\\t%T0\";\n-\t      goto return_shift_special;\n-\t    }\n-\t}\n-      else if (count == 9)\n-\t{\n-\t  switch (shift_type)\n-\t    {\n-\t    case SHIFT_ASHIFT:\n-\t      info->special = \"mov.b\\t%s0,%t0\\n\\tsub.b\\t%s0,%s0\\n\\tshal.b\\t%t0\";\n-\t      goto return_shift_special;\n-\t    case SHIFT_LSHIFTRT:\n-\t      info->special = \"mov.b\\t%t0,%s0\\n\\tsub.b\\t%t0,%t0\\n\\tshlr.b\\t%s0\";\n-\t      goto return_shift_special;\n-\t    case SHIFT_ASHIFTRT:\n-\t      if (TARGET_H8300)\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\tbld\\t#7,%s0\\n\\tsubx\\t%t0,%t0\\n\\tshar.b\\t%s0\";\n-\t      else\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\texts.w\\t%T0\\n\\tshar.b\\t%s0\";\n-\t      goto return_shift_special;\n-\t    }\n-\t}\n-      else if (count == 10)\n-\t{\n-\t  switch (shift_type)\n-\t    {\n-\t    case SHIFT_ASHIFT:\n-\t      if (TARGET_H8300S)\n-\t\tinfo->special = \"mov.b\\t%s0,%t0\\n\\tsub.b\\t%s0,%s0\\n\\tshal.b\\t#2,%t0\";\n-\t      else\n-\t\tinfo->special = \"mov.b\\t%s0,%t0\\n\\tsub.b\\t%s0,%s0\\n\\tshal.b\\t%t0\\n\\tshal.b\\t%t0\";\n-\t      goto return_shift_special;\n-\t    case SHIFT_LSHIFTRT:\n-\t      if (TARGET_H8300S)\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\tsub.b\\t%t0,%t0\\n\\tshlr.b\\t#2,%s0\";\n-\t      else\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\tsub.b\\t%t0,%t0\\n\\tshlr.b\\t%s0\\n\\tshlr.b\\t%s0\";\n-\t      goto return_shift_special;\n-\t    case SHIFT_ASHIFTRT:\n-\t      if (TARGET_H8300)\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\tbld\\t#7,%s0\\n\\tsubx\\t%t0,%t0\\n\\tshar.b\\t%s0\\n\\tshar.b\\t%s0\";\n-\t      else if (TARGET_H8300H)\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\texts.w\\t%T0\\n\\tshar.b\\t%s0\\n\\tshar.b\\t%s0\";\n-\t      else if (TARGET_H8300S)\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\texts.w\\t%T0\\n\\tshar.b\\t#2,%s0\";\n-\t      goto return_shift_special;\n-\t    }\n-\t}\n-      else if (count == 11)\n-\t{\n-\t  switch (shift_type)\n-\t    {\n-\t    case SHIFT_ASHIFT:\n-\t      if (TARGET_H8300S)\n-\t\tinfo->special = \"mov.b\\t%s0,%t0\\n\\tsub.b\\t%s0,%s0\\n\\tshal.b\\t#2,%t0\\n\\tshal.b\\t%t0\";\n-\t      else\n-\t\tinfo->special = \"mov.b\\t%s0,%t0\\n\\tsub.b\\t%s0,%s0\\n\\tshal.b\\t%t0\\n\\tshal.b\\t%t0\\n\\tshal.b\\t%t0\";\n-\t      goto return_shift_special;\n-\t    case SHIFT_LSHIFTRT:\n-\t      if (TARGET_H8300S)\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\tsub.b\\t%t0,%t0\\n\\tshlr.b\\t#2,%s0\\n\\tshlr.b\\t%s0\";\n-\t      else\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\tsub.b\\t%t0,%t0\\n\\tshlr.b\\t%s0\\n\\tshlr.b\\t%s0\\n\\tshlr.b\\t%s0\";\n-\t      goto return_shift_special;\n-\t    case SHIFT_ASHIFTRT:\n-\t      if (TARGET_H8300)\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\tbld\\t#7,%s0\\n\\tsubx\\t%t0,%t0\\n\\tshar.b\\t%s0\\n\\tshar.b\\t%s0\\n\\tshar.b\\t%s0\";\n-\t      else if (TARGET_H8300H)\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\texts.w\\t%T0\\n\\tshar.b\\t%s0\\n\\tshar.b\\t%s0\\n\\tshar.b\\t%s0\";\n-\t      else if (TARGET_H8300S)\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\texts.w\\t%T0\\n\\tshar.b\\t#2,%s0\\n\\tshar.b\\t%s0\";\n-\t      goto return_shift_special;\n-\t    }\n-\t}\n-      else if (count == 12)\n-\t{\n-\t  switch (shift_type)\n-\t    {\n-\t    case SHIFT_ASHIFT:\n-\t      if (TARGET_H8300S)\n-\t\tinfo->special = \"mov.b\\t%s0,%t0\\n\\tsub.b\\t%s0,%s0\\n\\tshal.b\\t#2,%t0\\n\\tshal.b\\t#2,%t0\";\n-\t      else\n-\t\tinfo->special = \"mov.b\\t%s0,%t0\\n\\tsub.b\\t%s0,%s0\\n\\tshal.b\\t%t0\\n\\tshal.b\\t%t0\\n\\tshal.b\\t%t0\\n\\tshal.b\\t%t0\";\n-\t      goto return_shift_special;\n-\t    case SHIFT_LSHIFTRT:\n-\t      if (TARGET_H8300S)\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\tsub.b\\t%t0,%t0\\n\\tshlr.b\\t#2,%s0\\n\\tshlr.b\\t#2,%s0\";\n-\t      else\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\tsub.b\\t%t0,%t0\\n\\tshlr.b\\t%s0\\n\\tshlr.b\\t%s0\\n\\tshlr.b\\t%s0\\n\\tshlr.b\\t%s0\";\n-\t      goto return_shift_special;\n-\t    case SHIFT_ASHIFTRT:\n-\t      if (TARGET_H8300)\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\tbld\\t#7,%s0\\n\\tsubx\\t%t0,%t0\\n\\tshar.b\\t%s0\\n\\tshar.b\\t%s0\\n\\tshar.b\\t%s0\\n\\tshar.b\\t%s0\";\n-\t      else if (TARGET_H8300H)\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\texts.w\\t%T0\\n\\tshar.b\\t%s0\\n\\tshar.b\\t%s0\\n\\tshar.b\\t%s0\\n\\tshar.b\\t%s0\";\n-\t      else if (TARGET_H8300S)\n-\t\tinfo->special = \"mov.b\\t%t0,%s0\\n\\texts.w\\t%T0\\n\\tshar.b\\t#2,%s0\\n\\tshar.b\\t#2,%s0\";\n+\t      info->shift1 = \"shar.b\\t%s0\";\n+\t      info->shift2 = \"shar.b\\t#2,%s0\";\n \t      goto return_shift_special;\n \t    }\n \t}\n@@ -2446,99 +2358,31 @@ get_shift_alg (shift_type, shift_mode, count, info)\n \t      goto return_shift_special;\n \t    }\n \t}\n-      else if (count == 16)\n+      else if ((TARGET_H8300 && count == 16)\n+\t       || (TARGET_H8300H && 16 <= count && count <= 19)\n+\t       || (TARGET_H8300S && 16 <= count && count <= 20))\n \t{\n+\t  info->remainder = count - 16;\n+\n \t  switch (shift_type)\n \t    {\n \t    case SHIFT_ASHIFT:\n \t      info->special = \"mov.w\\t%f0,%e0\\n\\tsub.w\\t%f0,%f0\";\n+\t      info->shift1  = \"shll.l\\t%S0\";\n+\t      info->shift2  = \"shll.l\\t#2,%S0\";\n \t      goto return_shift_special;\n \t    case SHIFT_LSHIFTRT:\n \t      info->special = \"mov.w\\t%e0,%f0\\n\\tsub.w\\t%e0,%e0\";\n+\t      info->shift1  = \"shlr.l\\t%S0\";\n+\t      info->shift2  = \"shlr.l\\t#2,%S0\";\n \t      goto return_shift_special;\n \t    case SHIFT_ASHIFTRT:\n \t      if (TARGET_H8300)\n \t\tinfo->special = \"mov.w\\t%e0,%f0\\n\\tshll\\t%z0\\n\\tsubx\\t%z0,%z0\\n\\tmov.b\\t%z0,%y0\";\n \t      else\n \t\tinfo->special = \"mov.w\\t%e0,%f0\\n\\texts.l\\t%S0\";\n-\t      goto return_shift_special;\n-\t    }\n-\t}\n-      else if (count == 17 && !TARGET_H8300)\n-\t{\n-\t  switch (shift_type)\n-\t    {\n-\t    case SHIFT_ASHIFT:\n-\t      info->special = \"mov.w\\t%f0,%e0\\n\\tsub.w\\t%f0,%f0\\n\\tshll.l\\t%S0\";\n-\t      goto return_shift_special;\n-\t    case SHIFT_LSHIFTRT:\n-\t      info->special = \"mov.w\\t%e0,%f0\\n\\tsub.w\\t%e0,%e0\\n\\tshlr.l\\t%S0\";\n-\t      goto return_shift_special;\n-\t    case SHIFT_ASHIFTRT:\n-\t      info->special = \"mov.w\\t%e0,%f0\\n\\texts.l\\t%S0\\n\\tshar.l\\t%S0\";\n-\t      goto return_shift_special;\n-\t    }\n-\t}\n-      else if (count == 18 && !TARGET_H8300)\n-\t{\n-\t  switch (shift_type)\n-\t    {\n-\t    case SHIFT_ASHIFT:\n-\t      if (TARGET_H8300S)\n-\t\tinfo->special = \"mov.w\\t%f0,%e0\\n\\tsub.w\\t%f0,%f0\\n\\tshll.l\\t#2,%S0\";\n-\t      else\n-\t\tinfo->special = \"mov.w\\t%f0,%e0\\n\\tsub.w\\t%f0,%f0\\n\\tshll.l\\t%S0\\n\\tshll.l\\t%S0\";\n-\t      goto return_shift_special;\n-\t    case SHIFT_LSHIFTRT:\n-\t      if (TARGET_H8300S)\n-\t\tinfo->special = \"mov.w\\t%e0,%f0\\n\\tsub.w\\t%e0,%e0\\n\\tshlr.l\\t#2,%S0\";\n-\t      else\n-\t\tinfo->special = \"mov.w\\t%e0,%f0\\n\\tsub.w\\t%e0,%e0\\n\\tshlr.l\\t%S0\\n\\tshlr.l\\t%S0\";\n-\t      goto return_shift_special;\n-\t    case SHIFT_ASHIFTRT:\n-\t      if (TARGET_H8300S)\n-\t\tinfo->special = \"mov.w\\t%e0,%f0\\n\\texts.l\\t%S0\\n\\tshar.l\\t#2,%S0\";\n-\t      else\n-\t\tinfo->special = \"mov.w\\t%e0,%f0\\n\\texts.l\\t%S0\\n\\tshar.l\\t%S0\\n\\tshar.l\\t%S0\";\n-\t      goto return_shift_special;\n-\t    }\n-\t}\n-      else if (count == 19 && !TARGET_H8300)\n-\t{\n-\t  switch (shift_type)\n-\t    {\n-\t    case SHIFT_ASHIFT:\n-\t      if (TARGET_H8300S)\n-\t\tinfo->special = \"mov.w\\t%f0,%e0\\n\\tsub.w\\t%f0,%f0\\n\\tshll.l\\t#2,%S0\\n\\tshll.l\\t%S0\";\n-\t      else\n-\t\tinfo->special = \"mov.w\\t%f0,%e0\\n\\tsub.w\\t%f0,%f0\\n\\tshll.l\\t%S0\\n\\tshll.l\\t%S0\\n\\tshll.l\\t%S0\";\n-\t      goto return_shift_special;\n-\t    case SHIFT_LSHIFTRT:\n-\t      if (TARGET_H8300S)\n-\t\tinfo->special = \"mov.w\\t%e0,%f0\\n\\tsub.w\\t%e0,%e0\\n\\tshlr.l\\t#2,%S0\\n\\tshlr.l\\t%S0\";\n-\t      else\n-\t\tinfo->special = \"mov.w\\t%e0,%f0\\n\\tsub.w\\t%e0,%e0\\n\\tshlr.l\\t%S0\\n\\tshlr.l\\t%S0\\n\\tshlr.l\\t%S0\";\n-\t      goto return_shift_special;\n-\t    case SHIFT_ASHIFTRT:\n-\t      if (TARGET_H8300S)\n-\t\tinfo->special = \"mov.w\\t%e0,%f0\\n\\texts.l\\t%S0\\n\\tshar.l\\t#2,%S0\\n\\tshar.l\\t%S0\";\n-\t      else\n-\t\tinfo->special = \"mov.w\\t%e0,%f0\\n\\texts.l\\t%S0\\n\\tshar.l\\t%S0\\n\\tshar.l\\t%S0\\n\\tshar.l\\t%S0\";\n-\t      goto return_shift_special;\n-\t    }\n-\t}\n-      else if (count == 20 && TARGET_H8300S)\n-\t{\n-\t  switch (shift_type)\n-\t    {\n-\t    case SHIFT_ASHIFT:\n-\t      info->special = \"mov.w\\t%f0,%e0\\n\\tsub.w\\t%f0,%f0\\n\\tshll.l\\t#2,%S0\\n\\tshll.l\\t#2,%S0\";\n-\t      goto return_shift_special;\n-\t    case SHIFT_LSHIFTRT:\n-\t      info->special = \"mov.w\\t%e0,%f0\\n\\tsub.w\\t%e0,%e0\\n\\tshlr.l\\t#2,%S0\\n\\tshlr.l\\t#2,%S0\";\n-\t      goto return_shift_special;\n-\t    case SHIFT_ASHIFTRT:\n-\t      info->special = \"mov.w\\t%e0,%f0\\n\\texts.l\\t%S0\\n\\tshar.l\\t#2,%S0\\n\\tshar.l\\t#2,%S0\";\n+\t      info->shift1 = \"shar.l\\t%S0\";\n+\t      info->shift2 = \"shar.l\\t#2,%S0\";\n \t      goto return_shift_special;\n \t    }\n \t}"}]}