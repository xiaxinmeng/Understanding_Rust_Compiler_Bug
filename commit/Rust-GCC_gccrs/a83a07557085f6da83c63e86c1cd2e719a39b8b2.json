{"sha": "a83a07557085f6da83c63e86c1cd2e719a39b8b2", "node_id": "C_kwDOANBUbNoAKGE4M2EwNzU1NzA4NWY2ZGE4M2M2M2U4NmMxY2QyZTcxOWEzOWI4YjI", "commit": {"author": {"name": "Kwok Cheung Yeung", "email": "kcy@codesourcery.com", "date": "2020-07-28T12:41:14Z"}, "committer": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2021-11-30T11:58:45Z"}, "message": "Fix c-c++-common/goacc/routine-4.c and c-c++-common/goacc/routine-4-extern.c testcases\n\n... in preparation for checks that we're introducing for OpenACC gang\nreductions on orphan loops.\n\n\tgcc/testsuite/\n\t* c-c++-common/goacc/routine-4.c (seq, vector, worker, gang):\n\tRemove loop reductions.\n\t* c-c++-common/goacc/routine-4-extern.c (seq, vector, worker, gang):\n\tLikewise.\n\nCo-Authored-By: Thomas Schwinge <thomas@codesourcery.com>", "tree": {"sha": "970727cea62dec7396139a2c3a57e33b63f4eda5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/970727cea62dec7396139a2c3a57e33b63f4eda5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a83a07557085f6da83c63e86c1cd2e719a39b8b2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a83a07557085f6da83c63e86c1cd2e719a39b8b2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a83a07557085f6da83c63e86c1cd2e719a39b8b2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a83a07557085f6da83c63e86c1cd2e719a39b8b2/comments", "author": {"login": "k-yeung", "id": 16960193, "node_id": "MDQ6VXNlcjE2OTYwMTkz", "avatar_url": "https://avatars.githubusercontent.com/u/16960193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-yeung", "html_url": "https://github.com/k-yeung", "followers_url": "https://api.github.com/users/k-yeung/followers", "following_url": "https://api.github.com/users/k-yeung/following{/other_user}", "gists_url": "https://api.github.com/users/k-yeung/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-yeung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-yeung/subscriptions", "organizations_url": "https://api.github.com/users/k-yeung/orgs", "repos_url": "https://api.github.com/users/k-yeung/repos", "events_url": "https://api.github.com/users/k-yeung/events{/privacy}", "received_events_url": "https://api.github.com/users/k-yeung/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "92de188ea3d36ec012b6d42959d4722e42524256", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/92de188ea3d36ec012b6d42959d4722e42524256", "html_url": "https://github.com/Rust-GCC/gccrs/commit/92de188ea3d36ec012b6d42959d4722e42524256"}], "stats": {"total": 144, "additions": 64, "deletions": 80}, "files": [{"sha": "ec4475818adbaada2d68c9dee518b2d5fa292a07", "filename": "gcc/testsuite/c-c++-common/goacc/routine-4-extern.c", "status": "modified", "additions": 32, "deletions": 40, "changes": 72, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a83a07557085f6da83c63e86c1cd2e719a39b8b2/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fgoacc%2Froutine-4-extern.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a83a07557085f6da83c63e86c1cd2e719a39b8b2/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fgoacc%2Froutine-4-extern.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fgoacc%2Froutine-4-extern.c?ref=a83a07557085f6da83c63e86c1cd2e719a39b8b2", "patch": "@@ -26,23 +26,21 @@ void seq (void)\n   extern_vector ();  /* { dg-error \"routine call uses\" } */\n   extern_seq ();\n \n-  int red;\n-\n-#pragma acc loop reduction (+:red) // { dg-warning \"insufficient partitioning\" }\n+#pragma acc loop // { dg-warning \"insufficient partitioning\" }\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop gang reduction (+:red) // { dg-error \"disallowed by containing routine\" }\n+#pragma acc loop gang // { dg-error \"disallowed by containing routine\" }\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop worker reduction (+:red) // { dg-error \"disallowed by containing routine\" }\n+#pragma acc loop worker // { dg-error \"disallowed by containing routine\" }\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop vector reduction (+:red) // { dg-error \"disallowed by containing routine\" }\n+#pragma acc loop vector // { dg-error \"disallowed by containing routine\" }\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n }\n \n void vector (void)\n@@ -52,23 +50,21 @@ void vector (void)\n   extern_vector ();\n   extern_seq ();\n \n-  int red;\n-\n-#pragma acc loop reduction (+:red)\n+#pragma acc loop\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop gang reduction (+:red) // { dg-error \"disallowed by containing routine\" }\n+#pragma acc loop gang // { dg-error \"disallowed by containing routine\" }\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop worker reduction (+:red) // { dg-error \"disallowed by containing routine\" }\n+#pragma acc loop worker // { dg-error \"disallowed by containing routine\" }\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop vector reduction (+:red)\n+#pragma acc loop vector\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n }\n \n void worker (void)\n@@ -78,23 +74,21 @@ void worker (void)\n   extern_vector ();\n   extern_seq ();\n \n-  int red;\n-\n-#pragma acc loop reduction (+:red)\n+#pragma acc loop\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop gang reduction (+:red) // { dg-error \"disallowed by containing routine\" }\n+#pragma acc loop gang // { dg-error \"disallowed by containing routine\" }\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop worker reduction (+:red)\n+#pragma acc loop worker\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop vector reduction (+:red)\n+#pragma acc loop vector\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n }\n \n void gang (void)\n@@ -104,21 +98,19 @@ void gang (void)\n   extern_vector ();\n   extern_seq ();\n \n-  int red;\n-\n-#pragma acc loop reduction (+:red)\n+#pragma acc loop\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop gang reduction (+:red)\n+#pragma acc loop gang\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop worker reduction (+:red)\n+#pragma acc loop worker\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop vector reduction (+:red)\n+#pragma acc loop vector\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n }"}, {"sha": "870ff645777c682f0ac0d680649dcf8d65af228c", "filename": "gcc/testsuite/c-c++-common/goacc/routine-4.c", "status": "modified", "additions": 32, "deletions": 40, "changes": 72, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a83a07557085f6da83c63e86c1cd2e719a39b8b2/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fgoacc%2Froutine-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a83a07557085f6da83c63e86c1cd2e719a39b8b2/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fgoacc%2Froutine-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fgoacc%2Froutine-4.c?ref=a83a07557085f6da83c63e86c1cd2e719a39b8b2", "patch": "@@ -17,23 +17,21 @@ void seq (void)\n   vector ();  /* { dg-error \"routine call uses\" } */\n   seq ();\n \n-  int red;\n-\n-#pragma acc loop reduction (+:red) // { dg-warning \"insufficient partitioning\" }\n+#pragma acc loop // { dg-warning \"insufficient partitioning\" }\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop gang reduction (+:red) // { dg-error \"disallowed by containing routine\" }\n+#pragma acc loop gang // { dg-error \"disallowed by containing routine\" }\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop worker reduction (+:red) // { dg-error \"disallowed by containing routine\" }\n+#pragma acc loop worker // { dg-error \"disallowed by containing routine\" }\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop vector reduction (+:red) // { dg-error \"disallowed by containing routine\" }\n+#pragma acc loop vector // { dg-error \"disallowed by containing routine\" }\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n }\n \n void vector (void) /* { dg-message \"declared here\" \"1\" } */\n@@ -43,23 +41,21 @@ void vector (void) /* { dg-message \"declared here\" \"1\" } */\n   vector ();\n   seq ();\n \n-  int red;\n-\n-#pragma acc loop reduction (+:red)\n+#pragma acc loop \n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop gang reduction (+:red) // { dg-error \"disallowed by containing routine\" }\n+#pragma acc loop gang // { dg-error \"disallowed by containing routine\" }\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop worker reduction (+:red) // { dg-error \"disallowed by containing routine\" }\n+#pragma acc loop worker // { dg-error \"disallowed by containing routine\" }\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop vector reduction (+:red)\n+#pragma acc loop vector\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n }\n \n void worker (void) /* { dg-message \"declared here\" \"2\" } */\n@@ -69,23 +65,21 @@ void worker (void) /* { dg-message \"declared here\" \"2\" } */\n   vector ();\n   seq ();\n \n-  int red;\n-\n-#pragma acc loop reduction (+:red)\n+#pragma acc loop\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop gang reduction (+:red) // { dg-error \"disallowed by containing routine\" }\n+#pragma acc loop gang // { dg-error \"disallowed by containing routine\" }\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop worker reduction (+:red)\n+#pragma acc loop worker\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop vector reduction (+:red)\n+#pragma acc loop vector\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n }\n \n void gang (void) /* { dg-message \"declared here\" \"3\" } */\n@@ -95,21 +89,19 @@ void gang (void) /* { dg-message \"declared here\" \"3\" } */\n   vector ();\n   seq ();\n \n-  int red;\n-\n-#pragma acc loop reduction (+:red)\n+#pragma acc loop\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop gang reduction (+:red)\n+#pragma acc loop gang\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop worker reduction (+:red)\n+#pragma acc loop worker\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n \n-#pragma acc loop vector reduction (+:red)\n+#pragma acc loop vector\n   for (int i = 0; i < 10; i++)\n-    red ++;\n+    ;\n }"}]}