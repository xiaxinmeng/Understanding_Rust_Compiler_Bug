{"sha": "40541efe1c063e9ce894b5f11ff727e4aec56e8b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDA1NDFlZmUxYzA2M2U5Y2U4OTRiNWYxMWZmNzI3ZTRhZWM1NmU4Yg==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2020-04-23T20:39:33Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2020-04-23T20:39:33Z"}, "message": "libstdc++: Change __cpp_lib_array_constexpr for C++17 again\n\nThis partially reverts my previous change related to this macro. The\nC++20 constexpr iterator requirements are always met by array:iterator,\nbecause it's just a pointer. So the macro can be set to 201803 even in\nC++17 mode.\n\n\t* include/bits/stl_iterator.h (__cpp_lib_array_constexpr): Revert\n\tvalue for C++17 to 201803L because P0858R0 is supported for C++17.\n\t* include/std/version (__cpp_lib_array_constexpr): Likewise.\n\t* testsuite/23_containers/array/element_access/constexpr_c++17.cc:\n\tCheck for value corresponding to P0031R0 features being tested.\n\t* testsuite/23_containers/array/requirements/constexpr_iter.cc:\n\tCheck for value corresponding to P0858R0 features being tested.", "tree": {"sha": "45f59965e31bcc915289cb97da5aed3abb4461ca", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/45f59965e31bcc915289cb97da5aed3abb4461ca"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/40541efe1c063e9ce894b5f11ff727e4aec56e8b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40541efe1c063e9ce894b5f11ff727e4aec56e8b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/40541efe1c063e9ce894b5f11ff727e4aec56e8b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40541efe1c063e9ce894b5f11ff727e4aec56e8b/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a2dcb56c9443d1211e14889bd0c2c21360d54cdb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a2dcb56c9443d1211e14889bd0c2c21360d54cdb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a2dcb56c9443d1211e14889bd0c2c21360d54cdb"}], "stats": {"total": 21, "additions": 14, "deletions": 7}, "files": [{"sha": "7ce32b9348bce94ecd81ed018d3cbb1ceedd5a86", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40541efe1c063e9ce894b5f11ff727e4aec56e8b/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40541efe1c063e9ce894b5f11ff727e4aec56e8b/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=40541efe1c063e9ce894b5f11ff727e4aec56e8b", "patch": "@@ -1,5 +1,13 @@\n 2020-04-23  Jonathan Wakely  <jwakely@redhat.com>\n \n+\t* include/bits/stl_iterator.h (__cpp_lib_array_constexpr): Revert\n+\tvalue for C++17 to 201803L because P0858R0 is supported for C++17.\n+\t* include/std/version (__cpp_lib_array_constexpr): Likewise.\n+\t* testsuite/23_containers/array/element_access/constexpr_c++17.cc:\n+\tCheck for value corresponding to P0031R0 features being tested.\n+\t* testsuite/23_containers/array/requirements/constexpr_iter.cc:\n+\tCheck for value corresponding to P0858R0 features being tested.\n+\n \t* include/std/version (__cpp_lib_three_way_comparison): Define for\n \tfreestanding builds.\n "}, {"sha": "cc0b3e0a7668996e2dc8ab60b01211b979358ca9", "filename": "libstdc++-v3/include/bits/stl_iterator.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40541efe1c063e9ce894b5f11ff727e4aec56e8b/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_iterator.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40541efe1c063e9ce894b5f11ff727e4aec56e8b/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_iterator.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_iterator.h?ref=40541efe1c063e9ce894b5f11ff727e4aec56e8b", "patch": "@@ -72,7 +72,7 @@\n #if __cplusplus > 201703L\n # define __cpp_lib_array_constexpr 201811L\n #elif __cplusplus == 201703L\n-# define __cpp_lib_array_constexpr 201603L\n+# define __cpp_lib_array_constexpr 201803L\n #endif\n \n #if __cplusplus > 201703L"}, {"sha": "fa505f25e981d5daaf51a212e9c6cc81ea454e5e", "filename": "libstdc++-v3/include/std/version", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40541efe1c063e9ce894b5f11ff727e4aec56e8b/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fversion", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40541efe1c063e9ce894b5f11ff727e4aec56e8b/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fversion", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fversion?ref=40541efe1c063e9ce894b5f11ff727e4aec56e8b", "patch": "@@ -123,7 +123,7 @@\n #if _GLIBCXX_HOSTED\n #define __cpp_lib_any 201606L\n #define __cpp_lib_apply 201603\n-#define __cpp_lib_array_constexpr 201603L\n+#define __cpp_lib_array_constexpr 201803L\n #define __cpp_lib_as_const 201510\n #define __cpp_lib_boyer_moore_searcher 201603\n #define __cpp_lib_chrono 201611"}, {"sha": "dd69645833f6eaf7e79c9c74f4aa87d5fadbde5f", "filename": "libstdc++-v3/testsuite/23_containers/array/element_access/constexpr_c++17.cc", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40541efe1c063e9ce894b5f11ff727e4aec56e8b/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Farray%2Felement_access%2Fconstexpr_c%2B%2B17.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40541efe1c063e9ce894b5f11ff727e4aec56e8b/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Farray%2Felement_access%2Fconstexpr_c%2B%2B17.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Farray%2Felement_access%2Fconstexpr_c%2B%2B17.cc?ref=40541efe1c063e9ce894b5f11ff727e4aec56e8b", "patch": "@@ -24,8 +24,6 @@\n # error \"Feature test macro for array constexpr is missing in <array>\"\n #elif __cpp_lib_array_constexpr < 201603L\n # error \"Feature test macro for array constexpr has wrong value in <array>\"\n-#elif __cpp_lib_array_constexpr > 201603L && __cplusplus == 201703\n-# error \"Feature test macro for array constexpr has wrong value for C++17\"\n #endif\n \n constexpr std::size_t test01()"}, {"sha": "566388405b6cf1ed1604b4a15dad57a764a06393", "filename": "libstdc++-v3/testsuite/23_containers/array/requirements/constexpr_iter.cc", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40541efe1c063e9ce894b5f11ff727e4aec56e8b/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Farray%2Frequirements%2Fconstexpr_iter.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40541efe1c063e9ce894b5f11ff727e4aec56e8b/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Farray%2Frequirements%2Fconstexpr_iter.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Farray%2Frequirements%2Fconstexpr_iter.cc?ref=40541efe1c063e9ce894b5f11ff727e4aec56e8b", "patch": "@@ -22,12 +22,13 @@\n \n #ifndef __cpp_lib_array_constexpr\n # error \"Feature test macro for array constexpr is missing in <array>\"\n-#elif __cpp_lib_array_constexpr < 201603L\n+#elif __cpp_lib_array_constexpr < 201803L\n # error \"Feature test macro for array constexpr has wrong value in <array>\"\n-#elif __cpp_lib_array_constexpr > 201603L && __cplusplus == 201703\n-# error \"Feature test macro for array constexpr has wrong value for C++17\"\n #endif\n \n+// This test is compiled as C++17 because array::iterator is just a pointer,\n+// so always meets the C++20 constexpr iterator requirements, even in C++17.\n+\n constexpr int\n test()\n {"}]}