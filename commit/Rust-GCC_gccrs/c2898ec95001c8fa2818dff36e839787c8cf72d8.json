{"sha": "c2898ec95001c8fa2818dff36e839787c8cf72d8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzI4OThlYzk1MDAxYzhmYTI4MThkZmYzNmU4Mzk3ODdjOGNmNzJkOA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2008-05-23T13:21:47Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2008-05-23T13:21:47Z"}, "message": "re PR c++/36237 (internal compiler error: in lower_stmt, at gimple-low.c:282 erase 'private(localTodoStack)' it compiles successfully.)\n\n\tPR c++/36237\n\t* cp-gimplify.c (cxx_omp_clause_apply_fn): Call\n\tfold_build_cleanup_point_expr on build_call_a results.\n\n\t* g++.dg/gomp/pr36237.C: New test.\n\nFrom-SVN: r135802", "tree": {"sha": "3abe297f4f98323eef8a54697058fd644e1c0be8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3abe297f4f98323eef8a54697058fd644e1c0be8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c2898ec95001c8fa2818dff36e839787c8cf72d8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c2898ec95001c8fa2818dff36e839787c8cf72d8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c2898ec95001c8fa2818dff36e839787c8cf72d8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c2898ec95001c8fa2818dff36e839787c8cf72d8/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "cf38a465eca401054b78e6182f0dced39418554b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cf38a465eca401054b78e6182f0dced39418554b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cf38a465eca401054b78e6182f0dced39418554b"}], "stats": {"total": 48, "additions": 43, "deletions": 5}, "files": [{"sha": "b4cf3d40460229d287dba1471330bf44135ba678", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c2898ec95001c8fa2818dff36e839787c8cf72d8/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c2898ec95001c8fa2818dff36e839787c8cf72d8/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=c2898ec95001c8fa2818dff36e839787c8cf72d8", "patch": "@@ -1,5 +1,9 @@\n 2008-05-23  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR c++/36237\n+\t* cp-gimplify.c (cxx_omp_clause_apply_fn): Call\n+\tfold_build_cleanup_point_expr on build_call_a results.\n+\n \tPR c++/36308\n \t* semantics.c (omp_clause_info_fndecl): New function.\n \t(finish_omp_clauses): Use it."}, {"sha": "cc3e8479921063334ada4d34bac171f48a7dbc69", "filename": "gcc/cp/cp-gimplify.c", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c2898ec95001c8fa2818dff36e839787c8cf72d8/gcc%2Fcp%2Fcp-gimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c2898ec95001c8fa2818dff36e839787c8cf72d8/gcc%2Fcp%2Fcp-gimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-gimplify.c?ref=c2898ec95001c8fa2818dff36e839787c8cf72d8", "patch": "@@ -1,6 +1,6 @@\n /* C++-specific tree lowering bits; see also c-gimplify.c and tree-gimple.c.\n \n-   Copyright (C) 2002, 2003, 2004, 2005, 2006, 2007\n+   Copyright (C) 2002, 2003, 2004, 2005, 2006, 2007, 2008\n    Free Software Foundation, Inc.\n    Contributed by Jason Merrill <jason@redhat.com>\n \n@@ -784,7 +784,7 @@ cp_genericize (tree fndecl)\n static tree\n cxx_omp_clause_apply_fn (tree fn, tree arg1, tree arg2)\n {\n-  tree defparm, parm;\n+  tree defparm, parm, t;\n   int i = 0;\n   int nargs;\n   tree *argarray;\n@@ -804,7 +804,7 @@ cxx_omp_clause_apply_fn (tree fn, tree arg1, tree arg2)\n       tree inner_type = TREE_TYPE (arg1);\n       tree start1, end1, p1;\n       tree start2 = NULL, p2 = NULL;\n-      tree ret = NULL, lab, t;\n+      tree ret = NULL, lab;\n \n       start1 = arg1;\n       start2 = arg2;\n@@ -849,6 +849,8 @@ cxx_omp_clause_apply_fn (tree fn, tree arg1, tree arg2)\n \targarray[i] = convert_default_arg (TREE_VALUE (parm),\n \t\t\t\t\t   TREE_PURPOSE (parm), fn, i);\n       t = build_call_a (fn, i, argarray);\n+      t = fold_convert (void_type_node, t);\n+      t = fold_build_cleanup_point_expr (TREE_TYPE (t), t);\n       append_to_statement_list (t, &ret);\n \n       t = TYPE_SIZE_UNIT (inner_type);\n@@ -881,7 +883,9 @@ cxx_omp_clause_apply_fn (tree fn, tree arg1, tree arg2)\n \targarray[i] = convert_default_arg (TREE_VALUE (parm),\n \t\t\t\t\t   TREE_PURPOSE (parm),\n \t\t\t\t\t   fn, i);\n-      return build_call_a (fn, i, argarray);\n+      t = build_call_a (fn, i, argarray);\n+      t = fold_convert (void_type_node, t);\n+      return fold_build_cleanup_point_expr (TREE_TYPE (t), t);\n     }\n }\n "}, {"sha": "9397bb51472339940da167e70da6629d26045ca9", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c2898ec95001c8fa2818dff36e839787c8cf72d8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c2898ec95001c8fa2818dff36e839787c8cf72d8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c2898ec95001c8fa2818dff36e839787c8cf72d8", "patch": "@@ -1,3 +1,8 @@\n+2008-05-23  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c++/36237\n+\t* g++.dg/gomp/pr36237.C: New test.\n+\n 2008-05-23  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* gcc.dg/builtins-error.c: Test __builtin_fpclassify.  Also"}, {"sha": "29c7adc8a27d01dd6fad9df58303a1b9cd416d9c", "filename": "gcc/testsuite/g++.dg/gomp/pr36237.C", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c2898ec95001c8fa2818dff36e839787c8cf72d8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgomp%2Fpr36237.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c2898ec95001c8fa2818dff36e839787c8cf72d8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgomp%2Fpr36237.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgomp%2Fpr36237.C?ref=c2898ec95001c8fa2818dff36e839787c8cf72d8", "patch": "@@ -0,0 +1,25 @@\n+// PR c++/36237\n+// { dg-do compile }\n+// { dg-options \"-fopenmp\" }\n+\n+struct A\n+{\n+  ~A ();\n+};\n+\n+struct B\n+{\n+  B (const A &x = A ()) : a (x) { }\n+  A a;\n+};\n+\n+B var;\n+\n+void bar ();\n+\n+void\n+foo ()\n+{\n+  #pragma omp parallel private (var)\n+    bar ();\n+}"}, {"sha": "8bd53de3f23d14dc14af91ed87d5583d2154bcf6", "filename": "libgomp/testsuite/libgomp.c++/ctor-12.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c2898ec95001c8fa2818dff36e839787c8cf72d8/libgomp%2Ftestsuite%2Flibgomp.c%2B%2B%2Fctor-12.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c2898ec95001c8fa2818dff36e839787c8cf72d8/libgomp%2Ftestsuite%2Flibgomp.c%2B%2B%2Fctor-12.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c%2B%2B%2Fctor-12.C?ref=c2898ec95001c8fa2818dff36e839787c8cf72d8", "patch": "@@ -3,7 +3,7 @@\n \n extern \"C\" void abort ();\n \n-static int ctors, dtors, copyctors, n, m;\n+static int n;\n \n struct A\n {"}]}