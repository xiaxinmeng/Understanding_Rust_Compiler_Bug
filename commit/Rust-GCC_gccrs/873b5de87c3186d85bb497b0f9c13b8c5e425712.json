{"sha": "873b5de87c3186d85bb497b0f9c13b8c5e425712", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODczYjVkZTg3YzMxODZkODViYjQ5N2IwZjljMTNiOGM1ZTQyNTcxMg==", "commit": {"author": {"name": "Iain Buclaw", "email": "ibuclaw@gdcproject.org", "date": "2020-04-26T23:43:34Z"}, "committer": {"name": "Iain Buclaw", "email": "ibuclaw@gdcproject.org", "date": "2020-04-27T00:47:27Z"}, "message": "d: Merge upstream dmd f8a1a5153, druntime 2b5c0b27\n\nAdds a new test directive COMPILABLE_MATH_TEST, and support has been\nadded for it in gdc-convert-test so that they are skipped if phobos is\nnot present on the target.\n\nOnly change in D runtime is a small documentation fix.\n\nReviewed-on: https://github.com/dlang/druntime/pull/3067\n\t     https://github.com/dlang/dmd/pull/11060\n\ngcc/testsuite/ChangeLog:\n\n\tPR d/89418\n\t* lib/gdc-utils.exp (gdc-convert-test): Add dg-skip-if for compilable\n\ttests that depend on the phobos standard library.", "tree": {"sha": "4300977805be65898942d64914b121533ef97001", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4300977805be65898942d64914b121533ef97001"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/873b5de87c3186d85bb497b0f9c13b8c5e425712", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/873b5de87c3186d85bb497b0f9c13b8c5e425712", "html_url": "https://github.com/Rust-GCC/gccrs/commit/873b5de87c3186d85bb497b0f9c13b8c5e425712", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/873b5de87c3186d85bb497b0f9c13b8c5e425712/comments", "author": {"login": "ibuclaw", "id": 397929, "node_id": "MDQ6VXNlcjM5NzkyOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/397929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ibuclaw", "html_url": "https://github.com/ibuclaw", "followers_url": "https://api.github.com/users/ibuclaw/followers", "following_url": "https://api.github.com/users/ibuclaw/following{/other_user}", "gists_url": "https://api.github.com/users/ibuclaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/ibuclaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ibuclaw/subscriptions", "organizations_url": "https://api.github.com/users/ibuclaw/orgs", "repos_url": "https://api.github.com/users/ibuclaw/repos", "events_url": "https://api.github.com/users/ibuclaw/events{/privacy}", "received_events_url": "https://api.github.com/users/ibuclaw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ibuclaw", "id": 397929, "node_id": "MDQ6VXNlcjM5NzkyOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/397929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ibuclaw", "html_url": "https://github.com/ibuclaw", "followers_url": "https://api.github.com/users/ibuclaw/followers", "following_url": "https://api.github.com/users/ibuclaw/following{/other_user}", "gists_url": "https://api.github.com/users/ibuclaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/ibuclaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ibuclaw/subscriptions", "organizations_url": "https://api.github.com/users/ibuclaw/orgs", "repos_url": "https://api.github.com/users/ibuclaw/repos", "events_url": "https://api.github.com/users/ibuclaw/events{/privacy}", "received_events_url": "https://api.github.com/users/ibuclaw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2370bdbb0b29b14401d8508d846c0e01c64d82fc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2370bdbb0b29b14401d8508d846c0e01c64d82fc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2370bdbb0b29b14401d8508d846c0e01c64d82fc"}], "stats": {"total": 25, "additions": 21, "deletions": 4}, "files": [{"sha": "f933cf1c9920cd8dd63350d27488729fccbebccb", "filename": "gcc/d/dmd/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/873b5de87c3186d85bb497b0f9c13b8c5e425712/gcc%2Fd%2Fdmd%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/873b5de87c3186d85bb497b0f9c13b8c5e425712/gcc%2Fd%2Fdmd%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fd%2Fdmd%2FMERGE?ref=873b5de87c3186d85bb497b0f9c13b8c5e425712", "patch": "@@ -1,4 +1,4 @@\n-09db0c41ee922502fa0966bde24c1cb9b15ad436\n+f8a1a515346b16ebbd9da56a908540cbef1ee582\n \n The first line of this file holds the git revision number of the last\n merge done from the dlang/dmd repository."}, {"sha": "d6529ea7d1f466fccd7be661dd09bcbbe762e998", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/873b5de87c3186d85bb497b0f9c13b8c5e425712/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/873b5de87c3186d85bb497b0f9c13b8c5e425712/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=873b5de87c3186d85bb497b0f9c13b8c5e425712", "patch": "@@ -1,3 +1,9 @@\n+2020-04-27  Iain Buclaw  <ibuclaw@gdcproject.org>\n+\n+\tPR d/89418\n+\t* lib/gdc-utils.exp (gdc-convert-test): Add dg-skip-if for compilable\n+\ttests that depend on the phobos standard library.\n+\n 2020-04-27  Iain Buclaw  <ibuclaw@gdcproject.org>\n \n \tPR d/94777"}, {"sha": "334b75ac941484b96f8f48db509b002b4c555624", "filename": "gcc/testsuite/gdc.test/compilable/ctfe_math.d", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/873b5de87c3186d85bb497b0f9c13b8c5e425712/gcc%2Ftestsuite%2Fgdc.test%2Fcompilable%2Fctfe_math.d", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/873b5de87c3186d85bb497b0f9c13b8c5e425712/gcc%2Ftestsuite%2Fgdc.test%2Fcompilable%2Fctfe_math.d", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgdc.test%2Fcompilable%2Fctfe_math.d?ref=873b5de87c3186d85bb497b0f9c13b8c5e425712", "patch": "@@ -1,3 +1,4 @@\n+// COMPILABLE_MATH_TEST\n // Test CTFE builtins for std.math functions.\n \n import std.math;"}, {"sha": "63ca752f4fba8f0600422456b45c722323b72da5", "filename": "gcc/testsuite/gdc.test/compilable/test5227.d", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/873b5de87c3186d85bb497b0f9c13b8c5e425712/gcc%2Ftestsuite%2Fgdc.test%2Fcompilable%2Ftest5227.d", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/873b5de87c3186d85bb497b0f9c13b8c5e425712/gcc%2Ftestsuite%2Fgdc.test%2Fcompilable%2Ftest5227.d", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgdc.test%2Fcompilable%2Ftest5227.d?ref=873b5de87c3186d85bb497b0f9c13b8c5e425712", "patch": "@@ -1,4 +1,5 @@\n /*\n+COMPILABLE_MATH_TEST\n REQUIRED_ARGS:\n PERMUTE_ARGS:\n TEST_OUTPUT:"}, {"sha": "5c17346dbf5825090eab255053246212385387e0", "filename": "gcc/testsuite/lib/gdc-utils.exp", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/873b5de87c3186d85bb497b0f9c13b8c5e425712/gcc%2Ftestsuite%2Flib%2Fgdc-utils.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/873b5de87c3186d85bb497b0f9c13b8c5e425712/gcc%2Ftestsuite%2Flib%2Fgdc-utils.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Fgdc-utils.exp?ref=873b5de87c3186d85bb497b0f9c13b8c5e425712", "patch": "@@ -302,6 +302,12 @@ proc gdc-convert-test { base test } {\n \t    # It will need skipping if phobos is not available on the target.\n \t    regsub -- {RUNNABLE_PHOBOS_TEST.*$} $copy_line \"\" out_line\n \t    set needs_phobos 1\n+\n+\t} elseif [regexp -- {COMPILABLE_MATH_TEST} $copy_line match sources] {\n+\t    # COMPILABLE_MATH_TEST annotates tests that import the std.math\n+\t    # module.  Which will need skipping if not available on the target.\n+\t    regsub -- {RUNNABLE_PHOBOS_TEST.*$} $copy_line \"\" out_line\n+\t    set needs_phobos 1\n \t}\n \n \tputs $fdout $out_line\n@@ -358,6 +364,9 @@ proc gdc-convert-test { base test } {\n \t\t# Cleanup extra generated files.\n \t\tputs $fdout \"// { dg-final { file delete $genfile } }\"\n \t    }\n+\t    if $needs_phobos {\n+\t\tputs $fdout \"// { dg-skip-if \\\"imports phobos\\\" { ! d_runtime_has_std_library } }\"\n+\t    }\n \t}\n \n \tfail_compilation {"}, {"sha": "e3763485adfd261d9f065b34fc62a94e9af85bbc", "filename": "libphobos/libdruntime/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/873b5de87c3186d85bb497b0f9c13b8c5e425712/libphobos%2Flibdruntime%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/873b5de87c3186d85bb497b0f9c13b8c5e425712/libphobos%2Flibdruntime%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libphobos%2Flibdruntime%2FMERGE?ref=873b5de87c3186d85bb497b0f9c13b8c5e425712", "patch": "@@ -1,4 +1,4 @@\n-e68a5ae36790fa9dc5bab6155bc450eb6bf8c12c\n+2b5c0b2766949e788e4929c5fb0e2ba698ff79a3\n \n The first line of this file holds the git revision number of the last\n merge done from the dlang/druntime repository."}, {"sha": "0f540f83d4260ddce5dc709ecc2672e6fcdd70af", "filename": "libphobos/libdruntime/core/internal/convert.d", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/873b5de87c3186d85bb497b0f9c13b8c5e425712/libphobos%2Flibdruntime%2Fcore%2Finternal%2Fconvert.d", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/873b5de87c3186d85bb497b0f9c13b8c5e425712/libphobos%2Flibdruntime%2Fcore%2Finternal%2Fconvert.d", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libphobos%2Flibdruntime%2Fcore%2Finternal%2Fconvert.d?ref=873b5de87c3186d85bb497b0f9c13b8c5e425712", "patch": "@@ -73,8 +73,8 @@ const(ubyte)[] toUbyte(T)(const ref T val) if (is(Unqual!T == float) || is(Unqua\n             // Parse DoubleDoubles as a pair of doubles.\n             // The layout of the type is:\n             //\n-            //   [1|  7  |       56      ][   8    |       56       ]\n-            //   [S| Exp | Fraction (hi) ][ Unused | Fraction (low) ]\n+            //   [1|    11    |       52      ][1|    11    |       52       ]\n+            //   [S| Exponent | Fraction (hi) ][S| Exponent | Fraction (low) ]\n             //\n             // We can get the least significant bits by subtracting the IEEE\n             // double precision portion from the real value."}]}