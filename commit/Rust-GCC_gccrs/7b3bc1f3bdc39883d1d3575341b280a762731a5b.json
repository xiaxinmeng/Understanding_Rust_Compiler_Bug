{"sha": "7b3bc1f3bdc39883d1d3575341b280a762731a5b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2IzYmMxZjNiZGMzOTg4M2QxZDM1NzUzNDFiMjgwYTc2MjczMWE1Yg==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2015-07-08T10:36:26Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2015-07-08T10:36:26Z"}, "message": "re PR c++/66748 (Crash with abi_tag attribute)\n\n\tPR c++/66748\n\t* tree.c (handle_abi_tag_attribute): Check for CLASS_TYPE_P before\n\taccessing TYPE_LANG_SPECIFIC node.\n\n\t* g++.dg/abi/abi-tag15.C: New test.\n\nFrom-SVN: r225541", "tree": {"sha": "eb4298eb09493245f072bb119f21feab7fa7240b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/eb4298eb09493245f072bb119f21feab7fa7240b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7b3bc1f3bdc39883d1d3575341b280a762731a5b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7b3bc1f3bdc39883d1d3575341b280a762731a5b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7b3bc1f3bdc39883d1d3575341b280a762731a5b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7b3bc1f3bdc39883d1d3575341b280a762731a5b/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "daee9ce2953033be80e974fd467201934eb1ed01", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/daee9ce2953033be80e974fd467201934eb1ed01", "html_url": "https://github.com/Rust-GCC/gccrs/commit/daee9ce2953033be80e974fd467201934eb1ed01"}], "stats": {"total": 20, "additions": 18, "deletions": 2}, "files": [{"sha": "e469156c8ff645db0661084d6a6921d3c3511c6b", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7b3bc1f3bdc39883d1d3575341b280a762731a5b/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7b3bc1f3bdc39883d1d3575341b280a762731a5b/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=7b3bc1f3bdc39883d1d3575341b280a762731a5b", "patch": "@@ -1,3 +1,9 @@\n+2015-07-08  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c++/66748\n+\t* tree.c (handle_abi_tag_attribute): Check for CLASS_TYPE_P before\n+\taccessing TYPE_LANG_SPECIFIC node.\n+\n 2015-07-07  Andrew MacLeod  <amacleod@redhat.com>\n \n \t* call.c: Adjust includes."}, {"sha": "149c37da908c724fdec94525e55f450bea32c9a8", "filename": "gcc/cp/tree.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7b3bc1f3bdc39883d1d3575341b280a762731a5b/gcc%2Fcp%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7b3bc1f3bdc39883d1d3575341b280a762731a5b/gcc%2Fcp%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftree.c?ref=7b3bc1f3bdc39883d1d3575341b280a762731a5b", "patch": "@@ -3653,13 +3653,15 @@ handle_abi_tag_attribute (tree* node, tree name, tree args,\n \t\t name, *node);\n \t  goto fail;\n \t}\n-      else if (CLASSTYPE_TEMPLATE_INSTANTIATION (*node))\n+      else if (CLASS_TYPE_P (*node)\n+\t       && CLASSTYPE_TEMPLATE_INSTANTIATION (*node))\n \t{\n \t  warning (OPT_Wattributes, \"ignoring %qE attribute applied to \"\n \t\t   \"template instantiation %qT\", name, *node);\n \t  goto fail;\n \t}\n-      else if (CLASSTYPE_TEMPLATE_SPECIALIZATION (*node))\n+      else if (CLASS_TYPE_P (*node)\n+\t       && CLASSTYPE_TEMPLATE_SPECIALIZATION (*node))\n \t{\n \t  warning (OPT_Wattributes, \"ignoring %qE attribute applied to \"\n \t\t   \"template specialization %qT\", name, *node);"}, {"sha": "7370e8fe3dbf3a4fc1d455c7d74a6f3e2f9bc0d4", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7b3bc1f3bdc39883d1d3575341b280a762731a5b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7b3bc1f3bdc39883d1d3575341b280a762731a5b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7b3bc1f3bdc39883d1d3575341b280a762731a5b", "patch": "@@ -1,3 +1,8 @@\n+2015-07-08  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c++/66748\n+\t* g++.dg/abi/abi-tag15.C: New test.\n+\n 2015-07-08  Andrew Bennett  <andrew.bennett@imgtec.com>\n \n \t* gcc.target/mips/branch-2.c: Change NOMIPS16 to NOCOMPRESSION."}, {"sha": "bfda3a279ef09bc7835bbebf7ee490a7122e9438", "filename": "gcc/testsuite/g++.dg/abi/abi-tag15.C", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7b3bc1f3bdc39883d1d3575341b280a762731a5b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fabi%2Fabi-tag15.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7b3bc1f3bdc39883d1d3575341b280a762731a5b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fabi%2Fabi-tag15.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fabi%2Fabi-tag15.C?ref=7b3bc1f3bdc39883d1d3575341b280a762731a5b", "patch": "@@ -0,0 +1,3 @@\n+// PR c++/66748\n+\n+enum __attribute__((abi_tag(\"foo\"))) E {}; // { dg-error \"redeclaration of\" }"}]}