{"sha": "1eb4d0d3bad1a7faa7f1734837562aea71575740", "node_id": "C_kwDOANBUbNoAKDFlYjRkMGQzYmFkMWE3ZmFhN2YxNzM0ODM3NTYyYWVhNzE1NzU3NDA", "commit": {"author": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2021-09-24T13:51:29Z"}, "committer": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2021-09-24T13:51:29Z"}, "message": "Try again for docker image build workflow", "tree": {"sha": "8e381c83ff80e9b9c0affb093cbbfab81ecbbedc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8e381c83ff80e9b9c0affb093cbbfab81ecbbedc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1eb4d0d3bad1a7faa7f1734837562aea71575740", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1eb4d0d3bad1a7faa7f1734837562aea71575740", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1eb4d0d3bad1a7faa7f1734837562aea71575740", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1eb4d0d3bad1a7faa7f1734837562aea71575740/comments", "author": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "committer": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "faafe0fb1183baa12fec2d1fde4f81b625a2c554", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/faafe0fb1183baa12fec2d1fde4f81b625a2c554", "html_url": "https://github.com/Rust-GCC/gccrs/commit/faafe0fb1183baa12fec2d1fde4f81b625a2c554"}], "stats": {"total": 41, "additions": 24, "deletions": 17}, "files": [{"sha": "24ed1b7ae8d9634038c81e11079bd79538966b7f", "filename": ".github/workflows/docker.yml", "status": "modified", "additions": 24, "deletions": 17, "changes": 41, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1eb4d0d3bad1a7faa7f1734837562aea71575740/.github%2Fworkflows%2Fdocker.yml", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1eb4d0d3bad1a7faa7f1734837562aea71575740/.github%2Fworkflows%2Fdocker.yml", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/.github%2Fworkflows%2Fdocker.yml?ref=1eb4d0d3bad1a7faa7f1734837562aea71575740", "patch": "@@ -2,25 +2,32 @@ name: Build Docker image\n \n on:\n   push:\n-    branches: [ master ]\n+    branches:\n+      - 'master'\n \n jobs:\n-  build:\n+  docker:\n     runs-on: ubuntu-latest\n     steps:\n-      - name: git checkout\n+      -\n+        name: Checkout\n         uses: actions/checkout@v2\n-\n-      - name: docker login\n-        env:\n-          DOCKER_USER: ${{ secrets.DOCKER_USERNAME }}\n-          DOCKER_PASSWORD: ${{ secrets.DOCKER_PASSWORD }}\n-        run: |\n-          docker login -u $DOCKER_USER -p $DOCKER_PASSWORD\n-\n-      - name: docker build\n-        run: docker build .\n-\n-      - name: docker push\n-        run: docker push ${{secrets.DOCKER_USER}}/gccrs\n-\n+      -\n+        name: Set up QEMU\n+        uses: docker/setup-qemu-action@v1\n+      -\n+        name: Set up Docker Buildx\n+        uses: docker/setup-buildx-action@v1\n+      -\n+        name: Login to DockerHub\n+        uses: docker/login-action@v1\n+        with:\n+          username: ${{ secrets.DOCKERHUB_USERNAME }}\n+          password: ${{ secrets.DOCKERHUB_TOKEN }}\n+      -\n+        name: Build and push\n+        uses: docker/build-push-action@v2\n+        with:\n+          context: .\n+          push: true\n+          tags: philberty/gccrs:latest"}]}