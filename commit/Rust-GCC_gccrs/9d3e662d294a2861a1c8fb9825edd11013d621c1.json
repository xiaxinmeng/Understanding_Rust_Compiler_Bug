{"sha": "9d3e662d294a2861a1c8fb9825edd11013d621c1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWQzZTY2MmQyOTRhMjg2MWExYzhmYjk4MjVlZGQxMTAxM2Q2MjFjMQ==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2019-04-17T19:27:19Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2019-04-17T19:27:19Z"}, "message": "Fix tests for std::variant to match original intention\n\n\t* testsuite/20_util/variant/compile.cc (MoveCtorOnly): Fix type to\n\tactually match its name.\n\t(MoveCtorAndSwapOnly): Define new type that adds swap to MoveCtorOnly.\n\t(test_swap()): Fix result for MoveCtorOnly and check\n\tMoveCtorAndSwapOnly.\n\nFrom-SVN: r270423", "tree": {"sha": "acc7b47fe11a6e27934c8299fc53839156946ff1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/acc7b47fe11a6e27934c8299fc53839156946ff1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9d3e662d294a2861a1c8fb9825edd11013d621c1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9d3e662d294a2861a1c8fb9825edd11013d621c1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9d3e662d294a2861a1c8fb9825edd11013d621c1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9d3e662d294a2861a1c8fb9825edd11013d621c1/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "747742f6f3c80d04109b55ad1e90a77eac3ffd88", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/747742f6f3c80d04109b55ad1e90a77eac3ffd88", "html_url": "https://github.com/Rust-GCC/gccrs/commit/747742f6f3c80d04109b55ad1e90a77eac3ffd88"}], "stats": {"total": 20, "additions": 15, "deletions": 5}, "files": [{"sha": "8bba4b3d028e36fa03af320cfbad5d4296e17bee", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9d3e662d294a2861a1c8fb9825edd11013d621c1/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9d3e662d294a2861a1c8fb9825edd11013d621c1/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=9d3e662d294a2861a1c8fb9825edd11013d621c1", "patch": "@@ -1,5 +1,11 @@\n 2019-04-17  Jonathan Wakely  <jwakely@redhat.com>\n \n+\t* testsuite/20_util/variant/compile.cc (MoveCtorOnly): Fix type to\n+\tactually match its name.\n+\t(MoveCtorAndSwapOnly): Define new type that adds swap to MoveCtorOnly.\n+\t(test_swap()): Fix result for MoveCtorOnly and check\n+\tMoveCtorAndSwapOnly.\n+\n \t* include/std/optional (optional::value_or(U&&) &&): Add missing\n \tconstexpr specifier.\n \t* testsuite/20_util/optional/constexpr/observers/4.cc: Check value_or"}, {"sha": "5a2d91709a0fbdb2c53adf772b2feb9645abea70", "filename": "libstdc++-v3/testsuite/20_util/variant/compile.cc", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9d3e662d294a2861a1c8fb9825edd11013d621c1/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fvariant%2Fcompile.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9d3e662d294a2861a1c8fb9825edd11013d621c1/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fvariant%2Fcompile.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fvariant%2Fcompile.cc?ref=9d3e662d294a2861a1c8fb9825edd11013d621c1", "patch": "@@ -54,12 +54,15 @@ struct DefaultNoexcept\n struct MoveCtorOnly\n {\n   MoveCtorOnly() noexcept = delete;\n-  MoveCtorOnly(const DefaultNoexcept&) noexcept = delete;\n-  MoveCtorOnly(DefaultNoexcept&&) noexcept { }\n-  MoveCtorOnly& operator=(const DefaultNoexcept&) noexcept = delete;\n-  MoveCtorOnly& operator=(DefaultNoexcept&&) noexcept = delete;\n+  MoveCtorOnly(const MoveCtorOnly&) noexcept = delete;\n+  MoveCtorOnly(MoveCtorOnly&&) noexcept { }\n+  MoveCtorOnly& operator=(const MoveCtorOnly&) noexcept = delete;\n+  MoveCtorOnly& operator=(MoveCtorOnly&&) noexcept = delete;\n };\n \n+struct MoveCtorAndSwapOnly : MoveCtorOnly { };\n+void swap(MoveCtorAndSwapOnly&, MoveCtorAndSwapOnly&) { }\n+\n struct nonliteral\n {\n   nonliteral() { }\n@@ -259,7 +262,8 @@ static_assert( !std::is_swappable_v<variant<D, int>> );\n void test_swap()\n {\n   static_assert(is_swappable_v<variant<int, string>>, \"\");\n-  static_assert(is_swappable_v<variant<MoveCtorOnly>>, \"\");\n+  static_assert(!is_swappable_v<variant<MoveCtorOnly>>, \"\");\n+  static_assert(is_swappable_v<variant<MoveCtorAndSwapOnly>>, \"\");\n   static_assert(!is_swappable_v<variant<AllDeleted>>, \"\");\n }\n "}]}