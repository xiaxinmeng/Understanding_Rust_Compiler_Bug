{"sha": "088a1762744ea428d83cd5d91bed0e89103683ba", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDg4YTE3NjI3NDRlYTQyOGQ4M2NkNWQ5MWJlZDBlODkxMDM2ODNiYQ==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2005-03-07T19:51:10Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2005-03-07T19:51:10Z"}, "message": "VMCompiler.java (md5Digest): New field.\n\n\t* java/lang/VMCompiler.java (md5Digest): New field.\n\t(compileClass): Clone md5Digest instead of looking up a new one.\n\nFrom-SVN: r96039", "tree": {"sha": "4d4a23c0d21e6793017d163858877b7bbd8ac772", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4d4a23c0d21e6793017d163858877b7bbd8ac772"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/088a1762744ea428d83cd5d91bed0e89103683ba", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/088a1762744ea428d83cd5d91bed0e89103683ba", "html_url": "https://github.com/Rust-GCC/gccrs/commit/088a1762744ea428d83cd5d91bed0e89103683ba", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/088a1762744ea428d83cd5d91bed0e89103683ba/comments", "author": null, "committer": null, "parents": [{"sha": "1de80b0e69dfca5d6cb8c0bdd7398699a4b05557", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1de80b0e69dfca5d6cb8c0bdd7398699a4b05557", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1de80b0e69dfca5d6cb8c0bdd7398699a4b05557"}], "stats": {"total": 34, "additions": 32, "deletions": 2}, "files": [{"sha": "f4729686af4f988e1c56100d89b6c8bd1ba48b7d", "filename": "libjava/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/088a1762744ea428d83cd5d91bed0e89103683ba/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/088a1762744ea428d83cd5d91bed0e89103683ba/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=088a1762744ea428d83cd5d91bed0e89103683ba", "patch": "@@ -1,3 +1,8 @@\n+2005-03-07  Tom Tromey  <tromey@redhat.com>\n+\n+\t* java/lang/VMCompiler.java (md5Digest): New field.\n+\t(compileClass): Clone md5Digest instead of looking up a new one.\n+\n 2005-03-07  Tom Tromey  <tromey@redhat.com>\n \n \tPR java/20215:"}, {"sha": "784a816c59cef48f431a954ce93908fdfa5c7468", "filename": "libjava/java/lang/VMCompiler.java", "status": "modified", "additions": 27, "deletions": 2, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/088a1762744ea428d83cd5d91bed0e89103683ba/libjava%2Fjava%2Flang%2FVMCompiler.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/088a1762744ea428d83cd5d91bed0e89103683ba/libjava%2Fjava%2Flang%2FVMCompiler.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FVMCompiler.java?ref=088a1762744ea428d83cd5d91bed0e89103683ba", "patch": "@@ -79,6 +79,24 @@\n \n   private static Vector precompiledMapFiles;\n \n+  // We create a single MD5 engine and then clone it whenever we want\n+  // a new one.  This is simpler than trying to find a new one each\n+  // time, and it avoids potential deadlocks due to class loader\n+  // oddities.\n+  private static final MessageDigest md5Digest;\n+\n+  static\n+  {\n+    try\n+      {\n+\tmd5Digest = MessageDigest.getInstance(\"MD5\");\n+      }\n+    catch (NoSuchAlgorithmException _)\n+      {\n+\tmd5Digest = null;\n+      }\n+  }\n+\n   static\n   {\n     gcjJitCompiler = System.getProperty(\"gnu.gcj.jit.compiler\");\n@@ -175,11 +193,18 @@ public static Class compileClass(ClassLoader loader,\n \n     try\n       {\n-\tMessageDigest md = MessageDigest.getInstance(\"MD5\");\n+\tMessageDigest md = (MessageDigest) md5Digest.clone();\n \tdigest = md.digest(data);\n       }\n-    catch (NoSuchAlgorithmException _)\n+    catch (CloneNotSupportedException _)\n+      {\n+\t// Can't happen.\n+\treturn null;\n+      }\n+    catch (NullPointerException _)\n       {\n+\t// If md5Digest==null -- but really this should never happen\n+\t// either, since the MD5 digest is in libgcj.\n \treturn null;\n       }\n "}]}