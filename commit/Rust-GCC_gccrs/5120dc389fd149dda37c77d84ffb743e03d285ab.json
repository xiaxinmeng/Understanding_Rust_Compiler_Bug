{"sha": "5120dc389fd149dda37c77d84ffb743e03d285ab", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTEyMGRjMzg5ZmQxNDlkZGEzN2M3N2Q4NGZmYjc0M2UwM2QyODVhYg==", "commit": {"author": {"name": "Ben Elliston", "email": "bje@au.ibm.com", "date": "2009-11-23T04:42:32Z"}, "committer": {"name": "Ben Elliston", "email": "bje@gcc.gnu.org", "date": "2009-11-23T04:42:32Z"}, "message": "pex-unix.c (pex_child_error): Improve warning avoidance by checking the results of write(3) and exiting with...\n\n\t* pex-unix.c (pex_child_error): Improve warning avoidance by\n\tchecking the results of write(3) and exiting with -2 if any write\n\treturns a negative value.\n\nCo-Authored-By: Ian Lance Taylor <iant@google.com>\n\nFrom-SVN: r154431", "tree": {"sha": "4de5ac8ddb846000f3be54cbd7905854fe6a78e7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4de5ac8ddb846000f3be54cbd7905854fe6a78e7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5120dc389fd149dda37c77d84ffb743e03d285ab", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5120dc389fd149dda37c77d84ffb743e03d285ab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5120dc389fd149dda37c77d84ffb743e03d285ab", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5120dc389fd149dda37c77d84ffb743e03d285ab/comments", "author": null, "committer": null, "parents": [{"sha": "5154a159dfdf5d7ac7bc3ac9ba5d93e514d51672", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5154a159dfdf5d7ac7bc3ac9ba5d93e514d51672", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5154a159dfdf5d7ac7bc3ac9ba5d93e514d51672"}], "stats": {"total": 13, "additions": 11, "deletions": 2}, "files": [{"sha": "79e0462dd2634d27af0bed5f20f13a12a01747fc", "filename": "libiberty/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5120dc389fd149dda37c77d84ffb743e03d285ab/libiberty%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5120dc389fd149dda37c77d84ffb743e03d285ab/libiberty%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2FChangeLog?ref=5120dc389fd149dda37c77d84ffb743e03d285ab", "patch": "@@ -1,3 +1,10 @@\n+2009-11-23  Ben Elliston  <bje@au.ibm.com>\n+\t    Ian Lance Taylor  <iant@google.com>\n+\n+\t* pex-unix.c (pex_child_error): Improve warning avoidance by\n+\tchecking the results of write(3) and exiting with -2 if any write\n+\treturns a negative value.\n+\n 2009-11-22  Steve Ward  <planet36@gmail.com>\n \n \t* dyn-string.c (dyn_string_append_char): Fix typo in comment."}, {"sha": "4428f60863f6d546bf3b1f27319ce9e99a536b8c", "filename": "libiberty/pex-unix.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5120dc389fd149dda37c77d84ffb743e03d285ab/libiberty%2Fpex-unix.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5120dc389fd149dda37c77d84ffb743e03d285ab/libiberty%2Fpex-unix.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Fpex-unix.c?ref=5120dc389fd149dda37c77d84ffb743e03d285ab", "patch": "@@ -368,7 +368,8 @@ static void\n pex_child_error (struct pex_obj *obj, const char *executable,\n \t\t const char *errmsg, int err)\n {\n-#define writeerr(s) if (write (STDERR_FILE_NO, s, strlen (s))) {}\n+  int retval = 0;\n+#define writeerr(s) retval |= (write (STDERR_FILE_NO, s, strlen (s)) < 0)\n   writeerr (obj->pname);\n   writeerr (\": error trying to exec '\");\n   writeerr (executable);\n@@ -378,7 +379,8 @@ pex_child_error (struct pex_obj *obj, const char *executable,\n   writeerr (xstrerror (err));\n   writeerr (\"\\n\");\n #undef writeerr\n-  _exit (-1);\n+  /* Exit with -2 if the error output failed, too.  */\n+  _exit (retval == 0 ? -1 : -2);\n }\n \n /* Execute a child.  */"}]}