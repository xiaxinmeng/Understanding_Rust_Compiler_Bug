{"sha": "467f18f389215fd82103477340905ea8b9638d07", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDY3ZjE4ZjM4OTIxNWZkODIxMDM0NzczNDA5MDVlYThiOTYzOGQwNw==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2006-10-14T13:09:56Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2006-10-14T13:09:56Z"}, "message": "re PR fortran/29371 (Coredump when using -fbounds-check with pointer & nullify)\n\n2006-10-14 Paul Thomas <pault@gcc.gnu.org>\n\n\tPR fortran/29371\n\t* trans-expr.c (gfc_trans_pointer_assignment): Add the expression\n\tfor the assignment of null to the data field to se->pre, rather\n\tthan block.\t\n\n2006-10-14 Paul Thomas <pault@gcc.gnu.org>\n\n\tPR fortran/29371\n\t* gfortran.dg/nullify_3.f90: New test.\n\nFrom-SVN: r117732", "tree": {"sha": "fc9e29dc712499b64f694f8ea4a15e438a55d569", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fc9e29dc712499b64f694f8ea4a15e438a55d569"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/467f18f389215fd82103477340905ea8b9638d07", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/467f18f389215fd82103477340905ea8b9638d07", "html_url": "https://github.com/Rust-GCC/gccrs/commit/467f18f389215fd82103477340905ea8b9638d07", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/467f18f389215fd82103477340905ea8b9638d07/comments", "author": null, "committer": null, "parents": [{"sha": "621048c8f5830e0b7a5c4b936543aeb56b0f623a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/621048c8f5830e0b7a5c4b936543aeb56b0f623a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/621048c8f5830e0b7a5c4b936543aeb56b0f623a"}], "stats": {"total": 40, "additions": 39, "deletions": 1}, "files": [{"sha": "910de0d0f324fc6508d1822982ad254e2ed07a78", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/467f18f389215fd82103477340905ea8b9638d07/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/467f18f389215fd82103477340905ea8b9638d07/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=467f18f389215fd82103477340905ea8b9638d07", "patch": "@@ -1,3 +1,10 @@\n+2006-10-14 Paul Thomas <pault@gcc.gnu.org>\n+\n+\tPR fortran/29371\n+\t* trans-expr.c (gfc_trans_pointer_assignment): Add the expression\n+\tfor the assignment of null to the data field to se->pre, rather\n+\tthan block.\t\n+\n 2006-10-14  Kazu Hirata  <kazu@codesourcery.com>\n \n \t* intrinsic.texi: Fix typos."}, {"sha": "190a11560daecb452e186b7a701ef9290c7664bd", "filename": "gcc/fortran/trans-expr.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/467f18f389215fd82103477340905ea8b9638d07/gcc%2Ffortran%2Ftrans-expr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/467f18f389215fd82103477340905ea8b9638d07/gcc%2Ffortran%2Ftrans-expr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-expr.c?ref=467f18f389215fd82103477340905ea8b9638d07", "patch": "@@ -3149,7 +3149,7 @@ gfc_trans_pointer_assignment (gfc_expr * expr1, gfc_expr * expr2)\n \t{\n \tcase EXPR_NULL:\n \t  /* Just set the data pointer to null.  */\n-\t  gfc_conv_descriptor_data_set (&block, lse.expr, null_pointer_node);\n+\t  gfc_conv_descriptor_data_set (&lse.pre, lse.expr, null_pointer_node);\n \t  break;\n \n \tcase EXPR_VARIABLE:"}, {"sha": "075f175dc46bbc64c8ecdcb14afdfa5eee8a307c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/467f18f389215fd82103477340905ea8b9638d07/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/467f18f389215fd82103477340905ea8b9638d07/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=467f18f389215fd82103477340905ea8b9638d07", "patch": "@@ -1,3 +1,8 @@\n+2006-10-14 Paul Thomas <pault@gcc.gnu.org>\n+\n+\tPR fortran/29371\n+\t* gfortran.dg/nullify_3.f90: New test.\n+\n 2006-10-14  Eric Botcazou  <ebotcazou@libertysurf.fr>\n \n \t* gcc.dg/pthread-init-2.c (dg-options): Define _POSIX_C_SOURCE=199506L"}, {"sha": "7d202a25893ef20f7cb90c7a7ee3585691fd1a13", "filename": "gcc/testsuite/gfortran.dg/nullify_3.f90", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/467f18f389215fd82103477340905ea8b9638d07/gcc%2Ftestsuite%2Fgfortran.dg%2Fnullify_3.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/467f18f389215fd82103477340905ea8b9638d07/gcc%2Ftestsuite%2Fgfortran.dg%2Fnullify_3.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fnullify_3.f90?ref=467f18f389215fd82103477340905ea8b9638d07", "patch": "@@ -0,0 +1,26 @@\n+! { dg-do run }\n+! { dg-options \"-O0 -fbounds-check\" }\n+! Tests patch for PR29371, in which the null pointer\n+! assignment would cause a segfault with the bounds\n+! check on.\n+!\n+! Contributed by Tobias Burnus <tobias.burnus@physik.fu-berlin.de>\n+!\n+program test\n+  implicit none\n+  type projector_t\n+    real,   pointer :: ket(:, :), bra(:, :)\n+  end type projector_t\n+\n+  type(projector_t),pointer, dimension(:) :: p\n+  integer :: stat,i\n+  allocate(p(2),stat=stat)\n+  do i = 1, 2\n+        nullify(p(i)%bra)\n+        nullify(p(i)%ket)\n+  end do\n+  do i = 1, 2\n+        if (associated (p(i)%bra)) call abort ()\n+        if (associated (p(i)%ket)) call abort ()\n+  end do\n+end program"}]}