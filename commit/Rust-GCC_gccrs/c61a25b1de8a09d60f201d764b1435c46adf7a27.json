{"sha": "c61a25b1de8a09d60f201d764b1435c46adf7a27", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzYxYTI1YjFkZThhMDlkNjBmMjAxZDc2NGIxNDM1YzQ2YWRmN2EyNw==", "commit": {"author": {"name": "David J. MacKenzie", "email": "djm@gnu.org", "date": "1992-02-29T18:29:37Z"}, "committer": {"name": "David J. MacKenzie", "email": "djm@gnu.org", "date": "1992-02-29T18:29:37Z"}, "message": "Initial revision\n\nFrom-SVN: r370", "tree": {"sha": "5644edfee0bb331c4a1ede1d2a01c53f78145cd6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5644edfee0bb331c4a1ede1d2a01c53f78145cd6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c61a25b1de8a09d60f201d764b1435c46adf7a27", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c61a25b1de8a09d60f201d764b1435c46adf7a27", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c61a25b1de8a09d60f201d764b1435c46adf7a27", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c61a25b1de8a09d60f201d764b1435c46adf7a27/comments", "author": null, "committer": null, "parents": [{"sha": "0e52f7f58b8338f44c515a83f33ea83b932f31ea", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0e52f7f58b8338f44c515a83f33ea83b932f31ea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0e52f7f58b8338f44c515a83f33ea83b932f31ea"}], "stats": {"total": 541, "additions": 541, "deletions": 0}, "files": [{"sha": "aab3ee1af5ccdf4a0bdf93138bb804f85041e006", "filename": "gcc/fixincludes", "status": "added", "additions": 541, "deletions": 0, "changes": 541, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c61a25b1de8a09d60f201d764b1435c46adf7a27/gcc%2Ffixincludes", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c61a25b1de8a09d60f201d764b1435c46adf7a27/gcc%2Ffixincludes", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixincludes?ref=c61a25b1de8a09d60f201d764b1435c46adf7a27", "patch": "@@ -0,0 +1,541 @@\n+#! /bin/sh\n+# Install modified versions of certain ANSI-incompatible system header files\n+# which are fixed to work correctly with ANSI C\n+# and placed in a directory that GNU C will search.\n+\n+# See README-fixinc for more information.\n+\n+# Directory containing the original header files.\n+# (This was named INCLUDES, but that conflicts with a name in Makefile.in.)\n+INPUT=${2-${INPUT-/usr/include}}\n+\n+# This prevents /bin/ex from failing if the current terminal type is\n+# unrecognizable.\n+TERM=unknown\n+export TERM\n+\n+# Directory in which to store the results.\n+LIB=${1-${LIB-/usr/local/lib/gcc-include}}\n+\n+# Make sure it exists.\n+if [ ! -d $LIB ]; then\n+  mkdir $LIB || exit 1\n+fi\n+\n+# Make LIB absolute.\n+cd $LIB; LIB=`pwd`\n+\n+# Fail if no arg to specify a directory for the output.\n+if [ x$1 = x ]\n+then echo fixincludes: no output directory specified\n+exit 1\n+fi\n+\n+echo 'Building fixincludes in ' ${LIB}\n+\n+# Determine whether this system has symbolic links.\n+if ln -s X $LIB/ShouldNotExist 2>/dev/null; then\n+  rm -f $LIB/ShouldNotExist\n+  LINKS=true\n+else\n+  LINKS=false\n+fi\n+\n+echo 'Making directories:'\n+cd ${INPUT}\n+if $LINKS; then\n+  files=`ls -LR | sed -n s/:$//p`\n+else\n+  files=`find . -type d -print | sed '/^.$/d'`\n+fi\n+for file in $files; do\n+  rm -rf $LIB/$file\n+  if [ ! -d $LIB/$file ]\n+  then mkdir $LIB/$file\n+  fi\n+done\n+\n+# treetops gets an alternating list\n+# of old directories to copy\n+# and the new directories to copy to.\n+treetops=\"${INPUT} ${LIB}\"\n+\n+if $LINKS; then\n+  echo 'Making internal symbolic directory links'\n+  for file in $files; do\n+    dest=`ls -ld $file | sed -n 's/.*-> //p'`\n+    if [ \"$dest\" ]; then    \n+      cwd=`pwd`\n+      # In case $dest is relative, get to $file's dir first.\n+      cd ${INPUT}\n+      cd `echo ./$file | sed -n 's&[^/]*$&&p'`\n+      # Check that the target directory exists.\n+      # Redirections changed to avoid bug in sh on Ultrix.\n+      (cd $dest) > /dev/null 2>&1\n+      if [ $? = 0 ]; then\n+\tcd $dest\n+\t# X gets the dir that the link actually leads to.\n+\tx=`pwd`\n+\t# If link leads back into ${INPUT},\n+\t# make a similar link here.\n+\tif expr $x : \"${INPUT}/.*\" > /dev/null; then\n+\t  # Y gets the actual target dir name, relative to ${INPUT}.\n+\t  y=`echo $x | sed -n \"s&${INPUT}/&&p\"`\n+\t  echo $file '->' $y ': Making link'\n+\t  rm -fr ${LIB}/$file > /dev/null 2>&1\n+\t  ln -s ${LIB}/$y ${LIB}/$file > /dev/null 2>&1\n+\telse\n+\t  # If the link is to outside ${INPUT},\n+\t  # treat this directory as if it actually contained the files.\n+# This line used to have $dest instead of $x.\n+# $dest seemed to be wrong for links found in subdirectories\n+# of ${INPUT}.  Does this change break anything?\n+\t  treetops=\"$treetops $x ${LIB}/$file\"\n+\tfi\n+      fi\n+      cd $cwd\n+    fi\n+  done\n+fi\n+\n+set - $treetops\n+while [ $# != 0 ]; do\n+  # $1 is an old directory to copy, and $2 is the new directory to copy to.\n+  echo \"Finding header files in $1:\"\n+  cd ${INPUT}\n+  cd $1\n+  files=`find . -name '*.h' -type f -print`\n+  echo 'Checking header files:'\n+# Note that BSD43_* are used on recent MIPS systems.\n+  for file in $files; do\n+# This call to egrep is essential, since checking a file with egrep\n+# is much faster than actually trying to fix it.\n+# But the argument to egrep must be kept small, or many versions of egrep\n+# won't be able to handle it.\n+    if egrep '[ \t_]_IO|CTRL|#define.NULL|#[el]*if.*([0-9]|#e[nl]|sparc|vax|sun|pyr)' $file > /dev/null; then\n+      echo Fixing $file\n+      if [ -r $file ]; then\n+\tcp $file $2/$file >/dev/null 2>&1\t\\\n+\t|| echo \"Can't copy $file\"\n+\tchmod +w $2/$file\n+\tsed -e '\n+\t\t\t\t   :loop\n+\t  /\\\\$/\t\t\tN\n+\t  /\\\\$/\t\t\tb loop\n+\t  s%\\(#[ \t]*endif[ \t]*\\)\\([^/ \t].*\\)$%\\1/* \\2 */%\n+\t  s%\\(#[ \t]*else[ \t]*\\)\\([^/ \t].*\\)$%\\1/* \\2 */%\n+\t  /[ \t]_IO[A-Z]*[ \t]*(/\ts/(\\(.\\),/('\\''\\1'\\'',/\n+\t  /[ \t]BSD43__IO[A-Z]*[ \t]*(/\ts/(\\(.\\),/('\\''\\1'\\'',/\n+\t  /#define._IO/\t\ts/'\\''x'\\''/x/g\n+\t  /#define.BSD43__IO/\t\ts/'\\''x'\\''/x/g\n+\t  /[^A-Z]CTRL[ \t]*(/\ts/\\([^'\\'']\\))/'\\''\\1'\\'')/\n+\t  /#define.CTRL/\t\ts/'\\''c'\\''/c/g\n+\t  /#define._CTRL/\t\ts/'\\''c'\\''/c/g\n+\t  /#define.BSD43_CTRL/\t\ts/'\\''c'\\''/c/g\n+\t  /#[a-z]*if.*[\t (]m68k/\t\ts/\\([^_]\\)m68k/\\1__m68k__/g\n+\t  /#[a-z]*if.*[\t (]__i386/\ts/__i386/__i386__/g\n+\t  /#[a-z]*if.*[\t (]i386/\t\ts/\\([^_]\\)i386/\\1__i386__/g\n+\t  /#[a-z]*if.*[\t (]sparc/\ts/\\([^_]\\)sparc/\\1__sparc__/g\n+\t  /#[a-z]*if.*[\t (]mc68000/\ts/\\([^_]\\)mc68000/\\1__mc68000__/g\n+\t  /#[a-z]*if.*[\t (]vax/\t\ts/\\([^_]\\)vax/\\1__vax__/g\n+\t  /#[a-z]*if.*[\t (]sun/\t\ts/\\([^_]\\)\\(sun[a-z0-9]*\\)\\([^a-z0-9_]\\)/\\1__\\2__\\3/g\n+\t  /#[a-z]*if.*[\t (]sun/\t\ts/\\([^_]\\)\\(sun[a-z0-9]*\\)$/\\1__\\2__/g\n+\t  /#[a-z]*if.*[\t (]ns32000/\ts/\\([^_]\\)ns32000/\\1__ns32000__/g\n+\t  /#[a-z]*if.*[\t (]pyr/\t\ts/\\([^_]\\)pyr/\\1__pyr__/g\n+\t  /#[a-z]*if.*[\t (]is68k/\ts/\\([^_]\\)is68k/\\1__is68k__/g\n+\t  /#define.NULL[ \t]/\ti\\\n+\t\t#undef NULL\n+\t' $2/$file > $2/$file.sed\n+\tmv $2/$file.sed $2/$file\n+\tif cmp $file $2/$file >/dev/null 2>&1; then\n+\t   echo Deleting $2/$file\\; no fixes were needed.\n+\t   rm $2/$file\n+\tfi\n+      fi\n+    fi\n+  done\n+  shift; shift\n+done\n+\n+cd ${INPUT}\n+\n+# Fix one other error in this file: a mismatched quote not inside a C comment.\n+file=sundev/vuid_event.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  mkdir ${LIB}/sundev 2>/dev/null\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file comment\n+  ex ${LIB}/$file <<EOF\n+  g/doesn't/s/doesn't/does not/\n+  wq\n+EOF\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    echo Deleting ${LIB}/$file\\; no fixes were needed.\n+    rm ${LIB}/$file\n+  fi\n+fi\n+\n+# Fix this Sun file to avoid intefering with stddef.h.\n+file=sys/stdtypes.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file\n+  ex ${LIB}/$file <<EOF\n+  /size_t.*;/\n+  i\n+#ifndef _SIZE_T\n+#define _SIZE_T\n+.\n+  /size_t/+1\n+  i\n+#endif\n+.\n+  /ptrdiff_t.*;/\n+  i\n+#ifndef _PTRDIFF_T\n+#define _PTRDIFF_T\n+.\n+  /ptrdiff_t/+1\n+  i\n+#endif\n+.\n+  /wchar_t.*;/\n+  i\n+#ifndef _WCHAR_T\n+#define _WCHAR_T\n+.\n+  /wchar_t/+1\n+  i\n+#endif\n+.\n+  wq\n+EOF\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    echo Deleting ${LIB}/$file\\; no fixes were needed.\n+    rm ${LIB}/$file\n+  fi\n+fi\n+\n+# Fix this file to avoid intefering with stddef.h.\n+file=sys/types.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file\n+  ex ${LIB}/$file <<EOF\n+  /size_t.*;/\n+  i\n+#ifndef _SIZE_T\n+#define _SIZE_T\n+.\n+  /size_t/+1\n+  i\n+#endif\n+.\n+  wq\n+EOF\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    echo Deleting ${LIB}/$file\\; no fixes were needed.\n+    rm ${LIB}/$file\n+  fi\n+fi\n+\n+# Fix an error in this file: a missing semi-colon at the end of the statsswtch\n+# structure definition.\n+file=rpcsvc/rstat.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  mkdir ${LIB}/rpcsvc 2>/dev/null\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file, definition of statsswtch\n+  ex ${LIB}/$file <<EOF\n+  g/boottime$/s//&;/\n+  wq\n+EOF\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    echo Deleting ${LIB}/$file\\; no fixes were needed.\n+    rm ${LIB}/$file\n+  fi\n+fi\n+\n+# Fix an error in this file: a missing semi-colon at the end of the nodeent\n+# structure definition.\n+file=netdnet/dnetdb.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  mkdir ${LIB}/netdnet 2>/dev/null\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file, definition of nodeent\n+  ex ${LIB}/$file <<EOF\n+  g/na_addr/s//&;/\n+  wq\n+EOF\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    echo Deleting ${LIB}/$file\\; no fixes were needed.\n+    rm ${LIB}/$file\n+  fi\n+fi\n+\n+# Check for bad #ifdef line (in Ultrix 4.1)\n+file=sys/file.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file, bad \\#ifdef line\n+  ex ${LIB}/$file <<EOF\n+  g/^#ifdef KERNEL && !defined/\n+  s/#ifdef KERNEL && !defined/#if defined(KERNEL) \\&\\& !defined/\n+  wq\n+EOF\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    echo Deleting ${LIB}/$file\\; no fixes were needed.\n+    rm ${LIB}/$file\n+  fi\n+fi\n+\n+# Check for superfluous `static' (in Ultrix 4.2)\n+file=machine/cpu.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  mkdir ${LIB}/machine 2>/dev/null\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file, superfluous static\n+  ex ${LIB}/$file <<EOF\n+  g/^static struct tlb_pid_state/\n+  s/static//\n+  wq\n+EOF\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    echo Deleting ${LIB}/$file\\; no fixes were needed.\n+    rm ${LIB}/$file\n+  else\n+# This file has an alternative name, mips/cpu.h.  Fix that name, too.\n+    if cmp machine/cpu.h mips/cpu.h > /dev/null 2>& 1; then\n+      mkdir ${LIB}/mips 2>&-\n+      ln ${LIB}/$file ${LIB}/mips/cpu.h \n+    fi\n+  fi\n+fi\n+\n+# Deal with yet another challenge, this in X11/Xmu.h\n+file=X11/Xmu.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  mkdir ${LIB}/X11 2>/dev/null\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file sprintf declaration\n+  ex ${LIB}/$file <<EOF\n+  /^extern char \\*\tsprintf();$/c\n+#ifndef __STDC__\n+extern char *\tsprintf();\n+#endif /* !defined __STDC__ */\n+.\n+  wq\n+EOF\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    echo Deleting ${LIB}/$file\\; no fixes were needed.\n+    rm ${LIB}/$file\n+  fi\n+fi\n+\n+# Check for missing ';' in struct\n+file=netinet/ip.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  mkdir ${LIB}/netinet 2>/dev/null\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file\n+  sed -e '/^struct/,/^};/s/}$/};/' ${LIB}/$file > ${LIB}/${file}.sed\n+  rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    echo Deleting ${LIB}/$file\\; no fixes were needed.\n+    rm -f ${LIB}/$file\n+  fi\n+fi\n+\n+# Fix the CAT macro in memvar.h.\n+file=pixrect/memvar.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  mkdir ${LIB}/pixrect 2>/dev/null\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file\n+  sed -e '/^#define.CAT(a,b)/ i\\\n+#ifdef __STDC__ \\\n+#define CAT(a,b) a##b\\\n+#else\n+/^#define.CAT(a,b)/ a\\\n+#endif\n+' ${LIB}/$file > ${LIB}/${file}.sed\n+  rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    echo Deleting ${LIB}/$file\\; no fixes were needed.\n+    rm -f ${LIB}/$file\n+  fi\n+fi\n+\n+# Check for yet more missing ';' in struct (in SunOS 4.0.x)\n+file=rpcsvc/rusers.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  mkdir ${LIB}/rpcsvc 2>/dev/null\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file\n+  sed -e '/^struct/,/^};/s/_cnt$/_cnt;/' ${LIB}/$file > ${LIB}/${file}.sed\n+  rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    echo Deleting ${LIB}/$file\\; no fixes were needed.\n+    rm -f ${LIB}/$file\n+  fi\n+fi\n+\n+# Fix return type of exit and abort in <stdlib.h> on SunOS 4.1.\n+file=stdlib.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file\n+  sed -e 's/int\tabort/void\tabort/g' \\\n+  -e 's/int\texit/void\texit/g' ${LIB}/$file > ${LIB}/${file}.sed\n+  rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    echo Deleting ${LIB}/$file\\; no fixes were needed.\n+    rm -f ${LIB}/$file\n+  fi\n+fi\n+\n+# Fix bogus comment in <locale.h> on SunOS 4.1.\n+file=locale.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file\n+  sed -e 's%#endif / \\*%#endif /\\* %g' ${LIB}/$file > ${LIB}/${file}.sed\n+  rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    echo Deleting ${LIB}/$file\\; no fixes were needed.\n+    rm -f ${LIB}/$file\n+  fi\n+fi\n+\n+# Fix bogus #ifdef in <hsfs/hsfs_spec.h> on SunOS 4.1.\n+file=hsfs/hsfs_spec.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  mkdir ${LIB}/hsfs 2>/dev/null\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file\n+  sed -e 's/\\#ifdef __i386__ || __vax__/\\#if __i386__ || __vax__/g' \\\n+    ${LIB}/$file > ${LIB}/${file}.sed\n+  rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    echo Deleting ${LIB}/$file\\; no fixes were needed.\n+    rm -f ${LIB}/$file\n+  fi\n+fi\n+\n+# Fix bogus #ifdef in <hsfs/hsnode.h> on SunOS 4.1.\n+file=hsfs/hsnode.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  mkdir ${LIB}/hsfs 2>/dev/null\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file\n+  sed -e 's/\\#ifdef __i386__ || __sun4c__/\\#if __i386__ || __sun4c__/g' \\\n+    ${LIB}/$file > ${LIB}/${file}.sed\n+  rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    echo Deleting ${LIB}/$file\\; no fixes were needed.\n+    rm -f ${LIB}/$file\n+  fi\n+fi\n+\n+# Fix bogus #ifdef in <hsfs/iso_spec.h> on SunOS 4.1.\n+file=hsfs/iso_spec.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  mkdir ${LIB}/hsfs 2>/dev/null\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file\n+  sed -e 's/\\#ifdef __i386__ || __vax__/\\#if __i386__ || __vax__/g' \\\n+    ${LIB}/$file > ${LIB}/${file}.sed\n+  rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    echo Deleting ${LIB}/$file\\; no fixes were needed.\n+    rm -f ${LIB}/$file\n+  fi\n+fi\n+\n+echo 'Removing unneeded directories:'\n+cd $LIB\n+files=`find . -type d -print | sort -r`\n+for file in $files; do\n+  rmdir $LIB/$file > /dev/null 2>&1\n+done\n+\n+if $LINKS; then\n+  echo 'Making internal symbolic non-directory links'\n+  cd ${INPUT}\n+  files=`find . -type l -print`\n+  for file in $files; do\n+    dest=`ls -ld $file | sed -n 's/.*-> //p'`\n+    if expr \"$dest\" : '[^/].*' > /dev/null; then    \n+      target=${LIB}/`echo file | sed \"s|[^/]*\\$|$dest|\"`\n+      if [ -f $target ]; then\n+        ln -s $dest ${LIB}/$file >/dev/null 2>&1\n+      fi\n+    fi\n+  done\n+fi\n+\n+exit 0"}]}