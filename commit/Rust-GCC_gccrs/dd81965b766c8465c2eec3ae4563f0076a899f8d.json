{"sha": "dd81965b766c8465c2eec3ae4563f0076a899f8d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGQ4MTk2NWI3NjZjODQ2NWMyZWVjM2FlNDU2M2YwMDc2YTg5OWY4ZA==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2013-08-07T10:10:27Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2013-08-07T10:10:27Z"}, "message": "re PR c++/46206 (using typedef-name error with typedef name hiding struct name)\n\n/cp\n2013-08-07  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/46206\n\t* name-lookup.c (lookup_name_real_1): Handle iter->type before\n\titer->value.\n\n/testsuite\n2013-08-07  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/46206\n\t* g++.dg/lookup/typedef2.C: New.\n\nFrom-SVN: r201558", "tree": {"sha": "acd7e4cba3fe1b5cfcd2ce64ea2edb289f5d3427", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/acd7e4cba3fe1b5cfcd2ce64ea2edb289f5d3427"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dd81965b766c8465c2eec3ae4563f0076a899f8d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd81965b766c8465c2eec3ae4563f0076a899f8d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dd81965b766c8465c2eec3ae4563f0076a899f8d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd81965b766c8465c2eec3ae4563f0076a899f8d/comments", "author": null, "committer": null, "parents": [{"sha": "2077db1be5b18b94a91095a3fb380bbc4a81e61b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2077db1be5b18b94a91095a3fb380bbc4a81e61b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2077db1be5b18b94a91095a3fb380bbc4a81e61b"}], "stats": {"total": 49, "additions": 45, "deletions": 4}, "files": [{"sha": "d3709fa38ad9c28b1a95b9530632496c73b44ff3", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd81965b766c8465c2eec3ae4563f0076a899f8d/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd81965b766c8465c2eec3ae4563f0076a899f8d/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=dd81965b766c8465c2eec3ae4563f0076a899f8d", "patch": "@@ -1,3 +1,9 @@\n+2013-08-07  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/46206\n+\t* name-lookup.c (lookup_name_real_1): Handle iter->type before\n+\titer->value.\n+\n 2013-08-06  Caroline Tice  <cmtice@google.com>\n \n \t* Make-lang.in (*CXX_AND_OBJCXX_OBJS):  Add vtable-class-hierarchy.o to"}, {"sha": "05f048068b398116b899a34490ba4f71272bb553", "filename": "gcc/cp/name-lookup.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd81965b766c8465c2eec3ae4563f0076a899f8d/gcc%2Fcp%2Fname-lookup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd81965b766c8465c2eec3ae4563f0076a899f8d/gcc%2Fcp%2Fname-lookup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fname-lookup.c?ref=dd81965b766c8465c2eec3ae4563f0076a899f8d", "patch": "@@ -4740,11 +4740,11 @@ lookup_name_real_1 (tree name, int prefer_type, int nonclass, bool block_p,\n \t  continue;\n \n \t/* If this is the kind of thing we're looking for, we're done.  */\n-\tif (qualify_lookup (iter->value, flags))\n-\t  binding = iter->value;\n-\telse if ((flags & LOOKUP_PREFER_TYPES)\n-\t\t && qualify_lookup (iter->type, flags))\n+\tif ((flags & LOOKUP_PREFER_TYPES)\n+\t    && qualify_lookup (iter->type, flags))\n \t  binding = iter->type;\n+\telse if (qualify_lookup (iter->value, flags))\n+\t  binding = iter->value;\n \telse\n \t  binding = NULL_TREE;\n "}, {"sha": "ef030b0662585276e17cb130888bb641f74ed8d0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd81965b766c8465c2eec3ae4563f0076a899f8d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd81965b766c8465c2eec3ae4563f0076a899f8d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=dd81965b766c8465c2eec3ae4563f0076a899f8d", "patch": "@@ -1,3 +1,8 @@\n+2013-08-07  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/46206\n+\t* g++.dg/lookup/typedef2.C: New.\n+\n 2013-08-07  David Malcolm  <dmalcolm@redhat.com>\n \n \t* lib/plugin-support.exp (plugin-test-execute): Add -fno-rtti"}, {"sha": "fdadeec63bf143b00ad6bb523c3dfff813703d20", "filename": "gcc/testsuite/g++.dg/lookup/typedef2.C", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd81965b766c8465c2eec3ae4563f0076a899f8d/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Ftypedef2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd81965b766c8465c2eec3ae4563f0076a899f8d/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Ftypedef2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Ftypedef2.C?ref=dd81965b766c8465c2eec3ae4563f0076a899f8d", "patch": "@@ -0,0 +1,30 @@\n+// PR c++/46206\n+\n+class Foo1\n+{\n+  int u, v, w, x;\n+  typedef struct Bar { } Bar;\n+  virtual void foo(void) {\n+    struct Bar bar;\n+  }\n+};\n+\n+class Foo2\n+{\n+  int u, v, w;\n+  typedef struct Bar { } Bar;\n+  Bar bar;\n+  virtual void foo(void) {\n+    struct Bar bar;\n+  }\n+};\n+\n+class Foo3\n+{\n+  int u, v, w;\n+  typedef struct Bar { } Bar;\n+  int Bar;   // { dg-error \"conflicts\" }\n+  virtual void foo(void) {\n+    struct Bar bar;\n+  }\n+};"}]}