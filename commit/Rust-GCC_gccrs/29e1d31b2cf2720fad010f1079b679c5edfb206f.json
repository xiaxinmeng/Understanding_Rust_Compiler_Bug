{"sha": "29e1d31b2cf2720fad010f1079b679c5edfb206f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjllMWQzMWIyY2YyNzIwZmFkMDEwZjEwNzliNjc5YzVlZGZiMjA2Zg==", "commit": {"author": {"name": "Mantas Mikaitis", "email": "mantas.mikaitis@arm.com", "date": "2015-02-05T16:58:58Z"}, "committer": {"name": "Alan Lawrence", "email": "alalaw01@gcc.gnu.org", "date": "2015-02-05T16:58:58Z"}, "message": "[ARM] __ARM_FP & __ARM_NEON_FP defined when -march=armv7-m\n\ngcc/:\n\n\t* config/arm/arm.h (TARGET_NEON_FP): Removed conditional definition,\n\tdefine to zero if !TARGET_NEON.\n\t(TARGET_CPU_CPP_BUILTINS): Added second condition before defining\n\t__ARM_FP macro.\n\ngcc/testsuite/:\n\n\t* gcc.target/arm/macro_defs0.c: New test.\n\t* gcc.target/arm/macro_defs1.c: New test.\n\t* gcc.target/arm/macro_defs2.c: New test.\n\nFrom-SVN: r220456", "tree": {"sha": "3af2ded9211f056e18c3f33bceaa37292a578673", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3af2ded9211f056e18c3f33bceaa37292a578673"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/29e1d31b2cf2720fad010f1079b679c5edfb206f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/29e1d31b2cf2720fad010f1079b679c5edfb206f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/29e1d31b2cf2720fad010f1079b679c5edfb206f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/29e1d31b2cf2720fad010f1079b679c5edfb206f/comments", "author": null, "committer": null, "parents": [{"sha": "06fa4f005f4432d90148d37bcce2752dd922e947", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06fa4f005f4432d90148d37bcce2752dd922e947", "html_url": "https://github.com/Rust-GCC/gccrs/commit/06fa4f005f4432d90148d37bcce2752dd922e947"}], "stats": {"total": 59, "additions": 53, "deletions": 6}, "files": [{"sha": "1805759c721eb44a009bc556d7cbbf4eb30be8bf", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/29e1d31b2cf2720fad010f1079b679c5edfb206f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/29e1d31b2cf2720fad010f1079b679c5edfb206f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=29e1d31b2cf2720fad010f1079b679c5edfb206f", "patch": "@@ -1,3 +1,10 @@\n+2015-02-04  Mantas Mikaitis  <mantas.mikaitis@arm.com>\n+\n+\t* config/arm/arm.h (TARGET_NEON_FP): Removed conditional definition,\n+\tdefine to zero if !TARGET_NEON.\n+\t(TARGET_CPU_CPP_BUILTINS): Added second condition before defining\n+\t__ARM_FP macro.\n+\n 2015-02-04  Jan Hubicka  <hubicka@ucw.cz>\n \t    Trevor Saunders  <tsaunders@mozilla.com>\n "}, {"sha": "297dfe1ae679483e3e2a308c404a50bd8f70a0d3", "filename": "gcc/config/arm/arm.h", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/29e1d31b2cf2720fad010f1079b679c5edfb206f/gcc%2Fconfig%2Farm%2Farm.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/29e1d31b2cf2720fad010f1079b679c5edfb206f/gcc%2Fconfig%2Farm%2Farm.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.h?ref=29e1d31b2cf2720fad010f1079b679c5edfb206f", "patch": "@@ -2360,17 +2360,17 @@ extern int making_const_table;\n    point types.  Where bit 1 indicates 16-bit support, bit 2 indicates\n    32-bit support, bit 3 indicates 64-bit support.  */\n #define TARGET_ARM_FP\t\t\t\\\n-  (TARGET_VFP_SINGLE ? 4\t\t\\\n-  \t\t     : (TARGET_VFP_DOUBLE ? (TARGET_FP16 ? 14 : 12) : 0))\n+  (!TARGET_SOFT_FLOAT ? (TARGET_VFP_SINGLE ? 4\t\t\\\n+\t\t\t: (TARGET_VFP_DOUBLE ? (TARGET_FP16 ? 14 : 12) : 0)) \\\n+\t\t      : 0)\n \n \n /* Set as a bit mask indicating the available widths of floating point\n    types for hardware NEON floating point.  This is the same as\n    TARGET_ARM_FP without the 64-bit bit set.  */\n-#ifdef TARGET_NEON\n-#define TARGET_NEON_FP\t\t\\\n-  (TARGET_ARM_FP & (0xff ^ 0x08))\n-#endif\n+#define TARGET_NEON_FP\t\t\t\t \\\n+  (TARGET_NEON ? (TARGET_ARM_FP & (0xff ^ 0x08)) \\\n+\t       : 0)\n \n /* The maximum number of parallel loads or stores we support in an ldm/stm\n    instruction.  */"}, {"sha": "d8adce2f1b3682bbc8187bb9cb2e0af40d9f4ec5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/29e1d31b2cf2720fad010f1079b679c5edfb206f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/29e1d31b2cf2720fad010f1079b679c5edfb206f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=29e1d31b2cf2720fad010f1079b679c5edfb206f", "patch": "@@ -1,3 +1,9 @@\n+2015-02-05  Mantas Mikaitis  <mantas.mikaitis@arm.com>\n+\n+\t* gcc.target/arm/macro_defs0.c: New test.\n+\t* gcc.target/arm/macro_defs1.c: New test.\n+\t* gcc.target/arm/macro_defs2.c: New test.\n+\n 2015-02-05  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR rtl-optimization/64905"}, {"sha": "945eec3078613a2dd1712f3aa74411af6e4b9377", "filename": "gcc/testsuite/gcc.target/arm/macro_defs0.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/29e1d31b2cf2720fad010f1079b679c5edfb206f/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmacro_defs0.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/29e1d31b2cf2720fad010f1079b679c5edfb206f/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmacro_defs0.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmacro_defs0.c?ref=29e1d31b2cf2720fad010f1079b679c5edfb206f", "patch": "@@ -0,0 +1,12 @@\n+/* { dg-do compile } */\n+/* { dg-skip-if \"avoid conflicting multilib options\" { *-*-* } { \"-march=*\" } { \"-march=armv7-m\" } } */\n+/* { dg-skip-if \"avoid conflicting multilib options\" { target *-*-* } { \"-mfloat-abi=*\" } { \"-mfloat-abi=soft\" } } */\n+/* { dg-options \"-march=armv7-m -mcpu=cortex-m3 -mfloat-abi=soft -mthumb\" } */\n+\n+#ifdef __ARM_FP\n+#error __ARM_FP should not be defined\n+#endif\n+\n+#ifdef __ARM_NEON_FP\n+#error __ARM_NEON_FP should not be defined\n+#endif"}, {"sha": "d5423c72126ba7761841e9c6907e0c6e5e777151", "filename": "gcc/testsuite/gcc.target/arm/macro_defs1.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/29e1d31b2cf2720fad010f1079b679c5edfb206f/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmacro_defs1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/29e1d31b2cf2720fad010f1079b679c5edfb206f/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmacro_defs1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmacro_defs1.c?ref=29e1d31b2cf2720fad010f1079b679c5edfb206f", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile } */\n+/* { dg-skip-if \"avoid conflicting multilib options\" { *-*-* } { \"-march=*\" } { \"-march=armv6-m\" } } */\n+/* { dg-options \"-march=armv6-m -mthumb\" } */\n+\n+#ifdef __ARM_NEON_FP\n+#error __ARM_NEON_FP should not be defined\n+#endif\n+"}, {"sha": "9a960423562c48c1e2f8c057fc6bdf72854df555", "filename": "gcc/testsuite/gcc.target/arm/macro_defs2.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/29e1d31b2cf2720fad010f1079b679c5edfb206f/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmacro_defs2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/29e1d31b2cf2720fad010f1079b679c5edfb206f/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmacro_defs2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmacro_defs2.c?ref=29e1d31b2cf2720fad010f1079b679c5edfb206f", "patch": "@@ -0,0 +1,14 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-march=armv7ve -mcpu=cortex-a15 -mfpu=neon-vfpv4\" } */\n+/* { dg-add-options arm_neon } */\n+/* { dg-require-effective-target arm_neon_ok } */\n+\n+#ifndef __ARM_NEON_FP\n+#error  __ARM_NEON_FP is not defined but should be\n+#endif\n+\n+#ifndef __ARM_FP\n+#error  __ARM_FP is not defined but should be\n+#endif\n+\n+"}]}