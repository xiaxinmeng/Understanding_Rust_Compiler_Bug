{"sha": "4e417af354507747882f17d09c616d6e572ab0ee", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGU0MTdhZjM1NDUwNzc0Nzg4MmYxN2QwOWM2MTZkNmU1NzJhYjBlZQ==", "commit": {"author": {"name": "Kaz Kojima", "email": "kkojima@gcc.gnu.org", "date": "2015-05-04T23:25:58Z"}, "committer": {"name": "Kaz Kojima", "email": "kkojima@gcc.gnu.org", "date": "2015-05-04T23:25:58Z"}, "message": "re PR target/65987 ([SH] Wrong jump generated for gcc.dg/tree-prof/va-arg-pack-1.c with -fprofile-use)\n\nPR target/65987\n* config/sh/sh.c (output_far_jump, split_branches): Take into account\n  sectiion crossing jumps.\n\nFrom-SVN: r222783", "tree": {"sha": "357f991056108ae9200502c47ffa18e6981c664a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/357f991056108ae9200502c47ffa18e6981c664a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4e417af354507747882f17d09c616d6e572ab0ee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e417af354507747882f17d09c616d6e572ab0ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4e417af354507747882f17d09c616d6e572ab0ee", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e417af354507747882f17d09c616d6e572ab0ee/comments", "author": null, "committer": null, "parents": [{"sha": "f5322614a6fb5a0ce3cf85914e85946296271e91", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f5322614a6fb5a0ce3cf85914e85946296271e91", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f5322614a6fb5a0ce3cf85914e85946296271e91"}], "stats": {"total": 16, "additions": 15, "deletions": 1}, "files": [{"sha": "75a6d9ec5c08f14328c190a61ae9d00a207e0fdb", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e417af354507747882f17d09c616d6e572ab0ee/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e417af354507747882f17d09c616d6e572ab0ee/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4e417af354507747882f17d09c616d6e572ab0ee", "patch": "@@ -1,3 +1,9 @@\n+2015-05-04  Kaz Kojima  <kkojima@gcc.gnu.org>\n+\n+\tPR target/65987\n+\t* config/sh/sh.c (output_far_jump): Take into account crossing jumps.\n+\t(split_branches): Likewise.\n+\n 2015-05-04  Sandra Loosemore  <sandra@codesourcery.com>\n \n \t* common.opt (fdelete-null-pointer-checks): Init to -1."}, {"sha": "a4c9c4c0ba25de81c5f46e5fa88b1720c45420b6", "filename": "gcc/config/sh/sh.c", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e417af354507747882f17d09c616d6e572ab0ee/gcc%2Fconfig%2Fsh%2Fsh.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e417af354507747882f17d09c616d6e572ab0ee/gcc%2Fconfig%2Fsh%2Fsh.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsh%2Fsh.c?ref=4e417af354507747882f17d09c616d6e572ab0ee", "patch": "@@ -2747,7 +2747,8 @@ output_far_jump (rtx_insn *insn, rtx op)\n \n   if (TARGET_SH2\n       && offset >= -32764\n-      && offset - get_attr_length (insn) <= 32766)\n+      && offset - get_attr_length (insn) <= 32766\n+      && ! CROSSING_JUMP_P (insn))\n     {\n       far = 0;\n       jump =   \"mov.w\t%O0,%1\" \"\\n\"\n@@ -6753,6 +6754,13 @@ split_branches (rtx_insn *first)\n \n \t    if (type == TYPE_JUMP)\n \t      {\n+\t\tif (CROSSING_JUMP_P (insn))\n+\t\t  {\n+\t\t    emit_insn_before (gen_block_branch_redirect (const0_rtx),\n+\t\t\t\t      insn);\n+\t\t    continue;\n+\t\t  }\n+\n \t\tfar_label = as_a <rtx_insn *> (\n \t\t\t      XEXP (SET_SRC (PATTERN (insn)), 0));\n \t\tdest_uid = get_dest_uid (far_label, max_uid);"}]}