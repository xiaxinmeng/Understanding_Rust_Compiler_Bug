{"sha": "63a3cd3ec3b7c5862b0be1512fca62f6158c4df2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjNhM2NkM2VjM2I3YzU4NjJiMGJlMTUxMmZjYTYyZjYxNThjNGRmMg==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2003-02-20T19:31:38Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2003-02-20T19:31:38Z"}, "message": "re PR c++/9729 (ICE in mangle_conv_op_name_for_type, at cp/mangle.c:2612)\n\n\tPR c++/9729\n\t* g++.dg/abi/conv1.C: New test.\n\n\tPR c++/9729\n\t* mangle.c (mangle_conv_op_name_for_type): Issue an error message\n\twhen the G++ 3.2 ABI prevents correct compilation.\n\nFrom-SVN: r63176", "tree": {"sha": "ae32997dc237be62535411dc0f87af9ba650134f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ae32997dc237be62535411dc0f87af9ba650134f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/63a3cd3ec3b7c5862b0be1512fca62f6158c4df2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/63a3cd3ec3b7c5862b0be1512fca62f6158c4df2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/63a3cd3ec3b7c5862b0be1512fca62f6158c4df2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/63a3cd3ec3b7c5862b0be1512fca62f6158c4df2/comments", "author": null, "committer": null, "parents": [{"sha": "a62bfff255032cd0f08b91f2a40f22dccb39e88c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a62bfff255032cd0f08b91f2a40f22dccb39e88c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a62bfff255032cd0f08b91f2a40f22dccb39e88c"}], "stats": {"total": 39, "additions": 35, "deletions": 4}, "files": [{"sha": "8fa71adabb3ee5c4ebdc32b417617db8082ebb25", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63a3cd3ec3b7c5862b0be1512fca62f6158c4df2/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63a3cd3ec3b7c5862b0be1512fca62f6158c4df2/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=63a3cd3ec3b7c5862b0be1512fca62f6158c4df2", "patch": "@@ -1,3 +1,9 @@\n+2003-02-20  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/9729\n+\t* mangle.c (mangle_conv_op_name_for_type): Issue an error message\n+\twhen the G++ 3.2 ABI prevents correct compilation.\n+\n 2003-02-20  Nathan Sidwell  <nathan@codesourcery.com>\n \n \tChange base class access representation. Share virtual base"}, {"sha": "06d8f96828d6f1ccd254e821e7bccd21bba20452", "filename": "gcc/cp/mangle.c", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63a3cd3ec3b7c5862b0be1512fca62f6158c4df2/gcc%2Fcp%2Fmangle.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63a3cd3ec3b7c5862b0be1512fca62f6158c4df2/gcc%2Fcp%2Fmangle.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fmangle.c?ref=63a3cd3ec3b7c5862b0be1512fca62f6158c4df2", "patch": "@@ -1,5 +1,5 @@\n /* Name mangling for the 3.0 C++ ABI.\n-   Copyright (C) 2000, 2001, 2002 Free Software Foundation, Inc.\n+   Copyright (C) 2000, 2001, 2002, 2003 Free Software Foundation, Inc.\n    Written by Alex Samuel <sameul@codesourcery.com>\n \n    This file is part of GCC.\n@@ -2644,9 +2644,16 @@ mangle_conv_op_name_for_type (type)\n   free (op_name);\n \n   /* It had better be a unique mangling for the type.  */\n-  my_friendly_assert (!IDENTIFIER_TYPENAME_P (identifier)\n-\t\t      || same_type_p (type, TREE_TYPE (identifier)),\n-\t\t      20011230);\n+  if (IDENTIFIER_TYPENAME_P (identifier)\n+      && !same_type_p (type, TREE_TYPE (identifier)))\n+    {\n+      /* In G++ 3.2, the name mangling scheme was ambiguous.  In later\n+\t versions of the ABI, this problem has been fixed.  */\n+      if (abi_version_at_least (2))\n+\tabort ();\n+      error (\"due to a defect in the G++ 3.2 ABI, G++ has assigned the \"\n+\t     \"same mangled name to two different types\");\n+    }\n   \n   /* Set bits on the identifier so we know later it's a conversion.  */\n   IDENTIFIER_OPNAME_P (identifier) = 1;"}, {"sha": "603ae101b5d4905df2a317ecb08b043584fc84f5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63a3cd3ec3b7c5862b0be1512fca62f6158c4df2/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63a3cd3ec3b7c5862b0be1512fca62f6158c4df2/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=63a3cd3ec3b7c5862b0be1512fca62f6158c4df2", "patch": "@@ -1,3 +1,8 @@\n+2003-02-20  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/9729\n+\t* g++.dg/abi/conv1.C: New test.\n+\n Thu Feb 20 14:38:13 CET 2003  Jan Hubicka  <jh@suse.cz>\n \n \t* gcc.c-torture/execute/20020720-1.x: XFAIL for x86-64."}, {"sha": "fdedea20b13a72395e7bd2023cba35460153df2d", "filename": "gcc/testsuite/g++.dg/abi/conv1.C", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63a3cd3ec3b7c5862b0be1512fca62f6158c4df2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fabi%2Fconv1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63a3cd3ec3b7c5862b0be1512fca62f6158c4df2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fabi%2Fconv1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fabi%2Fconv1.C?ref=63a3cd3ec3b7c5862b0be1512fca62f6158c4df2", "patch": "@@ -0,0 +1,13 @@\n+// { dg-options \"-fabi-version=1\" }\n+\n+template<class T1>\n+struct A {\n+  typedef typename T1::X X;\n+  operator X() const;\n+};\n+\n+template <class T0, class T1 >\n+struct B {\n+  typedef typename T1::X X;\n+  operator X() const; // { dg-error \"\" }\n+};"}]}