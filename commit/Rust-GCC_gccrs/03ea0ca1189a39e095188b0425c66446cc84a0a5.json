{"sha": "03ea0ca1189a39e095188b0425c66446cc84a0a5", "node_id": "C_kwDOANBUbNoAKDAzZWEwY2ExMTg5YTM5ZTA5NTE4OGIwNDI1YzY2NDQ2Y2M4NGEwYTU", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2021-11-30T19:21:31Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2021-11-30T22:49:04Z"}, "message": "analyzer: verify that -Wanalyzer-too-complex can be disabled via pragmas [PR100524]\n\ngcc/testsuite/ChangeLog:\n\tPR analyzer/100524\n\t* gcc.dg/analyzer/pragma-2.c: New test.\n\nSigned-off-by: David Malcolm <dmalcolm@redhat.com>", "tree": {"sha": "1cf813b5fd4f1a9a255e46161556a789cb8cdd8d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1cf813b5fd4f1a9a255e46161556a789cb8cdd8d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/03ea0ca1189a39e095188b0425c66446cc84a0a5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03ea0ca1189a39e095188b0425c66446cc84a0a5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/03ea0ca1189a39e095188b0425c66446cc84a0a5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03ea0ca1189a39e095188b0425c66446cc84a0a5/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6b8ecbc6d6652d061d7c72c64352d51eca2df6ca", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6b8ecbc6d6652d061d7c72c64352d51eca2df6ca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6b8ecbc6d6652d061d7c72c64352d51eca2df6ca"}], "stats": {"total": 57, "additions": 57, "deletions": 0}, "files": [{"sha": "58fcaab11df5233bf46d575c69255ae2bebeb4c7", "filename": "gcc/testsuite/gcc.dg/analyzer/pragma-2.c", "status": "added", "additions": 57, "deletions": 0, "changes": 57, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03ea0ca1189a39e095188b0425c66446cc84a0a5/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpragma-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03ea0ca1189a39e095188b0425c66446cc84a0a5/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpragma-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpragma-2.c?ref=03ea0ca1189a39e095188b0425c66446cc84a0a5", "patch": "@@ -0,0 +1,57 @@\n+/* Verify that we can disable -Wanalyzer-too-complex via pragmas.  */\n+/* { dg-additional-options \"-Wanalyzer-too-complex -Werror=analyzer-too-complex -fno-analyzer-state-merge -g\" } */\n+\n+#include <stdlib.h>\n+\n+extern int get (void);\n+\n+/* In theory each of p0...p4 can be in various malloc states,\n+   independently, so the total combined number of states\n+   at any program point within the loop is NUM_VARS * NUM_STATES.  */\n+\n+#pragma GCC diagnostic push\n+#pragma GCC diagnostic ignored \"-Wanalyzer-too-complex\"\n+\n+void test (void)\n+{\n+  void *p0 = NULL, *p1 = NULL, *p2 = NULL, *p3 = NULL, *p4 = NULL;\n+  void **pp = NULL;\n+  while (get ())\n+    {\n+      switch (get ())\n+\t{\n+\tdefault:\n+\tcase 0:\n+\t  pp = &p0;\n+\t  break;\n+\tcase 1:\n+\t  pp = &p1;\n+\t  break;\n+\tcase 2:\n+\t  pp = &p2;\n+\t  break;\n+\tcase 3:\n+\t  pp = &p3;\n+\t  break;\n+\tcase 4:\n+\t  pp = &p4;\n+\t  break;\n+\t}\n+\n+      switch (get ())\n+\t{\n+\tdefault:\n+\tcase 0:\n+\t  *pp = malloc (16); /* { dg-warning \"leak\" } */\n+\t  break;\n+\tcase 1:\n+\t  free (*pp);\n+\t  break;\n+\tcase 2:\n+\t  /* no-op.  */\n+\t  break;\n+\t}\n+    }\n+}\n+\n+#pragma GCC diagnostic pop"}]}