{"sha": "444751385724c1ed44e29047bfd96bcdba91f522", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDQ0NzUxMzg1NzI0YzFlZDQ0ZTI5MDQ3YmZkOTZiY2RiYTkxZjUyMg==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@vlsi1.ultra.nyu.edu", "date": "2000-10-20T17:51:52Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "2000-10-20T17:51:52Z"}, "message": "fold-const.c (force_fit_type): Unsigned values can overflow if they are sizetype.\n\n\t* fold-const.c (force_fit_type): Unsigned values can overflow\n\tif they are sizetype.\n\t(int_const_binop): Don't use cache if overflows.\n\t* cp/typeck.c (dubious_conversion_warning): Suppress if\n\tTYPE_IS_SIZETYPE.\n\nFrom-SVN: r36970", "tree": {"sha": "0179fd011caa1eb6eecaae68b203054a3ee3c1c4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0179fd011caa1eb6eecaae68b203054a3ee3c1c4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/444751385724c1ed44e29047bfd96bcdba91f522", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/444751385724c1ed44e29047bfd96bcdba91f522", "html_url": "https://github.com/Rust-GCC/gccrs/commit/444751385724c1ed44e29047bfd96bcdba91f522", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/444751385724c1ed44e29047bfd96bcdba91f522/comments", "author": null, "committer": null, "parents": [{"sha": "23ccfa6dbb713011bc4445e74c5b243673f86620", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23ccfa6dbb713011bc4445e74c5b243673f86620", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23ccfa6dbb713011bc4445e74c5b243673f86620"}], "stats": {"total": 30, "additions": 26, "deletions": 4}, "files": [{"sha": "eab623841c26dde2c6a5c504b61d6c8ab829ae68", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/444751385724c1ed44e29047bfd96bcdba91f522/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/444751385724c1ed44e29047bfd96bcdba91f522/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=444751385724c1ed44e29047bfd96bcdba91f522", "patch": "@@ -1,3 +1,8 @@\n+Fri Oct 20 13:33:16 2000  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>\n+\n+\t* fold-const.c (force_fit_type): Unsigned values can overflow\n+\tif they are sizetype.\n+\t(int_const_binop): Don't use cache if overflows.\n 2000-10-20  Richard Henderson  <rth@cygnus.com>\n \n \t* function.c (locate_and_pad_parm): Zero alignment_pad."}, {"sha": "3c2e244fb903d4d3556fa1572a8074e69020b432", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/444751385724c1ed44e29047bfd96bcdba91f522/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/444751385724c1ed44e29047bfd96bcdba91f522/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=444751385724c1ed44e29047bfd96bcdba91f522", "patch": "@@ -1,3 +1,7 @@\n+Fri Oct 20 13:54:59 2000  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>\n+\n+\t* typeck.c (dubious_conversion_warning): Suppress if TYPE_IS_SIZETYPE.\n+\n 2000-10-20  Jeffrey Oldham  <oldham@codesourcery.com>\n \n \t* decl.c (revert_static_member_fn): Fixed typo."}, {"sha": "d72d8e6c00df65ce0eb7844c6978beb4da683455", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/444751385724c1ed44e29047bfd96bcdba91f522/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/444751385724c1ed44e29047bfd96bcdba91f522/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=444751385724c1ed44e29047bfd96bcdba91f522", "patch": "@@ -6353,7 +6353,16 @@ dubious_conversion_warnings (type, expr, errtype, fndecl, parmnum)\n \t    cp_warning (\"%s of negative value `%E' to `%T'\",\n \t\t\terrtype, expr, type);\n \t}\n-      overflow_warning (expr);\n+\n+      /* Suppress warning for a sizetype since we never used to issue it.\n+\t ??? This needs to be looked at more carefully someday.  */\n+      if (TREE_CODE (expr) == INTEGER_CST\n+\t  && TREE_CODE (TREE_TYPE (expr)) == INTEGER_TYPE\n+\t  && TYPE_IS_SIZETYPE (TREE_TYPE (expr)))\n+\tTREE_OVERFLOW (expr) = TREE_CONSTANT_OVERFLOW (expr) = 0;\n+      else\n+\toverflow_warning (expr);\n+\n       if (TREE_CONSTANT (expr))\n \texpr = fold (expr);\n     }"}, {"sha": "efd1055b9e21b24f6be7c68d95e8d9fca72cd1ed", "filename": "gcc/fold-const.c", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/444751385724c1ed44e29047bfd96bcdba91f522/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/444751385724c1ed44e29047bfd96bcdba91f522/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=444751385724c1ed44e29047bfd96bcdba91f522", "patch": "@@ -216,8 +216,11 @@ force_fit_type (t, overflow)\n \tTREE_INT_CST_LOW (t) &= ~((unsigned HOST_WIDE_INT) (-1) << prec);\n     }\n \n-  /* Unsigned types do not suffer sign extension or overflow.  */\n-  if (TREE_UNSIGNED (TREE_TYPE (t)))\n+  /* Unsigned types do not suffer sign extension or overflow unless they\n+     are a sizetype.  */\n+  if (TREE_UNSIGNED (TREE_TYPE (t))\n+      && ! (TREE_CODE (TREE_TYPE (t)) == INTEGER_TYPE\n+\t    && TYPE_IS_SIZETYPE (TREE_TYPE (t))))\n     return overflow;\n \n   /* If the value's sign bit is set, extend the sign.  */\n@@ -1604,7 +1607,8 @@ int_const_binop (code, arg1, arg2, notrunc, forsize)\n       abort ();\n     }\n \n-  if (forsize && hi == 0 && low < 10000)\n+  if (forsize && hi == 0 && low < 10000\n+      && overflow == 0 && ! TREE_OVERFLOW (arg1) && ! TREE_OVERFLOW (arg2))\n     return size_int_type_wide (low, TREE_TYPE (arg1));\n   else\n     {"}]}