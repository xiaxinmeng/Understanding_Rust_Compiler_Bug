{"sha": "dafa8871d1c8c0375763a36a63cc31fee6c0af1c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGFmYTg4NzFkMWM4YzAzNzU3NjNhMzZhNjNjYzMxZmVlNmMwYWYxYw==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@suse.de", "date": "2004-10-09T08:23:02Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2004-10-09T08:23:02Z"}, "message": "std_memory.h (__get_temporary_buffer): Don't use INT_MAX...\n\n2004-10-09  Paolo Carlini  <pcarlini@suse.de>\n\n\t* include/std/std_memory.h (__get_temporary_buffer): Don't use\n\tINT_MAX, prefer numeric_limits<ptrdiff_t>::max(), ok on 64-bit\n\tplatforms too.\n\t* testsuite/20_util/memory/auto_ptr/assign_neg.cc: Adjust dg-error\n\tline numbers.\n\nFrom-SVN: r88814", "tree": {"sha": "06aec861b66855d311549b98914b1cee7d0e5e75", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/06aec861b66855d311549b98914b1cee7d0e5e75"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dafa8871d1c8c0375763a36a63cc31fee6c0af1c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dafa8871d1c8c0375763a36a63cc31fee6c0af1c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dafa8871d1c8c0375763a36a63cc31fee6c0af1c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dafa8871d1c8c0375763a36a63cc31fee6c0af1c/comments", "author": null, "committer": null, "parents": [{"sha": "c3e7f18406f1869604b48b03f8a1e39123885362", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c3e7f18406f1869604b48b03f8a1e39123885362", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c3e7f18406f1869604b48b03f8a1e39123885362"}], "stats": {"total": 20, "additions": 15, "deletions": 5}, "files": [{"sha": "19be8461c17a350b955b4fd31373992c64b297a4", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dafa8871d1c8c0375763a36a63cc31fee6c0af1c/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dafa8871d1c8c0375763a36a63cc31fee6c0af1c/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=dafa8871d1c8c0375763a36a63cc31fee6c0af1c", "patch": "@@ -1,3 +1,11 @@\n+2004-10-09  Paolo Carlini  <pcarlini@suse.de>\n+\n+\t* include/std/std_memory.h (__get_temporary_buffer): Don't use\n+\tINT_MAX, prefer numeric_limits<ptrdiff_t>::max(), ok on 64-bit\n+\tplatforms too.\n+\t* testsuite/20_util/memory/auto_ptr/assign_neg.cc: Adjust dg-error\n+\tline numbers.\n+\n 2004-10-08  Benjamin Kosnik  <bkoz@redhat.com>\n \n \t* acconfig.h: Add _GLIBCXX_USE___CXA_ATEXIT."}, {"sha": "1d278e6cb8688bdb69125a3cc861c31777a51875", "filename": "libstdc++-v3/include/std/std_memory.h", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dafa8871d1c8c0375763a36a63cc31fee6c0af1c/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstd_memory.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dafa8871d1c8c0375763a36a63cc31fee6c0af1c/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstd_memory.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstd_memory.h?ref=dafa8871d1c8c0375763a36a63cc31fee6c0af1c", "patch": "@@ -58,6 +58,7 @@\n #include <bits/stl_uninitialized.h>\n #include <bits/stl_raw_storage_iter.h>\n #include <debug/debug.h>\n+#include <limits>\n \n namespace std\n {\n@@ -73,8 +74,9 @@ namespace std\n     pair<_Tp*, ptrdiff_t>\n     __get_temporary_buffer(ptrdiff_t __len, _Tp*)\n     {\n-      if (__len > ptrdiff_t(INT_MAX / sizeof(_Tp)))\n-\t__len = INT_MAX / sizeof(_Tp);\n+      const ptrdiff_t __max = numeric_limits<ptrdiff_t>::max() / sizeof(_Tp);\n+      if (__len > __max)\n+\t__len = __max;\n       \n       while (__len > 0) \n \t{\n@@ -105,7 +107,7 @@ namespace std\n    * Provides the nothrow exception guarantee.\n    */\n   template<typename _Tp>\n-    inline pair<_Tp*,ptrdiff_t>\n+    inline pair<_Tp*, ptrdiff_t>\n     get_temporary_buffer(ptrdiff_t __len)\n     { return std::__get_temporary_buffer(__len, static_cast<_Tp*>(0)); }\n "}, {"sha": "fc4ba5b90fd35b5b3b3a77413932e344906a9795", "filename": "libstdc++-v3/testsuite/20_util/memory/auto_ptr/assign_neg.cc", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dafa8871d1c8c0375763a36a63cc31fee6c0af1c/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmemory%2Fauto_ptr%2Fassign_neg.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dafa8871d1c8c0375763a36a63cc31fee6c0af1c/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmemory%2Fauto_ptr%2Fassign_neg.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fmemory%2Fauto_ptr%2Fassign_neg.cc?ref=dafa8871d1c8c0375763a36a63cc31fee6c0af1c", "patch": "@@ -46,5 +46,5 @@ main()\n   test01();\n   return 0;\n }\n-// { dg-error \"candidates\" \"\" { target *-*-* } 222 } \n-// { dg-error \"std::auto_ptr\" \"\" { target *-*-* } 352 } \n+// { dg-error \"candidates\" \"\" { target *-*-* } 224 } \n+// { dg-error \"std::auto_ptr\" \"\" { target *-*-* } 354 } "}]}