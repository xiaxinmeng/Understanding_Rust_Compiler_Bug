{"sha": "4453a8221c65f386ae361670fa932643521374d7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDQ1M2E4MjIxYzY1ZjM4NmFlMzYxNjcwZmE5MzI2NDM1MjEzNzRkNw==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2018-09-26T09:17:10Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2018-09-26T09:17:10Z"}, "message": "[Ada] ICE on array of task type with -gnatct\n\n2018-09-26  Eric Botcazou  <ebotcazou@adacore.com>\n\ngcc/ada/\n\n\t* gcc-interface/decl.c (gnat_to_gnu_entity) <E_Task_Type>: In\n\t-gnatct mode, process the discriminants only for a definition.\n\nFrom-SVN: r264610", "tree": {"sha": "c850eabac3831d3e202d4306c31e234753c2d2d4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c850eabac3831d3e202d4306c31e234753c2d2d4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4453a8221c65f386ae361670fa932643521374d7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4453a8221c65f386ae361670fa932643521374d7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4453a8221c65f386ae361670fa932643521374d7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4453a8221c65f386ae361670fa932643521374d7/comments", "author": null, "committer": null, "parents": [{"sha": "81d85d4baeb6ada71652a556cec1663511c3933c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81d85d4baeb6ada71652a556cec1663511c3933c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/81d85d4baeb6ada71652a556cec1663511c3933c"}], "stats": {"total": 8, "additions": 7, "deletions": 1}, "files": [{"sha": "a0252f8d1afb31eb511201c8258c97039296844c", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4453a8221c65f386ae361670fa932643521374d7/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4453a8221c65f386ae361670fa932643521374d7/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=4453a8221c65f386ae361670fa932643521374d7", "patch": "@@ -1,3 +1,8 @@\n+2018-09-26  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc-interface/decl.c (gnat_to_gnu_entity) <E_Task_Type>: In\n+\t-gnatct mode, process the discriminants only for a definition.\n+\n 2018-09-26  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* repinfo.adb (List_Record_Layout): Be prepared for JSON output."}, {"sha": "8dd62f73d5e18cbaec5ab5a5bd0b21fb250383e2", "filename": "gcc/ada/gcc-interface/decl.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4453a8221c65f386ae361670fa932643521374d7/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4453a8221c65f386ae361670fa932643521374d7/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Fdecl.c?ref=4453a8221c65f386ae361670fa932643521374d7", "patch": "@@ -4158,7 +4158,8 @@ gnat_to_gnu_entity (Entity_Id gnat_entity, tree gnu_expr, bool definition)\n \t part of the associated body so they need to be translated.  */\n       if (type_annotate_only && gnat_equiv_type == gnat_entity)\n \t{\n-\t  if (Has_Discriminants (gnat_entity)\n+\t  if (definition\n+\t      && Has_Discriminants (gnat_entity)\n \t      && Root_Type (gnat_entity) == gnat_entity)\n \t    {\n \t      tree gnu_field_list = NULL_TREE;"}]}