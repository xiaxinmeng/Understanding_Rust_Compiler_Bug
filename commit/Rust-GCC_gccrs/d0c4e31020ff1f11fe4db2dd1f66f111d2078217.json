{"sha": "d0c4e31020ff1f11fe4db2dd1f66f111d2078217", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDBjNGUzMTAyMGZmMWYxMWZlNGRiMmRkMWY2NmYxMTFkMjA3ODIxNw==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2013-02-06T20:20:08Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2013-02-06T20:20:08Z"}, "message": "re PR fortran/55789 (Needless realloc with array constructor.)\n\n2013-02-06 Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/55789\n\t* trans-array.c (trans_array_constructor): Remove condition\n\t'dynamic' = true if the loop ubound is a VAR_DECL.\n\n2013-02-06 Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/55789\n\t* gfortran.dg/array_constructor_41.f90: New test.\n\nFrom-SVN: r195815", "tree": {"sha": "f118b59c3cb9e7f2b5f9c44077d02a4297f76ba1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f118b59c3cb9e7f2b5f9c44077d02a4297f76ba1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d0c4e31020ff1f11fe4db2dd1f66f111d2078217", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d0c4e31020ff1f11fe4db2dd1f66f111d2078217", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d0c4e31020ff1f11fe4db2dd1f66f111d2078217", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d0c4e31020ff1f11fe4db2dd1f66f111d2078217/comments", "author": null, "committer": null, "parents": [{"sha": "c362c6741d4511d76d00b3c7c732838539c11a75", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c362c6741d4511d76d00b3c7c732838539c11a75", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c362c6741d4511d76d00b3c7c732838539c11a75"}], "stats": {"total": 47, "additions": 44, "deletions": 3}, "files": [{"sha": "90987da2238e660ea79b2417a77c4edb5d4418cd", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d0c4e31020ff1f11fe4db2dd1f66f111d2078217/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d0c4e31020ff1f11fe4db2dd1f66f111d2078217/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=d0c4e31020ff1f11fe4db2dd1f66f111d2078217", "patch": "@@ -1,3 +1,9 @@\n+2013-02-06 Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/55789\n+\t* trans-array.c (trans_array_constructor): Remove condition\n+\t'dynamic' = true if the loop ubound is a VAR_DECL.\n+\n 2013-02-04  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/56008"}, {"sha": "ee2954e5bcab0a9dd48503d9580fa89158e1a676", "filename": "gcc/fortran/trans-array.c", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d0c4e31020ff1f11fe4db2dd1f66f111d2078217/gcc%2Ffortran%2Ftrans-array.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d0c4e31020ff1f11fe4db2dd1f66f111d2078217/gcc%2Ffortran%2Ftrans-array.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-array.c?ref=d0c4e31020ff1f11fe4db2dd1f66f111d2078217", "patch": "@@ -2307,9 +2307,6 @@ trans_array_constructor (gfc_ss * ss, locus * where)\n \t}\n     }\n \n-  if (TREE_CODE (*loop_ubound0) == VAR_DECL)\n-    dynamic = true;\n-\n   gfc_trans_create_temp_array (&outer_loop->pre, &outer_loop->post, ss, type,\n \t\t\t       NULL_TREE, dynamic, true, false, where);\n "}, {"sha": "219b12a6e7557bb11c0faeca695b6d6e6a379260", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d0c4e31020ff1f11fe4db2dd1f66f111d2078217/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d0c4e31020ff1f11fe4db2dd1f66f111d2078217/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d0c4e31020ff1f11fe4db2dd1f66f111d2078217", "patch": "@@ -1,3 +1,8 @@\n+2013-02-06 Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/55789\n+\t* gfortran.dg/array_constructor_41.f90: New test.\n+\n 2013-02-06  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/55978"}, {"sha": "eb5fd92a1eea6fa631ea7ec2aa98a4e306220f9e", "filename": "gcc/testsuite/gfortran.dg/array_constructor_41.f90", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d0c4e31020ff1f11fe4db2dd1f66f111d2078217/gcc%2Ftestsuite%2Fgfortran.dg%2Farray_constructor_41.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d0c4e31020ff1f11fe4db2dd1f66f111d2078217/gcc%2Ftestsuite%2Fgfortran.dg%2Farray_constructor_41.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Farray_constructor_41.f90?ref=d0c4e31020ff1f11fe4db2dd1f66f111d2078217", "patch": "@@ -0,0 +1,33 @@\n+! { dg-do compile }\n+! { dg-options \"-fdump-tree-original\" }\n+! Test fix for PR55789\n+!\n+! Contributed by Joost VandVandole  <Joost.VandeVondele@mat.ethz.ch>\n+!\n+MODULE M1\n+CONTAINS\n+  SUBROUTINE cp_1d_i4_sort(arr)\n+      INTEGER(kind=4), DIMENSION(:), &\n+        INTENT(inout)                          :: arr\n+      arr = (/ (i, i = 1, SIZE(arr)) /)\n+  END SUBROUTINE\n+END MODULE M1\n+\n+PROGRAM TEST\n+  USE M1\n+  INTEGER :: arr(1)\n+  INTERFACE\n+    SUBROUTINE mtrace() BIND(C,name=\"mtrace\")\n+    END SUBROUTINE\n+  END INTERFACE\n+  INTERFACE\n+    SUBROUTINE muntrace() BIND(C,name=\"muntrace\")\n+    END SUBROUTINE\n+  END INTERFACE\n+  CALL mtrace()\n+  CALL cp_1d_i4_sort(arr)\n+  CALL muntrace()\n+END\n+\n+! { dg-final { scan-tree-dump-times \"realloc\" 0 \"original\" } }\n+! { dg-final { cleanup-tree-dump \"original\" } }"}]}