{"sha": "4581328022615c2cb732cfb404151c4b059d26e3", "node_id": "C_kwDOANBUbNoAKDQ1ODEzMjgwMjI2MTVjMmNiNzMyY2ZiNDA0MTUxYzRiMDU5ZDI2ZTM", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-11-24T21:36:07Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-11-25T00:22:01Z"}, "message": "libstdc++: Change return type of std::bit_width to int (LWG 3656)\n\nlibstdc++-v3/ChangeLog:\n\n\t* doc/html/manual/bugs.html: Regenerate.\n\t* doc/xml/manual/intro.xml: Document LWG 3656 change.\n\t* include/std/bit (__bit_width, bit_width): Return int.\n\t* testsuite/26_numerics/bit/bit.pow.two/lwg3656.cc: New test.", "tree": {"sha": "e3971d4a2d99398ff66c9797a514778994913f33", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e3971d4a2d99398ff66c9797a514778994913f33"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4581328022615c2cb732cfb404151c4b059d26e3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4581328022615c2cb732cfb404151c4b059d26e3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4581328022615c2cb732cfb404151c4b059d26e3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4581328022615c2cb732cfb404151c4b059d26e3/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3892251498c16c9507cf8471f4f10676212e9ead", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3892251498c16c9507cf8471f4f10676212e9ead", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3892251498c16c9507cf8471f4f10676212e9ead"}], "stats": {"total": 32, "additions": 30, "deletions": 2}, "files": [{"sha": "c4a2c26ea3915677881a6667c14a6567d2a01aa6", "filename": "libstdc++-v3/doc/html/manual/bugs.html", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4581328022615c2cb732cfb404151c4b059d26e3/libstdc%2B%2B-v3%2Fdoc%2Fhtml%2Fmanual%2Fbugs.html", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4581328022615c2cb732cfb404151c4b059d26e3/libstdc%2B%2B-v3%2Fdoc%2Fhtml%2Fmanual%2Fbugs.html", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fdoc%2Fhtml%2Fmanual%2Fbugs.html?ref=4581328022615c2cb732cfb404151c4b059d26e3", "patch": "@@ -619,4 +619,8 @@\n \t<span class=\"bold\"><strong><code class=\"code\">path::lexically_relative</code> is confused by trailing slashes\n \t</strong></span>\n     </span></dt><dd><p>Implement the fix for trailing slashes.\n+    </p></dd><dt><a id=\"manual.bugs.dr3656\"></a><span class=\"term\"><a class=\"link\" href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/lwg-defects.html#3656\" target=\"_top\">3656</a>:\n+\t<span class=\"bold\"><strong>Inconsistent bit operations returning a count\n+\t</strong></span>\n+    </span></dt><dd><p>Changed <code class=\"code\">bit_width</code> to return <code class=\"code\">int</code>.\n     </p></dd></dl></div></div></div><div class=\"navfooter\"><hr /><table width=\"100%\" summary=\"Navigation footer\"><tr><td width=\"40%\" align=\"left\"><a accesskey=\"p\" href=\"license.html\">Prev</a>\u00a0</td><td width=\"20%\" align=\"center\"><a accesskey=\"u\" href=\"status.html\">Up</a></td><td width=\"40%\" align=\"right\">\u00a0<a accesskey=\"n\" href=\"setup.html\">Next</a></td></tr><tr><td width=\"40%\" align=\"left\" valign=\"top\">License\u00a0</td><td width=\"20%\" align=\"center\"><a accesskey=\"h\" href=\"../index.html\">Home</a></td><td width=\"40%\" align=\"right\" valign=\"top\">\u00a0Chapter\u00a02.\u00a0Setup</td></tr></table></div></body></html>\n\\ No newline at end of file"}, {"sha": "aee96e37c6180a56726bf4aa7b9652588160742b", "filename": "libstdc++-v3/doc/xml/manual/intro.xml", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4581328022615c2cb732cfb404151c4b059d26e3/libstdc%2B%2B-v3%2Fdoc%2Fxml%2Fmanual%2Fintro.xml", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4581328022615c2cb732cfb404151c4b059d26e3/libstdc%2B%2B-v3%2Fdoc%2Fxml%2Fmanual%2Fintro.xml", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fdoc%2Fxml%2Fmanual%2Fintro.xml?ref=4581328022615c2cb732cfb404151c4b059d26e3", "patch": "@@ -1308,6 +1308,13 @@ requirements of the license of GCC.\n     <listitem><para>Implement the fix for trailing slashes.\n     </para></listitem></varlistentry>\n \n+    <varlistentry xml:id=\"manual.bugs.dr3656\"><term><link xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"&DR;#3656\">3656</link>:\n+\t<emphasis role=\"bold\">Inconsistent bit operations returning a count\n+\t</emphasis>\n+    </term>\n+    <listitem><para>Changed <code>bit_width</code> to return <code>int</code>.\n+    </para></listitem></varlistentry>\n+\n   </variablelist>\n \n  </section>"}, {"sha": "3e072ef21133a3925bd96c474c2ef25878f704f2", "filename": "libstdc++-v3/include/std/bit", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4581328022615c2cb732cfb404151c4b059d26e3/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fbit", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4581328022615c2cb732cfb404151c4b059d26e3/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fbit", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fbit?ref=4581328022615c2cb732cfb404151c4b059d26e3", "patch": "@@ -361,7 +361,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n     }\n \n   template<typename _Tp>\n-    constexpr _Tp\n+    constexpr int\n     __bit_width(_Tp __x) noexcept\n     {\n       constexpr auto _Nd = __gnu_cxx::__int_traits<_Tp>::__digits;\n@@ -448,9 +448,11 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n     bit_floor(_Tp __x) noexcept\n     { return std::__bit_floor(__x); }\n \n+  // _GLIBCXX_RESOLVE_LIB_DEFECTS\n+  // 3656. Inconsistent bit operations returning a count\n   /// The smallest integer greater than the base-2 logarithm of `x`.\n   template<typename _Tp>\n-    constexpr _If_is_unsigned_integer<_Tp>\n+    constexpr _If_is_unsigned_integer<_Tp, int>\n     bit_width(_Tp __x) noexcept\n     { return std::__bit_width(__x); }\n "}, {"sha": "4752c3b1d33ba3eac500551589fa40c4a87dcb02", "filename": "libstdc++-v3/testsuite/26_numerics/bit/bit.pow.two/lwg3656.cc", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4581328022615c2cb732cfb404151c4b059d26e3/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Fbit%2Fbit.pow.two%2Flwg3656.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4581328022615c2cb732cfb404151c4b059d26e3/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Fbit%2Fbit.pow.two%2Flwg3656.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Fbit%2Fbit.pow.two%2Flwg3656.cc?ref=4581328022615c2cb732cfb404151c4b059d26e3", "patch": "@@ -0,0 +1,15 @@\n+// { dg-options \"-std=gnu++20\" }\n+// { dg-do compile { target c++20 } }\n+\n+#include <bit>\n+\n+template<typename T> constexpr bool is_int = false;\n+template<> constexpr bool is_int<int> = true;\n+\n+// LWG 3656. Inconsistent bit operations returning a count\n+// Rturn type of std::bit_width(T) changed from T to int.\n+static_assert( is_int<decltype(std::bit_width(1u))> );\n+static_assert( is_int<decltype(std::bit_width(1ul))> );\n+static_assert( is_int<decltype(std::bit_width(1ull))> );\n+static_assert( is_int<decltype(std::bit_width((unsigned short)1))> );\n+static_assert( is_int<decltype(std::bit_width((unsigned char)1))> );"}]}