{"sha": "3b1cce6ac1ed8fe740b0b1730bb6bbb63304f1e3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2IxY2NlNmFjMWVkOGZlNzQwYjBiMTczMGJiNmJiYjYzMzA0ZjFlMw==", "commit": {"author": {"name": "Steven Bosscher", "email": "stevenb@suse.de", "date": "2004-06-18T19:38:27Z"}, "committer": {"name": "Steven Bosscher", "email": "steven@gcc.gnu.org", "date": "2004-06-18T19:38:27Z"}, "message": "* config/xtensa/xtensa.c\n\t(TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE): Define.\n\t* xtensa.md: Replace the old pipeline description with a DFA model.\n\nFrom-SVN: r83358", "tree": {"sha": "38be8bf8c039475e5f43a97b37647431235b127c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/38be8bf8c039475e5f43a97b37647431235b127c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3b1cce6ac1ed8fe740b0b1730bb6bbb63304f1e3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3b1cce6ac1ed8fe740b0b1730bb6bbb63304f1e3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3b1cce6ac1ed8fe740b0b1730bb6bbb63304f1e3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3b1cce6ac1ed8fe740b0b1730bb6bbb63304f1e3/comments", "author": null, "committer": null, "parents": [{"sha": "ab3d88bed12beabdc31b9f8808da9dab0a3dae64", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab3d88bed12beabdc31b9f8808da9dab0a3dae64", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ab3d88bed12beabdc31b9f8808da9dab0a3dae64"}], "stats": {"total": 44, "additions": 37, "deletions": 7}, "files": [{"sha": "014cb1cae8f474b297b730a8b6c45398b0e85f86", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b1cce6ac1ed8fe740b0b1730bb6bbb63304f1e3/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b1cce6ac1ed8fe740b0b1730bb6bbb63304f1e3/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3b1cce6ac1ed8fe740b0b1730bb6bbb63304f1e3", "patch": "@@ -1,3 +1,9 @@\n+2004-06-18  Steven Bosscher  <stevenb@suse.de>\n+\n+\t* config/xtensa/xtensa.c\n+\t(TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE): Define.\n+\t* xtensa.md: Replace the old pipeline description with a DFA model.\n+\n 2004-06-18  Steven Bosscher  <stevenb@suse.de>\n \t    Ulrich Weigand <Ulrich.Weigand@de.ibm.com>\n "}, {"sha": "e062fd9c2224103f4d5e758c77d5dc4a31707c69", "filename": "gcc/config/xtensa/xtensa.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b1cce6ac1ed8fe740b0b1730bb6bbb63304f1e3/gcc%2Fconfig%2Fxtensa%2Fxtensa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b1cce6ac1ed8fe740b0b1730bb6bbb63304f1e3/gcc%2Fconfig%2Fxtensa%2Fxtensa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Fxtensa.c?ref=3b1cce6ac1ed8fe740b0b1730bb6bbb63304f1e3", "patch": "@@ -259,6 +259,9 @@ static const int reg_nonleaf_alloc_order[FIRST_PSEUDO_REGISTER] =\n #undef TARGET_RETURN_IN_MSB\n #define TARGET_RETURN_IN_MSB xtensa_return_in_msb\n \n+#undef TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE\n+#define TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE hook_int_void_1\n+\n struct gcc_target targetm = TARGET_INITIALIZER;\n \f\n "}, {"sha": "2bb2672861f986d544d134f9f75855d55662b6aa", "filename": "gcc/config/xtensa/xtensa.md", "status": "modified", "additions": 28, "deletions": 7, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b1cce6ac1ed8fe740b0b1730bb6bbb63304f1e3/gcc%2Fconfig%2Fxtensa%2Fxtensa.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b1cce6ac1ed8fe740b0b1730bb6bbb63304f1e3/gcc%2Fconfig%2Fxtensa%2Fxtensa.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Fxtensa.md?ref=3b1cce6ac1ed8fe740b0b1730bb6bbb63304f1e3", "patch": "@@ -52,20 +52,41 @@\n   [(set_attr \"type\" \"multi\")])\n \n \f\n-;; Functional units.\n+;; Pipeline model.\n \n-(define_function_unit \"memory\" 1 0 (eq_attr \"type\" \"load,fload\") 2 0)\n+;; The Xtensa basically has simple 5-stage RISC pipeline.\n+;; Most instructions complete in 1 cycle, and it is OK to assume that\n+;; everything is fully pipelined.  The exceptions have special insn\n+;; reservations in the pipeline description below.  The Xtensa can\n+;; issue one instruction per cycle, so defining CPU units is unnecessary.\n \n-(define_function_unit \"sreg\" 1 1 (eq_attr \"type\" \"rsr\") 2 0)\n+(define_insn_reservation \"xtensa_any_insn\" 1\n+\t\t\t (eq_attr \"type\" \"!load,fload,rsr,mul16,mul32,fmadd,fconv\")\n+\t\t\t \"nothing\")\n \n-(define_function_unit \"mul16\" 1 0 (eq_attr \"type\" \"mul16\") 2 0)\n+(define_insn_reservation \"xtensa_memory\" 2\n+\t\t\t (eq_attr \"type\" \"load,fload\")\n+\t\t\t \"nothing\")\n \n-(define_function_unit \"mul32\" 1 0 (eq_attr \"type\" \"mul32\") 2 0)\n+(define_insn_reservation \"xtensa_sreg\" 2\n+\t\t\t (eq_attr \"type\" \"rsr\")\n+\t\t\t \"nothing\")\n \n-(define_function_unit \"fpmadd\" 1 0 (eq_attr \"type\" \"fmadd\") 4 0)\n+(define_insn_reservation \"xtensa_mul16\" 2\n+\t\t\t (eq_attr \"type\" \"mul16\")\n+\t\t\t \"nothing\")\n \n-(define_function_unit \"fpconv\" 1 0 (eq_attr \"type\" \"fconv\") 2 0)\n+(define_insn_reservation \"xtensa_mul32\" 2\n+\t\t\t (eq_attr \"type\" \"mul32\")\n+\t\t\t \"nothing\")\n \n+(define_insn_reservation \"xtensa_fmadd\" 4\n+\t\t\t (eq_attr \"type\" \"fmadd\")\n+\t\t\t \"nothing\")\n+\n+(define_insn_reservation \"xtensa_fconv\" 2\n+\t\t\t (eq_attr \"type\" \"fconv\")\n+\t\t\t \"nothing\")\n \f\n ;; Addition.\n "}]}