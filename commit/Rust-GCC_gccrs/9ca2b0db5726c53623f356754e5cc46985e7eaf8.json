{"sha": "9ca2b0db5726c53623f356754e5cc46985e7eaf8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWNhMmIwZGI1NzI2YzUzNjIzZjM1Njc1NGU1Y2M0Njk4NWU3ZWFmOA==", "commit": {"author": {"name": "Paul Brook", "email": "paul@codesourcery.com", "date": "2004-08-25T21:04:49Z"}, "committer": {"name": "Paul Brook", "email": "pbrook@gcc.gnu.org", "date": "2004-08-25T21:04:49Z"}, "message": "re PR fortran/17190 (MPFR semantics for mpfr_get_z_exp changed)\n\n\tPR fortran/17190\n\t* arith.c (gfc_mpfr_to_mpz): Workaround mpfr bug.\n\nFrom-SVN: r86581", "tree": {"sha": "c7fd5e49a0b365b2ea41fa2b7eb91f0548f5ef1c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c7fd5e49a0b365b2ea41fa2b7eb91f0548f5ef1c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9ca2b0db5726c53623f356754e5cc46985e7eaf8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ca2b0db5726c53623f356754e5cc46985e7eaf8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ca2b0db5726c53623f356754e5cc46985e7eaf8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ca2b0db5726c53623f356754e5cc46985e7eaf8/comments", "author": null, "committer": null, "parents": [{"sha": "ef79d4c27c8f603530fa8aca47380756c2f9137d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef79d4c27c8f603530fa8aca47380756c2f9137d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ef79d4c27c8f603530fa8aca47380756c2f9137d"}], "stats": {"total": 14, "additions": 11, "deletions": 3}, "files": [{"sha": "dd6b48ea65a171864c56d953f63f774ed2603c24", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ca2b0db5726c53623f356754e5cc46985e7eaf8/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ca2b0db5726c53623f356754e5cc46985e7eaf8/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=9ca2b0db5726c53623f356754e5cc46985e7eaf8", "patch": "@@ -1,3 +1,8 @@\n+2004-08-25  Paul Brook  <paul@codesourcery.com>\n+\n+\tPR fortran/17190\n+\t* arith.c (gfc_mpfr_to_mpz): Workaround mpfr bug.\n+\n 2004-08-25  Paul Brook  <paul@codesourcery.com>\n \n \tPR fortran/17144"}, {"sha": "5f558139401ede03a180d27b68ab27a53d24f719", "filename": "gcc/fortran/arith.c", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ca2b0db5726c53623f356754e5cc46985e7eaf8/gcc%2Ffortran%2Farith.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ca2b0db5726c53623f356754e5cc46985e7eaf8/gcc%2Ffortran%2Farith.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Farith.c?ref=9ca2b0db5726c53623f356754e5cc46985e7eaf8", "patch": "@@ -106,17 +106,20 @@ int gfc_index_integer_kind;\n    It's easily implemented with a few calls though.  */\n \n void\n-gfc_mpfr_to_mpz(mpz_t z, mpfr_t x)\n+gfc_mpfr_to_mpz (mpz_t z, mpfr_t x)\n {\n   mp_exp_t e;\n \n   e = mpfr_get_z_exp (z, x);\n+  /* MPFR 2.0.1 (included with GMP 4.1) has a bug whereby mpfr_get_z_exp\n+     may set the sign of z incorrectly.  Work around that here.  */\n+  if (mpfr_sgn (x) != mpz_sgn (z))\n+    mpz_neg (z, z);\n+\n   if (e > 0)\n     mpz_mul_2exp (z, z, e);\n   else\n     mpz_tdiv_q_2exp (z, z, -e);\n-  if (mpfr_sgn (x) < 0)\n-    mpz_neg (z, z);\n }\n \n "}]}