{"sha": "c7762b449dca23277872cd1365c84522e42caadc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzc3NjJiNDQ5ZGNhMjMyNzc4NzJjZDEzNjVjODQ1MjJlNDJjYWFkYw==", "commit": {"author": {"name": "Per Bothner", "email": "per@bothner.com", "date": "2004-02-14T17:40:53Z"}, "committer": {"name": "Per Bothner", "email": "bothner@gcc.gnu.org", "date": "2004-02-14T17:40:53Z"}, "message": "fix-header.c (line_table): Move local variable in main to global.\n\n\n\t* fix-header.c (line_table):  Move local variable in main to global.\n\t* scan.h (line_table):  Use it.\n\t* scan-decls.c (scan_decls):  Need to call linemap_lookup on token's\n\tline (recently renamed to src_loc) before calling recognized_function.\n\nFrom-SVN: r77808", "tree": {"sha": "eada207080ac63627087ff1b702269b3d8acb613", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/eada207080ac63627087ff1b702269b3d8acb613"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c7762b449dca23277872cd1365c84522e42caadc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c7762b449dca23277872cd1365c84522e42caadc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c7762b449dca23277872cd1365c84522e42caadc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c7762b449dca23277872cd1365c84522e42caadc/comments", "author": {"login": "PerBothner", "id": 10293361, "node_id": "MDQ6VXNlcjEwMjkzMzYx", "avatar_url": "https://avatars.githubusercontent.com/u/10293361?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PerBothner", "html_url": "https://github.com/PerBothner", "followers_url": "https://api.github.com/users/PerBothner/followers", "following_url": "https://api.github.com/users/PerBothner/following{/other_user}", "gists_url": "https://api.github.com/users/PerBothner/gists{/gist_id}", "starred_url": "https://api.github.com/users/PerBothner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PerBothner/subscriptions", "organizations_url": "https://api.github.com/users/PerBothner/orgs", "repos_url": "https://api.github.com/users/PerBothner/repos", "events_url": "https://api.github.com/users/PerBothner/events{/privacy}", "received_events_url": "https://api.github.com/users/PerBothner/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "cb7c0b5a3ebf751bae0be29a1cf3fff974fd1728", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb7c0b5a3ebf751bae0be29a1cf3fff974fd1728", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cb7c0b5a3ebf751bae0be29a1cf3fff974fd1728"}], "stats": {"total": 18, "additions": 16, "deletions": 2}, "files": [{"sha": "db4ae6f15dd3f980a26ddda54a286b4597eb24a6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c7762b449dca23277872cd1365c84522e42caadc/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c7762b449dca23277872cd1365c84522e42caadc/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c7762b449dca23277872cd1365c84522e42caadc", "patch": "@@ -1,3 +1,10 @@\n+2004-02-14  Per Bothner  <per@bothner.com>\n+\n+\t* fix-header.c (line_table):  Move local variable in main to global.\n+\t* scan.h (line_table):  Use it.\n+\t* scan-decls.c (scan_decls):  Need to call linemap_lookup on token's\n+\tline (recently renamed to src_loc) before calling recognized_function.\n+\n 2004-02-14  Matt Kraai  <kraai@alumni.cmu.edu>\n \n \t* Makefile.in: Fix comment typos."}, {"sha": "67666b6544ce6cf02b1646d3044bb892cd3d62d1", "filename": "gcc/fix-header.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c7762b449dca23277872cd1365c84522e42caadc/gcc%2Ffix-header.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c7762b449dca23277872cd1365c84522e42caadc/gcc%2Ffix-header.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffix-header.c?ref=c7762b449dca23277872cd1365c84522e42caadc", "patch": "@@ -84,6 +84,8 @@ static void v_fatal (const char *, va_list)\n      ATTRIBUTE_PRINTF (1,0) ATTRIBUTE_NORETURN;\n static void fatal (const char *, ...) ATTRIBUTE_PRINTF_1 ATTRIBUTE_NORETURN;\n \n+struct line_maps line_table;\n+\n sstring buf;\n \n int verbose = 0;\n@@ -590,7 +592,6 @@ read_scan_file (char *in_fname, int argc, char **argv)\n   struct fn_decl *fn;\n   int i, strings_processed;\n   struct symbol_list *cur_symbols;\n-  struct line_maps line_table;\n \n   obstack_init (&scan_file_obstack);\n "}, {"sha": "70b95bf50ae4326aa82bbb2c0decee68ced157a1", "filename": "gcc/scan-decls.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c7762b449dca23277872cd1365c84522e42caadc/gcc%2Fscan-decls.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c7762b449dca23277872cd1365c84522e42caadc/gcc%2Fscan-decls.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fscan-decls.c?ref=c7762b449dca23277872cd1365c84522e42caadc", "patch": "@@ -165,6 +165,8 @@ scan_decls (cpp_reader *pfile, int argc ATTRIBUTE_UNUSED,\n \t    {\n \t      int nesting = 1;\n \t      int have_arg_list = 0;\n+\t      const struct line_map *map;\n+\t      unsigned int line;\n \t      for (;;)\n \t\t{\n \t\t  token = get_a_token (pfile);\n@@ -182,7 +184,9 @@ scan_decls (cpp_reader *pfile, int argc ATTRIBUTE_UNUSED,\n \t\t\t   || token->type == CPP_ELLIPSIS)\n \t\t    have_arg_list = 1;\n \t\t}\n-\t      recognized_function (&prev_id, token->line,\n+\t      map = linemap_lookup (&line_table, token->src_loc);\n+\t      line = SOURCE_LINE (map, token->src_loc);\n+\t      recognized_function (&prev_id, line,\n \t\t\t\t   (saw_inline ? 'I'\n \t\t\t\t    : in_extern_C_brace || current_extern_C\n \t\t\t\t    ? 'F' : 'f'), have_arg_list);"}, {"sha": "0d42de5caf87dce47b4adc25e5982fa14b422c72", "filename": "gcc/scan.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c7762b449dca23277872cd1365c84522e42caadc/gcc%2Fscan.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c7762b449dca23277872cd1365c84522e42caadc/gcc%2Fscan.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fscan.h?ref=c7762b449dca23277872cd1365c84522e42caadc", "patch": "@@ -70,3 +70,5 @@ extern int source_lineno;\n extern sstring source_filename;\n /* Current physical line number */\n extern int lineno;\n+\n+extern struct line_maps line_table;"}]}