{"sha": "f516a7dacf06f446b8e5d321c404a0d47702237b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjUxNmE3ZGFjZjA2ZjQ0NmI4ZTVkMzIxYzQwNGEwZDQ3NzAyMjM3Yg==", "commit": {"author": {"name": "Paolo Bonzini", "email": "bonzini@gnu.org", "date": "2004-06-01T07:43:25Z"}, "committer": {"name": "Paolo Bonzini", "email": "bonzini@gcc.gnu.org", "date": "2004-06-01T07:43:25Z"}, "message": "Makefile.tpl (all.normal): Rename to all.\n\n2004-06-01  Paolo Bonzini  <bonzini@gnu.org>\n\n\t* Makefile.tpl (all.normal): Rename to all.\n\t(all): Replace with a rule to pick the default\n\ttarget from configure.\n\t(all-gcc, configure-gcc): Use conditionals to\n\tdo nothing when toplevel bootstrap is going on.\n\t(GCC directory bootstrap) [gcc-bootstrap]: Disable.\n\t(Toplevel bootstrap) [gcc-no-bootstrap]: Disable.\n\t* configure.in: Support --enable-bootstrap.\n\n\t* Makefile.def: Remove new- prefix from toplevel\n\tbootstrap targets.\n\t* Makefile.tpl: Likewise.\n\n\t* Makefile.def: Add bootstrap_stage 4.  Add bootstrap2\n\ttarget.\n\n\t* Makefile.tpl (Toplevel bootstrap): Pass $(BASE_FLAGS_TO_PASS)\n\t$(RECURSE_FLAGS) to recursive invocation of make.\n\n\t* Makefile.in: Regenerate.\n\t* configure: Regenerate.\n\nFrom-SVN: r82534", "tree": {"sha": "92856c91ef0fb30739da4ffc623a9fb9900cc1b9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/92856c91ef0fb30739da4ffc623a9fb9900cc1b9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f516a7dacf06f446b8e5d321c404a0d47702237b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f516a7dacf06f446b8e5d321c404a0d47702237b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f516a7dacf06f446b8e5d321c404a0d47702237b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f516a7dacf06f446b8e5d321c404a0d47702237b/comments", "author": {"login": "bonzini", "id": 42082, "node_id": "MDQ6VXNlcjQyMDgy", "avatar_url": "https://avatars.githubusercontent.com/u/42082?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bonzini", "html_url": "https://github.com/bonzini", "followers_url": "https://api.github.com/users/bonzini/followers", "following_url": "https://api.github.com/users/bonzini/following{/other_user}", "gists_url": "https://api.github.com/users/bonzini/gists{/gist_id}", "starred_url": "https://api.github.com/users/bonzini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bonzini/subscriptions", "organizations_url": "https://api.github.com/users/bonzini/orgs", "repos_url": "https://api.github.com/users/bonzini/repos", "events_url": "https://api.github.com/users/bonzini/events{/privacy}", "received_events_url": "https://api.github.com/users/bonzini/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0b068ee90da7cbccbc7fd3ef66d58b9bcbcedabd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b068ee90da7cbccbc7fd3ef66d58b9bcbcedabd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0b068ee90da7cbccbc7fd3ef66d58b9bcbcedabd"}], "stats": {"total": 549, "additions": 387, "deletions": 162}, "files": [{"sha": "12ee361c6b3d5e7c557f487b4b81e93782d432fc", "filename": "ChangeLog", "status": "modified", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f516a7dacf06f446b8e5d321c404a0d47702237b/ChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f516a7dacf06f446b8e5d321c404a0d47702237b/ChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ChangeLog?ref=f516a7dacf06f446b8e5d321c404a0d47702237b", "patch": "@@ -1,3 +1,27 @@\n+2004-06-01  Paolo Bonzini  <bonzini@gnu.org>\n+\n+\t* Makefile.tpl (all.normal): Rename to all.\n+\t(all): Replace with a rule to pick the default\n+\ttarget from configure.\n+\t(all-gcc, configure-gcc): Use conditionals to\n+\tdo nothing when toplevel bootstrap is going on.\n+\t(GCC directory bootstrap) [gcc-bootstrap]: Disable.\n+\t(Toplevel bootstrap) [gcc-no-bootstrap]: Disable.\n+\t* configure.in: Support --enable-bootstrap.\n+\n+\t* Makefile.def: Remove new- prefix from toplevel\n+\tbootstrap targets.\n+\t* Makefile.tpl: Likewise.\n+\n+\t* Makefile.def: Add bootstrap_stage 4.  Add bootstrap2\n+\ttarget.\n+\n+\t* Makefile.tpl (Toplevel bootstrap): Pass $(BASE_FLAGS_TO_PASS)\n+\t$(RECURSE_FLAGS) to recursive invocation of make.\n+\n+\t* Makefile.in: Regenerate.\n+\t* configure: Regenerate.\n+\n 2004-05-30  Andreas Jaeger  <aj@suse.de>\n \t    Jim Wilson <wilson@specifixinc.com>\n "}, {"sha": "22bdec0fd972df918843877b0c0d5f980d2f8a2d", "filename": "Makefile.def", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f516a7dacf06f446b8e5d321c404a0d47702237b/Makefile.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f516a7dacf06f446b8e5d321c404a0d47702237b/Makefile.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/Makefile.def?ref=f516a7dacf06f446b8e5d321c404a0d47702237b", "patch": "@@ -222,12 +222,19 @@ bootstrap_stage = {\n \textra_make_flags='CFLAGS=\"$(STAGE1_CFLAGS)\"' ; };\n bootstrap_stage = {\n \tid=2 ; prev=1 ; next=3 ;\n+\tbootstrap_target=new-bootstrap2 ;\n \textra_configure_flags=\"@stage2_werror_flag@\" ;\n \textra_make_flags=\"$(POSTSTAGE1_FLAGS_TO_PASS)\" ; };\n bootstrap_stage = {\n-\tid=3 ; prev=2 ;\n+\tid=3 ; prev=2 ; next=4 ;\n \tcompare_target=compare ;\n-\tbootstrap_target=new-bootstrap ;\n-\tcleanstrap_target=new-cleanstrap ;\n+\tbootstrap_target=bootstrap ;\n+\tcleanstrap_target=cleanstrap ;\n+\textra_configure_flags=\"@stage2_werror_flag@\" ;\n+\textra_make_flags=\"$(POSTSTAGE1_FLAGS_TO_PASS)\" ; };\n+bootstrap_stage = {\n+\tid=4 ; prev=3 ;\n+\tcompare_target=compare3 ;\n+\tbootstrap_target=bootstrap4 ;\n \textra_configure_flags=\"@stage2_werror_flag@\" ;\n \textra_make_flags=\"$(POSTSTAGE1_FLAGS_TO_PASS)\" ; };"}, {"sha": "efa419cd9aea4ff0cabb675c7c6239f2a19000fd", "filename": "Makefile.in", "status": "modified", "additions": 189, "deletions": 65, "changes": 254, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f516a7dacf06f446b8e5d321c404a0d47702237b/Makefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f516a7dacf06f446b8e5d321c404a0d47702237b/Makefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/Makefile.in?ref=f516a7dacf06f446b8e5d321c404a0d47702237b", "patch": "@@ -467,8 +467,7 @@ PICFLAG_FOR_TARGET =\n \n # The first rule in the file had better be this one.  Don't put any above it.\n # This lives here to allow makefile fragments to contain dependencies.\n-all: all.normal\n-.PHONY: all\n+@default_target@:\n \n #### host and target specific makefile fragments come in here.\n @target_makefile_frag@\n@@ -712,9 +711,9 @@ configure-target:  \\\n     maybe-configure-target-rda \\\n     maybe-configure-target-libada\n \n-# The target built for a native build.\n-.PHONY: all.normal\n-all.normal: @all_build_modules@ all-host all-target\n+# The target built for a native non-bootstrap build.\n+.PHONY: all\n+all: @all_build_modules@ all-host all-target\n \n .PHONY: all-host\n all-host: maybe-all-gcc  \\\n@@ -27646,8 +27645,9 @@ maybe-configure-gcc:\n @if gcc\n maybe-configure-gcc: configure-gcc\n configure-gcc:\n+@endif gcc\n+@if gcc-no-bootstrap\n \t@test ! -f gcc/Makefile || exit 0; \\\n-\t[ -f stage_last ] && exit 0; \\\n \t[ -d gcc ] || mkdir gcc; \\\n \tr=`${PWD_COMMAND}`; export r; \\\n \ts=`cd $(srcdir); ${PWD_COMMAND}`; export s; \\\n@@ -27668,7 +27668,7 @@ configure-gcc:\n \t$(SHELL) $${libsrcdir}/configure \\\n \t  $(HOST_CONFIGARGS) $${srcdiroption} \\\n \t  || exit 1\n-@endif gcc\n+@endif gcc-no-bootstrap\n \n # Don't 'make all' in gcc if it's already been made by 'bootstrap'; that\n # causes trouble.  This wart will be fixed eventually by moving\n@@ -27678,19 +27678,17 @@ maybe-all-gcc:\n @if gcc\n maybe-all-gcc: all-gcc\n all-gcc: configure-gcc\n+@endif gcc\n+@if gcc-no-bootstrap\n \tr=`${PWD_COMMAND}`; export r; \\\n \ts=`cd $(srcdir); ${PWD_COMMAND}`; export s; \\\n+\t$(SET_LIB_PATH) \\\n \t$(GCC_HOST_EXPORTS) \\\n-\tif [ -f stage_last ] ; then \\\n-\t  true ; \\\n-\telif [ -f gcc/stage_last ] ; then \\\n-\t  $(SET_LIB_PATH) \\\n+\tif [ -f gcc/stage_last ] ; then \\\n \t  (cd gcc && $(MAKE) $(GCC_FLAGS_TO_PASS) quickstrap); \\\n \telse \\\n-\t  $(SET_LIB_PATH) \\\n \t  (cd gcc && $(MAKE) $(GCC_FLAGS_TO_PASS) all); \\\n \tfi\n-@endif gcc\n \n # Building GCC uses some tools for rebuilding \"source\" files\n # like texinfo, bison/byacc, etc.  So we must depend on those.\n@@ -27769,7 +27767,8 @@ cross: all-texinfo all-bison all-byacc all-binutils all-gas all-ld\n \t$(SET_LIB_PATH) \\\n \techo \"Building runtime libraries\"; \\\n \t$(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) \\\n-\t  LANGUAGES=\"c c++\" all\n+\t\tLANGUAGES=\"c c++\" all\n+@endif gcc-no-bootstrap\n \n .PHONY: check-gcc maybe-check-gcc\n maybe-check-gcc:\n@@ -28065,6 +28064,7 @@ maintainer-clean-gcc:\n \n \n \n+@if gcc-bootstrap\n # ---------------------\n # GCC bootstrap support\n # ---------------------\n@@ -28110,7 +28110,7 @@ objext = .o\n # Real targets act phony if they depend on phony targets; this hack\n # prevents gratuitous rebuilding of stage 1.\n prebootstrap:\n-\t$(MAKE) all-bootstrap\n+\t$(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) all-bootstrap\n \t$(STAMP) prebootstrap\n \n # Flags to pass to stage2 and later makes.\n@@ -28129,36 +28129,37 @@ POSTSTAGE1_FLAGS_TO_PASS = \\\n # * We build only C (and possibly Ada).\n \n \n-.PHONY: new-stage1-start new-stage1-end\n+.PHONY: stage1-start stage1-end\n \n-new-stage1-start:\n-\t[ -f stage_last ] && $(MAKE) new-`cat stage_last`-end || :\n+stage1-start:\n+\t[ -f stage_last ] && $(MAKE) `cat stage_last`-end || :\n \techo stage1 > stage_last ; \\\n \t[ -d stage1-gcc ] || mkdir stage1-gcc; \\\n \tset stage1-gcc gcc ; @CREATE_LINK_TO_DIR@ \n \n-new-stage1-end:\n+stage1-end:\n \trm -f stage_last ; \\\n \tset gcc stage1-gcc ; @UNDO_LINK_TO_DIR@ \n \n # Bubble a bugfix through all the stages up to stage 1.  They\n # are remade, but not reconfigured.  The next stage (if any) will not\n # be reconfigured as well.\n-.PHONY: new-stage1-bubble\n-new-stage1-bubble: \n+.PHONY: stage1-bubble\n+stage1-bubble: \n \t@if [ -f all-stage1-gcc ] ; then \\\n \t  echo Remaking stage 1 ; \\\n \t  rm -f all-stage1-gcc ; \\\n-\t  $(MAKE) all-stage1-gcc  && \\\n+\t  $(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) \\\n+\t    all-stage1-gcc  && \\\n \t  if [ -f configure-stage2-gcc ] ; then \\\n \t    $(STAMP) configure-stage2-gcc ; \\\n \t  fi ; \\\n \telse \\\n-\t  $(MAKE) all-stage1-gcc ; \\\n+\t  $(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) all-stage1-gcc ; \\\n \tfi\n \n configure-stage1-gcc:  prebootstrap \n-\t$(MAKE) new-stage1-start\n+\t$(MAKE) stage1-start\n \t@if [ -f stage1-gcc/Makefile ] ; then \\\n \t  $(STAMP) configure-stage1-gcc ; \\\n \t  exit 0; \\\n@@ -28187,7 +28188,7 @@ configure-stage1-gcc:  prebootstrap\n \t  $(STAMP) ../configure-stage1-gcc\n \n all-stage1-gcc: configure-stage1-gcc\n-\t$(MAKE) new-stage1-start\n+\t$(MAKE) stage1-start\n \t@r=`${PWD_COMMAND}`; export r; \\\n \ts=`cd $(srcdir); ${PWD_COMMAND}`; export s;  \\\n \t$(GCC_HOST_EXPORTS)  \\\n@@ -28199,51 +28200,52 @@ all-stage1-gcc: configure-stage1-gcc\n \n \n \n-.PHONY: new-restage1 distclean-stage1\n+.PHONY: restage1 distclean-stage1\n \n distclean-stage1:  distclean-stage2 \n-\t[ -f stage_last ] && $(MAKE) new-`cat stage_last`-end || :\n+\t[ -f stage_last ] && $(MAKE) `cat stage_last`-end || :\n \trm -rf configure-stage1-gcc all-stage1-gcc stage1-gcc \n \n-new-restage1:  distclean-stage2 \n+restage1:  distclean-stage2 \n \trm -rf all-stage1-gcc \n-\t$(MAKE)  all-stage1-gcc \n+\t$(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS)  all-stage1-gcc \n \n \n \n \n-.PHONY: new-stage2-start new-stage2-end\n+.PHONY: stage2-start stage2-end\n \n-new-stage2-start:\n-\t[ -f stage_last ] && $(MAKE) new-`cat stage_last`-end || :\n+stage2-start:\n+\t[ -f stage_last ] && $(MAKE) `cat stage_last`-end || :\n \techo stage2 > stage_last ; \\\n \t[ -d stage2-gcc ] || mkdir stage2-gcc; \\\n \tset stage2-gcc gcc ; @CREATE_LINK_TO_DIR@  ; \\\n \tset stage1-gcc prev-gcc ; @CREATE_LINK_TO_DIR@ \n \n-new-stage2-end:\n+stage2-end:\n \trm -f stage_last ; \\\n \tset gcc stage2-gcc ; @UNDO_LINK_TO_DIR@  ; \\\n \tset prev-gcc stage1-gcc ; @UNDO_LINK_TO_DIR@ \n \n # Bubble a bugfix through all the stages up to stage 2.  They\n # are remade, but not reconfigured.  The next stage (if any) will not\n # be reconfigured as well.\n-.PHONY: new-stage2-bubble\n-new-stage2-bubble: new-stage1-bubble\n+.PHONY: stage2-bubble\n+stage2-bubble: stage1-bubble\n \t@if [ -f all-stage2-gcc ] ; then \\\n \t  echo Remaking stage 2 ; \\\n \t  rm -f all-stage2-gcc ; \\\n-\t  $(MAKE) all-stage2-gcc  && \\\n+\t  $(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) \\\n+\t    all-stage2-gcc  && \\\n \t  if [ -f configure-stage3-gcc ] ; then \\\n \t    $(STAMP) configure-stage3-gcc ; \\\n \t  fi ; \\\n \telse \\\n-\t  $(MAKE) all-stage2-gcc ; \\\n+\t  $(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) all-stage2-gcc ; \\\n \tfi\n \n configure-stage2-gcc:  all-stage1-gcc \n-\t$(MAKE) new-stage2-start\n+\t$(MAKE) stage2-start\n \t@if [ -f stage2-gcc/Makefile ] ; then \\\n \t  $(STAMP) configure-stage2-gcc ; \\\n \t  exit 0; \\\n@@ -28272,7 +28274,7 @@ configure-stage2-gcc:  all-stage1-gcc\n \t  $(STAMP) ../configure-stage2-gcc\n \n all-stage2-gcc: configure-stage2-gcc\n-\t$(MAKE) new-stage2-start\n+\t$(MAKE) stage2-start\n \t@r=`${PWD_COMMAND}`; export r; \\\n \ts=`cd $(srcdir); ${PWD_COMMAND}`; export s;  \\\n \t$(STAGE_HOST_EXPORTS)  \\\n@@ -28285,49 +28287,58 @@ all-stage2-gcc: configure-stage2-gcc\n \n \n \n+.PHONY: new-bootstrap2\n+new-bootstrap2:\n+\t$(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) stage2-bubble  \\\n+\t  stage2-start all stage2-end \n \n-.PHONY: new-restage2 distclean-stage2\n+\n+.PHONY: restage2 distclean-stage2\n \n distclean-stage2:  distclean-stage3 \n-\t[ -f stage_last ] && $(MAKE) new-`cat stage_last`-end || :\n+\t[ -f stage_last ] && $(MAKE) `cat stage_last`-end || :\n \trm -rf configure-stage2-gcc all-stage2-gcc stage2-gcc \n \n-new-restage2:  distclean-stage3 \n+restage2:  distclean-stage3 \n \trm -rf all-stage2-gcc \n-\t$(MAKE)  all-stage2-gcc \n+\t$(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS)  all-stage2-gcc \n \n \n \n \n-.PHONY: new-stage3-start new-stage3-end\n+.PHONY: stage3-start stage3-end\n \n-new-stage3-start:\n-\t[ -f stage_last ] && $(MAKE) new-`cat stage_last`-end || :\n+stage3-start:\n+\t[ -f stage_last ] && $(MAKE) `cat stage_last`-end || :\n \techo stage3 > stage_last ; \\\n \t[ -d stage3-gcc ] || mkdir stage3-gcc; \\\n \tset stage3-gcc gcc ; @CREATE_LINK_TO_DIR@  ; \\\n \tset stage2-gcc prev-gcc ; @CREATE_LINK_TO_DIR@ \n \n-new-stage3-end:\n+stage3-end:\n \trm -f stage_last ; \\\n \tset gcc stage3-gcc ; @UNDO_LINK_TO_DIR@  ; \\\n \tset prev-gcc stage2-gcc ; @UNDO_LINK_TO_DIR@ \n \n # Bubble a bugfix through all the stages up to stage 3.  They\n # are remade, but not reconfigured.  The next stage (if any) will not\n # be reconfigured as well.\n-.PHONY: new-stage3-bubble\n-new-stage3-bubble: new-stage2-bubble\n+.PHONY: stage3-bubble\n+stage3-bubble: stage2-bubble\n \t@if [ -f all-stage3-gcc ] ; then \\\n \t  echo Remaking stage 3 ; \\\n \t  rm -f all-stage3-gcc ; \\\n-\t  $(MAKE) all-stage3-gcc ; \\\n+\t  $(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) \\\n+\t    all-stage3-gcc  && \\\n+\t  if [ -f configure-stage4-gcc ] ; then \\\n+\t    $(STAMP) configure-stage4-gcc ; \\\n+\t  fi ; \\\n \telse \\\n-\t  $(MAKE) all-stage3-gcc ; \\\n+\t  $(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) all-stage3-gcc ; \\\n \tfi\n \n configure-stage3-gcc:  all-stage2-gcc \n-\t$(MAKE) new-stage3-start\n+\t$(MAKE) stage3-start\n \t@if [ -f stage3-gcc/Makefile ] ; then \\\n \t  $(STAMP) configure-stage3-gcc ; \\\n \t  exit 0; \\\n@@ -28356,7 +28367,7 @@ configure-stage3-gcc:  all-stage2-gcc\n \t  $(STAMP) ../configure-stage3-gcc\n \n all-stage3-gcc: configure-stage3-gcc\n-\t$(MAKE) new-stage3-start\n+\t$(MAKE) stage3-start\n \t@r=`${PWD_COMMAND}`; export r; \\\n \ts=`cd $(srcdir); ${PWD_COMMAND}`; export s;  \\\n \t$(STAGE_HOST_EXPORTS)  \\\n@@ -28368,7 +28379,7 @@ all-stage3-gcc: configure-stage3-gcc\n \n \n compare: all-stage3-gcc\n-\t[ -f stage_last ] && $(MAKE) new-`cat stage_last`-end || :\n+\t[ -f stage_last ] && $(MAKE) `cat stage_last`-end || :\n \t@r=`${PWD_COMMAND}`; export r; \\\n \ts=`cd $(srcdir); ${PWD_COMMAND}`; export s; \\\n \trm -f .bad_compare ; \\\n@@ -28391,28 +28402,141 @@ compare: all-stage3-gcc\n \n \n \n-.PHONY: new-bootstrap\n-new-bootstrap:\n-\t$(MAKE) new-stage3-bubble  compare  \\\n-\t  new-stage3-start all new-stage3-end \n+.PHONY: bootstrap\n+bootstrap:\n+\t$(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) stage3-bubble  compare  \\\n+\t  stage3-start all stage3-end \n \n \n-.PHONY: new-restage3 distclean-stage3\n+.PHONY: restage3 distclean-stage3\n \n-distclean-stage3: \n-\t[ -f stage_last ] && $(MAKE) new-`cat stage_last`-end || :\n+distclean-stage3:  distclean-stage4 \n+\t[ -f stage_last ] && $(MAKE) `cat stage_last`-end || :\n \trm -rf configure-stage3-gcc all-stage3-gcc stage3-gcc compare \n \n-new-restage3: \n+restage3:  distclean-stage4 \n \trm -rf all-stage3-gcc compare \n-\t$(MAKE) compare \n+\t$(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) compare \n+\n+\n+.PHONY: cleanstrap\n+cleanstrap: distclean-stage1 bootstrap\n+\n+\n+\n+.PHONY: stage4-start stage4-end\n+\n+stage4-start:\n+\t[ -f stage_last ] && $(MAKE) `cat stage_last`-end || :\n+\techo stage4 > stage_last ; \\\n+\t[ -d stage4-gcc ] || mkdir stage4-gcc; \\\n+\tset stage4-gcc gcc ; @CREATE_LINK_TO_DIR@  ; \\\n+\tset stage3-gcc prev-gcc ; @CREATE_LINK_TO_DIR@ \n+\n+stage4-end:\n+\trm -f stage_last ; \\\n+\tset gcc stage4-gcc ; @UNDO_LINK_TO_DIR@  ; \\\n+\tset prev-gcc stage3-gcc ; @UNDO_LINK_TO_DIR@ \n+\n+# Bubble a bugfix through all the stages up to stage 4.  They\n+# are remade, but not reconfigured.  The next stage (if any) will not\n+# be reconfigured as well.\n+.PHONY: stage4-bubble\n+stage4-bubble: stage3-bubble\n+\t@if [ -f all-stage4-gcc ] ; then \\\n+\t  echo Remaking stage 4 ; \\\n+\t  rm -f all-stage4-gcc ; \\\n+\t  $(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) \\\n+\t    all-stage4-gcc ; \\\n+\telse \\\n+\t  $(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) all-stage4-gcc ; \\\n+\tfi\n+\n+configure-stage4-gcc:  all-stage3-gcc \n+\t$(MAKE) stage4-start\n+\t@if [ -f stage4-gcc/Makefile ] ; then \\\n+\t  $(STAMP) configure-stage4-gcc ; \\\n+\t  exit 0; \\\n+\telse \\\n+\t  true ; \\\n+\tfi ; \\\n+\tr=`${PWD_COMMAND}`; export r; \\\n+\ts=`cd $(srcdir); ${PWD_COMMAND}`; export s;  \\\n+\t$(STAGE_HOST_EXPORTS)  \\\n+\techo Configuring stage 4 in gcc ; \\\n+\tcd gcc || exit 1; \\\n+\tcase $(srcdir) in \\\n+\t  \\.) \\\n+\t    srcdiroption=\"--srcdir=.\"; \\\n+\t    libsrcdir=\".\";; \\\n+\t  /* | [A-Za-z]:[\\\\/]*) \\\n+\t    srcdiroption=\"--srcdir=$(srcdir)/gcc\"; \\\n+\t    libsrcdir=\"$$s/gcc\";; \\\n+\t  *) \\\n+\t    srcdiroption=\"--srcdir=../$(srcdir)/gcc\"; \\\n+\t    libsrcdir=\"$$s/gcc\";; \\\n+\tesac; \\\n+\t$(SHELL) $${libsrcdir}/configure \\\n+\t  $(HOST_CONFIGARGS) $${srcdiroption} \\\n+\t  @stage2_werror_flag@ && \\\n+\t  $(STAMP) ../configure-stage4-gcc\n+\n+all-stage4-gcc: configure-stage4-gcc\n+\t$(MAKE) stage4-start\n+\t@r=`${PWD_COMMAND}`; export r; \\\n+\ts=`cd $(srcdir); ${PWD_COMMAND}`; export s;  \\\n+\t$(STAGE_HOST_EXPORTS)  \\\n+\tcd gcc && \\\n+\t$(MAKE) $(GCC_FLAGS_TO_PASS)  \\\n+\t\tCC=\"$${CC}\" CC_FOR_BUILD=\"${CC_FOR_BUILD}\" \\\n+\t\tSTAGE_PREFIX=$$r/stage3-gcc/  \\\n+\t\t$(POSTSTAGE1_FLAGS_TO_PASS) && $(STAMP) ../all-stage4-gcc\n+\n+\n+compare3: all-stage4-gcc\n+\t[ -f stage_last ] && $(MAKE) `cat stage_last`-end || :\n+\t@r=`${PWD_COMMAND}`; export r; \\\n+\ts=`cd $(srcdir); ${PWD_COMMAND}`; export s; \\\n+\trm -f .bad_compare ; \\\n+\tcd stage4-gcc; \\\n+\tfiles=`find . -name \"*$(objext)\" -print` ; \\\n+\tcd .. ; \\\n+\tfor file in $${files} ; do \\\n+\t  f1=$$r/stage3-gcc/$$file; f2=$$r/stage4-gcc/$$file; \\\n+\t  @do_compare@ > /dev/null 2>&1; \\\n+\t  test $$? -eq 1 && echo $$file differs >> .bad_compare || true; \\\n+\tdone ; \\\n+\tif [ -f .bad_compare ]; then \\\n+\t  echo \"Bootstrap comparison failure!\"; \\\n+\t  cat .bad_compare; \\\n+\t  exit 1; \\\n+\telse \\\n+\t  true; \\\n+\tfi ; \\\n+\t$(STAMP) compare3\n+\n+\n+\n+.PHONY: bootstrap4\n+bootstrap4:\n+\t$(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) stage4-bubble  compare3  \\\n+\t  stage4-start all stage4-end \n+\n+\n+.PHONY: restage4 distclean-stage4\n+\n+distclean-stage4: \n+\t[ -f stage_last ] && $(MAKE) `cat stage_last`-end || :\n+\trm -rf configure-stage4-gcc all-stage4-gcc stage4-gcc compare3 \n \n+restage4: \n+\trm -rf all-stage4-gcc compare3 \n+\t$(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) compare3 \n \n-.PHONY: new-cleanstrap\n-new-cleanstrap: distclean-stage1 new-bootstrap\n \n \n \n+@endif gcc-bootstrap\n \n # --------------------------------------\n # Dependencies between different modules"}, {"sha": "e81d036139682cc02dba9d2dd382768c0c567d90", "filename": "Makefile.tpl", "status": "modified", "additions": 34, "deletions": 32, "changes": 66, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f516a7dacf06f446b8e5d321c404a0d47702237b/Makefile.tpl", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f516a7dacf06f446b8e5d321c404a0d47702237b/Makefile.tpl", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/Makefile.tpl?ref=f516a7dacf06f446b8e5d321c404a0d47702237b", "patch": "@@ -470,8 +470,7 @@ PICFLAG_FOR_TARGET =\n \n # The first rule in the file had better be this one.  Don't put any above it.\n # This lives here to allow makefile fragments to contain dependencies.\n-all: all.normal\n-.PHONY: all\n+@default_target@:\n \n #### host and target specific makefile fragments come in here.\n @target_makefile_frag@\n@@ -576,9 +575,9 @@ configure-target: [+\n     maybe-configure-target-[+module+][+\n   ENDFOR target_modules +]\n \n-# The target built for a native build.\n-.PHONY: all.normal\n-all.normal: @all_build_modules@ all-host all-target\n+# The target built for a native non-bootstrap build.\n+.PHONY: all\n+all: @all_build_modules@ all-host all-target\n \n .PHONY: all-host\n all-host: maybe-all-gcc [+\n@@ -1171,8 +1170,9 @@ maybe-configure-gcc:\n @if gcc\n maybe-configure-gcc: configure-gcc\n configure-gcc:\n+@endif gcc\n+@if gcc-no-bootstrap\n \t@test ! -f gcc/Makefile || exit 0; \\\n-\t[ -f stage_last ] && exit 0; \\\n \t[ -d gcc ] || mkdir gcc; \\\n \tr=`${PWD_COMMAND}`; export r; \\\n \ts=`cd $(srcdir); ${PWD_COMMAND}`; export s; \\\n@@ -1193,7 +1193,7 @@ configure-gcc:\n \t$(SHELL) $${libsrcdir}/configure \\\n \t  $(HOST_CONFIGARGS) $${srcdiroption} \\\n \t  || exit 1\n-@endif gcc\n+@endif gcc-no-bootstrap\n \n # Don't 'make all' in gcc if it's already been made by 'bootstrap'; that\n # causes trouble.  This wart will be fixed eventually by moving\n@@ -1203,19 +1203,17 @@ maybe-all-gcc:\n @if gcc\n maybe-all-gcc: all-gcc\n all-gcc: configure-gcc\n+@endif gcc\n+@if gcc-no-bootstrap\n \tr=`${PWD_COMMAND}`; export r; \\\n \ts=`cd $(srcdir); ${PWD_COMMAND}`; export s; \\\n+\t$(SET_LIB_PATH) \\\n \t$(GCC_HOST_EXPORTS) \\\n-\tif [ -f stage_last ] ; then \\\n-\t  true ; \\\n-\telif [ -f gcc/stage_last ] ; then \\\n-\t  $(SET_LIB_PATH) \\\n+\tif [ -f gcc/stage_last ] ; then \\\n \t  (cd gcc && $(MAKE) $(GCC_FLAGS_TO_PASS) quickstrap); \\\n \telse \\\n-\t  $(SET_LIB_PATH) \\\n \t  (cd gcc && $(MAKE) $(GCC_FLAGS_TO_PASS) all); \\\n \tfi\n-@endif gcc\n \n # Building GCC uses some tools for rebuilding \"source\" files\n # like texinfo, bison/byacc, etc.  So we must depend on those.\n@@ -1294,7 +1292,8 @@ cross: all-texinfo all-bison all-byacc all-binutils all-gas all-ld\n \t$(SET_LIB_PATH) \\\n \techo \"Building runtime libraries\"; \\\n \t$(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) \\\n-\t  LANGUAGES=\"c c++\" all\n+\t\tLANGUAGES=\"c c++\" all\n+@endif gcc-no-bootstrap\n \n .PHONY: check-gcc maybe-check-gcc\n maybe-check-gcc:\n@@ -1395,6 +1394,7 @@ maybe-[+make_target+]-gcc: [+make_target+]-gcc\n \n [+ ENDFOR recursive_targets +]\n \n+@if gcc-bootstrap\n # ---------------------\n # GCC bootstrap support\n # ---------------------\n@@ -1440,7 +1440,7 @@ objext = .o\n # Real targets act phony if they depend on phony targets; this hack\n # prevents gratuitous rebuilding of stage 1.\n prebootstrap:\n-\t$(MAKE) all-bootstrap\n+\t$(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) all-bootstrap\n \t$(STAMP) prebootstrap\n \n # Flags to pass to stage2 and later makes.\n@@ -1459,39 +1459,40 @@ POSTSTAGE1_FLAGS_TO_PASS = \\\n # * We build only C (and possibly Ada).\n \n [+ FOR bootstrap-stage +]\n-.PHONY: new-stage[+id+]-start new-stage[+id+]-end\n+.PHONY: stage[+id+]-start stage[+id+]-end\n \n-new-stage[+id+]-start:\n-\t[ -f stage_last ] && $(MAKE) new-`cat stage_last`-end || :\n+stage[+id+]-start:\n+\t[ -f stage_last ] && $(MAKE) `cat stage_last`-end || :\n \techo stage[+id+] > stage_last ; \\\n \t[ -d stage[+id+]-gcc ] || mkdir stage[+id+]-gcc; \\\n \tset stage[+id+]-gcc gcc ; @CREATE_LINK_TO_DIR@ [+ IF prev +] ; \\\n \tset stage[+prev+]-gcc prev-gcc ; @CREATE_LINK_TO_DIR@ [+ ENDIF prev +]\n \n-new-stage[+id+]-end:\n+stage[+id+]-end:\n \trm -f stage_last ; \\\n \tset gcc stage[+id+]-gcc ; @UNDO_LINK_TO_DIR@ [+ IF prev +] ; \\\n \tset prev-gcc stage[+prev+]-gcc ; @UNDO_LINK_TO_DIR@ [+ ENDIF prev +]\n \n # Bubble a bugfix through all the stages up to stage [+id+].  They\n # are remade, but not reconfigured.  The next stage (if any) will not\n # be reconfigured as well.\n-.PHONY: new-stage[+id+]-bubble\n-new-stage[+id+]-bubble: [+ IF prev +]new-stage[+prev+]-bubble[+ ENDIF +]\n+.PHONY: stage[+id+]-bubble\n+stage[+id+]-bubble: [+ IF prev +]stage[+prev+]-bubble[+ ENDIF +]\n \t@if [ -f all-stage[+id+]-gcc ] ; then \\\n \t  echo Remaking stage [+id+] ; \\\n \t  rm -f all-stage[+id+]-gcc ; \\\n-\t  $(MAKE) all-stage[+id+]-gcc [+ IF next +] && \\\n+\t  $(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) \\\n+\t    all-stage[+id+]-gcc [+ IF next +] && \\\n \t  if [ -f configure-stage[+next+]-gcc ] ; then \\\n \t    $(STAMP) configure-stage[+next+]-gcc ; \\\n \t  fi [+ ENDIF next +]; \\\n \telse \\\n-\t  $(MAKE) all-stage[+id+]-gcc ; \\\n+\t  $(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) all-stage[+id+]-gcc ; \\\n \tfi\n \n configure-stage[+id+]-gcc: [+ IF prev +] all-stage[+prev+]-gcc [+\n \t  ELSE +] prebootstrap [+ ENDIF prev +]\n-\t$(MAKE) new-stage[+id+]-start\n+\t$(MAKE) stage[+id+]-start\n \t@if [ -f stage[+id+]-gcc/Makefile ] ; then \\\n \t  $(STAMP) configure-stage[+id+]-gcc ; \\\n \t  exit 0; \\\n@@ -1521,7 +1522,7 @@ configure-stage[+id+]-gcc: [+ IF prev +] all-stage[+prev+]-gcc [+\n \t  $(STAMP) ../configure-stage[+id+]-gcc\n \n all-stage[+id+]-gcc: configure-stage[+id+]-gcc\n-\t$(MAKE) new-stage[+id+]-start\n+\t$(MAKE) stage[+id+]-start\n \t@r=`${PWD_COMMAND}`; export r; \\\n \ts=`cd $(srcdir); ${PWD_COMMAND}`; export s; [+ IF prev +] \\\n \t$(STAGE_HOST_EXPORTS) [+ ELSE prev +] \\\n@@ -1534,7 +1535,7 @@ all-stage[+id+]-gcc: configure-stage[+id+]-gcc\n \n [+ IF compare-target +]\n [+compare-target+]: all-stage[+id+]-gcc\n-\t[ -f stage_last ] && $(MAKE) new-`cat stage_last`-end || :\n+\t[ -f stage_last ] && $(MAKE) `cat stage_last`-end || :\n \t@r=`${PWD_COMMAND}`; export r; \\\n \ts=`cd $(srcdir); ${PWD_COMMAND}`; export s; \\\n \trm -f .bad_compare ; \\\n@@ -1559,23 +1560,23 @@ all-stage[+id+]-gcc: configure-stage[+id+]-gcc\n [+ IF bootstrap-target +]\n .PHONY: [+bootstrap-target+]\n [+bootstrap-target+]:\n-\t$(MAKE) new-stage[+id+]-bubble [+\n+\t$(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) stage[+id+]-bubble [+\n \t  IF compare-target +] [+compare-target+] [+\n \t  ENDIF compare-target +] \\\n-\t  new-stage[+id+]-start all new-stage[+id+]-end \n+\t  stage[+id+]-start all stage[+id+]-end \n [+ ENDIF bootstrap-target +]\n \n-.PHONY: new-restage[+id+] distclean-stage[+id+]\n+.PHONY: restage[+id+] distclean-stage[+id+]\n \n distclean-stage[+id+]: [+ IF next +] distclean-stage[+next+] [+ ENDIF next +]\n-\t[ -f stage_last ] && $(MAKE) new-`cat stage_last`-end || :\n+\t[ -f stage_last ] && $(MAKE) `cat stage_last`-end || :\n \trm -rf configure-stage[+id+]-gcc all-stage[+id+]-gcc stage[+id+]-gcc [+\n \t  IF compare-target +][+compare-target+] [+ ENDIF compare-target +]\n \n-new-restage[+id+]: [+ IF next +] distclean-stage[+next+] [+ ENDIF next +]\n+restage[+id+]: [+ IF next +] distclean-stage[+next+] [+ ENDIF next +]\n \trm -rf all-stage[+id+]-gcc [+\n \t  IF compare-target +][+compare-target+] [+ ENDIF compare-target +]\n-\t$(MAKE) [+\n+\t$(MAKE) $(BASE_FLAGS_TO_PASS) $(RECURSE_FLAGS) [+\n \t  IF compare-target +][+compare-target+] [+\n \t  ELSE +] all-stage[+id+]-gcc [+ ENDIF compare-target +]\n \n@@ -1585,6 +1586,7 @@ new-restage[+id+]: [+ IF next +] distclean-stage[+next+] [+ ENDIF next +]\n [+ ENDIF cleanstrap-target +]\n \n [+ ENDFOR bootstrap-stage +]\n+@endif gcc-bootstrap\n \n # --------------------------------------\n # Dependencies between different modules"}, {"sha": "aefa08ca0adc11a67e728bc9ee8f53e4bd939abb", "filename": "configure", "status": "modified", "additions": 100, "deletions": 62, "changes": 162, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f516a7dacf06f446b8e5d321c404a0d47702237b/configure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f516a7dacf06f446b8e5d321c404a0d47702237b/configure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure?ref=f516a7dacf06f446b8e5d321c404a0d47702237b", "patch": "@@ -19,6 +19,8 @@ ac_help=\"$ac_help\n   --with-gmp-dir=PATH     Specify source directory for GMP library\"\n ac_help=\"$ac_help\n   --with-gmp=PATH         Specify directory for installed GMP library\"\n+ac_help=\"$ac_help\n+  --enable-bootstrap     Enable bootstrapping [no]\"\n ac_help=\"$ac_help\n   --enable-serial-[{host,target,build}-]configure\n                           Force sequential configuration of\n@@ -587,7 +589,7 @@ else { echo \"configure: error: can not run $ac_config_sub\" 1>&2; exit 1; }\n fi\n \n echo $ac_n \"checking host system type\"\"... $ac_c\" 1>&6\n-echo \"configure:591: checking host system type\" >&5\n+echo \"configure:593: checking host system type\" >&5\n \n host_alias=$host\n case \"$host_alias\" in\n@@ -608,7 +610,7 @@ host_os=`echo $host | sed 's/^\\([^-]*\\)-\\([^-]*\\)-\\(.*\\)$/\\3/'`\n echo \"$ac_t\"\"$host\" 1>&6\n \n echo $ac_n \"checking target system type\"\"... $ac_c\" 1>&6\n-echo \"configure:612: checking target system type\" >&5\n+echo \"configure:614: checking target system type\" >&5\n \n target_alias=$target\n case \"$target_alias\" in\n@@ -626,7 +628,7 @@ target_os=`echo $target | sed 's/^\\([^-]*\\)-\\([^-]*\\)-\\(.*\\)$/\\3/'`\n echo \"$ac_t\"\"$target\" 1>&6\n \n echo $ac_n \"checking build system type\"\"... $ac_c\" 1>&6\n-echo \"configure:630: checking build system type\" >&5\n+echo \"configure:632: checking build system type\" >&5\n \n build_alias=$build\n case \"$build_alias\" in\n@@ -681,7 +683,7 @@ test \"$program_transform_name\" = \"\" && program_transform_name=\"s,x,x,\"\n # SVR4 /usr/ucb/install, which tries to use the nonexistent group \"staff\"\n # ./install, which can be erroneously created by make from ./install.sh.\n echo $ac_n \"checking for a BSD compatible install\"\"... $ac_c\" 1>&6\n-echo \"configure:685: checking for a BSD compatible install\" >&5\n+echo \"configure:687: checking for a BSD compatible install\" >&5\n if test -z \"$INSTALL\"; then\n if eval \"test \\\"`echo '$''{'ac_cv_path_install'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n@@ -734,7 +736,7 @@ test -z \"$INSTALL_SCRIPT\" && INSTALL_SCRIPT='${INSTALL_PROGRAM}'\n test -z \"$INSTALL_DATA\" && INSTALL_DATA='${INSTALL} -m 644'\n \n echo $ac_n \"checking whether ln -s works\"\"... $ac_c\" 1>&6\n-echo \"configure:738: checking whether ln -s works\" >&5\n+echo \"configure:740: checking whether ln -s works\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_LN_S'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1920,7 +1922,7 @@ fi\n # Extract the first word of \"gcc\", so it can be a program name with args.\n set dummy gcc; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:1924: checking for $ac_word\" >&5\n+echo \"configure:1926: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_CC'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1950,7 +1952,7 @@ if test -z \"$CC\"; then\n   # Extract the first word of \"cc\", so it can be a program name with args.\n set dummy cc; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:1954: checking for $ac_word\" >&5\n+echo \"configure:1956: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_CC'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2001,7 +2003,7 @@ fi\n       # Extract the first word of \"cl\", so it can be a program name with args.\n set dummy cl; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:2005: checking for $ac_word\" >&5\n+echo \"configure:2007: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_CC'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2033,7 +2035,7 @@ fi\n fi\n \n echo $ac_n \"checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works\"\"... $ac_c\" 1>&6\n-echo \"configure:2037: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works\" >&5\n+echo \"configure:2039: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works\" >&5\n \n ac_ext=c\n # CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.\n@@ -2044,12 +2046,12 @@ cross_compiling=$ac_cv_prog_cc_cross\n \n cat > conftest.$ac_ext << EOF\n \n-#line 2048 \"configure\"\n+#line 2050 \"configure\"\n #include \"confdefs.h\"\n \n main(){return(0);}\n EOF\n-if { (eval echo configure:2053: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:2055: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   ac_cv_prog_cc_works=yes\n   # If we can't run a trivial program, we are probably using a cross compiler.\n   if (./conftest; exit) 2>/dev/null; then\n@@ -2075,12 +2077,12 @@ if test $ac_cv_prog_cc_works = no; then\n   { echo \"configure: error: installation or configuration problem: C compiler cannot create executables.\" 1>&2; exit 1; }\n fi\n echo $ac_n \"checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler\"\"... $ac_c\" 1>&6\n-echo \"configure:2079: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler\" >&5\n+echo \"configure:2081: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler\" >&5\n echo \"$ac_t\"\"$ac_cv_prog_cc_cross\" 1>&6\n cross_compiling=$ac_cv_prog_cc_cross\n \n echo $ac_n \"checking whether we are using GNU C\"\"... $ac_c\" 1>&6\n-echo \"configure:2084: checking whether we are using GNU C\" >&5\n+echo \"configure:2086: checking whether we are using GNU C\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_gcc'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2089,7 +2091,7 @@ else\n   yes;\n #endif\n EOF\n-if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:2093: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then\n+if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:2095: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then\n   ac_cv_prog_gcc=yes\n else\n   ac_cv_prog_gcc=no\n@@ -2108,7 +2110,7 @@ ac_test_CFLAGS=\"${CFLAGS+set}\"\n ac_save_CFLAGS=\"$CFLAGS\"\n CFLAGS=\n echo $ac_n \"checking whether ${CC-cc} accepts -g\"\"... $ac_c\" 1>&6\n-echo \"configure:2112: checking whether ${CC-cc} accepts -g\" >&5\n+echo \"configure:2114: checking whether ${CC-cc} accepts -g\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_cc_g'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2144,7 +2146,7 @@ fi\n # Extract the first word of \"${ac_tool_prefix}gnatbind\", so it can be a program name with args.\n set dummy ${ac_tool_prefix}gnatbind; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:2148: checking for $ac_word\" >&5\n+echo \"configure:2150: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_GNATBIND'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2176,7 +2178,7 @@ if test -n \"$ac_tool_prefix\"; then\n   # Extract the first word of \"gnatbind\", so it can be a program name with args.\n set dummy gnatbind; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:2180: checking for $ac_word\" >&5\n+echo \"configure:2182: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_GNATBIND'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2209,7 +2211,7 @@ fi\n fi\n \n echo $ac_n \"checking whether compiler driver understands Ada\"\"... $ac_c\" 1>&6\n-echo \"configure:2213: checking whether compiler driver understands Ada\" >&5\n+echo \"configure:2215: checking whether compiler driver understands Ada\" >&5\n if eval \"test \\\"`echo '$''{'acx_cv_cc_gcc_supports_ada'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2242,7 +2244,7 @@ else\n fi\n \n echo $ac_n \"checking how to compare bootstrapped objects\"\"... $ac_c\" 1>&6\n-echo \"configure:2246: checking how to compare bootstrapped objects\" >&5\n+echo \"configure:2248: checking how to compare bootstrapped objects\" >&5\n if eval \"test \\\"`echo '$''{'gcc_cv_prog_cmp_skip'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2315,9 +2317,9 @@ saved_CFLAGS=\"$CFLAGS\"\n CFLAGS=\"$CFLAGS $gmpinc\"\n # Check GMP actually works\n echo $ac_n \"checking for correct version of gmp.h\"\"... $ac_c\" 1>&6\n-echo \"configure:2319: checking for correct version of gmp.h\" >&5\n+echo \"configure:2321: checking for correct version of gmp.h\" >&5\n cat > conftest.$ac_ext <<EOF\n-#line 2321 \"configure\"\n+#line 2323 \"configure\"\n #include \"confdefs.h\"\n #include \"gmp.h\"\n int main() {\n@@ -2328,7 +2330,7 @@ choke me\n \n ; return 0; }\n EOF\n-if { (eval echo configure:2332: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:2334: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   echo \"$ac_t\"\"yes\" 1>&6\n else\n@@ -2341,19 +2343,19 @@ rm -f conftest*\n \n if test x\"$have_gmp\" = xyes; then\n   echo $ac_n \"checking for mpf_init in -lgmp\"\"... $ac_c\" 1>&6\n-echo \"configure:2345: checking for mpf_init in -lgmp\" >&5\n+echo \"configure:2347: checking for mpf_init in -lgmp\" >&5\n \n   saved_LIBS=\"$LIBS\"\n   LIBS=\"$LIBS $gmplibs\"\n   cat > conftest.$ac_ext <<EOF\n-#line 2350 \"configure\"\n+#line 2352 \"configure\"\n #include \"confdefs.h\"\n #include <gmp.h>\n int main() {\n mpf_t n; mpf_init(n);\n ; return 0; }\n EOF\n-if { (eval echo configure:2357: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:2359: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   echo \"$ac_t\"\"yes\" 1>&6\n else\n@@ -2815,7 +2817,7 @@ do\n # Extract the first word of \"$ac_prog\", so it can be a program name with args.\n set dummy $ac_prog; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:2819: checking for $ac_word\" >&5\n+echo \"configure:2821: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_DEFAULT_YACC'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2850,7 +2852,7 @@ do\n # Extract the first word of \"$ac_prog\", so it can be a program name with args.\n set dummy $ac_prog; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:2854: checking for $ac_word\" >&5\n+echo \"configure:2856: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_DEFAULT_M4'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2885,7 +2887,7 @@ do\n # Extract the first word of \"$ac_prog\", so it can be a program name with args.\n set dummy $ac_prog; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:2889: checking for $ac_word\" >&5\n+echo \"configure:2891: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_DEFAULT_LEX'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3078,6 +3080,41 @@ for module in ${target_configdirs} ; do\n /^@if target-$module\\$/d\n /^@endif target-$module\\$/d\"\n done\n+\n+# Check whether --enable-bootstrap or --disable-bootstrap was given.\n+if test \"${enable_bootstrap+set}\" = set; then\n+  enableval=\"$enable_bootstrap\"\n+  :\n+else\n+  enable_bootstrap=no\n+fi\n+\n+if test -d ${srcdir}/gcc; then\n+  case \"$host:$target:$enable_bootstrap\" in\n+    $build:$build:yes | *:no) ;;\n+    *:yes) { echo \"configure: error: cannot bootstrap a cross-compiler\" 1>&2; exit 1; } ;;\n+    *) { echo \"configure: error: invalid option for --enable-bootstrap\" 1>&2; exit 1; } ;;\n+  esac\n+else\n+  if test $enable_bootstrap = yes; then\n+    { echo \"configure: error: cannot bootstrap without a compiler\" 1>&2; exit 1; }\n+  fi\n+fi\n+\n+case \"$enable_bootstrap\" in\n+  yes)\n+    default_target=new-bootstrap\n+    extrasub=\"$extrasub\n+/^@if gcc-bootstrap\\$/d\n+/^@endif gcc-bootstrap\\$/d\" ;;\n+  no)\n+    default_target=all\n+    extrasub=\"$extrasub\n+/^@if gcc-no-bootstrap\\$/d\n+/^@endif gcc-no-bootstrap\\$/d\" ;;\n+esac\n+\n+\n extrasub=\"$extrasub\n /^@if /,/^@endif /d\"\n \n@@ -3460,7 +3497,7 @@ test -n \"$target_alias\" && ncn_target_tool_prefix=$target_alias-\n   # Extract the first word of \"${ncn_tool_prefix}ar\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}ar; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3464: checking for $ac_word\" >&5\n+echo \"configure:3501: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_AR'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3493,7 +3530,7 @@ if test -z \"$ac_cv_prog_AR\" ; then\n     # Extract the first word of \"ar\", so it can be a program name with args.\n set dummy ar; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3497: checking for $ac_word\" >&5\n+echo \"configure:3534: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_AR'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3532,7 +3569,7 @@ fi\n   # Extract the first word of \"${ncn_tool_prefix}as\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}as; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3536: checking for $ac_word\" >&5\n+echo \"configure:3573: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_AS'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3565,7 +3602,7 @@ if test -z \"$ac_cv_prog_AS\" ; then\n     # Extract the first word of \"as\", so it can be a program name with args.\n set dummy as; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3569: checking for $ac_word\" >&5\n+echo \"configure:3606: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_AS'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3604,7 +3641,7 @@ fi\n   # Extract the first word of \"${ncn_tool_prefix}dlltool\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}dlltool; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3608: checking for $ac_word\" >&5\n+echo \"configure:3645: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_DLLTOOL'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3637,7 +3674,7 @@ if test -z \"$ac_cv_prog_DLLTOOL\" ; then\n     # Extract the first word of \"dlltool\", so it can be a program name with args.\n set dummy dlltool; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3641: checking for $ac_word\" >&5\n+echo \"configure:3678: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_DLLTOOL'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3676,7 +3713,7 @@ fi\n   # Extract the first word of \"${ncn_tool_prefix}ld\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}ld; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3680: checking for $ac_word\" >&5\n+echo \"configure:3717: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_LD'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3709,7 +3746,7 @@ if test -z \"$ac_cv_prog_LD\" ; then\n     # Extract the first word of \"ld\", so it can be a program name with args.\n set dummy ld; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3713: checking for $ac_word\" >&5\n+echo \"configure:3750: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_LD'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3748,7 +3785,7 @@ fi\n   # Extract the first word of \"${ncn_tool_prefix}nm\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}nm; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3752: checking for $ac_word\" >&5\n+echo \"configure:3789: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_NM'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3781,7 +3818,7 @@ if test -z \"$ac_cv_prog_NM\" ; then\n     # Extract the first word of \"nm\", so it can be a program name with args.\n set dummy nm; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3785: checking for $ac_word\" >&5\n+echo \"configure:3822: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_NM'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3820,7 +3857,7 @@ fi\n   # Extract the first word of \"${ncn_tool_prefix}ranlib\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}ranlib; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3824: checking for $ac_word\" >&5\n+echo \"configure:3861: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_RANLIB'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3853,7 +3890,7 @@ if test -z \"$ac_cv_prog_RANLIB\" ; then\n     # Extract the first word of \"ranlib\", so it can be a program name with args.\n set dummy ranlib; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3857: checking for $ac_word\" >&5\n+echo \"configure:3894: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_RANLIB'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3892,7 +3929,7 @@ fi\n   # Extract the first word of \"${ncn_tool_prefix}windres\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}windres; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3896: checking for $ac_word\" >&5\n+echo \"configure:3933: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_WINDRES'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3925,7 +3962,7 @@ if test -z \"$ac_cv_prog_WINDRES\" ; then\n     # Extract the first word of \"windres\", so it can be a program name with args.\n set dummy windres; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3929: checking for $ac_word\" >&5\n+echo \"configure:3966: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_WINDRES'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3964,7 +4001,7 @@ fi\n   # Extract the first word of \"${ncn_tool_prefix}objcopy\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}objcopy; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:3968: checking for $ac_word\" >&5\n+echo \"configure:4005: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_OBJCOPY'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -3997,7 +4034,7 @@ if test -z \"$ac_cv_prog_OBJCOPY\" ; then\n     # Extract the first word of \"objcopy\", so it can be a program name with args.\n set dummy objcopy; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:4001: checking for $ac_word\" >&5\n+echo \"configure:4038: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_OBJCOPY'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4036,7 +4073,7 @@ fi\n   # Extract the first word of \"${ncn_tool_prefix}objdump\", so it can be a program name with args.\n set dummy ${ncn_tool_prefix}objdump; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:4040: checking for $ac_word\" >&5\n+echo \"configure:4077: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_OBJDUMP'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4069,7 +4106,7 @@ if test -z \"$ac_cv_prog_OBJDUMP\" ; then\n     # Extract the first word of \"objdump\", so it can be a program name with args.\n set dummy objdump; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:4073: checking for $ac_word\" >&5\n+echo \"configure:4110: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_OBJDUMP'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4118,7 +4155,7 @@ fi\n   # Extract the first word of \"${ncn_target_tool_prefix}ar\", so it can be a program name with args.\n set dummy ${ncn_target_tool_prefix}ar; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:4122: checking for $ac_word\" >&5\n+echo \"configure:4159: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_CONFIGURED_AR_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4151,7 +4188,7 @@ if test -z \"$ac_cv_prog_CONFIGURED_AR_FOR_TARGET\" ; then\n     # Extract the first word of \"ar\", so it can be a program name with args.\n set dummy ar; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:4155: checking for $ac_word\" >&5\n+echo \"configure:4192: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_CONFIGURED_AR_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4190,7 +4227,7 @@ fi\n   # Extract the first word of \"${ncn_target_tool_prefix}as\", so it can be a program name with args.\n set dummy ${ncn_target_tool_prefix}as; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:4194: checking for $ac_word\" >&5\n+echo \"configure:4231: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_CONFIGURED_AS_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4223,7 +4260,7 @@ if test -z \"$ac_cv_prog_CONFIGURED_AS_FOR_TARGET\" ; then\n     # Extract the first word of \"as\", so it can be a program name with args.\n set dummy as; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:4227: checking for $ac_word\" >&5\n+echo \"configure:4264: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_CONFIGURED_AS_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4262,7 +4299,7 @@ fi\n   # Extract the first word of \"${ncn_target_tool_prefix}dlltool\", so it can be a program name with args.\n set dummy ${ncn_target_tool_prefix}dlltool; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:4266: checking for $ac_word\" >&5\n+echo \"configure:4303: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_CONFIGURED_DLLTOOL_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4295,7 +4332,7 @@ if test -z \"$ac_cv_prog_CONFIGURED_DLLTOOL_FOR_TARGET\" ; then\n     # Extract the first word of \"dlltool\", so it can be a program name with args.\n set dummy dlltool; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:4299: checking for $ac_word\" >&5\n+echo \"configure:4336: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_CONFIGURED_DLLTOOL_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4334,7 +4371,7 @@ fi\n   # Extract the first word of \"${ncn_target_tool_prefix}ld\", so it can be a program name with args.\n set dummy ${ncn_target_tool_prefix}ld; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:4338: checking for $ac_word\" >&5\n+echo \"configure:4375: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_CONFIGURED_LD_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4367,7 +4404,7 @@ if test -z \"$ac_cv_prog_CONFIGURED_LD_FOR_TARGET\" ; then\n     # Extract the first word of \"ld\", so it can be a program name with args.\n set dummy ld; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:4371: checking for $ac_word\" >&5\n+echo \"configure:4408: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_CONFIGURED_LD_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4406,7 +4443,7 @@ fi\n   # Extract the first word of \"${ncn_target_tool_prefix}nm\", so it can be a program name with args.\n set dummy ${ncn_target_tool_prefix}nm; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:4410: checking for $ac_word\" >&5\n+echo \"configure:4447: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_CONFIGURED_NM_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4439,7 +4476,7 @@ if test -z \"$ac_cv_prog_CONFIGURED_NM_FOR_TARGET\" ; then\n     # Extract the first word of \"nm\", so it can be a program name with args.\n set dummy nm; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:4443: checking for $ac_word\" >&5\n+echo \"configure:4480: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_CONFIGURED_NM_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4478,7 +4515,7 @@ fi\n   # Extract the first word of \"${ncn_target_tool_prefix}ranlib\", so it can be a program name with args.\n set dummy ${ncn_target_tool_prefix}ranlib; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:4482: checking for $ac_word\" >&5\n+echo \"configure:4519: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_CONFIGURED_RANLIB_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4511,7 +4548,7 @@ if test -z \"$ac_cv_prog_CONFIGURED_RANLIB_FOR_TARGET\" ; then\n     # Extract the first word of \"ranlib\", so it can be a program name with args.\n set dummy ranlib; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:4515: checking for $ac_word\" >&5\n+echo \"configure:4552: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_CONFIGURED_RANLIB_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4550,7 +4587,7 @@ fi\n   # Extract the first word of \"${ncn_target_tool_prefix}windres\", so it can be a program name with args.\n set dummy ${ncn_target_tool_prefix}windres; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:4554: checking for $ac_word\" >&5\n+echo \"configure:4591: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_CONFIGURED_WINDRES_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4583,7 +4620,7 @@ if test -z \"$ac_cv_prog_CONFIGURED_WINDRES_FOR_TARGET\" ; then\n     # Extract the first word of \"windres\", so it can be a program name with args.\n set dummy windres; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:4587: checking for $ac_word\" >&5\n+echo \"configure:4624: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_ncn_cv_CONFIGURED_WINDRES_FOR_TARGET'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4668,7 +4705,7 @@ RANLIB_FOR_TARGET=${RANLIB_FOR_TARGET}${extra_ranlibflags_for_target}\n NM_FOR_TARGET=${NM_FOR_TARGET}${extra_nmflags_for_target}\n \n echo $ac_n \"checking whether to enable maintainer-specific portions of Makefiles\"\"... $ac_c\" 1>&6\n-echo \"configure:4672: checking whether to enable maintainer-specific portions of Makefiles\" >&5\n+echo \"configure:4709: checking whether to enable maintainer-specific portions of Makefiles\" >&5\n # Check whether --enable-maintainer-mode or --disable-maintainer-mode was given.\n if test \"${enable_maintainer_mode+set}\" = set; then\n   enableval=\"$enable_maintainer_mode\"\n@@ -4715,7 +4752,7 @@ esac\n # gcc for stageN-gcc and stage-prev for stage(N-1).  In case this is not\n # possible, however, we can resort to mv.\n echo $ac_n \"checking if symbolic links between directories work\"\"... $ac_c\" 1>&6\n-echo \"configure:4719: checking if symbolic links between directories work\" >&5\n+echo \"configure:4756: checking if symbolic links between directories work\" >&5\n if eval \"test \\\"`echo '$''{'gcc_cv_prog_ln_s_dir'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -4940,6 +4977,7 @@ s%@stage1_languages@%$stage1_languages%g\n s%@DEFAULT_YACC@%$DEFAULT_YACC%g\n s%@DEFAULT_M4@%$DEFAULT_M4%g\n s%@DEFAULT_LEX@%$DEFAULT_LEX%g\n+s%@default_target@%$default_target%g\n /@serialization_dependencies@/r $serialization_dependencies\n s%@serialization_dependencies@%%g\n /@host_makefile_frag@/r $host_makefile_frag"}, {"sha": "bb6e8d7b2d171ca016bd7a7a4a769c35718f4803", "filename": "configure.in", "status": "modified", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f516a7dacf06f446b8e5d321c404a0d47702237b/configure.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f516a7dacf06f446b8e5d321c404a0d47702237b/configure.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure.in?ref=f516a7dacf06f446b8e5d321c404a0d47702237b", "patch": "@@ -1760,6 +1760,36 @@ for module in ${target_configdirs} ; do\n /^@if target-$module\\$/d\n /^@endif target-$module\\$/d\"\n done\n+\n+AC_ARG_ENABLE([bootstrap],\n+[  --enable-bootstrap     Enable bootstrapping [no]],,\n+enable_bootstrap=no)\n+if test -d ${srcdir}/gcc; then\n+  case \"$host:$target:$enable_bootstrap\" in\n+    $build:$build:yes | *:no) ;;\n+    *:yes) AC_MSG_ERROR([cannot bootstrap a cross-compiler]) ;;\n+    *) AC_MSG_ERROR([invalid option for --enable-bootstrap]) ;;\n+  esac\n+else\n+  if test $enable_bootstrap = yes; then\n+    AC_MSG_ERROR([cannot bootstrap without a compiler])\n+  fi\n+fi\n+\n+case \"$enable_bootstrap\" in\n+  yes)\n+    default_target=new-bootstrap\n+    extrasub=\"$extrasub\n+/^@if gcc-bootstrap\\$/d\n+/^@endif gcc-bootstrap\\$/d\" ;;\n+  no)\n+    default_target=all\n+    extrasub=\"$extrasub\n+/^@if gcc-no-bootstrap\\$/d\n+/^@endif gcc-no-bootstrap\\$/d\" ;;\n+esac\n+AC_SUBST(default_target)\n+\n extrasub=\"$extrasub\n /^@if /,/^@endif /d\"\n "}]}