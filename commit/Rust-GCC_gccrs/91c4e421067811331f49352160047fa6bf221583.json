{"sha": "91c4e421067811331f49352160047fa6bf221583", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTFjNGU0MjEwNjc4MTEzMzFmNDkzNTIxNjAwNDdmYTZiZjIyMTU4Mw==", "commit": {"author": {"name": "David Holsgrove", "email": "david.holsgrove@xilinx.com", "date": "2013-03-04T15:31:49Z"}, "committer": {"name": "Michael Eager", "email": "eager@gcc.gnu.org", "date": "2013-03-04T15:31:49Z"}, "message": "Add microblaze_legitimate_pic_operand method\nPrevents ICE where insn contains an invalid address\n\n\t* config/microblaze/microblaze.c (microblaze_valid_pic_const): New \n\t(microblaze_legitimate_pic_operand): Likewise\n\t* config/microblaze/microblaze.h (LEGITIMATE_PIC_OPERAND_P): calls \n\tnew function microblaze_legitimate_pic_operand\n\t* config/microblaze/microblaze-protos.h\n\t(microblaze_legitimate_pic_operand): Declare.\n\nFrom-SVN: r196434", "tree": {"sha": "87deb0c56699913768af89023edca0b8daa46159", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/87deb0c56699913768af89023edca0b8daa46159"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/91c4e421067811331f49352160047fa6bf221583", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/91c4e421067811331f49352160047fa6bf221583", "html_url": "https://github.com/Rust-GCC/gccrs/commit/91c4e421067811331f49352160047fa6bf221583", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/91c4e421067811331f49352160047fa6bf221583/comments", "author": {"login": "davidholsgrove", "id": 4031547, "node_id": "MDQ6VXNlcjQwMzE1NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4031547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidholsgrove", "html_url": "https://github.com/davidholsgrove", "followers_url": "https://api.github.com/users/davidholsgrove/followers", "following_url": "https://api.github.com/users/davidholsgrove/following{/other_user}", "gists_url": "https://api.github.com/users/davidholsgrove/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidholsgrove/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidholsgrove/subscriptions", "organizations_url": "https://api.github.com/users/davidholsgrove/orgs", "repos_url": "https://api.github.com/users/davidholsgrove/repos", "events_url": "https://api.github.com/users/davidholsgrove/events{/privacy}", "received_events_url": "https://api.github.com/users/davidholsgrove/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "82f8f53a71bf8cb82fd5c9da4f78748e9bf9f754", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82f8f53a71bf8cb82fd5c9da4f78748e9bf9f754", "html_url": "https://github.com/Rust-GCC/gccrs/commit/82f8f53a71bf8cb82fd5c9da4f78748e9bf9f754"}], "stats": {"total": 38, "additions": 37, "deletions": 1}, "files": [{"sha": "8a290e4a0de48d036e2ff35337704e9341a2f6a5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/91c4e421067811331f49352160047fa6bf221583/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/91c4e421067811331f49352160047fa6bf221583/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=91c4e421067811331f49352160047fa6bf221583", "patch": "@@ -1,3 +1,12 @@\n+2013-03-04  David Holsgrove <david.holsgrove@xilinx.com>\n+\n+\t* config/microblaze/microblaze.c (microblaze_valid_pic_const): New \n+\t(microblaze_legitimate_pic_operand): Likewise\n+\t* config/microblaze/microblaze.h (LEGITIMATE_PIC_OPERAND_P): calls \n+\tnew function microblaze_legitimate_pic_operand\n+\t* config/microblaze/microblaze-protos.h\n+\t(microblaze_legitimate_pic_operand): Declare.\n+\n 2013-03-04  Edgar E. Iglesias <edgar.iglesias@gmail.com>\n \n \t*  config/microblaze/predicates.md (call_insn_simple_operand):"}, {"sha": "fe2ac09f86ac09e7b731b1aa39524a42239c9d5d", "filename": "gcc/config/microblaze/microblaze-protos.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/91c4e421067811331f49352160047fa6bf221583/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze-protos.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/91c4e421067811331f49352160047fa6bf221583/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze-protos.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze-protos.h?ref=91c4e421067811331f49352160047fa6bf221583", "patch": "@@ -49,6 +49,7 @@ extern HOST_WIDE_INT microblaze_initial_elimination_offset (int, int);\n extern void microblaze_declare_object (FILE *, const char *, const char *,\n    const char *, int);\n extern void microblaze_asm_output_ident (const char *);\n+extern int microblaze_legitimate_pic_operand (rtx);\n #endif  /* RTX_CODE */\n \n /* Declare functions in microblaze-c.c.  */"}, {"sha": "5286316e0ce299ef384f8081b93db26863f701a7", "filename": "gcc/config/microblaze/microblaze.c", "status": "modified", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/91c4e421067811331f49352160047fa6bf221583/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/91c4e421067811331f49352160047fa6bf221583/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.c?ref=91c4e421067811331f49352160047fa6bf221583", "patch": "@@ -596,6 +596,32 @@ microblaze_legitimate_address_p (enum machine_mode mode, rtx x, bool strict)\n   return microblaze_classify_address (&addr, x, mode, strict);\n }\n \n+int\n+microblaze_valid_pic_const (rtx x)\n+{\n+  switch (GET_CODE (x))\n+    {\n+    case CONST:\n+    case CONST_INT:\n+    case CONST_DOUBLE:\n+      return true;\n+    default:\n+      return false;\n+    }\n+}\n+\n+int\n+microblaze_legitimate_pic_operand (rtx x)\n+{\n+  struct microblaze_address_info addr;\n+\n+  if (pic_address_needs_scratch (x))\n+    return 0;\n+  if (!microblaze_valid_pic_const(x))\n+    return 0;\n+\n+  return 1;\n+}\n \n /* Try machine-dependent ways of modifying an illegitimate address\n    to be legitimate.  If we find one, return the new, valid address."}, {"sha": "c726978800dc444a78a9fbafc7cd34a946b67af8", "filename": "gcc/config/microblaze/microblaze.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/91c4e421067811331f49352160047fa6bf221583/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/91c4e421067811331f49352160047fa6bf221583/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.h?ref=91c4e421067811331f49352160047fa6bf221583", "patch": "@@ -541,7 +541,7 @@ typedef struct microblaze_args\n \n /* Define this, so that when PIC, reload won't try to reload invalid\n    addresses which require two reload registers.  */\n-#define LEGITIMATE_PIC_OPERAND_P(X)  (!pic_address_needs_scratch (X))\n+#define LEGITIMATE_PIC_OPERAND_P(X)  microblaze_legitimate_pic_operand (X)\n \n #define CASE_VECTOR_MODE\t\t\t(SImode)\n "}]}