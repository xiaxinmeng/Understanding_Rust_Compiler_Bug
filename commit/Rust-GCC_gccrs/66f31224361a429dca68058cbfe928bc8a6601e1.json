{"sha": "66f31224361a429dca68058cbfe928bc8a6601e1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjZmMzEyMjQzNjFhNDI5ZGNhNjgwNThjYmZlOTI4YmM4YTY2MDFlMQ==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2019-01-04T15:42:33Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2019-01-04T15:42:33Z"}, "message": "Fix test failure with old Copy-On-Write std::string\n\n\t* testsuite/27_io/filesystem/filesystem_error/copy.cc: Fix static\n\tassertion failures with old std::string ABI.\n\nFrom-SVN: r267577", "tree": {"sha": "618a553d10d263caa6b2918cb842692f262aafb3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/618a553d10d263caa6b2918cb842692f262aafb3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/66f31224361a429dca68058cbfe928bc8a6601e1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66f31224361a429dca68058cbfe928bc8a6601e1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/66f31224361a429dca68058cbfe928bc8a6601e1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66f31224361a429dca68058cbfe928bc8a6601e1/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "73d968d94561fd521bc6a9af993ed1d1ebba8459", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73d968d94561fd521bc6a9af993ed1d1ebba8459", "html_url": "https://github.com/Rust-GCC/gccrs/commit/73d968d94561fd521bc6a9af993ed1d1ebba8459"}], "stats": {"total": 13, "additions": 13, "deletions": 0}, "files": [{"sha": "00550d8ad48056c39dc8ed7701f362251da23926", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66f31224361a429dca68058cbfe928bc8a6601e1/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66f31224361a429dca68058cbfe928bc8a6601e1/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=66f31224361a429dca68058cbfe928bc8a6601e1", "patch": "@@ -1,5 +1,8 @@\n 2019-01-04  Jonathan Wakely  <jwakely@redhat.com>\n \n+\t* testsuite/27_io/filesystem/filesystem_error/copy.cc: Fix static\n+\tassertion failures with old std::string ABI.\n+\n \t* include/bits/fs_path.h (path::_List::erase): Replace both overloads\n \twith ...\n \t(path::pop_back(), path::_M_erase_from(const_iterator)): New member"}, {"sha": "71eac38e0d3b711f164a24ecdb3ba3972fa33cfe", "filename": "libstdc++-v3/testsuite/27_io/filesystem/filesystem_error/copy.cc", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66f31224361a429dca68058cbfe928bc8a6601e1/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Ffilesystem%2Ffilesystem_error%2Fcopy.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66f31224361a429dca68058cbfe928bc8a6601e1/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Ffilesystem%2Ffilesystem_error%2Fcopy.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Ffilesystem%2Ffilesystem_error%2Fcopy.cc?ref=66f31224361a429dca68058cbfe928bc8a6601e1", "patch": "@@ -24,9 +24,19 @@\n \n using std::filesystem::filesystem_error;\n \n+// The COW std::string does not have noexcept copies, because copying a\n+// \"leaked\" string can throw (and for fully-dynamic strings, copying the\n+// empty rep can also throw).\n+// That's OK, because we know that the std::string in the std::runtime_error\n+// or std::logic_error base class won't be leaked (and usually won't be empty).\n+// The is_nothrow_xxx type traits don't know that though, so we can only\n+// check them for the cxx11 ABI, which uses __cow_string, which has noexcept\n+// copies.\n+#if _GLIBCXX_USE_CXX11_ABI\n // PR libstdc++/83306\n static_assert(std::is_nothrow_copy_constructible_v<filesystem_error>);\n static_assert(std::is_nothrow_copy_assignable_v<filesystem_error>);\n+#endif\n \n void\n test01()"}]}