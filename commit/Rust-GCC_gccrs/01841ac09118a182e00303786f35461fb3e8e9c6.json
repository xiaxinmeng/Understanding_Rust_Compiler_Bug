{"sha": "01841ac09118a182e00303786f35461fb3e8e9c6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDE4NDFhYzA5MTE4YTE4MmUwMDMwMzc4NmYzNTQ2MWZiM2U4ZTljNg==", "commit": {"author": {"name": "Andreas Krebbel", "email": "Andreas.Krebbel@de.ibm.com", "date": "2011-03-22T07:29:53Z"}, "committer": {"name": "Andreas Krebbel", "email": "krebbel@gcc.gnu.org", "date": "2011-03-22T07:29:53Z"}, "message": "s390.c (s390_delegitimize_address): Handle PLTOFF and PLT unspecs.\n\n2011-03-22  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>\n\n\t* config/s390/s390.c (s390_delegitimize_address): Handle PLTOFF\n\tand PLT unspecs.\n\nFrom-SVN: r171279", "tree": {"sha": "7f5e12121098d33ad3588145b9583622e913f236", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7f5e12121098d33ad3588145b9583622e913f236"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/01841ac09118a182e00303786f35461fb3e8e9c6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/01841ac09118a182e00303786f35461fb3e8e9c6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/01841ac09118a182e00303786f35461fb3e8e9c6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/01841ac09118a182e00303786f35461fb3e8e9c6/comments", "author": null, "committer": null, "parents": [{"sha": "7f2acfca7dca4a3bef08ce1c9b611b7a5b96a3e5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7f2acfca7dca4a3bef08ce1c9b611b7a5b96a3e5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7f2acfca7dca4a3bef08ce1c9b611b7a5b96a3e5"}], "stats": {"total": 27, "additions": 24, "deletions": 3}, "files": [{"sha": "1e44957cffc94205c528e27a8a46e2c4eec03fcb", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/01841ac09118a182e00303786f35461fb3e8e9c6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/01841ac09118a182e00303786f35461fb3e8e9c6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=01841ac09118a182e00303786f35461fb3e8e9c6", "patch": "@@ -1,3 +1,8 @@\n+2011-03-22  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>\n+\n+\t* config/s390/s390.c (s390_delegitimize_address): Handle PLTOFF\n+\tand PLT unspecs.\n+\n 2011-03-21  Richard Sandiford  <richard.sandiford@linaro.org>\n \n \t* expr.h (prepare_operand): Move to..."}, {"sha": "050129847c14e829d0a6ba1fb8ace9c109b6b70c", "filename": "gcc/config/s390/s390.c", "status": "modified", "additions": 19, "deletions": 3, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/01841ac09118a182e00303786f35461fb3e8e9c6/gcc%2Fconfig%2Fs390%2Fs390.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/01841ac09118a182e00303786f35461fb3e8e9c6/gcc%2Fconfig%2Fs390%2Fs390.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fs390%2Fs390.c?ref=01841ac09118a182e00303786f35461fb3e8e9c6", "patch": "@@ -5019,16 +5019,27 @@ s390_delegitimize_address (rtx orig_x)\n   /* Extract the symbol ref from:\n      (plus:SI (reg:SI 12 %r12)\n               (const:SI (unspec:SI [(symbol_ref/f:SI (\"*.LC0\"))]\n-\t                            UNSPEC_GOTOFF)))  */\n+\t                            UNSPEC_GOTOFF/PLTOFF)))\n+     and\n+     (plus:SI (reg:SI 12 %r12)\n+              (const:SI (plus:SI (unspec:SI [(symbol_ref:SI (\"L\"))]\n+                                             UNSPEC_GOTOFF/PLTOFF)\n+\t\t\t\t (const_int 4 [0x4]))))  */\n   if (GET_CODE (x) == PLUS\n       && REG_P (XEXP (x, 0))\n       && REGNO (XEXP (x, 0)) == PIC_OFFSET_TABLE_REGNUM\n       && GET_CODE (XEXP (x, 1)) == CONST)\n     {\n       /* The const operand.  */\n       y = XEXP (XEXP (x, 1), 0);\n+\n+      if (GET_CODE (y) == PLUS\n+\t  && GET_CODE (XEXP (y, 1)) == CONST_INT)\n+\ty = XEXP (y, 0);\n+\n       if (GET_CODE (y) == UNSPEC\n-\t  && XINT (y, 1) == UNSPEC_GOTOFF)\n+\t  && (XINT (y, 1) == UNSPEC_GOTOFF\n+\t      || XINT (y, 1) == UNSPEC_PLTOFF))\n \treturn XVECEXP (y, 0, 0);\n     }\n \n@@ -5050,9 +5061,14 @@ s390_delegitimize_address (rtx orig_x)\n     }\n   else if (GET_CODE (x) == CONST)\n     {\n+      /* Extract the symbol ref from:\n+\t (mem:QI (const:DI (unspec:DI [(symbol_ref:DI (\"foo\"))]\n+\t                               UNSPEC_PLT/GOTENT)))  */\n+\n       y = XEXP (x, 0);\n       if (GET_CODE (y) == UNSPEC\n-\t  && XINT (y, 1) == UNSPEC_GOTENT)\n+\t  && (XINT (y, 1) == UNSPEC_GOTENT\n+\t      || XINT (y, 1) == UNSPEC_PLT))\n \ty = XVECEXP (y, 0, 0);\n       else\n \treturn orig_x;"}]}