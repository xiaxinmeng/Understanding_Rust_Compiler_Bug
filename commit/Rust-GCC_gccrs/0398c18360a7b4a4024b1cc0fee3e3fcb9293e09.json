{"sha": "0398c18360a7b4a4024b1cc0fee3e3fcb9293e09", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDM5OGMxODM2MGE3YjRhNDAyNGIxY2MwZmVlM2UzZmNiOTI5M2UwOQ==", "commit": {"author": {"name": "Ryan Burn", "email": "contact@rnburn.com", "date": "2015-11-19T18:25:38Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2015-11-19T18:25:38Z"}, "message": "re PR c++/68396 (function auto-deduced return types get incorrectly classified as parameter packs)\n\n\tPR c++/68396\n\n2015-11-19  Ryan Burn  <contact@rnburn.com>\n\n\t* pt.c (find_parameter_packs_r) [DECLTYPE_TYPE]: When traversing\n\tthe DECLTYPE_TYPE_EXPR, set type_pack_expansion_p to false.\n\nFrom-SVN: r230620", "tree": {"sha": "5545a521a76bfa949a8dad755acf2c5c815513e2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5545a521a76bfa949a8dad755acf2c5c815513e2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0398c18360a7b4a4024b1cc0fee3e3fcb9293e09", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0398c18360a7b4a4024b1cc0fee3e3fcb9293e09", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0398c18360a7b4a4024b1cc0fee3e3fcb9293e09", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0398c18360a7b4a4024b1cc0fee3e3fcb9293e09/comments", "author": null, "committer": null, "parents": [{"sha": "498cb3c3200161be080af98733be859294cd439b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/498cb3c3200161be080af98733be859294cd439b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/498cb3c3200161be080af98733be859294cd439b"}], "stats": {"total": 35, "additions": 35, "deletions": 0}, "files": [{"sha": "d7804a0edae0e3e0bc888e6267d0a3ab2e524239", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0398c18360a7b4a4024b1cc0fee3e3fcb9293e09/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0398c18360a7b4a4024b1cc0fee3e3fcb9293e09/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=0398c18360a7b4a4024b1cc0fee3e3fcb9293e09", "patch": "@@ -1,3 +1,9 @@\n+2015-11-19  Ryan Burn  <contact@rnburn.com>\n+\n+\tPR c++/68396\n+\t* pt.c (find_parameter_packs_r) [DECLTYPE_TYPE]: When traversing\n+\tthe DECLTYPE_TYPE_EXPR, set type_pack_expansion_p to false.\n+\n 2015-11-19  Cesar Philippidis  <cesar@codesourcery.com>\n \n \t* parser.h (struct cp_omp_declare_simd_data): Add clauses member."}, {"sha": "b4a5e71b521b5f193afd5f2ee4fac2234959b57c", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0398c18360a7b4a4024b1cc0fee3e3fcb9293e09/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0398c18360a7b4a4024b1cc0fee3e3fcb9293e09/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=0398c18360a7b4a4024b1cc0fee3e3fcb9293e09", "patch": "@@ -3551,6 +3551,20 @@ find_parameter_packs_r (tree *tp, int *walk_subtrees, void* data)\n       *walk_subtrees = 0;\n       return NULL_TREE;\n \n+    case DECLTYPE_TYPE:\n+      {\n+\t/* When traversing a DECLTYPE_TYPE_EXPR, we need to set\n+\t   type_pack_expansion_p to false so that any placeholders\n+\t   within the expression don't get marked as parameter packs.  */\n+\tbool type_pack_expansion_p = ppd->type_pack_expansion_p;\n+\tppd->type_pack_expansion_p = false;\n+\tcp_walk_tree (&DECLTYPE_TYPE_EXPR (t), &find_parameter_packs_r,\n+\t\t      ppd, ppd->visited);\n+\tppd->type_pack_expansion_p = type_pack_expansion_p;\n+\t*walk_subtrees = 0;\n+\treturn NULL_TREE;\n+      }\n+\n     default:\n       return NULL_TREE;\n     }"}, {"sha": "2027d6ef967cc412231188aa0d9df3ccd22b644b", "filename": "gcc/testsuite/g++.dg/cpp1y/pr68396.C", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0398c18360a7b4a4024b1cc0fee3e3fcb9293e09/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fpr68396.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0398c18360a7b4a4024b1cc0fee3e3fcb9293e09/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fpr68396.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fpr68396.C?ref=0398c18360a7b4a4024b1cc0fee3e3fcb9293e09", "patch": "@@ -0,0 +1,15 @@\n+// { dg-do compile { target c++14 } }\n+\n+template <unsigned>\n+auto f () {\n+  return 2;\n+}\n+\n+template <class>\n+class A {};\n+\n+template <int... Ix>\n+auto g () {\n+  A<decltype(f<Ix> ())...>();\n+  return f<2> ();\n+}"}]}