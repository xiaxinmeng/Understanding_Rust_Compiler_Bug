{"sha": "6ac6529e155c9baa0aaaed7aca06bd38ebda5b43", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmFjNjUyOWUxNTVjOWJhYTBhYWFlZDdhY2EwNmJkMzhlYmRhNWI0Mw==", "commit": {"author": {"name": "JunMa", "email": "JunMa@linux.alibaba.com", "date": "2020-01-21T02:29:34Z"}, "committer": {"name": "JunMa", "email": "JunMa@linux.alibaba.com", "date": "2020-01-22T06:36:13Z"}, "message": "Add error check on return value of build_co_await\n\ngcc/cp/ChangeLog\n\t* coroutines.cc (finish_co_await_expr): Add error check on return\n\tvalue of build_co_await.\n\t(finish_co_yield_expr): Ditto.", "tree": {"sha": "4f813f9a0540842ff6f7ed8a498cad12f31a0d2d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4f813f9a0540842ff6f7ed8a498cad12f31a0d2d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6ac6529e155c9baa0aaaed7aca06bd38ebda5b43", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6ac6529e155c9baa0aaaed7aca06bd38ebda5b43", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6ac6529e155c9baa0aaaed7aca06bd38ebda5b43", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6ac6529e155c9baa0aaaed7aca06bd38ebda5b43/comments", "author": {"login": "junparser", "id": 59546948, "node_id": "MDQ6VXNlcjU5NTQ2OTQ4", "avatar_url": "https://avatars.githubusercontent.com/u/59546948?v=4", "gravatar_id": "", "url": "https://api.github.com/users/junparser", "html_url": "https://github.com/junparser", "followers_url": "https://api.github.com/users/junparser/followers", "following_url": "https://api.github.com/users/junparser/following{/other_user}", "gists_url": "https://api.github.com/users/junparser/gists{/gist_id}", "starred_url": "https://api.github.com/users/junparser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/junparser/subscriptions", "organizations_url": "https://api.github.com/users/junparser/orgs", "repos_url": "https://api.github.com/users/junparser/repos", "events_url": "https://api.github.com/users/junparser/events{/privacy}", "received_events_url": "https://api.github.com/users/junparser/received_events", "type": "User", "site_admin": false}, "committer": {"login": "junparser", "id": 59546948, "node_id": "MDQ6VXNlcjU5NTQ2OTQ4", "avatar_url": "https://avatars.githubusercontent.com/u/59546948?v=4", "gravatar_id": "", "url": "https://api.github.com/users/junparser", "html_url": "https://github.com/junparser", "followers_url": "https://api.github.com/users/junparser/followers", "following_url": "https://api.github.com/users/junparser/following{/other_user}", "gists_url": "https://api.github.com/users/junparser/gists{/gist_id}", "starred_url": "https://api.github.com/users/junparser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/junparser/subscriptions", "organizations_url": "https://api.github.com/users/junparser/orgs", "repos_url": "https://api.github.com/users/junparser/repos", "events_url": "https://api.github.com/users/junparser/events{/privacy}", "received_events_url": "https://api.github.com/users/junparser/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c75199b716ed54638ce8949d0f1f4ef71c0b31a5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c75199b716ed54638ce8949d0f1f4ef71c0b31a5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c75199b716ed54638ce8949d0f1f4ef71c0b31a5"}], "stats": {"total": 21, "additions": 16, "deletions": 5}, "files": [{"sha": "4c195c48b030ffa5b107381ee6ce9a39c5f789fa", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6ac6529e155c9baa0aaaed7aca06bd38ebda5b43/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6ac6529e155c9baa0aaaed7aca06bd38ebda5b43/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=6ac6529e155c9baa0aaaed7aca06bd38ebda5b43", "patch": "@@ -1,3 +1,9 @@\n+2020-01-22  Jun Ma <JunMa@linux.alibaba.com>\n+\n+\t* coroutines.cc (finish_co_await_expr): Add error check on return\n+\tvalue of build_co_await.\n+\t(finish_co_yield_expr,): Ditto.\n+\n 2020-01-22  Jun Ma <JunMa@linux.alibaba.com>\n \n \t* coroutines.cc (lookup_awaitable_member): Lookup an awaitable member."}, {"sha": "81fb8c924a773b9ae195f33d0f9769f3fc9ab97f", "filename": "gcc/cp/coroutines.cc", "status": "modified", "additions": 10, "deletions": 5, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6ac6529e155c9baa0aaaed7aca06bd38ebda5b43/gcc%2Fcp%2Fcoroutines.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6ac6529e155c9baa0aaaed7aca06bd38ebda5b43/gcc%2Fcp%2Fcoroutines.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcoroutines.cc?ref=6ac6529e155c9baa0aaaed7aca06bd38ebda5b43", "patch": "@@ -819,8 +819,11 @@ finish_co_await_expr (location_t kw, tree expr)\n \n   /* Now we want to build co_await a.  */\n   tree op = build_co_await (kw, a, CO_AWAIT_SUSPEND_POINT);\n-  TREE_SIDE_EFFECTS (op) = 1;\n-  SET_EXPR_LOCATION (op, kw);\n+  if (op != error_mark_node)\n+    {\n+      TREE_SIDE_EFFECTS (op) = 1;\n+      SET_EXPR_LOCATION (op, kw);\n+    }\n \n   return op;\n }\n@@ -885,9 +888,11 @@ finish_co_yield_expr (location_t kw, tree expr)\n      promise transform_await().  */\n \n   tree op = build_co_await (kw, yield_call, CO_YIELD_SUSPEND_POINT);\n-\n-  op = build2_loc (kw, CO_YIELD_EXPR, TREE_TYPE (op), expr, op);\n-  TREE_SIDE_EFFECTS (op) = 1;\n+  if (op != error_mark_node)\n+    {\n+      op = build2_loc (kw, CO_YIELD_EXPR, TREE_TYPE (op), expr, op);\n+      TREE_SIDE_EFFECTS (op) = 1;\n+    }\n \n   return op;\n }"}]}