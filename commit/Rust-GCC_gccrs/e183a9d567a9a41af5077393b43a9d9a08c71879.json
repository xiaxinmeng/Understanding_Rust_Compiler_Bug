{"sha": "e183a9d567a9a41af5077393b43a9d9a08c71879", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTE4M2E5ZDU2N2E5YTQxYWY1MDc3MzkzYjQzYTlkOWEwOGM3MTg3OQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2015-04-12T20:49:37Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2015-04-12T20:49:37Z"}, "message": "gcc_release: For RELEASE_MAJOR 5+ only use the major number in branch name.\n\n\t* gcc_release: For RELEASE_MAJOR 5+ only use the major\n\tnumber in branch name.  When doing final release of 5+,\n\tif BASE-VER doesn't match release, but is *.*.1 for the\n\tone smaller minor version, bump BASE-VER.\n\nFrom-SVN: r222031", "tree": {"sha": "c9b934d91fbf9713dc8612ad51b180d45c763a46", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c9b934d91fbf9713dc8612ad51b180d45c763a46"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e183a9d567a9a41af5077393b43a9d9a08c71879", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e183a9d567a9a41af5077393b43a9d9a08c71879", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e183a9d567a9a41af5077393b43a9d9a08c71879", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e183a9d567a9a41af5077393b43a9d9a08c71879/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "7d83fb55331a2b77cebc17466e6a60ccfd424f3e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d83fb55331a2b77cebc17466e6a60ccfd424f3e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7d83fb55331a2b77cebc17466e6a60ccfd424f3e"}], "stats": {"total": 29, "additions": 25, "deletions": 4}, "files": [{"sha": "5e152295c52903f8e46a0accbd5701d73545ab56", "filename": "maintainer-scripts/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e183a9d567a9a41af5077393b43a9d9a08c71879/maintainer-scripts%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e183a9d567a9a41af5077393b43a9d9a08c71879/maintainer-scripts%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/maintainer-scripts%2FChangeLog?ref=e183a9d567a9a41af5077393b43a9d9a08c71879", "patch": "@@ -1,5 +1,10 @@\n 2015-04-12  Jakub Jelinek  <jakub@redhat.com>\n \n+\t* gcc_release: For RELEASE_MAJOR 5+ only use the major\n+\tnumber in branch name.  When doing final release of 5+,\n+\tif BASE-VER doesn't match release, but is *.*.1 for the\n+\tone smaller minor version, bump BASE-VER.\n+\n \t* crontab: Enable snapshots from gcc-5-branch.\n \n 2015-04-07  Gerald Pfeifer  <gerald@pfeifer.com>"}, {"sha": "80ddda1e26bde99ef9577c378166a7de9d776643", "filename": "maintainer-scripts/gcc_release", "status": "modified", "additions": 20, "deletions": 4, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e183a9d567a9a41af5077393b43a9d9a08c71879/maintainer-scripts%2Fgcc_release", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e183a9d567a9a41af5077393b43a9d9a08c71879/maintainer-scripts%2Fgcc_release", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/maintainer-scripts%2Fgcc_release?ref=e183a9d567a9a41af5077393b43a9d9a08c71879", "patch": "@@ -9,7 +9,7 @@\n # Contents:\n #   Script to create a GCC release.\n #\n-# Copyright (c) 2001-2014 Free Software Foundation.\n+# Copyright (c) 2001-2015 Free Software Foundation.\n #\n # This file is part of GCC.\n #\n@@ -130,8 +130,20 @@ EOF\n \n     # Update gcc/DEV-PHASE.\n \n-    [ `cat ${SOURCE_DIRECTORY}/gcc/BASE-VER` = ${RELEASE} ] || \\\n-    error \"Release number ${RELEASE} does not match BASE-VER\"\n+    if [ `cat ${SOURCE_DIRECTORY}/gcc/BASE-VER` = ${RELEASE} ]; then\n+      [ ${RELEASE_MAJOR} -lt 5 ] && \\\n+\terror \"Release number ${RELEASE} does not match BASE-VER\"\n+      if [ `cat ${SOURCE_DIRECTORY}/gcc/BASE-VER` \\\n+\t   = ${RELEASE_MAJOR}.`expr ${RELEASE_MINOR} - 1`.1 \\\n+\t   -a x${RELEASE_REVISION} = x0 ]; then\n+\t(changedir ${SOURCE_DIRECTORY}/gcc && \\\n+\t echo ${RELEASE} > BASE-VER && \\\n+\t ${SVN} -q ci -m 'Bump release' BASE-VER) || \\\n+\terror \"Could not update BASE-VER\"\n+      else\n+\terror \"Release number ${RELEASE} does not match BASE-VER\"\n+      fi\n+    fi\n     (changedir ${SOURCE_DIRECTORY}/gcc && \\\n      : > DEV-PHASE && \\\n      ${SVN} -q ci -m 'Mark as release' DEV-PHASE) || \\\n@@ -605,7 +617,11 @@ if [ $SNAPSHOT -eq 0 ]; then\n \n   # Compute the name of the branch, which is based solely on the major\n   # and minor release numbers.\n-  SVNBRANCH=\"branches/gcc-${RELEASE_MAJOR}_${RELEASE_MINOR}-branch\"\n+  if [ ${RELEASE_MAJOR} -ge 5 ]; then\n+    SVNBRANCH=\"branches/gcc-${RELEASE_MAJOR}-branch\"\n+  else\n+    SVNBRANCH=\"branches/gcc-${RELEASE_MAJOR}_${RELEASE_MINOR}-branch\"\n+  fi\n \n   # If this is not a final release, set various parameters accordingly.\n   if [ ${FINAL} -ne 1 ]; then"}]}