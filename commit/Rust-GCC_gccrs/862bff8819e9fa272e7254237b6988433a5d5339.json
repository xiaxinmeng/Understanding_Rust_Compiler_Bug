{"sha": "862bff8819e9fa272e7254237b6988433a5d5339", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODYyYmZmODgxOWU5ZmEyNzJlNzI1NDIzN2I2OTg4NDMzYTVkNTMzOQ==", "commit": {"author": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1997-03-21T15:49:58Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1997-03-21T15:49:58Z"}, "message": "mn10300.c (expand_epilogue): Correctly handle functions with large frames, but no callee register saves.\n\n        * mn10300/mn10300.c (expand_epilogue): Correctly handle functions\n        with large frames, but no callee register saves.\n\n        * mn10300/mn1300.md (movdf, movdi): Handle overlapping moves.\n\nFrom-SVN: r13757", "tree": {"sha": "48f68413208dff45ccac5a4fcb8ce27dd25ae179", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/48f68413208dff45ccac5a4fcb8ce27dd25ae179"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/862bff8819e9fa272e7254237b6988433a5d5339", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/862bff8819e9fa272e7254237b6988433a5d5339", "html_url": "https://github.com/Rust-GCC/gccrs/commit/862bff8819e9fa272e7254237b6988433a5d5339", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/862bff8819e9fa272e7254237b6988433a5d5339/comments", "author": null, "committer": null, "parents": [{"sha": "90304f64f2e2d5eb9f64e3a4d2a5cc674374a3a7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/90304f64f2e2d5eb9f64e3a4d2a5cc674374a3a7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/90304f64f2e2d5eb9f64e3a4d2a5cc674374a3a7"}], "stats": {"total": 106, "additions": 82, "deletions": 24}, "files": [{"sha": "c36ee9e85f70c8d3836293a1b2722514b12b245f", "filename": "gcc/config/mn10300/mn10300.md", "status": "modified", "additions": 82, "deletions": 24, "changes": 106, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/862bff8819e9fa272e7254237b6988433a5d5339/gcc%2Fconfig%2Fmn10300%2Fmn10300.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/862bff8819e9fa272e7254237b6988433a5d5339/gcc%2Fconfig%2Fmn10300%2Fmn10300.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmn10300%2Fmn10300.md?ref=862bff8819e9fa272e7254237b6988433a5d5339", "patch": "@@ -183,18 +183,47 @@\n \t(match_operand:DI 1 \"general_operand\" \"0,0,I,d,a,d,a,dim,aim,dim,aim\"))]\n   \"register_operand (operands[0], DImode)\n    || register_operand (operands[1], DImode)\"\n-  \"@\n-  nop\n-  nop\n-  clr %L0\\;clr %H0\n-  mov %L1,%L0\\;mov %H1,%H0\n-  mov %L1,%L0\\;mov %H1,%H0\n-  mov %L1,%L0\\;mov %H1,%H0\n-  mov %L1,%L0\\;mov %H1,%H0\n-  mov %L1,%L0\\;mov %H1,%H0\n-  mov %L1,%L0\\;mov %H1,%H0\n-  mov %L1,%L0\\;mov %H1,%H0\n-  mov %L1,%L0\\;mov %H1,%H0\"\n+  \"*\n+{\n+  switch (which_alternative)\n+    {\n+      case 0:\n+      case 1:\n+\treturn \\\"nop\\\";\n+\n+      case 2:\n+\treturn \\\"clr %L0\\;clr %H0\\\";\n+\n+      case 3:\n+      case 4:\n+      case 5:\n+      case 6:\n+      case 7:\n+      case 8:\n+      case 9:\n+      case 10:\n+\tif (GET_CODE (operands[1]) == MEM\n+\t    && reg_overlap_mentioned_p (operands[0], XEXP (operands[1], 0)))\n+\t  {\n+\t    rtx temp = operands[0];\n+\n+\t    while (GET_CODE (temp) == SUBREG)\n+\t      temp = SUBREG_REG (temp);\n+\n+\t    if (GET_CODE (temp) != REG)\n+\t      abort ();\n+\n+\t    if (reg_overlap_mentioned_p (gen_rtx (REG, SImode, REGNO (temp)),\n+\t\t\t\t\t XEXP (operands[1], 0)))\n+\t      return \\\"mov %H1,%H0\\;mov %L1,%L0\\\";\n+\t    else\n+\t      return \\\"mov %L1,%L0\\;mov %H1,%H0\\\";\n+\t      \n+\t  }\n+\telse\n+\t  return \\\"mov %L1,%L0\\;mov %H1,%H0\\\";\n+    }\n+}\"\n   [(set_attr \"cc\" \"none,none,clobber,none_0hit,none_0hit,none_0hit,none_0hit,none_0hit,none_0hit,none_0hit,none_0hit\")])\n \n (define_expand \"movdf\"\n@@ -214,18 +243,47 @@\n \t(match_operand:DF 1 \"general_operand\" \"0,0,G,d,a,d,a,dim,aim,dim,aim\"))]\n   \"register_operand (operands[0], DFmode)\n    || register_operand (operands[1], DFmode)\"\n-  \"@\n-  nop\n-  nop\n-  clr %L0\\;clr %H0\n-  mov %L1,%L0\\;mov %H1,%H0\n-  mov %L1,%L0\\;mov %H1,%H0\n-  mov %L1,%L0\\;mov %H1,%H0\n-  mov %L1,%L0\\;mov %H1,%H0\n-  mov %L1,%L0\\;mov %H1,%H0\n-  mov %L1,%L0\\;mov %H1,%H0\n-  mov %L1,%L0\\;mov %H1,%H0\n-  mov %L1,%L0\\;mov %H1,%H0\"\n+  \"*\n+{\n+  switch (which_alternative)\n+    {\n+      case 0:\n+      case 1:\n+\treturn \\\"nop\\\";\n+\n+      case 2:\n+\treturn \\\"clr %L0\\;clr %H0\\\";\n+\n+      case 3:\n+      case 4:\n+      case 5:\n+      case 6:\n+      case 7:\n+      case 8:\n+      case 9:\n+      case 10:\n+\tif (GET_CODE (operands[1]) == MEM\n+\t    && reg_overlap_mentioned_p (operands[0], XEXP (operands[1], 0)))\n+\t  {\n+\t    rtx temp = operands[0];\n+\n+\t    while (GET_CODE (temp) == SUBREG)\n+\t      temp = SUBREG_REG (temp);\n+\n+\t    if (GET_CODE (temp) != REG)\n+\t      abort ();\n+\n+\t    if (reg_overlap_mentioned_p (gen_rtx (REG, SImode, REGNO (temp)),\n+\t\t\t\t\t XEXP (operands[1], 0)))\n+\t      return \\\"mov %H1,%H0\\;mov %L1,%L0\\\";\n+\t    else\n+\t      return \\\"mov %L1,%L0\\;mov %H1,%H0\\\";\n+\t      \n+\t  }\n+\telse\n+\t  return \\\"mov %L1,%L0\\;mov %H1,%H0\\\";\n+    }\n+}\"\n   [(set_attr \"cc\" \"none,none,clobber,none_0hit,none_0hit,none_0hit,none_0hit,none_0hit,none_0hit,none_0hit,none_0hit\")])\n   \n "}]}