{"sha": "301f44023e0c46542329b5f77763685529a46267", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzAxZjQ0MDIzZTBjNDY1NDIzMjliNWY3Nzc2MzY4NTUyOWE0NjI2Nw==", "commit": {"author": {"name": "Yaakov Selkowitz", "email": "yselkowi@redhat.com", "date": "2014-08-19T15:21:22Z"}, "committer": {"name": "Kai Tietz", "email": "ktietz@gcc.gnu.org", "date": "2014-08-19T15:21:22Z"}, "message": "config.gcc (*-*-cygwin*): Use __cxa_atexit by default.\n\n2014-08-19  Yaakov Selkowitz  <yselkowi@redhat.com>\n\n\t* config.gcc (*-*-cygwin*): Use __cxa_atexit by default.\n\t(extra_options): Add i386/cygwin.opt.\n\t* config/i386/cygwin.h (STARTFILE_SPEC): Use crtbeginS.o if shared.\n\t(CPP_SPEC): Accept -pthread.\n\t(LINK_SPEC): Ditto.\n\t(GOMP_SELF_SPECS): Update comment.\n\t* config/i386/cygwin.opt: New file for -pthread flag.\n\nFrom-SVN: r214161", "tree": {"sha": "120983161c5b777e07ffab4db007b3cf1f6d8d29", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/120983161c5b777e07ffab4db007b3cf1f6d8d29"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/301f44023e0c46542329b5f77763685529a46267", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/301f44023e0c46542329b5f77763685529a46267", "html_url": "https://github.com/Rust-GCC/gccrs/commit/301f44023e0c46542329b5f77763685529a46267", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/301f44023e0c46542329b5f77763685529a46267/comments", "author": {"login": "yselkowitz", "id": 13408495, "node_id": "MDQ6VXNlcjEzNDA4NDk1", "avatar_url": "https://avatars.githubusercontent.com/u/13408495?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yselkowitz", "html_url": "https://github.com/yselkowitz", "followers_url": "https://api.github.com/users/yselkowitz/followers", "following_url": "https://api.github.com/users/yselkowitz/following{/other_user}", "gists_url": "https://api.github.com/users/yselkowitz/gists{/gist_id}", "starred_url": "https://api.github.com/users/yselkowitz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yselkowitz/subscriptions", "organizations_url": "https://api.github.com/users/yselkowitz/orgs", "repos_url": "https://api.github.com/users/yselkowitz/repos", "events_url": "https://api.github.com/users/yselkowitz/events{/privacy}", "received_events_url": "https://api.github.com/users/yselkowitz/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8020a4d5c58aed7abfe15c681e62f133f87e788e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8020a4d5c58aed7abfe15c681e62f133f87e788e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8020a4d5c58aed7abfe15c681e62f133f87e788e"}], "stats": {"total": 46, "additions": 42, "deletions": 4}, "files": [{"sha": "b71c1c7144f0b04b13400f6aa9de9f81b0541752", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/301f44023e0c46542329b5f77763685529a46267/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/301f44023e0c46542329b5f77763685529a46267/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=301f44023e0c46542329b5f77763685529a46267", "patch": "@@ -1,3 +1,13 @@\n+2014-08-19  Yaakov Selkowitz  <yselkowi@redhat.com>\n+\n+\t* config.gcc (*-*-cygwin*): Use __cxa_atexit by default.\n+\t(extra_options): Add i386/cygwin.opt.\n+\t* config/i386/cygwin.h (STARTFILE_SPEC): Use crtbeginS.o if shared.\n+\t(CPP_SPEC): Accept -pthread.\n+\t(LINK_SPEC): Ditto.\n+\t(GOMP_SELF_SPECS): Update comment.\n+\t* config/i386/cygwin.opt: New file for -pthread flag.\n+\n 2014-08-19  David Malcolm  <dmalcolm@redhat.com>\n \n \t* df-core.c (DF_REF_INSN): New, using a checked cast for now."}, {"sha": "6862c12724ab2fc03425c9d1bd747550efd14177", "filename": "gcc/config.gcc", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/301f44023e0c46542329b5f77763685529a46267/gcc%2Fconfig.gcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/301f44023e0c46542329b5f77763685529a46267/gcc%2Fconfig.gcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.gcc?ref=301f44023e0c46542329b5f77763685529a46267", "patch": "@@ -1568,13 +1568,14 @@ i[34567]86-*-cygwin*)\n \txm_file=i386/xm-cygwin.h\n \ttmake_file=\"${tmake_file} i386/t-cygming t-slibgcc\"\n \ttarget_gtfiles=\"\\$(srcdir)/config/i386/winnt.c\"\n-\textra_options=\"${extra_options} i386/cygming.opt\"\n+\textra_options=\"${extra_options} i386/cygming.opt i386/cygwin.opt\"\n \textra_objs=\"winnt.o winnt-stubs.o\"\n \tc_target_objs=\"${c_target_objs} msformat-c.o\"\n \tcxx_target_objs=\"${cxx_target_objs} winnt-cxx.o msformat-c.o\"\n \tif test x$enable_threads = xyes; then\n \t\tthread_file='posix'\n \tfi\n+\tdefault_use_cxa_atexit=yes\n \tuse_gcc_stdint=wrap\n \t;;\n x86_64-*-cygwin*)\n@@ -1583,13 +1584,14 @@ x86_64-*-cygwin*)\n \txm_file=i386/xm-cygwin.h\n \ttmake_file=\"${tmake_file} i386/t-cygming t-slibgcc i386/t-cygwin-w64\"\n \ttarget_gtfiles=\"\\$(srcdir)/config/i386/winnt.c\"\n-\textra_options=\"${extra_options} i386/cygming.opt\"\n+\textra_options=\"${extra_options} i386/cygming.opt i386/cygwin.opt\"\n \textra_objs=\"winnt.o winnt-stubs.o\"\n \tc_target_objs=\"${c_target_objs} msformat-c.o\"\n \tcxx_target_objs=\"${cxx_target_objs} winnt-cxx.o msformat-c.o\"\n \tif test x$enable_threads = xyes; then\n \t\tthread_file='posix'\n \tfi\n+\tdefault_use_cxa_atexit=yes\n \tuse_gcc_stdint=wrap\n \ttm_defines=\"${tm_defines} TARGET_CYGWIN64=1\"\n \t;;"}, {"sha": "14891d85931f0f00826a3c5d9f31c4b997156203", "filename": "gcc/config/i386/cygwin.h", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/301f44023e0c46542329b5f77763685529a46267/gcc%2Fconfig%2Fi386%2Fcygwin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/301f44023e0c46542329b5f77763685529a46267/gcc%2Fconfig%2Fi386%2Fcygwin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fcygwin.h?ref=301f44023e0c46542329b5f77763685529a46267", "patch": "@@ -32,6 +32,7 @@ along with GCC; see the file COPYING3.  If not see\n #undef CPP_SPEC\n #define CPP_SPEC \"%(cpp_cpu) %{posix:-D_POSIX_SOURCE} \\\n   %{!ansi:-Dunix} \\\n+  %{pthread:-D_REENTRANT} \\\n   %{mwin32:-DWIN32 -D_WIN32 -D__WIN32 -D__WIN32__ %{!ansi:-DWINNT}} \\\n   %{!nostdinc:%{!mno-win32:-idirafter ../include/w32api%s -idirafter ../../include/w32api%s}}\\\n \"\n@@ -40,7 +41,7 @@ along with GCC; see the file COPYING3.  If not see\n #define STARTFILE_SPEC \"\\\n   %{!shared: %{!mdll: crt0%O%s \\\n   %{pg:gcrt0%O%s}}}\\\n-  crtbegin.o%s\"\n+  %{shared:crtbeginS.o%s;:crtbegin.o%s}\"\n \n #undef ENDFILE_SPEC\n #define ENDFILE_SPEC \\\n@@ -77,6 +78,7 @@ along with GCC; see the file COPYING3.  If not see\n #undef LIB_SPEC\n #define LIB_SPEC \"\\\n   %{pg:-lgmon} \\\n+  %{pthread: } \\\n   -lcygwin \\\n   %{mwindows:-lgdi32 -lcomdlg32} \\\n   -ladvapi32 -lshell32 -luser32 -lkernel32\"\n@@ -129,7 +131,7 @@ along with GCC; see the file COPYING3.  If not see\n \n /* Every program on cygwin links against cygwin1.dll which contains \n    the pthread routines.  There is no need to explicitly link them\n-   and the -pthread flag is not recognized.  */\n+   and the -pthread flag is accepted only for compatibility.  */\n #undef GOMP_SELF_SPECS\n #define GOMP_SELF_SPECS \"\"\n #undef GTM_SELF_SPECS"}, {"sha": "4a67b8ff3857365913e45be404348fd1c57463ea", "filename": "gcc/config/i386/cygwin.opt", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/301f44023e0c46542329b5f77763685529a46267/gcc%2Fconfig%2Fi386%2Fcygwin.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/301f44023e0c46542329b5f77763685529a46267/gcc%2Fconfig%2Fi386%2Fcygwin.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fcygwin.opt?ref=301f44023e0c46542329b5f77763685529a46267", "patch": "@@ -0,0 +1,24 @@\n+; Cygwin-specific options.\n+\n+; Copyright (C) 2013-2014 Free Software Foundation, Inc.\n+;\n+; This file is part of GCC.\n+;\n+; GCC is free software; you can redistribute it and/or modify it under\n+; the terms of the GNU General Public License as published by the Free\n+; Software Foundation; either version 3, or (at your option) any later\n+; version.\n+;\n+; GCC is distributed in the hope that it will be useful, but WITHOUT ANY\n+; WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+; FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+; for more details.\n+;\n+; You should have received a copy of the GNU General Public License\n+; along with GCC; see the file COPYING3.  If not see\n+; <http://www.gnu.org/licenses/>.\n+\n+pthread\n+Driver\n+\n+; Retain blank line above"}]}