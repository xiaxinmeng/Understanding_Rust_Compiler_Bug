{"sha": "725d6b877d6861a3075175c6620b6339f15eac6e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzI1ZDZiODc3ZDY4NjFhMzA3NTE3NWM2NjIwYjYzMzlmMTVlYWM2ZQ==", "commit": {"author": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2007-03-23T04:31:21Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2007-03-23T04:31:21Z"}, "message": "Mark Mitchell <mark@codesourcery.com> PR c++/31273\n\n\t    Mark Mitchell  <mark@codesourcery.com>\n\tPR c++/31273\n\t* call.c (standard_conversion): Use type_decays_to.  Keep FCODE\n\tconsistent with FROM.\n\tPR c++/31273\n\t* g++.dg/expr/bitfield7.C: New test.\n\nFrom-SVN: r123150", "tree": {"sha": "126f77adf19cf73399532dac19eca70e36c3b2a8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/126f77adf19cf73399532dac19eca70e36c3b2a8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/725d6b877d6861a3075175c6620b6339f15eac6e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/725d6b877d6861a3075175c6620b6339f15eac6e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/725d6b877d6861a3075175c6620b6339f15eac6e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/725d6b877d6861a3075175c6620b6339f15eac6e/comments", "author": null, "committer": null, "parents": [{"sha": "5a023baa1f8496c1c9c15f14d63e981331d8ea3a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5a023baa1f8496c1c9c15f14d63e981331d8ea3a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5a023baa1f8496c1c9c15f14d63e981331d8ea3a"}], "stats": {"total": 35, "additions": 26, "deletions": 9}, "files": [{"sha": "3de84b69166d74e075f6573a02ea8c4ed72ed2a1", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/725d6b877d6861a3075175c6620b6339f15eac6e/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/725d6b877d6861a3075175c6620b6339f15eac6e/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=725d6b877d6861a3075175c6620b6339f15eac6e", "patch": "@@ -1,3 +1,10 @@\n+2007-03-22  Jim Wilson  <wilson@specifix.com>\n+\t    Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/31273\n+\t* call.c (standard_conversion): Use type_decays_to.  Keep FCODE\n+\tconsistent with FROM.\n+\n 2007-03-22  Gabriel Dos Reis  <gdr@integrable-solutions.net>\n \n \t* error.c (dump_expr): Handle dependent names that designate types."}, {"sha": "320e51c09ffadd55d7436ce45a473fd354b8fd9b", "filename": "gcc/cp/call.c", "status": "modified", "additions": 6, "deletions": 9, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/725d6b877d6861a3075175c6620b6339f15eac6e/gcc%2Fcp%2Fcall.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/725d6b877d6861a3075175c6620b6339f15eac6e/gcc%2Fcp%2Fcall.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcall.c?ref=725d6b877d6861a3075175c6620b6339f15eac6e", "patch": "@@ -636,15 +636,9 @@ standard_conversion (tree to, tree from, tree expr, bool c_cast_p,\n   tcode = TREE_CODE (to);\n \n   conv = build_identity_conv (from, expr);\n-  if (fcode == FUNCTION_TYPE)\n+  if (fcode == FUNCTION_TYPE || fcode == ARRAY_TYPE)\n     {\n-      from = build_pointer_type (from);\n-      fcode = TREE_CODE (from);\n-      conv = build_conv (ck_lvalue, from, conv);\n-    }\n-  else if (fcode == ARRAY_TYPE)\n-    {\n-      from = build_pointer_type (TREE_TYPE (from));\n+      from = type_decays_to (from);\n       fcode = TREE_CODE (from);\n       conv = build_conv (ck_lvalue, from, conv);\n     }\n@@ -655,7 +649,10 @@ standard_conversion (tree to, tree from, tree expr, bool c_cast_p,\n \t  tree bitfield_type;\n \t  bitfield_type = is_bitfield_expr_with_lowered_type (expr);\n \t  if (bitfield_type)\n-\t    from = strip_top_quals (bitfield_type);\n+\t    {\n+\t      from = strip_top_quals (bitfield_type);\n+\t      fcode = TREE_CODE (from);\n+\t    }\n \t}\n       conv = build_conv (ck_rvalue, from, conv);\n     }"}, {"sha": "a22b4c88e9eb7f1e5bb76a2188a323872201cd2f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/725d6b877d6861a3075175c6620b6339f15eac6e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/725d6b877d6861a3075175c6620b6339f15eac6e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=725d6b877d6861a3075175c6620b6339f15eac6e", "patch": "@@ -1,3 +1,8 @@\n+2007-03-22  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/31273\n+\t* g++.dg/expr/bitfield7.C: New test.\n+\n 2007-03-22  Manuel Lopez-Ibanez  <manu@gcc.gnu.org>\n \n \tPR other/23572"}, {"sha": "d274e3e98b9e96d68f35ea4c393f2155a419d15d", "filename": "gcc/testsuite/g++.dg/expr/bitfield7.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/725d6b877d6861a3075175c6620b6339f15eac6e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fexpr%2Fbitfield7.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/725d6b877d6861a3075175c6620b6339f15eac6e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fexpr%2Fbitfield7.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fexpr%2Fbitfield7.C?ref=725d6b877d6861a3075175c6620b6339f15eac6e", "patch": "@@ -0,0 +1,8 @@\n+// PR c++/31273\n+\n+enum E { e };\n+struct S {\n+  E v:5;\n+};\n+S s;\n+int main() { if (!s.v) return 0; }"}]}