{"sha": "bbffcb7eab761f5223678e7153be5d51560c33eb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmJmZmNiN2VhYjc2MWY1MjIzNjc4ZTcxNTNiZTVkNTE1NjBjMzNlYg==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2009-09-24T21:53:36Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2009-09-24T21:53:36Z"}, "message": "re PR fortran/41459 (Error not printed with -Werror and -fmax-errors=1)\n\n2009-09-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/41459\n\t* gfortran.dg/empty_label.f: New test.\n\t* gfortran.dg/empty_label.f90: Ditto.\n\t* gfortran.dg/warnings_are_errors_1.f: Fix to emit a single warning.\n\n2009-09-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/41459\n\t* error.c(gfc_warning_now): Move warnings_are_errors test to \n\tafter actual emitting of the warning.\n\t* parse.c (next_free): Improve error locus printing.\n\t(next_fixed): Change gfc_warn to gfc_warning_now, and improve\n\tlocus reporting.\n\nFrom-SVN: r152147", "tree": {"sha": "a18fbbc34372ef34d15127a85a1e198e639d0e5a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a18fbbc34372ef34d15127a85a1e198e639d0e5a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bbffcb7eab761f5223678e7153be5d51560c33eb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bbffcb7eab761f5223678e7153be5d51560c33eb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bbffcb7eab761f5223678e7153be5d51560c33eb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bbffcb7eab761f5223678e7153be5d51560c33eb/comments", "author": null, "committer": null, "parents": [{"sha": "e3d5405d071e33540d70c62c6e24a2dfa7cc7d9d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e3d5405d071e33540d70c62c6e24a2dfa7cc7d9d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e3d5405d071e33540d70c62c6e24a2dfa7cc7d9d"}], "stats": {"total": 40, "additions": 35, "deletions": 5}, "files": [{"sha": "650adca5c4e20b0f108d0edbfa87fe62904f7904", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbffcb7eab761f5223678e7153be5d51560c33eb/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbffcb7eab761f5223678e7153be5d51560c33eb/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=bbffcb7eab761f5223678e7153be5d51560c33eb", "patch": "@@ -1,3 +1,13 @@\n+2009-09-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/41459\n+\t* error.c(gfc_warning_now): Move warnings_are_errors test to \n+\tafter actual emitting of the warning.\n+\t* parse.c (next_free): Improve error locus printing.\n+\t(next_fixed): Change gfc_warn to gfc_warning_now, and improve\n+\tlocus reporting.\n+ \n+\n 2009-09-16  Michael Matz  <matz@suse.de>\n \n \tPR fortran/41212"}, {"sha": "88c2883946f1f970fcec1a06d2710f5f3a0463a1", "filename": "gcc/fortran/error.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbffcb7eab761f5223678e7153be5d51560c33eb/gcc%2Ffortran%2Ferror.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbffcb7eab761f5223678e7153be5d51560c33eb/gcc%2Ffortran%2Ferror.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ferror.c?ref=bbffcb7eab761f5223678e7153be5d51560c33eb", "patch": "@@ -821,14 +821,16 @@ gfc_warning_now (const char *nocmsgid, ...)\n   i = buffer_flag;\n   buffer_flag = 0;\n   warnings++;\n-  if (warnings_are_errors)\n-    gfc_increment_error_count();\n \n   va_start (argp, nocmsgid);\n   error_print (_(\"Warning:\"), _(nocmsgid), argp);\n   va_end (argp);\n \n   error_char ('\\0');\n+\n+  if (warnings_are_errors)\n+    gfc_increment_error_count();\n+\n   buffer_flag = i;\n }\n "}, {"sha": "93a6cfdc7f6f737765769045a2f9cad3bddf1703", "filename": "gcc/fortran/parse.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbffcb7eab761f5223678e7153be5d51560c33eb/gcc%2Ffortran%2Fparse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbffcb7eab761f5223678e7153be5d51560c33eb/gcc%2Ffortran%2Fparse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fparse.c?ref=bbffcb7eab761f5223678e7153be5d51560c33eb", "patch": "@@ -655,7 +655,7 @@ next_free (void)\n \t  if (gfc_match_eos () == MATCH_YES)\n \t    {\n \t      gfc_warning_now (\"Ignoring statement label in empty statement \"\n-\t\t\t       \"at %C\");\n+\t\t\t       \"at %L\", &label_locus);\n \t      gfc_free_st_label (gfc_statement_label);\n \t      gfc_statement_label = NULL;\n \t      return ST_NONE;\n@@ -848,7 +848,8 @@ next_fixed (void)\n \n blank_line:\n   if (digit_flag)\n-    gfc_warning (\"Ignoring statement label in empty statement at %C\");\n+    gfc_warning_now (\"Ignoring statement label in empty statement at %L\",\n+\t\t     &label_locus);\n     \n   gfc_current_locus.lb->truncated = 0;\n   gfc_advance_line ();"}, {"sha": "c307a0f668241a20512cc257dae9f356e3e60784", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbffcb7eab761f5223678e7153be5d51560c33eb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbffcb7eab761f5223678e7153be5d51560c33eb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bbffcb7eab761f5223678e7153be5d51560c33eb", "patch": "@@ -1,3 +1,10 @@\n+2009-09-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/41459\n+\t* gfortran.dg/empty_label.f: New test.\n+\t* gfortran.dg/empty_label.f90: Ditto.\n+\t* gfortran.dg/warnings_are_errors_1.f: Fix to emit a single warning. \n+\n 2009-09-24  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* gcc.dg/torture/builtin-math-7.c: Test complex int division at"}, {"sha": "446fe8b131f9cf48557051300747d7ea42f40a6c", "filename": "gcc/testsuite/gfortran.dg/empty_label.f", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbffcb7eab761f5223678e7153be5d51560c33eb/gcc%2Ftestsuite%2Fgfortran.dg%2Fempty_label.f", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbffcb7eab761f5223678e7153be5d51560c33eb/gcc%2Ftestsuite%2Fgfortran.dg%2Fempty_label.f", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fempty_label.f?ref=bbffcb7eab761f5223678e7153be5d51560c33eb", "patch": "@@ -0,0 +1,5 @@\n+C { dg-do compile }\n+C { dg-options \"-Werror -fmax-errors=1\" }\n+100   ! { dg-warning \"empty statement\" }\n+      end\n+C { dg-error \"count reached limit\" \"\" { target *-*-* } 0 }"}, {"sha": "6300d3079d3aad542166c6cbf1a955c535176172", "filename": "gcc/testsuite/gfortran.dg/empty_label.f90", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbffcb7eab761f5223678e7153be5d51560c33eb/gcc%2Ftestsuite%2Fgfortran.dg%2Fempty_label.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbffcb7eab761f5223678e7153be5d51560c33eb/gcc%2Ftestsuite%2Fgfortran.dg%2Fempty_label.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fempty_label.f90?ref=bbffcb7eab761f5223678e7153be5d51560c33eb", "patch": "@@ -0,0 +1,5 @@\n+! { dg-do compile }\n+! { dg-options \"-Werror -fmax-errors=1\" }\n+100   ! { dg-warning \"empty statement\" }\n+end\n+! { dg-error \"count reached limit\" \"\" { target *-*-* } 0 }"}, {"sha": "3d163bbbdfc47bb09040b8ae41d0660d44a15148", "filename": "gcc/testsuite/gfortran.dg/warnings_are_errors_1.f", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbffcb7eab761f5223678e7153be5d51560c33eb/gcc%2Ftestsuite%2Fgfortran.dg%2Fwarnings_are_errors_1.f", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbffcb7eab761f5223678e7153be5d51560c33eb/gcc%2Ftestsuite%2Fgfortran.dg%2Fwarnings_are_errors_1.f", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fwarnings_are_errors_1.f?ref=bbffcb7eab761f5223678e7153be5d51560c33eb", "patch": "@@ -8,7 +8,7 @@ program warnings_are_errors_1\n        integer(kind=1) :: i\n        real :: r1, r2(3)\n ! gfc_warning_now:\n-0      ! { dg-warning \"Zero is not a valid statement label\" }\n+0      r1 = 0 ! { dg-warning \"Zero is not a valid statement label\" }\n !\n 34 5   i=0 \n ! gfc_notify_std(GFC_STD_F95_DEL):"}]}