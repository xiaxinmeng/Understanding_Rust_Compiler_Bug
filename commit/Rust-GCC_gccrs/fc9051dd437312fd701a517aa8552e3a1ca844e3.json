{"sha": "fc9051dd437312fd701a517aa8552e3a1ca844e3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmM5MDUxZGQ0MzczMTJmZDcwMWE1MTdhYTg1NTJlM2ExY2E4NDRlMw==", "commit": {"author": {"name": "H.J. Lu", "email": "hongjiu.lu@intel.com", "date": "2004-09-14T21:16:29Z"}, "committer": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2004-09-14T21:16:29Z"}, "message": "re PR libffi/17465 (Testsuite in libffi overrides LD_LIBRARY_PATH)\n\n2004-09-14  H.J. Lu  <hongjiu.lu@intel.com>\n\n\tPR libgcj/17465\n\t* testsuite/lib/libffi-dg.exp: Don't use global ld_library_path.\n\tSet up LD_LIBRARY_PATH, SHLIB_PATH, LD_LIBRARYN32_PATH,\n\tLD_LIBRARY64_PATH, LD_LIBRARY_PATH_32, LD_LIBRARY_PATH_64 and\n\tDYLD_LIBRARY_PATH.\n\nFrom-SVN: r87511", "tree": {"sha": "dbc2ae44ecf32b3b1473e05c3879abfa76e57f85", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/dbc2ae44ecf32b3b1473e05c3879abfa76e57f85"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fc9051dd437312fd701a517aa8552e3a1ca844e3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fc9051dd437312fd701a517aa8552e3a1ca844e3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fc9051dd437312fd701a517aa8552e3a1ca844e3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fc9051dd437312fd701a517aa8552e3a1ca844e3/comments", "author": {"login": "hjl-tools", "id": 1072356, "node_id": "MDQ6VXNlcjEwNzIzNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hjl-tools", "html_url": "https://github.com/hjl-tools", "followers_url": "https://api.github.com/users/hjl-tools/followers", "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}", "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}", "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions", "organizations_url": "https://api.github.com/users/hjl-tools/orgs", "repos_url": "https://api.github.com/users/hjl-tools/repos", "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}", "received_events_url": "https://api.github.com/users/hjl-tools/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "807ab1f2aa1491efd26f7474a313641f198ce11c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/807ab1f2aa1491efd26f7474a313641f198ce11c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/807ab1f2aa1491efd26f7474a313641f198ce11c"}], "stats": {"total": 33, "additions": 24, "deletions": 9}, "files": [{"sha": "a172ea187e4ed9a166dd83cf988b5a56b30243f7", "filename": "libffi/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fc9051dd437312fd701a517aa8552e3a1ca844e3/libffi%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fc9051dd437312fd701a517aa8552e3a1ca844e3/libffi%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FChangeLog?ref=fc9051dd437312fd701a517aa8552e3a1ca844e3", "patch": "@@ -1,3 +1,11 @@\n+2004-09-14  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR libgcj/17465\n+\t* testsuite/lib/libffi-dg.exp: Don't use global ld_library_path.\n+\tSet up LD_LIBRARY_PATH, SHLIB_PATH, LD_LIBRARYN32_PATH,\n+\tLD_LIBRARY64_PATH, LD_LIBRARY_PATH_32, LD_LIBRARY_PATH_64 and\n+\tDYLD_LIBRARY_PATH.\n+\n 2004-09-05  Andreas Tobler  <a.tobler@schweiz.ch>\n \n \t* testsuite/libffi.call/many_win32.c: Remove whitespaces."}, {"sha": "abeb47676b829446a5cb0d72aa45c7e3bc5e5cef", "filename": "libffi/testsuite/lib/libffi-dg.exp", "status": "modified", "additions": 16, "deletions": 9, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fc9051dd437312fd701a517aa8552e3a1ca844e3/libffi%2Ftestsuite%2Flib%2Flibffi-dg.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fc9051dd437312fd701a517aa8552e3a1ca844e3/libffi%2Ftestsuite%2Flib%2Flibffi-dg.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Ftestsuite%2Flib%2Flibffi-dg.exp?ref=fc9051dd437312fd701a517aa8552e3a1ca844e3", "patch": "@@ -73,7 +73,7 @@ proc libffi-init { args } {\n     global blddirffi\n     global blddircxx\n     global TOOL_OPTIONS\n-    global ld_library_path\n+    global tool\n     global libffi_include\n     global libffi_link_flags\n     global tool_root_dir\n@@ -133,21 +133,28 @@ proc libffi-init { args } {\n     # The same applies to darwin (DYLD_LIBRARY_PATH), solaris 32 bit\n     # (LD_LIBRARY_PATH_32), solaris 64 bit (LD_LIBRARY_PATH_64), and HP-UX\n     # (SHLIB_PATH).\n-    setenv  LD_LIBRARY_PATH     $ld_library_path\n-    setenv  SHLIB_PATH          $ld_library_path\n-    setenv  LD_LIBRARYN32_PATH  $ld_library_path\n-    setenv  LD_LIBRARY64_PATH   $ld_library_path\n-    setenv  LD_LIBRARY_PATH_32  $ld_library_path\n-    setenv  LD_LIBRARY_PATH_64  $ld_library_path\n-    setenv  DYLD_LIBRARY_PATH   $ld_library_path\n+    if {![is_remote target]} {\n+\tset ld_path \"LD_LIBRARY_PATH SHLIB_PATH LD_LIBRARYN32_PATH LD_LIBRARY64_PATH LD_LIBRARY_PATH_32 LD_LIBRARY_PATH_64 DYLD_LIBRARY_PATH\"\n+\tforeach path $ld_path {\n+\t    if [info exists env($path)] {\n+\t\t# If we've already added these directories once, keep\n+\t\t# the existing path.\n+\t\tif {$ld_library_path != $env($path)\n+\t\t    && [string first $ld_library_path: $env($path)] != 0} {\n+\t\t    setenv $path \"$ld_library_path:$env($path)\"\n+\t\t}\n+\t    } else {\n+\t\tsetenv $path \"$ld_library_path\"\n+\t    }\n+\t}\n+    }\n }\n \n proc libffi_target_compile { source dest type options } {\n     global gluefile wrap_flags;\n     global srcdir\n     global blddirffi\n     global TOOL_OPTIONS\n-    global ld_library_path\n     global libffi_link_flags\n     global libffi_include\n     global target_triplet"}]}