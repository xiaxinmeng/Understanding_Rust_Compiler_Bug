{"sha": "63e523d6f0853765adc332c7a68a8e6b16971d6b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjNlNTIzZDZmMDg1Mzc2NWFkYzMzMmM3YTY4YThlNmIxNjk3MWQ2Yg==", "commit": {"author": {"name": "Kyrylo Tkachov", "email": "kyrylo.tkachov@arm.com", "date": "2016-11-02T09:25:22Z"}, "committer": {"name": "Kyrylo Tkachov", "email": "ktkachov@gcc.gnu.org", "date": "2016-11-02T09:25:22Z"}, "message": "PR tree-optimization/78162: Reject negative offsets in store merging early\n\n\tPR tree-optimization/78162\n\t* gimple-ssa-store-merging.c (execute): Mark stores with bitpos < 0\n\tas invalid.\n\n\t* gcc.c-torture/compile/pr78162.c: New test.\n\nFrom-SVN: r241778", "tree": {"sha": "aedc40b214eadb2e102ee0d7a959c8b882146450", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/aedc40b214eadb2e102ee0d7a959c8b882146450"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/63e523d6f0853765adc332c7a68a8e6b16971d6b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/63e523d6f0853765adc332c7a68a8e6b16971d6b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/63e523d6f0853765adc332c7a68a8e6b16971d6b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/63e523d6f0853765adc332c7a68a8e6b16971d6b/comments", "author": {"login": "ktkachov-arm", "id": 74917949, "node_id": "MDQ6VXNlcjc0OTE3OTQ5", "avatar_url": "https://avatars.githubusercontent.com/u/74917949?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ktkachov-arm", "html_url": "https://github.com/ktkachov-arm", "followers_url": "https://api.github.com/users/ktkachov-arm/followers", "following_url": "https://api.github.com/users/ktkachov-arm/following{/other_user}", "gists_url": "https://api.github.com/users/ktkachov-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/ktkachov-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ktkachov-arm/subscriptions", "organizations_url": "https://api.github.com/users/ktkachov-arm/orgs", "repos_url": "https://api.github.com/users/ktkachov-arm/repos", "events_url": "https://api.github.com/users/ktkachov-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/ktkachov-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "04ddfe064b58a9ce69a332942d51722dfb13db66", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/04ddfe064b58a9ce69a332942d51722dfb13db66", "html_url": "https://github.com/Rust-GCC/gccrs/commit/04ddfe064b58a9ce69a332942d51722dfb13db66"}], "stats": {"total": 23, "additions": 22, "deletions": 1}, "files": [{"sha": "aee2b83f8b3acfd6ea33e2156b4b22521aaf8fd4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63e523d6f0853765adc332c7a68a8e6b16971d6b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63e523d6f0853765adc332c7a68a8e6b16971d6b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=63e523d6f0853765adc332c7a68a8e6b16971d6b", "patch": "@@ -1,3 +1,9 @@\n+2016-11-02  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n+\n+\tPR tree-optimization/78162\n+\t* gimple-ssa-store-merging.c (execute): Mark stores with bitpos < 0\n+\tas invalid.\n+\n 2016-11-02  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n \n \t* config/aarch64/aarch64.c (aarch64_register_saved_on_entry): Add"}, {"sha": "feba907559f766a9cbedb9dcf9c933bc0acc84a5", "filename": "gcc/gimple-ssa-store-merging.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63e523d6f0853765adc332c7a68a8e6b16971d6b/gcc%2Fgimple-ssa-store-merging.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63e523d6f0853765adc332c7a68a8e6b16971d6b/gcc%2Fgimple-ssa-store-merging.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple-ssa-store-merging.c?ref=63e523d6f0853765adc332c7a68a8e6b16971d6b", "patch": "@@ -1361,7 +1361,7 @@ pass_store_merging::execute (function *fun)\n \t\t\t\t       &unsignedp, &reversep, &volatilep);\n \t      /* As a future enhancement we could handle stores with the same\n \t\t base and offset.  */\n-\t      bool invalid = offset || reversep\n+\t      bool invalid = offset || reversep || bitpos < 0\n \t\t\t     || ((bitsize > MAX_BITSIZE_MODE_ANY_INT)\n \t\t\t\t  && (TREE_CODE (rhs) != INTEGER_CST))\n \t\t\t     || !rhs_valid_for_store_merging_p (rhs)"}, {"sha": "d979a56fcf7525530a497c7266d3ccff4f51bb5a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63e523d6f0853765adc332c7a68a8e6b16971d6b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63e523d6f0853765adc332c7a68a8e6b16971d6b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=63e523d6f0853765adc332c7a68a8e6b16971d6b", "patch": "@@ -1,3 +1,8 @@\n+2016-11-02  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n+\n+\tPR tree-optimization/78162\n+\t* gcc.c-torture/compile/pr78162.c: New test.\n+\n 2016-11-02  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/78035"}, {"sha": "743d4e678b5b8c9a7ee6fb45254f86212523d59c", "filename": "gcc/testsuite/gcc.c-torture/compile/pr78162.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63e523d6f0853765adc332c7a68a8e6b16971d6b/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr78162.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63e523d6f0853765adc332c7a68a8e6b16971d6b/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr78162.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr78162.c?ref=63e523d6f0853765adc332c7a68a8e6b16971d6b", "patch": "@@ -0,0 +1,10 @@\n+/* PR tree-optimization/78162.\n+   Handle negative offsets in store merging gracefully.  */\n+\n+int a, b[1][2];\n+\n+void fn1()\n+{\n+  for (a = 0; a < 2; a++)\n+    b[-1][a] = 0;\n+}"}]}