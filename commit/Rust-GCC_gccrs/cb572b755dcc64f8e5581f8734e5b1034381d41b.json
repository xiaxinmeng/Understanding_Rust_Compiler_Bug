{"sha": "cb572b755dcc64f8e5581f8734e5b1034381d41b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2I1NzJiNzU1ZGNjNjRmOGU1NTgxZjg3MzRlNWIxMDM0MzgxZDQxYg==", "commit": {"author": {"name": "Samuel Tardieu", "email": "sam@rfc1149.net", "date": "2008-04-14T12:10:16Z"}, "committer": {"name": "Samuel Tardieu", "email": "sam@gcc.gnu.org", "date": "2008-04-14T12:10:16Z"}, "message": "re PR ada/15915 (Illegal program not detected, RM 13.11(15))\n\n    gcc/ada/\n\tPR ada/15915\n\t* sem_util.ads, sem_util.adb (Denotes_Variable): New function.\n\t* sem_ch12.adb (Instantiate_Object): Use it.\n\t* sem_ch13.adb (Analyze_Attribute_Definition_Clause): Ensure that\n\tstorage pool denotes a variable as per RM 13.11(15).\n\n    gcc/testsuite/\n\tPR ada/15915\n\t* gnat.dg/specs/storage.ads: New.\n\nFrom-SVN: r134261", "tree": {"sha": "d178755975cb10ade9ad878bce1b7c7f83670aac", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d178755975cb10ade9ad878bce1b7c7f83670aac"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cb572b755dcc64f8e5581f8734e5b1034381d41b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb572b755dcc64f8e5581f8734e5b1034381d41b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cb572b755dcc64f8e5581f8734e5b1034381d41b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb572b755dcc64f8e5581f8734e5b1034381d41b/comments", "author": {"login": "samueltardieu", "id": 44656, "node_id": "MDQ6VXNlcjQ0NjU2", "avatar_url": "https://avatars.githubusercontent.com/u/44656?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samueltardieu", "html_url": "https://github.com/samueltardieu", "followers_url": "https://api.github.com/users/samueltardieu/followers", "following_url": "https://api.github.com/users/samueltardieu/following{/other_user}", "gists_url": "https://api.github.com/users/samueltardieu/gists{/gist_id}", "starred_url": "https://api.github.com/users/samueltardieu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samueltardieu/subscriptions", "organizations_url": "https://api.github.com/users/samueltardieu/orgs", "repos_url": "https://api.github.com/users/samueltardieu/repos", "events_url": "https://api.github.com/users/samueltardieu/events{/privacy}", "received_events_url": "https://api.github.com/users/samueltardieu/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "17972da719db3ced8d90b01beed66b597f07f806", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/17972da719db3ced8d90b01beed66b597f07f806", "html_url": "https://github.com/Rust-GCC/gccrs/commit/17972da719db3ced8d90b01beed66b597f07f806"}], "stats": {"total": 42, "additions": 41, "deletions": 1}, "files": [{"sha": "9905b15ac73f8de8094b997f0cf3487f999f1bee", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb572b755dcc64f8e5581f8734e5b1034381d41b/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb572b755dcc64f8e5581f8734e5b1034381d41b/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=cb572b755dcc64f8e5581f8734e5b1034381d41b", "patch": "@@ -1,3 +1,11 @@\n+2008-04-14  Samuel Tardieu  <sam@rfc1149.net>\n+\n+\tPR ada/15915\n+\t* sem_util.ads, sem_util.adb (Denotes_Variable): New function.\n+\t* sem_ch12.adb (Instantiate_Object): Use it.\n+\t* sem_ch13.adb (Analyze_Attribute_Definition_Clause): Ensure that\n+\tstorage pool denotes a variable as per RM 13.11(15).\n+\n 2008-04-14  Samuel Tardieu  <sam@rfc1149.net>\n \n \t* sem_util.ads, sem_util.adb (In_Subprogram): New function."}, {"sha": "e7755c4f53412fcd8e6a7db269fb4245298e462f", "filename": "gcc/ada/sem_ch12.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb572b755dcc64f8e5581f8734e5b1034381d41b/gcc%2Fada%2Fsem_ch12.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb572b755dcc64f8e5581f8734e5b1034381d41b/gcc%2Fada%2Fsem_ch12.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch12.adb?ref=cb572b755dcc64f8e5581f8734e5b1034381d41b", "patch": "@@ -8213,7 +8213,7 @@ package body Sem_Ch12 is\n \n          Resolve (Actual, Ftyp);\n \n-         if not Is_Variable (Actual) or else Paren_Count (Actual) > 0 then\n+         if not Denotes_Variable (Actual) then\n             Error_Msg_NE\n               (\"actual for& must be a variable\", Actual, Formal_Id);\n "}, {"sha": "f72ffff6397a837cde8bb50d434bac8b71d07808", "filename": "gcc/ada/sem_ch13.adb", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb572b755dcc64f8e5581f8734e5b1034381d41b/gcc%2Fada%2Fsem_ch13.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb572b755dcc64f8e5581f8734e5b1034381d41b/gcc%2Fada%2Fsem_ch13.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch13.adb?ref=cb572b755dcc64f8e5581f8734e5b1034381d41b", "patch": "@@ -1481,6 +1481,11 @@ package body Sem_Ch13 is\n             Analyze_And_Resolve\n               (Expr, Class_Wide_Type (RTE (RE_Root_Storage_Pool)));\n \n+            if not Denotes_Variable (Expr) then\n+               Error_Msg_N (\"storage pool must be a variable\", Expr);\n+               return;\n+            end if;\n+\n             if Nkind (Expr) = N_Type_Conversion then\n                T := Etype (Expression (Expr));\n             else"}, {"sha": "e7a6658e88de9231c7fc9fdc095f7f0b9d28825d", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb572b755dcc64f8e5581f8734e5b1034381d41b/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb572b755dcc64f8e5581f8734e5b1034381d41b/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=cb572b755dcc64f8e5581f8734e5b1034381d41b", "patch": "@@ -2143,6 +2143,15 @@ package body Sem_Util is\n \n    end Denotes_Discriminant;\n \n+   ----------------------\n+   -- Denotes_Variable --\n+   ----------------------\n+\n+   function Denotes_Variable (N : Node_Id) return Boolean is\n+   begin\n+      return Is_Variable (N) and then Paren_Count (N) = 0;\n+   end Denotes_Variable;\n+\n    -----------------------------\n    -- Depends_On_Discriminant --\n    -----------------------------"}, {"sha": "291e230f4307dd8be2c2a9c2f14c07dfc90fd164", "filename": "gcc/ada/sem_util.ads", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb572b755dcc64f8e5581f8734e5b1034381d41b/gcc%2Fada%2Fsem_util.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb572b755dcc64f8e5581f8734e5b1034381d41b/gcc%2Fada%2Fsem_util.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.ads?ref=cb572b755dcc64f8e5581f8734e5b1034381d41b", "patch": "@@ -245,6 +245,9 @@ package Sem_Util is\n    --  components of protected types, and constraint checks on entry\n    --  families constrained by discriminants.\n \n+   function Denotes_Variable (N : Node_Id) return Boolean;\n+   --  Returns True if node N denotes a single variable without parentheses.\n+\n    function Depends_On_Discriminant (N : Node_Id) return Boolean;\n    --  Returns True if N denotes a discriminant or if N is a range, a subtype\n    --  indication or a scalar subtype where one of the bounds is a"}, {"sha": "a129d156362a5f86967b4719ccb77a42ce669636", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb572b755dcc64f8e5581f8734e5b1034381d41b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb572b755dcc64f8e5581f8734e5b1034381d41b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=cb572b755dcc64f8e5581f8734e5b1034381d41b", "patch": "@@ -1,3 +1,8 @@\n+2008-04-14  Samuel Tardieu  <sam@rfc1149.net>\n+\n+\tPR ada/15915\n+\t* gnat.dg/specs/storage.ads: New.\n+\n 2008-04-14  Samuel Tardieu  <sam@rfc1149.net>\n \n \t* gnat.dg/deep_old.adb: New."}, {"sha": "85a91d0724e18a2587b810eae81ef8cb58322f3b", "filename": "gcc/testsuite/gnat.dg/specs/storage.ads", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb572b755dcc64f8e5581f8734e5b1034381d41b/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fstorage.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb572b755dcc64f8e5581f8734e5b1034381d41b/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fstorage.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fstorage.ads?ref=cb572b755dcc64f8e5581f8734e5b1034381d41b", "patch": "@@ -0,0 +1,10 @@\n+-- { dg-do compile }\n+with System.Pool_Global;\n+package Storage is\n+   x1: System.Pool_Global.Unbounded_No_Reclaim_Pool;\n+   type T1 is access integer;\n+   for T1'Storage_Pool use (x1);  -- { dg-error \"denote a variable\" }\n+   type T2 is access Integer;\n+   for T2'Storage_Pool use x1;\n+end Storage;\n+"}]}