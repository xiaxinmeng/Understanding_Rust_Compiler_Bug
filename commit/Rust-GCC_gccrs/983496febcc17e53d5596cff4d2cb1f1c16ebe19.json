{"sha": "983496febcc17e53d5596cff4d2cb1f1c16ebe19", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTgzNDk2ZmViY2MxN2U1M2Q1NTk2Y2ZmNGQyY2IxZjFjMTZlYmUxOQ==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2016-10-14T20:22:23Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@gcc.gnu.org", "date": "2016-10-14T20:22:23Z"}, "message": "Tweaks to print_rtx_function\n\ngcc/ChangeLog:\n\t* print-rtl-function.c (print_edge): Omit \"(flags)\" when none are\n\tset.\n\t(print_rtx_function): Update example in comment for...\n\t* print-rtl.c (print_rtx_operand_code_r): In compact mode, print\n\tnon-virtual pseudos with a '%' sigil followed by the regno, offset\n\tby (LAST_VIRTUAL_REGISTER + 1), so that the first non-virtual\n\tpseudo is dumped as \"%0\".\n\nFrom-SVN: r241185", "tree": {"sha": "f477f08f40f1c4296660873d28335ce92f40ee1d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f477f08f40f1c4296660873d28335ce92f40ee1d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/983496febcc17e53d5596cff4d2cb1f1c16ebe19", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/983496febcc17e53d5596cff4d2cb1f1c16ebe19", "html_url": "https://github.com/Rust-GCC/gccrs/commit/983496febcc17e53d5596cff4d2cb1f1c16ebe19", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/983496febcc17e53d5596cff4d2cb1f1c16ebe19/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "38e34671fa2bb8a686cd2e2c770937b8c9be8f1e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/38e34671fa2bb8a686cd2e2c770937b8c9be8f1e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/38e34671fa2bb8a686cd2e2c770937b8c9be8f1e"}], "stats": {"total": 47, "additions": 36, "deletions": 11}, "files": [{"sha": "2cf3f940d8824e761f88c0169b36105971aaf871", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/983496febcc17e53d5596cff4d2cb1f1c16ebe19/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/983496febcc17e53d5596cff4d2cb1f1c16ebe19/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=983496febcc17e53d5596cff4d2cb1f1c16ebe19", "patch": "@@ -1,3 +1,13 @@\n+2016-10-14  David Malcolm  <dmalcolm@redhat.com>\n+\n+\t* print-rtl-function.c (print_edge): Omit \"(flags)\" when none are\n+\tset.\n+\t(print_rtx_function): Update example in comment for...\n+\t* print-rtl.c (print_rtx_operand_code_r): In compact mode, print\n+\tnon-virtual pseudos with a '%' sigil followed by the regno, offset\n+\tby (LAST_VIRTUAL_REGISTER + 1), so that the first non-virtual\n+\tpseudo is dumped as \"%0\".\n+\n 2016-10-14  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR middle-end/77959"}, {"sha": "f46304bf944ad07982c3651e54f643f6c28b6db4", "filename": "gcc/print-rtl-function.c", "status": "modified", "additions": 18, "deletions": 11, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/983496febcc17e53d5596cff4d2cb1f1c16ebe19/gcc%2Fprint-rtl-function.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/983496febcc17e53d5596cff4d2cb1f1c16ebe19/gcc%2Fprint-rtl-function.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fprint-rtl-function.c?ref=983496febcc17e53d5596cff4d2cb1f1c16ebe19", "patch": "@@ -60,9 +60,11 @@ print_edge (FILE *outfile, edge e, bool from)\n \n   /* Express edge flags as a string with \" | \" separator.\n      e.g. (flags \"FALLTHRU | DFS_BACK\").  */\n-  fprintf (outfile, \" (flags \\\"\");\n-  bool seen_flag = false;\n-#define DEF_EDGE_FLAG(NAME,IDX) \\\n+  if (e->flags)\n+    {\n+      fprintf (outfile, \" (flags \\\"\");\n+      bool seen_flag = false;\n+#define DEF_EDGE_FLAG(NAME,IDX)\t\t\t\\\n   do {\t\t\t\t\t\t\\\n     if (e->flags & EDGE_##NAME)\t\t\t\\\n       {\t\t\t\t\t\t\\\n@@ -75,7 +77,10 @@ print_edge (FILE *outfile, edge e, bool from)\n #include \"cfg-flags.def\"\n #undef DEF_EDGE_FLAG\n \n-  fprintf (outfile, \"\\\"))\\n\");\n+      fprintf (outfile, \"\\\")\");\n+    }\n+\n+  fprintf (outfile, \")\\n\");\n }\n \n /* If BB is non-NULL, print the start of a \"(block)\" directive for it\n@@ -132,7 +137,9 @@ can_have_basic_block_p (const rtx_insn *insn)\n    If COMPACT, then instructions are printed in a compact form:\n    - INSN_UIDs are omitted, except for jumps and CODE_LABELs,\n    - INSN_CODEs are omitted,\n-   - register numbers are omitted for hard and virtual regs\n+   - register numbers are omitted for hard and virtual regs, and\n+     non-virtual pseudos are offset relative to the first such reg, and\n+     printed with a '%' sigil e.g. \"%0\" for (LAST_VIRTUAL_REGISTER + 1),\n    - insn names are prefixed with \"c\" (e.g. \"cinsn\", \"cnote\", etc)\n \n    Example output (with COMPACT==true):\n@@ -148,25 +155,25 @@ can_have_basic_block_p (const rtx_insn *insn)\n \t\t       (reg:SI di [ i ])) \"t.c\":2\n \t\t   (nil))\n \t (cnote NOTE_INSN_FUNCTION_BEG)\n-\t (cinsn (set (reg:SI 89)\n+\t (cinsn (set (reg:SI %2)\n \t\t       (mem/c:SI (plus:DI (reg/f:DI virtual-stack-vars)\n \t\t\t       (const_int -4)) [1 i+0 S4 A32])) \"t.c\":3\n \t\t   (nil))\n \t (cinsn (parallel [\n-\t\t\t   (set (reg:SI 87 [ _2 ])\n-\t\t\t       (ashift:SI (reg:SI 89)\n+\t\t\t   (set (reg:SI %0 [ _2 ])\n+\t\t\t       (ashift:SI (reg:SI %2)\n \t\t\t\t   (const_int 1)))\n \t\t\t   (clobber (reg:CC flags))\n \t\t       ]) \"t.c\":3\n \t\t   (expr_list:REG_EQUAL (ashift:SI (mem/c:SI (plus:DI (reg/f:DI virtual-stack-vars)\n \t\t\t\t   (const_int -4)) [1 i+0 S4 A32])\n \t\t\t   (const_int 1))\n \t\t       (nil)))\n-\t (cinsn (set (reg:SI 88 [ <retval> ])\n-\t\t       (reg:SI 87 [ _2 ])) \"t.c\":3\n+\t (cinsn (set (reg:SI %1 [ <retval> ])\n+\t\t       (reg:SI %0 [ _2 ])) \"t.c\":3\n \t\t   (nil))\n \t (cinsn (set (reg/i:SI ax)\n-\t\t       (reg:SI 88 [ <retval> ])) \"t.c\":4\n+\t\t       (reg:SI %1 [ <retval> ])) \"t.c\":4\n \t\t   (nil))\n \t (cinsn (use (reg/i:SI ax)) \"t.c\":4\n \t\t   (nil))"}, {"sha": "46f3c4dc070381f7d776496ec8fff78dfc9cb8f9", "filename": "gcc/print-rtl.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/983496febcc17e53d5596cff4d2cb1f1c16ebe19/gcc%2Fprint-rtl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/983496febcc17e53d5596cff4d2cb1f1c16ebe19/gcc%2Fprint-rtl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fprint-rtl.c?ref=983496febcc17e53d5596cff4d2cb1f1c16ebe19", "patch": "@@ -400,6 +400,14 @@ print_rtx_operand_code_r (const_rtx in_rtx)\n #endif\n     if (flag_dump_unnumbered && is_insn)\n       fputc ('#', outfile);\n+    else if (flag_compact)\n+      {\n+\t/* In compact mode, print pseudos with a '%' sigil following\n+\t   by the regno, offset by (LAST_VIRTUAL_REGISTER + 1), so that the\n+\t   first non-virtual pseudo is dumped as \"%0\".  */\n+\tgcc_assert (regno > LAST_VIRTUAL_REGISTER);\n+\tfprintf (outfile, \" %%%d\", regno - (LAST_VIRTUAL_REGISTER + 1));\n+      }\n     else\n       fprintf (outfile, \" %d\", regno);\n "}]}