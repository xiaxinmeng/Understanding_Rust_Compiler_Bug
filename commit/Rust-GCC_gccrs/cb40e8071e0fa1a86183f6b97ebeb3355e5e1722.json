{"sha": "cb40e8071e0fa1a86183f6b97ebeb3355e5e1722", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2I0MGU4MDcxZTBmYTFhODYxODNmNmI5N2ViZWIzMzU1ZTVlMTcyMg==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2018-11-18T17:40:23Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2018-11-18T17:40:23Z"}, "message": "re PR fortran/88073 (Internal compiler error  compiling WHERE construct with -O or -O2)\n\n2018-11-18  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/88073\n\t* frontend-passes.c (combine_array_constructor): Do not do\n\tanything if in a WHERE statement.\n\n2018-11-18  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/88073\n\t* gfortran.dg/where_7.f90: New test.\n\nFrom-SVN: r266251", "tree": {"sha": "7cfa4a20ea36125deebad2639846e827a9bebc71", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7cfa4a20ea36125deebad2639846e827a9bebc71"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cb40e8071e0fa1a86183f6b97ebeb3355e5e1722", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb40e8071e0fa1a86183f6b97ebeb3355e5e1722", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cb40e8071e0fa1a86183f6b97ebeb3355e5e1722", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb40e8071e0fa1a86183f6b97ebeb3355e5e1722/comments", "author": null, "committer": null, "parents": [{"sha": "9515381d1cf44d4c897ac0aeee89d555d82fdd7f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9515381d1cf44d4c897ac0aeee89d555d82fdd7f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9515381d1cf44d4c897ac0aeee89d555d82fdd7f"}], "stats": {"total": 40, "additions": 40, "deletions": 0}, "files": [{"sha": "15f594265b0a7bde92f6b9a684655b671496be10", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb40e8071e0fa1a86183f6b97ebeb3355e5e1722/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb40e8071e0fa1a86183f6b97ebeb3355e5e1722/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=cb40e8071e0fa1a86183f6b97ebeb3355e5e1722", "patch": "@@ -1,3 +1,9 @@\n+2018-11-18  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/88073\n+\t* frontend-passes.c (combine_array_constructor): Do not do\n+\tanything if in a WHERE statement.\n+\n 2018-11-18  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/70260"}, {"sha": "9fa50ee68fa2e12079d373cc1360029623b2ef2d", "filename": "gcc/fortran/frontend-passes.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb40e8071e0fa1a86183f6b97ebeb3355e5e1722/gcc%2Ffortran%2Ffrontend-passes.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb40e8071e0fa1a86183f6b97ebeb3355e5e1722/gcc%2Ffortran%2Ffrontend-passes.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ffrontend-passes.c?ref=cb40e8071e0fa1a86183f6b97ebeb3355e5e1722", "patch": "@@ -1773,6 +1773,10 @@ combine_array_constructor (gfc_expr *e)\n   if (iterator_level > 0)\n     return false;\n \n+  /* WHERE also doesn't work.  */\n+  if (in_where > 0)\n+    return false;\n+\n   op1 = e->value.op.op1;\n   op2 = e->value.op.op2;\n "}, {"sha": "ffd271a8c3f31a35d007a0ee83b89ce9661a258b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb40e8071e0fa1a86183f6b97ebeb3355e5e1722/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb40e8071e0fa1a86183f6b97ebeb3355e5e1722/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=cb40e8071e0fa1a86183f6b97ebeb3355e5e1722", "patch": "@@ -1,3 +1,8 @@\n+2018-11-18  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/88073\n+\t* gfortran.dg/where_7.f90: New test.\n+\n 2018-11-18  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/70260"}, {"sha": "1c79ef505533fd878c60df1592dc66784972d052", "filename": "gcc/testsuite/gfortran.dg/where_7.f90", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb40e8071e0fa1a86183f6b97ebeb3355e5e1722/gcc%2Ftestsuite%2Fgfortran.dg%2Fwhere_7.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb40e8071e0fa1a86183f6b97ebeb3355e5e1722/gcc%2Ftestsuite%2Fgfortran.dg%2Fwhere_7.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fwhere_7.f90?ref=cb40e8071e0fa1a86183f6b97ebeb3355e5e1722", "patch": "@@ -0,0 +1,25 @@\n+! { dg-do compile }\n+! { dg-options \"-ffrontend-optimize\" }\n+! PR fortran/88073 - this used to ICE with front-end optimization\n+! Original test case by 'mecej4'\n+Subroutine tfu (n, x, f)\n+   Implicit None\n+   Integer, Parameter :: double = Kind (0.d0)\n+   Integer, Intent (In) :: n\n+   Real (double), Intent (Out) :: f\n+   Real (double), Intent (In) :: x (n)\n+   Integer :: j\n+   Logical, Dimension(n) :: l1v, l2v, l3v\n+!\n+   l3v = .False.\n+   l2v = .False.\n+   l1v = (/ (j, j=1, n) /) == 1\n+   Where ( .Not. (l1v))\n+      l2v = (/ (j, j=1, n) /) == n\n+   End Where\n+   Where ( .Not. l1v)\n+      l3v = .Not. l2v\n+   End Where\n+   f = sum (x(1:n), mask=l3v)\n+   Return\n+end subroutine tfu"}]}