{"sha": "5789594736ea2fae7b4d45a5486560fd2f8d9aea", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTc4OTU5NDczNmVhMmZhZTdiNGQ0NWE1NDg2NTYwZmQyZjhkOWFlYQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2013-03-25T11:25:28Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2013-03-25T11:25:28Z"}, "message": "* postreload.c (reload_combine): Fix code detecting returns.\n\nFrom-SVN: r197037", "tree": {"sha": "bc2816e197c9accfc84982ebdc9f561349e2ae2a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bc2816e197c9accfc84982ebdc9f561349e2ae2a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5789594736ea2fae7b4d45a5486560fd2f8d9aea", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5789594736ea2fae7b4d45a5486560fd2f8d9aea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5789594736ea2fae7b4d45a5486560fd2f8d9aea", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5789594736ea2fae7b4d45a5486560fd2f8d9aea/comments", "author": null, "committer": null, "parents": [{"sha": "1e1b18c1c7963e3f5ea48c7f4bca0e25481cf07c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e1b18c1c7963e3f5ea48c7f4bca0e25481cf07c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1e1b18c1c7963e3f5ea48c7f4bca0e25481cf07c"}], "stats": {"total": 20, "additions": 15, "deletions": 5}, "files": [{"sha": "89e0b7a2cdb30437eb43998ad7f8607ebf530d97", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5789594736ea2fae7b4d45a5486560fd2f8d9aea/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5789594736ea2fae7b4d45a5486560fd2f8d9aea/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5789594736ea2fae7b4d45a5486560fd2f8d9aea", "patch": "@@ -1,3 +1,7 @@\n+2013-03-25  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* postreload.c (reload_combine): Fix code detecting returns.\n+\n 2013-03-25  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* function.c (emit_use_return_register_into_block): On cc0 targets,"}, {"sha": "33462e4dbadc94415c6c0fa64337d64a64229aa1", "filename": "gcc/postreload.c", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5789594736ea2fae7b4d45a5486560fd2f8d9aea/gcc%2Fpostreload.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5789594736ea2fae7b4d45a5486560fd2f8d9aea/gcc%2Fpostreload.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fpostreload.c?ref=5789594736ea2fae7b4d45a5486560fd2f8d9aea", "patch": "@@ -1387,21 +1387,27 @@ reload_combine (void)\n \t     }\n \t}\n \n-      if (control_flow_insn && GET_CODE (PATTERN (insn)) != RETURN)\n+      if (control_flow_insn && !ANY_RETURN_P (PATTERN (insn)))\n \t{\n \t  /* Non-spill registers might be used at the call destination in\n \t     some unknown fashion, so we have to mark the unknown use.  */\n \t  HARD_REG_SET *live;\n \n \t  if ((condjump_p (insn) || condjump_in_parallel_p (insn))\n \t      && JUMP_LABEL (insn))\n-\t    live = &LABEL_LIVE (JUMP_LABEL (insn));\n+\t    {\n+\t      if (ANY_RETURN_P (JUMP_LABEL (insn)))\n+\t\tlive = NULL;\n+\t      else\n+\t\tlive = &LABEL_LIVE (JUMP_LABEL (insn));\n+\t    }\n \t  else\n \t    live = &ever_live_at_start;\n \n-\t  for (r = 0; r < FIRST_PSEUDO_REGISTER; r++)\n-\t    if (TEST_HARD_REG_BIT (*live, r))\n-\t      reg_state[r].use_index = -1;\n+\t  if (live)\n+\t    for (r = 0; r < FIRST_PSEUDO_REGISTER; r++)\n+\t      if (TEST_HARD_REG_BIT (*live, r))\n+\t\treg_state[r].use_index = -1;\n \t}\n \n       reload_combine_note_use (&PATTERN (insn), insn, reload_combine_ruid,"}]}