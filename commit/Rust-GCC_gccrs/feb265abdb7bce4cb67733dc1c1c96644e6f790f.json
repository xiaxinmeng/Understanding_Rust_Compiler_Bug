{"sha": "feb265abdb7bce4cb67733dc1c1c96644e6f790f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmViMjY1YWJkYjdiY2U0Y2I2NzczM2RjMWMxYzk2NjQ0ZTZmNzkwZg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2001-11-15T10:41:48Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2001-11-15T10:41:48Z"}, "message": "cfgcleanup.c (try_optimize_cfg): If try_simplify_condjump optimized conditional jump...\n\n\t* cfgcleanup.c (try_optimize_cfg): If try_simplify_condjump optimized\n\tconditional jump, request updating life into for the block\n\tcontaining it.  Fix a typo which prevented life info update.\n\tClear blocks bitmap before using it.\n\n\t* gcc.c-torture/compile/20011114-3.c: New test.\n\nFrom-SVN: r47050", "tree": {"sha": "361d0de7f868ea7e399a885307f7d6c9618fee0f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/361d0de7f868ea7e399a885307f7d6c9618fee0f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/feb265abdb7bce4cb67733dc1c1c96644e6f790f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/feb265abdb7bce4cb67733dc1c1c96644e6f790f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/feb265abdb7bce4cb67733dc1c1c96644e6f790f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/feb265abdb7bce4cb67733dc1c1c96644e6f790f/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8f5a5db8187f51e0cbbf8bbb1b13be97fdf2fe4b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8f5a5db8187f51e0cbbf8bbb1b13be97fdf2fe4b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8f5a5db8187f51e0cbbf8bbb1b13be97fdf2fe4b"}], "stats": {"total": 56, "additions": 54, "deletions": 2}, "files": [{"sha": "167bd63590eae7bf148cd002762c0bf1233bc4f5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/feb265abdb7bce4cb67733dc1c1c96644e6f790f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/feb265abdb7bce4cb67733dc1c1c96644e6f790f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=feb265abdb7bce4cb67733dc1c1c96644e6f790f", "patch": "@@ -12,6 +12,11 @@\n \n \t* config/ia64/ia64.c (ia64_adjust_cost): Handle SUBREGs.\n \n+\t* cfgcleanup.c (try_optimize_cfg): If try_simplify_condjump optimized\n+\tconditional jump, request updating life into for the block\n+\tcontaining it.  Fix a typo which prevented life info update.\n+\tClear blocks bitmap before using it.\n+\n 2001-11-15  Neil Booth  <neil@daikokuya.demon.co.uk>\n \n \t* c-common.c: Include c-lex.h."}, {"sha": "28f3a1fb0c8ee02020653178c7716e0567a19fba", "filename": "gcc/cfgcleanup.c", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/feb265abdb7bce4cb67733dc1c1c96644e6f790f/gcc%2Fcfgcleanup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/feb265abdb7bce4cb67733dc1c1c96644e6f790f/gcc%2Fcfgcleanup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgcleanup.c?ref=feb265abdb7bce4cb67733dc1c1c96644e6f790f", "patch": "@@ -1211,7 +1211,10 @@ try_optimize_cfg (mode)\n \n \t  /* Simplify branch over branch.  */\n \t  if ((mode & CLEANUP_EXPENSIVE) && try_simplify_condjump (b))\n-\t    changed_here = true;\n+\t    {\n+\t      BB_SET_FLAG (b, BB_UPDATE_LIFE);\n+\t      changed_here = true;\n+\t    }\n \n \t  /* If B has a single outgoing edge, but uses a non-trivial jump\n \t     instruction without side-effects, we can either delete the\n@@ -1261,10 +1264,11 @@ try_optimize_cfg (mode)\n   if (mode & CLEANUP_CROSSJUMP)\n     remove_fake_edges ();\n \n-  if ((mode & CLEANUP_UPDATE_LIFE) & changed_overall)\n+  if ((mode & CLEANUP_UPDATE_LIFE) && changed_overall)\n     {\n       bool found = 0;\n       blocks = sbitmap_alloc (n_basic_blocks);\n+      sbitmap_zero (blocks);\n       for (i = 0; i < n_basic_blocks; i++)\n \tif (BB_FLAGS (BASIC_BLOCK (i)) & BB_UPDATE_LIFE)\n \t  {"}, {"sha": "1981a9ef20f104c822ba7046f4b50a78d7516b64", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/feb265abdb7bce4cb67733dc1c1c96644e6f790f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/feb265abdb7bce4cb67733dc1c1c96644e6f790f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=feb265abdb7bce4cb67733dc1c1c96644e6f790f", "patch": "@@ -1,6 +1,7 @@\n 2001-11-15  Jakub Jelinek  <jakub@redhat.com>\n \n \t* gcc.c-torture/compile/20011114-2.c: New test.\n+\t* gcc.c-torture/compile/20011114-3.c: New test.\n \t* gcc.c-torture/compile/20011114-4.c: New test.\n \n 2001-11-15  Nathan Sidwell  <nathan@codesourcery.com>"}, {"sha": "882792525c96cab9c5d468222a86810e31405571", "filename": "gcc/testsuite/gcc.c-torture/compile/20011114-3.c", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/feb265abdb7bce4cb67733dc1c1c96644e6f790f/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2F20011114-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/feb265abdb7bce4cb67733dc1c1c96644e6f790f/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2F20011114-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2F20011114-3.c?ref=feb265abdb7bce4cb67733dc1c1c96644e6f790f", "patch": "@@ -0,0 +1,42 @@\n+typedef struct { int s, t; } C;\n+C x;\n+int foo (void);\n+void bar (int);\n+\n+int baz (void)\n+{\n+  int a = 0, c, d = 0;\n+  C *b = &x;\n+\n+  while ((c = foo ()))\n+    switch(c)\n+      {\n+      case 23:\n+\tbar (1);\n+\tbreak;\n+      default:\n+\tbreak;\n+      }\n+\n+  if (a == 0 || (a & 1))\n+    {\n+      if (b->s)\n+\t{\n+\t  if (a)\n+\t    bar (1);\n+\t  else\n+\t    a = 16;\n+\t}\n+      else if (b->t)\n+\t{\n+\t  if (a)\n+\t    bar (1);\n+\t  else\n+\t    a = 32;\n+\t}\n+    }\n+\n+  if (d && (a & ~127))\n+    bar (2);\n+  return 0;\n+}"}]}