{"sha": "d29c7f605fc6b531eaf351bf5909e7c551fc6b9e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDI5YzdmNjA1ZmM2YjUzMWVhZjM1MWJmNTkwOWU3YzU1MWZjNmI5ZQ==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2020-01-10T14:56:31Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2020-01-10T14:56:31Z"}, "message": "Use get_related_vectype_for_scalar_type for reduction indices\n\nThe related_vector_mode series missed this case in\nvect_create_epilog_for_reduction, where we want to create the\nunsigned integer equivalent of another vector.  Without it we\ncould mix SVE and Advanced SIMD vectors in the same operation.\n\nThis showed up on existing tests when testing with fixed-length\n-msve-vector-bits=128.\n\n2020-01-10  Richard Sandiford  <richard.sandiford@arm.com>\n\ngcc/\n\t* tree-vect-loop.c (vect_create_epilog_for_reduction): Use\n\tget_related_vectype_for_scalar_type rather than build_vector_type\n\tto create the index type for a conditional reduction.\n\nFrom-SVN: r280112", "tree": {"sha": "a7aef92f03f334b036508365f41954f61b6f3d83", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a7aef92f03f334b036508365f41954f61b6f3d83"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d29c7f605fc6b531eaf351bf5909e7c551fc6b9e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d29c7f605fc6b531eaf351bf5909e7c551fc6b9e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d29c7f605fc6b531eaf351bf5909e7c551fc6b9e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d29c7f605fc6b531eaf351bf5909e7c551fc6b9e/comments", "author": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ac190fcea1bebf87a2c8c3963548a0e5272c42ec", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac190fcea1bebf87a2c8c3963548a0e5272c42ec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ac190fcea1bebf87a2c8c3963548a0e5272c42ec"}], "stats": {"total": 11, "additions": 9, "deletions": 2}, "files": [{"sha": "21dd1aa29c8222a1a7344350c5a0bc9077656ccc", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d29c7f605fc6b531eaf351bf5909e7c551fc6b9e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d29c7f605fc6b531eaf351bf5909e7c551fc6b9e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d29c7f605fc6b531eaf351bf5909e7c551fc6b9e", "patch": "@@ -1,3 +1,9 @@\n+2020-01-10  Richard Sandiford  <richard.sandiford@arm.com>\n+\n+\t* tree-vect-loop.c (vect_create_epilog_for_reduction): Use\n+\tget_related_vectype_for_scalar_type rather than build_vector_type\n+\tto create the index type for a conditional reduction.\n+\n 2020-01-10  Richard Sandiford  <richard.sandiford@arm.com>\n \n \t* tree-vect-loop.c (update_epilogue_loop_vinfo): Update DR_REF"}, {"sha": "faf816116de2ca7ca76e9f05370542a7e329c30c", "filename": "gcc/tree-vect-loop.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d29c7f605fc6b531eaf351bf5909e7c551fc6b9e/gcc%2Ftree-vect-loop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d29c7f605fc6b531eaf351bf5909e7c551fc6b9e/gcc%2Ftree-vect-loop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-loop.c?ref=d29c7f605fc6b531eaf351bf5909e7c551fc6b9e", "patch": "@@ -4566,8 +4566,9 @@ vect_create_epilog_for_reduction (stmt_vec_info stmt_info,\n       int scalar_precision\n \t= GET_MODE_PRECISION (SCALAR_TYPE_MODE (TREE_TYPE (vectype)));\n       tree cr_index_scalar_type = make_unsigned_type (scalar_precision);\n-      tree cr_index_vector_type = build_vector_type\n-\t(cr_index_scalar_type, TYPE_VECTOR_SUBPARTS (vectype));\n+      tree cr_index_vector_type = get_related_vectype_for_scalar_type\n+\t(TYPE_MODE (vectype), cr_index_scalar_type,\n+\t TYPE_VECTOR_SUBPARTS (vectype));\n \n       /* First we create a simple vector induction variable which starts\n \t with the values {1,2,3,...} (SERIES_VECT) and increments by the"}]}