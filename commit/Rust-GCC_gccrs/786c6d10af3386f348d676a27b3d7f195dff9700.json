{"sha": "786c6d10af3386f348d676a27b3d7f195dff9700", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Nzg2YzZkMTBhZjMzODZmMzQ4ZDY3NmEyN2IzZDdmMTk1ZGZmOTcwMA==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2017-06-27T11:38:31Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2017-06-27T11:38:31Z"}, "message": "re PR sanitizer/81223 (ICE in instrument_null at gcc/ubsan.c:1230)\n\n\tPR sanitizer/81223\n\t* ubsan.c (instrument_null): Check get_base_address's result for null.\n\n\t* gcc.dg/ubsan/pr81223.c: New test.\n\nFrom-SVN: r249687", "tree": {"sha": "2670fd407e46eafafd3a3af8ae838408bbda43f0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2670fd407e46eafafd3a3af8ae838408bbda43f0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/786c6d10af3386f348d676a27b3d7f195dff9700", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/786c6d10af3386f348d676a27b3d7f195dff9700", "html_url": "https://github.com/Rust-GCC/gccrs/commit/786c6d10af3386f348d676a27b3d7f195dff9700", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/786c6d10af3386f348d676a27b3d7f195dff9700/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1e7df2e63a369ffcc658dd5e1e3d57dabaa017c2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e7df2e63a369ffcc658dd5e1e3d57dabaa017c2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1e7df2e63a369ffcc658dd5e1e3d57dabaa017c2"}], "stats": {"total": 25, "additions": 24, "deletions": 1}, "files": [{"sha": "f9e00198bbfd352960685b5c72193570e232e68a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/786c6d10af3386f348d676a27b3d7f195dff9700/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/786c6d10af3386f348d676a27b3d7f195dff9700/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=786c6d10af3386f348d676a27b3d7f195dff9700", "patch": "@@ -1,3 +1,8 @@\n+2017-06-27  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR sanitizer/81223\n+\t* ubsan.c (instrument_null): Check get_base_address's result for null.\n+\n 2017-06-27  Marc Glisse  <marc.glisse@inria.fr>\n \n \t* match.pd ((A+-B)+(C-A), (A+B)-(A-C)): New transformations."}, {"sha": "98faa118078c1182248f511b0dd9bcd6e059a54e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/786c6d10af3386f348d676a27b3d7f195dff9700/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/786c6d10af3386f348d676a27b3d7f195dff9700/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=786c6d10af3386f348d676a27b3d7f195dff9700", "patch": "@@ -1,3 +1,8 @@\n+2017-06-27  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR sanitizer/81223\n+\t* gcc.dg/ubsan/pr81223.c: New test.\n+\n 2017-06-27  Marc Glisse  <marc.glisse@inria.fr>\n \n \t* gcc.dg/tree-ssa/assoc-1.c: New file."}, {"sha": "e7aff5243e601ddbc3e1cbb68074ef4edddfcaf0", "filename": "gcc/testsuite/gcc.dg/ubsan/pr81223.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/786c6d10af3386f348d676a27b3d7f195dff9700/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr81223.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/786c6d10af3386f348d676a27b3d7f195dff9700/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr81223.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr81223.c?ref=786c6d10af3386f348d676a27b3d7f195dff9700", "patch": "@@ -0,0 +1,12 @@\n+/* PR sanitizer/81223 */\n+/* { dg-do compile } */\n+/* { dg-options \"-fsanitize=undefined\" } */\n+\n+void bar ();\n+\n+void\n+foo (int x)\n+{\n+  struct S { char a[x]; } v;\n+  bar (v);\n+}"}, {"sha": "bd0588b89baa07a4ae336d701af124336e74df2f", "filename": "gcc/ubsan.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/786c6d10af3386f348d676a27b3d7f195dff9700/gcc%2Fubsan.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/786c6d10af3386f348d676a27b3d7f195dff9700/gcc%2Fubsan.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fubsan.c?ref=786c6d10af3386f348d676a27b3d7f195dff9700", "patch": "@@ -1228,7 +1228,8 @@ instrument_null (gimple_stmt_iterator gsi, tree t, bool is_lhs)\n   if (TREE_CODE (t) == ADDR_EXPR)\n     t = TREE_OPERAND (t, 0);\n   tree base = get_base_address (t);\n-  if (TREE_CODE (base) == MEM_REF\n+  if (base != NULL_TREE\n+      && TREE_CODE (base) == MEM_REF\n       && TREE_CODE (TREE_OPERAND (base, 0)) == SSA_NAME)\n     instrument_mem_ref (t, base, &gsi, is_lhs);\n }"}]}