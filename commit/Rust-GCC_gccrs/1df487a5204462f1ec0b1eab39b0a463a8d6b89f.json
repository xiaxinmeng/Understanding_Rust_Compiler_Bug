{"sha": "1df487a5204462f1ec0b1eab39b0a463a8d6b89f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWRmNDg3YTUyMDQ0NjJmMWVjMGIxZWFiMzliMGE0NjNhOGQ2Yjg5Zg==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2020-09-17T13:41:29Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2020-09-18T21:39:46Z"}, "message": "analyzer: fix warning_event::get_desc for global state changes\n\nWhen experimenting the a new state_machine with global state I noticed\nthat the fallback handling in warning_event::get_desc assumes we have\nper-value states, and ICEs on global states.  Fixed thusly.\n\ngcc/analyzer/ChangeLog:\n\t* checker-path.cc (warning_event::get_desc): Handle global state\n\tchanges.", "tree": {"sha": "3d1b0fb6cb1bae2f174d48d6252ca6752182a2db", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3d1b0fb6cb1bae2f174d48d6252ca6752182a2db"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1df487a5204462f1ec0b1eab39b0a463a8d6b89f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1df487a5204462f1ec0b1eab39b0a463a8d6b89f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1df487a5204462f1ec0b1eab39b0a463a8d6b89f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1df487a5204462f1ec0b1eab39b0a463a8d6b89f/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c89956cba9d1a5fbf059f7880ff49418718a2965", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c89956cba9d1a5fbf059f7880ff49418718a2965", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c89956cba9d1a5fbf059f7880ff49418718a2965"}], "stats": {"total": 29, "additions": 21, "deletions": 8}, "files": [{"sha": "c28131651c66000acfa1cf1ced848d18bb603a0e", "filename": "gcc/analyzer/checker-path.cc", "status": "modified", "additions": 21, "deletions": 8, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1df487a5204462f1ec0b1eab39b0a463a8d6b89f/gcc%2Fanalyzer%2Fchecker-path.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1df487a5204462f1ec0b1eab39b0a463a8d6b89f/gcc%2Fanalyzer%2Fchecker-path.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fanalyzer%2Fchecker-path.cc?ref=1df487a5204462f1ec0b1eab39b0a463a8d6b89f", "patch": "@@ -872,11 +872,17 @@ warning_event::get_desc (bool can_colorize) const\n \t{\n \t  if (m_sm && flag_analyzer_verbose_state_changes)\n \t    {\n-\t      label_text result\n-\t\t= make_label_text (can_colorize,\n-\t\t\t\t   \"%s (%qE is in state %qs)\",\n-\t\t\t\t   ev_desc.m_buffer,\n-\t\t\t\t   m_var, m_state->get_name ());\n+\t      label_text result;\n+\t      if (m_var)\n+\t\tresult = make_label_text (can_colorize,\n+\t\t\t\t\t  \"%s (%qE is in state %qs)\",\n+\t\t\t\t\t  ev_desc.m_buffer,\n+\t\t\t\t\t  m_var, m_state->get_name ());\n+\t      else\n+\t\tresult = make_label_text (can_colorize,\n+\t\t\t\t\t  \"%s (in global state %qs)\",\n+\t\t\t\t\t  ev_desc.m_buffer,\n+\t\t\t\t\t  m_state->get_name ());\n \t      ev_desc.maybe_free ();\n \t      return result;\n \t    }\n@@ -886,9 +892,16 @@ warning_event::get_desc (bool can_colorize) const\n     }\n \n   if (m_sm)\n-    return make_label_text (can_colorize,\n-\t\t\t    \"here (%qE is in state %qs)\",\n-\t\t\t    m_var, m_state->get_name ());\n+    {\n+      if (m_var)\n+\treturn make_label_text (can_colorize,\n+\t\t\t\t\"here (%qE is in state %qs)\",\n+\t\t\t\tm_var, m_state->get_name ());\n+      else\n+\treturn make_label_text (can_colorize,\n+\t\t\t\t\"here (in global state %qs)\",\n+\t\t\t\tm_state->get_name ());\n+    }\n   else\n     return label_text::borrow (\"here\");\n }"}]}