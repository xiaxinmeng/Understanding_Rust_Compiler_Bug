{"sha": "49ee944b8691ed7743816b8a995cb20b64ce7cbf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDllZTk0NGI4NjkxZWQ3NzQzODE2YjhhOTk1Y2IyMGI2NGNlN2NiZg==", "commit": {"author": {"name": "Zack Weinberg", "email": "zackw@stanford.edu", "date": "2001-03-21T19:29:33Z"}, "committer": {"name": "Zack Weinberg", "email": "zack@gcc.gnu.org", "date": "2001-03-21T19:29:33Z"}, "message": "make-temp-file.c: Always default DIR_SEPARATOR to '/'.\n\n\t* make-temp-file.c: Always default DIR_SEPARATOR to '/'.\n\tDon't default P_tmpdir to anything.  Try /var/tmp before\n\t/usr/tmp.\n\nFrom-SVN: r40706", "tree": {"sha": "8515fca11132a4e0d7a76c45f57d392a0e4580df", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8515fca11132a4e0d7a76c45f57d392a0e4580df"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/49ee944b8691ed7743816b8a995cb20b64ce7cbf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/49ee944b8691ed7743816b8a995cb20b64ce7cbf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/49ee944b8691ed7743816b8a995cb20b64ce7cbf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/49ee944b8691ed7743816b8a995cb20b64ce7cbf/comments", "author": null, "committer": null, "parents": [{"sha": "edb7d731b6b69e7e6847147b05d8a9f0dc4375dd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/edb7d731b6b69e7e6847147b05d8a9f0dc4375dd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/edb7d731b6b69e7e6847147b05d8a9f0dc4375dd"}], "stats": {"total": 34, "additions": 13, "deletions": 21}, "files": [{"sha": "444cad814706b7fb868762e91d94db046f5bd16d", "filename": "libiberty/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49ee944b8691ed7743816b8a995cb20b64ce7cbf/libiberty%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49ee944b8691ed7743816b8a995cb20b64ce7cbf/libiberty%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2FChangeLog?ref=49ee944b8691ed7743816b8a995cb20b64ce7cbf", "patch": "@@ -1,3 +1,9 @@\n+2001-03-21  Zack Weinberg  <zackw@stanford.edu>\n+\n+\t* make-temp-file.c: Always default DIR_SEPARATOR to '/'.\n+\tDon't default P_tmpdir to anything.  Try /var/tmp before\n+\t/usr/tmp.\n+\n 2001-03-20  Zack Weinberg  <zackw@stanford.edu>\n \n \t* choose-temp.c: Split off make_temp_file, and the code"}, {"sha": "67efed16a581dfe09e3c7ec395516ad5e1ddf8fb", "filename": "libiberty/make-temp-file.c", "status": "modified", "additions": 7, "deletions": 21, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49ee944b8691ed7743816b8a995cb20b64ce7cbf/libiberty%2Fmake-temp-file.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49ee944b8691ed7743816b8a995cb20b64ce7cbf/libiberty%2Fmake-temp-file.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Fmake-temp-file.c?ref=49ee944b8691ed7743816b8a995cb20b64ce7cbf", "patch": "@@ -45,28 +45,11 @@ Boston, MA 02111-1307, USA.  */\n #include \"libiberty.h\"\n extern int mkstemps PARAMS ((char *, int));\n \n-#ifndef IN_GCC\n-#if defined (__MSDOS__) || (defined (_WIN32) && ! defined (__CYGWIN__) && ! defined (_UWIN))\n-#define DIR_SEPARATOR '\\\\'\n-#endif\n-#endif\n-\n+/* '/' works just fine on MS-DOS based systems.  */\n #ifndef DIR_SEPARATOR\n #define DIR_SEPARATOR '/'\n #endif\n \n-/* On MSDOS, write temp files in current dir\n-   because there's no place else we can expect to use.  */\n-/* ??? Although the current directory is tried as a last resort,\n-   this is left in so that on MSDOS it is preferred to /tmp on the\n-   off chance that someone requires this, since that was the previous\n-   behaviour.  */\n-#ifdef __MSDOS__\n-#ifndef P_tmpdir\n-#define P_tmpdir \".\"\n-#endif\n-#endif\n-\n /* Name of temporary file.\n    mktemp requires 6 trailing X's.  */\n #define TEMP_FILE \"ccXXXXXX\"\n@@ -92,9 +75,11 @@ try (dir, base)\n   return 0;\n }\n \n-static char tmp[] = { DIR_SEPARATOR, 't', 'm', 'p', 0 };\n-static char usrtmp[] =\n+static const char tmp[] = { DIR_SEPARATOR, 't', 'm', 'p', 0 };\n+static const char usrtmp[] =\n { DIR_SEPARATOR, 'u', 's', 'r', DIR_SEPARATOR, 't', 'm', 'p', 0 };\n+static const char vartmp[] =\n+{ DIR_SEPARATOR, 'v', 'a', 'r', DIR_SEPARATOR, 't', 'm', 'p', 0 };\n \n static char *memoized_tmpdir;\n \n@@ -116,7 +101,8 @@ choose_tmpdir ()\n   base = try (P_tmpdir, base);\n #endif\n \n-  /* Try /usr/tmp, then /tmp.  */\n+  /* Try /var/tmp, /usr/tmp, then /tmp.  */\n+  base = try (vartmp, base);\n   base = try (usrtmp, base);\n   base = try (tmp, base);\n  "}]}