{"sha": "5d4c34aaade8422c8289daa8a5c95fab7830de37", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWQ0YzM0YWFhZGU4NDIyYzgyODlkYWE4YTVjOTVmYWI3ODMwZGUzNw==", "commit": {"author": {"name": "Claudiu Zissulescu", "email": "claziss@synopsys.com", "date": "2017-11-30T14:42:01Z"}, "committer": {"name": "Claudiu Zissulescu", "email": "claziss@gcc.gnu.org", "date": "2017-11-30T14:42:01Z"}, "message": "[ARC] Update uses for hw-loop labels.\n\nMake sure we mark the hw-loop labels as beeing used.\n\ngcc/\n2017-09-19  Claudiu Zissulescu  <claziss@synopsys.com>\n\n\t* config/arc/arc.c (hwloop_optimize): Update hw-loop's end/start\n\tlabels number of usages.\n\ngcc/testsuite\n2017-09-19  Claudiu Zissulescu  <claziss@synopsys.com>\n\n\t* gcc.target/arc/loop-2.cpp: New test.\n\nFrom-SVN: r255274", "tree": {"sha": "8c5aac5e60a55af7cbc47ecbba0fa629ed417b7e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8c5aac5e60a55af7cbc47ecbba0fa629ed417b7e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5d4c34aaade8422c8289daa8a5c95fab7830de37", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d4c34aaade8422c8289daa8a5c95fab7830de37", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5d4c34aaade8422c8289daa8a5c95fab7830de37", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d4c34aaade8422c8289daa8a5c95fab7830de37/comments", "author": {"login": "claziss", "id": 2761368, "node_id": "MDQ6VXNlcjI3NjEzNjg=", "avatar_url": "https://avatars.githubusercontent.com/u/2761368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/claziss", "html_url": "https://github.com/claziss", "followers_url": "https://api.github.com/users/claziss/followers", "following_url": "https://api.github.com/users/claziss/following{/other_user}", "gists_url": "https://api.github.com/users/claziss/gists{/gist_id}", "starred_url": "https://api.github.com/users/claziss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/claziss/subscriptions", "organizations_url": "https://api.github.com/users/claziss/orgs", "repos_url": "https://api.github.com/users/claziss/repos", "events_url": "https://api.github.com/users/claziss/events{/privacy}", "received_events_url": "https://api.github.com/users/claziss/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "31e72f4f37b9ed02cd5e28a30c7c4b46b96ac913", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/31e72f4f37b9ed02cd5e28a30c7c4b46b96ac913", "html_url": "https://github.com/Rust-GCC/gccrs/commit/31e72f4f37b9ed02cd5e28a30c7c4b46b96ac913"}], "stats": {"total": 30, "additions": 30, "deletions": 0}, "files": [{"sha": "945490947dfec44a1945184da589c549ce299170", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d4c34aaade8422c8289daa8a5c95fab7830de37/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d4c34aaade8422c8289daa8a5c95fab7830de37/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5d4c34aaade8422c8289daa8a5c95fab7830de37", "patch": "@@ -1,3 +1,8 @@\n+2017-11-30  Claudiu Zissulescu  <claziss@synopsys.com>\n+\n+\t* config/arc/arc.c (hwloop_optimize): Update hw-loop's end/start\n+\tlabels number of usages.\n+\n 2017-11-30  Claudiu Zissulescu  <claziss@synopsys.com>\n \n \t* config/arc/arc.c (arc_cannot_substitue_mem_equiv_p): New"}, {"sha": "57ea502db4a0d6f9e35a2ff733c5cfdd4b5cd1b1", "filename": "gcc/config/arc/arc.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d4c34aaade8422c8289daa8a5c95fab7830de37/gcc%2Fconfig%2Farc%2Farc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d4c34aaade8422c8289daa8a5c95fab7830de37/gcc%2Fconfig%2Farc%2Farc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farc%2Farc.c?ref=5d4c34aaade8422c8289daa8a5c95fab7830de37", "patch": "@@ -7501,6 +7501,9 @@ hwloop_optimize (hwloop_info loop)\n   /* Insert the loop end label before the last instruction of the\n      loop.  */\n   emit_label_after (end_label, loop->last_insn);\n+  /* Make sure we mark the begining and end label as used.  */\n+  LABEL_NUSES (loop->end_label)++;\n+  LABEL_NUSES (loop->start_label)++;\n \n   return true;\n }"}, {"sha": "1b5359d319e1eb3371936806002a496f1279bfaf", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d4c34aaade8422c8289daa8a5c95fab7830de37/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d4c34aaade8422c8289daa8a5c95fab7830de37/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5d4c34aaade8422c8289daa8a5c95fab7830de37", "patch": "@@ -1,3 +1,7 @@\n+2017-11-30  Claudiu Zissulescu  <claziss@synopsys.com>\n+\n+\t* gcc.target/arc/loop-2.cpp: New test.\n+\n 2017-11-30  Claudiu Zissulescu  <claziss@synopsys.com>\n \n \t* gcc.target/arc/lra-1.c: New test."}, {"sha": "d1dc917ba47904329e3855a58de294f271755fb9", "filename": "gcc/testsuite/gcc.target/arc/loop-2.cpp", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d4c34aaade8422c8289daa8a5c95fab7830de37/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Floop-2.cpp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d4c34aaade8422c8289daa8a5c95fab7830de37/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Floop-2.cpp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Floop-2.cpp?ref=5d4c34aaade8422c8289daa8a5c95fab7830de37", "patch": "@@ -0,0 +1,18 @@\n+/* { dg-options \"-O2\" } *\n+/* { dg-do assemble } */\n+\n+/* This file fails to assemble if we forgot to increase the number of\n+   uses for loop's start and end labels.  */\n+int a, c, d;\n+int *b;\n+void fn1(int p1) {\n+  if (d == 5)\n+    for (int i; i < p1; ++i)\n+      if (c)\n+        b[i] = c;\n+      else\n+        int t = a = t;\n+  else\n+    for (int i; i < p1; ++i)\n+      b[i] = 0;\n+}"}]}