{"sha": "b86a760aed87957b7f57a39aeef25ac8ab8ecaa9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yjg2YTc2MGFlZDg3OTU3YjdmNTdhMzlhZWVmMjVhYzhhYjhlY2FhOQ==", "commit": {"author": {"name": "Kaveh R. Ghazi", "email": "ghazi@caip.rutgers.edu", "date": "2007-02-03T20:49:51Z"}, "committer": {"name": "Kaveh Ghazi", "email": "ghazi@gcc.gnu.org", "date": "2007-02-03T20:49:51Z"}, "message": "emit-rtl.c (dconstpi): Delete.\n\n\t* emit-rtl.c (dconstpi): Delete.\n\t(dconstsqrt2): New.\n\t(init_emit_once): Delete dconstpi and init dconstsqrt2.\n\t* real.h (dconstpi): Delete.\n\t(dconstsqrt2): New.\n\t* builtins.c (fold_builtin_cabs): Use dconstsqrt2.\n\t(fold_builtin_hypot): Likewise.\n\nFrom-SVN: r121550", "tree": {"sha": "3c924698e0bed7d0bb13a6fbd463def170b9bb50", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3c924698e0bed7d0bb13a6fbd463def170b9bb50"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b86a760aed87957b7f57a39aeef25ac8ab8ecaa9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b86a760aed87957b7f57a39aeef25ac8ab8ecaa9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b86a760aed87957b7f57a39aeef25ac8ab8ecaa9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b86a760aed87957b7f57a39aeef25ac8ab8ecaa9/comments", "author": null, "committer": null, "parents": [{"sha": "3a610de8791728417247258df99cf16c14c09822", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3a610de8791728417247258df99cf16c14c09822", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3a610de8791728417247258df99cf16c14c09822"}], "stats": {"total": 32, "additions": 20, "deletions": 12}, "files": [{"sha": "b6ccf374c96c4855de8605cdd0aba8da9fd44d95", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b86a760aed87957b7f57a39aeef25ac8ab8ecaa9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b86a760aed87957b7f57a39aeef25ac8ab8ecaa9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b86a760aed87957b7f57a39aeef25ac8ab8ecaa9", "patch": "@@ -1,3 +1,13 @@\n+2007-02-03  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n+\n+\t* emit-rtl.c (dconstpi): Delete.\n+\t(dconstsqrt2): New.\n+\t(init_emit_once): Delete dconstpi and init dconstsqrt2.\n+\t* real.h (dconstpi): Delete.\n+\t(dconstsqrt2): New.\n+\t* builtins.c (fold_builtin_cabs): Use dconstsqrt2.\n+\t(fold_builtin_hypot): Likewise.\n+\n 2007-02-03  Tom Tromey  <tromey@redhat.com>\n \n \tPR driver/30246"}, {"sha": "b7ff78203f810a3859a669619dc2175c02ace04d", "filename": "gcc/builtins.c", "status": "modified", "additions": 6, "deletions": 8, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b86a760aed87957b7f57a39aeef25ac8ab8ecaa9/gcc%2Fbuiltins.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b86a760aed87957b7f57a39aeef25ac8ab8ecaa9/gcc%2Fbuiltins.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbuiltins.c?ref=b86a760aed87957b7f57a39aeef25ac8ab8ecaa9", "patch": "@@ -7158,13 +7158,12 @@ fold_builtin_cabs (tree arglist, tree type, tree fndecl)\n       if (flag_unsafe_math_optimizations\n \t  && operand_equal_p (real, imag, OEP_PURE_SAME))\n         {\n-\t  REAL_VALUE_TYPE sqrt2;\n-\n-\t  real_sqrt (&sqrt2, TYPE_MODE (type), &dconst2);\n+\t  const REAL_VALUE_TYPE sqrt2_trunc\n+\t    = real_value_truncate (TYPE_MODE (type), dconstsqrt2);\n \t  STRIP_NOPS (real);\n \t  return fold_build2 (MULT_EXPR, type,\n \t\t\t      fold_build1 (ABS_EXPR, type, real),\n-\t\t\t      build_real (type, sqrt2));\n+\t\t\t      build_real (type, sqrt2_trunc));\n \t}\n     }\n \n@@ -8059,12 +8058,11 @@ fold_builtin_hypot (tree fndecl, tree arglist, tree type)\n   if (flag_unsafe_math_optimizations\n       && operand_equal_p (arg0, arg1, OEP_PURE_SAME))\n     {\n-      REAL_VALUE_TYPE sqrt2;\n-\n-      real_sqrt (&sqrt2, TYPE_MODE (type), &dconst2);\n+      const REAL_VALUE_TYPE sqrt2_trunc\n+\t= real_value_truncate (TYPE_MODE (type), dconstsqrt2);\n       return fold_build2 (MULT_EXPR, type,\n \t\t\t  fold_build1 (ABS_EXPR, type, arg0),\n-\t\t\t  build_real (type, sqrt2));\n+\t\t\t  build_real (type, sqrt2_trunc));\n     }\n \n   return NULL_TREE;"}, {"sha": "1faa57ffedb6e408936fcc5cf6c7435cb0ba82fc", "filename": "gcc/emit-rtl.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b86a760aed87957b7f57a39aeef25ac8ab8ecaa9/gcc%2Femit-rtl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b86a760aed87957b7f57a39aeef25ac8ab8ecaa9/gcc%2Femit-rtl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Femit-rtl.c?ref=b86a760aed87957b7f57a39aeef25ac8ab8ecaa9", "patch": "@@ -105,7 +105,7 @@ REAL_VALUE_TYPE dconstm1;\n REAL_VALUE_TYPE dconstm2;\n REAL_VALUE_TYPE dconsthalf;\n REAL_VALUE_TYPE dconstthird;\n-REAL_VALUE_TYPE dconstpi;\n+REAL_VALUE_TYPE dconstsqrt2;\n REAL_VALUE_TYPE dconste;\n \n /* All references to the following fixed hard registers go through\n@@ -5154,8 +5154,8 @@ init_emit_once (int line_numbers)\n \n   /* Initialize mathematical constants for constant folding builtins.\n      These constants need to be given to at least 160 bits precision.  */\n-  real_from_string (&dconstpi,\n-    \"3.1415926535897932384626433832795028841971693993751058209749445923078\");\n+  real_from_string (&dconstsqrt2,\n+    \"1.4142135623730950488016887242096980785696718753769480731766797379907\");\n   real_from_string (&dconste,\n     \"2.7182818284590452353602874713526624977572470936999595749669676277241\");\n "}, {"sha": "fda1095b1bc88dc5f26c44d604a9d52d53ee4b1f", "filename": "gcc/real.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b86a760aed87957b7f57a39aeef25ac8ab8ecaa9/gcc%2Freal.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b86a760aed87957b7f57a39aeef25ac8ab8ecaa9/gcc%2Freal.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freal.h?ref=b86a760aed87957b7f57a39aeef25ac8ab8ecaa9", "patch": "@@ -387,7 +387,7 @@ extern REAL_VALUE_TYPE dconstm1;\n extern REAL_VALUE_TYPE dconstm2;\n extern REAL_VALUE_TYPE dconsthalf;\n extern REAL_VALUE_TYPE dconstthird;\n-extern REAL_VALUE_TYPE dconstpi;\n+extern REAL_VALUE_TYPE dconstsqrt2;\n extern REAL_VALUE_TYPE dconste;\n \n /* Function to return a real value (not a tree node)"}]}