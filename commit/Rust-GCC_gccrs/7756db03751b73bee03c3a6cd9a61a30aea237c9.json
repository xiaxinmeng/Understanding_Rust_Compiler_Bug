{"sha": "7756db03751b73bee03c3a6cd9a61a30aea237c9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Nzc1NmRiMDM3NTFiNzNiZWUwM2MzYTZjZDlhNjFhMzBhZWEyMzdjOQ==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2004-08-02T18:49:07Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2004-08-02T18:49:07Z"}, "message": "re PR c++/16707 (ICE with using)\n\n\tPR c++/16707\n\t* name-lookup.c (validate_nonmember_using_decl): Robustify.\n\n\tPR c++/16707\n\t* g++.dg/lookup/using12.C: New test.\n\nFrom-SVN: r85446", "tree": {"sha": "7c30c43cf161e0e414cbadd2120475d775c23854", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7c30c43cf161e0e414cbadd2120475d775c23854"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7756db03751b73bee03c3a6cd9a61a30aea237c9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7756db03751b73bee03c3a6cd9a61a30aea237c9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7756db03751b73bee03c3a6cd9a61a30aea237c9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7756db03751b73bee03c3a6cd9a61a30aea237c9/comments", "author": null, "committer": null, "parents": [{"sha": "6ed7c4d85733180e7cfdaa2ea791e3520550ac70", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6ed7c4d85733180e7cfdaa2ea791e3520550ac70", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6ed7c4d85733180e7cfdaa2ea791e3520550ac70"}], "stats": {"total": 32, "additions": 23, "deletions": 9}, "files": [{"sha": "d87b4827aee2fc5c695eecf84fa382be48404a5a", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7756db03751b73bee03c3a6cd9a61a30aea237c9/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7756db03751b73bee03c3a6cd9a61a30aea237c9/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=7756db03751b73bee03c3a6cd9a61a30aea237c9", "patch": "@@ -1,3 +1,8 @@\n+2004-08-02  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/16707\n+\t* name-lookup.c (validate_nonmember_using_decl): Robustify.\n+\n 2004-08-01  Mark Mitchell  <mark@codesourcery.com>\n \n \tPR c++/16224"}, {"sha": "2859d8035b9fd95ff6887290f3f4c817ed96866d", "filename": "gcc/cp/name-lookup.c", "status": "modified", "additions": 11, "deletions": 9, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7756db03751b73bee03c3a6cd9a61a30aea237c9/gcc%2Fcp%2Fname-lookup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7756db03751b73bee03c3a6cd9a61a30aea237c9/gcc%2Fcp%2Fname-lookup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fname-lookup.c?ref=7756db03751b73bee03c3a6cd9a61a30aea237c9", "patch": "@@ -2115,6 +2115,17 @@ push_overloaded_decl (tree decl, int flags)\n static tree\n validate_nonmember_using_decl (tree decl, tree scope, tree name)\n {\n+  /* [namespace.udecl]\n+       A using-declaration for a class member shall be a\n+       member-declaration.  */\n+  if (TYPE_P (scope))\n+    {\n+      error (\"`%T' is not a namespace\", scope);\n+      return NULL_TREE;\n+    }\n+  else if (scope == error_mark_node)\n+    return NULL_TREE;\n+\n   if (TREE_CODE (decl) == TEMPLATE_ID_EXPR)\n     {\n       /* 7.3.3/5\n@@ -2142,15 +2153,6 @@ validate_nonmember_using_decl (tree decl, tree scope, tree name)\n \n   my_friendly_assert (DECL_P (decl), 20020908);\n \n-  /* [namespace.udecl]\n-       A using-declaration for a class member shall be a\n-       member-declaration.  */\n-  if (TYPE_P (scope))\n-    {\n-      error (\"`%T' is not a namespace\", scope);\n-      return NULL_TREE;\n-    }\n-\n   /* Make a USING_DECL.  */\n   return push_using_decl (scope, name);\n }"}, {"sha": "4ae35e2c75de0eda4ca13c730ed9f10be1f6a2de", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7756db03751b73bee03c3a6cd9a61a30aea237c9/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7756db03751b73bee03c3a6cd9a61a30aea237c9/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7756db03751b73bee03c3a6cd9a61a30aea237c9", "patch": "@@ -1,5 +1,8 @@\n 2004-08-02  Mark Mitchell  <mark@codesourcery.com>\n \n+\tPR c++/16707\n+\t* g++.dg/lookup/using12.C: New test.\n+\n \t* g++.dg/init/null1.C: Fix PR number.\n \t* g++.dg/parse/namespace10.C: Likewise.\n "}, {"sha": "030385581a5e3ad21256f90ed1d316e05610d508", "filename": "gcc/testsuite/g++.dg/lookup/using12.C", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7756db03751b73bee03c3a6cd9a61a30aea237c9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fusing12.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7756db03751b73bee03c3a6cd9a61a30aea237c9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fusing12.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fusing12.C?ref=7756db03751b73bee03c3a6cd9a61a30aea237c9", "patch": "@@ -0,0 +1,4 @@\n+// PR c++/16707\n+\n+int i;\n+using N::i; // { dg-error \"declared|expected\" }"}]}