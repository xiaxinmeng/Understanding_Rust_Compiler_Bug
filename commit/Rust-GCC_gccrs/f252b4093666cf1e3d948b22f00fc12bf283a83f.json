{"sha": "f252b4093666cf1e3d948b22f00fc12bf283a83f", "node_id": "C_kwDOANBUbNoAKGYyNTJiNDA5MzY2NmNmMWUzZDk0OGIyMmYwMGZjMTJiZjI4M2E4M2Y", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2022-09-08T00:39:35Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-09-08T00:39:35Z"}, "message": "Merge #1528\n\n1528: add testcase with struct to test component_ref and constructor codes in eval_constant_expression() r=philberty a=abbasfaisal\n\n\n\nCo-authored-by: Faisal Abbas <90.abbasfaisal@gmail.com>", "tree": {"sha": "4f72d95d129fdfeffba1a160a0d5904e4ed59396", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4f72d95d129fdfeffba1a160a0d5904e4ed59396"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f252b4093666cf1e3d948b22f00fc12bf283a83f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjGTnHCRBK7hj4Ov3rIwAA13cIAHGiVuG0ifE7VpnN7qTrNHe0\nivVrk2UaGg0PqjkPMTOyGeXP8dMjXJUxs/CdOikjH/zEi3NslGCjRwUDxBO+euaf\nSeuY296Twg8Z9h1IoW967+J9n8HbEjT8LpwzwH2IAp1z4PnPCztxIyATHEMdXWqa\no6NgoIxCqpjCJufNrA/gyjQQdWHWe8BVjlSm00bR6RZJO58uY6hEQRy4W7S7w+rk\nxwdfipNgbVWAtoIBhbE8FS42iZRwwDeVDVZEjmAn50P7VPL0UJj+0bknytIBTGM6\n9FXxWazuUmpqZQg7atSleUt8w9dBjyCjNJzChiwEzD+hPby3ST7aD4NVYjSE+WM=\n=F6vb\n-----END PGP SIGNATURE-----\n", "payload": "tree 4f72d95d129fdfeffba1a160a0d5904e4ed59396\nparent f03760b98ba4160f08ade309daf22fedaf1cc2dd\nparent 908f1e2022cd1b957a33187d921455ff86749065\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1662597575 +0000\ncommitter GitHub <noreply@github.com> 1662597575 +0000\n\nMerge #1528\n\n1528: add testcase with struct to test component_ref and constructor codes in eval_constant_expression() r=philberty a=abbasfaisal\n\n\n\nCo-authored-by: Faisal Abbas <90.abbasfaisal@gmail.com>\n"}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f252b4093666cf1e3d948b22f00fc12bf283a83f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f252b4093666cf1e3d948b22f00fc12bf283a83f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f252b4093666cf1e3d948b22f00fc12bf283a83f/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f03760b98ba4160f08ade309daf22fedaf1cc2dd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f03760b98ba4160f08ade309daf22fedaf1cc2dd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f03760b98ba4160f08ade309daf22fedaf1cc2dd"}, {"sha": "908f1e2022cd1b957a33187d921455ff86749065", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/908f1e2022cd1b957a33187d921455ff86749065", "html_url": "https://github.com/Rust-GCC/gccrs/commit/908f1e2022cd1b957a33187d921455ff86749065"}], "stats": {"total": 40, "additions": 40, "deletions": 0}, "files": [{"sha": "94c4268ec8c6c3e0771722e4031bf29bc8122dbd", "filename": "gcc/testsuite/rust/compile/const8.rs", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f252b4093666cf1e3d948b22f00fc12bf283a83f/gcc%2Ftestsuite%2Frust%2Fcompile%2Fconst8.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f252b4093666cf1e3d948b22f00fc12bf283a83f/gcc%2Ftestsuite%2Frust%2Fcompile%2Fconst8.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Fconst8.rs?ref=f252b4093666cf1e3d948b22f00fc12bf283a83f", "patch": "@@ -0,0 +1,40 @@\n+// { dg-options \"-w -O0 -fdump-tree-gimple\" }\n+struct Foo {\n+    First: i32,\n+    Second: f32\n+}\n+\n+struct Bar {\n+    First: i32,\n+    Second: f32\n+}\n+\n+struct Baz {\n+    First: i32,\n+    Second: f32\n+}\n+const A:Foo = Foo { First: 1, Second: 1.0 };\n+const B:Bar = Bar { First: 2, Second: 2.0 };\n+const C:Baz = Baz { First: 3, Second: 2.0 };\n+\n+const fn test() -> f32 {\n+    if (A.First == 2) {\n+        return A.Second;\n+    }\n+    else if (B.First == 2) {\n+        return B.Second;\n+    }\n+    else if (C.First == 2) {\n+        return C.Second;\n+    }\n+\n+    return 0.0;\n+}\n+\n+const D:f32 = test();\n+\n+fn main() {\n+    // { dg-final { scan-tree-dump-times {d = 2.0} 1 gimple } }\n+    let d = D;\n+}\n+"}]}