{"sha": "dfd71aba57811c28d21a49909d9c6b96f5ae05ea", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGZkNzFhYmE1NzgxMWMyOGQyMWE0OTkwOWQ5YzZiOTZmNWFlMDVlYQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2015-08-20T10:18:03Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2015-08-20T10:18:03Z"}, "message": "re PR c++/67065 ([DR 1886] Missing diagnostics for ill-formed program with main variable instead of function)\n\n/cp\n2015-08-20  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/67065\n\t* decl.c (grokvardecl): Reject 'main' as global variable.\n\n/testsuite\n2015-08-20  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/67065\n\t* g++.dg/other/pr67065.C: New.\n\nFrom-SVN: r227027", "tree": {"sha": "3c00edc44d1918711586f8f1529d6b2d37f4c7bf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3c00edc44d1918711586f8f1529d6b2d37f4c7bf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dfd71aba57811c28d21a49909d9c6b96f5ae05ea", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dfd71aba57811c28d21a49909d9c6b96f5ae05ea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dfd71aba57811c28d21a49909d9c6b96f5ae05ea", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dfd71aba57811c28d21a49909d9c6b96f5ae05ea/comments", "author": null, "committer": null, "parents": [{"sha": "58df0b91cbca6814b243256bb7900341b5316d14", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/58df0b91cbca6814b243256bb7900341b5316d14", "html_url": "https://github.com/Rust-GCC/gccrs/commit/58df0b91cbca6814b243256bb7900341b5316d14"}], "stats": {"total": 21, "additions": 20, "deletions": 1}, "files": [{"sha": "53d4febe962804a3a168cfe6dc1ec5a70704c75c", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dfd71aba57811c28d21a49909d9c6b96f5ae05ea/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dfd71aba57811c28d21a49909d9c6b96f5ae05ea/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=dfd71aba57811c28d21a49909d9c6b96f5ae05ea", "patch": "@@ -1,3 +1,8 @@\n+2015-08-20  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/67065\n+\t* decl.c (grokvardecl): Reject 'main' as global variable.\n+\n 2015-08-19  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/66957"}, {"sha": "4f77e7c23c42a028813ea1f32a137a36fe4f797a", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dfd71aba57811c28d21a49909d9c6b96f5ae05ea/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dfd71aba57811c28d21a49909d9c6b96f5ae05ea/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=dfd71aba57811c28d21a49909d9c6b96f5ae05ea", "patch": "@@ -8355,6 +8355,11 @@ grokvardecl (tree type,\n   else\n     DECL_INTERFACE_KNOWN (decl) = 1;\n \n+  if (DECL_NAME (decl)\n+      && MAIN_NAME_P (DECL_NAME (decl))\n+      && CP_DECL_CONTEXT (decl) == global_namespace)\n+    error (\"cannot declare %<::main%> to be a global variable\");\n+\n   /* Check that the variable can be safely declared as a concept.\n      Note that this also forbids explicit specializations.  */\n   if (conceptp)"}, {"sha": "36a3d9e271659dfa8d2539ca7e28f2d94248c6b6", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dfd71aba57811c28d21a49909d9c6b96f5ae05ea/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dfd71aba57811c28d21a49909d9c6b96f5ae05ea/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=dfd71aba57811c28d21a49909d9c6b96f5ae05ea", "patch": "@@ -1,6 +1,12 @@\n+2015-08-20  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/67065\n+\t* g++.dg/other/pr67065.C: New.\n+\n 2015-08-20  Simon Dardis  <simon.dardis@imgtec.com>\n \n-\t* gcc.target/mips/inline-memcpy-1.c: Test for inline expansion of memcpy.\n+\t* gcc.target/mips/inline-memcpy-1.c: Test for inline expansion of\n+\tmemcpy.\n \t* gcc.target/mips/inline-memcpy-2.c: Ditto.\n \t* gcc.target/mips/inline-memcpy-3.c: Ditto.\n \t* gcc.target/mips/inline-memcpy-4.c: Ditto."}, {"sha": "cbf03b23b8a962067fd29d3ee89e0b25e42f463c", "filename": "gcc/testsuite/g++.dg/other/pr67065.C", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dfd71aba57811c28d21a49909d9c6b96f5ae05ea/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr67065.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dfd71aba57811c28d21a49909d9c6b96f5ae05ea/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr67065.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr67065.C?ref=dfd71aba57811c28d21a49909d9c6b96f5ae05ea", "patch": "@@ -0,0 +1,3 @@\n+// PR c++/67065\n+\n+int main;  // { dg-error \"cannot declare\" }"}]}