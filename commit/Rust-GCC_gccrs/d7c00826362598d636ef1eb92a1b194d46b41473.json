{"sha": "d7c00826362598d636ef1eb92a1b194d46b41473", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDdjMDA4MjYzNjI1OThkNjM2ZWYxZWI5MmExYjE5NGQ0NmI0MTQ3Mw==", "commit": {"author": {"name": "Senthil Kumar Selvaraj", "email": "senthilkumar.selvaraj@microchip.com", "date": "2018-12-17T10:50:54Z"}, "committer": {"name": "Senthil Kumar Selvaraj", "email": "saaadhu@gcc.gnu.org", "date": "2018-12-17T10:50:54Z"}, "message": "re PR rtl-optimization/88253 (Inlining of function incorrectly deletes volatile register access when using XOR in avr-gcc)\n\nFix PR 88253\n\ngcc/ChangeLog:\n\n\tPR rtl-optimization/88253\n\t* combine.c (combine_simplify_rtx): Test for side-effects before\n\tsubstituting by zero.\n\ngcc/testsuite/ChangeLog:\n\n\tPR rtl-optimization/88253\n\t* gcc.target/avr/pr88253.c: New test.\n\nFrom-SVN: r267198", "tree": {"sha": "8259daac4937112ea61012e745a20a8d4140b029", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8259daac4937112ea61012e745a20a8d4140b029"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d7c00826362598d636ef1eb92a1b194d46b41473", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d7c00826362598d636ef1eb92a1b194d46b41473", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d7c00826362598d636ef1eb92a1b194d46b41473", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d7c00826362598d636ef1eb92a1b194d46b41473/comments", "author": null, "committer": {"login": "saaadhu", "id": 532256, "node_id": "MDQ6VXNlcjUzMjI1Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/532256?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saaadhu", "html_url": "https://github.com/saaadhu", "followers_url": "https://api.github.com/users/saaadhu/followers", "following_url": "https://api.github.com/users/saaadhu/following{/other_user}", "gists_url": "https://api.github.com/users/saaadhu/gists{/gist_id}", "starred_url": "https://api.github.com/users/saaadhu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saaadhu/subscriptions", "organizations_url": "https://api.github.com/users/saaadhu/orgs", "repos_url": "https://api.github.com/users/saaadhu/repos", "events_url": "https://api.github.com/users/saaadhu/events{/privacy}", "received_events_url": "https://api.github.com/users/saaadhu/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "13e08dc93941675cd6a7cf5470b437c4f640c996", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/13e08dc93941675cd6a7cf5470b437c4f640c996", "html_url": "https://github.com/Rust-GCC/gccrs/commit/13e08dc93941675cd6a7cf5470b437c4f640c996"}], "stats": {"total": 32, "additions": 30, "deletions": 2}, "files": [{"sha": "e63c4c9b50bfa46632f00c6fb73848bec93f7084", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7c00826362598d636ef1eb92a1b194d46b41473/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7c00826362598d636ef1eb92a1b194d46b41473/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d7c00826362598d636ef1eb92a1b194d46b41473", "patch": "@@ -1,3 +1,9 @@\n+2018-12-17  Senthil Kumar Selvaraj  <senthilkumar.selvaraj@microchip.com>\n+\n+\tPR rtl-optimization/88253\n+\t* combine.c (combine_simplify_rtx): Test for side-effects before\n+\tsubstituting by zero.\n+\n 2018-12-17  Richard Sandiford  <richard.sandiford@arm.com>\n \n \t* doc/invoke.texi (-fversion-loops-for-strides): Document"}, {"sha": "220c3a45631bf9b36aa409ba5c47d7229169ca23", "filename": "gcc/combine.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7c00826362598d636ef1eb92a1b194d46b41473/gcc%2Fcombine.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7c00826362598d636ef1eb92a1b194d46b41473/gcc%2Fcombine.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcombine.c?ref=d7c00826362598d636ef1eb92a1b194d46b41473", "patch": "@@ -5978,8 +5978,9 @@ combine_simplify_rtx (rtx x, machine_mode op0_mode, int in_dest,\n \t    && known_eq (subreg_lowpart_offset (int_mode, int_op0_mode),\n \t\t\t SUBREG_BYTE (x))\n \t    && HWI_COMPUTABLE_MODE_P (int_op0_mode)\n-\t    && (nonzero_bits (SUBREG_REG (x), int_op0_mode)\n-\t\t& GET_MODE_MASK (int_mode)) == 0)\n+\t    && ((nonzero_bits (SUBREG_REG (x), int_op0_mode)\n+\t\t & GET_MODE_MASK (int_mode)) == 0)\n+\t    && !side_effects_p (SUBREG_REG (x)))\n \t  return CONST0_RTX (int_mode);\n       }\n "}, {"sha": "8ba858b51778e7a8bb3446e89e4f23f6e2eebf26", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7c00826362598d636ef1eb92a1b194d46b41473/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7c00826362598d636ef1eb92a1b194d46b41473/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d7c00826362598d636ef1eb92a1b194d46b41473", "patch": "@@ -1,3 +1,8 @@\n+2018-12-17  Senthil Kumar Selvaraj  <senthilkumar.selvaraj@microchip.com>\n+\n+\tPR rtl-optimization/88253\n+\t* gcc.target/avr/pr88253.c: New test.\n+\n 2018-12-17  Richard Sandiford  <richard.sandiford@arm.com>\n \n \t* gcc.dg/loop-versioning-1.c: New test."}, {"sha": "7fa7e4efc691b748cdc98e7684f4c27e8ab58fea", "filename": "gcc/testsuite/gcc.target/avr/pr88253.c", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7c00826362598d636ef1eb92a1b194d46b41473/gcc%2Ftestsuite%2Fgcc.target%2Favr%2Fpr88253.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7c00826362598d636ef1eb92a1b194d46b41473/gcc%2Ftestsuite%2Fgcc.target%2Favr%2Fpr88253.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Favr%2Fpr88253.c?ref=d7c00826362598d636ef1eb92a1b194d46b41473", "patch": "@@ -0,0 +1,16 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-Os -w\" } */\n+ \n+static int aRead() __attribute__((always_inline));\n+static int aRead() {\n+    unsigned char h,l;\n+    l = (*(volatile unsigned char *)(0x78)) ;\n+    h = (*(volatile unsigned char *)(0x79)) ;\n+    return (h<<8) | l;\n+}\n+ \n+int main() {\n+    volatile unsigned char x;\n+     x = aRead()^42;\n+ }\n+ /* { dg-final { scan-assembler \"lds r\\\\d+,121\" } } */"}]}