{"sha": "60934f9cf4eec9feef395961c9dda139fa325845", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjA5MzRmOWNmNGVlYzlmZWVmMzk1OTYxYzlkZGExMzlmYTMyNTg0NQ==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2004-11-11T08:40:43Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2004-11-11T08:40:43Z"}, "message": "re PR target/16458 (PowerPC - redundant compare)\n\n.:\tPR target/16458\n\t* config/rs6000/rs6000.c (rs6000_generate_compare): Generate an\n\tunsigned equality compare when we know the operands are unsigned.\ntestsuite:\n\tPR target/16458\n\t* gcc.dg/ppc-compare-1.c: New.\n\nFrom-SVN: r90475", "tree": {"sha": "91678f3e65cced1c4e852130b9ae1c2c4d2468cd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/91678f3e65cced1c4e852130b9ae1c2c4d2468cd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/60934f9cf4eec9feef395961c9dda139fa325845", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/60934f9cf4eec9feef395961c9dda139fa325845", "html_url": "https://github.com/Rust-GCC/gccrs/commit/60934f9cf4eec9feef395961c9dda139fa325845", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/60934f9cf4eec9feef395961c9dda139fa325845/comments", "author": null, "committer": null, "parents": [{"sha": "dc3160863a1cdc9c015ae2b8690d91e2b83cf4db", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dc3160863a1cdc9c015ae2b8690d91e2b83cf4db", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dc3160863a1cdc9c015ae2b8690d91e2b83cf4db"}], "stats": {"total": 38, "additions": 38, "deletions": 0}, "files": [{"sha": "195080d25de330493c759a14e5ac174cffeb3fe2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/60934f9cf4eec9feef395961c9dda139fa325845/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/60934f9cf4eec9feef395961c9dda139fa325845/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=60934f9cf4eec9feef395961c9dda139fa325845", "patch": "@@ -1,3 +1,9 @@\n+2004-11-11  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\tPR target/16458\n+\t* config/rs6000/rs6000.c (rs6000_generate_compare): Generate an\n+\tunsigned equality compare when we know the operands are unsigned.\n+\n 2004-11-10  Peter S. Mazinger  <ps.m@gmx.net>\n \n \t* config/mips/linux.h (LINUX_TARGET_OS_CPP_BUILTINS): Define\n@@ -398,6 +404,7 @@\n \tthem static.\n \t* expr.h: Remove the corresponding prototypes.\n \n+>>>>>>> 2.6266\n 2004-11-08  Richard Earnshaw  <rearnsha@arm.com>\n \n \t* arm.c (arm_handle_notshared_attribute): Wrap declaration and use"}, {"sha": "02b37fe078e3c6ff7c3b84c6118ff34223fc5340", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/60934f9cf4eec9feef395961c9dda139fa325845/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/60934f9cf4eec9feef395961c9dda139fa325845/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=60934f9cf4eec9feef395961c9dda139fa325845", "patch": "@@ -10910,6 +10910,16 @@ rs6000_generate_compare (enum rtx_code code)\n   else if (code == GTU || code == LTU\n \t   || code == GEU || code == LEU)\n     comp_mode = CCUNSmode;\n+  else if ((code == EQ || code == NE)\n+\t   && GET_CODE (rs6000_compare_op0) == SUBREG\n+\t   && GET_CODE (rs6000_compare_op1) == SUBREG\n+\t   && SUBREG_PROMOTED_UNSIGNED_P (rs6000_compare_op0)\n+\t   && SUBREG_PROMOTED_UNSIGNED_P (rs6000_compare_op1))\n+    /* These are unsigned values, perhaps there will be a later\n+       ordering compare that can be shared with this one.\n+       Unfortunately we cannot detect the signedness of the operands\n+       for non-subregs.  */\n+    comp_mode = CCUNSmode;\n   else\n     comp_mode = CCmode;\n "}, {"sha": "814b05b8e204ebceaab5bb6c96389d9d198235e4", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/60934f9cf4eec9feef395961c9dda139fa325845/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/60934f9cf4eec9feef395961c9dda139fa325845/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=60934f9cf4eec9feef395961c9dda139fa325845", "patch": "@@ -1,3 +1,8 @@\n+2004-11-11  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\tPR target/16458\n+\t* gcc.dg/ppc-compare-1.c: New.\n+\n 2004-11-10  Joseph S. Myers  <joseph@codesourcery.com>\n \n \t* objc.dg/desig-init-2.m: New test."}, {"sha": "07aee48a57622971e96b943421071daf0428a518", "filename": "gcc/testsuite/gcc.dg/ppc-compare-1.c", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/60934f9cf4eec9feef395961c9dda139fa325845/gcc%2Ftestsuite%2Fgcc.dg%2Fppc-compare-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/60934f9cf4eec9feef395961c9dda139fa325845/gcc%2Ftestsuite%2Fgcc.dg%2Fppc-compare-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fppc-compare-1.c?ref=60934f9cf4eec9feef395961c9dda139fa325845", "patch": "@@ -0,0 +1,16 @@\n+/* { dg-do compile { target powerpc64-*-* } } */\n+/* { dg-options \"-m64 -O2\" } */\n+\n+/* { dg-final { scan-assembler-not \"cmpw\" } } */\n+\n+/* Origin:Pete Steinmetz <steinmtz@us.ibm.com> */\n+\n+/* PR 16458: Extraneous compare.  */\n+\n+int foo (unsigned a, unsigned b)\n+{\n+  if (a == b) return 1;\n+  if (a > b)  return 2;\n+  if (a < b)  return 3;\n+  return 0;\n+}"}]}