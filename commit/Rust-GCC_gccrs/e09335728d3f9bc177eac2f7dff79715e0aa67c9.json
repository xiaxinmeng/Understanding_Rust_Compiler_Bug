{"sha": "e09335728d3f9bc177eac2f7dff79715e0aa67c9", "node_id": "C_kwDOANBUbNoAKGUwOTMzNTcyOGQzZjliYzE3N2VhYzJmN2RmZjc5NzE1ZTBhYTY3Yzk", "commit": {"author": {"name": "Jiawei", "email": "jiawei@iscas.ac.cn", "date": "2022-10-20T09:32:32Z"}, "committer": {"name": "Kito Cheng", "email": "kito.cheng@sifive.com", "date": "2022-10-27T03:17:25Z"}, "message": "RISC-V: Minimal support of z*inx extension.\n\nMinimal support of z*inx extension, include 'zfinx'\uff0c 'zdinx' and 'zhinx/zhinxmin'\ncorresponding to 'f', 'd' and 'zfh/zfhmin', the 'zdinx' will imply 'zfinx'\nsame as 'd' imply 'f', 'zhinx' will aslo imply 'zfinx', all zfinx extension imply 'zicsr'.\n\nCo-Authored-By: Sinan Lin <sinan@isrc.iscas.ac.cn>\n\ngcc/ChangeLog:\n\n\t* common/config/riscv/riscv-common.cc: New extensions.\n\t* config/riscv/arch-canonicalize: New imply relations.\n\t* config/riscv/riscv-opts.h (MASK_ZFINX): New mask.\n\t(MASK_ZDINX): Ditto.\n\t(MASK_ZHINX): Ditto.\n\t(MASK_ZHINXMIN): Ditto.\n\t(TARGET_ZFINX): New target.\n\t(TARGET_ZDINX): Ditto.\n\t(TARGET_ZHINX): Ditto.\n\t(TARGET_ZHINXMIN): Ditto.\n\t* config/riscv/riscv.opt: New target variable.", "tree": {"sha": "77d9bd8c1753d3c34239954a1cb271ee7cbf13e7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/77d9bd8c1753d3c34239954a1cb271ee7cbf13e7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e09335728d3f9bc177eac2f7dff79715e0aa67c9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e09335728d3f9bc177eac2f7dff79715e0aa67c9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e09335728d3f9bc177eac2f7dff79715e0aa67c9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e09335728d3f9bc177eac2f7dff79715e0aa67c9/comments", "author": {"login": "pz9115", "id": 43362020, "node_id": "MDQ6VXNlcjQzMzYyMDIw", "avatar_url": "https://avatars.githubusercontent.com/u/43362020?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pz9115", "html_url": "https://github.com/pz9115", "followers_url": "https://api.github.com/users/pz9115/followers", "following_url": "https://api.github.com/users/pz9115/following{/other_user}", "gists_url": "https://api.github.com/users/pz9115/gists{/gist_id}", "starred_url": "https://api.github.com/users/pz9115/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pz9115/subscriptions", "organizations_url": "https://api.github.com/users/pz9115/orgs", "repos_url": "https://api.github.com/users/pz9115/repos", "events_url": "https://api.github.com/users/pz9115/events{/privacy}", "received_events_url": "https://api.github.com/users/pz9115/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kito-cheng", "id": 2723185, "node_id": "MDQ6VXNlcjI3MjMxODU=", "avatar_url": "https://avatars.githubusercontent.com/u/2723185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kito-cheng", "html_url": "https://github.com/kito-cheng", "followers_url": "https://api.github.com/users/kito-cheng/followers", "following_url": "https://api.github.com/users/kito-cheng/following{/other_user}", "gists_url": "https://api.github.com/users/kito-cheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/kito-cheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kito-cheng/subscriptions", "organizations_url": "https://api.github.com/users/kito-cheng/orgs", "repos_url": "https://api.github.com/users/kito-cheng/repos", "events_url": "https://api.github.com/users/kito-cheng/events{/privacy}", "received_events_url": "https://api.github.com/users/kito-cheng/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "486a50374e7c6200c476e67ffbe13ad71ac3262a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/486a50374e7c6200c476e67ffbe13ad71ac3262a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/486a50374e7c6200c476e67ffbe13ad71ac3262a"}], "stats": {"total": 36, "additions": 36, "deletions": 0}, "files": [{"sha": "d6404a01205eb206af50e446fd9f8389e30f6a54", "filename": "gcc/common/config/riscv/riscv-common.cc", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e09335728d3f9bc177eac2f7dff79715e0aa67c9/gcc%2Fcommon%2Fconfig%2Friscv%2Friscv-common.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e09335728d3f9bc177eac2f7dff79715e0aa67c9/gcc%2Fcommon%2Fconfig%2Friscv%2Friscv-common.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcommon%2Fconfig%2Friscv%2Friscv-common.cc?ref=e09335728d3f9bc177eac2f7dff79715e0aa67c9", "patch": "@@ -51,6 +51,11 @@ static const riscv_implied_info_t riscv_implied_info[] =\n   {\"d\", \"f\"},\n   {\"f\", \"zicsr\"},\n   {\"d\", \"zicsr\"},\n+\n+  {\"zdinx\", \"zfinx\"},\n+  {\"zfinx\", \"zicsr\"},\n+  {\"zdinx\", \"zicsr\"},\n+\n   {\"zk\", \"zkn\"},\n   {\"zk\", \"zkr\"},\n   {\"zk\", \"zkt\"},\n@@ -99,6 +104,9 @@ static const riscv_implied_info_t riscv_implied_info[] =\n \n   {\"zfh\", \"zfhmin\"},\n   {\"zfhmin\", \"f\"},\n+  \n+  {\"zhinx\", \"zhinxmin\"},\n+  {\"zhinxmin\", \"zfinx\"},\n \n   {NULL, NULL}\n };\n@@ -160,6 +168,11 @@ static const struct riscv_ext_version riscv_ext_version_table[] =\n   {\"zbc\", ISA_SPEC_CLASS_NONE, 1, 0},\n   {\"zbs\", ISA_SPEC_CLASS_NONE, 1, 0},\n \n+  {\"zfinx\", ISA_SPEC_CLASS_NONE, 1, 0},\n+  {\"zdinx\", ISA_SPEC_CLASS_NONE, 1, 0},\n+  {\"zhinx\", ISA_SPEC_CLASS_NONE, 1, 0},\n+  {\"zhinxmin\", ISA_SPEC_CLASS_NONE, 1, 0},\n+\n   {\"zbkb\",  ISA_SPEC_CLASS_NONE, 1, 0},\n   {\"zbkc\",  ISA_SPEC_CLASS_NONE, 1, 0},\n   {\"zbkx\",  ISA_SPEC_CLASS_NONE, 1, 0},\n@@ -1172,6 +1185,11 @@ static const riscv_ext_flag_table_t riscv_ext_flag_table[] =\n   {\"zbc\",    &gcc_options::x_riscv_zb_subext, MASK_ZBC},\n   {\"zbs\",    &gcc_options::x_riscv_zb_subext, MASK_ZBS},\n \n+  {\"zfinx\",    &gcc_options::x_riscv_zinx_subext, MASK_ZFINX},\n+  {\"zdinx\",    &gcc_options::x_riscv_zinx_subext, MASK_ZDINX},\n+  {\"zhinx\",    &gcc_options::x_riscv_zinx_subext, MASK_ZHINX},\n+  {\"zhinxmin\", &gcc_options::x_riscv_zinx_subext, MASK_ZHINXMIN},\n+\n   {\"zbkb\",   &gcc_options::x_riscv_zk_subext, MASK_ZBKB},\n   {\"zbkc\",   &gcc_options::x_riscv_zk_subext, MASK_ZBKC},\n   {\"zbkx\",   &gcc_options::x_riscv_zk_subext, MASK_ZBKX},"}, {"sha": "2498db506b7abc65d1f1131b16e8ca73b6350623", "filename": "gcc/config/riscv/arch-canonicalize", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e09335728d3f9bc177eac2f7dff79715e0aa67c9/gcc%2Fconfig%2Friscv%2Farch-canonicalize", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e09335728d3f9bc177eac2f7dff79715e0aa67c9/gcc%2Fconfig%2Friscv%2Farch-canonicalize", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Farch-canonicalize?ref=e09335728d3f9bc177eac2f7dff79715e0aa67c9", "patch": "@@ -41,6 +41,11 @@ LONG_EXT_PREFIXES = ['z', 's', 'h', 'x']\n IMPLIED_EXT = {\n   \"d\" : [\"f\", \"zicsr\"],\n   \"f\" : [\"zicsr\"],\n+  \"zdinx\" : [\"zfinx\", \"zicsr\"],\n+  \"zfinx\" : [\"zicsr\"],\n+  \"zhinx\" : [\"zhinxmin\", \"zfinx\", \"zicsr\"],\n+  \"zhinxmin\" : [\"zfinx\", \"zicsr\"],\n+\n   \"zk\" : [\"zkn\", \"zkr\", \"zkt\"],\n   \"zkn\" : [\"zbkb\", \"zbkc\", \"zbkx\", \"zkne\", \"zknd\", \"zknh\"],\n   \"zks\" : [\"zbkb\", \"zbkc\", \"zbkx\", \"zksed\", \"zksh\"],"}, {"sha": "1dfe8c8920912f241c34ad855ec2a5afe9ad39f2", "filename": "gcc/config/riscv/riscv-opts.h", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e09335728d3f9bc177eac2f7dff79715e0aa67c9/gcc%2Fconfig%2Friscv%2Friscv-opts.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e09335728d3f9bc177eac2f7dff79715e0aa67c9/gcc%2Fconfig%2Friscv%2Friscv-opts.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Friscv-opts.h?ref=e09335728d3f9bc177eac2f7dff79715e0aa67c9", "patch": "@@ -83,6 +83,16 @@ enum stack_protector_guard {\n #define TARGET_ZBC    ((riscv_zb_subext & MASK_ZBC) != 0)\n #define TARGET_ZBS    ((riscv_zb_subext & MASK_ZBS) != 0)\n \n+#define MASK_ZFINX      (1 << 0)\n+#define MASK_ZDINX      (1 << 1)\n+#define MASK_ZHINX      (1 << 2)\n+#define MASK_ZHINXMIN   (1 << 3)\n+\n+#define TARGET_ZFINX    ((riscv_zinx_subext & MASK_ZFINX) != 0)\n+#define TARGET_ZDINX    ((riscv_zinx_subext & MASK_ZDINX) != 0)\n+#define TARGET_ZHINX    ((riscv_zinx_subext & MASK_ZHINX) != 0)\n+#define TARGET_ZHINXMIN ((riscv_zinx_subext & MASK_ZHINXMIN) != 0)\n+\n #define MASK_ZBKB     (1 << 0)\n #define MASK_ZBKC     (1 << 1)\n #define MASK_ZBKX     (1 << 2)"}, {"sha": "426ea95cd141ba48191776032f8f6e052f2044c7", "filename": "gcc/config/riscv/riscv.opt", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e09335728d3f9bc177eac2f7dff79715e0aa67c9/gcc%2Fconfig%2Friscv%2Friscv.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e09335728d3f9bc177eac2f7dff79715e0aa67c9/gcc%2Fconfig%2Friscv%2Friscv.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Friscv.opt?ref=e09335728d3f9bc177eac2f7dff79715e0aa67c9", "patch": "@@ -206,6 +206,9 @@ int riscv_zi_subext\n TargetVariable\n int riscv_zb_subext\n \n+TargetVariable\n+int riscv_zinx_subext\n+\n TargetVariable\n int riscv_zk_subext\n "}]}