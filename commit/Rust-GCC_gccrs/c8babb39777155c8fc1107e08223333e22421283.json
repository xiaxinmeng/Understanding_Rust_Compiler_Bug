{"sha": "c8babb39777155c8fc1107e08223333e22421283", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzhiYWJiMzk3NzcxNTVjOGZjMTEwN2UwODIyMzMzM2UyMjQyMTI4Mw==", "commit": {"author": {"name": "Stan Cox", "email": "coxs@gnu.org", "date": "1996-08-16T20:09:49Z"}, "committer": {"name": "Stan Cox", "email": "coxs@gnu.org", "date": "1996-08-16T20:09:49Z"}, "message": "Remove CLASS_LIKELY_SPILLED_P\n\nRemove CLASS_LIKELY_SPILLED_P\n(STARTFILE_SPEC): Insert crtbegin.o in correct place, and correctversions of values-X?.o\n(SWITCH_TAKES_ARG): Extend DEFAULT_SWITCH_TAKES_ARG, not replace.\n(CPP_SPEC): Add -Di386, and correctly include extra directories.\nDefine HAVE_ATEXIT in ELF mode for global destructors.\n\nFrom-SVN: r12647", "tree": {"sha": "1b98283f09b80c2bd01f2da725ca3c906387152f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1b98283f09b80c2bd01f2da725ca3c906387152f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c8babb39777155c8fc1107e08223333e22421283", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8babb39777155c8fc1107e08223333e22421283", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c8babb39777155c8fc1107e08223333e22421283", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8babb39777155c8fc1107e08223333e22421283/comments", "author": null, "committer": null, "parents": [{"sha": "843e83356cffe3b25ef5ba53d9e86a2c130b80f5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/843e83356cffe3b25ef5ba53d9e86a2c130b80f5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/843e83356cffe3b25ef5ba53d9e86a2c130b80f5"}], "stats": {"total": 128, "additions": 45, "deletions": 83}, "files": [{"sha": "0a56377c16faab1db81e77027e1563e47f991f36", "filename": "gcc/config/i386/sco5.h", "status": "modified", "additions": 45, "deletions": 83, "changes": 128, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8babb39777155c8fc1107e08223333e22421283/gcc%2Fconfig%2Fi386%2Fsco5.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8babb39777155c8fc1107e08223333e22421283/gcc%2Fconfig%2Fi386%2Fsco5.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fsco5.h?ref=c8babb39777155c8fc1107e08223333e22421283", "patch": "@@ -506,12 +506,6 @@ do {\t\t\t\t\t\t\t\t\t\\\n } while (0)\n \n \n-#undef CLASS_LIKELY_SPILLED_P\n-#define CLASS_LIKELY_SPILLED_P(CLASS)\t\t\t\t\t\\\n-  (TARGET_ELF) ? (reg_class_size[(int)(CLASS)] == 1) :\t\t\t\\\n-    (((CLASS) == AREG) || ((CLASS) == DREG) || ((CLASS) == CREG) ||\t\\\n-    ((CLASS) == BREG) || ((CLASS) == SIREG) || ((CLASS) == DIREG))\n-\n #undef CTOR_LIST_BEGIN\n #define CTOR_LIST_BEGIN\t\t\t\t\t\t\t\\\n do {\t\t\t\t\t\t\t\t\t\\\n@@ -713,16 +707,10 @@ dtors_section ()\t\t\t\t\t\t\t\\\n \n #undef SWITCH_TAKES_ARG\n #define SWITCH_TAKES_ARG(CHAR) \t\t\t\t\t\t\\\n-  (   (CHAR) == 'D' \t\t\t\t\t\t\t\\\n-   || (CHAR) == 'U' \t\t\t\t\t\t\t\\\n-   || (CHAR) == 'o' \t\t\t\t\t\t\t\\\n-   || (CHAR) == 'e' \t\t\t\t\t\t\t\\\n-   || (CHAR) == 'u' \t\t\t\t\t\t\t\\\n-   || (CHAR) == 'I' \t\t\t\t\t\t\t\\\n-   || (CHAR) == 'm' \t\t\t\t\t\t\t\\\n-   || (CHAR) == 'L' \t\t\t\t\t\t\t\\\n-   || (CHAR) == 'A' \t\t\t\t\t\t\t\\\n+  (DEFAULT_SWITCH_TAKES_ARG(CHAR)\t\t\t\t\t\\\n    || (CHAR) == 'h' \t\t\t\t\t\t\t\\\n+   || (CHAR) == 'R' \t\t\t\t\t\t\t\\\n+   || (CHAR) == 'Y' \t\t\t\t\t\t\t\\\n    || (CHAR) == 'z')\n \n #undef WORD_SWITCH_TAKES_ARG\n@@ -798,17 +786,17 @@ dtors_section ()\t\t\t\t\t\t\t\\\n  \"%{!shared:\\\n    %{!symbolic: \\\n     %{pg:gcrt.o%s}%{!pg:%{p:mcrt1.o%s}%{!p:crt1.o%s}}}} \\\n+  %{ansi:values-Xc.o%s} \\\n+  %{!ansi: \\\n+   %{traditional:values-Xt.o%s} \\\n+    %{!traditional: \\\n+     %{Xa:values-Xa.o%s} \\\n+      %{!Xa:%{Xc:values-Xc.o%s} \\\n+       %{!Xc:%{Xk:values-Xk.o%s} \\\n+        %{!Xk:%{Xt:values-Xt.o%s} \\\n+         %{!Xt:values-Xa.o%s}}}}}} \\\n   %{!melf:crtbegin.o%s} \\\n-  %{melf:%{ansi:values-Xc.o%s} \\\n-    %{!ansi: \\\n-     %{traditional:values-Xt.o%s} \\\n-     %{!traditional: \\\n-      %{Xa:values-Xa.o%s} \\\n-       %{!Xa:%{Xc:values-Xc.o%s} \\\n-        %{!Xc:%{Xk:values-Xk.o%s} \\\n-         %{!Xk:%{Xt:values-Xt.o%s} \\\n-          %{!Xt:values-Xa.o%s}}}}}} \\\n-   %{static:crtbegin.o%s}%{!static:crtbeginS.o%s}}\"\n+  %{melf:%{static:crtbegin.o%s}%{!static:crtbeginS.o%s}}\"\n \n #undef ENDFILE_SPEC\n #define ENDFILE_SPEC \\\n@@ -824,46 +812,36 @@ dtors_section ()\t\t\t\t\t\t\t\\\n \n #undef CPP_SPEC\n #define CPP_SPEC \\\n- \"%{melf:-Asystem(svr4) -D__svr4__} \\\n-  %{fpic:%{!melf:%e-fpic is only valid with -melf}} \\\n+ \"%{fpic:%{!melf:%e-fpic is only valid with -melf}} \\\n   %{fPIC:%{!melf:%e-fPIC is only valid with -melf}} \\\n   -D__i386 -D__unix -D_SCO_DS=1 -D_M_I386 -D_M_XENIX -D_M_UNIX \\\n   %{!Xods30:-D_STRICT_NAMES} \\\n   %{!ansi:%{!posix:%{!Xods30:-D_SCO_XPG_VERS=4}}} \\\n-  %{ansi:-D_STRICT_ANSI} \\\n-  %{!ansi: \\\n-   %{!Xpg4: \\\n-    %{!Xpg4plus: \\\n-     %{!Xods30: \\\n-      %{posix:-D_POSIX_C_SOURCE=2 -D_POSIX_SOURCE}}}}} \\\n-  %{!ansi: \\\n-   %{!posix: \\\n-    %{!Xods30: \\\n-     %{!Xpg4plus: \\\n-      %{Xpg4:-D_XOPEN_SOURCE}}}}} \\\n-  %{!ansi: \\\n-   %{!posix: \\\n-    %{!Xpg4: \\\n-     %{!Xpg4plus: \\\n-      %{Xods30:-D_SCO_ODS_30 -DM_I86 -DM_I86SM -DM_SDATA -DM_STEXT \\\n-               -DM_BITFIELDS -DM_SYS5 -DM_SYSV -DM_SYS3 -DM_SYSIII \\\n-               -DM_WORDSWAP}}}}} \\\n+  %{ansi:-isystem include/ansi%s -isystem /usr/include/ansi -D_STRICT_ANSI} \\\n   %{!ansi: \\\n-   %{!posix: \\\n-    %{!Xpg4:-D_M_I86 -D_M_I86SM -D_M_I86SM -D_M_SDATA -D_M_STEXT \\\n-            -D_M_BITFIELDS -D_M_SYS5 -D_M_SYSV -D_M_SYS3 -D_M_SYSIII \\\n-            -D_M_WORDSWAP -Di386 -Dunix -DM_I386 -DM_UNIX -DM_XENIX}}} \\\n+   %{posix:-isystem include/posix%s -isystem /usr/include/posix \\\n+           -D_POSIX_C_SOURCE=2 -D_POSIX_SOURCE=1} \\\n+    %{!posix:%{Xpg4:-isystem include/xpg4%s -isystem /usr/include/xpg4 \\\n+                    -D_XOPEN_SOURCE=1} \\\n+     %{!Xpg4:-D_M_I86 -D_M_I86SM -D_M_INTERNAT -D_M_SDATA -D_M_STEXT \\\n+             -D_M_BITFIELDS -D_M_SYS5 -D_M_SYSV -D_M_SYSIII \\\n+             -D_M_WORDSWAP -Dunix -DM_I386 -DM_UNIX -DM_XENIX \\\n+             %{Xods30:-isystem include/ods_30_compat%s \\\n+                      -isystem /usr/include/ods_30_compat \\\n+                      -D_SCO_ODS_30 -DM_I86 -DM_I86SM -DM_SDATA -DM_STEXT \\\n+                      -DM_BITFIELDS -DM_SYS5 -DM_SYSV -DM_INTERNAT -DM_SYSIII \\\n+                      -DM_WORDSWAP}}}} \\\n   %{scointl:-DM_INTERNAT -D_M_INTERNAT} \\\n   %{traditional:-D_KR -D_SVID -D_NO_PROTOTYPE} \\\n-  %{melf:-D_SCO_ELF -DM_ELF -D_M_ELF} \\\n-  %{!melf:-D_M_COFF -DM_COFF -D_SCO_COFF} \\\n+  %{melf:-D_SCO_ELF} \\\n+  %{!melf:-D_M_COFF -D_SCO_COFF} \\\n   %{melf:%{fpic:-D__PIC__ -D__pic__} \\\n          %{fPIC:%{!fpic:-D__PIC__ -D__pic__}}} \\\n   %{Xa:-D_SCO_C_DIALECT=1} \\\n-   %{!Xa:%{Xc:-D_SCO_C_DIALECT=3} \\\n-    %{!Xc:%{Xk:-D_SCO_C_DIALECT=4} \\\n-     %{!Xk:%{Xt:-D_SCO_C_DIALECT=2  \\\n-             %{!traditional:-traditional -D_KR -D_NO_PROTOTYPE}}}}} \\\n+  %{!Xa:%{Xc:-D_SCO_C_DIALECT=3} \\\n+   %{!Xc:%{Xk:-D_SCO_C_DIALECT=4} \\\n+    %{!Xk:%{Xt:-D_SCO_C_DIALECT=2} \\\n+     %{!Xt:-D_SCO_C_DIALECT=1}}}} \\\n   %{traditional:-traditional -D_KR -D_NO_PROTOTYPE}\"\n \n #undef LINK_SPEC\n@@ -879,7 +857,7 @@ dtors_section ()\t\t\t\t\t\t\t\\\n   %{!YP,*:%{p:-YP,/usr/ccs/libp:/lib/libp:/usr/lib/libp:/usr/ccs/lib:/lib:/usr/lib} \\\n    %{!p:-YP,/usr/ccs/lib:/lib:/usr/lib}} \\\n   %{h*} %{static:-dn -Bstatic} %{shared:-G -dy %{!z*:-z text}} \\\n-  %{symbolic:-Bsymbolic -G -dy %{!z*:-z text}} \\\n+  %{symbolic:-Bsymbolic -G -dy %{!z*:-z text}} %{z*} %{R*} %{Y*} \\\n   %{G:-G} %{melf:%{Qn:} %{!Qy:-Qn}}\"\n \n /* Library spec. If we are not building a shared library, provide the\n@@ -912,44 +890,28 @@ compiler at the end of the day. Onward we go ...\n */\n \n #if defined(CRT_BEGIN) || defined(CRT_END) || defined(IN_LIBGCC2)\n+# undef OBJECT_FORMAT_ELF\n+# undef HAVE_ATEXIT\n+# undef INIT_SECTION_ASM_OP\n+# undef FINI_SECTION_ASM_OP\n+# undef CTORS_SECTION_ASM_OP\n+# undef DTORS_SECTION_ASM_OP\n+# undef CTOR_LIST_BEGIN\n+# undef CTOR_LIST_END\n+# undef DO_GLOBAL_CTORS_BODY\n+\n # if defined (_SCO_ELF)\n-#  undef OBJECT_FORMAT_ELF\n #  define OBJECT_FORMAT_ELF\n-#  undef INIT_SECTION_ASM_OP\n-#  undef FINI_SECTION_ASM_OP\n-#  undef DTORS_SECTION_ASM_OP\n-#  undef CTORS_SECTION_ASM_OP\n-#  undef CTOR_LIST_BEGIN\n-#  undef CTOR_LIST_END\n-#  undef DO_GLOBAL_CTORS_BODY\n+#  define HAVE_ATEXIT\n #  define INIT_SECTION_ASM_OP INIT_SECTION_ASM_OP_ELF\n #  define FINI_SECTION_ASM_OP FINI_SECTION_ASM_OP_ELF\n #  define DTORS_SECTION_ASM_OP DTORS_SECTION_ASM_OP_ELF\n #  define CTORS_SECTION_ASM_OP CTORS_SECTION_ASM_OP_ELF\n-#  define CTOR_LIST_BEGIN asm (CTORS_SECTION_ASM_OP_ELF); \\\n-    STATIC func_ptr __CTOR_LIST__[1] = { (func_ptr) (-1) };\n-#  define DO_GLOBAL_CTORS_BODY\t\t\t\t\t\t\\\n-do {\t\t\t\t\t\t\t\t\t\\\n-    unsigned long nptrs = (unsigned long) __CTOR_LIST__[0];\t\t\\\n-    unsigned i;\t\t\t\t\t\t\t\t\\\n-    if (nptrs == -1)\t\t\t\t\t\t\t\\\n-      for (nptrs=0; __CTOR_LIST__[nptrs+1] != 0; nptrs++);\t\t\\\n-    for (i = nptrs; i >= 1; i--)\t\t\t\t\t\\\n-      __CTOR_LIST__[i] ();\t\t\t\t\t\t\\\n-} while (0)\n # else /* ! _SCO_ELF */\n-#  undef OBJECT_FORMAT_ELF\n-#  undef INIT_SECTION_ASM_OP\n-#  undef FINI_SECTION_ASM_OP\n-#  undef DTORS_SECTION_ASM_OP\n-#  undef CTORS_SECTION_ASM_OP\n #  define INIT_SECTION_ASM_OP INIT_SECTION_ASM_OP_COFF\n #  define FINI_SECTION_ASM_OP FINI_SECTION_ASM_OP_COFF\n #  define DTORS_SECTION_ASM_OP DTORS_SECTION_ASM_OP_COFF\n #  define CTORS_SECTION_ASM_OP CTORS_SECTION_ASM_OP_COFF\n-#  undef CTOR_LIST_BEGIN\n-#  undef CTOR_LIST_END\n-#  undef DO_GLOBAL_CTORS_BODY\n #  define CTOR_LIST_BEGIN asm (INIT_SECTION_ASM_OP); asm (\"pushl $0\")\n #  define CTOR_LIST_END CTOR_LIST_BEGIN\n #  define DO_GLOBAL_CTORS_BODY\t\t\t\t\t\t\\"}]}