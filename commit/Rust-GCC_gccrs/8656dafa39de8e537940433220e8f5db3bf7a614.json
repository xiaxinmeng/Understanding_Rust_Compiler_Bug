{"sha": "8656dafa39de8e537940433220e8f5db3bf7a614", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODY1NmRhZmEzOWRlOGU1Mzc5NDA0MzMyMjBlOGY1ZGIzYmY3YTYxNA==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2018-10-08T08:16:13Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2018-10-08T08:16:13Z"}, "message": "Don't ICE on vectors of enums (PR 87286)\n\nWe've traditionally allowed vectors of enums (not sure if that's\ndeliberate) but vector_types_compatible_elements_p checked for\nINTEGER_TYPE rather than INTEGRAL_TYPE_P.\n\n2018-10-08  Richard Sandiford  <richard.sandiford@arm.com>\n\ngcc/c-family/\n\tPR c/87286\n\t* c-common.c (vector_types_compatible_elements_p): Use\n\tINTEGRAL_TYPE_P instead of checking only for INTEGER_TYPE.\n\ngcc/testsuite/\n\tPR c/87286\n\t* gcc.dg/pr87286.c: New test.\n\nFrom-SVN: r264913", "tree": {"sha": "165aa7158bf1941139ea902e141af4b3c83f48ba", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/165aa7158bf1941139ea902e141af4b3c83f48ba"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8656dafa39de8e537940433220e8f5db3bf7a614", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8656dafa39de8e537940433220e8f5db3bf7a614", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8656dafa39de8e537940433220e8f5db3bf7a614", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8656dafa39de8e537940433220e8f5db3bf7a614/comments", "author": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "090680870b633853e40a750036dab2b3df63dd18", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/090680870b633853e40a750036dab2b3df63dd18", "html_url": "https://github.com/Rust-GCC/gccrs/commit/090680870b633853e40a750036dab2b3df63dd18"}], "stats": {"total": 23, "additions": 20, "deletions": 3}, "files": [{"sha": "630733786a3194b07448f3df17eb4f2bd27f4808", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8656dafa39de8e537940433220e8f5db3bf7a614/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8656dafa39de8e537940433220e8f5db3bf7a614/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=8656dafa39de8e537940433220e8f5db3bf7a614", "patch": "@@ -1,3 +1,9 @@\n+2018-10-08  Richard Sandiford  <richard.sandiford@arm.com>\n+\n+\tPR c/87286\n+\t* c-common.c (vector_types_compatible_elements_p): Use\n+\tINTEGRAL_TYPE_P instead of checking only for INTEGER_TYPE.\n+\n 2018-10-04  Vinay Kumar  <vinay.kumar@blackfigtech.com>\n \n \t* c-attribs.c (get_priority): Add a warning flag warn_prio_ctor_dtor"}, {"sha": "c0198e171ad6affbbf9792624ca51d38869eaee3", "filename": "gcc/c-family/c-common.c", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8656dafa39de8e537940433220e8f5db3bf7a614/gcc%2Fc-family%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8656dafa39de8e537940433220e8f5db3bf7a614/gcc%2Fc-family%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-common.c?ref=8656dafa39de8e537940433220e8f5db3bf7a614", "patch": "@@ -7465,8 +7465,11 @@ vector_types_compatible_elements_p (tree t1, tree t2)\n \n   enum tree_code c1 = TREE_CODE (t1), c2 = TREE_CODE (t2);\n \n-  gcc_assert ((c1 == INTEGER_TYPE || c1 == REAL_TYPE || c1 == FIXED_POINT_TYPE)\n-\t      && (c2 == INTEGER_TYPE || c2 == REAL_TYPE\n+  gcc_assert ((INTEGRAL_TYPE_P (t1)\n+\t       || c1 == REAL_TYPE\n+\t       || c1 == FIXED_POINT_TYPE)\n+\t      && (INTEGRAL_TYPE_P (t2)\n+\t\t  || c2 == REAL_TYPE\n \t\t  || c2 == FIXED_POINT_TYPE));\n \n   t1 = c_common_signed_type (t1);\n@@ -7476,7 +7479,7 @@ vector_types_compatible_elements_p (tree t1, tree t2)\n   if (t1 == t2)\n     return true;\n   if (opaque && c1 == c2\n-      && (c1 == INTEGER_TYPE || c1 == REAL_TYPE)\n+      && (INTEGRAL_TYPE_P (t1) || c1 == REAL_TYPE)\n       && TYPE_PRECISION (t1) == TYPE_PRECISION (t2))\n     return true;\n   return false;"}, {"sha": "7b8bdc737668b0ce0e9c51de50dde74b8690e691", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8656dafa39de8e537940433220e8f5db3bf7a614/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8656dafa39de8e537940433220e8f5db3bf7a614/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8656dafa39de8e537940433220e8f5db3bf7a614", "patch": "@@ -1,3 +1,8 @@\n+2018-10-08  Richard Sandiford  <richard.sandiford@arm.com>\n+\n+\tPR c/87286\n+\t* gcc.dg/pr87286.c: New test.\n+\n 2018-10-06  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/86111"}, {"sha": "d92d29ccee7719c25d296e71403a2eba219e7790", "filename": "gcc/testsuite/gcc.dg/pr87286.c", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8656dafa39de8e537940433220e8f5db3bf7a614/gcc%2Ftestsuite%2Fgcc.dg%2Fpr87286.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8656dafa39de8e537940433220e8f5db3bf7a614/gcc%2Ftestsuite%2Fgcc.dg%2Fpr87286.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr87286.c?ref=8656dafa39de8e537940433220e8f5db3bf7a614", "patch": "@@ -0,0 +1,3 @@\n+enum foo { F };\n+typedef enum foo vec_foo __attribute__((vector_size (16)));\n+vec_foo add (vec_foo x, vec_foo y) { return x + y; }"}]}