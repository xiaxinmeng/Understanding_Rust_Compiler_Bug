{"sha": "e4966e1d1de54441bdaed54eb00084db4193bbbf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTQ5NjZlMWQxZGU1NDQ0MWJkYWVkNTRlYjAwMDg0ZGI0MTkzYmJiZg==", "commit": {"author": {"name": "Sandra Loosemore", "email": "sandra@codesourcery.com", "date": "2021-07-22T22:15:50Z"}, "committer": {"name": "Sandra Loosemore", "email": "sandra@codesourcery.com", "date": "2021-07-22T22:15:50Z"}, "message": "Bind(c): signed char is not a Fortran character type\n\nCFI_allocate and CFI_select_part were incorrectly treating\nCFI_type_signed_char as a Fortran character type for the purpose of\ndeciding whether or not to use the elem_len argument.  It is a Fortran\ninteger type per table 18.2 in the 2018 Fortran standard.\n\nOther functions in ISO_Fortran_binding.c appeared to handle this case\ncorrectly already.\n\n2021-07-15  Sandra Loosemore  <sandra@codesourcery.com>\n\nlibgfortran/\n\t* runtime/ISO_Fortran_binding.c (CFI_allocate): Don't use elem_len\n\tfor CFI_type_signed_char.\n\t(CFI_select_part): Likewise.", "tree": {"sha": "0929fed109a5b2666daf0becc111f5f2d15600ae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0929fed109a5b2666daf0becc111f5f2d15600ae"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e4966e1d1de54441bdaed54eb00084db4193bbbf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4966e1d1de54441bdaed54eb00084db4193bbbf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e4966e1d1de54441bdaed54eb00084db4193bbbf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4966e1d1de54441bdaed54eb00084db4193bbbf/comments", "author": {"login": "SandraLoosemore", "id": 104087111, "node_id": "U_kgDOBjQ-Rw", "avatar_url": "https://avatars.githubusercontent.com/u/104087111?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SandraLoosemore", "html_url": "https://github.com/SandraLoosemore", "followers_url": "https://api.github.com/users/SandraLoosemore/followers", "following_url": "https://api.github.com/users/SandraLoosemore/following{/other_user}", "gists_url": "https://api.github.com/users/SandraLoosemore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SandraLoosemore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SandraLoosemore/subscriptions", "organizations_url": "https://api.github.com/users/SandraLoosemore/orgs", "repos_url": "https://api.github.com/users/SandraLoosemore/repos", "events_url": "https://api.github.com/users/SandraLoosemore/events{/privacy}", "received_events_url": "https://api.github.com/users/SandraLoosemore/received_events", "type": "User", "site_admin": false}, "committer": {"login": "SandraLoosemore", "id": 104087111, "node_id": "U_kgDOBjQ-Rw", "avatar_url": "https://avatars.githubusercontent.com/u/104087111?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SandraLoosemore", "html_url": "https://github.com/SandraLoosemore", "followers_url": "https://api.github.com/users/SandraLoosemore/followers", "following_url": "https://api.github.com/users/SandraLoosemore/following{/other_user}", "gists_url": "https://api.github.com/users/SandraLoosemore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SandraLoosemore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SandraLoosemore/subscriptions", "organizations_url": "https://api.github.com/users/SandraLoosemore/orgs", "repos_url": "https://api.github.com/users/SandraLoosemore/repos", "events_url": "https://api.github.com/users/SandraLoosemore/events{/privacy}", "received_events_url": "https://api.github.com/users/SandraLoosemore/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8ed6cfbbee74ec9e03f2558b9c36f61dd7d4dcfd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ed6cfbbee74ec9e03f2558b9c36f61dd7d4dcfd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8ed6cfbbee74ec9e03f2558b9c36f61dd7d4dcfd"}], "stats": {"total": 13, "additions": 6, "deletions": 7}, "files": [{"sha": "773d24e9b71372f190bd9a7b080bcd5542fe4aff", "filename": "libgfortran/runtime/ISO_Fortran_binding.c", "status": "modified", "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4966e1d1de54441bdaed54eb00084db4193bbbf/libgfortran%2Fruntime%2FISO_Fortran_binding.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4966e1d1de54441bdaed54eb00084db4193bbbf/libgfortran%2Fruntime%2FISO_Fortran_binding.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fruntime%2FISO_Fortran_binding.c?ref=e4966e1d1de54441bdaed54eb00084db4193bbbf", "patch": "@@ -229,10 +229,9 @@ CFI_allocate (CFI_cdesc_t *dv, const CFI_index_t lower_bounds[],\n \t}\n     }\n \n-  /* If the type is a character, the descriptor's element length is replaced\n-     by the elem_len argument. */\n-  if (dv->type == CFI_type_char || dv->type == CFI_type_ucs4_char ||\n-      dv->type == CFI_type_signed_char)\n+  /* If the type is a Fortran character type, the descriptor's element\n+     length is replaced by the elem_len argument. */\n+  if (dv->type == CFI_type_char || dv->type == CFI_type_ucs4_char)\n     dv->elem_len = elem_len;\n \n   /* Dimension information and calculating the array length. */\n@@ -731,9 +730,9 @@ int CFI_select_part (CFI_cdesc_t *result, const CFI_cdesc_t *source,\n \t}\n     }\n \n-  /* Element length. */\n-  if (result->type == CFI_type_char || result->type == CFI_type_ucs4_char ||\n-      result->type == CFI_type_signed_char)\n+  /* Element length is ignored unless result->type specifies a Fortran\n+     character type.  */\n+  if (result->type == CFI_type_char || result->type == CFI_type_ucs4_char)\n     result->elem_len = elem_len;\n \n   if (unlikely (compile_options.bounds_check))"}]}