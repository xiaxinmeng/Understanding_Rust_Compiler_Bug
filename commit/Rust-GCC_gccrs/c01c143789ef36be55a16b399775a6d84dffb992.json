{"sha": "c01c143789ef36be55a16b399775a6d84dffb992", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzAxYzE0Mzc4OWVmMzZiZTU1YTE2YjM5OTc3NWE2ZDg0ZGZmYjk5Mg==", "commit": {"author": {"name": "Thomas Fitzsimmons", "email": "fitzsim@redhat.com", "date": "2004-01-20T21:24:09Z"}, "committer": {"name": "Thomas Fitzsimmons", "email": "fitzsim@gcc.gnu.org", "date": "2004-01-20T21:24:09Z"}, "message": "GtkComponentPeer.java (setBounds): Calculate proper offsets for heavyweight components packed in lightweight...\n\n2004-01-20  Thomas Fitzsimmons  <fitzsim@redhat.com>\n\n\t* gnu/java/awt/peer/gtk/GtkComponentPeer.java (setBounds):\n\tCalculate proper offsets for heavyweight components packed in\n\tlightweight containers.\n\nFrom-SVN: r76230", "tree": {"sha": "78d8ff190e6b0e72cde58a5a6f203fe2ad124fef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/78d8ff190e6b0e72cde58a5a6f203fe2ad124fef"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c01c143789ef36be55a16b399775a6d84dffb992", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c01c143789ef36be55a16b399775a6d84dffb992", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c01c143789ef36be55a16b399775a6d84dffb992", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c01c143789ef36be55a16b399775a6d84dffb992/comments", "author": null, "committer": null, "parents": [{"sha": "901150179382792c4786c922b7d67a21f3202e7a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/901150179382792c4786c922b7d67a21f3202e7a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/901150179382792c4786c922b7d67a21f3202e7a"}], "stats": {"total": 35, "additions": 33, "deletions": 2}, "files": [{"sha": "95f86ef5fdc7f403d15cb03796667b6ae1172986", "filename": "libjava/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c01c143789ef36be55a16b399775a6d84dffb992/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c01c143789ef36be55a16b399775a6d84dffb992/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=c01c143789ef36be55a16b399775a6d84dffb992", "patch": "@@ -1,5 +1,9 @@\n 2004-01-20  Thomas Fitzsimmons  <fitzsim@redhat.com>\n \n+\t* gnu/java/awt/peer/gtk/GtkComponentPeer.java (setBounds):\n+\tCalculate proper offsets for heavyweight components packed in\n+\tlightweight containers.\n+\n \t* gnu/java/awt/peer/gtk/GtkTextFieldPeer.java,\n \tjni/gtk-peer/gnu_java_awt_peer_gtk_GtkTextFieldPeer.c\n \t(native create): Add width parameter."}, {"sha": "9a56619e18b17ea0a0bd68f23e75ea247d09802f", "filename": "libjava/gnu/java/awt/peer/gtk/GtkComponentPeer.java", "status": "modified", "additions": 29, "deletions": 2, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c01c143789ef36be55a16b399775a6d84dffb992/libjava%2Fgnu%2Fjava%2Fawt%2Fpeer%2Fgtk%2FGtkComponentPeer.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c01c143789ef36be55a16b399775a6d84dffb992/libjava%2Fgnu%2Fjava%2Fawt%2Fpeer%2Fgtk%2FGtkComponentPeer.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fgnu%2Fjava%2Fawt%2Fpeer%2Fgtk%2FGtkComponentPeer.java?ref=c01c143789ef36be55a16b399775a6d84dffb992", "patch": "@@ -42,6 +42,7 @@\n import java.awt.BufferCapabilities;\n import java.awt.Color;\n import java.awt.Component;\n+import java.awt.Container;\n import java.awt.Cursor;\n import java.awt.Dimension;\n import java.awt.Font;\n@@ -302,8 +303,34 @@ public void setBackground (Color c)\n   public void setBounds (int x, int y, int width, int height)\n   {\n     Component parent = awtComponent.getParent ();\n-    \n-    if (parent instanceof Window)\n+\n+    // Heavyweight components that are children of one or more\n+    // lightweight containers have to be handled specially.  Because\n+    // calls to GLightweightPeer.setBounds do nothing, GTK has no\n+    // knowledge of the lightweight containers' positions.  So we have\n+    // to add the offsets manually when placing a heavyweight\n+    // component within a lightweight container.  The lightweight\n+    // container may itself be in a lightweight container and so on,\n+    // so we need to continue adding offsets until we reach a\n+    // container whose position GTK knows -- that is, the first\n+    // non-lightweight.\n+    boolean lightweightChild = false;\n+    Insets i;\n+    while (parent.isLightweight ())\n+      {\n+\tlightweightChild = true;\n+\n+\ti = ((Container) parent).getInsets ();\n+\n+\tx += parent.getX () + i.left;\n+\ty += parent.getY () + i.top;\n+\n+\tparent = parent.getParent ();\n+      }\n+\n+    // We only need to convert from Java to GTK coordinates if we're\n+    // placing a heavyweight component in a Window.\n+    if (parent instanceof Window && !lightweightChild)\n       {\n \tInsets insets = ((Window) parent).getInsets ();\n \t// Convert from Java coordinates to GTK coordinates."}]}